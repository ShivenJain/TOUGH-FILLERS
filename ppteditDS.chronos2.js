'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1095:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static bYi(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";
default:return"external"}}}Object(J.a)(h,"WopiAuthContext",null,[858])},1194:function(J,V,d){d.r(V);var h=d(0),e=d(68),m=d(375),n=d(13),v=d(25),A=d(192),w=d(141),y;(function(t){t[t.error=0]="error";t[t.warning=1]="warning";t[t.tip=2]="tip";t[t.intelligentService=3]="intelligentService"})(y||(y={}));Object(h.b)("AccessibilityRuleCategory",y);var u=d(55),E=d(69),G=d(35),I=d(139),H=d(194),K=d(112);class C{constructor(t,N,ha=null){this.tnd=null;this.k8e=this.J6e=!1;this.rza=t;this.xoc=N;this.Ca=ha;this.Ym.xa(G.a.Mni,
E.a.frame,Object(n.a)(this,this.bK,"closePane"))}get Ym(){return this.Ca||(this.Ca=v.AFrameworkApplication.Ta)}set Ym(t){this.Ca=t}YKi(){this.J6e||(this.rza.initialize(this),this.xoc.initialize(this),this.J6e=!0)}uue(){K.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.xoc.aWk()}Kl(t,N,ha){if(1===ha)return A.SessionStatusManager.instance.tia?8:32;this.rza.isVisible||this.YKi();this.rcl();return 32}bK(t,N,ha){1!==ha&&this.rza.Ds();return 32}$ve(){this.rza.cqh(!0)}LRd(t){if(t){if(t.AccessibilityRules&&
Object.keys(t.AccessibilityRules).length){const ha=t.AccessibilityRules;for(let Aa in ha){var N=Aa;const Ra=ha[Aa].RuleId+"";N!==Ra&&K.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",N,Ra)}this.tnd=ha}else!this.tnd&&t.Results&&0<t.Results.length?(K.c(18993251,200,15,"No accessibility rule definitions available"),t.IsSuccess=!1):t.AccessibilityRules=this.tnd;t.IsSuccess||K.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.PNk(t);this.vXj(t);this.rza.LRd(t)}}PNk(t){const N=
t.AccessibilityRules;if(t=t.Results)for(let ha=t.length-1;0<=ha;ha--){const Aa=t[ha];let Ra="";const yb=Aa.RuleId;Aa.ContentName||(Ra+="Result does not have content name. ");yb in N||(Ra+=String.format("No accessibility check rule exists for ID {0}.",yb));0<Ra.length&&(K.c(36214999,200,15,"Omitting invalid accessibility check result: "+Ra),Array.removeAt(t,ha))}}ibj(){return v.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):
u.a.instance.resolve("Common.IDynamicScriptLoaderProvider").yv.loadScript("accessibility-checker-pane-strings")}rcl(){this.k8e?this.rza.Kl():this.ibj().then(()=>{this.k8e=!0;this.rza.Kl()}).catch(t=>m.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",t))}vXj(t){var N={};const ha={};var Aa=t.Results,Ra=[];Array.add(Ra,Object.assign(new I.a,{name:"FinalViolationCount",int64:0}));Array.add(Ra,Object.assign(new I.a,{name:"FinalErrorCount",string:"0"}));
Array.add(Ra,Object.assign(new I.a,{name:"FinalWarningCount",string:"0"}));Array.add(Ra,Object.assign(new I.a,{name:"FinalTipCount",string:"0"}));Array.add(Ra,Object.assign(new I.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Aa){for(const uc of Aa)if(t.AccessibilityRules){var yb=t.AccessibilityRules[uc.RuleId];if(yb){if(N[y[yb.Category]]){let Zc=N[y[yb.Category]];N[y[yb.Category]]=++Zc}else N[y[yb.Category]]=1;ha[uc.RuleId]?(yb=ha[uc.RuleId],ha[uc.RuleId]=++yb):ha[uc.RuleId]=1}}Ra[0].int64=
Aa.length;for(var Sb in N)switch(t=N[Sb],Aa=Sb,Aa="Final"+Aa.charAt(0).toUpperCase()+Aa.substring(1,Aa.length)+"Count",Aa){case "FinalErrorCount":Ra[1].string=t.toString();break;case "FinalWarningCount":Ra[2].string=t.toString();break;case "FinalTipCount":Ra[3].string=t.toString();break;case "FinalIntelligentServiceCount":Ra[4].string=t.toString()}}w.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Ra}));for(let uc in ha)N=
uc,Ra=ha[uc],Sb=[],Array.add(Sb,Object.assign(new I.a,{name:"RuleID",string:N})),Array.add(Sb,Object.assign(new I.a,{name:"FinalViolationCount",string:Ra.toString()})),w.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Sb}))}dispose(){this.rza&&this.rza.dispose();this.xoc&&this.xoc.dispose()}}Object(h.a)(C,"AAccessibilityCheckManager",null,[182,106]);var Y=d(78),M=d(1158),P=d(63),T=d(314),L=d(26);class aa extends C{constructor(t,
N,ha,Aa,Ra,yb,Sb,uc,Zc){super(t,N);this.Xab=this.tFa=null;this.Fa=ha;this.yb=Aa;this.xq=Ra;this.KW=yb;this.ta=Sb;this.ra=uc;this.Sb=Zc;this.ope=!1}X1k(t){if(!t)return L.a.J(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(t.sldIdField){var N=new P.a(Object.assign(new T.a,{Sid:t.sldIdField.sidField,Cid:t.sldIdField.cidField}));N=this.Sb.xra(N);if(!N)return!1;let ha=null;if(t.spIdFieldSpecified&&(ha=N.JB(t.spIdField),!ha&&this.ope))return!1;this.YYk(N,ha)}else L.a.J(19227929,334,
15,"There is no slide id info in violation data");return!0}uue(){this.ope=!1;super.uue()}$ve(){this.ope=!0;super.$ve()}YYk(t,N){if(t){const ha=this.ta.Ba!==t?!0:!1;N&&(this.Xab=N,ha?this.xq.GY(Object(n.a)(this,this.VBb,"onActiveSlideDomChanged")):this.Sih());ha&&(this.KW.Ba=t);this.ra.ly();this.Fa.Ad()}}VBb(){this.xq.Nva(Object(n.a)(this,this.VBb,"onActiveSlideDomChanged"));this.tFa||(this.tFa=new Y.a(2,1,0,Object(n.a)(this,this.Tve,"onPostActiveSlideDomChangedTask"),90,"20"),this.yb.Gb(this.tFa))}Tve(){this.tFa=
null;this.Sih()}Ad(){this.KW.VJ.So||this.Fa.Ad()}Sih(){if(this.Xab){const t=Object(M.a)(124,this.Xab.Ag(this.KW.VJ.Ma));t?t.ll?L.a.J(19227931,334,50,"Shape view element of node {0} has been disposed",this.Xab.id):t.Kp?t.lhd():this.ra.selectShape(this.Xab,!0):L.a.J(19227933,334,50,"Try select node {0} but cannot find its shape view element",this.Xab.id);this.Ad();this.Xab=null}}}Object(h.a)(aa,"PptAccCheckManager",C,[]);class Q{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=
!1;this.Results=null}static deserialize(t){t=Sys.Serialization.JavaScriptSerializer.deserialize(t);const N=t.AccessibilityRules,ha={};if(N)for(let Aa=0;Aa<N.length;++Aa){const Ra=N[Aa];ha[Ra.Key]=Ra.Value}t.AccessibilityRules=ha;return t}}Object(h.a)(Q,"AccessibilityCheckResultCollection",null,[]);class ea{}Object(h.a)(ea,"AccessibilityCheckResult",null,[]);class ia{}Object(h.a)(ia,"AccessibilityCheckRule",null,[]);class ja{constructor(t){this.OJa=null;this.f3e=t}get fileId(){return this.f3e?this.f3e():
null}initialize(t){this.OJa=t}eXg(t){this.OJa.LRd(t)}}Object(h.a)(ja,"AAccessibilityCheckService",null,[821,106]);var D=d(17),pa=d(105);class Z extends pa.a{constructor(){super()}Ik(){return 56}}Object(h.a)(Z,"AccCheckRequest",pa.a,[]);var oa=d(238);class Ba extends ja{constructor(t,N){super(null);this.ni=t;this.CUa=N}aWk(){const t=new oa.a(new Z,Object(n.a)(this,this.Hgk,"onAccCheckSucceed"),Object(n.a)(this,this.Ggk,"onAccCheckFailed"));this.ni.Gb(t)}dispose(){}get iBj(){return 0<this.CUa.lSb.length}Hgk(t){if(t&&
t.ACResult&&(t=this.cdi(t.ACResult))){this.eXg(t);L.a.J(19227935,334,50,"Acc-check succeeded");return}this.BRg("Succeeded but response is invalid")}Ggk(t){this.BRg(t.toString());return!0}BRg(t){L.a.J(19227937,334,50,String.format("Acc-check failed: {0}",t));t=new Q;t.IsSuccess=!1;this.eXg(t)}cdi(t){if(t){var N=null;try{N=JSON.parse(t)}catch(ha){return L.a.J(19227939,334,10,"Cannot parse acc-check result json: {0}",ha.toString()),null}if(N){t=new Q;t.IsSuccess=!0;t.IsPartialResult=N.isPartialResultField;
t.AccessibilityRules={};if(N.violatedRulesField){const ha=new D.a;for(const Aa of N.violatedRulesField)if(N=this.edi(Aa)){t.AccessibilityRules[N.RuleId]=N;for(const Ra of Aa.violationsField){const yb=new ea;yb.RuleId=N.RuleId;yb.ContentName=Ra.labelField;yb.ContentId=Ra;ha.add(yb)}}t.Results=ha.toArray()}return t}}return null}edi(t){if(!t)return null;if(t.ruleIdField>=this.CUa.lSb.length)return L.a.J(19227971,334,10,"Rule id {0} is bigger than total rule info list count {1}",t.ruleIdField,this.CUa.lSb.length),
null;const N=new ia;N.RuleId=t.ruleIdField.toString();N.RuleName=this.CUa.lSb[t.ruleIdField].ruleTextField;switch(this.CUa.lSb[t.ruleIdField].ruleTypeField){case 0:N.Category=0;break;case 1:N.Category=1;break;case 2:N.Category=2;break;case 3:N.Category=3}return N}}Object(h.a)(Ba,"PptAccCheckService",ja,[820,821,106]);class Ma{get jti(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get kti(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get lti(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Zqk(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get ICb(){return CommonUIStrings.l_AccCheckerPaneTitle}get Gtk(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(h.a)(Ma,"AccessibilityCheckStringsProvider",null,[1398]);class za{constructor(){this.Pgh=this.contentId=null}}Object(h.a)(za,"ResultIds",null,[]);var ka=d(65),qa=d(168);class Ja{constructor(t,N){this._element=null;this.tn=N;this.Ig=t}get element(){this._element||(this._element=this.COd(),this.dw());return this._element}Ofb(t){this._element=t}dispose(){this.element&&(this.ena(),this.Ofb(null))}dw(){this.tn&&this.Ig?(this.tn.ob(ka.a.click,this.element,Object(n.a)(this,this.onClick,"onClick")),
this.Ig.ob(ka.a.eg,this.element,Object(n.a)(this,this.bZg,"onKeyPress"))):m.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}ena(){this.tn&&this.Ig&&(this.tn.xb(ka.a.click,this.element,Object(n.a)(this,this.onClick,"onClick")),this.Ig.xb(ka.a.eg,this.element,Object(n.a)(this,this.bZg,"onKeyPress")))}onClick(){this.XYg();return!0}bZg(t){return this.XHj(t.lc.keyCode)?(this.XYg(),!0):!1}XHj(t){return t===
qa.a.JJb||t===qa.a.aq}}Object(h.a)(Ja,"AInteractivePaneElement",null,[1425,106]);const xa=(t,N,ha)=>{t=document.createElement(t);N&&(t.id=N);ha&&(t.className=ha);t.setAttribute("Unselectable","on");return t};var Ga=d(72),na=d(131),sa=d(95);class Ha extends Ja{constructor(t,N,ha){super(t,N);this.eRh=ha}hide(){this.element.removeAttribute(na.a.We);na.a.lO(this.element,na.a.YJ,na.a.vB);this.element.style.display="none"}show(){na.a.lO(this.element,na.a.YJ,na.a.Bpa);na.a.lO(this.element,na.a.We,na.a.MAc);
this.element.style.display="block"}COd(){const t=xa("div",this.bVg,"AccCheckerNotification");na.a.lO(t,na.a.xId,na.a.vB);na.a.lO(t,na.a.y6,this.mte);t.tabIndex=0;const N=xa("span",this.aVg,"AccCheckerNotificationIcon");var ha=Ga.createClusteredImage(16,16,"Info_16x16x32","",!0,"");N.appendChild(ha);ha=xa("span",this.mte,"AccCheckerNotificationText");sa.a.ix(ha,this.cVg);t.appendChild(N);t.appendChild(ha);return t}XYg(){this.eRh()}}Object(h.a)(Ha,"APopupNotification",Ja,[1469,1425,106]);class cb extends Ha{constructor(t,
N,ha,Aa){super(t,N,ha);this.maa=Aa}get bVg(){return"AccCheckerOutOfSyncNotificationId"}get aVg(){return"AccCheckerOutOfSyncNotificationIconId"}get mte(){return"AccCheckerOutOfSyncNotificationTextId"}get cVg(){return this.maa.Zqk}}Object(h.a)(cb,"OutOfSyncNotification",Ha,[]);class Za extends Ha{constructor(t,N,ha,Aa){super(t,N,ha);this.maa=Aa}get bVg(){return"AccCheckerPartialResultNotificationId"}get aVg(){return"AccCheckerPartialResultNotificationIconId"}get mte(){return"AccCheckerPartialResultNotificationTextId"}get cVg(){return this.maa.Gtk}}
Object(h.a)(Za,"PartialResultNotification",Ha,[]);var va=d(119),Fa=d(103);class Ca{constructor(t,N,ha,Aa=null,Ra=null,yb=null,Sb=null){this.Xrf=this.i6=this.Ig=this.OJa=null;this.Y8a=Aa;this.tn=t;this.Hd=N;this.jR=ha;this.maa=Sb||new Ma;this.Ayd=Ra||new cb(this.Y8a,this.tn,Object(n.a)(this,this.dGi,"dimissOutOfSyncNotification"),this.maa);this.Pyd=yb||new Za(this.Y8a,this.tn,Object(n.a)(this,this.eGi,"dimissPartialResultNotification"),this.maa)}show(){}hide(){}get Y8a(){return this.Ig||(this.Ig=v.AFrameworkApplication.Aa.FF)}set Y8a(t){this.Ig=
t}xRf(){}Ds(){}dispose(){}Vzh(){}lfd(){}SAj(t){var N=this.Xrf[t];t=N.contentId;if((N=N.Pgh+"")&&N.length){const ha=[];Array.add(ha,Object.assign(new I.a,{name:"RuleID",string:N}));w.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}",Ca.WOe,"ViolationSelected"),dataFields:ha}))}this.hek(t)}hek(t){t&&this.OJa.X1k(t)||(this.Hd.oX(va.AFrame.BY,!1),this.Wal())}dGi(){this.cqh(!1);this.lfd()}eGi(){this.eqh(!1);this.lfd()}Wal(){const t=Object.assign(new Fa.StandardDialog(!0),{hr:v.AFrameworkApplication.Xba,
vd:1,oYa:!1});t.fwa(1);t.Re(1,this.maa.jti);t.Re(0,CommonUIStrings.l_DialogCancel);t.mO(this.maa.lti,this.maa.kti,N=>{1===N&&this.$6d()})}Iei(t){let N=null;if(t.Results&&0<t.Results.length){N={};let ha=0;for(const Aa of t.Results)Aa.ResultId=Ca.vYh+ ++ha,t=new za,t.contentId=Aa.ContentId,t.Pgh=Aa.RuleId,N[Aa.ResultId]=t}return N}DXj(){w.a.addNamespaceMapping(Ca.WOe,Ca.Hkl);w.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}",Ca.WOe,"ShowTaskpane")}))}}Ca.vYh="AccCheckResult";
Ca.WOe="Office.UX.AccChecker";Ca.Hkl="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(h.a)(Ca,"BaseAccessibilityCheckPane",null,[801,106]);class La{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(h.a)(La,"AccCheckerTaskPaneProps",null,[]);
var nb=d(1116),Nb=d(278);class Rb{constructor(){this.mpc=new D.a}rHa(t){this.mpc.add(t)}j4k(t){for(let N of this.mpc)N(t)}}Object(h.a)(Rb,"ReactTaskPaneManager",null,[1427]);var Ya=d(634),Qb=d(138);class bb extends Ca{constructor(t,N,ha,Aa,Ra=null,yb=null,Sb,uc=null,Zc=null){super(N,ha,Aa,yb,void 0,void 0,uc);this.kVe=null;this.Cqf=this.Oyd=this.Suc=this.twc=this.dwc=!1;this.dEd=null;this.YCd=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.gb&&v.AFrameworkApplication.Aa.gb.Evb;this.zMb=
this.una=null;this.YMb=0;this.Urc=null;this.qod=Ra;Zc&&(this.una=Zc.JYh,this.zMb=Zc.mSi,this.YMb=Zc.Orj);this.xoa=new Rb}get isVisible(){return this.Cqf}EGb(t){this.Cqf=t}LRd(t){t&&(this.kVe=t,t.IsSuccess&&(this.Xrf=this.Iei(t),t.IsPartialResult&&this.eqh(!0)),this.dwc=!0,this.twc=!1,this.knc())}cqh(t){this.isVisible&&t!==this.Suc&&(this.Suc=t,this.knc())}eqh(t){this.Oyd=t;this.knc()}Kl(){this.twc||Qb.UISurfaces.Cs().then(t=>{Nb.a.instance.q1(bb.MZa+":PaneOpen:Start");t.showTaskPane(bb.MZa,this.hqa());
this.$6d();return null});this.isVisible?Qb.UISurfaces.Cs().then(t=>{t.setSelectedTaskPane(bb.MZa);return null}):this.DXj()}knc(){Qb.UISurfaces.Cs().then(t=>{t.updateTaskPane(bb.MZa,this.hqa());return null})}hqa(){var t=new La;this.xoa.j4k(t);t=Object.assign(new Ya.a,{title:this.maa.ICb,hideHeader:!1,width:320,location:2,contentProps:t,onOpen:()=>{this.$1k();this.EGb(!0);v.AFrameworkApplication.Aa.updateCommandUI()},onClose:()=>{this.qfd();this.EGb(!1);this.twc=this.dwc=!1;this.knc();v.AFrameworkApplication.Aa.updateCommandUI()},
isModernPane:!0});this.YCd&&(t.enableResize=!0,t.minResizeWidth=268,t.maxResizeWidth=920);return t}initialize(t){const N=this.Hd.Bc(bb.MZa);N.parent=va.AFrame.gj;N.IK=!0;this.OJa=t;this.YYh()}dispose(){this.Vzh();this.Ayd&&(this.Ayd.dispose(),this.Ayd=null);this.Pyd&&(this.Pyd.dispose(),this.Pyd=null);super.dispose()}YYh(){this.xoa.rHa(this.onRecheckExecute());this.xoa.rHa(this.LWi());this.xoa.rHa(this.qaj());this.xoa.rHa(this.onInvokeNavigateExecute());this.xoa.rHa(this.c4i());this.xoa.rHa(this.O8i());
this.xoa.rHa(this.q9i());this.xoa.rHa(this.updateLastScanTime());this.xoa.rHa(this.showHelpPane())}onRecheckExecute(){return t=>{t.onRecheckExecute=()=>{this.$6d()}}}LWi(){return t=>{t.accessibilityCheckResultCollection=this.kVe}}qaj(){return t=>{t.resultsReady=this.dwc}}onInvokeNavigateExecute(){return t=>{t.onInvokeNavigateExecute=N=>{this.SAj(N)}}}c4i(){return t=>{t.helpLink=this.TNi}}O8i(){return t=>{t.outOfSync=this.Suc}}q9i(){return t=>{t.partialResult=this.Oyd}}updateLastScanTime(){return t=>
{t.updateLastScanTime=N=>{this.dEd=N}}}showHelpPane(){return t=>{t.showHelpPane=()=>{v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?v.AFrameworkApplication.KAa||this.bGf()?this.Urc?this.Urc():this.una.value&&this.zMb&&this.YMb&&this.una.value.Ka(this.YMb,2,this.zMb):this.Lqh():this.bGf()?this.Urc?this.Urc():this.una.value&&this.zMb&&this.YMb&&this.una.value.Ka(this.YMb,2,this.zMb):this.Lqh()}}}bGf(){return!this.qod||
!this.qod.value}Lqh(){const t=this.qod.value;if(t){var N={};N.query=bb.PSh+bb.btd;N=Object.assign(new nb.a,{nonPersistedSettings:N});t.sIa(bb.atd,N)}}$6d(){this.Oyd=this.Suc=this.dwc=!1;this.dEd&&this.dEd();this.knc();this.twc=!0;this.OJa.uue()}$1k(){this.Hd.Bf(bb.MZa)}qfd(){this.jae()&&this.Hd.Bf(this.Hd.Q6)}jae(){return!!this.Hd.ye&&this.Hd.ye.name===bb.MZa}}bb.MZa="AccessibilityCheckerPane";bb.btd="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";bb.atd="FA000000012";bb.PSh="AssetID=";Object(h.a)(bb,"ReactAccessibilityCheckPane",
Ca,[]);class Bb{constructor(t,N,ha){this.JYh=t;this.mSi=N;this.Orj=ha}}Object(h.a)(Bb,"HelpPaneProperties",null,[]);var Eb=d(100),tb=d(28);class Yb extends bb{constructor(t,N,ha,Aa,Ra,yb,Sb,uc){super(null,N,ha,Aa,void 0,null,void 0,void 0,new Bb(Sb,Yb.i3i(),tb.a.sIa));this.y$b=t;this.LYj=Ra;this.TG=yb;this.uKg=Sb;this.FD=uc}get isVisible(){return!!this.y$b&&this.y$b.isVisible}EGb(t){this.y$b&&(this.y$b.isVisible=t)}get TNi(){return this.LYj}Kl(){this.EGb(!0);this.TG.KL(this.y$b,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,
va.AFrame.BY);super.Kl();if(this.uKg){var t=this.uKg.value;if(t){t.processAction(tb.a.Hzf,1);t=!1;try{this.FD.selectRibbonTabById("AccessibleAuthoring"),t=!0}catch(N){L.a.J(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",N.toString())}Eb.a("AccessibleAuthoringTab",t)}else L.a.J(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else L.a.J(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}f7c(){}onBeforeLoadContent(){}onAfterLoadContent(){this.OJa&&
this.OJa.$ve()}onAfterFirstSaveContent(){}static i3i(){const t={};t.fU=ResourceStrings.L_Help;t.assetId="FA000000012";t.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return t}}Object(h.a)(Yb,"PptReactAccCheckControl",bb,[391]);class Tc{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Accessibility"}Wb(t){this.K=t;this.K.register(Ba,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").ma().na(()=>
new Ba(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(801,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").ma().na(()=>new Yb(this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointAccCheckHelpUrl,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.K.Be("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.register(182,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").ma().na(()=>new aa(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEnableAccCheck&&(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),
this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){e.a.instance.Ac(new Tc)}}Object(h.a)(Tc,"PptAccessibilityPackage",null,[2,3]);var ib=d(176),Zb=d(1163),Cc=d(230),ob=d(177),cc=d(523),sb=d(52),mb=d(122);class Pb{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc){this.ia=t;this.la=N;this.MYj=ha;this.NYj=Aa;this.s9a=Ra;this.FD=Sb;this.CUa=yb;this.Fa=uc;this.yc=Zc;this.CUa.m3h(Object(n.a)(this,this.Fah,"refreshAccCheckButtonStatus"))}ub(){this.la.powerPointEnableAccCheck&&
(this.ia.pa(tb.a.g5g,sb.a.application,Object(n.a)(this,this.iki,"checkAccessibility"),4),this.ia.pa(tb.a.WCk,sb.a.application,Object(n.a)(this,this.nCk,"queryCheckAccessibility"),97))}we(){this.la.powerPointEnableAccCheck&&this.Fa.Bc(mb.a.rJf).bindAction(ob.KeyInputManager.Na(qa.a.noc,ob.KeyInputManager.Fe|1),tb.a.g5g)}iki(t,N,ha,Aa,Ra){return 1===ha?this.yc.Nj()?this.NYj.iBj?32:8:8:this.MYj.Kl(t,N,ha,Aa,Ra)}nCk(t,N,ha,Aa,Ra){Ra[cc.a.On]=this.s9a.isVisible;return 32}dispose(){this.CUa.hPk(Object(n.a)(this,
this.Fah,"refreshAccCheckButtonStatus"))}Fah(){this.FD.uF()}}Object(h.a)(Pb,"AccCheckActor",null,[244,106]);class dc{constructor(){this.i6b=this.K=null}get name(){return"PowerPointWebEditor.LazyActors"}Wb(t){this.K=t}init(){this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Ytb(()=>{this.Ftb()})}Ftb(){const t=this.K.resolve("Common.AFrameworkApplication").KR.kd,N=this.K.resolve("Common.IActionManagerExtended");t.powerPointEnableAccCheck&&(this.i6b=new Pb(N,t,this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),
this.K.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),this.i6b.ub(),this.i6b.we());t.Nbe&&ib.a.get_instance().Xj(7,Object(n.a)(this,this.Nbe,"loadInternalSlice"))}Nbe(){const t=Zb.a.create("pptedit.internal",
null,()=>d.e(17).then(d.bind(null,1208)));Cc.a.wx(t)}dispose(){this.i6b&&this.i6b.dispose()}static main(){e.a.instance.Ac(new dc)}}Object(h.a)(dc,"PptLazyActorsPackage",null,[2,3]);var mc=d(207),Mb=d(571),Kc=d(1166),gc=d(183),rb=d(164),Ua=d(59),pb=d(47),Ub=d(67),Bc=d(140),Gc=d(615);class qd extends Gc.a{constructor(){super();this.ee=this.createElement(Ub.a.zPe)}U5k(t){this.ya.textContent=t}appendChild(t){if(!t.ya||!this.ya)throw Error.argumentNull();this.ya.appendChild(t.ya)}}Object(h.a)(qd,"HTMLText",
Gc.a,[]);var Td=d(319),Vd=d(202);class Be{constructor(t,N,ha,Aa,Ra,yb,Sb,uc){this.yd=1;this.Hoe=null;this.t_=new gc.a;this.Mt=new gc.a;this.Sm=null;this.yo=!1;this.IXc=null;this.GHg="";this.kEa=this.Z8=!1;this.nbb=this.qTa=this.Z9a=this.jEa=this.dxb=this.Cca=null;this.jSa=!1;this.ua=t;this.yb=N;this.fe=ha;this.la=Aa;this.ia=Ra;this.gd=yb;this.nb=Sb;this.dC=uc}Rbl(t){this.Cca&&this.nbb&&(this.Z8=!0,this.nbb.appendChild(this.Cca.ya),this.nb.XJ(Object(n.a)(this,this.IGa,"onSelectionChange")),this.IXc=
new Y.a(3,1,this.la.kqh,Object(n.a)(this,this.dismissImageDescriptionBarTask,"dismissImageDescriptionBarTask"),90,"19"),this.iBh(t))}Cul(t){this.ua===t&&this.Z8&&this.iBh(this.ua.get_alt())}$m(t){this.nbb=t.ya;this.ywi()}XD(t){if(this.Z8&&!this.yo)switch(t){case 1:t=this.fe.Yj("formatpainterobject.cur");this.jEa.Pk(pb.a.nP(t,Ub.a.hlc));break;case 0:this.jEa.Pk(Ub.a.hlc)}}kq(){return null}IP(){return!1}Ux(t){this.yo=t}dispose(){this.CGc();this.Cca&&(this.qTa=this.Z9a=this.dxb=this.jEa=this.Cca=null)}nz(){}XE(){return null}QD(){return[]}draw(){this.Z8&&
this.uSe(!0)}get visible(){return this.kEa}set visible(t){this.Z8&&(this.kEa!==t&&(this.kEa=t,this.Cca.setVisibility(this.kEa)),this.kEa||this.CGc())}setPosition(){}Ej(t){this.yd=t;this.Z8&&(this.g$c(),this.hBh())}Uq(t){this.t_=t;this.Z8&&this.g$c()}pv(t){this.Mt=t;this.Z8&&this.g$c()}setZIndex(t){this.Z8&&this.Cca.uC(t)}AF(t,N){this.Z8&&(this.uSe(!t&&N||!N),t||this.yb.B4(this.IXc,this.la.kqh))}setSelection(){}ywi(){this.Cca=new Bc.a;this.jEa=new Td.a;this.jEa.Cma("ImageDescriptionBarBackground");
this.gd.ob(ka.a.click,this.jEa.ya,Object(n.a)(this,this.Kkk,"onImageDescriptonBarClickHandler"));this.dxb=new Vd.a;this.dxb.appendChild(this.jEa);this.Z9a=new qd;this.Z9a.ot("ImageDescriptionBarText");this.hBh();this.qTa=new Bc.a;this.qTa.ot("ImageDescriptionBarTextWrappingDiv");this.qTa.appendChild(this.Z9a);this.Cca.appendChild(this.dxb);this.Cca.appendChild(this.qTa)}iBh(t){const N=t.indexOf("\n");this.GHg=-1===N?t:t.substring(0,N);this.Z9a.U5k(ResourceStrings.L_ShapeAltText+": "+this.GHg);this.uSe(!0)}uSe(t){this.Sm=
this.ua.Fq;this.kEa=t;this.g$c();this.Cca.setVisibility(this.kEa);this.jSa||(this.jSa=!0,this.yb.Gb(this.IXc))}hBh(){this.Z9a.ya.style.fontSize=this.dC.nha(29)}Kkk(){this.ia.processAction(tb.a.hAc,2);return!0}IGa(){this.CGc()}dismissImageDescriptionBarTask(){this.CGc()}CGc(){this.Z8&&(this.kEa=this.Z8=!1,this.nb.zHa(Object(n.a)(this,this.IGa,"onSelectionChange")),this.jSa&&(this.yb.Qg(this.IXc),this.jSa=!1),this.nbb&&this.nbb.contains(this.Cca.ya)&&this.nbb.removeChild(this.Cca.ya))}g$c(){if(this.Z8&&
this.Sm){var t=this.Sm.copy();this.t_.il(t);this.Mt.il(t);this.Hoe=Mb.a.cO(Ua.a.bG(t.ga(0),t.ga(1)));var N=t.Zj(new rb.a(6)),ha=t.Zj(new rb.a(4));t=t.Zj(new rb.a(2));t=Ua.a.Rl(ha,t)*this.yd;ha=Ua.a.Rl(N,ha)*this.yd;if(60>ha||80>t)this.kEa=!1;else{t=this.nbb.children[0].style;this.dxb.setPosition(this.WIb(t.left),this.WIb(t.top));this.dxb.yh(this.WIb(t.width),this.WIb(t.height));var Aa=this.dC.Ge(Kc.a.Ef(40,1),1);this.qTa.setPosition(N.x*this.yd,N.y*this.yd-Aa);this.qTa.yh(ha,Aa);this.qTa.ya.style.transform=
this.qOa(this.Hoe);this.Z9a.yh(ha-9,Aa-6);var Ra=new gc.a;Ra.s6(this.Hoe,new Ua.a(0,Aa));Ra.sB(N.x*this.yd-this.WIb(t.left),N.y*this.yd-this.WIb(t.top)-Aa);this.jEa.YD(Ra,1);this.jEa.yh(ha,Aa)}}}WIb(t){t=parseFloat(t);return isNaN(t)?0:t}qOa(t){return"rotate("+t.toString()+"deg)"}}Object(h.a)(Be,"ImageDescriptionBarView",null,[822,387,388,106]);var Id=d(985),gb=d(45),Xb=d(37);class Ic{constructor(t,N,ha,Aa){this.shapeNode=t;this.FIc=N;this.tKj=ha;this.imageDescription=Aa}}Object(h.a)(Ic,"ImageDescriptionCache",
null,[]);var Wc=d(212);class Ib{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd){this.v8=new Id.a;this.Qb=t;this.ni=N;this.xq=Sb;this.S9a=ha;this.nb=Aa;this.$Z=yb;this.L1j=Ra;this.Tw=uc;this.Db=Zc;this.Xb=ed;this.tje=Gd}initialize(){this.Tw.xk(Object(n.a)(this,this.xh,"onPropertyChanged"));this.xq.LCf(Object(n.a)(this,this.tCb,"onShapeImageFirstDraw"));this.xq.b4h(Object(n.a)(this,this.pZg,"onLocalImageViewDismissed"));this.S9a.X3h(Object(n.a)(this,this.NYg,"onImageDescriptionReady"))}dispose(){this.Tw.Tm(Object(n.a)(this,
this.xh,"onPropertyChanged"));this.xq.RDe(Object(n.a)(this,this.tCb,"onShapeImageFirstDraw"));this.xq.JPk(Object(n.a)(this,this.pZg,"onLocalImageViewDismissed"));this.S9a.GPk(Object(n.a)(this,this.NYg,"onImageDescriptionReady"))}xh(t,N){(t=N.node)&&t.qk&&(N=N.property,N===Xb.a.alt?((N=Object(M.a)(124,t.oc(this.Qb.Ma)))&&N.KP&&t.get_alt()&&this.tje.xP(t).Cul(t),this.L1j.Rsl(t),t.get_alt()&&this.ghd(t,t.get_alt())):N===Xb.a.wA?t.wA&&(N=Object(M.a)(124,t.oc(this.Qb.Ma)))&&N.KP&&(this.tje.xP(t).visible=
!1):N===Xb.a.lh&&t.lh!==Wc.a.sS&&(N=Object(M.a)(124,t.oc(this.Qb.Ma)))&&N.KP&&!t.qca&&this.v8.ga(t.id)&&this.v8.ga(t.id).FIc&&(this.trb(t,N),this.v8.remove(t.id)))}NYg(t,N){if(t=N.iOc){var ha=N.confidence,Aa=N.imageDescription,Ra=N.AGj;N=N.FIc;var yb=this.$Z.Eba(t),Sb=yb?Object(M.a)(124,yb.oc(this.Qb.Ma)):null;N?Sb&&Sb.KP&&!yb.isLocal&&!yb.wA?this.trb(yb,Sb):this.v8.add(t,new Ic(yb,!0,!0,Aa)):!Aa||!Ra&&60>ha?L.a.J(33609505,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Ra,ha):(Aa=this.Tpi(ha,
Aa),Ra?this.IHe(yb,Aa,!1):(L.a.J(34194368,815,50,"Image description ready for show and save"),Sb&&Sb.KP?(L.a.J(34194370,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",t.toString(),(new Date).getTime()),this.ghd(yb,Aa),yb.isLocal?this.v8.add(t,new Ic(yb,!1,!1,Aa)):(L.a.J(34194372,815,50,"Save image description immediately"),this.IHe(yb,Aa,!0))):this.v8.add(t,new Ic(yb,!1,!0,Aa))))}else L.a.J(33609503,815,15,"Graph node id is null")}tCb(t,N){t=N.iOc;L.a.J(34194374,815,50,
"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",t?t.toString():"",(new Date).getTime());this.v8.Jb(t)?this.d7g(t):(t=this.$Z.Eba(t))&&t.get_alt()&&this.ghd(t,t.get_alt())}Tpi(t,N){N+=String.fromCharCode(10,10);return N=80<=t?N+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=t?N+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=t?N+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=t?N+ResourceStrings.L_ImageDescriptionWithLowConfidence:N+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}pZg(t,
N){(t=N.mfl)&&this.v8.Jb(t.id)&&this.d7g(t.id)}d7g(t){const N=this.v8.ga(t).shapeNode;if(N){var ha=this.v8.ga(t).FIc,Aa=this.v8.ga(t).tKj,Ra=this.v8.ga(t).imageDescription;ha?(ha=Object(M.a)(124,N.oc(this.Qb.Ma)))&&this.trb(N,ha):(Aa&&this.ghd(N,Ra),N.isLocal?L.a.J(33609539,815,15,"Try to save alt text for local picture"):this.IHe(N,Ra,!0));this.v8.remove(t)}else L.a.J(37029889,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}trb(t,N){this.ni.generateImageDescription(t.id,N.MMe,
t.get_isSVGBlipFilled(),!1)}IHe(t,N,ha){if(!ha||!t.get_alt()){var Aa=this.Db.je(ha?7:15);Aa.jc(t);t.qYa=ha;t.set_alt(gb.a.dRa(N));Aa.dispose();ha&&this.ni.forceOutbound()}}ghd(t,N){if(t.qk){this.Xb.Zc(t)&&L.a.J(34079445,815,50,"Graph node or parents blocked");var ha=this.nb.ae();ha&&this.nb.WV(t)?(L.a.J(33609545,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",t.id.toString(),(new Date).getTime()),this.tje.xP(t).Rbl(N)):L.a.J(33609543,815,50,"Is selected shapes empty: {0}",
!ha)}else L.a.J(33609541,815,50,"ShapeNode.IsPicture: {0}",t.qk)}}Object(h.a)(Ib,"ImageDescriptionManager",null,[106]);var ec=d(93),Jb=d(332),hb=d(60),Rc=d(71),gd=d(40),hd=d(46);class Hd{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze){this.ua=null;this.RS=0;this.e_c=!0;this.vje=new Id.a(0);this.tE=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.gb&&v.AFrameworkApplication.Aa.gb.UV;this.fh=t;this.Nb=N;this.fe=ha;this.Fa=ed;this.ni=Aa;this.gd=Ra;this.nb=yb;this.yD=Sb;this.c_=uc;this.Db=Zc;
this.S9a=Gd;this.TG=ze;this.vb=document.createElement("div");this.vb.className=hb.a.Tkg;this.vb.id=hb.a.Tkg;this.vb.style.position=Rc.a.Jwa;this.vb.setAttribute(na.a.We,na.a.Kza);this.vb.setAttribute(na.a.y6,"ImageDescriptionPaneLabel");this.gd.ob(ka.a.click,this.vb,Object(n.a)(this,this.vgh,"rootElementClickHandler"));this.c_.addHandler(this.vb,ka.a.eg,Object(n.a)(this,this.Pra,"inputKeyPressHandler"));this.Ib=!1;this.yEa=pb.a.Ee();this.yEa.className="ImageDescriptionPaneLayoutRoot";this.fo=this.rAa("per",
"ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.fo,"ImageDescriptionPaneCloseButton");this.fo.setAttribute(na.a.We,na.a.Xt);this.yEa.appendChild(this.fo);this.gd.ob(ka.a.click,this.fo,Object(n.a)(this,this.Uob,"closeButtonClickHandler"));this.c_.addHandler(this.fo,ka.a.focus,Object(n.a)(this,this.cCb,"onElementFocused"));this.z8b=pb.a.Ee();this.z8b.id="ImageDescriptionPaneLabel";this.z8b.className="PaneLabel";this.z8b.innerText=ResourceStrings.L_ShapeAltText;this.yEa.appendChild(this.z8b);
this.pZc=pb.a.Ee();this.pZc.innerText=ResourceStrings.l_ImageDescriptionPaneLabel;this.pZc.className="ImageDescriptionLabel";this.yEa.appendChild(this.pZc);this.oZc=pb.a.Ee();this.oZc.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.oZc.className="ImageDescriptionHint";this.yEa.appendChild(this.oZc);this.uje=pb.a.Ee();this.tI=document.createElement("textarea");this.tI.className="AltTextTextArea";this.tI.setAttribute(na.a.vs,ResourceStrings.L_ShapeAltText);this.tI.tabIndex=0;this.uje.appendChild(this.tI);
this.yEa.appendChild(this.uje);this.gd.ob(ka.a.click,this.tI,Object(n.a)(this,this.cEf,"altTextboxClickHandler"));this.c_.addHandler(this.tI,ka.a.eg,Object(n.a)(this,this.dEf,"altTextboxTypingHandler"));this.c_.addHandler(this.tI,ka.a.focus,Object(n.a)(this,this.cCb,"onElementFocused"));t=pb.a.zn();t.className="GenerateDescriptionButtonText";t.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltip;t.setAttribute("Unselectable","on");this.WS=pb.a.Saa();this.WS.className="ImageDescriptionPaneButton cui-ctl";
this.WS.setAttribute(na.a.We,na.a.Xt);this.WS.tabIndex=0;this.WS.appendChild(t);this.yEa.appendChild(this.WS);this.gd.ob(ka.a.click,this.WS,Object(n.a)(this,this.F5f,"generateDescriptionClickHandler"));this.c_.addHandler(this.WS,ka.a.focus,Object(n.a)(this,this.cCb,"onElementFocused"));this.yD.v7(hd.a.Lra,hd.a.gj,this.vb,()=>{this.ZW(!0)},()=>{this.ZW(!1)},!0);this.yD.v7(hd.a.lHd,hd.a.gj,this.tI,()=>{this.xYg(!0)},()=>{this.xYg(!1)},!0);this.S9a.y4h(Object(n.a)(this,this.a0g,"onShowHideAltTextPane"))}Nwj(){this.jki()&&
(this.tI.disabled=!1,this.tI.value=this.ua.get_alt(),this.vb.appendChild(this.yEa),this.WS.style.display=this.ua.isLocal?Rc.a.Sf:Rc.a.Rk,this.Ib=!0,this.vb.style.display=Rc.a.Rk,this.tE?(this.Wyc(this.vb),this.TG.KL(this,this.Ib,ResourceStrings.L_ShapeAltText,hd.a.Lra)):this.Nb.yq(),this.nb.XJ(Object(n.a)(this,this.IGa,"onSelectionChange")),L.a.J(512233536,815,50,"ImageDescriptionPane::InitializeAndShow"))}dispose(){this.PCc();this.S9a.$Pk(Object(n.a)(this,this.a0g,"onShowHideAltTextPane"));this.gd.xb(ka.a.click,
this.vb,Object(n.a)(this,this.vgh,"rootElementClickHandler"));this.c_.removeHandler(this.vb,ka.a.eg,Object(n.a)(this,this.Pra,"inputKeyPressHandler"));this.gd.xb(ka.a.click,this.fo,Object(n.a)(this,this.Uob,"closeButtonClickHandler"));this.c_.removeHandler(this.fo,ka.a.focus,Object(n.a)(this,this.cCb,"onElementFocused"));this.gd.xb(ka.a.click,this.tI,Object(n.a)(this,this.cEf,"altTextboxClickHandler"));this.c_.removeHandler(this.tI,ka.a.eg,Object(n.a)(this,this.dEf,"altTextboxTypingHandler"));this.c_.removeHandler(this.tI,
ka.a.focus,Object(n.a)(this,this.cCb,"onElementFocused"));this.gd.xb(ka.a.click,this.WS,Object(n.a)(this,this.F5f,"generateDescriptionClickHandler"));this.c_.removeHandler(this.WS,ka.a.focus,Object(n.a)(this,this.cCb,"onElementFocused"));this.WS=this.tI=this.uje=this.oZc=this.pZc=this.z8b=null;L.a.J(512233507,815,50,"ImageDescriptionPane::Dispose")}Rsl(t){this.ua&&t===this.ua&&this.Ib&&(this.vje.Jb(t.id.toString())&&this.ua.lh!==this.vje.ga(t.id.toString())&&L.a.J(512233506,815,50,"ImageDescriptionPane::UpdateAltTextbox - Image version have been changed after generate description"),
2!==this.RS&&(this.tI.value=this.ua.get_alt()))}layout(t,N){const ha=N?t.wC(this.width):t.xC(this.width);this.Ib&&(N?(Sys.UI.DomElement.addCssClass(this.vb,hb.a.Vkg),ha.wC(hb.a.K4d)):(Sys.UI.DomElement.addCssClass(this.vb,hb.a.Ukg),ha.xC(hb.a.K4d)));pb.a.zX(this.vb,ha);return t}get isVisible(){return this.Ib}get ya(){return this.vb}get order(){return 10}ZW(t){this.Ib&&(t?0===this.RS&&this.Wxh():this.RS=0)}xYg(t){this.Ib&&(t||this.pIe(),this.Nb.updateCommandUI())}dEf(t){t.keyCode===qa.a.H0&&t.ctrlKey?
this.YFb():(2!==this.RS&&this.zkh(),this.RS=2)}Pra(t){this.Ib&&(t.keyCode===qa.a.aq||t.keyCode===qa.a.xO?1===this.RS?this.bK():3===this.RS?this.trb():2===this.RS&&(this.WS.style.display=Rc.a.Rk):2===this.RS&&(this.WS.style.display=Rc.a.Rk))}Wxh(){ec.FocusManager.Dr(this.fo)?(this.YFb(),this.RS=1):L.a.J(512233505,815,50,"Fail to set focus on close button")}YFb(){this.Fa.qC(hd.a.Lra)}zkh(){this.Fa.qC(hd.a.lHd)}jki(){const t=this.nb.ae();if(!t||1<t.length||!t[0].qk)return L.a.J(512233504,815,50,"ImageDescriptionPane::CheckAndCacheShapeNode - shape node is null: {0}",
!t),!1;this.ua=t[0];return!0}Uob(){this.bK();return!0}bK(){this.Ib&&(this.PCc(),this.Fa.Gj(hd.a.Lra,!1),L.a.J(512233503,815,50,"ImageDescriptionPane::CloseButtonClickHandler - Image Description pane close button clicked."))}vgh(){this.Ib&&(this.YFb(),this.RS=0);return!0}cEf(){this.zkh();this.RS=2;return!0}F5f(){this.YFb();this.trb();return!0}trb(){this.RS=3;this.WS.style.display=Rc.a.Sf;this.Wxh();const t=this.ua?Object(M.a)(124,this.ua.oc(0)):null;t?(this.vje.add(this.ua.id.toString(),this.ua.lh),
this.ni.generateImageDescription(this.ua.id,t.MMe,this.ua.get_isSVGBlipFilled(),!0)):L.a.J(512233502,815,15,"ImageDescriptionPane::GenerateDescriptionClickHandler - Is shape node null {0}",!this.ua)}a0g(){this.Ib?this.PCc():(this.Nwj(),this.RS=0);this.Fa.Gj(hd.a.Lra,this.Ib);L.a.J(512233501,815,50,"ImageDescrptionPane::ShowOrHidePane {0}",!this.Ib)}Ssl(t){t=t.ae();this.e_c&&this.pIe();1===t.length&&t[0].qk?(this.ua=t[0],this.e_c=!0,this.tI.value=this.ua.get_alt(),this.tI.disabled=!1,this.WS.style.display=
this.ua.isLocal?Rc.a.Sf:Rc.a.Rk):(this.WS.style.display=Rc.a.Sf,this.tI.disabled=!0,this.tI.value=null,this.e_c=!1)}IGa(t){gd.a("ChangePictureAltTextFixEnabled")?this.Ssl(t):this.PCc();this.fh.qo(hd.a.Lra)}cCb(t){this.Ib&&(t.target===this.fo?this.RS=1:t.target===this.tI?this.RS=2:t.target===this.WS&&(this.RS=3))}PCc(){this.Ib&&(this.nb.zHa(Object(n.a)(this,this.IGa,"onSelectionChange")),this.e_c&&this.pIe(),this.Ib=!1,this.vb.removeChild(this.yEa),this.vb.style.display=Rc.a.Sf,this.tE?(this.Wyc(this.vb),
this.TG.KL(this,this.Ib,ResourceStrings.L_ShapeAltText,hd.a.Lra)):this.Nb.yq(),L.a.J(512233500,815,50,"ImageDescriptionPane::CleanUpAndHide"))}Wyc(t){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(t,hb.a.Vkg):Sys.UI.DomElement.addCssClass(t,hb.a.Ukg)}pIe(){const t=this.tI.value;if(!(gd.a("ChangePictureAltTextFixEnabled")&&null===t||t===this.ua.get_alt())){var N=this.Db.je(15);N.jc(this.ua);this.ua.qYa=!1;this.ua.set_alt(t);N.dispose()}}rAa(t,N){return this.qAa(t,"cui-img-16by16","cui-ctl-iconContainer",
N,CommonUIStrings.l_DialogClose,null)}qAa(t,N,ha,Aa,Ra,yb){const Sb=pb.a.CB();Sb.alt=Ra;Sb.className=Ga.getImageClassWithCluster(t,Aa);Sb.src=this.fe.Yj(t+".png");Sb.setAttribute("Unselectable","on");t=pb.a.zn();t.className=N+" cui-img-cont-float";t.appendChild(Sb);N=pb.a.zn();N.className=ha;N.setAttribute("Unselectable","on");N.appendChild(t);ha=pb.a.Saa();ha.className="ImageDescriptionPaneNoBorderButton cui-ctl";ha.title=Ra;ha.setAttribute(na.a.We,na.a.Xt);ha.tabIndex=0;ha.appendChild(N);yb&&(Ra=
pb.a.zn(),Ra.className="cui-ctl-mediumlabel",Ra.setAttribute("Unselectable","on"),Ra.innerText=yb,ha.appendChild(Ra));return ha}get width(){return this.Ib?hb.a.juj+hb.a.K4d+Jb.a.QHa:0}}Object(h.a)(Hd,"ImageDescriptionPane",null,[800,481,106]);var Xd=d(276);class id{constructor(){this.K=null;this.tE=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.gb&&v.AFrameworkApplication.Aa.gb.UV}get name(){return"PowerPointWebEditor.ImageDescription"}Wb(t){this.K=t;this.K.register(336,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").ma().na(()=>
new Xd.a(N=>{let ha=null;const Aa=Object(M.a)(124,N.oc(t.resolve("Box4.IPageView").Ma));Aa&&!Aa.ll&&(ha=new Be(N,this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView").Cd),ha.$m(Aa.PT),Aa.zza(ha,4));return ha}));this.K.register(800,"PowerPointWebEditor.IImageDescriptionPane").ma().na(()=>
new Hd(this.K.resolve("Common.IF6Manager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(Ib,"PowerPointWebEditor.ImageDescriptionManager").ma().na(()=>new Ib(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IImageDescriptionPane"),
this.K.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(10),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").GRa&&
(this.tE||this.K.resolve("PowerPointWebEditor.IPaneManager").uM(this.K.resolve("PowerPointWebEditor.IImageDescriptionPane")),this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").GRa&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){e.a.instance.Ac(mc.a(new id,0))}}Object(h.a)(id,"PPTWebEditorImageDescriptionPackage",null,[2,3]);var fd=d(82);class Vf extends fd.a{constructor(t){super(!1,
!1,!0);this.yoc=t}start(){const t={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.yoc.x4d}};this.pj("",Object(n.a)(this,this.QUk,"resultHandler"),t)}QUk(t,N){1===t&&(this.yoc.x4d=N.tooltipPersistenceEnabled)}}Object(h.a)(Vf,"AccessibilitySettingsDialog",fd.a,[]);class Qd{constructor(t,N){this.Ca=t;this.yoc=N}ub(){this.Ca.xa(G.a.ual,E.a.frame,Object(n.a)(this,this.wal,"showAccessibilitySettingsDialogHandler"))}wal(){(new Vf(this.yoc)).start();return 32}}Object(h.a)(Qd,
"AccessibilitySettingsDialogActor",null,[846]);var Zf=d(1021);const Ge=t=>{const N=new Zf.a;v.AFrameworkApplication.He.vj(le(t),1,null,null,!0,2,ha=>{200===ha.data.af?N.Bg("true"===ha.data.Zd.toLowerCase()):N.Bg(!1)},()=>{N.Bg(!1)},null,void 0,void 0,void 0,void 0,"7");return N.task},le=t=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",v.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",t,v.AFrameworkApplication.Zg);var Sa=d(73);class Cb{constructor(){this.Vjb=
null}get x4d(){return!!this.Vjb}set x4d(t){t!==this.Vjb&&(this.Vjb=t,Sa.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(t),this.kwg()&&v.AFrameworkApplication.He.vj(le("saveHoverableRibbonTooltipIsEnabled"),2,t.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}HTj(){const t=new Zf.a;if(this.Vjb)t.Bg(this.Vjb);else if(this.kwg()){const N=Ge("getHoverableRibbonTooltipIsEnabled");N.continueWith(()=>{this.Vjb=N.result;Sa.a("setHoverableTooltipsPreference")&&
appChrome.api.setHoverableTooltipsPreference(N.result);t.Bg(N.result)},8)}else t.Bg(!1)}kwg(){const t=v.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),N=v.AFrameworkApplication.fa.ka("IsAnonymousUser");return t&&!N}}Object(h.a)(Cb,"AccessibilitySettingsInfo",null,[845]);class rc{constructor(){this.Da=null}get name(){return"Common.App.AccessibilitySettings"}Wb(t){this.Da=t;this.Da.register(Cb,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").na(()=>
new Cb).ma();this.Da.register(Qd,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").na(()=>new Qd(v.AFrameworkApplication.Ta,this.Da.pb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ma()}init(){const t=this.Da.pb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),N=this.Da.pb("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");t&&N?(N.ub(),t.HTj()):K.c(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){e.a.instance.Ac(new rc)}}Object(h.a)(rc,"AccessibilitySettingsPackage",null,[2,3]);var bd=d(89),pd=d(243),Oa=d(1086),jb=d(80),nc=d(692);class kb extends Fa.StandardDialog{constructor(t,N,ha,Aa=null){super();this.i1=this.Lr=this.DKa=null;this.Ev=[];this.evc=N;this.OO=t;this.zMh=ha;this.Ewc=Aa;this.Vlb=new nc.a("LoadResource","LoadPrintablePdf")}Cha(){this.vd=
5;this.width=40;const t=document.createElement("span");t.id=this.hi("DirectPrintHeaderContent");const N=document.createElement("span");N.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(N,"DirectPrintHeader");this.i1=document.createElement("iframe");this.i1.name="pdfObjectFrame";this.i1.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.i1.onload=Object(n.a)(this,this.gAk,"printablePdfLoaded");if(this.Ewc&&0<this.Ewc.count){var ha=jb.a.E_d(this.evc,this.Ewc);const Aa=
jb.a.vDe(this.evc,this.Ewc);this.Lr=document.createElement("form");this.Lr.id="printPreviewPostForm";this.Lr.method="POST";this.Lr.target=this.i1.name;this.Lr.action=Aa;for(let Ra of ha)ha=document.createElement("input"),ha.type="hidden",ha.name=Ra.key,ha.value=Ra.value,this.Lr.appendChild(ha)}else this.i1.setAttribute("src",this.evc);Sys.UI.DomElement.addCssClass(this.i1,pd.a.bff);this.zMh?(Sys.UI.DomElement.addCssClass(this.i1,"DirectPrintPdfObjectHidden"),N.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
na.a.lO(this.i1,na.a.YJ,na.a.vB)):(Sys.UI.DomElement.addCssClass(this.i1,"DirectPrintPdfObject"),this.Ev.push(this.i1));t.appendChild(N);t.appendChild(document.createElement("br"));t.appendChild(this.i1);this.Lr&&t.appendChild(this.Lr);t.appendChild(document.createElement("br"));t.appendChild(this.tsi(this.Lr?"#":this.evc));this.Vlb.start();this.aBb(CommonUIStrings.l_AppTitle,null,null,null,null,t);this.J4(this.hi("DirectPrintHeaderContent"));this.Lr&&this.Lr.submit();this.Zwi();m.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}tsi(t){const N=document.createElement("span");var ha=document.createElement("span");ha.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;N.appendChild(ha);v.AFrameworkApplication.fa&&(2===v.AFrameworkApplication.Aa.gb.Am&&v.AFrameworkApplication.fa.ka("PPTDisableDirectPrintDialogDownloadPDFLink")||1===v.AFrameworkApplication.Aa.gb.Am&&v.AFrameworkApplication.fa.ka("XLODisableDirectPrintDialogOpenPDFLink"))?(t=document.createElement("span"),2===
v.AFrameworkApplication.Aa.gb.Am?t.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.Aa.gb.Am&&(t.innerText=CommonUIStrings.l_InternalError_Directive,m.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.DKa=t,N.appendChild(document.createElement("br")),N.appendChild(t)):(ha=document.createElement("a"),ha.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,ha.href=t,ha.target="_blank",ha.id="PrintPDFLink",ha.className=
"AllowBrowserClick",this.DKa=ha,N.appendChild(document.createElement("br")),N.appendChild(ha),this.Lr&&bd.a.addHandler(ha,"click",Object(n.a)(this,this.Rok,"onSubmit")),this.OO.ob(ka.a.click,this.DKa,Object(n.a)(this,this.RXf,"downloadPDFLinkClicked"),null));this.Ev.push(this.DKa);return N}Rok(t){this.Lr&&(this.Lr.target="_blank",this.Lr.submit());t.preventDefault()}Zwi(){if(0<this.Ev.length){const t=new Oa.a(this.Ev),N=ec.FocusManager.instance().Zk();N&&(this.DKa.focus(),N.qj=t,N.cW=!0)}}RXf(){m.ULS.sendTraceTag(4585050,
328,50,"Download PDF from Direct Print dialog clicked.");return!1}n9a(){m.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}gAk(){m.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Vlb&&this.Vlb.stop()}dispose(){this.DKa&&(this.OO.xb(ka.a.click,this.DKa,Object(n.a)(this,this.RXf,"downloadPDFLinkClicked")),this.DKa=null);sa.a.fO(this.i1);this.i1=null;super.dispose()}}Object(h.a)(kb,"DirectPrintDialog",Fa.StandardDialog,[889]);class Gb{constructor(t){this.OO=
t}B1i(t,N){return new kb(this.OO,t,N,null)}}Object(h.a)(Gb,"DirectPrintDialogFactory",null,[863]);var tc=d(1157),dd=d(62);class $c{constructor(t,N){this._url=t;this.oRh=N}tXf(){this.oRh?dd.a.downloadFile(this._url):dd.a.Um(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(h.a)($c,"OpenUrlInTabDialogDownloadBehavior",null,[925,106]);var Pc=d(54);class Ad extends Fa.StandardDialog{constructor(t,N=!0,ha=!1,Aa=null,Ra=null,yb=!1){super();this.Ljb=this.Kjb=this.Lr=
this.X$=null;var Sb=this.SPe?this.SPe:CommonUIStrings.l_DefaultDialogTitle;Ad.ktb=yb;this.frd=Aa||new $c(t,!0);const uc=[],Zc=[];Ad.y0&&(this.Wzc&&this.Wzc.forEach(ze=>{Array.add(uc,ze)}),this.tDf&&this.tDf.forEach(ze=>{Array.add(Zc,ze)}));N?ha?(this.vd=4,this.Re(1,this.buttonText),this.Re(2,CommonUIStrings.l_DialogClose)):(this.vd=6,this.Re(0,CommonUIStrings.l_DialogClose)):this.vd=5;yb=document.createElement("span");this.LWb&&(yb.className=this.LWb);Aa=document.createElement("a");Aa.innerText=this.awb;
Aa.href=t;Aa.target="_blank";Aa.id=this.G5b;Aa.className=va.AFrame.YDf;var ed=!Pc.a.yS&&!!Ra&&0<Ra.count;if(ed){const ze=jb.a.E_d(t,Ra);Ra=jb.a.vDe(t,Ra);Aa.href="#";Aa.target="_self";this.Lr=document.createElement("form");this.Lr.id="printPreviewPostForm1";this.Lr.method="post";this.Lr.target="_blank";this.Lr.action=Ra;for(var Gd of ze)Ra=document.createElement("input"),Ra.type="hidden",Ra.name=Gd.key,Ra.value=Gd.value,this.Lr.appendChild(Ra)}else this.Lr=null;this.Lr||Ad.ktb?Ad.ktb||Array.add(Zc,
{["type"]:"AppLinkProps",["id"]:this.G5b,["text"]:this.awb,["onExecute"]:()=>{this.G$g()}}):Array.add(Zc,{["type"]:"AppLinkProps",["id"]:this.G5b,["text"]:this.awb,["handler"]:{["href"]:ed?"#":t,["target"]:ed?"_self":"_blank"}});this.ala&&Array.add(uc,this.ala);ha?(t=document.createElement("span"),t.innerText=this.ala.replace("{0}",""),yb.appendChild(t)):this.OSg?(t=document.createElement("span"),t.id=this.hi("message"),Gd=document.createElement("span"),Ra=document.createElement("span"),ed=this.ala.split("{0}"),
Gd.innerText=ed[0],Ra.innerText=ed[1],t.appendChild(Gd),t.appendChild(Aa),t.appendChild(Ra),yb.appendChild(t)):(t=document.createElement("span"),t.innerText=this.ala,yb.appendChild(t),yb.appendChild(document.createElement("br")),yb.appendChild(document.createElement("br")),yb.appendChild(Aa),Ad.ktb||Array.add(uc,"{0}"));this.Lr&&yb.appendChild(this.Lr);Ad.y0&&(this.xSa&&(this.D5b?this.EAf(this.xSa,this.D5b):(Array.add(uc,"{0}"),Array.add(Zc,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.xSa,
["onExecute"]:()=>{this.dVc()}}))),this.Syc(uc,Zc));this.aBb(Sb,null,this.B4d,null,Object(n.a)(this,this.T1,"dialogHandler"),Ad.y0?null:yb);this.J4(this.hi("message"));!Ad.y0&&this.D5b&&this.xSa&&(Sb=document.createElement("div"),Sb.className="WACDialogLearnMoreLinkContainer",this.X$=document.createElement("a"),this.X$.innerText=this.xSa,this.X$.href=this.D5b,this.X$.target="_blank",this.X$.id=this.hi("LearnMoreLinkId"),this.X$.className=va.AFrame.YDf,Sb.appendChild(this.X$),N?this.pc.insertBefore(Sb,
this.pc.lastChild):this.pc.appendChild(Sb),this.J4(String.format("{0} {1}",this.hi("message"),this.hi("LearnMoreLinkId"))));this.QLb=Aa;ha?this.MQ(this.DC):this.MQ(this.QLb);this.V5b();v.AFrameworkApplication.Aa.VQ.ob(ka.a.click,this.QLb,Object(n.a)(this,this.QXf,"downloadLinkClicked"),null);this.X$&&v.AFrameworkApplication.Aa.VQ.ob(ka.a.click,this.X$,Object(n.a)(this,this.dVc,"learnMoreLinkClicked"),null);this.X_e=!1}get B4d(){return null}get SPe(){return null}get ala(){return null}get D5b(){return null}get xSa(){return null}get OSg(){return!1}get buttonText(){return CommonUIStrings.l_Open}get LWb(){return null}get Wzc(){return null}get tDf(){return null}A6(){this.Lr&&
(this.Kjb||(this.Kjb=Object(n.a)(this,this.Lgk,"onActionButtonClicked"),this.Vm.ob(ka.a.click,this.DC,this.Kjb)),this.Ljb||(this.Ljb=Object(n.a)(this,this.Mgk,"onActionButtonKeyUp"),this.Ig.ob(ka.a.ol,this.DC,this.Ljb)));super.A6()}Lgk(t){this.l0f(t);return!0}Mgk(t){return this.CUc(t,Object(n.a)(this,this.l0f,"executeDismissActionButtonFromArgs"))}l0f(t){this.Lr&&this.Lr.submit();this.Z4a(t.Fc)}n9a(){}QXf(){this.X5b();this.Lr?this.Lr.submit():this.frd.tXf();return!0}dVc(){return!1}dispose(){this.frd.dispose();
this.QLb&&(v.AFrameworkApplication.Aa.VQ.xb(ka.a.click,this.QLb,Object(n.a)(this,this.QXf,"downloadLinkClicked")),this.QLb=null);this.X$&&(v.AFrameworkApplication.Aa.VQ.xb(ka.a.click,this.X$,Object(n.a)(this,this.dVc,"learnMoreLinkClicked")),this.X$=null);this.Vm&&this.Kjb&&(this.Vm.xb(ka.a.click,this.DC,this.Kjb),this.Kjb=null);this.Ig&&this.Ljb&&(this.Ig.xb(ka.a.ol,this.DC,this.Ljb),this.Ljb=null);super.dispose()}G$g(){this.Lr&&(document.body.appendChild(this.Lr),this.Lr.submit(),document.body.removeChild(this.Lr))}T1(t){1===
t&&(this.n9a(),this.Lr?Ad.y0&&this.G$g():this.frd.tXf());this.dispose()}static get y0(){return v.AFrameworkApplication.Aa.gb.QB&&v.AFrameworkApplication.Aa.gb.Yvg}static get ktb(){return Ad.o4e}static set ktb(t){Ad.o4e=t}}Ad.o4e=!1;Object(h.a)(Ad,"ADialogWithLinkToResource",Fa.StandardDialog,[]);class Ee extends Ad{constructor(t,N,ha=null,Aa=!0,Ra=!1){super(t,!0,!(Ee.zZa&&Aa),new $c(t,N),ha,Ra);Ee.zZa=Ee.zZa&&Aa;if(Ee.zZa){N=document.createElement("iframe");Aa=null;Ra=this.FFi;N.name="pdfObjectFrame";
N.id="pdfObjectIFrame";if(ha&&0<ha.count){const yb=jb.a.E_d(t,ha);t=jb.a.vDe(t,ha);Aa=document.createElement("form");Aa.id="printPreviewPostForm";Aa.method="POST";Aa.target=N.name;Aa.action=t;for(let Sb of yb)t=document.createElement("input"),t.type="hidden",t.name=Sb.key,t.value=Sb.value,Aa.appendChild(t)}else N.src=t;Ra.appendChild(N);Aa&&(Ra.appendChild(Aa),Aa.submit());Sys.UI.DomElement.addCssClass(N,"DirectPrintPdfObjectHidden");na.a.lO(N,na.a.YJ,na.a.vB)}}get B4d(){return"Print_32x32x32"}get SPe(){return Ee.zZa?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get ala(){return Ee.zZa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get Wzc(){const t=[];Array.add(t,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Ad.ktb){let N=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.Aa.gb.VTf&&(N=v.AFrameworkApplication.Aa.gb.VTf);Array.add(t,N)}return Ee.zZa?t:null}get awb(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get G5b(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get LWb(){return v.AFrameworkApplication.qqa?
"UIFontDialogTextLarge":null}V5b(){m.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}X5b(){v.AFrameworkApplication.Zi.F7a(9540,1);m.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}n9a(){m.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get zZa(){return!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.gb.QB&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Pc.a.yS||Pc.a.xj||Pc.a.$f||Pc.a.C4b)&&!v.AFrameworkApplication.c5b&&
v.AFrameworkApplication.fa.ka("ShouldHostDefaultToNativeBrowserPrintExperience")}static set zZa(t){}}Object(h.a)(Ee,"PrintDialogWithLinkToPdf",Ad,[]);class Ce{constructor(t){this.isEnabled=Boolean.parse(t.DirectPrintIsEnabled||"false");this.kLj=Boolean.parse(t.DirectPrintProbeIsEnabled||"false");this.KHj=Boolean.parse(t.DirectPrintEnabledForInternetExplorer||"false");this.Fgb=(t.DirectPrintSupportedMimeTypes||"").split(Ce.pRd);this.KYa=(t.DirectPrintSupportedPlugins||"").split(Ce.pRd);this.Kuj=(t.DirectPrintImmersivePreviewPlugins||
"").split(Ce.pRd);this.zsg=Boolean.parse(t.DirectPrintEnabledForEdge||"false");this.tDj=Boolean.parse(t.ChromePrintLayoutFixIsEnabled||"false");this.Oli=parseInt(t.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Tre=14;this.QSg=14394;if(t=t.DirectPrintMinimalSupportedEdgeVersion){const N=t.split(".");2===N.length?(this.Tre=parseInt(N[0]),this.QSg=parseInt(N[1])):m.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",t)}else m.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Ce.pRd=",";Object(h.a)(Ce,"DirectPrintBrsSettings",null,[]);class Fb{constructor(t,N){this.UNe=t;this.KYa=N}}Object(h.a)(Fb,"DirectPrintProbeResults",null,[]);var $e=d(196),bg=d(101);class Ye{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed){this.nyc=null;this.hKh=t;this.aPb=N;this.zxd=ha;this.MNh=Aa;this.DOh=Ra;this.QPb=new tc.a(Object(n.a)(this,this.i$i,"getProbeResults"));this.Kqd=yb;this.mcf=Zc;this.sCd=Sb;this.EOh=
uc;this.ROh=ed}get fK(){return this.hKh}start(){}tAk(){this.fK.kLj&&this.eXj()}uDk(){const t=Array(this.fK.Fgb.length);if(void 0!==this.aPb&&null!==this.aPb)for(let N=0;N<this.fK.Fgb.length;N++)t[N]=this.fK.Fgb[N]in this.aPb&&this.MNh(this.aPb[this.fK.Fgb[N]]);return t}vDk(){const t=Array(this.fK.KYa.length),N=!(void 0===this.zxd||null===this.zxd);for(let ha=0;ha<this.fK.KYa.length;ha++){const Aa=this.fK.KYa[ha];t[ha]=N&&Aa in this.zxd?!0:this.DOh(Aa)}return t}uej(){const t=this.uDk(),N=Array(t.length);
for(let ha=0;ha<t.length;ha++)N[ha]=t[ha]?this.dOi(this.aPb[this.fK.Fgb[ha]]):null;return N}dOi(t){if(void 0===t||null===t)return null;t=t.enabledPlugin;return void 0===t||null===t?null:t.name}eXj(){m.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.QPb.value.UNe,this.QPb.value.KYa)}i$i(){var t=this.uej();const N=this.vDk(),ha={},Aa={};for(let Ra=0;Ra<this.fK.Fgb.length;Ra++)ha[this.fK.Fgb[Ra]]=t[Ra];for(t=0;t<this.fK.KYa.length;t++)Aa[this.fK.KYa[t]]=N[t];return new Fb(ha,Aa)}lal(){return this.ROh||
!this.fK.isEnabled||v.AFrameworkApplication.c5b?!1:this.oil()}uph(){if(null!=this.nyc)return this.nyc;const t=Ye.xsg(this.fK);return this.nyc=this.fK.zsg&&t||this.qDj()}qDj(){return Pc.a.Hj&&this.fK.tDj&&Pc.a.NCc>=this.fK.Oli?!0:!1}oil(){if(!this.EOh(this.fK))return!1;var t=bg.a.R1d(this.QPb.value.UNe);for(const N of t)if(void 0!==N&&null!==N)return!0;t=bg.a.R1d(this.QPb.value.KYa);for(const N of t)if(N)return!0;return!1}Bqj(){const t=bg.a.R1d(this.QPb.value.UNe);for(const N of t)if($e.a.contains(this.fK.Kuj,
N))return!0;return!1}vqh(t){v.AFrameworkApplication.Aa&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")?this.mcf(t,null):this.lal()?this.MGi(t,this.Bqj()&&!0):this.mcf(t,null)}MGi(t,N){const ha=this.sCd.wi("UserAction","OpenDirectPrintDialog");this.Kqd.B1i(t,N).Cha();ha.stop()}static RNj(t){try{return new ActiveXObject(t),!0}catch(N){m.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",t)}return!1}static uFj(t){return void 0===t||null===
t?!1:!(void 0===t.enabledPlugin||null===t.enabledPlugin)}static create(t){const N=new Ce(v.AFrameworkApplication.fa.appSettings);let ha=null;try{ha=window.navigator.mimeTypes}catch(ed){m.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let Aa=null;try{Aa=window.navigator.plugins}catch(ed){m.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Ra=Ye.uFj,yb=Ye.RNj;t=t.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Sb=v.AFrameworkApplication.Aa.hU,
uc=Ye.SNj,Zc=!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.gb.QB&&!v.AFrameworkApplication.fa.ka("PrintDialogFallbackLinkEnabled");return new Ye(N,ha,Aa,Ra,yb,t,Sb,uc,(ed,Gd)=>new Ee(ed,!1,Gd,!0,Zc),v.AFrameworkApplication.isEmbedded)}static SNj(t){return Pc.a.Hj||Pc.a.xj&&t.KHj||t.zsg&&Ye.xsg(t)?!0:!1}static xsg(t){var N=Pc.a.GOa;if(N){var ha=N.split(".");if(2===ha.length)return N=parseInt(ha[0]),ha=parseInt(ha[1]),N>t.Tre||N===t.Tre&&ha>=t.QSg}return!1}}Object(h.a)(Ye,"DirectPrintManager",
null,[844]);class Ae{constructor(){this.D_e=this.Da=null}get name(){return"Common.App.DirectPrint"}Wb(t){this.Da=t;t.register(Gb,"Common.App.DirectPrint.DirectPrintDialogFactory").ma().na(()=>new Gb(v.AFrameworkApplication.Aa.VQ));t.register(844,"Common.App.DirectPrint.IDirectPrintManager").ma().na(()=>Ye.create(this.Da))}init(){this.D_e=this.Da.resolve("Common.App.DirectPrint.IDirectPrintManager");this.D_e.start()}dispose(){}}Object(h.a)(Ae,"PackageManager",null,[2,3]);var si=d(1087),Jf=d(296);class tg{constructor(t,
N){this.hMb=null;this.Ca=t;this.jb=N}ub(){(this.hMb=this.jb.Ha("StatusBarEnvironmentNameToUse"))&&""!==this.hMb&&this.Ca.pa(G.a.X7g,E.a.frame,Object(n.a)(this,this.eul,"updateEnvironmentName"),96)}eul(t,N,ha,Aa,Ra){if(1===ha)return 32;Ra[si.a.Value]=this.hMb;Ra[Jf.a.labelText]=this.hMb;Ra[si.a.Visible]=!0;return 32}}Object(h.a)(tg,"DisplayEnvironmentName",null,[]);class Dg{constructor(){this.Da=null}get name(){return"Common.App.DisplayEnvironmentName"}Wb(t){this.Da=t;this.Da.register(tg,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ma().na(()=>
new tg(v.AFrameworkApplication.Ta,v.AFrameworkApplication.fa))}init(){this.Da.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ub()}dispose(){}static main(){e.a.instance.Ac(new Dg)}}Object(h.a)(Dg,"DisplayEnvironmentNamePackage",null,[2,3]);var Vg=d(169),Ih=d(541);class hf extends Ih.a{constructor(t){super(t)}get fWb(){return!1}createElement(){const t=document.createElement("link");t.setAttribute("rel","stylesheet");t.setAttribute("type","text/css");t.setAttribute("href",this.Rs);
return t}REc(){return null}Ehc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.GL.Rs)}}Object(h.a)(hf,"CssResource",Ih.a,[]);var ld=d(279),ph=d(2);class Kf{constructor(){this.rvc=this.qrc=null}ETj(){this.qrc||(m.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.qrc=ph.Task.WAA(Kf.NTj(),Kf.uTj()),this.qrc.continueWith(t=>{m.ULS.sendTraceTag(21030599,324,10,"{0}",gb.a.rYd(t.Ui))},5));return this.qrc}FTj(){if(!this.rvc)try{m.ULS.sendTraceTag(39978390,
324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.rvc=ph.Task.WAA(Kf.$Sd(ld.a.create(v.AFrameworkApplication.fa.Ha("DimeUrl"),null,null))),this.rvc.continueWith(t=>{m.ULS.sendTraceTag(39978391,324,10,"{0}",gb.a.rYd(t.Ui))},5)}catch(t){m.ULS.sendTraceTag(594874951,324,10,"{0}",gb.a.rYd(t))}return this.rvc}static NTj(){var t=Kf.MNc("inproductmessaging.js");t=ld.a.create(t,null,null);return Kf.$Sd(t)}static uTj(){var t=Kf.MNc("inproductmessaging.css");t=new hf(t);return Kf.$Sd(t)}static MNc(t){return Vg.a.CVb(String.format("ipm/{0}",
t))}static $Sd(t){Cc.a.wx(t);return t.HDa}}Object(h.a)(Kf,"DependencyDownloader",null,[900]);class Ud{}Ud.urk="inProductMessagingOverlayDiv";Ud.qvk="PlayButtonImage";Ud.aSk="ReplayButtonImage";Object(h.a)(Ud,"Constants",null,[]);class He{constructor(){this.Cuf=this.Zdf=this.rWe=!0;this.bSk=this.rvk=null;this.aek=!1;this.locale=null;this.tzh={}}get autoPlay(){return this.rWe}set autoPlay(t){this.rWe=t}get lTg(){return this.Zdf}set lTg(t){this.Zdf=t}get mqh(){return this.Cuf}set mqh(t){(this.Cuf=t)&&
this.U3k()}U3k(){this.XBf(Ud.qvk,this.rvk);this.XBf(Ud.aSk,this.bSk)}XBf(t,N){N&&(this.tzh[t]=N)}}Object(h.a)(He,"FirstRunExperienceUISettings",null,[869]);class Bh{constructor(){this.completed=this.SMk=!1}}Object(h.a)(Bh,"FirstRunExperienceViewData",null,[860]);var eg=d(186);class jd{constructor(t,N,ha){this.Ca=t;this.Kh=N;this.msc=ha}ub(){this.Ca.pa(G.a.qSi,E.a.frame,Object(n.a)(this,this.pSi,"firstRunExperienceHandler"),64);this.Ca.xa(G.a.G3f,E.a.frame,Object(n.a)(this,this.Ruj,"inProductMessagingTabHandler"));
this.Ca.xa(G.a.F3f,E.a.frame,Object(n.a)(this,this.Quj,"inProductMessagingShiftTabHandler"));this.Ca.xa(G.a.bGi,E.a.frame,Object(n.a)(this,this.cGi,"dimeLaunchHandler"));this.Ca.xa(G.a.reh,E.a.frame,eg.ActionManager.Fg);this.Ca.xa(G.a.tSk,E.a.frame,eg.ActionManager.Fg);this.Ca.xa(G.a.uSk,E.a.frame,eg.ActionManager.Fg);this.Kh&&this.Kh.updateCommandUI()}pSi(t,N,ha,Aa,Ra){2===ha&&this.msc.KRj(Ra);return 32}cGi(t,N,ha,Aa,Ra){2===ha&&this.msc.JRj(Ra);return 32}Ruj(t,N,ha){return 2===ha?this.msc.rse():
32}Quj(t,N,ha){return 2===ha?this.msc.kse():32}}Object(h.a)(jd,"InProductMessagingActor",null,[]);class Jh{constructor(){this.ybh=this.D4=this.ivh=this.aVc=this.instance=null}}Object(h.a)(Jh,"DimeExperienceUISettings",null,[]);var kf=d(514);class Ji{constructor(t,N,ha,Aa,Ra){this.UJc=!1;this.vXb=null;this.Ca=t;this.l2a=N;this.$vc=ha;this.v5=Aa;this.jfa=Ra}sxj(t){Sa.b("getHeaderApi")?t.isFeatureEnabled("MsoPremiumBadge",!0).then(N=>{const ha=t.isFreemiumUpsellEnabled();ha&&(appChrome.getHeaderApi().then(Aa=>
{Aa.updatePremiumStatus(N,ha);return null}),t.deb("MsoPremiumBadge",Aa=>{appChrome.getHeaderApi().then(Ra=>{Ra.updatePremiumStatus(Aa.isEnabled,ha);return null})}));return null}):m.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}KRj(t){this.$vc.ETj().continueWith(()=>{this.l2a.ndl(t)})}JRj(t){let N="gopremium",ha=null,Aa=()=>{};t?(t.experience&&""!==Object(M.a)(String,t.experience)&&(N=Object(M.a)(String,t.experience)),t.onTaskComplete&&(Aa=t.onTaskComplete),t.campaignId&&""!==Object(M.a)(String,
t.campaignId)&&(ha=Object(M.a)(String,t.campaignId))):m.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.pzg(N,Aa,ha)}pzg(t,N,ha=null){if(this.UJc&&this.vXb){const Aa={};Aa.experience=t||"gopremium";Aa.campaignId=ha||kf.b(this.v5,this.jfa,Object(M.a)(String,Aa.experience),!0);this.Ca.processAction(G.a.reh,2);m.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Aa.experience);try{const Ra=Object.assign(new Jh,{instance:this.vXb,aVc:Aa,ivh:N||
(()=>{}),D4:yb=>{m.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+yb.status)},ybh:()=>{m.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.UJc=!1;this.vXb=null}});this.l2a.Cbl(Ra)}catch(Ra){m.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Ra.message),this.UJc=!1,this.vXb=null,this.Ca.Ka(G.a.VJc,2,{["experience"]:Aa.experience})}}else m.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ca.Ka(G.a.VJc,2,{["experience"]:t})}GTj(){this.$vc.FTj().continueWith(()=>
{try{var t=gb.a.sg(v.AFrameworkApplication.uiCulture);const Aa=kf.c(this.v5);if(Aa){var N={};N.partnerId=Aa;N.language=t;N.sessionId=v.AFrameworkApplication.userSessionId;N.authHint=v.AFrameworkApplication.fa.Ha("UserPrincipalName");var ha=v.AFrameworkApplication.fa.Ha("Puid")||"";""!==ha&&(t={},t.puid=ha,N.userInfo=t);this.vXb=new Dime(N);this.UJc=!0;m.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else m.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Aa){m.ULS.sendTraceTag(51675410,
324,10,"FreemiumUpsellDialogDependencies failed: "+Aa.message)}},3)}rse(){return this.l2a.rse()}kse(){return this.l2a.kse()}}Object(h.a)(Ji,"InProductMessagingUIManager",null,[847]);class hh{constructor(){this.nxf=0;this.zkb=Array(5);this.zkb[0]=10;this.zkb[1]=15;this.zkb[2]=50;this.zkb[3]=100;this.zkb[4]=200}Init(t){this.nxf=t}SendTrace(t,N){m.ULS.sendTraceTag(34182235,this.nxf,this.zkb[t],"{0}",N)}}Object(h.a)(hh,"DefaultNetworkingManager",null,[864]);var Wb=d(195);class Uc{constructor(t){this.Hd=
t}ndl(t){t&&(InProductMessaging.Networking.NetworkingMgr=new hh,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(t.mqh,t.lTg,t.autoPlay,t.aek,t.locale,Object(n.a)(this,this.mjk,"onDismissFirstRunExperience"),t.tzh),this.K4(Ud.urk,!0))}Cbl(t){if(t&&t.instance&&t.aVc){let N=document.getElementById("wacDimeContainer");N||(N=document.createElement("div"),N.id="wacDimeContainer",document.body.appendChild(N));v.AFrameworkApplication.fa.ka("DimeFocusManagerIsEnabled")&&this.K4("wacDimeContainer",
!1);t.aVc.parentElementId="wacDimeContainer";t.instance.launch(t.aVc,t.ivh).then(ha=>{this.cma();document.body.removeChild(N);t.D4(ha)}).catch(ha=>{this.cma();document.body.removeChild(N);t.ybh(ha)})}else throw Error.argument("DimeExperienceUISettings");}K4(t,N){if(this.Hd&&t&&(t=document.getElementById(t),this.ixj(t),t=this.Hd.zP("InProductMessagingFocusId"))){const ha=this.Hd.ye;ha&&"InProductMessagingFocusId"===ha.name||this.Hd.oX("InProductMessagingFocusId",!1);N&&this.mCe(t.scope)}}ixj(t){var N=
this.Hd.Bc("InProductMessagingFocusId");N.parent=va.AFrame.XC;const ha=new Wb.DOMFocusListing(()=>t);ha.heb=!1;ha.mo(3);ha.mo(2);ha.mo(4);N=this.Hd.aha(()=>t,N,ha);N.ieb();N.cW=!0;N.PNa=!0}mCe(t){t.$o(ec.FocusManager.instance().Poa);t.$o(ec.FocusManager.instance().Qoa);t.bindAction(ec.FocusManager.instance().Poa,G.a.G3f);t.bindAction(ec.FocusManager.instance().Qoa,G.a.F3f)}cma(){this.Hd&&(this.Hd.s4("InProductMessagingFocusId"),this.Hd.zEb("InProductMessagingFocusId"))}mjk(t,N){this.cma();t=Object.assign(new Bh,
{completed:t,SMk:N});v.AFrameworkApplication.Ta.Ka(G.a.oSi,2,t)}rse(){const t=document.activeElement,N=this.Hd.Zk();return t&&N&&N.qj&&t===N.qj.Rvb?(N.qj.fE(t),N.mBb()?32:8):4}kse(){const t=document.activeElement,N=this.Hd.Zk();return t&&N&&N.qj&&t===N.qj.Qha?(N.qj.fE(t),N.kBb()?32:8):4}}Object(h.a)(Uc,"InProductMessagingUIWrapper",null,[843]);class Sc{constructor(){this.Da=null}get name(){return"Common.App.InProductMessaging"}Wb(t){t.register(Kf,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ma().na(()=>
new Kf);t.register(Uc,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ma().na(()=>new Uc(ec.FocusManager.instance()));t.register(Ji,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ma().na(()=>new Ji(v.AFrameworkApplication.Ta,t.resolve("Common.IInProductMessagingUIWrapper"),t.resolve("Common.App.InProductMessaging.IDependencyDownloader"),v.AFrameworkApplication.Aa.gb.Am,v.AFrameworkApplication.Aa.gb.vGa));
t.register(jd,"Common.App.InProductMessaging.InProductMessagingActor").ma().na(()=>new jd(v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,t.resolve("Common.IInProductMessagingUIManager")));t.register(He,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ma().na(()=>new He);t.register(Bh,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ma().na(()=>new Bh);this.Da=t}init(){this.Da.resolve("Common.App.InProductMessaging.InProductMessagingActor").ub();
v.AFrameworkApplication.fa.ff(()=>{v.AFrameworkApplication.Aa.gb.iN&&ib.a.get_instance().Xj(15,()=>{this.Da.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").sxj(t)})});v.AFrameworkApplication.fa.ka("FreemiumUpsellShowDialogIsEnabled")&&kf.a()&&!Pc.a.Kw&&1!==v.AFrameworkApplication.Aa.gb.Am&&this.Da.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled("MsoPremiumBadge",
!0).then(N=>{!N&&t.isFreemiumUpsellEnabled()&&this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").GTj();return null})})})}dispose(){}static main(){e.a.instance.Ac(new Sc)}}Object(h.a)(Sc,"InProductMessagingPackage",null,[2,3]);var Od=d(379),ug=d(553);class te{static pKi(t){return te.TIf("New",t)}static qKi(t){return te.TIf("Open",t)}static CIf(t,N){return te.m3a("LoadingMenuSection",te.AUj,t,te.bUb("lblLoading",N))}static cUb(t,N,ha=null,Aa=null){return te.m3a("MessageMenuSection",
te.PTg,N,te.bUb("lblMessage",t,ha,Aa))}static nei(t){return te.CIf(t,CommonUIStrings.l_VoicedLoadingText)}static oei(t,N){return te.cUb(CommonUIStrings.l_NewCreationLocationMessage,t.labelText,N.EQ,N.HIa)}static mei(t,N){return te.cUb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,N.HIa,"\n\n"),t.labelText)}static EIf(t){return te.cUb(CommonUIStrings.l_NewGenericErrorMessage,t.labelText)}static kei(t,N,ha){return te.m3a("menuNewBlank",te.Crj,ha?t.labelText:null,te.YTb(t.vjg,t.wjg,t.xjg,
null,t.tCa,t.n2b,N,"blank"))}static Vei(){return te.bUb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static QIf(){return te.bUb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static Wei(t,N){return te.m3a("menuNewTemplates",t,null,N)}static iei(t,N){return te.m3a("menuNewMoreTemplates",te.B4f,null,te.YTb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,t,N))}static ndi(t,N,ha){let Aa="";ha&&N&&(Aa=te.m3a("BrowseMoreMenuSection",
te.B4f,null,te.YTb("btnBrowseMore",N,N,null,null,null,t||"1959943459",ha)));return Aa}static bUb(t,N,ha=null,Aa=null){let Ra=Aa;N&&0<N.length&&(Ra=te.tUg.VGa(N).trimEnd(),Ra=0<=Ra.indexOf("{0}")?String.format(Ra,Aa):String.format("{0} {1}",Ra,Aa));ha=ha&&Aa?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',gb.a.ie(ha),gb.a.ie(Aa),gb.a.ie(Ra)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
gb.a.ie(t||""),te.tUg.VGa(gb.a.ie(N||"")),ha)}static YTb(t,N,ha,Aa,Ra,yb,Sb,uc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',gb.a.ie(t||""),gb.a.ie(N||""),gb.a.ie(ha||""),Aa||"32by32",gb.a.ie(Ra||""),gb.a.ie(yb||""),Sb,gb.a.ie(uc||""))}static TIf(t,N){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
t,N)}static m3a(t,N,ha,Aa){ha=ha?String.format('Title="{0}"',gb.a.ie(ha)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',gb.a.ie(t||""),gb.a.ie(N||""),ha,Aa)}}te.PTg="MenuMru";te.AUj="MenuLoading";te.Crj="MenuHeader";te.B4f="MenuFooter";te.tUg=ug.a.Bw("\n","&#10;");Object(h.a)(te,"NewAndOpenXmlUtilities",
null,[]);var mf=d(94);class Yf{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(h.a)(Yf,"HostInformation",null,[]);var Jd=d(170),ce=d(124),fe=d(426),Gg=d(515);class Me{constructor(t,N,ha,Aa,Ra,yb){this.cDd=this.Rn=this.hpc=null;this.Vwc=this.VBd=!1;this.Gdf=0;this.HBd=this.Zud=!1;this.Zfa=t;this.vMb=N;this.Gfa=new tc.a(()=>new Od.a(ha.value,Object(n.a)(this,this.SBa,"getMoreInfoEventReceived")));this.tQh=Aa;this.zLa=Ra;this.cVh=yb;this.TQb=this.Qgd;2===this.XW.Jua&&
(this.HBd=!0)}get t1(){switch(this.XW.Jua){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}ub(){const t=this.XW.zBb;t.xa(G.a.newDocument,E.a.frame,Object(n.a)(this,this.newDocument,"newDocument"));t.pa(G.a.zye,E.a.frame,Object(n.a)(this,this.zye,"populateNewMenu"),96)}newDocument(t,N,ha,Aa,Ra){if(1===ha)return 32;if(2===ha&&Ra){if(v.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&Ra.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),
v.AFrameworkApplication.Ta.processAction(G.a.hzk,2);if(Ra.MenuItemId&&Ra.SourceControlId)return"NewDocumentHome"===Ra.SourceControlId&&Eb.a("NewDocumentFromHomeTab"),this.h4a(Ra.MenuItemId,Ra.SourceControlId)}return 8}h4a(t,N){var ha=this.J5c.XOd;if(null===ha)return 8;var Aa=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.S8a&&Aa){m.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
const Ra={};Ra[Jd.a.Avh]=t;Ra[Jd.a.t1]=this.t1;Ra[Jd.a.lcid]=v.AFrameworkApplication.lcid.toString();Ra[Jd.a.reason]=fe.a.xyi;v.AFrameworkApplication.zV().execute(yb=>{yb.sendMessage(ce.a.h4a,Ra)})}else Aa=(new Date).getTime(),N=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",ha,gb.a.Me(this.Kua),gb.a.Me(t),gb.a.Me(this.t1),gb.a.Me(v.AFrameworkApplication.lcid.toString()),gb.a.Me(Aa.toString()),gb.a.Me(N),gb.a.Me(v.AFrameworkApplication.canary),
v.AFrameworkApplication.Zg),(ha=v.AFrameworkApplication.fa.Ha("ScenarioId"))&&""!==ha&&(N+="&wdscenarioid="+gb.a.Me(ha)),N+="&"+v.AFrameworkApplication.pQa(),v.AFrameworkApplication.NRa&&(N+="&"+v.AFrameworkApplication.jMc()),(ha=this.Rn?this.Rn.EQ:null)&&(N+="&DestinationUrl="+gb.a.Me(ha)),dd.a.Um(N,"_blank",void 0,"CreateNewDocument");2===this.XW.Jua&&m.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Gg.a[this.XW.Jua],["Template"]:t});return 32}VXj(t){let N=Number.MAX_VALUE,
ha=Number.MIN_VALUE;const Aa=window.performance;if(Aa&&"undefined"!==typeof Aa.getEntriesByName){for(let yb=0;yb<t.length;yb++){var Ra=Aa.getEntriesByName(t[yb]);Ra&&0<Ra.length&&(Ra=Ra[0],N=Math.min(parseInt(String(Ra.fetchStart)),N),ha=Math.max(parseInt(String(Ra.responseEnd)),ha))}ha>N&&m.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:ha-N,["MinFetchStart"]:N,["MaxResponseEnd"]:ha})}}zye(t,N,ha,Aa,Ra){if(1===ha)return this.HBd&&(v.AFrameworkApplication.mN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.HBd=!1),32;2!==ha||this.Zud||(this.Gdf=(new Date).getTime(),m.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Qgd,["CachedNewMenuXmlExists"]:!!this.hpc,["ShouldCallGetMoreInfo"]:this.XW.KIa}));return this.xwk(Ra)}xwk(t){t&&(this.hpc?t.PopulationXML=this.hpc:(this.XW.KIa&&!this.Rn&&this.Dek.Dba("Opened New menu",!0),t.PopulationXML=this.FWi(this.getTemplateListJson())));return 32}awg(){return!this.XW.KIa||!!this.Rn&&3===this.Rn.state&&!!this.Rn.HIa&&
!!this.Rn.EQ}DLj(){return v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.gb.oDa?!0:this.awg()}getTemplateListJson(){if(!this.Qgd||!this.DLj())return null;if(this.TQb&&!this.Vwc){var t="9";const N=v.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in N&&(t=N.NumberOfTemplatesInBackstage);let ha=this.t1;"TemplateCollectionId"in N&&(ha=N.TemplateCollectionId);t=String.format(this.XW.yda+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",gb.a.Me(v.AFrameworkApplication.lcid.toString()),
gb.a.Me(ha),t);Boolean.parse(N.AppendOriginQueryParam||"false")&&(t+="&org=backstage");Boolean.parse(N.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in N&&(t+="&templateTier="+N.TemplateTier);t+="&"+v.AFrameworkApplication.pQa();v.AFrameworkApplication.NRa&&(t+="&"+v.AFrameworkApplication.jMc());this.XW.scc.vj(t,1,null,null,!1,2,Aa=>{this.XW.Bsa("CreateNewActor.GetTemplateListJson",Aa.data);this.Nkl(Aa.data.Zd)},Aa=>{this.XW.Bsa("CreateNewActor.GetTemplateListJson",Aa.data);this.Mkl()},
null,void 0,void 0,void 0,void 0,"5");this.TQb=!1}return this.cDd}Nkl(t){this.cDd=t;this.TQb=!1;this.uhc();if(v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.gb.oDa&&Sa.c()){t=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const N=v.AFrameworkApplication.S8a;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.cDd,!0,t&&N))}}Mkl(){this.Vwc=this.TQb=!0;this.uhc();v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.gb.oDa&&Sa.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",
!1,!1));mf.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Hfj(t){var N=0;for(var ha=0;ha<t.length;ha++)if("ST"===t[ha].ImageType){N=ha;break}const Aa=t.length?t[N]:null;t=Aa?Aa.Url||"":"";var Ra;let yb=ha=N=!1;if(Aa&&(Ra=Aa.AspectRatio))Ra=parseFloat(Ra),1>Ra?N=!0:1.5<Ra?ha=!0:1===Ra&&(yb=!0);else switch(m.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:t}),this.XW.Jua){case 3:N=!0;break;case 2:ha=!0;break;
case 5:yb=!0}return{returnValue:t,OP:N?"95by123":ha?"123by69":yb?"100by100":"123by95"}}FWi(t){const N=({Dgd:t}=this.lei(t,this.J5c,this.J5c.hUb||"1056925771")).returnValue;t&&(this.hpc=N,m.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.Gdf}));return N}SBa(t,N){m.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Rn||3!==t.state?2===t.state&&(m.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),
this.VBd=!0,this.uhc()):(this.Rn=t,N||this.uhc(),v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.gb.oDa&&Sa.c()&&Sa.d("setFileMenuHostInformation")&&(t=Object.assign(new Yf,{hostUrl:this.Rn.EQ,hostName:this.Rn.HIa,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),m.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(t))))}lei(t,N,ha){let Aa;
Aa=!1;const Ra=this.awg();let yb="";this.XW.KIa&&(this.VBd?(yb=te.EIf(N),this.VBd=!1,m.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Rn?Ra?yb=te.oei(N,this.Rn):this.Rn.bAj?(Aa=!0,this.TQb=!1,yb=te.mei(N,this.Rn),m.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Aa=!0,yb=te.EIf(N),m.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.Rn.EQ,["StorageServiceDisplayNameIsSet"]:!!this.Rn.HIa})):(yb=te.nei(N.labelText),m.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Ra&&(yb+=te.kei(N,ha,!yb)+({Dgd:Aa}=this.Uei(t,ha)).returnValue);return{returnValue:te.pKi(yb),Dgd:Aa}}Uei(t,N){let ha;ha=!1;if(!this.Qgd)return ha=!0,m.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Dgd:ha};let Aa="",Ra="",yb="MenuTemplate";
if(this.Vwc)Aa=te.QIf(),this.Vwc=!1,m.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(t){try{const Sb=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0);Aa=this.Tei(Sb,N);m.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.vUg&&"OneDrive"===this.Kua&&(Ra=te.iei(this.Eek,v.AFrameworkApplication.vUg))}catch(Sb){m.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
{["JsonToConvert"]:t}),Aa=te.QIf()}ha=!0}else yb="MenuLoading",Aa=te.Vei(),m.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:te.Wei(yb,Aa)+Ra,Dgd:ha}}Tei(t,N){let ha="";const Aa=[];for(let yb=0;yb<t.length;yb++){var Ra=t[yb];let Sb="";if(Ra){const uc=Ra.Title,Zc=Ra.AssetId;Ra=Ra.Thumbnails;Zc&&uc&&Ra&&({OP:Ra,returnValue:Sb}=this.Hfj(Ra),ha+=te.YTb("jbtnNewTemplate"+yb,uc,null,Ra,null,Sb,N,Zc))}Aa[yb]=Sb}t=new Y.a(4,1,5E3,()=>{this.VXj(Aa)},106);
this.XW.H5c.Gb(t);return ha}uhc(){this.Zud=!0;this.XW.qUg.x0(this.J5c.xZb);this.Zud=!1}get XW(){return this.Zfa.value}get J5c(){return this.vMb.value}get Dek(){return this.Gfa.value}get Eek(){return this.tQh.value}get Kua(){return this.zLa.value}get Qgd(){return this.cVh.value}}Object(h.a)(Me,"CreateNewActor",null,[]);class se{constructor(){this._initialized=!1;this.zCd={}}LB(t){this.B_f();return this.get(t)}contains(t){this.B_f();return t.toString()in this.zCd}B_f(){this._initialized||(this.t1h(),
this._initialized=!0)}Kmb(t,N){this.zCd[t.toString()]=N}get(t){return this.zCd[t.toString()]}}Object(h.a)(se,"AIntlHelper",null,[]);class Pf extends se{constructor(){super()}t1h(){this.Kmb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Kmb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.Kmb(2,CommonUIStrings.l_Open);this.Kmb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Kmb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Kmb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Pf.Ja||
(Pf.Ja=new Pf)}static wqk(t){return Pf.instance.LB(t)}}Pf.Ja=null;Object(h.a)(Pf,"MruActorIntlHelper",se,[]);var yg;(function(t){t[t.success=0]="success";t[t.failure=1]="failure";t[t.spinner=2]="spinner";t[t.none=3]="none"})(yg||(yg={}));Object(h.b)("DisplayState",yg);var qe=d(33);class yd{constructor(t,N,ha,Aa,Ra,yb,Sb,uc){this.cpd=null;this.tEd=!0;this.gpc="";this.SWh=0;this.ykb=null;this.Vvd=3;this.jb=uc;this.Zfa=t;this.maa=N;this.pLh=ha;this.WHh=Aa;this.VHh=Ra;this.Gfa=new tc.a(()=>new Od.a(yb.value,
null));this.ZLh=new tc.a(()=>new Od.a(Sb.value,Object(n.a)(this,this.Tdk,"mruEventResultReceived")));this.jb.ka("WacInTabOpenMRUIsEnabledForUiHost");this.jb.ka("UiHostSupportsDocRebootFeatures")}Tdk(t,N){this.ykb=t;N||this.Mah()}aMk(){this.tF.zBb.pa(G.a.yye,E.a.frame,Object(n.a)(this,this.yye,"populateMruMenu"),96)}yye(t,N,ha,Aa,Ra){return 1!==ha&&Ra?this.wwk(Ra):32}wwk(t){this.SKi();this.RKi();t.PopulationXML=te.qKi(this.gpc+this.cpd);return 32}SKi(){var t=3;let N=!1;if(this.gpc&&this.SWh===this.ykb.jml)m.ULS.sendTraceTag(5849627,
202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),t=this.Vvd;else{m.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var ha=this.tF.QE();this.ykb=this.Sdk.Dba("File Open opened",!0);this.gpc&&2!==this.Vvd&&3!==this.ykb.state?N=!0:(t=this.Lbj(this.ykb),v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.gb.oDa&&Sa.c()&&t&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(t,
!0)),this.gpc=({uek:t}=this.GWi(this.ykb)).returnValue);ha=this.tF.QE()-ha;m.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:ha})}2!==t&&(ha={["DisplayState"]:yg[t]},1!==t&&(ha.IsStale=N),m.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",ha));this.Vvd=t}Lbj(t){let N;try{N=qe.c(t.Hse)}catch(ha){N=null,m.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
ha)}return N}RKi(){this.tEd?(m.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.cpd=({lAl:this.tEd}=this.X$j()).returnValue):m.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");m.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.tEd,["NotDisplayingLink"]:!this.cpd})}GWi(t){let N;1===t.state||0===t.state?(m.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),
t=2,N=te.CIf(this.eCa(2),this.eCa(5))):3===t.state&&t.Hse?(N=this.jei(t.Hse),t=0):(m.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),N=te.cUb(this.eCa(1),this.eCa(2)),t=1);return{returnValue:N,uek:t}}jei(t){let N;const ha=this.Nbc.hUb||"2155708348";if(t.length){N=te.bUb("lblRecentDocuments",this.eCa(3));let Aa=0;for(let Ra=0;Ra<t.length;Ra++){const yb=t[Ra];"FileName"in yb&&"DocumentUrl"in yb&&"Path"in yb&&(N+=te.YTb("MruButton"+Ra,yb.FileName.toString(),yb.Path.toString(),
null,this.Nbc.tCa,this.Nbc.n2b,ha,yb.DocumentUrl.toString()),yb.IsPinned&&Aa++)}N=te.m3a("RecentDocumentsMenuSection",te.PTg,this.eCa(2),N);m.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:t.length,["NumPinnedDocuments"]:Aa})}else N=te.cUb(this.eCa(0),this.eCa(2)),m.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return N}X$j(){let t;t=!0;let N=this.Eci;var ha=this.Dci;if(N&&ha||!this.tF.KIa)t=!1;else{const Aa=
this.nMc.Dba("File Open",!1);3===Aa.state&&(N=Aa.EQ,ha=Aa.HIa,t=!1)}ha=ha?String.format(this.eCa(4),ha):null;return{returnValue:te.ndi(this.Nbc.hUb,ha,N),lAl:t}}Mah(){this.tF.qUg.x0(this.Nbc.xZb)}get tF(){return this.Zfa.value}get eCa(){return this.maa.value}get Nbc(){return this.pLh.value}get Eci(){return this.WHh.value}get Dci(){return this.VHh.value}get nMc(){return this.Gfa.value}get Sdk(){return this.ZLh.value}}Object(h.a)(yd,"MruRenderer",null,[]);var zf=d(179),xd=d(435);class fg{constructor(t,
N,ha,Aa,Ra,yb,Sb){this.Rn=null;this.ftf=!1;this.GKa=this.YWe=0;this.EQh=t;this.Mkb=N;this.luc=ha;this.vMb=Aa;this.zLa=Ra;this.Zfa=yb;this.Gfa=new tc.a(()=>new Od.a(Sb.value,Object(n.a)(this,this.SBa,"getMoreInfoEventReceived")))}h4a(){!this.Rn&&this.Use.KIa?this.nMc.Dba("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}SBa(t){if(!this.Rn&&3===t.state)this.Rn=t;else if(2===t.state){this.ftf?m.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.nMc.Dba("NewDocumentFromStream",
!0),this.ftf=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.YWe=(new Date).getTime();var t=this.iQi.XOd;if(null===t)this.Mkb(null);else{var N=this.luc.menuItemId,ha=this.luc.XT,Aa=this.luc.Dhl,Ra=this.luc.pQi;this.GKa="streamBase64"===Aa?Ra.length/1024:0;m.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.t1,this.GKa);var yb=(new Date).getTime();t=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
t,gb.a.Me(this.Kua),gb.a.Me(N),gb.a.Me(this.t1),gb.a.Me(v.AFrameworkApplication.lcid.toString()),gb.a.Me(yb.toString()),gb.a.Me(ha),gb.a.Me(v.AFrameworkApplication.canary),v.AFrameworkApplication.Zg,gb.a.Me(Aa));t+="&"+v.AFrameworkApplication.pQa();v.AFrameworkApplication.NRa&&(t+="&"+v.AFrameworkApplication.jMc());(N=this.Rn?this.Rn.EQ:null)&&(t+="&DestinationUrl="+gb.a.Me(N));this.Use.scc.vj(t,2,Ra,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(n.a)(this,this.xek,"newDocumentFromStreamSuccessHandler"),
Object(n.a)(this,this.wek,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}xek(t){if(t&&t.data&&t.data.Zd){var N;({Hv:N}=qe.d(t.data.Zd)).returnValue?(t=N,t.StatusCode!==zf.a.Yy&&t.StatusCode!==zf.a.IWb?(m.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.t1,this.GKa,t.StatusCode),this.Mkb(null)):t.NewDocumentUrl&&""!==t.NewDocumentUrl?(m.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.t1,this.GKa,(new Date).getTime()-this.YWe),this.EQh(t.NewDocumentUrl)):(m.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.t1,this.GKa),this.Mkb(null))):(m.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.t1,this.GKa,{["ResponseData"]:xd.a.Lmc(t.data.Zd)}),this.Mkb(null))}else m.ULS.sendTraceTag(24904473,202,10,
"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.t1,this.GKa),this.Mkb(null)}wek(t){t&&t.data&&m.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.t1,this.GKa,t.data.status);this.Mkb(null)}get t1(){switch(this.Use.Jua){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get iQi(){return this.vMb.value}get Kua(){return this.zLa.value}get Use(){return this.Zfa.value}get nMc(){return this.Gfa.value}}
Object(h.a)(fg,"NewDocumentFromStreamOperation",null,[]);class Ki{constructor(t,N,ha,Aa){this.vMb=t;this.zLa=N;this.Zfa=ha;this.YLh=Aa}create(t,N,ha){return new fg(t,N,ha,this.vMb,this.zLa,this.Zfa,this.YLh)}}Object(h.a)(Ki,"NewDocumentFromStreamOperationFactory",null,[862]);var jg=d(285);class Ch{get name(){return"Common.App.NewAndOpen.UX"}Wb(t){t.register(Ki,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ma().na(()=>
new Ki(new tc.a(()=>v.AFrameworkApplication.Aa.gb.AYd()),new tc.a(()=>v.AFrameworkApplication.Kua),new tc.a(()=>t.pb("Common.INewAndOpenCommonHelpers")),new tc.a(()=>t.pb("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.fa.ff(()=>{this.xCa()})}xCa(){const t=jg.a.vu(u.a.instance.La("Common.INewAndOpenCommonHelpers")),N=jg.a.vu(u.a.instance.La("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.Kua&&ph.Task.WAA.call(null,t,N).continueWith(()=>
{const ha=new Me(new tc.a(()=>t.result),new tc.a(()=>v.AFrameworkApplication.Aa.gb.AYd()),new tc.a(()=>N.result),new tc.a(()=>v.AFrameworkApplication.Aa.gb.BYd().hUb||"1959943459"),new tc.a(()=>v.AFrameworkApplication.Kua),new tc.a(()=>v.AFrameworkApplication.YIj));ha.ub();ha.uhc()});if(v.AFrameworkApplication.iCe){const ha=jg.a.vu(u.a.instance.La("Common.IEventEmitter<Common.IMruResult>"));ph.Task.WAA.call(null,t,N,ha).continueWith(()=>{const Aa=new yd(new tc.a(()=>t.result),new tc.a(()=>Pf.wqk),
new tc.a(()=>v.AFrameworkApplication.Aa.gb.BYd()),new tc.a(()=>v.AFrameworkApplication.vqk),new tc.a(()=>v.AFrameworkApplication.uqk),new tc.a(()=>N.result),new tc.a(()=>ha.result),v.AFrameworkApplication.fa);Aa.aMk();Aa.Mah()})}}dispose(){}}Object(h.a)(Ch,"UXPackageManager",null,[2,3,106]);class ih extends Fa.StandardDialog{constructor(){super();this.vd=0;this.Re(1,CommonUIStrings.l_DialogClose)}Lu(t){this.Vx(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}OAa(t){this.Vx(t,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(h.a)(ih,"ErrorDialog",Fa.StandardDialog,[909]);class qh{n6f(){m.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const t=new Zf.a;t.Bg("api.onedrive.com");return t.task}}Object(h.a)(qh,"OneDriveConsumerEndpointHelper",null,[819]);var Md=d(163);class Ed{constructor(t,N,ha,Aa){this.a1a=this.wla=null;this.zBd=this.BBd=!1;this.Skb=null;this.jb=t;this.Noc=N;this.E0a=ha;this.eA=Aa}get qEf(){return this.Noc}get fa(){return this.jb}nsb(){this.Skb||
(this.Skb=this.zCb?ld.a.create(this.zCb,null,null,null,!1):null);return this.Skb}setup(t){this.a1a=t;this.BBd||this.zBd?this.BBd&&this.a1a&&this.a1a(!0):(t=this.nsb())?(this.zBd=!0,t.HDa.continueWith(N=>{this.bmk(N)}),Cc.a.wx(t)):(m.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.a1a(!1))}xve(t){m.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",t.Ui?t.Ui.toString():"No error detail.")}bmk(t){this.zBd=!1;
if(t.Wl)this.xve(t),this.a1a(!1);else try{this.BBd=!0,m.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.C5d(),m.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.a1a(!0)}catch(N){m.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",N.toString()),this.a1a(!1)}}alc(t){this.wla=t;this.E0a?m.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(m.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(n.a)(this,this.Ste,"onApiReady")))}Ste(t){t?this.bVc():this.Ts()}Ts(){this.eA().Lu(Md.a.Vpk)}onSuccess(t){m.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.wla&&this.wla(!0,t)}dispose(){this.Skb&&this.Skb.dispose()}}Object(h.a)(Ed,"AOneDriveFilePickerApiManager",null,[938,106]);class Bd extends Ed{constructor(t,N,ha,Aa,Ra,yb){super(N,ha,Aa,yb);this.Sk=null;this.laa=t;this.hVh=Ra}get zCb(){return this.fa.Ha("OneDriveApiUrl")}start(t,N){this.Sk=
t;this.alc(N)}C5d(){WL.init(1===this.qEf||2===this.qEf?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}alc(t){this.wla=t;!this.E0a&&this.laa.s7d?(m.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(n.a)(this,this.Ste,"onApiReady"))):(m.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.hVh())}bVc(){try{m.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Sk).then(Object(n.a)(this,this.onSuccess,"onSuccess"),Object(n.a)(this,this.Oy,"onFailure"))}catch(t){m.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",t,t.stack),this.Ts()}}Oy(t){if(t&&t.error){if("user_canceled"===t.error.code){m.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}m.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else m.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.wla&&this.wla(!1,t);this.Ts()}}Object(h.a)(Bd,"OneDriveFilePickerApiManagerV5",Ed,[]);class Xh extends Ed{constructor(t,N,ha,Aa,Ra){super(t,N,ha,Aa);this.Xrc=this.Cff=null;this.PKh=Ra;this.options={};this.options.clientId=this.fa.Ha("OneDriveApiV7ClientId");this.options.cancel=Object(n.a)(this,this.Yjd,"toggleHostDivVisibility")}get zCb(){return this.fa.Ha("OneDriveApiV72Url")}start(t,N){this.Xrc=N;const ha=this.PKh.n6f();ha.continueWith(()=>{m.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Cff=ha.result;this.alc((Aa,Ra)=>{this.Yjd();t(Aa,Ra)})},3);ha.continueWith(()=>{m.ULS.sendTraceTag(24134242,352,15,ha.Ui.message);this.Yjd()},5)}C5d(){this.options.success=t=>{const N={};N.data=t;this.onSuccess(N)};this.options.error=t=>{const N={};N.error=t;this.Oy(N)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Cff;this.options.advanced.iframeParentDiv=this.Xrc}bVc(){try{m.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.Yjd(),OneDrive.open(this.options)}catch(t){m.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",t.message),this.Ts()}}Oy(t){this.wla&&this.wla(!1,t);this.Ts()}Yjd(){this.Xrc.style.visibility="hidden"===this.Xrc.style.visibility?"":"hidden"}}Object(h.a)(Xh,"OneDriveFilePickerApiManagerV7",Ed,[]);class $f extends Ed{constructor(t,N,ha,Aa){super(t,N,ha,Aa);this.jHh=t;this.options={};this.options.advanced={};this.options.action=
"query";this.options.clientId=this.fa.Ha("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get zCb(){return this.fa.Ha("OneDriveApiV72Url")}start(t,N,ha,Aa){this.options.advanced.iframeParentDiv=ha;this.options.advanced.endpointHint=Aa;this.options.cancel=N;this.jHh.ka("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.alc(t)}alc(t){this.wla=t;this.E0a?m.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(m.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(n.a)(this,this.Ste,"onApiReady")))}C5d(){this.options.success=t=>{const N={};N.data=t;this.onSuccess(N)};this.options.error=t=>{const N={};N.error=t;this.Oy(N)}}bVc(){try{m.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(t){m.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",t.message,t.stack),this.Ts()}}xve(t){m.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",t.Ui?t.Ui.toString():"No error detail.");Cc.a.oOk(this.zCb);this.Skb=null}Ts(){this.eA().OAa(Md.a.hXk)}Oy(t){this.wla&&this.wla(!1,t)}}Object(h.a)($f,"OneDriveFilePickerApiManagerV72",Ed,[]);class Vi{constructor(t){this.olsSessionId=this.value=this.key=null;this.olsSessionId=t}}Object(h.a)(Vi,"IExtraData",null,
[]);class ci extends $f{constructor(t,N,ha,Aa){super(t,N,ha,Aa);this.options.advanced.filter=t.Ha("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.CEf;t.ka("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=t.Ha("OneDriveApiV72CommandMode")||"none");t.ka("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new Vi(v.AFrameworkApplication.userSessionId))}get zCb(){return this.fa.Ha("OneDriveApiV72Url")}bVc(){try{m.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(t){m.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",t.message,t.stack),this.Ts()}}}Object(h.a)(ci,"OneDriveFilePickerApiOpenManagerV72",
$f,[]);class Bi{constructor(t){this.Cv=null;this.Ei=t;this.wAd=3}n6f(){this.Cv=new Zf.a;m.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.iHe();return this.Cv.task}iHe(t=null){const N=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.l4a);this.Ei.FY(N,1,null,t,["PersonalFileStorageUrl","X-NewKey"],2,Object(n.a)(this,this.v7i,"getMoreInfoSucceeded"),Object(n.a)(this,this.t7i,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,
"21")}t7i(t){if(t.data.af===zf.a.Dfc&&"X-NewKey"in t.data.mj){m.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const N={};N["X-Key"]=t.data.mj["X-NewKey"];this.iHe(N)}else 0<this.wAd?(m.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.wAd),this.wAd--,this.iHe()):(m.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.Cv.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}v7i(t){"PersonalFileStorageUrl"in t.data.mj&&""!==t.data.mj.PersonalFileStorageUrl?(m.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Cv.Bg(t.data.mj.PersonalFileStorageUrl)):(m.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Cv.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}
Object(h.a)(Bi,"OneDriveForBusinessEndpointHelper",null,[819]);var bh=d(345);class Wg{constructor(){this.Da=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Wb(t){this.Da=t;this.Da.register(Bd,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ma().na(()=>new Bd(bh.a.instance,v.AFrameworkApplication.fa,v.AFrameworkApplication.X4a,v.AFrameworkApplication.ZP,v.AFrameworkApplication.zqh,()=>
new ih));v.AFrameworkApplication.uvb?this.Da.register(819,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new qh):this.Da.register(819,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new Bi(v.AFrameworkApplication.He));this.Da.register(Xh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ma().na(()=>new Xh(v.AFrameworkApplication.fa,v.AFrameworkApplication.X4a,v.AFrameworkApplication.ZP,()=>new ih,this.Da.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));
this.Da.register($f,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ma().na(()=>new $f(v.AFrameworkApplication.fa,v.AFrameworkApplication.X4a,v.AFrameworkApplication.ZP,()=>new ih));this.Da.register(ci,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ma().na(()=>new ci(v.AFrameworkApplication.fa,v.AFrameworkApplication.X4a,v.AFrameworkApplication.ZP,()=>new ih))}static main(){e.a.instance.Ac(new Wg)}}Object(h.a)(Wg,"PackageManager",null,[2,3]);var jf=d(167),
kg=d(178);class vh{constructor(t){this.G9a=this.xne=this.Qab=this.D_c=0;this.bme=this.kMg=null;t?(this.yb=t,this.aXb=Date.now,this.ezi(),this.PLk()):m.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}S3k(){this.kMg="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}PLk(){window.document.body.addEventListener("pointerenter",Object(n.a)(this,this.Emk,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(n.a)(this,this.Fmk,
"onPointerLeave"));u.a.instance.La("Common.App.VisibilityManagement.IVisibilityManager").execute(t=>{t.Mzc(Object(n.a)(this,this.x1b,"handleVisibilityChange"))})}Emk(t){"pen"!==t.pointerType||this.Qab||(this.Qab=Math.floor(this.aXb()/1E3),this.Qab<=this.D_c&&(this.Qab=this.D_c),this.xne=0)}Fmk(){this.Hhg()}Hhg(){const t=Math.ceil(this.aXb()/1E3);this.Qab&&t>this.D_c&&(this.xne=t,this.G9a+=this.xne-this.Qab);this.D_c=t;this.Qab=0}x1b(t,N){0!==N.newState&&this.Hhg()}ezi(){this.bme=new Y.a(4,2,6E4,Object(n.a)(this,
this.aXj,"logPenUsage"));this.yb.Gb(this.bme)}aXj(){0<this.G9a&&this.xjh(this.G9a);this.G9a=0}xjh(t){const N=new kg.a;N.name=this.kMg;const ha=[];(t=jf.a.j7("PenInputSec",t.toString(),3))&&Array.add(ha,t);N.dataFields=ha;w.a.sendActivityEvent(N)}dispose(){0<this.G9a&&this.xjh(this.G9a);this.yb.Qg(this.bme)}}Object(h.a)(vh,"PenMinutesManager",null,[818]);class nd{constructor(){this.Zyd=this.Da=null}get name(){return"Common.App.PenMinutesManager"}Wb(t){this.Da=t;const N=v.AFrameworkApplication.ue;this.Da.register(818,
"Common.App.PenMinutesManager.IPenMinutesManager").ma().na(()=>new vh(N))}init(){this.Zyd=this.Da.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.Zyd&&this.Zyd.dispose()}static main(){e.a.instance.Ac(new nd)}}Object(h.a)(nd,"PenMinutesManagerPackage",null,[2,3]);class Oe extends Fa.StandardDialog{constructor(t,N){super();this.Ukb=!1;this.DJ=null;this.Ca=t;this.nMb=N;this.oYa=!1}Lu(t,N,ha){this.DJ=N;this.Ukb=ha;m.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
t,ha);t=this.JLd(t);0===t?(this.vd=6,this.Re(0,CommonUIStrings.l_DialogClose)):(this.vd=0,this.Re(1,CommonUIStrings.l_DialogClose));0===t&&m.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Vx(Md.a.gXk,this.w1i(t),this.v1i(t,N),Object(n.a)(this,this.rFe,"retryDialogHandler"),!0)}rFe(t){1===t?(m.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.DJ?this.Ca.Ka(G.a.iFb,2,[this.DJ,this.Ukb]):this.Ca.processAction(G.a.iFb,2)):m.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")}JLd(t){return 0>t||6<t?(m.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",t),0):t}v1i(t,N){t=this.JLd(t);return this.nMb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,N),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][t]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,N),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][t]}w1i(t){t=this.JLd(t);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][t]}}
Object(h.a)(Oe,"ErrorRetryDialog",Fa.StandardDialog,[940]);class ti{constructor(t,N){this.jb=t;this.Ca=N;this.nMb=this.jb.ka("SaveToHostWithExtraCharsInFileName")}create(){return new Oe(this.Ca,this.nMb)}}Object(h.a)(ti,"ErrorRetryDialogFactory",null,[912]);class Kh extends fd.a{constructor(t,N,ha,Aa,Ra,yb,Sb=null){super();this.yU=null;this.Ca=N;this.E$=Aa;this.lza=yb;this.jb=t;this.eA=Ra;this.Kh=ha;this.nMb=this.jb.ka("SaveToHostWithExtraCharsInFileName");this.Sk=Sb;this.Re(1,CommonUIStrings.l_SaveButtonLabel)}get Aa(){return this.Kh}IWf(t,
N){this.sC(1,!!t&&t!==N);this.yU=document.getElementById(Kh.l2f);bd.a.addHandler(this.yU,"change",Object(n.a)(this,this.Z6c,"onFileNameChange"));bd.a.addHandler(this.yU,"input",Object(n.a)(this,this.Z6c,"onFileNameChange"));this.yU.focus()}k2f(t){return this.nMb?(new RegExp("["+this.W_f('\\/:*?"<>|')+"]")).test(t):(new RegExp("["+this.W_f('\\/:*?"<>|#{}%~&')+"]")).test(t)}W_f(t){return t.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}E2d(){const t=gb.a.lG(v.AFrameworkApplication.fu.ux);this.sC(1,
!!this.yU&&""!==this.yU.value&&this.yU.value!==t)}Z6c(){this.yU&&window.setTimeout(()=>{this.E2d()},0)}NIc(t,N){if(1!==t)m.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{t=N[Kh.l2f];N=Kh.f2g in N?N[Kh.f2g]:!1;m.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",gb.a.Aah(t),N);const ha=gb.a.uV(v.AFrameworkApplication.fileName);(t=t?t.trim():null)&&""!==t&&""!==ha||1===this.Aa.state?
this.k2f(t)?this.eA.create().Lu(1,t,N):this.lza.k0(t+ha,N,this.Sk):this.eA.create().Lu(2,t,N)}}dispose(){this.yU&&(bd.a.removeHandler(this.yU,"change",Object(n.a)(this,this.Z6c,"onFileNameChange")),bd.a.removeHandler(this.yU,"input",Object(n.a)(this,this.Z6c,"onFileNameChange")),this.yU=null);super.dispose()}}Kh.l2f="txtFileName";Kh.f2g="chkOverwrite";Object(h.a)(Kh,"FileNameDialogBase",fd.a,[]);class Rd{static get jg(){return fd.a.EB(Rd.Zn,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
Rd.Zn="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(h.a)(Rd,"FileNameDialogHtml",null,[]);class Bj extends Kh{constructor(t,N,ha,Aa,Ra,yb){super(t,N,ha,Aa,Ra,yb);this.jg=Rd.jg;this.kg="FileNameDialog-SaveAsToHost"}Cha(t,N){const ha=gb.a.lG(v.AFrameworkApplication.fu.ux);N={["txtFileName"]:t||ha,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:N};this.pj(CommonUIStrings.L_SaveAs,Object(n.a)(this,this.NIc,"fileNameDialogHandler"),N);this.IWf(t,ha)}}Object(h.a)(Bj,"FileNameDialog",Kh,[939]);class ui{constructor(t,N,ha,Aa,Ra,
yb){this.Ca=N;this.jb=t;this.E$=Aa;this.lza=yb;this.eA=Ra;this.Kh=ha}create(){return new Bj(this.jb,this.Ca,this.Kh,this.E$,this.eA,this.lza)}}Object(h.a)(ui,"FileNameDialogFactory",null,[911]);class Na{constructor(t,N,ha){this.lza=ha;this.Xrd=N;this.jb=t}ub(){2===v.AFrameworkApplication.Aa.gb.Am?v.AFrameworkApplication.Ta.pa(G.a.iFb,E.a.frame,Object(n.a)(this,this.Hhh,"saveAsToHostActionDispatcher"),4):v.AFrameworkApplication.Ta.xa(G.a.iFb,E.a.frame,Object(n.a)(this,this.Hhh,"saveAsToHostActionDispatcher"))}Hhh(t,
N,ha,Aa,Ra){return N.contextId!==E.a.frame||t!==G.a.iFb?2:this.jb.ka("SaveAsToHostBrsIsEnabled")?1===ha?A.SessionStatusManager.instance.tia||v.AFrameworkApplication.UP?8:32:2===ha?(m.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),t=this.Xrd.create(),Ra&&Object.getType(Ra)===Array&&2===Ra.length?t.Cha(Ra[0],!!Ra[1]):t.Cha(null,!1),32):8:8}}Object(h.a)(Na,"SaveAsToHostActor",null,[]);class qb{constructor(t,N,ha,Aa,Ra,yb,Sb,uc){this.vn=null;this.Ukb=this.X0=
!1;this.kza=this.Sk=this.DJ=null;this.jb=N;this.taa=this.jb.appSettings.SaveAsToHostWebServiceBase;this.l6e=Aa;this.uoa=Ra;this.Ei=ha;this.eA=yb;this.Qh=uc;this.Kh=Sb;this.Ca=t;this.dya=N.Ha("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Hkc(){1!==this.Kh.state&&(this.vn=this.uoa(),this.vn.message=CommonUIStrings.l_CommentProgressTooltip,this.vn.vd=5,this.vn.hr=!1,this.vn.Oma(CommonUIStrings.l_DefaultDialogTitle,null,null))}KX(t=0){1!==this.Kh.state&&this.eA.create().Lu(t,gb.a.lG(this.DJ),
this.Ukb)}ceb(){const t=this.jb.appSettings.BreadcrumbFolderUrl;m.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");dd.a.Um(t,dd.a.x$(3),void 0,"UploadToHostManager.RedirectToFolder")}beb(t){let N=!1,ha=!1;this.jb&&(N=this.jb.ka("SaveACopyIsEnabledForUiHost"),ha=this.jb.ka("UiHostSupportsDocRebootFeatures"));m.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",t,N,ha);if(N&&ha){m.ULS.sendTraceTag(51245197,216,
50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Aa={};Aa[Jd.a.fEb]="1";Aa[Jd.a.documentUrl]=t;Aa[Jd.a.reason]=fe.a.eGe;v.AFrameworkApplication.zV().execute(Ra=>{Ra.sendMessage(ce.a.RAa,Aa)})}else N&&!ha&&v.AFrameworkApplication.hsa?dd.a.Um(t,dd.a.x$(4),void 0,"UploadToHostManager.RedirectToEditUrl"):dd.a.Um(t,dd.a.x$(3),void 0,"UploadToHostManager.RedirectToEditUrl")}k0(t,N,ha=null){m.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.l6e&&!this.l6e()&&
this.Ei&&(this.Qh&&(this.kza=this.Qh.wi("DialogShown","SaveAsToHostUploadTime")),this.Hkc(),this.Ukb=N,this.DJ=t,(this.Sk=ha)&&"true"===this.Sk.SkipSaveToHost?this.fIc():this.b2())}b2(){32!==this.Ca.processAction(G.a.wXa,1)?(m.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.fIc()):this.Ca.Ka(G.a.wXa,2,[()=>{m.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.fIc()},(t,N)=>{m.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.KX(N)}])}Dpk(t){this.F4a();this.X0=!1;if(t&&t.data&&t.data.Zd)if(({Hv:N}=qe.d(t.data.Zd)).returnValue)if(t=N,t.StatusCode!==zf.a.Yy&&t.StatusCode!==zf.a.IWb){m.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var N={};N.FailureReason=t.StatusCode.toString();N.ExtraInfo=t.ExtraInfo;this.Pva(N);this.KX(parseInt(t.ExtraInfo))}else{m.ULS.sendTraceTag(8194050,216,50,
"UploadToHost execute success.");this.CEe();try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.beb(t.NewDocumentUrl):this.ceb()}catch(ha){m.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",ha.toString())}this.Bec()}else m.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:xd.a.Lmc(t.data.Zd)}),this.Pva({["FailureReason"]:"Failed to deserialize response"}),this.KX();else m.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Pva({["FailureReason"]:"null response"}),this.KX()}Cpk(t){5!==t.data.status&&12!==t.data.status||this.X0?(m.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:t.data.status,["HttpStatus"]:t.data.af}),this.Pva({["FailureReason"]:t.data.af.toString()}),this.F4a(),this.KX(),this.Bec()):(m.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.X0=!0,this.Sk&&"true"===this.Sk.SkipSaveToHost?this.fIc():this.b2())}F4a(){this.vn&&
(this.vn.close(),this.vn=null)}Bec(){this.kza&&(this.kza.stop(),this.kza=null)}CEe(){this.Sk&&"VersionHistory"===this.Sk.SaveEntryPoint&&this.Ca.processAction(G.a.Ycd,2)}Pva(t){this.Sk&&"VersionHistory"===this.Sk.SaveEntryPoint&&this.Ca.Ka(G.a.DEe,2,t)}fIc(){let t=this.taa+this.dya;t=jb.a.ej(t,"qs",gb.a.Me(v.AFrameworkApplication.Zg));t=jb.a.ej(t,"n",gb.a.Me((new Date).getTime().toString()));t=jb.a.ej(t,"ov",gb.a.Me(this.Ukb.toString()));t=jb.a.ej(t,"fn",gb.a.Me(this.DJ));this.Sk&&this.Sk.FileDownloadUrl&&
(t=jb.a.ej(t,"furl",gb.a.Me(this.Sk.FileDownloadUrl)));this.Ei.vj(t,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(n.a)(this,this.Dpk,"onUploadFinished"),Object(n.a)(this,this.Cpk,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(h.a)(qb,"UploadToHostManager",null,[910]);var wb=d(544);class jc{constructor(){this.Da=null}get name(){return"Common.App.SaveAsToHost"}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){v.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&
this.Da.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").ub()}Wb(t){this.Da=t;this.Da.register(ti,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").na(()=>new ti(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta)).ma();this.Da.register(qb,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").na(()=>new qb(v.AFrameworkApplication.Ta,v.AFrameworkApplication.fa,v.AFrameworkApplication.He,()=>v.AFrameworkApplication.Xg,
()=>(new wb.a).create(),t.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.hU)).ma();this.Da.register(ui,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").na(()=>new ui(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.gb,t.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),t.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma();
this.Da.register(Na,"Common.App.SaveAsToHost.SaveAsToHostActor").na(()=>new Na(v.AFrameworkApplication.fa,t.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),t.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma()}dispose(){}static main(){e.a.instance.Ac(new jc)}}Object(h.a)(jc,"SaveAsToHostPackage",null,[2,3]);class Qc extends Fa.StandardDialog{constructor(){super();this.vd=0;this.Re(1,CommonUIStrings.l_DialogClose)}Lu(t,N){this.dXf(t,N,Md.a.iXk)}dXf(t,N,ha){m.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",ha);this.Vx(ha,t,N,null)}OAa(t,N){m.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Vx(Md.a.kXk,t,N,null,!0)}}Object(h.a)(Qc,"ErrorDialog",Fa.StandardDialog,[905]);class Cd{static get jg(){return fd.a.EB(Cd.Zn,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Cd.Zn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(h.a)(Cd,"FileNameDialogHtml",null,[]);class Ld extends Kh{constructor(t,N,ha,Aa,Ra,yb,Sb,uc){super(t,N,ha,Aa,Ra,yb,uc);this.QKa=this.$Ad=this.CH=null;this.mfi=CommonUIStrings.l_SaveToAnotherFolder;this.jg=Cd.jg;this.kg="FileNameDialog-SaveToSharePoint";this.AQb=Sb;this.qRh=uc}Cha(t){const N=gb.a.lG(v.AFrameworkApplication.fu.ux),ha=v.AFrameworkApplication.breadcrumbFolderName,Aa=v.AFrameworkApplication.breadcrumbBrandName,Ra={["txtFileName"]:t||N};let yb=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.Aa.gb.Am&&
(yb=CommonUIStrings.L_SaveACopy);this.pj(yb,Object(n.a)(this,this.NIc,"fileNameDialogHandler"),Ra);this.IWf(t,N);this.iRd.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost")||(this.CH=document.getElementById("anotherFolder"),t=document.getElementById("folderLocation"),this.$Ad=na.a.FEf(t,this.CH,"anotherFolderDescribedBy",""),this.CH.className="WACButton WACDialogButtonNormal",
t=!1,ha&&ha.length?(this.jAf(this.CH,this.$Ad,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Aa,ha)),t=this.kZh(Aa,ha)):this.jAf(this.CH,this.$Ad,CommonUIStrings.l_CurrentOnlineFolder),this.J_h(this.CH),this.mZh(this.CH),t?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.CH,"SaveToAnotherLocationTwo"),m.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.CH,"SaveToAnotherLocationOne"),
bd.a.addHandler(this.CH,ka.a.click,Object(n.a)(this,this.dwe,"onSaveToAnotherLocationClick")),bd.a.addHandler(this.CH,ka.a.eg,Object(n.a)(this,this.C_g,"onSaveToAnotherLocationKeyDown")))}kZh(t,N){let ha;ha=!1;const Aa=document.getElementById("currentLocation");Aa.innerText="";const Ra=this.Mag(Aa,t),yb=this.Mag(Aa,N);let Sb=255,uc=255;255<Ra+yb&&(Sb=Math.max(238,408-Ra),uc=Math.max(170,408-yb),ha=!0);this.i1h(Aa,t,uc,N,Sb);return ha}Mag(t,N){const ha=document.createElement("div");ha.innerText=N;
ha.style.visibility="hidden";t.appendChild(ha);N=ha.clientWidth;t.removeChild(ha);return N}i1h(t,N,ha,Aa,Ra){N&&(this.iAf(t,N,ha),this.Y0h(t));Aa&&this.iAf(t,Aa,Ra)}iAf(t,N,ha){const Aa=document.createElement("div");Aa.innerText=N;Aa.title=N;Aa.className="SaveToAnotherFolderBreadcrumb";Aa.style.maxWidth=ha.toString()+"px";t.appendChild(Aa)}Y0h(t){const N=document.createElement("span");N.id="FolderSeparator";const ha=document.createElementNS("http://www.w3.org/2000/svg","svg");ha.setAttribute("class",
"SeparatorCaret");const Aa=document.createElementNS("http://www.w3.org/2000/svg","polygon");Aa.setAttribute("points","1 4 1 11 5 7.5");ha.appendChild(Aa);N.appendChild(ha);t.appendChild(N)}jAf(t,N,ha){ha=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ha);N&&(N.innerText=ha);t.tabIndex=0;t.setAttribute(na.a.We,na.a.Xt)}mZh(t){const N=document.createElement("span");N.id="anotherFolderText";N.innerText=this.mfi;N.className="AnotherFolderTextSpan";t.appendChild(N)}J_h(t){const N=
document.createElement("span");N.className="cui-img-cont-float cui-img-16by16 ";this.QKa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.QKa.setAttribute("class","FolderIconSVG");const ha=document.createElementNS("http://www.w3.org/2000/svg","path");ha.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.QKa.appendChild(ha);N.appendChild(this.QKa);t.appendChild(N)}C_g(t){!t||t.keyCode!==
qa.a.aq&&t.keyCode!==qa.a.JJb||this.dwe(t)}dwe(){if(this.yU){const t=gb.a.uV(v.AFrameworkApplication.fileName);let N=this.yU.value;this.hide();N&&""!==N&&""!==t||1===this.Aa.state?(""!==t&&(N+=t),this.k2f(N)?this.eA.create().Lu(1,N,!1):this.AQb.start(N,this.qRh)):this.eA.create().Lu(2,N,!1)}}Zji(t){this.CH&&this.QKa&&(t?(this.CH.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.CH,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.QKa,"DisabledFolderIconSVG")):(this.CH.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.CH,
"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.QKa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.CH,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.QKa,"DisabledFolderIconSVG"))))}E2d(){super.E2d();this.Zji(!!this.yU&&""!==this.yU.value)}dispose(){this.CH&&(bd.a.removeHandler(this.CH,ka.a.click,Object(n.a)(this,this.dwe,"onSaveToAnotherLocationClick")),bd.a.removeHandler(this.CH,ka.a.eg,Object(n.a)(this,this.C_g,"onSaveToAnotherLocationKeyDown")),this.CH=
null);super.dispose()}}Object(h.a)(Ld,"FileNameDialog",Kh,[932]);var ie=d(1159),Qe=d(1160),df=d(897),tf=d(214);class jh{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(h.a)(jh,"SaveAsDialogInput",null,[]);class Dh{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(h.a)(Dh,"SaveLocation",null,[]);var ch=d(87);class Hg{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc){this.mwd=null;this.DJ="";this.AQb=t;this.eA=
N;this.Sk=Zc;this.lza=ha;this.Kh=Ra;this.oE=Aa;this.q2a=Sb;this.Flb=uc;yb&&(this.mwd=new tc.a(()=>new Od.a(yb.value,null)))}A0i(){const t=new ie.a(Qe.a.Qr());t.$("type","currentHost");return Object.assign(new Dh,{folderName:this.oE.breadcrumbFolderName,friendlyPath:this.oE.breadcrumbBrandName,properties:t})}cNj(t){return!!t&&"ClassicMru"===t.type&&!!t.service_info&&!!t.service_info.service_id&&-1!==t.service_info.service_id.indexOf("SHAREPOINT")}Ecj(){if(!this.mwd||!this.q2a)return null;var t=this.mwd.value.Dba("SaveAsToSharePointDialog",
!1);if(!t||3!==t.state||!t.QTg)return null;t=t.QTg;const N=new D.a;let ha=0,Aa=0;for(var Ra=0;Ra<t.length;Ra++){var yb=t[Ra];if(!this.cNj(yb))continue;ha++;if(!yb.sharepoint_info)continue;const Sb=yb.url,uc=yb.sharepoint_info.site_url,Zc=yb.title;yb=df.b(yb,v.AFrameworkApplication.isRtl);if(!(Sb&&uc&&Zc&&yb))continue;Aa++;const ed=new ie.a(Qe.a.Qr());ed.$("type","SharePoint");ed.$("siteUrl",uc);ed.$("folderUrl",Sb);Aa++;N.add(Object.assign(new Dh,{folderName:Zc,friendlyPath:yb,properties:ed}))}Ra=
new Map;Ra.set("NumPlaces",t.length.toString());Ra.set("NumSharepointPlaces",ha.toString());Ra.set("placesWithMetadata",Aa.toString());mf.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Ra);0<ha&&(Aa?.5>1*Aa/ha&&mf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):mf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return N}u1i(){const t=new D.a;t.add(this.A0i());const N=
this.Ecj();N&&t.addRange(N);return Object.assign(new jh,{enableMoreLocations:!v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.DJ,extension:gb.a.uV(this.oE.ux),saveLocations:t.toArray(),scenario:"SaveToSharePoint"})}iLc(){const t=Object(n.a)(this,this.u1i,"getDialogInput"),N={};N.inputPropsCallback=t;return N}Cha(t){this.DJ=t;this.DJ||(this.DJ=String.format(CommonUIStrings.l_SaveACopy_Filename,gb.a.lG(this.oE.ux)));t={["id"]:"SaveAsDialog",["bodyControls"]:this.iLc()};
let N=CommonUIStrings.L_SaveAs;2===this.Kh.gb.Am&&(N=CommonUIStrings.L_SaveACopy);const ha=new fd.a(!1,!1,!0);ha.vd=1;ha.kg="SaveAsDialog";ha.Re(1,CommonUIStrings.l_SaveButtonLabel);ha.pj(N,Object(n.a)(this,this.eXk,"saveAsDialogHandler"),t)}hcl(t,N){t&&""!==t&&""!==N||1===this.Kh.state?this.bNj()?this.ZTj(t,N):(""!==N&&(t+=N),this.AQb.start(t,this.Sk)):(m.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.eA.create().Lu(2,t,!1))}ZTj(t,N){mf.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);const ha=this.Flb.GOd(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.Flb.CYd(ha).then(Aa=>{if(Aa&&0<Aa.length){const Ra=Aa[0][Jd.a.Yuk];Aa=Aa[0][Jd.a.gye];if(""!==Ra&&""!==Aa)this.q2a.k0(Aa,t+N,Ra,this.Sk),mf.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.eA.create().Lu(0,t,!1);const yb=tf.a.pz();yb&&(yb.set("SiteUrlAvailable",""===Ra?"false":"true"),yb.set("FolderUrlAvailable",""===Aa?"false":
"true"));mf.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new ch.a,{extendedProperties:yb}))}}else this.eA.create().Lu(0,t,!1),mf.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Aa=>{"Canceled"===Aa?((Aa=tf.a.pz())&&Aa.set("IsCanceled","true"),mf.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new ch.a,{extendedProperties:Aa}))):mf.Health.instance.recordKpiFailure("SaveACopySFP",
Aa,!1,!1,null)})}bNj(){return this.Flb?this.Flb.H$d():(m.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}eXk(t,N){if(N&&1===t){t=N.fileName;var ha=gb.a.uV(this.oE.ux);N.moreLocationsSelected&&this.hcl(t,ha);if(N.locationCallback){var Aa=N.locationCallback();Aa?Aa.properties&&"currentHost"===Aa.properties.ga("type")?this.lza.k0(t+ha,!1,this.Sk):Aa.properties&&"SharePoint"===Aa.properties.ga("type")?(N=Aa.properties.ga("siteUrl"),Aa=Aa.properties.ga("folderUrl"),this.q2a.k0(Aa,
t+ha,N,this.Sk)):m.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):m.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else m.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(h.a)(Hg,"ReactSaveAsDialog",null,[932]);class wh{constructor(t,N,ha,Aa,Ra,yb,Sb,uc=null,Zc=null,ed=null){this.Ca=N;this.jb=t;this.E$=Aa;this.lza=yb;this.eA=Ra;this.Kh=ha;this.$sf=Sb;this.jPh=uc;this.q2a=Zc;this.Flb=ed}create(t){return this.Kh&&this.Kh.gb.QB?new Hg(this.$sf,
this.eA,this.lza,v.AFrameworkApplication.fu,this.Kh,this.jPh,this.q2a,this.Flb,t):new Ld(this.jb,this.Ca,this.Kh,this.E$,this.eA,this.lza,this.$sf,t)}}Object(h.a)(wh,"FileNameDialogFactory",null,[904]);class Yh{constructor(t,N,ha,Aa){this.Rn=this.bga=null;this.N_a=t;this.Kh=ha;this.$Rh=Aa;this.Gfa=new tc.a(()=>new Od.a(N.value,Object(n.a)(this,this.SBa,"getMoreInfoEventReceived")))}get ACb(){this.bga||(this.Gfa.value.Dba("Save As",!0),this.Rn&&this.Rn.EQ&&this.Rn.EQ.length&&(this.bga=this.p_d(this.Rn.EQ)));
return this.bga}start(t){if(!this.ACb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.bga=v.AFrameworkApplication.breadcrumbFolderUrl;else return m.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Rn),!1;const N=this.$Rh();N.OLe();const ha=N.J_d();if(!ha)return m.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),
!1;this.N_a.start((Aa,Ra)=>{N.hide();t(Aa,Ra)},()=>{this.sue(N)},ha,this.bga);return!0}sue(t){t.hide();m.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}p_d(t){t=t.toLowerCase();t.endsWith("/")||(t+="/");const N=t.indexOf("/documents/");return-1!==N?t.substring(0,N+1)+"_layouts/15/onedrive.aspx":""}SBa(t){this.Rn||3!==t.state||(this.Rn=t)}}Object(h.a)(Yh,"OneDriveFilePickerHelper",null,[903]);class Ni extends fd.a{constructor(){super()}OLe(){this.pqc="FilePickerDialog";
this.jg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.kg="PickerDialog-MsoSp";this.showDialog("",null)}J_d(){return document.getElementById("FilePickerDiv")}DF(){}Tla(){}}Object(h.a)(Ni,"PickerDialog",fd.a,[902]);var vi=d(479);class Eh{constructor(t,N,ha,Aa,Ra,yb,Sb){this.jb=t;this.Xrd=ha;this.Ca=N;this.AQb=Aa;this.N_a=Ra;this.pyd=yb;this.nIh=Sb}ub(){const t=this.N_a.nsb();t?Pc.a.Kw||this.jb.ka("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ca.pa(G.a.Ueb,E.a.frame,Object(n.a)(this,
this.$hh,"saveToSharePointActionDispatcher"),64):(t.HDa.continueWith(N=>{N.Wl&&this.N_a.xve(N)}),this.ZBc()):m.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}ZBc(){Cc.a.Zbd(Object(n.a)(this,this.$hh,"saveToSharePointActionDispatcher"));Cc.a.sYb([new vi.a(G.a.Ueb,E.a.frame,0)],this.N_a.nsb())}get Ivb(){return this.jb.ka("SaveToAnotherFolderBrsIsEnabled")}get oLf(){return this.jb.ka("UserCanWriteRelative")}$hh(t,N,ha,Aa,Ra){return N.contextId!==E.a.frame||
t!==G.a.Ueb?2:this.Ivb&&(this.pyd.ACb||this.oLf)?1===ha?A.SessionStatusManager.instance.tia||v.AFrameworkApplication.UP?8:this.nIh()?32:8:2===ha?(m.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Ra&&Ra.SaveEntryPoint&&"VersionHistory"===Ra.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.oLf?(m.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.Xrd.create(Ra).Cha(null)):(m.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.AQb.start(null,Ra)),32):8:8}}Object(h.a)(Eh,"SaveToSharePointActor",null,[]);class xh{constructor(t,N,ha,Aa){this.Sk=this.yef=null;this.q2a=t;this.eA=N;this.pyd=ha;this.Kh=Aa}start(t,N){m.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.yef=t;this.Sk=N;this.pyd.start((ha,Aa)=>{this.IDb(ha,Aa)})||this.PLe()}IDb(t,N){if(t)this.onSuccess(N);else this.Oy(N)}PLe(){1!==this.Kh.state&&this.eA().OAa(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(t){m.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(t&&t.data&&t.data.value&&t.data.value.length&&t.data.value[0].sharePoint){const N=t.data.value[0].sharePoint.url;t=t.data.value[0].sharePoint.listUrl;let ha=null;if(N&&(ha=t?this.Lcj(t):this.Kcj(N))){this.q2a.k0(N,this.yef,ha,this.Sk);return}m.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!N,!ha)}m.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");
this.PLe()}Kcj(t){t.endsWith("/")||(t+="/");let N=0;for(let ha=0;ha<t.length;ha++)if("/"===t.charAt(ha)&&5===++N)return t.substr(0,ha);return null}Lcj(t){t.endsWith("/")&&(t=t.substring(0,t.length-1));const N=t.lastIndexOf("/");return-1!==N?t.substring(0,N):null}Oy(t){m.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");t&&t.error?m.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",t.error.errorCode,t.error.message):m.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.PLe()}}Object(h.a)(xh,"SaveToSharePointManager",null,[901]);class fj{constructor(t,N,ha,Aa,Ra,yb,Sb,uc){this.taa=t;this.DJ=N;this.Gjb=Aa;this.Kzd=yb;this.Una=ha;this.sVh=Ra;this.dya=Sb;this.Sk=uc}execute(t,N){if(!v.AFrameworkApplication.Xg&&v.AFrameworkApplication.He){var ha=this.taa+this.dya;ha=jb.a.ej(ha,"fu",gb.a.Me(this.Una));ha=jb.a.ej(ha,"su",gb.a.Me(this.sVh));ha=jb.a.ej(ha,"fn",gb.a.Me(this.DJ));ha=jb.a.ej(ha,"n",gb.a.Me((new Date).getTime().toString()));
this.Sk&&this.Sk.FileDownloadUrl&&(ha=jb.a.ej(ha,"furl",gb.a.Me(this.Sk.FileDownloadUrl)));ha=ha+"&"+this.Kzd;this.Gjb&&this.Gjb.length?ha=jb.a.ej(ha,"fnn",gb.a.Me(this.Gjb)):m.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");m.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.He.vj(ha,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,t,N,null,void 0,void 0,void 0,void 0,"9")}}}Object(h.a)(fj,"SharePointSaveAsCaller",
null,[861]);class Wi{constructor(t){this.bpa=t.appSettings.SaveAsToHostWebServiceBase;this.DJ=t.appSettings.FileName;this.dya=t.Ha("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(t,N,ha,Aa){return new fj(this.bpa,this.DJ,t,N,ha,v.AFrameworkApplication.Zg,this.dya,Aa)}}Object(h.a)(Wi,"SharePointUploadCallerFactory",null,[842]);var yh=d(489);class Rj{constructor(t,N,ha,Aa,Ra){this.vn=this.NKb=null;this.fod=!1;this.WAd=this.Una=null;this.fEd=N;this.uoa=ha;this.eA=Aa;this.Kh=Ra;this.Ca=
t}k0(t,N,ha,Aa){this.fod=!1;m.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Hkc();this.Una=t;Aa&&Aa.SaveEntryPoint&&(this.WAd=Aa.SaveEntryPoint);this.NKb=this.fEd.create(t,N,ha,Aa);Aa&&"true"===Aa.SkipSaveToHost?this.b2():this.bUi()}bUi(){const t=()=>{m.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.b2()};32!==this.Ca.Ka(G.a.wXa,2,[()=>{m.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.b2()},t])&&t()}b2(){m.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.NKb.execute(Object(n.a)(this,this.Hnk,"onSaveToSharePointUploadFinished"),Object(n.a)(this,this.Gnk,"onSaveToSharePointUploadFailed"))}Hnk(t){if(t&&t.data&&t.data.Zd){var N;if(({Hv:N}=qe.d(t.data.Zd)).returnValue)if(N.StatusCode!==zf.a.Yy&&N.StatusCode!==zf.a.IWb)m.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
t.data.status,N.StatusCode),N.StatusCode!==zf.a.Veh&&this.yXf(t.data.status)||(this.Pva(N.StatusCode.toString()),this.mbl(N.StatusCode));else{m.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.CEe();try{N.NewDocumentUrl?this.beb(N.NewDocumentUrl):this.ceb()}catch(ha){m.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",ha.toString())}}else m.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:xd.a.Lmc(t.data.Zd)}),
this.OGc()||(this.Pva("Failed to deserialize response"),this.Fkc())}else m.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.OGc()||(this.Pva("Unknown"),this.Fkc())}Gnk(t){t&&t.data?this.yXf(t.data.status)||(m.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Pva(yh.a[t.data.status]),this.Fkc()):(m.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.OGc()||(this.Pva("Unknown"),this.Fkc()))}OGc(){if(!this.fod)return m.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.fod=!0,this.b2(),!0;m.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}yXf(t){m.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",t);return this.OGc()}ceb(){m.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");dd.a.Um(this.Una,dd.a.x$(3),void 0,"UploadToSharePointManager.RedirectToFolder")}beb(t){let N=!1,ha=!1;v.AFrameworkApplication.fa&&(N=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),
ha=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));m.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",t,N);if(N&&ha){m.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Aa={};Aa[Jd.a.fEb]="1";Aa[Jd.a.documentUrl]=t;Aa[Jd.a.reason]=fe.a.eGe;v.AFrameworkApplication.zV().execute(Ra=>{Ra.sendMessage(ce.a.RAa,Aa)})}else dd.a.Um(t,dd.a.x$(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Hkc(){this.Kh&&
1===this.Kh.state||(this.vn=this.uoa(),this.vn.message=CommonUIStrings.l_CommentProgressTooltip,this.vn.vd=5,this.vn.hr=!1,this.vn.Oma(CommonUIStrings.l_DefaultDialogTitle,null,null))}F4a(){this.vn&&(this.vn.close(),this.vn=null)}Fkc(){this.Ts(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}lcl(){this.Ts(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}tbl(){const t=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.Ts(CommonUIStrings.l_SaveAsFileTooLargeTitle,t,Md.a.fXk)}Ts(t,N,ha=Md.a.jXk){m.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",t,N);this.F4a();1!==this.Kh.state&&this.eA().dXf(t,N,ha)}mbl(t){m.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",t);switch(t){case zf.a.Azh:this.lcl();break;case zf.a.Veh:this.tbl();break;default:this.Fkc()}}CEe(){"VersionHistory"===this.WAd&&this.Ca.processAction(G.a.Ycd,2)}Pva(t){"VersionHistory"===this.WAd&&this.Ca.Ka(G.a.DEe,
2,{["FailureReason"]:t})}}Object(h.a)(Rj,"UploadToSharePointManager",null,[841]);class Ci{constructor(){this.Lwc=this.sxd=this.mxd=this.Da=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Wb(t){this.Da=t;this.mxd=jg.a.vu(t.La("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.sxd=jg.a.vu(t.La("Common.IEventEmitter<Common.IMruResult>"));this.Lwc=jg.a.vu(t.La("Common.App.SharedFilePicker.ISharedFilePicker"));ph.Task.WAA.call(null,this.mxd,this.sxd,this.Lwc).continueWith(()=>
{this.dKk()})}dKk(){this.Da.register(Wi,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").na(()=>new Wi(v.AFrameworkApplication.fa)).ma();this.Da.register(Rj,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").na(()=>new Rj(v.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new wb.a).create(),()=>new Qc,
v.AFrameworkApplication.Aa)).ma();this.Da.register(xh,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").na(()=>new xh(this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Qc,this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.Aa)).ma();this.Da.register(Yh,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").na(()=>
new Yh(this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new tc.a(()=>this.mxd.result),v.AFrameworkApplication.Aa,()=>new Ni)).ma();this.Da.register(wh,"Common.App.SaveToSharePoint.FileNameDialogFactory").na(()=>new wh(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.gb,this.Da.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Da.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new tc.a(()=>this.sxd.result),this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Lwc?this.Lwc.result:null)).ma();this.Da.register(Eh,"Common.App.SaveToSharePoint.SaveToSharePointActor").na(()=>new Eh(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.Aa.iCc)).ma();v.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&this.Da.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").ub()}static main(){e.a.instance.Ac(new Ci)}}Object(h.a)(Ci,"PackageManager",null,[2,3]);class bk extends Fa.StandardDialog{constructor(){super();this.vd=0;this.Re(1,CommonUIStrings.l_DialogClose)}Lu(t){this.Vx(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(h.a)(bk,"ErrorDialog",Fa.StandardDialog,[918]);class zg{}zg.default=0;Object(h.a)(zg,"SaveToCloudErrorCodes",null,[]);class xf{constructor(t,N,ha,Aa,Ra,yb){this.Sk=null;this.kVh=t;this.laa=N;this.SRb=ha;this.jb=Aa;this.Noc=Ra;this.eA=yb}start(t){this.Sk=t;if("SharePointOnlineConsumer"===this.jb.Ha("FileSource")){const N=u.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(N){N.start(null,t);return}}this.laa.s7d?(m.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),
this.$hi()):(m.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.Tcl())}Tcl(){this.kVh.create().Cha()}Ts(){this.eA().Lu(zg.default)}$hi(){try{m.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let t={["client_id"]:this.jb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.Noc||2===this.Noc)t={["client_id"]:this.jb.appSettings.UploadToSkyDriveClientId};WL.init(t);m.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(n.a)(this,this.onSuccess,"onSuccess"),Object(n.a)(this,this.Oy,"onFailure"))}catch(t){m.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",t,t.stack),this.Ts()}}onSuccess(t){m.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");t&&t.data&&t.data.folders&&this.SRb.k0(t.data.folders[0].id,t.data.folders[0].urls.viewInBrowser,null,this.Sk)}Oy(t){if(t&&
t.error){if("user_canceled"===t.error.code){m.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}m.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else m.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Ts()}}Object(h.a)(xf,"SaveToCloudManager",null,[917]);class Qh{constructor(t,N,ha,Aa){this.cwc=null;this.XTh=t;this.jb=ha;this.Eff=N;this.Bcf=new Zf.a;this.Qh=
Aa}Ivb(){return this.jb.ka("SaveToCloudStorageUIIsEnabled")}Z5f(){return G.a.nGe}ZBc(){Cc.a.Zbd(Object(n.a)(this,this.Xhh,"saveToCloudActionDispatcher"));Cc.a.sYb([new vi.a(G.a.nGe,E.a.frame,0)],this.Eff.nsb())}ub(){const t=this.Eff.nsb();t?(t.HR(()=>{this.Bcf.Bg(!0)}),this.ZBc()):m.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}jah(){m.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}Xhh(t,N,ha,Aa,Ra){return N.contextId!==
E.a.frame||t!==this.Z5f()?2:this.Ivb()?1===ha?A.SessionStatusManager.instance.tia||v.AFrameworkApplication.UP?8:32:2===ha?(this.jah(),Ra&&Ra.FileDownloadUrl&&m.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Qh&&(this.cwc=this.Qh.wi("DialogShown","SaveToOneDriveReponseTime")),this.Bcf.task.continueWith(()=>{this.cwc&&(this.cwc.stop(),this.cwc=null);this.XTh.start(Ra)}),32):8:8}}Object(h.a)(Qh,"SaveToCloudStorageActor",null,[915]);var Lh=d(216);class oj extends Fa.StandardDialog{constructor(t,
N,ha){super();this.Ca=t;this.laa=N;this.E$=ha;this.EU=!1;this.vd=1;this.fwa(1);this.Re(1,CommonUIStrings.l_SignIn);this.Re(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}Cha(){this.laa.dCf(Object(n.a)(this,this.c0g,"onSignIn"));this.Yw(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(n.a)(this,this.Ryj,"inputHandler"))}Ryj(t){0===t?(m.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.I9c()}nki(){let t="2";if(this.E$)switch(this.E$.Am){case 3:t=
"0";break;case 2:t="3";break;case 1:t="1"}return t}hide(){this.laa.KOk(Object(n.a)(this,this.c0g,"onSignIn"));super.hide()}I9c(){var t=v.AFrameworkApplication.fa.ka("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";t=new Lh.QueryStringBuilder(t);t.Hi("prompt","1");t.Hi("cbcxt",this.nki());v.AFrameworkApplication.HMa(t);dd.a.Um(t.toString(),"LoginWindow",void 0,"SignInDialog")}c0g(){this.VP&&this.hide();m.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.Ca.processAction(G.a.nGe,2)}}Object(h.a)(oj,"SignInDialog",Fa.StandardDialog,[941]);class gj{constructor(t,N,ha){this.Ca=t;this.laa=N;this.E$=ha}create(){return new oj(this.Ca,this.laa,this.E$)}}Object(h.a)(gj,"SignInDialogFactory",null,[913]);class Di{constructor(t,N,ha,Aa,Ra,yb,Sb){this.taa=t;this.DJ=N;this.Gjb=ha;this.vrc=Aa;this.Kzd=Ra;this.dya=yb;this.Sk=Sb}execute(t,N){if(!v.AFrameworkApplication.Xg&&v.AFrameworkApplication.He){var ha=this.taa+this.dya;ha=jb.a.ej(ha,"fo",gb.a.Me(this.vrc));
ha=jb.a.ej(ha,"fn",gb.a.Me(this.DJ));ha=jb.a.ej(ha,"qs",gb.a.Me(this.Kzd));ha=jb.a.ej(ha,"n",gb.a.Me((new Date).getTime().toString()));this.Sk&&this.Sk.FileDownloadUrl&&(ha=jb.a.ej(ha,"furl",gb.a.Me(this.Sk.FileDownloadUrl)));this.Gjb&&(ha=jb.a.ej(ha,"fnn",gb.a.Me(this.Gjb)));v.AFrameworkApplication.He.vj(ha,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,t,N,null)}}}Object(h.a)(Di,"SkyDriveUploadCaller",null,[942]);class dh{constructor(t){this.jb=t;this.bpa=t.appSettings.SkyDriveUploadWebServiceBase;
this.DJ=t.appSettings.FileName;this.dya=t.Ha("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(t,N,ha){return new Di(this.bpa,this.DJ,N,t,v.AFrameworkApplication.Zg,this.dya,ha)}}Object(h.a)(dh,"SkydriveUploadCallerFactory",null,[916]);class Ig{constructor(t,N,ha,Aa,Ra){this.Una=this.vn=this.NKb=null;this.X0=!1;this.Sk=this.kza=null;this.fEd=t;this.uoa=N;this.eA=ha;this.Kh=Aa;this.Qh=Ra}Hkc(){this.Kh&&1===this.Kh.state||(this.vn=this.uoa(),this.vn.message=CommonUIStrings.l_CommentProgressTooltip,
this.vn.vd=5,this.vn.hr=!1,this.vn.Oma(CommonUIStrings.l_DefaultDialogTitle,null,null))}F4a(){this.vn&&(this.vn.close(),this.vn=null)}KX(){1!==v.AFrameworkApplication.Aa.state&&this.eA().Lu(zg.default)}ceb(){m.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");dd.a.Um(this.Una,dd.a.x$(3),void 0,"UploadToCloudManager.RedirectToFolder")}beb(t){let N=!1,ha=!1;v.AFrameworkApplication.fa&&(N=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),ha=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));
m.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",t,N);if(N&&ha){m.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Aa={};Aa[Jd.a.fEb]="1";Aa[Jd.a.documentUrl]=t;v.AFrameworkApplication.zV().execute(Ra=>{Ra.sendMessage(ce.a.RAa,Aa)})}else dd.a.Um(t,dd.a.x$(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}k0(t,N,ha=null,Aa=null){m.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.Qh&&(this.kza=this.Qh.wi("DialogShown","SaveToOneDriveUploadTime"));this.Hkc();this.Una=N;this.NKb=this.fEd.create(t,ha,Aa);this.Sk=Aa;this.b2()}b2(){m.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.NKb.execute(Object(n.a)(this,this.Fnk,"onSaveToCloudUploadFinished"),Object(n.a)(this,this.Enk,"onSaveToCloudUploadFailed"))}Fnk(t){this.F4a();this.X0=!1;if(t&&t.data&&t.data.Zd){var N;if(({Hv:N}=qe.d(t.data.Zd)).returnValue)if(t=N,t.StatusCode!==zf.a.Yy&&t.StatusCode!==zf.a.IWb)m.ULS.sendTraceTag(6590602,
216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.KX();else{m.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.beb(t.NewDocumentUrl):this.ceb()}catch(ha){m.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",ha.toString())}this.Bec()}else m.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:xd.a.Lmc(t.data.Zd)}),this.KX()}else m.ULS.sendTraceTag(6590601,
216,10,"UploadToCloudManager upload failure. Response data is null"),this.KX()}Enk(t){5!==t.data.status&&12!==t.data.status||this.X0?(m.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",t.data.status),this.F4a(),this.KX(),this.Bec()):(m.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.X0=!0,this.b2())}Bec(){this.kza&&(this.kza.stop(),this.kza=null)}}Object(h.a)(Ig,"UploadToCloudManager",null,[914]);class ua{constructor(){this.Da=null}get name(){return"Common.App.SaveToCloudStorage"}init(){v.AFrameworkApplication.fa.ka("SaveToCloudStorageUIIsEnabled")&&
this.Da.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").ub()}dispose(){}Wb(t){this.Da=t;this.Da.register(gj,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").na(()=>new gj(v.AFrameworkApplication.Ta,bh.a.instance,v.AFrameworkApplication.Aa.gb)).ma();this.Da.register(dh,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").na(()=>new dh(v.AFrameworkApplication.fa)).ma();
this.Da.register(Qh,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").na(()=>new Qh(t.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),t.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.hU)).ma();this.Da.register(Ig,"Common.App.SaveToCloudStorage.UploadToCloudManager").na(()=>new Ig(t.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new wb.a).create(),()=>new bk,v.AFrameworkApplication.Aa,
v.AFrameworkApplication.Aa.hU)).ma();this.Da.register(xf,"Common.App.SaveToCloudStorage.SaveToCloudManager").na(()=>new xf(t.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),bh.a.instance,t.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.X4a,()=>new bk)).ma()}static main(){e.a.instance.Ac(new ua)}}Object(h.a)(ua,"PackageManager",null,[2,3]);class Pa{static get jg(){return fd.a.EB(Pa.Zn,CommonUIStrings.l_SaveACopyFileName)}}
Pa.Zn="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(h.a)(Pa,"FileNameDialogHtml",null,[]);class eb extends fd.a{constructor(t,N,ha,Aa){super();this.vrc=this.Una=null;this.Ca=t;this.E$=N;this.SRb=ha;this.Re(1,
CommonUIStrings.l_SaveButtonLabel);this.jg=Pa.jg;this.kg="FileNameDialog-SaveACopy";this.Sk=Aa}Cha(t,N,ha){this.vrc=t;this.Una=ha;t={["txtFileName"]:gb.a.lG(v.AFrameworkApplication.fu.ux),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,N)};this.pj(CommonUIStrings.l_SaveToOneDrive,Object(n.a)(this,this.NIc,"fileNameDialogHandler"),t);m.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}NIc(t,N){1!==t?
m.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(t=N.txtFileName.trim(),m.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),N=gb.a.uV(v.AFrameworkApplication.fileName),t&&""!==t&&""!==N&&(t+=N),this.SRb.k0(this.vrc,this.Una,t,this.Sk))}}Object(h.a)(eb,"FileNameDialog",fd.a,[947]);class Kb{constructor(t,N,ha){this.Ca=t;this.E$=N;this.SRb=ha}create(t){return new eb(this.Ca,this.E$,this.SRb,t)}}Object(h.a)(Kb,"FileNameDialogFactory",
null,[920]);class bc extends Fa.StandardDialog{constructor(t){super();this.vd=1;this.Re(1,CommonUIStrings.l_RetryButtonLabel);this.Re(0,CommonUIStrings.l_DialogClose);this.Ca=t}Lu(t){m.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",t);this.Vx(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(n.a)(this,this.rFe,"retryDialogHandler"))}rFe(t){1===t?(m.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Ca.processAction(G.a.Qic,2)):
m.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(h.a)(bc,"RetryDialog",Fa.StandardDialog,[918]);class oc extends Qh{constructor(t,N,ha,Aa){super(t,N,ha,Aa);this.jRh=N}Ivb(){return this.jb.ka("SaveACopyBrsIsEnabled")}Z5f(){return G.a.Qic}ZBc(){Cc.a.Zbd(Object(n.a)(this,this.Xhh,"saveToCloudActionDispatcher"));Cc.a.sYb([new vi.a(G.a.Qic,E.a.frame,0)],this.jRh.nsb())}jah(){m.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(h.a)(oc,
"SaveACopyActor",Qh,[]);class W extends xf{constructor(t,N,ha,Aa,Ra,yb,Sb){super(N,ha,Aa,Ra,yb,Sb);this.oLh=t}onSuccess(t){t&&t.data&&t.data.folders?(m.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.oLh.create(this.Sk).Cha(t.data.folders[0].id,t.data.folders[0].name,t.data.folders[0].urls.viewInBrowser)):(m.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Ts())}Oy(t){t&&t.error&&"user_canceled"===t.error.code&&m.ULS.sendTraceTag(7205457,
216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.Oy(t)}Ts(){m.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.Ts()}}Object(h.a)(W,"SaveACopyManager",xf,[]);class ta extends Ig{constructor(t,N,ha,Aa,Ra,yb){super(N,ha,Aa,Ra,yb);this.Ca=t}w$d(){return!!this.Sk&&!!this.Sk.SaveEntryPoint&&"VersionHistory"===this.Sk.SaveEntryPoint.toString()}KX(){m.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.w$d()&&this.Ca.Ka(G.a.DEe,2,{["FailureReason"]:"Unknown"});
super.KX()}ceb(){m.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.w$d()&&this.Ca.processAction(G.a.Ycd,2);super.ceb()}beb(t){m.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",t);this.w$d()&&this.Ca.processAction(G.a.Ycd,2);super.beb(t)}b2(){this.Sk&&"true"===this.Sk.SkipSaveToHost?super.b2():32!==this.Ca.processAction(G.a.wXa,1)?(m.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),
super.b2()):this.Ca.Ka(G.a.wXa,2,[()=>{m.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Ig.prototype.b2.call(this)},()=>{m.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.KX()}])}}Object(h.a)(ta,"SaveACopyUploadToCloudManager",Ig,[]);class da{constructor(){this.Da=null}get name(){return"Common.App.SaveACopy"}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){v.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")&&
this.Da.resolve("Common.App.SaveACopy.SaveACopyActor").ub()}dispose(){}Wb(t){this.Da=t;this.Da.register(ta,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").na(()=>new ta(v.AFrameworkApplication.Ta,t.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new wb.a).create(),()=>new bc(v.AFrameworkApplication.Ta),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.hU)).ma();this.Da.register(Kb,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").na(()=>
new Kb(v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa.gb,t.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ma();this.Da.register(oc,"Common.App.SaveACopy.SaveACopyActor").na(()=>new oc(t.resolve("Common.App.SaveACopy.SaveACopyManager"),t.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.hU)).ma();this.Da.register(W,"Common.App.SaveACopy.SaveACopyManager").na(()=>new W(t.resolve("Common.App.SaveACopy.FileNameDialogFactory"),
t.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),bh.a.instance,t.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.X4a,()=>new bc(v.AFrameworkApplication.Ta))).ma()}static main(){e.a.instance.Ac(new da)}}Object(h.a)(da,"PackageManager",null,[2,3]);var Ea=d(417);class $a{constructor(t){this.VJg=null;m.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.t$b=v.AFrameworkApplication.fa.Ha("PhoneLinkServiceEndpoint");
(this.dL=t)||m.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.t$b&&this.t$b.length||m.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}XPi(t){t&&(this.t$b="https://dcg-df.microsoft.com/",m.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.WPi()}WPi(){m.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.VJg)m.ULS.sendTraceTag(527574722,
306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.VJg=new Date;var t=new Date;this.dL.q0("BayBridge",this.t$b).then(N=>{const ha=+new Date-+t;N.IsSuccess?(m.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",ha),this.QPi(N.Token,this.NXi())):m.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
ha,N.ErrorCode,N.ErrorMessage)}).catch(N=>{m.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",N,+new Date-+t)})}}QPi(t,N){const ha={};ha.Authorization="Bearer "+t;ha["Authorization-Type"]="AAD";ha.Accept="application/json";ha["DCG-SessionId"]=v.AFrameworkApplication.userSessionId;v.AFrameworkApplication.He.vj(N,1,null,ha,!1,2,Object(n.a)(this,this.Idj,"getStatusSucceeded"),Object(n.a)(this,this.Gdj,"getStatusFailed"),null,void 0,void 0,
void 0,void 0,"39");Eb.a("FetchAccountLinkedStatus")}QYi(){const t=Ea.a.instance.getItem("AccountLinkedStatusCache");return t&&t.length?"true"===t.toLowerCase()?!0:!1:!1}NXi(){return this.t$b+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}Gdj(){m.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}Idj(t){m.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");t=qe.a(t.data.Zd).state+"";Ea.a.instance.setItem("AccountLinkedStatusCache",
t)}}Object(h.a)($a,"PhoneLinkManager",null,[817]);class fb{constructor(){this.Da=null}get name(){return"Common.App.PhoneLink"}Wb(t){this.Da=t;this.Da.register(817,"Common.App.PhoneLink.IPhoneLinkManager").ma().na(()=>new $a(this.Da.resolve("Common.App.OAuth.IOAuthManager")))}init(){v.AFrameworkApplication.fa.ff(()=>{this.xCa()})}xCa(){this.Da.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){e.a.instance.Ac(new fb)}}Object(h.a)(fb,"PhoneLinkPackage",null,[2,3]);var qc;(function(t){t[t.myFiles=
0]="myFiles";t[t.recent=1]="recent";t[t.currentFolder=2]="currentFolder";t[t.yourPhone=3]="yourPhone"})(qc||(qc={}));Object(h.b)("SharedFilePickerLandingLocation",qc);class Hc{constructor(t){this.v7a=this.MDb=null;this._initialized=!1;this.s4d=t}mTd(t){this._initialized||(t.Vt(ce.a.X$g),t.ZA(ce.a.X$g,Object(n.a)(this,this.bnk,"onReceivedPickerResponse")),this._initialized=!0)}CYd(t){return this.v7a=new Promise((N,ha)=>{const Aa={};Aa[Jd.a.Xuk]=t;this.MDb=(Ra,yb)=>{""===yb?(m.ULS.sendTraceTag(572548163,
306,50,"Resolving Promise with Picker Data"),N(Ra)):("Canceled"===yb?m.ULS.sendTraceTag(572548164,306,50,yb):m.ULS.sendTraceTag(556901065,306,10,yb),ha(yb))};this.s4d.execute(Ra=>{this.mTd(Ra);Ra.sendMessage(ce.a.Cqk,Aa)})})}bnk(t){this.MDb(t.Values[Jd.a.cZk],void 0===t.Values[Jd.a.$xe]||null===t.Values[Jd.a.$xe]?"":t.Values[Jd.a.$xe])}H$d(){return v.AFrameworkApplication.fa.ka("UiHostCommonFilePicker")}GOd(t,N,ha,Aa,Ra,yb,Sb,uc,Zc=null){const ed={};ed[Jd.a.OYk]=t;ed[Jd.a.titleText]=N;ed[Jd.a.K7h]=
ha;ed[Jd.a.L7h]=Aa;ed[Jd.a.M7h]=Ra;ed[Jd.a.KGi]=!0;ed[Jd.a.rQi]=yb;ed[Jd.a.$uk]=Sb;ed[Jd.a.Zuk]=qc[uc];Sa.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(ed[Jd.a.avk]="Dark");Zc&&(null!=Zc.fnb&&(ed[Jd.a.fnb]=Zc.fnb),null!=Zc.Ctb&&(ed[Jd.a.Ctb]=Zc.Ctb));return ed}}Object(h.a)(Hc,"SharedFilePickerManager",null,[839]);class kd{constructor(){this.Da=null}get name(){return"Common.App.SharedFilePicker"}Wb(t){this.Da=t;t.register(Hc,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ma().na(()=>
new Hc(t.La("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa.ff(()=>{this.xCa()})}xCa(){this.Da.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Ac(new kd)}}Object(h.a)(kd,"SharedFilePickerPackage",null,[2,3]);class Ac{constructor(t,N=3E4){this.Rml=9E5;this.Vml=1E4;this.nDg=this.Yyb=null;this.Xde=0;this.aXb=Date.now;this.FNc=t;this.dkd=N;this.qKc()}Ueg(t=!0){const N=this.aXb();if(N<this.Xde+this.Rml)return N>this.Xde+this.Vml&&this.qKc(),
this.nDg;t&&this.qKc();return null}getToken(t=!0){return(t=this.Ueg(t))?Promise.resolve(t):this.qKc()}qKc(){return this.Yyb=this.Yyb||new Promise(t=>{this.FNc().then(N=>{this.Yyb=null;""!==N&&N&&(this.nDg=N,this.Xde=this.aXb(),t(N));t(null)}).catch(()=>{this.Yyb=null;t(null)});window.setTimeout(()=>{this.Yyb=null;t(null)},this.dkd)})}}Object(h.a)(Ac,"OAuthCacheManager",null,[]);var Lc=d(113),yc=d(66);class Oc{static cXd(t){return""!==t&&t?Oc.l8h[t.toLowerCase()]:""}static Nfj(t,N){const ha=Date.now();
var Aa=Oc.WDc();const Ra=v.AFrameworkApplication.fa.Ha("UserPrincipalName"),yb=Oc.cXd(t);m.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+t);if(""===Ra||!Ra)return m.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===yb||!yb)return m.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+t),Promise.resolve("");const Sb=Lc.a.create().toString();Aa=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none",
"https://login.microsoftonline.com",yb,encodeURIComponent(N),encodeURIComponent(Ra),encodeURIComponent(Aa),Sb);const uc=document.createElement("iframe");uc.style.display="none";uc.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");uc.src=Aa;document.body.appendChild(uc);return new Promise(Zc=>{Oc.pdk(uc.contentWindow).then(ed=>{document.body.removeChild(uc);const Gd=new yc.a,ze=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let re;for(;re=ze.exec(ed);)3!==re.length&&(m.ULS.sendTraceTag(593862983,
1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",re.length),Zc("")),Gd.$(re[1],re[2]);Gd.Jb("access_token")?(m.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",N,t,Date.now()-ha),Zc(Gd.ga("access_token"))):(m.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",N,t,(Date.now()-ha).toString()),Zc(""))}).catch(ed=>{try{document.body.removeChild(uc)}catch(Gd){}m.ULS.sendTraceTag(593862980,
1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",N,t,JSON.stringify(ed),(Date.now()-ha).toString());Zc("")})})}static WDc(){const t=window.location.protocol,N=window.location.host;var ha=v.AFrameworkApplication.fa.Ha("OAuthManagerHostPathOverride");if(void 0===ha||null===ha){ha=window.location.pathname;const Aa=ha.lastIndexOf("/");ha=0<=Aa?ha.substring(0,Aa+1):""}return t+"//"+N+ha+"WacOAuth.html"}static pdk(t){return new Promise((N,ha)=>{let Aa=0,Ra=0;Ra=window.setInterval(()=>
{if(200<Aa++)window.clearInterval(Ra),ha("Exceeded 10000ms timeout after 200 polls");else{var yb=null,Sb=null;try{if(!t||t.closed){window.clearInterval(Ra);ha("Window or Frame is closed before completion");return}yb=t.location.href;Sb=t.location.hash}catch(uc){}yb&&"about:blank"!==yb&&Sb&&""!==Sb&&(window.clearInterval(Ra),N(Sb))}},50)})}}Oc.l8h={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(h.a)(Oc,"OAuthHelper",null,[]);class od{constructor(t,
N){this.token=t;this.source=N}}Object(h.a)(od,"TokenResult",null,[]);class di{constructor(){this.dL=null;this.d1e={};this.zIb=new ie.a(Qe.a.Qr())}getToken(t,N,ha=!1){if(this.zIb.Jb(N))return this.zIb.ga(N).getToken();const Aa=new Ac(()=>ha?this.Veg(t,N):this.FNc(t,N));this.zIb.$(N,Aa);return Aa.getToken()}Lfj(t,N,ha=!1){if(this.zIb.Jb(N))return this.zIb.ga(N).Ueg();const Aa=new Ac(()=>ha?this.Veg(t,N):this.FNc(t,N));this.zIb.$(N,Aa);return null}FNc(t,N){const ha=Date.now();return Oc.Nfj(t,N).then(Aa=>
new od(Aa,"SSOStack")).then(Aa=>new Promise(Ra=>{Aa.token&&""!==Aa.token?(m.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",t,Aa.source,Date.now()-ha),this.HXa("GetTokenInternal",!0,Date.now()-ha,t,"","",N),Ra(Aa.token)):(m.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",t,Date.now()-ha),this.HXa("GetTokenInternal",!1,Date.now()-ha,t,"GetTokenSilent Failed","SSO Token provider failed!",N),Ra(""))}))}Veg(t,N){if(!this.dL)try{this.dL=
u.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ha){m.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+ha)}return this.dL?new Promise(ha=>{const Aa=Date.now();this.dL.q0(t,N).then(Ra=>{const yb=Ra.Token;!Ra.IsSuccess||this.OOj(yb)?(this.HXa("GetTokenInternalImplicitJS",!1,Date.now()-Aa,t,Ra.ErrorCode,Ra.ErrorMessage,N),ha(null)):(this.HXa("GetTokenInternalImplicitJS",!0,Date.now()-Aa,t,Ra.ErrorCode,Ra.ErrorMessage,N),ha(yb))}).catch(Ra=>{Ra=Ra?qe.c(Ra):"";this.HXa("GetTokenInternalImplicitJS",
!1,Date.now()-Aa,t,"Caught Exception",Ra,N);ha(null)})}):new Promise(ha=>{this.HXa("GetTokenInternalImplicitJS",!1,0,t,"Null OAuthManager","OAuthManager not set");ha(null)})}HXa(t,N,ha,Aa,Ra="",yb="",Sb=""){var uc="Search"===Aa;const Zc=[];t=jf.a.j7(uc?"Event":"EventName",t,2);Aa=jf.a.j7("AppName",Aa,2);Array.add(Zc,t);Array.add(Zc,Aa);uc&&(Aa=jf.a.j7("LatencyType","FetchToken",2),Array.add(Zc,Aa));Ra&&""!==Ra&&(Ra=jf.a.j7("ErrorCode",Ra,2),Array.add(Zc,Ra));yb&&""!==yb&&(yb=jf.a.j7("ErrorMessage",
yb,2),Array.add(Zc,yb));Sb&&""!==Sb&&(yb=!(Sb in this.d1e),this.d1e[Sb]=yb,yb=jf.a.j7("WarmUpCall",yb.toString(),1),Array.add(Zc,yb),Sb=jf.a.j7("Service",this.fNc(Sb),2),Array.add(Zc,Sb));uc=uc?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";N=Object.assign(new kg.a,{name:uc,samplingPolicy:2,dataFields:Zc,succeeded:N,durationMs:ha});w.a.sendActivityEvent(N)}fNc(t){return t===v.AFrameworkApplication.Ece?"Loki":t===v.AFrameworkApplication.QNe?"Substrate":v.AFrameworkApplication.fa&&
t===v.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}OOj(t){return!t||!t.length}}Object(h.a)(di,"SearchOAuthManager",null,[816]);class ij{constructor(){this.Da=null}get name(){return"Common.App.SearchOAuthManager"}Wb(t){this.Da=t;this.Da.register(816,"Common.App.SearchCommon.ISearchOAuthManager").ma().na(()=>new di)}init(){}dispose(){}static main(){e.a.instance.Ac(new ij)}}Object(h.a)(ij,"SearchOAuthPackage",null,[2,3]);var rh;(function(t){t[t.generalException=
0]="generalException";t[t.invalidArgument=1]="invalidArgument";t[t.notAllowed=2]="notAllowed";t[t.apiNotAvailable=3]="apiNotAvailable";t[t.unresolvedPendingRequest=4]="unresolvedPendingRequest";t[t.timeout=5]="timeout";t[t.adalTimeout=6]="adalTimeout";t[t.userNotSignedIn=7]="userNotSignedIn";t[t.userAborted=8]="userAborted";t[t.silentSignInFailed=9]="silentSignInFailed";t[t.invalidResourceUrl=10]="invalidResourceUrl";t[t.invalidGrant=11]="invalidGrant";t[t.connectionLost=12]="connectionLost";t[t.clientError=
13]="clientError";t[t.serverError=14]="serverError"})(rh||(rh={}));Object(h.b)("ErrorCodes",rh);class Qg{}Object(h.a)(Qg,"HostApplicationType",null,[]);class be{constructor(t,N){this.requestCallback=this.requestParameters=null;this.requestParameters=t;this.requestCallback=N}}Object(h.a)(be,"OutstandingRequest",null,[]);class Oi{}Oi.$ek="AADSTS50058";Oi.invalidResourceUrl="AADSTS50001";Oi.Uek="AADSTS65001";Oi.lfk="AADSTS70011";Oi.userAborted="13002";Oi.Vwk="Popup Window is null";Oi.Uwk="Popup Window closed";
Oi.adalTimeout="Token renewal operation failed due to timeout";Oi.Wml="tokenRevoked";Object(h.a)(Oi,"WopiHostErrorType",null,[]);var Pi=d(259),wk=d(342),xk=d(1095);class Yl{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(h.a)(Yl,"WopiIdentityInfo",null,[857]);class Af{constructor(t,N,ha){this.expiration=this.authority=this.accessToken=null;this.accessToken=t;this.authority=N;this.expiration=ha}}Object(h.a)(Af,"WopiIdentityToken",
null,[856]);class Ff{constructor(t){this._initialized=!1;this.ECb={};this.$hd={};this.d$=v.AFrameworkApplication.Aa.hU;this.s4d=t}mTd(t){this._initialized||(t.Vt(ce.a.W4g),t.ZA(ce.a.W4g,Object(n.a)(this,this.$mk,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(t,N,ha=null){this.fYj(t,N);return new Promise((Aa,Ra)=>{if(this.m7d(N))if(N in this.ECb)Ra("unresolvedPendingRequest");else{var yb=window.setTimeout(()=>{m.ULS.sendTraceTag(37856032,344,10,qe.c({["error"]:"Request timeout.",["callerId"]:N}));
Ra("timeout")},12E4);this.OWd(t,N,ha,(Sb,uc)=>{window.clearTimeout(yb);Sb?Aa(Sb):(m.ULS.sendTraceTag(37856033,369,15,qe.c({["error"]:rh[uc]})),Ra(uc))})}else m.ULS.sendTraceTag(37856034,344,10,qe.c({["error"]:"Caller is not allowed."})),Ra("notAllowed")})}getPrimaryIdentityInfo(t){return new Promise((N,ha)=>{this.m7d(t)?this.f$i((Aa,Ra)=>{Aa?N(Aa):(m.ULS.sendTraceTag(37856064,369,10,qe.c({["error"]:Ra.toString()})),ha(Ra))}):(m.ULS.sendTraceTag(37856065,344,10,qe.c({["error"]:"Caller is not allowed."})),
ha("notAllowed"))})}getAuthContext(t){return new Promise((N,ha)=>{const Aa=this.getAuthContextSync(t);Aa?N(Aa):ha("notAllowed")})}getAuthContextSync(t){if(this.m7d(t)){const N=new xk.a;N.upn=v.AFrameworkApplication.fa.Ha("UserPrincipalName");N.userId=v.AFrameworkApplication.fa.Ha("LoggableUserId");N.authority=v.AFrameworkApplication.fa.Ha("HostAuthAuthority");N.tenantId=v.AFrameworkApplication.fa.Ha("TenantId");N.isAnonymous=v.AFrameworkApplication.fa.ka("IsAnonymousUser");N.supportsAuthToken=this.Lsj(t);
t=v.AFrameworkApplication.fa.Ha("HostAuthType");N.authorityType="aad"===t.toLowerCase()?2:"msa"===t.toLowerCase()?1:0;return N}m.ULS.sendTraceTag(40751647,344,10,qe.c({["error"]:"Caller is not allowed."}));return null}Lsj(t){const N=Pi.a.u7a;return Pc.a.xDa?N&&Pi.a.ovh?Array.contains(Pi.a.ovh,t.toLowerCase()):!1:N}OWd(t,N,ha,Aa){var Ra=[];Array.add(Ra,Object.assign(new I.a,{name:"CallerId",string:N}));Array.add(Ra,Object.assign(new I.a,{name:Jd.a.WMe,string:t.correlationId}));w.a.sendTelemetryEvent(Object.assign(new H.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Ra}));Ra=wk.a.create().toString();const yb="getAccessToken_"+Ra,Sb=this.d$.wi("ComponentAttach",yb);this.$hd[yb]=Sb;const uc={};uc[Jd.a.XMe]=Ra;uc[Jd.a.ggl]=t.resource;uc[Jd.a.hgl]=t.scope;uc[Jd.a.nsh]=v.AFrameworkApplication.fa.Ha("HostAuthType");uc[Jd.a.kgl]=v.AFrameworkApplication.fa.Ha("UserPrincipalName");uc[Jd.a.igl]=t.silentLogin;uc[Jd.a.dgl]=t.options;uc[Jd.a.WMe]=t.correlationId;uc[Jd.a.egl]=N;ha&&(uc[Jd.a.addinName]=
ha.AddinName,uc[Jd.a.cgl]=ha.AddinTrustId);this.s4d.execute(Zc=>{this.mTd(Zc);Zc.sendMessage(ce.a.getAuthToken,uc)});this.ECb[Ra]=new be(t,Aa)}f$i(t){const N=v.AFrameworkApplication.fa.Ha("UserName"),ha=v.AFrameworkApplication.fa.Ha("UserPrincipalName"),Aa=v.AFrameworkApplication.fa.Ha("LoggableUserIdSpace"),Ra=new Yl;Ra.email=ha;Ra.displayName=N;switch(Aa){case "OrgIdPuid":Ra.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Ra.authority="MicrosoftAccount";break;default:Ra.authority=
Aa}t(Ra,null)}$mk(t){let N=null;try{let Aa=t.Values[Jd.a.XMe];const Ra=t.Values[Jd.a.bgl],yb=t.Values[Jd.a.nsh],Sb=t.Values[Jd.a.jgl];let uc=null,Zc=null;const ed=this.ECb[Aa];if("undefined"!==typeof ed&&ed){var ha=[];Array.add(ha,Object.assign(new I.a,{name:Jd.a.WMe,string:ed.requestParameters.correlationId}));w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:ha}));N=ed.requestCallback;delete this.ECb[Aa];"undefined"!==
typeof Ra&&Ra&&Ra.length?Zc=new Af(Ra,yb,Sb):uc=rh[this.yak(t)];ha="getAccessToken_"+Aa;ha in this.$hd&&(this.$hd[ha].stop(),delete this.$hd[ha]);N(Zc,uc)}else m.ULS.sendTraceTag(37856066,344,10,qe.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Aa}))}catch(Aa){t=t.Values[Jd.a.XMe],t in this.ECb&&delete this.ECb[t],this.zVc(),m.ULS.sendTraceTag(37856067,344,10,qe.c({["error"]:Aa.message,["stack"]:Aa.stack})),N&&N(null,"generalException")}}m7d(t){var N=v.AFrameworkApplication.fij();
t=t.toLowerCase();for(const ha of N)if(t===ha.toLowerCase())return!0;N=Pi.a.rHd;for(let ha in N)if(t===N[ha].toLowerCase())return!0;return!1}yak(t){t=t.Values[Jd.a.fgl];this.zVc();m.ULS.sendTraceTag(39068821,344,15,qe.c({["error"]:t}));return t?-1<t.indexOf(Oi.$ek)?9:-1<t.indexOf(Oi.Vwk)||-1<t.indexOf(Oi.Uwk)?12:-1<t.indexOf(Oi.invalidResourceUrl)?10:-1<t.indexOf(Oi.userAborted)?8:-1<t.indexOf(Oi.lfk)||-1<t.indexOf(Oi.Uek)||t===Oi.Wml?11:-1<t.indexOf(Oi.adalTimeout)?6:0:13}fYj(t,N){t=this.BJk(t.resource);
m.ULS.sendTraceTag(39921882,344,50,qe.c({["callerId"]:N,["resource"]:t}))}zVc(){m.ULS.sendTraceTag(39068822,344,50,qe.c({["userAgent"]:window.navigator.userAgent}))}BJk(t){return(t?t:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(h.a)(Ff,"WopiIdentityManager",null,[838]);class pj{constructor(){this.Da=null}get name(){return"Common.App.WopiIdentity"}Wb(t){this.Da=t;t.register(Ff,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ma().na(()=>
new Ff(t.La("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){try{this.Da.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(t){m.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+t)}}dispose(){}static main(){e.a.instance.Ac(new pj)}}Object(h.a)(pj,"WopiIdentityPackage",null,[2,3]);var dl=d(652);class Zl extends dl.a{constructor(t,N){super(t,jb.a.lS(N))}Iva(t,
N){this.isEnabled()&&this.Tyc(this.UIa)&&(this.Vt(t),this.ZA(t,N))}}Object(h.a)(Zl,"InsertMediaCrossDocumentMessenger",dl.a,[908,726,106]);class Cj{getInstance(t,N){return new Zl(t,N)}}Object(h.a)(Cj,"InsertMediaCrossDocumentMessengerFactory",null,[868]);class Sm{constructor(t,N,ha){this.correlationId=null;this.c4=0;this.insertPictureTelemetryEndpoint=null;this.jRd=0;this.FMh=t;this.PRb=[];this.DMh=N;this.Rvf=ha.split(";")}dHb(t,N){Array.clear(this.PRb);t=this.FMh.value;t.$rl(N.otb);t.Tyc(this.DMh);
t.Vt(N.otb);t.ZA(N.otb,ha=>{this.qve(ha,N)});m.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");t.sendMessage(N.tTf,{["FileExtensionFilterList"]:this.Rvf})}W1h(t){Array.contains(this.PRb,t)||Array.add(this.PRb,t)}qve(t,N){m.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");t=N.e3g(t);const ha=[];for(let Aa=0;Aa<t.length;Aa++){const Ra=t[Aa];N.WRc(Ra,this.Rvf)?Array.add(ha,Ra):this.W1h(N.Bcg(Ra))}ha&&
ha.length?N.Qra(ha):m.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.PRb.length&&(N=this.PRb.join(", "),m.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",N),this.qdl(N))}qdl(t){const N=new Fa.StandardDialog;N.vd=0;N.mO(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,t),null)}dispose(){}}Object(h.a)(Sm,"InsertMediaFromHostManager",
null,[936,106]);class im{constructor(t){this.hNh=t}getInstance(){return this.hNh}}Object(h.a)(im,"InsertMediaFromHostManagerFactory",null,[934,935]);class Tm{constructor(){this.rMb=document.createElement("iframe");this.rMb.src="about:blank";this.rMb.style.visibility="hidden";this.rMb.style.position="absolute";this.rMb.style.zIndex="-100"}get p5a(){return this.rMb}}Object(h.a)(Tm,"InsertMediaFromHostOneDriveHostFrame",null,[933]);class jm extends dl.a{constructor(t,N){super(t,"*"===N?N:jb.a.lS(N));
this.dAf(ce.a.insertImage);this.dAf(ce.a.d6d)}reportDocumentLoadedTime(){}}Object(h.a)(jm,"InsertMediaFromOneDriveCrossDocumentMessenger",dl.a,[931,726,106]);var jk=d(267),de=d(529);class Kj{rAc(t){switch(t){case 1:t=8;break;case 4:t=3;break;case 2:t=0;break;default:t=0}return t}aei(t,N){return String.format(N,this.rAc(t))}$di(t,N,ha,Aa,Ra,yb,Sb){t=this.rAc(t);const uc=jk.a.le(v.AFrameworkApplication.lcid).name,Zc=v.AFrameworkApplication.buildVersion;v.AFrameworkApplication.o9a("ShIns226;ShIns226cf");
return String.format(N,v.AFrameworkApplication.lcid,uc,Zc,Ra,t,yb,ha,Aa,Sb)}cei(t,N){t=this.rAc(t);const ha=v.AFrameworkApplication.buildVersion,Aa=0<ha.indexOf(".")?ha.substring(0,ha.indexOf(".")):"16";return String.format(N,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,t,Aa,ha,"Video",0,0)}bei(t,N,ha,Aa,Ra,yb,Sb){const uc=jk.a.le(v.AFrameworkApplication.lcid).name;t=String.format(N,v.AFrameworkApplication.lcid,uc,v.AFrameworkApplication.buildVersion,ha,this.rAc(t),
Aa);Ra&&(t+="&flipgrid=1");yb&&(Ra=new Lh.QueryStringBuilder(t),Ra.Hi("stream2","1"),t=Ra.toString());"defaultModal"!=Sb&&(Ra=new Lh.QueryStringBuilder(t),Ra.Hi("modalvariation",Sb),t=Ra.toString());return t}g3g(t){if(!t||!t.Values)return null;t=t.Values;if(!t)return null;let N="";"sourceProvider"in t&&(N=t.sourceProvider||"");return Object.assign(new de.a,{Action:t.action||"",Caption:t.caption||"",ContentType:t.contentType||"",Type:t.extension||"",PageUrl:t.pageUrl||"",OriginalUrl:t.sourceUrl||"",
ContentProvider:N,ThumbnailUrl:t.thumbnailUrl||"",LicenseUrl:t.licenseUrl||"",LicenseDisplayName:t.licenseDisplayName||"",Height:t.height||0,Width:t.width||0,SvgContent:t.svgContent||"",Description:t.description||"",ProviderName:t.providerName||""})}ptk(t){const N=[];if(!t||!t.Values||!t.Values.Items)return N;t=t.Values.Items;for(let Aa=0;Aa<t.length;Aa++){var ha=t[Aa];ha&&(ha=Object.assign(new de.a,{Type:ha.Extension||"",OriginalUrl:ha.SourceUrl||"",Caption:ha.caption,Description:ha.description||
"",Height:ha.Height||0,Width:ha.Width||0}),Array.add(N,ha))}return N}WRc(t,N){if(!t)return!1;for(let ha=0;ha<N.length;ha++)if(0<=t.toLowerCase().indexOf(N[ha]))return!0;return!1}tzk(t){let N="";if(t)for(let ha=0;ha<t.length;ha++){const Aa=t[ha];Aa&&(N+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',Aa.OriginalUrl,Aa.Width,Aa.Height))}return N}hhj(t){return(t=Kj.nWk.exec(t))&&2<t.length?t[2].trim():""}}Kj.nWk=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(h.a)(Kj,
"InsertMediaHelper",null,[867]);var qg=d(32);class el{constructor(t){this.vNb=qg.a.insertHyperlink;this.Ca=t}get wz(){return this.vNb}set wz(t){this.vNb=t}Qra(t){try{m.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",t.length);for(let N=0;N<t.length;N++)this.Ca.Ka(this.wz,2,t[N]);m.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",t.length)}catch(N){m.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",
N.toString())}}}Object(h.a)(el,"InsertOneDriveFileHandler",null,[907]);class Cm extends el{constructor(t){super(t)}get tTf(){return ce.a.d6d}get otb(){return ce.a.fzj}e3g(t){return t&&t.Values&&"Items"in t.Values?t.Values.Items:null}Bcg(){K.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}WRc(){return!0}k7g(t,N,ha){t=ha(t);t.length&&(ha={},ha.Items=t,N.sendMessage(this.otb,ha))}f3g(t){const N=[];for(let ha=0;ha<t.data.value.length;ha++){const Aa=
t.data.value[ha];if(Aa){const Ra={};Ra.DisplayText=Aa.name;Ra.Url=Aa.urls.download;Ra.sourceUrl=Aa.urls.download;Ra.caption=Aa.name;Array.add(N,Ra)}}return N}}Object(h.a)(Cm,"InsertOneDriveFileHelper",el,[906,907]);class qj extends fd.a{constructor(){super()}OLe(){this.pqc="FilePickerDialog";this.jg="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this.kg="PickerDialog-Livebooks";this.showDialog("",null)}J_d(){return document.getElementById("OpenFilePickerDiv")}DF(){}Tla(){}}Object(h.a)(qj,
"PickerDialog",fd.a,[965]);class ck{constructor(t,N,ha){this.Rn=this.bga=null;this.N_a=t;this.mzd=ha;this.Gfa=new tc.a(()=>new Od.a(N.value,Object(n.a)(this,this.SBa,"getMoreInfoEventReceived")))}get ACb(){this.bga||(this.Gfa.value.Dba("InsertFromOneDrive",!0),this.Rn&&this.Rn.EQ&&this.Rn.EQ.length&&(this.bga=this.p_d(this.Rn.EQ)));return this.bga}p_d(t){t=t.toLowerCase();t.endsWith("/")||(t+="/");const N=t.indexOf("/documents/");return-1!==N?t.substring(0,N+1)+"_layouts/15/onedrive.aspx":""}SBa(t){this.Rn||
3!==t.state||(this.Rn=t)}start(t){if(!this.ACb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.bga=v.AFrameworkApplication.breadcrumbFolderUrl;else{m.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Rn);return}const N=new qj;N.OLe();const ha=N.J_d();ha?this.N_a.start((Aa,Ra)=>{N.hide();this.IDb(Aa,Ra,t)},()=>{this.sue(N)},
ha,this.bga):m.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}sue(t){t.hide();m.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}IDb(t,N,ha){m.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",t);t&&N&&N.data&&N.data.value&&0<N.data.value.length?(t=this.mzd.getInstance(window.frames[0].parent,window.document.URL),ha.k7g(N,t,Object(n.a)(ha,ha.f3g,
"parseOneDriveV7Response"))):m.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(h.a)(ck,"OneDriveFilePickerHelperV7",null,[929,930]);class Lk{constructor(t,N,ha,Aa){this.ia=N;this.la=t;this.A8=this.la.Rra;this.a8=ha;this.gCg=Aa}get IR(){return this.gCg?this.gCg.instance:null}ub(){this.ia.pa(G.a.ZUc,sb.a.application,Object(n.a)(this,this.nJa,"triggerCommandforAddinCommands"),4);this.ia.pa(G.a.I2a,sb.a.application,Object(n.a)(this,this.nJa,
"triggerCommandforAddinCommands"),4);this.ia.pa(G.a.HCe,sb.a.application,Object(n.a)(this,this.nJa,"triggerCommandforAddinCommands"),4);this.ia.pa(G.a.Vfc,sb.a.application,Object(n.a)(this,this.Vfc,"queryAddInCommandsLoadStatus"),96);this.ia.xa(G.a.zph,sb.a.application,Object(n.a)(this,this.nJa,"triggerCommandforAddinCommands"));this.ia.pa(G.a.ZEb,sb.a.application,Object(n.a)(this,this.nJa,"triggerCommandforAddinCommands"),64);this.ia.xa(G.a.Ekc,sb.a.application,Object(n.a)(this,this.nJa,"triggerCommandforAddinCommands"));
this.ia.pa(G.a.T1b,sb.a.application,Object(n.a)(this,this.nJa,"triggerCommandforAddinCommands"),64);this.ia.xa(G.a.YGb,sb.a.application,Object(n.a)(this,this.nJa,"triggerCommandforAddinCommands"));this.ia.xa(G.a.IYb,sb.a.application,Object(n.a)(this,this.nJa,"triggerCommandforAddinCommands"))}we(){}nJa(t,N,ha,Aa,Ra){if(!this.A8)return 16;if(1===ha)return N=t===G.a.I2a&&(!this.IR||!this.IR.gjj(Ra)),t=t===G.a.I2a&&!!this.IR&&this.IR.H8k(Ra),N||t?8:32;if(this.IR)switch(t){case G.a.ZUc:this.IR.$Uc(Ra);
break;case G.a.I2a:this.IR.i1b(Ra);break;case G.a.Vfc:this.IR.R7g(Ra);break;case G.a.zph:this.IR.zal();break;case G.a.ZEb:this.IR.ZEb(Ra);break;case G.a.HCe:this.IR.DJk();break;case G.a.Ekc:this.IR.Ekc(Ra);break;case G.a.T1b:this.IR.T1b(Ra);break;case G.a.YGb:this.IR.YGb(Ra);break;case G.a.IYb:this.IR.IYb(Ra)}else this.a8.D3a(),this.a8.ySb(t,Ra);return 32}Vfc(t,N,ha,Aa,Ra){if(!this.A8)return 16;this.IR&&this.IR.R7g(Ra);return 32}}Object(h.a)(Lk,"AddinCommandsActor",null,[244]);class Rg{}Rg.taskPaneWidth=
"TaskPaneWidth";Rg.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";Rg.fU="TaskPaneTitle";Rg.nonPersistedSettings="NonPersistedSettings";Rg.onTaskPaneClose="OnTaskPaneClose";Rg.cva="OnRenderedCallback";Object(h.a)(Rg,"PropertyNames",null,[]);var mg=d(961),Dj=d(229);class kk{}kk.$Td="extId";kk.hV="ComponentId";kk.Pwe="OptionalProps";Object(h.a)(kk,"ActionPropertyNames",null,[]);var qn=d(39),yk=d(81);class rn{constructor(){this.idField=null;this.stateField=0}}Object(h.a)(rn,"CT_OsfBackgroundAppData",
null,[]);class nl{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=0;this.widthFieldSpecified=!1}}Object(h.a)(nl,"CT_OsfInsertionInfo",null,[]);var lk=d(960),Xi=d(962),Al=d(326);class Yi{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze){this.IAc=0;this.vig=!1;this.VYj="g_InstallOrigin";
this.pPg=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"]]);this.khg=(re,ff,ah,aj,Df)=>{ff=this.ta.Ba;aj=this.Yb.yf;if(!(this.A8&&ff&&aj)||this.Af.Zc(ff))return 8;if(!this.kGf)return m.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===ah)return 32;gd.a("LogAddinInstallOriginEnabledForPPT")&&(ah=Df?Df.SourceControlId:void 0,window[this.VYj]=this.pPg.get(ah)?this.pPg.get(ah):"Unknown");this.qe?gd.a("UpdateLaunchInsertDialog")?
(re=Df?Df.CommandValueId:null,"LaunchAddinDialogFromTellMe"==(Df?Df.SourceControlId:void 0)&&re?this.qe.LRj(re):this.qe.launchInsertDialog()):this.qe.launchInsertDialog():(this.a8.D3a(),this.a8.ySb(re,Df));return 32};this.lhg=(re,ff,ah,aj,Df)=>{if(!this.kGf)return m.ULS.sendTraceTag(512288601,802,50,"Web add-in insert blocked by doc IRM"),16;if(!Df)return 8;if(0===Df.targetType)return this.uzj(Df,re);if(1===Df.targetType){if(this.Af.Zc(this.Yb.yf))return 16;this.f2j?Df.isAddinCommands?gd.a("AddinCommandsActionTypeUndefinedCheck")?
void 0===Df.addinCommandsActionType||null===Df.addinCommandsActionType||0===Df.addinCommandsActionType?this.LIb(Df):1===Df.addinCommandsActionType?this.xQc(Df):m.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+Df.addinCommandsActionType.toString()):0===Df.addinCommandsActionType?this.LIb(Df):1===Df.addinCommandsActionType&&this.xQc(Df):(re={},this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?(re.solutionId=
Df.solutionId,re.version=Df.version):(re.marketplaceId=Df.solutionId,re.marketplaceVersion=Df.version),re.storeType=Df.storeType,re.storeId=Df.storeId,re.targetData=Df,this.qe.yn.isAddinCommandsAsync(re,(Fi,We,wi)=>{We?this.LIb(wi.targetData):this.xQc(wi.targetData);Fi||(Fi=wi.targetData,m.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Fi.solutionId,Fi.storeType,Fi.assetId,null,null,Fi.storeId),Fi.storeType))})):this.xQc(Df);
lk.a.add(Df.solutionId,Df.targetType,Df.storeId,Df.storeType,Df.version);return 32}return 8};this.la=t;this.A8=this.la.pptEditInsertAppsForOfficeEnabled;this.f2j=this.la.Rra;this.gv=N;this.ia=ha;this.Yb=Aa;this.ta=Ra;this.X_c=Sb;this.Db=yb;this.a8=uc;this.Xd=Zc;this.Mb=ed;this.Af=Gd;this.gl=ze}get kGf(){return this.A8&&v.AFrameworkApplication.ypa}ub(){this.ia.pa(tb.a.Amg,sb.a.application,this.khg,516);this.ia.pa(tb.a.kQc,sb.a.application,this.lhg,4);this.ia.xa(tb.a.fPc,sb.a.application,Object(n.a)(this,
this.ylj,"handleHideAppForOfficeTaskPane"));this.ia.pa(tb.a.teb,sb.a.application,Object(n.a)(this,this.moj,"handleRenderAppForOfficeTaskPane"),4);this.ia.pa(tb.a.GWa,sb.a.application,Object(n.a)(this,this.GWa,"queryEntitledAppsForOffice"),96);this.ia.xa(tb.a.sIa,sb.a.application,Object(n.a)(this,this.fig,"handleShowFirstPartyTaskPane"));this.ia.xa(tb.a.iDc,sb.a.application,Object(n.a)(this,this.hkj,"handleCloseAppsForOfficeTaskPane"));this.ia.xa(G.a.obl,sb.a.application,Object(n.a)(this,this.Woj,
"handleShowExtensionTaskPane"));this.ia.xa(G.a.Wni,sb.a.application,Object(n.a)(this,this.ikj,"handleCloseExtensionTaskPane"));this.ia.xa(G.a.CUk,sb.a.application,Object(n.a)(this,this.woj,"handleRestartExtensionTaskPane"));this.ia.xa(tb.a.wAh,sb.a.application,Object(n.a)(this,this.Jpj,"handleUpdateBackgroundAppData"));gd.a("EnabledTellMeAddinOnPPTO")&&(this.ia.pa(G.a.Lmg,sb.a.application,this.lhg,4),this.ia.pa(G.a.nzg,sb.a.application,this.khg,4))}we(){}get qe(){return this.Xd.instance}Woj(t,N,ha,
Aa,Ra){if(2!==ha)return 32;const yb=Ra[kk.$Td];Ra=Ra[kk.Pwe];const Sb={};Sb.fU=Ra.optionalProperties[Rg.fU];Sb.assetId=yb.getId();Sb.cva=Ra.optionalProperties[Rg.cva];Sb.nonPersistedSettings=Ra.$Vf;Sb.Anc=!0;return this.fig(t,N,ha,Aa,Sb)}ikj(t,N,ha,Aa,Ra){if(2!==ha)return 32;t=Ra[kk.$Td];Ra=Ra[kk.Pwe];N={};N.fU=Ra.optionalProperties[Rg.fU];N.assetId=t.getId();N.sourceLocationOverrideResourceId=Ra.optionalProperties[Rg.sourceLocationOverrideResourceId];N.cva=Ra.optionalProperties[Rg.cva];N.nonPersistedSettings=
Ra.$Vf;N.Anc=!0;Ra=this.qe.OZb(N);return(Ra=this.qe.fZ(Ra))&&this.qe.vMd(Ra.instanceId)?32:8}woj(t,N,ha,Aa,Ra){if(2!==ha)return 32;t=Ra[kk.$Td];N=Ra[kk.Pwe];Ra={};Ra.fU=N.optionalProperties[Rg.fU];Ra.assetId=t.getId();Ra.sourceLocationOverrideResourceId=N.optionalProperties[Rg.sourceLocationOverrideResourceId];Ra.cva=N.optionalProperties[Rg.cva];Ra.nonPersistedSettings=N.$Vf;Ra.Anc=!0;t=this.qe.OZb(Ra);return(t=this.qe.fZ(t))?(this.qe.Kah(t.instanceId,Ra),32):8}ylj(t,N,ha,Aa,Ra){if(!this.A8)return 16;
if(!Ra)return 8;if(1===ha)return 32;t=Object(M.a)(String,Ra);if(!t||!t.length)return 8;if((N=this.qe.qVd(t))&&N.taskpane){if(this.qe.bsa(t))return this.qe.NFb(t,!1),32;if(N.Zm&&OSF.OsfControl.isFirstPartyStoreString(N.Zm.storeType))return this.qe.MRd(t),this.qe.FEk(t),32;N=N.taskpane.ownerAddinSolutionId;if(this.qe.uBj(t)||N)this.qe.MRd(t);else if(N=this.qe.tKc(),ha=this.Mb.Kc(N),t=this.qe.d3f(t)){ha.Ak(Object(M.a)(yk.a,t));t=this.Db.rd(4,void 0,void 0,void 0,!0);try{t.jc(N),ha.Ii()}finally{t&&t.dispose()}}}return 32}moj(t,
N,ha,Aa,Ra){if(!this.A8)return 16;if(!Ra)return 8;if(1===ha)return 32;N=Object(M.a)(String,Ra);if(!N||!N.length)return 8;this.qe?this.qe.teb(N):this.a8.ySb(t,Ra);return 32}fig(t,N,ha,Aa,Ra){if(!this.A8)return 16;if(!Ra)return 8;if(1===ha)return 32;if(this.qe){if(!Ra||!Ra.assetId||!v.AFrameworkApplication.x$d(Ra.assetId))return 8;Ra.nonPersistedSettings||(Ra.nonPersistedSettings={});Ra.nonPersistedSettings.ShowFeedback=v.AFrameworkApplication.aE;!this.vig&&this.IAc&&(this.vig=!0,t=window.performance.now()-
this.IAc,m.ULS.sendTraceTag(512288597,220,50,"Apps for office load time {0}",t));t=this.qe.OZb(Ra);if(t=this.qe.fZ(t))return this.qe.Kah(t.instanceId,Ra),32;this.qe.kRk(Ra)}else this.IAc||(this.IAc=window.performance.now()),this.a8.D3a(),this.a8.ySb(t,Ra);return 32}Jpj(t,N,ha,Aa,Ra){if(1===ha)return this.A8?32:8;if(!this.A8)return 16;if(!(Ra&&Ra.Hu&&-1!==Ra.Hu.state&&Ra.Hu.uma&&this.qe))return 8;t=this.qe.mBa(Ra.Zm.id);if(!t)return 8;N=this.Db.rd(4,void 0,void 0,void 0,!0);try{N.jc(t),t.setValue(Xb.a.Gnb,
Ra.Hu.state),t.setValue(Xb.a.d3a,Ra.Hu.uma),t.setValue(qn.a.iTb,Ra.Zm.storeType)}finally{N&&N.dispose()}return 32}hkj(t,N,ha,Aa,Ra){return this.A8?Ra?1===ha?32:this.qe&&Ra&&Ra.length?this.qe.vMd(Ra)?32:8:8:8:16}GWa(t,N,ha,Aa,Ra){var yb;if(2===ha){N=Ra.callback;if(!N)return 16;gd.a("AllowQueryAddinsForStoreTypes")?this.qe?this.wCk(N,null!==(yb=Ra.storeType)&&void 0!==yb?yb:OSF.StoreTypeEnum.MarketPlace):(Ra=Object.assign({},Ra),this.a8.ySb(t,Ra)):this.vCk(N)}return 32}wCk(t,N){const ha=new mg.a;ha.callbackFunc=
t;ha.storeType=N;ha.fromInsertDialog=!1;ha.refresh="true"===Ea.a.instance.getItem(Dj.a.KGd);this.qe.yn.queryEntitlementDetails(ha)}vCk(t){const N=new mg.a;N.callbackFunc=t;N.storeType=OSF.StoreTypeEnum.MarketPlace;N.fromInsertDialog=!1;N.refresh="true"===Ea.a.instance.getItem(Dj.a.KGd);this.qe.yn.queryEntitlementDetails(N)}LIb(t){const N=new D.a;N.add(t);t={};t[Dj.a.Uzc]=N;t[Dj.a.u6]=3;this.ia.Ka(G.a.ZUc,2,t)}uzj(t,N){const ha=this.ta.Ba;if(!ha||this.Af.Zc(ha))return 16;if(!this.gl.lI(ha,1))return this.gl.kJ(ha),
16;try{return this.Nmg(t,ha,ha.Bb,N)}catch(Aa){return 8}}Nmg(t,N,ha,Aa){ha=N.Qyi(t.width,t.height,N.Qu()+1);Xi.a.nBf(ha,t,this.qe);this.gv.Z1([Object(M.a)(4,ha)],N,Aa);lk.a.add(t.solutionId,t.targetType,t.storeId,t.storeType,t.version);return 32}xQc(t){if(!this.qe.fZ(t.solutionId)){var N=this.qe.mBa(t.solutionId),ha=this.qe.tKc();if(N){ha=new Al.a(N);if(!ha.visibility){let Aa=this.Db.rd(4,void 0,void 0,void 0,!0);try{Aa.jc(N),N.setValue(qn.a.kTb,!0),N.setValue(qn.a.iTb,t.storeType)}finally{Aa&&Aa.dispose()}}this.qe.teb(ha.id)}else{N=
Xi.a.wvi(this.X_c.value,t,this.qe);t=this.Db.rd(4,void 0,void 0,void 0,!0);try{t.jc(ha),Xi.a.nZh(ha,N)}finally{t&&t.dispose()}}}}}Object(h.a)(Yi,"AppForOfficeActor",null,[244]);var mk=d(85),km=d(166),zk=d(41),ya=d(989);class sn{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff,ah,aj,Df,Fi,We,wi,Mn,Bn,dn,Uo,Ao,pp){this.y7b=null;this.ECg=!1;this.JTa=null;this.MFg=gd.a("PartialDoc.SkipCutCopyCallout");if(!pp)throw Error.argumentNull("calloutNotificationAdapter");this.ia=t;this.Af=N;this.Fa=ha;this.ra=
Aa;this.Ms=Ra;this.GD=yb;this.hOg=Sb;this.z1j=uc;this.F6j=Zc;this.iXc=ed;this.Nb=Gd;this.lHg=Fi.ekg;this.ou=ze;this.yc=wi;this.CYj=Fi.powerPointEditorDownloadACopyUiIsEnabled;this.g6j=re;this.NXc=ff;this.Xa=Df;this.LUa=!Fi.vg;this.bNg=Mn;this.OOg=dn;this.GJg=Uo;this.Wv=Ao;this.AEg=!Fi.printingEnabled||We.ka("DisablePrint");this.BEg=ah;this.ql=aj;this.P_j=We.Ha("DownloadPdfFromPodsUrl");this.m_printUrl=We.Ha("PrintPdfFromPodsUrl");this.O_j=We.Ha("DownloadOdpFromPodsUrl");this.MEg=We.Ha("DownloadImagesFromPodsUrl");
this.b7j=We.ka("UseToastForDeferredBlobsEnabled");this.V7j=Fi.pptAppendFileNameToQueryUrlForDocumentOperationsActor;t=(v.AFrameworkApplication.fileName||"").toLowerCase();Fi.vg&&Fi.OEj?(this.ECg=!0,this.y7b=We.Ha("DownloadACopyPodsUrl")):!Fi.vg&&Fi.MLj&&(t.endsWith(".pptx")||t.endsWith(".ppsx"))?this.y7b=this.Z$j():this.y7b=v.AFrameworkApplication.DOa;this.jje=Bn;this.d3j=Fi.LSc;this.sua=u.a.instance.La("Common.ISystemInitiatedFeedback");this.q2j=We.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1);this.eQ=pp}ub(){const t=!!this.BEg&&!this.bNg();L.a.J(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",this.AEg,t);this.AEg?t&&this.ql.Pbl(this.BEg):(this.ia.xa(tb.a.print,sb.a.application,Object(n.a)(this,this.wnj,"handlePrint")),this.ia.xa(tb.a.downloadACopy,sb.a.application,Object(n.a)(this,this.downloadACopy,"downloadACopy")),this.ia.xa(tb.a.bHc,sb.a.application,Object(n.a)(this,this.bHc,"downloadACopyAsPdf")),this.ia.xa(tb.a.aHc,sb.a.application,Object(n.a)(this,this.aHc,
"downloadACopyAsOdp")),this.ia.xa(tb.a.cHc,sb.a.application,Object(n.a)(this,this.cHc,"downloadAsImages")),this.ia.xa(tb.a.mGe,sb.a.application,Object(n.a)(this,this.mGe,"saveSlidesAsImages")),this.ia.xa(tb.a.v$c,sb.a.application,Object(n.a)(this,this.Nyk,"pptoSaveACopy")),this.ia.xa(tb.a.r5g,sb.a.application,Object(n.a)(this,this.Oyk,"pptoSaveAsToHost")),this.ia.xa(tb.a.s5g,sb.a.application,Object(n.a)(this,this.Pyk,"pptoSaveToSharePoint")),this.ia.xa(tb.a.B6g,sb.a.application,Object(n.a)(this,this.ynj,
"handlePrintNotes")),this.ia.xa(tb.a.A6g,sb.a.application,Object(n.a)(this,this.xnj,"handlePrintHandouts")));this.ia.xa(G.a.wXa,sb.a.application,Object(n.a)(this,this.wXa,"saveFileChange"));this.hOg&&this.ia.pa(tb.a.Iad,sb.a.application,Object(n.a)(this,this.Iad,"querySaveStatus"),96);this.jje.execute(Object(n.a)(this,this.$cc,"onHostPostmessengerCreated"))}we(){const t=this.Fa.Bc(mb.a.sfi);t.bindAction(ob.KeyInputManager.Na(qa.a.cib,ob.KeyInputManager.Fe),tb.a.print);t.bindAction(ob.KeyInputManager.Na(qa.a.LJa,
ob.KeyInputManager.Fe),G.a.ze);t.bindAction(ob.KeyInputManager.Na(qa.a.ind,ob.KeyInputManager.Fe),G.a.ze);t.bindAction(ob.KeyInputManager.Na(qa.a.H0,ob.KeyInputManager.Fe),G.a.ze);t.bindAction(ob.KeyInputManager.Na(qa.a.H0,ob.KeyInputManager.Fe|4),G.a.ze)}Oyk(t,N,ha){return this.fGe(ha,G.a.iFb,"SaveAsToHost")}Nyk(t,N,ha){return this.fGe(ha,G.a.Qic,"SaveACopy")}Pyk(t,N,ha){return this.fGe(ha,G.a.Ueb,"SaveToSharePoint")}fGe(t,N,ha){return 1===t?v.AFrameworkApplication.XI||v.AFrameworkApplication.UP?
8:this.ia.processAction(N,1):this.Wv.hasDeferredContent()&&(L.a.J(512500628,843,15,"{0} is triggered while document has deferred content",ha),!this.b7j)?(this.Wv.fLe(ha,null,null),8):this.Xa.aca?(L.a.J(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",N),this.ia.Ka(tb.a.kFb,2,N)):this.ia.processAction(N,2)}downloadACopy(t,N,ha,Aa,Ra){if(this.Af.Zc(this.Ms))return 16;if(1===ha)return!this.yc.Nj()||v.AFrameworkApplication.UP?8:sn.m1f()?32:this.Lob();if(this.Wv.hasDeferredContent())return L.a.J(512500626,
843,15,"DownloadACopy is triggered while document has deferred content"),this.MFg&&this.eQ.xRd(),this.Wv.fLe("DownloadACopy",new ya.a,()=>{this.HQe(Ra)}),this.Wv.npa("DownloadACopyRequestedTime",zk.a.Ye(new Date)),8;this.ra.Ph();this.Fa.Ad();L.a.J(512500625,801,50,"PPT save and download a copy");this.Xa.aca?this.HQe(Ra):(this.ou.show(!0,t),this.GD.f2(!1,this.LUa,()=>{this.HQe(Ra)},Object(n.a)(this,this.Xva,"saveFailureCallback")));return 32}HQe(t){this.ou.hide();let N;N=sn.m1f()?v.AFrameworkApplication.DOa:
this.ECg?this.lnb(this.y7b):this.y7b;t&&t.FileDownloadUrl&&(N=t.FileDownloadUrl.toString());this.BVj();this.GJg&&!this.GJg()&&this.OOg&&this.OOg("3555692408")?this.JTa.sendMessage(ce.a.download,{}):this.CYj?(this.g6j.xcl(N),this.Wv.npa("DownloadModalTime",zk.a.Ye(new Date))):this.Nb.YN(!0,N,!0)}BVj(){this.q2j&&this.sua&&this.sua.execute(t=>{t.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}Iad(t,N,ha,Aa,Ra){t="";this.hOg&&(t=this.z1j.KV(this.Ms)?
String.format(ResourceStrings.L_SavingStatus):this.lHg?String.format(CommonUIStrings.l_SavedToStatus,this.lHg):String.format(ResourceStrings.L_SavedStatus));Ra[si.a.Value]=t;return 32}wnj(t,N,ha){return this.yze(ha,0,t)}ynj(t,N,ha){return this.yze(ha,8,t)}xnj(t,N,ha){return this.yze(ha,4,t)}yze(t,N,ha){if(this.Af.Zc(this.Ms))return 16;if(1===t)return!this.yc.Nj()||v.AFrameworkApplication.UP?8:this.Lob();if(this.bNg())return L.a.J(512500624,328,50,"Printing not allowed for IRM protected documents"),
16;L.a.J(512500623,328,50,"PPT Editor print. PublishOption: {0}",N);this.ra.Ph();this.Fa.Ad();this.Xa.aca?this.Lhh(N):(this.ou.show(!0,ha),this.GD.f2(!1,this.LUa,()=>{this.Lhh(N)},Object(n.a)(this,this.Xva,"saveFailureCallback")));return 32}Lhh(t){this.ou.hide();this.F6j.print(this.Xa.presentationId.string,this.lnb(this.m_printUrl),t)}bHc(t,N,ha){if(this.Af.Zc(this.Ms))return 16;if(1===ha)return!this.yc.Nj()||v.AFrameworkApplication.UP?8:this.Lob();this.NXc.TXf=new Date;this.ra.Ph();this.Fa.Ad();
this.Xa.aca?this.Ihh():(this.ou.show(!0,t),this.GD.f2(!1,this.LUa,()=>{this.Ihh()},Object(n.a)(this,this.Xva,"saveFailureCallback")));return 32}Ihh(){this.ou.hide();this.NXc.Qhh=new Date;this.iXc.convert(this.Xa.presentationId.string,1,this.lnb(this.P_j))}cHc(t,N,ha){if(this.Af.Zc(this.Ms))return 16;if(1===ha)return!this.yc.Nj()||v.AFrameworkApplication.UP?8:this.Lob();this.ra.Ph();this.Fa.Ad();this.Xa.aca?this.Jhh():(this.ou.show(!0,t),this.GD.f2(!1,this.LUa,()=>{this.Jhh()},Object(n.a)(this,this.Xva,
"saveFailureCallback")));return 32}mGe(t,N,ha){if(this.Af.Zc(this.Ms))return 16;if(1===ha)return!this.yc.Nj()||v.AFrameworkApplication.UP?8:this.Lob();this.ra.Ph();this.Fa.Ad();this.Xa.aca?this.SXf():(this.ou.show(!0,t),this.GD.f2(!1,this.LUa,()=>{this.SXf()},Object(n.a)(this,this.Xva,"saveFailureCallback")));return 32}Jhh(){this.ou.hide();this.iXc.convert(this.Xa.presentationId.string,2,this.lnb(this.MEg))}SXf(){this.ou.hide();var t=this.lnb(this.MEg),N=this.ra.mf();0<N.length&&(N=km.c(N,ha=>ha.sid.toString()).join(","),
t=new Lh.QueryStringBuilder(t),t.Hi(mk.a.fel,N),this.iXc.convert(this.Xa.presentationId.string,2,t.toString()))}aHc(t,N,ha){if(this.Af.Zc(this.Ms))return 16;if(1===ha)return!this.yc.Nj()||v.AFrameworkApplication.UP?8:this.Lob();if(this.Wv.hasDeferredContent())return this.MFg&&this.eQ.xRd(),L.a.J(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.Wv.fLe("DownloadACopyAsOdp",new ya.a,()=>{this.gGe()}),8;this.ra.Ph();this.Fa.Ad();this.Xa.aca?this.gGe():(this.ou.show(!0,
t),this.GD.f2(!1,this.LUa,()=>{this.gGe()},Object(n.a)(this,this.Xva,"saveFailureCallback")));return 32}Xva(){this.ou.hide();return!1}gGe(){this.ou.hide();this.iXc.convert(this.Xa.presentationId.string,0,this.lnb(this.O_j))}wXa(t,N,ha,Aa,Ra){if(this.Af.Zc(this.Ms))return 16;if(1===ha)return 32;this.ra.Ph();this.Fa.Ad();this.GD.f2(!1,!0,yb=>{if(Ra&&1<=Ra.length)Ra[0](yb)},yb=>Ra&&2<=Ra.length?(Ra[1](yb,yb.ServerError.Code),!0):!1);return 32}Z$j(){const t=new Lh.QueryStringBuilder(jb.a.wBa("DownloadACopyHandler.ashx"));
t.Hi(mk.a.e9c,this.Xa.presentationId.string);t.Hi(mk.a.Jla,this.Xa.sessionInfo);t.Hi("fn",v.AFrameworkApplication.fileName);v.AFrameworkApplication.HMa(t);return t.toString()}lnb(t){if(t){const N=new Lh.QueryStringBuilder(t);this.Xa&&this.Xa.podSessionId&&0>t.indexOf(this.Xa.podSessionId)&&(N.$yc(mk.a.H9+"="+this.Xa.podSessionId),L.a.J(512500620,801,50,"Append PodSessionId in url: {0}",this.Xa.podSessionId));this.V7j&&v.AFrameworkApplication.fu.ux&&0<v.AFrameworkApplication.fu.ux.length&&(N.Hi(mk.a.T2g,
v.AFrameworkApplication.fu.ux),L.a.J(512500619,801,50,"Appended FileName in url"));this.d3j&&(N.Hi(mk.a.usk,"true"),L.a.J(512500618,801,50,"Appended IsPasswordProtectedFile param"));v.AFrameworkApplication.HMa(N);return N.toString()}return null}$cc(t){this.JTa=t}Lob(){return v.AFrameworkApplication.XI?8:32}static m1f(){const t=v.AFrameworkApplication.XI,N=!gb.a.Va(v.AFrameworkApplication.DOa),ha=v.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring"),Aa=v.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled");
L.a.J(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",t,N,ha,Aa);return t&&N&&ha&&Aa}}Object(h.a)(sn,"DocumentOperationsActor",null,[244]);class Sj{}Sj.jg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(h.a)(Sj,"EmbedDialogHtml",null,[]);class Jl{constructor(t,N,ha,Aa){this.Owe=
t;this.D2=N;this.Q1g=ha;this.value=Aa}}Object(h.a)(Jl,"OptionInfo",null,[]);class Se{constructor(t,N,ha){this.BGe=t;this.xtb=N;this.D2=ha}}Object(h.a)(Se,"SectionInfo",null,[]);var Te=d(283);class fc extends fd.a{constructor(t,N=!1){super(!1,!1,N);this.C0e=476;this.Pqc=288;this.dKh=798;this.oSh=476;this.mSh=288;this.f9c={};this.AXa=[];this.FO=this.Fya=this.uyd=this.Cqc=this.Ouc=this.$kb=null;this.aMb=v.AFrameworkApplication.ptb;this.svc=t;this.syd=Object(n.a)(this,this.Jqk,"optionClickHandler");this.tyd=
Object(n.a)(this,this.Kqk,"optionKeyHandler");this.tod=Object(n.a)(this,this.z$h,"arrowClickHandler");this.vib=Object(n.a)(this,this.A$h,"arrowKeyHandler");this.Dxc=Object(n.a)(this,this.Zkl,"textAreaOnFocusHandler");this.rOh=N;this.jg=Sj.jg;this.vd=0;this.kg="EmbedDialog"}get Tjb(){return this.Pqc}set Tjb(t){this.Pqc=t}yqh(t){const N={["id"]:this.kg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,
["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:jb.a.ej(this.svc,"wdPreview","1"),["initialEmbedUrl"]:this.aMb,["getEmbedCode"]:fc.b9f,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const ha of Object.keys(t))N[ha]=t[ha];this.vd=1;this.Re(1,CommonUIStrings.l_CopyAction);this.Re(0,CommonUIStrings.l_Close);this.pj(CommonUIStrings.l_Embed,null,N)}ZGb(){if(this.rOh)this.yqh({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.$kb=document.getElementById("embedpreviewpane");
this.Ouc=document.getElementById("embedoptionpane");this.$kb.style.width=String.format("{0}px",this.oSh);this.Fya=document.createElement("iframe");this.Fya.className=fc.lSh;this.Fya.frameBorder="0";this.Fya.style.height=String.format("{0}px",this.mSh);this.Fya.tabIndex=-1;this.$kb.appendChild(this.fFc(CommonUIStrings.l_Preview,this.Fya,fc.Wpf,fc.nSh,fc.Wpf,!0));this.FO=document.createElement("textarea");this.FO.className=fc.KKh;Sys.UI.DomElement.addCssClass(this.FO,Te.a.Gza);this.FO.id=fc.LKh;Pc.a.Ki||
(this.FO.readOnly=!0);this.FO.rows=4;this.FO.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.FO.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.FO.setAttribute(na.a.y6,String.format("{0} {1}",fc.B0e,fc.A0e));this.$kb.appendChild(this.fFc(CommonUIStrings.l_EmbedCode,this.FO,fc.B0e));bd.a.addHandler(this.FO,"focus",this.Dxc);var t=document.createElement("span");t.className=fc.HLh;t.innerText=CommonUIStrings.l_CopyText;t.id=fc.A0e;this.$kb.appendChild(t);this.Cqc=document.createElement("div");
this.Cqc.className=fc.gKh;this.Ouc.appendChild(this.fFc(CommonUIStrings.l_Dimensions,this.Cqc));this.uyd=document.createElement("div");this.Ouc.appendChild(this.Wvi(fc.rRh,this.uyd));this.vd=0;this.Re(1,CommonUIStrings.l_Close);this.TAh();this.OBh();Pc.a.Ki||this.FO.focus()}}dispose(){if(this.f9c){var t=this.f9c;for(let N in t){const ha=t[N];this.Vm.xb(ka.a.click,ha.Owe,this.syd);this.Ig.xb(ka.a.eg,ha.Owe,this.tyd);this.Ig.xb(ka.a.ol,ha.Owe,this.tyd)}this.tyd=this.syd=this.f9c=null}if(this.AXa){for(t=
0;t<this.AXa.length;++t)this.Vm.xb(ka.a.click,this.AXa[t].xtb,this.tod),this.Ig.xb(ka.a.eg,this.AXa[t].xtb,this.vib),this.Ig.xb(ka.a.Cx,this.AXa[t].xtb,this.vib),this.Ig.xb(ka.a.ol,this.AXa[t].xtb,this.vib);this.Ig=this.tod=this.AXa=null}this.Dxc&&this.FO&&(bd.a.removeHandler(this.FO,"focus",this.Dxc),this.Dxc=null);this.FO=this.Fya=this.uyd=this.Cqc=this.Ouc=this.$kb=null;super.dispose()}Tla(){super.Tla();this.pc.style.width=String.format("{0}px",this.dKh);this.EUb()}UAh(t,N){const ha=jb.a.ej(this.aMb,
t,N);return this.aMb!==ha?(this.aMb=ha,this.svc=jb.a.ej(this.svc,t,N),!0):!1}TAh(){this.FO&&(this.FO.innerText=fc.b9f(this.aMb,this.C0e,this.Pqc))}OBh(){this.Fya&&this.Fya.contentWindow.location.replace(jb.a.ej(this.svc,"wdPreview","1"))}bul(t,N){this.UAh(t,N)&&(this.TAh(),this.OBh())}fFc(t,N,ha=null,Aa=null,Ra=null,yb=!1){const Sb=document.createElement("div");Sb.className=fc.dUh;Aa&&(Sb.id=Aa);Ra&&Sb.setAttribute(na.a.y6,Ra);yb&&(Sb.tabIndex=0);Aa=document.createElement("span");Aa.className=fc.eUh;
Aa.innerText=t;ha&&(Aa.id=ha);Sb.appendChild(Aa);Sb.appendChild(N);return Sb}Wvi(t,N){const ha=this.fFc(CommonUIStrings.l_Interaction,N),Aa=this.Xh.createElement("div");Aa.className=fc.qHh;Aa.id=fc.sHh+t;Aa.setAttribute(na.a.We,na.a.Xt);Aa.tabIndex=0;ha.insertBefore(Aa,N);t=Ga.createClusteredImage(16,16,fc.rHh,fc.tHh,!0,"");Aa.appendChild(t);t=t.childNodes[0];t.className=Ga.getImageClass(fc.d0e);t.title=CommonUIStrings.l_Expand;Aa.title=CommonUIStrings.l_Expand;N.style.visibility="hidden";N=new Se(N,
Aa,t);Array.add(this.AXa,N);this.Vm.GT(ka.a.click,Aa,this.tod,N);this.Ig.GT(ka.a.eg,Aa,this.vib,N);this.Ig.GT(ka.a.Cx,Aa,this.vib,N);this.Ig.GT(ka.a.ol,Aa,this.vib,N);return ha}z$h(t){this.WLf(t);return!0}A$h(t){return this.CUc(t,Object(n.a)(this,this.WLf,"changeArrowState"))}WLf(t){t=t.yC;"visible"===t.BGe.style.visibility?(t.BGe.style.visibility="hidden",t.D2.className=Ga.getImageClass(fc.d0e),t.D2.title=CommonUIStrings.l_Expand,t.xtb.title=CommonUIStrings.l_Expand):(t.BGe.style.visibility="visible",
t.D2.className=Ga.getImageClass(fc.zXh),t.D2.title=CommonUIStrings.l_Collapse,t.xtb.title=CommonUIStrings.l_Collapse)}Jqk(t){this.P1g(t);return!0}Kqk(t){return this.CUc(t,Object(n.a)(this,this.P1g,"optionHandler"))}P1g(t){const N=this.f9c[t.yC.toString()];N.value?(N.value=0,N.D2.className=Ga.getImageClass(fc.kXh),N.Q1g.setAttribute(na.a.nGf,na.a.Bpa)):(N.value=1,N.D2.className=Ga.getImageClass(fc.wIh),N.Q1g.setAttribute(na.a.nGf,na.a.vB));this.bul(t.yC.toString(),N.value.toString())}Zkl(){this.FO.select()}static b9f(t,
N,ha){if(!fc.Fxd){const Aa=String.format('<a target="_blank" href="{0}">{1}</a>',gb.a.a2b("https://office.com"),CommonUIStrings.l_Office),Ra=String.format('<a target="_blank" href="{0}">{1}</a>',gb.a.a2b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);fc.Fxd=String.format(CommonUIStrings.l_NoFrames,Aa,Ra)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',gb.a.a2b(t),N,ha,fc.Fxd)}}fc.Fxd=null;fc.wIh="CheckboxChecked_16x16x32";fc.kXh="CheckboxUnchecked_16x16x32";
fc.zXh="OutlookSearchChevronUp_16x16x32";fc.d0e="OutlookSearchChevronDown_16x16x32";fc.rHh="UpArrowServer";fc.dUh="EmbedSectionHeader";fc.eUh="EmbedSectionName UIFontBold";fc.HLh="EmbedCodeFooter";fc.lSh="EmbedPreviewFrame";fc.KKh="EmbedCodeTextArea";fc.gKh="EmbedDimensionSection";fc.tHh="EmbedArrowIcon";fc.qHh="WACGlyph EmbedArrowHolder";fc.LKh="EmbedCode";fc.B0e="EmbedCodeHeader";fc.Wpf="Preview";fc.nSh="PreviewHeader";fc.rRh="Options";fc.sHh="Arrow";fc.A0e="EmbedCodeFooter";Object(h.a)(fc,"EmbedDialog",
fd.a,[]);class lm extends fc{constructor(t,N){super(t,!0);N&&N&&!isNaN(N)||L.a.J(539762772,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.UAh(mk.a.lsk,N.toString())}ZGb(){const t=[];t.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:lm.DHk});this.yqh({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.C0e,["defaultHeight"]:this.Pqc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,
["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:t})}static DHk(t,N,ha){return"wdEaaCheck"===N?jb.a.ej(t,N,ha?"1":"0"):t}}Object(h.a)(lm,"ReactEmbedDialog",fc,[]);class Mc{constructor(t,N,ha,Aa,Ra){this.QDa=null;this.Gge=!1;this.JTa=null;this.Nb=t;this.Oie=N;this.G7b=ha;this.jje=Aa;this.Xa=Ra}ZGb(t,N,ha){(t=(t=v.AFrameworkApplication.bO)||this.Xa.aca)||this.Gge||(t=!this.Ixh());return 1===ha?t?2:32:this.jbl()}jbl(){if(!this.Gge)return 8;if(v.AFrameworkApplication.ptb&&this.G7b)this.Nph();
else{const t=v.AFrameworkApplication.wTe?this.JTa.sendMessage(ce.a.gQi,null)?32:8:2;return 32!==t?this.Nb.YN(!0,v.AFrameworkApplication.KUd):t}return 32}ibl(t){t.Values.HostEmbeddedViewUrl&&(this.G7b=v.AFrameworkApplication.ptb=t.Values.HostEmbeddedViewUrl.toString(),this.Nph())}Ixh(){return!1}g_h(t,N){this.QDa=N;this.Gge=!!this.Nb&&!!this.Oie&&!(void 0===this.G7b||null===this.G7b)&&!!t&&!!N}Nph(){(new lm(this.G7b,this.QDa)).ZGb()}}Object(h.a)(Mc,"EmbedManager",null,[]);class uf{constructor(t,N,ha){this.QDa=
null;this.U0j={};for(N=0;N<t.length;N++)this.U0j[t[N].Format.toString()]=N;this.QDa=ha&&!isNaN(ha)&&isFinite(ha)?ha:0}}Object(h.a)(uf,"FormatPicker",null,[]);class mm extends Mc{constructor(t,N,ha,Aa,Ra,yb,Sb,uc){super(t,N,ha,yb,Sb,uc);this.ia=Aa;this.Sb=Ra}ub(){this.ia.xa(tb.a.ZGb,sb.a.application,Object(n.a)(this,this.ZGb,"showEmbedDialog"));this.jje.execute(Object(n.a)(this,this.$cc,"onHostPostmessengerCreated"))}we(){}Ixh(){var t=this.Sb.Jv();if(!this.Oie||!t.height)return!1;t=t.width/t.height;
const N=new uf(this.Oie,!1,t);this.g_h(N,t);return!0}$cc(t){this.JTa=t;v.AFrameworkApplication.isEmbedded||v.AFrameworkApplication.ptb||!this.JTa||(this.JTa.Vt(ce.a.XKf),this.JTa.ZA(ce.a.XKf,Object(n.a)(this,this.ibl,"showEmbedDialogPostMessage")))}}Object(h.a)(mm,"EmbedActor",Mc,[244]);var Nf=d(38),Yg=d(714),Mk=d(665);class Fn{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze){this.ia=t;this.Cab=N?N.ya:null;this.ta=ha;this.Xb=Aa;this.nb=Ra;this.Mx=yb;this.Db=Sb;this.xm=uc;this.Kd=Zc;this.Dwb=null;this.Fa=
ed;this.Ms=ha.presentation;this.Ce=Gd;this.hg=null;this.lab=ze}ub(){this.ia.pa(tb.a.Tbl,Nf.a.application,Object(n.a)(this,this.Lpj,"handleUploadAudioDialog"),4)}we(){}Lpj(t,N,ha){N=this.ta.Ba;if(!N||this.Xb.Zc(N))return 16;if(1===ha)return 32;if(this.Cab){this.hg=zk.a.hm("Audio::Insert");try{return Mk.a.fMe("audio/*",Yg.b,()=>Yg.a(t,Object(n.a)(this,this.Wyj,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Ce),"audio",this.ta.presentation,this.Xb,this.Kd,this.hg,!1,this.lab,50,10,3),
this.hg&&this.hg.Wa("AudioDialogInitialized","true"),32}catch(Aa){L.a.J(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return L.a.J(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(t,N){this.hg&&(this.hg.finish(),this.hg=null);this.Kd.qG(t,ha=>{ha.xB=1;ha.ePa=N;return!1})}Wyj(t,N,ha,Aa,Ra,yb){Aa.QP(ha)&&L.a.J(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+ha.Wpa);Aa.vO(ha);Ra&&Ra.Wa("AudioUploadToRC","true");ha=this.ta.Ba;Aa=ha.Qu();var Sb=this.Ms.slideWidth,uc=this.Ms.slideHeight;const Zc=Kc.a.Ef(32,0),ed=Kc.a.Ef(32,1);Sb=Sb/2-Kc.a.Ef(16,0);uc=uc/2-Kc.a.Ef(16,1);if(ha&&ha.isConnected){var Gd=this.Db.rd(15,void 0,void 0,()=>{this.Mx.pI=this.Dwb;this.nb.selectShape(this.Dwb,!0);this.Fa.Ad()});try{Gd.jc(ha);Gd.$c=t;Ra&&Ra.Wa("CreatingAudioShape","true");this.Dwb=this.xm.j4a(!1,ha.Bb.cid,ha.Bb.sid,0,10,Sb,uc,Zc,ed,Aa+1);const ze=yb.files[0].name;
this.Dwb.FTb=N;this.Dwb.ETb=ze;ha.rB(this.Dwb)}finally{Gd&&Gd.dispose()}Ra&&(Ra.Wa("AudioShapeSuccessfullyCreated","true"),Ra.finish(),Ra=null)}}}Object(h.a)(Fn,"InsertAudioActor",null,[244]);class ba{constructor(){this.Ctb=this.fnb=null}}Object(h.a)(ba,"CreatePickerCustomizationDictionaryOptions",null,[1538]);var Bl=d(162),Kg=d(27);class Bf{}Bf.jg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(h.a)(Bf,"InsertMediaDialogHtml",null,[]);class Ej{}Ej.jg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(h.a)(Ej,"InsertMediaM365DialogHtml",null,[]);var rj=d(453);class dk{static get jg(){return fd.a.EB(dk.Zn,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,
"http://go.microsoft.com/fwlink/?linkid=2010177")}}dk.Zn="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(h.a)(dk,"InsertOnlineVideoDialogHtml",null,[]);class Qi extends fd.a{constructor(t){super();this.sC(1,!0);this.Re(1,ResourceStrings.L_Insert);this.jg=dk.jg;this.y8=t;this.EU=!1}O4(){this.width=50;this.pj(ResourceStrings.L_OnlineVideo,Object(n.a)(this,this.tzj,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(na.a.BId,na.a.q$h);const t=document.getElementById("url");this.sC(1,!!t&&0<t.value.length);
bd.a.addHandler(t,ka.a.input,Object(n.a)(this,this.Q7c,"onPatternChanged"));bd.a.addHandler(t,ka.a.change,Object(n.a)(this,this.Q7c,"onPatternChanged"));this.MQ(t)}hide(){const t=document.getElementById("url");t&&(bd.a.removeHandler(t,ka.a.input,Object(n.a)(this,this.Q7c,"onPatternChanged")),bd.a.removeHandler(t,ka.a.change,Object(n.a)(this,this.Q7c,"onPatternChanged")));super.hide()}tzj(t,N){if(1===t){if(N){var ha=zk.a.hm("InsertOnlineVideo",1);ha.Ar=!0;t=N.url.trim();(t=this.y8.lOi(t))?this.y8.gyg(t)&&
this.y8.XPj(t)?(L.a.J(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.y8.U8f(t)),this.y8.requestVideoData(t,Aa=>{zk.a.LE(ha,()=>{this.NX(Aa)})},Object(n.a)(this,this.nPi,"failCallback"))):(L.a.J(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.y8.U8f(t)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(L.a.J(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}NX(t){this.hide();
this.y8.Jpg(t)}nPi(t){this.fail(t,ResourceStrings.l_CannotInsertOnlineVideo)}fail(t,N){if(document.getElementById("labelmessage")){var ha=+new Date-+this.y8.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=N;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();t&&L.a.J(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:ha,["ResponseCode"]:t.data.af}))}else L.a.J(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}Q7c(){zk.a.W8a();const t=document.getElementById("url");this.sC(1,!!t&&0<t.value.length)}}Object(h.a)(Qi,"InsertOnlineVideoDialog",fd.a,[1042]);class sj{static get jg(){return fd.a.EB(sj.Zn,ResourceStrings.l_InsertCameoExpDialogContent,ResourceStrings.L_LearnMore,"https://aka.ms/pptocameoblog")}}sj.Zn="<div class='CameoExperimentTextDiv' id='cameoexperimenttextdiv'> <label id='cameoexperimenttext' class='WACDialogLabel' >{0}</label> </div> <div class='cameoexperimentlearnmorediv' id='CameoExperimentLearnMoreDiv'> <a id='cameoexperimentlearnmore' class='CameoExperimentLearnMore' href={2} target='newtab' >{1}</a> </div>";
Object(h.a)(sj,"InsertCameoDialogHtml",null,[]);class Nk extends fd.a{constructor(){super();this.sC(1,!0);this.jg=sj.jg;this.vd=0}O4(){this.width=50;this.pj(ResourceStrings.l_InsertCameoExpDialogTitle);const t=document.getElementById("cameoexperimentlearnmore");t&&(t.onclick=()=>L.a.J(520119896,352,50,"InsertCameoDialog::showAndFocus : Click on learn more of insert cameo"))}}Object(h.a)(Nk,"InsertCameoDialog",fd.a,[1041]);var Dm=d(1056),Kl=d(57);class tj{constructor(t,N,ha){this.vNb=qg.a.Jpa;this.KF=
null;this.Ca=t;this.wNb=N;this.fza=ha}get Ym(){return this.Ca}get z6(){return this.KF||(this.KF=u.a.instance.resolve("Common.Utils.IAriaNotifier"))}get wz(){return this.vNb}set wz(t){this.vNb=t}Qra(t){try{m.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",t.length);const N=this.wNb.tzk(t);let ha=2;if(N&&0<N.length){const Aa=new Dm.DictionaryPropertySet;Aa.setValue(Kl.a.zT,N);Aa.setValue(Kl.a.nSc,!0);if(this.fza){const Ra=this.fza.fNe();Ra.yAc("insertOnlineImage");
Aa.setValue(Kl.a.INa,Ra)}v.AFrameworkApplication.fa.ka("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.z6.sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0);ha=this.Ca.Ka(this.wz,2,Aa)}m.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",t.length,32===ha,""===N)}catch(N){m.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",N.toString())}}}
Object(h.a)(tj,"InsertOnlineImageHandler",null,[907]);class Le extends tj{constructor(t,N,ha=null){super(t,N,ha)}get tTf(){return ce.a.insertImage}get otb(){return ce.a.lzj}e3g(t){return this.wNb.ptk(t)}Bcg(t){return t.Type}WRc(t,N){return this.wNb.WRc(t.Type,N)}f3g(t){const N=[];if(t&&t.data&&t.data.value&&0<t.data.value.length)for(let Aa=0;Aa<t.data.value.length;Aa++)if(t.data.value[Aa]&&t.data.value[Aa].urls&&t.data.value[Aa].urls.download){var ha=t.data.value[Aa];ha=Object.assign(new de.a,{OriginalUrl:ha.urls.download,
Type:ha.extension||"",Caption:ha.name,ContentType:"",Height:ha.driveItem||ha.driveItem.image?ha.driveItem.image.height:0,Width:ha.driveItem||ha.driveItem.image?ha.driveItem.image.width:0});Array.add(N,ha)}N.length||m.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return N}k7g(t,N,ha){ha=ha(t);if(ha.length){t=[];for(let Aa=0;Aa<ha.length;Aa++){const Ra=ha[Aa],yb={};yb.Extension=Ra.Type;yb.SourceUrl=Ra.OriginalUrl;yb.SourceUrl=
Ra.OriginalUrl;yb.Width=Ra.Width;yb.Height=Ra.Height;Array.add(t,yb)}ha={};ha.Items=t;N.sendMessage(this.otb,ha)}}}Object(h.a)(Le,"InsertOnlineImageHelperBox4",tj,[906,907]);class $l extends Le{constructor(t,N,ha){super(t,N);this.Mqe=ha.insertOnlineVideoUrlPatterns;this.wz=tb.a.k6d}Qra(t){if(t&&0<t.length){var N=jb.a.TE(t[0].OriginalUrl);N=this.cae(N)?N:"unsupported";L.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",N);this.Ym.Ka(this.wz,2,t[0])}}cae(t){if(!t)return!1;
t=t.trim();for(const N of this.Mqe)if((new RegExp(N)).test(t))return!0;return!1}}Object(h.a)($l,"InsertOnlineVideoHelper",Le,[]);class Ke{static get jg(){return fd.a.EB(Ke.Zn,ResourceStrings.l_InsertSocialMediaDialogMsg)}}Ke.Zn="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(h.a)(Ke,"InsertSocailMediaDialogHtml",null,[]);var ee=
d(84),Ne=d(240);class O extends Sys.EventArgs{constructor(t,N,ha,Aa){super();this.slideId=t;this.LX=ha;this.shapeId=N;this.rCa=Aa}}Object(h.a)(O,"IconChangedEventArgs",Sys.EventArgs,[]);var ca=d(486),Ta=d(258);class xb{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff,ah,aj,Df,Fi,We,wi,Mn,Bn,dn,Uo,Ao,pp,Xj,Uk,Gi){this.u_c=this.URc=!1;this.hAb=this.Ple=null;this.la=t;this.ia=N;this.Xb=ha;this.ra=Aa;this.Fa=Ra;this.ta=yb;this.Db=Sb;this.vZc=uc;this.Y1j=Zc;this.uZc=ed;this.o3=Gd;this.x9a=ze;this.Nca=
re;this.XDa=ff;this.Sb=ah;this.xm=aj;this.Ea=Df;this.Qb=Fi;this.Mx=We;this.gl=wi;this.vab=Mn;this.QTa=Ao;this.rle=pp;this.Qc=Xj;this.$S=t.wDb;this.$b=Gi;this.vab&&(this.vab.p5a.removeAttribute("style"),this.vab.p5a.style.display="none");this.Pme=Bn;this.Z1j=dn;this.y8=Uo;this.X2=Uk;this.x9a.execute(Vo=>{Vo.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Bo=>L.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Bo)).then(Bo=>
{this.u_c=Bo;this.u_c||(this.Ple=Vo.deb("MsoPremiumStockImages",()=>{this.u_c=!0;L.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));return null})})}ub(){this.S_h();this.ia.pa(tb.a.tQc,Nf.a.application,Object(n.a)(this,this.oxl,"uploadIcon"),4);gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(tb.a.xCc,Nf.a.application,Object(n.a)(this,this.cki,"changeToIcon"),4):this.ia.pa(tb.a.xCc,Nf.a.application,Object(n.a)(this,this.dki,"changeToIcon"),4);this.ia.pa(tb.a.M7a,
Nf.a.application,Object(n.a)(this,this.Wld,"uploadOnlinePicture"),4);gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(tb.a.KUb,Nf.a.application,Object(n.a)(this,this.BCc,"changeToOnlinePicture"),4):this.ia.pa(tb.a.KUb,Nf.a.application,Object(n.a)(this,this.CCc,"changeToOnlinePicture"),4);this.ia.pa(tb.a.vQc,Nf.a.application,Object(n.a)(this,this.Wld,"uploadOnlinePicture"),4);gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(tb.a.vLd,Nf.a.application,Object(n.a)(this,this.BCc,"changeToOnlinePicture"),
4):this.ia.pa(tb.a.vLd,Nf.a.application,Object(n.a)(this,this.CCc,"changeToOnlinePicture"),4);this.ia.pa(tb.a.wQc,Nf.a.application,Object(n.a)(this,this.Wld,"uploadOnlinePicture"),4);gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(tb.a.JUb,Nf.a.application,Object(n.a)(this,this.BCc,"changeToOnlinePicture"),4):this.ia.pa(tb.a.JUb,Nf.a.application,Object(n.a)(this,this.CCc,"changeToOnlinePicture"),4);this.R_h();this.ia.pa(tb.a.Kmg,Nf.a.application,Object(n.a)(this,this.Wld,"uploadOnlinePicture"),
4);gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(tb.a.uLd,Nf.a.application,Object(n.a)(this,this.BCc,"changeToOnlinePicture"),4):this.ia.pa(tb.a.uLd,Nf.a.application,Object(n.a)(this,this.CCc,"changeToOnlinePicture"),4);this.T_h();this.Q_h();this.ia.pa(tb.a.k6d,Nf.a.application,Object(n.a)(this,this.rxl,"uploadOnlineVideo"),4);this.ia.pa(tb.a.h6d,Nf.a.application,Object(n.a)(this,this.qxl,"uploadOnlineHubbleVideo"),4);this.ia.pa(tb.a.h8g,sb.a.application,Object(n.a)(this,this.dul,"updateEntryPoints"),
96)}S_h(){this.ia.pa(tb.a.e6d,Nf.a.application,Object(n.a)(this,this.tIa,"showInsertMediaDialogFromM365"),4);this.ia.pa(tb.a.IUb,Nf.a.application,Object(n.a)(this,this.tIa,"showInsertMediaDialogFromM365"),4);this.ia.pa(tb.a.insertOnlinePicture,Nf.a.application,Object(n.a)(this,this.ELe,"showInsertPictureDialog"),4);this.ia.pa(tb.a.wLd,Nf.a.application,Object(n.a)(this,this.ELe,"showInsertPictureDialog"),4);gd.a("InsertSocialMediaVideoIcon")&&this.ia.pa(tb.a.Izj,Nf.a.application,Object(n.a)(this,this.Wbl,
"showInsertSocialMediaDialog"),4);gd.a("InsertDalleIcon")&&(this.ia.pa(tb.a.Dmg,Nf.a.application,Object(n.a)(this,this.tIa,"showInsertMediaDialogFromM365"),4),this.ia.pa(tb.a.Emg,Nf.a.application,Object(n.a)(this,this.tIa,"showInsertMediaDialogFromM365"),4));this.ia.pa(tb.a.uQc,Nf.a.application,Object(n.a)(this,this.tIa,"showInsertMediaDialogFromM365"),4);this.ia.pa(tb.a.yCc,Nf.a.application,Object(n.a)(this,this.tIa,"showInsertMediaDialogFromM365"),4);this.ia.pa(tb.a.j6d,Nf.a.application,Object(n.a)(this,
this.tIa,"showInsertMediaDialogFromM365"),4);this.ia.pa(tb.a.J2b,Nf.a.application,Object(n.a)(this,this.FLe,"showInsertPictureFromHostDialog"),4);this.ia.pa(tb.a.xLd,Nf.a.application,Object(n.a)(this,this.FLe,"showInsertPictureFromHostDialog"),4);this.la.ocpsIsEnabled&&(this.ia.jeb("ppt_insertOnlinePictures",tb.a.insertOnlinePicture,Nf.a.application,Object(n.a)(this,this.ELe,"showInsertPictureDialog"),t=>{Kg.App.Fb.qZa(t,Object(n.a)(this.X2,this.X2.CBa,"getCommandById"))}),this.ia.jeb("ppt_insertOnlinePictures",
tb.a.uQc,Nf.a.application,Object(n.a)(this,this.tIa,"showInsertMediaDialogFromM365"),t=>{Kg.App.Fb.qZa(t,Object(n.a)(this.X2,this.X2.CBa,"getCommandById"))}),this.ia.jeb("ppt_insertOnlinePictures",tb.a.j6d,Nf.a.application,Object(n.a)(this,this.tIa,"showInsertMediaDialogFromM365"),t=>{Kg.App.Fb.qZa(t,Object(n.a)(this.X2,this.X2.CBa,"getCommandById"))}),this.ia.jeb("ppt_insertOnlinePictures",tb.a.J2b,Nf.a.application,Object(n.a)(this,this.FLe,"showInsertPictureFromHostDialog"),t=>{Kg.App.Fb.qZa(t,
Object(n.a)(this.X2,this.X2.CBa,"getCommandById"))}))}R_h(){this.la.zQc&&this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)&&(this.ia.pa(tb.a.o6d,Nf.a.application,Object(n.a)(this,this.ihd,"showInsertPictureFromMobileDeviceDialog"),4),this.ia.pa(tb.a.zLd,Nf.a.application,Object(n.a)(this,this.ihd,"showInsertPictureFromMobileDeviceDialog"),4),this.la.ocpsIsEnabled&&(this.ia.jeb("mso_insertMobileDevicePictures",tb.a.o6d,Nf.a.application,Object(n.a)(this,
this.ihd,"showInsertPictureFromMobileDeviceDialog"),t=>{Kg.App.Fb.qZa(t,Object(n.a)(this.X2,this.X2.CBa,"getCommandById"))}),this.ia.jeb("mso_insertMobileDevicePictures",tb.a.zLd,Nf.a.application,Object(n.a)(this,this.ihd,"showInsertPictureFromMobileDeviceDialog"),t=>{Kg.App.Fb.qZa(t,Object(n.a)(this.X2,this.X2.CBa,"getCommandById"))})))}T_h(){this.ia.pa(tb.a.GCa,Nf.a.application,Object(n.a)(this,this.jhd,"showInsertVideoDialog"),4);this.la.ocpsIsEnabled&&this.ia.jeb("ppt_insertOnlineVideos",tb.a.GCa,
Nf.a.application,Object(n.a)(this,this.jhd,"showInsertVideoDialog"),t=>{Kg.App.Fb.qZa(t,Object(n.a)(this.X2,this.X2.CBa,"getCommandById"))})}Q_h(){Ta.a(this.$b.appSettings,"InsertCameoExperimentEnabled",!1)&&this.$b.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCameoExperimentEnabled",!1)&&this.ia.pa(tb.a.pzj,Nf.a.application,this.Ubl.bind(this),4)}vzk(){v.AFrameworkApplication.O3b()&&v.AFrameworkApplication.tph()&&(v.AFrameworkApplication.Aa.get_element().appendChild(this.vab.p5a),
bd.a.addHandler(this.vab.p5a.contentWindow,"message",Object(n.a)(this,this.tqh,"showOneDriveFilePickerDialog")),this.URc=!0)}tqh(t){if(t.rawEvent&&(t=t.rawEvent.data))try{L.a.J(512517961,352,50,"User select images.");const N=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0),ha=N.MessageId?N.MessageId.toString():null;N&&ha&&(ha===ce.a.insertImage||ha===ce.a.d6d)&&this.Pme.start(ha===ce.a.insertImage?this.Nca:this.Z1j)}catch(N){L.a.J(512517960,352,10,"malformatted postmessage here.")}}we(){}dul(){return 32}ELe(t,
N,ha){if(!this.M4(this.ta.Ba,t,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===ha)return 32;L.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const Aa=Lc.a.create(),Ra=gb.a.zM(this.la.pptEditingUserId).toString(),yb=t===tb.a.insertOnlinePicture&&this.la.cyk?1:0;let Sb=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,jk.a.le(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,Aa.toString(),3,Ra,yb);0<this.la.insertPictureServiceEndpoint.search(RegExp("insertmedia.bing.office.net",
"gi"))&&(Sb=this.o3.aei(Kg.App.mode,this.la.pptInsertOnlineContentImagesEnabled?this.la.insertOnlineContentImagesEndpoint:this.la.insertPictureServiceEndpoint));this.x9a.execute(uc=>{uc=this.vZc.getInstance(Sb,this.uZc,this.o3,uc,Bf.jg);uc.insertPictureTelemetryEndpoint=this.la.insertPictureTelemetryEndpoint;uc.correlationId=Aa;uc.c4=1;switch(t){case tb.a.wLd:this.XDa.wz=tb.a.KUb;break;default:this.Nca.wz=tb.a.M7a}uc.dHb(CommonUIStrings.L_PictureInsertTitle,t===tb.a.insertOnlinePicture?this.Nca:this.XDa);
L.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(Aa){return L.a.J(512517957,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",Aa.toString()),xb.Ts(ee.a.QZb,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}Wbl(t,N,ha){if(1===ha)return 32;t=new fd.a(void 0,void 0,!1);t.vd=5;t.jg=Ke.jg;t.pj(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});L.a.J(512517956,
352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}tIa(t,N,ha){if(!this.M4(this.ta.Ba,t,this.la.L7a))return 8;if(1===ha)return 32;let Aa,Ra;switch(t){case tb.a.uQc:case tb.a.j6d:N=new Lh.QueryStringBuilder(this.la.Mmg);this.$b.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&N.Hi("dalle","1");Aa=N.toString();Ra=1;this.Nca.wz=tb.a.vQc;break;case tb.a.Dmg:case tb.a.Emg:N=new Lh.QueryStringBuilder(this.la.Mmg);N.Hi("dalle","1");N.kz("initpivot",
"dalle");Aa=N.toString();Ra=1;this.Nca.wz=tb.a.vQc;break;case tb.a.e6d:Aa=this.la.i6d;Ra=1;this.Nca.wz=tb.a.tQc;break;case tb.a.IUb:Aa=this.la.Rji;Ra=0;this.XDa.wz=tb.a.xCc;break;case tb.a.yCc:Aa=this.la.Sji;Ra=0;this.XDa.wz=tb.a.vLd;break;default:return L.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",t.toString()),16}if(!Aa||!Aa.length)return 16;L.a.J(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");try{const yb=Lc.a.create(),
Sb=gb.a.zM(this.la.pptEditingUserId).toString();this.x9a.execute(uc=>{var Zc=this.la.szj&&uc.isFreemiumUpsellEnabled();Zc=this.u_c?1:Zc?0:-1;var ed=this.$b.ka("InsertOnlineM365ExperimentEnabled")?1:0;ed=this.o3.$di(Kg.App.mode,Aa,Zc,Ra,yb.toString(),Sb,ed);uc=this.vZc.getInstance(ed,this.uZc,this.o3,uc,Ej.jg);uc.correlationId=yb;uc.c4=2;uc.jRd=Zc;uc.dHb(CommonUIStrings.L_PictureInsertTitle,t===tb.a.IUb||t===tb.a.yCc?this.XDa:this.Nca);L.a.J(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});
return 32}catch(yb){return L.a.J(512517952,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",yb.toString()),xb.Ts(ee.a.QZb,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}FLe(t,N,ha){if(!this.M4(this.ta.Ba,t,v.AFrameworkApplication.O3b()&&(xb.Rig?!!this.Pme.ACb&&9<this.Pme.ACb.length:!0)))return 8;if(1===ha)return 32;L.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{N=!0;let Aa=0;if(this.$b.ka("InsertMediaSharedFilePickerEnabled")){const yb=
u.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(yb.H$d()){N=!1;const Sb=this.la.Omg;ha=!1;this.la.zQc&&(ha=this.NWi());const uc=Object.assign(new ba,{fnb:ha,Ctb:!0}),Zc=yb.GOd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,Sb,"InsertPicture",0,uc);yb.CYd(Zc).then(ed=>{if(ed&&0<ed.length){const Gd=[];for(let ze=0;ze<ed.length;ze++){const re=ed[ze][Jd.a.gye],ff={};ff.Extension=ed[ze][Jd.a.o4g];ff.OriginalUrl=Jd.a.bye in ed[ze]?ed[ze][Jd.a.bye]:
re;ff.Type=Jd.a.cye in ed[ze]?ed[ze][Jd.a.cye]:"";ff.Caption=Jd.a.fye in ed[ze]?ed[ze][Jd.a.fye]:"";ff.Description=Jd.a.aye in ed[ze]?ed[ze][Jd.a.aye]:"";ff.Width=Jd.a.eye in ed[ze]?ed[ze][Jd.a.eye]:0;ff.Height=Jd.a.dye in ed[ze]?ed[ze][Jd.a.dye]:0;Array.add(Gd,ff)}this.U4i(t).Qra(Gd);L.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}Aa=32}).catch(ed=>{L.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",
ed.toString());xb.Ts(ee.a.QZb,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);Aa=8})}}if(!N)return Aa;xb.Rig=!0;this.URc||this.vzk();const Ra=this.Y1j.getInstance();Ra.c4=4;switch(t){case tb.a.xLd:this.XDa.wz=tb.a.JUb;break;default:this.Nca.wz=tb.a.wQc}Ra.dHb(CommonUIStrings.L_PictureInsertTitle,t===tb.a.J2b?this.Nca:this.XDa);L.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(Aa){return L.a.J(512517919,
352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",Aa.toString()),xb.Ts(ee.a.QZb,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}U4i(t){if(!gd.a("ChangePictureFromOneDriveFixEnabled"))return this.Nca;const N=(t=t===tb.a.J2b)?this.Nca:this.XDa;N.wz=t?tb.a.wQc:tb.a.JUb;return N}NWi(){return u.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").QYi()}ihd(t,N,ha){if(!this.M4(this.ta.Ba,t,this.la.zQc&&this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",
!1)))return 8;if(1===ha)return 32;u.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").XPi(this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));try{let Aa=0;const Ra=u.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Ra.H$d()){const yb=t===tb.a.o6d,Sb=this.la.Omg,uc=Object.assign(new ba,{fnb:!0,Ctb:!0}),Zc=Ra.GOd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,yb,Sb,"InsertPictureFromMobile",
3,uc);Ra.CYd(Zc).then(ed=>{if(ed&&0<ed.length){const Gd=[];let ze=!1;const re=this.$b.Ha("PhoneLinkServiceEndpoint");for(let ff=0;ff<ed.length;ff++){const ah=ed[ff][Jd.a.gye],aj=ed[ff],Df={};Df.Extension=ed[ff][Jd.a.o4g];Df.OriginalUrl=this.dEb(aj,Jd.a.bye,ah);Df.Type=this.dEb(aj,Jd.a.cye,"");Df.Caption=this.dEb(aj,Jd.a.fye,"");Df.Description=this.dEb(aj,Jd.a.aye,"");Df.Width=this.dEb(aj,Jd.a.eye,0);Df.Height=this.dEb(aj,Jd.a.dye,0);Array.add(Gd,Df);ze||(ze=-1!==Df.OriginalUrl.indexOf(re))}ed=yb?
this.Nca:this.XDa;ed.wz=ze?yb?tb.a.Kmg:tb.a.uLd:yb?tb.a.wQc:tb.a.JUb;ed.Qra(Gd);L.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}Aa=32}).catch(ed=>{L.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",ed.toString());Aa=8})}return Aa}catch(Aa){return L.a.J(512517916,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Aa.toString()),8}}dEb(t,
N,ha){return N in t?t[N]:ha}Wld(t,N,ha,Aa,Ra){N=this.ta.Ba;if(!N)return L.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.M4(N,t,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===ha)return 32;if(!this.gl.lI(N,1))return this.gl.kJ(N),16;try{const yb=N.j2(this.ra.ae());if(yb&&this.Xb.Zc(yb))return 16;const Sb=this.H6a(N,yb);let uc=null;const Zc=this.Db.rd(15,void 0,()=>{this.ra.ly();this.ra.Ph();this.Fa.Ad()},()=>{this.ra.selectShape(Sb,!0);uc&&this.ra.selectShape(uc,!1)});try{Zc.jc(N);
Zc.$c=tb.a.insertOnlinePicture;Zc.my[Ne.a.WAa]=Ne.a.online;ha=null;t={["actionId"]:t};if(this.la.pptInsertOnlinePictureAttributionIsEnabled)if(Ra.LicenseUrl&&Ra.LicenseDisplayName){const ed=xb.lze(Ra);ha=Bl.c(ed);if(this.la.pptImageAttributionSelectionImprove){const Gd=N.Bb;uc=this.xm.fqa(!0,Gd.cid,Gd.sid,0,0,0,hb.a.VW,hb.a.e4,N.Qu()+1,!1)}}else t["result.LicenseDisplayName"]=Ra.LicenseDisplayName,t["result.LicenseUrl"]=gb.a.zM(Ra.LicenseUrl);else t.IsEnabled=this.la.pptInsertOnlinePictureAttributionIsEnabled;
L.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",t);Sb.hGb(Ra.OriginalUrl,Ra.LicenseUrl?null:Ra.Caption,ha,Ra.PageUrl);yb&&N.HT([yb]);N.rB(Sb);uc&&(N.rB(uc),Sb.b3a=uc.id,uc.y7a=!0)}finally{Zc&&Zc.dispose()}this.Mx.pI=Sb;return 32}catch(yb){return L.a.J(512517913,352,10,"InsertMediaActor::UploadOnlinePicture : Pic = [{0}], Exception = [{1}].",Ra.OriginalUrl,yb.toString()),8}}CCc(t,N,ha,Aa,Ra){N=this.ta.Ba;if(!N)return L.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.M4(N,
t,this.la.cHa))return 8;if(1===ha)return 32;L.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Ra)return 16;try{const yb=this.g6a()||this.ELc();if(!yb||this.Xb.Zc(yb))return 16;let Sb=null;const uc=this.Db.rd(15,void 0,void 0,()=>{this.ra.selectShape(yb,!0);Sb&&this.ra.selectShape(Sb,!1);L.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});try{uc.jc(N);uc.$c=tb.a.KUb;uc.my[Ne.a.WAa]=Ne.a.online;t=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&
Ra.LicenseUrl&&Ra.LicenseDisplayName){const Zc=xb.lze(Ra);t=Bl.c(Zc);if(this.la.pptImageAttributionSelectionImprove){const ed=N.Bb;Sb=this.xm.fqa(!0,ed.cid,ed.sid,0,0,0,hb.a.VW,hb.a.e4,N.Qu()+1,!1);L.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}yb.hGb(Ra.OriginalUrl,Ra.LicenseUrl?null:Ra.Caption,t,Ra.PageUrl);yb.set_isSVGBlipFilled(!1);Sb&&(N.rB(Sb),yb.b3a=Sb.id,Sb.y7a=!0)}finally{uc&&uc.dispose()}this.Mx.pI=yb;return 32}catch(yb){return L.a.J(512517905,
352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Pic = [{0}], Exception = [{1}].",Ra.OriginalUrl,yb.toString()),8}}BCc(t,N,ha,Aa,Ra){N=this.ta.Ba;if(!N)return L.a.J(512517911,352,50,"Active Slide is null"),8;if(!this.M4(N,t,this.la.cHa))return 8;if(1===ha)return 32;L.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");if(!Ra)return 16;try{var yb=this.ra.ae();t=[];for(var Sb of yb)Sb.Mf||t.push(Sb);for(const Zc of t)if(!Zc||this.Xb.Zc(Zc))return 16;yb=null;
const uc=this.Db.rd(15,void 0,void 0);try{uc.jc(N);uc.$c=tb.a.KUb;uc.my[Ne.a.WAa]=Ne.a.online;Sb=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Ra.LicenseUrl&&Ra.LicenseDisplayName){const ed=xb.lze(Ra);Sb=Bl.c(ed);if(this.la.pptImageAttributionSelectionImprove){const Gd=N.Bb;yb=this.xm.fqa(!0,Gd.cid,Gd.sid,0,0,0,hb.a.VW,hb.a.e4,N.Qu()+1,!1);L.a.J(512517906,352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const Zc=Ra.LicenseUrl?null:Ra.Caption;
for(const ed of t)ed.hGb(Ra.OriginalUrl,Zc,Sb,Ra.PageUrl),ed.set_isSVGBlipFilled(!1),yb&&(N.rB(yb),ed.b3a=yb.id,yb.y7a=!0)}finally{uc&&uc.dispose()}this.Mx.pI=t[0];return 32}catch(uc){return L.a.J(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Pic = [{0}], Exception = [{1}].",Ra.OriginalUrl,uc.toString()),8}}oxl(t,N,ha,Aa,Ra){N=this.ta.Ba;if(!N)return L.a.J(512517903,352,50,"Active Slide is null"),8;if(!this.M4(N,t,this.la.L7a))return 8;if(1===ha)return 32;L.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");
if(!Ra||!Ra.length)return 16;if(!this.gl.lI(N,Ra.length))return this.gl.kJ(N),16;try{let yb=null;ha=null;if(!({ovk:ha,evk:yb}=this.C9i(Ra,N)).returnValue)return 16;const Sb=this.Db.rd(15,void 0,()=>{this.ra.ly();this.ra.Ph();this.Fa.Ad()},()=>{this.ra.DXa(yb,!0)});try{for(Sb.jc(N),Sb.$c=t,Sb.my[Ne.a.WAa]=Ne.a.icon,ha&&N.HT(ha),t=0;t<yb.length;t++)N.rB(yb[t])}finally{Sb&&Sb.dispose()}this.Mx.pI=yb[yb.length-1];return 32}catch(yb){return L.a.J(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",
Ra.length,yb.toString()),8}}C9i(t,N){let ha,Aa;ha=Array(t.length);Aa=Array(t.length);var Ra=N.iXd(this.ra.ae());if(Ra&&0<Ra.length){var yb=0;for(const Sb of Ra)if(Sb&&!this.Xb.Zc(Sb)&&yb<t.length&&(ha[yb]=Sb,yb++,yb===t.length))break}Ra=!0;for(yb=0;yb<ha.length;yb++)this.la.svgIconLocalEditingIsEnabled&&t[yb].SvgContent&&0<t[yb].SvgContent.length&&(!ha[yb]||ha[yb]&&15!==ha[yb].zj)?Aa[yb]=this.A9i(N,ha[yb],t[yb],yb):(Aa[yb]=this.idg(N,ha[yb],t[yb],!0,yb),Ra=!1),Ra&&zk.a.uO(!0,!0),Aa[yb].hGb(t[yb].OriginalUrl,
t[yb].Caption,null,null);return{returnValue:!0,ovk:ha,evk:Aa}}A9i(t,N,ha,Aa){if(!t)return null;var Ra=t.Bb,yb=t.Qu();let Sb;const uc=Object(M.a)(253,t.oc(this.Qb.Ma));({FUd:Sb,vC:t}=this.QTa.pNd(N,ha.Width,ha.Height));Aa=N?0:Aa*rj.a.D6;Ra=this.xm.fqa(!0,Ra.cid,Ra.sid,0,t.x+Aa,t.y+Aa,Sb.width,Sb.height,yb+1,!1);yb=this.QTa.EJd(this.Qb.Cd,Sb,t,uc.BV);Ra.KT=yb;Ra.isResizable=!0;Ra.X3b=!0;Ra.EK=!0;Ra.qGa=!0;Ra.set_isSVGBlipFilled(!0);ha=this.rle.YWk(ha.SvgContent);Ra.qca=ha?String.format("data:image/svg+xml;charset=utf8,{0}",
encodeURIComponent(ha)):"";N&&(Ra.Iaa=N.id);return Ra}cki(t,N,ha,Aa,Ra){N=this.ta.Ba;if(!N)return L.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.M4(N,t,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===ha)return 32;L.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Ra||!Ra.length)return 16;try{const yb=this.ra.ae(),Sb=[];for(const ed of yb)ed.Mf||Sb.push(ed);const uc=Ra[0].Caption;for(const ed of Sb){if(!Sb||this.Xb.Zc(ed))return 16;const Gd=this.Ea.er(ed);
uc&&Gd&&this.Qc.C9g(new O(N.Bb,ed.get_shapeId(),ed.get_smartArtModelId(),uc))}const Zc=this.Db.rd(15,void 0,void 0,()=>{for(const ed of Sb){const Gd=this.Ea.er(ed);Gd&&(this.Qc.lbd(),this.ra.selectShape(Gd,!0),this.Qc.kbd())}L.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{Zc.jc(Sb[0]);Zc.$c=t;Zc.my[Ne.a.WAa]=Ne.a.icon;for(const ed of Sb)ed.set_isSVGBlipFilled(!0),ed.hGb(Ra[0].OriginalUrl,uc,null,null)}finally{Zc&&Zc.dispose()}for(const ed of Sb)this.Xb.Ipa(N,ed,this.Qb.Ma,
t);return 32}catch(yb){return L.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Ra.length,yb.toString()),8}}dki(t,N,ha,Aa,Ra){N=this.ta.Ba;if(!N)return L.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.M4(N,t,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===ha)return 32;L.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Ra||!Ra.length)return 16;try{const yb=this.ELc()||this.g6a();if(!yb||this.Xb.Zc(yb))return 16;
const Sb=Ra[0].Caption,uc=this.Ea.er(yb);Sb&&uc&&this.Qc.C9g(new O(N.Bb,yb.get_shapeId(),yb.get_smartArtModelId(),Sb));const Zc=this.Db.rd(15,void 0,void 0,()=>{uc&&(this.Qc.lbd(),this.ra.selectShape(uc,!0),this.Qc.kbd());L.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});try{Zc.jc(yb),Zc.$c=t,Zc.my[Ne.a.WAa]=Ne.a.icon,yb.set_isSVGBlipFilled(!0),yb.hGb(Ra[0].OriginalUrl,Sb,null,null)}finally{Zc&&Zc.dispose()}(ha=uc||yb)&&this.Xb.Ipa(N,ha,this.Qb.Ma,t);return 32}catch(yb){return L.a.J(512517893,
352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Ra.length,yb.toString()),8}}ELc(){let t=null;const N=this.ra.ae();for(const ha of N)if(ha&&ha.get_isSVGBlipFilled())if(t)break;else t=ha;return t}g6a(){if(this.$S){const t=this.ra.ae();return t&&t.length?this.pId(t)?t[0]:this.Zrb():null}return this.Zrb()}pId(t){if(!t||!t.length)return!1;let N=t[0].qk,ha=1===t[0].mediaType;for(const Aa of t)N=N&&Aa.qk,ha=ha&&1===Aa.mediaType;return N||ha}Zrb(){const t=this.ra.ae();
for(const N of t)if(N&&N.qk)return N;return null}qBg(t,N){const ha=this.$b.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");"defaultModal"!==ha&&L.a.J(t,352,15,`${N}::Modal:${ha}`)}jhd(t,N,ha){if(!this.M4(this.ta.Ba,t,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===ha)return 32;this.hAb=zk.a.hm("ShowInsertVideoDialog",1);const Aa=this.$b.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");try{if(this.la.insertVideoOnlineFromHubbleEnabled){L.a.J(512517890,
352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const yb=Lc.a.create(),Sb=gb.a.zM(this.la.pptEditingUserId).toString();this.x9a.execute(uc=>{uc=this.vZc.getInstance(this.o3.bei(Kg.App.mode,this.la.Rzj,yb.toString(),Sb,this.la.g8a,this.la.zvb,Aa),this.uZc,this.o3,uc,Ej.jg);uc.correlationId=yb;uc.c4=5;const Zc=new $l(this.ia,this.o3,this.la);Zc.wz=tb.a.h6d;uc.dHb(CommonUIStrings.L_VideoInsertTitle,Zc)})}else this.la.insertVideoOnlineFromUrlEnabled?(L.a.J(512517889,
352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new Qi(this.y8)).O4()):(L.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.x9a.execute(yb=>{this.vZc.getInstance(this.o3.cei(Kg.App.mode,this.la.insertVideoServiceEndpoint),this.uZc,this.o3,yb,Bf.jg).dHb(CommonUIStrings.L_VideoInsertTitle,new $l(this.ia,this.o3,this.la))}));this.qBg(512557208,"ShowInsertOnlineVideoDialog");null!=this.hAb&&Object(ca.a)(this.hAb.actionName,(new Date).getTime()-
this.hAb.TC.getTime(),"InsertOnlineVideoDialog",this.hAb.actionId,this.hAb.Ij);const Ra=this.$b.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");gd.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Ra&&L.a.J(512517859,352,15,"InsertOnlineVideo::ToolTipMessage : "+Ra);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.$b.qJc){const yb=this.$b.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",
!1)?"Visible":"NotVisible";L.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+yb)}L.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Ra){return L.a.J(512517856,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",Ra.toString()),xb.Ts(ee.a.QZb,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}Ubl(t,N,ha){if(!this.M4(this.ta.Ba,t,!0))return 8;if(1===ha)return 32;try{return L.a.J(512517855,
352,50,"InsertMediaActor::ShowInsertCameoDialog : Insert cameo, creating dialog"),(new Nk).O4(),32}catch(Aa){return L.a.J(512517854,352,10,"InsertMediaActor::ShowInsertCameoDialog : Exception = [{0}]",Aa.toString()),8}}rxl(t,N,ha,Aa,Ra){N=this.ta.Ba;if(!N)return L.a.J(512517853,352,50,"Active Slide is null"),8;if(!this.M4(N,t,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===ha)return 32;if(!this.gl.lI(N,1))return this.gl.kJ(N),16;try{const yb=N.j2(this.ra.ae());if(yb&&this.Xb.Zc(yb))return 16;
const Sb=this.H6a(N,yb),uc=this.o3.hhj(Ra.OriginalUrl);Sb.GIe(uc,Ra.ThumbnailUrl,Ra.Caption,Ra.Description,0<Ra.Width?Ra.Width:0,0<Ra.Height?Ra.Height:0);const Zc=this.Db.rd(15,void 0,()=>{this.ra.ly();this.ra.Ph();this.Fa.Ad()},()=>{this.ra.selectShape(Sb,!0)});try{Zc.jc(N),Zc.$c=t,yb&&N.HT([yb]),N.rB(Sb)}finally{Zc&&Zc.dispose()}L.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",Ra.OriginalUrl);this.Mx.pI=Sb;return 32}catch(yb){return L.a.J(512517851,
352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",yb.toString()),8}}qxl(t,N,ha,Aa,Ra){N=this.ta.Ba;if(!N)return L.a.J(512517850,352,50,"Active Slide is null"),8;if(!this.M4(N,t,this.la.insertVideoOnlineFromHubbleEnabled))return 8;if(1===ha)return 32;L.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");if(!this.gl.lI(N,1))return this.gl.kJ(N),16;try{const yb=N.j2(this.ra.ae());if(yb&&this.Xb.Zc(yb))return 16;const Sb=this.H6a(N,yb),uc=0<Ra.Width?Ra.Width:
0,Zc=0<Ra.Height?Ra.Height:0;let ed=Ra.PageUrl;this.la.zvb&&"odspbusiness"===Ra.ProviderName&&(ed=Ra.OriginalUrl);Sb.GIe(ed,Ra.ThumbnailUrl,Ra.Caption,Ra.Description,uc,Zc);const Gd=this.Db.rd(15,void 0,()=>{this.ra.ly();this.ra.Ph();this.Fa.Ad()},()=>{this.ra.selectShape(Sb,!0)});try{Gd.jc(N),Gd.$c=t,yb&&N.HT([yb]),N.rB(Sb)}finally{Gd&&Gd.dispose()}this.qBg(512557200,"InsertOnlineHubbleVideo");L.a.J(512517848,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",Ra.OriginalUrl);
this.Mx.pI=Sb;return 32}catch(yb){return L.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",yb.toString()),8}}M4(t,N,ha){t=!!t&&ha&&!this.Xb.Zc(t);switch(N){case tb.a.IUb:return t&&(!!this.g6a()||!!this.ELc());case tb.a.wLd:case tb.a.xLd:case tb.a.zLd:case tb.a.yCc:return t&&this.nli();default:return t}}nli(){const t=this.g6a()||this.ELc();return t?this.Ea.er(t)?!1:!0:!1}H6a(t,N){return this.idg(t,N,null,!1,0)}idg(t,N,ha,Aa,Ra){if(!t)return null;var yb=t.Bb;t=
t.Qu();let Sb;Aa?{width:ha,height:Sb}=xb.vej(N,ha):(ha=hb.a.VW,Sb=hb.a.e4);let uc;uc=N?N.msb(ha,Sb):this.Sb.tra(ha,Sb);Ra=N?0:Ra*rj.a.D6;yb=this.xm.fqa(!0,yb.cid,yb.sid,0,uc.x+Ra,uc.y+Ra,ha,Sb,t+1,!0);yb.set_isSVGBlipFilled(Aa);N&&(yb.Iaa=N.id);return yb}dispose(){this.x9a.instance&&this.Ple&&this.x9a.instance.uEb("MsoPremiumStockImages",this.Ple);this.URc&&this.vab.p5a.contentWindow&&(bd.a.removeHandler(this.vab.p5a.contentWindow,"message",Object(n.a)(this,this.tqh,"showOneDriveFilePickerDialog")),
this.URc=!1)}static Kei(){const t=CommonUIStrings.l_AttributionText.split(/[{}]+/);return km.e(t,N=>!!N)}static Ydi(t,N){const ha=document.createElement("body");var Aa="";let Ra="",yb=CommonUIStrings.L_CCYYSA;void 0!==N&&null!==N&&(void 0!==N.PageUrl&&null!==N.PageUrl&&(Aa=N.PageUrl),void 0!==N.LicenseDisplayName&&null!==N.LicenseDisplayName&&0<N.LicenseDisplayName.length&&(yb=N.LicenseDisplayName),void 0!==N.LicenseUrl&&null!==N.LicenseUrl&&(Ra=N.LicenseUrl));for(const Sb of t){switch(Sb){case "L_ThePhoto":t=
xb.zIf(CommonUIStrings.l_ThePhoto,Aa);break;case "L_CCYYSA":t=xb.zIf(yb,Ra);break;case "L_PhotoAuthor":t=xb.RIf(CommonUIStrings.l_PhotoAuthor);break;default:t=xb.RIf(Sb)}t&&ha.appendChild(t)}Aa=document.createElement("html");Aa.appendChild(ha);return Aa}static RIf(t){const N=document.createElement("span");N.innerText=t;return N}static zIf(t,N){const ha=document.createElement("A");ha.setAttribute("href",N);ha.setAttribute("target","_blank");ha.setAttribute("rel","noreferrer");N=document.createElement("span");
N.innerText=t;ha.appendChild(N);return ha}static lze(t){const N=xb.Kei();return xb.Ydi(N,t)}static Ts(){}static vej(t,N){let ha;t&&15===t.zj?(ha=Kc.a.Ge(t.kUe,0,!1),t=Kc.a.Ge(t.Q3d,0,!1)):N&&0<N.Width&&0<N.Height?(ha=N.Width,t=N.Height):(ha=Kc.a.Ge(2,0,!1),t=Kc.a.Ge(2,0,!1));return{width:ha,height:t}}}xb.Rig=!1;Object(h.a)(xb,"InsertMediaActor",null,[244]);var Tb=d(681);class wc{}wc.aml=864E5;wc.j6h=3;wc.Fgk=144E5;Object(h.a)(wc,"AddinConstantsNum",null,[]);var sd;(function(t){t[t.notSupported=-1]=
"notSupported";t[t.OMEX=0]="OMEX";t[t.spCatalog=1]="spCatalog";t[t.spApp=2]="spApp";t[t.fileSystem=3]="fileSystem";t[t.exchange=4]="exchange";t[t.oneDrive=5]="oneDrive";t[t.registry=6]="registry";t[t.inMemory=7]="inMemory";t[t.uploadFileDevCatalog=8]="uploadFileDevCatalog";t[t.hardCodedPreinstall=9]="hardCodedPreinstall";t[t.privateCatalog=10]="privateCatalog";t[t.wopiCatalog=16]="wopiCatalog"})(sd||(sd={}));Object(h.b)("AddinProviderType",sd);var $b=d(530);class ge{constructor(t,N,ha,Aa=null){this.fa=
Aa?Aa:v.AFrameworkApplication.fa;this.Ktd=2;this.Gtb=t;this.KXh=N;this.lw=ha}get iRa(){return this.Ktd}get Qxl(){return this.KXh}nFe(t){if(this.fa.ka("AgaveSupportsLiveIdSpoofing"))this.Gtb(t,this.iRa,{["ak0"]:(new Date).getTime()});else if($b.a.b$k(t)){var N=String.format(v.AFrameworkApplication.Aa.gb.yda+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",v.AFrameworkApplication.Aa.gb.Am,this.Qxl,v.AFrameworkApplication.Zg);const ha=v.AFrameworkApplication.He;let Aa=null;
this.lw&&(Aa=this.lw.wi("ComponentAttach",sd[t]+Tb.a[this.iRa]));ha.vj(N,1,null,null,!0,4,Ra=>{this.Kpk(t,Ra.data.Zd);Aa&&Aa.stop()},Ra=>{m.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Ra.data.af);Aa&&Aa.stop()},null)}else $b.a.uig(t)?(N=$b.a.c6f(t),this.Gtb(t,this.iRa,{["ak0"]:N})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinEntryPointDataProviderEnabled",!1)&&this.Gtb(t,this.iRa,null)}Kpk(t,N){if(N&&""!==N&&(N=Sys.Net.XMLDOM(N))){$b.a.XIb(Dj.a.oDf,
((new Date).getTime()+wc.Fgk).toString(),t);let ha=N.getElementsByTagName("update");ha&&ha.length||(ha=N.getElementsByTagName("o:update"));ha&&0<ha.length&&(N=Date.parse(ha[0].firstChild.nodeValue),($b.a.c6f(t)<N||$b.a.uig(t))&&this.Gtb(t,this.iRa,{["ak0"]:N}))}}}Object(h.a)(ge,"AddinCommandsAnonymousAPIInitializer",null,[1008]);class we{constructor(t,N,ha){this.Ktd=ha;this.Gtb=t;this.Qh=N}get iRa(){return this.Ktd}nFe(t){let N=null;this.Qh&&(N=this.Qh.wi("ComponentAttach",sd[t]+Tb.a[this.iRa]));
(null==this.LKe(t)?0:this.LKe(t))&&this.Gtb(t,this.iRa,{["ak0"]:(new Date).getTime()-wc.j6h*wc.aml});N&&N.stop()}}Object(h.a)(we,"AddinCommandsInitializerBase",null,[1008]);class oe extends we{constructor(t,N){super(t,N,5)}LKe(){return!0}}Object(h.a)(oe,"AddinCommandsInitializer",we,[]);class Fe extends we{constructor(t,N){super(t,N,1)}LKe(t){try{const N=Dj.a.A9f()+t;return Boolean.parse(this.PYi(N)||"false")}catch(N){m.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",N.toString())}return null}PYi(t){const N=
localStorage;return void 0!==N&&null!==N?N.getItem(t):null}}Object(h.a)(Fe,"AddinCommandsLocalCacheInitializer",we,[]);class Gf{constructor(t,N=null){this.lw=t;this.fa=N?N:v.AFrameworkApplication.fa}get appUILocale(){return jk.a.le(v.AFrameworkApplication.lcid).name}Mwj(){const t=this.gXd();if(t)if(this.fa.ka("OcpsIsEnabled"))u.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(N=>{N.isFeatureEnabled("ConnectedServices",!0).then(ha=>{for(let Aa of t){if(!ha&&0===
Aa.key)continue;const Ra=this.I5f(Aa.value);Ra&&Ra.nFe(Aa.key)}return null})});else for(let N of t){const ha=this.I5f(N.value);ha&&ha.nFe(N.key)}}oFe(t,N,ha){ha&&ha[Dj.a.Xmb]?(ha[Dj.a.rpa]=t,ha[Dj.a.u6]=N,this.X6g(G.a.ZEb,ha),$b.a.XIb(Dj.a.Xmb,ha[Dj.a.Xmb].toString(),t)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinEntryPointDataProviderEnabled",!1)&&0===t&&(ha={},ha[Dj.a.rpa]=t,ha[Dj.a.u6]=N,this.X6g(G.a.jCk,ha))}I5f(t){let N=null;switch(t){case 1:N=new Fe(Object(n.a)(this,this.oFe,
"retrieveAddinFlagCompleted"),this.lw);break;case 2:N=new ge(Object(n.a)(this,this.oFe,"retrieveAddinFlagCompleted"),this.appUILocale,this.lw,this.fa);break;case 5:N=new oe(Object(n.a)(this,this.oFe,"retrieveAddinFlagCompleted"),this.lw)}return N}}Object(h.a)(Gf,"AddinCommandsInitializerHost",null,[]);var Rh=d(1088),Sh=d(161);class Wa extends Gf{constructor(t,N){super(t.Udg());this.Op=t;this.$b=N;Rh.a.X1b=Rh.a.w5g}aql(){this.Mwj()}gXd(){const t=new Sh.a;this.$b.ka("51")&&(t.$(0,2),t.$(16,5));this.$b.ka("187")&&
t.$(1,1);this.Op.kd.Rra&&t.$(8,1);this.$b.ka("305")&&t.$(10,5);return t}X6g(t,N){this.Op.mK().Ka(t,2,N)}}Object(h.a)(Wa,"AddinCommandsInitService",Gf,[962]);class Lg{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AddinCommands"}Wb(t){this.K=t;u.a.instance.register(Wa,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").na(()=>new Wa(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("Common.IAppSettingsManager"))).ma()}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Iqg&&
this.K.resolve("Common.IAppSettingsManager").ff(()=>{u.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").aql()})}dispose(){}}Object(h.a)(Lg,"AddInCommandsInitPackage",null,[2,3]);class gg extends Ee{constructor(t,N=null){super(t,!0,N,!1)}get B4d(){return null}get ala(){return v.AFrameworkApplication.qqa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get awb(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get Wzc(){return null}}
Object(h.a)(gg,"DownloadAsPdfDialog",Ee,[]);class ub extends gg{constructor(t){super(t)}get ala(){return v.AFrameworkApplication.qqa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}V5b(){L.a.J(25544926,801,50,"Images download dialog displayed")}X5b(){L.a.J(25544928,801,50,"Images download dialog link clicked")}n9a(){L.a.J(25544930,801,50,"Images download dialog button clicked")}}Object(h.a)(ub,"DownloadACopyAsImagesDialog",gg,[]);var nk=d(191);class Tj extends Ad{constructor(t){super(t,
void 0,v.AFrameworkApplication.qqa)}get ala(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get awb(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get G5b(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get LWb(){return v.AFrameworkApplication.qqa?"UIFontDialogTextLarge":null}V5b(){L.a.J(8958087,801,50,"ODP download dialog displayed")}X5b(){L.a.J(8958089,801,50,"ODP download dialog link clicked")}n9a(){L.a.J(19505496,801,50,"ODP download dialog button clicked")}dVc(){nk.Redirect.showHelp("PPTODF");
return!0}get D5b(){return v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("EnableReactDialogs")&&gd.a("ReactDialogsODPDialogFix")?null:"#"}get xSa(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get OSg(){return!v.AFrameworkApplication.qqa}}Object(h.a)(Tj,"DownloadACopyAsOdpDialog",Ad,[]);class Fj extends gg{constructor(t){super(t)}get ala(){return v.AFrameworkApplication.qqa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}V5b(){L.a.J(21050910,
801,50,"PDF download dialog displayed")}X5b(){L.a.J(21050912,801,50,"PDF download dialog link clicked")}n9a(){L.a.J(21050914,801,50,"PDF download dialog button clicked")}}Object(h.a)(Fj,"DownloadACopyAsPdfDialog",gg,[]);var so=d(1113),tn=d(378);class Ll extends tn.a{constructor(t,N,ha){super();this.LW=null;this.vXc=0;this.Kd=this.sLg=null;this.I6j=t;this.e0j=N;this.yYj=ha;this.cWa=Object(n.a)(this,this.l4,"onRequestComplete");this.onError=Object(n.a)(this,this.onk,"onRequestError")}get Gdc(){return this.sLg}set Gdc(t){this.sLg=
t}get Ew(){return this.Kd}set Ew(t){this.Kd=t}start(){this.fHb()}fHb(){1!==v.AFrameworkApplication.Aa.state&&(this.LW=new so.a,this.LW.hr=!1,this.LW.vd=5,this.LW.message=this.I6j,this.LW.Oma(ResourceStrings.l_GenericDialogTitle,null,null),this.vXc=0)}qS(){this.LW&&(this.LW.close(),this.LW=null)}l4(t){this.qS();t.lPa?this.Gdc(t):this.KX()}onk(t){t.uOi&&this.vXc<Ll.KWk?(this.vXc+=1,t.start()):this.KX()}KX(){this.qS();if(1!==v.AFrameworkApplication.Aa.state){const t=new Fa.StandardDialog;t.vd=0;t.Vx(this.yYj,
ResourceStrings.l_GenericDialogTitle,this.e0j,this.Ew)}}}Ll.KWk=3;Object(h.a)(Ll,"UIBlockingTask",tn.a,[]);var Em=d(274);class gp extends Ll{constructor(t){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,ee.a.rgk);this.HA=t}start(){super.start();Em.a.mui(this.HA,Object(n.a)(this,this.Kba,"handleWebserviceResponse"),Object(n.a)(this,this.Jba,"handleWebserviceError"))}}Object(h.a)(gp,"ConvertToOdpTask",Ll,[]);class Cl extends Ll{constructor(t){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,ee.a.zuk);this.HA=t}start(){super.start();Em.a.oui(this.HA,Object(n.a)(this,this.Kba,"handleWebserviceResponse"),Object(n.a)(this,this.Jba,"handleWebserviceError"))}}Object(h.a)(Cl,"ConvertToPdfTask",Ll,[]);class Um{constructor(t,N,ha){this.NXc=t;this.me=N;this.ege=ha}get hqb(){return this.NXc.value}convert(t,N,ha){let Aa=null;0===N?this.ege?new Tj(ha):(Aa=new gp(t),Aa.Gdc=Object(n.a)(this,this.Jik,"onConvertOdpRequestSucceeded"),Aa.start()):1===N?this.me.kd.ytg&&
this.ege?new Fj(ha):zk.a.jK(zk.a.Cb,()=>{Aa=new Cl(t);Aa.Gdc=Object(n.a)(this,this.Kik,"onConvertPdfRequestSucceeded");Aa.start()}):2===N?this.me.kd.Nvg&&this.ege&&new ub(ha):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",N))}Jik(t){t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=jb.a.wBa(t.PrintUrl),new Tj(t))}Kik(t){t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=jb.a.wBa(t.PrintUrl),this.hqb.uQf=new Date,new Fj(t),this.hqb.dWf=new Date,L.a.J(21050908,801,
50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.hqb.TXf.toString(),this.hqb.Qhh.toString(),this.hqb.uQf.toString(),this.hqb.dWf.toString()))}}Object(h.a)(Um,"Converter",null,[1040]);class lf{constructor(){this.TXf=this.Qhh=this.uQf=this.dWf=Kg.App.Im}}Object(h.a)(lf,"DownloadACopyAsPdfContext",null,[]);class Ok extends Ll{constructor(t,N){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,
ee.a.hAk);this.HA=t;this.d$j=N}start(){super.start();Em.a.print(this.HA,this.d$j,Object(n.a)(this,this.Kba,"handleWebserviceResponse"),Object(n.a)(this,this.Jba,"handleWebserviceError"))}}Object(h.a)(Ok,"PrintTask",Ll,[]);class nm{constructor(t,N,ha){if(!t)throw Error.argumentNull("directPrintManager");this.t7b=t;this.me=N;this.t0j=ha}Pmk(t){this.t7b.tAk();t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=jb.a.wBa(t.PrintUrl),this.t7b.vqh(t))}print(t,N,ha){this.me.kd.ytg&&this.t0j?(t=new Lh.QueryStringBuilder(N),
t.Hi(mk.a.Esk,this.t7b.uph().toString()),t.Hi(mk.a.Ask,ha.toString()),this.t7b.vqh(t.toString())):(ha=new Ok(t,this.t7b.uph()),ha.Gdc=Object(n.a)(this,this.Pmk,"onPrintRequestSucceeded"),ha.start())}}Object(h.a)(nm,"Printer",null,[963]);class Th{get name(){return"PowerPointWebEditor.PrintPackage"}Wb(){u.a.instance.register(nm,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").ma().na(()=>new nm(u.a.instance.pb("Common.App.DirectPrint.IDirectPrintManager"),u.a.instance.pb("PowerPointWebEditor.IApplicationContext"),
u.a.instance.pb("PowerPointWebEditor.IApplicationSettings").vg));u.a.instance.register(Um,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").ma().na(()=>new Um(u.a.instance.Be("PowerPointWebEditor.DownloadACopyAsPdfContext"),u.a.instance.pb("PowerPointWebEditor.IApplicationContext"),u.a.instance.pb("PowerPointWebEditor.IApplicationSettings").vg));u.a.instance.register(lf,"PowerPointWebEditor.DownloadACopyAsPdfContext").ma().na(()=>new lf)}init(){}dispose(){}}Object(h.a)(Th,"PrintPackage",null,
[2,3]);class me{constructor(t,N){this.actionId=t;this.ld=N}}Object(h.a)(me,"CommandActionData",null,[]);class Gn{constructor(t,N,ha,Aa,Ra){this.BQg=[];this.kvg=!1;this.nde=null;this.YWc=new D.a;this.ia=t;this.Ine=N;this.aAf=!1;this.Mb=ha;this.uI=Aa;this.hda=Ra;this.N0c=null}get Xkd(){return this.BQg}get MVg(){this.N0c||(this.N0c=v.AFrameworkApplication.Fk("officeExtensionMerge.js",5));return this.N0c}set MVg(t){this.N0c=t}get f8h(){if(!this.nde){const t=[this.hda.xWb(this.MVg)];this.nde=Zb.a.create("pptedit.appforoffice",
t,()=>d.e(10).then(d.bind(null,1197)))}return this.nde}a1h(t){this.Xkd.push(t)}D3a(){this.kvg||(Cc.a.wx(this.f8h),this.kvg=!0)}Dol(){for(const t of this.Xkd)t.egb();this.BQg=[]}Eol(){var t=this.Mb.Kc(this.Ine.yf).zb(18);t=this.Mb.Kc(t);var N=t.zb(19);if(N){do N=t.hq,N=N.getValue(Xb.a.HY),this.ia.Ka(tb.a.teb,2,N);while(t.uf(19))}}ySb(t,N){this.YWc.add(new me(t,N))}lkj(){if(0<this.YWc.count){for(let t of this.YWc)this.ia.Ka(t.actionId,2,t.ld);this.YWc.clear()}}k3d(){const t=!!this.Xkd&&0<this.Xkd.length;
let N=!1;if(this.Ine.yf&&!t){const ha=this.Mb.Kc(this.Ine.yf).zb(18);ha&&0<this.Mb.Kc(ha).f7(19)&&(N=!0)}return t||N}}Object(h.a)(Gn,"AppForOfficeManagerFactory",null,[928]);class Sf extends Le{constructor(t,N,ha){super(t,N);this.la=ha;this.wz=tb.a.Fob}Qra(t){if(t&&t.length){var N=tb.a.vz(this.wz),ha=this.iDj(t[0]);try{L.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",N,ha?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");
if(32!==(ha?this.Ym.Ka(tb.a.xCc,2,t):this.Ym.Ka(this.wz,2,t[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",ha?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));L.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",N,ha?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(Aa){L.a.J(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",
N,Aa.toString())}}}iDj(t){(t=!!t&&!!t.OriginalUrl&&0<t.OriginalUrl.length&&this.la.pptSmartArtSubNodeIconChangeEnabled&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=t.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&t.OriginalUrl.toLowerCase().indexOf(".svg")===t.OriginalUrl.length-4)||L.a.J(512517842,352,50,"isChangeSvg = false");return t}}Object(h.a)(Sf,"ChangeOnlineImageHelper",Le,[]);class Fd extends Le{constructor(t,
N,ha){super(t,N);this.la=ha;this.wz=tb.a.M7a}Qra(t){if(t&&t.length){var N=tb.a.vz(this.wz),ha=new Map;ha.set("InsertMediaCommand",N);mf.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",null,ha);try{const Ra=[],yb=[];for(let uc=0;uc<t.length;uc++){const Zc=t[uc];this.Vtg(Zc)?Array.add(Ra,Zc):Array.add(yb,Zc)}L.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",yb.length,Ra.length,N);let Sb=this.wz;Sb===tb.a.tQc&&(Sb=tb.a.vQc);for(t=0;t<yb.length;t++){var Aa=
this.Ym.Ka(Sb,2,yb[t]);if(32!==Aa)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",yb.toString(),N));}if(this.Vtg(Ra[0])&&(Aa=this.Ym.Ka(tb.a.tQc,2,Ra),32!==Aa))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",Ra.toString()));L.a.J(512517840,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images success, command: {2}.",yb.length,Ra.length,N)}catch(Ra){L.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",
this.wz.toString(),Ra.toString()),ha.set("Exception",Ra.toString()),mf.Health.instance.recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,Object.assign(new ch.a,{extendedProperties:ha}))}}}Vtg(t){(t=!!t&&!!t.OriginalUrl&&0<t.OriginalUrl.length&&this.la.L7a&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=t.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&t.OriginalUrl.toLowerCase().indexOf(".svg")===
t.OriginalUrl.length-4)||L.a.J(512517838,352,50,"isInsertSvg = false");return t}}Object(h.a)(Fd,"InsertOnlineImageHelper",Le,[]);var ef=d(701);class kh{constructor(t,N){this.M$a=!1;this.cab=new Date(0);this.bab=new Date(0);this.Moe=t;this.yb=N}Bgg(){this.M$a=!0}OHa(){this.M$a?L.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.cab>this.bab?L.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+
this.cab+". Last scan at "+this.bab+"."):(this.cab=new Date,this.yb.Gb(new Y.a(3,1,0,Object(n.a)(this,this.NFe,"runJob"),90,"112")))}NFe(){this.bab=new Date;this.M$a?L.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.Moe()&&this.OHa()}}Object(h.a)(kh,"PrefetchScheduler",null,[]);class Pk{constructor(t,N,ha){this.JWc=null;this.CGg=N;this.QCg=ha;this.wwb=t}Y_k(t){this.wwb!==t&&(this.wwb=t,this.JWc=null)}adj(){this.JWc||(this.JWc=
this.Mhi());return this.JWc}Mhi(){const t=[];Array.add(t,this.wwb);for(let N=1;N<=this.CGg||N<=this.QCg;N++)N<=this.CGg&&Array.add(t,this.wwb+N),N<=this.QCg&&0<=this.wwb-N&&Array.add(t,this.wwb-N);return t}}Object(h.a)(Pk,"SlideWindow",null,[]);class uj{constructor(t,N,ha,Aa,Ra,yb,Sb,uc){this.Abb=!1;this.rc=Ra;this.Vp=Aa;this.pua=uc;this.ywb=new ef.a;this.Nz=new kh(Object(n.a)(this,this.CRe,"tryScan"),yb);this.hRg=new Pk(Aa&&Aa.Ba?Aa.Ba.slideIndex:0,Sb?Sb.Fhl:10,Sb?Sb.Ehl:5);this.JJe(t,N,ha)}start(){this.Abb?
L.a.J(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(L.a.J(593773075,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.Abb=!0,this.Nz.OHa())}JJe(t,N,ha){t&&t.WJ(Object(n.a)(this,this.S6c,"onEditSlideChanged"));N&&N.Kga(Object(n.a)(this,this.O7c,"onPageContentLoaded"));ha&&ha.PMa(Object(n.a)(this,this.Hok,"onSlideshowSlideChanged"))}O7c(t,N){this.Abb&&(t=Object(M.a)(123,N.node))&&t.mD&&(this.ywb.remove(t.Bb),this.Nz.OHa())}S6c(t,
N){N&&N.ila&&this.iC(N.ila.slideIndex)}Hok(t,N){N&&this.iC(N.slideIndex)}iC(t){this.hRg.Y_k(t);this.Abb&&this.Nz.OHa()}CRe(){const t=this.S0d();0<t.length&&this.qGe(t[0]);return 1<t.length}S0d(){const t=[];var N=this.Vp.presentation;if(!N)throw Error.argumentNull("Presentation is null");N=N.slides||[];for(const ha of this.hRg.adj()){const Aa=N[ha];this.f$k(Aa)&&Array.add(t,Aa)}return t}f$k(t){return!!t&&t.mD&&!t.dN&&!this.ywb.contains(t.Bb)}qGe(t){this.ywb.add(t.Bb);t=this.Ldj(t);0<t.length&&(L.a.J(593773072,
813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",t.length),this.pua?this.pua.Syk(t):L.a.J(593773070,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}Ldj(t){if(!this.rc)return L.a.J(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),this.Nz.Bgg(),[];const N=[];if(!t)return N;t=Object(M.a)(123,t);if(!t)return N;for(const ha of t.om())(t=
ha.lna)&&this.pua&&this.pua.M8a(t)&&Array.add(N,t);return N}static cLj(t){return!!t&&t.Ywg&&!Pc.a.Ki&&!Pc.a.YCa&&!Pc.a.eI&&!Pc.a.Fae}}Object(h.a)(uj,"StreamVideoPrefetchOrchestrator",null,[]);class Dl{static addAppPLTEventToLog(t){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(t)}catch(N){}}static setIsPageLoadForFirstTime(t){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(t)}catch(N){}}}Object(h.a)(Dl,"VersionHistoryLogConnector",null,[]);
class Zi{constructor(t,N,ha,Aa){this.SW=null;this.pfh=this.ResetAppVersionController;this.cC=t;this.vi=N;this.Ga=ha;this.yc=Aa;this.iVa={}}OnVersionHistorySelected(t,N){try{L.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const ha=document.getElementById("VersionHistoryViewerSpinner");ha&&(ha.style.display="none");if(this.SW)this.SW.onVersionSelected(t,N,this.iVa)}catch(ha){L.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",
ha)}}ResetAppVersionController(t){try{if(this.SW)Dl.setIsPageLoadForFirstTime(!1),this.SW.switchParentViewContainer(t);else{Dl.setIsPageLoadForFirstTime(!0);const N=new PowerPointVersionHistory.AppBootSettings;N.RenderServiceBase="";N.IsRtl=!1;const ha=new PowerPointVersionHistory.AppCallbackBag;ha.animationDecoratorCallback=Object(n.a)(this.cC,this.cC.pOd,"createAnimationOrTransitionStar");ha.notesIconDecoratorCallback=Object(n.a)(this,this.CreateNotesIcon,"CreateNotesIcon");N.IsHighContrast=!1;
this.vi&&(N.IsHighContrast=this.vi.isInHighContrastMode);N.IsHighContrast&&(N.ClientColorSettings=this.vi.highContrastColors.foregroundTextColor+"_"+this.vi.highContrastColors.backgroundColor+"_"+this.vi.highContrastColors.linkColor);if(this.yc){const Aa=this.yc.mQa();N.DefaultSlideWidth=Aa.width;N.DefaultSlideHeight=Aa.height}N.UserSessionId=v.AFrameworkApplication.userSessionId;N.VersionViewerCssUrl=this.Ga.versionHistoryViewerCssUrl;N.ProgressImageResourceUrl=Vg.a.cK(hb.a.Sla);this.SW=new PowerPointVersionHistory.AppVersionController(N,
t,ha)}}catch(N){L.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",N)}}CreateNotesIcon(){return Ga.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(h.a)(Zi,"PPTVersionHistorySelectionHandler",null,[927]);class De extends Ad{constructor(t){super(t,void 0,v.AFrameworkApplication.qqa)}get ala(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get awb(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get G5b(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get LWb(){return v.AFrameworkApplication.qqa?
"UIFontDialogTextLarge":null}V5b(){L.a.J(19743688,801,50,"Download a copy dialog displayed")}X5b(){L.a.J(19743690,801,50,"Download a copy dialog clicked")}n9a(){L.a.J(19743692,801,50,"Download a copy dialog button clicked")}}Object(h.a)(De,"PowerPointDownloadACopyDialog",Ad,[]);class nf{xcl(t){new De(t)}}Object(h.a)(nf,"PowerPointDownloadACopyDialogFactory",null,[779]);var Ak;(function(t){t[t.unknown=0]="unknown";t[t.bing=1]="bing";t[t.M365=2]="M365";t[t.icons=3]="icons";t[t.oneDrive=4]="oneDrive";
t[t.hubbleVideos=5]="hubbleVideos"})(Ak||(Ak={}));Object(h.b)("InsertMediaProviders",Ak);var qf;(function(t){t[t.OK=0]="OK";t[t.cancel=1]="cancel";t[t.error=2]="error";t[t.open=3]="open"})(qf||(qf={}));Object(h.b)("HubbleAction",qf);var Sg=d(521);class Ml extends fd.a{constructor(t,N,ha,Aa,Ra){super();this.lM=null;this.brc=!1;this.y8b=this.qwd=this.xW=null;this.nKd="KeepFocusDiv";this.oKd="KeepFocusStartDiv";this.correlationId=null;this.c4=0;this.insertPictureTelemetryEndpoint=null;this.jRd=0;if(!t)throw Error.argumentNull("insertMediaSeviceEndpoint",
"insertMediaSeviceEndpoint cannot be null.");this.u5e=t;this.x_e="";this.wNb=ha;this.J0=Aa;this.Vya=[];this.mzd=N;this.jg=Ra||Bf.jg;this.kg="InsertMediaDialog";this.m3d=!1;this.vd=5}dHb(t,N){this.x_e=t;this.brc=!1;this.showDialog(this.x_e,null);this.xW=this.jLc(this.hi("insertmediaframe"));if(!this.xW)throw this.Z4a(this.rBc),Error.invalidOperation("Couldn't get InsertMediaIframe.");(t=document.getElementById(this.hi("WACDialogPanel")))&&t.setAttribute(na.a.We,na.a.zId);t=document.createElement("div");
t.setAttribute("Id",this.oKd);t.setAttribute("tabindex","0");t.setAttribute("position","absolute");t.setAttribute("width","-1000px");t.setAttribute("top","-1000px");this.xW.parentNode.insertBefore(t,this.xW.parentNode.firstChild);t=document.createElement("div");t.setAttribute("Id",this.nKd);t.setAttribute("tabindex","0");this.xW.parentNode.appendChild(t);t.setAttribute("position","absolute");t.setAttribute("width","-1000px");t.setAttribute("top","10000px");$addHandler(this.iRd,"keydown",Object(n.a)(this,
this.Az,"keyDownHandler"));this.xW.setAttribute("src",this.u5e);this.xW.setAttribute("width","100%");this.xW.setAttribute("height","100%");this.xW.setAttribute("frameborder","0");v.AFrameworkApplication.fa.ka("ShowInsertMediaIframeWhenIframeIsReady")&&(Pc.a.$f||Pc.a.C4b)?(this.xW.style.visibility="hidden",this.y8b=Object(n.a)(this,this.Skk,"onInsertMediaIframeLoaded"),bd.a.addHandler(this.xW,"load",this.y8b)):this.xW.style.visibility="visible";this.jLc(this.hi("WACDialogTitleText")).style.display=
"none";if(2===this.c4||5===this.c4)this.jLc(this.hi("WACDialogTitlePanel")).style.display="none",this.jLc(this.hi("WACDialogBodyPanel")).style.padding="0";ec.FocusManager.instance().Zk().scope.IK=!0;this.lM=this.mzd.getInstance(this.xW.contentWindow,this.u5e);this.lM.Iva(ce.a.ZAf,ha=>{this.Pgk(ha,Object(n.a)(N,N.Qra,"insertMediaCallback"))});this.lM.Iva(ce.a.insert,ha=>{this.qve(ha,Object(n.a)(N,N.Qra,"insertMediaCallback"))});this.lM.Iva(ce.a.u0h,ha=>{this.fmk(ha)});this.lM.Iva(ce.a.G0i,Object(n.a)(this,
this.bkk,"onGetCustomHeaders"));this.lM.Iva(ce.a.Ubj,Object(n.a)(this,this.mkk,"onGetSessionId"));this.lM.Iva(ce.a.OYi,Object(n.a)(this,this.Zjk,"onGetCID"));this.lM.Iva(ce.a.Sii,Object(n.a)(this,this.Whk,"onCancelDialog"));2===this.c4&&0===this.jRd&&(this.lM.Iva(ce.a.ORj,Object(n.a)(this,this.nlk,"onLaunchM365Upsell")),this.qwd=this.J0.deb("MsoPremiumStockImages",ha=>{m.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.lM.sendMessage(ce.a.mxl,{["LicenseTier"]:ha.toString()})}));
this.jjc(3)}Skk(){this.xW&&(this.xW.style.visibility="visible",window.setTimeout(()=>{if(this.Xh){const t=this.Xh.getElementById("insertmediaframe");t&&t.focus()}},0))}Az(t){t.keyCode===Sys.UI.Key.tab&&(t.target.id!==this.nKd||t.shiftKey?t.target.id===this.oKd&&t.shiftKey&&(t.preventDefault(),this.Xh.getElementById(this.nKd).focus()):(t.preventDefault(),this.Xh.getElementById(this.oKd).focus()))}dispose(){this.J0&&this.qwd&&this.J0.uEb("MsoPremiumStockImages",this.qwd);this.lM&&(this.lM.dispose(),
this.lM=null);this.y8b&&(bd.a.removeHandler(this.xW,"load",this.y8b),this.y8b=null);super.dispose()}Pgk(t,N){m.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(t=this.wNb.g3g(t))50<this.Vya.length?m.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.Vya,t),this.brc&&(N(this.Vya),this.brc=!1))}Whk(){m.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.Z4a(this.rBc);this.jjc(1)}jjc(t){var N=RegExp("hubble","gi");if(this.insertPictureTelemetryEndpoint&&
0<this.insertPictureTelemetryEndpoint.search(N)&&this.correlationId){N=v.AFrameworkApplication.Yc;var ha={};ha.InsertedFiles=this.Vya.length;ha.DialogResult=qf[t];ha.DialogMode=this.P6i();ha.CorrelationId="{"+this.correlationId.toString()+"}";ha.Platform="Wac";ha.Provider=Ak[this.c4]||"Unknown";ha.AudienceGroup=N&&"AudienceGroup"in N?N.AudienceGroup.toString():"Unknown";ha.Ring=N&&"Ring"in N?N.Ring.toString():"Unknown";ha.AppId=Kg.App.mode;ha.Build=v.AFrameworkApplication.buildVersion;ha.Locale=jk.a.le(v.AFrameworkApplication.lcid).name;
this.zva().send(JSON.stringify(ha))}if(2===this.c4||5===this.c4){const Aa=v.AFrameworkApplication.fa.Ha("InsertMediaDialogAriaTenantNameSpace");Aa&&""!==Aa&&(N=[],ha="InsertUnknownContent",2===this.c4?(Array.add(N,Object.assign(new I.a,{name:"DialogMode",string:"M365Content"})),Array.add(N,Object.assign(new I.a,{name:"Provider",string:"M365Content"})),ha="InsertM365Content"):5===this.c4&&(Array.add(N,Object.assign(new I.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(N,Object.assign(new I.a,
{name:"Provider",string:"HubbleVideo"})),ha="InsertHubbleVideo"),Array.add(N,Object.assign(new I.a,{name:"InsertedFiles",int64:this.Vya.length})),Array.add(N,Object.assign(new I.a,{name:"DialogResult",string:qf[t]})),Array.add(N,Object.assign(new I.a,{name:"CorrelationId",string:this.correlationId.toString()})),w.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}",Aa,ha),dataFields:N})))}}P6i(){return 3===this.c4?"Icons":"Images"}jLc(t){const N=document.getElementById(t);if(!N)throw Error.invalidOperation(String.format("Couldn't get {0}.",
t));return N}zva(){const t=new XMLHttpRequest;t.open("POST",this.insertPictureTelemetryEndpoint,!0);t.setRequestHeader("Content-Type","");return t}qve(t,N){m.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.Z4a(this.rBc);N?this.Vya&&0<this.Vya.length?(N(this.Vya),this.jjc(0)):(m.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.brc=!0,N(this.Vya),this.jjc(2)):this.jjc(2)}bkk(){this.lM&&(m.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.lM.sendMessage(ce.a.o1k,
{["CustomHeaders"]:""}))}mkk(){this.lM&&(m.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.lM.sendMessage(ce.a.$4k,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}Zjk(){this.lM&&(m.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.lM.sendMessage(ce.a.K0k,{["CID"]:""}))}fmk(t){t&&t.Values&&(t=t.Values,delete t.m_Origin,delete t.m_Source,delete t.m_ReceivedTime,m.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+
t.eventName||!1),w.a.sendOtelEvent(Object.assign(new Sg.a,{otelEvent:t})))}nlk(){this.J0&&(m.ULS.sendTraceTag(512497693,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.J0.launchUpsellExperience("stockimages"))}}Object(h.a)(Ml,"InsertMediaDialog",fd.a,[936,106]);class am{getInstance(t,N,ha,Aa,Ra){return new Ml(t,N,ha,Aa,Ra)}}Object(h.a)(am,"PptInsertMediaDialogFactory",null,[926]);var Tn=d(109);class Bk{constructor(t){this.v$a=t;this.JJe(this.v$a.Bk,this.v$a.XLg)}JJe(t,
N){t&&t.WJ(Object(n.a)(this,this.S6c,"onEditSlideChanged"));N&&N.Kga(Object(n.a)(this,this.O7c,"onPageContentLoaded"))}WNk(t,N){t&&t.z4(Object(n.a)(this,this.S6c,"onEditSlideChanged"));N&&N.ZWa(Object(n.a)(this,this.O7c,"onPageContentLoaded"))}O7c(t,N){(t=Object(M.a)(123,N.node))&&t.mD&&(this.v$a.ywb.remove(t.Bb),this.v$a.Nz.OHa())}S6c(t,N){N&&N.ila&&(this.v$a.pTa=N.ila,this.v$a.Nz.OHa(),this.v$a.Yce=new Date)}}Object(h.a)(Bk,"SlideEventListener",null,[]);class Fm{constructor(t,N,ha){this.UPg="";
this.M$a=!1;this.cab=new Date(0);this.bab=new Date(0);this.Moe=t;this.yb=N;ha&&(this.UPg=ha)}Bgg(){this.M$a=!0}OHa(){this.M$a?L.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.cab>this.bab?L.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.cab+". Last scan at "+this.bab+"."):(this.cab=new Date,this.yb.Gb(new Y.a(3,
1,0,Object(n.a)(this,this.NFe,"runJob"),90,this.UPg)))}NFe(){this.bab=new Date;this.M$a?L.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.Moe()&&this.OHa()}}Object(h.a)(Fm,"BackgroundJobScheduler",null,[]);class Nl{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd){this.W2c=null;this.Yce=new Date;this.pTa=null;this.mGg={};this.lQg={};this.EQg={};this.oFg={};if(!ha)throw Error.argumentNull("graphTopologyManager");if(!Aa)throw Error.argumentNull("fontUtilsManager");
this.Vp=ha;this.Cy=Aa;this.Bk=t;this.XLg=N;this.bpe=uc;this.wac=Zc;this.cpe=ed;this.P2c=Gd;this.ywb=new ef.a;this.Nz=new Fm(Object(n.a)(this,this.CRe,"tryScan"),Ra,"");0<yb&&window.setInterval(Object(n.a)(this,this.YAg,"logMissingFonts"),yb);this.z4j=Sb;t=ha.Ba?ha.Ba.slideIndex:0;if(N=this.Vp.presentation)N=N.slides||[],t<N.length&&(this.pTa=N[t],this.Yce=new Date)}dispose(){this.stop();this.YAg()}start(){this.stop();this.W2c=new Bk(this);this.Nz.OHa()}stop(){this.W2c&&this.W2c.WNk(this.Bk,this.XLg);
this.W2c=null}S0d(){const t=[];this.pTa&&t.push(this.pTa);return t}CRe(){const t=this.S0d();0<t.length&&(this.qGe(t[0]),this.ywb.add(t[0].Bb));return 1<t.length}ece(t,N,ha,Aa){const Ra=[];for(const yb of Object.keys(t))t[yb]||this.oFg[yb]||(Ra.push(yb),this.oFg[yb]=!0);t=Ra.length;0<t&&(L.a.J(ha,820,15,"{0}",t),N&&L.a.J(Aa,820,15,"{0}",Ra.join(",")))}qGe(t){const N=t.rQa();if(N&&(this.bpe||this.cpe||this.wac||gd.a("ShouldLogMissingThirdPartyFontCount"))){var ha={},Aa={},Ra={};t.C3f.split(",").forEach(ed=>
{ed&&(ed=this.Cy.rF(ed),ha[ed]=!1)});t.$vh.split(",").forEach(ed=>{ed&&(ed=this.Cy.rF(ed),Aa[ed]=!1)});t.Ozh.split(",").forEach(ed=>{ed&&(ed=this.Cy.rF(ed),Ra[ed]=!1)});t=[];var yb=[],Sb=[];for(let ed=0;ed<N.length;ed++){var uc=N[ed];uc=Array.isArray(uc.jD())?uc.jD():null;for(const Gd of uc)for(uc=0;Gd.Ra&&uc<Gd.Ra.length;){var Zc=Gd.Ra.ga(uc);Zc=Zc.formatting?this.Cy.rF(Tn.Font.LBa(Zc.formatting.cache.TM.trim().toLowerCase())):"";gb.a.Va(Zc)||(Zc in ha&&!ha[Zc]?(t.push(Zc),ha[Zc]=!0):Zc in Aa&&!Aa[Zc]?
(yb.push(Zc),Aa[Zc]=!0):Zc in ha||Zc in Aa||Ra[Zc]||(Sb.push(Zc),Ra[Zc]=!0));uc++}}this.bpe&&(Nl.L5d(this.mGg,t,this.Cy),this.ece(ha,!0,555886295,555886296));if(this.wac||gd.a("ShouldLogMissingThirdPartyFontCount"))Nl.L5d(this.lQg,yb,this.Cy),this.ece(Aa,this.wac||this.P2c,555886297,555886298);this.cpe&&(Nl.L5d(this.EQg,Sb,this.Cy),this.ece(Ra,this.P2c,555886299,555886300))}}YAg(){+new Date-+this.Yce<this.z4j||(this.bpe&&Nl.oce(this.mGg,this.Cy,591003669,!0,"MissingFirstPartyFonts"),(this.wac||gd.a("ShouldLogMissingThirdPartyFontCount"))&&
Nl.oce(this.lQg,this.Cy,591003667,this.wac||this.P2c,"MissingThirdPartyFonts"),this.cpe&&Nl.oce(this.EQg,this.Cy,587337796,this.P2c,"MissingNonLoggableFonts"))}static L5d(t,N,ha){N.forEach(Aa=>{gd.a("ShouldNormalizeFontNamesBeforeLogging")&&(Aa=ha.rF(Aa));if(void 0===t[Aa]||null===t[Aa])t[Aa]=!1})}static i7i(t,N){if(!t)throw Error.argumentNull("fonts");const ha=[];for(const Aa of Object.keys(t))t[Aa]||(N.H7(Aa)||N.H7('"'+Aa+'"')||ha.push(Aa),t[Aa]=!0);return ha}static oce(t,N,ha,Aa,Ra){N=Nl.i7i(t,
N);t=N.length;0<t&&(N=N.join(","),Aa&&587337796===ha?L.a.J(ha,820,15,"{0}",N):L.a.J(ha,820,15,"{0}",Aa?N:t.toString()),ha=new Map,Aa&&ha.set("Fonts",N),ha.set("FontsCount",t.toString()),mf.Health.instance.recordQosError(Ra,["MissingFont"],!1,!1,!0,!1,Object.assign(new ch.a,{extendedProperties:ha})))}}Object(h.a)(Nl,"FontLogger",null,[106]);var Cf=d(938);class Ol{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze){if(!t)throw Error.argumentNull("applicationSettings");if(!N)throw Error.argumentNull("actionManager");
if(!ha)throw Error.argumentNull("graphTopologyManager");if(!Aa)throw Error.argumentNull("graphActionBlockingManager");if(!Ra)throw Error.argumentNull("pptSelectionManager");if(!yb)throw Error.argumentNull("ribbonChangeManager");if(!Sb)throw Error.argumentNull("transactionFactory");if(!uc)throw Error.argumentNull("shapeEditor");if(!Zc)throw Error.argumentNull("errorHandler");if(!ed)throw Error.argumentNull("focusManager");if(!Gd)throw Error.argumentNull("sessionInfo");if(!ze)throw Error.argumentNull("mediaUploaderFactory");
this.Ga=t;this.ia=N;this.ta=ha;this.Xb=Aa;this.nb=Ra;this.Mx=yb;this.Db=Sb;this.xm=uc;this.Kd=Zc;this.Fa=ed;this.Ms=ha.presentation;this.Ce=Gd;this.lab=ze;Cf.a.zyl=this.Ga.zzl;Cf.a.uzl=this.Ga.wzl}ub(){this.ia.pa(tb.a.jhd,Nf.a.application,this.Opj.bind(this),4)}we(){}Opj(t,N,ha){N=this.ta.Ba;if(!N||this.Xb.Zc(N))return 16;if(1===ha)return 32;this.hg=zk.a.hm("Video::Insert");try{return Mk.a.fMe("video/*",Yg.b,()=>Yg.a(t,this.Szj.bind(this),"video",this.Ce),"video",this.ta.presentation,this.Xb,this.Kd,
this.hg,!0,this.lab,this.Ga.Azl,this.Ga.yzl,this.Ga.xzl),this.hg&&this.hg.Wa("VideoDialogInitialized","true"),32}catch(Aa){L.a.J(509724677,818,10,"Exception {0} while rendering file selection dialog.",Aa)}this.showErrorMessage(446,null);return 8}showErrorMessage(t,N){this.hg&&(this.hg.finish(),this.hg=null);this.Kd.qG(t,ha=>{ha.xB=1;ha.ePa=N;return!1})}Szj(t,N,ha,Aa,Ra,yb){Aa.QP(ha)&&L.a.J(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+ha.Wpa);ha=this.ta.Ba;Aa=ha.Qu();var Sb=this.Ms.slideHeight;const uc=this.Ms.slideWidth/2-Kc.a.Ef(hb.a.VW/2,0);Sb=Sb/2-Kc.a.Ef(hb.a.VW/2,1);if(ha&&ha.isConnected){var Zc=this.Db.rd(15,void 0,void 0,()=>{this.Mx.pI=this.pbc;this.nb.selectShape(this.pbc,!0);this.Fa.Ad()});try{Zc.jc(ha);Zc.$c=t;Ra&&Ra.Wa("CreatingVideoShape","true");this.pbc=this.xm.j4a(!1,ha.Bb.cid,ha.Bb.sid,0,10,uc,Sb,hb.a.VW,hb.a.e4,Aa+1);const ed=yb.files[0].name;this.pbc.Pnc=N;this.pbc.Onc=ed;ha.rB(this.pbc)}finally{Zc&&
Zc.dispose()}Ra&&(Ra.Wa("VideoShapeSuccessfullyCreated","true"),Ra.finish(),Ra=null)}}}Object(h.a)(Ol,"InsertVideoActor",null,[244]);class Re{constructor(){this.hda=this.gh=this.G3=this.K=null;this.mLg=[];this.n7b=[new Th];this.HW=[]}get name(){return"PowerPointWebEditor.Chronos2"}Wb(t){this.K=t;this.G3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.gh=this.G3.UBa(5,this.name);this.hda=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");for(let Ra=0;Ra<this.n7b.length;++Ra)Array.add(this.HW,
mc.a(this.n7b[Ra],5));for(const Ra of this.HW)Ra.Wb(t);const N=this.K.resolve("PowerPointWebEditor.IApplicationContext"),ha=v.AFrameworkApplication.fa.ka("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),Aa=jg.a.vu(this.K.La("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.K.register(Gn,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").na(()=>new Gn(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).ma();this.K.register(Zi,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").ma().na(()=>new Zi(this.K.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));
this.K.register(ck,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").ma().na(()=>new ck(t.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),new tc.a(()=>Aa.result),t.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.K.register(Cm,"Box4.Media.InsertOneDriveFileHelper").ma().na(()=>new Cm(v.AFrameworkApplication.Ta));this.K.register(Kj,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").ma().na(()=>new Kj);
this.K.register(Fd,"PowerPointWebEditor.InsertOnlineImageHelper").ma().na(()=>new Fd(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(Sf,"PowerPointWebEditor.ChangeOnlineImageHelper").ma().na(()=>new Sf(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(im,
"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").ma().na(()=>new im(new Sm(new tc.a(()=>{if(v.AFrameworkApplication.tph()){var Ra=this.K.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").p5a;Ra=new jm(Ra.contentWindow,"*")}else Ra=N.h4i();return Ra}),ha?jb.a.lS(window.document.URL):jb.a.lS(v.AFrameworkApplication.Lla),v.AFrameworkApplication.fa.appSettings.ImageFetcherSupportedExtensions)));this.K.register(Cj,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ma();
this.K.register(Tm,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ma().na(()=>new Tm);this.K.register(am,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").ma();this.K.register(779,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").ma().na(()=>new nf);this.K.register(uj,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").ma().na(()=>new uj(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").Bd(8),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let t=this.gh.Zt("resolvechronos2");const N=this.K.resolve("Common.AFrameworkApplication"),ha=this.K.resolve("PowerPointWebEditor.IApplicationContext"),
Aa=ha.kd,Ra=N.$q,yb=this.K.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),Sb=this.K.resolve("Common.IActionManagerExtended"),uc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var Zc=this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper");const ed=this.K.resolve("PowerPointWebEditor.IFocusManager"),Gd=Ra.Ed,ze=this.K.resolve("Common.Transaction.ITransactionFactory"),re=this.K.resolve("PowerPointWebEditor.IShapeEditor"),ff=this.K.Be("PowerPointWebEditor.IClassFactory"),
ah=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),aj=this.K.resolve("Box4.Graph.IGraphIteratorFactory"),Df=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Fi=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),We=this.K.resolve("PowerPointWebEditor.IPresentationReader"),wi=Ra.ndb,Mn=this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),Bn=this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),dn=this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
Uo=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Ao=this.K.resolve("PowerPointWebEditor.IShapeReader"),pp=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");this.gh.gu(t);t=this.gh.Zt("regactorschronos2");Zc=[new Lk(Aa,Sb,uc,this.K.La("PowerPointWebEditor.IAddinCommandsManager")),new Yi(Aa,Zc,Sb,Gd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ze,ff,uc,this.K.La("PowerPointWebEditor.IAppForOfficeManager"),aj,Df,Fi),new xb(Aa,Sb,Df,ah,ed,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
ze,this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.K.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),We,re,Ao,pp,Uo,Fi,this.K.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),
this.K.resolve("Box4.Media.IImageFilePickerHelper"),this.K.resolve("Box4.Media.InsertOneDriveFileHelper"),this.K.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),this.K.resolve("PowerPointWebEditor.IJSanityHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("Common.IAppSettingsManager")),new Fn(Sb,this.K.resolve("PowerPointWebEditor.ISlidePane"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Df,ah,Uo,this.K.resolve("Common.Transaction.ITransactionFactory"),re,this.K.resolve("PowerPointWebEditor.IErrorHandler"),ed,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")),new Ol(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Sb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Df,ah,Uo,this.K.resolve("Common.Transaction.ITransactionFactory"),
re,this.K.resolve("PowerPointWebEditor.IErrorHandler"),ed,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader"))];for(const Xj of Zc)Xj.ub(),Xj.we();uc.aAf=!0;this.gh.gu(t);v.AFrameworkApplication.fa.ff(()=>{t=this.gh.Zt("regfullactorschronos2");const Xj=[new sn(Sb,Df,ed,ah,this.K.resolve("PowerPointWebEditor.IPPTWorkspace").yf,Mn,ha.kQa().tMj,Bn,this.K.resolve("PowerPointWeb.IPrinter"),this.K.resolve("PowerPointWeb.IConverter"),this.K.resolve("Box4.IAppFrame"),
dn,yb,this.K.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),N.irmPolicyDescription,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),()=>v.AFrameworkApplication.bO,ha.eZd(),Uk=>v.AFrameworkApplication.Aa.gb.qKe(Uk),()=>v.AFrameworkApplication.c5b,this.K.resolve("PowerPointWebEditor.IDeferredContentManager"),
this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new mm(Ra,Aa.hUi,wi.embedPreviewUrl,Sb,We,ha.eZd(),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const Uk of Xj)Uk.ub(),Uk.we();this.gh.gu(t)});L.a.J(512360593,809,50,"Chronos2Package::Init");for(const Xj of this.HW)this.gh.Zt(Xj.name),Xj.init(),this.gh.gu(Xj.name);t=this.gh.Zt("al");this.Twj();this.gh.gu(t);v.AFrameworkApplication.fa.ff(()=>{if(Aa.powerPointIdeasIsEnabled){t=
this.gh.Zt("idea");var Xj=this.yxj();this.xxj(Xj);this.gh.gu(t)}Aa.powerPointSmartLookupIsEnabled&&(t=this.gh.Zt("smartLookup"),this.myj(),this.gh.gu(t));v.AFrameworkApplication.kUc()&&(t=this.gh.Zt("versionhistory"),this.Cyj(),this.gh.gu(t));uj.cLj(Aa)&&ib.a.get_instance().Xj(7,()=>{this.K.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const Uk=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(Uk&&(Uk.yoh||Uk.xoh||Uk.zoh)){const Gi=!gb.a.Va(v.AFrameworkApplication.fa.Ha("TenantId"))&&
Array.contains(Uk.Skl,v.AFrameworkApplication.fa.Ha("TenantId"));this.K.register(Nl,"PowerPointWebEditor.Text.FontLogger").ma().na(()=>new Nl(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager"),this.K.resolve("Common.ITaskManager"),Uk.Xck,Uk.Wck,Uk.yoh,Uk.xoh&&v.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),
Uk.zoh,Uk.dKi&&Gi));Xj=this.K.resolve("PowerPointWebEditor.Text.FontLogger");this.mLg.push(Xj);Xj.start()}});v.AFrameworkApplication.KAa||(t=this.gh.Zt("appforoffice"),this.Qwj(),this.gh.gu(t));Aa.rrh&&!Aa.bXa&&this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").tVc()}dispose(){for(const t of this.HW)t.dispose();for(const t of this.mLg)try{t&&t.dispose()}catch(N){L.a.J(512360592,306,10,"Exception disposing a disposable. {0} {1}",N.message,N.stack)}}Twj(){L.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");
try{const t=Zb.a.create("pptedit.augloop",null,()=>d.e(11).then(d.bind(null,1198)));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled){const N=this.K.resolve("Common.ISharedDependencyLoader"),ha=v.AFrameworkApplication.Fk("augloop-runtime-shim-ie",2);N.hwb(ha).continueWith(()=>{Cc.a.wx(t)})}else Cc.a.wx(t)}catch(t){L.a.J(512360590,306,10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",t.message,t.stack)}}yxj(){L.a.J(512360588,
809,50,"Start to download infrared.hermes.js file");var t=[this.hda.xWb(v.AFrameworkApplication.Fk("ir-plugin-ski.min.js",5))];t=Zb.a.create("pptedit.infrared",t,()=>d.e(14).then(d.bind(null,1204)));Cc.a.wx(t);return t}xxj(t){L.a.J(512360587,809,50,"Start to download ideas.hermes.js file");t=this.hda.jPd(v.AFrameworkApplication.Fk("microsoft.ideas.runtime.js",5),[t],!1);t=Zb.a.create("pptedit.ideas",[t],()=>d.e(15).then(d.bind(null,1206)));Cc.a.wx(t)}myj(){L.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");
const t=Zb.a.create("pptedit.smartlookup",null,()=>d.e(13).then(d.bind(null,1201)));Cc.a.wx(t)}Cyj(){const t=this.hda.xWb(v.AFrameworkApplication.Hea+"pptVersionHistory.js");try{Cc.a.wx(t)}catch(N){L.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",N.toString())}}Qwj(){const t=this.K.resolve("PowerPointWebEditor.IApplicationSettings");u.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").k3d()?Re.q5d():t.vg?
v.AFrameworkApplication.fa.ff(Re.Glg):ib.a.get_instance().Xj(8,()=>{Re.Glg()})}static main(){v.AFrameworkApplication.Xg&&Pc.a.$f?L.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):e.a.instance.Ac(mc.a(new Re,5))}static q5d(){u.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").D3a();e.a.instance.Ac(new Lg)}static Glg(){let t=!1;try{window.self.requestIdleCallback(Re.q5d)}catch(N){t=!0}t&&window.setTimeout(Re.q5d,0)}}Object(h.a)(Re,"Chronos2Package",
null,[2,3]);var Gm=d(241),Zg;(function(t){t[t.unsupported=0]="unsupported";t[t.designer=1]="designer";t[t.blank=2]="blank"})(Zg||(Zg={}));Object(h.b)("AgendaSlideThemeType",Zg);var of=d(110);class Un{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(h.a)(Un,"AgendaApplyInfo",null,[]);class om{constructor(){this.DeckSuggestionId=this.CorrelationId=this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(h.a)(om,"AgendaThemeApplyInfo",null,[]);class Ve{constructor(t,
N){this.lUd=!1;this.uze=[];this.kUf=t;this.FOi=N}}Object(h.a)(Ve,"DeckOptionInformation",null,[]);class $i{constructor(){this.zQg=this.AQg=0;this.mEg=[]}get vkd(){return this.AQg}set vkd(t){this.AQg=t}get ukd(){return this.zQg}set ukd(t){this.zQg=t}get t4a(){return this.mEg}set t4a(t){this.mEg=t}L4g(t,N,ha){const Aa=new D.a;if(t)for(let Ra=0;Ra<ha-1&&Ra<t.length;Ra++)Aa.add(new Ve(t[Ra],!1));gb.a.Va(N)||Aa.add(new Ve(N,!0));this.t4a=Aa.toArray()}}Object(h.a)($i,"AgendaDeckSessionInformation",null,
[]);class pm{constructor(){this.p6b=this.q6b=this.mCg=0;this.Poe=this.mWc=this.Kme=this.U0c=null}g0k(t){t&&(this.mCg=t.body.slideIndex)}G3k(t){t.body&&t.body.outlineRequestContent&&(this.U0c=JSON.stringify(t.body.outlineRequestContent))}c0k(t){t.body&&(this.p6b=t.body.slideCId)}f0k(t){t.body&&(this.q6b=t.body.slideSId)}d0k(t){this.mWc=t.id}ABj(t){return t===this.mWc?(this.mWc=this.U0c=null,!0):!1}wPj(){return!gb.a.Va(this.U0c)&&!gb.a.Va(this.mWc)}v3k(t){t.body&&t.body.outlineRequestContent&&t.body.outlineRequestContent.Slides&&
(this.Kme=t.body.outlineRequestContent.Slides.length)}e0k(t){this.Poe=t.body.score}}Object(h.a)(pm,"AgendaDetection",null,[]);class ok{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd){this.Hsa=this.AA=null;this.rWc=0;this.KZ=null;this.Zzb="";this.pYc=!1;this.rja=0;this.Z7=new D.a;this.$Hg=!1;this.ni=t;this.Sb=N;this.ta=ha;this.Xb=Aa;this.Ga=Ra;this.qq=yb;this.Ie=uc;this.nb=Zc;this.Sv=ed;this.Vab=Gd;this.Sv.qjk(this.Ga)}fxh(){this.zmh();this.ovi();this.Pqb()?(this.KZ=new $i,this.KZ.vkd=this.qK(),this.gol()):
1!==this.rja||this.Ga.AHc?2===this.rja&&this.Ga.zHc&&(this.KZ=new $i,this.KZ.vkd=this.qK(),this.Nol()):this.Mol()}ovi(){this.Hsa=Lc.a.create().toString();this.Sv.oSk(this.Hsa);this.Sv.Qgk()}DQe(t,N){if(this.AA){if(!this.AA.q6b||!this.AA.p6b){var ha=this.Sb.XH(this.AA.mCg);this.AA.q6b=ha.Bb.sid;this.AA.p6b=ha.Bb.cid}ha=this.Sb.XH(0);this.ni.generateAgendaSuggestion(ha.Bb.cid,ha.Bb.sid,this.Hsa,this.AA.U0c,this.XVi(),t,N)}else N(null)}Mol(){this.DQe(Object(n.a)(this,this.imk,"onPODSTriggerAgendaConversionSuccessV1"),
Object(n.a)(this,this.JZg,"onPODSTriggerAgendaConversionFailureV1"));this.Xb.blockContent(this.ta.presentation,"ApplyAgenda",!0)}Nol(){for(let t of this.Z7)t&&t.lol();this.DQe(Object(n.a)(this,this.jmk,"onPODSTriggerAgendaConversionSuccessV2"),Object(n.a)(this,this.hmk,"onPODSTriggerAgendaConversionFailureV2"))}gol(){this.DQe(Object(n.a)(this,this.kmk,"onPODSTriggerAgendaConversionSuccessV3"),Object(n.a)(this,this.KZg,"onPODSTriggerAgendaConversionFailureV3"));this.Xb.blockContent(this.ta.presentation,
"ApplyAgenda",!0)}Qcb(t,N){if(N.property===Xb.a.wWa&&this.rWc){t=Object(M.a)(404,N.node);if(t.wWa===ok.TEh)for(let ha of this.Z7)ha&&ha.nhk();else if(t.wWa===ok.UEh){for(let ha of this.Z7)ha&&ha.wWg();this.pYc=!0}this.Vab.Tm(Object(n.a)(this,this.Qcb,"onPresentationPropertyChange"));this.rWc=0}}XVi(){const t={};this.Ga.zHc&&2===this.rja&&(t.shouldGenerateThemes="true",t.themeCount="3");this.Pqb()&&(t.shouldNotConvertToGVMLBytes="true",t.shouldInsertBlankSlides="true");return of.c(t)}NVi(t){const N=
{};N.SlideCount=this.Nj().toString();N.isBlankThemeRequest=(this.KZ.t4a[t].FOi&&!this.Pqb()).toString();N.isRequestForDeckDesignerForNonBlankSlides=this.Pqb();return of.c(N)}Pqb(){return this.Ga.AHc&&(1===this.rja||0===this.rja)}fol(){this.nb.Ph();const t=this.ta.presentation;if(t){const N=this.qq.je(15);try{N.jc(t),N.$c=tb.a.qTb,t.bnb=Object.assign(new Un,{CorrelationId:this.Hsa,AgendaSlideSid:this.AA.q6b,AgendaSlideCid:this.AA.p6b})}finally{N&&N.dispose()}this.Xb.zw(t,tb.a.qTb);this.Xb.vO(t)}else this.o6c()}gxh(t){this.nb.Ph();
this.Sv.F9h(this.fYd(t));const N=this.ta.presentation;if(N){const ha=this.qq.je(15);try{ha.jc(N),ha.$c=tb.a.qTb,N.wWa=ok.SEh,this.rWc=this.qK(),this.Vab.xk(Object(n.a)(this,this.Qcb,"onPresentationPropertyChange")),N.cnb=Object.assign(new om,{DeckSuggestionId:this.fYd(t),AgendaSessionId:this.Hsa,CorrelationId:Lc.a.create().toString()})}finally{ha&&ha.dispose()}this.Xb.zw(N,tb.a.qTb);this.Xb.vO(N)}else this.o6c()}o6c(){for(let t of this.Z7)t&&t.mhk();this.Xb.vO(this.ta.presentation)}imk(){this.fol();
this.pYc=!0;for(let t of this.Z7)t&&t.wWg()}jmk(t){this.KZ.ukd=this.qK();const N=this.w9f(),ha=new D.a;if(t.Images)for(const Aa of t.Images)ha.add("data:image/jpg;base64, "+Aa);ha.add(N);gb.a.Va(t.BlankSuggestionId)&&(t.BlankSuggestionId=Lc.a.create().toString());this.KZ.L4g(t.DeckSuggestionId,t.BlankSuggestionId,ok.FUe);for(let Aa of this.Z7)Aa&&Aa.phk(ha.toArray());this.GQe(0)}kmk(){this.KZ.ukd=this.qK();this.KZ.L4g(null,Lc.a.create().toString(),ok.FUe);this.GQe(0)}GQe(t){this.Pqb()?this.lxh(t,
Object(n.a)(this,this.mmk,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(n.a)(this,this.KZg,"onPODSTriggerAgendaConversionFailureV3")):this.lxh(t,Object(n.a)(this,this.lmk,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(n.a)(this,this.LZg,"onPODSTriggerAgendaDeckSuggestionFailure"))}lxh(t,N,ha){if(this.KZ.ukd<this.KZ.vkd)this.fxh();else if(this.Sv.mpk(t),this.Zzb=this.fYd(t),this.ePi(this.KZ.t4a[t])){var Aa=Lc.a.create().toString();this.ni.generateAgendaDeckSuggestion(this.AA.p6b,
this.AA.q6b,Aa,this.Hsa,this.Zzb,this.NVi(t),N,ha);L.a.J(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",Aa,this.Zzb)}else this.eVg(this.KZ.t4a[t].uze,this.Zzb),this.Sv.sWg(t,!0)}lmk(t){if(t.Images&&t.Images.length){var N=new D.a;for(var ha of t.Images)N.add("data:image/jpg;base64, "+ha);this.eVg(N.toArray(),t.DeckSuggestionId);if(ha=({themeIndex:t}=this.v8f(t.DeckSuggestionId)).returnValue)ha.uze=N.toArray(),ha.lUd=!0;this.Sv.sWg(t,
!1)}else this.LZg(t)}mmk(t){t.Images&&t.Images.length?this.gxh(0):this.o6c()}eVg(t,N){for(let ha of this.Z7)ha&&N===this.Zzb&&ha.ihk(t)}LZg(t){try{let N;const ha=({themeIndex:N}=this.v8f(t.DeckSuggestionId)).returnValue;ha&&(ha.lUd=!1,ha.uze=[]);this.Sv.hhk(N);if(this.Zzb!==t.DeckSuggestionId)return!0}catch(N){L.a.J(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+N.message)}for(let N of this.Z7)N&&N.vWg();return!0}JZg(){this.o6c();return!0}KZg(t){return this.JZg(t)}hmk(){const t=
this.w9f(),N=new D.a;N.add(t);for(let ha of this.Z7)ha&&(ha.ohk(N.toArray()),ha.vWg());return!0}w9f(){const t=this.Sb.XH(0);return this.Ie.nZ(t.Bb).image.src}zQa(t,N){try{this.AA||(this.AA=new pm);let ha=!1;N?this.AA.ABj(t.id)&&(this.Wkh(!1,this.rja),ha=!0):(this.AA.g0k(t),this.AA.G3k(t),this.AA.c0k(t),this.AA.f0k(t),this.AA.d0k(t),this.AA.e0k(t),this.zmh(),this.AA.wPj()&&(this.Wkh(!0,this.rja),this.AA.v3k(t)));if(!(0>=this.Z7.count))for(let Aa of this.Z7)try{Aa&&(ha?window.setTimeout(()=>{Aa.dVg()},
100):Aa.dVg())}catch(Ra){L.a.J(512496857,813,10,"Exception message: "+Ra.message)}}catch(ha){L.a.J(512496856,813,10,"Exception message: "+ha.message)}}fKk(t){t&&this.Z7.add(t)}Yrl(t){this.Z7.remove(t)}Wkh(t,N){this.$Hg=this.Ga.AHc?t:t&&0!==N}I$f(){return this.$Hg&&!this.pYc}xwe(t){this.pYc=!t}Nj(){return this.ta.presentation.xIa+this.AA.Kme}zmh(){this.rja=this.wfj();this.Sv.zSk(Zg[this.rja]);this.jSk()}jSk(){this.Pqb()?this.Sv.xEe("V3"):1!==this.rja||this.Ga.AHc?2===this.rja&&this.Ga.zHc&&this.Sv.xEe("V2"):
this.Sv.xEe("V1")}wfj(){try{const t=this.Sb.TH();if(t&&0<t.length)for(const N of t)if(N){const ha=N.ThemeFamilyId;if(this.Ga.zHc&&ha.toLowerCase()===ok.eFh.toLowerCase())return 2;if(0<=Array.indexOf(this.Ga.t7h,ha))return 1}return 0}catch(t){return L.a.J(512496855,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+t.message),0}}fYd(t){return this.KZ.t4a[t].kUf}v8f(t){let N;N=0;for(const ha of this.KZ.t4a){if(ha.kUf===t)return{returnValue:ha,themeIndex:N};N++}L.a.J(512496854,
813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+t);return{returnValue:null,themeIndex:N}}ePi(t){return t?!t.lUd:(L.a.J(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),!1)}dispose(){this.Vab.Tm(Object(n.a)(this,this.Qcb,"onPresentationPropertyChange"));this.rWc=0}qK(){return(new Date).getTime()}}ok.FUe=4;ok.eFh="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";ok.UEh=1;ok.TEh=2;ok.SEh=0;Object(h.a)(ok,
"AgendaConverterManager",null,[106]);class Vn{constructor(t,N,ha){this.Sv=t;this.Qc=N;this.oN=ha;this.dw()}dw(){this.Qc.Lzc(Object(n.a)(this,this.Fla,"onUndoRedo"))}dispose(){this.Qc.Dcd(Object(n.a)(this,this.Fla,"onUndoRedo"))}w1b(t,N){t===tb.a.qTb&&(this.Sv.xwe(N),this.oN.xwe(N))}Fla(t,N){this.w1b(N.XRe,N.T8a)}}Object(h.a)(Vn,"AgendaConverterUndoRedoController",null,[798]);var qm=d(77);class Pl{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=null;this.maxTryAgainCount=0}}Object(h.a)(Pl,
"IAgendaSettings",null,[]);class ni{constructor(t,N,ha,Aa,Ra){this.FJf="HighConfidenceAgendaDetected";this.zy=null;this.va=new qm.a;this.lWc=null;this.U3c=0;this.la=ha;this.Ls=N;this.Fa=Ra;this.zy||(N=new Pl,N.isEntryState=!0,N.pptAppFrameDomElement=this.Ls.kG(),N.maxTryAgainCount=this.la.UDf,this.zy=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(N));this.Zhl();this.oN=t;this.la&&this.la.yHc&&this.oN.fKk(this);this.Sv=Aa;this.v9a=!1}dVg(){this.oN&&(this.oN.I$f()?(this.Sv.iSk(this.oN.AA.Poe),
this.Bph(this.lWc),1===this.oN.AA.Poe&&this.va.raiseEvent(this.FJf,null)):this.T3d())}lol(){this.zy&&(this.Sv.jhk(),this.zy.showAgendaToPptDialog(this.oN.Nj()),this.Fa.cQc(hd.a.TDf,hd.a.gj,document.getElementById("AgendaToPptDialogHostElement")),this.Fa.Gj(hd.a.TDf,!0),this.v9a=!0)}wWg(){this.T3d();this.Sv.lhk();window.setTimeout(()=>{this.tol()},8E3)}phk(t){this.Hqh(t);this.Sv.tWg(!0)}ohk(t){this.Hqh(t);this.Sv.tWg(!1)}ihk(t){this.zcl(t)}mhk(){this.U3c>=this.la.UDf?this.zy.showAgendaToPptDismissCard():
(this.U3c+=1,this.zy.showAgendaToPptFailureCard());this.Sv.rZg()}vWg(){this.zy&&this.v9a&&this.zy.showSlidePreviewError()}nhk(){this.zy.showMergeSlidesError();this.Sv.rZg()}Bph(t){this.la.yHc&&(this.GHe(t),this.zy&&this.lWc&&this.oN&&this.oN.I$f()&&(this.zy.showAgendaCard(this.lWc,this.oN.AA.Kme),this.Sv.ghk()))}T3d(){L.a.J(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");this.zy&&!this.v9a&&(this.zy.hideAgendaCard(),this.GHe(null))}Hqh(t){this.zy&&this.v9a&&this.zy.populateThemesInAgendaDialog(t)}zcl(t){this.zy&&
this.v9a&&this.zy.populatePreviewSlidesInAgendaDialog(t)}GHe(t){this.lWc=t}tol(){if(this.la.gxk)try{const t=u.a.instance.La("Common.ISystemInitiatedFeedback");t&&(L.a.J(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),t.execute(N=>{N.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(t){L.a.J(562422278,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",t)}}Zhl(){this.zy.on(ni.VEh,
()=>{this.o7h()});this.zy.on(ni.YEh,()=>{this.r7h()});this.zy.on(ni.WEh,()=>{this.p7h()});this.zy.on(ni.XEh,()=>{this.q7h()});this.zy.on(ni.bFh,t=>{this.n7h(t)});this.zy.on(ni.ZEh,t=>{this.SDf(t,!1)});this.zy.on(ni.$Eh,()=>{this.s7h()});this.zy.on(ni.aFh,t=>{this.SDf(t,!0)})}o7h(){this.Fsh()}r7h(){this.Sv.opk();this.Fsh()}p7h(){this.RDf();this.Sv.bXg()}q7h(){this.RDf();this.Sv.ljk()}RDf(){this.cleanup();this.oN.Yrl(this)}Fsh(){this.oN.fxh()}n7h(t){this.oN.GQe(t)}SDf(t,N){this.Sv.khk(t,N);this.v9a=
!1;this.zy.hideAgendaToPptDialog();this.oN.gxh(t)}s7h(){this.v9a=!1;this.zy.hideAgendaToPptDialog();this.Sv.bXg()}cleanup(){this.GHe(null);this.U3c=0;this.zy.cleanup()}U3h(t){this.va.addHandler(this.FJf,t)}}ni.VEh="AgendaCardAddSlides";ni.YEh="AgendaCardTryAgain";ni.WEh="AgendaCardCancel";ni.XEh="AgendaCardDismiss";ni.bFh="AgendaToPptDialogThemeSuggestionSelected";ni.ZEh="AgendaToPptDialogApply";ni.$Eh="AgendaToPptDialogCancel";ni.aFh="AgendaToPptDialogMergeTryAgain";Object(h.a)(ni,"AgendaConverterView",
null,[799,815]);var un=d(663);class Io{constructor(){this.s$b={}}Qhd(t){this.s$b[t]=new un.a(t,!0)}xHb(t){if(t in this.s$b){var N=this.s$b[t];N.stop();N=N.gHc;delete this.s$b[t];return N}return-1}Mwe(t){return t in this.s$b}}Object(h.a)(Io,"AgendaPerfLogger",null,[]);class lh{constructor(){this.iSc=this.Mqg=this.Oqg=this.Nqg=!1}xXj(){this.iSc&&!this.Nqg&&(this.Nqg=!0,Eb.b(lh.Gfi))}ZXj(){this.iSc&&!this.Oqg&&(this.Oqg=!0,Eb.b(lh.Hfi))}yWj(){this.iSc&&!this.Mqg&&(this.Mqg=!0,Eb.b(lh.Ffi))}static zVj(t){t&&
t.xS&&Eb.b(lh.Efi)}}lh.Gfi="WAC_Exp_AgendaToPPTHighConfidenceSeen";lh.Hfi="WAC_Exp_AgendaToPPTHighConfidenceTried";lh.Ffi="WAC_Exp_AgendaToPPTHighConfidenceKept";lh.Efi="WAC_Exp_AgendaToPPTIsCreateNew";Object(h.a)(lh,"ExperimentationMetrics",null,[]);class pk{constructor(){this.Bfe=this.afe=this.gde=this.Hsa=null;this.Pge=!1;this.jFg=this.lCg=this.XPg=this.Ga=null;this.dqe="";this.Sge=!1;this.fde=""}reset(){this.XPg={};this.lCg=new Io;this.jFg=new lh;this.dqe="";this.Sge=!1;this.fde="";this.Bfe=this.afe=
this.gde=this.Hsa=null;this.Pge=!1}get telemetryData(){return this.XPg}get qIc(){return this.jFg}get v6(){return this.lCg}get kd(){return this.Ga}set kd(t){this.Ga=t}get mjd(){return this.dqe}set mjd(t){this.dqe=t}get iPa(){return this.Sge}set iPa(t){this.Sge=t}get aP(){return this.fde}set aP(t){this.fde=t}get WU(){return this.Hsa}set WU(t){this.Hsa=t}get aG(){return this.gde}set aG(t){this.gde=t}get XR(){return this.afe}set XR(t){this.afe=t}get documentOpenType(){return this.Bfe}set documentOpenType(t){this.Bfe=
t}get a3b(){return this.Pge}set a3b(t){this.Pge=t}}Object(h.a)(pk,"AgendaMetricsState",null,[]);var aq=d(751);class pf{constructor(t,N){if(!t)throw Error.argumentNull("AgendaThemetype is null");if(!N)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.Zsa=new aq.a;this.Zsa.Fga(Object.assign(new I.a,{name:"AgendaThemeType",string:t}));this.Zsa.Fga(Object.assign(new I.a,{name:"AgendaFlowVersion",string:N}))}H4(t){gb.a.Va(t)||this.Zsa.Fga(Object.assign(new I.a,{name:"AgendaSessionId",string:t}));
return this}afd(t){this.Zsa.Fga(Object.assign(new I.a,{name:"AgendaThemeIndexSelected",int64:t}));return this}hfb(t){gb.a.Va(t)||this.Zsa.Fga(Object.assign(new I.a,{name:"AgendaCardState",string:t}));return this}VHa(t){gb.a.Va(t)||this.Zsa.Fga(Object.assign(new I.a,{name:"AgendaDialogState",string:t}));return this}LXa(t){gb.a.Va(t)||this.Zsa.Fga(Object.assign(new I.a,{name:"AgendaButtonClickedType",string:t}));return this}Ofd(t){gb.a.Va(t)||this.Zsa.Fga(Object.assign(new I.a,{name:"AgendaSeenTriedKept",
string:t}));return this}b0(t){gb.a.Va(t)||this.Zsa.Fga(Object.assign(new I.a,{name:"DocumentOpenType",string:t}));return this}build(){return this.Zsa.dataFields}}Object(h.a)(pf,"AgendaToPptActivityDataPointBuilder",null,[]);class ei{constructor(){this.Rc=null;this.cVa=new un.a("AgendaToPpt",!1);this.KJe()}KJe(){this.Rc=new pk;this.Rc.reset();this.Rc.telemetryData.Flights="";v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",
!1)&&(this.Rc.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Rc.telemetryData.InitialUserThemeType=this.Rc.aP}qjk(t){t&&(this.Rc.kd=t,this.Rc.documentOpenType=ei.N1i(t),lh.zVj(this.Rc.kd),this.Rc.telemetryData.IsDocumentOpenTypeCreateNew=this.Rc.kd.xS.toString())}uWg(t,N){if(this.Rc.v6.Mwe("AgendaToPptDialogThemeApply")&&"V2"===this.Rc.aG){var ha=this.Rc.v6.xHb("AgendaToPptDialogThemeApply");this.Rc.telemetryData.TotalTimeTakenToMerge=ha.toString();Eb.a(ei.dV,t,ha,N)}else this.Rc.v6.Mwe("OnAddSlidesClicked")?
(ha=this.Rc.v6.xHb("OnAddSlidesClicked"),this.Rc.telemetryData.TotalTimeTakenToMerge=ha.toString(),Eb.a(ei.dV,t,ha,N)):this.Rc.v6.Mwe("OnTryAgainClicked")&&(ha=this.Rc.v6.xHb("OnTryAgainClicked"),this.Rc.telemetryData.TotalTimeTakenToMerge=ha.toString(),Eb.a(ei.dV,t,ha,N));this.Rc.a3b=!1}ghk(){this.Rc.a3b=!1;if(!("Seen"in this.Rc.telemetryData)){this.YL("OnAgendaCardShown");this.cVa.start();this.Rc.telemetryData.Seen="true";L.a.J(576746627,813,50,"AgendaCard shown");const t=(new pf(this.Rc.aP,this.Rc.aG)).hfb("AgendaCardShown").Ofd("Seen").b0(this.Rc.documentOpenType).build();
Eb.a(ei.dV,!0,0,t);this.Rc.qIc.xXj()}}Qgk(){this.Rc.a3b?this.aYj():this.PUj()}PUj(){this.YL("OnAddSlidesClicked");this.cVa.stop();this.Rc.telemetryData.Tried="true";this.Rc.v6.Qhd("OnAddSlidesClicked");L.a.J(576746628,813,50,"AgendaCard tried in MS:{0}",this.cVa.gHc);const t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).hfb("AgendaCardShown").LXa("AddSlides").Ofd("Tried").b0(this.Rc.documentOpenType).build();Eb.a(ei.dV,!0,this.cVa.gHc,t);this.Rc.qIc.ZXj()}lhk(){this.YL("OnAgendaToPPTApply");this.Rc.iPa=
!0;this.Rc.telemetryData.Kept="true";this.Rc.telemetryData.Event="AgendaCompleted";const t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).hfb("AgendaCompleted").b0(this.Rc.documentOpenType).build();this.uWg(!0,t);L.a.J(572842050,813,50,"AgendaToPPT Completed successfully")}opk(){this.Rc.a3b=!0;this.YL("OnTryAgainClicked");this.Rc.telemetryData.Tried="true";this.Rc.telemetryData.Event="AgendaTryAgain";this.Rc.v6.Qhd("OnTryAgainClicked");L.a.J(556561858,813,50,"AgendaCard retry attempt")}aYj(){const t=
(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).hfb("AgendaMergeError").LXa("TryAgain").Ofd("Tried").b0(this.Rc.documentOpenType).build();Eb.a(ei.dV,!0,0,t)}jhk(){this.YL("OnAgendaDialogShown");this.Rc.XR="Loading";L.a.J(556602440,813,50,"AgendaDialog shown");const t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).VHa(this.Rc.XR).b0(this.Rc.documentOpenType).build();Eb.a(ei.dV,!0,0,t)}tWg(t){this.YL("OnAgendaThemePaneLoadedSuccess");this.Rc.XR=t?"ThemeSuggestions":"ThemeSuggestionsFailure";t=this.Rc.v6.xHb("OnAddSlidesClicked");
this.Rc.telemetryData.ThemePaneLoadingTime=t.toString();const N=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).VHa(this.Rc.XR).b0(this.Rc.documentOpenType).build();Eb.a(ei.dV,!0,t,N)}F9h(t){this.YL("ThemeDeckSuggestionId");this.Rc.telemetryData.SelectedDeckSuggestionId=t}mpk(t){"V2"===this.Rc.aG&&(this.YL("OnTriggerDifferentThemeWorkflow"),this.Rc.XR="ThemeSuggestions",this.Rc.v6.Qhd("TriggerDeckLevelDesigner_"+t),t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).VHa(this.Rc.XR).afd(t).LXa("ThemeSelected").b0(this.Rc.documentOpenType).build(),
Eb.a(ei.dV,!0,0,t))}sWg(t,N){this.YL("OnAgendaDeckPreviewLoaded");this.Rc.XR=N?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";N=this.Rc.v6.xHb("TriggerDeckLevelDesigner_"+t);this.Rc.telemetryData["DeckPreviewLoadTime_"+t]=N.toString();t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).VHa(this.Rc.XR).afd(t).b0(this.Rc.documentOpenType).build();Eb.a(ei.dV,!0,N,t)}hhk(t){const N=this.Rc.v6.xHb("TriggerDeckLevelDesigner_"+t);this.YL("OnAgendaDeckPreviewError");this.Rc.XR="AgendaDeckPreviewError";
let ha="";"DeckPreviewFailure"in this.Rc.telemetryData&&(ha=this.Rc.telemetryData.DeckPreviewFailure.toString());this.Rc.telemetryData.DeckPreviewFailure=ha+t.toString()+";";t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).VHa(this.Rc.XR).afd(t).b0(this.Rc.documentOpenType).build();Eb.a(ei.dV,!1,N,t)}khk(t,N){this.YL("OnAgendaDialogThemeApply");this.Rc.XR=N?"AgendaDeckMergeError":this.Rc.XR;this.Rc.v6.Qhd("AgendaToPptDialogThemeApply");t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).afd(t).VHa(this.Rc.XR).LXa(N?
"TryAgain":"Apply").b0(this.Rc.documentOpenType).build();Eb.a(ei.dV,!0,0,t)}bXg(){this.YL("OnCancelClicked");this.Rc.iPa=!0;this.Rc.telemetryData.Kept="false";this.Rc.telemetryData.Event="AgendaCancelled";L.a.J(572842051,813,50,"AgendaToPPT clicked Cancel button");const t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).LXa("Cancel").b0(this.Rc.documentOpenType);"V2"===this.Rc.aG?t.VHa(this.Rc.XR):t.hfb("AgendaMergeError");Eb.a(ei.dV,!0,0,t.build())}ljk(){this.YL("OnDismissClicked");this.Rc.iPa=!0;
this.Rc.telemetryData.Kept="false";this.Rc.telemetryData.Event="AgendaDismissed";L.a.J(556607430,813,50,"AgendaToPPT clicked Dismiss button");const t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).LXa("Dismiss").b0(this.Rc.documentOpenType);"V2"===this.Rc.aG?t.VHa(this.Rc.XR):t.hfb("AgendaMergeError");Eb.a(ei.dV,!0,0,t.build())}rZg(){this.YL("OnMergingErrorInAgenda");this.Rc.iPa=!0;this.Rc.telemetryData.Kept="false";this.Rc.telemetryData.Event="AgendaError";const t=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).b0(this.Rc.documentOpenType);
"V2"===this.Rc.aG?(this.Rc.XR="AgendaMergeError",t.VHa("AgendaMergeError")):t.hfb("AgendaMergeError");this.uWg(!1,t.build())}xwe(t){let N=!1;this.YL("OnUndoRedoClicked");let ha=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).b0(this.Rc.documentOpenType);if("Kept"in this.Rc.telemetryData){this.Rc.telemetryData.Kept=(!t).toString();const Aa=t?"UndoClicked":"RedoClicked";this.Rc.telemetryData.Event=Aa;ha=ha.LXa(Aa)}else N=!0,ha.LXa("UndoRedoPostAgendaKept");Eb.a(ei.dV,!0,0,ha.build());L.a.J(576746629,
813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!t).toString(),N.toString())}oSk(t){this.YL("ReportCorrelationID");this.Rc.telemetryData.CorrelationId=t;this.Rc.WU=t}zSk(t){this.YL("ReportInitialUserThemeType");this.Rc.telemetryData.InitialUserThemeType=t;this.Rc.aP=t}xEe(t){this.YL("ReportAgendaToPptFlowVersion");this.Rc.telemetryData.AgendaToPptFlowVersion=t;this.Rc.aG=t}iSk(t){this.YL("ReportAgendaScore");this.Rc.telemetryData.AgendaScore=t.toString();1===t&&this.xSk()}xSk(){this.YL("ReportHighConfidenceAgendaDetected");
this.Rc.telemetryData.HighConfidenceAgendaDetected="true";this.Rc.qIc.iSc=!0}dispose(){L.a.J(576746630,813,50,"AgendaToPPTMetrics: {0}",of.c(this.Rc.telemetryData))}GSk(){if(!this.Rc.telemetryData||!bg.a.count(this.Rc.telemetryData))return"";const t=of.c(this.Rc.telemetryData);if(this.Rc.mjd===t)return"";this.Rc.mjd=t;if("Kept"in this.Rc.telemetryData){const N=(new pf(this.Rc.aP,this.Rc.aG)).H4(this.Rc.WU).Ofd("Kept").b0(this.Rc.documentOpenType).build(),ha=Boolean.parse(this.Rc.telemetryData.Kept.toString());
Eb.a(ei.dV,ha,0,N);ha&&this.Rc.qIc.yWj()}this.Rc.iPa&&(this.KJe(),this.Rc.iPa=!1);L.a.J(572663111,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",this.Rc.mjd,this.Rc.iPa.toString());return t}YL(t){this.Rc.telemetryData||(L.a.J(574665996,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",t),this.KJe())}static N1i(t){return t.xS?"NewDocument":t.sSa?"ViewOnlyDocument":"EditDocument"}}ei.dV="AgendaToPptEvents";Object(h.a)(ei,"AgendaMetrics",null,[797]);class jj{constructor(){this.Ga=
this.K=null;this.gNg=!0;this.kCg="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.oN=null}get name(){return"PowerPointWebEditor.AgendaConverter"}Wb(t){this.K=t;this.K.register(797,"PowerPointWebEditor.IAgendaMetrics").ma().na(()=>new ei);this.K.register(ok,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").ma().na(()=>new ok(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(7)));this.K.register(798,
"PowerPointWebEditor.IAgendaConverterUndoRedoController").ma().na(()=>new Vn(this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.K.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");const N=Gm.a(this.K);gd.a("AgendaToPPT.DisableLocalizedStrings")?N("agendaConverter").then(()=>{this.K.register(799,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>
new ni(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{}):N("powerpoint-agenda-to-ppt-strings").then(()=>{N("agendaConverter").then(()=>{this.K.register(799,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>
new ni(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{})}).catch(()=>{})}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(n.a)(this,this.eKk,"registerAgendaDetectionEventHandler"))}dispose(){}eKk(){this.Ga=
this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.oN=this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const t=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Ga.VJi&&this.gNg&&2===t.mode&&(this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(N=>{N.xmb(this.kCg);N.gKk(this.kCg,Object(n.a)(this.oN,this.oN.zQa,"handleAnnotationEvent"))}),this.gNg=!1)}static main(){e.a.instance.Ac(new jj)}}Object(h.a)(jj,"AgendaConverterPackage",
null,[2,3]);var Vm=d(664);class to{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd){this.k6b=0;this.ia=t;this.Nb=N;this.la=ha;this.Fa=Aa;this.fe=Ra;this.ra=yb;this.vm=Sb;this.GD=uc;this.ou=Zc;this.Op=ed;this.tua=Gd}ub(){this.ZYh();this.la.Hzk&&this.r1f()&&this.tua.continueWith(()=>{this.tua.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}ZYh(){this.ia.pa(tb.a.DDb,sb.a.application,Object(n.a)(this,this.DDb,"presentToTeams"),4);this.ia.pa(tb.a.d6g,sb.a.application,Object(n.a)(this,
this.DDb,"presentToTeams"),4);this.ia.pa(tb.a.sze,sb.a.application,Object(n.a)(this,this.DDb,"presentToTeams"),4)}Khh(){this.ou.hide();this.sVd()}sVd(){let t;zk.a.ykd();t=this.Dqk();this.showDialog();return t}Dqk(){this.Op.o4b=!0;const t=Lc.a.create().toString(),N=this.fe.documentUrl;try{const Aa={};Aa.pptSharingUrl=Vm.b(N);const Ra=encodeURIComponent(qe.c(Aa));let yb=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}","1",t,Ra);if(!gb.a.Va(null)){const Sb=jb.a.TE(null);yb=yb+
"&fqdn="+Sb;const uc=encodeURIComponent(qe.c({joinUrl:null}));yb=yb+"&meetingContext="+uc}var ha=yb;m.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.k6b,t);window.open(ha,"_top")}catch(Aa){return m.ULS.sendTraceTag(523084876,838,15,"PresentToTeamsActor: failed with error: {0}",Aa),!1}return!0}showDialog(){const t=new Fa.StandardDialog;t.vd=4;t.Re(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);t.Re(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);t.Yw(ResourceStrings.l_PresentingFileInTeamsTitle,
ResourceStrings.l_PresentingFileInTeamsMessage,0,Object(n.a)(this,this.Sfc,"protocolLaunchingDialogResultHandler"))}Sfc(t){1===t||0===t?(m.ULS.sendTraceTag(523084877,838,50,"PresentToTeamsActor - restarting PPT session"),this.oXa()):2===t&&(m.ULS.sendTraceTag(523084878,838,50,"PresentToTeamsActor - retry present to teams"),this.ia.processAction(tb.a.sze,2))}oXa(){this.ia.Ka(tb.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}r1f(){return!!this.fe.documentUrl}DDb(t,N,ha){if(!this.r1f())return m.ULS.sendTraceTag(523084879,
838,10,"PresentToTeamsActor: Document not supported"),8;if(1===ha)return 32;this.k6b=t;if(this.vm.isPaused)return this.Fa.Ad(),this.sVd()?32:8;this.ra.Ph();this.Fa.Ad();if(t===tb.a.sze||1===this.Nb.mode)return this.sVd()?32:8;this.GD.f2(!0,!0,()=>{this.Khh()},()=>{m.ULS.sendTraceTag(523084880,838,15,"PresentToTeamsActor: ForceSave failed");this.Khh();return!0});this.ou.show(!1,this.k6b);return 32}B9(){}z9(){}}Object(h.a)(to,"PresentToTeamsActor",null,[156]);class Wm{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PresentToTeams"}Wb(t){this.K=
t}init(){v.AFrameworkApplication.fa.ff(()=>{(new to(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
this.K.resolve("PowerPointWebEditor.IApplicationContext"),jg.a.vu(u.a.instance.La("Common.ISystemInitiatedFeedback")))).ub()})}dispose(){}static main(){e.a.instance.Ac(new Wm)}}Object(h.a)(Wm,"PPTWebEditorPresentToTeamsPackage",null,[2,3]);var Ql=d(715),Lj=d(22);class Ri{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=0}}Object(h.a)(Ri,"DesignerSuggestionApplyInfo",null,[]);var Mj=d(328),Qk=d(517),vn=d(107);class hp{constructor(){this.DAc=
null}}Object(h.a)(hp,"IdeasSlideSuggestionWrapper",null,[]);var rm=d(106);class El{constructor(){this.trigger=null;this.cid=this.sid=0;this.MP=null;this.timestamp=new Date;this.correlationId=Lc.a.create().toString()}}Object(h.a)(El,"DesignerRequestData",null,[]);var wn=d(193);class Yn{}Object(h.a)(Yn,"SlideSuggestionData",null,[]);class td{}td.adk="mivTitle";td.$ck="mivSubtitle";td.i5c="mivContainer";td.Zck="mivButtonsContainer";td.fTg="mivButton";td.Yck="mivButtonImage";td.cBb="mivOverlayContainer";
td.Yre="mivIcon";td.dBb="mivTerm";td.hTg="mivFrame";td.bdk="mivView";td.iTg="mivIdx";td.$re="mivKeepFocusStart";td.Zre="mivKeepFocusEnd";td.LYf="Editor";td.DSd="EditorContainer";td.GJi="EditorTitle";td.CJi="EditorSubtitleContainer";td.NYf="EditorSubtitle";td.qJi="EditorBucketContainer";td.Q4a="EditorPrev";td.cYb="EditorPrevDisabled";td.oqb="EditorPrevEnabled";td.CSd="EditorBucketCurrent";td.rJi="EditorBucketTotalCount";td.CYf="EditorBucketTotal";td.mqb="EditorNext";td.nqb="EditorNextEnabled";td.bYb=
"EditorNextDisabled";td.tJi="EditorDescription";td.wJi="EditorIgnoreContainer";td.aYb="EditorIgnore";td.AJi="EditorSeeMoreContainer";td.eYb="EditorSeeMoreLabel";td.DYf="EditorCardContent";td.QYf="EditorSuggestionsContainer";td.MOa="EditorSuggestionContainer";td.oHc="EditorSuggestionArrow";td.DJi="EditorSuggestionCheck";td.PYf="EditorSuggestionText";td.OYf="EditorSuggestionInstances";td.xJi="EditorNoMoreContainer";td.EJi="EditorSvgCheck";td.HJi="EditorWhiteCheck";td.vJi="EditorGreenFill";td.uJi="EditorGreenBorder";
td.yJi="EditorNoMoreLabel";Object(h.a)(td,"IdeasCss",null,[]);class Kd{}Kd.l2b="IdeasPane";Kd.LOa="editorSuggestionIdx";Kd.bK="ClosePane";Kd.ytj="IdeasPaneOpen";Kd.Hbc=6;Kd.vbk=3;Kd.wUf="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(h.a)(Kd,"IdeasPaneConstants",null,[]);class Pd{}Pd.Amc="ToolbarButton";Pd.BIb="ToolbarButtonHome";Pd.insertPicture="InsertPicture";Pd.zMe="SlideNavigationDesignMode";Pd.Ieb="Retrigger";Pd.refresh="Refresh";Pd.typing="Typing";Pd.vVf="DesignElementsDeleted";
Pd.BLd="ChangeSlideSize";Pd.tnb="ApplyTheme";Pd.uMe="SlideChangeLayout";Pd.oGa="NewSlide";Pd.rLd="ChangeIconInSmartArt";Pd.Fob="ChangeIcon";Pd.insertTable="InsertTable";Pd.sva="PasteTable";Pd.mQc="InsertChart";Pd.OHd="ApplyReplaceObject";Pd.moreIdeas="MoreIdeas";Pd.newDocument="NewDocument";Pd.YQd="DesignTab";Pd.makeItVisual="MakeItVisual";Pd.RGa="PasteText";Pd.XNd="ConvertedToPPT";Pd.cHd="AgendaToPPT";Object(h.a)(Pd,"DesignerTrigger",null,[]);var ad=d(173);class ae{constructor(t,N,ha,Aa,Ra,yb,Sb){this.C8b=
null;this.ta=t;this.yc=N;this.la=ha;this.Ob=Aa;this.X1c=(t=this.la.useWideSuggestionThumbs)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.Y1c=t?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.yb=Ra;this.fe=yb;this.xwb=Sb}xtk(t){const N=[];try{if(!t||!t.SlideSuggestions)return L.a.J(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),N;for(let ha=0;ha<t.SlideSuggestions.length;ha++){if(!t.SlideSuggestions[ha])continue;
const Aa=t.SlideSuggestions[ha].Base64Img;let Ra=null;try{Ra=Object.assign(new Yn,{suggestionIndex:t.SlideSuggestions[ha].Index.toString(),suggestionCid:t.SlideSuggestions[ha].SlideId.Cid.toString(),suggestionSid:t.SlideSuggestions[ha].SlideId.Sid.toString(),imageData:Aa.startsWith("data:image")?Aa:"data:image/png;base64,"+Aa,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ha+1)})}catch(yb){L.a.J(510248777,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),
Ra=null}Ra||(Ra=Object.assign(new Yn,{suggestionIndex:t.SlideSuggestions[ha].Index.toString(),suggestionSid:t.SlideSuggestions[ha].SlideSid.toString(),imageData:Aa.startsWith("data:image")?Aa:"data:image/png;base64,"+Aa,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ha+1)}));Array.add(N,Ra)}}catch(ha){L.a.J(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",ha)}return N}q1i(t,N,ha){if(!t)throw Error.argumentNull("suggestionsContainer");
return t.querySelector("#"+N+" ."+ae.tNa+'[correlationId="'+ha+'"]')}K1d(){return this.la.YEi?this.la.XEi:this.la.WEi}SPc(t){if(!this.la.designerIncrementalRenderEnabled)return!1;let N=!0;switch(t){case Pd.moreIdeas:N=!1;break;case Pd.newDocument:N=!1}return N}iEe(t){L.a.J(510248775,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Ob.correlationId,t.u5a);if(t.Tpb&&t.pIc&&t.Jea){var N=this.g7d(),ha=t.Jea.parentNode.parentNode.id;if(t.gMe&&this.la.wOa&&t.u5a)switch(t.Tpb.DocumentUpsellStatus){case 0:this.s1h(t.Jea);
break;case 1:this.N_h(t.Jea);break;case 2:this.v_h(t.Jea)}t.u5a&&this.la.yHc&&this.Idh(t.Jea);var Aa;if(Aa=t.u5a?this.zwi(t.pIc,t.Fh,t.Jea,N,t.amd):this.q1i(t.Jea,ha,t.Fh))try{const yb=this.Ob.yNa,Sb=!$e.a.Va(yb)&&ha===Kd.l2b,uc=this.Sei(t.Tpb,Sb,yb);if(t.u5a){this.Ob.MPe=new Date;t.amd&&this.Agl(t.BNi);for(var Ra=0;Ra<Aa.childNodes.length;Ra++){let Zc=Aa.childNodes[Ra];t.amd&&this.C$k(uc,Ra)?ae.Sbl(N,Ra,Zc):this.eEe(Sb?yb[Ra].Type:0,t.Jea,Zc,ha,t.pIc,uc[Ra.toString()],Ra,t.gMe,t.Tpb.DocumentUpsellStatus)}this.la.Aha&&
t.Tpb.HasPaginationInfo&&this.rqh(t.Jea,t.Fh)}else if(t.amd){L.a.J(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",this.Ob.correlationId,bg.a.count(uc));for(Ra of Object.keys(uc)){const Zc=parseInt(Ra);let ed=t.Jea.querySelector("#"+ha+" ["+ae.Sza+'="'+Zc+'"]');uc[Ra]&&ed&&Sys.UI.DomElement.containsCssClass(ed.firstChild,"IncSuggestionPlaceholder")&&this.eEe(Sb?yb[Zc].Type:0,t.Jea,ed,ha,t.pIc,uc[Ra],Zc,t.gMe,t.Tpb.DocumentUpsellStatus)}}}catch(yb){L.a.J(510248773,
829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Ob.correlationId,yb)}}}sRk(t,N,ha,Aa){try{if(!(t&&t.SlideSuggestions&&t.SlideSuggestions.length&&N))return!1;this.iPc(N);const Ra=N.querySelector("."+ae.tNa);if(!Ra)return!1;const yb=Ra.childNodes.length,Sb=Ra.childNodes.length+t.SlideSuggestions.length,uc=this.g7d(),Zc=N.parentNode.parentNode.id;for(let ed=0;ed<t.SlideSuggestions.length;++ed){const Gd=this.CRf(yb+ed,Sb,uc);this.eEe(0,N,Gd,Zc,Sb,t.SlideSuggestions[ed],
yb+ed,Aa,t.DocumentUpsellStatus);Ra.appendChild(Gd)}t.HasPaginationInfo&&this.rqh(N,ha);return!0}catch(Ra){return L.a.J(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",Ra),!1}}Sei(t,N,ha){const Aa={};if(N)for(const Ra of ha)switch(Ra.Type){case 0:N=Ra;ha=null;for(const yb of t.SlideSuggestions)if(yb.Index===N.IndexInDesigner){ha=yb;break}Aa[Ra.Index.toString()]=ha;break;default:Aa[Ra.Index.toString()]=Ra}else for(const Ra of t.SlideSuggestions)Aa[Ra.Index.toString()]=Ra;
return Aa}C$k(t,N){N=N.toString();return!(N in t)||!t[N]}s1h(t){const N=pb.a.Ee();N.className="DesignerFreeTrialCardContainer";const ha=pb.a.Ee();ha.className="DesignerFreeTrialCardTitle";ha.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const Aa=pb.a.Ee();Aa.className="DesignerFreeTrialCardContent";Aa.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.K1d());const Ra=pb.a.Ee();Ra.className="DesignerStartFreeTrialButtonsContainer";const yb=pb.a.Ee();
yb.className=ae.eob;yb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;yb.tabIndex=0;yb.setAttribute(na.a.vs,yb.innerText);yb.setAttribute(na.a.We,na.a.Xt);const Sb=pb.a.Ee();Sb.className=ae.FBc;const uc=document.createElement("i");uc.className=ae.LBc;uc.style.lineHeight="20px";uc.setAttribute("Unselectable","on");const Zc=pb.a.Ee();Zc.className="DesignerStartTrialGoPremiumButtonText";Zc.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Zc.setAttribute("Unselectable","on");
Sb.setAttribute(na.a.vs,Zc.innerText);Sb.setAttribute(na.a.We,na.a.Xt);Sb.tabIndex=0;Sb.appendChild(uc);Sb.appendChild(Zc);Ra.appendChild(yb);Ra.appendChild(Sb);N.appendChild(ha);N.appendChild(Aa);N.appendChild(Ra);N.setAttribute(na.a.vs,String.format("{0}. {1}",ha.innerText,Aa.innerText));N.setAttribute(na.a.We,na.a.Kza);t.appendChild(N)}URf(){const t=pb.a.Ee();t.className="DesignerInFreeTrialView";const N=document.createElement("i");N.className=v.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":
"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const ha=pb.a.Ee();ha.className=ae.pUb;ha.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;ha.tabIndex=0;const Aa=pb.a.Ee();Aa.className=v.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";Aa.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;ha.setAttribute(na.a.We,na.a.AId);ha.setAttribute(na.a.wnb,na.a.Bpa);ha.setAttribute(na.a.vs,ha.innerText);t.appendChild(N);t.appendChild(ha);t.appendChild(Aa);
t.setAttribute(na.a.vs,ha.innerText+" "+Aa.innerText);t.setAttribute(na.a.We,na.a.Kza);return t}Snl(){const t=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(t)for(let N=0;N<t.length;N++){const ha=t[N];if(ha.parentNode){const Aa=this.URf();ha.parentNode.replaceChild(Aa,ha)}}this.hAh()}N_h(t){const N=this.URf();t.appendChild(N)}v_h(t){const N=pb.a.Ee();N.className="DesignerFreeTrialCardContainer";const ha=pb.a.Ee();ha.className="DesignerFreeTrialCardTitle";ha.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;
const Aa=pb.a.Ee();Aa.className="DesignerFreeTrialCardContent";Aa.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;const Ra=pb.a.Ee();Ra.className=ae.oUb;const yb=document.createElement("i");yb.className=ae.LBc;yb.style.lineHeight="20px";const Sb=pb.a.Ee();Sb.className="DesignerTrialExhaustedGoPremiumButtonText";Sb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Ra.setAttribute(na.a.vs,Sb.innerText);Ra.setAttribute(na.a.We,na.a.Xt);Ra.tabIndex=0;Ra.appendChild(yb);Ra.appendChild(Sb);
N.appendChild(ha);N.appendChild(Aa);N.appendChild(Ra);N.setAttribute(na.a.vs,String.format("{0}. {1}",ha.innerText,Aa.innerText));N.setAttribute(na.a.We,na.a.Kza);t.appendChild(N)}rqh(t,N){const ha=pb.a.Ee();ha.className=ae.rKd;ha.setAttribute(ae.dob,N);ha.tabIndex=0;N=new Vd.a;N.yh(16,16);N.mwa("0,0,2048,2048");const Aa=new ad.a;Aa.a0("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
N.appendChild(Aa);N=N.ya;N.setAttribute("class","DesignerMoreIdeasButtonIcon");ha.appendChild(N);N=pb.a.Ee();N.className="DesignerMoreIdeasButtonLabel";N.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;ha.appendChild(N);ha.setAttribute(na.a.vs,N.innerText);ha.setAttribute(na.a.We,na.a.Xt);t.appendChild(ha)}dcl(t){if(t){var N=pb.a.CB();N.className="DesignerMoreIdeasLoading";N.src=Vg.a.cK(hb.a.Sla);t.appendChild(N)}}iPc(t){if(t){var N=t.querySelector("."+ae.rKd);N&&t.removeChild(N);(N=t.querySelector(".DesignerMoreIdeasLoading"))&&
t.removeChild(N)}}zwi(t,N,ha,Aa,Ra){const yb=pb.a.Ee();yb.className=ae.tNa;yb.setAttribute(ae.dob,N);yb.setAttribute(na.a.vs,ResourceStrings.l_DesignerSuggestions);yb.setAttribute(na.a.We,na.a.ATb);Ra&&(this.Ob.BUb=this.YYi());for(N=0;N<t;++N)yb.appendChild(this.CRf(N,t,Aa));ha.appendChild(yb);return yb}CRf(t,N,ha){const Aa=pb.a.Ee();Aa.className=ha?this.X1c+"4x3":this.X1c;Aa.setAttribute(ae.Sza,t);Aa.tabIndex=0;Aa.setAttribute(na.a.vs,String.format(ResourceStrings.l_DesignerSuggestionItem,t+1));
Aa.setAttribute(na.a.We,na.a.cNa);Aa.setAttribute(na.a.CId,t+1);Aa.setAttribute(na.a.DId,N);return Aa}eEe(t,N,ha,Aa,Ra,yb,Sb,uc,Zc){let ed=null;this.la.designerIncrementalRenderEnabled&&(N&&(ed=N.querySelector("#"+Aa+' [IncSuggestionPlaceholder="'+Sb+'"]')),ed&&Sys.UI.DomElement.addCssClass(ed,"ShimmerPaused"),this.tWj(Sb,Ra));N=!1;switch(t){case 0:this.E5k(ha,yb,Sb);N=(t=uc&&this.la.wOa)&&1!==Zc;Ra=Aa=Zc=!1;if(yb&&yb.Categories)for(const Gd of yb.Categories)2===Gd?Zc=uc&&!t:1===Gd?Aa=!0:3===Gd?Ra=
!0:4===Gd&&this.n5d(ha,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Sb);(Zc||N)&&this.w6k(ha);Aa?this.n5d(ha,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Sb):Ra&&(this.n5d(ha,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Sb),ha.setAttribute(ae.kKd,ae.kKd),ha.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.YZh(ha,yb);break;case 1:this.qRk(ha,yb);break;case 2:this.hRk(ha);break;case 3:case 4:this.CRk(ha,yb)}ed&&ed.parentNode.removeChild(ed);yb=pb.a.Ee();yb.className=ae.QBc;N&&(yb.style.visibility=Ub.a.visible,ha.removeAttribute("tabindex"),ha.setAttribute(na.a.YJ,na.a.vB));ha.appendChild(yb)}qRk(t,N){if(N){t.className=td.i5c;t.setAttribute(na.a.vs,ResourceStrings.L_MakeItVisualCardTitle);var ha=pb.a.zn();ha.className=td.adk;ha.innerText=ResourceStrings.L_MakeItVisualCardTitle;var Aa=pb.a.zn();
Aa.className=td.$ck;Aa.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Ra=pb.a.Ee();Ra.className=td.Zck;Ra.setAttribute(na.a.We,na.a.ATb);var yb=0,Sb=new ef.a,uc=Math.min(Kd.Hbc,N.SearchTerms.length);for(let Zc=0;Zc<uc;Zc++)yb=this.jSf(N.SearchTerms[Zc].Term,Ra,Sb,Zc,yb);for(N=uc;N<Kd.Hbc;N++)for(const Zc of Kd.wUf)if(!Sb.contains(Zc)){yb=this.jSf(Zc,Ra,Sb,N,yb);break}t.appendChild(ha);t.appendChild(Aa);t.appendChild(Ra);this.Ob.C4c=!0}}jSf(t,N,ha,Aa,Ra){const yb=pb.a.Ee();yb.className=td.fTg;
yb.setAttribute(na.a.We,na.a.cNa);const Sb=td.dBb+"."+Aa,uc=pb.a.CB();uc.className=td.Yck;uc.src=({utb:Ra}=this.H6i(t,ha,Ra)).returnValue;uc.setAttribute(na.a.y6,Sb);ha=pb.a.Ee();ha.className=td.cBb;ha.tabIndex=0;ha.setAttribute(td.iTg,Aa);ha.setAttribute(na.a.We,na.a.Xt);Aa=document.createElement("i");Aa.className=td.Yre;Aa.innerText="\ue721";Aa.setAttribute(na.a.We,na.a.wM);const Zc=pb.a.zn();Zc.className=td.dBb;Zc.innerText=t;Zc.id=Sb;yb.appendChild(uc);yb.appendChild(ha);ha.appendChild(Aa);ha.appendChild(Zc);
N.appendChild(yb);return Ra}H6i(t,N,ha){for(const Aa of Kd.wUf)if(Aa.toLowerCase()===t.toLowerCase())return N.add(Aa),{returnValue:this.fe.Yj(t+".png"),utb:ha};return{returnValue:this.fe.Yj("stock"+ha++ +".png"),utb:ha}}D5k(t,N){if(t){var ha=document.createElement("video");ha.className="SuggestedVideoBackgroundContainer";ha.setAttribute("Src",N);ha.setAttributeNode(document.createAttribute("muted"));wn.a.HLj()||(ha.setAttributeNode(document.createAttribute("autoplay")),ha.setAttributeNode(document.createAttribute("loop")),
ha.addEventListener("canplay",()=>{ha.muted="true";ha.play()}));t.appendChild(ha)}}n5d(t,N,ha,Aa){if(t){var Ra=pb.a.CB();Ra.src=this.fe.Yj(N);Ra.className="SuggestedMediaIcon";N=pb.a.zn();N.className="SuggestedMediaContainer";N.appendChild(Ra);t.setAttribute(na.a.vs,String.format(ha,Aa+1));N.setAttribute("aria-hidden",na.a.vB);N.setAttribute("Unselectable","on");t.appendChild(N)}}YZh(t,N){t&&N&&N.DesignDescription&&0!=N.DesignDescription.length&&t.setAttribute(na.a.vs,N.DesignDescription)}w6k(t){if(t)if(this.la.wOa)Sys.UI.DomElement.addCssClass(t,
Ub.a.Hec);else{t.setAttribute(ae.IBc,ae.IBc);var N=t.getAttribute(na.a.vs);N&&t.setAttribute(na.a.vs,String.format("{0}. {1}",N.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));na.a.lO(t,na.a.wnb,na.a.Bpa);N=pb.a.Ee();N.className=ae.PBc;var ha=document.createElement("i");ha.className=ae.LBc;N.appendChild(ha);t.appendChild(N)}}hAh(){const t=document.getElementsByClassName(ae.qUb);if(t)for(let N=0;N<t.length;N++){Sys.UI.DomElement.removeCssClass(t[N].parentNode,Ub.a.Hec);t[N].parentNode.tabIndex=
0;t[N].parentNode.removeAttribute(na.a.YJ);const ha=sa.a.uba(t[N].parentNode,ae.QBc);!ha||ha.getAttribute(ae.xKd)&&ha.getAttribute(ae.xKd).toString()===ae.WJf||(ha.style.visibility=Ub.a.hidden)}}ysl(){if(this.la.wOa){var t=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(t)for(var N=0;N<t.length;N++)t[N].parentNode.removeChild(t[N]);if(t=document.getElementsByClassName("DesignerInFreeTrialView"))for(N=0;N<t.length;N++)t[N].parentNode.removeChild(t[N]);this.hAh()}else if(t=document.getElementsByClassName(ae.PBc))for(N=
0;N<t.length;N++){t[N].style.display="none";const Aa=t[N].parentNode;Aa.removeAttribute(ae.IBc);Aa.removeAttribute(na.a.wnb);var ha=Aa.getAttribute(na.a.vs);ha&&(ha=ha.toString(),ha=ha.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),Aa.setAttribute(na.a.vs,ha))}}E5k(t,N,ha){if(t&&N)try{let Aa=!1;try{t.setAttribute(ae.gob,N.SlideId.Sid),t.setAttribute(ae.wKd,N.SlideId.Cid),Aa=!0}catch(yb){L.a.J(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),
Aa=!1}Aa||t.setAttribute(ae.gob,N.SlideSid);const Ra=pb.a.CB();Ra.className=ae.qUb;Ra.src=N.Base64Img;this.Ob.oqa.contains(N.Index)||this.Ob.oqa.add(N.Index);this.la.jGc&&!gb.a.Va(N.DesignerMediaURL)&&N.Categories&&$e.a.contains(N.Categories,1)&&this.D5k(t,N.DesignerMediaURL);t.appendChild(Ra);L.a.J(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",ha,this.Ob.correlationId)}catch(Aa){t.parentNode.removeChild(t),L.a.J(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",
ha,this.Ob.correlationId,Aa)}}hRk(t){if($e.a.Va(this.Ob.oV)||!this.Ob.psi())t.style.display=Ub.a.none;else{t.className=td.DSd;var N=pb.a.zn();N.className=td.GJi;N.innerText=ResourceStrings.L_ConsistencyCardTitle;var ha=pb.a.Ee();ha.className=td.CJi;var Aa=pb.a.zn();Aa.className=Aa.id=td.NYf;Aa.innerText=Aa.title=this.Ob.oV[0].critiques[0].explanationLabel;var Ra=pb.a.Ee();Ra.className=td.qJi;var yb=pb.a.zn();yb.innerText="<";yb.tabIndex=0;Sys.UI.DomElement.addCssClass(yb,td.Q4a);Sys.UI.DomElement.addCssClass(yb,
td.cYb);yb.id=td.Q4a;var Sb=pb.a.zn();Sb.innerText="1";Sb.id=td.CSd;this.Ob.HM=0;var uc=pb.a.zn();uc.innerText="/";var Zc=pb.a.zn();Zc.className=td.rJi;Zc.id=td.CYf;Zc.innerText=this.Ob.oV.length.toString();var ed=pb.a.zn();ed.innerText=">";ed.tabIndex=0;ed.className=ed.id=td.mqb;0<this.Ob.oV.length-1?Sys.UI.DomElement.addCssClass(ed,td.nqb):Sys.UI.DomElement.addCssClass(ed,td.bYb);Ra.appendChild(yb);Ra.appendChild(Sb);Ra.appendChild(uc);Ra.appendChild(Zc);Ra.appendChild(ed);ha.appendChild(Aa);ha.appendChild(Ra);
Aa=pb.a.zn();Aa.className=td.tJi;Aa.innerText=ResourceStrings.L_ConsistencyCardDescription;Ra=ae.FRf();this.Ohg(Ra,0);yb=pb.a.Ee();yb.className=td.wJi;Sb=pb.a.Ee();Sb.className=td.aYb;Sb.innerText=ResourceStrings.L_ConsistencyCardIgnore;Sb.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;Sb.tabIndex=0;yb.appendChild(Sb);Sb=pb.a.Ee();Sb.className=td.AJi;uc=pb.a.zn();uc.className=td.eYb;uc.innerText=ResourceStrings.L_ConsistencyCardSeeMore;uc.tabIndex=0;Sb.appendChild(uc);uc=pb.a.Ee();uc.id=td.DYf;
uc.appendChild(ha);uc.appendChild(Aa);uc.appendChild(Ra);uc.appendChild(yb);t.appendChild(N);t.appendChild(uc);t.appendChild(Sb);this.Ob.nHc=!0}}CRk(t,N){if(N){t.className=ae.eKf;t.setAttribute(na.a.vs,N.TitleText);t.setAttribute(ae.Sza,N.Index);var ha=this.fil(N.ExecutionActionName);if(ha){var Aa=pb.a.CB();Aa.src=this.fe.Yj("pegal.png");Aa.className=ha;var Ra=pb.a.zn();Ra.className="cui-img-container cui-img-24by24";Ra.appendChild(Aa);t.appendChild(Ra)}Aa=pb.a.zn();Aa.className="DesignerSuggestedActionTitle";
Aa.innerText=N.TitleText;Ra=pb.a.zn();Ra.className="DesignerSuggestedActionSubtitle";Ra.innerText=N.DescriptionText;N=pb.a.Ee();N.className=ha?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";N.appendChild(Aa);N.appendChild(Ra);t.appendChild(N)}}Idh(t){try{if(this.xwb&&this.xwb.instance){const N=pb.a.Ee();N.id="AgendaCardContainer";N.className="AgendaCardContainer";t.appendChild(N);this.xwb.instance.Bph(N)}}catch(N){L.a.J(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",
this.Ob.correlationId,N)}}cmi(){try{this.xwb&&this.xwb.instance&&this.xwb.instance.T3d()}catch(t){L.a.J(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Ob.correlationId,t)}}fil(t){switch(t){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}Ohg(t,N){N=this.Ob.oV[N].critiques[0].suggestions;const ha=Math.min(Kd.vbk,N.length);for(let Aa=0;Aa<ha;Aa++)this.noj(t,N[Aa].description,N[Aa].numberOfInstances,
Aa)}noj(t,N,ha,Aa){const Ra=pb.a.Ee();Ra.className=td.MOa;Ra.tabIndex=0;Ra.setAttribute(Kd.LOa,Aa);const yb=pb.a.zn();yb.className=td.oHc;yb.innerText="\u2192";yb.setAttribute(Kd.LOa,Aa);const Sb=pb.a.zn();Sb.className=td.PYf;Sb.innerText=N;Sb.setAttribute(Kd.LOa,Aa);N=pb.a.zn();N.className=td.OYf;N.innerText=String.format("[{0}]",ha);N.setAttribute(Kd.LOa,Aa);Ra.appendChild(yb);Ra.appendChild(Sb);Ra.appendChild(N);t.appendChild(Ra)}Agl(t){this.Zhd();this.C8b=new Y.a(2,1,this.la.designerIncrementalRenderTimeoutInMs,
()=>{this.sWj(t)},void 0,"IncrementalRenderTimeoutTask");this.yb.Gb(this.C8b)}Zhd(){this.C8b&&(this.yb.Qg(this.C8b),this.C8b=null)}sWj(t){this.Zhd();for(let N=0;N<t;N++)this.Ob.oqa.contains(N)||this.Ob.RPc.add(N)}tWj(t,N){if(!this.Ob.xNa.contains(t)&&(this.Ob.xNa.add(t),t=this.Ob.xNa.count,t===N&&(this.Ob.YSb=new Date,this.Zhd()),!this.Ob.PJb&&t>=this.Ob.BUb)){for(N=0;N<this.Ob.BUb;N++)if(!this.Ob.xNa.contains(N))return;this.Ob.PJb=new Date}}YYi(){const t=document.getElementById("WACDocumentPanel");
if(t){const N=this.la.useWideSuggestionThumbs,ha=this.g7d();return Math.floor((t.offsetHeight-87)/(N||ha?135:101))}return 1}g7d(){const t=this.Jv();return.01>=Math.abs(t.width/t.height-1.33)}VMf(t,N){this.nTe(this.yrb(t,N),N,!1)}Yjh(t,N){this.nTe(t,N,!0)}Arl(t){if(t&&(t=t.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var N=-1!==t.className.indexOf("4x3");this.nTe(t,N,!1)}}nTe(t,
N,ha){t&&(ha?(t.className=N?this.Y1c+"4x3":this.Y1c,na.a.lO(t,na.a.Z2a,na.a.vB)):(t.className=N?this.X1c+"4x3":this.X1c,na.a.lO(t,na.a.Z2a,na.a.Bpa)))}Jv(){return this.yc.Jv()}yrb(t,N){return t.querySelector("."+(N?this.Y1c+"4x3":this.Y1c))}get Ba(){return Object(M.a)(123,this.ta.Ba)}rih(t,N){if(t){if(t=t.querySelector("["+ae.Sza+'="'+N+'"]'))N=dd.a.Yh(t),t.contains(dd.a.PPa(new Sys.UI.Point(N.x,N.y)))&&t.contains(dd.a.PPa(new Sys.UI.Point(N.x+N.width-1,N.y)))?t.contains(dd.a.PPa(new Sys.UI.Point(N.x,
N.y+N.height-1)))&&t.contains(dd.a.PPa(new Sys.UI.Point(N.x+N.width-1,N.y+N.height-1)))||t.scrollIntoView(!1):t.scrollIntoView(!gd.a("Designer.ScrollIntoViewFix"))}else L.a.J(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static WQd(t){let N=null;try{N=qe.a(t)}catch(ha){L.a.J(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return N}static Tsk(t){const N=t.CardData;let ha=null;try{if(ha=qe.a(N),!t.SlideSuggestions&&
ha)for(ha=km.e(ha,Aa=>0!==Aa.Type),t=0;t<ha.length;t++)ha[t].Index=t}catch(Aa){L.a.J(510248726,829,10,"parsing cards failed with exception: {0}",Aa)}return ha}static Sbl(t,N,ha){ha.style.backgroundColor="white";const Aa=pb.a.Ee();Aa.className=t?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";Aa.setAttribute("IncSuggestionPlaceholder",N);(Pc.a.Hj||Pc.a.$f)&&Sys.UI.DomElement.addCssClass(Aa,"Shimmer");ha.appendChild(Aa)}static FRf(){const t=pb.a.Ee();t.className=
t.id=td.QYf;return t}}ae.tNa="DesignerSuggestionList";ae.dob="correlationId";ae.Sza="suggestionIndex";ae.gob="slideId";ae.wKd="slideCid";ae.IBc="isShownAsPremiumContent";ae.kKd="containsAnimation";ae.WJf="Refreshing";ae.xKd="SourceTrigger";ae.qUb="SuggestionImg";ae.LBc="ms-Icon ms-Icon--Diamond";ae.PBc="ShadowedTriangleContainer";ae.QBc="DesignerSuggestionListDisabled";ae.rKd="DesignerMoreIdeasButton";ae.eKf="DesignerSuggestedActionResult";ae.pUb="DesignerInFreeTrialViewGoPremiumText";ae.oUb="DesignerFreeTrialCardGoPremiumButton";
ae.eob="DesignerStartFreeTrialButton";ae.FBc="DesignerStartFreeTrialGoPremiumButton";Object(h.a)(ae,"DesignerViewHelper",null,[788]);class rg{constructor(){this.cid=this.sid=0;this.sPc=this.MP=this.trigger=null}}Object(h.a)(rg,"PendingRequest",null,[]);class bm{constructor(){this.roe=!1;this.Dyb=null}get gwg(){return this.roe}get fzg(){return this.Dyb}static get inProgress(){const t=new bm;t.roe=!0;t.Dyb=new Date;return t}static get ready(){const t=new bm;t.roe=!1;t.Dyb=null;return t}}Object(h.a)(bm,
"RequestState",null,[]);var sh=d(327),Xm=d(423);class Gj{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff,ah,aj,Df,Fi,We,wi,Mn,Bn,dn,Uo,Ao,pp,Xj,Uk,Gi,Vo){this.hL=null;this.eGa=this.EGg=0;this.HJg=!1;this.NSa=this.Obb=null;this.vEg=!1;this.xo=Sb;this.Qq=uc;this.Rq=Zc;this.By=ed;this.Ob=Gd;this.ia=t;this.kW=N;this.nb=Ra;this.Fa=yb;this.ta=ze;this.Lg=re;this.Qc=ff;this.la=aj;this.Xb=ha;this.Db=Aa;this.ni=Df;this.vka=Fi;this.Eka=bm.ready;this.s8=We;this.Qb=wi;this.Mc=Mn;this.yb=Bn;this.GAb=dn;this.E7b=
pp;this.yc=Xj;this.dL=Uk;this.Sv=Gi;this.jCg=Vo;this.DGg=Object(n.a)(this,this.llj,"handleFirstRunExperienceEvent");Ao&&Ao.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(Bo=>{this.HJg=Bo;return null});this.ia.Zla(this)}ub(){this.la.BRc&&(this.ia.pa(tb.a.aqh,sb.a.application,Object(n.a)(this,this.$ph,"showHideIdeas"),4),this.ia.pa(tb.a.sLe,sb.a.application,Object(n.a)(this,this.$ph,"showHideIdeas"),4),gd.a("Designer.QueryNewPane")&&this.ia.pa(tb.a.lBe,sb.a.application,Object(n.a)(this,this.dDk,
"queryShowHideDesignerPane"),96),this.ia.pa(tb.a.KIc,sb.a.application,Object(n.a)(this,this.qLe,"showHideDesigner"),4),this.ia.pa(tb.a.Hza,sb.a.application,Object(n.a)(this,this.Hza,"applyDesignerSuggestion"),4),this.ia.pa(tb.a.pnb,sb.a.application,Object(n.a)(this,this.Hza,"applyDesignerSuggestion"),4),this.ia.xa(tb.a.RVa,sb.a.application,Object(n.a)(this,this.PVa,"navigateDesignerSuggestion")),this.ia.xa(tb.a.uBb,sb.a.application,Object(n.a)(this,this.PVa,"navigateDesignerSuggestion")),this.ia.xa(tb.a.vBb,
sb.a.application,Object(n.a)(this,this.PVa,"navigateDesignerSuggestion")),this.ia.xa(tb.a.QVa,sb.a.application,Object(n.a)(this,this.PVa,"navigateDesignerSuggestion")),this.ia.xa(tb.a.rBb,sb.a.application,Object(n.a)(this,this.PVa,"navigateDesignerSuggestion")),this.ia.xa(tb.a.sBb,sb.a.application,Object(n.a)(this,this.PVa,"navigateDesignerSuggestion")),this.ia.xa(tb.a.tBb,sb.a.application,Object(n.a)(this,this.PVa,"navigateDesignerSuggestion")),this.ia.xa(tb.a.ucb,sb.a.application,Object(n.a)(this,
this.PVa,"navigateDesignerSuggestion")),this.ia.pa(tb.a.mma,sb.a.application,Object(n.a)(this,this.mma,"reportSuggestionSessionInfo"),64),this.ia.xa(tb.a.HVf,sb.a.application,Object(n.a)(this,this.yol,"triggerOnUndoRedo")),this.ia.xa(tb.a.n6d,sb.a.application,Object(n.a)(this,this.ihg,"handleImageUploadForDesigner")),this.ia.xa(tb.a.yQc,sb.a.application,Object(n.a)(this,this.ihg,"handleImageUploadForDesigner")),this.vka.P2a(Object(n.a)(this,this.G_,"onSlidePresenceChanged")),this.Lg.WJ(Object(n.a)(this,
this.TEi,"designerTargetSlideChangedHandler")),this.la.designerIncrementalRenderEnabled&&this.Qc.m4h(Object(n.a)(this,this.mnk,"onRenderSuggestions")),this.la.Aha&&this.Qc.D2h(Object(n.a)(this,this.Nlk,"onMoreIdesClicked")),this.la.zVf&&this.Qc.Rmb(Object(n.a)(this,this.eva,"onRibbonTabSwitched")),this.la.yz&&this.Lg.Smb(Object(n.a)(this,this.REi,"designerSlidesSelectionChangedHandler")),this.la.designerSendAppliedSuggestionHistoryEnabled&&this.s8.OSb(Object(n.a)(this,this.Eda,"onBlockingStateChanged")),
this.Lg.hCf(Object(n.a)(this,this.c7c,"onForceOutboundGraphTransactionDisposed")),this.GAb.NSb(Object(n.a)(this,this.Mcb,"onMarkedUndo")),this.la.bRd&&this.Mc.SMa(Object(n.a)(this,this.Ucb,"onSessionEnding")),this.Mc.uB(Object(n.a)(this,this.jo,"onSessionRehydrated")),this.E7b&&this.E7b.execute(t=>{t.xCf(Object(n.a)(this,this.Uue,"onEditorCritiques"))}),this.jCg&&this.jCg.execute(t=>{t.U3h(Object(n.a)(this,this.Fkk,"onHighConfidenceAgendaDetected"))}),this.la.MEi?(this.EGg=window.setTimeout(Object(n.a)(this,
this.LRe,"tryTriggerNewDocDesignerRequest"),this.la.LEi),window.addEventListener("FREDecisionEvent",this.DGg,!0)):this.LRe(),!gb.a.Va(this.la.Qye)&&this.UEi(this.la.Qye)&&(this.rkj(),this.uol(this.la.Qye)))}llj(t){window.removeEventListener("FREDecisionEvent",this.DGg,!0);window.clearTimeout(this.EGg);(t=t.detail)&&t.show&&t.show||this.LRe()}we(){const t=this.Fa.Bc(hd.a.S6);t.bindAction(ob.KeyInputManager.Na(qa.a.C0,0),tb.a.RVa);t.bindAction(ob.KeyInputManager.Na(qa.a.gB,0),tb.a.RVa);t.bindAction(ob.KeyInputManager.Na(qa.a.iE,
0),tb.a.uBb);t.bindAction(ob.KeyInputManager.Na(qa.a.Bq,4),tb.a.vBb);t.bindAction(ob.KeyInputManager.Na(qa.a.A0,0),tb.a.QVa);t.bindAction(ob.KeyInputManager.Na(qa.a.fB,0),tb.a.QVa);t.bindAction(ob.KeyInputManager.Na(qa.a.tw,0),tb.a.rBb);t.bindAction(ob.KeyInputManager.Na(qa.a.Bq,0),tb.a.sBb);t.bindAction(ob.KeyInputManager.Na(qa.a.YQ,0),tb.a.tBb);t.bindAction(ob.KeyInputManager.Na(qa.a.wO,0),tb.a.ucb)}qLe(t,N,ha,Aa,Ra){return this.KL(this.Qq,hd.a.S6,ha,t,Ra)}$ph(t,N,ha,Aa,Ra){return Ra||!this.xo.isVisible?
this.KL(this.Qq,hd.a.ttb,ha,t,Ra):0}KL(t,N,ha,Aa,Ra){var yb=this.ta.presentation;yb=!!this.ta.Ba&&!!yb&&!this.Xb.Zc(yb);if(this.la.yz){const Sb=this.nb.mf();yb=!!Sb&&1===Sb.length&&yb}if(!yb)return 16;if(!this.By.isEnabled())return 8;if(1===ha)return 32;Ra||this.Fa.Gj(N,t.yp.isVisible);Aa===tb.a.KIc?this.Ob.correlationId&&!this.Ob.Avb(this.Ob.correlationId)||this.Hba(Pd.BIb):t.yp.isVisible?t.yp.Yo(!1,sh.a.JHb):(this.Hba(Aa===tb.a.sLe?Pd.BIb:Pd.Amc),t.yp.Yo(!0,sh.a.none));return 32}dDk(t,N,ha,Aa,Ra){if(!Object(Lj.a)(vn.a,
Ra)||!this.Qq||!this.Qq.yp)return 8;Ra.Kf(this.Qq.yp.isVisible);return 32}Hza(t,N,ha,Aa,Ra){N=this.ta.presentation;if(!this.ta.Ba||!N||this.Xb.Zc(N))return 16;Aa=null;let yb=!0;Object(Lj.a)(Ri,Ra)?Aa=Ra:Object(Lj.a)(hp,Ra)&&(Aa=Ra.DAc,yb=!1);if(!this.By.isEnabled()||!Aa)return 8;if(this.By.Trk())return L.a.J(512496589,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",Aa.CorrelationId,t),8;if(1===ha)return 32;if(!this.nb.ku()){if(1===this.nb.ae().length&&
this.nb.ae()[0].yx)return this.nb.Ph(),L.a.J(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",Aa.CorrelationId,t),8;this.nb.Ph()}if(!this.la.Aha&&this.Ob.JY.sid===Aa.SuggestionSid)return L.a.J(512496587,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",Aa.CorrelationId,Aa.SuggestionSid),2;ha=this.Db.je(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&
(this.Ob.$Ma=new Date),ha.jc(N),ha.$c=t,N.IAa=Aa,this.Ob.JY=P.a.bE(Aa.SuggestionSid,Aa.SuggestionCid),this.Ob.DS=!0,L.a.J(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Aa.CorrelationId,t,Aa.SuggestionSid)}finally{ha&&ha.dispose()}this.la.designerBlockApplyUntilDraw?this.Xb.Ipa(N,this.ta.Ba,this.Qb.Ma,t):this.Xb.zw(N,t);this.xo.isVisible&&this.Fa.Bf(hd.a.ttb);yb&&this.Ob.tre();return 32}PVa(t,N,ha){N=this.ta.presentation;if(!this.ta.Ba||
!N||this.Xb.Zc(N))return 16;if(!this.By.isEnabled())return 8;if(1===ha)return 32;this.By.lpj(t);return 32}mma(t,N,ha,Aa,Ra){if(this.By.Qq.yp.isVisible)return 0;this.FFb(Ra.RSc,Ra.ETk);return 32}FFb(t,N){const ha=this.Ob.correlationId;if(gb.a.Va(ha))L.a.J(512496585,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",N);else if(this.Ob.Avb(ha))L.a.J(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",
ha,N);else{var Aa={};Aa.CachedTrigger=this.Ob.AKd;Aa.SuggestionSlideId=this.Ob.JY.sid.toString();Aa.SuggestionSlideCreationId=this.Ob.JY.cid.toString();Aa.AppliedSuggestion=this.Ob.DS;Aa.DisplaySuggestionsTimeoutInMs=this.la.aRd;Aa.SuggestionsTimeout=this.Ob.hSa;Aa.ClientAbort=this.Ob.nub||this.By.Qrk();Aa.DesignerPaneClosed=t;Aa.ResetReason=N;Aa.HoverPreviewDesignerTriggered=this.Ob.Ftg;Aa.DesignerFixPaneOpenHint=this.la.BVf;Aa.DesignerSendTraceRequestOnSessionEnded=this.la.bRd;this.la.zVf&&(Aa.DesignerDesignTabTriggerEnabled=
!0);this.Qq.Iqa()&&(this.la.wOa?(Aa[Ne.a.ECh]=this.Rq.K1d(),Aa[Ne.a.FCh]=!0,this.Ob.jNe&&(Aa.StartUpsellFreeTrial=!0)):Aa[Ne.a.$Pf]=!0);t=!!N&&0<=N.indexOf(Pd.moreIdeas);this.la.Aha&&(Aa.TermCorrelationId=Gj.u1d(),t||(Aa.TermAction=this.Zej()));var Ra=qe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),yb={};yb.ClientOS=Ra.Os;yb.Browser=Ra.Browser||"";yb.BrowserVersion=Ra.BrowserVersion||"";yb.BrowserMajorVersion=Ra.BrowserMajorVersion||"";yb.BrowserMinorVersion=Ra.BrowserMinorVersion||
"";this.Ob.qlc&&this.Ob.Kea&&this.Ob.Kea>this.Ob.qlc&&(yb.SuggestionsE2ETimeMs=+this.Ob.Kea-+this.Ob.qlc);this.la.designerIncrementalRenderEnabled&&(this.Rq.Zhd(),this.oNe(),Aa[Ne.a.wlg]=!0,yb.VisibleSuggestionsCount=this.Ob.BUb,0<this.Ob.RPc.count&&(yb.IncrementalRenderTimeoutIndexes=this.Ob.RPc.toArray().join(",")),0<this.Ob.uda.count&&(yb.MissingDesignerCardIndexes=this.Ob.uda.toArray().join(",")),0<this.Ob.xNa.count&&(yb.CardIndexes=this.Ob.xNa.toArray().join(",")),0<this.Ob.oqa.count&&(yb.DesignerCardIndexes=
this.Ob.oqa.toArray().join(",")),this.Ob.mP&&(this.Ob.Vbc&&this.Ob.Vbc>this.Ob.mP&&(yb.MissingDesignerCardsReceivedTime=+this.Ob.Vbc-+this.Ob.mP),this.Ob.YSb&&this.Ob.YSb>this.Ob.mP&&(yb.AllIncRenderReceivedTime=+this.Ob.YSb-+this.Ob.mP),this.Ob.PJb&&this.Ob.PJb>this.Ob.mP&&(yb.VisibleIncRenderReceivedTime=+this.Ob.PJb-+this.Ob.mP)));this.M_h(yb);try{if(this.Sv.instance){const Sb=this.Sv.instance.GSk();gb.a.Va(Sb)||(Aa.AgendaMetrics=Sb)}}catch(Sb){L.a.J(512496583,813,10,"exception while populating AgendaMetrics",
Sb)}Aa.BrowserData=yb;this.Ob.mP&&this.Ob.Kea&&this.Ob.Kea>this.Ob.mP&&(Aa.TimeToDisplaySuggestionsInMs=+this.Ob.Kea-+this.Ob.mP);this.Ob.MPe&&this.Ob.nmc&&(Aa.TimeSuggestionsRendered=this.Ob.MPe.toUTCString());this.Ob.nmc&&(Aa.TimeDesignerPaneClosed=this.Ob.nmc.toUTCString());this.Ob.vTb&&0<this.Ob.vTb.count&&(Aa.AppliedSuggestionHis=this.Ob.vTb.toArray().join(" "));this.ni.mma(ha,of.c(Aa),N===sh.a.Xed);this.zul(ha,N);this.Ob.vAf(ha,this.la.Aha&&t);L.a.J(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",
N,ha)}}M_h(t){t.IdeasMivShown=this.Ob.C4c;t.IdeasMivDrillIn=this.Ob.mre;t.IdeasEditorShown=this.Ob.nHc;t.IdeasEditorKept=this.Ob.mHc;t.IdeasEditorDrillIn=this.Ob.EYf;t.AnyCardShown=this.Ob.nHc||this.Ob.C4c||0<this.Ob.xNa.count;t.AnyCardKept=this.Ob.mHc||this.Ob.DS}zul(t,N){this.By.sGa(t,N===sh.a.JHb||N===sh.a.wid||N===sh.a.noSuggestion||N===sh.a.MWf?Mj.a.rGa:Mj.a.pending)}mnk(t,N){N.Ith.addRange(this.Ob.oqa);this.gMf(N.Ith,N.K0f,N.slideId,N.trigger,N.correlationId);N.u5a&&(this.NSa||this.Ob.uda.count||
this.qgl(N.trigger,N.K0f))}Nlk(t,N){this.Hba(Pd.moreIdeas,null,N.PUc)}eva(t,N){!N.jla||"PptRibbon.Design"!==N.jla&&"Design"!==N.jla||2!==N.Uu&&3!==N.Uu&&4!==N.Uu||this.By.Qq.yp.isVisible||32!==this.ia.processAction(tb.a.vLe,1)||this.Hba(Pd.YQd)}qgl(t,N){this.oNe();const ha=this.ta.Ba.Bb,Aa=this.Ob.correlationId;this.NSa=new Y.a(2,1,this.la.retryMissingDesignerCardsCountdownInMs,()=>{this.Ob.Avb(Aa)||this.gMf(this.Ob.oqa,N,ha,t,Aa,N)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.yb.Gb(this.NSa)}gMf(t,
N,ha,Aa,Ra,yb=-1){if(this.Ob.oqa.count===N)this.oNe();else if(t&&t.count&&!(0<this.Ob.uda.count)){if(-1===yb)for(let Sb of t)Sb>yb&&(yb=Sb);this.Iki(t,N,yb)&&this.xpl(ha,Aa,Ra)}}Iki(t,N,ha){for(let Aa=0;Aa<N&&(t.contains(Aa)||this.Ob.uda.contains(Aa)||this.Ob.uda.add(Aa),Aa!==ha||this.Ob.uda.count);Aa++);return 0<this.Ob.uda.count}xpl(t,N,ha){const Aa={};Aa.MissingDesignerCardIndexes=this.Ob.uda.toArray().join(",");this.NSa=new Y.a(0,1,0,()=>{this.ni.Vha(t.cid,t.sid,ha,Gj.u1d(),N,null,of.c(Aa),()=>
{L.a.J(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",Aa.MissingDesignerCardIndexes,ha)},Ra=>{L.a.J(512496580,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",Aa.MissingDesignerCardIndexes,Ra.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.yb.Gb(this.NSa)}oNe(){this.NSa&&
(this.yb.Qg(this.NSa),this.NSa=null)}G_(t,N){(t=this.ta.Ba)&&N.slideId.equals(t.Bb)&&(this.By.Ehd(N.urh,N.i6g),this.By.Qq.yp.isVisible&&!this.By.isEnabled()&&(L.a.J(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",N.urh,N.i6g,this.Ob.correlationId),this.xo.Yo(!1,sh.a.goi)),this.xo.isVisible&&(this.By.isEnabled()||this.By.sGa(this.Ob.correlationId,
Mj.a.rGa)))}TEi(t,N){N.ila?(t=Object.assign(new Qk.a,{slideId:N.ila.Bb}),this.ia.Ka(tb.a.MWa,2,t),this.By.Ehd(t.Mkc,t.h6g),this.xo.isVisible&&(L.a.J(512496577,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Ob.correlationId),this.By.isEnabled()&&!N.ila.dN?this.Hba(Pd.zMe):N.ila.dN&&this.la.designerNewSlideEnabled||(this.xo.Yo(!1,sh.a.slideNavigation),this.By.sGa(this.Ob.correlationId,Mj.a.rGa)))):L.a.J(512496578,829,50,
"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Ob.correlationId)}t1b(t){this.la.designerRequestThrottlingEnabled&&(this.Eka=bm.ready,this.hL&&(this.xo.isVisible?(L.a.J(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.hL.trigger,this.hL.sid),t()):this.hL=null))}Wcb(t,N){this.t1b(N);L.a.J(512496547,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",
t.HttpStatusCode);return!0}REi(){if(this.By.Qq.yp.isVisible){const t=this.nb.mf();t&&1<t.length&&(L.a.J(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),this.xo.isVisible&&this.xo.Yo(!1,sh.a.Wdk))}}Eda(t,N){t=this.Ob.$Ma;const ha=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";t&&Object(M.a)(String,N.actionName)===ha&&(this.Ob.vTb.add(String.format("{0}:{1}:{2}",this.Ob.JY,
+t-+this.Ob.Kea,+new Date-+t)),this.Ob.$Ma=null)}Ucb(t,N){this.By.Qq.yp.isVisible&&(L.a.J(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Ob.correlationId,Xm.a[N.fJ]),1!==N.fJ&&3!==N.fJ||this.FFb(!0,sh.a.Xed))}jo(){L.a.J(512496544,829,50,"DesignerActor::OnSessionRehydrated");const t={};t[Ne.a.EIc]=!0;this.Hba(Pd.refresh,t)}c7c(t,N){N&&this.A2d(N.actionId,N.transaction.my)}Mcb(t,N){if(N.Lub&&this.By.Qxg(N.actionId)){t={};if(N.revisionId){const ha=zk.a.wra(rm.a.uX,
zk.a.D6a(N.revisionId.toString()).toString());ha&&1===ha.length&&(t[Ne.a.TC]=ha[0].TC)}this.A2d(N.actionId,t)}}ihg(t,N,ha,Aa,Ra){switch(t){case tb.a.n6d:return this.Ob.Xak(Ra),32;case tb.a.yQc:return this.Ob.uOk(Ra),32;default:return 2}}tak(t,N,ha){if(t!==Pd.insertPicture&&t!==Pd.sva&&t!==Pd.mQc)return null;const Aa=ha?ha[Ne.a.D1b]:!1,Ra=ha?ha[Ne.a.QOc]:!1,yb=ha?ha[Ne.a.E1b]:!1,Sb=ha?ha[Ne.a.POc]:!1;let uc=null;switch(N){case tb.a.QGa:case tb.a.s9c:uc=Aa?Ne.a.juk:Ra?Ne.a.iuk:yb?Ne.a.kuk:Sb?Ne.a.huk:
null;break;case tb.a.u9c:uc=Aa?Ne.a.nuk:Ra?Ne.a.muk:yb?Ne.a.ouk:Sb?Ne.a.luk:null;break;case tb.a.ZIc:uc=Ne.a.c5f;break;case tb.a.insertOnlinePicture:case tb.a.GCa:uc=Ne.a.online;break;case tb.a.Gmg:uc=Ne.a.icon}uc||L.a.J(512496543,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",t,N,this.Ob.correlationId);delete ha[Ne.a.D1b];delete ha[Ne.a.QOc];delete ha[Ne.a.E1b];delete ha[Ne.a.POc];return uc}uak(t,N){switch(t){case tb.a.ZIc:case tb.a.insertOnlinePicture:case tb.a.GCa:case tb.a.wec:case tb.a.Gmg:return Pd.insertPicture;
case tb.a.u9c:case tb.a.QGa:case tb.a.s9c:case tb.a.j$c:return N&&N[Ne.a.D1b]||N&&N[Ne.a.QOc]&&this.la.kol?Pd.insertPicture:N&&N[Ne.a.E1b]?Pd.sva:N&&N[Ne.a.POc]&&this.la.kxh?Pd.mQc:this.la.hxa?Pd.RGa:"";case tb.a.y3a:case tb.a.DNa:case tb.a.tnb:return Pd.tnb;case tb.a.Mpa:return Pd.uMe;case tb.a.Fjc:case tb.a.Gjc:case tb.a.aJe:case tb.a.bJe:case tb.a.Vfd:return N&&Ne.a.$sb in N&&N[Ne.a.$sb]?Pd.BLd:Pd.refresh;case tb.a.uNf:case tb.a.I3a:return N&&Ne.a.$sb in N&&N[Ne.a.$sb]?Pd.vVf:Pd.refresh;case tb.a.lGa:case tb.a.Deb:case tb.a.hjc:case qg.a.jRa:case tb.a.bringForward:case tb.a.bringToFront:case tb.a.sendToBack:case tb.a.sendBackward:return Pd.Ieb;
case qg.a.QId:case qg.a.TId:case qg.a.ITb:case qg.a.SId:case qg.a.UId:case qg.a.VId:case qg.a.gNa:case qg.a.WId:case qg.a.XId:case qg.a.YId:case qg.a.ZId:case qg.a.aJd:case qg.a.cJd:case qg.a.backspace:case qg.a.Oza:case qg.a.eK:case qg.a.sOa:case qg.a.enter:case qg.a.SA:case qg.a.typing:return Pd.typing;case tb.a.sva:return Pd.sva;case tb.a.n$c:return Pd.insertTable;case tb.a.kla:case tb.a.L5c:case tb.a.BBb:case tb.a.bS:return Pd.oGa;case tb.a.ZMa:return Pd.OHd;case tb.a.$Lf:return Pd.rLd;case tb.a.Fob:return Pd.Fob;
default:return Pd.refresh}}yol(){const t={};t[Ne.a.undoRedo]=!0;this.Hba(Pd.refresh,t);return 32}A2d(t,N){if(!this.lBj(t)){var ha=yb=>{const Sb={};Sb[Ne.a.timestamp]=yb.timestamp;Sb[Ne.a.correlationId]=yb.correlationId;Sb[Ne.a.trigger]=yb.trigger;Sb[Ne.a.sid]=yb.sid;Sb[Ne.a.cid]=yb.cid;Sb[Ne.a.MP]=yb.MP;yb=this.Db.rd(4);try{yb.jc(this.ta.presentation),yb.$c=tb.a.CVf,this.ta.presentation.Spb=of.c(Sb)}finally{yb&&yb.dispose()}},Aa=this.uak(t,N),Ra=this.tak(Aa,t,N);gb.a.Va(Ra)||(N||(N={}),N[Ne.a.WAa]=
Ra);this.By.Qxg(t)&&this.xo.isVisible?(this.Obb&&this.yb.Qg(this.Obb),this.By.sGa(this.Ob.correlationId,Mj.a.pending),this.Efd(Pd.typing),this.Obb=new Y.a(2,1,this.la.designerTypeRefreshThrottleTimeoutMs,()=>{this.xo.isVisible&&L.a.J(512496542,829,50,"Potential candidate for typing refresh request for designer pane");this.Q$k(this.ta.Ba)||this.iIc(ha,Aa,N)},void 0,"DesignerTypingRefreshTask"),this.yb.Gb(this.Obb)):this.iIc(ha,Aa,N)}}Hba(t,N=null,ha=null){this.iIc(Aa=>{if(this.la.designerRequestThrottlingEnabled){if(this.Eka.gwg&&
+new Date-+this.Eka.fzg<this.la.designerRequestThrottleIntervalMs){this.hL=new rg;this.hL.sid=Aa.sid;this.hL.cid=Aa.cid;this.hL.trigger=Aa.trigger;this.hL.sPc=Aa.MP;L.a.J(512496541,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",t,Aa.sid);return}this.Eka=bm.inProgress;this.hL=null}const Ra=()=>{this.Hba(this.hL.trigger,this.hL.sPc,ha)};this.ni.Vha(Aa.cid,Aa.sid,Aa.correlationId,Gj.u1d(),Aa.trigger,ha,of.c(Aa.MP),yb=>{yb&&yb.Status===Ne.a.ifh?
this.wdd(()=>{this.Hba(Aa.trigger,Aa.MP,ha)}):this.eGa=0;this.eGa||this.t1b(Ra)},yb=>this.Wcb(yb,Ra))},t,N)}wdd(t){this.eGa<this.la.designerMaxRetryOnWait?this.yb.Gb(new Y.a(2,1,1E3,()=>{L.a.J(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Ob.correlationId);this.Eka=bm.ready;this.eGa++;t()},void 0,"RetryRequestOnWait")):L.a.J(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Ob.correlationId)}e4i(t,
N=null){N=N||{};this.la.kGc&&t===Pd.newDocument&&(N[Ne.a.ZJi]="true");this.la.SEi&&(N[Ne.a.lil]=this.HJg);this.Qq.Iqa()&&(this.la.wOa?(N[Ne.a.ECh]=this.Rq.K1d(),N[Ne.a.FCh]=!0):N[Ne.a.$Pf]=!0);this.Rq.SPc(t)&&(N[Ne.a.wlg]=!0);this.By.GDj()&&(N[Ne.a.EMd]=this.By.EMd());N.NewPaneEnabled=!0;var ha=!$e.a.Va(this.Ob.oV);(N.RequestForEditorCardsForNewIdeasPane=ha)&&(N.NumEditorCritiques=this.bvi());ha={};ha.SupportsImageToTableSuggestedAction=32===this.ia.processAction(tb.a.Lye,1);N.PPTOEnabledSuggestedActions=
of.c(ha);this.la.hxa&&t===Pd.RGa&&(N[Ne.a.ldb]=this.la.ldb,N[Ne.a.Fxe]=this.la.Fxe,N[Ne.a.Exe]=this.la.Exe);return N}bvi(){let t=0;for(const N of this.Ob.oV)for(const ha of N.critiques)t+=ha.suggestions.length;return t}lBj(t){if(void 0===t||null===t)return!0;switch(t){case tb.a.Hza:case tb.a.pnb:case tb.a.QVa:case tb.a.rBb:case tb.a.sBb:case tb.a.RVa:case tb.a.uBb:case tb.a.vBb:case tb.a.tBb:case tb.a.ucb:case tb.a.CVf:return!0;case tb.a.lGa:case tb.a.Deb:case tb.a.hjc:case qg.a.jRa:case tb.a.bringForward:case tb.a.bringToFront:case tb.a.sendToBack:case tb.a.sendBackward:return!this.Ob.DS;
default:return!1}}Izi(t,N=null){const ha=this.ta.Ba;return ha?Object.assign(new El,{trigger:t,sid:ha.sid,cid:ha.cid,MP:this.e4i(t,N)}):null}QLj(t){return this.RLj(t)}RLj(t){if(!t||!t.sid||!this.Fsg(t.trigger)&&!this.xo.isVisible)return!1;switch(t.trigger){case Pd.oGa:case Pd.Amc:case Pd.BIb:case Pd.insertPicture:case Pd.tnb:case Pd.YQd:case Pd.XNd:case Pd.sva:case Pd.zMe:case Pd.uMe:case Pd.insertTable:return!0;case Pd.mQc:return this.la.kxh;case Pd.typing:return this.la.GVf&&this.xo.isVisible;case Pd.Ieb:return this.la.designerRetriggerEnabled&&
this.Ob.DS;case Pd.BLd:case Pd.vVf:return this.la.designerDesignElementsRemovedEnabled;case Pd.RGa:return this.la.hxa;case Pd.OHd:case Pd.rLd:case Pd.Fob:return this.la.triggerDesignerAfterApplyReplaceObject;case Pd.refresh:return this.JLj(t.MP);case Pd.moreIdeas:return this.la.Aha;case Pd.newDocument:return this.la.kGc&&this.la.xS;case Pd.cHd:return this.la.FQe;default:return L.a.J(512496538,829,15,"invalid trigger: {0}",t.trigger),!1}}JLj(t){return Ne.a.EIc in t&&t[Ne.a.EIc]||Ne.a.undoRedo in t&&
t[Ne.a.undoRedo]||this.la.PEi&&this.By.Qq.yp.isVisible?!0:!1}Fsg(t){switch(t){case Pd.Amc:case Pd.BIb:case Pd.insertPicture:case Pd.mQc:case Pd.uMe:case Pd.BLd:case Pd.tnb:case Pd.sva:case Pd.newDocument:case Pd.OHd:case Pd.YQd:case Pd.XNd:return!0;case Pd.cHd:return this.la.FQe;case Pd.RGa:return this.la.hxa;default:return!1}}kBj(t){if(!(this.la.designerSendActionDuration&&Ne.a.TC in t.MP&&t.MP[Ne.a.TC]))return!1;switch(t.trigger){case Pd.Amc:case Pd.BIb:case Pd.zMe:case Pd.newDocument:return!1;
case Pd.refresh:return!(Ne.a.EIc in t.MP)||!(Ne.a.undoRedo in t.MP);default:return!0}}Efd(t){const N=t===Pd.typing?4:t===Pd.moreIdeas?7:1;(this.By.Qq.yp.isVisible||this.Fsg(t))&&this.Qq.dYa(N)}NTd(t,N,ha=null){this.Obb&&(this.yb.Qg(this.Obb),this.Obb=null);const Aa=this.Izi(N,ha);this.QLj(Aa)?this.Ob.zNj(this.ta.Ba.sid)?(this.Efd(Aa.trigger),this.wdd(()=>{this.iIc(t,N,ha)})):(L.a.J(512496537,829,50,"trigger: {0}; sid: {1}; correlationId: {2}",Aa.trigger,Aa.sid,Aa.correlationId),this.Ob.correlationId&&
!this.Ob.Avb(this.Ob.correlationId)&&this.FFb(this.By.Qq.yp.isVisible,Aa.trigger),this.Ob.qlc=new Date,this.Ob.correlationId=Aa.correlationId,this.Ob.AKd=Aa.trigger,this.Ob.mP=this.kBj(Aa)?Aa.MP[Ne.a.TC]:new Date,t(Aa),this.Efd(Aa.trigger),this.By.sGa(Aa.correlationId,Mj.a.pending)):(L.a.J(512496536,829,50,"Designer call not currently allowed for trigger {0}",N),this.xo.Yo(!1,sh.a.MWf))}iIc(t,N,ha=null){if(this.la.designerAuthEnabled&&this.dL){this.Efd(N);ha||(ha={});var Aa=new Date;this.dL.q0(this.la.pptDesignerImplicitAuthAppName,
this.la.designerResourceUri).then(Ra=>{const yb=+new Date-+Aa;Ra.IsSuccess?(ha[Ne.a.RPi]=yb,ha[Ne.a.I_k]=Ra.Token):(ha[Ne.a.d2f]=yb,L.a.J(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+Ra.ErrorCode+": "+Ra.ErrorMessage));this.NTd(t,N,ha)}).catch(Ra=>{L.a.J(512496534,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",Ra);ha[Ne.a.d2f]=+new Date-+Aa;this.NTd(t,N,ha)})}else this.NTd(t,N,ha)}LRe(){if(this.la.kGc&&
this.la.xS)if(this.yc){var t=this.ta.presentation;if(!t)throw Error.argumentNull("Presentation is null");var N=this.yc.TH();if(!N||0>=N.length)L.a.J(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");else{var ha="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===N[0].ThemeFamilyId.toLowerCase();ha&&1!==N.length?L.a.J(512496530,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.la.EQe||ha?!t.slides||0>=
t.slides.length?L.a.J(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):ha&&1!==t.slides.length?L.a.J(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):(t=null,this.la.j_k&&this.la.ojd&&0<this.la.ojd.length&&(t={},t.TemplateId=this.la.ojd),L.a.J(512496526,829,50,"Triggering NewDocument designer request"),this.Hba(Pd.newDocument,t)):L.a.J(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else L.a.J(512496532,
829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else L.a.J(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",this.la.kGc,this.la.xS)}Uue(t,N){this.Ob.$tl(N.dYb)}Q$k(t){return!t||!this.xo.isVisible}Zej(){const t=document.querySelector("."+ae.tNa);return t&&(this.Rq.yrb(t,!1)||this.Rq.yrb(t,!0))?"Kept":"NotKept"}D$f(t){const N=new D.a;if(t&&t.children)for(let ha=0;ha<t.children.length;ha++){const Aa=
t.children[ha].innerText;Aa&&0<Aa.length&&N.add(t.children[ha].innerText)}return N.toArray()}v9i(t){if(!t)return null;var N=t.sa(Kl.a.mdb,null);if(N)return N.replace("\r","\n").replace("\n\n","\n").split("\n");if(N=t.sa(Kl.a.zT,null))if(N=this.kW.rWa(N))return this.D$f(N);if(N=t.sa(Kl.a.Gxe,null))if(t=this.kW.rWa(N))return this.D$f(t);return null}B9(){}z9(t){if(this.la.hxa&&t.actionId===tb.a.j$c&&32===t.response){var N=this.nb.ae();if(N&&1===N.length&&N[0].id&&(N=this.v9i(Object(M.a)(10,t.ld)))&&
!(0>=N.length)){var ha={};ha[Ne.a.puk]=N;this.A2d(t.actionId,ha)}}}UEi(t){switch(t){case Ne.a.pEh:return this.la.XJi;default:return!1}}rkj(){this.xo.Yo(!0,sh.a.none);this.Hba(Pd.XNd);this.Qq.dYa(3)}uol(t){switch(t){case Ne.a.pEh:this.vol()}}vol(){if(this.la.mxk)try{const t=u.a.instance.La("Common.ISystemInitiatedFeedback");t&&(L.a.J(512496525,829,50,"Floodgate survey for word to presentation triggered"),t.execute(N=>{N.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(t){L.a.J(512496524,
829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",t)}}Fkk(){this.la.FQe&&(this.xo.isVisible||this.vEg||(this.xo.Yo(!0,sh.a.none),this.Hba(Pd.cHd),this.Qq.dYa(3),L.a.J(512496523,829,50,"Auto opening designer pane for high confidence agenda")),this.vEg=!0)}static u1d(){const t=document.querySelector("."+ae.tNa);return t&&t.getAttribute(ae.dob)?t.getAttribute(ae.dob).toString():null}}Object(h.a)(Gj,"DesignerActor",null,[156]);var oi=d(532),qk=d(682);class ek{constructor(t){this.bucketId=
t;this.critiques=[]}}Object(h.a)(ek,"BucketedEditorData",null,[]);class xn{constructor(t){this.AKd=this.correlationId=this.jTa=this.bDg=null;this.nub=this.hSa=this.DS=!1;this.nmc=this.MPe=null;this.Ftg=!1;this.yNa=this.suggestions=this.PJb=this.YSb=this.mP=this.$Ma=this.Vbc=this.Kea=this.qlc=null;this.HM=0;this.jNe=this.mre=this.C4c=this.EYf=this.mHc=this.nHc=!1;this.oee=[];this.Ape=[];this.q7b=t;this.JY=P.a.empty;this.vTb=new D.a;this.xNa=new D.a;this.oqa=new D.a;this.RPc=new D.a;this.uda=new D.a;
this.BUb=1}Nak(){this.IXa(0,0)}Mak(){this.IXa(1,0)}tre(){this.IXa(2,4)}IXa(t,N){this.q7b&&this.q7b.execute(ha=>{const Aa=Object.assign(new qk.a,{cardId:oi.a.srh,actionType:t,actionEngagement:N});ha.b6c(Aa)})}vAf(t,N){this.Avb(t)||(Array.add(this.oee,t),L.a.J(22853508,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",t,this.oee.length));this.VEe(!N)}Avb(t){return Array.contains(this.oee,t)}Xak(t){Array.add(this.Ape,t)}uOk(t){Array.remove(this.Ape,
t)}zNj(t){return Array.contains(this.Ape,t)}get sNd(){return this.jTa}psi(){if(this.jTa)return!0;try{const t=u.a.instance.pb("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(t)return this.jTa=t,!0}catch(t){L.a.J(42001674,829,15,"error resolving consistencyCheckActor. ex: {0}",t)}return!1}$tl(t){if(t){var N=[],ha=new Id.a;for(const Aa of t.critiques){t=Aa.bucketId;let Ra=ha.ga(t);Ra||(Ra=new ek(t),ha.$(t,Ra),N.push(Ra));Ra.critiques.push(Aa)}this.bDg=N}}get oV(){return this.bDg}VEe(t){this.correlationId=
"";this.JY=P.a.empty;this.AKd="";this.nub=this.hSa=this.DS=!1;this.nmc=null;this.Ftg=!1;this.$Ma=this.Vbc=this.Kea=this.qlc=null;this.vTb.clear();this.PJb=this.YSb=this.mP=null;this.BUb=1;this.xNa.clear();this.oqa.clear();this.RPc.clear();this.uda.clear();this.HM=0;this.jNe=this.nHc=this.mHc=this.C4c=this.mre=!1;t&&(this.suggestions=this.yNa=null)}}Object(h.a)(xn,"DesignerContext",null,[791]);class rk{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=
null}}Object(h.a)(rk,"DesignerSuggestions",null,[]);var Rl;(function(t){t[t.init=0]="init";t[t.loading=1]="loading";t[t.noSuggestion=2]="noSuggestion";t[t.showSuggestion=3]="showSuggestion";t[t.refreshing=4]="refreshing";t[t.sameSlideCoauthNoSuggestion=5]="sameSlideCoauthNoSuggestion";t[t.makeItVisualDrillIn=6]="makeItVisualDrillIn";t[t.loadingMoreIdeas=7]="loadingMoreIdeas";t[t.moreIdeas=8]="moreIdeas";t[t.noSuggestionRibbon=9]="noSuggestionRibbon"})(Rl||(Rl={}));Object(h.b)("DesignerViewState",
Rl);class Zn{constructor(){this.suggestions=[]}}Object(h.a)(Zn,"SlideSuggestionNotificationData",null,[]);var $n=d(271),Cp=d(451);class Jo{constructor(t,N,ha){this.hkb=this.Dp=!1;t&&(this.YSa=t,this.YSa.isFeatureEnabled("PowerPointDesigner",!1).then(Aa=>{(this.Dp=Aa)?L.a.J(591942685,829,50,"DesignerStateManager:: Designer is enabled"):(this.hkb=this.YSa.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?ha?L.a.J(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):
L.a.J(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):L.a.J(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.Z6j=this.YSa.deb("PowerPointDesigner",Object(n.a)(this,this.Uqb,"featureStateChangeCallback")),this.z5j=N)}Iqa(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.YSa&&(this.YSa.uEb("PowerPointDesigner",this.Z6j),this.YSa=null)}get isEnabled(){return this.Dp}get isFreemiumUpsellEnabled(){return this.hkb}launchUpsellExperience(t){this.YSa&&
this.YSa.launchUpsellExperience(t)}Uqb(t){t&&"PowerPointDesigner"===t.featureName&&(!this.isEnabled&&t.isEnabled&&this.z5j(),this.Dp=t.isEnabled)}}Object(h.a)(Jo,"DesignerStateManager",null,[]);class sm{constructor(t,N,ha){this.O8j=t;this.NA=N;this.s8j=ha}toString(){return"SuggestionIndex:"+this.O8j+" SlideId:"+this.NA+" CreationId:"+this.s8j}}Object(h.a)(sm,"LoggableSourceContext",null,[]);var Ko=d(1108),Lo=d(934),ao=d(531);class Sl{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff){this.J8b=!1;
this.Uqe=0;this.fo=this.exb=null;this.va=new qm.a;this.tE=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.gb&&v.AFrameworkApplication.Aa.gb.UV;this.sOh=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.gb&&v.AFrameworkApplication.Aa.gb.UV&&v.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesFocusV2IsEnabled");this.Nb=t;this.fe=N;this.gd=ha;this.mu=Aa;this.ia=Ra;this.Ob=yb;this.yD=Sb;this.Mc=uc;this.Gy=Zc;this.hc=ed;this.Fa=Gd;this.la=ze;this.$u=re;this.zI=Kd.l2b;this.J5j=ResourceStrings.L_Designer;
this.TG=ff;this.vb=document.createElement("div");this.vb.className=hb.a.NEi;this.vb.id=Kd.l2b;this.vb.style.position=Rc.a.Jwa;this.vb.setAttribute(na.a.We,na.a.Kza);this.vb.setAttribute(na.a.y6,hb.a.$Qd);this.Ib=!1;this.rTa=pb.a.Ee();this.rTa.className="DesignerPaneLayoutRoot";this.vb.appendChild(this.rTa);t=v.AFrameworkApplication.fa.Ha("PPTFabricIconDiamondCssUrl");N=document.createElement("link");N.setAttribute("rel","stylesheet");N.setAttribute("type","text/css");N.setAttribute("href",t);this.vb.appendChild(N);
this.Nb.N2a(Object(n.a)(this,this.aX,"onSetOffline"))}dispose(){this.E1();this.vb.removeChild(this.rTa);this.Nb.FEb(Object(n.a)(this,this.aX,"onSetOffline"));L.a.J(22590850,829,50,"DesignerPane::Dispose")}initialize(){this.fo=Sl.rAa(this.fe);Sys.UI.DomElement.addCssClass(this.fo,"DesignerPaneCloseButton");this.fo.setAttribute(na.a.We,na.a.Xt);this.rTa.appendChild(this.fo);this.gd.ob(ka.a.click,this.fo,Object(n.a)(this,this.dAa,"closePaneButtonClickHandler"));this.mu.addHandler(this.fo,ka.a.eg,Object(n.a)(this,
this.Pra,"inputKeyPressHandler"));this.exb=pb.a.Ee();this.exb.id=hb.a.$Qd;this.exb.className=hb.a.$Qd;this.exb.innerText=this.J5j;this.rTa.appendChild(this.exb);this.yD.v7(this.C9f(),hd.a.gj,this.vb,t=>{this.sOh&&t===this.Fa.Bc(hd.a.rO)&&this.fo?this.Zz(!0):this.ZW(!0)},()=>{this.ZW(!1)});this.Mc.Mga(Object(n.a)(this,this.Vz,"onUnifiedAppStateChanged"));this.Mc.uB(Object(n.a)(this,this.E9,"onPodSessionRehydrated"));this.Gy.Qmb(Object(n.a)(this,this.E9,"onPodSessionRehydrated"));L.a.J(22590852,829,
50,"DesignerPane::Initialize")}C9f(){return hd.a.S6}E1(){this.gd&&0<this.rTa.childNodes.length&&(this.gd.xb(ka.a.click,this.fo,Object(n.a)(this,this.dAa,"closePaneButtonClickHandler")),this.mu.removeHandler(this.fo,ka.a.eg,Object(n.a)(this,this.Pra,"inputKeyPressHandler")),this.rTa.removeChild(this.exb),this.rTa.removeChild(this.fo));this.Mc.GEb(Object(n.a)(this,this.Vz,"onUnifiedAppStateChanged"));this.Mc.hea(Object(n.a)(this,this.E9,"onPodSessionRehydrated"));this.Gy.reb(Object(n.a)(this,this.E9,
"onPodSessionRehydrated"));this.Fa.ye&&this.Fa.ye.name===hd.a.S6&&this.Fa.Gj(hd.a.S6,!1)}Vz(t,N){N.a8a&&!this.hc.ln&&this.isVisible&&(L.a.J(24760967,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Ob.correlationId),this.Yo(!1,sh.a.JHb))}aX(t){t&&this.isVisible&&this.Yo(!1,sh.a.JHb)}E9(){L.a.J(37861251,801,50,"Designer Pane is closed because session is rehydrated.");this.Yo(!1,sh.a.S_k)}layout(t,N){const ha=N?t.wC(this.width):
t.xC(this.width);this.isVisible&&(N?(Sys.UI.DomElement.addCssClass(this.vb,hb.a.FVf),ha.wC(hb.a.ZQd)):(Sys.UI.DomElement.addCssClass(this.vb,hb.a.EVf),ha.xC(hb.a.ZQd)));pb.a.zX(this.vb,ha);return t}Yo(t,N){if(this.Ib!==t){this.Ib=t;var ha=this.la.BVf||this.id!==Kd.l2b?Ne.a.Srk:Kd.ytj;t?(N={},N[ha]=!0,this.$u.Kid(of.c(N)),this.initialize(),this.vb.style.display=Rc.a.Iwa,this.Ob.Nak(),L.a.J(22590854,829,50,"DesignerPane::SetIsVisible - Set to visible")):(t={},t[ha]=!1,this.$u.Kid(of.c(t)),this.E1(),
this.vb.style.display=Rc.a.Sf,this.Hdl(N)||(this.Ob.nmc=new Date,1===this.Uqe&&(this.Ob.nub=!0),this.ia.Ka(tb.a.mma,2,new ao.a(!0,N))),this.Ob.Mak(),L.a.J(22590856,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.tE?(this.Wyc(this.vb),ha=ResourceStrings.L_Designer,this.TG.KL(this,this.Ib,this.id===Kd.l2b?ha:ResourceStrings.L_ShowHideDesignerPane,this.C9f())):this.Nb.yq()}}Wyc(t){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(t,hb.a.FVf):Sys.UI.DomElement.addCssClass(t,
hb.a.EVf)}Hdl(t){return t===sh.a.cOf||this.isVisible&&t===sh.a.JHb}ZW(t){t?this.va.raiseEvent("OnDesignerPaneFocusOn"):this.va.raiseEvent("OnDesignerPaneFocusBlur")}zCf(t){this.va.addHandler("OnDesignerPaneFocusOn",t)}Vch(t){this.va.removeHandler("OnDesignerPaneFocusOn",t)}ACf(t){this.va.addHandler("OnDesignerPaneFocusBlur",t)}Wch(t){this.va.removeHandler("OnDesignerPaneFocusBlur",t)}Pra(t){!this.isVisible||t.keyCode!==qa.a.aq&&t.keyCode!==qa.a.xO||this.Yo(!1,sh.a.typing)}dAa(){this.isVisible&&(L.a.J(22853525,
829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Ob.correlationId),this.Yo(!1,sh.a.JHb));return!0}Zz(t){(this.J8b=t)&&this.fo.focus()}get v$(){return this.Uqe}set v$(t){this.Uqe=t}Afb(t){this.setFocus("#"+this.id+" ."+td.fTg+":nth-child("+t+") > ."+td.cBb)}C1k(){this.setFocus("#"+td.Q4a)}B1k(){this.setFocus("#"+td.mqb)}mfd(t){this.setFocus("."+td.MOa+"["+Kd.LOa+'="'+t+'"')}z1k(){this.setFocus("."+td.aYb)}A1k(){this.setFocus("."+td.eYb)}setFocus(t){(t=
document.querySelector(t))&&ec.FocusManager.Dr(t)}get isVisible(){return this.Ib}get yRa(){return this.J8b}get ya(){return this.vb}get order(){return 7}get id(){return this.zI}get width(){let t=0;this.isVisible&&(t=hb.a.OEi,t+=hb.a.ZQd+Jb.a.QHa);return t}static rAa(t){return Sl.qAa(t,"per","cui-img-16by16","cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static qAa(t,N,ha,Aa,Ra,yb,Sb){const uc=pb.a.CB();uc.alt=yb;uc.className=Ga.getImageClassWithCluster(N,Ra);
uc.src=t.Yj(N+".png");uc.setAttribute("Unselectable","on");t=pb.a.zn();t.className=ha+" cui-img-cont-float";t.appendChild(uc);ha=pb.a.zn();ha.className=Aa;ha.setAttribute("Unselectable","on");ha.appendChild(t);Aa=pb.a.Saa();Aa.className="cui-ctl DesignerPaneButton";Aa.title=yb;Aa.setAttribute(na.a.We,na.a.Xt);Aa.tabIndex=0;Aa.appendChild(ha);Sb&&(yb=pb.a.zn(),yb.className="cui-ctl-mediumlabel",yb.setAttribute("Unselectable","on"),yb.innerText=Sb,Aa.appendChild(yb));return Aa}}Object(h.a)(Sl,"DesignerPane",
null,[787,481,106]);class Rk{constructor(t,N,ha,Aa,Ra,yb){this.N3c=this.K6b=this.Uyb=this.eo=null;this.ake=this.E3b=!1;this.Jpe=null;this.la=N;this.ia=t;this.A5j=yb;this.gd=Aa;this.mu=Ra;this.dFg=ob.KeyInputManager.Na(qa.a.Lhb,0);this.ia.xa(tb.a.DCh,E.a.frame,Object(n.a)(this,this.Qni,"closeCallout"));this.MS=pb.a.Ee();this.MS.className="GoPremiumCalloutContainer";this.L9a=Sl.rAa(ha);Sys.UI.DomElement.addCssClass(this.L9a,"GoPremiumCalloutClose");this.L9a.setAttribute(na.a.We,na.a.Xt);this.MS.appendChild(this.L9a);
t=document.createElement("i");t.className=ae.LBc;t.setAttribute(na.a.We,na.a.wM);t.setAttribute("Unselectable","on");t.setAttribute(na.a.YJ,na.a.vB);this.MS.appendChild(t);this.xua=pb.a.Ee();this.xua.className="GoPremiumTitle";this.MS.appendChild(this.xua);this.QS=pb.a.Ee();this.QS.className="GoPremiumSubtitle";this.MS.appendChild(this.QS);this.Vja=pb.a.Ee();this.Vja.className="GoPremiumButton";t=pb.a.zn();t.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;t.setAttribute("Unselectable","on");
t.setAttribute(na.a.YJ,na.a.vB);this.Vja.appendChild(t);this.Vja.tabIndex=0;this.Vja.setAttribute(na.a.vs,t.innerText);this.Vja.setAttribute(na.a.We,na.a.Xt);this.MS.appendChild(this.Vja);this.dw()}show(t,N,ha,Aa,Ra,yb){this.AK&&this.dismiss();this.Uyb=Aa;this.K6b=N;this.N3c=Ra;this.Jpe=yb;this.Uyb&&Sys.UI.DomElement.addCssClass(this.Uyb,this.N3c);ha?(this.xua.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.QS.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):(this.xua.innerText=
ResourceStrings.l_DesignerUpsellCalloutTitle,this.QS.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);N.setAttribute(na.a.wnb,na.a.vB);this.la.kZf?this.eo=new Lo.a(t,document.body,v.AFrameworkApplication.Aa.VQ,null):(this.eo=Ko.a.UOd(t,document.body,document.body,2,Object(n.a)(this,this.dismiss,"dismiss")),this.eo.NPe=120);this.eo.w$=310;this.MS.setAttribute(na.a.vs,String.format("{0}. {1}",this.xua.innerText,this.QS.innerText));this.MS.setAttribute(na.a.We,na.a.Kza);this.mu&&this.mu.addHandler(this.MS,
ka.a.eg,Object(n.a)(this,this.Pra,"inputKeyPressHandler"));this.eo.content=this.MS;this.kpa();N=new Sys.UI.Bounds(0,0,sa.a.SNc(),sa.a.RNc());this.eo.MY=this.vXd(N,t,240,ha);this.eo.hr=!1;this.eo.m8c=()=>{this.MS.parentNode&&Sys.UI.DomElement.addCssClass(this.MS.parentNode,"GoPremiumCalloutContentContainer");this.eo.RI&&(Sys.UI.DomElement.addCssClass(this.eo.RI,"GoPremiumCalloutOuter"),this.eo.RI.removeAttribute(na.a.We),this.la.kZf||(this.eo.RI.style.zIndex=String(v.AFrameworkApplication.Aa.zmb)));
this.eo.$Ie();this.MQ(this.Vja);this.E3b=!0};this.eo.show()}kpa(){if(ec.FocusManager.XL()){var t=ec.FocusManager.instance(),N=t.Bc("callout/modal");N.parent=hd.a.gj;t.AFd("callout/modal",hd.a.gj,this.MS);t.oX("callout/modal",!1);N.bindAction(this.dFg,tb.a.DCh);N=new Wb.DOMFocusListing(()=>this.MS);N.heb=!0;N.mo(2);t=t.aha(()=>this.MS,t.Bc("callout/modal"),N);t.ieb();t.cW=!0;t.PNa=!0}}meb(){if(ec.FocusManager.XL()&&!v.AFrameworkApplication.Xg){const N=ec.FocusManager.instance();var t=N.Bc("callout/modal");
t&&t.$o(this.dFg);N.s4("callout/modal");(t=N.zP("callout/modal"))&&t.qj.fE(null);N.zEb("callout/modal")}}MQ(t){ec.FocusManager.XL()?ec.FocusManager.instance().zP("callout/modal").qj.F5a(t):t.focus()}get AK(){return!!this.eo&&this.eo.AK}opj(){this.AK&&(this.E3b?this.L9a.focus():this.Vja.focus(),this.E3b=!this.E3b)}XWf(){this.dismiss();return!0}Qni(){this.dismiss();return 32}dismiss(){if(!this.ake){this.ake=!0;try{this.meb(),this.K6b&&(this.K6b.setAttribute(na.a.wnb,na.a.Bpa),ec.FocusManager.Dr(this.K6b),
this.K6b=null),this.Uyb&&(Sys.UI.DomElement.removeCssClass(this.Uyb,this.N3c),this.Uyb=null),this.Jpe=this.N3c=null,this.E3b=!1,this.eo&&(this.eo.dismiss(),this.eo.dispose(),this.eo=null),this.mu&&this.mu.removeHandler(this.MS,ka.a.eg,Object(n.a)(this,this.Pra,"inputKeyPressHandler"))}finally{this.ake=!1}}}dispose(){this.dismiss();this.ena();this.MS=this.L9a=this.Vja=null}Pra(t){if(t.keyCode===qa.a.aq||t.keyCode===qa.a.xO){t.preventDefault();t=document.activeElement;try{t?t.click():L.a.J(590967751,
829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(N){L.a.J(590967749,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",N)}}}FYg(){this.A5j(this.Jpe);return!0}dw(){this.gd?(this.gd.ob(ka.a.click,this.L9a,Object(n.a)(this,this.XWf,"dismissAndReturn")),this.gd.ob(ka.a.click,this.Vja,Object(n.a)(this,this.FYg,"onGoPremiumClicked"))):L.a.J(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}ena(){this.gd&&
(this.gd.xb(ka.a.click,this.L9a,Object(n.a)(this,this.XWf,"dismissAndReturn")),this.gd.xb(ka.a.click,this.Vja,Object(n.a)(this,this.FYg,"onGoPremiumClicked")))}vXd(t,N,ha,Aa){if(Aa)return 0;Aa=6;N.y-t.y<ha&&(Aa=3);return Aa}}Object(h.a)(Rk,"PremiumContentCallout",null,[]);class ol{constructor(t,N,ha,Aa,Ra,yb,Sb,uc){this.Tpb=t;this.BNi=N;this.pIc=ha;this.Fh=Aa;this.Jea=Ra;this.u5a=yb;this.gMe=Sb;this.amd=uc}}Object(h.a)(ol,"RenderSuggestionsArgs",null,[865]);class pi extends Sys.EventArgs{constructor(t){super();
this.card=t}}Object(h.a)(pi,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class Eg extends Sys.EventArgs{constructor(t){super();this.PUc=t}}Object(h.a)(Eg,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class Hm extends Sys.EventArgs{constructor(t,N){super();this.gZk=t;this.iil=N}}Object(h.a)(Hm,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class ye extends $n.a{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff){super(new Cp.a,t,yb);this.$9a=this.a$a=this.PK=this.SZ=this.p7b=this.qW=
null;this.KGg=this.MGg=0;this.$ja=!1;this.bQg=this.bFa=this.szb=null;this.xo=ha;this.Rq=Aa;this.Ob=Ra;this.Fa=Sb;this.gd=uc;this.fe=N;this.Vo=Zc;this.mu=ed;this.ia=Gd;this.gf=ze;this.la=re;this.UCh=this.la.useWideSuggestionThumbs;this.qQ=new tc.a(()=>new Rk(this.ia,this.la,N,uc,ed,Object(n.a)(this,this.Tfg,"goPremiumExperience")));this.xEg=new Jo(ff,Object(n.a)(this,this.Kgk,"onAccountUpgrade"),re.wOa);this.o3=new Kj;this.$1j=Object.assign(new Fd(Gd,this.o3,this.la),{wz:tb.a.M7a})}dispose(){this.$ja&&
this.WMf();this.szb&&(this.szb.dispose(),this.szb=null);this.qQ.t7a&&this.qQ.value.dispose();super.dispose();L.a.J(512496477,829,50,"DesignerView::Dispose")}hQc(){this.qW=pb.a.Ee();this.qW.className="DesignerViewContainer";this.container.appendChild(this.qW);this.$ja=!0;L.a.J(512496476,829,50,"DesignerView::InitializeView")}WMf(){this.la.yHc&&this.Rq.cmi();if(this.qW.children&&0<this.qW.children.length)for(const t=0;t<this.qW.children.length;)this.qW.removeChild(this.qW.children[t]);this.xo.v$=0;
this.xo.Vch(Object(n.a)(this,this.onFocus,"onFocus"));this.xo.Wch(Object(n.a)(this,this.wYg,"onFocusBlur"));this.qQ.t7a&&this.qQ.value.dismiss();L.a.J(512496475,829,50,"DesignerView::CleanUpView")}dYa(t){L.a.J(512496474,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",this.Ob.correlationId,Rl[t]);this.BM();4!==t&&7!==t&&8!==t&&(this.WMf(),this.qW.id=this.Ob.correlationId);this.xo.v$=t;switch(this.xo.v$){case 1:this.Rvj();this.d6k();break;case 7:this.c6k();break;case 2:this.Yvj();
break;case 9:this.Xvj();break;case 5:this.iwj();break;case 3:this.owj();break;case 6:this.Svj();break;case 4:if(t=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let N=0;N<t.length;N++)t[N].style.visibility=Ub.a.visible,t[N].setAttribute(ae.xKd,ae.WJf)}this.xo.zCf(Object(n.a)(this,this.onFocus,"onFocus"));this.xo.ACf(Object(n.a)(this,this.wYg,"onFocusBlur"))}Iqa(){return this.la.IVf&&this.xEg.Iqa()}Tfg(t){this.la.IVf&&(L.a.J(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",
t?t.toString():""),this.qQ.t7a&&this.qQ.value.dismiss(),this.xEg.launchUpsellExperience(this.la.wOa?"designertrial":"designer"))}startFreeTrial(){this.qQ.t7a&&this.qQ.value.dismiss();this.Rq.Snl();this.Ob.jNe=!0;this.jw(0,!0);L.a.J(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}Kgk(){L.a.J(512496471,829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.qQ.t7a&&this.qQ.value.dismiss();this.Rq.ysl()}Rvj(){this.p7b=pb.a.Ee();this.p7b.className="DesignerLoadingView";
const t=pb.a.CB();t.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";t.src=Vg.a.cK(hb.a.Sla);const N=pb.a.Ee();N.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";N.innerText=ResourceStrings.L_DesignerLoading;this.p7b.appendChild(t);L.a.J(512496470,829,50,"DesignerView::spinner shows up");this.p7b.appendChild(N);this.qW.appendChild(this.p7b);L.a.J(512496469,829,50,"DesignerView::InitLoadingState")}Zvj(){const t=
pb.a.Ee();t.className="DesignerNoSuggestionNewButton";t.tabIndex=0;t.innerText=ResourceStrings.L_DesignerLearnMoreShort;t.setAttribute("Unselectable","on");t.setAttribute(na.a.vs,t.innerText);t.setAttribute(na.a.We,na.a.Xt);t.setAttribute("href",hb.a.DVf);this.gd.ob(ka.a.click,t,Object(n.a)(this,this.LNf,"clickSuggestionLinkHandler"));this.SZ.appendChild(t)}Wvj(){const t=pb.a.Saa();t.className="DesignerNoSuggestionView-Link";t.setAttribute("href",hb.a.DVf);t.setAttribute("target","_blank");t.innerText=
ResourceStrings.L_DesignerLearnMore;t.tabIndex=0;t.setAttribute(na.a.We,na.a.AId);this.SZ.appendChild(t);this.gd.ob(ka.a.click,t,Object(n.a)(this,this.LNf,"clickSuggestionLinkHandler"))}Yvj(){this.xo.isVisible&&(this.t5d(!1),this.a$a.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.$9a.innerText=ResourceStrings.L_DesignerNoSuggestionContent,L.a.J(512496468,829,50,"DesignerView::InitNoSuggestionState"))}Xvj(){this.xo.isVisible&&(this.t5d(!0),this.a$a.innerText=ResourceStrings.L_DesignerNoIdeasHeader,
this.$9a.innerText=ResourceStrings.L_DesignerNoIdeas,L.a.J(512496467,829,50,"DesignerView::InitNoSuggestionState"))}iwj(){this.xo.isVisible&&(this.t5d(!1),this.a$a.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.$9a.innerText=ResourceStrings.L_DesignerCoauthorContent,L.a.J(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}t5d(t){this.SZ=pb.a.Ee();this.SZ.className=v.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.a$a=pb.a.Ee();
this.$9a=pb.a.Ee();this.Rq.Idh(this.qW);if(t){this.a$a.className="DesignerNoSuggestionNew-Header";this.$9a.className="DesignerNoSuggestionNew-Content";const N=pb.a.CB();N.src=this.fe.Yj("DesignerNoIdeas.svg");N.className="DesignerNoIdeasIllustration";this.SZ.appendChild(N)}else this.a$a.className="DesignerNoSuggestionView-Header",this.$9a.className="DesignerNoSuggestionView-Content";this.SZ.appendChild(this.a$a);this.SZ.appendChild(this.$9a);t?this.Zvj():this.Wvj();this.qW.appendChild(this.SZ);this.mu.addHandler(this.SZ,
ka.a.eg,Object(n.a)(this,this.Pra,"inputKeyPressHandler"))}owj(){this.xo.isVisible||this.xo.Yo(!0,sh.a.none);this.PK=pb.a.Ee();const t=this.UCh?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",N=this.UCh?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.PK.className=v.AFrameworkApplication.isRtl?N:t;this.qW.appendChild(this.PK);this.la.GVf||(this.Fa.Gj(hd.a.S6,!0),this.Fa.Ad());this.gd.ob(ka.a.click,this.PK,Object(n.a)(this,this.rni,"clickSuggestionHandler"));this.mu.addHandler(this.PK,
ka.a.eg,Object(n.a)(this,this.jQc,"inputKeyApplyHandler"));this.Vo.ob(ka.a.pointerOver,this.PK,Object(n.a)(this,this.jC,"onPointerOver"));this.Vo.ob(ka.a.pointerOut,this.PK,Object(n.a)(this,this.Py,"onPointerOut"));L.a.J(512496465,829,50,"DesignerView::InitShowSuggestionState")}ybj(){return this.z0b(this.PK.querySelector("#"+this.yp.id+" .DesignerSuggestionResultSelected"))}i4i(){return this.z0b(this.PK.querySelector("#"+this.yp.id+" ["+ae.gob+"]:hover"))}z0b(t){let N;return({suggestionIndex:N}=this.deg(t)).returnValue?
parseInt(N):-1}deg(t){let N,ha,Aa;Aa=ha=N="";if(t){const Ra=t.getAttribute(ae.Sza),yb=t.getAttribute(ae.gob);if(!Ra||!yb)return L.a.J(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Ob.correlationId),{returnValue:!1,suggestionIndex:N,slideId:ha,xMe:Aa};N=Ra.toString();ha=yb.toString();(t=t.getAttribute(ae.wKd))?Aa=t.toString():L.a.J(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",
this.Ob.correlationId);return{returnValue:!0,suggestionIndex:N,slideId:ha,xMe:Aa}}return{returnValue:!1,suggestionIndex:N,slideId:ha,xMe:Aa}}A0b(){return this.PK.querySelectorAll("#"+this.yp.id+" ["+ae.Sza+"]").length}LNf(t){return this.xo.isVisible&&t&&t.wB?this.egg(t.wB.className):!1}jia(){const t=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",N=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+
(v.AFrameworkApplication.isRtl?N:t))}qni(t){t=t.getAttribute(ae.Sza).toString();t=this.Ob.yNa[parseInt(t)];if(!t||3!==t.Type&&4!==t.Type)return!1;this.gf.gEk(new pi(t));return!0}$Ic(t,N){for(;t&&t.className!==N;)t=t.parentNode;return t}rni(t){if(!this.xo.isVisible||t.Sz!==Sys.UI.MouseButton.leftButton||!this.Rq.Ba||!t.Fc)return!1;var N=t.Fc;try{if(N.className){if(N.className===td.cBb||N.className===td.dBb||N.className===td.Yre||N.className===td.i5c)return this.pni(N);if(N.className.startsWith(td.LYf))return this.oni(N)}else L.a.J(512496462,
829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(Gd){return L.a.J(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",N.className,Gd.message),!1}if(t=this.$Ic(N,ae.eKf))return this.qni(t);if(this.Iqa()){if(N.className===ae.eob)return this.startFreeTrial(),!0;if(N.className===ae.pUb)return t=dd.a.Yh(N),this.qQ.value.show(t,N,!0,N,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(t=this.$Ic(N,ae.oUb))||(t=this.$Ic(N,ae.FBc));if(t)return this.Tfg(null),
!0}if(this.la.Aha&&(t=this.$Ic(N,ae.rKd))){this.Rq.iPc(this.jia());if(!t.getAttribute(ae.dob))return!1;this.Rq.dcl(this.jia());t=new Eg(t.getAttribute(ae.dob).toString());this.gf.sEk(t);return!0}if(Sys.UI.DomElement.containsCssClass(N,"ms-Icon--Diamond")){if(N=N.parentNode,!N)return!1}else if(!(Sys.UI.DomElement.containsCssClass(N,ae.PBc)||Sys.UI.DomElement.containsCssClass(N,ae.qUb)||Sys.UI.DomElement.containsCssClass(N,ae.QBc)||(N=N.firstChild,N)))return!1;t=N.parentNode;var ha=document.querySelector("#"+
this.yp.id+" ."+ae.tNa);if(!({suggestionIndex:uc,slideId:Zc,xMe:ed}=this.deg(t)).returnValue)return!1;var Aa=parseInt(uc),Ra=parseInt(Zc);const yb=parseInt(ed)||0;let Sb=this.Ob.JY.sid===Ra;this.la.Aha&&(Sb=this.Rq.yrb(ha,!1)===t||this.Rq.yrb(ha,!0)===t);if(Sb)return L.a.J(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),this.gf.x9g(new Hm(Aa,this.A0b())),!1;if(t&&t.getAttribute(ae.IBc)){N=null;ha=t.childNodes;for(Aa=0;Aa<ha.length;Aa++)if(Ra=ha[Aa],Sys.UI.DomElement.containsCssClass(Ra,
ae.PBc)){N=Ra;break}ha=new sm(uc,Zc,ed);N=dd.a.Yh(N||t);this.qQ.value.show(N,t,!1,null,null,ha);return!1}if(Sys.UI.DomElement.containsCssClass(N,ae.QBc))return!1;var uc=this.cbj(N,Ra,yb);var Zc=Object.assign(new Ri,{SuggestionCid:yb,SuggestionSid:Ra,CorrelationId:ha.getAttribute("correlationId").toString(),ActiveSlideCid:this.Rq.Ba.cid,ActiveSlideSid:this.Rq.Ba.sid});var ed=N;ed=.01>=Math.abs(ed.width/ed.height-1.33);this.Rq.yrb(ha,ed)?(this.Rq.VMf(ha,ed),uc&&uc.parentNode&&uc.parentNode.parentNode&&
this.Rq.VMf(uc.parentNode.parentNode,ed),this.ia.Ka(tb.a.pnb,2,Zc),L.a.J(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.ia.Ka(tb.a.Hza,2,Zc),L.a.J(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.la.KEi&&t&&t.getAttribute(ae.kKd)&&u.a.instance.La("Common.ISystemInitiatedFeedback").execute(Gd=>{try{Gd.logActivity("DesignerAnimationSuggestion",null)}catch(ze){L.a.J(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",
ze)}});this.Rq.Yjh(N.parentNode,ed);uc&&this.Rq.Yjh(uc.parentNode,ed);this.Rq.rih(this.qW,Aa);this.gf.x9g(new Hm(Aa,this.A0b()));return!0}cbj(t,N,ha){var Aa="["+ae.gob+'="'+N+'"] > .'+ae.qUb;ha&&(Aa=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',ae.gob,N,ae.wKd,ha,ae.qUb));N=document.querySelectorAll(Aa);if(!N)return null;for(ha=0;ha<N.length;ha++)if(Aa=N[ha],Aa!==t)return Aa;return null}Pra(t){this.xo.isVisible&&(t.keyCode!==qa.a.aq&&t.keyCode!==qa.a.xO||this.egg(t.target.className))}jQc(t){!this.xo.isVisible||
t.keyCode!==qa.a.aq&&t.keyCode!==qa.a.xO||(t.preventDefault(),(t=document.activeElement)&&t.click())}jw(t,N){if(!(0>t)){var ha=this.PK.querySelector("["+ae.Sza+'="'+t+'"]');ha?N&&(ec.FocusManager.Dr(ha),this.Rq.rih(this.qW,t)):L.a.J(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",t)}}kfg(){return this.Iqa()?this.PK.querySelector("."+ae.pUb)?2:this.PK.querySelector("."+ae.eob)?1:this.PK.querySelector("."+ae.oUb)?3:0:0}Xwg(){return!!this.PK.querySelector("."+ae.eob+
":focus")}Ijc(t){const N=this.PK.querySelector("."+ae.eob);N?t?ec.FocusManager.Dr(N):N.blur():L.a.J(512496455,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}jig(){this.Wxg()&&this.qQ.value.opj()}Wxg(){return this.qQ.t7a&&this.qQ.value.AK}pPj(t){return t?!!t&&(t.className===ae.eob||t.className===ae.FBc||t.className===ae.pUb||t.className===ae.oUb):!1}Fma(t,N){let ha=null;1===N?ha=this.PK.querySelector("."+ae.FBc):2===N?ha=this.PK.querySelector("."+ae.pUb):3===N&&
(ha=this.PK.querySelector("."+ae.oUb));ha?t?ec.FocusManager.Dr(ha):ha.blur():L.a.J(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",N)}F5k(t,N){(N=9===N?this.SZ.querySelector(".DesignerNoSuggestionNewButton"):this.SZ.querySelector(".DesignerNoSuggestionView-Link"))?t?N.focus():N.blur():L.a.J(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}ONj(t){return!(9===t?!this.SZ.querySelector(".DesignerNoSuggestionNewButton:focus"):
!this.SZ.querySelector(".DesignerNoSuggestionView-Link:focus"))}egg(t){try{const N=this.SZ.querySelector("."+t);if(!N)return!1;const ha=N.getAttribute("href").toString();if(!ha)return!1;dd.a.openWindow(4,ha);return!0}catch(N){return L.a.J(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",N),!1}}wYg(){this.xo.isVisible&&this.qQ.t7a&&this.qQ.value.AK&&this.qQ.value.dismiss()}onFocus(){if(this.xo.isVisible)if(2===this.xo.v$)ec.FocusManager.Dr(this.SZ.lastChild);else if(3===this.xo.v$){var t=
this.kfg();if(1===t)this.Ijc(!0);else if(3===t)this.Fma(!0,t);else{t=this.ybj();var N=this.i4i();-1===t?this.jw(-1===N?0:N,!0):this.jw(t,!0)}}}jC(t){return this.xo.isVisible&&t.Fc?this.KYf(t.clientPoint):!1}Py(t){return this.xo.isVisible&&t.Fc?this.KYf(t.clientPoint):!1}ulj(t){this.BM();this.dYa(2);L.a.J(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",t);this.xo.isVisible&&(this.Ob.hSa=!0,this.ia.Ka(tb.a.mma,2,new ao.a(!1,sh.a.wid)))}d6k(){const t=this.Ob.correlationId;
this.MGg=window.setTimeout(()=>{this.ulj(t)},this.la.aRd)}tlj(t){this.BM();this.Rq.iPc(this.jia());L.a.J(512496450,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",t)}c6k(){const t=this.Ob.correlationId;this.KGg=window.setTimeout(()=>{this.tlj(t)},this.la.aRd)}BM(){window.clearTimeout(this.MGg);window.clearTimeout(this.KGg)}get yp(){return this.xo}Svj(){this.PK.style.display=Ub.a.none;this.Ob.mre=!0;this.bFa=pb.a.Ee();this.bFa.className=td.bdk;const t=this.cSf(td.$re),N=document.createElement("iframe");
N.className=N.id=td.hTg;const ha=this.cSf(td.Zre);this.bFa.appendChild(t);this.bFa.appendChild(N);this.bFa.appendChild(ha);this.qW.appendChild(this.bFa);const Aa=this.Fa.Bc(hd.a.DPc);Aa.parent=va.AFrame.XC;this.gd.Zyc(hd.a.DPc,N);Aa.zaa(()=>{N.focus();const Ra=Object.assign(new Wb.DOMFocusListing(()=>this.bFa),{heb:!0});Ra.mo(3);Ra.mo(2);Ra.mo(4);Ra.mo(1);Ra.mo(6);Ra.mo(5);ec.FocusManager.instance().VJd(this.bFa,Aa,Ra);const yb=ec.FocusManager.instance().zP(hd.a.DPc);yb.ieb();yb.cW=!0;yb.PNa=!0;Aa.$o(ec.FocusManager.instance().Poa);
Aa.$o(ec.FocusManager.instance().Qoa);Ra.fE(N)});this.Fa.Bf(hd.a.DPc);this.mu.addHandler(this.bFa,ka.a.eg,Object(n.a)(this,this.Az,"keyDownHandler"))}cSf(t){const N=document.createElement("div");N.setAttribute("Id",t);N.setAttribute("tabindex",0);N.setAttribute("position","absolute");N.setAttribute("width","-1000px");N.setAttribute("top","-1000px");return N}Az(t){t.keyCode===Sys.UI.Key.tab&&(t.target.id!==td.Zre||t.shiftKey?t.target.id===td.$re&&t.shiftKey&&this.klh(t,td.Zre):this.klh(t,td.$re))}klh(t,
N){t.preventDefault();t.stopPropagation();(t=document.getElementById(N))&&t.focus()}pni(t){switch(t.className){case td.i5c:return this.yp.Afb(1),!0;case td.cBb:t=t.querySelector("."+td.dBb).innerText;break;case td.dBb:t=t.innerText;break;case td.Yre:t=t.parentNode.querySelector("."+td.dBb).innerText;break;default:return!1}return this.rRk(t)}rRk(t){this.la.Aha&&(this.bQg=this.jia().querySelector("."+ae.tNa).getAttribute("correlationId").toString());this.dYa(6);var N=gb.a.zM(this.la.pptEditingUserId).toString();
N=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,jk.a.le(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,Lc.a.create().toString(),3,N,0);N=N.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+t;t=document.getElementById(td.hTg);t.setAttribute("src",N);t.style.visibility=Ub.a.visible;this.szb=(new Cj).getInstance(t.contentWindow,N);this.szb.Iva(ce.a.ZAf,ha=>{if(ha=this.o3.g3g(ha)){const Aa=[];Array.add(Aa,ha);this.ia.processAction(tb.a.fhd,
2);this.yp.Yo(!1,sh.a.cOf);this.$1j.Qra(Aa)}});this.szb.Iva(Kd.bK,()=>{this.dYa(3);const ha=new ol(this.Ob.suggestions,this.Ob.suggestions?this.Ob.suggestions.SlideSuggestions.length:0,this.Ob.yNa.length,this.la.Aha?this.bQg:this.Ob.correlationId,this.jia(),!0,this.Iqa(),this.Rq.SPc(Pd.makeItVisual));this.Rq.iEe(ha)});return!0}oni(t){return Sys.UI.DomElement.containsCssClass(t,td.oqb)||Sys.UI.DomElement.containsCssClass(t,td.nqb)?this.Ykj(t):Sys.UI.DomElement.containsCssClass(t,td.MOa)||Sys.UI.DomElement.containsCssClass(t,
td.oHc)||Sys.UI.DomElement.containsCssClass(t,td.PYf)||Sys.UI.DomElement.containsCssClass(t,td.OYf)?this.Zkj(t):Sys.UI.DomElement.containsCssClass(t,td.aYb)?this.Elj():Sys.UI.DomElement.containsCssClass(t,td.eYb)?this.Imj():!1}Imj(){this.ia.processAction(tb.a.Nye,2);this.yp.Yo(!1,sh.a.eqk);return this.Ob.EYf=!0}KYf(t){const N=this.Ob.sNd;if(!N||$e.a.Va(this.Ob.oV))return!1;t=dd.a.PPa(t);this.cFj(t)?N.qPc(this.k8f()):N.qPc([]);return!0}cFj(t){for(;t&&t.className!==td.DSd;)t=t.parentNode;return!!t&&
t.className===td.DSd}Elj(){const t=this.Ob.sNd;if(!t)return!1;t.ignoreCritiques(this.k8f(),4);this.Ob.oV.splice(this.Ob.HM,1);if(this.Ob.HM===this.Ob.oV.length){let N;(N=this.Ob).HM=N.HM-1}this.MJk();return!0}k8f(){const t=[];for(const N of this.Ob.oV[this.Ob.HM].critiques)t.push(N.critiqueId);return t}Ykj(t){if(Sys.UI.DomElement.containsCssClass(t,td.oqb)){let N;(N=this.Ob).HM=N.HM-1;this.Ob.HM||(Sys.UI.DomElement.removeCssClass(t,td.oqb),Sys.UI.DomElement.addCssClass(t,td.cYb));t=document.getElementById(td.mqb);
Sys.UI.DomElement.removeCssClass(t,td.bYb);Sys.UI.DomElement.addCssClass(t,td.nqb)}else{let N;(N=this.Ob).HM=N.HM+1;this.Ob.HM===this.Ob.oV.length-1&&(Sys.UI.DomElement.removeCssClass(t,td.nqb),Sys.UI.DomElement.addCssClass(t,td.bYb));t=document.getElementById(td.Q4a);Sys.UI.DomElement.removeCssClass(t,td.cYb);Sys.UI.DomElement.addCssClass(t,td.oqb)}document.getElementById(td.CSd).innerText=(this.Ob.HM+1).toString();this.QAh(this.Ob.HM);return!0}QAh(t){var N=this.Ob.oV[t].critiques[0].explanationLabel;
document.getElementById(td.NYf).innerText=N;N=document.getElementById(td.QYf);const ha=ae.FRf();N.parentNode.replaceChild(ha,N);this.Rq.Ohg(ha,t)}Zkj(t){const N=this.Ob.sNd;if($e.a.Va(this.Ob.oV)||!N)return!1;t=t.getAttribute(Kd.LOa);var ha=document.querySelector("."+td.oHc+"["+Kd.LOa+'="'+t+'"]');ha&&(ha.innerText="\u2713",Sys.UI.DomElement.removeCssClass(ha,td.oHc),Sys.UI.DomElement.addCssClass(ha,td.DJi));ha=new Id.a(0);for(const Aa of this.Ob.oV[this.Ob.HM].critiques)ha.add(Aa.critiqueId,t);N.evh(ha);
return this.Ob.mHc=!0}MJk(){var t=document.getElementById(td.CYf);let N=parseInt(t.innerText);N--;if(0>=N)this.kcl(document.getElementById(td.DYf));else{t.innerText=N.toString();this.QAh(this.Ob.HM);t=this.Ob.HM===this.Ob.oV.length-1;const ha=document.getElementById(td.mqb);1<N&&!t?(Sys.UI.DomElement.addCssClass(ha,td.nqb),Sys.UI.DomElement.removeCssClass(ha,td.bYb)):(Sys.UI.DomElement.addCssClass(ha,td.bYb),Sys.UI.DomElement.removeCssClass(ha,td.nqb));t&&(document.getElementById(td.CSd).innerText=
N.toString());t=document.getElementById(td.Q4a);1<N&&this.Ob.HM?(Sys.UI.DomElement.addCssClass(t,td.oqb),Sys.UI.DomElement.removeCssClass(t,td.cYb)):(Sys.UI.DomElement.addCssClass(t,td.cYb),Sys.UI.DomElement.removeCssClass(t,td.oqb))}}kcl(t){const N=pb.a.Ee();N.className=td.xJi;const ha=new Vd.a;ha.yh(40,40);ha.mwa("0,0,2048,2048");ha.ot(td.EJi);var Aa=new ad.a;Aa.a0("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Ra=new ad.a;Ra.a0("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Ra.ya.setAttribute("class",td.HJi);const yb=
new ad.a;yb.a0("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
yb.ya.setAttribute("class",td.vJi);const Sb=new ad.a;Sb.a0("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Sb.ya.setAttribute("class",td.uJi);ha.appendChild(Aa);ha.appendChild(Ra);ha.appendChild(yb);ha.appendChild(Sb);Aa=pb.a.zn();Aa.innerText=ResourceStrings.l_ConsistencyCardNoMore;Aa.className=td.yJi;N.appendChild(ha.ya);N.appendChild(Aa);t.parentNode.replaceChild(N,t)}}ye.sJi=[td.Q4a,td.mqb,td.MOa,td.aYb,td.eYb];Object(h.a)(ye,"DesignerView",$n.a,[786,390,202,106]);var pl=d(205);class cm extends Sys.EventArgs{constructor(t,N){super();this.slideId=t.slideId;this.Ith=t.olc;this.K0f=t.k$;this.u5a=N;this.trigger=
t.trigger;this.correlationId=t.correlationId}}Object(h.a)(cm,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class bo{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze){this.FHg=new ef.a;this.Qq=t;this.Rq=N;this.Ob=ha;this.la=Aa;this.ia=Ra;this.ta=yb;this.Db=Sb;this.Qc=uc;this.Fa=Zc;this.R6b=this.xee=0;this.MTa=ed;this.nZj=Gd;this.tua=ze;this.dw()}dw(){this.Qc.I3h(Object(n.a)(this,this.F0g,"onSuggestionsUpdated"));this.Qc.H3h(Object(n.a)(this,this.nXg,"onCoauthModifiedSameSlide"));this.nZj.execute(t=>
{t.d1h(Object(n.a)(this,this.tok,"onShowMoreSuggestions"),()=>{this.VFb(this.Qq,3)})});this.la.designerIncrementalRenderEnabled&&this.Qc.F4h(Object(n.a)(this,this.g1g,"onUserBeginUploadPicture"));this.Qc.Lzc(Object(n.a)(this,this.Fla,"onUndoRedo"))}dispose(){this.Qc.wPk(Object(n.a)(this,this.F0g,"onSuggestionsUpdated"));this.Qc.vPk(Object(n.a)(this,this.nXg,"onCoauthModifiedSameSlide"));this.la.designerIncrementalRenderEnabled&&this.Qc.dQk(Object(n.a)(this,this.g1g,"onUserBeginUploadPicture"));this.Qc.Dcd(Object(n.a)(this,
this.Fla,"onUndoRedo"))}c_k(t){this.ia.Ka(tb.a.mma,2,new ao.a(!1,t))}VFb(t,N){t?t.dYa(N):L.a.J(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Ob.correlationId,N)}lpj(t){const N=this.uFi(t);if(N){var ha=N.yp;L.a.J(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",t,Rl[ha.v$]);switch(ha.v$){case 3:this.fek(t,N);break;case 2:case 9:this.eek(t,N,ha.v$)}}}uFi(t){switch(t){case tb.a.QVa:case tb.a.rBb:case tb.a.sBb:case tb.a.RVa:case tb.a.uBb:case tb.a.vBb:case tb.a.tBb:case tb.a.ucb:t=
this.Qq;break;default:return null}return t}fek(t,N){if(N&&N.yp){var ha=document.activeElement;if(ha){var Aa=ha.getAttribute(ae.Sza),Ra=N.pPj(ha),yb=Sys.UI.DomElement.containsCssClass(ha,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(ha,"IdeasText"),Sb=this.gTg(ha)||this.FYf(ha),uc=N.Wxg();if(Aa||yb||Sb||Ra||uc)if(Aa=Aa?parseInt(Aa.toString()):-1,Ra=N.A0b()-1,!(1>Ra))switch(yb=N.yp,Sb=N.kfg(),t){case tb.a.QVa:if(uc||1===Sb||3===Sb)break;yb.Zz(!1);Aa<Ra&&(N.jw(Aa,!1),N.jw(Aa+1,!0));
break;case tb.a.rBb:if(uc||1===Sb||3===Sb)break;yb.Zz(!1);Aa!==Ra&&(N.jw(Aa,!1),N.jw(Ra,!0));break;case tb.a.sBb:if(uc){N.jig();break}this.Amj(N,Aa,Ra,Sb);break;case tb.a.RVa:if(uc||1===Sb||3===Sb)break;yb.Zz(!1);0<Aa&&(N.jw(Aa,!1),N.jw(Aa-1,!0));break;case tb.a.uBb:if(uc||1===Sb||3===Sb)break;yb.Zz(!1);Aa&&(N.jw(Aa,!1),N.jw(0,!0));break;case tb.a.vBb:if(uc){N.jig();break}this.Bmj(N,Aa,Ra,Sb);break;case tb.a.tBb:case tb.a.ucb:uc||1===Sb||3===Sb||(t=t===tb.a.ucb,N=N.yp,this.gTg(ha)?this.Dmj(t,N):this.FYf(ha)&&
this.Cmj(t,N))}}}}Amj(t,N,ha,Aa){const Ra=t.yp;if(-1===N){switch(Aa){case 1:Ra.yRa?(Ra.Zz(!1),t.Ijc(!0)):t.Xwg()?(t.Ijc(!1),t.Fma(!0,Aa)):(t.Fma(!1,Aa),Ra.Zz(!0));return;case 2:Ra.yRa?(Ra.Zz(!1),t.jw(0,!0)):(t.Fma(!1,Aa),Ra.Zz(!0));return;case 3:N=Ra.yRa;Ra.Zz(!N);t.Fma(N,Aa);return}Ra.Zz(!1);t.jw(0,!0)}else N===ha?(t.jw(N,!1),2===Aa?t.Fma(!0,Aa):Ra.Zz(!0)):(t.jw(N,!1),t.jw(N+1,!0))}Bmj(t,N,ha,Aa){const Ra=t.yp;if(0<N)t.jw(N,!1),t.jw(N-1,!0);else if(-1===N){switch(Aa){case 1:Ra.yRa?(Ra.Zz(!1),t.Fma(!0,
Aa)):t.Xwg()?(t.Ijc(!1),Ra.Zz(!0)):(t.Fma(!1,Aa),t.Ijc(!0));return;case 2:Ra.yRa?(Ra.Zz(!1),t.Fma(!0,Aa)):(t.Fma(!1,Aa),t.jw(ha,!0));return;case 3:N=Ra.yRa;Ra.Zz(!N);t.Fma(N,Aa);return}Ra.yRa&&(Ra.Zz(!1),t.jw(ha,!0))}else t.jw(0,!1),Ra.Zz(!0)}eek(t,N,ha){if(N){var Aa=N.yp;if(t===tb.a.sBb||t===tb.a.vBb||t===tb.a.RVa||t===tb.a.QVa)t=N.ONj(ha),Aa.Zz(t),N.F5k(!t,ha)}}gTg(t){return Sys.UI.DomElement.containsCssClass(t,td.i5c)||Sys.UI.DomElement.containsCssClass(t,td.cBb)}FYf(t){return t.className.startsWith(td.LYf)}Dmj(t,
N){var ha=document.activeElement;ha&&(Sys.UI.DomElement.containsCssClass(ha,td.cBb)?(ha=parseInt(ha.getAttribute(td.iTg).toString())+1,t?ha!==Kd.Hbc?N.Afb(ha+1):N.Afb(1):1!==ha?N.Afb(ha-1):N.Afb(Kd.Hbc)):t?N.Afb(1):N.Afb(Kd.Hbc))}Cmj(t,N){var ha=document.activeElement;if(ha){for(var Aa=ye.sJi,Ra=0;!Sys.UI.DomElement.containsCssClass(ha,Aa[Ra]);)if(Ra++,Ra===Aa.length){Ra=-1;break}var yb=document.querySelectorAll("."+td.MOa).length;Aa[Ra]!==td.MOa?t?Ra!==Aa.length-1&&-1!==Ra?Aa[Ra+1]!==td.MOa?this.Wsb(Aa[Ra+
1],N):N.mfd(0):this.Wsb(Aa[0],N):Ra&&-1!==Ra?Aa[Ra-1]!==td.MOa?this.Wsb(Aa[Ra-1],N):N.mfd(yb-1):this.Wsb(Aa[Aa.length-1],N):(ha=parseInt(ha.getAttribute(Kd.LOa).toString()),t?ha!==yb-1?N.mfd(ha+1):this.Wsb(Aa[Ra+1],N):ha?N.mfd(ha-1):this.Wsb(Aa[Ra-1],N))}}Wsb(t,N){switch(t){case td.Q4a:N.C1k();break;case td.mqb:N.B1k();break;case td.aYb:N.z1k();break;case td.eYb:N.A1k()}}w1b(t,N){if(this.la.BRc&&this.Qq.yp.isVisible){if(N&&(t===tb.a.Hza||t===tb.a.pnb)){this.Ob.JY=P.a.empty;N=this.ta.presentation;
const ha=this.Db.rd(7,void 0,void 0,void 0,!0);try{ha.jc(N),this.la.VEi&&(ha.$c=t),N.removeProperty(Xb.a.IAa)}finally{ha&&ha.dispose()}}this.Rq.Arl(this.Qq.jia());this.la.QEi&&t!==tb.a.Hza&&t!==tb.a.pnb&&this.ia.processAction(tb.a.HVf,2)}}Fla(t,N){this.w1b(N.XRe,N.T8a)}EDj(t){return this.Ob.Avb(t)}Qxg(t){switch(t){case qg.a.QId:case qg.a.TId:case qg.a.ITb:case qg.a.SId:case qg.a.UId:case qg.a.VId:case qg.a.gNa:case qg.a.WId:case qg.a.XId:case qg.a.YId:case qg.a.ZId:case qg.a.aJd:case qg.a.cJd:case qg.a.backspace:case qg.a.Oza:case qg.a.eK:case qg.a.sOa:case qg.a.enter:case qg.a.SA:case qg.a.typing:return!0;
default:return!1}}isEnabled(){return this.la.BRc}GDj(){return 0<this.R6b}EMd(){return this.R6b}nXg(t,N){t=N.slideId;L.a.J(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",t.sid);if((N=this.ta.Ba)&&N.Bb.equals(t)){N="unopened";this.Qq.yp.isVisible&&(this.Qq.yp.isVisible&&this.VFb(this.Qq,5),N="set to SameSlideCoauthNoSuggestion UI");let ha="unopened";this.Qq.yp.isVisible&&(this.sGa(this.Ob.correlationId,Mj.a.rGa),ha="closed");"unopened"===N&&"unopened"===
ha||L.a.J(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",N,ha,t.sid,t.cid,this.Ob.correlationId,this.xee,this.R6b)}}F0g(t,N){L.a.J(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.la.BRc,this.xee,
this.R6b,N.correlationId,N.trigger);if(this.isEnabled()){if(t=this.ta.Ba)if(N.slideId.equals(t.Bb))if(this.EDj(N.correlationId))L.a.J(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",N.correlationId);else if(this.Zxl(N.correlationId))L.a.J(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
N.correlationId);else{this.Ob.correlationId!==N.correlationId&&(this.Ob.vAf(N.correlationId,this.la.Aha&&N.trigger===Pd.moreIdeas),L.a.J(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Ob.correlationId,N.correlationId));if(this.Ob.correlationId===N.correlationId&&this.Qq.yp.isVisible&&3===this.Qq.yp.v$)if(this.la.designerIncrementalRenderEnabled&&$e.a.any(N.olc.toArray(),ha=>0<=this.Ob.uda.indexOf(ha)))this.Ob.Vbc=
new Date,L.a.J(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",N.correlationId,N.olc.toString(),this.Ob.uda.toString());else if(t=N.GIa,!this.la.designerIncrementalRenderEnabled||this.Ob.oqa.contains(t)){L.a.J(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",N.correlationId,t.toString());
return}t=ae.WQd(N.QAa);this.oXk(t,N);this.npj(N);this.mpj(this.Qq,N,t,N.k$,$e.a.Va(this.Ob.yNa)?N.k$:this.Ob.yNa.length)}else L.a.J(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",N.correlationId)}else L.a.J(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",N.correlationId)}oXk(t,N){if(t&&N.trigger!==Pd.moreIdeas){this.Ob.suggestions||(this.Ob.suggestions=Object.assign(new rk,
{CardData:t.CardData,SlideSuggestions:Array(N.d5d?N.k$:N.JYa)}));if(!$e.a.Va(t.SlideSuggestions))for(const ha of t.SlideSuggestions)this.Ob.suggestions.SlideSuggestions[ha.Index]=ha;this.Ob.yNa||(this.Ob.yNa=ae.Tsk(t))}}mpj(t,N,ha,Aa,Ra){L.a.J(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",N.correlationId,N.trigger,N.k$,Aa);if(N.trigger===Pd.moreIdeas)this.Ob.Kea||(this.Ob.Kea=new Date),Aa=t.A0b(),this.Rq.sRk(ha,t.jia(),N.correlationId,
t.Iqa())||(this.Rq.iPc(t.jia()),Aa=t.A0b()-1),t.jw(Aa,!0),this.VFb(t,8);else if(!Aa)!this.la.designerNewNoIdeasUxEnabled||N.trigger!==Pd.Amc&&N.trigger!==Pd.BIb?this.VFb(t,2):this.VFb(t,9),this.Qq.yp.isVisible?this.sGa(this.Ob.correlationId,Mj.a.rGa):this.c_k(sh.a.noSuggestion);else if(this.v$k(N.trigger,t.yp)){var yb=!0;if(this.la.designerIncrementalRenderEnabled){yb=null;var Sb=t.jia();Sb&&(yb=Sb.querySelector("#"+t.yp.id+" ."+ae.tNa+'[correlationId="'+N.correlationId+'"]'));yb=!yb;L.a.J(512496481,
829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",N.correlationId,N.trigger,yb);Sb=new cm(N,yb);this.Qc.FFk(Sb)}if(yb){this.VFb(t,3);this.Ob.Kea||(this.Ob.Kea=new Date);try{this.la.Xxk&&this.tua.execute(uc=>{uc.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(uc){L.a.J(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",uc)}}t=new ol(ha,Aa,Ra,N.correlationId,t.jia(),
yb,t.Iqa(),this.Rq.SPc(N.trigger));this.Rq.iEe(t)}}npj(t){t.d5d?($e.a.Va(this.Ob.suggestions.SlideSuggestions)||this.Ob.suggestions.SlideSuggestions.length===t.k$)&&this.sGa(t.correlationId,Mj.a.success,this.Ob.suggestions,t.trigger):this.sGa(t.correlationId,Mj.a.success,this.Ob.suggestions,t.trigger)}v$k(t,N){return N.isVisible||t!==Pd.oGa&&t!==Pd.rLd&&t!==Pd.Fob}Ehd(t,N){this.R6b=t;this.xee=N;this.Qc.RD(new pl.a(1))}g1g(){this.Qq.yp.isVisible&&3===this.Qq.yp.v$&&(this.FHg.add(this.Ob.correlationId),
this.Qq.dYa(1))}Zxl(t){return this.FHg.contains(t)}sGa(t,N,ha=null,Aa=""){L.a.J(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",t,N,Aa);this.MTa.execute(Ra=>{const yb=this.kui(t,ha);gb.a.Va(Aa)||(yb.trigger=Aa);Ra.notifySlideSuggestion(N,yb)})}kui(t,N){const ha=new Zn;ha.correlationId=t;if(!N)return L.a.J(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",t),ha;ha.suggestions=
this.Rq.xtk(N);return ha}tok(t){t=new ol(this.Ob.suggestions,t.suggestions.length,t.suggestions.length,t.correlationId,this.Qq.jia(),!0,this.Qq.Iqa(),this.Rq.SPc(t.trigger));this.Rq.iEe(t);this.Fa.Gj(hd.a.S6,!0)}Trk(){return 4===this.Qq.yp.v$}Qrk(){return 1===this.Qq.yp.v$}}Object(h.a)(bo,"DesignerManager",null,[789,106]);class Sk{constructor(t,N){this.Wab=this.Rp=null;this.z8j=N;this.ve=t;this.Yq=!1}get vh(){return this.Yq}setup(){this.vh||(this.Wab=pb.a.Ee(),this.Wab.setAttribute("Unselectable",
"on"),this.Wab.style.position=Ub.a.absolute,this.ve.addCssClass(this.Wab,"designerPreviewImageContainer"),this.Rp=new Bc.a,this.Yq=!0)}dispose(){this.vh&&(this.dismiss(),this.Rp&&this.Rp.ya.parentNode&&(this.Rp.iq(),this.ve.removeCssClass(this.Rp.ya,"designerPreviewImageContainer")))}dismiss(){this.vh?(this.dma(),this.Rp.setVisibility(!1)):L.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}cIa(t){if(this.vh){this.Wab&&(this.Wab.appendChild(this.Rp.ya),this.ve.addCssClass(this.Rp.ya,
"designerPreviewImageContainer"),this.Rp.setVisibility(!1));var N=this.z8j.Jc;if(t=this.aqa(t))this.dma(),N.Ahd.appendChild(this.Wab),this.Rp.ya.appendChild(t),this.Rp.setVisibility(!0);this.Rp.yh(N.rC.clientWidth,N.rC.clientHeight)}else L.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}aqa(t){if(!gb.a.Va(t)){const N=pb.a.CB();N.setAttribute("Unselectable","on");N.src=t;N.style.height="100%";N.style.width="100%";return N}return null}dma(){this.Rp.ya.firstChild&&this.Rp.ya.removeChild(this.Rp.ya.firstChild)}}
Object(h.a)(Sk,"DesignerPreviewImageView",null,[790]);var qi=d(157);class ql{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze){this.hL=null;this.eGa=0;this.ia=t;this.Db=N;this.nb=ha;this.ta=Aa;this.Qb=Ra;this.la=yb;this.ni=Sb;this.jj=uc;this.Xb=Zc;this.s8=ed;this.yb=Gd;this.Kd=ze;this.Eka=bm.ready}ub(){this.ia.pa(tb.a.fixIt,sb.a.application,Object(n.a)(this,this.mlj,"handleFixIt"),4);this.ia.pa(tb.a.Y7g,sb.a.application,Object(n.a)(this,this.Dnj,"handleQueryFixIt"),96);this.ia.pa(tb.a.qnb,sb.a.application,
Object(n.a)(this,this.qnb,"applyFixItSuggestion"),4);this.ia.pa(tb.a.dXa,sb.a.application,Object(n.a)(this,this.dXa,"reportFixItSessionInfo"),64);this.s8.OSb(Object(n.a)(this,this.Eda,"onBlockingStateChanged"))}dispose(){this.s8.ycd(Object(n.a)(this,this.Eda,"onBlockingStateChanged"))}mlj(t,N,ha){N=this.nb.ae();if(2>N.length)return 8;if(1===ha)return 32;ha=this.ta.presentation;this.la.designerBlockApplyUntilDraw?this.Xb.Ipa(ha,this.ta.Ba,this.Qb.Ma,t):this.Xb.zw(ha,t);this.jj.qRc=!0;const Aa=[];N.forEach(Ra=>
{Array.add(Aa,Ra.get_shapeId())});t={};t.SelectedShapeIds=Aa.join(",");this.jj.Tfb=Aa;this.G2d(t);this.jj.fhb=window.setTimeout(()=>{this.nlj(this.jj.correlationId)},this.la.N3f);return 32}nlj(t){this.jj.hSa=!0;L.a.J(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",t);this.ia.Ka(tb.a.dXa,2,sh.a.wid);this.Kd.tqa(ee.a.Mh(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}G2d(t=null,N=null){this.dNi(ha=>{if(this.la.designerRequestThrottlingEnabled){if(this.Eka.gwg&&
+new Date-+this.Eka.fzg<this.la.designerRequestThrottleIntervalMs){this.hL=new rg;this.hL.sid=ha.sid;this.hL.cid=ha.cid;this.hL.sPc=ha.MP;return}this.Eka=bm.inProgress;this.hL=null}const Aa=()=>{this.G2d(this.hL.sPc,N)};this.ni.Vha(ha.cid,ha.sid,ha.correlationId,null,Ne.a.fixIt,N,of.c(ha.MP),Ra=>{Ra&&Ra.Status===Ne.a.ifh?this.wdd(()=>{this.G2d(ha.MP,N)}):this.eGa=0;this.eGa||this.t1b(Aa)},Ra=>this.Wcb(Ra,Aa))},t)}wdd(t){this.eGa<this.la.designerMaxRetryOnWait?this.yb.Gb(new Y.a(2,1,1E3,()=>{L.a.J(578937822,
829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.jj.correlationId);this.Eka=bm.ready;this.eGa++;t()},void 0,"RetryRequestOnWait")):L.a.J(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.jj.correlationId)}qnb(t,N,ha,Aa,Ra){N=this.ta.presentation;if(!this.ta.Ba||!N)return 16;Aa=null;Object(Lj.a)(Ri,Ra)&&(Aa=Ra);if(!Aa)return 8;if(1===ha)return 32;ha=this.Db.je(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&
(this.jj.$Ma=new Date),ha.jc(N),ha.$c=t,N.IAa=Aa,this.jj.JY=P.a.bE(Aa.SuggestionSid,Aa.SuggestionCid),this.jj.DS=!0,L.a.J(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Aa.CorrelationId,t,Aa.SuggestionSid)}finally{ha&&ha.dispose()}return 32}dNi(t,N=null){const ha=this.ta.Ba;ha&&ha.sid&&(N=Object.assign(new El,{sid:ha.sid,cid:ha.cid,MP:N||{}}),L.a.J(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",N.sid,N.correlationId),this.jj.correlationId&&
this.FFb(sh.a.Ieb),this.jj.IYa=new Date,this.jj.correlationId=N.correlationId,this.jj.mP=new Date,t(N))}t1b(t){this.la.designerRequestThrottlingEnabled&&(this.Eka=bm.ready,this.hL&&t())}Wcb(t,N){this.t1b(N);L.a.J(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",t.HttpStatusCode);return!0}Dnj(t,N,ha,Aa,Ra){this.hol();if(!Object(Lj.a)(vn.a,Ra))return 8;if(1<this.nb.Ged()){let yb;(yb=this.jj).cob=yb.cob+1;return 32}return 8}dXa(t,N,ha,Aa,
Ra){if(Ra===sh.a.noSuggestion||Ra===sh.a.wid)this.la.designerBlockApplyUntilDraw?this.Xb.$mc(qi.e(this.ta.Ba,this.Qb.Ma)):this.Xb.vO(this.ta.presentation);this.FFb(Ra);return 32}Eda(t,N){if(this.jj.qRc){t=this.Xb.Zc(this.ta.presentation);const ha=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";t||Object(M.a)(String,N.actionName)!==ha||(window.clearTimeout(this.jj.fhb),this.jj.hSa||(this.jj.HYa=new Date),this.jj.$Ma=null,this.jj.qRc=!1)}}FFb(t){const N=this.jj.correlationId;
if(gb.a.Va(N))L.a.J(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",t);else{var ha={};this.jj.JY&&(ha.SuggestionSlideId=this.jj.JY.sid.toString(),ha.SuggestionSlideCreationId=this.jj.JY.cid.toString());ha.AppliedSuggestion=this.jj.DS;ha.DisplaySuggestionsTimeoutInMs=this.la.N3f;ha.SuggestionsTimeout=this.jj.hSa;ha.ClientAbort=this.jj.nub;ha.ResetReason=t;ha.DesignerSendTraceRequestOnSessionEnded=this.la.bRd;var Aa=qe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
Ra={};Ra.ClientOS=Aa.Os;Ra.Browser=Aa.Browser||"";Ra.BrowserVersion=Aa.BrowserVersion||"";Ra.BrowserMajorVersion=Aa.BrowserMajorVersion||"";Ra.BrowserMinorVersion=Aa.BrowserMinorVersion||"";this.jj.IYa&&this.jj.KHb&&this.jj.KHb>this.jj.IYa&&(Ra.SuggestionsE2ETimeMs=+this.jj.KHb-+this.jj.IYa);this.jj.IYa&&this.jj.HYa&&this.jj.HYa>this.jj.IYa&&(Ra.SuggestionAppliedE2ETimeMs=+this.jj.HYa-+this.jj.IYa);ha.BrowserData=Ra;this.jj.mP&&this.jj.HYa&&this.jj.HYa>this.jj.mP&&(ha.TimeToDisplaySuggestionsInMs=
+this.jj.HYa-+this.jj.mP);this.jj.LPe&&(ha.TimeSuggestionsRendered=this.jj.LPe.toUTCString());this.ni.mma(N,of.c(ha),t===sh.a.Xed);this.jj.VEe();L.a.J(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",t,N)}}hol(){try{const t=u.a.instance.La("Common.ISystemInitiatedFeedback");t&&t.execute(N=>{N.logActivity("AutoFixInViewportActivity",null)})}catch(t){L.a.J(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",
t)}}B9(){}z9(){}}Object(h.a)(ql,"FixItActor",null,[156]);class fk{constructor(){this.cob=0;this.correlationId=this.Tfb=null;this.fhb=0;this.nub=this.qRc=this.DS=this.hSa=!1;this.suggestion=this.mP=this.HYa=this.$Ma=this.KHb=this.IYa=this.LPe=null;this.JY=P.a.empty}VEe(){this.cob=0;this.correlationId=this.Tfb=null;this.JY=P.a.empty;this.fhb=0;this.nub=this.qRc=this.DS=this.hSa=!1;this.mP=this.HYa=this.$Ma=this.KHb=this.IYa=this.LPe=null}}Object(h.a)(fk,"FixItContext",null,[794]);var Tl=d(929),uo=d(941),
$g=d(833),vj=d(896);class co{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed){this.ia=t;this.ta=N;this.Db=ha;this.Qc=Aa;this.jj=Ra;this.Lg=yb;this.GAb=Sb;this.sI=uc;this.Mc=Zc;this.Kd=ed;this.dw()}dw(){this.GAb.NSb(Object(n.a)(this,this.WG,"onEvent"));this.Lg.WJ(Object(n.a)(this,this.WG,"onEvent"));this.Mc.SMa(Object(n.a)(this,this.WG,"onEvent"));this.Mc.uB(Object(n.a)(this,this.WG,"onEvent"));this.Qc.S3h(Object(n.a)(this,this.E0g,"onSuggestionReceived"));this.Qc.Lzc(Object(n.a)(this,this.Fla,"onUndoRedo"))}dispose(){this.Qc.DPk(Object(n.a)(this,
this.E0g,"onSuggestionReceived"));this.Qc.Dcd(Object(n.a)(this,this.Fla,"onUndoRedo"))}E0g(t,N){if(t=this.ta.Ba)if(N.slideId.equals(t.Bb))if(this.jj.correlationId!==N.correlationId)L.a.J(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.jj.correlationId,N.correlationId);else if(t=co.WQd(N.QAa),t.SlideSuggestion)this.jj.KHb||(this.jj.KHb=new Date),N=Object.assign(new Ri,{SuggestionCid:t.SlideSuggestion.SlideId.Cid,
SuggestionSid:t.SlideSuggestion.SlideId.Sid,CorrelationId:N.correlationId,ActiveSlideCid:Object(M.a)(123,this.ta.Ba).cid,ActiveSlideSid:Object(M.a)(123,this.ta.Ba).sid}),this.ia.Ka(tb.a.qnb,2,N);else switch(this.ia.Ka(tb.a.dXa,2,sh.a.noSuggestion),t.ResponseDescription){case "Invalid request":this.Kd.tqa(ee.a.Mh(122),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":this.Kd.tqa(ee.a.Mh(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,
ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.Kd.tqa(ee.a.Mh(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else L.a.J(578937808,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",N.correlationId)}HP(t){this.jj.correlationId&&t!==tb.a.qnb&&this.ia.Ka(tb.a.dXa,2,sh.a.SJb+this.sI.D4(t))}w1b(t,N,ha){if(this.jj.correlationId&&ha&&N===tb.a.qnb){this.jj.JY=
P.a.empty;ha=this.ta.presentation;const Aa=this.Db.rd(7,void 0,void 0,void 0,!0);try{Aa.jc(ha),Aa.$c=N,ha.removeProperty(Xb.a.IAa)}finally{Aa&&Aa.dispose()}this.ia.Ka(tb.a.dXa,2,sh.a.SJb+this.sI.D4(t))}}Fla(t,N){this.w1b(N.actionId,N.XRe,N.T8a)}WG(t,N){t=!1;let ha="";if(Object(Lj.a)(Tl.a,N)){L.a.J(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.jj.correlationId,Xm.a[Object(M.a)(Tl.a,N).fJ]);if(1===Object(M.a)(Tl.a,N).fJ||3===Object(M.a)(Tl.a,N).fJ)t=!0;ha=sh.a.Xed}else Object(Lj.a)(uo.a,
N)?(L.a.J(578937800,829,50,"FixItManager::OnSessionRehydrated"),t=!0,ha=sh.a.FMk):Object(Lj.a)($g.a,N)?(t=!0,ha=sh.a.slideNavigation):Object(Lj.a)(vj.a,N)&&Object(M.a)(vj.a,N).Lub&&this.HP(Object(M.a)(vj.a,N).actionId);t&&this.jj.correlationId&&this.ia.Ka(tb.a.dXa,2,ha);this.wXj()}wXj(){0<this.jj.cob&&(L.a.J(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.jj.cob),this.jj.cob=0)}static WQd(t){let N=null;try{N=qe.a(t)}catch(ha){L.a.J(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return N}}
Object(h.a)(co,"FixItManager",null,[793,106]);var Mo=d(991),Hn=d(15),$m;(function(t){t[t.seen=0]="seen";t[t.keep=1]="keep";t[t.drillIn=2]="drillIn"})($m||($m={}));Object(h.b)("IdeasCardAction",$m);var Tk;(function(t){t[t.designer=0]="designer";t[t.makeItVisual=1]="makeItVisual";t[t.editor=2]="editor";t[t.UNKNOWN=3]="UNKNOWN"})(Tk||(Tk={}));Object(h.b)("IdeasCardType",Tk);class vo{constructor(t,N){this.Psa=null;this.h$b=!1;this.ia=t;this.la=N;this.ia.xa(tb.a.ideasPaneOpened,sb.a.application,Object(n.a)(this,
this.Dlj,"handleIdeasPaneOpen"));this.ia.xa(tb.a.D4d,sb.a.application,Object(n.a)(this,this.Clj,"handleIdeasPaneClose"));this.ia.xa(tb.a.Akg,sb.a.application,Object(n.a)(this,this.ghg,"handleIdeasKeep"));this.ia.xa(tb.a.Bkg,sb.a.application,Object(n.a)(this,this.K2d,"handleIdeasSee"));this.ia.xa(tb.a.Gkg,sb.a.application,Object(n.a)(this,this.K2d,"handleIdeasSee"));this.ia.xa(tb.a.Hkg,sb.a.application,Object(n.a)(this,this.J2d,"handleIdeasDrillIn"));this.ia.xa(tb.a.Ekg,sb.a.application,Object(n.a)(this,
this.ghg,"handleIdeasKeep"));this.ia.xa(tb.a.Fkg,sb.a.application,Object(n.a)(this,this.K2d,"handleIdeasSee"));this.ia.xa(tb.a.Ckg,sb.a.application,Object(n.a)(this,this.J2d,"handleIdeasDrillIn"));this.ia.xa(tb.a.Dkg,sb.a.application,Object(n.a)(this,this.J2d,"handleIdeasDrillIn"))}Dlj(){if(!this.la.pptIdeasContextEnabled)return 2;this.h$b=!0;this.$Dj()||this.Ggl(Lc.a.create());return 32}Clj(){if(!this.la.pptIdeasContextEnabled)return 2;this.h$b=!1;return 32}ghg(t){if(!this.la.pptIdeasContextEnabled)return 2;
this.wnl(this.hRd(t));return 32}K2d(t){if(!this.la.pptIdeasContextEnabled)return 2;this.ikd(this.hRd(t));return 32}J2d(t){if(!this.la.pptIdeasContextEnabled)return 2;this.unl(this.hRd(t));return 32}hRd(t){switch(t){case tb.a.Akg:case tb.a.Bkg:case tb.a.Ckg:t=0;break;case tb.a.Gkg:case tb.a.Hkg:t=1;break;case tb.a.Ekg:case tb.a.Fkg:case tb.a.Dkg:t=2;break;default:t=3}return t}Ggl(){this.la.pptIdeasContextEnabled&&(this.Psa=new Mo.a)}ikd(t){this.la.pptIdeasContextEnabled&&this.h$b&&3!==t&&this.Psa&&
!this.Psa.any(N=>N.key===t)&&this.Psa.add(new Hn.a(t,0))}wnl(t){this.h$b&&3!==t&&this.Psa&&this.Psa.add(new Hn.a(t,1))}unl(t){this.h$b&&3!==t&&this.Psa&&this.Psa.add(new Hn.a(t,2))}$Dj(){return!!this.Psa&&0<this.Psa.length}}Object(h.a)(vo,"IdeasContext",null,[792]);class an{constructor(){this.Ny=this.My=null;this.sD=this.Ex=0}}Object(h.a)(an,"ImageLocationInfo",null,[]);var In=d(427);class wo{}Object(h.a)(wo,"ImageToTableRequest",null,[]);class rl{}rl.elg="ImageToTableTile";rl.clg="ImageToTable.Request";
rl.dlg="ImageToTable.Response";Object(h.a)(rl,"ImateToTableAugmentationSchemaNames",null,[]);class eo{constructor(){this.p_=this.MZ=null}get IF(){return"ImageToTableALWorkflow"}get proto(){return""}get Jnb(){this.MZ||(this.MZ=Object.assign(new In.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:rl.elg,outputSchema:rl.clg,func:Object(n.a)(this,this.a9a,"lambdaBeforeFunc")}));return this.MZ}get $mb(){return null}get sEb(){this.p_||(this.p_=Object.assign(new In.a,{name:"LambdaRemote_ImageToTableAL",
inputSchema:rl.clg,outputSchema:rl.dlg,func:null}));return this.p_}a9a(t,N,ha){t=Object.assign(new wo,{image:t.image});ha(t)}}Object(h.a)(eo,"ImageToTableALWorkflow",null,[824]);class Dp{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(h.a)(Dp,"ImageToTableALv2ResponseWrapper",null,[]);class ri{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.Q5b=null}}Object(h.a)(ri,"ImageToTableTile",null,[]);class Ck{constructor(t,
N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd){this.ia=t;this.nb=N;this.Xb=ha;this.Bk=Aa;this.Gz=Ra;this.Sb=Sb;this.xm=uc;this.Bde=Zc;this.Yja=ed;this.la=Gd}initialize(){this.ia.xa(tb.a.Lye,sb.a.application,Object(n.a)(this,this.Mgg,"handleConvertImageToTable"));this.ia.xa(tb.a.Rye,sb.a.application,Object(n.a)(this,this.Phg,"handleReplaceImageWithHtmlTable"));this.Bk.WJ(Object(n.a)(this,this.iC,"onActiveSlideChanged"));this.Bde.execute(t=>{const N=new eo;t.registerSimpleRemoteWorkflow(N.IF,N.Jnb,N.sEb,N.$mb);t.addEventHandler(rl.dlg,
Object(n.a)(this,this.Glj,"handleImageToTableALResults"));t.xmb("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");t.whc("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(n.a)(this,this.zQa,"handleAnnotationEvent"))})}dispose(){this.ia.eO(tb.a.Lye,sb.a.application,Object(n.a)(this,this.Mgg,"handleConvertImageToTable"));this.ia.eO(tb.a.Rye,sb.a.application,Object(n.a)(this,this.Phg,"handleReplaceImageWithHtmlTable"));this.Bk.z4(Object(n.a)(this,this.iC,"onActiveSlideChanged"))}iC(){this.Yja.close()}Mgg(t,
N,ha){if(!this.la.pptSuggestedActionImageToTableEnabled)return 16;if(1===ha)return 32;t=this.nb.ae();if(1!==t.length)return 8;const Aa=this.Yja.fqk();if(!Aa)return L.a.J(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const Ra=t[0];this.la.M5g&&(this.Yja.k1k(Aa,Ra.slideSid,Ra.get_shapeId(),Ck.TOd(Ra)),this.Yja.vXg(Aa));this.Bde.execute(yb=>{yb.pxl(Ra.slideCid,Ra.slideSid,Ra.get_shapeId(),Sb=>{this.hhg(Aa,Ra,Sb)},()=>{this.hhg(Aa,Ra,null);return!0})});
return 32}zQa(t){if(t&&"errorDescription"in t&&"parentPath"in t&&"errorCode"in t){var N=new Dp,ha=t.errorDescription.split(";");N.errorDescription=ha[0].split(":")[1];N.processId=ha[1].split(":")[1];N.errorCode=t.errorCode;L.a.J(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",N.processId,N.errorCode,N.errorDescription);ha=t.parentPath[1].split("|");N.slideId=Number.parseInvariant(ha[0]);N.shapeId=Number.parseInvariant(ha[2]);N.html=t.html;
this.Yja.i1k(N);this.Yja.uXg()}}hhg(t,N,ha){if(ha&&ha.ImgData)if(this.la.M5g)this.Yja.j1k(t,ha.ImgData),this.Yja.uXg();else{const Aa=Ck.TOd(N),Ra=Object.assign(new ri,{sessionId:t,slideSid:N.slideSid,shapeId:N.get_shapeId(),Q5b:Aa,image:ha.ImgData});this.Bde.execute(yb=>{yb.submit(rl.elg,Ra)});this.Yja.vXg(t)}else this.Yja.Mkk(t)}Glj(t,N,ha,Aa){L.a.J(512496419,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",Aa.processId,Aa.errorCode,Aa.errorDescription);
this.Yja.Iik(N,Aa)}Phg(t,N,ha,Aa,Ra){t=this.Sb.aCa(Ra.slideSid);if(!t)return 8;ha=(N=t.oS(Ra.shapeId))?Ck.TOd(N):Ra.Q5b;if(!ha)return 8;L.a.J(512496418,829,50,"Replacing image with html table. Shape id: {0}",N.get_shapeId());Ra=this.xm.cPd(!1,t.cid,t.sid,!1,ha.My,ha.Ny,ha.Ex,ha.sD,t.Qu()+1,Ra.Tuh,"");this.Gz.Z1([Ra],t,0,null,N);this.Xb.zw(t,"ImageToTable");return 32}static TOd(t){return Object.assign(new an,{My:t.My,Ny:t.Ny,Ex:t.Ex,sD:t.sD})}}Object(h.a)(Ck,"ImageToTableActor",null,[]);class bn{constructor(t){this.shapeId=
this.slideId=0;this.O4d=null;this.uUe=0;this.N3d=!1;this.Tdc=null;this.RSc=!1;this.OPc=this.R4d=this.hWg=this.E1g=null;this.sessionId=t}}Object(h.a)(bn,"ImageToTableConversionContext",null,[]);class pc{constructor(){this.shapeId=this.slideSid=0;this.Tuh=this.Q5b=null}}Object(h.a)(pc,"ReplaceImageWithHtmlTableData",null,[]);class Uj{constructor(t,N,ha,Aa){this.ia=t;this.Xd=N;this.Ga=ha;this.rme=Aa;this.w8=null}initialize(){this.Xd.execute(t=>{t.rGd(Object(n.a)(this,this.uYg,"onFirstPartyAddInHidden"))});
this.rme.jGd(Object(n.a)(this,this.phg,"handleMessage"))}dispose(){this.Xd.execute(t=>{t.CPk(Object(n.a)(this,this.uYg,"onFirstPartyAddInHidden"))});this.rme.Jch(Object(n.a)(this,this.phg,"handleMessage"))}fqk(){this.close();const t=new bn(Lc.a.create().toString());t.E1g=new Promise(ha=>{t.hWg=()=>{ha(t.sessionId)}});const N={};N.fU=ResourceStrings.L_DataFromPicturePaneTitle;N.assetId="FA000000050";N.cva=()=>{this.Jve(t)};N.nonPersistedSettings={["SessionID"]:t.sessionId};N.Anc=!0;N.sourceLocationOverrideResourceId=
this.Ga.pptImageToTableSourceLocationId;return 32===this.ia.Ka(tb.a.sIa,2,N)?(this.w8=t,this.w8.sessionId):this.w8=null}close(){this.AMd(this.w8)}Jve(t){L.a.J(593867348,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",t.sessionId);const N=this.Xd.instance.fZ("FA000000050");if(N&&N.settings&&"SessionID"in N.settings){var ha;({Hv:ha}=qe.d(N.settings.SessionID)).returnValue&&(t.sessionId===ha?(t.Tdc=N.instanceId,L.a.J(593867346,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",
N.instanceId)):L.a.J(593867344,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}AMd(t){t&&t.Tdc&&(t.RSc=!0,this.ia.Ka(tb.a.iDc,2,t.Tdc))}k1k(t,N,ha,Aa){if(t=this.Mrb(t))t.slideId=N,t.shapeId=ha,t.O4d=Aa}i1k(t){const N=this.w8;N&&N.slideId===t.slideId&&N.shapeId===t.shapeId&&(this.w8.OPc=t)}j1k(t,N){if(t=this.Mrb(t))t.R4d=N}vXg(t){const N=this.Mrb(t);N&&(N.uUe=window.setTimeout(()=>{this.qkj(N)},this.Ga.pptImageToTableALWorkflowTimeoutMs))}Iik(t,N){if(t&&N){var ha=this.Mrb(t.sessionId);if(ha&&
!ha.N3d)if(ha.slideId=t.slideSid,ha.shapeId=t.shapeId,ha.O4d=t.Q5b,window.clearTimeout(ha.uUe),0===N.errorCode){const Aa={};Aa.tableHtml=N.html;Aa.imageData=t.image;this.sendMessage(ha.sessionId,Aa)}else this.Ned(t.sessionId,"Failed to convert image to table")}}uXg(){const t=this.w8;if(t&&!t.N3d&&t.OPc&&t.R4d)if(window.clearTimeout(t.uUe),0===t.OPc.errorCode){const N={};N.tableHtml=t.OPc.html;N.imageData=t.R4d;this.sendMessage(t.sessionId,N)}else this.Ned(t.sessionId,"Failed to convert image to table")}Mkk(t){this.Ned(t,
"Failed to render the image shape")}qkj(t){t.N3d=!0;this.Ned(t.sessionId,"Failed to convert image to table using AL")}phg(t,N){N=N.message;(t=this.Mrb(N.session_id))&&!t.RSc&&("ACK"===N.cmd_type?(L.a.J(593867342,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",N.cmd_type),t.hWg()):"cancel"===N.cmd_type?(L.a.J(593867340,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",N.cmd_type),this.AMd(t)):"insert_html"===N.cmd_type?(L.a.J(593867338,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",
N.cmd_type),N=Object.assign(new pc,{slideSid:t.slideId,shapeId:t.shapeId,Q5b:t.O4d,Tuh:N.parameters}),this.AMd(t),this.ia.Ka(tb.a.Rye,2,N)):L.a.J(593867336,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",N.cmd_type))}Ned(t,N){this.sendMessage(t,{["errorMessage"]:N})}sendMessage(t,N){const ha=this.Mrb(t);ha&&ha.sessionId===t&&ha.E1g.then(()=>{this.rme.sendMessage(ha.Tdc,N)})}Mrb(t){return t&&this.w8&&this.w8.sessionId===t?this.w8:null}uYg(t,N){N&&this.w8&&
N.instanceId===this.w8.Tdc&&(this.w8=null)}}Object(h.a)(Uj,"ImageToTablePane",null,[796]);class No extends Sys.EventArgs{constructor(t){super();this.message=t}}Object(h.a)(No,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class Dk{constructor(t){this.va=new qm.a;this.Ga=t}jGd(t){this.va.addHandler("ImageToDocPaneMessageReceived",t)}Jch(t){this.va.removeHandler("ImageToDocPaneMessageReceived",t)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(n.a)(this,this.Tbc,
"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(n.a)(this,this.Tbc,"messageReceivedHandler")):L.a.J(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(t){L.a.J(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",t.message,t.stack)}}sendMessage(t,N){const ha={["imageToTablePaneWildcard"]:"."};
for(const Aa of Object.keys(N))ha[Aa]=N[Aa];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(t,"onCustomMessage",ha,Aa=>{Aa&&L.a.J(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",Aa)})}Tbc(t){if(t&&this.d4b(t.origin)){var N;({Hv:N}=qe.d(t.data)).returnValue&&N&&(t=Object(M.a)(Object,N),"."===t.imageToTablePaneWildcard&&this.va.raiseEvent("ImageToDocPaneMessageReceived",new No(t)))}}d4b(t){return t&&t.length&&"null"!==t?t===this.Ga.pptImageToTableAllowedOrigin:
!1}}Object(h.a)(Dk,"ImageToTablePaneMessenger",null,[795]);var tm=d(1051);class Je{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(h.a)(Je,"ImageTransformInfo",null,[]);class Ti{constructor(t,N,ha,Aa){this.ia=t;this.nb=N;this.ta=ha;this.Qc=Aa}initialize(){this.Qc.y2h(Object(n.a)(this,this.D0g,"onSuggestedActionClick"))}dispose(){this.Qc.LOk(Object(n.a)(this,this.D0g,"onSuggestedActionClick"))}D0g(t,N){if((t=N.card)&&this.ta.Ba){var ha=this.ta.Ba.om(),Aa=[];N=
[];for(var Ra of ha)for(const yb of t.Selects)if(yb.Id===Ra.get_shapeId()){Array.add(Aa,Ra);Array.add(N,Ra.get_shapeId());break}this.nb.ly();this.nb.Ph();this.nb.DXa(Aa,!0);if(4===t.Type){if(Ra=this.ta.presentation)Ra.ytb=Object.assign(new Je,{Scenario:t.Scenario,SlideSid:this.ta.Ba.sid,SlideCid:this.ta.Ba.cid,ShapeIds:N})}else this.ia.processAction(tm.a.WBc(t.ExecutionActionName),2)}}}Object(h.a)(Ti,"SuggestedActionsHandler",null,[]);class Im{constructor(){this.K=null;this.AW=!1;this.tE=!!v.AFrameworkApplication.Aa&&
!!v.AFrameworkApplication.Aa.gb&&v.AFrameworkApplication.Aa.gb.UV}get name(){return"PowerPointWebEditor.Designer"}Wb(t){this.K=t;this.K.register(786,"PowerPointWebEditor.IDesignerView").ma().na(()=>new ye(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Box4.IViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IPointerInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(787,"PowerPointWebEditor.IDesignerPane").ma().na(()=>new Sl(this.K.resolve("Box4.IAppFrame"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(788,"PowerPointWebEditor.IDesignerViewHelper").ma().na(()=>new ae(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.La("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.K.register(789,"PowerPointWebEditor.IDesignerManager").ma().na(()=>new bo(this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.La("PowerPointWebEditor.IDesignerServiceProvider"),this.K.La("PowerPointWebEditor.IApplyDesignerSuggestions"),this.K.La("Common.ISystemInitiatedFeedback")));this.K.register(790,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").ma().na(()=>new Sk(this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")));
this.K.register(791,"PowerPointWebEditor.IDesignerContext").ma().na(()=>new xn(this.K.La("PowerPointWebEditor.IDesignerServiceProvider")));this.K.register(792,"PowerPointWebEditor.Infrared.IIdeasContext").ma().na(()=>new vo(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(793,"PowerPointWebEditor.IFixItManager").ma().na(()=>new co(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler")));this.K.register(794,
"PowerPointWebEditor.IFixItContext").ma().na(()=>new fk);(this.AW=this.K.resolve("PowerPointWebEditor.IApplicationContext").kd.vg)&&this.K.register(Ql.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new Ql.a(v.AFrameworkApplication.He,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("Common.IAppSettingsManager")));this.K.register(Ck,"PowerPointWebEditor.Designer.ImageToTableActor").ma().na(()=>new Ck(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeEditor"),this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(795,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").ma().na(()=>new Dk(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(796,"PowerPointWebEditor.Designer.IImageToTablePane").ma().na(()=>
new Uj(this.K.resolve("Common.IActionManagerExtended"),this.K.La("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.K.register(Ti,"PowerPointWebEditor.Designer.SuggestedActionsHandler").ma().na(()=>new Ti(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const t=this.K.resolve("Common.IAppSettingsManager");t.ff(()=>{if(t.ka("248")){this.AW&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");var N=this.K.resolve("PowerPointWebEditor.IDesignerView");const ha=u.a.instance.resolve("PowerPointWebEditor.IDesignerPane").ya;N.Pza(ha);N.hQc();this.tE||this.K.resolve("PowerPointWebEditor.IPaneManager").uM(this.K.resolve("PowerPointWebEditor.IDesignerPane"));N=null;if(t.ka("1034")&&(N=this.K.resolve("Common.App.OAuth.IOAuthManager"))){const Aa=
new Date;N.q0(t.Ha("1043"),t.Ha("1035")).then(Ra=>{const yb=+new Date-+Aa;Ra.IsSuccess?L.a.J(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+yb):(L.a.J(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Ra.ErrorCode+": "+Ra.ErrorMessage),L.a.J(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+yb))}).catch(Ra=>{L.a.J(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
(+new Date-+Aa));L.a.J(512262859,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Ra)})}N=new Gj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IClipboardDataHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),
this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerManager"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.K.La("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),N,this.K.La("PowerPointWebEditor.IAgendaMetrics"),this.K.La("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"));N.ub();N.we();(new ql(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"))).ub();this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.K.resolve("PowerPointWebEditor.IFixItManager")}else L.a.J(512262858,829,50,"Designer setting is disabled")})}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.K.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){e.a.instance.Ac(mc.a(new Im,0))}}Object(h.a)(Im,"PPTWebEditorDesignerPackage",null,[2,3]);class xo{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.PenMinutes"}Wb(t){this.K=t}init(){const t=this.K.pb("Common.App.PenMinutesManager.IPenMinutesManager");t&&t.S3k()}dispose(){}static main(){e.a.instance.Ac(new xo)}}Object(h.a)(xo,"PPTWebEditorPenMinutesPackage",null,[2,3]);var fo=d(898);class yn{}Object(h.a)(yn,"TextToSmartArtSuggestionData",null,[]);class um{constructor(){this.suggestions=[]}}Object(h.a)(um,"TextToSmartArtSuggestionNotificationData",null,[]);class Hf{}Hf.TJe="ShapePresence";Hf.slideNavigation=
"SlideNavigation";Hf.SJb="WebActionId:";Hf.OT="SelectionChanged";Hf.Yjc="ShapePositionChanged";Hf.Ieb="Retrigger";Hf.dte="NoSuggestions";Hf.wYj="LowSuggestions";Hf.K5c="NewSession";Hf.qel="SlideShowStarted";Hf.serverError="ServerError";Hf.PNf="ClientSuggestionTimeOut";Object(h.a)(Hf,"ReplaceObjectResetReason",null,[]);class go{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff,ah,aj,Df,Fi,We){this.eUa=this.xje=this.z$a=!1;this.ra=t;this.Fa=N;this.ta=ha;this.Xb=Aa;this.s8=Ra;this.Lg=yb;this.ia=Sb;
this.Iy=uc;this.xFa=Zc;this.Jy=ed;this.GAb=ze;this.vka=re;this.P1c=ff;this.Qc=ah;this.sI=aj;this.yb=Df;this.Nb=Fi;this.Kt=Gd;this.MTa=We;this.Yq=!1}get vh(){return this.Yq}setup(){this.vh||(this.dw(),this.xje=2===this.Nb.mode,this.Yq=!0)}dw(){this.ra.XJ(Object(n.a)(this,this.YG,"onSelectionChanged"));this.GAb.NSb(Object(n.a)(this,this.ure,"markedUndo"));this.Lg.WJ(Object(n.a)(this,this.iC,"onActiveSlideChanged"));this.vka.P2a(Object(n.a)(this,this.G_,"onSlidePresenceChanged"));this.Qc.n4h(Object(n.a)(this,
this.Yve,"onReplaceObjectResponse"));this.xFa.o4h(Object(n.a)(this,this.Zve,"onReplaceObjectViewDragEnd"));this.s8.OSb(Object(n.a)(this,this.Wte,"onApplyReplaceObjectBlockingStateChanged"));this.Lg.oGd(Object(n.a)(this,this.hnc,"updateEditState"));this.Nb.vM(Object(n.a)(this,this.$v,"onAppFrameModeSwitched"));this.Qc.qCf(Object(n.a)(this,this.EWg,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Qc.pCf(Object(n.a)(this,this.DWg,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Qc.Lzc(Object(n.a)(this,
this.Fla,"onUndoRedo"))}dispose(){this.vh&&(this.ra.zHa(Object(n.a)(this,this.YG,"onSelectionChanged")),this.GAb.IDe(Object(n.a)(this,this.ure,"markedUndo")),this.Lg.z4(Object(n.a)(this,this.iC,"onActiveSlideChanged")),this.vka.YDe(Object(n.a)(this,this.G_,"onSlidePresenceChanged")),this.Qc.SPk(Object(n.a)(this,this.Yve,"onReplaceObjectResponse")),this.xFa.TPk(Object(n.a)(this,this.Zve,"onReplaceObjectViewDragEnd")),this.s8.ycd(Object(n.a)(this,this.Wte,"onApplyReplaceObjectBlockingStateChanged")),
this.Nb.rX(Object(n.a)(this,this.$v,"onAppFrameModeSwitched")),this.Lg.LDe(Object(n.a)(this,this.hnc,"updateEditState")),this.Qc.Mch(Object(n.a)(this,this.EWg,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Qc.Lch(Object(n.a)(this,this.DWg,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Qc.Dcd(Object(n.a)(this,this.Fla,"onUndoRedo")),this.Yq=!1)}jYa(t){return this.p8d()?this.P1c.Knc(t):!1}selectShape(t){t&&this.ra.selectShape(t,!1)}mSc(t){switch(t){case tb.a.ZMa:case tb.a.yse:case tb.a.ccc:case tb.a.dcc:case tb.a.ecc:case tb.a.fcc:case tb.a.lGa:return!0;
default:return!1}}p8d(){return this.z$a&&this.xje}i3g(t,N){const ha=[];if(gb.a.Va(t))return ha;t=t.split(";");if(t.length<N)return L.a.J(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",N,t.length),ha;for(let Aa=0;Aa<N;++Aa){const Ra=t[Aa].split(":");if(3!==Ra.length)throw N=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",Aa,t[Aa]),L.a.J(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",N),Error.create(N);
const yb=fo.a.rfj(Number.parseInvariant(Ra[1]));Array.add(ha,Object.assign(new yn,{index:Ra[0],labelText:gb.a.Va(yb)?ResourceStrings.L_SmartArt:yb,imageData:this.TLc(Ra[2])}))}return ha}EWg(){this.eUa=!0}DWg(){this.eUa=!1}Fla(t,N){this.HP(N.actionId)}TLc(t){return gb.a.Va(t)?null:"data:image/png;base64,"+t}$v(t){L.a.J(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",t.mode);this.xje=2===t.mode}hnc(){this.z$a||L.a.J(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");
this.z$a=!0}NBb(t,N,ha,Aa){this.MTa.execute(Ra=>{const yb=Object.assign(new um,{correlationId:t,shapeId:N,suggestions:ha});Ra.notifyTextToSmartArtSuggestion(Aa,yb)})}Qhg(t,N,ha){if(N.oD)if(N.U7&&0!==t.BHa)L.a.J(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",t.BHa);else{if(0===t.BHa){if(0>=t.ica){L.a.J(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",t.correlationId);this.closeSession(N,Hf.dte);
return}if(t.ica<ha.replaceObjectMinRequiredSuggestions){L.a.J(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",t.correlationId);this.closeSession(N,Hf.wYj);return}N.U7=!1;N.suggestions=this.i3g(t.QAa,t.ica);N.cU=t.ica;L.a.J(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",N.cU,t.correlationId)}else if(1===t.BHa){if(gb.a.Va(t.QAa)){L.a.J(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",
t.correlationId);return}N.suggestions=this.i3g(t.QAa,t.ica);N.rIb=new Date;ha.powerPointIdeasIsEnabled&&this.NBb(t.correlationId,N.shapeId,N.suggestions,Mj.a.success)}else 2===t.BHa&&(N.Cae=!1,N.shapeId=t.shapeId,this.NBb(N.correlationId,t.shapeId,N.suggestions,Mj.a.success));ha=N.shape;N.slide&&N.slide.isConnected&&ha&&ha.isConnected&&this.Kt.I8a(ha)&&this.p8d()&&(1===t.BHa?this.Jy.Uah(N.correlationId):this.Jy.rhd(ha))}else L.a.J(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",
t.correlationId)}}Object(h.a)(go,"BaseReplaceObjectManager",null,[785,814]);class ue{}ue.none="";ue.Yjc="ShapePositionChanged";Object(h.a)(ue,"ReplaceObjectRetriggerReason",null,[]);class sl{}sl.selectShape="SelectShape";sl.Ieb="Retrigger";sl.tai="AugLoopRetrigger";sl.sai="AugLoopDefault";Object(h.a)(sl,"ReplaceObjectTrigger",null,[]);var jp=d(501);class ho extends go{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff,ah,aj,Df,Fi,We,wi,Mn,Bn,dn){super(uc,ha,Aa,Ra,yb,Sb,Zc,ed,Gd,ze,re,ah,aj,Df,Fi,
wi,Mn,Bn,dn);this.LS=t;this.MCg=N;this.h7j=ff;this.la=We;this.sNg=this.la.replaceObjectGrayFloatieInTyping}dw(){this.la.replaceObjectUseClientAL?this.MCg.execute(t=>{t.addEventHandler("ShapeTextConvertable",Object(n.a)(this,this.q7g,"processShapeTextConvertibleClientAL"))}):this.LS.execute(t=>{t.addEventHandler("ShapeTextConvertable",Object(n.a)(this,this.cAe,"processShapeTextConvertible"))});this.Qc.F5h(Object(n.a)(this,this.q8c,"onSlideShowStarted"));super.dw()}dispose(){this.vh&&(this.la.replaceObjectUseClientAL?
this.MCg.execute(t=>{t.removeEventHandler("ShapeTextConvertable",Object(n.a)(this,this.q7g,"processShapeTextConvertibleClientAL"))}):this.LS.execute(t=>{t.removeEventHandler("ShapeTextConvertable",Object(n.a)(this,this.cAe,"processShapeTextConvertible"))}),this.Qc.IQk(Object(n.a)(this,this.q8c,"onSlideShowStarted")));super.dispose()}cAe(t,N){if(t&&N){try{var ha=qe.a(t);var Aa=qe.a(N)}catch(yb){L.a.J(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");
return}if(ha&&!isNaN(ha.sid)&&!isNaN(ha.cid)&&!isNaN(ha.shapeId)&&this.ta.Ba&&(t=new Date(ha.c),L.a.J(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",ha.sid,ha.cid,ha.shapeId,ha.t,ha.c?(new Date).getTime()-ha.c:-1),(N=this.ta.Ba.oS(ha.shapeId))&&($e.a.contains(this.Vcg(),N.get_shapeId())||"activeSlideChanged"===ha.t)))if(Aa&&!Aa.isTextConvertible)this.Jy.gma(N,!0);else{var Ra=this.Iy.a0b(N.get_shapeId());if(Ra&&Ra.nba&&(Ra=new jp.a(N,Ra.Rea),this.ia.Ka(tb.a.Pdb,
2,Ra),!Ra.asa))return;this.jYa(N)&&this.Vha(this.ta.Ba,N,Aa&&Aa.smartArtInfo?Aa.smartArtInfo.length:0,ha.t||sl.sai,ue.none,t)}}}q7g(t,N,ha,Aa){N&&Aa&&Aa.ContextId&&Aa.Payload&&this.cAe(Aa.ContextId,Aa.Payload)}q8c(){this.wMd(Hf.qel)}YG(t,N){if(!this.vh)L.a.J(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.eUa&&(N.OD.length||!this.Fa.ye||this.Fa.ye.name!==hd.a.yg)){t=this.Vcg();for(let ha of this.Iy)ha.oD&&!Array.contains(t,ha.shapeId)&&
this.closeSession(ha,Hf.OT);this.sNg&&!Array.contains(t,this.Jy.Tsb)&&this.Jy.ENk()}}Zve(t,N){this.vh?(t=this.Iy.a0b(N.shape.get_shapeId()))&&t.oD&&(N=t.shape,this.closeSession(t,Hf.Yjc),this.jYa(N)&&this.Vha(this.ta.Ba,N,0,sl.tai,ue.Yjc)):L.a.J(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}ure(t,N){N.Lub&&this.HP(N.actionId)}iC(){this.wMd(Hf.slideNavigation)}G_(t,N){if(N.B7&&N.shapes)for(const ha of N.shapes)(t=this.Iy.a0b(ha))&&t.oD&&this.closeSession(t,
Hf.TJe)}Yve(t,N){(t=this.Iy.B6a(N.correlationId))?this.Qhg(N,t,this.la):L.a.J(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",N.correlationId)}Wte(){if(this.vh)for(let t of this.Iy)t.U7a&&0===t.l0&&!this.Xb.Zc(this.ta.presentation)&&(t.U7a=!1,this.Jy.gma(t.shape,!0))}jYa(t){const N=this.Iy.Wzf;return 1<=N?(L.a.J(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",
N),!1):super.jYa(t)}Vha(t,N,ha,Aa,Ra,yb=null){try{let Sb=this.Iy.a0b(N.get_shapeId());Sb&&this.closeSession(Sb,Hf.K5c);Sb=this.Iy.aFc(t,N.get_shapeId(),Aa,Ra,this.la);Sb.lmc=yb;Sb.nba="richEditTextUnicodeChanged"===Aa;this.Jy.gnc(Sb.correlationId);const uc=this.h7j.pjh(Sb);L.a.J(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Sb.correlationId,Sb.slide.sid,Sb.slide.cid,Sb.shapeId,uc);L.a.J(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
Sb.correlationId,ha,Math.min(ha,this.la.replaceObjectSuggestionMaxCount),Aa);ha&&this.la.replaceObjectShowFloatieOnShapeTextConvertibleResponse&&(ha=Math.min(ha,this.la.replaceObjectSuggestionMaxCount),Sb.suggestions=this.gWi(ha),Sb.cU=ha,Sb.U7=!1,this.Jy.rhd(N));0===uc&&this.la.powerPointIdeasIsEnabled&&this.NBb(Sb.correlationId,Sb.shapeId,[],Mj.a.pending)}catch(Sb){L.a.J(34152522,829,10,"GenerateSuggestion failed!! {0} ",Sb.message)}}gWi(t){const N=Array(t);for(let ha=0;ha<t;ha++)Array.add(N,Object.assign(new yn,
{index:ha.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return N}HP(t){this.vh?this.mSc(t)||this.wMd(Hf.SJb+this.sI.D4(t)):L.a.J(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}n9k(t){if(!this.sNg)return!1;const N=this.ra.ae();return t.nba&&Array.contains(N,t.shape)}closeSession(t,N){0===t.l0&&(N===Hf.dte?this.Jy.gma(t.shape,!0):t.nba&&this.Jy.gma(t.shape,!0,N!==Hf.K5c,this.n9k(t)),this.Iy.NQc(t,N),this.la.powerPointIdeasIsEnabled&&this.NBb(t.correlationId,
t.shapeId,t.suggestions,Mj.a.rGa))}wMd(t){for(let N of this.Iy)this.closeSession(N,t)}Vcg(){const t=this.ra.ae(),N=[];t&&t.forEach(ha=>{Array.add(N,ha.get_shapeId())});return N}}Object(h.a)(ho,"AugmentationLoopReplaceObjectManager",go,[]);class Jm{constructor(t,N){this.disabled=!1;this.WJg=Kg.App.Im;this.la=t;this.yb=N}vkh(t){this.disabled=!0;this.WJg=new Date;const N=new Y.a(2,1,this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds,()=>{this.disabled&&+new Date-+this.WJg>=this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds&&
t()});this.yb.Gb(N)}p2k(t){const N=new Y.a(2,1,550,()=>{t()});this.yb.Gb(N)}static wxl(t,N){return 7<=t&&8>=t&&1!==N}}Object(h.a)(Jm,"FlyoutAnchorTimer",null,[]);var tl=d(360);class yo{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff,ah){this.Wr=null;this.eUa=!1;this.Qc=N;this.ra=t;this.Iy=ha;this.ta=Aa;this.Ea=Ra;this.la=yb;this.Jy=Sb;this.ni=uc;this.Kt=Zc;this.vka=ed;this.s8=Gd;this.ETa=ze;this.ibc=re;this.sI=ff;this.hc=ah}dw(){this.Qc.W3h(Object(n.a)(this,this.LYg,"onIconSuggestionNotification"));
this.ra.XJ(Object(n.a)(this,this.YG,"onSelectionChanged"));this.Qc.qCf(Object(n.a)(this,this.CWg,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Qc.pCf(Object(n.a)(this,this.BWg,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Qc.V3h(Object(n.a)(this,this.KYg,"onIconChanged"));this.vka.P2a(Object(n.a)(this,this.G_,"onSlidePresenceChanged"));this.s8.OSb(Object(n.a)(this,this.Eda,"onBlockingStateChanged"));this.ibc.NSb(Object(n.a)(this,this.Mcb,"onMarkedUndo"))}TRe(){this.Qc.FPk(Object(n.a)(this,
this.LYg,"onIconSuggestionNotification"));this.ra.zHa(Object(n.a)(this,this.YG,"onSelectionChanged"));this.Qc.Mch(Object(n.a)(this,this.CWg,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Qc.Lch(Object(n.a)(this,this.BWg,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Qc.EPk(Object(n.a)(this,this.KYg,"onIconChanged"));this.vka.YDe(Object(n.a)(this,this.G_,"onSlidePresenceChanged"));this.s8.ycd(Object(n.a)(this,this.Eda,"onBlockingStateChanged"));this.ibc.IDe(Object(n.a)(this,
this.Mcb,"onMarkedUndo"))}dispose(){this.TRe()}setup(){this.dw()}CWg(){this.eUa=!0}BWg(){this.eUa=!1}KYg(t,N){N&&this.Wr&&this.Wr.Vic&&this.Wr.slide.sid===N.slideId.sid&&this.Wr.slide.cid===N.slideId.cid&&this.Wr.shapeId===N.shapeId&&this.Wr.S4===N.LX&&(this.Wr.DGe=N.rCa)}G_(t,N){if(N.B7&&N.shapes&&this.Wr)for(const ha of N.shapes)this.Wr.shapeId===ha&&this.gV(Hf.TJe)}Mcb(t,N){N.Lub&&!this.mSc(N.actionId)&&this.gV(Hf.SJb+this.sI.D4(N.actionId))}mSc(t){switch(t){case tb.a.ZMa:case tb.a.yse:case tb.a.ccc:case tb.a.dcc:case tb.a.ecc:case tb.a.fcc:case tb.a.lGa:return!0;
default:return!1}}Eda(){if(this.Wr){const t=this.Wr.shape,N=this.Ea.er(t);t&&N&&!this.ETa.Zc(N)&&(this.Wr.U7a=!1,this.Jy.gma(t,!0),this.Wr.jmc=new Date,this.Wr.gV(Hf.OT))}}YG(){if(!this.eUa){var t=this.Ea.h6a(this.ra.ae());if(t){if(this.Wr&&this.Wr.oD){if(tl.a.Xjc(t.HX,this.Wr.HX))return;this.gV(Hf.OT)}this.jYa(t)&&this.Vha(this.ta.Ba,t,sl.selectShape)}else this.Wr&&this.Wr.oD&&this.gV(Hf.OT)}}Vha(t,N,ha){this.Wr=this.Iy.ZNa(t,N.get_shapeId(),ha,"",this.la,N.get_smartArtModelId());this.Wr.U7=!0;this.Jy.gnc(this.Wr.correlationId);
L.a.J(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.Wr.correlationId,this.Wr.slide.sid,this.Wr.slide.cid,this.Wr.shapeId,this.Wr.S4);const Aa=N.get_smartArtModelId()?this.Ea.er(N):N;Aa?this.ni.dWi(t.cid,t.sid,Aa.get_shapeId(),this.Kt.iNc(Aa),this.Kt.hNc(Aa),N.get_smartArtModelId(),this.Wr.correlationId,ha,Object(n.a)(this,this.Jkk,"onIconSuggestionResponseSuccess"),Object(n.a)(this,this.Wcb,"onTaskFailure")):
L.a.J(38279305,829,15,"Parent ShapeNode of a {0} is null",N.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}Jkk(t){if(t&&t.SuggestionResult){var N=t.CorrelationId,ha=this.Iy.B6a(N);if(ha)if(ha.oD){N=null;try{N=Sys.Serialization.JavaScriptSerializer.deserialize(t.SuggestionResult)}catch(Aa){L.a.J(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",Aa)}if(N){ha.suggestions=this.ktk(N);ha.rIb=new Date;if(ha.U7){if(this.Crg(ha)){L.a.J(39184097,829,
15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",ha.hVb,this.la.pptIconChunkingSuggestionTimeoutMs);this.gV(Hf.PNf);return}L.a.J(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");ha.cU=ha.suggestions?ha.suggestions.length:0;ha.U7=!1;this.Jy.rhd(ha.shape)}this.Jy.Uah(ha.correlationId)}else this.gV(Hf.serverError),L.a.J(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else L.a.J(38279315,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Wr?this.Wr.correlationId:"",N);else L.a.J(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",N)}else this.gV(Hf.serverError),L.a.J(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}Wcb(t){this.gV(Hf.serverError);
L.a.J(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",t.HttpStatusCode);return!0}jYa(t){return this.hc.ln?t.get_smartArtModelId()&&t.get_isSVGBlipFilled()?(t=this.Ea.er(t),!!t&&!t.Lv):!1:!1}gV(t){this.Wr&&(this.Jy.gma(this.Wr.shape,!0),this.Iy.NQc(this.Wr,t),this.Wr=null)}TLc(t){return gb.a.Va(t)?null:t.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(t):"data:image/png;base64,"+t}ktk(t){const N=[];if(!t||
!t.length)return N;for(let ha=0;ha<t.length;++ha){const Aa=Object.assign(new yn,{index:t[ha].Index.toString(),labelText:t[ha].Label,imageData:this.TLc(t[ha].Render),renderData:this.TLc(t[ha].Replace)});Array.add(N,Aa)}return N}Dxi(t,N){const ha=[];if(gb.a.Va(t)||!N)return ha;for(var Aa=0;Aa<N;++Aa){var Ra=Object.assign(new yn,{index:Aa.toString(),labelText:"",imageData:null,renderData:null});Array.add(ha,Ra)}t=t.split(";");if(t.length-1!==N)return L.a.J(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
ha.length,N),ha;for(Aa=0;Aa<N;++Aa)Ra=t[Aa].indexOf(":"),0>Ra?L.a.J(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):ha[Aa].labelText=t[Aa].substr(Ra+1);return ha}jtk(t){let N,ha,Aa,Ra;N="";Aa=ha=0;Ra=null;if(gb.a.Va(t))return L.a.J(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:N,ica:ha,nte:Aa,suggestions:Ra};const yb=t.split("|");if(4!==yb.length)return L.a.J(38279325,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+t.length),{returnValue:!1,correlationId:N,ica:ha,nte:Aa,suggestions:Ra};N=yb[0];ha=parseInt(yb[1]);Aa=Number.parseInvariant(yb[2]);Ra=this.Dxi(yb[3],ha);return{returnValue:!0,correlationId:N,ica:ha,nte:Aa,suggestions:Ra}}LYg(t,N){let ha,Aa;if(({correlationId:t,ica:N,nte:ha,suggestions:Aa}=this.jtk(N.QAa)).returnValue){var Ra=this.Iy.B6a(t);if(Ra)if(Ra.oD&&Ra.U7){var yb=Ra.shape;0===ha&&(0>=
N?(L.a.J(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",t),this.gV(Hf.dte)):this.Crg(Ra)?(L.a.J(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Ra.hVb,this.la.pptIconChunkingSuggestionTimeoutMs),this.gV(Hf.PNf)):(Ra.U7=!1,Ra.cU=N,Ra.suggestions=Aa,L.a.J(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Ra.correlationId,Ra.cU),this.Jy.rhd(yb)))}else L.a.J(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Wr?this.Wr.correlationId:"",t,Ra.oD,Ra.U7);else L.a.J(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",t)}else L.a.J(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}Crg(t){const N=
new Date,ha=t.Rea,Aa=this.la.pptIconChunkingSuggestionTimeoutMs;return N&&ha&&0<Aa&&+N-+ha>Aa?(t.hVb=+N-+ha,!0):!1}}Object(h.a)(yo,"ReplaceIconManager",null,[]);var z=d(683),U=d(967);class la extends Sys.EventArgs{constructor(t){super();this.HX=t}}Object(h.a)(la,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class Da{constructor(){this.shape=null;this.action=0}}Object(h.a)(Da,"ShowHideReplaceObjectGalleryData",null,[]);class Ia{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re){this.Yq=
this.z$a=!1;this.ia=N;this.Fa=ha;this.ta=Ra;this.Lg=Aa;this.Xb=yb;this.yFa=Sb;this.Jy=Gd;this.Qb=ze;this.Ea=re;this.ra=t;this.Qc=uc;this.Iy=Zc;this.Db=ed}get vh(){return this.Yq}setup(){this.vh||(this.dw(),this.ub(),this.we(),this.Yq=!0)}dispose(){this.vh&&(this.TRe(),this.Yq=!1)}dw(){this.Lg.oGd(Object(n.a)(this,this.hnc,"updateEditState"))}TRe(){this.Lg.LDe(Object(n.a)(this,this.hnc,"updateEditState"))}ub(){this.ia.pa(tb.a.ZMa,sb.a.application,Object(n.a)(this,this.ZMa,"applyReplaceObjectSuggestion"),
4);this.ia.pa(tb.a.mYa,sb.a.application,Object(n.a)(this,this.mYa,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.pa(tb.a.bHb,sb.a.application,Object(n.a)(this,this.mYa,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.pa(tb.a.occ,sb.a.application,Object(n.a)(this,this.hUg,"navigateReplaceObjectSuggestion"),4);this.ia.pa(tb.a.ncc,sb.a.application,Object(n.a)(this,this.hUg,"navigateReplaceObjectSuggestion"),4)}we(){const t=this.Fa.Bc(hd.a.sP),N=this.Fa.Bc(hd.a.yg),ha=this.Fa.Bc(hd.a.JEb);
t.bindAction(ob.KeyInputManager.Na(qa.a.aq,2),tb.a.bHb);N.bindAction(ob.KeyInputManager.Na(qa.a.aq,2),tb.a.bHb);ha.bindAction(ob.KeyInputManager.Na(qa.a.aq,2),tb.a.bHb);ha.bindAction(ob.KeyInputManager.Na(qa.a.B0,0),tb.a.bHb);ha.bindAction(ob.KeyInputManager.Na(qa.a.t$,0),tb.a.occ);ha.bindAction(ob.KeyInputManager.Na(qa.a.afa,0),tb.a.ncc)}hnc(){this.z$a||L.a.J(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.z$a=!0}ZMa(t,N,ha,Aa,Ra){if(!this.vh)return L.a.J(33698392,
829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),16;N=this.ta.presentation;if(!this.ta.Ba||!N||this.Xb.Zc(N))return 16;if(1===ha)return 32;ha=!0;Aa=null;Object(Lj.a)(z.a,Ra)?Aa=Ra:Object(Lj.a)(U.a,Ra)&&(Aa=Ra.DAc,ha=!1);Ra=new tl.a(P.a.bE(Aa.ActiveSlideSid,Aa.ActiveSlideCid),Aa.ShapeId,Aa.SmartArtSubNodeId);const yb=new la(Ra);this.yFa.fFk(yb);const Sb=this.Iy.C6a(Ra);if(Sb&&Sb.shapeId===Aa.ShapeId){let uc=null;1===Sb.l0&&(uc=this.Ea.er(Sb.shape));Ra=this.Db.rd(15,
void 0,()=>{1===Sb.l0||this.ra.ku()||(this.Qc.lbd(),this.ra.Ph(),this.Qc.kbd())},()=>{uc&&(this.Qc.lbd(),this.ra.selectShape(uc,!0),this.Qc.kbd())});try{Ra.jc(N),Ra.$c=Aa.SmartArtSubNodeId?tb.a.$Lf:t,N.LEb=Aa,Sb.zAc=Aa.SuggestionSid,Sb.EHd=Aa.Label,Sb.DS=!0,Sb.kmc=new Date,L.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Aa.CorrelationId,t,Aa.SuggestionSid)}finally{Ra&&Ra.dispose()}Sb.Cae=!0;Sb.U7a=!0;ha&&Sb.tre();0===
Sb.l0?this.Xb.zw(N,t):uc?this.Xb.Ipa(N,uc,this.Qb.Ma,t):L.a.J(38854750,808,15,"Invalid smartArtShape")}else L.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}mYa(t,N,ha,Aa,Ra){if(!this.vh)return L.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;N=this.ta.presentation;if(!this.ta.Ba||!N||this.Xb.Zc(N))return 16;if(1===ha)return 32;ha=null;N=0;if(t===tb.a.mYa){t=Object(M.a)(Da,Ra);if(!t)return 16;ha=t.shape;N=t.action}else if(t===
tb.a.bHb){t=this.ra.ae();if(1!==t.length)return 32;ha=t[0]}if(!ha)return L.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;t=this.Iy.C6a(ha.HX);if(!t||!this.z$a&&t&&0===t.l0)return 2;if(t&&t.oD&&t.shapeId===ha.get_shapeId())switch(this.ra.hj(),this.Fa.Ad(),N){case 0:this.Jy.Jml(t.correlationId);break;case 1:this.Jy.OA.isVisible||this.Jy.dMe(t.correlationId);break;case 2:this.Jy.f4d(ha)}return 32}hUg(t,N,ha){if(!this.vh)return L.a.J(33698396,829,15,
"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;N=this.ta.presentation;return this.ta.Ba&&N&&!this.Xb.Zc(N)?1===ha?32:this.Jy.OA.isVisible?t===tb.a.occ?(this.Jy.occ(),32):t===tb.a.ncc?(this.Jy.ncc(),32):16:16:16}}Object(h.a)(Ia,"ReplaceObjectActor",null,[]);class Db{constructor(t,N){this.P8=t;this.sWc=N}initialize(){this.P8.execute(t=>{t.registerSimpleRemoteWorkflow(this.sWc.IF,this.sWc.Jnb,this.sWc.sEb,this.sWc.$mb)})}}Object(h.a)(Db,"ReplaceObjectAugLoopRuntimeManager",
null,[]);var Ob=d(1055),sc;(function(t){t[t.textToSmartArt=0]="textToSmartArt";t[t.iconChunking=1]="iconChunking"})(sc||(sc={}));Object(h.b)("ReplaceObjectType",sc);class hc{constructor(t,N){this.Zya=this.yR=this.la=null;this.shapeId=0;this.S4=null;this.l0=0;this.nba=!1;this.zAc=0;this.EHd=null;this.P8d=this.E8d=this.U7a=this.DS=!1;this.jmc=this.kmc=this.KPe=this.rIb=this.omc=this.fJa=this.lmc=this.Rea=null;this.crb=this.plc=0;this.xAd=this.j2a=this.Ina=null;this.U7=!1;this.suggestions=null;this.hVb=
this.cU=0;this.Cae=!1;this.Veb=null;this.Vic=!1;this.DGe=null;this.lvd=!1;this.zzb=[];this.ni=t;this.q7b=N;this.reset()}ZNa(t,N,ha,Aa,Ra,yb){this.oD&&this.gV(Hf.K5c);if(!t)throw Error.argumentNull("slide");const Sb=t.Fsb(new tl.a(t?t.Bb:null,N,yb));if(!Sb)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",N));this.yR=t;this.Zya=Sb;this.shapeId=N;this.S4=yb;this.Ina=Lc.a.create().toString();this.lvd=!0;this.j2a=ha;this.xAd=Aa;this.la=Ra;this.Rea=new Date;
this.l0=this.qej();return this.correlationId}aFc(t,N,ha,Aa,Ra){return this.ZNa(t,N,ha,Aa,Ra,null)}qej(){const t=this.shape;return this.la.iconChunkingEnabled&&t&&this.S4&&t.get_isSVGBlipFilled()?1:0}gV(t){if(this.oD&&!this.jLj(this.correlationId)){const N={};N.SuggestionCount=this.cU;N.ClientSuggestionTimeoutInMs=this.hVb;N.IsApplied=this.DS;N.AppliedSuggestionId=this.DS?this.zAc.toString():"";N.AppliedSuggestionLabel=this.DS?this.EHd:"";N.IsFloatieShown=this.E8d;N.IsGalleryShown=this.P8d;N.Trigger=
this.trigger;N.RetriggerReason=this.cVk;N.ResetReason=t;N.IconId=this.la.replaceObjectIconType;N.SlideCID=this.slide.cid;N.SlideSID=this.slide.sid;N.ShapeID=this.shapeId;N.AnimId=this.la.replaceObjectAnimId;N.AnimEnabled=this.la.KEb;N.GalleryHoverEnabled=this.la.replaceObjectGalleryHoverEnabled;N.ReplaceSuggestionType=sc[this.l0];N.SeeMoreButtonClicked=this.Vic;N.SeeMoreIconName=this.Vic?this.DGe:"";this.Rea&&(N.SessionLiveTimeInMs=+new Date-+this.Rea);this.S4&&(N.SmartArtSubNodeId=this.S4);this.fJa&&
this.rIb&&this.rIb>this.fJa&&(N.SuggestionsReadyInMs=+this.rIb-+this.fJa);0<this.plc&&(N.SuggestionsDisplayedForMs=this.plc);0<this.crb&&(N.FloatieDisplayedForMs=this.crb);this.fJa&&this.Rea&&this.fJa>this.Rea&&(N.FloatieReadyInMs=+this.fJa-+this.Rea);this.Rea&&this.lmc&&this.Rea>this.lmc&&(N.TriggeredByAugLoopInMs=+this.Rea-+this.lmc);this.kmc&&this.jmc&&this.jmc>this.kmc&&(N.SuggestionAppliedInMs=+this.jmc-+this.kmc);if(0<this.suggestions.length){t=[];for(let ha=0;ha<this.suggestions.length;ha++)Array.add(t,
this.suggestions[ha].labelText);N.SuggestionLabels=of.c(t)}1!==this.l0||gb.a.Va(this.Veb)||(t=Ob.a.F6a(this.Veb))&&t.hasChildNodes()&&(Ob.a.rYb(),Ob.a.MMk(this.Veb));this.ni.ESk(this.correlationId,of.c(N),void 0,Object(n.a)(this,this.Wcc,"onFailureCallback"));this.Jak(this.correlationId)}this.reset()}reset(){this.lvd=!1;this.yR=null;this.Cae=this.P8d=this.E8d=this.U7a=this.DS=this.nba=!1;this.xAd=this.j2a=this.Ina="";this.suggestions=[];this.zAc=0;this.EHd="";this.U7=!1;this.hVb=this.cU=0;this.jmc=
this.kmc=this.KPe=this.rIb=this.omc=this.fJa=this.lmc=this.Rea=null;this.l0=this.crb=this.plc=0;this.Veb="";this.Zya=null;this.Vic=!1;this.DGe=""}jLj(t){return this.zzb?Array.contains(this.zzb,t):!1}Jak(t){this.zzb&&!Array.contains(this.zzb,t)&&(Array.add(this.zzb,t),L.a.J(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",t,this.zzb.length))}Wcc(t){L.a.J(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",
t.HttpStatusCode);return!0}tre(){this.KRg(2,4)}Oak(){this.KRg(3,3)}KRg(t,N){this.q7b&&this.q7b.execute(ha=>{const Aa=Object.assign(new qk.a,{cardId:oi.a.Brh,actionType:t,actionEngagement:N});ha.b6c(Aa)})}get slide(){return this.yR}get shape(){return this.Zya}get correlationId(){return this.Ina}get trigger(){return this.j2a}get cVk(){return this.xAd}get oD(){return this.lvd}get appSettings(){return this.la}get HX(){return new tl.a(this.slide?this.slide.Bb:null,this.shapeId,this.S4)}}Object(h.a)(hc,
"ReplaceObjectContext",null,[830]);class Fc{constructor(){this.va=new qm.a}fFk(t){this.va.raiseEvent("ReplaceObjectBSA",t)}x3h(t){this.va.addHandler("ReplaceObjectBSA",t)}pPk(t){this.va.removeHandler("ReplaceObjectBSA",t)}W9g(t){this.va.raiseEvent("ReplaceObjectSPOver",t)}c5h(t){this.va.addHandler("ReplaceObjectSPOver",t)}pQk(t){this.va.removeHandler("ReplaceObjectSPOver",t)}V9g(t){this.va.raiseEvent("ReplaceObjectSPOut",t)}b5h(t){this.va.addHandler("ReplaceObjectSPOut",t)}oQk(t){this.va.removeHandler("ReplaceObjectSPOut",
t)}jFk(t){this.va.raiseEvent("ReplaceObjectViewDE",t)}o4h(t){this.va.addHandler("ReplaceObjectViewDE",t)}TPk(t){this.va.removeHandler("ReplaceObjectViewDE",t)}}Object(h.a)(Fc,"ReplaceObjectEventSource",null,[827,828,829]);class Xc extends go{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff,ah,aj,Df,Fi,We,wi,Mn){super(yb,t,N,ha,Aa,Ra,Sb,uc,Zc,ed,Gd,re,ff,ah,aj,Fi,We,wi,Mn);this.ai=uc.v9f();this.ni=ze;this.la=Df}YG(t,N){if(!this.vh)L.a.J(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");
else if(!this.eUa&&N.OD.length)if(t=this.ra.ae(),1!==t.length)this.ai.oD&&this.closeSession(this.ai,Hf.OT);else{t=t[0];if(this.ai.oD){if(this.ai.shapeId===t.get_shapeId())return;this.closeSession(this.ai,Hf.OT)}this.jYa(t)&&this.Vha(this.ta.Ba,t,sl.selectShape,"")}}Zve(t,N){this.vh?this.ai.oD&&this.ai.shape===N.shape&&(t=this.ai.shape,this.closeSession(this.ai,Hf.Yjc),this.jYa(t)&&this.Vha(this.ta.Ba,t,sl.Ieb,ue.Yjc)):L.a.J(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}ure(t,
N){N.Lub&&this.HP(N.actionId)}iC(){this.ai.oD&&this.closeSession(this.ai,Hf.slideNavigation)}G_(t,N){this.ai.oD&&N.B7&&N.shapes&&Array.contains(N.shapes,this.ai.shapeId)&&this.closeSession(this.ai,Hf.TJe)}Yve(t,N){N.correlationId!==this.ai.correlationId?L.a.J(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.ai.correlationId,N.correlationId):this.Qhg(N,this.ai,this.la)}Wte(){this.vh&&this.ai.U7a&&0===this.ai.l0&&!this.Xb.Zc(this.ta.presentation)&&
(this.ai.U7a=!1,this.Jy.gma(this.ai.shape,!0))}Vha(t,N,ha,Aa=""){try{const Ra=this.ai.aFc(t,N.get_shapeId(),ha,Aa,this.la);this.ai.U7=!0;this.Jy.gnc(this.ai.correlationId);this.ni.M5f(t.cid,t.sid,N.get_shapeId(),Ra,ha,this.Kt.iNc(N),this.Kt.hNc(N),void 0,Object(n.a)(this,this.Wcb,"onTaskFailure"));this.la.powerPointIdeasIsEnabled&&this.NBb(Ra,this.ai.shapeId,this.ai.suggestions,Mj.a.pending)}catch(Ra){L.a.J(34152532,829,15,"GenerateSuggestion failed!! {0} ",Ra.message)}}Wcb(t){L.a.J(36966422,829,
15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",t.HttpStatusCode);return!0}HP(t){this.vh?this.ai.oD&&!this.mSc(t)&&this.closeSession(this.ai,Hf.SJb+this.sI.D4(t)):L.a.J(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(t,N){t.nba&&this.Jy.gma(t.shape,!0);t.gV(N);this.la.powerPointIdeasIsEnabled&&this.NBb(t.correlationId,t.shapeId,t.suggestions,Mj.a.rGa)}}Object(h.a)(Xc,"ReplaceObjectManager",go,[]);var md=
d(21);class Nc{constructor(t){this.xN=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.ude=Array.clone(t)}get_current(){if(-1===this.xN||this.xN>=this.ude.length)throw Error.invalidOperation();return this.ude[this.xN]}moveNext(){this.xN++;return this.xN<this.ude.length}reset(){this.xN=-1}}Object(h.a)(Nc,"ArrayEnumerator",null,[145]);class bf{constructor(t){this.wFa=[];this.$$ge=this.getEnumerator;this.f7j=t}getEnumerator(){return new Nc(this.wFa)}[Symbol.iterator](){return Object(md.a)(this.getEnumerator())}NQc(t,
N){t&&(t.gV(N),Array.remove(this.wFa,t))}B6a(t){for(const N of this.wFa)if(N.correlationId===t)return N;return null}C6a(t){for(const N of this.wFa)if(tl.a.Xjc(t,N.HX))return N;return null}vcg(t,N){for(const ha of this.wFa)if(ha.shapeId===t&&(!N&&!ha.S4||N&&N===ha.S4))return ha;return null}a0b(t){return this.vcg(t,null)}v9f(){return 0<this.wFa.length?this.wFa[0]:null}ZNa(t,N,ha,Aa,Ra,yb){let Sb=this.C6a(new tl.a(t.Bb,N,yb));Sb&&this.NQc(Sb,Hf.K5c);Sb=this.f7j(t,N,ha,Aa,Ra,yb);Array.add(this.wFa,Sb);
return Sb}aFc(t,N,ha,Aa,Ra){return this.ZNa(t,N,ha,Aa,Ra,null)}get Wzf(){let t=0;this.wFa.forEach(N=>{N.oD&&t++});return t}}Object(h.a)(bf,"ReplaceObjectMultipleContextManager",null,[784,143]);class pe{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed){this.ta=t;this.tNg=N;this.i7j=ha;this.Kt=yb;this.xFa=Ra;this.Iy=Aa;this.OA=Sb;this.Fa=uc;this.Le=Zc;this.Ea=ed;this.Yq=!1;this.Mrc=-1}get vh(){return this.Yq}get Tsb(){return this.Mrc}setup(){this.vh||(this.xFa.x3h(Object(n.a)(this,this.QWg,"onBeforeReplaceObjectSuggestionApply")),
this.xFa.c5h(Object(n.a)(this,this.u_g,"onReplaceObjectSuggestionPointerOver")),this.xFa.b5h(Object(n.a)(this,this.t_g,"onReplaceObjectSuggestionPointerOut")),this.Yq=!0)}dispose(){this.vh&&(this.xFa.pPk(Object(n.a)(this,this.QWg,"onBeforeReplaceObjectSuggestionApply")),this.xFa.pQk(Object(n.a)(this,this.u_g,"onReplaceObjectSuggestionPointerOver")),this.xFa.oQk(Object(n.a)(this,this.t_g,"onReplaceObjectSuggestionPointerOut")),this.Yq=!1)}QWg(t,N){if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");
(t=this.ta.Ba.Fsb(N.HX))&&this.gma(t,!1)}u_g(t,N){this.ta.Ba&&(t=new tl.a(this.ta.Ba.Bb,N.shapeId,N.LX),(t=this.ta.Ba.Fsb(t))&&this.cMe(t,N.blg))}t_g(t,N){this.ta.Ba&&(t=new tl.a(this.ta.Ba.Bb,N.shapeId,N.LX),(t=this.ta.Ba.Fsb(t))&&this.S1b(t))}cMe(t,N){let ha=t;t.get_smartArtModelId()&&(ha=this.Ea.er(t));if(t=this.eeg(ha))this.gqh(ha,!1),t.cMe(N)}S1b(t){let N=t;t.get_smartArtModelId()&&(N=this.Ea.er(t));if(t=this.eeg(N))this.gqh(N,!0),t.S1b()}eeg(t){return t&&!t.get_smartArtModelId()&&Object(M.a)(124,
t.oc(this.Le))?this.i7j.xP(t):null}WLi(t){return t&&Object(M.a)(124,t.oc(this.Le))?this.tNg.xP(t):null}a0d(t){return t&&Object(M.a)(124,t.oc(this.Le))?this.tNg.VE(t):null}rhd(t){if(!this.vh)L.a.J(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(t){var N=this.WLi(t);if(N){const ha=this.Iy.C6a(t.HX);!ha||ha.nba&&this.Tsb!==ha.shapeId||(ha.nba?this.Tsb===ha.shapeId&&(N.BHc(),this.Mrc=-1):(this.gma(t,!0,!(this.OA.aXa&&this.OA.isVisible&&tl.a.Xjc(t.HX,
this.OA.aXa.HX))),N.display()),ha.nba=!0)}}}ENk(){if(-1!==this.Tsb&&this.ta.Ba){var t=this.ta.Ba.oS(this.Tsb);t&&this.gma(t,!0)}}gma(t,N,ha=!0,Aa=!1){this.vh?t&&(N&&this.S1b(t),ha&&this.f4d(t),N=this.a0d(t))&&(Aa?(N.xGc(),this.Mrc=t.get_shapeId()):(this.Tsb===t.get_shapeId()&&(this.Mrc=-1),N.visible&&N.dismiss(),(Aa=this.Iy.C6a(t.HX))&&t.get_shapeId()===Aa.shapeId&&(Aa.nba=!1))):L.a.J(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}gnc(t){this.OA.gnc(t)}Jml(t){if(this.vh)if(this.OA.isVisible){const N=
this.Iy.B6a(t);N&&N.oD&&N.correlationId===t&&this.S1b(N.shape);this.f4d(N.shape)}else this.dMe(t);else L.a.J(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}f4d(t){this.OA.isVisible&&this.OA.aXa&&tl.a.Xjc(this.OA.aXa.HX,t.HX)&&(this.OA.dismiss(),(t=this.a0d(this.OA.aXa.shape))&&t.root&&(t.root.style.zIndex="0"),this.Fa.Gj(hd.a.JEb,!1))}dMe(t){const N=this.Iy.B6a(t);if(N&&N.correlationId===t&&N.oD){var ha=this.a0d(N.shape);if(ha){var Aa=ha.root;Aa?this.OA.isVisible&&
this.OA.aXa&&!tl.a.Xjc(this.OA.aXa.HX,N.HX)||(Aa=this.Kt.getBounds(Aa),this.OA.show(t,Aa.x,Aa.y),ha.root.style.zIndex=String(v.AFrameworkApplication.Aa.zmb),this.Fa.Gj(hd.a.JEb,!0),N.P8d=!0):L.a.J(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else L.a.J(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}Uah(t){this.vh?this.OA.isVisible&&this.dMe(t):L.a.J(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}occ(){if(this.vh){var t=
this.OA.OYd();t&&(-1===t?this.OA.jw(0,!0):(this.OA.jw(t,!1),this.OA.jw(t-1,!0)))}else L.a.J(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}ncc(){if(this.vh){var t=this.OA.OYd();t+1!==this.OA.lej()&&(-1===t?this.OA.jw(0,!0):(this.OA.jw(t,!1),this.OA.jw(t+1,!0)))}else L.a.J(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}gqh(t,N){t&&(t=Object(M.a)(124,t.oc(this.Le)))&&((t=t.ya)?t.Qd(N):L.a.J(25306516,
829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(h.a)(pe,"ReplaceObjectPresenter",null,[814]);class wf{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.$Cb=null;this.Kxe=0}}Object(h.a)(wf,"TaskItem",null,[]);class rf{constructor(t,N,ha){this.jbb=[];this.ni=t;this.Kt=N;this.sDg=ha}ERi(t,N,ha){for(let Aa=0;Aa<this.jbb.length;Aa++)if(this.jbb[Aa].slideSid===t&&this.jbb[Aa].slideCid===N&&this.jbb[Aa].shapeId===ha)return this.jbb[Aa];return null}pjh(t){var N=this.ERi(t.slide.sid,
t.slide.cid,t.shapeId);if(N)return N.$Cb=t,N.Kxe++,1;const ha=Object.assign(new wf,{slideSid:t.slide.sid,slideCid:t.slide.cid,shapeId:t.shapeId,Kxe:0,$Cb:null});Array.add(this.jbb,ha);t.U7=!0;N=t.correlationId;const Aa=t.slide,Ra=t.shape;this.ni.M5f(Aa.cid,Aa.sid,Ra.get_shapeId(),N,t.trigger,this.sDg?this.Kt.iNc(Ra):this.Kt.m0b(Ra),this.sDg?this.Kt.hNc(Ra):this.Kt.l0b(Ra),()=>{this.O0g(ha)},yb=>{this.O0g(ha);L.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
yb.HttpStatusCode);return!0});return 0}O0g(t){Array.remove(this.jbb,t);t.$Cb&&t.$Cb.oD&&(L.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",t.$Cb.correlationId,t.Kxe-1),this.pjh(t.$Cb))}}Object(h.a)(rf,"ReplaceObjectRequestManager",null,[783]);class fi{constructor(t){this.fke=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.qp=t}get_current(){return this.qp}moveNext(){return this.fke?(this.fke=!1,!0):!1}reset(){this.fke=
!0}}Object(h.a)(fi,"SingleEnumerator",null,[145]);class Fh{constructor(t){this.$$ge=this.getEnumerator;this.ai=t}getEnumerator(){return new fi(this.ai)}[Symbol.iterator](){return Object(md.a)(this.getEnumerator())}NQc(t,N){t&&t===this.ai&&t.gV(N)}B6a(){return this.ai}C6a(){return this.ai}a0b(){return this.ai}vcg(){return this.ai}v9f(){return this.ai}ZNa(t,N,ha,Aa,Ra,yb){this.ai.ZNa(t,N,ha,Aa,Ra,yb);return this.ai}aFc(t,N,ha,Aa,Ra){return this.ZNa(t,N,ha,Aa,Ra,null)}get Wzf(){return this.ai.oD?1:0}}
Object(h.a)(Fh,"ReplaceObjectSingleContextManager",null,[784,143]);var Qf=d(130);class Mh{constructor(t,N,ha,Aa,Ra){this.ada=null;this.fAb=this.zfe=!1;this.yka=null;this.visible=!1;this.ev=t;this.KS=N;this.Nja=ha;this.Kt=Ra;this.R$b=Aa;this.Yq=!1}get vh(){return this.Yq}setup(){this.vh||(this.yka=new Bc.a,this.ada=this.R$b.Fzi(this.yka.ya),this.KS&&!this.KS.ll&&this.KS.PT&&(this.KS.PT.appendChild(this.yka),this.Qd(!1),this.fAb=!0,this.KS.zza(this,3),this.visible=this.KS.KP||this.KS.Fn),this.Yq=!0)}$m(){L.a.J(25306526,
829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}XD(){}kq(){if(!this.vh)return L.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.zfe||!this.ada.vh||!this.ada.YM)return null;const t=pb.a.jn(this.ada.YM.ya.style.left),N=pb.a.jn(this.ada.YM.ya.style.top),ha=pb.a.jn(this.ada.YM.ya.style.width),Aa=pb.a.jn(this.ada.YM.ya.style.height);return new Qf.a(new Ua.a(t,N),new Ua.a(t+ha,N),new Ua.a(t+ha,N+
Aa),new Ua.a(t,N+Aa))}IP(){return!1}Ux(){}nz(){}setPosition(){}Ej(){this.fAb=!0;this.Ws()}Uq(){this.fAb=!0;this.Ws()}pv(){this.fAb=!0;this.Ws()}setZIndex(t){this.yka&&this.yka.uC(t)}AF(){}XE(){return null}QD(){return[]}draw(){}dispose(){this.Nja();this.vh&&(this.ada.dispose(),this.yka.ya.parentNode&&this.yka.iq(),this.yka=null,this.Yq=!1)}cMe(t){this.vh?(this.sjc(t),this.Ws()):L.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}S1b(){this.vh?this.Qpa():
L.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}sjc(t){this.vh?(this.ada.cIa(t),this.Qd(!0)):L.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}Qpa(){this.vh?(this.ada.dismiss(),this.Qd(!1)):L.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}Ws(){if(this.zfe&&this.fAb){var t=this.Kt.m0b(this.ev),N=this.Kt.l0b(this.ev);this.yh(t,N);this.yka&&(t=
this.Kt.Baj(this.ev),wn.a.setRotation(this.yka.ya,t));this.fAb=!1}}Qd(t){this.zfe=t;this.yka.Qd(t)}yh(t,N){this.ada&&this.ada.yh(t,N)}}Object(h.a)(Mh,"ReplaceObjectSuggestionPreviewView",null,[825,826,387,388,106,814]);var kj=d(264),r=d(218),X=d(247),ra=d(966),Qa=d(965);class db extends Sys.EventArgs{constructor(t){super();this.shape=t}}Object(h.a)(db,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class Hb{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd){this.WOg=!1;this.U8=this.BTa=null;this.ia=
Ra;this.ve=yb;this.od=Sb;this.Iy=uc;this.yFa=Zc;this.R$b=Aa;this.Nja=ha;this.ev=t;this.KS=N;this.IG=!1;this.la=ed;this.moe=Gd;this.Yq=this.visible=!1}get vh(){return this.Yq}Orb(){return this.Iy.C6a(this.ev.HX)}setup(){if(!this.vh){var t=this.Orb();t=t?t.l0:0;this.WOg=1===t;this.U8=new Bc.a;this.BTa=this.R$b.Xwi(this.U8,Hb.HBc,Object(n.a)(this,this.Qjk,"onFlyoutAnchorClick"),Object(n.a)(this,this.Rjk,"onFlyoutAnchorHover"),t);this.KS&&!this.KS.ll&&this.KS.PT&&(this.$m(this.KS.PT),this.KS.zza(this,
3));this.Yq=!0}}BHc(){this.vh?this.BTa&&this.BTa.BHc():L.a.J(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}xGc(){this.vh?this.BTa&&this.BTa.xGc():L.a.J(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.vh)L.a.J(512496030,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.Ws();this.BTa.show();this.visible=!0;this.xJb();var t=this.Orb();if(t){t.E8d=!0;const N=new Date;t.fJa||
(t.fJa=N);t.omc=N;L.a.J(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",t.trigger,t.correlationId)}}}get root(){return this.vh?this.U8.ya:(L.a.J(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.vh){this.BTa.dismiss();this.visible=!1;var t=this.Orb();t&&(t.nba=!1,t.omc&&(t.crb+=+new Date-+t.omc,L.a.J(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
t.crb,t.omc,t.trigger,t.correlationId)))}else L.a.J(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}$m(){this.visible=!1;this.ve.addCssClass(this.U8.ya,"replaceObjectBody");document.body.appendChild(this.U8.ya);this.od.SSb(Object(n.a)(this,this.onResize,"onResize"));this.Ws()}XD(){}kq(){return null}IP(){return!1}Ux(){}nz(){}setPosition(){}Ej(){}Uq(){}pv(){}setZIndex(){}AF(t){if(this.vh){if(t)this.visible=!1,this.xJb();else if(this.IG){const N=new db(this.ev);this.yFa.jFk(N)}this.IG=
t}else L.a.J(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}XE(){return null}QD(){return[]}draw(){this.vh?this.Ws():L.a.J(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.Nja();this.vh&&(this.od.Cdh(Object(n.a)(this,this.onResize,"onResize")),this.U8&&(this.U8.ya.parentNode&&this.U8.iq(),this.ve.removeCssClass(this.U8.ya,"replaceObjectBody")),this.dismiss(),this.BTa.dispose(),this.U8=null,this.Yq=!1)}xJb(){this.U8.ya.style.visibility=
this.visible?Ub.a.visible:Ub.a.hidden;const t=this.Orb();t&&(t.nba=this.visible)}Ws(){let t=null;var N=this.KS.PT;N&&(t=this.ve.Yh(N.ya));t?(N=t.x-(Hb.HBc+10),this.WOg&&this.KS&&this.KS.Fd&&(N=this.KS.Fd.Cd.Ge(this.ev.Ex,0),N=t.x+N+10),wn.a.TIe(this.U8.ya,1),this.U8.setPosition(1*N,t.y),this.Vsl(1*N,t.y)):L.a.J(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}Vsl(t,N){if(this.moe.isVisible){var ha=this.Orb(),Aa=this.moe.aXa;Aa&&ha&&Aa.correlationId===ha.correlationId&&
this.moe.updatePosition(t,N)}}Qjk(t){if(t.Sz!==Sys.UI.MouseButton.leftButton)return!1;this.ia.Ka(tb.a.mYa,2,Object.assign(new Da,{shape:this.ev,action:0}));return!0}Rjk(){if(!this.la.replaceObjectGalleryHoverEnabled)return!1;const t=this.Orb();if(t&&1===t.l0)return!1;this.ia.Ka(tb.a.mYa,2,Object.assign(new Da,{shape:this.ev,action:1}));return!0}onResize(t,N){this.visible&&(t=null,N&&N.EF&&(t=N.EF.Nd),t&&t.Bb.equals(this.ev.slideId)&&this.Ws())}}Hb.HBc=32;Object(h.a)(Hb,"ShapeReplaceObjectView",null,
[812,813,387,388,106,814]);var Vb=d(633);class vb{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze){this.DUa=this.Lca=this.FUa=this.T3=this.io=null;this.o3c=0;this.Lie=-1;this.fq=this.ai=null;this.ve=t;this.gd=ha;this.Vo=N;this.ta=Aa;this.ia=Ra;this.yD=Zc;this.yFa=yb;this.Iy=Sb;this.c_=uc;this.Fa=ed;this.la=Gd;this.W7j=!ze.Hj;this.Yq=this.qkb=!1}get vh(){return this.Yq}get isVisible(){return this.qkb}get aXa(){return this.ai}setup(){this.vh||(this.io=pb.a.Ee(),this.io.setAttribute("Unselectable","on"),
this.io.style.position=Ub.a.absolute,this.ve.addCssClass(this.io,"replaceObjectContainer"),this.$Ee(null),document.body.appendChild(this.io),this.Xla(),this.yD.v7(hd.a.JEb,hd.a.gj,this.io,()=>{},()=>{},!0),this.Yq=!0)}dispose(){this.vh&&(this.dismiss(),this.Zmc(),this.io&&this.io.parentNode&&this.io.parentNode.removeChild(this.io),this.Yq=!1)}dismiss(){this.vh?(v.AFrameworkApplication.Aa.VOa(!0),this.setVisibility(!1),this.eBb.style.display=Ub.a.none,this.eBb.style.zIndex="-1",this.DUa=this.Lca=null,
this.$Ee(null)):L.a.J(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(t,N,ha){if(!this.vh)L.a.J(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");else if(!gb.a.Va(t)){var Aa=this.Iy.B6a(t);Aa&&Aa.correlationId===t&&Aa.oD&&!Aa.U7&&(this.ai=Aa,this.Mwk(t,this.ai.suggestions),this.o3c=this.ai.cU,this.wfh(),v.AFrameworkApplication.Aa.lNa(!0),this.eBb.style.zIndex=String(v.AFrameworkApplication.Aa.gpa),this.io.style.zIndex=String(v.AFrameworkApplication.Aa.zmb),
this.eBb.style.visibility=Ub.a.hidden,this.eBb.style.display=Ub.a.block,this.eBb.style.visibility=Ub.a.visible,this.Ria()?this.ve.addCssClass(this.io,"replaceIconObjectContainer"):this.ve.removeCssClass(this.io,"replaceIconObjectContainer"),this.updatePosition(N,ha),this.setVisibility(!0))}}updatePosition(t,N){let ha,Aa;this.setPosition(0,0);if(this.Ria()){ha=t+Hb.HBc+7;Aa=N;const Ra=Vb.a(0,0);ha+this.io.offsetWidth>Ra.width&&(ha=t+Hb.HBc-this.io.offsetWidth,Aa=N-7-this.io.offsetHeight)}else ha=t,
Aa=N-7-this.io.offsetHeight;this.setPosition(ha,Aa)}lej(){return this.vh?this.o3c:(L.a.J(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),0)}OYd(){return this.vh?this.isVisible?this.io?this.io.querySelector(".replaceObjectSuggestionsList")?this.Lie:(L.a.J(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(L.a.J(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),
-1):-1:(L.a.J(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}jw(t,N){if(!this.vh)L.a.J(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>t)&&this.isVisible)if(this.io)if(t>=this.o3c)L.a.J(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.o3c,t);else{var ha=this.io.querySelector(".replaceObjectSuggestionsList");
ha?(ha=ha.children)?(ha=ha[t])?N?(this.Lie=t,ec.FocusManager.Dr(ha)&&this.uqh(ha.firstChild)):(this.wfh(),ec.FocusManager.epl(ha)&&this.Tjg(ha.firstChild)):L.a.J(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):L.a.J(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):L.a.J(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else L.a.J(25306584,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}gnc(t){this.FUa&&(this.FUa.className="ReplaceObjectCorrelation "+t)}Mwk(t,N){this.$Ee(t);if(t=this.VAi(t,N))N=this.UAi(),this.io.appendChild(N),this.io.appendChild(t),this.Ria()&&(t=this.TAi(),this.io.appendChild(t))}$Ee(t){this.io&&(this.T3&&(this.gd.xb(ka.a.click,this.T3,Object(n.a)(this,this.fZg,"onLinkClick")),this.T3=null),this.ve.$t(this.io),this.FUa=pb.a.Ee(),this.FUa.setAttribute("Unselectable",
"on"),this.FUa.className=gb.a.Va(t)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+t,this.FUa.style.position=Ub.a.absolute,this.FUa.style.display=Ub.a.none,this.io.appendChild(this.FUa),this.io.style.zIndex="-1")}UAi(){const t=pb.a.zn();t.setAttribute("Unselectable","on");this.Ria()?(t.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.ve.addCssClass(t,"replaceIconObjectContainerTitle")):(t.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.ve.removeCssClass(t,
"replaceIconObjectContainerTitle"));this.ve.addCssClass(t,"UIFont replaceObjectContainerTitle");return t}VAi(t,N){if(gb.a.Va(t))return L.a.J(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!N||!N.length)return L.a.J(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const ha=pb.a.FWb();ha.id=t;ha.setAttribute("Unselectable","on");ha.setAttribute(na.a.We,na.a.u$h);
this.ve.addCssClass(ha,"replaceObjectSuggestionsList");this.Lca||(this.Lca=new yc.a);this.DUa||(this.DUa=new yc.a);for(var Aa of N)gb.a.Va(Aa.imageData)||this.Lca.$(Aa.index,Aa.imageData),this.Ria()&&!gb.a.Va(Aa.renderData)&&this.DUa.$(Aa.index,Aa.renderData),t=this.Gdi(Aa.index,Aa.labelText),ha.appendChild(t);if(this.W7j&&0<this.DUa.count&&this.Ria()&&(gb.a.Va(this.ai.Veb)&&(this.ai.Veb=wk.a.create().toString()),(Aa=Ob.a.F6a(this.ai.Veb))&&!Aa.hasChildNodes())){Aa.style.position=Ub.a.absolute;Aa.style.left=
"0px";Aa.style.top="0px";for(let Ra of this.DUa.values)t=pb.a.CB(),t.src=Ra,t.style.display=Ub.a.block,t.style.position=Ub.a.absolute,Aa.appendChild(t);Ob.a.OTb()}return ha}TAi(){this.T3=pb.a.zn();this.T3.setAttribute("Unselectable","on");this.T3.setAttribute("tabindex","-1");this.T3.setAttribute(na.a.We,na.a.AId);this.ve.addCssClass(this.T3,"UIFont replaceObjectContainerLink");this.Ria()&&this.la.pptSmartArtSubNodeIconChangeEnabled&&this.la.L7a&&(this.T3.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,
this.gd.ob(ka.a.click,this.T3,Object(n.a)(this,this.fZg,"onLinkClick")));const t=pb.a.Ee();t.appendChild(this.T3);return t}Xla(){this.io&&(this.gd.ob(ka.a.click,this.io,Object(n.a)(this,this.onClick,"onClick")),this.c_.addHandler(this.io,ka.a.eg,Object(n.a)(this,this.jQc,"inputKeyApplyHandler")),this.Vo.ob(ka.a.pointerOver,this.io,Object(n.a)(this,this.jC,"onPointerOver")),this.Vo.ob(ka.a.pointerOut,this.io,Object(n.a)(this,this.Py,"onPointerOut")))}Zmc(){this.io&&(this.gd.xb(ka.a.click,this.io,Object(n.a)(this,
this.onClick,"onClick")),this.c_.removeHandler(this.io,ka.a.eg,Object(n.a)(this,this.jQc,"inputKeyApplyHandler")),this.Vo.xb(ka.a.pointerOver,this.io,Object(n.a)(this,this.jC,"onPointerOver")),this.Vo.xb(ka.a.pointerOut,this.io,Object(n.a)(this,this.Py,"onPointerOut")))}jC(t){t=this.a1d(t.Fc);this.uqh(t);return!0}Py(t){t=this.a1d(t.Fc);this.Tjg(t);return!0}jQc(t){if(this.isVisible&&!t.ctrlKey&&!t.altKey&&(!t.shiftKey||t.keyCode===qa.a.Bq&&this.Ria()))if(t.keyCode===qa.a.aq||t.keyCode===qa.a.xO)t.preventDefault(),
(t=this.io.querySelector(":focus"))&&t.firstChild.click();else if(t.keyCode===qa.a.Bq&&this.Ria()){const N=this.io.querySelector(":focus");N&&this.T3&&(N===this.T3?(t.preventDefault(),t.stopPropagation(),this.jw(0,!0)):N.parentNode&&N.parentNode.className&&0<=N.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(t.preventDefault(),t.stopPropagation(),this.jw(this.OYd(),!1),ec.FocusManager.Dr(this.T3)))}}onClick(t){if(t.Sz!==Sys.UI.MouseButton.leftButton)return!1;var N=this.a1d(t.Fc);if(!this.bae(N)||
!this.NNj(N))return!0;t=this.$_i(N);const ha=this.z0b(N);N=this.oej(N);gb.a.Va(t)||gb.a.Va(ha)||(t=Object.assign(new z.a,{SuggestionSid:parseInt(ha),ShapeId:this.ai.shapeId,CorrelationId:t,ActiveSlideCid:this.ta.Ba.cid,ActiveSlideSid:this.ta.Ba.sid,Label:N,SmartArtSubNodeId:this.ai.S4?this.ai.S4:null,ReplaceObjectType:this.ai.l0}),this.ia.Ka(tb.a.ZMa,2,t));return!0}fZg(){this.ai&&(this.ai.Vic=!0);this.B2d();this.ia.processAction(tb.a.IUb,2);return!0}uqh(t){t&&this.bae(t)&&(t=this.z0b(t),gb.a.Va(t)||
(t=this.Ria()?this.DUa.Jb(t)?this.DUa.ga(t):"":this.Lca.Jb(t)?this.Lca.ga(t):"",gb.a.Va(t)||(t=new Qa.a(this.ai.shapeId,t,this.ai.S4),this.yFa.W9g(t))))}Tjg(t){t&&this.bae(t)&&(t=new ra.a(this.ai.shapeId,this.ai.S4),this.yFa.V9g(t))}a1d(t){if(!t)throw Error.argumentNull("sourceElement");return"a"===t.nodeName.toLowerCase()?t:t.parentNode}$_i(t){return t?t.parentNode.parentNode.id:null}z0b(t){if(!t)return null;t=t.id.split("_");return 2!==t.length?null:t[1]}oej(t){return t?t.title:null}bae(t){return!!t&&
!gb.a.Va(t.className)&&-1!==t.className.indexOf("ObjectSuggestionContainer")}NNj(t){return!!t&&!gb.a.Va(t.className)&&-1===t.className.indexOf("ReplaceObjectSuggestionLoading")}Gdi(t,N){const ha=this.Lca.Jb(t);var Aa=ha?this.Lca.ga(t):Vg.a.cK(hb.a.Sla);ha||L.a.J(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Ra=pb.a.CB();Ra.setAttribute("Unselectable","on");Ra.src=Aa;Ra.title=N;Ra.setAttribute(na.a.We,na.a.wM);this.ve.addCssClass(Ra,"replaceObjectSuggestionThumbnail");
Aa=pb.a.Saa();Aa.id="ROS_"+t;Aa.setAttribute("Unselectable","on");Aa.title=N;Aa.setAttribute(na.a.We,"none");let yb=this.Ria()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.ai.DS&&this.ai.zAc.toString()===t&&(yb+="Selected");this.ve.addCssClass(Aa,yb);ha||this.ve.addCssClass(Aa,"ReplaceObjectSuggestionLoading");Aa.appendChild(Ra);t=this.ve.dSf();t.setAttribute("Unselectable","on");t.setAttribute("tabindex","-1");t.setAttribute(na.a.We,na.a.wM);t.setAttribute(na.a.vs,
N);t.appendChild(Aa);return t}setPosition(t,N){this.vh?(0>t&&(t=0),0>N&&(N=0),this.io.style.left=this.ve.Lc(t),this.io.style.top=this.ve.Lc(N)):L.a.J(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(t){if(this.io){if(this.ai)if(t)this.ai.KPe=new Date,this.ai.Oak();else{let N;(N=this.ai).plc=N.plc+(+new Date-+this.ai.KPe)}this.io.style.visibility=t?Ub.a.visible:Ub.a.hidden;this.qkb=t;this.Fa.Gj(hd.a.JEb,t)}}wfh(){this.Lie=-1}Ria(){return!!this.ai&&
1===this.ai.l0}get eBb(){this.fq&&"undefined"!==typeof this.fq||(this.fq=this.ve.Ee(),this.fq.setAttribute("id","ModalDiv"),this.ve.addCssClass(this.fq,"cui-modalDiv"),this.fq.setAttribute("Unselectable","on"),document.body.appendChild(this.fq),kj.a.instance.ob(ka.a.pointerDown,this.fq,Object(n.a)(this,this.C7c,"onModalPointerDown")),kj.a.instance.ob(ka.a.GQ,this.fq,Object(n.a)(this,this.D7c,"onModalPointerUp")),kj.a.instance.ob(ka.a.Iec,this.fq,Object(n.a)(this,this.Llk,"onModalPointerMove")),kj.a.instance.ob(ka.a.pointerOut,
this.fq,Object(n.a)(this,this.Mlk,"onModalPointerOut")),r.a.instance.ob(ka.a.click,this.fq,Object(n.a)(this,this.Klk,"onModalClick")),X.a.instance.ob(ka.a.jBb,this.fq,Object(n.a)(this,this.Dve,"onModalMouseWheel")));return this.fq}C7c(){return!0}D7c(){return this.B2d()}Llk(){return!0}Mlk(){return!0}Klk(){return this.B2d()}Dve(){return!0}B2d(){if(!this.ai||!this.ai.slide)return!0;const t=this.ai.shape;if(!t)return!0;this.ia.Ka(tb.a.mYa,2,Object.assign(new Da,{action:2,shape:t}));return!0}}Object(h.a)(vb,
"ReplaceObjectSuggestionsGalleryView",null,[781,814]);class zb{constructor(t,N,ha,Aa){this.j7j=t;this.Kt=N;this.ta=ha;this.la=Aa}HXi(t){if(!this.ta.Ba)return!1;t=this.ta.Ba.oS(t);return this.Knc(t)}Knc(t){return!(t&&t.get_shapeId()&&t.hasText&&this.Kt.I8a(t))||t.get_shapeRotation()||t.Lv||t.T2||t.wy||!this.j7j.validate(t)?!1:!0}SPj(t){return!Array.contains(this.la.replaceObjectDisabledTriggers,t)}}Object(h.a)(zb,"ReplaceObjectValidationHelper",null,[]);class ic{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc){this.pr=
this.YZ=null;this.Yq=!1;this.JW=t;this.gd=N;this.Vo=ha;this.FN=Aa;this.Vca=Ra;this.fe=Sb;this.la=yb;this.w9a=Zc}get vh(){return this.Yq}xGc(){this.la.KEb?this.pr.setAttribute("Src",this.fe.Yj("BLUEBOLT_Deactivated.gif")):this.pr.style.opacity=".3";this.w9a.vkh(Object(n.a)(this,this.dismiss,"dismiss"))}BHc(){this.la.KEb?this.pr.setAttribute("Src",this.fe.Yj("BLUEBOLT_Reactivated.gif")):this.pr.style.opacity="initial";this.w9a.disabled=!1}show(){this.la.KEb?this.pr.setAttribute("Src",this.fe.Yj("BLUEBOLT_Entrance.gif")):
this.pr.setAttribute("Src",this.fe.Yj("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.la.KEb?(this.pr.setAttribute("Src",this.fe.Yj("BLUEBOLT_Exit.gif")),this.w9a.p2k(()=>{this.JW.ya.style.visibility=Ub.a.hidden})):(this.pr.setAttribute("Src",""),this.JW.ya.style.visibility=Ub.a.hidden)}setup(){this.vh||(this.JW?(this.YZ=new Bc.a,this.YZ.ya.style.visibility=Ub.a.inherit,this.YZ.ya.style.position=Ub.a.absolute,this.pr=pb.a.CB(),this.pr.setAttribute("Unselectable","on"),this.pr.setAttribute(na.a.We,
na.a.wM),this.pr.className="gifFloatie",this.YZ.ya.appendChild(this.pr),this.JW.appendChild(this.YZ),this.Xla()):L.a.J(38072903,829,15,"parentElement is null"),this.Yq=!0)}JYg(t){let N;switch(this.la.replaceObjectIconType){case 7:N="BLUEBOLT_Hover_on.gif";break;case 8:N="BLUEBOLT_HoverWhite_On.gif";break;default:N="BLUEBOLT_Hover_on.gif"}this.pr.setAttribute("Src",this.fe.Yj(N));return this.Vca(t)}onBlur(){let t;switch(this.la.replaceObjectIconType){case 7:t="BLUEBOLT_Hover_off.gif";break;case 8:t=
"BLUEBOLT_HoverWhite_Off.gif";break;default:t="BLUEBOLT_Hover_off.gif"}this.pr.setAttribute("Src",this.fe.Yj(t));return!0}Xla(){this.FN&&this.gd.ob(ka.a.click,this.pr,this.FN);this.Vca&&(this.Vo.ob(ka.a.pointerOver,this.pr,Object(n.a)(this,this.JYg,"onHover")),this.Vo.ob(ka.a.pointerOut,this.pr,Object(n.a)(this,this.onBlur,"onBlur")))}aSe(){this.FN&&this.gd.xb(ka.a.click,this.pr,this.FN);this.Vca&&(this.Vo.xb(ka.a.pointerOver,this.pr,Object(n.a)(this,this.JYg,"onHover")),this.Vo.xb(ka.a.pointerOut,
this.pr,Object(n.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.aSe();this.Yq=!1}}Object(h.a)(ic,"GifFlyoutAnchor",null,[849,814]);class vc{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff){this.pr=this.Yu=null;this.JW=t;this.ZS=N;this.J1j=ha;this.O1j=Aa;this.BHg=ze.replaceObjectIconType;this.tCg=ze.replaceObjectAnimId;this.uCg=ze.KEb;this.IFa=yb;this.R$b=Ra;this.gd=Sb;this.Vo=uc;this.FN=Zc;this.Vca=ed;this.ve=Gd;this.P8j=re;this.w9a=ff;this.Yq=!1}get BXb(){return 1===this.P8j?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:
this.w9a.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get vh(){return this.Yq}setup(){this.vh||(this.Yu=new Bc.a,this.pr=this.R$b.Ezi(),this.Yu.ya.style.visibility=Ub.a.inherit,this.$ga(),this.Yq=!0)}xGc(){this.w9a.vkh(Object(n.a)(this,this.dismiss,"dismiss"));this.Qpa();this.sjc();this.Yu.Nsi()||this.Yu.ot("replaceObjectGrayedFlyoutAnchor")}show(){this.vh?this.sjc(this.uCg):L.a.J(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}BHc(){this.w9a.disabled=
!1;this.Qpa();this.sjc();this.Yu.keb("replaceObjectGrayedFlyoutAnchor")}sjc(t=!1){this.vh?this.pr.cIa(this.I3i(t),""):L.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}I3i(t){const N=this.IFa.IOd(this.ZS,this.ZS,this.J1j,this.O1j,this.BXb,null);this.ve.addCssClass(this.Yu.ya,"replaceObjectFlyoutAnchorBase");this.ve.addCssClass(this.Yu.ya,"replaceObjectFlyoutAnchor"+this.BHg);t&&(this.ve.addCssClass(this.Yu.ya,"replaceObjectFlyoutAnchorAnimBase"),this.ve.addCssClass(this.Yu.ya,
"replaceObjectFlyoutAnchorAnim"+this.tCg));return N}Qpa(){this.vh?(this.pr.clear(),this.ve.removeCssClass(this.Yu.ya,"replaceObjectFlyoutAnchorBase"),this.ve.removeCssClass(this.Yu.ya,"replaceObjectFlyoutAnchor"+this.BHg),this.uCg&&(this.ve.removeCssClass(this.Yu.ya,"replaceObjectFlyoutAnchorAnimBase"),this.ve.removeCssClass(this.Yu.ya,"replaceObjectFlyoutAnchorAnim"+this.tCg))):L.a.J(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.vh&&(this.aSe(),this.Yu&&
this.Yu.ya.parentNode&&this.Yu.iq(),this.dismiss(),this.pr.dispose(),this.Yu=null,this.Yq=!1)}dismiss(){this.vh?(this.Qpa(),this.JW.ya.style.visibility=Ub.a.hidden):L.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}$ga(){this.JW?(this.Yu.ya.style.width=this.ve.Lc(this.ZS),this.Yu.ya.style.height=this.ve.Lc(this.ZS),this.Yu.ya.setAttribute(na.a.We,na.a.Xt),this.JW.appendChild(this.Yu),this.pr.$ga(this.Yu.ya),this.Xla()):L.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}Jcb(){return!0}Xla(){this.FN&&
this.gd.ob(ka.a.click,this.Yu.ya,this.FN);this.gd.ob(ka.a.doubleClick,this.Yu.ya,Object(n.a)(this,this.Jcb,"onDoubleClick"));this.Vca&&(this.Vo.ob(ka.a.pointerOver,this.Yu.ya,this.Vca),this.Vo.ob(ka.a.pointerOver,this.Yu.ya.firstChild,this.Vca),this.Vo.ob(ka.a.pointerOver,this.Yu.ya.firstChild.firstChild,this.Vca))}aSe(){this.FN&&this.gd.xb(ka.a.click,this.Yu.ya,this.FN);this.gd.xb(ka.a.doubleClick,this.Yu.ya,Object(n.a)(this,this.Jcb,"onDoubleClick"));this.Vca&&(this.Vo.xb(ka.a.pointerOver,this.Yu.ya,
this.Vca),this.Vo.xb(ka.a.pointerOver,this.Yu.ya.firstChild,this.Vca),this.Vo.xb(ka.a.pointerOver,this.Yu.ya.firstChild.firstChild,this.Vca))}}Object(h.a)(vc,"ReplaceObjectFlyoutAnchor",null,[849,814]);class cd{constructor(t,N){this.az=null;this.Wh=t;this.ve=N;this.Yq=!1}get vh(){return this.Yq}get YM(){return this.az}setup(){this.vh||(this.az=new Bc.a,this.$ga(),this.Yq=!0)}$ga(){this.Wh?(this.Wh.appendChild(this.YM.ya),this.ve.addCssClass(this.YM.ya,"replaceObjectPreviewContainer"),this.YM.setVisibility(!1)):
L.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}cIa(t){if(this.vh){if(t=this.aqa(t))this.dma(),this.YM.ya.appendChild(t),this.YM.setVisibility(!0)}else L.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}yh(t,N){this.vh?this.YM.yh(t,N):L.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.vh&&(this.dismiss(),this.YM&&this.YM.ya.parentNode&&(this.YM.iq(),this.ve.removeCssClass(this.YM.ya,
"replaceObjectPreviewContainer")),this.az=null)}dismiss(){this.vh?(this.dma(),this.YM.setVisibility(!1)):L.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}aqa(t){if(!gb.a.Va(t)){const N=pb.a.CB();N.setAttribute("Unselectable","on");N.src=t;N.style.height="100%";N.style.width="100%";return N}return null}dma(){this.YM.ya.firstChild&&this.YM.ya.removeChild(this.YM.ya.firstChild)}}Object(h.a)(cd,"ReplaceObjectPreviewImageView",null,[814]);var vd=d(674);class Yd{constructor(t,
N,ha,Aa,Ra,yb,Sb){this.gd=t;this.Vo=N;this.ve=ha;this.IFa=Aa;this.la=Ra;this.fe=yb;this.uGg=Sb}Xwi(t,N,ha,Aa,Ra){t=Jm.wxl(this.la.replaceObjectIconType,Ra)?new ic(t,this.gd,this.Vo,ha,Aa,this.la,this.fe,this.ve,this.uGg):new vc(t,N,"per","PowerPointDesigner_32x32x32",this,this.IFa,this.gd,this.Vo,ha,Aa,this.ve,this.la,Ra,this.uGg);t.setup();return t}Fzi(t){t=new cd(t,this.ve);t.setup();return t}Ezi(){return new vd.a(this.ve)}}Object(h.a)(Yd,"ReplaceObjectViewFactory",null,[]);class af{constructor(t,
N,ha){this.ve=t;this.ta=ha;this.jPg=N}iNc(t){if(!t)throw Error.argumentNull("shape");var N=t.KT;t=this.npb(N.TopLeft);N=this.npb(N.TopRight);return Ua.a.Rl(t,N)}hNc(t){if(!t)throw Error.argumentNull("shape");var N=t.KT;t=this.npb(N.TopRight);N=this.npb(N.BottomRight);return Ua.a.Rl(t,N)}m0b(t){return this.iNc(t)*this.Bfg()}l0b(t){return this.hNc(t)*this.Bfg()}Baj(t){if(!t)throw Error.argumentNull("shape");var N=t.KT;t=this.npb(N.TopLeft);N=this.npb(N.TopRight);return Mb.a.cO(Ua.a.bG(t,N))}$5f(){return this.getBounds(this.jPg.Jc.rC)}getBounds(t){return this.ve.Yh(t)}Bfg(){const t=
this.jPg.Jc;return t?t.BV:1}npb(t){return new Ua.a(t.X,t.Y)}I8a(t){return t?!!this.ta.Ba&&this.ta.Ba.Bb.equals(t.slideId):!1}}Object(h.a)(af,"ReplaceObjectViewHelper",null,[]);var lg=d(428);class Nh{constructor(t,N,ha){this.p_=this.MZ=null;this.LS=t;this.g7j=N;this.P1c=ha}get IF(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get Jnb(){this.MZ||
(this.MZ=Object.assign(new In.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:lg.a.YJe,outputSchema:lg.a.YJe,func:Object(n.a)(this,this.a9a,"lambdaBeforeFunc")}));return this.MZ}get $mb(){return null}get sEb(){this.p_||(this.p_=Object.assign(new In.a,{name:"LambdaRemote_ReplaceObjectWacAL",inputSchema:lg.a.YJe,outputSchema:"ShapeTextConvertable",func:Object(n.a)(this,this.Wae,"lambdaRemoteFunc")}));return this.p_}a9a(t,N,ha){if(t&&this.g7j.p8d())if(t){try{var Aa=qe.a(t.ContextId)}catch(Ra){L.a.J(37041409,
375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.IF);ha(null);return}this.P1c.SPj(Aa.t)?this.P1c.HXi(Aa.shapeId)?ha(t):(L.a.J(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.IF),ha(null)):(L.a.J(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.IF),ha(null))}else ha(null),L.a.J(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.IF);else L.a.J(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.IF),ha(null)}Wae(t,N,ha){t?
t?this.LS.execute(Aa=>{Aa.gic(t.Topic,t.Data,t.ContextId,Ra=>{this.FHa(Ra)},Ra=>{this.DHa(Ra)},ha)}):ha(null):ha(null)}FHa(t){if(!v.AFrameworkApplication.Xg&&t&&t.data){var N=t.data.state;if(N){try{var ha=qe.a(t.data.Zd)}catch(Aa){N(null);L.a.J(36804442,375,10,"Try parse aug response failed:{0}",Aa.message);return}N(ha)}}}DHa(t){!v.AFrameworkApplication.Xg&&t&&t.data&&(t=t.data.state)&&t(null)}}Object(h.a)(Nh,"ReplaceObjectWacALWorkflow",null,[824]);class hg{constructor(){this.ate=null}Knc(t){return this.validate(t)?
this.ate?this.ate.Knc(t):!0:!1}s3k(t){this.ate=t}}Object(h.a)(hg,"ReplaceObjectWall",null,[]);class fh extends hg{constructor(){super();this.Kt=null}edg(t){const N=this.Kt.m0b(t);t=this.Kt.l0b(t);var ha=N*t;const Aa=this.Kt.$5f().width,Ra=this.Kt.$5f().height;ha=ha/(Aa*Ra)*100;L.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",N,t,Aa,Ra,ha);return ha}}Object(h.a)(fh,"AreaRatioWall",hg,[]);class Tf extends fh{constructor(t,
N){super();this.I4j=t;this.Kt=N}validate(t){return this.edg(t)<=this.I4j}}Object(h.a)(Tf,"MaxAreaRatio",fh,[]);class Nj extends hg{constructor(t,N){super();this.F4j=t;this.Kt=N}validate(t){return this.Kt.l0b(t)<=this.F4j}}Object(h.a)(Nj,"MaxShapeHeight",hg,[]);class tk extends hg{constructor(t,N){super();this.K4j=t;this.Kt=N}validate(t){return this.Kt.m0b(t)<=this.K4j}}Object(h.a)(tk,"MaxShapeWidth",hg,[]);class Ek extends fh{constructor(t,N){super();this.V4j=t;this.Kt=N}validate(t){return this.edg(t)>=
this.V4j}}Object(h.a)(Ek,"MinAreaRatio",fh,[]);var Vj=d(36);class Km extends hg{constructor(t,N){super();this.U4j=t;this.Ea=N}validate(t){return this.U8i(t,this.Ea)>=this.U4j}U8i(t,N){if(!t)return 0;let ha=0;N.WI(t,Aa=>{Aa.Sa(Vj.a.Zp)&&(Aa=Aa.getValue(Vj.a.Zp))&&0<Aa.length&&ha++});return ha}}Object(h.a)(Km,"MinParagraphCount",hg,[]);class Oo extends hg{constructor(t,N){super();this.S4j=t;this.Kt=N}validate(t){return this.Kt.l0b(t)>=this.S4j}}Object(h.a)(Oo,"MinShapeHeight",hg,[]);class kp extends hg{constructor(t,
N){super();this.Y4j=t;this.Kt=N}validate(t){return this.Kt.m0b(t)>=this.Y4j}}Object(h.a)(kp,"MinShapeWidth",hg,[]);class Uh{constructor(t,N,ha){this.tda=null;this.la=t;this.Ea=N;this.OAb=ha;this.init(this.la.replaceObjectClientWalls)}validate(t){return this.tda?this.tda.Knc(t):!0}init(t){t=this.FBi(t);this.afi(t)}FBi(t){const N={};if(gb.a.Va(t))return N;t=t.split(";");for(const ha of t)gb.a.Va(ha)||(t=ha.split(":"),2===t.length?N[t[0]]=t[1]:L.a.J(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",
ha));return N}afi(t){const N=[];"MinParagraphCount"in t&&Array.add(N,new Km(Ta.d(t,"MinParagraphCount",0),this.Ea));"MinShapeHeight"in t&&Array.add(N,new Oo(Ta.b(t,"MinShapeHeight",0),this.OAb));"MaxShapeHeight"in t&&Array.add(N,new Nj(Ta.b(t,"MaxShapeHeight",Number.MAX_VALUE),this.OAb));"MinShapeWidth"in t&&Array.add(N,new kp(Ta.b(t,"MinShapeWidth",0),this.OAb));"MaxShapeWidth"in t&&Array.add(N,new tk(Ta.b(t,"MaxShapeWidth",Number.MAX_VALUE),this.OAb));"MinShapeAreaRatio"in t&&Array.add(N,new Ek(Ta.b(t,
"MinShapeAreaRatio",0),this.OAb));"MaxShapeAreaRatio"in t&&Array.add(N,new Tf(Ta.b(t,"MaxShapeAreaRatio",Number.MAX_VALUE),this.OAb));for(t=0;t<N.length-1;t++)N[t].s3k(N[t+1]);0<N.length&&(this.tda=N[0])}}Object(h.a)(Uh,"ReplaceObjectWalls",null,[782]);class Po{constructor(){this.K=null;this.AW=this.mke=this.Uke=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}Wb(t){this.K=t;(this.AW=this.K.resolve("PowerPointWebEditor.IApplicationContext").kd.vg)&&this.K.register(Ql.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>
new Ql.a(v.AFrameworkApplication.He,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));t.register(Fc,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").ma().na(()=>
new Fc);t.register(af,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").ma().na(()=>new af(t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.IActiveSlideViewManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));t.register(781,"PowerPointWebEditor.IReplaceObjectGalleryView").ma().na(()=>new vb(t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("Common.IPointerInputManager"),t.resolve("Common.IClickInputManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.IInputHandlerManager"),t.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("Common.IBrowserUtils")));t.register(782,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").ma().na(()=>
new Uh(t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IShapeReader"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));t.register(zb,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").ma().na(()=>new zb(t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.IApplicationSettings")));
t.register(783,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").ma().na(()=>new rf(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.IApplicationSettings").keepCalculateZoomInNativeConsistentWithClientFixIsEnabled));t.register(784,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").ma().na(()=>t.resolve("Common.IAppSettingsManager").ka("473")?new bf((N,ha,Aa,
Ra,yb,Sb)=>{const uc=new hc(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.La("PowerPointWebEditor.IDesignerServiceProvider"));uc.ZNa(N,ha,Aa,Ra,yb,Sb);return uc}):new Fh(new hc(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.La("PowerPointWebEditor.IDesignerServiceProvider"))));t.register(785,"PowerPointWebEditor.IReplaceObjectManager").ma().na(()=>t.resolve("Common.IAppSettingsManager").ka("473")?new ho(t.La("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),
t.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),
t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),
t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("Common.ITaskManager"),t.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),t.La("PowerPointWebEditor.IDesignerServiceProvider")):new Xc(t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),
t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("Common.ITaskManager"),t.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),t.La("PowerPointWebEditor.IDesignerServiceProvider")));t.register(pe,
"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").ma().na(()=>new pe(t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),t.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("Box4.IPageView").Ma,t.resolve("PowerPointWebEditor.IShapeReader")));t.register(Jm,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").ma().na(()=>new Jm(t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("Common.ITaskManager")));t.register(Yd,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").ma().na(()=>
new Yd(t.resolve("Common.IClickInputManager"),t.resolve("Common.IPointerInputManager"),t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPoint.IPathManager"),t.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));t.register(336,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").ma().na(()=>new Xd.a((N,
ha)=>{let Aa=null;const Ra=Object(M.a)(124,N.oc(t.resolve("Box4.IPageView").Ma));Ra&&!Ra.ll&&Ra.PT&&(Aa=new Hb(N,Ra,ha,t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),
t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IReplaceObjectGalleryView")),Aa.setup());return Aa}));t.register(336,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").ma().na(()=>new Xd.a((N,ha)=>{let Aa=null;const Ra=Object(M.a)(124,N.oc(t.resolve("Box4.IPageView").Ma));Ra&&!Ra.ll&&Ra.PT&&(Aa=new Mh(N,Ra,ha,t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),
Aa.setup());return Aa}));t.register(Nh,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>new Nh(this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));t.register(Db,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").ma().na(()=>
new Db(this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));t.register(Ia,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").ma().na(()=>new Ia(t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("Common.Transaction.ITransactionFactory"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.View.IPPTPageView"),t.resolve("PowerPointWebEditor.IShapeReader")));
t.register(yo,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").ma().na(()=>new yo(t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.IShapeReader"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),
t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.AW&&
this.K.resolve("PowerPointWebEditor.PodsInfoSender");const t=this.K.resolve("Common.IAppSettingsManager");t.ff(()=>{const N=new Date;t.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?L.a.J(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):L.a.J(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");if(this.Uke=t.ka("463"))t.ka("499")&&this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.mke=t.ka("676"))this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();
L.a.J(512262750,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+N)})}dispose(){this.Uke&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());this.mke&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){e.a.instance.Ac(mc.a(new Po,0))}}Object(h.a)(Po,"PPTWebEditorReplaceObjectPackage",null,[2,3]);var Jn=d(268),zn=d(384),Ep=d(1035);class lp{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=
null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(h.a)(lp,"AppSettings",null,[]);class mp{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=
null}}Object(h.a)(mp,"ControllerFactoryParameters",null,[]);var Ul=d(712),cn=d(323);class Zh{}Zh.none="None";Zh.vhFailedToLoadVersionList="VHFailedToLoadVersionList";Zh.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";Zh.vhFailedToParseVersionList="VHFailedToParseVersionList";Zh.vhFetchFailed="VHFetchFailed";Zh.vhVersioningNotEnabled="VHVersioningNotEnabled";Zh.vhFileNotFound="VHFileNotFound";Zh.vhVersionTooOld="VHVersionTooOld";Zh.qzl="VHFailedToRenderThumbnails";Zh.pzl="VHFailedToRenderSlide";
Zh.ozl="VHFailedToRenderNotes";Zh.mzl="VHFailedToRenderDiff";Zh.rzl="VHFailedToShowAnimaitonIcon";Zh.szl="VHFailedToShowHiddenEffect";Zh.nzl="VHFailedToRenderInitPresInfo";Object(h.a)(Zh,"ErrorName",null,[]);class dm{constructor(){this.KFa=new Id.a;this.KFa.add(0,Zh.none);this.KFa.add(100,Zh.vhFailedToLoadVersionList);this.KFa.add(101,Zh.vhFailedToGetDownloadToken);this.KFa.add(102,Zh.vhFailedToParseVersionList);this.KFa.add(103,Zh.vhFetchFailed);this.KFa.add(104,Zh.vhVersioningNotEnabled);this.KFa.add(105,
Zh.vhFileNotFound);this.KFa.add(106,Zh.vhVersionTooOld);this.dGa=new Id.a;this.dGa.add(0,Zh.none);this.dGa.add(100,Zh.qzl);this.dGa.add(101,Zh.pzl);this.dGa.add(102,Zh.ozl);this.dGa.add(103,Zh.mzl);this.dGa.add(104,Zh.rzl);this.dGa.add(105,Zh.szl);this.dGa.add(106,Zh.nzl)}get c8k(){return this.KFa}get Kzl(){return this.dGa}static udg(){dm.cGe||(dm.cGe=new dm);return dm.cGe}}dm.wJf="ErrorCode";dm.cGe=null;Object(h.a)(dm,"VersionHistoryTelmetryHelper",null,[]);class Fl{constructor(t,N,ha,Aa,Ra,yb,Sb,
uc,Zc,ed,Gd,ze,re,ff,ah,aj,Df){this.obc=this.ED=this.IGg=this.f1c=this.Fwb=this.c3=this.Eqe=this.SW=this.CG=null;this.Xsa=-1;this.lxb=null;if(!Df)throw Error.argumentNull("clientRequestManager");this.ia=t;this.cC=N;this.vi=ha;this.Ga=Aa;this.yc=Ra;this.iVa={};this.Fa=yb;this.fh=Sb;this.aAb={};this.hc=Zc;this.d4c={};this.l6j=uc;this.Yca=ed;this.Xa=Gd;this.$ee=[];ze&&(this.IGg=ze,this.IGg.execute(Fi=>{this.ED=Fi}));this.NS=re;this.ah=ff;this.Tde=ah;this.s3c=aj;this.Uv=Df}ub(){this.ia.xa(G.a.iMe,E.a.frame,
Object(n.a)(this,this.rdl,"showVersionHistoryDialogAction"));this.Ga.pptEnablePreviousVersionsOptionForOneDriveConsumer||this.ia.xa(tb.a.t5g,E.a.frame,Object(n.a)(this,this.$ye,"pptoShowFileVersion"));this.ia.xa(tb.a.fzl,E.a.frame,Object(n.a)(this,this.Ppj,"handleVersionHistoryCopySlides"))}rdl(t,N,ha){if(1===ha)return t=!1,this.Xa.aca&&(t=!0),t?2:32;2===ha&&(v.AFrameworkApplication.mN("Microsoft.Office.Server.Powerpoint.Web.IDocsPptPPTVersionHistorySaveACopyOverFlowMenuSettings"),v.AFrameworkApplication.mN("Microsoft.Office.Server.Powerpoint.Web.IDocsPptVersionHistoryDeleteVersions"),
this.obc=Lc.a.create().toString(),m.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.obc),Eb.c(tb.a.Gqk,!0),this.iVa.VersionHistoryLaunchSessionId=this.obc,this.aAb.VersionHistoryLaunchSessionId=this.obc,this.iVa.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.f1c=[],this.CG||(this.CG=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new mp,{ulsLogger:new zn.a,serviceBase:this.Ga.getSetting("VersionHistoryWebServiceBase"),
latestStreamServiceBase:this.Ga.ka("PPTVHPodsBootEnabled")?this.Ga.getSetting("PODSLatestServiceBase")+"&PodSID="+this.Ga.getSetting("PodSID"):"",docId:v.AFrameworkApplication.Zg,appSettings:Object.assign(new lp,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Ga.getSetting("PodVHRetryCount"),wdEnableSaveACopy:this.hc.ln,wdEnableRestore:this.hc.ln,userSessionId:v.AFrameworkApplication.userSessionId,wacCluster:this.Ga.Ha("WacCluster"),uiLocale:this.Ga.ZGa?this.Ga.ZGa:"en-us",isRtl:v.AFrameworkApplication.isRtl,
disabledChangeGates:this.Ga.Ha("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Ga.ka("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),wdEnableDeleteVersions:this.Ga.ka("PPTVersionHistoryDeleteVersionsIsEnabled")}),perfTelemetryInfos:this.f1c}))),this.CG&&this.CG.setDisableSaveACopy(v.AFrameworkApplication.XI),this.sdl());return 32}$ye(t,N,ha){return 1===ha&&this.Xa.aca?2:this.ia.processAction(G.a.lLe,ha)}Ppj(t,N,ha){if(1===ha)return this.Roh()?2:32;this.SW.onCopySlides();return 32}sdl(){var t;
if(!document.getElementById("VersionHistoryOverlay")){this.gLk();this.cLk();this.dLk();this.YKk();this.WKk();this.bLk();this.aLk();this.ZKk();const N=document.createElement("div");N.id="VersionHistoryOverlay";N.style.width="100%";N.style.zIndex="998";N.style.display="block";N.style.position="absolute";N.style.top="0px";if(this.Ga.ka("RegionComposerIsEnabled")){const ha=(null===(t=document.getElementById("HeaderRegion"))||void 0===t?void 0:t.offsetHeight)||0;N.style.top=ha+"px";N.style.bottom="0px";
N.style.height=`calc(100vh - ${ha}px)`}else N.style.height="calc(100% + "+va.AFrame.Whd+"px)";document.getElementById("WACInnerFrame").appendChild(N);this.Eqe=this.CG.createVersionHistoryDialog(N);this.Qfb()}document.getElementById("VersionHistoryOverlay").style.display="block";this.CG.getTipVersion&&this.Ga.ka("PPTVHPodsBootEnabled")&&this.CG.getTipVersion();this.CG.getVersions("");this.UYh()}UYh(){try{this.lxb=this.l6j.u0i();for(let t=0;t<this.lxb.length;t++)this.fh.qo(this.lxb[t]);this.fh.TJ(hd.a.Lnc)}catch(t){m.ULS.sendTraceTag(512508633,
822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",t)}}PCi(){try{if(this.lxb)for(let t=0;t<this.lxb.length;t++)this.fh.TJ(this.lxb[t]);else m.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.fh.qo(hd.a.Lnc)}catch(t){m.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",t)}}gLk(){this.CG.getFullAppErrorEvent().addListener(t=>{try{const N=dm.udg().c8k.ga(t);this.aAb[dm.wJf]=
N;m.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",N,this.obc)}catch(N){m.ULS.sendTraceTag(512508629,822,10,"Exception in FullAppErrorEvent call back: {0}.",N)}})}cLk(){this.CG.getVersionsReadyEvent().addListener(t=>{this.pfh(t.containerDiv);this.a2h(t.versions);this.Fa.oX("VersionHistoryOverlay",!0);try{this.c3&&this.c3.DownloadUrl.length&&this.SW&&(this.vEh(),this.Qlg(),this.SW.onVersionSelected(this.c3,this.Fwb,this.iVa),this.tNf())}catch(N){m.ULS.sendTraceTag(512508628,
822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",N)}})}a2h(t){const N=this.SW.getAppDataStore();for(const ha of t)N.AddVersionInfoToStore(ha)}dLk(){this.CG.getVersionSelectedEvent().addListener(t=>{this.c3=t.currentVersion;this.Fwb=t.baseVersion;if(this.SW&&this.c3.DownloadUrl.length)try{this.vEh(),this.Qlg(),this.SW.onVersionSelected(t.currentVersion,t.baseVersion,this.iVa),this.vMk(),this.tNf()}catch(N){m.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",
N)}})}vMk(){const t=this.R0b(2);t&&(bd.a.addHandler(t,ka.a.eg,Object(n.a)(this,this.Az,"keyDownHandler")),Te.a.instance.ob(t,Object(n.a)(this,this.zB,"contextMenuHandler")))}ssl(){const t=this.R0b(2);t&&(bd.a.removeHandler(t,ka.a.eg,Object(n.a)(this,this.Az,"keyDownHandler")),Te.a.instance.xb(t,Object(n.a)(this,this.zB,"contextMenuHandler")))}Az(t){try{if(t.shiftKey&&t.keyCode===qa.a.tna||t.keyCode===qa.a.BJa){const N=Ep.a.create(ka.a.contextMenu,t,1);this.zB(N)}}catch(N){m.ULS.sendTraceTag(512508626,
822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",N)}}zB(t){if(1===t.Vf){const N=this.R0b(2);N&&(t.clientPoint.x=dd.a.yKc(N)+hb.a.Zpa,t.clientPoint.y=dd.a.zKc(N)+hb.a.Zpa)}return 32===this.ia.Ka(tb.a.kQf,2,t)}YKk(){this.CG.getDownloadTokenReadyEvent().addListener(t=>{try{if(m.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.Fwb)if(t&&t.updatedVersions&&2<=t.updatedVersions.length){let N=null,ha=null;const Aa=Fl.b0b(this.c3),Ra=
Fl.b0b(this.Fwb);for(const yb of t.updatedVersions){const Sb=Fl.b0b(yb);Aa===Sb?N=yb:Ra===Sb&&(ha=yb);if(N&&ha)break}N&&ha?(this.c3=N,this.Fwb=ha,this.SW.diff(this.c3,this.Fwb)):m.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Aa,Ra)}else m.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
else m.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(N){m.ULS.sendTraceTag(512508621,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",N)}})}bLk(){this.CG.getSaveACopySelectedEvent().addListener(t=>{m.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",t);this.Ga.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&Fl.agk();let N=
v.AFrameworkApplication.uvb;this.Ga.ka("VHSaveACopyForOdcOnSpoEnabled")&&(N=32===this.ia.processAction(tb.a.v$c,1));t=N?this.ia.Ka(tb.a.v$c,2,{["FileDownloadUrl"]:t}):this.ia.Ka(G.a.Ueb,2,{["FileDownloadUrl"]:t});32!==t?(Eb.c(tb.a.NNf,!1),m.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",t)):Eb.c(tb.a.NNf,!0)})}wxh(t,N){try{(new Promise((ha,Aa)=>{this.CG.setRestoreInProgress();this.Yca.lDc(this.Xa.tk,this.Xa.podSessionId,this.Xa.presentationId.string,this.Ga.getSetting("361"),
this.Xa.I9,!1,!0,()=>{ha(!0)},Ra=>{Aa("ClosePopWacSessionSync:: "+Ra.error.message)})})).then(()=>{(new Promise((ha,Aa)=>{this.Yca.mdd(this.Xa.presentationId.string,t,()=>{ha(!0)},Ra=>{Aa("RestoreFileVersion:: "+Ra.error.message)})})).then(()=>{const ha=Date.now()-N;m.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",ha);this.aAb.RestoreSucceededTime=ha;this.ia.Ka(tb.a.refresh,2,{["IsSourceVH"]:!0});Eb.c(tb.a.eDc,!0)}).catch(ha=>
{const Aa=Date.now()-N;this.CG.setRestoreFailedAtServer(()=>{this.ia.Ka(tb.a.refresh,2,{["IsSourceVH"]:!0})});m.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",ha,Aa);this.aAb.RestoreFailedTime=Aa;Eb.c(tb.a.eDc,!1)})})}catch(ha){m.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",ha.message),Eb.c(tb.a.eDc,!1)}}aLk(){this.CG.getRestoreVersionSelectedEvent().addListener(t=>{m.ULS.sendTraceTag(512508615,
832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",t);const N=Date.now();this.ED?(this.$ee=this.ED.SZb(),0<this.$ee.length?(m.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",this.$ee.length),Eb.c(tb.a.eDc,!1),this.CG.setCoauthRestoreError(),this.Ga.ka("PPTVersionHistoryRestoreSurveyEnabled")&&Fl.VRj()):this.wxh(t,N)):(m.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),this.wxh(t,
N))})}ZKk(){this.CG.getDownloadVersionSelectedEvent().addListener(t=>{m.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");t=new Lh.QueryStringBuilder(t);t.Hi(mk.a.T2g,v.AFrameworkApplication.fileName);t=this.ia.Ka(G.a.downloadACopy,2,{["FileDownloadUrl"]:t.toString()});32!==t?(Eb.c(tb.a.MNf,!1),m.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",t)):Eb.c(tb.a.MNf,!0)})}vEh(){for(const t of this.f1c){const N=t.TelemetryEventKey?
t.TelemetryEventKey:t.telemetryEventKey?t.telemetryEventKey:"",ha=t.TelemetryEventData?t.TelemetryEventData:t.telemetryEventData?t.telemetryEventData:"";gb.a.Va(N)||gb.a.Va(ha)||(this.iVa[N]=ha)}}tNf(){this.f1c=[];this.iVa={}}WKk(){this.CG.getCloseSelectedEvent().addListener(()=>{this.Ga.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&Fl.URj();this.fOf()})}fOf(){this.PCi();this.Fa.s4("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display="none";this.Ga.nHf&&(this.c3=
null);m.ULS.sendTraceTag(512508610,822,50,qe.c(this.aAb))}pfh(t){try{if(this.SW)Dl.setIsPageLoadForFirstTime(!1),this.SW.switchParentViewContainer(t);else{Dl.setIsPageLoadForFirstTime(!0);const N=new PowerPointVersionHistory.AppBootSettings;N.RenderServiceBase="";N.IsRtl=v.AFrameworkApplication.isRtl;const ha=new PowerPointVersionHistory.AppCallbackBag;ha.animationDecoratorCallback=Object(n.a)(this.cC,this.cC.pOd,"createAnimationOrTransitionStar");ha.notesIconDecoratorCallback=Object(n.a)(this,this.Fyi,
"createNotesIcon");ha.addToF6LoopCallback=Object(n.a)(this,this.K1h,"addToF6Loop");ha.copySlideCallback=Object(n.a)(this,this.copySlideCallback,"copySlideCallback");ha.reportViewerErrorCallback=Aa=>{this.aAb[dm.wJf]=dm.udg().Kzl.ga(Aa);106!==Aa&&103!==Aa||this.CG.setViewerError(!0);m.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",Aa);0!==Aa&&(v.AFrameworkApplication.Xo(ee.a.Mh(406)),mf.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};
N.IsHighContrast=!1;this.vi&&(N.IsHighContrast=this.vi.isInHighContrastMode);N.IsHighContrast&&(N.ClientColorSettings=this.vi.highContrastColors.foregroundTextColor+"_"+this.vi.highContrastColors.backgroundColor+"_"+this.vi.highContrastColors.linkColor);if(this.yc){const Aa=this.yc.mQa();N.DefaultSlideWidth=Aa.width;N.DefaultSlideHeight=Aa.height}N.UserSessionId=v.AFrameworkApplication.userSessionId;N.VersionViewerCssUrl=this.Ga.versionHistoryViewerCssUrl;N.ProgressImageResourceUrl=Vg.a.cK(hb.a.Sla);
N.ThumbnailShareOptimizationEnabled=this.Ga.pptvhThumbnailShareOptimizationEnabled;N.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Ga.ka("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Ga.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Ga.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Ga.getSetting("PPTVHSlidePrefetchChunkSize"),SlidePrefetchDelay:this.Ga.getSetting("PPTVHSlidePrefetchDelay")});
N.FileExtension=void 0!==this.Ga.YGa&&null!==this.Ga.YGa?gb.a.uV(this.Ga.YGa).toLowerCase():"";N.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;N.NotesButtonLabel=ResourceStrings.L_Notes;N.SynchronizerTimeout=this.Ga.getSetting("PptVersionHistorySynchronizerTimeout");N.IsRtl=v.AFrameworkApplication.isRtl;N.IsCopySlidesEnabled=!0;N.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;N.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;N.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;
N.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;N.Lcid=v.AFrameworkApplication.lcid;N.EnableOverflowXOnSlideAndNotePane=this.Ga.ka("PodVHEnableOverflowXOnSlideAndNotePane");N.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;N.IsModernCatchUpUxEnable=this.Ga.ka("1166");N.IsRevisionTrackingFlyoutEnabled=gd.a("EnableRevisionTrackingFlyoutForVH");N.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.SW=new PowerPointVersionHistory.AppVersionController(N,t,ha)}}catch(N){this.CG.setViewerError(!0),
m.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",N)}}Fyi(){return Ga.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}Qfb(){const t=this.Fa.Bc("VersionHistoryOverlay");t.parent=va.AFrame.gj;t.IK=!0;t.gFe=!0;t.xaa(N=>{N&&"dialog/modal"===N.name?this.CG.setSaveACopyCanceled():N&&N.name===va.AFrame.dO||(this.Xsa=-1,this.tyh(!0))});this.fh.p1("VersionHistoryOverlay");this.fh.wjc(hd.a.Lnc,
N=>{this.tyh(N)});this.fh.gGb(hd.a.Lnc,()=>{2===this.Xsa&&Sys.UI.DomElement.addCssClass(this.R0b(2),"PPTVHViewerElementSelected");3===this.Xsa&&Sys.UI.DomElement.addCssClass(this.R0b(3),"PPTVHViewerElementSelected")})}tyh(t){try{const N=this.QNc();(this.Xsa=this.S7i(t))?1===this.Xsa?this.Eqe.then(ha=>{ha.enterHeaderFocusTrapZone();return null}):N&&ec.FocusManager.Dr(document.getElementById(N[this.Xsa])):this.Eqe.then(ha=>{ha.enterFocusTrapZone();return null})}catch(N){m.ULS.sendTraceTag(512508579,
822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",N)}}S7i(t){const N=this.QNc();let ha=this.Xsa;do if(t?N&&(ha=(ha+1)%N.length):N&&(ha=0<ha?ha-1:N.length-1),!ha||1===ha||N&&"none"!==document.getElementById(N[ha]).style.display)return ha;while(ha!==this.Xsa);return 0}Qlg(){const t=Fl.b0b(this.c3);this.d4c[t]||(this.d4c[t]=["VersionListPane","vhHeader"],this.Xsa=-1)}QNc(){if(!this.c3)return this.Ga.nHf?["VersionListPane","vhHeader"]:null;const t=Fl.b0b(this.c3);return this.d4c[t]?
this.d4c[t]:null}R0b(t){const N=this.QNc();return N&&N.length>t?document.getElementById(N[t]):null}K1h(t){try{const N=this.QNc();N&&N.push(t)}catch(N){m.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",N)}return!0}copySlideCallback(t){if(this.Roh())return!1;const N=Lc.a.create().toString();m.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",N);const ha=this.NS.zOd(1,t.SlideIds.length),Aa={};Aa.WacSessionId=v.AFrameworkApplication.userSessionId;
Aa.CallerCorrelationId=N;var Ra={};Ra.Source=t.Source;Ra.SlideIds=t.SlideIds;Ra.CcpId=ha.Fp;Ra.PackageAccessKey=ha.Qy;t=JSON.stringify(Ra);Ra=String.format("{0}{1}",this.Ga.podsWebServiceBase,"vhcopyslide.ashx");const yb=Date.now();try{if(this.Uv.vj(Ra,2,t,Aa,!1,0,Sb=>{Fl.lzl(Sb,yb,N)},Sb=>{Fl.kzl(Sb,yb,N)},null,null),this.ah.contentWindow&&this.ah.contentWindow.document&&this.ah.contentWindow.document.body){pb.a.VCc(this.ah);const Sb=pb.a.Saa();Sb.innerText=pb.a.NUg;Sb.setAttribute(cn.a.Fp,ha.Fp);
Sb.setAttribute(cn.a.jE,ha.jE);Sb.setAttribute(cn.a.count,ha.objectCount.toString());const uc=Ul.a(ha.dataType);Sb.setAttribute(cn.a.type,uc);Sb.setAttribute(cn.a.location,ha.location);Sb.setAttribute(cn.a.Qy,ha.Qy);this.ah.contentWindow.document.body.appendChild(Sb);this.Tde.$eb(this.ah);this.s3c.copy(this.ah)}else m.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Sb){m.ULS.sendTraceTag(512508575,832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",
Sb)}return!0}Roh(){return v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)?(v.AFrameworkApplication.bO||v.AFrameworkApplication.XI)&&!v.AFrameworkApplication.SOa:!1}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.fOf();this.ssl()}static b0b(t){return t.RevisionID?t.RevisionID:t.revisionID?t.revisionID:""}static lzl(t,N,ha){const Aa=Date.now();try{JSON.parse(t.data.Zd).IsCopied?
m.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",Aa-N,ha):m.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",Aa-N,ha)}catch(Ra){m.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Ra,ha)}}static kzl(t,N,ha){const Aa=Date.now();m.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",
Aa-N,t.data?t.data.af:-1,ha)}static URj(){const t=u.a.instance.pb("Common.ISystemInitiatedFeedback");t?(t.logActivity("VersionHistoryExited",null),t.logActivity("VersionHistoryCheckExited",null)):m.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static agk(){const t=u.a.instance.pb("Common.ISystemInitiatedFeedback");t?t.logActivity("VersionHistoryExited",null):m.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}static VRj(){const t=u.a.instance.pb("Common.ISystemInitiatedFeedback");
t?t.logActivity("VersionHistoryRestoreCoauthFailed",null):m.ULS.sendTraceTag(512508568,822,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}}Object(h.a)(Fl,"VersionHistoryPaneActor",null,[832,106]);class hi{constructor(){this.Xuc=this.Da=null}get name(){return"PowerPointWebEditor.VersionHistory"}Wb(t){this.Da=t}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){v.AFrameworkApplication.kUc()?this.Da.resolve("PowerPointWebEditor.IApplicationSettings").LSc?
m.ULS.sendTraceTag(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):(m.ULS.sendTraceTag(39711108,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),ib.a.get_instance().Xj(7,()=>{Gm.a(this.Da)("versionHistory").catch(t=>m.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",t)).then(()=>this.Hpk()).catch(t=>
m.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",t))})):m.ULS.sendTraceTag(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}Hpk(){this.lWb();return null}lWb(){this.Da.register(Fl,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").na(()=>new Fl(v.AFrameworkApplication.Ta,this.Da.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Da.resolve("Common.Utils.IHighContrastDetector"),
this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Da.resolve("PowerPointWebEditor.IPresentationReader"),ec.FocusManager.instance(),Jn.a.instance,this.Da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Da.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.Da.resolve("PowerPointWebEditor.IPopWebService"),this.Da.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Da.La("PowerpointPresence.IPresenceManager"),this.Da.resolve("PowerPointWebEditor.IClipServiceManager"),this.Da.resolve("PowerPointWebEditor.IDesignModeManager").aAa,
this.Da.resolve("PowerPoint.IBrowserHelperManager"),this.Da.resolve("PowerPointWebEditor.ISystemClipboard"),v.AFrameworkApplication.He)).ma();this.Xuc=this.Da.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");this.Xuc.ub()}dispose(){this.Xuc&&this.Xuc.dispose()}}Object(h.a)(hi,"PPTWebEditorVersionHistoryPackageManager",null,[2,3]);var cg=d(447),Fp=d(213),Fk=d(695),bq;(function(t){t[t.anyone=0]="anyone";t[t.organization=1]="organization"})(bq||(bq={}));Object(h.b)("AccessControlEnum",
bq);var np=d(370);class Ur{constructor(){this.token=this.timeStamp=null}}Object(h.a)(Ur,"CachedAccessToken",null,[]);class lr{constructor(t){this.Wde={};this.h0j=t}hhi(t,N){if(!gb.a.Va(t)&&!gb.a.Va(N)){const ha=new Ur;ha.token=N;ha.timeStamp=new Date;this.Wde[t]=ha}}Y6f(t){return t in this.Wde&&(t=Object(M.a)(Ur,this.Wde[t]),+new Date-+t.timeStamp<6E4*this.h0j)?t.token:null}}Object(h.a)(lr,"AccessTokenCache",null,[]);class Kn{constructor(){this.reject=this.resolve=this.frame=this.Xda=this.ITe=this.resource=
this.appId=this.authority=this.id=null;this.fhb=0;this.FEe=null;this.Mec=0;this.Byh=!1}}Object(h.a)(Kn,"DirectAuthRequest",null,[]);class Vr{constructor(t){this.q$b={};this.la=t;this.EAb=new lr(this.la.wxk);window.addEventListener("message",Object(n.a)(this,this.PSk,"requestCompletionMessageHandler"),!1)}b$f(t){const N={},ha=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Aa;for(;Aa=ha.exec(t);)N[Object(M.a)(String,Aa[1])]=Object(M.a)(String,Aa[2]);return N}PSk(t){if("data"in t){var N;({Hv:N}=qe.d(t.data)).returnValue&&
N&&"DirectAuthRequestID"in N&&this.Usb(N)}}Usb(t){try{const Aa=t.DirectAuthRequestID;if(Aa in this.q$b){var N=null,ha=Object(M.a)(Kn,this.q$b[Aa]);if(ha&&ha.id===Aa){L.a.J(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",Aa,"Timeouted"in t,"FromPolling"in t);window.clearTimeout(ha.fhb);delete this.q$b[Aa];window.clearTimeout(ha.Mec);const Ra=new np.a;Ra.IsSuccess=!1;Ra.ErrorCode="";Ra.ErrorMessage="";Ra.Token="";"Timeouted"in t?(L.a.J(592238722,
833,10,"DirectAuth: Request timed out with host: "+window.location.host),Ra.ErrorCode="Timeout",Ra.ErrorMessage="No response received in time for the authentcation request",ha.resolve(Ra)):"PopupWindowClosed"in t&&ha.Xda?(Ra.ErrorCode="User_aborted",Ra.ErrorMessage="User aborted log in by closing the popup window",ha.resolve(Ra)):(ha.frame?N=this.b$f(ha.frame.contentWindow.location.hash):ha.Xda&&!ha.Xda.closed&&(N=this.b$f(ha.Xda.location.hash)),"access_token"in N?(Ra.IsSuccess=!0,Ra.Token=Object(M.a)(String,
N.access_token),this.EAb&&this.EAb.hhi(ha.FEe,Ra.Token),ha.resolve(Ra)):(Ra.ErrorCode="error"in N?Object(M.a)(String,N.error):"unknown",0<=Array.indexOf(this.la.yxk,Ra.ErrorCode)&&ha.Byh&&ha.frame&&!ha.Xda?this.Swk(ha.authority,ha.appId,ha.resource,ha.ITe,this.la.zxk).then(yb=>{ha.resolve(yb)}).catch(yb=>{ha.reject(yb)}):(Ra.ErrorMessage="error_description"in N?Object(M.a)(String,N.error_description):"unknown",ha.resolve(Ra))));ha.frame?document.body.removeChild(ha.frame):ha.Xda&&!ha.Xda.closed&&
ha.Xda.close()}else L.a.J(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",Aa)}else L.a.J(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(t))}catch(Aa){L.a.J(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+Aa.message)}}WDc(t){const N=window.location.protocol,ha=window.location.host;L.a.J(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",
N,ha,"ffc-powerpoint.officeapps.live.com"===ha||"ppc-powerpoint.officeapps.live.com"===ha);if(void 0===t||null===t){t=window.location.pathname;const Aa=t.lastIndexOf("/");t=0<=Aa?t.substring(0,Aa+1):""}return N+"//"+ha+t+"WacDirectAuth.html"}Ipl(t,N,ha,Aa,Ra,yb=!1){return this.Bdl(t,N,ha,Aa,Ra,yb)}Swk(t,N,ha,Aa,Ra){if(gb.a.Va(t))throw Error.argumentNull("authority");if(gb.a.Va(N))throw Error.argumentNull("appId");if(gb.a.Va(ha))throw Error.argumentNull("resource");if(gb.a.Va(Aa))throw Error.argumentNull("userUPN");
const yb=!gb.a.Va(Aa)&&Aa.indexOf("@")<Aa.indexOf("."),Sb=this.WDc("/p/"),uc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",t,N,encodeURIComponent(ha),encodeURIComponent(Sb));if(this.EAb){const Gd=this.EAb.Y6f(uc);if(!gb.a.Va(Gd))return L.a.J(593782154,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(ze=>{const re=new np.a;re.IsSuccess=!0;re.ErrorCode="";re.ErrorMessage="";re.Token=
Gd;ze(re)})}const Zc=Lc.a.create().toString(),ed=String.format("{0}&state={1}",uc,Zc);return new Promise((Gd,ze)=>{const re=new Kn;re.authority=t;re.appId=N;re.resource=ha;re.ITe=Aa;re.resolve=Gd;re.reject=ze;re.id=Zc;re.FEe=uc;re.Xda=window.open("",Zc,"width=400, height=600");re.Xda?(this.q$b[Zc]=re,re.Xda.location.replace(ed),L.a.J(593782152,833,50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",Zc,yb),this.tsh(re,1E3*Ra).then(()=>{const ff={};ff.DirectAuthRequestID=
Zc;ff.FromPolling=!0;this.Usb(ff)}).catch(ff=>{"WindowClosed"===Object(M.a)(String,ff)&&(ff={},ff.DirectAuthRequestID=Zc,ff.PopupWindowClosed=!0,L.a.J(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+Zc),this.Usb(ff))}),re.fhb=window.setTimeout(()=>{const ff={};ff.DirectAuthRequestID=Zc;ff.Timeouted=!0;L.a.J(593782148,833,10,"DirectAuth: Popup request timedout with ID of: "+Zc);this.Usb(ff)},1E3*Ra)):(L.a.J(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",
Zc),ze=new np.a,ze.IsSuccess=!1,ze.ErrorCode="fail_to_open_popup",ze.ErrorMessage="Failed to create popup window!",ze.Token="",Gd(ze))})}Bdl(t,N,ha,Aa,Ra,yb){if(gb.a.Va(t))throw Error.argumentNull("authority");if(gb.a.Va(N))throw Error.argumentNull("appId");if(gb.a.Va(ha))throw Error.argumentNull("resource");if(gb.a.Va(Aa))throw Error.argumentNull("userUPN");const Sb=!gb.a.Va(Aa)&&Aa.indexOf("@")<Aa.indexOf(".");var uc=this.WDc("/p/");const Zc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",
t,N,encodeURIComponent(ha),encodeURIComponent(uc));if(this.EAb){const ze=this.EAb.Y6f(Zc);if(!gb.a.Va(ze))return L.a.J(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(re=>{const ff=new np.a;ff.IsSuccess=!0;ff.ErrorCode="";ff.ErrorMessage="";ff.Token=ze;re(ff)})}const ed=Lc.a.create().toString();uc=Sb?String.format("{0}&login_hint={1}&state={2}",Zc,encodeURIComponent(Aa),ed):String.format("{0}&state={1}",Zc,ed);const Gd=document.createElement("iframe");Gd.style.display=
"none";Gd.src=uc;return new Promise((ze,re)=>{const ff=new Kn;ff.authority=t;ff.appId=N;ff.resource=ha;ff.ITe=Aa;ff.frame=Gd;ff.resolve=ze;ff.reject=re;ff.id=ed;ff.FEe=Zc;ff.Byh=yb;document.body.appendChild(Gd);L.a.J(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",ed,Sb);this.tsh(ff,1E3*Ra).then(()=>{const ah={};ah.DirectAuthRequestID=ed;ah.FromPolling=!0;this.Usb(ah)});ff.fhb=window.setTimeout(()=>{const ah={};ah.DirectAuthRequestID=ed;ah.Timeouted=
!0;L.a.J(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+ed);this.Usb(ah)},1E3*Ra);this.q$b[ed]=ff})}tsh(t,N){return new Promise((ha,Aa)=>{const Ra=N/50;let yb=0;t.Mec=window.setInterval(()=>{try{yb++>Ra&&(window.clearInterval(t.Mec),L.a.J(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",N,Ra),Aa(""));const Sb=t.frame?t.frame.contentWindow:t.Xda;if(!Sb||Sb.closed)window.clearInterval(t.Mec),L.a.J(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),
Aa("WindowClosed");let uc=null,Zc=null;try{uc=Sb.location.href,Zc=Sb.location.hash}catch(ed){}uc&&"about:blank"!==uc?gb.a.Va(Zc)||(window.clearInterval(t.Mec),ha(Zc)):L.a.J(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===uc)}catch(Sb){L.a.J(594068384,833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Sb.message)}},50)})}}Object(h.a)(Vr,"DirectAuthHelper",null,[]);class fl{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=
this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(h.a)(fl,"ILiveActorSettings",null,[]);class Qo{constructor(){this.react=
null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(h.a)(Qo,"ILiveReaction",null,[]);class mr{constructor(){this.isPaused=this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(h.a)(mr,"ILiveSessionState",null,[]);class Wr{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(h.a)(Wr,"ILiveSessionURL",null,[]);class Ro{constructor(){this.zMg=this.yMg=null}}Object(h.a)(Ro,"PollObjectInfo",null,[]);
var cq;(function(t){t[t.none=0]="none";t[t.singleLineRibbon=1]="singleLineRibbon";t[t.multipleLineRibbon=2]="multipleLineRibbon";t[t.slideShowToolbar=3]="slideShowToolbar";t[t.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";t[t.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(cq||(cq={}));Object(h.b)("LiveEntryPoint",cq);var dq;(function(t){t[t.none=0]="none";t[t.callout=1]="callout";t[t.businessBar=2]="businessBar";t[t.pausedSessionTimeout=3]="pausedSessionTimeout";t[t.slideshowContextMenu=
4]="slideshowContextMenu";t[t.accessControlChange=5]="accessControlChange";t[t.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(dq||(dq={}));Object(h.b)("LiveExitPoint",dq);var Lm=d(660);class Jq{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff){this.va=new qm.a;this.sEa=this.yxb=this.rYc=this.Qhe=this.JFg=!1;this.Z7b=this.Che=this.uYc=!0;this.I$b=this.mAb=!1;this.rp=this.lj=this.tca=this.Hn=null;this.USa=0;this.Iyb=-1;this.Jzb=30;this.C9b=-1;this.zd=this.Bka=this.OZ=null;this.wOg=this.fRg=this.F2c=
this.B2c=0;this.y6b=this.Dsa=this.OSa=null;this.Gle=this.W9a=0;this.qgb=null;this.fqe=new Set;this.eqe=new Map;this.F_c=null;this.N9b=1;this.B9b=this.GEg=this.JN=this.uVa=this.Qqe=this.xfe=null;this.fe=Aa;this.la=t;this.SFg=!1;this.eb=ha;this.yc=yb;this.Vp=Sb;this.Mc=uc;this.Gy=Zc;this.Xa=ed;this.Dc=Gd;this.vl=ze;this.wUa=re;this.Fa=ff;if(this.Ls=N)this.tca=N.kG();this.dL=Ra;this.USa=this.s1f?1:0;this.la.powerPointLiveBroadcastEnabled&&(this.xfe=new Vr(this.la));this.Mc.uB(Object(n.a)(this,this.E9,
"onPodSessionRehydrated"));this.Gy.yGd(Object(n.a)(this,this.mCb,"onPodSessionUnavailable"));this.gPa()&&this.vl.execute(ah=>{ah.show(ResourceStrings.L_LivePresentations_Disconnected,Lm.a.MBb);ah.hide()});L.a.J(512496260,833,50,"LivePresenter: Host auth type is: "+this.la.hostAuthType)}get ar(){return this.la.powerPointLiveBroadcastEnabled&&this.uYc}get k5a(){return this.Qhe}set k5a(t){(this.Qhe=t)&&this.va.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get Lq(){return!!this.rp}get oba(){return this.SFg}set oba(t){this.SFg=
t}get eBa(){return this.JFg}set eBa(t){this.JFg=t}get jPa(){return!!this.rp&&this.rp.isPaused}get GOi(){return this.rYc}get fBa(){return this.Z7b}set fBa(t){this.Z7b=t}get rOi(){return this.k5a&&this.ar&&!!this.Hn}get accessControl(){return this.USa}set accessControl(t){this.USa=t}get s1f(){return"true"===this.ncg("wdDisablePrivateSession")?!1:"aad"===this.la.hostAuthType}get n1f(){return this.ar&&this.Lq&&this.lj?this.lj.isWelcomeScreenVisible():!1}Qqb(){return this.la.isMicButtonInSlideShowToolbarEnabled&&
this.la.B$c&&this.Dc.NYb?this.Dc.Sqb?this.I$b=!0:this.Dc.F1f||this.I$b:!0}q8c(t,N,ha,Aa,Ra,yb,Sb,uc,Zc){if(this.ar){this.eb.qGd(Object(n.a)(this,this.k0g,"onSlideShowEnterEndOfShow"));this.eb.sGd(Object(n.a)(this,this.l0g,"onSlideShowLeaveEndOfShow"));this.eb.Fzc(Object(n.a)(this,this.Vua,"onGetCurrentSlideDimensionsHandler"));this.yxb=!1;this.sEa=!0;try{this.la.o$c&&this.yWi();const ed=this.MZd(Ra,Aa);if(this.Hn)(this.eBa||this.jPa)&&this.Hn.FetchDocumentDownloadURL(ed);else{L.a.J(512496259,833,
50,"Creating Broadcast monitor ...");const Gd=new PowerPointLive.PPTBroadcastMonitorSettings;Gd.isBlueChicken=this.la.isBlueChicken;Gd.fileDownloadUrl=ed;Gd.rendezvousSvcBaseUri=this.la.podLiveBroadcastRendezvousServiceBaseUri;Gd.broadcastSubtitlesFromSpeechFrontDoor=!0;Gd.pragueInitTimeoutInMS=this.la.Bxk;Gd.preferredSubtitleLanguage=this.Dc.PNc();Gd.useStateService=this.la.Kxk;Gd.numMaxAttempts=this.la.Exk;Gd.delayInSecsToCloseBroadcasterOnPause=this.la.vxk;Gd.batchedRequestsEnabled=this.la.sxk;
Gd.sharedSessionSettings={};Gd.websocketAliveTimeAfterLoseFocusInMs=this.la.Lxk;Gd.pingTimeoutInMs=this.la.Cxk;Gd.pongTimeoutInMs=this.la.Dxk;Gd.enableTransientSessionHandling=this.la.gyk;Gd.maxStateServiceRoundtripRaw=v.AFrameworkApplication.fa.Ec("PPTLiveMaxStateServiceRoundtripRaw",300);Gd.sharedSessionSettings.MaxStateServiceRoundtripRaw=Gd.maxStateServiceRoundtripRaw;Gd.documentSnapshotRequestUrlGenerator=this.la.dyk?()=>this.MZd(this.Xa.podSessionId,this.Xa.Wj):null;this.la.o5g&&(Gd.sharedSessionSettings.IsAutomation=
!0);this.Hn=new PowerPointLive.PPTBroadcastMonitor(Gd);this.Hn.RegisterParticipantsCountChangeEventListener(ze=>{this.zd.telemetryData.maxParticipantCount=Math.max(this.zd.telemetryData.maxParticipantCount,ze);this.lj&&this.lj.setParticipantCount(ze);this.va.raiseEvent("ParticipantsCountChanged",Sys.EventArgs.Empty)});this.Hn.RegisterNewReactionEventListener(Object(n.a)(this,this.Fek,"newReactionHandler"));this.Hn.RegisterConnectionStateEventListener(Object(n.a)(this,this.osi,"connectionStateHandler"))}this.Hn.SetCurrentPosition(t,
N-1,null);this.W9a=t;this.eBa&&!this.rp&&Zc?(this.Zkc(v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.gb.Mp?1:2,Sb,ha,Ra,uc),this.Hoi(t),this.Dsa=new Set):this.OZ&&this.ltb();this.Dsa&&this.Dsa.add(t)}catch(ed){L.a.J(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",ed.toString())}}}Hol(){window.setTimeout(()=>{const t=this.W9a===this.Gle;this.ar&&this.Lq&&t&&this.rp&&!this.rp.isPaused&&(L.a.J(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),
this.Rkd(0),this.MIb(0))},6E4*this.la.Gxk)}Aok(){this.ar&&(this.eb.NDe(Object(n.a)(this,this.k0g,"onSlideShowEnterEndOfShow")),this.eb.PDe(Object(n.a)(this,this.l0g,"onSlideShowLeaveEndOfShow")),this.eb.zcd(Object(n.a)(this,this.Vua,"onGetCurrentSlideDimensionsHandler")),this.sEa=this.yxb=!1,this.Lq&&this.lj&&(this.lj.hideAll(),this.G$d()||(this.uuk(),this.bcl()),this.gPa()&&this.vl.instance.hide()))}Cgl(t,N,ha,Aa,Ra,yb){try{const Sb=new PowerPointLive.RendezvousSessionConfig;Sb.userSessionId=t;Sb.webServiceBase=
N;Sb.podSessionId=ha;Sb.docId=Aa;Sb.sessionId=Ra;Sb.accessControl=1===this.USa?"organization":"anyone";Sb.authTokenFunc=yb;Sb.locale=v.AFrameworkApplication.uiCulture;Sb.presentationName=gb.a.lG(v.AFrameworkApplication.fileName);Sb.slideHeight=this.yc.Jv().height;Sb.slideWidth=this.yc.Jv().width;Sb.correlationId=this.zd.telemetryData.correlationId;Sb.showQRCodeAfterFetchingDocDownloadUrl=this.la.nyk;Sb.presenterTenantId=!this.la.isBlueChicken&&this.la.B5g?v.AFrameworkApplication.fa.Ha("TenantId"):
null;Sb.fileSource=v.AFrameworkApplication.fa.Ha("FileHost");this.la.Ixk||(Sb.fileName=v.AFrameworkApplication.fileName,Sb.bootstrapperUrl=this.la.pptEditorSlideShowWrsEndpoint);const uc=this.Hn.StartLiveBroadcasting(Sb,this.zd,!this.la.Xye);this.Exj();if(uc){this.rp=new mr;this.rp.isPrivate=1===this.USa;this.rp.isPaused=!1;this.rp.participantsCount=0;this.rp.sessionCurrentState=0;const Zc=uc.then(ed=>{const Gd=new Wr;Gd.participantUrl=ed.sessionInfo.shortParticipantUrl;Gd.sessionQRCode=ed.sessionInfo.sessionQRCode;
this.rp.sessionCurrentState=1;return Gd});this.rp.sessionURLPromise=Zc;this.la.C$c?this.B9b.then(()=>{this.lj.actOnSessionRequested(this.rp)}):this.lj.actOnSessionRequested(this.rp);this.eb.Izc(Object(n.a)(this,this.m0g,"onSlideShowReady"));this.eb.NCf(Object(n.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.eb.tGd(Object(n.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));uc.then(ed=>{this.zd.telemetryData.pragueDocId=ed.sessionInfo.pragueDocId;this.zd.telemetryData.sessionCreationWebServiceCallTimeInMS=
this.qK()-this.F2c;this.zd.telemetryData.startAttemptCount=ed.numAttempt;L.a.J(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.zd.telemetryData.sessionId,this.zd.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());this.la.Xye?(this.qjc(),this.Hn.InitializeStateService().then(()=>{this.cnh(ed);this.JZ("StartLiveBroadcasting")}).catch(Gd=>{this.zd.telemetryData.sessionEndedBeforePragueInitialized||this.zd.telemetryData.sessionId!==Ra||
(L.a.J(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",this.zd.telemetryData.sessionId,Gd?Gd.toString():""),this.zd.telemetryData.SetErrorCode(2,Gd?Gd.toString():""),this.JZ("StartLiveBroadcasting"),this.thd())})):this.cnh(ed);this.la.fyk&&$addHandler(window,"visibilitychange",Object(n.a)(this,this.smk,"onPageVisibilityChangedHandler"));this.JZ("StartLiveBroadcasting")}).catch(ed=>{L.a.J(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",
this.zd.telemetryData.sessionId,ed.toString());this.zd.telemetryData.SetErrorCode(4,ed.toString());this.JZ("StartLiveBroadcasting");this.thd()})}else this.thd(),this.zd.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),L.a.J(512496225,833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Sb){this.thd(),this.zd.telemetryData.SetErrorCode(4,Sb.toString()),L.a.J(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.zd.telemetryData.sessionId,
Sb.toString())}finally{this.JZ("StartLiveBroadcasting")}}cnh(t){const N=this.Dc.HZi(this.Dc.Qma);N?this.Hn.SetDefaultSubtitlesLanguage(N):L.a.J(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",this.zd.telemetryData.sessionId);this.eb.xIb(!0,this.Hn.GetPragueSessionInfoJSONString());this.eb.PMa(Object(n.a)(this,this.Ddc,"onSlideShowPositionChanged"));this.eb.MCf(Object(n.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.la.Xye&&!this.lj.isWelcomeScreenVisible()||
this.qjc();this.va.raiseEvent("OnLiveSessionStarted",t.sessionInfo);this.Qqb()||!this.Dc.NYb||this.Dc.F1f||this.I$b||!this.gPa()||(this.mAb=!0,this.vl.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",jk.a.le(v.AFrameworkApplication.uiCulture).displayName),Lm.a.MBb));this.y6b=this.Hn.CreateSurvey(t.authToken,null,null,null);this.y6b.then(ha=>{if(ha){const Aa={};Aa.surveyeeName=v.AFrameworkApplication.userName;Aa.surveyId=ha.surveyId;Aa.surveyResponseUrl=ha.surveyResponseUrl;
this.Hn.SetAudienceFeedbackInfo(JSON.stringify(Aa))}});this.la.o$c&&(this.eqe.clear(),this.fqe.forEach(ha=>{try{const Aa=ha.yMg;this.Hn.CreateSurvey(t.authToken,null,Aa,ha.zMg).then(Ra=>{Ra?this.eqe.set(Aa,Ra.surveyId):L.a.J(512496222,833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.zd.telemetryData.sessionId)}).catch(Ra=>{L.a.J(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.zd.telemetryData.sessionId,
Ra.toString());this.zd.telemetryData.SetErrorCode(13,t.toString())})}catch(Aa){L.a.J(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.zd.telemetryData.sessionId,Aa.toString())}}));this.wUa.init()?this.wUa.kGd(Object(n.a)(this,this.kdc,"onNetworkConnectivityChanged")):L.a.J(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.zd.telemetryData.sessionId)}ncg(t){t=new RegExp(String.format("[\\?&]{0}=([^&#]*)",t));return(t=
window.location.search.match(t))&&2===t.length?t[1]:""}Zkc(t,N,ha,Aa,Ra){this.Qqe=N;this.uVa=ha;this.JN=Aa;this.GEg=Ra;this.F2c=this.qK();this.B2c=this.qK();var yb=this.ncg("wdSetLiveSessionId");yb="rdvSession_"+(yb.length?yb:Lc.a.create().toString());this.zd=new PowerPointLive.LiveSessionTelemetry;this.zd.telemetryData.sessionId=yb;this.zd.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.zd.telemetryData.accessControl=bq[this.USa];this.zd.telemetryData.sessionEntryPoint=
cq[t];this.zd.telemetryData.isSubtitleStartedByLive=this.oba;this.zd.telemetryData.isAutomation=this.la.o5g;this.zd.telemetryData.correlationId=Lc.a.create().toString();this.JZ("StartLiveBroadcasting");try{this.ar&&this.Hn&&this.wYb()&&!this.rp?(this.PTj(),this.eb.PSb(Object(n.a)(this,this.BYg,"onGetCurrentSlideShowPosition")),this.eb.getCurrentPosition(),this.jUd()&&this.lj&&this.B9b&&this.B9b.then(()=>{this.lj.showOnboardingScreen();this.iUe=!0}),this.Cgl(N,ha,Aa,Ra,yb,()=>this.WZb("StartLiveBroadcasting",
this.zd.telemetryData.sessionId))):(this.zd.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),L.a.J(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),this.zd.telemetryData.isMordernSlideShow=!!this.eb&&this.eb instanceof Fk.SlideShowCoreFrame}catch(Sb){this.zd.telemetryData.SetErrorCode(4,Sb.toString()),L.a.J(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",
this.zd.telemetryData.sessionId,Sb.toString())}finally{this.JZ("StartLiveBroadcasting")}}uuk(){if(this.ar&&this.Lq&&this.Hn&&this.wYb()&&!this.rp.isPaused){this.Rkd(2);this.MIb(2);try{this.zd.telemetryData.sessionPauseCount+=1,this.zd.telemetryData.sessionActiveDurationInMS+=this.qK()-this.B2c,L.a.J(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.zd.telemetryData.sessionId),this.lj.actOnSessionPaused(),this.rp.isPaused=!0,this.wOg=this.qK(),this.Hn.PauseLiveBroadcasting(()=>
this.WZb("PauseLiveBroadcasting",this.zd.telemetryData.sessionId)),this.va.raiseEvent("OnLiveSessionPaused",Sys.EventArgs.Empty),this.Jgl(),this.eb.xIb(!1)}catch(t){this.zd.telemetryData.SetErrorCode(5,t.toString()),L.a.J(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",this.zd.telemetryData.sessionId,t.toString())}finally{this.JZ("PauseLiveBroadcasting")}}}Xfh(){if(this.ar&&this.Lq&&this.Hn&&this.wYb()&&this.rp.isPaused)try{this.B2c=this.qK(),this.zd.telemetryData.sessionResumeCount+=
1,L.a.J(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",this.zd.telemetryData.sessionId),this.Cfh(),this.lj.actOnSessionResumed(),this.Hn.ResumeLiveBroadcasting(()=>this.WZb("ResumeLiveBroadcasting",this.zd.telemetryData.sessionId)),this.rp.isPaused=!1,this.va.raiseEvent("OnLiveSessionResumed",Sys.EventArgs.Empty),this.pNe(),this.eb.xIb(!0,this.Hn.GetPragueSessionInfoJSONString())}catch(t){this.zd.telemetryData.SetErrorCode(6,t.toString()),L.a.J(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",
this.zd.telemetryData.sessionId,t.toString())}finally{this.JZ("ResumeLiveBroadcasting")}}pYb(t){if(this.ar&&this.Lq&&this.Hn&&this.wYb()){this.MIb(3);try{this.pol(t,()=>{this.zd.telemetryData.sessionExitPoint=dq[t];this.rp.isPaused||(this.zd.telemetryData.sessionActiveDurationInMS+=this.qK()-this.B2c);this.OZ&&this.ltb();this.pNe();this.gPa()&&this.vl.instance.hide();L.a.J(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.zd.telemetryData.sessionId);this.lj.actOnSessionEnded();
this.eb.Bcd(Object(n.a)(this,this.m0g,"onSlideShowReady"));this.eb.peb(Object(n.a)(this,this.Ddc,"onSlideShowPositionChanged"));this.eb.fdh(Object(n.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.eb.gdh(Object(n.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.wUa.Kch(Object(n.a)(this,this.kdc,"onNetworkConnectivityChanged"));this.eb.QDe(Object(n.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));this.sEa&&this.eb.xIb(!1);this.y6b=this.rp=null;this.va.raiseEvent("OnLiveSessionEnded",
Sys.EventArgs.Empty);this.la.B$c&&this.Dc.NYb&&(this.I$b=this.mAb=!1);if(3!==t){const N=this.Hn.EndLiveBroadcasting(()=>this.WZb("EndLiveBroadcasting",this.zd.telemetryData.sessionId));N?N.then(()=>{this.JZ("EndLiveBroadcasting");L.a.J(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",this.zd.telemetryData.sessionId)}).catch(ha=>{this.zd.telemetryData.SetErrorCode(7,ha.toString());this.JZ("EndLiveBroadcasting");L.a.J(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",
this.zd.telemetryData.sessionId,ha.toString())}):(this.zd.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),L.a.J(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.Hn.CleanUpBroadcastBeforeEnd(),L.a.J(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.JZ("EndLiveBroadcasting")})}catch(N){this.zd.telemetryData.SetErrorCode(7),L.a.J(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",
this.zd.telemetryData.sessionId,N.toString())}finally{3!==t&&this.qhb(),this.JZ("EndLiveBroadcasting")}}}glh(){this.ar&&this.Hn&&this.Hn.SetPresenterState("muted")}hlh(){this.ar&&this.Hn&&this.Hn.SetPresenterState("unmuted")}showCallout(t){this.ar&&this.lj&&(this.rYc=!0,this.lj.showCallout(t))}showWelcomeScreen(){this.ar&&this.lj&&(this.lj.showWelcomeScreen(),this.yIe())}showEndSessionDialog(t,N){this.ar&&this.Lq&&this.lj&&this.lj.showEndSessionDialogWithCallbacks(t,N)}thd(){this.lj.isWelcomeScreenVisible()||
this.rp.isPaused||this.showWelcomeScreen();this.rp=null;this.lj.onSessionRequestError()}wYb(){if(this.ar&&!this.lj&&this.tca){const t=new fl;t.hostElement=this.tca;t.baseZIndex=50005;t.welcomeScreenBackgroundImageUrl=this.fe.Yj("LiveWelcomeScreenBackground.png");t.welcomeScreenErrorImageUrl=this.fe.Yj("LiveWelcomeScreenError.png");t.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";t.calloutContainerId="LiveCalloutContainer";t.urlBarLayerHostId="LiveURLBarLayerHost";t.dialogLayerHostId="LiveDialogLayerHost";
t.reactionsBarLayerHostId="LiveReactionBarLayerHost";t.showTryAgainButton=!0;t.isPowerpointLiveReactionEnabled=!gd.a("PPTLive.ReactionToggleInLiveCallout");t.onboardingScreenHostId="LiveOnboardingScreenLayerHost";t.resourceCDNPath=this.la.vdb;t.enablePrefetchLiveResource=this.la.C$c;t.enableNewLiveWelcomeScreen=this.la.C$c;t.userSessionId=this.Qqe;t.podsUrl=this.uVa;this.lj=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(t);this.lj.on("OnWelcomeScreenOpenedAction",()=>{this.ZHa("LiveWelcomeScreenLayerHost");
this.yIe();this.fRg=Date.now();this.zd.telemetryData.welcomeShownCount+=1});this.lj.on("OnWelcomeScreenClosedAction",()=>{this.yxb&&this.lj.hideURLBar();this.oNf();this.eb.restoreFocus();this.zd.telemetryData.welcomeScreenDurations.push(Date.now()-this.fRg);this.zd.telemetryData.welcomeScreenFirstTimeDuration=this.zd.telemetryData.welcomeScreenDurations[0];this.JZ("OnWelcomeScreenClosedAction");this.Hn.SetWelcomeScreenState(!1);this.la.o$c&&this.txh();this.mAb&&this.gPa()&&window.setTimeout(()=>{this.vl.instance.hide();
this.mAb=!1},5E3)});this.lj.on("ResumeSessionAction",()=>{this.Xfh();this.yxb||this.lj.showURLBar()});this.lj.on("EndSessionAction",()=>{this.pYb(this.sEa?1:2);this.eb.restoreFocus()});this.lj.on("OnCalloutOpenedAction",()=>{this.rYc=!0;this.va.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);this.zd.telemetryData.calloutShownCount+=1});this.lj.on("OnCalloutClosedAction",()=>{this.rYc=!1;this.va.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.eb.restoreFocus()});this.lj.on("OnEndSessionDialogOpenedAction",
()=>{this.Y1k()});this.lj.on("OnEndSessionDialogClosedAction",()=>{this.GUk()});this.lj.on("OnCalloutMenuDefinitionChangedAction",()=>{this.va.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.lj.on("OnTryAgainAction",()=>{L.a.J(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",this.zd.telemetryData.sessionId);this.Zkc(5,this.Qqe,this.uVa,this.JN,this.GEg)});this.lj.on("PresenterDisabledReactions",()=>{this.Che=!1});this.lj.on("PresenterEnabledReactions",()=>
{this.Che=!0});this.lj.on("OnOnboardingScreenOpenedAction",()=>{this.ZHa("LiveOnboardingScreenLayerHost");this.yIe()});this.lj.on("OnOnboardingScreenClosedAction",()=>{this.qjc()})}return!!this.lj}qjc(){this.lj&&(this.jUd()&&this.lj.isOnboardingScreenVisible()?this.ZHa("LiveOnboardingScreenLayerHost"):this.lj.isWelcomeScreenVisible()?this.ZHa("LiveWelcomeScreenLayerHost"):(-1!==this.C9b&&this.oNf(),this.eb.restoreFocus()))}fGj(){const t=document.getElementById("LiveWelcomeScreenLayerHost"),N=document.getElementById("LiveOnboardingScreenLayerHost");
let ha=!1;t&&(ha=t.contains(document.activeElement));return document.activeElement===N||document.activeElement===t||ha}yIe(){this.lj&&-1===this.C9b&&(this.C9b=window.setInterval(()=>{this.fGj()||this.qjc()},500))}oNf(){window.clearInterval(this.C9b);this.C9b=-1}ZHa(t){this.tca&&this.lj&&window.setTimeout(()=>{ec.FocusManager.Dr(this.tca.ownerDocument.getElementById(t))},50)}Y1k(){this.sEa?this.ZHa("LiveDialogLayerHost"):(this.Fa.cQc(hd.a.Wye,hd.a.gj,document.getElementById("LiveDialogLayerHost")),
this.Fa.Gj(hd.a.Wye,!0))}GUk(){this.sEa?this.eb.restoreFocus():this.Fa.Gj(hd.a.Wye,!1)}qhg(){this.la.B$c&&this.Dc.NYb&&(this.gPa()&&this.mAb&&(this.vl.instance.hide(),this.mAb=!1),this.I$b=!0)}PTj(){try{this.B9b||!this.jUd()&&!this.la.C$c||(this.B9b=Gm.a(u.a.instance)("liveActorLazy"))}catch(t){L.a.J(512496205,833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.zd.telemetryData.sessionId,t.toString())}}m0g(){this.ar&&this.Hn&&(this.jPa?(window.setTimeout(()=>
{this.va.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.Xfh()):this.rp&&this.lj&&this.lj.isWelcomeScreenVisible()&&this.qjc())}Ddc(t,N){this.ar&&this.Hn&&(this.Hn.SetCurrentPosition(N.slideId,N.slideIndex,N.pmc),this.W9a!==N.slideId&&this.Cfh(),this.W9a=N.slideId,this.Dsa&&(this.OSa&&10>this.N9b&&10*this.Dsa.size>=this.N9b*this.OSa.size&&(this.MIb(4),this.N9b+=1),this.Dsa.add(N.slideId)),this.la.o$c&&this.txh(),t=!!this.OSa&&this.OSa.size>=this.la.Fxk,this.W9a===this.Gle&&t&&
this.Hol())}k0g(){this.yxb=!0;this.ar&&this.Lq&&this.lj&&(this.lj.hideURLBar(),this.Rkd(1),this.MIb(1))}l0g(){this.yxb=!1;this.ar&&this.Lq&&this.lj&&this.lj.showURLBar()}onSubtitleUpdated(t,N){this.ar&&this.Lq&&this.Hn&&(N.isFinal?this.Hn.UpdateFinalSubtitles(N.$wh):this.Hn.UpdatePartialSubtitles(N.$wh))}onTranscriberStarted(t,N){this.zd.telemetryData.transcriberSessionIds+=N.Zwh+",";this.ar&&this.Lq&&this.eb.xIb(!0,this.Hn.GetPragueSessionInfoJSONString())}Jgl(){L.a.J(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",
this.zd.telemetryData.sessionId);-1!==this.Iyb&&window.clearInterval(this.Iyb);this.Jzb=30;this.Iyb=window.setInterval(Object(n.a)(this,this.yuk,"pausedSessionAutoExpireTimerCallBack"),6E4)}pNe(){-1!==this.Iyb&&(L.a.J(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",this.zd.telemetryData.sessionId),window.clearInterval(this.Iyb),this.Iyb=-1)}yuk(){--this.Jzb;0>=this.Jzb?(L.a.J(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.zd.telemetryData.sessionId),this.ltb(),
this.pYb(3)):this.OZ&&(this.OZ.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.Jzb.toString()))}bcl(){if(!this.OZ&&this.Ls&&!v.AFrameworkApplication.Xg&&0!==this.rp.sessionCurrentState){var t=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.Jzb.toString());t=new cg.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,t,null);t.closeable=!0;t.I1=Object(n.a)(this,this.Rhk,"onBusinessBarClosed");t.image=3;t.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,
Object(n.a)(this,this.Thk,"onBusinessBarResumeSessionButtonClicked"),"");t.PFd(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(n.a)(this,this.Shk,"onBusinessBarEndSessionButtonClicked"));this.Ls.businessBar.Rh(t,!1);this.Ls.yq();this.OZ=t}}G$d(){var t=6E4*this.la.kyk;t=0<t?this.qK()-this.F2c>=t:!1;L.a.J(512496201,833,50,"LivePresenter::IsSessionStale {0}",t);return t}ltb(){try{this.Ls&&this.OZ?(this.pNe(),this.Ls.businessBar.removeEntry(this.OZ),this.Ls.yq(),L.a.J(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",
!this.OZ.businessBar),this.OZ=null):L.a.J(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.Ls,!!this.OZ)}catch(t){L.a.J(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",t.toString())}}Rhk(t){t===this.OZ&&(this.OZ=null)}Thk(t){t===this.OZ&&this.lj&&(this.ltb(),this.G$d()||v.AFrameworkApplication.Ta.processAction(tb.a.DYa,2))}Shk(t){t===this.OZ&&this.lj&&(this.G$d()?this.ltb():this.lj.showEndSessionDialog())}smk(){const t=
this.qK(),N=window.document.hidden;L.a.J(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",N?"hidden":"visible",t);N||this.jPa&&18E5<=t-this.wOg&&this.ltb()}dXd(t,N,ha){return!this.la.powerPointLiveBroadcastEnabled||0===this.USa&&this.la.isBlueChicken?new Promise(Aa=>{Aa(null)}):!ha&&!this.dL||ha&&!this.xfe?(L.a.J(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",t,N,ha),new Promise((Aa,Ra)=>
{Ra("AuthHelperNotSet")})):new Promise((Aa,Ra)=>{let yb=this.la.hostAuthType,Sb="";if("aad"===yb||this.la.isBlueChicken)Sb=this.la.pptLiveResourceUri;else if("msa"===yb)Sb=this.la.jyk;else{L.a.J(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",t,N);Ra("HostAuthTypeInvalid");return}const uc="true"===v.AFrameworkApplication.fa.Ha("IsAnonymousUser").toLowerCase();let Zc=v.AFrameworkApplication.fa.Ha(v.AFrameworkApplication.oJ);gb.a.Va(Zc)&&(Zc=
"Unset");const ed=new Date;let Gd=null;Gd=ha?this.xfe.Ipl(this.la.uxk,this.la.txk,Sb,v.AFrameworkApplication.fa.Ha("UserPrincipalName"),this.la.Hxk,this.la.xxk&&"StartLiveBroadcasting"===t&&!this.la.B5g):this.dL.q0(this.la.pptLiveImplicitAuthAppName,Sb);Gd.then(ze=>{this.MAg(N,t,yb,ha,uc,Zc,ze.IsSuccess,+new Date-+ed,ze.ErrorCode,ze.ErrorMessage);ze.IsSuccess?Aa(ze.Token):Ra(ze.ErrorCode)}).catch(ze=>{this.MAg(N,t,yb,ha,uc,Zc,!1,+new Date-+ed,"exception",ze.toString());Ra("exception")})})}WZb(t,N){if(!this.la.powerPointLiveBroadcastEnabled||
0===this.USa&&this.la.isBlueChicken)return new Promise(Aa=>{Aa(null)});if("msa"===this.la.hostAuthType)return this.dXd(t,N,!1);const ha=this;return new Promise((Aa,Ra)=>{ha.dXd(t,N,!0).then(yb=>{Aa(yb)}).catch(()=>{ha.dXd(t,N,!1).then(yb=>{L.a.J(512496194,833,50,"LivePresenter::GetToken - WebAuth retry succeeded.");Aa(yb)}).catch(yb=>{Ra(yb)})})})}qK(){return(new Date).getTime()}MAg(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed){const Gd={};Gd.SessionId=t;Gd.Action=N;Gd.HostAuthType=ha;Gd.UseDirectAuth=Aa;Gd.IsAnonymousUser=
Ra;Gd.UiHost=yb;Gd.IsSuccess=Sb;Gd.Latency=uc;Gd.ErrorCode=Zc;Gd.ErrorMessage=ed;L.a.J(51197915,833,50,JSON.stringify(Gd))}JZ(t){this.zd.telemetryData.action=t;this.zd.telemetryData.sessionDurationInMS=this.qK()-this.F2c;this.zd.telemetryData.hostAuthType=this.la.hostAuthType;this.zd.SetStateServiceMetrics();this.zd.telemetryData.errorCode.length&&(!this.zd.telemetryData.errorMessage.length||0>Array.indexOf(this.la.Axk,this.zd.telemetryData.errorMessage))&&(this.zd.telemetryData.hasUnexpectedError=
!0);t=this.la.podLiveBroadcastRendezvousServiceBaseUri.toLowerCase();-1!==t.indexOf("pptservicescast.officeapps.live.com")?this.zd.telemetryData.rendezvousServiceEnvironment="prod":-1!==t.indexOf("pptservicescast.edog.officeapps.live.com")?this.zd.telemetryData.rendezvousServiceEnvironment="edog":-1!==t.indexOf("pptservicescast.officeapps.live-int.com")?this.zd.telemetryData.rendezvousServiceEnvironment="int":this.zd.telemetryData.rendezvousServiceEnvironment="dev";L.a.J(50706442,833,this.zd.telemetryData.hasUnexpectedError?
15:50,JSON.stringify(this.zd.telemetryData))}Hoi(t){if(this.yc)try{var N=this.Vp.presentation;if(!N)throw Error.argumentNull("Presentation is null");const ha=N.slides||[];this.Gle=ha[ha.length-1].sid;let Aa=N=!1;this.OSa=new Set;for(const Ra of ha)N||Ra.sid!==t||(N=!0,Aa=Ra.En),!N||Ra.En&&!Aa||this.OSa.add(Ra.sid),Aa&&!Ra.En&&(Aa=!1)}catch(ha){this.zd.telemetryData.SetErrorCode(16,ha.toString()),L.a.J(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",
this.zd.telemetryData.sessionId,ha.toString())}}Rkd(t){return new Promise(N=>{if(this.ar&&this.Hn&&this.rp&&this.y6b)try{this.y6b.then(ha=>{let Aa=!1;switch(t){case 2:if(!this.Dsa||!this.OSa||10*this.Dsa.size<8*this.OSa.size){N(!0);return}break;case 3:Aa=!0}const Ra={triggeredSurveyType:"Survey.AudienceFeedback"};Ra.isMandatory=Aa;Ra.triggerEventId=Lc.a.create().toString();Ra.surveyeeName=v.AFrameworkApplication.userName;ha?(Ra.surveyId=ha.surveyId,Ra.surveyResponseUrl=ha.surveyResponseUrl):L.a.J(512496192,
833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.zd.telemetryData.sessionId);this.Hn.TriggerSurvey(JSON.stringify(Ra));L.a.J(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",this.zd.telemetryData.sessionId,t);N(!0)}).catch(ha=>{L.a.J(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.zd.telemetryData.sessionId,ha.toString());this.zd.telemetryData.SetErrorCode(13,
ha.toString());N(!1)})}catch(ha){this.zd.telemetryData.SetErrorCode(17,ha.toString()),L.a.J(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",this.zd.telemetryData.sessionId,ha.toString()),N(!1)}else N(!0)})}BYg(t,N){this.eb&&this.Hn&&N&&(this.eb.oeb(Object(n.a)(this,this.BYg,"onGetCurrentSlideShowPosition")),this.Hn.SetCurrentPosition(N.slideId,N.slideIndex,N.pmc))}Vua(t,N){this.lj&&this.lj.actOnCurrentSlideDimensionChange(N.slideHeight,
N.grh,N.slideWidth,N.jrh)}getCalloutMenuDefinition(){return this.wYb()?this.lj.getCalloutMenuDefinition():null}Exj(){const t=String.format("{0}{1}",this.la.vdb,"reactions/heart/default/240_anim_f/heart.png"),N=String.format("{0}{1}",this.la.vdb,"reactions/yes/default/240_anim_f/yes.png"),ha=String.format("{0}{1}",this.la.vdb,"reactions/clap/default/240_anim_f/clap.png"),Aa=String.format("{0}{1}",this.la.vdb,"reactions/laugh/default/240_anim_f/laugh.png"),Ra=String.format("{0}{1}",this.la.vdb,"reactions/surprised/default/240_anim_f/surprised.png"),
yb=String.format("{0}{1}",this.la.vdb,"reactions/wonder/default/240_anim_f/wonder.png");this.Bka=[Object.assign(new Qo,{react:"yes",reactionCount:0,reactionImagePath:N,numberOfAnimationFrames:40}),Object.assign(new Qo,{react:"heart",reactionCount:0,reactionImagePath:t,numberOfAnimationFrames:16}),Object.assign(new Qo,{react:"clap",reactionCount:0,reactionImagePath:ha,numberOfAnimationFrames:40}),Object.assign(new Qo,{react:"laugh",reactionCount:0,reactionImagePath:Aa,numberOfAnimationFrames:77}),
Object.assign(new Qo,{react:"surprised",reactionCount:0,reactionImagePath:Ra,numberOfAnimationFrames:68}),Object.assign(new Qo,{react:"wonder",reactionCount:0,reactionImagePath:yb,numberOfAnimationFrames:70})];this.qgb=new Map;this.N9b=1;this.F_c=null}Cfh(){if(this.Bka){for(const t of this.Bka)t.reactionCount=0;this.lj&&this.lj.resetReactions()}}Fek(t){if(this.qgb){var N=this.qgb.has(t.slideId)?this.qgb.get(t.slideId)+1:1;this.qgb.set(t.slideId,N)}if(this.Bka&&!this.jPa&&this.Che){for(const ha of this.Bka)if(ha.react===
t.react){ha.reactionCount+=1;break}if(this.lj){t=Array(this.Bka.length);for(N=0;N<this.Bka.length;N++)t[N]=Object.assign(new Qo,{react:this.Bka[N].react,reactionCount:this.Bka[N].reactionCount,reactionImagePath:this.Bka[N].reactionImagePath,numberOfAnimationFrames:this.Bka[N].numberOfAnimationFrames});this.lj.setReactions(t)}}}MIb(t){return new Promise(N=>{if(this.ar&&this.Hn&&this.rp)try{if(1>this.qgb.size)L.a.J(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",
this.zd.telemetryData.sessionId,t),N(!0);else if(2===t&&(!this.Dsa||1>this.Dsa.size))L.a.J(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",this.zd.telemetryData.sessionId,t),N(!0);else{var ha=null,Aa=0;this.qgb.forEach((yb,Sb)=>{yb>Aa&&(ha=Sb.toString(),Aa=yb)});if(this.F_c&&ha===this.F_c)L.a.J(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.zd.telemetryData.sessionId,
t),N(!0);else{var Ra=this.Hn.TriggerSaveThumbnails(()=>this.WZb("SaveThumbnails",this.zd.telemetryData.sessionId),ha);Ra?Ra.then(()=>{this.F_c=ha;L.a.J(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",this.zd.telemetryData.sessionId,t);N(!0)}).catch(yb=>{L.a.J(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.zd.telemetryData.sessionId,yb.toString(),t);N(!1)}):(this.zd.telemetryData.SetErrorCode(15,
"Triggering save thumbnails failed to created Promise object!"),L.a.J(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),N(!1))}}}catch(yb){this.zd.telemetryData.SetErrorCode(15,yb.toString()),L.a.J(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.zd.telemetryData.sessionId,yb.toString()),N(!1)}else N(!0)})}gPa(){return this.la.pptEditorVoiceUXEnabled&&this.vl&&this.vl.instance?!0:!1}osi(t){if(this.gPa())switch(t){case 0:this.sEa&&
this.vl.instance.show(ResourceStrings.L_LivePresentations_Disconnected,Lm.a.TVa);this.zd.telemetryData.SetErrorCode(3);this.JZ("DisconnectdToPrague");break;case 1:this.vl.instance.hide();break;case 2:this.sEa&&this.vl.instance.show(ResourceStrings.L_LivePresentations_Connecting,Lm.a.MBb);break;default:L.a.J(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.zd.telemetryData.sessionId)}else L.a.J(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",
this.zd.telemetryData.sessionId)}kdc(t,N){this.gPa()?N.isConnected?this.vl.instance.hide():this.sEa&&this.vl.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,Lm.a.MBb):L.a.J(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.zd.telemetryData.sessionId)}MZd(t,N){t=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.la.podsWebServiceBase,t,N);this.la.Jxk&&(t+="&shareable=true");return t}pol(t,
N){try{const ha=new D.a;if(1===t||2===t||4===t)ha.add(this.Rkd(3)),ha.add(this.MIb(3));ha.count?Promise.all(ha.toArray()).then(()=>N()).catch(()=>N()):N()}catch(ha){L.a.J(512496150,833,10,"failed to create end session task promises, error : {0}",ha),N()}}get iUe(){const t=Fp.a.get("PPTLivePresentationOnboarded");return t?"true"===t.toLowerCase():!1}set iUe(t){Fp.a.JL("PPTLivePresentationOnboarded",t.toString(),Fp.a.rL)||L.a.J(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",
t.toString())}jUd(){return this.la.lyk&&!this.iUe}E9(){try{if(L.a.J(512496148,833,15,"Pods session rehydrated!"),this.uYc=!0,this.ar&&this.Lq&&this.Hn){L.a.J(512496147,833,15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.zd.telemetryData.sessionId,this.Xa.Wj);const t=this.MZd(this.Xa.podSessionId,this.Xa.Wj);this.Hn.OnPodSessionUpdated(t)}}catch(t){L.a.J(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",t.toString())}}mCb(){this.uYc=
!1}onPodSessionExpired(){this.uYc=!1}qhb(){if(this.la.myk)try{const t=u.a.instance.La("Common.ISystemInitiatedFeedback");t&&(L.a.J(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),t.execute(N=>{N.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(t){L.a.J(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",t)}}Rbg(t){const N=document.createElement("a");N.setAttribute("href",
t);return(t=N.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===t.length?t[1]:""}yWi(){var t=this.yc.odj();let N=1;this.fqe.clear();for(const ha of t){t=ha.om();for(const Aa of t)if(!gb.a.Va(Aa.Ccb)){t=this.Rbg(Aa.Ccb);const Ra=new Ro;Ra.yMg=t;Ra.zMg=N.toString();this.fqe.add(Ra);N+=1}}}txh(){var t=this.yc.aCa(this.W9a).om();for(const N of t)gb.a.Va(N.Ccb)||(t=this.Rbg(N.Ccb),t=this.eqe.get(t),gb.a.Va(t)||this.Hn.SetCurrentPollInfoState(t,this.W9a))}p4h(t){this.va.addHandler("OnLiveResourcesLoaded",
t)}UPk(t){this.va.removeHandler("OnLiveResourcesLoaded",t)}KCf(t){this.va.addHandler("OnLiveSessionStarted",t)}ddh(t){this.va.removeHandler("OnLiveSessionStarted",t)}ICf(t){this.va.addHandler("OnLiveSessionEnded",t)}cdh(t){this.va.removeHandler("OnLiveSessionEnded",t)}z3h(t){this.va.addHandler("OnCalloutDismissed",t)}qPk(t){this.va.removeHandler("OnCalloutDismissed",t)}GCf(t){this.va.addHandler("OnRelaunchPausedSession",t)}adh(t){this.va.removeHandler("OnRelaunchPausedSession",t)}A3h(t){this.va.addHandler("CalloutMenuDefinitionChanged",
t)}rPk(t){this.va.removeHandler("CalloutMenuDefinitionChanged",t)}}Object(h.a)(Jq,"LivePresenter",null,[780]);class Xr{constructor(){this.K=null;this.WLg=0}get name(){return"PowerPointWebEditor.Live"}Wb(t){this.K=t;const N=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(780,"PowerPointLive.ILivePresenter").ma().na(()=>new Jq(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),N,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),
this.K.resolve("Common.App.OAuth.IOAuthManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),u.a.instance.La("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),
this.K.resolve("PowerPointWebEditor.IFocusManager")))}QTj(){try{this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled?(this.WLg=Date.now(),L.a.J(42869339,833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),ib.a.get_instance().Xj(7,()=>{const t=this.K.resolve("Common.IDynamicScriptLoaderProvider").yv,N=Gm.a(this.K),ha=new D.a;ha.add(t.loadScript("PPTLiveBroadcast"));ha.add(t.loadScript("BroadcastMonitor"));ha.add(N("liveActor"));v.AFrameworkApplication.Aa.gb.Mp||
ha.add(N("uiFabricLazy"));Promise.all(ha.toArray()).then(()=>this.qlk()).catch(Aa=>L.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",Aa))})):L.a.J(42869337,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(t){L.a.J(42869343,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",t)}}Bm(){try{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").eyk){const t=
gb.a.uV((v.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===t||".pps"===t){L.a.J(592238732,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==t&&L.a.J(592238730,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+t)}this.K.resolve("PowerPointWebEditor.IApplicationSettings").hyk&&this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?L.a.J(592328917,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):
this.K.resolve("PowerPointWebEditor.IApplicationSettings").iyk&&(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?L.a.J(592189026,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").A5g&&"msa"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?L.a.J(591685859,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):
this.K.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled("PowerPointLivePresentations",!1).then(N=>{N?this.QTj():(L.a.J(592472007,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else L.a.J(592472009,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(t){L.a.J(592472005,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",
t)}}qlk(){L.a.J(50860060,833,50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.WLg);this.K.resolve("PowerPointLive.ILivePresenter").k5a=!0;this.K.resolve("PowerPointWebEditor.IApplicationSettings").A5g||"msa"!==this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Bm,"onFullAppSettingsReady"))}dispose(){}static main(){e.a.instance.Ac(new Xr)}}
Object(h.a)(Xr,"PPTWebEditorLivePackage",null,[2,3]);var ul=d(706);class An{}Object(h.a)(An,"LokiTokenResult",null,[]);class Gp{constructor(t){this.xuc=t}x6i(){const t=this.w6i();return t?Gp.C9d?new Promise((N,ha)=>{this.xuc.continueWith(()=>{this.xuc.Dn||this.xuc.Wl?ha(Error.create("Error downloading auth library")):this.xuc.result.q0("Loki",t).then(Aa=>{Aa=v.AFrameworkApplication.fa.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.A6i():Aa.IsSuccess&&Aa.Token?Object.assign(new An,{isSuccess:!0,
token:Aa.Token,errorMessage:null}):Object.assign(new An,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Aa)});N(Aa);return Aa})})}):Promise.resolve(Object.assign(new An,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new An,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",ul.a.y6f())}))}A6i(){const t=v.AFrameworkApplication.fa.Ha("LokiUserDataSignature")||
"";return Object.assign(new An,{isSuccess:!0,token:t,errorMessage:null})}w6i(){let t=null;const N=ul.a.wKc();2===N?t=v.AFrameworkApplication.fa.Ha("LokiAADAppId"):1===N&&(t=v.AFrameworkApplication.fa.Ha("LokiMSAAppId"));return t}static get C9d(){return v.AFrameworkApplication.fa.ka("IsO365CommercialHost")||v.AFrameworkApplication.fa.ka("IsO365ConsumerHost")}}Object(h.a)(Gp,"LokiTokenManager",null,[833]);class Kq{get name(){return"Common.App.LivePersonaUtils"}init(){u.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Wb(t){t.register(Gp,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ma().na(()=>new Gp(jg.a.vu(t.La("Common.App.OAuth.IOAuthManager"))))}static main(){e.a.instance.Ac(new Kq)}}Object(h.a)(Kq,"LivePersonaUtilsPackage",null,[2,3]);var Ln=d(257);class Yr{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(h.a)(Yr,"RehearsalCritique",null,[]);class ke{static Gwj(){ke.pX[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;ke.pX[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
ke.pX[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;ke.pX[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;ke.SVf=ResourceStrings.L_SubtitleDetection_MicReady;ke.TVf=ResourceStrings.L_SubtitleDetection_SoundReminder;ke.P_f=ResourceStrings.L_SubtitleDetection_NoMicrophone;ke.V_f=ResourceStrings.l_NoCamera;ke.W5f=ResourceStrings.L_SpeechGenericRetryErrorMessage}}ke.OJf=20;ke.pbh=50002;ke.pX=Array(ke.OJf);ke.SVf=null;ke.TVf=null;ke.P_f=null;ke.V_f=null;ke.W5f=null;ke.WUd="fillerWords";
ke.Sqk="originality";ke.qBl="wordsPerMinute";ke.u_k="sensitivePhrases";ke.Xui="correctedSensitivePhrases";ke.Xwk="positivity";ke.n2d="grammar";ke.cse="monotone";ke.sAe="pronunciation";ke.HPd="crutchWords";ke.JDh="visionFace";ke.Szl="visionGaze";ke.Rzl="visionGazeGood";ke.Uzl="visionOcclusion";ke.Tzl="visionOcclusionGood";ke.Ozl="visionDistanceGood";ke.Pzl="visionDistanceTooClose";ke.Qzl="visionDistanceTooFar";ke.Pdg="GetStartedButton";ke.gTj="ListeningButtonPlayPauseButton";ke.hTj="ListeningElement";
ke.Jsi="ContainerElement";ke.xuk="PausedElement";ke.Gfk="NotificationButtonElement";ke.yAl="WelcomeCheckboxElement";ke.rbh="RehearsalFeedbackSettingPane";ke.Uye="PPTCoachRehearsalFREShown";Object(h.a)(ke,"RehearsalResourceString",null,[]);const Gk=(t,N)=>gb.a.Va(N)?(m.ULS.sendTraceTag(587872E3,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):t?N.toLowerCase()in t:!0,eq=(t,N)=>{let ha=null;try{if(!t||gb.a.Va(N))return m.ULS.sendTraceTag(587871971,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),
null;const Ra=gb.a.Va(t.ecd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(t.ecd,!0);ha={};for(let yb in Ra){t=yb;var Aa=Ra[yb];if(Aa){const Sb=bg.a.aUb(Aa.split(","));Sb&&N.toLowerCase()in Sb&&(ha[t.toLowerCase()]=!0)}}}catch(Ra){L.a.J(590136391,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Ra.toString()),ha=null}return ha},Hp=(t,N)=>{if(gb.a.Va(N)||gb.a.Va(t.y4g))return null;try{var ha=Sys.Serialization.JavaScriptSerializer.deserialize(t.y4g,
!0);if(gb.a.Va(N)){m.ULS.sendTraceTag(587871968,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var Aa=null}else Aa=N.split("-")[0].toLowerCase();return ha[Aa]}catch(Ra){return L.a.J(587872025,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Ra.toString()),null}},Lq=t=>{if(t&&3<t.length){let N="";"ws"===t.substring(0,2)?N="http"+t.substring(2,t.length):"wss"===t.substring(0,3)&&(N="https"+t.substring(3,
t.length));return N}return t},So=t=>{if(gb.a.Va(t))return m.ULS.sendTraceTag(559548251,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",t),"en-US";switch(t.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return t}};class fq{constructor(){this.userCritiques=null}}Object(h.a)(fq,"RehearseRoamingSettings",null,[]);class Wj{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(h.a)(Wj,"UserCritiqueSettings",null,[]);class op{constructor(t,N,ha,Aa){this.va=new qm.a;this.DI=this.c7b=this.iT=null;this.RK=!1;this.zDg=null;this.Qta=this.Rta=0;this.Uv=t;this.la=N;this.REa=ha;this.ia=Aa}Iyj(){try{this.rcg(()=>{this.va.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(t){L.a.J(557602759,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",t.toString())}}oTc(){return 2===this.Rta&&2===this.Qta}KRe(){try{0!==
this.Rta&&3!==this.Rta||this.rcg(Object(n.a)(this,this.XBe,"raiseRehearsalGetCritiquesEvent")),0!==this.Qta&&3!==this.Qta||this.n2i()}catch(t){L.a.J(559548259,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",t.toString())}}k0i(){if(!this.c7b)return L.a.J(559548288,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.DI)for(let t of this.c7b)this.DI.contains(t.critique.toLowerCase())?t.optOut=!0:t.optOut=!1}catch(t){L.a.J(557602760,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
t.toString())}return this.c7b.toArray()}nvl(t,N){this.FBh(t,N);"vision"===t.toLowerCase()&&(this.RK=!N,t={},t.triggerPoint=ke.rbh,this.ia.Ka(tb.a.xmc,2,t))}kbg(t=!1){let N="";if(this.DI&&0<this.DI.count)if(gd.a("RehearsalFilterOptOutCritiqueEnabled")&&t){a:{var ha=this.la;t=this.la.Gva;var Aa=null;try{if(!ha||gb.a.Va(t)){m.ULS.sendTraceTag(554837597,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");var Ra=null;break a}var yb=
gb.a.Va(ha.ecd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(ha.ecd,!0);Aa={};for(let uc in yb){Ra=uc;var Sb=yb[uc];if(Sb){const Zc=bg.a.aUb(Sb.split(","));Aa[Ra.toLowerCase()]=Zc&&t.toLowerCase()in Zc?!0:!1}}}catch(uc){L.a.J(554837598,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",uc.toString()),Aa=null}Ra=Aa}if(Sb=Ra)for(let uc of this.DI)if(yb="vision"===uc?ke.JDh.toLowerCase():uc.toLowerCase(),yb in Sb?Sb[yb]:1)N=gb.a.Va(N)?
uc.toLowerCase():N+","+uc.toLowerCase()}else for(Aa of this.DI)N=gb.a.Va(N)?Aa.toLowerCase():N+","+Aa.toLowerCase();return N}ked(){if(2!==this.Rta)L.a.J(557602761,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.uMj()){L.a.J(559548291,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var t=new fq;t.userCritiques=Object.assign(new Wj,{critiquesDisabled:this.kbg(),critiquesDisabledByDefault:this.iT.userCritiques.critiquesDisabledByDefault});
var N=qe.c(t),ha=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",v.AFrameworkApplication.Zg),Aa={};Aa["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Uv.vj(ha,2,N,Aa,!1,2,Ra=>{this.Knk(Ra,t)},Object(n.a)(this,this.Jnk,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,Ln.a("17"))}else L.a.J(559548290,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get tUd(){return this.RK}set tUd(t){this.RK=
t;this.FBh("vision",!this.RK);this.oTc()&&this.va.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}i4h(t){this.va.addHandler("OnRehearsalOptOutSettingsRequestFinished",t)}PPk(t){this.va.removeHandler("OnRehearsalOptOutSettingsRequestFinished",t)}h4h(t){this.va.addHandler("OnRehearsalGetCritiquesSucceeded",t)}OPk(t){this.va.removeHandler("OnRehearsalGetCritiquesSucceeded",t)}g4h(t){this.va.addHandler("OnRehearsalGetCritiquesFailed",t)}NPk(t){this.va.removeHandler("OnRehearsalGetCritiquesFailed",
t)}j4h(t){this.va.addHandler("OnRehearsalSettingsUpdatedExternally",t)}QPk(t){this.va.removeHandler("OnRehearsalSettingsUpdatedExternally",t)}FBh(t,N){this.DI&&(t=t.toLowerCase(),N&&!this.DI.contains(t)?this.DI.add(t):!N&&this.DI.contains(t)&&this.DI.remove(t),gd.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.ked())}uMj(){let t=!1;try{var N=gb.a.Va(this.iT.userCritiques.critiquesDisabled);if(!this.DI||!this.DI.count&&N)return!1;if(N&&0<this.DI.count||!N&&!this.DI.count)return!0;const ha=new Set(this.iT.userCritiques.critiquesDisabled.split(","));
if(this.DI.count!==ha.size)return!0;for(N=0;N<this.DI.count;N++)if(!ha.has(this.DI.ga(N).toLowerCase())){t=!0;break}}catch(ha){L.a.J(557602762,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",ha.toString())}return t}Knk(t,N){this.iT=N;L.a.J(559548292,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+t.data.Iu-+t.data.NH,+t.data.zt-+t.data.NH)}Jnk(t){const N=this.REa.bia(t);L.a.J(559548293,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",
N,t.data.state)}rcg(t){const N=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",v.AFrameworkApplication.Zg),ha={};ha["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Uv.vj(N,1,null,ha,!1,2,Aa=>{this.tkk(Aa,t)},Aa=>{this.skk(Aa,t)},null,void 0,void 0,void 0,void 0,Ln.a("16"));this.Rta=1}tkk(t,N){let ha=0;try{t.data.Zd&&0<t.data.Zd.trim().length&&(ha=t.data.Zd.length,
this.iT=JSON.parse(t.data.Zd));this.iT&&this.iT.userCritiques||(this.iT=new fq,this.iT.userCritiques=new Wj);gb.a.Va(this.iT.userCritiques.critiquesDisabledByDefault)&&(this.iT.userCritiques.critiquesDisabledByDefault="vision",gb.a.Va(this.iT.userCritiques.critiquesDisabled)?this.iT.userCritiques.critiquesDisabled="vision":this.iT.userCritiques.critiquesDisabled+=",vision");this.DI=new D.a;if(!gb.a.Va(this.iT.userCritiques.critiquesDisabled)){const Aa=this.iT.userCritiques.critiquesDisabled.split(",");
for(const Ra of Aa)this.DI.add(Ra.toLowerCase())}this.RK=!this.DI.contains("vision");this.Rta=2}catch(Aa){this.Rta=3,L.a.J(559548294,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",Aa.toString())}N&&N();t=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",ha,JSON.stringify(t.data.NH),JSON.stringify(t.data.zt),JSON.stringify(t.data.Iu));L.a.J(559548295,822,50,t)}skk(t,N){this.Rta=3;N&&N();t=this.REa.bia(t);L.a.J(559548296,
822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",t)}n2i(){try{const N=this.DPi();if(gb.a.Va(N))L.a.J(559548297,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var t=new XMLHttpRequest;t.open("GET",N,!0);t.onreadystatechange=()=>{if(4===t.readyState){if(200===t.status){L.a.J(559548298,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");const ha=qe.b(t.responseText);if(ha){this.c7b=new D.a;for(const Aa of ha.critiquesData)this.c7b.add(Object.assign(new Yr,
{category:Aa.category,displayName:Aa.displayName,optOut:!1,critique:Aa.critique.toLowerCase()}));this.zDg=ha.categoriesData;this.Qta=2}else this.Qta=3}else this.Qta=3;this.XBe()}};t.send("");this.Qta=1}}catch(N){this.Qta=3,this.XBe(),L.a.J(559548299,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",N.toString())}}DPi(){const t=qe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).Ring||"Unknown",N=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");
return N&&N.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",N,t,So(this.la.Gva)):null}XBe(){0!==this.Rta&&1!==this.Rta&&0!==this.Qta&&1!==this.Qta&&(this.oTc()?this.va.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.va.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(h.a)(op,"RehearsalFeedbackSettings",null,[774]);class Zs{constructor(){this.type="RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=
this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(h.a)(Zs,"RehearsalCritiqueWithGroupProps",null,[]);class Zr{constructor(t,N,ha,Aa,Ra){this.KEa=this.Ib=!1;t.loadScript("powerpoint-presenter-coach-strings").then(()=>{this.KEa=!0;L.a.J(559548252,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(yb=>{L.a.J(559548253,822,10,"Failed to load powerpoint-presenter-coach-strings "+
yb.toString())});this.ia=N;this.la=Ra;this.yD=ha;this.Kx=Aa;this.ia.Zla(this)}ub(){this.ia.xa(tb.a.phd,sb.a.application,Object(n.a)(this,this.phd,"showRehearsalFeedbackSettingsPane"));this.ia.xa(tb.a.zLe,sb.a.application,Object(n.a)(this,this.zLe,"showHideRehearsalFeedbackSettingsPane"));this.ia.pa(tb.a.mBe,sb.a.application,Object(n.a)(this,this.mBe,"queryShowHideRehearsalFeedbackSettingsPane"),96)}we(){}B9(){}z9(){}phd(t,N,ha){if(N.contextId!==sb.a.application||!this.KEa)return 2;if(1===ha)return 32;
this.Ib?Qb.UISurfaces.Cs().then(Aa=>{Aa.setSelectedTaskPane(hd.a.feb);this.Zz(!0);return null}).catch(Aa=>{L.a.J(554447887,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",Aa.toString())}):(this.Ib=!0,this.lbh(),(t=!this.Kx.oTc())&&this.Kx.KRe(),t=this.IB(t,!1),this.ykc(t),L.a.J(555832795,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}zLe(t,N,ha){if(N.contextId!==sb.a.application||!this.KEa)return 2;if(1===ha)return 32;
(this.Ib=!this.Ib)?(this.lbh(),(t=!this.Kx.oTc())&&this.Kx.KRe(),t=this.IB(t,!1),this.ykc(t),L.a.J(559548254,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.Xni(),L.a.J(559548255,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}mBe(t,N,ha,Aa,Ra){if(!Object(Lj.a)(vn.a,Ra))return 8;Ra.Kf(this.Ib);return 32}ykc(t,N=!1){const ha=Object.assign(new Ya.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,
width:320,location:2,contentProps:t,onOpen:()=>{},onClose:()=>{this.Ib=!1;this.uEi();this.Kx.ked()},onHide:()=>{this.Kx.ked()},isModernPane:!0});t=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.yD.v7(hd.a.feb,hd.a.gj,t,()=>{this.Zz(!0)},()=>{this.Zz(!1)});Qb.UISurfaces.Cs().then(Aa=>{N?this.Ib&&Aa.updateTaskPane(hd.a.feb,ha):Aa.showTaskPane(hd.a.feb,ha);return null}).catch(Aa=>{L.a.J(559548256,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",
Aa.toString())})}Xni(){Qb.UISurfaces.Cs().then(t=>{t.hideTaskPane(hd.a.feb,2);return null}).catch(t=>{L.a.J(559548257,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",t.toString())})}IB(t,N){return Object.assign(new Zs,{groupItems:t||N?null:this.Kx.k0i(),categoriesData:this.Kx.zDg,locale:this.la.Gva,updateCritiqueState:(ha,Aa)=>{this.Kx.nvl(ha,Aa)},retryToFetchCritiqueSettings:()=>{this.Kx.KRe()},showLoadingMessage:t,showErrorMessage:N})}Zz(t){const N=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");
t&&N&&N.focus()}lbh(){this.Kx.h4h(Object(n.a)(this,this.n_g,"onRehearsalGetCritiquesSucceeded"));this.Kx.g4h(Object(n.a)(this,this.m_g,"onRehearsalGetCritiquesFailed"));this.Kx.j4h(Object(n.a)(this,this.p_g,"onRehearsalSettingsUpdatedExternally"))}uEi(){this.Kx.OPk(Object(n.a)(this,this.n_g,"onRehearsalGetCritiquesSucceeded"));this.Kx.NPk(Object(n.a)(this,this.m_g,"onRehearsalGetCritiquesFailed"));this.Kx.QPk(Object(n.a)(this,this.p_g,"onRehearsalSettingsUpdatedExternally"))}n_g(){const t=this.IB(!1,
!1);this.ykc(t,!0)}m_g(){const t=this.IB(!1,!0);this.ykc(t,!0)}p_g(){const t=this.IB(!1,!1);t.isExternalUpdated=!0;this.ykc(t,!0)}}Object(h.a)(Zr,"RehearsalFeedbackSettingsPane",null,[156]);var To;(function(t){t[t.none=0]="none";t[t.ribbon=1]="ribbon";t[t.slideShowToolbar=2]="slideShowToolbar";t[t.summaryPage=3]="summaryPage";t[t.ribbonTopBar=4]="ribbonTopBar";t[t.deepLink=5]="deepLink"})(To||(To={}));Object(h.b)("RehearsalEntryPoint",To);class io{constructor(){this.imagesBaseFilePath=this.slideState=
this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(h.a)(io,"ICoachActorConfig",null,[]);class $r{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=0}}Object(h.a)($r,"ICoachFREActorConfig",null,[]);class Mm{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=
this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=
this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(h.a)(Mm,"ICoachSessionConfig",null,[]);class gq{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(h.a)(gq,"IDocumentDownloadConfig",null,[]);class Ip{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(h.a)(Ip,"ISlideState",null,[]);class nr{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=
this.numFramesPerSecond=0}}Object(h.a)(nr,"IWebcamConfig",null,[]);var Jp=d(661);class zo{constructor(t,N,ha,Aa,Ra,yb,Sb,uc,Zc,ed,Gd,ze,re,ff){this.yTa=!1;this.Vv=this.wee=this.mW=this.tca=null;this.Q$b=0;this.XMg=-1;this.abc=0;this.q4c=this.g4c=null;this.Fhe=this.vhe=!1;this.eoe=this.Cka=0;this.RK=!1;this.va=new qm.a;this.dVa=null;this.WFg=this.Sqe=this.Ade=!1;this.goe=null;this.z6b=this.LDg=0;this.VOg=this.pFg=!1;this.wFg=v.AFrameworkApplication.fa.ka("FirstRehearsalExperienceEnabled");this.T_j=
ha;N&&(this.tca=N.kG());this.eb=Aa;this.ia=t;this.yc=Ra;this.ta=yb;this.Xa=Sb;this.la=uc;this.vl=Zc;this.Hca=ed;this.P$b=Gd;this.Kx=ze;this.rN=re;this.FD=ff;this.QYb()&&this.Kx.i4h(Object(n.a)(this,this.o_g,"onRehearsalOptOutSettingsRequestFinished"))}ub(){this.ia.xa(tb.a.blc,sb.a.application,Object(n.a)(this,this.blc,"startRehearsalManager"));this.ia.xa(tb.a.xmc,sb.a.application,Object(n.a)(this,this.xmc,"toggleRehearsalVisionEnabled"));this.ia.xa(tb.a.fcd,sb.a.application,Object(n.a)(this,this.fcd,
"rehearsePresentationDropDown"));this.ia.pa(tb.a.Cgc,sb.a.application,Object(n.a)(this,this.Cgc,"queryRehearsalVisionEnabled"),96)}Cgc(t,N,ha,Aa,Ra){if(!Ra||!Object(Lj.a)(vn.a,Ra))return L.a.J(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Ra.Kf(this.RK);return 32}fcd(t,N,ha){switch(ha){case 1:if(this.yTa&&this.sae())return this.ia.processAction(tb.a.$la,1);break;default:L.a.J(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}xmc(t,
N,ha,Aa,Ra){switch(ha){case 2:return this.RK=!this.RK,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.gb.Mp&&Kg.App.Fb.HF({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.QYb()&&Ra&&Ra.triggerPoint!==ke.rbh&&(this.Kx.tUd=this.RK),32;case 1:if(this.yTa&&this.sae())return 32;break;default:L.a.J(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}blc(t,N,ha,Aa,Ra){switch(ha){case 2:return this.Ngl(Ra),32;case 1:if(this.yTa&&this.sae())return 32;break;default:L.a.J(512496079,
822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}O5b(){try{this.LDg=Date.now();const t=this.T_j.yv;t.loadScript("powerpoint-presenter-coach-strings").then(()=>{const N=new D.a;N.add(t.loadScript("CoachActorPackage"));N.add(t.loadScript("CoachPackage"));Promise.all(N.toArray()).then(()=>{this.oik();return null}).catch(ha=>{L.a.J(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",ha);return null})})}catch(t){L.a.J(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",
t)}}B3h(t){this.va.addHandler("OnCoachResourcesLoaded",t)}sPk(t){this.va.removeHandler("OnCoachResourcesLoaded",t)}oik(){const t=v.AFrameworkApplication.fa.Ha("CoachPackageCssUrl"),N=document.createElement("link");N.setAttribute("rel","stylesheet");N.setAttribute("type","text/css");N.setAttribute("href",t);$addHandler(N,"load",()=>{this.yTa=!0;gd.a("PollToRefreshCoachEntryPointOnRibbon")&&this.FD&&this.FD.uF();this.va.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);L.a.J(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",
Date.now()-this.LDg)});document.body.appendChild(N)}lMk(){this.eb.Izc(Object(n.a)(this,this.s0g,"onSlideshowReady"));this.eb.PMa(Object(n.a)(this,this.Ddc,"onSlideShowPositionChanged"));this.eb.Jga(Object(n.a)(this,this.Lda,"onSlideshowExitHandler"));this.eb.Jzc(Object(n.a)(this,this.fva,"onSpecialKeyHandler"))}vEi(){this.eb.Bcd(Object(n.a)(this,this.s0g,"onSlideshowReady"));this.eb.peb(Object(n.a)(this,this.Ddc,"onSlideShowPositionChanged"));this.eb.fea(Object(n.a)(this,this.Lda,"onSlideshowExitHandler"));
this.eb.Ccd(Object(n.a)(this,this.fva,"onSpecialKeyHandler"))}fva(t,N){N.key===qa.a.bKb&&this.hIe()}hIe(){if(0===this.Cka){var t=this.Vv.getCoachElement(ke.Pdg);t&&this.ZHa(t)}else 2===this.Cka?(t=this.Vv.getCoachElement(ke.xuk))&&this.ZHa(t):1===this.Cka&&(t=this.Vv.getCoachElement(ke.hTj))&&this.ZHa(t)}ZHa(t){this.tca&&this.Vv&&window.setTimeout(()=>{ec.FocusManager.Dr(t)},50)}Az(t){try{const Ra=this.Vv.getCoachElement(ke.Pdg),yb=this.Vv.getCoachElement(ke.gTj),Sb=this.Vv.getCoachElement(ke.yAl),
uc=this.Vv.getCoachElement(ke.Gfk);if(t.keyCode===qa.a.Bq){if(!gd.a("PresenterCoachTabFix")){var N=!Sb&&!!Ra&&t.target===Ra||!!Sb&&t.target===Sb,ha=!!Ra&&!!yb&&yb.contains(t.target),Aa=!!uc&&t.target===uc;(N||ha||Aa)&&this.eb.restoreFocus()}}else t.keyCode===qa.a.YQ||t.keyCode===qa.a.C0?(this.eb.prev(),this.hIe()):t.keyCode===qa.a.wO||t.keyCode===qa.a.A0?(this.eb.next(),this.hIe()):t.keyCode===qa.a.aq||t.keyCode===qa.a.JJb||t.shiftKey||this.eb.restoreFocus()}catch(Ra){L.a.J(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",
Ra)}}xLk(){const t=this.Vv.getCoachElement(ke.Jsi);if(gd.a("PresenterCoachTabFix")){var N=document.getElementById("HiddenFocusTrapAnchor");this.tca.insertBefore(t,N)}else N=document.getElementById("slideshowEndFocusTrap"),this.tca.insertBefore(t,N);t&&bd.a.addHandler(t,ka.a.eg,Object(n.a)(this,this.Az,"keyDownHandler"))}Ngl(t){if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");ke.Gwj();this.lMk();this.QYb()&&(this.Kx.ked(),this.Kx.PPk(Object(n.a)(this,this.o_g,"onRehearsalOptOutSettingsRequestFinished")));
const N=new Ip;this.dVa=eq(this.la,this.la.Gva);this.RK&&!this.la.pptRehearsalVisionEnabled&&L.a.J(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.RK=this.RK&&this.la.pptRehearsalVisionEnabled;var ha=new zn.a,Aa=Object(M.a)(122,this.yc.aCa(this.ta.Ba.Bb.sid));N.currentSlideIndex=Aa?Aa.De:0;N.totalSlideCount=this.yc.Nj();Aa=this.LZi(N);this.Vv=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(Aa,ha);this.RK&&(this.g4c=this.Vv.getRehearsalVideoElement(),
this.q4c=this.Vv.getRehearsalVideoCanvas());this.eoe=t;t=this.FXd(N,this.g4c,this.q4c);this.mW=(new CoachPackage.CoachSessionFactory).createCoachManager(t);t=this.MZi();this.wee=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(t,ha);gd.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.rN.enumerateDevices(Object(n.a)(this,this.Vcc,"onEnumerateDevicesSuccess"),Object(n.a)(this,this.bWa,"onDevicesFailure"),Object(n.a)(this,this.lWa,"onUnsupported"));this.oKk();this.pKk();
this.Q$b=0;this.Fhe=!1;this.xLk();2===this.eoe&&(ha=localStorage.getItem(ke.Uye),this.wFg&&!ha?this.wsh():this.$Me())}$Me(){this.Cka=0;this.Hca.execute(t=>{t.sC(Jp.a.SubtitlesButton,!1);t.sC(Jp.a.LiveButton,!1);t.sC(Jp.a.CoachButton,!1);t.sC(Jp.a.MicButton,!1)});this.mW.startSession(!0)}wsh(){this.wee.showCoachFREUI(t=>{localStorage.setItem(ke.Uye,"true");this.VOg=t;this.$Me()})}Vcc(t){this.z6b=0;if(t.length)for(var N of t)"audioinput"===N.kind&&(this.z6b+=1);else this.z6b=0;this.pFg=!0;t=new Ip;
N=Object(M.a)(122,this.yc.aCa(this.ta.Ba.Bb.sid));t.currentSlideIndex=N?N.De:0;t.totalSlideCount=this.yc.Nj();t=this.FXd(t,this.g4c,this.q4c);this.mW.updateSessionConfiguration(t)}bWa(t){L.a.J(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",t.toString())}lWa(){L.a.J(512496072,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",Pc.a.iy)}s0g(){const t=localStorage.getItem(ke.Uye);this.wFg&&!t?this.wsh():this.$Me()}Ddc(t,
N){t=new Ip;t.currentSlideIndex=N.slideIndex;t.totalSlideCount=this.yc.Nj();N=this.FXd(t,this.g4c,this.q4c);this.mW.updateSessionConfiguration(N);this.Vv.updateCoachSlideComponent(t)}getTraceRequestMetadata(t,N){const ha={};if(t)for(let Aa in t)ha[Aa]=t[Aa];if(N)for(let Aa in N)ha[Aa]=N[Aa];t=qe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());ha.AudienceGroup=t.Ring||"Unknown";ha.BuildVersion=v.AFrameworkApplication.buildVersion||"Unknown";ha.ClientType="web";ha.IdentityProvider=
this.la.hostAuthType||v.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown";ha.Locale=this.la.ZGa||"Unknown";ha.SpeechMode="rehearsal";ha.TenantId=v.AFrameworkApplication.fa.Ha("TenantId");ha.UserId=this.getUserId();ha.WacDatacenter=t.WACDatacenter||"Unknown";ha.WacHost=t.Host||"Unknown";ha.SourceLanguage=this.la.lOf||So(this.la.Gva);return ha}getUserId(){let t=v.AFrameworkApplication.fa.Ha("PptEditingUserId");gb.a.Va(t)&&(t=v.AFrameworkApplication.fa.Ha("LoggableUserId"),m.ULS.sendTraceTag(512496071,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",gb.a.Va(t)));return t}SZk(){if(this.la.vvk){var t=this.mW.getTraceRequestMetadata(),N=this.Vv.getTraceRequestMetadata(),ha=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");if(ha&&ha.length){var Aa=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",ha);ha=new XMLHttpRequest;ha.open("POST",Aa,!0);Aa=Lc.a.create().toString();ha.setRequestHeader("X-Correlation",Aa);try{m.ULS.sendTraceTag(512496069,
822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",Aa);const Ra=this.getTraceRequestMetadata(t,N);ha.send(qe.c(Ra))}catch(Ra){m.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",Aa)}}else m.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}Lda(){this.vEi();this.Cka=3;this.mW.stopSession();this.wee.hideCoachFREAndWelcomeUI();this.Vv.hideCoachUI();this.Sqe=this.Ade=!1;try{this.mW.getSessionSummary(t=>
{t.timeSpentInSeconds=this.Q$b;this.ia.processAction(tb.a.DHc,2);this.ia.processAction(tb.a.CHc,2);window.clearInterval(this.XMg);this.Fhe&&this.P$b.instance.vIa(t,this.RK,this.dVa,this.goe,()=>{this.SZk()})})}catch(t){m.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",t)}}kaj(){let t=",visionFace";this.la.vyk&&(t+=","+ke.Szl+","+ke.Rzl);this.la.wyk&&(t+=","+ke.Uzl+","+ke.Tzl);this.la.uyk&&(t+=","+ke.Ozl+","+ke.Pzl+","+ke.Qzl);return ke.qBl+(Gk(this.dVa,
ke.WUd)?","+ke.WUd:"")+","+ke.u_k+","+ke.Xui+","+ke.Sqk+","+ke.Xwk+(this.la.Vye&&Gk(this.dVa,ke.n2d)?","+ke.n2d:"")+(this.la.pye&&Gk(this.dVa,ke.cse)?","+ke.cse:"")+(this.la.pptRehearsalVisionEnabled&&Gk(this.dVa,ke.JDh)?t:"")+(this.la.pptRehearsalPronunciationEnabled&&Gk(this.dVa,ke.sAe)?","+ke.sAe:"")+(this.la.pptRehearsalCrutchWordsEnabled&&Gk(this.dVa,ke.HPd)?","+ke.HPd:"")}FXd(t,N,ha){const Aa=new Mm;Aa.disabledCoachRealtimeFeatures="";Aa.userSessionId=v.AFrameworkApplication.userSessionId;var Ra=
new gq;Ra.docId=v.AFrameworkApplication.Zg;Ra.podsSessionId=this.Xa.podSessionId;Ra.userDataCenterClusterId=this.Xa.Wj;Ra.webServiceBase=this.la.podsWebServiceBase;Aa.documentDownloadConfig=Ra;Ra=new zn.a;Aa.logger=Ra;Ra={};Ra.currentSlideIndex=t.currentSlideIndex.toString();Aa.customSettings=Ra;Aa.fEnableServiceSideAggregationForCoach=this.la.F$c;Aa.httpTimeoutForCoachSummaryData=this.la.Hyk;Aa.fSendClientMetaDataOnSessionStart=this.la.mKi;Aa.speechFDBase=this.la.pptEditorSpeechHandlerBaseUri;Aa.requestedCoachFeatures=
this.kaj();this.QYb()&&(this.goe=this.Kx.kbg(!0),Aa.requestedRehearsalOptOutFeatures=this.goe);gd.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(Aa.enableTimeStampedCritiqueTelemetry=!0);Aa.entryPoint=To[this.eoe];Aa.fEnableVision=this.RK;Aa.fEnableVision&&N&&ha&&(Aa.webcamConfig=Object.assign(new nr,{videoView:N,workingCanvas:ha,numFramesPerSecond:this.la.pptRehearsalVisionFramesPerSecond,webcamFrameWidth:this.la.yyk}));Aa.supportedRehearsalTemplates=this.Vv.getSupportedRehearsalTemplates();
gd.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.pFg&&(Aa.audioInputDeviceCount=this.z6b);t=qe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Aa.userId=this.getUserId();Aa.tenantId=v.AFrameworkApplication.fa.Ha("TenantId");Aa.identityProvider=this.la.hostAuthType||v.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown";Aa.audienceChannel="";Aa.audienceGroup=t.Ring||"Unknown";Aa.buildVersion=v.AFrameworkApplication.buildVersion||"Unknown";Aa.locale=this.la.ZGa||
"Unknown";Aa.wacHost=t.Host||"Unknown";Aa.wacDatacenter=t.WACDatacenter||"Unknown";Aa.sourceLanguage=this.la.lOf||So(this.la.Gva);L.a.J(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.la.ZGa,this.la.Gva);return Aa}MZi(){const t=new $r;t.rootContainer=this.tca;t.zIndex=ke.pbh;t.imagesBaseFilePath=v.AFrameworkApplication.fa.Ha("CoachImagesBaseFilePath");return t}LZi(t){const N=new io;N.rootContainer=this.tca;N.slideState=t;N.imagesBaseFilePath=
v.AFrameworkApplication.fa.Ha("CoachImagesBaseFilePath");N.zIndex=ke.pbh;N.fEnableVision=this.RK;N.fShowRealtimeFeedbackEnabledCheckbox=this.la.uvk;N.fUseNewRealtimePanel=this.la.dcd;N.fUseCountdownWelcomeScreen=v.AFrameworkApplication.fa.ka("PptCoachEnableCountdownWelcomeUI");N.speechFDBase=Lq(this.la.pptEditorSpeechHandlerBaseUri);N.fDontShowTooltips=Pc.a.$f;N.fUseNewRealtimeCheckbox=gd.a("UseNewRealtimeCheckbox");return N}Fvl(){2!==this.Cka&&(this.Q$b+=1,this.Vv&&this.Vv.updateTimer(this.Q$b))}oKk(){this.Vv.on("CoachSessionStarted",
()=>{this.Cka=1;this.XMg=window.setInterval(Object(n.a)(this,this.Fvl,"updatePresentationTimer"),1E3);this.mW.enableVoiceStreaming();this.Xcl();this.Fhe=!0});this.Vv.on("CoachSessionPaused",()=>{this.Cka=2;this.mW.pauseSession();this.Lha()&&this.vl.instance.hide()});this.Vv.on("CoachSessionResumed",()=>{this.Cka=1;this.mW.resumeSession()})}pKk(){this.mW.on("SpeechRecognitionStarted",()=>{this.vhe&&this.Lha()&&(this.vl.instance.hide(),this.vhe=!1)});this.mW.on("PPTCoachRealtimeNotification",t=>{this.kkj(t)});
this.mW.on("QualityStatusChanged",t=>{this.Anj(t)});this.mW.on("MediaStatusChanged",t=>{this.jmj(t)});this.mW.on("Error",t=>{this.handleError(t)});this.mW.on("ConnectionRetry",()=>{this.slj()})}slj(){this.vhe=!0;this.Lha()&&this.vl.instance.show(ke.W5f,Lm.a.TVa)}kkj(t){this.Vv.updateCoachRealtimeNotification(t)}handleError(t){t=Object(M.a)(String,t);this.Cka=4;t?t.startsWith("ErrorAudio")?(this.Vv&&this.Vv.showCoachDisabledUI(0),this.Lha()&&this.vl.instance.show(ke.P_f,Lm.a.TVa)):t.startsWith("ErrorVideo")?
(this.Vv&&this.Vv.showCoachDisabledUI(1),this.Lha()&&this.vl.instance.show(ke.V_f,Lm.a.TVa)):L.a.J(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):L.a.J(512496065,822,10,"RehearsalManager::handleError errorInfo null")}qsh(){this.Vv&&(this.RK&&this.Vv.enableCoachVideoUI(),this.Vv.showCoachRealtimeUI(this.VOg));this.Lha()&&this.vl.instance.show(ke.SVf,Lm.a.a6c)}jmj(t){"AudioDeviceConnected"===t.mediaStatus?(this.Ade=!0,this.RK&&!this.Sqe||this.qsh()):"VideoSetupCompleted"===t.mediaStatus&&
(this.Sqe=!0,this.Ade&&(this.Vv&&this.Vv.enableCoachVideoUI(),this.qsh()))}Anj(t){if(this.la.pptEditorVoiceUXEnabled){var N=t.severity,ha=t.shortCode;if(0<ha&&ha<ke.OJf&&ke.pX[ha])switch(N){case 0:this.Lha()&&this.vl.instance.hide();break;case 1:(t=0<ha?ke.pX[ha]:t.shortString)&&this.Lha()&&this.vl.instance.show(t,Lm.a.MBb);break;case 2:(t=0<ha?ke.pX[ha]:t.shortString)&&this.Lha()&&this.vl.instance.show(t,Lm.a.TVa)}else L.a.J(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}Lha(){return this.la.pptEditorVoiceUXEnabled&&
this.vl&&this.vl.instance&&2!==this.Cka?!0:!1}Xcl(){this.Lha()&&(this.vl.instance.show(ke.TVf,Lm.a.a6c),this.abc=window.setTimeout(Object(n.a)(this,this.e4d,"hideSoundReminderNotification"),3E3))}e4d(){this.Lha()&&(window.clearTimeout(this.abc),this.vl.instance.hide())}QYb(){return this.la.xDb&&!!this.Kx}sae(){return this.QYb()?this.WFg:!0}o_g(){this.WFg=!0;this.RK=this.Kx.tUd;gd.a("PollToRefreshCoachEntryPointOnRibbon")&&this.FD&&this.FD.uF()}}Object(h.a)(zo,"RehearsalManager",null,[775]);class $s{constructor(t,
N,ha){this.Do=t;this.ia=N;this.la=ha}vIa(t,N,ha,Aa,Ra){try{const uc=document.createElement("div");uc.id="SummaryPageOverlay";uc.style.width="100%";uc.style.height="100%";uc.style.zIndex="999";uc.style.display="flex";uc.style.flexDirection="column";uc.style.justifyContent="center";uc.style.position="absolute";var yb=document.getElementById("SummaryPageOverlay");yb&&document.body.removeChild(yb);document.body.insertBefore(uc,document.body.firstChild);const Zc=uc.parentNode;bd.a.addHandler(Zc,ka.a.eg,
Object(n.a)(this,this.SZg,"onParentNodeKeyDownHandler"));var Sb=t.thumbIndices;if(Sb){yb={};let re=0;const ff=this.ddj(Sb);for(let ah=0;ah<Sb.length;ah++)yb[Sb[ah].toString()]=ff[ah],ff[ah]||re++;L.a.J(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Sb.length,re);t.slideImageSrcs=yb}else t.slideImageSrcs={},L.a.J(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const ed=v.AFrameworkApplication.aE;ed||L.a.J(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");ha||(ha=eq(this.la,this.la.Gva));Sb={};const Gd=qe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).WACSessionID;Sb.fFeedbackCardEnabled=this.la.wvk&&ed;Sb.fShowFeedbackButton=ed;Sb.fMonotoneEnabled=this.la.pye&&Gk(ha,ke.cse);Sb.fGrammarEnabled=this.la.Vye&&Gk(ha,ke.n2d);Sb.fFillersCardEnabled=Gk(ha,ke.WUd);Sb.locale=this.la.Gva;Sb.fPronunciationCardEnabled=
this.la.pptRehearsalPronunciationEnabled&&Gk(ha,ke.sAe);Sb.fCrutchWordCardEnabled=this.la.pptRehearsalCrutchWordsEnabled&&Gk(ha,ke.HPd);Sb.fVisionEnabled=N&&this.la.xyk&&this.la.pptRehearsalVisionEnabled;const ze=Hp(this.la,this.la.Gva);gb.a.Va(ze)||(Sb.fPacingGaugeRange=ze);gb.a.Va(Gd)||(Sb.clientSessionId=Gd);this.la.xDb&&(Sb.rehearsalOptOutFeatures=Aa);(new rehearsalSummaryPage.RehearsalSummaryPageController(uc,t,()=>{L.a.J(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");
Ra&&Ra();this.ia&&(uc.parentNode.removeChild(uc),this.ia.Ka(tb.a.$la,2,{entryPoint:3}))},()=>{Ra&&Ra();bd.a.removeHandler(Zc,ka.a.eg,Object(n.a)(this,this.SZg,"onParentNodeKeyDownHandler"))},this.la.podsWebServiceBase,decodeURIComponent(this.la.R9c),()=>{this.sbl()},Sb,Lq(this.la.pptEditorSpeechHandlerBaseUri),"Web",()=>{this.Ral()})).renderSummaryPage()}catch(uc){L.a.J(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",uc.toString())}}SZg(t){"MainApp"===
t.target.id&&(t.preventDefault(),t.stopPropagation())}Ral(){L.a.J(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");this.ia&&this.la.xDb&&this.ia.Ka(tb.a.phd,2,null)}sbl(){L.a.J(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.la.Pxk?this.ia.Ka(tb.a.ubh,2,null):this.ia.Ka(G.a.giveFeedback,2,!1))}ddj(t){const N=Array(t.length);if(!this.Do)return N;const ha=this.Do.AP(),Aa=this.Do.tQa();
for(let Ra=0;Ra<t.length;Ra++){const yb=Aa[ha[t[Ra]].sid.toString()];yb&&yb.thumbnailImage.length&&(N[Ra]=yb.thumbnailImage)}return N}}Object(h.a)($s,"RehearsalSummaryPageHelper",null,[]);class em{constructor(t,N,ha,Aa,Ra){this.yTa=!1;this.va=new qm.a;this.ia=t;this.hZc=new $s(N,this.ia,Aa);this.Wle=ha;this.T2c=Ra}ub(){this.ia.xa(tb.a.vIa,sb.a.application,Object(n.a)(this,this.$cl,"showSummaryPage"));this.ia.xa(tb.a.ubh,sb.a.application,Object(n.a)(this,this.zbl,"showFloodgateSurvey"))}vIa(t,N,ha,
Aa,Ra){this.hZc.vIa(t,N,ha,Aa,Ra)}$cl(t,N,ha,Aa,Ra){switch(ha){case 2:return this.hZc.vIa(Ra,!1,null,null,null),32;case 1:if(this.yTa)return 32;break;default:L.a.J(41793168,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}zbl(t,N,ha){switch(ha){case 2:return this.T2c.execute(Aa=>{Aa.hHb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.yTa)return 32;break;default:L.a.J(42825479,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}O5b(){const t=
Date.now();this.Wle("rehearsalSummaryPage").then(()=>{const N=v.AFrameworkApplication.fa.Ha("RehearsalSummaryPageCssUrl"),ha=document.createElement("link");ha.setAttribute("rel","stylesheet");ha.setAttribute("type","text/css");ha.setAttribute("href",N);$addHandler(ha,"load",()=>{this.yTa=!0;this.va.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);L.a.J(555798673,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-t)});document.body.appendChild(ha);return null})}k4h(t){this.va.addHandler("OnRehearsalSummaryResourcesLoaded",
t)}RPk(t){this.va.removeHandler("OnRehearsalSummaryResourcesLoaded",t)}}Object(h.a)(em,"RehearsalSummaryPageActor",null,[773]);class at{constructor(t,N,ha,Aa,Ra){this.cwg=this.Frg=!1;this.ia=t;this.Ga=N;this.foe=ha;this.P$b=Aa;this.tua=Ra;this.foe.execute(yb=>{yb.B3h(Object(n.a)(this,this.mXg,"onCoachResourcesLoaded"))});this.P$b.execute(yb=>{yb.k4h(Object(n.a)(this,this.q_g,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.foe.instance&&this.foe.instance.sPk(Object(n.a)(this,this.mXg,"onCoachResourcesLoaded"));
this.P$b.instance&&this.P$b.instance.RPk(Object(n.a)(this,this.q_g,"onRehearsalSummaryResourcesLoaded"))}mXg(){this.Frg=!0;this.uxh()}q_g(){this.cwg=!0;this.uxh()}uxh(){this.Frg&&this.cwg&&ib.a.get_instance().Xj(10,null).continueWith(()=>{if(this.Ga.gph&&this.Ga.tyk){const t=document.getElementById("rehearsal-loading-dialog-modal");t?(t.style.display="none",L.a.J(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):L.a.J(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===
this.ia.processAction(tb.a.$la,1))if(this.Ga.gph)this.ia.Ka(tb.a.$la,2,{entryPoint:5});else if(!this.Ga.xS&&this.Ga.F5g&&this.Ga.Wxk)try{this.tua.continueWith(()=>{this.tua.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),L.a.J(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(t){L.a.J(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",t)}})}}Object(h.a)(at,
"RehearsalTrigger",null,[776]);class Kp{constructor(){this.K=this.Kx=null}get name(){return"PowerPointWebEditor.Rehearsal"}Jri(){this.K.register(773,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ma().na(()=>new em(v.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),Gm.a(this.K),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.La("Common.ISystemInitiatedFeedback")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ub()}Wb(t){this.K=
t;this.K.La("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>{this.Jri()});if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled){this.K.register(774,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").ma().na(()=>new op(v.AFrameworkApplication.He,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.IActionManagerExtended")));this.Kx=this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");
const N=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(775,"PowerPointWebEditor.Rehearsal.IRehearsalManager").ma().na(()=>new zo(v.AFrameworkApplication.Ta,N,this.K.resolve("Common.IDynamicScriptLoaderProvider"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
u.a.instance.La("PowerPointWebEditor.ISlideShowVoiceNotification"),u.a.instance.La("PowerPointWebEditor.ISlideshowToolbar"),u.a.instance.La("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.Kx,this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").ub();this.K.register(776,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").ma().na(()=>new at(v.AFrameworkApplication.Ta,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),u.a.instance.La("PowerPointWebEditor.Rehearsal.IRehearsalManager"),u.a.instance.La("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),jg.a.vu(u.a.instance.La("Common.ISystemInitiatedFeedback"))));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").a5b&&ib.a.get_instance().Xj(7,
()=>{this.K.La("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>{this.initialize()})})}initialize(){this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").O5b();this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled&&this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").O5b();if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").xDb){const t=new Zr(this.K.resolve("Common.IDynamicScriptLoaderProvider").yv,
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.Kx,this.K.resolve("PowerPointWebEditor.IApplicationSettings"));t.ub();t.we();this.Kx.Iyj()}}dispose(){}static main(){e.a.instance.Ac(new Kp)}}Object(h.a)(Kp,"PPTWebEditorRehearsalPackage",null,[2,3]);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");
Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");
Type.registerNamespace("PowerPointWebEditor.Rehearsal");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");Type.registerNamespace("PowerPointWebEditor.VersionHistory");Type.registerNamespace("Common.App.AccessibilityChecker");Tc.main();dc.main();id.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");
rc.main();Type.registerNamespace("Common.App.DirectPrint");e.a.instance.Ac(new Ae);Type.registerNamespace("Common.App.DisplayEnvironmentName");Dg.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");Sc.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.Ac(new Ch);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Wg.main();Type.registerNamespace("Common.App.PenMinutesManager");nd.main();Type.registerNamespace("Common.App.SaveAsToHost");
jc.main();Type.registerNamespace("Common.App.SaveToSharePoint");Ci.main();Type.registerNamespace("Common.App.SaveToCloudStorage");ua.main();Type.registerNamespace("Common.App.SaveACopy");da.main();Type.registerNamespace("Common.App.PhoneLink");fb.main();Type.registerNamespace("Common.App.SharedFilePicker");kd.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");ij.main();Type.registerNamespace("Common.App.WopiIdentity");pj.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");Re.main();jj.main();Wm.main();Im.main();xo.main();Po.main();e.a.instance.Ac(mc.a(new hi,0));Xr.main();Type.registerNamespace("Common.App.LivePersonaUtils");Kq.main();Kp.main()},326:function(J,V,d){d.d(V,"a",function(){return E});J=d(0);var h=d(1158),e=d(39),m=d(472),n=d(165),v=d(37),A=d(63),w=d(26),y=d(963),u=d(964);class E{constructor(G){this.MG=G}get node(){return this.MG}get propertySet(){return this.MG}get hy(){if(1074135132===this.MG.Oe)return 0;
if(1074135137===this.MG.Oe)return 1;w.a.J(18354962,802,10,"Invalid AppType {0}",m.a[this.MG.Oe]);return-1}get id(){return 0===this.hy?this.propertySet.sa(v.a.HY,null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.sa(v.a.HY,null)}get BXf(){return this.propertySet.sa(e.a.xHd,null)}get visibility(){return this.propertySet.sa(e.a.kTb,!1)}get width(){return this.propertySet.sa(e.a.p8h,320)}get row(){return this.propertySet.sa(e.a.o8h,0)}get Lqg(){return this.propertySet.sa(n.a.isForUILessAction,
!1)}get Wla(){return this.propertySet.sa(e.a.jnb,null)}get version(){return this.propertySet.sa(e.a.vAc,null)}get store(){return this.propertySet.sa(e.a.uAc,null)}get storeType(){return this.propertySet.getValue(v.a.hTb)}get ownerAddinSolutionId(){return this.propertySet.sa(v.a.h2g,null)}get sharedRuntimeId(){return this.propertySet.sa(n.a.sharedRuntimeId,null)}get settings(){const G={};y.a(this.node,(I,H)=>{u.b(H,G)});return G}get slideId(){if(0===this.hy){const G=this.MG.getValue(v.a.sid),I=this.MG.getValue(v.a.cid);
return A.a.bE(G,I)}return null}get shapeId(){const G=Object(h.a)(4,this.MG);return 0===this.hy&&G?G.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.sa(v.a.ownerAddinStoreType,null)}get Gnb(){return this.propertySet.sa(v.a.Gnb,-1)}get d3a(){return this.propertySet.sa(v.a.d3a,null)}}Object(J.a)(E,"AppReader",null,[964])},327:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.none=null;h.goi="CoAuth";h.D4d="IdeasPaneClosed";h.Wdk="MultiSlidesSelected";h.Ieb="Retrigger";
h.Xed="SessionEnded";h.S_k="SessionRehydrated";h.slideNavigation="SlideNavigation";h.JHb="SuggestionPaneClosed";h.wid="SuggestionsLoadingTimeout";h.noSuggestion="NoSuggestion";h.typing="Typing";h.SJb="WebActionId:";h.FMk="Rehydrated";h.MWf="DisallowedRequest";h.cOf="CloseSecondPane";h.eqk="OpenEditorPane";Object(J.a)(h,"DesignerResetReason",null,[])},328:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.invalid="Invalid";h.success="Success";h.error="Error";h.pending="Pending";h.rGa=
"NoResult";Object(J.a)(h,"ProviderResultStatus",null,[])},379:function(J,V,d){J=d(0);class h{static R7i(){return h._nextEventReceiverId++}}h._nextEventReceiverId=0;Object(J.a)(h,"EventReceiverIdCounter",null,[]);d.d(V,"a",function(){return e});class e{constructor(m,n){this.XKh=m;this._id=h.R7i();this.CTh=n}get id(){return this._id}notify(m,n){this.CTh(m,n)}Dba(m,n){return this.XKh.DCk(m,n?this:null)}}Object(J.a)(e,"EventReceiver",null,[891])},529:function(J,V,d){d.d(V,"a",function(){return h});J=
d(0);class h{}Object(J.a)(h,"OnlineMediaSearchResult",null,[])},530:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(375),e=d(229);class m{static b$k(n){return parseInt(m.bRe(e.a.oDf,n)||"-1")<=(new Date).getTime()}static c6f(n){return parseInt(m.bRe(e.a.Xmb,n)||"-1")}static uig(n){return Boolean.parse(m.bRe(e.a.USb,n)||"false")}static bRe(n,v){let A=null;try{const w=m.hMc();if(void 0!==w&&w){const y=e.a.b6f(n)+v;A=w.getItem(y)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(w){h.ULS.sendTraceTag(42074646,
220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",n,v)}return A}static XIb(n,v,A){try{const w=m.hMc();if(void 0!==w&&w){const y=e.a.b6f(n)+A;w.setItem(y,v)}else h.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(w){h.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",n,A)}}static hMc(){if(!m.M1b)return null;let n=null;try{n=localStorage}catch(v){m.M1b=!1,n=null}return n}}m.M1b=
!0;Object(J.a)(m,"AddinUtil",null,[])},531:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.I5j=e;this.p7j=m}get RSc(){return this.I5j}get ETk(){return this.p7j}}Object(J.a)(h,"ReportSuggestionSessionActionData",null,[])},532:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.MYf="Provider.UCI.Editor";h.GYf="EntityGroup.UCI.Editor";h.trh="Provider.Designer.Slide";h.srh="EntityGroup.Designer.Slide.Suggestion";h.Crh="Provider.Designer.TextToSmartArt";
h.Brh="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(J.a)(h,"InfraredConstant",null,[])},674:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(67);class e{constructor(m){this.r8=this.Uja=null;this.ve=m}dispose(){this.clear();this.Uja.parentNode.removeChild(this.Uja)}$ga(m){this.Uja=this.mWb(m,"prContainerHr");this.r8=this.mWb(this.Uja,"prGlyph")}clear(){this.dma()}cIa(m,n){m&&(this.dma(),this.r8.appendChild(m),this.r8.style.backgroundColor=n,this.Uja.style.visibility=h.a.visible)}mWb(m,
n){const v=this.ve.Ee();this.ve.addCssClass(v,n);m.appendChild(v);return v}dma(){this.r8.firstChild&&this.r8.removeChild(this.r8.firstChild)}}Object(J.a)(e,"ShapePawnGlyph",null,[])},681:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=
4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(J.b)("AddinCommandsLaunchOperationType",h)},682:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"ProviderActionInfo",null,[])},683:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=
0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(J.a)(h,"ReplaceObjectSuggestionApplyInfo",null,[])},960:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{static add(e,m,n,v,A){h.GCg[h.R5f(e,m,n,v,A)]=!0}static contains(e,m,n,v,A){return h.R5f(e,m,n,v,A)in h.GCg}static R5f(e,m,n,v,A){return String.format("{0}|{1}|{2}|{3}|{4}",e.toLowerCase(),m,n.toLowerCase(),v.toLowerCase(),A.toLowerCase())}}h.GCg={};Object(J.a)(h,"AppsInsertedStorage",null,[])},961:function(J,V,d){d.d(V,"a",
function(){return h});J=d(0);class h{}Object(J.a)(h,"AppsForOfficeEntitlementQueryInfo",null,[])},962:function(J,V,d){d.d(V,"a",function(){return E});J=d(0);var h=d(101),e=d(1158),m=d(36),n=d(39),v=d(30),A=d(81),w=d(239),y=d(37),u=d(963);class E{static wvi(G,I,H){G=Object(e.a)(A.a,G.createInstance(1074135137));E.nBf(G,I,H);return G}static nZh(G,I){v.GraphIterator.mb(G).hl(I,19)}static nBf(G,I,H){G.setValue(n.a.qAc,0===I.targetType);G.setValue(n.a.jnb,I.solutionId);G.setValue(n.a.vAc,I.version);G.setValue(n.a.iTb,
I.storeType);G.setValue(n.a.uAc,I.storeId);G.setValue(y.a.hTb,H.kEc(I.storeType));I.assetId&&G.setValue(y.a.jAc,I.assetId);G.setValue(y.a.kAc,I.assetStoreId);void 0===I.isAddinCommands?G.setValue(y.a.isAddinCommands,!1):G.setValue(y.a.isAddinCommands,I.isAddinCommands);I.sharedRuntimeId&&-1!==I.backgroundState&&(G.setValue(y.a.Gnb,I.backgroundState),G.setValue(y.a.d3a,I.sharedRuntimeId));0===I.targetType&&(G.setValue(y.a.Nq,!0),H=I.height?I.height:200,G.setValue(m.a.Ex,I.width?I.width:200),G.setValue(m.a.sD,
H))}static rAh(G,I,H){const K=h.a.Sjc(H);u.b(I,Y=>{Y=Y.getValue(n.a.sAc);return!!Y&&!(Y in K)});u.a(I,(Y,M)=>{const P=M.getValue(n.a.sAc);P&&P in K&&(E.Esl(M,K[P],Y),delete K[P])});const C=v.GraphIterator.mb(I);h.a.forEach(K,(Y,M)=>{C.hl(E.xvi(G,Y,M),21)},null)}static xvi(G,I,H){G=Object(e.a)(A.a,G.createInstance(1074135139));G.setValue(n.a.sAc,I);G.setValue(n.a.tAc,H);return G}static Esl(G,I,H){G.setValue(n.a.tAc,I);H.sa(n.a.qAc,!0)?w.d(H,G,E.BWk):w.d(H,G,E.UWk)}}E.BWk=[y.a.sid,y.a.cid,y.a.shapeId];
E.UWk=[n.a.jnb];Object(J.a)(E,"AppEditor",null,[])},963:function(J,V,d){d.d(V,"a",function(){return m});d.d(V,"b",function(){return n});var h=d(30),e=d(964);const m=(v,A)=>{const w=new h.GraphIterator;w.set(v);let y=w.zb(21);for(;y;)e.a(y)&&A(v,y),y=w.uf(21)},n=(v,A)=>{const w=new h.GraphIterator;w.set(v);let y=w.zb(21);for(;y&&y!==v;)y=e.a(y)&&A(y)?w.yOa(21):w.wj(21)}},964:function(J,V,d){d.d(V,"b",function(){return e});d.d(V,"a",function(){return m});var h=d(39);const e=(n,v)=>{const A=n.getValue(h.a.sAc);
n=n.getValue(h.a.tAc);v[A]=n},m=n=>1074135139===n.Oe},965:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m,n=null){super();this.shapeId=e;this.blg=m;this.LX=n}}Object(J.a)(h,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},966:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m=null){super();this.shapeId=e;this.LX=m}}Object(J.a)(h,"ReplaceObjectSuggestionPointerOutEventArgs",Sys.EventArgs,
[])},967:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.DAc=null}}Object(J.a)(h,"IdeasSmartArtSuggestionWrapper",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.chronos2.js.map