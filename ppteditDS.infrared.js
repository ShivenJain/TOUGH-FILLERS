'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1204:function(J,V,d){d.r(V);J=d(0);var h=d(68),e=d(26),m=d(186),n=d(52),v=d(28);class A{constructor(qa,Ja){this.ia=qa;this.ia.pa(v.a.Etj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Ftj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Gtj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Htj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Itj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Jtj,
n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Ktj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.ptj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.qtj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.rtj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.stj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.ttj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.utj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.vtj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.otj,
n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.wtj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.xtj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.ztj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Atj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Btj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Ctj,n.a.application,m.ActionManager.Mu,4);this.ia.pa(v.a.Dtj,n.a.application,m.ActionManager.Mu,4);this.kEg=JSON.parse(Ja.Ha("674"));for(const xa of this.kEg)xa.regex=
new RegExp(xa.pattern)}trackAction(qa){for(const Ja of this.kEg)Ja.regex.test(qa)&&this.ia.processAction(Ja.actionId,2)}}Object(J.a)(A,"IdeasActionTracker",null,[878]);class w{constructor(){this.C$a=this.kqe=this.wpe=null;this.eHj=this.YDl}addSlideSuggestionsListener(qa){this.wpe=qa}addTextToSmartArtSuggestionListener(qa){this.kqe=qa}FFd(qa){this.C$a=qa}notifySlideSuggestion(qa,Ja){this.wpe&&(this.wpe(qa,Ja),e.a.J(512496328,829,50,"data: count: {0}, correlation: {1}",Ja?Ja.suggestions.length:0,Ja?
Ja.correlationId:"0"))}notifyTextToSmartArtSuggestion(qa,Ja){this.kqe&&(this.kqe(qa,Ja),e.a.J(512496327,829,50,"data: count: {0}, correlation: {1}",Ja?Ja.suggestions.length:0,Ja?Ja.correlationId:"0"))}b6c(qa){this.C$a&&this.C$a(qa)}}Object(J.a)(w,"InfraredDesignerServiceProvider",null,[876]);class y{constructor(){this.C$a=null}FFd(qa){this.C$a=qa}b6c(qa){this.C$a&&this.C$a(qa)}}Object(J.a)(y,"InfraredTelemetryListener",null,[875]);var u=d(196),E=d(985),G=d(45),I=d(13),H=d(33);class K{}Object(J.a)(K,
"EntityGroup",null,[]);class C extends K{}Object(J.a)(C,"Idea",K,[]);var Y=d(532);class M{}Object(J.a)(M,"ProviderResult",null,[]);var P=d(328),T=d(428),L=d(427),aa=d(327),Q=d(531),ea=d(25),ia=d(267);class ja{}ja.ixk="PowerPoint";ja.cAl="WAC";Object(J.a)(ja,"ApplicationPropertiesConstants",null,[]);class D{}Object(J.a)(D,"EnterpriseUserInfo",null,[]);class pa{}Object(J.a)(pa,"Message",null,[]);class Z extends pa{}Z.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(J.a)(Z,"PowerPointTextTileChangedMessage",
pa,[]);class oa{}Object(J.a)(oa,"RankerConfiguration",null,[]);class Ba{constructor(qa){this.jRg=qa}KWi(qa,Ja){return new Promise((xa,Ga)=>{this.jRg&&qa&&Ja||Ga("wopiIdentityManager or tokenParameter or clientWoipId is null");this.jRg.getAccessToken(qa,Ja).then(na=>{na?xa(na.accessToken):Ga("auth token is null")},na=>{Ga(na)})})}}Object(J.a)(Ba,"AuthenticationProvider",null,[921]);class Ma{constructor(qa,Ja,xa,Ga,na=""){this.resource=qa;this.scope=Ja;this.silentLogin=xa;this.options=Ga;this.correlationId=
na}}Object(J.a)(Ma,"InfraredTokenParameters",null,[694]);class za{constructor(qa,Ja,xa,Ga,na,sa,Ha,cb,Za){this.OHg=this.Dde=this.P4e=null;this.DHg=!1;this.Fle=null;this.dpe=!1;e.a.J(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.cAb=qa;this.H1j=Ha;this.qje=Za;this.C4j=qa.ka("659");this.R2c=qa.Ha("750");Ha=window.location.hostname;Za=qa.Ha("816");Ha&&0<Ha.length&&Za&&0<Za.length&&0<=Za.toLowerCase().indexOf(Ha.toLowerCase())&&(this.R2c="");this.MTa=Ja;this.E7b=sa;if(this.H$j=
qa.ka("688"))this.OHg=qa.Ha("689"),this.Dde=new Ba(cb);this.MTa.addSlideSuggestionsListener(Object(I.a)(this,this.Dok,"onSlideSuggestion"));this.MTa.addTextToSmartArtSuggestionListener(Object(I.a)(this,this.dpk,"onTextToSmartArtSuggestion"));this.MTa.FFd(Object(I.a)(this,this.MYg,"onIdeasSessionTelemetry"));xa.FFd(Object(I.a)(this,this.MYg,"onIdeasSessionTelemetry"));this.E7b&&this.E7b.execute(va=>{va.xCf(Object(I.a)(this,this.Uue,"onEditorCritiques"))});this.ia=Ga;(this.LS=na)&&this.LS.execute(va=>
{va.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new L.a,{name:"InfraredSlideTextTileLambda",inputSchema:T.a.Nkc,outputSchema:T.a.Nkc,func:(Fa,Ca,La)=>{this.Eok(Fa);La(null)}}))});this.n7k()}get stb(){return this.P4e}n7k(){var qa=JSON.parse(this.cAb.Ha("612"));qa=Object.assign(new oa,{rankingOrder:qa});var Ja=IdeasInfraredConnector,xa=Ja.setup,Ga=e.a.J,na=Object(I.a)(this,this.Ltj,"ideasPaneVisibilityStatusCallback"),sa=this.cAb;const Ha={};Ha.appName=2===ea.AFrameworkApplication.Aa.gb.Am?
ja.ixk:"unknown";Ha.appVersion=ea.AFrameworkApplication.buildVersion;Ha.appPlatform=ja.cAl;Ha.lcid=ea.AFrameworkApplication.lcid;var cb=ia.a.le(ea.AFrameworkApplication.lcid);cb=cb?cb.name:null;const Za=cb.split("-");Ha.market=Za[Za.length-1];Ha.uiLanguage=cb;Ha.sessionId=ea.AFrameworkApplication.userSessionId;Ha.tenantRoot=sa.Ha("748");Ha.shredderServiceEndpoint=sa.Ha("749");this.P4e=xa.call(Ja,qa,Ga,na,Ha,this.H1j,Object(I.a)(this,this.odg,"getShredderServiceAuthTokenPromise"))}Ltj(qa){this.DHg=
qa;(this.MTa.eHj=qa)?(this.ia.processAction(v.a.KIc,2),this.U6g()):this.ia.Ka(v.a.mma,2,new Q.a(!0,aa.a.D4d))}Dok(qa,Ja){const xa=[];xa.push(Object.assign(new C,{providerId:Y.a.trh,groupTypeId:Y.a.srh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ja}));try{this.stb.pushProviderResult(Object.assign(new M,{providerId:Y.a.trh,resultStatus:qa,entityGroups:xa}))}catch(Ga){e.a.J(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
Ga)}"Success"===qa&&(u.a.Va(Ja.suggestions)||this.qje.ikd(0))}dpk(qa,Ja){const xa=[];xa.push(Object.assign(new C,{providerId:Y.a.Crh,groupTypeId:Y.a.Brh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ja}));try{this.stb.pushProviderResult(Object.assign(new M,{providerId:Y.a.Crh,resultStatus:qa,entityGroups:xa}))}catch(Ga){e.a.J(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",Ga)}}MYg(qa){try{this.stb.trackIdeasProviderAction(qa.cardId,
qa.actionType,qa.actionEngagement)}catch(Ja){e.a.J(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",Ja)}}Eok(qa){if(this.C4j)if(qa)if(qa){try{const Ja=H.a(qa.Content);this.uai(this.Fle,Ja)&&(this.Fle=Ja,this.dpe=!0)}catch(Ja){e.a.J(512262818,811,10,"Deserializing tile response failed");return}this.DHg&&this.U6g()}else e.a.J(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else e.a.J(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}uai(qa,
Ja){if(!qa&&Ja||qa&&!Ja)return!0;if(!qa&&!Ja)return!1;if(!qa.drawingElems&&Ja.drawingElems||qa.drawingElems&&!Ja.drawingElems)return!0;const xa=new E.a;for(const Ga of qa.drawingElems)if(qa=Ga.text)for(const na of qa.paragraphs)na&&(G.a.Va(na.id)||G.a.Va(na.chars)||xa.$(na.id,na.chars));for(const Ga of Ja.drawingElems)if(Ja=Ga.text)for(const na of Ja.paragraphs)if(na&&!(G.a.Va(na.id)||G.a.Va(na.chars)||xa.Jb(na.id)&&xa.ga(na.id)===na.chars))return!0;return!1}U6g(){if(this.dpe){try{this.stb.postMessage(Object.assign(new Z,
{messageType:Z.PowerPointTextTileChangedMessageType,data:this.Fle}))}catch(qa){e.a.J(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",qa)}this.qje.ikd(1);this.dpe=!1}}Uue(qa,Ja){try{qa=[],qa.push(Object.assign(new C,{groupTypeId:Y.a.GYf,providerId:Y.a.MYf,notificationConfidence:Ja.Aia?Ja.Aia.notificationConfidence:0,shouldRaiseNotification:Ja.Aia?Ja.Aia.shouldRaiseNotification:!1,confidence:Ja.Aia?Ja.Aia.confidence:0,data:Ja.dYb})),this.stb.pushProviderResult(Object.assign(new M,
{providerId:Y.a.MYf,resultStatus:Ja.Aia?Ja.Aia.resultStatus:P.a.invalid,entityGroups:qa}))}catch(xa){e.a.J(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",xa)}Ja.Aia&&"Success"===Ja.Aia.resultStatus&&Ja.dYb&&!u.a.Va(Ja.dYb.critiques)&&this.qje.ikd(2)}odg(){if(!this.Dde)return e.a.J(512262815,811,50,"authenticationProvider is null"),null;try{if(this.R2c&&0<this.R2c.length)return this.Dde.KWi(new Ma(this.R2c,"user_impersonation",!0,
{}),this.OHg);e.a.J(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(qa){return e.a.J(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",qa),null}}w2i(){return new Promise(qa=>{const Ja=this.cAb.Ha("749"),xa=this.odg();Ja&&Ja.length&&xa?xa.then(Ga=>{Ga&&Ga.length?(Ga=new D,Ga.CountryCode="US",Ga.IsEnabled=!1,Ga.IsEnterpriseEnabled=!0,Ga.IsGoLocal=!1,Ga.ServiceEndpoint=Ja,Ga.TenantRoot="",qa(Ga)):qa(null)},()=>{qa(null)}):
qa(null)})}}Object(J.a)(za,"PPTWebEditorInfraredRuntimeManager",null,[874]);class ka{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Infrared"}Wb(qa){this.K=qa;this.K.register(w,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").ma().na(()=>new w);this.K.register(y,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").ma().na(()=>new y);this.K.register(A,"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").ma().na(()=>
new A(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IAppSettingsManager")));e.a.J(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.K.register(za,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").ma().na(()=>new za(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.K.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),
this.K.resolve("Common.IActionManager"),this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.La("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.K.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const qa=this.K.resolve("Common.IAppSettingsManager");qa.ff(()=>{qa.ka("610")&&(e.a.J(512262811,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),
this.K.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){h.a.instance.Ac(new ka)}}Object(J.a)(ka,"PPTWebEditorInfraredRuntimePackage",null,[2,3]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");ka.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.infrared.js.map