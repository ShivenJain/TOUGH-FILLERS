'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1088:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.w5g="WAC_Powerpoint";h.X1b=null;Object(J.a)(h,"AddinHostApp",null,[])},1102:function(J,V,d){J=d(0);var h=d(13),e=d(1158),m=d(227),n=d(228),v=d(65),A=d(95);class w extends m.a{constructor(M,P){super(M);this.xf=null;this.BH=P.get(8,!1);this.hR=P.get(6,0);this.element=M;this.element.className=w.z5a;this.m2a=this.createElement("ul");this.element.appendChild(this.m2a);
this.tn=P.get(10);this.tn.ob(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.Ko=P.get(9);this.Ko.ob(v.a.pointerOut,this.element,Object(h.a)(this,this.Py,"onPointerOut"));this.Ko.ob(v.a.pointerDown,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior"));this.fM=P.get(13);this.fM.ob(this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior"))}VU(M){this.addHandler(n.a.Qo,M)}S_(M){this.removeHandler(n.a.Qo,M)}get s$(){return this.xf}dispose(){this.element&&
(this.tn.xb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.Ko.xb(v.a.pointerDown,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),this.Ko.xb(v.a.pointerOut,this.element,Object(h.a)(this,this.Py,"onPointerOut")),this.fM.xb(this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(M,P,T){this.hide();!M||0>=M.length||(this.BH?this.element.style.right=P+"px":this.element.style.left=
P+"px",this.element.style.top=T+"px",this.$Fd(M),this.visible=!0)}$Fd(M){this.xf=M;A.a.$t(this.m2a);for(let P=M.length-1;0<=P;P--)this.lz(M[P])}lz(M){const P=document.createElement("li");P.style.backgroundColor=M.color;P.style.height=this.hR+"px";P.id="fly_"+M.clientId;P.style.lineHeight=this.hR+"px";A.a.ix(P,M.userName);P.setAttribute("dir","auto");this.m2a.appendChild(P)}onClick(){this.hide();return!1}Py(M){this.raiseEvent(n.a.Qo,new n.a(3,M));return!1}}w.z5a="prFlyout UIFont";Object(J.a)(w,"PresenceTooltipFlyoutControl",
m.a,[]);var y=d(72);class u extends m.a{constructor(M,P,T){super(M);this.kM=null;this.xf=[];this.element.className="prGlyph";this.Gc=P;this.d6=this.Gc.get(9);this.Vm=this.Gc.get(10);this.fM=this.Gc.get(13);this.l4d();this.lz(T);this.r0a=!1}get ZN(){return this.xf.length}get s$(){return this.xf}VU(M){this.addHandler(n.a.Qo,M)}S_(M){this.removeHandler(n.a.Qo,M)}dispose(){this.YRe();super.dispose()}lz(M){Array.add(this.xf,M);2===this.ZN?this.p$(!0):1===this.ZN?this.p$(!1):this.p$(this.r0a)}BL(M){this.aVd(M)&&
(1<this.ZN&&this.p$(!0),1===this.ZN?this.p$(!1):1>this.ZN&&this.hide())}show(){this.p$(2<=this.ZN);this.visible=!0}hide(){this.visible=!1}kZd(M){return M?this.i_b(0,5):this.i_b(1,4)}aVd(M){for(let P=0;P<this.ZN;P++)if(this.xf[P].clientId===M)return M=this.xf[P],Array.removeAt(this.xf,P),M;return null}p$(M){this.r0a!==M&&(this.kM&&this.element.removeChild(this.kM),this.kM=this.kZd(M),this.element.appendChild(this.kM),this.r0a=M);this.kM.childNodes[0].style.backgroundColor=this.xf[this.xf.length-1].color}i_b(M,
P){const T=this.Gc.get(6,0),L=this.Gc.get(14);return y.createClusteredImageFromClusterWithImageClass(T,T,this.Gc.get(M),this.Gc.get(P),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,L?L.cloneNode(!0):null)}jC(M){3!==M.Vf&&this.raiseEvent(n.a.Qo,new n.a(2,M));return!1}onClick(M){this.raiseEvent(n.a.Qo,new n.a(1,M));return!0}Py(M){3!==M.Vf&&this.raiseEvent(n.a.Qo,new n.a(3,M));return!1}YRe(){this.element&&(this.d6.xb(v.a.pointerDown,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),
this.d6.xb(v.a.pointerOver,this.element,Object(h.a)(this,this.jC,"onPointerOver")),this.d6.xb(v.a.pointerOut,this.element,Object(h.a)(this,this.Py,"onPointerOut")),this.Vm.xb(v.a.doubleClick,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),this.Vm.xb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.fM.xb(this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")))}l4d(){this.element&&(this.d6.ob(v.a.pointerDown,this.element,
Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),this.d6.ob(v.a.pointerOver,this.element,Object(h.a)(this,this.jC,"onPointerOver")),this.d6.ob(v.a.pointerOut,this.element,Object(h.a)(this,this.Py,"onPointerOut")),this.Vm.ob(v.a.doubleClick,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),this.Vm.ob(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.fM.ob(this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")))}}
Object(J.a)(u,"PresenceTooltipGlyph",m.a,[]);var E=d(114);d(62);var G=d(196);class I extends m.a{constructor(M,P,T){super(M);this.xf=[];this.Ll=[];this.yH=0;this.qga=this.K5=!1;this.kKb=null;this.Jfa={};this.Gc=T;this.Qi=T.get(8,!1);this.RF=T.get(11,!1);M=T.get(12,0);this.imageDimension=T.get(6,0);this.Q1a=P;this.element.id=I.P5a();this.element.className=m.a.ypb("prControl",this.Qi);M&&(this.zIndex=M);this.rtl=this.Qi;this.rfb(P);this.az=this.createElement("div");this.az.className=this.RF?"prContainerV":
"prContainerHr";this.element.appendChild(this.az);this.BMb=Array(this.yH);for(P=0;P<this.yH;P++)this.Iv[P]=new w(this.createElement("div"),this.Gc),this.Iv[P].VU(Object(h.a)(this,this.sF,"onInteractivityChanged")),this.element.appendChild(this.Iv[P].element)}get Adb(){return G.a.clone(this.xf)}getGlyph(M){return this.Jfa[M]}get Iv(){return this.BMb}get rSb(){return this.kKb}get CIa(){return this.imageDimension+2}get width(){return this.RF?this.CIa:this.Q1a}get height(){return this.RF?this.Q1a:this.CIa}VU(M){this.addHandler(n.a.Qo,
M)}S_(M){this.removeHandler(n.a.Qo,M)}dispose(){if(this.Iv)for(const M of this.Iv)M.S_(Object(h.a)(this,this.sF,"onInteractivityChanged")),E.a.ex(M);E.a.hed(this.Ll);this.Ll=this.BMb=null;super.dispose()}Bea(){this.ZM();this.ggb();this.visible=!0;this.K5=!1}igb(){!this.Ll||1>this.Ll.length||(this.ZM(),this.visible=!0,this.ggb(),this.aHa(this.Ll[this.Ll.length-1]),this.K5=!0)}swa(){if(this.Ll&&!(1>this.Ll.length)){this.visible=!0;this.ggb();var M=0;for(const P of this.Ll)this.aHa(P,M++);this.K5=!1;
this.qga=!0}}hide(){this.visible=!1;this.ZM();for(let M=0;M<this.Ll.length;M++)this.Ll[M].hide();this.K5=!1}TUb(){if(!this.qga)return!1;let M=0;for(const P of this.Iv)P.visible&&M++;return this.qga=0<M&&(this.xf.length<=this.yH?M===this.xf.length:M===this.yH)}lz(M){if(!(0>=this.yH)){M.clientId||(M.clientId=(I.Pfa++).toString());if(M.clientId in this.Jfa){var P=this.gS(M.clientId);if(0<=P){P=this.xf[P];if(P.color===M.color&&P.userName===M.userName)return;this.BL(M.clientId)}}P=this.TUb();var T=0;if(this.xf.length<
this.yH){var L=new u(this.createElement("div"),this.Gc,M);L.VU(Object(h.a)(this,this.sF,"onInteractivityChanged"));this.Qi&&!this.RF&&0<this.xf.length?this.az.insertBefore(L.element,this.az.firstChild):(this.az.appendChild(L.element),T=this.Ll.length);Array.add(this.Ll,L)}else this.Qi&&!this.RF?L=this.Ll[0]:(T=this.Ll.length-1,L=this.Ll[T]),L.lz(M);L.show();this.Jfa[M.clientId]=L;Array.add(this.xf,M);this.inc(L,T);P&&this.swa()}}BL(M){const P=this.TUb();P&&this.ZM();this.hma(M);this.xf.length>=this.yH&&
this.Ll.length<this.yH&&this.nCe();0>=this.xf.length?this.hide():P&&this.swa()}rcb(){}hma(M){var P=this.gS(M);0>P||(M=this.xf[P],Array.removeAt(this.xf,P),P=this.Jfa[M.clientId],delete this.Jfa[M.clientId],P.BL(M.clientId),this.inc(P),0>=P.ZN&&(this.az.removeChild(P.element),Array.remove(this.Ll,P),P.dispose()))}Nfb(){}nCe(){var M=this.s_d();!M||1>=M.s$.length||(M=Array.clone(this.xf),M.forEach(P=>{this.hma(P.clientId)}),M.forEach(P=>{this.lz(P)}))}gS(M){for(let P=0;P<this.xf.length;P++)if(this.xf[P].clientId===
M)return P;return-1}s_d(){return this.Qi&&!this.RF?this.Ll[0]:this.Ll[this.Ll.length-1]}position(M,P){this.element.style.top=P+"px";this.element.style.left=M+"px"}ggb(){for(let M=0;M<this.Ll.length;M++)this.Ll[M].show()}ZM(){for(let M=0;M<this.yH;M++)this.Iv[M].hide();this.qga=!1}aHa(M,P=0){if(M)if(this.kKb=M,this.RF){const T=this.imageDimension;if(1<M.s$.length)this.Iv[P].show(M.s$,T,this.height-this.imageDimension);else{const L=this.az.children.length;for(let aa=0;aa<this.az.children.length;aa++)M.element===
this.az.children[aa]&&this.Iv[P].show(M.s$,T,this.height-(L-aa)*this.CIa+2)}}else this.Iv[P].show(M.s$,this.width,0)}sF(M,P){var T=Object(e.a)(u,M);T=T?this.aZb(T):-1;if(2===P.type||1===P.type&&-1!==T&&!this.Iv[T].visible)this.aHa(M);else if(1===P.type)this.ZM(),this.K5=!1;else if(3===P.type){if(this.FYb(P.Ti))return;this.K5||this.ZM()}this.raiseEvent(n.a.Qo,P)}FYb(M){M=I.A6a(M);let P=!1;for(const T of this.Iv)if(A.a.$ra(T.element,M)){P=!0;break}return this.az!==M&&A.a.$ra(this.az,M)||P}inc(M,P=0){const T=
this.j7d(M);T&&0>=M.ZN?this.Iv[P].hide():T?this.aHa(M):this.Iv[P].hide()}aZb(M){let P=0;for(const T of this.Ll){if(M===T)return P;P++}return-1}j7d(M){const P=this.aZb(M);return!!this.rSb&&M===this.rSb&&-1!==P&&this.Iv[P].visible}rfb(M){this.yH=M===this.imageDimension?1:Math.floor(M/this.CIa);this.RF?(this.element.style.height=M+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=M+"px",this.element.style.height=this.imageDimension+"px")}static P5a(){return String.format("{0}-{1}",
"presencetooltip",I.Pfa++)}static A6a(M){M=M.lc.rawEvent;return M.relatedTarget||M.toElement}}I.Pfa=0;Object(J.a)(I,"PresenceTooltipControl",m.a,[494,106]);var H=d(218),K=d(283),C=d(264);d.d(V,"a",function(){return Y});class Y{constructor(M){this.Gc=M;this.Gc.WC(10,H.a.instance);this.Gc.WC(9,C.a.instance);this.Gc.WC(6,16);this.Gc.WC(13,K.a.instance)}NEc(M,P){return new I(M,P,this.Gc)}spb(M){return new I(M,16,this.Gc)}}Object(J.a)(Y,"PresenceTooltipFactory",null,[493])},1116:function(J,V,d){J=d(0);
class h{}h.taskPaneWidth=330;Object(J.a)(h,"AppsForOfficeConstants",null,[]);d.d(V,"a",function(){return e});class e{constructor(){this.hV=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.taskPaneWidth=h.taskPaneWidth;this.fU=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings={};this.onTaskPaneClose=null;this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1}}Object(J.a)(e,"FirstPartyAddInOptionalParameters",null,[])},1192:function(J,
V,d){d.d(V,"a",function(){return A});J=d(0);var h=d(82),e=d(119),m=d(25),n=d(93),v=d(243);class A extends h.a{constructor(w,y=!1){super(w,!1,y)}get V3b(){return!1}get lK(){return v.a.uXb+"/modeless"}get Wvb(){return null}set Wvb(w){}get Svb(){return null}set Svb(w){}pj(w,y=null,u=null){this.SJ&&(u.isModal=!1);super.pj(w,y,u)}hide(){if(m.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.pc)this.oBh(),m.AFrameworkApplication.Aa.mw.qo(e.AFrame.u9),
super.hide()}l_h(){const w=m.AFrameworkApplication.Aa.mw,y=m.AFrameworkApplication.Aa.Cr;w.p1(this.lK);w.jpa(this.lK);y.Bc(this.lK).parent=e.AFrame.gj}kpa(){n.FocusManager.XL()&&(super.kpa(),this.l_h(),m.AFrameworkApplication.Aa.mw.TJ(e.AFrame.u9))}meb(){if(n.FocusManager.XL()&&!m.AFrameworkApplication.Xg){const w=n.FocusManager.instance();w.s4(this.lK);const y=w.zP(this.lK);y&&y.qj.fE(null);w.zEb(this.lK)}}Tla(){"DL"===this.cpa||"DP"===this.cpa?super.Tla():m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.ka("WacAutoFitNonModalDialogIsEnabled")?
(this.oBh(),this.dHf()&&this.Yqh(this.pc.clientHeight,this.pc.clientWidth)):this.DF()}DF(){this.Yqh(h.a.hZe,h.a.lZe)}Yqh(w,y){if(this.Svb&&this.Wvb){let u,E;u=v.a.Wec+this.Wvb;E=v.a.Vec+this.Svb;u+w>this.eia()&&(u=this.eia()-w);E+y>this.qra()&&(E=this.qra()-y);this.yhd(u,E)}else super.DF()}m_d(w){if(!w)return null;w.endsWith("px")&&(w=w.substring(0,w.length-2));return v.a.Vub(w)?((w=parseInt(w))||(w=1),w):null}oBh(){if(this.pc&&this.pc.style){var w=this.m_d(this.pc.style.top);w&&(this.Wvb=w-v.a.Wec);
if(w=m.AFrameworkApplication.isRtl?this.m_d(this.pc.style.right):this.m_d(this.pc.style.left))this.Svb=w-v.a.Vec}}}Object(J.a)(A,"ModelessCustomDialog",h.a,[])},1196:function(J,V,d){d.r(V);var h=d(0),e=d(375),m=d(1159),n=d(1160),v=d(13),A=d(1158),w;(function(z){z[z.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";z[z.cloudPolicySettings=1]="cloudPolicySettings";z[z.alternateAuthToken=2]="alternateAuthToken"})(w||(w={}));Object(h.b)("ApplicationFeatureHelperRequestType",w);class y{constructor(){this.message=
null;this.qy=0}}Object(h.a)(y,"HttpRequstToPromiseRejectData",null,[]);var u=d(94),E=d(80),G=d(179),I=d(45);class H{constructor(z,U){this.jb=z;this.Ei=U}LOd(z,U,la,Da=null,Ia=null,Db=null,Ob=null,sc=null){const hc=w[la],Fc=hc+"RequestFailure";u.Health.instance.recordKpiUsage(Fc,0,"jpittsdirects",null);return new Promise((Xc,md)=>{e.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",hc);const Nc=null!=Ob?Ob:this.jb.Ec("ApplicationFeatureHelperRequestQueueTimeout",
15E3),bf=null!=sc?sc:this.jb.Ec("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Ei.FY(z,1,null,this.Z3i(la,Da),Db,1,pe=>{e.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",hc);try{if(void 0===pe||null===pe||void 0===pe.data||null===pe.data||void 0===pe.data.Zd||null===pe.data.Zd){u.Health.instance.recordKpiFailure(Fc,"Invalid RequestSucceededEventArgs",!1,!0,null);let rf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
hc);md(this.Z_b(rf,pe))}else if(pe.data.af!==G.a.Yy){u.Health.instance.recordKpiFailure(Fc,"HttpStatusCode_"+pe.data.af.toString(),!1,!0,null);let rf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",pe.data.af,hc);md(this.Z_b(rf,pe))}else{void 0!==Ia&&null!==Ia&&void 0!==pe.data.mj&&null!==pe.data.mj&&Ia(pe.data.mj);var wf=U(pe.data.Zd);if(wf)e.ULS.sendTraceTag(50622690,3004,
50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",hc),Xc(wf);else{u.Health.instance.recordKpiFailure(Fc,"Parse Failure",!1,!0,null);let rf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",hc);md(this.Z_b(rf,pe))}}}catch(rf){u.Health.instance.recordKpiFailure(Fc,"Unexpected Failure",!1,!0,null),wf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
rf,hc),md(this.Z_b(wf,pe))}},pe=>{if(pe.data){u.Health.instance.recordKpiFailure(Fc,"HttpStatusCode_"+pe.data.af.toString(),!1,!0,null);var wf=I.a.q0d(pe.data.Zd||"No Data");wf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",pe.data.af,wf,hc)}else u.Health.instance.recordKpiFailure(Fc,"Invalid RequestFailedEventArgs",!1,!0,null),wf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
hc);md(this.Z_b(wf,pe))},null,void 0,void 0,Nc,bf)})}Z_b(z,U){const la=new y;la.message=z;la.qy=U&&U.data?U.data.af:-1;return la}Z3i(z,U){const la={};la["x-UserDataSignature"]=this.jb.Ha("UserDataSignature");la["x-LicensingIsEnabled"]=this.jb.ka("LicensingIsEnabled").toString();la["x-CacheIsEnabled"]=this.jb.ka("LicensingRedisIsEnabled").toString();la["x-OcpsIsEnabled"]=this.jb.ka("OcpsIsEnabled").toString();la["x-LicensingAADIdIsEnabled"]=this.jb.ka("LicensingAadIdIsEnabled").toString();0===z&&(la["x-LicenseCheckOnTenantEnabled"]=
this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1).toString(),la["x-SupportUserConsentDependentFeatures"]="true",la["x-AFHUserConsentGroupValue"]="0",la["x-UseShellServiceForUserConsentGroup"]="true",la["x-SMBUserLicensingEnabled"]="true",la["x-AFHPIPLComplianceEnabled"]=E.a.mS(window.location.href,"wd_afhpipl")||"false");if(U)for(let Da of U.keys)la[Da]=U.ga(Da);return la}}Object(h.a)(H,"HttpRequestToPromiseUtility",null,[]);var K=d(25),C;(function(z){z[z.loki=
0]="loki";z[z.augloopACLP=1]="augloopACLP"})(C||(C={}));Object(h.b)("AlternateAuthSupportApp",C);var Y=d(259),M=d(33);class P{constructor(){this.Token=null;this.ExpirationTime=0}}Object(h.a)(P,"WacAlternateAuthToken",null,[]);class T{constructor(z,U){this.Tml=3E5;if(void 0===z||null===z||void 0===U||null===U)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.jb=z;this.Moc=new m.a(n.a.Qr());this.hNb=new H(z,U);void 0!==Y.a.Dce&&null!==Y.a.Dce&&void 0!==Y.a.LVc&&null!==Y.a.LVc&&
0<Y.a.LVc&&(z=new P,z.Token=Y.a.Dce,z.ExpirationTime=Y.a.LVc,this.Moc.$("loki",z))}CXi(){let z=null;this.Moc.Jb(C[0])&&(z=this.Moc.ga(C[0]));return void 0===z||null===z||this.POj(z)?this.VPi():Promise.resolve(z.Token)}POj(z){return z.ExpirationTime-Date.now()<this.Tml}VPi(){const z=new m.a(n.a.Qr());z.$("X-AlternateAuthApp",C[0]);return this.hNb.LOd(this.SPa("/afhs/AlternateAuthHelperHandler.ashx"),Object(v.a)(this,this.Osk,"parseAlternateAuthTokenResponse"),2,z).then(U=>{e.ULS.sendTraceTag(545821456,
3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",C[0]);this.Moc.$(C[0],U);return U.Token},U=>{U=Object(A.a)(y,U);e.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",U.message,U.qy);return null})}Osk(z){let U=null;({Hv:U}=M.d(z));e.ULS.sendTraceTag(545821457,3004,U?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",z);return U}SPa(z){return String.format("{0}{1}?{2}",
this.jb.Ha("WebServiceBase"),z,K.AFrameworkApplication.Zg)}}Object(h.a)(T,"AlternateAuthHelper",null,[465]);var L=d(1022);class aa{constructor(z,U,la){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=z;this.isEnabled=U;this.tierName=la}}Object(h.a)(aa,"FeatureStateChangeArgs",null,[]);var Q=d(214),ea=d(216),ia=d(54),ja=d(101),D=d(113),pa;(function(z){z[z.Enabled=0]="Enabled";z[z.Disabled=1]="Disabled"})(pa||(pa={}));Object(h.b)("FeatureState",pa);var Z=d(55),oa=d(35),Ba=d(87);
class Ma{constructor(z,U,la=null,Da=null,Ia=null){this.oPa=this.LU=this.Mrf=this.iLa=this.gxc=null;this.hNb=new H(z,U);this.jb=z;this.tPh=z.Ec("LicensingMaxRetryAttempts",0);this.Sud=z.ka("IsO365ConsumerHost");this.Rud=z.ka("IsO365CommercialHost");this.Jsc=z.ka("PremiumUpsellIsEnabled");this.aYe=la;this.wyf=Da;this.Ca=Ia;this.hLa=z.ka("LicensingIsEnabled");this.ooa=z.ka("OcpsIsEnabled")&&this.Rud;this.mEd=z.ka("ShowPrivacyDialog")&&!!Da;this.i6e=z.ka("IsAnonymousUser");this.yUd=new Promise(Db=>{Db(!1)});
this.bZa=new Promise(Db=>{Db(!0)});this.nPa=new m.a(n.a.Qr());this.pyc=!0;this.ocf=this.S5i();this.C9d()&&!this.i6e?(void 0!==K.AFrameworkApplication.Aa&&null!==K.AFrameworkApplication.Aa&&(this.gxc=K.AFrameworkApplication.Aa.hU,void 0!==this.gxc&&null!==this.gxc&&(this.iLa=this.gxc.ZAb("WebServiceCall","ApplicationFeatureHelperService"))),this.oPa=this.oRe()):this.oPa=new Promise(Db=>{Db({})});this.oPa.catch(Db=>{e.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(Db))});this.pyc&&(this.Jsc=!1,this.isFeatureEnabled("FreemiumUpsell",
!0).then(Db=>{this.Jsc=this.jb.ka("PremiumUpsellIsEnabled")&&Db;return null}))}S5i(){const z=this.jb.Aw("AllLicensedFeatures")?this.jb.HB("AllLicensedFeatures"):[],U=new L.a;for(let la=0;la<z.length;la++)U.add(z[la]);return U}C9d(){return this.Rud||this.Sud}oRe(z=0,U=!1){e.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",U);const la=Q.a.pz();la&&(la.set("retryAttempt",z.toString()),la.set("forceRefresh",U.toString()),la.set("isO365ConsumerHost",
this.Sud.toString()),la.set("isO365CommercialHost",this.Rud.toString()),la.set("isFreemiumUpsellEnabled",this.Jsc.toString()));u.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",la);u.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",la);void 0!==this.iLa&&null!==this.iLa&&this.iLa.start();let Da=null;U&&(Da=new m.a(n.a.Qr()),Da.$("x-LicensingForceRefresh","true"));this.Mrf=new Date;return(this.hLa?this.hNb.LOd(this.SPa("/afhs/ApplicationFeatureHelperHandler.ashx"),
Object(v.a)(this,this.Rsk,"parseApplicationFeatureHelperResponse"),0,Da,Object(v.a)(this,this.vAk,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(Ia=>{const Db=Object.assign(new Ba.a,{durationMs:this.Ysh()});Db.extendedProperties=la;Db.extendedProperties&&Ia&&(Db.extendedProperties.set("featureCount",ja.a.count(Ia).toString()),Db.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Ia).toString()),Db.extendedProperties.set("msoPremiumBadgeEnabled",
("MsoPremiumBadge"in Ia).toString()),this.LU&&Db.extendedProperties.set("fromCache",(this.LU<this.Mrf).toString()));u.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Db);return Ia},Ia=>{const Db=Object.assign(new Ba.a,{durationMs:this.Ysh()}),Ob=Object(A.a)(y,Ia);if(!Ob)return e.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),u.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",
!1,!0,Db),new Promise((sc,hc)=>{hc(Ia)});Db.extendedProperties=la;Db.extendedProperties&&Db.extendedProperties.set("status",Ob.qy.toString());u.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Db);return 408===Ob.qy&&++z<=this.tPh?this.oRe(z):new Promise((sc,hc)=>{hc(Ob)})})}Rsk(z){(z=M.b(z))?(e.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),e.ULS.sendTraceTag(50938594,3004,50,"{0}",z)):e.ULS.sendTraceTag(50436171,
3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return z.Features}SPa(z){var U=String.format("{0}{1}",this.jb.Ha("WebServiceBase"),z);this.jb.Aw("ApplicationFeatureHelperHttpCachingEnabled")&&this.jb.ka("ApplicationFeatureHelperHttpCachingEnabled")&&(z=Ma.iMc(this.jb))&&0<z.length&&(this.pyc&&(z+="ucbf"),U=new ea.QueryStringBuilder(U),U.Hi("afhskey",z),U=U.toString());return U}isFeatureEnabled(z,U){if(!this.ooa&&!this.mEd&&!this.hLa)return this.bZa;
e.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",z);if("ConnectedServices"===z){var la=this.ooa?this.aYe.k2("ControllerConnectedServicesEnabled"):this.bZa;const Db=this.mEd?this.wyf.getSettings().then(Ob=>2!==Ob.AB,()=>U):this.bZa;return la.then(Ob=>Ob?Db:this.yUd)}la=null;la=this.ooa?this.aYe.isFeatureEnabled(z):this.bZa;let Da=null;Da=this.hLa?this.GFj(z,U):this.bZa;let Ia=null;Ia=this.mEd?this.wyf.isFeatureEnabled(z):
this.bZa;return la.then(Db=>Db?Ia.then(Ob=>Ob?Da:this.yUd):this.yUd).then(Db=>{this.LAg(z,Db,!0);return Db},()=>{this.LAg(z,U,!1);return U})}LAg(z,U,la){e.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",z,U,la)}getFeatureTier(z,U){if(!this.hLa)return new Promise(la=>{la(2)});e.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",z);return this.oPa.then(la=>this.ENc(z,la,U),()=>U)}isFreemiumUpsellEnabled(){return this.Jsc&&
this.Sud&&!this.i6e}launchUpsellExperience(z,U=null){e.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",z));var la=Q.a.pz();la&&(la.set("experienceId",z),U&&la.set("campaignId",U));u.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",la);if(la=Z.a.instance.pb("Common.IInProductMessagingUIManager")){const Da=Object(v.a)(this,this.Lkj,"handleDimeTaskComplete");la.pzg(z,Da,U)}else e.ULS.sendTraceTag(594367561,
3004,15,"InProductMessaging was not initialized"),u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Ca.Ka(oa.a.VJc,2,{["experience"]:z})}deb(z,U){if(!this.hLa)return null;if(!z||!U)return e.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const la=D.a.create().toString();this.nPa.Jb(z)||this.nPa.$(z,new m.a(n.a.Qr()));this.nPa.ga(z).add(la,U);e.ULS.sendTraceTag(594564812,
3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",la,z));return la}uEb(z,U){this.hLa&&(z&&this.nPa.Jb(z)?U&&D.a.isValid(U)?this.nPa.ga(z).Jb(U)?(e.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",U,z)),this.nPa.ga(z).remove(U)):e.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",
U,z)):e.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",U,z)):e.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",z)))}ENc(z,U,la){return this.pyc?z in U?U[z].LicenseTier:la:z in U?this.ytk(U[z],la):la}ytk(z,U){switch(z.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;
default:return U}}Lkj(){e.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.oPa.then(z=>{this.Lah(z)}).catch(()=>{this.Lah({})})}Lah(z){e.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const U=this.oRe(0,!0);U.then(la=>{this.oPa=U;ja.a.count(la)>ja.a.count(z)?u.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",
!1,!0,null);for(let Da of this.nPa.keys)if(Da in la){const Ia=this.ENc(Da,la,0);Da in z?this.ENc(Da,z,0)!==Ia&&this.rte(Da,!0,Ia):this.rte(Da,!0,Ia)}else Da in z&&this.rte(Da,!1,this.ENc(Da,z,0))}).catch(la=>{u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);e.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(la))})}rte(z,U,la){e.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
z,U,la);U=new aa(z,U,la);la=this.nPa.ga(z);for(let Da of la)try{Da.value(U)}catch(Ia){e.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",z,Da.key,Ia.message))}}FFj(z,U){if(this.hLa){const la=this.ocf.contains(z);let Da=!0,Ia="",Db=!1;return this.oPa.then(Ob=>{z in Ob?(Ob=Ob[z],Ia=pa[Ob.FeatureState],Da=1!==Ob.FeatureState):Da=!la;this.VAg(z,la,Ia,Db,U,Da);return Da},
()=>{Db=!0;la&&(Da=U);this.VAg(z,la,Ia,Db,U,Da);return Da})}return this.bZa}VAg(z,U,la,Da,Ia,Db){e.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",z,U,Da,la,Ia,Db)}GFj(z,U){if(this.pyc)return this.FFj(z,U);if(this.hLa){if(this.ocf.contains(z))return this.oPa.then(la=>z in la,()=>U);e.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
z)}return this.bZa}vAk(z){try{z&&"Date"in z&&(this.LU=new Date(z.Date),e.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.LU.toString()))}catch(U){e.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",U)}}Ysh(){if(void 0!==this.iLa&&null!==this.iLa){const z=this.iLa.Dq;this.iLa.stop();return z}return null}static iMc(z){try{if(ia.a.bOe){const U=z.Ha("UserDataSignature").split(".");if(1<U.length){const la=
window.self.atob(U[1]),Da=JSON.parse(la).LocalStorageKey;if(void 0!==Da&&null!==Da&&0<Da.length)return Da}}}catch(U){e.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",U.toString())}return null}}Object(h.a)(Ma,"ApplicationFeatureHelper",null,[466]);var za=d(17);class ka{constructor(z,U){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=z.PolicySettings;z=new Date;z.setMinutes(z.getMinutes()+U);this.ExpirationTime=z.getTime()}}Object(h.a)(ka,"CloudPolicySettingsCacheData",
null,[]);var qa=d(417),Ja=d(230),xa=d(279);class Ga{static Rqh(){return K.AFrameworkApplication.fa.ka("SideCarIsEnabled")?Ga.qed&&Ga.IRc?new Promise(z=>{z(!0)}):new Promise((z,U)=>{Ga.qed=xa.a.create(K.AFrameworkApplication.fa.Ha("SideCarUrl"));Ja.a.wx(Ga.qed);Ga.qed.HR((la,Da)=>{(Ga.IRc=Da.succeeded)?z(Da.succeeded):U(Da.succeeded)})}):new Promise(z=>{z(!1)})}}Ga.IRc=!1;Ga.qed=null;Object(h.a)(Ga,"SideCarLoader",null,[]);class na{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=
null}}Object(h.a)(na,"CloudPolicySettingsData",null,[]);class sa{constructor(z,U){this.xpd=0;this.pDc=null;this.hNb=new H(z,U);this.jb=z;U=z.Ha("HostAuthType");this.ooa=z.ka("OcpsIsEnabled")&&z.ka("IsO365CommercialHost")&&!(void 0===U||null===U)&&"aad"===U.toLowerCase();this.cff=M.b(z.Ha("OcpsDefaultSettings")||"{}");this.COb=this.iMc();U=this.jb.Aw("ServicesControlsMicrosoftControllerServicesList")?this.jb.HB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Ypc=new L.a;for(let la=0;la<
U.length;la++)this.Ypc.add(U[la]);this.ooa&&!z.ka("IsAnonymousUser")&&z.ka("SideCarIsEnabled")?this.pDc=this.cql():this.pDc=this.nRe(this.ooa,this.SPa("/afhs/CloudPolicySettings.ashx"),Object(v.a)(this,this.Ysk,"parseCloudPolicySettingsResponse"));this.pDc.then(()=>null).catch(la=>{e.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(la))})}k2(z,U=!0){if(!this.ooa){const Db=this;return new Promise(Ob=>{Ob(Db.M_b(z))})}let la=this,Da=this;const Ia=this.pDc.then(Db=>{try{let Ob=null;Db.PolicySettings&&
"unknown"in Db.PolicySettings&&(Ob=Db.PolicySettings.unknown);if(Ob){if(z in Ob&&void 0!==Ob[z]&&null!==Ob[z])return new Promise(hc=>{hc("0"!==Ob[z])});const sc=z.toLowerCase();if(sc in Ob&&void 0!==Ob[sc]&&null!==Ob[sc])return new Promise(hc=>{hc("0"!==Ob[sc])});e.ULS.sendTraceTag(51512667,3004,50,"Policy"+z+" not found, using default");return new Promise(hc=>{hc(la.M_b(z))})}return new Promise(sc=>{sc(la.M_b(z))})}catch(Ob){return e.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+z+" policy value. Error Message: {0}",
Ob.message),la.handleError(Ob.toString(),U,la.M_b(z))}},Db=>Da.handleError(Db,U,Da.M_b(z)));Ia.then(Db=>{e.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",z,Db);return null});return Ia}isFeatureEnabled(z,U=!0){if(this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.IFj(z,U);let la=new Promise(Ia=>{Ia(!0)}),Da="";this.Ypc.contains(z)&&(Da="ControllerConnectedServicesEnabled",
la=this.k2(Da,U));la.then(Ia=>{e.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",z,Ia,Da);return null});return la}IFj(z,U=!0){let la=new Promise(Ia=>{Ia(!0)}),Da="";"mso_sendASmile"===z?Da="Enabled":"Survey"===z||"FloodgateSurvey"===z?Da="SurveyEnabled":this.Ypc.contains(z)&&(Da="ControllerConnectedServicesEnabled");""!==Da&&(la=this.k2(Da,U));la.then(Ia=>{e.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
z,Ia,Da);return null});return la}handleError(z,U,la){return U?new Promise(Da=>{Da(la)}):new Promise((Da,Ia)=>{Ia(z)})}nRe(z,U,la){if(!z)return Promise.resolve(new na);let Da=!1,Ia=null;u.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let Db=this.oOd("GetCloudPolicySettings");return(new Promise((Ob,sc)=>{if(void 0!==this.COb&&null!==this.COb&&0<this.COb.length){const hc=this.Jpl();if(void 0!==hc&&null!==hc){Da=!0;Ob(hc);return}}this.hNb.LOd(U,la,1,null,Object(v.a)(this,
this.CAk,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.jb.Ec("CloudPolicySettingsRequestQueueTimeout",15E3),this.jb.Ec("CloudPolicySettingsRequestSentTimeout",3E4)).then(hc=>{e.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Oql(hc);Ob(hc);return hc},hc=>{sc(hc);return null})})).then(Ob=>{({Wx:Db,returnValue:Ia}=this.Yhd(Db));var sc=Q.a.pz();sc&&sc.set("FromCache",Da.toString());sc=Object.assign(new Ba.a,{durationMs:Ia,extendedProperties:sc});
u.Health.instance.recordKpiSuccess("GetCloudPolicySettings",sc);return Ob})}cql(){return Ga.Rqh().then(()=>{e.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}SPa(z){return String.format("{0}{1}",this.jb.Ha("WebServiceBase"),z)}Ysk(z){let U=null;({Hv:U}=M.d(z));e.ULS.sendTraceTag(50622687,3004,U?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",
z);return U}CAk(z){try{if(void 0!==z&&null!==z&&"CheckIn-Interval"in z){const U=parseInt(z["CheckIn-Interval"]);void 0!==U&&null!==U&&0<U&&(this.xpd=U)}}catch(U){e.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",U)}}M_b(z){return z in this.cff?"0"!==this.cff[z]:!0}Jpl(){try{const z=qa.a.instance.getItem(this.COb);if(void 0===z||null===z)return e.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;
e.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",z);const U=JSON.parse(z);if(void 0===U||null===U)return e.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===U.ExpirationTime||null===U.ExpirationTime)return e.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(U.ExpirationTime)).getTime()<
Date.now())return e.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const la=new na;la.PolicySettings=U.PolicySettings;la.ControllerConnectedServicesFeatureNames=new za.a;this.jb.Aw("ServicesControlsMicrosoftControllerServicesList")&&this.jb.HB("ServicesControlsMicrosoftControllerServicesList");for(let Da of this.Ypc)la.ControllerConnectedServicesFeatureNames.add(Da);e.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");
return la}catch(z){return e.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",z.toString()),null}}Oql(z){try{if(void 0===z||null===z||void 0===z.PolicySettings||null===z.PolicySettings)e.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.xpd)e.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const U=new ka(z,this.xpd),la=JSON.stringify(U);
e.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",la);qa.a.instance.setItem(this.COb,la);e.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(U){e.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",U.toString())}}iMc(){const z=Ma.iMc(this.jb);return z&&0<z.length?"OCPS"+z:null}oOd(z){const U=Z.a.instance.pb("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==
U&&null!==U?U.wi("WebServiceCall",z):null}Yhd(z){if(void 0!==z&&null!==z){const U=z.Dq;z.stop();return{returnValue:U,Wx:null}}return{returnValue:null,Wx:z}}}Object(h.a)(sa,"CloudPolicySettingsHelper",null,[463]);class Ha{constructor(){this.NXf=this.VCh=this.AB=0;this.OXf=this.WCh=this.a4a="";this.kCd=this.sxa=2}clone(){const z=new Ha;z.AB=this.AB;z.VCh=this.VCh;z.NXf=this.NXf;z.a4a=this.a4a;z.WCh=this.WCh;z.OXf=this.OXf;z.sxa=this.sxa;z.kCd=this.src;return z}get src(){return this.kCd}serialize(z=
null){const U={};if(!z||z.contains(Ha.Dcb))U[Ha.Dcb]=this.AB;if(!z||z.contains(Ha.Gcc))U[Ha.Gcc]=this.a4a;if(!z||z.contains(Ha.Hcc))U[Ha.Hcc]=this.sxa;return JSON.stringify(U)}static create(z,U=null){const la=new Ha;la.kCd=z;void 0!==U&&null!==U&&(Ha.Dcb in U&&(la.AB=U[Ha.Dcb]),Ha.Gcc in U&&(la.a4a=U[Ha.Gcc]),Ha.Hcc in U&&(la.sxa=U[Ha.Hcc]));return la}static deserialize(z,U){try{const la=JSON.parse(z);if(void 0!==la&&null!==la)return Ha.create(U,la);e.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
z);throw Error.argument("settingsData");}catch(la){throw e.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",la.toString()),la;}}}Ha.Dcb="CCS";Ha.Gcc="CCSTime";Ha.Hcc="OfficePrivacyRoamedNoticeShown";Object(h.a)(Ha,"UserPrivacySettings",null,[]);var cb=d(213);class Za{constructor(z,U){if(void 0===z||null===z||void 0===U||null===U)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.jb=z;this.Ei=U;this.ABd=this.Gc=null}SPa(z){var U=String.format("{0}RoamingServiceHandler.ashx?action=",
this.jb.appSettings.RoamingServiceHandlerWebServiceBase||"");U=new Sys.StringBuilder(U);U.append(z);U.append("&");U.append(K.AFrameworkApplication.Zg);return U.toString()}executeRequest(z,U,la,Da=null){return this.Ei.Fmb(z,U,Da,null,2,la,"33",!1,null,6E4)}saveSettings(z){return new Promise((U,la)=>{try{if(void 0===this.Gc||null===this.Gc||void 0===z||null===z)e.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),la("Can't determine setting changes to save");
else{var Da=this.Gc.AB!==z.AB;if(2===this.Gc.src&&Da)this.BXk(z),U(!0);else{var Ia=this.C_k(z);if(void 0===Ia||null===Ia||!Ia.length)e.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),la("No changes to save");else if(1===this.Gc.src)U(this.Nyh(Ia));else if(0===this.Gc.src){e.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Ia);const Db=this.executeRequest(this.SPa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
Ia);Db.continueWith(()=>{if(Db.Dn||Db.Wl)e.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),U(!1);else{var Ob=Db.result;void 0!==Ob.Ri&&null!==Ob.Ri&&void 0!==Ob.Ri.data&&null!==Ob.Ri.data&&Ob.Ri.data.af===G.a.Yy?(e.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),U(!0)):(e.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),U(!1))}})}}}}catch(Db){e.ULS.sendTraceTag(50860930,3004,
10,"SaveUserPrivacySettings: Exception = {0}",Db.toString()),U(!1)}})}C_k(z){if(void 0===this.Gc||null===this.Gc||void 0===z||null===z)throw Error.invalidOperation("User Privacy settings have not been initialized");const U=new za.a;0===z.src?(this.Gc.AB!==z.AB&&(U.add(Ha.Dcb),U.add(Ha.Gcc)),this.Gc.sxa!==z.sxa&&U.add(Ha.Hcc)):1===z.src&&this.Gc.AB!==z.AB&&U.add(Ha.Dcb);return U.count?z.serialize(U):(e.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.ABd){const z=
this;this.ABd=new Promise(U=>{try{z.Gc?U(z.Gc.clone()):z.Spl().then(la=>{z.Gc=la;U(z.Gc.clone());return null},()=>{z.Qpl().then(la=>{z.Gc=la;U(z.Gc.clone());return null},()=>{z.Rpl().then(la=>{z.Gc=la;U(z.Gc.clone());return null},()=>{e.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");z.Gc=new Ha;U(z.Gc.clone());return null});return null});return null})}catch(la){e.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
la.toString()),z.Gc=new Ha,U(z.Gc.clone())}})}return this.ABd}Spl(){return new Promise((z,U)=>{try{const Da=-1!==window.location.href.indexOf("&wd_pn=2");if(this.jb.ka("PrivacyDialogShouldCheckRoaming")||Da){var la=this.executeRequest(this.SPa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");la.continueWith(()=>{try{if(la.Dn||la.Wl)e.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const Ia=la.result;if(Ia&&Ia.Ri&&Ia.Ri.data)if(Ia.Ri.data.af!==
G.a.Yy)e.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Ia.Ri.data.af);else{if(Ia.Ri.data.Zd){z(Za.parse(Ia.Ri.data.Zd,0));e.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Ia.Ri.data.Zd);return}e.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else e.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
U("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Ia){e.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Ia.toString()),U("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else e.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),U("Roaming should not be used")}catch(Da){e.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
Da.toString()),U("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Qpl(){return new Promise((z,U)=>{try{const la=cb.a.get("WacUPToggleState");let Da=null;void 0!==la&&null!==la&&0<la.length&&(Da=decodeURIComponent(la));if(void 0!==Da&&null!==Da&&0<Da.length){const Ia=Za.parse(Da,1);e.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Ia.toString());z(Ia)}else{const Ia=Ha.create(1),Db=new za.a;Db.add(Ha.Dcb);const Ob=Ia.serialize(Db);
this.Nyh(Ob)?(e.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Ob),z(Ia)):(e.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Ob),U("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(la){e.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",la.toString()),U("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}Rpl(){return new Promise(z=>
{try{var U=-1!==window.location.href.indexOf("&wdccsoff=1");let la=Ha.create(2);U?(la.AB=2,K.AFrameworkApplication.BWf(),e.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",la.toString())):(la.AB=1,e.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",la.toString()));z(la)}catch(la){e.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",la.toString()),
U=Ha.create(2),U.AB=1,z(U)}})}BXk(z){e.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===z.AB?K.AFrameworkApplication.BWf():K.AFrameworkApplication.WJi();e.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",z)}Nyh(z){try{e.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",z);const U=this.jb.Ha("PrivacyCookieDomain")||"";if(!U||!U.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
e.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",z);return cb.a.Lmh("WacUPToggleState",z,cb.a.rL,U)}catch(U){return e.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",U.toString()),!1}}isFeatureEnabled(z){return this.getSettings().then(U=>{const la=this.jb.Aw("ServicesControlsMicrosoftControllerServicesList")?this.jb.HB("ServicesControlsMicrosoftControllerServicesList"):[],Da=new L.a;for(let Ia=0;Ia<la.length;Ia++)Da.add(la[Ia]);return Da.contains(z)?
2!==U.AB:!0},()=>{e.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",z);return!0})}static parse(z,U){try{return e.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",z,U),Ha.deserialize(z,U)}catch(la){throw e.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",la.toString()),la;}}}Object(h.a)(Za,"UserPrivacySettingsHelper",null,[464]);var va=d(68);class Fa{constructor(){this.Da=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Wb(z){this.Da=
z;this.Da.register(463,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ma().na(()=>new sa(K.AFrameworkApplication.fa,K.AFrameworkApplication.He));this.Da.register(464,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ma().na(()=>new Za(K.AFrameworkApplication.fa,K.AFrameworkApplication.He));this.Da.register(465,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ma().na(()=>new T(K.AFrameworkApplication.fa,K.AFrameworkApplication.He));this.Da.register(466,
"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ma().na(()=>new Ma(K.AFrameworkApplication.fa,K.AFrameworkApplication.He,this.Da.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Da.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),K.AFrameworkApplication.Ta))}init(){K.AFrameworkApplication.fa.ff(()=>{const z=this.Da.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");K.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&
(z.isFeatureEnabled("LicensingTestFeature",!1).then(U=>{e.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",U,K.AFrameworkApplication.fa.Ha("IsAnonymousUser"));return null}),z.getFeatureTier("LicensingTestFeature",0).then(U=>{e.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",U,K.AFrameworkApplication.fa.Ha("IsAnonymousUser"));
return null}));this.Da.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.Rkl()})}dispose(){}Rkl(){try{K.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&Ga.Rqh().then(z=>{e.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",z);return z})}catch(z){}}static main(){va.a.instance.Ac(new Fa)}}Object(h.a)(Fa,"ApplicationFeatureHelperPackage",null,[2,3]);var Ca=d(504),La=d(6);class nb{constructor(z,U){this.Ei=z;this.NC=U}gx(z,U,la,
Da=null){return this.HHi(z,Da,Ia=>this.Ei.Fmb(Ia,2,la,U,2,void 0,void 0,void 0,void 0,void 0,"2"))}HHi(z,U,la){const Da=!!U&&""!==U;let Ia=z;Da&&(Ia=E.a.J2a(z,"perfTag",U));const Db=new Date;return Ca.a.then(la(Ia),Ob=>{const sc=+new Date-+Db;if(!Ob||!Ob.Ri||!Ob.Ri.data)return Ob;Da&&Ob.Ri.data.request&&this.VZk(Ob.Ri.data.request.getResolvedUrl(),U,sc);return Ob})}VZk(z,U,la){z=this.NC.laj(z);if(z.count&&(z=La.last(z))){const Da={Message:"Request durations for activities calls."};Da.PerfTag=U;Da.CustomDuration=
la;Da.PerformanceDuration=z.duration;e.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Da))}}}Object(h.a)(nb,"CatchUpNetworkingWrapper",null,[686]);var Nb=d(368);class Rb extends Nb.a{constructor(z,U){super(z,U)}Ik(){return 6}}Object(h.a)(Rb,"GetActivityFeedRequest",Nb.a,[]);class Ya extends Nb.a{constructor(z,U,la,Da,Ia,Db){super(z,U);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=la;this.ActivityStatesToSet=Da;this.ActivityStatesToReset=
Ia;this.ResetUnseenCount=Db}Ik(){return 7}}Object(h.a)(Ya,"UpdateActivityFeedStateRequest",Nb.a,[]);var Qb=d(518);class bb{constructor(z,U,la){this.xef=z;this.$Za=U;this.j_a=la}getActivityFeed(z){return Ca.a.then(this.j_a.execute(new Rb(this.$Za(),null),(U,la,Da)=>this.xef.gx(U,la,Da,"ActivityFeed"),z),U=>{if(!U)return e.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!U.Ri)return e.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!U.Ri.data)return e.ULS.sendTraceTag(572846939,
3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!U.Ri.data.Zd)return e.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;U=Qb.a.z4a(U.Ri.data.Zd);return U?U:(e.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}Jsl(z,U,la,Da,Ia){return Ca.a.then(this.j_a.execute(new Ya(this.$Za(),null,U,la,Da,Ia),(Db,Ob,sc)=>this.xef.gx(Db,Ob,sc,"UpdateActivityFeedState"),z),Db=>{try{return Db.succeeded}catch(Ob){return e.ULS.sendTraceTag(523121054,
3012,10,"UpdateActivityFeed: Exception: "+Ob.message),!1}})}}Object(h.a)(bb,"CatchUpRequestHandler",null,[685]);var Bb=d(208);class Eb{constructor(z){this.Mlb=z;this.Qcf=new Bb.a}hVj(){this.ZVj()}ZVj(){if(this.Mlb){var z=U=>{this.Qcf.contains("CatchUpChangesFeedback")||(this.Qcf.add("CatchUpChangesFeedback"),U.logActivity("CatchUpChangesFeedback",null))};this.Mlb.execute(U=>{window.setTimeout(()=>{z(U)},2E4)})}else e.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}
Object(h.a)(Eb,"FloodgateEventLogger",null,[]);class tb{constructor(z){this.XRh=z}get duration(){return this.XRh.duration}}Object(h.a)(tb,"PerformanceResourceTimingWrapper",null,[]);class Yb{constructor(z){this.NC=z}laj(z){const U=new za.a;if(!this.NC)return U;z=this.NC.getEntriesByName(z,"resource");if(!z)return U;for(const la of z)U.add(new tb(la));return U}}Object(h.a)(Yb,"PerformanceWrapper",null,[]);class Tc{constructor(){this.Da=null}get name(){return"Common.App.CatchUpActivity"}Wb(z){this.Da=
z;this.Da.register(nb,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").ma().na(()=>new nb(K.AFrameworkApplication.He,new Yb(window.performance)));this.Da.register(bb,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").ma().na(()=>new bb(this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>K.AFrameworkApplication.Zg,new Qb.a));this.Da.register(Eb,"Common.App.CatchUpActivity.FloodgateEventLogger").ma().na(()=>
new Eb(this.Da.La("Common.ISystemInitiatedFeedback")))}init(){this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.Da.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){va.a.instance.Ac(new Tc)}}Object(h.a)(Tc,"CatchUpActivityPackage",null,[2,3]);var ib=d(1157),Zb=d(103);class Cc{constructor(z,U,la){this.KLe=this.LLe=this.MLe=!1;this.XLe=!z&&!U;this.YLe=!z&&!la;this.XLe||this.YLe||(this.MLe=!z,this.LLe=!U,this.KLe=!la)}}Object(h.a)(Cc,"RenameDisabledDialogInfo",
null,[]);class ob extends Zb.StandardDialog{constructor(z,U,la,Da,Ia){super();this.lPe=[];this.a1=new Cc(z,U,la);this.BMa=Da;this.bLa=Ia;this.kg="RenameDisabledDialog";this.vd=0;this.Re(1,CommonUIStrings.l_DialogClose);this.T5k();this.vRk()}T5k(){this.a1.XLe?this.Bkc(this.BMa?this.bLa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.a1.YLe?this.Bkc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):
this.Z_h();this.Syc(this.lPe)}Bkc(z){Array.add(this.lPe,z)}Z_h(){const z=[];this.a1.MLe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.a1.LLe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.a1.KLe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<z.length&&Array.add(this.lPe,z)}}Object(h.a)(ob,"ReactRenameDisabledDialogBase",Zb.StandardDialog,[]);class cc extends ob{constructor(z,U,la,Da,Ia){super(z,U,la,Da,Ia)}vRk(){this.aBb(CommonUIStrings.l_RenameFileRenameDisabledTitle,
null,null,null,null,null)}}Object(h.a)(cc,"ReactRenameDisabledDialog",ob,[]);var sb=d(82);class mb{static get jg(){return sb.a.EB(mb.Zn,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}mb.Zn="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(h.a)(mb,"RenameDisabledDialogHtml",null,[]);class Pb extends sb.a{constructor(z,U,la,Da,Ia){super();this.a1=new Cc(z,U,la);this.BMa=Da;this.bLa=Ia;this.kg="RenameDisabledDialog";this.vd=0;this.Re(1,CommonUIStrings.l_DialogClose);this.jg=mb.jg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.J4("RenameRow")}Wua(){if(this.a1.XLe){let z;z=this.BMa?this.bLa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Pb.Bkc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),z)}else this.a1.YLe?Pb.Bkc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.jsj()}jsj(){this.a1.MLe&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.a1.LLe&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.a1.KLe&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Bkc(z,U,la){z.style.display="none";U.innerText=la}}Object(h.a)(Pb,"RenameDisabledDialog",sb.a,[]);var dc=d(69);class mc{constructor(z,U){this.O0a=0;this.Ca=z;this.Mna=U}initialize(z){if(!this.Ca||!this.Mna)return!1;this.O0a=z;this.ub();return!0}ub(){this.Ca.xa(oa.a.bNd,dc.a.frame,Object(v.a)(this,this.bNd,"commitNewDocumentTitle"))}bNd(z,U,la,Da,Ia){if(1===la)return this.Ca.processAction(oa.a.renameFile,
1);z=I.a.lG(this.Mna.ux);Ia=(0,Ia.getNewDocumentTitle)();Ia.length>this.O0a&&(Ia=Ia.substr(0,this.O0a));if(32!==this.Ca.Ka(oa.a.renameFile,2,Ia))return this.wJb(z),8;this.wJb(Ia);return 32}wJb(z){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(z))}static GB(){return new mc(K.AFrameworkApplication.Ta,K.AFrameworkApplication.fu)}}Object(h.a)(mc,"ReactRenameUIHandler",null,[695]);var Mb=d(262),Kc=d(656),gc=d(564),rb=d(65),Ua=d(177),pb=d(264),Ub=d(131),Bc=d(62);class Gc{constructor(z,U,la,
Da,Ia,Db,Ob,sc,hc,Fc,Xc,md){this._initialized=!1;this._element=null;this.O0a=0;this.lBd=this.ytd=!1;this.Ca=z;this.God=U;this.Ig=la;this.Ko=Da;this.Mna=Ia;this.btf=Db;this.ywc=Ob;this.Cpd=sc;this.Yna=hc;this.N8e=Fc;this.$i=Xc;this.uud=md}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(z,U,la){if(!(this.Ca&&this.Mna&&this.btf&&this.ywc&&this.Cpd&&U)||0>=z)return!1;this._element=U;this._element.title=la;this._element.setAttribute(Ub.a.We,Ub.a.Xt);this._element.setAttribute("Unselectable",
"on");this.O0a=z;this.$I();return this._initialized=!0}$I(){this.God&&(this.God.ob(rb.a.blur,this._element,Object(v.a)(this,this.onBlur,"onBlur")),this.God.ob(rb.a.paste,this._element,Object(v.a)(this,this.zmk,"onPaste")));this.Ig.ob(rb.a.eg,this._element,Object(v.a)(this,this.onKeyDown,"onKeyDown"));this.Ko.ob(rb.a.pointerDown,this._element,Object(v.a)(this,this.Zua,"onPointerDown"));this.Ko.ob(rb.a.GQ,this._element,Object(v.a)(this,this.Pve,"onPointerUp"))}onBlur(){this.isActive&&!this.ytd&&(this.N8e||
this.Cpd(this._element),this.gPf(),this.nQd(!1));return this.ytd=!1}zmk(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(z){return this.isActive?this.glk(z):this.hlk(z)}glk(z){let U=!1;switch(z.lc.keyCode){case Sys.UI.Key.enter:this.gPf();this.nQd(this.$i||this.uud);U=!0;break;case Sys.UI.Key.tab:this.N8e&&this.Cpd(this._element);break;case Sys.UI.Key.esc:this.hFe(),this.nQd(this.$i||this.uud),U=!0}return U}hlk(z){let U=!1;switch(z.lc.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Hxh(this.uud),
this.isActive&&this.ywc(this._element),U=!0}return U}Zua(){this.isActive||(this.Hxh(!1),this.isActive&&(this._element.focus(),this.ywc(this._element),this.lBd=!0));return!1}Pve(){return this.lBd?(this.ywc(this._element),this.lBd=!1,!0):!1}gvb(){return 32===this.Ca.processAction(oa.a.renameFile,1)}gPf(){const z=I.a.lG(this.Mna.ux);let U=this._element.innerText.trim();U.length>this.O0a&&(U=U.substr(0,this.O0a));U!==z&&""!==U?32!==this.Ca.Ka(oa.a.renameFile,2,U)?this.hFe():this.wJb(U):this.hFe()}hFe(){this.wJb(I.a.lG(this.Mna.ux))}wJb(z){this._initialized&&
(this._element.innerText=z,this.btf())}Hxh(z){this.gvb()?this.isActive||(z&&(this.ytd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Ub.a.We,Ub.a.uGf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Mb.CuiHelper.yYf),this.Yna&&this.Yna.execute(U=>{U.U9g(!0)}),z&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ca.processAction(oa.a.gHb,
2)}nQd(z){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Ub.a.We,Ub.a.Xt);Sys.UI.DomElement.removeCssClass(this._element,Mb.CuiHelper.yYf);this.Yna&&this.Yna.execute(U=>{U.U9g(!1)});z&&(this._element.blur(),this._element.focus())}static xXa(){Kc.a.xXa(K.AFrameworkApplication.isRtl)}static GB(){return new Gc(K.AFrameworkApplication.Ta,gc.a.instance,Ua.KeyInputManager.instance,pb.a.instance,K.AFrameworkApplication.fu,Gc.xXa,
Bc.a.MYk,Bc.a.ANf,Z.a.instance.La("Common.App.Header.HeaderEventSource"),ia.a.aF,ia.a.Ki,ia.a.$f)}}Object(h.a)(Gc,"RenameUIHandler",null,[695]);class qd{static get instance(){return K.AFrameworkApplication.Aa.gb.iN?qd.Ja||(qd.Ja=mc.GB()):qd.Ja||(qd.Ja=Gc.GB())}}qd.Ja=null;Object(h.a)(qd,"RenameUIHandlerFactory",null,[]);class Td{constructor(){this.Vse=this.vek=this.lCi=null}}Object(h.a)(Td,"RenameMruEntryProperties",null,[]);var Vd=d(170),Be=d(124),Id=d(426),gb;(function(z){z[z.unknown=-1]="unknown";
z[z.success=0]="success";z[z.renameInvalidFileName=1]="renameInvalidFileName";z[z.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";z[z.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";z[z.permissionDenied=4]="permissionDenied";z[z.serverCommunicationFailure=5]="serverCommunicationFailure";z[z.fileNameTooLong=6]="fileNameTooLong"})(gb||(gb={}));Object(h.b)("CommonOperationResult",gb);class Xb{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc,md){this.C$e=z;this.Ca=U;this.rfa=la;this.oE=
Da;this.E0a=Ia;this.JXh=Db;this.BMa=Ob;this.Zxf=sc;this.lTh=hc;this.bLa=Fc;this.jb=Xc;this.kTh=md}ub(){K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.iN||this.Ym.xa(oa.a.z2b,dc.a.frame,Object(v.a)(this,this.z2b,"initializeRenameUIHandler"));this.Ym.xa(oa.a.gHb,dc.a.frame,Object(v.a)(this,this.gHb,"showRenameDisabledDialog"));this.Ym.xa(oa.a.renameFile,dc.a.frame,Object(v.a)(this,this.renameFile,"renameFile"));this.Ym.pa(oa.a.fileNameUpdate,dc.a.frame,Object(v.a)(this,this.NJk,"refreshFilename"),
64);this.Ym.pa(oa.a.x5c,dc.a.frame,Object(v.a)(this,this.x5c,"moveToFolderCompleteByHost"),64);this.Ym.xa(oa.a.qcb,dc.a.frame,Object(v.a)(this,this.qcb,"moveToFolder"));(K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||K.AFrameworkApplication.Aa&&(K.AFrameworkApplication.fa.ka("PostMessageEmbedded")||K.AFrameworkApplication.fa.ka("IsJsApi"))&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&K.AFrameworkApplication.zV().execute(z=>{z.Vt(Be.a.HTg);z.ZA(Be.a.HTg,Xb.UHk);z.Vt(Be.a.NUd);z.ZA(Be.a.NUd,Xb.SHk)})}gvb(){return 0===this.kTh.ucg()?32:8}Pxl(){return this.mA?this.BMa?this.mA.XRd:this.mA.xBa:!0}z2b(){return qd.instance.initialize(K.AFrameworkApplication.OIc,K.AFrameworkApplication.ZGc,K.AFrameworkApplication.Fdh||CommonUIStrings.l_RenameFileTooltip)?32:8}gHb(){const z=this.Pxl(),U=this.JXh();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.E0a,U,z,this.BMa);K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.QB&&K.AFrameworkApplication.fa.ka("ReactRenameDisabledDialogIsEnabled")?new cc(this.E0a,!U,!z,this.BMa,this.bLa()):new Pb(this.E0a,!U,!z,this.BMa,this.bLa());return 32}renameFile(z,U,la,Da,Ia){if(1===la)return this.gvb();if(!K.AFrameworkApplication.b5a)return 8;if(8===this.gvb())return this.Ym.processAction(oa.a.gHb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");K.AFrameworkApplication.b5a(Ia,Object(v.a)(this,
this.rdc,"onRenameFileSuccess"),Object(v.a)(this,this.knk,"onRenameFileFailure"));return 32}rdc(z,U){z?0!==z.OperationResult?this.Ygg(z.OperationResult):(this.PZk(U,z.NewName),this.Usl(z,Object(v.a)(K.AFrameworkApplication.Aa.gb,K.AFrameworkApplication.Aa.gb.EBh,"updateOpenInClientDocumentUrl")),K.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&K.AFrameworkApplication.Aa.updateCommandUI(),this.lTh.oAh()):this.Ygg(5)}PZk(z,U){const la={};la[Vd.a.oQi]=U;z.sendMessage(Be.a.NUd,la)}Usl(z,
U){this.etl(z);K.AFrameworkApplication.tGc=z.DirectInvokeDavUrl;U=U(z.EditDocInClientUrl);const la=new Td;la.Vse=this.oE.ux;la.lCi=U;la.vek=z.EditDocInClientUrl;this.Ym.Ka(oa.a.Gdh,2,la)}Ygg(z){switch(z){case 1:z=new Zb.StandardDialog,z.vd=0,z.mO(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Rfh()}}etl(z){this.oE.ux=Xb.u8h(this.oE.ux,z.NewName);z.BreadcrumbFolderName&&(this.oE.breadcrumbFolderName=z.BreadcrumbFolderName);z.BreadcrumbFolderUrl&&(this.oE.breadcrumbFolderUrl=
z.BreadcrumbFolderUrl);this.Zxf(z.NewName)}knk(z){const U=new Zb.StandardDialog;U.vd=0;switch(z){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");U.jgb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");U.jgb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:e.ULS.sendTraceTag(38114565,
203,15,"OnRenameFileFailure: {0}",{["Result"]:z}),U.jgb(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}K.AFrameworkApplication.zV().execute(la=>{la.sendMessage(Be.a.nQi,{["FailureMessage"]:gb[z]})});this.Rfh()}NJk(z,U,la){if(1===la)return this.gvb();if(!K.AFrameworkApplication.Cqa)return 8;K.AFrameworkApplication.Cqa(Object(v.a)(this,this.pCb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.c8c,"onRefreshFilenameFailure"),!1);return 32}qcb(z,U,la,Da,
Ia){if(1===la)return K.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?32:8;if(2===la){const Db={};z=K.AFrameworkApplication.S8a;U=K.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");z=(!z||z&&U)&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Db[Vd.a.kil]=z;Ia&&Ia.MoveButtonClickedTime&&(Db[Vd.a.xdk]=Ia.MoveButtonClickedTime.getTime());K.AFrameworkApplication.zV().execute(Ob=>{Ob.sendMessage(Be.a.qcb,Db)});Ia&&Ia.MoveButtonClickedTime&&
((z=Q.a.pz())&&z.set("MovePostDuration",((new Date).getTime()-Ia.MoveButtonClickedTime.getTime()).toString()),u.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",z));return 32}return 8}x5c(z,U,la,Da,Ia){if(1===la)return K.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?this.gvb():8;if(2===la){if(!K.AFrameworkApplication.djc)return u.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Ia)return u.Health.instance.recordKpiFailure("MoveToFolder",
"Null actiondata",!1,!1,null),8;if(Ia[Vd.a.qEj])if(Ia[Vd.a.yCh])if(z=Ia[Vd.a.yCh].toLowerCase(),U=K.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),la=K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),U&&K.AFrameworkApplication.S8a&&la){const Db={};Db[Vd.a.fEb]="1";Db[Vd.a.documentUrl]=z;Db[Vd.a.reason]=Id.a.eGe;u.Health.instance.recordKpiSuccess("MoveToFolder",null);K.AFrameworkApplication.zV().execute(Ob=>{Ob.sendMessage(Be.a.RAa,Db)})}else if(!K.AFrameworkApplication.S8a&&
la)u.Health.instance.recordKpiSuccess("MoveToFolder",null),Bc.a.Um(z,Bc.a.x$(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return u.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else u.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else K.AFrameworkApplication.Cqa(Object(v.a)(this,this.pCb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.c8c,"onRefreshFilenameFailure"),!1),K.AFrameworkApplication.djc(),u.Health.instance.recordKpiSuccess("MoveToFolder",
null)}return 32}eal(z,U){return z&&U?z!==this.oE.breadcrumbFolderName||U!==this.oE.breadcrumbFolderUrl:!1}pCb(z,U){z&&(z.NewName!==I.a.lG(this.oE.ux)||this.eal(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl))&&this.rdc(z,U)}c8c(){}Rfh(){this.Zxf(I.a.lG(this.oE.ux))}get Ym(){return this.Ca.value}get mA(){return this.rfa.value}static get instance(){return Xb.Ja||(Xb.Ja=Xb.T5a())}static T5a(){return new Xb(K.AFrameworkApplication.t4b,new ib.a(()=>K.AFrameworkApplication.Ta),new ib.a(()=>K.AFrameworkApplication.mA),
K.AFrameworkApplication.fu,K.AFrameworkApplication.ZP,()=>K.AFrameworkApplication.Enc,K.AFrameworkApplication.Uhc,Object(v.a)(qd.instance,qd.instance.wJb,"updateTitle"),Z.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>K.AFrameworkApplication.CS,K.AFrameworkApplication.fa,Z.a.instance.resolve("Common.IRenameProps"))}static u8h(z,U){z=I.a.uV(z);return U+z}static UHk(z){const U=z.Values[Vd.a.NIj];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",U);U?
K.AFrameworkApplication.Ta.Ka(oa.a.x5c,2,z.Values):u.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static SHk(z){K.AFrameworkApplication.Ta.Ka(oa.a.renameFile,2,z.Values.NewName)}}Xb.Ja=null;Object(h.a)(Xb,"RenameActor",null,[]);var Ic=d(376),Wc=d(641),Ib=d(583),ec=d(192);class Jb{constructor(z,U){this.Ca=z;this.Kqd=U}ub(){this.Ca.xa(oa.a.Icl,dc.a.frame,Object(v.a)(this,this.Jcl,"showRenameDialogAction"))}Jcl(z,U,la){z=32;if(1===la)return ec.SessionStatusManager.instance.tia||
K.AFrameworkApplication.UP?8:32;2===la&&(32!==this.Ca.processAction(oa.a.renameFile,1)?(this.Ca.processAction(oa.a.gHb,2),Ic.a.instance.Tb(Wc.a.Mha,{["Reason"]:Ib.a.YQk}),z=8):32===this.Ca.processAction(oa.a.Akc,1)?this.Ca.processAction(oa.a.Akc,2):this.Kqd.value.create().O4());return z}}Object(h.a)(Jb,"RenameDialogActor",null,[675]);class hb{constructor(z,U,la){this.dialog=null;this.Ca=z;this.oE=U;this.EKa=la}eaj(){const z={};z.nameInputProps={["type"]:"AppInputProps",["id"]:hb.dqb,["label"]:CommonUIStrings.l_RenameDialogLabel,
["value"]:I.a.lG(this.oE.ux),["maxLength"]:this.EKa};return z}O4(){const z={["id"]:"RenameDialog",["bodyControls"]:this.eaj()};this.dialog=new sb.a(!1,!1,!0);this.dialog.vd=1;this.dialog.kg="RenameDialog";this.dialog.pj(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.$De,"renameDialogHandler"),z)}$De(z,U){if(U&&1===z){if(U[hb.dqb]&&(z=I.a.lG(this.oE.ux),U=(U[hb.dqb]||"").trim(),U!==z&&""!==U)){this.Ca.Ka(oa.a.renameFile,2,U);return}Ic.a.instance.Tb(Wc.a.IXb,{["Reason"]:Ib.a.m2f})}}}hb.dqb=
"txtDocumentName";Object(h.a)(hb,"ReactRenameDialog",null,[697]);class Rc{static get jg(){return sb.a.EB(Rc.Zn,CommonUIStrings.l_RenameDialogLabel)}}Rc.Zn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(h.a)(Rc,"RenameDialogHtml",null,[]);class gd extends sb.a{constructor(z,U,la){super();this.Ca=z;this.oE=U;this.EKa=
la;this.kg="RenameDialog";this.jg=Rc.jg}O4(){var z={["txtDocumentName"]:I.a.lG(this.oE.ux)};this.pj(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.$De,"renameDialogHandler"),z);z=document.getElementById(gd.dqb);0<this.EKa&&(z.maxLength=this.EKa);z.focus()}$De(z,U){if(1===z&&(z=I.a.lG(this.oE.ux),U=(U[gd.dqb]||"").trim(),U!==z&&""!==U)){this.Ca.Ka(oa.a.renameFile,2,U);return}Ic.a.instance.Tb(Wc.a.IXb,{["Reason"]:Ib.a.m2f})}}gd.dqb="txtDocumentName";Object(h.a)(gd,"RenameDialog",sb.a,[697]);
class hd{constructor(z){this.Mna=null;this.EKa=0;this.Ca=z;this._initialized=!1}initialize(z,U){this.Mna=z;this.EKa=U;this._initialized=!0}create(){return this._initialized?K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.QB&&K.AFrameworkApplication.fa.ka("ReactRenameDialogIsEnabled")?new hb(this.Ca,this.Mna,this.EKa):new gd(this.Ca,this.Mna,this.EKa):null}}Object(h.a)(hd,"RenameDialogFactory",null,[674]);var Hd=d(119),Xd=d(100),id=d(73),fd=d(78),Vf=d(136);class Qd{constructor(z,U){this.Ca=
z;this.Hd=U}ub(){this.Ca.xa(oa.a.Akc,dc.a.frame,Object(v.a)(this,this.Kcl,"showRenameFlyoutAction"))}Gii(){return id.d("setDocumentTitleFlyoutOpened")&&K.AFrameworkApplication.Aa.gb.iN}Kcl(z,U,la){if(1===la)return this.Gii()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}e1h(){Qd.fNj&&K.AFrameworkApplication.isa&&Vf.a.instance.Gb(new fd.a(5,1,5E3,()=>{32===this.Ca.processAction(oa.a.Akc,1)&&this.Hd&&this.Hd.ye.name===Hd.AFrame.mV&&(Xd.a("RenameFloatieShownOnNewDocumentLoad",
!0),this.Ca.processAction(oa.a.Akc,2))}))}static get fNj(){Qd.atc&&null!=Qd.atc||(K.AFrameworkApplication.o9a("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Qd.atc=K.AFrameworkApplication.fa?K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Qd.atc}}Qd.atc=null;Object(h.a)(Qd,"RenameFlyoutActor",null,[673]);class Zf{constructor(z,U,la,Da,Ia){this.FMd=null;this.rfa=Ia;this.D$e=la;this.C$e=
Da;this.LXh=z;this.bLa=U}get mA(){return this.rfa.value}ucg(){if(!this.C$e())return 5;if(this.bLa())return 1;if(this.mA){if(this.D$e&&!this.mA.XRd)return 3;if(!this.D$e&&!this.mA.xBa)return 4}return this.LXh()?0:2}}Object(h.a)(Zf,"RenameProps",null,[672]);var Ge=d(66);class le{constructor(z,U,la,Da,Ia,Db){this.Dp=!1;this.ewd=new Ge.a;this.tjb=U;this.nqc=la;this.Cpc=Da;this.jb=Ia;this.sga=Db}enable(){this.Dp||(this.oAh(),this.hNe(),this.Dp=!0)}generateKey(z,U,la){return String.format("{0}/{1}/{2}",
la,z,U)}l5i(){const z=I.a.lG(this.tjb().ux);return this.generateKey(this.tjb().breadcrumbFolderName,this.tjb().breadcrumbFolderUrl,z)}m5i(z,U,la){return z&&U?this.generateKey(z,U,la):la}ZFi(z,U,la){return z&&z!==this.tjb().breadcrumbFolderName||U&&U!==this.tjb().breadcrumbFolderUrl?!0:la!==I.a.lG(this.tjb().ux)}oAh(){const z=this.l5i();this.ewd.$(z,new Date)}Uxe(z){this.N9k(z)&&this.Kzf(z)}N9k(z){const U=this.Cpc();return U?this.sga&&this.sga.u8a||!U.y8d||!K.AFrameworkApplication.Cqa?(this.bth(z),
this.Dp=!1):!0:!1}u0g(z,U,la,Da){const Ia=this.ZFi(z,U,la);z=this.m5i(z,U,la);U=this.ewd.Of(z).returnValue;Ia&&!U&&(this.ahg(Da),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.pce));Ia||this.ewd.$(z,this.nqc())}}Object(h.a)(le,"ARenamedFileChecker",null,[656]);class Sa extends le{constructor(z,U,la,Da,Ia,Db,Ob,sc){super(z,U,la,Da,Ia,Db);this.Tqf=Ia;this.jTh=Ob;this.mtd=sc}get pce(){return"RenamedFileCheckerUsingSettingsRefresh"}hNe(){this.Tqf.wGd(Object(v.a)(this,this.aig,"handleSettingsRefresh"))}aig(z,
U){U&&U.tcc&&U.Egk&&(U.rvb("BreadcrumbDocName")||U.rvb("BreadcrumbFolderName")||U.rvb("BreadcrumbFolderUrl")||U.rvb("DirectInvokeDAVUrl")||U.rvb("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.pce),this.Uxe(U))}bth(){this.Tqf.ZPk(Object(v.a)(this,this.aig,"handleSettingsRefresh"))}Kzf(z){if(z&&z.tcc){const U=z.tcc;this.u0g(U.Ha("BreadcrumbFolderName"),U.Ha("BreadcrumbFolderUrl"),U.Ha("BreadcrumbDocName"),z)}}ahg(z){const U={OperationResult:0,classId:1};
z=z.tcc;U.BreadcrumbFolderName=z.Ha("BreadcrumbFolderName");U.BreadcrumbFolderUrl=z.Ha("BreadcrumbFolderUrl");U.DirectInvokeDavUrl=z.Ha("DirectInvokeDAVUrl");U.EditDocInClientUrl=z.Ha("EditDocInClientUrl");z=z.Ha("BreadcrumbDocName");U.NewName=K.AFrameworkApplication.VGc?z:I.a.lG(z);this.mtd.execute(la=>{this.ZAj(U,la)})}ZAj(z,U){this.jTh().rdc(z,U)}}Object(h.a)(Sa,"RenamedFileCheckerUsingSettingsRefresh",le,[]);class Cb extends le{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc){super(z,la,Da,Ia,Db,hc);
this.hQb=this.yyc=null;this.bSh=U;this.Ca=Ob;this.Rd=sc;Fc&&Fc.execute(Xc=>{this.yMk(Xc)})}get pce(){return"RenamedFileCheckerUsingTask"}yMk(z){this.yyc=z;this.yyc.Mzc(Object(v.a)(this,this.x1b,"handleVisibilityChange"))}x1b(z,U){!this.Dp||0!==U.newState&&1!==U.newState||this.hQb||(this.hNe(),this.Uxe(this.hQb))}hNe(){this.hQb=new fd.a(3,2,this.bSh(),Object(v.a)(this,this.Uxe,"performRenameFileCheckTick"),89);this.Rd.Gb(this.hQb)}bth(z){this.Rd.Qg(z)}Kzf(z){this.yyc&&2===this.yyc.U2a?this.DNk(z):
K.AFrameworkApplication.Cqa(Object(v.a)(this,this.pCb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.c8c,"onRefreshFilenameFailure"),!0)}DNk(z){this.Rd.Qg(z);this.hQb=null}pCb(z){z&&this.u0g(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl,z.NewName,null)}ahg(){this.Ca.processAction(oa.a.fileNameUpdate,2)}c8c(){}}Object(h.a)(Cb,"RenamedFileCheckerUsingTask",le,[]);var rc=d(93);class bd{constructor(){this.jb=this.Da=null}get name(){return"Common.App.RenameFile"}Wb(z){this.Da=z;this.jb=K.AFrameworkApplication.fa;
this.Da.register(Jb,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").na(()=>new Jb(K.AFrameworkApplication.Ta,this.Da.Be("Common.App.Rename.IRenameDialogFactory"))).ma();this.Da.register(hd,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").na(()=>new hd(K.AFrameworkApplication.Ta)).ma();this.Da.register(656,"Common.App.Rename.IRenamedFileChecker").na(()=>this.Dzi()).ma();this.Da.register(Qd,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").na(()=>
new Qd(K.AFrameworkApplication.Ta,rc.FocusManager.instance())).ma()}Dzi(){if(this.jb.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const z=this.Da.pb("Common.IRefreshableAppSettings");if(z&&z.ILj)return new Sa(()=>z.Ec("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>K.AFrameworkApplication.fu,()=>new Date,()=>K.AFrameworkApplication.mA,z,this.Da.pb("Common.ISessionStatus"),()=>Xb.instance,this.Da.La("Postmessage.IHostPostmessenger"))}return new Cb(()=>this.jb.Ec("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.jb.Ec("RenamedFileCheckerPingIntervalInMs",12E4),()=>K.AFrameworkApplication.fu,()=>new Date,()=>K.AFrameworkApplication.mA,K.AFrameworkApplication.fa,K.AFrameworkApplication.Ta,K.AFrameworkApplication.ue,this.Da.pb("Common.ISessionStatus"),this.Da.La("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.jb.ff(Object(v.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){const z=K.AFrameworkApplication.Aa.gb.iN;K.AFrameworkApplication.t4b()&&qd.instance.initialize(K.AFrameworkApplication.OIc,
z?null:K.AFrameworkApplication.ZGc,z?null:K.AFrameworkApplication.Fdh||CommonUIStrings.l_RenameFileTooltip)&&(this.Da.register(Zf,"Common.App.Rename.RenameProps").as("Common.IRenameProps").na(()=>new Zf(()=>K.AFrameworkApplication.Enc,()=>K.AFrameworkApplication.CS,K.AFrameworkApplication.Uhc,K.AFrameworkApplication.t4b,new ib.a(()=>K.AFrameworkApplication.mA))).ma(),Xb.instance.ub(),this.jb.ka("RenameDialogIsEnabled")&&(this.Da.resolve("Common.App.Rename.RenameDialogFactory").initialize(K.AFrameworkApplication.fu,
K.AFrameworkApplication.OIc),this.Da.resolve("Common.App.Rename.IRenameDialogActor").ub()),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").ub(),K.AFrameworkApplication.Uhc&&this.Da.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").e1h())}dispose(){}}Object(h.a)(bd,"PackageManager",null,[2,3]);const pd=z=>{try{return M.a(z)}catch(U){}return null};class Oa{constructor(z,U,la,Da,Ia,Db){this.X0=!1;this.xR=null;this.czd=!1;this.Ca=
z;this.Ei=U;this.rfa=la;this.lcf=Da;this.jb=Ia;this.mPh=Db}init(z,U){U&&z.La("Common.Interface.IRtcBasicProvider").execute(Object(v.a)(this,this.fJd,"awaitRtc"))}fJd(z){const U=z.nL.task;U.continueWith(()=>{this.xR=U.result;this.czd&&(this.xR.rea(2,null,!0),this.czd=!1);this.xR.Eza((la,Da)=>{2===Da.type&&this.Ym.processAction(oa.a.fileNameUpdate,2)});this.xR.M2a((la,Da)=>{2===Da.newState&&this.Ym.processAction(oa.a.fileNameUpdate,2)});2===this.xR.connectionState&&this.Ym.processAction(oa.a.fileNameUpdate,
2)})}Cqa(z){this.x0f(z,!0)}x0f(z,U){const la=this.Eei(z.$qh),Da={};Da[Oa.cQf]=Oa.dQf;this.$eh.vj(la,2,"",Da,!1,2,Object(v.a)(this,this.pCb,"onRefreshFilenameSuccess"),U?Object(v.a)(this,this.enk,"onRefreshFilenameFailureRetry"):Object(v.a)(this,this.l_g,"onRefreshFilenameFailureNoRetry"),z)}pCb(z){this.X0=!1;const U=pd(z.data.Zd);z.data.state.onSuccess(U,this.lcf.value)}enk(z){5!==z.data.status||this.X0?this.l_g(z):(this.X0=!0,this.x0f(z.data.state,!1))}l_g(z){z.data.state.Oy(-1)}b5a(z){this.y0f(z,
!0)}y0f(z,U){const la=this.Fei(),Da={};Da[Oa.cQf]=Oa.dQf;Da[Oa.$pj]=I.a.Me(z.jfh);Da[Oa.Ypj]=this.mPh.value.FMd;this.$eh.vj(la,2,"",Da,!1,2,Object(v.a)(this,this.rdc,"onRenameFileSuccess"),U?Object(v.a)(this,this.lnk,"onRenameFileFailureRetry"):Object(v.a)(this,this.r_g,"onRenameFileFailureNoRetry"),z)}Fei(){return this.OIf()}Eei(z){let U=this.OIf();return U=E.a.ej(U,Oa.dqj,z?"2":"1")}OIf(){let z=(this.jb.value.appSettings.RenameWebServiceBase||"")+Oa.Zpj;z=E.a.ej(z,Oa.aqj,I.a.Me(K.AFrameworkApplication.Zg));
this.mA&&this.mA.y8d&&(z=E.a.ej(z,Oa.cqj,"1"));return z}rdc(z){this.X0=!1;const U=pd(z.data.Zd);z.data.state.onSuccess(U,this.lcf.value);this.hVg()}hVg(){this.xR?this.xR.rea(2,null,!0):this.czd=!0}lnk(z){5!==z.data.status||this.X0?this.r_g(z):(this.X0=!0,this.y0f(z.data.state,!1))}r_g(z){z.data.state.Oy(-1)}get Ym(){return this.Ca.value}get $eh(){return this.Ei.value}get mA(){return this.rfa.value}static get instance(){return Oa.Ja||(Oa.Ja=Oa.T5a())}static T5a(){return new Oa(new ib.a(()=>K.AFrameworkApplication.Ta),
new ib.a(()=>K.AFrameworkApplication.He),new ib.a(()=>K.AFrameworkApplication.mA),new ib.a(()=>Z.a.instance.resolve("Postmessage.IHostPostmessenger")),new ib.a(()=>K.AFrameworkApplication.fa),new ib.a(()=>Z.a.instance.resolve("Common.IRenameProps")))}}Oa.cQf="Content-Type";Oa.dQf="application/json; charset=utf-8";Oa.Zpj="renamehandler.ashx";Oa.aqj="qs";Oa.$pj="n";Oa.cqj="sl";Oa.Ypj="X-CoauthLockId";Oa.dqj="u";Oa.Ja=null;Object(h.a)(Oa,"ExecuteRenameFileHandler",null,[]);class jb{constructor(){this.Oy=
this.onSuccess=null;this.$qh=!1}}Object(h.a)(jb,"ExecuteRefreshFilenameData",null,[]);class nc{constructor(){this.Oy=this.onSuccess=this.jfh=null}}Object(h.a)(nc,"ExecuteRenameFileData",null,[]);class kb{constructor(){this.Da=null;this.Mrd=Oa.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Wb(z){this.Da=z}init(){K.AFrameworkApplication.fa.ff(Object(v.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){K.AFrameworkApplication.t4b()&&(Oa.instance.init(this.Da,K.AFrameworkApplication.Uhc),
K.AFrameworkApplication.b5a=Object(v.a)(this,this.b5a,"executeRenameFile"),K.AFrameworkApplication.Cqa=Object(v.a)(this,this.Cqa,"executeRefreshFilename"),K.AFrameworkApplication.djc=Object(v.a)(this,this.djc,"sendFileNameAndLocationUpdateNotification"))}b5a(z,U,la){const Da=new nc;Da.jfh=z;Da.onSuccess=U;Da.Oy=la;this.Mrd.b5a(Da)}Cqa(z,U,la){const Da=new jb;Da.onSuccess=z;Da.Oy=U;Da.$qh=la;this.Mrd.Cqa(Da)}djc(){this.Mrd.hVg()}dispose(){}}Object(h.a)(kb,"PackageManager",null,[2,3]);class Gb{constructor(z,
U,la,Da,Ia,Db){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=z;this.WebAffinitizedUrl=U;this.PolicyCookie=la;this.PolicyCookieTTL=Da;this.WasServiceDown=Ia;this.AffinitizedUrl=Db}}Object(h.a)(Gb,"SafeLinksData",null,[]);class tc{constructor(z,U){this.hjd=z;this.Wx=U}}Object(h.a)(tc,"SafeLinksGetUrlReputationRequestData",null,[]);class dd{constructor(z,U,la,Da){this.jb=z;this.Ei=U;
this.hMh=la;dd.Qh=Da}Jkd(z,U,la){try{var Da=null;dd.Qh&&(Da=dd.Qh.wi("WebServiceCall","SafeLinksGetUrlReputation"));const Ia=new tc(U,Da);Da={};Da.AffinitizedUrl=z;Da.TargetUrl=U;Da.PolicyCookie=la;const Db=M.c(Da);this.Ei.vj(this.hMh,2,Db,null,!1,2,Object(v.a)(this,this.rkk,"onGetUrlReputationSuccessCallback"),Object(v.a)(this,this.qkk,"onGetUrlReputationFailureCallback"),Ia,void 0,void 0,3E3,3E3,"36");return!0}catch(Ia){e.ULS.sendTraceTag(588788033,378,10,Ia.message)}return!1}rkk(z){let U="OnGetUrlReputationSuccessCallback: ",
la=10;const Da=z.data.state;try{const Ia=M.b(z.data.Zd).reputationResults[0],Db=Ia.navigateUrl.length,Ob=Da.hjd.length,sc=Ia.navigateUrl===Da.hjd;Ia.navigateUrl&&0<Ia.navigateUrl.length&&(Da.hjd=Ia.navigateUrl);U+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",z.data.af,Ia.verdict,Ob.toString(),Db.toString(),sc.toString());la=50}catch(Ia){U+=String.format("Exception {0}",Ia.message)}this.fhg(Da,U,la)}qkk(z){let U="OnGetUrlReputationFailureCallback: ";
const la=z.data.state;try{U+=String.format("HttpStatus {0}",z.data.af)}catch(Da){U+=String.format("Exception {0}",Da.message)}this.fhg(la,U,10)}fhg(z,U,la){z.Wx&&(z.Wx.stop(),z.Wx=null);e.ULS.sendTraceTag(588788034,378,la,U);Bc.a.Um(z.hjd,void 0,"noopener,noreferrer","SafeLinksNav")}}dd.Qh=null;Object(h.a)(dd,"SafeLinksNavigationHelper",null,[]);var $c;(function(z){z[z.enabledByPolicy=0]="enabledByPolicy";z[z.disabledByPolicy=1]="disabledByPolicy";z[z.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";
z[z.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})($c||($c={}));Object(h.b)("SafeLinksNavigationState",$c);var Pc=d(489);class Ad{constructor(z,U,la,Da=!1,Ia=null,Db=null){this.W_a=this.V_a=0;this.D3b=this.Jrc=!1;this.PLa=null;this.pkb=!0;this.Gwc=null;e.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.jb=z;this.Ei=U;this.yna=la;Ad.Qh=Db;this.cYh=Da?this.jb.Ha("SafeLinksHandlerWebServiceBase"):this.jb.Ha("WebServiceBase");this.MXh=this.jb.Ha("SafeLinksHashedUserId");
this.uBl=this.jb.Ha("SafeLinksWorkloadIdHeaderValue");this.Qtc=this.jb.Ec("SafeLinksMaxGetPolicyBootRetries",2);this.Rtc=this.jb.Ec("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Esc=this.lMj();this.Dsc=this.kMj();e.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Esc,this.Dsc);if(this.Esc&&this.Dsc){U=(z=this.Brb())?z.IsSafeLinksEnabled.toLowerCase():"";la=this.Z9d();e.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",
U,la);var Ob=!z||"unknown"===U||z.WasServiceDown||la,sc=Q.a.pz();sc&&(sc.set("shouldGetSafeLinksDataFromServer",Ob.toString()),sc.set("isSafeLinksEnabledCacheValue",U.toString()));this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1)&&Ia?(this.pkb=!1,Ia.execute(hc=>{hc.isFeatureEnabled("MsoUrlreputation",!0).then(Fc=>{this.pkb=Fc;sc.set("isUserLicensedForSafeLinks",this.pkb.toString());u.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",sc);this.pkb&&
Ob&&this.XMc(!0);return null})})):(u.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",sc),Ob&&this.XMc(!0))}}get appName(){return this.yna}get Cmd(){return this.cYh}get userId(){return this.MXh}get L9i(){const z=this.Cmd?this.Cmd+"/":"",U=new ea.QueryStringBuilder("SafeLinksHandler.ashx");U.Hi("app",this.appName);this.jb.ka("SafeLinksUseDebugHeader")&&U.Hi("action","debug");this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&U.Hi("s2satpop",
"1");this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&U.Hi("s2saat","1");this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&U.Hi("s2se03","1");return String.format("{0}{1}&{2}",z,U.toString(),K.AFrameworkApplication.Zg)}get Agj(){const z=this.Cmd?this.Cmd+"/":"",U=new ea.QueryStringBuilder("SafeLinksHandler.ashx");U.Hi("app",this.appName);this.jb.ka("SafeLinksUseDebugHeader")&&U.Hi("action","debug");this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&U.Hi("s2satpop","1");this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&U.Hi("s2saat","1");this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&U.Hi("s2se03","1");U.Hi("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",z,U.toString(),K.AFrameworkApplication.Zg)}get jek(){Ad.VAd||(Ad.VAd=new dd(this.jb,this.Ei,this.Agj,Ad.Qh));return Ad.VAd}Jkd(z){if(!z)return e.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),
!1;var U=this.bHj(z);e.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",U,this.Esc,this.Dsc,this.pkb);if(!(U&&this.Esc&&this.Dsc&&this.pkb))return!1;U=0;const la=({state:U}=this.cal()).returnValue;e.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",$c[U]);const Da=Q.a.pz();Da&&Da.set("SafeLinksNavigationState",$c[U]);u.Health.instance.recordKpiUsage("SafeLinksNavigations",
0,"jpittsdirects",Da);if(!la)return 2!==U&&3!==U||u.Health.instance.recordKpiFailure("SafeLinksNavigations",$c[U],!1,!0,null),!1;e.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.pal())return this.Z9d()?!1:this.jek.Jkd(this.lXi(),z,this.Pbg());if(!this.Z9d())return this.wyh(z),!0;this.PLa=z;e.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.D3b=!1;this.XMc();return!0}bHj(z){z=z.toLowerCase();const U=this.jb.HB("SafeLinksUnsupportedProtocols");
if(U)for(let la=0;la<U.length;la++)if(z.startsWith(U[la]))return!1;return!0}XMc(z=!1){var U=Q.a.pz();U&&U.set("isOnBootRequest",z.toString());u.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",U);u.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",U);U=this.oOd("SafeLinksGetPolicy");this.Ei.vj(this.L9i,1,null,null,!0,2,Object(v.a)(this,this.bbj,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(v.a)(this,this.abj,"getSafeLinksDataFromServer_OnFailureCallback"),
U,void 0,void 0,void 0,void 0,"23");this.D3b=z;this.Jrc=!0;z?this.V_a++:this.W_a++}bbj(z){let U=G.a.kfk,la="";try{this.Jrc=this.D3b=!1;var Da=z.data.state;const md=({Wx:Da}=this.Yhd(Da)).returnValue,Nc=Object.assign(new Ba.a,{durationMs:md});u.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Nc);e.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",z.data.af,z.data.Zd.length,md);if(z.data.af!==G.a.Yy)la=
"Unexpected httpStatus: "+z.data.af.toString();else{Da=null;try{Da=M.b(z.data.Zd)}catch(bf){la="Exception:"+bf.toString()+" deserializing response";return}if(Da){var Ia=Da.IsSafeLinksEnabled;if(void 0===Ia||null===Ia||0>=Ia.length)la="Invalid isSafeLinksEnabledString";else{e.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",Ia);var Db=Ad.wxe(Ia);if(void 0===Da.WebAffinitizedUrl||null===Da.WebAffinitizedUrl||0>=Da.WebAffinitizedUrl.length)la="Invalid WebAffinitizedUrl";else if(void 0===
Da.PolicyCookie||null===Da.PolicyCookie||0>=Da.PolicyCookie.length)la="Invalid PolicyCookie";else if(void 0===Da.PolicyCookieTTL||null===Da.PolicyCookieTTL)la="Invalid PolicyCookieTTL";else{var Ob=Da.WebAffinitizedUrl,sc=Da.PolicyCookie,hc=Da.AffinitizedUrl,Fc=new Date;Fc.setMinutes(Fc.getMinutes()+(5<Da.PolicyCookieTTL?Da.PolicyCookieTTL-5:0));var Xc=new Gb(Ia,Ob,sc,Fc.getTime(),!1,hc);this.dkh(Xc);U=z.data.af;this.PLa&&(Db?(this.wyh(this.PLa),this.W_a=this.V_a=0):(e.ULS.sendTraceTag(26019602,378,
50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),u.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Bc.a.zJc(this.PLa)),this.PLa=null)}}}else la="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(md){la="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+md.toString()}finally{U!==G.a.Yy&&this.ehg(U,la)}}abj(z){this.Jrc=!1;let U=500,la="";try{let Da=z.data.state;const Ia=({Wx:Da}=this.Yhd(Da)).returnValue,
Db=Object.assign(new Ba.a,{durationMs:Ia});U=z.data.af;u.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+U.toString(),!1,!0,Db);la="Request Failed, Status="+Pc.a[z.data.status]+" Duration: "+Ia}catch(Da){la="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+Da.toString()}finally{this.ehg(U,la)}}ehg(z,U=""){try{if(e.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",z,U),this.V_a<this.Qtc&&this.W_a<this.Rtc)this.XMc(this.D3b);
else{this.D3b=!1;e.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.V_a,this.W_a,z,U);U=null;const la=Q.a.pz();la&&(la.set("HttpStatus",z.toString()),U=Object.assign(new Ba.a,{extendedProperties:la}));u.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,U);const Da=new Gb("false","","",0,!0,"");this.dkh(Da);this.PLa&&(e.ULS.sendTraceTag(26019603,378,50,
"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),u.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Bc.a.zJc(this.PLa),this.PLa=null)}}catch(la){e.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",la.toString())}}wyh(z){const U=this.Pbg(),la=this.shj(),Da={};Da.Url=z;Da.SafeLinksCookie=U;Da.CorrelationId=D.a.create().toString();Da.WorkloadId=this.uBl;Da.UserAgentInfo=ia.a.iy+
"|"+this.appName;e.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",Da.CorrelationId);Bc.a.i$c(Bc.a.x$(4),la,Da)}lMj(){const z=this.jb.Ha("IsSafeLinksEnabledForUser");return z?Ad.wxe(z):!1}kMj(){const z=this.jb.HB("SafeLinksDisabledBrowsers");if(ia.a.yS){if(this.jb.Aw("SafeLinksForTeamsIsEnabled")&&this.jb.ka("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(z,"Electron"))return!1}else if(Array.contains(z,ia.a.iy))return!1;return"officecomhwa"===(this.jb.Ha(K.AFrameworkApplication.oJ)||
"").toLowerCase()?!1:!0}pal(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&ia.a.t9d?!0:ia.a.yS}cal(){let z;z=0;const U=this.Brb(),la=U?U.IsSafeLinksEnabled:"";if(""!==la)return U.WasServiceDown?(e.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===la.toLowerCase()?(e.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),
{returnValue:!1,state:1}):{returnValue:Ad.wxe(la),state:z};if(this.Jrc)return z=3,e.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:z};if(this.V_a>=this.Qtc||this.W_a>=this.Rtc)return z=2,e.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.V_a,this.Qtc,this.W_a,this.Rtc),{returnValue:!1,state:z};e.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.Qtc+this.Rtc-(this.V_a+this.W_a));return{returnValue:!0,state:z}}Pbg(){const z=this.Brb();return z?z.PolicyCookie:""}shj(){const z=this.Brb();return z?z.WebAffinitizedUrl:""}lXi(){const z=this.Brb();return z?z.AffinitizedUrl:""}H2i(){const z=new Date;try{const U=this.Brb();z.setTime(U?U.PolicyCookieTTL:0)}catch(U){e.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",U)}return z}Z9d(){const z=this.H2i();return!!z&&z.getTime()<Date.now()}Brb(){if(!this.Gwc){const z=
qa.a.instance.getItem(this.userId);if(!z||""===z)return null;this.Gwc=JSON.parse(z)}return this.Gwc}dkh(z){if(void 0===z||null===z)throw Error.argumentNull("safeLinksData");if(void 0===z.IsSafeLinksEnabled||null===z.IsSafeLinksEnabled||0>=z.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Gwc=z;z.WasServiceDown||this.BBl(z)}BBl(z){z=JSON.stringify(z);qa.a.instance.setItem(this.userId,z)}oOd(z){return void 0!==Ad.Qh&&null!==Ad.Qh?Ad.Qh.wi("WebServiceCall",
z):null}Yhd(z){if(void 0!==z&&null!==z){const U=z.Dq;z.stop();return{returnValue:U,Wx:null}}return{returnValue:null,Wx:z}}static wxe(z){return"false"!==z.toLowerCase()?!0:!1}}Ad.Qh=null;Ad.VAd=null;Object(h.a)(Ad,"SafeLinksManager",null,[632]);const Ee=z=>{switch(z){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},Ce=z=>{switch(z){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};var Fb=d(207);class $e{constructor(){this.K=
null}get name(){return"PowerPointSafeLinks"}Wb(z){this.K=z}init(){K.AFrameworkApplication.fa.ff(Object(v.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),U=z?z.vg:!1;z.pptSafeLinksIsEnabled&&(this.K.register(Ad,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ma().na(()=>new Ad(K.AFrameworkApplication.fa,K.AFrameworkApplication.He,String.format("{0}-{1}",Ee(K.AFrameworkApplication.Aa.gb.Am),Ce(K.AFrameworkApplication.Aa.gb.vGa)),
U)).ma(),this.K.pb("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){va.a.instance.Ac(Fb.a(new $e,0))}}Object(h.a)($e,"SafeLinksPackage",null,[2,3]);var bg=d(336),Ye=d(282),Ae=d(1163),si=d(85),Jf=d(27),tg=d(168),Dg=d(89),Vg=d(1001);class Ih{constructor(z,U,la,Da,Ia,Db){this.SF=z;this._id=U;this.Yqd=Da;this.rKh=Ia;this.sKh=Db;this.xqc=this.Jpb;void 0!==la&&null!==la&&(this.Jpb=la)}get defaultValue(){return this.xqc}get lcid(){return this.SF}get id(){return this._id}get Jpb(){return(this.rKh||
Ih.o0e)(this.Yqd)}set Jpb(z){(this.sKh||Ih.p0e)(this.Yqd,z)}get Tf(){return this.Yqd}static Xq(){Ih.o0e=()=>null;Ih.p0e=()=>{}}}Ih.o0e=null;Ih.p0e=null;Object(h.a)(Ih,"GrammarSettingOption",null,[760]);Ih.Xq();class hf{constructor(z,U,la){this.wVd=z;this.AGe=U;this.Bek=la}}Object(h.a)(hf,"TwoLevelCacheKey",null,[]);var ld=d(32),ph=d(210),Kf=d(2);class Ud extends sb.a{constructor(z,U,la,Da){super();this.qAd=this.p6=this.L2e=this.xLb=null;this.so=Da;this.gqd=z;this.kg=Ud.id;this.gRh=()=>{this.xLb=la?
ja.a.Sjc(la):{};this.L2e=la?ja.a.Sjc(la):{};const Ia=this.fdi(),Db=Ud.pwi(Ia,Ud.Ued(Object(v.a)(this,this.owi,"createCritiqueTypeSettingsTracker"))(Ud.Npi(sc=>this.xLb=sc)));Db(la||{});var Ob=Ud.Ued(Ud.rBi())(sc=>sc.cloneNode(!0));Ud.qwi(Ia,Ud.Nvi(Ud.Hzi(U),Ud.nwi(Ob))(la))(z.toString());this.qAd=this.Hei();Ob=sc=>{if("click"===sc.type||sc.keyCode===tg.a.aq||sc.keyCode===tg.a.JJb)this.xLb[z.toString()]={},Ia.reset(),Ud.gTk(Db)};Dg.a.addHandler(this.jXa,rb.a.click,Ob);Dg.a.addHandler(this.jXa,rb.a.eg,
Ob)};this.jg=""}get jXa(){return this.qAd}sPj(){var z=Ud.oDe(this.xLb),U=Ud.oDe(this.L2e);if(!z&&!U)return!1;let la;try{la=z?Object(A.a)(Object,z[this.gqd.toString()]):{};var Da=U?Object(A.a)(Object,U[this.gqd.toString()]):{}}catch(Ob){return e.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!la&&!Da)return!1;la=la?la:{};Da=Da?Da:{};z=String.format("language: {0}",this.gqd.toString());U=!1;for(let Ob in la){var Ia=Ob,Db=la[Ob];Ia in Da&&Da[Ia]===Db||(U=!0,z=String.format("{0}, [{1}, {2}]",
z,Ia,Db))}for(let Ob in Da)Da=Ob,Da in la||(U=!0,z=String.format("{0}, [{1}, default]",z,Da));U&&e.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",z);return U}pj(z,U,la){super.pj(z,U,la);this.QHk()}KM(z){return z.Fc.id===Ud.rfh?!1:super.KM(z)}UYk(){this.so.Zk().q5c();this.p6=this.so.Zk().qj.YY}QHk(){this.so.Zk().scope.$o(rc.FocusManager.instance().Poa);this.so.Zk().scope.$o(rc.FocusManager.instance().Qoa);this.so.Zk().scope.bindAction(rc.FocusManager.instance().Poa,ld.a.d1b);this.so.Zk().scope.bindAction(rc.FocusManager.instance().Qoa,
ld.a.c1b);this.so.Zk().scope.bindAction(Ua.KeyInputManager.Na(tg.a.t$,0),ld.a.eOc);this.so.Zk().scope.bindAction(Ua.KeyInputManager.Na(tg.a.afa,0),ld.a.dOc);this.so.Zk().scope.bindAction(Ua.KeyInputManager.Na(tg.a.YX,0),ld.a.eOc);this.so.Zk().scope.bindAction(Ua.KeyInputManager.Na(tg.a.s5,0),ld.a.dOc)}get settings(){return Ud.oDe(this.xLb)}Wua(){super.Wua();this.gRh()}fdi(){const z=Ud.Bdi(),U=Ud.ZTb("WACDialogRow",z);this.ZO.insertBefore(U,this.ZO.firstChild);return z}owi(z){const U=Vg.a.merge(null,
z);return la=>{la.Jpb===(z&&z[la.lcid]?z[la.lcid][la.id]:null)||la.Jpb!==la.defaultValue?Ud.nbg(U,la.lcid)[la.id]=la.Jpb:delete Ud.nbg(U,la.lcid)[la.id];this.p6=this.r3i(la.Tf);return U}}r3i(z){return z?(z=z.getElementsByTagName(Sys.UI.DomElement.containsCssClass(z,Ud.mRj)?"select":"input"))?z[0]:null:null}dispose(){this.jXa&&(Dg.a.Fbh(this.jXa),this.qAd=null);super.dispose()}Hei(){const z=document.createElement("input");z.id=Ud.rfh;z.type="reset";z.setAttribute("form",Ud.M4f);z.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";
z.value=CommonUIStrings.l_ResetAll;const U=Ud.ZTb("GrammarSettingsDialogResetButtonContainer",z),la=document.getElementById("WACDialogButtonPanel");la.parentNode.insertBefore(U,la);return z}static get JWb(){return"CritiqueType"}static Npi(z){return U=>la=>z(U(la))}static Ued(z){return U=>la=>U(z(la))}static oDe(z){const U={};ja.a.forEach(z,(la,Da)=>{0<ph.a(Da).length&&(U[la]=Da)},null);return U}static Bdi(){const z=document.createElement("form");z.id=Ud.M4f;Sys.UI.DomElement.addCssClass(z,"WACDialogList");
Sys.UI.DomElement.addCssClass(z,Ud.LBi);return z}static pwi(z,U){const la=Ud.VGk(z,rb.a.change);return Da=>{const Ia=U(Da);la(Db=>{Db=Db.target.parentNode;Sys.UI.DomElement.containsCssClass(Db,Ud.JWb)&&Ia(Db[Ud.MGf])})}}static VGk(z,U){let la=null;return Da=>{la&&Dg.a.removeHandler(z,U,la);Dg.a.addHandler(z,U,Da);la=Da}}static nbg(z,U){return z[U]=z[U]||{}}static gTk(z){e.ULS.sendTraceTag(36489289,375,50,"User click reset all button");z(null)}static Hzi(z){let U=null;return la=>{U=la;return z.request(Number.parseInvariant(la)).CWRCo(Da=>
U===la?Da.result:null,Ud.qQd)}}static qwi(z,U){const la=Ud.eYi(Da=>Ud.oml(Da.children));return Da=>{const Ia=la(Da,z);z.innerHTML="";(Ia?Kf.Task.wt(Ia):U(Da)).continueWith(Db=>{Db=Db.result;for(let Ob=0;Ob<Db.length;Ob++)z.appendChild(Db[Ob])},Ud.qQd)}}static Nvi(z,U){return la=>Da=>z(Da).CWRCo(Ia=>La.toArray(La.select(La.asEnumerable(Ia.result),Db=>U(la,Db,Da))),Ud.qQd)}static oml(z){const U=[];for(let la=0;la<z.length;la++)U.push(z[la]);return U}static eYi(z){const U={};let la=null;return(Da,Ia)=>
{la&&!U[la]&&(Ia=z(Ia))&&(U[la]=Ia);la=Da;return U[Da]}}static rBi(){const z={};return U=>{z[U.wVd]=z[U.wVd]||{};const la=z[U.wVd];la[U.AGe]=la[U.AGe]||U.Bek();return la[U.AGe]}}static nwi(z){return(U,la,Da)=>{const Ia=z(new hf(Da,la.Id,()=>Ud.odi(la)));Ia.setAttribute("role","group");const Db=Ud.NLf+la.Name;Ia.setAttribute("aria-labelledby",Db);for(const Ob of la.CritiqueTypeInfoList){const sc=Ud.LVi(Da,Ob,U,z);Ia.appendChild(sc);sc.setAttribute("aria-labelledby",Db)}return Ia}}static LVi(z,U,la,
Da){Da=Da(new hf(z,U.Id,()=>U.IsBinaryCritiqueType?Ud.ldi(U):Ud.qei(U)));z=new Ih(z,U.Id,la&&la[z]?la[z][U.Id]:null,Da,U.IsBinaryCritiqueType?Ia=>Ia.children[0].checked:Ia=>Ia.children[1].selectedIndex,U.IsBinaryCritiqueType?(Ia,Db)=>{Ia.children[0].checked=Db}:(Ia,Db)=>{Ia.children[1].selectedIndex=Db});Da[Ud.MGf]=z;return Da}static odi(z){z=Ud.pdi(z.Name);z.className="WACWritingStylesDialogCategoryTitle";return Ud.ZTb("CritiqueCategory",z)}static ldi(z){const U=Ud.qdi();U.id=z.Id;0<z.DefaultCritiqueValue&&
U.setAttribute("checked","checked");z=Ud.BIf(z.Name,z.Id);z.className="WACDialogLabel";const la=Ud.ZTb(Ud.JWb,U,z);la.appendChild(U);la.appendChild(z);return la}static qei(z){z=Ud.dei(z.Id,z.Name,Ud.vei(z.CritiqueTypeValues,z.DefaultCritiqueValue),z.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(z,Ud.JWb);return z}static vei(z,U){return La.toArray(La.Si(La.asEnumerable(z||[]),(la,Da)=>{la=Ud.uei(la,Da.toString());Da===U&&la.setAttribute("selected","selected");return la}))}static dei(z,U,la,Da){U=
Ud.BIf(U,z);const Ia=document.createElement("select");Ia.id=z;Ia.className="WACDialogList";la=la||[];for(z=0;z<la.length;z++)Ia.appendChild(la[z]),Da===z&&(la[z].selected=!0);return Ud.ZTb("GrammarSettingsDialogLabeledInlineList",U,Ia)}static uei(z,U){const la=document.createElement("option");la.text=z;la.value=U;return la}static qdi(){const z=document.createElement("input");z.type="checkbox";z.className="WACDialogCheckBox";return z}static BIf(z,U){const la=document.createElement("label");la.innerText=
z;la.setAttribute("for",U);return la}static pdi(z){const U=document.createElement("div");U.innerText=z;U.id=Ud.NLf+z;return U}static ZTb(z=null,...U){const la=document.createElement("div");la.className=z;for(const Da of U)la.appendChild(Da);return la}}Ud.id="GrammarSettingsDialog";Ud.M4f="CritiqueTypeSettings";Ud.LBi="CritiquesList";Ud.mRj="GrammarSettingsDialogLabeledInlineList";Ud.rfh="ResetButton";Ud.NLf="WritingStylesCategory_";Ud.qQd=11;Ud.MGf="CritiqueType";Object(h.a)(Ud,"GrammarSettingsDialog",
sb.a,[]);var He=d(138),Bh=d(346),eg=d(1190),jd=d(38),Jh=d(339),kf=d(60),Ji=d(152),hh=d(46),Wb=d(871),Uc=d(26),Sc=d(28);class Od{constructor(){this.Color=null;this.Transparency=this.Scale=this.EffectDataPropType=this.Degree=0}}Object(h.a)(Od,"EffectDataInfo",null,[]);var ug=d(835);class te{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(h.a)(te,"AddAnimationInfo",null,[]);class mf{constructor(){this.TargetEffects=null}}Object(h.a)(mf,"DeleteAnimationInfo",
null,[]);class Yf{constructor(){this.EffectNodeId=0;this.ShapeId=null}}Object(h.a)(Yf,"TargetEffect",null,[]);class Jd{constructor(){this.EffectType=this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=null}}Object(h.a)(Jd,"ReplaceAnimationInfo",null,[]);class ce{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(h.a)(ce,"ModifyAnimationInfo",null,[]);class fe{constructor(){this.StartType=0;this.TargetEffects=
null}}Object(h.a)(fe,"ChangeAnimationRelationshipInfo",null,[]);var Gg;(function(z){z[z.Degree=0]="Degree";z[z.Color=1]="Color";z[z.Transparency=2]="Transparency";z[z.Scale=3]="Scale"})(Gg||(Gg={}));Object(h.b)("EffectDataPropType",Gg);var Me;(function(z){z[z.Delay=0]="Delay";z[z.Duration=1]="Duration";z[z.Direction=2]="Direction";z[z.EffectData=3]="EffectData"})(Me||(Me={}));Object(h.b)("ModifyAnimationPropertyType",Me);var se;(function(z){z[z.OnClick=0]="OnClick";z[z.WithPrevious=1]="WithPrevious";
z[z.AfterPrevious=2]="AfterPrevious";z[z.Invalid=3]="Invalid"})(se||(se={}));Object(h.b)("AnimationStartType",se);class Pf{constructor(z,U,la,Da,Ia,Db,Ob,sc){this.T4="Existing";this.AIa="ExistingInMenu";this.NMe="AnimationExisting";this.OMe="AnimationExistingInMenu";this.$xb=!1;this.gDb=(hc,Fc,Xc,md,Nc)=>{hc=this.getSelectedShapes();Fc=this.ra.Ip();if(!Fc||!hc||!hc.length)return 8;if(1===Xc)return 32;Xc=Fc.rV(hc);if(!Xc||!Xc.length||0===Xc[0].EffectId)return 16;Nc.MenuItems=this.hdi(Xc[0],Fc,hc);
return 32};this.Ldb=(hc,Fc,Xc,md,Nc)=>{hc=Nc.queryResult;Nc=Nc.SourceControlId;md=Fc=-1;Nc!==this.T4&&({effectType:md,effectId:Fc}=this.Zl.pLc(Nc));var bf=this.getSelectedShapes(),pe=this.ra.Ip();if(!pe||!bf||!bf.length)return 8;if(1!==Xc)return 32;Xc=this.Zl.qLc(Nc);var wf=Xc.label;if(Nc===this.T4||Nc===this.AIa)wf=ResourceStrings.L_ExistingButtonDescription;this.O5a(Nc,Xc.image,Xc.label,hc,wf);var rf=pe.rV(bf);pe=bf=!1;wf=0==rf.length?0:rf[0].EffectId;const fi=0==rf.length?0:rf[0].EffectType,Fh=
!this.Zl.MRc(rf);rf=this.Zl.l8d(rf);Fh||rf||(bf=Fc===wf&&md===fi,pe=this.Zl.LRc(fi,wf));Nc===this.T4?(pe=this.zCk(this.T4,hc,rf,pe,Fh,Xc.image,fi,wf),hc.TT(Fh||rf||pe)):Nc===this.AIa?(pe=Pf.xCk(hc,rf,Fh,pe),hc.TT(Fh||rf||pe)):hc.TT(bf);return 32};this.$A=(hc,Fc,Xc,md,Nc)=>{const bf=this.getSelectedShapes();Fc=this.ra.Ip();if(!Pf.EMj(Fc,bf)||this.H8a(bf))return 8;md=Fc.rV(bf);if(1===Xc)return hc===Sc.a.kjc||hc===Sc.a.lfb?(Fc=0<md.length&&!this.Zl.MRc(md),Xc=0<md.length&&this.Zl.l8d(md),Nc=!1,Fc||Xc||
(Nc=this.Zl.LRc(0<md.length?md[0].EffectType:-1,0<md.length?md[0].EffectId:-1)),hc===Sc.a.lfb&&(Nc=Fc?!0:!1),Fc||Xc||Nc?32:16):hc===Sc.a.PFb?Pf.DMj(bf)?32:16:32;hc=Nc.SourceControlId;if(!hc)return 8;if(hc===this.T4||hc===this.AIa||hc===this.NMe||hc===this.OMe)return 32;hc=this.Zl.pLc(hc);(hc=Pf.JXi(Fc,bf,hc.effectId,hc.effectType))&&this.Gqb(Fc,hc);return 32};this.ifb=()=>32;this.GAe=()=>{const hc=this.getSelectedShapes();var Fc=this.ra.Ip();return Fc&&hc?this.H8a(hc)?16:(Fc=Fc.rV(hc))&&Fc.length&&
this.Zl.oii(hc,this.Ea,Fc)?32:16:8};this.jfb=(hc,Fc,Xc,md,Nc)=>{Fc=this.getSelectedShapes();hc=this.ra.Ip();if(!hc||!Fc||!Fc.length)return 8;if(1===Xc)return 32;if(this.H8a(Fc))return 8;Xc=hc.rV(Fc);if(!Xc||!Xc.length)return Uc.a.J(509703442,800,15,"AnimationActor::setAnimationDirection:  animations info is null"),8;Nc=this.Zl.r_b(Nc.MenuItemId);Fc=new ug.a;Fc.AnimationAction=1;md=new ce;md.TargetEffects=Pf.L6a(Xc);md.ModifyAnimPropType=Me.Direction;md.Direction=Nc;Fc.ModifyAnimationInfo=md;this.Gqb(hc,
Fc);return 32};this.Jdb=(hc,Fc,Xc,md,Nc)=>{Fc=this.getSelectedShapes();md=this.ra.Ip();if(!md||!Fc||!Fc.length)return 8;hc=Nc.queryResult;Nc=this.Zl.r_b(Nc.MenuItemId);Fc=md.rV(Fc);1===Xc&&Pf.MBj(Fc)&&hc.Kf(Fc[0].Direction===Nc);return 32};this.WHa=()=>32;this.Mdb=(hc,Fc,Xc,md,Nc)=>{Fc=this.getSelectedShapes();md=this.ra.Ip();if(!md||!Fc||!Fc.length)return 8;hc=Nc.queryResult;Nc=this.Zl.t0d(Nc.MenuItemId);Fc=md.rV(Fc);1===Xc&&Pf.LBj(Fc)&&hc.Kf(Fc[0].BuildType===Nc);return 32};this.kfb=(hc,Fc,Xc,md,
Nc)=>{Fc=this.getSelectedShapes();hc=this.ra.Ip();if(!hc||!Fc||!Fc.length)return 8;if(1===Xc)return 32;if(this.H8a(Fc))return 8;Xc=hc.rV(Fc);if(!Xc||!Xc.length)return Uc.a.J(509703441,800,15,"AnimationActor::setAnimationEffectData:  animations info is null"),8;if(!Nc)return Uc.a.J(509703440,800,15,"AnimationActor::setAnimationEffectData:  action data is null"),2;md=Nc.MenuItemId;Nc=new ug.a;Nc.AnimationAction=1;Fc=new ce;Fc.TargetEffects=Pf.L6a(Xc);Fc.ModifyAnimPropType=Me.EffectData;Xc=this.a2i(md);
if(!Xc)return Uc.a.J(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),16;Fc.EffectData=Xc;Nc.ModifyAnimationInfo=Fc;this.Gqb(hc,Nc);return 32};this.Kdb=(hc,Fc,Xc,md,Nc)=>{hc=this.getSelectedShapes();Fc=this.ra.Ip();if(!Fc||!hc||!hc.length)return 8;hc=Fc.rV(hc);1===Xc&&hc&&0<hc.length&&Nc.queryResult.Kf(this.Zl.kPf(Pf.b2i(hc[0].EffectData),Nc.MenuItemId));return 32};this.n0k=(hc,Fc,Xc,md,Nc)=>{Fc=this.getSelectedShapes();hc=this.ra.Ip();if(!hc||!Fc||!Fc.length)return 8;
if(1===Xc)return 32;if(this.H8a(Fc))return 8;Xc=hc.rV(Fc);if(!Xc||!Xc.length)return 8;md=Nc.CommandValueId;if(!md||!md.trim().length)return Uc.a.J(509703438,800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),16;Nc=new ug.a;Nc.AnimationAction=4;Fc=new fe;Fc.TargetEffects=Pf.L6a(Xc);Xc=Pf.Ddj(md);if(Xc==se.Invalid)return Uc.a.J(509703437,800,15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),16;Fc.StartType=Xc;Nc.ChangeAnimationRelationshipInfo=
Fc;this.Gqb(hc,Nc);return 32};this.m0k=(hc,Fc,Xc,md,Nc)=>{Fc=this.getSelectedShapes();hc=this.ra.Ip();if(!hc||!Fc||!Fc.length)return 8;if(1===Xc)return 32;if(this.H8a(Fc))return 8;Xc=hc.rV(Fc);if(!Xc||!Xc.length)return Uc.a.J(509703436,800,15,"AnimationActor::setAnimationDurationHandler:  animations info is null or empty"),8;Nc=Math.floor(1E3*Nc.Number);Fc=new ug.a;Fc.AnimationAction=1;md=new ce;md.TargetEffects=Pf.L6a(Xc);md.ModifyAnimPropType=Me.Duration;md.Duration=Nc;Fc.ModifyAnimationInfo=md;
this.Gqb(hc,Fc);return 32};this.Xoj=(hc,Fc,Xc)=>1==Xc?32:Ji.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.$xb.toString(),hc,()=>{(this.$xb=!this.$xb)?this.Cal():this.Srj();return 32});this.dad=(hc,Fc,Xc,md,Nc)=>{Nc&&Nc.Kf(this.$xb);return 32};this.Cal=()=>{const hc=this.IB(),Fc={title:ResourceStrings.L_AnimationGalleryGroup,hideHeader:!1,width:hc.Urk,location:2,contentProps:hc,onOpen:()=>{},onClose:()=>{this.$xb=!1},isModernPane:!0};He.UISurfaces.Cs().then(Xc=>{Xc.showTaskPane(hh.a.T2a,
Fc);return null}).catch(Xc=>{Uc.a.J(512500804,833,10,"AnimationActor::showAnimationPane exception: {0}",Xc.toString())})};this.IB=()=>({type:"AnimationPaneProps",Urk:Wb.a,YCl:!0,$Cl:!0,bDl:!0});this.Srj=()=>{He.UISurfaces.Cs().then(hc=>{hc.hideTaskPane(hh.a.T2a,2);return null}).catch(hc=>{Uc.a.J(512500803,833,10,"AnimationActor::hideAnimationPane exception: {0}",hc.toString())})};this.k0k=(hc,Fc,Xc,md,Nc)=>{Fc=this.getSelectedShapes();hc=this.ra.Ip();if(!hc||!Fc||!Fc.length)return 8;if(1===Xc)return 32;
if(this.H8a(Fc))return 8;Xc=hc.rV(Fc);if(!Xc||!Xc.length)return Uc.a.J(509703435,800,15,"AnimationActor::setAnimationDelayHandler:  animations info is null or empty"),8;Nc=Math.floor(1E3*Nc.Number);Fc=new ug.a;Fc.AnimationAction=1;md=new ce;md.TargetEffects=Pf.L6a(Xc);md.ModifyAnimPropType=Me.Delay;md.Delay=Nc;Fc.ModifyAnimationInfo=md;this.Gqb(hc,Fc);return 32};this.hdi=(hc,Fc,Xc)=>{[].push(hc);const md=new Bh.a;md.Id="AnimationMenuEffectOptions";md.UpdateDynamically=!0;md.Title=ResourceStrings.L_EffectOptions;
md.MenuSectionList=[];md.MenuSectionList.push(this.Zl.QMc(hc.EffectId,hc.EffectType,"Direction","2289594085","3782857737"));this.Zl.Zxg(hc)&&(md.MenuSectionList.push(Jh.f(Fc.Se,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),md.MenuSectionList.push(Jh.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));md.MenuSectionList.push(this.Zl.QMc(hc.EffectId,hc.EffectType,"EffectData",
"2949363495","4132852551"));md.MenuSectionList.push(this.Zl.K$i(Xc,this.Ea,hc));return md};this.a2i=hc=>{let Fc=new Od;const Xc=this.Zl.mYd(hc);return hc.toLowerCase().startsWith("spin")?(Fc.Degree=parseFloat(Xc),Fc.EffectDataPropType=Gg.Degree,Fc):hc.toLowerCase().startsWith("transparency")?(Fc.Transparency=parseFloat(Xc),Fc.EffectDataPropType=Gg.Transparency,Fc):hc.toLowerCase().startsWith("growshrink")?(Fc.Scale=parseFloat(Xc),Fc.EffectDataPropType=Gg.Scale,Fc):null};this.zCk=(hc,Fc,Xc,md,Nc,bf,
pe,wf)=>{if(Nc)return!1;if(Xc)return this.O5a(hc,bf,ResourceStrings.L_AnimationMultiple,Fc,ResourceStrings.L_AnimationMultiple),md;md&&(bf=this.Zl.nNc(pe,wf),{image:bf,label:Xc}=this.Zl.qLc(bf),this.O5a(hc,bf,Xc,Fc,Xc));return md};this.O5a=(hc,Fc,Xc,md,Nc)=>{let bf;bf=hc===this.T4?"298832323":hc===this.AIa?"1264919631":"2676673376";Fc=Fc.substring((kf.a.Aec+"_").length,Fc.length-6);const pe=new eg.a;pe.Id=hc;pe.ExternalId="Animation"+hc;pe.Icon=Fc;pe.Command=bf;pe.QueryCommand="1852964326";pe.LabelText=
Xc;pe.FullIconStyle={root:{width:"32px",height:"32px"}};pe.PreviewIconStyle={root:{width:"24px",height:"24px"}};pe.Alt=Nc;md.h2=pe};this.getSelectedShapes=()=>{let hc=[];const Fc=this.ra.ae();if(!Fc)return hc;for(const Xc of Fc)Xc.get_smartArtModelId()?hc.push(this.Ea.er(Xc)):Xc.mh?hc.push(this.Ea.Pr(Xc)):hc.push(Xc);return hc};this.Gqb=(hc,Fc)=>{const Xc=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{Xc.jc(hc),hc.upa=Fc}finally{Xc&&Xc.dispose()}};this.H8a=hc=>{if(!hc||0==hc.length)return!1;
for(const Fc of hc)if(this.Xb.Zc(Fc))return!0;return!1};if(!z)throw Error.argumentNull("actionManager");if(!U)throw Error.argumentNull("selectionManager");if(!la)throw Error.argumentNull("focusManager");if(!Da)throw Error.argumentNull("transactionFactory");if(!Ia)throw Error.argumentNull("animationHelper");if(!Db)throw Error.argumentNull("graphActionBlockingManager");if(!Ob)throw Error.argumentNull("shapeReader");if(!sc)throw Error.argumentNull("pathManager");this.ia=z;this.ra=U;this.Fa=la;this.Db=
Da;this.o$b=sc.Yj(kf.a.D9c);this.Zl=Ia;this.Xb=Db;this.Ea=Ob}ub(){this.ia.pa(Sc.a.b8h,jd.a.application,this.n0k,4);this.ia.pa(Sc.a.l0k,jd.a.application,this.m0k,4);this.ia.pa(Sc.a.Hbl,jd.a.application,this.Xoj,4);this.ia.pa(Sc.a.dad,jd.a.application,this.dad,96);this.ia.pa(Sc.a.j0k,jd.a.application,this.k0k,4);this.ia.pa(Sc.a.Ldb,jd.a.application,this.Ldb,97);this.ia.pa(Sc.a.$A,jd.a.application,this.$A,5);this.ia.pa(Sc.a.PFb,jd.a.application,this.$A,5);this.ia.pa(Sc.a.kjc,jd.a.application,this.$A,
5);this.ia.pa(Sc.a.lfb,jd.a.application,this.$A,5);this.ia.pa(Sc.a.W7g,jd.a.application,this.GAe,100);this.ia.pa(Sc.a.jfb,jd.a.application,this.jfb,5);this.ia.pa(Sc.a.Jdb,jd.a.application,this.Jdb,97);this.ia.pa(Sc.a.kfb,jd.a.application,this.kfb,4);this.ia.pa(Sc.a.Kdb,jd.a.application,this.Kdb,96);this.ia.pa(Sc.a.JHe,jd.a.application,this.WHa,5);this.ia.pa(Sc.a.KHe,jd.a.application,this.WHa,5);this.ia.pa(Sc.a.LHe,jd.a.application,this.WHa,5);this.ia.pa(Sc.a.MHe,jd.a.application,this.WHa,5);this.ia.pa(Sc.a.Mdb,
jd.a.application,this.Mdb,97);this.ia.pa(Sc.a.gDb,jd.a.application,this.gDb,96);this.ia.pa(Sc.a.ifb,jd.a.application,this.ifb,4)}we(){}}Pf.JXi=(z,U,la,Da)=>0==la&&0==Da?Pf.k1i(z,U):Pf.NBj(U)?Pf.iaj(z,U,la,Da):Pf.ZWi(U,la,Da);Pf.NBj=z=>{if(!z||!z.length)return!1;for(const U of z)if(U.NCa())return!0;return!1};Pf.iaj=(z,U,la,Da)=>{let Ia=new ug.a;Ia.AnimationAction=2;let Db=new Jd;z=z.rV(U);if(!z||!z.length)return Uc.a.J(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),
null;Db.TargetEffects=Pf.L6a(z);Db.EffectId=la;Db.EffectType=Da;Ia.ReplaceAnimationInfo=Db;return Ia};Pf.k1i=(z,U)=>{let la=new ug.a;la.AnimationAction=3;let Da=new mf;z=z.rV(U);if(!z||!z.length)return Uc.a.J(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),null;Da.TargetEffects=Pf.L6a(z);la.DeleteAnimationInfo=Da;return la};Pf.ZWi=(z,U,la)=>{let Da=new ug.a;Da.AnimationAction=0;let Ia=new te;Ia.EffectId=U;Ia.EffectType=la;Ia.ShapeIds=[];Ia.FRemoveExisting=
!0;for(const Db of z)Ia.ShapeIds.push(Db.id.toString());Da.AddAnimationInfo=Ia;return Da};Pf.Ddj=z=>{switch(z.toLocaleLowerCase()){case "on click":return se.OnClick;case "with previous":return se.WithPrevious;case "after previous":return se.AfterPrevious}return se.Invalid};Pf.L6a=z=>{if(!z||!z.length)return null;const U=[];for(const la of z)z=new Yf,z.EffectNodeId=la.EffectNodeId,z.ShapeId=la.ShapeId,U.push(z);return U};Pf.EMj=(z,U)=>{if(!z||!U||!U.length)return!1;for(const la of U)if(la.HV||la.Nq||
la.Lp)return!1;return!0};Pf.DMj=z=>{if(!z||!z.length)return!1;for(const U of z)if(U.nd||U.Pq||U.Lp)return!1;return!0};Pf.MBj=z=>{if(!z||!z.length)return!1;const U=z[0].Direction;for(let la=1;la<z.length;la++)if(z[la].Direction!=U)return!1;return!0};Pf.LBj=z=>{if(!z||!z.length)return!1;const U=z[0].BuildType;for(let la=1;la<z.length;la++)if(z[la].BuildType!=U)return!1;return!0};Pf.b2i=z=>{if(!z)return"";switch(z.EffectDataPropType){case Gg.Degree:return z.Degree.toString();case Gg.Scale:return z.Scale.toString();
case Gg.Transparency:return z.Transparency.toString()}return""};Pf.xCk=(z,U,la,Da)=>{la?(z.M5a=ResourceStrings.L_AnimationExisting,Da&&(Da=!1)):U&&(z.M5a=ResourceStrings.L_AnimationMultiple);return Da};Object(h.a)(Pf,"AnimationActor",null,[244]);class yg{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;
this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(h.a)(yg,"EditAnimationInfo",null,[]);var qe;(function(z){z[z.invalid=0]="invalid";z[z.basicBlockList=1]="basicBlockList";z[z.alternatingHexagons=2]="alternatingHexagons";z[z.pictureCaptionList=3]="pictureCaptionList";z[z.linedList=4]="linedList";z[z.verticalBulletList=5]="verticalBulletList";z[z.verticalBoxList=6]="verticalBoxList";z[z.verticalBracketList=7]="verticalBracketList";
z[z.varyingWidthList=8]="varyingWidthList";z[z.tabList=9]="tabList";z[z.horizontalBulletList=10]="horizontalBulletList";z[z.squareAccentList=11]="squareAccentList";z[z.pictureAccentList=12]="pictureAccentList";z[z.bendingPictureAccentList=13]="bendingPictureAccentList";z[z.stackedList=14]="stackedList";z[z.increasingCircleProcess=15]="increasingCircleProcess";z[z.pieProcess=16]="pieProcess";z[z.detailedProcess=17]="detailedProcess";z[z.groupedList=18]="groupedList";z[z.horizontalPictureList=19]="horizontalPictureList";
z[z.continuousPictureList=20]="continuousPictureList";z[z.pictureStrips=21]="pictureStrips";z[z.verticalPictureList=22]="verticalPictureList";z[z.alternatingPictureBlocks=23]="alternatingPictureBlocks";z[z.verticalPictureAccentList=24]="verticalPictureAccentList";z[z.titledPictureAccentList=25]="titledPictureAccentList";z[z.verticalBlockList=26]="verticalBlockList";z[z.verticalChevronList=27]="verticalChevronList";z[z.verticalAccentList=28]="verticalAccentList";z[z.verticalArrowList=29]="verticalArrowList";
z[z.trapezoidList=30]="trapezoidList";z[z.descendingBlockList=31]="descendingBlockList";z[z.tableList=32]="tableList";z[z.segmentedProcess=33]="segmentedProcess";z[z.verticalCurvedList=34]="verticalCurvedList";z[z.pyramidList=35]="pyramidList";z[z.targetList=36]="targetList";z[z.hierarchyList=37]="hierarchyList";z[z.verticalCircleList=38]="verticalCircleList";z[z.tableHierarchy=39]="tableHierarchy";z[z.architectureLayout=40]="architectureLayout";z[z.basicProcess=41]="basicProcess";z[z.stepUpProcess=
42]="stepUpProcess";z[z.stepDownProcess=43]="stepDownProcess";z[z.accentProcess=44]="accentProcess";z[z.pictureAccentProcess=45]="pictureAccentProcess";z[z.alternatingFlow=46]="alternatingFlow";z[z.continuousBlockProcess=47]="continuousBlockProcess";z[z.increasingArrowsProcess=48]="increasingArrowsProcess";z[z.interconnectedBlockProcess=49]="interconnectedBlockProcess";z[z.continuousArrowProcess=50]="continuousArrowProcess";z[z.convergingText=51]="convergingText";z[z.processArrows=52]="processArrows";
z[z.circleAccentTimeline=53]="circleAccentTimeline";z[z.basicTimeline=54]="basicTimeline";z[z.circleProcess=55]="circleProcess";z[z.basicChevronProcess=56]="basicChevronProcess";z[z.chevronAccentProcess=57]="chevronAccentProcess";z[z.closedChevronProcess=58]="closedChevronProcess";z[z.chevronList=59]="chevronList";z[z.subStepProcess=60]="subStepProcess";z[z.phasedProcess=61]="phasedProcess";z[z.randomtoResultProcess=62]="randomtoResultProcess";z[z.verticalProcess=63]="verticalProcess";z[z.staggeredProcess=
64]="staggeredProcess";z[z.processList=65]="processList";z[z.circleArrowProcess=66]="circleArrowProcess";z[z.basicBendingProcess=67]="basicBendingProcess";z[z.repeatingBendingProcess=68]="repeatingBendingProcess";z[z.verticalBendingProcess=69]="verticalBendingProcess";z[z.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";z[z.upwardArrow=71]="upwardArrow";z[z.descendingProcess=72]="descendingProcess";z[z.circularBendingProcess=73]="circularBendingProcess";z[z.equation=74]="equation";
z[z.verticalEquation=75]="verticalEquation";z[z.funnel=76]="funnel";z[z.gear=77]="gear";z[z.arrowRibbon=78]="arrowRibbon";z[z.opposingArrows=79]="opposingArrows";z[z.convergingArrows=80]="convergingArrows";z[z.divergingArrows=81]="divergingArrows";z[z.basicCycle=82]="basicCycle";z[z.textCycle=83]="textCycle";z[z.blockCycle=84]="blockCycle";z[z.nondirectionalCycle=85]="nondirectionalCycle";z[z.continuousCycle=86]="continuousCycle";z[z.multidirectionalCycle=87]="multidirectionalCycle";z[z.segmentedCycle=
88]="segmentedCycle";z[z.basicPie=89]="basicPie";z[z.hexagonRadial=90]="hexagonRadial";z[z.radialCycle=91]="radialCycle";z[z.basicRadial=92]="basicRadial";z[z.divergingRadial=93]="divergingRadial";z[z.radialVenn=94]="radialVenn";z[z.cycleMatrix=95]="cycleMatrix";z[z.radialCluster=96]="radialCluster";z[z.organizationChart=97]="organizationChart";z[z.pictureOrganizationChart=98]="pictureOrganizationChart";z[z.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";z[z.halfCircleOrganizationChart=
100]="halfCircleOrganizationChart";z[z.circlePictureHierarchy=101]="circlePictureHierarchy";z[z.hierarchy=102]="hierarchy";z[z.labeledHierarchy=103]="labeledHierarchy";z[z.horizontalOrganizationChart=104]="horizontalOrganizationChart";z[z.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";z[z.horizontalHierarchy=106]="horizontalHierarchy";z[z.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";z[z.balance=108]="balance";z[z.circleRelationship=109]="circleRelationship";z[z.hexagonCluster=
110]="hexagonCluster";z[z.opposingIdeas=111]="opposingIdeas";z[z.plusandMinus=112]="plusandMinus";z[z.reverseList=113]="reverseList";z[z.counterbalanceArrows=114]="counterbalanceArrows";z[z.segmentedPyramid=115]="segmentedPyramid";z[z.nestedTarget=116]="nestedTarget";z[z.convergingRadial=117]="convergingRadial";z[z.radialList=118]="radialList";z[z.tabbedArc=119]="tabbedArc";z[z.basicTarget=120]="basicTarget";z[z.basicVenn=121]="basicVenn";z[z.linearVenn=122]="linearVenn";z[z.stackedVenn=123]="stackedVenn";
z[z.interconnectedRings=124]="interconnectedRings";z[z.basicMatrix=125]="basicMatrix";z[z.titledMatrix=126]="titledMatrix";z[z.gridMatrix=127]="gridMatrix";z[z.basicPyramid=128]="basicPyramid";z[z.invertedPyramid=129]="invertedPyramid";z[z.accentedPicture=130]="accentedPicture";z[z.circularPictureCallout=131]="circularPictureCallout";z[z.radialPictureList=132]="radialPictureList";z[z.snapshotPictureList=133]="snapshotPictureList";z[z.spiralPicture=134]="spiralPicture";z[z.captionedPictures=135]="captionedPictures";
z[z.bendingPictureCaption=136]="bendingPictureCaption";z[z.pictureFrame=137]="pictureFrame";z[z.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";z[z.bendingPictureBlocks=139]="bendingPictureBlocks";z[z.bendingPictureCaptionList=140]="bendingPictureCaptionList";z[z.titledPictureBlocks=141]="titledPictureBlocks";z[z.pictureGrid=142]="pictureGrid";z[z.pictureAccentBlocks=143]="pictureAccentBlocks";z[z.themePictureAccent=144]="themePictureAccent";z[z.themePictureGrid=145]="themePictureGrid";
z[z.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";z[z.alternatingPictureCircles=147]="alternatingPictureCircles";z[z.titlePictureLineup=148]="titlePictureLineup";z[z.pictureLineup=149]="pictureLineup";z[z.framedTextPicture=150]="framedTextPicture";z[z.bubblePictureList=151]="bubblePictureList";z[z.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";z[z.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";z[z.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";
z[z.accentHomeChevronProcess=155]="accentHomeChevronProcess";z[z.basicProcessNew=156]="basicProcessNew";z[z.basicTimelineNew=157]="basicTimelineNew";z[z.chevronBlockProcess=158]="chevronBlockProcess";z[z.hexagonTimeline=159]="hexagonTimeline";z[z.horizontalActionList=160]="horizontalActionList";z[z.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";z[z.roundedRectangleTimeline=162]="roundedRectangleTimeline";z[z.verticalDownArrowProcess=163]="verticalDownArrowProcess";z[z.verticalHollowActionList=
164]="verticalHollowActionList";z[z.verticalSolidActionList=165]="verticalSolidActionList";z[z.dropPinTimeline=166]="dropPinTimeline";z[z.horizontalLabelsTimeline=167]="horizontalLabelsTimeline";z[z.horizontalPathTimeline=168]="horizontalPathTimeline";z[z.iconLabelList=169]="iconLabelList";z[z.iconCircleList=170]="iconCircleList";z[z.iconLabelDescriptionList=171]="iconLabelDescriptionList";z[z.iconVerticalSolidList=172]="iconVerticalSolidList";z[z.iconCircleLabelList=173]="iconCircleLabelList";z[z.iconCircleOutlineLabelList=
174]="iconCircleOutlineLabelList";z[z.iconLeafLabelList=175]="iconLeafLabelList";z[z.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";z[z.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(qe||(qe={}));Object(h.b)("SmartArtLayout",qe);var yd=d(154),zf;(function(z){z[z.title=0]="title";z[z.body=1]="body";z[z.centerTitle=2]="centerTitle";z[z.subTitle=3]="subTitle";z[z.slideNum=5]="slideNum";z[z.footer=6]="footer";z[z.object=8]="object";z[z.graph=9]="graph";z[z.table=
10]="table";z[z.clipArt=11]="clipArt";z[z.orgChart=12]="orgChart";z[z.media=13]="media";z[z.picture=15]="picture"})(zf||(zf={}));Object(h.b)("PlaceholderType",zf);class xd{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc){this.T4="Existing";this.AIa="ExistingInMenu";this.NMe="AnimationExisting";this.OMe="AnimationExistingInMenu";this.ia=z;this.Vp=U;this.ra=la;this.o$b=Fc.Yj(kf.a.D9c);this.Db=Ia;this.Fa=Da;this.Zl=Db;this.Xb=Ob;this.Zxb=sc.pptAnimationMarkersEnabled;this.Ea=hc}ub(){this.ia.pa(Sc.a.Ldb,jd.a.application,
Object(v.a)(this,this.Ldb,"queryAnimationGallery"),97);this.ia.pa(Sc.a.ZAe,jd.a.application,Object(v.a)(this,this.ZAe,"queryMoreAnimationGallery"),96);this.ia.pa(Sc.a.$A,jd.a.application,Object(v.a)(this,this.$A,"setAnimation"),5);this.ia.pa(Sc.a.PFb,jd.a.application,Object(v.a)(this,this.$A,"setAnimation"),5);this.ia.pa(Sc.a.kjc,jd.a.application,Object(v.a)(this,this.$A,"setAnimation"),5);this.ia.pa(Sc.a.lfb,jd.a.application,Object(v.a)(this,this.$A,"setAnimation"),5);this.ia.pa(Sc.a.W7g,jd.a.application,
Object(v.a)(this,this.GAe,"queryEffectOptions"),100);this.ia.pa(Sc.a.jfb,jd.a.application,Object(v.a)(this,this.jfb,"setAnimationDirection"),5);this.ia.pa(Sc.a.Jdb,jd.a.application,Object(v.a)(this,this.Jdb,"queryAnimationDirection"),97);this.ia.pa(Sc.a.kfb,jd.a.application,Object(v.a)(this,this.kfb,"setAnimationEffectData"),4);this.ia.pa(Sc.a.Kdb,jd.a.application,Object(v.a)(this,this.Kdb,"queryAnimationEffectData"),96);this.ia.pa(Sc.a.JHe,jd.a.application,Object(v.a)(this,this.WHa,"setAnimationSequence"),
5);this.ia.pa(Sc.a.KHe,jd.a.application,Object(v.a)(this,this.WHa,"setAnimationSequence"),5);this.ia.pa(Sc.a.LHe,jd.a.application,Object(v.a)(this,this.WHa,"setAnimationSequence"),5);this.ia.pa(Sc.a.MHe,jd.a.application,Object(v.a)(this,this.WHa,"setAnimationSequence"),5);this.ia.pa(Sc.a.Mdb,jd.a.application,Object(v.a)(this,this.Mdb,"queryAnimationSequence"),97);this.ia.pa(Sc.a.geh,jd.a.application,Object(v.a)(this,this.N9,"reorderAnimation"),4);this.ia.pa(Sc.a.heh,jd.a.application,Object(v.a)(this,
this.N9,"reorderAnimation"),4);this.ia.pa(Sc.a.gDb,jd.a.application,Object(v.a)(this,this.gDb,"populateAnimationEffectOptions"),96);this.ia.pa(Sc.a.ifb,jd.a.application,Object(v.a)(this,this.ifb,"setAnimationColor"),4)}we(){}gDb(z,U,la,Da,Ia){z=this.nS();U=this.ra.Ip();if(!U||!z)return 8;if(1===la)return 32;la=xd.s2(U,z);if(!la||0===la.EffectId)return 16;Ia.MenuItems=this.gdi(la,U,z);return 32}Ldb(z,U,la,Da,Ia){z=Ia.queryResult;Ia=Ia.SourceControlId;var Db=Da=-1;Ia!==this.T4&&({effectType:Db,effectId:Da}=
this.Zl.pLc(Ia));U=this.nS();var Ob=this.ra.Ip();if(!Ob||!U)return 8;if(1!==la)return 32;({image:la,label:Fc}=this.Zl.qLc(Ia));var sc=Fc;if(Ia===this.T4||Ia===this.AIa)sc=ResourceStrings.L_ExistingButtonDescription;this.O5a(Ia,la,Fc,z,sc);var hc=xd.s2(Ob,U);var Fc=hc?hc.EffectId:0;sc=hc?hc.EffectType:0;const Xc=!this.Zl.b8a(hc,U);hc=this.Zl.A9d(hc,U);this.Zxb&&(Ob=Ob?Ob.qQa(U):null,hc=hc&&!this.Zl.oMj(Ob));Da=!Xc&&!hc&&Da===Fc&&Db===sc;Db=Xc?!1:this.Zl.LRc(sc,Fc);Ia===this.T4||Ia===this.AIa?(Db=Ia===
this.T4?this.ACk(this.T4,z,hc,Db,la,sc,Fc):xd.yCk(z,hc,Db),z.TT(Xc||hc||Db)):U&&z.TT(Da);return 32}ACk(z,U,la,Da,Ia,Db,Ob){la?this.O5a(z,Ia,ResourceStrings.L_AnimationMultiple,U,ResourceStrings.L_AnimationMultiple):Da&&(Ia=this.Zl.nNc(Db,Ob),{image:Ia,label:la}=this.Zl.qLc(Ia),this.O5a(z,Ia,la,U,la));return Da}O5a(z,U,la,Da,Ia){let Db;Db=z===this.T4?"298832323":z===this.AIa?"1264919631":"2676673376";U=U.substring((kf.a.Aec+"_").length,U.length-6);z=Object.assign(new eg.a,{Id:z,ExternalId:"Animation"+
z,Icon:U,Command:Db,QueryCommand:"1852964326",LabelText:la,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Ia});Da.h2=z}ZAe(z,U){if(U.contextId!==jd.a.application)return 2;z=this.nS();return!this.ra.Ip()||!z||z.HV||z.Nq||z.Lp?8:this.Xb.Zc(z)?16:32}$A(z,U,la,Da,Ia){U=this.nS();var Db=this.ra.Ip();if(!Db||!U||U.HV||U.Nq||U.Lp)return 8;if(this.Xb.Zc(U))return 16;var Ob=(Da=xd.s2(Db,U))?Da.EffectId:-1,sc=Da?Da.EffectType:-1;if(1===la)return z===
Sc.a.kjc||z===Sc.a.lfb?(Db=this.Zl.LRc(sc,Ob),la=!!Da&&!this.Zl.b8a(Da,U),z===Sc.a.lfb&&(Db=la?!0:!1),U=!!Da&&this.Zl.A9d(Da,U),U=la||U,Db||U?32:16):z===Sc.a.PFb?U.nd||U.Pq||U.Lp?16:32:32;z=Ia.SourceControlId;if(!z)return 8;if(z===this.T4||z===this.AIa||z===this.NMe||z===this.OMe)return 32;({effectType:Ia,effectId:la}=this.Zl.pLc(z));Ob=this.Zl.V0i(z);sc=this.Zl.S0i(z);Da=U.NCa()?xd.j0b(Db,U):Da;Da||(Da=new yg,Da.Id=U.id.toString(),Da.BuildIds=[Db.UXb+1],Da.HasTrigger=!1,Da.BuildId=Db.UXb+1,Da.SequenceIndex=
0,Da.IsTextRangeType=!1);Da.HasExisting=!1;Da.HasMultiple=!1;Da.EffectType=Ia;Da.SequenceId=1;Da.EffectId=la;Da.Direction=Ob;Da.EffectData=sc;Da.IsTrigger=!1;this.KYb(Db,U,Da);e.ULS.sendTraceTag(512500802,800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",z,Db.Bb.sid,U.id);this.FXj(Db);return 32}ifb(z,U,la,Da,Ia){U=this.Vp.presentation;if(!U)throw Error.argumentNull("Presentation is null");z=this.nS();if(!z)return 8;U=Object(A.a)(123,U.KB(z.slideId));if(!U)return 8;
Da=xd.s2(U,z);if(!(Da&&Ia&&U&&z))return 8;if(this.Xb.Zc(z))return 16;if(1===la)return 32;la=yd.Box4ColorHelper.s0(Ia);la=yd.Box4ColorHelper.REb(la,U.Se);if(!la)return 8;Da.EffectData=String.format("{0},{1},{2}",la.r.toString(16),la.g.toString(16),la.b.toString(16));this.KYb(U,z,Da);return 32}GAe(){const z=this.nS();var U=this.ra.Ip();return U&&z?this.Xb.Zc(z)?16:(U=xd.s2(U,z))&&this.Zl.nii(z,this.Ea,U)?32:16:8}N9(z,U,la){U=this.nS();const Da=this.ra.Ip();if(!Da||!U)return 8;if(this.Xb.Zc(U))return 16;
const Ia=xd.j0b(Da,U);let Db;switch(z){case Sc.a.geh:Db=!1;break;case Sc.a.heh:Db=!0;break;default:return 8}let Ob=!1;if(U&&(Ob=!!Ia&&!Ia.HasTrigger&&1===Ia.BuildIds.length)){let sc=!1,hc=!1;({wUb:sc,yUb:hc}=xd.sii(Da,Ia));Ob=Db?hc&&Ob:sc&&Ob}if(1===la)return Ob?32:8;if(Ob){la=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{la.jc(Da),la.$c=z,Da.N9(U,Db)}finally{la&&la.dispose()}}return 32}jfb(z,U,la,Da,Ia){z=this.nS();U=this.ra.Ip();if(!U||!z)return 8;if(1===la)return 32;if(this.Xb.Zc(z))return 16;
la=xd.j0b(U,z);if(!la)return 8;Ia=Ia.MenuItemId;la.Direction=this.Zl.r_b(Ia);this.KYb(U,z,la);e.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.Zl.nNc(la.EffectType,la.EffectId),Ia,U.sid,z.id);return 32}Jdb(z,U,la,Da,Ia){U=this.nS();Da=this.ra.Ip();if(!Da||!U)return 8;z=Ia.queryResult;Ia=this.Zl.r_b(Ia.MenuItemId);U=xd.s2(Da,U);1===la&&U&&z.Kf(U.Direction===Ia);return 32}WHa(z,U,la,Da,Ia){z=Ia.MenuItemId;
U=this.nS();Da=this.ra.Ip();if(!Da||!U)return 8;if(1===la)return 32;if(this.Xb.Zc(U))return 16;la=xd.j0b(Da,U);if(!la)return 8;la.SequenceId=this.Zl.t0d(z);this.KYb(Da,U,la);return 32}Mdb(z,U,la,Da,Ia){z=this.nS();U=this.ra.Ip();if(!U||!z)return 8;z=xd.s2(U,z);U=Ia.queryResult;Ia=this.Zl.t0d(Ia.MenuItemId);1===la&&z&&U.Kf(z.SequenceId===Ia);return 32}kfb(z,U,la,Da,Ia){z=this.nS();U=this.ra.Ip();if(!U||!z)return 8;if(1===la)return 32;if(this.Xb.Zc(z))return 16;la=xd.j0b(U,z);if(!la)return 8;if(!Ia)return 2;
la.EffectData=this.Zl.mYd(Ia.MenuItemId);this.KYb(U,z,la);return 32}Kdb(z,U,la,Da,Ia){z=this.nS();U=this.ra.Ip();if(!U||!z)return 8;z=xd.s2(U,z);1===la&&z&&Ia.queryResult.Kf(this.Zl.kPf(z.EffectData,Ia.MenuItemId));return 32}KYb(z,U,la){const Da=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{Da.jc(z),z.Ejc(U,la)}finally{Da&&Da.dispose()}}gdi(z,U,la){const Da=Object.assign(new Bh.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,MenuSectionList:[]});
Array.add(Da.MenuSectionList,this.Zl.QMc(z.EffectId,z.EffectType,"Direction","2289594085","3782857737"));this.Zl.Hrg(z)&&(Array.add(Da.MenuSectionList,Jh.f(U.Se,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Array.add(Da.MenuSectionList,Jh.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(Da.MenuSectionList,this.Zl.QMc(z.EffectId,z.EffectType,"EffectData","2949363495",
"4132852551"));Array.add(Da.MenuSectionList,this.Zl.J$i(la,this.Ea,z));return Da}FXj(z){if(z){var U=z.om(),la=String.format("{0}#{1}",z.sid,z.cid);if(U&&0<U.length)for(const Da of U)if(U=z.ZBa(Da)){const Ia=U.EffectId,Db=U.EffectType,Ob=U.Direction,sc=this.Zl.nNc(Db,Ia),hc=this.Ea.Y9f(Da),Fc=xd.pcj(Da,hc);e.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",
sc,Ia,Db,Ob,Da.jD().length,hc,Fc,U.SequenceId,la,Da.id)}}}nS(){const z=this.ra.jq();return z?z.get_smartArtModelId()?this.Ea.er(z):z.mh?this.Ea.Pr(z):z:null}static yCk(z,U,la){U?z.M5a=ResourceStrings.L_AnimationMultiple:(z.M5a=ResourceStrings.L_AnimationExisting,la&&(la=!1));return la}static sii(z,U){let la,Da;if(!U)return{wUb:!1,yUb:!1};const Ia=z.wSd,Db=z.UXb,Ob=U.BuildIds[0];Da=la=!0;0===U.StartType?la=Ob>Ia?!0:!1:Da=Ob<Db?!0:!1;if(Ob===Ia||Ob===Db){if(!Ob)return{wUb:!1,yUb:Da};for(const sc of z.rP)if(sc.Id!==
U.Id)for(const hc of sc.BuildIds)if(0===U.StartType){if(hc>=Ob)return Da=!0,{wUb:la,yUb:Da}}else if(hc===Ob)return la=!0,{wUb:la,yUb:Da};0===U.StartType?Da=!1:la=!1}return{wUb:la,yUb:Da}}static s2(z,U){return z&&U?z.s2(U):null}static j0b(z,U){return z&&U?z.ZBa(U):null}static pcj(z,U){return 24===U?qe[z.smartArtInfo.SmartArtLayout]:1===U?z.shapeType.toString():14===U?zf[z.zj]:"Unknown"}}Object(h.a)(xd,"AnimationActorLegacy",null,[244]);class fg{constructor(z,U,la,Da){this.tf=null;this.Ca=z;this.bjb=
U;this.oMh=la;this.Azd=Da;this.Azd.init();this.bjb.init()}ub(){this.Ca.pa(ld.a.L8c,jd.a.application,Object(v.a)(this,this.L8c,"openGrammarSettings"),1028);this.Ca.xa(ld.a.d1b,dc.a.frame,Object(v.a)(this,this.mgg,"grammarDialogTabFocusHandler"));this.Ca.xa(ld.a.c1b,dc.a.frame,Object(v.a)(this,this.mgg,"grammarDialogTabFocusHandler"));this.Ca.xa(ld.a.eOc,dc.a.frame,Object(v.a)(this,this.lgg,"grammarDialogOptionFocusHandler"));this.Ca.xa(ld.a.dOc,dc.a.frame,Object(v.a)(this,this.lgg,"grammarDialogOptionFocusHandler"))}L8c(z,
U,la,Da,Ia){z=this.l8f();if(1===la)return this.Azd.request(z).result&&this.Azd.request(z).result.length?6===this.bjb.K0a.status?32:8:8;this.tf=this.oMh(z,this.bjb.K0a.result);this.tf.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,Db=>{e.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===Db?"OK":0===Db?"Cancel":"");1===Db&&(this.tf.sPj()?(e.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),this.bjb.saveSettings(this.tf.settings)):e.ULS.sendTraceTag(36508631,375,
50,"User click OK with but not update setting"))});z=la="";Ia&&(la+=Ia.SourceControlId,z+=Ia.Alt);e.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+la+", Alt: "+z);return 32}l8f(){return K.AFrameworkApplication.lcid}mgg(z){if(!this.tf)return 2;var U=this.tf.so.Zk().qj.YY;if(U===this.tf.wv&&z===ld.a.d1b||U===this.tf.jXa&&z===ld.a.c1b)this.tf.p6?this.tf.so.Zk().qj.fE(this.tf.p6):this.tf.UYk();else if(Sys.UI.DomElement.containsCssClass(U,Ud.JWb)||U.parentNode&&Sys.UI.DomElement.containsCssClass(U.parentNode,
Ud.JWb))U=null,z===ld.a.d1b?U=this.tf.jXa:z===ld.a.c1b&&(U=this.tf.wv),this.tf.so.Zk().qj.fE(U);else if(z===ld.a.d1b)this.tf.so.Zk().mBb();else if(z===ld.a.c1b)this.tf.so.Zk().kBb();else return 2;return 32}lgg(z){if(!this.tf)return 2;let U=this.tf.so.Zk().qj.YY;if(U===this.tf.wv||U===this.tf.jXa||U===this.tf.DC)return 2;z===ld.a.dOc&&this.tf.so.Zk().mBb();z===ld.a.eOc&&this.tf.so.Zk().kBb();U=this.tf.so.Zk().qj.YY;U===this.tf.jXa?this.tf.so.Zk().kBb():U===this.tf.wv?this.tf.so.Zk().mBb():this.tf.p6=
U;return 32}}Object(h.a)(fg,"GrammarSettingsActor",null,[]);class Ki extends fg{constructor(z,U,la,Da,Ia,Db,Ob){super(z,U,la,Da);this.nb=Ia;this.sle=Db;this.Ea=Ob}l8f(){let z=K.AFrameworkApplication.lcid;if(this.nb.BZ(this.nb.Oa)){var U=this.nb.ae();U&&1===U.length&&(U=this.Ea.ZPa(U[0]),0<U&&(z=U))}else this.nb.Oa.kb&&(U=this.sle.cMc(this.nb.Dj),0<U&&(z=U));return z}}Object(h.a)(Ki,"EditorSettingsActor",fg,[]);var jg=d(63),Ch=d(324),ih=d(256),qh=d(433),Md=d(41),Ed=d(40);class Bd{constructor(z,U,la,
Da,Ia,Db,Ob,sc,hc,Fc,Xc,md){this.Jaa=null;this.ia=z;this.Fa=U;this.Xb=la;this.ra=Da;this.Db=Ia;this.KW=Db;this.ta=Ob;this.Lz=sc;this.nF=hc;this.Qle=Fc;this.Kd=Xc;this.Ga=md}ub(){this.Ga.ZKj?(this.ia.pa(Sc.a.G5a,jd.a.application,Object(v.a)(this,this.d3d,"handleSlidesSolidFill"),4),this.ia.pa(Sc.a.nWd,jd.a.application,Object(v.a)(this,this.d3d,"handleSlidesSolidFill"),4),this.ia.pa(Sc.a.oWd,jd.a.application,Object(v.a)(this,this.d3d,"handleSlidesSolidFill"),4),this.ia.pa(Sc.a.mWd,jd.a.application,
Object(v.a)(this,this.c3d,"handleSlidesPicture"),4),this.ia.pa(Sc.a.N4f,jd.a.application,Object(v.a)(this,this.c3d,"handleSlidesPicture"),4),this.ia.pa(Sc.a.O4f,jd.a.application,Object(v.a)(this,this.c3d,"handleSlidesPicture"),4),this.ia.pa(Sc.a.MJc,jd.a.application,Object(v.a)(this,this.apj,"handleSlidesFinalizePicture"),4)):(this.ia.pa(Sc.a.G5a,jd.a.application,Object(v.a)(this,this.e3d,"handleSolidFill"),4),this.ia.pa(Sc.a.nWd,jd.a.application,Object(v.a)(this,this.e3d,"handleSolidFill"),4),this.ia.pa(Sc.a.oWd,
jd.a.application,Object(v.a)(this,this.e3d,"handleSolidFill"),4),this.ia.pa(Sc.a.mWd,jd.a.application,Object(v.a)(this,this.U2d,"handlePicture"),4),this.ia.pa(Sc.a.N4f,jd.a.application,Object(v.a)(this,this.U2d,"handlePicture"),4),this.ia.pa(Sc.a.O4f,jd.a.application,Object(v.a)(this,this.U2d,"handlePicture"),4),this.ia.pa(Sc.a.MJc,jd.a.application,Object(v.a)(this,this.klj,"handleFinalizePicture"),4));this.ia.pa(Sc.a.lWd,jd.a.application,Object(v.a)(this,this.y2d,"handleApplyAll"),4);this.ia.pa(Sc.a.eUi,
jd.a.application,Object(v.a)(this,this.y2d,"handleApplyAll"),4);this.ia.pa(Sc.a.fUi,jd.a.application,Object(v.a)(this,this.y2d,"handleApplyAll"),4);this.ia.pa(Sc.a.P4g,jd.a.application,Object(v.a)(this,this.hnj,"handlePopulateFillMenu"),96);this.ia.pa(Sc.a.jwk,jd.a.application,Object(v.a)(this,this.inj,"handlePopulateFillMenuForCanvasContextMenu"),96);this.ia.pa(Sc.a.kwk,jd.a.application,Object(v.a)(this,this.jnj,"handlePopulateFillMenuForThumbnailPaneContextMenu"),96);this.ia.pa(Sc.a.dse,jd.a.application,
Object(v.a)(this,this.qmj,"handleMoreFormatBackgroundColors"),96);this.ia.pa(Sc.a.q$c,jd.a.application,Object(v.a)(this,this.rmj,"handleMoreFormatBackgroundColorsResponse"),4)}we(){}hnj(z,U,la,Da,Ia){z=this.ta.Ba;if(!z||this.Xb.Zc(z))return 16;if(1===la)return 32;if(!Ia)return Uc.a.J(512500616,822,10,"HandlePopulateFillMenu requires actionData"),8;la=z.Se;if(!la)return Uc.a.J(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),8;z=this.KW.yf.J1;U=Object.assign(new Bh.a,
{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(U.MenuSectionList,Jh.f(la,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","3049223287",1));Array.add(U.MenuSectionList,Jh.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));z&&0<z.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(U.MenuSectionList,Jh.c(z,"Recent Colors","Color.Menu.Controls",
"recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));Array.add(U.MenuSectionList,Jh.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ia.MenuItems=U;return 32}inj(z,U,la,
Da,Ia){z=this.ta.Ba;if(!z||this.Xb.Zc(z))return 16;if(1===la)return 32;if(!Ia)return Uc.a.J(512623376,822,10,"HandlePopulateFillMenuForCanvasContextMenu requires actionData"),8;U=z.Se;if(!U)return Uc.a.J(512623374,822,10,"HandlePopulateFillMenuForCanvasContextMenu failed to get theme information from slide"),8;la=this.KW.yf.J1;Da=Sc.a.nWd.toString();z=Object.assign(new Bh.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});z.MenuSectionList.push(Jh.f(U,"Theme Colors","Color.Menu.Controls","themeColor",
"FormatBackgroundThemeColorsFromCanvas",Da,1));z.MenuSectionList.push(Jh.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColorsFromCanvas",Da,!1));U=Sc.a.q$c.toString();la&&0<la.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),z.MenuSectionList.push(Jh.c(la,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",U,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",
!0));z.MenuSectionList.push(Jh.a("More Format Background Color","Color.Menu.Controls",Sc.a.dse.toString(),ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ia.MenuItems=z;return 32}jnj(z,U,la,Da,Ia){z=this.ta.Ba;if(!z||this.Xb.Zc(z))return 16;if(1===la)return 32;if(!Ia)return Uc.a.J(512623375,822,10,"HandlePopulateFillMenuForThumbnailPaneContextMenu requires actionData"),
8;U=z.Se;if(!U)return Uc.a.J(512623373,822,10,"HandlePopulateFillMenuForThumbnailPaneContextMenu failed to get theme information from slide"),8;la=this.KW.yf.J1;Da=Sc.a.oWd.toString();z=Object.assign(new Bh.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});z.MenuSectionList.push(Jh.f(U,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColorsFromThumbnailPane",Da,1));z.MenuSectionList.push(Jh.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColorsFromThumbnailPane",
Da,!1));U=Sc.a.q$c.toString();la&&0<la.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),z.MenuSectionList.push(Jh.c(la,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",U,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));z.MenuSectionList.push(Jh.a("More Format Background Color","Color.Menu.Controls",Sc.a.dse.toString(),ResourceStrings.l_MoreFormatBackgroundColors,
"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ia.MenuItems=z;return 32}e3d(z,U,la,Da,Ia){U=this.ta.Ba;if(!U||this.Xb.Zc(U)||this.Ga.yz&&1!==this.ra.mf().length)return 16;if(1===la)return 32;la=Bd.uec(Ia);if(!la)return 8;Md.a.Cb&&Md.a.Cb.Wa("SlideCount","1");Ia=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()});try{Ia.jc(U),Ia.$c=z,U.e3a=la}finally{Ia&&Ia.dispose()}return 32}d3d(z,U,la,Da,
Ia){U=this.ra.mf();if(!U||!U.length)return 16;for(const Db of U)if(!Db||this.Xb.Zc(Db))return 16;if(1===la)return 32;la=Bd.uec(Ia);if(!la)return 8;Md.a.Cb&&Md.a.Cb.Wa("SlideCount",U.length.toString());Ia=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()});try{Ia.jc(this.ta.Ba);Ia.$c=z;for(const Db of U)Db.e3a=la}finally{Ia&&Ia.dispose()}return 32}U2d(z,U,la){this.Jaa=this.ta.Ba;if(!this.Jaa||this.Xb.Zc(this.Jaa)||jg.a.xz(this.Jaa.Bb)||this.Ga.yz&&1!==this.ra.mf().length)return 16;if(1===la)return 32;
this.Gkc(!1);return 32}c3d(z,U,la){this.Jaa=this.ta.Ba;z=this.ra.mf();if(!z||!z.length)return 16;for(const Da of z)if(!Da||this.Xb.Zc(Da)||jg.a.xz(Da.Bb))return 16;if(1===la)return 32;this.Gkc(!1);return 32}y2d(z,U,la){U=this.ta.Ba;if(!U||this.Xb.Zc(U))return 16;if(1===la)return 32;la=U.Bb;U=this.KW.yf;if(!U)return 8;const Da=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()});try{Da.jc(U),Da.$c=z,U.mnb=la}finally{Da&&Da.dispose()}return 32}klj(z,U,la,Da,Ia){if(!this.Jaa||!this.Jaa.isConnected||
this.Ga.yz&&1!==this.ra.mf().length)return 16;if(1===la)return 32;this.nF.vva=new Date;const Db=Md.a.Cb;this.Lz.Uhd(Ia,Ob=>{Md.a.jK(Db,()=>{this.V2d(Ob,z)})},Ob=>{this.e7a(Ob.error)});this.ta.Ba===this.Jaa&&(this.Fa.Ad(),this.ra.Ph());return 32}apj(z,U,la,Da,Ia){U=this.ra.mf();if(!U||!U.length)return 16;for(const Ob of U)if(!Ob||!Ob.isConnected)return 16;if(1===la)return 32;this.nF.vva=new Date;const Db=Md.a.Cb;this.Lz.Uhd(Ia,Ob=>{Md.a.jK(Db,()=>{this.cpj(Ob,z)})},Ob=>{this.e7a(Ob.error)});this.ta.Ba===
this.Jaa&&(this.Fa.Ad(),this.ra.Ph());return 32}qmj(z,U,la,Da,Ia){z=this.ta.Ba;if(!z||this.Xb.Zc(z))return Uc.a.J(512500611,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),16;if(this.Ga.yz&&Ed.a("MoreColorBackgroundForMultipleSlidesEnabled")?1>this.ra.mf().length:1!==this.ra.mf().length)return 16;if(1===la)return this.ia.Ka(Sc.a.renderColorPicker,1,Ia);la=ih.a.parse(z.KY);if(!la)return 8;Ia=la.iJa();la=null;Ia&&(la=yd.Box4ColorHelper.Wqa(Ia));Ia={};Ia.currentColor=la;Ia.handleCommand=
Sc.a.q$c;return this.ia.Ka(Sc.a.renderColorPicker,2,Ia)}rmj(z,U,la,Da,Ia){if(1===la)return this.ia.Ka(Sc.a.G5a,la,Ia);if(!Ia)return Uc.a.J(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),16;z=this.ia.Ka(Sc.a.G5a,la,Ia);32===z&&this.ia.Ka(Sc.a.xza,la,Ia);return z}Gkc(z){this.Qle?qh.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.Lz&&(this.Lz.AJb=1,this.Lz.z7g(z))}V2d(z,U){this.nF.uva=new Date;(z=z.result)?this.yLd(z,U):(U=Object.assign(new Ch.a,
{Code:94}),this.e7a(U))}cpj(z,U){this.nF.uva=new Date;(z=z.result)?this.$ji(z,U):(U=Object.assign(new Ch.a,{Code:94}),this.e7a(U))}yLd(z,U){const la=this.Db.rd(15);try{la.jc(this.Jaa),la.$c=U,this.Jaa.wA=z.ItemId}finally{la&&la.dispose()}if(z=Md.a.Cb)z.actionName="FormatBackgroundPicture",z.Wa("PictureUploadStart",Md.a.Ye(this.nF.vva)),z.Wa("PictureUploadDurationMS",(+this.nF.uva-+this.nF.vva).toString())}$ji(z,U){const la=this.ra.mf(),Da=this.Db.rd(15);try{Da.jc(this.Jaa);Da.$c=U;for(const Ia of la)Ia.wA=
z.ItemId}finally{Da&&Da.dispose()}if(z=Md.a.Cb)z.actionName="FormatBackgroundPicture",z.Wa("PictureUploadStart",Md.a.Ye(this.nF.vva)),z.Wa("PictureUploadDurationMS",(+this.nF.uva-+this.nF.vva).toString())}e7a(z){this.nF.uva=new Date;this.Kd.qG(z.Code,U=>{U.xB=1;U.ePa=z.ExtraErrorParam;return!1})}static uec(z){return ih.a.parse(z.Color)}}Object(h.a)(Bd,"FormatBackgroundActor",null,[244]);var Xh=d(75),$f=d(31),Vi=d(405),ci=d(30),Bi=d(151);const bh=z=>{let U=z.isBold?"b:1;":"";U+=z.isItalic?"i:1;":"";
U+=z.pD?"u:1;":"";U+=z.bF?"s:1;":"";U+=z.isSuperscript?"sup:1;":"";return U+=z.cF?"sub:1;":""},Wg=(z,U,la)=>{let Da=null;for(var Ia,Db=$f.ParagraphReader.text(z),Ob=0;z.Ra&&Ob<z.Ra.length;){var sc=z.Ra.ga(Ob),hc=sc.cp;Ia=Ob<z.Ra.length-1?z.Ra.ga(Ob+1).cp:$f.ParagraphReader.textLength(z);if(-1!==U&&Ia<=U)Ob++;else{if(-1!==la&&hc>la)break;var Fc="";sc.formatting?Fc=bh(sc.formatting.cache):(sc=Vi.c(z.Ra,sc.cp).RUc)&&(Fc=bh(sc.cache));sc=hc;-1!==U&&(sc=Math.max(U,hc));hc=Ia;-1!==la&&(hc=Math.min(la,Ia));
hc=I.a.substring(Db,sc,hc);0<hc.length&&(Ia=document.createElement("span"),Ia.setAttribute("style",Fc),Ia.innerText=hc,Da||(Da=document.createElement("p")),Da.appendChild(Ia));Ob++}}if(Da&&$f.ParagraphReader.MV(z)){U=Da;la=U.setAttribute;Ob=new ci.GraphIterator;Ob.set(z);Ob.mc(11);Ob.Ng(11);Db="";if(z.Rf.Fw(Ob))switch(Ob=z.Rf.Fw(Ob),z=$f.ParagraphReader.fdb(z),Fc=Ob.YV,Ob.listType){case 0:switch(Ob.listStyle){case 1:Db="decimal";break;case 2:Db="loweralpha";break;case 3:Db="lowerroman";break;case 4:Db=
"upperalpha";break;case 5:Db="upperroman";break;default:Db="decimal"}Db=String.format("lt:{0};in:{1};li:{2}",Db,z,Fc);break;case 1:switch(Ob.listStyle){case 1:Db="disc";break;case 2:Db="circle";break;case 3:Db="square";break;default:Db="disc"}Db=String.format("lt:{0};in:{1}",Db,z)}la.call(U,"style",Db)}return Da},jf=z=>{if(z){var U;(U=Z.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?U=U.XM(z):(Uc.a.J(512500561,822,10,"ImmersiveReader: TableReader is null."),U=null);if(U){z=null;U=U.D0b();
for(let la=0;la<U.length;la++){const Da=kg(Object(A.a)(Xh.AParagraphNode,U[la].mZb));z=vh(Da,z)}return z}z=Array.isArray(z.jD())?z.jD():null;return kg(z&&0<z.length?z[0]:null)}return null},kg=z=>{let U=null;for(;z;){const la=Wg(z,-1,-1);U=vh(la,U);z=$f.ParagraphReader.pra(z,!1,!0,!1)}return U},vh=(z,U)=>{z&&(U||(U=document.createElement("div")),U.appendChild(z));return U},nd=z=>{const U=Object.assign(new Bi.a,{Source:6});Z.a.instance.resolve("PowerPointWebEditor.IErrorHandler").Rr(U,z,la=>{la.xB=
1;la.$za=0;la.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;la.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;return!1})};class Oe{constructor(z,U,la,Da){this.JHg=!1;this.w2c="";this.ia=z;this.Fa=U;this.nb=la;const Ia=new Date;Da("immersiveReader").then(()=>{this.JHg=!0;Uc.a.J(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",+new Date-+Ia)}).catch(Db=>{const Ob=+new Date-+Ia;Uc.a.J(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",
Ob,Db.toString());const sc=new Map;sc.set("JSLoadDurationInMs",Ob.toString());sc.set("Exception",Db.toString());u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,Object.assign(new Ba.a,{extendedProperties:sc}))})}ub(){this.ia.xa(Sc.a.immersiveReader,jd.a.view,Object(v.a)(this,this.jlg,"immersiveReaderHandler"));this.ia.xa(Sc.a.klg,jd.a.view,Object(v.a)(this,this.jlg,"immersiveReaderHandler"))}we(){this.Fa.Bc(hh.a.sP).bindAction(Ua.KeyInputManager.Na(tg.a.ooc,Ua.KeyInputManager.Fe|
4),Sc.a.immersiveReader)}vXi(z){let U="";for(z=Object(A.a)(Xh.AParagraphNode,z.node);z;){const la=$f.ParagraphReader.pra(z,!0,!0,!1);if(la)z=la;else break}for(;z;)U+="\n"+$f.ParagraphReader.text(z),z=$f.ParagraphReader.pra(z,!1,!0,!1);return U}Vdi(){var z=this.nb.mf();let U=null;if(!z)return null;for(const la of z)if(z=la.rQa())for(const Da of z)z=jf(Da),U=vh(z,U);return U}Udi(){let z=null;var U=this.nb.Oa;if(!U)return null;for(let Ia of U)if(Ia)for(U=0;U<Ia.length;U++){var la=Ia.ga(U),Da=null;if(la.contextId===
jd.a.outline||la.contextId===jd.a.Lf)if($f.ParagraphReader.Wd(la.node)){for(la=Object(A.a)(Xh.AParagraphNode,la.node);la;)if(Da=$f.ParagraphReader.pra(la,!0,!0,!1))la=Da;else break;Da=kg(la)}else Da=jf(Object(A.a)(4,la.node));else la.contextId!==jd.a.endOfParagraph&&$f.ParagraphReader.Wd(la.node)&&(Da=Wg(Object(A.a)(Xh.AParagraphNode,la.node),la.Qa,la.Kb));z=vh(Da,z)}return z}Zdi(){let z;return(z=this.nb.ku()?this.Vdi():this.Udi())?z.innerHTML:""}gfj(){let z="";const U=this.nb.Oa.kb;if(U)for(let la=
0;la<U.length;la++){const Da=U.ga(la),Ia=Da.Qa,Db=Da.Kb-Ia;let Ob;if($f.ParagraphReader.Wd(Da.node))switch(Ob=Da.node.characterData,Da.contextId){case jd.a.paragraph:z+=Ob+"\r";break;case jd.a.textRange:0<Db&&(z+=Ob.substr(Ia,Db));break;case jd.a.endOfParagraph:z+="\r";break;case jd.a.Lf:z+=this.vXi(Da)}}return z}tzg(){const z=new XMLHttpRequest,U=Z.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var la=Z.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;
la=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",la,U);z.open("GET",la,!0);const Da=D.a.create().toString();z.setRequestHeader("X-UserSessionId",K.AFrameworkApplication.userSessionId);z.setRequestHeader("X-CorrelationID",Da);z.setRequestHeader("X-WacCluster",Z.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").Wj);let Ia=null;const Db=new Map;z.onreadystatechange=()=>{if(4===z.readyState)if(200===z.status){var Ob=+new Date-+Ia;Uc.a.J(512500567,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",
Ob);Db.set("AuthTokenDurationInMs",Ob.toString());Ob=z.responseText.replace('"',"");const sc=new Date,hc=Ed.a("EnableSendingHTMLToIR")?[{["content"]:this.w2c,["mimeType"]:"text/html"}]:[{["content"]:this.w2c}];immersiveReader.launchAsync(Ob,null,{["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:hc},null).then(Fc=>{Fc=(Fc=Object(A.a)(Object,Fc))?Fc.sessionId:"";const Xc=+new Date-+sc,md=+new Date-+Ia;Uc.a.J(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",
Xc,Fc);Db.set("LaunchAsyncDurationInMs",Xc.toString());Db.set("IRResponseSessionId",Fc);Db.set("UserPerceivedDurationInMs",md.toString());u.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",Object.assign(new Ba.a,{extendedProperties:Db}))}).catch(Fc=>{nd(U);const Xc=+new Date-+sc,md=+new Date-+Ia;Uc.a.J(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",Xc,Fc);Db.set("LaunchAsyncDurationInMs",Xc.toString());Db.set("ErrorJson",Fc.toString());Db.set("UserPerceivedDurationInMs",
md.toString());u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,Object.assign(new Ba.a,{extendedProperties:Db}))})}else nd(U),Ob=+new Date-+Ia,Uc.a.J(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",Ob,z.status,Da),Db.set("CorrelationId",Da),Db.set("StatusCode",z.status.toString()),Db.set("UserPerceivedDurationInMs",Ob.toString()),u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered",
"RequestForAuthTokenFailed",!1,!0,Object.assign(new Ba.a,{extendedProperties:Db}));else Uc.a.J(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",Da,z.status)};Ia=new Date;Uc.a.J(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",Ia.getTime(),Da);la=new Map;la.set("CorrelationId",Da);la.set("Info","RequestingAuthToken");u.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",1,null,la);z.send(null)}jlg(z,
U,la){if(1===la||6===this.ia.gq){if(!this.JHg)return 8;this.w2c=Ed.a("EnableSendingHTMLToIR")?this.Zdi():this.gfj();if(""===this.w2c)return 8}2===la&&this.tzg();return 32}}Object(h.a)(Oe,"ImmersiveReaderActor",null,[244]);var ti=d(572),Kh=d(768);class Rd{constructor(z){this.customData=null;this.uP=z}}Object(h.a)(Rd,"PropertySetChangedState",null,[]);class Bj{static zAk(z,U,la){if(z&&U){var Da=new Rd(U),Ia=(Db,Ob,sc)=>{la.yAk(Db,Ob,sc,Da)};z=new Kh.a(U,z);z.Tzc=Ia;z.DCc=Ia;z.Icd=Ia;z.Zda()}}}Object(h.a)(Bj,
"PropertySetChangedManager",null,[]);class ui{constructor(z){this.HSh=z}yAk(z,U,la,Da){const Ia=this.HSh[z.id.toString()];Ia&&Ia(z,U,la,Da)}}Object(h.a)(ui,"PropertyChangedProcessor",null,[]);var Na=d(1056),qb=d(429),wb=d(57),jc=d(571),Qc=d(388),Cd=d(937);class Ld{constructor(){this.uAe=this.oVc=this.bQc=null}}Object(h.a)(Ld,"ParagraphDialogResults",null,[]);class ie extends sb.a{constructor(z,U,la){super(void 0,void 0,!0);this.$sa=null;if(null===z)throw Error.argumentNull("properties");this.Mca=
z.clone();this.G8=z.clone();this.FA=la;this.ia=U;this.M6j=new ib.a(Object(v.a)(this,this.wzi,"createPropertyChangedHandlers"))}ahd(){this.kg="ParagraphDialog";const z={};z.bodyControls=this.nXd();this.pj(ResourceStrings.L_ParagraphDialogTitle,Object(v.a)(this,this.lRd,"dialogResultHandler"),z)}lRd(z,U){1===z&&(this.Ivl(U),z=Object.assign(new Ld,{bQc:this.Mca,oVc:this.G8,uAe:this.M6j}),this.ia.Ka(Sc.a.hPf,2,z));this.dispose()}nXd(){this.$sa=ie.iYd();const z={};this.mri(z);this.Aqi(z);var U=Cd.a("Inch",
3,0,56,.1);const la=Cd.a("Character",2,0,56,.1);U=[U,la];this.Rri(z,U);this.Fqi(z,U);U=[Cd.a("Point",5,0,1584,1)];this.Gqi(z,U);this.zqi(z,U);this.nri(z);return z}Ivl(z){this.Osl(z);this.vwl(z);this.btl(z);this.ctl(z);this.Msl(z);this.Tul(z)}wzi(){const z={};z[wb.a.rD.id.toString()]=Object(v.a)(this.FA,this.FA.LQj,"justificationChangedHandler");z[wb.a.KCb.id.toString()]=Object(v.a)(this.FA,this.FA.C2g,"paraIndentLeftChangedHandler");z[wb.a.LCb.id.toString()]=Object(v.a)(this.FA,this.FA.C2g,"paraIndentLeftChangedHandler");
z[wb.a.Eea.id.toString()]=Object(v.a)(this.FA,this.FA.QMe,"specialIndentChangedHandler");z[wb.a.rHb.id.toString()]=Object(v.a)(this.FA,this.FA.QMe,"specialIndentChangedHandler");z[wb.a.sHb.id.toString()]=Object(v.a)(this.FA,this.FA.QMe,"specialIndentChangedHandler");z[wb.a.Nw.id.toString()]=Object(v.a)(this.FA,this.FA.HSj,"lineSpacingChangedHandler");z[wb.a.OCb.id.toString()]=Object(v.a)(this.FA,this.FA.F2g,"paraSpacingAfterChangedHandler");z[wb.a.NCb.id.toString()]=Object(v.a)(this.FA,this.FA.F2g,
"paraSpacingAfterChangedHandler");z[wb.a.RCb.id.toString()]=Object(v.a)(this.FA,this.FA.H2g,"paraSpacingBeforeChangedHandler");z[wb.a.QCb.id.toString()]=Object(v.a)(this.FA,this.FA.H2g,"paraSpacingBeforeChangedHandler");return z}nri(z){var U=ie.W5i(this.Mca),la="multiple"===U;z.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,
["options"]:Cd.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:U,["allowFreeForm"]:!1};U=0;let Da=!1;this.Mca.Sa(wb.a.Nw)&&la&&(U=this.Mca.getValue(wb.a.Nw),0<=U&&(Da=!0));la=[Cd.a("none",0,0,9.99,.5)];la={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:la,["numberFormatInfo"]:this.$sa,["validReservedValues"]:[""]};la.value=Da?U:"";z.atSpinButtonProps=la}zqi(z,U){const la=ie.F6f(this.Mca,wb.a.OCb,wb.a.NCb);z.afterSpacingSpinButtonProps=ie.ggd(la,{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:jc.a.YVb(5),
["validUnits"]:U,["numberFormatInfo"]:this.$sa,["validReservedValues"]:[""]})}Gqi(z,U){const la=ie.F6f(this.Mca,wb.a.RCb,wb.a.QCb);z.beforeSpacingSpinButtonProps=ie.ggd(la,{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:jc.a.YVb(5),["validUnits"]:U,["numberFormatInfo"]:this.$sa,["validReservedValues"]:[""]})}Fqi(z,U){let la,Da;({U1g:Da,
V1g:la}=ie.r$f(this.Mca,wb.a.LCb,wb.a.KCb,!1));U={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:jc.a.YVb(la),["validUnits"]:U,["numberFormatInfo"]:this.$sa,["validReservedValues"]:[""]};U=ie.ggd(Da,U);z.beforeTextSpinButtonProps=U}Rri(z,U){var la={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:Cd.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},Da=this.Mca.Sa(wb.a.Eea)?this.Mca.getValue(wb.a.Eea):-1;ie.Wwg(Da)?la.selectedKey=Da.toString():la.defaultSelectedKey="";z.specialIndentationComboBoxProps=la;({U1g:la,V1g:Da}=ie.r$f(this.Mca,wb.a.sHb,
wb.a.rHb,1!==Da&&2!==Da));U={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:jc.a.YVb(Da),["validUnits"]:U,["numberFormatInfo"]:this.$sa};U=ie.ggd(la,U);z.bySpinButtonProps=U}Aqi(z){const U={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,
["showLabel"]:!0,["options"]:Cd.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},la=this.Mca.Sa(wb.a.rD)?this.Mca.getValue(wb.a.rD):0;ie.VHj(la)?U.selectedKey=la.toString():U.defaultSelectedKey="";z.alignmentComboBoxProps=U}mri(z){z.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};z.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};z.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}Tul(z){if(z.lineSpacingComboBoxProps){const U=z.lineSpacingComboBoxProps.selectedKey.toString();let la=Cd.c(U);"multiple"===U&&(z=z.atSpinButtonProps)&&(la=
parseFloat(z.value.toString()));this.G8.setValue(wb.a.Nw,la);this.G8.setValue(wb.a.ZV,2)}}Msl(z){if(z.afterSpacingSpinButtonProps){z=z.afterSpacingSpinButtonProps;var U=jc.a.XVb(z.unitType.toString().toLowerCase());""!==z.value.toString()&&(U=4===U?2:4,this.G8.setValue(wb.a.OCb,parseInt(z.value.toString())),this.G8.setValue(wb.a.NCb,U))}}ctl(z){if(z.beforeSpacingSpinButtonProps){z=z.beforeSpacingSpinButtonProps;var U=jc.a.XVb(z.unitType.toString().toLowerCase());""!==z.value.toString()&&(U=4===U?
2:4,this.G8.setValue(wb.a.RCb,parseInt(z.value.toString())),this.G8.setValue(wb.a.QCb,U))}}btl(z){if(z.beforeTextSpinButtonProps){var U=z.beforeTextSpinButtonProps;z=jc.a.XVb(U.unitType.toString().toLowerCase());if(""!==U.value.toString()){U=parseFloat(U.value.toString());let la;2===z?la=2:(la=1,U=jc.a.gzh(U,z));this.G8.setValue(wb.a.LCb,U);this.G8.setValue(wb.a.KCb,la)}}}vwl(z){var U=z.bySpinButtonProps,la=z.didChangeSpecialIndentationComboBoxValue;if(U&&""!==U.value.toString()||la)if(z.specialIndentationComboBoxProps&&
(z=z.specialIndentationComboBoxProps,la=-1,z.selectedKey&&(z=z.selectedKey.toString(),la=parseInt(z)),ie.Wwg(la)&&this.G8.setValue(wb.a.Eea,la)),U){z=parseFloat(U.value.toString());U=jc.a.XVb(U.unitType.toString().toLowerCase());if(0>z||isNaN(z))z=0;2===U?la=2:(la=1,z=jc.a.gzh(z,U));this.G8.setValue(wb.a.sHb,z);this.G8.setValue(wb.a.rHb,la)}}Osl(z){z.alignmentComboBoxProps&&(z=z.alignmentComboBoxProps,z.selectedKey&&(z=parseInt(z.selectedKey.toString()),0<=z&&this.G8.setValue(wb.a.rD,z)))}static F6f(z,
U,la){if(z.Sa(U)&&z.Sa(la)){la=z.getValue(la);if(2!==la&&4!==la)return Number.NaN;z=z.getValue(U);2===la&&(z*=ie.Dvk);return z}return Number.NaN}static ggd(z,U){U.value=isNaN(z)?"":z;return U}static iYd(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static r$f(z,U,la,Da){let Ia=3;Ed.a("BySpinButtonDefaultvalueFix")&&Da?U=0:z.Sa(U)&&z.Sa(la)&&!Da?(U=z.getValue(U),2===z.getValue(la)?
Ia=2:U=jc.a.Yyl(U,Ia)):U=Number.NaN;return{U1g:U,V1g:Ia}}static VHj(z){return 1===z||2===z||3===z||6===z}static Wwg(z){return 1===z||2===z||0===z}static W5i(z){if(ie.Hqj(z)){z=z.getValue(wb.a.Nw);var U="multiple";Qc.a.ty(z,1)?U="1.00":Qc.a.ty(z,1.5)?U="1.50":Qc.a.ty(z,2)&&(U="2.00");return U}}static Hqj(z){return z.Sa(wb.a.Nw)&&z.Sa(wb.a.ZV)&&2===z.getValue(wb.a.ZV)?!0:!1}}ie.Dvk=72;Object(h.a)(ie,"ReactParagraphDialog",sb.a,[]);class Qe{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc){this.vfe=[];this.ia=
z;this.ra=U;this.Zca=la;this.K8=Da;this.Db=Ia;this.Vh=Db;this.mFa=Ob;this.Ea=sc;this.FA=hc;this.Wca=Fc;this.ZPg=Xc}ub(){this.ia.pa(Sc.a.rbe,jd.a.application,Object(v.a)(this,this.bsk,"paragraphDialogHandler"),4);this.ia.pa(Sc.a.hPf,jd.a.application,Object(v.a)(this,this.zpi,"commitParagraphDialogHandler"),4);this.ia.pa(Sc.a.p8g,jd.a.view,qb.a.O_,96);this.ia.pa(Sc.a.Z7g,jd.a.view,qb.a.O_,96);this.ia.pa(Sc.a.K8g,jd.a.view,qb.a.O_,96);this.ia.pa(Sc.a.L8g,jd.a.view,qb.a.O_,96);this.ia.pa(Sc.a.J8g,jd.a.view,
qb.a.O_,96);this.ia.pa(Sc.a.I8g,jd.a.view,qb.a.O_,96);this.ia.pa(Sc.a.j8g,jd.a.view,qb.a.O_,96);this.ia.pa(Sc.a.k8g,jd.a.view,qb.a.O_,96);this.ia.xa(Sc.a.G1g,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.bsh,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.xlg,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.fsh,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.esh,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.J1g,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.K1g,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.D1g,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.csh,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.C1g,
jd.a.view,qb.a.rG);this.ia.xa(Sc.a.M1g,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.L1g,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.gsh,jd.a.view,qb.a.rG);this.ia.xa(Sc.a.xad,jd.a.paragraph,Object(v.a)(this,this.n$i,"getPropertiesForParagraphDialog"));this.ia.xa(Sc.a.xad,jd.a.view,this.Wca);this.ia.$d(Sc.a.xad,96)}we(){}bsk(z,U,la){if(this.ra.ku()||this.ra.L7())return 16;z=this.ra.ae();if(!this.Ea.mZ(z,!0).length&&!this.ra.Wia())return 16;if(1===la)return 32;this.ZPg&&Uc.a.J(25040911,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",
this.ia.gq,"PptRibbon.Home"===this.ia.Tpa);Array.clear(this.vfe);this.ia.processAction(Sc.a.xad,2);return(la=ti.APropertySet.b5i(this.vfe))?((new ie(la,this.ia,this.FA)).ahd(),32):16}zpi(z,U,la,Da,Ia){if(1===la)return 32;if(!(Ia&&Ia.bQc&&Ia.oVc&&Ia.uAe))return 16;U=this.ra.Ip();this.FA.Kvj();la=this.Db.je(15);try{la.jc(U),la.$c=z,Ia.bQc.equals(Ia.oVc)||this.aoi(),Bj.zAk(Ia.bQc,Ia.oVc,new ui(Ia.uAe.value))}finally{la&&la.dispose()}if(this.ZPg){let Db;({GFh:z,HFh:Ia,JFh:U,IFh:la,FFh:Da,KFh:Db}=this.FA.Ekl());
Uc.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",z,Ia,U,la,Da,Db)}Md.a.uO(!0,!0);return 32}n$i(z,U,la){if(1===la)return 32;U=U.node;z=new Na.DictionaryPropertySet;z.setValue(wb.a.rD,this.Vh.UM(U));la=this.Zca.gQa(U);z.setValue(wb.a.ZV,la.Pf);z.setValue(wb.a.Nw,la.value);la=this.Zca.xV(U);z.setValue(wb.a.QCb,la.beforeSpacing.Pf);z.setValue(wb.a.RCb,la.beforeSpacing.value);
z.setValue(wb.a.NCb,la.afterSpacing.Pf);z.setValue(wb.a.OCb,la.afterSpacing.value);la=this.K8.m7(U);z.setValue(wb.a.KCb,1);z.setValue(wb.a.LCb,la.ZL);U=this.mFa.sQa(U);z.setValue(wb.a.Eea,U.specialIndentType);z.setValue(wb.a.rHb,U.Pf);z.setValue(wb.a.sHb,U.value);this.vfe.push(z);return 32}aoi(){if(this.ra.uG()){var z=this.ra.ae();z=this.Ea.mZ(z);for(const U of z)U.Uqa()}}}Object(h.a)(Qe,"ParagraphDialogActor",null,[244]);var df;(function(z){z[z.unspecified=-1]="unspecified";z[z.none=0]="none";z[z.left=
1]="left";z[z.center=2]="center";z[z.right=3]="right";z[z.inner=4]="inner";z[z.outer=5]="outer";z[z.both=6]="both";z[z.distribute=7]="distribute";z[z.margin=8]="margin";z[z.highKashida=9]="highKashida";z[z.lowKashida=10]="lowKashida";z[z.mediumKashida=11]="mediumKashida";z[z.numTab=12]="numTab";z[z.thaiDistribute=13]="thaiDistribute";z[z.start=14]="start";z[z.end=15]="end"})(df||(df={}));Object(h.b)("Justification",df);var tf=d(568);class jh{constructor(){this.value=this.Pf=0}}Object(h.a)(jh,"ParagraphSpacingCommandData",
null,[]);class Dh{constructor(){this.Yrh=this.D2g=this.G2g=this.I2g=!1}}Object(h.a)(Dh,"PptPropertySetChangedState",null,[]);class ch{constructor(z){this.U$d=this.a9d=this.S$d=this.T$d=this.o9d=this.h9d=!1;this.j9b={};this.ia=z;this.Qvj()}LQj(z,U,la){la&&(z=this.j9b[df[la]],void 0!==z&&null!==z&&(this.ia.processAction(z,2),this.h9d=!0))}HSj(z,U,la){void 0!==la&&null!==la&&(this.ia.Ka(Sc.a.Ila,2,la),this.o9d=!0)}H2g(z,U,la,Da){void 0!==la&&null!==la&&(z=ch.AKc(Da),!z.I2g&&null!==Da&&Da.uP.Sa(wb.a.QCb)&&
Da.uP.Sa(wb.a.RCb)&&(U=Da.uP.getValue(wb.a.RCb),Da=Da.uP.getValue(wb.a.QCb),z.I2g=!0,this.ia.Ka(Sc.a.Kfb,2,Object.assign(new jh,{value:U,Pf:Da})),this.T$d=!0))}F2g(z,U,la,Da){void 0!==la&&null!==la&&(z=ch.AKc(Da),!z.G2g&&null!==Da&&Da.uP.Sa(wb.a.NCb)&&Da.uP.Sa(wb.a.OCb)&&(U=Da.uP.getValue(wb.a.OCb),Da=Da.uP.getValue(wb.a.NCb),z.G2g=!0,this.ia.Ka(Sc.a.Jfb,2,Object.assign(new jh,{value:U,Pf:Da})),this.S$d=!0))}C2g(z,U,la,Da){void 0!==la&&null!==la&&(U=ch.AKc(Da),!U.D2g&&null!==Da&&Da.uP.Sa(wb.a.KCb)&&
Da.uP.Sa(wb.a.LCb)&&(z=Da.uP.getValue(wb.a.LCb),Da=Da.uP.getValue(wb.a.KCb),U.D2g=!0,U=new tf.a,U.Pf=Da,U.value=z,this.ia.Ka(Sc.a.zia,2,U),this.a9d=!0))}QMe(z,U,la,Da){void 0!==la&&null!==la&&(la=ch.AKc(Da),!la.Yrh&&null!==Da&&Da.uP.Sa(wb.a.rHb)&&Da.uP.Sa(wb.a.sHb)&&(U=0,Da.uP.Sa(wb.a.Eea)&&(U=Da.uP.getValue(wb.a.Eea)),z=Da.uP.getValue(wb.a.sHb),Da=Da.uP.getValue(wb.a.rHb),la.Yrh=!0,la=0,1===U?la=Sc.a.qGb:2===U?la=Sc.a.sGb:0===U&&(la=Sc.a.uGb),U=new tf.a,U.Pf=Da,U.value=z,this.ia.Ka(la,2,U),this.U$d=
!0))}Ekl(){return{GFh:this.h9d,HFh:this.o9d,JFh:this.T$d,IFh:this.S$d,FFh:this.a9d,KFh:this.U$d}}Kvj(){this.U$d=this.a9d=this.S$d=this.T$d=this.o9d=this.h9d=!1}Qvj(){this.j9b.left=ld.a.leftJustify;this.j9b.center=ld.a.centerJustify;this.j9b.right=ld.a.rightJustify;this.j9b.both=ld.a.fullJustify}static AKc(z){z.customData||(z.customData=new Dh);return z.customData}}Object(h.a)(ch,"ParagraphLevelPropertyChangedHandlers",null,[702]);var Hg=d(523),wh=d(196),Yh=d(267),Ni=d(338),vi=d(36),Eh=d(49),xh=d(81),
fj=d(165);class Wi{constructor(z,U){this.Cqb=z;this.Dh=U}}Object(h.a)(Wi,"DoNotCheckCritiqueTypeActionData",null,[]);var yh=d(22);class Rj{C3a(z){return(z=Object(A.a)(Wi,z))?Object(yh.a)(Ni.a,z.Dh):!1}pwe(z,U){if(U=Object(A.a)(Wi,U)){const la=U.Dh;la&&(la.kJa(z,U.Cqb),e.ULS.sendTraceTag(37855319,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",U.Cqb))}}}Object(h.a)(Rj,"DoNotCheckCritiqueTypeCallback",null,[758]);var Ci=d(458),bk=d(48);class zg extends Ci.a{constructor(z,
U,la,Da,Ia,Db,Ob){super();this.yqe=null;this.init(z);this.xl("WholePresentationOperation");this.wCa(K.AFrameworkApplication.Ta,U,la,Da,Ia);this.xab=0;this.gRg=Ob;this.PGg=Db;this.uwb=Ia;this.k6b=U;this.C3a()?1===this.behavior&&(this.fp=32,this.BX()):(this.fp=8,this.BX())}run(){0===this.xab&&this.MJe();1===this.xab&&this.dAe();2===this.xab&&this.ROe();3===this.xab&&this.tVd()}C3a(){return this.gRg.C3a(this.uwb)}pwe(){this.gRg.pwe(this.k6b,this.uwb)}MJe(){this.yqe=new bk.GraphTransaction(3);this.yqe.jc(this.PGg.node);
this.xab=1}dAe(){this.oz||this.sfb(this.PGg.MD);1!==this.Rla()&&(this.xab=2)}ROe(){this.pwe();this.yqe.dispose();this.xab=3}tVd(){this.BX()}}Object(h.a)(zg,"WholePresentationOperation",Ci.a,[]);var xf=d(52);class Qh{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc,md){this.qCa=!1;this.ia=z;this.SBg=U;this.oF=la;this.Db=Da;this.lXc=Ia;this.ta=Db;this.Ea=Ob;this.T8=Xc;this.sle=sc;this.WB=hc;this.nb=md;this.R7j=Fc.onh;this.y3j=Fc.pptProofingRemoveWholeDocTargetCritiquesEnabled;this.L2j=Fc.pptHideProofingErrorIsEnabled;
this.vxj()}get KWb(){return this.oF.YRa?this.lXc.instance:null}ub(){this.ia.pa(Sc.a.cgc,xf.a.application,Object(v.a)(this,this.cgc,"queryLanguage"),96);this.ia.pa(Sc.a.H1g,xf.a.application,Object(v.a)(this,this.zqk,"openPPTLanguageDialogView"),4);this.oF.Gtg&&this.ia.pa(ld.a.HPc,jd.a.Lf,Object(v.a)(this,this.HPc,"ignoreProofingError"),4);this.oF.i8d&&(this.y3j?(this.ia.xa(ld.a.FXb,jd.a.paragraph,Object(v.a)(this,this.uXf,"doNotCheckThisCritiqueTypeForNode")),this.ia.xa(ld.a.FXb,jd.a.section,Object(v.a)(this,
this.uXf,"doNotCheckThisCritiqueTypeForNode")),this.ia.SU(ld.a.FXb,jd.a.Lf,Object(v.a)(this,this.AHi,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.pa(Sc.a.GXb,jd.a.Lf,Object(v.a)(this,this.GXb,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.pa(ld.a.FXb,jd.a.Lf,Object(v.a)(this,this.GXb,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.L2j&&(this.ia.pa(Sc.a.OAe,xf.a.application,Object(v.a)(this,this.OAe,"queryHideProofingErrors"),100),this.ia.pa(Sc.a.gsj,xf.a.application,Object(v.a)(this,
this.Fml,"toggleHideProofingErrors"),4))}we(){}vxj(){this.qCa=Qh.b4d;e.ULS.sendTraceTag(37237070,375,50,"Initialized with hide proofing errors: {0}",this.qCa);this.qCa&&this.Rjg(this.qCa)}OAe(z,U,la,Da,Ia){if(1===la)return 32;if(!Ia)return 8;Ia[Hg.a.On]=this.qCa;return 32}Fml(z,U,la,Da,Ia){if(1===la)return 32;if(!(Ia&&Hg.a.On in Ia))return 8;this.qCa=Ia[Hg.a.On];Qh.b4d=this.qCa;this.Rjg(this.qCa);e.ULS.sendTraceTag(37237071,375,50,"User hide proofing errors: {0}",this.qCa);return 32}uXf(z,U,la,Da,
Ia){if(!U)return 8;z=U.node;if(!z)return 8;if(U.contextId===jd.a.section&&!z.sa(fj.a.Osg,!1))return 32;if(U.contextId===jd.a.paragraph&&z.sa(fj.a.eca,!1)){U=Object(A.a)(Wi,Ia);if(!U)return 8;Ia=U.Dh;if(!Ia)return 8;U.Cqb+=this.jch(z,Ia.typeId,Ia.lcid)}return 2}AHi(z,U,la,Da,Ia){var Db=this.B0i();Db=new Wi(0,Db);this.ia.ii(la,Sc.a.GXb,Da,!1,Ia,Db);la=Eh.a.create(Object(A.a)(xh.a,this.ta.presentation));e.ULS.sendTraceTag(37012126,375,50,"User click do not check this critique for whole doc with behavior: {0}",
Da);return new zg(z,U,Da,Ia,Db,la,new Rj)}GXb(z,U,la,Da,Ia){z=Object(A.a)(Wi,Ia);if(!z)return 8;Da=z.Dh;if(!Da)return 8;if(1===la)return 32;if(!U.node)return 8;e.ULS.sendTraceTag(36790874,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",Da.lcid,Da.typeId);z.Cqb+=this.kOk(Da.typeId,Da.lcid);this.KWb&&this.KWb.iGi(Da.lcid.toString(),Da.typeId);return 32}HPc(z,U,la){if(1===la)return 32;e.ULS.sendTraceTag(36790875,375,50,"Ignore proofing error triggerred");la=this.WB.TPa(U);
if(!la||!la.Dh)return 8;U=U.node;var Da=this.ta.Ba;if(!U||!Da)return 8;Da=this.Db.je(Qh.dgj(la));try{Da.jc(U),this.WB.wHa(U,[la],!0),U.setValue(vi.a.PPf,!0)}finally{Da&&Da.dispose()}la.Dh.kJa(z,1);this.nb.gSa()||Md.a.uO(!0,!1);e.ULS.sendTraceTag(36790876,375,50,"Ignore proofing error action succeeded");return 32}Rjg(z){this.T8.CKe=z}B0i(){var z=this.nb.Oa.kb;if(!z)return null;z=this.WB.TPa(z.Ua);if(!z||!z.Dh)return null;z=Object(A.a)(Ni.a,z.Dh);return!z||0>=z.lcid?null:z}kOk(z,U){const la=new Date;
if(!this.ta.Ba)return 0;const Da=this.ta.Ba.om();if(!Da)return 0;let Ia=0,Db=0;const Ob=this.Db.je(3);try{Ob.jc(this.ta.Ba);for(const sc of Da)this.Ea.WI(sc,hc=>{++Db;hc.Sa(vi.a.Zp)&&hc.sa(fj.a.eca,!1)&&(Ia+=this.jch(hc,z,U))})}finally{Ob&&Ob.dispose()}e.ULS.sendTraceTag(36825112,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-+la,Db,Da.length,Ia);return Ia}jch(z,U,la){const Da=this.WB.RE(z,Ia=>{Ia=Object(A.a)(Ni.a,
Ia.Dh);return!!Ia&&Ia.typeId===U&&Ia.lcid===la});if(wh.a.Va(Da))return 0;this.WB.wHa(z,Da);return Da.length}cgc(z,U,la,Da,Ia){Ia.zBc=this.z5i();return 32}z5i(){let z=K.AFrameworkApplication.lcid;if(this.nb.BZ(this.nb.Oa)){var U=this.nb.ae();if(1<U.length||1!==U.length)return"";U=this.Ea.ZPa(U[0]);0<U&&(z=U)}else this.nb.Oa.kb&&(U=this.sle.cMc(this.nb.Dj),0<U&&(z=U));return Yh.a.le(z)?Yh.a.le(z).displayName:Yh.a.le(K.AFrameworkApplication.lcid).displayName}VMj(){const z=this.nb.ae();return 1===z.length&&
z[0].jTc}zqk(z,U,la){if(2!==la)return 32;this.R7j&&this.nb.BZ(this.nb.Oa)&&this.VMj()?(e.ULS.sendTraceTag(8955537,806,50,"Set proofing language on shape level."),this.SBg.value.getInstance(!0).zkc()):this.nb.Oa.kb&&(e.ULS.sendTraceTag(8955536,806,50,"Set proofing language in text edit view."),this.SBg.value.getInstance(!1).zkc());return 32}static get b4d(){const z=cb.a.get("PowerPointHideProofingErrors");return z?"true"===z.toLowerCase():!1}static set b4d(z){cb.a.JL("PowerPointHideProofingErrors",
z.toString(),30)||e.ULS.sendTraceTag(37237069,375,10,"Failed to set cookie for hide proofing errors to {0}",z.toString())}static dgj(z){return 1===z.Dh.proofingType?15:3}}Object(h.a)(Qh,"ProofingActor",null,[244]);var Lh=d(288),oj=d(772);class gj{constructor(z,U){this.Se=z.toLowerCase();this.variant=U}}Object(h.a)(gj,"ThemeVariant",null,[]);var Di=d(37);class dh{constructor(z,U,la){this.zUd=z;this.Qzh=U;this.TTe=la}}Object(h.a)(dh,"ThemeData",null,[]);class Ig{}Ig.JIa=[new dh("62f939b6-93af-4db8-9c6b-d6c7dfdc589f",
"OfficeTheme",4),new dh("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new dh("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new dh("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new dh("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new dh("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new dh("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new dh("0507925b-6ac9-4358-8e18-c330545d08f8","Slice",4),new dh("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new dh("98dff888-2449-4d28-977c-6306c017633e",
"Banded",4),new dh("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new dh("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new dh("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new dh("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new dh("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new dh("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new dh("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5","Celestial",4),new dh("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new dh("4c5440d6-04d2-4954-96cf-f251137069b2",
"Metropolitan",8),new dh("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new dh("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new dh("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new dh("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(h.a)(Ig,"DesignManager_data",null,[]);class ua{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc,md){this.TXc=null;this.UXc=0;this.DFg=this.SXc=!1;this.mKg=null;this.lUb=new gj("",0);this.kQg={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",
["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",
["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",
["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=z;this.Fa=U;this.Xb=la;this.ra=Ia;this.Db=Da;this.Yb=Ob;this.ta=sc;this.yc=hc;this.y9j=Fc;this.Y2j=Xc;this.aIg=md}ub(){this.ia.pa(Sc.a.y3a,xf.a.application,Object(v.a)(this,this.mig,"handleThemeChange"),4);this.ia.pa(Sc.a.DNa,xf.a.application,Object(v.a)(this,
this.mig,"handleThemeChange"),4);this.ia.pa(Sc.a.sad,xf.a.application,Object(v.a)(this,this.sad,"queryMoreThemeGallery"),96);this.ia.pa(Sc.a.$Ae,xf.a.application,Object(v.a)(this,this.$Ae,"queryMoreVariantGallery"),96);this.ia.pa(Sc.a.ibd,xf.a.application,Object(v.a)(this,this.ibd,"queryThemes"),97);this.ia.pa(Sc.a.hbd,xf.a.application,Object(v.a)(this,this.hbd,"queryThemeVariants"),97);this.ia.pa(Sc.a.Bye,xf.a.application,Object(v.a)(this,this.Bye,"populateVariantGallery"),96)}we(){}ibd(z,U,la,Da,
Ia){Ia&&Ia.XT&&(z=this.kQg[Ia.XT]===this.HBa().Se,Ia.LWa.Kf(z));return 32}hbd(z,U,la,Da,Ia){if(Ia&&Ia.XT){z=this.HBa();U=z.Se;la=Ia.XT;try{var Db=Number.parseInvariant(la.substring(la.length-1,la.length))}catch(Ob){Db=0}Ia=Ia.LWa;Ia.Kf(z.variant===Db);Db=ua.V5f(la,Db,U);Ia.h2=Db}return 32}sad(z,U,la){if(U.contextId!==jd.a.application)return 2;z=this.ra.Ip();var Da=this.HBa();U=ua.M0b(Da.Se);Da=Da.variant-1;return this.Xb.Zc(z)?16:1!==la||(e.ULS.sendTraceTag(512499972,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",
U,Da),this.yc.Nj())?32:8}$Ae(z,U,la){if(U.contextId!==jd.a.application)return 2;var Da=this.ra.Ip();U=this.HBa();z=ua.M0b(U.Se);U=U.variant-1;if(this.Xb.Zc(Da))return 16;if(1===la)if(la=ua.Q0b(this.HBa().Se),Da=this.y9j.VPj(la),la&&Da)e.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",z,U);else return 16;return 32}mig(z,U,la,Da,Ia){U=this.ra.mf();Da=this.ta.Ba;if(!Da||z===Sc.a.DNa&&this.HBa()===this.lUb||this.Xb.Zc(Da))return 16;
if(1===la)return 32;la=Object(A.a)(String,Ia);if(null===la)return 8;Ia=this.kQg[la];return z===Sc.a.y3a?this.Iuk(Da,Ia,U):z===Sc.a.DNa?this.Juk(Da,la):8}Iuk(z,U,la){if(!z)return 16;1>=this.$Qf()||this.aIg&&la&&1<la.length?(this.iId(z,U,0,!1,la),e.ULS.sendTraceTag(512499968,801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",ua.M0b(U),0,z.Bb.sid)):(this.TXc=U,this.UXc=0,this.SXc=!1,z=new Zb.StandardDialog,z.vd=1,z.mO(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,
Object(v.a)(this,this.aMf,"changeThemeHandler")));return 32}Juk(z,U){if(!z)return 16;const la=this.HBa();let Da;try{if(Da=Number.parseInvariant(U.substring(7,U.length))-1,0>Da||Da>ua.Q0b(la.Se))Da=-1}catch(Ia){Da=-1}1>=this.$Qf()?(this.iId(z,la.Se,Da,!0,null),e.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",ua.M0b(la.Se),Da,z.Bb.sid)):(this.TXc=la.Se,this.UXc=Da,this.SXc=!0,z=new Zb.StandardDialog,z.vd=1,z.mO(ResourceStrings.l_GenericDialogTitle,
ResourceStrings.l_MultipleMainMastersMessage,Object(v.a)(this,this.aMf,"changeThemeHandler")));return 32}HBa(){let z=null;var U=this.ta.Ba;if(U){U=U.uj;const Da=this.yc.TH();if(Da&&U)for(var la of Da)if(la.Id===U){z=la;break}}if(!z)return this.DFg?this.mKg:this.lUb;if(!z.ThemeFamilyId||z.ThemeFamilyId===ua.Bgi)return this.lUb;la="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===z.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===z.ThemeFamilyId;return!this.Y2j&&la?this.lUb:new gj(z.ThemeFamilyId,z.VariantIndex+
1)}$Qf(){const z=this.yc.TH();let U=0;if(z)for(const la of z)la.InContent&&(U+=1);return U}aMf(z){const U=this.ta.Ba;if(U){var la=this.TXc,Da=this.UXc,Ia=this.SXc;this.TXc=null;this.UXc=-1;this.SXc=!1;1===z&&(this.iId(U,la,Da,Ia,null),e.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",ua.M0b(la),Da,U.Bb.sid))}}iId(z,U,la,Da,Ia){this.mKg=(this.DFg=Da)?new gj(U,0):this.lUb;const Db=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()},
void 0,!0);try{if(Db.jc(z),Db.$c=Da?Sc.a.DNa:Sc.a.y3a,this.aIg&&Ia)for(const Ob of Ia)Ob.setValue(Di.a.FPe,U),Ob.setValue(Di.a.u$,la),Ob.setValue(Di.a.G9h,1<Ia.length);else z.setValue(Di.a.FPe,U),z.setValue(Di.a.u$,la)}finally{Db&&Db.dispose()}this.Xb.TTb(this.Yb.yf,z,"ChangeTheme")}Bye(z,U,la,Da,Ia){if(1===la)return 32;z=Math.max(ua.Q0b(this.HBa().Se),4);U=this.HBa().Se;Ia.MenuItems=ua.N$i(z,U);return 32}static Q0b(z){for(let U=0;U<Ig.JIa.length;++U)if(Ig.JIa[U].zUd===z)return Ig.JIa[U].TTe;return 0}static M0b(z){for(let U=
0;U<Ig.JIa.length;++U)if(Ig.JIa[U].zUd===z)return Ig.JIa[U].Qzh;return ua.Ygi}static wPi(z){let U="";for(let la=0;la<Ig.JIa.length;++la)Ig.JIa[la].zUd===z&&(U=Ig.JIa[la].Qzh.replace(" ",""));return U}static N$i(z,U){const la=Object.assign(new Bh.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var Da=Object.assign(new Lh.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",DisplayMode:"Size85by48",ControlList:[]});Array.add(la.MenuSectionList,Da);const Ia=Object.assign(new oj.a,
{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(Da.ControlList,Ia);for(Da=1;Da<=z;++Da)Array.add(Ia.GalleryItems,ua.V5f("Variant"+Da,Da,U));return la}static V5f(z,U,la){la=!ua.Q0b(la)||U>ua.Q0b(la)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",ua.wPi(la),U);return Object.assign(new eg.a,{Id:z,ExternalId:z,Icon:la,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,
U),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}ua.Bgi="00000000-0000-0000-0000-000000000000";ua.Ygi="Unsupported Theme";Object(h.a)(ua,"ThemeActor",null,[244]);var Pa=d(466);class eb{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc){this.ia=z;this.Yb=U;this.ta=la;this.ra=Ia;this.Fa=Db;this.Db=Da;this.Rm=Ob;this.Xb=sc;this.iJg=hc.WJj;this.Sp=hc.yz;this.n3j=hc.$Kj;this.o$b=Fc.Yj(kf.a.D9c);
this.Qb=Xc}ub(){this.n3j?(this.iJg?(this.ia.pa(Sc.a.kwa,jd.a.application,Object(v.a)(this,this.t5k,"setSlidesTransitionGalleryExceptExisting"),5),this.ia.pa(Sc.a.aea,jd.a.application,Object(v.a)(this,this.mDk,"querySlidesTransitionGalleryExceptExisting"),97),this.ia.pa(Sc.a.lwa,jd.a.application,Object(v.a)(this,this.u5k,"setSlidesTransitionGalleryExisting"),5),this.ia.pa(Sc.a.nIa,jd.a.application,Object(v.a)(this,this.v5k,"setSlidesTransitionGalleryExistingInMenu"),5),this.ia.pa(Sc.a.Fva,jd.a.application,
Object(v.a)(this,this.nDk,"querySlidesTransitionGalleryExisting"),97),this.ia.pa(Sc.a.lHa,jd.a.application,Object(v.a)(this,this.oDk,"querySlidesTransitionGalleryExistingInMenu"),97)):(this.ia.pa(Sc.a.kwa,jd.a.application,Object(v.a)(this,this.cJe,"setSlidesTransitionGallery"),5),this.ia.pa(Sc.a.aea,jd.a.application,Object(v.a)(this,this.tBe,"querySlidesTransitionGallery"),97),this.ia.pa(Sc.a.lwa,jd.a.application,Object(v.a)(this,this.cJe,"setSlidesTransitionGallery"),5),this.ia.pa(Sc.a.nIa,jd.a.application,
Object(v.a)(this,this.cJe,"setSlidesTransitionGallery"),5),this.ia.pa(Sc.a.Fva,jd.a.application,Object(v.a)(this,this.tBe,"querySlidesTransitionGallery"),97),this.ia.pa(Sc.a.lHa,jd.a.application,Object(v.a)(this,this.tBe,"querySlidesTransitionGallery"),97)),this.ia.pa(Sc.a.dgd,jd.a.application,Object(v.a)(this,this.s5k,"setSlidesTransitionEffectOption"),5),this.ia.pa(Sc.a.GBe,jd.a.application,Object(v.a)(this,this.kDk,"querySlidesTransitionEffectOption"),97),this.ia.pa(Sc.a.bEb,jd.a.application,Object(v.a)(this,
this.lDk,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.pa(Sc.a.Uec,jd.a.application,Object(v.a)(this,this.Iwk,"populateSlidesTransitionEffectOptions"),96),this.ia.pa(Sc.a.kHa,jd.a.application,Object(v.a)(this,this.jDk,"querySlidesTransitionDuration"),97),this.ia.pa(Sc.a.BGb,jd.a.application,Object(v.a)(this,this.r5k,"setSlidesTransitionDuration"),5)):(this.iJg?(this.ia.pa(Sc.a.kwa,jd.a.application,Object(v.a)(this,this.m6k,"setTransitionGalleryExceptExisting"),5),this.ia.pa(Sc.a.aea,jd.a.application,
Object(v.a)(this,this.FDk,"queryTransitionGalleryExceptExisting"),97),this.ia.pa(Sc.a.lwa,jd.a.application,Object(v.a)(this,this.n6k,"setTransitionGalleryExisting"),5),this.ia.pa(Sc.a.nIa,jd.a.application,Object(v.a)(this,this.o6k,"setTransitionGalleryExistingInMenu"),5),this.ia.pa(Sc.a.Fva,jd.a.application,Object(v.a)(this,this.Fva,"queryTransitionGalleryExisting"),97),this.ia.pa(Sc.a.lHa,jd.a.application,Object(v.a)(this,this.lHa,"queryTransitionGalleryExistingInMenu"),97)):(this.ia.pa(Sc.a.kwa,
jd.a.application,Object(v.a)(this,this.nJe,"setTransitionGallery"),5),this.ia.pa(Sc.a.aea,jd.a.application,Object(v.a)(this,this.aea,"queryTransitionGallery"),97),this.ia.pa(Sc.a.lwa,jd.a.application,Object(v.a)(this,this.nJe,"setTransitionGallery"),5),this.ia.pa(Sc.a.nIa,jd.a.application,Object(v.a)(this,this.nJe,"setTransitionGallery"),5),this.ia.pa(Sc.a.Fva,jd.a.application,Object(v.a)(this,this.aea,"queryTransitionGallery"),97),this.ia.pa(Sc.a.lHa,jd.a.application,Object(v.a)(this,this.aea,"queryTransitionGallery"),
97)),this.ia.pa(Sc.a.dgd,jd.a.application,Object(v.a)(this,this.l6k,"setTransitionEffectOption"),5),this.ia.pa(Sc.a.GBe,jd.a.application,Object(v.a)(this,this.EDk,"queryTransitionEffectOption"),97),this.ia.pa(Sc.a.bEb,jd.a.application,Object(v.a)(this,this.bEb,"queryTransitionEffectOptionsAnchor"),100),this.ia.pa(Sc.a.Uec,jd.a.application,Object(v.a)(this,this.Uec,"populateTransitionEffectOptions"),96),this.ia.pa(Sc.a.kHa,jd.a.application,Object(v.a)(this,this.kHa,"queryTransitionDuration"),97),this.ia.pa(Sc.a.BGb,
jd.a.application,Object(v.a)(this,this.BGb,"setTransitionDuration"),5));this.ia.pa(Sc.a.AGb,jd.a.application,Object(v.a)(this,this.AGb,"setTransitionApplyAll"),4);this.ia.pa(Sc.a.chc,jd.a.application,Object(v.a)(this,this.chc,"queryTransitionApplyAll"),96)}we(){}Uec(z,U,la,Da,Ia){if(this.Sp&&1!==this.ra.mf().length)return 16;if(1===la)return 32;z=(z=this.ta.Ba)?z.Go:null;if(!z)return 16;if(!Ia)return 8;z=this.Rm.Nsb(z);z.next&&(Ia.MenuItems=this.SIf(z));return 32}aea(z,U,la,Da,Ia){if(!Ia)return 8;
z=Ia.queryResult;Ia=Ia.SourceControlId;U=this.Rm.EP(Ia);if(!U)return 8;z.vBa=eb.GWd(U.qc,U.kc,this.o$b);U=this.ta.Ba;if(!U)return 16;1===la&&((la=U.Go)?(la=this.Rm.vQa(la),z.TT(!la&&"TransitionExisting"===Ia||la===Ia)):z.TT("TransitionNone"===Ia));return 32}FDk(z,U,la,Da,Ia){if(!Ia||z!==Sc.a.aea)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;U=this.Rm.EP(Ia);if(!U)return 8;Da=U.qc.split("_")[1]+"_24";U=eb.CPa(Ia,Ia,Da,"2024601249","149145197",U.kc,U.kc);z.h2=U;U=this.ta.Ba;if(!U)return 16;1===la&&
((la=U.Go)?(la=this.Rm.vQa(la),z.TT(la===Ia)):z.TT("TransitionNone"===Ia));return 32}Fva(z,U,la,Da,Ia){if(!Ia||z!==Sc.a.Fva)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExisting"!==Ia)return 16;U=this.Rm.EP(Ia);if(!U)return 8;Da=U.qc.split("_")[1]+"_24";U=eb.CPa(Ia,Ia,Da,"3752636652","3476251476",U.kc,U.kc);z.h2=U;U=this.ta.Ba;if(!U)return 16;if(1===la&&(la=U.Go)){la=this.Rm.vQa(la);U=this.Rm.aUc(la,this.Rm.bsb());if(la&&!U){Da=this.Rm.EP(la);if(!Da)return 8;const Db=Da.qc.split("_")[1]+
"_24";Ia=eb.CPa(Ia,Ia,Db,"3752636652","3476251476",Da.kc,Da.kc);z.h2=Ia}z.TT(!la||!!la&&!U)}return 32}lHa(z,U,la,Da,Ia){if(!Ia||z!==Sc.a.lHa)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExistingInMenu"!==Ia)return 16;U=this.Rm.EP(Ia);if(!U)return 8;Da=U.qc.split("_")[1]+"_24";Ia=eb.CPa(Ia,Ia,Da,"4036532528","2831233208",U.kc,U.kc);z.h2=Ia;Ia=this.ta.Ba;if(!Ia)return 16;1===la&&(la=Ia.Go)&&(la=this.Rm.vQa(la),z.TT(!la));return 32}bEb(z,U,la){z=this.ta.Ba;if(!z)return 16;z=this.Rm.Nsb(z.Go);
return!z||!z.next||this.Sp&&1!==this.ra.mf().length?16:1===la?32:8}nJe(z,U,la,Da,Ia){if(!Ia)return 8;U=Ia.SourceControlId;Ia=z===Sc.a.lwa||z===Sc.a.nIa;Da=this.ta.Ba;if(!Da||this.Xb.Zc(Da)||this.Sp&&1!==this.ra.mf().length)return 16;var Db=Da.Go;const Ob=!!this.Rm.uQa(Db);if(Ia&&(!Db||Ob))return 16;if(1===la)return 32;Db=this.Rm.EP(U);if(!Db)return 8;if(!Ia&&2===la&&U){Md.a.hk("SlideCount","1");la=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{la.jc(Da),la.$c=z,Da.Go=Db.nc}finally{la&&
la.dispose()}e.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",U,Db.next||"null",Da.Bb.sid)}return 32}m6k(z,U,la,Da,Ia){if(!Ia)return 8;U=Ia.SourceControlId;Da=this.ta.Ba;if(!Da)return 16;if(z!==Sc.a.kwa)return 8;if(this.Xb.Zc(Da)||this.Sp&&1!==this.ra.mf().length)return 16;if(1===la)return 32;Ia=this.Rm.EP(U);if(!Ia)return 8;if(2===la&&U){Md.a.hk("SlideCount","1");la=this.Db.rd(15,void 0,()=>{this.ra.hj();
this.Fa.Ad()});try{la.jc(Da),la.$c=z,Da.Go=Ia.nc}finally{la&&la.dispose()}e.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",U,Ia.next||"null",Da.Bb.sid)}return 32}n6k(z,U,la,Da,Ia){if(!Ia)return 8;U=this.ta.Ba;if(!U)return 16;if(z!==Sc.a.lwa)return 8;if(this.Sp&&1!==this.ra.mf().length)return 16;if(1!==la)return 8;z=U.Go;la=!!this.Rm.uQa(z);U=this.Rm.Nsb(z);U=this.Rm.aUc(U?U.parent:null,this.Rm.bsb());
return z&&!la||!U?32:16}o6k(z,U,la,Da,Ia){if(!Ia)return 8;U=this.ta.Ba;if(!U)return 16;if(z!==Sc.a.nIa)return 8;if(this.Sp&&1!==this.ra.mf().length)return 16;if(1!==la)return 8;z=U.Go;la=!!this.Rm.uQa(z);return!z||la?16:32}AGb(z,U,la){U=this.ta.Ba;if(!U||this.Xb.Zc(U)||this.Sp&&1!==this.ra.mf().length)return 16;if(1===la)return 32;Md.a.hk("SlideCount","1");la=this.Yb.yf;const Da=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{Da.jc(la),Da.$c=z,la.nnb=U.Bb}finally{Da&&Da.dispose()}e.ULS.sendTraceTag(512499933,
801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}chc(z,U,la,Da,Ia){z=this.ta.Ba?!0:!1;if(!Ia)return 8;Ia=Ia.queryResult;Ia.vBa=eb.GWd("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,this.o$b);Ia.TT(z);return z?32:16}l6k(z,U,la,Da,Ia){if(!Ia)return 8;U=Ia.MenuItemId;if(this.Sp&&1!==this.ra.mf().length)return 16;if(1===la)return 32;la=this.ta.Ba;if(!la||this.Xb.Zc(la))return 16;Da=la?la.Go:null;Ia=this.Rm.EP(U);if(!Da||!Ia||!Ia.nc)return 16;Da.TransitionType=
Ia.nc.TransitionType;Da.Direction=Ia.nc.Direction;Da.Duration=Ia.nc.Duration;Md.a.hk("SlideCount","1");const Db=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{Db.jc(la),Db.$c=z,la.Go=Da}finally{Db&&Db.dispose()}e.ULS.sendTraceTag(512499932,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",Ia.parent,U,la.Bb.sid);return 32}EDk(z,U,la,Da,Ia){if(!Ia)return 8;z=Ia.queryResult;Ia=Ia.MenuItemId;U=this.ta.Ba;if(!U)return 16;
1===la&&z.Kf(this.Rm.uQa(U.Go)===Ia);return 32}kHa(z,U,la,Da,Ia){z=this.ta.Ba;if(!z)return 16;if(!Ia)return 8;z=z.Go;if(Ia=Ia.queryResult)Ia.Fea=z?(z.Duration/1E3).toString():"0";return 32}BGb(z,U,la,Da,Ia){U=this.ta.Ba;if(!U||this.Xb.Zc(U))return 16;if(!Ia)return 8;if(this.Sp&&1!==this.ra.mf().length)return 16;Da=Math.floor(1E3*Ia.Number);Ia=U.Go;if(!Ia)return 16;Md.a.Cb&&(Md.a.Cb.actionName="SetTransitionDuration");if(1===la)return"TransitionNone"===this.Rm.vQa(Ia)?16:32;if(2===la){Ia.Duration=
Da;const Db=this.Fa.ye;Md.a.hk("SlideCount","1");la=this.Db.rd(15,void 0,()=>{this.ra.hj();!Db||Db.name!==hh.a.yg&&Db.name!==hh.a.pC||this.Fa.Ad()});try{la.jc(U),la.$c=z,U.Go=Ia}finally{la&&la.dispose()}}return 32}Iwk(z,U,la,Da,Ia){if(1===la)return 32;if(!Ia)return 8;U=this.ra.mf();if(!U||!U.length)return 16;z=U[0].Go;if(!z)return 16;z=this.Rm.Nsb(z);if(1<U.length)for(const Db of U){U=Db.Go;if(!U)return 16;U=this.Rm.Nsb(U);if(z.parent!==U.parent)return 16}z.next&&(Ia.MenuItems=this.SIf(z));return 32}tBe(z,
U,la,Da,Ia){if(!Ia)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;U=this.Rm.EP(Ia);if(!U)return 8;z.vBa=eb.GWd(U.qc,U.kc,this.o$b);U=this.ra.mf();if(!U||!U.length)return 16;1===la&&(la="",({bna:la}=this.BOa(U)).returnValue&&z.TT(!la&&"TransitionExisting"===Ia||la===Ia));return 32}mDk(z,U,la,Da,Ia){if(!Ia||z!==Sc.a.aea)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;U=this.Rm.EP(Ia);if(!U)return 8;Da=U.qc.split("_")[1]+"_24";U=eb.CPa(Ia,Ia,Da,"2024601249","149145197",U.kc,U.kc);z.h2=U;U=this.ra.mf();
if(!U||!U.length)return 16;1===la&&(la="",({bna:la}=this.BOa(U)).returnValue&&z.TT(la===Ia));return 32}nDk(z,U,la,Da,Ia){if(!Ia||z!==Sc.a.Fva)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExisting"!==Ia)return 16;U=this.Rm.EP(Ia);if(!U)return 8;Da=U.qc.split("_")[1]+"_24";U=eb.CPa(Ia,Ia,Da,"3752636652","3476251476",U.kc,U.kc);z.h2=U;U=this.ra.mf();if(!U||!U.length)return 16;if(1===la&&(la="",({bna:la}=this.BOa(U)).returnValue)){U=this.Rm.aUc(la,this.Rm.bsb());if(la&&!U){Da=this.Rm.EP(la);
if(!Da)return 8;const Db=Da.qc.split("_")[1]+"_24";Ia=eb.CPa(Ia,Ia,Db,"3752636652","3476251476",Da.kc,Da.kc);z.h2=Ia}z.TT(!la||!!la&&!U)}return 32}oDk(z,U,la,Da,Ia){if(!Ia||z!==Sc.a.lHa)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExistingInMenu"!==Ia)return 16;U=this.Rm.EP(Ia);if(!U)return 8;Da=U.qc.split("_")[1]+"_24";Ia=eb.CPa(Ia,Ia,Da,"4036532528","2831233208",U.kc,U.kc);z.h2=Ia;Ia=this.ra.mf();if(!Ia||!Ia.length)return 16;1===la&&(la="",({bna:la}=this.BOa(Ia)).returnValue&&
z.TT(!la));return 32}lDk(z,U,la){z=this.ra.mf();if(!z||!z.length)return 16;U=this.Rm.Nsb(z[0].Go);return!U||!U.next||1<z.length&&!this.BOa(z).returnValue?16:1===la?32:8}cJe(z,U,la,Da,Ia){if(!Ia)return 8;U=Ia.SourceControlId;Ia=z===Sc.a.lwa||z===Sc.a.nIa;Da=this.ra.mf();if(!Da||!Da.length)return 16;for(var Db of Da)if(this.Xb.Zc(Db))return 16;Db="";const Ob=({bna:Db}=this.BOa(Da)).returnValue;if(Ia&&(!Ob||Db))return 16;if(1===la)return 32;Db=this.Rm.EP(U);if(!Db)return 8;if(!Ia&&2===la&&U){Md.a.hk("SlideCount",
Da.length.toString());la=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{la.jc(this.Yb.yf);la.$c=z;for(const sc of Da)sc.Go=Db.nc}finally{la&&la.dispose()}e.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",U,Db.next||"null")}return 32}t5k(z,U,la,Da,Ia){if(!Ia)return 8;U=Ia.SourceControlId;if(z!==Sc.a.kwa)return 8;Da=this.ra.mf();if(!Da||!Da.length)return 16;for(var Db of Da)if(this.Xb.Zc(Db))return 16;if(1===
la)return 32;Db=this.Rm.EP(U);if(!Db)return 8;if(2===la&&U){Md.a.hk("SlideCount",Da.length.toString());la=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()},()=>{1===this.Qb.Nu&&this.Fa.Gj(hh.a.Dea,!0)});try{la.jc(this.Yb.yf);la.$c=z;for(const Ob of Da)Ob.Go=Db.nc}finally{la&&la.dispose()}e.ULS.sendTraceTag(512499930,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",U,Db.next||"null")}return 32}u5k(z,U,la,Da,Ia){if(!Ia)return 8;U=this.ra.mf();
if(!U||!U.length)return 16;if(z!==Sc.a.lwa||1!==la)return 8;Da="";z=({bna:Da}=this.BOa(U)).returnValue;la=!!Da;U=Da&&0<Da.length?this.Rm.EP(Da):null;U=this.Rm.aUc(U?U.parent:null,this.Rm.bsb());return!z||la&&U?16:32}v5k(z,U,la,Da,Ia){if(!Ia)return 8;U=this.ra.mf();if(!U||!U.length)return 16;if(z!==Sc.a.nIa||1!==la)return 8;z="";return!({bna:z}=this.BOa(U)).returnValue||z?16:32}s5k(z,U,la,Da,Ia){if(!Ia)return 8;U=Ia.MenuItemId;if(1===la)return 32;la=this.ra.mf();if(!la||!la.length)return 16;for(var Db of la)if(this.Xb.Zc(Db)||
!Db.Go)return 16;Db=this.Rm.EP(U);if(!Db||!Db.nc)return 16;Md.a.hk("SlideCount",la.length.toString());Da=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{Da.jc(this.Yb.yf);Da.$c=z;for(const Ob of la){let sc=Ob.Go;sc.TransitionType=Db.nc.TransitionType;sc.Direction=Db.nc.Direction;sc.Duration=Db.nc.Duration;Ob.Go=sc}}finally{Da&&Da.dispose()}e.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",Db.parent,U);
return 32}kDk(z,U,la,Da,Ia){if(!Ia)return 8;z=Ia.queryResult;Ia=Ia.MenuItemId;U=this.ra.mf();if(!U||!U.length)return 16;1===la&&(la="",({bna:la}=this.IHi(U)).returnValue&&z.Kf(la===Ia));return 32}jDk(z,U,la,Da,Ia){if(!Ia)return 8;z=this.ra.mf();if(!z||!z.length)return 16;if(Ia=Ia.queryResult)z=eb.gdj(z),Ia.Fea=z;return 32}r5k(z,U,la,Da,Ia){if(!Ia)return 8;U=this.ra.mf();if(!U||!U.length)return 16;for(const Db of U)if(this.Xb.Zc(Db))return 16;Ia=Math.floor(1E3*Ia.Number);for(const Db of U)if(!Db.Go)return 16;
Md.a.Cb&&(Md.a.Cb.actionName="SetTransitionDuration");if(1===la){for(const Db of U)if("TransitionNone"===this.Rm.vQa(Db.Go))return 16;return 32}if(2===la){const Db=this.Fa.ye;Md.a.hk("SlideCount",U.length.toString());la=this.Db.rd(15,void 0,()=>{this.ra.hj();!Db||Db.name!==hh.a.yg&&Db.name!==hh.a.pC||this.Fa.Ad()});try{la.jc(this.Yb.yf);la.$c=z;for(const Ob of U){const sc=Ob.Go;sc.Duration=Ia;Ob.Go=sc}}finally{la&&la.dispose()}}return 32}BOa(z){let U;U="";if(!z||!z.length)return{returnValue:!1,bna:U};
U=this.Rm.vQa(z[0].Go);let la=!0;if(1<z.length)for(const Da of z)if(z=this.Rm.vQa(Da?Da.Go:null),U!==z){la=!1;break}la||(U="");return{returnValue:la,bna:U}}IHi(z){let U;U="";if(!z||!z.length)return{returnValue:!1,bna:U};U=this.Rm.uQa(z[0].Go);let la=!0;if(1<z.length)for(const Da of z)if(z=this.Rm.uQa(Da?Da.Go:null),U!==z){la=!1;break}la||(U="");return{returnValue:la,bna:U}}SIf(z){const U=Object.assign(new Bh.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,
MenuSectionList:[]}),la=Object.assign(new Lh.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",DisplayMode:"Menu32",ControlList:[]});Array.add(U.MenuSectionList,la);let Da=null;for(z=({key:Da}=this.Rm.Uag(z)).returnValue;z;)Array.add(la.ControlList,Object.assign(new Pa.a,{Command:"961566706",Id:Da,ExternalId:"TransitionEffectOptions"+Da,QueryCommand:"3535869262"})),{key:Da,returnValue:z}=this.Rm.Uag(z);return U}static gdj(z){let U;if(!z||!z.length)return"0";const la=
z[0].Go;U=la?(la.Duration/1E3).toString():"0";let Da=!0;if(1<z.length)for(const Ia of z)if((z=Ia?Ia.Go:null)||la){if(!z&&la||z&&!la){Da=!1;break}if(U!==(z.Duration/1E3).toString()){Da=!1;break}}Da||(U="0");return U}static GWd(z,U,la){z=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',z,la);U=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',U);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',
z,U)}static CPa(z,U,la,Da,Ia,Db,Ob){return Object.assign(new eg.a,{Id:z,ExternalId:U,Icon:la,Command:Da,QueryCommand:Ia,LabelText:Db,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Ob})}}Object(h.a)(eb,"TransitionActor",null,[244]);var Kb=d(985);class bc{constructor(){this.effectId=this.effectType=0;this.labelText=this.Ne=this.hn=this.Cn=null}}Object(h.a)(bc,"AnimInfo",null,[]);class oc{constructor(){this.yj=this.labelText=this.Ne=this.id=
null}}Object(h.a)(oc,"EffectOption",null,[]);class W extends oc{constructor(){super();this.value=null}}Object(h.a)(W,"EffectData",oc,[]);class ta{constructor(z){this.x6b=z;ta.jl||(ta.jl=new Kb.a,ta.jl.add("FromBottom",Object.assign(new oc,{id:"FromBottom",Ne:ta.Xe("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,yj:CommonUIStrings.l_AnimationFromBottomKeytip})),ta.jl.add("FromBottomLeft",Object.assign(new oc,{id:"FromBottomLeft",Ne:ta.Xe("AnimEffectPropFromBottomLeft"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,yj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),ta.jl.add("FromLeft",Object.assign(new oc,{id:"FromLeft",Ne:ta.Xe("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,yj:CommonUIStrings.l_AnimationFromLeftKeytip})),ta.jl.add("FromTopLeft",Object.assign(new oc,{id:"FromTopLeft",Ne:ta.Xe("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,yj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),
ta.jl.add("FromTop",Object.assign(new oc,{id:"FromTop",Ne:ta.Xe("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,yj:CommonUIStrings.l_AnimationFromTopKeytip})),ta.jl.add("FromTopRight",Object.assign(new oc,{id:"FromTopRight",Ne:ta.Xe("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,yj:CommonUIStrings.l_AnimationFromTopRightKeytip})),ta.jl.add("FromRight",Object.assign(new oc,{id:"FromRight",Ne:ta.Xe("AnimEffectPropFromRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,yj:CommonUIStrings.l_AnimationFromRightKeytip})),ta.jl.add("FromBottomRight",Object.assign(new oc,{id:"FromBottomRight",Ne:ta.Xe("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,yj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),ta.jl.add("ToBottom",Object.assign(new oc,{id:"ToBottom",Ne:ta.Xe("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,yj:CommonUIStrings.l_AnimationFromBottomKeytip})),
ta.jl.add("ToBottomLeft",Object.assign(new oc,{id:"ToBottomLeft",Ne:ta.Xe("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,yj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),ta.jl.add("ToLeft",Object.assign(new oc,{id:"ToLeft",Ne:ta.Xe("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,yj:CommonUIStrings.l_AnimationFromLeftKeytip})),ta.jl.add("ToTopLeft",Object.assign(new oc,{id:"ToTopLeft",Ne:ta.Xe("AnimEffectPropFromBottomRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,yj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),ta.jl.add("ToTop",Object.assign(new oc,{id:"ToTop",Ne:ta.Xe("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,yj:CommonUIStrings.l_AnimationFromTopKeytip})),ta.jl.add("ToTopRight",Object.assign(new oc,{id:"ToTopRight",Ne:ta.Xe("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,yj:CommonUIStrings.l_AnimationFromTopRightKeytip})),
ta.jl.add("ToRight",Object.assign(new oc,{id:"ToRight",Ne:ta.Xe("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,yj:CommonUIStrings.l_AnimationFromRightKeytip})),ta.jl.add("ToBottomRight",Object.assign(new oc,{id:"ToBottomRight",Ne:ta.Xe("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,yj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),ta.jl.add("Horizontal",Object.assign(new oc,{id:"Horizontal",Ne:ta.Xe("AnimEffectPropHorizontal"),
labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,yj:CommonUIStrings.l_AnimationHorizontalKeytip})),ta.jl.add("HorizontalIn",Object.assign(new oc,{id:"HorizontalIn",Ne:ta.Xe("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,yj:CommonUIStrings.l_AnimationHorizontalInKeytip})),ta.jl.add("HorizontalOut",Object.assign(new oc,{id:"HorizontalOut",Ne:ta.Xe("AnimEffectPropHorizontalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,
yj:CommonUIStrings.l_AnimationHorizontalOutKeytip})),ta.jl.add("Vertical",Object.assign(new oc,{id:"Vertical",Ne:ta.Xe("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,yj:CommonUIStrings.l_AnimationVerticalKeytip})),ta.jl.add("VerticalIn",Object.assign(new oc,{id:"VerticalIn",Ne:ta.Xe("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,yj:CommonUIStrings.l_AnimationVerticalInKeytip})),ta.jl.add("VerticalOut",Object.assign(new oc,
{id:"VerticalOut",Ne:ta.Xe("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,yj:CommonUIStrings.l_AnimationVerticalOutKeytip})),ta.jl.add("LeftDown",Object.assign(new oc,{id:"LeftDown",Ne:ta.Xe("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,yj:CommonUIStrings.l_AnimationLeftDownKeytip})),ta.jl.add("LeftUp",Object.assign(new oc,{id:"LeftUp",Ne:ta.Xe("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,
yj:CommonUIStrings.l_AnimationLeftUpKeytip})),ta.jl.add("RightDown",Object.assign(new oc,{id:"RightDown",Ne:ta.Xe("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,yj:CommonUIStrings.l_AnimationRightDownKeytip})),ta.jl.add("RightUp",Object.assign(new oc,{id:"RightUp",Ne:ta.Xe("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,yj:CommonUIStrings.l_AnimationRightUpKeytip})),ta.jl.add("In",Object.assign(new oc,{id:"In",Ne:ta.Xe("AnimEffectPropIn"),
labelText:ResourceStrings.L_EffectOptionsDirectionIn,yj:CommonUIStrings.l_AnimationInKeytip})),ta.jl.add("InBottom",Object.assign(new oc,{id:"InBottom",Ne:ta.Xe("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,yj:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),ta.jl.add("InCenter",Object.assign(new oc,{id:"InCenter",Ne:ta.Xe("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,yj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),
ta.jl.add("InSlightly",Object.assign(new oc,{id:"InSlightly",Ne:ta.Xe("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,yj:CommonUIStrings.l_AnimationInSlightlyKeytip})),ta.jl.add("Out",Object.assign(new oc,{id:"Out",Ne:ta.Xe("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,yj:CommonUIStrings.l_AnimationOutKeytip})),ta.jl.add("OutBottom",Object.assign(new oc,{id:"OutBottom",Ne:ta.Xe("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,
yj:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),ta.jl.add("OutCenter",Object.assign(new oc,{id:"OutCenter",Ne:ta.Xe("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,yj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),ta.jl.add("OutSlightly",Object.assign(new oc,{id:"OutSlightly",Ne:ta.Xe("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,yj:CommonUIStrings.l_AnimationOutSlightlyKeytip})),ta.jl.add("FloatUp",Object.assign(new oc,
{id:"FloatUp",Ne:ta.Xe("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,yj:CommonUIStrings.l_AnimationOutKeytip})),ta.jl.add("FloatDown",Object.assign(new oc,{id:"FloatDown",Ne:ta.Xe("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,yj:CommonUIStrings.l_AnimationDownKeytip})),ta.jl.add("ObjectCenter",Object.assign(new oc,{id:"ObjectCenter",Ne:ta.Xe("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,
yj:CommonUIStrings.l_AnimationObjectCenterKeytip})),ta.jl.add("SlideCenter",Object.assign(new oc,{id:"SlideCenter",Ne:ta.Xe("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,yj:CommonUIStrings.l_AnimationSlideCenterKeytip})),ta.jl.add("ObjectCenterOut",Object.assign(new oc,{id:"ObjectCenterOut",Ne:ta.Xe("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,yj:CommonUIStrings.l_AnimationObjectCenterKeytip})),ta.jl.add("SlideCenterOut",
Object.assign(new oc,{id:"SlideCenterOut",Ne:ta.Xe("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,yj:CommonUIStrings.l_AnimationSlideCenterKeytip})),ta.jl.add("Clockwise",Object.assign(new oc,{id:"Clockwise",Ne:ta.Xe("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,yj:CommonUIStrings.l_AnimationClockWiseKeytip})),ta.jl.add("CounterClockwise",Object.assign(new oc,{id:"CounterClockwise",Ne:ta.Xe("AnimEffectPropCounterclockwise"),
labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,yj:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),ta.jl.add("Across",Object.assign(new oc,{id:"Across",Ne:ta.Xe("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionAcross,yj:CommonUIStrings.l_AnimationAcrossKeytip})),ta.jl.add("Up",Object.assign(new oc,{id:"Up",Ne:ta.Xe("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,yj:CommonUIStrings.l_AnimationUpKeytip})),ta.jl.add("Down",
Object.assign(new oc,{id:"Down",Ne:ta.Xe("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,yj:CommonUIStrings.l_AnimationDownKeytip})),ta.jl.add("GrowShrinkHorizontal",Object.assign(new oc,{id:"GrowShrinkHorizontal",Ne:ta.Xe("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,yj:CommonUIStrings.l_AnimationHorizontalKeytip})),ta.jl.add("GrowShrinkVertical",Object.assign(new oc,{id:"GrowShrinkVertical",Ne:ta.Xe("AnimEffectPropGrowShrinkVertical"),
labelText:ResourceStrings.L_EffectOptionsDirectionVertical,yj:CommonUIStrings.l_AnimationVerticalKeytip})),ta.jl.add("GrowShrinkBoth",Object.assign(new oc,{id:"GrowShrinkBoth",Ne:ta.Xe("AnimEffectPropBoth"),labelText:ResourceStrings.L_EffectOptionsDirectionBoth,yj:CommonUIStrings.l_AnimationBothKeytip})));ta.cS||(ta.cS=new Kb.a,ta.cS.add("Spin_Quarter",Object.assign(new W,{id:"Spin_Quarter",Ne:ta.Xe("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",yj:CommonUIStrings.l_AnimationQuarterSpinKeytip})),
ta.cS.add("Spin_Half",Object.assign(new W,{id:"Spin_Half",Ne:ta.Xe("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",yj:CommonUIStrings.l_AnimationHalfSpinKeytip})),ta.cS.add("Spin_Full",Object.assign(new W,{id:"Spin_Full",Ne:ta.Xe("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",yj:CommonUIStrings.l_AnimationFullSpinKeytip})),ta.cS.add("Spin_Two",Object.assign(new W,{id:"Spin_Two",Ne:ta.Xe("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,
value:"720",yj:CommonUIStrings.l_AnimationTwoSpinKeytip})),ta.cS.add("Transparency_25",Object.assign(new W,{id:"Transparency_25",Ne:ta.Xe("AnimEffectPropTransparent25"),labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",yj:CommonUIStrings.l_Animation25PerKeytip})),ta.cS.add("Transparency_50",Object.assign(new W,{id:"Transparency_50",Ne:ta.Xe("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",yj:CommonUIStrings.l_Animation50PerKeytip})),
ta.cS.add("Transparency_75",Object.assign(new W,{id:"Transparency_75",Ne:ta.Xe("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,value:"0.25",yj:CommonUIStrings.l_Animation75PerKeytip})),ta.cS.add("Transparency_100",Object.assign(new W,{id:"Transparency_100",Ne:ta.Xe("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",yj:CommonUIStrings.l_Animation100PerKeytip})),ta.cS.add("GrowShrink_Tiny",Object.assign(new W,
{id:"GrowShrink_Tiny",Ne:ta.Xe("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",yj:CommonUIStrings.l_AnimationTinyKeytip})),ta.cS.add("GrowShrink_Smaller",Object.assign(new W,{id:"GrowShrink_Smaller",Ne:ta.Xe("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",yj:CommonUIStrings.l_AnimationSmallerKeytip})),ta.cS.add("GrowShrink_Larger",Object.assign(new W,{id:"GrowShrink_Larger",Ne:ta.Xe("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,
value:"150",yj:CommonUIStrings.l_AnimationLargerKeytip})),ta.cS.add("GrowShrink_Huge",Object.assign(new W,{id:"GrowShrink_Huge",Ne:ta.Xe("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",yj:CommonUIStrings.l_AnimationHugeKeytip})));if(!ta.Nl)if(ta.Nl=new Kb.a,ta.Nl.add("Existing",Object.assign(new bc,{effectType:-1,effectId:-1,Ne:ta.Xe("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,Cn:[],hn:[]})),ta.Nl.add("None",Object.assign(new bc,{effectType:0,
effectId:0,Ne:ta.Xe("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,Cn:[],hn:[]})),ta.Nl.add("Appear",Object.assign(new bc,{effectType:0,effectId:1,Ne:ta.Xe("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,Cn:[],hn:[]})),ta.Nl.add("FadeIn",Object.assign(new bc,{effectType:0,effectId:10,Ne:ta.Xe("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,Cn:[],hn:[]})),this.x6b){ta.Nl.add("FlyIn",Object.assign(new bc,{effectType:0,effectId:2,Ne:ta.Xe("AnimFxEntranceFlyIn"),
labelText:ResourceStrings.L_AnimationFlyIn,Cn:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),hn:[]}));ta.Nl.add("Wipe",Object.assign(new bc,{effectType:0,effectId:22,Ne:ta.Xe("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,Cn:["FromBottom","FromLeft","FromRight","FromTop"],hn:[]}));ta.Nl.add("Zoom",Object.assign(new bc,{effectType:0,effectId:53,Ne:ta.Xe("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,
Cn:["ObjectCenter","SlideCenter"],hn:[]}));ta.Nl.add("Checkerboard",Object.assign(new bc,{effectType:0,effectId:5,Ne:ta.Xe("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,Cn:["Across","Down"],hn:[]}));ta.Nl.add("BasicZoom",Object.assign(new bc,{effectType:0,effectId:23,Ne:ta.Xe("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,Cn:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),hn:[]}));ta.Nl.add("Blinds",Object.assign(new bc,{effectType:0,
effectId:3,Ne:ta.Xe("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,Cn:["Horizontal","Vertical"],hn:[]}));let U;ta.Nl.add("Box",(U=new bc,U.effectType=0,U.effectId=4,U.Ne=ta.Xe("AnimFxEntranceShape"),U.labelText=ResourceStrings.L_AnimationBox,U.Cn=["In","Out"],U.hn=[],U));let la;ta.Nl.add("PeekIn",(la=new bc,la.effectType=0,la.effectId=12,la.Ne=ta.Xe("AnimFxEntranceGeneric"),la.labelText=ResourceStrings.L_AnimationPeekIn,la.Cn=["FromBottom","FromLeft","FromRight","FromTop"],la.hn=
[],la));let Da;ta.Nl.add("Expand",(Da=new bc,Da.effectType=0,Da.effectId=55,Da.Ne=ta.Xe("AnimFxEntranceGeneric"),Da.labelText=ResourceStrings.L_AnimationExpand,Da.Cn=[],Da.hn=[],Da));let Ia;ta.Nl.add("GrowAndTurn",(Ia=new bc,Ia.effectType=0,Ia.effectId=31,Ia.Ne=ta.Xe("AnimFxEntranceGrowAndTurn"),Ia.labelText=ResourceStrings.L_AnimationGrowAndTurn,Ia.Cn=[],Ia.hn=[],Ia));let Db;ta.Nl.add("RandomBars",(Db=new bc,Db.effectType=0,Db.effectId=14,Db.Ne=ta.Xe("AnimFxEntranceRandomBars"),Db.labelText=ResourceStrings.L_AnimationRandomBars,
Db.Cn=["Horizontal","Vertical"],Db.hn=[],Db));let Ob;ta.Nl.add("RiseUp",(Ob=new bc,Ob.effectType=0,Ob.effectId=37,Ob.Ne=ta.Xe("AnimFxEntranceGeneric"),Ob.labelText=ResourceStrings.L_AnimationRiseUp,Ob.Cn=[],Ob.hn=[],Ob));let sc;ta.Nl.add("Split",(sc=new bc,sc.effectType=0,sc.effectId=16,sc.Ne=ta.Xe("AnimFxEntranceSplit"),sc.labelText=ResourceStrings.L_AnimationSplit,sc.Cn=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],sc.hn=[],sc));let hc;ta.Nl.add("Strips",(hc=new bc,hc.effectType=0,
hc.effectId=18,hc.Ne=ta.Xe("AnimFxEntranceGeneric"),hc.labelText=ResourceStrings.L_AnimationStrips,hc.Cn=["LeftDown","LeftUp","RightDown","RightUp"],hc.hn=[],hc));let Fc;ta.Nl.add("Stretch",(Fc=new bc,Fc.effectType=0,Fc.effectId=17,Fc.Ne=ta.Xe("AnimFxEntranceGeneric"),Fc.labelText=ResourceStrings.L_AnimationStretch,Fc.Cn=["Across","FromBottom","FromLeft","FromRight","FromTop"],Fc.hn=[],Fc));let Xc;ta.Nl.add("Exit_Disappear",(Xc=new bc,Xc.effectType=1,Xc.effectId=1,Xc.Ne=ta.Xe("AnimFxExitDisappear"),
Xc.labelText=ResourceStrings.L_AnimationDisappear,Xc.Cn=[],Xc.hn=[],Xc));let md;ta.Nl.add("Exit_Fade",(md=new bc,md.effectType=1,md.effectId=10,md.Ne=ta.Xe("AnimFxExitFadeOut"),md.labelText=ResourceStrings.L_AnimationFade,md.Cn=[],md.hn=[],md));let Nc;ta.Nl.add("Exit_FlyOut",(Nc=new bc,Nc.effectType=1,Nc.effectId=2,Nc.Ne=ta.Xe("AnimFxExitFlyOut"),Nc.labelText=ResourceStrings.L_AnimationFlyOut,Nc.Cn="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),Nc.hn=[],
Nc));let bf;ta.Nl.add("Exit_Wipe",(bf=new bc,bf.effectType=1,bf.effectId=22,bf.Ne=ta.Xe("AnimFxExitWipe"),bf.labelText=ResourceStrings.L_AnimationWipe,bf.Cn=["FromBottom","FromLeft","FromRight","FromTop"],bf.hn=[],bf));let pe;ta.Nl.add("Exit_Zoom",(pe=new bc,pe.effectType=1,pe.effectId=53,pe.Ne=ta.Xe("AnimFxExitFadedZoom"),pe.labelText=ResourceStrings.L_AnimationZoom,pe.Cn=["ObjectCenterOut","SlideCenterOut"],pe.hn=[],pe));let wf;ta.Nl.add("Exit_Checkerboard",(wf=new bc,wf.effectType=1,wf.effectId=
5,wf.Ne=ta.Xe("AnimFxExitGeneric"),wf.labelText=ResourceStrings.L_AnimationCheckerboard,wf.Cn=["Across","Up"],wf.hn=[],wf));let rf;ta.Nl.add("Exit_BasicZoom",(rf=new bc,rf.effectType=1,rf.effectId=23,rf.Ne=ta.Xe("AnimFxExitGeneric"),rf.labelText=ResourceStrings.L_AnimationBasicZoom,rf.Cn="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),rf.hn=[],rf));let fi;ta.Nl.add("Exit_Blinds",(fi=new bc,fi.effectType=1,fi.effectId=3,fi.Ne=ta.Xe("AnimFxExitGeneric"),fi.labelText=ResourceStrings.L_AnimationBlinds,
fi.Cn=["Horizontal","Vertical"],fi.hn=[],fi));let Fh;ta.Nl.add("Exit_Box",(Fh=new bc,Fh.effectType=1,Fh.effectId=4,Fh.Ne=ta.Xe("AnimFxExitShape"),Fh.labelText=ResourceStrings.L_AnimationBox,Fh.Cn=["In","Out"],Fh.hn=[],Fh));let Qf;ta.Nl.add("Exit_PeekOut",(Qf=new bc,Qf.effectType=1,Qf.effectId=12,Qf.Ne=ta.Xe("AnimFxExitGeneric"),Qf.labelText=ResourceStrings.L_AnimationPeekOut,Qf.Cn=["ToBottom","ToLeft","ToRight","ToTop"],Qf.hn=[],Qf));let Mh;ta.Nl.add("Exit_RandomBars",(Mh=new bc,Mh.effectType=1,Mh.effectId=
14,Mh.Ne=ta.Xe("AnimFxExitRandomBars"),Mh.labelText=ResourceStrings.L_AnimationRandomBars,Mh.Cn=["Horizontal","Vertical"],Mh.hn=[],Mh));let kj;ta.Nl.add("Exit_Split",(kj=new bc,kj.effectType=1,kj.effectId=16,kj.Ne=ta.Xe("AnimFxExitSplit"),kj.labelText=ResourceStrings.L_AnimationSplit,kj.Cn=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],kj.hn=[],kj));let r;ta.Nl.add("Exit_Strips",(r=new bc,r.effectType=1,r.effectId=18,r.Ne=ta.Xe("AnimFxExitGeneric"),r.labelText=ResourceStrings.L_AnimationStrips,
r.Cn=["LeftDown","LeftUp","RightDown","RightUp"],r.hn=[],r));let X;ta.Nl.add("Exit_Stretchy",(X=new bc,X.effectType=1,X.effectId=17,X.Ne=ta.Xe("AnimFxExitGeneric"),X.labelText=ResourceStrings.L_AnimationStretchy,X.Cn=[],X.hn=[],X));let ra;ta.Nl.add("Exit_Zoom",(ra=new bc,ra.effectType=1,ra.effectId=53,ra.Ne=ta.Xe("AnimFxExitFadedZoom"),ra.labelText=ResourceStrings.L_AnimationZoom,ra.Cn=["ObjectCenterOut","SlideCenterOut"],ra.hn=[],ra));let Qa;ta.Nl.add("Emphasis_Spin",(Qa=new bc,Qa.effectType=2,Qa.effectId=
8,Qa.Ne=ta.Xe("AnimFxEmphasisSpin"),Qa.labelText=ResourceStrings.L_AnimationSpin,Qa.Cn=["Clockwise","CounterClockwise"],Qa.hn=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],Qa));let db;ta.Nl.add("Emphasis_Transparency",(db=new bc,db.effectType=2,db.effectId=9,db.Ne=ta.Xe("AnimFxEmphasisTransparency"),db.labelText=ResourceStrings.L_AnimationTransparency,db.Cn=[],db.hn=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],db));let Hb;ta.Nl.add("Emphasis_GrowShrink",(Hb=new bc,
Hb.effectType=2,Hb.effectId=6,Hb.Ne=ta.Xe("AnimFxEmphasisGrowShrink"),Hb.labelText=ResourceStrings.L_AnimationGrowShrink,Hb.Cn=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],Hb.hn=["GrowShrink_Tiny","GrowShrink_Smaller","GrowShrink_Larger","GrowShrink_Huge"],Hb));let Vb;ta.Nl.add("Emphasis_FillColor",(Vb=new bc,Vb.effectType=2,Vb.effectId=1,Vb.Ne=ta.Xe("AnimFxEmphasisChangeFillColor"),Vb.labelText=ResourceStrings.L_AnimationFillColor,Vb.Cn=[],Vb.hn=[],Vb));let vb;ta.Nl.add("Emphasis_FontColor",
(vb=new bc,vb.effectType=2,vb.effectId=3,vb.Ne=ta.Xe("AnimFxEmphasisChangeFontColor"),vb.labelText=ResourceStrings.L_AnimationFontColor,vb.Cn=[],vb.hn=[],vb));let zb;ta.Nl.add("Emphasis_LineColor",(zb=new bc,zb.effectType=2,zb.effectId=7,zb.Ne=ta.Xe("AnimFxEmphasisChangeLineColor"),zb.labelText=ResourceStrings.L_AnimationLineColor,zb.Cn=[],zb.hn=[],zb))}else ta.Nl.add("FlyIn",Object.assign(new bc,{effectType:0,effectId:2,Ne:ta.Xe("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,Cn:["FromBottom",
"FromLeft","FromTop","FromRight"],hn:[]}))}UZb(z,U){let la=null;ta.Nl.forEach((Da,Ia)=>{Ia.effectType===z&&Ia.effectId===U&&(la=Ia);return!0});return la}nNc(z,U){let la=null;ta.Nl.forEach((Da,Ia)=>{Ia.effectType===z&&Ia.effectId===U&&(la=Da);return!0});return la}QMc(z,U,la,Da,Ia){const Db=Object.assign(new Lh.a,{Id:"MenuSectionEffectOptions"+la,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});z=this.UZb(U,z);if(!z)return Db;if((z=ta.c2i(z,la))&&z.length)for(U=
0;U<z.length;U++){const Ob=ta.d2i(z[U],la),sc="AnimationEffectOptions"+("Direction"===la?"Direction":"Data")+Ob.id;Array.add(Db.ControlList,Object.assign(new Pa.a,{Command:Da,Id:Ob.id,ExternalId:sc,QueryCommand:Ia}))}return Db}pLc(z){var U;return(U=ta.Nl.ga(z))?(z=U.effectType,U=U.effectId,{returnValue:!0,effectType:z,effectId:U}):{returnValue:!1,effectType:-1,effectId:-1}}qLc(z){let U,la;U=ta.Xe("AnimFxMultiple");la=ResourceStrings.L_AnimationExisting;if(z=ta.Nl.ga(z))U=z.Ne,la=z.labelText;return{image:U,
label:la}}LRc(z,U){if(0===z){if(0!==U&&1!==U&&2!==U&&10!==U)return!0}else if(0<z)return!0;return!1}b8a(z,U){return z&&U?this.x6b?(U=U.NCa()?z.IsTrigger:z.HasTrigger,!!this.UZb(z.EffectType,z.EffectId)&&!U):!z.HasExisting:!0}yTc(z){return z?this.MRc(Array(z)):!0}MRc(z){if(!z||!z.length)return!0;for(const U of z)if(null==this.UZb(U.EffectType,U.EffectId)||U.IsTrigger)return!1;return!0}A9d(z,U){return U&&z&&this.x6b?U.NCa()?!1:z.HasMultiple:!1}l8d(z){if(!z||!z.length)return!1;const U=z[0].EffectId,la=
z[0].EffectType;for(let Da=1;Da<z.length;Da++){const Ia=z[Da];if(Ia.EffectId!=U||Ia.EffectType!=la)return!0}return!1}Hrg(z){if(z&&this.x6b&&2===z.EffectType)switch(z.EffectId){case 1:case 3:case 7:return!0}return!1}Zxg(z){if(!z)return!1;if(2===z.EffectType)switch(z.EffectId){case 1:case 3:case 7:return!0}return!1}V0i(z){z=ta.Nl.ga(z);return this.r_b(z.Cn[0])}S0i(z){return(z=ta.Nl.ga(z))&&z.hn.length?this.mYd(z.hn[0]):""}r_b(z){switch(z){case "FromBottom":case "ToBottom":return 3;case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;
case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;case "VerticalIn":return 17;case "VerticalOut":return 18;
case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;case "GrowShrinkBoth":return 29;
default:return 0}}mYd(z){return(z=ta.cS.ga(z))?z.value:""}kPf(z,U){return(U=ta.cS.ga(U))&&parseFloat(z)===parseFloat(U.value)?!0:!1}t0d(z){switch(z){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}lii(z){if(null===z)throw Error.argumentNull("animation");const U=this.UZb(z.EffectType,z.EffectId);return!!U&&(0<U.Cn.length||0<U.hn.length||this.Hrg(z))}mii(z){if(!z)return!1;const U=this.UZb(z.EffectType,z.EffectId);return!!U&&
(0<U.Cn.length||0<U.hn.length||this.Zxg(z))}nii(z,U,la){return this.b8a(la,z)&&!this.A9d(la,z)&&(this.lii(la)||this.NKf(z,U,la)||this.OKd(z,U,la)||this.LKf(z,U,la)||this.PKd(z,la))}oii(z,U,la){return la&&la.length&&this.MRc(la)&&!this.l8d(la)?this.mii(la[0])||this.OKf(z,U,la[0])||this.QKf(z,U,la[0])||this.MKf(z,U,la[0])||this.SKf(z,la[0]):!1}J$i(z,U,la){const Da=Object.assign(new Lh.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",DisplayMode:"Menu32",
ControlList:[]});this.NKf(z,U,la)&&Array.add(Da.ControlList,Object.assign(new Pa.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.LKf(z,U,la)&&this.x6b&&Array.add(Da.ControlList,Object.assign(new Pa.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.OKd(z,U,la)&&Array.add(Da.ControlList,Object.assign(new Pa.a,{Command:"3467781846",Id:"ByParagraph",
ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));this.PKd(z,la)&&Array.add(Da.ControlList,Object.assign(new Pa.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return Da}K$i(z,U,la){const Da=new Lh.a;Da.Id="MenuSectionEffectOptionsSequence";Da.ControlsId="MenuSectionEffectOptionsSequence.Controls";Da.DisplayMode="Menu32";Da.ControlList=[];if(this.OKf(z,U,la)){var Ia=new Pa.a;Ia.Command="1850236812";
Ia.Id="AsOneObject";Ia.ExternalId="AnimationEffectOptionsSequenceAsOneObject";Ia.QueryCommand="1125291975";Da.ControlList.push(Ia)}this.MKf(z,U,la)&&(Ia=new Pa.a,Ia.Command="2048458448",Ia.Id="AllAtOnce",Ia.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",Ia.QueryCommand="1125291975",Da.ControlList.push(Ia));this.QKf(z,U,la)&&(U=new Pa.a,U.Command="3467781846",U.Id="ByParagraph",U.ExternalId="AnimationEffectOptionsSequenceByParagraph",U.QueryCommand="1125291975",Da.ControlList.push(U));this.SKf(z,
la)&&(z=new Pa.a,z.Command="1486892994",z.Id="OneByOne",z.ExternalId="AnimationEffectOptionsSequenceOneByOne",z.QueryCommand="1125291975",Da.ControlList.push(z));return Da}oMj(z){let U=!0,la=0;if(!z)return!1;for(const Da of z)if(U)la=Da.EffectId,U=!1;else if(Da.EffectId!==la)return!1;return!0}NKf(z,U,la){return 0!==la.SequenceId&&0!==la.EffectId&&this.b8a(la,z)&&(z.Qf||2!==la.EffectType||1!==la.EffectId&&7!==la.EffectId)&&(z.T2||this.PKd(z,la)||this.OKd(z,U,la))}qii(z,U,la){return z&&0!==la.BuildType&&
0!==la.EffectId&&this.yTc(la)&&(z.Qf||2!==la.EffectType||1!==la.EffectId&&7!==la.EffectId)&&(z.T2||this.RKf(z,la)||this.PKf(z,U,la))}OKf(z,U,la){for(const Da of z)if(!this.qii(Da,U,la))return!1;return!0}LKf(z,U,la){return 0!==la.SequenceId&&!z.T2&&!z.nd&&0!==la.EffectId&&this.b8a(la,z)&&(z.Qf||2!==la.EffectType||1!==la.EffectId&&7!==la.EffectId)&&(z.al||z.Qf||z.isEditable&&0<U.Fba(z).length)}pii(z,U,la){return z&&0!==la.BuildType&&!z.T2&&!z.nd&&0!==la.EffectId&&this.yTc(la)&&(z.Qf||2!==la.EffectType||
1!==la.EffectId&&7!==la.EffectId)&&(z.al||z.Qf||z.isEditable&&0<U.Fba(z).length)}MKf(z,U,la){for(const Da of z)if(!this.pii(Da,U,la))return!1;return!0}OKd(z,U,la){return 0!==la.SequenceId&&!z.Qf&&!z.T2&&!z.nd&&0!==la.EffectId&&this.b8a(la,z)&&(2!==la.EffectType||1!==la.EffectId&&7!==la.EffectId)&&(z.al||z.isEditable&&0<U.Fba(z).length)}PKf(z,U,la){return z&&0!==la.BuildType&&!z.Qf&&!z.T2&&!z.nd&&0!==la.EffectId&&this.yTc(la)&&(2!==la.EffectType||1!==la.EffectId&&7!==la.EffectId)&&(z.al||z.isEditable&&
0<U.Fba(z).length)}QKf(z,U,la){for(const Da of z)if(!this.PKf(Da,U,la))return!1;return!0}PKd(z,U){return 0!==U.SequenceId&&z.Qf&&0!==U.EffectId&&this.b8a(U,z)}RKf(z,U){return z&&0!==U.BuildType&&z.Qf&&0!==U.EffectId&&this.yTc(U)}SKf(z,U){for(const la of z)if(!this.RKf(la,U))return!1;return!0}static Xe(z){return kf.a.Aec+"_"+z+"_32x32x32"}static c2i(z,U){switch(U){case "Direction":return z.Cn;case "EffectData":return z.hn;default:return null}}static d2i(z,U){switch(U){case "Direction":return ta.jl.ga(z);
case "EffectData":return ta.cS.ga(z);default:return null}}}ta.jl=null;ta.cS=null;ta.Nl=null;Object(h.a)(ta,"AnimationHelper",null,[734]);class da{constructor(z,U,la,Da,Ia,Db,Ob){this.uD=null;this.xOe=!1;this.dFa=la;this.ra=z;(this.nta=Da)&&Ia.execute(sc=>{this.uD=sc});this.ua=Ob;this.ia=U;this.Zja=Db}selectShape(){this.ra&&!this.ra.WV(this.ua)&&this.ra.selectShape(this.ua,!0)}onVolumeChanged(z){const U={ActionFromPlayer:!0};.2>=z?(U.SourceControlId="SetVolumeLow",this.ia.Ka(Sc.a.zJe,2,U)):.2<z&&.8>
z?(U.SourceControlId="SetVolumeMedium",this.ia.Ka(Sc.a.AJe,2,U)):.8<=z&&(U.SourceControlId="SetVolumeHigh",this.ia.Ka(Sc.a.yJe,2,U));this.selectShape()}onPlayToggled(z){const U={ActionFromPlayer:!0};z?this.ia.Ka(Sc.a.NId,2,U):this.ia.Ka(Sc.a.SAc,2,U);this.selectShape()}onMuteToggled(z){if(z)this.ia.Ka(Sc.a.BJe,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ua.media.vlmField);this.selectShape()}onPlayerReadyStateChanged(z){z&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",
!1))}onMouseHoverStateChanged(z){z||this.ra.L$d(this.ua)||(z=this.nK())&&z.showHidePlayer(!1)}onPlayerClicked(){this.nta&&this.ia.processAction(Sc.a.bJb,2)}onPlayerError(z){Uc.a.J(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",z);z&&-1<z.indexOf("PIPELINE_ERROR_READ")&&this.dFa.YZd(this.Zja.podSessionId,this.ua).then(U=>{const la=this.nK();la&&la.setAudioSrc(U)})}onKeyDown(z){z===tg.a.Lhb?(z=this.nK())&&z.removeFocusFromPlayer():z===tg.a.Bq&&(this.xOe=!0)}onBlur(){const z=
this.nK();z&&(this.xOe?z.setFocusOnPlayer():z.removeFocusFromPlayer());this.xOe=!1}nK(){return this.nta&&this.uD?this.uD.nK(this.ua):null}}Object(h.a)(da,"AudioLibraryCallback",null,[759]);class Ea{constructor(z,U,la,Da,Ia,Db){this.dFa=z;this.ra=U;this.ia=la;this.nta=Da;this.D9a=Db;this.Zja=Ia}Cvi(z){return new da(this.ra,this.ia,this.dFa,this.nta,this.D9a,this.Zja,z)}}Object(h.a)(Ea,"AudioLibraryCallbackFactory",null,[704]);class $a{constructor(z,U,la,Da){this.volume=z;this.mute=U;this.repeat=la;
this.rewind=Da}}Object(h.a)($a,"MediaProperties",null,[]);class fb{constructor(z,U,la,Da){this.pZj=z;this.Wle=U;this.dFa=la;this.Zja=Da}createAudioManager(z,U,la){return new Promise((Da,Ia)=>{this.Wle("audioPlayback").then(()=>{window.self.audioPlayback?(Uc.a.J(512497818,801,50,"audio script is loaded successfully"),Da(this.Dvi(z,U,la))):(Uc.a.J(512497819,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),Ia("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(Db=>
{Uc.a.J(512497817,801,10,"Failed to load audio script "+Db.toString());Ia("Failed to load audio script ")})})}Dvi(z,U,la){const Da=U.media;let Ia=null;Da&&(Ia=new $a(Da.vlmField,Da.mteField,Da.repeatField,Da.rewindField));const Db=audioPlayback.pptAudioFactoryGlobal.createAudioManager(z,la,this.pZj.Cvi(U),Ia);this.dFa.YZd(this.Zja.podSessionId,U).then(Ob=>{Db&&Db.setAudioSrc(Ob)});return Db}}Object(h.a)(fb,"AudioManagerFactory",null,[705]);var qc=d(1210);class Hc{constructor(){this.Cwb=new qc.a}lKk(z,
U){U&&this.Cwb.$(U.id,z)}Wzh(z){z&&this.Cwb.Jb(z.id)&&(this.Cwb.ga(z.id).dispose(),this.Cwb.remove(z.id))}nK(z){return z&&this.Cwb.Jb(z.id)?this.Cwb.ga(z.id):null}}Object(h.a)(Hc,"AudioManagerStore",null,[703]);class kd{VPj(z){return!kd.bsb(kd.Zyl)||z>kd.TTe?!0:!1}static bsb(z){return(z=document.getElementById(z))?z:null}}kd.Zyl="PptRibbon.Design.ThemeVariants-MaxSize";kd.TTe=4;Object(h.a)(kd,"ThemeHelper",null,[732]);class Ac{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;this.TransitionType=
0}}Object(h.a)(Ac,"EditTransitionInfo",null,[]);class Lc{constructor(){this.next=this.parent=this.nc=this.ax=this.qc=this.kc=null}}Object(h.a)(Lc,"Transition",null,[]);class yc{}yc.none=0;yc.sTi=5;yc.tTi=4;yc.Jll=1;yc.Fij=1;yc.wbi=2;yc.b7=0;yc.xPa=1;yc.sBa=2;yc.orb=3;yc.YJc=4;yc.XJc=5;yc.$Jc=6;yc.ZJc=7;yc.aOc=2;yc.qRa=1;yc.uij=1;yc.jJf=0;yc.pfi=1;yc.ofi=2;yc.wij=0;yc.vij=1;yc.fgg=2;yc.Gij=3;yc.i2d=0;yc.W0b=1;yc.$Nc=0;yc.W6a=1;yc.Qbi=1;yc.IHf=0;yc.Krh=2;yc.Zel=0;yc.Lll=3;yc.Kll=1;yc.wheel=1;yc.tgh=
29;yc.j5f=0;yc.NUi=1;yc.WUi=2;yc.gVi=3;yc.i5f=8;yc.MUi=9;yc.VUi=10;yc.fVi=11;yc.k5f=12;yc.QUi=13;yc.YUi=14;yc.jVi=15;yc.l5f=4;yc.RUi=5;yc.ZUi=6;yc.kVi=7;yc.XUi=0;yc.hVi=1;yc.aVi=2;yc.OUi=3;yc.e5f=4;yc.iVi=5;yc.bVi=6;yc.PUi=7;Object(h.a)(yc,"TransitionEffectOptions",null,[]);class Oc{}Oc.none=0;Oc.cut=0;Oc.random=1;Oc.blinds=2;Oc.TLd=3;Oc.nAa=4;Oc.dissolve=5;Oc.fade=6;Oc.sJa=7;Oc.eCe=8;Oc.Emd=9;Oc.wipe=10;Oc.lnh=11;Oc.split=13;Oc.x7k=17;Oc.C7k=18;Oc.wedge=19;Oc.push=20;Oc.KMd=21;Oc.$Df=23;Oc.wheel=
26;Oc.inh=27;Oc.Vnc=28;Oc.dFb=29;Oc.kCa=30;Oc.wic=39;Oc.lOe=42;Oc.flip=43;Oc.AL=44;Oc.zAl=47;Oc.vUd=48;Oc.kSd=49;Oc.yCi=50;Oc.lUe=51;Oc.Mzk=52;Oc.vUi=53;Oc.OBi=54;Oc.Jxe=55;Oc.m2g=56;Oc.cxe=57;Oc.eHd=58;Oc.Qwe=59;Oc.morph=60;Oc.pan=36;Oc.CWd=38;Oc.YNd=37;Oc.cSd=33;Oc.window=34;Oc.wZb=32;Oc.zoom=31;Oc.OBl=22;Object(h.a)(Oc,"TransitionTypes",null,[]);class od{constructor(z){let U=0;this.wc=new Kb.a;this.wc.$("TransitionExisting",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionExisting,qc:od.Cc("TransitionFlash"),
parent:"TransitionExisting"}));this.wc.$("TransitionExistingInMenu",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionExisting,qc:od.Cc("TransitionFlash"),parent:"TransitionExisting"}));this.wc.$("TransitionNone",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionNone,qc:od.Cc("TransitionNone"),nc:Object.assign(new Ac,{TransitionType:Oc.none,Direction:yc.wbi,Duration:0,IsManualAdvance:!0}),parent:"TransitionNone"}));this.wc.$("TransitionFade",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFade,
qc:od.Cc("TransitionFadeSmoothly"),nc:Object.assign(new Ac,{TransitionType:Oc.$Df,Direction:yc.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.wc.$("TransitionFadeSmoothly",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionSmoothly,ax:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,qc:od.Cc("TransitionFadeSmoothly"),nc:Object.assign(new Ac,{TransitionType:Oc.$Df,Direction:yc.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));
this.wc.$("TransitionFadeThroughBlack",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionThroughBlack,ax:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,qc:od.Cc("TransitionFadeThroughBlack"),nc:Object.assign(new Ac,{TransitionType:Oc.fade,Direction:yc.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));let la=[];if(z){la=z.toLowerCase().split(",");for(let Da=0;Da<la.length;Da++)la[Da]=la[Da].trim()}Array.contains(la,"push")||(this.wc.$("TransitionPush",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionPush,
qc:od.Cc("TransitionPushUp"),nc:Object.assign(new Ac,{TransitionType:Oc.push,Direction:yc.xPa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.wc.$("TransitionPushFromBottom",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromBottom,ax:CommonUIStrings.l_TransitionPushFromBottomKeytip,qc:od.Cc("TransitionPushUp"),nc:Object.assign(new Ac,{TransitionType:Oc.push,Direction:yc.xPa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),
this.wc.$("TransitionPushFromLeft",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromLeft,ax:CommonUIStrings.l_TransitionPushFromLeftKeytip,qc:od.Cc("TransitionPushRight"),nc:Object.assign(new Ac,{TransitionType:Oc.push,Direction:yc.sBa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),this.wc.$("TransitionPushFromRight",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromRight,ax:CommonUIStrings.l_TransitionPushFromRightKeytip,qc:od.Cc("TransitionPushLeft"),
nc:Object.assign(new Ac,{TransitionType:Oc.push,Direction:yc.b7,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.wc.$("TransitionPushFromTop",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromTop,ax:CommonUIStrings.l_TransitionPushFromTopKeytip,qc:od.Cc("TransitionPushDown"),nc:Object.assign(new Ac,{TransitionType:Oc.push,Direction:yc.orb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(la,"cut")||(this.wc.$("TransitionCut",
Object.assign(new Lc,{kc:ResourceStrings.L_TransitionCut,qc:od.Cc("TransitionCut"),nc:Object.assign(new Ac,{TransitionType:Oc.cut,Direction:yc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.wc.$("TransitionCutNone",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionNone,ax:CommonUIStrings.l_TransitionCutNoneKeytip,qc:od.Cc("TransitionCut"),nc:Object.assign(new Ac,{TransitionType:Oc.cut,Direction:yc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",
next:"TransitionCutThroughBlack"})),this.wc.$("TransitionCutThroughBlack",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionThroughBlack,ax:CommonUIStrings.l_TransitionCutThroughBlackKeytip,qc:od.Cc("TransitionCutThroughBlack"),nc:Object.assign(new Ac,{TransitionType:Oc.cut,Direction:yc.Jll,Duration:500,IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(la,"wipe")||(this.wc.$("TransitionWipe",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionWipe,qc:od.Cc("TransitionWipeLeft"),nc:Object.assign(new Ac,
{TransitionType:Oc.wipe,Direction:yc.b7,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.wc.$("TransitionWipeFromRight",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromRight,ax:CommonUIStrings.l_TransitionWipeFromRightKeytip,qc:od.Cc("TransitionWipeLeft"),nc:Object.assign(new Ac,{TransitionType:Oc.wipe,Direction:yc.b7,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.wc.$("TransitionWipeFromTop",
Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromTop,ax:CommonUIStrings.l_TransitionWipeFromTopKeytip,qc:od.Cc("TransitionWipeDown"),nc:Object.assign(new Ac,{TransitionType:Oc.wipe,Direction:yc.orb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.wc.$("TransitionWipeFromLeft",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromLeft,ax:CommonUIStrings.l_TransitionWipeFromLeftKeytip,qc:od.Cc("TransitionWipeRight"),nc:Object.assign(new Ac,{TransitionType:Oc.wipe,
Direction:yc.sBa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.wc.$("TransitionWipeFromBottom",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromBottom,ax:CommonUIStrings.l_TransitionWipeFromBottomKeytip,qc:od.Cc("TransitionWipeUp"),nc:Object.assign(new Ac,{TransitionType:Oc.wipe,Direction:yc.xPa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.wc.$("TransitionWipeFromTopRight",Object.assign(new Lc,
{kc:ResourceStrings.L_TransitionFromTopRight,ax:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,qc:od.Cc("TransitionStripsLeftDown"),nc:Object.assign(new Ac,{TransitionType:Oc.Emd,Direction:yc.$Jc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.wc.$("TransitionWipeFromBottomRight",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromBottomRight,ax:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,qc:od.Cc("TransitionStripsLeftUp"),
nc:Object.assign(new Ac,{TransitionType:Oc.Emd,Direction:yc.YJc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.wc.$("TransitionWipeFromTopLeft",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromTopLeft,ax:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,qc:od.Cc("TransitionStripsRightDown"),nc:Object.assign(new Ac,{TransitionType:Oc.Emd,Direction:yc.ZJc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),
this.wc.$("TransitionWipeFromBottomLeft",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromBottomLeft,ax:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,qc:od.Cc("TransitionStripsRightUp"),nc:Object.assign(new Ac,{TransitionType:Oc.Emd,Direction:yc.XJc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));Array.contains(la,"morph")||(this.wc.$("TransitionMorph",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionMorph,qc:od.Cc("TransitionByObject"),nc:Object.assign(new Ac,{TransitionType:Oc.morph,
Direction:yc.jJf,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.wc.$("TransitionMorphByObject",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionByObject,ax:CommonUIStrings.l_TransitionMorphObjectsKeytip,qc:od.Cc("TransitionByObject"),nc:Object.assign(new Ac,{TransitionType:Oc.morph,Direction:yc.jJf,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.wc.$("TransitionMorphByWord",Object.assign(new Lc,
{kc:ResourceStrings.L_TransitionByWord,ax:CommonUIStrings.l_TransitionMorphWordsKeytip,qc:od.Cc("TransitionByWord"),nc:Object.assign(new Ac,{TransitionType:Oc.morph,Direction:yc.pfi,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.wc.$("TransitionMorphByChar",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionByChar,ax:CommonUIStrings.l_TransitionMorphCharactersKeytip,qc:od.Cc("TransitionByChar"),nc:Object.assign(new Ac,{TransitionType:Oc.morph,Direction:yc.ofi,
Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph"})));Array.contains(la,"split")||(this.wc.$("TransitionSplit",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionSplit,qc:od.Cc("TransitionSplitOutVertical"),nc:Object.assign(new Ac,{TransitionType:Oc.split,Direction:yc.fgg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),this.wc.$("TransitionSplitVerticalOut",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionVerticalOut,ax:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,
qc:od.Cc("TransitionSplitOutVertical"),nc:Object.assign(new Ac,{TransitionType:Oc.split,Direction:yc.fgg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),this.wc.$("TransitionSplitHorizontalIn",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionHorizontalIn,ax:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,qc:od.Cc("TransitionSplitInHorizontal"),nc:Object.assign(new Ac,{TransitionType:Oc.split,Direction:yc.vij,Duration:1500,IsManualAdvance:!0}),
parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.wc.$("TransitionSplitHorizontalOut",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionHorizontalOut,ax:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,qc:od.Cc("TransitionSplitOutHorizontal"),nc:Object.assign(new Ac,{TransitionType:Oc.split,Direction:yc.wij,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.wc.$("TransitionSplitVerticalIn",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionVerticalIn,
ax:CommonUIStrings.l_TransitionSplitVerticalInKeytip,qc:od.Cc("TransitionSplitInVertical"),nc:Object.assign(new Ac,{TransitionType:Oc.split,Direction:yc.Gij,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));if(!Array.contains(la,"randombars")){this.wc.$("TransitionRandomBars",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionRandomBars,qc:od.Cc("TransitionRandomBarsVertical"),nc:Object.assign(new Ac,{TransitionType:Oc.eCe,Direction:yc.W6a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",
next:"TransitionRandomBarsVertical"}));this.wc.$("TransitionRandomBarsVertical",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionVertical,ax:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,qc:od.Cc("TransitionRandomBarsVertical"),nc:Object.assign(new Ac,{TransitionType:Oc.eCe,Direction:yc.W6a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let Da,Ia;this.wc.$("TransitionRandomBarsHorizontal",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionHorizontal,
Ia.ax=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,Ia.qc=od.Cc("TransitionRandomBarsHorizontal"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.eCe,Da.Direction=yc.$Nc,Da.Duration=1E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionRandomBars",Ia))}if(!Array.contains(la,"shape")){let Da,Ia;this.wc.$("TransitionShape",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionShape,Ia.qc=od.Cc("TransitionShapeCircle"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.inh,Da.Direction=yc.none,Da.Duration=800,Da.IsManualAdvance=
!0,Da),Ia.parent="TransitionShape",Ia.next="TransitionShapeCircle",Ia));let Db,Ob;this.wc.$("TransitionShapeCircle",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionCircle,Ob.ax=CommonUIStrings.l_TransitionShapeCircleKeytip,Ob.qc=od.Cc("TransitionShapeCircle"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.inh,Db.Direction=yc.none,Db.Duration=800,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionShape",Ob.next="TransitionShapeDiamond",Ob));let sc,hc;this.wc.$("TransitionShapeDiamond",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionDiamond,
hc.ax=CommonUIStrings.l_TransitionShapeDiamondKeytip,hc.qc=od.Cc("TransitionShapeDiamond"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.x7k,sc.Direction=yc.none,sc.Duration=800,sc.IsManualAdvance=!0,sc),hc.parent="TransitionShape",hc.next="TransitionShapePlus",hc));let Fc,Xc;this.wc.$("TransitionShapePlus",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionPlus,Xc.ax=CommonUIStrings.l_TransitionShapePlusKeytip,Xc.qc=od.Cc("TransitionShapePlus"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.C7k,Fc.Direction=yc.none,Fc.Duration=
1E3,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionShape",Xc.next="TransitionShapeIn",Xc));let md,Nc;this.wc.$("TransitionShapeIn",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionIn,Nc.ax=CommonUIStrings.l_TransitionShapeInKeytip,Nc.qc=od.Cc("TransitionBoxIn"),Nc.nc=(md=new Ac,md.TransitionType=Oc.lnh,md.Direction=yc.W0b,md.Duration=1200,md.IsManualAdvance=!0,md),Nc.parent="TransitionShape",Nc.next="TransitionShapeOut",Nc));let bf,pe;this.wc.$("TransitionShapeOut",(pe=new Lc,pe.kc=ResourceStrings.L_TransitionOut,
pe.ax=CommonUIStrings.l_TransitionShapeOutKeytip,pe.qc=od.Cc("TransitionBoxOut"),pe.nc=(bf=new Ac,bf.TransitionType=Oc.lnh,bf.Direction=yc.i2d,bf.Duration=1200,bf.IsManualAdvance=!0,bf),pe.parent="TransitionShape",pe))}if(!Array.contains(la,"reveal")){let Da,Ia;this.wc.$("TransitionReveal",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionReveal,Ia.qc=od.Cc("TransitionRevealSmoothlyFromRight"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.wic,Da.Direction=yc.Krh,Da.Duration=3400,Da.IsManualAdvance=!0,Da),Ia.parent=
"TransitionReveal",Ia.next="TransitionRevealSmoothlyFromRight",Ia));let Db,Ob;this.wc.$("TransitionRevealSmoothlyFromRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionSmoothlyFromRight,Ob.qc=od.Cc("TransitionRevealSmoothlyFromRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.wic,Db.Direction=yc.Krh,Db.Duration=3400,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionReveal",Ob.next="TransitionRevealSmoothlyFromLeft",Ob));let sc,hc;this.wc.$("TransitionRevealSmoothlyFromLeft",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionSmoothlyFromLeft,
hc.qc=od.Cc("TransitionRevealSmoothlyFromLeft"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.wic,sc.Direction=yc.Zel,sc.Duration=3400,sc.IsManualAdvance=!0,sc),hc.parent="TransitionReveal",hc.next="TransitionRevealFromRight",hc));let Fc,Xc;this.wc.$("TransitionRevealFromRight",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionThroughBlackFromRight,Xc.qc=od.Cc("TransitionRevealFromRight"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.wic,Fc.Direction=yc.Lll,Fc.Duration=3400,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionReveal",
Xc.next="TransitionRevealFromLeft",Xc));let md,Nc;this.wc.$("TransitionRevealFromLeft",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionThroughBlackFromLeft,Nc.qc=od.Cc("TransitionRevealFromLeft"),Nc.nc=(md=new Ac,md.TransitionType=Oc.wic,md.Direction=yc.Kll,md.Duration=3400,md.IsManualAdvance=!0,md),Nc.parent="TransitionReveal",Nc))}if(!Array.contains(la,"cover")){let Da,Ia;this.wc.$("TransitionCover",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionCover,Ia.qc=od.Cc("TransitionCoverLeft"),Ia.nc=(Da=new Ac,
Da.TransitionType=Oc.nAa,Da.Direction=yc.b7,Da.Duration=1E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionCover",Ia.next="TransitionCoverFromRight",Ia));let Db,Ob;this.wc.$("TransitionCoverFromRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionFromRight,Ob.qc=od.Cc("TransitionCoverLeft"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.nAa,Db.Direction=yc.b7,Db.Duration=1E3,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionCover",Ob.next="TransitionCoverFromTop",Ob));let sc,hc;this.wc.$("TransitionCoverFromTop",
(hc=new Lc,hc.kc=ResourceStrings.L_TransitionFromTop,hc.qc=od.Cc("TransitionCoverDown"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.nAa,sc.Direction=yc.orb,sc.Duration=1E3,sc.IsManualAdvance=!0,sc),hc.parent="TransitionCover",hc.next="TransitionCoverFromLeft",hc));let Fc,Xc;this.wc.$("TransitionCoverFromLeft",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionFromLeft,Xc.qc=od.Cc("TransitionCoverRight"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.nAa,Fc.Direction=yc.sBa,Fc.Duration=1E3,Fc.IsManualAdvance=!0,Fc),Xc.parent=
"TransitionCover",Xc.next="TransitionCoverFromBottom",Xc));let md,Nc;this.wc.$("TransitionCoverFromBottom",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionFromBottom,Nc.qc=od.Cc("TransitionCoverUp"),Nc.nc=(md=new Ac,md.TransitionType=Oc.nAa,md.Direction=yc.xPa,md.Duration=1E3,md.IsManualAdvance=!0,md),Nc.parent="TransitionCover",Nc.next="TransitionCoverFromTopRight",Nc));let bf,pe;this.wc.$("TransitionCoverFromTopRight",(pe=new Lc,pe.kc=ResourceStrings.L_TransitionFromTopRight,pe.qc=od.Cc("TransitionCoverLeftDown"),
pe.nc=(bf=new Ac,bf.TransitionType=Oc.nAa,bf.Direction=yc.$Jc,bf.Duration=1E3,bf.IsManualAdvance=!0,bf),pe.parent="TransitionCover",pe.next="TransitionCoverFromBottomRight",pe));let wf,rf;this.wc.$("TransitionCoverFromBottomRight",(rf=new Lc,rf.kc=ResourceStrings.L_TransitionFromBottomRight,rf.qc=od.Cc("TransitionCoverLeftUp"),rf.nc=(wf=new Ac,wf.TransitionType=Oc.nAa,wf.Direction=yc.YJc,wf.Duration=1E3,wf.IsManualAdvance=!0,wf),rf.parent="TransitionCover",rf.next="TransitionCoverFromTopLeft",rf));
let fi,Fh;this.wc.$("TransitionCoverFromTopLeft",(Fh=new Lc,Fh.kc=ResourceStrings.L_TransitionFromTopLeft,Fh.qc=od.Cc("TransitionCoverRightDown"),Fh.nc=(fi=new Ac,fi.TransitionType=Oc.nAa,fi.Direction=yc.ZJc,fi.Duration=1E3,fi.IsManualAdvance=!0,fi),Fh.parent="TransitionCover",Fh.next="TransitionCoverFromBottomLeft",Fh));let Qf,Mh;this.wc.$("TransitionCoverFromBottomLeft",(Mh=new Lc,Mh.kc=ResourceStrings.L_TransitionFromBottomLeft,Mh.qc=od.Cc("TransitionCoverRightUp"),Mh.nc=(Qf=new Ac,Qf.TransitionType=
Oc.nAa,Qf.Direction=yc.XJc,Qf.Duration=1E3,Qf.IsManualAdvance=!0,Qf),Mh.parent="TransitionCover",Mh))}if(!Array.contains(la,"uncover")){let Da,Ia;this.wc.$("TransitionUncover",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionUncover,Ia.qc=od.Cc("TransitionUncoverLeft"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.sJa,Da.Direction=yc.b7,Da.Duration=750,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionUncover",Ia.next="TransitionUncoverFromRight",Ia));let Db,Ob;this.wc.$("TransitionUncoverFromRight",(Ob=new Lc,
Ob.kc=ResourceStrings.L_TransitionFromRight,Ob.qc=od.Cc("TransitionUncoverLeft"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.sJa,Db.Direction=yc.b7,Db.Duration=750,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionUncover",Ob.next="TransitionUncoverFromTop",Ob));let sc,hc;this.wc.$("TransitionUncoverFromTop",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionFromTop,hc.qc=od.Cc("TransitionUncoverDown"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.sJa,sc.Direction=yc.orb,sc.Duration=750,sc.IsManualAdvance=!0,sc),hc.parent=
"TransitionUncover",hc.next="TransitionUncoverFromLeft",hc));let Fc,Xc;this.wc.$("TransitionUncoverFromLeft",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionFromLeft,Xc.qc=od.Cc("TransitionUncoverRight"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.sJa,Fc.Direction=yc.sBa,Fc.Duration=750,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionUncover",Xc.next="TransitionUncoverFromBottom",Xc));let md,Nc;this.wc.$("TransitionUncoverFromBottom",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionFromBottom,Nc.qc=od.Cc("TransitionUncoverUp"),
Nc.nc=(md=new Ac,md.TransitionType=Oc.sJa,md.Direction=yc.xPa,md.Duration=750,md.IsManualAdvance=!0,md),Nc.parent="TransitionUncover",Nc.next="TransitionUncoverFromTopRight",Nc));this.wc.$("TransitionUncoverFromTopRight",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromTopRight,qc:od.Cc("TransitionUncoverLeftDown"),nc:Object.assign(new Ac,{TransitionType:Oc.sJa,Direction:yc.$Jc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.wc.$("TransitionUncoverFromBottomRight",
Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromBottomRight,qc:od.Cc("TransitionUncoverLeftUp"),nc:Object.assign(new Ac,{TransitionType:Oc.sJa,Direction:yc.YJc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));this.wc.$("TransitionUncoverFromTopLeft",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromTopLeft,qc:od.Cc("TransitionUncoverRightDown"),nc:Object.assign(new Ac,{TransitionType:Oc.sJa,Direction:yc.ZJc,Duration:750,IsManualAdvance:!0}),
parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.wc.$("TransitionUncoverFromBottomLeft",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromBottomLeft,qc:od.Cc("TransitionUncoverRightUp"),nc:Object.assign(new Ac,{TransitionType:Oc.sJa,Direction:yc.XJc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(la,"menusectionexciting")){if(!Array.contains(la,"fallover")){this.wc.$("TransitionFallOver",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFallOver,
qc:od.Cc("TransitionFallOverLeft"),nc:Object.assign(new Ac,{TransitionType:Oc.vUd,Direction:yc.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let Da,Ia;this.wc.$("TransitionFallOverLeft",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionGoLeft,Ia.qc=od.Cc("TransitionFallOverLeft"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.vUd,Da.Direction=yc.none,Da.Duration=2E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionFallOver",Ia.next="TransitionFallOverRight",Ia));
let Db,Ob;this.wc.$("TransitionFallOverRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionGoRight,Ob.qc=od.Cc("TransitionFallOverRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.vUd,Db.Direction=yc.qRa,Db.Duration=2E3,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionFallOver",Ob))}if(!Array.contains(la,"drape")){let Da,Ia;this.wc.$("TransitionDrape",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionDrape,Ia.qc=od.Cc("TransitionDrapeLeft"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.kSd,Da.Direction=yc.none,Da.Duration=
2E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionDrape",Ia.next="TransitionDrapeLeft",Ia));let Db,Ob;this.wc.$("TransitionDrapeLeft",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionGoLeft,Ob.qc=od.Cc("TransitionDrapeLeft"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.kSd,Db.Direction=yc.none,Db.Duration=2E3,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionDrape",Ob.next="TransitionDrapeRight",Ob));let sc,hc;this.wc.$("TransitionDrapeRight",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionGoRight,hc.qc=od.Cc("TransitionDrapeRight"),
hc.nc=(sc=new Ac,sc.TransitionType=Oc.kSd,sc.Direction=yc.qRa,sc.Duration=2E3,sc.IsManualAdvance=!0,sc),hc.parent="TransitionDrape",hc))}if(!Array.contains(la,"curtains")){let Da,Ia;this.wc.$("TransitionCurtains",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionCurtains,Ia.qc=od.Cc("TransitionCurtains"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.yCi,Da.Direction=yc.none,Da.Duration=6E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionCurtains",Ia))}if(!Array.contains(la,"wind")){let Da,Ia;this.wc.$("TransitionWind",
(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionWind,Ia.qc=od.Cc("TransitionWindRight"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.lUe,Da.Direction=yc.none,Da.Duration=2E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionWind",Ia.next="TransitionWindRight",Ia));let Db,Ob;this.wc.$("TransitionWindRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionGoRight,Ob.qc=od.Cc("TransitionWindRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.lUe,Db.Direction=yc.none,Db.Duration=2E3,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionWind",
Ob.next="TransitionWindLeft",Ob));let sc,hc;this.wc.$("TransitionWindLeft",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionGoLeft,hc.qc=od.Cc("TransitionWindLeft"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.lUe,sc.Direction=yc.qRa,sc.Duration=2E3,sc.IsManualAdvance=!0,sc),hc.parent="TransitionWind",hc))}if(!Array.contains(la,"prestige")){let Da,Ia;this.wc.$("TransitionPrestige",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionPrestige,Ia.qc=od.Cc("TransitionPrestige"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.Mzk,
Da.Direction=yc.none,Da.Duration=2E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionPrestige",Ia))}if(!Array.contains(la,"fracture")){let Da,Ia;this.wc.$("TransitionFracture",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionFracture,Ia.qc=od.Cc("TransitionFracture"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.vUi,Da.Direction=yc.none,Da.Duration=2E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionFracture",Ia))}if(!Array.contains(la,"crush")){let Da,Ia;this.wc.$("TransitionCrush",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionCrush,
Ia.qc=od.Cc("TransitionCrush"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.OBi,Da.Direction=yc.none,Da.Duration=2E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionCrush",Ia))}if(!Array.contains(la,"peeloff")){let Da,Ia;this.wc.$("TransitionPeelOff",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionPeelOff,Ia.qc=od.Cc("TransitionPeelOffLeft"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.Jxe,Da.Direction=yc.none,Da.Duration=1250,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionPeelOff",Ia.next="TransitionPeelOffLeft",
Ia));let Db,Ob;this.wc.$("TransitionPeelOffLeft",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionGoLeft,Ob.qc=od.Cc("TransitionPeelOffLeft"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.Jxe,Db.Direction=yc.none,Db.Duration=1250,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionPeelOff",Ob.next="TransitionPeelOffRight",Ob));let sc,hc;this.wc.$("TransitionPeelOffRight",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionGoRight,hc.qc=od.Cc("TransitionPeelOffRight"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.Jxe,sc.Direction=
yc.qRa,sc.Duration=1250,sc.IsManualAdvance=!0,sc),hc.parent="TransitionPeelOff",hc))}if(!Array.contains(la,"pagecurl")){let Da,Ia;this.wc.$("TransitionPageCurl",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionPageCurl,Ia.qc=od.Cc("TransitionTwoPageCurlFromRight"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.cxe,Da.Direction=yc.none,Da.Duration=1250,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionPageCurl",Ia.next="TransitionPageCurlDoubleLeft",Ia));let Db,Ob;this.wc.$("TransitionPageCurlDoubleLeft",(Ob=new Lc,
Ob.kc=ResourceStrings.L_TransitionEffectOptionDoubleLeft,Ob.qc=od.Cc("TransitionTwoPageCurlFromRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.cxe,Db.Direction=yc.none,Db.Duration=1250,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionPageCurl",Ob.next="TransitionPageCurlDoubleRight",Ob));let sc,hc;this.wc.$("TransitionPageCurlDoubleRight",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionEffectOptionDoubleRight,hc.qc=od.Cc("TransitionTwoPageCurlFromLeft"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.cxe,sc.Direction=
yc.qRa,sc.Duration=1250,sc.IsManualAdvance=!0,sc),hc.parent="TransitionPageCurl",hc.next="TransitionPageCurlSingleLeft",hc));let Fc,Xc;this.wc.$("TransitionPageCurlSingleLeft",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionEffectOptionSingleLeft,Xc.qc=od.Cc("TransitionPageCurlFromRight"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.m2g,Fc.Direction=yc.none,Fc.Duration=1250,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionPageCurl",Xc.next="TransitionPageCurlSingleRight",Xc));let md,Nc;this.wc.$("TransitionPageCurlSingleRight",
(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionEffectOptionSingleRight,Nc.qc=od.Cc("TransitionPageCurlFromLeft"),Nc.nc=(md=new Ac,md.TransitionType=Oc.m2g,md.Direction=yc.qRa,md.Duration=1250,md.IsManualAdvance=!0,md),Nc.parent="TransitionPageCurl",Nc))}if(!Array.contains(la,"airplane")){let Da,Ia;this.wc.$("TransitionAirplane",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionAirplane,Ia.qc=od.Cc("TransitionAirplaneRight"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.eHd,Da.Direction=yc.none,Da.Duration=1250,
Da.IsManualAdvance=!0,Da),Ia.parent="TransitionAirplane",Ia.next="TransitionAirplaneRight",Ia));let Db,Ob;this.wc.$("TransitionAirplaneRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionGoRight,Ob.qc=od.Cc("TransitionAirplaneRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.eHd,Db.Direction=yc.none,Db.Duration=1250,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionAirplane",Ob.next="TransitionAirplaneLeft",Ob));let sc,hc;this.wc.$("TransitionAirplaneLeft",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionGoLeft,
hc.qc=od.Cc("TransitionAirplaneLeft"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.eHd,sc.Direction=yc.qRa,sc.Duration=1250,sc.IsManualAdvance=!0,sc),hc.parent="TransitionAirplane",hc))}if(!Array.contains(la,"origami")){let Da,Ia;this.wc.$("TransitionOrigami",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionOrigami,Ia.qc=od.Cc("TransitionOrigamiRight"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.Qwe,Da.Direction=yc.none,Da.Duration=3250,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionOrigami",Ia.next="TransitionOrigamiRight",
Ia));let Db,Ob;this.wc.$("TransitionOrigamiRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionGoRight,Ob.qc=od.Cc("TransitionOrigamiRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.Qwe,Db.Direction=yc.none,Db.Duration=3250,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionOrigami",Ob.next="TransitionOrigamiLeft",Ob));let sc,hc;this.wc.$("TransitionOrigamiLeft",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionGoLeft,hc.qc=od.Cc("TransitionOrigamiLeft"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.Qwe,sc.Direction=
yc.qRa,sc.Duration=3250,sc.IsManualAdvance=!0,sc),hc.parent="TransitionOrigami",hc))}Array.contains(la,"dissolve")||this.wc.$("TransitionDissolve",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionDissolve,qc:od.Cc("TransitionDissolve"),nc:Object.assign(new Ac,{TransitionType:Oc.dissolve,Direction:yc.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(la,"checker")||(this.wc.$("TransitionChecker",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionChecker,qc:od.Cc("TransitionCheckerboardAcross"),
nc:Object.assign(new Ac,{TransitionType:Oc.TLd,Direction:yc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.wc.$("TransitionCheckerFromLeft",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromLeft,qc:od.Cc("TransitionCheckerboardAcross"),nc:Object.assign(new Ac,{TransitionType:Oc.TLd,Direction:yc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.wc.$("TransitionCheckerFromTop",
Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromTop,qc:od.Cc("TransitionCheckerboardDown"),nc:Object.assign(new Ac,{TransitionType:Oc.TLd,Direction:yc.uij,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));if(!Array.contains(la,"blinds")){this.wc.$("TransitionBlinds",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionBlinds,qc:od.Cc("TransitionBlindsVertical"),nc:Object.assign(new Ac,{TransitionType:Oc.blinds,Direction:yc.IHf,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",
next:"TransitionBlindsVertical"}));let Da,Ia;this.wc.$("TransitionBlindsVertical",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionVertical,Ia.qc=od.Cc("TransitionBlindsVertical"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.blinds,Da.Direction=yc.IHf,Da.Duration=1600,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionBlinds",Ia.next="TransitionBlindsHorizontal",Ia));let Db,Ob;this.wc.$("TransitionBlindsHorizontal",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionHorizontal,Ob.qc=od.Cc("TransitionBlindsHorizontal"),
Ob.nc=(Db=new Ac,Db.TransitionType=Oc.blinds,Db.Direction=yc.Qbi,Db.Duration=1600,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionBlinds",Ob))}if(!Array.contains(la,"wheel")){let Da,Ia;this.wc.$("TransitionWheel",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionWheel,Ia.qc=od.Cc("TransitionWheelClockwise1"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.wheel,Da.Direction=yc.wheel,Da.Duration=1E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionWheel",Ia.next="TransitionWheelClockwise",Ia));let Db,Ob;this.wc.$("TransitionWheelClockwise",
(Ob=new Lc,Ob.kc=ResourceStrings.l_TransitionWheelClockWise,Ob.qc=od.Cc("TransitionWheelClockwise1"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.wheel,Db.Direction=yc.wheel,Db.Duration=1E3,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionWheel",Ob.next="TransitionWheelCounterclockwise",Ob));let sc,hc;this.wc.$("TransitionWheelCounterclockwise",(hc=new Lc,hc.kc=ResourceStrings.l_TransitionWheelCounterClockWise,hc.qc=od.Cc("TransitionWheelCounterclockwise1"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.zAl,sc.Direction=
yc.wheel,sc.Duration=1E3,sc.IsManualAdvance=!0,sc),hc.parent="TransitionWheel",hc.next="TransitionWheelWedge",hc));let Fc,Xc;this.wc.$("TransitionWheelWedge",(Xc=new Lc,Xc.kc=ResourceStrings.l_TransitionWheelWedge,Xc.qc=od.Cc("TransitionWedge"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.wedge,Fc.Direction=yc.none,Fc.Duration=1E3,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionWheel",Xc))}if(!Array.contains(la,"ripple")){let Da,Ia;this.wc.$("TransitionRipple",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionRipple,
Ia.qc=od.Cc("TransitionRipple"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.dFb,Da.Direction=yc.tgh,Da.Duration=1400,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionRipple",Ia.next="TransitionRippleCenter",Ia));let Db,Ob;this.wc.$("TransitionRippleCenter",(Ob=new Lc,Ob.kc=ResourceStrings.L_EffectOptionsDirectionCenter,Ob.qc=od.Cc("TransitionRipple"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.dFb,Db.Direction=yc.tgh,Db.Duration=1400,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionRipple",Ob.next="TransitionRippleBottomLeft",
Ob));let sc,hc;this.wc.$("TransitionRippleBottomLeft",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionFromBottomLeft,hc.qc=od.Cc("TransitionRippleBottomLeft"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.dFb,sc.Direction=yc.XJc,sc.Duration=1500,sc.IsManualAdvance=!0,sc),hc.parent="TransitionRipple",hc.next="TransitionRippleBottomRight",hc));let Fc,Xc;this.wc.$("TransitionRippleBottomRight",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionFromBottomRight,Xc.qc=od.Cc("TransitionRippleBottomRight"),Xc.nc=(Fc=new Ac,
Fc.TransitionType=Oc.dFb,Fc.Direction=yc.YJc,Fc.Duration=1500,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionRipple",Xc.next="TransitionRippleTopRight",Xc));let md,Nc;this.wc.$("TransitionRippleTopRight",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionFromTopRight,Nc.qc=od.Cc("TransitionRippleTopRight"),Nc.nc=(md=new Ac,md.TransitionType=Oc.dFb,md.Direction=yc.$Jc,md.Duration=1500,md.IsManualAdvance=!0,md),Nc.parent="TransitionRipple",Nc.next="TransitionRippleTopLeft",Nc));let bf,pe;this.wc.$("TransitionRippleTopLeft",
(pe=new Lc,pe.kc=ResourceStrings.L_TransitionFromTopLeft,pe.qc=od.Cc("TransitionRippleTopLeft"),pe.nc=(bf=new Ac,bf.TransitionType=Oc.dFb,bf.Direction=yc.ZJc,bf.Duration=1500,bf.IsManualAdvance=!0,bf),pe.parent="TransitionRipple",pe))}if(!Array.contains(la,"glitter")){let Da,Ia;this.wc.$("TransitionGlitter",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionGlitter,Ia.qc=od.Cc("TransitionGlitterHexagonLeft"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.kCa,Da.Direction=yc.e5f,Da.Duration=3900,Da.IsManualAdvance=
!0,Da),Ia.parent="TransitionGlitter",Ia.next="TransitionGlitterHexagonLeft",Ia));let Db,Ob;this.wc.$("TransitionGlitterHexagonLeft",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionHexagonsFromLeft,Ob.qc=od.Cc("TransitionGlitterHexagonLeft"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.kCa,Db.Direction=yc.e5f,Db.Duration=3900,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionGlitter",Ob.next="TransitionGlitterHexagonTop",Ob));let sc,hc;this.wc.$("TransitionGlitterHexagonTop",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionHexagonsFromTop,
hc.qc=od.Cc("TransitionGlitterHexagonTop"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.kCa,sc.Direction=yc.iVi,sc.Duration=3900,sc.IsManualAdvance=!0,sc),hc.parent="TransitionGlitter",hc.next="TransitionGlitterHexagonRight",hc));let Fc,Xc;this.wc.$("TransitionGlitterHexagonRight",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionHexagonsFromRight,Xc.qc=od.Cc("TransitionGlitterHexagonRight"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.kCa,Fc.Direction=yc.bVi,Fc.Duration=3900,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionGlitter",
Xc.next="TransitionGlitterHexagonBottom",Xc));let md,Nc;this.wc.$("TransitionGlitterHexagonBottom",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionHexagonsFromBottom,Nc.qc=od.Cc("TransitionGlitterHexagonBottom"),Nc.nc=(md=new Ac,md.TransitionType=Oc.kCa,md.Direction=yc.PUi,md.Duration=3900,md.IsManualAdvance=!0,md),Nc.parent="TransitionGlitter",Nc.next="TransitionGlitterDiamondLeft",Nc));let bf,pe;this.wc.$("TransitionGlitterDiamondLeft",(pe=new Lc,pe.kc=ResourceStrings.L_TransitionDiamondsFromLeft,
pe.qc=od.Cc("TransitionGlitterDiamondLeft"),pe.nc=(bf=new Ac,bf.TransitionType=Oc.kCa,bf.Direction=yc.XUi,bf.Duration=3900,bf.IsManualAdvance=!0,bf),pe.parent="TransitionGlitter",pe.next="TransitionGlitterDiamondTop",pe));let wf,rf;this.wc.$("TransitionGlitterDiamondTop",(rf=new Lc,rf.kc=ResourceStrings.L_TransitionDiamondsFromTop,rf.qc=od.Cc("TransitionGlitterDiamondTop"),rf.nc=(wf=new Ac,wf.TransitionType=Oc.kCa,wf.Direction=yc.hVi,wf.Duration=3900,wf.IsManualAdvance=!0,wf),rf.parent="TransitionGlitter",
rf.next="TransitionGlitterDiamondRight",rf));let fi,Fh;this.wc.$("TransitionGlitterDiamondRight",(Fh=new Lc,Fh.kc=ResourceStrings.L_TransitionDiamondsFromRight,Fh.qc=od.Cc("TransitionGlitterDiamondRight"),Fh.nc=(fi=new Ac,fi.TransitionType=Oc.kCa,fi.Direction=yc.aVi,fi.Duration=3900,fi.IsManualAdvance=!0,fi),Fh.parent="TransitionGlitter",Fh.next="TransitionGlitterDiamondBottom",Fh));let Qf,Mh;this.wc.$("TransitionGlitterDiamondBottom",(Mh=new Lc,Mh.kc=ResourceStrings.L_TransitionDiamondsFromBottom,
Mh.qc=od.Cc("TransitionGlitterDiamondBottom"),Mh.nc=(Qf=new Ac,Qf.TransitionType=Oc.kCa,Qf.Direction=yc.OUi,Qf.Duration=3900,Qf.IsManualAdvance=!0,Qf),Mh.parent="TransitionGlitter",Mh))}if(!Array.contains(la,"vortex")){let Da,Ia;this.wc.$("TransitionVortex",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionVortex,Ia.qc=od.Cc("TransitionVortexFromLeft"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.Vnc,Da.Direction=yc.sBa,Da.Duration=4E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionVortex",Ia.next="TransitionVortexFromLeft",
Ia));let Db,Ob;this.wc.$("TransitionVortexFromLeft",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionFromLeft,Ob.qc=od.Cc("TransitionVortexFromLeft"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.Vnc,Db.Direction=yc.sBa,Db.Duration=4E3,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionVortex",Ob.next="TransitionVortexFromTop",Ob));let sc,hc;this.wc.$("TransitionVortexFromTop",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionFromTop,hc.qc=od.Cc("TransitionVortexFromTop"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.Vnc,sc.Direction=
yc.orb,sc.Duration=4E3,sc.IsManualAdvance=!0,sc),hc.parent="TransitionVortex",hc.next="TransitionVortexFromRight",hc));let Fc,Xc;this.wc.$("TransitionVortexFromRight",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionFromRight,Xc.qc=od.Cc("TransitionVortexFromRight"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.Vnc,Fc.Direction=yc.b7,Fc.Duration=4E3,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionVortex",Xc.next="TransitionVortexFromBottom",Xc));let md,Nc;this.wc.$("TransitionVortexFromBottom",(Nc=new Lc,Nc.kc=
ResourceStrings.L_TransitionFromBottom,Nc.qc=od.Cc("TransitionVortexFromBottom"),Nc.nc=(md=new Ac,md.TransitionType=Oc.Vnc,md.Direction=yc.xPa,md.Duration=4E3,md.IsManualAdvance=!0,md),Nc.parent="TransitionVortex",Nc))}Array.contains(la,"switch")||(this.wc.$("TransitionSwitch",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionSwitch,qc:od.Cc("TransitionSwitchRight"),nc:Object.assign(new Ac,{TransitionType:Oc.lOe,Direction:yc.aOc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),
this.wc.$("TransitionSwitchRight",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionGoRight,qc:od.Cc("TransitionSwitchRight"),nc:Object.assign(new Ac,{TransitionType:Oc.lOe,Direction:yc.aOc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.wc.$("TransitionSwitchLeft",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionGoLeft,qc:od.Cc("TransitionSwitchLeft"),nc:Object.assign(new Ac,{TransitionType:Oc.lOe,Direction:yc.none,Duration:1250,IsManualAdvance:!0}),
parent:"TransitionSwitch"})));if(!Array.contains(la,"flip")){this.wc.$("TransitionFlip",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFlip,qc:od.Cc("TransitionFlipRight"),nc:Object.assign(new Ac,{TransitionType:Oc.flip,Direction:yc.aOc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.wc.$("TransitionFlipRight",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionGoRight,qc:od.Cc("TransitionFlipRight"),nc:Object.assign(new Ac,{TransitionType:Oc.flip,
Direction:yc.aOc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));let Da,Ia;this.wc.$("TransitionFlipLeft",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionGoLeft,Ia.qc=od.Cc("TransitionFlipLeft"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.flip,Da.Direction=yc.none,Da.Duration=1250,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionFlip",Ia))}if(!Array.contains(la,"galleryicon")){let Da,Ia;this.wc.$("TransitionGalleryIcon",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionGallery,
Ia.qc=od.Cc("TransitionGalleryRight"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.CWd,Da.Direction=yc.b7,Da.Duration=1600,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionGalleryIcon",Ia.next="TransitionGalleryIconFromRight",Ia));let Db,Ob;this.wc.$("TransitionGalleryIconFromRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionFromRight,Ob.qc=od.Cc("TransitionGalleryRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.CWd,Db.Direction=yc.b7,Db.Duration=1600,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionGalleryIcon",
Ob.next="TransitionGalleryIconFromLeft",Ob));let sc,hc;this.wc.$("TransitionGalleryIconFromLeft",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionFromLeft,hc.qc=od.Cc("TransitionGalleryLeft"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.CWd,sc.Direction=yc.sBa,sc.Duration=1600,sc.IsManualAdvance=!0,sc),hc.parent="TransitionGalleryIcon",hc))}if(!Array.contains(la,"cube")){let Da,Ia;this.wc.$("TransitionCube",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionCube,Ia.qc=od.Cc("TransitionCubeFromRight"),Ia.nc=(Da=new Ac,
Da.TransitionType=Oc.AL,Da.Direction=yc.j5f,Da.Duration=1200,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionCube",Ia.next="TransitionCubeFromRight",Ia));let Db,Ob;this.wc.$("TransitionCubeFromRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionFromRight,Ob.qc=od.Cc("TransitionCubeFromRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.AL,Db.Direction=yc.j5f,Db.Duration=1200,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionCube",Ob.next="TransitionCubeFromBottom",Ob));let sc,hc;this.wc.$("TransitionCubeFromBottom",
(hc=new Lc,hc.kc=ResourceStrings.L_TransitionFromBottom,hc.qc=od.Cc("TransitionCubeFromBottom"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.AL,sc.Direction=yc.NUi,sc.Duration=1200,sc.IsManualAdvance=!0,sc),hc.parent="TransitionCube",hc.next="TransitionCubeFromLeft",hc));let Fc,Xc;this.wc.$("TransitionCubeFromLeft",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionFromLeft,Xc.qc=od.Cc("TransitionCubeFromLeft"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.AL,Fc.Direction=yc.WUi,Fc.Duration=1200,Fc.IsManualAdvance=!0,
Fc),Xc.parent="TransitionCube",Xc.next="TransitionCubeFromTop",Xc));let md,Nc;this.wc.$("TransitionCubeFromTop",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionFromTop,Nc.qc=od.Cc("TransitionCubeFromTop"),Nc.nc=(md=new Ac,md.TransitionType=Oc.AL,md.Direction=yc.gVi,md.Duration=1200,md.IsManualAdvance=!0,md),Nc.parent="TransitionCube",Nc))}if(!Array.contains(la,"doors")){let Da,Ia;this.wc.$("TransitionDoors",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionDoors,Ia.qc=od.Cc("TransitionDoorsVertical"),Ia.nc=
(Da=new Ac,Da.TransitionType=Oc.cSd,Da.Direction=yc.W6a,Da.Duration=1400,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionDoors",Ia.next="TransitionDoorsVertical",Ia));let Db,Ob;this.wc.$("TransitionDoorsVertical",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionVertical,Ob.qc=od.Cc("TransitionDoorsVertical"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.cSd,Db.Direction=yc.W6a,Db.Duration=1400,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionDoors",Ob.next="TransitionDoorsHorizontal",Ob));let sc,hc;this.wc.$("TransitionDoorsHorizontal",
(hc=new Lc,hc.kc=ResourceStrings.L_TransitionHorizontal,hc.qc=od.Cc("TransitionDoorsHorizontal"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.cSd,sc.Direction=yc.$Nc,sc.Duration=1400,sc.IsManualAdvance=!0,sc),hc.parent="TransitionDoors",hc))}if(!Array.contains(la,"box")){let Da,Ia;this.wc.$("TransitionBox",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionBox,Ia.qc=od.Cc("TransitionBoxFromRight"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.AL,Da.Direction=yc.i5f,Da.Duration=1600,Da.IsManualAdvance=!0,Da),Ia.parent=
"TransitionBox",Ia.next="TransitionBoxFromRight",Ia));let Db,Ob;this.wc.$("TransitionBoxFromRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionFromRight,Ob.qc=od.Cc("TransitionBoxFromRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.AL,Db.Direction=yc.i5f,Db.Duration=1600,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionBox",Ob.next="TransitionBoxFromBottom",Ob));let sc,hc;this.wc.$("TransitionBoxFromBottom",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionFromBottom,hc.qc=od.Cc("TransitionBoxFromBottom"),
hc.nc=(sc=new Ac,sc.TransitionType=Oc.AL,sc.Direction=yc.MUi,sc.Duration=1600,sc.IsManualAdvance=!0,sc),hc.parent="TransitionBox",hc.next="TransitionBoxFromLeft",hc));let Fc,Xc;this.wc.$("TransitionBoxFromLeft",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionFromLeft,Xc.qc=od.Cc("TransitionBoxFromLeft"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.AL,Fc.Direction=yc.VUi,Fc.Duration=1600,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionBox",Xc.next="TransitionBoxFromTop",Xc));let md,Nc;this.wc.$("TransitionBoxFromTop",
(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionFromTop,Nc.qc=od.Cc("TransitionBoxFromTop"),Nc.nc=(md=new Ac,md.TransitionType=Oc.AL,md.Direction=yc.fVi,md.Duration=1600,md.IsManualAdvance=!0,md),Nc.parent="TransitionBox",Nc))}if(!Array.contains(la,"comb")){let Da,Ia;this.wc.$("TransitionComb",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionComb,Ia.qc=od.Cc("TransitionCombHorizontal"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.KMd,Da.Direction=yc.none,Da.Duration=1E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionComb",
Ia.next="TransitionCombHorizontal",Ia));let Db,Ob;this.wc.$("TransitionCombHorizontal",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionHorizontal,Ob.qc=od.Cc("TransitionCombHorizontal"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.KMd,Db.Direction=yc.$Nc,Db.Duration=1E3,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionComb",Ob.next="TransitionCombVertical",Ob));let sc,hc;this.wc.$("TransitionCombVertical",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionVertical,hc.qc=od.Cc("TransitionCombVertical"),hc.nc=(sc=new Ac,
sc.TransitionType=Oc.KMd,sc.Direction=yc.W6a,sc.Duration=1E3,sc.IsManualAdvance=!0,sc),hc.parent="TransitionComb",hc))}if(!Array.contains(la,"zoom")){let Da,Ia;this.wc.$("TransitionZoom",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionZoom,Ia.qc=od.Cc("TransitionZoomIn"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.zoom,Da.Direction=yc.W0b,Da.Duration=900,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionZoom",Ia.next="TransitionZoomIn",Ia));let Db,Ob;this.wc.$("TransitionZoomIn",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionIn,
Ob.qc=od.Cc("TransitionZoomIn"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.zoom,Db.Direction=yc.W0b,Db.Duration=900,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionZoom",Ob.next="TransitionZoomOut",Ob));let sc,hc;this.wc.$("TransitionZoomOut",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionOut,hc.qc=od.Cc("TransitionZoomOut"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.zoom,sc.Direction=yc.i2d,sc.Duration=900,sc.IsManualAdvance=!0,sc),hc.parent="TransitionZoom",hc.next="TransitionZoomAndRotate",hc));let Fc,Xc;this.wc.$("TransitionZoomAndRotate",
(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionZoomAndRotate,Xc.qc=od.Cc("TransitionNewsFlash"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.OBl,Fc.Direction=yc.none,Fc.Duration=1500,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionZoom",Xc))}if(!Array.contains(la,"random")){let Da,Ia;this.wc.$("TransitionRandom",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionRandom,Ia.qc=od.Cc("TransitionRandom"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.random,Da.Direction=yc.Fij,Da.Duration=1500,Da.IsManualAdvance=!0,Da),Ia.parent=
"TransitionRandom",Ia))}}if(!Array.contains(la,"menusectiondynamiccontent")){if(!Array.contains(la,"pan")){let Da,Ia;this.wc.$("TransitionPan",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionPan,Ia.qc=od.Cc("TransitionPanFromBottom"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.pan,Da.Direction=yc.xPa,Da.Duration=1300,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionPan",Ia.next="TransitionPanFromBottom",Ia));this.wc.$("TransitionPanFromBottom",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromBottom,
qc:od.Cc("TransitionPanFromBottom"),nc:Object.assign(new Ac,{TransitionType:Oc.pan,Direction:yc.xPa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.wc.$("TransitionPanFromLeft",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromLeft,qc:od.Cc("TransitionPanFromLeft"),nc:Object.assign(new Ac,{TransitionType:Oc.pan,Direction:yc.sBa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.wc.$("TransitionPanFromRight",
Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromRight,qc:od.Cc("TransitionPanFromRight"),nc:Object.assign(new Ac,{TransitionType:Oc.pan,Direction:yc.b7,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.wc.$("TransitionPanFromTop",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionFromTop,qc:od.Cc("TransitionPanFromTop"),nc:Object.assign(new Ac,{TransitionType:Oc.pan,Direction:yc.orb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(la,
"conveyor")){this.wc.$("TransitionConveyor",Object.assign(new Lc,{kc:ResourceStrings.L_TransitionConveyor,qc:od.Cc("TransitionConveyorRight"),nc:Object.assign(new Ac,{TransitionType:Oc.YNd,Direction:yc.b7,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let Da,Ia;this.wc.$("TransitionConveyorFromRight",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionFromRight,Ia.qc=od.Cc("TransitionConveyorRight"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.YNd,Da.Direction=
yc.b7,Da.Duration=1600,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionConveyor",Ia.next="TransitionConveyorFromLeft",Ia));let Db,Ob;this.wc.$("TransitionConveyorFromLeft",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionFromLeft,Ob.qc=od.Cc("TransitionConveyorLeft"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.YNd,Db.Direction=yc.sBa,Db.Duration=1600,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionConveyor",Ob))}if(!Array.contains(la,"rotate")){let Da,Ia;this.wc.$("TransitionRotate",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionRotate,
Ia.qc=od.Cc("TransitionRotateLeft"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.AL,Da.Direction=yc.l5f,Da.Duration=2E3,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionRotate",Ia.next="TransitionRotateFromRight",Ia));let Db,Ob;this.wc.$("TransitionRotateFromRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionFromRight,Ob.qc=od.Cc("TransitionRotateLeft"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.AL,Db.Direction=yc.l5f,Db.Duration=2E3,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionRotate",Ob.next="TransitionRotateFromBottom",
Ob));let sc,hc;this.wc.$("TransitionRotateFromBottom",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionFromBottom,hc.qc=od.Cc("TransitionRotateTop"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.AL,sc.Direction=yc.RUi,sc.Duration=2E3,sc.IsManualAdvance=!0,sc),hc.parent="TransitionRotate",hc.next="TransitionRotateFromLeft",hc));let Fc,Xc;this.wc.$("TransitionRotateFromLeft",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionFromLeft,Xc.qc=od.Cc("TransitionRotateRight"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.AL,Fc.Direction=
yc.ZUi,Fc.Duration=2E3,Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionRotate",Xc.next="TransitionRotateFromTop",Xc));let md,Nc;this.wc.$("TransitionRotateFromTop",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionFromTop,Nc.qc=od.Cc("TransitionRotateBottom"),Nc.nc=(md=new Ac,md.TransitionType=Oc.AL,md.Direction=yc.kVi,md.Duration=2E3,md.IsManualAdvance=!0,md),Nc.parent="TransitionRotate",Nc))}if(!Array.contains(la,"window")){let Da,Ia;this.wc.$("TransitionWindow",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionWindow,
Ia.qc=od.Cc("TransitionWindowVertical"),Ia.nc=(Da=new Ac,Da.TransitionType=Oc.window,Da.Direction=yc.W6a,Da.Duration=1500,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionWindow",Ia.next="TransitionWindowVertical",Ia));let Db,Ob;this.wc.$("TransitionWindowVertical",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionVertical,Ob.qc=od.Cc("TransitionWindowVertical"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.window,Db.Direction=yc.W6a,Db.Duration=1500,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionWindow",Ob.next=
"TransitionWindowHorizontal",Ob));let sc,hc;this.wc.$("TransitionWindowHorizontal",(hc=new Lc,hc.kc=ResourceStrings.L_TransitionHorizontal,hc.qc=od.Cc("TransitionWindowHorizontal"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.window,sc.Direction=yc.$Nc,sc.Duration=1500,sc.IsManualAdvance=!0,sc),hc.parent="TransitionWindow",hc))}if(!Array.contains(la,"orbit")){let Da,Ia;this.wc.$("TransitionOrbit",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionOrbit,Ia.qc=od.Cc("TransitionOrbitFromRight"),Ia.nc=(Da=new Ac,
Da.TransitionType=Oc.AL,Da.Direction=yc.k5f,Da.Duration=1600,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionOrbit",Ia.next="TransitionOrbitFromRight",Ia));let Db,Ob;this.wc.$("TransitionOrbitFromRight",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionFromRight,Ob.qc=od.Cc("TransitionOrbitFromRight"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.AL,Db.Direction=yc.k5f,Db.Duration=1600,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionOrbit",Ob.next="TransitionOrbitFromBottom",Ob));let sc,hc;this.wc.$("TransitionOrbitFromBottom",
(hc=new Lc,hc.kc=ResourceStrings.L_TransitionFromBottom,hc.qc=od.Cc("TransitionOrbitFromBottom"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.AL,sc.Direction=yc.QUi,sc.Duration=1600,sc.IsManualAdvance=!0,sc),hc.parent="TransitionOrbit",hc.next="TransitionOrbitFromLeft",hc));let Fc,Xc;this.wc.$("TransitionOrbitFromLeft",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionFromLeft,Xc.qc=od.Cc("TransitionOrbitFromLeft"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.AL,Fc.Direction=yc.YUi,Fc.Duration=1600,Fc.IsManualAdvance=
!0,Fc),Xc.parent="TransitionOrbit",Xc.next="TransitionOrbitFromTop",Xc));let md,Nc;this.wc.$("TransitionOrbitFromTop",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionFromTop,Nc.qc=od.Cc("TransitionOrbitFromTop"),Nc.nc=(md=new Ac,md.TransitionType=Oc.AL,md.Direction=yc.jVi,md.Duration=1600,md.IsManualAdvance=!0,md),Nc.parent="TransitionOrbit",Nc))}if(!Array.contains(la,"flythrough")){let Da,Ia;this.wc.$("TransitionFlyThrough",(Ia=new Lc,Ia.kc=ResourceStrings.L_TransitionFlyThrough,Ia.qc=od.Cc("TransitionFlyThroughIn"),
Ia.nc=(Da=new Ac,Da.TransitionType=Oc.wZb,Da.Direction=yc.W0b,Da.Duration=800,Da.IsManualAdvance=!0,Da),Ia.parent="TransitionFlyThrough",Ia.next="TransitionFlyThroughIn",Ia));let Db,Ob;this.wc.$("TransitionFlyThroughIn",(Ob=new Lc,Ob.kc=ResourceStrings.L_TransitionIn,Ob.qc=od.Cc("TransitionFlyThroughIn"),Ob.nc=(Db=new Ac,Db.TransitionType=Oc.wZb,Db.Direction=yc.W0b,Db.Duration=800,Db.IsManualAdvance=!0,Db),Ob.parent="TransitionFlyThrough",Ob.next="TransitionFlyThroughOut",Ob));let sc,hc;this.wc.$("TransitionFlyThroughOut",
(hc=new Lc,hc.kc=ResourceStrings.L_TransitionOut,hc.qc=od.Cc("TransitionFlyThroughOut"),hc.nc=(sc=new Ac,sc.TransitionType=Oc.wZb,sc.Direction=yc.i2d,sc.Duration=800,sc.IsManualAdvance=!0,sc),hc.parent="TransitionFlyThrough",hc.next="TransitionFlyThroughInWithBounce",hc));let Fc,Xc;this.wc.$("TransitionFlyThroughInWithBounce",(Xc=new Lc,Xc.kc=ResourceStrings.L_TransitionInWithBounce,Xc.qc=od.Cc("TransitionFlyThroughIn"),Xc.nc=(Fc=new Ac,Fc.TransitionType=Oc.wZb,Fc.Direction=yc.sTi,Fc.Duration=900,
Fc.IsManualAdvance=!0,Fc),Xc.parent="TransitionFlyThrough",Xc.next="TransitionFlyThroughOutWithBounce",Xc));let md,Nc;this.wc.$("TransitionFlyThroughOutWithBounce",(Nc=new Lc,Nc.kc=ResourceStrings.L_TransitionOutWithBounce,Nc.qc=od.Cc("TransitionFlyThroughOut"),Nc.nc=(md=new Ac,md.TransitionType=Oc.wZb,md.Direction=yc.tTi,md.Duration=900,md.IsManualAdvance=!0,md),Nc.parent="TransitionFlyThrough",Nc))}}this.wc.forEach((Da,Ia)=>{Da===Ia.parent&&++U;return!0})}uQa(z){let U=null;z?this.wc.forEach((la,
Da)=>{Da.nc&&Da.nc.TransitionType===z.TransitionType&&Da.nc.Direction===z.Direction&&(U=la);return!0}):U="TransitionNone";return U}EP(z){return this.wc.ga(z)}Nsb(z){return(z=this.uQa(z))?this.wc.ga(this.wc.ga(z).parent):null}vQa(z){return(z=this.uQa(z))?this.wc.ga(z).parent:null}Uag(z){let U,la=null;U=null;z&&z.next&&(U=z.next,la=this.EP(U));return{returnValue:la,key:U}}bsb(){var z=[od.vVi,od.cHk,od.dHk];for(const U of z)if(z=document.getElementById(U))return z;return null}aUc(z,U){return z&&U&&U.childNodes?
z.startsWith(od.wVi)?U.contains(document.getElementById(z)):!1:!U&&z?"TransitionExisting"===z||"TransitionNone"===z||"TransitionMorph"===z||"TransitionCut"===z||"TransitionFade"===z||"TransitionPush"===z||"TransitionWipe"===z:!1}static Cc(z){return kf.a.Aec+"_"+z+"_32x32x32"}}od.vVi="PptRibbon.Transition.Gallery-MaxSize-1-0";od.cHk="Transitions";od.dHk="Transitions-previewWrapper";od.wVi="Transition";Object(h.a)(od,"TransitionHelper",null,[733]);var di=d(241);class ij{constructor(){this.gh=this.K=
null}get name(){return"PowerPointWebEditor.Advanced"}Wb(z){this.K=z;this.gh=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").UBa(0,this.name);this.K.register(702,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").ma().na(()=>new ch(this.K.resolve("Common.IActionManagerExtended")));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").eP){const U=di.a(this.K);this.K.register(703,"PowerPointWebEditor.IAudioManagerStore").ma().na(()=>new Hc);this.K.register(704,"PowerPointWebEditor.IAudioLibraryCallbackFactory").ma().na(()=>
new Ea(this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").eP,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.La("PowerPointWebEditor.IAudioManagerStore")));this.K.register(705,"PowerPointWebEditor.IAudioManagerFactory").ma().na(()=>new fb(this.K.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),U,this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.resolve("PowerPointWebEditor.IAudioManagerFactory");this.K.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let z=this.gh.Zt("resolve");var U=this.K.resolve("Common.AFrameworkApplication");const la=this.K.resolve("PowerPointWebEditor.IApplicationContext"),Da=la.kd;U=U.$q;const Ia=this.K.resolve("Common.IActionManagerExtended"),Db=this.K.resolve("PowerPointWebEditor.IFocusManager");U=U.Ed;const Ob=this.K.resolve("Common.Transaction.ITransactionFactory"),
sc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),hc=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Fc=this.K.resolve("PowerPointWebEditor.PictureContext"),Xc=this.K.resolve("PowerPoint.IPathManager");var md=this.K.resolve("PowerPointWebEditor.IPresentationReader");const Nc=this.K.resolve("PowerPointWebEditor.IShapeReader"),bf=this.K.resolve("PowerPointWebEditor.IPictureUploader"),pe=this.K.Be("PowerPointWebEditor.IPPTLanguageDialogFactory"),wf=this.K.resolve("Box4.IParagraphReader");
this.gh.gu(z);z=this.gh.Zt("regactors");md=[new Qe(Ia,sc,this.K.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),wf,this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),Nc,this.K.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),Jf.App.aJa.JEc(12),Da.telemetryForPptParagraphSettingEnabled),new ua(Ia,Db,hc,Ob,sc,Xc,U,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
md,new kd,Da.Iug,this.K.resolve("Common.IAppSettingsManager").ka("ChangingThemeSelectedSlidesEnabled")),new eb(Ia,U,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ob,sc,Db,new od(Da.mJa),hc,Da,Xc,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"))];Da.YMa?md.push(new Pf(Ia,sc,Db,Ob,new ta(Da.nId),hc,Nc,Xc)):md.push(new xd(Ia,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),sc,Db,Ob,new ta(Da.nId),hc,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
Nc,Xc));Da.powerPointFormatBackgroundEnabled&&md.push(new Bd(Ia,Db,hc,sc,Ob,U,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),bf,Fc,K.AFrameworkApplication.ZP,this.K.resolve("PowerPointWebEditor.IErrorHandler"),Da));for(const rf of md)rf.ub(),rf.we();this.gh.gu(z);K.AFrameworkApplication.fa.ff(()=>{z=this.gh.Zt("regfullactors");const rf=[],fi=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");fi.YRa=this.K.resolve("Common.IAppSettingsManager").ka("299");la.kd.NDb&&rf.push(new Qh(Ia,
pe,fi,this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.La("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.ILanguageReader"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Box4.IProofingManager"),sc));this.K.resolve("PowerPointWebEditor.IApplicationSettings").s2b&&rf.push(new Oe(Ia,
Db,sc,di.a(this.K)));for(const Fh of rf)Fh.ub(),Fh.we();fi.YRa&&(new Ki(Ia,this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),(Fh,Qf)=>new Ud(Fh,this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),Qf,this.K.resolve("Common.IFocusManager")),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),sc,this.K.resolve("Box4.ILanguageReader"),Nc)).ub();this.gh.gu(z)})}dispose(){}}Object(h.a)(ij,"AdvancedPackage",null,[2,3]);class rh{get container(){return Z.a.instance.resolve("PowerPointWebEditor.IRibbonPane").ya}}
Object(h.a)(rh,"PPTFloatPaneContainer",null,[591]);class Qg{constructor(z,U,la=null){this.Rbb=new Kb.a(0);this.uva=null;this.vva=this.uva=Jf.App.Im;this.Dhe=z;this.LQg=1E3*U;this.LGg=la||(()=>(new Date).getTime())}ubi(z){this.Dhe&&this.Rbb.add(z,(new Date).getTime())}MZf(z){this.Dhe&&(this.Rbb.remove(z),this.fnl(this.LGg()-this.LQg))}fnl(z){if(this.Rbb.count){var U=[];this.Rbb.forEach((la,Da)=>{Da<z&&U.push(la);return!0});for(const la of U)this.Rbb.remove(la)}}get $sg(){return this.vva<=this.uva}eqj(){if(!this.Dhe||
!this.Rbb.count)return!1;let z=!1;const U=this.LGg();this.Rbb.forEach((la,Da)=>U-Da<this.LQg?(z=!0,!1):!0);return z}}Object(h.a)(Qg,"PictureContext",null,[701]);var be=d(882),Oi=d(424);class Pi{constructor(){this.X$a=this.$le=this.HKg=this.IKg=!1;this.gh=this.G3=this.kzb=this.ZKg=this.K=null;this.n7b=[new ij];this.HW=[]}get name(){return"PowerPointWebEditor.Chronos"}Wb(z){this.K=z;this.G3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.gh=this.G3.UBa(0,this.name);for(let U=0;U<
this.n7b.length;++U)Array.add(this.HW,Fb.a(this.n7b[U],0));for(const U of this.HW)U.Wb(z);Pi.Wqi(z);this.K.register(Qg,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").ma().na(()=>new Qg(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingPromptUnsavedDialogForUploadingImageEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingUploadLargeImageTimeoutInSeconds))}sdc(z,U){z=bg.a.instance;for(let Da=0;Da<U.entries.length;Da++){var la=
U.entries[Da];la.url=E.a.removeParameter(la.url,K.AFrameworkApplication.RU);const Ia=E.a.bma(la.url);let Db=!1;if("about:blank"===la.url||Ia.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===Ia&&"2"===E.a.mS(la.url,"u")||this.X$a&&(Db=Ia.endsWith("PowerPoint.ashx"))&&la.url.endsWith("ib=1"))la.behavior=1;else{if(Db||Ia.endsWith("PowerPoint.ashx")||Ia.endsWith("GetUpdates")||Ia.endsWith("images.ashx")||Ia.endsWith("GetThumb"))la.behavior=2;if(!this.IKg&&Ia.endsWith("PowerPoint.ashx")&&"true"===E.a.mS(la.url,
si.a.ysk))la=la.bB,z.ic(Ye.a.GNd,parseInt(String(la.fetchStart))),z.ic(Ye.a.nti,parseInt(String(la.responseStart))),z.ic(Ye.a.fti,parseInt(String(la.responseEnd-la.responseStart))),this.IKg=!0;else if(!this.HKg&&Ia.endsWith("PowerPoint.ashx")&&"true"===E.a.mS(la.url,"dSlide")){this.HKg=!0;la=la.bB;z.ic("SlideImageFetchStart",parseInt(String(la.fetchStart)));z.ic("SlideImageResponseStart",parseInt(String(la.responseStart)));z.ic("SlideImageDownloadDuration",parseInt(String(la.responseEnd-la.responseStart)));
let Ob;({transferSize:Ob}=Pi.Wyh(la)).returnValue&&z.ic("SlideImageSize",Ob)}else if(!this.$le&&Ia.endsWith("images.ashx")&&"true"===E.a.mS(la.url,"minimalboot")&&E.a.mS(la.url,"index")===this.ZKg){this.$le=!0;la=la.bB;z.ic("MBootFetchStart",parseInt(String(la.fetchStart)));z.ic("MBootResponseStart",parseInt(String(la.responseStart)));z.ic("MBootDownload",parseInt(String(la.responseEnd-la.responseStart)));let Ob;({transferSize:Ob}=Pi.Wyh(la)).returnValue&&z.ic("MBootSize",Ob)}}}}j3k(){const z=window.self.FirstSlideRequestIndex;
void 0===z||null===z?this.$le=!0:this.ZKg=z.toString()}init(){Uc.a.J(512497358,809,50,"ChronosPackage::Init");const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),U=this.K.resolve("Common.ITaskManager");for(var la of this.HW)this.gh.Zt(la.name),la.init(),this.gh.gu(la.name);this.K.resolve("Common.IAppSettingsManager").ff(()=>{if(z.podsAnimationSuggestionEnabled){const Da=this.gh.Zt("animationpreview");this.Owj();this.gh.gu(Da)}});this.K.resolve("Common.IActionManagerExtended").Zla(this.K.resolve("PowerPointWebEditor.IPasteFloatieHelper"));
la=Z.a.instance.resolve("Box4.IProofingManager");if(null!==la){let Da=this.gh.Zt("proofingresume");la.resume();this.gh.gu(Da)}if(z.jsa||!z.fSa)la=this.gh.Zt("loaddelayedres"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").Ash(),this.gh.gu(la);this.j3k();this.X$a=z.podsUseRealtimeCoauthReplicationTimerForInbound;la=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");la.Wb(30,0);la.gCf(Object(v.a)(this,this.sdc,"onResourceTimingEntriesAvailable"));la.activate();z.RRa&&
(this.kzb=window.self.PerfMeterData,void 0!==this.kzb&&null!==this.kzb&&(U.Gb(new fd.a(3,2,6E4,Object(v.a)(this,this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),Uc.a.J(512497357,809,50,"CollectPerfMeterData task started"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler").tB(()=>{this.collectPerfMeterData(null)})));this.oTj(z)}oTj(z){Uc.a.J(512497356,809,50,"Start to download chronos1 js file");if(z.anc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Iha("pptedit.chronos1",
null,()=>d.e(2).then(d.bind(null,1200)));else{z=Ae.a.create("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1200)));const U=this.K.resolve("PowerPointWebEditor.ISessionState");z.HR(()=>{U&&U.w4("Chronos1DownloadFinished")});Ja.a.wx(z)}}collectPerfMeterData(){if(0<this.kzb.length){const z=[];for(const U of this.kzb)z.push({["Id"]:U.Id,["Value"]:U.Value.toFixed(2),["Start"]:U.Start.toFixed(2),["Duration"]:U.Duration.toFixed(2)});Uc.a.J(512497355,813,50,JSON.stringify(z));this.kzb.length=0}}dispose(){for(var z of this.HW)z.dispose();
z=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");z.deactivate(!0);z.Gch(Object(v.a)(this,this.sdc,"onResourceTimingEntriesAvailable"))}Owj(){const z=Ae.a.create("pptedit.animationpreview",null,()=>d.e(18).then(d.bind(null,1212)));try{Ja.a.wx(z)}catch(U){Uc.a.J(512497354,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",U.toString())}}static Wqi(z){z.register(591,"Common.IFloatPaneContainer").ma().na(()=>new rh)}static Wyh(z){z=
parseInt(String(be.a(z,"transferSize")));return{returnValue:!z.toString().startsWith("NaN"),transferSize:z}}static main(){K.AFrameworkApplication.Xg&&ia.a.$f?Uc.a.J(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(bg.a.instance.ic(Oi.a.VLd,(new Date).getTime()),va.a.instance.Ac(Fb.a(new Pi,0)))}}Object(h.a)(Pi,"ChronosPackage",null,[2,3]);class wk{constructor(z,U,la,Da,Ia,Db,Ob){this.ape=this.PSa=!1;this.ta=z;this.rc=U;this.Tw=la;this.jv=Da;this.vCg=Db;this.gf=Ia;
this.h8=this.ta.Ba;this.Hc=Ob}initialize(){this.Tw.xk(Object(v.a)(this,this.xh,"onPropertyChanged"));this.gf.Rmb(Object(v.a)(this,this.eva,"onRibbonTabSwitched"));this.jv.GY(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.jv.QSb(Object(v.a)(this,this.iWa,"onShapeViewElementAdded"));this.jv.u5h(Object(v.a)(this,this.$_g,"onShapesAllSelected"))}dispose(){this.Tw.Tm(Object(v.a)(this,this.xh,"onPropertyChanged"));this.gf.Rhc(Object(v.a)(this,this.eva,"onRibbonTabSwitched"));
this.jv.Nva(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.jv.Ecd(Object(v.a)(this,this.iWa,"onShapeViewElementAdded"));this.jv.BQk(Object(v.a)(this,this.$_g,"onShapesAllSelected"))}xh(z,U){U.property===Di.a.aKc&&this.PSa&&this.rc.Sg(U.node)===this.h8&&this.Tbd(this.PSa)}eva(z,U){if(this.PSa=!!U.jla&&0<=U.jla.indexOf("Animation"))this.ape=!0;this.Tbd(this.PSa)}iWa(z,U){(z=this.ta.Ba)&&z.VV&&z===this.h8&&(U=U.jx)&&U.shapeNode&&this.h8&&this.I8a(this.h8.Bb,U.shapeNode)&&
this.Tbd(this.PSa)}I8a(z,U){return z&&U?z.equals(U.slideId):!1}onActiveSlideDomReady(z,U){(z=Object(A.a)(123,U.Ba))&&this.h8&&this.h8.Bb!==z.Bb&&(this.h8=z,this.Tbd(this.PSa))}$_g(){this.BXa()}BXa(){if(this.PSa&&this.h8&&this.h8.MQa&&this.ape){var z=this.h8.om();if(z&&0<z.length)for(const U of z)U&&U.NCa()&&(z=this.vCg.xP(U))&&(z.$Ub(),z.BXa(!0))}}Tbd(z){if(this.ape&&this.h8&&this.h8.VV&&this.Hc.Jc&&this.Hc.Jc.iEf){var U=this.h8.om();if(U&&0<U.length)for(const la of U)la&&(U=this.vCg.xP(la))&&(U.visible=
z,U.ICe())}}}Object(h.a)(wk,"AnimationMarkerManager",null,[106]);var xk=d(77),Yl=d(59);class Af{constructor(z,U){this.height=z;this.top=U}}Object(h.a)(Af,"ParagraphProperties",null,[]);var Ff=d(47),pj=d(67),dl=d(140),Zl=d(173),Cj=d(202),Sm=d(190);class im{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc,md,Nc,bf){this.$Zc=this.Qoe=this.Fl=this.Ib=!1;this.gTa=this.P6b=-1;this.eLg=this.IG=!1;this.va=new xk.a;this.NLg=this.yd=1;this.SN=this.ON=this.ei=this.Ab=this.vb=null;this.ua=z;this.rc=U;this.zm=la;this.Vh=
Da;this.fC=Db;this.l9j=Ia;this.Sca=Ob.Jc?Ob.Jc.iEf:null;this.r8j=Ob.Jc?Ob.Jc.Ahd:null;this.$h=sc;this.gd=hc;this.Fa=Fc;this.yb=Xc;this.Nja=Nc;this.a0j=bf;this.Rj=md}dispose(){this.Fl||(this.Nja(),this.Fl=!0,this.Ib=!1,this.$Ub(),this.XCc(),this.$h&&this.ON&&(this.$h.xb(rb.a.Ns,this.ON.ya,Object(v.a)(this,this.$W,"onSelectionAreaHover")),this.$h.xb(rb.a.Zv,this.ON.ya,Object(v.a)(this,this.$W,"onSelectionAreaHover"))),this.ON=null,this.$h&&this.SN&&(this.$h.xb(rb.a.Ns,this.SN.ya,Object(v.a)(this,this.$W,
"onSelectionAreaHover")),this.$h.xb(rb.a.Zv,this.SN.ya,Object(v.a)(this,this.$W,"onSelectionAreaHover"))),this.Ab=this.ei=this.Sca=this.vb=this.SN=null)}get visible(){return this.Ib}set visible(z){this.Ib=z}get rC(){return this.Ab}get zq(){return this.ei}get oe(){return this.vb}$m(z){z&&this.Sca?(this.vb=new dl.a,this.vb.ot("AnimationMarkerView"),this.Sca.appendChild(this.vb.ya),this.Ab=new Sm.a,this.Ab.Qk(0),this.vb.appendChild(this.Ab.viewport),this.ei=new Zl.a,this.ei.Qk(1),this.ei.setVisibility(!1),
this.Ab.appendChild(this.ei),this.ON=new dl.a,this.ON.ot("ShapeAnimationMarkerContainer"),this.ON.ya.id=this.ua.id.toString(),this.ON.yh(20,this.vb.ya.clientHeight),this.ON.Qk(1),this.vb.appendChild(this.ON),this.SN=new dl.a,this.SN.ot("TextAnimationMarkerContainer"),this.SN.ya.id=this.ua.id.toString(),this.SN.yh(20,this.vb.ya.clientHeight),this.SN.Qk(1),this.vb.appendChild(this.SN),this.$h.ob(rb.a.Ns,this.ON.ya,Object(v.a)(this,this.$W,"onSelectionAreaHover")),this.$h.ob(rb.a.Zv,this.ON.ya,Object(v.a)(this,
this.$W,"onSelectionAreaHover")),this.$h.ob(rb.a.Ns,this.SN.ya,Object(v.a)(this,this.$W,"onSelectionAreaHover")),this.$h.ob(rb.a.Zv,this.SN.ya,Object(v.a)(this,this.$W,"onSelectionAreaHover")),this.setVisibility()):Uc.a.J(512496852,800,10,"AnimationMarkerView: {0} is null",z?"m_markerViewParentElement":"parent")}IP(z){let U=!1;z&&z.Fc.id.startsWith(kf.a.iAc)||z.Fc.id.startsWith("overlappedMarker")?(this.zlk(z),U=!0):(this.$Ub(),this.BXa(!0));return U}setSelection(z){if(z&&!this.$Zc||!z)this.BXa(z),
this.$Ub()}setVisibility(){let z=this.Ib&&!this.IG;this.ua&&this.ua.isHiddenShape&&(z=!1);this.vb&&this.vb.Qd(z);this.ON&&this.ON.Qd(z);this.SN&&this.SN.Qd(z)}BXa(z){if(this.U3b()){this.Qoe=z;z=[this.ON.ya.childNodes,this.SN.ya.childNodes];for(const U of z)for(z=0;U&&z<U.length;z++)this.Qih(U[z],this.Qoe)}}KXi(z){if(!z||!this.ua)return null;z=z.getAttribute("AnimProps");if(!z||!z.toString()||!z.toString().trim().length)return null;z=z.toString().split(" ");if(!z||4!==z.length)return null;const U=
[];for(const la of z){if(!la||!la.trim().length)return null;U.push(Number.parseInvariant(la.trim()))}return U}U3b(){const z=!!this.ua&&!!this.Sca&&!!this.ON&&!!this.SN;z||Uc.a.J(512496851,800,10,"AnimationMarkerView: the containers are not exist.");return z}XCc(){this.ZUb(!0);this.ZUb(!1)}ZUb(z){if(this.$h&&this.gd&&this.U3b()&&(z=z?this.SN.ya:this.ON.ya)&&z.childNodes&&0<z.childNodes.length){const U=z.childNodes;for(const la=0;la<U.length;)z.removeChild(U[la])}}cZh(){if(this.U3b()){var z=this.k6f(this.ua);
if(z&&z.length){var U=!1,la=!1,Da=[];for(const Ia of z)Ia.IsTextRangeType?la=!0:(U=!0,Da.push(Ia));this.eLg=U&&la;this.ild(!0);this.ild(!1);this.ZUb(!1);0<Da.length&&(Uc.a.J(512496850,800,50,"AnimationMarkerView: draw shape animation markers."),this.cYf(Da,this.Rj.KQ(this.ua.Fq.fc,this.yd),this.Rj.KQ(this.ua.Fq.Ub-this.ua.Fq.fc,this.yd),!1,-1)||Uc.a.J(512496849,800,10,"AnimationMarkerView: no shape marker is rendered"));la?this.eMi():this.ZUb(!0);if(!la&&-1!==this.gTa||-1!==this.gTa&&-1===this.gTa&&
!U)this.iMd(),this.BXa(!0)}else this.XCc()}}eMi(){const z=new fd.a(2,1,0,Object(v.a)(this,this.ensureTextIsRenderedAndDrawMarkers,"ensureTextIsRenderedAndDrawMarkers"),90,"26");this.yb.Gb(z)}ensureTextIsRenderedAndDrawMarkers(){this.Fl||(this.a0j(),this.iYf())}iYf(){this.ZUb(!0);if(this.mrj(this.ua)){var z=this.mcj();if(z&&z.length){var U;if(({top:U}=this.Pcj()).returnValue){var la=0;Uc.a.J(512496846,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let Ia=0;Ia<z.length;Ia++){var Da=
this.rc.Sg(this.ua);if(!Da)return;(Da=Da.EMc(this.ua,Ia))&&0<Da.length&&z[Ia]&&(la+=this.cYf(Da,z[Ia].top-U,z[Ia].height,!0,Ia))}la||Uc.a.J(512496845,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Uc.a.J(512496847,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Uc.a.J(512496848,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}mcj(){const z=[];var U=ci.GraphIterator.mb(this.ua);U=this.zm.J6(U,U.currentNode);for(var la;U.moveNext();)(la=
U.currentNode)&&this.Vh.Wd(la)&&la&&(la=la.oc(this.fC))&&la.htmlElement&&(la=this.hQa(la.htmlElement))&&la.height&&z.push(la);return z}Pcj(){return this.getClientRects(this.r8j)}getClientRects(z){let U,la;U=la=0;if(!z)return Uc.a.J(512496844,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:U,top:la};z=z.getClientRects();if(!z||!z.length||!z[0])return Uc.a.J(512496843,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:U,top:la};la=Math.round(z[0].top);
U=Math.round(z[0].left);return{returnValue:!0,left:U,top:la}}hQa(z){if(!z)return Uc.a.J(512496842,800,10,"AnimationMarkerView: paragraph is null"),null;z=z.querySelectorAll(".TextRun");if(!z||!z.length)return null;let U=0,la=0;let Da,Ia=!1;for(let Ob=0;Ob<z.length&&z[Ob];Ob++){var Db=z[Ob].getClientRects();({top:Db,bottom:Da}=this.SQi(Db)).returnValue&&(Ob?(U=U>Db?Db:U,la=la<Da?Da:la):(U=Db,la=Da),Ia=!0)}if(Ia)return new Af(la-U,U);Uc.a.J(512496841,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");
return null}SQi(z){let U,la;U=la=0;if(!z||!z.length||!z[0])return Uc.a.J(512496840,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:U,bottom:la};U=z[0].top;la=z[0].bottom;for(let Da=1;Da<z.length&&z[Da];Da++)U=z[Da].top>U?U:z[Da].top,la=z[Da].bottom<la?la:z[Da].bottom;return{returnValue:!0,top:U,bottom:la}}cYf(z,U,la,Da,Ia){if(!this.U3b()||!z||!z.length)return 0;const Db=Da?this.SN.ya:this.ON.ya;la=(la=Math.floor(this.Rj.qn(la)/21))?la:1;let Ob=0,sc=null,hc=new dl.a,
Fc=!1,Xc=!1;const md=Ia===this.gTa&&z.length<this.P6b+1;for(let bf=0;bf<z.length;bf++){const pe=z[bf],wf=new dl.a;wf.ya.id=kf.a.iAc+pe.BuildId;wf.yh(20,16);wf.Qk(1);if(pe.IsTrigger){var Nc=this.qBi();wf.ya.appendChild(Nc)}else wf.ya.innerText=pe.BuildId.toString();let rf=Nc=!1;bf<la?(Da&&(wf.ya.style.position=pj.a.absolute,wf.ya.style.top=Ff.a.Lc(this.Rj.qn(U)+21*Ob)),wf.ya.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",bf,Ia,pe.BuildId,pe.EffectId)),Xc=this.Qoe||md&&z.length-1===bf||this.$Zc&&
this.P6b===bf&&this.gTa===Ia,wf.ya.setAttribute(pj.a.WUb,Xc?"animMarkerSelected":"animMarkerUnselected"),Db.appendChild(wf.ya),Ob++):bf===la&&hc.ya?(Fc=Fc&&pe.EffectId===sc.EffectId,Nc=!0,rf=sc.IsTrigger):Fc=Fc&&pe.EffectId===sc.EffectId;Nc&&hc.ya.appendChild(this.wei(rf,Fc,Xc));hc=wf;sc=pe}this.QX();return Ob}wei(z,U,la){const Da=new dl.a;Da.ya.id="overlappedMarker";Da.ya.style.marginTop=z?"3px":"-13px";Da.ya.setAttribute(pj.a.WUb,"overlappedMarker "+(la?"animMarkerSelected":"animMarkerUnselected"));
U&&this.vfb(Da.ya,"SameEffectOverlapped",1);return Da.ya}QX(){this.l9j(this.vb.ya,!0)}k6f(z){if(!z)return null;const U=this.rc.Sg(z);return U?U.qQa(z):null}mrj(z){z=this.k6f(z);if(!z||!z.length)return!1;for(const U of z)if(U.IsTextRangeType)return!0;return!1}ild(z){if(this.U3b()){var U=z?this.ON.ya:this.SN.ya,la,Da;U&&({x:la,y:Da}=this.L6i(z)).returnValue&&(U.style.position=pj.a.absolute,U.style.left=Ff.a.Lc(la),U.style.zIndex="20000",z?U.style.top=Ff.a.Lc(Da):this.iYf())}}L6i(z){let U,la;U=la=0;
if(!this.ua)return{returnValue:!1,x:U,y:la};var Da=Object(A.a)(124,this.ua.oc(this.fC));if(!Da)return{returnValue:!1,x:U,y:la};Da=Da.As();if(!Da)return{returnValue:!1,x:U,y:la};U=z?Da.Zb-(this.eLg?61:35):Da.Zb-20-15;la=Da.fc;return{returnValue:!0,x:U,y:la}}zlk(z){if(this.va&&z&&this.Fa&&z.Fc){var U=z.Fc.id.startsWith("overlappedMarker")&&z.Fc.offsetParent?z.Fc.offsetParent:z.Fc;this.X0k(U);this.Dig(U)&&!this.pMj(U)&&this.iMd();this.BXa(!1);this.Qih(U,!0);this.va.raiseEvent("OnMarkerClick",z);this.Fa.Ad()}}$Ub(){this.$Zc=
!1;this.gTa=this.P6b=-1;this.iMd()}X0k(z){(z=this.KXi(z))?(this.$Zc=!0,this.P6b=z[0],this.gTa=z[1],this.ua.qea=this.P6b,this.ua.yma=this.gTa):Uc.a.J(512496839,800,10,"AnimationMarkerView: failed to parse the animation properties.")}iMd(){this.ua&&(this.ua.qea=-1,this.ua.yma=-1)}jm(){this.Ab&&(this.Jld(),this.Ab.jm())}Jld(){if(this.ua&&this.ei){var z=this.ua.Fq.points;z=im.UMa(z,this.cNc());this.ei.Qt(z)}}cNc(){let z=kf.a.Zic;this.ua.Qf||!this.ua.wDa&&!this.ua.al||(z+=6);return z}kq(){this.Ab&&this.NLg!==
this.yd&&this.ICe();return null}Uq(){}pv(){}Ej(z){this.NLg=this.yd;this.yd=z}setZIndex(z){this.Ab&&this.Ab.uC(z)}draw(){this.ICe()}ICe(){this.vb&&this.Sca&&this.Ib&&!this.IG&&this.cZh();this.setVisibility()}$W(z){if(!this.va||!z)return!1;this.va.raiseEvent("OnSelectionAreaHover",z);z.eventName===rb.a.Ns?this.vfb(z.Fc,"animMarkerHovered",1):z.eventName===rb.a.Zv&&this.vfb(z.Fc,"animMarkerHovered",2);return!0}Qih(z,U){z&&(U?(this.vfb(z,"animMarkerUnselected",2),this.vfb(z,"animMarkerSelected",1)):(this.vfb(z,
"animMarkerSelected",2),this.vfb(z,"animMarkerUnselected",1)))}vfb(z,U,la){const Da=this.Dig(z);switch(la){case 0:z.setAttribute(pj.a.WUb,U);Da&&z.lastChild.setAttribute(pj.a.WUb,U);break;case 1:Sys.UI.DomElement.addCssClass(z,U);Da&&Sys.UI.DomElement.addCssClass(z.lastChild,U);break;case 2:Sys.UI.DomElement.removeCssClass(z,U),Da&&Sys.UI.DomElement.removeCssClass(z.lastChild,U)}}Dig(z){return!!z&&!!z.lastChild&&!!z.lastChild.id&&"overlappedMarker"===z.lastChild.id}pMj(z){return!!z&&!!z.lastChild&&
!!z.lastChild.id&&0<=z.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}AF(z){(this.IG=z)?this.$Ub():(this.Ws(),this.BXa(!0));this.setVisibility()}XE(){return null}Ux(){}QD(){return[]}nz(){}XD(){}Ws(){!this.Fl&&this.Sca&&(this.ild(!0),this.ild(!1))}qBi(){const z=new Cj.a;z.yh(10,10);z.ya.setAttribute(pj.a.WUb,"pointer-events-none");z.mwa("0 0 2048 2048");const U=new Zl.a;U.a0("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");
U.BF("#E67E22");U.qv("#FFFF00");U.zr(5);z.appendChild(U);return z.ya}static UMa(z,U){return[new Yl.a(z[0]._x-U,z[0]._y-U),new Yl.a(z[1]._x+U,z[1]._y-U),new Yl.a(z[2]._x+U,z[2]._y+U),new Yl.a(z[3]._x-U,z[3]._y+U)]}}Object(h.a)(im,"AnimationMarkerView",null,[633,387,388,106]);var Tm=d(276);class jm{constructor(){this.K=null;this.Zxb=!1}get name(){return"PowerPointWebEditor.Animations"}Wb(z){this.K=z;if(this.Zxb=this.K.resolve("PowerPointWebEditor.IApplicationContext").kd.pptAnimationMarkersEnabled)this.K.register(336,
"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").ma().na(()=>new Tm.a((U,la)=>{let Da=null;const Ia=Object(A.a)(124,U.oc(this.K.resolve("Box4.IPageView").Ma));Ia&&!Ia.ll&&Ia.ya&&(Da=new im(U,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(v.a)(Ia,Ia.QX,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),K.AFrameworkApplication.ue,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),la,()=>{Ia.ZOa()}),Da.$m(Ia.ya),Da.setZIndex(4),Da.visible=!1,Ia.QX(Da.oe.ya,!0),Ia.zza(Da,4));return Da})),this.K.register(wk,"PowerPointWebEditor.Animations.AnimationMarkerManager").ma().na(()=>new wk(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),
this.K.resolve("Box4.Graph.IGraphInstance").Bd(8),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")))}init(){this.Zxb&&this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManager").initialize()}dispose(){this.Zxb&&
this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManager").dispose()}static main(){va.a.instance.Ac(Fb.a(new jm,0))}}Object(h.a)(jm,"PPTWebEditorAnimationsPackage",null,[2,3]);var jk=d(1005),de=d(122);class Kj{constructor(z,U,la,Da){this.ia=z;this.Fa=U;this.Aie=la;this.yc=Da}ub(){this.ia.xa(Sc.a.find,jd.a.view,Object(v.a)(this,this.findText,"findText"));this.ia.xa(Sc.a.find,jd.a.notes,Object(v.a)(this,this.findText,"findText"));this.ia.xa(Sc.a.find,jd.a.Lf,Object(v.a)(this,this.findText,
"findText"));this.ia.xa(oa.a.findInDocument,jd.a.view,Object(v.a)(this,this.findInDocument,"findInDocument"));Ed.a("EnableFindInReadOnlyMode")?this.ia.$d(Sc.a.find,0):this.ia.$d(Sc.a.find,4);this.ia.xa(Sc.a.A4,jd.a.view,Object(v.a)(this,this.A4,"replaceText"));this.ia.xa(Sc.a.A4,jd.a.notes,Object(v.a)(this,this.A4,"replaceText"));this.ia.xa(Sc.a.A4,jd.a.Lf,Object(v.a)(this,this.A4,"replaceText"));this.ia.$d(Sc.a.A4,4)}we(){const z=[this.Fa.Bc(de.a.$C),this.Fa.Bc(de.a.B1),this.Fa.Bc(hh.a.yg),this.Fa.Bc(hh.a.sP)];
for(const U of z)U.bindAction(Ua.KeyInputManager.Na(tg.a.sna,Ua.KeyInputManager.Fe),Sc.a.find),U.bindAction(Ua.KeyInputManager.Na(tg.a.bib,Ua.KeyInputManager.Fe),Sc.a.A4)}findText(z,U,la){return U.contextId!==jd.a.view&&U.contextId!==jd.a.notes&&U.contextId!==jd.a.Lf?2:1===la?this.yc.Nj()?32:8:2===la?(this.Aie.xsh(U),Uc.a.J(539773087,820,50,"FindTextDialog is initialized."),32):8}A4(z,U,la){return U.contextId!==jd.a.view&&U.contextId!==jd.a.notes&&U.contextId!==jd.a.Lf?2:1===la?this.yc.Nj()?32:8:
2===la?(this.Aie.Pgl(U),Uc.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}findInDocument(z,U,la,Da,Ia){if(U.contextId!==jd.a.view&&U.contextId!==jd.a.notes&&U.contextId!==jd.a.Lf)return 2;if(1===la)return 32;if(2===la){if(!Ia)return 8;z=Ia.CommandValueId||"";Uc.a.J(539773089,820,50,"Find. ActionData QueryLength: {0}",z.length);this.Aie.xgl(U,z);Uc.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(h.a)(Kj,"FindReplaceTextActor",null,
[244]);var qg=d(1192);class el extends qg.a{constructor(z,U,la){super(!1,!0);this.jge=!1;this.s2c=null;this.Nyb=!1;this.cFg=this.kGg=null;this.zie=!0;this.Jie=this.Kie=this.Iie=!1;this.Dka=null;this.N1c=!1;this.loe=!0;this.XOg=this.fJg=!1;this.pNg=this.rNg=null;this.VKg=0;this.Fa=z;this.k8=U;this.s9j="FindReplaceTextDialog";this.TZ=ResourceStrings.l_FindTextTitle;la&&(this.TZ=ResourceStrings.l_ReplaceTextTitle);this.Tke=la;this.EU=!1}O4(){this.pj(this.TZ,this.k8,this.g7());this.jge=!1}dispose(){super.dispose();
this.jge=!0}kGi(){this.Iie=this.zie=!1;this.p5(this.TZ,this.k8,this.g7())}gZf(z){z&&(this.Fa.Bf(Hd.AFrame.u9),this.Iie=!0);this.zie=!0;this.p5(this.TZ,this.k8,this.g7())}Q1b(){this.hide()}h1k(z){this.s2c=z.searchString;this.Nyb=z.matchCase;this.Dka=z.replaceString}ll(){return this.jge}UXa(z,U){this.cFg=z;this.VKg=U;this.XOg=0===U;this.p5(this.TZ,this.k8,this.g7())}pfd(z){this.kGg=z;this.p5(this.TZ,this.k8,this.g7())}Kfd(z){this.rNg=z;this.p5(this.TZ,this.k8,this.g7())}PIe(z){this.pNg=z;this.p5(this.TZ,
this.k8,this.g7())}get zXa(){return this.s2c}set zXa(z){this.s2c=z}get matchCase(){return this.Nyb}set matchCase(z){this.Nyb=z}get qEe(){return this.Dka}set qEe(z){this.Dka=z}lKi(z){z&&(this.Fa.Bf(Hd.AFrame.u9),this.Kie=!0);this.N1c=!0;this.p5(this.TZ,this.k8,this.g7())}tRd(){this.Kie=this.N1c=!1;this.p5(this.TZ,this.k8,this.g7())}kKi(z){z&&(this.Fa.Bf(Hd.AFrame.u9),this.Jie=!0);this.loe=!0;this.p5(this.TZ,this.k8,this.g7())}mGi(){this.Jie=this.loe=!1;this.p5(this.TZ,this.k8,this.g7())}Kil(){this.TZ=
ResourceStrings.l_ReplaceTextTitle;this.Tke=!0;Ed.a("EnableFindInReadOnlyMode")&&(this.N1c=!1);this.p5(this.TZ,this.k8,this.g7());this.Fa.Bf(Hd.AFrame.u9)}jKi(){this.fJg=!0;this.p5(this.TZ,this.k8,this.g7())}xYi(){return{["searchString"]:this.s2c,["findNextButtonAriaLabel"]:this.kGg,["errorMessage"]:this.cFg,["findNextButtonIsEnabled"]:this.zie,["focusFindNextButton"]:this.Iie,["focusDialog"]:Object(v.a)(this,this.vTi,"focusDialog"),["isReplaceActive"]:this.Tke,["replaceButtonIsEnabled"]:this.N1c,
["replaceAllButtonIsEnabled"]:this.loe,["showMessageAsError"]:this.XOg,["messageStatus"]:this.VKg,["focusReplaceButton"]:this.Kie,["focusReplaceAllButton"]:this.Jie,["replaceButtonAriaLabel"]:this.rNg,["replaceAllButtonAriaLabel"]:this.pNg,["readOnlyModeEnabled"]:Ed.a("EnableFindInReadOnlyMode")&&this.fJg}}g7(){return{["id"]:this.s9j,["bodyControls"]:this.xYi(),["isModal"]:!1}}vTi(){this.Fa.Bf(Hd.AFrame.u9)}}Object(h.a)(el,"ReactFindReplaceTextDialog",qg.a,[655]);class Cm{constructor(z){this.Fa=z}getInstance(z,
U){return new el(this.Fa.value,z,U)}}Object(h.a)(Cm,"FindReplaceTextDialogFactory",null,[601]);class qj{constructor(){this.d5=this.Pea=this.paragraphIndex=this.PQ=this.slideIndex=0}reset(){this.slideIndex=this.PQ=this.paragraphIndex=0;this.Pea=this.d5=-1}clone(){const z=new qj;z.slideIndex=this.slideIndex;z.PQ=this.PQ;z.paragraphIndex=this.paragraphIndex;z.Pea=this.Pea;z.d5=this.d5;return z}}Object(h.a)(qj,"TextPosition",null,[]);class ck{constructor(){this.xle=this.sXc=null;this.nO=new qj;this.Ql=
new qj;this.state=this.xIa=0;this.pob=this.JTd=!1;this.pattern=this.RWb=this.TWb=null;this.matchCase=!1;this.reset()}reset(){this.xIa=0;this.nO.reset();this.Ql.reset();this.state=0;this.pob=this.JTd=!1;this.xle=this.iOa=this.RWb=this.TWb=null}get iOa(){return this.sXc}set iOa(z){if(this.sXc=z)this.xle=this.sXc}get tRj(){return this.xle}}Object(h.a)(ck,"FindContext",null,[]);var Lk=d(50),Rg=d(90);class mg{constructor(){this.ShouldMatchCase=!1}}Object(h.a)(mg,"MatchTextInfo",null,[]);class Dj{constructor(){this.ActiveSlideSid=
this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=null}}Object(h.a)(Dj,"ReplaceAllTextInfo",null,[]);var kk=d(935),qn=d(157);class yk{constructor(){this.message=this.title=null;this.fjg=!1;this.FDb=null;this.kjg=!1;this.ved=null;this.zYk=this.dAk=0;this.AYk=this.eAk=null;this.OPe=0}}Object(h.a)(yk,"CalloutNotificationMessageAttributes",null,[]);var rn=d(316);class nl{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc,md,Nc,bf,pe,wf,rf,fi,Fh,Qf,Mh,kj,r){this.tFa=this.rm=this.xD=null;this.ud=
new ck;this.Dka=this.lF="";this.F9b=!1;this.Mzb=this.yab=0;this.Lzb=Date.now();this.M1c=-1;this.yie=0;this.v1c=-1;this.ia=z;this.e8b=U;this.Fa=la;this.xq=Da;this.yc=Ia;this.Ea=Db;this.Gl=Ob;this.Ata=sc;this.Qb=hc;this.yb=Fc;this.Yb=Xc;this.ta=md;this.Mb=Nc;this.Db=wf;this.gf=bf;this.qq=pe;this.iW=rf;this.QFa=fi;this.vKg=Fh;this.Vab=Qf;this.q6j=Mh;this.eQ=r;this.qNg=kj}xsh(z){this.xD=z;this.rm=this.vKg.value.getInstance(Object(v.a)(this,this.Z2f,"findReplaceTextDialogResultHandler"),!1);this.lF&&(this.rm.zXa=
this.lF,this.v1c=-1);this.rm.O4();Ed.a("EnableFindInReadOnlyMode")&&3!=this.ia.mode&&this.rm.jKi();this.$Ra()&&this.rRd()}xgl(z,U){this.$Ra()||(this.lF=U);this.xsh(z);this.$Ra()||(this.rm.zXa=this.lF,this.rm.O4(),this.JQe(U,!1))}Pgl(z){this.xD=z;this.rm=this.vKg.value.getInstance(Object(v.a)(this,this.Z2f,"findReplaceTextDialogResultHandler"),!0);this.lF&&(this.rm.zXa=this.lF);this.rm.O4();this.$Ra()&&this.rRd()}Z2f(z,U){if(U)switch(this.rm.h1k(U),z){case 1:this.gik();break;case 2:this.hik();break;
case 3:this.iik(this.rm.qEe);break;default:this.Lal(),this.clearSelection(),this.ud.reset(),this.rm.Q1b()}else Uc.a.J(512496416,820,10,"Got null control value for findreplace dialog")}tig(){return this.ud.TWb&&this.bFd!==this.ud.TWb.De}JQe(z,U){this.DWf();if(0===this.ud.state||3===this.ud.state||z!==this.lF||U!==this.F9b||Ed.a("FixFindFlowOnManualSlideChange")&&this.tig())this.Lvj(z,U),this.v1c=-1;this.ud.pob=!1;this.$6c()}get bFd(){return this.ta.Ba?this.ta.Ba.De:0}Lvj(z,U){const la=z===this.lF&&
3===this.ud.state&&(Ed.a("FixFindFlowOnManualSlideChange")?!this.tig():!0),Da=this.ud.nO.clone();this.ud.reset();this.lF=z;this.F9b=U;la?this.ud.nO=Da.clone():(this.ud.nO.slideIndex=this.bFd,this.l3i());this.ud.Ql=this.ud.nO.clone()}$6c(){this.RRi(this.lF,this.F9b)?4!==this.ud.state&&this.setSelection():(e.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.oYb())}RRi(z,U){var la=this.ta.presentation;if(!la)throw Error.argumentNull("Presentation is null");if(la=la.slides||[],la.length){this.ud.xIa=
la.length;const Da=la.length+this.ud.nO.slideIndex;for(;this.ud.Ql.slideIndex<=Da;){const Ia=this.ud.Ql.slideIndex%la.length,Db=this.TRi(la[Ia],z,U,this.ud.Ql.slideIndex===Da?this.ud.nO.PQ:nl.Are);if(Db&&(this.ud.TWb=this.yc.$k(Db.Bb)))return!0;if(7===this.ud.state)return this.ud.pob&&(Uc.a.J(512496414,820,50,"call into PerformBackendFind recursively."),this.ud.state=0),this.Huk(la[Ia]?la[Ia].Bb:null,z,U);if(3===this.ud.state)break;let Ob;(Ob=this.ud.Ql).slideIndex=Ob.slideIndex+1;this.ud.Ql.PQ=0}}else this.ud.state=
1;return!1}TRi(z,U,la,Da){if(!z)return null;var Ia=this.yc.$k(z.Bb),Db=this.Mb.Kc(Ia);Ia=Ia.rQa()||[];(Db=Db.zb(27))&&Ia.push(Db);if(!Ia.length)return this.ud.state=7,null;for(;this.ud.Ql.PQ<=Math.min(Ia.length-1,Da);){if(this.ud.RWb=this.SRi(Ia[this.ud.Ql.PQ],U,la,this.ud.Ql.PQ===Da?this.ud.nO.paragraphIndex:nl.Are))return z;let Ob;(Ob=this.ud.Ql).PQ=Ob.PQ+1;this.ud.Ql.paragraphIndex=0}return null}SRi(z,U,la,Da){if(!this.Gl.gDa(z)&&z.PB)return null;const Ia=Rg.a.createInstance(z);let Db=0;for(;Ia.moveNext()&&
this.ud.Ql.paragraphIndex<=Da;){const Ob=Ia.currentNode;if($f.ParagraphReader.Wd(Ob)&&Db++===this.ud.Ql.paragraphIndex){if(this.ud.iOa=this.PRi(Ob,U,la,this.ud.Ql.paragraphIndex===Da?this.ud.nO.Pea:nl.Are))return z;let sc;(sc=this.ud.Ql).paragraphIndex=sc.paragraphIndex+1;this.ud.Ql.Pea=this.ud.Ql.d5=-1}}return null}PRi(z,U,la,Da){if(!$f.ParagraphReader.Wd(z))return null;let Ia=z.Wrb();if(!Ia.length)return null;Ia=Ia.substring(0,Math.min(Ia.length,Da));return this.URi(Ia,Math.max(0,this.ud.Ql.d5),
U,la)?z:null}URi(z,U,la,Da){let Ia=z,Db=la;Da||(Ia=z.toLowerCase(),Db=la.toLowerCase());z=Ia.indexOf(Db,-1===U?0:U);if(-1!==z)return this.ud.Ql.Pea=z,this.ud.Ql.d5=z+Db.length,this.ud.state=2,this.ud.JTd=!0;this.ud.state=1;return!1}l3i(){var z=qn.b(this.xD);z=z?z.Eb:null;if(!z||!z.Oa)e.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(z.Oa.kb){var U=z.Oa.kb.Ua;if($f.ParagraphReader.Wd(U.node)){z=Object(A.a)(5,U.node);this.ud.nO.Pea=U.Qa;this.ud.nO.d5=U.Qa;const la=this.Ea.Cba(U.node);
la?(this.ud.nO.PQ=la.get_zIndex()-1,this.ud.nO.paragraphIndex=this.Abg(z)):this.Gl.ssb(U.node)&&(U=this.ta.Ba?this.ta.Ba.rQa():null,this.ud.nO.PQ=U?U.length:0,this.ud.nO.paragraphIndex=this.Abg(z))}else this.Ea.uDa(U.node)&&(this.ud.nO.PQ=U.node.get_zIndex()-1)}}Abg(z){z=this.Mb.Kc(z);if(!z.l5(la=>10===la.type||60===la.type||16===la.type))return 0;z.uc();const U=z.hq;z.uc();return Math.max(0,z.KPa(U))}mUg(){const z=this.ta.presentation;if(!z)throw Error.argumentNull("Presentation is null");return this.ud.nO.slideIndex||
this.ud.nO.PQ?this.ud.Ql.slideIndex<(z.slides||[]).length:!1}hgg(){const z=this.ta.presentation;if(!z)throw Error.argumentNull("Presentation is null");this.ud.Ql.slideIndex=z.slides?z.slides.length:0;this.ud.pob=!1;this.$6c()}CRc(){return this.rm.ll()}Ehk(z){if(!this.CRc()){Uc.a.J(512496409,820,50,"OnBackendFindSucceeded");var U=jg.a.empty;({slideId:U}=jg.a.eyh(z));(z=this.yc.xra(U))?(U=z.slideIndex,U>this.ud.nO.slideIndex&&U<this.ud.Ql.slideIndex?this.oYb():this.Yb.Ba!==z?(this.xq.GY(Object(v.a)(this,
this.VBb,"onActiveSlideDomChanged")),this.Yb.Ba=z):(this.ud.state=5,this.ud.pob=!0,this.ud.Ql.slideIndex=this.ud.Ql.slideIndex>U?U+this.ud.xIa:U,this.ud.Ql.PQ=0,this.ud.Ql.paragraphIndex=0,this.ud.Ql.Pea=-1,this.ud.Ql.d5=-1,this.$6c())):this.mUg()?this.hgg():this.oYb()}}VBb(){Uc.a.J(512496408,820,50,"OnActiveSlideDomChanged");this.xq.Nva(Object(v.a)(this,this.VBb,"onActiveSlideDomChanged"));this.CRc()||this.tFa||(this.tFa=new fd.a(3,1,0,Object(v.a)(this,this.Tve,"onPostActiveSlideDomChangedTask"),
90,"30"),this.yb.Gb(this.tFa))}Tve(){Uc.a.J(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.tFa=null;if(!this.CRc())if(4===this.ud.state){const z=this.bFd;this.ud.Ql.slideIndex=this.ud.Ql.slideIndex>z?z+this.ud.xIa:z;this.ud.state=5;this.ud.pob=!0;this.$6c()}else 2===this.ud.state?this.setSelection():this.oYb()}Dhk(){this.CRc()||(Uc.a.J(512496406,820,50,"OnBackendFindFailed"),this.mUg()?this.hgg():this.oYb())}Huk(z,U,la){Uc.a.J(512496405,820,50,"PerformBackendFind");this.e8b.findText(U,la,
z.toString(),Object(v.a)(this,this.Ehk,"onBackendFindSucceeded"),Object(v.a)(this,this.Dhk,"onBackendFindFailed"));this.ud.state=4;return!0}oYb(){this.ud.state=this.ud.JTd?3:1;Uc.a.J(512496404,820,50,"End of Find: {0}",this.ud.state);this.clearSelection();this.UXa(0,"")}getShapeType(z){return z.wy?ResourceStrings.L_TextBox:z.Pq?ResourceStrings.l_Chart:z.nd?ResourceStrings.L_Table:z.Qf?ResourceStrings.L_SmartArt:z.Lp?ResourceStrings.L_Media:z.qk?ResourceStrings.l_Picture:z.al?ResourceStrings.l_Placeholder:
ResourceStrings.l_ShapeObject}setSelection(){var z=this.ud.iOa,U=this.ud.TWb;if(this.Yb.Ba!==U)this.xq.GY(Object(v.a)(this,this.VBb,"onActiveSlideDomChanged")),this.Yb.Ba=U;else{z=Lk.SelectionFactory.P1(z,this.ud.Ql.Pea,this.ud.Ql.d5);if(this.Gl.gDa(this.ud.RWb))this.ia.Ka(Sc.a.hgb,2,new kk.a(!0)),this.Fa.Bf(de.a.B1),this.Ata.setSelection(z),this.UXa(this.ud.Ql.slideIndex%this.yc.Nj()+1,ResourceStrings.l_NotesPaneType);else{U=this.ud.RWb;const la=this.ud.RWb.Ag(this.Qb.Ma);if(la)if(la.Kp){let Da;
(Da=this.ud.Ql).PQ=Da.PQ+1;this.ud.Ql.paragraphIndex=0;this.ud.Ql.Pea=0;this.ud.Ql.d5=0;la.lhd()}else this.q6j&&U.Qf?(this.gf.i$g(new rn.a(U)),this.QFa.setSelection(z)):(this.Fa.Bf(hh.a.yg),this.Qb.setSelection(z));this.UXa(this.ud.Ql.slideIndex%this.yc.Nj()+1,this.getShapeType(U))}Uc.a.J(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",this.ud.Ql.slideIndex,this.ud.Ql.PQ,this.ud.Ql.paragraphIndex,this.ud.Ql.Pea,this.ud.Ql.d5);this.MSd()}}clearSelection(){var z=qn.b(this.xD);if(z=z?z.Eb:null){var U=
this.ud.tRj;U&&(U=Lk.SelectionFactory.Jg(U,0),z.setSelection(U))}else Uc.a.J(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}UXa(z,U){const la=new Sys.StringBuilder,Da=new Sys.StringBuilder;let Ia=!1;z!=this.v1c?(this.v1c=z,this.yie=1):this.yie++;switch(this.ud.state){case 1:Ia=!0;la.append(ResourceStrings.l_FindTextNotFound);break;case 3:la.append(ResourceStrings.l_FindTextFindOver);break;case 6:Ia=!0;la.append(ResourceStrings.l_FindTextFindAgain);
break;case 2:Da.append(String.format(ResourceStrings.l_FindTextMessageWithCount,this.yie,z,U));break;default:Uc.a.J(512496400,820,50,"Find Text: {0}",this.ud.state)}this.i3k(la.toString(),Ia,Da.toString());this.MSd()}Fol(z){z=this.TRk(z);32===z&&this.JQe(this.lF,this.F9b);16===z&&(this.rm.UXa(ResourceStrings.l_ReplaceTextErrorMessage,0),this.rm.tRd(),this.rm.gZf(!0))}TRk(z){return Md.a.kIc("SingleReplaceAction",Sc.a.A4,()=>{z||(z="",Uc.a.J(512496399,820,50,"Replacing with empty string"));var U=this.ud.iOa;
if(!U)return Uc.a.J(512496398,820,10,"ParagraphNode not set in findContext"),16;var la=this.ud.Ql.Pea;const Da=this.ud.Ql.d5;if(-1===la||-1===Da)return Uc.a.J(512496397,820,10,"Invalid start or end position of current text selection."),16;const Ia=this.qq.je(15);Ia.fd(U);this.iW.replaceTextRange(Eh.a.createTextRange(U,la,Da),z,!0,!1,Sc.a.A4);U=la+z.length;la=U!==this.ud.Ql.d5;this.ud.Ql.d5=U;Ia.dispose();la&&this.setSelection();return 32})}MSd(){this.rm.gZf(1===this.yab);this.lZf();this.rm.kKi(3===
this.yab)}lZf(){this.ud.iOa?this.rm.lKi(2===this.yab):this.rm.tRd()}DWf(){this.rm.kGi();this.rm.tRd();this.rm.mGi()}i3k(z,U,la){2===this.yab?(this.rm.Kfd(ResourceStrings.l_ReplaceTextReplaced+". "+la),this.rm.pfd("")):(this.rm.pfd(la),this.rm.Kfd(""));this.rm.PIe("");this.rm.UXa(z,U?0:1)}gik(){I.a.Va(this.rm.zXa)||Md.a.kIc("FindNext",Sc.a.find,()=>{Uc.a.J(512496396,820,50,"Find Text Started");this.yab=1;this.JQe(this.rm.zXa,this.rm.matchCase);return 32})}hik(){this.rm.Tke?(Uc.a.J(512496394,820,50,
"Replace Text Started"),this.yab=2,this.Fol(this.rm.qEe)):(this.rm.Kil(),Uc.a.J(512496395,820,50,"Find dialog switched to replace dialog"),Ed.a("EnableFindInReadOnlyMode")&&this.lZf())}iik(z){this.$Ra()?Uc.a.J(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.Mzb,Date.now()-this.Mzb):I.a.Va(this.rm.zXa)||(this.lF=this.rm.zXa,this.Dka=z?z:"",this.Mzb=Date.now(),this.yab=3,this.rRd(),this.QQi(this.ta.Ba,this.lF,this.Dka,this.F9b),0<this.qNg&&(this.M1c=window.setTimeout(()=>
{this.s_g()},this.qNg)),16===this.replaceAll()&&(this.Lzb=Date.now(),this.xNf(),this.s_g()))}replaceAll(){return Md.a.kIc("ReplaceAllAction",Sc.a.A4,()=>{Uc.a.J(512496392,820,50,"ReplaceAll Text Started");const z=this.ta.presentation;if(z){const U=this.Db.rd(15);try{U.jc(z),this.Vab.xk(Object(v.a)(this,this.Qcb,"onPresentationPropertyChange")),z.IEb=Object.assign(new Dj,{NewStr:this.Dka,OldStr:this.lF,ActiveSlideCid:this.ta.Ba.cid,ActiveSlideSid:this.ta.Ba.sid,MatchTxtInfo:Object.assign(new mg,{ShouldMatchCase:this.rm.matchCase})})}finally{U&&
U.dispose()}return 32}return 16})}QQi(z,U,la,Da){if(z){z=this.yc.$k(z.Bb);var Ia=this.Mb.Kc(z);z=z.rQa()||[];(Ia=Ia.zb(27))&&z.push(Ia);if(z.length)for(Ia=0;Ia<=z.length-1;)this.YRi(z[Ia],U,la,Da),Ia++}else Uc.a.J(512496391,820,50,"slide must not be null.")}YRi(z,U,la,Da){if(this.Gl.gDa(z)||!z.PB)for(z=Rg.a.createInstance(z);z.moveNext();){const Ia=z.currentNode;if(!$f.ParagraphReader.Wd(Ia))continue;let Db=null;(Db=this.QRi(Ia,U,Da))&&Db.characterData.replace(U,la)}}QRi(z,U,la){if(!$f.ParagraphReader.Wd(z))return Uc.a.J(512496390,
820,50,"node must be ParagraphNode"),null;const Da=z.Wrb();return Da.length?this.VRi(Da,U,la)?z:null:null}VRi(z,U,la){let Da=z,Ia=U;la||(Da=z.toLowerCase(),Ia=U.toLowerCase());return-1!==Da.indexOf(Ia,0)?!0:!1}Qcb(z,U){if(!this.$Ra())Uc.a.J(512496389,820,50,"ReplaceAll Not Iniitated");else if(U.property===Di.a.mEe){this.xNf();z=Object(A.a)(404,U.node);if(-1!==z.kma){var la=2;if(0===z.kma){U=ResourceStrings.l_FindTextNotFound;var Da=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;la=
0;var Ia=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===z.kma?(U=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,z.kma,this.lF,this.Dka),Da=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,z.kma,this.lF,this.Dka)):(U=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,z.kma,this.lF,this.Dka),Da=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,z.kma,this.lF,this.Dka)),Ia=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else Ia=
ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,U=Da=ResourceStrings.l_ReplaceAllErrorMessage,la=0,Uc.a.J(512496388,820,10,"Invalid ReplaceAllTextCount");this.Lzb=Date.now();Uc.a.J(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.Lzb-this.Mzb);this.fZf(U,la);this.Vab.Tm(Object(v.a)(this,this.Qcb,"onPresentationPropertyChange"));this.rm.ll()&&this.eLe(Ia,Da,10);z.kma=-16}}$Ra(){return this.Mzb>this.Lzb}rRd(){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,
this.lF);this.rm.UXa(z,3);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,this.lF);this.rm.PIe(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.lF);this.rm.Kfd(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_FindTextFindNext,this.lF);this.rm.pfd(z);this.DWf()}fZf(z,U){this.rm.UXa(z,U);this.rm.PIe(z);this.rm.Kfd("");
this.rm.pfd("");this.MSd()}Lal(){if(this.$Ra()){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,this.lF);this.eLe(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,z,1024)}}eLe(z,U,la){this.eQ?(this.eQ.xRd(),Uc.a.J(512496385,820,50,"Callout notification called for Replace All operation"),z=Object.assign(new yk,{title:z,message:U,OPe:la}),z=this.eQ.Mal(z),z.ERa&&Uc.a.J(512496384,820,10,"Error in callout notification: Error:{0}",z.message)):Uc.a.J(512496386,820,10,"Find Replace Text: m_calloutNotification adapter is null.")}s_g(){let z=
!1;this.$Ra()&&(z=!0,this.Lzb=Date.now());Uc.a.J(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",z,this.Lzb-this.Mzb);this.fZf(ResourceStrings.l_ReplaceAllErrorMessage,0);this.Vab.Tm(Object(v.a)(this,this.Qcb,"onPresentationPropertyChange"));this.rm.ll()&&this.eLe(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ResourceStrings.l_ReplaceAllErrorMessage,10);this.ta.presentation.kma=-16}xNf(){-1!==this.M1c&&(window.clearTimeout(this.M1c),
this.M1c=-1)}}nl.Are=1024;Object(h.a)(nl,"FindReplaceTextHandler",null,[602]);class lk{constructor(z){this.NKg=this.uPg=null;this.Nyb=!1;this.I3=z}findText(z,U,la,Da,Ia){this.NKg=z;this.Nyb=U;this.uPg=la;this.I3.OE(Da,Ia,null)}get Rgl(){return this.uPg}get matchCase(){return this.Nyb}get J4c(){return this.NKg}}Object(h.a)(lk,"FindTextManager",null,[600]);var Xi=d(377),Al=d(105);class Yi extends Al.a{constructor(){super();this.MatchText=null;this.MatchCase=!1;this.SlideID=null}Ik(){return 54}static uNd(z,
U,la){const Da=new Yi;Da.SlideID=la;Da.MatchText=z;Da.MatchCase=U;return Da}}Object(h.a)(Yi,"FindTextRequest",Al.a,[]);class mk extends Xi.a{constructor(z,U,la,Da){super();this.tEa=this.XFa=null;this.yN=this.d3=!1;this.h7b=null;this.Kd=la;this.cWc=!1;this.e8b=U;this.Xa=Da;this.vm=z;this.enabled=2;this.vm.register(this)}OE(z,U){this.cWc=!0;this.XFa=z;this.tEa=U;this.vm.T9()}forceOutbound(){}sia(){return this.cWc&&!this.d3}JP(){return!1}QQa(){return this.Md&&2===this.Md.status?!0:this.sia()}MEb(){if(1===
this._state)this.h7b=this.Xa.podSessionId,this.Md.bH=Yi.uNd(this.e8b.value.J4c,this.e8b.value.matchCase,this.e8b.value.Rgl),this.Md.status=1,this._state=3;else if(3===this._state&&this.Md&&2===this.Md.status){if(2!==this.Md.statusCode)this.XG();else{if(!this.Md.vr||1!==this.Md.vr.length){this.XG();return}const z=this.Md.vr[0];0===z.StatusCode?(this.F_(),this.XFa&&this.XFa(z.SlideID)):(this.XG(z),124===z.StatusCode&&this.Kd.Rr(z.ServerError,this.h7b))}this.h7b=null}}XG(z=null){this.cWc=!1;this._state=
1;Uc.a.J(21849603,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",z?z.StatusCode:-1,this.Md?Pc.a[this.Md.statusCode]:"NULL",this.Md?this.Md.qy:-1,this.yN,this.h7b||"NULL");this.yN=!0;this.tEa&&this.tEa(-1,-1)}F_(){this.cWc=!1;this._state=1;Uc.a.J(25012056,818,this.yN?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",this.yN,this.h7b||"NULL");this.yN=!1}dispose(){this.d3||(1===
this._state&&this.vm.unregister(this),this.d3=!0)}}Object(h.a)(mk,"FindTextReplicator",Xi.a,[106]);class km{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FindText"}Wb(z){this.K=z;this.K.register(600,"PowerPointWebEditor.IFindTextManager").ma().na(()=>new lk(new mk(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.K.Be("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"))));
this.K.register(601,"PowerPointWebEditor.IFindReplaceTextDialogFactory").ma().na(()=>new Cm(this.K.Be("PowerPointWebEditor.IFocusManager")));const U=new jk.a(this.K.resolve("Common.App.CalloutNotification.ICalloutNotification"),this.K.resolve("PowerPointWebEditor.IRibbonPane").ya);this.K.register(602,"PowerPointWebEditor.IFindReplaceTextHandler").ma().na(()=>new nl(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.Be("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
this.K.resolve("Common.IAppSettingsManager").Ec("ReplaceAllClientTimeoutMS",0),U))}init(){let z=new Kj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),this.K.resolve("PowerPointWebEditor.IPresentationReader"));z.ub();z.we()}dispose(){}static main(){va.a.instance.Ac(Fb.a(new km,0))}}Object(h.a)(km,"PPTWebEditorFindTextPackage",null,[2,3]);class zk{constructor(z){this.Ga=z}get tHd(){return"PowerPoint"}get KKf(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get AEj(){return this.Ga.powerPointEditorFirstRunExperienceDataStoreIsEnabled}get Ivb(){return this.Ga.powerPointEditorFirstRunExperienceUIIsEnabled}get Bxg(){return this.Ga.powerPointEditorFirstRunExperienceTestIsEnabled}get ZSi(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get RSg(){return 24}get ugh(){return 4E3}get Cic(){return this.Ga.roamingServiceHandlerWebServiceBase||
""}}Object(h.a)(zk,"FirstRunExperienceLauncherSettings",null,[634]);class ya{constructor(z){this.oGg=z}ubl(z){this.oGg&&this.oGg.mLe(z)}}Object(h.a)(ya,"FirstRunExperienceManager",null,[599]);class sn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}Wb(z){if(!z)throw Error.argumentNull("container");this.K=z;this.K.register(599,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").ma().na(()=>new ya(this.K.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.K.resolve("Common.IAppSettingsManager").ff(()=>
{this.mLe()})}dispose(){}mLe(){var z=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(!z)throw Error.argumentNull("appSettings");const U=this.K.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");U&&(z=new zk(z),U.ubl(z))}static main(){va.a.instance.Ac(new sn)}}Object(h.a)(sn,"PPTWebEditorFirstRunExperiencePackage",null,[2,3]);var Sj=d(176),Jl=d(384);class Se{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=
this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(h.a)(Se,"CatchUpConfiguration",null,[]);class Te{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=
null}}Object(h.a)(Te,"SharedControllerFactoryParameters",null,[]);const fc=(z,U)=>{if(!z)throw Error.create(String.format("Argument {0} is null.",U));},lm=z=>{if(!z.navigationId)return Uc.a.J(524895832,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const U=window.atob(z.navigationId);return U&&""!==U?{["NavigationId"]:U}:null}catch(U){return Uc.a.J(524145986,3012,10,"CreateNavigationData: decoding navigation id failed.",U),null}};class Mc{constructor(z){fc(z,"ActivityContentManager.IActionManagerExtended");
this.ia=z}doesContentExist(z){if(!z)return Uc.a.J(524895831,3012,10,"DoesContentExist: activity is null."),!1;switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return(z=lm(z))?32===this.ia.Ka(oa.a.fqb,2,z):!1;default:return!1}}}Object(h.a)(Mc,"ActivityContentManager",null,[595]);class uf{constructor(z){this.Ym=z}shouldShowEmptyExperienceButton(){return K.AFrameworkApplication.kUc()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.Ym.Ka(oa.a.iMe,
2,null)}onInviteOthersButtonClick(){this.Ym.Ka(oa.a.kBa,2,null)}}Object(h.a)(uf,"EmptyCatchUpBehaviorManager",null,[598]);class mm{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(h.a)(mm,"Person",null,[]);var Nf=d(636),Yg=d(237),Mk=d(166);class Fn extends Al.a{constructor(z){super();this.StartTime=null;this.StartTime=z}Ik(){return 93}}Object(h.a)(Fn,"GetFileRevisionHistoryRequest",Al.a,[]);class ba{constructor(z,U,la){this.ProviderId=
this.UserId=this.UserName=null;this.UserName=z;this.UserId=U;this.ProviderId=la}}Object(h.a)(ba,"Author",null,[]);const Bl=(z,U)=>z&&U?z.providerIdField===U.ProviderId?z.userIdField===U.UserId:z.userNameField===U.UserName:!1;var Kg=d(238);class Bf{constructor(z,U,la){this.RYc=this.E9a=null;this.ni=z;this.R9a=la;this.R9a.Q3h(Object(v.a)(this,this.pYg,"onFileRevisionHistoryReady"));U.ff(()=>{this.E9a=new ba(U.Ha("UserName"),U.Ha("387"),U.Ha("388"))})}dispose(){this.R9a.BPk(Object(v.a)(this,this.pYg,
"onFileRevisionHistoryReady"));this.E9a=null}S2i(z,U,la){z&&la&&(this.RYc=la,z=new Kg.a(new Fn(z),Da=>{this.hBg(Da,U);this.d8c(Da)},Da=>{this.hBg(Da,U);return this.Scb(Da)}),this.ni.Gb(z))}pYg(z,U){z=null;const la=[];I.a.Va(U.QIc)||(({QIc:U}=this.pql(U.QIc)).returnValue?Mk.b(U.fileRevisionEntriesField,Da=>this.IJj(Da.changesDataField),Da=>{la.push(Da.changesDataField)}):z="ErrorGetFileRevisionHistoryParseJsonException");this.Zue(la,z)}d8c(z){let U=null;z.ServerError&&0!==z.ServerError.Code?U=Yg.a[z.ServerError.Code]:
0!==z.StatusCode&&(U=Nf.a[z.StatusCode]);U&&this.Zue(null,U)}Scb(z){Uc.a.J(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+z.toString());this.Zue(null,"ErrorGetFileRevisionHistoryFailed");return!0}Zue(z,U){this.RYc&&(z=this.YWi(z),this.RYc(z,U),this.RYc=null)}pql(z){let U;U=null;try{U=Sys.Serialization.JavaScriptSerializer.deserialize(z)}catch(la){Uc.a.J(512262997,811,10,"TryParseFileRevisionList() - Exception: "+la)}return{returnValue:!!U,QIc:U}}IJj(z){return!Bl(z,this.E9a)}hBg(z,U){z.Qva&&
U.Km("GetAuthorNamesRequestInvokedTime",z.Qva);U.Wa("GetAuthorNamesRequestCorrelationId",z.Fh)}YWi(z){if(!z)return[];const U=Array(z.length);for(let Da=0;Da<z.length;Da++){var la=z[Da];la=Object.assign(new mm,{displayName:la.userNameField,id:la.userIdField,provider:la.providerIdField});U[Da]=la}return U}}Object(h.a)(Bf,"FileRevisionHistoryService",null,[641,106]);class Ej{constructor(z,U){fc(z,"FlyoutFocus.IF6Manager");fc(U,"FlyoutFocus.IFocusManagerHelper");this.fh=z;this.yD=U}initialize(){this.yD.v7(hh.a.Cob,
hh.a.gj,null,Object(v.a)(this,this.xTi,"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.fh.TJ(hh.a.Cob)}disableF6Focus(){this.fh.qo(hh.a.Cob)}xTi(){const z=document.getElementById("flyoutItem0");z&&(Uc.a.J(570730465,3012,50,"Focused on the catch-up flyout via ctrl+F6"),z.focus())}}Object(h.a)(Ej,"FlyoutFocus",null,[639]);class rj{constructor(z,U,la,Da){this.GWc=null;this.eDg=this.VGg=this.fyb=this.PZc=!1;fc(U,"FlyoutRibbonButton.IActionManagerExtended");fc(la,"FlyoutRibbonButton.IFocusManager");
fc(Da,"FlyoutRibbonButton.FloodgateEventLogger");this.Nb=z;this.ia=U;this.Fa=la;this.M0j=Da;this.O0j=new Date}initialize(){K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ed.a("DelayRegisterCatchUpActions")||this.ub()}registerButtonClickedEvent(z){this.GWc&&Uc.a.J(571532947,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.GWc=z.buttonClickedCallback}onFlyoutInitialized(){this.PZc&&Uc.a.J(571532948,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const z=(new Date).getTime()-this.O0j.getTime();Uc.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",z);this.PZc=!0;Xd.c(oa.a.nji,!0,Xd.e,0,0,z);K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ed.a("DelayRegisterCatchUpActions")&&this.ub();this.Nb&&this.Nb.updateCommandUI()}logFlightTriggers(){}onFlyoutVisibilityChanged(z){this.fyb!==z.flyoutIsVisible&&
(this.fyb=z.flyoutIsVisible,this.Nb&&this.Nb.updateCommandUI(!0),this.fyb&&this.eDg?this.Fa.Bf(hh.a.Cob):this.fyb||this.Fa.Bf(hh.a.gj),this.fyb||this.M0j.hVj())}ub(){this.ia.xa(oa.a.Dml,dc.a.frame,Object(v.a)(this,this.hpk,"onToggleCatchUpFlyout"));this.ia.pa(oa.a.CDk,dc.a.frame,Object(v.a)(this,this.Tmk,"onQueryToggleCatchUpFlyout"),96)}hpk(z,U,la){if(1===la)return this.PZc?(this.VGg||(this.VGg=!0,Uc.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.GWc)return 8;this.eDg=!0;this.GWc();
return 32}Tmk(z,U,la,Da,Ia){Ia[Hg.a.Visible]=!0;Ia[Hg.a.On]=this.fyb&&this.PZc;return 32}}Object(h.a)(rj,"FlyoutRibbonButton",null,[638]);const dk=z=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+z)};class Qi{constructor(z,U,la,Da,Ia,Db){fc(z,"PowerPointActivityNavigationManager.IActionManagerExtended");fc(U,"PowerPointActivityNavigationManager.IPresentationReader");fc(la,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");
fc(Da,"PowerPointActivityNavigationManager.IRibbonUser");fc(Db,"PowerPointActivityNavigationManager.IActivityContentManager");this.ia=z;this.yc=U;this.Ie=la;this.FD=Da;this.t7j=Ia;this.TYj=Db}navigateToActivity(z){if(z.fromSummaryString)return this.m2k(),this.Eij(),this.Bij(),this.Pal(),Promise.resolve(1);z=z.activity;if(!z)return Uc.a.J(524145984,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!z.navigationId)return Uc.a.J(524145985,3012,10,"NavigateToActivity: navigation id is null."),
Promise.resolve(4);if(!this.TYj.doesContentExist(z))return Promise.resolve(2);switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:z=lm(z);if(!z)return Promise.resolve(5);z=this.ia.Ka(oa.a.wVb,2,z);return Promise.resolve(32===z?1:6);default:return Promise.resolve(7)}}m2k(){const z=this.yc.An;z?z.gBa=!0:Uc.a.J(570831450,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}Eij(){this.FD.selectRibbonTabById(this.t7j)}Bij(){var z=this.yc.An;if(z&&z.slides){var U=
null;for(const la of z.slides)if(la&&(z=this.yc.$k(la.Bb))&&z.isUnread){U=z;break}U?(this.Ie.gIe(),this.Ie.wda(U.De)):Uc.a.J(570831452,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else Uc.a.J(570831451,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}Pal(){this.ia.Ka(Sc.a.aHb,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(h.a)(Qi,"PowerPointActivityNavigationManager",null,[596]);class sj{constructor(){this.collectionId=this.type=
this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(h.a)(sj,"ActivityFeedItem",null,[]);class Nk{constructor(){this.activityFeedItems=null}}Object(h.a)(Nk,"ActivityFeedPayload",null,[]);class Dm{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(h.a)(Dm,"ActivityRequestPayload",null,[]);var Kl=d(526);class tj{constructor(){this.activityFeedItemId=this.activityId=
null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(h.a)(tj,"Activity",null,[]);class Le{constructor(z,U,la,Da,Ia,Db,Ob,sc){this.hg=this.Ile=null;fc(z,"PowerPointActivityRequestManager.IJsonpHelperManager");fc(U,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");fc(la,"PowerPointActivityRequestManager.IFileRevisionHistoryService");fc(Da,"PowerPointActivityRequestManager.IAppSettingsManager");fc(Ia,
"PowerPointActivityRequestManager.IApplicationSettings");fc(Db,"PowerPointActivityRequestManager.IActionManagerExtended");fc(Ob,"PowerPointActivityRequestManager.ICatchUpRequestHandler");this.REa=z;this.F$j=U;this.G0j=la;this.$b=Da;this.ia=Db;this.OWc=Ob;this.uOg=sc}requestWYWAActivities(){return new Promise((z,U)=>{this.hg=Md.a.hm("ShowWYWACallout",2);this.F$j.bVk(la=>{la=this.lBk(la);Le.isExpectedError(la)?z(Le.RFc):la?(Uc.a.J(572111054,3012,10,"OnReadRoamingSucceeded() - Error: {0}",la),U(la)):
this.G0j.S2i(this.Ile,this.hg,(Da,Ia)=>{Ia&&(Uc.a.J(572111055,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",Ia),U(Ia));z(Le.Gti(Da))})},la=>{const Da=!!la.data&&Le.CFj(la.data.af);la=this.REa.bia(la);Uc.a.J(572111056,3012,Da?50:10,"OnReadRoamingFailed() - Error: {0}",la);Da?z(Le.RFc):U(la)})})}requestActivities(){return Promise.resolve(Le.RFc)}requestRelevantActivities(){return Promise.resolve(Le.RFc)}requestActivityFeed(){return this.OWc?Kl.b(this.OWc.getActivityFeed(this.uOg)).then(z=>
Object.assign(new Nk,{activityFeedItems:Le.Tnl(z)})):Promise.resolve(Object.assign(new Nk,{activityFeedItems:[]}))}updateActivityState(z){return this.OWc?Kl.b(this.OWc.Jsl(this.uOg,z.itemIds,z.activityStatesToSet||0,z.activityStatesToReset||0,z.resetUnseenCount)):Promise.resolve(!1)}lBk(z){z=z.data.Zd;if(!z)return"ErrorReadRoamingEmptyResponseBody";let U;try{U=JSON.parse(z)}catch(la){return la.toString()}z=null;if(!U.Error){if(!U.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");
z=U.Timestamp}this.Ile=this.Twl(z);Uc.a.J(561588038,3012,100,"Timestamp for retrieving activities: "+this.Ile);return U.Error}Twl(z){const U={};var la=this.$b.Ec("AppWaterlineOverrideTimestampValue",0);return la?(z=new Date(1E3*la),U.timestamp=z,this.ia.Ka(Sc.a.SLe,2,U),z.format("yyyy-MM-ddTHH:mm:ssZ")):z?(la=this.$b.Ec("AppWaterlineOverrideDaysValue",0))?(z=new Date(+new Date(z)-+new Date(864E5*la)),U.timestamp=z,this.ia.Ka(Sc.a.SLe,2,U),z.format("yyyy-MM-ddTHH:mm:ssZ")):z:null}static Gti(z){return z?
Object.assign(new Dm,{actors:z}):null}static Tnl(z){const U=[];if(!z)return U;for(const la of z)U.push(Object.assign(new sj,{id:la.id,type:la.type,collectionId:la.collectionId,activityState:la.activityState,activityFeedItemPayload:la.activityFeedItemPayload,timestamp:la.timestamp}));return U}static isExpectedError(z){return"ErrorDocNotInRoamingList"===z||"ErrorLastViewedDocListIsEmpty"===z}static CFj(z){return 403===z}}Le.RFc=Object.assign(new Dm,{activities:[],actors:[],hasMore:!1,highWaterline:"",
lowWaterline:"",wywaWaterline:""});Object.assign(new Dm,{activities:[Object.assign(new tj,{activityId:"activityId1",type:3,actors:[Object.assign(new mm,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new tj,{activityId:"activityId2",type:4,actors:[Object.assign(new mm,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,
relevancy:2,navigationId:"navigationId2"})]});Object.assign(new Nk,{activityFeedItems:[Object.assign(new sj,{id:"FeedItemId1",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new sj,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(h.a)(Le,"PowerPointActivityRequestManager",null,[597]);var $l=d(257);class Ke{constructor(z,U,la,Da,Ia,Db){this.T$a=!1;this.pKg=null;this.Mc=z;this.Uv=U;this.y7j=la;this.REa=Da;this.yb=Ia;this.cAb=Db}initialize(){this.Mc&&(this.Mc.SMa(Object(v.a)(this,this.YBb,"onBeforeSessionEnd")),this.Mc.tB(Object(v.a)(this,this.uL,"onSessionClosed")));this.bYk()}bVk(z,U){const la=this.Ecg("getPPTDocLastViewedTimestamp");this.gx(la,1,z,U)}YBb(){this.tEh()}uL(){this.T$a=
!0}bYk(){if(this.yb){var z=new fd.a(3,2,3E4,Object(v.a)(this,this.bTk,"requestWriteWaterline"),90,"29");this.yb.Gb(z)}}bTk(){!this.T$a&&3E4<+Md.a.w5b-+this.pKg&&(this.tEh(),this.pKg=Md.a.w5b)}tEh(){const z=this.Ecg("savePPTDocLastViewedTimestamp");this.cAb.ka("SendBeaconOnRoamingRequestsIsEnabled")?this.Uv.SHa(z,""):this.gx(z,2,Object(v.a)(this,this.Rpk,"onWriteWaterlineSucceeded"),Object(v.a)(this,this.Qpk,"onWriteWaterlineFailed"))}Rpk(z){let U=null;try{const la=z.data.Zd;U=la?JSON.parse(la).Error:
"ErrorWriteRoamingEmptyResponseBody"}catch(la){U="ErrorWriteRoamingParseJsonResponseException",Uc.a.J(572555921,3012,10,"OnWriteRoamingSucceeded() - Exception: "+la)}finally{U&&this.wBg(U)}Uc.a.J(572555922,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.Iu-+z.data.NH,+z.data.zt-+z.data.NH)}Qpk(z){this.wBg("ErrorReadRoamingFailed");Uc.a.J(572555923,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.REa.bia(z))}Ecg(z){return this.y7j+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
z,K.AFrameworkApplication.Zg)}gx(z,U,la,Da){const Ia={};Ia["X-StatelessPopsAffinityRoutingEnabled"]=this.cAb.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Uv.vj(z,U,null,Ia,!1,1,la,Da,null,void 0,void 0,void 0,void 0,$l.a("5"))}wBg(z){Uc.a.J(572555924,811,50,z)}}Object(h.a)(Ke,"PowerPointWaterlineUpdater",null,[]);class ee{get name(){return"PowerPointWebEditor.Activity"}get k7d(){return K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(v.a)(this,this.YDi,"delayedInit"))}Wb(z){this.K=z}dispose(){this.K=this.NWc=null}P8k(z){return!z||z.ka("IsAnonymousUser")?!1:z.ka("PPTCatchUpFlyoutIsEnabled")}YDi(){const z=this.K.resolve("Common.IAppSettingsManager");this.P8k(z)&&(dk("Begin"),this.mIi(),this.OVj())}mIi(){Sj.a.get_instance().Xj(7,()=>{dk("ScriptDownload");di.a(this.K)("catchUpActivity").catch(()=>{Uc.a.J(512262995,3012,10,"Failed to download catch-up script")}).then(()=>
this.Avj()).catch(()=>{Uc.a.J(512262994,3012,10,"Failed to initialize shared catch-up code")})})}OVj(){Uc.a.J(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.k7d&&Uc.a.J(526718752,3012,50,"ActivityFeedData is enabled")}Avj(){const z=new Bf(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),U=this.K.resolve("Common.AFrameworkApplication");this.K.register(Ke,
"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").ma().na(()=>new Ke(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),K.AFrameworkApplication.He,this.K.resolve("PowerPointWebEditor.IApplicationSettings").roamingServiceHandlerWebServiceBase,this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(595,"Common.App.CatchUpActivity.IActivityContentManager").ma().na(()=>new Mc(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(596,"Common.App.CatchUpActivity.IActivityNavigationManager").ma().na(()=>new Qi(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),kf.a.sHk,this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let la=null;this.K.resolve("PowerPointWebEditor.IApplicationSettings").vg&&
(la=this.K.resolve("Common.IAppSettingsManager").Ha("368")+"p");this.K.register(597,"Common.App.CatchUpActivity.IActivityRequestManager").ma().na(()=>new Le(this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),z,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),
la));this.K.register(rj,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ma().na(()=>new rj(U.$q,K.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.K.register(Ej,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").ma().na(()=>new Ej(this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));
this.K.register(598,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ma().na(()=>new uf(this.K.resolve("Common.IActionManagerExtended")));this.NWc=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new Te,{activityContentManager:this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.K.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.K.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),
dataCulture:K.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.k7d?this.K.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.K.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.K.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),uiCulture:K.AFrameworkApplication.uiCulture,ulsLogger:new Jl.a}));if(!this.NWc)return Promise.reject("Failure to create CatchUpApp");this.K.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();
this.K.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.NWc.setWebpackPublicPath(K.AFrameworkApplication.Hea);dk("InitializeCatchUpApp");return this.NWc.initialize(Object.assign(new Se,{activityFeedDataEnabled:this.k7d,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>{this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){va.a.instance.Ac(Fb.a(new ee,0))}}Object(h.a)(ee,"PPTWebEditorActivityPackage",null,[2,3]);
var Ne=d(715);class O extends Sys.EventArgs{constructor(z,U){super();this.shape=z;this.gBa=U}}Object(h.a)(O,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);var ca=d(205);class Ta{constructor(z,U,la,Da,Ia,Db,Ob){this.hg=null;this.ia=z;this.ta=U;this.Uzb=la;this.e2c=Da;this.Sb=Ia;this.Qc=Db;this.ebb=Ob}dispose(){this.hg&&(this.hg=null)}we(){}ub(){this.ia.xa(Sc.a.CRg,xf.a.application,Object(v.a)(this,this.imj,"handleMarkAsRead"));this.ia.xa(Sc.a.aHb,xf.a.application,Object(v.a)(this,this.Yoj,"handleShowHideChanges"));
this.ia.pa(Sc.a.D8g,jd.a.application,Object(v.a)(this,this.Inj,"handleQueryShowHideChanges"),96);this.ia.pa(Sc.a.SLe,xf.a.application,Object(v.a)(this,this.Zoj,"handleShowRevisionTrackingWithUrlOverrides"),96)}imj(z,U,la,Da,Ia){if(1===la)return this.Sb.Nj()?32:8;z=new Date;if(!Ia)throw Error.argumentNull("actionData is null");if(Ia.SlideNode){if(Ia=Object(A.a)(123,Ia.SlideNode))Uc.a.J(590448578,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",Ia.slideIndex+1)),Ia.FZ=z,this.Uzb.NCe(Ia)}else this.Aak(z);
return 32}Aak(z){const U=this.ta.presentation;if(!U)throw Error.argumentNull("Presentation is null");this.hg=Md.a.hm("MarkActivitiesAsRead",1);Uc.a.J(38012997,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");Mk.b(U.slides||[],null,la=>{if(la=Object(A.a)(123,la))la.FZ=z});this.Uzb.Hah()}Yoj(z,U,la,Da,Ia){if(1===la)return this.Sb.Nj()?32:8;const Db=this.Sb.An;z=this.ta.Ba;if(!(Db&&z&&z.isConnected&&Ia))return 16;la=U=!1;switch(Ia.ShowRevisionTrackingStatus){case 0:la=U=!1;
break;case 2:U=!0;la=!1;break;case 3:la=U=!0;break;case 1:U=Db.gBa&&!this.Uzb.mMd?!0:!Db.gBa;la=!0;break;default:return 8}if(this.Uzb.mMd&&!la)return 32;Ia=Ia.InvokeSource;Db.gBa=U;this.Uzb.mMd=U&&la;la&&this.ebb.rXj(Ia,U);Ia=z.om();Mk.b(Ia,null,Ob=>{this.e2c.pGk(new O(Ob,Db.gBa))});this.Qc.RD(new ca.a(1));return 32}Inj(z,U,la,Da,Ia){z=this.Sb.An;if(!z)return 16;Ia.Kf(z.gBa);return 32}Zoj(z,U,la,Da,Ia){z=this.ta.presentation;if(!Ia||!z||!z.slides)return 8;Ia=Ia.timestamp;if(!Ia)return 8;for(const Db of z.slides)Object(A.a)(123,
Db).FZ=Ia;this.Uzb.OCe(z.slides);return 32}}Object(h.a)(Ta,"RevisionTrackingActor",null,[244,106]);class xb{constructor(z){this.backgroundColor=this.foregroundColor=null;K.AFrameworkApplication.fa.ka("1166")?z&&z.isInHighContrastMode&&z.highContrastColors?(this.foregroundColor=z.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=z.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=this.foregroundColor="#006BFF":z&&z.isInHighContrastMode&&z.highContrastColors?(this.foregroundColor=
z.highContrastColors.foregroundTextColor||"#00828C",this.backgroundColor=z.highContrastColors.backgroundColor||"#00828C"):this.backgroundColor=this.foregroundColor="#00828C"}}Object(h.a)(xb,"RevisionTrackingColorProvider",null,[]);class Tb{constructor(){this.va=new xk.a}tGk(z){this.va.raiseEvent("SlideUSC",z)}jDf(z){this.va.addHandler("SlideUSC",z)}Ddh(z){this.va.removeHandler("SlideUSC",z)}WFk(z){this.va.raiseEvent("ShapeUSC",z)}m5h(z){this.va.addHandler("ShapeUSC",z)}vQk(z){this.va.removeHandler("ShapeUSC",
z)}pGk(z){this.va.raiseEvent("ShowHideSC",z)}x5h(z){this.va.addHandler("ShowHideSC",z)}CQk(z){this.va.removeHandler("ShowHideSC",z)}}Object(h.a)(Tb,"RevisionTrackingEventSource",null,[698,699,700]);class wc extends Sys.EventArgs{constructor(z,U){super();this.shape=z;this.slide=U}}Object(h.a)(wc,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class sd{constructor(){this.cid=this.sid=0}}Object(h.a)(sd,"Slide",null,[]);class $b{constructor(z,U){this.dt=this.mk=null;this.mk=Object.assign(new sd,
{sid:z.sid,cid:z.cid});this.dt=U}}Object(h.a)($b,"SlideLastViewedVersion",null,[]);class ge{constructor(){this.v=0;this.lv=this.defLv=null;this.v=1}}Object(h.a)(ge,"SlideLastViewedVersions",null,[]);class we extends Sys.EventArgs{constructor(z){super();this.slide=z}}Object(h.a)(we,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class oe{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc,md,Nc,bf,pe){this.Zwb=this.E9a=null;this.nGg=!1;this.Bje=null;this.H_c=0;this.Fyb=this.q9b=null;this.one=[];this.y1c=
null;this.A2c=!1;this.Ava=null;this.mMd=!1;Uc.a.J(512262749,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");this.Coe=z;this.ta=U;this.yb=la;this.rc=Da;this.Sb=Ia;this.od=Db;this.ibc=Ob;this.Mc=sc;this.Bk=hc;this.e2c=Xc;this.EOg=Fc;this.$b=Nc;this.J$j=md.pptEditingRevisionTrackingWriteRoamingCacheIntervalMs;this.pJg=md.ZLj;this.SOg=!0;this.PG=!1;this.CFa=new Kb.a;this.Mc.Pzc(Object(v.a)(this,this.Dla,"onSessionAccessTokenExpired"));K.AFrameworkApplication.zz&&this.Mc.Szc(Object(v.a)(this,
this.Mda,"onWopiTokenRefreshed"));this.$b.ff(()=>{this.initialize();this.Hah()});this.ebb=bf;this.Qb=pe}dispose(){this.E9a&&(this.od.Nva(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.od.Ecd(Object(v.a)(this,this.iWa,"onShapeViewElementAdded")),this.ibc.IDe(Object(v.a)(this,this.Mcb,"onMarkedUndo")),this.Mc.VDe(Object(v.a)(this,this.YBb,"onBeforeSessionEnd")),this.Mc.gea(Object(v.a)(this,this.uL,"onSessionClosed")),this.Mc.hea(Object(v.a)(this,this.jo,"onSessionRehydrated")),
this.Bk.GQk(Object(v.a)(this,this.g0g,"onSlideChangesDataChanged")),this.Bk.mQk(Object(v.a)(this,this.g_g,"onPresentationLastModifiedTimeReceived")),this.pJg&&this.EOg.Tm(Object(v.a)(this,this.T_g,"onShapePropertyChanged")),this.Mc.tdh(Object(v.a)(this,this.Dla,"onSessionAccessTokenExpired")))}initialize(){Uc.a.J(512262748,804,50,"Start RevisionTrackingManager::Initialize()");this.Bje=new Date;this.H_c=this.Bje.getTime();this.x0k();this.od.GY(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));
this.od.QSb(Object(v.a)(this,this.iWa,"onShapeViewElementAdded"));this.ibc.NSb(Object(v.a)(this,this.Mcb,"onMarkedUndo"));this.Mc.SMa(Object(v.a)(this,this.YBb,"onBeforeSessionEnd"));this.Mc.tB(Object(v.a)(this,this.uL,"onSessionClosed"));this.Mc.uB(Object(v.a)(this,this.jo,"onSessionRehydrated"));this.Bk.D5h(Object(v.a)(this,this.g0g,"onSlideChangesDataChanged"));this.Bk.U4h(Object(v.a)(this,this.g_g,"onPresentationLastModifiedTimeReceived"));this.pJg&&this.EOg.xk(Object(v.a)(this,this.T_g,"onShapePropertyChanged"));
this.Ava=this.ta.Ba;this.Zwb=this.Z0i();this.getSlideLastViewedVersions();const z=new fd.a(3,2,this.J$j,()=>{this.getSlideLastViewedVersions()},90,"12");this.yb.Gb(z)}onActiveSlideDomReady(z,U){z=Object(A.a)(123,U.Ba);this.Ava&&z!==this.Ava&&this.uKe()&&(this.Ava.isConnected&&(this.Ava.isUnread&&this.RRg(this.Ava),this.Ava.changesData&&(this.Ava.FZ=this.Ava.changesData.dtField)),z&&z.isUnread&&this.Sah(z));this.Ava=z;this.H_c=Date.now()}Mcb(z,U){U.actionId!==ld.a.jRa&&U.Lub&&(z=this.ta.Ba)&&z.isConnected&&
z.isUnread&&this.uKe()&&this.RRg(z)}YBb(){this.uKe()&&this.Isl();this.wEh()}uL(){this.ebb.log();this.PG=!0}jo(){this.PG=!1;this.q9b&&this.qAh(this.q9b)}qAh(z){var U=this.ta.presentation;if(!U)throw Error.argumentNull("Presentation is null");U=U.slides||[];0<U.length&&(this.owl(U,z),this.OCe(U))}Zmk(z){Uc.a.J(512262747,804,50,"OnReceiveLastViewedVersionInfo()");z&&(this.CFa=new Kb.a,this.forEach(z.lv,Da=>{const Ia=Da.mk.sid;(!this.CFa.Jb(Ia)||this.CFa.ga(Ia).dt<Da.dt)&&this.CFa.$(Ia,Da)}));const U=
Md.a.w5b;let la=!1;this.Fyb&&this.Coe.rQj&&U!==this.Fyb&&(this.q9b&&M.c(this.P5f())===M.c(this.q9b)||(la=!0));z&&z.defLv&&(this.Zwb=z.defLv,this.SOg=!1,z.lv&&0<z.lv.length&&this.qAh(z));la&&this.wEh();this.Fyb=Md.a.w5b}g0g(z,U){this.forEach(U.slides,la=>{this.G7d(la.changesData)||(this.ta.Ba&&la.Bb!==this.ta.Ba.Bb||this.rrj(Object(A.a)(123,la)))&&this.NCe(Object(A.a)(123,la))})}g_g(z,U){this.SOg&&(this.Zwb=U.Kzk)}T_g(z,U){z=U.property;U=Object(A.a)(4,U.node);z===Di.a.xic&&(z=this.rc.Sg(U),z===this.ta.Ba&&
z.isUnread&&U.changesData.dtField<=z.changesData.dtField&&(Uc.a.J(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.H_c),this.MCe(this.ta.Ba,U)))}iWa(z,U){z=U.jx.shapeNode;this.ta.Ba.isUnread&&this.I8a(this.ta.Ba.Bb,z)&&!this.G7d(z.changesData)&&(this.one.push(z),this.y1c||(this.y1c=new fd.a(2,1,0,Object(v.a)(this,this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),90,"13"),this.yb.Gb(this.y1c)))}getSlideLastViewedVersions(){this.PG||
this.A2c||this.Coe.getSlideLastViewedVersionInfo(Object(v.a)(this,this.Zmk,"onReceiveLastViewedVersionInfo"))}wEh(){if(!this.PG&&!this.A2c){var z=this.P5f();this.Coe.putSlideLastViewedVersionInfo(z);this.q9b=z}}P5f(){const z=this.ta.presentation;if(!z)throw Error.argumentNull("Presentation is null");const U=Object.assign(new ge,{defLv:this.Zwb}),la=[];this.forEach(z.slides||[],Da=>{Da=Da.Bb;const Ia=this.Sb.$k(Da);Ia&&Ia.FZ&&(!Da.cid&&this.CFa.Jb(Da.sid)?Da=jg.a.bE(Da.sid,this.CFa.ga(Da.sid).mk.cid):
Da.cid&&this.CFa.Jb(Da.sid)&&Da.cid!==this.CFa.ga(Da.sid).mk.cid&&Uc.a.J(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",Da.sid,this.CFa.ga(Da.sid),Da.cid),la.push(new $b(Da,Ia.FZ)))});U.lv=la;return U}owl(z,U){const la=U.lv;this.forEach(z,Da=>{const Ia=Object(A.a)(123,Da);this.forEach(la,Db=>{Ia&&this.i$h(Ia,Db.mk)&&(!Ia.FZ||Ia.FZ<Db.dt)&&(Ia.FZ=Db.dt)})})}i$h(z,U){return z.cid&&U.cid?z.sid===U.sid&&z.cid===U.cid:z.sid===U.sid}OCe(z){this.forEach(z,U=>{this.NCe(Object(A.a)(123,
U))})}Hah(){var z=this.ta.presentation;if(!z)throw Error.argumentNull("Presentation is null");z=z.slides||[];0<z.length&&this.OCe(z)}Sah(z){this.LDh(z,U=>{this.MCe(z,U)})}NCe(z){if(z&&z.isConnected&&z.changesData){const U=this.H7d(z.changesData,this.vZd(z));U!==z.isUnread&&(this.QRg(z,U),this.Bql(),z===this.ta.Ba&&this.Sah(z))}}MCe(z,U){if(U&&U.isConnected&&U.Sa(Di.a.xic)){const la=this.H7d(U.changesData,this.vZd(z));this.ORg(z,U,la)}}ORg(z,U,la){la!==U.isUnread&&(Uc.a.J(512262744,804,50,"Shape unread state changed: {0} -> {1}",
U.isUnread,la),U.isUnread=la,this.e2c.WFk(new wc(U,z)))}QRg(z,U){U!==z.isUnread&&(Uc.a.J(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",z.isUnread,U,z.Bb.toString()),z.isUnread=U,this.e2c.tGk(new we(z)))}RRg(z){this.LDh(z,U=>{this.ORg(z,U,!1)});this.QRg(z,!1)}LDh(z,U){z&&(z=z.om(),this.forEach(z,la=>{U(la)}))}forEach(z,U){Mk.b(z,null,U)}G7d(z){return Bl(z,this.E9a)}H7d(z,U){return!!z&&!!z.dtField&&!this.G7d(z)&&z.dtField>U}Z0i(){const z=this.Sb.An;if(z&&z.oze)return z.oze;
Uc.a.J(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}x0k(){this.E9a=new ba(this.$b.Ha("UserName"),this.$b.Ha("387"),this.$b.Ha("388"))}Isl(){const z=this.ta.Ba;z&&(z.FZ=z.changesData?z.changesData.dtField:this.Zwb)}vZd(z){return z.FZ||this.Zwb}Bql(){this.nGg||(this.nGg=!0,Uc.a.J(512262741,804,50,"First revision tracking view render completed!"))}rrj(z){return z.isConnected&&z.changesData&&z.changesData.dtField?z.changesData.dtField<=this.Bje&&this.H7d(z.changesData,
this.vZd(z)):!1}I8a(z,U){return z.equals(U.slideId)}tryHighlightInsertedShapes(){Uc.a.J(512262740,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.H_c);this.y1c=null;const z=this.ta.Ba;if(z&&z.isUnread){const U=z.Bb;for(const la of this.one)this.I8a(U,la)&&this.MCe(z,la)}Array.clear(this.one)}Dla(){this.A2c=!0}Mda(z,U){try{U.YTc?(Uc.a.J(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),
this.A2c=!1):Uc.a.J(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(la){Uc.a.J(512262737,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",la)}}uKe(){return 1!==this.Qb.Nu}}Object(h.a)(oe,"RevisionTrackingManager",null,[]);class Fe{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc){this.ta=z;this.Sb=U;this.zoe=la;this.od=Da;this.Gka=Ia;this.Ea=Db;this.XWc=Ob;this.Mbb=sc;this.Le=hc;this.myb=Fc;this.V2j=Xc;this.gMg=!1;this.od.Tmb(Object(v.a)(this,
this.j1g,"onVisibleThumbnailRangeChanged"));this.od.HGd(Object(v.a)(this,this.vCb,"onThumbnailRefresh"));this.od.q5h(Object(v.a)(this,this.S_g,"onShapePresenceStateChanged"));this.od.Q5h(Object(v.a)(this,this.U0g,"onThumbnailPresenceStateChanged"));this.od.x4h(Object(v.a)(this,this.qok,"onShapeViewElementShowRevisionTrackingHint"));this.od.u4h(Object(v.a)(this,this.jok,"onShapeViewElementHideRevisionTrackingHint"));this.Gka.jDf(Object(v.a)(this,this.Edc,"onSlideUnreadStateChanged"));this.Gka.m5h(Object(v.a)(this,
this.Y_g,"onShapeUnreadStateChanged"));this.Gka.x5h(Object(v.a)(this,this.b0g,"onShowHideStateChanged"))}dispose(){this.od.Edh(Object(v.a)(this,this.j1g,"onVisibleThumbnailRangeChanged"));this.od.PQk(Object(v.a)(this,this.vCb,"onThumbnailRefresh"));this.od.yQk(Object(v.a)(this,this.S_g,"onShapePresenceStateChanged"));this.od.OQk(Object(v.a)(this,this.U0g,"onThumbnailPresenceStateChanged"));this.Gka.Ddh(Object(v.a)(this,this.Edc,"onSlideUnreadStateChanged"));this.Gka.vQk(Object(v.a)(this,this.Y_g,
"onShapeUnreadStateChanged"));this.Gka.CQk(Object(v.a)(this,this.b0g,"onShowHideStateChanged"))}j1g(){const z=this.ta.presentation;if(!z)throw Error.argumentNull("Presentation is null");Mk.b(z.slides||[],null,U=>{(U=this.Sb.$k(U.Bb))&&U.isUnread&&this.ZLe(U)})}vCb(z,U){z=this.Sb.$k(U.hwh);z.isUnread&&this.ZLe(z)}Edc(z,U){z=U.slide;z.isUnread?this.ZLe(z):this.tOk(z)}Y_g(z,U){z=U.shape;U=U.slide;z&&(z.isUnread?U===this.ta.Ba&&this.VLe(z):this.BDe(z))}S_g(z,U){z=U.shape;z.Lv?this.BDe(z):z.isUnread&&
this.VLe(z,!0)}U0g(z,U){z=U.slide;z.Lv&&!this.QKe?this.yOk(z):z.isUnread&&this.gdl(z)}b0g(z,U){z=U.shape;U.gBa&&z.isUnread?this.VLe(z):this.BDe(z)}get QKe(){return this.V2j}ZLe(z){z&&z.isConnected&&this.Rld(z,U=>{U.Mcl();z.Lv&&!this.QKe||this.BBf(U)})}tOk(z){z&&z.isConnected&&this.Rld(z,U=>{U.qOk();U.pch()})}gdl(z){z.Lv&&!this.QKe||this.Rld(z,Object(v.a)(this,this.BBf,"addRevisionTrackingPawnForThumbnail"))}yOk(z){this.Rld(z,U=>{U.pch()})}Voh(){const z=this.Sb.An;return!this.myb||this.myb&&z.gBa}VLe(z,
U=!1){this.Voh()&&!z.Lv&&z.Sa(Di.a.xic)&&(Object(A.a)(124,z.oc(this.Le))?(this.zoe.xP(z).display(()=>this.Ea.UMc(z)),this.fql(),Uc.a.J(23606109,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",U)):Uc.a.J(23606111,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}BDe(z){const U=this.zoe.VE(z);U?U.dismiss():this.Voh()&&z.isUnread&&Uc.a.J(23606113,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}Rld(z,
U){z&&((z=Object(A.a)(557,z.Ag(this.Mbb)))?U(z):Uc.a.J(23606115,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}BBf(z){z.ABf(this.XWc.backgroundColor,ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes)}qok(z,U){this.gCh(U.jx.shapeNode,!0)}jok(z,U){this.gCh(U.jx.shapeNode,!1)}gCh(z,U){(z=this.zoe.VE(z))&&(U?z.vwa():z.pZ())}fql(){this.gMg||(this.gMg=!0,Xd.c(oa.a.oji))}}Object(h.a)(Fe,"RevisionTrackingPresenter",null,[]);class Gf{OSf(){const z=new Cj.a;
z.yh(16,16);z.ya.setAttribute("class","RevisionTrackingIconSVG");z.mwa("0 0 16 16");const U=new Zl.a;U.a0("M13,7.5c0,0.5-0.4,0.9-0.9,0.9H9.7l2.6,2.6c0.4,0.4,0.4,0.9,0,1.3c-0.4,0.4-0.9,0.4-1.3,0L8.4,9.7v2.4C8.4,12.6,8,13,7.5,13c-0.5,0-0.9-0.4-0.9-0.9V9.7L4,12.3c-0.4,0.4-0.9,0.4-1.3,0c-0.4-0.4-0.4-0.9,0-1.3l2.6-2.6H2.9C2.4,8.4,2,8,2,7.5C2,7,2.4,6.6,2.9,6.6h2.4L2.7,4c-0.4-0.4-0.4-0.9,0-1.3c0.4-0.4,0.9-0.4,1.3,0l2.6,2.6V2.9C6.6,2.4,7,2,7.5,2C8,2,8.4,2.4,8.4,2.9v2.4L11,2.7c0.4-0.4,0.9-0.4,1.3,0c0.4,0.4,0.4,0.9,0,1.3L9.7,6.6h2.4C12.6,6.6,13,7,13,7.5z M7.5,5.6c-1,0-1.8,0.8-1.8,1.8c0,1,0.8,1.8,1.8,1.8c1,0,1.8-0.8,1.8-1.8C9.3,6.4,8.5,5.6,7.5,5.6z");
z.appendChild(U);return z.ya}pSf(){const z=new Cj.a;z.yh(10,10);z.mwa("0 0 10 10");z.ya.setAttribute("class","ModernRevisionTrackingIconSVG");const U=new Zl.a;U.a0("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");U.ya.setAttribute("class","ModernRevisionTrackingIconPath");z.appendChild(U);return z.ya}}Object(h.a)(Gf,"RevisionTrackingSVGProvider",null,[594]);class Rh{constructor(){this.g2c=this.J3c=this.I3c=this.Dme=0}UXj(){this.J3c+=1}rXj(z,U){switch(z){case 2:U&&(this.I3c+=1);break;case 0:U?(this.g2c+=1,Uc.a.J(39068549,
804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):Uc.a.J(39068551,804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:U&&(this.Dme+=1)}}log(){Uc.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",this.Dme,this.I3c,this.J3c,this.g2c);0<this.I3c+this.J3c+this.g2c&&Xd.c(oa.a.lLd)}}Object(h.a)(Rh,
"RevisionTrackingTelemetry",null,[]);var Sh=d(999),Wa=d(1102),Lg=d(72),gg=d(566);class ub{constructor(z,U,la,Da,Ia){this.B9a=null;this.BFa=z;this.ebb=U;this.zc=Ia;this.Yb=la;this.ra=Da;this.BFa.VU(Object(v.a)(this,this.sF,"onInteractivityChanged"))}dispose(){this.BFa&&this.BFa.dispose();this.B9a=this.BFa=null}display(z,U){this.B9a||(this.B9a=new gg.a);this.B9a.color=z;this.B9a.userName=U;this.BFa.lz(this.B9a)}dismiss(){this.BFa.BL(this.B9a.clientId)}vwa(){this.BFa.swa()}pZ(){this.BFa.Bea()}get IId(){const z=
this.BFa.Adb;return 0<z.length?z[0]:null}sF(z,U){z={InvokeSource:2,ShowRevisionTrackingStatus:null};1===U.type?(this.Yb.Ba!==this.zc?(this.zc&&(this.Yb.Ba=this.zc,this.ra.ly()),z.ShowRevisionTrackingStatus=3):z.ShowRevisionTrackingStatus=1,K.AFrameworkApplication.Ta.Ka(Sc.a.aHb,2,z)):2===U.type?this.zc&&this.Yb.Ba===this.zc&&(z.ShowRevisionTrackingStatus=2,K.AFrameworkApplication.Ta.Ka(Sc.a.aHb,2,z),this.ebb.UXj()):3===U.type&&this.zc&&this.Yb.Ba===this.zc&&(z.ShowRevisionTrackingStatus=0,K.AFrameworkApplication.Ta.Ka(Sc.a.aHb,
2,z))}}Object(h.a)(ub,"ThumbnailRevisionTrackingPawn",null,[659,106]);var nk=d(318);class Tj{constructor(z,U,la,Da,Ia,Db){this.ve=z;z=Lg.getImageClassWithCluster("pegal","UnreadNotification_16x16x32");U=U.Yj("pegal.png");la=K.AFrameworkApplication.fa.ka("1166")?la.pSf():la.OSf();this.C6j=this.nBi(K.AFrameworkApplication.isRtl,z,U,la);this.ebb=Da;this.Yb=Ia;this.ra=Db}opl(z){let U=null;z&&(U=this.ve.Ee(),z.GPe?(U.style.width=this.Lc(nk.a.Nll+z.GPe.width),U.style.left=this.Lc(Math.min(z.Rck,-16)-2),
U.style.height=this.Lc(6+Math.abs(nk.a.fwh)+z.GPe.height),U.style.top=this.Lc(nk.a.fwh-2)):Uc.a.J(512262736,804,10,"TryCreateBackground: thumbnailViewElement.ThumbOuterBorderSize is null"),this.ve.addCssClass(U,"rtThumbnail"));return U}dzi(z,U){return new ub(this.C6j.spb(z),this.ebb,this.Yb,this.ra,U)}Lc(z){return this.ve.Lc(z)}nBi(z,U,la,Da){const Ia=new Sh.a;Ia.add(1,U);Ia.add(4,la);Ia.add(6,16);Ia.add(8,z);Ia.add(12,2);Ia.add(11,!1);Ia.add(14,Da);return new Wa.a(Ia)}}Object(h.a)(Tj,"RevisionTrackingThumbnailGadgetsFactory",
null,[593]);class Fj{constructor(z,U,la){this.RZc=this.i9b=!0;this.Uv=z;this.REa=U;this.la=la}get rQj(){return this.i9b}getSlideLastViewedVersionInfo(z){if(this.RZc){Uc.a.J(25203102,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var U=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPPTSlideLastViewedMetadata",K.AFrameworkApplication.Zg),la={};la["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Uv.vj(U,1,null,la,!1,2,Object(v.a)(this,this.vkk,"onGetVersionInfoSucceeded"),Object(v.a)(this,this.ukk,"onGetVersionInfoFailed"),z,void 0,void 0,void 0,void 0,$l.a("12"));this.RZc=!1}else Uc.a.J(25203100,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(z){if(this.i9b){Uc.a.J(25203106,824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var U=M.c(z),la=this.la.pptRevisionTrackingMaxRoamingDataSizeInBytes;
if(U.length>la)Uc.a.J(25203136,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",z.lv.length,U.length,la);else{la=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",K.AFrameworkApplication.Zg);if(K.AFrameworkApplication.fa.ka("SendBeaconOnRoamingRequestsIsEnabled"))this.Uv.SHa(la,U);else{const Da={};Da["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Uv.vj(la,2,U,Da,!1,2,Object(v.a)(this,this.Smk,"onPutVersionInfoSucceeded"),Object(v.a)(this,this.Rmk,"onPutVersionInfoFailed"),z.lv.length,void 0,void 0,void 0,void 0,$l.a("13"))}this.i9b=!1}}else Uc.a.J(25203104,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}vkk(z){this.RZc=!0;let U=0;try{let la=null;z.data.Zd&&0<z.data.Zd.trim().length&&(U=z.data.Zd.length,la=JSON.parse(z.data.Zd,Object(v.a)(this,this.GQj,
"jsonDateReviver")));const Da=z.data.state;Da(la)}catch(la){Uc.a.J(23132289,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",la.toString())}z=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",U,JSON.stringify(z.data.NH),JSON.stringify(z.data.zt),JSON.stringify(z.data.Iu));Uc.a.J(25203139,824,50,z)}ukk(z){this.RZc=!0;z=this.REa.bia(z);Uc.a.J(23132291,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",z)}Smk(z){this.i9b=
!0;Uc.a.J(25203142,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.Iu-+z.data.NH,+z.data.zt-+z.data.NH)}Rmk(z){this.i9b=!0;const U=this.REa.bia(z);Uc.a.J(23132293,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",U,z.data.state)}GQj(z,U){return"dt"===z||"defLv"===z?new Date(U):U}}Object(h.a)(Fj,"RoamingCacheProxy",null,[592,106]);var so=d(670),tn=d(111);class Ll{constructor(z,U,la){this.wg=z;this.HI=Object(A.a)(so.a,this.wg.nnh);this.XWc=U;this.DPg=
la;this.f_=K.AFrameworkApplication.fa.ka("1166");this.wg.Dug=this.f_}display(z){let U;U=this.f_?this.DPg.pSf():this.DPg.OSf();this.HI.zBf(this.XWc.backgroundColor,z,U);this.wg.fJb(this.XWc.foregroundColor);this.wg.setVisibility()}dismiss(){this.HI.clear();this.wg.fJb(tn.a.none);this.wg.setVisibility()}$m(z){this.wg.$m(z)}XD(z){this.wg.XD(z)}kq(){return this.wg.kq()}IP(z){return this.wg.kub(z)}Ux(z){this.wg.Ux(z)}dispose(){this.wg.dispose()}nz(){this.wg.nz()}XE(z){return this.wg.XE(z)}QD(z){return this.wg.QD(z)}draw(z,
U){this.wg.draw(z,U)}get visible(){return this.wg.visible}set visible(z){this.wg.visible=z}setPosition(z,U){this.wg.setPosition(z,U)}Ej(z){this.wg.Ej(z)}Uq(z){this.wg.Uq(z)}pv(z){this.wg.pv(z)}setZIndex(z){this.wg.setZIndex(z)}AF(z,U){this.wg.AF(z,U)}vwa(){this.HI.vwa()}pZ(){this.HI.pZ()}setSelection(){}}Object(h.a)(Ll,"ShapeRevisionTrackingView",null,[629,387,388,106]);class Em{constructor(){this.K=null;this.myb=this.Jke=this.AW=this.NEa=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}Wb(z){this.K=
z;z.resolve("Common.IAppSettingsManager").ff(()=>{this.AW=z.resolve("PowerPointWebEditor.IApplicationContext").kd.vg;this.Jke=z.resolve("PowerPointWebEditor.IApplicationContext").kd.JKj;this.NEa=z.resolve("PowerPointWebEditor.IApplicationContext").kd.Lwg;this.myb=z.resolve("PowerPointWebEditor.IApplicationContext").kd.I9d;this.register();this.resolve()})}dispose(){this.NEa&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const z=this.K;this.AW&&this.Jke&&z.register(Ne.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new Ne.a(K.AFrameworkApplication.He,z.resolve("PowerPointWebEditor.ISessionInfoOwner"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),z.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),z.resolve("PowerPointWebEditor.IErrorHandler"),z.resolve("Common.ITaskManager"),z.resolve("Common.IAppSettingsManager")));
this.NEa&&(z.register(Rh,"RevisionTrackingTelemetry").ma().na(()=>new Rh),z.register(oe,"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").ma().na(()=>new oe(z.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("Common.ITaskManager"),z.resolve("PowerPointWebEditor.ISlideReader"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
z.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),z.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),z.resolve("Box4.Graph.IGraphInstance").Bd(10),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),z.resolve("PowerPointWebEditor.IApplicationSettings"),z.resolve("Common.IAppSettingsManager"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.View.IPPTPageView"))),z.register(Fe,
"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").ma().na(()=>new Fe(z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),z.resolve("PowerPointWebEditor.IShapeReader"),
z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),z.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,z.resolve("Box4.IPageView").Ma,z.resolve("PowerPointWebEditor.IApplicationSettings").I9d,z.resolve("Common.IAppSettingsManager").ka("PPTCanvasPresenceBubbleUXEnabled"))),z.register(592,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").ma().na(()=>new Fj(K.AFrameworkApplication.He,z.resolve("PowerPointWebEditor.IJsonpHelperManager"),z.resolve("PowerPointWebEditor.IApplicationSettings"))),
z.register(593,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").ma().na(()=>new Tj(z.resolve("PowerPoint.IBrowserHelperManager"),z.resolve("PowerPoint.IPathManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),z.resolve("PowerPointWebEditor.IPptSelectionManager"))),z.register(Tb,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").ma().na(()=>
new Tb),z.register(336,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").ma().na(()=>new Tm.a((U,la)=>{let Da=null;const Ia=Object(A.a)(124,U.oc(z.resolve("Box4.IPageView").Ma));Ia&&!Ia.ll&&(U=z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").pPd(z.resolve("PowerPointWebEditor.IPptSelectionManager"),(Db,Ob,sc)=>z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").iAi(Db,Ob,sc,z.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
U,la,Ia.PT),Da=new Ll(U,z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),Da.$m(Ia.PT),Ia.zza(Da,1),Da.visible=Ia.KP||Ia.Fn);return Da})),z.register(xb,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").ma().na(()=>new xb(z.resolve("Common.Utils.IHighContrastDetector"))),z.register(594,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").ma().na(()=>new Gf),
this.AW&&this.myb&&z.register(Ta,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").ma().na(()=>new Ta(z.resolve("Common.IActionManagerExtended"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.View.IViewEventSource"),z.resolve("RevisionTrackingTelemetry"))))}resolve(){this.AW&&
this.Jke&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");if(this.NEa&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.myb)){const z=this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");z.ub();z.we()}}static main(){va.a.instance.Ac(Fb.a(new Em,0))}}Object(h.a)(Em,
"PPTWebEditorRevisionTrackingPackage",null,[2,3]);var gp=d(534),Cl=d(671);class Um{get name(){return"Common.App.OAuth.OAuthPackage"}Wb(z){z.register(631,"Common.App.OAuth.IOAuthManager").ma().na(()=>new gp.OAuthManager)}init(){const z=Z.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Uql(z)}Uql(z){const U=K.AFrameworkApplication.fa.Ha("FileSource");if(K.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||K.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===U){var la=Y.a.Rui;
if(la&&la.IsEnabled){var Da=la.Application,Ia=Y.a.authority;if(void 0!==Da&&null!==Da&&Da.length&&void 0!==Ia&&null!==Ia&&Ia.length){var Db=Cl.a[z.x5],Ob=ia.a.iy,sc=z.hD();try{var hc=new Map;void 0!==hc&&null!==hc?(hc.set("SupportStatus",Db),hc.set("Browser",Ob),hc.set("AuthStrategy",sc)):hc=null}catch(Xc){hc=null}u.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",hc);var Fc=Bc.a.oj();z.q0("Core",Da).then(Xc=>{const md=Math.floor(Bc.a.oj()-Fc);Db=Cl.a[z.x5];Ob=ia.a.iy;sc=z.hD();
e.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',md,Xc.IsSuccess,Db,Xc.ErrorCode,U,Ob,sc);hc&&(hc.set("SupportStatus",Db),hc.set("Browser",Ob),hc.set("AuthStrategy",sc));var Nc=Object.assign(new Ba.a,{durationMs:md,extendedProperties:hc});if(Xc.IsSuccess){if(u.Health.instance.recordKpiSuccess("WacCorePFT",Nc),Nc=la.Endpoint){var bf=Bc.a.oj();
K.AFrameworkApplication.He.Fmb(Nc,1,null,{["Authorization"]:"Bearer "+Xc.Token},2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(pe=>{var wf=Math.floor(Bc.a.oj()-bf),rf=null;pe.Dn?pe="Canceled":pe.Wl?pe="Faulted":(rf=pe.result,pe=rf.succeeded?"Completed":"Failed");wf={["TaskResult"]:pe,["BrowserTokenDurationMS"]:md,["BrowserValidationDurationMS"]:wf};rf&&(wf.HttpStatus=rf.Ri.data.af,rf.succeeded&&(rf=M.a(rf.Ri.data.Zd),wf.ServerValidationDurationMS=rf.ElapsedMilliseconds,wf.ServerValidationResult=
rf.ValidatedToken,wf.KMSI=rf.KMSI,wf.Scopes=rf.Scopes,wf.TokenExpirationS=Math.floor(parseInt(rf.Expiration)-(new Date).getTime()/1E3)));e.ULS.sendTraceTag(520632322,3E3,"Completed"===pe?50:15,ja.a.toJSON(wf))})}}else u.Health.instance.recordKpiFailure("WacCorePFT",Xc.ErrorCode,!1,!1,Nc)}).catch(Xc=>{var md=Math.floor(Bc.a.oj()-Fc);md=Object.assign(new Ba.a,{durationMs:md,extendedProperties:hc});u.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Xc.toString(),!1,!1,md)})}}}}dispose(){}static main(){va.a.instance.Ac(new Um)}}
Object(h.a)(Um,"OAuthPackage",null,[2,3]);var lf=d(394),Ok=d(220),nm=d(132);class Th{constructor(z){this.rMa=[ld.a.Dlc,ld.a.Elc,ld.a.Flc,ld.a.Glc,ld.a.Hlc];this.z_e=z}K8f(z){return this.z_e?this.z_e.lLc(z.Ua):null}create(z){return z?(z=this.vWb(z))?nm.m(z):"":""}Cwi(z){z=z.suggestions;if(!z||!z.count)return null;z=({nVf:U}=this.WAi(z)).returnValue;var U=Th.Exi(U);const la=Object.assign(new lf.a,{ExternalId:"DictationCorrectionMenu",Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,
Image16by16Class:Lg.getImageClassWithCluster(K.AFrameworkApplication.$M,Th.VFi),Image16by16:K.AFrameworkApplication.Vl,Menu:Object.assign(new Bh.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});z&&Array.add(la.Menu.MenuSectionList,z);Array.add(la.Menu.MenuSectionList,U);return la}WAi(z){let U;const la=Object.assign(new Lh.a,{Id:"DictationCorrectionSuggestions",ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});
U=null;for(let Da=0,Ia=Math.min(this.rMa.length,z.count);Da<Ia;++Da){if(!U&&""===z.ga(Da).suggestion){U=this.rMa[Da].toString();continue}const Db=Object.assign(new Ok.a,{ExternalId:"btnDictationCorrectionSuggestion"+Da,Command:this.rMa[Da].toString(),LabelText:z.ga(Da).suggestion});Array.add(la.ControlList,Db)}return la.ControlList.length?{returnValue:la,nVf:U}:{returnValue:null,nVf:U}}vWb(z){if(z=this.Cwi(z)){const U=Object.assign(new Lh.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});
Array.add(U.ControlList,z);return U}return null}static Exi(z){const U=Object.assign(new Lh.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),la=Object.assign(new Ok.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});Array.add(U.ControlList,la);z&&(z=Object.assign(new Ok.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",
Command:z,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(U.ControlList,z));return U}}Th.VFi="Insertaudio_16x16x32";Object(h.a)(Th,"DictationCorrectionContextMenuManager",null,[628]);var me=d(430);class Gn{constructor(z,U){this.hqc=null;this.Zq=z;this.nY=U}get key(){return"DICTATIONCORRECTION"}get G6(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(z){this.Zq.Wd(z.node)?this.hqc=z.node:this.hqc=null}Nmc(z){let U;U=null;if(!this.hqc)return{returnValue:!1,
sza:U};z=this.nY.x1i(this.hqc,z);if(!z)return{returnValue:!1,sza:U};U=Object.assign(new me.a,{K_:this.key,iP:z,description:this.SXd()});return{returnValue:!0,sza:U}}SXd(){return K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(h.a)(Gn,"DictationCorrectionDetailsProvider",null,[691,397]);var Sf=d(602),Fd=d(141);class ef{constructor(z,U,la=-1){this.TriggerType="click";this.TreatedInUX=
"true";this.PhraseId=z.Wuk;this.CorrectionId=z.id;switch(U){case 0:this.EditType="alternate";this.AlternateId=la;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:e.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(h.a)(ef,"CorrectionEvent",null,[]);class kh{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}}Object(h.a)(kh,"CorrectionTelemetry",null,[]);class Pk{constructor(){this.Id=
"Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(h.a)(Pk,"CorrectionsSessionTelemetry",null,[]);class uj{constructor(){this.rR=!1;this.vnd=this.hwd=0}start(){this.rR||(this.rR=!0,this.hwd=this.getTime())}stop(){this.rR&&(this.vnd+=this.getTime()-this.hwd,this.rR=!1)}get Dq(){return this.vnd+(this.rR?this.getTime()-this.hwd:0)}getTime(){return(new Date).getTime()}}Object(h.a)(uj,"DictationCorrectionsSessionTimer",null,[]);class Dl{constructor(){this.StartTime=
"";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(h.a)(Dl,"SessionInfo",null,[]);class Zi{constructor(){this.FinalText="";this.PhraseIds=null}}Object(h.a)(Zi,"TextInfo",null,[]);var De=d(178),nf=d(139);class Ak{constructor(z){this.Pef=this.Qxd=this.Rxd=0;this.oGh="Office.Voice.Online.DictationCorrectionsSession";this.I1a=null;this.Dlb=Object.assign(new Dl,{TextInfo:[new Zi]});this.p3e=z}startSession(){this.I1a||(this.Dlb.StartTime=(new Date).toISOString(),
this.I1a=new uj);this.I1a.start()}pauseSession(){this.I1a.stop()}endSession(){this.I1a.stop();var z=new De.a;z.name=this.oGh;z.samplingPolicy=2;z.durationMs=this.I1a.Dq;z.dataFields=[];Array.add(z.dataFields,Object.assign(new nf.a,{name:"CorrectionSessionId",string:this.cwa}));Array.add(z.dataFields,Object.assign(new nf.a,{name:"StartTime",string:this.Dlb.StartTime}));Array.add(z.dataFields,Object.assign(new nf.a,{name:"NumberOfCorrectionsMarked",int64:this.Rxd}));Array.add(z.dataFields,Object.assign(new nf.a,
{name:"NumberOfCorrectionsMade",int64:this.Qxd}));Array.add(z.dataFields,Object.assign(new nf.a,{name:"NumberOfCorrectionsDismissed",int64:this.Pef}));Fd.a.sendActivityEvent(z);if(Jf.App.aZ&&0<Jf.App.aZ.j4g.length){this.Dlb.AlternateEditCount=this.Qxd;this.Dlb.Duration=Math.floor(this.I1a.Dq/1E3);this.Dlb.TextInfo[0].PhraseIds=Jf.App.aZ.j4g;var U=new Pk;U.ClientSessionId=this.cwa;U.SessionInfo=this.Dlb;if(z=this.p3e())U=M.c(U),z.HAg(U)}}bjk(z){this.Rxd+=z}HXg(z,U,la=-1){0===U?this.Qxd++:1===U&&this.Pef++;
var Da=new kh;Da.ClientSessionId=this.cwa;Da.CorrectionEvents=[new ef(z,U,la)];if(z=this.p3e())Da=M.c(Da),z.HAg(Da)}get cwa(){return Jf.App.aZ?Jf.App.aZ.cwa:""}}Object(h.a)(Ak,"DictationCorrectionsTelemetry",null,[]);var qf=d(42),Sg=d(39);class Ml{constructor(z,U,la){this.FM=z;this.Kb=U;this.fG=la}}Object(h.a)(Ml,"DictationCorrectionRange",null,[]);var am=d(353);class Tn{constructor(z,U,la){this.twf=this.Cq=null;this.Zib=z;this.Lxa=U;this.avc=new am.a(new Sf.a);this.$pc=la;this.Xla()}L6d(z){this.Lxa.JAa&&
$f.ParagraphReader.Wd(z)&&this.avc.contains(z.id)&&this.Zib.L6d(z)}ugl(){this.Lxa.JAa=!0;this.Cq=new Ak(()=>this.twf);this.Cq.startSession()}jhl(){this.Lxa.JAa=!1;var z=Jf.App.Fb.Ed.en.rg;if(z){z=z.Ch;for(let U of this.avc){const la=z.re(U);la&&$f.ParagraphReader.Wd(la)&&this.Zib.Cmi(la)}}this.$pc.clear();this.avc.clear();this.Cq.endSession()}FUk(z){if(this.Lxa.JAa){var U=z.sa(Sg.a.mRd,null);if(!wh.a.Va(U)){var la=new za.a,Da=Math.min(U.length,z.Ra.length);for(let Ia=0;Ia<Da;Ia++){const Db=this.$pc.X_i(U[Ia]);
if(Db){const Ob=z.Ra.ga(Ia).cp;la.add(new Ml(Ob,Ob+Db.source.length,Db))}}this.Zib.Bak(z,la)}}}rSe(z,U){if(!U)return!1;if(!this.Lxa.JAa||!z)return U.add(null),!1;U.add(z.Ku?z.Ku.fG.key:null);return!!z.Ku}pXk(z,U){this.Lxa.JAa&&U&&La.AT(U,la=>!!la)?z.ke(Sg.a.mRd,U.toArray()):z.removeProperty(Sg.a.mRd)}hbh(z){this.twf=z}Xla(){this.Zib.E2h(Object(v.a)(this,this.Zik,"onDictationCorrectionMarkerAdded"));Dg.a.addHandler(window.self,rb.a.blur,()=>{this.Cq&&this.Lxa.JAa&&this.Cq.pauseSession()});Dg.a.addHandler(window.self,
rb.a.focus,()=>{this.Cq&&this.Lxa.JAa&&this.Cq.startSession()});this.Zib.F2h(Object(v.a)(this,this.$ik,"onDictationCorrectionMarkerRemoved"))}$ik(z,U){this.$pc.tNk(U.YQf)}Zik(z,U){this.avc.add(U.fsk);this.Cq&&this.Cq.bjk(U.dbk);this.$pc.$Zh(U.YQf)}Yik(z,U){this.Cq&&this.Cq.HXg(z,0,U)}ajk(z){this.Cq&&this.Cq.HXg(z,1)}x1i(z,U){if(!this.Lxa.JAa)return null;z=Eh.a.Uj(z,U);return this.Zib.lLc(z)}}Object(h.a)(Tn,"DictationCorrectionManager",null,[627]);var Bk=d(342);class Fm extends Sys.EventArgs{constructor(z,
U){super();this.fsk=z;this.dbk=U?U.count:0;this.YQf=U}}Object(h.a)(Fm,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Nl{constructor(z,U,la,Da,Ia){this.ZRh=z;this._id=U;this.ZIh=Da;this.nRb=Ia;this.kt=la;this.eOb=String.format("{0}_{1}",z,U)}get Wuk(){return this.ZRh}get id(){return this._id}get source(){return this.kt}get confidence(){return this.ZIh}get suggestions(){return this.nRb}get key(){return this.eOb}mck(z){this.suggestions.addRange(z.suggestions)}}Object(h.a)(Nl,"DictationCorrectionDetails",
null,[]);class Cf{constructor(z,U,la){this.un=z;this.vJh=U;this.fRh=la}get fG(){return this.vJh}get HYg(){return this.fRh}get xe(){return this.un}Sd(z){return new Cf(z||this.xe,this.fG,this.HYg)}}Object(h.a)(Cf,"DictationCorrectionObject",null,[170]);class Ol{constructor(z,U){this.source=z;this.suggestion=U}}Object(h.a)(Ol,"DictationCorrectionSuggestion",null,[]);class Re{constructor(z){this.Vg=z;this.Pa=new xk.a}E2h(z){this.Pa.addHandler("ADCM",z)}F2h(z){this.Pa.addHandler("RDCM",z)}Bak(z,U){this.Lak(z,
U)}Lak(z,U){if(z&&U&&U.count&&(U=Re.Lyl(z,U))&&U.count){this.Pmi(z,U);var la=new za.a;for(var Da of U)la.add(Da.FM),la.add(Da.Kb);z.eTd(la);for(let Ia of U)Da=z.Ra.jS(Ia.FM),Da.Ku=new Cf(Da,Ia.fG,Object(v.a)(this,this.Omj,"handleParagraphSplit")),Da.isFromErrorRangeSplit=!0,Da=z.Ra.jS(Ia.Kb),Da.isDictationCorrectionEnd=!0,Da.isFromErrorRangeSplit=!0;0<U.count&&this.Pa.raiseEvent("ADCM",new Fm(z.id,U))}}J8f(z){const U=new za.a;if(z){let la=null,Da=-1;for(let Ia=0;Ia<z.Ra.length;Ia++){const Db=z.Ra.ga(Ia);
Db.Ku?(Da=Db.cp,la=Db.Ku.fG):Db.isDictationCorrectionEnd&&(la?U.add(new Ml(Da,Db.cp,la)):e.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),la=null)}}return U}Ihc(z,U){if(z&&U&&U.count){for(let la of U){let Da=z.Ra.jS(la.FM);Da&&(Da.Ku=null);if(Da=z.Ra.jS(la.Kb))Da.isDictationCorrectionEnd=!1}this.Pa.raiseEvent("RDCM",new Fm(z.id,U))}}Cmi(z){if(z)for(let U=0;U<z.Ra.length;U++){const la=z.Ra.ga(U);la.Ku&&(la.Ku=null);la.isDictationCorrectionEnd&&(la.isDictationCorrectionEnd=
!1)}}lLc(z){if(!z||!qf.SelectionEditor.Pj(z)&&!qf.SelectionEditor.Kg(z))return null;const U=z.node;let la=z.Qa;z=z.Kb;let Da=0,Ia=null;for(let Db=0;Db<U.Ra.length;Db++){const Ob=U.Ra.ga(Db);if(Ob.Ku&&la>=Ob.cp)Ia=Ob.Ku,Da=Ob.cp;else if(Ia&&Ob.isDictationCorrectionEnd){if(z<=Ob.cp)return new Ml(Da,Ob.cp,Ia.fG);Ia=null}}return null}Myl(z,U,la){if(!z)return!1;z=$f.ParagraphReader.text(z);return Re.pDh(z,U.source,la)}L6d(z){if(z){var U=this.J8f(z);if(U&&0<U.count){const la=new za.a,Da=$f.ParagraphReader.text(z);
for(let Ia of U)Re.oDh(Da,Ia)||la.add(Ia);this.Ihc(z,la)}}}Pmi(z,U){U.ga(0);U.ga(U.count-1);const la=this.J8f(z);let Da=0,Ia=0;const Db=new za.a;for(;Ia<U.count&&Da<la.count;){const Ob=U.ga(Ia),sc=la.ga(Da);Ob.Kb<sc.FM?Ia++:(sc.Kb>Ob.FM&&Db.add(sc),Da++)}this.Ihc(z,Db)}Omj(z,U){const la=U.xe;for(var Da=z.Ra.fsb(la.cp)+1;Da<z.Ra.length;Da++){const Ia=z.Ra.ga(Da);if(Ia.isDictationCorrectionEnd){let Db;this.Ihc(z,(Db=new za.a,Db.add(new Ml(la.cp,Ia.cp,U.fG)),Db));break}}}Ook(z,U){(z=Jf.App.Fb.Ed.en.rg)&&
(U=z.Ch.re(Bk.a.Yf(U.nodeId)))&&$f.ParagraphReader.Wd(U)&&this.uNk(U)}uNk(z){if(z){var U=0,la=!1,Da=!1,Ia=new za.a;for(let Db=0;Db<z.Ra.length;Db++){const Ob=z.Ra.ga(Db);Ob.Ku&&(U=Db,la=!0);la&&(Ob.Ap||Ob.HK)&&(Da=!0);Ob.isDictationCorrectionEnd&&la&&(la=!1,Da&&(Da=z.Ra.ga(U),Da.Ku&&Da.Ku.fG&&Ia.add(new Ml(Da.cp,Ob.cp,Da.Ku.fG)),Da.Ku=null,Da=Ob.isDictationCorrectionEnd=!1))}this.Pa.raiseEvent("RDCM",new Fm(z.id,Ia))}}static Lyl(z,U){if(!U.count)return U;U.Sc((Da,Ia)=>Da.FM!==Ia.FM?Da.FM-Ia.FM:Da.Kb-
Ia.Kb);z=$f.ParagraphReader.text(z);const la=new za.a;for(let Da=0;Da<U.count;Da++){const Ia=U.ga(Da);if(Ia.FM>z.length||Ia.Kb>z.length)break;if(!Re.oDh(z,Ia))continue;if(!la.count){la.add(Ia);continue}const Db=la.ga(la.count-1);Ia.FM>Db.Kb?la.add(Ia):Db.FM===Ia.FM&&Db.Kb===Ia.Kb&&Db.fG.mck(Ia.fG)}return la}static pDh(z,U,la){if(la+U.length<=z.length){for(let Da=0;Da<U.length;Da++)if(U.charAt(Da)!==z.charAt(Da+la))return!1;return!0}return!1}static oDh(z,U){return!z||U.FM>z.length||U.Kb>z.length||
!U.fG||!U.fG.source?!1:Re.pDh(z,U.fG.source,U.FM)}}Object(h.a)(Re,"DictationCorrectionRangeEditor",null,[626]);class Gm{constructor(){this.JAa=!1}}Object(h.a)(Gm,"DictationCorrectionSettings",null,[]);var Zg=d(14);class of{constructor(){this.jRb=new Zg.ScriptSharpLegacyMap}$Zh(z){if(z&&z.count)for(let U of z)U.fG?(z=U.fG.key,this.jRb.Jb(z)||this.jRb.add(z,U.fG)):e.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}tNk(z){if(z&&z.count)for(let U of z)U.fG?this.jRb.remove(U.fG.key):e.ULS.sendTraceTag(593285259,
394,10,"Correction details is null.")}X_i(z){if(!z)return null;let U;return({value:U}=this.jRb.Of(z)).returnValue?U:null}clear(){this.jRb=new Zg.ScriptSharpLegacyMap}}Object(h.a)(of,"DictationCorrectionStorage",null,[689]);class Un{constructor(z,U,la,Da,Ia,Db,Ob){this.Vg=z;this.LLb=U;this.nY=la;this.Ca=Da;this.Pc=Ia;this.$e=Db;this.jk=Ob}ub(){this.Ca.xa(ld.a.Dlc,jd.a.Lf,Object(v.a)(this,this.Ilc,"takeSuggestedDictationCorrectionAction"));this.Ca.xa(ld.a.Elc,jd.a.Lf,Object(v.a)(this,this.Ilc,"takeSuggestedDictationCorrectionAction"));
this.Ca.xa(ld.a.Flc,jd.a.Lf,Object(v.a)(this,this.Ilc,"takeSuggestedDictationCorrectionAction"));this.Ca.xa(ld.a.Glc,jd.a.Lf,Object(v.a)(this,this.Ilc,"takeSuggestedDictationCorrectionAction"));this.Ca.xa(ld.a.Hlc,jd.a.Lf,Object(v.a)(this,this.Ilc,"takeSuggestedDictationCorrectionAction"));this.Ca.xa(ld.a.Clc,jd.a.Lf,Object(v.a)(this,this.Clc,"takeIgnoreSuggestedDictationCorrection"));this.Ca.xa(ld.a.Dlc,jd.a.view,Object(v.a)(this,this.Wob,"collapseIpThenExecuteAction"));this.Ca.xa(ld.a.Elc,jd.a.view,
Object(v.a)(this,this.Wob,"collapseIpThenExecuteAction"));this.Ca.xa(ld.a.Flc,jd.a.view,Object(v.a)(this,this.Wob,"collapseIpThenExecuteAction"));this.Ca.xa(ld.a.Glc,jd.a.view,Object(v.a)(this,this.Wob,"collapseIpThenExecuteAction"));this.Ca.xa(ld.a.Hlc,jd.a.view,Object(v.a)(this,this.Wob,"collapseIpThenExecuteAction"));this.Ca.xa(ld.a.Clc,jd.a.view,Object(v.a)(this,this.Wob,"collapseIpThenExecuteAction"));this.Ca.$d(ld.a.Dlc,96);this.Ca.$d(ld.a.Elc,96);this.Ca.$d(ld.a.Flc,96);this.Ca.$d(ld.a.Glc,
96);this.Ca.$d(ld.a.Hlc,96);this.Ca.$d(ld.a.Clc,96)}U8h(z,U,la){const Da=this.jk.je(15);try{Da.fd(z);let Ia;this.LLb.Ihc(z,(Ia=new za.a,Ia.add(U),Ia));const Db=U.fG.suggestions.ga(la);if(this.LLb.Myl(z,Db,U.FM)){const Ob=Eh.a.createTextRange(z,U.FM,U.FM+Db.source.length);this.Vg.replaceTextRange(Ob,Db.suggestion);this.nY.Yik(U.fG,la)}else e.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{Da&&Da.dispose()}}Ilc(z,U,la){2===la&&U.Kk&&(la=this.LLb.lLc(U))&&this.U8h(U.node,la,this.Z_i(z));
return 32}Wob(z,U,la,Da,Ia){if(2===la){U=this.Pc.Oa.kb;if(!U)return 2;U=this.$e.yl(U,!0,!1);return this.Ca.ii(U.Ua,z,la,!1,Da,Ia)}return 32}Clc(z,U,la){if(2===la&&U.Kk&&(z=this.LLb.lLc(U))){let Da;this.LLb.Ihc(U.node,(Da=new za.a,Da.add(z),Da));this.nY.ajk(z.fG)}return 32}Z_i(z){switch(z){case ld.a.Dlc:return 0;case ld.a.Elc:return 1;case ld.a.Flc:return 2;case ld.a.Glc:return 3;case ld.a.Hlc:return 4;default:return-1}}}Object(h.a)(Un,"DictationCorrectionsActor",null,[688]);var om=d(310),Ve=d(61);
class $i{constructor(){this.A_e=this.Da=null}get name(){return"Box4.DictationCorrections"}Wb(z){this.Da=z;this.Da.register(626,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").ma().na(()=>new Re(this.Da.resolve("Box4.ICharacterPropertiesEditor")));this.Da.register(627,"Box4.DictationCorrections.IDictationCorrectionManager").ma().na(()=>new Tn(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new Gm,new of));this.Da.register(628,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").ma().na(()=>
new Th(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager");this.A_e=new Un(this.Da.resolve("Box4.ICharacterPropertiesEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),K.AFrameworkApplication.Ta,Ve.a.instance,om.a.instance,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"));this.A_e.ub();
this.GKk(this.Da.La("Box4.Accessibility.IAccessibilityContextManager"),this.Da.resolve("Box4.IParagraphReader"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));const z=this.Da.pb("Box4.Proofing.IErrorRangeEditor"),U=this.Da.pb("Box4.DictationCorrections.IDictationCorrectionRangeEditor");K.AFrameworkApplication.fa.ka("WacBox4DictationFloatieIsEnabled")&&z&&U&&z.N3h(Object(v.a)(U,U.Ook,"onSpellingErrorRangesChangedEventHandler"));Jf.App.Fb.updateCommandUI()}dispose(){}GKk(z,
U,la){z&&z.execute(Da=>{Da.VWa(new Gn(U,la))})}}Object(h.a)($i,"DictationCorrectionsPackageManager",null,[2,3]);d(1171);d(701);var pm=d(476);class ok{constructor(z,U,la,Da=null,Ia=null){this.un=z;this.YF=U;this.AOh=la;this._id=Da;this.Std=Ia}get xe(){return this.un}get type(){return this.YF}get fk(){return this.AOh}get id(){return this._id}get Ppg(){return this.Std}Sd(z){return new ok(z,this.type,this.fk,this.id,this.Ppg)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,
this.fk,this.id?this.id.toString():"<null>")}}Object(h.a)(ok,"IntentObject",null,[170]);d(590);class Vn{constructor(z,U,la,Da=null,Ia=null){pm.a(z);this.YF=z;this.Iod=U;this.vrd=la;this._id=Da;this.Std=Ia}get type(){return this.YF}get begin(){return this.Iod}get end(){return this.vrd}get id(){return this._id}get Ppg(){return this.Std}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(h.a)(Vn,"IntentRange",
null,[194]);d(352);d(161);d(217);class qm{constructor(z){this.Vg=z}}Object(h.a)(qm,"IntentRangeEditor",null,[580]);class Pl{constructor(){this.Da=null}get name(){return"Box4.Intent"}Wb(z){this.Da=z;this.Da.register(qm,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").ma().na(()=>new qm(this.Da.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){va.a.instance.Ac(new Pl)}}Object(h.a)(Pl,"PackageManager",null,[2,3]);
var ni=d(1116),un=d(1080),Io=d(296),lh=d(1081),pk=d(909),aq=d(775);class pf{}pf.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");pf.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");pf.Vzl="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");
pf.Eai=["en-US","en-CA","en-GB","en-AU","en-IN"];pf.Fai="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");pf.nDi="en-US";pf.LFi="btnStartDictation";pf.WFi="btnDictationFloatieToggle";pf.QFi="Dictation";pf.XFi="DictationFloatieToggle";pf.nWf="Insertaudio_32x32x32";pf.mWf=
"Insertaudio_16x16x32";pf.PFi="JotInsertAudioRecordingShort_32x32x32";pf.OFi="JotInsertAudioRecordingShort_16x16x32";pf.yfl="speechOn.wav";pf.xfl="speechOff.wav";Object(h.a)(pf,"DictationConstants",null,[]);class ei{constructor(z){this.wbf=z;this.vKa=(z=Yh.a.le(z))?z.displayName:this.wbf;this.SF=z?z.LCID:ei.lSj}get KUc(){return this.wbf}get displayName(){return this.vKa}get LCID(){return this.SF}}ei.lSj=1033;Object(h.a)(ei,"DictationLanguage",null,[]);class jj{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc){this.vtc=
null;this.O3e=!1;this.K$=null;this.kmb=!1;this.Ca=z;this.nY=Jf.App.TYa;this.Bqc=Jf.App.aZ;this.V0=la;this.hwc=U;this.Gf=Da;this.IO=Ia;this.ng=Ob;this.Hd=hc;this.ng.zK&&(this.K$=Db);this.mHh=sc}ub(){this.Ca.pa(ld.a.c$c,jd.a.view,Object(v.a)(this,this.c$c,"populateDictationLanguages"),96);this.Ca.pa(ld.a.YHe,jd.a.view,Object(v.a)(this,this.YHe,"setDictationLanguage"),1028);this.Ca.pa(ld.a.hBe,jd.a.view,Object(v.a)(this,this.hBe,"querySelectedDictationLanguage"),96);this.Ca.pa(ld.a.vmc,jd.a.view,Object(v.a)(this,
this.vmc,"toggleDictation"),1028);this.Ca.pa(ld.a.CAe,jd.a.view,Object(v.a)(this,this.CAe,"queryDictation"),96);this.Ca.pa(ld.a.jWf,jd.a.view,Object(v.a)(this,this.bCb,"onDictationError"),64);this.Ca.pa(ld.a.oWf,jd.a.view,Object(v.a)(this,this.bCb,"onDictationError"),64);this.Ca.pa(ld.a.rWf,jd.a.view,Object(v.a)(this,this.fjk,"onDictationRecordingStarted"),64);this.Ca.pa(ld.a.sWf,jd.a.view,Object(v.a)(this,this.gjk,"onDictationRecordingStopped"),64);this.Ca.pa(ld.a.pWf,jd.a.view,Object(v.a)(this,
this.ejk,"onDictationModifyRunLanguage"),64);this.Ca.pa(ld.a.lWf,jd.a.view,Object(v.a)(this,this.djk,"onDictationFocusLost"),64);this.Ca.pa(ld.a.uWf,jd.a.view,Object(v.a)(this,this.Fjk,"onFailedToInsertText"),64);this.Ca.pa(ld.a.qWf,jd.a.view,Object(v.a)(this,this.ijk,"onDictationTimeout"),64);this.Ca.pa(ld.a.M4g,jd.a.view,Object(v.a)(this,this.c$c,"populateDictationLanguages"),96);this.Ca.pa(ld.a.ZHe,jd.a.view,Object(v.a)(this,this.ZHe,"setDictationSettingsLanguage"),1028);this.Ca.pa(ld.a.DAe,jd.a.view,
Object(v.a)(this,this.DAe,"queryDictationSettingsLanguage"),96);this.Ca.pa(ld.a.SFi,jd.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Ca.pa(ld.a.TFi,jd.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Ca.pa(ld.a.RFi,jd.a.view,Object(v.a)(this,this.Cml,"toggleAutoPunctuation"),96);this.Ca.pa(ld.a.rCk,jd.a.view,Object(v.a)(this,this.BDk,"queryToggleAutoPunctuation"),96);this.Ca.pa(ld.a.UFi,jd.a.view,Object(v.a)(this,this.Pml,"toggleVoiceCommands"),96);this.Ca.pa(ld.a.sCk,
jd.a.view,Object(v.a)(this,this.DDk,"queryToggleVoiceCommands"),96);this.Ca.pa(ld.a.Wjd,jd.a.view,Object(v.a)(this,this.Wjd,"toggleDictationInFloatie"),1028);this.Ca.pa(ld.a.kWf,jd.a.view,Object(v.a)(this,this.cjk,"onDictationFloatieDismissed"),1028);this.Ca.pa(ld.a.NFi,jd.a.view,Object(v.a)(this,this.Amk,"onPauseDictationCommand"),96);this.Ca.pa(ld.a.MFi,jd.a.view,Object(v.a)(this,this.Djk,"onExitDictationCommand"),96);const z=Ua.KeyInputManager.Na(tg.a.bDh,1);this.Hd.Bc(Hd.AFrame.gj).bindAction(z,
ld.a.tWf);this.Ca.pa(ld.a.tWf,jd.a.view,Object(v.a)(this,this.hjk,"onDictationShortcut"),1028)}kLc(){return K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.Mp?this.ng.zK?pf.XFi:pf.QFi:this.ng.zK?pf.WFi:pf.LFi}CAe(z,U,la,Da,Ia){if(1===la)return 32;Ia&&(z=!!K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.Mp,this.K$?Ia[z?Hg.a.On:un.a.On]=this.K$.isVisible():(la=this.V0.SH(),la=(U=2===la)||1===la,z?(Ia[Hg.a.On]=la,Ia[Io.a.IconSet]=U?(new lh.a("JotInsertAudioRecordingShort_20")).iconSet:
K.AFrameworkApplication.Aa.gb.Mma?(new lh.a("InsertAudio_32")).iconSet:(new lh.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):(Ia[un.a.On]=la,U?(Ia[un.a.Image32by32Class]=Lg.getImageClass(pf.PFi),Ia[un.a.Image16by16Class]=Lg.getImageClass(pf.OFi)):(Ia[un.a.Image32by32Class]=Lg.getImageClass(pf.nWf),Ia[un.a.Image16by16Class]=Lg.getImageClass(pf.mWf)))));return 32}vmc(z,U,la){if(2===la)if(this.K$)this.Bwh();else return this.OTd();return 32}Wjd(z,U,la){return 2!==la?32:this.OTd()}c$c(z,U,la,
Da,Ia){if(1===la)return 32;this.bwk(Ia,z===ld.a.M4g);return 32}hBe(z,U,la,Da,Ia){if(1===la)return 32;Ia&&((z=Ia.MenuItemId)&&z===this.ng.YR?(Ia[Hg.a.On]=!0,this.vtc=Ia.SourceControlId):Ia[Hg.a.On]=!1);return 32}DAe(z,U,la,Da,Ia){if(1===la)return 32;Ia&&(Ia[pk.a.Value]=(new ei(this.ng.YR)).displayName);return 32}YHe(z,U,la,Da,Ia){if(1===la)return 32;Ia&&(z=Ia.SourceControlId,this.vtc!==z&&(this.ng.YR=Ia.MenuItemId,this.mBh(this.vtc),this.mBh(z),this.vtc=z,2===this.V0.SH()&&this.$T()));return 32}ZHe(z,
U,la,Da,Ia){if(1===la)return 32;if(Ia){z=Ia.MenuItemId;if(this.ng.YR!==z){this.ng.YR=z;if(this.K$)this.K$.onDictationLanguageChanged(z);2===this.V0.SH()&&this.$T()}this.vSe()}return 32}showHelpPane(z,U,la,Da,Ia){if(1===la)return 32;z=this.mHh.value;if(!z)return 0;Ia&&(Ia={},Ia.query="AssetID="+(this.ng.uxl?jj.wMh:jj.btd),Ia=Object.assign(new ni.a,{nonPersistedSettings:Ia}),z.sIa(jj.atd,Ia));return 32}Cml(z,U,la,Da,Ia){if(1===la)return this.ng.v7d?32:8;Ia&&this.ng&&(this.ng.useAutoPunctuation=Ia[Hg.a.On]);
2===this.V0.SH()&&this.$T();this.vSe();return 32}Pml(z,U,la,Da,Ia){if(1===la)return this.ng.Bae?32:8;Ia&&this.ng&&(this.ng.GJb=Ia[Hg.a.On]);2===this.V0.SH()&&(this.V0.$T(),this.mJb());this.NAh();return 32}BDk(z,U,la,Da,Ia){if(1===la)return 32;Ia&&this.ng&&(Ia[Hg.a.On]=this.ng.useAutoPunctuation);return 32}DDk(z,U,la,Da,Ia){if(1===la)return 32;Ia&&this.ng&&(Ia[Hg.a.On]=this.ng.GJb);return 32}cjk(z,U,la){2===la&&this.EHc();return 32}Amk(z,U,la){2===la&&this.ng.zK&&2===this.V0.SH()&&this.$T();return 32}Djk(z,
U,la){2===la&&this.ng.zK&&this.EHc();return 32}ZZh(){const z=Object.assign(new Lh.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),U=Object.assign(new Pa.a,{Id:"DictationLanguageList_"+this.kLc(),ExternalId:"DictationLanguageList_"+this.kLc(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.kLc(),QueryCommand:"2417470717",Image16by16Class:Lg.getImageClass(pf.mWf),Image32by32Class:Lg.getImageClass(pf.nWf),
Visible:!0,AriaLabel:Ub.a.w$h});Array.add(z.ControlList,U);return z}bwk(z,U){z.MenuItems=Object.assign(new Bh.a,{Id:U?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!U){var la=this.ZZh();Array.add(z.MenuItems.MenuSectionList,la)}la=this.ng.w7g;0<la.length&&(la=jj.ZEc(la,"dictationProdcutionLanguages","",U),Array.add(z.MenuItems.MenuSectionList,la));la=this.ng.r6g;0<la.length&&(U=jj.ZEc(la,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,
U),Array.add(z.MenuItems.MenuSectionList,U));z.PopulationXML=nm.l(z.MenuItems);this.O3e=!0}mJb(){const z=this.hwc.value;if(z){const U=this.kLc();if(K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.Mp){const la={};la[U]=this.ng.zK?"ToggleButtonModel":"SplitButtonModel";this.O3e&&!this.ng.zK&&(la["DictationLanguageList_"+U]="ToggleButtonModel");z.jJb(la)}this.vSe();this.NAh()}}vSe(){if(this.ng.zK){const z=this.hwc.value;K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.Mp&&z.jJb({DictationSettingsAutoPunctuation:"CheckboxModel"})}}NAh(){if(this.ng.zK){const z=
this.hwc.value;K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.Mp&&z.jJb({DictationSettingsVoiceCommands:"CheckboxModel"})}}mBh(z){const U=this.hwc.value;if(U&&K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.Mp){const la={};la[z]="ToggleButtonModel";U.jJb(la)}}bCb(z,U,la){2===la&&(this.ng.zK?this.EHc():this.$T());return 32}Fjk(z,U,la){2===la&&this.$T();return 32}fjk(z,U,la){2===la&&this.mJb();return 32}gjk(z,U,la){2===la&&(this.V0.$T(),this.mJb());return 32}ejk(z,U,la,Da,Ia){2===
la&&Ia&&(z=Yh.a.le(this.ng.YR),this.Gf.tjc(this.IO.Bs(Ia),z.LCID,Ia.Kb));return 32}djk(z,U,la){2===la&&this.$T();return 32}ijk(z,U,la){2===la&&this.$T();return 32}Bwh(){this.kmb||(this.kmb=!0,this.K$.isVisible()?(this.EHc(),this.kmb=!1):this.showFloatie(),this.mJb())}showFloatie(){this.K$.showFloatie((new ei(this.ng.YR)).displayName).then(()=>{0===this.V0.SH()&&this.V0.ugb().then(()=>{this.kmb=!1}).catch(z=>{this.kmb=!1;e.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",z)});this.ng.r3b&&
this.nY&&this.nY.ugl();this.Bqc&&this.Bqc.startSession()}).catch(()=>{this.kmb=!1})}OTd(){const z=this.V0.SH();if(1===z||3===z)return 1;0===z?this.ugb():this.$T();return 32}EHc(){const z=this.V0.SH();1!==z&&(this.K$&&this.K$.hideFloatie(),this.nY&&this.nY.jhl(),0!==z&&this.$T(),this.Bqc&&this.Bqc.endSession(),this.mJb())}$T(){this.V0.$T();this.mJb()}ugb(){this.V0.ugb().then(()=>{}).catch(z=>{e.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",z)})}hjk(z,U,la){return 2===la&&this.ng&&
this.ng.JEj?this.ng.zK&&this.K$&&!this.K$.isVisible()?(this.Bwh(),32):this.OTd():32}static createInstance(z,U,la,Da,Ia,Db,Ob,sc){return jj.Ja||(jj.Ja=new jj(K.AFrameworkApplication.Ta,z,U,la,Da,Ia,Db,Ob,sc))}static ZEc(z,U,la,Da){la=Object.assign(new Lh.a,{DisplayMode:"Menu",Title:la,Id:U,ControlsId:"ctr"+U,ControlList:[]});for(const Ia of z){z=U+"_"+Ia.KUc;const Db=Ia.displayName,Ob=Ia.KUc;Da?(z=Object.assign(new aq.a,{Id:z,ExternalId:z,LabelText:Db,Command:"3662249320",MenuItemId:Ob,Visible:!0}),
Array.add(la.ControlList,z)):(z=Object.assign(new Pa.a,{Id:z,ExternalId:z,LabelText:Db,Command:"2863762275",MenuItemId:Ob,QueryCommand:"2739750502",Visible:!0,AriaLabel:Ub.a.xnb}),Array.add(la.ControlList,z))}return la}}jj.Ja=null;jj.atd="FA000000012";jj.btd="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";jj.wMh="78766431-0933-4603-abf5-5bcc1dee9dda";Object(h.a)(jj,"DictationActor",null,[604]);var Vm=d(268),to=d(1078),Wm=d(153);class Ql{constructor(z,U){this.oY=null;this.U$=!1;this.nKa=null;this.eKh=z;this.ng=
U}isVisible(){return this.U$}XQc(){return this.U$&&!!this.oY}hLi(){if(this.oY)return!0;this.oY=this.eKh.value;if(!this.oY)return!1;this.oY.XDl(ld.a.Wjd);this.oY.RDl(ld.a.kWf);Dg.a.addHandler(window.self,rb.a.resize,()=>{this.Tpj()});const z=rc.FocusManager.instance().Bc(Wm.AppFrame.D4a);z.zaa(U=>{this.eTi(U)});z.uza((U,la)=>{this.dTi(la)});z.IK=!0;z.gFe=!0;Vm.a.instance.p1(Wm.AppFrame.D4a,!0);Vm.a.instance.qo(Wm.AppFrame.D4a);return!0}eTi(z){this.XQc()&&z.name!==Hd.AFrame.dO&&this.oY.focus()}dTi(z){this.XQc()&&
z.name!==Hd.AFrame.dO&&this.oY.blur()}showFloatie(z){return this.U$?Promise.resolve(null):this.hLi()?new Promise((U,la)=>{this.oY.VCl().then(()=>{this.oY.showDictationFloatie(this.FLc(),!1,z,this.ng.useAutoPunctuation);this.nKa=z;this.U$=!0;Vm.a.instance.TJ(Wm.AppFrame.D4a);U(null)}).catch(()=>{la("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.XQc()&&(this.oY.dismissDictationFloatie(),Vm.a.instance.qo(Wm.AppFrame.D4a),this.U$=
!1)}showDictationWarning(z){this.XQc()&&this.oY.showDictationWarning(z)}onDictationLanguageChanged(z){this.nKa=z}FLc(){var z=Jf.App.Fb.J4a.getBoundingClientRect();const U=z.left+z.width/2-44;z=z.top+z.height-70;return Object.assign(new to.a,{x:U,y:z})}Tpj(){this.U$&&this.oY&&(this.oY.dismissDictationFloatie(),this.oY.showDictationFloatie(this.FLc(),!1,this.nKa,this.ng.useAutoPunctuation))}}Object(h.a)(Ql,"DictationFloatieManager",null,[]);class Lj{constructor(){this.aga=this.vya=0;this.Zqc=null;this.W$=
!0;this.soc="";this.ng=this.Ah=null;this.wya=this.baa=this.HKa=this.Zs=this.Bj=0;this.yrd=this.hY="";this.dQb=this.jLb=0;this.Srd=this.isd=this.hsd=!1;this.hCd="";this.MPb=this.KMb=this.Qh=this.U0=null;this.fqd=this.Wtc=this.Vtc=this.JDd=this.lxf=this.d2a=this.b2a=0}set msi(z){this.hY=z}get cwa(){return Jf.App.aZ?Jf.App.aZ.cwa:""}get gZa(){return Jf.App.aZ?Jf.App.aZ.gZa:""}set gZa(z){Jf.App.aZ&&(Jf.App.aZ.gZa=z)}onFragment(z){this.HKa||(this.HKa=(new Date).getTime());this.KMb&&(this.KMb.stop(),this.b2a+=
this.KMb.Dq,this.KMb.start());this.vya++;this.wya+=z.split(" ").length}onFinalPhrase(z){this.HKa||(this.HKa=(new Date).getTime());this.MPb&&(this.MPb.stop(),this.d2a+=this.MPb.Dq,this.MPb.start());this.wya=0;this.aga++;this.baa+=z.split(" ").length}onConnectionStarted(z){this.jLb=(new Date).getTime();this.msi=z;this.Qh&&(this.KMb=this.Qh.wi("WebServiceCall","FragmentResponse"),this.MPb=this.Qh.wi("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.dQb=(new Date).getTime()}onMicrophoneError(z){this.onCustomError("MicrophoneError",
z)}onCustomError(z,U=null){this.W$=!1;this.Zqc=z;this.setEndReason(U||z)}setEndReason(z){this.yrd=z}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(z,U){this.fqd=U;z?(this.JDd+=U,U>this.Wtc&&(this.Wtc=U)):(this.lxf=U,U>this.Vtc&&(this.Vtc=U))}onFocusLost(){this.hsd=!0}onFocusLostWhileStarting(){this.isd=!0}onFailedToStartTurn(){this.Srd=!0}onSpeechSessionStarted(z){this.hCd=z}setDictationLatency(z){this.U0=z}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(h.a)(Lj,"AbstractDictationSessionTelemetry",null,[677]);class Ri{}Ri.seen="Seen";Ri.tried="Tried";Ri.kept="Kept";Object(h.a)(Ri,"FunnelStatus",null,[]);class Mj{constructor(){this.dataFields=this.name=null}}Object(h.a)(Mj,"Contract",null,[]);class Qk extends Lj{constructor(z,U){super();this.lYe=this.kYe=this.lWe=!1;this.Wwd=this.Rwd=this.aAd=0;this.fxd=this.exd=2147483647;this.IDd=this.GDd=0;this.ng=z;this.Bj=(new Date).getTime();this.Qh=U;this.gZa=D.a.create().toString();this.Ah=new De.a;
this.Ah.dataFields=[];this.soc="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(z,U,la){z=z+this.fqd-(this.aAd+(U+la)/1E4);this.GDd+=z;this.Rwd<z&&(this.Rwd=z);this.exd>z&&(this.exd=z)}onPartialResultAnnotationResponse(z,U,la){z=z+this.fqd-(this.aAd+(U+la)/1E4);this.IDd+=z;this.Wwd<z&&(this.Wwd=z);this.fxd>z&&(this.fxd=z)}setRecordingStartTime(z){this.aAd=z}onCommandCalled(){this.kYe=!0}onAugloopError(z){this.W$=!1;this.lWe=!0;this.Zqc=z}onCommandError(){this.lYe=!0}endActivity(){this.baa+=
this.wya;this.Zs=(new Date).getTime();this.Ah.succeeded=this.W$;this.Ah.durationMs=this.Zs-this.Bj;Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"Success",bool:this.W$}));this.W$||Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"error",string:this.Zqc}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"SessionID",string:this.cwa}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"SpeechSessionID",string:this.hCd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,
{name:"TurnID",string:this.gZa}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"NumberOfWords",int64:0<this.wya?this.wya+this.baa:this.baa}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"NumberOfFragments",int64:this.vya}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"NumberOfFinalPhrases",int64:this.aga}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"Language",string:this.ng.YR}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"connectionID",
string:this.hY}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"IsUsingFloatie",bool:this.ng.zK}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"UseAutoPunctuation",bool:this.ng.useAutoPunctuation}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"EndReason",string:this.yrd}));this.HKa&&Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"TimeToGetFirstResult",int64:this.HKa-
this.jLb}));this.W$&&(Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"TimeToStartRecording",int64:this.dQb-this.Bj})),Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"TimeToOpenConnection",int64:this.jLb-this.dQb})));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"FocusLost",bool:this.hsd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"FocusLostWhileStarting",bool:this.isd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"FailedToStartTurn",
bool:this.Srd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"MaxTimeToInsertFragment",int64:this.Vtc}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"MaxTimeToInsertPhrase",int64:this.Wtc}));var z=Ri.seen;this.W$&&0<this.baa&&(z=0<this.aga?Ri.kept:Ri.tried);Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"DictationFunnel",contract:Object.assign(new Mj,{name:"Office.System.Funnel",dataFields:[Object.assign(new nf.a,{name:"Name",string:"Dictation"}),Object.assign(new nf.a,
{name:"State",string:z})]})}));this.Ah.name=this.soc;this.Ah.samplingPolicy=2;Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"AugloopFailed",bool:this.lWe}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"CommandsUsed",bool:this.kYe}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"CommandsFailed",bool:this.lYe}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.Rwd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.exd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.Wwd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.fxd}));z=0<this.aga?this.GDd/this.aga:0;const U=0<this.vya?this.IDd/this.vya:0;Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"AverageFinalResultUserPerceivedLatency",double:z}));Array.add(this.Ah.dataFields,
Object.assign(new nf.a,{name:"AveragePartialResultUserPerceivedLatency",double:U}));Fd.a.sendActivityEvent(this.Ah)}}Object(h.a)(Qk,"AugloopDictationTelemetry",Lj,[]);var vn=d(211);class hp{constructor(z){this.w5=z}play(){this.w5.play()}pause(){this.w5.pause()}get paused(){return this.w5.paused}get currentTime(){return this.w5.currentTime}set currentTime(z){this.w5.currentTime=z}get duration(){return this.w5.duration}get error(){const z=this.w5.error;return z?z.code:0}get readyState(){return this.w5.readyState}get src(){return this.w5.getAttribute("src")}set src(z){this.w5.setAttribute("src",
z)}get preload(){return this.w5.getAttribute("preload")}set preload(z){this.w5.setAttribute("preload",z)}get Tf(){return this.w5}}Object(h.a)(hp,"AudioElement",null,[]);class rm{constructor(){this.Xxd=this.Wxd=this.d2a=this.b2a=this.Uqd=0}onAudioData(){this.Uqd||(this.Uqd=(new Date).getTime())}onFragment(z){this.b2a+=this.Qeg(z);this.Wxd++}Cmk(z){this.d2a+=this.Qeg(z);this.Xxd++}B6f(){return this.Xxd?this.d2a/this.Xxd:0}gYi(){return this.Wxd?this.b2a/this.Wxd:this.B6f()}Qeg(z){if(!z)return 0;const U=
(new Date).getTime();let la=null;return({Hv:la}=M.d(z)).returnValue?U-this.Uqd-(la.Offset+la.Duration)/1E4:0}}Object(h.a)(rm,"DictationLatency",null,[]);class El{constructor(z,U){this.I5=0;this.fCd=this.gCd=null;this.aOb=!1;this.buc=null;this.Hsc=!1;this.U0=this.Cq=null;this.NF=U;this.P$=z}onFinalText(z,U){if(2===this.I5){var la=z.size;if(1!==la&&(e.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",la),!la))return;U=U.get("JsonResult");this.U0&&this.U0.Cmk(U);this.NF.onFinalPhrase(z.values().next().value,
U)}}onFragmentText(z,U){if(2===this.I5){var la=z.size;if(1!==la&&(e.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",la),!la))return;U=U.get("JsonResult");if(this.U0)this.U0.onFragment(U);this.NF.onFragment(z.values().next().value)}}onError(z){if(0!==this.I5&&3!==this.I5&&"ErrorNone"!==z){this.I5=3;switch(z){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.NF.Jgk(z);
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.NF.Cik(z);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.NF.vL(z);break;case "ErrorInitialSilenceTimeout":this.NF.Pkk(z);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.NF.onMicrophoneError(z);break;
case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.NF.gve("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.NF.gve("NotFoundError");break;case "ErrorAudioNotReadableError":this.NF.gve("NotReadableError");break;default:this.NF.upk(z)}this.I5=0}}onSpeechRecognitionStarted(z){window.self.document.hasFocus()?(this.I5=2,this.aOb=!1,this.NF.onRecordingStarted(),this.NF.onConnectionStarted(z),this.gCd||
(this.gCd=Object.assign(new hp(document.createElement("audio")),{src:vn.a.box4Image(pf.yfl)})),this.gCd.play()):(this.bSe(),this.NF.onFocusLost())}onSpeechEnd(){this.bSe();0!==this.SH()&&(this.I5=3,this.NF.cnk(),this.I5=0,this.fCd||(this.fCd=Object.assign(new hp(document.createElement("audio")),{src:vn.a.box4Image(pf.xfl)})),this.fCd.play())}onAudioData(z){if(this.U0)this.U0.onAudioData();if(this.P$){var U=0;for(const la of z)U+=Math.pow(la,2);z=Math.sqrt(U/z.length)>El.lfl;!this.aOb&&z?(this.aOb=
!0,this.buc=null):this.aOb&&!z&&(this.buc?(new Date).getTime()>=this.buc+El.Lck&&(this.aOb=!1):this.buc=(new Date).getTime())}}onSpeechSessionStarted(z){this.NF.onSpeechSessionStarted(z)}onEventUpdate(z){if(this.P$&&"QualityStatusUpdate"===z.eventName)switch(z.shortCode){case 13:case 2:this.P$.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.P$.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.P$.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}BYa(z,
U){this.NF.WOa(!1);this.NF.hx=z;this.NF.Zqg=U;this.VKk();this.Cq=z;this.I5=1;this.U0=new rm;this.Cq&&this.Cq.setDictationLatency(this.U0)}SH(){return this.I5}VKk(){this.Hsc||(Dg.a.addHandler(window.self,rb.a.blur,Object(v.a)(this,this.yYg,"onFocusLostEventHandler")),this.Hsc=!0)}bSe(){this.Hsc&&(Dg.a.removeHandler(window.self,rb.a.blur,Object(v.a)(this,this.yYg,"onFocusLostEventHandler")),this.Hsc=!1)}yYg(){if(1===this.I5){if(this.Cq)this.Cq.onFocusLostWhileStarting()}else 2===this.I5&&(this.bSe(),
this.NF.onFocusLost())}}El.lfl=350;El.Lck=350;Object(h.a)(El,"FrontdoorSpeechClientObserver",null,[679]);class wn extends El{constructor(z,U){super(z,U);this.IKa=new El(z,U)}onFinalText(z,U){this.IKa.onFinalText(z,U)}onFragmentText(z,U){this.IKa.onFragmentText(z,U)}onError(z){this.IKa.onError(z)}onSpeechRecognitionStarted(z){this.IKa.onSpeechRecognitionStarted(z)}onSpeechEnd(){this.IKa.onSpeechEnd()}onAudioData(z){this.IKa.onAudioData(z)}BYa(z,U){this.IKa.BYa(z,U)}SH(){return this.IKa.SH()}}Object(h.a)(wn,
"AugloopFrontdoorSpeechObserverAbstractDecorator",El,[]);class Yn extends wn{constructor(z,U,la){super(z,U);this.Pc=la}onFinalText(z,U){super.onFinalText(z,U)}onFragmentText(z,U){if(this.C$d())super.onFragmentText(z,U)}onError(z){super.onError(z)}onSpeechRecognitionStarted(z=null){const U=D.a.create().toString();super.onSpeechRecognitionStarted(z?z:U)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(z){super.onAudioData(z)}BYa(z,U){super.BYa(z,U)}SH(){return super.SH()}C$d(){const z=this.Pc.Oa.kb.Ua;
return z.Kb!==z.Qa?!1:!0}}Object(h.a)(Yn,"AugloopFrontdoorSpeechObserverDecorator",wn,[]);class td{constructor(z){this.Pyf=z}onVoiceCommand(z){this.Pyf.onVoiceCommand(z)}setDictationSessionTelemetry(z){this.Pyf.setDictationSessionTelemetry(z)}}Object(h.a)(td,"AugloopVoiceCommandObserverAbstractDecorator",null,[676]);class Kd extends td{constructor(z,U,la){super(z);this.R0=U;this.Pc=la}onVoiceCommand(z){this.C$d()&&this.R0.hEl();super.onVoiceCommand(z)}setDictationSessionTelemetry(z){super.setDictationSessionTelemetry(z)}C$d(){const z=
this.Pc.Oa.kb.Ua;return z.Kb!==z.Qa?!1:!0}}Object(h.a)(Kd,"AugloopVoiceCommandObserverDecorator",td,[]);class Pd{constructor(z){this.ng=z}HAg(z){const U=K.AFrameworkApplication.He;if(U){var la=this.ng.o5f;la&&""!==la&&U.vj(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",la),2,z,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(h.a)(Pd,"FrontdoorCorrectionsTelemetryLogger",null,[678]);class ad{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(h.a)(ad,"SpeechDictationSettings",null,[]);class ae{constructor(z,U,la,Da){this.Tqd=this.Zx=null;this.R0=z;this.P$=U;this.NF=la;this.Uib=Da;this.initializeCommandsDictionary()}onVoiceCommand(z){if(this.Tqd)this.Tqd.onCommandCalled();var U=4;if(({value:U}=this.Zx.Of(z.commandId,0)).returnValue&&4!==U){let la=null;z.commandValue&&(la=new m.a(n.a.Qr()),la.add("commandValue",z.commandValue));this.NF.WOa(!1);U=this.R0.executeCommand(U,la);if(z.offset&&
z.duration)this.Uib.onCommandFinished(z.commandId,U,z.offset,z.duration)}}setDictationSessionTelemetry(z){this.Tqd=z}initializeCommandsDictionary(){this.Zx=new m.a(n.a.Qr());this.Zx.add("Word.Editing.Undo",2);this.Zx.add("Word.Editing.Bold",5);this.Zx.add("Word.Editing.Italics",6);this.Zx.add("Word.Editing.Underline",10);this.Zx.add("Word.Editing.StrikeThrough",20);this.Zx.add("Word.Editing.Subscript",19);this.Zx.add("Word.Editing.Superscript",18);this.Zx.add("Word.Editing.RemoveBold",11);this.Zx.add("Word.Editing.RemoveUnderline",
13);this.Zx.add("Word.Editing.RemoveItalics",12);this.Zx.add("Word.Editing.RemoveStrikeThrough",21);this.Zx.add("Word.Editing.RemoveSubscript",22);this.Zx.add("Word.Editing.RemoveSuperscript",24);this.Zx.add("Word.Editing.Paste",7);this.Zx.add("Word.Editing.InsertTable",8);this.Zx.add("Word.Editing.InsertComment",9);this.Zx.add("Word.Editing.InsertBullet",23);this.Zx.add("Word.Editing.FullJustify",14);this.Zx.add("Word.Editing.CenterJustify",15);this.Zx.add("Word.Editing.LeftJustify",16);this.Zx.add("Word.Editing.RightJustify",
17);this.Zx.add("Command.Exit",1);this.Zx.add("Command.Pause",0);this.Zx.add("Command.ShowHelp",26);this.Zx.add("Command.ShowCommand",27);this.Zx.add("Word.Editing.RemoveFormatting",28)}}Object(h.a)(ae,"VoiceCommandObserver",null,[676]);var rg=d(940);class bm{constructor(z,U,la,Da,Ia,Db,Ob){this.Cq=this.ZRb=null;this.Mtj=0;this.Uib=Ia;this.ng=Ob;Ia=new ad;Ia.dictationLanguage=Ob.YR;Ia.useAutoPunctuation=Ob.useAutoPunctuation?"Intelligent":"Explicit";Ia.useCorrections=Ob.r3b.toString();alVoiceClient.DictationSettingsManager.dictationSettings=
Ia;this.j6=new Yn(z,Db,Da);this.Qyf=new Kd(new ae(U,z,Db,this.Uib),U,Da);this.Soc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.OVe=Array(la);this.Soc.setAnnotationResultCallback(Object.assign(new rg.a,{handler:sc=>{for(const hc of this.OVe)hc.onAnnotationResult(sc)}}));this.dRb=new alVoiceClient.SpeechToTextClient(this.Soc,this.j6,Ob.Hhb||Ob.Yld,!1);this.eAf(this.dRb.getAnnotationObserver());this.YRb=new alVoiceClient.VoiceCommandingClient(this.Soc,this.Qyf,this.j6);this.eAf(this.YRb.getAnnotationObserver());
Ob.r3b&&(z=new Pd(Ob),(U=Jf.App.TYa)&&U.hbh(z))}Zlg(z,U){return new Promise(la=>{const Da=new ad;Da.dictationLanguage=z;Da.useAutoPunctuation=this.ng.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=Da;this.Cq=U;la(this.Zwj())})}ugb(z){if(!this.dRb)return 3;this.ZRb.startVoiceSessionFromMicrophoneInput();this.j6.BYa(this.Cq,z);z=this.ng.GJb;this.dRb.initializeAsync(z?[1]:[1,0],this.Cq);z&&this.Ygl();return 0}$T(z){if(z&&this.j6)this.j6.onSpeechEnd();
this.dRb&&this.dRb.uninitializeAsync();this.ZRb&&(this.ZRb.stopVoiceSession(),this.ZRb=null);this.Cq=null;this.ng.GJb&&this.whl()}SH(){return this.j6.SH()}Zwj(){this.ng.GJb&&this.Qyf.setDictationSessionTelemetry(this.Cq);this.ZRb=new alVoiceClient.VoiceSession(this.Soc,this.j6,this.ng.Hhb,this.Uib,this.Cq);return 0}Ygl(){this.YRb&&this.YRb.initializeAsync(this.Cq)}whl(){this.YRb&&this.YRb.uninitializeAsync()}eAf(z){this.OVe[this.Mtj++]=z}}Object(h.a)(bm,"AugloopSpeechClientProxy",null,[636]);class sh extends Lj{constructor(z,
U){super();this.ng=z;this.Bj=(new Date).getTime();this.Qh=U;this.gZa=D.a.create().toString();this.Ah=new De.a;this.Ah.dataFields=[];this.soc="Office.Voice.Online.DictationSession"}endActivity(){this.baa+=this.wya;this.Zs=(new Date).getTime();this.Ah.succeeded=this.W$;this.Ah.durationMs=this.Zs-this.Bj;Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"Success",bool:this.W$}));this.W$||Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"error",string:this.Zqc}));Array.add(this.Ah.dataFields,
Object.assign(new nf.a,{name:"SessionID",string:this.cwa}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"SpeechSessionID",string:this.hCd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"TurnID",string:this.gZa}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"NumberOfWords",int64:0<this.wya?this.wya+this.baa:this.baa}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"NumberOfFragments",int64:this.vya}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,
{name:"NumberOfFinalPhrases",int64:this.aga}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"Language",string:this.ng.YR}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"connectionID",string:this.hY}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"IsUsingFloatie",bool:this.ng.zK}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"UseAutoPunctuation",bool:this.ng.useAutoPunctuation}));
Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"EndReason",string:this.yrd}));this.HKa&&Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"TimeToGetFirstResult",int64:this.HKa-this.jLb}));this.W$&&(Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"TimeToStartRecording",int64:this.dQb-this.Bj})),Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"TimeToOpenConnection",int64:this.jLb-this.dQb})));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"FocusLost",
bool:this.hsd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"FocusLostWhileStarting",bool:this.isd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"FailedToStartTurn",bool:this.Srd}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"AverageFragmentLatency",double:this.U0?this.U0.gYi():0<this.vya?this.b2a/this.vya:0}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"AveragePhraseLatency",double:this.U0?this.U0.B6f():0<this.aga?this.d2a/this.aga:0}));
Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"AveragePhraseInsertionLatency",double:0<this.aga?this.JDd/this.aga:0}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"AverageFragmentInsertionLatency",double:0<this.vya?this.lxf/this.vya:0}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"MaxTimeToInsertFragment",int64:this.Vtc}));Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"MaxTimeToInsertPhrase",int64:this.Wtc}));let z=Ri.seen;this.W$&&0<this.baa&&
(z=0<this.aga?Ri.kept:Ri.tried);Array.add(this.Ah.dataFields,Object.assign(new nf.a,{name:"DictationFunnel",contract:Object.assign(new Mj,{name:"Office.System.Funnel",dataFields:[Object.assign(new nf.a,{name:"Name",string:"Dictation"}),Object.assign(new nf.a,{name:"State",string:z})]})}));this.Ah.name=this.soc;this.Ah.samplingPolicy=2;Fd.a.sendActivityEvent(this.Ah)}}Object(h.a)(sh,"DictationSessionTelemetry",Lj,[]);var Xm=d(1111);class Gj{constructor(z,U){this.wuc=z;this.zNh=U}getAccessToken(z){this.zNh&&
this.wuc?this.wuc.q0("OfficeDictation",K.AFrameworkApplication.fa.Ha("DictationResourceID")).then(U=>{U.IsSuccess?z(U.Token):z(Gj.mSd)}).catch(()=>{z(Gj.mSd)}):z(Gj.mSd)}}Gj.mSd="dictation access token";Object(h.a)(Gj,"AuthenticationProvider",null,[]);class oi{constructor(z){this.GNh=z;this.Zxc=new Jl.a}debugAssertTag(z,U,la,Da){this.Qmd(Da);this.Zxc.debugAssertTag(z,U,la,Da)}debugTraceTag(z,U,la,Da){this.Qmd(Da);this.Zxc.debugTraceTag(z,U,la,Da)}sendTraceTag(z,U,la,Da){this.Qmd(Da);this.Zxc.sendTraceTag(z,
U,la,Da)}shipAssertTag(z,U,la,Da){this.Qmd(Da);this.Zxc.shipAssertTag(z,U,la,Da)}Qmd(z){if(this.GNh){const U=window.console;U&&U.log(String.format("FDSpeechService: {0}",z))}}}Object(h.a)(oi,"FrontdoorExternalLogger",null,[198]);class qk{constructor(){this.accessToken=null}}Object(h.a)(qk,"IAuthenticationProvider",null,[]);class ek{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=
0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(h.a)(ek,"ISpeechConfig",null,[]);class xn{constructor(z,U,la,Da,Ia){this.Cq=this.Rlb=null;this.uCd=!1;this.j6=new El(la,Da);this.wU=z;this.ng=U;this.DHh=new Gj(Ia,U.IEj);this.ng.r3b&&(z=new Pd(U),(U=Jf.App.TYa)&&U.hbh(z))}Zlg(z,U){return new Promise(la=>{this.DHh.getAccessToken(Da=>{la(this.Bwj(z,U,Da))})})}Bwj(z,U,la){this.Cq=U;z=this.AOd(z);la=Object.assign(new qk,
{accessToken:la});U=new oi(this.ng.ERc);this.Rlb=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(z,this.j6,la,null,U);return this.Rlb?0:(e.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}ugb(z){if(!this.Rlb)return 3;this.j6.BYa(this.Cq,z);this.Rlb.startSpeechRecognition();return 0}$T(z){if(!this.uCd){this.uCd=!0;if(this.Rlb)try{this.Rlb.stopSpeechRecognition()}catch(U){e.ULS.shipAssertTag(593277727,394,!1,U.message)}if(z&&this.j6)this.j6.onSpeechEnd();
this.Cq=null;this.uCd=!1}}SH(){return this.j6.SH()}AOd(z){const U=new ek;U.speechMode="Dictation";U.sourceLanguage=z;(z=this.ng.o5f)&&""!==z&&(U.speechFDBase=String.format("wss://{0}/",z));U.properties=new Map;this.wU&&(U.properties.set("DictationInsertionPointLeft",this.wU.zeg()),U.properties.set("DictationInsertionPointRight",this.wU.$ej()));U.properties.set("Corrections","true");U.properties.set("punctuation",this.ng&&this.ng.useAutoPunctuation?"Intelligent":"Explicit");this.ng.ERc&&U.properties.set("EnableAudioLogging",
this.ng.ERc.toString());switch(Xm.a.DHd){case "Word":U.clientApp=1;break;case "PowerPoint":U.clientApp=0;break;case "OneNote":U.clientApp=2}return U}}Object(h.a)(xn,"FrontdoorSpeechClientProxy",null,[636]);class rk{static tal(){rk.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static Tal(){rk.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static gcl(z){rk.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
z)}static pdl(){rk.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(z,U){rk.tf||(rk.tf=new Zb.StandardDialog,rk.tf.hr=K.AFrameworkApplication.Xba,rk.tf.vd=0,rk.tf.Re(1,CommonUIStrings.l_DialogClose),rk.tf.mO(z,U,()=>{rk.tf=null}))}}rk.tf=null;Object(h.a)(rk,"Dialogs",null,[]);class Rl{constructor(z,U,la,Da,Ia,Db,Ob,sc){this.Lkb=this.pmb=!1;this.hx=null;this.wU=z;this.Zqg=U;this.Ca=la;this.bKa=Da;this.ng=Ia;this.R0=Db;
this.gLb=Ob;this.P$=sc;this.wqf=new L.a;for(z=0;z<Rl.vqf.length;z++)this.wqf.add(Rl.vqf.charAt(z).toString())}onFinalPhrase(z,U=null){let la=!0;if(this.hx)this.hx.onFinalPhrase(z);if(this.gLb&&this.R0){var Da=this.gLb.oDl(z);if(Da){this.WOa(!1);this.R0.executeCommand(Da.commandId,null);return}}Da=(new Date).getTime();if(1===z.length&&"\n"===z)this.F2d("",null),this.r0f();else{let Ia=z.indexOf("\n");for(0<Ia&&Ia!==z.length-1&&(la=!1);0<=Ia;)this.F2d(z.substr(0,Ia),la?U:null),this.r0f(),z=z.substr(Ia+
1),Ia=z.indexOf("\n"),la=!1;this.F2d(z,la?U:null)}z=(new Date).getTime();if(this.hx)this.hx.onTextInserted(!0,z-Da)}onFragment(z){if(this.pmb)var U=this.CNc(z);else{if(!this.Thd())return;U=this.Lkb?this.CNc(z):z}if(this.hx)this.hx.onFragment(z);z=!0;const la=(new Date).getTime();this.wU&&!this.wU.G8h(U)&&(this.Zgg(),z=!1);U=(new Date).getTime();if(this.hx)this.hx.onTextInserted(!1,U-la);z&&this.R0&&this.R0.iDl()}onRecordingStarted(){this.Ca.processAction(ld.a.rWf,2);if(this.hx)this.hx.onRecordingStarted()}onMicrophoneError(z=
""){this.rhg(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,z)}bCb(z){if(this.hx)this.hx.onCustomError(z);this.Ca.Ka(ld.a.jWf,2,z)}Jgk(z){this.bCb(z);rk.tal()}Cik(z){this.bCb(z);rk.Tal()}upk(z){this.bCb(z);rk.pdl()}vL(z){this.hx&&this.hx.setEndReason(z);this.Ca.Ka(ld.a.qWf,2,z)}Pkk(z){this.vL(z);this.Ucl()}cnk(){this.WOa(!1);this.Ca.processAction(ld.a.sWf,2)}onConnectionStarted(z){if(this.hx)this.hx.onConnectionStarted(z)}gve(z){this.rhg(this.b7i(z),z)}onFocusLost(){if(this.hx)this.hx.onFocusLost();
this.Ca.processAction(ld.a.lWf,2)}FNj(z){return this.Zqg&&!I.a.Dae(z)&&!this.wqf.contains(z.toString())}CNc(z){return 0<z.length&&this.FNj(z.charAt(0))?" "+z:z}Thd(){if(this.pmb)return!0;if(this.wU){const z=this.wU.zeg();this.Lkb=!1;z&&0<z.length&&(this.Lkb=!I.a.Dae(z.charAt(z.length-1))&&!z.endsWith("\u201c"));return this.pmb=this.wU.Thd()}if(this.hx)this.hx.onFailedToStartTurn();this.R0&&this.R0.kDl();return!1}WOa(z){this.Lkb=this.pmb=!1;this.wU&&(z&&this.wU.ldk(),this.wU.WOa())}onSpeechSessionStarted(z){if(this.hx)this.hx.onSpeechSessionStarted(z);
this.ng.ERc&&this.iLe(z)}rhg(z,U=""){if(this.hx)this.hx.onMicrophoneError(U);this.Ca.processAction(ld.a.oWf,2);rk.gcl(z)}b7i(z){z=z.trimStart();return z.startsWith("NotAllowedError")||z.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:z.startsWith("NotFoundError")||z.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:z.startsWith("NotReadableError")||z.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:
Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}Ucl(){this.bKa&&this.bKa.execute(z=>{z.gbl()})}iLe(z){this.bKa&&this.bKa.execute(U=>{U.iLe(String.format("ServiceSessionID:{0} ClientSessionId: {1}",z,this.wni))})}F2d(z,U){if(this.pmb||this.Thd()){if(this.wU){const la=this.Lkb?this.CNc(z):z;(this.ng.r3b&&Object(yh.a)(635,this.wU)?this.wU.XCl(la,U,0<z.length&&z.charAt(0)!==la.charAt(0)):this.wU.gzj(this.Lkb?this.CNc(z):z))||this.Zgg()}this.WOa(!0)}}Zgg(){if(this.hx)this.hx.onTextInsertionError();
this.Ca.processAction(ld.a.uWf,2)}r0f(){this.Ca.processAction(ld.a.SA,2)}get wni(){return Jf.App.aZ?Jf.App.aZ.cwa:""}}Rl.vqf='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(h.a)(Rl,"SpeechClientObserverController",null,[]);class Zn{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc,md){this.gLb=this.R0=this.P$=this.Cq=this.pMa=null;this.yv=z;this.fKh=U;this.Pc=la;this.bKa=Da;this.Qh=Ia;this.ng=Db;this.wuc=Xc;this.auf=md;this.ng.zK&&(this.P$=Ob);if(this.ng.psg||this.ng.Hhb)this.R0=
sc;this.ng.psg&&(this.gLb=hc);this.Uib=Fc}ugb(){this.bKa&&this.bKa.execute(z=>{z.Vrj()});return new Promise((z,U)=>{this.pMa?this.C0f(z,U):this.cUj().then(()=>{var la=this.fKh.value;la?(la=la.Bwi(),this.pMa=this.LAi(la),this.C0f(z,U)):U(4)}).catch(()=>{U(2)})})}C0f(z,U){this.BYa().then(la=>{0===la?z(0):U(la)}).catch(la=>{U(la)})}BYa(){return new Promise((z,U)=>{this.Cq=new sh(this.ng,this.Qh);if(this.ng.Yld||this.ng.Hhb)this.Cq=new Qk(this.ng,this.Qh);this.pMa.Zlg(this.ng.YR,this.Cq).then(la=>{0!==
la?z(la):z(this.pMa.ugb(this.jyg()))}).catch(la=>{U(la)})})}cUj(){return this.ng.Yld||this.ng.Hhb?this.jAg("alVoiceClient",!0):this.jAg("PPTSpeechClient")}jAg(z,U=!1){return!U&&this.auf&&K.AFrameworkApplication.Aa.gb.Qsg?(U=K.AFrameworkApplication.Fk(z,2),Kl.a(this.auf.hwb(U))):this.yv?this.yv.loadScript(z):new Promise((la,Da)=>{Da("Unable to load speech client "+z)})}$T(z=!0){0!==this.SH()&&(this.pMa&&this.pMa.$T(z),this.Cq&&(this.Cq.endActivity(),this.Cq=null))}SH(){return this.pMa?this.pMa.SH():
0}jyg(){return"zh-CN"!==this.ng.YR&&"ja-JP"!==this.ng.YR}LAi(z){const U=new Rl(z,this.jyg(),K.AFrameworkApplication.Ta,this.bKa,this.ng,this.R0,this.gLb,this.P$);return this.ng.Yld||this.ng.Hhb?new bm(this.P$,this.R0,2,this.Pc,this.Uib,U,this.ng):new xn(z,this.ng,this.P$,U,this.wuc)}}Object(h.a)(Zn,"DictationManager",null,[]);class $n{constructor(){this.Lgf=[];this.gZa=this.vBd=""}startSession(){this.vBd=D.a.create().toString();this.Lgf=[]}endSession(){this.vBd=""}get cwa(){return this.vBd}get j4g(){return this.Lgf}}
Object(h.a)($n,"DictationSessionInfo",null,[579]);class Cp{constructor(z,U,la){this.jEd=this.URb=this.gEd=this.TRb=!1;this.nKa="";this.jb=z?z:K.AFrameworkApplication.fa;this.y0a=U;this.Pc=la}get useAutoPunctuation(){if(!this.zK||!this.v7d)return!1;if(this.gEd)return this.TRb;const z=qa.a.instance.getItem("WACDictationFUseAutoPunctuation");this.TRb=void 0===z||null===z?this.jb.ka("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(pf.Eai,this.YR):!1:Boolean.parse(z);this.gEd=!0;return this.TRb}set useAutoPunctuation(z){this.zK&&
this.v7d&&(this.TRb=z,this.gEd=!0,qa.a.instance.setItem("WACDictationFUseAutoPunctuation",this.TRb.toString()))}get GJb(){if(!this.zK||!this.Bae)return!1;if(this.jEd)return this.URb;const z=qa.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.URb=void 0===z||null===z?!0:Boolean.parse(z);this.jEd=!0;return this.URb}set GJb(z){this.zK&&this.Bae&&(this.URb=z,this.jEd=!0,qa.a.instance.setItem("WACDictationFloatieUseVoiceCommands",this.URb.toString()))}get v7d(){return Array.contains(pf.Fai,
this.YR)}get Bae(){return this.Hhb&&Array.contains(pf.Vzl,this.YR)}get YR(){""===this.nKa&&(this.nKa=this.U0i());return this.nKa}set YR(z){z&&(this.nKa=z)}get r3b(){return this.zK}get zK(){return this.jb.ka("WacBox4DictationFloatieIsEnabled")}get uxl(){return this.jb.ka("WacBox4DictationInternalArticle")}get o5f(){return this.jb.Ha("DictationFrontdoorDomain")}get Yld(){return this.jb.ka("WacBox4DictationUseAugloopService")}get psg(){return this.jb.ka("WacBox4DictationCommandsIsEnabled")&&this.zK}get Hhb(){return this.jb.ka("WacBox4DictationUseAugloopServiceWithFrontdoor")}get IEj(){return this.jb.ka("WacDictationAuthenticationEnabled")}get ERc(){return this.jb.ka("DictationDebugModeEnabled")}get w7g(){return this.getSupportedLanguages(0)}get r6g(){return this.getSupportedLanguages(1)}get JEj(){return ia.a.Sth&&
this.jb.ka("UserCanUseDictation")}getSupportedLanguages(z){const U=[];z=0===z?pf.productionLanguages:pf.previewLanguages;for(const la of z)Array.add(U,new ei(la));U.sort((la,Da)=>la.displayName.localeCompare(Da.displayName));return U}U0i(){if(this.y0a&&this.Pc){const z=this.y0a.cMc(this.Pc.Dj);for(const U of this.w7g)if(U.LCID===z)return U.KUc;for(const U of this.r6g)if(U.LCID===z)return U.KUc}return pf.nDi}}Object(h.a)(Cp,"DictationSettings",null,[]);class Jo{constructor(){this.y_e=this.Da=null}get name(){return"Box4.Dictation"}Wb(z){this.Da=
z;const U=Z.a.instance.pb("Common.IDynamicScriptLoaderProvider");let la=null;U&&(la=U.yv);const Da=Z.a.instance.Be("Box4.Dictation.IDictationHostFactory");this.Da.register(Cp,"Box4.Dictation.DictationSettings").ma().na(()=>new Cp(this.Da.resolve("Common.IAppSettingsManager"),this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.ISelectionManager")));const Ia=Z.a.instance.Be("Common.IDictationFloatieController");this.Da.register(Ql,"Box4.Dictation.DictationFloatieManager").ma().na(()=>new Ql(Ia,
this.Da.resolve("Box4.Dictation.DictationSettings")));this.Da.register(Zn,"Box4.Dictation.DictationManager").ma().na(()=>new Zn(la,Da,this.Da.resolve("Box4.ISelectionManager"),z.La("Box4.IBusinessBarController"),z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.pb("Box4.DictationCommands.IDictationCommandManager"),this.Da.pb("Box4.DictationCommands.IDictationCommandParser"),
this.Da.pb("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Da.resolve("Common.App.OAuth.IOAuthManager"),this.Da.resolve("Common.ISharedDependencyLoader")));this.Da.register(579,"Box4.Dictation.IDictationSessionInfo").ma().na(()=>new $n)}init(){this.Da.resolve("Box4.Dictation.IDictationSessionInfo");this.y_e=jj.createInstance(this.Da.Be("Common.IRibbonButtonUpdater"),this.Da.resolve("Box4.Dictation.DictationManager"),this.Da.resolve("Box4.IFormattingEditor"),this.Da.resolve("Box4.IFormattingReader"),
this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.Be("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),rc.FocusManager.instance());this.y_e.ub();Jf.App.Fb.updateCommandUI()}dispose(){}}Object(h.a)(Jo,"DictationPackageManager",null,[2,3]);class sm{constructor(z,U,la){this.IW=null;this.fF=this.oW=-1;this.Cxb=!1;this.iW=z;this.ra=U;this.ia=la}zeg(){return this.Ceg(!1)}$ej(){return this.Ceg(!0)}Thd(){this.IW&&this.WOa();const z=
this.ra.Oa.kb;if(z){const U=z.Ua;if(U&&$f.ParagraphReader.Wd(U.node))return this.IW=U.node,this.fF=z.Ua.C2a,this.oW=z.Ua.sSb,this.Cxb=!0}return!1}WOa(){this.IW=null;this.Cxb=!1;this.oW=this.fF=-1}G8h(z){if(this.IW){const U=new bk.GraphTransaction(15);try{U.fd(this.IW);const la=this.Cxb&&this.fF!==this.oW?Eh.a.createTextRange(this.IW,this.fF,this.oW):Eh.a.Uj(this.IW,this.oW);this.iW.replaceTextRange(la,z);this.oW=this.Cxb?this.fF+z.length:this.oW+z.length;const Da=Lk.SelectionFactory.Jg(this.IW,this.oW);
this.ra.setSelection(Da);this.Cxb=!1;return!0}finally{U&&U.dispose()}}return!1}gzj(z){if(this.IW){const U=new bk.GraphTransaction(15);try{U.fd(this.IW);const la=this.fF!==this.oW?Eh.a.createTextRange(this.IW,this.fF,this.oW):Eh.a.Uj(this.IW,this.oW);this.iW.replaceTextRange(la,z);this.oW=this.fF+z.length;const Da=Lk.SelectionFactory.Jg(this.IW,this.oW);this.ra.setSelection(Da);this.Cxb=!1;return!0}finally{U&&U.dispose()}}return!1}ldk(){var z=this.y1i();this.ia&&z&&z.C2a!==z.sSb&&0<=z.C2a&&(z=Eh.a.createTextRange(z.node,
z.C2a,z.sSb),this.ia.Ka(ld.a.pWf,2,z))}y1i(){return this.IW?this.fF!==this.oW?Eh.a.createTextRange(this.IW,this.fF,this.oW):Eh.a.Uj(this.IW,this.oW):null}Ceg(z){var U=this.ra.Oa.kb;if(U){var la=U.Ua;if(la&&(U=la.node,$f.ParagraphReader.Wd(U)&&(la=z?la.sSb:la.C2a,U=$f.ParagraphReader.text(U),la<=U.length)))return z?U.substring(la,U.length):U.substring(0,la)}return""}}Object(h.a)(sm,"DictationHost",null,[603]);class Ko{constructor(z,U,la){this.iW=z;this.ra=U;this.ia=la}Bwi(){return new sm(this.iW,this.ra,
this.ia)}}Object(h.a)(Ko,"DictationHostFactory",null,[578]);class Lo{get name(){return"PowerPointWebEditor.Dictation"}Wb(z){z.register(Ko,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").ma().na(()=>new Ko(z.resolve("Box4.ICharacterPropertiesEditor"),z.resolve("Box4.ISelectionManager"),K.AFrameworkApplication.Ta))}init(){}dispose(){}static main(){va.a.instance.Ac(new Lo)}}Object(h.a)(Lo,"PPTWebEditorDictationPackage",null,[2,3]);var ao=d(447);class Sl{constructor(z,
U,la=null){this.id=z.Id;la||(la="");this.YHk=la;this.sensitivityLabel=z}}Object(h.a)(Sl,"AutoPolicyLabelData",null,[]);class Rk{constructor(z,U){this.x6=z;this.displayName=U}}Object(h.a)(Rk,"PolicyLabelRequestState",null,[]);class ol{static get Nae(){return ol.NQj}}ol.NQj="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(h.a)(ol,"JustificationDialogHtml",null,[]);class pi extends sb.a{constructor(z,U){super(!1,!1,pi.y0);this.dLa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.Kvc=null;this.Jvc=!1;this.zwc=z;this.FC=U;this.jg=this.Edi();this.vd=1;this.kg=pi.id;this.Re(1,CommonUIStrings.l_DialogChange);this.sC(1,!1);this.fwa(0)}HLe(){if(pi.y0)this.pj(CommonUIStrings.l_SensitivityJustificationTitle,
Object(v.a)(this,this.H$g,"reactJustificationDialogHandler"),this.ocg(this.Jvc));else{const z={};for(let U=0;U<this.dLa.length;U++)z[pi.KBe+U]=!1;z[pi.Vlc]="";this.pj(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.MQj,"justificationDialogHandler"),z);this.WCe();Dg.a.addHandler($get(pi.Vlc),rb.a.input,Object(v.a)(this,this.Ykl,"textAreaHandler"))}}validate(){if(pi.y0)return this.rDh(this.Kvc);const z=$get(pi.Vlc);return z.disabled?!0:this.rDh(z.value)}rDh(z){const U=2>z.length,
la=500<z.length,Da=RegExp("[{|}|;|\\\\]").test(z);z=""===I.a.mDe(z);return!U&&!la&&!Da&&!z}MQj(z,U){let la="";if(1===z)for(let Da=0;Da<this.dLa.length;Da++)if(U[pi.KBe+Da]){la=Da===this.dLa.length-1?U[pi.Vlc]:this.dLa[Da];break}this.FC(z,this.zwc,la)}H$g(z){let U="";1===z&&this.Kvc&&(U=this.Kvc);this.FC(z,this.zwc,U)}elk(z){this.Kvc=z;z=this.validate();this.Jvc!==z&&(this.Jvc=z,this.p5(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.H$g,"reactJustificationDialogHandler"),this.ocg(this.Jvc)))}ocg(z){return{["id"]:this.kg,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!z},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,
["onJustificationUpdated"]:Object(v.a)(this,this.elk,"onJustificationUpdated")}}Ykl(z){z.target&&this.sC(1,this.validate())}Edi(){return sb.a.EB(pi.Nae,K.AFrameworkApplication.Vl,Lg.getImageClass(pi.rCa),CommonUIStrings.l_SensitivityJustificationMessage,this.dLa[0],this.dLa[1],this.dLa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}WCe(){const z=document.getElementsByName(pi.bTj);for(let U=0;U<z.length;U++)Dg.a.addHandler(z[U],rb.a.focus,Object(v.a)(this,this.jbd,"radioButtonFocusHandler")),
Dg.a.addHandler(z[U],rb.a.click,Object(v.a)(this,this.jbd,"radioButtonFocusHandler"))}jbd(z){if(z=z.target){z.checked=!0;var U=$get(pi.Vlc);z.id===pi.KBe+(this.dLa.length-1)?(U.disabled=!1,Sys.UI.DomElement.setVisible(U,!0),U.focus()):(U.disabled=!0,z.focus());this.sC(1,this.validate())}}static get y0(){return K.AFrameworkApplication.Aa.gb.QB&&K.AFrameworkApplication.Aa.gb.j$d}}pi.Nae=ol.Nae;pi.bTj="ListRadioBox";pi.KBe="radiobox";pi.Vlc="txtJustification";pi.rCa="Info_32x32x32";pi.id="JustificationDialog";
Object(h.a)(pi,"JustificationDialog",sb.a,[]);class Eg extends sb.a{constructor(z,U,la){super(!1,!1,!0);if(z&&la){var Da={["id"]:"MandatoryLabellingDialog"};this.bKh=la;this.owd=U;if(!K.AFrameworkApplication.fa.ka("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.owd&&""!==this.owd)Da.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.owd,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};
U={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(U.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:z});Da.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:U};z={["id"]:"MandatoryLabellingDialog",["bodyControls"]:Da};Da.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;Da.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;
this.pj(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(v.a)(this,this.rak,"mandatoryLabellingDialogHandler"),z)}else e.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}rak(z,U){1===z&&U.selectedLabel&&(z=U.selectedLabel,""!==z&&this.bKh(z))}}Object(h.a)(Eg,"MandatoryLabellingDialog",sb.a,[]);class Hm{constructor(){this.boa=!!K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.QB}kyi(z,U,la){this.boa&&new Eg(z,U,la)}static get instance(){return Hm.Ja||
(Hm.Ja=new Hm)}}Hm.Ja=null;Object(h.a)(Hm,"MandatoryLabellingDialogFactory",null,[590]);class ye{}ye.chl="sbProtectForm14";ye.fhl="SBStatusBarMarkAsReadOnly14";ye.nSj="Info_16x16x32";ye.rMf="QuickSearchCompletedToday_16x16x32";ye.fCe="CommonControlCheckboxCheck_16";ye.zwh="On";ye.visible="Visible";ye.uTi="ImageIsVisible";ye.XT="SourceControlId";ye.menuItemId="MenuItemId";ye.menu="Menu";ye.tEf="AppLockId";ye.value="Value";ye.labelText="LabelText";ye.alt="Alt";ye.Pkg="Image16by16";ye.wtb="Image16by16Class";
ye.bhl="SBProtectForm_16";ye.ehl="SBStatusBarMarkAsReadOnly_16";ye.icon="Icon";ye.iconColor="IconColor";ye.customTooltip="CustomTooltip";ye.xHk="MipTagDynamicFillWithOutline_20";ye.yHk="MipTagLockDynamicFillWithOutline_20";ye.wHk="MipTagErrorOutline_20";ye.zHk="MipTagQuestionOutline_20";ye.zQe="transparent";Object(h.a)(ye,"PolicyConstants",null,[]);class pl extends sb.a{constructor(z,U,la){super(!1,!1,pl.y0);this.zwc=z;this.f1=U;this.FC=la;this.vd=1;this.kg=pl.id;this.fwa(1);this.fwa(0)}hMe(){const z=
{["id"]:"UserDefinedPermissionsDialog"};pl.y0&&this.pj("Defined Permissions",Object(v.a)(this,this.Txl,"userDefinedPermissionsDialogHandler"),z)}Txl(z){1!==z&&this.FC(z,this.zwc,"",this.f1)}static get y0(){return K.AFrameworkApplication.Aa.gb.QB&&K.AFrameworkApplication.Aa.gb.j$d}}pl.id="UserDefinedPermissionsDialog";Object(h.a)(pl,"UserDefinedPermissionsDialog",sb.a,[]);var cm=d(574),bo=d(246),Sk=d(463);class qi{constructor(z,U,la,Da){this.Lvd=this.Mvd=null;this.l8e=this.$ud=this.zvd=this.TNb=this.rbf=
this.gdf=this.wqd=!1;this.cjb=this.Qxa=this.Kya=this.XJa=this.f1=this.fA=this.roa=this.pi=null;this.Bod=0;this.Wrd=this.Eaf=this.DWe=null;this.Ca=z;this.Kh=U;this.jb=la;this.lk=Da;this.ROb={};this.Qif={};this.idf={};this.c3b=la.ka("WacApplyManualPolicyLabelIsEnabled");this.lk.value.FGd(Object(v.a)(this,this.Ize,"processAutoSensitivityLabel"));this.lk.value.cDf(Object(v.a)(this,this.Ize,"processAutoSensitivityLabel"));this.lk.value.iGd(Object(v.a)(this,this.wpk,"onUpdateLabelInfo"));K.AFrameworkApplication.Aa&&
K.AFrameworkApplication.Aa.vM(Object(v.a)(this,this.LJk,"refreshDocumentPolicyLabelsOnModeChange"));la.ka("SupportsPolicies")&&la.Ha("AppliedPolicyId")&&(this.Mvd=la.Ha("IrmPolicyTitle"),this.Lvd=la.Ha("IrmPolicyDescription"));this.Gzd=la.ka("ProtectedFile");this.GHh=this.jb.Ec("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.HHh=this.jb.Ec("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get isa(){return K.AFrameworkApplication.isa||!!this.Eaf&&this.Eaf()}ub(){this.Ca.xa(oa.a.s1g,dc.a.frame,
Object(v.a)(this,this.DXf,"documentLabelPaneHandler"));this.Ca.pa(oa.a.hgc,dc.a.frame,Object(v.a)(this,this.hgc,"queryPolicyLabel"),96);this.Ca.xa(oa.a.jhb,dc.a.frame,Object(v.a)(this,this.jhb,"toggleSensitivity"));this.Ca.xa(oa.a.tdb,dc.a.frame,Object(v.a)(this,this.tdb,"populateSensitivityFlyout"));this.Ca.xa(oa.a.Ffb,dc.a.frame,Object(v.a)(this,this.Ffb,"setSensitivity"));this.Ca.pa(oa.a.Egc,dc.a.frame,Object(v.a)(this,this.Egc,"querySensitivity"),96);this.Ca.xa(oa.a.Udb,dc.a.frame,Object(v.a)(this,
this.Udb,"querySensitivityToggleButton"));this.Ca.xa(oa.a.Tdb,dc.a.frame,Object(v.a)(this,this.Tdb,"querySensitivitySubFlyout"));this.pSb(oa.a.jhb)||this.Ca.$d(oa.a.jhb,4);this.pSb(oa.a.tdb)||this.Ca.$d(oa.a.tdb,4);this.pSb(oa.a.Ffb)||this.Ca.$d(oa.a.Ffb,4);this.pSb(oa.a.Udb)||this.Ca.$d(oa.a.Udb,4);this.pSb(oa.a.Tdb)||this.Ca.$d(oa.a.Tdb,4);this.Kh.updateCommandUI();K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",
!1)&&id.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.lk.value.cPk(Object(v.a)(this,this.Xah,"registerActionsHandler"))}Xah(){this.ub()}Vzh(){this.Ca.eO(oa.a.s1g,dc.a.frame,Object(v.a)(this,this.DXf,"documentLabelPaneHandler"));this.Ca.eO(oa.a.hgc,dc.a.frame,Object(v.a)(this,this.hgc,"queryPolicyLabel"));this.Ca.eO(oa.a.jhb,dc.a.frame,Object(v.a)(this,this.jhb,"toggleSensitivity"));this.Ca.eO(oa.a.tdb,dc.a.frame,Object(v.a)(this,
this.tdb,"populateSensitivityFlyout"));this.Ca.eO(oa.a.Ffb,dc.a.frame,Object(v.a)(this,this.Ffb,"setSensitivity"));this.Ca.eO(oa.a.Egc,dc.a.frame,Object(v.a)(this,this.Egc,"querySensitivity"));this.Ca.eO(oa.a.Udb,dc.a.frame,Object(v.a)(this,this.Udb,"querySensitivityToggleButton"));this.Ca.eO(oa.a.Tdb,dc.a.frame,Object(v.a)(this,this.Tdb,"querySensitivitySubFlyout"))}jhb(){return 32}s6f(z){const U="mandatoryLabelling_"+z.Id;this.idf[U]=z.Id;return{["type"]:"AppToggleButtonProps",["id"]:U,["label"]:z.DisplayName,
["hideLabel"]:!1,["customTooltip"]:z.Tooltip}}R8a(){return this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}I6i(){const z=[],U=this.roa;for(let Da in U){var la=U[Da];const Ia=this.fA[Da];if(this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideUDPFromMandatoryDialogEnabled",!1)){if(!Ia||!Ia.Enabled||Ia.HasUserDefinedPermissions)continue}else if(!Ia||!Ia.Enabled)continue;if(la.count){const Db={["sections"]:[],["shouldAutoOpen"]:!1},Ob={["id"]:"mandatoryLabelling_flyoutMenuSection_"+
Ia.Id,["controls"]:[]};for(let sc of la){la=this.fA[sc];if(this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideUDPFromMandatoryDialogEnabled",!1)){if(!la||!la.Enabled||la.HasUserDefinedPermissions)continue}else if(!la||!la.Enabled)continue;Array.add(Ob.controls,this.s6f(la))}Array.add(Db.sections,Ob);Array.add(z,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+Ia.Id,["label"]:Ia.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:Db})}else Array.add(z,
this.s6f(Ia))}return z}tdb(z,U,la,Da,Ia){if(1===la||!this.lk.value.vnb(!0))return 32;Ia.MenuItems=Object.assign(new Bh.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Ia.MenuItems.MenuSectionList,this.ZEc(!this.isReactRibbonEnabled()));this.pi.CustomUrl&&Array.add(Ia.MenuItems.MenuSectionList,this.Rxi(this.isReactRibbonEnabled()?this.pi.CustomUrl:I.a.ie(this.pi.CustomUrl)));this.isReactRibbonEnabled()||(Ia.PopulationXML=nm.l(Ia.MenuItems));return 32}Egc(z,U,la,Da,Ia){if(1===
la||!Ia||!this.c3b)return 32;this.pi=this.lk.value.Bv;if(this.lk.value.vnb(!0)&&(Ia[ye.visible]=!0,this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelsAvailableActivityControlEnabled",!1)?this.rbf||(Xd.a("MipLabelsAvailable"),this.rbf=!0):Xd.a("MipLabelsAvailable"),this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.pi&&this.pi.AreLabelsAvailable&&(z=Z.a.instance.La("Common.ISystemInitiatedFeedback")))){const Db=qi.Va(this.pi.AppliedPolicyId)?
"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";z.execute(Ob=>{Ob.logActivity(Db,null)})}return 32}Udb(z,U,la,Da,Ia){if(1===la||!Ia)return 32;let Db,Ob;Ia[ye.zwh]=!!(Db=Ia[ye.menuItemId])&&!!(Ob=this.ROb[Db])&&Ob===this.pi.AppliedPolicyId;return 32}Tdb(z,U,la,Da,Ia){if(1===la||!Ia)return 32;let Db,Ob,sc;z=!!(Db=Ia[ye.XT])&&!!(Ob=this.ROb[Db])&&!!(sc=this.roa[Ob])&&sc.contains(this.pi.AppliedPolicyId);Ia[ye.uTi]=z;Ia[ye.zwh]=z;return 32}Ffb(z,U,la,Da,Ia){return 1!==
la&&Ia?this.kIa(this.ROb[Ia[ye.XT]],Ia,2):32}HRc(){return!!K.AFrameworkApplication.Aa&&1===K.AFrameworkApplication.Aa.mode}LJk(){this.$ud&&!this.HRc()&&(this.$ud=!1,this.lk.value.KJk())}iol(){this.pi.DefaultLabelId&&this.pi.MandatoryLabelingEnforced?this.wqd||this.HRc()?this.pi.AppliedPolicyId?this.CTd(""):(this.lk.value.VLj(this.lk.value.A5b)||this.HRc())&&this.NZf():this.skh():this.pi.DefaultLabelId?this.skh():this.pi.MandatoryLabelingEnforced&&(this.pi.AppliedPolicyId?this.CTd(""):this.NZf())}yug(){return this.pi.MandatoryLabelingEnforced?
this.pi&&this.pi.AreLabelsAvailable?this.jb.ka("TestOverrideIsReactDialogEnabled")||this.Kh&&this.Kh.gb&&this.Kh.gb.QB?!0:(e.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(e.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(e.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}NZf(){!this.yug()||K.AFrameworkApplication.UP||this.gdf||
(this.gdf=K.AFrameworkApplication.UP=!0,e.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.lk.value.G9g("",1),this.lk.value.IFd(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.pak()}))}CTd(z){this.yug()&&K.AFrameworkApplication.UP&&(K.AFrameworkApplication.UP=!1,e.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),
this.lk.value.tDe(),this.lk.value.G9g(z,2))}pak(){Hm.instance.kyi(this.I6i(),this.pi.CustomUrl,Object(v.a)(this,this.qak,"mandatoryLabellingDialogCallback"))}qak(z){this.CTd(this.idf[z])}mHf(){return this.jb.ka("CoAuthForProtectedFilesEnabled")&&this.jb.ka("SupportsOfficeClientCoauthoring")&&this.jb.ka("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.Wrd&&this.isa}kIa(z,U,la,Da=null){this.lk.value.UFk(la);let Ia=32,Db=!1,Ob=!0;const sc=2===la||8===la||16===la,hc=z===this.pi.AppliedPolicyId;
if(this.DWe&&this.DWe(z,sc))e.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",la),this.Kh.updateCommandUI();else if(U&&ye.tEf in U&&this.lk.value.zIe(U[ye.tEf]),z)if(this.lk.value.Gwg()||this.mHf()&&this.zvd)e.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",la),this.Kh.updateCommandUI(),sc&&this.dAc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,
CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.jb.ka("HasDocumentEditRights"))if(this.lk.value.Jii(z))if(!this.R8a()&&this.fA[z]&&this.fA[z].HasUserDefinedPermissions&&!hc)e.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",la),1!==la&&4!==la&&this.E7h();else if(sc&&this.pi.MandatoryLabelingEnforced&&hc)e.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",
la),this.dAc(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(sc&&this.jb.ka("WacLabelingJustificationDialogIsEnabled")&&this.pi.RequiredDowngradeJustification&&(hc||this.fA[z].RequiredDowngradeJustification)&&(this.R8a()?!this.l8e&&!Da:!this.f1))return e.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",la),this.HLe(z),Ia;if(this.R8a()&&this.fA[z].HasUserDefinedPermissions&&
!hc)return e.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",la),this.hMe(z,Da),Ia;if(this.mHf()&&!this.Wrd())this.Bod<this.GHh?(e.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.Bod,la),this.zvd=!0,this.Bod++,Kf.Task.delay(this.HHh).continueWith(()=>{this.zvd=!1;this.kIa(z,U,la)})):(e.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",
la),Db=1!==la,Ob=!1,Ia=8);else{if(this.iKj(z)&&(e.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",la),1===la||8===la||4===la))return Ia;e.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",la);this.setPolicyLabel(hc?"":z,this.R8a()?Da:this.f1,"",la);return Ia}}else e.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",
la),this.Kh.updateCommandUI(),sc&&this.dAc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else e.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",la),this.Kh.updateCommandUI(),sc&&this.dAc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else e.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",
la),this.Kh.updateCommandUI(),Db=sc,Ob=!1,Ia=8;this.lk.value.c$g(0,la,Db,Ob);return Ia}tFf(z,U,la=null,Da=!1){u.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.jb.ka("SupportsOfficeClientCoauthoring")&&this.jb.ka("CoAuthForProtectedFilesIsEnabled")?(this.TNb=!1,(this.pi=this.lk.value.Bv)&&!this.pi.AppliedPolicyId?this.TNb=!0:this.pi&&this.pi.PolicyLabelAssignmentMethod&&(this.TNb=bo.e(this.pi.PolicyLabelAssignmentMethod)===bo.e("standard"))):this.TNb=Da;z=qi.Va(z)?
null:this.fA[z];(U=qi.Va(U)?null:this.fA[U])?this.Kya=new Sl(U,!0,la):(this.lk.value.Lva(29),this.Qxa=null);z?this.XJa=new Sl(z,!1):this.cjb=null;this.Ize(null,null)}l9h(z){this.kIa(z,null,16)}t2k(){this.fA={};if(this.pi=this.lk.value.Bv)for(const z of this.pi.SensitivityLabels)this.fA[z.Id]=z}iKj(z){if(this.roa&&z in this.roa){z=this.roa[z];for(let U of z)if((z=this.fA[U])&&z.Enabled)return!0}return!1}P3k(){this.roa={};if(this.pi=this.lk.value.Bv){for(const z of this.pi.SensitivityLabels)z.ParentId||
(this.roa[z.Id]=new za.a);for(const z of this.pi.SensitivityLabels)z.ParentId&&z.ParentId in this.roa&&this.roa[z.ParentId].add(z.Id)}}cDk(){if(this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)){this.pi=this.lk.value.Bv;const z=this.c3b&&this.isReactRibbonEnabled()&&this.lk.value.vnb();qi.yeb(z)}else this.c3b&&this.isReactRibbonEnabled()?(this.pi=this.lk.value.Bv,this.lk.value.vnb()?(qi.yeb(!0),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!1))):qi.yeb(!1)):qi.yeb(!1)}RKk(z){this.Wrd=z}skh(){if(this.jb.ka("WacApplyDefaultPolicyLabelIsEnabled"))if(this.HRc())this.$ud=!0;else if(!this.wqd)if(this.wqd=!0,this.pi=this.lk.value.Bv,this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)){if(this.pi&&this.pi.DefaultLabelId)if(!this.pi.AppliedPolicyId)e.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.pi.DefaultLabelType),this.kIa(this.pi.DefaultLabelId,null,
1);else if(n.a.Qr().equals(this.pi.DefaultLabelType,"documentLibraryDefault")){const z=this.fA[this.pi.AppliedPolicyId],U=this.fA[this.pi.DefaultLabelId];this.pi.AppliedPolicyId!==this.pi.DefaultLabelId&&n.a.Qr().equals(this.pi.PolicyLabelAssignmentMethod,"standard")&&z.Order<U.Order&&(e.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.pi.DefaultLabelType),this.kIa(this.pi.DefaultLabelId,null,1))}}else this.pi&&this.pi.DefaultLabelId&&!this.pi.AppliedPolicyId&&
(e.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.pi.DefaultLabelId),this.kIa(this.pi.DefaultLabelId,null,1))}Ize(){if(!this.lk.value.Gwg()){var z=this.fA[this.pi.AppliedPolicyId];this.TNb&&this.XJa&&this.cjb!==this.XJa.id&&(!z||z.Order<this.XJa.sensitivityLabel.Order)&&(z=this.kIa(this.XJa.id,{},4),32!==z?e.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+z):(this.cjb=this.XJa.id,this.Qxa&&(z=this.fA[this.Qxa])&&
z.Order<=this.XJa.sensitivityLabel.Order&&(this.lk.value.Lva(29),this.Qxa=null)));z=this.fA[this.lk.value.Bv.AppliedPolicyId];if(this.Kya&&this.Qxa!==this.Kya.id&&(!z||z.Order<this.Kya.sensitivityLabel.Order)){const U=this.Kya.id;this.lk.value.Lva(29);this.lk.value.Vyc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.F_d(this.Kya.sensitivityLabel))+" "+this.Kya.YHk,CommonUIStrings.l_PolicyLabelRecommendationButton,()=>{this.kIa(U,{},
8)});this.Qxa=this.Kya.id}this.Kya=this.XJa=null}}setPolicyLabel(z,U,la,Da=2){this.R8a()?U&&(this.l8e=!0):this.f1=U;this.lk.value.setPolicyLabel(z);this.Kh.updateCommandUI();la=new Rk(Da,this.F_d(this.fA[z]));this.lk.value.LIe(z,this.R8a()?U:this.f1,la)}Bti(z,U,la,Da){1===z&&this.setPolicyLabel(U,Da,la)}Ati(z,U,la){1===z?this.R8a()?this.kIa(U,null,2,la):this.setPolicyLabel(U===this.pi.AppliedPolicyId?"":U,la,""):this.Kh.updateCommandUI()}HLe(z){(new pi(z,Object(v.a)(this,this.Ati,"continueToSetPolicyLabelFromJustificationDialog"))).HLe()}hMe(z,
U){(new pl(z,U,Object(v.a)(this,this.Bti,"continueToSetPolicyLabelFromUDPDialog"))).hMe()}dAc(z="",U=""){const la=new Zb.StandardDialog;la.hr=K.AFrameworkApplication.Xba;la.vd=0;la.Re(1,CommonUIStrings.l_DialogClose);la.mO(z,U,null)}Ybi(z){1===z&&this.lk.value.FGk()}E7h(){const z=new Zb.StandardDialog;z.hr=K.AFrameworkApplication.Xba;z.vd=1;z.Re(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);z.Re(0,CommonUIStrings.l_DialogClose);z.mO(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,
CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(v.a)(this,this.Ybi,"blockUDPSetLabelHandler"))}isReactRibbonEnabled(){return!!this.Kh&&!!this.Kh.gb&&this.Kh.gb.uo}bvb(){return this.Kh&&this.Kh.gb?this.Kh.gb.bvb:!1}DXf(){return 32}hgc(z,U,la,Da,Ia){if(1===la)return 32;this.pi=this.lk.value.Bv;if(!this.pi||!Ia)return 32;Ia[ye.value]="";Ia[ye.labelText]="";Ia[ye.alt]=null;Ia[ye.Pkg]=null;Ia[ye.wtb]=null;Ia[ye.customTooltip]="";Ia[ye.visible]=!1;Ia[ye.iconColor]="";la=U=z=Ia[ye.icon]="";if(!this.pi.AreLabelsAvailable){if(!this.Mvd)return 32;
z=this.Mvd;la=ye.zQe;this.Lvd&&(U=this.Lvd)}else if(this.pi.AppliedPolicyId){Da=null;for(const Db of this.pi.SensitivityLabels)if(Db.Id.toLowerCase()===this.pi.AppliedPolicyId.toLowerCase()){Da=Db;break}Da&&(z=this.F_d(Da),U=Da.Tooltip,this.Gzd=K.AFrameworkApplication.XI=Da.IsEndpointProtectionEnabled,la=this.G7f(Da))}this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(z?(Ia[ye.value]=z,Ia[ye.labelText]=z,Ia[ye.customTooltip]=U,this.Ykh(la,this.Gzd,Ia)):this.jb.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ClpUseOutlineImageForNoLabel")?
(Ia[ye.iconColor]=ye.zQe,this.pi.MandatoryLabelingEnforced?(Ia[ye.value]=Ia[ye.labelText]=HeaderStrings.SelectASensitivityLabel,Ia[ye.icon]=ye.wHk):(Ia[ye.value]=Ia[ye.labelText]=HeaderStrings.NoSensitivityLabel,Ia[ye.icon]=ye.zHk)):(Ia[ye.iconColor]="#000000",this.pi.MandatoryLabelingEnforced?(Ia[ye.value]=Ia[ye.labelText]=HeaderStrings.SelectASensitivityLabel,Ia[ye.icon]="MipTagErrorDynamicColor_20"):(Ia[ye.value]=Ia[ye.labelText]=HeaderStrings.NoSensitivityLabel,Ia[ye.icon]="MipTagQuestionDynamicColor_20")),
Ia[ye.visible]=!0):z&&(Ia[ye.value]=z,Ia[ye.labelText]=z,this.bvb()?Ia[ye.customTooltip]=U:Ia[ye.alt]=U,this.Ykh(la,this.Gzd,Ia),Ia[ye.visible]=!0);return 32}F_d(z){return z?this.fA?z.ParentId&&this.fA[z.ParentId]?this.fA[z.ParentId].DisplayName+"\\"+z.DisplayName:z.DisplayName:(e.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),z.DisplayName):""}Ykh(z,U,la){this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?
(la[ye.icon]=this.teg(U),la[ye.iconColor]=this.ueg(z)):this.bvb()?la[ye.icon]=U?ye.bhl:ye.ehl:(la[ye.Pkg]=K.AFrameworkApplication.Vl,la[ye.wtb]=U?Lg.getImageClass(ye.chl):Lg.getImageClass(ye.fhl))}Rxi(z){const U=this.au("LearnMoreSection",!0);z=Object.assign(new Ok.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:z,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:K.AFrameworkApplication.Vl,Image16by16Class:Lg.getImageClass(ye.nSj),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,
KeyTip:"L"});Array.add(U.ControlList,z);return U}mTf(z,U,la=!1){let Da;Da="Toggle_"+z.Id;Da="Sensitivity_"+Da;const Ia=z.DisplayName,Db=z.Tooltip;var Ob=z.Id===this.pi.AppliedPolicyId,sc=la?I.a.ie(Da):Da;this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(Ob=this.G7f(z),U=Object.assign(new Pa.a,{Id:sc,ExternalId:sc,LabelText:la?I.a.ie(Ia):Ia,Command:"2935633379",MenuItemId:sc,QueryCommand:"991261903",Visible:!0,Alt:la?I.a.ie(Db):Db,AriaLabel:Ub.a.xnb,IconColor:this.ueg(Ob),
KeyTip:U}),U.ExternalImageId=this.teg(z.IsEndpointProtectionEnabled)):(sc=Object.assign(new cm.a,{Id:sc,ExternalId:sc,LabelText:la?I.a.ie(Ia):Ia,Command:"2935633379",MenuItemId:sc,QueryCommand:"991261903",CheckedImage:K.AFrameworkApplication.Vl,Visible:!0,Alt:la?I.a.ie(Db):Db,IsChecked:Ob,AriaLabel:Ub.a.xnb,KeyTip:U}),this.isReactRibbonEnabled()?(sc.CheckedImageClass=Lg.getImageClass(ye.fCe),sc.ExternalImageId=ye.fCe):sc.CheckedImageClass=Lg.getImageClass(ye.rMf),U=sc);sc=Da;this.ROb[sc]=z.Id;this.Qif[z.Id]=
sc;return U}au(z,U=!1){return Object.assign(new Lh.a,{Title:"",Id:z,DisplayMode:ye.menu,ShowMenuSectionSeparator:U,ControlsId:"Ctrl_"+z,ControlList:[]})}RAi(z,U,la){z=this.au(z+"Sub");let Da=1;for(let Ia of U)(U=this.fA[Ia])&&U.Enabled&&(Array.add(z.ControlList,this.mTf(U,Da.toString(),la)),Da++);return z}ZEc(z=!1){const U=this.au("SensitivitySection");let la=1;const Da=this.roa;for(let Db in Da){const Ob=Da[Db],sc=this.fA[Db];if(sc&&sc.Enabled){if(Ob.count){const hc="Sensitivity_"+sc.Name;var Ia=
z?I.a.ie(hc):hc;Ia=Object.assign(new lf.a,{Id:Ia,ExternalId:Ia,LabelText:z?I.a.ie(sc.DisplayName):sc.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new Bh.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:Ub.a.xnb,KeyTip:la.toString(),Alt:z?I.a.ie(sc.Tooltip):sc.Tooltip});this.isReactRibbonEnabled()?Ia.ExternalImageId=ye.fCe:(Ia.Image16by16=K.AFrameworkApplication.Vl,Ia.Image16by16Class=Lg.getImageClass(ye.rMf));
Array.add(Ia.Menu.MenuSectionList,this.RAi(hc,Ob,z));Array.add(U.ControlList,Ia);this.ROb[Ia.Id]=sc.Id;this.Qif[sc.Id]=Ia.Id}else Array.add(U.ControlList,this.mTf(sc,la.toString(),z));la++}}return U}pSb(z){return!!this.Ca.iS(z)&&!!this.Ca.iS(z).flags&&!!this.Ca.iS(z).flags.length}wpk(z,U){U.onSuccess&&this.fA&&(z=this.fA[this.lk.value.Bv.AppliedPolicyId])&&(this.Qxa&&(U=this.fA[this.Qxa])&&U.Order<=z.Order&&(this.lk.value.Lva(29),this.Qxa=null),this.cjb&&this.cjb!==z.Id&&(this.lk.value.Lva(28),this.cjb=
null))}teg(z){return z?ye.yHk:ye.xHk}ueg(z){return z?z:ye.zQe}G7f(z){if(z.Color||!z.ParentId)return z.Color;const U=this.fA[z.ParentId];return U?U.Color:z.Color}static yeb(z){K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(z?(Sk.a.Qua("ribbon","sensitivity"),Sk.a.Pua("ribbon","sensitivity")):Sk.a.y9("ribbon","sensitivity"));K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",
!1)&&id.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!z))}static Va(z){return z&&z.length?!1:!0}}Object(h.a)(qi,"PolicyActor",null,[543]);var ql=d(1161),fk;(function(z){z[z.unknown=0]="unknown";z[z.boot=1]="boot";z[z.refresh=2]="refresh";z[z.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(fk||(fk={}));Object(h.b)("GetPolicyLabelsReason",fk);class Tl extends Sys.EventArgs{constructor(z,U,la,Da,Ia,Db){super();this.bob=z;this.title=U;this.message=la;this.buttonText=
Da;this.gUb=Ia;this.nTc=Db}}Object(h.a)(Tl,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class uo extends Sys.EventArgs{constructor(z,U,la,Da,Ia){super();this.bob=z;this.title=U;this.message=la;this.buttonText=Da;this.gUb=Ia}}Object(h.a)(uo,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var $g;(function(z){z[z.none=0]="none";z[z.reasonDefaultLabel=1]="reasonDefaultLabel";z[z.reasonManual=2]="reasonManual";z[z.reasonAutomatic=4]="reasonAutomatic";z[z.reasonRecommended=
8]="reasonRecommended";z[z.reasonMandatory=16]="reasonMandatory"})($g||($g={}));Object(h.b)("ApplyLabelFlags",$g);class vj extends Sys.EventArgs{constructor(z,U,la){super();this.kOf=z;this.jOf=U;this.existingLabelPriority=la}}Object(h.a)(vj,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class co extends Sys.EventArgs{constructor(){super()}}Object(h.a)(co,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class Mo extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Mo,"GetPolicyLabelFailureEventArgs",
Sys.EventArgs,[]);class Hn{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelType=this.DefaultLabelId=null;this.AreLabelsAvailable=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelType=this.DefaultLabelId=
"";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl=""}}Object(h.a)(Hn,"GetPolicyLabelsData",null,[]);class $m extends Sys.EventArgs{constructor(z=!1){super();this.onSuccess=z}}Object(h.a)($m,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class Tk extends Sys.EventArgs{constructor(z,U){super();this.ARg=z;this.sHd=U}}Object(h.a)(Tk,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class vo extends Sys.EventArgs{constructor(z,U,la,Da){super();this.title=z;this.Jvk=U;
this.buttonText=la;this.Uhk=Da}}Object(h.a)(vo,"PolicyTipEventArgs",Sys.EventArgs,[]);class an extends Sys.EventArgs{constructor(z,U){super();this.bob=z;this.nTc=U}}Object(h.a)(an,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class In extends Sys.EventArgs{constructor(){super()}}Object(h.a)(In,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class wo extends Sys.EventArgs{constructor(z,U){super();this.G4g=z;this.x6=U}}Object(h.a)(wo,"SetPolicyLabelEventArgs",Sys.EventArgs,
[]);class rl extends Sys.EventArgs{constructor(z,U,la,Da=null,Ia=null,Db=null,Ob=null){super();this.errorType=z;this.ecl=la;this.title=Da;this.message=Ia;this.buttonText=Db;this.gUb=Ob}}Object(h.a)(rl,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class eo extends Sys.EventArgs{constructor(){super()}}Object(h.a)(eo,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class Dp extends Sys.EventArgs{constructor(z){super();this.J9k=z}}Object(h.a)(Dp,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,
[]);var ri=d(672),Ck=d(441);class bn{static O1k(z,U){if(!z||!U||z.count!==U.count)return!1;for(let la of z)if(!U.contains(la))return!1;return!0}static toArray(z){if(!z)return null;const U=Array(z.count);let la=0;for(let Da of z)U[la]=Da,la++;return U}}Object(h.a)(bn,"HashSetUtils",null,[]);var pc=d(758);class Uj{constructor(z,U,la,Da=0,Ia=null){this.sqd=this.y0e=null;this.mMa=this.RMb=this.SMb=0;this.kfa="";this.H1a=this.qbf=this.rod=this.cud=this.Bxa=this.Dwd=null;this.o8e=!1;this.WZa=null;this.itd=
0;this.qvc=this.K1a=this.T_a=this.pvc=null;this.Pa=new xk.a;this.yjc=this.R_b=this.xR=null;this.Ytd=!1;this.A5b=null;this.jb=z;this.Ei=U;this.Qh=la;this.Ttc=Da;this.Bv=new Hn;this.Pif=this.jb.Ha("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.JF=Ia;this.c3b=z.ka("WacApplyManualPolicyLabelIsEnabled");this.k3b=z.ka("CoAuthForProtectedFilesIsEnabled");this.Ggb=z.ka("SupportsOfficeClientCoauthoring");this.UMj=!1;this.X3k=3E4;this.Rd=Vf.a.instance;z.ka("SupportsPolicies")&&Xd.a("MipSupportsPolicies");
this.k3b&&this.Ggb&&Xd.a("MipSupportsOfficeClientCoauthoring")}get u7d(){return this.Ytd}O4h(z){this.Pa.addHandler("PolicyTipEvent",z)}iGd(z){this.Pa.addHandler("LabelInfoUpdateEvent",z)}cPk(z){this.Pa.removeHandler("LabelInfoUpdateEvent",z)}FGd(z){this.Pa.addHandler("SetPolicyLabelEventKey",z)}wdh(z){this.Pa.removeHandler("SetPolicyLabelEventKey",z)}cDf(z){this.Pa.addHandler("SetPolicyLabelFailureEventKey",z)}R2h(z){this.Pa.addHandler("GetAutoPolicyLabelEventKey",z);this.u7d&&(e.ULS.sendTraceTag(51668058,
306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.SBe(new co(0)))}B2h(z){this.Pa.addHandler("CreateAutoCLPSecurityNodesEventKey",z)}Z5h(z){this.Pa.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",z)}$5h(z){this.Pa.addHandler("UpdateAutoCLPSITNodesEventKey",z)}g2h(z){this.Pa.addHandler("AddAutoPolicyBusinessBarEntryEventKey",z)}$4h(z){this.Pa.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",z)}h2h(z){this.Pa.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",
z)}a5h(z){this.Pa.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}k3h(z){this.Pa.addHandler("MandatoryLabellingAppHandlerEventKey",z)}W5h(z){this.Pa.addHandler("UDPLabelingAppHandlerEventKey",z)}get AFj(){if(!this.y0e)return!1;for(const z of this.y0e.TWd())if(!z.Capabilities||!z.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get mwg(){return!!this.xR}ewj(z){z&&this.k3b&&this.Ggb&&z.execute(Object(v.a)(this,this.fJd,"awaitRtc"))}wLk(z){this.cud=z}$ki(){return this.cud?this.cud():
!1}kKk(z){this.rod=z}QE(){return(new Date).getTime()}fJd(z){if(!this.mwg){var U=z.nL.task;U.continueWith(()=>{this.xR=U.result;this.xR.Eza(Object(v.a)(this,this.jlk,"onLabelChangeUpdateOverRtc"))})}}jlk(z,U){12===U.type&&(this.qbf?this.qbf():this.OPa(this.kfa,2,this.Bxa,!0))}R8f(){this.Qh&&(this.pvc=this.Qh.wi("WebServiceCall","Call Get Policy Endpoint On Server"));var z=pc.a.tAa(1,1);this.jb.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new ri.a(this.usb("datalosspolicy"),1,null,null,!0,
2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,z),this.Ei.send(z).nEb(Object(v.a)(this,this.yXg,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.xXg,"onDataLossPolicyFailureCallback"))):this.Ei.vj(this.usb("datalosspolicy"),1,null,null,!0,2,Object(v.a)(this,this.yXg,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.xXg,"onDataLossPolicyFailureCallback"),null);this.SMb++;e.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",
this.Pif,this.SMb)}KJk(){this.OPa(this.kfa,2,this.Bxa)}OPa(z,U=0,la=null,Da=!1){u.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.tYd(void 0,U));this.R_b=this.QE();const Ia=this.KOd(U);this.nLc(z,Ia,la,Da,U);this.yEe(!0)}yXg(z){this.F4g();let U="";({data:U}=this.jRe(z)).returnValue&&(e.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.SMb=0,this.Qh&&(this.qvc=this.Qh.wi("Task","Parse and Handle Get Policy Response")),this.Qsk(U),
this.qvc&&(this.qvc.stop(),this.qvc=null))}xXg(z){this.F4g();this.SMb<=this.Ttc?this.R8f():(e.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",z?z.data?z.data.VEb:null:null),this.SMb=0)}Gwg(){return 0<this.mMa}setPolicyLabel(z){this.Bv.AppliedPolicyId=z}LIe(z,U,la=null){const Da=this.yxi(la);this.W3k(z,U,Da,la)}J_g(z){this.K1a&&(this.K1a.stop(),this.K1a=null);let U,la;({Vih:U,Alh:la}=this.cdg(z));const Da=z.data.state,Ia=Da?Da.x6:2;let Db=
"";({data:Db}=this.jRe(z)).returnValue?(e.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",Ia),this.mMa=0,this.utk(Db,U,la,Da)):this.uFe(Ia)}UFk(z){u.Health.instance.recordKpiUsage("MipSetPolicyLabel",0,"officewebclp",this.tYd(z));this.yjc=this.QE();e.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Pa.raiseEvent("SetPolicyLabelTriggeredEventKey",new eo(z))}Jfk(){this.k3b&&this.Ggb&&this.mwg&&this.xR.rea(12,null,
!0)}I_g(z){this.K1a&&(this.K1a.stop(),this.K1a=null);let U;({Vih:la,Alh:U}=this.cdg(z));if(this.mMa<=this.Ttc)this.LIe(la,U);else{var la=(la=z.data.state)?la.x6:2;e.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",z?z.data?z.data.VEb:null:null,la);this.A5b="WACServerConnectionFailed";this.mMa=0;this.uFe(la)}}VLj(z){if(z&&("LabelNotSupported"===z||"LabelErrorRetryLater"===z||"CoherencyFailure"===z||"LabelIdNotFound"===z||"LabelDisabled"===
z))return e.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",z),!0;e.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",z);return!1}Jii(z){if(!z)return!1;let U=null,la=null;for(const Da of this.Bv.SensitivityLabels)Da.Id===z&&(U=Da),Da.Id===this.kfa&&(la=Da);if(!U)return!1;if(this.k3b&&this.Ggb){if(this.rod&&this.rod()||this.AFj)return!0}else if(K.AFrameworkApplication.mA&&K.AFrameworkApplication.mA.xBa||this.Bxa&&this.Bxa())return!0;return U.IsEndpointProtectionEnabled===
(!!la&&la.IsEndpointProtectionEnabled)}Vyc(z,U,la,Da,Ia){28===z?this.s9g(new Tl(z,U,la,Da,Ia,!1)):this.s9g(new Tl(z,U,la,Da,Ia,!0))}Lva(z){28===z?this.T9g(new an(z,!1)):this.T9g(new an(z,!0))}qEk(z,U,la){e.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.Pa.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new vj(z,U,la))}IGk(z){e.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.Pa.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",
new vj(null,null,z))}JGk(z,U){e.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.Pa.raiseEvent("UpdateAutoCLPSITNodesEventKey",new vj(z,U,null))}G9g(z,U){e.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===U?"Reading":"Edit")+" switch event.");this.Pa.raiseEvent("MandatoryLabellingAppHandlerEventKey",new Tk(z,U))}IFd(z,U,la,Da,Ia){37===z&&this.WDk(new uo(37,U,la,Da,Ia))}tDe(){this.EFk(new In)}FGk(){e.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");
this.Pa.raiseEvent("UDPLabelingAppHandlerEventKey",new Dp(!0))}vnb(z=!1){const U=!!this.Bv&&this.Bv.AreLabelsAvailable&&!!this.Bv.SensitivityLabels&&0<this.Bv.SensitivityLabels.length&&wh.a.any(this.Bv.SensitivityLabels,la=>!!la&&la.Enabled);U||z||qi.yeb(!1);return U}DYg(z){this.T_a&&(this.T_a.stop(),this.T_a=null);var U="";this.yEe(!1);({data:U}=this.jRe(z)).returnValue?(e.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.RMb=0,U=this.ftk(U),z=this.Qbg(z.data),
u.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.lKc(void 0,z,this.R_b)),this.R_b=null,z=new co(z),this.JEk(z),this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?U&&this.p8k()?this.u7d?this.Zsl():(this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)||this.BEc(),this.SBe(z),this.Ytd=!0):U||this.ybd():!this.u7d&&U&&this.jb.ka("WacApplyManualPolicyLabelIsEnabled")&&this.cGf()?(this.SBe(z),this.Ytd=!0):U||
this.ybd()):this.ybd()}p8k(){if(!this.jb.ka("WacApplyManualPolicyLabelIsEnabled"))return e.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.cGf())return!1;if(""===this.kfa)return e.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.WZa===this.itd)return e.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),
!1;e.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}BEc(){this.vAh();e.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.H1a.count,this.WZa);const z=bn.toArray(this.H1a);this.qEk(z,z,this.WZa)}Zsl(){var z=this.H1a;this.vAh();bn.O1k(z,this.H1a)||(e.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.H1a.count),
z=bn.toArray(this.H1a),this.JGk(z,z));this.o8e&&(e.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.WZa),this.IGk(this.WZa))}vAh(){const z=new ql.a(n.a.Qr());for(const U of this.Bv.SensitivityLabels)if(U&&U.AutoLabelingSensitiveTypeIds&&0<U.AutoLabelingSensitiveTypeIds.length)for(const la of U.AutoLabelingSensitiveTypeIds)la&&z.add(la);this.H1a=z}CYg(z){const U=this.Qbg(z.data);u.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",
!1,!1,this.lKc(void 0,U,this.R_b));this.R_b=null;this.T_a&&(this.T_a.stop(),this.T_a=null);if(this.RMb<=this.Ttc){if(this.jb.ka("SendHostAttributionInfoForPolicyLabelEnabled")){const la=z.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in la&&la[pc.a.rGe]&&"HostAttributionInfo.ScenarioTypeParamName"in la&&la[pc.a.sGe]){z.data.request.get_headers();z.data.request.get_headers();z=this.KOd(U);this.nLc(this.kfa,z,this.Bxa,void 0,U);return}}this.OPa(this.kfa,U,this.Bxa)}else e.ULS.sendTraceTag(34996494,
306,15,"Request to get label policy failed with error response: {0}.",z?z.data?z.data.VEb:null:null),this.ybd(),this.RMb=0,this.yEe(!1)}Qbg(z){return z.state?z.state:0}usb(z,U=!1){let la=String.format("{0}{1}?action={2}&{3}",this.jb.Ha("PolicyHandlerWebServiceBase")||K.AFrameworkApplication.Aa.gb.yda,this.Pif,z,K.AFrameworkApplication.Zg);"setpolicylabel"===z&&K.AFrameworkApplication.mA&&K.AFrameworkApplication.mA.y8d&&(la=E.a.ej(la,"sl","1"));U&&(la=E.a.ej(la,"cbd","1"));return la}cdg(z){let U,la;
U=la=null;z&&z.data&&z.data.request&&z.data.request.get_headers()&&(U=z.data.request.get_headers()[Ck.a.Wih],la=z.data.request.get_headers()[Ck.a.Blh]);return{Vih:U,Alh:la}}jRe(z){z=z?z.data?z.data.Zd:null:null;return z&&z.length&&!this.QMj(z)?{returnValue:!0,data:z}:(e.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:z})}Qsk(z){let U;try{U=M.b(z)}catch(la){e.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(U)if(U.IsPolicyTipAvailable)switch(U.IsPolicyTipAvailable.toLowerCase()){case "false":e.ULS.sendTraceTag(26007261,
306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":e.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.sqd=U.NavigateUrl;this.wcl(U.GeneralText,Object(v.a)(this,this.Pik,"onDataLossPolicyOverrideButtonClick"));break;default:e.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",U.IsPolicyTipAvailable)}else e.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");
else e.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}pui(z){switch(z){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;
case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}utk(z,U,la,Da){var Ia=Da?Da.x6:2;let Db=0,Ob="",sc;if(({Hv:sc}=M.d(z)).returnValue)if(sc){Ob="Success";z=this.KOd(3);if(sc.IsSuccessful){u.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.lKc(Ia,void 0,this.yjc));this.A5b=this.yjc=null;e.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",Ia);2===Ia&&this.Lva(29);
this.R4k(U,Ia);this.Jfk();this.Lva(28);Da&&4===Ia&&this.Vyc(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,Da.displayName),CommonUIStrings.l_DialogOk,()=>{});Xd.a("MipAppliedLabels",void 0,void 0,[Object.assign(new nf.a,{name:"SetPolicyLabelApplyFlag",string:$g[Ia]})]);this.nLc(U,z,this.Bxa,void 0,3);return}e.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",
Ia,sc.FailureReason);this.A5b=sc.FailureReason;this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSetLabelFailureErrMsg",!1)?Db=this.pui(sc.FailureReason):"FileTooLarge"===sc.FailureReason?Db=7:"LabelNotSupported"===sc.FailureReason?Db=13:"LabelDisabled"===sc.FailureReason?Db=9:"MinorVersionLimitExceeded"===sc.FailureReason&&(Db=15);this.UMj&&0<=sc.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(Da=new fd.a(2,1,this.X3k,()=>{e.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",
this.mMa);this.mMa<=this.Ttc&&this.LIe(U,la)}),this.Rd.Gb(Da));this.k3b&&this.Ggb&&this.nLc(this.Bv.AppliedPolicyId,z,this.Bxa,!0,3)}else Ob="setPolicyLabelData null.",e.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",Ia);else Ob="TryDeserialize failed.",e.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Ia);this.uFe(Ia,Db);Ia=this.lKc(Ia,void 0,this.yjc);
this.yjc=null;Ia.extendedProperties.set("SetPolicyLabelDataFailureReason",this.A5b);Ia.extendedProperties.set("SetPolicyLabelDataParseStatus",Ob.toString());u.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,Ia)}uFe(z,U=0){const la=2===z||8===z||16===z;this.setPolicyLabel(this.kfa);this.F9g(new $m);this.c$g(U,z,la,!1)}R4k(z,U){this.setPolicyLabel(this.kfa=z);if(""===z)K.AFrameworkApplication.XI=!1,K.AFrameworkApplication.lYb=!1;else for(const la of this.Bv.SensitivityLabels)if(la.Id===
z){K.AFrameworkApplication.XI=la.IsEndpointProtectionEnabled;break}this.TFk(new wo(z,U))}Nul(){for(const z of this.Bv.SensitivityLabels)z&&z.Enabled&&(z.Id===this.kfa&&(this.o8e=this.WZa!==z.Order,this.WZa=z.Order),z.Order>this.itd&&(this.itd=z.Order))}ftk(z){if(!({Hv:z}=M.d(z)).returnValue)return e.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!z)return e.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),
!1;if(!z.AreLabelsAvailable)return!1;this.Bv=z;this.kfa=z.AppliedPolicyId;this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.Nul();this.vnb()&&e.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");this.F9g(new $m(!0));return!0}cGf(){if(!this.vnb())return e.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const z of this.Bv.SensitivityLabels)if(z&&
z.AutoLabelingSensitiveTypeIds&&0<z.AutoLabelingSensitiveTypeIds.length)return!0;e.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}F9g(z){e.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.Pa.raiseEvent("LabelInfoUpdateEvent",z)}JEk(z){e.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.Pa.raiseEvent("GetPolicyLabelEventKey",z)}ybd(){qi.yeb(!1);this.Pa.raiseEvent("GetPolicyLabelFailureEventKey",
new Mo)}SBe(z){this.JF&&this.JF.execute(U=>{U=[U.isFeatureEnabled("MsoClpSpTwo",!0),U.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(U).then(la=>{wh.a.any(la,Da=>Da)&&(e.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.Pa.raiseEvent("GetAutoPolicyLabelEventKey",z),this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.BEc(),Xd.a("MipAutoClassificationEnabled"));return null})})}tYd(z=null,U=null){const la=new Map;
la.set("ClpCoauth",this.Ggb.toString());null!=z&&la.set("ApplyLabelFlags",$g[z]);null!=U&&la.set("GetPolicyLabelsReason",fk[U]);return la}lKc(z=null,U=null,la=null){const Da=new Ba.a;Da.extendedProperties=this.tYd(z,U);null!=la&&(Da.durationMs=this.QE()-la);return Da}TFk(z){e.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Pa.raiseEvent("SetPolicyLabelEventKey",z)}s9g(z){e.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");z&&z.nTc&&Xd.a("MipRecommendations");
this.Pa.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",z)}T9g(z){e.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Pa.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",z)}WDk(z){e.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.Pa.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",z)}EFk(z){e.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");
this.Pa.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}wcl(z,U=null){e.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Pa.raiseEvent("PolicyTipEvent",new vo(CommonUIStrings.l_PolicyBusinessBarTitle,z,CommonUIStrings.l_PolicyOverrideButton,U))}c$g(z,U,la,Da=!0){e.ULS.sendTraceTag(42074656,306,Da?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",U);Da=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let Ia=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,
Db=null,Ob=null;switch(z){case 2:Da=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;Ia=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:Ia=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:Da=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;Ia=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:Da=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;
Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:Da=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:Da=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;Ia=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 15:Da=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,Ia=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,Db=CommonUIStrings.l_LearnMore,Ob=()=>{this.Y3k()}}z=new rl(z,U,la,Da,Ia,Db,Ob);this.Pa.raiseEvent("SetPolicyLabelFailureEventKey",z)}zIe(z){this.Dwd=z}Pik(){this.sqd?(e.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),Bc.a.zJc(this.sqd)):e.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}QMj(z){if(!z.startsWith("<")||
-1===z.indexOf("Error")&&-1===z.indexOf("Unavailable"))return!1;e.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}F4g(){this.pvc&&(this.pvc.stop(),this.pvc=null)}QWi(z){if(!z)return"manual";switch(z.x6){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}YXi(z){if(!z)return"privileged";
z=z.x6;let U="privileged";if(4===z||1===z)U="standard";return U}nLc(z,U,la=null,Da=!1,Ia=0){this.jb.ka("WacLabelingGetPolicyLabelsIsEnabled")&&(this.kfa=z,this.Bxa=la,this.Qh&&(this.T_a=this.Qh.wi("WebServiceCall","Call Get Policy Endpoint On Server")),la={},la[Ck.a.L8h]=z,this.jb.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new ri.a(this.usb("getpolicylabels",Da),1,null,la,!0,2,Ia,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,U),this.Ei.send(z).nEb(Object(v.a)(this,
this.DYg,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.CYg,"onGetPolicyLabelsFailureCallback"))):this.Ei.vj(this.usb("getpolicylabels",Da),1,null,la,!0,2,Object(v.a)(this,this.DYg,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.CYg,"onGetPolicyLabelsFailureCallback"),Ia,void 0,void 0,void 0,void 0,"22"),this.RMb++,e.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.RMb))}W3k(z,U,la,Da=null){if(this.c3b){this.Qh&&(this.K1a=this.Qh.wi("WebServiceCall",
"Call Set Policy Endpoint On Server"));var Ia={};Ia[Ck.a.Wih]=z;U&&(Ia[Ck.a.Blh]=encodeURIComponent(U));this.Dwd&&(Ia[Ck.a.j8h]=this.Dwd);Da?(Ia[Ck.a.ylh]=this.QWi(Da),Ia[Ck.a.zlh]=this.YXi(Da)):(Ia[Ck.a.ylh]="manual",Ia[Ck.a.zlh]="privileged");this.Ggb&&this.Bv&&(Ia[Ck.a.Ivk]=this.Bv.PolicyLabelVersionToken);this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)&&1===Da.x6&&this.Bv.DefaultLabelType&&(Ia[Ck.a.V3k]=this.Bv.DefaultLabelType);this.jb.ka("SendHostAttributionInfoForPolicyLabelEnabled")?
(z=new ri.a(this.usb("setpolicylabel",!0),1,null,Ia,!0,2,Da,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,la),this.Ei.send(z).nEb(Object(v.a)(this,this.J_g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.I_g,"onSetPolicyLabelFailureCallback"))):this.Ei.vj(this.usb("setpolicylabel",!0),1,null,Ia,!0,2,Object(v.a)(this,this.J_g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.I_g,"onSetPolicyLabelFailureCallback"),Da,void 0,void 0,void 0,void 0,
"32");this.mMa++;e.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.mMa)}else e.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}Y3k(){const z=new Zb.StandardDialog,U=this.jb.Ha("BreadcrumbFolderUrl");U?(z.vd=11,z.Re(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),z.Re(2,CommonUIStrings.l_DialogOk)):(z.vd=0,z.Re(1,CommonUIStrings.l_DialogOk));
z.EFd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");z.yNk();z.mO(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,la=>{1===la&&U&&Bc.a.Um(U,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}KOd(z){switch(z){case 1:return pc.a.tAa(1,1);case 2:return pc.a.tAa(7,1);case 3:return pc.a.tAa(8,
1);default:return pc.a.tAa(7,0)}}yxi(z=null){if(!z)return pc.a.tAa(8,0);switch(z.x6){case 1:case 16:return pc.a.tAa(1,1);case 4:case 2:case 8:return pc.a.tAa(8,1);default:return pc.a.tAa(8,0)}}yEe(z){this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&appChrome.api.setAsyncRequestStatus("sensitivity",z)}}Object(h.a)(Uj,"PolicyManager",null,[519]);class No{constructor(){this.yBd=this.izd=this.hdf=this.Nqf=this.qWe=this.Qn=this.RLa=this.Da=this.lk=null}get name(){return"Common.App.Policy"}init(){K.AFrameworkApplication.fa.ka("ShouldInitCommonPolicyPackage")&&
(K.AFrameworkApplication.fa.ka("IsDataLossPreventionEnabledForUser")&&K.AFrameworkApplication.Aa&&(this.lk=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.lk.O4h(Object(v.a)(this,this.vcl,"showPolicyBusinessBar")),e.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),Sj.a.get_instance().Xj(6,()=>{this.lk.R8f()})),K.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&K.AFrameworkApplication.fa.ka("SupportsPolicies")?Sj.a.get_instance().Xj(6,Object(v.a)(this,
this.ahk,"onAfterRibbonBehaviorAttached")):qi.yeb(!1))}dispose(){}Wb(z){z.register(519,"Common.App.Policy.Contracts.IPolicyManager").ma().na(()=>new Uj(K.AFrameworkApplication.fa,K.AFrameworkApplication.He,K.AFrameworkApplication.Aa.hU,K.AFrameworkApplication.fa.Ec("MaxGetPolicyRetries",1),z.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),K.AFrameworkApplication.Aa.gb.Am));z.register(qi,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ma().na(()=>
new qi(K.AFrameworkApplication.Ta,K.AFrameworkApplication.Aa,K.AFrameworkApplication.fa,z.Be("Common.App.Policy.Contracts.IPolicyManager")));this.Da=z}ahk(){this.Qn=this.Da.pb("CommonUI.BusinessBar");this.lk||(this.lk=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.RLa=this.Da.resolve("Common.App.Policy.PolicyActor");K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&id.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.lk.iGd(Object(v.a)(this.RLa,this.RLa.Xah,"registerActionsHandler")):this.RLa.ub();this.lk.iGd(Object(v.a)(this,this.Mul,"updateLabelInfo"));K.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&(this.lk.cDf(Object(v.a)(this,this.Roj,"handleSetPolicyLabelFailure")),this.lk.g2h(Object(v.a)(this,this.Vyc,"addAutoPolicyBusinessBarEntry")),this.lk.$4h(Object(v.a)(this,this.Lva,"removeAutoPolicyBusinessBarEntry")),
this.lk.h2h(Object(v.a)(this,this.IFd,"addMandatoryLabellingBusinessBarEntry")),this.lk.a5h(Object(v.a)(this,this.tDe,"removeMandatoryLabellingBusinessBarEntry")))}Mul(){this.RLa.P3k();this.RLa.t2k();this.RLa.cDk();const z=this.lk.$ki();K.AFrameworkApplication.fa.ka("HasDocumentEditRights")&&!z?this.RLa.iol():e.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",K.AFrameworkApplication.fa.ka("HasDocumentEditRights"),
z);K.AFrameworkApplication.Aa.updateCommandUI()}vcl(z,U){this.izd&&this.Qn.Yba(38)&&this.Qn.removeEntry(this.izd);z=this.Obg(U.title,U.Jvk,38,U.Uhk,U.buttonText);K.AFrameworkApplication.Aa.gb.Xyc(z,!0)?(this.izd=z,e.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):e.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")}Roj(z,U){U.ecl&&(this.yBd&&this.Qn.Yba(21)&&this.Qn.removeEntry(this.yBd),
z=this.Obg(U.title,U.message,21,null,null,U.gUb,U.buttonText),K.AFrameworkApplication.Aa.gb.Xyc(z,!0)?(this.yBd=z,e.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):e.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))}Lva(z,U){(z=U.nTc?this.Nqf:this.qWe)&&this.Qn&&this.Qn.Yba(U.bob)&&this.Qn.removeEntry(z)}Vyc(z,U){this.Qn&&(this.lk.Lva(U.bob),z=new ao.a(U.title,U.message,
null),z.id=U.bob,z.closeable=!0,z.image=3,z.addButton(U.buttonText,U.gUb,U.buttonText,!0),this.Qn.Rh(z,!1),U.nTc?this.Nqf=z:this.qWe=z)}IFd(z,U){this.Qn&&(z=new ao.a(U.title,U.message,null),z.id=U.bob,z.closeable=!1,z.image=3,z.addButton(U.buttonText,U.gUb,U.buttonText,!1),this.Qn.Rh(z,!1),this.hdf=z)}tDe(){const z=this.hdf;z&&this.Qn&&this.Qn.Yba(z.id)&&this.Qn.removeEntry(z)}Obg(z,U,la,Da=null,Ia=null,Db=null,Ob=null){z=new ao.a(z,U,null);z.id=la;z.closeable=!0;Da&&z.dBf(Ia,Da);Db&&z.addButton(Ob,
Db,Ob);return z}static main(){va.a.instance.Ac(new No)}}Object(h.a)(No,"PackageManager",null,[2,3]);var Dk=d(285),tm=d(254),Je=d(127);class Ti extends tm.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=Object.assign(new Je.a,{T_:Ti.getTypeName(),B_:Ti.kl()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static kl(){return[]}}Object(h.a)(Ti,"SecurityShared",tm.a,[]);class Im extends Ti{constructor(){super();this.existingLabelPriority=null;this.H_=Object.assign(new Je.a,
{T_:Im.getTypeName(),B_:Im.kl()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static kl(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(h.a)(Im,"CLP",Ti,[]);var xo=d(454),fo=d(425),yn=d(673);class um extends Al.a{constructor(z){super();this.TenantId=null;this.TenantId=z}Ik(){return 103}}Object(h.a)(um,"GetAppliedPolicyIdRequest",Al.a,[]);class Hf extends Sys.EventArgs{constructor(z){super();this.Pga=z}}Object(h.a)(Hf,"OnAppliedPolicyReceivedEventArgs",Sys.EventArgs,[]);class go{constructor(z,
U,la){this.i9=this.Rie=this.QYc=null;this.va=new xk.a;this.T3b=!1;this.ni=z;this.R9a=U;this.$b=la;this.R9a.q3h(Object(v.a)(this,this.AWg,"onAppliedPolicyIdReady"));this.R9a.$3h(Object(v.a)(this,this.YYg,"onIsManuallyAppliedReady"))}r3h(z){this.va.addHandler("AppliedPolicyEventReceivedKey",z)}dispose(){this.R9a.lPk(Object(v.a)(this,this.AWg,"onAppliedPolicyIdReady"));this.R9a.IPk(Object(v.a)(this,this.YYg,"onIsManuallyAppliedReady"))}t6f(z,U){z?(this.i9=z,this.QYc=U,z=new Kg.a(new um(z),la=>{this.d8c(la)},
la=>this.Scb(la)),this.ni.Gb(z)):Uc.a.J(41735234,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}e5i(z,U){!U||I.a.Va(z)?Uc.a.J(51446608,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):(this.i9=z,this.Rie=U,z=new Kg.a(new um(z),la=>{this.d8c(la)},la=>this.Scb(la)),this.ni.Gb(z))}AWg(z,U){z="";I.a.Va(U.Pga)||(z=U.Pga);"00000000-0000-0000-0000-000000000000"===z?(U=I.a.Va(this.i9)?this.$b.Ha("TenantId"):this.i9,this.t6f(U,this.QYc)):this.Vte(z,null)}YYg(z,U){this.blk(U.T3b)}d8c(z){let U=
null;z.ServerError&&0!==z.ServerError.Code?U=Yg.a[z.ServerError.Code]:0!==z.StatusCode&&(U=Nf.a[z.StatusCode]);U&&this.Vte("",U)}Scb(){Uc.a.J(41735236,822,15,"OnGetAppliedPolicyIdFailed()");this.Vte("","ErrorGetAppliedPolicyIdFailed");return!0}Vte(z,U){U&&Uc.a.J(41735238,822,15,"OnAppliedPolicyIdReceived: error: "+U);this.QYc?this.QYc(z,U):Uc.a.J(50628552,822,15,"m_getAppliedPolicyIdCallback is null");Uc.a.J(587239824,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");z=
new Hf(z);this.va.raiseEvent("AppliedPolicyEventReceivedKey",z)}blk(z){this.Rie?this.Rie(z,null):Uc.a.J(51446615,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(h.a)(go,"AppliedPolicyIdService",null,[499,106]);class ue{constructor(z,U,la,Da){this.pzb=z;this.PDa=U;this.gT=la;this.la=Da}zQa(z){var U=z.automatic||{},la=U.sensitivityLabel||{};U=this.t7d()?U.id:la.id;la=z.recommended||{};const Da=la.sensitivityLabel||{};z=this.t7d()?la.id:Da.id;la=this.t7d()?la.policyTip:Da.policyTip;this.la.pptIsManuallyAppliedForAclpIsEnabled?
this.pzb.tFf(U,z,la,!this.gT.Bv.AppliedPolicyId||!this.PDa.T3b):this.pzb.tFf(U,z,la,!this.gT.Bv.AppliedPolicyId)}t7d(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(h.a)(ue,"AutoClpAnnotationEventHandler",null,[]);class sl{constructor(){this.ApplyLabelType=0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(h.a)(sl,"PolicyInfo",null,[]);var jp=d(973);class ho{constructor(){this.dDb=
this.startTime=null}}Object(h.a)(ho,"PollingData",null,[]);class Jm{constructor(z,U,la,Da,Ia,Db,Ob,sc,hc,Fc,Xc,md){this.NOg=this.iyb=!1;this.LXc=null;this.QIg=!1;this.ia=z;this.pzb=U;this.gT=la;this.i9=Da;this.eEg=new za.a;this.b1j=Ia;this.PDa=Db;this.yb=Ob;this.MOg=sc;this.oq=hc;this.wI=Fc;this.dv=Xc;this.hc=md;this.AMg=K.AFrameworkApplication.fa.Ec("ClpLabelPollingIntervalMs",3E4);this.zne=K.AFrameworkApplication.fa.Ec("ClpLabelPollingTimeoutMs",3E5);this.Xka=K.AFrameworkApplication.fa.Ha("UserName");
this.h$j=K.AFrameworkApplication.fa.Ha("UserPrincipalName");this.I_j=this.J1i()}J1i(){let z;if(K.AFrameworkApplication.fa.ka("DynamicVariableCLPFixEnabled")){if(z=K.AFrameworkApplication.fa.Ha("EditDocInClientUrl"))return Uc.a.J(512263634,822,50,"PptPolicyManager::GetDocLocation EditDocInClientUrl is not null"),z;Uc.a.J(512263633,822,10,"PptPolicyManager::GetDocLocation EditDocInClientUrl is null")}(z=K.AFrameworkApplication.fa.Ha("WOPISrc"))||Uc.a.J(512263632,822,10,"PptPolicyManager::GetDocLocation WOPISrc is null");
Uc.a.J(512263631,822,50,"PptPolicyManager::GetDocLocation WOPISrc is not null");return z}dispose(){this.pzb=null;if(this.iyb){this.gT.wdh(Object(v.a)(this,this.H_g,"onSetLabelSucceeded"));for(let z of this.eEg)this.gT.wdh(z)}}init(){this.pzb.ub();this.pzb.we();if(K.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&K.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")){const z=Object(A.a)(jp.a,Jf.App.Eh);z&&this.gT.kKk(Object(v.a)(z,z.P9h,"areAllCoauthorsInSessionClientMipTrusted"));this.gT.ewj(this.b1j);
0<this.AMg&&0<this.zne&&this.PDa.r3h(Object(v.a)(this,this.ojk,"onDocumentContentPolicyChanged"));K.AFrameworkApplication.isa&&this.MOg.RKk(()=>this.oq.GEh);this.oq.U2&&(Uc.a.J(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",this.oq.U2),this.gT.zIe(this.oq.U2));this.wI.f3h(()=>{Uc.a.J(512263629,822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.oq.U2);this.gT.zIe(this.oq.U2)})}this.gT.W5h(Object(v.a)(this,this.M9h,"applyUdpLabeling"));this.gT.wLk(Object(v.a)(this,
this.FDj,"isClpBlockedByAppSpecificScenario"));this.gT.k3h(Object(v.a)(this,this.k9h,"applyMandatoryLabeling"));this.gT.FGd(Object(v.a)(this,this.H_g,"onSetLabelSucceeded"));this.iyb=!0}M9h(z,U){U.J9k&&K.AFrameworkApplication.Ta.processAction(Sc.a.openInClient,2)}FDj(){const z=!this.hc.getState(2)&&!this.hc.Nug;this.NOg!==z&&(this.hc.oBg(),Uc.a.J(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",z),this.NOg=z);return z}get Pga(){return this.gT.Bv.AppliedPolicyId}JLk(z){this.gT.FGd(z);
this.eEg.add(z)}Suk(z,U,la){const Da=new sl;Da.TenantId=this.i9;Da.LabelId=z;Da.ApplyLabelType=U;Da.LabelJson=Jm.xSi(M.c(la));Da.SkipContentMarking=!1;Da.UserName=this.Xka;Da.UserPrincipalName=this.h$j;Da.DocLocation=this.I_j;Uc.a.J(512263627,822,50,"PersistLabelToWorker: Updating worker with received policy");this.ia.Ka(Sc.a.h5g,2,Da)}k9h(z,U){if(U&&0!==U.sHd){(z=1===U.sHd)?this.dv.iuh():(this.dv.fuh(),""!==U.ARg&&this.MOg.l9h(U.ARg));U=z?1:3;var la=K.AFrameworkApplication.Ta.mode;U!==la?Uc.a.J(512263625,
822,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",U,la):this.QIg=z}else Uc.a.J(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}H_g(z,U){this.Suk(U.G4g,U.x6,this.gT.Bv);Uc.a.J(512263624,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}nUd(z){z&&this.Pga?z=this.Pga.toLowerCase()===z.toLowerCase():(Uc.a.J(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",
!z,!this.Pga),z=z===this.Pga);Uc.a.J(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",z);return z}Nvk(z){const U=Object(A.a)(ho,z.customData);if(U){var la=+new Date-+U.startTime;Uc.a.J(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",la);this.nUd(U.dDb)||la>this.zne||U.dDb!==this.LXc?(Uc.a.J(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.nUd(U.dDb),la>this.zne,U.dDb!==this.LXc),
this.yb.Qg(z)):(Uc.a.J(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.gT.OPa(U.dDb,void 0,Jm.WMa,!0))}else Uc.a.J(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.yb.Qg(z)}Xhl(z){Uc.a.J(512263617,822,50,"SubmitPollingTask: Submitting new polling task");const U=new fd.a(2,2,this.AMg,Object(v.a)(this,this.Nvk,"pollingTaskCallback"),90,"113");U.customData=Object.assign(new ho,{startTime:new Date,dDb:z});this.yb.Gb(U)}ojk(z,
U){Uc.a.J(512263616,822,50,"OnDocumentContentPolicyChanged: Notification received");U.Pga||Uc.a.J(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.LXc=U.Pga;this.nUd(this.LXc)?Uc.a.J(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):this.Xhl(U.Pga)}static WMa(){const z=Jf.App.Eh.amIAlone,U=Jf.App.Eh.WMa;let la=!1;const Da=Object(A.a)(jp.a,Jf.App.Eh);Da&&(la=Da.Q9h());Uc.a.J(512263585,
822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",z,U,la);return z||U&&la}static xSi(z){z=z.replace(RegExp(":null","gi"),':""');return z=z.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(h.a)(Jm,"PptPolicyManager",null,[106]);class tl{constructor(z,U,la,Da){this.RYj=z;this.yc=U;this.Db=la;this.la=Da}ub(){this.RYj.pa(Sc.a.h5g,xf.a.application,Object(v.a)(this,this.xjj,"handleApplySensitivity"),4)}we(){}xjj(z,
U,la,Da,Ia){if(!(K.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&K.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&K.AFrameworkApplication.fa.ka("SupportsPolicies")))return 16;if(U.contextId!==xf.a.application)return 2;if(!Ia||!Object(yh.a)(sl,Ia))return 8;z=Object(A.a)(sl,Ia);if(I.a.Va(z.TenantId))return Uc.a.J(41793040,808,10,"The tenant id of policy info is empty or null"),
8;if(I.a.Va(z.LabelJson))return Uc.a.J(41793042,808,10,"The label json of policy info is empty or null"),8;if(1===la)return 32;la=this.yc.An;U=this.Db.rd(7);try{U.jc(la),la.eDb=z}finally{U&&U.dispose()}return 32}}Object(h.a)(tl,"SetPolicyActor",null,[244]);class yo{constructor(){this.A6b=this.m1c=this.$b=this.PDa=this.K=null;this.hNg=!0}get name(){return"PowerPointWebEditor.Policy"}Wb(z){this.K=z;this.K.register(499,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").ma().na(()=>new go(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.$b=this.K.resolve("Common.IAppSettingsManager");this.$b.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SensitivityTTVRImprovementEnabled",!1)?this.$b.Ztb(Object(v.a)(this,this.Bm,"onFullAppSettingsReady")):this.K.resolve("Common.IAppSettingsManager").ff(Object(v.a)(this,this.Bm,"onFullAppSettingsReady"))}dispose(){}Bm(){if(this.$b.ka("WacLabelingPoliciesIsEnabled")&&
this.$b.ka("SupportsPolicies")&&this.$b.ka("890"))this.PDa=this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),Sj.a.get_instance().Xj(10,Object(v.a)(this,this.bhk,"onAfterRibbonDisplayed")),Dk.a.vu(this.K.La("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>{const U=new tl(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"));
z=z.result;this.m1c=new Jm(this.K.resolve("Common.IActionManagerExtended"),U,z,this.$b.Ha("TenantId"),this.K.La("Common.Interface.IRtcBasicProvider"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),
this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.m1c.init()});else if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Qeb){const z=this.K.resolve("PowerPointWebEditor.IPPTRumTracker");z.y9(z.F4,z.Ejh)}}bhk(){Dk.a.vu(this.K.La("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>{const U=z.result;K.AFrameworkApplication.fa.ka("AutoClpIsEnabled")&&(Uc.a.J(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),this.A6b=new ib.a(()=>
new ue(this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),U,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.$b.Ha("TenantId"))),U.R2h(Object(v.a)(this,this.mKk,"registerAutoClpAnnotationEventHandler")),K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(U.B2h(Object(v.a)(this,this.BEc,"createAutoCLPSecurityNodes")),U.Z5h(Object(v.a)(this,this.Xsl,"updateAutoCLPLabelPriorityNode")),
U.$5h(Object(v.a)(this,this.Ysl,"updateAutoCLPSITNodes"))));(z=this.$b.Ha("AppliedPolicyId"))||K.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&K.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")?K.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?U.OPa(z,void 0,Jm.WMa):U.OPa(z):(z=this.$b.Ha("TenantId"),I.a.Va(z)?Uc.a.J(512274583,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(Uc.a.J(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),
this.PDa.t6f(z,(la,Da)=>{Da&&Uc.a.J(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+Da);I.a.Va(la)&&(la="",Uc.a.J(512274580,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));K.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?U.OPa(la,void 0,Jm.WMa):U.OPa(la)}),this.PDa.e5i(z,(la,Da)=>{Da?Uc.a.J(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+
Da):this.PDa.T3b=la}),this.m1c.JLk(Object(v.a)(this,this.Kul,"updateIsManuallyApplied"))))})}mKk(){const z=this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState");this.hNg&&(z.ln||this.m1c.QIg&&z.q4b)&&(this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(U=>{Uc.a.J(512274578,822,50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",
!1)?(U.xmb("AugLoop_SecurityClp_LabellingAnnotation"),U.whc("AugLoop_SecurityClp_LabellingAnnotation",Object(v.a)(this.A6b.value,this.A6b.value.zQa,"handleAnnotationEvent"))):(U.xmb("AugLoop_Automatic_Clp_LabellingAnnotation"),U.whc("AugLoop_Automatic_Clp_LabellingAnnotation",Object(v.a)(this.A6b.value,this.A6b.value.zQa,"handleAnnotationEvent")))}),this.hNg=!1)}BEc(z,U){z=[Object.assign(new fo.a,{id:"clp",body:Object.assign(new Im,{existingLabelPriority:U.existingLabelPriority,partialDocSITs:U.kOf,
fullDocSITs:U.jOf})})];const la=Object.assign(new xo.a,{parentPath:["session","doc","security"],items:z});this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Da=>{Uc.a.J(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");Da.submitOperation(la)})}Xsl(z,U){z=[Object.assign(new fo.a,{id:"clp",body:Object.assign(new Im,{existingLabelPriority:U.existingLabelPriority})})];const la=Object.assign(new yn.a,{parentPath:["session","doc",
"security"],items:z});this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Da=>{Uc.a.J(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");Da.submitOperation(la)})}Ysl(z,U){z=[Object.assign(new fo.a,{id:"clp",body:Object.assign(new Im,{partialDocSITs:U.kOf,fullDocSITs:U.jOf})})];const la=Object.assign(new yn.a,{parentPath:["session","doc","security"],items:z});this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Da=>
{Uc.a.J(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");Da.submitOperation(la)})}Kul(z,U){U&&(this.PDa.T3b=U.G4g&&0!==U.x6?2===U.x6||8===U.x6||16===U.x6?!0:!1:!1)}static main(){va.a.instance.Ac(new yo)}}Object(h.a)(yo,"PPTWebEditorPolicyPackage",null,[2,3]);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");
Type.registerNamespace("PowerPointWebEditor.RevisionTracking");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Fa.main();Type.registerNamespace("Common.App.CatchUpActivity");Tc.main();Type.registerNamespace("Common.Comments");Type.registerNamespace("Common.App.Rename");va.a.instance.Ac(new bd,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");va.a.instance.Ac(new kb);Type.registerNamespace("Common.App.SafeLinks");$e.main();Pi.main();jm.main();
km.main();sn.main();ee.main();Em.main();Type.registerNamespace("Common.App.OAuth");Um.main();va.a.instance.Ac(new $i);Pl.main();va.a.instance.Ac(new Jo);Lo.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");No.main();yo.main()},207:function(J,V,d){J=d(0);var h=d(55);class e{constructor(v,A,w,y,u){this.JEa=!1;this.Sxb=v;this.$wb=A;this.F6b=w;this.C2j=u;this.czb=y.UBa(w,A.name)}get aJf(){return this.F6b}Wb(v){this.czb.xHf();
this.$wb.Wb(v);this.czb.AZf()}init(){this.czb.Zt(this.$wb.name+"_d");this.C2j?this.Sxb.cwj(this,this.F6b):this.Sxb.bwj(this,this.F6b)}awj(){this.czb.gu(this.$wb.name+"_d");this.czb.zHf();this.$wb.init();this.JEa=!0;this.czb.DZf()}dispose(){this.JEa&&this.$wb.dispose()}get name(){return this.$wb.name}}Object(J.a)(e,"DelayLoadedPackage",null,[669,2,3]);class m{constructor(v,A){this.Sxb=null;v.execute(w=>{this.Sxb=w});this.FZj=A}create(v,A,w){return this.Sxb?new e(this.Sxb,v,A,this.FZj.value,w):v}static get instance(){return m.Ja||
(m.Ja=new m(h.a.instance.La("PowerPointWebEditor.DelayLoadedPackageInitializer"),h.a.instance.Be("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}m.Ja=null;Object(J.a)(m,"DelayLoadedPackageFactory",null,[]);d.d(V,"a",function(){return n});const n=(v,A)=>m.instance.create(v,A,!1)},227:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(77);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===
this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}lx(){return!0}static ypb(e,
m){return e+(m?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[106,492])},228:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.type=e;this.Ti=m}}h.Qo="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,[])},229:function(J,V,d){d.d(V,"a",function(){return n});J=d(0);var h=d(25),e=d(1088),m=d(45);class n{static A9f(){return n.k6h+"_"+e.a.X1b+"_"+m.a.zM(h.AFrameworkApplication.userName)+"_"}static b6f(v){return v+
"_"+e.a.X1b+"_"+m.a.zM(h.AFrameworkApplication.userName)+"_"}static ccg(){return n.sAk+"_"+e.a.X1b+"_"+m.a.zM(h.AFrameworkApplication.userName)+"_"}}n.u6="ack0";n.rpa="ack1";n.Uzc="ack2";n.k6h="ack3";n.TSb="ack4";n.lDf="ack7";n.mbe="ack8";n.Dph="ack9";n.dJd="ack10";n.dLe="ack13";n.i6h="DdaMethod";n.h6h="ControlId";n.NGd="SecurityOrigin";n.Xmb="ak0";n.LGd="ak1";n.oDf="ak2";n.USb="ak4";n.kDf="Office.AutoShowTaskpaneWithDocument";n.KGd="refreshRequired";n.mDf="value";n.n6h="errorCode";n.uSd="SolutionId";
n.sSd="MethodData";n.tSd="DynamicAddinCommandsMethodDispatchId";n.UIi="OsfControl";n.VIi="RibbonUpdaterData";n.Ejd="AddinShared";n.sAk="__OSF_PRIVATECATALOG_ADDINIDS";Object(J.a)(n,"AddinConstantsString",null,[])},276:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(985);class e{constructor(m){this.Nk=new h.a;this.sVa=m}xP(m){const n=m.id;let v=null;this.Nk.Jb(n)?v=this.Nk.ga(n):(this.sVa&&(v=this.sVa(m,()=>{this.Jhc(n)})),v&&this.Nk.$(n,v));return v}VE(m){m=m.id;return this.Nk.Jb(m)?
this.Nk.ga(m):null}Jhc(m){this.Nk.remove(m)}}Object(J.a)(e,"ShapeComponentViewManager",null,[336])},370:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"OAuthResult",null,[])},434:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(65),e=d(13),m=d(321),n=d(111);class v{constructor(A,w,y,u,E,G,I,H,K,C,Y,M){this.nUb=1;this.ZS=w;this.Wh=A;this.see=y;this.ve=K;this.Vo=C;this.gd=Y;this.IFa=H;this.iFa=E;this.jFa=u;this.FN=G;this.ve.addCssClass(this.Wh,"prControl");
this.Wh.style.width=this.ve.Lc(w);this.pr=I.WSf();this.wEa=I.VSf();this.pr.$ga(A);this.wEa.$ga(A,w,w);this.KUa=M;this.Xla()}dispose(){this.Zmc();this.clear();this.pr.dispose();this.wEa.dispose();this.ve.removeCssClass(this.Wh,"prControl")}get Rda(){return n.a.none}clear(){this.Qpa();this.Qob();this.XEb()}setZIndex(A){this.Wh.style.zIndex=String(A)}Kbc(){this.KUa.ya.style.zIndex=String(this.nUb+m.a.z$)}XEb(){this.KUa.ya.style.zIndex="0"}tfd(A,w,y=null){A=this.IFa.IOd(this.ZS,this.ZS,this.see,A,"",
y);this.pr.cIa(A,w)}H2a(A,w){this.wEa.add(A,w)}Qob(){this.wEa.clear()}Qpa(){this.pr.clear()}onClick(){return!0}Xla(){this.jFa&&this.Vo.ob(h.a.pointerOver,this.Wh,this.jFa);this.iFa&&this.Vo.ob(h.a.pointerOut,this.Wh,this.iFa);this.FN?this.gd.ob(h.a.click,this.Wh,this.FN):this.gd.ob(h.a.click,this.Wh,Object(e.a)(this,this.onClick,"onClick"));this.gd.ob(h.a.doubleClick,this.Wh,Object(e.a)(this,this.onClick,"onClick"))}Zmc(){this.jFa&&this.Vo.xb(h.a.pointerOver,this.Wh,this.jFa);this.iFa&&this.Vo.xb(h.a.pointerOut,
this.Wh,this.iFa);this.FN?this.gd.xb(h.a.click,this.Wh,this.FN):this.gd.xb(h.a.click,this.Wh,Object(e.a)(this,this.onClick,"onClick"));this.gd.xb(h.a.doubleClick,this.Wh,Object(e.a)(this,this.onClick,"onClick"))}}Object(J.a)(v,"ShapePawn",null,[337])},534:function(J,V,d){d.r(V);J=d(0);var h=d(375),e=d(1179),m=d(671),n;(function(xa){xa[xa.external=0]="external";xa[xa.msa=1]="msa";xa[xa.aad=2]="aad"})(n||(n={}));Object(J.b)("AuthorityType",n);var v=d(370);class A{constructor(xa){this.rQh=xa}initialize(){return Promise.resolve(0)}pVc(){return Promise.resolve(0)}q0(){h.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new v.a,{IsSuccess:!0,Token:this.rQh}))}Hkd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}zid(){return!1}w0b(){return"MockAuthTokenStrategy"}}Object(J.a)(A,"MockAuthTokenStrategy",null,[671]);var w=d(706);class y{static get(xa,Ga,na){if(!na)return xa;
let sa=0;return Promise.race([xa,new Promise(Ha=>{sa=window.setTimeout(()=>{Ha(Ga)},na)})]).then(Ha=>{window.clearTimeout(sa);return Promise.resolve(Ha)}).catch(()=>{window.clearTimeout(sa);return Promise.resolve(Ga)})}}Object(J.a)(y,"PromiseWithTimeout",null,[]);var u=d(25),E=d(259);class G{constructor(xa,Ga,na,sa,Ha){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=xa;this.scope=Ga;this.silentLogin=na;this.options=sa;this.correlationId=Ha}}Object(J.a)(G,
"TokenRequestParameters",null,[694]);var I=d(54),H=d(55);class K{constructor(){this.ezf=null;let xa=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.oJ),Ga=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.rzh);this.Wlb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",xa&&""!==xa?xa:"Unspecified",Ga&&""!==Ga?Ga:"Unspecified")}initialize(){return new Promise(xa=>{H.a.instance.La("Common.App.WopiIdentity.IWopiIdentity").execute(Ga=>{this.ezf=Ga;xa(0)})})}Bc(xa){const Ga=
["HTTPS:","API:"];let na=!1;const sa=xa.toLocaleUpperCase();for(const Ha of Ga)if(sa.startsWith(Ha)){na=!0;break}return na||this.MGj(xa)?xa+"/.default":xa}MGj(xa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(xa)}pVc(){return Promise.resolve(0)}q0(xa,Ga,na,sa,Ha,cb,Za){if(I.a.xDa){Ha=E.a.Zzl;if(!Ha)return Ga=Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ga);if(!Array.contains(Ha,
xa))return Ga=Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+xa}),Promise.resolve(Ga)}xa=this.Bc(na);na=new G(na,xa,!sa,null,u.AFrameworkApplication.userSessionId);return this.ezf.getAccessToken(na,Ga,Za).then(va=>Object.assign(new v.a,{IsSuccess:!0,Token:va.accessToken}),va=>Object.assign(new v.a,{IsSuccess:!1,ErrorCode:va}))}Hkd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}zid(){return!1}w0b(){return this.Wlb}}
Object(J.a)(K,"ParentFrameTokenStrategy",null,[671]);var C=d(13),Y=d(447),M=d(17);class P{constructor(){this.reject=this.resolve=null;this.startTime=0;this.y7g=this.sHf=null}}Object(J.a)(P,"PromiseWrapper",null,[]);class T{constructor(xa=0){this.gM=0;this.GPb=!1;this.Ut=new M.a;this._timeout=xa}enqueue(xa){return new Promise((Ga,na)=>{this.Ut.add(Object.assign(new P,{y7g:xa,resolve:Ga,reject:na}));this.process()})}process(){if(this.GPb||this.gM===this.Ut.count)return!1;const xa=this.Ut.ga(this.gM++);
try{this.GPb=!0,xa.y7g().then(Ga=>{this.GPb=!1;this.iNd(xa,Ga,null,!0)}).catch(Ga=>{this.GPb=!1;this.iNd(xa,null,Ga,!1)})}catch(Ga){this.GPb=!1,this.iNd(xa,null,Ga,!1)}return!0}iNd(xa,Ga,na,sa){if(sa){const Ha=()=>{xa.resolve(Ga);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}else{const Ha=()=>{xa.reject(na);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}}}Object(J.a)(T,"PromiseQueue",null,[]);class L{constructor(){this.correlationId=
this.resolve=null}}Object(J.a)(L,"ResolveWithCorrelation",null,[]);var aa=d(1158),Q=d(82),ea=d(520),ia=d(124);class ja extends Q.a{constructor(xa,Ga,na,sa,Ha,cb){super(!1,!1,!0);this.v_e=this.vfa=null;this.kaa=xa;this.tSh=na;this.mE=sa;this.cXh=Ha;this.q0a=cb;this.hA=document.createElement("iframe");this.hA.id="SharedAuthInteractiveFrame";this.hA.setAttribute("name","SharedAuthInteractiveFrame");this.hA.setAttribute("title","SharedAuthInteractiveFrame");this.hA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.hA.style.border="0";this.hA.style.height="48px";this.hA.style.width="190px";$addHandler(this.hA,"error",Object(C.a)(this,this.sok,"onSharedAuthFrameError"));xa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.kaa,Ga,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",u.AFrameworkApplication.userType);this.hA.src=xa;this.cKh=new Promise(Za=>{this.v_e=Za});this.w_e=!1}O4(){this.vfa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.tSh,
["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:u.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(C.a)(this,this.dxi,"createFrame"),["resolveDialogStyles"]:this.v_e}};this.vd=5;this.pj(CommonUIStrings.l_SignIn,Object(C.a)(this,this.X7k,"sharedAuthConsentDialogHandler"),this.vfa)}QBh(xa=!1,Ga=5){this.vfa&&this.vfa.bodyControls&&(!0!==Object(aa.a)(Object,this.vfa.bodyControls).frameLoaded&&(Object(aa.a)(Object,this.vfa.bodyControls).frameLoaded=!0),xa!==Object(aa.a)(Object,
this.vfa.bodyControls).frameLoadSuccess&&(Object(aa.a)(Object,this.vfa.bodyControls).frameLoadSuccess=xa),Ga!==this.vfa.dialogButtonsOption&&(this.vfa.dialogButtonsOption=null,this.vd=Ga),this.update(this.vfa))}Scl(xa,Ga){const na=new ea.a(ia.a.a8k);na.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:u.AFrameworkApplication.isRtl,["messageCorrelationId"]:xa,["dialogStyles"]:Ga};this.mE.ffb(na,this.hA.contentWindow,this.kaa)}I4f(){this.QBh(!1,
6)}get vnh(){return this.hA}get HFi(){return this.cKh.then(xa=>{this.w_e=!0;return xa})}get IFi(){return this.w_e}sok(){this.I4f()}dxi(){return this.hA}X7k(xa){0===xa&&(this.cXh.reject(Object.assign(new v.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.q0a(null))}}Object(J.a)(ja,"SharedAuthConsentDialog",Q.a,[696]);var D=d(652),pa=d(94),Z=d(214),oa=d(62),Ba=d(113),Ma=d(87);class za{constructor(){this.hA=null;this.dsc=0;this.Gkb=this.omb=this.xod=
this.q0a=this.wY=this.Dxf=null;this.mE=new D.a(null,null);this.Wlb="SharedAuthTokenStrategy Unloaded";this.kaa=E.a.Z7k;this.buf=E.a.Y7k;this.M0e=E.a.enableConsoleLogging;this.NKh=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.uVh=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.ULa={};this.lNh=new T(1500)}w0b(){return this.Wlb}initialize(){var {OAuthManager:xa}=d(534);
if("loadFrame"in this.ULa)return this.ULa.loadFrame.sHf;if(!this.kaa)return pa.Health.instance.recordKpiFailure(xa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),h.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);xa=this.aid("loadFrame");this.dsc=oa.a.oj();var Ga=this.kaa+this.buf+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+u.AFrameworkApplication.userSessionId+"&WacUserType="+u.AFrameworkApplication.userType;
this.hA=document.createElement("iframe");this.eQc(this.hA);this.hA.style.cssText="height:0;width:0;display:none;";this.hA.id="SharedAuthFrame";this.hA.setAttribute("name","SharedAuthFrame");this.hA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.hA.setAttribute("title","SharedAuthFrame");this.hA.src=Ga;document.body.appendChild(this.hA);Ga=oa.a.oj()-this.dsc;h.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
Ga,this.hA.src);return xa}pVc(xa){this.xod=xa;const Ga=new ea.a(ia.a.ynh);Ga.Values=this.XGf(xa);xa=this.aid("initFrame");this.mE.ffb(Ga,this.hA.contentWindow,this.kaa);h.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return xa}q0(xa,Ga,na,sa,Ha,cb){const Za=new ea.a(ia.a.b8k),va=this.xcg();Za.Values=this.fyh(xa,Ga,na,sa,Ha,cb,va);xa=this.aid(va);sa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.lNh.enqueue(()=>new Promise(Fa=>{this.Tpl(cb,Za,Fa,va)})):(this.mE.ffb(Za,this.hA.contentWindow,this.kaa),h.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ga));return xa}Tpl(xa,Ga,na,sa){const Ha=this.ULa[sa];Ha&&(this.omb=Ga,this.q0a=Object.assign(new L,{resolve:na,correlationId:sa}),this.wY=new ja(this.kaa,this.buf,xa,this.mE,Ha,na),this.wY.O4())}xcg(){return Ba.a.create().toString()}fyh(xa,Ga,na,sa,Ha,cb,Za){const va={};va.appName=
xa;va.appId=Ga;va.target=na;va.withPopup=sa;va.claims=Ha;va.promptMessage=cb;va.messageCorrelationId=Za;return va}eQc(xa){$addHandler(xa,"load",Object(C.a)(this,this.Ikk,"onIFrameLoaded"));$addHandler(xa,"error",Object(C.a)(this,this.mve,"onIFrameError"));this.mE.Tyc(this.kaa);this.mE.Vt(ia.a.Bnh);this.mE.ZA(ia.a.Bnh,Object(C.a)(this,this.Onk,"onScriptLoaded"));this.mE.Vt(ia.a.Anh);this.mE.ZA(ia.a.Anh,Object(C.a)(this,this.Nnk,"onScriptInitialized"));this.mE.Vt(ia.a.wnh);this.mE.ZA(ia.a.wnh,Object(C.a)(this,
this.pkk,"onGetTokenResponse"));this.mE.Vt(ia.a.Cnh);this.mE.ZA(ia.a.Cnh,Object(C.a)(this,this.wlk,"onLoginResponse"));this.mE.Vt(ia.a.znh);this.mE.ZA(ia.a.znh,Object(C.a)(this,this.Wkk,"onInteractiveFlowReady"));this.mE.Vt(ia.a.xnh);this.mE.ZA(ia.a.xnh,Object(C.a)(this,this.Ekk,"onHideDialog"));this.mE.Vt(ia.a.unh);this.mE.ZA(ia.a.unh,Object(C.a)(this,this.kik,"onCloseDialog"))}aid(xa){const Ga=new P;Ga.startTime=oa.a.oj();const na=new Promise((sa,Ha)=>{Ga.resolve=sa;Ga.reject=Ha});Ga.sHf=na;this.ULa[xa]=
Ga;return na}Ikk(){const xa=oa.a.oj()-this.dsc;h.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",xa)}mve(xa){const {OAuthManager:Ga}=d(534),na=oa.a.oj()-this.dsc,sa=Object.assign(new Ma.a,{durationMs:na});pa.Health.instance.recordKpiFailure(Ga.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,sa);h.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",na,this.M0e?JSON.stringify(xa):"")}Onk(xa){const {OAuthManager:Ga}=d(534),
na=this.ULa.loadFrame;var sa=oa.a.oj()-na.startTime,Ha=xa.Values.AuthLibrary.toString();xa=xa.Values.Success.toString();h.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",xa,Ha,sa);Ha&&(this.Wlb="SharedAuthTokenStrategy "+Ha);Ha=Boolean.parse(xa);Ha||(xa=Z.a.pz(),void 0!==xa&&null!==xa&&(xa.set("AuthLibrary",this.w0b()),sa=Object.assign(new Ma.a,{durationMs:sa,extendedProperties:xa}),pa.Health.instance.recordKpiFailure(Ga.kpiName,"SharedAuthStrategyInitFailed",
!1,!0,sa)));na.resolve(Ha?0:1)}Nnk(xa){if(xa.Values.interactive&&this.omb&&this.omb.Values.messageCorrelationId){const na=this.omb.Values.messageCorrelationId.toString();if(xa.Values.interactive&&this.wY){this.wY.HFi.then(sa=>{this.mE.ffb(this.omb,this.wY.vnh.contentWindow,this.kaa);this.wY.Scl(na,sa);this.wY.QBh(!0);this.omb=null});return}}xa=this.ULa.initFrame;const Ga=oa.a.oj()-xa.startTime;h.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ga);xa.resolve(0)}pkk(xa){if(xa.Values.messageCorrelationId&&
xa.Values.messageCorrelationId.toString()){var Ga=xa.Values.messageCorrelationId.toString(),na=this.ULa[Ga];if(na){var sa=oa.a.oj()-na.startTime;h.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",sa);xa.Values.isSuccess&&xa.Values.isSuccess?na.resolve(xa.Values.response):na.reject(xa.Values.response);this.Kyh(Ga)}else h.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(573112904,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}Wkk(){if(this.wY.IFi)this.wY.I4f();else if(this.xod&&this.wY){const xa=new ea.a(ia.a.ynh);xa.Values=this.XGf(this.xod,!0);this.mE.ffb(xa,this.wY.vnh.contentWindow,this.kaa)}}Ekk(){this.wY&&this.wY.a4d()}kik(xa){xa.Values.cancelled&&xa.Values.cancelled&&xa.Values.messageCorrelationId&&this.Kyh(xa.Values.messageCorrelationId.toString());this.wY&&this.wY.hide()}XGf(xa,Ga=!1){const na={};na.appIds=this.PXi();
na.upn=xa.loginHint;na.authority=xa.authority;na.authorityType=Object(e.a)(n,xa.authorityType);na.tenantId=xa.tenantId;na.correlationId=u.AFrameworkApplication.userSessionId;na.enableConsoleLogging=this.M0e;na.enablePopupFlash=this.NKh;na.skipUpnCheck=this.uVh;na.interactive=Ga;return na}PXi(){const xa=[],Ga=E.a.rHd;for(let na in Ga)Array.add(xa,Ga[na]);return xa}Hkd(xa,Ga,na,sa,Ha,cb){const Za=new ea.a(ia.a.$7k),va=this.xcg();Za.Values=this.fyh(xa,Ga,na,sa,Ha,cb,va);this.Dxf=Za;xa=this.aid(va);h.ULS.sendTraceTag(555049437,
3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ga);this.Hal();return xa}zid(){return!0}Hal(){this.Gkb||(this.Gkb=new Y.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.Gkb.id=16,this.Gkb.x9d=!1,this.Gkb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{h.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.mE.ffb(this.Dxf,this.hA.contentWindow,this.kaa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,
!0),u.AFrameworkApplication.Aa.gb.Xyc(this.Gkb,!0)||h.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}wlk(xa){if(xa.Values.messageCorrelationId&&xa.Values.messageCorrelationId.toString()){var Ga=this.ULa[xa.Values.messageCorrelationId.toString()];if(Ga){var na=oa.a.oj()-Ga.startTime;h.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",na);xa.Values.isSuccess&&xa.Values.isSuccess?Ga.resolve(xa.Values.response):
Ga.reject(xa.Values.response)}else h.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}Kyh(xa){this.q0a&&this.q0a.correlationId===xa&&(this.q0a.resolve(null),this.q0a=null)}}Object(J.a)(za,"SharedAuthTokenStrategy",null,[671]);class ka{constructor(xa){this.Yzd=xa;this.Wlb="UnsupportedAuthTokenStrategy Reason="+
m.a[this.Yzd]}initialize(){return Promise.resolve(0)}pVc(){return Promise.resolve(0)}q0(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:m.a[this.Yzd],ErrorMessage:"Unable to get a token. Reason: ["+m.a[this.Yzd]+"]"}))}Hkd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}zid(){return!1}w0b(){return this.Wlb}}Object(J.a)(ka,
"UnsupportedAuthTokenStrategy",null,[671]);var qa=d(229);d.d(V,"OAuthManager",function(){return Ja});class Ja{constructor(xa=null){this.x5=0;this.L0=null;this.u1a=0;const Ga=oa.a.oj();this.dNh=this.gFi(xa).then(na=>na?this.wvj():(h.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.hD(),Math.floor(oa.a.oj()-Ga)),na=Z.a.pz(),void 0!==na&&null!==na&&(na.set("AuthLibrary",this.hD()),na=Object.assign(new Ma.a,{durationMs:Math.floor(oa.a.oj()-
Ga),extendedProperties:na}),pa.Health.instance.recordKpiFailure(Ja.kpiName,"StrategyPickFailed",!1,!0,na)),Promise.resolve(1))).then(na=>0!==na?Promise.resolve(na):this.kTj())}hFi(){var xa=E.a.cdk;xa&&0<xa.length?(this.x5=1,this.L0=new A(xa)):u.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||u.AFrameworkApplication.fa.ka("IsO365CommercialHost")?u.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.x5=2,this.L0=new ka(this.x5)):(xa=w.a.getAuthContext().loginHint)&&xa.length?E.a.u7a?(this.x5=1,
this.L0=new K):(this.x5=1,this.L0=new za):(this.x5=3,this.L0=new ka(this.x5)):(this.x5=4,this.L0=new ka(this.x5))}hD(){return this.L0?this.L0.w0b()||"Unknown":"None"}gFi(xa=null){h.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Ga=oa.a.oj();return u.AFrameworkApplication.fa.E3i().then(na=>{na?(this.hFi(),xa&&(this.L0=xa),h.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",E.a.clientVersion,
E.a.appVersion,E.a.SHi,this.hD(),Math.floor(oa.a.oj()-Ga))):h.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(oa.a.oj()-Ga));return Promise.resolve(na)},()=>{h.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(oa.a.oj()-Ga));return Promise.resolve(!1)})}wvj(){h.ULS.sendTraceTag(573390991,
3E3,50,"Initializing {0}",this.hD());const xa=oa.a.oj();return y.get(this.L0.initialize(),2,E.a.qAe).then(Ga=>{if(0===Ga)h.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.hD(),Math.floor(oa.a.oj()-xa));else if(1===Ga){h.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.hD(),Math.floor(oa.a.oj()-xa));var na=Z.a.pz();void 0!==na&&null!==na&&(na.set("AuthLibrary",this.hD()),na=Object.assign(new Ma.a,
{durationMs:Math.floor(oa.a.oj()-xa),extendedProperties:na}),pa.Health.instance.recordKpiFailure(Ja.kpiName,"StrategyInitFailed",!1,!0,na))}else 2===Ga&&(h.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.hD(),Math.floor(oa.a.oj()-xa)),na=Z.a.pz(),void 0!==na&&null!==na&&(na.set("AuthLibrary",this.hD()),na=Object.assign(new Ma.a,{durationMs:Math.floor(oa.a.oj()-xa),extendedProperties:na}),pa.Health.instance.recordKpiFailure(Ja.kpiName,
"StrategyInitTimedOut",!1,!0,na)));return Promise.resolve(Ga)},()=>{h.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.hD(),Math.floor(oa.a.oj()-xa));return Promise.resolve(1)})}kTj(){h.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.hD());const xa=oa.a.oj();return y.get(this.L0.pVc(w.a.getAuthContext()),2,E.a.qAe).then(Ga=>{if(0===Ga)h.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.hD(),
Math.floor(oa.a.oj()-xa));else if(1===Ga){h.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.hD(),Math.floor(oa.a.oj()-xa));var na=Z.a.pz();void 0!==na&&null!==na&&(na.set("AuthLibrary",this.hD()),na=Object.assign(new Ma.a,{durationMs:Math.floor(oa.a.oj()-xa),extendedProperties:na}),pa.Health.instance.recordKpiFailure(Ja.kpiName,"StrategyLoadFailed",!1,!0,na))}else 2===Ga&&(h.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.hD(),Math.floor(oa.a.oj()-xa)),na=Z.a.pz(),void 0!==na&&null!==na&&(na.set("AuthLibrary",this.hD()),na=Object.assign(new Ma.a,{durationMs:Math.floor(oa.a.oj()-xa),extendedProperties:na}),pa.Health.instance.recordKpiFailure(Ja.kpiName,"StrategyLoadTimedOut",!1,!0,na)));return Promise.resolve(Ga)},()=>{h.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.hD(),Math.floor(oa.a.oj()-xa));return Promise.resolve(1)})}q0(xa,Ga,na=null){return this.VIb(xa,
Ga,!1,null,"",na)}gyh(xa,Ga,na,sa,Ha=null){return this.VIb(xa,Ga,!0,na,sa,Ha)}VIb(xa,Ga,na,sa,Ha,cb,Za=0){Za+=1;h.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",xa,this.Teb(xa,Ga),this.hD(),Za);var va=Z.a.pz();void 0!==va&&null!==va&&(va.set("AuthLibrary",this.hD()),va.set("AppName",xa),va.set("Target",this.Teb(xa,Ga)),pa.Health.instance.recordKpiUsage(Ja.kpiName,0,"WacOAuthFC",va));if(!E.a.isEnabled){var Fa;return this.fce((Fa=
new v.a,Fa.IsSuccess=!1,Fa.Token=null,Fa.ErrorCode="NotEnabled",Fa.ErrorMessage="OAuthManager is disabled.",Fa),xa)}const Ca=E.a.rHd[xa];if(void 0===Ca||null===Ca){h.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",xa);var La;return this.fce((La=new v.a,La.IsSuccess=!1,La.Token=null,La.ErrorCode="DisallowedApp",La.ErrorMessage="Disallowed appName: "+xa,La),xa)}const nb=oa.a.oj(),Nb=this;va=this.dNh.then(bb=>Nb.dBj(xa,
Ca,Ga,na,sa,Ha,cb,bb));Fa=na?0:E.a.qAe;let Rb;La=(Rb=new v.a,Rb.IsSuccess=!1,Rb.Token=null,Rb.ErrorCode="authTokenStrategy_timeout",Rb.ErrorMessage="Auth Strategy timed out after ["+Fa+"] ms when fetching token",Rb);let Ya=this,Qb=this;return y.get(va,La,Fa).then(bb=>Za<=Ja.Obk&&(bb.ErrorCode===Ja.owh||bb.ErrorCode===Ja.Chl)?(h.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Za,Math.floor(oa.a.oj()-nb)),Ya.VIb(xa,Ga,na,sa,Ha,cb,Za)):bb.ErrorCode===Ja.syg&&
!na&&(h.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Za,Ja.iZf),Ja.eKi&&Ya.L0.zid()&&Ya.L0.Hkd(xa,Ca,Ga,na,sa,Ha).then(Bb=>Promise.resolve(Ya.EVc(Bb,xa,Ga,Ca,nb))).catch(()=>{let Bb;const Eb=(Bb=new v.a,Bb.IsSuccess=!1,Bb.Token=null,Bb.ErrorCode="authTokenStrategy_failure",Bb.ErrorMessage="LoginPopup failed, GetToken could not be called",Bb);return Promise.resolve(Ya.EVc(Eb,xa,Ga,Ca,nb))}),Ja.iZf)?Ya.VIb(xa,Ga,!0,sa,Ha,cb,
Za):Promise.resolve(Ya.EVc(bb,xa,Ga,Ca,nb))).catch(()=>{let bb;const Bb=(bb=new v.a,bb.IsSuccess=!1,bb.Token=null,bb.ErrorCode="authTokenStrategy_failure",bb.ErrorMessage="Auth Strategy failed with an unknown error",bb);return Promise.resolve(Qb.EVc(Bb,xa,Ga,Ca,nb))})}dBj(xa,Ga,na,sa,Ha,cb,Za,va){return 1===va||2===va?this.fce(Object.assign(new v.a,{IsSuccess:!1,Token:null,ErrorCode:1===va?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),xa):this.L0.q0(xa,Ga,na,sa,
Ha,cb,Za).then(Fa=>Promise.resolve(this.RUg(Fa,!0,xa))).catch(Fa=>Promise.resolve(this.RUg(Fa,!1,xa)))}EVc(xa,Ga,na,sa,Ha){const cb={};Ha=oa.a.oj()-Ha;cb.IsSuccess=xa.IsSuccess;cb.ErrorCode=xa.IsSuccess?"Success":xa.ErrorCode||"";cb.ErrorMessage=xa.IsSuccess?"Success":this.Teb(Ga,xa.ErrorMessage||"");cb.Target=this.Teb(Ga,na||"");cb.TimeInMS=Math.floor(Ha);cb.AuthLibrary=this.hD();cb.AppName=Ga;cb.AuthorityType=Object(e.a)(n,w.a.wKc());cb.UserType=this.Pgj(w.a.getAuthContext());cb.IsAuthSupportedInSession=
m.a[this.x5];cb.RequestCount=++this.u1a;cb.AppId=sa;h.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(cb));xa.IsSuccess||(na=Z.a.pz(),void 0!==na&&null!==na&&(na.set("AppName",Ga),na.set("AuthLibrary",this.hD()),na.set("ErrorCode",xa.ErrorCode),na.set("ErrorMessage",this.Teb(Ga,xa.ErrorMessage)),Ga=Object.assign(new Ma.a,{durationMs:Ha,extendedProperties:na}),pa.Health.instance.recordKpiFailure(Ja.kpiName,"TryGetTokenFailure",!1,!0,Ga)));return xa}fce(xa,Ga){h.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",
Ga,this.Teb(Ga,xa.ErrorMessage));const na=Z.a.pz();void 0!==na&&null!==na&&(na.set("AppName",Ga),na.set("AuthLibrary",this.hD()),na.set("ErrorCode",xa.ErrorCode),na.set("ErrorMessage",this.Teb(Ga,xa.ErrorMessage)),Ga=Object.assign(new Ma.a,{extendedProperties:na}),pa.Health.instance.recordKpiFailure(Ja.kpiName,"FailureBeforeGetToken",!1,!0,Ga));return Promise.resolve(xa)}otg(xa){return xa===qa.a.Ejd}Teb(xa,Ga){return this.otg(xa)&&Ga?"REDACTED":Ga}Pgj(xa){return u.AFrameworkApplication.fa.ka("IsAnonymousUser")?
"anonymous":!xa.loginHint||1>xa.loginHint.length?"empty":-1<xa.loginHint.indexOf("guest#")?"guest":-1<xa.loginHint.indexOf("ext#")?"external":0>xa.upn.indexOf("@")?"no-at":"supported"}mCj(){return 1===this.x5}RUg(xa,Ga,na){let sa=null,Ha=null,cb=null,Za=null;xa?xa.ErrorCode||xa.ErrorMessage?(Ha=xa.ErrorCode?xa.ErrorCode:Ja.e0f,cb=xa.ErrorMessage?xa.ErrorMessage:"No message"):xa.Token?Ga?sa=xa.Token:(Ha=Ja.IMk,cb="A rejected promise returned a token."):(Ha=Ja.e0f,cb=JSON.stringify(xa)):(Ha=Ja.Vek,
cb="No result came from Auth Token Strategy");xa&&xa.Telemetry&&!this.otg(na)&&(Za=xa.Telemetry,h.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Za)));if(Ha===Ja.qdk||Ha===Ja.Uml)Ha=Ja.owh,cb="Auth Library Timed Out";Ha===Ja.vai&&-1<cb.indexOf(Ja.qYh)&&(Ha=Ja.syg);if(Ha||cb)sa=null;return Object.assign(new v.a,{IsSuccess:!!sa,Token:sa,ErrorCode:Ha,ErrorMessage:cb,Telemetry:Za})}static get iZf(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",
!1)}static get eKi(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Ja.Uml="token_renewal_error";Ja.e0f="Exception";Ja.Vek="NoResult";Ja.IMk="RejectToken";Ja.qdk="monitor_window_timeout";Ja.owh="Timeout";Ja.Chl="authTokenStrategy_timeout";Ja.vai="login_required";Ja.qYh="AADSTS50058";Ja.syg="Cookies Disabled";Ja.kpiName="OAuthManager";Ja.Obk=2;Object(J.a)(Ja,"OAuthManager",null,[631])},670:function(J,V,d){d.d(V,"a",function(){return y});
J=d(0);var h=d(1158),e=d(13),m=d(100),n=d(35),v=d(26),A=d(434),w=d(111);class y{constructor(u,E,G,I,H,K){this.h1a=this.oEa=null;this.Sq=Object(h.a)(A.a,I.oPd(u,E,G,Object(e.a)(this,this.jC,"onPointerOver"),Object(e.a)(this,this.Py,"onPointerOut"),H));this.pFa=0;this.Mc=K;this.Mc.tB(Object(e.a)(this,this.VA,"onSessionEnd"));this.clear()}dispose(){this.Sq.dispose();this.oEa=null}get Rda(){return this.h1a}setZIndex(u){this.Sq.setZIndex(u)}zBf(u,E,G){this.h1a=u;this.oEa=E;this.Sq.tfd("UnreadNotification_16x16x32",
this.Rda,G)}clear(){this.Sq.clear();this.h1a=w.a.none}vwa(){this.pZ();this.Sq.H2a(this.Rda,this.BXb);this.Sq.Kbc()}pZ(){this.Sq.Qob();this.Sq.XEb()}VA(){v.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.pFa);0<this.pFa&&m.c(n.a.lLd)}get BXb(){return this.oEa?this.oEa():""}jC(){this.vwa();v.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.pFa+=1;return!0}Py(){this.pZ();return!0}}Object(J.a)(y,"ShapeRevisionTrackingPawn",null,[337])},671:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported"})(h||(h={}));Object(J.b)("SupportStatus",h)},672:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,n,v,A,w,y,u=null,E=null,G=!1,I=null,H=null,K=null,C=null,Y=!1,M=null,P=null,T=null,L=null,aa=null,Q=null){this.url=
e;this.azl=m;this.body=n;this.headers=v;this.PKe=A;this.priority=w;this.state=y;this.TDh=u;this.hic=E;this.Vi=G;this.PDk=I;this.v_k=H;this.name=K;this.GCb=C;this.jWd=Y;this.Ywe=M;this.my=P;this.$tb=T;this.UEb=L;this.vsj=aa;this.responseType=Q}}Object(J.a)(h,"ClientRequest",null,[])},673:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(510);var h=d(127);class e extends V.a{constructor(){super();this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.kl()})}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static kl(){return["AugLoop_Core_Operation"]}}
Object(J.a)(e,"UpdateOperation",V.a,[])},706:function(J,V,d){J=d(0);class h{}Object(J.a)(h,"AuthContext",null,[]);var e=d(25),m=d(259);d.d(V,"a",function(){return n});class n{static getAuthContext(){const v=e.AFrameworkApplication.fa.Ha("UserPrincipalName")||"";let A=v;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(A=m.a.ngk||v);return Object.assign(new h,{upn:v,loginHint:A,authority:m.a.authority,authorityType:n.wKc(),tenantId:e.AFrameworkApplication.fa.Ha("TenantId")||
""})}static wKc(){let v=0;const A=n.y6f();"aad"===A.toLowerCase()?v=2:"msa"===A.toLowerCase()&&(v=1);return v}static y6f(){return e.AFrameworkApplication.fa.Ha("HostAuthType")||""}}Object(J.a)(n,"OAuthIdentity",null,[])},715:function(J,V,d){J=d(0);var h=d(25),e=d(113),m=d(78),n=d(13),v=d(33),A=d(85),w=d(26),y=d(257);class u{constructor(){this.TenantId=this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=
this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=!1}}Object(J.a)(u,"PodsInfo",null,[]);d.d(V,"a",function(){return E});class E{constructor(G,I,H,K,C,Y,M){w.a.J(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.$b=M;this.Uv=G;this.Xa=I;this.Mc=H;this.Gy=K;this.Kd=C;this.yb=Y;this.iyb=!1;this.IUa=0;this.$b.ff(Object(n.a)(this,this.initialize,"initialize"))}initialize(){w.a.J(512262872,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);
this.Mc.uB(Object(n.a)(this,this.jo,"onSessionRehydrated"));this.Gy.Qmb(Object(n.a)(this,this.Hda,"onPodSessionRefreshed"));this.iyb=!0}dispose(){this.iyb&&(this.Mc.hea(Object(n.a)(this,this.jo,"onSessionRehydrated")),this.Gy.reb(Object(n.a)(this,this.Hda,"onPodSessionRefreshed")),this.iyb=!1)}sendInfoToPods(){var G=this.$b.Ha("361"),I=this.Xa.podSessionId;const H=this.Xa.Wj,K=h.AFrameworkApplication.userSessionId,C=e.a.create().toString();w.a.J(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",
C);G=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",G,I);I={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};I["X-UserSessionId"]=K;I["X-CorrelationID"]=C;I["X-WacCluster"]=H;try{const Y=Object.assign(new u,{UserName:this.$b.Ha(A.a.Fsk),UserId:this.$b.Ha("387"),ProviderId:this.$b.Ha("388"),FileSource:this.$b.Ha("FileSource"),LoggableUserId:this.$b.Ha("LoggableUserId"),TenantId:this.$b.Ha("TenantId"),BrowserCacheAllowed:this.$b.ka("535")&&this.$b.ka("431"),
EnableMacrosForProtectedFile:h.AFrameworkApplication.lYb,ServerDocId:this.$b.Ha("ServerDocId"),ComplianceDomainPrefix:h.AFrameworkApplication.fa.Ha("ComplianceDomainPrefix"),IsO365CommercialHost:this.$b.ka("IsO365CommercialHost"),IsO365ConsumerHost:this.$b.ka("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.$b.ka("PPTClpSwitchEnabled")&&this.$b.ka("SupportsOfficeClientCoauthoring")}),M=v.c(Y);this.Uv.vj(G,2,M,I,!1,1,Object(n.a)(this,this.Vnk,"onSendUserInfoSucceeded"),Object(n.a)(this,this.Unk,
"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,y.a("6"))}catch(Y){w.a.J(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",Y)}}Vnk(){w.a.J(512262869,804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.IUa=0}Unk(){w.a.J(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.IUa?this.fVk():this.qij()}fVk(){this.IUa++;w.a.J(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",this.IUa);const G=new m.a(1,
1,5E3,Object(n.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.yb.Gb(G)}qij(){w.a.J(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",this.IUa);this.Kd.qG(307,null);this.IUa=0}jo(){this.IUa=0;w.a.J(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}Hda(){this.IUa=0;w.a.J(512262864,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(J.a)(E,"PodsInfoSender",null,[])},940:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h{constructor(){this.handler=null}}Object(J.a)(h,"SetAnnotationResultCallbackParameters",null,[])},999:function(J,V,d){J=d(0);var h;(function(m){m[m.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";m[m.peopleImageClassName=1]="peopleImageClassName";m[m.peopleImageClusterPath=4]="peopleImageClusterPath";m[m.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";m[m.imageDimension=6]="imageDimension";m[m.rtl=8]="rtl";m[m.pointerInputManager=
9]="pointerInputManager";m[m.clickInputManager=10]="clickInputManager";m[m.vertical=11]="vertical";m[m.zIndex=12]="zIndex";m[m.contextMenuInputManager=13]="contextMenuInputManager";m[m.imageDomElement=14]="imageDomElement";m[m.useIdleTooltip=15]="useIdleTooltip";m[m.viewportBoundsCallback=16]="viewportBoundsCallback";m[m.flipHorizontalDirection=17]="flipHorizontalDirection";m[m.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";m[m.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";
m[m.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||(h={}));Object(J.b)("PresenceTooltipSettingKeys",h);d.d(V,"a",function(){return e});class e{constructor(){this.ay={}}get(m,n=null){m=h[m];return"number"===typeof n?(n=this.ay[m])?Number.parseInvariant(n.toString()):0:this.ay[m]}add(m,n){this.ay[h[m]]=n}WC(m,n){h[m]in this.ay||(this.ay[h[m]]=n)}remove(m){delete this.ay[h[m]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.chronosslim.js.map