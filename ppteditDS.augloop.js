'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1198:function(J,V,d){d.r(V);var h=d(0),e=d(375),m=d(25),n=d(54),v=d(68),A=d(17),w=d(13);class y{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(h.a)(y,"AugmentationServiceRequest",null,[]);var u=d(33),E=d(66);class G{constructor(da,Ea,$a){this.mmb=this.bpa=null;this.iHh=$a;this.jb=Ea;this.Ei=da}initialize(){e.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");
const da=this.jb.Ha("AugmentationLoopWebServiceBase"),Ea=this.jb.Ha("WebServiceBase");this.bpa=(void 0===da?Ea:da)+"proofing.ashx?"+m.AFrameworkApplication.Zg+"&apitype=AL";this.mmb=new E.a;e.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(da,Ea){if(da&&""!==da)if(Ea){if(!({value:$a}=this.mmb.Of(da)).returnValue){var $a=new A.a;this.mmb.add(da,$a)}$a.contains(Ea)||$a.add(Ea)}else e.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else e.ULS.sendTraceTag(25747913,
306,15,"topic is empty or null")}removeEventHandler(da,Ea){da&&""!==da?Ea?this.mmb.Jb(da)?({value:da}=this.mmb.Of(da),da&&da.contains(Ea)&&da.remove(Ea)):e.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",da):e.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):e.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}dHe(da,Ea,$a){this.gic(da,Ea,$a,Object(w.a)(this,this.FHa,"requestSucceeded"),Object(w.a)(this,this.DHa,"requestFailed"))}gic(da,Ea,$a,fb,qc,
Hc=null){da=Object.assign(new y,{Topic:da,Payload:Ea,AppId:this.iHh,SessionId:this.Ei.userSessionId,ContextId:$a});this.Ei.vj(this.bpa,2,u.c(da),{"Content-Type":"application/json; charset=utf-8"},!1,3,fb,qc,Hc?Hc:da,void 0,void 0,void 0,void 0,"18")}FHa(da){!m.AFrameworkApplication.Xg&&da&&da.data&&this.Ahk(da.data.Zd)}DHa(da){!m.AFrameworkApplication.Xg&&da&&da.data&&e.ULS.sendTraceTag(25747918,306,15,"{0}",da.data.Zd)}Ahk(da){if(da){try{var Ea=u.a(da)}catch($a){e.ULS.sendTraceTag(36284437,306,10,
"Try parse aug response failed:{0}",$a.message);return}if(({value:da}=this.mmb.Of(Ea.Topic)).returnValue)for(let $a of da)$a(Ea.ContextId,Ea.Payload);else e.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",Ea.Topic)}}}Object(h.a)(G,"AugmentationManager",null,[984]);var I=d(1158);class H{}Object(h.a)(H,"HostMetadata",null,[]);class K{}Object(h.a)(K,"Lambda",null,[]);class C extends K{constructor(){super()}}Object(h.a)(C,"WrapperLambda",K,[]);var Y=d(384),M=d(141);class P{constructor(){this.handler=
this.schemaName=null}}Object(h.a)(P,"AddEventHandlerParameters",null,[]);var T=d(645);class L{constructor(){this.lambda=this.name=null}}Object(h.a)(L,"RegisterSimpleLocalWorkflowParameters",null,[]);class aa{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(h.a)(aa,"RegisterSimpleRemoteWorkflowParameters",null,[]);var Q=d(940);class ea{constructor(){this.requestAuthTokenCallback=null}}Object(h.a)(ea,"SetRequestAuthTokenCallbackParameters",null,[]);class ia{constructor(){this.sendOTelEvent=
null}}Object(h.a)(ia,"SetSendOTelEventCallbackParameters",null,[]);class ja{constructor(){this.ulsLogger=null}}Object(h.a)(ja,"SetULSLoggerParameters",null,[]);var D=d(894);class pa{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(h.a)(pa,"SubmitParameters",null,[]);var Z=d(521);class oa{constructor(da,Ea=null){this.bY=null;new E.a;new H;this.sUh=da;this.ELa=Ea}initialize(da){this.bY?e.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):(da||(da=new T.a),
this.bY=new Promise(Ea=>{e.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const $a=m.AFrameworkApplication.Fk("al",2);this.sUh.hwb($a).continueWith(()=>{e.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const fb=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();fb.setRequestAuthTokenCallback(Object.assign(new ea,{requestAuthTokenCallback:Object(w.a)(this,this.OSk,"requestAuthToken")}));fb.setULSLogger(Object.assign(new ja,{ulsLogger:new Y.a}));
fb.setSendOTelEventCallback(Object.assign(new ia,{sendOTelEvent:Object(w.a)(this,this.sendOTelEvent,"sendOTelEvent")}));let qc=m.AFrameworkApplication.fa.Ha("OfficeApplicationName")||"";qc=qc.replace("Web","");da.appName=da.appName||qc;da.serviceUrl=da.serviceUrl||m.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl");da.appVersion=da.appVersion||m.AFrameworkApplication.fa.Ha("BuildVersion")||"";da.releaseAudienceGroup=da.releaseAudienceGroup||(m.AFrameworkApplication.Yc?Object(I.a)(String,m.AFrameworkApplication.Yc.AudienceGroup)||
"":"");da.sessionId=da.sessionId||m.AFrameworkApplication.fa.Ha("SessionId")||"";da.uiLanguage=da.uiLanguage||m.AFrameworkApplication.uiCulture;da.flights=da.flights||this.IWi();da.initSession=da.initSession||!0;da.downloadBaseUrl=da.downloadBaseUrl||m.AFrameworkApplication.fa.Ha("AugLoopDownloadBaseUrl");fb.initialize(da);Ea({})})}))}registerSchemas(){e.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.bY}registerSimpleLocalWorkflow(da,Ea){return this.bY.then(()=>{e.ULS.sendTraceTag(51185353,
306,50,"Registering local workflow: {0} to AugLoop.",da);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new L,{name:da,lambda:this.qkd(Ea)}))})}registerSimpleRemoteWorkflow(da,Ea,$a,fb){return this.bY.then(()=>{e.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",da);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new aa,{name:da,lambdaBefore:this.qkd(Ea),lambdaRemote:this.qkd($a),
lambdaAfter:this.qkd(fb)}))})}registerReduceWorkflow(){e.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.bY}submit(da,Ea){this.bY.then(()=>{e.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",da);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new pa,{inputSchema:da,input:Ea}))})}flushTelemetry(){e.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(da){this.bY.then(()=>{e.ULS.sendTraceTag(51185358,306,
100,"Submitting Operation: {0} to AugLoop.",da);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new D.a,{operation:da}))})}setSessionDataCallback(da){this.bY.then(()=>{e.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(da)})}setInitSessionCallback(da){this.bY.then(()=>{e.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(da)})}setSessionInitOverrideCallback(da){this.bY.then(()=>
{e.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(da)})}setAnnotationResultCallback(da){this.bY.then(()=>{e.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new Q.a,{handler:da}))})}activateAnnotation(da){return this.bY.then(()=>{e.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",
da.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(da)})}releaseAnnotation(da){return this.bY.then(()=>{e.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",da.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(da)})}addEventHandler(da,Ea){da&&""!==da?Ea?this.bY.then(()=>{e.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new P,
{schemaName:da,handler:$a=>{$a&&Ea($a.inputSchema,$a.input,$a.outputSchema,$a.output)}}))}):e.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):e.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){e.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}OSk(){const da=m.AFrameworkApplication.fa.Ha("AugLoopOAuthResourceUriV2");if(this.ELa)return new Promise(Ea=>{this.ELa.execute($a=>{$a.q0("AugLoop",da).then(fb=>{fb.IsSuccess?Ea(fb.Token):(e.ULS.sendTraceTag(51499467,
306,15,fb.ErrorMessage),Ea(m.AFrameworkApplication.fa.Ha("AugloopACLPUserDataSignature")||""));return{}})})});e.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")}sendOTelEvent(da){M.a.sendOtelEvent(Object.assign(new Z.a,{otelEvent:da}))}qkd(da){if(da){let Ea=null;da.func&&(Ea=($a,fb,qc,Hc)=>{da.func($a,fb,Hc)});return Object.assign(new C,{name:da.name,inputSchema:da.inputSchema,outputSchema:da.outputSchema,func:Ea})}return null}IWi(){var da=m.AFrameworkApplication.fa.Ha("FlightId");
const Ea=m.AFrameworkApplication.fa.HB("AugLoopFlightKeywordList"),$a=[];if(da&&""!==da&&Ea&&0<Ea.length){da=da.split(";");for(let fb=0;fb<da.length;fb++)for(let qc=0;qc<Ea.length;qc++)-1<da[fb].toLowerCase().indexOf(Ea[qc].toLowerCase())&&Array.add($a,da[fb])}return 0<$a.length?$a.join(";"):""}}Object(h.a)(oa,"NewAugLoopRuntimeManager",null,[983]);var Ba=d(55),Ma=d(1189),za=d(45);class ka{}Object(h.a)(ka,"Lambda",null,[994]);var qa=d(892);class Ja{constructor(){this.documentOpenType=this.getItemsEndPoint=
this.downloadUrl=null}}Object(h.a)(Ja,"PowerPointParameters",null,[]);class xa{constructor(){this.initSessionCallback=null}}Object(h.a)(xa,"SetInitSessionCallbackParameters",null,[]);class Ga{constructor(){this.sessionDataCallback=this.handler=null}}Object(h.a)(Ga,"SetSessionDataCallbackParameters",null,[]);class na{constructor(){this.handler=null}}Object(h.a)(na,"SetSessionInitOverrideCallbackParameters",null,[]);var sa=d(454),Ha=d(510),cb=d(127);class Za extends Ha.a{constructor(){super();this.H_=
Object.assign(new cb.a,{T_:Za.getTypeName(),B_:Za.kl()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static kl(){return["AugLoop_Core_Operation"]}}Object(h.a)(Za,"DeleteOperation",Ha.a,[]);var va=d(673),Fa=d(254);class Ca extends Fa.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new cb.a,{T_:Ca.getTypeName(),B_:Ca.kl()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static kl(){return[]}}Object(h.a)(Ca,"Message",Fa.a,[]);class La extends Ca{constructor(){super();
this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new cb.a,{T_:La.getTypeName(),B_:La.kl()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static kl(){return["AugLoop_Session_Protocol_Message"]}}Object(h.a)(La,"SessionInitMessage",Ca,[]);class nb extends La{constructor(){super();
this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new cb.a,{T_:nb.getTypeName(),B_:nb.kl()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static kl(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(h.a)(nb,"PowerPointSessionInitMessage",La,[]);var Nb=d(40);class Rb{constructor(){this.authToken=this.origin=this.Qjh=null}}Object(h.a)(Rb,"SessionData",null,[]);var Ya=
d(526);class Qb{constructor(da,Ea,$a){this.jde=new E.a;this.oWc=new E.a;this.Lce=new E.a;this.bAb=this.C2c=this.oxb=this.jQ=null;this.zG=da;this.Ga=Ea;this.ni=$a;const fb=new T.a;fb.powerpoint=new Ja;if(Nb.a("AL.SendSlideTile"))if(Nb.a("AL.EnableRehydration"))this.zG.initialize(new T.a),this.zG.setInitSessionCallback(Object.assign(new xa,{initSessionCallback:Object(w.a)(this,this.Ynk,"onSessionInit")})),this.zG.setSessionInitOverrideCallback(Object.assign(new na,{handler:Object(w.a)(this,this.Znk,
"onSessionInitOverride")})),this.bAb=this.gQc(),this.zG.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.m8=Promise.resolve(null);else{da=Ba.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;Ea=Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;da=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",Ea,da);Ea=Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").s6a?
Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").aMc:Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var qc=String.format("{0}getitems.ashx",Ea);Ea=new Ma.a(m.AFrameworkApplication.He);this.m8=Ya.b(Ea.pHe(da));this.m8.then(Hc=>{try{const kd=JSON.parse(Hc),Ac=kd.downloadUrl;za.a.Va(Ac)?e.ULS.sendTraceTag(51422528,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",kd):(fb.powerpoint.downloadUrl=Ac,fb.powerpoint.getItemsEndPoint=
qc,this.Ga.mYb&&(fb.powerpoint.documentOpenType=this.jbg()))}catch(kd){e.ULS.sendTraceTag(51422529,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",kd)}this.zG.initialize(fb);this.bAb=this.gQc();this.zG.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(Hc=>{e.ULS.sendTraceTag(51422530,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Hc);this.zG.initialize(fb);this.bAb=this.gQc();
this.zG.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.m8=new Promise(Hc=>{this.zG.initialize(fb);this.bAb=this.gQc();this.zG.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult"));Hc("")})}xmb(da){this.m8.then(Ea=>{this.zG.activateAnnotation(Object.assign(new qa.a,{annotationType:da}));return Ea})}whc(da,Ea){if(da)if(Ea){if(!({value:$a}=this.jde.Of(da)).returnValue){var $a=new A.a;this.jde.add(da,$a)}$a.contains(Ea)||
$a.add(Ea)}else e.ULS.sendTraceTag(51388803,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(51388802,306,15,"Annotation Type is null or empty")}gKk(da,Ea){if(da)if(Ea){if(!({value:$a}=this.oWc.Of(da)).returnValue){var $a=new A.a;this.oWc.add(da,$a)}$a.contains(Ea)||$a.add(Ea)}else e.ULS.sendTraceTag(575931363,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(575931362,306,15,"Annotation Type is null or empty")}addEventHandler(da,Ea){this.m8.then(()=>{this.zG.addEventHandler(da,
Ea);return null})}removeEventHandler(da,Ea){this.m8.then(()=>{this.zG.removeEventHandler(da,Ea);return null})}registerSimpleLocalWorkflow(da,Ea){return this.m8.then(()=>this.zG.registerSimpleLocalWorkflow(da,this.rkd(Ea)))}registerSimpleRemoteWorkflow(da,Ea,$a,fb){return this.m8.then(()=>this.zG.registerSimpleRemoteWorkflow(da,this.rkd(Ea),this.rkd($a),this.rkd(fb)))}submit(da,Ea){this.m8.then(()=>{this.zG.submit(da,Ea);return null})}submitOperation(da){this.m8.then(()=>{this.zG.submitOperation(da);
return null})}pxl(da,Ea,$a,fb,qc){this.bAb&&this.bAb.then(()=>{this.ni.augmentImage(da,Ea,$a,!0,this.C2c.Qjh,this.C2c.origin,this.C2c.authToken,fb,qc);return null})}Znk(da){e.ULS.sendTraceTag(594609494,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const Ea=Object.assign(new nb,{protocolVersion:da.protocolVersion,clientMetadata:da.clientMetadata,sessionKey:da.sessionKey,origin:da.origin,authToken:da.authToken,messageId:da.messageId,cv:da.cv});try{this.Ga.mYb&&(Ea.documentOpenType=this.jbg())}catch($a){e.ULS.sendTraceTag(578155528,
306,10,"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",$a)}this.V1k(da);if(za.a.Va(this.jQ)||za.a.Va(this.oxb))return e.ULS.sendTraceTag(594609493,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),da;Ea.downloadUrl=this.jQ;Ea.getItemsEndPoint=this.oxb;this.oxb=this.jQ=null;return Ea}Ynk(){e.ULS.sendTraceTag(594609492,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");var da=Ba.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;
const Ea=Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var $a=Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").s6a?Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").aMc:Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;da=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",Ea,da);const fb=String.format("{0}getitems.ashx",$a);$a=new Ma.a(m.AFrameworkApplication.He);return Ya.b($a.pHe(da)).then(qc=>
{try{const Hc=JSON.parse(qc),kd=Hc.downloadUrl;za.a.Va(kd)?e.ULS.sendTraceTag(594609491,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",Hc):(this.jQ=kd,this.oxb=fb)}catch(Hc){e.ULS.sendTraceTag(594609490,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Hc)}return null}).catch(qc=>{e.ULS.sendTraceTag(594609489,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",qc)})}gQc(){return new Promise(da=>{this.zG.setSessionDataCallback(Object.assign(new Ga,
{sessionDataCallback:(Ea,$a,fb)=>{this.C2c=Object.assign(new Rb,{Qjh:Ea,origin:$a,authToken:fb});da(null)}}))})}onAnnotationResult(da){if(da&&da.items)if(Fa.a.INc(da)!==sa.a.getTypeName()&&Fa.a.INc(da)!==va.a.getTypeName())this.Ga.cZf&&Fa.a.INc(da)===Za.getTypeName()&&this.Sik(da);else for(const $a of da.items){if(!$a||!$a.body)continue;const fb=Fa.a.INc($a.body);if(!fb)continue;var Ea=$a.body||{};da.parentPath&&(Ea.parentPath=da.parentPath);let qc=null;if(!({value:qc}=this.jde.Of(fb)).returnValue)e.ULS.sendTraceTag(51388804,
306,50,"Cannot find handlers for annotation:{0};",fb);else if(qc)for(let Hc of qc)Hc(Ea);if(this.Ga.cZf){Ea=null;if(({value:Ea}=this.oWc.Of(fb)).returnValue)for(let Hc of Ea)Hc($a,!1);za.a.Va($a.id)||this.Lce.$($a.id,fb)}}}Sik(da){for(const Ea of da.items){if(!Ea||!Ea.id)continue;if(!({value:da}=this.Lce.Of(Ea.id)).returnValue)continue;let $a=null;if(({value:$a}=this.oWc.Of(da)).returnValue)for(let fb of $a)fb(Ea,!0);this.Lce.remove(Ea.id)}}rkd(da){return da?Object.assign(new ka,{name:da.name,inputSchema:da.inputSchema,
outputSchema:da.outputSchema,func:da.func}):null}jbg(){try{return this.Ga.xS?0:this.Ga.sSa?2:1}catch(da){return e.ULS.sendTraceTag(578697036,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",da),2}}V1k(da){try{za.a.Va(da.clientMetadata.flights)?da.clientMetadata.flights=";":da.clientMetadata.flights+=";",this.Ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?da.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":
da.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;"}catch(Ea){e.ULS.sendTraceTag(559445142,306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",Ea)}}}Object(h.a)(Qb,"PPTAugLoopRuntimeManager",null,[979]);class bb{constructor(da){this.LS=da;this.LS.initialize()}addEventHandler(da,Ea){this.LS.addEventHandler(da,Ea)}removeEventHandler(da,Ea){this.LS.removeEventHandler(da,Ea)}dHe(da,Ea,$a){this.LS.dHe(da,Ea,$a)}gic(da,Ea,$a,fb,qc,Hc=
null){this.LS.gic(da,Ea,$a,fb,qc,Hc)}}Object(h.a)(bb,"PPTAugmentationManager",null,[972]);class Bb{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}Wb(da){this.K=da;this.K.register(bb,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").ma().na(()=>new bb(new G(m.AFrameworkApplication.He,da.resolve("Common.IAppSettingsManager"),"PowerPoint_Online")));this.K.register(Qb,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").ma().na(()=>
{const Ea=n.a.eQj();e.ULS.sendTraceTag(40235107,306,50,"IsWebSocketSupported: {0}",Ea);m.AFrameworkApplication.fa.appSettings.AugLoopUseWebSocket=Ea.toString();return new Qb(new oa(da.resolve("Common.ISharedDependencyLoader"),da.La("Common.App.OAuth.IOAuthManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"))})}init(){this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled&&
this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")}dispose(){}static main(){v.a.instance.Ac(new Bb)}}Object(h.a)(Bb,"PPTWebEditorAugmentationLoopPackage",null,[2,3]);var Eb=d(1157),tb=d(893),Yb=d(891),Tc=d(539),ib=d(61),Zb=d(31),Cc=d(26);class ob{constructor(da){if(!da)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");this.y_=da}p1b(da){this.yQe(da)}yQe(da){if(da){try{const qc=da.parentPath;if(!qc||
4>qc.length){Cc.a.J(590181647,820,50,"ParentPath is Null or Empty.");return}const Hc=qc[3];var Ea=qc[2];if(!Hc){Cc.a.J(590181645,820,50,"Unable to retreive original paragraph text");return}var $a=this.y_.T4i(Hc);this.y_.MNk(Hc);const kd=da.predictions;if(!kd||!kd.length){Cc.a.J(590181643,820,50,"Augloop Annotations Null or Empty.");return}const Ac=kd[0];if(!Ac)return;var fb=Ac.text;if(!fb||!fb.length){Cc.a.J(590181641,820,50,"Text Predictions Null or Empty.");return}}catch(qc){Cc.a.J(590710030,820,
10,"Unable to parse output because of modified output type from Augloop");return}fb&&ob.SGi(fb,$a,Ea)}else Cc.a.J(590181649,820,50,"Annotations returned from service is null.")}static SGi(da,Ea,$a){da&&da.length&&(Ea=ob.U9i(da,Ea),-1!==Ea&&(Ea=da.substring(Ea,da.length),$a=Object.assign(new Yb.a,{text:da,p7:Ea,Zw:$a}),Tc.a.aD.t4=$a,Tc.a.NHd(da,Ea)))}static U9i(da,Ea){var $a=ib.a.instance.Oa.kb.Te.node;if(!$a||!Ea)return-1;$a=Zb.ParagraphReader.text($a);if(!$a)return-1;if($a!==Ea)if($a.length>Ea.length&&
$a.substring(0,Ea.length)===Ea){if(!da.startsWith($a.substring(Ea.length,$a.length-Ea.length)))return-1;Cc.a.J(590181638,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===$a.substring($a.length-1,1)?0:ob.R$f($a)}static R$f(da){return da?da.length-1-da.lastIndexOf(" "):-1}}Object(h.a)(ob,"TextPredictionAugLoopResponseManager",null,[]);var cc=d(113),sb=d(425);class mb extends Ha.a{constructor(){super();this.H_=Object.assign(new cb.a,{T_:mb.getTypeName(),B_:mb.kl()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static kl(){return["AugLoop_Core_Operation"]}}
Object(h.a)(mb,"SignalOperation",Ha.a,[]);var Pb=d(1008);class dc{constructor(){this.hze=!1}}Object(h.a)(dc,"PredictionSettings",null,[]);class mc{constructor(da,Ea){this.H2c=null;this.oje={};this.zG=da;this.Nb=Ea;this.Nb.Hzc(Object(w.a)(this,this.Rhg,"handleResize"))}T4i(da){return this.oje[da]}I2k(da,Ea){this.oje[da]=Ea}MNk(da){da&&delete this.oje[da]}get settings(){this.H2c||(this.H2c=Object.assign(new dc,{hze:!1}));return this.H2c}set settings(da){this.H2c=da}Hpl(da){if(this.settings.hze&&da){var Ea=
da.id.toString(),$a=Tc.a.aD.t4,fb=ib.a.instance.Oa.kb;if(fb&&1===fb.length&&fb.Te){fb=fb.Te;var qc=fb.node;if(Zb.ParagraphReader.textLength(qc)===fb.Qa){if($a&&qc&&Ea===$a.Zw&&Ea===qc.id.toString()&&(fb=this.ZYd($a,qc))){$a.p7=fb;Tc.a.NHd($a.text,fb);return}Tc.a.aD.t4=null;$a=cc.a.create().toString();fb=Zb.ParagraphReader.text(da);this.I2k($a,fb);da=["Signal",Pb.a.getTypeName(),Ea,$a];$a=mc.O7i(fb);Ea=[Object.assign(new sb.a,{id:Ea,body:$a})];var Hc=Object.assign(new mb,{parentPath:da,items:Ea});
this.zG.execute(kd=>{kd.submitOperation(Hc);Cc.a.J(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}xEb(){Tc.a.aD.t4=null;Tc.a.cRa()}Noj(da){!da||1<da.length?this.xEb():1>da.length||((da=da[0])&&da.context?(da=da.context,da.Qa===da.Kb&&Zb.ParagraphReader.textLength(da.node)===da.Qa||this.xEb()):this.xEb())}ZYd(da,Ea){var $a=null;if(da&&Ea){Ea=Zb.ParagraphReader.text(Ea);da=da.text;if(!Ea||!da)return $a;Ea=Ea.replace(RegExp("\\u00a0","g")," ");da=da.replace(RegExp("\\u00a0","g"),
" ");if(Ea){if(Ea.endsWith(da))return this.xEb(),$a;$a=mc.P8i(Ea,da);$a=da.substring($a,da.length)}}return $a}Rhg(){Tc.a.cRa()}dispose(){this.Nb.Acd(Object(w.a)(this,this.Rhg,"handleResize"))}static O7i(da){return Object.assign(new Pb.a,{languageId:"en-US",startOfSentence:!0,text:da})}static P8i(da,Ea){for(let $a=Ea.length;0<$a;$a--){const fb=Ea.substring(0,$a);if(da.endsWith(fb.trimStart()))return fb.length}return 0}}mc.XRa=!1;Object(h.a)(mc,"TextPredictionHandler",null,[1047]);var Mb=d(52),Kc=d(28);
class gc{constructor(da,Ea){this.ia=da;this.yc=Ea}ub(){this.ia.xa(Kc.a.Uyk,Mb.a.application,Object(w.a)(this,this.Xyk,"predictionHandler"))}Xyk(da,Ea,$a){return m.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?1===$a?this.yc.Nj()?32:2:8:8}}Object(h.a)(gc,"TextPredictorActor",null,[]);class rb{constructor(){this.jqe=this.K=null}get name(){return"PowerPointWebEditor.TextPrediction"}Wb(da){this.K=da;da.register(gc,"PowerPointWebEditor.TextPrediction.TextPredictorActor").ma().na(()=>new gc(da.resolve("Common.IActionManagerExtended"),
da.resolve("PowerPointWebEditor.IPresentationReader")));da.register(1047,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").ma().na(()=>new mc(da.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),da.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.K.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").ub();this.jqe=new Eb.a(()=>new ob(this.K.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(da=>
{da.xmb(tb.a.getTypeName());da.whc(tb.a.getTypeName(),Object(w.a)(this.jqe.value,this.jqe.value.p1b,"handleResponse"))})}dispose(){}static main(){v.a.instance.Ac(new rb)}}Object(h.a)(rb,"TextPredictionPackage",null,[2,3]);var Ua=d(267),pb=d(27);class Ub{}Object(h.a)(Ub,"AugContextId",null,[]);class Bc{}Object(h.a)(Bc,"AugParagraph",null,[]);class Gc{}Object(h.a)(Gc,"AugShape",null,[]);class qd{}Object(h.a)(qd,"ShapeTextTile",null,[]);class Td{constructor(da,Ea,$a,fb){this.Ea=$a;this.Vh=fb;this.Mb=
da;this.zm=Ea}EWb(da,Ea){return da&&da.isConnected&&this.Ea.uDa(da)?(da=Object(I.a)(4,da))?Object.assign(new qd,{Topic:"ShapeText",ContextId:u.c(Td.rsi(da,Ea)),Data:u.c(this.ssi(da))}):null:null}eWb(da){return da&&da.get_shapeId()&&da.hasText&&!da.Kp?da.U7d:!1}ssi(da){const Ea=[];da=this.Mb.Kc(da);for(da=this.zm.J6(da,da.currentNode);da.moveNext();){var $a=da.currentNode;const fb=$a;this.Vh.Wd(fb)&&($a=Object.assign(new Bc,{t:this.Vh.text(fb),l:this.Vh.fdb($a)}),Array.add(Ea,$a))}return Object.assign(new Gc,
{p:Ea,c:Ua.a.le(m.AFrameworkApplication.lcid).krb})}static rsi(da,Ea){return Object.assign(new Ub,{gid:da.id,sid:da.slideSid,cid:da.slideCid,shapeId:da.get_shapeId(),rid:(da.QUc||da.BDa||pb.App.Im).toString(),t:Ea,c:(new Date).getTime()})}}Object(h.a)(Td,"ShapeTextTileManager",null,[1043,1065]);var Vd=d(101),Be=d(1179),Id=d(196),gb=d(78),Xb;(function(da){da[da.none=0]="none";da[da.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";da[da.onSelectionFinished=2]="onSelectionFinished";da[da.onActiveSlideDomReady=
4]="onActiveSlideDomReady";da[da.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";da[da.onParagraphDisconnect=16]="onParagraphDisconnect";da[da.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";da[da.onNumberListDisconnect=64]="onNumberListDisconnect";da[da.onSlideConnected=128]="onSlideConnected";da[da.onSlideDisconnected=256]="onSlideDisconnected"})(Xb||(Xb={}));Object(h.b)("EventNames",Xb);class Ic{constructor(){this.$Ya=this.graphNode=null;this.wSa=0;this.IPe=null}}Object(h.a)(Ic,
"TileGraphNode",null,[]);class Wc{constructor(){this.fih=this.pGe=this.o2d=this.ogg=0}}Object(h.a)(Wc,"TileTelemetry",null,[]);var Ib;(function(da){da[da.unknown=0]="unknown";da[da.activeSlideChanged=1]="activeSlideChanged";da[da.shapeSelected=2]="shapeSelected";da[da.listLevelChanged=3]="listLevelChanged";da[da.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";da[da.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";da[da.paragraphDeleted=6]="paragraphDeleted";da[da.numberListDeleted=
7]="numberListDeleted";da[da.numberListPropertyChanged=8]="numberListPropertyChanged";da[da.slideAdded=9]="slideAdded";da[da.slideDeleted=10]="slideDeleted"})(Ib||(Ib={}));Object(h.b)("TriggerName",Ib);var ec=d(419);class Jb{constructor(da,Ea,$a,fb){this.yb=Ea;this.I0j=$a;this.E9j=da;this.mqe={};this.r7b={};this.Nb=fb}initialize(){this.dw()}dispose(){this.ena()}onParagraphPropertyChanged(da,Ea){this.Rqa(Ea,1)}oCb(da,Ea){this.Rqa(Ea,2)}onActiveSlideDomReady(da,Ea){this.Rqa(Ea,4)}onShapeChildTopologyChanged(da,
Ea){this.Rqa(Ea,8)}AGa(da,Ea){this.Rqa(Ea,16)}Y0g(da,Ea){da=new ec.a(!1,null,Ea.Ba);this.Rqa(da,4)}get Yx(){return this.E9j}get $Y(){return this.mqe}get Bha(){return this.r7b}Rqa(da,Ea){try{if(2===this.Nb.mode&&Object(Be.a)(Xb,Ea)in this.mqe){var $a=Date.now();Object(I.a)(1093,this.mqe[Object(Be.a)(Xb,Ea)]).n2(da,(fb,qc)=>{this.Vik(fb,qc,$a)})}}catch(fb){Cc.a.J(36495880,306,10,"Exception thrown at DetectTiles: "+fb)}}Vik(da,Ea,$a){if(!Id.a.Va(da))try{for(const fb of da){if(!Vd.a.count(this.r7b)){const kd=
new gb.a(3,1,this.I0j,Object(w.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.yb.Gb(kd)}let qc;if(fb.id.toString()in this.r7b)qc=Object(I.a)(Ic,this.r7b[fb.id.toString()]),qc.wSa=Ea;else{const kd=new Wc;qc=Object.assign(new Ic,{graphNode:fb,wSa:Ea,$Ya:{},IPe:kd});this.r7b[fb.id.toString()]=qc;this.Ygk(kd,$a)}const Hc=Ib[Ea];qc.$Ya[Hc]=(Hc in qc.$Ya?qc.$Ya[Hc]:0)+1}}catch(fb){Cc.a.J(36495882,306,10,"Exception thrown at FireTiles: "+fb)}}Ygk(da,Ea){da&&(da.ogg=Ea,da.o2d=Date.now())}qWg(da,
Ea){da&&(da.pGe=Ea,da.fih=Date.now())}K5f(da){return da?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",da.o2d-da.ogg,da.pGe-da.o2d,da.fih-da.pGe):""}}Object(h.a)(Jb,"TileTriggerControllerBase",null,[1170,106]);class hb extends Jb{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac,Lc,yc,Oc,od,di){super(kd&31,Ac,yc,od);this.eT=da.Bd(12);this.kL=da.Bd(10);this.ra=Ea;this.od=$a;this.LS=fb;this.P8=qc;this.mT=Hc;this.ta=Lc;this.sT=Oc;this.c$j=di}dw(){1===(this.Yx&1)&&(this.eT.xk(Object(w.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.$Y[Object(Be.a)(Xb,1)]=this.sT.lAi());2===(this.Yx&2)&&(this.ra.XJ(Object(w.a)(this,this.oCb,"onProcessSetSelectionFinished")),this.$Y[Object(Be.a)(Xb,2)]=this.sT.mAi());4===(this.Yx&4)&&(this.od.GY(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.$Y[Object(Be.a)(Xb,4)]=this.sT.jAi());8===(this.Yx&8)&&(this.kL.$F(Object(w.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.$Y[Object(Be.a)(Xb,
8)]=this.sT.nAi());16===(this.Yx&16)&&(this.eT.Bza(Object(w.a)(this,this.AGa,"onBeforeParagraphDisconnect")),this.$Y[Object(Be.a)(Xb,16)]=this.sT.kAi())}ena(){this.eT.Tm(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.ra.zHa(Object(w.a)(this,this.oCb,"onProcessSetSelectionFinished"));this.od.Nva(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.kL.iO(Object(w.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.eT.xHa(Object(w.a)(this,
this.AGa,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.ta&&this.ta.Ba){var da=this.ta.Ba.om();for(const Ea of da){const $a=Ea.id.toString();$a in this.Bha&&(this.jZb(Object(I.a)(Ic,this.Bha[$a])),delete this.Bha[$a])}Vd.a.forEach(this.Bha,Ea=>{delete this.Bha[Ea]},null)}}catch(Ea){Cc.a.J(36525510,306,10,"Exception thrown at FireTileEvents: "+Ea)}}jZb(da){if(da){var Ea=Date.now(),$a=this.mT.EWb(da.graphNode,Ib[da.wSa]);if($a){this.c$j?this.P8.execute(qc=>{qc.submit("ShapeTextTile",$a)}):
this.LS.execute(qc=>{qc.dHe($a.Topic,$a.Data,$a.ContextId)});const fb=da.IPe;this.qWg(fb,Ea);Cc.a.J(26007383,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",Ib[da.wSa],da.$Ya,this.K5f(fb))}}}}Object(h.a)(hb,"ShapeTextTileTriggerController",Jb,[]);var Rc=d(22),gd=d(75),hd=d(36),Hd=d(92),Xd=d(81),id=d(165),fd=d(37);class Vf{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(h.a)(Vf,"TextSpan",null,[]);class Qd{}Object(h.a)(Qd,"AugCharFormat",null,[]);class Zf{}Object(h.a)(Zf,
"AugCharFormatRun",null,[]);class Ge{}Object(h.a)(Ge,"AugDrawingElement",null,[]);class le{}Object(h.a)(le,"AugDrawingElementMoniker",null,[]);class Sa{}Object(h.a)(Sa,"AugPara",null,[]);class Cb{}Object(h.a)(Cb,"AugParaFormat",null,[]);class rc{}Object(h.a)(rc,"AugParaFormatRun",null,[]);class bd{}Object(h.a)(bd,"AugSlide",null,[]);class pd{}Object(h.a)(pd,"AugSlideMoniker",null,[]);class Oa{}Object(h.a)(Oa,"AugText",null,[]);class jb{}Object(h.a)(jb,"AugTextTile",null,[]);class nc{constructor(da,
Ea,$a,fb,qc,Hc,kd,Ac,Lc,yc,Oc,od){this.Vh=da;this.Gl=Ea;this.Yne=$a;this.Mb=fb;this.RW=qc;this.sc=Hc;this.zm=kd;this.z$b=Oc;this.b0c=Ac;this.A$b=Lc;this.Jz=yc;this.i6j=od}EWb(da){if(!da||!da.isConnected)return null;var Ea=Object(I.a)(123,da);if(!Ea)return null;let $a=da=0;Ea=({Z8c:da,vGc:$a}=this.FAi(Ea)).returnValue;if(!Ea)return null;Ea=Object.assign(new jb,{Id:cc.a.create().toString(),Content:u.c(Ea)});Cc.a.J(37091038,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",Ea.Id,da,$a);return Ea}FAi(da){let Ea=
0,$a=0;const fb=[];var qc=da?da.om():[];for(Hc of qc)if(!this.Gl.gDa(Hc)||this.z$b)if(Hc.nd){if(qc=this.sc.XM(Hc))qc=this.Mb.Kc(qc),this.RW.FJc(qc,kd=>{(kd=Object(I.a)(125,kd.currentNode))&&!kd.isGhostCell&&({Z8c:Ea,vGc:$a}=this.C5f(kd,Ea,$a,fb));return!0})}else({Z8c:Ea,vGc:$a}=this.C5f(Hc,Ea,$a,fb));var Hc=Ea;qc=$a;return{returnValue:Object.assign(new bd,{id:da.id.toString(),mk:Object.assign(new pd,{sId:da.sid,cId:da.cid}),drawingElems:fb,isSlideCritiqueReady:da.isSlideCritiqueReady}),Z8c:Hc,vGc:qc}}C5f(da,
Ea,$a,fb){const qc=[];let Hc=0;var kd=this.Mb.Kc(da);for(kd=this.zm.J6(kd,kd.currentNode);kd.moveNext();){var Ac=kd.currentNode;Ac&&this.Vh.Wd(Ac)&&Ac.Sa(hd.a.Zp)&&(Ac=this.HVi(Ac))&&(Ac.pfRuns&&0<Ac.pfRuns.length&&Ac.pfRuns[0].pf.proofingDirty&&Hc++,Array.add(qc,Ac))}0<qc.length&&(Ea+=qc.length,$a+=Hc,da=Object.assign(new Ge,{id:da.id.toString(),mk:this.FVi(da),text:Object.assign(new Oa,{paragraphs:qc})}),Array.add(fb,da));return{Z8c:Ea,vGc:$a}}FVi(da){if(!da)return null;var Ea="";let $a=0,fb=0;
if(Object(Rc.a)(125,da))Ea=Object(I.a)(125,da),fb=3,Ea=Ea.cellId.toString();else if(Object(Rc.a)(4,da))if(da=Object(I.a)(4,da),Ea=da.get_shapeId().toString(),$a=da.get_cid(),da.T2)fb=1;else if(da.Qf)fb=2;else if(da.wy||da.al)fb=4;return Object.assign(new le,{id:Ea,cId:$a,type:fb})}HVi(da){if(!da)return null;da=Object(I.a)(gd.AParagraphNode,da);if(!da)return null;var Ea=da.sa(fd.a.BS,!1);Ea=Object.assign(new Sa,{id:da.id.toString(),chars:Ea?"":this.Vh.text(da)});const $a=this.GVi(da);$a&&0<$a.length&&
(Ea.pfRuns=$a);(da=this.EVi(da))&&0<da.length&&(Ea.cfRuns=da);return Ea}GVi(da){const Ea=[],$a=Object(I.a)(Xd.a,this.A$b.gMc(da));let fb=16,qc="",Hc=0,kd=0;if($a&&this.i6j){const Ac=this.Jz.u6a($a);if(Ac)if(fb=Ac.listType,1===fb)qc=this.b0c.dwb($a);else if(0===fb){Hc=$a.sa(fd.a.autonumberBulletType,8);const Lc=Object(I.a)(1067,this.b0c);Lc&&(kd=Lc.Y5i(Ac,$a))}}da=Object.assign(new rc,{pf:Object.assign(new Cb,{lvl:this.Vh.fdb(da),proofingDirty:!da.sa(id.a.eca,!1),revisionId:da.sa(id.a.WUc,0).toString(),
listType:fb,listTag:qc,listNumeration:Hc,listElementIndex:kd})});Array.add(Ea,da);return Ea}EVi(da){const Ea=[];let $a=this.B5i(da);if(0<$a.count){$a=this.zci(this.Yne.mLc(da),$a);for(let fb of $a)da=fb.end-fb.start,Array.add(Ea,Object.assign(new Zf,{len:da,cf:Object.assign(new Qd,{lang:fb.lcid,noProof:fb.noProof})}))}return Ea}B5i(da){const Ea=new A.a,$a=da.characterData;let fb=-1,qc=-1,Hc=0;for(let kd=0;kd<da.Ra.length;kd++){const Ac=da.Ra.ga(kd).formatting;Ac&&(qc=Hd.a.language(Ac),-1!==fb&&fb!==
qc&&(Ea.add(Object.assign(new Vf,{start:Hc,end:da.Ra.ga(kd).cp,lcid:fb,noProof:!1})),Hc=da.Ra.ga(kd).cp),fb=qc)}Ea.add(Object.assign(new Vf,{start:Hc,end:$a.length,lcid:qc,noProof:!1}));return Ea}zci(da,Ea){if(!da)return Ea;for(const $a of da){da=!1;for(let fb=0;fb<Ea.count;fb++){if(!da)if(Ea.ga(fb).start===$a.begin)da=!0,Ea.ga(fb).noProof=!0;else if($a.begin>Ea.ga(fb).start&&$a.begin<Ea.ga(fb).end){Ea.insert(fb+1,Object.assign(new Vf,{start:$a.begin,end:Ea.ga(fb).end,lcid:Ea.ga(fb).lcid,noProof:!0}));
da=!0;Ea.ga(fb).end=$a.begin;continue}if(da)if($a.end>Ea.ga(fb).end)Ea.ga(fb).noProof=!0;else{if($a.end===Ea.ga(fb).end){Ea.ga(fb).noProof=!0;break}if($a.end<Ea.ga(fb).end){Ea.insert(fb+1,Object.assign(new Vf,{start:$a.end,end:Ea.ga(fb).end,lcid:Ea.ga(fb).lcid,noProof:!1}));Ea.ga(fb).end=$a.end;Ea.ga(fb).noProof=!0;break}}}}return Ea}}Object(h.a)(nc,"SlideTextTileManager",null,[1044,1065]);var kb=d(428);class Gb extends Jb{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac,Lc,yc,Oc){super(Ea&125,$a,fb,Oc);this.od=
da;this.sT=qc;this.w8j=Hc;this.eT=kd.Bd(12);this.kL=kd.Bd(10);this.P8=Ac;this.ta=Lc;this.rQg=yc;this.I0c=kd.Bd(22)}dw(){4===(this.Yx&4)&&(this.od.GY(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.rQg.U5h(Object(w.a)(this,this.Y0g,"onTilingModuleLoaded")),this.$Y[Object(Be.a)(Xb,4)]=this.sT.zAi());16===(this.Yx&16)&&(this.eT.Bza(Object(w.a)(this,this.AGa,"onBeforeParagraphDisconnect")),this.$Y[Object(Be.a)(Xb,16)]=this.sT.CAi());1===(this.Yx&1)&&(this.eT.xk(Object(w.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.$Y[Object(Be.a)(Xb,1)]=this.sT.DAi());8===(this.Yx&8)&&(this.kL.$F(Object(w.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.$Y[Object(Be.a)(Xb,8)]=this.sT.EAi());64===(this.Yx&64)&&(this.I0c.Bza(Object(w.a)(this,this.NWg,"onBeforeNumberListDicsonnect")),this.$Y[Object(Be.a)(Xb,64)]=this.sT.AAi());32===(this.Yx&32)&&(this.I0c.xk(Object(w.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),
this.$Y[Object(Be.a)(Xb,32)]=this.sT.BAi())}ena(){this.od.Nva(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.eT.Tm(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.eT.xHa(Object(w.a)(this,this.AGa,"onBeforeParagraphDisconnect"));this.rQg.TQk(Object(w.a)(this,this.Y0g,"onTilingModuleLoaded"));this.I0c.xHa(Object(w.a)(this,this.NWg,"onBeforeNumberListDicsonnect"));this.I0c.Tm(Object(w.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}NWg(da,
Ea){this.Rqa(Ea,64)}onNumberListPropertyChanged(da,Ea){this.Rqa(Ea,32)}fireTileEvents(){try{Vd.a.forEach(this.Bha,da=>{this.jZb(Object(I.a)(Ic,this.Bha[da]));delete this.Bha[da]},null)}catch(da){Cc.a.J(36525513,306,10,"Exception thrown at FireTileEvents: "+da)}}jZb(da){if(da&&this.ta.Ba&&da.graphNode&&this.ta.Ba.id===da.graphNode.id){var Ea=Date.now(),$a=this.w8j.EWb(da.graphNode,Ib[da.wSa]);if($a){this.P8.execute(qc=>{qc.submit(kb.a.Nkc,$a)});const fb=da.IPe;this.qWg(fb,Ea);Cc.a.J(36525515,306,50,
"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",Ib[da.wSa],da.$Ya,u.c($a).length,$a.Id,this.K5f(fb))}}}}Object(h.a)(Gb,"SlideTextTileTriggerController",Jb,[]);class tc extends Fa.a{constructor(){super();this.shapeType=this.textTiles=null;this.H_=Object.assign(new cb.a,{T_:tc.getTypeName(),B_:tc.kl()})}static getTypeName(){return"AugLoop_Powerpoint_PowerPointShape"}static kl(){return[]}}Object(h.a)(tc,"PowerPointShape",Fa.a,[]);class dd extends Fa.a{constructor(){super();
this.cid=this.sid=this.themeId=this.isSlideHidden=this.shapes=null;this.H_=Object.assign(new cb.a,{T_:dd.getTypeName(),B_:dd.kl()})}static getTypeName(){return"AugLoop_Powerpoint_PowerPointSlide"}static kl(){return[]}}Object(h.a)(dd,"PowerPointSlide",Fa.a,[]);class $c extends Fa.a{constructor(){super();this.content=null;this.H_=Object.assign(new cb.a,{T_:$c.getTypeName(),B_:$c.kl()})}static getTypeName(){return"AugLoop_Text_TextTile"}static kl(){return[]}}Object(h.a)($c,"TextTile",Fa.a,[]);class Pc extends $c{constructor(){super();
this.isColdIp=this.ipPosition=this.queryRange=this.fontKerning=this.specialIndentBy=this.specialIndentType=this.bulletAndNumberFontFamily=this.bulletAndNumberFontSize=this.listId=this.rightIndentation=this.lineSpacing=this.spacingAfterParagraph=this.spacingBeforeParagraph=this.objectReferences=this.isInsideTOC=this.isInsideTable=this.formattedRanges=this.alignment=this.listType=this.outlineLevel=this.indentation=null;this.H_=Object.assign(new cb.a,{T_:Pc.getTypeName(),B_:Pc.kl()})}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static kl(){return["AugLoop_Text_TextTile"]}}
Object(h.a)(Pc,"FormattedTextTile",$c,[]);class Ad{constructor(da,Ea,$a,fb,qc,Hc){this.Mb=da;this.zm=Ea;this.Vh=fb;this.Ga=$a;this.v9j=qc;this.yc=Hc}EWb(da){if(!da||!da.isConnected)return null;da=Object(I.a)(123,da);if(!da)return null;let Ea=null;const $a=new A.a;var fb=da.om();for(var qc of fb)(fb=this.L5f(qc,!1))&&$a.add(fb);(qc=da.dQa())&&qc.isConnected&&(qc=this.L5f(qc,!0))&&$a.add(qc);if(0<$a.count&&(Ea=Object.assign(new dd,{shapes:$a.toArray()}),this.Ga.mYb)){Ea.isSlideHidden=da.En;Ea.themeId=
this.L0b(da);try{Ea.cid=da.cid.toString(),Ea.sid=da.sid.toString()}catch(Hc){Cc.a.J(575494306,822,50,"Exception message: "+Hc.message)}}return Ea}L5f(da,Ea){if(!da)return null;var $a=this.Mb.Kc(da);$a=this.zm.J6($a,$a.currentNode);let fb=null;const qc=new A.a;for(;$a.moveNext();){var Hc=$a.currentNode;if(Hc&&this.Vh.Wd(Hc)){Hc=Object(I.a)(gd.AParagraphNode,Hc);var kd=this.Vh.text(Hc);kd&&(kd=Object.assign(new Pc,{content:kd}),this.Ga.mYb&&this.v9j.lwk(kd,Hc),qc.add(kd))}}0<qc.count&&(fb=Object.assign(new tc,
{textTiles:qc.toArray()}));this.Ga.mYb&&fb&&(fb.shapeType=this.$Pi(da,Ea));return fb}$Pi(da,Ea){if(Ea)return 3;if(!da)return 9;switch(da.zj){case 0:case 2:return 0;case 3:return 1;case 10:return 7;case 15:return 5;case 9:case 12:return 8;case 8:return this.wcj(da)}return 9}wcj(da){return da?0<da.T0d().length?4:da.dca?9:da.wy?6:2:9}L0b(da){if(!da)return"";da=da.uj;let Ea=null;const $a=this.yc.TH();if($a&&0<$a.length&&da)for(const fb of $a)if(fb.Id===da){Ea=fb;break}return Ea&&Ea.ThemeFamilyId?Ea.ThemeFamilyId:
""}}Object(h.a)(Ad,"SlideTileManager",null,[1065]);class Ee extends Jb{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac){super(Ea&401,$a,fb,Ac);this.X2c=da.Bd(8);this.eT=da.Bd(12);this.sT=qc;this.x8j=Hc;this.P8=kd}dw(){16===(this.Yx&16)&&(this.eT.Bza(Object(w.a)(this,this.AGa,"onBeforeParagraphDisconnect")),this.$Y[Object(Be.a)(Xb,16)]=this.sT.xAi());1===(this.Yx&1)&&(this.eT.xk(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.$Y[Object(Be.a)(Xb,1)]=this.sT.yAi());128===(this.Yx&
128)&&(this.X2c.Iga(Object(w.a)(this,this.onSlideConnected,"onSlideConnected")),this.$Y[Object(Be.a)(Xb,128)]=this.sT.vAi());256===(this.Yx&256)&&(this.X2c.t6(Object(w.a)(this,this.onSlideDisconnected,"onSlideDisconnected")),this.$Y[Object(Be.a)(Xb,256)]=this.sT.wAi())}ena(){this.eT.Tm(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.eT.xHa(Object(w.a)(this,this.AGa,"onBeforeParagraphDisconnect"));this.X2c.ima(Object(w.a)(this,this.onSlideConnected,"onSlideConnected"));
this.X2c.yHa(Object(w.a)(this,this.onSlideDisconnected,"onSlideDisconnected"))}onSlideConnected(da,Ea){this.Rqa(Ea,128)}onSlideDisconnected(da,Ea){this.Rqa(Ea,256)}fireTileEvents(){try{Vd.a.forEach(this.Bha,da=>{this.jZb(Object(I.a)(Ic,this.Bha[da]));delete this.Bha[da]},null)}catch(da){Cc.a.J(512496604,306,10,"Exception thrown at FireTileEvents: "+da)}}jZb(da){if(da&&da.graphNode){var Ea=this.x8j.EWb(da.graphNode,Ib[da.wSa]),$a=null,fb=Object(I.a)(123,da.graphNode);if(fb&&!fb.dN&&!fb.vvb){var qc=
Nb.a("AL.SlideTileIdOriginalFormat")?fb.sid.toString()+fb.cid.toString():fb.sid.toString()+"#"+fb.cid.toString();fb=["session","doc"];Ea=[Object.assign(new sb.a,{id:qc,body:Ea})];10===da.wSa?"slideAdded"in da.$Ya||($a=Object.assign(new Za,{parentPath:fb,items:Ea})):$a="slideAdded"in da.$Ya?Object.assign(new sa.a,{parentPath:fb,items:Ea}):Object.assign(new va.a,{parentPath:fb,items:Ea});$a&&this.P8.execute(Hc=>{Hc.submitOperation($a)})}}}}Object(h.a)(Ee,"SlideTileTriggerController",Jb,[]);var Ce=d(1166),
Fb=d(30);class $e{constructor(da,Ea){this.Jz=da;this.K8=Ea}lwk(da,Ea){try{da.listType=this.isb(Ea),da.outlineLevel=Zb.ParagraphReader.BMc(Ea),da.indentation=$e.M5i(this.K8.m7(Ea))}catch($a){Cc.a.J(587313229,822,50,"Exception message: "+$a.message)}}isb(da){const Ea=new Fb.GraphIterator;Ea.set(da);Ea.mc(11);Ea.Ng(11);return(da=this.Jz.Fw(Ea))?$e.gui(da.listType):6}static gui(da){switch(da){case 15:return 5;case 1:return 1;case 42:return 7;case 13:return 3;case 14:return 4;case 16:return 6;case 0:return 2;
default:return 7}}static M5i(da){return 2===da.Pf?Math.floor(Ce.a.eMf(da.value)/20):Math.floor(da.value/20)}}Object(h.a)($e,"TextTileFormatter",null,[1045]);var bg=d(77);class Ye{constructor(){this.JPe="TML";this.va=new bg.a}U5h(da){this.va.addHandler(this.JPe,da)}TQk(da){this.va.removeHandler(this.JPe,da)}EGk(da){this.va.raiseEvent(this.JPe,da)}}Object(h.a)(Ye,"TilingEventSource",null,[1058,1059,1060]);class Ae{}Ae.G7k="ShapeTextOnActiveSlideDomReady";Ae.J7k="ShapeTextOnSelectionFinished";Ae.I7k=
"ShapeTextOnParagraphPropertyChanged";Ae.K7k="ShapeTextOnShapeChildTopologyChanged";Ae.H7k="ShapeTextOnParagraphDisconnect";Ae.tel="SlideTextOnActiveSlideDomReady";Ae.xel="SlideTextOnParagraphPropertyChanged";Ae.wel="SlideTextOnParagraphDisconnect";Ae.yel="SlideTextOnShapeChildTopologyChanged";Ae.vel="SlideTextOnNumberListPropertyChanged";Ae.uel="SlideTextOnNumberListDisconnect";Ae.oel="SlideOnParagraphPropertyChanged";Ae.nel="SlideOnParagraphDisconnect";Ae.lel="SlideOnConnect";Ae.mel="SlideOnDisconnect";
Object(h.a)(Ae,"DetectStrategyName",null,[]);class si{constructor(da){this.mT=da}get Yx(){return 4}n2(da,Ea){const $a=[];if((da=Object(I.a)(ec.a,da))&&da.Ba&&(da=Object(I.a)(123,da.Ba))){da=da.om();for(const fb of da)this.mT.eWb(fb)&&Array.add($a,fb);0<$a.length&&Ea($a,1)}}}Object(h.a)(si,"ShapeTextOnActiveSlideDomReadyDetectStrategy",null,[1093]);var Jf=d(250);class tg{constructor(da,Ea,$a){this.Ea=da;this.mT=Ea;this.ra=$a}get Yx(){return 16}n2(da,Ea){if((da=Object(I.a)(Jf.a,da))&&da.node&&12===
da.node.type&&(da=this.Ea.kn(da.node))&&this.mT.eWb(da)){var $a=this.ra.lZ();$a&&$a.id===da.id&&($a=[],Array.add($a,da),Ea($a,6))}}}Object(h.a)(tg,"ShapeTextOnParagraphDisconnectDetectStrategy",null,[1093]);var Dg=d(39),Vg=d(349);class Ih{constructor(da,Ea,$a){this.Ea=da;this.mT=Ea;this.ra=$a}get Yx(){return 1}n2(da,Ea){if((da=Object(I.a)(Vg.a,da))&&da.node&&12===da.node.type){const fb=this.Ea.kn(da.node);if(fb&&this.mT.eWb(fb)){var $a=this.ra.lZ();$a&&$a.id===fb.id&&(da.property===Dg.a.listLevel?
this.Upb(3,fb,Ea):da.property===hd.a.Zp&&this.Upb(4,fb,Ea))}}}Upb(da,Ea,$a){if(Ea){var fb=[];Array.add(fb,Ea);$a(fb,da)}}}Object(h.a)(Ih,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,[1093]);var hf=d(825);class ld{constructor(da,Ea,$a,fb){this.ra=da;this.mT=Ea;this.y_=$a;this.Rac=fb}get Yx(){return 2}n2(da,Ea){const $a=[];if(da=Object(I.a)(hf.a,da))if(this.Rac&&this.y_&&this.y_.Noj(da.zF),!this.ra.G2())this.Rac&&this.y_&&this.y_.xEb();else if(da.OD&&da.OD.length){this.Rac&&this.y_&&this.y_.xEb();
da=this.ra.ae();for(const fb of da)this.mT.eWb(fb)&&Array.add($a,fb);0<$a.length&&Ea($a,2)}}}Object(h.a)(ld,"ShapeTextOnSelectionFinishedDetectStrategy",null,[1093]);var ph=d(575);class Kf{constructor(da,Ea){this.ra=da;this.mT=Ea}get Yx(){return 8}n2(da,Ea){const $a=[];if((da=Object(I.a)(ph.a,da))&&da.node&&10===da.node.type&&1===da.PY&&(da=Object(I.a)(4,da.node))&&this.mT.eWb(da)){var fb=this.ra.lZ();fb&&fb.get_shapeId()===da.get_shapeId()&&(Array.add($a,da),Ea($a,5))}}}Object(h.a)(Kf,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",
null,[1093]);class Ud{constructor(da){this.VBg=da}get Yx(){return 1===this.VBg?128:256}n2(da,Ea){if((da=Object(I.a)(Jf.a,da))&&da.node&&8===da.node.type){const $a=[];Array.add($a,da.node);1===this.VBg?Ea($a,9):Ea($a,10)}}}Object(h.a)(Ud,"SlideOnConnectOrDisconnectDetectStrategy",null,[1093]);class He{constructor(da){this.rc=da}get Yx(){return 16}n2(da,Ea){if((da=Object(I.a)(Jf.a,da))&&da.node&&12===da.node.type){const $a=this.rc.Sg(da.node);$a&&(da=[],Array.add(da,$a),Ea(da,6))}}}Object(h.a)(He,"SlideOnParagraphDisconnectDetectStrategy",
null,[1093]);class Bh{constructor(da){this.rc=da}get Yx(){return 1}n2(da,Ea){var $a=Object(I.a)(Vg.a,da);if($a&&$a.node&&12===$a.node.type){const fb=this.rc.Sg($a.node);fb&&Object(I.a)(gd.AParagraphNode,$a.node)&&(da=0,$a.property===Dg.a.listLevel?da=3:$a.property===hd.a.Zp&&(da=4),$a=[],Array.add($a,fb),Ea($a,da))}}}Object(h.a)(Bh,"SlideOnParagraphPropertyChangedDetectStrategy",null,[1093]);class eg{get Yx(){return 4}n2(da,Ea){if((da=Object(I.a)(ec.a,da))&&da.Ba&&(da=Object(I.a)(123,da.Ba))){var $a=
da.om();for(var fb of $a)if(fb.hasText){fb=[];Array.add(fb,da);Ea(fb,1);break}}}}Object(h.a)(eg,"SlideTextOnActiveSlideDomReadyDetectStrategy",null,[1093]);class jd{constructor(da,Ea){this.rc=da;this.ta=Ea}get Yx(){return 64}n2(da,Ea){if((da=Object(I.a)(Jf.a,da))&&this.ta.Ba&&da.node&&22===da.node.type&&(da=this.rc.Sg(da.node))&&da.id===this.ta.Ba.id){const $a=[];Array.add($a,da);Ea($a,7)}}}Object(h.a)(jd,"SlideTextOnNumberListDisconnectDetectStrategy",null,[1093]);class Jh{constructor(da,Ea){this.rc=
da;this.ta=Ea}get Yx(){return 32}n2(da,Ea){var $a=Object(I.a)(Vg.a,da);$a&&$a.node&&22===$a.node.type&&(da=this.rc.Sg($a.node))&&this.ta.Ba&&da.id===this.ta.Ba.id&&$a.property===hd.a.Ni&&($a=[],Array.add($a,da),Ea($a,8))}}Object(h.a)(Jh,"SlideTextOnNumberListPropertyChangedDetectStrategy",null,[1093]);class kf{constructor(da,Ea,$a,fb){this.ta=da;this.Gl=Ea;this.rc=$a;this.z$b=fb}get Yx(){return 16}n2(da,Ea){if((da=Object(I.a)(Jf.a,da))&&da.node&&this.ta.Ba&&12===da.node.type){const $a=this.rc.Sg(da.node);
!$a||$a.id!==this.ta.Ba.id||this.Gl.Kia(da.node)&&!this.z$b||(da=[],Array.add(da,this.ta.Ba),Ea(da,6))}}}Object(h.a)(kf,"SlideTextOnParagraphDisconnectDetectStrategy",null,[1093]);class Ji{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac){this.ta=da;this.Gl=Ea;this.rc=$a;this.Ea=fb;this.z$b=qc;this.y_=kd;this.Rac=Ac}get Yx(){return 1}n2(da,Ea){if((da=Object(I.a)(Vg.a,da))&&da.node&&this.ta.Ba&&12===da.node.type){var $a=this.rc.Sg(da.node);if($a&&$a.id===this.ta.Ba.id&&($a=Object(I.a)(gd.AParagraphNode,da.node))&&
(!this.Gl.Kia($a)||this.z$b)){var fb=this.Ea.kn($a);fb.nsa||fb.wy||fb.Qf||fb.nd||!fb.al||!this.Rac||(this.y_.settings.hze=!0,this.y_.Hpl($a));da.property===Dg.a.listLevel?this.Upb(3,this.ta.Ba,Ea):da.property===hd.a.Zp?this.Upb(4,this.ta.Ba,Ea):da.property===id.a.eca&&($a.sa(id.a.eca,!1)||this.Upb(4,this.ta.Ba,Ea))}}}Upb(da,Ea,$a){if(Ea){var fb=[];Array.add(fb,Ea);$a(fb,da)}}}Object(h.a)(Ji,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[1093]);class hh{constructor(da,Ea){this.ta=da;this.rc=
Ea}get Yx(){return 8}n2(da,Ea){da=Object(I.a)(ph.a,da);this.ta.Ba&&da&&da.node&&10===da.node.type&&1===da.PY&&(da=Object(I.a)(4,da.node))&&(da=this.rc.Sg(da))&&da.id===this.ta.Ba.id&&(da=[],Array.add(da,this.ta.Ba),Ea(da,5))}}Object(h.a)(hh,"SlideTextOnShapeChildTopologyChangedDetectStrategy",null,[1093]);class Wb{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac,Lc){this.rc=da;this.Ea=Ea;this.nb=$a;this.mT=fb;this.ta=qc;this.Gl=Hc;this.Ga=kd;this.zG=Ac;this.y_=Lc}p2i(da){if(Id.a.Va(da))return 0;let Ea=0;for(const $a of da)Ea|=
this.kUk($a);return Ea}r2i(da){if(Id.a.Va(da))return 0;let Ea=0;for(const $a of da)Ea|=this.mUk($a);return Ea}q2i(da){if(Id.a.Va(da))return 0;let Ea=0;for(const $a of da)Ea|=this.lUk($a);return Ea}lAi(){return new Ih(this.Ea,this.mT,this.nb)}mAi(){return new ld(this.nb,this.mT,this.y_,this.Ga.Bfc)}jAi(){return new si(this.mT)}nAi(){return new Kf(this.nb,this.mT)}kAi(){return new tg(this.Ea,this.mT,this.nb)}zAi(){return new eg}CAi(){return new kf(this.ta,this.Gl,this.rc,this.Ga.pptNotesInSlideTextTileIsEnabled)}DAi(){return new Ji(this.ta,
this.Gl,this.rc,this.Ea,this.Ga.pptNotesInSlideTextTileIsEnabled,this.zG,this.y_,this.Ga.Bfc)}EAi(){return new hh(this.ta,this.rc)}BAi(){return new Jh(this.rc,this.ta)}AAi(){return new jd(this.rc,this.ta)}xAi(){return new He(this.rc)}yAi(){return new Bh(this.rc)}wAi(){return new Ud(2)}vAi(){return new Ud(1)}kUk(da){return da===Ae.I7k?1:da===Ae.J7k?2:da===Ae.G7k?4:da===Ae.K7k?8:da===Ae.H7k?16:0}mUk(da){return da===Ae.tel?4:da===Ae.wel?16:da===Ae.xel?1:da===Ae.yel?8:da===Ae.vel?32:da===Ae.uel?64:0}lUk(da){return da===
Ae.nel?16:da===Ae.oel?1:da===Ae.lel?128:da===Ae.mel?256:0}}Object(h.a)(Wb,"TilingFactory",null,[1046]);class Uc extends Sys.EventArgs{constructor(da){super();this.Ba=da}}Object(h.a)(Uc,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);class Sc{constructor(){this.K=null;this.xpe=this.Cde=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}Wb(da){this.K=da;da.register(Ye,"PowerPointWebEditor.ContentUpdateDetection.TilingEventSource").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventSource").ma().na(()=>
new Ye);da.register(1043,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").ma().na(()=>new Td(da.resolve("Box4.Graph.IGraphIteratorFactory"),da.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),da.resolve("PowerPointWebEditor.IShapeReader"),da.resolve("Box4.IParagraphReader")));da.register(1044,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").ma().na(()=>new nc(da.resolve("Box4.IParagraphReader"),da.resolve("PowerPointWebEditor.Graph.INotesReader"),da.resolve("Box4.Proofing.IProofingTextUtility"),
da.resolve("Box4.Graph.IGraphIteratorFactory"),da.resolve("Box4.ITableNavigator"),da.resolve("PowerPointWebEditor.Graph.ITableReader"),da.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),da.resolve("Box4.IListMarkerUtility"),da.resolve("PowerPointWebEditor.IPPTParagraphReader"),da.resolve("Box4.List.IListReader"),da.resolve("PowerPointWebEditor.IApplicationSettings").pptNotesInSlideTextTileIsEnabled,da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTopologyAndListInfoInSlideTileIsEnabled));
da.register(1045,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").ma().na(()=>new $e(da.resolve("Box4.List.IListReader"),da.resolve("Box4.IParagraphIndentationReader")));da.register(Ad,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").ma().na(()=>new Ad(da.resolve("Box4.Graph.IGraphIteratorFactory"),da.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),da.resolve("PowerPointWebEditor.IApplicationSettings"),da.resolve("Box4.IParagraphReader"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),
da.resolve("PowerPointWebEditor.IPresentationReader")));da.register(1046,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ma().na(()=>new Wb(da.resolve("PowerPointWebEditor.ISlideReader"),da.resolve("PowerPointWebEditor.IShapeReader"),da.resolve("PowerPointWebEditor.IPptSelectionManager"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),da.resolve("PowerPointWebEditor.Graph.INotesReader"),da.resolve("PowerPointWebEditor.IApplicationSettings"),
da.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),da.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));da.register(hb,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").ma().na(()=>new hb(da.resolve("Box4.Graph.IGraphInstance"),da.resolve("PowerPointWebEditor.IPptSelectionManager"),da.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),da.La("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),da.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
da.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").p2i(da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),da.resolve("Common.ITaskManager"),da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireTileEventsIntervalInMilliseconds,da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),
da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),da.resolve("PowerPointWebEditor.IApplicationSettings").replaceObjectUseClientAL));da.register(Gb,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").ma().na(()=>new Gb(da.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").r2i(da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),da.resolve("Common.ITaskManager"),
da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),da.resolve("Box4.Graph.IGraphInstance"),da.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers"),
da.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));da.register(Ee,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").ma().na(()=>new Ee(da.resolve("Box4.Graph.IGraphInstance"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").q2i(da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),da.resolve("Common.ITaskManager"),da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,
da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),da.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),da.resolve("PowerPointWebEditor.IApplicationSettings")))}t1f(){return Nb.a("AL.SendSlideTile")}init(){const da=this.K.resolve("Common.IAppSettingsManager");da.ff(()=>{this.Cde=da.ka("497");this.xpe=da.ka("810")||da.ka("809");this.Cde&&
(da.ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.xpe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.t1f()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").EGk(new Uc(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba))})}dispose(){this.Cde&&
(this.K.resolve("Common.IAppSettingsManager").ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),(this.xpe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),this.t1f()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize())}static main(){v.a.instance.Ac(new Sc)}}
Object(h.a)(Sc,"PPTWebEditorContentUpdateDetectionPackage",null,[2,3]);var Od=d(985),ug=d(634),te=d(138),mf=d(152),Yf=d(516),Jd=d(107),ce=d(46);class fe{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac){this.type="EditorPaneProps";this.critiqueCountInclusiveness=this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=da;this.critiqueCountGrammar=
Ea;this.critiqueCountFormality=$a;this.critiqueCountPunctuationConvention=fb;this.critiqueCountVocabulary=qc;this.critiqueCountConciseness=Hc;this.critiqueCountClarity=kd;this.critiqueCountInclusiveness=Ac}}Object(h.a)(fe,"EditorPaneProps",null,[]);class Gg{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac,Lc,yc,Oc,od,di,ij,rh){this.Ib=!1;this.Zfi=320;this.MUa=!1;this.j$={};if(!da)throw Error.argumentNull("pptSelectionManager");if(!Ea)throw Error.argumentNull("appFrame");if(!$a)throw Error.argumentNull("actionManager");
if(!fb)throw Error.argumentNull("focusManager");if(!qc)throw Error.argumentNull("editorPane");if(!kd)throw Error.argumentNull("graphOperationEventHandler");if(!Ac)throw Error.argumentNull("viewElementEventHandlers");if(!Lc)throw Error.argumentNull("viewEventSource");if(!yc)throw Error.argumentNull("pageView");if(!od)throw Error.argumentNull("workspace");if(!di)throw Error.argumentNull("dynamicScriptLoader");if(!rh)throw Error.argumentNull("graphTopologyManager");di.loadScript("powerpoint-editor-intl").then(()=>
{this.MUa=!0}).catch(Qg=>{Cc.a.J(512267606,801,10,"Failed to load powerpoint-editor-intl "+Qg.toString())});this.Nb=Ea;this.ia=$a;this.pee=ij;this.Fa=fb;this.Lg=kd;this.od=Ac;this.Qc=Lc;this.P8=Oc;this.ta=rh;this.Lg.WJ(this.CGa.bind(this));this.Lg.Aza(this.CGa.bind(this));this.Qc.QMa(this.CGa.bind(this));this.od.Dza(this.CGa.bind(this));this.Nb.vM(this.$v.bind(this));this.initialize()}initialize(){this.P8.execute(da=>{da.addEventHandler(Yf.a.DMd,this.Xkj.bind(this))})}dispose(){this.Lg.z4(this.CGa.bind(this));
this.Lg.YWa(this.CGa.bind(this));this.Qc.qeb(this.CGa.bind(this));this.od.seb(this.CGa.bind(this));this.Nb.rX(this.CGa.bind(this))}ub(){this.ia.pa(Kc.a.dhd,Mb.a.application,this.dhd.bind(this),4);this.ia.pa(Kc.a.iad,Mb.a.application,this.iad.bind(this),96)}we(){}CGa(){this.Ib&&this.Kl(!0)}$v(da){1===da.mode&&this.Ib&&(this.Ib=!1,this.Ds(),this.Fa.Gj(ce.a.hba,this.Ib))}iad(da,Ea,$a,fb,qc){(da=Object(I.a)(Jd.a,qc))&&da.Kf(this.Ib);return 32}dhd(da,Ea,$a){return this.MUa?1===$a?32:2===$a?(this.Ib=!this.Ib,
mf.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Ib.toString(),da,()=>{this.Ib?this.Kl():this.Ds();return 32})):8:8}Kl(da=!1){const Ea=this.IB(),$a=Object.assign(new ug.a,{title:"Editor Pane",hideHeader:!1,width:this.Zfi,location:2,contentProps:Ea,onOpen:()=>{},onClose:()=>{this.Ib=!1},isModernPane:!0});te.UISurfaces.Cs().then(fb=>{da?fb.updateTaskPane(ce.a.hba,$a):fb.showTaskPane(ce.a.hba,$a);return null}).catch(fb=>{Cc.a.J(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+
fb.toString())})}Ds(){te.UISurfaces.Cs().then(da=>{da.hideTaskPane(ce.a.hba,2);return null}).catch(da=>{Cc.a.J(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+da.toString())})}IB(){let da=0,Ea=0,$a=0,fb=0,qc=0,Hc=0,kd=0,Ac=0;const Lc=this.ta.Ba?this.ta.Ba.cid:void 0;Lc&&this.j$[Lc]&&Object.keys(this.j$[Lc]).forEach(yc=>{this.j$[Lc][yc].forEach(Oc=>{switch(Oc.CategoryTitle){case "Spelling":da+=1;break;case "Grammar":Ea+=1;break;case "Conciseness":Hc+=1;break;case "Formality":$a+=
1;break;case "PunctuationConventions":fb+=1;break;case "Clarity":kd+=1;break;case "Inclusiveness":Ac+=1;break;case "Vocabulary":qc+=1;break;default:Cc.a.J(509727769,822,50,"Unknown Critique Type: "+Oc.CategoryTitle)}})});return new fe(da,Ea,$a,fb,qc,Hc,kd,Ac)}Ftl(da,Ea){const $a={};Object.keys(da).forEach(fb=>{this.j$[Ea]?(Object.keys(this.j$[Ea]).includes(fb),this.j$[Ea][fb]=da[fb]):($a[fb]=da[fb],this.j$[Ea]=$a)})}Xkj(da,Ea,$a,fb){Ea&&fb&&(da=JSON.parse(Ea.Content),fb=this.pee.tQf(fb.critiques),
Ea=this.ta.Ba.cid,null!=fb&&0<fb.length?this.Ftl(this.$Yi(fb),Ea):0==fb.length&&this.j$[Ea]&&this.$Ii(da.drawingElems,Ea),this.j$[Ea]&&this.vOk(da.drawingElems,Ea),this.Kl(!0))}vOk(da,Ea){const $a=Object.keys(this.j$[Ea]),fb=this.Zfj(da);$a.forEach(qc=>{fb.includes(qc)||delete this.j$[Ea][qc]})}Zfj(da){const Ea=[];da.forEach($a=>{0<$a.text.paragraphs.length&&$a.text.paragraphs.forEach(fb=>{Ea.push(fb.id)})});return Ea}$Ii(da,Ea){da.forEach($a=>{0<$a.text.paragraphs.length&&this.jli($a.text.paragraphs,
Ea)})}jli(da,Ea){da.forEach($a=>{this.j$[Ea][$a.id]&&($a.pfRuns[0].pf.proofingDirty||""==$a.chars)&&delete this.j$[Ea][$a.id]})}$Yi(da){const Ea={};if(da)for(const $a of da)$a.TileId in Ea?Array.add(Ea[$a.TileId],$a):Ea[$a.TileId]=[$a];return Ea}}Object(h.a)(Gg,"DexLitePaneActor",null,[106,244]);class Me{constructor(){this.va=new bg.a}PBe(da){this.va.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",da)}xCf(da){this.va.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",da)}}Object(h.a)(Me,
"EditorRuntimeEventSource",null,[980,981,982]);var se=d(15),Pf=d(49),yg=d(669),qe=d(32);class yd{constructor(da,Ea){this.paragraph=da;this.critiqueId=Ea}}Object(h.a)(yd,"CritiqueToHighlight",null,[]);class zf{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac,Lc,yc){this.Jca=da;this.m_j=Ea;this.ta=$a;this.WB=fb;this.Db=qc;this.iW=Hc;this.ra=kd;this.Qee=Ac;this.Fa=Lc;this.P0j=yc;this.Jca.XCe(this.m_j)}qPc(da){da.length?(da=this.V8i(da),da.length&&(da=Object.assign(new yg.a,{action:0,type:2,Nba:da,Fdb:this.Jca.c9a?
this.Jca.c9a.Nba:null}),this.Jca.kfd(da))):this.PDi()}PDi(){var da=this.Jca.c9a?this.Jca.c9a.Nba:null;da=Object.assign(new yg.a,{action:1,type:2,Nba:da,Fdb:da});this.Jca.kfd(da)}V8i(da){const Ea=[];if(!this.Qee.isEnabled(2))return Ea;var $a=this.ta.Ba;if($a&&$a.isSlideCritiqueReady){var fb=$a.yIa;if(!fb.count)return this.qce(2),Ea;$a=0;for(let Hc of fb)if(fb=Object(I.a)(gd.AParagraphNode,Hc)){var qc=this.lZd(fb);for(const kd of qc)qc=Object(I.a)(384,kd.Dh),qc.GM&&Array.contains(da,qc.GM.TraceId)&&
($a++,qc=new yd(fb,qc.GM.TraceId),Array.add(Ea,qc))}$a!==da.length&&this.Bce(2,$a,da.length)}else this.yce(2,$a);return Ea}evh(da){if(!this.Qee.isEnabled(3))return!1;var Ea=this.ta.Ba;if(Ea&&Ea.isSlideCritiqueReady){Ea=Ea.yIa;if(!Ea.count)return this.qce(3),!1;let $a=0;const fb=this.Db.rd(15,void 0,()=>{this.P5g()});try{let qc=!1;fb.jc(Ea.ga(0));fb.$c=qe.a.gjd;for(let Hc of Ea){const kd=Object(I.a)(gd.AParagraphNode,Hc);if(kd){const Ac=new A.a,Lc=this.lZd(kd);for(const yc of Lc){const Oc=Object(I.a)(384,
yc.Dh);if(Oc.GM&&da.Jb(Oc.GM.TraceId)){const od=da.ga(Oc.GM.TraceId);let di;try{di=Oc.GM.Suggestions[od].Text;const ij=new se.a(yc,di);Ac.add(ij);qc||(Oc.kJa(this.vak(od)),qc=!0);$a++}catch(ij){Cc.a.J(38843398,375,10,"Take suggestion: Parse failed with exception: {0}",ij)}}}Ac.count&&(Ac.Sc((yc,Oc)=>Oc.key.begin-yc.key.begin),this.VRk(kd,Ac))}}$a!==da.count&&this.Bce(3,$a,da.count)}finally{fb&&fb.dispose()}}else return this.yce(3,Ea),!1;return!0}vak(da){switch(da){case 0:return qe.a.Rwa;case 1:return qe.a.Swa;
case 2:return qe.a.Twa;case 3:return qe.a.SIa;case 4:return qe.a.TIa;default:return 0}}VRk(da,Ea){for(let $a of Ea)this.iW.replaceTextRange(Pf.a.createTextRange(da,0<$a.key.begin?$a.key.begin:0,$a.key.end),$a.value,!0,!1)}ignoreCritiques(da,Ea){if(!this.Qee.isEnabled(Ea))return!1;var $a=this.ta.Ba;if($a&&$a.isSlideCritiqueReady){var fb=$a.yIa;if(!fb.count)return this.qce(Ea),!1;this.P5g();$a=!1;let qc=0;for(let Hc of fb)if(fb=Object(I.a)(gd.AParagraphNode,Hc)){fb=this.lZd(fb);for(const kd of fb)fb=
Object(I.a)(384,kd.Dh),fb.GM&&Array.contains(da,fb.GM.TraceId)&&(fb.sCa=!0,$a||(fb.kJa(qe.a.F4d),$a=!0),qc++)}qc!==da.length&&this.Bce(Ea,qc,da.length)}else return this.yce(Ea,$a),!1;return!0}lZd(da){return this.WB.RE(da,Ea=>{Ea=Object(I.a)(384,Ea.Dh);return!!Ea&&5===Ea.proofingType&&!Ea.sCa})}qce(da){Cc.a.J(38843400,375,15,"{0}: No slide critique in active slide. Skipping",da)}Bce(da,Ea,$a){Cc.a.J(38843402,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",da,Ea,$a)}yce(da,Ea){Cc.a.J(38843404,
375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",da,!!Ea)}P5g(){this.ra.ly();this.ra.hj();this.P0j&&this.Fa.Bf(ce.a.yg,!0)}}Object(h.a)(zf,"ConsistencyCheckActor",null,[951]);var xd=d(305),fg=d(95),Ki=d(887),jg=d(666),Ch=d(48),ih=d(667),qh=d(668);class Md extends jg.a{constructor(da,Ea){super();this.aYc=[Ki.a.bte,Ki.a.fVc,Ki.a.Idd,Ki.a.kBc];this.ta=da;this.l3j=Ea;this.ije=[new ih.a("InconsistentCritiquesHighlight",null),new ih.a("InconsistentCritiquesLeftSidebar",
null),new ih.a("InconsistentCritiquesRightSidebar",null)]}get ntb(){return this.l3j}get j4d(){return this.ije}T2b(da,Ea){da=Object(Rc.a)(Array,da)?Array.isArray(da)?da:null:null;if(!da||0<da.length&&!Object(I.a)(yd,da[0]))return Ea;const $a=new Ch.GraphTransaction(3);try{$a.fd(this.ta.presentation);for(const fb of da)qh.b(fb.paragraph),Ea.add(fb.paragraph)}finally{$a&&$a.dispose()}return Ea}odc(da,Ea){if(this.ntb&&this.qZ&&this.qZ.rha&&this.qZ.rha.Nba&&2===this.qZ.rha.type){var $a=[],fb=[];this.K4g(this.qZ.rha.Nba,
$a,fb);var qc=[];this.K4g(this.qZ.rha.Fdb,null,qc);Ea=Ea.querySelectorAll("*");for(let Hc=0;Hc<Ea.length;Hc++){let kd="",Ac="";const Lc=Ea[Hc];for(let yc=0;yc<this.aYc.length;yc++)xd.a.re(Lc,this.aYc[yc])&&(Ac=this.aYc[yc],kd=xd.a.re(Lc,this.aYc[yc]));kd.length&&2===this.qZ.rha.type&&(0===this.qZ.rha.action?Array.contains(fb,da)&&Array.contains($a,kd)?this.nsj(Lc,Ac):this.lcd(Lc):1===this.qZ.rha.action&&Array.contains(qc,da)&&this.lcd(Lc))}}}nsj(da,Ea){fg.a.OH(da,"InconsistentCritiquesHighlight");
switch(Ea){case Ki.a.fVc:fg.a.OH(da,"InconsistentCritiquesLeftSidebar");break;case Ki.a.Idd:fg.a.OH(da,"InconsistentCritiquesRightSidebar");break;case Ki.a.kBc:fg.a.OH(da,"InconsistentCritiquesLeftSidebar"),fg.a.OH(da,"InconsistentCritiquesRightSidebar")}}K4g(da,Ea,$a){if(da)for(const fb of da)Array.add($a,fb.paragraph),Ea&&Array.add(Ea,fb.critiqueId)}}Object(h.a)(Md,"CritiquesHighlightActor",jg.a,[]);class Ed{}Object(h.a)(Ed,"Critique",null,[]);class Bd{}Object(h.a)(Bd,"Suggestion",null,[]);class Xh{rQf(da,
Ea){if(!da)return[];const $a=Array(da.length);for(let fb=0;fb<da.length;fb++)$a[fb]=Ea(da[fb]);return $a}Jti(da){return Object.assign(new Ed,{critiqueId:da.TraceId,typeId:da.TypeId,tag:da.Tag,bucketId:da.BucketId,paragraphId:da.TileId,start:da.Start,length:da.Length,categoryTitle:da.CategoryTitle,explanationTitle:da.ExplanationTitle,explanationLabel:da.ExplanationLabel,explanation:da.Explanation,suggestions:this.rQf(da.Suggestions,Object(w.a)(this,this.Kti,"convertBox4Suggestion"))})}Kti(da){return Object.assign(new Bd,
{text:da.Text,description:da.Description,bucketId:da.BucketId,numberOfInstances:da.NumberOfInstances})}}Object(h.a)(Xh,"DataContractMapper",null,[954]);class $f extends Sys.EventArgs{constructor(da){super();this.instanceId=da}}Object(h.a)($f,"PaneClosedEventArgs",Sys.EventArgs,[]);var Vi=d(205);class ci{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac){this.ia=da;this.Xd=Ea;this.Qc=$a;this.Ofe=fb;this.ezb=qc;this.Pxb=Hc;this.rje=kd;this.e$j=Ac;this.Ae=0;this.Xd.execute(Lc=>{Lc.rGd(Object(w.a)(this,this.Ocb,"onPaneClosed"))})}get state(){return this.Ae}hgd(da){this.Ae!==
da&&(this.Ae=da,this.Qc.RD(new Vi.a(1)))}F1g(da){0===this.state&&(Cc.a.J(36966754,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",da,(new Date).getTime()),this.hgd(1),da={},da.fU=ResourceStrings.L_EditorPaneTitle,da.assetId=this.ezb.getAssetId(),da.cva=Object(w.a)(this,this.Jve,"onPaneRendered"),da.nonPersistedSettings={},da.nonPersistedSettings.IdeasEnabled=this.rje.toString(),da.Anc=this.e$j,32!==this.ia.Ka(Kc.a.sIa,2,da)&&(Cc.a.J(36966784,375,15,"[EditorPane] Failed to open Editor pane"),
this.hgd(0)))}bK(da){if(2===this.state){var Ea=this.ezb.ZLc();Ea&&(Cc.a.J(36966786,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",da),32!==this.ia.Ka(Kc.a.iDc,2,Ea)&&Cc.a.J(36966788,375,15,"[EditorPane] Failed to close Editor pane"))}}Ocb(da,Ea){2===this.state&&Ea&&(da=Ea.instanceId)&&da.length&&(Ea=this.ezb.ZLc(),Ea!==da&&Ea||(Cc.a.J(37626588,375,50,"[EditorPane] Pane closed"),this.Ofe.rFk(new $f(da)),this.hgd(0),this.Pxb.sessionEnd()))}Jve(){const da=this.ezb.ZLc();1!==this.state?
Cc.a.J(37626590,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",da):(Cc.a.J(37626592,375,50,"[EditorPane] Pane rendered. Instance id={0}",da),this.hgd(2),this.Pxb.T_k())}}Object(h.a)(ci,"EditorPane",null,[956]);var Bi=d(342);class bh{constructor(da,Ea){this.type=0;this.id=null;this.type=da;this.id=Ea}static thb(da){return da.id&&da.id.toString().length&&Object(Rc.a)(Number,da.type)?new bh(da.type,da.id.toString()):null}}Object(h.a)(bh,
"Message",null,[]);var Wg=d(2);class jf{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac,Lc,yc,Oc,od,di,ij,rh,Qg){this.ITd=new Od.a;this.ia=da;this.VZ=Ea;this.mxb=$a;this.TEg=fb;this.WZ=qc;this.dMg=Hc;this.QK=kd;this.Ofe=Ac;this.ta=Lc;this.vka=yc;this.V2c=Oc;this.Bk=od;this.W_j=di;this.Qc=ij;this.$0j=rh;this.yc=Qg;this.eIc=new Od.a(0);this.eIc.add(0,2001);this.eIc.add(1,2002);this.eIc.add(2,2003)}ub(){this.ia.pa(Kc.a.nxk,Mb.a.application,Object(w.a)(this,this.IYf,"editorPaneButtonClicked"),4);this.ia.pa(Kc.a.v8g,
Mb.a.application,Object(w.a)(this,this.V7g,"queryEditorPaneButton"),96);this.ia.pa(Kc.a.oxk,Mb.a.application,Object(w.a)(this,this.IYf,"editorPaneButtonClicked"),4);this.ia.pa(Kc.a.w8g,Mb.a.application,Object(w.a)(this,this.V7g,"queryEditorPaneButton"),96);this.ia.pa(Kc.a.Nye,Mb.a.application,Object(w.a)(this,this.JYf,"editorPaneExtenal"),4);this.ia.pa(Kc.a.l5g,Mb.a.application,Object(w.a)(this,this.JYf,"editorPaneExtenal"),4);this.TEg.jGd(Object(w.a)(this,this.xjk,"onEditorPaneMessageReceived"));
this.vka.P2a(Object(w.a)(this,this.G_,"onSlidePresenceChanged"));this.V2c.xk(Object(w.a)(this,this.Ela,"onSlidePropertyChanged"));this.Bk.WJ(Object(w.a)(this,this.iC,"onActiveSlideChanged"));this.Ofe.K4h(Object(w.a)(this,this.Ocb,"onPaneClosed"))}we(){}JYf(da,Ea,$a){if(1===$a)return 32;switch(da){case Kc.a.Nye:this.VZ.F1g(2);break;case Kc.a.l5g:this.VZ.bK(2);break;default:return Cc.a.J(38412318,375,10,"[EditorPaneActor] Unsupported actionId: {0}",da),16}return 32}IYf(da,Ea,$a){if(1===$a)return this.yc.Nj()?
32:16;switch(this.VZ.state){case 0:return this.VZ.F1g(1),32;case 2:return this.VZ.bK(1),32;case 1:return Cc.a.J(37626594,375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Qc.RD(new Vi.a(1)),32;default:return Cc.a.J(36966800,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}V7g(da,Ea,$a,fb,qc){if(!qc||!Object(Rc.a)(Jd.a,qc))return 8;qc.Kf(2===this.VZ.state||1===this.VZ.state);return 32}xjk(da,Ea){this.yjk(Ea)}yjk(da){const Ea=this.WZ.HEi(da.message);
if(Ea){var $a;({value:$a}=this.dMg.Of(Ea.type)).returnValue||($a=this.dMg.ga(0));var fb=$a.process(da,Ea);fb.continueWith(()=>{const qc=fb.result,Hc=this.WZ.sZf(qc);this.sendMessage(da.instanceId,Hc);this.qWj(da,Ea,qc)})}else Cc.a.J(37025985,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),Wg.Task.wt(!1)}QBe(da){this.ITd.Jb(da)||this.ITd.$(da,this.$0j.HOd(200,()=>{const Ea=this.mxb.dej(da);if(Ea.length){var $a=new bh(this.eIc.ga(da),Bi.a.create().toString());$a=
this.WZ.sZf($a);this.QZk(Ea,$a)}this.W_j.PBe(da)}));this.ITd.ga(da).perform()}QZk(da,Ea){for(const $a of da)this.sendMessage($a,Ea)}sendMessage(da,Ea){this.TEg.sendMessage(da,Ea)}qWj(da,Ea,$a){const fb=new Date,qc=+fb-+da.Y$g;2E3<=qc&&Cc.a.J(39331167,375,1E4<=qc?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",
da.instanceId,da.L8d,da.Y$g.toUTCString(),fb.getTime(),qc.toString(),Ea.id,Ea.type,$a.id,$a.type)}Ela(da,Ea){Ea.property===id.a.isSlideCritiqueReady&&this.QBe(1)}iC(){this.QBe(0)}G_(da,Ea){(da=this.ta.Ba)&&Ea.slideId.equals(da.Bb)&&this.QBe(2)}Ocb(da,Ea){this.mxb.zsl(Ea.instanceId);this.QK.visualizeCritiques([])}}Object(h.a)(jf,"EditorPaneActor",null,[]);class kg{constructor(){this.va=new bg.a}K4h(da){this.va.addHandler("PaneClosed",da)}rFk(da){this.va.raiseEvent("PaneClosed",da)}}Object(h.a)(kg,
"EditorPaneEventSource",null,[957,976,977]);var vh=d(4);class nd{}Object(h.a)(nd,"Paragraph",null,[]);var Oe=d(208);class ti{constructor(da,Ea,$a,fb,qc,Hc,kd,Ac,Lc){this.ta=da;this.WB=Ea;this.jTa=$a;this.ia=fb;this.Ea=qc;this.K6j=Hc;this.ffe=kd;this.Vh=Ac;this.s3j=Lc}checkProofingDirty(da){const Ea=da.includedTags;if(2===da.critiqueSelection&&1===Ea)return da=(da=this.ta.Ba)&&da.isConnected?!da.isSlideCritiqueReady:!0,this.Asa(0,!0),da;this.vBg("CheckProofingDirty");return!0}getCritiques(da){var Ea=
da.includedTags;if(2===da.critiqueSelection&&1===Ea){da=this.ta.Ba;if(!da||!da.isConnected||!da.isSlideCritiqueReady)return null;Ea=da.yIa;da=[];for(let $a of Ea)if((Ea=$a)&&Ea.isConnected){Ea=this.WB.RE(Ea,fb=>{fb=Object(I.a)(384,fb.Dh);return!!fb&&5===fb.proofingType&&!fb.sCa});for(const fb of Ea)(Ea=Object(I.a)(384,fb.Dh))&&da.push(Ea.GM)}this.Asa(1,!0);return this.ffe.rQf(da,Object(w.a)(this.ffe,this.ffe.Jti,"convertBox4Critique"))}this.vBg("GetCritiques");return null}Dbg(da){var Ea=this.ta.Ba;
if(!Ea||!Ea.isConnected)return null;const $a=[];da=ti.pek(da);Ea=Ea.dha;for(const fb of da)(da=Object(I.a)(Xd.a,Ea.re(Bi.a.Yf(fb))))&&da.isConnected&&$a.push(Object.assign(new nd,{paragraphId:fb,text:this.Vh.nEe(da,"\n")}));return $a}getSupportedLanguages(da){return this.K6j.j0i(da.includedTags).CWR(Ea=>{const $a=[];if(Ea=Object(I.a)(vh.a,Ea)){Ea=Ea.result;for(let fb of Ea)(Ea=Ua.a.le(fb))&&Array.add($a,Ea.name)}this.Asa(6,!0);return $a})}getLanguagesOnCurrentSlide(){const da=[],Ea=[],$a=this.ta.Ba;
let fb=[];$a&&(fb=$a.om());for(const qc of fb)this.Ea.WI(qc,Hc=>{if(Hc&&Object(Rc.a)(gd.AParagraphNode,Hc)){Hc=Object(I.a)(gd.AParagraphNode,Hc);var kd=Hc.characterData;if(kd&&kd.length){var Ac=-1,Lc;for(kd=0;kd<Hc.Ra.length;kd++)if(Lc=Hc.Ra.ga(kd).formatting)Lc=Hd.a.language(Lc),Ac===Lc||Array.contains(da,Lc)||(Array.add(da,Lc),(Ac=Ua.a.le(Lc))&&Array.add(Ea,Ac.name)),Ac=Lc}}});this.Asa(7,!0);return Ea}visualizeCritiques(da){if(!da)return this.Asa(2,!1),1;const Ea=Array(da.length);if(!da.length)return this.jTa.qPc(Ea),
this.Asa(2,!0),0;for(let $a=0;$a<da.length;$a++)Ea[$a]=da[$a].critiqueId;this.jTa.qPc(Ea);this.Asa(2,!0);return 0}resolveCritiques(da){if(!da||!da.length)return 1;const Ea=new Od.a(0);for(const $a of da)Ea.add($a.critiqueId,$a.suggestionIndex);da=this.jTa.evh(Ea);this.Asa(3,da);return da?0:1}ignoreCritiques(da){if(!da||!da.length)return 1;const Ea=[];for(const $a of da)Array.add(Ea,$a.critiqueId);da=this.jTa.ignoreCritiques(Ea,4);this.Asa(4,da);return da?0:1}openProofingSettingsDialog(){if(this.s3j){const da=
this.ia.processAction(qe.a.L8c,2);this.Asa(5,32===da)}}Asa(da,Ea){Cc.a.J(37266337,375,50,"{0}: {1}",da,Ea?0:1)}vBg(da){Cc.a.J(36750081,375,15,"{0}: Unsupported CritiqueFilter",da)}static pek(da){const Ea=new Oe.a;for(var $a of da)Ea.contains($a.paragraphId)||Ea.add($a.paragraphId);da=Array(Ea.count);$a=0;for(let fb of Ea)da[$a++]=fb;return da}}Object(h.a)(ti,"EditorPaneHost",null,[953]);class Kh{}Object(h.a)(Kh,"EditorRuntimeNotificationData",null,[]);class Rd extends Sys.EventArgs{constructor(){super();
this.dYb=this.Aia=null}}Object(h.a)(Rd,"EditorRuntimeNotificationEventArgs",Sys.EventArgs,[]);class Bj{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=!1;this.confidence=0;this.resultStatus=null}}Object(h.a)(Bj,"InfraredResultBase",null,[]);var ui=d(328),Na=d(517);class qb{constructor(da,Ea){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=da;this.includedTags=Ea}static hH(da){return Object(Rc.a)(Number,da.critiqueSelection)&&Object(Rc.a)(Number,da.includedTags)?
new qb(da.critiqueSelection,da.includedTags):null}}Object(h.a)(qb,"CritiqueFilter",null,[]);class wb{constructor(da,Ea,$a,fb){this.ia=da;this.QK=Ea;this.ta=$a;this.UEg=fb}PBe(da){if(this.UEg){var Ea=new qb(2,1),$a=this.QK.checkProofingDirty(Ea),fb=$a?[]:this.QK.getCritiques(Ea),qc=$a?[]:this.QK.Dbg(fb);Ea=this.Ate();da=Object.assign(new Kh,{isProofingDirty:$a,critiques:fb,paragraphs:qc,numberOfCoAuthors:Ea,contextChanged:0===da});qc=(fb=!!fb&&0<fb.length)?1:0;let Hc=ui.a.success;0<Ea?Hc=ui.a.rGa:
$a?Hc=ui.a.pending:fb||(Hc=ui.a.rGa);$a=Object.assign(new Rd,{Aia:Object.assign(new Bj,{notificationConfidence:qc,shouldRaiseNotification:!1,confidence:1,resultStatus:Hc}),dYb:da});this.UEg.PBe($a)}}Ate(){var da=this.ta.Ba;if(!da||!da.isConnected)return 0;da=Object.assign(new Na.a,{slideId:da.Bb});this.ia.Ka(Kc.a.MWa,2,da);return da.Mkc}}Object(h.a)(wb,"EditorRuntimeEventRaiser",null,[952]);var jc=d(532),Qc=d(682);class Cd{constructor(da){this.T1j=da}T_k(){this.IXa(0,0)}sessionEnd(){this.IXa(1,0)}gil(){this.IXa(2,
4)}hil(){this.IXa(2,3)}IXa(da,Ea){this.T1j.execute($a=>{const fb=Object.assign(new Qc.a,{cardId:jc.a.GYf,actionType:da,actionEngagement:Ea});$a.b6c(fb)})}}Object(h.a)(Cd,"InfraredTelemetryLogger",null,[955]);class Ld extends bh{constructor(da,Ea,$a){super(da,Ea);this.payload=null;this.payload=$a}}Object(h.a)(Ld,"MessageWithPayload",bh,[]);class ie extends Ld{constructor(da,Ea,$a){super(da,Ea,$a)}}Object(h.a)(ie,"CheckProofingDirtyAndGetCritiquesResponse",Ld,[]);class Qe extends Ld{constructor(da,
Ea,$a){super(da,Ea,$a)}}Object(h.a)(Qe,"ResponseMessage",Ld,[]);class df{constructor(da){this.statusCode=0;this.logErrorMessage=null;this.statusCode=da;this.logErrorMessage="";0!==da&&(this.logErrorMessage=da.toString())}}Object(h.a)(df,"Response",null,[]);class tf extends df{constructor(da,Ea,$a,fb){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=da;this.critiques=Ea;this.paragraphs=$a;this.languagesOnTheCurrentSlide=fb}}Object(h.a)(tf,
"ProofingDirtyAndCritiques",df,[]);class jh{constructor(da,Ea,$a){this.ta=da;this.QK=Ea;this.WZ=$a}process(da,Ea){var $a=this.WZ.TCi(da.message);if(!$a)return Cc.a.J(37025993,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),da=new df(1),Wg.Task.wt(new Qe(1003,Ea.id,da));da=this.ta.Ba;if(!da||!da.isConnected)return Cc.a.J(37025995,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),da=new tf(!1,[],[],[]),Ea=new ie(1003,Ea.id,
da),Wg.Task.wt(Ea);$a=(da=this.QK.checkProofingDirty($a.payload))?[]:this.QK.getCritiques($a.payload);if(!$a)return Cc.a.J(38418246,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),da=new df(2),Wg.Task.wt(new Qe(1003,Ea.id,da));const fb=da?[]:this.QK.Dbg($a),qc=da?[]:this.QK.getLanguagesOnCurrentSlide();if(!qc)return Cc.a.J(38418248,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),da=new df(7),Wg.Task.wt(new Qe(1003,
Ea.id,da));da=new tf(da,$a,fb,qc);Ea=new ie(1003,Ea.id,da);return Wg.Task.wt(Ea)}}Object(h.a)(jh,"CheckProofingDirtyAndGetCritiquesProcessor",null,[973]);class Dh{constructor(da,Ea,$a){this.QK=da;this.WZ=Ea;this.Pxb=$a}process(da,Ea){var $a=this.WZ.VCi(da.message);if(!$a)return Cc.a.J(37087328,375,15,"[IgnoreProcessor] Can't decode message."),da=new df(1),Wg.Task.wt(new Qe(1006,Ea.id,da));$a=this.QK.ignoreCritiques($a.payload);0===$a&&da.L8d&&this.Pxb.hil();da=0===$a?new df(0):new df(6);return Wg.Task.wt(new Qe(1006,
Ea.id,da))}}Object(h.a)(Dh,"IgnoreProcessor",null,[973]);class ch extends Ld{constructor(da,Ea,$a){super(da,Ea,$a)}}Object(h.a)(ch,"NumberOfCoAuthorsResponse",Ld,[]);class Hg extends df{constructor(da){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=da}}Object(h.a)(Hg,"NumberOfCoAuthorsModel",df,[]);class wh{constructor(da,Ea){this.ia=da;this.ta=Ea}process(da,Ea){da=this.Ate();da=new Hg(da);return Wg.Task.wt(new ch(1009,Ea.id,da))}Ate(){var da=this.ta.Ba;if(!da||!da.isConnected)return 0;
da=Object.assign(new Na.a,{slideId:da.Bb});this.ia.Ka(Kc.a.MWa,2,da);return da.Mkc}}Object(h.a)(wh,"NumberOfCoAuthorsProcessor",null,[973]);class Yh{constructor(da,Ea,$a){this.ia=da;this.VZ=Ea;this.rje=$a}process(da,Ea){if(!this.rje)return Cc.a.J(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),da=new df(10),Wg.Task.wt(new Qe(1011,Ea.id,da));this.VZ.bK(3);da=this.ia.processAction(Kc.a.BLe,2);32!==da&&Cc.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");
da=new df(32!==da?9:0);return Wg.Task.wt(new Qe(1011,Ea.id,da))}}Object(h.a)(Yh,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[973]);class Ni{constructor(da){this.QK=da}process(da,Ea){this.QK.openProofingSettingsDialog();da=new df(0);return Wg.Task.wt(new Qe(1007,Ea.id,da))}}Object(h.a)(Ni,"OpenProofingSettingsProcessor",null,[973]);class vi{constructor(da,Ea,$a){this.QK=da;this.WZ=Ea;this.Pxb=$a}process(da,Ea){var $a=this.WZ.WCi(da.message);if(!$a)return Cc.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),
da=new df(1),Wg.Task.wt(new Qe(1005,Ea.id,da));$a=this.QK.resolveCritiques($a.payload);0===$a&&da.L8d&&this.Pxb.gil();da=0===$a?new df(0):new df(5);return Wg.Task.wt(new Qe(1005,Ea.id,da))}}Object(h.a)(vi,"ResolveProcessor",null,[973]);class Eh extends Ld{constructor(da,Ea,$a){super(da,Ea,$a)}}Object(h.a)(Eh,"SubscriptionResponse",Ld,[]);class xh extends df{constructor(da){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=da}}Object(h.a)(xh,"SubscriptionModel",df,[]);class fj{constructor(da,
Ea){this.mxb=da;this.WZ=Ea}process(da,Ea){const $a=this.WZ.XCi(da.message);if(!$a)return Cc.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),da=new df(1),Wg.Task.wt(new Qe(1001,Ea.id,da));Cc.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",$a.payload.telemetryCorrelationId);this.mxb.subscribe(da.instanceId,0);this.mxb.subscribe(da.instanceId,1);this.mxb.subscribe(da.instanceId,2);da=new xh("not available");return Wg.Task.wt(new Eh(1001,Ea.id,da))}}Object(h.a)(fj,"SubscribeProcessor",
null,[973]);class Wi extends Ld{constructor(da,Ea,$a){super(da,Ea,$a)}}Object(h.a)(Wi,"SupportedLanguagesResponse",Ld,[]);class yh extends df{constructor(da){super(0);this.supportedLanguages=null;this.supportedLanguages=da}}Object(h.a)(yh,"SupportedLanguagesModel",df,[]);class Rj{constructor(da,Ea){this.QK=da;this.WZ=Ea}process(da,Ea){da=this.WZ.YCi(da.message);if(!da)return Cc.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),da=new df(1),Wg.Task.wt(new Qe(1010,Ea.id,da));
const $a=this.QK.getSupportedLanguages(da.payload);return $a.CWR(()=>{var fb=$a.result;if(!fb)return Cc.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),fb=new df(8),new Qe(1010,Ea.id,fb);fb=new yh(fb);return new Wi(1010,Ea.id,fb)})}}Object(h.a)(Rj,"SupportedLanguagesProcessor",null,[973]);class Ci{process(da,Ea){Cc.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",Ea.type);da=new df(3);return Wg.Task.wt(new Qe(Ea.type,Ea.id,
da))}}Object(h.a)(Ci,"UnsupportedMessageProcessor",null,[973]);class bk{constructor(da,Ea){this.QK=da;this.WZ=Ea}process(da,Ea){da=this.WZ.ZCi(da.message);if(!da)return Cc.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),da=new df(1),Wg.Task.wt(new Qe(1004,Ea.id,da));da=0===this.QK.visualizeCritiques(da.payload)?new df(0):new df(4);return Wg.Task.wt(new Qe(1004,Ea.id,da))}}Object(h.a)(bk,"VisualizeProcessor",null,[973]);class zg extends Ld{constructor(da,Ea,$a){super(da,Ea,$a)}static hH(da){const Ea=
bh.thb(da);return Ea&&da.payload?(da=qb.hH(da.payload))?new zg(Ea.type,Ea.id,da):null:null}}Object(h.a)(zg,"CheckProofingDirtyAndGetCritiquesMessage",Ld,[]);class xf{constructor(da){this.rLb=da}get critiqueId(){return this.rLb}static hH(da){return da.critiqueId&&Object(I.a)(String,da.critiqueId)?new xf(da.critiqueId.toString()):null}}Object(h.a)(xf,"CritiqueIgnore",null,[]);class Qh extends Ld{constructor(da,Ea,$a){super(da,Ea,$a)}static hH(da){const Ea=bh.thb(da);if(!Ea||!da.payload||!Object(Rc.a)(Array,
da.payload))return null;da=da.payload;const $a=Array(da.length);for(let fb=0;fb<da.length;fb++){const qc=xf.hH(da[fb]);if(!$a)return null;$a[fb]=qc}return new Qh(Ea.type,Ea.id,$a)}}Object(h.a)(Qh,"IgnoreCritiquesMessage",Ld,[]);class Lh{constructor(da,Ea){this.rLb=da;this.RVh=Ea}get critiqueId(){return this.rLb}get suggestionIndex(){return this.RVh}static hH(da){return da.critiqueId&&Object(I.a)(String,da.critiqueId)&&Object(Rc.a)(Number,da.suggestionIndex)?new Lh(da.critiqueId.toString(),da.suggestionIndex):
null}}Object(h.a)(Lh,"CritiqueResolution",null,[]);class oj extends Ld{constructor(da,Ea,$a){super(da,Ea,$a)}static hH(da){const Ea=bh.thb(da);if(!Ea||!da.payload||!Object(Rc.a)(Array,da.payload))return null;da=da.payload;const $a=Array(da.length);for(let fb=0;fb<da.length;fb++){const qc=Lh.hH(da[fb]);if(!$a)return null;$a[fb]=qc}return new oj(Ea.type,Ea.id,$a)}}Object(h.a)(oj,"ResolveCritiquesMessage",Ld,[]);class gj{constructor(da){this.telemetryCorrelationId=null;this.telemetryCorrelationId=da}static hH(da){let Ea=
"unavailable";da.telemetryCorrelationId&&Object(I.a)(String,da.telemetryCorrelationId)&&da.telemetryCorrelationId.toString().length&&50>=da.telemetryCorrelationId.toString().length&&(Ea=da.telemetryCorrelationId.toString());return new gj(Ea)}}Object(h.a)(gj,"Subscription",null,[]);class Di extends Ld{constructor(da,Ea,$a){super(da,Ea,$a)}static hH(da){const Ea=bh.thb(da);if(!Ea)return null;da.payload||(da.payload={});return(da=gj.hH(da.payload))?new Di(Ea.type,Ea.id,da):null}}Object(h.a)(Di,"SubscribeMessage",
Ld,[]);class dh extends Ld{constructor(da,Ea,$a){super(da,Ea,$a)}static hH(da){const Ea=bh.thb(da);return Ea&&da.payload?(da=qb.hH(da.payload))?new dh(Ea.type,Ea.id,da):null:null}}Object(h.a)(dh,"SupportedLanguagesMessage",Ld,[]);class Ig{constructor(da){this.rLb=da}get critiqueId(){return this.rLb}static hH(da){return da.critiqueId&&Object(I.a)(String,da.critiqueId)&&da.critiqueId.toString().length?new Ig(da.critiqueId.toString()):null}}Object(h.a)(Ig,"CritiqueToVisualize",null,[]);class ua extends Ld{constructor(da,
Ea,$a){super(da,Ea,$a)}static hH(da){const Ea=bh.thb(da);if(!Ea||!da.payload||!Object(Rc.a)(Array,da.payload))return null;da=da.payload;const $a=Array(da.length);for(let fb=0;fb<da.length;fb++){const qc=Ig.hH(da[fb]);if(!$a)return null;$a[fb]=qc}return new ua(Ea.type,Ea.id,$a)}}Object(h.a)(ua,"VisualizeCritiquesMessage",Ld,[]);class Pa{HEi(da){return this.shb(da,bh.thb)}XCi(da){return this.shb(da,Di.hH)}TCi(da){return this.shb(da,zg.hH)}ZCi(da){return this.shb(da,ua.hH)}WCi(da){return this.shb(da,
oj.hH)}VCi(da){return this.shb(da,Qh.hH)}YCi(da){return this.shb(da,dh.hH)}shb(da,Ea){try{let $a;return({Hv:$a}=u.d(da)).returnValue?Ea($a):null}catch($a){return null}}sZf(da){return u.c(da)}}Object(h.a)(Pa,"MessageEncoder",null,[961]);var eb=d(80);class Kb extends Sys.EventArgs{constructor(da,Ea,$a){super();this.instanceId=da;this.message=Ea;this.L8d=$a;this.Y$g=new Date}}Object(h.a)(Kb,"MessageReceivedEventArgs",Sys.EventArgs,[]);class bc{constructor(da,Ea,$a){this.va=new bg.a;this.ezb=da;this.oCg=
Ea;this.I1j=new RegExp($a,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(w.a)(this,this.Tbc,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(w.a)(this,this.Tbc,"messageReceivedHandler")),!0;Cc.a.J(37026003,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(da){Cc.a.J(37026005,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
da.message,da.stack)}return!1}jGd(da){this.va.addHandler("MessageReceived",da)}Jch(da){this.va.removeHandler("MessageReceived",da)}sendMessage(da,Ea){if(da&&Ea){var $a={};$a.message=Ea;$a.editorPaneWildCard=".";this.NZk(da,$a)}}NZk(da,Ea){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(da,"onCustomMessage",Ea,$a=>{$a&&Cc.a.J(37026007,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",$a)})}Tbc(da){const Ea=da.origin;if(this.d4b(Ea)){var $a;({Hv:$a}=u.d(da.data)).returnValue&&
$a&&"."===$a.editorPaneWildCard&&$a.message&&this.va.raiseEvent("MessageReceived",new Kb(this.ezb.ZLc(),$a.message,Ea===this.oCg))}}d4b(da){const Ea=eb.a.lS(window.location.href);return!!da&&0<da.length&&"null"!==da&&(da===this.oCg||da===Ea||this.I1j.test(da))}}Object(h.a)(bc,"Messenger",null,[960]);class oc{constructor(da,Ea){this.Xd=da;this.assetId=Ea.x5g}ZLc(){if(!this.Xd.instance)return Cc.a.J(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const da=this.Xd.instance.fZ(this.assetId);
return da?da.instanceId?da.instanceId:(Cc.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):(Cc.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(h.a)(oc,"PaneIdsProvider",null,[958]);class W{constructor(){this.Zr=new Od.a}subscribe(da,Ea){da&&(this.Zr.Jb(Ea)||this.Zr.add(Ea,[]),Array.contains(this.Zr.ga(Ea),da)||this.Zr.ga(Ea).push(da))}unsubscribe(da,Ea){da&&this.Zr.Jb(Ea)&&(da=Array.indexOf(this.Zr.ga(Ea),
da),-1!==da&&Array.removeAt(this.Zr.ga(Ea),da))}zsl(da){da&&(this.unsubscribe(da,0),this.unsubscribe(da,1),this.unsubscribe(da,2))}dej(da){return this.Zr.Jb(da)?this.Zr.ga(da):[]}}Object(h.a)(W,"EditorPaneSubscriptionsManager",null,[959]);class ta{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPane"}Wb(da){da&&(this.K=da,this.K.register(Md,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").ma().na(()=>new Md(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorConsistencyCheckIsEnabled)),this.K.register(951,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").ma().na(()=>new zf(this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFocusDocumentAfterActionOnEditorPaneIsEnabled)),this.K.register(jf,"PowerPointWebEditor.EditorPane.EditorPaneActor").ma().na(()=>new jf(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.tyi(),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))),ta.EEj&&this.K.register(Gg,"PowerPointWebEditor.EditorPane.DexLitePaneActor").ma().na(()=>new Gg(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IDexLitePane"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IDynamicScriptLoaderProvider").yv,this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(952,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").ma().na(()=>new wb(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),this.K.register(Me,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").ma().na(()=>new Me),this.K.register(953,"PowerPointWebEditor.EditorPane.IEditorPaneHost").ma().na(()=>new ti(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Common.IAppSettingsManager").ka("299"))),this.K.register(954,"PowerPointWebEditor.EditorPane.IDataContractMapper").ma().na(()=>
new Xh),this.K.register(955,"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").ma().na(()=>new Cd(this.K.La("PowerPointWebEditor.IInfraredTelemetryListener"))),this.K.register(956,"PowerPointWebEditor.EditorPane.IEditorPane").ma().na(()=>new ci(this.K.resolve("Common.IActionManagerExtended"),this.K.La("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled,!0)),this.K.register(957,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").ma().na(()=>new kg),this.K.register(958,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").ma().na(()=>new oc(this.K.La("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(959,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").ma().na(()=>
new W),this.K.register(960,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").ma().na(()=>new bc(this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Yxk,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasApprovedOriginPattern)),this.K.register(961,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").ma().na(()=>new Pa),this.K.register(Ci,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").ma().na(()=>
new Ci),this.K.register(fj,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").ma().na(()=>new fj(this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(vi,"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").ma().na(()=>new vi(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Dh,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").ma().na(()=>new Dh(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Ni,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").ma().na(()=>
new Ni(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.K.register(jh,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").ma().na(()=>new jh(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(bk,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").ma().na(()=>
new bk(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(wh,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").ma().na(()=>new wh(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(Rj,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").ma().na(()=>new Rj(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Yh,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").ma().na(()=>new Yh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled)))}init(){this.K&&this.K.resolve("Common.IAppSettingsManager").ff(()=>{var da=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
ta.A9k(da)&&this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(da=this.K.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),da.ub(),da.we(),da=this.K.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),da.ub(),da.we())})}dispose(){}tyi(){const da=new Od.a;da.$(0,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));da.$(1,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));
da.$(3,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));da.$(4,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));da.$(5,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));da.$(6,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));da.$(7,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));da.$(9,
this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));da.$(10,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));da.$(11,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return da}static main(){v.a.instance.Ac(new ta)}static A9k(da){return da.pptEditorConsistencyCheckIsEnabled&&ta.iCj(da.x5g)}static EEj(da){return da.aWf}static iCj(da){return!!da&&0<da.length}}
Object(h.a)(ta,"PptWebEditorEditorPanePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");
Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.TextPrediction");Bb.main();rb.main();Sc.main();ta.main()},666:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(17),e=d(95),m=d(27),n=d(48);d(96);class v{constructor(){this.qZ=null}get ntb(){return!1}pxh(A,w){let y=new h.a;const u=new n.GraphTransaction(3);try{u.fd(m.App.Fb.Ed.en.rg),this.h5b(w)&&(y=this.T2b(w,y)),w!==A&&this.h5b(A)&&(y=this.T2b(A,y))}finally{u&&u.dispose()}return y.toArray()}h5b(A){return!!A}lcd(A){let w=
!1;for(const y of this.j4d)w||!Sys.UI.DomElement.containsCssClass(A,y.className)&&!Sys.UI.DomElement.containsCssClass(A,y.f1b)||(w=!0),e.a.vHa(A,y.className),e.a.vHa(A,y.f1b)}}Object(J.a)(v,"AHighlightActor",null,[504])},667:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.className=e;this.f1b=m}}Object(J.a)(h,"HighlightCssClassPair",null,[])},668:function(J,V,d){d.d(V,"b",function(){return n});d.d(V,"a",function(){return v});var h=d(95);d(27);var e=d(48);d(31);
d(90);var m=d(96);const n=A=>{const w=new e.GraphTransaction(3);try{w.fd(A),A.Vu(32,!0)}finally{w&&w.dispose()}},v=A=>{if(A){A=h.a.Yha(A);if(-1===A.indexOf(m.a.L6)&&-1!==A.indexOf(m.a.yM)&&-1===A.indexOf(m.a.NWb))return 2;if(-1===A.indexOf(m.a.L6)&&(-1!==A.indexOf(m.a.MWb)||-1!==A.indexOf(m.a.OM)||-1!==A.indexOf(m.a.NWb)||-1!==A.indexOf(m.a.JDc)||-1!==A.indexOf(m.a.tFc)||-1!==A.indexOf(m.a.rFc)||-1!==A.indexOf(m.a.qFc)||-1!==A.indexOf(m.a.OPd)||-1!==A.indexOf(m.a.JPd)||-1!==A.indexOf(m.a.LPd)||-1!==
A.indexOf(m.a.sFc)||-1!==A.indexOf(m.a.IPd)))return 1;if(-1!==A.indexOf("WACImageContainer"))return 3}return 0}},669:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.type=this.action=0;this.Fdb=this.Nba=null}}Object(J.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.augloop.js.map