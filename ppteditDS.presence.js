'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[12],{1203:function(J,V,d){d.r(V);J=d(0);var h=d(13);class e{constructor(rb,Ua){this.Iya=null;this.JPb=rb;this.cSh=Ua}init(){this.JPb.continueWith(()=>{this.Iya=this.JPb.result;this.Iya.Umb(Object(h.a)(this,this.hX,"onUsersUpdated"))})}hX(){e.jGf(this.Iya.S5a())&&(this.Iya.Hcd(Object(h.a)(this,this.hX,"onUsersUpdated")),this.cSh.IsRealCoauthSession=!0)}static jGf(rb){let Ua=null;for(const pb of rb)if(pb)if(rb=pb.isAnonymous||
!pb.email?pb.clientId:pb.email.toUpperCase(),!Ua)Ua=rb;else if(Ua!==rb)return!0;return!1}}Object(J.a)(e,"CoauthTelemetry",null,[523]);var m=d(375),n=d(1021),v=d(1158),A=d(25),w;(function(rb){rb[rb.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";rb[rb.notImplemented=1]="notImplemented";rb[rb.renderHandled=2]="renderHandled";rb[rb.renderHandledWithVeto=3]="renderHandledWithVeto"})(w||(w={}));Object(J.b)("CoauthorGalleryTelemetryEndResult",w);var y=d(94),u=d(101),E=d(2);class G{constructor(rb,
Ua,pb,Ub,Bc,Gc,qd,Td,Vd){this.Dgf=this.gYe=this.KJ=null;this.una=rb;this.cxc=new n.a;this.jb=pb;this.Lpd=Ua;this.ifa=Ub;this.ki=Bc;this.ezd=Gc;this.QLa=qd;this.oHh=Td;this.d4e=this.a4e=!1;this.Mxc=0;this.dYe=1;this.c_a=Vd;this.WRb=this.jb.ka("PeoplesWellExtraButtonInfoIsEnabled");this.rib=Object(v.a)(String,A.AFrameworkApplication.Yc.Application)||""}get Qsh(){return this.cxc.task}init(){E.Task.WAA.call(null,this.QLa,this.Lpd,this.ezd).continueWith(()=>{this.KJ=this.QLa.result;this.gYe=this.Lpd.result;
this.Dgf=this.ezd.result;E.Task.WAA.call(null,this.Lpd.result.eAa,this.ezd.result.Ljd).continueWith(()=>{this.dYe=this.gYe.eAa.result;this.Mxc=this.Dgf.Ljd.result;this.KJ.Umb(Object(h.a)(this,this.I8c,"onUsersUpdatedEventListener"));this.KJ.S5a().length&&this.hX()})})}I8c(){this.hX()}hX(){this.oHh(this.KJ.S5a())?(this.KJ.Hcd(Object(h.a)(this,this.I8c,"onUsersUpdatedEventListener")),this.Njk(this.a4e)):this.cxc.TL(1);this.a4e=!0}Njk(rb){this.d4e?this.Qsh.continueWith(()=>{m.ULS.sendTraceTag(42062996,
325,15,"We already attempted to log a render of coauthor gallery: {0}",w[this.Qsh.result])}):(this.d4e=!0,this.xBk(0===this.dYe&&!rb))}xBk(rb){rb?this.ifa.Xj(4,Object(h.a)(this,this.uve,"onInteractiveReady")):this.cxc.TL(1)}uve(){const rb=this.ki.Rg("AppInitStatus_interactivityReady");m.ULS.shipAssertTag(42259235,325,!!this.Mxc);const Ua=this.Mxc-rb,pb={};pb.InteractiveTime=rb;pb.ReactRenderComplete=this.Mxc;pb.HadTabSwitch=this.c_a();pb.IsModernGallery=this.WRb;m.ULS.sendTraceTag(594883104,325,50,
u.a.toJSON(pb));this.WRb?(m.ULS.sendTraceTag(42062997,325,15,Ua.toString()),this.cxc.TL(this.jzl(Ua)?3:2)):m.ULS.sendTraceTag(594883103,325,15,Ua.toString())}jzl(rb){const Ua=rb>this.jb.Ec("CoauthorGalleryTimeToRenderDurationMs",1E4),pb="Word"===this.rib;if(this.c_a())return m.ULS.sendTraceTag(50455714,325,50,Ua.toString()),!1;pb&&y.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Ua&&(pb&&y.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded",
"CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),m.ULS.sendTraceTag(42062998,325,15,rb.toString()));return Ua}}Object(J.a)(G,"CoauthorGalleryTelemetry",null,[524]);class I{constructor(rb){this.KJ=null;this.Bpc={};this.ivc={};this.sNb=null;this.QLa=rb}MMc(rb){const Ua=new n.a;this.init().continueWith(()=>{rb in this.Bpc?Ua.TL(this.Bpc[rb]):this.ivc[rb]=Ua});return Ua.task}init(){if(this.sNb)return this.sNb.task;this.sNb=new n.a;this.QLa.continueWith(()=>{this.KJ=this.QLa.result;this.KJ.Umb(Object(h.a)(this,
this.hX,"onUsersUpdated"));this.MBh();this.sNb.Bg(null)});return this.sNb.task}MBh(){const rb=this.KJ.S5a();rb.sort(Object(h.a)(this,this.Dpi,"comparePresenceUsers"));this.Bpc={};for(let Ua=0;Ua<rb.length&&rb[Ua]&&rb[Ua].yDa;Ua++)this.H0h(this.Bpc,rb[Ua].clientId,Ua)}H0h(rb,Ua,pb){rb[Ua]=pb;Ua in this.ivc&&(this.ivc[Ua].TL(pb),delete this.ivc[Ua])}hX(){this.MBh()}Dpi(rb,Ua){return rb.yDa>Ua.yDa?1:rb.yDa<Ua.yDa?-1:0}}Object(J.a)(I,"CoauthorPositionFinder",null,[522]);var H=d(17),K=d(196);class C{constructor(rb,
Ua,pb,Ub){this.Iya=null;this.jrd=this.uxd=!1;this.fcf=0;this.JPb=rb;this.NCd=Ua;this.jb=pb;this.vxd=Ub;this.WGh=A.AFrameworkApplication.Jhb||A.AFrameworkApplication.ZP}get DFc(){return this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.JPb.continueWith(()=>{this.Iya=this.JPb.result;this.Iya.Umb(Object(h.a)(this,this.hX,"onUsersUpdated"))})}hX(){this.Goi(this.Iya.S5a());!this.uxd||this.DFc&&!this.jrd||this.Iya.Hcd(Object(h.a)(this,this.hX,"onUsersUpdated"))}Goi(rb){const Ua=
new H.a;let pb=0;for(const Ub of rb)if(Ub&&Ub.isAnonymous){A.AFrameworkApplication.o9a("70eb6120;2gfeb930");if(this.DFc&&!this.jrd)if(Ua.contains(Ub.userName)){const Bc=this.Yfj(rb);m.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected among {0} total guest coauthors",Bc);this.jrd=!0}else Ua.add(Ub.userName);Ub.clientId!==this.vxd&&(pb++,2<=pb&&!this.uxd&&this.QWj())}this.DFc&&this.fcf!==pb&&(m.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",pb+(this.WGh?1:0)),
this.fcf=pb)}QWj(){m.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.uxd=!0;this.DFc&&this.NCd&&this.NCd.continueWith(()=>{window.setTimeout(()=>{this.NCd.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}Yfj(rb){return K.a.Va(rb)?0:K.a.pna(rb,Ua=>Ua.isAnonymous).length}}Object(J.a)(C,"GuestCoauthTelemetry",null,[]);var Y=d(1157);class M{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(J.a)(M,"PL",
null,[]);var P=d(33);class T{constructor(){this.ct=this.vt=this.d=0}static Gjh(rb,Ua,pb){const Ub=new T;Ub.d=rb;Ub.vt=Ua;Ub.ct=pb;return P.c(Ub)}}Object(J.a)(T,"VD",null,[]);var L=d(87);class aa{constructor(rb,Ua,pb,Ub,Bc,Gc,qd,Td,Vd){this.Ttf=!1;this._id=rb;this.Bj=Ua;this.Zs=pb;this.wxd=Ub;this.pDd=Bc;this.u2a=Gc;this.v_a=qd;this.DIh=Td;this.c_a=Vd;this.rib=Object(v.a)(String,A.AFrameworkApplication.Yc.Application)||""}umd(rb){E.Task.WAA(this.wxd,this.pDd).continueWith(()=>{if(this.wxd.result<=
this.pDd.result)rb.TL(!1);else{var Ua=this.Zs-this.Bj,pb=new M;pb.id=this._id;pb.et=this.Zs;pb.st=this.Bj;pb.d=this.Zs-this.Bj;pb.mp=this.wxd.result;pb.tp=this.pDd.result;pb.ct=this.yZi(this.DIh);pb.vc=this.c_a();var Ub=P.c(pb),Bc="Word"===this.rib;m.ULS.sendTraceTag(42078597,302,15,Ub);if(Bc){const Gc=new Map;Gc.set("data",Ub);y.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",Gc)}Ua>this.u2a.value&&!this.Ttf&&!pb.vc&&(this.Ttf=!0,rb.TL(!0),pb=Object.assign(new L.a,{inStaging:!0,
extendedProperties:new Map}),pb.extendedProperties.set("data",Ub),Bc&&y.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,pb),Ua<this.v_a.value&&m.ULS.sendTraceTag(42078598,302,15,T.Gjh(Ua,this.u2a.value,this.v_a.value)));rb.task.isCompleted||rb.TL(!1)}})}yZi(rb){switch(rb){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(J.a)(aa,"PresenceLatencyActivityLogger",null,[]);class Q{constructor(rb,Ua,pb){this.nXe=
this.cYe=this.ppc=this.Apc=this.nib=0;this._id=rb;this.u2a=Ua;this.v_a=pb;this.rib=Object(v.a)(String,A.AFrameworkApplication.Yc.Application)||""}get ODf(){return this.nib}set ODf(rb){this.nib=rb;this.GLd()}get mOf(){return this.Apc}set mOf(rb){this.Apc=rb;this.GLd()}get ELf(){return this.ppc}set ELf(rb){this.ppc=rb;this.GLd()}get nOf(){return 0!==this.cYe}get FLf(){return 0!==this.nXe}GLd(){!this.nOf&&this.nib&&this.Apc&&(this.cYe=this.umd(this.Apc,"CoauthGalleryLightupDurationTooLong"));!this.FLf&&
this.nib&&this.ppc&&(this.nXe=this.umd(this.ppc,"CanvasPresenceLightupDurationTooLong"))}umd(rb,Ua){const pb=rb-this.nib;var Ub=new M;Ub.id=this._id;Ub.et=rb;Ub.st=this.nib;Ub.d=pb;var Bc=P.c(Ub);rb="Word"===this.rib;Ub="CanvasPresenceLightupDurationTooLong"===Ua?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Ua?m.ULS.sendTraceTag(572289499,302,15,Bc):m.ULS.sendTraceTag(571524118,302,15,Bc);if(rb){var Gc=new Map;Gc.set("data",Bc);y.Health.instance.recordKpiUsage(Ub,
0,"wordcollabrel",Gc)}return pb>this.u2a.value?(Gc=Object.assign(new L.a,{inStaging:!0,extendedProperties:new Map}),Gc.extendedProperties.set("data",Bc),Bc=pb<this.v_a.value,Gc.extendedProperties.set("cash",Bc?"true":"false"),rb&&y.Health.instance.recordKpiFailure(Ub,Ua,!1,!0,Gc),m.ULS.sendTraceTag(572289500,302,15,T.Gjh(pb,this.u2a.value,this.v_a.value)),Bc?2:1):3}}Object(J.a)(Q,"PresenceLightupLatencyLogger",null,[]);var ea=d(282),ia=d(278);class ja{constructor(rb,Ua,pb,Ub,Bc,Gc,qd=null,Td=null,
Vd=null){this.hqf={};this.Kpd={};this.hbf=new H.a;this.tNb=this.KJ=this.qwc=null;this.vvf=this.tvf=0;this.u2a=new Y.a(()=>qd.wP("PresenceBootLatencyThreshold",1E4));this.v_a=new Y.a(()=>qd.wP("PresenceBootLatencyCutoffThreshold",6E4));this.VXh=new Y.a(()=>qd.wP("PresenceLightupLatencyThreshold",2E3));this.JJh=new Y.a(()=>qd.wP("PresenceLightupLatencyCutoffThreshold",1E4));this.eSh=Ub;this.eYe=rb;this.Fsf=Ua;this.QLa=pb;this.ki=Bc;this.vxd=Td;this.c_a=Gc;this.wf=Vd;this.FWe=!1;this.init()}FKi(rb,Ua=
0){var pb=new Date;const Ub=new n.a;this.init().continueWith(()=>{this.Kmk(rb);this.GKi(Ub,rb,pb,Ua)})}get eUg(){return this.vxd||"{"+A.AFrameworkApplication.userSessionId+"}"}init(){if(this.tNb)return this.tNb.task;this.tNb=new n.a;this.c_a()&&m.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.eYe.continueWith(()=>{const rb=this.eYe.result,Ua=rb.eAa,pb=rb.n5c;pb.continueWith(()=>{Ua.continueWith(()=>{this.wf&&this.wf.addQosPillar("RealTimeCoauth");this.Ugl(Ua.result,pb.result);this.tNb.Bg(null)})})});
this.Fsf.continueWith(()=>{this.qwc=this.Fsf.result;this.qwc.M2a(Object(h.a)(this,this.znk,"onRtcConnection"));this.qwc.Eza(Object(h.a)(this,this.qik,"onCoauthorBootReceived"))});this.QLa.continueWith(()=>{this.KJ=this.QLa.result;this.KJ.Umb(Object(h.a)(this,this.I8c,"onUsersUpdatedEventListener"));0<this.KJ.S5a().length&&this.hX()});return this.tNb.task}w7f(){return this.ki.Wn(ea.a.Ihb)?this.ki.Rg(ea.a.Ihb):ia.a.Rza?window.performance.timing.fetchStart:-1}znk(rb,Ua){this.FWe||2!==Ua.newState||(rb=
this.w7f(),rb=Date.now()-rb,Ua={},Ua.clientId=this.eUg,Ua.bootTime=rb,this.FWe=!0,this.qwc.rea(15,Ua))}qik(rb,Ua){if(15===Ua.type){rb=Date.now();Ua=Ua.nxa;var pb=Ua.bootTime;this.zZd(Ua.clientId).ODf=rb-pb}}I8c(){this.hX()}hX(){const rb=Date.now();var Ua=this.KJ.S5a();const pb=new H.a;for(const Ub of Ua)this.hbf.contains(Ub.clientId)||(this.hbf.add(Ub.clientId),pb.add(Ub.clientId));if(0<pb.count)for(let Ub of pb)Ua=this.zZd(Ub),Ua.nOf||(Ua.mOf=rb)}Kmk(rb){rb=this.zZd(rb);rb.FLf||(rb.ELf=Date.now())}zZd(rb){return rb in
this.Kpd?this.Kpd[rb]:this.Kpd[rb]=new Q(rb,this.VXh,this.JJh)}Ugl(rb,Ua=0){this.tvf=rb;this.vvf=Ua?Ua:(new Date).getTime()}GKi(rb,Ua,pb,Ub){pb=pb?pb.getTime():(new Date).getTime();Ua in this.hqf?rb.t0():(Ub=new aa(Ua,this.Cdj(),pb,this.MMc(this.eUg),this.MMc(Ua),this.u2a,this.v_a,Ub,this.c_a),this.hqf[Ua]=Ub,Ub.umd(rb))}Cdj(){return 1===this.tvf?this.vvf:this.w7f()}MMc(rb){return this.eSh.MMc(rb)}}Object(J.a)(ja,"PresenceBootTelemetry",null,[520]);var D=d(176),pa=d(68),Z=d(336),oa=d(55),Ba=d(285);
class Ma{get name(){return"Common.App.CoauthTelemetry"}Wb(rb){rb.register(e,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").ma().na(()=>new e(Ba.a.vu(rb.La("Common.IPeopleInfoProvider")),A.AFrameworkApplication.Pg));rb.register(G,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").ma().na(()=>new G(A.AFrameworkApplication.Ta,Ba.a.vu(rb.La("Common.ICoauthoringTelemeryInfoProvider")),A.AFrameworkApplication.fa,
D.a.get_instance(),Z.a.instance,Ba.a.vu(rb.La("Common.IPeoplesWell")),Ba.a.vu(rb.La("Common.IPeopleInfoProvider")),e.jGf,()=>this.pIf()));rb.register(ja,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").ma().na(()=>new ja(Ba.a.vu(rb.La("Common.ICoauthoringTelemeryInfoProvider")),Ba.a.vu(rb.La("Common.IRealtimeChannelBasic")),Ba.a.vu(rb.La("Common.IPeopleInfoProvider")),rb.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),Z.a.instance,
()=>this.pIf(),A.AFrameworkApplication.fa,null,y.Health.instance));rb.register(I,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").ma().na(()=>new I(Ba.a.vu(rb.La("Common.IPeopleInfoProvider"))));rb.register(C,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").ma().na(()=>new C(Ba.a.vu(rb.La("Common.IPeopleInfoProvider")),Ba.a.vu(rb.La("Common.ISystemInitiatedFeedback")),A.AFrameworkApplication.fa,"{"+A.AFrameworkApplication.userSessionId+
"}"))}init(){A.AFrameworkApplication.fa.ff(()=>{oa.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();oa.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();A.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&oa.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();A.AFrameworkApplication.fa.ka("CashTelemetryIsEnabled")&&(oa.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),oa.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}pIf(){return ia.a.Rza&&
Z.a.instance.Wn(ea.a.Dnc)?0<Z.a.instance.Rg(ea.a.Dnc)[ea.a.ymd]:!1}static main(){pa.a.instance.Ac(new Ma)}}Object(J.a)(Ma,"CoauthTelemetryPackage",null,[2,3]);var za=d(262),ka=d(1163),qa=d(230),Ja=d(463);class xa{constructor(rb,Ua,pb,Ub,Bc){this.Gc=rb;this._clientId=Ua;this.jKh=Bc;this.iMh=pb||(()=>null);this.jMh=Ub||(()=>null)}get id(){return this.Gc.id}get Fyc(){return this.Gc.Fyc}get Jyc(){return this.Gc.Jyc}get Iyc(){return this.Gc.Iyc}get Hyc(){return this.Gc.Hyc}get Gyc(){return this.Gc.Gyc}get Lyc(){return this.Gc.Lyc}get WEd(){return this.Gc.WEd}get kHb(){return this.Gc.kHb}get xhd(){return this.Gc.xhd}get D5c(){return this.Gc.D5c}get clientId(){return this._clientId}get zra(){return this.iMh}get w2(){return this.jMh}get QGi(){return this.jKh}static createInstance(rb,
Ua,pb,Ub,Bc=!1){return new xa(rb,Ua,pb,Ub,Bc)}}Object(J.a)(xa,"PeoplesWellSettings",null,[]);var Ga=d(26);class na{constructor(rb){this.rj=rb}get eAa(){return this.rj.eAa}get n5c(){return this.rj.n5c}}Object(J.a)(na,"CoauthoringTelemetryInfoProvider",null,[475]);var sa=d(899),Ha=d(77),cb=d(114),Za=d(760),va=d(566);class Fa{constructor(rb,Ua,pb,Ub,Bc){this.NAb=new Ha.a;this.Ky=null;this.rj=rb;this.Uab=pb;this.wI=Ub;this.wI.fGd(Object(h.a)(this,this.T6c,"onEditorTableUpdate"));this.q0j=A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
this.Rne=Bc;Ua&&Ua.execute(Gc=>{this.Ky=Gc})}dispose(){this.NAb&&(cb.a.hed([this.NAb]),this.NAb=null);this.wI.Fch(Object(h.a)(this,this.T6c,"onEditorTableUpdate"))}Umb(rb){this.NAb.addHandler("UsersUpdatedEvent",rb)}Hcd(rb){this.NAb.removeHandler("UsersUpdatedEvent",rb)}S5a(){return this.h6f(!1)}wXi(){return this.h6f(!0)}h6f(rb){const Ua=[];this.rj.vhb(this.rj.hC).returnValue||Ga.a.J(512497499,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",this.rj.hC);var pb=
null;this.Ky&&(pb=this.Ky.nKc());const Ub=this.Rne.a9f();let Bc=!1;for(const Gc of this.rj.bZ)rb&&Fa.KAc(Ub,Gc.EmailAddress)?Bc=!0:Array.add(Ua,this.tzi(Gc,pb));pb={};pb.fExcludeCurrent=rb;pb.fCurrentExcluded=Bc;pb.CurrentID=this.rj.hC;pb.EditorCount=this.rj.bZ.length;pb.IsRtcNull=!this.Ky;pb.UserCount=Ua.length;Ga.a.J(512497498,814,50,"PeopleInfoProvider::GetAllUsers:{0}",P.c(pb));return Ua}tzi(rb,Ua){const pb=this.Uab.fCa(new sa.a(rb.EmailAddress,void 0,rb.Name),rb.ColorIndex,rb.ID,1),Ub=new Za.a;
Ub.OXa(0);let Bc=0,Gc=!1,qd=!1;if(Ua&&rb.ID in Ua){Ub.OXa(1);if(this.q0j){const Td=Ua[rb.ID];Td&&Td.capabilities&4&&Ub.OXa(4);Gc=!0;Td&&(Bc=Td.capabilities,qd=Td.isAnonymous)}delete Ua[rb.ID]}Ga.a.J(512497495,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",rb.ID,pb,Ub.Lba(1),Ub.Lba(4),this.rj.hC,
!rb.EmailAddress,Bc,Gc,qd);return new va.a(rb.ID,rb.Name,pb,Ub,null,rb.EmailAddress,void 0,void 0,qd,void 0,void 0,rb.JoinCoauthTime)}T6c(){Ga.a.J(512497494,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.NAb.raiseEvent("UsersUpdatedEvent",this)}static KAc(rb,Ua){return!!rb&&!!Ua&&rb.toLowerCase()===Ua.toLowerCase()}}Object(J.a)(Fa,"PeopleInfoProvider",null,[508]);var Ca=d(78),La=d(220),nb=d(132),Nb=d(346),Rb=d(288);class Ya extends La.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=
!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(J.a)(Ya,"PeopleButtonProps",La.a,[]);var Qb=d(745),bb=d(45),Bb=d(113),Eb=d(1160),tb=d(66);class Yb{constructor(rb){this.Gnc=new tb.a;this.aQd=null;this.clientId=rb}z6k(rb){this.aNk();this.l1k(rb);for(const Ua of rb)Ua.clientId!==this.clientId&&this.ZBf(Ua)}get fmd(){const rb=[];for(let Ua of this.Gnc.values){const pb=this.Tih(Ua);Array.add(rb,pb)}return rb}get Rua(){return this.Gnc.count}ZFd(rb,
Ua){rb=rb.toUpperCase();let pb;({value:pb}=this.Gnc.Of(rb)).returnValue||(pb=[],this.Gnc.$(rb,pb));Array.add(pb,Ua)}aNk(){this.Gnc=new tb.a}l1k(rb){for(const Ua of rb)if(Ua.clientId===this.clientId){this.aQd=Ua;break}}}Object(J.a)(Yb,"UserTracker",null,[1660]);class Tc extends Yb{constructor(rb,Ua){super(rb);this.kMh=Ua}ZBf(rb){rb.isAnonymous||!rb.email?this.ZFd(rb.clientId,rb):this.aQd&&Eb.a.Qr().equals(this.aQd.email,rb.email)||this.ZFd(rb.email,rb)}Tih(rb){let Ua=new Date(0),pb=0<rb.length?rb[0]:
null;for(const Ub of rb)(rb=this.kMh(Ub.clientId))&&Ua.getTime()<rb.Vvb.getTime()&&(Ua=rb.Vvb,pb=Ub);return pb}}Object(J.a)(Tc,"UniqueUserTracker",Yb,[]);class ib extends Yb{constructor(rb){super(rb)}ZBf(rb){this.ZFd(rb.clientId,rb)}Tih(rb){return rb[0]}}Object(J.a)(ib,"UserInstanceTracker",Yb,[]);const Zb=(rb,Ua,pb)=>pb?new Tc(rb,Ua):new ib(rb);var Cc=d(69),ob=d(655),cc=d(35);class sb{constructor(rb,Ua=null,pb=null){this.KJ=null;this.tDd=new n.a;this.Gc=rb;this.E9c=Ua;pb&&pb.continueWith(()=>{this.KJ=
pb.result;this.KJ.Umb(Object(h.a)(this,this.hX,"onUsersUpdated"));this.Vbd()});new va.a(this.settings.clientId,"Anonymous user","#cccccc",new Za.a(7));this.bSc=this.uvd=!0;this.Xsd=this.dzd=!1;this.z0=Zb(this.settings.clientId,this.settings.w2,rb.QGi)}get settings(){return this.Gc}get JDj(){return A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.ka("ColorPresenceHashIsEnabled"):!1}get Grg(){return A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled"):
!1}O_i(){let rb;let Ua,pb,Ub,Bc;var Gc=this.P_i();this.z0.Rua?1===this.z0.Rua?(Ua=!0,pb=this.settings.kHb.cluster,Ub=this.settings.kHb.pFc,Bc=this.z0.fmd[0].color):(Ua=!0,pb=this.settings.D5c.cluster,Ub=this.settings.D5c.pFc,Bc=""):(Ua=!1,Bc=Ub=pb="");rb=Gc[0];Gc=Gc.slice(1);return{$qk:rb,ark:Gc,Wqk:Ua,lDl:pb,Yqk:Ub,Xqk:Bc}}P_i(){if(2<=this.z0.Rua)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.z0.Rua)];if(1===this.z0.Rua){const rb=this.z0.fmd[0],Ua=this.settings.w2(rb.clientId);
return Ua&&2===Ua.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,rb.userName]:[rb.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,rb.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}Ngj(rb){return this.Ogj(rb)}aLf(rb,Ua,pb){return Ua?this.Eii(Ua)?(rb=this.settings.w2(rb))&&2===rb.status?!1:!0:(pb&&m.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(pb&&m.ULS.sendTraceTag(4482393,
325,50,"User does not have any presence data"),!1)}Hdj(rb){return rb.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}Ogj(rb){if(!rb.capabilities.Lba(1))return this.Hdj(rb);const Ua=rb.isReadOnly,pb=this.settings.w2(rb.clientId);rb=this.settings.zra(rb.clientId);if(!pb)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(pb.status){case 1:return rb?Ua?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.tui(rb)||
CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}E4i(rb){if(this.E9c.tae)return this.E9c.GWb(rb.email,"O365",A.AFrameworkApplication.Zg,0)}Cgj(rb){rb=this.settings.w2(rb.clientId);return!rb||rb&&1===rb.status?!0:!1}Dgj(rb){var Ua=String.format("buttonPeoplesWellUser-{0}",rb.clientId),pb=rb.clientId,Ub=this.Ngj(rb);
const Bc=rb.userName,Gc=rb.color;var qd=Object,Td=qd.assign,Vd=new Ya,Be=this.settings.Lyc.toString(),Id=this.settings.xhd.cluster,gb=this.settings.xhd.pFc,Xb=this.N8f(),Ic=rb.isAnonymous,Wc;if(Wc=[Bc],Wc.length){var Ib=new Sys.StringBuilder("STRARRY@");for(const ec of Wc)Ib.append(ec?ec.length:0),Ib.append(","),Ib.append(ec),Ib.append(",");Wc=Ib.toString().slice(0,-1)}else Wc=null;Ua=Td.call(qd,Vd,{Id:Ua,Command:Be,LabelText:"{0}",Image32by32:Id,Image32by32Class:gb,MenuItemId:pb,CommandValueId:pb,
Alt:Bc,DisplayMode:Xb,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:Ub,ImageBackColor:Gc,IsAnonymous:Ic,LabelTextUserGeneratedPlaceholderReplacements:Wc,Upn:rb.email});A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&this.E9c&&(pb=this.E4i(rb),Ub=this.Cgj(rb),Ua.ImageUrl=pb,Ua.ActiveStatus=Ub,Ua.JoinTimeInMS=rb.yDa,rb=this.aLf(rb.clientId,this.settings.zra(rb.clientId),!1),Ua.CanJump=rb,""===pb&&m.ULS.sendTraceTag(40969413,
302,50,"ImageURL collection failed"));return Ua}Q3i(){return Object.assign(new La.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}N8f(){return this.JDj?"Initials":"Menu32"}Egj(rb){const Ua=[];for(const pb of rb)rb=this.Dgj(pb),Array.add(Ua,rb);return Ua}V7d(){return 0<this.z0.Rua}GDk(rb){if(!this.uvd)return!0;this.bSc||(rb[ob.a.Visible]=!0);let Ua,pb,Ub,Bc,Gc;({$qk:Ua,
ark:pb,Wqk:Ub,Yqk:Bc,Xqk:Gc}=this.O_i());rb[ob.a.LabelText]=Ua;pb&&pb.length&&(rb[ob.a.LabelTextUserGeneratedPlaceholderReplacements]=pb);rb[ob.a.ImageIsVisible]=Ub;rb[ob.a.Image16by16Class]=Bc;rb[ob.a.ImageBackColor]=Gc;this.uvd=!1;return!0}gwk(rb){if(0>=this.z0.Rua)return!1;var Ua=this.jfl(this.z0.fmd),pb=this.Egj(Ua);Ua=Object.assign(new Nb.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});pb=Object.assign(new Rb.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.N8f(),
ControlList:pb});A.AFrameworkApplication.fa.ka("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.E9c&&(pb.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,pb.TitleId="menuCoauthorsTitle",pb.Theme="Light");Array.add(Ua.MenuSectionList,pb);A.AFrameworkApplication.fa.ka("DocChatIsEnabled")&&A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.gb.uo&&(pb=[],Array.add(pb,this.Q3i()),pb=Object.assign(new Rb.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",
ControlList:pb}),Array.add(Ua.MenuSectionList,pb));A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.gb.uo?rb.MenuItems=Ua:rb.PopulationXML=nb.l(Ua);return!0}Mxl(rb){m.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");rb=rb.MenuItemId;if(!rb)return!1;const Ua=this.settings.zra(rb);if(!this.aLf(rb,Ua,!0))return!1;this.JQj(rb,Ua);return!0}IJk(){const rb=this.zXi();this.z0.z6k(rb);this.bSc&&1<=this.z0.Rua&&(m.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),
this.bSc=!1);this.uvd=!0}hX(){this.Xsd||(window.setTimeout(()=>{this.Vbd();this.Xsd=!1},3E3),this.Xsd=!0)}zXi(){let rb;rb=this.xXi()||[];for(const Ua of rb)this.aXk(Ua);return rb}aXk(rb){rb.clientId||(rb.clientId=Bb.a.create().toString());rb.userName||(rb.userName="Anonymous user");rb.capabilities||(rb.capabilities=new Za.a);rb.color||(rb.color="#cccccc");rb.yDa||(rb.yDa=0)}jfl(rb){const Ua=[];Array.addRange(Ua,rb);Ua.sort(sb.Lqk);return Ua}QLk(){A.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&
!this.dzd&&(A.AFrameworkApplication.Ta.iS(cc.a.qOf)&&Qb.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||A.AFrameworkApplication.Ta.pa(cc.a.qOf,Cc.a.frame,Object(h.a)(this,this.rik,"onCoauthorGalleryFirstRender"),96));this.RLk();this.dzd=!0;this.Vbd()}rik(rb,Ua,pb,Ub,Bc){this.tDd.TL(Bc.RenderTime);return 32}get Ljd(){return this.tDd.task}Vbd(){if(!this.dzd&&(this.tDd.TL((new Date).getTime()),m.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),
this.Grg))return;this.IJk();this.Grg&&this.bSc?A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||Ja.a.y9("ribbon","coauthorGallery"):(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(Ja.a.Qua("ribbon","coauthorGallery"),Ja.a.Pua("ribbon","coauthorGallery")),this.JJk())}dispose(){this.KJ&&(this.KJ.Hcd(Object(h.a)(this,
this.hX,"onUsersUpdated")),this.KJ=null)}static Lqk(rb,Ua){return rb.capabilities.Lba(1)&&Ua.capabilities.Lba(1)||!rb.capabilities.Lba(1)&&!Ua.capabilities.Lba(1)?bb.a.localeCompare(rb.userName,Ua.userName):rb.capabilities.Lba(1)?-1:1}}Object(J.a)(sb,"APeoplesWell",null,[1545,106]);var mb=d(38);class Pb extends sb{constructor(rb,Ua,pb=null,Ub=null){super(rb,pb,Ub);this.Xxa=()=>!0;this.Ca=Ua}IDk(rb){return this.GDk(rb)}iwk(rb){return this.gwk(rb)}Oxl(rb){return this.Mxl(rb)}HP(rb,Ua,pb,Ub,Bc,Gc){rb=
!1;switch(pb){case 1:rb=Bc(Ub);break;case 2:rb=Gc(Ub)}return Pb.dci(rb)}gEj(rb,Ua,pb,Ub,Bc){return this.HP(rb,Ua,pb,Bc,()=>this.V7d(),this.Xxa)}HDk(rb,Ua,pb,Ub,Bc){return this.HP(rb,Ua,pb,Bc,Object(h.a)(this,this.IDk,"queryUsersProxy"),this.Xxa)}hwk(rb,Ua,pb,Ub,Bc){return this.HP(rb,Ua,pb,Bc,this.Xxa,Object(h.a)(this,this.iwk,"populateFlyoutContentsProxy"))}$oi(rb,Ua,pb,Ub,Bc){return this.HP(rb,Ua,pb,Bc,this.Xxa,this.Xxa)}Zoi(rb,Ua,pb,Ub,Bc){return this.HP(rb,Ua,pb,Bc,this.Xxa,this.Xxa)}Nxl(rb,Ua,
pb,Ub,Bc){return this.HP(rb,Ua,pb,Bc,this.Xxa,Object(h.a)(this,this.Oxl,"userButtonClickProxy"))}Euk(rb,Ua,pb,Ub,Bc){return this.HP(rb,Ua,pb,Bc,this.Xxa,()=>{this.Vbd();return!0})}RLk(){this.Ca.xa(this.settings.Fyc,mb.a.application,Object(h.a)(this,this.gEj,"isControlEnabledHandler"));this.Ca.pa(this.settings.Jyc,mb.a.application,Object(h.a)(this,this.HDk,"queryUsersHandler"),96);this.Ca.pa(this.settings.Hyc,mb.a.application,Object(h.a)(this,this.$oi,"commandMenuOpenHandler"),96);this.Ca.pa(this.settings.Gyc,
mb.a.application,Object(h.a)(this,this.Zoi,"commandMenuCloseHandler"),96);this.Ca.pa(this.settings.Iyc,mb.a.application,Object(h.a)(this,this.hwk,"populateFlyoutContentsHandler"),96);this.Ca.xa(this.settings.Lyc,mb.a.application,Object(h.a)(this,this.Nxl,"userButtonClickHandler"));this.Ca.pa(this.settings.WEd,mb.a.application,Object(h.a)(this,this.Euk,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static dci(rb){return rb?32:8}}Object(J.a)(Pb,"ABox4PeoplesWell",sb,[]);var dc=d(716);
class mc extends Sys.EventArgs{constructor(rb){super();this.controlId=rb}}Object(J.a)(mc,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);class Mb extends Pb{constructor(rb,Ua,pb,Ub,Bc,Gc,qd,Td,Vd,Be,Id,gb,Xb,Ic,Wc,Ib,ec,Jb){super(rb,Ua,Ib,Jb?E.Task.wt(Jb):null);this.Ky=null;this.aje=!1;if(!Bc)throw Error.argumentNull("coauthStateGetter");if(!Gc)throw Error.argumentNull("appFrame");if(!qd)throw Error.argumentNull("taskManager");this.rj=Bc;this.Nb=Gc;this.yb=qd;Ub&&Ub.execute(hb=>{this.Ky=hb});
pb&&pb.execute(hb=>{hb.T4h(Object(h.a)(this,this.Ezk,"presenceChanged"))});this.yc=Td;this.Ie=Vd;this.gf=Be;this.N8b=Xb;this.BZj=Id;this.Uab=gb;this.nxb=Ic;this.hT=Wc;this.Rne=ec;this.oMg=Jb;this.Ljd.continueWith(()=>{this.hT.CLi(this.Ljd.result)})}JQj(rb,Ua){let pb=null;({data:pb}=this.iRe(Ua)).returnValue&&pb&&pb.Mj&&(Ga.a.J(512497493,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",rb,pb.Mj,this.rj.hC),(rb=this.yc.xra(pb.Mj))?(this.Ie.gIe(),this.Ie.wda(rb.De)):
Ga.a.J(512497492,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",pb.Mj))}iRe(rb){let Ua;Ua=null;if(!rb)throw Ga.a.J(512497491,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",this.rj.hC),Error.argumentNull("presence");return rb?(Ua=dc.a.OEc(rb.data))?{returnValue:!0,data:Ua}:{returnValue:!1,data:Ua}:{returnValue:!1,data:Ua}}Eii(rb){let Ua=null;return({data:Ua}=this.iRe(rb)).returnValue&&Ua&&Ua.Mj?!0:!1}xXi(){if(this.oMg)return this.oMg.wXi();
Ga.a.J(512497490,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const rb=this.yXi();0<rb.length&&Ga.a.J(512497489,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",rb.length);return rb}yXi(){const rb=[],Ua=this.Rne.a9f();this.rj.vhb(this.rj.hC).returnValue||Ga.a.J(512497488,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.rj.hC);let pb=null;this.Ky&&(pb=this.Ky.nKc());var Ub=A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
for(var Bc of this.rj.bZ){var Gc=this.Uab.fCa(new sa.a(Bc.EmailAddress,void 0,Bc.Name),Bc.ColorIndex,Bc.ID,1),qd=new Za.a;qd.OXa(0);let Td=0,Vd=!1;if(Mb.tPj(Bc.ID,pb)){qd.OXa(1);if(Ub){let Be=pb[Bc.ID];Be&&(Td=Be.capabilities);Vd=!0;Be&&Be.capabilities&4&&qd.OXa(4)}delete pb[Bc.ID]}Mb.KAc(Ua,Bc.EmailAddress)||(Array.add(rb,new va.a(Bc.ID,Bc.Name,Gc,qd,null,Bc.EmailAddress)),Ga.a.J(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
Bc.ID,Gc,qd.Lba(1),qd.Lba(4),this.rj.hC,!Bc.EmailAddress,Td,Vd))}if(!Ub&&this.N8b&&pb)for(let Td in pb)Ub=pb[Td],!Mb.KAc(Ua,Ub.email)&&Ub&&Ub.userName&&(Bc=new Za.a,Bc.OXa(1),Ub.capabilities&4&&Bc.OXa(4),Gc=this.nxb.lYd(Ub.email)||Ub.email,qd=this.Uab.fCa(new sa.a(Gc,void 0,Ub.userName),null,Ub.clientId,1),Array.add(rb,new va.a(Ub.clientId,Ub.userName,qd,Bc,null,Gc)),Ga.a.J(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
Ub.clientId,qd,Bc.Lba(1),Bc.Lba(4),this.Ky.clientId,!Ub.email,Ub.capabilities));return rb}tui(rb){let Ua=null,pb=" ";({data:Ua}=this.iRe(rb)).returnValue&&Ua&&Ua.Mj&&(rb=this.yc.xra(Ua.Mj))&&(pb=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,rb.De+1));return pb}Ezk(){this.Nb.ut.ZCa?this.aje||(this.yb.Gb(new Ca.a(2,1,0,Object(h.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.aje=!0):this.Ca.processAction(cc.a.P3a,2)}JJk(){this.gf.JFk(new mc(this.settings.id,
!0));const rb=1<this.z0.Rua||1===this.z0.Rua&&this.z0.fmd[0].clientId!==this.settings.clientId;this.BZj.execute(Ua=>{rb&&this.hT&&this.hT.bXj();Ua.rJb()});rb&&this.hT.Rh(14,Date.now())}handlePendingRefresh(){this.aje=!1;this.Ca.processAction(cc.a.P3a,2)}dispose(){super.dispose()}static tPj(rb,Ua){return Ua&&rb in Ua?!0:!1}static KAc(rb,Ua){return!!rb&&!!Ua&&rb.toLowerCase()===Ua.toLowerCase()}}Object(J.a)(Mb,"PowerPointPeoplesWell",Pb,[]);class Kc{constructor(rb){this.E$b=null;rb.execute(Ua=>{this.E$b=
Ua})}zra(rb){return this.E$b?this.E$b.zra(rb):null}w2(rb){return this.E$b?this.E$b.w2(rb):null}}Object(J.a)(Kc,"PresenceUserInfoGetterProxy",null,[474]);class gc{constructor(){this.G3=this.wI=this.gh=this.K=null}get name(){return"PowerPointWebEditor.PeoplesWell"}Wb(rb){gc.X6b=Date.now();this.K=rb;this.G3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.gh=this.G3.UBa(6,this.name);this.K.register(474,"PowerPointWebEditor.IPresenceUserInfoGetter").ma().na(()=>new Kc(this.K.La("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.K.register(475,"Common.ICoauthoringTelemeryInfoProvider").ma().na(()=>new na(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(Fa,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").ma().na(()=>new Fa(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.La("Common.IRealtimeChannelBasic"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser")));
Ga.a.J(50943688,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("UnifiedScriptLoaderForDSEnabled"))this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Iha("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1202)));else{const rb=ka.a.create("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1202)));qa.a.wx(rb)}this.K.resolve("Common.ICoauthoringTelemeryInfoProvider");this.K.resolve("Common.IPeopleInfoProvider");
A.AFrameworkApplication.mA.xBa?(this.wI=this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),Ja.a.y9("ribbon","coauthorGallery"),this.wI.eGd(Object(h.a)(this,this.cmg,"initializePeoplesWellHandler"))):this.bmg()}cmg(){try{A.AFrameworkApplication.mA.xBa||(this.bmg(),this.wI.GDe(Object(h.a)(this,this.cmg,"initializePeoplesWellHandler")))}catch(rb){Ga.a.J(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",rb)}}bmg(){const rb=this.gh.Zt("peoplewell");this.Qxj(this.K.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerpointPresence.RtcParams").clientId);this.gh.gu(rb)}Qxj(rb,Ua,pb,Ub,Bc,Gc){var qd=this.K.resolve("PowerpointPresence.IPresencePerfLogger");qd.Rh(10,gc.X6b);qd.Rh(9,gc.O$b);qd.Rh(11,(new Date).getTime());qd=Date.now();const Td=za.CuiHelper.y9i(A.AFrameworkApplication.Vl,A.AFrameworkApplication.Vl,
A.AFrameworkApplication.Vl);rb=xa.createInstance(Td,Gc,Object(h.a)(rb,rb.zra,"getUserPresence"),Object(h.a)(rb,rb.w2,"getUserStatusInfo"),!0);(Gc=this.K.resolve("PowerpointPresence.PeopleInfoProvider"))||Ga.a.J(50642959,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");Ga.a.J(50943691,814,50,"InitializePeoplesWellInternal; creating peopleswell");const Vd=new Mb(rb,Ua,this.K.La("PowerpointPresence.IPresenceManager"),this.K.La("Common.IRealtimeChannelBasic"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),
pb,Ub,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.La("Box4.IBox4BridgeCommandUi"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),Bc.podsDefaultToRtcForPresenceEnabled,this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.resolve("Common.App.People.IPeopleManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser"),
Gc);Vd.QLk();this.K.register(Mb,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").ma().na(()=>Vd);this.K.resolve("Common.IPeoplesWell");this.K.La("Box4.IBox4BridgeCommandUi").execute(Be=>{Be.rJb()});Ga.a.J(8958615,814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-qd);this.K.resolve("PowerpointPresence.IPresencePerfLogger").HLi()}dispose(){}static main(){gc.O$b=Date.now();if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")){const rb=
new gc;rb.Wb(oa.a.instance);rb.init()}else pa.a.instance.Ac(new gc)}}gc.O$b=0;gc.X6b=0;Object(J.a)(gc,"PPTWebEditorPeoplesWellPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");Ma.main();Type.registerNamespace("RealtimePresenceUI");gc.main()},716:function(J,
V,d){J=d(0);var h=d(63);class e{constructor(n,v,A){this.slideId=n;this.shapes=v;this.sn=A}}Object(J.a)(e,"SerializablePresenceData",null,[]);d.d(V,"a",function(){return m});class m{constructor(n,v,A=0){if(!m.isValid(n))throw Error.create("Invalid Presence Data");this.NA=n;this.M2c=v;this.sOg=A?A:++m.sCi}get Mj(){return this.NA}get NT(){return this.M2c}toString(){return this.NA.toString()+" : "+(this.NT&&this.NT.length?this.NT[0].toString():"")+" : "+this.sOg}u0d(){return new e(this.NA.Znc,this.M2c,
this.sOg)}static isValid(n){return!!n}static OEc(n){return new m(new h.a(n.slideId),n.shapes,n.sn)}}m.sCi=0;Object(J.a)(m,"PresenceData",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.presence.js.map