'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1001:function(J,V,d){J=d(0);var h=d(375),e=d(101),m=d(267),n=d(13),v=d(1158),A=d(33);class w{constructor(){this.Value=this.Id=this.LanguageId=null}}Object(J.a)(w,"CritiqueTypeOption",null,[]);var y=d(2);d.d(V,"a",function(){return u});class u{constructor(E,G,I){this.xBd={};this.Sk=null;this.psf=E;this.QTh=G;this.RTh=I;this.K0a=y.Task.wt({})}init(){this.K0a=this.psf.N1d(this.QTh,["ProofingSettingLanguageList",
"ProofingSettings"]).CWRCo(Object(n.a)(this,this.vlk,"onLoadSettingsTaskFinished"),8)}Qnl(E){const G={};if(!(E&&"ProofingSettingLanguageList"in E))return G;const I=Array.isArray(A.a(E.ProofingSettingLanguageList))?A.a(E.ProofingSettingLanguageList):null;for(const H of I)"ProofingSettings"+H in E&&(G[H]=Object(v.a)(Object,A.a(E["ProofingSettings"+H])));return G}Rnl(E){const G={},I=[];for(let C in E){var H=C,K=E[C];K&&(I.push(H),G["ProofingSettings"+H]=A.c(K))}G.ProofingSettingLanguageList=A.c(I);return G}saveSettings(E){this.K0a=
y.Task.wt(E);this.Sk=null;try{const G=this.Rnl(E);this.psf.Fmh(this.RTh,G).continueWith(Object(n.a)(this,this.Dnk,"onSaveSettingsTaskFinished"),8)}catch(G){h.ULS.sendTraceTag(35401881,375,10,"Save settings failed with exception {0}",G.toString())}}VXd(){if(!this.Sk){if(6!==this.K0a.status)return[];try{var E=this.K0a.result;let K;if(e.a.isEmpty(this.xBd))K=E;else if(e.a.isEmpty(E))K=this.xBd;else{K={};var G=this.xBd;for(let C in G)K[C]=e.a.Sjc(G[C]);K=u.merge(K,E)}this.Sk=[];for(let C in K){var I=
K[C];const Y=m.a.le(parseInt(C));if(!Y)continue;const M=Y.name;G=I;for(let P in G){E=P;var H=G[P];const T=Object.assign(new w,{LanguageId:M,Id:E,Value:H.toString()});this.Sk.push(T)}}}catch(K){h.ULS.sendTraceTag(36542301,375,10,"GetCritiqueTypeOptions failed with exception: {0}",K.toString())}}return this.Sk}iGi(E,G){const I=this.K0a.result;if(I)try{let H=I[E];H||(H={});H[G]=!1;I[E]=H;this.saveSettings(I)}catch(H){h.ULS.sendTraceTag(36750082,375,10,"DisableCritique failed with exception: {0}",H.toString())}}vlk(E){if(E.Wl)return h.ULS.sendTraceTag(34964619,
375,10,"Load setting failed with exception {0}",E.Ui),null;if(6===E.status)try{return this.Qnl(E.result)}catch(G){h.ULS.sendTraceTag(34964620,375,10,"Parse settings with exception {0}",G.toString())}return null}Dnk(E){E.Wl&&h.ULS.sendTraceTag(34964621,375,10,"Save setting failed with exception {0}",E.Ui)}static merge(E,G){E=E||{};if(G)for(let K in G){var I=K,H=G[K];E[I]=E[I]||{};for(let C in H)E[I][C]=H[C]}return E}}Object(J.a)(u,"CritiqueTypeSettings",null,[762])},1004:function(J,V,d){J=d(0);var h=
d(131),e=d(80),m=d(1166),n=d(25),v=d(196),A=d(45),w=d(162),y=d(26),u=d(431),E=d(527);class G{constructor(){this.alt=null;this.height=0;this.src=this.alt="";this.width=this.height=0}}Object(J.a)(G,"ImagePasteArgs",null,[]);var I=d(317),H=d(41),K=d(47),C=d(28);d.d(V,"a",function(){return Y});class Y{constructor(M,P,T,L,aa,Q,ea,ia,ja,D,pa,Z){this.ia=M;this.Fa=P;this.nFa=T;this.ra=L;this.E$j=aa;this.vo=Q;this.wja=ea;this.ve=D;this.Lz=pa;this.tc=Z;this.YIg=ia;this.z3j=ja;this.Q2c=!1;this.G9b=-1}QM(M){if(!this.nFa.d3b(this.Fa)||
!M)return!1;if(M.SYb&&M.KPc)return this.Q2c=!1,M.QM=this.YIg;if(!M.Cm||0<M.Cm.getElementsByTagName(K.a.Jkg).length)return!1;this.Q2c=!this.Iqj(M)&&this.mNj(this.ra.ae());M.QM=this.Q2c?this.z3j:this.YIg;return M.QM}mNj(M){return 1===M.length?M[0].COj:!1}QAk(M,P){this.a7g(M,P,0);if(!M.firstChild||!M.firstChild.className||!u.a.Cqg(M.firstChild.className))if(!this.vo.$f||"<br>"!==M.innerHTML){const T=w.b(M);T&&0<T.length&&(P.TX=M.innerHTML)}}a7g(M,P,T){if(M){if(T>=Y.BBc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",
Y.BBc));if(1===M.nodeType){var L=M.tagName.toLowerCase();if(this.wja.sLj(L))M.parentNode.removeChild(M);else{for(let Q=M.firstChild;Q;Q=aa){var aa=Q.nextSibling;this.a7g(Q,P,T+1)}L===K.a.Qba?(M.parentNode.removeChild(M),this.RAk(M,P)):L===K.a.dIb?(M.parentNode.removeChild(M),this.wBk(M,P)):L===K.a.listTag&&this.XAk(M);this.tc.hJe(M,P.Rb)}}}}XAk(M){if(M){var P=M.getAttribute("data-"+h.a.zTb);if(P&&0<P.length&&M.style){var T=parseInt(P);if(1!==P.length||isNaN(T)||1>T||T>I.a.C6)P="1",T=1;T>this.G9b&&
(this.G9b=T);P=String.format(K.a.VSj,P);(T=M.style.cssText)?M.setAttribute("style",P+T):M.setAttribute("style",P)}if((P=M.parentNode)&&!this.ve.oIj(P.tagName)){T=M.nextSibling;const L=this.ve.FWb();L.appendChild(M);P.insertBefore(L,T)}}}RAk(M,P){if(M&&M.src&&M.src.length){var T=window.location.href.toLowerCase();T=e.a.lS(T);if(M.src.startsWith(T))y.a.J(20501650,826,50,"Pasted image src is an empty string.");else{T=Math.ceil(m.a.Ge(this.wja.F4i(M),0,!1));var L=Math.ceil(m.a.Ge(this.wja.x4i(M),1,!1));
P.Oba.push(Object.assign(new G,{src:M.src,alt:M.alt,width:T?T:M.width,height:L?L:M.height}))}}}wBk(M,P){M&&M.innerHTML&&M.rows&&M.rows.length&&(M.getElementsByTagName(K.a.Yid).length||M.getElementsByTagName(K.a.Fjl).length)&&(M=w.c(M),!M||0>=M.length||P.Tgb.push(M))}Iqj(M){if(M.SYb)return!0;const P=M.Cm.getElementsByTagName(K.a.dIb).length;return 0<M.Cm.getElementsByTagName(K.a.Qba).length||0<P}paste(M){if(n.AFrameworkApplication.ZP)this.E$j.Ikc(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,
null);else{const P=Object.assign(new E.a,{Rb:M.Rb});let T=!0;P.okc=this.Q2c;if(M.SYb)P.Oba.push(Object.assign(new G,{src:M.KPc,width:0,height:0}));else try{this.QAk(M.Cm,P),0<this.G9b&&(y.a.J(21050954,826,50,String.format("max list level pasted into new shape = {0}.",this.G9b-1)),this.G9b=-1)}catch(L){T=!1,y.a.J(23634591,826,15,L.message)}T&&(this.R8k(P)?this.buk(P):this.ia.Ka(C.a.QGa,2,P))}}R8k(M){return v.a.Va(M.Tgb)&&A.a.Va(M.TX)&&!!M.Oba&&1===M.Oba.length&&this.yPj(M.Oba[0].src)}yPj(M){if(A.a.Va(M)||
!M.startsWith("data:image"))return!1;M=M.split(";");if(!M||2!==M.length)return!1;M=M[0].replace("/",".");return 0===this.Lz.omd(M,!0)}buk(M){let P=new Image;const T=M.Oba[0],L=H.a.Cb;if(T.width&&T.height)M.ZSc=!0,this.ia.Ka(C.a.QGa,2,M);else{const aa=new Date;P.onload=()=>{M.Cxe=+new Date-+aa;T.width=P.width;T.height=P.height;M.ZSc=!0;P=null;H.a.LE(L,()=>{this.ia.Ka(C.a.QGa,2,M)})};P.onerror=()=>{P=null;H.a.LE(L,()=>{this.ia.Ka(C.a.QGa,2,M)})};P.src=T.src}}}Y.BBc=100;Object(J.a)(Y,"HtmlPasteHandler",
null,[458])},1005:function(J,V,d){J=d(0);var h=d(45);class e{constructor(n,v){this.B2j=n;this.s0c=v}get ERa(){return this.B2j}get message(){return this.s0c}}Object(J.a)(e,"CalloutNotificationError",null,[]);d.d(V,"a",function(){return m});class m{constructor(n,v){this.uDg=n;this.x7j=v}twa(n,v,A,w,y,u,E,G,I,H,K,C){this.uDg.show(this.x7j,null,!1,I,H,n,v,A,y,w,u,E,G,K,C)}xRd(){this.uDg.dismiss()}Mal(n){if(!n)throw Error.argumentNull("CalloutNotificationMessageAttributes");const v=this.Gyl(n);if(v&&v.ERa)return v;
this.twa(n.title,n.message,n.fjg,n.FDb,n.kjg,n.ved,n.dAk,n.zYk,n.eAk,n.AYk,!!n.OPe,n.OPe);return new e(!1,null)}Gyl(n){return h.a.Va(n.title)?new e(!0,"Invalid Title"):h.a.Va(n.message)?new e(!0,"Invalid Message"):n.fjg&&h.a.Va(n.FDb)?new e(!0,"Missing PrimaryButtonLabel"):n.kjg&&h.a.Va(n.ved)?new e(!0,"Missing SecondaryButtonLabel"):new e(!1,null)}}Object(J.a)(m,"CalloutNotificationAdapter",null,[277])},1006:function(J,V,d){J=d(0);var h=d(25),e=d(713),m=d(223);class n extends e.a{constructor(A,w){super(A);
this.xZj=w}vwh(A){return m.i(m.g(A))}UPe(A){return m.i(A)}rmc(A){return this.xZj?A.Bbi:A.rmc().toString()}cfi(A,w,y){const u=new Sys.StringBuilder;u.append(String.format('<Menu Id="{0}">',"menuFontColor"));u.append(this.$1d(A,w,y));u.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');u.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',"862825906",h.AFrameworkApplication.Vl,
ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));u.append("</Controls> </MenuSection>");u.append("</Menu>");return u.toString()}}Object(J.a)(n,"ColorMenuBuilder",e.a,[]);d.d(V,"a",function(){return v});class v{XZi(A){return new e.a(A)}H7f(A,w){return new n(A,w)}}Object(J.a)(v,"ColorPickerBuilderFactory",null,[296])},1008:function(J,V,d){J=d(0);var h=d(895),e=d(127);class m extends h.a{constructor(){super();this.languageId=null;this.startOfSentence=!1;this.userInitQuery=this.text=
null;this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.kl()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignalBase"}static kl(){return["AugLoop_Signals_Signal"]}}Object(J.a)(m,"TextPredictorSignalBase",h.a,[]);d.d(V,"a",function(){return n});class n extends m{constructor(){super();this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.kl()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignal"}static kl(){return["AugLoop_Signals_TextPredictorSignalBase","AugLoop_Signals_Signal"]}}
Object(J.a)(n,"TextPredictorSignal",m,[])},107:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(1186);class e{constructor(){this.M5a=this.gJf=this.h2=this.Fea=this.zBc=this.fKc=this.rrb=this.vBa=this.K1=this.DDc=this.Ujd=null}Kf(m){this.Ujd=new h.a;this.Ujd.value=m}ffd(){this.DDc=new h.a;this.DDc.value=!0}TT(m){this.fKc=new h.a;this.fKc.value=m}}Object(J.a)(e,"QueryResult",null,[])},1071:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(95);class e{constructor(m){this.Ipd=
m.cloneNode(!0);this.Off=m}restore(){for(h.a.$t(this.Off);this.Ipd.firstChild;){const m=this.Ipd.firstChild;h.a.fO(m);this.Off.appendChild(m)}this.Ipd=null}}Object(J.a)(e,"DomElementContentState",null,[])},1072:function(J,V,d){d.r(V);d.d(V,"SpellingRequestObjectUpdatedV2",function(){return m});J=d(0);var h=d(650),e=d(649);class m extends h.a{constructor(){super();this.ProofingEngine=0;this.UseContextualResults=!1;this.TextUnit=0;this.Descriptors=this.OverriddenCritiqueTypeOptions=null;this.UxLcid=
0}static zWd(n,v){const A=new m;h.a.vye(A,n,v);A.UserActionType=e.a[n.userAction];A.ProofingEngine=n.$da;A.Descriptors=n.descriptors;A.OverriddenCritiqueTypeOptions=n.overriddenCritiqueTypeOptions;A.UxLcid=n.$Ch;2===n.$da?A.TextUnit=n.range.textUnit:1===n.$da&&(A.UseContextualResults=!0);return A}}Object(J.a)(m,"SpellingRequestObjectUpdatedV2",h.a,[])},1073:function(J,V,d){d.r(V);d.d(V,"SpellingRequestObjectUpdated",function(){return m});J=d(0);var h=d(650),e=d(649);class m extends h.a{constructor(){super();
this.UseContextualResults=this.TrackMetrics=this.UseOneSpeller=!1;this.ExperimentId=null}static zWd(n,v,A,w,y,u){const E=new m;h.a.vye(E,n,v);E.UserActionType=e.a[n.userAction];E.UseOneSpeller=A;E.TrackMetrics=w;E.UseContextualResults=y;u&&(E.ExperimentId=u);return E}}Object(J.a)(m,"SpellingRequestObjectUpdated",h.a,[])},1074:function(J,V,d){d.r(V);d.d(V,"ReactOICErrorDialogWithTrial",function(){return n});J=d(0);var h=d(13);V=d(901);var e=d(191),m=d(82);class n extends V.a{constructor(v,A,w,y,u,
E){super(v,A,w,y,u,E);A={["errorMessage"]:this.R_f,["offerString"]:this.KVg};v=new m.a(!1,!1,!0);this.Wph?(v.vd=1,A.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.$Qa,["onExecute"]:()=>{e.Redirect.showHelp(this.Ajg)}}):(v.vd=4,v.Re(2,this.wkg));v.Re(1,this.Lzf);v.kg=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};v.pj(this.xOa,Object(h.a)(this,this.jHk,"reactOICErrorDialogWithTrialHandler"),A)}}Object(J.a)(n,"ReactOICErrorDialogWithTrial",V.a,[])},1075:function(J,
V,d){d.r(V);d.d(V,"OICErrorDialogWithTrial",function(){return m});J=d(0);var h=d(13);V=d(901);var e=d(103);class m extends V.a{constructor(n,v,A,w,y,u){super(n,v,A,w,y,u);n=document.createElement("span");n.innerText=this.R_f;n.appendChild(document.createElement("br"));n.appendChild(document.createElement("br"));v=document.createElement("span");v.innerText=this.KVg;n.appendChild(v);v=new e.StandardDialog;this.Wph?(v.vd=1,v.EFd(this.$Qa,this.Ajg)):(v.vd=4,v.Re(2,this.wkg));v.Re(1,this.Lzf);v.kg=this.id;
v.Yw(this.xOa,null,this.icon,Object(h.a)(this,this.wSj,"legacyOICErrorDialogWithTrialHandler"),n)}}Object(J.a)(m,"OICErrorDialogWithTrial",V.a,[])},1076:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(J.a)(h,"HeaderButtonInfo",null,[])},1077:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(J.a)(h,"CalloutButtonProps",
null,[])},1078:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.y=this.x=0}}Object(J.a)(h,"IPoint",null,[])},1079:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(25);d=d(77);class e{static C3h(m){e.aVe.addHandler(e.COf,m)}static jEk(m){h.AFrameworkApplication.fa.ka("SqmCommandEventSourceEnabled")&&e.aVe.raiseEvent(e.COf,m)}}e.COf="CommandClickEvent";e.aVe=new d.a;Object(J.a)(e,"CommandClickEvents",null,[])},1080:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{}h.Image16by16Class="Image16by16Class";h.Image32by32Class="Image32by32Class";h.On="On";h.LabelText="LabelText";h.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";h.EnsureControlRoleIsButton="EnsureControlRoleIsButton";h.Visible="Visible";Object(J.a)(h,"SplitButtonCommandProperties",null,[])},1081:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m=null,n=null,v=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=m;this.iconSet.icon24=
n;this.iconSet.icon32=v}}Object(J.a)(h,"IconSetContainer",null,[])},1082:function(J,V,d){d.r(V);d.d(V,"NewCustomEventFactory",function(){return h});J=d(0);d=d(525);class h extends d.a{constructor(){super()}create(e,m){const n={};n.detail=m;return new CustomEvent(e,n)}}Object(J.a)(h,"NewCustomEventFactory",d.a,[])},1083:function(J,V,d){d.r(V);d.d(V,"IECustomEventFactory",function(){return h});J=d(0);d=d(525);class h extends d.a{constructor(){super()}create(e,m){const n=window.document.createEvent("CustomEvent");
n.initCustomEvent(e,!1,!1,m);return n}}Object(J.a)(h,"IECustomEventFactory",d.a,[])},1084:function(J,V,d){d.r(V);d.d(V,"CheckRoamingRightsRequest",function(){return h});J=d(0);d=d(930);class h extends d.a{constructor(){super()}wsb(){return 2}Ik(){return 1}}Object(J.a)(h,"CheckRoamingRightsRequest",d.a,[])},1085:function(J,V,d){d.r(V);d.d(V,"GetRoamingLauncherRequest",function(){return h});J=d(0);d=d(930);class h extends d.a{constructor(){super()}wsb(){return 0}Ik(){return 2}}Object(J.a)(h,"GetRoamingLauncherRequest",
d.a,[])},1086:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(195),e=d(93);class m{constructor(n){this.Ev=n;this.gM=Array.indexOf(this.Ev,this.Qha)}dispose(){this.Ev=null}get YY(){return this.Ev[this.gM]}fE(n){this.ljc(n,!1);return!0}F5a(n){this.ljc(n,!0)}ljc(n,v){n&&(this.YY!==n||v)&&(n.tabIndex=0,e.FocusManager.Dr(n));Array.contains(this.Ev,n)&&(this.gM=Array.indexOf(this.Ev,n))}get v6g(){let n=this.gM;do if(n)if(0<n&&n<this.Ev.length)n--;else break;else n=this.Ev.length-1;while(!h.DOMFocusListing.VAa(this.Ev[n])&&
n!==this.gM);return this.Ev[n]}get BUg(){let n=this.gM;do if(n===this.Ev.length-1)n=0;else if(0<=n&&n<this.Ev.length-1)n++;else break;while(!h.DOMFocusListing.VAa(this.Ev[n])&&n!==this.gM);return this.Ev[n]}get Qha(){let n=0;for(;!h.DOMFocusListing.VAa(this.Ev[n])&&n<this.Ev.length;)n++;return h.DOMFocusListing.VAa(this.Ev[n])?this.Ev[n]:null}get Rvb(){let n=this.Ev.length-1;for(;!h.DOMFocusListing.VAa(this.Ev[n])&&0<n;)n--;return h.DOMFocusListing.VAa(this.Ev[n])?this.Ev[n]:null}}Object(J.a)(m,"DialogFocusListing",
null,[185])},1087:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(296);class h{}h.Value="Value";h.Image16by16Class="Image16by16Class";h.Alt="Alt";h.Visible=d.a.visible;Object(J.a)(h,"LabelCommandProperties",null,[])},1096:function(J,V,d){d.r(V);J=d(0);var h=d(375),e=d(13),m=d(1158),n=d(25),v=d(138),A=d(449),w=d(266),y=d(192),u=d(55),E=d(69),G=d(35);class I{constructor(ob,cc,sb,mb,Pb){this.nxd=null;this.LO=!0;this.EO=null;this.Ca=ob;this.Kh=cc;this.qqd=sb;this.rUh=mb;this.Pg=Pb;n.AFrameworkApplication.Azc(Object(e.a)(this,
this.Pul,"updateLastError"));this.rUh.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(this.LO=n.AFrameworkApplication.aE,u.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(dc=>{dc.isFeatureEnabled("mso_sendASmile",!0).then(mc=>{this.LO=n.AFrameworkApplication.aE&&mc;this.Kh&&this.Kh.updateCommandUI();return null},()=>null)})):u.a.instance.La("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(dc=>
{dc.k2("Enabled").then(mc=>{this.LO=mc;return null},()=>null)})}get Pg(){this.EO||(n.AFrameworkApplication.Pg||(n.AFrameworkApplication.Pg=new A.a),this.EO=n.AFrameworkApplication.Pg);return this.EO}set Pg(ob){this.EO=ob}Pul(ob,cc){void 0!==cc&&null!==cc&&cc&&(this.nxd=cc.errorCode)}ub(){this.Ca.xa(G.a.giveFeedback,E.a.frame,Object(e.a)(this,this.pij,"giveFeedbackHandler"));this.Ca.xa(G.a.KQe,E.a.frame,Object(e.a)(this,this.KQe,"triggerFloodgateSurvey"));this.Kh.updateCommandUI()}KQe(ob,cc,sb,mb,
Pb){if(1===sb)return 32;if(2===sb&&!Pb)return 8;u.a.instance.La("Common.ISystemInitiatedFeedback").execute(dc=>{dc.logActivity(Object(m.a)(String,Pb.ActivityName),Object(m.a)(String,Pb.BRSName))});return 32}pij(ob,cc,sb,mb,Pb){if(1===sb)return n.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.LO=!1),this.LO&&y.SessionStatusManager.instance.Q2?32:8;if(2===sb){h.ULS.sendTraceTag(8405838,356,50,"");this.Pg.Feedback|=w.a.KPi;const dc=Pb||{};void 0!==dc.ErrorCode&&null!==dc.ErrorCode||
null==this.nxd||(dc.ErrorCode=this.nxd);n.AFrameworkApplication.fa.TAf(dc);this.qqd&&(this.qqd.instance||3===n.AFrameworkApplication.Aa.gb.Am&&1===n.AFrameworkApplication.Aa.gb.vGa||u.a.instance.pb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.qqd.execute(mc=>{n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OcvFeedbackvNextModalWacEnabled",!1)?v.UISurfaces.y8i().then(Mb=>{void 0!==Mb&&null!==Mb?(mc.PRj(dc,Mb),h.ULS.sendTraceTag(8405838,356,100,"Opened OCV vNext Modal")):
(h.ULS.sendTraceTag(520626707,356,15,"feedbackAPI not retrived"),mc.obe(dc));return Mb},()=>{h.ULS.sendTraceTag(520626706,356,15,"error while retieving feedbackAPI");mc.obe(dc);return null}):mc.obe(dc)}))}return 32}}Object(J.a)(I,"CustomerFeedbackActor",null,[1271]);class H{constructor(ob,cc,sb){this.cOb=this.Awd=!1;this.EO=this.GYe=null;this.l2a=ob;this.$vc=cc;this.Pg=sb}get Pg(){this.EO||(n.AFrameworkApplication.Pg||(n.AFrameworkApplication.Pg=new A.a),this.EO=n.AFrameworkApplication.Pg);return this.EO}set Pg(ob){this.EO=
ob}obe(ob){this.GYe=ob;this.Mlg()||this.O5b()}PRj(ob,cc){this.l2a.rbl(ob,cc)}O5b(){this.Awd||(this.Awd=!0,this.$vc.fSd(Object(e.a)(this,this.ogk,"oFeedbackJsDownloadFinished")))}ogk(ob){ob?(this.cOb=!0,this.Pg.Feedback|=w.a.OPi,this.Mlg(),h.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.Pg.Feedback|=w.a.NPi,h.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed"));this.Awd=!1}Mlg(){return this.cOb?(this.l2a.odl(this.GYe),!0):!1}Byg(ob){this.cOb=ob}}Object(J.a)(H,"CustomerFeedbackC3FormManager",
null,[1298]);var K=d(17),C=d(653),Y=d(169),M=d(230),P=d(279);class T{constructor(ob=null){this.wff=null;this.Juc=new K.a;this.BO=ob}fSd(ob){T.l5b()?this.Juc.add(ob):this.wff=ob;var cc="Feedback/officebrowserfeedback_floodgate.js";C.a.G8d()&&(cc="Feedback/latest/officebrowserfeedback_floodgate.js");ob="OFeedbackIntl";n.AFrameworkApplication.fa.Aw("IsServerFlavorDebug")&&n.AFrameworkApplication.fa.ka("IsServerFlavorDebug")&&(ob+=".debug");ob+=".js";cc=Y.a.CVb(cc);Y.a.Bpi(ob);ob=P.a.create(cc);ob.HR(Object(e.a)(this,
this.dlk,"onJsDownloadFinished"));M.a.wx(ob);h.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",cc)}L0k(ob){this.BO?ob&&this.BO.add(ob):this.BO=ob}dlk(ob,cc){if(T.l5b()){for(ob=0;ob<this.Juc.count;ob++)this.Juc.ga(ob)(cc.succeeded,this.BO);this.Juc.clear()}else this.wff(cc.succeeded,this.BO)}static l5b(){return!!n.AFrameworkApplication.Aa&&!!n.AFrameworkApplication.Aa.gb&&3===n.AFrameworkApplication.Aa.gb.Am&&1===n.AFrameworkApplication.Aa.gb.vGa}}Object(J.a)(T,"CustomerFeedbackResourceDownloadManager",
null,[1297]);class L{constructor(){this.audienceGroup=null;this.Hte=this.Neb=0}Uvg(){return!this.Hte}}Object(J.a)(L,"OCVData",null,[]);var aa=d(119),Q=d(195),ea=d(100);class ia extends Sys.EventArgs{constructor(ob){super();this.Yhl=ob}}Object(J.a)(ia,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var ja=d(167),D=d(73),pa=d(191),Z=d(33),oa=d(246),Ba=d(267),Ma=d(45),za=d(986),ka=d(77);class qa{constructor(ob,cc){this.R$j="obf-MainContentHolder";this.DSj="obf-OverallSmileAnchor";this.Nzl="obf-visible";
this.VKb=this.UKb=qa.edd;this.sud=this.rud=this.LO=!0;this.$5e=this.hkb=this.dsd=this.csd=this.dtc=this.Csc=this.PNb=!1;this.Gsc=!0;this.Nwd=this.rwd=this.EO=this.O6c=this.Ttd=this.CCd=null;this.lLh=n.AFrameworkApplication.fa.ka("FeedbackTabHandlerEnabled");this.Hd=ob;this.Pg=cc;this.Pa=new ka.a;if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)){const dc=this;u.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Mb=>
{Mb.isFeatureEnabled("mso_sendASmile",dc.LO).then(Kc=>{dc.LO=Kc;return null},()=>null);Mb.isFeatureEnabled("FloodgateSurvey",dc.dtc).then(Kc=>{dc.dtc=Kc;dc.dsd=!0;return null},()=>null)});const mc=this;u.a.instance.La("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Mb=>{Mb.k2("IncludeScreenshot").then(Kc=>{mc.PNb=Kc;return null},()=>null);Mb.k2("IncludeEmail").then(Kc=>{mc.Csc=Kc;mc.csd=!0;return null},()=>null)})}else{const dc=this;u.a.instance.La("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(mc=>
{mc.k2("Enabled").then(Mb=>{dc.LO=Mb;return null},()=>null);mc.k2("IncludeScreenshot").then(Mb=>{dc.PNb=Mb;return null},()=>null);mc.k2("IncludeEmail").then(Mb=>{dc.Csc=Mb;dc.csd=!0;return null},()=>null);mc.k2("SurveyEnabled").then(Mb=>{dc.dtc=Mb;dc.dsd=!0;return null},()=>null)})}if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",!0)){this.hkb=n.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled");const dc=this;u.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(mc=>
{dc.hkb=mc.isFreemiumUpsellEnabled();mc.isFeatureEnabled("mso_sendASmile",!1).then(Mb=>{dc.$5e=Mb;return null},()=>null)})}const sb=this;u.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(dc=>{dc.isFeatureEnabled("FeedbackForum",sb.Gsc).then(mc=>{sb.Gsc=mc;return null},()=>null)});const mb=this;u.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(dc=>{dc.isFeatureEnabled("FeedbackComplianceCannotConsent",mb.rud).then(mc=>{mb.rud=
mc;return null},()=>null)});const Pb=this;u.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(dc=>{dc.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",Pb.sud).then(mc=>{Pb.sud=mc;return null},()=>null)});C.a.G8d()?(this.CCd=Y.a.CVb("Feedback/latest/officebrowserfeedback.css"),this.Ttd=Y.a.dNd("Feedback/latest/Intl/")):(this.CCd=Y.a.CVb("Feedback/officebrowserfeedback.css"),this.Ttd=Y.a.dNd("Feedback/Intl/"))}get Pg(){this.EO||(n.AFrameworkApplication.Pg||
(n.AFrameworkApplication.Pg=new A.a),this.EO=n.AFrameworkApplication.Pg);return this.EO}set Pg(ob){this.EO=ob}get zbe(){return this.rwd||(this.rwd=document.getElementById(this.DSj))}get w4c(){return this.Nwd||(this.Nwd=document.getElementById(this.R$j))}P3h(ob){this.Pa.addHandler(qa.iYg,ob)}vmi(){this.Nwd=this.rwd=null}hFj(ob){return!!ob&&0<=ob.className.toLowerCase().indexOf(this.Nzl.toLowerCase())}rbl(ob,cc){n.AFrameworkApplication.aE?this.LO&&(h.ULS.sendTraceTag(520626705,356,15,"Feedback api retrieved"),
ob=ob||{},this.getContext(ob),cc.initializeFeedbackModal(ob),h.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus."),this.Pg.Feedback|=w.a.c2f):h.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible")}odl(ob){if(!n.AFrameworkApplication.aE)h.ULS.sendTraceTag(520626704,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");else if(this.LO){ob=ob||
{};this.getContext(ob);var cc=qa.mFi(ob.AppMode||"Unknown");za.a.init(Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"),356,cc,ob);this.hxj();qa.allowKeytips(!1);h.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus.");this.Pg.Feedback|=w.a.c2f}}xQi(ob,cc){cc&&2>=cc.Neb?((cc=n.AFrameworkApplication.fa.Ha("UserPrincipalName"))&&0<cc.length&&(ob.userEmail=cc),ob.userEmailConsentDefault=!0):ob.userEmail=""}o6f(ob){const cc={};if(void 0!==
ob.appData&&null!==ob.appData){var sb=ob.appData;for(var mb in sb)cc[mb]=sb[mb]}cc.App=ob.Application||"";cc.AppMode=ob.AppMode||"";cc.AppModeExt=ob.ApplicationMode||"";cc.Host=ob.Host||"";cc.Language=ob.locale;cc.IsError=ob.Error||!1;cc.IsCrash=ob.Crash||!1;cc.ServerDocId=ob.ServerDocId||"";ob.ErrorCode&&""!==ob.ErrorCode.toString()&&(cc.IsError=!0);"Origin"in ob&&(cc.Origin=ob.Origin);cc.ClientThrottlingProtection=this.Pg.ClientThrottlingProtection||"";cc.HostServiceLevel=this.Pg.HostServiceLevel||
"";cc.RequestedCallThrottling=this.Pg.RequestedCallThrottling||"";cc.WacServiceLevel=this.Pg.WacServiceLevel||"";this.Pg.HostResponseStats&&(sb=this.Pg.HostResponseStats.Label)&&(cc.HostFarmHint=sb);sb=n.AFrameworkApplication.fa;(mb=sb.Ha(n.AFrameworkApplication.oJ))&&""!==mb&&(cc.UiHost=mb);(mb=sb.Ha(n.AFrameworkApplication.rzh))&&""!==mb&&(cc.UiHostIntegrationType=mb);sb.ka("OcvFeedbackIncludesSessionOriginIsEnabled")&&(sb=ob.SessionOrigin,sb&&""!==sb||(ob=ob.SourceControlId)&&""!==ob&&oa.a(oa.d(ob),
"feedback")&&(sb=this.a8f().SessionOrigin),sb&&""!==sb&&(cc.SessionOrigin=sb));ob=null;try{ob=Z.c(cc),ob=Ma.a.jba(ob,Ma.a.Mvb)}catch(Pb){ob="",h.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData:"+Pb.message)}return{["appData"]:ob||""}}F0i(ob){const cc={};for(let sb in ob)cc[sb]=ob[sb];cc.IsFreemiumUpsellEnabled=this.hkb;cc.IsAadcEnabled=this.$5e;cc.IsFeedbackEnabled=this.LO;return cc}I0i(){let ob=null;try{const cc=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",
null);cc&&(ob=Z.b(cc))}catch(cc){h.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return ob||{}}o_i(ob,cc){if(ob&&cc){ob.LanguageID?ob.locale=Ba.a.le(ob.LanguageID).name||"":ob.ApplicationLCID&&(ob.locale=ob.ApplicationLCID);ob.applicationGroup=this.o6f(ob);ob.applicationSettings=this.F0i(n.AFrameworkApplication.fa.appSettings);ob.webSurfacesSettings=this.I0i();qa.XVf(cc,ob);ob.appId=qa.rFi();ob.environment=cc.Hte;ob.stylesUrl=this.CCd;ob.intlUrl=this.Ttd;ob.rtl=
n.AFrameworkApplication.fa.ka("Rtl")?"rtl":"ltr";var sb=qa.qFi();ob.primaryColour=sb.primaryColour;ob.secondaryColour=sb.secondaryColour;ob.sessionId=ob.SessionID||ob.WACSessionID||"";ob.build=ob.ApplicationVersion||ob.WFEVersion||"";sb=ob.FlightIDs?ob.FlightIDs.toString():ob.Flights?ob.Flights.toString():"";var mb="";ob.ErrorCode&&(mb=ob.ErrorCode.toString());var Pb=this.E9i(ob),dc=cc.Uvg()?n.AFrameworkApplication.fa.Ha("TenantId"):"";if(!dc||n.AFrameworkApplication.fa.ka("TenantIdValidationForOCVFeedbackEnabled")&&
"0"===dc)dc="";var mc=n.AFrameworkApplication.fa.Ha("LoggableUserIdSpace"),Mb=n.AFrameworkApplication.fa.Ha("LoggableUserId")||"";switch(mc){case "MsaPuid":Mb="p:"+Mb;break;case "MsaCid":Mb="m:"+Mb;break;case "OrgIdPuid":Mb="a:"+(n.AFrameworkApplication.fa.Ha("AADUserObjectId")||Mb);break;default:h.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: "+Mb+", LoggableUserIdSpace: "+mc),Mb=""}mc={};if(void 0!==ob.telemetryGroup&&null!==ob.telemetryGroup){const Kc=ob.telemetryGroup;
for(let gc in Kc)mc[gc]=Kc[gc]}mc.audienceGroup=cc.audienceGroup;mc.audience=cc.audienceGroup;mc.flights=sb;mc.platform=Pb;mc.ringId=cc.Neb;mc.officeUILang=n.AFrameworkApplication.lcid;mc.errorCode=mb;mc.loggableUserId=Mb;mc.processSessionId=ob.SessionID||ob.WACSessionID||"";mc.officeBuild=ob.ApplicationVersion||ob.WFEVersion||"";0<dc.length&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==dc&&(mc.tenantId=dc);ob.telemetryGroup=mc;ob.webGroup={["browser"]:ob.Browser||"",["browserVersion"]:(ob.BrowserMajorVersion||
"")+"."+(ob.BrowserMinorVersion||""),["dataCenter"]:ob.Datacenter||ob.WACDatacenter||""};ob.isCommercialHost=n.AFrameworkApplication.fa.ka("IsO365CommercialHost");this.kFi(ob);ob.disableIncludeScreenshot=!this.PNb;ob.screenshot=this.PNb;ob.showEmailAddress=this.Csc;ob.emailPolicyValue=this.Csc?1:0;ob.screenshotPolicyValue=this.PNb?1:0;n.AFrameworkApplication.fa.ka("IsO365CommercialHost")||(ob.disableIncludeScreenshot=!1,ob.showEmailAddress=!0,ob.screenshot=!0);n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1)&&(ob.surveyEnabled=this.dtc,n.AFrameworkApplication.fa.ka("IsO365ConsumerHost")&&(ob.showEmailAddress=!0,ob.surveyEnabled=!0));this.xQi(ob,cc);this.O6c=ob.DismissHandler?ob.DismissHandler:null;this.iFi(ob)}}b$h(){return this.csd&&this.dsd}getContext(ob){ob=ob||this.a8f();const cc=new L;this.o_i(ob,cc);return ob}E9i(ob){let cc="";ob.Platform&&(cc=ob.Platform.toString());ob.PlatformMajorVersion&&(0<cc.length&&(cc+=" "),cc+=ob.PlatformMajorVersion.toString()+".");ob.PlatformMinorVersion&&(cc+=ob.PlatformMinorVersion.toString());
return cc}mgl(ob){ob.ApplicationMode&&(ob.AppMode=ob.ApplicationMode);ob.ApplicationModeExtended&&(ob.ApplicationMode=ob.ApplicationModeExtended)}a8f(){let ob;try{ob=Z.b(n.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),this.mgl(ob)}catch(cc){h.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),ob={}}return ob}onError(ob){h.ULS.sendTraceTag(37259477,356,10,"FB submit error: "+ob);this.Pg.Feedback|=w.a.MPi;qa.allowKeytips(!0)}zHi(){if(qa.Gug()){h.ULS.sendTraceTag(40112215,
356,50,qa.pVg);var ob=u.a.instance.resolve("Common.ISystemInitiatedFeedback");ob&&ob.logActivity("AppUsageNPSLocalizationTest",null)}}onDismiss(ob){this.cma();this.vmi();ja.a.RBb()&&h.ULS.sendTraceTag(34936718,356,50,"FB dismiss");ja.a.pSa()&&ea.c(ob?G.a.JPi:G.a.EPi,!0,null,2,8);ob?(ja.a.RBb()&&h.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.Pg.Feedback|=w.a.PPi):(this.Pg.Feedback|=w.a.LPi,this.zHi());this.Pa.raiseEvent(qa.iYg,new ia(ob));qa.allowKeytips(!0);this.O6c&&(this.O6c(),this.O6c=null)}hxj(){if(this.Hd){let ob=
!1,cc=5,sb=!1;this.VKb=this.clearInterval(this.VKb);this.UKb=this.clearInterval(this.UKb);this.UKb=window.setInterval(()=>{if(this.zbe){sb=!0;var mb=this.Hd.Bc(qa.r4a);mb.IK=!0;mb.parent=aa.AFrame.gj;mb.G2a(qa.BCi);mb.zaa(()=>{let Pb=this.Hd.zP(qa.r4a),dc=null,mc=5,Mb=!1;this.VKb=window.setInterval(()=>{this.hFj(this.w4c)&&(Mb=!0,this.zbe.focus(),Pb||(Pb=this.Hd.zP(qa.r4a)),Pb&&!dc&&(dc=Pb.qj),dc&&dc.fE(this.zbe));mc--;if(Mb||!mc)this.VKb=this.clearInterval(this.VKb)},1E3)});ob||(this.Hd.oX(qa.r4a,
!0),ob=!0);this.lLh&&this.w4c&&(mb=new Q.DOMFocusListing(()=>this.w4c),mb.mo(1),mb.mo(2),mb.mo(3),mb.mo(5),mb=this.Hd.aha(()=>this.w4c,this.Hd.Bc(qa.r4a),mb),mb.ieb(),mb.cW=!0,mb.PNa=!0,mb.wTg())}cc--;if(sb||!cc)this.UKb=this.clearInterval(this.UKb)},1E3)}}clearInterval(ob){ob!==qa.edd&&(window.clearInterval(ob),ob=qa.edd);return ob}cma(){this.Hd&&(this.Hd.s4(qa.r4a),this.Hd.zEb(qa.r4a))}iFi(ob){this.rud?this.sud||(ob.ageGroup=4):ob.ageGroup=3;n.AFrameworkApplication.fa.ka("IsAnonymousUser")?ob.authenticationType=
2:ob.authenticationType="aad"===n.AFrameworkApplication.fa.Ha("HostAuthType")?1:0}kFi(ob){this.Gsc&&(ob.myFeedbackForumUrl="https://go.microsoft.com/fwlink/?linkid=2171883",ob.MyFeedbackPortalUrl="https://go.microsoft.com/fwlink/?linkid=2171883");if(this.Gsc){const cc=qa.lFi();void 0!==cc&&null!==cc&&(ob.feedbackPortalUrl=cc,ob.feedbackForumUrl=cc)}}static allowKeytips(ob){n.AFrameworkApplication.Aa.gb.uo&&D.a("allowKeytips")&&appChrome.api.allowKeytips(ob)}static XVf(ob,cc){if(cc){ob.Neb=parseInt(cc.Ring);
if(isNaN(ob.Neb))ob.audienceGroup="Unknown",ob.Neb=-2;else switch(ob.Neb){case 0:case 1:ob.audienceGroup="Dogfood";break;case 2:ob.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:ob.audienceGroup="Production";break;default:ob.audienceGroup="Unknown"}var sb=!0;cc.Host&&(sb="MsInternal"!==cc.Host&&"Blue Chicken"!==cc.Host);ob.Hte=sb?0:1}}static rFi(){let ob=0;switch(pa.Redirect.application){case 2:ob=2155;break;case 4:ob=2158;break;case 3:ob=2157;break;case 1:ob=2156;break;case 5:ob=2159;
break;default:h.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",pa.Redirect.application.toString())}return ob}static qFi(){const ob={};let cc="#2B579A",sb="#3C65A4";switch(pa.Redirect.application){case 2:n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.ka("AppColorUpdateIsEnabled")?(cc="#185ABD",sb="#2E6AC5"):(cc="#2B579A",sb="#3C65A4");break;case 4:cc="#7719AA";sb="#9953C0";break;case 3:cc="#B7472A";sb="#C75033";break;case 1:cc="#217346";sb="#3F8159";break;case 5:cc="#3955A3";
sb="#4D6AB8";break;default:h.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",pa.Redirect.application.toString())}ob.primaryColour=cc;ob.secondaryColour=sb;return ob}static lFi(){let ob=null;switch(pa.Redirect.application){case 2:ob="https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";break;case 4:ob="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";break;case 3:ob="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";break;case 1:ob="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";
break;case 5:ob="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:h.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",pa.Redirect.application.toString())}return ob}static mFi(ob){let cc=356;switch(pa.Redirect.application){case 2:switch(ob){case "Edit":cc=364;break;case "View":case "Attendee":case "Presenter":cc=363;break;default:h.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",n.AFrameworkApplication.Aa.HVa),
cc=363}break;case 4:cc=362;break;case 3:switch(ob){case "Edit":cc=361;break;case "View":case "Attendee":case "Presenter":case "Outline":case "":cc=360;break;default:h.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",n.AFrameworkApplication.Aa.HVa),cc=360}break;case 1:switch(ob){case "Edit":cc=358;break;case "View":cc=357;break;case "Survey":cc=359;break;default:h.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",
n.AFrameworkApplication.Aa.HVa),cc=357}break;case 5:switch(ob){case "View":cc=373;break;case "Edit":cc=374;break;default:h.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",n.AFrameworkApplication.Aa.HVa),cc=373}break;default:h.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",pa.Redirect.application.toString())}return cc}static BCi(){h.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static Gug(){if(!qa.wte){const ob=
!!n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.ka(qa.pVg);qa.wte=ob?2:1}return 2===qa.wte}}qa.r4a="CustomerFeedbackFocusId";qa.iYg="FUID";qa.edd=-1;qa.wte=0;qa.pVg="NPSLocalizationTestingIsEnabled";Object(J.a)(qa,"CustomerFeedbackUiWrapper",null,[1295]);var Ja=d(14),xa=d(1159),Ga=d(1160);class na{constructor(ob,cc,sb,mb){this.cXe=ob;this.hfa=cc;this.bXe=sb;this.TQh=mb}activityName(){return this.hfa}object(){return this.TQh}}Object(J.a)(na,"OneCallBackData",null,[]);class sa{constructor(ob,
cc,sb,mb){this.eKa=[];Array.add(this.eKa,new na(ob,cc,sb,mb))}add(ob){ob&&Array.addRange(this.eKa,ob.eKa)}xmi(){Array.clear(this.eKa)}}Object(J.a)(sa,"CallBackData",null,[]);var Ha=d(654);class cb extends Ha.a{constructor(ob,cc,sb=null,mb=!1,Pb=!1,dc=null,mc=null,Mb=null){super("FloodgateTeachingCallout");this.image=this.footer=this.message=this.smallHeadline=this.title=null;this.positionImageAtLeft=!1;this.secondaryButtonProps=this.primaryButtonProps=null;this.footer=ob;this.message=cc;this.image=
sb;this.positionImageAtLeft=mb;this.smallHeadline=Pb;this.title=dc;this.primaryButtonProps=mc;this.secondaryButtonProps=Mb}}Object(J.a)(cb,"FloodgateCalloutContent",Ha.a,[]);class Za{constructor(){this.I7g=this.options=null}}Object(J.a)(Za,"Notification",null,[]);var va=d(1077),Fa=d(907),Ca=d(340);class La extends Ha.a{constructor(ob,cc,sb=null,mb=null){super("PremiumUpsellCallout");this.imageHeight=this.imageProps=this.content=this.title=null;this.title=ob;this.content=cc;this.imageProps=sb;this.imageHeight=
mb}}Object(J.a)(La,"PremiumUpsellCalloutContentProps",Ha.a,[]);var nb=d(908);class Nb{constructor(ob){this.alt=this.ariaLabel=this.src=null;this.src=ob}}Object(J.a)(Nb,"ImageProps",null,[]);class Rb{static TNd(ob){return Rb.H$i().then(cc=>{try{const sb=[];for(let mb=0;mb<ob.length;mb++){const Pb=ob[mb],dc=Rb.YNj(Pb.surfaceType),mc=new Za;mc.options=Rb.n8i(Pb,!dc);mc.I7g=dc?cc.callout(Rb.gak(ob[mb])):cc.externalNotification();sb.push(mc)}return Rb.Abl(cc,sb)}catch(sb){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+
sb.message);}})}static YNj(ob){switch(ob.toLowerCase()){case "teaching":case "coachmark":case "sequence":case "premiumupsell":return!0;default:return!1}}static n8i(ob,cc){const sb=new Ca.a;cc&&(sb.onShow=ob.onUnsupportedSurfaceType);sb.telemetryId="FloodgateTeachingUx-Surface"+(cc?"NotSupported":"Supported");return sb}static gak(ob){var cc="premiumupsell"!==ob.surfaceType.toLowerCase()?new cb(ob.footer,ob.description,ob.illustrationImage?Object.assign(new Nb(ob.illustrationImage),{ariaLabel:ob.imageAriaLabel}):
null,"left"===ob.position,ob.smallHeadline,ob.title,Rb.CKc(ob.primaryButtonText,ob.primaryButtonAction),Rb.CKc(ob.secondaryButtonText,ob.secondaryButtonAction)):new La(ob.title,ob.description,ob.illustrationImage?Object.assign(new Nb(ob.illustrationImage),{ariaLabel:ob.imageAriaLabel}):null);cc=Object.assign(new Fa.a,{target:ob.selector,content:cc,showCloseIcon:null!=ob.hasCloseButton?ob.hasCloseButton:!0,preventLightDismiss:null!=ob.preventAutoDismiss?ob.preventAutoDismiss:!1,useTeachingStyles:!0,
calloutProps:Object.assign(new nb.a,{onDismiss:()=>{if(ob.onClosed)ob.onClosed("close")},directionalHint:ob.anchorHint,setInitialFocus:!0})});"coachmark"===ob.surfaceType.toLowerCase()?(cc.hasDynamicSizing=!1,cc.useCoachmark=!0,cc.calloutProps.setInitialFocus=!1):"premiumupsell"===ob.surfaceType.toLowerCase()&&(cc.primaryButtonProps=Rb.CKc(ob.primaryButtonText,ob.primaryButtonAction),cc.secondaryButtonProps=Rb.CKc(ob.secondaryButtonText,ob.secondaryButtonAction),cc.showCloseIcon=!1,cc.useTeachingStyles=
!1,cc.calloutProps.preventDismissOnLostFocus=!1);return cc}static CKc(ob,cc){return ob&&""!==ob&&cc?Object.assign(new va.a,{label:ob,onExecute:cc}):(h.ULS.shipAssertTag(594569111,356,(!ob||""===ob)&&!cc,"A callout button needs both a caption and an action."),null)}static H$i(){Rb.sJc||(n.AFrameworkApplication.Aa.gb.ZRa&&n.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled")?Rb.sJc=v.UISurfaces.VM().then(ob=>{const cc=new cb(null,null);if(ob.isCustomContentSupported&&ob.isCustomContentSupported(cc))return ob;
throw Error.create("Custom Content not supported: "+cc.type);},ob=>{h.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",ob);return null}):Rb.sJc=Promise.reject("React Notifications not enabled"));return Rb.sJc}static Abl(ob,cc){if(!cc||!cc.length)return[];const sb=[];for(let mb=0;mb<cc.length;mb++){const Pb=Rb.ncl(ob,cc[mb]);sb.push(Pb)}return sb}static ncl(ob,cc){const sb=ob.addNotification(cc.I7g,cc.options);return()=>{ob.removeNotification(sb)}}}Rb.sJc=null;Object(J.a)(Rb,
"FloodgateNotifications",null,[]);const Ya=(ob,cc)=>{ob=n.AFrameworkApplication.fa.Ha("UserPrincipalName");if(cc=!!cc.FVg&&2===cc.FVg.Neb)cc=(cc=ob.toLowerCase())?0<cc.indexOf("linkedin.com")||0<cc.indexOf("linkedin.biz"):!1;return cc};class Qb{constructor(ob,cc){this.FVg=ob;this.context=cc}}Object(J.a)(Qb,"SurveyMetadata",null,[]);var bb=d(65),Bb=d(268),Eb=d(89),tb=d(78);class Yb{constructor(ob){this.ERa=this.isInitialized=!1;this.uha=this.tib=null;this.xZa=!1;this.hOe=null;this.Lsg=!1;this.TFc=
0;this.PUf=-1;this.Eye=this.SFc=null;this.M1b=!0;this.oP=ob;this.mmc={};this.QGf=!1;this.YEb=this.oa=null;this.rJc=0}Eyj(ob){this.isInitialized&&this.tib||this.ERa?h.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."):null===ob?h.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"):(this.xZa=ob.xZa,h.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"))}uyj(){const ob=
this.oP.getContext(null),cc=new L;qa.XVf(cc,ob);this.hOe=new Qb(cc,ob);this.YEb=new Ja.ScriptSharpLegacyMap;this.YEb.$("LinkedInWACUsage",Ya)}get knb(){this.tib||(this.tib=u.a.instance.pb("Common.App.IAppSpecificFeedbackData"));return this.tib}logActivity(ob,cc,sb=null){ob&&this.x5a(ob,Yb.bcb,cc)&&(this.isInitialized?(h.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+ob),za.a.logActivity(ob,sb)):(h.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+ob),this.J5d(new sa(za.a.logActivity,
ob,null,sb))))}Zbe(ob){try{n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",!1)&&h.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+ob),-1===this.PUf&&(this.PUf=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",Yb.sUf)),this.SFc||(this.SFc=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList"," ").toString().toLowerCase()),
!n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.SFc&&ob&&ob.startsWith("Ribbon_")&&-1===this.SFc.indexOf(ob.toLowerCase())?h.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored"):this.isInitialized?(0<this.TFc&&n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",!1)&&(window.clearTimeout(this.TFc),h.ULS.sendTraceTag(592217693,356,50,"SIFB: LogActivityDeferred cancelled "+
ob)),this.TFc=window.setTimeout(()=>{this.TFc=0;this.logActivity(ob,null)},Yb.sUf)):h.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+ob)}catch(cc){h.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+(cc?cc.toString():""))}}S5b(ob,cc){ob&&this.x5a(ob,Yb.bcb,cc)&&(this.wAg(ob,cc),this.mmc[ob]=cc)}wAg(ob,cc){this.x5a(ob,Yb.bcb,cc)&&(this.isInitialized?(h.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+ob),za.a.S5b(ob,
null)):(h.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+ob),this.J5d(new sa(za.a.S5b,ob,null,null))))}uAg(ob){ob&&this.isInitialized&&this.x5a(ob,Yb.bcb,void 0)&&(ob in this.mmc&&delete this.mmc[ob],this.vAg(ob,void 0))}vAg(ob,cc){this.isInitialized&&this.x5a(ob,Yb.bcb,cc)&&(h.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+ob),za.a.uAg(ob))}hHb(ob,cc){if(this.x5a(ob,Yb.bcb,cc))if(this.knb){if(cc=this.knb.M1d(ob))this.isInitialized?(h.ULS.sendTraceTag(38605911,
356,50,"SIFB:ShowUserInitiatedSurvey "+ob),za.a.hHb(cc)):(h.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+ob),this.J5d(new sa(null,null,za.a.hHb,cc)))}else h.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null")}x5a(ob,cc,sb){if(this.ERa)return!1;if(!n.AFrameworkApplication.aE)return h.ULS.sendTraceTag(37601796,356,50,"SIFB: All feedback/floodgate is disabled"),!1;if(!this.bGj())return!1;this.zvi();return(this.UEj(ob)||this.nCi(ob)||this.CBj(ob))&&
this.yci(cc,sb)&&this.Bil(ob)}zvi(){if(!this.tib){const ob=u.a.instance.pb("Common.App.IAppSpecificFeedbackData");ob?this.tib=ob:h.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}}cGj(ob){return 6!==ob}bGj(){if(0===this.rJc){const ob=this.oP.getContext(null);this.rJc=this.cGj(parseInt(ob.Ring))?1:2;2===this.rJc&&h.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.rJc}Bil(ob){null===this.YEb&&this.uyj();
return ob&&this.YEb&&this.YEb.Jb(ob)?this.YEb.ga(ob)(ob,this.hOe):!0}z0i(){if(!this.uha&&!this.QGf){this.QGf=!0;const ob=this.oP.getContext(null);this.uha="locale"in ob?ob.locale:"";this.uha=this.uha.toLowerCase()}return this.uha}nCi(ob){this.uha||(this.uha=this.z0i());if(!(this.uha&&this.uha.length&&ob&&ob.length))return!1;let cc="en-us"===this.uha||this.bJj(ob)||qa.Gug();!cc&&this.SIj(ob)&&(cc=this.TIj(this.uha));return cc}SIj(ob){return this.knb?"AppUsageNPS"===ob||"AppUsageTimeSatisfiedNPS"===
ob||"SuiteUsageNPS"===ob||"SuiteUsageTimeSatisfiedNPS"===ob:(h.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+ob),!1)}UEj(ob){return!!ob&&-1!==ob.toLowerCase().indexOf("floodgateflight")}bJj(ob){return!!ob&&-1!==ob.toLowerCase().indexOf("nlqs")}TIj(ob){if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAllNpsLanguages",!1))return!0;if(!ob||!ob.length)return!1;if(!n.AFrameworkApplication.fa.ka("WacNPSLocalizedLanguagesEnabled"))return"en-us"===
ob;let cc=!1;switch(ob){case "en-us":case "es-es":case "ja-jp":case "en-gb":case "pt-br":case "nl-nl":case "de-de":case "fr-fr":case "sv-se":case "fi-fi":case "nb-no":case "da-dk":case "ru-ru":case "es-mx":case "pl-pl":case "zh-cn":case "zh-tw":case "it-it":case "ko-kr":cc=!0}return cc}yci(ob,cc){return n.AFrameworkApplication.fa.ka(ob)?cc&&!n.AFrameworkApplication.fa.ka(cc)?(h.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+cc+") is off"),!1):!0:(h.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+
ob+") is off"),!1)}CBj(ob){const cc=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!ob&&!!cc&&-1!==cc.toLowerCase().indexOf(ob.toLowerCase())}J5d(ob){if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1))n.AFrameworkApplication.fa.ff(()=>{try{this.dHc(ob)}catch(cc){h.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+
cc)}});else try{this.dHc(ob)}catch(cc){h.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+cc)}}Ndc(){this.xZa||this.start()}Mpk(){this.xZa||this.stop()}bNe(){this.xZa&&this.start()}khl(){this.xZa&&this.stop()}start(){h.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized);if(this.isInitialized)if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",!1)){const ob=tb.a.bFc(n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateAfterIdleCallbackDelayMs",
10),Object(e.a)(this,this.Lsh,"startSurvey"),n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1E3));n.AFrameworkApplication.ue.Gb(ob)}else this.Lsh(null)}Lsh(){za.a.gTi();this.Yll()}stop(){h.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized);this.isInitialized&&(this.Xll(),za.a.hTi())}Yll(){const ob=this.mmc;for(let cc in ob)this.wAg(cc,ob[cc])}Xll(){const ob=this.mmc;for(let cc in ob)this.vAg(cc,ob[cc])}dHc(ob){h.ULS.sendTraceTag(36546388,
356,100,"SIFB: Entered DownloadResources");var cc=u.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");cc&&(cc.cOb?this.$3f(!0,ob):(cc=u.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),cc.L0k(ob),cc.fSd(Object(e.a)(this,this.$3f,"floodgateJsDownloadFinished"))))}$3f(ob,cc){h.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+ob);let sb="";cc&&cc.eKa&&0<cc.eKa.length&&(sb=cc.eKa[0].activityName());
if(ob)if(C.a.G8d())if(this.isInitialized)this.RRd(cc);else{if(this.ERa||!this.Eye)this.Eye=this.Y4g();this.Eye.then(()=>{this.RRd(cc)}).catch(mb=>this.Z4g(sb,mb))}else this.Y4g().then(()=>{this.RRd(cc)}).catch(mb=>this.Z4g(sb,mb));else this.ERa=!0,h.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+sb)}Z4g(ob,cc){this.ERa=!0;h.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+ob+". "+cc.toString())}iTi(ob){this.oa||this.Ayj();let cc=
ob;ob&&0<ob.length&&(cc=this.oa&&this.oa.Jb(ob)?this.oa.ga(ob):ob);return cc?cc:""}Y4g(){var ob=u.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");ob&&ob.Byg(!0);this.h7k();this.I6k();this.initOptions();if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&n.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return this.oXi().then(cc=>{this.gce(cc);return cc}).then(cc=>za.a.y5d(Object(e.a)(this,
this.cwe,"onSIFeedbackDismiss"),Object(e.a)(this.oP,this.oP.onError,"onError"),cc,Object(e.a)(this.oP,this.oP.onDismiss,"onDismiss")));if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&n.AFrameworkApplication.fa.ka("IsO365CommercialHost")&&n.AFrameworkApplication.fa.ka("OcpsIsEnabled"))return Yb.RDi(this.B$f()).then(()=>{const cc=this.UWd();this.gce(cc);return cc}).then(cc=>za.a.y5d(Object(e.a)(this,this.cwe,"onSIFeedbackDismiss"),
Object(e.a)(this.oP,this.oP.onError,"onError"),cc,Object(e.a)(this.oP,this.oP.onDismiss,"onDismiss")));ob=this.UWd();this.gce(ob);return za.a.y5d(Object(e.a)(this,this.cwe,"onSIFeedbackDismiss"),Object(e.a)(this.oP,this.oP.onError,"onError"),ob,Object(e.a)(this.oP,this.oP.onDismiss,"onDismiss"))}oXi(){return new Promise(ob=>{u.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(cc=>{const sb=this.UWd();cc.isFeatureEnabled("FloodgateSurvey",!0).then(mb=>{sb.surveyEnabled=
"surveyEnabled"in sb?mb&&sb.surveyEnabled:mb;ob(sb);return null},mb=>{h.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",mb.toString());ob(sb);return null})})})}H0i(){let ob=null;try{const cc=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",null);cc&&(ob=Z.b(cc))}catch(cc){h.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return ob||{}}UWd(){const ob=this.oP.getContext(null);
ob.FloodgateUIAutoDismissTimeEnum=this.dYi();ob.uIStringGetter=Object(e.a)(this,this.iTi,"floodgateUIStringGetter");ob.authTokenCallback=Yb.Gvi(Object(m.a)(String,ob.AudienceGroup));ob.augLoopCallback=Yb.Evi();ob.onTeachingCampaignRender=Yb.TNd;ob.governanceServiceEnabled=Yb.V9f();ob.governanceServiceConfig=Yb.J3i();ob.personalizerEnabled=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);ob.messagingServiceSettings=this.H0i();ob.isPriorityEnabled=
Yb.g$i();return ob}gce(ob){const cc=this.oP.b$h(),sb=this.B$f(),mb=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1),Pb=n.AFrameworkApplication.fa.ka("IsO365CommercialHost"),dc=n.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),mc=n.AFrameworkApplication.fa.ka("OcpsIsEnabled"),Mb="surveyEnabled"in ob?ob.surveyEnabled:"null or undefined",Kc="showEmailAddress"in ob?ob.showEmailAddress:"null or undefined",gc=Yb.V9f(),rb=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",
!1);h.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}", "governanceServiceEnabled": "{8}", "governanceServiceConfig": "{9}", "personalizerEnabled": "{10}"',cc,mb,Pb,dc,mc,sb,Kc,Mb,gc,Z.c(ob.governanceServiceConfig),rb)}dYi(){return Ya(null,this.hOe)?
(h.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgatePromptAutoDismissEnum",n.AFrameworkApplication.fa.Ec("FloodgateUIAutoDismissTimeEnum",2))}B$f(){return n.AFrameworkApplication.fa.Ec("FloodgateContextAndInitDelayInMilliSeconds",Yb.wDi)}RRd(ob){this.isInitialized=!0;this.e2h();za.a.p1k(Object(e.a)(this,this.$Xj,"logTriggerEvent"));if(ob){for(const cc of ob.eKa)cc.cXe?(0,cc.cXe)(cc.activityName(),
cc.object()):cc.bXe?(0,cc.bXe)(cc.object()):h.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");ob.xmi()}else h.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const cc=this.oP.getContext(null),sb=za.a.B9f(Array.isArray(cc.Flights)?cc.Flights:null),mb=sb?Object(m.a)(String,sb.SelfTriggerActivity):null;if(mb)for(const Pb of mb.split(";"))Pb&&""!==Pb&&this.logActivity(Pb,null)}catch(cc){h.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+
(cc?cc.toString():""))}}e2h(){if(!this.Lsg&&window.addEventListener){const ob=Object(e.a)(this,this.Jpk,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",ob,!0);this.Lsg=!0}}DAg(ob,cc){ob&&(n.AFrameworkApplication.Qj(ob),n.AFrameworkApplication.Z5b(ob));h.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+cc)}iEj(ob){if(!ob)return!1;try{const cc=(n.AFrameworkApplication.fa.Ha("FlightId")||"").toLocaleLowerCase(),sb=ob.toString().toLocaleLowerCase().split(";");for(const mb of sb)if(2<
mb.length&&(mb.lastIndexOf("-control")===mb.length-8||mb.lastIndexOf("cf")===mb.length-2&&-1!==cc.indexOf(mb)))return!0}catch(cc){h.ULS.sendTraceTag(512505555,306,50,"Error serializing campaign event -"+(cc?cc.toString():""))}return!1}$Xj(ob,cc){cc=cc||{};if(ob&&!("isControl"in cc)){const sb=this.iEj(ob);sb&&(cc.isControl=sb)}this.DAg(ob,JSON.stringify(cc))}Jpk(ob){if(ob=ob?ob.detail:null){var cc=!n.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled"),sb=(ob.action||"").toLowerCase();
switch(sb){case "dismissed":cc&&Bb.a.instance.qo("obf-DynamicWebSurfaces");break;case "updated":cc&&za.a.kpa("obf-DynamicWebSurfaces");break;case "opened":case "":sb=ob.telemetryEventName;let mb;try{mb=JSON.stringify(ob)}catch(Pb){mb="id : "+ob.id+" telemetryEventName: "+sb,h.ULS.sendTraceTag(51131789,306,50,"Error serializing campaign event. "+mb+" Error: "+(Pb?Pb.toString():""))}ob.success?this.DAg(sb,mb):h.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+mb);ob.isHidden||ob.isAA||
!cc||za.a.kpa("obf-DynamicWebSurfaces");break;default:h.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+sb)}}}Tol(ob){var cc=["Live"];if(!ob)return null;try{const sb=Z.b(ob),mb=new K.a;for(const Pb of sb){const dc=Pb.Tags;if(dc)for(const mc of cc)Array.contains(dc,mc)&&mb.add(Pb)}return Z.c(mb.toArray())}catch(sb){return h.ULS.sendTraceTag(523904348,356,10,"Could not deserialize CampaignDefinitionsJson"),null}}h7k(){let ob=!1,cc=null;const sb=this.hMc();if(sb&&this.knb)try{let mb=this.knb.WYi();
n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.FilterOfficeLiveSurvey",!1)&&n.AFrameworkApplication.hsa&&(mb=this.Tol(mb));mb?(sb.setItem(Yb.jii,mb),ob=!0):(cc="SIFB.campaign str was null",h.ULS.sendTraceTag(594143442,356,10,cc))}catch(mb){cc="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+mb,h.ULS.sendTraceTag(594143441,356,50,cc)}else this.knb?(cc="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",h.ULS.sendTraceTag(594143440,
356,50,cc)):(cc="SIFB.Floodgate surveys not available. App Specific Feedback data was null",h.ULS.sendTraceTag(556896920,356,50,cc));h.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+ob+" errorString: "+(cc?cc:"null"))}cwe(ob,cc){ja.a.RBb()&&h.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",cc,ob);ja.a.pSa()&&ea.c(cc?G.a.Xxl:G.a.Wxl,!0,null,2,8);Bb.a.instance.qo(za.a.Z3f)}initOptions(){}I6k(){this.xZa||(Eb.a.addHandler(window.self,bb.a.focus,
Object(e.a)(this,this.Ndc,"onWindowFocus")),Eb.a.addHandler(window.self,bb.a.blur,Object(e.a)(this,this.Mpk,"onWindowBlur")))}hMc(){if(!this.M1b)return null;let ob=null;try{ob=localStorage}catch(cc){this.M1b=!1,ob=null,h.ULS.sendTraceTag(594052320,356,50,"SIFB.GetLocalStorage error "+(cc?cc.toString():""))}return ob}Ayj(){h.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.oa=new xa.a(Ga.a.Qr()),this.oa.$("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.oa.$("nps_PromptQuestion",
CommonUIStrings.l_WAC_NPS_PromptQuestion),this.oa.$("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.oa.$("nps_RatingQuestion_Word",Yb.Efg()),this.oa.$("nps_RatingQuestion_OneNote",Yb.Ghj()),this.oa.$("nps_OneClickPromptQuestion_PPT",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.oa.$("nps_OneClickPromptQuestion_Excel",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.oa.$("nps_OneClickRatingQuestion_Excel",Yb.Cfg()),this.oa.$("nps_OneClickRatingQuestion_PowerPoint",
Yb.Dfg()),this.oa.$("nps_RatingQuestion_PowerPoint",Yb.Dfg()),this.oa.$("nps_RatingQuestion_Excel",Yb.Cfg()),this.oa.$("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.oa.$("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),this.oa.$("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.oa.$("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.oa.$("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.oa.$("nps_Rating_Values_5",
CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.oa.$("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.oa.$("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.oa.$("nps_OneClickRatingQuestion_Word",Yb.Efg()),this.oa.$("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.oa.$("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.oa.$("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),
this.oa.$("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.oa.$("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.oa.$("nps_Suite_RatingQuestion","How likely are you to recommend Microsoft 365 to others, if asked?"),this.oa.$("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.oa.$("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.oa.$("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),
this.oa.$("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.oa.$("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.oa.$("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.oa.$("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.oa.$("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.oa.$("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.oa.$("NSV_Prompt_Title_Feedback",
CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.oa.$("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.oa.$("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),this.oa.$("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.oa.$("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.oa.$("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.oa.$("NSVFreeformDidntCreateSheetView",
CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.oa.$("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.oa.$("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),this.oa.$("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.oa.$("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.oa.$("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.oa.$("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),
this.oa.$("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.oa.$("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.oa.$("CatchUpFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.oa.$("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.oa.$("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.oa.$("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),
this.oa.$("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.oa.$("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.oa.$("ReviewMode_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.oa.$("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.oa.$("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.oa.$("ReviewMode_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.oa.$("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.oa.$("ReviewMode_FloodgateRating_2",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.oa.$("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.oa.$("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.oa.$("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),
this.oa.$("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.oa.$("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),this.oa.$("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.oa.$("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.oa.$("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.oa.$("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),
this.oa.$("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.oa.$("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),this.oa.$("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.oa.$("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.oa.$("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.oa.$("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),
this.oa.$("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.oa.$("connector_campaign_Rating_Values_1",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.oa.$("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.oa.$("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.oa.$("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),
this.oa.$("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.oa.$("connector_campaign_Verbatim_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),this.oa.$("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.oa.$("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.oa.$("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),
this.oa.$("WordFollowUpFeelingsFPS_Prompt_NoLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.oa.$("WordFollowUpFeelingsFPS_RatingQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),
this.oa.$("WordFollowUpFeelingsFPS_RatingValue_4",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_5",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),this.oa.$("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.oa.$("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.oa.$("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),
this.oa.$("DictationV2_GreetingAnswer_Sure",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.oa.$("DictationV2_GreetingAnswer_Notnow",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),this.oa.$("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.oa.$("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.oa.$("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),
this.oa.$("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.oa.$("DictationV2_RatingAnswer_4",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),this.oa.$("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.oa.$("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.oa.$("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),
this.oa.$("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.oa.$("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),this.oa.$("OfficeScriptsFPS_NoLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.oa.$("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.oa.$("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.oa.$("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),
this.oa.$("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.oa.$("OfficeScriptsFPS_RatingValue_4",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),this.oa.$("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.oa.$("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.oa.$("ExcelAddins_Prompt",CommonUIStrings.l_Excel_Addins_Prompt),this.oa.$("ExcelAddins_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("ExcelAddins_Rating_Question",CommonUIStrings.l_Excel_Addins_Rating_Question),this.oa.$("ExcelAddins_QuestionQuestion",CommonUIStrings.l_Excel_Addins_QuestionQuestion),this.oa.$("ExcelAddins_Rating_1_Expectations",CommonUIStrings.l_Excel_Addins_Choice_1),this.oa.$("ExcelAddins_Rating_2_Expectations",CommonUIStrings.l_Excel_Addins_Choice_2),this.oa.$("ExcelAddins_Rating_3_Expectations",CommonUIStrings.l_Excel_Addins_Choice_3),this.oa.$("ExcelAddins_Rating_4_Expectations",CommonUIStrings.l_Excel_Addins_Choice_4),
this.oa.$("ExcelAddins_Rating_5_Expectations",CommonUIStrings.l_Excel_Addins_Choice_5),this.oa.$("ExcelIdeas_Prompt",CommonUIStrings.l_Excel_Ideas_Prompt),this.oa.$("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.oa.$("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.oa.$("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),
this.oa.$("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.oa.$("ExcelIdeas_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.oa.$("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.oa.$("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.oa.$("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.oa.$("ExcelRecommendedCharts_PromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),this.oa.$("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.oa.$("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_3_Satisfied",
CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_4_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.oa.$("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.oa.$("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("ExcelRecommendedPivotTable_Rating_Question",
CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.oa.$("ExcelRecommendedPivotTable_ExpectationsQuestion",CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.oa.$("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.oa.$("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.oa.$("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),
this.oa.$("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.oa.$("ExcelRecommendedPivotTable_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.oa.$("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.oa.$("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.oa.$("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.oa.$("Download_as_Image_Rating_Values_1",
CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.oa.$("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.oa.$("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.oa.$("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.oa.$("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.oa.$("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.oa.$("TextPredictions_FloodgatePromptTitle",
CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.oa.$("TextPredictions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.oa.$("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.oa.$("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.oa.$("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),
this.oa.$("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),this.oa.$("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.oa.$("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.oa.$("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.oa.$("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),
this.oa.$("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),this.oa.$("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.oa.$("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.oa.$("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.oa.$("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.oa.$("SoftwareITDiagrams_Rating_Values_2",
CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.oa.$("SoftwareITDiagrams_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.oa.$("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.oa.$("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.oa.$("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.oa.$("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),
this.oa.$("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),this.oa.$("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.oa.$("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.oa.$("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.oa.$("ExternalContent_FloodgateRating_1",
CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.oa.$("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),this.oa.$("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.oa.$("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.oa.$("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.oa.$("ExternalContent_FloodgateQuestion",
CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.oa.$("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),this.oa.$("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.oa.$("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.oa.$("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.oa.$("Translator_RatingQuestion",
CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.oa.$("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),this.oa.$("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.oa.$("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.oa.$("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.oa.$("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),
this.oa.$("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.oa.$("TeamsOpen_GreetingQuestion",CommonUIStrings.l_WAC_NPS_Title),this.oa.$("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),
this.oa.$("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.oa.$("TeamsOpen_RatingQuestion_PowerPoint",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.oa.$("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.oa.$("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.oa.$("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.oa.$("LinkedIn_Title",
CommonUIStrings.l_LinkedIn_Title),this.oa.$("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.oa.$("LinkedIn_QuestionQuestion",CommonUIStrings.l_LinkedIn_QuestionQuestion),this.oa.$("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.oa.$("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.oa.$("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.oa.$("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),
this.oa.$("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.oa.$("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),this.oa.$("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.oa.$("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.oa.$("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.oa.$("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.oa.$("VHRestore_SurveyQuestion",
CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.oa.$("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.oa.$("VHRestore_Answer_Options_2",CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.oa.$("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.oa.$("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.oa.$("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.oa.$("ShowChanges_Prompt",
CommonUIStrings.l_Excel_ShowChanges_Prompt),this.oa.$("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.oa.$("ShowChanges_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.oa.$("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.oa.$("ShowChanges_RatingValue_2",
CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.oa.$("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.oa.$("ShowChanges_RatingValue_4",CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.oa.$("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.oa.$("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.oa.$("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),
this.oa.$("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.oa.$("ModernUxExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.oa.$("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.oa.$("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.oa.$("ModernUxExperiment_FloodgateRatingValue_1",
CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.oa.$("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),this.oa.$("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.oa.$("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.oa.$("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),
this.oa.$("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.oa.$("FileBackedLoopComponents_FloodgatePromptTitle",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_PromptTitle),this.oa.$("FileBackedLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FileBackedLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingQuestion),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_1),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_2),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_3),
this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_4),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_5),this.oa.$("FileBackedLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion),this.oa.$("PollLoopComponent_FloodgatePromptTitle",CommonUIStrings.l_PollLoopComponent_Floodgate_PromptTitle),this.oa.$("PollLoopComponent_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("PollLoopComponent_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("PollLoopComponent_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("PollLoopComponent_FloodgateRatingQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingQuestion),this.oa.$("PollLoopComponent_FloodgateRatingValue_1",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_1),this.oa.$("PollLoopComponent_FloodgateRatingValue_2",
CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_2),this.oa.$("PollLoopComponent_FloodgateRatingValue_3",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_3),this.oa.$("PollLoopComponent_FloodgateRatingValue_4",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_4),this.oa.$("PollLoopComponent_FloodgateRatingValue_5",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_5),this.oa.$("PollLoopComponent_FloodgateWhyQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_FloodgateWhyQuestion),
this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptTitle),this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptQuestion),this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow),this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure),
this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingQuestion),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_1),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_2),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_3),
this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_4),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_5),this.oa.$("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion),this.oa.$("TabSwitchControlExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptTitle),
this.oa.$("TabSwitchControlExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptQuestion),this.oa.$("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow),this.oa.$("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure),this.oa.$("TabSwitchControlExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingQuestion),
this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_1),this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_2),this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_3),this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_4),
this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_5),this.oa.$("TabSwitchControlExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_HearMoreQuestion),this.oa.$("ShortcutDiscovery_PromptTitle",CommonUIStrings.l_ShortcutDiscovery_PromptTitle),this.oa.$("ShortcutDiscovery_PromptQuestion",CommonUIStrings.l_ShortcutDiscovery_PromptQuestion),this.oa.$("ShortcutDiscovery_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ShortcutDiscovery_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ShortcutDiscovery_RatingQuestion",CommonUIStrings.l_ShortcutDiscovery_RatingQuestion),this.oa.$("ShortcutDiscovery_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.oa.$("ShortcutDiscovery_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.oa.$("ShortcutDiscovery_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.oa.$("ShortcutDiscovery_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.oa.$("ShortcutDiscovery_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.oa.$("ShortcutDiscovery_WhyQuestion",CommonUIStrings.l_ShortcutDiscovery_WhyQuestion),this.oa.$("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.oa.$("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.oa.$("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),
this.oa.$("Ruler_PromptAnswer_Sure",CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.oa.$("Ruler_RatingQuestion",CommonUIStrings.l_WordRuler_RatingQuestion),this.oa.$("Ruler_RatingValue_1",CommonUIStrings.l_WordRuler_RatingValue_1),this.oa.$("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.oa.$("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.oa.$("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.oa.$("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),
this.oa.$("Ruler_WhyQuestion",CommonUIStrings.l_WordRuler_WhyQuestion),this.oa.$("CustomTabDialog_PromptTitle",CommonUIStrings.l_CustomTabDialog_PromptTitle),this.oa.$("CustomTabDialog_PromptQuestion",CommonUIStrings.l_CustomTabDialog_PromptQuestion),this.oa.$("CustomTabDialog_PromptAnswer_NotNow",CommonUIStrings.l_CustomTabDialog_PromptAnswer_NotNow),this.oa.$("CustomTabDialog_PromptAnswer_Sure",CommonUIStrings.l_CustomTabDialog_PromptAnswer_Sure),this.oa.$("CustomTabDialog_RatingQuestion",CommonUIStrings.l_CustomTabDialog_RatingQuestion),
this.oa.$("CustomTabDialog_RatingValue_1",CommonUIStrings.l_CustomTabDialog_RatingValue_1),this.oa.$("CustomTabDialog_RatingValue_2",CommonUIStrings.l_CustomTabDialog_RatingValue_2),this.oa.$("CustomTabDialog_RatingValue_3",CommonUIStrings.l_CustomTabDialog_RatingValue_3),this.oa.$("CustomTabDialog_RatingValue_4",CommonUIStrings.l_CustomTabDialog_RatingValue_4),this.oa.$("CustomTabDialog_RatingValue_5",CommonUIStrings.l_CustomTabDialog_RatingValue_5),this.oa.$("CustomTabDialog_WhyQuestion",CommonUIStrings.l_CustomTabDialog_WhyQuestion),
this.oa.$("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),this.oa.$("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.oa.$("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.oa.$("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.oa.$("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),
this.oa.$("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.oa.$("WordStyles_FloodgateRating_2",CommonUIStrings.l_WordStyles_FloodgateRating_2),this.oa.$("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.oa.$("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.oa.$("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.oa.$("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),
this.oa.$("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),this.oa.$("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.oa.$("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.oa.$("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.oa.$("UnsavedChangesHighlight_RatingQuestion",
CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.oa.$("UnsavedChangesHighlight_Rating_Yes",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.oa.$("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.oa.$("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion),this.oa.$("WordUnifiedRead_FloodgatePromptTitle",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptTitle),
this.oa.$("WordUnifiedRead_FloodgatePromptQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptQuestion),this.oa.$("WordUnifiedRead_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_YesLabel),this.oa.$("WordUnifiedRead_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_NoLabel),this.oa.$("WordUnifiedRead_FloodgateRatingQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateRatingQuestion),this.oa.$("WordUnifiedRead_FloodgateRating_1",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_1),
this.oa.$("WordUnifiedRead_FloodgateRating_2",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_2),this.oa.$("WordUnifiedRead_FloodgateRating_3",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_3),this.oa.$("WordUnifiedRead_FloodgateRating_4",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_4),this.oa.$("WordUnifiedRead_FloodgateRating_5",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_5),this.oa.$("WordUnifiedRead_FloodgateWhyQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateWhyQuestion),
this.oa.$("GrammarSuggestions_FloodgatePromptTitle",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptTitle),this.oa.$("GrammarSuggestions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptQuestion),this.oa.$("GrammarSuggestions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_YesLabel),this.oa.$("GrammarSuggestions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_NoLabel),this.oa.$("GrammarSuggestions_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRatingQuestion),this.oa.$("GrammarSuggestions_FloodgateRating_1",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_1),this.oa.$("GrammarSuggestions_FloodgateRating_2",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_2),this.oa.$("GrammarSuggestions_FloodgateRating_3",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_3),this.oa.$("GrammarSuggestions_FloodgateRating_4",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_4),
this.oa.$("GrammarSuggestions_FloodgateRating_5",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_5),this.oa.$("GrammarSuggestions_FloodgateQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateQuestion),this.oa.$("WordRemoveSsr_FloodgatePromptTitle",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptTitle),this.oa.$("WordRemoveSsr_FloodgatePromptQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptQuestion),this.oa.$("WordRemoveSsr_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_YesLabel),
this.oa.$("WordRemoveSsr_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_NoLabel),this.oa.$("WordRemoveSsr_FloodgateRatingQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateRatingQuestion),this.oa.$("WordRemoveSsr_FloodgateRating_1",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_1),this.oa.$("WordRemoveSsr_FloodgateRating_2",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_2),this.oa.$("WordRemoveSsr_FloodgateRating_3",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_3),this.oa.$("WordRemoveSsr_FloodgateRating_4",
CommonUIStrings.l_WordRemoveSsr_FloodgateRating_4),this.oa.$("WordRemoveSsr_FloodgateRating_5",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_5),this.oa.$("WordRemoveSsr_FloodgateWhyQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateWhyQuestion),this.oa.$("WordDrawing_FloodgatePromptTitle",CommonUIStrings.l_WordDrawing_FloodgatePromptTitle),this.oa.$("WordDrawing_FloodgatePromptQuestion",CommonUIStrings.l_WordDrawing_FloodgatePromptQuestion),this.oa.$("WordDrawing_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_YesLabel),
this.oa.$("WordDrawing_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_NoLabel),this.oa.$("WordDrawing_FloodgateRatingQuestion",CommonUIStrings.l_WordDrawing_FloodgateRatingQuestion),this.oa.$("WordDrawing_FloodgateRating_1",CommonUIStrings.l_WordDrawing_FloodgateRating_1),this.oa.$("WordDrawing_FloodgateRating_2",CommonUIStrings.l_WordDrawing_FloodgateRating_2),this.oa.$("WordDrawing_FloodgateRating_3",CommonUIStrings.l_WordDrawing_FloodgateRating_3),this.oa.$("WordDrawing_FloodgateRating_4",
CommonUIStrings.l_WordDrawing_FloodgateRating_4),this.oa.$("WordDrawing_FloodgateRating_5",CommonUIStrings.l_WordDrawing_FloodgateRating_5),this.oa.$("WordDrawing_FloodgateWhyQuestion",CommonUIStrings.l_WordDrawing_FloodgateWhyQuestion),this.oa.$("WordPenNSAT_FloodgatePromptTitle",CommonUIStrings.l_WordPenNSAT_FloodgatePromptTitle),this.oa.$("WordPenNSAT_FloodgatePromptQuestion",CommonUIStrings.l_WordPenNSAT_FloodgatePromptQuestion),this.oa.$("WordPenNSAT_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("WordPenNSAT_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordPenNSAT_FloodgateRatingQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateRatingQuestion),this.oa.$("WordPenNSAT_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("WordPenNSAT_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("WordPenNSAT_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),
this.oa.$("WordPenNSAT_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.oa.$("WordPenNSAT_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("WordPenNSAT_FloodgateWhyQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateWhyQuestion),this.oa.$("ShyRibbon_FloodgatePromptTitle",CommonUIStrings.l_ShyRibbon_FloodgatePromptTitle),this.oa.$("ShyRibbon_FloodgatePromptQuestion",CommonUIStrings.l_ShyRibbon_FloodgatePromptQuestion),
this.oa.$("ShyRibbon_FloodgatePrompt_YesLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_YesLabel),this.oa.$("ShyRibbon_FloodgatePrompt_NoLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_NoLabel),this.oa.$("ShyRibbon_Floodgate_Question",CommonUIStrings.l_ShyRibbon_Floodgate_Question),this.oa.$("ShyRibbon_Floodgate_Option_1",CommonUIStrings.l_ShyRibbon_Floodgate_Option_1),this.oa.$("ShyRibbon_Floodgate_Option_2",CommonUIStrings.l_ShyRibbon_Floodgate_Option_2),this.oa.$("ShyRibbon_Floodgate_Option_3",
CommonUIStrings.l_ShyRibbon_Floodgate_Option_3),this.oa.$("ShyRibbon_Floodgate_Option_4",CommonUIStrings.l_ShyRibbon_Floodgate_Option_4),this.oa.$("ShyRibbon_Floodgate_Option_5",CommonUIStrings.l_ShyRibbon_Floodgate_Option_5),this.oa.$("ShyRibbon_FloodgateTellusMore",CommonUIStrings.l_ShyRibbon_Floodgate_TellMore),this.oa.$("WordAutoCorrect_FloodgatePromptTitle",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptTitle),this.oa.$("WordAutoCorrect_FloodgatePromptQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptQuestion),
this.oa.$("WordAutoCorrect_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_YesLabel),this.oa.$("WordAutoCorrect_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_NoLabel),this.oa.$("WordAutoCorrect_FloodgateRatingQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateRatingQuestion),this.oa.$("WordAutoCorrect_FloodgateRating_1",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_1),this.oa.$("WordAutoCorrect_FloodgateRating_2",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_2),
this.oa.$("WordAutoCorrect_FloodgateRating_3",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_3),this.oa.$("WordAutoCorrect_FloodgateRating_4",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_4),this.oa.$("WordAutoCorrect_FloodgateRating_5",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_5),this.oa.$("WordAutoCorrect_FloodgateWhyQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateWhyQuestion),this.oa.$("PasswordProtectedDocumentSupport_FloodgatePromptTitle",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptTitle),
this.oa.$("PasswordProtectedDocumentSupport_FloodgatePromptQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptQuestion),this.oa.$("PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel),this.oa.$("PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRatingQuestion",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRatingQuestion),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_1",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_1),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_2",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_2),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_3",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_3),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_4",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_4),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_5",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_5),this.oa.$("PasswordProtectedDocumentSupport_FloodgateWhyQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateWhyQuestion),this.oa.$("WordSimilarity_FloodgatePromptTitle",CommonUIStrings.l_WordSimilarity_FloodgatePromptTitle),this.oa.$("WordSimilarity_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("WordSimilarity_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("WordSimilarity_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordSimilarity_FloodgateRatingQuestion",CommonUIStrings.l_WordSimilarity_FloodgateRatingQuestion),this.oa.$("WordSimilarity_FloodgateRating_1",CommonUIStrings.l_WordSimilarity_FloodgateRating_1),this.oa.$("WordSimilarity_FloodgateRating_2",CommonUIStrings.l_WordSimilarity_FloodgateRating_2),this.oa.$("WordSimilarity_FloodgateRating_3",
CommonUIStrings.l_WordSimilarity_FloodgateRating_3),this.oa.$("WordSimilarity_FloodgateRating_4",CommonUIStrings.l_WordSimilarity_FloodgateRating_4),this.oa.$("WordSimilarity_FloodgateRating_5",CommonUIStrings.l_WordSimilarity_FloodgateRating_5),this.oa.$("WordSimilarity_FloodgateWhyQuestion",CommonUIStrings.l_WordSimilarity_FloodgateWhyQuestion),this.oa.$("PremiumPreviewFloodgateTitle",CommonUIStrings.l_PremiumPreview_FeedbackTitle),this.oa.$("PremiumPreviewFloodgatePrompt",CommonUIStrings.l_PremiumPreview_FeedbackPrompt),
this.oa.$("PremiumPreviewFloodgateRatingQuestion",CommonUIStrings.l_PremiumPreview_FeedbackRatingQuestion),this.oa.$("PremiumPreviewFloodgateQuestion",CommonUIStrings.l_PremiumPreview_FeedbackQuestion1),this.oa.$("PremiumPreviewFloodgateMinRating",CommonUIStrings.l_PremiumPreview_FeedbackMinRating),this.oa.$("PremiumPreviewFloodgateMaxRating",CommonUIStrings.l_PremiumPreview_FeedbackMaxRating),this.oa.$("FloodgateNLQSPromptTitle",CommonUIStrings.l_FloodgateNLQSPromptTitle),this.oa.$("FloodgateNLQSPromptSubtitle",
CommonUIStrings.l_FloodgateNLQSPromptSubtitle),this.oa.$("FloodgateNLQSPromptYes",CommonUIStrings.l_FloodgateNLQSPromptYes),this.oa.$("FloodgateNLQSPromptNo",CommonUIStrings.l_FloodgateNLQSPromptNo),this.oa.$("FloodgateNLQSRatingQuestion",CommonUIStrings.l_FloodgateNLQSRatingQuestion),this.oa.$("FloodgateNLQSRating1",CommonUIStrings.l_FloodgateNLQSRating1),this.oa.$("FloodgateNLQSRating2",CommonUIStrings.l_FloodgateNLQSRating2),this.oa.$("FloodgateNLQSRating3",CommonUIStrings.l_FloodgateNLQSRating3),
this.oa.$("FloodgateNLQSRating4",CommonUIStrings.l_FloodgateNLQSRating4),this.oa.$("FloodgateNLQSRating5",CommonUIStrings.l_FloodgateNLQSRating5),this.oa.$("FloodgateNLQSDetailsQuestion",CommonUIStrings.l_FloodgateNLQSDetailsQuestion),this.oa.$("ExcelWebEaseOfUse_Prompt",CommonUIStrings.l_ExcelWeb_EaseOfUse_Prompt),this.oa.$("ExcelWebEaseOfUse_PromptQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_PromptQuestion),this.oa.$("ExcelWebEaseOfUse_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ExcelWebEaseOfUse_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ExcelWebEaseOfUse_RatingQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingQuestion),this.oa.$("ExcelWebEaseOfUse_RatingValue_1",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_1),this.oa.$("ExcelWebEaseOfUse_RatingValue_2",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_2),this.oa.$("ExcelWebEaseOfUse_RatingValue_3",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_3),this.oa.$("ExcelWebEaseOfUse_RatingValue_4",
CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_4),this.oa.$("ExcelWebEaseOfUse_RatingValue_5",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_5),this.oa.$("ExcelWebEaseOfUse_WhyQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_WhyQuestion),this.oa.$("ExcelWebPrintSurvey_Prompt",CommonUIStrings.l_ExcelWeb_PrintSurvey_Prompt),this.oa.$("ExcelWebPrintSurvey_PromptQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_PromptQuestion),this.oa.$("ExcelWebPrintSurvey_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ExcelWebPrintSurvey_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ExcelWebPrintSurvey_RatingQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingQuestion),this.oa.$("ExcelWebPrintSurvey_RatingValue_1",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_1),this.oa.$("ExcelWebPrintSurvey_RatingValue_2",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_2),this.oa.$("ExcelWebPrintSurvey_RatingValue_3",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_3),this.oa.$("ExcelWebPrintSurvey_RatingValue_4",
CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_4),this.oa.$("ExcelWebPrintSurvey_RatingValue_5",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_5),this.oa.$("ExcelWebPrintSurvey_WhyQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_WhyQuestion),this.oa.$("ReactAutoFilter_PromptLine_1",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_1),this.oa.$("ReactAutoFilter_PromptLine_2",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_2),this.oa.$("ReactAutoFilter_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ReactAutoFilter_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ReactAutoFilter_RatingQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_RatingQuestion),this.oa.$("ReactAutoFilter_RatingValue_1",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_1),this.oa.$("ReactAutoFilter_RatingValue_2",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_2),this.oa.$("ReactAutoFilter_RatingValue_3",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_3),this.oa.$("ReactAutoFilter_RatingValue_4",
CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_4),this.oa.$("ReactAutoFilter_RatingValue_5",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_5),this.oa.$("ReactAutoFilter_CommentQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_CommentQuestion),this.oa.$("WordLinksExperience_FloodgatePromptTitle",CommonUIStrings.l_WordLinksExperience_FloodgatePromptTitle),this.oa.$("WordLinksExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordLinksExperience_FloodgatePromptQuestion),this.oa.$("WordLinksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_YesLabel),this.oa.$("WordLinksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_NoLabel),this.oa.$("WordLinksExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateRatingQuestion),this.oa.$("WordLinksExperience_FloodgateRating_1",CommonUIStrings.l_WordLinksExperience_FloodgateRating_1),this.oa.$("WordLinksExperience_FloodgateRating_2",CommonUIStrings.l_WordLinksExperience_FloodgateRating_2),
this.oa.$("WordLinksExperience_FloodgateRating_3",CommonUIStrings.l_WordLinksExperience_FloodgateRating_3),this.oa.$("WordLinksExperience_FloodgateRating_4",CommonUIStrings.l_WordLinksExperience_FloodgateRating_4),this.oa.$("WordLinksExperience_FloodgateRating_5",CommonUIStrings.l_WordLinksExperience_FloodgateRating_5),this.oa.$("WordLinksExperience_FloodgateWhyQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateWhyQuestion),this.oa.$("OnlineVideoSupport_FloodgatePromptTitle",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptTitle),
this.oa.$("OnlineVideoSupport_FloodgatePromptQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptQuestion),this.oa.$("OnlineVideoSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_YesLabel),this.oa.$("OnlineVideoSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_NoLabel),this.oa.$("OnlineVideoSupport_FloodgateRatingQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateRatingQuestion),this.oa.$("OnlineVideoSupport_FloodgateRating_1",
CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_1),this.oa.$("OnlineVideoSupport_FloodgateRating_2",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_2),this.oa.$("OnlineVideoSupport_FloodgateRating_3",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_3),this.oa.$("OnlineVideoSupport_FloodgateRating_4",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_4),this.oa.$("OnlineVideoSupport_FloodgateRating_5",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_5),this.oa.$("OnlineVideoSupport_FloodgateWhyQuestion",
CommonUIStrings.l_OnlineVideoSupport_FloodgateWhyQuestion),this.oa.$("NavPaneExperience_FloodgatePromptTitle",CommonUIStrings.l_NavPaneExperience_FloodgatePromptTitle),this.oa.$("NavPaneExperience_FloodgatePromptQuestion",CommonUIStrings.l_NavPaneExperience_FloodgatePromptQuestion),this.oa.$("NavPaneExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_YesLabel),this.oa.$("NavPaneExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_NoLabel),
this.oa.$("NavPaneExperience_FloodgateRatingQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateRatingQuestion),this.oa.$("NavPaneExperience_FloodgateRating_1",CommonUIStrings.l_NavPaneExperience_FloodgateRating_1),this.oa.$("NavPaneExperience_FloodgateRating_2",CommonUIStrings.l_NavPaneExperience_FloodgateRating_2),this.oa.$("NavPaneExperience_FloodgateRating_3",CommonUIStrings.l_NavPaneExperience_FloodgateRating_3),this.oa.$("NavPaneExperience_FloodgateRating_4",CommonUIStrings.l_NavPaneExperience_FloodgateRating_4),
this.oa.$("NavPaneExperience_FloodgateRating_5",CommonUIStrings.l_NavPaneExperience_FloodgateRating_5),this.oa.$("NavPaneExperience_FloodgateWhyQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateWhyQuestion),this.oa.$("BookmarksExperience_FloodgatePromptTitle",CommonUIStrings.l_BookmarksExperience_FloodgatePromptTitle),this.oa.$("BookmarksExperience_FloodgatePromptQuestion",CommonUIStrings.l_BookmarksExperience_FloodgatePromptQuestion),this.oa.$("BookmarksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_YesLabel),this.oa.$("BookmarksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_NoLabel),this.oa.$("BookmarksExperience_FloodgateRatingQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateRatingQuestion),this.oa.$("BookmarksExperience_FloodgateRating_1",CommonUIStrings.l_BookmarksExperience_FloodgateRating_1),this.oa.$("BookmarksExperience_FloodgateRating_2",CommonUIStrings.l_BookmarksExperience_FloodgateRating_2),
this.oa.$("BookmarksExperience_FloodgateRating_3",CommonUIStrings.l_BookmarksExperience_FloodgateRating_3),this.oa.$("BookmarksExperience_FloodgateRating_4",CommonUIStrings.l_BookmarksExperience_FloodgateRating_4),this.oa.$("BookmarksExperience_FloodgateRating_5",CommonUIStrings.l_BookmarksExperience_FloodgateRating_5),this.oa.$("BookmarksExperience_FloodgateWhyQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateWhyQuestion),this.oa.$("WordPictureBorder_FloodgatePromptTitle",CommonUIStrings.l_WordPictureBorder_FloodgatePromptTitle),
this.oa.$("WordPictureBorder_FloodgatePromptQuestion",CommonUIStrings.l_WordPictureBorder_FloodgatePromptQuestion),this.oa.$("WordPictureBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_YesLabel),this.oa.$("WordPictureBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_NoLabel),this.oa.$("WordPictureBorder_FloodgateRatingQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateRatingQuestion),this.oa.$("WordPictureBorder_FloodgateRating_1",
CommonUIStrings.l_WordPictureBorder_FloodgateRating_1),this.oa.$("WordPictureBorder_FloodgateRating_2",CommonUIStrings.l_WordPictureBorder_FloodgateRating_2),this.oa.$("WordPictureBorder_FloodgateRating_3",CommonUIStrings.l_WordPictureBorder_FloodgateRating_3),this.oa.$("WordPictureBorder_FloodgateRating_4",CommonUIStrings.l_WordPictureBorder_FloodgateRating_4),this.oa.$("WordPictureBorder_FloodgateRating_5",CommonUIStrings.l_WordPictureBorder_FloodgateRating_5),this.oa.$("WordPictureBorder_FloodgateWhyQuestion",
CommonUIStrings.l_WordPictureBorder_FloodgateWhyQuestion),this.oa.$("WordComment_FloodgatePromptTitle",CommonUIStrings.l_WordComment_FloodgatePromptTitle),this.oa.$("WordComment_FloodgatePromptQuestion",CommonUIStrings.l_WordComment_FloodgatePromptQuestion),this.oa.$("WordComment_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_YesLabel),this.oa.$("WordComment_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_NoLabel),this.oa.$("WordComment_FloodgateRatingQuestion",
CommonUIStrings.l_WordComment_FloodgateRatingQuestion),this.oa.$("WordComment_FloodgateRating_1",CommonUIStrings.l_WordComment_FloodgateRating_1),this.oa.$("WordComment_FloodgateRating_2",CommonUIStrings.l_WordComment_FloodgateRating_2),this.oa.$("WordComment_FloodgateRating_3",CommonUIStrings.l_WordComment_FloodgateRating_3),this.oa.$("WordComment_FloodgateRating_4",CommonUIStrings.l_WordComment_FloodgateRating_4),this.oa.$("WordComment_FloodgateRating_5",CommonUIStrings.l_WordComment_FloodgateRating_5),
this.oa.$("WordComment_FloodgateWhyQuestion",CommonUIStrings.l_WordComment_FloodgateWhyQuestion),this.oa.$("WordTrackChanges_FloodgatePromptTitle",CommonUIStrings.l_WordTrackChanges_FloodgatePromptTitle),this.oa.$("WordTrackChanges_FloodgatePromptQuestion",CommonUIStrings.l_WordTrackChanges_FloodgatePromptQuestion),this.oa.$("WordTrackChanges_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_YesLabel),this.oa.$("WordTrackChanges_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_NoLabel),
this.oa.$("WordTrackChanges_FloodgateRatingQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateRatingQuestion),this.oa.$("WordTrackChanges_FloodgateRating_1",CommonUIStrings.l_WordTrackChanges_FloodgateRating_1),this.oa.$("WordTrackChanges_FloodgateRating_2",CommonUIStrings.l_WordTrackChanges_FloodgateRating_2),this.oa.$("WordTrackChanges_FloodgateRating_3",CommonUIStrings.l_WordTrackChanges_FloodgateRating_3),this.oa.$("WordTrackChanges_FloodgateRating_4",CommonUIStrings.l_WordTrackChanges_FloodgateRating_4),
this.oa.$("WordTrackChanges_FloodgateRating_5",CommonUIStrings.l_WordTrackChanges_FloodgateRating_5),this.oa.$("WordTrackChanges_FloodgateWhyQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateWhyQuestion),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_1),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_2),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_YesLabel),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_NoLabel),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Question),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_1),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_2),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_3),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_4),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_5),this.oa.$("CollabCorner_Survey_DownloadCopies_Comment_Question",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Comment_Question),this.oa.$("WordListsExperience_FloodgatePromptTitle",CommonUIStrings.l_WordListsExperience_FloodgatePromptTitle),this.oa.$("WordListsExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordListsExperience_FloodgatePromptQuestion),this.oa.$("WordListsExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_YesLabel),this.oa.$("WordListsExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_NoLabel),
this.oa.$("WordListsExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordListsExperience_FloodgateRatingQuestion),this.oa.$("WordListsExperience_FloodgateRating_1",CommonUIStrings.l_WordListsExperience_FloodgateRating_1),this.oa.$("WordListsExperience_FloodgateRating_5",CommonUIStrings.l_WordListsExperience_FloodgateRating_5),this.oa.$("WordListsExperience_FloodgateAdditionalThoughts",CommonUIStrings.l_WordListsExperience_FloodgateAdditionalThoughts),this.oa.$("WordChartsSupport_FloodgatePromptTitle",
CommonUIStrings.l_WordChartsSupport_FloodgatePromptTitle),this.oa.$("WordChartsSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordChartsSupport_FloodgatePromptQuestion),this.oa.$("WordChartsSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_YesLabel),this.oa.$("WordChartsSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_NoLabel),this.oa.$("WordChartsSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateRatingQuestion),
this.oa.$("WordChartsSupport_FloodgateRating_1",CommonUIStrings.l_WordChartsSupport_FloodgateRating_1),this.oa.$("WordChartsSupport_FloodgateRating_2",CommonUIStrings.l_WordChartsSupport_FloodgateRating_2),this.oa.$("WordChartsSupport_FloodgateRating_3",CommonUIStrings.l_WordChartsSupport_FloodgateRating_3),this.oa.$("WordChartsSupport_FloodgateRating_4",CommonUIStrings.l_WordChartsSupport_FloodgateRating_4),this.oa.$("WordChartsSupport_FloodgateRating_5",CommonUIStrings.l_WordChartsSupport_FloodgateRating_5),
this.oa.$("WordChartsSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateWhyQuestion),this.oa.$("WordTablesSupport_FloodgatePromptTitle",CommonUIStrings.l_WordTablesSupport_FloodgatePromptTitle),this.oa.$("WordTablesSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordTablesSupport_FloodgatePromptQuestion),this.oa.$("WordTablesSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_YesLabel),this.oa.$("WordTablesSupport_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_NoLabel),this.oa.$("WordTablesSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateRatingQuestion),this.oa.$("WordTablesSupport_FloodgateRating_1",CommonUIStrings.l_WordTablesSupport_FloodgateRating_1),this.oa.$("WordTablesSupport_FloodgateRating_2",CommonUIStrings.l_WordTablesSupport_FloodgateRating_2),this.oa.$("WordTablesSupport_FloodgateRating_3",CommonUIStrings.l_WordTablesSupport_FloodgateRating_3),this.oa.$("WordTablesSupport_FloodgateRating_4",
CommonUIStrings.l_WordTablesSupport_FloodgateRating_4),this.oa.$("WordTablesSupport_FloodgateRating_5",CommonUIStrings.l_WordTablesSupport_FloodgateRating_5),this.oa.$("WordTablesSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateWhyQuestion),this.oa.$("ModernPresence_PromptLine_1",CommonUIStrings.l_Excel_ModernPresence_PromptLine_1),this.oa.$("ModernPresence_PromptLine_2",CommonUIStrings.l_Excel_ModernPresence_PromptLine_2),this.oa.$("ModernPresence_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ModernPresence_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ModernPresence_RatingQuestion",CommonUIStrings.l_Excel_ModernPresence_RatingQuestion),this.oa.$("ModernPresence_RatingValue_1",CommonUIStrings.l_Excel_ModernPresence_RatingValue_1),this.oa.$("ModernPresence_RatingValue_2",CommonUIStrings.l_Excel_ModernPresence_RatingValue_2),this.oa.$("ModernPresence_RatingValue_3",CommonUIStrings.l_Excel_ModernPresence_RatingValue_3),this.oa.$("ModernPresence_RatingValue_4",
CommonUIStrings.l_Excel_ModernPresence_RatingValue_4),this.oa.$("ModernPresence_RatingValue_5",CommonUIStrings.l_Excel_ModernPresence_RatingValue_5),this.oa.$("ModernPresence_CommentQuestion",CommonUIStrings.l_Excel_ModernPresence_CommentQuestion),this.oa.$("WordInsertImages_FloodgatePromptTitle",CommonUIStrings.l_WordInsertImages_FloodgatePromptTitle),this.oa.$("WordInsertImages_FloodgatePromptQuestion",CommonUIStrings.l_WordInsertImages_FloodgatePromptQuestion),this.oa.$("WordInsertImages_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordInsertImages_FloodgatePrompt_YesLabel),this.oa.$("WordInsertImages_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_NoLabel),this.oa.$("WordInsertImages_FloodgateRatingQuestion",CommonUIStrings.l_WordInsertImages_FloodgateRatingQuestion),this.oa.$("WordInsertImages_FloodgateRating_1",CommonUIStrings.l_WordInsertImages_FloodgateRating_1),this.oa.$("WordInsertImages_FloodgateRating_2",CommonUIStrings.l_WordInsertImages_FloodgateRating_2),this.oa.$("WordInsertImages_FloodgateRating_3",
CommonUIStrings.l_WordInsertImages_FloodgateRating_3),this.oa.$("WordInsertImages_FloodgateRating_4",CommonUIStrings.l_WordInsertImages_FloodgateRating_4),this.oa.$("WordInsertImages_FloodgateRating_5",CommonUIStrings.l_WordInsertImages_FloodgateRating_5),this.oa.$("WordInsertImages_FloodgateWhyQuestion",CommonUIStrings.l_WordInsertImages_FloodgateWhyQuestion),this.oa.$("FontPicker_FloodgatePromptTitle",CommonUIStrings.l_FontPicker_FloodgatePromptTitle),this.oa.$("FontPicker_FloodgatePromptQuestion",
CommonUIStrings.l_FontPicker_FloodgatePromptQuestion),this.oa.$("FontPicker_FloodgatePromptYesLabel",CommonUIStrings.l_FontPicker_FloodgatePromptYesLabel),this.oa.$("FontPicker_FloodgatePromptNoLabel",CommonUIStrings.l_FontPicker_FloodgatePromptNoLabel),this.oa.$("FontPicker_FloodgateRatingQuestion",CommonUIStrings.l_FontPicker_FloodgateRatingQuestion),this.oa.$("FontPicker_FloodgateRating1",CommonUIStrings.l_FontPicker_FloodgateRating1),this.oa.$("FontPicker_FloodgateRating2",CommonUIStrings.l_FontPicker_FloodgateRating2),
this.oa.$("FontPicker_FloodgateRating3",CommonUIStrings.l_FontPicker_FloodgateRating3),this.oa.$("FontPicker_FloodgateRating4",CommonUIStrings.l_FontPicker_FloodgateRating4),this.oa.$("FontPicker_FloodgateRating5",CommonUIStrings.l_FontPicker_FloodgateRating5),this.oa.$("FontPicker_FloodgateCommentQuestion",CommonUIStrings.l_FontPicker_FloodgateCommentQuestion),this.oa.$("FormulasMenu_PromptLine_1",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_1),this.oa.$("FormulasMenu_PromptLine_2",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_2),
this.oa.$("FormulasMenu_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FormulasMenu_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FormulasMenu_RatingQuestion",CommonUIStrings.l_Excel_FormulasMenu_RatingQuestion),this.oa.$("FormulasMenu_RatingValue_1",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_1),this.oa.$("FormulasMenu_RatingValue_2",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_2),this.oa.$("FormulasMenu_RatingValue_3",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_3),
this.oa.$("FormulasMenu_RatingValue_4",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_4),this.oa.$("FormulasMenu_RatingValue_5",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_5),this.oa.$("FormulasMenu_CommentQuestion",CommonUIStrings.l_Excel_FormulasMenu_CommentQuestion),this.oa.$("WordWebEditorSeen_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("WordWebEditorSeen_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("WordWebEditorSeen_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("WordWebEditorSeen_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordWebEditorSeen_FloodgateRatingQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateRatingQuestion),this.oa.$("WordWebEditorSeen_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.oa.$("WordWebEditorSeen_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.oa.$("WordWebEditorSeen_FloodgateRating_3",
CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.oa.$("WordWebEditorSeen_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.oa.$("WordWebEditorSeen_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.oa.$("WordWebEditorSeen_FloodgateWhyQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateWhyQuestion),this.oa.$("OnenotePerf_FloodgatePromptTitle",Yb.Hhj()),this.oa.$("OnenotePerf_FloodgatePromptQuestion",
CommonUIStrings.l_OnenotePerf_FloodgatePromptQuestion),this.oa.$("OnenotePerf_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_YesLabel),this.oa.$("OnenotePerf_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_NoLabel),this.oa.$("OnenotePerf_FloodgateRatingQuestion",Yb.Ihj()),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_1",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_1),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_2",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_2),
this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_3",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_3),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_4",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_4),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_5",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_5),this.oa.$("OnenotePerf_FloodgateWhyQuestion",CommonUIStrings.l_OnenotePerf_FloodgateWhyQuestion),this.oa.$("OnenoteInkSurvey_Prompt",CommonUIStrings.l_OnenoteInkSurvey_Prompt),
this.oa.$("OnenoteInkSurvey_PromptQuestion",CommonUIStrings.l_InkSurvey_PromptQuestion),this.oa.$("OnenoteInkSurvey_Prompt_Sure",CommonUIStrings.l_InkSurvey_Prompt_Sure),this.oa.$("OnenoteInkSurvey_Prompt_NoNow",CommonUIStrings.l_InkSurvey_Prompt_NoNow),this.oa.$("OnenoteInkSurvey_RatingQuestion",CommonUIStrings.l_OnenoteInkSurvey_RatingQuestion),this.oa.$("OnenoteInkSurvey_QuestionChoice_1",CommonUIStrings.l_InkSurvey_QuestionChoice_1),this.oa.$("OnenoteInkSurvey_QuestionChoice_2",CommonUIStrings.l_InkSurvey_QuestionChoice_2),
this.oa.$("OnenoteInkSurvey_QuestionChoice_3",CommonUIStrings.l_InkSurvey_QuestionChoice_3),this.oa.$("OnenoteInkSurvey_QuestionChoice_4",CommonUIStrings.l_InkSurvey_QuestionChoice_4),this.oa.$("OnenoteInkSurvey_QuestionChoice_5",CommonUIStrings.l_InkSurvey_QuestionChoice_5),this.oa.$("OnenoteInkSurvey_WhyQuestion",CommonUIStrings.l_InkSurvey_WhyQuestion),this.oa.$("OnenotePenInkSurvey_Prompt",CommonUIStrings.l_OnenotePenInkSurvey_Prompt),this.oa.$("OnenotePenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),
this.oa.$("OnenotePenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("OnenotePenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("OnenotePenInkSurvey_RatingQuestion",CommonUIStrings.l_OnenotePenInkSurvey_RatingQuestion),this.oa.$("OnenotePenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("OnenotePenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.oa.$("OnenotePenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("OnenotePenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("OnenotePenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("OnenotePenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.oa.$("PenInkSurvey_Prompt",CommonUIStrings.l_PenInkSurvey_Prompt),
this.oa.$("PenInkSurvey_RatingQuestion",CommonUIStrings.l_PenInkSurvey_RatingQuestion),this.oa.$("PenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.oa.$("PenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("PenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("PenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("PenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.oa.$("PenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("PenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("PenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("PenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.oa.$("SkittleFloodgateTitle",CommonUIStrings.l_Skittle_FeedbackTitle),this.oa.$("SkittleFloodgatePrompt",
CommonUIStrings.l_Skittle_FeedbackPrompt),this.oa.$("SkittleFloodgateRatingQuestion",CommonUIStrings.l_Skittle_FeedbackRatingQuestion),this.oa.$("SkittleFloodgateQuestion",CommonUIStrings.l_Skittle_FeedbackQuestion),this.oa.$("SkittleFloodgateMinRating",CommonUIStrings.l_Skittle_FeedbackMinRating),this.oa.$("SkittleFloodgateMaxRating",CommonUIStrings.l_Skittle_FeedbackMaxRating),this.oa.$("WordDocumentModes_FloodgatePromptTitle",CommonUIStrings.l_WordDocumentModes_FloodgatePromptTitle),this.oa.$("WordDocumentModes_FloodgatePromptQuestion",
CommonUIStrings.l_WordDocumentModes_FloodgatePromptQuestion),this.oa.$("WordDocumentModes_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_YesLabel),this.oa.$("WordDocumentModes_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_NoLabel),this.oa.$("WordDocumentModes_FloodgateRatingQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateRatingQuestion),this.oa.$("WordDocumentModes_FloodgateRating_1",CommonUIStrings.l_WordDocumentModes_FloodgateRating_1),
this.oa.$("WordDocumentModes_FloodgateRating_5",CommonUIStrings.l_WordDocumentModes_FloodgateRating_5),this.oa.$("WordDocumentModes_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateWhyQuestion),this.oa.$("WordDesignerFloodgateTitle",CommonUIStrings.l_WordDesigner_FeedbackTitle),this.oa.$("WordDesignerFloodgatePrompt",CommonUIStrings.l_WordDesigner_FeedbackPrompt),this.oa.$("WordDesignerFloodgatePromptYesLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_YesLabel),this.oa.$("WordDesignerFloodgatePromptNoLabel",
CommonUIStrings.l_WordDesigner_FloodgatePrompt_NoLabel),this.oa.$("WordDesignerFloodgateRatingQuestion",CommonUIStrings.l_WordDesigner_FeedbackRatingQuestion),this.oa.$("WordDesignerFloodgateMinRating",CommonUIStrings.l_WordDesigner_FeedbackMinRating),this.oa.$("WordDesignerFloodgateMaxRating",CommonUIStrings.l_WordDesigner_FeedbackMaxRating),this.oa.$("WordDesignerFloodgateQuestion",CommonUIStrings.l_WordDesigner_FeedbackQuestion1),this.oa.$("WordDesignerBlankDocumentExperienceTitle",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedTitle),
this.oa.$("WordDesignerBlankDocumentExperienceRatingQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedRatingQuestion),this.oa.$("WordDesignerBlankDocumentExperienceCommentQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedCommentQuestion),this.oa.$("WordDesignerT2ISurveyQuestion",CommonUIStrings.l_WordDesigner_T2ISurveyQuestion),this.oa.$("WordDesignerPQSurveyQuestion",CommonUIStrings.l_WordDesigner_PQSurveyQuestion),this.oa.$("WordDesignerFormattingSuggestionsSurveyQuestion",
CommonUIStrings.l_WordDesigner_FormattingSuggestionsSurveyQuestion),this.oa.$("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",CommonUIStrings.l_WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion),this.oa.$("WordDesignerDesignerPasteFeedbackRatingQuestion",Yb.Jhj()),this.oa.$("WordDesignerHideSuggestionsQuestion",CommonUIStrings.l_WordDesigner_HideSuggestionsQuestion),this.oa.$("WordDesignerHideSuggestionsAnswer1",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_1),this.oa.$("WordDesignerHideSuggestionsAnswer2",
CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_2),this.oa.$("WordDesignerHideSuggestionsAnswer3",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_3),this.oa.$("WordDesignerHideSuggestionsAnswer4",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_4),this.oa.$("FpsInDocSearch_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptTitle),this.oa.$("FpsInDocSearch_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptQuestion),this.oa.$("FpsInDocSearch_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FpsInDocSearch_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FpsInDocSearch_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateRatingQuestion),this.oa.$("FpsInDocSearch_FloodgateRating_1",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_1),this.oa.$("FpsInDocSearch_FloodgateRating_2",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_2),this.oa.$("FpsInDocSearch_FloodgateRating_3",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_3),
this.oa.$("FpsInDocSearch_FloodgateRating_4",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_4),this.oa.$("FpsInDocSearch_FloodgateRating_5",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_5),this.oa.$("FpsInDocSearch_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateWhyQuestion),this.oa.$("FpsInDocQna_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocQna_FloodgatePromptTitle),this.oa.$("FpsInDocQna_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocQna_FloodgatePromptQuestion),this.oa.$("FpsInDocQna_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FpsInDocQna_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FpsInDocQna_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateRatingQuestion),this.oa.$("FpsInDocQna_FloodgateRating_1",CommonUIStrings.l_FpsInDocQna_FloodgateRating_1),this.oa.$("FpsInDocQna_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.oa.$("FpsInDocQna_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.oa.$("FpsInDocQna_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.oa.$("FpsInDocQna_FloodgateRating_5",CommonUIStrings.l_FpsInDocQna_FloodgateRating_5),this.oa.$("FpsInDocQna_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateWhyQuestion),this.oa.$("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.oa.$("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.oa.$("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),
this.oa.$("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.oa.$("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.oa.$("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.oa.$("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.oa.$("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.oa.$("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),
this.oa.$("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.oa.$("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.oa.$("ClientPaginationSurvey_Title",CommonUIStrings.l_WAC_ClientPaginationSurvey_Title),this.oa.$("ClientPaginationSurvey_Question",CommonUIStrings.l_WAC_ClientPaginationSurvey_Question),this.oa.$("ClientPaginationSurvey_YesLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_YesLabel),this.oa.$("ClientPaginationSurvey_NoLabel",
CommonUIStrings.l_WAC_ClientPaginationSurvey_NoLabel),this.oa.$("ClientPaginationSurvey_RatingQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingQuestion),this.oa.$("ClientPaginationSurvey_RatingValue_1",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_1),this.oa.$("ClientPaginationSurvey_RatingValue_2",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_2),this.oa.$("ClientPaginationSurvey_RatingValue_3",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_3),this.oa.$("ClientPaginationSurvey_RatingValue_4",
CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_4),this.oa.$("ClientPaginationSurvey_RatingValue_5",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_5),this.oa.$("ClientPaginationSurvey_WhyQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_WhyQuestion),this.oa.$("CIQAtInvokeFPS_Title",CommonUIStrings.l_WAC_CIQAtInvokeFPS_Title),this.oa.$("CIQAtInvokeFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("CIQAtInvokeFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("CIQAtInvokeFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("CIQAtInvokeFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_RatingQuestion),this.oa.$("CIQAtInvokeFPS_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.oa.$("CIQAtInvokeFPS_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.oa.$("CIQAtInvokeFPS_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.oa.$("CIQAtInvokeFPS_RatingValue_4",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.oa.$("CIQAtInvokeFPS_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.oa.$("CIQAtInvokeFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_WhyQuestion),this.oa.$("ConditionalFormatting_PromptLine_1",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_1),this.oa.$("ConditionalFormatting_PromptLine_2",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_2),this.oa.$("ConditionalFormatting_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ConditionalFormatting_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ConditionalFormatting_RatingQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_RatingQuestion),this.oa.$("ConditionalFormatting_RatingValue_1",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_1),this.oa.$("ConditionalFormatting_RatingValue_2",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_2),this.oa.$("ConditionalFormatting_RatingValue_3",
CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_3),this.oa.$("ConditionalFormatting_RatingValue_4",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_4),this.oa.$("ConditionalFormatting_RatingValue_5",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_5),this.oa.$("ConditionalFormatting_CommentQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_CommentQuestion),this.oa.$("InAppNotification_Title",CommonUIStrings.l_WAC_InAppNotification_Title),this.oa.$("InAppNotification_Description",
CommonUIStrings.l_WAC_InAppNotification_Description),this.oa.$("InAppNotification_Button1_AddinTab",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinTab),this.oa.$("InAppNotification_Button1_AddinButton",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinButton),this.oa.$("InAppNotification_Button2",CommonUIStrings.l_WAC_InAppNotification_Button2),this.oa.$("BlueDotsFPS_Title",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("BlueDotsFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("BlueDotsFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("BlueDotsFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("BlueDotsFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_RatingQuestion),this.oa.$("BlueDotsFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.oa.$("BlueDotsFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.oa.$("BlueDotsFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),
this.oa.$("BlueDotsFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.oa.$("BlueDotsFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.oa.$("BlueDotsFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_WhyQuestion),this.oa.$("WordWebOpeningDocuments_FloodgatePromptTitle",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptTitle),this.oa.$("WordWebOpeningDocuments_FloodgatePromptQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptQuestion),
this.oa.$("WordWebOpeningDocuments_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_YesLabel),this.oa.$("WordWebOpeningDocuments_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_NoLabel),this.oa.$("WordWebOpeningDocuments_FloodgateRatingQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRatingQuestion),this.oa.$("WordWebOpeningDocuments_FloodgateRating_1",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_1),this.oa.$("WordWebOpeningDocuments_FloodgateRating_2",
CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_2),this.oa.$("WordWebOpeningDocuments_FloodgateRating_3",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_3),this.oa.$("WordWebOpeningDocuments_FloodgateRating_4",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_4),this.oa.$("WordWebOpeningDocuments_FloodgateRating_5",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_5),this.oa.$("WordWebOpeningDocuments_FloodgateTellUsMoreQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateTellUsMore),
this.oa.$("WordCommentReaction_FloodgatePromptTitle",CommonUIStrings.l_WordCommentReaction_FloodgatePromptTitle),this.oa.$("WordCommentReaction_FloodgatePromptQuestion",CommonUIStrings.l_WordCommentReaction_FloodgatePromptQuestion),this.oa.$("WordCommentReaction_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_YesLabel),this.oa.$("WordCommentReaction_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_NoLabel),this.oa.$("WordCommentReaction_FloodgateRatingQuestion",
CommonUIStrings.l_WordCommentReaction_FloodgateRatingQuestion),this.oa.$("WordCommentReaction_FloodgateRating_1",CommonUIStrings.l_WordCommentReaction_FloodgateRating_1),this.oa.$("WordCommentReaction_FloodgateRating_2",CommonUIStrings.l_WordCommentReaction_FloodgateRating_2),this.oa.$("WordCommentReaction_FloodgateRating_3",CommonUIStrings.l_WordCommentReaction_FloodgateRating_3),this.oa.$("WordCommentReaction_FloodgateRating_4",CommonUIStrings.l_WordCommentReaction_FloodgateRating_4),this.oa.$("WordCommentReaction_FloodgateRating_5",
CommonUIStrings.l_WordCommentReaction_FloodgateRating_5),this.oa.$("WordCommentReaction_FloodgateWhyQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateWhyQuestion),this.oa.$("GuestCoauthoring_FloodgatePromptTitle",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptTitle),this.oa.$("GuestCoauthoring_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptQuestion),this.oa.$("GuestCoauthoring_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_YesLabel),this.oa.$("GuestCoauthoring_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WAC_GuestCoauthSurvey_NoLabel),this.oa.$("GuestCoauthoring_FloodgateQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_FloodgateQuestion),this.oa.$("GuestCoauthoring_FloodgateRatingValue_1",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_1),this.oa.$("GuestCoauthoring_FloodgateRatingValue_2",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_2),this.oa.$("GuestCoauthoring_FloodgateRatingValue_3",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_3),this.oa.$("GuestCoauthoring_FloodgateRatingValue_4",
CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_4),this.oa.$("GuestCoauthoring_FloodgateRatingValue_5",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_5),this.oa.$("GuestCoauthoring_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingQuestion),this.oa.$("CtrlClickExperience_FloodgatePromptTitle",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptTitle),this.oa.$("CtrlClickExperience_FloodgatePromptQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptQuestion),
this.oa.$("CtrlClickExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_YesLabel),this.oa.$("CtrlClickExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_NoLabel),this.oa.$("CtrlClickExperience_FloodgateRatingQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateRatingQuestion),this.oa.$("CtrlClickExperience_FloodgateRating_1",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_1),this.oa.$("CtrlClickExperience_FloodgateRating_2",
CommonUIStrings.l_CtrlClickExperience_FloodgateRating_2),this.oa.$("CtrlClickExperience_FloodgateRating_3",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_3),this.oa.$("CtrlClickExperience_FloodgateRating_4",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_4),this.oa.$("CtrlClickExperience_FloodgateRating_5",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_5),this.oa.$("CtrlClickExperience_FloodgateWhyQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateWhyQuestion),this.oa.$("WordTypingResponsiveness_FloodgatePromptTitle",
CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptTitle),this.oa.$("WordTypingResponsiveness_FloodgatePromptQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptQuestion),this.oa.$("WordTypingResponsiveness_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_YesLabel),this.oa.$("WordTypingResponsiveness_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_NoLabel),this.oa.$("WordTypingResponsiveness_FloodgateRatingQuestion",
CommonUIStrings.l_WordTypingResponsiveness_FloodgateRatingQuestion),this.oa.$("WordTypingResponsiveness_FloodgateRating_1",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_1),this.oa.$("WordTypingResponsiveness_FloodgateRating_2",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_2),this.oa.$("WordTypingResponsiveness_FloodgateRating_3",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_3),this.oa.$("WordTypingResponsiveness_FloodgateRating_4",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_4),
this.oa.$("WordTypingResponsiveness_FloodgateRating_5",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_5),this.oa.$("WordTypingResponsiveness_FloodgateWhyQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateWhyQuestion),this.oa.$("ShareSection_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_PromptLine_1),this.oa.$("ShareSection_PromptLine_2",CommonUIStrings.l_Excel_ShareSection_PromptLine_2),this.oa.$("ShareSection_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ShareSection_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ShareSection_RatingQuestion",CommonUIStrings.l_Excel_ShareSection_RatingQuestion),this.oa.$("ShareSection_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.oa.$("ShareSection_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.oa.$("ShareSection_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.oa.$("ShareSection_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),
this.oa.$("ShareSection_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.oa.$("ShareSection_CommentQuestion",CommonUIStrings.l_Excel_ShareSection_CommentQuestion),this.oa.$("ShareSection_LinkCreation_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_LinkGeneration_PromptLine_1),this.oa.$("WordUnsavedPrompt_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("WordUnsavedPrompt_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("WordUnsavedPrompt_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("WordUnsavedPrompt_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordUnsavedPrompt_FloodgateRatingQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRatingQuestion),this.oa.$("WordUnsavedPrompt_FloodgateRating_1",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_1),this.oa.$("WordUnsavedPrompt_FloodgateRating_2",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_2),
this.oa.$("WordUnsavedPrompt_FloodgateRating_3",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_3),this.oa.$("WordUnsavedPrompt_FloodgateRating_4",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_4),this.oa.$("WordUnsavedPrompt_FloodgateRating_5",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_5),this.oa.$("WordUnsavedPrompt_FloodgateWhyQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateWhyQuestion),this.oa.$("ExcelLive_PromptLine_1",CommonUIStrings.l_Excel_ExcelLive_PromptLine_1),
this.oa.$("ExcelLive_PromptLine_2",CommonUIStrings.l_Excel_ExcelLive_PromptLine_2),this.oa.$("ExcelLive_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ExcelLive_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ExcelLive_RatingQuestion",CommonUIStrings.l_Excel_ExcelLive_RatingQuestion),this.oa.$("ExcelLive_RatingValue_1",CommonUIStrings.l_Excel_ExcelLive_RatingValue_1),this.oa.$("ExcelLive_RatingValue_2",CommonUIStrings.l_Excel_ExcelLive_RatingValue_2),
this.oa.$("ExcelLive_RatingValue_3",CommonUIStrings.l_Excel_ExcelLive_RatingValue_3),this.oa.$("ExcelLive_RatingValue_4",CommonUIStrings.l_Excel_ExcelLive_RatingValue_4),this.oa.$("ExcelLive_RatingValue_5",CommonUIStrings.l_Excel_ExcelLive_RatingValue_5),this.oa.$("ExcelLive_CommentQuestion",CommonUIStrings.l_Excel_ExcelLive_CommentQuestion),this.oa.$("SmartViewFormatAsTable_Prompt",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Prompt),this.oa.$("SmartViewFormatAsTable_PromptQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_PromptQuestion),
this.oa.$("SmartViewFormatAsTable_Rating_Question",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Rating_Question),this.oa.$("SmartViewFormatAsTable_RatingValue_1",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_1),this.oa.$("SmartViewFormatAsTable_RatingValue_2",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_2),this.oa.$("SmartViewFormatAsTable_RatingValue_3",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_3),this.oa.$("SmartViewFormatAsTable_RatingValue_4",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_4),
this.oa.$("SmartViewFormatAsTable_RatingValue_5",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_5),this.oa.$("SmartViewFormatAsTable_WhyQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_WhyQuestion),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_PromptTitle),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingQuestion),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_1),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_2),
this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_3),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_4),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_5),this.oa.$("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion),
this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_PromptTitle),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingQuestion),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_1),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_2),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_3),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_4),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_5),this.oa.$("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion),this.oa.$("EaseOfUse_Floodgate_Prompt_Line1",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line1),this.oa.$("EaseOfUse_Floodgate_Prompt_Line2",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line2),
this.oa.$("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Affirmative_Answer),this.oa.$("EaseOfUse_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Negative_Answer),this.oa.$("EaseOfUse_Floodgate_Rating_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Question),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_1",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_1),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_2",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_2),
this.oa.$("EaseOfUse_Floodgate_Rating_Scale_3",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_3),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_4",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_4),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_5",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_5),this.oa.$("EaseOfUse_Floodgate_Comment_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Comment_Question),this.oa.$("PerformanceExperience_PromptLine_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("PerformanceExperience_PromptLine_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("PerformanceExperience_RatingQuestion",Yb.V0b(0)),this.oa.$("PerformanceExperience_RatingQuestion_OpenFile",Yb.V0b(1)),this.oa.$("PerformanceExperience_RatingQuestion_Responsivness",Yb.V0b(2)),this.oa.$("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",Yb.V0b(3)),this.oa.$("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",Yb.V0b(4)),this.oa.$("PerformanceExperience_RatingValue_1",
CommonUIStrings.l_Excel_Rating_1_Satisfied),this.oa.$("PerformanceExperience_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.oa.$("PerformanceExperience_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.oa.$("PerformanceExperience_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.oa.$("PerformanceExperience_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.oa.$("PerformanceExperience_CommentQuestion",CommonUIStrings.l_Excel_PerformanceExperience_CommentQuestion),
this.oa.$("CleanData_PromptTitle",CommonUIStrings.l_Excel_CleanData_Survey_PromptTitle),this.oa.$("CleanData_PromptQuestion",CommonUIStrings.l_Excel_CleanData_Survey_PromptQuestion),this.oa.$("CleanData_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("CleanData_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("CleanData_RatingQuestion",CommonUIStrings.l_Excel_CleanData_Survey_RatingQuestion),this.oa.$("CleanData_RatingValue_1",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_1),
this.oa.$("CleanData_RatingValue_2",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_2),this.oa.$("CleanData_RatingValue_3",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_3),this.oa.$("CleanData_RatingValue_4",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_4),this.oa.$("CleanData_RatingValue_5",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_5),this.oa.$("CleanData_CommentQuestion",CommonUIStrings.l_Excel_CleanData_Survey_CommentQuestion),this.oa.$("DarkModeSurvey_Title",CommonUIStrings.l_WAC_DarkModeSurvey_Title),
this.oa.$("DarkModeSurvey_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("DarkModeSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("DarkModeSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("DarkModeSurvey_RatingQuestion",CommonUIStrings.l_WAC_DarkModeSurvey_RatingQuestion),this.oa.$("DarkModeSurvey_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("DarkModeSurvey_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),
this.oa.$("DarkModeSurvey_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("DarkModeSurvey_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.oa.$("DarkModeSurvey_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("DarkModeSurvey_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyThatRatingQuestion),this.oa.$("Fluent2Survey_Title",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_1),
this.oa.$("Fluent2Survey_Question",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_2),this.oa.$("Fluent2Survey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("Fluent2Survey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("Fluent2Survey_RatingQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question),this.oa.$("Fluent2Survey_RatingValue_1",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_1),this.oa.$("Fluent2Survey_RatingValue_2",
CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_2),this.oa.$("Fluent2Survey_RatingValue_3",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_3),this.oa.$("Fluent2Survey_RatingValue_4",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_4),this.oa.$("Fluent2Survey_RatingValue_5",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_5),this.oa.$("Fluent2Survey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),
this.oa.$("Fluent2OptOutSurvey_Title",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1),this.oa.$("Fluent2OptOutSurvey_Question",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2),this.oa.$("Fluent2OptOutSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("Fluent2OptOutSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("Fluent2OptOutSurvey_RatingQuestion",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question),
this.oa.$("Fluent2OptOutSurvey_RatingValue_1",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1),this.oa.$("Fluent2OptOutSurvey_RatingValue_2",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2),this.oa.$("Fluent2OptOutSurvey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.oa.$("ConsumerExperiment_PromptTitle",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptTitle),this.oa.$("ConsumerExperiment_PromptQuestion",
CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptQuestion),this.oa.$("ConsumerExperiment_RatingQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingQuestion),this.oa.$("ConsumerExperiment_RatingValue1",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_1),this.oa.$("ConsumerExperiment_RatingValue2",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_2),this.oa.$("ConsumerExperiment_RatingValue3",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_3),this.oa.$("ConsumerExperiment_RatingValue4",
CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_4),this.oa.$("ConsumerExperiment_RatingValue5",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_5),this.oa.$("ConsumerExperiment_VerbatimQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_Verbatim_Question),this.oa.$("ConsumerExperiment_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ConsumerExperiment_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("AIMakerSurvey_Title",CommonUIStrings.l_AIMakerSurvey_Title),
this.oa.$("AIMakerSurvey_Question",CommonUIStrings.l_AIMakerSurvey_Question),this.oa.$("AIMakerSurvey_YesLabel",CommonUIStrings.l_AIMakerSurvey_YesLabel),this.oa.$("AIMakerSurvey_NoLabel",CommonUIStrings.l_AIMakerSurvey_NoLabel),this.oa.$("AIMakerSurvey_RatingQuestion",CommonUIStrings.l_AIMakerSurvey_RatingQuestion),this.oa.$("AIMakerSurvey_MinRating",CommonUIStrings.l_AIMakerSurvey_MinRating),this.oa.$("AIMakerSurvey_MaxRating",CommonUIStrings.l_AIMakerSurvey_MaxRating),this.oa.$("AIMakerSurvey_CommentQuestion",
CommonUIStrings.l_AIMakerSurvey_CommentQuestion),this.oa.$("CheckPerformance_Prompt",CommonUIStrings.l_Excel_CheckPerformance_Prompt),this.oa.$("CheckPerformance_PromptQuestion",CommonUIStrings.l_Excel_CheckPerformance_PromptQuestion),this.oa.$("CheckPerformance_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("CheckPerformance_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("CheckPerformance_RatingQuestion",CommonUIStrings.l_Excel_CheckPerformance_RatingQuestion),
this.oa.$("CheckPerformance_RatingValue_1",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_1),this.oa.$("CheckPerformance_RatingValue_2",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_2),this.oa.$("CheckPerformance_RatingValue_3",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_3),this.oa.$("CheckPerformance_RatingValue_4",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_4),this.oa.$("CheckPerformance_RatingValue_5",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_5),this.oa.$("CheckPerformance_CommentQuestion",
CommonUIStrings.l_Excel_CheckPerformance_CommentQuestion),this.oa.$("SmartSuggestion_PromptTitle",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptTitle),this.oa.$("SmartSuggestion_PromptQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.oa.$("SmartSuggestion_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("SmartSuggestion_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("SmartSuggestion_RatingQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingQuestion),
this.oa.$("SmartSuggestion_RatingValue_1",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.oa.$("SmartSuggestion_RatingValue_2",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.oa.$("SmartSuggestion_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.oa.$("SmartSuggestion_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.oa.$("SmartSuggestion_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),
this.oa.$("SmartSuggestion_CommentQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion)}catch(ob){h.ULS.sendTraceTag(594052319,356,15,"SIFB.InitializeUIStringGetter error "+(ob?ob.toString():""))}}static RDi(ob){try{return new Promise(cc=>{window.setTimeout(()=>{cc(null)},ob)})}catch(cc){return h.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),Promise.resolve(null)}}static V9f(){return!n.AFrameworkApplication.fa.ka("FloodgateGovernanceServiceIsDisabled")}static g$i(){return n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",
!1)}static TNd(ob){const cc=ob?ob[0]:null;h.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+(cc?cc.surfaceId:""));if(cc&&"customsurface"===(cc&&cc.surfaceType?cc.surfaceType.toLocaleLowerCase():null)){const sb=za.a.xpj(cc);if(sb)return h.ULS.sendTraceTag(555071522,356,50,"SIFB Info:Floodgate activation result - "+sb+", "+cc.surfaceId),null}return Rb.TNd(ob)}static J3i(){const ob={};ob.retry=n.AFrameworkApplication.fa.Ec("FloodgateGovernanceServiceRetryCount",0);ob.timeout=
n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",1E4);ob.simpleRequestEnabled=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceSimpleRequestEnabled",!1);ob.forceServicelessSurveyDisplay=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",!1);return ob}static Gvi(ob){if(!("Unknown"!==ob&&
"Automation"!==ob&&n.AFrameworkApplication.fa.ka("FloodgateAuthCallbackIsEnabled")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",!1)))return h.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+ob),null;ob={};ob.getUserPuid=Yb.Lgj;return ob}static Evi(){const ob={},cc=!n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsDisabled",!1)&&(n.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||
n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsEnabled",!1));ob.isEnabled=cc;return ob}static Lgj(){return n.AFrameworkApplication.fa.Ha("Puid")}static Efg(){return za.a.usa()?CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Word}static Dfg(){return za.a.usa()?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint}static Cfg(){return za.a.usa()&&
n.AFrameworkApplication.fa.ka("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel}static V0b(ob){if(za.a.usa())switch(ob){case 1:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;
case 4:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion}switch(ob){case 1:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;
default:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion}}static Ghj(){return za.a.usa()&&n.AFrameworkApplication.fa.ka("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote}static Ihj(){return za.a.usa()?CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionForTeams:CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestion}static Hhj(){return za.a.usa()?CommonUIStrings.l_OnenotePerf_FloodgatePromptTitleForTeams:
CommonUIStrings.l_OnenotePerf_FloodgatePromptTitle}static Jhj(){switch(n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return CommonUIStrings.l_WordDesigner_FormatWithDesignerFeedbackRatingQuestion;case 2:return CommonUIStrings.l_WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion;case 3:return CommonUIStrings.l_WordDesigner_UseSmartPasteFeedbackRatingQuestion;default:return""}}}Yb.bcb="SystemInitiatedFeedbackIsEnabled";
Yb.jii="obf-CampaignDefinitions";Yb.sUf=100;Yb.wDi=8002;Object(J.a)(Yb,"SystemInitiatedFeedback",null,[1296]);class Tc{constructor(ob){if(!ob)throw Error.argumentNull("SystemInitiatedFeedback is null");this.Huf=ob;this.Nnd={};this.Coc={};this.Knd={}}logActivity(ob,cc,sb){const mb=new Date;if(!ob||!this.Huf.x5a(ob,Yb.bcb,cc))return!1;let Pb=null;ob in this.Nnd&&(Pb=this.Nnd[ob]);const dc=this.XWi(ob),mc=this.WWi(ob);if(this.JKi(Pb,mb,sb))return h.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",
dc,ob),this.Huf.logActivity(ob,cc),this.Nnd[ob]=mb,this.Coc[ob]=0,this.Knd[ob]=mc+1,!0;this.Coc[ob]=dc+1;return!1}JKi(ob,cc,sb){return ob?cc.getTime()-ob.getTime()>=1E3*sb:!0}XWi(ob){let cc=0;ob in this.Coc&&(cc=this.Coc[ob]);return cc}WWi(ob){let cc=0;ob in this.Knd&&(cc=this.Knd[ob]);return cc}}Object(J.a)(Tc,"SystemInitiatedFeedbackWithTimeLapse",null,[1294]);var ib=d(93),Zb=d(68);d.d(V,"CustomerFeedbackPackage",function(){return Cc});class Cc{constructor(){this.XYe=this.Da=null}get name(){return"Common.App.CustomerFeedback"}Wb(ob){n.AFrameworkApplication.Pg||
(h.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),n.AFrameworkApplication.Pg=new A.a);ob.register(T,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").ma();ob.register(qa,"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").ma().na(()=>new qa(ib.FocusManager.instance(),n.AFrameworkApplication.Pg));ob.register(H,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").ma().na(()=>
new H(ob.resolve("Common.App.ICustomerFeedbackUiWrapper"),ob.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),n.AFrameworkApplication.Pg));ob.register(1271,"Common.ICustomerFeedbackActor").ma().na(()=>new I(n.AFrameworkApplication.Ta,n.AFrameworkApplication.Aa,ob.La("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),n.AFrameworkApplication.fa,n.AFrameworkApplication.Pg));ob.register(Yb,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").ma().na(()=>
new Yb(ob.resolve("Common.App.ICustomerFeedbackUiWrapper")));ob.register(Tc,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").ma().na(()=>new Tc(ob.resolve("Common.ISystemInitiatedFeedback")));this.Da=ob}init(){Cc._initialized||(Cc.l5b()||(this.XYe=this.Da.resolve("Common.ICustomerFeedbackActor"),this.XYe.ub(),n.AFrameworkApplication.Aa.updateCommandUI()),this.Da.La("Common.App.IAppSpecificFeedbackData").execute(()=>{this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback");
this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse")}),Cc._initialized=!0)}dispose(){}static l5b(){return!!n.AFrameworkApplication.Aa&&!!n.AFrameworkApplication.Aa.gb&&3===n.AFrameworkApplication.Aa.gb.Am&&1===n.AFrameworkApplication.Aa.gb.vGa}static main(){let ob=!1;Cc.l5b()&&(ob=!0);Zb.a.instance.Ac(new Cc,0,ob)}}Cc._initialized=!1;Object(J.a)(Cc,"CustomerFeedbackPackage",null,[2,3])},1107:function(J,V,d){J=d(0);var h=d(13),e=d(33);class m{constructor(){this.classId=
0}static z4a(y){try{return e.a(y)}catch(u){}return null}}Object(J.a)(m,"ARoamingAppsResponse",null,[]);class n{constructor(){this.state=this.callback=null;this.D8d=!1}}Object(J.a)(n,"GetRoamingAppsLauncherContext",null,[]);var v=d(25),A=d(78);d.d(V,"a",function(){return w});class w{constructor(y){this.ypd=!1;this.h6=w.H7a;this.EAd=this.Yxd=0;this.platform=null;this.PTh=y;this.tyf=this.FAd=!1}get zFe(){return this.PTh}get Vxl(){return this.zFe&&this.FAd?this.tyf:!1}Fli(){v.AFrameworkApplication.b4b&&
this.zFe&&!this.FAd&&!this.ypd&&(this.EAd=3,this.ypd=!0,this.HTk(),this.j0f())}HTk(){this.h6=w.H7a;this.Yxd=0}getRoamingAppsLauncher(y,u,E){this.Vxl?(y=new n,y.callback=u,y.state=E,y.D8d=!0,this.o0f(y)):u(!1,"",E)}j0f(){const y=new (d(1084).CheckRoamingRightsRequest);y.RoamingApp=this.EAd;y.BaseDocQuerySignature=v.AFrameworkApplication.Zg;y.execute(Object(h.a)(this,this.Hli,"checkUserRoamingRightsSucceeded"),Object(h.a)(this,this.Gli,"checkUserRoamingRightsFailed"),null)}Hli(y){v.AFrameworkApplication.Xg||
((y=m.z4a(y.data.Zd))?this.rJe(y.HasRights):this.rJe(!1))}Gli(){if(!v.AFrameworkApplication.Xg)if(this.Yxd>=w.Fbk)this.rJe(!1);else{var y=new A.a(2,1,this.h6,Object(h.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);v.AFrameworkApplication.ue.Gb(y);this.Yxd++;this.h6*=w.pFe;this.h6>w.Ibc&&(this.h6=w.Ibc)}}rJe(y){this.tyf=y;this.FAd=!0;this.ypd=!1}retryCheckUserRoamingRights(){this.j0f()}o0f(y){const u=new (d(1085).GetRoamingLauncherRequest);u.RoamingApp=this.EAd;u.BaseDocQuerySignature=
v.AFrameworkApplication.Zg;u.execute(Object(h.a)(this,this.xaj,"getRoamingAppsLauncherSucceeded"),Object(h.a)(this,this.waj,"getRoamingAppsLauncherFailed"),y)}xaj(y){if(!v.AFrameworkApplication.Xg){var u=m.z4a(y.data.Zd);y=y.data.state;u?(this.platform=u.Platform,y.callback(!0,u.Launcher,y.state)):y.callback(!1,"",y.state)}}waj(y){if(!v.AFrameworkApplication.Xg){var u=y.data.state;5===y.data.status&&u.D8d?(u.D8d=!1,this.o0f(u)):u.callback(!1,"",u.state)}}static get instance(){return w.it||(w.it=new w(v.AFrameworkApplication.e$h))}}
w.H7a=1E3;w.pFe=5;w.Ibc=12E5;w.Fbk=5;w.it=null;Object(J.a)(w,"RoamingAppsManager",null,[])},1108:function(J,V,d){J=d(0);var h=d(13),e=d(934),m=d(65);class n extends e.a{constructor(G,I,H,K,C,Y=null){super(G,H,C.VQ,Y);this.Vdf=0;this.w$=this.j7i(K);this.lmb=I;this.Kh=C;this.NPe=7;this.Kr=this.lmb.ownerDocument.createElement("div");this.Kr.className="ModalCalloutControlOverlay";this.Kr.tabIndex=0;this.lmb.insertBefore(this.Kr,this.lmb.firstChild)}show(){this.AK||(this.Kh.zdb(),this.Kh.lNa(!1),this.Kr.style.zIndex=
String(this.Kh.gpa),super.show(),this.dw(),this.Vdf=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.NPe))}dismiss(){this.AK&&(this.Kh.VOa(!1),this.ena(),this.lmb&&this.lmb.contains(this.Kr)&&this.lmb.removeChild(this.Kr),super.dismiss(),window.clearTimeout(this.Vdf))}dw(){this.Kh.Lga(Object(h.a)(this,this.dismiss,"dismiss"));this.Kh.Xx.ob(m.a.click,this.Kr,Object(h.a)(this,this.onClick,"onClick"))}ena(){this.Kh.$Wa(Object(h.a)(this,this.dismiss,"dismiss"));this.Kh.Xx.xb(m.a.click,
this.Kr,Object(h.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}j7i(G){let I=0;switch(G){case 0:I=190;break;case 1:I=250;break;case 2:I=300;break;case 3:I=360}return I}}Object(J.a)(n,"ModalCallout",e.a,[]);var v=d(375),A=d(340),w=d(138);class y extends n{constructor(G,I,H,K,C,Y=null){super(G,I,H,K,C,Y);this.ruc=null}show(){if(!this.AK){const G=Object.assign(new A.a,{onShow:()=>{n.prototype.show.call(this)}});w.UISurfaces.VM().then(I=>{const H=I.externalNotification();this.ruc=
I.addNotification(H,G);return null},I=>{v.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",I);return null})}}dismiss(){this.AK&&this.ruc&&(w.UISurfaces.VM().then(G=>{G.removeNotification(this.ruc);return this.ruc=null},G=>{v.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null}),super.dismiss())}}Object(J.a)(y,"ReactManagedModalCallout",n,[]);var u=d(25);d.d(V,"a",function(){return E});class E{static UOd(G,I,H,K,C=null){return u.AFrameworkApplication.Aa.gb.ZRa?
new y(G,I,H,K,u.AFrameworkApplication.Aa,C):new n(G,I,H,K,u.AFrameworkApplication.Aa,C)}}Object(J.a)(E,"ModalCalloutControlFactory",null,[])},1109:function(J,V,d){d.r(V);J=d(0);var h=d(508),e=d(509);class m{constructor(w){this.QO=this.FXe=h.a.unused;this.Wwc=w}get Nob(){return this.FXe}aue(w,y,u,E){u===this.Wwc.element&&(this.FXe=w,this.QO=E+this.Wwc.offset)}Xve(){}YJd(w){return this.Nob!==h.a.unused?Object.assign(new e.a,{element:w,offset:this.QO}):null}}Object(J.a)(m,"ChildSelectionHelper",null,
[1459]);class n{constructor(w,y){this.qxd=!1;this.Wwc=y;this._parent=w;this.QO=y.offset}get Nob(){return h.a.unused}aue(w,y,u,E){y||this.Wwc.offset!==w||(this.QO=E,this.qxd=!0)}Xve(w,y){!this.qxd&&this.QO>y&&(this.QO-=y-w+1)}YJd(w){return Object.assign(new e.a,{element:this.qxd?w:this._parent,offset:this.QO})}}Object(J.a)(n,"ParentSelectionHelper",null,[1459]);var v=d(888);d.d(V,"CombineHelper",function(){return A});class A{constructor(w,y,u){this.b1e=h.a.unused;this.eLb="";this._element=w;this.hRb=
y;this.KQb=this.I7f(w,u.start);this.HQb=this.I7f(w,u.end)}I7f(w,y){return y.element===w?new n(w,y):new m(y)}G1h(w){const y=w===this.hRb,u=this._element.childNodes[w],E=this.eLb.length;this.KQb.aue(w,y,u,E);this.HQb.aue(w,y,u,E);this.eLb+=u.nodeValue}end(w,y){this.hRb!==y&&(this.b1e=y,Array.add(w,this))}Roi(){var w=this.a$i();this.Hbh(this.hRb,w-1);this.Hbh(w+1,this.b1e);w=this._element.childNodes[this.hRb];this.eLb!==w.nodeValue&&(w.nodeValue=this.eLb);return this.$ei(w)}Hbh(w,y){if(!(y<w)){this.KQb.Xve(w,
y);this.HQb.Xve(w,y);for(let u=w;u<=y;u++)this._element.removeChild(this._element.childNodes[w])}}$ei(w){return Object.assign(new v.a,{start:this.KQb.YJd(w),end:this.HQb.YJd(w)})}a$i(){return this.KQb.Nob!==h.a.unused?this.KQb.Nob:this.HQb.Nob!==h.a.unused?this.HQb.Nob:this.hRb}}Object(J.a)(A,"CombineHelper",null,[])},1114:function(J,V,d){J=d(0);var h=d(1157),e=d(375),m=d(25),n=d(78),v=d(66);class A{static Lhj(){if(!A.Koc&&(A.Koc=new v.a,m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.Aw("AggregatorIdDisabledList"))){const u=
m.AFrameworkApplication.fa.HB("AggregatorIdDisabledList");for(let E=0;E<u.length;E++)A.Koc.$(u[E],!0)}return A.Koc}}A.Koc=null;Object(J.a)(A,"DisabledAggregatorListStore",null,[]);var w=d(281);d.d(V,"a",function(){return y});class y{constructor(u,E,G,I,H,K=!0,C=null){this.Q_e=this.Nvf=this.Gaf=!1;this.Rd=null;if(!u)throw w.a.argument("taskManagerLazy");if(!H)throw w.a.argument("dataAggregator");this.oWh=u;this.lyd=E;this._id=G;this.S5e=6E4*I;this.qqc=H;this.Nrf=K;this.xQb=C;A.Lhj().Jb(this._id.toString())&&
(this.Q_e=!0)}get taskManager(){return this.Rd||(this.Rd=this.oWh.value)}track(u,E=null){this.Q_e||(this.bMi(),this.YXk(),this.qqc.XSb(u,E))}YXk(){!this.Gaf&&0<this.S5e&&(this.Gaf=!0,this.kih())}kih(){const u=new n.a(5,1,this.S5e,()=>{this.DZk()},19,this._id.toString());this.taskManager.Gb(u)}DZk(){!this.xQb||this.xQb.pKe()?this.Med():this.Nrf&&this.qqc.reset();this.kih()}Med(){const u=this.qqc.getData();if(u){const E=parseInt(String(u.length));if(isNaN(E)||0<E)this.Cjh(u),this.Nrf&&this.qqc.reset()}}Cjh(u){e.ULS.sendTraceTag(7079840,
335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:u})}bMi(){this.Nvf||(this.lyd(()=>{this.Med()}),this.Nvf=!0)}static dr(u,E,G,I,H){return new y(new h.a(()=>m.AFrameworkApplication.ue),m.AFrameworkApplication.Iea,u,E,G,I,H)}static qV(u,E,G,I=!0){return y.dr(u,E,G,I,null)}}Object(J.a)(y,"Aggregator",null,[1223])},1185:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]=
"safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(h||(h={}));Object(J.b)("BrowserCode",h)},1186:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.value=!1}}Object(J.a)(h,"OutBool",null,[])},1187:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(J.a)(h,"ColorCellProps",null,[])},1188:function(J,
V,d){d.d(V,"a",function(){return h});J=d(0);d=d(347);class h extends d.a{constructor(){super();this.Style=this.Character=null}get Type(){return 1}}Object(J.a)(h,"CharacterCodeGalleryButtonProps",d.a,[])},1189:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(504);class e{constructor(m){this.Maa=m}pHe(m){return h.a.then(this.Maa.Fmb(m,1,"",{"Content-Type":"application/json; charset=utf-8"},0,void 0,void 0,void 0,void 0,void 0,"2"),n=>this.paj(n))}paj(m){return m&&m.Ri&&m.Ri.data?m.Ri.data.Zd:
null}}Object(J.a)(e,"SimpleRequestManager",null,[1488])},1190:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(347);class h extends d.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(J.a)(h,"IconGalleryButtonProps",d.a,[])},1191:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(296);class h{}h.LabelText=d.a.labelText;h.Alt=d.a.alt;h.Image16by16Class=d.a.wtb;h.Image32by32Class=d.a.tCa;h.Image48by48Class=
d.a.J4d;h.Visible=d.a.visible;h.HasPopup="HasPopup";Object(J.a)(h,"ButtonCommandProperties",null,[])},1193:function(J,V,d){function h(a,b){if(!a||!b)return[];const c=new Set;a.forEach(f=>{var l;return null===(l=null===f||void 0===f?void 0:f.Fte)||void 0===l?void 0:l.forEach(x=>{x&&c.add(x)})});return Array.from(c).map(f=>b.re(Ga.a.Yf(f))).filter(f=>null!==f&&void 0!==f)}d.r(V);var e=d(0),m=d(68),n=d(54),v=d(93),A=d(177),w=d(168),y=d(119),u=d(25),E=d(1056),G=d(35),I=d(153),H=d(34);class K{constructor(a){this.value=
a}}Object(e.a)(K,"RefTriState",null,[]);var C=d(32);class Y{SCe(){this.sMi();this.atj();this.OQj();this.uYj();H.a.instance.ga(70)&&this.QBk();this.sZk();H.a.instance.ga(71)&&this.IHb();this.Wil();this.Yjl();this.CCi();this.yQj();this.wVk();this.ufl();this.dll();H.a.instance.ga(79)&&(n.a.ek||this.hvj(),this.cTj(),this.wfk(),this.Frl())}sMi(){const a=v.FocusManager.instance().Bc(I.AppFrame.nV);a.bindAction(A.KeyInputManager.Na(w.a.aq,0),C.a.enter);a.bindAction(A.KeyInputManager.Na(w.a.aq,4),C.a.ygd)}atj(){const a=
v.FocusManager.instance().Bc(I.AppFrame.nV);y.AFrame.Sj(a,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Hyperlink),C.a.insertHyperlink)}hvj(){const a=v.FocusManager.instance().Bc(y.AFrame.gj);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.afa,5),C.a.HE);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.t$,5),C.a.Ry)}yQj(){if(!n.a.Kw){const a=v.FocusManager.instance().Bc(y.AFrame.gj);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.qoc,A.KeyInputManager.Fe),C.a.wyg,Y.Keb("faOpen"))}}OQj(){const a=v.FocusManager.instance().Bc(I.AppFrame.nV);
H.a.instance.ga(54)&&y.AFrame.Sj(a,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_CenterJustify),C.a.centerJustify,Y.YI);n.a.ek?(y.AFrame.Sj(a,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_LeftJustify_Mac),C.a.leftJustify,Y.YI),y.AFrame.Sj(a,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_RightJustify_Mac),C.a.rightJustify,Y.YI)):(y.AFrame.Sj(a,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_LeftJustify),C.a.leftJustify,Y.YI),y.AFrame.Sj(a,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_RightJustify),
C.a.rightJustify,Y.YI));H.a.instance.ga(54)&&y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.fnd,A.KeyInputManager.Fe),C.a.fullJustify,Y.YI)}cTj(){var a=v.FocusManager.instance();const b=a.Bc(y.AFrame.gj);a=a.Bc(I.AppFrame.nV);y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.CJa,A.KeyInputManager.Fe),C.a.tO,Y.vWf);y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.LTe,A.KeyInputManager.Fe),C.a.XQ,Y.vWf);n.a.Lvb&&a.bindAction(A.KeyInputManager.Na(w.a.poc,4|A.KeyInputManager.Fe),C.a.tO)}uYj(){const a=v.FocusManager.instance().Bc(y.AFrame.gj);
y.AFrame.Sj(a,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_TellMe),G.a.njd,Y.YI)}wfk(){if(H.a.instance.ga(27)||H.a.instance.ga(58)){const a=v.FocusManager.instance().Bc(y.AFrame.gj),b=H.a.instance.ga(58)?C.a.HXk:C.a.save;y.AFrame.Sj(a,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Save),b);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.WUe,0),C.a.sync)}}QBk(){const a=v.FocusManager.instance().Bc(I.AppFrame.nV);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||
y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.noc,1),C.a.R5c);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.noc,0),C.a.R5c)}sZk(){this.ejh(I.AppFrame.nV);this.ejh(I.AppFrame.jCe)}ejh(a){var b=v.FocusManager.instance(),c=w.a.t$,f=w.a.afa;a=b.Bc(a);const l=b.Bc(u.AFrameworkApplication.udb);a.bindAction(A.KeyInputManager.Na(c,0),C.a.leftArrow);a.bindAction(A.KeyInputManager.Na(f,0),C.a.rightArrow);a.bindAction(A.KeyInputManager.Na(w.a.YX,0),C.a.upArrow);a.bindAction(A.KeyInputManager.Na(w.a.s5,0),C.a.downArrow);a.bindAction(A.KeyInputManager.Na(f,
4),C.a.hYa);a.bindAction(A.KeyInputManager.Na(c,4),C.a.gYa);n.a.ek?(a.bindAction(A.KeyInputManager.Na(f,1),C.a.xAa),a.bindAction(A.KeyInputManager.Na(c,1),C.a.wAa),a.bindAction(A.KeyInputManager.Na(f,5),C.a.fOa),a.bindAction(A.KeyInputManager.Na(c,5),C.a.eOa),a.bindAction(A.KeyInputManager.Na(f,8),C.a.KVa),a.bindAction(A.KeyInputManager.Na(c,8),C.a.LVa),a.bindAction(A.KeyInputManager.Na(f,12),C.a.cPa),a.bindAction(A.KeyInputManager.Na(c,12),C.a.dPa)):(a.bindAction(A.KeyInputManager.Na(f,A.KeyInputManager.Fe),
C.a.xAa),a.bindAction(A.KeyInputManager.Na(c,A.KeyInputManager.Fe),C.a.wAa),a.bindAction(A.KeyInputManager.Na(f,A.KeyInputManager.Fe|4),C.a.fOa),a.bindAction(A.KeyInputManager.Na(c,A.KeyInputManager.Fe|4),C.a.eOa));a.bindAction(A.KeyInputManager.Na(w.a.YX,4),C.a.LGb);a.bindAction(A.KeyInputManager.Na(w.a.s5,4),C.a.Xfb);a.bindAction(A.KeyInputManager.Na(w.a.YX,A.KeyInputManager.Fe),C.a.PWb);a.bindAction(A.KeyInputManager.Na(w.a.s5,A.KeyInputManager.Fe),C.a.Dpb);a.bindAction(A.KeyInputManager.Na(w.a.YX,
A.KeyInputManager.Fe|4),C.a.k4a);a.bindAction(A.KeyInputManager.Na(w.a.s5,A.KeyInputManager.Fe|4),C.a.dOa);a.bindAction(A.KeyInputManager.Na(w.a.iE,0),C.a.LVa);a.bindAction(A.KeyInputManager.Na(w.a.iE,4),C.a.dPa);if(H.a.instance.ga(41))a.bindAction(A.KeyInputManager.Na(w.a.iE,A.KeyInputManager.Fe),C.a.r5c),a.bindAction(A.KeyInputManager.Na(w.a.tw,A.KeyInputManager.Fe),C.a.sse);else if(H.a.instance.ga(17)||H.a.instance.ga(77))a.bindAction(A.KeyInputManager.Na(w.a.iE,A.KeyInputManager.Fe),C.a.lcb),
a.bindAction(A.KeyInputManager.Na(w.a.tw,A.KeyInputManager.Fe),C.a.kcb);a.bindAction(A.KeyInputManager.Na(w.a.iE,A.KeyInputManager.Fe|4),C.a.f5a);a.bindAction(A.KeyInputManager.Na(w.a.tw,0),C.a.KVa);a.bindAction(A.KeyInputManager.Na(w.a.tw,4),C.a.cPa);a.bindAction(A.KeyInputManager.Na(w.a.tw,A.KeyInputManager.Fe|4),C.a.e5a);n.a.ek&&(a.bindAction(A.KeyInputManager.Na(w.a.YX,2),C.a.LVa),a.bindAction(A.KeyInputManager.Na(w.a.YX,6),C.a.dPa),a.bindAction(A.KeyInputManager.Na(w.a.s5,2),C.a.KVa),a.bindAction(A.KeyInputManager.Na(w.a.s5,
6),C.a.cPa),a.bindAction(A.KeyInputManager.Na(w.a.iE,1),C.a.lcb),a.bindAction(A.KeyInputManager.Na(w.a.tw,1),C.a.kcb),H.a.instance.ga(6)&&(a.bindAction(A.KeyInputManager.Na(w.a.YX,5),C.a.k4a),a.bindAction(A.KeyInputManager.Na(w.a.s5,5),C.a.dOa)));c=A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_SelectAll);a.bindAction(c,C.a.Eqa);l.bindAction(c,G.a.MGc);H.a.instance.ga(79)&&(f=b.Bc(y.AFrame.XC),b=b.Bc(y.AFrame.gj),f.bindAction(c,G.a.Qza),b.bindAction(A.KeyInputManager.Na(w.a.GZa,A.KeyInputManager.Fe|
4),C.a.xed),H.a.instance.ga(41)&&n.a.ek&&(a.bindAction(A.KeyInputManager.Na(w.a.gB,1),C.a.lcb),a.bindAction(A.KeyInputManager.Na(w.a.fB,1),C.a.kcb)),b.bindAction(A.KeyInputManager.Na(w.a.fB,0),C.a.pageDown),b.bindAction(A.KeyInputManager.Na(w.a.gB,0),C.a.pageUp),b.bindAction(A.KeyInputManager.Na(w.a.fB,4),C.a.bkc),b.bindAction(A.KeyInputManager.Na(w.a.gB,4),C.a.Agd));H.a.instance.ga(6)&&(a.bindAction(A.KeyInputManager.Na(w.a.fB,A.KeyInputManager.Fe|4),G.a.MGc),a.bindAction(A.KeyInputManager.Na(w.a.gB,
A.KeyInputManager.Fe|4),G.a.MGc));n.a.Hj||a.bindAction(A.KeyInputManager.Na(w.a.BJa,0),C.a.b$);a.bindAction(A.KeyInputManager.Na(w.a.tna,4),C.a.zgd);a.bindAction(A.KeyInputManager.Na(w.a.tna,4|A.KeyInputManager.Fe),C.a.zgd)}IHb(){const a=v.FocusManager.instance().Bc(I.AppFrame.nV);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.bnd,A.KeyInputManager.Fe|1),C.a.$Hd);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.cnd,A.KeyInputManager.Fe|1),C.a.aId);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.QUe,A.KeyInputManager.Fe|1),
C.a.bId);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.RUe,A.KeyInputManager.Fe|1),C.a.dId);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.SUe,A.KeyInputManager.Fe|1),C.a.eId);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.TUe,A.KeyInputManager.Fe|1),C.a.fId);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.xxa,A.KeyInputManager.Fe|4),C.a.ZHd);H.a.instance.ga(61)&&v.FocusManager.instance().Bc(y.AFrame.gj).bindAction(A.KeyInputManager.Na(w.a.ind,A.KeyInputManager.Fe|4),C.a.B9h)}Wil(){const a=v.FocusManager.instance().Bc(I.AppFrame.nV);
a.bindAction(A.KeyInputManager.Na(w.a.Bq,0),C.a.tab);a.bindAction(A.KeyInputManager.Na(w.a.Bq,4),C.a.ckc)}Yjl(){if(H.a.instance.ga(30)){const a=v.FocusManager.instance().Bc(I.AppFrame.nV);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.aq,A.KeyInputManager.Fe),C.a.HCa)}}dll(){const a=v.FocusManager.instance(),b=a.Bc(I.AppFrame.nV);a.Bc(y.AFrame.XC);y.AFrame.Sj(b,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Bold),C.a.bold,Y.YI);y.AFrame.Sj(b,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Italic),C.a.setItalic,
Y.YI);y.AFrame.Sj(b,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Underline),C.a.underline,Y.YI);n.a.ek&&(y.AFrame.Sj(b,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Bold_Mac),C.a.bold,Y.YI),y.AFrame.Sj(b,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Italic_Mac),C.a.setItalic,Y.YI),y.AFrame.Sj(b,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Underline_Mac),C.a.underline,Y.YI));y.AFrame.Sj(b,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_ClearFormatting),C.a.clearFormatting);H.a.instance.ga(54)&&
y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.eKb,A.KeyInputManager.Fe|4),C.a.clearFormatting);y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.bib,A.KeyInputManager.Fe|1),C.a.W9,Y.Keb("00FFFF"));if(H.a.instance.ga(94)||H.a.instance.ga(96))y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.CJa,A.KeyInputManager.Fe|4),C.a.$H,Y.YI),y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.Jnc,A.KeyInputManager.Fe),C.a.$H,Y.YI),y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.hmd,A.KeyInputManager.Fe|4),C.a.lJ,Y.YI),y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.Hnc,
A.KeyInputManager.Fe),C.a.lJ,Y.YI);u.AFrameworkApplication.fa.ka("PPTOToggleCaseByShiftF3Enabled")&&y.AFrame.Sj(b,A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_ToggleCase),C.a.Vjd);u.AFrameworkApplication.fa.ka("SubSuperscriptShortcutEnabled")&&(y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.imd,A.KeyInputManager.Fe|4),C.a.superscript,Y.YI),y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.lmd,A.KeyInputManager.Fe|4),C.a.superscript,Y.YI),y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.jmd,A.KeyInputManager.Fe|4),C.a.subscript,
Y.YI),y.AFrame.Sj(b,A.KeyInputManager.Na(w.a.Inc,A.KeyInputManager.Fe|4),C.a.subscript,Y.YI))}Frl(){const a=v.FocusManager.instance().Bc(y.AFrame.XC),b=v.FocusManager.instance().Bc(I.AppFrame.nV);var c=A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Undo);a.bindAction(c,G.a.Qza);b.bindAction(c,C.a.undo);c=A.KeyInputManager.Na(w.a.jH,1);a.bindAction(c,G.a.Qza);n.a.ek||b.bindAction(c,C.a.undo);c=A.KeyInputManager.Mv(Box4Intl.Box4Strings.l_HK_Redo);a.bindAction(c,G.a.Qza);b.bindAction(c,C.a.redo);c=A.KeyInputManager.Na(w.a.jH,
5);a.bindAction(c,G.a.Qza);n.a.ek||b.bindAction(c,C.a.redo)}ufl(){const a=v.FocusManager.instance().Bc(I.AppFrame.nV);H.a.instance.ga(54)?(n.a.ek?this.Hpa(a,A.KeyInputManager.Na(w.a.cnd,5),"\u20ac"):this.Hpa(a,A.KeyInputManager.Na(w.a.aib,A.KeyInputManager.Fe|1),"\u20ac"),this.Hpa(a,A.KeyInputManager.Na(w.a.KJa,A.KeyInputManager.Fe|1),"\u00a9"),this.Hpa(a,A.KeyInputManager.Na(w.a.bKb,A.KeyInputManager.Fe|1),"\u00ae"),this.Hpa(a,A.KeyInputManager.Na(w.a.cKb,A.KeyInputManager.Fe|1),"\u2122"),this.Hpa(a,
A.KeyInputManager.Na(w.a.Inc,A.KeyInputManager.Fe|1),"\u2014"),this.Hpa(a,A.KeyInputManager.Na(w.a.CJa,A.KeyInputManager.Fe|1),"\u2026"),this.Hpa(a,A.KeyInputManager.Na(w.a.LTe,A.KeyInputManager.Fe|5),"\u00bf"),this.Hpa(a,A.KeyInputManager.Na(w.a.bnd,A.KeyInputManager.Fe|5),"\u00a1")):H.a.instance.ga(25)&&this.Hpa(a,A.KeyInputManager.Na(w.a.aib,A.KeyInputManager.Fe|1),"\u20ac")}Hpa(a,b,c){y.AFrame.Sj(a,b,C.a.oRa,Y.Lzj("symbol_"+c))}CCi(){if(u.AFrameworkApplication.aE){var a=v.FocusManager.instance().Bc(y.AFrame.gj);
y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.UUe,A.KeyInputManager.Fe|1),G.a.giveFeedback);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.VUe,A.KeyInputManager.Fe|1),G.a.giveFeedback)}}wVk(){const a=v.FocusManager.instance().Bc(y.AFrame.gj);n.a.Kw||y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.bib,1),C.a.activateRibbonTab,Y.Keb("tabHome"));y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.xxa,1),C.a.activateRibbonTab,Y.Keb("tabInsert"));y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.cib,1),C.a.activateRibbonTab,Y.Keb("tabPageLayout"));
y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.bKb,1),C.a.activateRibbonTab,Y.Keb("tabReview"));y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.YUe,1),C.a.activateRibbonTab,Y.Keb("tabView"))}static get instance(){return Y.Ja||(Y.Ja=new Y)}static vWf(){return new E.DictionaryPropertySet}static YI(){return new K(2)}static Lzj(a){return()=>{const b={};b.SourceControlId=a;return b}}static Keb(a){return()=>a}}Y.Ja=null;Object(e.a)(Y,"ShortcutRegistration",null,[]);class M{get name(){return"Box4.Shortcuts"}Wb(){}init(){Y.instance.SCe()}dispose(){}static main(){m.a.instance.Ac(new M)}}
Object(e.a)(M,"Box4ShortcutsPackage",null,[2,3]);var P=d(298);class T{qt(a,b,c=!1,f=!1,l=!1,x=null){return P.a.qt(a,b,c,f,l,x)}wnc(a,b,c){return P.a.wnc(a,b,c)}Snb(a,b){return P.a.Snb(a,b)}OY(a,b,c,f,l=!1,x=!1){return P.a.OY(a,b,c,f,l,x)}pNa(a,b=null){return P.a.pNa(a,b)}Vba(){P.a.Vba()}e4a(a,b,c,f=null){return P.a.e4a(a,b,c,f)}bCa(a,b,c=!1,f=!0){return P.a.bCa(a,b,c,f)}D4b(a,b){return P.a.D4b(a,b)}}Object(e.a)(T,"TextMetricsAdapterProxy",null,[1392]);var L=d(305),aa=d(148);class Q{hfj(a){var b=a;
for(a=null;!a&&b&&"P"!==b.tagName;)a=L.a.re(b,aa.a.jIb),b=b.parentNode;b=-1;a&&(b=parseInt(a.toString(),10));return b}}Object(e.a)(Q,"TextMetricsHelper",null,[361]);class ea{constructor(){this.Da=null}get name(){return"Box4.TextMetrics"}init(){this.Da.resolve("Box4.ITextMetricsAdapter")}dispose(){}Wb(a){this.Da=a;this.Da.register(1392,"Box4.ITextMetricsAdapter").ma().na(()=>new T);this.Da.register(361,"Box4.TextMetricsApi.ITextMetricsHelper").ma().na(()=>new Q)}static main(){m.a.instance.Ac(new ea)}}
Object(e.a)(ea,"Box4TextMetricsPackage",null,[2,3]);var ia=d(330),ja=d(247),D=d(13),pa=d(98),Z=d(375),oa=d(701),Ba=d(95),Ma=d(45),za=d(1177),ka=d(1173),qa=d(65),Ja=d(554),xa=d(101),Ga=d(342),na=d(776),sa=d(267),Ha=d(17),cb=d(6);class Za{static j2k(a){const b=new oa.a;for(let c of a)b.add(c);return b}static Qbh(a,b){const c=new Ha.a;b=Za.j2k(b);for(let f of a)b.contains(f)||c.add(f);return c}static vNk(a,b){return Za.Qbh(cb.asEnumerable(a),b).toArray()}static wNk(a,b){return Za.Qbh(a,b)}}Object(e.a)(Za,
"ExtendedGuidUtils",null,[]);var va=d(1158),Fa=d(22),Ca=d(162);class La{}La.mji="ChangeInfo";Object(e.a)(La,"CatchUpActivityConstants",null,[]);class nb{}nb.HCb="\u00a0";nb.$Hf="\ue200";nb.hlg="\ue201";nb.mJi=32767;nb.FGc=3;nb.GRd=1;Object(e.a)(nb,"ContentEditableViewConstants",null,[]);var Nb=d(537),Rb=d(121),Ya=d(31),Qb=d(358),bb=d(36),Bb=d(39),Eb=d(91),tb=d(92),Yb=d(51),Tc=d(86);class ib{constructor(a,b,c){this.Qa=b;this.Kb=c}}Object(e.a)(ib,"ChangeInfo",null,[]);d(598);var Zb=d(795);class Cc{}
Object(e.a)(Cc,"InternalLinkConstants",null,[]);class ob extends Sys.EventArgs{constructor(){super();this.P4a=null}}Object(e.a)(ob,"EditEventArgs",Sys.EventArgs,[]);class cc extends ob{constructor(){super();this.mSj=0;this.nnl=this.xHc=this.uPe=this.OSj=this.Ouj=this.zqg=this.R4f=this.eQi=this.vMi=!1}}Object(e.a)(cc,"ParagraphContentUpdatedEventArgs",ob,[]);class sb{constructor(a){this.SUc=a}}Object(e.a)(sb,"BlobPresenterArgs",null,[]);var mb=d(30);class Pb{}Pb.F2="TrackedChange";Pb.$uh="TrackChangeTableRowInsertion";
Pb.Xuh="TrackChangeTableRowDeletion";Pb.Gvh="TrackChangeTextInsertion";Pb.Evh="TrackChangeTextDeletion";Pb.ouj="TrackChangeImageModified";Pb.muj="TrackChangeImageInsertion";Pb.iuj="TrackChangeImageDeletion";Pb.Fbe="TrackChangeIndirectEffect";Object(e.a)(Pb,"TrackChangeConstants",null,[]);var dc=d(887),mc=d(96);const Mb=a=>!!a.jOa&&cb.AT(a.jOa,b=>3===b.type||2===b.type||4===b.type),Kc=(a,b)=>{let c=!1,f=!1,l=null;if(b.jOa)for(let x of b.jOa)1===x.type&&(c=!0),3===x.type&&(f=!0),4===x.type&&x.xe&&x.xe.paragraph&&
(l=x);l&&Sys.UI.DomElement.addCssClass(a,mc.a.WBi);f&&Sys.UI.DomElement.addCssClass(a,mc.a.$jg);c&&Sys.UI.DomElement.addCssClass(a,mc.a.QBi)},gc=a=>{const b=[mc.a.vIi,mc.a.wIi,mc.a.uIi];for(const c of b)Sys.UI.DomElement.removeCssClass(a,c)};var rb=d(352);class Ua{constructor(a){this.gMb=this.iRb=this.QYe=null;this.Fi=a}get paragraphNode(){return this.Fi}get jOa(){return this.QYe}get ygb(){return this.iRb}get V4a(){return this.gMb}get isEmpty(){return(!this.jOa||!this.jOa.count)&&(!this.ygb||!this.ygb.count)&&
(!this.V4a||!this.V4a.count)}Wlk(){this.ygb&&(this.iRb=new Ha.a);this.V4a&&(this.gMb=new Ha.a)}Uld(a){this.jOa||(this.QYe=new rb.a);this.ygb||(this.iRb=new Ha.a);this.V4a||(this.gMb=new Ha.a);this.jOa.Uld(a,b=>{this.ygb.add(b)},b=>{this.V4a.add(b)})}}Object(e.a)(Ua,"IntentRenderingState",null,[]);class pb{constructor(a,b){this.element=a;this.next=b}}Object(e.a)(pb,"ElementStackNode",null,[]);class Ub{constructor(a=!1){this._history=new Sys.StringBuilder;this.cya=this.Fu=null;this.IRb=a}RVj(a){if(this.IRb&&
a){this._history.append("[Cp "+a.cp+":");if(a.Oh)for(var b=0;b<a.Oh.length;b++)this._history.append(a.Oh.ga(b).Px+","+a.Oh.ga(b).xda),b!==a.Oh.length-1&&this._history.append("|");if(a.Tj)for(a.Oh&&this._history.append("|"),b=0;b<a.Tj.length;b++)this._history.append(a.Tj.ga(b).Wra?"B":"I"),this._history.append(a.Tj.ga(b).fk?"S":"E"),this._history.append(a.Tj.ga(b).evb?"R":"F"),b!==a.Tj.length-1&&this._history.append("|");this._history.append("]\n")}}clear(){if(this.Fu){for(var a=this.Fu;a.next;)a=
a.next;a.next=this.cya;this.cya=this.Fu;this.Fu=null;this.IRb&&this._history.append("Clear\n")}}peek(a=""){this.isEmpty()&&Z.ULS.sendTraceTag(50604245,324,15,"_top is null when calling Peek with Label: {0}. History: {1}",a,this._history.toString());this.IRb&&this._history.append(String.format("Peek Label: {0}\n",a));return this.Fu.element}pop(a=""){this.isEmpty()&&Z.ULS.sendTraceTag(50604246,324,15,"_top is null when calling Pop with label {0}. History: {1}",a,this._history.toString());const b=this.Fu.element;
this.Fu.element=null;const c=this.Fu.next;this.Fu.next=this.cya;this.cya=this.Fu;this.Fu=c;this.IRb&&this._history.append(String.format("Pop {0} Label:{1}\n",b?b.className:"Null Element",a));return b}push(a,b=""){if(this.cya){const c=this.cya.next;this.cya.next=this.Fu;this.Fu=this.cya;this.cya=c;this.Fu.element=a}else this.Fu=new pb(a,this.Fu);this.IRb&&this._history.append(String.format("Push {0} Label:{1}\n",a?a.className:"Null Element",b))}isEmpty(){return!this.Fu}}Object(e.a)(Ub,"ElementStack",
null,[]);class Bc{constructor(){this.u4b=!1;this.span=null}}Object(e.a)(Bc,"IntelligentPlaceholderRenderingState",null,[]);class Gc{constructor(a,b,c){this.eventName=a;this.Fc=b;this.handler=c}}Object(e.a)(Gc,"ParagraphContentRendererMouseEventRegistration",null,[]);var qd=d(77);class Td extends Sys.EventArgs{constructor(a,b,c){super();this.element=a;this.paragraphNode=b;this.rEb=c}}Object(e.a)(Td,"ParagraphContentRendererEventArgs",Sys.EventArgs,[]);class Vd extends Td{constructor(a,b,c,f,l){super(a,
b,c);this.iRb=f.ygb;this.gMb=f.V4a;this.IKh=l}get ygb(){return this.iRb}get V4a(){return this.gMb}get elementType(){return this.IKh}}Object(e.a)(Vd,"IntentRangeRenderedEventArgs",Td,[]);class Be extends Td{constructor(a,b,c,f){super(a,b,c);this.Ap=f}}Object(e.a)(Be,"SpellingErrorRenderedEventArgs",Td,[]);class Id{constructor(){this.Pa=new qd.a}dispose(){this.Pa&&(this.Pa.dispose(),this.Pa=null)}vGk(a,b,c,f){this.Pa&&this.Pa.raiseEvent(Id.Nok,new Be(a,b,c,f))}E9g(a,b,c,f,l){this.Pa&&this.Pa.raiseEvent(Id.Vkk,
new Vd(a,b,c,f,l))}}Id.Nok="OnSpellingErrorRangeRendered";Id.Vkk="OnIntentRangeRendered";Object(e.a)(Id,"ParagraphRenderEvents",null,[106]);class gb{constructor(){this.FMf=null;this.rjg=!1;this.sTg=this.Izf=null}}Object(e.a)(gb,"RenderParagraphContentResults",null,[]);var Xb=d(161),Ic=d(66);class Wc{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec){this.kya=this.Cvd=this.Eud=this.klb=null;this.Hf=a;this.OO=b;this.Wc=c;this.Wna=f;this.mM=l;this.Dv=F;this.Boa=R;this.jLa=fa;this.tJh=Xa;this.DU=lb;
this.TSh=Lb;this.WLh=kc;this.aIh=Ec;this.Sxf=new oa.a;this.vxc=lc;this.rkb=!!wa&&wa.UCa(65);this.Fxc=this.Brc=null;this.TKa=x;this.gOh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("MinimizeIntelligentPlaceholderWorkIsEnabled");this.Xc=wa}get iKf(){return!0}get Ytg(){null==this.Eud&&(this.Eud=!!this.Xc&&this.Xc.isFeatureEnabled(85));return this.Eud}get kyg(){null==this.Cvd&&(this.Cvd=!!this.Xc&&this.Xc.isFeatureEnabled(77));return this.Cvd}get eN(){null==this.kya&&(this.kya=!!this.Xc&&
this.Xc.isFeatureEnabled(79));return this.kya}uRk(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd){this.Brc={};this.Fxc=new Xb.a;const xe=Ya.ParagraphReader.text(a),Sd=new Ha.a;var Pe=!1;u.AFrameworkApplication.fa&&(Pe=u.AFrameworkApplication.fa.ka("ElementStackTrackHistoryIsEnabled"));const Ue=new Ub(Pe);Ue.push(c,"RenderParagraphContentStart");let Ef=null,dg=null,Mg=null,Bg=null,Lf=Pe=null;const mh=new cc;var Fg=!1;let ii=!1,Li=!1,wj=!1,cj=0,dj=null,yi=null;const Hk=new Ha.a;this.vxc&&this.vxc.SCl(a,
c);const xj=this.jLa.xV(a);this.jLa.h9h(c,a,b,xj,b.Cd);if(this.Boa.Lw&&b.Bl){var uk=this.Hf.Ld;uk&&1===uk.editingView.mode&&(c.style.fontFamily="",c.style.fontSize="")}uk=!a.IV;let Gl=!1,gl=!1,Hl=!1,Yj=!1,Oj=0,Zj=!1,Wk=!1,Hj=null,nh=0;const hl=new Bc,Wl=Array(a.Ra.length+1);let xm=this.Ytg?new Ha.a:null,Ik=null,vk=null;for(;cj<a.Ra.length;){const Zd=a.Ra.ga(cj);var ji=void 0,ng=void 0,ki=!1;Ue.RVj(Zd);({KDc:ji,GDc:ng}=Wc.M7f(Zd));this.Ytg&&(!this.gOh||ji.length||ng.length)&&({KDc:ji,GDc:ng,mCi:xm,
HHj:ki}=Wc.ytl(Zd.paragraph.Ch,ji,ng,xm),hl.u4b=0<xm.count);Yj=0<ji.length||Yj;Wl[cj]=c.childNodes.length;if(0<Zd.cp&&Zd.Cj)break;let vg=Zd.cp;const $h=cj<a.Ra.length-1?a.Ra.ga(cj+1).cp:Ya.ParagraphReader.textLength(a);cj++;var Rf=!1;0<vg&&Ue.pop("CurrentCpLargerThanZero");Zd.HK&&(Ef=null);Zd.Ku&&(vk=Zd.Ku);Zd.isDictationCorrectionEnd&&(vk=null);Zd.yX&&(dg=null);Zd.M2&&(Mg=null);Zd.Via&&(Bg=null);var zd=void 0,ne=void 0;this.eN?(zd=Zd.gca,ne=Zd.wZ):(zd=!!Zd.ro,ne=!!Zd.fieldRangeEnd);if(!Fg||Zd.blob||
Zd.formatting||Zd.hyperlink||Zd.Nm||Zd.P2||ne||zd||this.rkb&&(Zd.isTrackChangeInfoEnd||Zd.lN)||Zd.Ov&&!Zd.Ov.isEmpty)Rf=!0,0<vg&&Fg&&Ue.pop("InFormattingSpan");ne&&(Ue.pop("HasFieldEnd"),Fg=!1);Zd.Nm&&(Gl||(Li=!0),gl=Gl=!1);Zd.hyperlink&&(Gl&&(Li=!0),Gl=!0,gl=Zd.hyperlink.Ura);Zd.Nm&&!Li&&(Ue.pop("IsHyperlinkEnd"),Fg=!1);this.Xc&&this.Xc.isFeatureEnabled(17)&&(Zd.isChangeEnd&&(Zj||Z.ULS.sendTraceTag(36282713,324,15,"Found catch up change end with out change start!"),Zj=!1,yi=null),Zd.changeStart&&
(Zj&&Z.ULS.sendTraceTag(36282714,324,15,"Found catch up change start with out change end!"),yi=Zd,Zj=!Zd.Cj));if(this.rkb&&(Zd.isTrackChangeInfoEnd&&(Hl||(wj=!0),Hl=!1,dj=null),Zd.lN&&(Hl&&(wj=!0),dj=Zd,Hl=!Zd.Cj),Zd.isTrackChangeInfoEnd&&!wj)){for(Fg=0;Fg<Oj;Fg++)Ue.pop("IsTrackChangeInfoEnd");Oj=0;Fg=!1}Ik&&Ik.Wlk();Zd.Ov&&(Ik||(Ik=new Ua(a)),Ik.Uld(Zd.Ov));if(Zd.P2&&!Zd.Cj){Pe=Pe||Zd.formatting;ne=this.$Rf(Ue.peek("CreateIpFormattingSpan"),Pe,xj,b,a,Xa,fa,dj);ne=Ba.a.t6a(ne);for(let zi of ne)lb=
Wc.Hga(l,lb,zi);mh.zqg=!0}Zd.hyperlink&&!Li&&({EDa:lb,RJi:Wk,returnValue:Lf}=this.nRk(Lf,Zd,Ue,xj,mh,b,a,f,l,x,F,fa,dj,lb,Xa,uk,Fg,Wk));!this.rkb||wj||Zd.Cj||(Zd.Zo&&(this.kEe(Zd.Zo,Ue,mh,b,fa),Oj++),Zd.lo&&(this.kEe(Zd.lo,Ue,mh,b,fa),Oj++),Zd.gs&&(this.kEe(Zd.gs,Ue,mh,b,fa),Oj++));zd&&({hOa:Pe,EDa:lb,returnValue:Lf}=this.jRk(Lf,l,a,Zd,Pe,Ue,xj,mh,b,fa,Xa,lb,Fg,uk,dj));this.kyg&&this.YLf(a,b,Jc&&Ec);Zd.blob?({EDa:lb,NSj:Hj,MSj:nh,returnValue:ii}=this.bRk(lb,Fg,Pe,Zd,x,F,uk,Lf,Ue,xj,mh,vg,ii,Ec,b,
Hk,Jc,a,Xa,l,Lb,kc,R,fa,Sd,dj,yi,ji,ng,Hj,nh,Ik),Fg=!1,Pe=Lf=null):(zd=Zd.P2&&!Ma.a.substring(xe,vg,$h).length,Rf&&(Rf=Lf,{hOa:Pe,returnValue:Lf}=this.lRk(Pe,Zd,xj,Ue,mh,b,a,fa,dj,Xa,zd),Fg=!0,Lf&&Lf.style&&(Wk&&Rf&&Rf.style&&(Rf.style.fontSize=Lf.style.fontSize,Rf.style.lineHeight=Lf.style.lineHeight),Hj&&Hj.style&&0<nh&&Zd.formatting&&Zd.formatting.cache.Cra&&nh>Zd.formatting.cache.fontSize&&(Hj.style.fontSize=Lf.style.fontSize,Hj.style.lineHeight=Lf.style.lineHeight))),Wk=!1,Hj=null,nh=0,zd||(Zd.Ap&&
(Ef=Zd.Ap),Zd.ME&&(Mg=Zd.ME),Zd.JK&&(Bg=Zd.JK),Zd.gw&&(dg=Zd.gw),Rf=Ma.a.substring(xe,vg,$h),ki=this.xPd(Ue.peek("CreateTextOverlaySpan1"),Pe,a,Ef,Mg,Bg,dg,b,Hk,fa,Rf,Jc&&(Lb<=vg&&vg<kc||a.IV),Wd,hl,ki,Ik,!!vk,gl),Ue.push(ki,"TextOverlaySpan1"),mh.uPe=!0,this.oFd(Ue.peek("AddCommentHintCssAndDataToElement"),ji,ng),this.mM&&this.mM.dub&&Ef&&Ef.Dh&&(ji=Object(va.a)(384,Ef.Dh))&&ji.GM&&ji.GM.TraceId&&5===ji.proofingType&&!ji.sCa&&(this.mNk(Ue.peek("RemoveConsistencyCheckCustomData")),ng=this.t_i(Zd.Ap,
a,cj),L.a.ov(Ue.peek("errorDetails"),ng,ji.GM.TraceId)),this.QHe(yi,Ue.peek("SetChangeId"),Zd.cp,$h),Jc&&Lb!==kc&&({EDa:lb,returnValue:vg}=this.oBk(ki,Ue,Pe,a,Ef,Mg,Bg,dg,mh,b,l,Hk,fa,xe,Lb,kc,lb,vg,$h,Wd,hl,Ik,!!vk,gl)),Ba.a.ix(Ue.peek("SetElementText"),Ma.a.substring(xe,vg,$h)),lb=Wc.Hga(l,lb,Ue.peek("AddLeafNodeElement"))))}if(a.KOc!==Yj||this.rkb||this.Boa.UJb)a.KOc=Yj,(f=Yb.OutlineElementNavigator.rA(a))&&f.Wba(b.Ma,32,!0);({SUc:Lf,EDa:lb,returnValue:Fg}=this.pRk(a,c,Pe,xj,mh,Lf,b,a,l,fa,dj,
Xa,lb,Fg,uk));!hl.u4b&&hl.span&&this.IHd(null,hl.span);uk&&this.iRk(c,Lf,mh,b,a,l,fa,wa,lb,lc,yi);Wl[Wl.length-1]=c.children.length;this.vul(ii,Dc,b);this.tvl(mh,Fg,l);this.rlh(b,a,c);let yf;return yf=new gb,yf.FMf=Sd,yf.rjg=ii,yf.Izf=Wl,yf.sTg=Hk,yf}rEb(a,b,c,f){this.OO.ob(a,b,c,f);return new Gc(a,b,c)}t_i(a,b,c){let f=0;a&&a.Dh&&(f|=16);if(c<b.Ra.length&&b.Ra.ga(c).HK||c===b.Ra.length)f|=1;switch(f){case 0:return dc.a.bte;case 16:return dc.a.fVc;case 1:return dc.a.Idd;case 17:return dc.a.kBc}return""}mNk(a){L.a.fma(a,
dc.a.bte);L.a.fma(a,dc.a.fVc);L.a.fma(a,dc.a.Idd);L.a.fma(a,dc.a.kBc)}QHe(a,b,c,f){this.Xc&&this.Xc.isFeatureEnabled(17)&&a&&a.changeStart&&L.a.ov(b,La.mji,new ib(a.changeStart.id,c,f))}nRk(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc){!Ec||Jc||b.P2||(a=this.oWb(c.peek("CreateFormattingSpan1"),null,f,x,F,lb,lc,Lb),a.className+=" EmptyTextRun",kc=Wc.Hga(fa,kc,a),Dc=l.xHc=!0);b=this.Uxi(c.peek("CreateLinkAnchor"),b.hyperlink,x,R,wa,Xa,lb);c.push(b,"RenderHyperlink");l.OSj=!0;return{returnValue:a,EDa:kc,
RJi:Dc}}kEe(a,b,c,f,l){a=this.oBi(b.peek("CreateTrackChangeRange"),a,f,l);b.push(a,"RenderTrackChange");c.nnl=!0}jRk(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){Lb||f.P2||(l=f.formatting||l,kc?(a=this.oWb(x.peek("CreateFormattingSpan2"),l,F,fa,c,wa,Xa,lc),a.appendChild(fa.ownerDocument.createTextNode("")),a.className+=" EmptyTextRun",lb=Wc.Hga(b,lb,a),R.xHc=!0):(a=this.kFc(l,F,fa,c,Xa,lc),R.R4f=!0));b=this.Twi(x.peek("CreateFieldRangeSpan1"),fa,wa,c);x.push(b,"RenderFieldRange");R.eQi=!0;return{returnValue:a,
hOa:l,EDa:lb}}bRk(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf,mh,Fg,ii,Li){b||(c=f.formatting||c,F&&!f.P2?(R=this.oWb(fa.peek("CreateFormattingSpan4"),c,wa,lc,Dc,Ef,Wd,Mg),R.appendChild(lc.ownerDocument.createTextNode("")),R.className+=" EmptyTextRun",a=Wc.Hga(xe,a,R),Xa.xHc=!0):R=this.kFc(c,wa,lc,Dc,Wd,Mg));1===f.blob.Eq&&(Lb=!0);b=f.blob.$9i(lc);b.G5f(new sb(R));R=b.element;Sys.UI.DomElement.containsCssClass(R,mc.a.F5b)&&(Fg=R,c&&c.cache.Cra&&(ii=c.cache.fontSize));
Sys.UI.DomElement.addCssClass(R,mc.a.yM);this.Boa.CIi&&5!==f.blob.Eq&&Sys.UI.DomElement.addCssClass(R,mc.a.yIi);this.rkb&&this.oRk(f,lc,R,Mg);this.oFd(R,Lf,mh);Li&&!Li.isEmpty?(Kc(R,Li),this.klb&&this.klb.E9g(R,Dc,(wj,cj,dj,yi)=>{Ec.add(this.rEb(wj,cj,dj,yi))},Li,1)):gc(R);this.QHe(Bg,R,f.cp,f.cp+1);fa.peek("blobElt").appendChild(R);Ue(R,!0);dg.add(f.blob);Jc&&(Sd<=lb&&lb+1<=Pe||Dc.IV)?(kc&&(Sys.UI.DomElement.containsCssClass(R,mc.a.MPd)||Sys.UI.DomElement.addCssClass(R,mc.a.MPd),u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordTouchImageGrippiesResizedSettings"),
u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TouchImageGrippiesResizedIsEnabled")&&this.Hf&&this.Hf.Ld&&Object(Fa.a)(Nb.PageView,this.Hf.Ld)&&(c=this.Hf.Ld,lb=u.AFrameworkApplication.Ta,c&&3===c.ezg?lb.Ka(C.a.Qwh,2,R):lb.Ka(C.a.Rwh,2,R))),Sys.UI.DomElement.addCssClass(R,mc.a.L6)):(Sys.UI.DomElement.removeCssClass(R,mc.a.MPd),Sys.UI.DomElement.removeCssClass(R,mc.a.L6));this.kyg||this.YLf(Dc,lc,Jc&&kc);Sys.UI.DomElement.removeCssClass(R,mc.a.SBi);this.Xc&&this.Xc.isFeatureEnabled(162)&&
5===f.blob.Eq&&(f=f.blob,f.properties&&f.properties.Sa(bb.a.h2b)&&(f=f.properties.getValue(bb.a.h2b))&&""!==f&&(Ec.add(this.rEb(qa.a.ela,R,l,f)),Ec.add(this.rEb(qa.a.ela,R,x,f))));a=Wc.Hga(xe,a,R);fa.push(R,"RenderBlob");return{returnValue:Lb,EDa:a,NSj:Fg,MSj:ii}}oFd(a,b,c){if(this.Boa.UJb||this.Boa.hEh)b.length?(Sys.UI.DomElement.addCssClass(a,mc.a.JDc),L.a.ov(a,mc.a.WMd,b)):Sys.UI.DomElement.removeCssClass(a,mc.a.JDc);this.Boa.hEh&&c.length&&L.a.ov(a,mc.a.SMd,c)}YLf(a,b,c){a=mb.GraphIterator.mb(a);
a.Ze();a.Ng(11);if(b=a.currentNode.oc(b.Ma))b.htmlElement.style.zIndex=c?"1":""}oRk(a,b,c,f){let l=Ba.a.nZi(c,Wc.Swh);5===a.blob.Eq&&f?(l||(l=b.Oo(ka.a.span),l.id=Wc.Swh,Sys.UI.DomElement.addCssClass(l,Pb.ouj),Sys.UI.DomElement.addCssClass(l,Pb.F2),c.appendChild(l)),this.S5f(b,l,f.Zo,Pb.iuj),this.S5f(b,l,f.lo,Pb.muj)):l&&c.removeChild(l)}S5f(a,b,c,f){c&&!Ba.a.h_b(b,f)&&(a=a.Oo(ka.a.span),a.className=f,a.style.borderBottom="2px solid #000",b.appendChild(a))}lRk(a,b,c,f,l,x,F,R,fa,wa,Xa){a=b.formatting||
a;b=Xa?this.kFc(a,c,x,F,wa,fa):this.oWb(f.peek("CreateFormattingSpan5"),a,c,x,F,R,wa,fa);f.push(b,"RenderFormattingSpan");l.R4f=!0;return{returnValue:b,hOa:a}}oBk(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef){Dc<lc&&lc<Wd&&(Dc=Ma.a.substring(kc,Dc,lc),Ba.a.ix(a,Dc),Jc=Wc.Hga(Xa,Jc,a),b.pop("ProcessSelectionBegins"),a=this.xPd(b.peek("CreateTextOverlaySpan2"),c,f,l,x,F,R,wa,lb,Lb,Dc,!0,xe,Sd,!1,Pe,Ue,Ef),b.push(a,"TextOverlaySpan2"),Dc=lc,fa.uPe=!0);Dc<Ec&&Ec<Wd&&(kc=Ma.a.substring(kc,
Dc,Ec),Ba.a.ix(a,kc),Jc=Wc.Hga(Xa,Jc,a),b.pop("ProcessSelectionEnds"),a=this.xPd(b.peek("CreateTextOverlaySpan3"),c,f,l,x,F,R,wa,lb,Lb,kc,!1,xe,Sd,!1,Pe,Ue,Ef),b.push(a,"TextOverlaySpan3"),Dc=Ec,fa.uPe=!0);return{returnValue:Dc,EDa:Jc}}pRk(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){if(0<a.Ra.length){const Ec=a.Ra.last;let Jc;Jc=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TextRunForHyperlinkInTableCellEnabled");a=mb.GraphIterator.mb(a);!Ec.Nm||Jc&&a.mc(16)||(kc=!1,c=null);if(this.eN?Ec.wZ:
Ec.fieldRangeEnd)kc=!1,c=null;if(Ec.P2){c||(c=Ec.formatting);x=this.$Rf(b,c,f,F,R,lb,wa,Xa);b=Ba.a.t6a(x);for(let Dc of b)Lb=Wc.Hga(fa,Lb,Dc);l.zqg=!0}else!kc&&lc&&(c||(c=Ec.formatting),x=this.oWb(b,c,f,F,R,wa,lb,Xa),x.appendChild(F.ownerDocument.createTextNode("")),x.className+=" EmptyTextRun",Lb=Wc.Hga(fa,Lb,x),l.xHc=!0)}else Z.ULS.sendTraceTag(18482315,324,15,"CharacterProperties has no elements");return{returnValue:kc,SUc:x,EDa:Lb}}iRk(a,b,c,f,l,x,F,R,fa,wa,Xa){var lb=Wc.IYi(a,wa);b=this.HRf(b,
f,R,lb);Ja.a.instance.shipAssertTag(25519712,8,0<l.Ra.length,"Chps should never be empty");R=null;l.Ra&&0<l.Ra.length&&(R=l.Ra.last);this.rkb&&R&&(R.Zo||R.lo||R.gs)&&(b.className+=" "+Pb.F2);let Lb;({KDc:lb,GDc:Lb}=Wc.M7f(R));this.oFd(b,lb,Lb);this.QHe(Xa,b,R?R.cp:0,-1);wa&&(b.className+=" "+Qb.a.BQd);this.rlh(f,l,b);a.appendChild(b);F(b);Wc.Hga(x,fa,b);c.vMi=!0}rlh(a,b,c){if(a.Bl&&this.Wna.t9c&&this.Wna.m$k(c)){if((a=this.Wna.hQa(b))&&0<xa.a.count(a))try{c.setAttribute("data-ccp-props",JSON.stringify(a))}catch(f){Z.ULS.sendTraceTag(23639749,
307,15,"SetParagraphPropertiesOnHtmlElement for CCP - Cannot serialize object contains circular reference.")}(b=this.Wna.lfj(b))&&0<b.length&&c.setAttribute("data-indent",b)}}oBi(a,b,c,f){c=c.Oo(ka.a.span);switch(b.changeType){case 2:c.className=Pb.Evh+" "+Pb.F2;c.style.color="#000";break;case 1:c.className=Pb.Gvh+" "+Pb.F2;c.style.color="#000";break;case 3:c.className=Pb.F2}a.appendChild(c);f(c);return c}vul(a,b,c){a&&!b?c.notify(1):!a&&b&&c.notify(2)}tvl(a,b,c){a.mSj=c.count;a.Ouj=b;this.TSh(a)}Uxi(a,
b,c,f,l,x,F){c=c.Oo(ka.a.a);c.className=mc.a.tkg;b.Ura&&b.kkc&&!H.a.instance.ga(61)&&(b.url.endsWith(u.AFrameworkApplication.fa.Ha("UserPrincipalName"))?c.className+=" "+mc.a.YBi:c.className+=" "+mc.a.ZBi);this.Dv.qph()&&(c.style["pointer-events"]="all");this.Dv.Ooh(this.Boa.Ixl,!0)&&this.UNk(c);this.OO.ob(qa.a.ela,c,l,b.url);this.OO.ob(qa.a.fla,c,x);f.add(c);b.url&&Ma.a.J7(b.url)&&!n.a.Ki&&(Ca.d(c,za.a.href,b.url),Ca.d(c,za.a.target,"_blank"),Ca.d(c,za.a.rel,"noreferrer"));a.appendChild(c);F(c);
return c}UNk(a){a.style.textDecoration="none";a.style.color="inherit"}oWb(a,b,c,f,l,x,F,R){b=this.kFc(b,c,f,l,F,R);a.appendChild(b);x(b);return b}kFc(a,b,c,f,l,x){if(this.iKf){var F=a?a.Sl.toString():Ga.a.nil.toString();if(F in this.Brc)a=this.Brc[F];else{let R=a?a.cache:Zb.FormattingCacheManager.b_b(f,Ga.a.nil);a=this.tOd(a,R,b,c,f,l);this.Brc[F]=a}b=a.cloneNode();L.a.rEc(a,b)}else F=a?a.cache:Zb.FormattingCacheManager.b_b(f,Ga.a.nil),b=this.tOd(a,F,b,c,f,l);this.WFf(b,x);return b}tOd(a,b,c,f,l,
x){const F=f.Oo(ka.a.span);b=this.Dv.s8f(f,b,l)||b;this.T8h(f,F,b,l);this.X8h(F,b,l,f,x);this.f9h(F,a);this.jLa.i9h(F,l,c,f.Cd,b.fontSize,b.TM);return F}T8h(a,b,c,f){a=this.Dv.r8f(a,f,c);for(let l of a.keys)b.setAttribute(l,a.ga(l))}$Rf(a,b,c,f,l,x,F,R){var fa=b?b.cache:Zb.FormattingCacheManager.b_b(l,Ga.a.nil);fa=this.aIh(fa,l);b=this.tOd(b,fa,c,f,l,x);this.WFf(b,R);fa.isSuperscript||fa.cF?(f=f.Oo(ka.a.span),this.SFf(f,fa,!0),b.appendChild(f),Ba.a.ix(f,""),F(f)):Ba.a.ix(b,"");a.appendChild(b);F(b);
return b}X8h(a,b,c,f,l){var x=b.Fs;const F=[];Array.add(F,mc.a.$Ia);var R=this.Dv.PYd(c,b,this.Boa.Jxl,x);var fa=null;b.q7a&&(fa=b.OQ,fa=fa===Eb.a.auto?"transparent":Eb.a.LH(fa));b.UQa&&(fa=b.highlight,fa=fa===Eb.a.auto?"transparent":Eb.a.LH(fa));c.VUg!==Eb.a.nil&&(R=Eb.a.LH(c.VUg));l!==Eb.a.nil&&(fa=Eb.a.LH(l));Ba.a.Xza(a);b.Xig&&(a.style.opacity=b.t4f.toString());b.W7a&&(a.title=Box4Intl.Box4Strings.l_DeadWordLink);R?(a.style.color=R,Ca.d(a,za.a.eUf,"WindowText"===R?"auto":"none")):Ca.d(a,za.a.eUf,
"auto");fa?(a.style.backgroundColor=fa,"transparent"!==fa&&Array.add(F,"Highlight")):Sys.UI.DomElement.removeCssClass(a,"Highlight");l=b.fontSize;if(b.isSuperscript||b.cF)l=Math.floor(l*this.Dv.d1d());R=this.Dv.I9f(l,c,f.Cd);fa=this.Dv.y_b(b);l=this.DU&&this.DU.JTi?this.DU.VZh(b.TM):this.tJh(fa);this.Boa.I8d&&l&&ia.FontUtils.lvb(fa)&&(l=this.Dv.YFf(fa,l));let wa=b.OQa&&b.isBold;void 0===wa&&(wa=!1);let Xa=b.n7a&&b.isItalic;void 0===Xa&&(Xa=!1);l=this.Dv.t7g(new na.a(fa,wa,Xa),l,c);!this.Tql(fa,b,
a.style)&&b.OQa&&(b.isBold?(a.style.fontWeight="bold",n.a.ek&&n.a.Hj&&Array.add(F,"MacChromeBold")):a.style.fontWeight="normal");b.n7a&&(a.style.fontStyle=b.isItalic?"italic":"normal");(b.gtb||x&&this.Dv.Qoh()||b.ftb||b.B1b)&&this.lEe(a,b,c,F);R&&(a.style.fontSize=R);if(l&&(a.style.fontFamily=l,H.a.instance.ga(118))){Ja.a.instance.J(51676058,8,4,"UseQuotesWithFontFamily is Enabled.");c=new Sys.StringBuilder("");x=l.split(",");for(l=0;l<x.length-1;l++)c.append('"'+x[l].trim()+'",');0<x.length&&c.append('"'+
x[x.length-1].trim()+'"');a.style.fontFamily=c.toString()}b.PQa&&(1===b.capitalization?a.style.fontVariant="small-caps":2===b.capitalization?a.style.textTransform="uppercase":a.style.fontVariant="normal");if(f=this.Dv.p7f(b,f.Cd))a.style.letterSpacing=f;if(b=this.Dv.K$f(b))a.style.fontKerning=b,n.a.AS&&(a.style.fontFeatureSettings="normal"===b?'"kern" 1':'"kern" 0');a.className=F.join(" ")}Tql(a,b,c){return H.a.instance.ga(116)&&n.a.ek&&n.a.Hj?"Community Light"===a?(c.fontWeight=b.isBold?"400":"300",
!0):"Community Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):"Community Slab Medium"===a?(c.fontWeight=b.isBold?"bold":"500",!0):"Community Slab Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):!1:!1}WFf(a,b){this.Wc.Zf&&b&&!b.Cj&&(b.Zo||b.lo)&&(a.style.color="#000")}f9h(a,b){if(b=b?this.WLh(b):0){const c=sa.a.le(b);c?(a.setAttribute("xml:lang",c.name),a.setAttribute("lang",c.name)):this.Sxf.contains(b)||(Z.ULS.sendTraceTag(18482318,324,15,"Unknown LCID encountered in file: {0}",b),this.Sxf.add(b))}}lEe(a,
b,c,f){c="";const l=b.pD,x=b.bF;b=b.vZ;l&&(c="underline",f[f.length]="Underlined");if(x||b)c=l?c+" line-through":"line-through",f[f.length]="Strikethrough";l||x||b||(c="none");0<c.length&&(a.style.textDecoration=c)}SFf(a,b,c){b.isSuperscript&&(a.style.verticalAlign="super",a.className+=" Superscript");b.cF&&(a.style.verticalAlign="sub",a.className+=" Subscript");c&&(a.style.backgroundColor="inherit");(b.isSuperscript||b.cF)&&Ca.d(a,za.a.gUf,(b.fontSize/2).toString())}xPd(a,b,c,f,l,x,F,R,fa,wa,Xa,
lb,Lb,kc,lc,Ec,Jc,Dc){const Wd=b?b.cache:Zb.FormattingCacheManager.b_b(c,Ga.a.nil);Xa=!f||Lb||this.$Oa(f,Xa)?0:f.Dh.proofingType;Lb=!!l;const xe=!!x,Sd=!!F;x=this.Dv.iph(Wd,lb,l,x,F);if(kc.u4b||Ec&&Mb(Ec))x=!1;this.iKf?(l=this.ofj(Wd,Xa,Lb,xe,Sd,lb,x,Jc),this.Fxc.Jb(l)?lb=this.Fxc.ga(l):(lb=this.jTf(R,Wd,Xa,Lb,xe,Sd,lb,x,Jc),this.Fxc.$(l,lb)),R=lb.cloneNode(),L.a.rEc(lb,R)):R=this.jTf(R,Wd,Xa,Lb,xe,Sd,lb,x,Jc);this.b7h(a,R,Wd);this.$Gd(a,R);this.LDf(R);this.KDf(a,R);this.Wna.Eui&&this.c7h(R,b,c);
this.klb&&0!==Xa&&this.klb.vGk(R,c,(Pe,Ue,Ef,dg)=>{fa.add(this.rEb(Pe,Ue,Ef,dg))},f);kc.u4b&&lc&&kc.span&&(this.IHd(null,kc.span),kc.span=null);if((b=kc.u4b?R:null)||kc.span)this.IHd(b,kc.span),kc.span=b,kc.span&&(b=(b=L.a.re(a,aa.a.lVc))?b:-1,0<b&&(kc.span.style.lineHeight=String.format("{0}px",b+3)));Ec&&!Ec.isEmpty&&(Kc(R,Ec),this.klb&&this.klb.E9g(R,c,(Pe,Ue,Ef,dg)=>{fa.add(this.rEb(Pe,Ue,Ef,dg))},Ec,0));Dc&&Sys.UI.DomElement.addCssClass(R,mc.a.XBi);a.appendChild(R);wa(R);return R}$Oa(a,b){b=
a&&a.Dh&&a.Dh.token?a.Dh.token:b;return 0!==a.Dh.errorType&&!!this.TKa&&this.TKa.contains(b,a.Dh.lcid)}ofj(a,b,c,f,l,x,F,R){b|=0;x&&(b|=16);F&&(b|=32);c&&(b|=64);f&&(b|=128);l&&(b|=256);R&&(b|=2048);a.isSuperscript&&(b|=512);a.cF&&(b|=1024);return b}jTf(a,b,c,f,l,x,F,R,fa){a=a.Oo(ka.a.span);const wa=[];if(0!==c){if(!this.Boa.QAl)switch(c){case 1:wa[wa.length]=mc.a.tFc;break;case 2:wa[wa.length]=mc.a.rFc;break;case 3:wa[wa.length]=mc.a.qFc}b.isSuperscript&&(wa[wa.length]=mc.a.OPd)}else fa&&(wa[wa.length]=
mc.a.PBi);F&&(wa[wa.length]=mc.a.L6);f&&(wa[wa.length]=mc.a.JPd);l&&(wa[wa.length]=mc.a.LPd);x&&(wa[wa.length]=mc.a.sFc);a.className=0<wa.length?wa.join(" "):mc.a.MWb;this.SFf(a,b,R);return a}c7h(a,b,c){if(b&&a){if(b=tb.a.Erb(b))if(b=Tc.StyleReader.BP(b)){a.setAttribute("data-ccp-charstyle",b);return}(c=Ya.ParagraphReader.Wd(c)?Tc.StyleReader.kD(c):null)&&(c=Tc.StyleReader.BP(c))&&c!==Tc.StyleReader.HJa&&c!==Tc.StyleReader.lEh&&a.setAttribute("data-ccp-parastyle",c)}}b7h(a,b,c){(c=this.Dv.feg(c))&&
a.style&&a.style.fontSize&&""!==a.style.fontSize&&(a=a.style.fontSize,a=parseFloat(Ma.a.substring(a,0,a.indexOf("px"))),isNaN(a)||(b.style.verticalAlign=a/this.Dv.d1d()*c/100+"px"))}$Gd(){}LDf(){}KDf(){}Twi(a,b,c,f){b=b.Oo(ka.a.span);b.className=mc.a.HUd;this.vxc&&this.vxc.QDl(f,b);a.appendChild(b);c(b);return b}HRf(a,b,c,f){b=b.Oo(ka.a.span);b.className=mc.a.OM;a&&(b.style.fontSize=a.style.fontSize,b.style.lineHeight=this.qYd(a),b.style.fontFamily=a.style.fontFamily);a="";for(let l=0;l<f;l++)a+=
c;b.innerText=a;return b}qYd(a){return a.style.lineHeight}IHd(a,b){a?(Sys.UI.DomElement.addCssClass(a,"Highlight"),Sys.UI.DomElement.addCssClass(a,mc.a.TBi),b||Sys.UI.DomElement.addCssClass(a,mc.a.KPd)):b&&((a=Sys.UI.DomElement.containsCssClass(b,mc.a.KPd))&&Sys.UI.DomElement.removeCssClass(b,mc.a.KPd),Sys.UI.DomElement.addCssClass(b,a?mc.a.VBi:mc.a.UBi))}static Hga(a,b,c){L.a.ov(c,aa.a.DDa,b);b<a.count?a.$(b,c):a.add(c);return b+1}static M7f(a){let b,c;b=[];c=[];if(a&&a.tg)for(let f=0;f<a.tg.length;f++){const l=
a.tg.ga(f);Array.add(l.fk?b:c,l.KH)}return{KDc:b,GDc:c}}static udi(a,b){const c=new Ic.a;for(const l of b){var f=a.re(l);b=f.getValue(Bb.a.yVb);if(f=f.sa(Bb.a.HDc,null)){let x;({value:x}=c.Of(f)).returnValue||(x=new Ha.a,c.$(f,x));x.add(b)}}return c}static O7f(a,b,c){const f=new Ha.a,l=Wc.udi(a,b);for(const x of b){const F=a.re(x),R=F.getValue(Bb.a.yVb),fa=F.sa(Bb.a.Msi,!1),wa=F.sa(Bb.a.ROf,!1);F.sa(Bb.a.b9d,!1)&&!wa&&(c.add(x),fa||l.Jb(R)||f.add(F.id))}return Za.vNk(b,f)}static ytl(a,b,c,f){const l=
new Ha.a,x=new Ha.a;b=Wc.O7f(a,b,l);a=Wc.O7f(a,c,x);c=new Ha.a;c.addRange(f);c.addRange(l);c=Za.wNk(c,x);return{KDc:b,GDc:a,mCi:c,HHj:0<x.count}}static IYi(a,b){var c=1;if(n.a.aF&&!b){a=Ba.a.mKc(a,!1);for(let f of a)"IMG"===f.tagName?c+=3:Sys.UI.DomElement.containsCssClass(f,"PageBreakBlob")&&(c+=nb.FGc+nb.GRd)}return c}}Wc.HTi=.8;Wc.Swh="TrackChangeImageOverlay";Object(e.a)(Wc,"ParagraphContentRenderer",null,[1314]);var Ib=d(74),ec=d(594),Jb=d(1172),hb=d(55);class Rc{constructor(a){this._element=
null;this.Xh=a;this.$rc=[]}get ownerDocument(){return this.Xh}get element(){return this._element}Ofb(a){this._element=a}gVg(){var a=Sys.EventArgs.Empty;if(this.$rc)for(let b=0;b<this.$rc.length;b++)(0,this.$rc[b])(this,a)}dispose(){this.$rc=this._element=this.Xh=null}}Object(e.a)(Rc,"APresenter",null,[1460,106]);class gd extends Rc{constructor(a,b){super(b.htmlElement.ownerDocument);this.vkb=null;this.yPb=a;this.YXh=b}G5f(a){this.element&&a.SUc===this.vkb||(this.vkb=a.SUc,this.Ofb(this.yPb.HRf(this.vkb,
this.YXh.Fd,aa.a.GHc,1)),this.element.className=mc.a.F5b,this.element.style.lineHeight=this.vkb.style.lineHeight,a=""+L.a.re(this.vkb,aa.a.jIb),L.a.ov(this.element,aa.a.jIb,a),a=Jb.a.createElement(this.ownerDocument,ka.a.span),a.innerText=aa.a.iji,Ba.a.$t(this.element),this.element.appendChild(a),a=Jb.a.createElement(this.ownerDocument,ka.a.br),this.element.appendChild(a))}jqg(){}dispose(){super.dispose();this.vkb=null}}Object(e.a)(gd,"LineBreakPresenter",Rc,[]);class hd{constructor(a){this.yPb=a}create(a){return new gd(this.yPb,
a)}}Object(e.a)(hd,"LineBreakPresenterFactory",null,[1412]);class Hd extends Rc{constructor(a,b){super(a.ownerDocument);this.cEd=b;this.saa=a}G5f(){this.element||(this.Ofb(this.saa.Oo(ka.a.span)),19===this.cEd.kind||18===this.cEd.kind?Sys.UI.DomElement.addCssClass(this.element,mc.a.IPd):(Sys.UI.DomElement.addCssClass(this.element,mc.a.NWb),this.element.title=Box4Intl.Box4Strings.l_UnsupportedTooltip),this.element.innerText=this.cEd.G4a,this.gVg())}jqg(){this.Ofb(null);this.gVg()}}Object(e.a)(Hd,"UnsupportedObjectPresenter",
Rc,[]);class Xd{create(a,b){return new Hd(a,b)}}Object(e.a)(Xd,"UnsupportedObjectPresenterFactory",null,[1411]);class id{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,x=!1,F=!1,R=!1){this.Lw=a;this.CIi=b;this.Ixl=c;this.Jxl=f;this.UJb=l;this.hEh=x;this.I8d=F;this.QAl=R}}Object(e.a)(id,"ParagraphContentRendererSettings",null,[]);var fd=d(109);class Vf{constructor(a,b,c){this.CU=a;this.mY=b;this.bMb=c}i6a(a){return a}I9f(a,b,c){return c.nha(a)}p7f(){return null}K$f(){return n.a.Hj&&window.chrome?"none":null}uMf(){return!1}Jxh(){return!1}YFf(){return""}tCh(){}oPf(){}nph(a){return a===
C.a.underline||a===C.a.Ima||a===C.a.strikethrough||a===C.a.ys||a===C.a.W9}nAe(a,b){this.CU&&this.CU.isEnabled&&this.CU.createFontUrl(a);this.mY&&this.mY.isEnabled&&(b=ia.FontUtils.Pmb(b,a,!1,!1,!0),this.mY.createFontUrl(a));return b}t7g(a,b,c=null){if(!a)return b;b=this.nAe(a.fontName,b);this.bMb&&this.bMb.isEnabled&&(b=ia.FontUtils.Pmb(b,a.fontName,!1,!0),this.bMb.aDl(a)||this.bMb.lCl(c),this.bMb.vCl(a));return b}PRc(){return!1}PYd(a,b,c,f){a=null;!c&&f||!b.B2||(b=b.fontColor,a=b===Eb.a.auto?"WindowText":
Eb.a.LH(b));return a}iph(a,b,c,f,l){return!b&&!c&&!f&&!l}feg(){return 0}d1d(){return.8}Ooh(a,b){return a||!b}qph(){return!1}Qoh(){return!1}r8f(){return new Ic.a}s8f(){return null}y_b(a){return fd.Font.LBa(a.TM)}}Object(e.a)(Vf,"TextRenderingStrategy",null,[1249]);class Qd{get name(){return"Box4.ParagraphRenderElements"}Wb(a){a.register(hd,"Box4.LineBreakPresenterFactory").as("Box4.ILineBreakPresenterFactory").ma().na(()=>new hd(a.resolve("Box4.IParagraphContentRenderer")));a.register(Xd,"Box4.UnsupportedObjectPresenterFactory").as("Box4.IUnsupportedObjectPresenterFactory").ma();
a.register(Vf,"Box4.TextRenderingStrategy").as("Box4.ITextRenderingStrategy").ma().na(()=>new Vf(a.pb("Box4.IFontService"),a.pb("Box4.CustomFontService"),a.pb("Box4.IEmbeddedFontService")));a.register(id,"Box4.ParagraphContentRendererSettings").ma().na(()=>new id(Ib.ListReader.Lw,u.AFrameworkApplication.fa.ka("DragDropSelectionIsEnabled"),H.a.instance.ga(49),H.a.instance.ga(53),u.AFrameworkApplication.fa.ka("WordEditorCommentImprovementIsEnabled"),u.AFrameworkApplication.fa.ka("CommentTextAnchoringUIEnabled"),
u.AFrameworkApplication.fa.ka(ia.FontUtils.iOf),u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")));a.register(Wc,"Box4.ParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().na(()=>new Wc(pa.InteractiveViewManager.instance,ja.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.pb("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),a.resolve("Box4.ITextRenderingStrategy"),
a.resolve("Box4.ParagraphContentRendererSettings"),a.resolve("Box4.ILineSpacingHelper"),a.pb("Box4.IFeatureHelper"),ia.FontUtils.mha,a.pb("Box4.IFontSlotProvider"),Object(D.a)(a.resolve("Box4.IEditStateEventManager"),a.resolve("Box4.IEditStateEventManager").M9g,"raiseParagraphContentUpdatedEvent"),tb.a.language,a.pb("Box4.ITableOfContentRenderHelper"),ec.a.yIf))}init(){}dispose(){}static main(){m.a.instance.Ac(new Qd)}}Object(e.a)(Qd,"Box4ParagraphRenderElementsPackage",null,[2,3]);class Zf{constructor(a,
b,c,f,l,x,F){this.K9d=a;this.qQj=b;this.KSc=c;this.PKj=f;this.KNj=l;this.Lw=x;this.hOj=b&&F||f}}Object(e.a)(Zf,"TableCellViewElementSettings",null,[]);class Ge{get name(){return"Box4.TableViewElements"}Wb(a){a.register(Zf,"Box4.TableCellViewElementSettings").ma().na(()=>new Zf(u.AFrameworkApplication.fa.ka("OneNoteSpannedTableCellRenderIsEnabled"),H.a.instance.ga(63),H.a.instance.ga(30),H.a.instance.ga(77),H.a.instance.ga(71),Ib.ListReader.Lw,u.AFrameworkApplication.fa.ka("WordEditorTableCellWidthIsEnabled")))}init(){}dispose(){}static main(){m.a.instance.Ac(new Ge)}}
Object(e.a)(Ge,"Box4TableViewElementsPackage",null,[2,3]);var le=d(1157),Sa=d(376),Cb=d(1181),rc=d(218),bd=d(159),pd=d(176),Oa=d(1113);class jb{re(a,b){return L.a.re(a,b)}ov(a,b,c){L.a.ov(a,b,c)}fma(a,b){L.a.fma(a,b)}tHa(a){L.a.tHa(a)}rEc(a,b){L.a.rEc(a,b)}}Object(e.a)(jb,"CustomDataProxy",null,[1537]);var nc=d(343),kb=d(62),Gb=d(27);class tc{constructor(){this.Pa=new qd.a}dEk(a){this.Pa.raiseEvent("OnBackspaceDelete",a)}}Object(e.a)(tc,"BackspaceDeleteEventSource",null,[1450,1451]);class dd extends Sys.EventArgs{constructor(a,
b){super();this.WL=a;this.OT=b}}dd.eventId="AEV.AVLD";Object(e.a)(dd,"EditingViewOnAfterValidateEventArgs",Sys.EventArgs,[]);class $c extends qd.a{constructor(){super()}oCf(a){this.addHandler(dd.eventId,a)}kPk(a){this.removeHandler(dd.eventId,a)}}$c.eti="AEV.CR";Object(e.a)($c,"ContentEditableViewEventSource",qd.a,[]);var Pc=d(49);class Ad{constructor(){this.Ivc=null;this.Lh=0}Q8i(a){if(!this.Ivc){var b=a.Kb?Pc.a.createTextRange(a.node,0,a.Kb):Pc.a.Uj(a.node,a.Kb);this.Ivc=Rb.HyperlinkReader.FB(b,
!1);this.Lh=this.Ivc.length-1}for(;0<=this.Lh;)if(b=this.Ivc[this.Lh],a.Kb<=b.Qa)--this.Lh;else return b.Kb<=a.Qa?null:b;return null}}Object(e.a)(Ad,"OverlappingHyperlinkHelper",null,[]);class Ee{constructor(a,b,c,f,l){this.SYa=a;this.UC=b;this.Kpa=c;this.l5c=f;this.m5c=l}}Object(e.a)(Ee,"PersistActiveSpanEditState",null,[]);class Ce{constructor(a,b){this.og=a;this.Vg=b;this.lvc=[];this.rH=this.qH=-1}rEe(){if(-1!==this.qH&&-1!==this.rH&&this.Vg){this.lvc.reverse();const a=this.lvc.join("");let b,
c;this.qH===this.rH?(b=Pc.a.Uj(this.og,this.qH),c=!!a.length):(b=Pc.a.createTextRange(this.og,this.qH,this.rH),c=this.rH-this.qH!==a.length||this.w1d(b)!==a);c&&this.Vg.replaceTextRange(b,a,!0,void 0,C.a.typing)}this.rH=this.qH=-1;Array.clear(this.lvc)}I8h(a,b){this.qH=a.Qa;-1===this.rH&&(this.rH=a.Kb);0<b.length&&Array.add(this.lvc,b)}w1d(a){return Ya.ParagraphReader.text(a.node).substring(a.Qa,a.Kb)}}Object(e.a)(Ce,"ReplacementTextRangeBuilder",null,[]);var Fb=d(38);class $e{constructor(a,b,c,f,
l,x,F,R,fa,wa,Xa,lb){this.zh=a;this.GC=b;this.poa=c;this.Xf=f;this.hd=l;this.Xm=x;this.qd=F;this.Fm=fa;this.jd=wa;this.jf=Xa;this.jb=lb;this.htc=this.jb.ka("TextLayoutServiceUseResponse");this.Daf=this.jb.ka("TextLayoutServiceEnableActiveContentSpanFix")}Kpl(){let a,b;a=b=null;if(this.qd&&this.qd.dU){var c=this.Fm.getSelection(this.jd.contentWindow);if(c){a=b=c.focusNode;for(c=null;b&&"span"!==(c=b.nodeName.toLowerCase())&&!Sys.UI.DomElement.containsCssClass(b,mc.a.Pda);)b=b.parentNode;"span"!==c&&
(b=null);return{returnValue:!!b,o4f:a,p4f:b}}}return{returnValue:!1,o4f:a,p4f:b}}o8i(a){let b=0;for(let c of Ba.a.t6a(a))"span"===c.nodeName.toLowerCase()&&b++;return b}ZYk(a){if(!a.parentNode||!a.parentNode.parentNode)return null;for(var b=a.parentNode;!Sys.UI.DomElement.containsCssClass(b,mc.a.Pda)&&!Sys.UI.DomElement.containsCssClass(b,mc.a.W7);){if("font"===b.nodeName.toLowerCase()){a=b.previousSibling;if(!a)break;if("a"===a.nodeName.toLowerCase()){b=null;for(let c of Ba.a.t6a(a))"span"===c.nodeName.toLowerCase()&&
(b=c);return b}}b=b.parentNode}return null}V_i(a,b,c,f,l){let x=Ba.a.Su(c);const F=Ba.a.WWd(c,mc.a.Pda);l=this.o8i(F)+this.zh.yi.length-l.Is.length;2>l?f.nextSibling&&"span"!==f.nextSibling.nodeName.toLowerCase()&&"br"!==f.nextSibling.nodeName.toLowerCase()?x=Ba.a.Su(f)+Ba.a.Su(f.nextSibling):"span"!==c.nodeName.toLowerCase()&&c.nextSibling?x=Ba.a.Su(f):"#text"===c.nodeName.toLowerCase()&&c.parentNode!==f&&(x=Ba.a.Su(f)):2===l?f.nextSibling&&"span"===f.nextSibling.nodeName.toLowerCase()&&(x=Ba.a.Su(f)+
Ba.a.Su(f.nextSibling)):2<l&&(x=b.innerText,Z.ULS.sendTraceTag(541172697,323,50,"GetCorrectLastActiveSpanTextForCompleteOvertype: SpanCountDiff > 2"));a.EVb||!b.innerText.endsWith(" ")||x.endsWith(" ")||(x+=b.innerText.substr(b.innerText.trimEnd().length));return x}Puk(a,b,c,f,l){const x=new Ee(null,null,!0,null,null);let F=null,R=null;if(1===this.jf.mode||2===this.jf.mode)({o4f:F,p4f:R}=this.Kpl());let fa=!1,wa=!1;const Xa=new Ad,lb=new Ce(a,f),Lb=0<this.zh.yi.length&&this.zh.yi[0].EVb;let kc=null;
F&&this.jb.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&(kc=this.ZYk(F));for(let Ec=this.zh.yi.length-1;0<=Ec;Ec--){const Jc=this.zh.yi[Ec],Dc=Jc.JE;let Wd=!1;if(this.Daf&&this.htc&&R&&!Ba.a.fYb(Dc)){var lc=!1;Lb&&Ec===this.zh.yi.length-1&&!Ba.a.WWd(F,mc.a.OM)?Wd=lc=!0:1===this.zh.yi.length&&(lc=!0);lc&&(Dc.innerText=this.V_i(Jc,Dc,F,R,c),x.Kpa=!1)}x.UC=Ba.a.Su(Dc);this.GC.a6&&this.HKi(x.UC)&&(x.UC=Ma.a.substr(x.UC,0,x.UC.length-1));lc=this.G_i(a,Ec);this.Ldk(a,b,Ec,x);wa=!!x.SYa||wa;kc===Dc&&
(x.m5c=Dc.innerText+Ba.a.Su(F),F.nodeValue="",x.Kpa=!1,Z.ULS.sendTraceTag(541172698,323,50,"PersistActiveSpanEdits: Moved text from bare node to sibling span"));x.l5c||(x.l5c=this.iRi(a,lc,Xa));const xe=!!l&&l.qti(lc);this.Fsl(a,b,Dc,Ec,x,Wd);xe&&0<x.UC.length?(lb.rEe(),this.replaceTextRange(f,x,"",lc),this.c9h(l,xe,x,lc)):this.tqi(Jc,x.UC,lc,lb);fa=Dc===R||fa}lb.rEe();this.yul(a,x);F&&Ba.a.Su(F)&&!fa&&!wa&&(this.hd.Tb("ValidTextDropped",{["Reason"]:"TextLostDuringOvertype"}),$e.Ucf||(Z.ULS.sendTraceTag(23909632,
323,50,"PersistActiveSpanEdits: browser created new span with text that are is lost during OverType"),$e.Ucf=!0));return x.Kpa}tqi(a,b,c,f){if(c.contextId!==Fb.a.Lf&&!a.EVb&&0<=a.T8c){let l=a.T8c,x=a.Wwe;a=l!==x?Pc.a.createTextRange(c.node,l,x):Pc.a.Uj(c.node,l);b=b.substring(l-c.Qa,b.length-(c.Kb-x))}else a=c;a.Kb-a.Qa!==b.length||b!==this.w1d(a)?f.I8h(a,b):f.rEe()}HKi(a){return a.charAt(a.length-1)===nb.HCb||n.a.$n&&a.charCodeAt(a.length-1)===w.a.JJb}w1d(a){return Ya.ParagraphReader.text(a.node).substring(a.Qa,
a.Kb)}replaceTextRange(a,b,c,f){b.UC!==c&&a&&a.replaceTextRange(f,b.UC,!0,!0)}c9h(a,b,c,f){b&&0<c.UC.length&&(b=Pc.a.createTextRange(f.node,f.Qa,f.Kb+c.UC.length),a.e9h(b))}yul(a,b){b.l5c&&(b=Rb.HyperlinkReader.FB(b.l5c,!0),1===b.length&&this.Xm&&this.Xm.x6k(a,b[0]))}Fsl(a,b,c,f,l,x){const F=Ba.a.Gcg(c);this.zh.yi[f].EVb&&F?x||this.pkj(b,f,l,F):l.SYa&&!Sys.UI.DomElement.containsCssClass(c,mc.a.yM)?(this.hd.Tb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan"}),this.Xf.bc++,l.UC+=l.SYa,
l.SYa=null,Ba.a.ix(this.zh.yi[f].JE,l.UC)):l.m5c?(l.UC=l.m5c,l.m5c=null):this.htc&&this.Daf&&(a=Ya.ParagraphReader.text(a),b=this.zh.yi[f],c=b.T8c,x=b.Wwe,f+1<this.zh.yi.length&&!Ba.a.fYb(this.zh.yi[f+1].JE)&&c===x&&0<c&&" "===a.charAt(c-1)&&(l.UC=l.UC.substr(0,c-1)+" "+l.UC.substr(c-1),l.Kpa=!1),b.JE.innerText.endsWith(" ")||" "!==a.charAt(x)||b.pWa+b.yQa!==x+1||(l.UC+=" ",l.Kpa=!1))}pkj(a,b,c,f){!b&&c.SYa?(this.hd.Tb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan0"}),this.Xf.bb++,
c.UC=c.SYa,Ba.a.ix(this.zh.yi[b].JE,c.UC),this.qd.dF&&(a=a.lastChild,this.htc&&Sys.UI.DomElement.containsCssClass(a,mc.a.W7)&&(a=a.lastChild),a&&a.parentNode&&a.parentNode.insertBefore(f,a)),c.SYa=null):(this.hd.Tb("ValidTextDropped",{["Reason"]:"EopTextLostDuringOvertype"}),this.Xf.bd++,c.UC="",Ba.a.ix(this.zh.yi[b].JE,c.UC))}G_i(a,b){b=this.zh.yi[b];return b.pWa?Pc.a.createTextRange(a,b.yQa,b.yQa+b.pWa):Pc.a.Uj(a,b.yQa)}Ldk(a,b,c,f){if(this.zh.yi[c].yQa+this.zh.yi[c].pWa===Ya.ParagraphReader.textLength(a)&&
(a=b.lastChild,this.htc&&Sys.UI.DomElement.containsCssClass(a,mc.a.W7)&&(a=a.lastChild),c=Ba.a.Su(a),c.length>this.poa.yTd)){this.Xf.ba++;this.GC.Cfb(!1,b,this.zh);f.SYa=Ma.a.substr(c,0,c.length-this.poa.yTd);b="";for(c=0;c<this.poa.yTd;c++)b+=aa.a.GHc;a.innerText=b;f.Kpa=!1}}iRi(a,b,c){return(b=c.Q8i(b))&&$e.ACj(b)?Pc.a.Uj(a,b.Qa):null}static ACj(a){return!!a.hyperlink&&a.hyperlink.url===Ya.ParagraphReader.text(a.paragraph).substring(a.Qa,a.Kb)}}$e.Ucf=!1;Object(e.a)($e,"ActiveContentSpansPersistanceManager",
null,[1449]);class bg{constructor(a){this.ks=a}shk(a){a&&this.ks.OX()}}Object(e.a)(bg,"AppFrameResizeEventProcessor",null,[]);class Ye{constructor(){this.qSb=new Ha.a}xa(a){this.qSb.add(a)}Yqa(a){return this.qSb.count>a?this.qSb.ga(a):null}get GDa(){return this.qSb.count}isEmpty(){return!this.qSb.count}}Object(e.a)(Ye,"AggregatedAutoCorrectActions",null,[1335]);var Ae=d(226);class si{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec){this.DQ=this.Xm=this.csc=this.Pe=null;this.zu=a;this.uJ=b;this.sh=
c;this.Lb=f;this.zh=l;this.kY=x;this.ap=F;this.Pi=R;this.Wfa=fa;this.ks=wa;this.jf=Xa;this.dR=lb;this.jk=Lb;this.Pc=kc;this.Wc=lc;this.Lo=Ec}PR(a){this.Pe=a}get JTb(){return this.uJ}get hyperlinkEditor(){return this.Xm||(this.Xm=hb.a.instance.pb("Box4.IHyperlinkEditor"))}get Zsj(){return this.csc||(this.csc=hb.a.instance.pb("Box4.IHyperlinkActionFactory"))}YAj(a){if(this.zu.instance&&a&&2===this.sh.mode)if(this.Pe.hs(!0),this.Wfa.value.Pv(),a.Iw)this.zu.instance.WAj(a),this.Wfa.value.Pv();else{var b=
this.Pi.d7(this.sh.mode,this.Lb.Di);a.rkg.innerText=a.rkg.innerText;this.dR.jic();this.ap.raiseEvent(Ae.a.autoCorrect);1===this.zu.instance.XAj(a)&&(this.jf.X9(!0),b>=a.AQ&&(b+=a.iVc),this.Pi.fS(b,this.Lb.Nh),this.Pe.hs(!0),this.Wfa.value.Pv(),this.ks.OX())}}lre(a,b){if(!this.zu.instance||!this.Zsj||!this.hyperlinkEditor)return null;this.Pe.hs(!0);a=this.kY.ira(b).Ua;b=a.Qa;if(0>=b||!this.zh.yi.length)return null;if(a=this.zu.instance.lre(a.node,b))this.DQ||(this.DQ=new Ye),this.DQ.xa(a);return a}qHi(a,
b){if(2===this.sh.mode&&this.zh.yi.length){var c=this.Pi.d7(this.sh.mode,this.Lb.Di);!this.DQ&&this.zu.instance&&(b=this.kY.ira(b).Ua,0>c||!this.zh.yi.length||(this.DQ=new Ye,this.DQ=this.zu.instance.pRf(b.node,c,c-this.zh.yi[0].nBc,this.zh.yi[0].JE,!this.zh.yi[0].nBc,a),this.DQ.GDa||(this.DQ=null)))}}Guk(){if(2===this.sh.mode){if(0<this.DQ.GDa){this.Pe.hs(!0);for(var a=0;a<this.DQ.GDa;a++)this.DQ.Yqa(a).hDh();for(a=0;a<this.DQ.GDa;a++)this.YAj(this.DQ.Yqa(a))}this.DQ=null}}}Object(e.a)(si,"AutocorrectActionExecutor",
null,[]);var Jf=d(307);class tg{constructor(a,b,c,f,l,x,F,R,fa,wa){this.yXh=x;this.kY=a;this.$i=b;this.LC=c;this.$e=f;this.CJ=l;this.bVe=F;this.Wc=R;this.JC=fa;this.Axa=!!wa;this.zu=wa}Wpl(a,b,c,f,l,x,F){if(!f)return!1;f=this.kY.ira(l);if(!f||!this.$e.Jw(f)||!f.Ua.Kk)return!1;l=f.Ua;if(this.gKj(l)||this.NHj(a,l)||this.t8a(l))return!1;if(Gb.App.Rai){if(this.fKj(x))return!1}else if(this.eKj(x))return!1;return this.CJ&&this.CJ.wub(f)||!this.tii(a,this.$i,F,Ba.a.Su(c),b)||this.Axa&&!a&&this.zu.instance&&
this.zu.instance.qrj()?!1:!0}fKj(a){if(this.bVe&&a&&Sys.UI.DomElement.containsCssClass(a,mc.a.Pda)){const b=Ba.a.uba(a,mc.a.W7);b&&(a=b)}return Ba.a.uba(a,tg.UUg)?!0:!1}eKj(a){if(this.bVe&&a&&Sys.UI.DomElement.containsCssClass(a,mc.a.Pda)){const b=Ba.a.uba(a,mc.a.W7);b&&(a=b)}return Ba.a.uba(a,Jf.a.i9a)||Ba.a.uba(a,tg.UUg)?!0:!1}t8a(a){return this.JC.t8a(a).returnValue}gKj(a){return this.$i&&(!this.yXh.vUb(a.node)||H.a.instance.ga(14)&&this.LC.J2g(a.node))?!0:!1}NHj(a,b){return H.a.instance.ga(14)&&
this.LC.uIj(b,!a)}tii(a,b,c,f,l){if(!f||""===f)return!1;var x=this.Wc.Zf&&this.Wc.jy;x=a&&!x?0:1;!a&&1<c&&Ma.a.Mw(f,c-1)?x=2:c<f.length&&Ma.a.Mw(f,c)&&(x=1);if(a){if(a=c+x,a>=f.length-2||!this.uii(c,f,x))return!1}else{a=c-x;if(b){if(0>a)return!1}else if(0>=a)return!1;if(1===a&&Ma.a.yy(f.charCodeAt(0))&&(f.length===c||Ma.a.yy(f.charCodeAt(c))))return!1}b=P.a.bCa(l,a,!0,!0);return Sys.UI.DomElement.containsCssClass(b,aa.a.RBi)||Sys.UI.DomElement.containsCssClass(b,mc.a.OM)||Sys.UI.DomElement.containsCssClass(b,
mc.a.yM)||Sys.UI.DomElement.containsCssClass(b,aa.a.YU)?!1:!0}uii(a,b,c){return Ma.a.yy(b.charCodeAt(a+c))&&(!a&&b.length===1+c||1===a&&Ma.a.yy(b.charCodeAt(0)))?!1:!0}}tg.UUg="NoteTagContainer";Object(e.a)(tg,"BackspaceInBrowserHandler",null,[]);var Dg=d(1168),Vg=d(193);class Ih{constructor(a,b,c){this.point=a;this.width=b;this.height=c}}Object(e.a)(Ih,"UnroundedRectangle",null,[]);var hf=d(1025),ld=d(61),ph=d(143);class Kf{constructor(a,b,c,f,l,x,F,R,fa){this.uh=null;this.yea=!1;this.Y$=a;this.jd=
b;this.qY=c;this.W0=f;this.qd=l;this.Hf=x;this.jf=F;this.Lb=R;this.UO=fa}RTb(a){this.uh=a}OX(){if(2===this.jf.mode&&this.Lb.xg){var a=this.Lb.lV,b=this.Lb.Nh;if(a&&b){if(!this.jd.ug&&(u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordBoundsSynchronizerHeaderFooterEarlyReturnSettings"),u.AFrameworkApplication.fa.ka("BoundsSynchronizerHeaderFooterEarlyReturnIsEnabled"))){Z.ULS.sendTraceTag(51667991,317,50,"Null EditingDom in SynchronizeBounds. ViewId: {0}",this.uh.Ma);return}this.jd.ug.qte(a);
b=this.jd.ug.St;var c=this.$8f(a.htmlElement,b.parentNode);if(c&&c.point){var f=c.point;a=c.width;c=c.height;0>a&&(a=0);var l=Dg.a.create();try{b.style.top=f.y.toString()+"px",b.style.left=f.x.toString()+"px",b.style.width=a.toString()+"px",b.style.height=c.toString()+"px",b.style.paddingRight=""}finally{l&&l.dispose()}this.wph()&&(f=this.jd.Tl(),this.aQj()?f.style.clip="":(b.style.height=c+100+"px",f.style.clip="rect(0px,"+a+"px,"+c+"px,0px)"));this.Y$.instance.Vul(b.parentNode,this.Lb.Zaa,!!this.uh&&
this.uh.Bl&&this.uh.arb)}}}}wph(){return this.qd.dF&&!this.qd.Ki&&H.a.instance.ga(30)}dFj(a){return Ba.a.HRa(a)}aQj(){return ph.c(this.uh.rg)}Yh(a){return kb.a.Yh(a)}ruh(a){var b=ld.a.instance.Oa.kb;if(1===this.jf.mode){var c=(b.qf?b.Te:b.Ua).node;b=c.oc(this.Hf.Ld.Ma);a=c.oc(a);if(b&&a){this.jd.ug.qte(b);a=this.jd.ug.St;var f=this.$8f(b.htmlElement,a.parentNode);if(f&&f.point){b=f.point;c=f.width;f=f.height;0>f&&(f=1);0>c&&(c=1);a=a.style;if(this.qd.efb)this.W0.Ujg();else{const l=b.x+"px";c+="px";
f+="px";if(a.left!==l||a.width!==c||a.height!==f)a.left=l,a.width=c,a.height=f}b=b.y+"px";a.top!==b&&(a.top=b)}}}}$8f(a,b){if(!this.dFj(a))return null;var c=this.Yh(a),f=this.Yh(b);let l=c.x-f.x;f=c.y-f.y;var x=Dg.a.create();try{l+=b.scrollLeft,f+=b.scrollTop}finally{x&&x.dispose()}b=c.width;c=c.height;this.qY&&this.qY.instance&&this.qY.instance.Rtg(a)&&(x=this.qY.instance.S1,b/=x,c/=x);if(this.UO.ivb(a)){var F=Vg.a.Ru(a);F&&(x=parseFloat(F.width),F=parseFloat(F.height),isNaN(x)||isNaN(F)||(b=x,c=
F))}0>=b&&(b=a.scrollWidth);0>=c&&(c=a.scrollHeight);if(this.qd.JRa||this.qd.$n)b+=.001,l+=.001,f+=.001;c+=1.001;return new Ih(new hf.a(l,f),b,c)}}Object(e.a)(Kf,"BoundsSynchronizer",null,[1447]);var Ud=d(553),He=d(78);class Bh{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.FQh=new Ud.a(RegExp("\r\n","g"),"\n");this.gud=null;this.Yvd=0;this.Ozd=!1;this.rsc=!0;this.hd=b;this.Xf=c;this.ztc=a;this.jd=f;this.Io=l;this.qd=x;this.Hf=F;this.Rd=R;this.$i=fa;this.Fm=wa;this.bBd=Xa;this.Yoa=Lb}get csg(){null==
this.gud&&(this.gud=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CursorPositionFixForIMEInMacIsEnabled"):!1);return this.gud}get vSa(){return this.Yvd}get RGk(){return this.Ozd}get cAj(){return this.rsc}DKc(a,b){var c=this.jd.JBa();if(1===a||0===a)return 0;if(this.qd.dU){var f=this.GBa();if(f){this.Ozd=!this.lTc(f);c=this.Fm.pNc(f);var l=this.Fm.Odg(f),x=l;u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordCursorPositionFixForIMEInMacSettings");this.csg&&this.qd.ek&&
(f=this.Fm.d9f(f),l!==f&&(x=f));return this.Io.w_d(c,b,x,this.Xf,this.hd,this.$i)}Z.ULS.sendTraceTag(51463631,324,50,"GetCaretPosition could not find IP, rangeObject is null")}else if(this.qd.aF)try{return l=c.selection.createRange(),x=this.jd.Tl().innerText,b=0,""!==x&&(b=Math.abs(this.Fm.moveStart(l.range,-1E5)),l=c.selection.createRange(),f=Math.abs(this.Fm.moveEnd(l.range,-1E5)),this.Ozd=b!==f),x=this.FQh.VGa(x),b>=x.length&&(b=x.length-1),b}catch(F){this.hd.Tb("IncorrectIpPosition",{["Reason"]:"OldIeGetCaretPositionException"}),
this.Xf.bg++,Z.ULS.sendTraceTag(51463190,324,15,"Incorrect IP position, message: {0}, Exception: {1}",F.message,F.toString())}else Z.ULS.sendTraceTag(51463191,324,15,"GetCaretPosition could not find IP, returned 0");this.Xf.bh++;return 0}lTc(a){return kb.a.lTc(a)}GBa(){return kb.a.GBa(this.jd.contentWindow)}O$k(a,b,c,f,l){if(!u.AFrameworkApplication.fa||!u.AFrameworkApplication.fa.ka("TextLayoutServiceEnableSelectionCursorFix")||c!==l+f||a===b.Is.length-1||Sys.UI.DomElement.containsCssClass(b.Is[a+
1],mc.a.OM))return!1;a=b.Is[a];b=Ba.a.WWd(a,mc.a.W7);if(!b)return!1;b=Ba.a.t6a(b).toArray();return b[b.length-1]!==a?!1:!0}fS(a,b){var c=this.jd.contentWindow;this.rsc=!0;this.Yvd=a;try{if(this.qd.dU){const x=b.Is;let F;var f=0;const R=this.Fm.getSelection(c);if(R)for(F=0;F<b.Is.length;F++){const fa=b.Is;Z.ULS.shipAssertTag(18437200,315,x===fa);let wa=fa[F],Xa=this.Io.YH(wa,this.Xf,this.hd,this.$i);var l=a<=Xa+f;const lb=Sys.UI.DomElement.containsCssClass(wa,mc.a.yM),Lb=Sys.UI.DomElement.containsCssClass(wa,
aa.a.YU),kc=this.O$k(F,b,a,f,Xa);if(l&&!lb&&!Lb&&!kc){b=F+1;if(a===Xa+f&&b<fa.length){const lc=fa[b];!this.Io.YH(lc,this.Xf,this.hd,this.$i)&&Ba.a.fYb(lc)&&(wa=lc,f=a)}a-=f;this.ztc.value.uVb(wa,c);for(c=wa;c.firstChild;)c=c.firstChild;this.SCj(R,c,a)||(c=this.fMi(c,this.jd.JBa()),this.csg&&this.qd.ek?2!==this.Hf.editingView.Fpb&&this.ZZf(c,a,R):this.ZZf(c,a,R));break}f+=Xa}}else this.qd.aF&&(f=this.bBd.create(this.Hf.Ld),l=this.Fm.createRange(this.jd.Tl()),this.Fm.collapse(l,!0),this.Fm.moveStart(l,
a),l.select(),f.dispose())}catch(x){Z.ULS.shipAssertTag(4203852,315,!1)}}fMi(a,b){"SPAN"===a.nodeName&&(b=b.zl.createTextNode(""),a.appendChild(b),a=b);return a}ZZf(a,b,c){if(this.Io.Bsg(a)){this.Fm.removeAllRanges(c);var f=this.Fm.createRange(a.ownerDocument);this.Fm.jGb(f,!0,a,b);this.Fm.jGb(f,!1,a,b);try{this.Fm.addRange(c,f)}catch(l){this.Xf.bl++,this.hd.Tb("PossibleNoIp",{["Reason"]:"AddRangeException"}),Z.ULS.shipAssertTag(1708946,315,!1)}this.Fm.collapse(f,!0)}else Z.ULS.sendTraceTag(541172696,
324,50,"EnsureCaretPositionToTextObject: Detached element")}updateCaretPosition(a,b){this.Yvd=this.DKc(a,b)}mouseDown(){return this.rsc=!1}WW(){this.rsc=!0;return!1}d7(a,b){this.Yoa&&this.Yoa.Hyl(this.vSa,this.DKc(a,b));return this.vSa}SCj(a,b,c){const f=a.focusNode,l=!!f&&3===f.nodeType,x=a.focusOffset;return a.isCollapsed&&l&&f===b&&x===c}XUf(a,b){const c=new He.a(0,1,0,()=>{b.rSa(a.mode)&&this.updateCaretPosition(a.mode,b.Di)},28);this.Rd.Gb(c)}}Object(e.a)(Bh,"CaretPositionManager",null,[1448]);
var eg=d(263);class jd{constructor(){this.JH=eg.a.instance.tXd()}}Object(e.a)(jd,"CevUsageDataTracker",null,[]);class Jh{constructor(a,b){this.cqc=null;this.xga=0;this.xg=this.lV=null;this.Zaa=!1;this.iza=a;this.Hf=b}init(a){this.xga=a}get vrj(){return!!this.xg&&!!this.xg.Ag(this.xga)}get gOa(){Z.ULS.shipAssertTag(18437208,315,!!this.xg);return this.Nh?this.Nh.htmlElement:null}get Di(){return this.Nh?this.Nh.Di:null}get Nh(){return this.cqc}set Nh(a){this.cqc=a;a=null;this.iza.instance&&(a=this.iza.instance.hyh());
this.cqc&&a&&a.kEl(this.cqc.L2g)}rSa(a){return 1!==a||ld.a.instance.Oa.hca?this.xg&&this.Nh&&this.lV?(a=this.Hf.Ld)&&Ya.ParagraphReader.Wd(this.xg)&&this.Nh===this.xg.oc(this.xga)&&this.lV===this.xg.oc(a.Ma)?!0:!1:!1:!0}}Object(e.a)(Jh,"CevViewContentManager",null,[1446]);var kf=d(1175),Ji=d(367);class hh{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){this.Pe=null;this.zJ=a;this.jDd=b;this.hd=c;this.Dtd=f;this.Yoa=l;this.nga=x;this.vk=F;this.sh=R;this.Ir=fa;this.jf=wa;this.WKa=Xa;this.G$=lb;this.nB=
Lb;this.JU=kc;this.Nlb=lc}PR(a){this.Pe=a}mNd(a,b,c){if(this.WKa.Nuj||this.zJ.t2b||!b)return!1;if(this.jDd.aoh)return!0;b=this.hd.Bp(C.a.typing);b.properties.$(kf.a.source,"Composition");a=this.Zpi(a,c);b.end();return a}Zpi(a,b){this.Dtd.correctBadImeState()&&this.Yoa.fic(C.a.frl);this.nga.fixupAfterMagnifierDrag();if(this.JU.U8c(a))return!1;this.vk.bbe=(new Date).getTime();if(1===this.sh.mode){let c;({z2:b,yHb:c}=this.JU.kyh(a,b));if(b)return c}this.Ir.isComposing=!0;this.Nlb||this.jf.X9(!0);a.eventName===
qa.a.nNd&&this.G$.raiseEvent(Ji.a.uPf,a);this.nB.MMa(a);return!1}HVb(a,b,c){this.Nlb&&this.Pe&&this.Pe.hs(!0,!0);return this.mNd(a,b,c)}GVb(a,b,c){this.mNd(a,b,c);return this.Ir.isComposing=!1}}Object(e.a)(hh,"CompositionEventProcessor",null,[]);class Wb{constructor(a,b,c){this.dud=!1;this.G$=a;this.ap=b;this.M5=c}get isComposing(){return this.dud}set isComposing(a){(this.dud=a)?(this.G$.raiseEvent(Ji.a.$pi),this.ap.raiseEvent(Ae.a.Huj)):(this.G$.raiseEvent(Ji.a.Xpi),this.ap.raiseEvent(Ae.a.Fuj))}get rDa(){return!this.isComposing&&
!this.M5.mlg}}Object(e.a)(Wb,"CompositionStateManager",null,[]);var Uc=d(131),Sc=d(88);class Od{constructor(a,b,c){this.JNh=u.AFrameworkApplication.fa.ka("AccessibilityNotificationEnabledViaAriaLiveRegion");this.qza=this.ord=this.IEd=this.Yxa=this.Dqd=null;this.tmb=a;this.lH=b;this.Hna=c;this.render();this.Hna.y5c&&this.lH.vM(Object(D.a)(this,this.k5c,"modeSwitched"))}k5c(){this.Hna.Xoh&&this.hfd(!0);this.f_f()}get St(){return this.IEd}get contentWindow(){return kb.a.o9i(this.tmb.ownerDocument)}get contentDocument(){return this.tmb.ownerDocument}get wxa(){return this.tmb}get Bn(){return this.ord}get qEh(){return this.qza}get isValid(){return!0}initialize(a,
b){this.Yxa=a;this.Yxa.yJd=Object(D.a)(this,this.onBlur,"onBlur");b()}Afh(){this.St.style.left="0px";this.St.style.top="0px"}cLi(){this.Yxa&&this.Yxa.VLi(this,this.lH)}cma(){}zkd(){v.FocusManager.Dr(this.contentWindow)}Xxh(){v.FocusManager.Mql(this.Bn)}get Zfb(){return!kb.a.mBj(this.Bn)}set Zfb(a){}FHe(a,b,c){this.Bn.setAttribute(Uc.a.vs,a);this.Dqd&&(this.Dqd.innerText=b);this.ojc(c)}ojc(a){a&&this.Bn.setAttribute(Uc.a.We,a)}hfd(a){if(n.a.xj||a)a=!this.Hna.p7d&&a,this.Bn.setAttribute("contenteditable",
a?"true":"false"),this.Hna.Xoh?(Sys.UI.DomElement.addCssClass(this.Bn,"WACEditing"),Sys.UI.DomElement.addCssClass(this.Bn,I.AppFrame.uYf),Sys.UI.DomElement.addCssClass(this.Bn,"EditingSurfaceBody")):(Sys.UI.DomElement.removeCssClass(this.Bn,"WACEditing"),Sys.UI.DomElement.removeCssClass(this.Bn,I.AppFrame.uYf),Sys.UI.DomElement.removeCssClass(this.Bn,"EditingSurfaceBody"))}dispose(){this.hsl();this.St&&(this.St.parentNode&&this.St.parentNode.removeChild(this.St),this.ord=this.IEd=null)}render(){const a=
String.format("{0}_EditingElement",this.tmb.id),b=String.format("{0}_WrappingDiv",a);this.IEd=document.createElement("div");this.St.id=b;this.St.style.height="0px";this.St.style.width="0px";this.St.style.display="none";Gb.App.instance.JRc&&Sys.UI.DomElement.addCssClass(this.St,"NoPointer");this.ord=document.createElement("div");this.Bn.id=a;this.Bn.setAttribute("contenteditable",!this.Hna.p7d);this.Bn.setAttribute("spellcheck","false");n.a.Tia&&this.contentDocument.execCommand("AutoUrlDetect",!1,
!1);this.J0k();this.f_f();Sc.c(this.Bn,!0);Sc.c(this.St,!0);this.qza=document.createElement("div");this.St.appendChild(this.Bn);this.tmb.appendChild(this.St)}f_f(){if(this.Bn){const a=String.format("{0}_WACEditing_DescribedByElement",this.tmb.id),b=this.Hna.xYh;this.Hna.p7d?this.Bn.setAttribute("tabindex","0"):this.Bn.removeAttribute("tabindex");if(!this.JNh){const c=H.a.instance.ga(81)?Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage:Uc.a.XYi();this.Dqd=Uc.a.FEf(this.St,this.Bn,
a,c);this.FHe(b,c,null)}}}J0k(){n.a.xj?Sys.UI.DomElement.addCssClass(this.Bn,"InternetExplorer"):n.a.$f?Sys.UI.DomElement.addCssClass(this.Bn,"FireFox"):n.a.xsa&&Sys.UI.DomElement.addCssClass(this.Bn,"Safari");n.a.Ki?Sys.UI.DomElement.addCssClass(this.Bn,"iPad"):Sys.UI.DomElement.addCssClass(this.Bn,"usehover")}hsl(){this.Yxa&&(this.Yxa.gsl(this,this.lH),this.Yxa=null)}onBlur(a){this.Yxa.GBg(a);this.Yxa.PHf(a)}Uck(){this.St.style.width="0px";this.St.style.height="0px"}qte(a){a=a.htmlElement;this.St.parentNode!==
a.parentNode&&a.parentNode&&a.parentNode.insertBefore(this.St,a)}Fpl(a){if(a&&"DIV"===a.tagName){var b=a.childNodes;for(let c=0;c<b.length;c++)if("TBODY"===b[c].tagName||"TR"===b[c].tagName){for(b=a.ownerDocument.createElement("TABLE");a.hasChildNodes();)b.appendChild(a.firstChild);Ba.a.Xza(a);a.appendChild(b);break}}}}Object(e.a)(Od,"ContentEditableDiv",null,[1461,106]);class ug{create(a,b,c){return new Od(a,b,c)}}Object(e.a)(ug,"ContentEditableDomFactory",null,[1445]);var te=d(75);class mf{constructor(a,
b){this.qd=a;mf.jb=b}GRc(a){return Sys.UI.DomElement.containsCssClass(a,"PageBreakBlob")}JJi(a,b){a=Ba.a.Su(a);const c=Ma.a.CDa(a,b-1);return(b=a.substr(c+1,b-c-1))&&(Ma.a.J7(b)||Ma.a.v3b(b))?!0:!1}nYd(a,b,c){try{if(3===a.nodeType)return a.nodeValue}catch(l){return b.Tb("FailedToRetrieveText",{["Reason"]:"GetTextCrashed"}),c.o++,""}if("IMG"===a.tagName)return nb.hlg;if("BR"===a.tagName)return nb.$Hf;if(this.Itg(a)&&(u.AFrameworkApplication.mN("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),
mf.jb.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return"";let f="";for(let l=0;l<a.childNodes.length;l++)f+=this.nYd(a.childNodes[l],b,c);return f}Deg(a,b,c,f){try{if(3===a.nodeType){var l=a.nodeValue;l=a.nodeValue;return l.length}}catch(x){return Z.ULS.sendTraceTag(51463192,324,15,x.message),c.Tb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionRecursiveBadNode"}),b.bs++,-1}if(mf.BSc(a))return this.N5i(a);if(Sys.UI.DomElement.containsCssClass(a,"LineBreakBlob"))return 1;
l=0;"IMG"===a.tagName&&(l=f?l+1:l+3);if(this.Itg(a)&&(u.AFrameworkApplication.mN("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),mf.jb.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return 0;this.GRc(a)&&(l+=nb.FGc+nb.GRd);for(let x=0;x<a.childNodes.length;x++){const F=this.Deg(a.childNodes[x],b,c,f);if(0<=F)l+=F;else return a.innerText.length}return l}Itg(a){return void 0===a.parentNode||null===a.parentNode?!1:Sys.UI.DomElement.containsCssClass(a.parentNode,
"WACImageContainer")&&"SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,"WACAltTextDescribedBy")}eOj(a){return Sys.UI.DomElement.containsCssClass(a,mc.a.Uil)}N5i(a){return(a=a.querySelector(".RawEquation"))?parseInt(a.getAttribute("data-length")):te.AParagraphNode.cZ.length}YH(a,b,c,f){try{if(3===a.nodeType){let l=a.nodeValue;l=a.nodeValue;return l.length}}catch(l){return c.Tb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionBadNode"}),b.br++,0}return this.Deg(a,b,c,f)}n7f(a,
b,c,f,l){let x=0;const F=a.Is;for(let R=0;R<F.length;R++){a=F[R];const fa=this.YH(a,f,c,l);if(b<x+fa)return b-=x,c=a.innerText,b>=c.length?0:Ma.a.charCodeAt(c,b);x+=fa}f.bt++;return 0}w_d(a,b,c,f,l,x){if(void 0===a||null===a)return l.Tb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullElement"}),f.bi++,Z.ULS.sendTraceTag(51463193,324,15,"NoOffsetFromNullElement when trying to get position"),0;if(!b)return Z.ULS.sendTraceTag(18437279,324,15,"GetParagraphCpFromElementOffset found null ParagraphElement when trying to get position"),
0;let F=0;if(3===a.nodeType)F=c;else for(var R=0;R<c;R++)F+=this.YH(a.childNodes[R],f,l,x);for(;a!==b;){R=a;a=a.parentNode;if(!a){Z.ULS.sendTraceTag(51463195,324,15,"GetParagraphCpFromElementOffset found null parent when trying to get position");l.Tb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullParent"});f.bj++;if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordInvalidCaretPositionFixSettings"),u.AFrameworkApplication.fa.ka("InvalidCaretPositionFixIsEnabled")))return 0;
break}this.GRc(R)&&(F+=nb.FGc);let fa=0;for(;fa<a.childNodes.length&&a.childNodes[fa]!==R;)F+=this.YH(a.childNodes[fa],f,l,x),fa++;if(fa===a.childNodes.length)if(3===R.nodeType)F=c;else return l.Tb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromSelectionNotInDom"}),f.bk++,Z.ULS.sendTraceTag(51463196,324,15,"The current selection is in a non-text node that is not in the editing view's DOM."),0}return F}Bsg(a){return Ba.a.fYb(a)}static get instance(){mf.Ja||(mf.Ja=new mf(Cb.a.instance,u.AFrameworkApplication.fa));
return mf.Ja}static BSc(a){return Sys.UI.DomElement.containsCssClass(a,mc.a.ibk)||Sys.UI.DomElement.containsCssClass(a,mc.a.xMi)||Sys.UI.DomElement.containsCssClass(a,mc.a.jJi)}}mf.Ja=null;mf.jb=null;Object(e.a)(mf,"ContentEditableViewDomUtils",null,[1442]);class Yf{constructor(a,b){this.otd=null;this.jd=a;this.vk=b}dld(){return 1<this.Y1i()||this.Nig(this.otd,this.Y8f())}jic(){const a=this.Y8f();this.otd=a?a.cloneNode(!0):null}Y1i(){if(this.jd){const a=this.jd.Tl();if(a&&a.childNodes)return a.childNodes.length}return 0}Y8f(){if(this.jd){const a=
this.jd.Tl();if(a)return a.firstChild}return null}Nig(a,b){if(!a&&!b)return!1;if(!a||!b)return!0;try{return this.tqj(a,b)}catch(c){return Z.ULS.sendTraceTag(17134560,324,15,"HasDifferentHtmlStructure ex: {0}",c),!0}}tqj(a,b){if(Ma.a.sg(a.nodeName)!==Ma.a.sg(b.nodeName))return!0;if(a.childNodes.length!==b.childNodes.length&&(!n.a.$f||a.childNodes.length!==b.childNodes.length-1||"BR"!==Ma.a.cB(b.childNodes[b.childNodes.length-1].nodeName))){var c=!a.childNodes.length||3===a.childNodes[0].nodeType;for(var f=
0;c&&f<b.childNodes.length;f++)c=3===b.childNodes[f].nodeType&&c;if(c)return!1;c=b.childNodes.length;for(f=0;f<b.childNodes.length;f++)3!==b.childNodes[f].nodeType||b.childNodes[f].nodeValue.length||c--;return c!==a.childNodes.length}for(c=0;c<a.childNodes.length;c++)if((!mf.BSc(a.childNodes[c])||!mf.BSc(b.childNodes[c]))&&this.Nig(a.childNodes[c],b.childNodes[c]))return!0;return!1}uSi(a,b){if(n.a.eI&&H.a.instance.ga(98)){b.Tb("PossiblyIncorrectTypedText",{["Reason"]:"FixEOPSpanforAndroidChrome"});
b=Ba.a.uba(this.otd,"EOP");const c=Ba.a.uba(a.firstChild,"EOP");b&&!c&&a.firstChild&&a.firstChild.appendChild(b.cloneNode(!0))}}}Object(e.a)(Yf,"ContentEditableHtmlStructureUtils",null,[]);class Jd{constructor(){this.uQh=u.AFrameworkApplication.fa.ka("MoveToIpModeInReadOnlyView")}get mode(){return u.AFrameworkApplication.Ta.mode}get y5c(){return this.uQh}get Xoh(){return this.y5c?!0:1!==u.AFrameworkApplication.Ta.mode||Gb.App.cvb&&u.AFrameworkApplication.CS}get xYh(){switch(this.mode){case 3:return Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage;
case 2:return Box4Intl.Box4Strings.l_ReviewingSurfaceScreenReaderTitleMessage}return Box4Intl.Box4Strings.l_ReadingSurfaceScreenReaderTitleMessage}get p7d(){return this.y5c?1===u.AFrameworkApplication.Ta.mode||Gb.App.cvb&&u.AFrameworkApplication.CS:Gb.App.cvb&&u.AFrameworkApplication.CS?!(Gb.App.xUb||Gb.App.w4b):1===u.AFrameworkApplication.Ta.mode}get Ogd(){return this.y5c?1===u.AFrameworkApplication.Ta.mode||Gb.App.cvb&&u.AFrameworkApplication.CS:Gb.App.cvb&&u.AFrameworkApplication.CS}}Object(e.a)(Jd,
"ContentEditableModeHelper",null,[1389]);var ce=d(186),fe=d(33);class Gg{static cvi(a){const b={};for(let c of a)a=0,c in b&&(a=b[c]),b[c]=a+1;return fe.c(b)}}Object(e.a)(Gg,"CommonActivityAggregationMethods",null,[]);var Me=d(985),se=d(996),Pf=d(564),yg=d(283),qe=d(264),yd=d(89);class zf{constructor(){this.yJd=this.GBg=this.PHf=this.eHc=this.iea=this.hse=this.jcb=this.BFb=this.yXa=this.bHd=this.pQe=this.qQe=this.zB=this.M4a=this.bD=this.OXb=this.$Nd=this.fQd=this.Axe=this.RXb=this.TAa=this.UAa=this.Wgb=
this.GVb=this.oNd=this.HVb=this.Z8a=this.zDa=this.Az=null;this.L5=this.Znd=this.brd=this.UAd=this.Ntd=this.kDd=this.Tpd=!1}VLi(a,b){if(!this.L5){this.L5=!0;var c=Pf.a.instance,f=b.FF,l=b.VQ,x=b.bhb,F=b.Xx,R=yg.a.instance,fa=b.Qea,wa=qe.a.instance,Xa=b.Bjd,lb=b.yjd;n.a.Ki&&(bd.EventHandlerManager.instance.GLk(this.bHd),this.Znd=!0);b.Lga(this.iea);this.NKk(a.Bn,f,l,F,x,wa,fa,R,c,Xa,lb)}}gsl(a,b){if(this.L5){var c=Pf.a.instance,f=b.FF,l=b.VQ,x=b.bhb,F=b.Xx,R=yg.a.instance,fa=b.Qea,wa=qe.a.instance,
Xa=b.Bjd,lb=b.yjd;this.Znd&&(bd.EventHandlerManager.instance.ksl(this.bHd),this.Znd=!1);b.$Wa(this.iea);this.dsl(a.Bn,f,l,F,x,wa,fa,R,c,Xa,lb);this.L5=!1}}NKk(a,b,c,f,l,x,F,R,fa,wa,Xa){b.kp(a);c.kp(a);f.kp(a);l.kp(a);x.kp(a);yd.a.addHandler(a,qa.a.paste,this.Axe);yd.a.addHandler(a,qa.a.cut,this.fQd);yd.a.addHandler(a,qa.a.copy,this.$Nd);!zf.NLj&&n.a.$f&&(yd.a.addHandler(a,qa.a.bSd,this.OXb),this.brd=!0);yd.a.addHandler(a,qa.a.blur,this.yJd);f.ob(qa.a.click,a,this.bD);2===Gb.App.mode?F.ZI(a,this.eHc,
!0):F.ZI(a,this.eHc);R.ob(a,this.zB);l.ob(qa.a.j5,a,this.qQe);l.ob(qa.a.p0,a,this.pQe);c.ob(qa.a.mouseDown,a,this.jcb,null);c.ob(qa.a.WW,a,this.hse,null);b.ob(qa.a.ol,a,this.zDa);b.ob(qa.a.Cx,a,this.Z8a);b.ob(qa.a.eg,a,this.Az);b.ob(qa.a.jNa,a,this.Az);f.ob(qa.a.doubleClick,a,this.M4a);yd.a.addHandler(a,qa.a.scroll,this.yXa);if(n.a.XNe||n.a.$f)Xa.ob(qa.a.tPf,a,this.HVb,this),Xa.ob(qa.a.nNd,a,this.oNd,this),Xa.ob(qa.a.lNd,a,this.GVb,this),this.Tpd=!0;Gb.App.HJd&&n.a.Qth||n.a.$n?(wa.ob(qa.a.input,a,
this.Wgb,this),this.Ntd=!0):n.a.aOe&&(wa.ob(qa.a.pPe,a,this.Wgb,this),this.kDd=!0);fa.ob(qa.a.drop,a,this.UAa);n.a.psa&&(fa.ob(qa.a.N4a,a,this.TAa),fa.ob(qa.a.ZXf,a,this.RXb),this.UAd=!0);fa.ob(qa.a.AFb,a,this.BFb)}dsl(a,b,c,f,l,x,F,R,fa,wa,Xa){yd.a.removeHandler(a,qa.a.paste,this.Axe);yd.a.removeHandler(a,qa.a.cut,this.fQd);yd.a.removeHandler(a,qa.a.copy,this.$Nd);this.brd&&(yd.a.removeHandler(a,qa.a.bSd,this.OXb),this.brd=!1);yd.a.removeHandler(a,qa.a.blur,this.yJd);f.xb(qa.a.click,a,this.bD);F.hE(a,
this.eHc);R.xb(a,this.zB);l.xb(qa.a.j5,a,this.qQe);l.xb(qa.a.p0,a,this.pQe);c.xb(qa.a.mouseDown,a,this.jcb);c.xb(qa.a.WW,a,this.hse);b.Iq(a);c.Iq(a);f.Iq(a);l.Iq(a);x.Iq(a);b.xb(qa.a.ol,a,this.zDa);b.xb(qa.a.Cx,a,this.Z8a);b.xb(qa.a.eg,a,this.Az);b.xb(qa.a.jNa,a,this.Az);f.xb(qa.a.doubleClick,a,this.M4a);yd.a.removeHandler(a,qa.a.scroll,this.yXa);this.Tpd&&(Xa.xb(qa.a.tPf,a,this.HVb),Xa.xb(qa.a.nNd,a,this.oNd),Xa.xb(qa.a.lNd,a,this.GVb),this.Tpd=!1);this.kDd&&(wa.xb(qa.a.pPe,a,this.Wgb),this.kDd=
!1);this.Ntd&&(wa.xb(qa.a.input,a,this.Wgb),this.Ntd=!1);fa.xb(qa.a.drop,a,this.UAa);this.UAd&&(fa.xb(qa.a.N4a,a,this.TAa),fa.xb(qa.a.ZXf,a,this.RXb),this.UAd=!1);fa.xb(qa.a.AFb,a,this.BFb)}static get NLj(){null==zf.bvd&&(zf.bvd=u.AFrameworkApplication.fa.ka("RemoveDomSubtreeModifiedEventHandlerIsEnabled"));return zf.bvd}}zf.bvd=null;Object(e.a)(zf,"ContentEditableSurfaceEventHandlers",null,[]);var xd=d(58),fg=d(116),Ki=d(815),jg=d(134),Ch=d(271);class ih extends se.a{constructor(a,b,c,f,l,x,F,R,
fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf,mh,Fg,ii,Li,wj,cj,dj){super(cj);this.Gvc=null;this.rHc=this.arb=this.iXb=this.OT=!1;this.Hf=a;this.Pc=b;this.wk=c;this.ht=F.create(this);this.Yib=Bg;this.jd=R;this.Hna=dj;x.xa(C.a.hWf,Fb.a.application,ce.ActionManager.Fg);x.xa(C.a.iWf,Fb.a.application,ce.ActionManager.Fg);f.execute(yi=>{yi.SCi(C.a.typing,kf.a.a4g);yi.HHe(C.a.typing,kf.a.source,Gg.cvi)});l&&l.execute(yi=>{yi.vDl(Object(D.a)(this,this.gva,"onZoomChanged"))});this.ap=wa;this.Ona=
Dc;this.tBd=Lb;this.zJ=Xa;this.OJ=kc;this.OJ.init(this.Ma);this.W0=lc;this.jf=Ec;this.vk=lb;this.Lb=fa;this.Lb.init(this.Ma);this.sh=Wd;this.e1a=xe;this.ks=Jc;this.OLa=Sd;this.nH=Ef;this.Ir=Pe;this.nB=dg;this.WKa=Ue;this.JU=Mg;this.hJh=Lf;this.iJh=mh;this.BKh=Fg;this.gJh=ii;this.Qfa=Li;this.fJh=wj;this.Qfa.n3h(Object(D.a)(this,this.VWg,"onBindEditingDom"));this.Qfa.G3h(Object(D.a)(this,this.b1g,"onUnbindEditingDom"));this.Qfa.W2h(Object(D.a)(this,this.Q7g,"pushViewElementValidationStates"));this.Qfa.V2h(Object(D.a)(this,
this.WYg,"onInteractiveViewOnAfterLoadContent"));this.IXe=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ChromiumEdgeUIPasteForPPTIsEnabled")&&n.a.jRc;this.z0e=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")&&n.a.yS}get Cd(){return this.Df.Cd}dispose(){this.Qfa.iPk(Object(D.a)(this,this.VWg,"onBindEditingDom"));this.Qfa.uPk(Object(D.a)(this,this.b1g,"onUnbindEditingDom"));this.Qfa.bPk(Object(D.a)(this,this.Q7g,"pushViewElementValidationStates"));
this.Qfa.aPk(Object(D.a)(this,this.WYg,"onInteractiveViewOnAfterLoadContent"));this.gJh.dispose();super.dispose()}gva(){this.yea=!0}get ownerDocument(){const a=this.jd.JBa();return a?a.zl:null}get container(){return this.KOa}get FNd(){return this.Bn}createElement(a){a=this.ownerDocument.createElement(a);this.jd.ug.qEh.appendChild(a);return a}Oo(a){a=Jb.a.createElement(this.ownerDocument,a);this.jd.ug.qEh.appendChild(a);return a}Pza(){throw Error.notImplemented("BindToContainer doesnt mean anything for ContentEditableView yet--we shouldn't be calling it!");
}bue(){this.ap.raiseEvent(Ae.a.nJi);this.rHc=!0}get KOa(){return this.jd.ug?this.jd.ug.St:null}get Bn(){return this.jd.Tl()}get Aub(){return!0}bni(){this.W0.aDc()}get sTc(){return this.Ir.rDa}get isComposing(){return this.Ir.isComposing}rzk(){this.IXe||this.z0e?this.OLa.$5g(!0,""):(this.disable(!1,24),this.hfd(!0),n.a.Kw&&(this.KOa.style.overflow="hidden"),this.KOa.style.width="0px",this.KOa.style.height="0px",this.KOa.style.display="block",this.ap.raiseEvent(Ae.a.Ktk),this.W0.aDc(),this.OJ.RHa(this.sh.mode,
this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy))}xkl(){this.IXe||this.z0e?this.OLa.Tfh("none"):n.a.Kw&&this.KOa&&(this.KOa.style.overflow="none")}hs(a,b=!1){this.nH.hs(a,b)}OX(){this.ks.OX()}get Bl(){return!0}axa(a,b){if(1===this.mode&&17!==a.mi){const c=a.currentNode;if(!ld.a.instance.Oa.xG&&!c.Yub(ld.a.instance.Oa.xr)&&6!==a.role)return!1}return super.axa(a,b)}get dI(){let a=super.dI;switch(this.mode){case 2:a|=450;break;case 1:a|=448;break;case 0:a|=511}return a}get Fpb(){const a=
u.AFrameworkApplication.fa.ka("EditingViewDelayUpdateFixIsEnabled");return a&&!this.sTc?2:this.root&&this.ownerDocument&&this.isActive&&!this.Ona.R7?a||this.sTc?1:2:3}k4(a){return this.iJh.k4(a)}A9(a){return this.hJh.A9(a)}EPd(){return new Ki.a(this.Ma)}iue(a){!u.AFrameworkApplication.Xg&&0!==this.mode&&this.Df&&this.Df.Ro&&(this.fWj(a),this.Pc.N6d())}fWj(a){if(a){var b=a.lA;a=this.i6f(a.tu,!0);b=this.i6f(b,!1);Z.ULS.sendTraceTag(38396191,324,50,"Parent : [{0}] Child : [{1}]",a,b)}}i6f(a,b){let c=
"";a&&(a=a.node)&&(c+="nodeId : "+a.id+"; type : "+a.type+"; ",Ya.ParagraphReader.Wd(a)&&(c+="paraId : "+Ya.ParagraphReader.P_b(a)+"; ",c+="hasImage : "+fg.a(a,5)+";"),b&&(b=mb.GraphIterator.mb(a),b.Ze(),c+="inTable : "+xd.TableReader.Sr(b)+";"));return c}vve(a){!u.AFrameworkApplication.Xg&&1===this.mode&&a&1&&this.Df&&this.Df.Ro&&this.Pc.gwe()}hfd(a){this.jd.NXa(a)}d9a(a,b,c){this.Yib.d9a(a,b,c)}PHc(){this.WKa.PHc()}Z4k(){this.tBd.c1f(ld.a.instance.Oa)}afb(){this.OJ.afb(this.mode,this.Lb.Di,this.Lb.xg,
this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy)}RHa(){this.OJ.RHa(this.mode,this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy)}get xg(){return this.isActive?this.Lb.xg:null}get mode(){return this.sh.mode}get isActive(){return this.jf.isActive}get zRa(){return this.jf.F_b(this.Lb.xg)}get B$d(){return this.jf.J$f(this.Lb.xg)}get Df(){return this.Hf.Ld}get Twe(){return this.e1a.oQf}get pwa(){return this.WKa.pwa}set pwa(a){this.WKa.pwa=a}get yea(){return this.ks.yea}set yea(a){this.ks.yea=
a}get k8d(){return!0}get hEe(){return 2}get Ogd(){const a=this.wk.value.isEditingAllowed||this.wk.value.vy;return this.Hna.Ogd?a:!0}get SGa(){return this.OLa.SGa}get hpb(){return this.vk}get jrl(){return this.nB}get gti(){return this.Yib}get Euj(){return this.WKa}get Drk(){return this.JU}K5b(a){return Ch.a.aAg(a,this)}HEb(a){return Ch.a.Sdh(a,this)}Zhc(a){return Ch.a.feh(a,this)}Lbc(a){return Ch.a.zSg(a,this)}mob(a){return Ch.a.EKf(a,this)}ajc(a){return Ch.a.ajh(a,this)}uZb(a){return Ch.a.Y3f(a,this)}GTb(a){return Ch.a.aHf(a,
this)}$Ej(){switch(this.mode){case 2:if(this.Lb.xg)return this.aFj(this.Lb.xg)}return!1}aFj(a){a=jg.a.mb(this.Ma,a.node);return a.Gq&&a.Ze()?a.lOa.C_(510&~this.dI):!0}VWg(a,b){this.FHf(b.ug)}b1g(){this.jd.vrl()}dxj(a,b,c,f){a=this.fJh.create(a,b,this.Hna);b=new zf;b.eHc=c;this.BKh.Zvk(b);a.initialize(b,f);return a}FHf(a){this.jd.Fbi(a,this)}disable(a,b){this.sh.V9(0,a,b)}NYa(){this.sh.NYa()}suspend(){this.Ona.suspend()}resume(){this.Ona.resume()}Q7g(a,b){this.Hf.Ld===b.Df&&(this.Gvc=this.EJa,this.EJa=
new Me.a(0))}Qvk(){const a=this.Gvc,b=this.EJa;for(let c=0;c<b.keys.length;++c){const f=b.keys.ga(c);let l;a.$(l=f,a.ga(l)|b.ga(f))}this.EJa=a;this.Gvc=null}GNf(){this.Gvc=null}aLe(a){return 1!==this.mode||a.Rx||this.Df.Eb.Oa.xG?!1:!0}xae(a,b){return this.Df.Eb&&!this.Df.Eb.Oa.xG&&b?a.Rx!==b.X$d:!0}WYg(a,b){this.Hf.Ld===b.Df?this.Qvk():this.Hf.Ld||this.GNf()}}Object(e.a)(ih,"ContentEditableView",se.a,[390,202,106,1444]);class qh{constructor(a,b,c,f,l,x){this.hd=a;this.Xf=b;this.$i=c;this.Io=f;this.Hf=
l;this.Zq=x}Org(a){return Sys.UI.DomElement.containsCssClass(a,mc.a.aQf)}}Object(e.a)(qh,"ContentEditableViewContentControlHelper",null,[1388]);var Md=d(388),Ed=d(126),Bd=d(115),Xh=d(816);class $f{constructor(a,b,c,f,l){this.EVb=!1;this.Wwe=this.T8c=-1;this.JE=a;this.E6d=b;this.nBc=c;this.yQa=f;this.pWa=l}}Object(e.a)($f,"ActiveContentSpan",null,[]);class Vi{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue){this.Dfa=this.YLb=null;this.V7=!1;this.svf=0;this.pqd=Sd;this.Hf=a;
this.hd=b;this.Xf=c;this.$i=f;this.Pc=l;this.$e=x;this.CJ=F;this.sh=R;this.Lb=fa;this.wk=wa;this.una=Xa;this.jf=lb;this.Rd=Lb;this.qd=kc;this.Pi=lc;this.Io=Ec;this.zh=Jc;this.zJ=Dc;this.jd=Wd;this.GC=xe;this.dA=Ue}get rba(){return this.Dfa||(this.Dfa=hb.a.instance.pb("Box4.IFormatPainter"))}Gbi(a){this.YLb=a}get Csh(){return this.svf}xCi(a,b,c){const f=this.Hf.Ld;if(!f)return!1;f.bve();if(2!==this.sh.mode)return this.hd.Tb("PossibleFocusWeirdness",{["Reason"]:"ClickOnHiddenEditingFrame"}),this.Xf.be++,
!1;if(this.$i&&b)return this.hd.Tb("DisallowedClickDuringDictation",{["Reason"]:"CursorPositioningClick"}),this.Xf.bf++,!0;if(3!==a.Vf&&a.Sz===Sys.UI.MouseButton.rightButton&&this.qd.$f)return Gb.App.Fb.g$.eSi(a.lc.rawEvent),!0;if(!f)return!1;b=f.Xha(a);if(3===a.Vf){var l=this.Pc.Oa.kb;if(this.$e.Jw(l)){var x=l.Ua.node.Ag(f.Ma);l=this.dA?this.dA.RNa(l.Ua,!0):l.Ua.Qa;x=P.a.OY(l,x,!!l,!1,!1);x=new Sys.UI.Bounds(x.x-7,x.y,14,x.height);if(Md.a.S9c(b,x))return Gb.App.Fb.Q4(b,3),!0}}if(!c)return!0;this.Pi.XUf(this.sh,
this.Lb);v.FocusManager.XL()&&(v.FocusManager.instance().Bf(f.RH),this.zJ.setFocus(this.sh.mode,this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy));(c=Sc.a(a.Fc))?(this.YLb.hs(!0),f.m5(a.clientPoint,c,c.$a,f,a.lc.rawEvent.shiftKey,a.UY,a.Vf)):f.m5(b,null,null,f,a.shiftKey,a.UY,a.Vf);this.rba&&this.rba.yK&&this.una.processAction(C.a.Sha,2);this.YLb.d9a(a.shiftKey,b,a.Vf);f.zue(new Xh.a(a));this.qd.eI&&(a=new He.a(0,1,0,()=>{this.jf.dIa(!0);this.fixupAfterCursor(5)},
27),this.Rd.Gb(a));return!0}sOe(a,b=!1){if(2===this.sh.mode&&this.Lb.Nh){var c=this.jd.ug.St;if("0px"!==c.style.height&&"0px"!==c.style.width||!this.qd.u$d){c=this.Pc.Oa.kb;var f=!!this.CJ&&this.CJ.C7a();this.$i&&a?(this.hd.Tb("MomentaryIncorrectIpPosition",{["Reason"]:"NoSynchronizeCursorDuringDictation"}),this.Xf.bm++):(this.m1k(b||f,this.Lb.Nh.Is,this.Pc.Oa.kb.Ua),f&&this.CJ.KOe(c))}}}m1k(a,b,c){let f=0,l=0;c=c.Qa;let x=!1;for(let F=0;F<b.length;F++){const R=b[F],fa=this.Io.YH(R,this.Xf,this.hd,
this.$i);if(Sys.UI.DomElement.containsCssClass(R,aa.a.YU))f+=fa;else if(x||(this.svf=f,x=!0),Sys.UI.DomElement.containsCssClass(R,mc.a.yM))c--,f+=fa,l++;else{if(c<=fa){a||this.Pi.fS(f+c,this.Lb.Nh);this.Zed(b,F,f,l,c);break}c-=fa;f+=fa;l+=fa}}}fixupAfterCursor(){if(2===this.sh.mode){var a=this.Pi.d7(this.sh.mode,this.Lb.Di),b=0,c=0,f=this.Lb.Nh.Is,l;for(l=0;l<f.length;l++){const x=this.Io.YH(f[l],this.Xf,this.hd,this.$i);let F,R,fa;({I2:F,Pia:fa,jub:R}=this.uki(f,l));if(a<=x&&this.ISi(f,l,a,F,fa,
b,c,R))return;a-=x;b+=x;F?c++:R||(c+=x)}this.hd.Tb("ActiveContentSpansOutOfSync",{["Reason"]:"FixupAfterCursorFailed"});this.Xf.bq++}}ISi(a,b,c,f,l,x,F,R){const fa=a[b],wa=this.Io.YH(fa,this.Xf,this.hd,this.$i);if(f||this.$i&&l)if(l||!this.V7&&c!==wa){if(this.Xf.bo++,this.Pi.fS(x,this.Lb.Nh),c=this.Io.YH(a[b-1],this.Xf,this.hd,this.$i),this.Zed(a,b-1,x-c,F-c,c),l)return!0}else this.Xf.bn++,this.Pi.fS(x+wa,this.Lb.Nh),this.Zed(a,b+1,x+wa,F+1,0);else if(!R)return Ma.a.Mw(Ba.a.Su(fa),c)&&(this.Xf.bp++,
this.Pi.fS(x+c+(this.V7?1:-1),this.Lb.Nh)),this.Zed(a,b,x,F,c),!0;return!1}uki(a,b){let c,f;c=Sys.UI.DomElement.containsCssClass(a[b],mc.a.yM);f=Sys.UI.DomElement.containsCssClass(a[b],aa.a.YU);a=Sys.UI.DomElement.containsCssClass(a[b],mc.a.OM);return{I2:c,Pia:a,jub:f}}Zed(a,b,c,f,l){const x=this.Lb.lV,F=a[b];Sys.UI.DomElement.containsCssClass(F,mc.a.OM)&&(Z.ULS.shipAssertTag(4318915,315,!1),this.hd.Tb(Ed.a.v0,{["Reason"]:Bd.a.N_f}));Sys.UI.DomElement.containsCssClass(F,mc.a.yM)&&(Z.ULS.shipAssertTag(4318916,
315,!1),this.hd.Tb(Ed.a.v0,{["Reason"]:Bd.a.JHf}));a=this.yyi(a,b,c,f,l,x);b=a.length!==this.zh.yi.length;for(c=0;!b&&c<this.zh.yi.length;)this.zh.yi[c].JE!==a[c].JE&&(b=!0),this.zh.yi[c].pWa!==a[c].pWa&&(b=!0),c++;b&&(this.YLb.zRa&&this.YLb.hs(!0),this.zh.yi=a)}yyi(a,b,c,f,l,x){const F=a[b];var R=this.Io.YH(F,this.Xf,this.hd,this.$i);const fa=[];let wa=null;b<a.length-1&&l===R&&(wa=a[b+1]);var Xa=null;0<b&&!l&&(Xa=a[b-1]);a=this.pqd.re(F,aa.a.DDa);a=x.Is[a];Array.add(fa,new $f(F,a,c,f,R-(this.GC.a6?
1:0)));!wa||Sys.UI.DomElement.containsCssClass(wa,mc.a.OM)||Sys.UI.DomElement.containsCssClass(wa,mc.a.yM)?!Xa||Sys.UI.DomElement.containsCssClass(Xa,mc.a.OM)||Sys.UI.DomElement.containsCssClass(Xa,mc.a.yM)||Sys.UI.DomElement.containsCssClass(Xa,aa.a.YU)||(a=this.pqd.re(Xa,aa.a.DDa),a=x.Is[a],R=this.Io.YH(Xa,this.Xf,this.hd,this.$i),Array.insert(fa,0,new $f(Xa,a,c-R,f-R,R))):(a=this.pqd.re(wa,aa.a.DDa),a=x.Is[a],Xa=this.Io.YH(wa,this.Xf,this.hd,this.$i),Array.add(fa,new $f(wa,a,c+R,f+R,Xa)));return fa}}
Object(e.a)(Vi,"ContentEditableViewCursorManager",null,[1443]);class ci{}Object(e.a)(ci,"ContentEditableViewDebugLogger",null,[]);class Bi{constructor(a,b,c,f,l,x,F){this.poa=a;this.nB=b;this.zh=c;this.$qc=f;this.Xf=l;this.G$=x;this.sh=F}dispose(){this.poa.rNf();this.nB.dispose();this.zh.dNf();this.$qc.Med();eg.a.instance.eVj(this.Xf);this.G$.raiseEvent(Ji.a.zWj);this.sh.dispose()}}Object(e.a)(Bi,"ContentEditableViewDisposer",null,[]);class bh{constructor(){this.BGc=!0}d9a(a,b,c){a&&(this.BGc=!1,
Gb.App.Fb.Q4(b,c))}}Object(e.a)(bh,"ContentEditableViewFloatieHandler",null,[1440]);var Wg=d(1070),jf=d(142);class kg{constructor(a,b,c,f,l,x,F){this.Jbf=0;this.vSc=this.t2b=this.V4d=this.Z4d=!1;this.jd=a;this.Hf=b;this.CJ=c;this.$i=f;this.tn=l;this.Rod=x;this.Hd=F}$bi(){this.$i&&!this.t2b&&100<(new Date).getTime()-this.Jbf&&(jf.GrippersManager.instance.R1b=!0,this.vSc=!1)}setFocus(a,b,c,f,l){const x=this.Hf.Ld;this.Jbf=(new Date).getTime();this.CJ&&this.CJ.C7a()||(1===a?this.b2k(l):this.$i&&!this.tn.a5d&&
bd.EventHandlerManager.instance.Y_f!==qa.a.click||!this.jd.ug.Zfb||(l=new Wg.a(x),this.jd.ug.zkd(),this.$i&&(this.t2b=!0,this.jd.Tl().blur(),this.t2b=!1),this.jd.ug.Xxh(),c&&f&&""!==b.innerText&&b.focus(),this.Rod.N7&&(this.vSc=!0),l&&l.dispose(),this.Rod.xj&&0!==a&&(this.jd.ug.Zfb=!1)))}b2k(a){if(!this.$i||a){a=null;n.a.xj&&(a=new Wg.a(this.Hf.Ld));this.jd.ug.Zfb&&(this.jd.ug.zkd(),this.jd.ug.Xxh(),n.a.xj&&(this.jd.ug.Zfb=!1),this.Rod.N7&&this.tn.a5d&&(this.vSc=!0));var b=this.jd.Tl();this.jd.ug.Zfb&&
b.firstChild&&3!==b.firstChild.nodeType&&b.firstChild.focus();a&&a.dispose()}}iLi(a){2!==a&&1!==a||this.jd.ug.zkd()}H8d(){const a=this.Hd.ye;return!!a&&this.Hf.Ld.RH===a.name}}Object(e.a)(kg,"ContentEditableViewFocusHelper",null,[1441]);class vh{constructor(a,b,c){this.c2b=a;this.Edb=b;this.Kpa=c}}Object(e.a)(vh,"GraphUpdateState",null,[]);var nd=d(50),Oe=d(112);class ti{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf,mh,Fg,ii){this.Pe=this.FLb=null;this.jk=
Fg;this.Zq=mh;this.wfa=a;this.sh=b;this.hd=c;this.Pc=f;this.CJ=l;this.$e=x;this.jf=F;this.FJ=R;this.Lb=fa;this.vk=wa;this.GC=Xa;this.zh=lb;this.jd=Lb;this.rU=kc;this.dR=lc;this.Ona=Ec;this.kY=Jc;this.nga=Wd;this.Pi=xe;this.e1a=Sd;this.ks=Pe;this.Xf=Ue;this.M5=Ef;this.Rd=dg;this.qd=Mg;this.Ofa=Bg;this.CGh=Lf;this.Vg=Dc;this.gz=ii}PR(a){this.Pe=a}get fOc(){const a=this.kY.ira(this.rU.V7);return a?a.Ua.Qa:0}get Gci(){return this.fOc}hs(a,b=!1){Z.ULS.shipAssertTag(18437283,315,!!this.Vg);if(this.Pe.zRa||
this.Pe.B$d)if(this.Pe.jrl.typingProcess(),this.Pe.isActive&&2===this.sh.mode&&(this.Pe.zRa||this.Pe.B$d)){var c=this.hd.Bp(C.a.hs);this.wfa.wF(()=>{this.sul(a,b)},"ContentEditableView:UpdateGraphInternal");c.end()}}n2k(a,b=!1){const c=this.$e.Vy;this.Pc.setSelection(a,void 0,void 0,b);this.$e.Vy=c}sul(a,b=!1){Oe.c(36226527,306,100,"UpdateGraphInternalCalled");this.jf.qTk();if(this.Lb.Nh){a=new vh(!1,a,!1);a.Edb&&this.Ona.suspend();this.nga.fixupAfterMagnifierDrag();var c=this.FJ.XPa();c.set(this.Lb.xg.node);
var f=this.jk.je(b?12:15,C.a.hs);f.$c=this.vk.A1?C.a.Oza:C.a.typing;f.Tx(c);this.GC.Y9k(a.Edb,this.Pe.sTc,this.zh)&&(this.Xf.v++,this.GC.Cfb(!1,this.Lb.Di,this.zh));var l=!!this.CJ&&this.CJ.C7a(),x=l?ld.a.instance.Oa.kb:this.gmi();this.Quk(a);this.rvl();this.rerenderWhenNeeded(b,a,c);l||this.TSi(b,x);this.zh.dNf();f.dispose();this.Til(a);this.ks.yea&&(this.ks.OX(),this.ks.yea=!1);a.Edb&&this.Ona.resume();this.vk.C4();Oe.c(18437313,306,100,"UpdateGraphInternalExited")}else Z.ULS.shipAssertTag(17884510,
315,!1,"CurrentEditingViewElement is NULL. Bail out updateGraph early!")}Til(a){a.c2b||this.rU.sOe(this.vk.$ba,a.Kpa)}rerenderWhenNeeded(a,b,c){!b.c2b||this.vk.Oxg()||a||(this.sh.V9(0,!0,5),b.Edb&&(this.Ona.resume(),b.Edb=!1),this.U2b(c.currentNode))}gmi(){this.Pi.updateCaretPosition(this.sh.mode,this.Lb.Di);this.e1a.VSe();this.dR.uSi(this.jd.Tl(),this.hd);return this.kY.ira(this.rU.V7)}TSi(a,b){const c=this.Zq.textLength(b.Ua.node);b.Ua.Qa>c&&(b=nd.SelectionFactory.Jg(b.Ua.node,c));this.n2k(b,a);
a=!!this.CJ&&this.CJ.wub(b);this.vk.Oxg()&&!a&&this.Pi.fS(this.Pi.vSa,this.Lb.Nh)}U2b(a){H.a.instance.ga(70)&&Gb.App.WQ.U2b(a)}rvl(){if(H.a.instance.ga(2)){const a=Yb.OutlineElementNavigator.rA(this.Pe.xg);a&&Ib.ListReader.LRa(a)}}IQd(){if(this.Pe.zRa||this.Pe.B$d)this.FLb?this.Rd.B4(this.FLb,ti.YUf):(this.FLb=new He.a(0,1,ti.YUf,Object(D.a)(this,this.delayUpdateGraphCallback,"delayUpdateGraphCallback"),26),this.Rd.Gb(this.FLb))}delayUpdateGraphCallback(){this.FLb=null;this.Lb.rSa(this.sh.mode)&&
this.hs(!0)}xOk(){let a;if(this.vk.A1){var b=this.fOc;a=this.vk.xEc}else if(this.vk.lqa)b=this.fOc,a=b+(this.vk.vjd-Ba.a.Su(this.Lb.gOa).length);else return;if(b===a)this.hd.Tb("PossibleDropACharDeletion",{["Reason"]:"LostBrowserSelection"});else{Z.ULS.shipAssertTag(18437315,315,b<=a);var c=this.Zq.text(this.Pe.xg),f="";this.Zq.NPa(this.Pe.xg,a);if(!b&&a<c.length&&" "===c.charAt(a)||0<b&&a<c.length&&" "===c.charAt(b-1)&&" "===c.charAt(a))a+=1,f+=nb.HCb;this.Ymi(this.Pe.xg);b=Pc.a.createTextRange(this.Pe.xg,
b,a);this.Vg.replaceTextRange(b,f,void 0,void 0,C.a.iJd)}}Ymi(a){H.a.instance.ga(70)&&this.gz.YCc(a)}Quk(a){let b=!0;if(this.M5.mlg)this.M5.wKi();else{const c=1<this.jd.Tl().childNodes.length;a.c2b=this.dR.dld();if(a.c2b||this.vk.lqa||this.vk.A1){a.c2b&&this.Xf.w++;c&&(this.hd.Tb("PossibleValidTextDropped",{["Reason"]:"ExtraParagraphsFound"}),this.Xf.x++,b=!1);if(this.vk.A1||this.vk.lqa)this.xOk(),this.dR.jic(),b=!1;a.Edb&&(this.hd.Tb("PossibleImeAutoDetermine",{["Reason"]:"StopPreseveringBrowserState"}),
this.Xf.z++,this.Ona.resume(),a.Edb=!1);this.zh.fmi(this.Lb.Nh)}}a.Kpa=!0;b&&(a.Kpa=this.CGh.Puk(this.Lb.xg,this.Lb.Di,this.Lb.Nh,this.Vg,this.Ofa.instance))}}ti.YUf=250;Object(e.a)(ti,"ContentEditableViewGraphUpdater",null,[]);class Kh{constructor(){this.gal=this.ntg=!1;this.m3g=null}}Object(e.a)(Kh,"OnPastedFloatieStatusChangeEventArgs",null,[]);var Rd=d(56);class Bj{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf){this.Pe=null;this.dzg=0;this.Tcf=!1;this.Pa=
a;this.sh=b;this.Lb=c;this.Hf=f;this.jd=l;this.sfa=x;this.ks=F;this.GC=fa;this.qd=wa;this.Xf=Xa;this.Zq=lb;this.zh=Lb;this.dR=kc;this.lDd=lc;this.poa=Ec;this.zJ=Jc;this.e1a=Dc;this.Pc=Wd;this.$i=xe;this.OJ=Sd;this.wk=Pe;this.vk=Ue;this.ap=Ef;this.FJ=dg;this.tMa=Mg;this.soa=Bg;this.Xc=Lf}PR(a){this.Pe=a}ehk(a){this.Pa.raiseEvent(dd.eventId,new dd(a.WL,this.Pe.OT),this.Pe);if(1===this.sh.mode)return this.fhk(a);if(0===this.sh.mode||!this.Ytl(a))return!1;this.GC.sNf();if(this.Xtl())return!0;this.PSi();
this.poa.Osh(this.Lb.Nh);this.NSi();!this.Tcf&&this.Lb.Nh&&0<this.Lb.Nh.Mid&&(this.Tcf=!0,u.AFrameworkApplication.mN("Microsoft.Office.Web.SessionSettings.IWacWordEditorInlineTabsSettings"));this.Xc&&this.Xc.isFeatureEnabled(84)&&this.Zdh(this.Lb.Nh);this.e1a.VSe();this.soa.UBe(Object.assign(new Kh,{gal:!0}));this.Xc&&this.Xc.isFeatureEnabled(84)||this.Zdh(this.Lb.Nh);return!0}Zdh(a){a&&a.Mid&&(this.tMa?this.tMa.DDl(a,!0):Z.ULS.sendTraceTag(23708818,323,10,"TabRenderer is null."))}Ytl(a){if(!this.Lb.xg)return!1;
this.Lb.Nh=this.Lb.xg.oc(this.Pe.Ma);this.Lb.Nh||Z.ULS.sendTraceTag(18437322,324,15,"current editing view element is set to null!");this.Lb.lV=this.Lb.xg.oc(this.Hf.Ld.Ma);if(!this.Lb.lV)return!1;this.jd.ug.qte(this.Lb.lV);const b=this.jd.Tl(),c=this.Lb.gOa;(b?b.firstChild:null)!==c&&c&&(Ba.a.$t(b),b.appendChild(c));if(!a.WL&&!this.Pe.rHc){this.Pe.OT&&this.sfa.sOe(this.vk.$ba);this.Pe.OT=!1;if(this.ks.yea||!a.LGa)this.ks.OX(),this.ks.yea=!1;return!1}this.Pe.rHc&&(this.Pe.rHc=!1,this.Pe.arb=!0);return!0}NSi(){this.ks.OX();
if(this.Pe.arb){this.zJ.setFocus(this.sh.mode,this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy);if(this.qd.$f){const a=this.jd.Tl(),b=a?a.firstChild:null;b&&3===b.nodeType&&(this.Xf.bv++,a.removeChild(b))}this.Pe.arb=!1}this.sfa.sOe(this.vk.$ba)}PSi(){if(this.qd.$f){var a=this.jd.Tl();const b=a?a.firstChild:null;b&&"BR"===b.tagName&&(this.Xf.bu++,a.removeChild(b))}this.qd.QHb||(a=this.FJ.Kc(this.Lb.xg),this.Zq.isEmpty(a)&&!this.Zq.r8d(a)&&this.GC.Cfb(!0,this.Lb.Di,
this.zh));this.lDd.value.uVb(this.jd.Tl(),this.jd.contentWindow);this.dR.jic()}Xtl(){var a=this.Lb.lV;const b=this.jd.Tl().style;if(this.Pe.arb){if(!a)return!0;a=this.Lb.Nh.htmlElement;this.ks.wph()&&(b.position="absolute",b.width="100%");a.style.width="auto";a.style.height="auto"}this.Lb.Zaa=this.KJj();return!1}KJj(){return Rd.OutlineElementReader.Yl(Yb.OutlineElementNavigator.rA(this.Lb.xg.node))}Ru(a){return Vg.a.Ru(a)}fhk(a){if(!this.Pc.Oa||!this.Pc.Oa.kb)return Z.ULS.sendTraceTag(19711041,324,
15,"Attempt to validate selection with empty selection."),!1;if(!this.Pe.OT&&(!a.WL||Gb.App.l7d&&a.LGa))return this.ks.yea&&(this.ks.ruh(this.Pe.Ma),this.ks.yea=!1),!1;this.Pe.OT=!1;a=(new Date).getTime();const b=this.Pc.Xma;!this.$i&&!b.G9d&&!b.rae&&250<a-this.dzg?this.UUf(null):(this.ap.raiseEvent(Ae.a.nfk),b.y3k(Object(D.a)(this,this.UUf,"delayOnAfterValidateSelection")));return!0}UUf(){1===this.sh.mode&&(this.Pc.Oa.hca&&this.Lb.xg&&(this.Lb.Nh=this.Lb.xg.oc(this.Pe.Ma),this.Lb.Nh||Z.ULS.sendTraceTag(18437327,
324,15,"current editing view element is set to null!"),this.Lb.lV=this.Lb.xg.oc(this.Hf.Ld.Ma)),this.Pc.Oa.hca&&this.jd.Tl().firstChild!==this.Lb.gOa&&this.Lb.gOa&&(Ba.a.$t(this.jd.Tl()),this.jd.Tl().appendChild(this.Lb.gOa)),this.jd.Tl().firstChild&&(this.Pc.Oa.hca?this.jd.Tl().style.direction=this.Ru(this.jd.Tl().firstChild).direction:Sys.UI.DomElement.containsCssClass(this.jd.Tl().firstChild,"Rtl")?this.jd.Tl().style.direction="rtl":this.jd.Tl().style.direction="ltr",this.Pc.Oa.hca&&this.poa.Osh(this.Lb.Nh),
this.ks.ruh(this.Pe.Ma),this.OJ.afb(this.sh.mode,this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy)),this.dzg=(new Date).getTime(),this.ap.raiseEvent(Ae.a.cSi))}A9(a){const b=this.ehk(a);this.ap.raiseEvent(!a.WL||Gb.App.l7d&&a.LGa?Ae.a.bAc:Ae.a.K2g);return b}}Object(e.a)(Bj,"ContentEditableViewOnAfterValidateHandler",null,[]);class ui{constructor(a,b,c,f,l){this.Pe=null;this.ks=a;this.Ir=c;this.jd=f;this.ap=l}PR(a){this.Pe=a}k4(a){const b=this.Pe.Fpb;let c=3===b;c||
2!==b||(this.Pe.root.I4d(510),c=!0,this.ks.OX());if(c)return a.cancel=!0,!1;this.ap.eEk(a);return!1}}Object(e.a)(ui,"ContentEditableViewOnBeforeValidateHandler",null,[]);class Na{constructor(a,b,c,f,l){this.a6=!1;this.yya=null;this.ap=a;this.hd=b;this.Xf=c;this.jd=f;this.hrf=l}sNf(){this.a6=!1}Cfb(a,b,c){const f=this.jd.JBa();a&&(this.a6=Ba.a.Su(b)!==aa.a.GHc);if(a&&!this.a6){for(b=this.jd.Tl();b.firstChild;)b=b.firstChild,this.hrf&&Sys.UI.DomElement.containsCssClass(b,mc.a.$Ia)&&Sys.UI.DomElement.addCssClass(b,
mc.a.$we);3!==b.nodeType?(this.yya=f.zl.createTextNode(nb.HCb),b.appendChild(this.yya)):(this.yya=b,this.yya.nodeValue=nb.HCb);this.a6=!0;this.ap.L9g(!0)}if(!a&&this.a6){a=this.yya;b=null;try{b=this.yya.parentNode,b||""!==a.nodeValue||(this.yya=null)}catch(l){this.Xf.i++,this.yya=null}this.yya&&b!==f||(this.hd.Tb("PossibleExtraSpace",{["Reason"]:"LostPadding"}),this.Xf.j++,c.yi.length&&(a=this.S2f(c.yi[c.yi.length-1].JE)));if(a&&(a.nodeValue.endsWith(" ")||a.nodeValue.endsWith(nb.HCb))){if(this.hrf)for(c=
a;(c=c.parentNode)&&c.tagName&&"P"!==c.tagName.toUpperCase();)if(Sys.UI.DomElement.containsCssClass(c,mc.a.$we)){Sys.UI.DomElement.removeCssClass(c,mc.a.$we);break}c=a.nodeValue;a.nodeValue=c.substring(0,c.length-1)}this.a6=!1;this.ap.L9g(!1)}}Y9k(a,b,c){return!this.a6||a||(n.a.dF&&!n.a.Hj||n.a.aF)&&!b?!1:c.Tzf()}S2f(a){if(a.className===mc.a.OM)return null;var b=a.childNodes?a.childNodes.length:0;if(b)for(--b;0<=b;--b){const c=this.S2f(a.childNodes[b]);if(c)return c}else if("#text"===a.nodeName&&
(b=a.nodeValue,b.endsWith(" ")||b.endsWith(nb.HCb)))return a;return null}}Object(e.a)(Na,"ContentEditableViewPaddingManager",null,[1438]);class qb{constructor(a){this.NQd=this.qPe=this.lqa=this.A1=!1;this.YUc=this.vjd=this.xEc=-1;this.iud=!1;this.bbe=0;this.una=a}get $ba(){return this.iud}set $ba(a){a!==this.iud&&this.una.processAction(a?C.a.hWf:C.a.iWf,2);this.iud=a}Oxg(){return this.qPe||this.lqa||this.A1}C4(){this.NQd=this.qPe=this.lqa=this.A1=!1;this.YUc=this.vjd=this.xEc=-1}}Object(e.a)(qb,"ContentEditableViewTypingState",
null,[]);class wb{constructor(a,b,c,f,l,x,F){this.Pi=a;this.Xf=b;this.hd=c;this.Io=f;this.jf=l;this.Lb=x;this.$i=F}ira(a){if(!this.Lb.Nh||1===this.jf.mode&&!this.hca())return null;const b=this.Pi.d7(this.jf.mode,this.Lb.Di);let c=b,f=0;const l=this.Lb.Nh.Is;let x,F=!1;for(x=0;x<l.length;x++){var R=l[x];if(!this.Io.Bsg(R)){F=!0;continue}const fa=this.Io.YH(R,this.Xf,this.hd,this.$i),wa=Sys.UI.DomElement.containsCssClass(R,mc.a.yM);R=Sys.UI.DomElement.containsCssClass(R,aa.a.YU);if(c<=fa)return wa?
c=a||c===fa?1:0:R&&(c=0),this.Jg(this.Lb.xg,f,c);c-=fa;wa?f++:R||(f+=fa)}return F?this.Jg(this.Lb.xg,0,b):this.Jg(this.Lb.xg,0,0)}Jg(a,b,c){return nd.SelectionFactory.Jg(a,b+c)}hca(){return ld.a.instance.Oa.hca}}Object(e.a)(wb,"CurrentEditSelectionProvider",null,[1437]);class jc{constructor(a,b,c){this.jKb=[];this.Qyc=null;this.hd=a;this.CR=b;this.lDd=c}get yi(){return this.jKb}set yi(a){this.jKb=a}Tzf(){return this.jKb.length?1<this.jKb.length||1<this.jKb[0].JE.innerText.length:!1}T3f(a,b,c){const f=
L.a.re(a,aa.a.DDa),l=b?a.firstChild:a.lastChild;let x=null;b&&0<f?x=c.Is[f-1]:!b&&f<c.Is.length&&(x=c.Is[f+1]);if(x)for(this.hd.Tb("MomentaryNonLinkFormatting",{["Reason"]:"MoveSafariStrayTextNode"}),this.CR.u++,a.removeChild(l),b?x.appendChild(l):x.insertBefore(l,x.firstChild),a=0;a<this.yi.length;a++);}fmi(a){for(let b=0;b<this.yi.length;b++){const c=this.yi[b].JE;n.a.dF&&0<c.getElementsByTagName("A").length&&(3===c.firstChild.nodeType?this.T3f(c,!0,a):3===c.lastChild.nodeType&&this.T3f(c,!1,a));
Ba.a.ix(c,c.innerText)}}cfk(a){for(let b=0;b<this.yi.length;b++)this.lDd.uVb(this.yi[b].JE,a)}jNk(){for(let a=0;a<this.yi.length;++a){const b=this.yi[a].JE;if(Sys.UI.DomElement.containsCssClass(b,mc.a.tFc)||Sys.UI.DomElement.containsCssClass(b,mc.a.rFc)||Sys.UI.DomElement.containsCssClass(b,mc.a.qFc)||Sys.UI.DomElement.containsCssClass(b,mc.a.sFc)){const c=this.yi[a].pWa;c&&c!==b.innerText.length&&(b.className=mc.a.MWb)}}}Gak(a,b){for(let c=0;c<this.yi.length;c++){const f=this.yi[c],l=a<=f.yQa,x=
f.yQa+f.pWa,F=x<=b;f.T8c=l?f.yQa:a;f.Wwe=F?x:b;l&&F&&(f.EVb=!0)}}dNf(){Array.clear(this.yi)}}Object(e.a)(jc,"CurrentlyActiveContentSpans",null,[1433]);class Qc{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd){this.rqd=!1;this.$e=a;this.Pc=b;this.hd=c;this.jf=f;this.ap=l;this.Hf=x;this.zh=F;this.Lb=R;this.qd=fa;this.OJ=wa;this.wk=Xa;this.Hxa=lb;this.OKb=Lb;this.VJh=kc;this.ik=lc;this.jd=Ec;this.Ca=Dc;this.Wc=Wd;this.FNh=Jc.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.LNb=Jc.ka("PasteKeepSourceFontSizeFixIsEnabled");
this.Nsc=(this.sqf=Jc.ka("ProtectInClient"))||Jc.ka("ProtectedFile");this.PNh=Jc.ka("EnableExtractForProtectedFile");this.uOh=Jc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1);this.pNb=Jc?Jc.ka("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.YNb=Jc?Jc.ka("TextLayoutServiceUseResponse"):!1;this.isf=this.hsf=!1}get RY(){return this.Hxa.instance}get Q8a(){return this.Wc.Zf&&this.Wc.jy}Ogg(a,b,c,f){this.izk(a,b,c,f)}izk(a,b,c,f){if(this.uOh){if(this.Nsc&&!this.PNh){a.preventDefault();
return}}else if(this.sqf){a.preventDefault();return}!b||this.wk.value.isEditingAllowed||this.wk.value.vy&&this.Q8a?1!==this.jf.mode||this.rqd||!c||f||(this.RY?b&&!this.$e.zRc(this.Pc.Dj)?(Z.ULS.sendTraceTag(3994324,307,50,"Cut not allowed"),this.hd.Tb(Ed.a.ph,{["Reason"]:Bd.a.gQd}),this.OKb.show(),a.preventDefault()):(this.Pc.Xma.gWd(),this.rqd=!0,b&&this.ap.raiseEvent(Ae.a.DCi),n.a.osa&&a.rawEvent&&a.rawEvent.currentTarget&&(u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),
this.pNb&&this.ik.Rcd(a.rawEvent.currentTarget,"data-src","data-srcurl")),this.qd.Hj&&this.FNh&&this.DSi(a),this.LNb&&(this.hsf=this.ySi(a)),this.YNb&&(this.isf=this.TNk(a)),a=this.VJh.create(null,Object(D.a)(this,this.FGi,"dispatchCutCopy"),b),a.xl("Browser "+(b?"Cut":"Copied")),a.run()):(Z.ULS.sendTraceTag(3994323,307,50,"Clipboard command not available"),this.Ca.Ace(b?C.a.cut:C.a.copy),a.preventDefault())):a.preventDefault()}DSi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=
null;c=this.HYi();({EFc:c}=this.ik.kpl(c));c&&(a.preventDefault(),b.setData("text/html",Ca.c(c)),b.setData("text/plain",c.innerText))}}ySi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();if(c&&0<c.length)return a=this.ik.rWa(c),this.ik.HUb(a,this.Hf.Ld.Cd,!0)?(b.setData("text/html",a.innerHTML),!0):!1}return this.ik.HUb(a.rawEvent.currentTarget,this.Hf.Ld.Cd,!0)}TNk(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=
b.getData("text/html").toString();a=c&&0<c.length?this.ik.rWa(c):a.rawEvent.currentTarget;if(this.ik.yld(a,!1))return b.setData("text/html",Ca.c(a)),b.setData("text/plain",a.innerText),!0}return!1}HYi(){if(this.qd.dU){const a=this.jd.JBa();if(a&&a.zl)return a.zl.getSelection()}return null}FGi(a,b){this.rqd=!1;if(this.Hf.Ld.Ro&&1!==u.AFrameworkApplication.Aa.state){if(b){if(this.qd.$f){for(b=0;b<this.zh.yi.length;b++){const c=this.zh.yi[b].JE,f=c.getElementsByTagName("BR");for(let l=0;l<f.length;l++)c.removeChild(f[l])}this.OJ.RHa(this.jf.mode,
this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy)}this.RY.Hci(a)}else this.RY.Fci(a);n.a.osa&&this.pNb&&this.Hf&&this.ik.Rcd(this.Hf.Ld.ug.Bn,"data-srcurl","data-src");this.LNb&&this.hsf&&this.Hf&&this.Hf.Ld&&this.ik.HUb(this.Hf.Ld.ug.Bn,this.Hf.Ld.Cd,!1);this.YNb&&this.isf&&this.Hf&&this.Hf.Ld&&this.ik.yld(this.Hf.Ld.ug.Bn,!0)}}}Object(e.a)(Qc,"CutCopyHandler",null,[1432]);class Cd{constructor(a,b,c,f,l,x,F,R){this.qd=a;this.sh=b;this.Ir=c;this.hd=f;this.jf=l;this.Rfa=
x;this.ks=F;this.Nlb=R}OXb(a,b){this.qd.$f&&2===this.sh.mode&&b&&this.Ir.isComposing&&(a=this.hd.Bp(C.a.typing),a.properties.$(kf.a.source,"DomChange"),this.eIi(),a.end())}eIi(){this.Nlb||this.jf.X9(!0);this.Rfa.bBb();this.ks.OX()}}Object(e.a)(Cd,"DomChangeEventProcessor",null,[]);class Ld{constructor(a,b,c,f){this.Pi=a;this.sh=b;this.Lb=c;this.Hf=f}Jcb(a,b){if(!b)return!1;this.Pi.XUf(this.sh,this.Lb);return this.Hf.Ld?this.Hf.Ld.Jcb(a):!1}}Object(e.a)(Ld,"DoubleClickProcessor",null,[]);class ie{constructor(a,
b,c){this.qd=a;this.yjb=b;this.qrd=c}TAa(){this.yjb.o4a=!0;return!1}RXb(){return this.yjb.o4a=!1}UAa(a){this.yjb.o4a=!1;this.qrd.cancelEventAndRestoreEditingSurface(a.lc);return!0}}Object(e.a)(ie,"DragEventsProcessor",null,[]);class Qe{constructor(a){this.m0e=0;this.mqd=!1;this.qd=a}get o4a(){return this.mqd}set o4a(a){this.mqd=a;window.clearTimeout(this.m0e);this.mqd&&(this.m0e=window.setTimeout(Object(D.a)(this,this.Ugk,"onAfterDragInactivity"),1E3))}Ugk(){this.o4a=!1}}Object(e.a)(Qe,"DragStateManager",
null,[]);class df extends ob{constructor(){super();this.wUg=this.Dgk=0}}Object(e.a)(df,"SetModeEditEventArgs",ob,[]);class tf extends ob{constructor(){super();this.updates=null;this.fxa=new Ha.a}}Object(e.a)(tf,"BeforeValidateEditEventArgs",ob,[]);class jh{constructor(){this.nZk=this.fIi=null}}Object(e.a)(jh,"EditStateFactoryManager",null,[]);class Dh extends ob{constructor(){super();this.charCode=0;this.UIj=this.isComposing=!1}}Object(e.a)(Dh,"KeyDownEditEventArgs",ob,[]);class ch extends ob{constructor(){super();
this.charCode=0;this.isComposing=!1}}Object(e.a)(ch,"KeyPressEditEventArgs",ob,[]);class Hg extends ob{constructor(){super();this.Vqj=!1}}Object(e.a)(Hg,"PaddingChangedEventArgs",ob,[]);class wh{constructor(a){this.Pa=new qd.a;this.F_a=Object.assign(new jh,{fIi:()=>a.Tl(),nZk:()=>kb.a.GBa(a.contentWindow)})}addHandler(a,b){this.Pa.addHandler(a,b)}removeHandler(a,b){this.Pa.removeHandler(a,b)}raiseEvent(a){this.Pa.raiseEvent(a,Object.assign(new ob,{P4a:this.F_a}))}SFk(a,b){0===a&&0===b||this.Pa.raiseEvent(Ae.a.m3k,
Object.assign(new df,{Dgk:a,wUg:b,P4a:this.F_a}))}eEk(a){this.Pa.raiseEvent(Ae.a.hbi,Object.assign(new tf,{P4a:this.F_a,updates:a.updates,fxa:a.fxa}))}M9g(a){a.P4a=this.F_a;this.Pa.raiseEvent(Ae.a.K2g,a)}TBe(a,b){this.Pa.raiseEvent(Ae.a.Cx,Object.assign(new ch,{charCode:a.lc.charCode,isComposing:b,P4a:this.F_a}))}WEk(a,b,c){this.Pa.raiseEvent(Ae.a.eg,Object.assign(new Dh,{charCode:a.lc.charCode,isComposing:b,UIj:c,P4a:this.F_a}))}L9g(a){this.Pa.raiseEvent(Ae.a.Frk,Object.assign(new Hg,{P4a:this.F_a,
Vqj:a}))}}Object(e.a)(wh,"EditStateEventManager",null,[1431]);class Yh{constructor(a){this.ivd=this.xsc=!1;this.gcf=null;this.FYe=0;this.EPc=!1;this.Pa=a;this.v0e=0;this.kwd=2}get mode(){return this.v0e}ufb(a,b){0===a?(0===b&&(b=1),this.gcf=(new Date).toISOString(),this.kwd=b):this.kwd=0;this.v0e=a}get XUc(){return this.kwd}get zRj(){return this.gcf}get isActive(){return 0!==this.mode}get hti(){return this.FYe}dIa(a){this.ivd=a}F_b(a){return this.isActive&&!!a&&this.xsc}X9(a){!this.xsc&&a&&this.Pa.raiseEvent($c.eti);
this.xsc=a;this.Ofk(a);a&&(this.FYe=(new Date).getTime())}J$f(a){return this.isActive&&!!a&&this.ivd}Ofk(a){a&&jf.GrippersManager.instance.setVisibility(!1)}qTk(){this.ivd=this.xsc=!1}}Object(e.a)(Yh,"EditViewStateManager",null,[1423]);var Ni=d(889);class vi{constructor(a,b,c,f,l,x){this.jd=a;this.GC=b;this.ap=c;this.OJ=f;this.jb=l;this.Hf=x;this.jb&&(this.jb.ka("WordEditorImageOverflowIsEnabled")||this.jb.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&(vi.lHc=-1*Math.pow(2,31))}aDc(){this.GC.sNf();
Ba.a.$t(this.jd.Tl())}hTd(a){const b=this.jd.Tl();if(2===a){var c=nb.mJi;a=vi.lJi;b.style.overflow="visible"}else if(1===a)c=n.a.efb?0:vi.lHc,a="0",b.style.overflow="hidden";else return;const f=this.jd.ug.St;f.style.position="absolute";this.jb&&(this.jb.ka("WordEditorImageOverflowIsEnabled")||this.jb.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&0<c?(c=document.createElement("div"),f.style.zIndex=String(c.style.zIndex)):f.style.zIndex=String(c);f.style.display="block";f.style.visibility=
"visible";f.style.maxHeight="none";f.style.maxWidth="";b.style.visibility="visible";f.style.opacity=a}g_f(a){if(this.jd&&this.jd.ug&&this.jd.ug.St){var b=this.jd.ug.St;b.style.zIndex=String(n.a.efb?0:vi.lHc);n.a.efb&&!a&&(b.style.visibility="hidden",this.jd.Tl().style.visibility="hidden")}}ozk(a){this.ap.raiseEvent(Ae.a.eBj);this.aDc();this.jd.NXa(!0);this.jd.Tl().style.direction="";this.hTd(a);this.jd.ug.Uck()}kzk(a){this.jd.NXa(!0);this.hTd(a);n.a.efb&&this.Ujg();n.a.aF&&Sys.UI.DomElement.addCssClass(this.jd.Tl(),
"NonStandardIEClipboard")}nzk(a){this.hTd(a);n.a.aF&&Sys.UI.DomElement.removeCssClass(this.jd.Tl(),"NonStandardIEClipboard")}mzk(a,b,c,f,l,x,F){this.ap.raiseEvent(Ae.a.endEditing);const R=this.jd.Tl();R&&(Ba.a.$t(R),n.a.PV&&b&&a&&(this.jd.NXa(!0),R.innerText=" ",this.OJ.RHa(c,f,l,x,F)),a||kb.a.ANf(R),this.jd.NXa(!1),this.g_f(b))}lzk(a){this.jd.NXa(!1);n.a.aF&&Sys.UI.DomElement.removeCssClass(this.jd.Tl(),"NonStandardIEClipboard");this.g_f(a);this.ap.raiseEvent(Ae.a.Cni)}pzk(){const a=Sys.UI.DomElement.getBounds(this.Hf.Ld.eJ),
b=this.jd.ug.St;Sys.UI.DomElement.getBounds(b).y<a.y&&(b.style.top=Math.max(this.Hf.Ld.scrollTop,Ni.a)+"px");b.style.opacity="0";b.style.zIndex=String(vi.lHc);n.a.xj&&(b.style.visibility="Hidden",this.jd.Tl().style.visibility="Hidden")}Ujg(){const a=1E3-this.Hf.Ld.container.getBoundingClientRect().left+this.Hf.Ld.scrollLeft+1,b=this.jd.ug.St;b.style.left="-11000px";b.style.paddingRight=a+"px";b.style.width=1E4+a+"px"}}vi.lHc=-1E3;vi.lJi="1";Object(e.a)(vi,"EditingDomDisplayManipulator",null,[]);class Eh{constructor(a){this.USh=
a}get range(){return this.USh}select(){this.range.select()}execCommand(a,b,c){return this.range.execCommand(a,b,c)}queryCommandEnabled(a){return this.range.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.range.queryCommandIndeterm(a)}queryCommandState(a){return this.range.queryCommandState(a)}queryCommandSupported(a){return this.range.queryCommandSupported(a)}queryCommandValue(a){return this.range.queryCommandValue(a)}scrollIntoView(a){this.range.scrollIntoView(a)}}Object(e.a)(Eh,"RangeProxy",
null,[1502]);class xh{constructor(a){this.C1a=a}get selection(){return this.C1a}get type(){return this.selection.type}createRange(){return new Eh(this.selection.createRange())}clear(){this.selection.clear()}empty(){this.selection.empty()}}Object(e.a)(xh,"SelectionProxy",null,[1492]);class fj{constructor(a){this.qKh=a}get zl(){return this.qKh}get body(){return this.zl.body}get activeElement(){return this.zl.activeElement}get documentElement(){return this.zl.documentElement}get document(){return this.zl.cookie}get selection(){return new xh(this.zl.selection)}get designMode(){return this.zl.designMode}get doctype(){return this.zl.doctype}get domain(){return this.zl.domain}get hidden(){return this.zl.hidden}get implementation(){return this.zl.implementation}get parentWindow(){return this.zl.parentWindow}get referrer(){return this.zl.referrer}get title(){return this.zl.title}get URL(){return this.zl.URL}get visibilityState(){return this.zl.visibilityState}createAttribute(a){return this.zl.createAttribute(a)}open(){this.zl.open()}close(){this.zl.close()}attachEvent(a,
b){return this.zl.attachEvent(a,b)}detachEvent(a,b){this.zl.detachEvent(a,b)}createAttributeNS(a,b){return this.zl.createAttributeNS(a,b)}createDocumentFragment(){return this.zl.createDocumentFragment()}createElement(a){return this.zl.createElement(a)}createElementNS(a,b){return this.zl.createElementNS(a,b)}createEvent(a){return this.zl.createEvent(a)}createTextNode(a){return this.zl.createTextNode(a)}dispatchEvent(a){return this.zl.dispatchEvent(a)}execCommand(a,b,c){return this.zl.execCommand(a,
b,c)}hasFocus(){return this.zl.hasFocus()}focus(){this.zl.focus()}getElementById(a){return this.zl.getElementById(a)}getElementsByTagName(a){return this.zl.getElementsByTagName(a)}getElementsByTagNameNS(a,b){return this.zl.getElementsByTagNameNS(a,b)}getElementsByName(a){return this.zl.getElementsByName(a)}write(a){this.zl.write(a)}querySelector(a){return this.zl.querySelector(a)}querySelectorAll(a){return this.zl.querySelectorAll(a)}queryCommandEnabled(a){return this.zl.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.zl.queryCommandIndeterm(a)}queryCommandState(a){return this.zl.queryCommandState(a)}queryCommandSupported(a){return this.zl.queryCommandSupported(a)}queryCommandValue(a){return this.zl.queryCommandValue(a)}}
Object(e.a)(fj,"DOMDocumentProxy",null,[1535]);class Wi{constructor(){this.H_a=null}get isValid(){return this.ug.isValid}get contentWindow(){return this.ug?this.ug.contentWindow:null}get ug(){return this.H_a}wjk(a){Ch.a.GRg(a,this.ug.St)}vjk(){Ch.a.$Re(this.ug.St)}m_f(){this.ug.cLi()}u9i(a){if(!n.a.$f)return a.innerHTML;this.ug.Fpl(a);return a.innerHTML}vrl(){this.ug?(this.vjk(),this.H_a=null):Z.ULS.sendTraceTag(18437346,323,15,"UnbindFromEditingDom: View not currently bound to Dom.")}Fbi(a,b){this.H_a=
a;this.wjk(b)}Tl(){return this.ug?this.ug.Bn:null}NXa(a){this.ug&&this.ug.hfd(a)}JBa(){return this.ug?new fj(this.ug.contentDocument):null}}Object(e.a)(Wi,"EditingDomManager",null,[1419]);var yh=d(144);class Rj{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd){this.pga=0;this.Pe=null;this.Lb=a;this.jk=b;this.W0=c;this.ap=f;this.Ona=l;this.Rd=x;this.jd=F;this.jf=R;this.zJ=fa;this.wk=wa;this.qd=Xa;this.GC=lb;this.Pc=Lb;this.CJ=kc;this.zh=lc;this.Hf=Ec;this.$e=Jc;this.Wc=Wd;this.Qfa=Dc;this.Qfa.N5h(Object(D.a)(this,
this.G0g,"onSynchronizeMode"))}dispose(){this.Qfa.NQk(Object(D.a)(this,this.G0g,"onSynchronizeMode"))}RTb(a){(this.Pe=a)||Z.ULS.sendTraceTag(22122889,323,50,"Bind ContentEditableView resolve failed as null.")}get mode(){return this.jf.mode}endClipboard(){if(1===this.mode){var a=this.jk.je(2);a.fd(this.Pe.root);this.Pe.detach();this.Lb.xg&&!this.q7d&&this.Lb.xg.Wba(this.Hf.Ld.Ma,4,!0);this.jf.ufb(0,3);this.Lb.xg=null;this.Lb.Nh=null;this.Lb.lV=null;this.W0.lzk(this.Pe.SGa);a.dispose()}}V9(a,b,c){this.Pe.zRa&&
this.Lb.Nh?this.Pe.hs(!1):this.Pe.zRa&&!this.Lb.Nh&&Z.ULS.shipAssertTag(17884511,315,!1,"Content is dirty when CurrentEditingViewElement is still NULL");this.ap.SFk(this.mode,a);let f=!0;switch(a){case 2:this.endClipboard();this.jf.ufb(a,c);f=this.startEditing(this.wCi);break;case 1:if(this.mode!==a||this.Pc.Oa.xr!==this.pga)this.endEditing(!0),this.jf.ufb(a,c),f=this.sgl(),this.pga=this.Pc.Oa.xr;break;case 0:this.mode!==a&&(2===this.mode&&jf.GrippersManager.instance.setVisibility(!1),this.endEditing(b),
this.endClipboard(),this.jf.ufb(a,c))}f||this.jf.ufb(0,7)}y1k(){this.jf.ufb(2,0)}get wCi(){return this.Pc.Oa.kb.Ua.node}startEditing(a){if(1===this.Uzf)return!1;this.jd.m_f();this.Pe.pwa?this.Pe.hs(!0):(this.Pe.Euj.o_f(!1),this.jf.F_b(this.Lb.xg)&&this.Pe.hs(!1));this.Pe.pwa=!1;if(this.Lb.xg===a)return a=mb.GraphIterator.mb(a.node),this.oTd(a),this.Lb.vrj&&(this.qd.Ki&&this.Pe.hpb.$ba||this.zJ.setFocus(this.mode,this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy)),!0;
const b=this.jk.je(2,C.a.startEditing);b.fd(a.node);this.Pe.detach();this.Lb.xg&&this.Lb.xg.Wba(this.Hf.Ld.Ma,4,!0);this.Lb.xg=a;this.Lb.xg.Wba(this.Hf.Ld.Ma,4,!0);if(this.Wc.Zf){const c=fg.j(this.Lb.xg,5);for(let f=0;f<c.length;f++)c[f].jXf(this.Pe)}this.Pe.arb=!0;this.W0.ozk(this.mode);this.Pe.iA(a.node);this.GC.Cfb(!1,this.Lb.Di,this.zh);this.jf.X9(!1);this.jf.dIa(!1);a=mb.GraphIterator.mb(this.Lb.xg.node);this.oTd(a);b.dispose();return!0}endEditing(a){if(2===this.mode&&(this.Pe.PHc(),this.Pe.hs(!0),
!this.q7d)){var b=this.jk.je(2);b.fd(this.Pe.root);this.Pe.detach();this.Lb.xg&&this.Hf.Ld&&this.Lb.xg.Wba(this.Hf.Ld.Ma,20,!0);this.jf.ufb(0,4);this.Lb.xg=null;this.Lb.Nh=null;this.Lb.lV=null;this.W0.mzk(a,this.Pe.SGa,this.mode,this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy);b.dispose()}}sgl(){if(this.q7d||H.a.instance.ga(11)&&1===this.Uzf)return!1;this.ap.raiseEvent(Ae.a.Bni);this.jd.m_f();const a=this.jk.je(2);a.fd(this.Pc.ahb);this.jf.F_b(this.Lb.xg)&&this.Pe.hs(!1);
this.Pe.detach();this.Lb.xg=null;this.Lb.Nh=null;this.Lb.lV=null;if(this.Pc.Oa.hca){const b=this.Pc.Oa.kb.Ua.node;this.Pe.iA(b);const c=mb.GraphIterator.mb(b);this.Lb.xg=b;this.Lb.Zaa=this.QDj(b);this.oTd(c);this.Lb.xg.Wba(this.Hf.Ld.Ma,4,!0)}else this.Pe.iA(this.Pc.ahb);this.W0.kzk(this.mode);this.GC.Cfb(!1,this.Lb.Di,this.zh);a.dispose();return!0}G0g(){this.NYa()}NYa(){if(!this.Ona.R7&&!u.AFrameworkApplication.ue.Rv&&this.Hf.Ld&&this.Hf.Ld.isActive){var a=this.Pc.Oa.kb;a&&this.zJ.H8d()?this.CJ&&
this.CJ.C7a()?this.V9(2,!0,10):this.$e.Jw(a)?Gb.App.Fb.Ed.isEditingAllowed||Gb.App.Fb.Ed.vy?this.V9(2,!0,0):this.Pe.Ogd?(this.V9(1,!0,0),this.V9(0,!0,15)):this.V9(2,!0,0):this.V9(1,!0,0):this.V9(0,!1,a?9:8)}}get q7d(){return u.AFrameworkApplication.Xg}get Uzf(){return u.AFrameworkApplication.Aa.state}oTd(a){a.Ze();yh.OutlineNavigator.sFe(a)}QDj(a){return Rd.OutlineElementReader.Yl(Yb.OutlineElementNavigator.rA(a))}}Object(e.a)(Rj,"EditingModeTransitionManager",null,[1418]);class Ci{constructor(a,
b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe){this.Pe=null;this.Rd=a;this.jf=b;this.Lb=c;this.$Oh=f;this.vk=l;this.ZOh=x;this.XOh=F;this.Spd=R;this.FWh=fa;this.xjb=wa;this.OLa=Xa;this.$Ye=lb;this.pKh=Lb;this.zJ=kc;this.sfa=lc;this.HRb=Ec;this.uKh=Jc;this.iRh=Dc;this.hHh=Wd;this.JPh=xe;this.nga=Sd;this.Pi=Pe}PR(a){this.Pe=a}get JX(){return!this.Rd.Rv&&this.jf.isActive&&this.Lb.rSa(this.jf.mode)?!0:!1}Zvk(a){a.zDa=b=>this.$Oh.zDa(b,this.JX);a.Z8a=b=>this.ZOh.Z8a(b,this.JX);a.Az=b=>this.XOh.Az(b,
this.JX,this.Pe.iXb);a.HVb=b=>this.Spd.HVb(b,this.JX,this.Pe.iXb);a.oNd=b=>this.Spd.mNd(b,this.JX,this.Pe.iXb);a.GVb=b=>this.Spd.GVb(b,this.JX,this.Pe.iXb);a.Wgb=b=>this.FWh.Wgb(b,this.JX&&this.Pe.Ogd);a.UAa=Object(D.a)(this.xjb,this.xjb.UAa,"dropHandler");a.TAa=Object(D.a)(this.xjb,this.xjb.TAa,"dragOverHandler");a.RXb=Object(D.a)(this.xjb,this.xjb.RXb,"dragLeaveHandler");a.Axe=b=>{this.OLa.handlePaste(b,this.Pe.root,this.jf.EPc)};a.fQd=b=>{this.$Ye.Ogg(b,!0,this.JX,this.jf.EPc)};a.$Nd=b=>{this.$Ye.Ogg(b,
!1,this.JX,this.jf.EPc)};a.OXb=b=>{this.pKh.OXb(b,this.JX)};a.PHf=()=>{this.zJ.$bi()};a.bD=b=>this.sfa.xCi(b,this.vk.$ba,this.JX);a.zB=b=>this.HRb.onContextMenu(b,this.Pe.xg);a.qQe=Object(D.a)(this.HRb,this.HRb.Kdc,"onTouchMove");a.pQe=Object(D.a)(this.HRb,this.HRb.wCb,"onTouchEnd");a.bHd=()=>{this.zJ.iLi(this.jf.mode)};a.M4a=b=>this.uKh.Jcb(b,this.JX);a.yXa=b=>{this.iRh.onScroll(b,this.JX,this.Pe.ownerDocument.documentElement)};a.iea=()=>{this.hHh.shk(this.JX)};a.GBg=b=>{this.JPh.lostFocus(b,this.JX)};
a.BFb=()=>this.nga.Ooj(this.JX,this.Pe.xg);a.jcb=b=>this.Pi.mouseDown(b);a.hse=b=>this.Pi.WW(b)}}Object(e.a)(Ci,"EditingSurfaceEventHandlerManager",null,[]);class bk{constructor(a,b,c){this.hd=a;this.Xf=b;this.sh=c}cancelEventAndRestoreEditingSurface(a){this.hd.Tb("DisallowedDragAndDrop",{["Reason"]:"CancelEventAndRestoreEditingSurface"});this.Xf.bx++;yd.a.an(a);this.sh.V9(0,!0,6);this.sh.NYa()}}Object(e.a)(bk,"EditingSurfaceEventHandlerUtils",null,[]);class zg{constructor(){this.bza=0}get R7(){return 0<
this.bza}suspend(){this.bza++}resume(){0<this.bza&&this.bza--}}Object(e.a)(zg,"EditingSurfaceStateManager",null,[]);class xf{constructor(a=30){this.K4c=this.Jbc=-1;this.ghb=Array(a);this.a5c=Array(a-1)}Twh(){this.PIk();this.evl()}Med(){const a=this.y_k();Z.ULS.sendTraceTag(18437392,324,50,"Duration Values: "+a)}PIk(){var a=(new Date).getTime();if(this.Jbc<this.ghb.length-1)this.Jbc++;else for(let b=0;b<this.ghb.length-1;b++)this.ghb[b]=this.ghb[b+1];this.ghb[this.Jbc]=a}evl(){const a=this.Jbc+1;for(let b=
2;b<=a;b++)this.$ql(b,this.U1i(b))}U1i(a){const b=this.Jbc;return this.ghb[b]-this.ghb[b-(a-1)]}$ql(a,b){a-=2;this.K4c<a?(this.K4c++,this.a5c[this.K4c]=b):b<this.a5c[a]&&(this.a5c[a]=b)}y_k(){const a=this.OQi();return Sys.Serialization.JavaScriptSerializer.serialize(a)}OQi(){const a=Array(this.K4c+1);for(let b=0;b<a.length;b++)a[b]=Math.round(this.a5c[b]/(b+1));return a}}Object(e.a)(xf,"EventFrequencyTracker",null,[]);var Qh=d(1042),Lh=d(1044);class oj{constructor(a){this.Zs=null;this.fp=0;this.sJ=
a;this.Bj=new Date;this.Xoc=u.AFrameworkApplication.Aa.mode}end(a){this.fp=a;this.Zs=new Date}get startTime(){return this.Bj}get endTime(){return this.Zs}get actionId(){return this.sJ}get behavior(){return 2}get eBc(){return this.Xoc}get bJ(){return null}get ld(){return null}get telemetryData(){return null}get response(){return this.fp}get vS(){return 1}get gq(){return 30}get Tpa(){return null}get Vi(){return!0}}Object(e.a)(oj,"TypingActionOperation",null,[1439,249,250]);class gj{constructor(a,b,
c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc){this.Pe=this.bsc=this.Zjb=null;this.ARh=a;this.sh=b;this.ap=c;this.Wfa=f;this.W0=l;this.jk=x;this.Lb=F;this.Hf=R;this.Rd=fa;this.wk=wa;this.jf=Xa;this.Pi=lb;this.zh=Lb;this.ks=kc;this.Rfa=lc;this.dR=Ec;this.Pc=Jc;this.LC=Dc}PR(a){this.Pe=a}get mlg(){return!!this.Zjb}startHybridTransition(){if(this.wk.value.isEditingAllowed||this.wk.value.vy){this.sh.y1k();this.ap.raiseEvent(Ae.a.Crk);this.s2k(C.a.overtype);this.Wfa.value.Pv();this.W0.nzk(this.sh.mode);var a=
this.jk.je(2);a.fd(this.Pe.root);this.Lb.xg&&!u.AFrameworkApplication.Xg&&this.Lb.xg.Wba(this.Hf.Ld.Ma,4,!0);a.dispose();this.dR.jic();this.jf.dIa(!0);this.Pi.updateCaretPosition(this.sh.mode,this.Lb.Di);this.ARh.JSi(this.Lb.Nh,this.Lb.xg,this.Lb.lV);this.zh.Gak(this.Pc.Oa.kb.Ua.Qa,this.Pc.Oa.kb.Ua.Kb);this.ks.OX();this.Rfa.bBb();this.I_h();this.ap.raiseEvent(Ae.a.Ark)}else this.sh.V9(0,!0,12)}wKi(){this.dR.jic();this.Zjb.end(32);Qh.a.getInstance().shc(this.Zjb);Lh.a.getInstance().rhc(this.Zjb);this.Zjb=
null}I_h(){this.bsc||(this.bsc=new He.a(2,1,20,Object(D.a)(this,this.hybridCleanup,"hybridCleanup"),24),this.Rd.Gb(this.bsc))}s2k(a){this.Zjb=new oj(a)}hybridCleanup(){this.bsc=null;this.Lb.rSa(this.sh.mode)&&this.Pe.hs(!0)}ZKe(){if(!this.Pc.Oa.hca)return!1;const a=this.Pc.Oa.kb.Ua,b=Rb.HyperlinkReader.FB(a,!1);for(const c of b)if(c.Qa===a.Qa&&c.Kb<=a.Kb)return!1;return this.LC.GMj(a)?!1:!fg.d(a.node,a.Qa)&&!fg.d(a.node,a.Kb-1)&&!a.node.Psi}}Object(e.a)(gj,"HybridTransitionManager",null,[1417]);class Di{constructor(a,
b,c,f,l){this.Ftd=this.pwa=!1;this.Ir=a;this.sh=b;this.jd=c;this.zh=f;this.Hf=l}get Nuj(){return this.Ftd}PHc(){this.o_f(!0)}o_f(a){this.Ir.isComposing&&2===this.sh.mode&&(Z.ULS.sendTraceTag(18437401,323,50,"EnsureImeDetermined"),this.Ftd=!0,this.jd.ug.cma(),this.zh.cfk(this.jd.contentWindow),this.Ftd=!1,this.Ir.isComposing=!1,a&&this.Hf.Ld.Ro&&(this.Hf.Ld.Kob()&&Z.ULS.sendTraceTag(38602073,323,50,"Selection is reset to view top by EnsureImeDetermined."),this.sh.NYa()))}}Object(e.a)(Di,"ImeManager",
null,[]);class dh{constructor(a,b,c,f,l,x,F,R){this.uh=null;this.qd=a;this.jd=b;this.sh=c;this.jk=f;this.hd=l;this.Xf=x;this.Fm=R}RTb(a){this.uh=a}get Luj(){if(this.qd.$f){const a=kb.a.GBa(this.jd.contentWindow);if(a&&this.Fm.pNc(a)===this.jd.Tl())return!0}return!1}correctBadImeState(){if(!this.Luj)return!1;this.hd.Tb("PossibleIncorrectImeBehavior",{["Reason"]:"CorrectBadImeState"});this.Xf.bz++;const a=this.jk.je(3);a.fd(this.uh.root);this.sh.V9(0,!0,11);this.sh.NYa();a.dispose();return!0}}Object(e.a)(dh,
"ImeRecoveryUtils",null,[]);class Ig{constructor(a,b,c,f,l,x,F,R,fa){this.zh=a;this.Xf=b;this.hd=c;this.$i=f;this.FJ=l;this.Io=x;this.Hf=F;this.Lb=fa}bBb(){for(let a=0;a<this.zh.yi.length;a++)this.Io.YH(this.zh.yi[a].JE,this.Xf,this.hd,this.$i)?Sys.UI.DomElement.removeCssClass(this.zh.yi[a].E6d,"EmptyTextRun"):Sys.UI.DomElement.addCssClass(this.zh.yi[a].E6d,"EmptyTextRun"),Ba.a.ZVb(this.zh.yi[a].JE,this.zh.yi[a].E6d)}}Object(e.a)(Ig,"InteractiveViewSynchronizer",null,[]);var ua=d(14),Pa=d(196),eb=
d(234);class Kb{constructor(){}}Object(e.a)(Kb,"OnBackspaceDeleteEventArgs",null,[]);class bc{constructor(a){this.v2f=a}}Object(e.a)(bc,"OnDisMissFloatieEventArgs",null,[]);var oc=d(539),W=d(97);class ta{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf,mh,Fg,ii,Li,wj,cj,dj,yi,Hk,xj,uk,Gl,gl,Hl,Yj,Oj,Zj,Wk){this.oga=null;this.m8e=this.LVe=!1;this.fOb=new ua.ScriptSharpLegacyMap;this.iza=a;this.$i=b;this.Rd=c;this.jd=f;this.hd=l;this.Xf=x;this.Yoa=F;this.nga=R;
this.sfa=fa;this.Lb=wa;this.Pi=Xa;this.qd=lb;this.Fm=Lb;this.kY=kc;this.$e=lc;this.dR=Ec;this.nH=Jc;this.foa=Dc;this.Pc=Wd;this.jf=xe;this.Ir=Sd;this.Wfa=Pe;this.nB=Ue;this.Vg=Ef;this.wk=dg;this.OJ=Mg;this.Yib=Bg;this.vk=Lf;this.WKa=mh;this.JU=Fg;this.JHh=ii;this.Nlb=Li;this.jk=wj;this.Ca=cj;this.Wc=dj;this.Lo=yi;this.QC=Hk;this.kMb=xj;this.UO=uk;this.G1a=Gl;this.soa=gl;this.ap=Hl;this.IHh=Yj;this.Axa=!!Oj;this.zu=Oj;this.jb=Zj;this.Xm=Wk}get Wmc(){return this.iza.instance?this.iza.instance.hyh():
null}get HQd(){return this.kMb||(this.kMb=hb.a.instance.pb("Common.IEventTimingMeter"))}get FXa(){return this.oga||(this.oga=hb.a.instance.pb("Box4.ISelectionCommands"))}VQj(a,b){let c=this.M2d(a);c||(c=this.amj(a,b));return c}amj(a,b){const c=a.lc,f=c.keyCode,l=a.eventName===qa.a.jNa;if(this.Axa&&l&&this.zu.instance&&this.zu.instance.Jhk(f===w.a.jH))return yd.a.an(c),!0;if(f===w.a.dib&&c.shiftKey&&c.ctrlKey)return l&&(u.AFrameworkApplication.Ta.processAction(C.a.yTf,2),Z.ULS.sendTraceTag(41738320,
323,50,"CtrlShiftV triggered.")),!1;if(l&&c.ctrlKey){if(f===w.a.imd||f===w.a.lmd)return this.Cce(C.a.xTf),!1;if(f===w.a.jmd||f===w.a.Inc)return this.Cce(C.a.wTf),!1;if(f===w.a.PUe)return this.Cce(C.a.cCi),!1}this.$i&&(this.Rd.WUf(ta.lkl),this.jd.ug.zkd());if(1===this.jf.mode)return this.flk(a,b);if(this.$i&&this.vk.$ba)return this.hd.Tb("DisallowedKeyDownDuringDictation",{["Reason"]:"KeyDownHandler"}),this.Xf.bw++,yd.a.an(c),this.Yoa.fic(C.a.typing),!0;this.nga.fixupAfterMagnifierDrag();this.jd.Tl().scrollTop=
0;this.sfa.V7=!this.Lb.Zaa&&f===w.a.wO||this.Lb.Zaa&&f===w.a.YQ||f===w.a.tw;this.Pi.updateCaretPosition(this.jf.mode,this.Lb.Di);this.qd.xj&&(c.ctrlKey||c.altKey)&&f!==w.a.KTe&&f!==w.a.BZa&&f!==w.a.IJb&&f!==w.a.dnd&&this.WKa.PHc();return this.$lj(a)}$lj(a){var b=a.lc.keyCode;const c=b===w.a.kna,f=b===w.a.jH;let l=!1,x=!1,F=!1;switch(b){case w.a.tw:case w.a.iE:F=!0;u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordBrowserHandledNavigationSettings");b=this.jb.ka("BrowserHandledNavigationIsEnabled");
a.lc.altKey||a.lc.ctrlKey||a.lc.shiftKey||this.qd.ek||!b&&this.qd.Hj||(x=!0);break;case w.a.YQ:case w.a.wO:F=!0;this.qd.ek&&this.Fm.yag(a.lc.rawEvent)&&!a.lc.altKey&&!a.lc.shiftKey?x=!0:this.qd.xj&&this.FXa?a.lc.altKey||a.lc.ctrlKey||a.lc.shiftKey||(x=!0):l=!0;this.jb&&this.jb.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&this.jf.dIa(!0);break;case w.a.C0:case w.a.A0:F=!0;this.qd.xj&&this.FXa?x=this.Nkj(a):l=!0;this.jb&&this.jb.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&(this.$e.ATc(this.G1a.kb)||
this.$e.IHa(),this.jf.dIa(!0));break;case w.a.kna:case w.a.jH:if(!this.wk.value.isEditingAllowed&&this.wk.value.vy)l=!0;else if(this.Ckj(a,c,f))return!0;break;case w.a.dDh:this.hd.Tb("InsertKeyPressed");l=!0;break;default:if(a.lc.keyCode===w.a.dnd||a.lc.keyCode===w.a.mmd||this.qd.nHd)this.Ir.isComposing=!0,this.Nlb||this.jf.X9(!0)}(this.vk.A1&&!f||this.vk.lqa&&!c)&&this.nH.hs(!0);2!==this.jf.mode&&(F=x=!1);a.eventName===qa.a.jNa&&this.ap.WEk(a,this.Ir.isComposing,F);x&&(this.Wfa.value.Pv(),this.nB.MMa(a));
l&&yd.a.an(a.lc);return x}M2d(a){return u.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?oc.a.M2d(a,this.G1a.kZb):!1}Dkj(a){const b=this.G1a.kZb;var c=b.node;const f=b.Qa,l=Ya.ParagraphReader.text(c);let x=!1;if(a){if(f<Ya.ParagraphReader.textLength(c)){a=this.jk.je(15);try{a.fd(c),c=f+1,Ma.a.Mw(l,c)&&c++,this.Xm.KBb(b,null),this.Ca.processAction(C.a.rightArrow,2)}finally{a&&a.dispose()}x=!0}}else if(0<f){a=this.jk.je(15);try{a.fd(c),c=f-1,Ma.a.Mw(l,c)&&c--,this.Xm.KBb(b,null),this.Ca.processAction(C.a.leftArrow,
2)}finally{a&&a.dispose()}x=!0}return x}Gbj(a){return tb.a.Bs(a.Ua).cache.fontSize}Nkj(a){var b=!1;if(!(a.lc.altKey||a.lc.ctrlKey||a.lc.shiftKey||(a=fg.f(this.Lb.xg),Pa.a.any(a,c=>5===c.Eq||8===c.Eq)))){if(this.jd.ug&&this.UO.ivb(this.jd.ug.Bn))return!1;this.nB.whb&&this.nB.typingProcess();b=this.kY.ira(this.sfa.V7);a=this.$e.Zga(b);a=this.Lb.Zaa?a.x+a.width:a.x;-1===this.$e.Vy?(this.$e.Vy=a,b=!0):b=Math.abs(this.$e.Vy-a)<=this.Gbj(b)}return b}Ckj(a,b,c){if(!a.lc.altKey&&!a.lc.ctrlKey&&!a.lc.shiftKey&&
(this.$i&&this.vk.A1&&this.dR.dld()&&this.nH.hs(!1),this.JHh.Wpl(b,this.Lb.Nh,this.Lb.gOa,this.Lb.xg,this.sfa.V7,this.Lb.lV.Di,this.nH.Gci))){if(this.Wc.Zf&&this.Wc.jy)return(b=this.Dkj(b))&&yd.a.an(a.lc),b;const f=this.hd.Bp(C.a.iJd);this.Wmc&&this.Wmc.aRj();const l=new Kb(a,c,b);this.IHh.dEk(l);(c&&!this.vk.A1||b&&!this.vk.lqa)&&this.nH.hs(!1);H.a.instance.ga(50)&&this.foa.value&&this.foa.value.Qv&&this.Pc.nSb();Ba.a.ZVb(this.Lb.Nh.Di,this.Lb.lV.Di);this.nB.MMa(a);this.$e.IHa();this.jf.X9(!0);this.vk.lqa=
b;this.vk.A1=c;this.vk.A1&&-1===this.vk.xEc?this.vk.xEc=this.nH.fOc:this.vk.lqa&&-1===this.vk.vjd&&(this.vk.vjd=Ba.a.Su(this.Lb.gOa).length);f.end();return!0}return!1}Az(a,b,c){const f=this.HQd;try{f&&f.keyDownEventHandlerStart(a.lc.rawEvent);0===this.jf.mode&&a.lc.keyCode!==w.a.aq&&1!==this.Ca.mode&&this.AWj(this.jf,a.eventName);if(!b||!this.Vg)return!1;(a.lc.keyCode!==w.a.IJb||this.Yib.BGc)&&this.wk.value.$q.LM();if(!this.q9k(a)){const F=new bc(!0);this.soa.uEk(F)}if(!this.jf.isActive)return!1;
this.vk.bbe=(new Date).getTime();const l=this.hd.Bp(C.a.typing);l.properties.$(kf.a.source,"KeyDown");l.properties.$(kf.a.a4g,"KeyDown");const x=this.VQj(a,c);x&&yd.a.Uii(a.lc);l.end();return x}finally{f&&f.keyDownEventHandlerEnd(a.lc.rawEvent)}}q9k(a){switch(a.lc.keyCode){case w.a.$ea:case w.a.cDh:case w.a.s5:case w.a.YX:case w.a.t$:case w.a.afa:case w.a.mmd:case w.a.nmd:return!0}return!1}AWj(a,b){b={["EventName"]:b};u.AFrameworkApplication.Aa&&(b.Mode=u.AFrameworkApplication.Aa.mode);if(a)if(b.Trigger=
a.XUc,b.TriggeredTime=a.zRj,this.fOb.Jb(a.XUc)){let c,f;(c=this.fOb).$(f=a.XUc,c.ga(f)+1)}else this.fOb.$(a.XUc,1);b.Msg="BadEditSurfaceState";this.LVe?Z.ULS.sendTraceTag(18437408,323,50,"{0}",b):(Z.ULS.shipAssertTag(18437408,323,!1,"{0}",b),u.AFrameworkApplication.Iea(()=>{this.BWj()}));this.LVe=!0}BWj(){if(!this.m8e){var a="";for(let b of this.fOb.keys)a+=" Trigger "+b+" - "+this.fOb.ga(b)+",";Z.ULS.sendTraceTag(50421966,323,10,"Total keyinput lost in UnknownMode:"+a);this.m8e=!0}}flk(a,b){this.$i&&
this.OJ.afb(this.jf.mode,this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy);if(this.Wc.Zf&&(A.KeyInputManager.XOc(a.lc)===A.KeyInputManager.Na(w.a.KJa,A.KeyInputManager.Fe)||A.KeyInputManager.XOc(a.lc)===A.KeyInputManager.Na(w.a.roc,A.KeyInputManager.Fe))&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&(u.AFrameworkApplication.bO||u.AFrameworkApplication.XI)&&!u.AFrameworkApplication.SOa)return yd.a.an(a.lc),
!0;const c=this.G1a.kZb,f=c.node;if(a.lc.keyCode===w.a.aq){if(eb.EmbeddedFileReader.GKj(f))return yd.a.an(a.lc),!0;if(W.ImageReader.wG(f)||!eb.EmbeddedFileReader.c8a(f))if(W.ImageReader.wG(f)||W.ImageReader.bDa(c))return u.AFrameworkApplication.Ta.ii(c,C.a.SA,2,!1,null,null),yd.a.an(a.lc),!0}switch(a.lc.keyCode){case w.a.dnd:case w.a.mmd:if({z2:a,yHb:b}=this.JU.kyh(a,b),a)return b}return!1}Cce(a){u.AFrameworkApplication.Ta.processAction(a,2)}}ta.lkl=2E3;Object(e.a)(ta,"KeyDownProcessor",null,[]);
class da{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){this.Io=a;this.Lb=b;this.Xf=c;this.hd=f;this.$i=l;this.GC=x;this.nH=F;this.dR=R;this.sh=fa;this.Pi=wa;this.kY=Xa;this.rU=lb;this.$e=Lb;this.vk=kc;this.jf=lc}get pxe(){return this.Io.YH(this.Lb.Di,this.Xf,this.hd,this.$i)-(this.GC.a6?1:0)-this.Io.YH(this.Lb.Di.lastChild,this.Xf,this.hd,this.$i)}VAk(a,b){switch(b.keyCode){case w.a.iE:case w.a.YQ:if(this.osj(a,b))return!0;break;case w.a.tw:case w.a.wO:if(this.sKi(a,b))return!0;break;case w.a.C0:case w.a.A0:if(this.Dsl(a,
b))return!0;break;case w.a.jH:if(this.Sai())return!0}return!1}Sai(){return this.vk.A1&&this.dR.dld()?(this.nH.hs(!1,!0),!0):!1}Dsl(a,b){a.xRc=!0;var c=this.pxe;const f=this.Pi.d7(this.sh.mode,this.Lb.Di);f>=c&&(this.Pi.fS(c,this.Lb.Nh),a.kb=this.kY.ira(this.rU.V7));if(f===b.XWb)a.q4a=b.keyCode===w.a.YX?1:3;else{if(f<c&&Ma.a.yy(this.Io.n7f(this.Lb.Nh,f-1,this.hd,this.Xf,this.$i))){c=this.$e.Qqa(a.kb,!1,!1,!1,!0);c=this.$e.Zga(c);var l=a.kb.Ua;a=this.$e.Zga(a.kb);l=tb.a.Bs(l);a.y>c.y&&Math.abs(a.x-
this.$e.Vy)>2*l.cache.fontSize&&this.Pi.fS(f-1,this.Lb.Nh)}this.jf.dIa(!0);this.rU.fixupAfterCursor(b.keyCode===w.a.YX?1:3);this.nH.IQd();return!0}return!1}sKi(a,b){a.xRc=!0;const c=this.pxe;this.$e.IHa();const f=this.Pi.d7(this.sh.mode,this.Lb.Di);f>=c&&(this.Pi.fS(c,this.Lb.Nh),a.kb=this.kY.ira(this.rU.V7));if(b.keyCode===w.a.wO&&(b.XWb>=c&&!this.Lb.Zaa||b.XWb===this.rU.Csh&&this.Lb.Zaa))a.q4a=2;else return this.jf.dIa(!0),b.keyCode===w.a.tw&&f<c&&Ma.a.yy(this.Io.n7f(this.Lb.Nh,f-1,this.hd,this.Xf,
this.$i))&&this.Pi.fS(f-1,this.Lb.Nh),this.rU.fixupAfterCursor(this.Lb.Zaa?4:2),this.nH.IQd(),!0;return!1}osj(a,b){a.xRc=!0;const c=this.pxe;this.$e.IHa();if(b.keyCode===w.a.YQ&&(b.XWb===this.rU.Csh&&!this.Lb.Zaa||b.XWb>=c&&this.Lb.Zaa))a.q4a=4;else return this.jf.dIa(!0),this.rU.fixupAfterCursor(this.Lb.Zaa?2:4),this.nH.IQd(),!0;return!1}}Object(e.a)(da,"KeyEntryProcessor",null,[]);var Ea=d(1164),$a=d(128),fb=d(42);class qc{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,
Ef,dg,Mg,Bg,Lf){this.Hxa=this.Ypf=null;this.qd=a;this.Fm=b;this.hd=c;this.nga=f;this.wk=l;this.JU=x;this.M5=F;this.Ir=R;this.jf=fa;this.Pc=wa;this.jd=Xa;this.$qc=lb;this.Pi=Lb;this.lfa=kc;this.Io=lc;this.Lb=Ec;this.sfa=Jc;this.zh=Dc;this.foa=Wd;this.ap=xe;this.nB=Sd;this.G$=Pe;this.iza=Ue;this.eWh=Ef;this.ufa=dg;this.Wc=Mg;this.Lo=Bg;this.kMb=Lf}get Wmc(){return this.iza&&this.iza.instance?this.iza.instance.hyh():null}get Q8a(){return this.Wc.Zf&&this.Wc.jy}get RY(){return this.Hxa||(this.Hxa=hb.a.instance.pb("Box4.IClipboardCommands"))}get HQd(){return this.kMb||
(this.kMb=hb.a.instance.pb("Common.IEventTimingMeter"))}Z8a(a,b){if(!b)return!1;b=this.HQd;try{b&&b.keyPressedEventHandlerStart(a.lc.rawEvent);if(this.qd.dF&&this.qd.ek&&this.Fm.yag(a.lc.rawEvent))return!1;this.Wmc&&!A.KeyInputManager.Ltg(a)&&this.Wmc.aRj();const c=this.hd.Bp(C.a.typing);c.properties.$(kf.a.source,"KeyPress");const f=this.$Qj(a);c.end();return f}finally{b&&b.keyPressedEventHandlerEnd(a.lc.rawEvent)}}vpj(){if((this.eWh||this.Q8a)&&this.ufa.w1(this.Pc.Dj,14)){var a=Object(va.a)(Ea.a,
this.ufa.MZb(this.Pc.Dj,16,!1));if(a&&1<a.length){const b=[],c=this.Pc.Oa.ga(0);a=a.getContext(0).node;for(let f=0;f<c.length;++f){const l=c.ga(f).node;if(!mb.GraphIterator.mb(l).m$(a))break;Array.add(b,c.ga(f))}0<b.length&&this.Pc.setSelection(new $a.Selection(b,!0))}}}YEk(a,b){if(1===this.jf.mode)return!1;this.ap.TBe(a,this.Ir.isComposing);let c;(c=this.nB).DUc=c.DUc+1;n.a.$n||Gb.App.HJd&&n.a.Qth||(this.nB.Toh(this.Ir.rDa)||this.nB.MMa(a),this.jf.X9(!0));this.Ir.isComposing&&H.a.instance.ga(50)&&
this.foa.value&&this.foa.value.Qv&&this.Pc.nSb();this.zh.Qyc="";0<this.zh.yi.length&&(this.qd.$f||" "===b)&&(this.zh.Qyc=Ba.a.Su(this.zh.yi[0].JE));this.G$.raiseEvent(Ji.a.Rae,a);this.$qc.Twh();return!1}rHi(a){let b=!1;this.Ir.rDa&&this.lfa.JTb.instance&&(" "===a&&this.Io.JJi(this.Lb.Di,this.Pi.d7(this.jf.mode,this.Lb.Di))&&(b=!!this.lfa.lre(this.Ir.rDa,this.sfa.V7)),!b&&this.lfa.JTb.instance.bPj(a)&&this.lfa.qHi(a,this.sfa.V7))}bmj(a){if(1!==this.jf.mode||(this.qd.xj||this.qd.$n)&&a.lc.ctrlKey&&
!a.lc.altKey||this.qd.Tia&&a.lc.charCode===w.a.B0)return!1;if(this.JU.S8c(a))return!0;var b=this.JU.DKe();const c=this.JU.s9k();if(b||c||!this.M5.ZKe())return b&&!c&&this.Pc.setSelection(nd.SelectionFactory.Jg(this.Pc.Oa.kb.Ua.node,this.Pc.Oa.kb.Ua.Qa)),b=this.d8a(),this.vpj(),this.RY&&(this.RY.t3g(String.fromCharCode(a.lc.charCode),b),this.G$.raiseEvent(Ji.a.Rae,a)),yd.a.an(a.lc),!0;if(this.JU.Xwe(a))return!0;if(this.Q8a){b=this.Wc.Knb();try{this.ap.TBe(a,this.Ir.isComposing),this.qd.$n&&this.RY?
(this.RY.t3g(String.fromCharCode(a.lc.charCode)),yd.a.an(a.lc)):(this.nB.MMa(a),this.jf.X9(!0))}finally{b&&b.dispose()}}else this.M5.startHybridTransition(),this.ap.TBe(a,this.Ir.isComposing),this.nB.MMa(a),this.jf.X9(!0);this.G$.raiseEvent(Ji.a.Rae,a);this.$qc.Twh();return!1}d8a(){if(this.Pc&&this.Pc.Oa&&this.Pc.Oa.kb){const a=this.Pc.Oa.kb;return fb.SelectionEditor.Cl(a.ga(a.length-1))||a.ga(a.length-1).contextId===Fb.a.paragraph}return!1}$Qj(a){this.nga.fixupAfterMagnifierDrag();if(!(this.wk.value.isEditingAllowed||
this.wk.value.vy&&this.Q8a))return yd.a.an(a.lc),!0;if(this.JU.U8c(a))return!1;if(1===this.jf.mode)return this.bmj(a);this.jd.Tl().scrollTop=0;this.qd.$f&&this.jf.F_b(this.Lb.xg)&&" "===this.Ypf&&this.nB.typingProcess();const b=Ma.a.charAt(Ma.a.fromCharCode(a.lc.charCode),0);this.Ypf=b;this.Ir.isComposing||(A.KeyInputManager.Ltg(a)&&(this.Ir.isComposing=!0),this.Pi.RGk&&(this.Ir.isComposing=!0));this.rHi(b);if(this.qd.$f&&!this.qd.ek){const c=a.lc;if(c.ctrlKey&&122===this.Fm.m7f(c)||c.ctrlKey&&121===
this.Fm.m7f(c))return!0}return this.YEk(a,b)}}Object(e.a)(qc,"KeyPressProcessor",null,[]);class Hc{constructor(a,b){this.Ri=a;this.keyCode=this.Ri.lc.keyCode;this.XWb=b}get Fqj(){return!(void 0===this.keyCode||null===this.keyCode)}}Object(e.a)(Hc,"KeyQueueEntry",null,[]);class kd{constructor(a,b,c,f,l,x,F){this.gOb=[];this.oga=null;this.YOh=a;this.jf=b;this.Lb=c;this.$e=f;this.Pc=l;this.nH=x;this.Pi=F}get FXa(){return this.oga||(this.oga=hb.a.instance.pb("Box4.ISelectionCommands"))}W5g(a){let b=-1;
if(A.KeyInputManager.fug(a.eventName)&&2===this.jf.mode)switch(a.lc.keyCode){case w.a.iE:case w.a.tw:case w.a.YQ:case w.a.wO:case w.a.C0:case w.a.A0:H.a.instance.ga(45)&&this.jf.F_b(this.Lb.xg)&&this.nH.hs(!1,!1);jf.GrippersManager.instance.bRa();b=this.Pi.d7(this.jf.mode,this.Lb.Di);break;default:jf.GrippersManager.instance.restoreAfterCursoring()}Array.add(this.gOb,new Hc(a,b))}WAk(a){for(;0<this.gOb.length;){const b=this.gOb[0];Array.removeAt(this.gOb,0);const c=A.KeyInputManager.fug(b.Ri.eventName);
if(!(c&&(b.Ri.lc.altKey||b.Ri.lc.ctrlKey||b.Ri.lc.shiftKey)||this.gOb.length)){if(c)if(b.Fqj){if(this.YOh.VAk(a,b))return!0}else this.$e.IHa();if(this.yql(a))return!0}}return!1}yql(a){if(5!==a.q4a){if(this.jf.J$f(this.Lb.xg))if(1===a.q4a||3===a.q4a){const b=this.$e.Vy;this.Pc.setSelection(a.kb);this.$e.Vy=b}else this.Pc.setSelection(a.kb);this.FXa.zdk(a.q4a);if(2!==this.jf.mode)return!0}return!1}}Object(e.a)(kd,"KeyQueueProcessor",null,[]);class Ac{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb){this.oga=
null;this.hd=a;this.OJ=b;this.sh=c;this.Ir=f;this.Lb=l;this.wk=x;this.Rfa=F;this.ks=R;this.mtc=fa;this.jd=wa;this.Yib=Xa;this.nB=lb}get FXa(){return this.oga||(this.oga=hb.a.instance.pb("Box4.ISelectionCommands"))}zDa(a,b){if(!b)return!1;b=this.hd.Bp(C.a.typing);b.properties.$(kf.a.source,"KeyUp");a=this.cRj(a);b.end();return a}cRj(a){a.lc.keyCode===w.a.IJb&&(this.Yib.BGc=!0);a.lc.ctrlKey&&this.OJ.RVf(this.sh.mode,ld.a.instance.Oa,this.FXa,this.Lb.Nh,this.Lb.Di,this.Lb.xg,this.wk.value.isEditingAllowed||
this.wk.value.vy);this.Ir.isComposing&&(this.Rfa.bBb(),this.ks.OX());this.nB.Toh(this.Ir.rDa)&&(this.mtc.W5g(a),this.nB.whb=!0,this.nB.typingProcess());this.jd.Tl().scrollTop=0;return!1}}Object(e.a)(Ac,"KeyUpProcessor",null,[]);class Lc{constructor(a){this.Jpd=this.sod=this.KF=null;this.Rd=a}get z6(){return this.KF||(this.KF=hb.a.instance.resolve("Common.Utils.IAriaNotifier"))}Xfk(a){a&&(this.Jpd=a,this.sod=new He.a(2,1,500,Object(D.a)(this,this.tryAriaNotifyParagraphLockedTask,"tryAriaNotifyParagraphLockedTask"),
29),this.Rd.Gb(this.sod))}tryAriaNotifyParagraphLockedTask(a){this.Jpd&&a&&this.sod===a&&this.z6.sendNotification(String.format(Box4Intl.Box4Strings.l_ScreenReaderBlockEditing,this.Jpd),!0)}}Object(e.a)(Lc,"LockedParagraphAriaNotifier",null,[]);class yc{constructor(a){this.nH=a}lostFocus(a,b){u.AFrameworkApplication.Xg||b&&this.nH.hs(!0,!1)}}Object(e.a)(yc,"LostFocusEventProcessor",null,[]);class Oc{constructor(a,b,c,f){this.Xf=a;this.sh=b;this.Rfa=c;this.ks=f}onScroll(a,b,c){b&&(c.scrollLeft||c.scrollTop)&&
(this.Xf.h++,c.scrollLeft=0,c.scrollTop=0,2===this.sh.mode&&(this.Rfa.bBb(),this.ks.OX()))}}Object(e.a)(Oc,"OnScrollProcessor",null,[]);var od=d(1071);class di{constructor(a,b,c,f){this.html=a;this.text=b;this.xll=c;this.JNd=f}dispose(){this.JNd=null}}Object(e.a)(di,"OriginalElementContent",null,[106]);class ij{constructor(a,b,c){this.nPb=[];this.j1e=0;this.hd=a;this.CR=b;this.Io=c}get yTd(){return this.j1e}get S1g(){return this.nPb}rNf(){for(let a=0;a<this.nPb.length;a++)this.nPb[a]&&(this.nPb[a].dispose(),
this.nPb[a]=null)}Osh(a){this.rNf();a=a.Is;for(let c=0;c<a.length;c++){const f=a[c];var b=!1;f.parentNode&&f.parentNode.parentNode&&(b=Sys.UI.DomElement.containsCssClass(f.parentNode.parentNode,mc.a.HUd));if(b||Sys.UI.DomElement.containsCssClass(f,mc.a.yM)||Sys.UI.DomElement.containsCssClass(f,aa.a.YU)||Sys.UI.DomElement.containsCssClass(f,mc.a.OM)){let l=b=null,x=null;1===f.childNodes.length&&3===f.firstChild.nodeType?b=Ba.a.Su(f):(l=this.Io.nYd(f,this.hd,this.CR),x=new od.a(f));this.S1g[c]=new di(f.innerHTML,
b,l,x)}Sys.UI.DomElement.containsCssClass(f,mc.a.OM)&&(this.j1e=Ba.a.f6a(f))}}}Object(e.a)(ij,"OriginalElementContentArray",null,[1416]);class rh{constructor(a,b,c,f,l,x,F){this.zh=a;this.Xf=l;this.hd=f;this.$i=F;this.GC=b;this.Pc=c;this.Io=x}JSi(a,b,c){var f=this.Pc.Oa.kb.Ua;const l=f.Qa;f=f.Kb;let x=0,F=0;a=a.Is;Array.clear(this.zh.yi);for(let Xa=0;Xa<a.length;Xa++){var R=a[Xa],fa=this.Io.YH(R,this.Xf,this.hd,this.$i);if(Sys.UI.DomElement.containsCssClass(R,mc.a.yM))F<l?x+=fa:F<f&&(fa=fg.d(b,F))&&
!fa.Uza&&(fa=L.a.re(R,aa.a.DDa),Array.add(this.zh.yi,new $f(R,c.Is[fa],x,F,1))),F++;else if(Sys.UI.DomElement.containsCssClass(R,aa.a.YU))x+=fa;else if(!Sys.UI.DomElement.containsCssClass(R,mc.a.OM)){if(F+fa>=l&&F<=f){let lb=L.a.re(R,aa.a.DDa);var wa=c.Is[lb];Sys.UI.DomElement.removeCssClass(wa,mc.a.L6);Array.add(this.zh.yi,new $f(R,wa,x,F,fa-(this.GC.a6?1:0)));for(R=this.Io.YH(wa,this.Xf,this.hd,this.$i);R<fa&&!(lb+1>=c.Is.length);)wa=c.Is[lb+1],R+=this.Io.YH(wa,this.Xf,this.hd,this.$i),wa.parentNode.removeChild(wa),
Array.removeAt(c.Is,lb+1)}else if(F>f)break;x+=fa;F+=fa}}}}Object(e.a)(rh,"OvertypeDomPreparer",null,[]);var Qg=d(120),be=d(57);class Oi{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec){this.Syd=!1;this.Hxa=null;this.DPh=a;this.sh=b;this.qd=c;this.Pc=f;this.Yoa=l;this.$e=x;this.wk=F;this.Hf=R;this.Ir=fa;this.M5=wa;this.$i=Xa;this.Lb=lb;this.OJ=Lb;this.nB=kc;this.Wc=lc;this.Lo=Ec}get RY(){return this.Hxa||(this.Hxa=hb.a.instance.pb("Box4.IClipboardCommands"))}rql(){return 1===this.sh.mode?(this.Syd&&
this.qd.$f&&this.pJd(),this.Syd=!1,!0):!1}pJd(){if(this.RY){const a=new E.DictionaryPropertySet;a.setValue(be.a.zT,"<span></span>");this.RY.Jpa(null,a,!1)}}Xwe(a){const b=this.Pc.Xma;return b.rae||b.G9d?(yd.a.an(a.lc),this.Yoa.fic(C.a.Brk),!0):!1}S8c(a){if(!this.$e.Sra(ld.a.instance.Oa.kb))return!1;yd.a.an(a.lc);this.Yoa.fic(C.a.S8c);return!0}U8c(a){if(!H.a.instance.ga(14))return!1;var b=ld.a.instance.Oa.ga(0);if(!Qg.a.instance.kZk(b))return!1;b=this.$e.Fnc(ld.a.instance.Oa);this.DPh.Xfk(b);yd.a.an(a.lc);
this.Yoa.fic(2===this.sh.mode?C.a.grl:C.a.U8c);return!0}kyh(a,b){let c,f;f=c=!1;if(!this.wk.value.isEditingAllowed)return yd.a.an(a.lc),{z2:!0,yHb:!0};if(!b)return{z2:!0,yHb:!0};if(this.S8c(a)||this.Hf.Ld.Eb.Oa.xG&&a.lc.type===qa.a.lNd)return{z2:!0,yHb:f};this.Ir.isComposing=!0;b=this.DKe();if(!b&&this.M5.ZKe()){if(this.Xwe(a))return{z2:!0,yHb:f};this.$i&&this.OJ.afb(this.sh.mode,this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy);this.Wc.Zf&&this.Wc.jy?(yd.a.an(a.lc),
f=c=!0):this.M5.startHybridTransition()}else b&&this.Pc.setSelection(nd.SelectionFactory.Jg(ld.a.instance.Oa.kb.Ua.node,ld.a.instance.Oa.kb.Ua.Qa)),this.Pc.Xma.vob(),this.Wc.Zf&&this.Wc.jy?(yd.a.an(a.lc),f=c=!0):this.qd.$f?(this.Syd=!0,this.nB.MMa(a),c=!0):(this.pJd(),yd.a.an(a.lc));return{z2:c,yHb:f}}DKe(){if(!this.Pc.Oa.hca)return!1;var a=ld.a.instance.Oa.kb.Ua;return a.Qa!==a.Kb-1?!1:(a=fg.d(a.node,a.Qa))&&5===a.Eq?!0:!1}s9k(){if(!this.Pc.Oa.hca)return!1;const a=this.Pc.Oa.kb.Ua;return!fg.d(a.node,
a.Kb)||0<a.Qa&&!fg.d(a.node,a.Qa-1)||a.Qa===a.Kb?!1:!0}}Object(e.a)(Oi,"OvertypeUtils",null,[]);class Pi{constructor(a,b,c,f,l,x){this.t_a=null;this.jd=a;this.pJh=b;this.Hf=c;this.sh=f;this.Lb=l;this.Dyd=x}get oQf(){return this.pJh}VSe(){if(2===this.sh.mode&&this.Hf.Ld.So&&this.Lb.rSa(this.sh.mode)){var a=this.Lb.Nh,b=this.oQf.t_d(a.$a);this.Dyd.Odh(b,this.t_a,a,this.jd.ug.St,!1,!0);this.t_a=b}}}Object(e.a)(Pi,"ParagraphOverlayPositioner",null,[]);class wk{constructor(a,b){this.Ttk=this.location=
null;this.Uu=a;this.isRtl=b}}Object(e.a)(wk,"OnShowFloatieEventArgs",null,[]);class xk{constructor(){this.type=0;this.payload=this.Swe=null;this.jVc=!1;this.INa=this.style=this.oAe=null}}Object(e.a)(xk,"PasteDataContext",null,[]);class Yl{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg){this.Vyd=this.ugf=this.vn=null;this.GBd=Mg;this.Loa=Bg;this.sgf=a.ka("PasteClipboardImageInChromeIsEnabled");this.ORh=a.ka("PasteFromPlainTextKeepEmptyLinesIsEnabled");this.Tzd=
a.ka("ReadImageBlobForIE11UpIsEnabled");this.GIh=a.Ec("ClipboardDataImageBlobLimitaton",10);this.RQb=a.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.Duf=a.ka("PasteInBootLoadingUIIsEnabled");this.LBd=a.ka("ParseStyleFromRawHtmlHeadIsEnabled");this.Rd=b;this.hd=c;this.jk=f;this.Pc=l;this.sh=x;this.jd=F;this.W0=R;this.Hf=fa;this.qd=wa;this.OJ=Xa;this.Lb=lb;this.lfa=Lb;this.wk=kc;this.Hxa=lc;this.ik=Ec;this.UJh=Dc;this.oMa=Wd;this.vR=xe;this.Ca=Sd;this.ifa=Pe;this.uoa=Ue;this.soa=
Ef;this.fza=dg;this.SXe=[Object(D.a)(this,this.auj,"imageClipboardDataHandler"),Object(D.a)(this,this.pvk,"plainTextClipboardDataHandler"),Object(D.a)(this,this.Psj,"htmlClipboardDataHandler")]}get RY(){return this.Hxa.instance}get SGa(){return this.Vyd}t9i(a){switch(a){case "image/png":a=1;break;case "text/plain":a=2;break;case "text/html":a=3;break;default:a=0}return a}get WUh(){return this.LBd||this.RQb}fmj(a){const b=new xk;b.type=this.t9i(a.type);b.payload=a.data;b.jVc=!0;this.bhh(b)}$5g(a,b){this.Pc.Xma.vob();
this.sh.V9(0,!0,13);this.jd.NXa(!0);const c=this.jd.ug.St.style;c.display="block";a&&(b=c.overflow,c.overflow="hidden");this.W0.pzk();this.Hf.Ld.txa();this.qd.psa?this.OJ.RHa(this.sh.mode,this.Lb.Di,this.Lb.xg,this.Lb.Nh,this.wk.value.isEditingAllowed||this.wk.value.vy):this.W0.aDc();return b}Tfh(a){this.jd.ug.St.style.overflow=a}handlePaste(a,b,c){if(!c&&!this.SGa&&!this.Rd.Rv)if(this.RY||this.Duf){this.lfa.DQ&&(this.lfa.DQ=null);this.Vyd=this.jk.je(3);this.SGa.fd(b);b=new xk;b.INa=this.fza.fNe();
b.INa.yAc("pasteHandler");b.jVc=!1;b.Swe=this.$5g(this.vR.Igd,b.Swe);if(c=this.ik.wba(a)){this.WUh&&this.htk(c,b);for(let f=0;f<this.SXe.length&&this.SXe[f](a,c,b);++f);}this.Loa&&a.preventDefault();u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacLoadingPasteBootUISettings");!this.RY&&this.Duf?this.bhh(b):this.ahh(b)}else Z.ULS.sendTraceTag(3994320,307,50,"Clipboard command not available"),this.hd.Tb(Ed.a.ph,{["Reason"]:Bd.a.ZUf}),this.Ca.Ace(C.a.Jpa),a.preventDefault()}bhh(a){Z.ULS.sendTraceTag(24492118,
307,50,"Clipboard commands unavailable. Loading Paste dialog is showing.");this.Oma();this.ifa.Xj(6,()=>{this.AGi(a)})}Oma(){this.vn=this.uoa();this.vn.hr=!1;this.vn.vd=5;this.vn.Oma(null,null,null)}AGi(a){this.vn&&(this.vn.close(),this.vn=null);Z.ULS.sendTraceTag(24492119,307,50,"Clipboard commands available. Dismissing progress dialog.");this.ahh(a)}ahh(a){a=this.UJh.create(null,Object(D.a)(this,this.FHi,"doPasteOperation"),a);a.xl("Browser Pasted (Editing Surface)");a.run()}auj(a,b,c){if((this.sgf||
this.Tzd)&&(b=this.ik.DXd(a.rawEvent))&&this.ik.$ld(this.jd.Tl())){let f=null;if(({o2b:f}=this.ik.Dkd(b,this.GIh,this.vR.Gbc)).returnValue)return c.type=1,c.payload=f,this.Tzd&&this.qd.PV&&a.preventDefault(),!1}return!0}pvk(a,b,c){return this.ORh&&this.ik.rKj(b)&&(a=this.ik.H_d(b))?(c.type=2,c.payload=a,!1):!0}Psj(a,b,c){return this.GBd&&(a=this.ik.OLc(b))?(c.type=3,c.payload=a,this.LBd&&c.style&&(c.payload+=c.style),!1):!0}FHi(a,b){var c=this.jd.ug.St.style;b&&this.vR.Igd&&"hidden"===c.overflow&&
this.Tfh(b.Swe);if(c=this.jd.Tl()){if(this.qd.xsa)for(var f=c.firstChild;f&&1===c.childNodes.length&&Sc.a(f);)c=f,f=f.firstChild;if(b&&(this.sgf||this.Tzd)&&1===b.type&&this.ik.$ld(c)&&(f=b.payload)){this.ugf=a;this.vR.WVb(f,l=>{this.wXf(this.ugf,l,b)});return}this.wXf(a,this.jd.u9i(c),b)}}zzf(a){a=this.oMa.create(a,Object(D.a)(this,this.pvh,"teardownPaste"),null);a.xl("Aborting Paste in ContentEditableView");a.run()}wXf(a,b,c){this.qd.xj&&(Ba.a.$t(this.jd.Tl()),this.qd.Tia||this.jd.ug.cma());if(this.Loa&&
!c)Z.ULS.sendTraceTag(541172694,307,10,"No pasteDataContext"),this.zzf(a);else{c.jVc&&(b="",1!==c.type&&(b=c.payload));var f=!b&&!c.jVc;this.Loa&&(f=!c.payload&&f);f?(Z.ULS.sendTraceTag(18437454,307,15,""),this.zzf(a)):(c.style&&(b+=c.style),this.jd.NXa(!0),f=new E.DictionaryPropertySet,f.setValue(be.a.zT,b),f.setValue(Bb.a.X8d,!0),f.setValue(bb.a.gN,!0),1===c.type&&this.vR.nkc?f.setValue(be.a.LPc,b):2===c.type&&c.payload?f.setValue(be.a.mdb,c.payload):3===c.type&&c.payload&&(this.Loa?f.setValue(be.a.zT,
c.payload):f.setValue(be.a.Gxe,c.payload)),this.RQb&&c.oAe&&f.setValue(be.a.I3g,c.oAe),c.INa&&f.setValue(be.a.INa,c.INa),a=this.oMa.create(a,Object(D.a)(this,this.cii,"callPasteAction"),f),a.xl("Paste in ContentEditableView"),a.run())}}cii(a,b){this.RY.Jpa(a,b,!0);a.Wg(Object(D.a)(this,this.pvh,"teardownPaste"));return!0}pvh(a){this.sh.NYa();this.SGa&&(this.SGa.QT(a),this.SGa.dispose(),this.Vyd=null);a.Wg(Object(D.a)(this,this.dii,"callPasteFloatie"));return!0}dii(a,b){a=Object(va.a)(E.DictionaryPropertySet,
b);if(!a||a.sa(be.a.mdb,null)||a.sa(be.a.LPc,null))return!1;b=new wk(1,u.AFrameworkApplication.isRtl);b.Ttk=a.sa(be.a.zT,null);this.soa.nGk(b);return!1}htk(a,b){if(a=this.ik.Z0f(a)){u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordGatherMetadataAboutPastedHTMLContentSettings");if(this.RQb){let c=this.ik.$0f(a);null===c?c="inaccessible":""===c&&(c="unknown");b.oAe=c}this.LBd&&(b.style=this.ik.jOi(a))}}}Object(e.a)(Yl,"PasteHandler",null,[1415]);class Af{constructor(a,b,c,f,
l){this.pef=new Ud.a(RegExp("\u00a0","g")," ");this.Swf=new Ud.a(new RegExp("["+nb.$Hf+nb.hlg+"]","g"),"");this.hd=a;this.Xf=b;this.Pi=c;this.Io=f;this.qd=l}$li(a,b,c,f,l){if(l){l=!1;for(let fa=0;fa<a.length;++fa){const wa=b.S1g[fa];if(!wa)continue;const Xa=a[fa];var x=Xa.innerHTML,F=wa.html;if(x.length===F.length||x===F)continue;if(mf.BSc(Xa))continue;l=!0;x=Sys.UI.DomElement.containsCssClass(Xa,aa.a.YU);F=Sys.UI.DomElement.containsCssClass(Xa,mc.a.yM);const lb=Sys.UI.DomElement.containsCssClass(Xa,
mc.a.OM);let Lb=!1,kc=!1;Xa.parentNode&&Xa.parentNode.parentNode&&Sys.UI.DomElement.containsCssClass(Xa.parentNode.parentNode,mc.a.HUd)&&(Lb=Xa.parentNode.parentNode.firstChild===Xa.parentNode,kc=Xa.parentNode.parentNode.lastChild===Xa.parentNode);var R=void 0;let lc;wa.text?(R=Ba.a.Su(Xa),lc=wa.text):(R=this.Io.nYd(Xa,this.hd,this.Xf),lc=wa.xll);const Ec=this.pef.VGa(R).indexOf(this.pef.VGa(lc));if(0<=Ec){const Jc=this.Swf.VGa(Ma.a.substring(R,0,Ec));R=this.Swf.VGa(Ma.a.right(R,Ec+lc.length));0<
Jc.length&&((lb||F||Lb)&&0<fa?(this.w5c(a[fa-1],Jc,!0,this.Xf),this.Io.GRc(Xa)&&(f-=nb.FGc)):x&&fa!==a.length-1&&this.w5c(a[fa+1],Jc,!1,this.Xf));0<R.length&&((F||kc||x)&&fa!==a.length-1?(this.w5c(a[fa+1],R,!1,this.Xf),this.Io.GRc(Xa)&&(f+=nb.GRd)):lb&&0<fa&&this.w5c(a[fa-1],R,!0,this.Xf))}else lb&&(this.qd.xj||this.qd.$n)&&1===lc.length&&!R.length?Z.ULS.sendTraceTag(18437455,315,50,"Possible Ins/Overtype"):lb&&this.qd.$f||Z.ULS.shipAssertTag(18437456,315,!1,"CleanReadOnlyObjects failed."),x=lc?lc.length:
0,F=R.length,F>x&&(f-=F-x);wa.text?Ba.a.ix(Xa,wa.text):(this.Io.eOj(Xa)||wa.JNd.restore(),wa.JNd=new od.a(Xa))}l&&this.Pi.fS(f,c)}}w5c(a,b,c,f){f.n++;c?Ba.a.ix(a,Ba.a.Su(a)+b):Ba.a.ix(a,b+Ba.a.Su(a))}}Object(e.a)(Af,"ReadOnlyObjectsCleaner",null,[]);class Ff{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe){this.xga=0;this.jd=a;this.tBd=b;this.zJ=c;this.Xf=f;this.hd=l;this.ztc=x;this.Pc=F;this.Pi=R;this.Io=fa;this.qd=wa;this.Ve=Xa;this.$e=lb;this.Hf=Lb;this.$i=kc;this.bBd=lc;this.Fm=
Ec;this.Zq=Jc;this.bOh=Dc;this.ALh=xe}init(a){this.xga=a}afb(a,b,c,f,l){if(this.jd.isValid){var x=this.jd.Tl();x&&x.firstChild&&1!==u.AFrameworkApplication.Aa.state&&(this.tBd.c1f(this.Pc.Oa),this.FGe(a,b,c,f,l))}}RHa(a,b,c,f,l){if(this.zJ.H8d()&&(!this.$i||this.Ve.v7g))if(this.zJ.setFocus(a,b,c,f,l),this.qd.dU){a="Window.getSelection";b=this.jd.Tl();if(this.qd.AS){if("none"===b.style.display){Z.ULS.sendTraceTag(19702473,324,15,"Editing element is not displayed");return}if(!Ba.a.$ra(this.jd.ug.wxa,
b)){Z.ULS.sendTraceTag(19702474,324,15,"Editing element is not attached to view panel");return}}try{var x=this.Fm.getSelection(this.jd.contentWindow);x&&(a="Selection.removeAllRanges",this.Fm.removeAllRanges(x),a="Selection.selectAllChildren",this.Fm.NYk(x,b))}catch(F){x=Ba.a.Gcg(b),Z.ULS.sendTraceTag(18437461,324,10,"{{'BrowserAPI':'{0}','HTML':'{1}','Stack':'{2}','Display':{3},'RootElement':{4}}}",a,b?kb.a.nSd(b):"",F.stack,b?b.style.display:"",x?x.tagName+","+x.id+","+x.className:"")}}else this.Fm.FGe(this.jd.JBa().zl)}FGe(a,
b,c,f,l){const x=this.Pc.Oa.kb;try{if(this.zJ.H8d()&&(!this.$i||this.Ve.v7g)){var F=x.Ua,R=x.Te,fa=this.bBd.create(this.Hf.Ld);this.RHa(a,b,c,f,l);a=null;var wa=this.jd.JBa();if(this.qd.dU){a=this.Fm.getSelection(this.jd.contentWindow);if(!a)return;if(this.Fm.D$i(a)){var Xa=this.Fm.getRangeAt(a,0);this.Fm.removeAllRanges(a)}else Xa=this.Fm.createRange(wa.zl)}else if(this.qd.aF)Xa=wa.selection.createRange();else return;this.bOh&&this.g3k(Xa);(this.$e.Pj(F)||this.$e.Cl(F))&&this.FSi(F,Xa);this.$e.Pj(R)&&
this.GSi(R,Xa);this.qd.dU?this.Fm.addRange(a,Xa):this.qd.aF&&Xa.select();fa.dispose()}}catch(lb){F=this.jd.Tl(),Z.ULS.sendTraceTag(18437463,324,10,"{{'Message':'{0}','Stack':'{1}','HTML':'{2}'}}",lb.message,lb.stack,F?kb.a.nSd(F):"")}}GSi(a,b){var c=a.node.oc(this.xga).Is;let f=0,l=0,x=0;a=a.Kb;for(var F=!1;f<c.length;){const R=this.Io.YH(c[f],this.Xf,this.hd,this.$i);if(F)x+=R;else if(Sys.UI.DomElement.containsCssClass(c[f],mc.a.yM))l++;else if(!Sys.UI.DomElement.containsCssClass(c[f],aa.a.YU)){if(a<=
l+R)if(F=a-l,this.qd.dU){c=c[f];this.ztc.value.uVb(c,this.jd.contentWindow);this.Llh(b,c,F,!1);break}else x=R-F,F=!0;l+=R}f++}this.qd.aF&&this.Fm.moveEnd(b,-x)}FSi(a,b){var c=a.node.oc(this.xga).Is;let f=0;var l=0;let x=0,F=a.Qa;for(this.$e.Cl(a)&&(F=this.Zq.textLength(a.node));f<c.length;)if(a=this.Io.YH(c[f],this.Xf,this.hd,this.$i),Sys.UI.DomElement.containsCssClass(c[f],mc.a.yM))l++,f++,x+=a;else if(Sys.UI.DomElement.containsCssClass(c[f],aa.a.YU))f++,x+=a;else if(this.ALh&&Sys.UI.DomElement.containsCssClass(c[f],
mc.a.KSd))f++,x+=a;else{if(F<=l+a){l=F-l;this.qd.dU?(c=c[f],this.ztc.value.uVb(c,this.jd.contentWindow),this.Llh(b,c,l,!0)):this.Fm.moveStart(b,x+l);break}l+=a;x+=a;f++}}Llh(a,b,c,f){b.childNodes.length?(1<b.childNodes.length||b.firstChild&&3!==b.firstChild.nodeType)&&Z.ULS.sendTraceTag(18437465,324,50,"Span is not normalized"):Z.ULS.sendTraceTag(18437464,324,10,"Trying to set selection in an empty span");let l=0,x=null;b=Ba.a.mKc(b,!0);for(let F of b)if(3===F.nodeType){b=F.nodeValue.length;if(c<=
l+b){this.Fm.jGb(a,f,F,c-l);return}x=F;l+=b}x?(Z.ULS.sendTraceTag(18437467,324,15,"CP ({0}) was greater than length of all text nodes ({1}), setting at end",c,l),this.Fm.jGb(a,f,x,c-l)):Z.ULS.sendTraceTag(18437466,324,15,"Span contained no text nodes")}RVf(a,b,c,f,l,x,F){var R=this.Pc.Xma;if(R.rae||R.G9d)return!1;var fa=this.jd.Tl();if(!fa.innerHTML.length)return!1;R=!1;if(this.qd.dU)(b=kb.a.GBa(this.jd.contentWindow))&&(this.Fm.pNc(b)===fa?R=!0:this.$i&&kb.a.wLj(b)&&kb.a.vLj(b)&&(R=!0));else if(this.qd.aF){var wa=
this.jd.JBa().selection.createRange();wa=this.Fm.n4i(wa.range);wa=wa.replace(Ma.a.Dtc,"");fa=fa.innerHTML;fa=fa.replace(Ma.a.Dtc,"");if(wa===fa)switch(a){case 2:R=!0;break;case 1:1<b.length||!(this.$e.lu(b.kb.Ua)||this.$e.Cl(b.kb.Ua)||this.$e.lu(b.kb.Te)||this.$e.Cl(b.kb.Te))||(R=!0)}}if(!R)return!1;this.Xf.by++;this.$i&&c?c.Eqa():2===a?this.Pi.fS(this.Pi.vSa,f):1===a&&this.afb(a,l,x,f,F);return!0}g3k(a){a=Ba.a.mKc(a.commonAncestorContainer,!0);for(let b of a)b&&(a=Ba.a.Yha(b),a.startsWith("OutlineElement")&&
(-1!==a.toLowerCase().indexOf("rtl")?b.style.direction="rtl":b.style.direction="ltr"),a.toLowerCase().startsWith("paragraph")&&b.parentNode&&b.parentNode.tagName.toLowerCase().startsWith("li")&&(b.style.margin=""))}}Object(e.a)(Ff,"SelectContentHelper",null,[]);class pj{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec){this.oga=this.Sna=this.Pe=null;this.sh=a;this.Pi=b;this.Xf=Lb;this.Lb=c;this.jf=f;this.jd=l;this.Rd=x;this.Fm=F;this.Io=R;this.hd=lb;this.Pc=fa;this.$i=lc;this.OJ=wa;this.rU=Xa;
this.wk=kc;this.dR=Ec}get FXa(){return this.oga||(this.oga=hb.a.instance.pb("Box4.ISelectionCommands"))}PR(a){this.Pe=a}Ooj(a,b){if(!a)return!1;var c=this.sh.mode;if(2===c)if(!this.Pi.cAj)this.Xf.b++,this.Pi.fS(this.Pi.vSa,this.Lb.Nh);else if(this.$i){if(500>(new Date).getTime()-this.jf.hti)return this.Pe.hpb.$ba=!1;a=kb.a.GBa(this.jd.contentWindow);if(!a)return!1;if(kb.a.lTc(a)){b=this.Pi.DKc(c,this.Lb.Di);if(this.Pi.vSa===b&&!this.Pe.hpb.$ba)return this.Sna&&(this.Rd.Qg(this.Sna),this.Rd.Gb(this.Sna)),
!1;if(this.dR.dld())return this.Xf.c++,this.Pe.hpb.$ba=!0,!1;if(this.Pe.hpb.$ba)return this.Xf.d++,this.jf.X9(!0),this.Pe.hs(!0),this.Pe.hpb.$ba=!1;this.Sna||this.Pe.hs(!0);jf.GrippersManager.instance.setVisibility(!1);this.T1k();return!1}if(this.OJ.RVf(c,ld.a.instance.Oa,this.FXa,this.Lb.Nh,this.Lb.Di,this.Lb.xg,this.wk.value.isEditingAllowed||this.wk.value.vy))return this.Xf.e++,!1;c=this.Io.w_d(this.Fm.pNc(a),this.Lb.Di,this.Fm.Odg(a),this.Xf,this.hd,this.$i);a=this.Io.w_d(this.Fm.t2i(a),this.Lb.Di,
this.Fm.d9f(a),this.Xf,this.hd,this.$i);if(0>c||a<c||Ya.ParagraphReader.textLength(b.node)<a)return!1;this.Xf.f++;this.Pc.setSelection(nd.SelectionFactory.P1(b.node,c,a))}return!1}T1k(){this.Sna?this.Rd.Qg(this.Sna):this.Sna=new He.a(2,1,1E3,()=>{this.fixupAfterMagnifierDrag()},23);this.Rd.Gb(this.Sna)}fixupAfterMagnifierDrag(){if(this.Sna){this.Sna=null;var a=this.sh.mode;2===a&&this.Lb.rSa(a)&&(this.Xf.g++,this.Pi.updateCaretPosition(a,this.Lb.Di),this.jf.dIa(!0),this.rU.fixupAfterCursor(5),this.Pe.hs(!0),
jf.GrippersManager.instance.Vph())}}}Object(e.a)(pj,"SelectionChangeHandler",null,[1414]);class dl{constructor(a,b){this.jd=a;this.MQb=b}c1f(a){this.RFf(this.jd.Tl(),this.MQb+a.xr,n.a.Mci)}RFf(a,b,c){for(a=a.firstChild;a;a=a.nextSibling)3!==a.nodeType&&(this.bOk(a),Sys.UI.DomElement.addCssClass(a,b),Sys.UI.DomElement.addCssClass(a,c),this.RFf(a,b,c))}bOk(a){var b=a.className;if(b){b=b.split(" ");for(let c=0;c<b.length;c++)b[c].startsWith(this.MQb)&&Sys.UI.DomElement.removeCssClass(a,b[c])}else Z.ULS.sendTraceTag(18437474,
324,50,"Class string for DOMElement is null")}}Object(e.a)(dl,"SequenceCodeHelper",null,[1413]);class Zl{constructor(a,b,c,f){this.Xf=f;this.Pi=b;this.hd=c;this.jb=a}iCk(a,b,c,f){if(a.yi.length){var l=a.yi[0].JE,x=Ba.a.Su(l);if((a=a.Qyc)&&x&&x.length===a.length+1&&x.endsWith(" ")){var F=kb.a.BZd(l);F&&((a=L.a.re(l,aa.a.DDa),a=b.Is[a+1],a)?kb.a.BZd(a)!==F&&(c=this.Pi.d7(c,f),f=Ba.a.Su(a),this.hd.Tb("MomentaryIncorrectLinkLength",{["Reason"]:"MovedSpaceOutOfLink"}),this.Xf.q++,Ba.a.ix(l,x.substring(0,
x.length-1)),Ba.a.ix(a," "+f),this.Pi.fS(c,b)):this.Xf.p++)}}}hji(a,b,c){for(let f=0;f<a.childNodes.length;f++){const l=a.childNodes[f];if(l.parentNode===a)if(this.jb.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&Sys.UI.DomElement.containsCssClass(l,mc.a.W7))for(let x=0;x<l.childNodes.length;x++)this.JLf(l.childNodes[x],x,b,a,c)&&x--;else this.JLf(l,f,b,a,c)&&f--}}JLf(a,b,c,f,l){const x=a.parentNode;f=x===f;if(3===a.nodeType){let F=-1;const R=a.nodeValue;let fa=null,wa="";if(b){const Xa=x.childNodes[b-
1];if(Sc.a(Xa)&&(!f||Ya.ParagraphReader.Wd(Sc.a(Xa).$a))){for(fa=Xa;fa.lastChild&&1===fa.lastChild.nodeType;)fa=fa.lastChild;wa=fa.innerText+R}}if(!fa&&b!==x.childNodes.length-1&&(b=x.childNodes[b+1],Sc.a(b)&&(!f||Ya.ParagraphReader.Wd(Sc.a(b).$a)))){for(fa=b;fa.firstChild&&1===fa.firstChild.nodeType;)fa=fa.firstChild;wa=R+fa.innerText}fa?(F=this.Pi.d7(c,x),this.hd.Tb("MomentaryIncorrectFormatting",{["Reason"]:"MovedSpanlessText"}),this.Xf.r++,Ba.a.ix(fa,wa)):(this.hd.Tb("ValidTextDropped",{["Reason"]:"DroppedSpanlessText"}),
this.Xf.s++);x.removeChild(a);-1!==F&&this.Pi.fS(F,l);return!0}return!1}eNk(a,b,c,f){if(n.a.$f&&a.yi.length){var l=Ba.a.Su(a.yi[0].JE),x=a.Qyc;l&&x&&l.length===x.length+2?this.fch(0,a,b,c,f):2===a.yi.length&&this.fch(1,a,b,c,f)}}fch(a,b,c,f,l){c=this.Pi.d7(c,f);(f=Ba.a.Su(b.yi[a].JE))&&f.endsWith("\u00a0 ")&&(this.Xf.t++,f=f.substr(0,f.lastIndexOf("\u00a0 "))+" ",b.yi[a].JE.innerText=f,(0<a?c-(b.yi[0].nBc+Ba.a.Su(b.yi[0].JE).length):c-b.yi[0].nBc)>f.length&&c--,this.Pi.fS(c,l))}}Object(e.a)(Zl,"StrayTextCleanupUtils",
null,[]);class Cj{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd){this.Dfa=null;this.jDd=a;this.yjb=b;this.qrd=c;this.hd=f;this.nga=l;this.sh=x;this.Pc=F;this.M5=R;this.qd=fa;this.jf=wa;this.vk=Xa;this.nB=lb;this.Rfa=Lb;this.ks=kc;this.JU=lc;this.G$=Ec;this.Lb=Jc;this.tMa=Dc;this.Wc=Wd}get rba(){return this.Dfa||(this.Dfa=hb.a.instance.pb("Box4.IFormatPainter"))}Wgb(a,b){if(!b)return!1;if(this.jDd.aoh)return a.lc.preventDefault(),!0;if(this.yjb.o4a&&this.qd.psa)return this.yjb.o4a=!1,
this.qrd.cancelEventAndRestoreEditingSurface(a.lc),!0;this.rba&&this.rba.yK&&(this.rba.yK=!1);this.Bkj(a.lc);b=this.hd.Bp(C.a.typing);b.properties.$(kf.a.source,"TextInput");a=this.ell(a);b.end();return a}ell(a){this.nga.fixupAfterMagnifierDrag();if(1===this.sh.mode){if(this.JU.DKe())this.Pc.setSelection(nd.SelectionFactory.Jg(ld.a.instance.Oa.kb.Ua.node,ld.a.instance.Oa.kb.Ua.Qa));else if(this.M5.ZKe()){if(this.JU.Xwe(a))return!1;this.M5.startHybridTransition()}this.qd.eI&&this.JU.pJd()}this.G$.raiseEvent(Ji.a.fll,
a);this.jf.X9(!0);this.vk.qPe=!0;this.nB.MMa(a);this.tMa&&this.tMa.ODl(this.Lb.Nh);this.Rfa.bBb();this.ks.OX();return!1}Bkj(a){this.qd.$f||"deleteContentBackward"!==a.rawEvent.inputType||(this.vk.NQd=!this.vk.A1,this.vk.NQd&&u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("DeleteFromInputEventIsEnabled")&&(a=Cj.kLd.DKc(2,this.Lb.Di),a<Cj.kLd.vSa&&(a=nd.SelectionFactory.P1(this.Lb.xg,a,Cj.kLd.vSa),u.AFrameworkApplication.Ta.Ka(C.a.tOa,2,a))))}static get kLd(){return Cj.Pi||(Cj.Pi=hb.a.instance.resolve("Box4.ICaretPositionManager"))}}
Cj.Pi=null;Cj.dR=null;Cj.nH=null;Object(e.a)(Cj,"TextInputEventProcessor",null,[]);class Sm{constructor(a,b,c,f,l,x){this.zJ=a;this.qd=b;this.Ve=c;this.vk=f;this.wk=l;this.Wc=x}get Q8a(){return this.Wc.Zf&&this.Wc.jy}get aoh(){if(this.zJ.t2b||!this.wk.value.isEditingAllowed&&this.wk.value.vy&&!this.Q8a)return!0;if(this.qd.N7){var a=this.Ve.pRj;if(0<a){var b=(new Date).getTime();a=b-a;b-=this.vk.bbe;if(500>a&&a<b)return!0}}return!1}}Object(e.a)(Sm,"TextInputHandlerUtils",null,[]);var im=d(508),Tm=
d(301);class jm{constructor(a,b,c,f){this.$na=null;this.qd=a;this.zJ=b;this.Hf=c;this.$e=f}onContextMenu(a,b){let c=!1;this.qd.N7&&this.zJ.vSc&&(b=this.$e.vpb(this.Hf.Ld,b,this.Hf.Ld.Xha(a),!1),this.$e.Jw(b)&&(c=!0));c?(this.$na=a.clientPoint,a=!0):(this.$na=null,a=this.Hf.Ld.onContextMenu(a));return a}Kdc(a){if(this.qd.N7&&this.$na){const b=Tm.a.nQe;if(a.clientPoint.x>this.$na.x+b||a.clientPoint.x<this.$na.x-b||a.clientPoint.y>this.$na.y+b||a.clientPoint.y<this.$na.y-b)this.$na=null}return!1}wCb(a){let b=
!1;this.qd.N7&&this.$na&&(b=this.Hf.Ld.onContextMenu(a),this.$na=null);return b}}Object(e.a)(jm,"TouchEventProcessor",null,[]);class jk{create(a){return new oj(a)}}Object(e.a)(jk,"TypingActionOperationFactory",null,[1409]);var de=d(69),Kj=d(244);class qg{constructor(a,b,c,f,l,x){this.Gxf=0;this.Dbf=Ga.a.nil;this.VNb=this.ysc=!1;this.r9e=4===Gb.App.mode;this.Zuc=!1;this.hXh=new Xb.a;this.hXh.add(0,C.a.BEe);this.Yxc=new Xb.a;this.Yxc.add(0,0);this.kcf=a;this.Xib=b;this.Hf=c;this.ap=f;this.iXh=l;this.tpd=
x;this.mbf=Object(D.a)(this,this.KSk,"reportTypingCharCount");u.AFrameworkApplication.Iea(()=>{this.bYj()});this.tpd&&this.kLk();this.jLk();u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.pa(C.a.BEe,de.a.frame,ce.ActionManager.Fg,96)}kLk(){this.ap&&this.ap.addHandler(Ae.a.Cx,this.mbf)}jLk(){this.Xib&&this.Xib.oCf(Object(D.a)(this,this.$zc,"afterEditingViewValidateEventHandler"))}fic(a){this.kcf.value&&0===this.kcf.value.mode||(a=new oj(a),a.end(8),Qh.a.getInstance().shc(a),Lh.a.getInstance().rhc(a))}sXg(a,
b){if(!this.r9e&&Gb.App.Fb&&2===Gb.App.Fb.mode&&b&&b.graphNode&&Ya.ParagraphReader.Wd(b.graphNode)&&!fg.a(b.graphNode,5)){if(a=b.graphNode.id,a!==this.Dbf){if(this.Zuc){var c;(c=this.Yxc).$(0,c.ga(0)+1);u.AFrameworkApplication.Ta.processAction(C.a.BEe,2);c="Paragraph rendering is blocked";this.iXh&&(c+=", so graph transaction manager is reset",Kj.GraphTransactionManager.instance.vJe());Z.ULS.sendTraceTag(38547550,323,15,c)}this.Dbf=a;this.Zuc=!0}}else this.Zuc=!1}$zc(a,b){this.r9e||!b.WL&&!b.OT||
(!this.ysc&&this.Hf.Ld&&(this.Hf.Ld.w3h(Object(D.a)(this,this.sXg,"onContentEditableViewClick")),this.ysc=!0),this.Zuc=!1)}KSk(){this.Gxf++}Hyl(a,b){a!==b&&(a=String.format("CP changed unexpectedly in browser, expected {0} but was {1}",a,b),Z.ULS.sendTraceTag(18437207,323,15,a))}bYj(){this.VNb||(this.tpd&&(Z.ULS.sendTraceTag(38114780,323,50,""+this.Gxf),this.dHi(),this.tpd=!1),0<this.Yxc.ga(0)&&Z.ULS.sendTraceTag(38536792,323,15,"ParagraphDisappear:{0}",this.Yxc.ga(0)),this.cHi(),this.VNb=!0)}dHi(){this.ap&&
this.ap.removeHandler(Ae.a.Cx,this.mbf)}cHi(){this.Xib&&this.Xib.kPk(Object(D.a)(this,this.$zc,"afterEditingViewValidateEventHandler"));this.ysc&&this.Hf.Ld&&(this.Hf.Ld.oPk(Object(D.a)(this,this.sXg,"onContentEditableViewClick")),this.ysc=!1)}}Object(e.a)(qg,"TypingLogger",null,[1387]);const el=a=>{u.AFrameworkApplication.fa.ka("TypingSurveyIsEnabled")&&(a.execute(b=>{b.S5b("WordTypingSurveyTrigger",null)}),a.execute(b=>{window.setTimeout(()=>{b.logActivity("WordTypingSurveyTrigger",null)},300)}))};
class Cm{constructor(a){this.xRc=!1;this.q4a=5;this.oUg=!1;this.Ose=!0;this.kb=a}}Object(e.a)(Cm,"TypingProcessState",null,[]);class qj{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf,mh,Fg,ii){this.uga=this.Pe=null;this.whb=!1;this.Vkd=null;this.DUc=0;this.PMb=a;this.Lb=b;this.Dtd=c;this.Pi=f;this.e1a=l;this.ap=x;this.mtc=F;this.kY=R;this.rU=fa;this.jf=wa;this.foa=Xa;this.Pc=lb;this.CJ=Lb;this.Rfa=kc;this.hd=lc;this.Xf=Ec;this.nH=Jc;this.Rd=Dc;this.vk=Wd;this.zh=
xe;this.GC=Sd;this.poa=Pe;this.lfa=Ue;this.qd=Ef;this.Ofa=dg;this.jk=Mg;this.ks=Bg;this.aTh=Lf;this.wCd=mh;this.Ir=Fg;this.Wc=ii;this.nbf=0;this.p2e=!1;this.zyj()}PR(a){this.Pe=a}get RYa(){return this.uga||(this.uga=hb.a.instance.pb("Box4.ITextFormattingCommands"))}irl(){Oe.c(18437507,306,100,"TypingProcessInternalCalled");const a=this.Wc.Knb();try{this.DUc=0;if(this.Pe.Drk.rql()||2!==this.jf.mode||!this.jf.isActive||u.AFrameworkApplication.Xg||!this.Lb.xg||this.Dtd.correctBadImeState())return;this.Pi.updateCaretPosition(this.jf.mode,
this.Lb.Di);this.e1a.VSe();this.lmi();this.ap.raiseEvent(Ae.a.typingProcess);if(!this.Lb.gOa||2===Gb.App.mode&&this.Ir.isComposing)return;const b=new Cm(this.kY.ira(this.rU.V7));if(this.mtc.WAk(b))return;b.xRc||(this.jf.X9(!0),b.oUg=!0);this.dBk(b);if(!this.Lb.rSa(this.jf.mode))return;const c=this.Lb.lV.$a;this.Wc.Zf&&(c.gBb=this.Pc.Oa.kb.Ua.Qa);b.oUg&&H.a.instance.ga(50)&&this.foa.value&&this.foa.value.Qv&&this.Pc.nSb();if(b.Ose){try{this.Rfa.bBb()}catch(f){this.hd.Tb("PossibleEditSurfaceIncorrectSize",
{["Reason"]:"MirrorToPageViewCrash"}),this.Xf.l++,this.nH.hs(!1,!1)}this.ks.OX();this.Ir.rDa&&(this.nH.hs(!0,!0),this.Eki())}}finally{a&&a.dispose()}Oe.c(18437510,306,100,"TypingProcessInternalExited")}Eki(){Gb.App.Fb.srj&&Gb.App.Fb.iWk()}MMa(a){this.mtc.W5g(a);this.whb||(this.whb=!0,this.Rd.Gb(this.Vkd))}VDi(){if(!this.vk.A1&&!this.vk.lqa)return!1;const a=!this.foa.value||this.foa.value.amIAlone?qj.Tij:qj.Sij,b=this.PMb();-1===this.vk.YUc&&(this.vk.YUc=b);return b-this.vk.YUc<a?(this.Rd.Gb(this.Vkd),
this.whb=!0):!1}typingProcess(){if(this.whb&&(this.whb=!1,this.nbf++,!this.Rd.Rv&&this.Lb.rSa(this.jf.mode)&&!(this.CJ&&this.CJ.C7a()||this.VDi()))){var a=this.hd.Bp(C.a.typingProcess);this.irl();a.end();this.p2e||this.nbf!==qj.fki||((a=hb.a.instance.La("Common.ISystemInitiatedFeedback"))&&el(a),this.p2e=!0)}}lmi(){if(this.Ir.rDa){if(this.zh.Tzf())if((this.qd.dF||this.qd.$n)&&this.GC.a6){const a=this.Pi.d7(this.jf.mode,this.Lb.Di);this.GC.Cfb(!1,this.Lb.Di,this.zh);this.Pi.fS(a,this.Lb.Nh)}else this.GC.Cfb(!1,
this.Lb.Di,this.zh);this.aTh.$li(this.Lb.Nh.Is,this.poa,this.Lb.Nh,this.Pi.d7(this.jf.mode,this.Lb.Di),this.Ir.rDa);this.wCd.hji(this.Lb.Di,this.jf.mode,this.Lb.Nh);this.wCd.iCk(this.zh,this.Lb.Nh,this.jf.mode,this.Lb.Di);this.zh.jNk();this.wCd.eNk(this.zh,this.jf.mode,this.Lb.Di,this.Lb.Nh)}}dBk(a){this.lfa.DQ?(this.lfa.Guk(),a.Ose=!1):this.Ofa.instance&&this.Ofa.instance.E3d()&&!this.qd.QHb&&(this.Ir.rDa&&this.RYa?(this.d9h(a.kb),a.Ose=!1):this.Ofa.instance.kXa())}d9h(a){if(this.RYa&&this.Ofa.instance){this.Ofa.instance.freeze();
var b=ld.a.instance.Oa.kb,c=this.jk.je(15);c.fd(this.Lb.xg.node);a=nd.SelectionFactory.PM(a,b.Ua);this.RYa.ZFb(a.Ua,!0);this.Ofa.instance.BPe();this.Ofa.instance.kXa();this.Lb.Nh&&this.Pc.setSelection(this.kY.ira(this.rU.V7));c.dispose();this.jf.X9(!0);this.nH.hs(!0,!1)}}zyj(){let a=1;n.a.$n&&(a=u.AFrameworkApplication.fa.Ec("Box4TypingTaskTimeEdge",1));this.Vkd=new He.a(0,1,a,()=>{this.typingProcess()},25)}dispose(){this.Vkd=null}Toh(a){return this.qd.N7&&a?this.lfa.DQ||this.DUc>qj.Cbk||this.Ofa.instance&&
this.Ofa.instance.E3d()||this.GC.a6?!0:!1:!1}}qj.Cbk=7;qj.Sij=250;qj.Tij=2E3;qj.fki=500;Object(e.a)(qj,"TypingProcessManager",null,[1407,106]);class ck{constructor(){this.Pa=new qd.a}uEk(a){this.Pa.raiseEvent("OnDismissPasteFloatie",a)}AEk(){this.Pa.raiseEvent("OnExpandMenuPasteFloatie")}UBe(a){this.Pa.raiseEvent("OnPastedContentUpdated",a)}nGk(a){this.Pa.raiseEvent("OnShowPasteFloatie",a)}}Object(e.a)(ck,"PasteFloatieEventSource",null,[1404,1405,1406]);var Lk=d(855),Rg=d(129),mg=d(310),Dj=d(390),
kk=d(221),qn=d(811);class yk{constructor(){this.Da=null}get name(){return"Box4.ContentEditableView"}Wb(a){this.Da=a;a.register(im.a,"Box4.TextNodeCombiner").as("Box4.ITextNodeCombiner").ma().na(()=>new im.a);a.register(ug,"Box4.ContentEditableDomFactory").as("Box4.IContentEditableDomFactory").ma().na(()=>new ug);a.register(xf,"Box4.EventFrequencyTracker").ma().na(()=>new xf);a.register(jd,"Box4.CevUsageDataTracker").ma().na(()=>new jd);a.register($c,"Box4.ContentEditableViewEventSource").ma().na(()=>
new $c);a.register(jc,"Box4.CurrentlyActiveContentSpans").as("Box4.ICurrentlyActiveContentSpans").ma().na(()=>new jc(Sa.a.instance,eg.a.instance.tXd(),a.resolve("Box4.TextNodeCombiner")));a.register(ij,"Box4.OriginalElementContentArray").as("Box4.IOriginalElementContentArray").ma().na(()=>new ij(Sa.a.instance,eg.a.instance.tXd(),mf.instance,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Wi,"Box4.EditingDomManager").as("Box4.IEditingDomManager").ma().na(()=>new Wi);a.register(wh,
"Box4.EditStateEventManager").as("Box4.IEditStateEventManager").ma().na(()=>new wh(a.resolve("Box4.IEditingDomManager")));a.register(Na,"Box4.ContentEditableViewPaddingManager").as("Box4.IContentEditableViewPaddingManager").ma().na(()=>new Na(a.resolve("Box4.EditStateEventManager"),Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.EditingDomManager"),a.resolve("Common.IAppSettingsManager").ka("RemovePaddingHighlightEnabled")));a.register(1387,"Box4.ITypingLogger").ma().na(()=>
new qg(a.Be("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ContentEditableViewEventSource"),pa.InteractiveViewManager.instance,a.resolve("Box4.EditStateEventManager"),a.resolve("Common.IAppSettingsManager").ka("QoETypingImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("QoECharCountIsEnabled")));a.register(Bh,"Box4.CaretPositionManager").as("Box4.ICaretPositionManager").ma().na(()=>new Bh(a.Be("Box4.ITextNodeCombiner"),Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,
a.resolve("Box4.EditingDomManager"),mf.instance,Cb.a.instance,pa.InteractiveViewManager.instance,u.AFrameworkApplication.ue,Cb.a.instance.Ki,Lk.a.instance,a.resolve("Common.IScrollLockFactory"),a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Box4.ITypingLogger")));a.register(kg,"Box4.ContentEditableViewFocusHelper").as("Box4.IContentEditableViewFocusHelper").ma().na(()=>new kg(a.resolve("Box4.EditingDomManager"),pa.InteractiveViewManager.instance,a.resolve("Box4.IExternalSelectionManager"),
Cb.a.instance.Ki,rc.a.instance,Cb.a.instance,v.FocusManager.instance()));a.register(Af,"Box4.ReadOnlyObjectsCleaner").ma().na(()=>new Af(Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.CaretPositionManager"),mf.instance,Cb.a.instance));a.register(Zl,"Box4.StrayTextCleanupUtils").ma().na(()=>new Zl(u.AFrameworkApplication.fa,a.resolve("Box4.CaretPositionManager"),Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH));a.register(1388,"Box4.IContentEditableViewContentControlHelper").ma().na(()=>
new qh(Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,Cb.a.instance.Ki,mf.instance,pa.InteractiveViewManager.instance,a.resolve("Box4.IParagraphReader")));a.register($e,"Box4.ActiveContentSpansPersistanceManager").as("Box4.IActiveContentSpansPersistanceManager").ma().na(()=>new $e(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.CevUsageDataTracker").JH,Sa.a.instance,a.pb("Box4.IHyperlinkEditor"),
Cb.a.instance,a.resolve("Box4.IContentEditableViewContentControlHelper"),Lk.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Common.IAppSettingsManager")));a.register(Jh,"Box4.CevViewContentManager").as("Box4.ICevViewContentManager").ma().na(()=>new Jh(a.La("Common.ITypingSpeedMeterProvider"),pa.InteractiveViewManager.instance));a.register(qb,"Box4.ContentEditableViewTypingState").ma().na(()=>new qb(u.AFrameworkApplication.Ta));a.register(Yf,"Box4.ContentEditableHtmlStructureUtils").ma().na(()=>
new Yf(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ContentEditableViewTypingState")));a.register(dl,"Box4.SequenceCodeHelper").ma().na(()=>new dl(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IConstantsProvider").Fjh));a.register(Ff,"Box4.SelectContentHelper").ma().na(()=>new Ff(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.CevUsageDataTracker").JH,Sa.a.instance,a.Be("Box4.ITextNodeCombiner"),
ld.a.instance,a.resolve("Box4.ICaretPositionManager"),mf.instance,Cb.a.instance,bd.EventHandlerManager.instance,mg.a.instance,pa.InteractiveViewManager.instance,Cb.a.instance.Ki,a.resolve("Common.ScrollLockFactory"),Lk.a.instance,a.resolve("Box4.IParagraphReader"),Ib.ListReader.Lw,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Common.IAppSettingsManager").ka("FixUpEmptySpanInSelectionBeginIsEnabled")));a.register(vi,"Box4.EditingDomDisplayManipulator").ma().na(()=>new vi(a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.SelectContentHelper"),u.AFrameworkApplication.fa,pa.InteractiveViewManager.instance));a.register(Yh,"Box4.EditViewStateManager").as("Box4.IEditViewStateManager").ma().na(()=>new Yh(a.resolve("Box4.ContentEditableViewEventSource")));a.register(Ig,"Box4.InteractiveViewSynchronizer").ma().na(()=>new Ig(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CevUsageDataTracker").JH,Sa.a.instance,
Cb.a.instance.Ki,a.resolve("Box4.Graph.IGraphIteratorFactory"),mf.instance,pa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager")));a.register(wb,"Box4.CurrentEditSelectionProvider").ma().na(()=>new wb(a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CevUsageDataTracker").JH,Sa.a.instance,mf.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),Cb.a.instance.Ki,a.resolve("Box4.IContentEditableViewContentControlHelper")));
a.register(tg,"Box4.BackspaceInBrowserHandler").ma().na(()=>new tg(a.resolve("Box4.CurrentEditSelectionProvider"),Cb.a.instance.Ki,Qg.a.instance,mg.a.instance,a.resolve("Box4.IExternalSelectionManager"),kk.a.instance,u.AFrameworkApplication.fa.ka("PPTLineBoxEnabled"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IHyperlinkStrategy"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.La("Box4.IAutoCorrectScheduler"):null));a.register(rh,"Box4.OvertypeDomPreparer").ma().na(()=>
new rh(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableViewPaddingManager"),ld.a.instance,Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,mf.instance,Cb.a.instance.Ki,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Qc,"Box4.CutCopyHandler").as("Box4.ICutCopyHandler").ma().na(()=>new Qc(mg.a.instance,ld.a.instance,Sa.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.EditStateEventManager"),pa.InteractiveViewManager.instance,
a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ICevViewContentManager"),Cb.a.instance,a.resolve("Box4.SelectContentHelper"),new le.a(()=>Gb.App.Fb.Ed),a.La("Box4.IClipboardCommands"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(ck,"Box4.PasteFloatieEventSource").as("Box4.IPasteFloatieEventSource").as("Box4.IPasteFloatieEventHandler").as("Box4.IPasteFloatieEventNotifier").ma().na(()=>
new ck);a.register(tc,"Box4.BackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventNotifier").ma().na(()=>new tc);a.register(Kf,"Box4.BoundsSynchronizer").as("Box4.IBoundsSynchronizer").ma().na(()=>new Kf(a.La("Box4.IListMarkerUtility"),a.resolve("Box4.IEditingDomManager"),a.La("Common.IZoomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),Cb.a.instance,pa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),
a.resolve("Box4.IRotatingCoordinateConverter")));a.register(zg,"Box4.EditingSurfaceStateManager").ma().na(()=>new zg);a.register(Rj,"Box4.EditingModeTransitionManager").as("Box4.IEditingModeTransitionManager").ma().na(()=>new Rj(a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.EditingSurfaceStateManager"),u.AFrameworkApplication.ue,a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),new le.a(()=>Gb.App.Fb.Ed),Cb.a.instance,a.resolve("Box4.IContentEditableViewPaddingManager"),ld.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),pa.InteractiveViewManager.instance,mg.a.instance,a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Pi,"Box4.ParagraphOverlayPositioner").ma().na(()=>
new Pi(a.resolve("Box4.IEditingDomManager"),new qn.a,pa.InteractiveViewManager.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IParagraphOverlayControlRenderer")));a.register(ci,"Box4.ContentEditableViewDebugLogger").ma().na(()=>new ci);a.register(dh,"Box4.ImeRecoveryUtils").ma().na(()=>new dh(Cb.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),
Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.ContentEditableViewDebugLogger"),Lk.a.instance));a.register(si,"Box4.AutocorrectActionExecutor").ma().na(()=>new si(a.La("Box4.IAutoCorrectScheduler"),a.La("Box4.IAutoCorrectRules"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.CaretPositionManager"),
a.Be("Box4.IUndoManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.Graph.IGraphTransactionFactory"),ld.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(Yl,"Box4.PasteHandler").as("Box4.IPasteHandler").ma().na(()=>new Yl(a.resolve("Common.IAppSettingsManager"),u.AFrameworkApplication.ue,Sa.a.instance,
a.resolve("Box4.Graph.IGraphTransactionFactory"),ld.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),pa.InteractiveViewManager.instance,Cb.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.AutocorrectActionExecutor"),new le.a(()=>Gb.App.Fb.Ed),a.La("Box4.IClipboardCommands"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IFileReaderHelperFactory"),
a.resolve("Common.IDelayOperationFactory"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.IProcessImageStrategy"),u.AFrameworkApplication.Ta,pd.a.get_instance(),()=>new Oa.a,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"),Gb.App.instance.I3b,Gb.App.instance.OGb));a.register(Vi,"Box4.ContentEditableViewCursorManager").ma().na(()=>new Vi(pa.InteractiveViewManager.instance,Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,Cb.a.instance.Ki,ld.a.instance,
mg.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),new le.a(()=>Gb.App.Fb.Ed),u.AFrameworkApplication.Ta,a.resolve("Box4.IEditViewStateManager"),u.AFrameworkApplication.ue,Cb.a.instance,a.resolve("Box4.ICaretPositionManager"),mf.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),
new jb,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.pb("Box4.CharacterPointConverter")));a.register(pj,"Box4.SelectionChangeHandler").as("Box4.ISelectionChangeHandler").ma().na(()=>new pj(a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.ue,Lk.a.instance,mf.instance,ld.a.instance,a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.ContentEditableViewCursorManager"),Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,new le.a(()=>Gb.App.Fb.Ed),Cb.a.instance.Ki,a.resolve("Box4.ContentEditableHtmlStructureUtils")));a.register(gj,"Box4.HybridTransitionManager").as("Box4.IHybridTransitionManager").ma().na(()=>new gj(a.resolve("Box4.OvertypeDomPreparer"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.EditStateEventManager"),a.Be("Box4.IUndoManager"),a.resolve("Box4.EditingDomDisplayManipulator"),
a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.CevViewContentManager"),pa.InteractiveViewManager.instance,u.AFrameworkApplication.ue,new le.a(()=>Gb.App.Fb.Ed),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),ld.a.instance,Qg.a.instance));a.register(Wb,"Box4.CompositionStateManager").ma().na(()=>
new Wb(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.HybridTransitionManager")));a.register(Di,"Box4.ImeManager").ma().na(()=>new Di(a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),pa.InteractiveViewManager.instance));a.register(Qe,"Box4.DragStateManager").ma().na(()=>new Qe(Cb.a.instance));a.register(jm,"Box4.TouchEventProcessor").ma().na(()=>
new jm(Cb.a.instance,a.resolve("Box4.ContentEditableViewFocusHelper"),pa.InteractiveViewManager.instance,mg.a.instance));a.register(bg,"Box4.AppFrameResizeEventProcessor").ma().na(()=>new bg(a.resolve("Box4.BoundsSynchronizer")));a.register(Oc,"Box4.OnScrollProcessor").ma().na(()=>new Oc(a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer")));a.register(bk,"Box4.EditingSurfaceEventHandlerUtils").ma().na(()=>
new bk(Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.IEditingModeTransitionManager")));a.register(ie,"Box4.DragEventsProcessor").ma().na(()=>new ie(Cb.a.instance,a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils")));a.register(Ld,"Box4.DoubleClickProcessor").ma().na(()=>new Ld(a.resolve("Box4.CaretPositionManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),pa.InteractiveViewManager.instance));a.register(Cd,
"Box4.DomChangeEventProcessor").ma().na(()=>new Cd(Cb.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),Sa.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(Sm,"Box4.TextInputHandlerUtils").ma().na(()=>new Sm(a.resolve("Box4.IContentEditableViewFocusHelper"),Cb.a.instance,bd.EventHandlerManager.instance,
a.resolve("Box4.ContentEditableViewTypingState"),new le.a(()=>Gb.App.Fb.Ed),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(ti,"Box4.ContentEditableViewGraphUpdater").ma().na(()=>new ti(nc.a.instance,a.resolve("Box4.EditingModeTransitionManager"),Sa.a.instance,ld.a.instance,a.resolve("Box4.IExternalSelectionManager"),mg.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.Graph.GraphIteratorFactory"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.CharacterPropertiesEditor"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),
a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.HybridTransitionManager"),u.AFrameworkApplication.ue,Cb.a.instance,a.La("Box4.IInsertionPointFormatting"),a.resolve("Box4.IActiveContentSpansPersistanceManager"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.Proofing.IModifiedRangeEditor"),a.pb("Box4.CharacterPointConverter"),a.resolve("Box4.ITypingLogger")));a.register(da,"Box4.KeyEntryProcessor").ma().na(()=>
new da(mf.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.CevUsageDataTracker").JH,Sa.a.instance,Cb.a.instance.Ki,a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),mg.a.instance,a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.EditViewStateManager")));a.register(kd,"Box4.KeyQueueProcessor").ma().na(()=>new kd(a.resolve("Box4.KeyEntryProcessor"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),mg.a.instance,ld.a.instance,a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ICaretPositionManager")));a.register(qj,"Box4.TypingProcessManager").as("Box4.ITypingProcessManager").ma().na(()=>new qj(kb.a.oj,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ImeRecoveryUtils"),
a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.EditViewStateManager"),new le.a(()=>Gb.App.Eh),ld.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.ContentEditableViewGraphUpdater"),
u.AFrameworkApplication.ue,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.AutocorrectActionExecutor"),Cb.a.instance,a.La("Box4.IInsertionPointFormatting"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.ReadOnlyObjectsCleaner"),a.resolve("Box4.StrayTextCleanupUtils"),a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Oi,"Box4.OvertypeUtils").ma().na(()=>new Oi(new Lc(u.AFrameworkApplication.ue),a.resolve("Box4.EditingModeTransitionManager"),Cb.a.instance,ld.a.instance,a.resolve("Box4.ITypingLogger"),mg.a.instance,new le.a(()=>Gb.App.Fb.Ed),pa.InteractiveViewManager.instance,a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.HybridTransitionManager"),Cb.a.instance.Ki,a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(bh,"Box4.ContentEditableViewFloatieHandler").ma().na(()=>new bh);a.register(Ac,"Box4.KeyUpProcessor").ma().na(()=>new Ac(Sa.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ICevViewContentManager"),new le.a(()=>Gb.App.Fb.Ed),
a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.TypingProcessManager")));const b=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TableEditingSelectIsEnabled");a.register(qc,"Box4.KeyPressProcessor").ma().na(()=>new qc(Cb.a.instance,Lk.a.instance,Sa.a.instance,a.resolve("Box4.ISelectionChangeHandler"),new le.a(()=>
Gb.App.Fb.Ed),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.IHybridTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),ld.a.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.AutocorrectActionExecutor"),mf.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),new le.a(()=>
Gb.App.Eh),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.La("Common.ITypingSpeedMeterProvider"),b,Rg.ContextSetEditor.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.pb("Common.IEventTimingMeter")));a.register(ta,"Box4.KeyDownProcessor").ma().na(()=>new ta(a.La("Common.ITypingSpeedMeterProvider"),Cb.a.instance.Ki,u.AFrameworkApplication.ue,
a.resolve("Box4.IEditingDomManager"),Sa.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.ITypingLogger"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICaretPositionManager"),Cb.a.instance,Lk.a.instance,a.resolve("Box4.CurrentEditSelectionProvider"),mg.a.instance,a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.ContentEditableViewGraphUpdater"),new le.a(()=>
Gb.App.Eh),ld.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.CompositionStateManager"),a.Be("Box4.IUndoManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CharacterPropertiesEditor"),new le.a(()=>Gb.App.Fb.Ed),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ImeManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.BackspaceInBrowserHandler"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing"),
a.resolve("Box4.Graph.IGraphTransactionFactory"),u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.pb("Common.IEventTimingMeter"),a.resolve("Box4.IRotatingCoordinateConverter"),Dj.a.instance,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.IBackspaceDeleteEventSource"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?
a.La("Box4.IAutoCorrectScheduler"):null,u.AFrameworkApplication.fa,a.pb("Box4.IHyperlinkEditor")));a.register(Bj,"Box4.ContentEditableViewOnAfterValidateHandler").ma().na(()=>new Bj(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),pa.InteractiveViewManager.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),
a.resolve("Box4.IContentEditableViewPaddingManager"),Cb.a.instance,a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.Be("Box4.ITextNodeCombiner"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.ParagraphOverlayPositioner"),ld.a.instance,Cb.a.instance.Ki,a.resolve("Box4.SelectContentHelper"),new le.a(()=>Gb.App.Fb.Ed),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.pb("Box4.ITabRenderer"),a.resolve("Box4.IPasteFloatieEventSource"),a.pb("Box4.IFeatureHelper")));a.register(ui,"Box4.ContentEditableViewOnBeforeValidateHandler").ma().na(()=>new ui(a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditStateEventManager")));
a.register(hh,"Box4.CompositionEventProcessor").ma().na(()=>new hh(a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.TextInputHandlerUtils"),Sa.a.instance,a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ITypingLogger"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewEventSource"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(Cj,"Box4.TextInputEventProcessor").ma().na(()=>new Cj(a.resolve("Box4.TextInputHandlerUtils"),a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils"),Sa.a.instance,a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.EditingModeTransitionManager"),ld.a.instance,a.resolve("Box4.HybridTransitionManager"),Cb.a.instance,a.resolve("Box4.EditViewStateManager"),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.ICevViewContentManager"),a.pb("Box4.ITabRenderer"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(yc,"Box4.LostFocusEventProcessor").ma().na(()=>new yc(a.resolve("Box4.ContentEditableViewGraphUpdater")));
a.register(Ci,"Box4.EditingSurfaceEventHandlerManager").ma().na(()=>new Ci(u.AFrameworkApplication.ue,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.KeyUpProcessor"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.KeyPressProcessor"),a.resolve("Box4.KeyDownProcessor"),a.resolve("Box4.CompositionEventProcessor"),a.resolve("Box4.TextInputEventProcessor"),a.resolve("Box4.DragEventsProcessor"),a.resolve("Box4.PasteHandler"),a.resolve("Box4.CutCopyHandler"),
a.resolve("Box4.DomChangeEventProcessor"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.TouchEventProcessor"),a.resolve("Box4.DoubleClickProcessor"),a.resolve("Box4.OnScrollProcessor"),a.resolve("Box4.AppFrameResizeEventProcessor"),a.resolve("Box4.LostFocusEventProcessor"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.CaretPositionManager")));a.register(Bi,"Box4.ContentEditableViewDisposer").ma().na(()=>new Bi(a.resolve("Box4.IOriginalElementContentArray"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CurrentlyActiveContentSpans"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.CevUsageDataTracker").JH,a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager")));a.register(jk,"Box4.TypingActionOperationFactory").as("Box4.ITypingActionOperationFactory").ma().na(()=>new jk);a.register(1389,"Box4.IContentEditableModeHelper").ma().na(()=>new Jd);a.register(ih,"Box4.ContentEditableView").as("Box4.IEditingView").ma().na(()=>
new ih(pa.InteractiveViewManager.instance,ld.a.instance,new le.a(()=>Gb.App.Fb.Ed),a.La("Common.IActivityAggregationInfo"),a.La("Common.IZoomManager"),u.AFrameworkApplication.Ta,a.resolve("Box4.IHtmlViewRootFactory"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.IPasteHandler"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewFloatieHandler"),
a.resolve("Box4.ContentEditableViewOnAfterValidateHandler"),a.resolve("Box4.ContentEditableViewOnBeforeValidateHandler"),a.resolve("Box4.EditingSurfaceEventHandlerManager"),a.resolve("Box4.ContentEditableViewDisposer"),a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.IContentEditableDomFactory"),Gb.App.cJa,a.resolve("Box4.IContentEditableModeHelper")))}init(){this.Da.resolve("Box4.EditingModeTransitionManager").RTb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.BoundsSynchronizer").RTb(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.ImeRecoveryUtils").RTb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.AutocorrectActionExecutor").PR(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewCursorManager").Gbi(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.SelectionChangeHandler").PR(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.HybridTransitionManager").PR(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewGraphUpdater").PR(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.TypingProcessManager").PR(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnAfterValidateHandler").PR(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnBeforeValidateHandler").PR(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.EditingSurfaceEventHandlerManager").PR(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.CompositionEventProcessor").PR(this.Da.resolve("Box4.ContentEditableView"))}dispose(){}static main(){m.a.instance.Ac(new yk)}}
Object(e.a)(yk,"ContentEditableViewPackage",null,[2,3]);class rn{get name(){return"PowerPointWebEditor.AutoFit"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Ac(new rn)}}Object(e.a)(rn,"PPTWebEditorAutoFitPackage",null,[2,3]);class nl{constructor(a){this.yv=a}}Object(e.a)(nl,"DynamicScriptLoaderProvider",null,[1531]);var lk=d(344),Xi=d(230),Al=d(341);const Yi=(a,b)=>{var c=mk(b);c=a.identifier+c+".js";let f="";f=a.isLocalized?f+(u.AFrameworkApplication.lcid+"/"):f+km(b);return f+c},mk=()=>u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?
"":u.AFrameworkApplication.fa.Aw("IsServerFlavorDebug")?u.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"":".min":".min",km=a=>a&&u.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")&&!u.AFrameworkApplication.fa.ka("AppChromeOverrideIsCombinedBundle")&&!u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?"exp/":"",zk=(a="anonymous",b="dynamicScriptLoaderDependencies")=>{const c={resolveScript:f=>{var l=lk.AppChromeOverrideUtilities.gug(c.knownScripts,f.identifier);if(lk.AppChromeOverrideUtilities.isEnabled&&
l)l=f.isLocalized?lk.AppChromeOverrideUtilities.lag(u.AFrameworkApplication.lcid):lk.AppChromeOverrideUtilities.nFb,f.isLocalized||(l+=km(!0)),f=l+f.identifier+lk.AppChromeOverrideUtilities.RIc+".js";else if(Al.a.instance.isEnabled){var x=u.AFrameworkApplication.Hea;f=Yi(f,l);Al.a.instance.isEnabled&&(l=Al.a.instance.aZd(u.AFrameworkApplication.Y_+f))&&(x=l+u.AFrameworkApplication.Y_);Z.ULS.sendTraceTag(592228695,306,50,"Dynamic loading hashed resource for "+f);f=x+f}else if(x=mk(l),u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScriptUrlFromNameNewIsEnabled",!1))f.isLocalized?f=u.AFrameworkApplication.Fk(f.identifier,3):(f=km(l)+f.identifier,f=u.AFrameworkApplication.Fk(f+x+".js",5));else{var F=u.AFrameworkApplication.Hea;F=f.isLocalized?F+(u.AFrameworkApplication.lcid+"/"):F+km(l);f=F+f.identifier+x+".js"}return f},resolveSriHash:f=>{const l=lk.AppChromeOverrideUtilities.gug(c.knownScripts,f.identifier);Al.a.instance.isEnabled?(f=Yi(f,l),f=
Al.a.instance.xdj(u.AFrameworkApplication.Y_+f)):f=null;return f}};c.crossOriginAttributeValue=a;c.knownScripts=window[b];return c};var ya=d(26),sn=d(639);class Sj{constructor(){this.Dle=this.hda=this.K=null;this.lJg=this.qIg=!1}get name(){return"PowerPointWebEditor.DynamicScriptLoader"}Wb(a){if(!a)throw Error.argumentNull("container");this.K=a;this.hda=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");this.K.register(nl,"Common.DynamicScriptLoaderProvider").as("Common.IDynamicScriptLoaderProvider").ma().na(()=>
{var b=window.self.EarlyDynamicScriptLoader;if(void 0===b||null===b){b=zk();if(sn.a.OGj){const c=b.resolveScript;b.resolveScript=f=>{let l=sn.a.rRe(f.identifier+(lk.AppChromeOverrideUtilities.isEnabled?lk.AppChromeOverrideUtilities.RIc:".min")+".js");l||(l=c(f));return l}}this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseManagedScriptResourceLoading&&(b.loadScriptHandler=Object(D.a)(this,this.loadScript,"loadScript"));return new nl(new dynamicScriptLoader.DynamicScriptLoader(b))}u.AFrameworkApplication.fa.ka("EnableDefaultDSLImpl")||
b.ZUe&&b.ZUe(Object(D.a)(this,this.loadScript,"loadScript"));return new nl(b)});this.qIg=u.AFrameworkApplication.fa.ka("EarlyLazySprite");this.lJg=u.AFrameworkApplication.fa.ka("RibbonShimmerExperimentEnabled");u.AFrameworkApplication.fa.ka("LoadSLideGridJSEarly")&&Sj.Nic.push("slidegrid");Sj.Nic.push("comment-pane-strings");Sj.Nic.push("sharedcomments");Sj.Nic.push("floatingcontainermanager")}loadScript(a,b){let c=this.Dle;c&&c.isCompleted&&(this.Dle=c=null);const f=this.qIg&&Array.contains(Sj.Nic,
a),l=u.AFrameworkApplication.fa.ka("BootFilesInDelayScriptFactory")&&Array.contains(Sj.xWk,a)?this.hda.Jvi(b,Array.contains(Sj.phh,a),!(this.lJg&&Array.contains(Sj.SWk,a))):this.hda.jPd(b,null,Array.contains(Sj.phh,a));f||(this.Dle=l.HDa);return new Promise((x,F)=>{const R=Date.now(),fa=()=>{l.HDa.continueWith(wa=>{if(6===wa.status)x(a);else{let Xa=String.format("Failed to download the script with identifier: {0} at url: {1}.",a,b);wa.Ui&&(Xa+=" "+wa.Ui.message);F(Error.create(Xa))}});ya.a.J(540113033,
813,50,"LoadScript:: Identifier:{0}, DelayInMs:{1}",a,Date.now()-R);Xi.a.wx(l)};!c||f?fa():c.continueWith(()=>{fa()})})}init(){}dispose(){}}Sj.phh=["common","powerpoint-ribbon-intl","appChrome"];Sj.Nic="ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");Sj.xWk="common common50 ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");
Sj.SWk=["common","appchrome"];Object(e.a)(Sj,"DynamicScriptLoaderPackage",null,[2,3]);var Jl=d(163),Se=d(94),Te=d(626),fc=d(52),lm;(function(a){a[a.unknown=0]="unknown";a[a.orderlyShutdown=1]="orderlyShutdown";a[a.bootIncomplete=2]="bootIncomplete";a[a.podSessionRefreshed=3]="podSessionRefreshed";a[a.seamlessFailoverManager=4]="seamlessFailoverManager";a[a.inlineDocumentRepair=5]="inlineDocumentRepair"})(lm||(lm={}));Object(e.b)("RefreshDocTrigger",lm);var Mc=d(41),uf=d(84);class mm extends Sys.EventArgs{constructor(a,
b){super();this.yMj=b}}Object(e.a)(mm,"FailoverEventArgs",Sys.EventArgs,[]);var Nf=d(238),Yg=d(105);class Mk extends Yg.a{constructor(a){super();this.FailedMachineId=null;this.FailedMachineId=a}Ik(){return 61}}Object(e.a)(Mk,"CheckUnblockUIRequest",Yg.a,[]);var Fn=d(854),ba=d(28);class Bl{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe){this.eka=!1;this.jua=this.doe=this.gEa=this.mEa=this.VS=this.Vr=null;this.la=a;this.yb=b;this.W6j=c;this.Af=f;this.ra=l;this.Fa=x;this.ZB=F;
this.uXc=lc;this.U$a=Jc;this.vm=R;this.wZj=fa;this.ta=wa;this.Yb=Xa;this.T8=lb;this.me=Lb;this.Kd=kc;this.iEa=Ec;this.ia=Dc;this.UB=Wd;this.pp=xe;this.rVa=Sd;this.Yi=Pe;this.z0j=this.la.podsFailoverRefreshDocSlideDrawTimeoutInMS;this.g4j=this.la.podsLegacyFailoverRefreshDocSlideDrawTimeoutInMS}ub(){this.ia.pa(ba.a.jEb,fc.a.application,Object(D.a)(this,this.AJk,"refeshDoc"),64)}AJk(a,b,c,f,l){this.xRe(l.failedMachineId,l.isPlanedShutdown,"podSessionId"in l?l.podSessionId:"","isPodSessionRefreshed"in
l&&l.isPodSessionRefreshed?3:"fromSeamlessFailoverManager"in l?4:"fromInlineDocumentRepair"in l?5:0);return 32}get zi(){return this.Yb.zi}Bqa(a){a.F1b()&&a.Bqa()}xRe(a,b,c,f){if(!this.me.kd.hermesFailOverImprovementIsEnabled||this.U$a())return!1;if(this.eka||this.iEa.ksg)return!0;const l=this.zi;if(!(l&&l.ri&&l.ri.Dw&&l.ri.Dw.id!==Ga.a.nil&&l.contentReplicator&&this.ta.presentation&&this.ta.presentation.id.equals(Te.a.exe)))return!1;5===f&&this.Pzf();this.vm.pause();this.T8.suspend();this.ZB.Ld&&
this.ZB.Ld.endEditing(!1,14);this.ZB.forEach(Object(D.a)(this,this.Bqa,"ensureGraphUpdated"));l.pS(!0)&&l.oea();this.ra.setSelection(null);this.Fa.Ad();this.Vr=Mc.a.hm("RefreshDoc");this.Vr.Wa("IsPlanedShutdown",b.toString());this.Vr.Wa("PodSessionId",c);this.Vr.Wa("RefreshDocTrigger",lm[f]);ya.a.J(512360801,809,50,"DocRefreshHandler::TryRefreshDoc:ActionID:{0}; ActionDetails:{1}",this.Vr.actionId,this.Vr.tIb());this.VS=a;b?(this.mEa=new Date,this.iEa.Kph(),this.uXc.Gb(this.wOd())):this.Jah();this.UB.A9g(new mm(b,
!1));this.ta.presentation.ZEe();this.Af.blockContent(this.ta.presentation,"RefreshDoc",!0);ya.a.J(512360798,822,15,"DocRefreshHandler::TryRefeshDoc, Block Presentation");this.Kd.disabled=!0;return this.eka=this.me.y6a().W6c=!0}Pzf(){this.vm.isPaused&&(ya.a.J(512360797,801,50,"DocRefreshHandler::ActivateReplicationScheduler:  ReplicationScheduler was paused - UnPaused it"),this.vm.yhb());try{this.vm.qLf()}catch(a){ya.a.J(512360796,801,15,"DocRefreshHandler::ActivateReplicationScheduler CancelBlockedOperation failed. {0}",
a)}}wOd(){return this.gEa=new Nf.a(new Mk(this.VS),Object(D.a)(this,this.wue,"onCheckUnBlockUISuccess"),Object(D.a)(this,this.vue,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}Jah(){this.Vr.Wa("FailedMachineId",this.VS);this.doe=new Date;this.W6j.jEb(this.VS,this.Vr,!this.me.kd.refreshDocSynchronouslyIsEnabled,!1,Object(D.a)(this,this.RHi,"docRefreshSuccessCallback"),Object(D.a)(this,this.QHi,"docRefreshFailedCallback"));this.wZj.$ua()}wue(){this.iEa.gPc();this.Vr.Wa("DeploymengUIBlockingTime",
(+new Date-+this.mEa).toString());this.Vr.Wa("CheckUnblockUISucceeded","True");this.Jah()}vue(a){if(142===a.ServerError.Code)return ya.a.J(512360795,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.VS,+new Date-+this.mEa),this.uXc.Gb(this.gEa),!0;this.Vr.Wa("DeploymengUIBlockingTime",(+new Date-+this.mEa).toString());this.Vr.Wa("CheckUnblockUISucceeded","False");this.iEa.gPc();return this.k_g(a)}RHi(){this.pp.gGd(Object(D.a)(this,this.iwe,
"onSlideDrawComplete"));this.jua&&this.yb.Qg(this.jua);const a=this.Vr.mJ("RefreshDocTrigger");this.jua=new He.a(2,1,a&&1===a.length&&"podSessionRefreshed"===a[0]?this.z0j:this.g4j,Object(D.a)(this,this.onSlideDrawTimeout,"onSlideDrawTimeout"),90,"62");this.yb.Gb(this.jua);a&&1===a.length&&"inlineDocumentRepair"===a[0]&&this.Pzf()}QHi(a){return this.k_g(a)}iwe(){Z.ULS.sendTraceTag(512360794,821,50,"DocRefreshHandler::OnSlideDrawComplete");this.jua&&(this.yb.Qg(this.jua),this.jua=null);this.pp.xcd(Object(D.a)(this,
this.iwe,"onSlideDrawComplete"));this.Vr&&(this.Vr.Wa("ReStoreStatusAfterRefreshStartTime",Mc.a.Ye(new Date)),this.T8.resume(),this.Vr.Wa("SlideDrawResult","True"),this.Vr.Km("SlideDrawCompleteET",new Date),this.vm.isPaused&&this.vm.yhb(),this.Vr.Wa("LoadAndRenderTime",(+new Date-+this.doe).toString()),this.me.kd.GCe||this.me.y6a().bva(),this.Vr.Wa("ReStoreStatusAfterRefreshEndTime",Mc.a.Ye(new Date)),this.Wve(!0),this.rVa.Q9g(new Fn.a("DocRefresh")),this.Yi.Thb=2,u.AFrameworkApplication.zeb(uf.a.Mh(180),
Jl.a.unknown,Jl.a.bnc),Se.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null))}onSlideDrawTimeout(){this.pp.xcd(Object(D.a)(this,this.iwe,"onSlideDrawComplete"));this.jua&&(this.yb.Qg(this.jua),this.jua=null);Z.ULS.sendTraceTag(512360793,821,10,"DocRefreshHandler::OnSlideDrawTimeout");this.Vr.Wa("SlideDrawResult","False");this.Wve(!1);this.qSk()}qSk(){this.Kd.disabled=!1;u.AFrameworkApplication.Xo(uf.a.Mh(379));Se.Health.instance.recordQosError("RefreshDocTimeout",
["UnexpectedAppRefresh"],!1,!1,!0,!0,null);u.AFrameworkApplication.wu&&u.AFrameworkApplication.wu.Z6();this.ia.Ka(ba.a.refresh,2,{refreshtrigger:"DocRefreshHandler::ReportErrorAndRefreshPage"})}k_g(a){Z.ULS.sendTraceTag(512360792,821,50,"DocRefreshHandler:OnRefreshFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Fh);this.Wve(!1);return!1}Wve(a){this.eka=
!1;this.gEa=this.VS=null;this.doe=new Date(0);Mc.a.z5b=new Date;this.Vr&&(this.Vr.Wa("Result",a?"Success":"Failed"),this.Vr.finish(!0),this.Vr=null);this.Kd.disabled=!1;this.me.y6a().W6c=!1;this.Af.vO(this.ta.presentation)}}Object(e.a)(Bl,"DocRefreshHandler",null,[1254]);var Kg=d(151);class Bf{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.eka=!1;this.gEa=this.mEa=this.VS=this.Vr=null;this.ia=a;this.ni=b;this.Ci=c;this.Af=f;this.ra=l;this.Fa=x;this.vm=F;this.ta=R;this.T8=fa;this.iEa=wa;this.Xa=
Xa;this.la=lb;this.U$a=Lb;this.la.Usg&&this.Ci.tB(Object(D.a)(this,this.VA,"onSessionEnd"))}ub(){this.ia.pa(ba.a.failover,fc.a.application,Object(D.a)(this,this.glj,"handleFailover"),64)}VA(){this.vm.isPaused||this.vm.pause()}glj(a,b,c,f,l){if(1===c||this.U$a()||this.eka||this.iEa.ksg)return 32;this.VS=l;if(!this.VS)return 8;this.Vr=Mc.a.hm("SeamlessFailover");this.vm.pause();this.T8.suspend();this.ra.setSelection(null);this.Fa.Ad();this.Af.blockContent(this.ta.presentation,"SeamlessFailover",!0);
ya.a.J(37106114,822,15,"SeamlessFailoverHandler::HandleFailover, Block Presentation");this.mEa=new Date;this.iEa.Kph();this.Ci.A9g(new mm(!0,!0));u.AFrameworkApplication.wqb();this.ni.Yyc(this.wOd());this.eka=!0;return 32}wOd(){return this.gEa=new Nf.a(new Mk(this.VS),Object(D.a)(this,this.wue,"onCheckUnBlockUISuccess"),Object(D.a)(this,this.vue,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}wue(){this.iEa.gPc();this.Vr.Wa("DeploymengUIBlockingTime",(+new Date-+this.mEa).toString());
this.Vr.Wa("CheckUnblockUISucceeded","True");this.Vr.Wa("FailedMachineId",this.VS);this.Xa.Tqb=this.VS;this.YGk()}vue(a){if(142===a.ServerError.Code)return ya.a.J(22315610,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.VS,+new Date-+this.mEa),this.ni.Yyc(this.gEa),!0;this.Vr.Wa("DeploymengUIBlockingTime",(+new Date-+this.mEa).toString());this.Vr.Wa("CheckUnblockUISucceeded","False");this.iEa.gPc();return this.Gjk(a)}YGk(){this.Vr.Wa("ReStoreStatusAfterRefresh",
Mc.a.Ye(new Date));this.vm.yhb();this.T8.resume();this.cYg(!0);u.AFrameworkApplication.zeb(uf.a.Mh(180),Jl.a.unknown,Jl.a.bnc);Se.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}Gjk(a){Z.ULS.sendTraceTag(22315611,821,50,"SeamlessFailoverHandler:OnFailoverFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Fh);this.cYg(!1);
a.ServerError=Object.assign(new Kg.a,{Code:157,Source:0});return!1}cYg(a){this.eka=!1;this.gEa=this.VS=null;this.Vr&&(this.Vr.Wa("Result",a?"Success":"Failed"),this.Vr.finish(),this.Vr=null);this.Af.vO(this.ta.presentation)}dispose(){this.la.Usg&&this.Ci.gea(Object(D.a)(this,this.VA,"onSessionEnd"))}}Object(e.a)(Bf,"SeamlessFailoverHandler",null,[106]);var Ej=d(243),rj=d(103),dk=d(1111),Qi=d(284),sj=d(809),Nk=d(237),Dm=d(611);class Kl{constructor(a,b,c,f,l){if(!a)throw Error.argumentNull("actionManager");
this.ia=a;this.la=b;this.p8=c;this.KA=f;this.$b=l;this.O$a=!1}Lu(a,b=!1,...c){this.AXb.apply(this,[uf.a.Mh(a),this.p8.RMc(a),this.p8.E1d(a),this.p8.a_d(a),b].concat(c))}AXb(a,b,c,f,l=!1,...x){if(!Ej.a.Cw){var F=2,R=!1;if(a===uf.a.Mh(83))this.la.gNj&&(c=ResourceStrings.l_CannotPasteImageTitle,f=ResourceStrings.l_SuggestionToInsertPicture,F=3);else if(a===uf.a.Mh(8)||a===uf.a.Mh(256)||a===uf.a.Mh(257)||a===uf.a.Mh(291))F=0,R=!0;x&&0<x.length&&(f=String.format.apply(null,[f].concat(x)));this.Ts(new Dm.a(a,
c,f,b,F),l,R)}}Ts(a,b=!1,c=!1){let f=a.Mbd;var l=uf.a.zS(a.Lm)?Nk.a[uf.a.EM(a.Lm)]:"";ya.a.J(512497111,801,15,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}; ErrorName: {1}, SuppressErrorReporting: {2}, ShowFeedbackButtonEnabled: {3}, ClientActions - None: {4}, Dismiss: {5}, Close: {6}, OpenInClient: {7}, Refresh: {8}, HideFeedback: {9}, Repair: {10}",a.Lm,l,b,u.AFrameworkApplication.aE,0===f,!!(f&1),!!(f&2),!!(f&4),!!(f&8),!!(f&16),!!(f&64));if(this.P$k(a))ya.a.J(512497110,801,50,"ErrorDialog::ShowErrorDialog Skip showing error {0} to users.",
a.Lm);else{l=new rj.StandardDialog;var x=null,F=!1,R=this.$b.ka("UserCanWriteRelative");f&64&&ya.a.J(512497109,801,50,"ErrorDialog::ShowErrorDialog. User's Access level:{0}",this.$b.Ha("DocumentPermissions")||"");var fa=!1;f&64&&this.la.pptFileRecoveryEnabled&&(fa=!0);f&64&&!R&&ya.a.J(512497108,801,50,"ErrorDialog::ShowErrorDialog. We found a repairable error but user has no permission to write relative, but inline repair is enabled. Will try to repair.");!fa&&f&64&&(c=!1,f=this.gul(a));R=!!(f&4)&&
!(u.AFrameworkApplication.Exh||u.AFrameworkApplication.ZP);var wa=!!(f&2)&&u.AFrameworkApplication.Xba;c=c?ResourceStrings.l_OpenInApp:ResourceStrings.L_OpenInPowerPoint;l.hr=wa||!!(f&1);f&8?(l.vd=0,x=Object(D.a)(this,this.Sbd,"refreshActionHandler"),Array.contains(this.la.hermesRefreshErrorSuppressionList,a.Lm.toString())?l.mO(dk.a.g2(a.title),dk.a.g2(a.message),x):(ya.a.J(512497107,801,50,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}.",a.Lm),l.Re(1,ResourceStrings.L_Refresh),l.Vx(a.Lm,dk.a.g2(a.title),
dk.a.g2(a.message),x,b)),F=this.O$a=!0):fa?(ya.a.J(512497106,801,50,"ErrorDialog::ShowErrorDialog. We met an error need to repair. ErrorCode: {0}",a.Lm),this.ia.processAction(ba.a.repair,2)):wa&&R?(l.vd=4,l.Re(1,c),l.Re(2,ResourceStrings.L_Close),x=Object(D.a)(this,this.yqk,"openOrCloseActionHandler"),this.O$a=!0):R?(l.vd=0,l.Re(1,c),x=Object(D.a)(this,this.M8c,"openInClientActionHandler"),this.O$a=!0):wa?(l.vd=0,l.Re(1,ResourceStrings.L_Close),x=Object(D.a)(this,this.Oni,"closeActionHandler"),this.O$a=
!0):(c=!!(f&1)||0===f,l.hr=c,l.vd=c?0:5);F||fa||(f&16&&f&32?(b||u.AFrameworkApplication.Xo(a.Lm),l.oYa=!1,l.Yw(dk.a.g2(a.title),dk.a.g2(a.message),a.icon,x)):l.Vx(a.Lm,dk.a.g2(a.title),dk.a.g2(a.message),x,b));this.O$a&&this.KA&&this.KA.closeSession(4);this.O$a?Se.Health.instance.recordQosError(uf.a.Qaa(a.Lm),["NonDismissibleDialog"],!1,!1,!0,!0,null):Se.Health.instance.recordQosError(uf.a.Qaa(a.Lm),["DismissibleDialog"],!1,!1,!0,!1,null)}}get HSc(){return this.O$a}gul(a){ya.a.J(512497105,801,15,
"ErrorDialog::UpdateErrorWhenRepairDisabled. We found a repairable error but user has no permission to repair. Falling back to generic error dialog.");a.message=a.Lm===uf.a.Mh(8)||a.Lm===uf.a.Mh(43)?ResourceStrings.errorMessage_EditSlideCorruption:ResourceStrings.errorMessage_CannotOpenDocument;a.title=ResourceStrings.errorTitle_PowerpointStandard;a.icon=2;return 6}M8c(a,b){ya.a.J(512497104,801,50,"Button={0};DontShowAgain={1}",a,b);1===a&&this.l7g()}yqk(a,b){ya.a.J(512497103,801,50,"Button={0};DontShowAgain={1}",
a,b);1===a?this.l7g():this.ia.Ka(ba.a.frb,2,Qi.c)}Oni(a,b){ya.a.J(512497102,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ka(ba.a.frb,2,Qi.c)}Sbd(a,b){ya.a.J(512497101,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ka(ba.a.refresh,2,{refreshtrigger:"ErrorDialog::RefreshActionHandler"})}l7g(){(new sj.a(C.a.openInClient)).Z6d()}P$k(a){return a.Lm===uf.a.Mh(83)&&(u.AFrameworkApplication.mN("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorCannotPastePictureNotFoundSettings"),this.la.Ndl)||
a.Lm===uf.a.Mh(56)&&(u.AFrameworkApplication.mN("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorLocalChangeLostCoauthSettings"),this.la.Odl)?!0:!1}}Object(e.a)(Kl,"ErrorDialog",null,[1252]);var tj=d(278),Le=d(124),$l=d(507),Ke=d(971),ee=d(40);class Ne extends Sys.EventArgs{constructor(){super();this.$za=this.xB=0;this.message=this.title=null}}Object(e.a)(Ne,"BeforeHandleErrorEventArgs",Sys.EventArgs,[]);class O extends Ne{constructor(a){super();this.ePa=null;this.errorCode=a;this.xB=0}}Object(e.a)(O,
"OnBeforeHandleClientErrorEventArgs",Ne,[]);class ca extends Ne{constructor(){super();this.xB=0}}Object(e.a)(ca,"OnBeforeHandleServerErrorEventArgs",Ne,[]);class Ta extends Sys.EventArgs{constructor(a,b,c){super();this.JN=a;this.s0j=b;this.oh=c}get podSessionId(){return this.JN}get xIc(){return this.s0j}get errorCode(){return this.oh}}Object(e.a)(Ta,"PodSessionUnavailableEventArgs",Sys.EventArgs,[]);class xb{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){this.sje=!1;this.w1j=[8];this.Lje={["Generic"]:CommonUIStrings.l_DecryptSkipReasonGeneric,
["DecryptionDefered"]:CommonUIStrings.l_DecryptSkipReasonDecryptionDefered,["EncryptedOutsideSharepoint"]:CommonUIStrings.l_DecryptSkipReasonEncryptedOutsideSharepoint,["UnsupportedMsoDataStore"]:CommonUIStrings.l_DecryptSkipReasonUnsupportedMsoDataStore,["PasswordProtected"]:CommonUIStrings.l_DecryptSkipReasonPasswordProtected,["ContentExpiryLabel"]:CommonUIStrings.l_DecryptSkipReasonContentExpiryLabel,["InvalidLabelOwner"]:CommonUIStrings.l_DecryptSkipReasonInvalidLabelOwner,["DeletedLabel"]:CommonUIStrings.l_DecryptSkipReasonDeletedLabel,
["LabelProtectionChanged"]:CommonUIStrings.l_DecryptSkipReasonLabelProtectionChanged,["UnsupportedLabel"]:CommonUIStrings.l_DecryptSkipReasonLabelUnsupportedLabel,["DoubleKeyDisabled"]:CommonUIStrings.l_DecryptSkipReasonLabelDoubleKeyDisabled};this.disabled=!1;this.p8=a;this.o8=b;this.ql=c;this.HEg=f;this.ia=l;this.Xa=x;this.$b=F;this.Nb=R;this.ozb=fa;this.Z0e=!1;this.vm=wa;this.KA=Xa;this.zo=Lb;this.rj=kc;this.me=lb}Rr(a,b,c=null,f=!1){if(this.disabled)return Z.ULS.sendTraceTag(512263053,804,50,
"Ignore server error {0}",a?a.Code:315),!0;this.KA.oak();if(this.KA.P7)return Z.ULS.sendTraceTag(512263052,804,15,"GlobalErrorHandler:HandleServerError - Ignore server error since session is already closed. ErrorCode:{0}",a?a.Code:315),!0;let l=!1,x=0,F=0,R=null;var fa=null;c&&(fa=new ca,l=c(fa),x=fa.xB,F=fa.$za,R=fa.title,fa=fa.message);l||(l=this.Qoj(a,b));l||(b=a?a.Code:315,a=a?a.ExtraErrorParam:null,this.BOi(b)&&(this.Z0e=!0,this.vm.pause()),a?this.Vx.apply(this,[x,b,F,R,fa,f].concat(a)):this.Vx(x,
b,F,R,fa,f));return l}Qoj(a,b){if(!a)return!1;Z.ULS.sendTraceTag(512263051,821,15,"{0} - Error Code:{1} Source:{2} ExtraParam:{3}","GlobalErrorHandler:HandleServerErrorInternal",a.Code,a.Source,a.ExtraErrorParam?a.ExtraErrorParam.join(","):"empty");if(153===a.Code)return tj.a.instance.oCe(Date.now()),tj.a.yVc(u.AFrameworkApplication.userSessionId),u.AFrameworkApplication.zeb(uf.a.Mh(153),Jl.a.unknown,Jl.a.bnc),({RPe:c}=tj.a.instance.$xh()).returnValue&&Z.ULS.sendTraceTag(512263050,804,50,"{0} - Data Center Redirect - Time duration from user launch browser to redirection starting {1}",
"GlobalErrorHandler:HandleServerErrorInternal",(new Date).getTime()-c),a.ExtraErrorParam?this.tJk(a.ExtraErrorParam[0]):Z.ULS.sendTraceTag(512263049,804,10,"{0} - Data Center Redirect missing RedirectUrl","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(142===a.Code&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return(2===a.ExtraErrorParam.length?32===this.ia.Ka(ba.a.failover,2,a.ExtraErrorParam[0]):this.HEg.xRe(a.ExtraErrorParam[0],!0,this.Xa.podSessionId||"",1))||this.Vx(0,157,0,null,null),
!0;if(274===a.Code)return Z.ULS.sendTraceTag(512263048,804,10,"{0} - Pods session is locked for edit/merge. Local change could be lost","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(4===a.Code&&this.zo.instance&&!Ma.a.Va(this.Xa.PIc))return Z.ULS.sendTraceTag(512263047,801,15,"Triggering rehydration for password files from GlobalErrorHandler"),this.zo.instance.IQe(!1,0,a.Code),!0;if(157===a.Code&&2===a.Source&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length){var c=1<a.ExtraErrorParam.length?
a.ExtraErrorParam[1]:"";return this.$b.ka("685")&&c.toLowerCase()!==this.Xa.podSessionId.toLowerCase()?(ya.a.J(512263046,801,15,"{0} - Replication cache request boot incomplete failures were ignored, ServerReturnPodSessionSeed: {1}; SessionInfoSeed: {2}.","GlobalErrorHandler:HandleServerErrorInternal",c,b),!0):this.$b.ka("884")&&this.sje?(ya.a.J(512263045,801,15,"{0} - Ignore bootIncomplete error after SaveAndClose( ReleaseLock=true ).","GlobalErrorHandler:HandleServerErrorInternal"),!0):this.HEg.xRe(a.ExtraErrorParam[0],
!1,this.Xa.podSessionId||"",2)}if(223===a.Code||285===a.Code||362===a.Code||this.$b.ka("560")&&229===a.Code||this.$b.ka("914")&&this.zo.instance&&this.zo.instance.iPi(a.Code)){if(b!==this.Xa.podSessionId)return ya.a.J(512263044,801,15,"{0} - PodSessionId mismatch, skip failover signal. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;if(this.$b.ka("914")&&this.zo.instance&&this.zo.instance.eZ)return ya.a.J(512263043,801,15,
"{0} - SeamlessFailover is ongoing. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;ya.a.J(512263042,801,15,"{0} - RaisePodSessionUnavailableEvent, serverErrorCode:{1};","GlobalErrorHandler:HandleServerErrorInternal",a.Code);this.ozb.wFk(new Ta(this.Xa.podSessionId,!!a.ExtraErrorParam&&!!a.ExtraErrorParam.length&&"PodsOrderlyShutdown"===a.ExtraErrorParam[0],a.Code));return!0}if(389===a.Code||292===a.Code&&3===a.Source)return a=
this.Nb.notificationBar.sAa(ResourceStrings.L_DeepLinking_BootSlideNotFound,!1),this.$b.ka("IsAutomation")?a.displayTimeoutSeconds=this.$b.Ec("PodDeepLinkingToastMessageDisplayTimeMsForAutomation",a.displayTimeoutSeconds)/1E3:ya.a.J(512263041,804,15,"{0} - Deep link - Slide not found","GlobalErrorHandler:HandleServerErrorInternal"),this.Nb.notificationBar.Rh(a),!0;if(238===a.Code&&this.$b.ka("561")&&this.zo.instance&&this.zo.instance.eZ)return ya.a.J(512263040,801,50,"{0} - SessionBootInProgress during seamless failover, skipped",
"GlobalErrorHandler:HandleServerErrorInternal"),!0;if(329===a.Code)return ya.a.J(512263011,801,15,"{0} - PreconditionFailed error due to host integration ID mismatch, silent fail","GlobalErrorHandler:HandleServerErrorInternal"),this.Wqh(a.Code,null),!0;if(104===a.Code)return b=2===this.rj.Yaa,a.Code=b?56:105,ya.a.J(512263010,801,15,"{0} - LocalChangeLost seen when user is {1}. Returning {2}.","GlobalErrorHandler:HandleServerErrorInternal",b?"co-authoring":"alone",Nk.a[a.Code]),this.Vx(0,a.Code,0,
null,null),!0;if(this.jDj(a.Code)&&2!==this.$b.state)return ya.a.J(512263009,801,15,"{0} - Skip check file error if it under retry","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(117===a.Code){if((b=a.ExtraErrorParam)&&2===b.length&&"GB"===b[1])return this.Vx.apply(this,[0,a.Code,0,null,ResourceStrings.errorMessage_CannotOpenDocumentTooLargeGB,!1].concat(b)),!0}else if(432===a.Code)return this.Vx.apply(this,[1,a.Code,8,null,ResourceStrings.errorMessage_UserNetworkLocationUnauthorized,!1].concat(a.ExtraErrorParam)),
!0;return!1}qG(a,b){if(this.disabled)return Z.ULS.sendTraceTag(512263008,804,50,"Ignore client error {0}",a),!0;let c=!1,f=0,l=0,x=null,F=null;var R=null;b&&(R=new O(a),c=b(R),f=R.xB,l=R.$za,x=R.title,F=R.message,R=R.ePa);c||(c=!1);c||(R?this.Vx.apply(this,[f,a,l,x,F,!1].concat(R)):this.Vx(f,a,l,x,F));return c}Vx(a,b,c,f,l,x=!1,...F){0===a&&(a=this.p8.P$i(b));0===c&&(c=this.p8.RMc(b));f||(f=this.p8.E1d(b));l||(3===b&&this.$b.ka("DecryptSkipReasonIRMErrorEnabled")?l=this.s1i():(ya.a.J(512263007,801,
50,"GlobalErrorHandler::ShowError errorCode != ErrorCannotOpenDocumentIRM"),l=this.p8.a_d(b)));const R=()=>{this.lbl.apply(this,[a,b,c,f,l,x].concat(F))};2===this.$b.state?R():this.$b.ff(R)}s1i(){ya.a.J(512263006,801,50,"GlobalErrorHandler::GetDetailedIRMError DecryptSkipReason = "+u.AFrameworkApplication.cXb);return u.AFrameworkApplication.cXb&&this.Lje[u.AFrameworkApplication.cXb]?this.Lje[u.AFrameworkApplication.cXb]:this.Lje.Generic}lbl(a,b,c,f,l,x,...F){if(2===a){let R;(R=this.ql).AXb.apply(R,
[b,c,f,l].concat(F))}else 3===a?this.Wqh.apply(this,[b].concat(F)):this.tqa.apply(this,[uf.a.Mh(b),c,f,l,x].concat(F))}tqa(a,b,c,f,l,...x){0===b&&(b=this.p8.RMc(uf.a.EM(a)));if(Ke.GraphSpaceRootReplicator.ewg(uf.a.EM(a))&&x&&0<x.length){this.Xa.Ncd=x[0];var F=new Ha.a;for(var R=1;R<x.length;R++)F.add(x[R]);x=F.toArray()}F=Object.assign(new $l.a,{Type:6,Token:this.me.kd.Xec,Data:{["Reason"]:"FatalError",["ErrorName"]:uf.a.Qaa(a)}});ee.a("PPT.BootstrapperMessageNewValues")&&(F.MessageId=Le.a.yAh,R=
{Reason:"FatalError"},R.ErrorName=F.Data.ErrorName,F.Values=R);window.parent.postMessage(fe.c(F),"*");Z.ULS.sendTraceTag(512263005,804,15,"GlobalErrorHandler:DisplayErrorDialog: {0}",a);let fa;(fa=this.o8).AXb.apply(fa,[a,b,c,f,l].concat(x))}tJk(a){kb.a.openWindow(1,a)}get wia(){return this.sje}set wia(a){this.sje=a;ya.a.J(512263004,801,50,"GlobalErrorHandler::IgnoreBootIncompleteFailure is set to {0}",a)}get TSd(){return this.Z0e}dGd(){}BGd(){}Wqh(a,...b){const c=uf.a.Mh(a);ya.a.J(512263003,801,
50,"GlobalErrorHandler::SilentFail BSQMErrorCode: {0}; ErrorCode:{1}, ErrorParams:{2}",c,a,b?b.join(","):"");u.AFrameworkApplication.Xo(c);Se.Health.instance.recordQosError(uf.a.Qaa(c),["SilentFailure"],!1,!0,!0,!1,null)}jDj(a){return 288===a||300===a||301===a||302===a||303===a?!0:!1}BOi(a){return Array.contains(this.w1j,a)?!0:!1}}Object(e.a)(xb,"GlobalErrorHandler",null,[1255,1336]);class Tb{constructor(a){this.N7b=!1;this.LW=null;this.Ls=a}get ksg(){return this.N7b}Kph(){var a=ResourceStrings.errorTitle_PowerpointEditingStandard,
b=ResourceStrings.errorMessage_BlockUIUnderDeployment;this.N7b||(this.LW=new Oa.a,this.LW.vd=5,this.LW.message=dk.a.g2(b),this.LW.hr=!1,ya.a.J(22315662,822,50,"Showing UI blocking dialog to prompt user we are deploying"),this.LW.Oma(dk.a.g2(a),null,null),this.N7b=!0,this.Ls.KHf(!0))}gPc(){this.N7b&&(this.LW.hide(),this.N7b=!1,this.LW=null,this.Ls.KHf(!1))}}Object(e.a)(Tb,"DeployingDialog",null,[1250]);var wc=d(980),sd=d(422),$b=d(632),ge=d(408),we=d(155),oe=d(63),Fe=d(883);class Gf{constructor(a,
b,c,f,l,x,F){this.zca=this.hg=this.Qxb=this.Kxb=null;this.iYc=!1;this.yYc=this.n3c=this.hWc=null;this.eka=!1;this.ta=a;this.Yb=b;this.qq=c;this.Sb=f;this.uXc=l;this.YEg=x;this.zo=F}get zi(){return this.Yb.zi}jEb(a,b,c,f,l,x){this.eka||(this.eka=!0,this.iYc=c,this.hg=b,this.n3c=l,this.yYc=x,this.zo.instance&&this.zo.instance.PEd("abortedOnRefreshDoc"),this.YEg&&this.YEg(),this.uXc.Gb(this.Azi(a,f)))}Azi(a,b){let c=this.ta.Ba&&!oe.a.xz(this.ta.Ba.Bb)?this.ta.Ba.Bb:oe.a.empty;c=b?oe.a.empty:c;this.hg.Wa("CurrentActiveSlideId",
c.toString());this.hWc=oe.a.xz(c)?oe.a.empty:c;return new Nf.a(new Fe.a(c,a),Object(D.a)(this,this.akk,"onGetCellSuccess"),Object(D.a)(this,this.$jk,"onGetCellFailed"),Object(D.a)(this,this.Tyl,"validateResponse"))}Tyl(a){return!a.ServerError&&0===a.StatusCode&&a&&a.Cells&&a.Cells.length?(a=a.Cells[a.Cells.length-1])&&a.RevisionList?0<a.RevisionList.length:!1:!1}akk(a){this.hg.Wa("GetCells",a.Fh);a=new wc.a(null,Object(D.a)(this,this.Vuj,"inboundSetup"),a);a.Vi=!this.iYc;a.xl("RefreshUIOperation");
a.run()}$jk(a){this.hg.Wa("GetCells",a.Fh);200!==a.HttpStatusCode&&this.hg.Wa("GetCellsHttpStatusCode",a.HttpStatusCode.toString());if(this.yYc&&this.yYc(a))return!0;a.ServerError=Object.assign(new Kg.a,{Code:294,Source:0});Se.Health.instance.recordQosError("RefreshDocFailed",["UnexpectedAppRefresh"],!1,!0,!0,!0,null);return!1}Vuj(a,b){(this.zca=this.Yb.en)&&this.zca.$L&&this.zca.$L.JVc();this.zca&&this.zca.So&&(this.zca.$L=new $b.a(eg.a.instance,"FailoverView"));this.hg.Wa("InboundSetupStartTime",
Mc.a.Ye(new Date));if(ee.a("UseBuildIncrementalInboundOperation"))this.Yb.Ba=null,this.Kxb=this.zi.contentReplicator.AIf(b);else{const c=b.Cells[b.Cells.length-1],f=this.zi.ri.Dw.id;c.RevisionList[0].BaseId=we.a(f);this.Yb.Ba=null;this.Kxb=new sd.a(c,f,!1,new Date,b.Fh,!1,!1,!1)}this.Qxb=this.qq.je(3);this.Qxb.fd(this.ta.presentation);this.iYc&&this.Qxb.QT(a);a.Wg(Object(D.a)(this,this.yia,"inboundIncrementally"));this.hg.Wa("InboundSetupEndTime",Mc.a.Ye(new Date));return!0}yia(a){this.hg.Wa("InboundIncrementallyStartTime",
Mc.a.Ye(new Date));this.zi.contentReplicator.yia(this.Kxb,new Date);this.Kxb.PP&&(this.Qxb.dispose(),a.Wg(Object(D.a)(this,this.Z_k,"setActiveSlideAndRender")),this.Qxb=this.Kxb=null,this.hg.Wa("InboundIncrementallyEndTime",Mc.a.Ye(new Date)));return!0}Z_k(a){this.hg.Wa("SetActiveSlideAndRenderStartTime",Mc.a.Ye(new Date));a.Wg(Object(D.a)(this,this.bSi,"finishRefreshDoc"));if(oe.a.empty.equals(this.hWc))return this.hg.Wa("SetActiveSlideAndRenderEndTime",Mc.a.Ye(new Date)),!0;const b=this.Sb.$k(this.hWc);
if(!b)return this.hg.Wa("SetActiveSlideAndRenderEndTime",Mc.a.Ye(new Date)),!0;const c=this.qq.je(3);try{c.fd(b),this.iYc&&c.QT(a),this.Yb.Ba=b}finally{c&&c.dispose()}this.hg.Wa("SetActiveSlideAndRenderEndTime",Mc.a.Ye(new Date));return!0}bSi(){this.n3c&&this.n3c();this.zca&&this.zca.$L&&(this.zca.$L.JVc(),this.zca.$L=new ge.a);this.C4();return!1}C4(){this.eka=!1;this.yYc=this.n3c=this.hWc=this.zca=this.hg=this.Qxb=this.Kxb=null}}Object(e.a)(Gf,"RefreshDocExecutor",null,[1253]);class Rh{a_d(a){switch(a){case 1:a=
ResourceStrings.errorMessage_Unknown;break;case 14:a=ResourceStrings.errorMessage_Unknown;break;case 2:a=ResourceStrings.errorMessage_CannotOpenDocumentFileType;break;case 3:a=ResourceStrings.errorMessage_CannotOpenDocumentIRM;break;case 4:a=ResourceStrings.errorMessage_CannotOpenDocumentPassword;break;case 41:a=ResourceStrings.errorMessage_CannotOpenDocumentGatekeeperFailure;break;case 33:a=ResourceStrings.errorMessage_CannotOpenDocumentMacro;break;case 34:a=ResourceStrings.errorMessage_CannotOpenDocumentFinal;
break;case 35:a=ResourceStrings.errorMessage_CannotOpenDocumentSigned;break;case 36:a=ResourceStrings.errorMessage_CannotOpenEmbeddedFonts;break;case 5:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 6:a=ResourceStrings.errorMessage_CannotInstallFonts;break;case 7:a=ResourceStrings.errorMessage_CannotConvertModifyPassword;break;case 8:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 306:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 9:a=ResourceStrings.errorMessage_CannotComposeSlideUnexpected;
break;case 10:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 12:a=ResourceStrings.errorMessage_GenericSlideCorruption;break;case 15:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 16:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 17:a=ResourceStrings.errorMessage_FailedToRenderDocument;break;case 18:a=ResourceStrings.errorMessage_FailedToRenderSlide;break;case 20:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 21:a=ResourceStrings.errorMessage_InvalidCommand;
break;case 22:a=ResourceStrings.errorMessage_DocVersionMismatch;break;case 23:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 58:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 24:a=ResourceStrings.errorMessage_RequiresCheckout;break;case 25:a=ResourceStrings.errorMessage_LockedForOfflineCheckout;break;case 26:a=ResourceStrings.errorMessage_LockedByAnotherUser;break;case 27:a=ResourceStrings.errorMessage_AccessDenied;break;case 28:a=ResourceStrings.errorMessage_NoLicense;
break;case 29:a=ResourceStrings.errorMessage_Unknown;break;case 30:a=ResourceStrings.errorMessage_TextTooBig;break;case 31:a=ResourceStrings.errorMessage_TryAgain;break;case 37:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 32:a=ResourceStrings.errorMessage_Unexpected;break;case 11:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 13:a=ResourceStrings.errorMessage_FileNotFoundOrPermissionDenied;break;case 38:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 39:a=
ResourceStrings.errorMessage_PptEditExistingExclusiveLock;break;case 40:a=ResourceStrings.errorMessage_PptEditCheckedOutByAnother;break;case 42:a=ResourceStrings.errorMessage_EditWorkerTimeout;break;case 43:a=ResourceStrings.errorMessage_EditSlideCorruption;break;case 44:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 45:a=ResourceStrings.errorMessage_ClipartCannotConnect;break;case 46:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 47:a=ResourceStrings.errorMessage_Unknown;
break;case 48:a=ResourceStrings.errorMessage_Unknown;break;case 49:a=ResourceStrings.errorMessage_Unknown;break;case 50:a=ResourceStrings.errorMessage_Unknown;break;case 51:a=ResourceStrings.errorMessage_Unknown;break;case 52:a=ResourceStrings.errorMessage_Unknown;break;case 53:a=ResourceStrings.errorMessage_Unknown;break;case 54:a=ResourceStrings.errorMessage_Unknown;break;case 55:a=ResourceStrings.errorMessage_CannotOpenODPDocumentPassword;break;case 56:a=ResourceStrings.errorMessage_LocalChangeLost;
break;case 57:a=ResourceStrings.errorMessage_NumberOfCoauthorsReachedMax;break;case 59:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 60:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 61:a=ResourceStrings.errorMessage_ImageWrongFormat;break;case 62:a=ResourceStrings.errorMessage_ImageNoAccess;break;case 63:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 64:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 65:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 66:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 67:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 68:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 69:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 70:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 71:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 72:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 73:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 74:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 75:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 76:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 77:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 78:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 79:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 80:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 254:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 255:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 256:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 257:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 258:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 81:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 82:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 83:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 84:a=ResourceStrings.errorMessage_ClipartCannotDownload;
break;case 85:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 86:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 87:a=ResourceStrings.errorMessage_InsertLocalPictureTooLarge;break;case 88:a=ResourceStrings.invalidCanary;break;case 89:a=ResourceStrings.imageUploadRequestError;break;case 90:a=ResourceStrings.invalidImageFileError;break;case 91:a=ResourceStrings.imageUploadRequestError;break;case 92:a=ResourceStrings.imageUploadRequestError;break;case 93:a=ResourceStrings.imageUploadRequestError;
break;case 94:a=ResourceStrings.imageUploadRequestError;break;case 95:a=ResourceStrings.errorMessage_Unknown;break;case 96:a=ResourceStrings.errorMessage_Unknown;break;case 97:a=ResourceStrings.errorMessage_Unknown;break;case 98:a=ResourceStrings.errorMessage_Unknown;break;case 99:a=ResourceStrings.errorMessage_Unknown;break;case 137:a=ResourceStrings.errorMessage_TryAgain;break;case 100:a=ResourceStrings.errorMessage_Unknown;break;case 101:a=ResourceStrings.errorMessage_Unknown;break;case 102:a=
ResourceStrings.errorMessage_Unknown;break;case 103:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 104:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 105:a=ResourceStrings.errorMessage_Unknown;break;case 238:a=ResourceStrings.errorMessage_Unknown;break;case 269:a=ResourceStrings.errorMessage_Unknown;break;case 262:a=ResourceStrings.errorMessage_Unknown;break;case 288:a=ResourceStrings.errorMessage_Unknown;break;case 268:a=ResourceStrings.errorMessage_Unknown;break;case 315:a=
ResourceStrings.errorMessage_Unknown;break;case 237:a=ResourceStrings.errorMessage_Unknown;break;case 228:a=ResourceStrings.errorMessage_Unknown;break;case 233:a=ResourceStrings.errorMessage_Unknown;break;case 231:a=ResourceStrings.errorMessage_Unknown;break;case 230:a=ResourceStrings.errorMessage_Unknown;break;case 426:a=ResourceStrings.errorMessage_Unknown;break;case 19:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 106:a=ResourceStrings.errorMessage_FailedToLocalSaveDocument;break;
case 107:a=ResourceStrings.errorMessage_NumberOfSessionsPerUserReachedMax;break;case 108:a=ResourceStrings.errorMessage_Unknown;break;case 109:a=ResourceStrings.errorMessage_NullPresentationId;break;case 111:a=ResourceStrings.errorMessage_CannotInsertOnlineVideo;break;case 112:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 143:a=ResourceStrings.errorMessage_InsertOnlinePictureTooLarge;break;case 113:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 114:a=ResourceStrings.errorMessage_CannotPastePicture;
break;case 115:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 116:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 117:a=ResourceStrings.errorMessage_CannotOpenDocumentTooLarge;break;case 118:a=ResourceStrings.errorMessage_StorageOutOfMemory;break;case 141:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 142:a=ResourceStrings.errorMessage_BlockUIUnderDeployment;break;case 135:a=ResourceStrings.errorMessage_Unknown;break;case 144:a=ResourceStrings.errorMessage_FailedToRetrieveResource;
break;case 147:a=ResourceStrings.errorMessage_CannotInsertOnlinePictureNotFound;break;case 148:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 149:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 150:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 151:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 155:a=ResourceStrings.errorMessage_Unknown;break;case 156:a=ResourceStrings.errorMessage_Unknown;break;case 159:a=ResourceStrings.errorMessage_Unknown;
break;case 154:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 157:a=ResourceStrings.errorMessage_TryAgain;break;case 158:a=ResourceStrings.errorMessage_Unknown;break;case 160:a=ResourceStrings.errorMessage_Unknown;break;case 168:a=ResourceStrings.errorMessage_Unknown;break;case 169:a=ResourceStrings.errorMessage_TryAgain;break;case 173:a=ResourceStrings.errorMessage_TryAgain;break;case 199:a=ResourceStrings.errorMessage_Unknown;break;case 200:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 201:a=ResourceStrings.errorMessage_Unknown;break;case 202:a=ResourceStrings.errorMessage_ClipServicePasteCopyFailed;break;case 203:a=ResourceStrings.errorMessage_Unknown;break;case 204:a=ResourceStrings.errorMessage_Unknown;break;case 205:a=ResourceStrings.errorMessage_Unknown;break;case 206:a=ResourceStrings.errorMessage_Unknown;break;case 209:a=ResourceStrings.errorMessage_Unexpected;break;case 210:a=ResourceStrings.errorMessage_Unknown;break;case 211:a=ResourceStrings.imageUploadRequestError;
break;case 212:a=ResourceStrings.imageUploadTimeoutError;break;case 213:a=ResourceStrings.errorMessage_TryAgain;break;case 214:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 215:a=ResourceStrings.errorMessage_Unknown;break;case 363:a=ResourceStrings.errorMessage_Unknown;break;case 287:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 321:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 222:a=ResourceStrings.errorMessage_SlideTooManyShapes;break;case 247:a=
ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 275:a=ResourceStrings.errorMessage_DownloadAppSettingsFailed;break;case 244:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 295:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 245:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 246:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 249:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 250:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 322:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 329:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 243:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 251:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 252:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 242:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 241:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;
case 293:a=ResourceStrings.errorMessage_TryAgain;break;case 294:a=ResourceStrings.errorMessage_TryAgain;break;case 379:a=ResourceStrings.errorMessage_TryAgain;break;case 296:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 297:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 298:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 332:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 354:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 355:a=
ResourceStrings.errorMessage_FailedToOpenDocument;break;case 356:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 357:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 365:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 364:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 358:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 369:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 333:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 299:a=ResourceStrings.imageUploadTimeoutError;break;case 304:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 305:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 308:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 377:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 309:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 325:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 352:a=ResourceStrings.errorMessage_Unknown;break;case 328:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 330:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 331:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 334:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 373:a=ResourceStrings.errorMessage_Unknown;break;case 374:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 384:a=ResourceStrings.errorMessage_ZeroByteFileNotFound;break;case 391:a=ResourceStrings.errorMessage_CannotOpenDocumentWrongPassword;break;case 399:a=ResourceStrings.errorMessage_Unknown;break;case 400:a=ResourceStrings.errorMessage_Unknown;break;case 401:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 402:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 403:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 404:a=ResourceStrings.errorMessage_CannotInsertStream;
break;case 405:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 416:a=ResourceStrings.errorMessage_InsertLocalAudioTooLarge;break;case 418:a=ResourceStrings.errorMessage_InvalidNumberOfAudioFilesError;break;case 417:a=ResourceStrings.errorMessage_InvalidAudioFileError;break;case 422:a=ResourceStrings.errorMessage_EmptyAudioFileError;break;case 419:a=ResourceStrings.errorMessage_AudioUploadRequestError;break;case 424:a=ResourceStrings.errorMessage_AudioInvalidFileError;break;case 427:a=
ResourceStrings.errorMessage_InvalidAudioFileExtension;break;case 433:a=ResourceStrings.errorMessage_Unknown;break;case 434:a=ResourceStrings.errorMessage_Unknown;break;case 435:a=ResourceStrings.errorMessage_Unknown;break;case 440:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 441:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 442:a=ResourceStrings.errorMessage_UploadedMediaTooLarge;break;case 443:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;
break;case 444:a=ResourceStrings.errorMessage_UploadedMediaNonStandardResponse;break;case 445:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 446:a=ResourceStrings.errorMessage_UploadedMediaInternalError;break;case 447:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;default:a=ResourceStrings.errorMessage_Unknown}return a}E1d(a){switch(a){case 1:a=ResourceStrings.errorTitle_Unknown;break;case 14:a=ResourceStrings.errorTitle_Unknown;break;case 2:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 3:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 4:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 41:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 33:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 34:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 35:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 36:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 5:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 6:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 7:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 8:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 306:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 9:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 10:a=ResourceStrings.errorTitle_WacStandard;break;case 12:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 15:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 16:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 17:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 18:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 20:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 21:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 22:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 23:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 58:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 24:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 25:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 26:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 27:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 28:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 29:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 30:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 31:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 37:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 32:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 11:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 13:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 38:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 39:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 40:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 42:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 43:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 44:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 45:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 46:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 47:a=ResourceStrings.errorTitle_Unknown;break;case 48:a=ResourceStrings.errorTitle_Unknown;break;case 49:a=ResourceStrings.errorTitle_Unknown;break;case 50:a=ResourceStrings.errorTitle_Unknown;break;case 51:a=ResourceStrings.errorTitle_Unknown;
break;case 52:a=ResourceStrings.errorTitle_Unknown;break;case 53:a=ResourceStrings.errorTitle_Unknown;break;case 54:a=ResourceStrings.errorTitle_Unknown;break;case 55:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 56:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 57:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 59:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 60:a=ResourceStrings.errorTitle_PasteImageFailed;break;case 61:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 62:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 63:a=ResourceStrings.errorTitle_WacStandard;break;case 64:a=ResourceStrings.errorTitle_WacStandard;break;case 65:a=ResourceStrings.errorTitle_WacStandard;break;case 66:a=ResourceStrings.errorTitle_WacStandard;break;case 67:a=ResourceStrings.errorTitle_WacStandard;break;case 68:a=ResourceStrings.errorTitle_WacStandard;break;case 69:a=ResourceStrings.errorTitle_WacStandard;break;case 70:a=ResourceStrings.errorTitle_WacStandard;
break;case 71:a=ResourceStrings.errorTitle_WacStandard;break;case 72:a=ResourceStrings.errorTitle_WacStandard;break;case 73:a=ResourceStrings.errorTitle_WacStandard;break;case 74:a=ResourceStrings.errorTitle_WacStandard;break;case 75:a=ResourceStrings.errorTitle_WacStandard;break;case 76:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 77:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 78:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 79:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 80:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 254:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 255:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 256:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 257:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 258:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 81:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 82:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 83:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 84:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 85:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 86:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 87:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 88:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 89:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 90:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 91:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 92:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 93:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 94:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 95:a=ResourceStrings.errorTitle_Unknown;break;case 96:a=ResourceStrings.errorTitle_Unknown;break;case 97:a=ResourceStrings.errorTitle_Unknown;break;case 98:a=ResourceStrings.errorTitle_Unknown;break;case 99:a=ResourceStrings.errorTitle_Unknown;break;case 137:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 100:a=ResourceStrings.errorTitle_Unknown;break;case 101:a=ResourceStrings.errorTitle_Unknown;break;case 102:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 103:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 104:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 105:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 238:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 269:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 262:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 288:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 268:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 315:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 237:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 228:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 233:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 231:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 230:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 426:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 19:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 106:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 107:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 108:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 109:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 111:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 112:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 143:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 113:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 114:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 115:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 116:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 117:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 118:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 141:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 142:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 135:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 144:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 147:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 148:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 149:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 150:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 151:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 155:a=ResourceStrings.errorTitle_Unknown;break;case 156:a=ResourceStrings.errorTitle_Unknown;break;case 159:a=ResourceStrings.errorTitle_Unknown;break;case 154:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 157:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 158:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 160:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 168:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 169:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 173:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 199:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 200:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 201:a=ResourceStrings.errorTitle_Unknown;break;case 202:a=ResourceStrings.errorTitle_PasteSlideFailed;
break;case 203:a=ResourceStrings.errorTitle_Unknown;break;case 204:a=ResourceStrings.errorTitle_Unknown;break;case 205:a=ResourceStrings.errorTitle_Unknown;break;case 206:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 209:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 210:a=ResourceStrings.errorTitle_Unknown;break;case 211:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 212:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 213:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 214:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 215:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 363:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 287:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 321:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 222:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 247:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 275:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 244:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 295:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 245:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 246:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 249:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 250:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 322:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 329:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 243:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 251:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 252:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 242:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 241:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 293:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 294:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 379:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 296:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 297:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 298:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 332:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 354:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 355:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 356:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 357:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 365:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 364:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 358:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 369:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 333:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 299:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 304:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 305:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 308:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 377:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 309:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 325:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 352:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 328:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 330:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 331:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 334:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 373:a=ResourceStrings.errorTitle_Unknown;break;case 374:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 384:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 391:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 399:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 400:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 401:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 402:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 403:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 404:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 405:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 416:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 418:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 417:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 422:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 419:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 424:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 427:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 433:a=ResourceStrings.errorTitle_Unknown;break;case 434:a=ResourceStrings.errorTitle_Unknown;
break;case 435:a=ResourceStrings.errorTitle_Unknown;break;case 440:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 441:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 442:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 443:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 444:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 445:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 446:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 447:a=
ResourceStrings.errorTitle_PowerpointStandard;break;default:a=ResourceStrings.errorTitle_Unknown}return a}RMc(a){switch(a){case 2:a=6;break;case 3:a=6;break;case 4:a=6;break;case 41:a=6;break;case 33:a=6;break;case 34:a=6;break;case 35:a=6;break;case 36:a=6;break;case 5:a=6;break;case 6:a=6;break;case 7:a=6;break;case 8:a=116;break;case 306:a=116;break;case 9:a=6;break;case 10:a=6;break;case 15:a=6;break;case 16:a=8;break;case 17:a=6;break;case 20:a=12;break;case 22:a=8;break;case 23:a=2;break;case 58:a=
2;break;case 24:a=2;break;case 25:a=2;break;case 26:a=2;break;case 27:a=2;break;case 28:a=2;break;case 31:a=8;break;case 37:a=2;break;case 32:a=8;break;case 13:a=2;break;case 38:a=2;break;case 39:a=2;break;case 40:a=2;break;case 42:a=6;break;case 43:a=6;break;case 44:a=2;break;case 46:a=49;break;case 55:a=2;break;case 57:a=2;break;case 59:a=2;break;case 60:a=49;break;case 63:a=6;break;case 64:a=6;break;case 65:a=6;break;case 66:a=6;break;case 67:a=6;break;case 68:a=6;break;case 69:a=6;break;case 70:a=
6;break;case 71:a=6;break;case 72:a=6;break;case 73:a=6;break;case 74:a=6;break;case 75:a=6;break;case 76:a=6;break;case 77:a=6;break;case 78:a=6;break;case 79:a=6;break;case 80:a=6;break;case 254:a=6;break;case 255:a=6;break;case 256:a=116;break;case 257:a=116;break;case 258:a=6;break;case 81:a=49;break;case 82:a=49;break;case 83:a=49;break;case 84:a=49;break;case 85:a=49;break;case 86:a=49;break;case 105:a=8;break;case 238:a=8;break;case 269:a=8;break;case 262:a=8;break;case 288:a=8;break;case 268:a=
8;break;case 315:a=8;break;case 237:a=8;break;case 228:a=8;break;case 233:a=8;break;case 231:a=8;break;case 230:a=8;break;case 426:a=8;break;case 19:a=12;break;case 106:a=6;break;case 107:a=2;break;case 117:a=6;break;case 118:a=2;break;case 141:a=6;break;case 142:a=8;break;case 156:a=8;break;case 154:a=6;break;case 157:a=8;break;case 158:a=8;break;case 199:a=8;break;case 200:a=2;break;case 202:a=49;break;case 212:a=49;break;case 287:a=4;break;case 321:a=4;break;case 222:a=5;break;case 247:a=4;break;
case 275:a=8;break;case 244:a=4;break;case 295:a=4;break;case 245:a=4;break;case 246:a=4;break;case 249:a=4;break;case 250:a=4;break;case 322:a=1;break;case 243:a=4;break;case 251:a=4;break;case 252:a=4;break;case 242:a=4;break;case 241:a=8;break;case 293:a=12;break;case 294:a=12;break;case 296:a=6;break;case 333:a=12;break;case 299:a=49;break;case 304:a=6;break;case 353:a=6;break;case 308:a=12;break;case 377:a=12;break;case 309:a=4;break;case 325:a=6;break;case 352:a=10;break;case 328:a=12;break;
case 330:a=4;break;case 331:a=4;break;case 334:a=6;break;case 374:a=6;break;case 384:a=2;break;case 391:a=6;break;case 399:a=8;break;case 400:a=8;break;default:a=0}return a}P$i(a){switch(a){case 5:a=1;break;case 137:a=3;break;case 201:a=3;break;case 203:a=3;break;case 204:a=3;break;case 205:a=3;break;case 209:a=3;break;case 210:a=3;break;case 213:a=3;break;case 215:a=3;break;case 363:a=3;break;case 329:a=3;break;case 379:a=3;break;case 296:a=1;break;case 297:a=3;break;case 298:a=3;break;case 332:a=
3;break;case 354:a=3;break;case 355:a=3;break;case 356:a=3;break;case 357:a=3;break;case 365:a=3;break;case 364:a=3;break;case 358:a=3;break;case 369:a=3;break;case 305:a=3;break;case 307:a=3;break;case 373:a=3;break;case 391:a=1;break;case 433:a=3;break;case 434:a=3;break;case 435:a=3;break;default:a=1}return a}}Object(e.a)(Rh,"DefaultErrorMapping",null,[1251]);var Sh=d(691);class Wa{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ErrorHandling"}Wb(a){this.K=a;a.register(1250,"PowerPointWebEditor.ErrorHandling.IDeployingDialog").ma().na(()=>
new Tb(a.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));a.register(1251,"PowerPointWebEditor.IErrorMapping").ma().na(()=>new Rh);a.register(1252,"PowerPointWebEditor.IErrorDialog").ma().na(()=>new Kl(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IErrorMapping"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("Common.IAppSettingsManager")));const b=new le.a(()=>new Sh.a(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").BWb(a.resolve("Box4.IReplicationParameters")),hb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Xg));a.register(1253,"PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor").ma().na(()=>new Gf(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),
a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("PowerPointWebEditor.IPresentationReader"),b.value,u.AFrameworkApplication.VZf,this.K.La("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(1254,"PowerPointWebEditor.IDocRefreshHandler").ma().na(()=>new Bl(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IErrorHandler"),
b.value,a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),()=>u.AFrameworkApplication.Xg,a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventNotifier"),a.resolve("PowerPointWebEditor.IZoomContext")));a.register(Bf,"PowerPointWebEditor.SeamlessFailoverHandler").ma().na(()=>new Bf(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
()=>u.AFrameworkApplication.Xg));a.register(1255,"PowerPointWebEditor.IDelayedErrorHandler").ma().na(()=>new xb(this.K.resolve("PowerPointWebEditor.IErrorMapping"),this.K.resolve("PowerPointWebEditor.IErrorDialog"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IDocRefreshHandler"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Box4.IAppFrame"),
this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.La("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")))}init(){this.K.resolve("PowerPointWebEditor.IDelayedErrorHandler");this.K.resolve("PowerPointWebEditor.IDocRefreshHandler").ub();this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").ub()}dispose(){this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").dispose()}static main(){m.a.instance.Ac(new Wa)}}
Object(e.a)(Wa,"PPTWebEditorErrorHandlingPackage",null,[2,3]);var Lg=d(1180),gg=d(85),ub=d(37);class nk{constructor(){this.font=null;this.$Rc=this.isValid=!1}}Object(e.a)(nk,"EmbeddedFontClientStatus",null,[]);class Tj{constructor(a,b,c,f,l,x){this.c4c=this.h$a=null;this.Ga=a;this.Fx=b;this.VMg=c.Bd(7);this.yc=f;this.Pzb=l;this.Cy=x;this.VMg.xk(Object(D.a)(this,this.Rcb,"onPresentationPropertyChanged"));this.Fx.LCa(()=>{this.BSe(0)})}dispose(){this.VMg.Tm(Object(D.a)(this,this.Rcb,"onPresentationPropertyChanged"))}get isInitialized(){return!!this.h$a}get gDh(){return this.c4c}CXd(a){return this.isInitialized?
this.h$a.Jb(a)?this.h$a.ga(a):null:null}createFontUrl(a){if(this.Ga.podsHtmlTextForEmbeddedFontsIsEnabled)if(ya.a.J(41521309,820,50,"CreateFontUrl"),this.isInitialized||this.BSe(2),this.isInitialized){var b=this.Cy.rF(a);if((b=this.CXd(b))&&!b.$Rc&&b.isValid){b.font.Name!==a&&ya.a.J(41296397,820,15,"Name is not identical");a=ia.FontUtils.t_b(a);const c=this.Pzb.resolve(gg.a.DTi,Tj.MTi(b.font));Ma.a.Va(a)||Ma.a.Va(c)?ya.a.J(41296399,820,15,"FontFace name or url is invalid"):(this.Cy.sNa(a,String.format("url('{0}')",
c)),b.$Rc=!0)}}else ya.a.J(41296401,820,10,"Dictionary is not initialized")}Rcb(a,b){b&&b.node&&b.property&&b.property===ub.a.embeddedFonts&&this.BSe(1)}BSe(a){if(this.Ga.podsHtmlTextForEmbeddedFontsIsEnabled)if(ya.a.J(41521314,820,50,"UpdateEmbeddedFontDictionary, reason: {0}",a),a=this.yc.l2i()){this.h$a?ya.a.J(41521346,820,50,"Dictionary is updated, count: {0}",a.length):(this.h$a=new Ic.a,ya.a.J(41296405,820,15,"Dictionary is initialized, count: {0}",a.length));for(const b of a){if(Ma.a.Va(b.Name)){ya.a.J(41296407,
820,15,"Name is invalid");continue}if(0!==b.Style)continue;a=Tj.lGj(b);const c=this.Cy.rF(b.Name),f=this.CXd(c);f&&(f.isValid===a||f.$Rc)||this.h$a.$(c,Object.assign(new nk,{font:b,isValid:a,$Rc:!1}))}this.c4c=Tj.xBi(this.h$a);this.Cy.cul(this.c4c);ia.FontUtils.h_h(this.c4c,Object(D.a)(this,this.createFontUrl,"createFontUrl"))}else ya.a.J(41296403,820,10,"EmbeddedFonts is null")}static MTi(a){return JSON.stringify(a)}static lGj(a){return!Ma.a.Va(a.Name)&&4>a.Style&&!a.IsRestricted&&(0===a.LoadResult||
270===a.LoadResult)}static xBi(a){const b={};for(let c of a)c.value.isValid&&(a=[],a.push(new Lg.a("",0,0,"",[0])),b[c.key]=a);return b}}Object(e.a)(Tj,"EmbeddedFontsManager",null,[1242,106]);class Fj{}Fj.loading="loading";Fj.loaded="loaded";Fj.error="error";Object(e.a)(Fj,"FontFaceStatus",null,[]);class so{constructor(){this.p_c=this.nCg=!1;this.Mie=null;this.init()}get dxg(){return this.p_c}load(a){return new Promise((b,c)=>{this.p_c&&!Ma.a.Va(a)||c([]);let f;f=this.nCg&&-1<a.indexOf("'")?String.format('48px "{0}"',
a):String.format("48px '{0}'",a);this.Mie.load(f).then(l=>{for(const x of l)Ma.a.Va(x.family)||x.status===Fj.loaded||ya.a.J(40429085,801,15,"Font load status {0}",x.status);l.length||ya.a.J(41494563,801,15,"No font resolved");b(l)},l=>{ya.a.J(41739607,801,10,"Rejected: {0}",l.toString());c(l)})})}init(){const a=window.document;this.Mie=a&&a.fonts?a.fonts:null;this.p_c=!!this.Mie;this.nCg=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("AllowSpecialCharacterFontsToRender");ya.a.J(41494593,
801,50,"FontFaceSetAPIIsSupported: {0}",this.p_c)}}Object(e.a)(so,"FontFaceSetObserver",null,[1240]);class tn{constructor(a){if(!a)throw Error.argumentNull("fontFaceSetObserver");this.u$a=a}I5d(a){return a?a:{}}B5d(a){return a?a:()=>{}}VDh(a,b,c,f,l,x,F){if(!a)return[];b=this.I5d(b);c=this.B5d(c);f=this.I5d(f);l=this.B5d(l);x=this.I5d(x);F=this.B5d(F);const R=[];for(const fa of a)fa in f?(l(fa),R.push(this.u$a.load(String.format("{0}_MSCustomFont",fa)))):fa in b?(c(fa),R.push(this.u$a.load(String.format("{0}_MSFontService",
fa)))):fa in x&&(F(fa),R.push(this.u$a.load(String.format("{0}_EmbeddedFont",fa))));return R}}Object(e.a)(tn,"FontsObserver",null,[1241]);class Ll{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Fonts"}Wb(a){this.K=a;this.K.register(1240,"PowerPointWebEditor.Fonts.IFontFaceSetObserver").ma().na(()=>new so);this.K.register(1241,"PowerPointWebEditor.Fonts.IFontsObserver").ma().na(()=>new tn(this.K.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver")));this.K.register(1242,"PowerPointWebEditor.Fonts.IEmbeddedFontsManager").ma().na(()=>
new Tj(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PPTe.IResourceViewElementResolver"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager")))}init(){this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager")}dispose(){}static main(){m.a.instance.Ac(new Ll)}}Object(e.a)(Ll,"PPTWebEditorFontsPackage",
null,[2,3]);var Em=d(418);class gp{fph(){return!1}}Object(e.a)(gp,"DefaultParagraphViewElementSetUpdateStrategy",null,[1337]);var Cl=d(231),Um=d(1036),lf=d(235);class Ok extends Cl.a{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){super(a,b,l);this.utc=null;this.mOb=Eb.a.nil;this.y2e=this.Msd=!1;this.fY=this.eY=this.ajb=this.$ib=-1;this.jtd=this.GNb=!1;this.guc=this.kVc=this.Jyd=this.lrf=this.Vkb=null;this.Mid=0;this.WWe=this.t_a=this.Z4e=null;a.$L.SWa(b);this.GSa=c;this.Kyd=x;this.aMh=F;this.$Lh=R;this.KRh=
fa;this.Wc=wa;this.BMh=Xa;this.Dv=lb;this.nZa(!0);this.EJe(!0);this.pvd=new le.a(Object(D.a)(this,this.oFi,"determineIsShapesAndTextboxesEnabled"));this.Is=[];this.OKa=new Ha.a;this.EXe=new Ha.a;this.wcb();this.Oc.Hh&&(b=this.Oc.b9i(this.$a))&&(b.isSelected&&(this.JQ.pBb=!0),b.G7&&(this.GNb=!0),this.JQ.pBb&&(this.$ib=b.oha,this.ajb=b.pha,this.eY=b.TR,this.fY=b.Lpa));a.So&&(a=Object(va.a)(571,a))&&a.PGk(this.$a);this.yPb=f;this.Dyd=Lb}get ask(){return this.yPb}get qxe(){return this.Kyd}get $dh(){return this.lrf||
(this.lrf=this.aMh())}get $8c(){if(!this.Jyd){const a=this.$Lh();a&&(this.Jyd=a.gEl())}return this.Jyd}get Nf(){return this.Wc}get qZ(){return this.BMh}get czg(){return this.mOb}set czg(a){this.mOb=a}get $sj(){return this.OKa}get L2g(){return this.Di?Ba.a.f6f(this.Di,!1):0}get Di(){return this.Vkb}get z7a(){return this.Z4e}nZa(a){let b=!1;this.C8k(a)&&(a=this.i4a(),this.jc(a),this.utc=null,this.mOb=Eb.a.nil,b=!0);this.Nf.Zf&&this.$a.nhb?Sys.UI.DomElement.addCssClass(this.htmlElement,Pb.F2):Sys.UI.DomElement.containsCssClass(this.htmlElement,
Pb.F2)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,Pb.F2),this.htmlElement.removeAttribute("title"));return b}C8k(a){let b=!!this.htmlElement;b=b&&0<this.htmlElement.getElementsByTagName("p").length;return a||!b||!this.Di||"p"!==Ma.a.sg(this.Di.tagName)}i4a(){this.Vkb=this.Fd.Oo(ka.a.p);this.Vkb.className="Paragraph";this.Z4e=this.Fd.Oo(ka.a.span);this.z7a.className="WACImageGroupContainer";return this.Fd.Bl?this.Vkb:this.vBl()}vBl(){const a=this.Fd.Oo(ka.a.div);a.className="ParaWrappingDiv";
a.appendChild(this.Vkb);this.Ho(this.Vkb);return a}DT(a){super.DT(a);if(this.$a.SY)return a=this.$a.SY.oc(a.E0).ipc,this.$a.SY=null,new lf.a(a.bla,a.minWidth,a.dla);let b;b=this.WWe;a.zb(88)&&(b=lf.a.max(b,a.Gq.wIa),a.uc());return b}cA(a){if(u.AFrameworkApplication.fa.ka("TextLayoutServiceUpdateLayoutLogicEnabled")&&(this.kVc=null,this.Di)){const b=this.Di.getElementsByClassName("LineBox");if(b&&0<b.length){this.kVc=Array(b.length);for(let c=0;c<b.length;c++)this.kVc[c]=Ba.a.Su(b[c]).length}}this.nZa(!1)&&
(a.currentNode.anchor.Oj(this.Ma,8),a.parentNode.anchor.Oj(this.Ma,8),this.utc=null);super.cA(a);this.$yi(a,this.Di)}$yi(a,b){var c=this.$a;if(this.Oc.Hh){var f=pa.InteractiveViewManager.instance.Ld;f&&f.Ma===this.Oc.Ma&&f.editingView.Bl&&f.editingView.xg===this.$a&&2===f.editingView.mode?Sys.UI.DomElement.addCssClass(this.htmlElement,Ok.Cjg):Sys.UI.DomElement.removeCssClass(this.htmlElement,Ok.Cjg)}if(c.SY)c=c.SY.oc(a.E0).htmlElement,Ba.a.ZVb(c,b),b=this.Oc,b.Hh&&b.dI&128&&(this.$a.SY=null);else{a=
this.c9i();f=Tc.StyleReader.c$f(a);Tc.StyleReader.hUc(a)&&f?(Ca.d(b,za.a.role,Uc.a.oGf),Ca.d(b,za.a.qGf,f)):(b.removeAttribute(Uc.a.We),b.removeAttribute(Uc.a.zTb));var l="";if(H.a.instance.ga(71)||H.a.instance.ga(77))l=this.v0i(c);f=a=null;var x=Ya.ParagraphReader.Ndg(c,H.a.instance.ga(53),H.a.instance.ga(71),H.a.instance.ga(77),H.a.instance.ga(54));if(this.y2e||l!==this.utc||this.mOb!==c.ite){a="WindowText";f="transparent";this.utc=l;this.y2e=!1;l="";let R=null;"P"!==b.tagName&&x.m7a&&(R=ia.FontUtils.mha(x.fontName));
if(x.B2){var F=x.fontColor;F!==Eb.a.auto&&(a=Eb.a.LH(F))}H.a.instance.ga(49)||(x.q7a&&(F=x.OQ,F!==Eb.a.auto&&(f=Eb.a.LH(F))),x.UQa&&(F=x.highlight,F!==Eb.a.auto&&(f=Eb.a.LH(F))));if(F=Ya.ParagraphReader.language(this.$a))if(F=sa.a.le(F))b.setAttribute("xml:lang",F.name),b.setAttribute("lang",F.name);b.style.fontWeight=x.isBold?"bold":"normal";b.style.fontStyle=x.isItalic?"italic":"normal";b.style.verticalAlign="baseline";x.isSuperscript&&(b.style.verticalAlign="super");x.cF&&(b.style.verticalAlign=
"sub");x.pD&&(l="underline");if(x.bF||x.vZ)l=0<l.length?l+" line-through":"line-through";b.style.textDecoration=l;b.style.fontFamily=R?R:"'Segoe UI',Tahoma,Verdana,'Sans-Serif'";x.PQa?1===x.capitalization?b.style.fontVariant="small-caps":2===x.capitalization?b.style.textTransform="uppercase":b.style.fontVariant="normal":b.style.textTransform=""}this.mOb=c.ite;H.a.instance.ga(49)&&(x.q7a&&(l=x.OQ,l!==Eb.a.auto&&(f=Eb.a.LH(l))),x.UQa&&(x=x.highlight,x!==Eb.a.auto&&(f=Eb.a.LH(x))));this.$a.properties.sa(bb.a.Jrg,
!1)?(Sys.UI.DomElement.addCssClass(b,"Conflict"),b.setAttribute(Uc.a.zpa,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(b,"Conflict"),b.removeAttribute(Uc.a.zpa),f?(b.style.backgroundColor=f,Ok.OBf(f,b)):H.a.instance.ga(49)&&(b.style.backgroundColor="transparent",Sys.UI.DomElement.removeCssClass(b,"Highlight")));c.ite!==Eb.a.nil?(Sys.UI.DomElement.addCssClass(b,"NoteTagHighlight"),f&&(b.style.borderColor=f,Ok.OBf(f,b))):(Sys.UI.DomElement.removeCssClass(b,"NoteTagHighlight"),Sys.UI.DomElement.removeCssClass(b,
"Highlight"));a&&(b.style.color=a);c=Rd.OutlineElementReader.Yl(Yb.OutlineElementNavigator.rA(this.$a));this.Oc.Bl&&(c?Sys.UI.DomElement.addCssClass(b,"Rtl"):Sys.UI.DomElement.removeCssClass(b,"Rtl"));switch(Ya.ParagraphReader.UM(this.$a)){case 1:b.style.textAlign="left";b.style.Xgb="";break;case 2:b.style.textAlign="center";b.style.Xgb="";break;case 3:b.style.textAlign="right";b.style.Xgb="";break;case 6:b.style.textAlign="justify";b.style.Xgb="auto";break;case 7:b.style.textAlign="justify";b.style.Xgb=
"distribute";break;case 9:case 11:case 10:b.style.textAlign="justify";b.style.Xgb="kashida";break;case 13:b.style.textAlign="justify";b.style.Xgb="inter-cluster";break;default:b.style.textAlign="",b.style.Xgb=""}4===Gb.App.mode&&H.a.instance.ga(86)&&n.a.xj&&"right"===b.style.textAlign.toLowerCase()&&(a=b.style.paddingRight.toLowerCase(),""===a||"0px"===a)&&(b.style.paddingRight="1px");H.a.instance.ga(54)&&(Ca.d(b,za.a.Zw,this.$a.sa(Bb.a.Pn,0)),Ca.d(b,za.a.Vrk,this.$a.id.toString()));this.qxe.qlh(this.$a,
b,c,this.Ma)}}c9i(){var a=H.a.instance.ga(71)?(a=Tc.StyleReader.kD(this.$a))?Tc.StyleReader.BP(a):H.a.instance.ga(61)?Tc.StyleReader.HJa:Tc.StyleReader.Uma:Tc.StyleReader.Uma;return a}v0i(a){let b="";var c=Tc.StyleReader.kD(a);c&&(b+=c.id);Tc.StyleReader.Vq&&({tableStyle:a,V3a:c}=Tc.StyleReader.Vq.K6a(a),a&&(b+=a.id),c&&(b+=c.id));return b}Xea(){this.$a.Wba(this.Ma,16,!0)}wcb(){this.pvd.value&&this.$a.A7a.wcb()}VL(a){if(!this.Ldl()){this.wcb();var b=this.$a;this.SMf();Ba.a.$t(this.Di);Ba.a.$t(this.z7a);
var c=this.Di;c.style.minHeight="";this.Is=[];this.Mid=0;var f=new Ha.a,l=0;a&&(l=this.Q$h(a,b,f,c,l));if(!this.Kdl()){a=!1;var x=this.htmlElement.parentNode,F=this.htmlElement.nextSibling;x&&(this.Ghc(x,this.htmlElement),a=!0);this.$8c&&this.$8c.EDl();var R=l;l=this.ask.uRk(b,this.Fd,c,this.$sj,f,Object(D.a)(this,this.IZg,"onOverHyperlink"),Object(D.a)(this,this.EZg,"onOutHyperlink"),Object(D.a)(this,this.QX,"takeOwnershipOfSubtree"),Object(D.a)(this,this.Ho,"takeOwnership"),aa.a.GHc,this.czg,l,
this.$ib,this.ajb,this.GNb,Ok.iUc,!!this.JQ&&this.JQ.pBb,this.Msd,Gb.App.WQ.CKe,Rd.OutlineElementReader.Yl(Yb.OutlineElementNavigator.rA(this.$a)));if(!u.AFrameworkApplication.fa.ka("TextLayoutServiceDataDeletionFixEnabled")||this.Dv.uMf(b,f))this.Dv.Jxh(c,this.Fd,l.Izf,b,R,f,ld.a.instance.Oa?ld.a.instance.Oa.kb:null,this.kVc)||this.Fd.So||this.Dv.tCh(b);this.Is=f.toArray();this.guc=l.sTg;this.EXe=l.FMf;this.Msd=l.rjg;this.$8c&&this.$8c.zDl(this.L2g);this.$dh&&this.$dh.CDl(c);this.dBh();this.jtd=
!0;a&&x.insertBefore(this.htmlElement,F);!this.Oc.Bl&&x&&"li"===Ma.a.sg(x.tagName)&&this.W$h(b,x);this.Oc.Bl||this.Dv.oPf(c)}}}W$h(a,b){if(Ib.ListReader.qla){if(b=this.gMc(a)){const c=b.oc(this.Oc.Ma);if(c){const f=Ba.a.uba(this.htmlElement,"Paragraph");this.Irk(a)?(a=(a=this.R8i(f))?a.nextSibling:null)?f.insertBefore(c.htmlElement,a):f.appendChild(c.htmlElement):Ba.a.iFd(f,c.htmlElement);b.anchor.Oj(this.Ma,64)}}}else this.GSa.kRf(b,a,this.Ma)}R8i(a){for(let b=0;b<a.children.length;b++){const c=
a.children[b];if(Sys.UI.DomElement.containsCssClass(c,"PageBreakBlob"))return c}return null}Irk(a){if(!a)return!1;a=a.Ra;if(!a)return!1;a=a.first;return a?(a=a.blob)?8===a.Eq:!1:!1}gMc(a){const b=new mb.GraphIterator;b.set(a);return b.Ze()?(Yb.OutlineElementNavigator.Je(b),this.Nf.Zf&&!b.bI(4)?b.zb(31):b.zb(4)):null}Q$h(a,b,c,f,l){a=jg.a.mb(a.E0,a.currentNode);if(!a.Ji())return l;let x=0,F=!1,R=0,fa=0,wa=0,Xa=!1;const lb=Ya.ParagraphReader.MV(b),Lb=this.pvd.value;do{const kc=a.Gq.htmlElement;Sys.UI.DomElement.containsCssClass(kc,
aa.a.YU)?(Lb&&b.A7a.$Dl?(Xa||(Ib.ListReader.Lw&&lb||b.A7a.UDl(this.z7a),f.appendChild(this.z7a)),this.z7a.appendChild(kc)):f.appendChild(kc),L.a.ov(kc,aa.a.DDa,l++),c.add(kc),this.Oc.Hh&&({Ock:R,qbk:fa,pbk:wa}=Ok.l3k(b,kc,Lb,a,Xa,R,fa,wa)),F=Xa=!0):f.appendChild(kc)}while(a.lCa());Lb?this.Oc.Bl?this.Bul():(this.gBh(wa+6,fa+6),x=fa+6):x=fa-R+6;F&&!Gb.App.instance.quj&&this.Oc.Hh&&f.clientHeight<x&&(f.style.minHeight=x+"px");return l}gBh(a=0,b=0){this.pvd.value&&this.$a.A7a.TDl(this.z7a,a,b)}zld(){const a=
new jg.a(this.Ma);a.set(this.$a);a.Ze();Yb.OutlineElementNavigator.Je(a);Ib.ListReader.Lw&&(this.qxe.qlh(this.$a,this.Di,Rd.OutlineElementReader.Yl(a.currentNode),this.Ma),this.GSa.Yul(a))}dBh(){this.qZ.odc(this.$a,this.Di)}oFi(){const a=hb.a.instance.pb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(130)}get isSelected(){return super.isSelected}set isSelected(a){super.isSelected=a;a||(this.fY=this.eY=this.ajb=this.$ib=-1)}get oha(){return this.Oc.Bl?this.$a.oc(this.Oc.Df.Ma).oha:this.$ib}set oha(a){this.$ib!==
a&&(this.$ib=a,this.Jma(16),this.$a.anchor.Oj(this.Oc.Ma,16))}get pha(){return this.Oc.Bl?this.$a.oc(this.Oc.Df.Ma).pha:this.ajb}set pha(a){this.ajb!==a&&(this.ajb=a,this.Jma(48),this.$a.anchor.Oj(this.Oc.Ma,48))}get TR(){return this.Oc.Bl?this.$a.oc(this.Oc.Df.Ma).TR:this.eY}set TR(a){this.eY!==a&&(this.eY=a,this.Jma(16),this.$a.anchor.Oj(this.Oc.Ma,16))}get Lpa(){return this.Oc.Bl?this.$a.oc(this.Oc.Df.Ma).Lpa:this.fY}set Lpa(a){this.fY!==a&&(this.fY=a,this.Jma(48),this.$a.anchor.Oj(this.Oc.Ma,
48))}get G7(){return this.Oc.Bl?this.$a.oc(this.Oc.Df.Ma).G7:this.GNb}set G7(a){this.GNb!==a&&(this.GNb=a,this.Jma(16),this.$a.anchor.Oj(this.Oc.Ma,16))}get M_f(){return this.Is[this.Is.length-1]}dispose(){this.qNk();super.dispose();this.SMf();for(let a of this.EXe)a.jXf(this.Fd)}qNk(){if(this.t_a&&this.htmlElement)for(let a of this.t_a)a.pNk(this.htmlElement)}tla(){super.tla();this.Msd&&this.Oc.notify(2)}vld(a){const b=u.AFrameworkApplication.fa.ka("Box4DoNotRenderPresenceOutOfView"),c=this.Oc.Twe.t_d(this.$a);
this.Dyd.Odh(c,this.t_a,this,this.htmlElement,b,this.Z9k());this.t_a=c;this.jtd||this.dBh();this.jtd=!1;super.vld(a)}Jma(a){this.KRh.fph(this.$a)||super.Jma(a)}Ldl(){if(this.$tg()){const a=this.Oc;if(1!==a.editingView.Fpb)return a.RPd=!0}return!1}Kdl(){return this.Oc.Bl&&fb.SelectionEditor.Sra(ld.a.instance.Oa.kb)?!0:!1}Bul(){var a=this.$a.oc(this.Oc.Df.Ma);a&&(a=Sys.UI.DomElement.getBounds(a.z7a),this.gBh(a.width,a.height))}Z9k(){return!this.$tg()&&!this.Oc.Bl}$tg(){if(pa.InteractiveViewManager.instance.Ld!==
this.Oc)return!1;const a=this.Oc.editingView;return a.xg===this.$a&&2===a.mode}hKj(){const a=this.getBounds(),b=kb.a.Yh(this.Oc.container);return a.y+a.height>=b.y&&a.y<=b.y+b.height}Hre(a){a.afh(this);0<this.Mid&&a.ZSk(this)}get EVa(){return this.Di}wBh(a){this.WWe=new lf.a(0,a,0)}getBounds(){const a=P.a.Snb(this.htmlElement.querySelector("p.Paragraph")||this.htmlElement,this.Oc.Hh?this.$a.id.toString():"");this.qxe.y6h(this.$a,a,Rd.OutlineElementReader.Yl(Yb.OutlineElementNavigator.rA(this.$a)),
this.Oc.Ma);return a}IZg(a){Cl.a.f6k(a.Fc,a.yC);if(Gb.App.xUb){const b=a.Fc,c=b.querySelector(".NormalTextRun")||b;H.a.instance.ga(8)||a.UY?c.style.cursor="pointer":c.style.cursor="text";Sys.UI.DomElement.addCssClass(b,Ok.gse);Um.a.instance().E3h(Object(D.a)(this,this.Hue,"onCtrlKeyDown"));Um.a.instance().F3h(Object(D.a)(this,this.Jue,"onCtrlKeyUp"))}return!0}EZg(a){Sys.UI.DomElement.removeCssClass(a.Fc,Ok.gse);Um.a.instance().Pch(Object(D.a)(this,this.Hue,"onCtrlKeyDown"));Um.a.instance().Qch(Object(D.a)(this,
this.Jue,"onCtrlKeyUp"));return!0}SMf(){for(let a=0;a<this.OKa.count;a++)Gb.App.Fb.VQ.xb(qa.a.ela,this.OKa.ga(a),Object(D.a)(this,this.IZg,"onOverHyperlink")),Gb.App.Fb.VQ.xb(qa.a.fla,this.OKa.ga(a),Object(D.a)(this,this.EZg,"onOutHyperlink")),Um.a.instance().Pch(Object(D.a)(this,this.Hue,"onCtrlKeyDown")),Um.a.instance().Qch(Object(D.a)(this,this.Jue,"onCtrlKeyUp"));this.OKa.clear();if(this.guc){for(let a of this.guc)Gb.App.Fb.VQ.xb(a.eventName,a.Fc,a.handler);this.guc=null}}Hue(){this.ewa("pointer")}Jue(){this.ewa("text")}ewa(a){for(let b=
0;b<this.OKa.count;b++)if(Sys.UI.DomElement.containsCssClass(this.OKa.ga(b),Ok.gse)){const c=this.OKa.ga(b).querySelector(".NormalTextRun");if(c){c.style.cursor=a;break}}}static get iUc(){return!!ld.a.instance.Oa&&!!ld.a.instance.Oa.kb&&ld.a.instance.Oa.kb.iUc}static OBf(a,b){"transparent"!==a?Sys.UI.DomElement.addCssClass(b,"Highlight"):Sys.UI.DomElement.removeCssClass(b,"Highlight")}static l3k(a,b,c,f,l,x,F,R){b=Sys.UI.DomElement.getBounds(b);c&&(a=a.A7a.MCl(f.currentNode),b.x=a.x,b.y=a.y,b.height&&
b.width||(b.height=a.height,b.width=a.width));a=b.y+b.height;if(!l||b.y<x)x=b.y;if(!l||a>F)F=a;b=b.x+b.width;if(!l||b>R)R=b;return{Ock:x,qbk:F,pbk:R}}}Ok.Cjg="HiddenParagraph";Ok.gse="MouseIsOn";Object(e.a)(Ok,"ParagraphViewElement",Cl.a,[477,1339,443,395,106]);class nm extends Cl.a{constructor(a,b,c,f,l,x){super(a,b);this.Og=this.Wc=this.Y$=this.Kyd=null;Ib.ListReader.qla?(this.LWf(),this.EJe(!0),this.Y$=c,this.Kyd=l,this.Wc=x,this.Og=f,this.nZa(!0)):(this.EJe(!1),a=this.Fd.Oo(ka.a.span),a.className=
"ListGhost",this.jc(a))}nZa(a){if(Ib.ListReader.qla){var b=this.Bbg(this.$a);a&&(a=this.SOd(),this.jc(a),(b=Object(va.a)(Ok,b.oc(this.Oc.Ma)))&&b.htmlElement&&(b=b.Di))&&((a=Ba.a.h_b(b,nm.i9a))?b.replaceChild(this.htmlElement,a):Ba.a.iFd(b,this.htmlElement))}}get Hbe(){return Ba.a.h_b(this.htmlElement,nm.J5b)}cA(){this.nZa(!1);if(!this.Oc.Bl&&Ib.ListReader.qla)if(this.Wc.Zf)this.Z2k(this.htmlElement,this.Hbe,this.$a);else{const a=this.Y$.dwb(this.$a);this.Hbe.innerText=a}}VL(a){this.Oc.Bl||Ib.ListReader.qla&&
a.currentNode.anchor.Oj(this.Ma,64)}Hre(a){Ib.ListReader.qla&&a.afh(this)}get EVa(){return this.htmlElement}wBh(){}zld(){this.$2k()}fag(){return-1}Z2k(a,b,c){var f=this.Og.JZd(c);if(f)if(12!==f.type)Ja.a.instance.shipAssertTag(34930713,8,!1,"the node associated with the list is type [{0}]",f.type);else{var l=f.Ra,x=l?l.last.lo:null;l=l?l.last.Zo:null;var F=f.nhb,R=f.EDb,fa=f.i7();f=!!F&&R.L8f(fa).Sa(Bb.a.listID);F=null;f&&(F=R.Sa(Bb.a.listID)&&fa.Sa(Bb.a.listID)?3:R.Sa(Bb.a.listID)?2:1);R=this.Y$.dwb(c);
c=this.Y$.dwb(c);x=!!x||f&&(1===F||3===F);l=!!l||f&&(2===F||3===F);F=!x&&!l&&""!==R&&R!==c;for(fa=!x&&!l&&!F;b.hasChildNodes();)b.removeChild(b.firstChild);b.innerText="";b.style.color="";b.title="";Sys.UI.DomElement.removeCssClass(b,Pb.Fbe);Sys.UI.DomElement.removeCssClass(a,Pb.F2);if(fa)b.innerText=c;else{if(l||F)fa=Jb.a.createElement(b.ownerDocument,ka.a.span),Sys.UI.DomElement.addCssClass(fa,Pb.Evh),fa.innerText=R,b.appendChild(fa);if(x||F)R=Jb.a.createElement(b.ownerDocument,ka.a.span),Sys.UI.DomElement.addCssClass(R,
Pb.Gvh),R.innerText=c,b.appendChild(R);x||l?b.style.color="#000":Sys.UI.DomElement.addCssClass(b,Pb.Fbe);f&&Sys.UI.DomElement.addCssClass(a,Pb.F2)}}else Ja.a.instance.shipAssertTag(34930712,8,!1,"No paragraph is found with a list node")}Bbg(a){if(!a)return null;const b=new mb.GraphIterator;b.set(a);b.Ze();return Yb.OutlineElementNavigator.Je(b)?b.zb(2):null}SOd(){const a=this.Fd.Oo(ka.a.span);Sys.UI.DomElement.addCssClass(a,nm.i9a);this.XEc(a);return a}XEc(a){const b=Jb.a.createElement(a.ownerDocument,
ka.a.span);Sys.UI.DomElement.addCssClass(b,nm.J5b);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}$2k(){if(!this.Oc.Bl){var a=this.Bbg(this.$a),b=a.oc(this.Oc.Ma).htmlElement.parentNode;!this.Oc.Bl&&b&&"li"===Ma.a.sg(b.tagName)&&this.Y$.uBh(b,a,this.Ma,this.Hbe,!1)}}}nm.i9a="ListMarkerWrappingSpan";nm.J5b="ListMarker";Object(e.a)(nm,"NumberListViewElement",Cl.a,[1339,443,395,106]);var Th=d(451),me=d(1055);class Gn{constructor(a,b){this.offsetWidth=a;this.offsetHeight=
b}}Object(e.a)(Gn,"ListMarkerOffset",null,[]);class Sf{constructor(){this.o4j="ListMarkerMeasuringPad";this.A9b=new Me.a}g6i(a){let b=a.innerHTML;if(!b.length)return new Gn(0,0);var c=null;window.getComputedStyle&&(c=window.getComputedStyle(a,null))&&(b+=["",c.fontFamily,c.fontSize,c.fontStyle,c.fontWeight,c.fontVariant,c.textDecoration].join("_"));this.A9b.Jb(b)||(a=a.cloneNode(!0),c&&(a.style.fontFamily=c.fontFamily,a.style.fontSize=c.fontSize,a.style.fontStyle=c.fontStyle,a.style.fontWeight=c.fontWeight,
a.style.fontVariant=c.fontVariant,a.style.textDecoration=c.textDecoration),me.a.OTb(),me.a.F6a(this.o4j).appendChild(a),{width:c,height:a}=kb.a.sLc(a),this.A9b.$(b,new Gn(c,a)),me.a.rYb());return this.A9b.ga(b)}}Object(e.a)(Sf,"ListMarkerOffsetCache",null,[1247]);var Fd=d(1166),ef=d(1183),kh=d(79),Pk=d(252),uj=d(188),Dl=d(484);class Zi{constructor(a,b){this.Wc=this.qY=this.GJ=null;this.Og=a;this.TF=b;this.OF=Ib.ListReader.Lw;this.Kw=n.a.Kw||n.a.$n}get Rf(){return this.Og}get xL(){return this.TF}get KK(){return this.GJ||
(this.GJ=hb.a.instance.pb("Box4.List.ListSettings"))}get Uha(){return this.qY||(this.qY=hb.a.instance.La("Common.IZoomManager"))}set Uha(a){this.qY=a}get Nf(){return this.Wc||(this.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get enabled(){return this.OF}dwb(a){const b=this.Rf.u6a(a);return b&&b.propertySet.sa(bb.a.Ni,null)?1===b.listType?this.XIf(b):0===b.listType?this.zVg(b,a):"":""}Xul(a,b){if(this.enabled&&b&&(this.Rf.cca(b)||this.Nf.Zf&&63===b.type)&&this.Jub(a)){a.style.display=
"block";var c=this.hsb(a);this.yfd(a,b);c&&(a=this.dwb(b),c.innerText=a)}}kRf(a,b,c){if(this.enabled&&this.Jub(a)){var f=this.hsb(a);f&&this.uBh(a,b,c,f)}}uBh(a,b,c,f,l=!1){var x=mb.GraphIterator.mb(b);x.Ze();Yb.OutlineElementNavigator.Je(x);if(Ib.ListReader.ak(x)||this.Nf.Zf&&Ib.ListReader.E4b(x)){const R=x.currentNode;var F=Rd.OutlineElementReader.Yl(R);this.Nf.Zf?this.Rf.JTg(x):this.Rf.gla(x);x=x.currentNode;if(!Ib.ListReader.qla){const fa=this.dwb(x);f.innerText=fa}f.setAttribute(Uc.a.YJ,Uc.a.vB);
12!==b.type?Dl.a.xSc(b)&&(a=f.parentNode,f.style.height="auto",b=c=0,{width:c,height:b}=this.Urb(f),f.style.height="",c=-1*(Math.ceil(c)+13),f.style.marginLeft=F?"13px":c+"px",f.style.marginRight=F?c+"px":"13px",Ba.a.F1k(f,F?"right":"left"),F=0,{height:F}=this.Urb(a.parentNode),f.style.marginTop=Math.max((F-b)/2,0)+"px"):(this.A5k(a,f,b,R,x,c),this.LSe(b,f,c,x,F,l))}}Yul(a){this.enabled&&a&&a.Gq&&Rd.OutlineElementReader.Yl(a.currentNode)}KSe(a,b,c,f,l=-1){this.enabled&&(Ya.ParagraphReader.MV(a)||
this.Nf.Zf&&Ya.ParagraphReader.FGj(a))&&this.sBh(a,b,c,l,null)}Vul(a,b,c){if(this.enabled&&this.Jub(a)){var f=Ba.a.s7f(a,Zi.pJi);if(f&&(f=Ba.a.s7f(f,Zi.oJi))&&(f=Ba.a.e7(f,Zi.Pda))&&f.style&&(n.a.$f||(f.style.marginTop="0px"),(a=Ba.a.e7(a,Zi.Zrk))&&(a=Ba.a.e7(a,Zi.Pda))&&f.className.startsWith(Zi.Pda))){if(this.Nf.Zf){var l=Ba.a.Frb(a,Zi.$Ia);var x=Ba.a.Frb(f,Zi.$Ia)}else l=this.xVd(a,Zi.$Ia),x=Ba.a.e7(f,Zi.$Ia);l&&x&&(f.style.marginLeft!==a.style.marginLeft&&(f.style.marginLeft=""===a.style.marginLeft?
"0px":a.style.marginLeft),f.style.marginRight!==a.style.marginRight&&(f.style.marginRight=""===a.style.marginRight?"0px":a.style.marginRight),{J3f:b,x3f:c}=this.qBh(a,f,l,x,b,c),this.P6h(b,c,f))}}}xVd(a,b){return Ba.a.e7(a,b)}qBh(a,b,c,f,l,x){var F;""!==a.style.textIndent&&(x&&this.Rf.j9a||""===b.style.textIndent)&&(x=a.style.textIndent,this.Rf.j9a&&(F=this.fMc(a))&&(x=this.whi(F,x)),b.style.textIndent=x);x=this.Rrb(c);F=this.Rrb(f);Math.floor(F.x)!==Math.floor(x.x)?(a=this.Ihi(l,x,F),a=isNaN(a)?
0:a,""!==b.style.textIndent&&(l=b.style.textIndent,x=l.lastIndexOf("px"),0<x&&(l=l.substring(0,x),a+=parseInt(l))),b.style.textIndent=a+"px",x=this.Rrb(c),F=this.Rrb(f)):""===b.style.textIndent&&(b.style.textIndent=a.style.textIndent);return{J3f:x,x3f:F}}Ihi(a,b,c){let f=0;10>Math.abs(c.x-b.x)?this.KK.pIj||(f=this.Cbg(a,b,c)):f=this.Cbg(a,b,c);return f}Cbg(a,b,c){return a?c.x-b.x:b.x-c.x}whi(a,b){let c=b,f;({width:f}=this.Urb(a));if(f){var l=a.style.marginLeft,x=a.style.marginRight;const F=l.lastIndexOf("px"),
R=x.lastIndexOf("px");a=c.lastIndexOf("px");0<a&&0<F&&0<R&&(l=this.uxe(l,F),x=this.uxe(x,R),(b=this.uxe(b,a))||l||x)&&(c=b+f+l+x+"px")}return c}uxe(a,b){a=a.substring(0,b);a=parseFloat(a);return a=isNaN(a)?0:a}P6h(a,b,c){if(n.a.$f){if(.1<Math.abs(a.y-b.y)){let f=parseFloat(c.style.marginTop);f=isNaN(f)?0:f;c.style.marginTop=a.y-b.y+f+"px"}}else c.style.marginTop=a.y-b.y+"px"}fag(a,b=!1){return(a=this.hsb(a))?({width:a}=this.Urb(a),b?a+0:a):0}hsb(a){return this.enabled&&this.Jub(a)?(a=Dl.a.p6i(a))?
this.dag(a):null:null}yfd(a,b,c=!1){if(this.enabled&&this.Jub(a)){if(this.Nf.Zf){var f="1";var l=this.Rf.FZd(b)}else f=this.f6i(b),l=this.Rf.u6a(b);b=this.G_b(b,l);c?(Ca.d(a,za.a.KCi,b),Ca.d(a,za.a.role,Uc.a.cNa),Ca.d(a,za.a.JCi,f)):(Ca.d(a,za.a.v$h,b),Ca.d(a,za.a.role,Uc.a.cNa),Ca.d(a,za.a.qGf,f))}}dag(a){if(!this.enabled||!a)return null;let b=null;(a=this.fMc(a))&&(b=Ba.a.e7(a,Zi.J5b)||this.XEc(a));return b}Jub(a){return!!a&&"li"===Ma.a.sg(a.tagName)}sBh(){}B8f(){return 720}Urb(a){let b,c;({width:b,
height:c}=kb.a.sLc(a));this.Uha&&this.Uha.instance&&this.Uha.instance.Rtg(a)&&(b/=this.Uha.instance.S1,c/=this.Uha.instance.S1);return{width:b,height:c}}Rrb(a){const b=kb.a.sLc(a).returnValue;this.Uha&&this.Uha.instance&&this.Uha.instance.Rtg(a)&&(b.x/=this.Uha.instance.S1,b.y/=this.Uha.instance.S1);return b}cia(a,b){switch(a.cia()){case 0:return b+"";case 4:return Ma.a.EQf(b-1,!0);case 2:return Ma.a.GQf(b,!0);case 3:return Ma.a.EQf(b-1,!1);case 1:return Ma.a.GQf(b,!1);case 22:return 10>b?"0"+b:b+
"";default:return b+""}}XIf(a){if(1!==a.listType)return"";a=this.q8i(a.listType,a.listStyle);return Pk.a.rIf(a[0])}zVg(a,b){b=this.G_b(b,a);return this.cia(a,b)+"."}q8i(a,b){return uj.a.kP(a,b).propertySet.sa(bb.a.Ni,null)}G_b(a,b){const c=b.Eha;return c!==Pk.a.kw?c:this.Ohi(a,b)}Ohi(a,b){if(b.YV!==Pk.a.kw)return b.YV;if(b.Yz!==Pk.a.kw)return b.Yz;let c=1;const f=new mb.GraphIterator;f.set(a);f.Ze();for(Yb.OutlineElementNavigator.Je(f);f.mCa();)if(Ib.ListReader.ak(f)){const l=this.Rf.Fw(f);if(l&&
b&&l.listType===b.listType&&l.listStyle===b.listStyle){if(l.YV!==Pk.a.kw)return c+l.YV;if(l.Yz!==Pk.a.kw)return c+l.Yz;if(a.Sa(Bb.a.listID)&&f.currentNode.Sa(Bb.a.listID)&&f.currentNode.getValue(Bb.a.listID)!==a.getValue(Bb.a.listID))break;c++}}return c}ywl(a,b){Gb.App.h9a&&(a.Sa(bb.a.fontColor)&&(b.fontColor=a.getValue(bb.a.fontColor)),a.Sa(bb.a.fontSize)&&(b.fontSize=a.getValue(bb.a.fontSize)),a.Sa(bb.a.font)&&(b.fontName=a.getValue(bb.a.font)),a.Sa(bb.a.bold)&&(b.isBold=a.getValue(bb.a.bold)),
a.Sa(bb.a.italic)&&(b.isItalic=a.getValue(bb.a.italic)),a.Sa(bb.a.superscript)&&(b.isSuperscript=a.getValue(bb.a.superscript)),a.Sa(bb.a.subscript)&&(b.cF=a.getValue(bb.a.subscript)),a.Sa(bb.a.strikethrough)&&(b.bF=a.getValue(bb.a.strikethrough)),a.Sa(kh.a.ys)&&(b.vZ=a.getValue(kh.a.ys)))}x_d(a,b){a=Ya.ParagraphReader.Ndg(a,H.a.instance.ga(53),H.a.instance.ga(71),H.a.instance.ga(77),H.a.instance.ga(54));this.ywl(b,a);return a}t8f(){return null}tBh(a,b,c,f){const l=c.parentNode;let x=f.sa(bb.a.fontSize,
fd.Font.MH);if(a.cF||a.isSuperscript)Ca.d(c,za.a.gUf,(x/2).toString()),x=Math.floor(x*Wc.HTi),l&&(l.style.fontSize=x/2+"pt"),c.style.fontSize=x/2+"pt";else if(Ib.ListReader.qla){if(c.style.fontSize=x/2+"pt",!f.Sa(bb.a.fontSize)&&(a=Ba.a.Frb(b,"EOP")))c.style.fontSize=a.style.fontSize}else c.style.fontSize=b.style.fontSize}A5k(a,b,c,f,l,x){b&&this.Jub(a)&&(b.style.verticalAlign=a.style.verticalAlign,f&&l&&Gb.App.h9a&&(x=f.Ag(x)))&&(f=this.x_d(c,l,H.a.instance.ga(53),H.a.instance.ga(71),H.a.instance.ga(77),
H.a.instance.ga(54)),f=this.t8f(x.Fd,c)||f,this.y_b(a,b,l),!this.Nf.Zf||""===b.style.color&&!Sys.UI.DomElement.containsCssClass(b,Pb.Fbe)?(c="",f.B2&&(x=f.fontColor,x!==Eb.a.auto&&(c=Eb.a.LH(x))),b.style.color=c,c=this.Rf.u6a(l)):c=this.Rf.FZd(l),b.style.fontWeight=f.isBold&&1!==c.listType?"bold":"normal",b.style.fontStyle=f.isItalic&&1!==c.listType?"italic":"normal",f.isSuperscript?b.style.verticalAlign="super":f.cF&&(b.style.verticalAlign="sub"),this.tBh(f,a,b,l),f.bF||f.vZ)&&(b.style.textDecoration=
0<b.style.textDecoration.length?b.style.textDecoration+" line-through":"line-through")}y_b(a,b){b.style.fontFamily=a.style.fontFamily}fMc(a){return a?Ba.a.h_b(a,Jf.a.i9a)||this.SOd(a):null}XEc(a){const b=Jb.a.createElement(a.ownerDocument,ka.a.span);Sys.UI.DomElement.addCssClass(b,Zi.J5b);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}SOd(a){if(!a)return null;const b=Jb.a.createElement(a.ownerDocument,ka.a.span);Sys.UI.DomElement.addCssClass(b,Jf.a.i9a);Ba.a.iFd(a,b);
this.XEc(b);return b}LSe(a,b,c){this.KSe(a,b.parentNode.parentNode,this.xL.Xrb(a).KJb,this.xL.k6a(a).KJb,c)}}Zi.Pda="Paragraph";Zi.Zrk="ParaWrappingDiv";Zi.oJi="_EditingElement";Zi.pJi="_EditingElement_WrappingDiv";Zi.$Ia="TextRun";Zi.J5b="ListMarker";Object(e.a)(Zi,"AListMarkerUtility",null,[1248]);var De=d(64),nf=d(790);class Ak{}Ak.ZJd=8226;Ak.VIf="Arial";Ak.cQd=65532;Ak.uGa=65533;Object(e.a)(Ak,"PptListConstants",null,[]);var qf=d(60),Sg=d(224);class Ml extends Zi{constructor(a,b,c,f,l,x,F,R,
fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc){super(a,b);this.AYj=[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061];this.$ce=c;this.A9b=f;this.Ea=l;this.Gl=x;this.C8j=F;this.Mb=R;this.eC=fa;this.Vh=wa;this.DN=Xa;this.KG=lb;this.ZB=Lb;this.TBg=kc;this.d9b=lc;this.Iz=Dc;this.ota=Ec;this.c9b=Jc}f6i(a){const b=new mb.GraphIterator;b.set(a);b.Ze();Yb.OutlineElementNavigator.Je(b);return b.currentNode.sa(Bb.a.listLevel,0)+1+""}sBh(a,b,c,f,l=null){const x=this.$ce.Bp(ba.a.Wul);l=new jg.a(f);l.set(a);l.Ze();
Yb.OutlineElementNavigator.Je(l);if(Ib.ListReader.ak(l)){if(!b){this.$ce.Tb(Ed.a.ph,{["Reason"]:"ParagraphElementNull"});x.end();return}f=this.dag(b);if(!f){this.$ce.Tb(Ed.a.ph,{["Reason"]:"ListMarkerNotFound"});x.end();return}let F=this.Urb(f).width;const R=l.Gq.Fd.Cd;a=R.nJ(this.xL.m7(a).ZL,0);c=R.nJ(Fd.a.Uda(c,0),0);this.Iz&&Object(Fa.a)(347,this.ZB.Ld)&&(c=0);l=Rd.OutlineElementReader.Yl(l.currentNode);this.W2k(b,f,a,c,F,l)}x.end()}Urb(a){a=this.A9b.g6i(a);return{width:a.offsetWidth,height:a.offsetHeight}}fMc(a){let b=
a;this.d9b&&a&&0<=a.className.indexOf(mc.a.Pda)&&(a=Ba.a.uba(a,mc.a.W7))&&(b=a);return super.fMc(b)}xVd(a,b){return this.d9b?Ba.a.e7(a,mc.a.W7)?Ba.a.Frb(a,b):Ba.a.e7(a,b):super.xVd(a,b)}qBh(a,b,c,f){b.style.textIndent=a.style.textIndent;a=this.Rrb(c);f=this.Rrb(f);return{J3f:a,x3f:f}}cia(a,b){switch(a.cia()){case 18:return 21>b?Ma.a.fromCharCode(b-1+9312):b.toString();case 19:return this.lWi(b)}return super.cia(a,b)}XIf(a){let b="";if(1===a.listType){const c=a.propertySet.sa(bb.a.Ni,null);c&&c.length&&
c[0]&&(b=Ma.a.Gv(c[0],4))}b=this.f7h(b?b:"2022",a);if(ee.a("FixEvalSecurityBugForListMarkerUtility")&&String.fromCodePoint)return String.fromCodePoint(String.format("0x{0}",b));ya.a.J(512496919,809,15,"Use of Eval in ListMarkerUtility");return Object(ef.a)(String.format("'\\u{0}'",b))}zVg(a,b){b=this.G_b(b,a);return this.cia(a,b)+this.p8i(a)}W2k(a,b,c,f,l,x){f?this.Y2k(a,b,f,c,l,x):this.X2k(a,b,l,x)}Y2k(a,b,c,f,l,x){const F=Math.max(Math.abs(c),l);a.style.textIndent=0<c?F+"px":Math.max(F-f,0)+"px";
this.flh(F-l,-1*F,b,x)}X2k(a,b,c,f){a.style.textIndent=c+"px";this.flh(0,-1*c,b,f)}flh(a,b,c,f){c.style.marginLeft=f?a+"px":b+"px";c.style.marginRight=f?b+"px":a+"px"}p8i(a){a=a.X7;for(let b=0;b<a.length;b++)if(a[b]===Ak.uGa){if(b+2>=a.length)break;return a[b+2]?Ma.a.fromCharCode(a[b+2]):""}return"."}lWi(a){let b="";for(;0<a;)b=Ma.a.fromCharCode(this.AYj[a%10])+b,a=parseInt(String(a/10));return b}f7h(a,b){let c=a;1===b.listType&&b.l7a&&0<=Array.indexOf(Ml.tWk,b.font)&&!a.indexOf("0")&&(c="f"+a.substr(1));
return c}x_d(a,b,c,f,l,x){if(!this.TBg)return super.x_d(a,b,c,f,l,x);f=this.Mb.Kc(b);f.mc(11);f.Ng(11);l=this.DN.vP(f,this.KG.Bba(f));c=new nf.ParagraphStandardProperties;(x=this.Gl.Kia(b))||this.C8j.lDj(b)?(c.fontColor=Eb.a.pOa,c.fontSize=x?qf.a.ZUg:Ya.ParagraphReader.Nha(a,bb.a.fontSize,fd.Font.MH)):(b.Sa(bb.a.fontColor)?c.fontColor=b.getValue(bb.a.fontColor):l&&l.Sa(bb.a.fontColor)&&!De.isTableCellOrInside(f)?c.fontColor=l.getValue(bb.a.fontColor):c.fontColor=this.Vh.Nha(a,bb.a.fontColor,Eb.a.nil),
f=this.Vh.Nha(a,bb.a.fontSize,fd.Font.MH),a=this.Ea.DBa(this.Ea.kn(a)),a*=f,b.Sa(ub.a.erb)&&(a*=b.getValue(ub.a.erb)),c.fontSize=a);return c}tBh(a,b,c){this.TBg&&(b=this.eC.VH(b))&&a.Cra&&(c.style.fontSize=b.Fd.Cd.nha(a.fontSize),c.style.lineHeight="0.1")}G9f(a,b){let c="";const f=this.Rf.u6a(b);1===f.listType&&f.l7a?c=f.font&&-1===f.font.indexOf(",")?ia.FontUtils.mha(f.font):f.font:19===f.cia()||18===f.cia()&&21>this.G_b(b,f)?c=ia.FontUtils.mha("Dengxian"):(b=null,a&&a.parentNode&&a.parentNode.parentNode&&
(b=a.parentNode.parentNode.children[1]),b&&(c=b.style.fontFamily));return c}y_b(a,b,c){a=this.G9f(b,c);b.style.fontFamily=a;b.style.fontFamily||!n.a.Hj&&!n.a.$n||("Wingdings 3,Sans-Serif"===a?b.style.fontFamily="'Wingdings 3','Sans-Serif'":"Wingdings 2,Sans-Serif"===a&&(b.style.fontFamily="'Wingdings 2','Sans-Serif'"))}LSe(a,b,c,f,l,x=!1){if(this.d9b){if(b=b.parentNode.parentNode)b=0<=b.className.indexOf(mc.a.W7)?b.parentNode:b,this.KSe(a,b,this.xL.Xrb(a).KJb,this.xL.k6a(a).KJb,c)}else super.LSe(a,
b,c,f,l,x)}hsb(a){return super.hsb(a)}Y5i(a,b){return this.G_b(b,a)}yfd(a,b,c=!1){if(this.ota){const l=this.Mb.Kc(b);l.mc(11);l.Ng(11);l.zb(2);if(c){if(b&&b.Sa(ub.a.gsg)&&!b.getValue(ub.a.gsg)){var f=b.sa(bb.a.Ni,null);f&&0<f.length&&a.setAttribute("data-charcodes",f.toString());f=this.hsb(a);f=this.G9f(f,b);Ma.a.Va(f)||a.setAttribute("data-font",f);a.setAttribute("data-buAutoNum",b.sa(ub.a.autonumberBulletType,8))}this.c9b&&l.currentNode.Sa(ub.a.d8d)&&!l.currentNode.getValue(ub.a.d8d)&&a.setAttribute("data-margin",
l.currentNode.sa(Bb.a.Il,Sg.a.leftMargin).toString())}}super.yfd(a,b,c)}t8f(a,b){return this.Iz&&a&&b&&(Object(Fa.a)(347,a)||Object(Fa.a)(347,this.ZB.Ld)&&a.Bl)?(a=new nf.ParagraphStandardProperties,a.fontName=fd.Font.ZR,a.fontColor=Eb.a.pOa,a.fontSize=qf.a.Rel,a):null}}Ml.tWk="Symbol;Wingdings;Wingdings 2;Wingdings 3;Webdings;Wingdings,Sans-Serif".split(";");Object(e.a)(Ml,"ListMarkerUtility",Zi,[1067]);class am{static XWj(){"GetSpecialIndentWithTabs"in am.thh||(am.thh.GetSpecialIndentWithTabs=!0,
ya.a.J(40649491,817,15,"{0}:{1}","GetSpecialIndentWithTabs","Invalid tab size"))}}am.thh={};Object(e.a)(am,"SessionLogger",null,[]);class Tn{constructor(a,b,c,f,l,x){this.b0c=a;this.K8=b;this.Vh=c;this.Mb=f;this.DN=l;this.pEg=x}qlh(a,b,c,f=-1){let l=this.pEg;0<=f&&(l=this.O8f(a,f)||l);this.N3k(a,b,c,l);this.O3k(a,b,l,f)}O8f(a,b){let c=null;(a=a.oc(b))&&a.Fd&&(c=a.Fd.Cd);return c}N3k(a,b,c,f){let l=0;this.Vh.MV(a)||(l=f.nJ(this.K8.m7(a).ZL,0));c?(b.style.marginLeft="",b.style.marginRight=l+"px"):(b.style.marginLeft=
l+"px",b.style.marginRight="")}O3k(a,b,c,f=-1){var l=this.K8.BLc(a).ZL;a.anchor&&this.Vh.MV(a)&&0<=f?this.b0c.KSe(a,b,Fd.a.nJ(l,0),0,f):(f=c.nJ(l,0),l=c.nJ(this.K8.m7(a).ZL,0),b.style.textIndent=this.tdj(f,l,this.evi(a),this.f1i(a),c)+"px")}evi(a){let b=0;if(void 0!==a&&null!==a&&(a=a.characterData))for(;b<a.length;)if("\t"===a.charAt(b))b++;else break;return b}f1i(a){let b=a.sa(Bb.a.Ppb,Tn.RBc);if(!a.Sa(Bb.a.Ppb)){const c=this.Mb.Kc(a);c.set(a);c.mc(11);c.Ng(11);(a=this.DN.vP(c,a.sa(Bb.a.listLevel,
Sg.a.vCa)))&&(b=a.sa(Bb.a.Ppb,Tn.RBc))}return b}tdj(a,b,c,f,l){a=-1*a<b?a:-1*b;if(!c)return a;0>a&&(c--,a=0);0>=f&&(c=0,am.XWj());0<c&&(f=l.nJ(f,0),a=(Math.floor((a+b)/f)+c)*f-b);return a}y6h(a,b,c,f=-1){var l=this.pEg;0<=f&&(l=this.O8f(a,f)||l);a=this.K8.BLc(a).ZL;l=l.nJ(a,0);0>l&&(c||(b.x+=l),b.width-=l)}}Tn.RBc=1440;Object(e.a)(Tn,"ParagraphViewIndentationStrategy",null,[1338]);var Bk=d(413),Fm=d(627),Nl=d(359),Cf=d(154),Ol=d(223),Re=d(261);class Gm{constructor(a,b,c){this.success=a;this.srk=b;
this.aAk=c}}Object(e.a)(Gm,"AddSpansForThisLinePerTextLayoutPropertyResult",null,[]);var Zg=d(796);class of{constructor(){this.um=new E.DictionaryPropertySet}getValue(a){return this.um.getValue(a)}sa(a,b){return this.um.sa(a,b)}Sa(a){return this.um.Sa(a)}get propertySet(){return this.um.clone()}get TM(){return this.um.sa(bb.a.font,fd.Font.ZR)}get iU(){return this.um.sa(Bb.a.iU,-1)}get fieldInstruction(){return this.um.sa(Bb.a.fieldInstruction,"")}get Cra(){return this.um.Sa(bb.a.fontSize)}get fontSize(){return this.um.sa(bb.a.fontSize,
fd.Font.MH)}get B2(){return this.um.Sa(bb.a.fontColor)}get fontColor(){return this.um.sa(bb.a.fontColor,Eb.a.nil)}get Xig(){return this.um.Sa(Zg.a.rVb)}get t4f(){return this.um.sa(Zg.a.rVb,1)}get UQa(){return this.um.Sa(bb.a.highlight)}get highlight(){return this.um.sa(bb.a.highlight,Eb.a.nil)}get q7a(){return this.um.Sa(kh.a.OQ)}get OQ(){return this.um.sa(kh.a.OQ,Eb.a.nil)}get Zig(){return this.um.Sa(bb.a.Gs)}get language(){return this.um.sa(bb.a.Gs,0)}get OQa(){return this.um.Sa(bb.a.bold)}get isBold(){return this.um.sa(bb.a.bold,
!1)}get n7a(){return this.um.Sa(bb.a.italic)}get isItalic(){return this.um.sa(bb.a.italic,!1)}get gtb(){return this.um.Sa(bb.a.underline)}get pD(){return this.um.sa(bb.a.underline,!1)}get VOc(){return this.um.Sa(bb.a.qw)}get qw(){return this.um.sa(bb.a.qw,fd.Font.mU)}get ftb(){return this.um.Sa(bb.a.strikethrough)}get bF(){return this.um.sa(bb.a.strikethrough,!1)}get B1b(){return this.um.Sa(kh.a.ys)}get vZ(){return this.um.sa(kh.a.ys,!1)}get isSuperscript(){return this.um.sa(bb.a.superscript,!1)}get cF(){return this.um.sa(bb.a.subscript,
!1)}get cG(){return this.um.sa(Bb.a.cG,null)}get Fs(){return this.um.sa(bb.a.Fs,!1)}get yZ(){return this.um.sa(bb.a.yZ,!1)}get En(){return this.um.sa(bb.a.En,!1)}get W7a(){return this.um.sa(Bb.a.W7a,!1)}get URa(){return this.um.sa(be.a.Lua,!1)}get PQa(){return this.um.Sa(kh.a.capitalization)}get capitalization(){return this.um.sa(kh.a.capitalization,0)}get OCa(){return this.um.sa(Bb.a.OCa,!1)}Hp(a,b){b.Sa(a)&&this.um.setValue(a,b.Sh(a))}static tBc(a){const b=new of;b.um.setValue(bb.a.fontSize,qf.a.Oel);
b.Hp(bb.a.superscript,a.propertySet);b.Hp(bb.a.subscript,a.propertySet);a.Fs&&b.um.setValue(bb.a.underline,!0);return b}}Object(e.a)(of,"PptSmartArtFormattingCache",null,[1037]);class Un{constructor(a,b,c,f){this.xbi=a;this.Abi=b;this.ybi=c;this.zbi=f}}Object(e.a)(Un,"SelectionImageProperty",null,[]);var om=d(147),Ve=d(71);class $i{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg){this.YGg=this.XGg=!1;if(!dg)throw Error.argumentNull("graphTopologyManager");this.ZB=
a;this.Ea=b;this.rc=c;this.VZj=f;this.vo=l;this.eC=x;this.A$b=F;this.SB=R;this.Ay=fa;this.sW=wa;this.ta=dg;this.EZc=Xa;this.j3j=lb;this.Kke=Lb&&!Wd;this.d9b=kc;this.iUa=lc;this.ryb=Ec;this.L8b=Jc;this.b4c=Dc&&!Wd;this.Iz=xe;this.cka=Sd;this.c_c=Pe;this.INb=Ue;this.N3j=Ef;this.ta=dg;this.C3j=Mg}i6a(a,b){if(b.sa(ub.a.fDa,!1))return qf.a.ZUg;b=this.Ea.DBa(this.Ea.kn(b));return Md.a.ty(b,1)?a:2*Math.round(a*b/2)}YFf(a,b){if(!this.INb||!a)return b;$i.H9f(a);return b}Pbj(a){if(!this.C3j||Ma.a.Va(a))return null;
const b=this.ta.presentation.$Vd;if(!b)return null;for(const c of b)if(c.Font===a)return c.SubstitutedByFont;return null}I9f(a,b,c){return c.nha(this.i6a(a,b))}p7f(a,b){return a.Sa(ub.a.Hob)?(a=a.getValue(ub.a.Hob)/Bk.a.dfc,b.Wda(a,0)+"px"):null}K$f(a){if(a.Sa(ub.a.Nvb)){const b=a.getValue(ub.a.Nvb)/Bk.a.dfc;a=a.fontSize;return 0<b&&a*Bk.a.w7a>=b?"normal":"none"}return null}PYd(a,b,c,f){let l=null;this.EZc?l=Eb.a.LH(0):!c&&f||!b.B2?this.Kke&&f&&(l=H.a.instance.ga(119)?b.sa(ub.a.e2b,!1)?this.k$f(a):
Eb.a.LH(b.fontColor):this.k$f(a)):(a=b.fontColor,l=a===Eb.a.auto?"WindowText":Eb.a.LH(a));return l}iph(a,b,c,f,l){return!b&&!c&&!f&&!l&&(!this.j3j||a.isSuperscript||a.cF)}feg(a){return a.Sa(ub.a.xM)?a.getValue(ub.a.xM)/1E3:0}d1d(){return 2/3}k$f(a){let b=null;var c=Object.assign(new Fm.a,{schemeClrField:Object.assign(new Nl.a,{valField:10})});a=Object(va.a)(122,this.rc.Sg(a));(c=this.VZj.CL(c,a?a.Se:null))&&(b=Cf.Box4ColorHelper.$ma(c).jU());return b}Ooh(a,b){return this.Kke||a||!b}qph(){return!0}Qoh(){return this.Kke}Mwl(a,
b,c,f){if(!c||!c.Ua||!f||1>f.length)return b;let l=0,x=0;for(let F=0;F<f.length;F++){if(c.Ua.Qa>=x&&c.Ua.Qa<x+f[F]||c.Ua.Qa===x+f[F]&&f[F]>b.Lines[F]){l=F;break}x+=f[F]}c=0;for(const F of b.Lines)c+=F;a=a.Ra.ga(a.Ra.length-1).cp;a+1!==c&&(b.Lines[l]+=a+1-c);return b}uMf(a,b){a=Object(va.a)(te.AParagraphNode,a);if(!a||!a.Ra)return!1;let c=0;for(let f of b)if(0>f.className.indexOf("EOP")){if(f.innerText!==a.characterData.substr(c,f.innerText.length))return!1;c+=f.innerText.length}return!0}Jxh(a,b,c,
f,l,x,F,R){if(!(this.d9b&&a&&c&&c.length&&b))return!1;var fa=this.Ea.kn(f);if(!fa)return!1;fa=this.iUa&&fa.Axb;if(!b.So&&!fa)return!1;f=Object(va.a)(te.AParagraphNode,f);if(!f||!f.Ra||!fa&&this.A$b.B4a(f))return!1;c=this.a0i(c,f,!b.So);if(this.eFi(a,c))return!1;if(0<=a.style.textAlign.indexOf("justify")){if(!this.vo||this.vo.psa)return!1;Sys.UI.DomElement.addCssClass(a,"JustifyAlign")}else Sys.UI.DomElement.removeCssClass(a,"JustifyAlign");return this.ryb?this.bpl(f,a,b,l,x,F,R):this.$ol(a,b,c)}tCh(a){this.iUa&&
a&&(a=this.Ea.kn(a))&&a.Axb&&(ya.a.J(512496915,820,50,"UpdateUseTextLayoutService - Fallback to HTML Text Layout for this shape."),a.Fhb(!1))}U5i(a,b){const c=om.a.Bi(a,ub.a.kIb,null);if(!c||!c.Lines)return null;if(!b){if(!a.Ra.length)return ya.a.J(512496914,820,50,"GetLineInfoIfValid - CharacterProperties length 0, TextLayout {0}",c.Lines.length),null;b=0;for(const f of c.Lines)b+=f;if(a.Ra.ga(a.Ra.length-1).cp+1!==b)return null}return c}$ol(a,b,c){if(!c)return!1;const f=new Ha.a;for(const l of c){c=
b.Oo(ka.a.span);Sys.UI.DomElement.addCssClass(c,mc.a.W7);f.add(c);let x=!1;for(let F=0;F<l;F++)if(a.firstChild)c.appendChild(a.firstChild);else{ya.a.J(512496913,820,10,"Span count not match between paragraph and countOfSpanInLine");x=!0;break}if(x)break}b=Object(va.a)(477,this.eC.VH(a));if(!b)return ya.a.J(512496912,820,10,"Line Box is not added because the ownership of paragraph dom is null"),!1;for(let l of f)b.Ho(l),a.appendChild(l);return!0}bpl(a,b,c,f,l,x,F){if(!b||!c)return!1;let R=om.a.Bi(a,
ub.a.kIb,null);if(!R||!R.Lines||!R.Lines.length)return!1;for(this.N3j&&(R=this.Mwl(a,R,x,F));l.count>f;)l.removeAt(f);a=new Ha.a;F=x=f=null;for(let fa=0;fa<R.Lines.length;fa++){f=c.Oo(ka.a.span);Sys.UI.DomElement.addCssClass(f,mc.a.W7);a.add(f);const wa=this.p1h(R.Lines[fa],b,f,x,F,l);x=wa.srk;F=wa.aAk;this.RXj(fa,R.Lines.length,f.lastChild);if(!wa.success){ya.a.J(512496911,820,50,"TryAddLineBoxWithSpanUpdatePerTextLayoutProperty - Number of chars specified by text layout not available in paragraph");
break}}for(this.szc(x,f,l);b.firstChild;)this.szc(b.firstChild,f,l);return this.apl(b,a)}RXj(a,b,c){$i.$Gg||(Se.Health.instance.recordKpiUsage("TextLineBreakWordBreakTelemetry",0,"pptotext",null),$i.$Gg=!0);!c||!c.innerText||1>c.innerText.length||(a=a+1===b,b=-1<c.innerText.indexOf(" "),c=" "!==c.innerText.charAt(c.innerText.length-1),!$i.ZGg&&!a&&b&&c&&(Se.Health.instance.recordKpiFailure("TextLineBreakWordBreakTelemetry","TLSWordBreakError",!1,!0,null),$i.ZGg=!0))}p1h(a,b,c,f,l,x){let F=!0;for(;0<
a;){if(!(f&&f.innerText.length||b.firstChild)){ya.a.J(512496910,820,10,"TryAddLineBoxSpanPerTextLayoutProperty - Number of chars specified not available");F=!1;break}let R;f?(l=R=f,f=null):(R=b.firstChild,l&&!Sys.UI.DomElement.containsCssClass(R,mc.a.OM)&&(l.style.lineHeight=R.style.lineHeight),l=null);const fa=R.innerText.length;a>=fa?(this.szc(R,c,x),a-=fa):(f=R.cloneNode(!1),this.Xfl(R,f,a),this.szc(R,c,x),a-=R.innerText.length)}return new Gm(F,f,l)}Xfl(a,b,c){a=a.childNodes;let f=-1;for(let l=
0;l<a.length;l++){const x=a[l];if(c)if(c>=x.innerText.length)c-=x.innerText.length;else{const F=x.cloneNode(!0);F.innerText=x.innerText.substring(c,x.innerText.length+1);b.appendChild(F);x.innerText=x.innerText.substring(0,c);c=0}else{f=l;break}}for(;-1!==f&&f<a.length;)b.appendChild(a[f])}szc(a,b,c){if(a&&b&&c){b.appendChild(a);a=Ba.a.t6a(a);for(let f of a)c.add(f),L.a.ov(f,"leafEltIdx",c.count-1)}}apl(a,b){const c=Object(va.a)(477,this.eC.VH(a));if(!c)return ya.a.J(512496909,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let f of b)c.Ho(f),a.appendChild(f);return!0}a0i(a,b,c){const f=this.lui(this.U5i(b,c));if(!f||!f.length)return null;c=f.length;const l=Array(c);let x=0,F=1;for(let R=0;R<b.Ra.length;R++)F<c&&b.Ra.ga(R).cp===f[F]&&(l[x]=a[R],x++,F++);l[c-1]=a[a.length-1];if(F!==c)return ya.a.J(512496908,820,50,"indexOfLineStartCp and countOfLine( TextLayout property) do not match"),null;a=Array(c);a[0]=l[0];for(b=1;b<c;b++)a[b]=l[b]-l[b-1];return a}lui(a){a=a?a.Lines:null;if(!a||!a.length)return a;const b=
Array(a.length);b[0]=0;for(let c=1;c<a.length;c++)b[c]=b[c-1]+a[c-1];return b}eFi(a,b){if(!b)return!1;a=a.childNodes;let c=0;for(const f of b){b=!0;for(let l=c;l<f+c&&l<a.length;l++)Sys.UI.DomElement.containsCssClass(a[l],mc.a.yM)||Sys.UI.DomElement.containsCssClass(a[l],mc.a.KSd)||(b=!1);if(b)return!0;c+=f}return!1}r8f(a,b,c){const f=new Ic.a;if(!a||!b||!c)return ya.a.J(512496907,826,15,"GetCustomAttributes: htmlViewInstance={0}, paragraphNode={1}, formattingCache={2}.",a?"not null":"null",b?"not null":
"null",c?"not null":"null"),f;this.l8k(a,b)&&(a=null,c.Sa(ub.a.schemeColor)&&(a=c.getValue(ub.a.schemeColor),a=this.g8i(b,a)),Ma.a.Va(a)||f.$("data-scheme-color",a),this.c_c&&c.Sa(ub.a.ARc)&&(c.getValue(ub.a.ARc)?f.$("data-usefontface","false"):f.$("data-usefontface","true")));return f}g8i(a,b){if(Ma.a.Va(b))return"";const c=Re.SchemeColor.parse(b);if(c&&c.color&&!c.Bra){a=Object(va.a)(122,this.rc.Sg(a));a=c.resolve(a?a.Se:null);if(!a)return"";c.fP=Ol.g(a.rXa);return c.toString()}return b}l8k(a,b){return this.L8b&&
a.Bl&&$i.TNj(b)}oPf(a){if(this.b4c){a=a.querySelectorAll("."+$i.NPd);const c=a.length,f=Array(c);for(var b=0;b<c;++b)f[b]=this.BRk(a[b]);for(b=0;b<c;++b)Ve.a.Xyj(a[b],f[b].xbi,f[b].Abi,f[b].ybi,f[b].zbi)}}zRk(a){return new Un("linear-gradient(to right, "+Ve.a.yDc+", "+Ve.a.yDc+")",Ve.a.ANe,"0px "+a.style.verticalAlign,Ve.a.hid)}BBj(a){for(a=a.firstChild;a;){if(!Sys.UI.DomElement.containsCssClass(a,mc.a.L6))return!1;a=a.nextSibling}return!0}ARk(a){let b=Number.MAX_VALUE,c=0,f=0;const l=a.querySelectorAll("span."+
mc.a.L6);for(let x=0;x<l.length;x++){const F=l[x];f+=this.i2i(F);b=Math.min(b,F.offsetLeft);c=Math.max(c,F.offsetLeft+F.offsetWidth)}return new Un("linear-gradient(to right, "+Ve.a.yDc+", "+Ve.a.yDc+")",0<c-a.offsetLeft?f+"px 100%":Ve.a.ANe,b-a.offsetLeft+"px "+a.style.verticalAlign,Ve.a.hid)}BRk(a){return this.BBj(a)?this.zRk(a):this.ARk(a)}i2i(a){let b=0;if((a=a.getClientRects())&&0<a.length)for(const c of a)b+=c.width;return b}s8f(a,b,c){return this.Iz&&a&&b&&c&&(Object(Fa.a)(347,a)||Object(Fa.a)(347,
this.ZB.Ld)&&a.Bl)?of.tBc(b):null}nph(){return!1}y_b(a){let b=a.sa(ub.a.latinFont,fd.Font.ZR);b.startsWith("+")&&(b=a.sa(bb.a.font,fd.Font.ZR));let c=new Ha.a;c.add(b);var f=[ub.a.eastAsianFont,ub.a.complexScriptFont,ub.a.WHb];for(var l of f)a.Sa(l)&&(f=a.getValue(l),!f||f.startsWith("+")||c.contains(f)||c.add(f));if(a=this.Pbj(b))l=new Ha.a,l.add(b),ee.a("UseServerFallbackFontFirst")?l.insert(0,a):l.add(a),this.AXj(a,c),c=l;return c.toArray().join(",")}AXj(a,b){this.XGg||ia.FontUtils.isMissingFont(b.ga(0))?
this.YGg||b.contains(a)||(ya.a.J(512496905,820,15,"Server fallback font mismatches browser fallback(s)."),this.YGg=!0):(ya.a.J(512496906,820,15,"Browser-used font available, but server-provided fallback mismatches."),this.XGg=!0)}nAe(a,b){if(a){var c=a.indexOf(",");0<c&&(a=a.substring(0,c))}c=!!this.SB&&this.SB.isEnabled;const f=!!this.Ay&&this.Ay.isEnabled;if(f||c||this.cka)b=ia.FontUtils.Pmb(b,a,c,this.cka,f);f&&this.Ay.createFontUrl(a);c&&(this.INb&&a?(c=$i.H9f(a),this.SB.createFontUrl(a),c&&this.SB.createFontUrl(c)):
this.SB.createFontUrl(a));this.cka&&this.sW.createFontUrl(a);return b}t7g(a,b){return a?this.nAe(a.fontName,b):b}PRc(){return this.cka}static JYd(a){if(Ma.a.Va(a))return null;const b=a.indexOf(",");-1<b&&(a=a.substring(0,b).trim());return a}static H9f(a){if(Ma.a.Va(a))return null;a=$i.JYd(a);let b=a.toLowerCase();for(;b;){let c=!1;b=b.trim();for(const f of $i.KTi){let l=f;b.endsWith("\u200b")&&(l+="\u200b");b.endsWith(l)&&(c=!0,b=b.substring(0,b.lastIndexOf(l)+1))}if(!c)break}return a.substring(0,
b.length)}static TNj(a){return a.sa(ub.a.fDa,!1)?!1:!0}}$i.NPd="Selection";$i.vTf="SelectionShadow";$i.KTi=" bold; italic; demibold; extrablack; extrabold; extralight; heavy; light; medium; regular; semibold; thin".split(";");$i.$Gg=!1;$i.ZGg=!1;Object(e.a)($i,"TextRenderingStrategy",null,[1249]);class pm{constructor(){this.mtb=[]}XCe(a){a&&!Array.contains(this.mtb,a)&&(a.qZ=this,Array.add(this.mtb,a))}odc(a,b){for(let c=0;c<this.mtb.length;c++){const f=this.mtb[c];f.ntb&&f.odc(a,b)}}}Object(e.a)(pm,
"AHighlightManager",null,[1246]);class ok extends pm{constructor(){super();this.fKg=this.f7b=null}get rha(){return this.f7b}get c9a(){return this.fKg}kfd(a){if(a&&((this.f7b=a)&&0===this.f7b.action&&(this.fKg=this.f7b),a.Nba||a.Fdb)){var b=[];for(let c=0;c<this.mtb.length;c++){const f=this.mtb[c];f.ntb&&Array.addRange(b,f.pxh(a.Nba,a.Fdb))}}}}Object(e.a)(ok,"HighlightManager",pm,[]);class Vn{constructor(a,b){this.Eta=a;this.D7b=b;this.Eta.xk(Object(D.a)(this,this.xh,"onPropertyChanged"))}dispose(){this.Eta.Tm(Object(D.a)(this,
this.xh,"onPropertyChanged"))}xh(a,b){a=b.node;b.property.id===ub.a.kIb.id&&a.isConnected&&!this.D7b.isComposing&&a.anchor.ir(208)}}Object(e.a)(Vn,"ParagraphNodeViewBehavior",null,[106]);class qm{constructor(a){this.D7b=a}fph(a){if(a=Object(va.a)(5,a)){if(this.D7b.isComposing){if(!a.UTc)return ya.a.J(22586562,822,50,"Skip paragraph view validation because CEV is in IME composing"),!0;ya.a.J(22586564,822,50,"invalidate paragraph view element because text changed in new revision")}a.UTc=!1}return!1}}
Object(e.a)(qm,"ParagraphViewElementCEVSetUpdateStrategy",null,[1337]);class Pl{constructor(a){this.X0c=[ub.a.ZV,ub.a.Nw,ub.a.lca,ub.a.mja,ub.a.kca,ub.a.lja,Bb.a.Il,Bb.a.kX,Bb.a.Mn,Bb.a.JCb,Bb.a.listLevel,bb.a.pl,bb.a.rI];this.SRh=a.O9d;this.qSc=a.qSc;this.RRh=a.pptCopyPasteMarginAndIndentationEnabled}get t9c(){return this.SRh}get Eui(){return!1}get v3g(){return this.RRh}get gsk(){return this.X0c}m$k(a){return!!a.tagName&&"p"===Ma.a.sg(a.tagName)&&Sys.UI.DomElement.containsCssClass(a,mc.a.Pda)}hQa(a){const b=
{};for(const c of this.X0c)b[c.id.toString()]=a.Sh(c);return b}Gma(a,b){if(b){const c=Ya.ParagraphReader.MV(a);this.h4k(a,b,this.X0c,this.ovg(a),c);a.setValue(be.a.j4b,!0)}}ovg(a){let b=!1;(a=mb.GraphIterator.mb(a).parentNode)&&Rd.OutlineElementReader.O7(a)&&(b=Ib.ListReader.LRa(a));return b}tck(a,b,c,f){this.v3g||(f=!0);if(this.t9c){const l=a.sa(be.a.j4b,!1),x=b.sa(be.a.j4b,!1),F=l||!f&&!x&&!l?b:a;this.Iui(F,l||!f&&!x&&!l?a:b,this.X0c,this.ovg(F),c)}}lfj(a){return this.v3g&&a?Ya.ParagraphReader.MV(a)&&
a.Sa(ub.a.c8d)&&!a.getValue(ub.a.c8d)&&a.Sa(Bb.a.Mn)?a.getValue(Bb.a.Mn).toString():"":""}h4k(a,b,c,f,l){for(const x of c)this.dph(x,f,l)||(c=b[x.id.toString()],void 0!==c?a.setValue(x,c):a.removeProperty(x))}Iui(a,b,c,f,l){for(const x of c)this.dph(x,f,l)||(c=b.Sh(x),void 0!==c?a.ke(x,c):a.removeProperty(x))}dph(a,b,c){return this.qSc&&!b&&c&&(a===Bb.a.Il||a===Bb.a.Mn)}}Object(e.a)(Pl,"PptFormattingPropertyTransitStrategy",null,[1286]);class ni{}ni.Dzh="UnderlineColor";ni.$kd="UnderlinePositionInEm";
ni.ald="UnderlineThicknessInEm";ni.CJc="FontSizePx";Object(e.a)(ni,"ParagraphViewElementProperties",null,[]);class un extends Wc{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue){super(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec);this.e6b=Jc;this.CJg=Dc;this.FIg=Wd&&!Sd;this.b4c=xe&&!Sd;this.DJg=Pe;this.$7j=Ue}$Gd(a,b){this.e6b?a.style&&!Ma.a.Va(a.style.verticalAlign)&&(Ma.a.Va(b.style.verticalAlign)?(b.style.verticalAlign=a.style.verticalAlign.startsWith("-")?a.style.verticalAlign.substring(1,
a.style.verticalAlign.length):"-"+a.style.verticalAlign,this.I6h(a)):a.style.verticalAlign="",b.style.lineHeight="0px"):super.$Gd(a,b)}I6h(a){if(null!==a.style&&!Ma.a.Va(a.style.verticalAlign)){if(this.CJg&&this.YGj(a)){const b=a.style.backgroundColor;a.style.backgroundColor=null;Ve.a.EEf(a,String.format("linear-gradient(to right, {0}, {0})",b),Ve.a.ANe,String.format("0px {0}",a.style.verticalAlign),Ve.a.hid)}if(this.b4c||this.CJg)a.style.verticalAlign.startsWith("-")?a.style.paddingTop=a.style.verticalAlign.substring(1,
a.style.verticalAlign.length):a.style.paddingBottom=a.style.verticalAlign}}qYd(a){return this.e6b?"0px":super.qYd(a)}LDf(a){a.style.position=Ve.a.llc}YGj(a){return Sys.UI.DomElement.containsCssClass(a,"Highlight")&&null!==a.style&&a.style.backgroundColor!==Ve.a.Noi}lEe(a,b,c,f){if(this.FIg&&b.Fs){if(b.bF||b.vZ)a.style.textDecoration=Ve.a.Shl,f[f.length]="Strikethrough";b.pD&&(f[f.length]="Underlined");let l,x;this.$7j&&({$kd:l,ald:x}=this.qgj(b.TM)).returnValue?(L.a.ov(a,ni.Dzh,this.pgj(c,b)),L.a.ov(a,
ni.$kd,l),L.a.ov(a,ni.ald,x)):Ma.a.Va(a.style.textDecoration)?a.style.textDecoration=Ve.a.Dth:a.style.textDecoration+=" "+Ve.a.Dth}else super.lEe(a,b,c,f)}pgj(a,b){a=this.Dv.PYd(a,b,!1,!0);return String.format("linear-gradient(to right, {0}, {0})",a)}qgj(a){return{returnValue:"Calibri"===a,$kd:1.1133,ald:.0654}}kDj(a,b){if(!a||!b)return!1;for(a=a.firstChild;a;){if(Sys.UI.DomElement.containsCssClass(a,mc.a.L6))return!0;a=a.nextSibling}return!1}KDf(a,b){this.b4c&&(Sys.UI.DomElement.containsCssClass(b,
mc.a.L6)||this.kDj(a,mc.a.L6)?(Sys.UI.DomElement.addCssClass(a,$i.NPd),this.DJg&&n.a.Hj&&Sys.UI.DomElement.addCssClass(a,$i.vTf)):(Sys.UI.DomElement.removeCssClass(a,$i.NPd),this.DJg&&n.a.Hj&&Sys.UI.DomElement.removeCssClass(a,$i.vTf)));if(this.FIg&&Sys.UI.DomElement.containsCssClass(a.parentNode,mc.a.tkg)){const c=L.a.re(a,ni.Dzh),f=L.a.re(a,ni.ald);let l=L.a.re(a,ni.$kd);if(c&&f&&l){if(!Ma.a.Va(a.style.fontSize)&&a.style.fontSize.endsWith("px")&&!Ma.a.Va(b.style.verticalAlign)&&b.style.verticalAlign.endsWith("px")){a=
parseFloat(a.style.fontSize);const x=parseFloat(b.style.verticalAlign);isNaN(a)||!a||isNaN(x)||(l-=x/a)}Ve.a.EEf(b,c,String.format("100% {0}em",f),String.format("0% {0}em",l),Ve.a.hid);b.style.textDecoration=Ve.a.Thl}}}}Object(e.a)(un,"PptParagraphContentRenderer",Wc,[]);class Io{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Paragraph"}Wb(a){this.K=a;this.YCe();this.eDe();this.OLk();this.aDe();this.VLk();this.WLk();this.NLk()}init(){this.K.register(1246,"Box4.Highlight.IHighlightManager").ma().na(()=>
new ok);this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393230,new Em.a((a,b)=>new Ok(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.PptParagraphContentRenderer"),new Qb.a(a,b),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),()=>null,()=>null,a.Bl&&u.AFrameworkApplication.fa.ka("SkipUpdateContentEditableViewWhenComposing")?this.K.resolve("PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy"):this.K.resolve("Box4.DefaultParagraphViewElementSetUpdateStrategy"),
this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.IParagraphOverlayControlRenderer"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393234,new Em.a((a,b)=>new nm(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),
this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)));this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior")}dispose(){this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior").dispose()}YCe(){this.K.register(1247,"PowerPointWebEditor.IListMarkerOffsetCache").ma().na(()=>new Sf);this.K.register(1248,"Box4.IListMarkerUtility").ma().na(()=>new Ml(this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphIndentationReader"),Sa.a.instance,this.K.resolve("PowerPointWebEditor.IListMarkerOffsetCache"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Graph.ISmartArtReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("Box4.IInteractiveViewManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderListBulletStyleInBox4Enabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").w8a,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteListMarkerEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteMarginAndIndentationEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}eDe(){this.K.register(1249,"Box4.ITextRenderingStrategy").ma().na(()=>
new $i(this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IBox4ColorHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.pb("Box4.CloudFontService"),this.K.pb("Box4.CustomFontService"),this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").org,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jvg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Gvg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").w8a,this.K.resolve("PowerPointWebEditor.IApplicationSettings").lIb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ivh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").fTc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ivg,
this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").mGj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").rll,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").E_k))}OLk(){this.K.register(gp,"Box4.DefaultParagraphViewElementSetUpdateStrategy").ma();this.K.register(qm,"PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy").ma().na(()=>new qm(this.K.resolve("Box4.IEditingView")))}aDe(){this.K.register(Tn,"PowerPointWebEditor.ParagraphViewIndentationStrategy").as("Box4.IParagraphViewIndentationStrategy").ma().na(()=>new Tn(this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.IParagraphIndentationReader"),
this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),new Th.a))}VLk(){this.K.register(Pl,"PowerPointWebEditor.Paragraph.PptFormattingPropertyTransitStrategy").as("Box4.IFormattingPropertyTransitStrategy").ma().na(()=>new Pl(this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}WLk(){this.K.register(un,"PowerPointWebEditor.PptParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().na(()=>
new un(pa.InteractiveViewManager.instance,ja.a.instance,this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.IFormattingPropertyTransitStrategy"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.pb("Box4.Proofing.IIgnoreAllKeywords"),this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.ParagraphContentRendererSettings"),this.K.resolve("Box4.ILineSpacingHelper"),this.K.pb("Box4.IFeatureHelper"),ia.FontUtils.Pti,this.K.pb("Box4.IFontSlotProvider"),
Object(D.a)(this.K.resolve("Box4.IEditStateEventManager"),this.K.resolve("Box4.IEditStateEventManager").M9g,"raiseParagraphContentUpdatedEvent"),tb.a.language,this.K.pb("Box4.ITableOfContentRenderHelper"),ec.a.yIf,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorDifferentLineHeightEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jvg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Gvg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ivg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextSelectionShadowFixIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Z8k))}NLk(){this.K.register(Vn,"PowerPointWebEditor.ParagraphNodeViewBehavior").ma().na(()=>new Vn(this.K.resolve("Box4.Graph.IGraphInstance").Bd(12),this.K.resolve("Box4.IEditingView")))}static main(){m.a.instance.Ac(new Io)}}Object(e.a)(Io,"PPTWebEditorParagraphPackage",null,[2,3]);var lh=d(113),pk=d(489),aq=d(610);class pf extends Sys.EventArgs{constructor(a){super();
this.tk=a}}Object(e.a)(pf,"PopSessionClosedEventArgs",Sys.EventArgs,[]);class ei{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd){this.Fme=this.Jta=null;this.Ce=a;this.Uv=b;this.Kd=c;this.hc=f;this.la=l;this.nbc=x;this.i1c=F;this.Fx=R;this.Ue=fa;this.Yca=wa;this.ra=Xa;this.Af=lb;this.ta=Lb;this.ia=kc;this.yb=lc;this.o8=Ec;this.zo=Dc;this.UB=Wd;F.yGd(Object(D.a)(this,this.mCb,"onPodSessionUnavailable"));F.Qmb(Object(D.a)(this,this.Hda,"onPodSessionRefreshed"));Jc.uB(Object(D.a)(this,this.jo,
"onSessionRehydrated"));this.vne=new He.a(4,2,2E3,Object(D.a)(this,this.detectFailoverTimeout,"detectFailoverTimeout"),90,"18")}get isEnabled(){return this.la.vg}get n4b(){return!!this.Jta}H9i(a,b){const c=Mc.a.hm("GetPodSessionInfo");try{const f=this.Ce.podSessionId,l=lh.a.create().toString(),x=String.format("{0}PodHandler.ashx?action=GetPodSessionInfo",this.la.podsWebServiceBase),F={};F.PodSID=f;F["X-UserSessionId"]=this.nbc();F["X-CorrelationID"]=l;c.Wa("PodSessionId",f);c.Wa("Cid",l);this.Uv.FY(x,
2,null,F,[gg.a.q4],0,R=>{try{if(f!==this.Ce.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Ce.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{var fa=!0;if(R.data){if(c.Wa("HttpStatus",R.data.af.toString()),c.Wa("RequestStatus",pk.a[R.data.status]),R.data.mj){const wa=R.data.mj[gg.a.q4];wa&&"errorCannotFindSession"===wa&&(c.Wa("ErrorCode",wa),fa=!1)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");fa?(c.Wa("Result","Succeeded"),
c.finish(),a&&a()):(c.Wa("Result","Failed"),c.finish(!0),b&&b())}}catch(wa){ya.a.J(512496143,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",wa),b&&b()}},R=>{try{if(f!==this.Ce.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Ce.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{if(R.data){if(c.Wa("HttpStatus",R.data.af.toString()),c.Wa("RequestStatus",pk.a[R.data.status]),R.data.mj){const fa=R.data.mj[gg.a.q4];fa&&c.Wa("ErrorCode",
fa)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");c.Wa("Result","Failed");c.finish(!0);b&&b()}}catch(fa){ya.a.J(512496142,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",fa),b&&b()}},null,void 0,void 0,this.la.J9i,this.la.K9i,"GetPodSessionInfo",void 0,!0)}catch(f){ya.a.J(512496141,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",f),c.Wa("Result","Failed"),c.finish(!0),b&&b()}}mCb(a,b){a=!1;this.Jta?ya.a.J(512496140,801,15,"PodSessionManager::OnPodSessionUnavailable - Already unavailable. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",
this.Ce.presentationId.string,this.Fx.Iia,this.Ue.Xz,this.Ce.tk,this.Ce.podSessionId,!this.hc.ln,Mc.a.Ye(this.Jta),!!this.zo.instance,b.xIc):(this.Jta=new Date,a=!0,ya.a.J(512496139,801,15,"PodSessionManager::OnPodSessionUnavailable - Unavailable is detected. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Ce.presentationId.string,
this.Fx.Iia,this.Ue.Xz,this.Ce.tk,this.Ce.podSessionId,!this.hc.ln,Mc.a.Ye(this.Jta),!!this.zo.instance,b.xIc));this.o8.instance&&this.o8.instance.HSc?ya.a.J(512496138,801,15,"PodSessionManager::OnPodSessionUnavailable - IsNonDismissibleDialogShown is TRUE, ignore Pods unavailable signal. PopSessionId:{0}; PodSessionId:{1}",this.Ce.tk,this.Ce.podSessionId):this.Fx.Iia&&this.la.podsSeamlessFailoverEnabled&&this.zo.instance?this.zo.instance.IQe(b.xIc,4,b.errorCode):(this.Kd.wia=!1,this.Fx.Iia?this.Ue.Xz?
(a&&this.yb.Gb(this.vne),this.Yca.yMc(this.Ce.presentationId.string,this.Ce.tk,this.Ce.podSessionId,b.xIc,c=>{this.aVk(c,this.Ce.tk)},c=>{this.$Uk(c,this.Ce.tk)}),this.ra.setSelection(null),this.Af.blockContent(this.ta.presentation,"OnPodSessionUnavailable",!0),ya.a.J(512496136,817,15,"PodSessionManager::OnPodSessionUnavailable, Block Presentation")):this.Fmj():ya.a.J(512496137,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since session is not ready. PodSessionId:{0}",this.Ce.podSessionId))}Fmj(){this.Fme||
(this.Fme=new Date);const a=+new Date-+this.Fme;a>this.la.podsNullSrmWaitTimeInMs?(ya.a.J(512496135,801,15,"PodSessionManager::OnPodSessionUnavailable - Already wait {0}ms, won't wait anymore. PodSessionId:{1}",a,this.Ce.podSessionId),u.AFrameworkApplication.Xo(uf.a.Mh(305)),Se.Health.instance.recordQosError("ErrorCannotFailoverRehydration",["UnexpectedAppRefresh"],!1,!1,!0,!0,null),this.ia.Ka(ba.a.refresh,2,{refreshtrigger:"PodSessionManager::HandleNullPodFailoverManager"})):ya.a.J(512496134,801,
15,"PodSessionManager::OnPodSessionUnavailable - Skip since PodFailoverManager is not ready. MaxWaitTime:{0}ms; ElapsedTime:{1}ms. PodSessionId:{2}",this.la.podsNullSrmWaitTimeInMs,a,this.Ce.podSessionId)}detectFailoverTimeout(){if(this.Jta){var a=+new Date-+this.Jta;a>this.la.podsFailoverBrowserWaitTimeoutInMs&&(this.yb.Qg(this.vne),ya.a.J(512496133,801,15,"PodSessionManager::DetectFailoverTimeout - Won't wait for failover any longer. ElapsedTimeInMs:{0}, PodSessionId:{1}, PopSessionId:{2}",a,this.Ce.podSessionId,
this.Ce.tk),a=Object.assign(new Kg.a,{Code:293,Source:6}),this.Kd.Rr(a,this.Ce.podSessionId,b=>{b.xB=1;b.$za=8;return!1}))}}aVk(a,b){a&&(this.Ce.tk!==b?ya.a.J(512496132,801,15,"PodSessionManager::RetrievePODSInfoSucceeded - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Ce.tk,b,this.Ce.podSessionId):(b=a.result)?(ya.a.J(512496131,817,50,"PodSessionManager::RetrievePODSInfoSucceeded - OldPodSessionId:{0}; NewPodSessionId:{1};",this.Ce.podSessionId,
b.DocumentSessionID),this.Ce.podSessionId!==b.DocumentSessionID&&(a=this.Ce.podSessionId,this.Ce.podSessionId=b.DocumentSessionID,this.i1c.O9g(new aq.a(a,b.DocumentSessionID)))):ya.a.J(512496130,801,10,"Return type: {0}. PodSessionId:{1}, PopSessionId:{2}",a.result?Object.getType(a.result):null,this.Ce.podSessionId,this.Ce.tk))}$Uk(a,b){if(this.Ce.tk!==b)ya.a.J(512496129,801,15,"PodSessionManager::RetrievePODSInfoFailed - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",
this.Ce.tk,b,this.Ce.podSessionId);else{b=316;var c=-1;a&&a.error&&(b=uf.a.EM(a.error.Lm),c=a.error.Lm);ya.a.J(512496128,801,15,"PodSessionManager::RetrievePODSInfoFailed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; ResponseRecievedTime:{4}; BSQMErrorCode:{5}; ServerErrorCode:{6}",this.Ce.presentationId.string,this.Ce.tk,this.Ce.podSessionId,"",Mc.a.Ye(new Date),c,b);c===uf.a.Mh(241)&&(this.Ue.Xz=!1,this.Ue.Zea&&this.UB.VBe(new pf(this.Ue.jca)))}}Hda(a,
b){Mc.a.Xvb=new Date;Mc.a.Jjd=[];this.Ce.podSessionId!==b.YW?ya.a.J(512496099,801,15,"PodSessionManager::OnPodSessionRefreshed - PodSessionId should not change when we get the event! ExpectedPodSessionId:{0}; NewPodSessionId:{1}; PopSessionId:{2}",this.Ce.podSessionId,b.YW,this.Ce.tk):(this.yb.Qg(this.vne),ya.a.J(512496098,801,15,"PodSessionManager::OnPodSessionRefreshed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; PodsUnavailableStartTime:{4}; PodsRefreshedTime:{5}",
this.Ce.presentationId.string,this.Ce.tk,b.UBb,b.YW,Mc.a.Ye(this.Jta||new Date),Mc.a.Ye(new Date)),this.Kd.wia=!1,this.la.podsSeamlessFailoverEnabled&&this.zo.instance?ya.a.J(512496097,801,15,"PodSessionManager::OnPodSessionRefreshed - Skip refresh Doc since seamless failover is on."):(a={failedMachineId:null,isPlanedShutdown:!1,isPodSessionRefreshed:!0},a.podSessionId=b.YW,this.ia.Ka(ba.a.jEb,2,a)),this.Jta=null)}jo(){this.Jta=null}}Object(e.a)(ei,"PodSessionManager",null,[1244]);var jj;(function(a){a[a.active=
0]="active";a[a.passive=1]="passive";a[a.hidden=2]="hidden";a[a.frozen=3]="frozen"})(jj||(jj={}));Object(e.b)("AppVisibilityState",jj);class Vm{constructor(){this.IsTabHidden=!1;this.PresentationID=this.PopSessionID=null}}Object(e.a)(Vm,"GetHostSessionInfoParams",null,[]);class to{constructor(a,b,c,f,l,x,F,R,fa,wa){this.a2c=0;this.XEa=this.hka=this.soe=null;this.jOg=0;this.Wqe=!1;this.Xa=b;this.qzb=a;this.Ue=c;this.la=f;this.o8=l;this.KN=x;this.Xca=F;this.hc=R;this.EN=fa;this.Cua=wa;this.Twb=0;this.lzb=
this.la.getHostSessionInfoRequestTimeoutInMs;this.S5j=this.la.getHostSessionInfoRequestMaxTimeoutInMs;this.Y5j=this.la.getHostSessionInfoPingIntervalForFailedResponseInMs;this.c_j=f.maxPopsRehydrationCount;this.Bne=this.la.I4g;this.rzb=this.la.podsPopSessionDisconnectedTimeLimitInMS;this.Aja=!1;this.Eyb=this.Xa.tk;this.OJg="";this.cdd();this.NHa(0,!0)}cdd(){this.a2c=0;this.XEa=new Date}aii(a){if(this.Lia&&!u.AFrameworkApplication.Xg&&this.hc.BK){var b=!1;this.Cua&&this.Cua.instance&&(b=2===this.Cua.instance.U2a,
this.Wqe||(this.Wqe=!0,this.Cua.instance.Mzc(Object(D.a)(this,this.IDh,"visiblityChanged"))));var c=Object.assign(new Vm,{PopSessionID:this.Xa.tk,PresentationID:this.Xa.presentationId.string,IsTabHidden:b});this.soe=new Date;b=Math.min(this.lzb+2E3*this.a2c,this.S5j);var f=xa.a.gH("RequestTimeout",b.toString());this.qzb.NLc(c,()=>{this.ikk(c.PopSessionID,a)},l=>{this.hkk(l,c.PopSessionID,a)},null,f,this.la.getHostSessionInfoRequestTimeoutInMs,b+2E3)}else this.hc.BK&&(ya.a.J(24655577,801,50,"HostSessionInfoCaller::CallGetHostSessionInfo - Skipped. IsClientActive:{0}; IsShuttingDown:{1}; IsNonDismissibleDialogShown:{2}; AppInReadMode:{3};",
this.Lia,u.AFrameworkApplication.Xg,!!this.o8.instance&&this.o8.instance.HSc,!this.hc.ln),this.close(this.Lia?this.hc.BK?"AppShuttingDown":"TransitionedToReadingMode":"ClientDisabled"))}NHa(a,b){this.hka=new Date;this.jOg=window.setTimeout(()=>{this.aii(b)},a)}Ewl(a){ya.a.J(24655581,801,50,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded - popSessionId:{0}, TimeTakenInMs:{1}",a,+new Date-+this.soe);this.cdd();this.Twb=0;this.Ue.jbe=this.XEa;this.Ue.ibe=a}ikk(a,b){this.EN.eic();this.KN.z1f(a,
"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded")?this.NHa(0,b):(this.Ewl(a),b&&this.NHa(this.la.getHostSessionInfoPingIntervalInMs,!0))}IDh(a,b){ya.a.J(592852376,801,50,"HostSessionInfoCaller.VisiblityChanged - Old:{0},  New:{1} ",jj[b.oldState],jj[b.newState]);this.NHa(0,!1)}Hii(){return this.Xca.n4b||!this.Lia?(ya.a.J(36320459,801,15,"HostSessionInfoCaller.CanRehydrateHostSession - Skip POPS Rehydration. IsPodSessionUnavailable:{0}; IsClientActive:{1}; Now:{2}",this.Xca.n4b,this.Lia,Mc.a.Ye(new Date)),
!1):this.Twb>this.c_j?(ya.a.J(36996355,801,10,"HostSessionInfoCaller::CanRehydrateHostSession: Skip POPS rehydration, abort the ping client and raise an ACE error because we exceeded max rehydration threshold. Total number of POPS created so far:{0}; Max Allowed:{1};",this.Twb,this.la.maxPopsRehydrationCount),this.close("POPSRehydrationThresholdReached"),this.KN.P2d(uf.a.Mh(328),"HostSessionInfoCaller::CanRehydrateHostSession"),!1):!0}eea(a){this.Hii()&&(++this.Twb,this.KN.eea(a),this.cdd())}W9k(a){if(uf.a.zS(a))switch(uf.a.EM(a)){case 326:case 240:case 103:return!0;
case 329:return this.la.EMk}return!1}u2i(a){if(uf.a.zS(a))switch(uf.a.EM(a)){case 326:return 10;case 240:return 1;case 103:return 12;case 329:return 13;default:return 14}else return 14}hkk(a,b,c){a.tX&&200===a.tX.af&&this.EN.eic();if(this.KN.z1f(b,"HostSessionInfoCaller::OnGetHostSessionInfoFailed"))this.NHa(0,c);else{++this.a2c;var f=+new Date-+this.XEa,l=44,x=-1;a&&a.error&&(l=uf.a.zS(a.error.Lm)?uf.a.EM(a.error.Lm):44,x=a.error.Lm);a=xa.a.gH("PopSessionId",b,"ServerErrorCode",l,"BSQMErrorCode",
x,"TimeTakenInMs",+new Date-+this.soe,"RetryCount",this.a2c,"PopSessionDisconnectedTimeLimitInMS",this.rzb,"PopsIdleTimeLimitInMS",this.Bne,"Now",Mc.a.Ye(new Date),"CurrentDisconnectedTimeInMs",f,"PopSessionCreatedCount",this.Twb,"LastPingScheduledTime",Mc.a.Ye(this.hka),"LastSuccessfulEnsureHostSessionId",this.Ue.hbe);b="";try{b=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(F){ya.a.J(36320455,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Exception thrown while serializing the log string:{0};",
F)}ya.a.J(24655583,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Ping request failed: "+b);+new Date-+this.hka>this.rzb?this.NHa(0,c):this.W9k(x)?this.eea(this.u2i(x),x):x===uf.a.Mh(370)?f<this.Bne?this.NHa(this.la.getHostSessionInfoPingIntervalInMs,c):this.eea(11,x):f>=this.rzb?this.eea(3,x):this.NHa(this.Y5j,c)}}sce(a){const b=xa.a.gH("LastUsedPopSessionId",this.Eyb,"LastClientClosedReason",this.OJg,"IsClientActive",this.Lia,"AppInEditingMode",this.hc.ln,"PopSessionDisconnectedTimeLimitInMS",
this.rzb,"PopsIdleTimeLimitInMS",this.Bne,"Now",Mc.a.Ye(new Date),"ConsecutivelyTriggeredPopsRehydrationCount",this.Twb,"LastPingScheduledTime",Mc.a.Ye(this.hka),"LastSuccessfulEnsureHostSessionId",this.Ue.hbe);let c;try{c=Sys.Serialization.JavaScriptSerializer.serialize(b)}catch(f){ya.a.J(51421313,801,15,"HostSessionInfoCaller::LogPopsState - Exception thrown while serializing the log string:{0};",f),c=""}ya.a.J(51421315,801,15,"HostSessionInfoCaller::LogPopsState:{0} - {1}",a,c)}qHa(a){ya.a.J(36282957,
801,15,"HostSessionInfoCaller.Reboot - Reason:{0}. Restarted on PopSession {1}. LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.tk,this.Eyb,this.Lia);this.Lia&&this.Eyb===this.Xa.tk||(this.Eyb=this.Xa.tk,this.cdd(),this.Aja?(this.Aja=!1,this.NHa(0,!0)):ya.a.J(51421318,801,15,"HostSessionInfoCaller.Reboot did not schedule a ping request as the client was not closed previously - Reason:{0}; PopSession:{1}; LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.tk,this.Eyb,this.Lia))}close(a){this.Aja||
(ya.a.J(36536660,801,15,"HostSessionInfoCaller.Close - PopSession:{0}; Now:{1}; Reason:{2};",this.Xa.tk,Mc.a.Ye(new Date),a),this.Wqe&&this.Cua&&this.Cua.instance&&this.Cua.instance.fQk(Object(D.a)(this,this.IDh,"visiblityChanged")),this.Aja=!0,this.Eyb="",this.OJg=a,window.clearTimeout(this.jOg))}get Lia(){return!this.Aja}}Object(e.a)(to,"HostSessionInfoCaller",null,[]);class Wm{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb){this.tka=null;this.qzb=a;this.Xa=b;this.Mc=c;this.Ue=f;this.la=l;this.o8=x;this.KN=
F;this.Xca=R;this.hc=fa;this.EN=Xa;this.Cua=lb;this.Mc.zGd(Object(D.a)(this,this.Pcb,"onPopSessionClosed"));this.Mc.tB(Object(D.a)(this,this.Tcb,"onSessionEnded"));this.Ue.Zea&&this.Mc.AGd(Object(D.a)(this,this.dWa,"onPopSessionInitialized"))}rxj(){ya.a.J(24655587,801,50,"PopSessionInfoClient::InitializeGetHostSessionInfoClient");this.Ue.Xz?this.Qve():this.Ue.Zea||this.Ue.Oec.task.continueWith(()=>{this.Qve()})}dWa(){this.Qve()}Qve(){this.Ue.Zea?!this.tka&&this.Ue.Xz?this.tka=new to(this.qzb,this.Xa,
this.Ue,this.la,this.o8,this.KN,this.Xca,this.hc,this.EN,this.Cua):this.qHa("PopSessionInitialized"):this.Ue.Xz&&(this.nlc(),this.tka=new to(this.qzb,this.Xa,this.Ue,this.la,this.o8,this.KN,this.Xca,this.hc,this.EN,this.Cua))}Pcb(){this.close("PopSessionClosed")}Tcb(){this.sce("SessionClosed")}sce(a){this.tka&&this.tka.sce(a)}nlc(){this.Ue.Oec.task.continueWith(()=>{this.Rve()})}Rve(){this.Ue.Xz&&this.qHa("PopSessionInitialized");this.nlc()}qHa(a){this.tka&&this.tka.qHa(a)}close(a){this.tka&&this.tka.close(a)}get Lia(){return!!this.tka&&
this.tka.Lia}dispose(){this.Mc.jdh(Object(D.a)(this,this.Pcb,"onPopSessionClosed"));this.Ue.Zea&&this.Mc.UDe(Object(D.a)(this,this.dWa,"onPopSessionInitialized"))}}Object(e.a)(Wm,"PopSessionInfoClient",null,[1245,106]);var Ql=d(280),Lj=d(216),Ri=d(110),Mj=d(640),Qk=d(315),vn=d(841),hp=d(829);const rm=a=>{if(uf.a.zS(a)){a=uf.a.EM(a);if(hp.a(a))return 1;switch(a){case 103:case 44:case 370:return 0;case 309:case 311:case 27:case 320:case 244:case 245:case 372:return 1;case 326:return 2;default:return 3}}else switch(a){case uf.a.iBa:case uf.a.qUc:return 0;
default:return 3}};class El{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb){this.Xa=a;this.Ue=b;this.Kd=c;this.la=f;this.dv=l;this.UB=x;this.O8=F;this.Yca=Xa;this.hc=lb;this.Xca=fa;this.hLg=this.la.hermesNotRefreshErrorList;this.ime=this.la.podsMaxRetryTimesForEnsureHostSession;this.QKg=this.la.podsMaxRetryDurationForEnsureHostSessionInMs;this.la.vg&&(R.M5h(Object(D.a)(this,this.Xok,"onSyncLoopStatusNotified")),wa.D4h(Object(D.a)(this,this.Vok,"onSuccessfulOutbound")),wa.Mga(Object(D.a)(this,this.Vz,"onUnifiedAppStateChanged")));
u.AFrameworkApplication.zz&&wa.Szc(Object(D.a)(this,this.Mda,"onWopiTokenRefreshed"))}eea(a,b=null,c=null){var f=this.O8.Q5a(this.Xa.presentationId.string);f=Object.assign(new Mj.a,{ForceCreatePods:!1,DoRehydrate:!0,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.la.podsWebServiceBase,PopSessionID:f,UrlOverrides:this.la.Vda,IsCoauthSession:u.AFrameworkApplication.Pg.IsCoauthSession,IsCreateNewSession:this.la.xS,UseSharedHostFile:this.la.FJb});
this.O8.$Bc(f,b,c,a)}Vue(a,b){if(this.A1f(b,"PopSessionManager::OnEnsureHostSessionSucceeded"))this.vbh();else{var c=new Date;this.Xa.tk=b.XA.PopSessionID;this.Ue.Xz=!0;this.Ue.Nec=!0;this.Ue.hbe=b.XA.PopSessionID;this.Ue.eja=c;this.Ue.Zea&&this.UB.xFk();ya.a.J(22934494,801,15,"PopSessionManager::OnEnsureHostSessionSucceeded - OldPopSessionID: {0}, ExpectedPopSessionId: {1}, ExpectedPodSessionId: {2}, CurrentPodSessionId:{3}, Trigger: {4}, Retries: {5}, StartTime: {6}, EndTime: {7}, Duration: {8}ms, ActionId: {9},",
b.VVa,b.XA.PopSessionID,b.XA.PodSessionID,this.Xa.podSessionId,vn.a[b.trigger],b.retryCount,Mc.a.Ye(b.startTime),Mc.a.Ye(c),+c-+b.startTime,b.actionId);b.cH&&b.cH(a)}}dCb(a,b){let c=a.error.Lm;const f=new Date;if(this.A1f(b,"PopSessionManager::OnEnsureHostSessionFailed -"))this.vbh();else{if(b.retryCount<this.ime&&+f-+b.startTime<=this.QKg){if(0===rm(c)||c===uf.a.Mh(252)){b.retryCount++;a=this.O8.Q5a(this.Xa.presentationId.string);ya.a.J(23349401,801,50,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, Now: {8}, Duration: {9}ms, bSqmErrorCode: {10}, ActionId: {11},",
"PopSessionManager::OnEnsureHostSessionFailed -",b.VVa,b.XA.PopSessionID,b.XA.PodSessionID,this.Xa.podSessionId,vn.a[b.trigger],b.retryCount,Mc.a.Ye(b.startTime),Mc.a.Ye(f),+f-+b.startTime,c,b.actionId);b.XA.PopSessionID=a;b.XA.IsRetrySession=!0;this.O8.IKf(b);return}this.Ue.eja=f;var l="FatalError"}else this.Ue.eja=f,l=b.retryCount>=this.ime?String.format("Exceeded the limit of {0} times of retrying",this.ime):String.format("EnsureHostSession duration exceeded the limit of {0}ms. ElapsedTime: {1}ms",
this.QKg,+f-+b.startTime);c===uf.a.iBa&&(c=0===b.trigger?uf.a.Mh(375):uf.a.Mh(309));ya.a.J(23667161,801,10,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, EndTime: {8}, Duration: {9}, bSqmErrorCode: {10}, AbortReason: {11}, ActionId:{12},","PopSessionManager::OnEnsureHostSessionFailed -",b.VVa,b.XA.PopSessionID,b.XA.PodSessionID,this.Xa.podSessionId,vn.a[b.trigger],b.retryCount,Mc.a.Ye(b.startTime),
Mc.a.Ye(f),+f-+b.startTime,c,l,b.actionId);b.Ew&&b.Ew(a)||this.P2d(c,"PopSessionManager::OnEnsureHostSessionFailed -")}}A1f(a,b){return a.XA.PodSessionID!==this.Xa.podSessionId?(ya.a.J(512262810,801,15,"EnsureHostSession - Ignore response since PodSessionId is changed. CurrentPodsSession:{0}; RequestPodsSession:{1}; functionName:{2} Need to trigger another request immediately.",this.Xa.podSessionId,a.XA.PodSessionID,b),!0):!1}vbh(){this.Ue.eja=new Date;this.eea(8)}Xok(a,b){a=uf.a.Mh(b.ouh);ya.a.J(512262809,
801,10," {0} - ServerErrorCode:{1}, bSqmErrorCode:{2}, PopSessionId:{3}, PodSessionId:{4}","PopSessionManager::OnSyncLoopStatusNotified",b.ouh,a,this.Xa.tk,this.Xa.podSessionId);this.Ue.Xz=!1;this.Ue.Zea&&this.UB.VBe(new pf(this.Ue.jca));this.P2d(a,"PopSessionManager::OnSyncLoopStatusNotified",b.VNi)}Mda(a,b){try{b.YTc?(ya.a.J(512262808,814,50,"PopSessionManager::OnWopiTokenRefreshed Token refresh succeeded."),b.HKj||(this.nob(()=>{},()=>{}),this.eea(9))):ya.a.J(512262807,814,15,"PopSessionManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){ya.a.J(512262806,
814,10,"PopSessionManager::OnWopiTokenRefreshed Exception: {0}",c)}}z1f(a,b){return a&&this.Xa.tk&&this.Xa.tk!==a?(ya.a.J(512262805,801,15,"PopSessionManager::FStaleResponse - RequestingFunctionName:{0} - Ignore response since PopSessionId is changed. CurrentPopSessionId:{1}; RequestPopSessionId:{2}; LastAttemptedEnsureHostSessionId:{3};",b,this.Xa.tk,a,this.Ue.jca),!0):!1}P2d(a,b,c=null){ya.a.J(512262804,801,10,"PopSessionManager::HandlePOPSErrors:{0}; SourceFunction:{1};",a,b);if(!this.flj(a)){if(u.AFrameworkApplication.zz&&
a===uf.a.Mh(320)){const f=Ql.a.instance.B3a();if(f){ya.a.J(512262803,801,15,"PopSessionManager::HandlePOPSErrors:{0}; SessionExpired fTriggered:{1};",a,f);return}}this.dv.Z2d(a,b)||this.JRd(a,b,c)}}nob(a,b,c=!1){ya.a.J(512262802,801,15,"PopSessionManager::CallClosePopSession - PopSessionID: {0}, PodSessionId: {1}, PopSessionInitialized: {2}, LastAttemptedEnsureHostSessionId:{3}, PopSessionForceClosed:{4}",this.Xa.tk,this.Xa.podSessionId,this.Ue.Xz,this.Ue.jca,this.Ue.a$c);if(this.Ue.Xz||!this.Ue.a$c){if(this.DRe(c,
""))a(new Qk.a(null)),ya.a.J(512262801,801,50,"sendBeacon request sent Time:{0}",Date.now());else{const f={};f["X-UsePopsRole"]=u.AFrameworkApplication.fa.ka("UsePopsRole").toString();this.Yca.kDc(this.Ue.jca,this.Xa.podSessionId,this.Xa.presentationId.string,u.AFrameworkApplication.fa.appSettings["361"],this.Xa.I9,c,a,b,null,f)}this.Ue.Xz=!1;this.Ue.a$c=!0;this.UB.VBe(new pf(this.Ue.jca))}}DRe(a,b){if(!n.a.Vnb())return!1;try{const c=this.nYi(a,b),f=this.lXd();u.AFrameworkApplication.He.SHa(f,c);
return!0}catch(c){return ya.a.J(512262800,801,10,"Failed to send beacon request for ClosePopWacSession"),!1}}nYi(a,b){const c={};c.popSessionID=this.Ue.jca;c.podSessionID=b.length?b:this.Xa.podSessionId;c.presentationID=this.Xa.presentationId.string;c.podUrl=u.AFrameworkApplication.fa.appSettings["361"];c.podInstance=this.Xa.I9;c.fTimeoutOrUserClose=a;return Ri.c(c)}lXd(){var a=u.AFrameworkApplication.fa.Ha("368")+u.AFrameworkApplication.fa.Ha("367")+"/ClosePopWacSession";a=new Lj.QueryStringBuilder(a);
a.kz(u.AFrameworkApplication.Khb,u.AFrameworkApplication.userSessionId);a.kz(u.AFrameworkApplication.MJd,u.AFrameworkApplication.buildVersion);a.kz("waccluster",this.Xa.Wj);a.kz("WacUserType",u.AFrameworkApplication.userType);a.kz(u.AFrameworkApplication.jwb,u.AFrameworkApplication.BVc);a.kz(u.AFrameworkApplication.RU,u.AFrameworkApplication.accessToken);a.kz(u.AFrameworkApplication.uaa,u.AFrameworkApplication.Ml.toString());a.kz("X-UsePopsRole",this.Xa.rxa.toString());a.kz("X-PopsAffinityRoutingEnabled",
this.Xa.lDa.toString());return a=a.toString()}flj(a){if(a!==uf.a.Mh(245))return!1;if(this.Ue.Xyg>this.Ue.eja&&this.Ue.Xz)return ya.a.J(512262799,801,15,"PopSessionManager::HandleFailedToGetPodsLatestBase - Got FailedToGetPodsLatestBase again."),!1;this.Ue.Xyg=new Date;this.vMf(0);return!0}vMf(a){const b=this.Xa.podSessionId;this.Xca.H9i(()=>{if(b!==this.Xa.podSessionId)ya.a.J(512262798,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",
b,this.Xa.podSessionId);else{var c=uf.a.Mh(245);this.dv.Z2d(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")||this.JRd(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")}},()=>{b!==this.Xa.podSessionId?ya.a.J(512262797,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Xa.podSessionId):this.Xca.n4b?ya.a.J(512262796,801,15,"{0} - Skip. PODS unhealthy already",
"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"):a<this.la.I9i?(ya.a.J(512262795,801,15,"{0} - Retry getting PODS health state. CurrentRetryCount:{1}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",a),this.vMf(a+1)):(ya.a.J(512262794,801,10,"{0} - PODS is unhealthy. Trigger rehydration.","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"),this.Kd.Rr(Object.assign(new Kg.a,{Code:223,Source:6}),b))})}JRd(a,b,c=null){ya.a.J(512262793,801,
10,"PopSessionManager::DisplayPOPSErrors:{0}; RequestingFunction:{1};",a,b);const f=uf.a.EM(a);uf.a.zS(a)?(a=Object.assign(new Kg.a,{Code:uf.a.EM(a),Source:5,ExtraErrorParam:c}),this.Kd.Rr(a,this.Xa.podSessionId,l=>{l.xB=1;Array.contains(this.hLg,Nk.a[f].toUpperCase())||(l.$za=8);399===f?(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_Unknown):384!==f&&(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_FailedToEnsurePopSession);
return!1})):(b=0,Array.contains(this.hLg,Nk.a[f].toUpperCase())||(b=8),this.Kd.tqa(a,b,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FailedToEnsurePopSession))}Vok(){this.Ue.Xz||(ya.a.J(512262792,801,15,"PopSessionManager::OnSuccessfulOutbound - PopSession not initialized. OldPopSessionID:{0}, PresentationID Null?:{1}",this.Xa.tk,!this.Xa.presentationId.string),this.eea(5))}Vz(a,b){ee.a("Pops.CloseSessionDueToReadonly")&&b.$8d&&!this.hc.BK&&this.Ue.Xz&&(ya.a.J(512262791,
801,50,"PopSessionManager::OnUnifiedAppStateChanged - Close Pop session due to readonly"),this.nob(()=>{},()=>{}))}}Object(e.a)(El,"PopSessionManager",null,[1243]);class wn{get name(){return"PowerPointWebEditor.PodsPops"}Wb(a){a.register(1243,"PowerPointWebEditor.PodsPopsCore.IPopSessionManager").ma().na(()=>new El(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));a.register(1244,"PowerPointWebEditor.PodsPopsCore.IPodSessionManager").ma().na(()=>
new ei(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),u.AFrameworkApplication.He,a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.ITaskManager"),a.La("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.La("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier")));a.register(1245,"PowerPointWebEditor.PodsPops.IPopSessionInfoClient").ma().na(()=>
new Wm(a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.La("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.NotificationManager"),
a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.La("Common.App.VisibilityManagement.IVisibilityManager")))}init(){}dispose(){}static main(){m.a.instance.Ac(new wn)}}Object(e.a)(wn,"PPTWebEditorPodsPopsPackage",null,[2,3]);class Yn{constructor(a,b,c,f,l){this.F8=new Ha.a;this.U6b=this.V6b=null;this.OEg=this.C7b=0;this.Oje=this.Nje=!1;this.Ixb=Fd.a.Wda(2,0,!1);this.qVa=Fd.a.Wda(2,1,!1);this.c3c=a;this.p8b=c;this.Mk=f;this.wq=b;this.LKg=l}get Jc(){return this.p8b.Jc}K_g(a,b,c,f){if(!b)return!1;
this.Nje||(this.C7b=Date.now(),this.Nje=!0);b=!1;try{if(this.Mk.iGf(c.shapeNode)){this.F8.clear();this.Ghi();const l=this.r_i(c);if(a){const F=this.Mk.ldj(this.Mk.UH(c,a),this.LPa(l),this.Jc,this.Ixb,this.qVa);if(F.top||F.bottom||F.left||F.right)b=!0,this.Mk.Rkc(c,F);if(this.LKg){const R=this.Mk.x2i(this.Mk.UH(c,a),l,this.Ixb,this.qVa,f);if(R.top||R.bottom||R.left||R.right)b=!0,this.Mk.Rkc(c,R);const fa=this.Mk.y2i(this.Mk.UH(c,a),l,this.Jc,this.qVa,f,a);if(fa.top||fa.bottom||fa.left||fa.right)b=
!0,this.Mk.Rkc(c,fa);const wa=this.Mk.K6i(this.Mk.UH(c,a),l,this.Jc,this.qVa,f,a);if(wa.top||wa.bottom||wa.left||wa.right)b=!0,this.Mk.Rkc(c,wa)}}else b=this.Mk.bfl(c,this.Mk.UH(c,a),this.LPa(l),this.Jc,this.Ixb,this.qVa);this.F8.addRange(this.Mk.ohi(this.Mk.UH(c,a),this.LPa(l),this.Jc));const x=this.Mk.iob(this.Mk.UH(c,a),this.LPa(l));if(x.count)this.F8.addRange(x);else if(!b){let F;F=a?this.Mk.afl(this.Mk.UH(c,!0),this.LPa(l),c):this.Mk.$el(this.Mk.UH(c,!1),this.LPa(l),c,this.qVa,this.Ixb);this.F8.addRange(F);
b=!!F&&0<F.count}if(this.LKg)if(a)this.F8.addRange(this.Mk.BKd(this.Mk.UH(c,a),this.Mk.HPa(l),this.Jc,f,a)),this.F8.addRange(this.Mk.u3a(this.Mk.UH(c,a),this.Mk.HPa(l),this.Jc,f,a)),this.F8.addRange(this.Mk.xhi(this.Mk.UH(c,a),this.Mk.HPa(l),f));else{const F=this.Mk.u3a(this.Mk.UH(c,a),this.Mk.HPa(l),this.Jc,f,a);if(F.count)this.F8.addRange(F);else if(!b){const fa=this.Mk.Lrh(this.Mk.UH(c,!1),this.LPa(l),c,this.Jc,this.qVa,this.Ixb);this.F8.addRange(this.Mk.u3a(this.Mk.UH(c,a),this.Mk.HPa(l),this.Jc,
f,a));b=fa}const R=this.Mk.BKd(this.Mk.UH(c,a),this.Mk.HPa(l),this.Jc,f,a);if(R.count)this.F8.addRange(R);else if(!b){const fa=this.Mk.Lrh(this.Mk.UH(c,!1),this.LPa(l),c,this.Jc,this.qVa,this.Ixb);this.F8.addRange(this.Mk.BKd(this.Mk.UH(c,a),this.Mk.HPa(l),this.Jc,f,a));b=fa}}this.c3c.hYf(this.F8.toArray());this.c3c.visible=!0}}catch(l){this.Oje||(ya.a.J(8959958,815,10,"SmartGuide - moving error {0}",l.toString()),this.Oje=!0)}return b}O_g(a){a&&(this.c3c.visible=!1,this.U6b=this.V6b=null,this.F8.clear(),
this.c3c.hYf([]),this.OEg=Date.now(),this.Oje=this.Nje=!1,ya.a.J(8959960,815,50,"SmartGuide - moving timespan {0}",(this.OEg-this.C7b).toString()))}Ghi(){this.Mk.HVg=this.wq.qn(this.Jc.yT.offsetLeft-this.Jc.Oc.scrollLeft);this.Mk.IVg=this.wq.qn(this.Jc.yT.offsetTop-this.Jc.Oc.scrollTop)}r_i(a){return this.V6b?this.V6b:this.V6b=this.Mk.q_i(this.Mk.xcj(this.Jc,this.Jc.Ma),a)}LPa(a){return this.U6b?this.U6b:this.U6b=this.Mk.HPa(a)}}Object(e.a)(Yn,"SmartGuideManager",null,[1235]);var td=d(130),Kd=d(164),
Pd=d(189),ad=d(59),ae=d(157);class rg{constructor(){this.xXc=this.ZDa=null;this.XYc=0;this.i$a=this.ybb=null;this.V7e=!1}get color(){return this.ZDa}set color(a){this.ZDa=a}get dashStyle(){return this.xXc}set dashStyle(a){this.xXc=a}get h1b(){return this.XYc}set h1b(a){this.XYc=a}get If(){return this.ybb}set If(a){this.ybb=a}get zg(){return this.i$a}set zg(a){this.i$a=a}get vG(){return this.V7e}set vG(a){this.V7e=a}length(){let a=-1;this.ybb&&this.i$a&&(a=Math.sqrt(Math.pow(this.i$a._x-this.ybb._x,
2)+Math.pow(this.i$a._y-this.ybb._y,2)));return a}reset(){const a=new rg;this.ZDa=a.ZDa;this.xXc=a.xXc;this.XYc=a.XYc;this.ybb=a.ybb;this.i$a=a.i$a}}Object(e.a)(rg,"SmartGuideLine",null,[1380]);class bm{constructor(a,b,c,f){this.distance=a;this.mJd=b;this.XSd=c;this.direction=f}}Object(e.a)(bm,"DistancePair",null,[]);class sh{constructor(a,b){this.shape=a;this.rk=b}}Object(e.a)(sh,"LightSet",null,[]);class Xm{constructor(a,b,c,f){this.begin=a;this.end=b;this.shape=c;this.distance=f}}Object(e.a)(Xm,
"LightSetItem",null,[]);class Gj{constructor(){this.d$a={};this.JJg=[]}ga(a){return this.d$a[a]}$(a,b){a in this.d$a||this.JJg.push(a);return this.d$a[a]=b}get keys(){return this.JJg}}Object(e.a)(Gj,"NumberDictionary",null,[]);class oi{constructor(a,b){this.first=a;this.second=b}}Object(e.a)(oi,"NumberPair",null,[]);var qk=d(646);class ek{constructor(a,b){this.Xoe=[];this.qg=5;this.V2=this.Yv=2;this.CN=4;this.IA=3;this.M0c=this.L0c=0;this.wq=a;this.iAb=b}xcj(a,b){a=mb.GraphIterator.mb(a.$a);const c=
[];for(var f=a.zb(1);f;f=a.uf(1))f=ae.a(f,b),c.push(f);return c}UH(a,b){for(const c of this.Xoe)if(c.CF(a))return c.UH(a,b);return null}addHandler(a){this.Xoe.push(a)}$el(a,b,c,f,l){f=this.Khd(f,ek.GBc);l=this.Khd(l,ek.GBc);for(var x of f){f=a.copy();f.move(0,0-x);f=this.iob(f,b);if(f.count)return this.zIa(c,0,-x),f;f=a.copy();f.move(0,x);f=this.iob(f,b);if(f.count)return this.zIa(c,0,x),f}for(let F of l){x=a.copy();x.move(0-F,0);x=this.iob(x,b);if(x.count)return this.zIa(c,-1*F,0),x;x=a.copy();x.move(F,
0);x=this.iob(x,b);if(x.count)return this.zIa(c,F,0),x}return new Ha.a}Khd(a,b){const c=new Ha.a;a/=b;let f=0;for(let l=0;l<b;++l)f+=a,c.add(f);return c}afl(a,b,c){var f=[];for(const l of f)if(f=a.copy(),f.setOffsets(l),f=this.iob(f,b),f.count)return this.Rkc(c,l),f;return new Ha.a}HPa(a){const b=[];for(const c of a)b.push(new qk.a(c.As()));return b}bfl(a,b,c,f,l,x){const F=new ad.a(Number.MAX_VALUE,Number.MAX_VALUE);let R=Number.MAX_VALUE;var fa=Number.MAX_VALUE;let wa=[];for(const Xa of c)wa.push(Xa);
this.iAb&&(wa=this.k1h(wa,f));for(const Xa of wa)c=this.f7i(b,Xa,R),Math.abs(F.y)>Math.abs(c)&&(F.y=c),R=Math.abs(c),c=this.d7i(b,Xa,fa),Math.abs(F.x)>Math.abs(c)&&(F.x=c),fa=Math.abs(c);fa=this.W1i(b,R,f);Math.abs(F.y)>Math.abs(fa)&&(F.y=fa);fa=this.V1i(b,R,f);Math.abs(F.x)>Math.abs(fa)&&(F.x=fa);Math.abs(F.x)>l&&(F.x=0);Math.abs(F.y)>x&&(F.y=0);return F.x||F.y?(this.zIa(a,F.x,F.y),!0):!1}k1h(a,b){var c=this.wq.qn(b.oe.width);b=this.wq.qn(b.oe.height);var f=new qk.a(new td.a(new ad.a(0,0),new ad.a(c,
0),new ad.a(c,b),new ad.a(0,b)));a.push(f);f=new qk.a(new td.a(new ad.a(0,0),new ad.a(c,0),new ad.a(c,b/2),new ad.a(0,b/2)));a.push(f);c=new qk.a(new td.a(new ad.a(0,0),new ad.a(c/2,0),new ad.a(c/2,b),new ad.a(0,b)));a.push(c);return a}Rkc(a,b){this.IOc(a,c=>{c.setOffsets(a,b)})}zIa(a,b,c){this.IOc(a,f=>{f.setPosition(a,b,c)})}IOc(a,b){for(const c of this.Xoe)if(c.CF(a)){b(c);break}}ldj(a,b,c,f,l){let x=Number.MAX_VALUE,F=Number.MAX_VALUE,R=Number.MAX_VALUE,fa=Number.MAX_VALUE;var wa=[];for(var Xa of b)wa.push(Xa.copy());
b=this.wq.qn(c.oe.width);c=this.wq.qn(c.oe.height);Xa=new qk.a(new td.a(new ad.a(0,0),new ad.a(b,0),new ad.a(b,c),new ad.a(0,c)));wa.push(Xa);this.iAb&&(Xa=new qk.a(new td.a(new ad.a(0,0),new ad.a(b,0),new ad.a(b,c/2),new ad.a(0,c/2))),wa.push(Xa),b=new qk.a(new td.a(new ad.a(0,0),new ad.a(b/2,0),new ad.a(b/2,c),new ad.a(0,c))),wa.push(b));for(const lb of wa)wa=this.yed([lb.Ub-a.fc,lb.fc-a.fc,lb.Uf().y-a.fc],l),this.ES(wa,l)&&Math.abs(wa)<Math.abs(x)&&(x=wa),wa=this.yed([lb.Ub-a.Ub,lb.fc-a.Ub,lb.Uf().y-
a.Ub],l),this.ES(wa,l)&&Math.abs(wa)<Math.abs(F)&&(F=wa),wa=this.yed([lb.Zb-a.Zb,lb.Vb-a.Zb,lb.Uf().x-a.Zb],f),this.ES(wa,f)&&Math.abs(wa)<Math.abs(R)&&(R=wa),wa=this.yed([lb.Zb-a.Vb,lb.Vb-a.Vb,lb.Uf().x-a.Vb],f),this.ES(wa,f)&&Math.abs(wa)<Math.abs(fa)&&(fa=wa);a=new Pd.a;a.top=x===Number.MAX_VALUE?a.top:x;a.bottom=F===Number.MAX_VALUE?a.bottom:F;a.left=R===Number.MAX_VALUE?a.left:R;a.right=fa===Number.MAX_VALUE?a.right:fa;return a}iGf(a){return a.nsa||a.qk||a.al||a.Pq||a.Qf}H1i(a,b){return Math.abs(a-
b)}f7i(a,b,c){a=[new oi(a.fc,b.fc),new oi(a.fc,b.Ub),new oi(a.fc,b.Uf().y),new oi(a.Ub,b.fc),new oi(a.Ub,b.Ub),new oi(a.Ub,b.Uf().y),new oi(a.Uf().y,b.fc),new oi(a.Uf().y,b.Ub),new oi(a.Uf().y,b.Uf().y)];return this.lMc(a,c)}d7i(a,b,c){a=[new oi(a.Zb,b.Zb),new oi(a.Zb,b.Vb),new oi(a.Zb,b.Uf().x),new oi(a.Vb,b.Zb),new oi(a.Vb,b.Vb),new oi(a.Vb,b.Uf().x),new oi(a.Uf().x,b.Zb),new oi(a.Uf().x,b.Vb),new oi(a.Uf().x,b.Uf().x)];return this.lMc(a,c)}W1i(a,b,c){c=this.wq.qn(c.oe.height);a=[new oi(a.fc,0),
new oi(a.fc,c),new oi(a.Ub,0),new oi(a.Ub,c),new oi(a.Uf().y,0),new oi(a.Uf().y,c)];return this.lMc(a,b)}V1i(a,b,c){c=this.wq.qn(c.oe.width);a=[new oi(a.Zb,0),new oi(a.Zb,c),new oi(a.Vb,0),new oi(a.Vb,c),new oi(a.Uf().x,0),new oi(a.Uf().x,c)];return this.lMc(a,b)}lMc(a,b){let c=Number.MAX_VALUE;for(const f of a)a=this.H1i(f.first,f.second),a<b&&(b=a,c=f.second-f.first);return c}ES(a,b){a=Math.abs(a);return.2<a&&a<b}yed(a,b){let c=Number.MAX_VALUE;for(const f of a)this.ES(f,b)&&Math.abs(c)>Math.abs(f)&&
(c=f);return c}q_i(a,b){const c=new Ha.a;for(const f of a)this.iGf(f.shapeNode)&&f.$a!==b.$a&&c.add(f);return c.toArray()}iob(a,b){var c=new Ha.a;c.add(a);var f=new Ha.a;f.add(a);var l=new Ha.a;l.add(a);var x=new Ha.a;x.add(a);for(const F of b)F.Ub<a.fc||F.fc>a.Ub||(F.Zb<a.Zb&&this.Uyc(c,F,2),F.Vb>a.Vb&&this.Uyc(f,F,3)),F.Vb<a.Zb||F.Zb>a.Vb||(F.fc<a.fc&&this.Uyc(l,F,0),F.Ub>a.Ub&&this.Uyc(x,F,1));a=this.qMc(c,2);f=this.qMc(f,3);b=this.qMc(l,0);c=this.qMc(x,1);x=new Gj;this.YEc(x,a[0]);this.YEc(x,
f[0]);l=new Gj;this.YEc(l,b[0]);this.YEc(l,c[0]);this.SIc(x,a,2);this.SIc(x,f,3);this.SIc(l,b,0);this.SIc(l,c,1);a=new Ha.a;f=new Ha.a;this.eSf(x,a,f);this.eSf(l,a,f);this.GYa(a,1);this.GYa(f,2);a.addRange(f);for(let F of a)this.nv(F);return a}qMc(a,b){const c=new Ha.a;for(let l=0;l<a.count;++l){var f=new Xm(this.P0i(a,l,b),this.i1i(a,l,b),null,-1);f=new sh(a.ga(l),[f]);for(let x=l+1;x<a.count;++x){const F=f.rk.length;let R=F;for(let fa=0;fa<F;++fa)if(!f.rk[fa].shape&&-1===f.rk[fa].distance&&f.rk[fa].end>
f.rk[fa].begin){const wa=this.I1i(a,l,x,b);R+=this.MAk(a,x,fa,R,l,wa,f,b);R+=this.OAk(a,x,fa,R,l,wa,f,b);R+=this.CBk(a,x,fa,R,l,wa,f,b);R+=this.NAk(a,x,fa,l,wa,f,b)}}c.add(f)}return c.toArray()}eSf(a,b,c){for(const l of a.keys){var f=a.ga(l);if(1<f.count){const x=new Ha.a;for(let F of f){f=!1;for(let R of x)if(this.a$h(F,R)){f=!0;x.remove(R);break}f||x.add(F)}for(let F of x)this.Txi(F,b,c)}}}a$h(a,b){return this.dGf(a.mJd,b.mJd)&&this.dGf(a.XSd,b.XSd)}dGf(a,b){return a.Zb===b.Zb&&a.Vb===b.Vb&&a.fc===
b.fc&&a.Ub===b.Ub}Uyc(a,b,c){const f=a.count;for(let l=0;l<f;l++){const x=a.ga(l);if(3===c&&(b.Zb<a.ga(0).Vb?b.Vb:b.Zb)<(x.Zb<a.ga(0).Vb?x.Vb:x.Zb)||2===c&&(b.Vb>a.ga(0).Zb?b.Zb:b.Vb)>(x.Vb>a.ga(0).Zb?x.Zb:x.Vb)||0===c&&(b.Ub>a.ga(0).fc?b.fc:b.Ub)>(x.Ub>a.ga(0).fc?x.fc:x.Ub)||1===c&&(b.fc<a.ga(0).Ub?b.Ub:b.fc)<(x.fc<a.ga(0).Ub?x.Ub:x.fc)){a.insert(l,b);return}}a.add(b)}YEc(a,b){for(const c of b.rk)0<c.distance&&a.$(Math.round(100*c.distance)/100,new Ha.a)}SIc(a,b,c){const f=new Gj;for(const l of b){for(const x of a.keys)f.$(x,
0);for(const x of l.rk)if(0<x.distance&&x.shape)for(const F of a.keys)if(b=F,this.iu(x.distance,b)){const R=f.ga(F);1>R&&(a.ga(F).add(new bm(b,l.shape,x.shape,c)),f.$(F,R+1));break}}}P0i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.max(b.fc,a.fc);case 0:case 1:return Math.max(b.Zb,a.Zb);default:return-1}}i1i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.min(b.Ub,a.Ub);case 0:case 1:return Math.min(b.Vb,a.Vb);default:return-1}}MAk(a,b,c,f,l,x,F,R){const fa=a.ga(b);
l=a.ga(l);switch(R){case 3:case 2:if(fa.Ub>=F.rk[c].begin&&fa.Ub<=F.rk[c].end&&fa.fc<=F.rk[c].begin)return a=new Xm(F.rk[c].begin,fa.Ub,a.ga(b),3===R?x-l.Vb:l.Zb-x),F.rk[f]=a,F.rk[c].begin=fa.Ub,1;break;case 0:case 1:if(fa.Vb>=F.rk[c].begin&&fa.Vb<=F.rk[c].end&&fa.Zb<=F.rk[c].begin)return a=new Xm(F.rk[c].begin,fa.Vb,a.ga(b),0===R?l.fc-x:x-l.Ub),F.rk[f]=a,F.rk[c].begin=fa.Vb,1}return 0}OAk(a,b,c,f,l,x,F,R){const fa=a.ga(b);l=a.ga(l);switch(R){case 3:case 2:if(fa.fc>=F.rk[c].begin&&fa.fc<=F.rk[c].end&&
fa.Ub>=F.rk[c].end)return a=new Xm(fa.fc,F.rk[c].end,a.ga(b),3===R?x-l.Vb:l.Zb-x),F.rk[f]=a,F.rk[c].end=fa.fc,1;break;case 0:case 1:if(fa.Zb>=F.rk[c].begin&&fa.Zb<=F.rk[c].end&&fa.Vb>=F.rk[c].end)return a=new Xm(fa.Zb,F.rk[c].end,a.ga(b),0===R?l.fc-x:x-l.Ub),F.rk[f]=a,F.rk[c].end=fa.Zb,1}return 0}CBk(a,b,c,f,l,x,F,R){const fa=a.ga(b);l=a.ga(l);switch(R){case 3:case 2:if(fa.fc>F.rk[c].begin&&fa.fc<F.rk[c].end&&fa.Ub>F.rk[c].begin&&fa.Ub<F.rk[c].end)return a=new Xm(fa.fc,fa.Ub,a.ga(b),3===R?x-l.Vb:
l.Zb-x),F.rk[f]=a,a=new Xm(fa.Ub,F.rk[c].end,null,-1),F.rk[++f]=a,F.rk[c].end=fa.fc,2;break;case 0:case 1:if(fa.Zb>F.rk[c].begin&&fa.Zb<F.rk[c].end&&fa.Vb>F.rk[c].begin&&fa.Vb<F.rk[c].end)return a=new Xm(fa.Zb,fa.Vb,a.ga(b),0===R?l.fc-x:x-l.Ub),F.rk[f]=a,a=new Xm(fa.Vb,F.rk[c].end,null,-1),F.rk[++f]=a,F.rk[c].end=fa.Zb,2}return 0}NAk(a,b,c,f,l,x,F){const R=a.ga(b);f=a.ga(f);switch(F){case 3:case 2:R.fc<x.rk[c].begin&&R.Ub>x.rk[c].end&&(x.rk[c].shape=a.ga(b),x.rk[c].distance=3===F?l-f.Vb:f.Zb-l);break;
case 0:case 1:R.Zb<x.rk[c].begin&&R.Vb>x.rk[c].end&&(x.rk[c].shape=a.ga(b),x.rk[c].distance=0===F?f.fc-l:l-f.Ub)}return 0}I1i(a,b,c,f){let l=-1;c=a.ga(c);a=a.ga(b);switch(f){case 3:c.Zb<a.Vb&&c.Vb>=a.Vb&&(l=c.Vb);c.Zb>=a.Vb&&(l=c.Zb);break;case 2:c.Vb>a.Zb&&c.Zb<=a.Zb&&(l=c.Zb);c.Vb<=a.Zb&&(l=c.Vb);break;case 0:c.Ub>a.fc&&c.fc<=a.fc&&(l=c.fc);c.Ub<=a.fc&&(l=c.Ub);break;case 1:c.fc<a.Ub&&c.Ub>=a.Ub&&(l=c.Ub),c.fc>=a.Ub&&(l=c.fc)}return l}Txi(a,b,c){const f=a.mJd;var l=a.XSd;switch(a.direction){case 3:var x=
Math.max(f.Ub,l.Ub),F=new rg;F.If=new ad.a(f.Vb-this.IA,f.fc);F.zg=new ad.a(f.Vb-this.IA,x+this.qg);b.add(F);F=new rg;F.If=new ad.a(f.Vb+a.distance-this.IA,l.fc);F.zg=new ad.a(f.Vb+a.distance-this.IA,x+this.qg);b.add(F);b=new rg;b.If=new ad.a(f.Vb-this.IA,x+this.qg);b.zg=new ad.a(f.Vb+a.distance-this.IA,x+this.qg);c.add(b);break;case 2:x=Math.max(f.Ub,l.Ub);F=new rg;F.If=new ad.a(f.Zb-a.distance-this.IA,l.fc);F.zg=new ad.a(f.Zb-a.distance-this.IA,x+this.qg);b.add(F);l=new rg;l.If=new ad.a(f.Zb-this.IA,
f.fc);l.zg=new ad.a(f.Zb-this.IA,x+this.qg);b.add(l);b=new rg;b.If=new ad.a(f.Zb-a.distance-this.IA,x+this.qg);b.zg=new ad.a(f.Zb-this.IA,x+this.qg);c.add(b);break;case 0:x=Math.max(f.Vb,l.Vb);F=new rg;F.If=new ad.a(f.Zb,f.fc-this.Yv);F.zg=new ad.a(x+this.qg,f.fc-this.Yv);b.add(F);F=new rg;F.If=new ad.a(l.Zb,f.fc-a.distance-this.Yv);F.zg=new ad.a(x+this.qg,f.fc-a.distance-this.Yv);b.add(F);b=new rg;b.If=new ad.a(x+this.qg,f.fc-this.Yv);b.zg=new ad.a(x+this.qg,f.fc-a.distance-this.Yv);c.add(b);break;
case 1:x=Math.max(f.Vb,l.Vb),F=new rg,F.If=new ad.a(f.Zb,f.Ub-this.Yv),F.zg=new ad.a(x+this.qg,f.Ub-this.Yv),b.add(F),F=new rg,F.If=new ad.a(l.Zb,f.Ub+a.distance-this.Yv),F.zg=new ad.a(x+this.qg,f.Ub+a.distance-this.Yv),b.add(F),b=new rg,b.If=new ad.a(x+this.qg,f.Ub-this.Yv),b.zg=new ad.a(x+this.qg,f.Ub+a.distance-this.Yv),c.add(b)}}xhi(a,b,c){const f=new Ha.a;if(!c)return f;let l=!1;var x=!1;const F=c.equals(Kd.a.west)||c.equals(Kd.a.qu)||c.equals(Kd.a.fH),R=c.equals(Kd.a.east)||c.equals(Kd.a.ND)||
c.equals(Kd.a.cE),fa=c.equals(Kd.a.north)||c.equals(Kd.a.qu)||c.equals(Kd.a.ND);c=c.equals(Kd.a.south)||c.equals(Kd.a.fH)||c.equals(Kd.a.cE);for(const Xa of b){if(this.Owg(a,Xa,!0,b)&&(F||R)){l=!0;var wa=new rg;wa.If=new ad.a(Xa.Zb,Xa.Uf()._y);wa.zg=new ad.a(Xa.Vb-this.IA,Xa.Uf()._y);wa.vG=!0;f.add(this.nv(wa))}this.Owg(a,Xa,!1,b)&&(fa||c)&&(x=!0,wa=new rg,wa.If=new ad.a(Xa.Uf()._x,Xa.fc),wa.zg=new ad.a(Xa.Uf()._x,Xa.Ub-this.V2),wa.vG=!1,f.add(this.nv(wa)))}l&&(b=new rg,b.If=new ad.a(a.Zb,a.Uf()._y),
b.zg=new ad.a(a.Vb-this.IA,a.Uf()._y),b.vG=!0,f.add(this.nv(b)));x&&(x=new rg,x.If=new ad.a(a.Uf()._x,a.fc),x.zg=new ad.a(a.Uf()._x,a.Ub-this.V2),x.vG=!1,f.add(this.nv(x)));this.GYa(f,2);return f}f4(a,b,c){var f=this.Rba(a,b,!1),l=this.Rba(a,b,!0);if(!f&&!l)return!1;let x=[];if(f){if(a.Vb<=b.Zb||a.Vb<=b.Vb){var F;var R=b.fc>a.fc?b.fc:a.fc;var fa=b.Ub<a.Ub?b.Ub:a.Ub;f=F=b.Zb;a.Vb>b.Zb&&(f=F=b.Vb);f=new qk.a(new td.a(new ad.a(f,R),new ad.a(F,R),new ad.a(F,fa),new ad.a(f,fa)));Array.add(x,f)}if(a.Zb>=
b.Vb||a.Zb>=b.Zb)R=b.fc>a.fc?b.fc:a.fc,fa=b.Ub<a.Ub?b.Ub:a.Ub,f=F=b.Vb,a.Zb<b.Vb&&(f=F=b.Zb),f=new qk.a(new td.a(new ad.a(f,R),new ad.a(F,R),new ad.a(F,fa),new ad.a(f,fa))),Array.add(x,f)}if(l){if(a.Ub<=b.fc||a.Ub<=b.Ub)l=b.Zb>a.Zb?b.Zb:a.Zb,R=b.Vb<a.Vb?b.Vb:a.Vb,f=F=b.fc,a.Ub>b.fc&&(f=F=b.Ub),l=new qk.a(new td.a(new ad.a(l,f),new ad.a(R,f),new ad.a(R,F),new ad.a(l,F))),Array.add(x,l);if(a.fc>=b.Ub||a.fc>=b.fc)l=b.Zb>a.Zb?b.Zb:a.Zb,R=b.Vb<a.Vb?b.Vb:a.Vb,f=F=b.Ub,a.fc<b.Ub&&(f=F=b.fc),l=new qk.a(new td.a(new ad.a(l,
f),new ad.a(R,f),new ad.a(R,F),new ad.a(l,F))),Array.add(x,l)}for(const wa of c)this.jjg(wa,a)||this.jjg(wa,b)||(x=this.Sul(a,wa,x));return 0<x.length?!0:!1}Sul(a,b,c){let f=[];for(const l of c)c=!0,l.Zb===l.Vb?(this.Rba(l,b,!1)||(c=!1),a.Vb<=l.Zb&&b.Vb<=a.Vb&&(c=!1),a.Vb<=l.Zb&&b.Zb>=l.Vb&&(c=!1),a.Zb>=l.Vb&&b.Zb>=a.Zb&&(c=!1),a.Zb>=l.Vb&&b.Vb<=l.Zb&&(c=!1),c?b.fc<=l.fc&&b.Ub<l.Ub?f=this.uJb(f,!0,!0,!1,l,b):b.Ub>=l.Ub&&b.fc>l.fc?f=this.uJb(f,!0,!1,!1,l,b):b.fc>l.fc&&b.Ub<l.Ub&&(f=this.uJb(f,!0,!1,
!0,l,b)):Array.add(f,l)):l.fc===l.Ub&&(this.Rba(l,b,!0)||(c=!1),a.Ub<=l.fc&&b.Ub<=a.Ub&&(c=!1),a.Ub<=l.fc&&b.fc>=l.Ub&&(c=!1),a.fc>=l.Ub&&b.fc>=a.fc&&(c=!1),a.fc>=l.Ub&&b.Ub<=l.fc&&(c=!1),c?b.Zb<=l.Zb&&b.Vb<l.Vb?f=this.uJb(f,!1,!0,!1,l,b):b.Vb>=l.Vb&&b.Zb>l.Zb?f=this.uJb(f,!1,!1,!1,l,b):b.Zb>l.Zb&&b.Vb<l.Vb&&(f=this.uJb(f,!1,!1,!0,l,b)):Array.add(f,l));return f}uJb(a,b,c,f,l,x){let F,R,fa,wa,Xa,lb,Lb;if(c)b?(c=R=l.Zb,F=x.Ub,fa=l.Ub):(F=fa=l.fc,c=x.Vb,R=l.Vb);else if(c||f){if(b?(c=R=wa=lb=l.Zb,F=l.fc,
fa=x.fc,Xa=x.Ub,Lb=l.Ub):(F=fa=Xa=Lb=l.fc,c=l.Zb,R=x.Zb,wa=x.Vb,lb=l.Vb),f&&b&&!this.iu(Xa,Lb)||f&&!b&&!this.iu(wa,lb))f=new qk.a(new td.a(new ad.a(wa,Xa),new ad.a(lb,Xa),new ad.a(lb,Lb),new ad.a(wa,Lb))),Array.add(a,f)}else b?(c=R=l.Zb,F=l.fc,fa=x.fc):(F=fa=l.fc,c=l.Zb,R=x.Zb);if(b&&!this.iu(F,fa)||!b&&!this.iu(c,R))b=new qk.a(new td.a(new ad.a(c,F),new ad.a(R,F),new ad.a(R,fa),new ad.a(c,fa))),Array.add(a,b);return a}jjg(a,b){return a.Vb!==b.Vb||a.Zb!==b.Zb||a.fc!==b.fc||a.Ub!==b.Ub?!1:!0}Owg(a,
b,c,f){if(c)return c=this.iu(a.Zb,b.Zb)&&this.iu(a.Vb,b.Vb),this.iu(a.Vb-a.Zb,b.Vb-b.Zb)&&!c&&this.f4(a,b,f);c=this.iu(a.fc,b.fc)&&this.iu(a.Ub,b.Ub);return this.iu(a.Ub-a.fc,b.Ub-b.fc)&&!c&&this.f4(a,b,f)}x2i(a,b,c,f,l){const x=new Pd.a;if(!l)return x;let F=Number.MAX_VALUE,R=Number.MAX_VALUE,fa=Number.MAX_VALUE,wa=Number.MAX_VALUE;const Xa=l.equals(Kd.a.west)||l.equals(Kd.a.qu)||l.equals(Kd.a.fH),lb=l.equals(Kd.a.east)||l.equals(Kd.a.ND)||l.equals(Kd.a.cE),Lb=l.equals(Kd.a.north)||l.equals(Kd.a.qu)||
l.equals(Kd.a.ND);l=l.equals(Kd.a.south)||l.equals(Kd.a.fH)||l.equals(Kd.a.cE);const kc=[];for(const lc of b)kc.push(new qk.a(lc.As()));for(const lc of kc)b=lc.Ub-lc.fc-(a.Ub-a.fc),this.ES(b,f)&&Math.abs(b)<Math.abs(F)&&this.f4(a,lc,kc)&&Lb&&(F=-1*b),this.ES(b,f)&&Math.abs(b)<Math.abs(R)&&this.f4(a,lc,kc)&&l&&(R=b),b=lc.Vb-lc.Zb-(a.Vb-a.Zb),this.ES(b,c)&&Math.abs(b)<Math.abs(fa)&&this.f4(a,lc,kc)&&Xa&&(fa=-1*b),this.ES(b,c)&&Math.abs(b)<Math.abs(wa)&&this.f4(a,lc,kc)&&lb&&(wa=b);x.top=F===Number.MAX_VALUE?
x.top:F;x.bottom=R===Number.MAX_VALUE?x.bottom:R;x.left=fa===Number.MAX_VALUE?x.left:fa;x.right=wa===Number.MAX_VALUE?x.right:wa;return x}y2i(a,b,c,f,l,x){let F=Number.MAX_VALUE,R=Number.MAX_VALUE,fa=Number.MAX_VALUE,wa=Number.MAX_VALUE,Xa=!0,lb=!0,Lb=!0,kc=!0;x&&l&&(Xa=l.equals(Kd.a.west)||l.equals(Kd.a.qu)||l.equals(Kd.a.fH),lb=l.equals(Kd.a.east)||l.equals(Kd.a.ND)||l.equals(Kd.a.cE),Lb=l.equals(Kd.a.north)||l.equals(Kd.a.qu)||l.equals(Kd.a.ND),kc=l.equals(Kd.a.south)||l.equals(Kd.a.fH)||l.equals(Kd.a.cE));
l=[];for(var lc of b)l.push(new qk.a(lc.As()));b=this.wq.qn(c.oe.width);c=this.wq.qn(c.oe.height);for(const Ec of l)Ec.Zb>b/2&&Ec.Zb<3*b/4&&a.Vb<b/2&&lb&&(lc=b/2-a.Vb-(Ec.Zb-b/2),this.ES(lc,f)&&Math.abs(lc)<Math.abs(wa)&&this.f4(a,Ec,l)&&(wa=lc)),Ec.Vb<b/2&&Ec.Vb>b/4&&a.Zb>b/2&&Xa&&(lc=b/2-Ec.Vb-(a.Zb-b/2),this.ES(lc,f)&&Math.abs(lc)<Math.abs(fa)&&this.f4(a,Ec,l)&&(fa=lc)),Ec.fc>c/2&&Ec.fc<3*c/4&&a.Ub<c/2&&kc&&(lc=c/2-a.Ub-(Ec.fc-c/2),this.ES(lc,f)&&Math.abs(lc)<Math.abs(R)&&this.f4(a,Ec,l)&&(R=lc)),
Ec.Ub<c/2&&Ec.Ub>c/4&&a.fc>c/2&&Lb&&(lc=c/2-Ec.Ub-(a.fc-c/2),this.ES(lc,f)&&Math.abs(lc)<Math.abs(F)&&this.f4(a,Ec,l)&&(F=lc));a=new Pd.a;a.top=F===Number.MAX_VALUE?a.top:F;a.bottom=R===Number.MAX_VALUE?a.bottom:R;a.left=fa===Number.MAX_VALUE?a.left:fa;a.right=wa===Number.MAX_VALUE?a.right:wa;return a}Lrh(a,b,c,f,l,x){l=this.Khd(l,ek.GBc);x=this.Khd(x,ek.GBc);for(var F of l){l=a.copy();l.move(0,0-F);if(this.u3a(l,b,f,null,!1).count)return this.zIa(c,0,-F),!0;l=a.copy();l.move(0,F);if(this.u3a(l,b,
f,null,!1).count)return this.zIa(c,0,F),!0}for(let R of x){F=a.copy();F.move(0-R,0);if(this.u3a(F,b,f,null,!1).count)return this.zIa(c,-1*R,0),!0;F=a.copy();F.move(R,0);if(this.u3a(F,b,f,null,!1).count)return this.zIa(c,R,0),!0}return!1}Rba(a,b,c){return c?a.Zb>=b.Zb&&a.Zb<=b.Vb||a.Vb>=b.Zb&&a.Vb<=b.Vb||b.Zb>=a.Zb&&b.Zb<=a.Vb||b.Vb>=a.Zb&&b.Vb<=a.Vb:a.fc>=b.fc&&a.fc<=b.Ub||a.Ub>=b.fc&&a.Ub<=b.Ub||b.fc>=a.fc&&b.fc<=a.Ub||b.Ub>=a.fc&&b.Ub<=a.Ub}BKd(a,b,c,f,l){const x=new Ha.a,F=new Ha.a,R=new Ha.a;
let fa=!1,wa=!1,Xa=!1,lb=!1,Lb=!0,kc=!0,lc=!0,Ec=!0;l&&f&&(Lb=f.equals(Kd.a.west)||f.equals(Kd.a.qu)||f.equals(Kd.a.fH),kc=f.equals(Kd.a.east)||f.equals(Kd.a.ND)||f.equals(Kd.a.cE),lc=f.equals(Kd.a.north)||f.equals(Kd.a.qu)||f.equals(Kd.a.ND),Ec=f.equals(Kd.a.south)||f.equals(Kd.a.fH)||f.equals(Kd.a.cE));f=this.wq.qn(c.oe.width);c=this.wq.qn(c.oe.height);l=new rg;l.If=new ad.a(f/2-this.CN,0-this.Yv);l.zg=new ad.a(f/2-this.CN,c-this.Yv);const Jc=new rg;Jc.If=new ad.a(0-this.CN,c/2-this.Yv);Jc.zg=new ad.a(f-
this.CN,c/2-this.Yv);Jc.vG=!0;for(const Dc of b)Dc.Zb>f/2&&Dc.Zb<3*f/4&&a.Vb<f/2&&this.f4(a,Dc,b)&&kc&&this.iu(f/2-a.Vb,Dc.Zb-f/2)&&(fa=!0,0>Dc.fc&&(l.If=new ad.a(f/2,Dc.fc)),Dc.Ub>c&&(l.zg=new ad.a(f/2,Dc.Ub+this.qg)),x.add(this.IMa(Dc,!1,!1)),F.add(this.FMa(Dc,!1,!1,f,c))),Dc.Vb<f/2&&Dc.Vb>f/4&&a.Zb>f/2&&this.f4(a,Dc,b)&&Lb&&this.iu(a.Zb-f/2,f/2-Dc.Vb)&&(wa=!0,0>Dc.fc&&(l.If=new ad.a(f/2,Dc.fc)),Dc.Ub>c&&(l.zg=new ad.a(f/2,Dc.Ub+this.qg)),x.add(this.IMa(Dc,!1,!0)),F.add(this.FMa(Dc,!1,!0,f,c))),
Dc.fc>c/2&&Dc.fc<3*c/4&&a.Ub<c/2&&this.f4(a,Dc,b)&&Ec&&this.iu(c/2-a.Ub,Dc.fc-c/2)&&(Xa=!0,0>Dc.Zb&&(Jc.If=new ad.a(Dc.Zb,c/2)),Dc.Vb>f&&(Jc.zg=new ad.a(Dc.Vb+this.qg,c/2)),x.add(this.IMa(Dc,!0,!1)),F.add(this.FMa(Dc,!0,!1,f,c))),Dc.Ub<c/2&&Dc.Ub>c/4&&a.fc>c/2&&this.f4(a,Dc,b)&&lc&&this.iu(a.fc-c/2,c/2-Dc.Ub)&&(lb=!0,0>Dc.Zb&&(Jc.If=new ad.a(Dc.Zb,c/2)),Dc.Vb>f&&(Jc.zg=new ad.a(Dc.Vb+this.qg,c/2)),x.add(this.IMa(Dc,!0,!0)),F.add(this.FMa(Dc,!0,!0,f,c)));(fa||wa)&&x.add(this.nv(l));(Xa||lb)&&x.add(this.nv(Jc));
Xa&&(a.Zb<Jc.If._x&&(Jc.If=new ad.a(a.Zb,c/2)),a.Vb>Jc.zg._x&&(Jc.zg=new ad.a(a.Vb,c/2+this.qg)),x.add(this.IMa(a,!0,!0)),F.add(this.FMa(a,!0,!0,f,c)));lb&&(a.Zb<Jc.If._x&&(Jc.If=new ad.a(a.Zb,c/2)),a.Vb>Jc.zg._x&&(Jc.zg=new ad.a(a.Vb,c/2+this.qg)),x.add(this.IMa(a,!0,!1)),F.add(this.FMa(a,!0,!1,f,c)));fa&&(a.fc<l.If._y&&(l.If=new ad.a(f/2,a.fc)),a.Ub>l.zg._y&&(l.zg=new ad.a(f/2,a.Ub+this.qg)),x.add(this.IMa(a,!1,!0)),F.add(this.FMa(a,!1,!0,f,c)));wa&&(a.fc<l.If._y&&(l.If=new ad.a(f/2,a.fc)),a.Ub>
l.zg._y&&(l.zg=new ad.a(f/2,a.Ub+this.qg)),x.add(this.IMa(a,!1,!1)),F.add(this.FMa(a,!1,!1,f,c)));this.GYa(x,1);this.GYa(F,2);for(let Dc of x)R.add(Dc);for(let Dc of F)R.add(Dc);return R}IMa(a,b,c){const f=b&&c,l=b&&!c,x=!b&&!c;return!b&&c?(b=new rg,b.If=new ad.a(a.Vb-this.IA,a.Ub),b.zg=new ad.a(a.Vb-this.IA,a.Ub+this.qg),this.nv(b)):x?(b=new rg,b.If=new ad.a(a.Zb-this.CN,a.Ub),b.zg=new ad.a(a.Zb-this.CN,a.Ub+this.qg),this.nv(b)):f?(b=new rg,b.If=new ad.a(a.Vb,a.Ub-this.V2),b.zg=new ad.a(a.Vb+this.qg,
a.Ub-this.V2),this.nv(b)):l?(b=new rg,b.If=new ad.a(a.Vb,a.fc-this.Yv),b.zg=new ad.a(a.Vb+this.qg,a.fc-this.Yv),this.nv(b)):null}FMa(a,b,c,f,l){const x=b&&c,F=b&&!c,R=!b&&!c;return!b&&c?(l=new rg,l.vG=!0,l.If=new ad.a(f/2-this.CN,a.Ub+this.qg),l.zg=new ad.a(a.Vb-this.IA,a.Ub+this.qg),this.nv(l)):R?(l=new rg,l.vG=!0,l.If=new ad.a(f/2-this.CN,a.Ub+this.qg),l.zg=new ad.a(a.Zb-this.CN,a.Ub+this.qg),this.nv(l)):x?(f=new rg,f.vG=!0,f.If=new ad.a(a.Vb+this.qg,l/2-this.Yv),f.zg=new ad.a(a.Vb+this.qg,a.Ub-
this.V2),this.nv(f)):F?(f=new rg,f.vG=!0,f.If=new ad.a(a.Vb+this.qg,l/2-this.Yv),f.zg=new ad.a(a.Vb+this.qg,a.fc-this.Yv),this.nv(f)):null}K6i(a,b,c,f,l,x){let F=Number.MAX_VALUE,R=Number.MAX_VALUE,fa=Number.MAX_VALUE,wa=Number.MAX_VALUE,Xa=!0,lb=!0,Lb=!0,kc=!0;x&&l&&(Xa=l.equals(Kd.a.west)||l.equals(Kd.a.qu)||l.equals(Kd.a.fH),lb=l.equals(Kd.a.east)||l.equals(Kd.a.ND)||l.equals(Kd.a.cE),Lb=l.equals(Kd.a.north)||l.equals(Kd.a.qu)||l.equals(Kd.a.ND),kc=l.equals(Kd.a.south)||l.equals(Kd.a.fH)||l.equals(Kd.a.cE));
l=[];for(const lc of b)l.push(new qk.a(lc.As()));b=this.wq.qn(c.oe.width);c=this.wq.qn(c.oe.height);for(const lc of l)lc.Vb>3*b/4&&lc.Vb<b&&a.Zb<b/4&&0<a.Zb&&this.Rba(a,lc,!1)&&Xa&&(l=b-lc.Vb-a.Zb,this.ES(l,f)&&Math.abs(l)<Math.abs(fa)&&(fa=l)),lc.Zb<b/4&&0<lc.Zb&&a.Vb>3*b/4&&a.Vb<b&&this.Rba(a,lc,!1)&&lb&&(l=b-a.Vb-lc.Zb,this.ES(l,f)&&Math.abs(l)<Math.abs(wa)&&(wa=l)),lc.Ub>3*c/4&&lc.Ub<c&&a.fc<c/4&&0<a.fc&&this.Rba(a,lc,!0)&&Lb&&(l=c-lc.Ub-a.fc,this.ES(l,f)&&Math.abs(l)<Math.abs(F)&&(F=l)),lc.fc<
c/4&&0<lc.fc&&a.Ub>3*c/4&&a.Ub<c&&this.Rba(a,lc,!0)&&kc&&(l=c-a.Ub-lc.fc,this.ES(l,f)&&Math.abs(l)<Math.abs(R)&&(R=l));a=new Pd.a;a.top=F===Number.MAX_VALUE?a.top:F;a.bottom=R===Number.MAX_VALUE?a.bottom:R;a.left=fa===Number.MAX_VALUE?a.left:fa;a.right=wa===Number.MAX_VALUE?a.right:wa;return a}u3a(a,b,c,f,l){const x=new Ha.a,F=new Ha.a,R=new Ha.a;var fa=!1,wa=!1,Xa=!1,lb=!1,Lb=!0;let kc=!0,lc=!0,Ec=!0;l&&f&&(Lb=f.equals(Kd.a.west)||f.equals(Kd.a.qu)||f.equals(Kd.a.fH),kc=f.equals(Kd.a.east)||f.equals(Kd.a.ND)||
f.equals(Kd.a.cE),lc=f.equals(Kd.a.north)||f.equals(Kd.a.qu)||f.equals(Kd.a.ND),Ec=f.equals(Kd.a.south)||f.equals(Kd.a.fH)||f.equals(Kd.a.cE));f=this.wq.qn(c.oe.width);c=this.wq.qn(c.oe.height);for(const Jc of b)Jc.Vb>3*f/4&&Jc.Vb<f&&a.Zb<f/4&&0<a.Zb&&this.Rba(a,Jc,!1)&&Lb&&this.iu(a.Zb,f-Jc.Vb)&&(fa=!0,b=new rg,b.If=new ad.a(Jc.Vb-this.IA,Jc.Ub),b.zg=new ad.a(Jc.Vb-this.IA,Jc.Ub+this.qg),x.add(this.nv(b)),b=new rg,b.vG=!0,b.If=new ad.a(f-this.IA,Jc.Ub+this.qg),b.zg=new ad.a(Jc.Vb-this.IA,Jc.Ub+this.qg),
F.add(this.nv(b))),Jc.Zb<f/4&&0<Jc.Zb&&a.Vb>3*f/4&&a.Zb<f&&this.Rba(a,Jc,!1)&&kc&&this.iu(f-a.Vb,Jc.Zb)&&(wa=!0,b=new rg,b.If=new ad.a(Jc.Zb-this.CN,Jc.Ub),b.zg=new ad.a(Jc.Zb-this.CN,Jc.Ub+this.qg),x.add(this.nv(b)),b=new rg,b.vG=!0,b.If=new ad.a(0-this.CN,Jc.Ub+this.qg),b.zg=new ad.a(Jc.Zb-this.CN,Jc.Ub+this.qg),F.add(this.nv(b))),Jc.Ub>3*c/4&&Jc.Ub<c&&a.fc<c/4&&0<a.fc&&this.Rba(a,Jc,!0)&&lc&&this.iu(a.fc,c-Jc.Ub)&&(Xa=!0,b=new rg,b.If=new ad.a(Jc.Vb,Jc.Ub-this.V2),b.zg=new ad.a(Jc.Vb+this.qg,Jc.Ub-
this.V2),x.add(this.nv(b)),l=new rg,b.vG=!0,l.If=new ad.a(Jc.Vb+this.qg,Jc.Ub-this.V2),l.zg=new ad.a(Jc.Vb+this.qg,c-this.V2),F.add(this.nv(l))),Jc.fc<c/4&&0<Jc.fc&&a.Ub>3*c/4&&a.Ub<c&&this.Rba(a,Jc,!0)&&Ec&&this.iu(c-a.Ub,Jc.fc)&&(lb=!0,b=new rg,b.If=new ad.a(Jc.Vb,Jc.fc-this.Yv),b.zg=new ad.a(Jc.Vb+this.qg,Jc.fc-this.Yv),x.add(this.nv(b)),l=new rg,b.vG=!0,l.If=new ad.a(Jc.Vb+this.qg,0-this.Yv),l.zg=new ad.a(Jc.Vb+this.qg,Jc.fc-this.Yv),F.add(this.nv(l)));Xa&&(Xa=new rg,Xa.If=new ad.a(a.Vb,a.fc-
this.Yv),Xa.zg=new ad.a(a.Vb+this.qg,a.fc-this.Yv),x.add(this.nv(Xa)),Lb=new rg,Xa.vG=!0,Lb.If=new ad.a(a.Vb+this.qg,0-this.Yv),Lb.zg=new ad.a(a.Vb+this.qg,a.fc-this.Yv),F.add(this.nv(Lb)));lb&&(lb=new rg,lb.If=new ad.a(a.Vb,a.Ub-this.V2),lb.zg=new ad.a(a.Vb+this.qg,a.Ub-this.V2),x.add(this.nv(lb)),Xa=new rg,lb.vG=!0,Xa.If=new ad.a(a.Vb+this.qg,c-this.V2),Xa.zg=new ad.a(a.Vb+this.qg,a.Ub-this.V2),F.add(this.nv(Xa)));fa&&(fa=new rg,fa.If=new ad.a(a.Zb-this.CN,a.Ub),fa.zg=new ad.a(a.Zb-this.CN,a.Ub+
this.qg),x.add(this.nv(fa)),fa=new rg,fa.vG=!0,fa.If=new ad.a(0-this.CN,a.Ub+this.qg),fa.zg=new ad.a(a.Zb-this.CN,a.Ub+this.qg),F.add(this.nv(fa)));wa&&(wa=new rg,wa.If=new ad.a(a.Vb-this.IA,a.Ub),wa.zg=new ad.a(a.Vb-this.IA,a.Ub+this.qg),x.add(this.nv(wa)),wa=new rg,wa.vG=!0,wa.If=new ad.a(f-this.IA,a.Ub+this.qg),wa.zg=new ad.a(a.Vb-this.IA,a.Ub+this.qg),F.add(this.nv(wa)));this.GYa(x,1);this.GYa(F,2);for(let Jc of x)R.add(Jc);for(let Jc of F)R.add(Jc);return R}ohi(a,b,c){var f=new rg;const l=new rg,
x=new rg,F=new rg,R=new rg,fa=new rg,wa=new Ha.a;wa.add(f);wa.add(l);wa.add(x);wa.add(F);wa.add(R);wa.add(fa);this.GYa(wa,0);this.Hyj(f,l,x,F,R,fa,a);for(const Xa of b)this.W1(a.fc,Xa.fc,Xa.Ub,f,Xa),this.W1(a.Ub,Xa.fc,Xa.Ub,l,Xa),this.W1(a.Zb,Xa.Zb,Xa.Vb,x,Xa),this.W1(a.Vb,Xa.Zb,Xa.Vb,F,Xa),this.iAb&&(this.W1(a.fc,Xa.Uf()._y,null,f,Xa),this.W1(a.Ub,Xa.Uf()._y,null,l,Xa),this.W1(a.Zb,Xa.Uf()._x,null,x,Xa),this.W1(a.Vb,Xa.Uf()._x,null,F,Xa),this.W1(a.Uf()._y,Xa.fc,null,R,Xa),this.W1(a.Uf()._y,Xa.Ub,
null,R,Xa),this.W1(a.Uf()._x,Xa.Zb,null,fa,Xa),this.W1(a.Uf()._x,Xa.Vb,null,fa,Xa)),this.W1(a.Uf()._y,Xa.Uf()._y,null,R,Xa),this.W1(a.Uf()._x,Xa.Uf()._x,null,fa,Xa);0<f.length()&&0<l.length()&&(this.iAb?(R.If=new ad.a(a.Zb-this.qg,a.Uf()._y),R.zg=R.If.copy()):R.reset());0<x.length()&&0<F.length()&&(this.iAb?(fa.If=new ad.a(a.Uf()._x,a.Zb-this.CN),fa.zg=fa.If.copy()):fa.reset());if(this.iAb&&c){b=this.wq.qn(c.oe.width);c=this.wq.qn(c.oe.height);if(this.iu(a.fc,c/2)||Math.abs(a.fc)<=ek.p3a||this.iu(a.fc,
c))f.If._x=Math.min(f.If._x,-1*this.qg),f.zg._x=Math.max(f.zg._x,b+this.qg);if(this.iu(a.Ub,c/2)||Math.abs(a.Ub)<=ek.p3a||this.iu(a.Ub,c))l.If._x=Math.min(l.If._x,-1*this.qg),l.zg._x=Math.max(l.zg._x,b+this.qg);if(this.iu(a.Uf()._y,c/2)||Math.abs(a.Uf()._y)<=ek.p3a||this.iu(a.Uf()._y,c))R.If._x=Math.min(R.If._x,-1*this.qg),R.zg._x=Math.max(R.zg._x,b+this.qg);if(this.iu(a.Vb,b/2)||Math.abs(a.Vb)<=ek.p3a||this.iu(a.Vb,b))F.If._y=Math.min(F.If._y,-1*this.qg),F.zg._y=Math.max(F.zg._y,c+this.qg);if(this.iu(a.Zb,
b/2)||Math.abs(a.Zb)<=ek.p3a||this.iu(a.Zb,b))x.If._y=Math.min(x.If._y,-1*this.qg),x.zg._y=Math.max(x.zg._y,c+this.qg);if(this.iu(a.Uf()._x,b/2)||Math.abs(a.Uf()._x)<=ek.p3a||this.iu(a.Uf()._x,b))fa.If._y=Math.min(fa.If._y,-1*this.qg),fa.zg._y=Math.max(fa.zg._y,c+this.qg)}f=new Ha.a;for(let Xa of wa)Xa.If&&0<Xa.length()&&(this.O0f(Xa,a),f.add(this.nv(Xa)));return f}W1(a,b,c,f,l){(this.iu(a,b)||this.iu(a,c))&&this.O0f(f,l)}O0f(a,b){a.vG?(a.If._x=Math.min(a.If._x,b.Zb-this.qg),a.zg._x=Math.max(a.zg._x,
b.Vb+this.qg)):(a.If._y=Math.min(a.If._y,b.fc-this.qg),a.zg._y=Math.max(a.zg._y,b.Ub+this.qg))}nv(a){let b;(b=a.If).x=b.x+this.L0c;let c;(c=a.If).y=c.y+this.M0c;let f;(f=a.zg).x=f.x+this.L0c;let l;(l=a.zg).y=l.y+this.M0c;return a}iu(a,b){var c=ek.p3a;return!!a&&!!b&&Math.abs(a-b)<=c}Hyj(a,b,c,f,l,x,F){a.If=new ad.a(F.Zb-this.qg,F.fc-this.Yv);a.zg=a.If.copy();a.vG=!0;b.If=new ad.a(F.Zb-this.qg,F.Ub-this.V2);b.zg=b.If.copy();b.vG=!0;c.If=new ad.a(F.Zb-this.CN,F.fc-this.qg);c.zg=c.If.copy();f.If=new ad.a(F.Vb-
this.IA,F.fc-this.qg);f.zg=f.If.copy();b=F.Uf();l.If=new ad.a(a.If._x-this.qg,b._y-this.Yv);l.zg=l.If.copy();l.vG=!0;x.If=new ad.a(b._x-this.qg,c.If._y-this.qg);x.zg=x.If.copy()}GYa(a,b){for(let c of a)0===b?(c.color=Ve.a.Moi,c.dashStyle="4,4",c.h1b=0):1===b?(c.color=Ve.a.Loi,c.dashStyle="4,4",c.h1b=1):2===b&&(c.color=Ve.a.AOf,c.dashStyle="4,4",c.h1b=2)}get HVg(){return this.L0c}set HVg(a){this.L0c=a}get IVg(){return this.M0c}set IVg(a){this.M0c=a}}ek.p3a=.4;ek.GBc=5;Object(e.a)(ek,"SmartGuideUtility",
null,[1237]);var xn=d(140),rk=d(204),Rl=d(173),Zn=d(202);class $n{constructor(a,b,c,f,l){this.kAb=this.lAb=this.Ab=null;this.ika=new Sys.UI.Bounds(0,0,0,0);this.gGa=1;this.Ib=!1;this.Gg=a;this.vi=b;this.od=f;this.Hc=c;this.od.SSb(Object(D.a)(this,this.onResize,"onResize"));l&&this.od.NMa(Object(D.a)(this,this.E_,"onActiveSlideDomDisplayed"));this.$m()}get visible(){return!!this.Ab&&this.Ib}set visible(a){this.Ab||this.$m();this.Ib!==a&&(this.Ab.Qd(a),this.Ib=a)}hYf(a){this.kAb&&this.lAb.ya.removeChild(this.kAb.ya);
this.kAb=new rk.a;let b=0;for(;b<a.length;b++){const c=a[b],f=new Rl.a,l=$n.ySj($n.F$g(ad.a.scale(c.If,this.gGa,this.gGa)),$n.F$g(ad.a.scale(c.zg,this.gGa,this.gGa)));f.Qt(l);f.qv(this.d6f(c.color));f.Hma(c.dashStyle);f.zr(1);this.kAb.appendChild(f);2===c.h1b&&this.EIi(l[0],l[1])}this.lAb.appendChild(this.kAb)}EIi(a,b){a._y===b._y?a._x<b._x?this.nRf(a,b):this.nRf(b,a):a._y>b._y?this.oRf(a,b):this.oRf(b,a)}nRf(a,b){const c=this.yKf(b._x-a._x);this.AEc([new ad.a(a._x,a._y),new ad.a(a._x+c,a._y-c/2),
new ad.a(a._x+c,a._y+c/2)]);this.AEc([new ad.a(b._x,b._y),new ad.a(b._x-c,b._y-c/2),new ad.a(b._x-c,b._y+c/2)])}oRf(a,b){const c=this.yKf(a._y-b._y);this.AEc([new ad.a(a._x,a._y),new ad.a(a._x-c/2,a._y-c),new ad.a(a._x+c/2,a._y-c)]);this.AEc([new ad.a(b._x,b._y),new ad.a(b._x-c/2,b._y+c),new ad.a(b._x+c/2,b._y+c)])}yKf(a){return Math.min(a,10)/2}AEc(a){const b=new Rl.a,c=this.d6f(Ve.a.AOf);b.Qt(a);b.qv(c);b.zr(1);b.BF(c);b.Qd(!0);this.kAb.appendChild(b)}d6f(a){return this.vi&&this.vi.highContrastColors?
this.vi.highContrastColors.foregroundTextColor:a}$m(){this.Ab=new xn.a;this.Ab.ot("SmartGuideView");this.Ab.Qk(0);this.Ab.Qd(!1);this.Gg.ya.appendChild(this.Ab.ya);this.lAb=new Zn.a;this.lAb.ya.style.overflow="visible";this.Ab.appendChild(this.lAb);this.Ws(this.Hc.Jc)}onResize(a,b){b&&this.Ws(b.EF)}E_(a,b){b&&this.Ws(b.EF)}Ws(a){this.Ab&&a&&a.oe&&a===this.Hc.Jc&&(this.ika.x!==a.oe.x||this.ika.y!==a.oe.y||this.ika.width!==a.oe.width||this.ika.height!==a.oe.height)&&(this.ika=new Sys.UI.Bounds(a.oe.x,
a.oe.y,a.oe.width,a.oe.height),this.Ab.setPosition(a.oe.x,a.oe.y),this.lAb.yh(a.oe.width,a.oe.height),this.Ab.yh(a.oe.width,a.oe.height))}static ySj(a,b){b._y===a._y||Math.abs(b._y-a._y)%2||(b._y+=1);b._x===a._x||Math.abs(b._x-a._x)%2||(b._x+=1);return[a,b]}static F$g(a){return new ad.a(Math.floor(a.x)+.5,Math.floor(a.y)+.5)}}Object(e.a)($n,"SmartGuideView",null,[1236]);class Cp{setPosition(a,b,c){a.setPosition(a.x+b,a.y+c,!0)}setOffsets(a,b){a.setOffsets(Pd.a.add(a.UVa,b),!0)}UH(a){return new qk.a(a.As())}CF(a){return!a.shapeNode.yx}}
Object(e.a)(Cp,"DefaultShapeMoveResizeHandler",null,[763]);class Jo{constructor(){this.K=null}get name(){return"PowerPointWebEditor.SmartGuide"}Wb(a){this.K=a;this.K.register(1235,"PowerPointWebEditor.ISmartGuideManager").ma().na(()=>new Yn(this.K.resolve("PowerPointWebEditor.ISmartGuideView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesMarginCenterEquisizing));
this.K.register(1236,"PowerPointWebEditor.ISmartGuideView").ma().na(()=>new $n(this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").qsa));this.K.register(1237,"PowerPointWebEditor.ISmartGuideUtility").ma().na(()=>new ek(this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesAlignToSlideAndCenterEdge))}init(){this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new Cp)}dispose(){}static main(){m.a.instance.Ac(new Jo)}}Object(e.a)(Jo,"PPTWebEditorSmartGuidePackage",null,[2,3]);class sm{}sm.xAg=[C.a.backspace,C.a.Cpb,C.a.eK,C.a.OWb,C.a.FAa,C.a.enter,C.a.ygd,C.a.SA,C.a.tab,C.a.ckc,C.a.pageDown,C.a.pageUp,C.a.LVa,C.a.wse,C.a.KVa,C.a.vse];sm.DUj=[C.a.backspace,C.a.Cpb,C.a.eK,C.a.OWb,C.a.FAa,
C.a.enter,C.a.ygd,C.a.SA,C.a.tab,C.a.ckc,C.a.font,C.a.u4,C.a.LHa,C.a.yr,C.a.eHa,C.a.qXa,C.a.$H,C.a.lJ,C.a.bold,C.a.setItalic,C.a.underline,C.a.strikethrough,C.a.Ss,C.a.W9,C.a.Yza,C.a.tO,C.a.XQ,C.a.HE,C.a.Ry,C.a.eha,C.a.jja,C.a.sma,C.a.uBa,ba.a.Ila,ba.a.Pla,ba.a.Ola,ba.a.Nla,C.a.uOa,C.a.Kra,C.a.Rwa,C.a.Swa,C.a.Twa,C.a.SIa,C.a.TIa,C.a.pQc,C.a.qQc,C.a.K7a,C.a.lRa,C.a.N7a,C.a.HCa,C.a.aba,ba.a.lDb,C.a.deleteRow,ba.a.m$c,C.a.EAa,ba.a.Mye,C.a.insertTable,ba.a.Sye,C.a.Jza,C.a.u1,ba.a.xva,ba.a.yWa,ba.a.Lfb,
ba.a.$Xa,ba.a.jwa,ba.a.aYa,ba.a.Ihd,ba.a.Hhd,C.a.hO,C.a.oRa,C.a.centerJustify,C.a.leftJustify,C.a.rightJustify,C.a.fullJustify,C.a.DXb,C.a.m5b,C.a.Njc,ba.a.mgb,ba.a.ngb,ba.a.ogb,ba.a.pgb,C.a.XTb];sm.iZk=[C.a.leftArrow,C.a.rightArrow,C.a.upArrow,C.a.downArrow,C.a.hYa,C.a.gYa,C.a.xAa,C.a.wAa,C.a.fOa,C.a.eOa,C.a.LGb,C.a.Xfb,C.a.PWb,C.a.Dpb,C.a.k4a,C.a.dOa,C.a.LVa,C.a.dPa,C.a.lcb,C.a.kcb,C.a.f5a,C.a.KVa,C.a.cPa,C.a.e5a,C.a.Eqa,C.a.zgd,ba.a.Wic,ba.a.bJb,ba.a.rYa,ba.a.mHb];Object(e.a)(sm,"ActionIdList",
null,[]);class Ko{constructor(){this.ActionTime=this.ActionName=this.ActionId=null}}Object(e.a)(Ko,"ActionInformation",null,[]);class Lo{constructor(a,b,c,f,l,x){this.t9a=[];this.l6b=[];this.sI=a;this.Xce=b||[];this.ia=c;this.ia.Zla(this);this.Xa=f;this.uW=l;this.DG=x}B9(a){this.kph(a)&&this.Lma(a.actionId)&&(this.t9a.push(a.actionId),this.l6b.push(Date.now()))}z9(a){this.kph(a)&&this.Lma(a.actionId)&&(this.t9a.pop(),this.l6b.pop())}Lma(a){if(Array.contains(this.Xce,a))return!0;a=this.ia.iS(a);return!!a&&
!(a.flags[32]||a.flags[64])}kph(a){return 2===a.behavior&&a.Vi?!0:!1}getCommandName(a,b=""){return(a=this.sI?this.sI.D4(a):null)?a:b}C_(a){a&&a.kqa&&ya.a.J(23594504,822,50,"ClientRevisionId:{0}, ActionName:{1}, PodSID:{2}, UndoAction:{3}",a.kqa.toString(),this.actionName||(this.uW.$c===C.a.typing||this.uW.$c===C.a.Oza||this.uW.$c===C.a.sOa?"Typing":null)||(this.DG.lRc?"ClosingTextUndoStack":""),this.Xa.podSessionId||"",this.sI.D4(this.uW.$c));return!!this.t9a.length}update(a,b){a=new Ko;a.ActionId=
this.S$f();a.ActionName=this.T$f();a.ActionTime=this.I5i().toString();om.a.Fo(b,ub.a.IYh,a);b.setValue(ub.a.x2b,!0);b.setValue(ub.a.Cdd,1)}get actionName(){return this.T$f()}get actionId(){return this.S$f()}wZd(){return this.t9a[this.t9a.length-1]}S$f(){return this.t9a.length?this.wZd().toString():null}T$f(){return this.t9a.length?this.getCommandName(this.wZd(),this.wZd().toString()):null}I5i(){return this.l6b.length?this.l6b[this.l6b.length-1]:Number.MAX_VALUE}}Object(e.a)(Lo,"ActionInfoRevisionMetaDataUpdater",
null,[1282,156]);class ao{constructor(){this.va=new qd.a}w$g(a){this.va.raiseEvent("UCI",a)}a6h(a){this.va.addHandler("UCI",a)}XQk(a){this.va.removeHandler("UCI",a)}}Object(e.a)(ao,"CcpEventSource",null,[1343,1344,1345]);class Sl{constructor(a,b){this.L6b=this.fee=this.eee=null;this.gee=a;this.kT=b;this.gee.a6h(Object(D.a)(this,this.cXg,"onCcpPropertyChanged"))}cXg(a,b){this.eee=b.Fp;this.fee=b.pji;this.L6b=b.qji}C_(a){a=this.kT.XBa(a.Uva);!this.L6b&&a.Sa(ub.a.K3a)&&(a.removeProperty(ub.a.CM),a.removeProperty(ub.a.hP),
a.removeProperty(ub.a.K3a));return!!this.L6b}update(a,b){b.setValue(ub.a.CM,this.eee);b.setValue(ub.a.hP,this.fee);b.setValue(ub.a.K3a,this.L6b);this.L6b=this.fee=this.eee=null}dispose(){this.gee&&this.gee.XQk(Object(D.a)(this,this.cXg,"onCcpPropertyChanged"))}}Object(e.a)(Sl,"CcpInfoRevisionMetaDataUpdater",null,[1232,1282,106]);var Rk=d(313);class ol extends Yg.a{constructor(a,b,c,f,l,x,F){super();this.ShapeId=this.Sid=this.Cid=0;this.FetchImageData=!1;this.AuthToken=this.Origin=this.SessionUrl=
null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.FetchImageData=f;this.SessionUrl=l;this.Origin=x;this.AuthToken=F}Ik(){return 108}}Object(e.a)(ol,"AugmentImageRequest",Yg.a,[]);class pi extends Yg.a{constructor(){super()}Ik(){return 81}}Object(e.a)(pi,"FlushRequest",Yg.a,[]);class Eg extends Yg.a{constructor(a,b,c,f,l,x){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.DeckSuggestionId=this.SessionId=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.SessionId=
f;this.DeckSuggestionId=l;this.Hints=x}Ik(){return 111}}Object(e.a)(Eg,"GenerateAgendaDeckSuggestionRequest",Yg.a,[]);class Hm extends Yg.a{constructor(a,b,c,f,l){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.OutlineJson=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.OutlineJson=f;this.Hints=l}Ik(){return 110}}Object(e.a)(Hm,"GenerateAgendaSuggestionRequest",Yg.a,[]);class ye extends Yg.a{constructor(a,b,c,f,l,x,F,R,fa,wa){super();this.ShapeViewHeight=
this.ShapeViewWidth=this.ShapeId=this.Sid=this.Cid=0;this.SubNodeId=null;this.SubNodeHeight=this.SubNodeWidth=0;this.Trigger=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.ShapeViewWidth=f;this.ShapeViewHeight=l;this.SubNodeId=x;this.SubNodeWidth=F;this.SubNodeHeight=R;this.CorrelationId=fa;this.Trigger=wa}Ik(){return 99}}Object(e.a)(ye,"GenerateIconSuggestionRequest",Yg.a,[]);class pl extends Yg.a{constructor(a,b,c,f){super();this.ImageKey=this.GraphNodeId=null;this.IsGenerateSuggestion=
this.IsSVGBlipFill=!1;this.GraphNodeId=we.a(a);this.ImageKey=b;this.IsSVGBlipFill=c;this.IsGenerateSuggestion=f}Ik(){return 91}}Object(e.a)(pl,"GenerateImageDescriptionRequest",Yg.a,[]);class cm extends Yg.a{constructor(a,b,c,f,l,x,F){super();this.Sid=this.Cid=0;this.Hints=this.LastShownCorrelationId=this.Trigger=this.TermCorrelationId=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.CorrelationId=c;this.TermCorrelationId=f;this.Trigger=l;this.LastShownCorrelationId=x;this.Hints=F}Ik(){return 66}}
Object(e.a)(cm,"GenerateSuggestionRequest",Yg.a,[]);class bo extends cm{constructor(a,b,c,f,l,x,F,R){super(a,b,f,null,l,x,"");this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=0;this.ShapeId=c;this.ShapeViewWidth=F;this.ShapeViewHeight=R}Ik(){return 83}}Object(e.a)(bo,"GenerateReplaceObjectRequest",cm,[]);class Sk extends Yg.a{constructor(a,b,c){super();this.m_shapeid=this.m_cid=this.m_slideid=0;this.m_slideid=a;this.m_cid=b;this.m_shapeid=c}Ik(){return 57}}Object(e.a)(Sk,"GetPictureCropInfoRequest",
Yg.a,[]);class qi extends Yg.a{constructor(){super();this.SlideCid=this.SlideSid=this.Scenario=0;this.ShapeIds=null}Ik(){return 109}}Object(e.a)(qi,"ImageTransformRequest",Yg.a,[]);class ql extends Yg.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}Ik(){return 84}}Object(e.a)(ql,"ReportReplaceObjectInfoRequest",Yg.a,[]);class fk extends Yg.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=
b}Ik(){return 67}}Object(e.a)(fk,"ReportSuggestionSessionInfoRequest",Yg.a,[]);class Tl extends Yg.a{constructor(a,b,c){super();this.SlideId=null;this.ShapeId=0;this.Base64OfSnapshot=null;this.SlideId=a;this.ShapeId=b;this.Base64OfSnapshot=c}Ik(){return 59}}Object(e.a)(Tl,"UpdateContentAddinSnapshotInfoRequest",Yg.a,[]);class uo{constructor(a,b,c){this.DG=a;this.Yb=b;this.VDg=c}get lRc(){return this.DG.lRc}O3a(a,b=!1){this.DG.O3a(a,b)}forceOutbound(){this.DG.forceOutbound()}sea(a,b,c=!1){this.DG.sea(a,
b,c)}Yyc(a){this.DG.Yyc(a)}csb(a){return this.DG.csb(a)}Gb(a){this.DG.Gb(a)}Jbg(a,b,c,f=null,l=null,x=!1){a=new Nf.a(new Sk(a,b,c),f,l,F=>0===F.StatusCode);this.DG.sea(a,this.Yb,x)}Vha(a,b,c,f,l,x,F,R=null,fa=null){a=new Nf.a(new cm(a,b,c,f,l,x,F),R,fa,wa=>0===wa.StatusCode);this.DG.sea(a,this.Yb)}generateImageDescription(a,b,c,f){a=new Nf.a(new pl(a,b,c,f),null,null,l=>0===l.StatusCode);this.DG.sea(a,this.Yb)}mma(a,b,c){a=new Nf.a(new fk(a,b),null,()=>!0,f=>0===f.StatusCode);this.DG.sea(a,this.Yb,
c)}M5f(a,b,c,f,l,x,F,R=null,fa=null){a=new Nf.a(new bo(a,b,c,f,l,null,x,F),R,fa,wa=>0===wa.StatusCode);this.DG.sea(a,this.Yb)}ESk(a,b,c=null,f=null){a=new Nf.a(new ql(a,b),c,f,l=>0===l.StatusCode);this.DG.sea(a,this.Yb)}dWi(a,b,c,f,l,x,F,R,fa=null,wa=null){a=new Nf.a(new ye(a,b,c,f,l,x,74,74,F,R),fa,wa,Xa=>0===Xa.StatusCode);this.DG.sea(a,this.Yb)}augmentImage(a,b,c,f,l,x,F,R=null,fa=null){a=new Nf.a(new ol(a,b,c,f,l,x,F),R,fa,wa=>0===wa.StatusCode);this.DG.sea(a,this.Yb)}generateAgendaSuggestion(a,
b,c,f,l,x=null,F=null){a=new Nf.a(new Hm(a,b,c,f,l),x,F,R=>0===R.StatusCode);this.DG.sea(a,this.Yb)}generateAgendaDeckSuggestion(a,b,c,f,l,x,F=null,R=null){a=new Nf.a(new Eg(a,b,c,f,l,x),F,R,fa=>0===fa.StatusCode);this.DG.sea(a,this.Yb)}HAh(a,b,c,f=null,l=null){const x=new Nf.a(new Tl(a,b,c),f,l,fa=>0===fa.StatusCode),F=()=>{this.ZMi(x)};a=this.DG.csb(this.Yb.yf);const R=new Rk.a;a?a.forceOutbound(()=>{F()},l?()=>{l(R)}:null,null):(ya.a.J(20460503,823,10,"Can't find graph space replicator when trying to do outbound"),
l&&l(R))}flush(a=null,b=null){a=new Nf.a(new pi,a,b,c=>0===c.StatusCode,3);this.DG.Dqa(a)}Dqa(a){this.DG.Dqa(a)}dLc(){return this.csb(this.Yb.yf)}ZMi(a){this.VDg.Gb(a);this.VDg.forceOutbound(null,null,null)}}Object(e.a)(uo,"OutboundHelper",null,[1229,13,1288]);var $g=d(255),vj=d(166);class co{constructor(a,b,c,f,l){this.bL=[];this.jab=new $g.a;this.B3c=null;this.aCg=[];this.I3=null;this.va=new qd.a;this.lGg=this.Tyb=this.e3c=!1;this.Sb=a;this.la=b;this.ta=c;this.k7j=l;this.Cta=f;this.J4j=this.la.jsa?
1:4;f.xk(Object(D.a)(this,this.y7c,"onMainMastersLoaded"));this.la.jsa&&f.xk(Object(D.a)(this,this.qZg,"onMasterIdListChanged"))}get gbk(){if(this.la.jsa&&this.ta.Ba){const a=this.ta.Ba.uj;a&&Array.contains(this.bL,a)&&this.qse(a)}return this.bL.slice(0,Math.min(this.J4j,this.bL.length))}ZNk(a){Array.remove(this.bL,a)}get akl(){return this.B3c}get VN(){return this.jab}get lSb(){return this.aCg}get Xuj(){return!this.B3c}get Cuk(){return 0<this.bL.length&&(!this.la.fSa||this.e3c)}get Mse(){return this.Tyb}set Mse(a){this.Tyb=
a}Dgl(a){a&&this.nyh(a.uj)}Ash(){this.e3c=!0;this.Wbd(!0);this.gFb()}nyh(a){this.e3c=!0;a&&(Array.remove(this.bL,a),Array.insert(this.bL,0,a));this.gFb()}eNe(a){this.la.jsa?this.nyh(a):this.Ash()}qag(a){if(!a||!this.jab)return null;a=a.uj;if(!a)return null;let b=null;return({value:b}=this.jab.Of(a)).returnValue?b:null}qZg(a,b){b.property.id===ub.a.H4c.id&&(ya.a.J(38847373,824,50,"MasterIdList update, need load master id list: {0}",this.Tyb),this.Tyb&&(this.Tyb=!1,this.e3c&&(this.Wbd(!1),this.gFb())),
this.nMf())}y7c(a,b){a=b.property;if(this.la.jsa)if(a.id===ub.a.VAb.id){a=this.Sb.E5i();const f=this.Sb.TH();if(f&&f.length)if(a&&a.length){for(var c=b=0;b<a.length&&c<f.length;){const l=a[b],x=f[c];l.Id<x.Id?(this.LAh(l.Id),b++):x.Id<l.Id?(this.SSe(x.Id),c++):(fe.c(l)!==fe.c(x)&&this.Wtl(x.Id),c++,b++)}if(c<f.length)for(;c<f.length;c++)this.SSe(f[c].Id);if(b<a.length)for(;b<a.length;b++)this.LAh(a[b].Id);this.gFb()}else vj.b(f,null,l=>{this.SSe(l.Id)})}else a.id===ub.a.sX.id&&(ya.a.J(38847375,824,
50,"Slide size changed, need to reload the resources."),this.Wbd(!0),this.gFb());else if(a.id===ub.a.VAb.id||a.id===ub.a.sX.id)ya.a.J(19240846,824,50,"MainMasters are reloaded, need to reload the resources"),this.Wbd(!0),this.gFb()}SSe(a){this.qse(a)}Wtl(a){this.qse(a)}qse(a){Array.contains(this.bL,a)&&Array.remove(this.bL,a);Array.insert(this.bL,0,a)}LAh(a){this.jab.remove(a);-1!==Array.indexOf(this.bL,a)&&Array.remove(this.bL,a)}gFb(){this.I3=this.I3||this.k7j(this);this.I3.OE(null,null,null)}Wbd(a){if(this.la.jsa){ya.a.J(38847378,
824,50,"RefreshMastersToLoad, need clean cache: {0} ",a);var b=this.Sb.vrb();a&&(Array.clear(this.bL),this.clearCache());if(b&&0<b.length)for(const c of b)-1===Array.indexOf(this.bL,c.idField)&&Array.add(this.bL,c.idField);else this.Tyb=!0,(a=this.Sb.XH(0))&&(a=a.uj)&&Array.add(this.bL,a)}else if(a=this.Sb.TH(),Array.clear(this.bL),this.clearCache(),a)for(b of a)this.jab.remove(b.Id),-1===Array.indexOf(this.bL,b.Id)&&Array.add(this.bL,b.Id)}ylk(a){if(a){for(const b of a)b&&(ya.a.J(38847381,824,50,
"PresentationResourcesManager::OnMainMasterResoucesLoaded master {0} resources loaded.",b.MasterId),this.jab.$(b.MasterId,b),this.B3c=this.B3c||b.TableStyleGallery,this.la.jsa||Array.remove(this.bL,b.MasterId));this.nMf();this.va.raiseEvent("MainMasterResourcesLoaded")}else ya.a.J(19240848,824,10,"PresentationResourcesManager::OnMainMasterResoucesLoaded mainMasterResouces returned is null")}nMf(){!this.lGg&&this.HGf()&&(this.lGg=!0,ya.a.J(38892514,824,50,"PresentationResourcesManager::CheckFirstMasterRetrieved first master retrieved."),
ee.a("RaiseFirstMasterRetrievedEvent")&&this.va.raiseEvent("FirstMasterRetrieved"))}Igk(a){this.la.powerPointEnableAccCheck&&(a&&a.length?(this.aCg=a,this.va.raiseEvent("AccCheckRuleInfoListLoaded")):ya.a.J(19240850,824,10,"PresentationResourcesManager::OnAccRuleInfoListLoaded accRuleInfoList returned is null as acc-checker is enabled"))}HGf(){if(!this.la.jsa)return!0;const a=this.Sb.vrb();if(a&&0<a.length)for(const b of this.Sb.vrb())if(0<b.layoutCountField&&this.VN.Jb(b.idField)&&this.VN.ga(b.idField).LayoutIcons.length===
b.layoutCountField)return ya.a.J(38892545,813,50,"LayoutDialogReady: master ID: {0}, layout count: {1}",b.idField,b.layoutCountField),!0;return!1}Gzc(a){this.va.addHandler("MainMasterResourcesLoaded",a)}KPk(a){this.va.removeHandler("MainMasterResourcesLoaded",a)}R3h(a){this.va.addHandler("FirstMasterRetrieved",a)}m3h(a){this.va.addHandler("AccCheckRuleInfoListLoaded",a)}hPk(a){this.va.removeHandler("AccCheckRuleInfoListLoaded",a)}clearCache(){this.jab=new $g.a}dispose(){this.Cta.Tm(Object(D.a)(this,
this.y7c,"onMainMastersLoaded"));this.la.jsa&&this.Cta.Tm(Object(D.a)(this,this.qZg,"onMasterIdListChanged"));this.va.dispose();this.I3&&this.I3.dispose()}}Object(e.a)(co,"PresentationResourcesManager",null,[1231,106]);var Mo=d(377);class Hn extends Yg.a{constructor(){super();this.MasterIds=null;this.NeedLoadingMasterIdList=this.IncludeTableStyle=!1}Ik(){return 52}static uNd(a,b,c){const f=new Hn;f.MasterIds=a;f.IncludeTableStyle=b;f.NeedLoadingMasterIdList=c;return f}}Object(e.a)(Hn,"GetEditPresResourcesRequest",
Yg.a,[]);class $m extends Mo.a{constructor(a,b,c,f){super();this.Uwb=0;this.Gab=this.d3=!1;this.vm=a;this.GUa=b;this.EN=f;this.enabled=2;this.fw=c.Pwi();this.vm.register(this)}OE(){this.fw.aUi();this.fw.D7a();this.vm.T9()}forceOutbound(){}sia(){return this.GUa.Cuk||this.GUa.Mse}JP(){return!1}QQa(){return this.Md&&2===this.Md.status?!0:this.d3||this.Gab?!1:this.sia()&&this.fw.G1b()}MEb(){if(1===this._state){var a=this.GUa.gbk;this.Md.bH=Hn.uNd(a,this.GUa.Xuj,this.GUa.Mse);for(const b of a)this.GUa.ZNk(b);
this.Md.status=1;this._state=3}else 3===this._state&&this.Md&&2===this.Md.status&&(this.Gab?(this._state=4,this.dispose()):(200===this.Md.qy&&this.EN.eic(),this.fw.vJa(),2!==this.Md.statusCode?this.XG():this.Md.vr&&1===this.Md.vr.length?(a=this.Md.vr[0],0===a.StatusCode?(this.GUa.ylk(fe.a(a.MainMasterResources)),this.GUa.Igk(fe.a(a.AccRuleInfoList)),this.F_()):this.XG()):this.XG()))}get bba(){return this.sia()?this.fw.Aeb():super.bba}dispose(){1===this._state||4===this._state?(this.d3||this.vm.unregister(this),
this.d3=!0):this.Gab=!0}F_(){this.Uwb=0;this._state=1;this.sia()||this.fw.sYa()}XG(){4<++this.Uwb?(this._state=4,ya.a.J(19240853,824,10,"PresentationResourcesReplicator quit after {0} failures",this.Uwb)):(ya.a.J(19240855,824,15,"PresentationResourcesReplicator will retry on failure"),this._state=1)}}Object(e.a)($m,"PresentationResourcesReplicator",Mo.a,[106]);class Tk{constructor(a,b){this.w7j=a;this.kT=b}snk(a){if(!a)throw Error.argumentNull("dataStorePusher is null!");const b=a.Uva;let c=null,
f=!1;for(const l of this.w7j)if(l.C_(a)){if(!c&&(c=this.kT.XBa(b),!c)){ya.a.J(23594507,817,50,"revisionMetadata is null");return}l.update(a,c);f=!0}f&&this.kT.NFd(b,a,c)}}Object(e.a)(Tk,"RevisionMetaDataUpdateListener",null,[1233]);var vo=d(397);class an{XBa(a){if(!a)return null;const b=a.sK(4);return b&&!b.equals(Ga.a.nil)?a.re(b):new vo.a}fTe(a,b,c,f,l,x,F,R,fa){if(a&&f){a.Nn.apply(a,an.FWk);a.setValue(ub.a.vvg,b);a.setValue(ub.a.x2b,!0);a.setValue(ub.a.Cdd,1);a.setValue(ub.a.sid,f.sid);a.setValue(ub.a.cid,
f.cid);c&&a.setValue(ub.a.fDa,!0);l&&a.setValue(ub.a.shapeId,l.get_shapeId());x&&(a.setValue(ub.a.Np,!0),a.setValue(ub.a.Nuh,x.cellId),a.setValue(ub.a.rowId,x.rowId));if(F&&0<F.length){b=F.length;c=Array(b);f=Array(b);for(l=0;l<b;l++)c[l]=F[l].rowId,f[l]=F[l].cellId;a.setValue(ub.a.Np,!0);a.setValue(ub.a.Rgb,f);a.setValue(ub.a.Zuh,c)}a.setValue(ub.a.yPe,R);a.setValue(ub.a.xPe,fa)}}NFd(a,b,c){if(a&&b&&c){var f=!1;a.re(an.kea)||(a.SD(c,an.kea),f=!0);b.mpa(c);f&&b.hwa(c.id,4)}}UBh(a,b){if(a){var c=a.Uva,
f=this.XBa(c);f.setValue(ub.a.Cdd,b);this.NFd(c,a,f)}}Uvl(a){if(a){var b=a.Uva,c=this.XBa(b);c.setValue(ub.a.oVk,0);this.NFd(b,a,c)}}}an.kea=Ga.a.Yf("{B3AB583C-77CD-428D-9371-02C2EA7C058B}{1}");an.FWk=[ub.a.vvg,ub.a.shapeId,ub.a.Np,ub.a.fDa,ub.a.Nuh,ub.a.rowId,ub.a.Rgb,ub.a.Zuh,ub.a.yPe,ub.a.xPe];Object(e.a)(an,"RevisionMetadataHelper",null,[1342]);var In=d(647),wo=d(831);class rl extends Yg.a{constructor(a,b,c,f){super();this.ShouldWaitForSave=this.ShouldReleaseLock=!1;this.SessionCloseReason=0;
this.SessionKey=null;this.ShouldReleaseLock=a;this.ShouldWaitForSave=b;this.SessionCloseReason=c;this.SessionKey=f}Ik(){return 32}}Object(e.a)(rl,"SaveAndCloseRequest",Yg.a,[]);class eo{constructor(a,b,c,f,l,x,F,R,fa){this.ni=a;this.Noe=b;this.UB=c;this.Xa=f;this.la=l;this.KA=x;this.Kd=F;this.hc=R;this.vm=fa}cUi(a){this.Xa.qvb=!0;a=new rl(!0,!1,a,this.Xa.podSessionId);this.Kd.wia=!0;const b=this.ni.dLc();b&&b.JP()&&this.hc.ln?b.E5a(null,null,null,a):this.Noe.D0f(a,null,null)}f2(a=!1,b=!0,c=null,f=
null,l=1){ya.a.J(36987935,823,50,"SaveAndCloseHandler::ForceSave Start, fReleaseLock: {0}, fWaitForSave: {1}, fSaveToHost: {2}",a,!0,b);const x=new rl(a,!0,l,this.Xa.podSessionId);if(a&&this.la.markSessionClosingAtForceSave)this.KA.markSessionClosingAtForceSave(l),this.vm.pause(),this.Noe.E5a(x,F=>{ya.a.J(41263715,823,50,"SaveAndCloseHandler::ForceSave Succeeded. Closing session");this.la.L0f?this.KA.closeSession(l):this.UB.Cbd(new In.a(l));c(F)},()=>{ya.a.J(41263745,823,15,"SaveAndCloseHandler::ForceSave Failed.");
this.vm.yhb();f&&f(null);return!0});else{a=this.ni.dLc();const F=R=>{this.Wjk(x,c,f,fa=>0===fa.StatusCode,R,b,l)};a?a.forceOutbound(()=>{F(!0)},()=>{F(!1)},null):(ya.a.J(22410186,823,10,"Can't find graph space replicator when trying to do outbound"),F(!1))}}Wjk(a,b,c,f,l,x,F){ya.a.J(36987938,823,50,"SaveAndCloseHandler::OnForceSaveOutboundComplete Start, fReleaseLock: {0}, fOutboundSuccess: {1}, fSaveToHost: {2}",a.ShouldReleaseLock,l,x);l&&x||a.ShouldReleaseLock?(a.ShouldReleaseLock&&(this.Kd.wia=
!0),this.Noe.Dqa(a,R=>{a.ShouldReleaseLock&&(this.la.L0f?this.KA.closeSession(F):this.UB.Cbd(new In.a(F)));b(R)},c,f)):l&&b?b(new wo.a):!l&&c&&c(new Rk.a)}}Object(e.a)(eo,"SaveAndCloseHandler",null,[1230]);var Dp=d(992),ri=d(106);class Ck{constructor(a,b,c,f){this.ni=a;this.Aqe=b;this.Qac=c;this.wua=f}C_(a){let b=null,c=!0;if(this.ni.lRc)b=a.kqa,c=!1;else if(this.Aqe.$c===C.a.typing||this.Aqe.$c===C.a.Oza||this.Aqe.$c===C.a.sOa)b=a.kqa;b&&(this.wua&&this.sBi(b.toString()),Mc.a.W8a(),this.Qac.Xwh(b,
c),ya.a.J(23594510,822,50,"ClientRevisionId:{0}, GenerateTime:{1}",a.kqa.toString(),Mc.a.Ye(new Date)));return!1}update(){}sBi(a){const b=new Dp.ActionContext(ri.a.mzh,1,null);b.Ij=!0;b.BE=new Date;b.Wa(ri.a.uX,Mc.a.D6a(a).toString());b.Ar=!0;Mc.a.dea(b)}}Object(e.a)(Ck,"TextEditingRevisionInfoMetaDataUpdater",null,[1282]);class bn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Storage"}Wb(a){this.K=a;const b=()=>new Sh.a(a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").BWb(a.resolve("Box4.IReplicationParameters")),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Xg);a.register(1229,"PowerPointWebEditor.Storage.IOutboundHelper").ma().na(()=>new uo(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),b()));a.register(1230,"PowerPointWebEditor.Storage.ISaveAndCloseHandler").ma().na(()=>
new eo(a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),a.resolve("PowerPointWebEditor.BootStorage.ISaveAndCloseTaskExecutor"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IReplicationScheduler")));a.register(1231,
"PowerPointWebEditor.IPresentationResourcesManager").ma().na(()=>new co(a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").Bd(7),c=>new $m(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),c,a.resolve("PowerPointWebEditor.IReplicationTimerFactory"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"))));this.Kri()}Kri(){this.K.register(an,
"PowerPointWebEditor.RevisionMetadataHelper").as("PowerPointWebEditor.IRevisionMetadataHelper").ma();this.K.register(ao,"PowerPointWebEditor.CcpEventSource").as("PowerPointWebEditor.ICcpEventSource").as("PowerPointWebEditor.ICcpEventNotifier").as("PowerPointWebEditor.ICcpEventHandlers").ma();this.K.register(1232,"PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").ma().na(()=>new Sl(this.K.resolve("PowerPointWebEditor.ICcpEventHandlers"),this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")));
this.K.register(1233,"PowerPointWebEditor.IRevisionMetaDataUpdateListener").ma().na(()=>new Tk([new Lo(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),sm.xAg,this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper")),new Ck(this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),
this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").podThumbnailUpdateTelemetryEnabled),this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater")],this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))}init(){this.K.resolve("PowerPointWebEditor.IRevisionMetaDataUpdateListener")}dispose(){this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").dispose();this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").dispose()}static main(){m.a.instance.Ac(new bn)}}
Object(e.a)(bn,"PPTWebEditorStoragePackage",null,[2,3]);class pc{constructor(a,b,c){this.lGh=a;this.GJh=b;this.$Th=c}get LCID(){return this.lGh}get jYk(){return this.$Th}get zTf(){return this.GJh}get Q7d(){return!!(this.zTf&pc.CFh)}get s3b(){return!!(this.zTf&pc.DFh)}static $Pc(){pc.aGe={["20490"]:new pc(20490,4215112,"Latn"),["8251"]:new pc(8251,4215112,"Latn"),["17418"]:new pc(17418,4215112,"Latn"),["17417"]:new pc(17417,4215112,"Latn"),["8218"]:new pc(8218,4215304,"Cyrl"),["8204"]:new pc(8204,
4215112,"Latn"),["8202"]:new pc(8202,4215112,"Latn"),["8201"]:new pc(8201,4215112,"Latn"),["8193"]:new pc(8193,4493640,"Arab"),["6154"]:new pc(6154,4215112,"Latn"),["7227"]:new pc(7227,4215112,"Latn"),["19466"]:new pc(19466,4215112,"Latn"),["16394"]:new pc(16394,4215112,"Latn"),["16393"]:new pc(16393,4215112,"Latn"),["16385"]:new pc(16385,4493640,"Arab"),["7194"]:new pc(7194,4215048,"Cyrl"),["7180"]:new pc(7180,20808,"Latn"),["7178"]:new pc(7178,4215112,"Latn"),["7177"]:new pc(7177,4215112,"Latn"),
["7169"]:new pc(7169,4493640,"Arab"),["12289"]:new pc(12289,4493640,"Arab"),["6203"]:new pc(6203,4215080,"Latn"),["15372"]:new pc(15372,4215112,"Latn"),["15370"]:new pc(15370,4215112,"Latn"),["15369"]:new pc(15369,4215112,"Latn"),["15361"]:new pc(15361,4493640,"Arab"),["6170"]:new pc(6170,4215304,"Latn"),["6156"]:new pc(6156,4215112,"Latn"),["18442"]:new pc(18442,4215112,"Latn"),["6153"]:new pc(6153,4215112,"Latn"),["6145"]:new pc(6145,4493640,"Arab"),["4155"]:new pc(4155,4215080,"Latn"),["11274"]:new pc(11274,
4215112,"Latn"),["5179"]:new pc(5179,4215112,"Latn"),["14348"]:new pc(14348,4215112,"Latn"),["14346"]:new pc(14346,4215112,"Latn"),["14345"]:new pc(14345,20808,"Latn"),["14337"]:new pc(14337,4493640,"Arab"),["5146"]:new pc(5146,4215048,"Latn"),["5132"]:new pc(5132,4215112,"Latn"),["5130"]:new pc(5130,4215112,"Latn"),["5129"]:new pc(5129,4215112,"Latn"),["5127"]:new pc(5127,4215112,"Latn"),["5124"]:new pc(5124,4281672,"Hant"),["5121"]:new pc(5121,4493640,"Arab"),["31770"]:new pc(31770,4210820,""),
["31748"]:new pc(31748,4277380,""),["10266"]:new pc(10266,4215048,"Cyrl"),["10252"]:new pc(10252,4215112,"Latn"),["10250"]:new pc(10250,4215112,"Latn"),["10249"]:new pc(10249,4215112,"Latn"),["13324"]:new pc(13324,4215112,"Latn"),["13322"]:new pc(13322,4215112,"Latn"),["13321"]:new pc(13321,4215112,"Latn"),["10241"]:new pc(10241,4493640,"Arab"),["13313"]:new pc(13313,4493640,"Arab"),["4122"]:new pc(4122,4215048,"Latn"),["4108"]:new pc(4108,4215112,"Latn"),["4106"]:new pc(4106,4215112,"Latn"),["4105"]:new pc(4105,
4215112,"Latn"),["4103"]:new pc(4103,4215112,"Latn"),["4100"]:new pc(4100,4282696,"Hans"),["3179"]:new pc(3179,4215048,"Latn"),["4097"]:new pc(4097,4493640,"Arab"),["1085"]:new pc(1085,299432,"Hebr"),["1144"]:new pc(1144,4280616,"Yiii"),["21514"]:new pc(21514,4215112,"Latn"),["2145"]:new pc(2145,5132616,"Deva"),["3131"]:new pc(3131,4215112,"Latn"),["2143"]:new pc(2143,4215432,"Latn"),["12314"]:new pc(12314,4215048,"Cyrl"),["1070"]:new pc(1070,4215080,"Latn"),["1130"]:new pc(1130,4215080,"Latn"),["12300"]:new pc(12300,
4215112,"Latn"),["1091"]:new pc(1091,4215080,"Latn"),["12298"]:new pc(12298,4215112,"Latn"),["12297"]:new pc(12297,4215112,"Latn"),["2055"]:new pc(2055,4215112,"Latn"),["2052"]:new pc(2052,4282664,"Hans"),["2115"]:new pc(2115,4215368,"Cyrl"),["9242"]:new pc(9242,4215304,"Latn"),["3098"]:new pc(3098,4215048,"Cyrl"),["2107"]:new pc(2107,4215112,"Latn"),["9228"]:new pc(9228,4215112,"Latn"),["3084"]:new pc(3084,4215112,"Latn"),["9226"]:new pc(9226,4215112,"Latn"),["3082"]:new pc(3082,4215080,"Latn"),
["3081"]:new pc(3081,4215112,"Latn"),["2094"]:new pc(2094,4215080,"Latn"),["3079"]:new pc(3079,4215112,"Latn"),["2092"]:new pc(2092,4215368,"Cyrl"),["1064"]:new pc(1064,4215080,"Cyrl"),["3076"]:new pc(3076,4281640,"Hant"),["2155"]:new pc(2155,4215048,"Latn"),["3073"]:new pc(3073,4493640,"Arab"),["1153"]:new pc(1153,4215080,"Latn"),["1119"]:new pc(1119,299400,"Arab"),["1086"]:new pc(1086,4215080,"Latn"),["2144"]:new pc(2144,938632,"Deva"),["2077"]:new pc(2077,4215112,"Latn"),["1053"]:new pc(1053,4215080,
"Latn"),["2141"]:new pc(2141,4215336,"Latn"),["2074"]:new pc(2074,4215304,"Latn"),["2073"]:new pc(2073,20808,"Cyrl"),["2072"]:new pc(2072,4215112,"Latn"),["2137"]:new pc(2137,4493896,"Arab"),["2070"]:new pc(2070,4215048,"Latn"),["2068"]:new pc(2068,4215048,"Latn"),["2067"]:new pc(2067,4215112,"Latn"),["1073"]:new pc(1073,4215080,"Latn"),["2064"]:new pc(2064,4215112,"Latn"),["2129"]:new pc(2129,414016,"Tibt"),["2128"]:new pc(2128,4608584,"Mong"),["2060"]:new pc(2060,4215112,"Latn"),["1132"]:new pc(1132,
4215080,"Latn"),["1097"]:new pc(1097,5132584,"Taml"),["2057"]:new pc(2057,4215080,"Latn"),["1164"]:new pc(1164,4493608,"Arab"),["106"]:new pc(106,4210820,""),["2118"]:new pc(2118,4493640,"Arab"),["2117"]:new pc(2117,5132584,"Beng"),["2049"]:new pc(2049,4493640,"Arab"),["1156"]:new pc(1156,4215080,"Latn"),["2110"]:new pc(2110,4215112,"Latn"),["1054"]:new pc(1054,4608296,"Thai"),["2108"]:new pc(2108,4215048,"Latn"),["1083"]:new pc(1083,4215080,"Latn"),["136"]:new pc(136,4210820,""),["1114"]:new pc(1114,
4493608,"Syrc"),["1148"]:new pc(1148,4215080,"Latn"),["1145"]:new pc(1145,20776,"Latn"),["11290"]:new pc(11290,4215304,"Latn"),["1075"]:new pc(1075,20776,"Latn"),["1106"]:new pc(1106,4215080,"Latn"),["1140"]:new pc(1140,4215080,"Latn"),["120"]:new pc(120,4276356,""),["1136"]:new pc(1136,4215080,"Latn"),["1066"]:new pc(1066,4215080,"Latn"),["1098"]:new pc(1098,5132584,"Telu"),["1169"]:new pc(1169,4215048,"Latn"),["11276"]:new pc(11276,4215112,"Latn"),["61"]:new pc(61,295044,"Hebr"),["1060"]:new pc(1060,
4215080,"Latn"),["11273"]:new pc(11273,4215112,"Latn"),["1058"]:new pc(1058,4215080,"Cyrl"),["128"]:new pc(128,4489348,""),["1160"]:new pc(1160,4215080,"Latn"),["1159"]:new pc(1159,4215080,"Latn"),["1158"]:new pc(1158,20776,"Latn"),["1157"]:new pc(1157,4215080,"Cyrl"),["11265"]:new pc(11265,4493640,"Arab"),["1155"]:new pc(1155,4215080,"Latn"),["1154"]:new pc(1154,4215080,"Latn"),["1117"]:new pc(1117,4215080,"Cans"),["1152"]:new pc(1152,4493608,"Arab"),["1115"]:new pc(1115,5132584,"Sinh"),["1150"]:new pc(1150,
4215080,"Latn"),["1113"]:new pc(1113,938280,"Deva"),["1112"]:new pc(1112,938280,"Beng"),["51"]:new pc(51,16516,""),["1146"]:new pc(1146,4215080,"Latn"),["1109"]:new pc(1109,5132584,"Mymr"),["115"]:new pc(115,4210820,""),["1143"]:new pc(1143,4215080,"Latn"),["1142"]:new pc(1142,20872,"Latn"),["1141"]:new pc(1141,4215080,"Latn"),["1104"]:new pc(1104,4215080,"Cyrl"),["2058"]:new pc(2058,4215112,"Latn"),["1102"]:new pc(1102,5132584,"Deva"),["1137"]:new pc(1137,20776,"Latn"),["1100"]:new pc(1100,5132584,
"Mlym"),["1135"]:new pc(1135,4215080,"Latn"),["1134"]:new pc(1134,4215080,"Latn"),["1133"]:new pc(1133,4215080,"Cyrl"),["1096"]:new pc(1096,5132584,"Orya"),["1131"]:new pc(1131,4215048,"Latn"),["1094"]:new pc(1094,5132584,"Guru"),["1129"]:new pc(1129,20872,"Latn"),["1128"]:new pc(1128,4215080,"Latn"),["1127"]:new pc(1127,20776,"Latn"),["1126"]:new pc(1126,20776,"Latn"),["1125"]:new pc(1125,4493608,"Thaa"),["1124"]:new pc(1124,4215080,"Latn"),["1123"]:new pc(1123,4493608,"Arab"),["1122"]:new pc(1122,
4215080,"Latn"),["1121"]:new pc(1121,5132584,"Deva"),["1120"]:new pc(1120,299400,"Arab"),["1118"]:new pc(1118,4215080,"Ethi"),["1082"]:new pc(1082,4215080,"Latn"),["1116"]:new pc(1116,4215080,"Cher"),["1080"]:new pc(1080,4215080,"Latn"),["1079"]:new pc(1079,4215080,"Geor"),["1078"]:new pc(1078,4215080,"Latn"),["1077"]:new pc(1077,4215080,"Latn"),["1111"]:new pc(1111,5132584,"Deva"),["1110"]:new pc(1110,4215080,"Latn"),["1074"]:new pc(1074,4215080,"Latn"),["1108"]:new pc(1108,4608296,"Laoo"),["1107"]:new pc(1107,
4608296,"Khmr"),["1071"]:new pc(1071,4215080,"Cyrl"),["1105"]:new pc(1105,4608296,"Tibt"),["1069"]:new pc(1069,4215080,"Latn"),["1103"]:new pc(1103,5132584,"Deva"),["1067"]:new pc(1067,4215080,"Armn"),["1101"]:new pc(1101,5132584,"Beng"),["1065"]:new pc(1065,4493608,"Arab"),["1099"]:new pc(1099,5132584,"Knda"),["1063"]:new pc(1063,4215080,"Latn"),["1062"]:new pc(1062,4215080,"Latn"),["1061"]:new pc(1061,4215080,"Latn"),["1095"]:new pc(1095,5132584,"Gujr"),["1059"]:new pc(1059,4215080,"Cyrl"),["1093"]:new pc(1093,
5132584,"Beng"),["1092"]:new pc(1092,4215080,"Cyrl"),["1056"]:new pc(1056,4493608,"Arab"),["1090"]:new pc(1090,4215080,"Latn"),["1089"]:new pc(1089,4215080,"Latn"),["1088"]:new pc(1088,4215080,"Cyrl"),["1087"]:new pc(1087,4215080,"Cyrl"),["1052"]:new pc(1052,4215080,"Latn"),["1051"]:new pc(1051,4215080,"Latn"),["1050"]:new pc(1050,4215048,"Latn"),["1049"]:new pc(1049,4215080,"Cyrl"),["1048"]:new pc(1048,4215080,"Latn"),["1081"]:new pc(1081,5132584,"Deva"),["1046"]:new pc(1046,4215048,"Latn"),["1045"]:new pc(1045,
4215080,"Latn"),["1044"]:new pc(1044,4215048,"Latn"),["1043"]:new pc(1043,4215080,"Latn"),["1076"]:new pc(1076,4215080,"Latn"),["1041"]:new pc(1041,4280616,"Jpan"),["1040"]:new pc(1040,4215080,"Latn"),["119"]:new pc(119,4210820,""),["1072"]:new pc(1072,4215176,"Latn"),["1037"]:new pc(1037,4493608,"Hebr"),["1036"]:new pc(1036,4215080,"Latn"),["1035"]:new pc(1035,4215080,"Latn"),["1068"]:new pc(1068,4215080,"Latn"),["1033"]:new pc(1033,4215048,"Latn"),["1032"]:new pc(1032,4215080,"Grek"),["1031"]:new pc(1031,
4215080,"Latn"),["1030"]:new pc(1030,4215080,"Latn"),["1029"]:new pc(1029,4215080,"Latn"),["1028"]:new pc(1028,4281672,"Hant"),["1027"]:new pc(1027,4215080,"Latn"),["1026"]:new pc(1026,4215080,"Cyrl"),["140"]:new pc(140,4489348,""),["1057"]:new pc(1057,4215080,"Latn"),["50"]:new pc(50,4210820,""),["1055"]:new pc(1055,4215080,"Latn"),["135"]:new pc(135,4210820,""),["134"]:new pc(134,16516,""),["133"]:new pc(133,4210820,""),["132"]:new pc(132,4210820,""),["131"]:new pc(131,4210820,""),["130"]:new pc(130,
4210820,""),["129"]:new pc(129,4210820,""),["1047"]:new pc(1047,4215080,"Latn"),["126"]:new pc(126,4210820,""),["89"]:new pc(89,5128324,""),["124"]:new pc(124,4210820,""),["1042"]:new pc(1042,4280616,"Hang"),["122"]:new pc(122,4210820,""),["121"]:new pc(121,16516,""),["1039"]:new pc(1039,4215080,"Latn"),["1038"]:new pc(1038,4215080,"Latn"),["118"]:new pc(118,16516,""),["117"]:new pc(117,4210820,""),["116"]:new pc(116,4210820,""),["1034"]:new pc(1034,4219176,"Latn"),["114"]:new pc(114,4210820,""),
["113"]:new pc(113,16516,""),["112"]:new pc(112,4210820,""),["111"]:new pc(111,4210820,""),["110"]:new pc(110,4210820,""),["109"]:new pc(109,4210820,""),["108"]:new pc(108,4210820,""),["107"]:new pc(107,4210820,""),["1025"]:new pc(1025,4493608,"Arab"),["105"]:new pc(105,16516,""),["104"]:new pc(104,4210820,""),["103"]:new pc(103,4210820,""),["102"]:new pc(102,16516,""),["101"]:new pc(101,4489348,""),["100"]:new pc(100,4210820,""),["99"]:new pc(99,4489348,""),["98"]:new pc(98,4210820,""),["97"]:new pc(97,
5128324,""),["96"]:new pc(96,966788,""),["95"]:new pc(95,4505732,""),["94"]:new pc(94,4210820,""),["93"]:new pc(93,4210820,""),["92"]:new pc(92,4210820,""),["91"]:new pc(91,5128324,""),["90"]:new pc(90,4489348,""),["85"]:new pc(85,5128324,""),["88"]:new pc(88,934020,""),["87"]:new pc(87,5128324,""),["86"]:new pc(86,4210820,""),["9275"]:new pc(9275,4215112,"Latn"),["84"]:new pc(84,4604036,""),["83"]:new pc(83,4604036,""),["82"]:new pc(82,4210820,""),["81"]:new pc(81,4604036,""),["80"]:new pc(80,4604036,
""),["79"]:new pc(79,5128324,""),["78"]:new pc(78,5128324,""),["77"]:new pc(77,5128324,""),["76"]:new pc(76,5128324,""),["75"]:new pc(75,5128324,""),["74"]:new pc(74,5128324,""),["73"]:new pc(73,5128324,""),["72"]:new pc(72,4210820,""),["71"]:new pc(71,4210820,""),["70"]:new pc(70,5128324,""),["69"]:new pc(69,5128324,""),["68"]:new pc(68,4210820,""),["67"]:new pc(67,4210820,""),["66"]:new pc(66,4210820,""),["65"]:new pc(65,4210820,""),["64"]:new pc(64,4210820,""),["63"]:new pc(63,4210820,""),["62"]:new pc(62,
4210820,""),["18441"]:new pc(18441,4215112,"Latn"),["59"]:new pc(59,4210820,""),["58"]:new pc(58,4210820,""),["57"]:new pc(57,5128324,""),["56"]:new pc(56,4210820,""),["55"]:new pc(55,4210820,""),["54"]:new pc(54,4210820,""),["53"]:new pc(53,4210820,""),["52"]:new pc(52,4210820,""),["31"]:new pc(31,4210820,""),["47"]:new pc(47,4210820,""),["49"]:new pc(49,4210820,""),["48"]:new pc(48,4210820,""),["44"]:new pc(44,4210820,""),["46"]:new pc(46,4210820,""),["45"]:new pc(45,4210820,""),["41"]:new pc(41,
4489348,""),["43"]:new pc(43,4210820,""),["42"]:new pc(42,4210820,""),["38"]:new pc(38,4210820,""),["40"]:new pc(40,4210820,""),["39"]:new pc(39,4210820,""),["35"]:new pc(35,4210820,""),["37"]:new pc(37,4210820,""),["36"]:new pc(36,4210820,""),["9225"]:new pc(9225,4215112,"Latn"),["34"]:new pc(34,4210820,""),["33"]:new pc(33,4210820,""),["32"]:new pc(32,4489348,""),["29"]:new pc(29,4210820,""),["30"]:new pc(30,4604036,""),["27"]:new pc(27,4210820,""),["28"]:new pc(28,4210820,""),["9217"]:new pc(9217,
4493640,"Arab"),["26"]:new pc(26,4210820,""),["25"]:new pc(25,4210820,""),["24"]:new pc(24,4210820,""),["23"]:new pc(23,4210820,""),["22"]:new pc(22,4210820,""),["21"]:new pc(21,4210820,""),["20"]:new pc(20,4210820,""),["19"]:new pc(19,4210820,"Latn"),["18"]:new pc(18,4276356,""),["17"]:new pc(17,4276356,""),["16"]:new pc(16,4210820,""),["15"]:new pc(15,4210820,""),["14"]:new pc(14,4210820,""),["13"]:new pc(13,4489348,""),["12"]:new pc(12,4210820,""),["11"]:new pc(11,4210820,""),["10"]:new pc(10,
4210820,""),["9"]:new pc(9,4210820,""),["8"]:new pc(8,4210820,""),["7"]:new pc(7,4210820,""),["6"]:new pc(6,4210820,""),["5"]:new pc(5,4210820,""),["4"]:new pc(4,4278404,""),["3"]:new pc(3,4210820,""),["2"]:new pc(2,4210820,""),["1"]:new pc(1,4489348,""),["0"]:new pc(0,1,"")}}static le(a){pc.aGe||pc.$Pc();return pc.aGe[a.toString()]}}pc.aGe=null;pc.CFh=262144;pc.DFh=65536;Object(e.a)(pc,"ExtendedCultureInfo",null,[]);class Uj{AX(a,b){var c=a.sa(bb.a.Gs,1033);sa.a.le(c)&&(c=pc.le(c))&&(c.s3b?a.setValue(ub.a.eastAsianFont,
b):c.Q7d&&a.setValue(ub.a.complexScriptFont,b));a.setValue(ub.a.latinFont,b)}static Ppi(a,b,c){b.baselineFieldSpecified&&(0>b.baselineField?a.ke(bb.a.subscript,!0):0<b.baselineField?a.ke(bb.a.superscript,!0):(a.ke(bb.a.subscript,!1),a.ke(bb.a.superscript,!1)));b.bFieldSpecified&&a.ke(bb.a.bold,b.bField);b.noProofFieldSpecified&&a.ke(Bb.a.noProof,b.noProofField);b.iFieldSpecified&&a.ke(bb.a.italic,b.iField);b.strikeFieldSpecified&&a.ke(bb.a.strikethrough,b.strikeField);b.uFieldSpecified&&a.ke(bb.a.underline,
b.uField);if(b.langField){var f=sa.a.le(b.langField);f?a.ke(bb.a.Gs,f.LCID):ya.a.J(8958996,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.langField)}b.altLangField&&((f=sa.a.le(b.altLangField))?a.ke(ub.a.gAc,f.LCID):ya.a.J(8958998,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.altLangField));b.hlinkClickField&&(a.ke(bb.a.Fs,!0),a.ke(bb.a.yZ,!0));Uj.Spi(a,b,c)}static vQf(a){a>Bk.a.L4c?a=Bk.a.L4c:a<Bk.a.b5c&&(a=
Bk.a.b5c);return Uj.SJi(a)}static Spi(a,b,c){b.szFieldSpecified&&a.ke(bb.a.fontSize,Uj.vQf(b.szField));(c=Cf.Box4ColorHelper.SEb(b,c))&&a.setValue(bb.a.fontColor,c.zC);b.latinField&&a.ke(ub.a.latinFont,b.latinField.typefaceField);b.eaField&&a.ke(ub.a.eastAsianFont,b.eaField.typefaceField);b.csField&&a.ke(ub.a.complexScriptFont,b.csField.typefaceField);b.capFieldSpecified&&a.ke(kh.a.capitalization,b.capField);b.symField&&a.ke(ub.a.WHb,b.symField.typefaceField)}static SJi(a){return a/(Bk.a.dfc*Bk.a.w7a)}static WHf(a){return a*
Bk.a.w7a}}Object(e.a)(Uj,"FormattingHelper",null,[648]);class No{VZi(a,b,c){let f="";const l=a.sa(Bb.a.HZ,[]);l&&0<=b&&b<l.length&&(a=a.Ch)&&(b=a.re(l[b]))&&b.Sa(ub.a.schemeColor)&&(b=b.getValue(ub.a.schemeColor),(b=Re.SchemeColor.parse(b))?b.Bra?f=Ol.i(b.fP):b.JCe(c)&&(f=Ol.i(b.fP)):ya.a.J(38606471,826,50,"schemeClr is null."));return f}WZi(a,b){let c="";(a=a.tgd)||ya.a.J(38088800,826,50,"This shapeNode don't have shapeFont");a&&!a.schemeClrField&&ya.a.J(38088802,826,50,"The shapeFont don't have schemeClrField.");
a&&a.schemeClrField&&(14===a.schemeClrField.valField?ya.a.J(38549282,826,50,"The color of shapeFont is W"):13===a.schemeClrField.valField?ya.a.J(38549312,826,50,"The color of shapeFont is B"):ya.a.J(38549314,826,50,"The color of shapeFont is unexpected color"),b=Cf.Box4ColorHelper.REb(a,b),b=Ol.g(b.rXa),c=Ol.i(b),"000000"===c?ya.a.J(38549316,826,50,"The resolved color of shapeFont is B"):"FFFFFF"===c?ya.a.J(38549318,826,50,"The resolved color of shapeFont is W"):ya.a.J(38549320,826,50,"The resolved color of shapeFont is unexpected color"));
return c}}Object(e.a)(No,"NonTableThemeColorHelper",null,[1239]);class Dk{constructor(){this.charsetField=0;this.panoseField=null;this.pitchFamilyField=0;this.typefaceField=null}}Object(e.a)(Dk,"CT_TextFont",null,[]);class tm{constructor(){this.vPa=this.mXa=null}}Object(e.a)(tm,"ThemeFont",null,[]);class Je{static isThemeFont(a){return Je.VWk.hasOwnProperty(a)}static C3i(a){let b="",c,f;({q5a:c,rgb:f}=Je.u3i(a)).returnValue&&(0===c?0===f?b="+Heading":1===f?b="+Heading Asian":2===f&&(b="+Heading CS"):
1===c&&(0===f?b="+Body":1===f?b="+Body Asian":2===f&&(b="+Body CS")));return b}static Yei(a,b,c){const f=[];if(!c||!c.FontScheme)return f;var l=Je.GZ,x=Je.GZ,F=Je.GZ;({lzg:l,pYf:x,uTf:F}=Je.LCh(l,x,F,a));({lzg:l,pYf:x,uTf:F}=Je.LCh(l,x,F,b));a=c.FontScheme;l!==Je.GZ?(Je.QDb(a,0,l,Je.z4c,f),Je.QDb(a,1,l,Je.h5c,f)):(l=Je.O6a(a,0,0),b=Je.O6a(a,1,0),Je.Va(l)||Je.Va(b)||(f.push(Object.assign(new tm,{mXa:l,vPa:Je.z4c})),f.push(Object.assign(new tm,{mXa:b,vPa:Je.h5c}))));x!==Je.GZ?(Je.QDb(a,0,x,Je.y4c,f),
Je.QDb(a,1,x,Je.g5c,f)):(x=Je.O6a(a,0,1),l=Je.O6a(a,1,1),Je.Va(x)||Je.Va(l)||(f.push(Object.assign(new tm,{mXa:x,vPa:Je.y4c})),f.push(Object.assign(new tm,{mXa:l,vPa:Je.g5c}))));F!==Je.GZ?(Je.QDb(a,0,F,Je.x4c,f),Je.QDb(a,1,F,Je.f5c,f)):(F=Je.O6a(a,0,2),x=Je.O6a(a,1,2),Je.Va(F)||Je.Va(x)||(f.push(Object.assign(new tm,{mXa:F,vPa:Je.x4c})),f.push(Object.assign(new tm,{mXa:x,vPa:Je.f5c}))));return f}static Va(a){return!a||!a.length}static QDb(a,b,c,f,l){a&&c!==Je.GZ&&(c=Je.mgj(a,b,c),Je.Va(c)&&(c=Je.O6a(a,
b,0),Je.Va(c)&&(c="Arial")),l.push(Object.assign(new tm,{mXa:c,vPa:f})))}static O6a(a,b,c){let f="";switch(b){case 0:a.majorFontField&&(f=Je.gfg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=Je.gfg(a.minorFontField,c))}return f}static gfg(a,b){let c="";if(a)switch(b){case 0:a.latinField&&(c=a.latinField.typefaceField);break;case 1:a.eaField&&(c=a.eaField.typefaceField);break;case 2:a.csField&&(c=a.csField.typefaceField)}return c}static mgj(a,b,c){if(!a||c===Je.GZ)return"";let f="";if(1066===
c)f="Viet";else if(1152===c)f="Uigh";else if(c=pc.le(c))f=c.jYk;return Je.ngj(a,b,f)}static ngj(a,b,c){let f="";if(a&&c)switch(b){case 0:a.majorFontField&&(f=Je.ffg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=Je.ffg(a.minorFontField,c))}return f}static ffg(a,b){let c="";if(a&&a.fontField&&b){a=a.fontField;for(let f=0;f<a.length;f++){const l=a[f];if(l.scriptField&&l.scriptField.toLowerCase()===b.toLowerCase()){l.typefaceField&&(c=l.typefaceField);break}}}return c}static LCh(a,b,c,f){if(f!==
Je.GZ){const l=pc.le(f);l&&(l.s3b?b===Je.GZ&&(b=f):l.Q7d?c===Je.GZ&&(c=f):a===Je.GZ&&(a=f))}return{lzg:a,pYf:b,uTf:c}}static u3i(a){switch(a){case Je.x4c:return{returnValue:!0,q5a:0,rgb:2};case Je.y4c:return{returnValue:!0,q5a:0,rgb:1};case Je.z4c:return{returnValue:!0,q5a:0,rgb:0};case Je.f5c:return{returnValue:!0,q5a:1,rgb:2};case Je.g5c:return{returnValue:!0,q5a:1,rgb:1};case Je.h5c:return{returnValue:!0,q5a:1,rgb:0}}return{returnValue:!1,q5a:2,rgb:0}}static Bpb(a,b){let c=null;if(0===a)switch(b){case 2:c=
Je.x4c;break;case 1:c=Je.y4c;break;case 0:c=Je.z4c}else if(1===a)switch(b){case 2:c=Je.f5c;break;case 1:c=Je.g5c;break;case 0:c=Je.h5c}null===c&&(ya.a.J(8959518,820,10,"TextFontHelper::CreateTextFont - Invalid text font encountered"),c="");return Object.assign(new Dk,{typefaceField:c,charsetField:1})}}Je.x4c="+mj-cs";Je.y4c="+mj-ea";Je.z4c="+mj-lt";Je.f5c="+mn-cs";Je.g5c="+mn-ea";Je.h5c="+mn-lt";Je.GZ=0;Je.VWk={["+mj-cs"]:"",["+mj-ea"]:"",["+mj-lt"]:"",["+mn-cs"]:"",["+mn-ea"]:"",["+mn-lt"]:""};Object(e.a)(Je,
"TextFontHelper",null,[]);class Ti{constructor(a,b,c){this.ta=a;this.rc=b;this.r6j=c}YTk(a,b){let c="";var f=a.sa(bb.a.Gs,Je.GZ),l=a.sa(ub.a.gAc,Je.GZ),x=pc.le(f===Je.GZ?1033:f);if(x){let F="";a.Sa(ub.a.WHb)?F=a.getValue(ub.a.WHb):x.Q7d&&a.Sa(ub.a.complexScriptFont)?F=a.getValue(ub.a.complexScriptFont):x.s3b&&a.Sa(ub.a.eastAsianFont)?F=a.getValue(ub.a.eastAsianFont):a.Sa(ub.a.latinFont)&&(F=a.getValue(ub.a.latinFont));if(Je.isThemeFont(F)){x=!1;let R=null;if(this.r6j){if(b=Object(va.a)(122,this.rc.Sg(b)))R=
b.Se}else{if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");R=this.ta.Ba.Se}if(R&&(f=Je.Yei(f,l,R)))for(l=0;l<f.length;l++)if(F===f[l].vPa){c=f[l].mXa;x=!0;break}x||(c=Je.C3i(F))}else c=F}c&&a.ke(bb.a.font,c)}}Object(e.a)(Ti,"FontResolver",null,[1238]);class Im{constructor(a){this.Q0j=a}wui(a,b,c){a(bb.a.Gs);a(ub.a.latinFont);a(ub.a.eastAsianFont);a(ub.a.complexScriptFont);a(ub.a.WHb);a(ub.a.gAc);a(ub.a.Se);a(ub.a.Hob);a(ub.a.Nvb);a(ub.a.xM);a(ub.a.schemeColor);a(ub.a.ARc);a(ub.a.zQd);
a(ub.a.wQd);a(ub.a.tQd);a(ub.a.DQd);a(ub.a.e2b);this.Q0j.YTk(b(),c)}}Object(e.a)(Im,"PptFormattingCacheCopyPropertyStrategy",null,[1285]);class xo{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatting"}Wb(a){this.K=a;a.register(1238,"Box4.IFontResolver").ma().na(()=>new Ti(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTableFontWithinMultipleThemesFix));a.register(648,
"PowerPointWebEditor.IFormattingHelper").ma().na(()=>new Uj);a.register(Im,"PowerPointWebEditor.PptFormattingCacheCopyPropertyStrategy").as("Box4.IFormattingCacheCopyPropertyStrategy").ma().na(()=>new Im(a.resolve("Box4.IFontResolver")));a.register(1239,"PowerPointWebEditor.INonTableThemeColorHelper").ma().na(()=>new No)}init(){this.K.resolve("PowerPointWebEditor.IFormattingHelper");this.K.resolve("PowerPointWebEditor.INonTableThemeColorHelper")}dispose(){}static main(){m.a.instance.Ac(new xo)}}Object(e.a)(xo,
"PPTWebEditorTextFormattingPackage",null,[2,3]);class fo{constructor(a){this.Wc=a;this.uIh=H.a.instance.ga(115)}Sug(a){return this.xtg(a)?!0:this.uIh?1074135161===a.Oe||1074135162===a.Oe:!1}wtg(a){return this.xtg(a)||131162===a.Oe||4325465===a.Oe||1179729===a.Oe}xtg(a){return 131140===a.Oe||this.Wc.Zf&&131120===a.Oe}FXf(a){return xa.a.any(a.cJ,(b,c)=>!this.wtg(c)&&!this.Sug(c))}}Object(e.a)(fo,"UndoRevisionValidator",null,[1360]);class yn{constructor(){this.Xc=hb.a.instance.pb("Box4.IFeatureHelper")}MGb(){return u.AFrameworkApplication.fa.ka("AllowMultiUserUndo")}iYa(){return this.MGb()&&
u.AFrameworkApplication.fa.ka("AllowSmartUndoMerge")}}Object(e.a)(yn,"UndoSettingsManager",null,[1359]);var um=d(335),Hf=d(991),go=d(197);class ue{Sa(a){return a.Sa(void 0)}hcg(a,b){return a.sa(b,null)}OMc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Hf.a(a)}kcg(a,b){return a.sa(b,"")}Hlh(a,b,c){a.setValue(b,c)}}Object(e.a)(ue,"MergeableObjectUtilities",null,[1118]);class sl{constructor(a,b,c,f,l){this.Qb=a;this.ta=b;this.Ea=c;this.ra=f;this.$Z=l}v6c(a,b,c){if(a)if("PowerPointGroupShapes"===
b&&c)for(a=a.cJ,b=[],c=0;c<a.length;++c){var f=a[c];if(f&&393227===f.Oe&&f.Sa(ub.a.q7)){f=(new ue).OMc(f,ub.a.q7);for(var l=0;l<f.length;l++){var x=this.ta.Ba;if(!x)throw Error.argumentNull("ActiveSlide is null");const F=this.$Z.Eba(f.ga(l));x=x.JB(F.get_shapeId());b.push(x)}this.Rrj(b)}}else if("PowerPointUngroupShapes"===b&&!c)for(a=a.cJ,b=0;b<a.length;++b)if((c=a[b])&&393227===c.Oe&&c.Sa(ub.a.dna))for(c=(new ue).OMc(c,ub.a.dna),f=0;f<c.length;f++){l=this.ta.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");
x=this.$Z.Eba(c.ga(f));l=l.JB(x.get_shapeId());this.Qrj(l)}}ePc(a){if(a){const b=a.Ag(this.Qb.Ma);b.via();b.uFb=!0;this.ra.R6(a)}else ya.a.J(595359873,815,10,"GroupUngroupUndoRedoActionController::HideAndDeselectShape Trying to Hide and Deselect Null shape.")}Rrj(a){if(a.length){var b=this.Ea.Pr(a[0]);this.ePc(b);for(const c of a)this.ePc(c)}}Qrj(a){this.ePc(a);if(a.Mf){a=this.Ea.py(a);for(const b of a)this.ePc(b)}}}Object(e.a)(sl,"GroupUngroupUndoRedoActionController",null,[1226]);class jp{lXg(){}v6c(){}MWg(){}mWg(){}bUc(){return!1}}
Object(e.a)(jp,"NoOpTablePartialEditController",null,[1227]);class ho{constructor(a,b,c,f,l,x){this.Dab=null;this.ni=a;this.Ea=b;this.Qac=c;this.Yb=f;this.ra=l;this.NIg=x}lXg(){this.oae()&&this.qNe()}v6c(a){a&&this.oae()&&(a=this.Dab,this.qNe(),this.Nsh(a))}MWg(a,b,c,f){this.oae()&&!this.kKj(a,b,c,f)&&this.qNe()}mWg(a,b,c){if(a&&b&&c){this.Dab=null;a=this.ra.ae();c=new Me.a;b=b.cJ;for(let l=0;l<b.length;++l){var f=b[l];393230===f.Oe&&f.Sa(ub.a.cellId)&&(f=this.Ea.kn(f),Array.contains(a,f)&&c.$(f.get_shapeId(),
f))}0<c.count&&this.Nsh(c.values.ga(0))}}kKj(a,b,c,f){let l=!1;b&&this.bUc(a)&&(f=b.wS&&f,l=(c||f)&&b.actionId===a,this.NIg||(l=(b.actionId===a||this.bUc(b.actionId))&&1===this.Qac.Msb(b.U4)||l));return l}bUc(a){let b=a===C.a.Oza||a===C.a.sOa||a===C.a.typing;this.NIg||(b=a===C.a.SA||a===C.a.enter||b);return b}Nsh(a){this.Dab=a}qNe(){if(this.Dab){const a=this.Yb.zi.ri.Dw.id;0!==this.Qac.Msb(a)&&this.Qac.Xwh(a,!1);this.ni.O3a(this.Dab,!0)}this.Dab=null}oae(){return!!this.Dab}}Object(e.a)(ho,"TablePartialEditController",
null,[1227]);var Jm=d(896);class tl{constructor(a,b,c,f){this.hv=a;this.S9j=c;this.ia=f;this.ub()}ub(){this.ia.pa(ba.a.Pdb,fc.a.application,Object(D.a)(this,this.Pdb,"queryIsShapeTextEditHappened"),96)}Pdb(a,b,c,f,l){l.asa=this.asa(l.Jlc,l.rRj);return 32}cjj(a,b,c){this.S9j.uml(new Jm.a(a,b,c))}asa(a,b){let c=!1;a&&(c=!this.hv.zSc()&&a.BDa!==b,this.hv.zSc()||a.BDa!==b||ya.a.J(512493777,820,15,"{0}ViewElement::EndEditing - IsEditingHappened: false. Find localUndoStack is not empty but lastContentSavedTimeBeforeEnterTextEditing not changed",
Object(Fa.a)(4,a)?"Shape":"Notes"));return c}}Object(e.a)(tl,"PPTUndoActionBehavior",null,[1358]);class yo extends Sys.EventArgs{constructor(a){super();this.actionId=a}}Object(e.a)(yo,"OnUndoEventArgs",Sys.EventArgs,[]);var z=d(708),U=d(133);class la extends z.a{constructor(a=null,b=null,c=null){super(a,b);this.$wd=c||new ue}HDb(){super.HDb();const a=new Hf.a,b=new oa.a;b.add(Ga.a.nil);this.Oeb.forEach((l,x)=>{b.add(x);a.add(x);return!0});for(this.objects.forEach(l=>{b.add(l);a.add(l);return!0});0<
a.length;){var c=a.ga(0);a.JQd(0);var f=this.objects.ga(c)||this.ZY.jsb(c);if(f){c=f;f=c.Bz();for(let l=0;l<f.length;l++){const x=f[l],F=U.a.v0b(U.a.h5f(x));8===F?this.hBf(this.$wd.hcg(c,x),a,b):9===F&&this.$wd.OMc(c,x).forEach(R=>{this.hBf(R,a,b);return!0})}}else Ja.a.instance.shipAssertTag(17409040,2,!1,"Failed to find [revisedObjectId: {0}]",c)}}hBf(a,b,c){c.contains(a)||(c.add(a),this.Yug(a)&&(c=this.ZY.jsb(a),this.Ete(c),b.add(a)))}}Object(e.a)(la,"ReferenceFollowingRevisionDiffer",z.a,[]);class Da{Ozi(a,
b){return new la(a,b)}}Object(e.a)(Da,"UndoDifferFactory",null,[1350]);var Ia=d(281),Db=d(577);class Ob{constructor(a,b,c,f,l,x,F){a||Ia.a.argument("revisionStore cannot be null","revisionStore");b||Ia.a.argument("undoRevisionValidator cannot be null","undoRevisionValidator");c||Ia.a.argument("undoSettingsManager cannot be null","undoSettingsManager");f||Ia.a.argument("undoDifferFactory cannot be null","undoDifferFactory");l||Ia.a.argument("revisedObjectSpace cannot be null","revisedObjectSpace");
x||Ia.a.argument("undoRevisionMergeStrategy cannot be null","undoRevisionMergeStrategy");this.KTh=a;this.ayc=b;this.qaa=c;this.nXh=f;this.qQb=l;this.rXh=x;this.U5e=F}WEc(a,b){const c=this.nXh.Ozi(a,b);c.HDb();const f=new Db.a;f.kNe(this.qQb,a);c.Oeb.forEach((F,R)=>{f.hwa(R,F);return!0});const l=new Hf.a,x=a.FS<b.FS;c.objects.forEach((F,R)=>{if(this.ayc.Sug(R))return!0;if(x&&!this.ayc.wtg(R)&&!b.zZ(F)&&!a.zZ(F))return l.add(F),!0;f.mpa(R);return!0});0<l.length&&Z.ULS.sendTraceTag(22607311,365,100,
"Skipping Objects because they're not referenced in base {0} or revised {1}: {2}",a.id,b.id,l.jr());this.U5e&&this.U5e.Iul(f);return f.fJc()}Pzi(a,b,c,f){b=this.WEc(a,b);if(!b)return null;if(a.id===c.id)return Z.ULS.sendTraceTag(22607312,365,this.qaa.iYa()?15:50,"Undo merge attempted with base and current were the same revision. [AllowSmartUndoMerge: {0}]",this.qaa.iYa()),b;a=this.WEc(a,c);if(!a)return null;var l=b;this.ayc.FXf(a)?(Z.ULS.sendTraceTag(22607313,365,100,"Merge determined to be necessary for undo."),
l=new Hf.a,l.add(a),a=new Hf.a,a.add(b),l=this.rXh.vck(f,a,l,c.Add).WN.last()):Z.ULS.sendTraceTag(22607314,365,this.qaa.iYa()?15:50,"Undo merge determined to be not needed because base and current are equivalent. [AllowSmartUndoMerge: {0}]",this.qaa.iYa());return this.WEc(c,l)}Qzi(a,b,c,f,l){let x=null;f||(this.qaa.iYa()||!this.qaa.MGb()?x=this.WEc(c,b):(Z.ULS.sendTraceTag(22607315,365,10,"Trying to skip merge when multi user undo is enabled and smart merge is disabled."),f=!0));f&&(x=this.Pzi(a,
b,c,l));return x&&this.Bhl(x)?x:null}Bhl(a){return this.ayc.FXf(a)?(this.KTh.Cgb(a),!0):!1}}Object(e.a)(Ob,"UndoRevisionManager",null,[1284]);var sc=d(156);class hc{constructor(a){this.kdf=null;this.Pa=new qd.a;this.kib=null;this.qmb=[];this.sXh=a}dispose(){for(;0<this.qmb.length;)this.Ach(this.qmb[0])}get UJ(){return this.kib}set UJ(a){this.kib&&(this.kib.isActive=!1);if(this.kib=a)this.kib.isActive=!0}register(a){if(!this.lsa(a)){const b=this.sXh.tBi(a);b.Kmh(c=>{this.Pa.raiseEvent(hc.spk,new yo(c))});
a.addListener(this);Array.add(this.qmb,b)}}unregister(a){if(a=this.Osb(a))a===this.UJ&&(this.UJ=null),this.Ach(a)}setActive(a){this.UJ=this.Osb(a)}bDc(){const a=this.Osb(void 0);a&&(a.rma(void 0),this.vte())}get AV(){return this.aI?this.UJ.AV:!1}get ZPd(){return this.aI?this.UJ.ZPd:null}get uia(){return this.aI?this.UJ.uia:!1}get dDa(){return this.aI?this.UJ.dDa():!1}cNe(a,b){this.aI&&this.UJ.cNe(a,b)}Pv(){this.aI&&this.UJ.Pv()}tV(){return this.aI?this.UJ.tV():null}undo(){return this.aI?this.UJ.undo():
!1}redo(){return this.aI?this.UJ.redo():!1}BVa(a,b,c=!1){this.aI&&this.UJ.BVa(a,b,c)&&(this.vte(),this.kdf&&this.kdf())}ywe(){this.aI&&this.UJ.ywe()}Ach(a){a.graphSpace.removeListener(this);a.Kmh(null);a.dispose();Array.remove(this.qmb,a)}lsa(a){return!!this.Osb(a)}get aI(){return!!this.UJ}Osb(a){for(let b=0;b<this.qmb.length;b++){const c=this.qmb[b];if(c.jCj(a))return c}return null}vte(){Gb.App.Fb.updateCommandUI()}f7c(a){this.unregister(a)}onBeforeLoadContent(a){const b=this.Osb(a);if(b)b.onBeforeLoadContent(a)}onAfterLoadContent(a){const b=
this.Osb(a);if(b)b.onAfterLoadContent(a);this.UJ===b&&(this.UJ.AV||this.UJ.uia)&&this.vte()}onAfterFirstSaveContent(){}}hc.spk="OnUndo";Object(e.a)(hc,"UndoManager",null,[1356,391,106,1357]);class Fc extends hc{constructor(a,b,c){super(a);this.i_j=b;this.j4c=c;this.i_j.N2h(Object(D.a)(this,this.Hjk,"onFailoverSucceeded"));this.j4c.hGd(Object(D.a)(this,this.Okk,"onInitialSelectionSet"))}get yva(){return this.UJ}rEj(a){return this.aI?this.yva.asg(a):!1}XLd(){this.aI&&this.yva.nmi()}bYd(a){return this.aI?
this.yva.bYd(a):null}fLc(a){return this.aI?this.yva.fLc(a):0}qOe(){this.aI&&this.yva.qOe()}get AV(){return this.aI?this.yva.Jqj:!1}rma(){this.aI&&this.yva.rma(!0)}Hjk(a,b){b.yMj&&this.rma()}Okk(){this.BVa(C.a.jRa,null)}tSe(a){this.aI&&this.yva.tSe(a)}zSc(){return this.aI?this.yva.zSc():!1}n8a(){return this.aI?this.yva.n8a():!1}}Object(e.a)(Fc,"PPTUndoManager",hc,[1355,1356,391,106,1357]);class Xc{vck(a,b,c,f){return a?a.V4c(b,c,null,f,1,!1,5):null}}Object(e.a)(Xc,"PPTUndoRevisionMergeStrategy",null,
[1354]);var md=d(137),Nc=d(46);class bf{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc){this.$ke=!1;this.Rde=a;this.NA=b;this.dPg=c;this.VUa=f;this.MFa=l;this.qbb=x;this.Sac=F;R===Nc.a.pC&&(R=Nc.a.Gp);this.vGg=R;this.ra=fa;this.Sb=wa;this.s1j=Xa;this.Yb=lb;this.Fa=Lb;this.ia=kc;this.b9b=lc;this.zac=Ec;this.Qb=Jc}MUk(){this.azh();if(this.NA){var a=this.Sb.$k(this.NA);a&&this.s1j.Ba!==a&&(this.Yb.Ba=a)}if(this.b9b){if(this.VUa&&0<this.VUa.length){a=[];for(const b of this.VUa){let c=this.Sb.$k(b);
c&&a.push(c)}if(0<a.length){let b;(b=this.ra).DX.apply(b,a)}}this.ia.processAction(ba.a.Yeb,2)}}IT(a=!1,b=null){this.MUk();if(this.$ke||this.Uqg())return this.$ke=!1,null;b||(b=this.lob());this.setSelection(a,b);return b}lob(){let a=null;if(0<this.qbb.length){const b=this.Sb.$k(this.NA);if(b){const c=[];for(const f of this.qbb){if(!f)continue;const l=b.oS(f);if(l){const x=l.Ag(this.Qb.Ma);x&&!x.uFb&&c.push(nd.SelectionFactory.Xk(l))}}0<c.length&&(a=new md.SelectionCollection(c,c.length-1))}}a||(a=
this.Rde.lob(!0));!a&&this.Sac&&(a=this.Sac.O5f());return a}setSelection(a=!1,b=null){this.Rde.setSelection(a,b);b&&this.Sac&&ya.a.J(22546640,816,50,"Selection restore to IP level");b||this.vGg!==Nc.a.yg?this.Fa.Bf(this.vGg):(this.ra.Ph(),this.Fa.Ad())}wBc(){return this.Rde.wBc()}azh(){this.NA=this.JRe(this.NA,this.dPg);const a=[];let b=0;for(const c of this.VUa)a.push(this.JRe(c,this.MFa[b++]));this.VUa=a}JRe(a,b){let c=a;a&&oe.a.xz(a)&&(a=this.Sb.r0b(b),a||(b=this.zac.Hcj(b),null!=b&&(a=this.Sb.aCa(b))),
a&&(c=a.Bb));return c}Zql(){this.NA=this.JRe(this.NA,this.dPg);this.b9b&&this.azh();if(this.qbb.length&&Array.contains(this.qbb,0)){Array.clear(this.qbb);var a=this.lob();if(this.ra.BZ(a))for(let b of a)(a=Object(va.a)(4,b.Ua.node))&&this.qbb.push(a.get_shapeId())}}gwl(){this.$ke=this.Uqg()}Uqg(){const a=this.Sb.$k(this.NA);if(!a)return!1;var b=this.Sac?[this.Sac.wNd]:this.qbb;for(const c of b)if((b=a.oS(c))&&b.Kp)return!0;return!1}}Object(e.a)(bf,"PPTUndoSelectionReference",null,[541,1353]);class pe{constructor(a,
b,c,f,l){this.yc=a;this.Ree=b;this.fXc=c;this.Oac=f;this.Nac=l}O5f(){var a=this.yc.$k(this.Ree);if(!a)return null;a=a.oS(this.fXc);if(!a)return null;a=a.j1d();if(!a)return null;var b=a.sa(bb.a.Qwa,0);const c=a.sa(bb.a.Oea,0);if(!this.Oac||!this.Nac||this.Oac.QIa>=b||this.Oac.OIa>=c||this.Nac.QIa>=b||this.Nac.OIa>=c)return null;b=mb.GraphIterator.mb(a.ef(this.Oac.QIa,this.Oac.OIa));b.mc(14);a=mb.GraphIterator.mb(a.ef(this.Nac.QIa,this.Nac.OIa));a.mc(14);return nd.SelectionFactory.CWb(b,a)}get wNd(){return this.fXc}}
Object(e.a)(pe,"PPTUndoTableCellSelectionPos",null,[1377]);class wf{constructor(a,b,c,f,l,x,F,R){this.Mb=a;this.yc=b;this.RW=c;this.d_j=f;this.Ree=l;this.fXc=x;this.w3c=F;this.r9j=R}O5f(){var a=this.yc.$k(this.Ksi);if(!a)return null;let b=null;if(10===this.containerType||16===this.containerType)if(b=a.oS(this.wNd),!b)return null;var c=[];switch(this.containerType){case 10:c=this.IWd(b);break;case 16:a=this.Mb.Kc(b);if(!a.Ji()||!a.Ji())return null;if(0>this.QIa||0>this.OIa||this.QIa>=a.currentNode.sa(bb.a.Qwa,
0)||this.OIa>=a.currentNode.sa(bb.a.Oea,0)){this.RW.LTg(a,0,0);c.push(nd.SelectionFactory.nj(a.currentNode,!0));break}this.RW.LTg(a,this.QIa,this.OIa);c=this.IWd(a.currentNode);break;case 60:c=a.dQa();if(!c)return null;c=this.IWd(c);break;default:return null}return 0<c.length?new md.SelectionCollection(c,0):null}get wNd(){return this.fXc}IWd(a){const b=[];for(const c of this.bll){const f=c.sWi(a);f&&b.push(f)}b.length||b.push(nd.SelectionFactory.nj(a,!0));return b}get containerType(){return this.d_j}get Ksi(){return this.Ree}get OIa(){return this.w3c?
this.w3c.OIa:-1}get QIa(){return this.w3c?this.w3c.QIa:-1}get bll(){return this.r9j}}Object(e.a)(wf,"PPTUndoTextSelectionPos",null,[1377]);class rf{constructor(a,b){this.$8j=a;this.h9j=b}get OIa(){return this.$8j}get QIa(){return this.h9j}}Object(e.a)(rf,"TableCellIndex",null,[]);class fi{constructor(a,b,c,f,l,x){this.Mb=a;this.Vh=b;this.K5j=c;this.g_j=f;this.d2j=l;this.c2j=x}get contextId(){return this.g_j}get paragraphIndex(){return this.K5j}get $2b(){return this.d2j}get Z2b(){return this.c2j}sWi(a){a=
this.Mb.Kc(a);if(!a.j2d(this.paragraphIndex)||11!==a.hq.type||!a.zb(2)||12!==a.hq.type&&21!==a.hq.type||this.$2b>this.Z2b||-1>this.$2b||this.Z2b>this.Vh.textLength(a.currentNode))return null;switch(this.contextId){case Fb.a.Lf:return nd.SelectionFactory.P1(a.currentNode,this.$2b,this.Z2b);case Fb.a.textRange:return nd.SelectionFactory.P1(a.currentNode,this.$2b,this.Z2b);case Fb.a.endOfParagraph:return nd.SelectionFactory.Uaa(a.currentNode);case Fb.a.paragraph:return nd.SelectionFactory.eu(Pc.a.VNa(this.$2b,
this.Z2b,!1,a.currentNode))}return null}}Object(e.a)(fi,"TextContextRecord",null,[]);class Fh{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){this.DZj=a;this.ra=b;this.SGg=c;this.Yb=f;this.Mb=l;this.Fa=x;this.yc=F;this.Ea=R;this.Vh=fa;this.RW=wa;this.ia=Xa;this.b9b=lb;this.zac=Lb;this.Qb=kc}dqa(){const a=this.DZj.dqa();let b=null,c=Ga.a.nil;const f=this.SGg.Ba;f&&(b=f.Bb,c=f.id);const l=[],x=[];if(this.b9b){var F=this.ra.mf();for(var R of F)l.push(R.Bb),x.push(R.id)}F=[];R=null;f&&(this.ra.uG()&&this.aJk(F),
this.ra.lD()&&(R=this.fJk(b)));return new bf(a,b,c,l,x,F,R,this.Fa.Xaa,this.ra,this.yc,this.SGg,this.Yb,this.Fa,this.ia,this.b9b,this.zac,this.Qb)}JSc(a){return 10===a.type||60===a.type||16===a.type}aJk(a){const b=this.ra.ae();for(const c of b)a.push(c.get_shapeId())}fJk(a){return this.ra.Oa.kb.gg?this.dJk(a):this.eJk(this.ra.Oa,a)}eJk(a,b){var c=Object(va.a)(5,a.kb.Ua.node),f=this.Mb.Kc(c);if(f.l5(Object(D.a)(this,this.JSc,"isOEContainerNode")))if(f.uc()&&11===f.currentNode.type){if(f.uc()){c=(c=
this.Ea.Cba(c))?c.get_shapeId():0;const l=f.hq.type;f=16===l?this.n1d(Object(va.a)(125,f.hq)):null;const x=a.kb,F=[];this.MEf(x,F);for(let R of a)R!==x&&this.d$h(R,x)&&this.MEf(R,F);return new wf(this.Mb,this.yc,this.RW,l,b,c,f,F)}}else ya.a.J(22345955,816,15,"Find text selection but its container is not OutlineElement");return null}dJk(a){var b=this.ra.Oa.ga(0),c=this.ra.Oa.last,f=b.gg;b=16===f.Ua.node.type?this.n1d(Object(va.a)(125,f.Ua.node)):null;f=c.gg;c=16===f.Te.node.type?this.n1d(Object(va.a)(125,
f.Te.node)):null;f=(f=this.Ea.Cba(f.Ua.node))?f.get_shapeId():0;return new pe(this.yc,a,f,b,c)}n1d(a){return a?new rf(a.li,a.rowIndex):null}MEf(a,b){for(let c of a){if(!Object(Fa.a)(101,c.node))continue;a=this.Mb.Kc(c.node);if(!a.l5(Object(D.a)(this,this.JSc,"isOEContainerNode")))continue;a.uc();const f=a.currentNode;a.uc();a=a.KPa(f);b.push(new fi(this.Mb,this.Vh,a,c.contextId,c.Qa,c.Kb))}}d$h(a,b){a=this.Mb.Kc(a.Ua.node);b=this.Mb.Kc(b.Ua.node);return a.l5(Object(D.a)(this,this.JSc,"isOEContainerNode"))&&
b.l5(Object(D.a)(this,this.JSc,"isOEContainerNode"))&&a.uc()&&11===a.currentNode.type&&b.uc()&&11===b.currentNode.type&&a.uc()&&b.uc()?a.currentNode===b.currentNode:!1}}Object(e.a)(Fh,"PPTUndoSelectionReferenceFactory",null,[509]);class Qf{constructor(){this.GTa=this.qOg=this.Toe=this.CQg=null;this.d_c=!1;this.Gqe=null}GRe(){if(!this.GTa.qub&&this.GTa.y5b)for(const a of this.GTa.y5b)if(a.equals(this.CQg)){this.Toe.IT(!1,this.qOg);ya.a.J(22684815,813,50,"Undo/Redo Success, and E2E time is: {0}ms",
+new Date-+this.Gqe);this.GTa.Phc(Object(D.a)(this,this.GRe,"trySetSelectionWhenServerUndoRedoFinish"));this.d_c=!0;break}}eMk(a,b,c,f){a&&(this.CQg=b,this.qOg=f,(this.Toe=Object(va.a)(1353,c))?(this.dSe(),this.Gqe=new Date,this.GTa=a,this.GTa.Dzc(Object(D.a)(this,this.GRe,"trySetSelectionWhenServerUndoRedoFinish")),this.d_c=!1):ya.a.J(21051018,816,15,"The selectionreference is not the type of PPTUndoSelectionReference"))}dSe(){this.GTa&&!this.d_c&&(ya.a.J(22684818,813,50,"Undo/Redo Fail, and E2E time is: {0}ms",
+new Date-+this.Gqe),this.GTa.Phc(Object(D.a)(this,this.GRe,"trySetSelectionWhenServerUndoRedoFinish")),this.d_c=!0)}}Object(e.a)(Qf,"PPTUndoSelectionRestoreExecutor",null,[1225]);class Mh{constructor(){this.Q8j=new Me.a(!1);this.U9j=new Me.a(!1);this.MKg=new Me.a(!1);this.init()}init(){this.Tvj()}Tvj(){this.MKg.add(ba.a.JM,!0)}$ui(a){return a&&this.Q8j.Jb(a)?!0:!1}Zui(a){return a&&this.U9j.Jb(a)?!1:!0}D9k(a){return a&&this.MKg.Jb(a)?!0:!1}}Object(e.a)(Mh,"PPTUndoSettings",null,[1352]);class kj{constructor(a){this.Bj=
null;this.rXe=a}start(a){this.Bj=a}uqj(){var a=new Date;return this.rXe?+a-+this.Bj>this.rXe:!1}}Object(e.a)(kj,"UndoTimer",null,[1378]);var r=d(471),X=d(511);class ra{constructor(a){this.M$=this.n1=null;this.vqb=this.clc=a}get clc(){return this.n1}set clc(a){this.n1&&(this.n1.aO&=-2);this.n1=a;this.n1.aO|=1}get vqb(){return this.M$}set vqb(a){this.M$&&(this.M$.aO&=-3);this.M$=a;this.M$.aO|=2}get U4(){return this.n1?this.n1.id:Ga.a.nil}get VSd(){return this.M$?this.M$.id:Ga.a.nil}get cJ(){return this.n1?
this.n1.Nzg():[]}combineWithPrevious(){}dispose(){this.n1&&(this.n1.aO&=-2);this.M$&&(this.M$.aO&=-3)}}Object(e.a)(ra,"Box4UndoRecordData",null,[1394,106]);class Qa{constructor(a,b,c,f,l,x){this.awa=a;this.cfb=b;this.oXh=c;this.actionId=f;this.wS=l;this.GHa=x}get u0(){return this.oXh}get U4(){return this.u0.U4}dispose(){this.u0&&this.u0.dispose()}}Object(e.a)(Qa,"UndoRecord",null,[106]);class db{constructor(){this.Zoa=[]}ga(a){return this.Zoa[a]}get length(){return this.Zoa.length}add(a){this.Zoa.push(a)}clear(){for(let a=
0;a<this.Zoa.length;a++)this.Zoa[a].dispose();Array.clear(this.Zoa)}remove(a){const b=Array.remove(this.Zoa,a);b&&a.dispose();return b}removeAt(a){0<=a&&a<this.Zoa.length&&(this.Zoa[a].dispose(),Array.removeAt(this.Zoa,a))}}Object(e.a)(db,"UndoRecordsArray",null,[]);class Hb{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue){this.M1a=!0;this.h0a=this.S3e=this.Qsc=this.Hlb=!1;this.Ejb=null;this.Txd=this.Qef=0;this.yEd=null;this.Muf=!0;this.isActive=!1;this.ez=a;this.npd=b;this.lPh=
c;this.ssd=f;this.nYh=l;this.wRh=x;this.jk=F;this.lH=R;this.Hrf=fa;this.hUh=wa;this.Rd=Xa;this.gXh=lb;this.qUh=Lb;this.mqf=kc;this.pXh=Ec;this.Nxf=Jc;this.tXh=Dc;this.Pxf=Wd;this.qaa=xe;this.fy=Pe;this.Hg=new db;this.Nr=this.kh=-1;this.n5e=Object(D.a)(this,this.XRf,"createInitialUndoRecord");this.gwc=lc;this.gwc.f5h(Object(D.a)(this,this.zch,"removeUndoRecordForRevision"));this.Muf=Ue}dispose(){this.n5e=null;this.bDc();this.ez=null;this.gwc.rQk(Object(D.a)(this,this.zch,"removeUndoRecordForRevision"))}get graphSpace(){return this.ez}get Qfc(){return this.lPh.value}jCj(a){return this.ez===
a?!0:!1}bDc(){this.Hg.clear();this.Nr=this.kh=-1;this.M1a=!0}Lmi(){if(this.kh===this.Hg.length-1)this.bDc();else{let a=0;for(;a<this.kh;)this.Hg.removeAt(0),a++;this.kh=0;this.Nr=1}}get AV(){return 0<this.kh}get ZPd(){return this.AV?this.Hg.ga(this.kh).actionId:null}get $Pd(){return 0<=this.kh&&this.kh<this.Hg.length?this.Hg.ga(this.kh).u0:null}cNe(a,b){this.h0a?(this.Plc(),this.rma()):(this.mqf&&this.Qfc.suspend(),this.h0a=!0,this.Ejb=a,this.Qef=b,this.Txd=0)}Plc(){this.h0a=!1;this.mqf&&this.Qfc.resume()}Crl(){this.qUh(new Ga.a(this.Ejb,
1));this.Plc()}BVa(a,b,c=!1){if(!this.npd()||a===C.a.jRa&&this.Hg.length)return!1;var f=this.ez.pS();if(!f&&a!==C.a.jRa&&!c||!this.ez||!this.ez.ri)return!1;f&&(this.S3e||(Z.ULS.sendTraceTag(39102051,305,50,"Real Edit occurred"),this.S3e=!0),this.ssd.execute(x=>{x.ySd()}));if(this.h0a){Z.ULS.sendTraceTag(23171273,365,50,"Incremental action {0} interrupted by user edits. Cancelling action.",this.Ejb);this.Plc();for(c=this.Hg.length-2;0<=c;c--)this.Hg.removeAt(c);this.kh=0;this.Nr=-1}c=this.tV();f=this.lFc(f,
a);this.Ypb();b=this.Uoi(a,f,b);const l=this.qaa.MGb()&&!this.qaa.iYa();a=new Qa(b,c,f,a,this.Hlb,l);this.Hg.add(a);this.kh=this.Hg.length-1;return!0}lFc(a,b){return this.pXh(a,b)}Uoi(a,b,c){if(0<=this.kh){switch(a){case C.a.Oza:case C.a.sOa:case C.a.typing:this.M1a&&this.Hg.ga(this.kh).actionId===a?(a=this.Hg.ga(this.kh),c=a.awa,b.combineWithPrevious(a.u0),this.Hg.removeAt(this.kh)):u.AFrameworkApplication.fa.ka("OtelSendTypingUserActionDisabled")||(b=this.gXh.create(a),b.end(32),this.nYh.shc(b),
this.wRh.rhc(b))}this.M1a=!0}return c}ywe(){this.tXh(this)}gGi(){this.Muf&&!this.M1a||!this.qaa.MGb()||(this.M1a=!1,this.Hlb=!0)}Pak(){if(this.qaa.iYa())for(let a=0;a<this.Hg.length;a++)this.Hg.ga(a).GHa=!0}Ypb(){if(this.kh<this.Hg.length-1){for(let a=this.Hg.length-1;a>this.kh;a--)this.Hg.removeAt(a);this.Nr=-1}}Mvl(){var a=sc.ObjectSpace.h7(this.ez.ri);a=new ra(a);const b=this.tV(),c=this.Hg.ga(this.kh).awa;a=new Qa(c,b,a,C.a.hld,this.Hg.ga(this.kh).wS,this.Hg.ga(this.kh).GHa);this.Hg.removeAt(this.Hg.length-
1);this.Hg.add(a)}Hdb(a,b,c,f){return a.Hdb(b,c,f)}Vxe(a,b,c){this.Qsc=!0;a.Lbe();this.Qsc=!1;b.IT(void 0,c)}undo(){if(!this.AV)return!1;this.ssd.execute(wa=>{wa.ySd()});var a=!0;let b=!1;var c=!1;const f=this.jk.je(7);f.fd(this.ez);let l=0,x=!1,F=this.tV(),R=null;const fa=this.Nxf(!0);for(this.Pxf.start(new Date);this.AV&&a;){const wa=this.Hg.ga(this.kh),Xa=this.Hg.ga(this.kh-1);a=wa.wS&&Xa.wS;Z.ULS.sendTraceTag(22607296,365,50,"Performing Undo [IsContinuation: {0}], [AppMode: {1}]",a,X.a[this.fy]);
this.Nr=this.kh;try{if(b=this.Hdb(fa,wa.u0,Xa.u0,wa.GHa||Xa.GHa))F=this.Hg.ga(this.kh).awa,R=this.Hg.ga(this.Nr).cfb,this.yEd&&this.yEd(this.Hg.ga(this.kh).actionId)}catch(lb){Z.ULS.sendTraceTag(22607297,365,10,"Undo hit an exception: {0}. Callstack: {1}",lb.message,lb.stack),b=!1,c=!0}l++;b?this.kh--:(Z.ULS.sendTraceTag(22607298,365,15,"Undo failed. [HitException: {0}] [AppMode: {1}]",c,X.a[this.fy]),this.Lmi(),a=!1);if(this.Pxf.uqj()){x=!0;break}}b&&this.Vxe(fa,F,null,R,!0);f.dispose();this.Pv();
this.h0a&&(this.Crl(),this.Ypb());this.lH.updateCommandUI();this.Hrf.T9();if(0<this.kh&&x&&this.Hg.ga(this.kh).wS){a=this.kh;for(c=0;0<a&&this.Hg.ga(a).wS;)c++,a--;this.Hg.ga(this.kh).wS=!1;Z.ULS.sendTraceTag(22607299,365,50,"Cascading undos exceed the time limit, [MergesDone: {0}], [MergesToBeDone: {1}].",l,c)}else 1<l&&Z.ULS.sendTraceTag(22607300,365,50,"Cascading undos within the time limit, [MergesDone: {0}]",l);return b}Pv(){this.Hlb=this.M1a=!1}get uia(){return 0<this.Nr}redo(){if(!this.uia)return!1;
this.ssd.execute(F=>{F.ySd()});var a=!0;let b=!1,c=!1;const f=this.jk.je(7);f.fd(this.ez);let l=this.tV();const x=this.Nxf(!1);for(;this.uia&&a;){a=this.Hg.ga(this.Nr);const F=this.Hg.ga(this.kh);Z.ULS.sendTraceTag(22607301,365,50,"Performing Redo [IsContinuation: {0}] [AppMode: {1}]",this.Hg.ga(this.Nr).wS&&this.Hg.ga(this.kh).wS,X.a[this.fy]);try{if(b=this.Hdb(x,a.u0,F.u0,a.GHa||F.GHa))l=this.Hg.ga(this.Nr).cfb}catch(R){Z.ULS.sendTraceTag(22607302,365,10,"Redo hit an exception: {0}. Callstack: {1}",
R.message,R.stack),b=!1,c=!0}b?(this.kh=this.Nr,this.Nr<this.Hg.length-1?(this.Nr++,a=this.Hg.ga(this.Nr).wS&&this.Hg.ga(this.kh).wS):(this.Nr=-1,a=!1)):(Z.ULS.sendTraceTag(22607303,365,15,"Redo failed. [HitException: {0}] [AppMode: {1}]",c,X.a[this.fy]),this.rma(),a=!1)}b&&this.Vxe(x,l,null,null,!1);f.dispose();this.Pv();this.lH.updateCommandUI();this.Hrf.T9();return b}tV(){return this.npd()?this.hUh.dqa():null}mBk(a){return this.h0a&&lh.a.compare(a.lq,this.Ejb)?(Z.ULS.sendTraceTag(512362002,365,
50,"Incremental Action in progress"),this.Mvl(),this.Txd=a.n,this.Txd===this.Qef&&(Z.ULS.sendTraceTag(23171274,365,100,"Incremental Action {0} was completed successfully",this.Ejb),this.Plc()),!0):!1}onBeforeLoadContent(){}onAfterLoadContent(a){if(!this.Qsc&&!this.mBk(a.ri.Dw.id))if(this.h0a&&(Z.ULS.sendTraceTag(23171276,365,50,"Incremental action {0} terminated due to inbound revision with ID {1}",this.Ejb,this.ez.ri.Dw.id),this.Plc()),!this.qaa.MGb())this.rma();else if(this.uia||this.AV)this.gGi(),
this.Pak()}rma(a=!1){this.bDc();a?this.XRf(null):(a=new He.a(2,1,0,this.n5e,50),this.Rd.Gb(a))}zch(a,b){if(b&&(1===(b.aO&1)||2===(b.aO&2))){a=this.uia;const f=this.AV;for(var c=this.Hg.length-1;0<=c;c--){const l=Object(va.a)(ra,this.Hg.ga(c).u0);!l||l.clc!==b&&l.vqb!==b||(this.Hg.removeAt(c),-1!==this.kh&&this.kh--,-1!==this.Nr&&this.Nr--)}b=this.uia;c=this.AV;!this.isActive||a===b&&f===c||(Z.ULS.sendTraceTag(36218332,365,15,"UndoRedo status is changed by revision removal:{0},{1},{2},{3}.",a,b,f,
c),this.lH.updateCommandUI())}}XRf(){this.npd()&&this.BVa(C.a.jRa,this.tV())}dDa(){return this.Qsc}Kmh(a){this.yEd=a}}Object(e.a)(Hb,"UndoStack",null,[1396,106]);var Vb=d(777);class vb extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(e.a)(vb,"RevisionStateArgs",Sys.EventArgs,[]);class zb{constructor(a,b,c,f,l,x){this.awa=a;this.cfb=b;this.U4=c;this.actionId=f;this.wS=l;this.GHa=x}}Object(e.a)(zb,"PPTLocalUndoRecord",null,[]);class ic extends Hb{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,
lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf,mh,Fg,ii,Li,wj,cj,dj){super(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,Bg,cj,4,dj);this.s_c=!1;this.x$b=-1;this.aL=[];this.kT=xe;this.Hne=Sd;this.Fne=Pe;this.Mb=Ue;this.la=Ef;this.Ska=dg;this.Fa=Mg;this.FTa=Lf;this.FTa.WCf(Object(D.a)(this,this.qCb,"onRevisionProcessed"));this.Jbb=mh;this.ra=Fg;this.Fqe=ii;this.FJg=Li;this.DQg=wj;this.fLg=Bg.MGb()&&!Bg.iYa()}BVa(a,b,c=!1){let f=!1;b=this.DQg.dwl(b);var l=this.kh;this.Hne.D9k(a)?f=this.bbk(a,
b):this.Hne.Zui(a)?(f=this.bii(a,b,c))&&this.jpl(a):this.rma();b=null;f?(l=this.kh-l,b=this.O0b(this.kh),this.LIk(b,!l),this.n8a()||this.uTd()):this.DQg.gAj();l=null;this.la.designerSendActionDuration&&b&&b.u0&&b.u0.VSd!==Ga.a.nil&&(l=b.u0.VSd);this.Fne.cjj(a,f,l);return f}lFc(a,b){const c=0<=this.kh?this.Hg.ga(this.kh):null;this.Jbb.MWg(b,c,this.M1a,this.Hlb);b=super.lFc(a,b);this.Jbb.mWg(c,b,a);return b}asg(a){let b=!1,c=null;a&&this.AV?c=this.Hg.ga(this.kh):!a&&this.uia&&(c=this.Hg.ga(this.Nr));
c&&(b=this.pSc(c.U4));return b&&this.n8a()}Hdb(a,b,c,f){let l=!1;if(this.asg(a.T8a))(l=super.Hdb(a,b,c,f))&&this.Wak(a.ija);else{const x=a.T8a?2:3;l=a.M7g(F=>{this.kT.UBh(F,x)});this.Kak(a.ija);this.FTa.Ebd(new vb(0))}return l}onBeforeLoadContent(a){super.onBeforeLoadContent(a);this.s_c&&this.FTa.Ebd(new vb(2))}onAfterLoadContent(a){super.onAfterLoadContent(a);this.s_c&&(this.FTa.Ebd(new vb(3)),this.s_c=!1)}dispose(){this.FTa.pdh(Object(D.a)(this,this.qCb,"onRevisionProcessed"));super.dispose()}Vxe(a,
b,c,f,l){a&&a.ija!=Ga.a.nil&&(this.FJg&&(f&&this.dCh(f),b&&this.dCh(b)),0<this.aL.length&&(f=new zb(this.tV(),b,a.ija,l?ba.a.Ddb:ba.a.Cdb,!1,this.fLg),Array.add(this.aL,f)),a.Lbe(),b&&0<this.aL.length?b.IT(void 0,c):(Mc.a.Cb&&(Mc.a.dea(Mc.a.Cb),Mc.a.Cb.dB(ri.a.uX,Mc.a.D6a(a.ija.toString()).toString())),this.FJg&&(f=Object(va.a)(138,this.ez.contentReplicator))&&b&&this.Fqe.eMk(f,a.ija,b,c)))}qCb(a,b){b&&(!(a=b.P9)||2!==a.RevisionSource&&3!==a.RevisionSource||(this.s_c=!0,this.la.fsg||(b=2===a.RevisionSource?
Object(va.a)(1353,this.Hg.ga(0<this.Nr?this.Nr:this.Hg.length-1).awa):Object(va.a)(1353,this.Hg.ga(this.kh).cfb))&&b.gwl(),this.zLi(a.ServerUndoStackLength,a.ServerRedoStackLength,a.LastServerUndoFail,a.LastServerRedoFail),this.FTa.Ebd(new vb(1))))}zLi(a,b,c,f){a!==this.kh&&ya.a.J(512362001,823,50,"Undo stack length not synced. Server length: {0}, client: {1}",a,this.kh);if(a<this.kh||f){do this.Hg.removeAt(this.kh--);while(this.kh>a);this.Nr=0<this.Nr?this.kh+1:-1;this.Fqe.dSe()}if(!(0>this.Nr)&&
(b!==this.Hg.length-this.Nr&&ya.a.J(512362E3,823,50,"Redo stack length not synced. Server length: {0}, client: {1}",b,this.Hg.length-this.Nr),b<this.Hg.length-this.Nr||c)){do this.Hg.removeAt(this.Nr);while(this.Hg.length-this.Nr>b);if(!b||this.Nr>=this.Hg.length)this.Nr=-1;this.Fqe.dSe()}}dCh(a){(a=Object(va.a)(1353,a))&&a.Zql()}nmi(){if(this.la.Kub&&this.aL.length){var a=this.O0b(this.kh);if(a){var b=a.awa;if(this.pSc(a.U4)){for(let c=this.kh-1;0<c;c--){const f=this.O0b(c);if(!f)break;if(this.pSc(f.U4))b=
f.awa,this.Hg.removeAt(c),this.kh--;else break}this.Ypb()}else this.Hg.add(a),this.kh++,this.Nr=-1;a.awa=b;a.wS=!1;this.fdd();this.uTd()}else this.Ypb(),this.fdd()}}qOe(){if(this.la.Kub){var a=this.O0b(this.kh);if(a){if(0<(-1===this.x$b?0:this.Hg.length-this.x$b)){for(var b=this.Hg.length-1;b>=this.x$b;b--)this.Hg.removeAt(b);for(b=0;0<=b&&b<this.aL.length;){var c=b;let f=!0;for(;f&&b<this.aL.length;)b<this.aL.length-1?(f=this.aL[b].wS&&this.aL[b+1].wS,b++):(f=!1,b=-1);c=this.aL[c];this.Hg.add(new Qa(c.awa,
this.aL[0>b?this.aL.length-1:b-1].cfb,a.u0,c.actionId,!1,c.GHa))}this.kh=this.Hg.length-1}this.Nr=-1;this.fdd();this.uTd()}else this.Ypb(),this.fdd()}}get Jqj(){if(this.la.Kub&&this.n8a()){const a=this.O0b(this.kh);if(!a||0<this.aL.length&&!this.pSc(a.U4))return!1}return this.AV}uTd(){var a=this.la.Ubk;if(this.kh>a){var b=0;for(a=this.kh-a-1;0<=a;a--)this.Hg.removeAt(a),b++;this.kh-=b;b=this.Nr-b;this.Nr=0<b?b:-1}}bii(a,b,c){const f=0<=this.kh?this.Hg.ga(this.kh):null;this.Hlb=!!f&&this.Jbb.bUc(a)&&
f.actionId===a&&this.Hlb;return super.BVa(a,b,c)}LIk(a,b){this.la.Kub&&a&&(this.n8a()||this.Hne.$ui(a.actionId))&&(this.aL.length||(this.x$b=this.kh),b&&Array.removeAt(this.aL,this.aL.length-1),Array.add(this.aL,new zb(a.awa,a.cfb,a.U4,a.actionId,a.wS,a.GHa)))}O0b(a){return 0<a&&a<=this.kh?this.Hg.ga(a):null}bYd(a){a=a?this.kh:this.Nr;return 0<=a&&a<this.Hg.length?this.Hg.ga(a).u0:null}fLc(a){a=a?this.kh:this.Nr;return 0<=a&&a<this.Hg.length?this.Hg.ga(a).actionId:0}fdd(){Array.clear(this.aL);this.x$b=
-1}n8a(){const a=this.Fa.ye;return a?a.name!==Nc.a.yg&&a.name!==Nc.a.Oua&&a.name!==Nc.a.WT&&a.name!==Nc.a.PIa&&a.name!==Nc.a.dO||!this.ra.lD()||this.uDj()?!1:!0:!1}Cgb(a){sc.ObjectSpace.l2(this.graphSpace.ri,!1).Cgb(a)}jpl(a){this.la.Kub||this.ipl(a);this.hpl(a)}ipl(a){if(1<=this.kh&&this.Pxg(a)){const b=this.kh-1,c=this.Hg.ga(b),f=c.actionId;f!==a&&!this.Pxg(f)||1!==this.Ska.Msb(c.U4)||(this.Hg.removeAt(b),this.kh=this.Hg.length-1)}}hpl(a){if(1<=this.kh&&this.ZBj(a)){const b=this.kh-1,c=this.Hg.ga(b).actionId;
if(c===a||this.CEj(c))this.Hg.removeAt(b),this.kh=this.Hg.length-1}}Pxg(a){return a===C.a.SA||a===C.a.Oza||a===C.a.sOa||a===C.a.typing||a===C.a.enter}CEj(a){return a===ba.a.Hza||a===ba.a.x9c}ZBj(a){return a===ba.a.pnb||a===ba.a.y9c||a===ba.a.xec}bbk(a,b){const c=this.lFc(this.ez.pS(),a);this.Ypb();a=new Qa(b,null,c,a,!1,this.fLg);this.Hg.add(a);this.kh=this.Hg.length-1;return!0}Wak(a){let b=null;this.ra.Wia()?b=this.ra.Ucg():this.ra.lD()&&(b=this.ra.jq());b&&this.FTa.v$g(new Vb.a(b,a))}Kak(a){const b=
this.Mb.Kc(this.graphSpace);b.zb(80);Object(va.a)(404,b.hq).isDirty=!0;this.FTa.v$g(new Vb.a(b.currentNode,a))}tSe(a){0>this.kh||(this.Hg.ga(this.kh).cfb=a)}zSc(){return!this.aL.length}pSc(a){for(const b of this.aL)if(b.U4===a)return!0;return!1}uDj(){for(const a of this.ra.ae())if(a.getValue(ub.a.clearFormatting))return!0;return!1}}Object(e.a)(ic,"PPTUndoStack",Hb,[]);class vc{constructor(a){this.T9j=a}tBi(a){const b=this.T9j.nTf(a);return new ic(a,()=>!!pa.InteractiveViewManager.instance.Ld,new le.a(()=>
Gb.App.WQ),hb.a.instance.La("Common.Interface.IEditNotificationManager"),Qh.a.getInstance(),Lh.a.getInstance(),hb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),hb.a.instance.resolve("Box4.IAppFrame"),hb.a.instance.resolve("Box4.IReplicationScheduler"),hb.a.instance.resolve("Box4.ISelectionReferenceFactory"),hb.a.instance.resolve("Common.ITaskManager"),hb.a.instance.resolve("Box4.ITypingActionOperationFactory"),()=>{},H.a.instance.ga(70),r.a.instance,b.Ezh,b.Fzh,b.Jzh,new kj(Gb.App.KLf),
hb.a.instance.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),hb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSettings"),hb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),hb.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"),hb.a.instance.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader"),hb.a.instance.resolve("Common.IFocusManager"),hb.a.instance.resolve("Box4.UndoRedo.IUndoSettingsManager"),
hb.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),hb.a.instance.resolve("PowerPointWebEditor.ITablePartialEditController"),hb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),hb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor"),hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled,hb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater"),
hb.a.instance.Be("Box4.ICoauthCashTelemetry"),Object(ee.a)("SkipEnablingCascadeUndoIfNotCombiningUndoRecords"))}}Object(e.a)(vc,"PPTUndoStackFactory",null,[1351]);class cd{constructor(){this.DXc=new qd.a}uml(a){this.DXc.raiseEvent("MU",a)}NSb(a){this.DXc.addHandler("MU",a)}IDe(a){this.DXc.removeHandler("MU",a)}dispose(){this.DXc.dispose()}}Object(e.a)(cd,"UndoEventSource",null,[1347,1348,1349,106]);class vd{constructor(a,b){this.Qbb=0;this.x2c=null;this.Zke=!1;this.hv=a;this.Bk=b;this.Bk.iCf(Object(D.a)(this,
this.LWg,"onBeforeForceOutboundGraphTransactionInitialize"));this.Bk.hCf(Object(D.a)(this,this.c7c,"onForceOutboundGraphTransactionDisposed"))}dispose(){this.Bk.Hch(Object(D.a)(this,this.LWg,"onBeforeForceOutboundGraphTransactionInitialize"));this.Bk.YOk(Object(D.a)(this,this.c7c,"onForceOutboundGraphTransactionDisposed"))}dwl(a){return 1===this.Qbb&&this.x2c?this.x2c:a}gAj(){1===this.Qbb&&(this.Zke=!0)}LWg(a,b){this.Rxg(b.transaction.fxa)&&(this.Qbb+=1,1===this.Qbb&&(this.x2c=this.hv.tV()))}c7c(a,
b){this.Rxg(b.transaction.fxa)&&(1===this.Qbb&&(this.x2c=null,this.Zke||(a=this.hv.tV(),this.hv.tSe(a)),this.Zke=!1),--this.Qbb)}Rxg(a){return 8===(a&8)}}Object(e.a)(vd,"UndoSelectionUpdater",null,[1228,106]);var Yd=d(582);class af{constructor(a,b,c){this.ez=a;this.yvd=b;this.UDd=c;this.lY=sc.ObjectSpace.h7(this.ez.ri)}Hdb(a,b,c){a=this.UDd.Qzi(this.yvd?a.clc:b.vqb,this.yvd?b.vqb:a.clc,this.lY,c,Gb.App.bJa);if(b=!!a)this.lY=a;return b}M7g(a){const b=new Db.a;b.kNe(this.ez.ri,this.lY);a(b);a=b.fJc();
sc.ObjectSpace.l2(this.ez.ri,!1).Cgb(a);this.lY=a;return!!a}Lbe(){const a=new Yd.a(sc.ObjectSpace.h7(this.ez.ri),this.lY);this.ez.fwb(a)}get T8a(){return this.yvd}get ija(){return this.lY.id}}Object(e.a)(af,"Box4UndoRedoPerformer",null,[1395]);class lg{constructor(a,b){this.Ezh=c=>{c&&this.ez.oea();c=sc.ObjectSpace.h7(this.ez.ri);return new ra(c)};this.Fzh=c=>new af(this.ez,c,this.UDd);this.Jzh=c=>{if(c.$Pd&&(this.ez.pS()&&this.ez.oea(),c.$Pd&&(c=c.$Pd))){var f=sc.ObjectSpace.h7(this.ez.ri);c.vqb=
f}};this.ez=a;this.UDd=b}}Object(e.a)(lg,"Box4UndoStackDataSyncHelper",null,[1376]);class Nh{constructor(a){this.qXh=a}nTf(a){return new lg(a,this.qXh(a.ri))}}Object(e.a)(Nh,"Box4UndoStackDataSyncHelperFactory",null,[1346]);class hg{constructor(a,b,c){this.dbb=[];this.HAb=a;this.c2c=b;this.R9b=c}get U4(){return this.c2c}get VSd(){return this.c2c}get cJ(){return this.dbb}perform(){try{if(this.HAb){const a=this.HAb.perform();this.HAb=a.undoOperation;this.dbb=h(a.kOc,this.R9b);return a}}catch(a){Z.ULS.sendTraceTag(0,
844,10,"FluidUndoRecordData.tryPerform exception: {0}.",a)}return null}combineWithPrevious(a){a&&a.HAb&&this.HAb.combineWithPrevious(a.HAb)}dispose(){}}Object(e.a)(hg,"FluidUndoRecordData",null,[1394,106]);class fh{constructor(a,b){this.q8b=[];this.y$a=a;this.S3j=b}Hdb(a){return a?(a=a.perform(),this.$6g(a)):!1}M7g(a){const b=this.y$a.ri.OHi.KEc();b.start(this.y$a.ri);a(b);a=b.finish();return this.$6g(a)}Lbe(){this.q8b.forEach(a=>{this.y$a.fwb(a)})}get T8a(){return this.S3j}get ija(){return 0<this.q8b.length?
this.q8b[this.q8b.length-1].hja:Ga.a.nil}$6g(a){return a?(a.kOc&&this.q8b.push(...a.kOc),!0):!1}}Object(e.a)(fh,"FluidUndoRedoPerformer",null,[1395]);class Tf{constructor(a){this.Ezh=b=>{var c,f;let l=null;b&&(l=this.y$a.oea());return new hg(null!==(c=null===l||void 0===l?void 0:l.undoOperation)&&void 0!==c?c:null,null!==(f=null===l||void 0===l?void 0:l.revisionId)&&void 0!==f?f:Ga.a.nil,this.y$a.ri)};this.Fzh=b=>new fh(this.y$a,b);this.Jzh=()=>{};this.y$a=a}}Object(e.a)(Tf,"FluidUndoStackDataSyncHelper",
null,[1376]);class Nj{nTf(a){return new Tf(a)}}Object(e.a)(Nj,"FluidUndoStackDataSyncHelperFactory",null,[1346]);class tk{constructor(a){this.kT=a}Iul(a){this.kT.UBh(a,1);this.kT.Uvl(a)}}Object(e.a)(tk,"PPTInverseRevisionUpdater",null,[1281]);class Ek{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UndoRedo"}Wb(a){this.K=a;a.register(yn,"Box4.UndoRedo.UndoSettingsManager").as("Box4.UndoRedo.IUndoSettingsManager").ma();a.register(fo,"Box4.UndoRedo.UndoRevisionValidator").as("Box4.UndoRedo.IUndoRevisionValidator").ma().na(()=>
new fo(a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(509,"Box4.ISelectionReferenceFactory").ma().na(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled?new Fh(um.SelectionReferenceFactory.instance,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ITableNavigator"),a.resolve("Common.IActionManager"),b.yz,a.resolve("PowerPointWebEditor.ISidUpdater"),a.resolve("PowerPointWebEditor.View.IPPTPageView")):um.SelectionReferenceFactory.instance});a.register(Xc,"PowerPointWebEditor.UndoRedo.PPTUndoRevisionMergeStrategy").as("Box4.UndoRedo.IUndoRevisionMergeStrategy").ma();
a.register(Mh,"PowerPointWebEditor.UndoRedo.PPTUndoSettings").as("PowerPointWebEditor.UndoRedo.IPPTUndoSettings").ma();a.resolve("PowerPointWebEditor.IApplicationSettings").Lpb?a.register(Nj,"PowerPointWebEditor.UndoRedo.FluidUndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma():a.register(Nh,"Box4.UndoRedo.Box4UndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma().na(()=>new Nh(b=>new Ob(sc.ObjectSpace.l2(b,a.resolve("PowerPointWebEditor.IApplicationSettings").Lpb),
a.resolve("Box4.UndoRedo.IUndoRevisionValidator"),a.resolve("Box4.UndoRedo.IUndoSettingsManager"),new Da,b,a.resolve("Box4.UndoRedo.IUndoRevisionMergeStrategy"),new tk(a.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))));a.register(vc,"PowerPointWebEditor.UndoRedo.PPTUndoStackFactory").as("Box4.UndoRedo.IUndoStackFactory").ma().na(()=>new vc(a.resolve("Box4.UndoRedo.IUndoStackDataSyncHelperFactory")));a.register(tl,"PowerPointWebEditor.UndoRedo.PPTUndoActionBehavior").as("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior").ma().na(()=>
new tl(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.UndoEventSource"),a.resolve("Common.IActionManagerExtended")));a.register(Fc,"PowerPointWebEditor.UndoRedo.PPTUndoManager").as("Box4.UndoRedo.UndoManager").as("Box4.IUndoManager").as("PowerPointWebEditor.UndoRedo.IPPTUndoManager").as("Box4.StorageObjectSpace.IUndoRevisionLoadingState").ma().na(()=>new Fc(a.resolve("Box4.UndoRedo.IUndoStackFactory"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers")));a.register(1225,"PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor").ma().na(()=>new Qf);a.register(cd,"PowerPointWebEditor.UndoRedo.UndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventNotifier").as("PowerPointWebEditor.UndoRedo.IUndoEventHandlers").ma();this.Sri(a);this.Xri(a);a.register(1226,"PowerPointWebEditor.IGroupUngroupUndoRedoActionController").ma().na(()=>
new sl(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper")))}Sri(a){a.register(1227,"PowerPointWebEditor.ITablePartialEditController").ma().na(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.qOj?new ho(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),a.resolve("Box4.IWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),b.Kub):new jp})}Xri(a){a.register(1228,"PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").ma().na(()=>new vd(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")))}init(){const a=this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager");
var b=this.K.resolve("Box4.IPageView");b.rg&&(b=b.rg.to(),a.register(b),a.setActive(b),a.BVa(C.a.jRa,null))}dispose(){this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager").dispose();this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").dispose()}static main(){m.a.instance.Ac(new Ek)}}Object(e.a)(Ek,"PPTWebEditorUndoRedoPackage",null,[2,3]);class Vj{constructor(a=!1,b,c=!1,f=!1,l=!1,x=!1,F=!1){this.PRa=a;this.r9d=c;this.k7a=f;this.u3b=l;this.y3b=x;this.VRc=F}}Object(e.a)(Vj,
"DocModeSwitcherData",null,[]);var Km=d(830);class Oo{constructor(a,b,c,f,l){this.cyb=!1;this.$ne=null;this.nud=this.Bvd=this.Nud=this.Xud=this.Qud=this.kvd=this.Gud=this.nvd=this.jya=this.wud=this.Cud=this.Uud=this.tud=this.Mud=this.g7e=!1;this.hc=a;this.ql=b;this.Mc=c;this.dv=l;this.yIg=f.RGj;this.dta=f.pptOnlineFallbackToReadOnlyAfterBootEnabled;this.f_c=f.$vg;this.X6j=u.AFrameworkApplication.zz;this.reset()}initialize(){this.Mc.Mga(Object(D.a)(this,this.Vz,"onUnifiedAppStateChanged"));this.Mc.OMa(Object(D.a)(this,
this.ndc,"onOutboundReplication"));this.$ne=[Object(D.a)(this,this.bli,"checkIsInlineRepairedDocument"),Object(D.a)(this,this.Zki,"checkIrmProtection"),Object(D.a)(this,this.Eli,"checkUserPermission"),Object(D.a)(this,this.Aki,"checkFileFormats"),Object(D.a)(this,this.Bki,"checkFileLock"),Object(D.a)(this,this.kli,"checkPasswordProtection"),Object(D.a)(this,this.Dki,"checkFontRestriction"),Object(D.a)(this,this.cli,"checkIsMarkedFinal"),Object(D.a)(this,this.dli,"checkIsMarkedReadOnlyRecommended"),
Object(D.a)(this,this.pli,"checkSessionRestriction"),Object(D.a)(this,this.oli,"checkSessionAccessTokenExpired"),Object(D.a)(this,this.hli,"checkNetworkIssueHappened"),Object(D.a)(this,this.lli,"checkPopsHostIssueHappened"),Object(D.a)(this,this.Lli,"checkWopiAccessTokenOutOfRefreshRange"),Object(D.a)(this,this.ali,"checkIsEmergencyViewMode")];this.Ugh(this.$ne)}dispose(){this.Mc.GEb(Object(D.a)(this,this.Vz,"onUnifiedAppStateChanged"))}reset(){this.nud=this.Cud=this.Bvd=this.Nud=this.Xud=this.Qud=
this.kvd=this.Gud=this.nvd=this.wud=this.Uud=this.jya=this.tud=this.Mud=this.g7e=!1}Vz(a,b){ya.a.J(22930964,809,50,"ReadOnlyUIManager::OnUnifiedAppStateChanged");this.reset();b.a8a&&this.hc.ln||(this.ql.WWf(),this.Ugh(this.$ne))}ndc(){this.dta&&!this.cyb&&(this.cyb=!0);this.hc.BK||ya.a.J(38633602,801,15,"Outbound on RO mode")}Ugh(a){if(a)for(const b of a)if(b())break}Aki(){if(this.KFj||!this.hc.ag(64)||this.yIg&&!(this.hc.ag(4)&&this.hc.ag(16)&&this.hc.ag(8)))return!0;if(!this.hc.getState(64))return!1;
if(this.yIg&&this.hc.getState(4)&&!this.hc.getState(16)&&!this.hc.getState(8)){var a=u.AFrameworkApplication.Ta.Ka(ba.a.NAa,2,Object.assign(new Vj,{VRc:!0,k7a:this.hc.getState(1)}));ya.a.J(577524062,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatConvertible)"+a.toString());this.ql.MM(10);ya.a.J(24142428,809,50,"ReadOnlyUIManager::CheckFileFormats - business bar displayed (FormatConvertible)")}else a=u.AFrameworkApplication.Ta.Ka(ba.a.NAa,2,Object.assign(new Vj,{y3b:!0,k7a:this.hc.getState(1)})),
ya.a.J(578351494,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatNotEditable)"+a.toString());return this.tud=!0}Zki(){return this.RHj||!this.hc.ag(32768)?!0:this.hc.getState(32768)?(this.ql.MM(14),this.Gud=!0,ya.a.J(24761164,809,50,"ReadOnlyUIManager::CheckIrmProtection - business bar displayed for FileIrmProtected"),!0):!1}Bki(){return this.MFj?!0:this.hc.ag(128)&&this.hc.getState(128)?(this.ql.MM(3),this.jya=!0,ya.a.J(24761166,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditCheckedOutByAnother"),
!0):this.hc.ag(256)&&this.hc.getState(256)?(this.ql.MM(4),this.jya=!0,ya.a.J(24761168,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for RequiresCheckout"),!0):this.hc.ag(512)&&this.hc.getState(512)?(this.ql.MM(5),this.jya=!0,ya.a.J(24761170,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for LockedForOfflineCheckout"),!0):this.hc.ag(1024)&&this.hc.getState(1024)?(this.ql.MM(6),this.jya=!0,ya.a.J(24761172,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditLock"),
!0):this.hc.ag(2048)&&this.hc.getState(2048)?(this.ql.MM(7),this.jya=!0,ya.a.J(24761174,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditSharedLock"),!0):this.hc.ag(4096)&&this.hc.getState(4096)?(this.ql.MM(8),this.jya=!0,ya.a.J(24761176,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for NumberOfCoauthorsReachedMax"),!0):this.hc.ag(8192)&&this.hc.getState(8192)?(this.ql.MM(9),this.jya=!0,ya.a.J(24761178,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditExistingExclusiveLock"),
!0):!1}cli(){if(this.AIj||!this.hc.ag(2)||!this.hc.ag(16))return!0;if(!this.hc.getState(2)&&this.hc.getState(16)){const a=u.AFrameworkApplication.Ta.Ka(ba.a.NAa,2,Object.assign(new Vj,{PRa:!0,k7a:this.hc.getState(1)}));ya.a.J(578351455,809,50,"ReadOnlyUIManager::CheckIsMarkedFinal - Callout display "+a.toString());return this.Mud=!0}return!1}dli(){if(!this.f_c)return!1;if(this.BIj||!this.hc.ag(2)||!this.hc.ag(524288))return!0;if(!this.hc.getState(2)&&this.hc.getState(524288)){const a=u.AFrameworkApplication.Ta.Ka(ba.a.NAa,
2,Object.assign(new Vj,{r9d:!0,k7a:this.hc.getState(1)}));ya.a.J(578351452,809,50,"ReadOnlyUIManager::CheckIsMarkedReadOnlyRecommended - Callout displayed "+a.toString());return this.Nud=!0}return!1}kli(){if(this.lKj||!this.hc.ag(2)||!this.hc.ag(32))return!0;if(!this.hc.getState(2)&&this.hc.getState(32)){const a=u.AFrameworkApplication.Ta.Ka(ba.a.NAa,2,Object.assign(new Vj,{u3b:!0,k7a:this.hc.getState(1)}));ya.a.J(578351449,809,50,"ReadOnlyUIManager::CheckPasswordProtection - Callout display "+a.toString());
return this.Uud=!0}return!1}bli(){return this.wHj||!this.hc.ag(2097152)?!0:this.hc.getState(2097152)?(this.ql.MM(22),this.Cud=!0,ya.a.J(42824021,809,50,"ReadOnlyUIManager:: - Inline repaired document business bar displayed"),!0):!1}ali(){var a=!1;if(this.mFj||!this.hc.ag(4194304))return!0;this.hc.getState(4194304)&&(a="NotAvailable",this.dv&&(a=this.dv.Srb(),a=Km.a[a]),Se.Health.instance.recordQosError("EmergencyViewModeEnabledReason"+a,["ViewByDefault"],!0,!0,!1,!1,null),32===u.AFrameworkApplication.Ta.processAction(ba.a.tlc,
1)?(a=u.AFrameworkApplication.Ta.processAction(ba.a.tlc,2),ya.a.J(578351445,809,15,"ReadOnlyUIManager:: EmergencyViewMode Emergency View Mode displayed in Doc Mode Switcher "+a.toString())):(this.ql.MM(23),ya.a.J(593295554,809,15,"ReadOnlyUIManager:: EmergencyViewMode business bar displayed")),this.nud=a=!0);return a}Dki(){return!this.hGj&&this.hc.ag(2)&&this.hc.ag(8)?!this.hc.getState(2)&&this.hc.getState(8)?(this.ql.MM(12),this.wud=!0,ya.a.J(24142434,809,50,"ReadOnlyUIManager::CheckFontRestriction - business bar displayed"),
!0):!1:!0}Eli(){if(this.XEj||!this.hc.ag(1))return!0;if(!this.hc.getState(1)){const a=u.AFrameworkApplication.Ta.Ka(ba.a.NAa,2,new Vj);ya.a.J(578351441,809,50,"ReadOnlyUIManager::CheckUserPermission - Callout display "+a.toString());return!0}return!1}pli(){return this.TMj?!0:this.hc.ag(16384)&&this.hc.getState(16384)?(this.ql.MM(13),this.nvd=!0,ya.a.J(24761184,809,50,"ReadOnlyUIManager::CheckSessionRestriction - business bar displayed"),!0):!1}oli(){return this.RMj?!0:this.hc.ag(65536)&&this.hc.getState(65536)?
(Se.Health.instance.recordQosError("SessionAccessTokenExpired",["SessionExpired"],!1,!1,!0,!0,null),this.dta?this.ql.GGc(15,this.cyb):this.ql.MM(15),this.kvd=!0,ya.a.J(37066185,809,50,"ReadOnlyUIManager::CheckSessionAccessTokenExpired - business bar displayed"),!0):!1}lli(){return this.MKj?!0:this.hc.ag(262144)&&this.hc.getState(262144)&&this.dta?(this.ql.GGc(17,this.cyb),this.Xud=!0,ya.a.J(37310543,809,50,"ReadOnlyUIManager::CheckPopsHostIssueHappened - business bar displayed"),!0):!1}Lli(){return this.iQj?
!0:this.hc.ag(1048576)&&this.hc.getState(1048576)&&this.dta&&this.X6j?(this.ql.GGc(21,this.cyb),this.Bvd=!0,ya.a.J(39327011,809,50,"ReadOnlyUIManager::CheckWopiAccessTokenOutOfRefreshRange - business bar displayed"),!0):!1}hli(){return this.WIj?!0:this.hc.ag(131072)&&this.hc.getState(131072)&&this.dta?(this.ql.GGc(16,this.cyb),this.Qud=!0,ya.a.J(37310545,809,50,"ReadOnlyUIManager::CheckNetworkIssueHappened - business bar displayed"),!0):!1}get XEj(){return this.g7e}get AIj(){return this.Mud}get KFj(){return this.tud}get lKj(){return this.Uud}get wHj(){return this.Cud}get hGj(){return this.wud}get MFj(){return this.jya}get TMj(){return this.nvd}get RHj(){return this.Gud}get RMj(){return this.kvd}get WIj(){return this.Qud}get MKj(){return this.Xud}get BIj(){return this.Nud}get iQj(){return this.Bvd}get mFj(){return this.nud}}
Object(e.a)(Oo,"ReadOnlyUIManager",null,[1234,106]);class kp{constructor(){this.D1c=this.K=null}get name(){return"PowerPointWebEditor.UnifiedApp"}Wb(a){this.K=a;this.K.register(1234,"PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager").ma().na(()=>new Oo(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").XCa&&
(this.D1c=this.K.resolve("PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager"),this.D1c.initialize())}dispose(){this.D1c&&this.D1c.dispose()}static main(){m.a.instance.Ac(new kp)}}Object(e.a)(kp,"PPTWebEditorUnifiedAppPackage",null,[2,3]);var Uh=d(272);class Po{constructor(a,b,c,f){this.Qb=a;this.Tq=b;this.KD=c;this.gta=f}$ha(){const a=new Me.a;a.$(0,Object(D.a)(this,this.tableBorderAndResizeHandlesClickHandler,"tableBorderAndResizeHandlesClickHandler"));a.$(1,Object(D.a)(this,this.pptTableColumnHandleClickHandler,
"pptTableColumnHandleClickHandler"));a.$(2,Object(D.a)(this,this.pptTableRowHandleClickHandler,"pptTableRowHandleClickHandler"));a.$(3,Object(D.a)(this,this.backgroundClickHandler,"backgroundClickHandler"));a.$(4,Object(D.a)(this,this.shapeClickHandler,"shapeClickHandler"));return a}tableBorderAndResizeHandlesClickHandler(a){return this.Tq.S2(a.Fc)||this.Tq.iSa(a.Fc)||this.Tq.RTc(a.Fc)?(this.Qb.zqb(),Uh.a.Al(!0)):Uh.a.notHandled}pptTableColumnHandleClickHandler(a){if(this.Tq.tsa(a.Fc)){const b=this.Tq.p1d(a.Fc);
if(!b||!b.pk)return ya.a.J(22577752,822,15,"Clicked on a table column handle but failed to get a ShapeViewElement."),Uh.a.Al(!1);b.pk.Kp||this.Tq.BDc(a.Fc,a.eU,a.Ti.Vf);return Uh.a.Al(!0)}return Uh.a.notHandled}pptTableRowHandleClickHandler(a){if(this.Tq.W4b(a.Fc)){const b=this.Tq.p1d(a.Fc);if(!b||!b.pk)return ya.a.J(41209868,822,15,"Clicked on a table row handle but failed to get a ShapeViewElement."),Uh.a.Al(!1);b.pk.Kp||this.Tq.PVk(a.Fc,a.eU,a.Ti.Vf);return Uh.a.Al(!0)}return Uh.a.notHandled}backgroundClickHandler(a){return this.Qb.M4b(a)?
(this.gta.setVisibility(!1),Uh.a.Al(!0)):Uh.a.notHandled}shapeClickHandler(a){let b=Uh.a.notHandled;this.KD.F4b||(b=this.KD.PJe(a));this.KD.F4b=!1;if((a=this.KD.Grb(a))&&!a.kN||a&&a.shapeNode&&a.shapeNode.nd&&a.kN)return Uh.a.Al(!0);this.gta.setVisibility(!1);return b}}Object(e.a)(Po,"ClickHandlers",null,[]);var Jn=d(411),zn=d(416);class Ep{constructor(a,b,c,f,l,x){this.Qb=a;this.ra=b;this.Fa=c;this.ia=f;this.KD=l;this.Cne=x}$ha(){const a=new Me.a;a.$(0,Object(D.a)(this,this.noContextMenuHandler,
"noContextMenuHandler"));a.$(1,Object(D.a)(this,this.slideBackgroundContextMenuHandler,"slideBackgroundContextMenuHandler"));a.$(2,Object(D.a)(this,this.shapeContextMenuHandler,"shapeContextMenuHandler"));return a}noContextMenuHandler(a){return this.Qb.Woh(a)?Jn.a.notHandled:Jn.a.Al(null)}slideBackgroundContextMenuHandler(a){return this.Qb.M4b(a)?(this.ra.ly(),this.ra.Ph(),this.Fa.Ad(),this.ia.Ka(ba.a.ONd,2,a.Ti),Jn.a.Al(null)):Jn.a.notHandled}shapeContextMenuHandler(a){var b=this.KD.Grb(a);if(this.H$k(b,
a))b.ZOa(),this.Cne?b.Ax||this.ia.Ka(ba.a.kNa,2,new zn.a(b.shapeNode,!0,a.Ti)):this.ia.Ka(ba.a.kNa,2,new zn.a(b.shapeNode,!0,a.Ti));else if(this.E$k(b))return this.ra.ly(),(b=this.KD.ucj(b,a))&&this.ra.selectShape(b,!0),this.Fa.Ad(),this.ia.Ka(ba.a.NNd,2,a.Ti),Jn.a.Al(null);return Jn.a.notHandled}H$k(a,b){return!!a&&!!a.shapeNode&&a.shapeNode.isConnected&&a.shapeNode.Exg&&!a.kub(b.Ti)}E$k(a){return!!a||this.ra.uG()||!this.ra.Oa.length}}Object(e.a)(Ep,"ContextMenuClickHandlers",null,[]);class lp{constructor(a,
b,c,f,l){this.Qb=a;this.Tq=b;this.KD=c;this.ia=f;this.jyb=l}$ha(){const a=new Me.a;a.$(0,Object(D.a)(this,this.tableBorderAndHandlesDoubleClickHandler,"tableBorderAndHandlesDoubleClickHandler"));a.$(1,Object(D.a)(this,this.shapeDoubleClickHandler,"shapeDoubleClickHandler"));a.$(2,Object(D.a)(this,this.backgroundDoubleClickHandler,"backgroundDoubleClickHandler"));return a}tableBorderAndHandlesDoubleClickHandler(a){return this.Tq.S2(a.Fc)||this.Tq.iSa(a.Fc)||this.Tq.RTc(a.Fc)?(this.Qb.zqb(),Uh.a.Al(!0)):
this.Tq.tsa(a.Fc)||this.Tq.W4b(a.Fc)?(this.Qb.zqb(),Uh.a.Al(!1)):Uh.a.notHandled}shapeDoubleClickHandler(a){return this.KD.Grb(a)?(this.Qb.zqb(),Uh.a.Al(!1)):Uh.a.notHandled}backgroundDoubleClickHandler(a){return this.Qb.M4b(a)?(this.Qb.zqb(),this.jyb||this.ia.processAction(ba.a.Otb,2,{DoubleClickInsert:"true"}),Uh.a.Al(!0)):Uh.a.notHandled}}Object(e.a)(lp,"DoubleClickHandlers",null,[]);class mp{constructor(a,b,c,f,l){this.KD=a;this.eC=b;this.ia=c;this.Ea=f;this.vN=l}Hag(){return Object(D.a)(this,
this.p5c,"mouseUpHandlerFilter")}p5c(a){return a?(a=this.eC.f0d(a.Fc))&&a.$a&&this.Ea.kn(a.$a)&&this.vN.mSa&&this.KD.BKe?(this.ia.processAction(C.a.Sha,2),!0):this.KD.BKe=!1:!1}}Object(e.a)(mp,"MouseInputHandlers",null,[]);var Ul=d(273);class cn{constructor(a,b,c,f){this.KD=a;this.Nb=b;this.l_=c;this.Ie=f}$ha(){const a=new Me.a;a.$(0,Object(D.a)(this,this.backgroundPointerDownHandler,"backgroundPointerDownHandler"));a.$(1,Object(D.a)(this,this.shapePointerDownHandler,"shapePointerDownHandler"));a.$(2,
Object(D.a)(this,this.defaultPointerDownHandler,"defaultPointerDownHandler"));return a}backgroundPointerDownHandler(a){this.Gql();return this.KD.oHf(a)}Gql(){this.Ie.Hqg()||Mc.a.kIc("ScrollActiveThumbnailIntoView",ba.a.oFb,()=>{this.Ie.vGe();return 32})}shapePointerDownHandler(a){this.Nb.QV&&this.l_.show(3,-1);const b=this.KD.Grb(a);if(b&&b.shapeNode&&b.shapeNode.Qf&&!b.shapeNode.mh)return Uh.a.Al(!1);if((Sys.UI.DomElement.containsCssClass(a.Fc,Ul.a.nwa)||Sys.UI.DomElement.containsCssClass(a.Fc,Ul.a.IGb)||
Sys.UI.DomElement.containsCssClass(a.Fc,Ul.a.VJe)||Sys.UI.DomElement.containsCssClass(a.Fc,Ul.a.cjd)||Sys.UI.DomElement.containsCssClass(a.Fc,Ul.a.Ouh)||Sys.UI.DomElement.containsCssClass(a.Fc,Ul.a.avh))&&b.isSelected&&!b.kN||void 0!==b&&null!==b&&b.shapeNode.Lp)return this.KD.F4b=!1,Uh.a.Al(!0);this.KD.F4b=!0;a=this.KD.PJe(a);a.z2&&(this.KD.BKe=!0);return a}defaultPointerDownHandler(){return Uh.a.Al(!0)}}Object(e.a)(cn,"PointerDownHandlers",null,[]);class Zh{constructor(a){this.KD=a}$ha(){const a=
new Me.a;a.$(0,Object(D.a)(this,this.backgroundPointerUpHandler,"backgroundPointerUpHandler"));a.$(1,Object(D.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(1,Object(D.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(2,Object(D.a)(this,this.defaultPointerUpHandler,"defaultPointerUpHandler"));return a}backgroundPointerUpHandler(a){return this.KD.oHf(a)}shapePointerUpHandler(a){const b=this.KD.Grb(a);return b&&b.shapeNode&&b.shapeNode.Qf&&!b.shapeNode.mh?Uh.a.Al(!1):
this.KD.PJe(a)}defaultPointerUpHandler(){return Uh.a.Al(!0)}}Object(e.a)(Zh,"PointerUpHandlers",null,[]);class dm extends Sys.EventArgs{constructor(){super()}}Object(e.a)(dm,"SlideBackgroundClickedEventArgs",Sys.EventArgs,[]);class Fl{constructor(a,b,c,f,l,x,F,R){this.Qb=a;this.Tq=b;this.ra=c;this.gta=f;this.Fa=l;this.a4=x;this.Lka=F;this.Ea=R;this.BKe=this.F4b=!1}oHf(a){return this.Qb.M4b(a)?(this.ra.ly(),a=a.Ti,this.a4.k$g(new dm(!1)),(a.ctrlKey||a.shiftKey)&&a.Sz===Sys.UI.MouseButton.leftButton?
this.ra.hj():this.ra.Ph(),this.gta.setVisibility(!1),this.Fa.Ad(),Uh.a.Al(!0)):Uh.a.notHandled}PJe(a){const b=this.Grb(a);b&&this.ra.ly();const c=Sys.UI.DomElement.containsCssClass(a.Fc,Ul.a.nwa)||Sys.UI.DomElement.containsCssClass(a.Fc,Ul.a.IGb)||Sys.UI.DomElement.containsCssClass(a.Fc,Ul.a.VJe),f=this.Tq.RTc(a.Fc)||this.Tq.S2(a.Fc)||this.Tq.iSa(a.Fc);Mc.a.hk("isEventFromHandlers",c.toString());Mc.a.hk("isEventFromTableHandlers",f.toString());return c&&!f&&b&&b.kN?(this.ra.hj(),this.gta.setVisibility(!1),
this.Fa.Ad(),Uh.a.Al(!0)):f&&b&&!b.kN?(b.HWg(a.Ti),Uh.a.Al(!0)):!b||b.kN&&!this.n7d(a)?Uh.a.notHandled:(b.aok(a.Ti),Uh.a.Al(!0))}Grb(a){let b=this.Tq.VH(a.Fc);if(!b){var c=a.Fc,f=Ca.a(c,za.a.role);f=f?f.toString()===Uc.a.ATb:!1;if(Sys.UI.DomElement.containsCssClass(c,"ListMarker")||f)for(;!b&&c;){b=this.Tq.VH(c);if(Sys.UI.DomElement.containsCssClass(c,"Outline")&&Sys.UI.DomElement.containsCssClass(c,"OutlineSized"))break;c=c.parentNode}}if(b){c=Object(va.a)(124,b);if(!c&&(this.Tq.RTc(a.Fc)||this.Tq.S2(a.Fc)||
this.Tq.iSa(a.Fc))&&(c=this.Lka.l_b(this.Ea.kn(b.$a)),!c))return ya.a.J(39322434,822,15,"Clicked on a table resize handle but failed to get its ContainerShapeViewElement."),null;if(c||(c=this.Lka.l_b(this.Ea.kn(b.$a)))&&c.yA&&!(c.Ax||c.Kp||c.mae))return c}return null}n7d(a){return a&&a.Fc?a.Fc.id.startsWith(qf.a.iAc):!1}ucj(a,b){return a?this.tcj(a):this.scj(b.graphNode)}tcj(a){let b=null;a.isSelected&&this.ra.uG()||(b=Object(va.a)(4,a.$a));return b}scj(a){let b=null;if(a){const c=mb.GraphIterator.mb(a);
c.mc(10)?(a=Object(va.a)(4,c.Ng(10)),this.ra.WV(a)||(b=a)):ya.a.J(22577757,808,15,"Unexpected type of graph node gets clicked, type: {0}, Id {1}",a.type,a.id)}return b}}Object(e.a)(Fl,"ViewEventHandlerHelper",null,[1283]);class hi{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ViewEventHandler"}Wb(a){this.K=a;a.register(Po,"PowerPointWebEditor.ViewEventHandler.ClickHandlers").ma().na(()=>new Po(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),
a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IGrippersManager")));a.register(lp,"PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").ma().na(()=>new lp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Common.IActionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").Qtb));a.register(Ep,"PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").ma().na(()=>
new Ep(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptContextMenuCrashFix));a.register(cn,"PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").ma().na(()=>new cn(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),
a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView")));a.register(Zh,"PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").ma().na(()=>new Zh(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout")));a.register(mp,"PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").ma().na(()=>new mp(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),
a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext")));a.register(Fl,"PowerPointWebEditor.ViewEventHandler.ViewEventHandlerHelper").as("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper").ma().na(()=>new Fl(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("Box4.IGrippersManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.View.IShapeViewHelper"),a.resolve("PowerPointWebEditor.IShapeReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");a.qZh(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ClickHandlers").$ha());a.d_h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").$ha());a.SZh(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").$ha());
a.D0h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").$ha());a.G0h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").$ha());this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").ob(qa.a.WW,a.container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").Hag())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&
this.K.resolve("Common.MouseInputManager").xb(qa.a.WW,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").Hag())}static main(){m.a.instance.Ac(new hi)}}Object(e.a)(hi,"PPTWebEditorViewEventHandlerPackage",null,[2,3]);var cg=d(80),Fp;(function(a){a[a.notLoaded=1]="notLoaded";a[a.loaded=2]="loaded";a[a.failed=3]="failed"})(Fp||(Fp={}));Object(e.b)("WebSocketCompressionHelperLoadState",Fp);var Fk=d(87),bq=d(337),
np;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(np||(np={}));Object(e.b)("WebSocketState",np);class Ur{constructor(a,b,c,f,l){this.g$b=this.wl=this.LAb=null;this.rFa=-1;this.dab=this.Eja=0;this.Q6b=-1;this.yyb=0;this.zyb=null;this.iTa=0;if(!a)throw Error.argumentNull("webSocketClient");this.kv=a;this.Xa=b;this.QG=c;this.Mc=f;a=document.createElement("a");a.href=this.kv.xAl;a.protocol="http:"===a.protocol?"ws":"wss";ee.a("PodsWebSocketFrontDoor.UseQueryString")?
(a=new Lj.QueryStringBuilder(a.href),ee.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&a.Hi(gg.a.Z2g,b.Wj),ee.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&a.Hi(gg.a.Gsk,u.AFrameworkApplication.userSessionId),a.Hi(gg.a.tec,l.toString()),this.LAb=a.toString()):this.LAb=a.href;this.hab=cg.a.TE(this.LAb);this.JVb(2);this.Fka=this.kv.$fh;this.nee=this.kv.Yni;this.LJe();this.Mc.SMa(Object(D.a)(this,this.Ucb,"onSessionEnding"));this.Mc.uB(Object(D.a)(this,this.jo,"onSessionRehydrated"))}dispose(){this.Mc.VDe(Object(D.a)(this,
this.Ucb,"onSessionEnding"));this.Mc.hea(Object(D.a)(this,this.jo,"onSessionRehydrated"))}JVb(a){this.wl&&this.wl.close();this.wl=new WebSocket(this.LAb,[]);this.wl.onopen=Object(D.a)(this,this.onOpen,"onOpen");this.wl.onerror=Object(D.a)(this,this.onError,"onError");this.wl.onclose=Object(D.a)(this,this.onClose,"onClose");this.wl.onmessage=Object(D.a)(this,this.onMessage,"onMessage");this.iTa=a;ya.a.J(556541794,this.kv.$P,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",
this.hab,this.Xa.Wj,this.iTa)}ping(){if(this.wl)if(1===this.wl.readyState){const a=this.kv.kzi();this.wl.send(a)}else ya.a.J(559284698,this.kv.$P,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.wl.readyState),this.Tva(4);else ya.a.J(559284697,this.kv.$P,50,"WebSocketFetcher::Ping Websocket is unavailable.")}eoi(){this.wl.close()}onOpen(){ya.a.J(591208995,this.kv.$P,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.hab,this.Xa.Wj);this.lic();this.yyb=0;this.zyb=null;
this.kv.Dik()}onError(a){ya.a.J(591208993,this.kv.$P,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(a),this.hab,this.Xa.Wj)}onClose(a){ya.a.J(591208991,this.kv.$P,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",this.hab,this.Xa.Wj,JSON.stringify(a),a.code,a.reason);this.yyb=a.code;this.zyb=a.reason}onMessage(a){try{a&&a.data&&this.kv.Elk(a)}catch(b){ya.a.J(559284699,this.kv.$P,10,"WebSocketFetcher::OnMessage",
b.toString())}}LJe(){this.g$b=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.Q6b),this.wl||(ya.a.J(559284700,this.kv.$P,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Tva(1))):this.Q6b=window.setTimeout(()=>{this.wl&&(ya.a.J(559284701,this.kv.$P,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.yyb=1E3,this.zyb="Lost visibility",this.wl.close(this.yyb,this.zyb),this.wl=null,window.clearTimeout(this.rFa))},
this.nee)};window.self.addEventListener("visibilitychange",this.g$b)}lic(){this.Eja=0}iHd(){0<this.kv.c5c&&(new Date).getTime()-this.dab>this.kv.c5c&&(this.lic(),ya.a.J(559284702,this.kv.$P,50,"WebSocketFetcher::Retry connect to server after long pause."))}aLd(){const a=!!this.QG&&!!this.QG.instance&&!this.QG.instance.P7,b=(new Date).getTime()-this.dab>this.Fka,c=this.Eja<this.kv.eSg,f=!this.wl||3===this.wl.readyState||2===this.wl.readyState,l=a&&b&&c&&f;ya.a.J(557181E3,this.kv.$P,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",
l,a,b,c,f);return l}QIe(){this.dab=(new Date).getTime();this.Fka=Math.pow(2,this.Eja)*this.kv.$fh;0<this.kv.c5c&&(this.Fka=Math.min(this.Fka,this.kv.c5c));window.setTimeout(()=>{this.Tva(3)},this.Fka)}Tva(a){this.iHd();this.aLd()&&(this.JVb(a),this.QIe(),this.Eja++,a!==this.iTa&&ya.a.J(541671620,this.kv.$P,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",a,this.iTa),ya.a.J(559284703,this.kv.$P,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",
this.iTa),this.Eja===this.kv.eSg&&ya.a.J(559284704,this.kv.$P,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.iTa))}sendMessage(a,b){if(!this.wl)return ya.a.J(559284705,this.kv.$P,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",b,this.yyb,this.zyb),1;ya.a.J(559284706,this.kv.$P,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",np[this.wl.readyState],
b,this.yyb,this.zyb);if(1===this.wl.readyState)return this.wl.send(a),0;this.Tva(5);return 2}G6k(){this.wl.binaryType="arraybuffer"}lCb(){-1!==this.rFa&&window.clearTimeout(this.rFa);this.rFa=window.setTimeout(()=>{this.ping()},this.kv.lvk)}zmi(){this.iTa=0}Ucb(){this.wl&&(ya.a.J(557352418,this.kv.$P,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.wl.close(),this.wl=null)}jo(){this.wl||(ya.a.J(557352419,this.kv.$P,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),
this.Tva(6))}}Object(e.a)(Ur,"WebSocketFetcher",null,[1320,106]);var lr;(function(a){a[a.none=0]="none";a[a.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";a[a.initialConnection=2]="initialConnection";a[a.timeoutReconnection=3]="timeoutReconnection";a[a.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";a[a.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";a[a.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})(lr||(lr={}));
Object(e.b)("ConnectionReason",lr);var Kn;(function(a){a[a.success=0]="success";a[a.nullWebSocket=1]="nullWebSocket";a[a.webSocketNotOpened=2]="webSocketNotOpened"})(Kn||(Kn={}));Object(e.b)("SendMessageStatusCode",Kn);class Vr extends Sys.EventArgs{constructor(a,b,c){super();this.response=a;this.wUk=b;this.NDj=c}}Object(e.a)(Vr,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var fl=d(638);class Qo{constructor(a,b,c,f,l){this.ym=window.performance.now();this.woe=new qd.a;this.Xge=this.U7b=!0;this.kxb=
null;this.RAb=1;this.Xa=b;this.i0c=a.vAl;this.tne=a.wAl;this.X4j=a.tAl;this.s7j=a.uAl;this.RZj=a.rAl;this.Bzb=a.Dmd;this.f$j=a.Hxl;this.are=a.sAl;this.hab=cg.a.TE(this.are);this.Eua=new Ur(this,b,c,f,new bq.a(a.Vda));this.uFg=a.RDc;if(l)this.kxb=l;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.Eua.dispose()}ping(){this.Eua.ping()}gx(a){const b=new Map,c=this.thj(a);a.smartArtEditOpRequest&&(b.set("requestType",c),b.set("correlationId",a.smartArtEditOpRequest.commonData?a.smartArtEditOpRequest.commonData.correlationId:
null),Se.Health.instance.recordKpiUsage("DeltaEdit",1,"gc2smartart",b));this.Bzb?(a=this.Eua.sendMessage(JSON.stringify(a),c),0!==a&&(b.set("SendMessageStatusCode",Kn[a]),Se.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,Object.assign(new Fk.a,{extendedProperties:b})))):Se.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,Object.assign(new Fk.a,{extendedProperties:b}))}e5h(a){this.woe.addHandler("ResponseReceivedEventId",a)}qQk(a){this.woe.removeHandler("ResponseReceivedEventId",
a)}Dik(){if(this.Bzb){var a=Mc.a.Cb?Mc.a.Cb.actionId:lh.a.create().toString(),b=u.AFrameworkApplication.userSessionId,c=this.Xa.Wj;this.Xge=!0;b=fl.p(a,b,this.Xa.podSessionId,c);b=this.Eua.sendMessage(JSON.stringify(b),"validateSession");ya.a.J(557175649,839,0===b?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",a,Kn[b],this.hab,c)}}Elk(a){if(this.Bzb)try{const b=this.eOi(a);if(b.pong)this.lCb(b.pong.pingTimestamp);
else if(b.validateSessionResponse)this.Gpk(b.validateSessionResponse);else if(b.compressionHandshakeResponse)this.zik(b.compressionHandshakeResponse);else{const c=Object.getType(a.data)!==String;this.woe.raiseEvent("ResponseReceivedEventId",new Vr(b,this.naj(a,c),c))}}catch(b){ya.a.J(541618382,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.lCb(a.data)}eOi(a){let b=Object.getType(a.data)===String?a.data:null;if(b)return JSON.parse(b);if(2===this.RAb)return a=
new Uint8Array(a.data),b=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(a),JSON.parse(b);ya.a.J(541349337,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}naj(a,b){return b?(new Uint8Array(a.data)).byteLength:a.data.length}Gpk(a){if(a.isValid){if(this.uFg){a=Mc.a.Cb?Mc.a.Cb.actionId:lh.a.create().toString();const b=u.AFrameworkApplication.userSessionId,c=this.Xa.podSessionId,
f=this.Xa.Wj;ya.a.J(541161497,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",Fp[this.RAb]);1===this.RAb?this.oUj(a,b,c,f):2===this.RAb&&this.kjh(a,b,c,f)}this.ping()}else ya.a.J(556541795,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.hab,this.Xa.Wj),this.Eua.eoi()}oUj(a,b,c,f){this.uFg&&this.kxb.loadScript("WebSocketCompressionHelper").then(()=>{this.RAb=
2;this.kjh(a,b,c,f)}).catch(()=>{ya.a.J(541710233,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.RAb=3})}kjh(a,b,c,f){a=fl.a(a,b,c,!0,f);a=this.Eua.sendMessage(JSON.stringify(a),"compressionHandshake");ya.a.J(541710232,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",a)}zik(a){a=a.clientReadyForCompression;ya.a.J(541710234,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",
a);a&&this.Eua.G6k()}thj(a){return a.ping?"ping":a.validateSessionRequest?"validateSession":a.compressionHandshakeRequest?"compressionHandshake":a.smartArtEditOpRequest&&a.smartArtEditOpRequest.editOps&&a.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}lCb(a){this.Eua.lCb(a);Ma.a.Va(a)?ya.a.J(561639837,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(a=parseFloat(a),isNaN(a)?ya.a.J(591208987,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",
this.Bzb):(a={["PingTime"]:window.performance.now()-this.ym-a,MeasurementType:"Performance.Now"},a.First=this.U7b?1:0,a.WebSocketFrontDoorProtobufEnabled=this.Bzb,a.PostConnectionPing=this.Xge,a.ConnectionReason=lr[this.Eua.iTa],this.Eua.zmi(),this.Xge=this.U7b=!1,ya.a.J(591208985,839,50,xa.a.toJSON(a))))}kzi(){var a=(window.performance.now()-this.ym).toString();if(!this.Bzb)return a;a=fl.q(fl.l(a),null,null,null,this.Xa.Wj);return JSON.stringify(a)}get xAl(){return this.f$j&&!Ma.a.Va(this.are)?this.are:
u.AFrameworkApplication.fa.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get $P(){return 839}get lvk(){return this.tne}get eSg(){return this.i0c}get $fh(){return this.s7j}get c5c(){return this.X4j}get Yni(){return this.RZj}}Object(e.a)(Qo,"PodsWebSocketFrontDoor",null,[1218,106,1279]);class mr{constructor(){this.K=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}Wb(a){if(!a)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");this.K=a;
a.register(1218,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").ma().na(()=>{try{return new Qo(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.La("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("Common.IDynamicScriptLoaderProvider").yv)}catch(b){return ya.a.J(591208983,839,10,"exception creating PodsWebSocketFrontDoor: "+b),null}})}init(){}dispose(){this.K.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){m.a.instance.Ac(new mr)}}
Object(e.a)(mr,"PPTWebEditorWebSocketFrontDoorPackage",null,[2,3]);var Wr=d(1105),Ro=d(1114);class cq{constructor(a=null){this.Sn=null;this.reset();this.xQb=a}XSb(a,b){if(!this.xQb||this.xQb.pKe())b in this.Sn||(this.Sn[b]=[]),this.Sn[b].push(a)}getData(){return xa.a.count(this.Sn)?this.Sn:null}reset(){this.Sn={}}}Object(e.a)(cq,"NamedValuesAggregator",null,[1495]);class dq{constructor(){this.Sn=new Ha.a}get vIk(){return this.Sn.count}XSb(a){this.Sn.add(a)}getData(){return this.vIk?cb.toArray(this.Sn):
null}reset(){this.Sn=new Ha.a}}Object(e.a)(dq,"BatchDataAggregator",null,[1495]);var Lm;(function(a){a[a.LanguageInfo=0]="LanguageInfo";a[a.FeedbackLoop=1]="FeedbackLoop";a[a.Config=2]="Config"})(Lm||(Lm={}));Object(e.b)("ApiType",Lm);class Jq{constructor(a,b){this.Ei=a;this.Bzd=b}gx(a,b,c){if(c){a=Lm[a];var f={"Content-Type":"application/json; charset=utf-8"};f["X-StatelessPopsAffinityRoutingEnabled"]=u.AFrameworkApplication.fa.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Ei.vj(this.Bzd()+
"&apitype="+a,2,b,f,!1,3,Object(D.a)(this,this.FHa,"requestSucceeded"),Object(D.a)(this,this.DHa,"requestFailed"),c,void 0,void 0,void 0,void 0,"28")}}FHa(a){if(!u.AFrameworkApplication.Xg&&a&&a.data){var b=a.data.state;b&&b.FOc(b,a.data.Zd)}}DHa(a){!u.AFrameworkApplication.Xg&&a&&a.data&&(a=a.data.state)&&a.qOc(a)}}Object(e.a)(Jq,"EditorServiceRequestManager",null,[1370]);class Xr extends Sys.EventArgs{constructor(a){super();this.nodeId=a}}Object(e.a)(Xr,"ErrorRangesChangedEventArgs",Sys.EventArgs,
[]);var ul=d(270);class An{constructor(a,b,c){this.begin=a;this.end=b;this.Dh=c}}Object(e.a)(An,"ErrorRange",null,[194]);class Gp{constructor(a,b){this.un=a;this.UKh=b}get xe(){return this.un}get Dh(){return this.UKh}Sd(a){return new Gp(a||this.un,this.Dh)}}Object(e.a)(Gp,"SpellingErrorObject",null,[170]);class Kq{constructor(a,b,c){this.Pa=new qd.a;this.Zq=a;this.xUh=b;this.pOh=c}zAf(a,b){b=this.Orh(a,b);if(!Pa.a.Va(b)){for(var c=this.RE(a),f=[],l=0,x=0;l<b.length&&x<c.length;){const F=c[x],R=b[l];
R.end<=F.begin?++l:(F.end>R.begin&&Array.add(f,F),++x)}c=a.LYa();try{const F=a.xha();try{this.Nbh(a,f),this.AAf(a,b)}finally{F&&F.dispose()}}finally{c&&c.dispose()}this.c6c(a)}}wHa(a,b,c=!1){if(!Pa.a.Va(b)){c=c?null:a.LYa();try{const f=a.xha();try{this.Nbh(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}this.c6c(a)}}QRk(a,b){const c=a.LYa();try{const f=a.xha();try{this.$Ld(a),b=this.Orh(a,b),Pa.a.Va(b)||this.AAf(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}}$Ld(a){const b=a.LYa();try{const c=
a.xha();try{const f=a.Ra;for(a=0;a<f.length;a++){const l=f.ga(a);l.Ap&&(l.Ap=null);l.HK=!1}}finally{c&&c.dispose()}}finally{b&&b.dispose()}}RE(a,b=null){const c=[];let f=0,l=null;var x=!1;a=a.Ra;for(let F=0;F<a.length;F++){const R=a.ga(F);if(R.HK){const fa=R.cp;l?(x=new An(f,fa,l),b&&!b(x)||Array.add(c,x)):x?Z.ULS.sendTraceTag(41300895,324,10,"Encountered CHP SpellingError without ErrorDetails set"):Z.ULS.sendTraceTag(41300896,324,10,"Encountered SpellingErrorEnd without the begin: Begin CP {0}, End CP {1}",
f,fa);x=!1}R.Ap&&(x=!0,f=R.cp,l=R.Ap.Dh)}return c}TPa(a){if(!a||!fb.SelectionEditor.Pj(a)&&!fb.SelectionEditor.Kg(a))return null;const b=a.node;let c=a.Qa,f=a.Kb;a=fb.SelectionEditor.Kg(a);const l=this.Zq.text(b);for(const x of this.RE(b))if(a){if(x.begin<=c&&x.end>=f)return x}else if(x.begin<=c&&x.end>=c&&Ma.a.Wsi(l,x.end,f))return x;return null}$ic(a){if(!this.pOh||!a||!(a.Paa||2===a.length&&fb.SelectionEditor.Cl(a.Te)))return!1;a=this.TPa(a.Ua);if(!a)return!1;if(a=Object(va.a)(384,a.Dh))if(a.RDh=
!0,a.W8d())return!1;return!a||5!==a.proofingType}Orh(a,b){if(Pa.a.Va(b))return b;b=Array.clone(b);for(var c=b.length-1;0<=c;c--){var f=b[c];f&&f.Dh||(Z.ULS.sendTraceTag(41300897,324,15,"Received malformed ErrorRange: {0}. Filtering it out.",f?"Null error details":"Null range"),Array.removeAt(b,c))}if(!b.length)return b;ul.d(b);c=[];this.xUh&&Array.addRange(c,this.Zq.VPa(a));c=ul.a(c);for(f=a=0;f<b.length&&a<c.length;){let l=b[f];const x=c[a];l.begin<x.end&&x.begin<l.end?Array.removeAt(b,f):l.end<
x.end?f++:a++}return b}AAf(a,b){let c=!1;for(const f of b){b=f.Dh;c=1===b.proofingType||c;let l=a.xqb(f.begin);l.Ap=new Gp(l,b);l.isFromErrorRangeSplit=!0;l=a.xqb(f.end);l.HK=!0;l.isFromErrorRangeSplit=!0}c&&(a.oub=!1)}Nbh(a,b){if(!Pa.a.Va(b)){a=a.Ra;for(const c of b){b=a.jS(c.begin);const f=a.jS(c.end);b&&b.Ap&&f&&f.HK?(b.Ap=null,f.HK=!1):(b=String.format("Could not find and remove ErrorRange from CHPs. Cp Begin: {0}, Cp End: {1}",c.begin,c.end),Z.ULS.sendTraceTag(37532355,324,10,b))}}}N3h(a){this.Pa.addHandler("OnErrorRangesChanged",
a)}c6c(a){if(this.Pa.J1b){const b=this.RE(a);this.Pa.raiseEvent("OnErrorRangesChanged",new Xr(a.id.toString(),b))}}}Object(e.a)(Kq,"ErrorRangeEditor",null,[1371]);var Ln=d(208);class Yr{constructor(){this.X4e=new Ln.a}contains(a,b){return a?this.X4e.contains(Ma.a.twh(a,b)):!1}add(a,b){a&&this.X4e.add(Ma.a.twh(a,b))}}Object(e.a)(Yr,"IgnoreAllKeywords",null,[1220]);var ke=d(209);class Gk extends ke.a{constructor(a,b,c){super(b,c);this.SF=a;this.bHa=this.L9=-1;this.CLd=0;this.textUnit=2}get lcid(){return this.SF}}
Object(e.a)(Gk,"ModifiedRange",ke.a,[]);class eq{constructor(a,b,c,f){this.iYh=a;this.LJ=b;this.mM=c;this.pqf=f}get X$c(){return this.pqf?this.pqf.instance:null}bIf(a,b){const c=[];if(Pa.a.Va(a)||Pa.a.Va(b))return c;if(1===b.length){b=b[0].lcid;for(var f of a)Array.add(c,new Gk(b,f.begin,f.end))}else{a=Array.clone(a);a.reverse();f=0;do{var l=b[f];let x=l.lcid;for(l=l.end;0<a.length&&l>a[a.length-1].begin;){const F=a.pop(),R=F.end,fa=Math.min(R,l);R>l&&a.push(new ke.a(l,R));Array.add(c,new Gk(x,F.begin,
fa))}f++}while(0<a.length&&f<b.length);Z.ULS.shipAssertTag(37836432,324,!a.length,"Did not process all modified ranges in the stack")}return c}xNi(a,b,c,f){let l,x;({Sre:l,yre:x}=eq.h3f(a,c,b));c=0;let F=a.begin,R=a.end;const fa=this.X$c;let wa=!1;fa?(c=fa.findEndBoundary(b,R-1,x),f||-1!==c||this.tjg(b,a)?c=-1===c?x:c:wa=!0):wa=!0;if(wa)return this.g9f(a,b,this.mM.BVg,l,x);if(!l)for(;" "===b.charAt(l)&&l<b.length;)l++;a=Math.max(fa.findBeginBoundary(b,F,l),l);return ke.a.createTextRange(a,c)}wNi(a,
b,c){return this.H0f(a,b,c,this.mM.BVg)}vNi(a,b){if(!a||Pa.a.Va(b))return a;let c=a.begin,f=a.end,l=!1;for(const x of b){if(a.end<=x.begin)break;a.begin>x.begin&&a.begin<x.end&&(c=x.begin,l=!0);a.end>x.begin&&a.end<x.end&&(f=x.end,l=!0)}return l?ke.a.createTextRange(c,f):a}S9k(a,b){if(!a||!b)return!1;const c=a.begin;a=a.end;return!Ma.a.Vub(b.substring(c,a))&&!Ma.a.Vsi(b,c,a)}hZi(a,b,c){if(!a||!c||Pa.a.Va(b))return 0;a=ul.c([a],b);b=0;for(const f of a)b+=this.iYh.yfg(c,f.begin,f.end);return b}k_h(a,
b,c,f){if(a&&b){var l=a.begin,x=a.end,F=this.mM.kgk;if(0>=F)a.L9=l,a.bHa=x;else if(F=this.H0f(a,b,f,F)){b=a.lcid;f=F.begin;F=F.end;if(0>f||this.voh(f,l,b,c))f=l;this.voh(x,F,b,c)&&(F=x);a.L9=f;a.bHa=F}else a.L9=l,a.bHa=x}}tjg(a,b){return this.X$c?-1!==this.X$c.findEndBoundary(a,b.begin,b.end):!1}voh(a,b,c,f){if(a>=b)return!0;if(1>=f.length)return!1;a=this.bIf([new ke.a(a,b)],f);return 1!==a.length||a[0].lcid!==c}H0f(a,b,c,f){if(!a||!b||0>f)return null;let l;({Sre:c,yre:l}=eq.h3f(a,c,b));return this.g9f(a,
b,f,c,l)}g9f(a,b,c,f,l){return ke.a.createTextRange(this.LJ.uRi(b,c,a.begin,f),this.LJ.bRi(b,c,a.end,l))}static h3f(a,b,c){let f;f=0;c=c.length;if(Pa.a.Va(b))return{Sre:f,yre:c};let l=a.begin;a=a.end;let x=!1,F=!1;for(const R of b)if(!x&&R.end<=l?f=R.end:x=!0,!F&&R.begin>=a&&(c=R.begin,F=!0),x&&F)break;return{Sre:f,yre:c}}}Object(e.a)(eq,"ModifiedExpandRangeHelper",null,[1369]);var Hp=d(338);class Lq{constructor(a,b){this.Utd=null;this.og=a;this.LJ=b;this.WF=Ya.ParagraphReader.text(this.og);this.iqf=
[]}Wgj(a,b){return this.ONc(this.LJ.iZb(this.WF,a,b))}ONc(a){return a?this.P1d(a.begin,a.end):null}P1d(a,b){this.Utd=this.Utd||this.LJ.mLc(this.og);return this.LJ.ONc(a,b,this.WF,this.Utd)}gCa(a,b){(a=this.P1d(a,b))&&Array.add(this.iqf,a)}V_b(){return Array.clone(this.iqf)}}Object(e.a)(Lq,"ValidatedRangeContainer",null,[]);class So{constructor(a,b,c,f,l,x){this.lm=a;this.LJ=b;this.Pc=c;this.mM=f;this.VUh=l;this.ESh=x}Krb(a){return new Lq(a,this.LJ)}k7h(a){const b=a.eRd.currentNode;var c=a.Trh.currentNode;
const f=a.T1g;a=this.ora(b);const l=this.Krb(b);c=this.ora(c);for(var x of c)l.gCa(f+x.begin,f+x.end);Array.addRange(a,l.V_b());if(x=l.Wgj(f,f))Array.add(a,x),this.uDe(b,x,0);b.A_=a}l7h(a,b,c){var f=a.A_;if(Pa.a.Va(f)||f[f.length-1].end<=c)this.YCc(b);else{var l=[],x=this.Krb(a),F=this.Krb(b);for(const R of f)if(f=R.end,f>c){const fa=R.begin;fa<c?(x.gCa(fa,c),F.gCa(0,f-c)):F.gCa(fa-c,f-c)}else Array.add(l,R);c=x.V_b();Array.addRange(c,l);a.A_=c;b.A_=F.V_b();a.rjc();b.rjc()}}M3k(a){Ya.ParagraphReader.Wd(a)&&
!this.LJ.wRa(a)&&(this.lm.$Ld(a),this.oEe(a,[new ke.a(0,Ya.ParagraphReader.textLength(a))]))}Klh(a,b){b&&a&&Ya.ParagraphReader.Wd(a)&&!this.LJ.wRa(a)&&!a.yB&&this.ISg(a,this.Krb(a).ONc(b),C.a.typing)}Mmh(a,b,c){a&&this.Klh(a,this.LJ.iZb(Ya.ParagraphReader.text(a),b,c))}oEe(a,b){if(Ya.ParagraphReader.Wd(a))if(Pa.a.Va(b))this.YCc(a);else{const c=this.Krb(a);for(const f of b)c.gCa(f.begin,f.end);a.A_=c.V_b()}}YCc(a){Ya.ParagraphReader.Wd(a)&&(a.A_=null)}Jfd(a,b,c=null){if(Ya.ParagraphReader.Wd(a)&&!a.yB&&
!Pa.a.Va(b)){ul.d(b);var f=null;if(this.mM.dub||this.mM.sRa)f=R=>1===R.Dh.proofingType;f=this.lm.RE(a,f);for(var l=[],x=0,F=0;F<f.length&&x<b.length;){const R=b[x],fa=f[F];R.end<=fa.begin?x++:(fa.end<=R.begin||fa.begin>=R.begin&&fa.end<=R.end&&(0!==fa.Dh.errorType||fa.begin!==R.begin)&&Array.add(l,fa),F++)}this.lm.wHa(a,l);f=this.ora(a);b=ul.b(f,b);c&&(c=ul.c(f,[c]),0<c.length&&(b=ul.e(b,c)));this.oEe(a,b)}}ora(a){return Ya.ParagraphReader.Wd(a)?a.A_||[]:[]}q9h(a,b,c,f,l=0){const x=a.node;if(Ya.ParagraphReader.Wd(x)&&
!this.LJ.wRa(x)&&!x.yB){var F=Ya.ParagraphReader.text(x),R=a.Qa,fa=a.Kb+f;this.VUh?(R=a.Qa+b,fa=a.Kb-c+f):this.ESh&&(b=this.Pc.Dj,0<=f&&b&&fb.SelectionEditor.Kg(b)&&(b=b.Qa,0<=b&&b<=F.length&&(b=this.LJ.iZb(F,b,b))&&b.begin>=R&&b.end<=fa&&(R=b.begin,fa=b.end)));b=this.Krb(x);c=null;0<=f&&(c=b.P1d(R,fa));c||(c=this.LJ.iZb(F,R,fa));0<=f?this.ISg(x,c,l):this.fvl(x,a.Qa,a.Kb,c,b,f,l)}}ISg(a,b,c){if(b){var f=this.ora(a);Array.add(f,b);a.A_=f;a.rjc();this.uDe(a,b,c)}}fvl(a,b,c,f,l,x,F){const R=this.ora(a),
fa=[];if(R.length)if(R[R.length-1].end<b)if(f)Array.addRange(fa,R);else return;else{for(const wa of R)wa.end<b?Array.add(fa,wa):wa.begin>=c?l.gCa(wa.begin+x,wa.end+x):wa.begin<b?wa.end>c?l.gCa(wa.begin,wa.end+x):l.gCa(wa.begin,b):wa.end>c&&l.gCa(b,wa.end+x);Array.addRange(fa,l.V_b())}f&&(Array.add(fa,f),this.uDe(a,f,F));a.A_=fa;a.rjc();this.lm.c6c(a)}uDe(a,b,c){const f=this.lm.RE(a,x=>x.begin<=b.end&&x.end>=b.begin);if((c===C.a.iJd||c===C.a.typing||c===C.a.cut||c===C.a.paste)&&1===f.length&&f[0].Dh){c=
f[0].Dh;var l=sa.a.le(c.lcid);l=l?l.name:So.BFh;const x=Object(Fa.a)(Hp.a,c)?c.typeId:So.OFh;Z.ULS.sendTraceTag(40486211,375,50,"ManualEdits CritiqueId:{0}, CultureTag:{1}",x,l);c.RDh&&Z.ULS.sendTraceTag(40486212,375,50,"ClickNoAction CritiqueId:{0}, CultureTag:{1}",x,l)}this.lm.wHa(a,f)}}So.OFh="";So.BFh="UNKNOWN";Object(e.a)(So,"ModifiedRangeEditor",null,[1368]);class fq{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa=null){this.lm=a;this.gz=b;this.QRb=c;this.FJ=f;this.y0a=l;this.xLa=x;this.LJ=F;this.G1a=
R;this.AYe=fa;this.Z3e=Xa||fq.lDi;this.Gtf=!1;wa.execute(lb=>{this.Gtf=!!lb})}GAh(a){if(a&&Ya.ParagraphReader.Wd(a)&&a.ROc){let b=null;this.AYe.esa&&(b=c=>!!c.Dh&&1===c.Dh.proofingType);a.oub=Pa.a.Va(this.gz.ora(a))&&Pa.a.Va(this.lm.RE(a,b))}}o7i(a,b){var c=this.q7i(a,b);if(Pa.a.Va(c))return[];const f=Ya.ParagraphReader.text(a).replace("\u00a0"," "),l=this.lm.RE(a),x=this.x_k(a,l),F=x&&this.Yui(a),R=this.LJ.A2f(a),fa=ul.e(this.LJ.z2f(a),R);c=this.G2i(c,b,f,fa,l,x,F);if(Pa.a.Va(c))return[];b=this.y0a.A5i(a);
c=this.xLa.bIf(c,b);if(Pa.a.Va(c))return[];this.eCk(a,f,c);a=this.gz.ora(a);for(const wa of c)this.xLa.k_h(wa,f,b,R),wa.CLd=this.xLa.hZi(wa,a,f),x&&(F||this.xLa.tjg(f,wa))&&(wa.textUnit=4);return c}UQi(a){if(this.Z3e()||!a||""===a.sa(bb.a.Zp,""))return null;var b=this.G1a.kZb;if(!b||!fb.SelectionEditor.Kg(b)||b.node!==a||!this.Kqj(a))return null;b=b.Qa;return this.LJ.iZb(Ya.ParagraphReader.text(a),b,b)}p9h(a,b,c,f,l,x,F=0){this.FJ.Kc(a.node).Ze()&&(this.gz.q9h(a,b,c,x,F),this.QRb.axl(a,f,l))}Kqj(a){const b=
ul.a(this.gz.ora(a));if(!b.length)return!1;a=ul.a(this.lm.RE(a));let c=0,f=0;for(;c<a.length&&f<b.length;){const l=b[f],x=a[c];l.begin>=x.begin&&l.end<=x.end?f++:c++}return f!==b.length}q7i(a,b){if(!a||a.P7d)return null;a=this.gz.ora(a);return a.length&&b?ul.b(a,[b]):a}x_k(a,b){return this.Gtf&&this.AYe.esa?a.KNb||!b.length||Pa.a.any(b,c=>!!c.Dh&&2===c.Dh.pAg):!1}Yui(a){if(!a.KNb||this.Z3e())return!0;var b;(b=this.G1a.kZb)&&b.node===a?(a=this.gz.ora(a),b=b.Qa<a[a.length-1].begin):b=!0;return b}G2i(a,
b,c,f,l,x,F){let R=[];for(const fa of a)a=x?this.xLa.xNi(fa,c,f,F):this.xLa.wNi(fa,c,f),(a=this.xLa.vNi(a,l))&&Array.add(R,a);R=ul.a(R);b=ul.f(f,b);return ul.b(R,b)}eCk(a,b,c){const f=[];for(let l=c.length-1;0<=l;l--){const x=c[l];this.xLa.S9k(x,b)||(Array.removeAt(c,l),Array.add(f,x))}this.gz.Jfd(a,f)}static lDi(){return Md.a.orj(Gb.App.Fb.FF.$yg)}}Object(e.a)(fq,"ParagraphProofingFacade",null,[1367]);var Wj=d(1021);class op{constructor(){this.qOc=this.FOc=this.activity=null}endActivity(a){this.activity&&
(this.activity.properties.$("EndReason",a),this.activity.end())}}Object(e.a)(op,"EditorServiceAPIRequest",null,[]);class Zs extends op{constructor(){super();this.Uwa=this.request=null}}Object(e.a)(Zs,"ProofingConfigV2Request",op,[]);class Zr{constructor(a,b,c,f,l){this.Lcid=a;this.AppId=b;this.LanguageId=c;this.LanguageUXId=f;this.Descriptors=l}}Object(e.a)(Zr,"ProofingConfigV2RequestObject",null,[]);var To;(function(a){a[a.success=0]="success";a[a.partialSuccess=1]="partialSuccess";a[a.error=2]=
"error";a[a.disabled=3]="disabled"})(To||(To={}));Object(e.b)("ResponseStatus",To);var io=d(2);class $r{constructor(a,b,c,f,l){this.ZLb=a;this.hd=b;this.UPb=c;this.CSh=f;this.yyf=u.AFrameworkApplication.lcid;this.jfa=Gb.App.mode;this.bqc={};this.lPb=new Ic.a;this.wSh=l}init(){this.b$c(this.yyf)}b$c(a){if(!(a.toString()in this.bqc||u.AFrameworkApplication.Xg))try{this.CSh.eli(a).continueWith(b=>{!b.result||this.lPb.Jb(a.toString())&&this.lPb.ga(a.toString())||this.BZk(a)},3)}catch(b){Z.ULS.sendTraceTag(36782929,
375,10,"PopulateConfigByLanguageId failed with exception: {0}",b)}}BZk(a){var b=new Wj.a;const c=sa.a.le(a).name,f=sa.a.le(this.yyf).name;c&&c.length&&f&&f.length&&(b=Object.assign(new Zs,{request:new Zr(a,this.cXd(),c,f,this.UPb.descriptors),activity:this.hd.Bp(C.a.TSk),Uwa:b,FOc:Object(D.a)(this,this.Pfc,"processSuccessResponse"),qOc:Object(D.a)(this,this.Nfc,"processFailResponse")}),this.lPb.$(a.toString(),!0),this.ZLb.gx(2,fe.c(b.request),b))}Pfc(a,b){if(!a||!a.request)return!1;this.lPb.$(a.request.Lcid.toString(),
!1);if(a.request.Lcid.toString()in this.bqc)return a.endActivity("RequestSucceeded"),!0;let c=null;if(b&&b.length)try{c=fe.a(b)}catch(f){Z.ULS.sendTraceTag(36811152,375,10,"Parse failed with exception: {0}",f)}if(!c||1===c.ResponseStatus)return b=c?To[c.ResponseStatus]:"EmptyResponse",Z.ULS.sendTraceTag(37343687,375,50,"Failed to get proofing config, language {0}, Reason {1}",a.request.LanguageId,b),a.endActivity(b),!1;a.endActivity("RequestSucceeded");b=c.CritiqueCategoryInfoList;this.wSh.filter(b);
Z.ULS.sendTraceTag(35240099,375,50,"Get proofing config. CritiqueCategoryInfoList is null: {0}, Length of CritiqueCategoryInfoList: {1}, languageId: {2}",!b,b?b.length:0,a.request.LanguageId);this.bqc[a.request.Lcid.toString()]=b;return!0}Nfc(a){a&&(a.request&&this.lPb.$(a.request.Lcid.toString(),!1),a.Uwa.Bg(!1),Z.ULS.sendTraceTag(35240128,375,10,"Failed to get proofing config, language {0}",a.request.LanguageId),a.endActivity("RequestFailed"))}request(a){return io.Task.wt(this.bqc[a.toString()])}cXd(){const a=
X.a[this.jfa];return a.charAt(0).toUpperCase()+a.substr(1)+"_Online"}}Object(e.a)($r,"ProofingConfigV2Manager",null,[1224]);class Mm{constructor(){this.Value=this.Name=null}static create(a,b){return Object.assign(new Mm,{Name:a,Value:b})}static H5d(){Object.assign(new Mm,{Name:"IsCompliant",Value:void 0});Object.assign(new Mm,{Name:"LicenseType",Value:"NoLicense"});Object.assign(new Mm,{Name:"IsGoLocal",Value:void 0})}}Object(e.a)(Mm,"Descriptor",null,[]);class gq{constructor(a,b){this.Vxa=[];this.jb=
a;this.J1e=b}get descriptors(){if(!this.Vxa.length)try{this.H5d()}catch(a){const b=String.format("Message: {0}. Stack: {1}",a.message,a.stack);Z.ULS.sendTraceTag(33952285,375,10,b)}return this.Vxa}H5d(){Array.clear(this.Vxa);var a=this.jb.ka("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled").toString();Array.add(this.Vxa,Object.assign(new Mm,{Name:"IsGoLocal",Value:this.jb.ka("IsGoLocalEnvironment").toString()}));Array.add(this.Vxa,Object.assign(new Mm,{Name:"IsCompliant",Value:a}));
if(this.J1e.Hae||this.J1e.sRa)a=this.jb.ka("IsSubscriptionForProofingUser")?"Subscription":"NoLicense",Array.add(this.Vxa,Object.assign(new Mm,{Name:"LicenseType",Value:a}));this.x8h();this.E8h()}E8h(){var a=fe.b(this.jb.appSettings.SessionStartInfoJson.toString());var b=a.Host||"";const c=a.Ring||"";a=a.WACDatacenter||"";""!==c&&""!==b&&(b=c+"-"+b,Array.add(this.Vxa,Object.assign(new Mm,{Name:"CustomAudience",Value:b})));""!==a&&Array.add(this.Vxa,Object.assign(new Mm,{Name:"Origin",Value:a}))}x8h(){const a=
this.AQi(this.jb.Ha("FlightId"));let b;0<a.length&&(b=Pa.a.join(a,";"),Array.add(this.Vxa,Object.assign(new Mm,{Name:"FlightIds",Value:b})),Z.ULS.sendTraceTag(33952287,375,50,"FlightCount: [{0}], flightIds: [{1}]",a.length,b))}AQi(a){const b=[];if(a&&""!==a){a=a.split(";");for(let c=0;c<a.length;c++)-1<a[c].toLowerCase().indexOf("editorservice")&&Array.add(b,a[c])}return b}}Object(e.a)(gq,"ProofingDescriptors",null,[1219]);class Ip{constructor(a,b){this.sRa=this.dub=this.sBd=!1;this.$xd=this.Zxd=
0;this.Bvc=a.ka("ProofingWithEditorServiceIsEnabled");this.nMh=a.ka("GrammarCheckIsEnabled");this.YRa=a.ka("ProofingSettingIsEnabled");this.e$d=a.ka("ProofingSecondaryContextualMenuIsEnabled");this.Asc=a.ka("EditorServiceSuggestionDescriptionsIsEnabled");a.ka("NewProofingExperienceEnabled");this.mYh=a.ka("WritingStyleIsEnabled");this.mKh=a.ka("DoNotCheckThisIssueEnabled");this.VNh=a.ka("IgnoreProofingCommandIsEnabled");this.esa&&(this.sBd=!1,b.execute(()=>{this.sBd=!0}));2===this.$da?(this.$xd=2,
this.Zxd=3):(this.$xd=a.Ec("NumberOfWordsToProofAroundModifiedRanges",1),this.Zxd=a.Ec("NumberOfWordsAsContextAroundProofedRanges",0))}get Gtg(){return this.VNh}get esa(){return 2===this.$da&&this.nMh}get Hae(){return this.esa&&this.mYh}get i8d(){return this.mKh&&this.e$d&&this.YRa}get LEj(){return this.Asc}get $da(){return this.Bvc?2:0}get kgk(){return this.Zxd}get BVg(){return this.$xd}get isLoaded(){return!this.Bvc||!this.esa||this.sBd}}Object(e.a)(Ip,"ProofingFeatureConfiguration",null,[1366]);
class nr extends op{constructor(){super();this.request=null}}Object(e.a)(nr,"ProofingFeedbackLoopRequest",op,[]);class Jp{constructor(a,b,c){this.ZLb=a;this.hd=b;this.UPb=c}FZk(a){a.Descriptors=this.UPb.descriptors;a=Object.assign(new nr,{request:a,activity:this.hd.Bp(C.a.$Zk),FOc:Object(D.a)(this,this.Pfc,"processSuccessResponse"),qOc:Object(D.a)(this,this.Nfc,"processFailResponse")});this.ZLb.gx(1,fe.c(a.request),a)}Pfc(a){if(!a)return!1;a.endActivity("RequestSucceeded");return!0}Nfc(a){a&&(Z.ULS.sendTraceTag(38847138,
375,15,"Proofing feedback failed"),a.endActivity("RequestFailed"))}}Object(e.a)(Jp,"ProofingFeedbackLoopManager",null,[1365]);class zo extends op{constructor(){super();this.Uwa=this.request=null}}Object(e.a)(zo,"ProofingLanguageInfoRequest",op,[]);class $s{constructor(a){this.AppId=a}}Object(e.a)($s,"ProofingLanguageInfoRequestObject",null,[]);class em{constructor(a,b){this.ZLb=a;this.hd=b;this.jfa=Gb.App.mode;this.doa=new ua.ScriptSharpLegacyMap;this.pfa=null;this.u1a=0}eli(a){if(this.doa.Jb(a))return io.Task.wt(!0);
this.tGe();return this.pfa.CWRCo(()=>!!this.pfa.result&&this.pfa.result.Jb(a),3)}fli(a,b){if(this.doa.Jb(a))return io.Task.wt(this.geg(a,b));this.tGe();return this.pfa.CWRCo(()=>this.geg(a,b),3)}j0i(a){if(0<this.doa.count)return io.Task.wt(this.g8f(a));this.tGe();return this.pfa.CWRCo(()=>this.g8f(a),3)}NSk(){const a=new Wj.a;u.AFrameworkApplication.Xg&&a.Bg(null);const b=Object.assign(new zo,{request:new $s(X.a[this.jfa]+"_Online"),activity:this.hd.Bp(C.a.USk),Uwa:a,FOc:Object(D.a)(this,this.Pfc,
"processSuccessResponse"),qOc:Object(D.a)(this,this.Nfc,"processFailResponse")});this.ZLb.gx(0,fe.c(b.request),b);this.u1a+=1;return a.task}Pfc(a,b){let c=null;if(!a)return!1;try{c=fe.a(b)}catch(l){Z.ULS.sendTraceTag(37025730,375,10,"Failed to parse language info response with exception {0}",l)}if(c&&0===c.ResponseStatus&&c.SupportedLanguages&&0<c.SupportedLanguages.length){for(var f of c.SupportedLanguages)(b=sa.a.le(f.LanguageId))&&0!==f.SupportedTextUnit&&this.doa.$(b.LCID,f);a.Uwa.Bg(this.doa);
a.endActivity("RequestSucceeded");return!0}a.Uwa.Bg(null);f=c?To[c.ResponseStatus]:"EmptyResponse";Z.ULS.sendTraceTag(38847139,375,15,f);a.endActivity(f);return!1}Nfc(a){a&&(a.Uwa.Bg(null),Z.ULS.sendTraceTag(38847168,375,15,"RequestFailed"),a.endActivity("RequestFailed"))}geg(a,b){if(!this.doa||!this.doa.Jb(a))return 0;a=this.doa.ga(a).SupportedTextUnit;return 0!==(b&a)?b:this.L2i(b,a)}L2i(a,b){for(a=b&(a|a-1);a;){b=a&a-1;if(!b)break;a=b}return a}g8f(a){const b=new Ha.a;if(!this.doa)return b;for(let c of this.doa)c.value.SupportedCritiqueTag&
a&&b.add(c.key);return b}tGe(){if(!this.pfa||5===this.pfa.status||4===this.pfa.status||6===this.pfa.status&&!this.pfa.result)this.pfa=this.NSk(),Z.ULS.sendTraceTag(38319180,375,1===this.u1a?50:15,"Schedule a new task for LanguageInfo request. IsRetried: {0}, Count: {1}",1!==this.u1a,this.u1a)}}Object(e.a)(em,"ProofingLanguageInfoManager",null,[1364]);class at{constructor(a,b){this.MOh=a;this.elb=b}track(a,b=null){this.MOh&&this.elb.track(a(),b)}}Object(e.a)(at,"ProofingMetricsAggregator",null,[1223]);
class Kp{YBf(a,b){a&&Ya.ParagraphReader.Wd(a)&&!Pa.a.Va(b)&&(ul.d(b),a.dJb=ul.e(a.dJb,b))}axl(a,b,c){if(b){var f=a.Kb;a=a.node.dJb;for(let x=0;x<a.length;x++){var l=a[x];const F=l.begin;l=l.end;0>b?l>c&&(F>=f?a[x]=new ke.a(F+b,l+b):F>=c&&l<=f?(Array.removeAt(a,x),x--):a[x]=new ke.a(F<c?F:c,l<=f?c:l+b)):a[x]=new ke.a(F>f?F+b:F,l>f?l+b:l)}}}}Object(e.a)(Kp,"UnsupportedLanguageRangeEditor",null,[1362]);var t=d(1211),N=d(459),ha=d(242),Aa=d(441),Ra=d(1048),yb=d(650);class Sb{constructor(){this.Wx=this.iXa=
null}}Object(e.a)(Sb,"ClientRequestManagerStateObject",null,[]);class uc{constructor(a,b){this.request=a;this.response=b}}Object(e.a)(uc,"SpellCheckRequestResponseTuple",null,[]);class Zc{constructor(){this.$Ch=0;this.STf=this.Gla=this.paragraphNode=this.range=null;this.userAction=0;this.NH=null;this.$da=0;this.overriddenCritiqueTypeOptions=this.descriptors=null}Stg(){const a=Ya.ParagraphReader.text(this.paragraphNode);if(!a||!this.Gla)return a===this.Gla;let b=this.range.begin,c=this.range.end;return Ma.a.vId(a.substring(b,
c),this.Gla.substring(b,c))}isValid(){return this.paragraphNode.isConnected&&this.Stg()}}Object(e.a)(Zc,"SpellCheckRequest",null,[]);var ed=d(649),Gd=d(822),ze=d(823);class re{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd){this.bEd=new oa.a;this.HPb=[];this.Lqc=0;this.Yvc={};this.B$=null;this.AXe=Number.POSITIVE_INFINITY;this.Lpc=0;this.h6=re.H7a;this.n1a=null;this.pxc=0;this.Zlb=[];this.iqc=null;this.qTh=!1;this.jPb=[];this.bAd=[];this.xSh=0;this.BSh=c.ka(re.MBk);this.GSh=c.ka(re.TBk);
this.ySh=c.appSettings[re.KBk];this.vSh=c.ka(re.JBk);this.FSh=c.ka(re.RBk);this.lH=f;this.jfa=Gb.App.mode;this.lm=a;this.gz=b;this.QRb=wa;this.Ei=l;this.cQh=c.Ec(re.PBk,re.OBk);this.DSh=Lb;this.jk=x;this.$e=F;this.FJ=R;this.LJ=fa;this.Bzd=Xa;this.zvc=lb;this.Qh=new t.a;this.ASh=c.ka(re.LBk);this.yvc=lc;this.NBk=Ec;this.HIc=kc;this.Bvc=c.ka(re.SBk);this.UPb=Jc;this.uSh=Dc;this.bjb=Wd;this.ifa=xe;this.Rd=Sd}get o1g(){return this.jPb}set o1g(a){this.jPb=a}get hKc(){return u.AFrameworkApplication.Xg}get KWb(){return this.bjb.instance}suspend(){this.pxc++}resume(){if(0>=
--this.pxc&&(this.pxc=0,0<this.Zlb.length&&!this.iqc)){const a=this.ifa.isCompleted(4)?0:1;this.iqc=new He.a(a,1,1,Object(D.a)(this,this.Cfl,"spellCheckSuspendedNodes"),74);this.Rd.Gb(this.iqc)}}Cfl(){this.iqc=null;const a=Pa.a.clone(this.Zlb);Array.clear(this.Zlb);Date.now();let b=null;for(const c of a)b=this.Tyh(c,!0,b);b&&b.dispose();this.qTh||Date.now()}RQ(a,b=!1){(a=this.Tyh(a,b,null))&&a.dispose()}Tyh(a,b,c){switch(this.Yqa(a,b)){case 1:Pa.a.contains(this.Zlb,a)||Array.add(this.Zlb,a);break;
case 2:c=this.doSpellCheck(a,c);this.executeNextRequest();break;case 3:this.executeNextRequest()}return c}Yqa(a,b){return!a||this.hKc||!this.lH.Ed.isEditingAllowed&&!this.lH.Ed.vy?0:!b&&0<this.pxc||!this.HIc.isLoaded?1:!Ya.ParagraphReader.Wd(a)||!a.isConnected||a.anchor.jI||a.P7d||a.IV||a.yB?3:this.B$&&Pa.a.any(this.B$,c=>c.paragraphNode===a)?0:Pa.a.any(this.HPb,c=>c.paragraphNode===a)||!this.$e.Vs(this.FJ.Kc(a))?3:2}doSpellCheck(a,b){const c=(wa,Xa)=>{this.gz.Jfd(wa,Xa)};var f=this.LJ.mLc(a);let l=
0<f.length;b=this.$ze(b,a,f,c);(f=this.yvc.UQi(a))&&this.Zyi(a);const x=this.yvc.o7i(a,f),F=Ya.ParagraphReader.text(a),R=a.KNb,fa=[];for(let wa=x.length-1;0<=wa;wa--){const Xa=x[wa];Xa.begin!==Xa.end&&(this.bEd.contains(Xa.lcid)?Array.add(fa,Xa):(this.kvi(a,F,f,Xa,R),Array.removeAt(x,wa)))}l=0<fa.length||0<x.length||l;b=this.$ze(b,a,fa,Object(D.a)(this.QRb,this.QRb.YBf,"addUnsupportedRanges"));b=this.$ze(b,a,x,c);l&&this.yvc.GAh(a);return b}je(a){const b=this.jk.je(7,C.a.cTe);b.fd(a);return b}$ze(a,
b,c,f){Pa.a.Va(c)||(a=a||this.je(b),f(b,c));return a}Zyi(a){const b=new He.a(4,1,500,Object(D.a)(this,this.recheckParagraphTask,"recheckParagraphTask"),48);b.customData=a;this.Rd.Gb(b)}pfk(a,b){b="b"+b.range.begin+"e"+b.range.end+"i"+b.range.lcid+"l"+b.Gla.length+b.paragraphNode.id;this.Yvc[b]=(this.Yvc[b]||0)+1;this.Lqc=Math.max(this.Yvc[b],this.Lqc);return this.Lqc>re.ubk?(Z.ULS.sendTraceTag(22390425,324,15,"Infinite proofing loop detected, cleaning paragraph proof state"),this.Lqc=0,this.Yvc={},
this.gz.YCc(a),!1):!0}kvi(a,b,c,f,l){const x=new Zc;x.$Ch=u.AFrameworkApplication.lcid;x.Gla=b;x.range=f;x.paragraphNode=a;x.STf=c;x.userAction=l?1:0;const F=this.HIc.YRa;F&&this.KWb&&(x.overriddenCritiqueTypeOptions=this.KWb.VXd());this.pfk(a,x)&&this.tej(x.range.lcid,x.range.textUnit).continueWith(R=>{R=R.result;x.$da=2===this.HIc.$da?0!==R?2:0:this.xSh;x.range.textUnit=R;x.descriptors=this.UPb.descriptors;this.LKi(x);F&&2===x.$da&&this.uSh.b$c(x.range.lcid)},8).continueWith(()=>{this.executeNextRequest()})}tej(a,
b){return 2===this.HIc.$da?this.NBk.fli(a,b):io.Task.wt(b)}LKi(a){a.NH=new Date;Array.enqueue(this.HPb,a)}recheckParagraphTask(a){this.RQ(a.customData)}executeNextRequest(){if(!this.hKc&&!this.B$){var a=[];do{if(!this.HPb.length)break;const b=Array.dequeue(this.HPb);b.isValid()&&Array.add(a,b)}while(a.length<this.cQh);0>=a.length?(this.B$=null,this.Dfl()):(this.B$=a,this.B$.sort((b,c)=>+b.NH-+c.NH),a=this.B$[0],this.zvc.track(+new Date-+a.NH,"ProofingRequestInQueue."+ed.a[a.userAction]),this.executeRequest(this.B$))}}Dfl(){for(var a=
0;a<this.jPb.length;a++)(0,this.jPb[a])();Array.clear(this.jPb);for(a=0;a<this.bAd.length;a++)(0,this.bAd[a])();Array.clear(this.bAd)}executeRequest(a){if(a&&a.length){var b=[];for(let c=0;c<a.length;++c){const f=yb.a.Nbj(this.BSh,a[c],this.jfa,this.GSh,this.FSh,this.vSh,this.ySh,this.Bvc);Array.add(b,f)}b=Gd.a.wsi(b,Gb.App.mode);this.Ei.vj(this.Bzd(),2,b,{"Content-Type":"application/json; charset=utf-8"},!1,3,Object(D.a)(this,this.Afl,"spellCheckSucceeded"),Object(D.a)(this,this.zfl,"spellCheckFailed"),
Object.assign(new Sb,{iXa:a,Wx:this.Qh.wi("WebServiceCall","Proofing")}),void 0,void 0,void 0,void 0,"29")}}Afl(a){if(!this.hKc){a=a.data;this.zvc.track(a.state.Wx.Dq,"ProofingRequestRoundtrip");var b=this.Qh.wi("DOMUpdate","Proofing");this.Bfl(a);this.zvc.track(b.Dq,"UpdateProofingResults")}}Bfl(a){N.a.mark(7798);this.B$=null;var b=a.state.iXa;if(({group:c}=ze.a.Qxh(a.Zd)).returnValue){var c=c.Responses;var f=({hVk:b,F_k:c}=this.kej(b,c)).returnValue;if(0<f.length){const l=this.je(f[0].request.paragraphNode);
try{for(const x of f){const F=x.request;this.lH.NKi(F.paragraphNode,()=>{this.Yak(x.response,F)})}}finally{l&&l.dispose()}}b.length?(this.lJd(a),this.Kze(b),this.USd()):this.GTk();this.lJd(a);for(const l of c)ha.PageStats.HSb(l);this.USd();this.executeNextRequest()}else this.Kze(b);N.a.mark(7799)}kej(a,b){let c,f;const l=[];c=[];f=[];for(let x=0;x<a.length;x++){const F=a[x];if(!F.paragraphNode.isConnected)continue;const R=b[x];if(5===R.classId){const fa=R.Fault;if(fa)switch(fa.Type){case 1:Z.ULS.sendTraceTag(22390429,
324,15,"Previous proofing char limit: {0}; char limit returned by server: {1}; proofing word length we tried {2}",this.AXe,fa.Limit,fa.AttemptedValue);this.AXe=fa.Limit;break;default:Z.ULS.sendTraceTag(22390431,324,10,"Unknown limit type violated")}else c.push(F)}else l.push(new uc(F,R));R.ServerPageStatsTrace&&f.push(R.ServerPageStatsTrace)}return{returnValue:l,hVk:c,F_k:f}}Yak(a,b){const c=b.paragraphNode;if(c.isConnected)if(c.yB)this.executeNextRequest();else{var f=this.je(c),l=this.DSh.bUk(a);
if(b.Stg()){var x=b.range;const F=[x];l.pdd(a)?(x=ul.a(this.lm.RE(c)),1!==b.userAction&&c.S9h()&&this.ASh&&(a=l.s2f(a,b,x)),this.gz.Jfd(c,F,b.STf),a=l.iOi(a,b,x),this.lm.zAf(c,a)):this.Gpj(c,x);this.yvc.GAh(c)}c.rjc();f.dispose();this.RQ(c)}else this.executeNextRequest()}Gpj(a,b){const c=[b];b=b.lcid;this.bEd.contains(b)||(Z.ULS.sendTraceTag(42004739,324,50,"LCID {0} unsupported for proofing",b),this.bEd.add(b));this.gz.Jfd(a,c);this.QRb.YBf(a,c)}zfl(a){a=a.data;if(!this.hKc){var b=a.state;this.zvc.track(b.Wx.Dq,
"ProofingRequestRoundtrip");this.Kze(b.iXa);this.lJd(a);this.USd()}}Kze(a){this.B$=a;a=new He.a(3,1,this.h6,Object(D.a)(this,this.retryCurrentRequest,"retryCurrentRequest"),49);this.Rd.Gb(a);++this.Lpc;this.h6*=re.pFe;this.h6>re.Ibc&&(this.h6=re.Ibc);4!==this.Lpc||this.Ei.eDa||(this.n1a=Gb.App.Fb.notificationBar.sAa(Box4Intl.Box4Strings.l_NotificationBarProofingUnavailave,!0),Gb.App.Fb.notificationBar.Rh(this.n1a),u.AFrameworkApplication.Zi.F7a(re.AFh,1),Z.ULS.sendTraceTag(7390529,324,15,"Proofing unavailable"),
this.Ei.izc(this))}GTk(){this.Lpc&&(this.Lpc=0,this.h6=re.H7a);this.n1a&&(Gb.App.Fb.notificationBar.removeEntry(this.n1a),this.n1a=null,this.Ei.rcd(this))}retryCurrentRequest(){this.executeRequest(this.B$)}yBb(){Gb.App.Fb.notificationBar.removeEntry(this.n1a);this.n1a=null;this.Ei.rcd(this)}rcc(){}get V$d(){return!this.Zlb.length&&!this.B$&&!this.HPb.length}lJd(a){ha.PageStats.g3a("SpellCheck",a.zt);(a=a.mj?a.mj[Aa.a.mAa]:null)&&ha.PageStats.E2a(Ra.a.Fh,a)}USd(){ha.PageStats.$Aa("SpellCheck")}}re.PBk=
"ProofingRequestsBatched";re.OBk=1;re.JBk="ProofingContextualResultsIsEnabled";re.RBk="ProofingTrackMetricsIsEnabled";re.MBk="ProofingInstrumentedAndContextualIsEnabled";re.TBk="ProofingWithOneSpellerIsEnabled";re.KBk="ProofingExperimentId";re.SBk="ProofingWithEditorServiceIsEnabled";re.LBk="ProofingFilterSpellCheckResultIsEnabled";re.AFh=11093;re.ubk=30;re.H7a=1E3;re.pFe=5;re.Ibc=72E6;Object(e.a)(re,"ProofingCheckOperator",null,[248,1363]);var ff=d(513);class ah{constructor(a){this.elb=a}iOi(a,b,
c){if(this.jFe(a)){const f={};a=this.d1f(b,a,c,f);this.x7h(b,f);return a}b&&this.y7h(b);return[]}x7h(a,b){this.elb.track(()=>Object.assign(new ff.a,{E:a.$da,C:a.range.CLd,F:b}))}y7h(a){this.elb.track(()=>Object.assign(new ff.a,{E:a.$da,C:a.range.CLd}))}Hug(a,b,c){return!a||Pa.a.all(a,f=>f.begin!==b||f.end!==c)}lyg(a,b,c){return!!a&&Pa.a.any(a,f=>b>=f.begin&&c<=f.end)}}Object(e.a)(ah,"AProofingResultsManager",null,[1379]);var aj=d(512),Df;(function(a){a[a.none=0]="none";a[a.spelling=1]="spelling";
a[a.grammatical=2]="grammatical";a[a.advanced=3]="advanced";a[a.informational=4]="informational";a[a.consistency=5]="consistency"})(Df||(Df={}));Object(e.b)("ProofingType",Df);class Fi extends ah{constructor(a,b,c,f=null){super(a);this.jb=f;this.VKh=b;this.mM=c}pdd(a){return a&&63===a.classId?!0:(Z.ULS.sendTraceTag(20993182,375,10,"null response or unexpected response"),!1)}jFe(a){return this.pdd(a)&&!!a.Critiques&&0<a.Critiques.length}d1f(a,b,c,f){const l=[];b=b.Critiques;for(const R of b)if(this.Pqj(b,
R)&&this.n8k(R)){var x=0<=a.range.L9?a.range.L9+R.Start:a.range.begin+R.Start;const fa=x+R.Length;var F=a.Gla.substring(x,fa);const wa=this.VKh.create(R,this.elb,this.jb);wa.lcid=a.range.lcid;wa.token=F;wa.originalText=a.Gla;wa.L9=a.range.L9;wa.bHa=a.range.bHa;a.range.end>=fa&&(F=new An(x,fa,wa),Array.add(l,F));this.Hug(c,x,fa)&&(x=1===wa.proofingType?Df[wa.proofingType]:wa.typeId,f[x]=x in f?f[x]+1:1)}return l}s2f(a,b,c){if(!this.jFe(a))return a;const f=[];for(const l of a.Critiques){const x=0<=
b.range.L9?b.range.L9+l.Start:b.range.begin+l.Start;this.lyg(c,x,x+l.Length)&&Array.add(f,l)}a.Critiques=f;return a}n8k(a){return 2!==aj.b(a)||!this.mM.sRa}Pqj(a,b){if(a)for(let c=0;c<a.length;c++)if(b.Start<=a[c].Start+a[c].Length&&b.Start+b.Length>=a[c].Start&&a[c].Priority<b.Priority)return!1;return!0}}Object(e.a)(Fi,"ProofingCheckResultsManager",ah,[]);var We=d(48),wi=d(90);class Mn{constructor(a,b,c,f,l,x,F){this.gtd=!1;F&&c.vM(Object(D.a)(this,this.XHk,"recheckAllParagraphs"));b.m2h(Object(D.a)(this,
this.$gk,"onAfterParagraphMerge"));l&&l.Bd(12).t6(Object(D.a)(this,this.xmk,"onParagraphDisconnected"));this.gz=a;this.TPb=f;this.lm=x}xmk(a,b){Ya.ParagraphReader.Wd(b.node)&&this.lm&&this.lm.c6c(b.node)}$gk(a,b){this.gz.k7h(b);this.RQ(b.eRd.currentNode)}U2b(a){this.gz.M3k(a);this.RQ(a)}XHk(a){if(2===a.mode&&(a=this.veg(a)))for(a=wi.a.qz(a);a.moveNext();)Ya.ParagraphReader.Lk(a.iterator)&&this.RQ(a.currentNode)}suspend(){this.TPb.suspend()}resume(){this.TPb.resume()}get V$d(){return this.TPb.V$d}get CKe(){return this.gtd}set CKe(a){if(this.gtd!==
a&&(this.gtd=a,a=this.veg(Gb.App.Fb))){var b=new We.GraphTransaction(2);try{b.set(a.yk);const c=wi.a.qz(a);for(;c.moveNext();)Ya.ParagraphReader.Lk(c.iterator)&&c.currentNode.Vu(16,!0)}finally{b&&b.dispose()}}}veg(a){return(a.Ed.isEditingAllowed||a.Ed.vy)&&a.Ed.en.Ro?a.Ed.en.rg:null}L0h(a){Array.add(this.TPb.o1g,a)}RQ(a){this.TPb.RQ(a,!1)}}Object(e.a)(Mn,"ProofingManager",null,[1222]);var Bn=d(1167),dn=d(648);class Uo extends dn.a{constructor(a){super(a);this.nRb=null}get proofingType(){return 1}get suggestions(){return this.nRb?
Array.clone(this.nRb):null}G5k(a){this.nRb=a}kJa(a,b=0){this.oqf.track(()=>Object.assign(new ff.a,{E:0,T:1,A:a,I:b}))}}Object(e.a)(Uo,"OfficeSpellerErrorDetails",dn.a,[]);class Ao extends ah{constructor(a){super(a)}pdd(a){return!!a.Errors}jFe(a){return this.pdd(a)&&0<a.Errors.length}d1f(a,b,c,f){let l=0;const x=[],F=b.Errors;for(let wa=0;wa<F.length;wa++){var R=F[wa],fa=Object.assign(new Uo(this.elb),{token:R.Word,errorType:R.Type,lcid:a.range.lcid});fa.G5k(Bn.a.uDh(b.Suggestions,wa*Bn.a.Oyg));const Xa=
R.Offset+a.range.begin;R=Xa+R.Word.length;fa=new An(Xa,R,fa);Array.add(x,fa);this.Hug(c,Xa,R)&&l++}f.spelling=l;return x}s2f(a,b,c){if(Pa.a.Va(c)||!a)return a;const f=[],l=[];for(let F=0;F<a.Errors.length;++F){const R=a.Errors[F];var x=R.Offset+b.range.begin;this.lyg(c,x,x+R.Word.length)&&(x=F*Bn.a.Oyg,Array.add(f,Bn.a.WQj(a.Suggestions,x)),Array.add(f,Bn.a.uDh(a.Suggestions,x)),Array.add(l,R))}a.Suggestions=f;a.Errors=l;return a}}Object(e.a)(Ao,"ProofingResultsManager",ah,[]);class pp{constructor(a,
b,c){this.Avc=new Me.a;this.jZe=b;a.ka("ProofingWithEditorServiceIsEnabled")&&this.Avc.add(63,c.value);this.Avc.add(4,this.jZe)}bUk(a){if(this.Avc.Jb(a.classId))return this.Avc.ga(a.classId);Z.ULS.sendTraceTag(20747157,375,50,"Fallback ProofingResultsManager is resolved for response: {0}",a.classId);return this.jZe}}Object(e.a)(pp,"ProofingResultsManagerResolver",null,[1221]);class Xj{constructor(a=null,b=null){this.QC=this.Wc=null;this.PDd=a;this.QDd=b}get Nf(){!this.Wc&&this.PDd&&this.PDd.instance&&
(this.Wc=this.PDd.instance.instance);return this.Wc}get Emc(){!this.QC&&this.QDd&&this.QDd.instance&&(this.QC=this.QDd.instance.instance);return this.QC}uRi(a,b,c,f){if(!b)return c;" "!==a.charAt(c)&&(c=a.lastIndexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.lastIndexOf(" ",c-1);if(c<=f)break;" "===a.charAt(c+1)&&l--}c=Math.max(c,f);return" "===a.charAt(c)?c+1:c}bRi(a,b,c,f){if(!b)return c;0<c&&" "!==a.charAt(c-1)&&(c=a.indexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.indexOf(" ",c+1);if(-1===c)break;
" "===a.charAt(c-1)&&l--}return c=-1===c?f:Math.min(c,f)}wRa(a){return a.properties.sa(bb.a.wRa,!1)}z2f(a){a=Ya.ParagraphReader.text(a);let b;const c=[];for(;b=Xj.Ttj.exec(a);)Array.add(c,new ke.a(b.index+b[1].length,b.index+b[0].length));return c}A2f(a,b=!0,c=!1){let f=[],l=!1,x=!1,F=!1,R=!1,fa=-1;a=a.Ra;for(let Xa=0;Xa<a.length;Xa++){var wa=a.ga(Xa);wa.hyperlink?x=!0:wa.Nm&&(x=!1);b&&wa.formatting&&(F=wa.formatting.cache.URa);if(c&&(wa.HK&&(R=!1),wa.Ap)){const lb=Object(va.a)(384,wa.Ap.Dh);lb&&
(R=lb.sCa)}l!==(x||F||R||!!wa.blob)&&(wa=wa.cp,l?Array.add(f,new ke.a(fa,wa)):fa=wa,l=!l)}l&&(b=ke.a.createTextRange(fa,a.last.cp))&&Array.add(f,b);return f}mLc(a,b=!0,c=!1){return ul.e(this.z2f(a),this.A2f(a,b,c))}iZb(a,b,c){if(b===a.length)for(;0<b&&" "===a.charAt(b-1);)b--;b=a.lastIndexOf(" ",b-1)+1;c=a.indexOf(" ",c);0>c&&(c=a.length);return ke.a.createTextRange(b,c)}ONc(a,b,c,f){if(!c||""===c||0>a||a>=b||b>c.length)return null;f=f||[];a=Xj.G6f(a,b,c);for(var l=0;l<f.length;l++){var x=f[l];if(a<
x.begin)break;a<x.end&&(a=Xj.G6f(x.end,b,c))}b=Xj.c9f(b,c);for(l=f.length-1;0<=l;l--){x=f[l];if(b>x.end)break;b>x.begin&&(b=Xj.c9f(x.begin,c))}return(a=ke.a.createTextRange(a,b))&&a.QPj()?a:null}static G6f(a,b,c){for(;a<b&&Ma.a.yy(c.charCodeAt(a));)a++;return a}static c9f(a,b){for(;0<a&&Xj.DCj(a,b);)a--;return a}static DCj(a,b){a=b.charAt(a-1).toString();return a===te.AParagraphNode.uHc||a===te.AParagraphNode.cZ}}Xj.Ttj=RegExp("(^| )(?:[a-z+.-]+://\\S+|[a-z]:[/\\\\]\\S+|\\\\\\\\\\S+|mailto:\\S+)",
"ig");Object(e.a)(Xj,"ProofingTextUtility",null,[1361]);class Uk{constructor(){this.Da=null}get name(){return"Box4.Proofing"}Wb(a){this.Da=a;this.Da.register(Kq,"Box4.Proofing.ErrorRangeEditor").as("Box4.Proofing.IErrorRangeEditor").ma().na(()=>new Kq(this.Da.resolve("Box4.IParagraphReader"),H.a.instance.ga(14),H.a.instance.ga(70)));this.Da.register(So,"Box4.Proofing.ModifiedRangeEditor").as("Box4.Proofing.IModifiedRangeEditor").ma().na(()=>new So(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),
this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.ISelectionManager"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa.ka("MinimizeProofedRangesIsEnabled"),u.AFrameworkApplication.fa.ka("ProofingSetCentralWordRangeIsEnabled")));this.Da.register(Kp,"Box4.Proofing.UnsupportedLanguageRangeEditor").as("Box4.Proofing.IUnsupportedLanguageRangeEditor").ma().na(()=>new Kp);this.Da.register(eq,"Box4.Proofing.ModifiedExpandRangeHelper").as("Box4.Proofing.IModifiedExpandRangeHelper").ma().na(()=>
new eq(Wr.a.instance,this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.La("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(fq,"Box4.Proofing.ParagraphProofingFacade").as("Box4.Proofing.IParagraphProofingFacade").ma().na(()=>new fq(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),
this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.Proofing.IModifiedExpandRangeHelper"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),Dj.a.instance,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.La("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(Xj,"Box4.Proofing.ProofingTextUtility").as("Box4.Proofing.IProofingTextUtility").ma().na(()=>new Xj(this.Da.La("Box4.TrackChange.ITrackChangeManagerFactory"),this.Da.La("Box4.TrackChange.ITrackChangeReaderFactory")));
const b=()=>{const c=u.AFrameworkApplication.fa.Ha("ProofingWebServiceBase");return(void 0===c?Gb.App.webServiceBase:c)+"proofing.ashx?"+u.AFrameworkApplication.Zg};this.Da.register(Jq,"Box4.Proofing.EditorServiceRequestManager").as("Box4.Proofing.IEditorServiceRequestManager").ma().na(()=>new Jq(u.AFrameworkApplication.He,b));this.Da.register(em,"Box4.Proofing.ProofingLanguageInfoManager").as("Box4.Proofing.IProofingLanguageInfoManager").ma().na(()=>new em(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),
Sa.a.instance));this.Da.register(Jp,"Box4.Proofing.ProofingFeedbackLoopManager").as("Box4.Proofing.IProofingFeedbackLoopManager").ma().na(()=>new Jp(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),Sa.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors")));this.Da.register(Ip,"Box4.Proofing.ProofingFeatureConfiguration").as("Box4.Proofing.IProofingFeatureConfiguration").ma().na(()=>new Ip(u.AFrameworkApplication.fa,this.Da.La("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(1219,
"Box4.Proofing.IProofingDescriptors").ma().na(()=>new gq(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.Da.register(re,"Box4.Proofing.ProofingCheckOperator").as("Box4.Proofing.IProofingCheckOperator").ma().na(()=>new re(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),u.AFrameworkApplication.fa,Gb.App.Fb,u.AFrameworkApplication.He,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"),mg.a.instance,
this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),b,Ro.a.qV(4,1,new cq),this.Da.resolve("Box4.Proofing.IProofingResultsManagerResolver"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.resolve("Box4.Proofing.IParagraphProofingFacade"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingConfigV2Manager"),
this.Da.La("Box4.Proofing.ICritiqueTypeSettings"),pd.a.get_instance(),u.AFrameworkApplication.ue));this.Da.register(Ao,"Box4.Proofing.ProofingResultsManager").ma().na(()=>new Ao(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>")));this.Da.register(1220,"Box4.Proofing.IIgnoreAllKeywords").ma().na(()=>new Yr);this.Da.register(Fi,"Box4.Proofing.ProofingCheckResultsManager").ma().na(()=>new Fi(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),
this.Da.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa));this.Da.register(1221,"Box4.Proofing.IProofingResultsManagerResolver").ma().na(()=>new pp(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.ProofingResultsManager"),this.Da.Be("Box4.Proofing.ProofingCheckResultsManager")));this.Da.register(1222,"Box4.IProofingManager").ma().na(()=>new Mn(this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),
this.Da.resolve("Box4.IParagraphEditor"),this.Da.resolve("Box4.IAppFrame"),this.Da.resolve("Box4.Proofing.IProofingCheckOperator"),this.Da.pb("Box4.INotebookManager").gU,this.Da.pb("Box4.Proofing.IErrorRangeEditor"),4!==Gb.App.mode));this.Da.register(1223,"Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>").ma().na(()=>new at(u.AFrameworkApplication.fa.ka("ProofingTrackMetricsIsEnabled"),Ro.a.qV(15,1,new dq)));this.Da.register(1224,"Box4.Proofing.IProofingConfigV2Manager").ma().na(()=>
new $r(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),Sa.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingCritiqueCategoryInfoFilter")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){m.a.instance.Ac(new Uk)}}Object(e.a)(Uk,"Box4ProofingPackage",null,[2,3]);var Gi=d(170);class Vo{constructor(a){this.PPe=0;this.v7a=this.MDb=this.zgb=null;this.d$=
u.AFrameworkApplication.Aa.hU;this.NP=a;this.NP.Vt(Le.a.rkh);this.NP.ZA(Le.a.rkh,Object(D.a)(this,this.ank,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.v7a)return Z.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.v7a;this.zgb=this.d$.wi("ComponentAttach","getCustomAuthConfig");return this.v7a=new Promise((a,b)=>{const c={};let f=!1,l=!1,x=0;this.PPe=window.setInterval(()=>{4>x?(x++,this.NP.sendMessage(Le.a.getCustomAuthConfig,c)):(window.clearInterval(this.PPe),
f=!0,Z.ULS.sendTraceTag(588087303,344,10,fe.c({["error"]:"Request timeout after 4 retries."})),b("Request timeout."))},1E3);this.MDb=(F,R)=>{window.clearInterval(this.PPe);f||l||(l=!0,F?(Z.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),a(F)):(Z.ULS.sendTraceTag(589050654,369,10,fe.c({["error"]:R.toString()})),b(R)))};this.NP.sendMessage(Le.a.getCustomAuthConfig,c)})}ank(a){try{const b=fe.a(a.Values[Gi.a.dhi]);let c=u.AFrameworkApplication.fa.Ha("Application")||"";c=Ma.a.sg(c);
b.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";b.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";this.zgb&&(this.zgb.stop(),this.zgb=null);this.MDb(b,"")}catch(b){Z.ULS.sendTraceTag(589050655,344,10,fe.c({["error"]:b.message,["stack"]:b.stack})),
this.MDb(null,b.message)}}}Object(e.a)(Vo,"AccountSwitchingManager",null,[1310]);class Bo{get name(){return"Common.App.AccountSwitching"}Wb(a){a.register(Vo,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ma().na(()=>new Vo(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){m.a.instance.Ac(new Bo)}}Object(e.a)(Bo,"AccountSwitchingPackage",null,[2,3]);class Nv{constructor(){this.Pa=new qd.a}Ezc(a){this.Pa.addHandler("OnEditHappenedEvent",
a)}vEk(){this.Pa.raiseEvent("OnEditHappenedEvent")}}Object(e.a)(Nv,"EditNotificationEventSource",null,[]);var If=d(100);class bt{constructor(a,b,c,f,l,x,F=0){this.nrd=!1;this.mrd=this.Y0a=null;this.syf=!1;this.Rd=b;this.suc=a;this.NKa=c;this.Afa=f;this.qyf=l;this.AKh=x;this.Nqc=0;this.Orc=!1;try{0<F&&(this.Nqc=F,3E5>this.Nqc&&(this.Nqc=3E5),this.Rd&&!this.mrd&&(this.mrd=new He.a(3,2,this.Nqc,Object(D.a)(this,this.pSk,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Rd.Gb(this.mrd)))}catch(R){Z.ULS.sendTraceTag(51246176,
383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+R)}}get Uxl(){return this.syf}ySd(){this.Uxl?this.Orc=!0:(this.syf=!0,Se.Health.instance.addQosPillar("Save"),Se.Health.instance.addQosPillar("ContentCreation"),If.c(G.a.editDocument));this.nrd=!0;this.qyf&&this.qyf.Zzf();this.Afa&&this.Afa.vEk();u.AFrameworkApplication.Pg&&u.AFrameworkApplication.Pg.Eak();this.AKh&&!this.Y0a&&(this.ijc(null),this.Y0a=new He.a(3,2,this.suc,Object(D.a)(this,this.ijc,
"sendPostMessageIfNecessary"),113),this.Rd.Gb(this.Y0a))}ijc(){this.nrd&&(this.NKa.CWR(()=>this.NKa.result.sendMessage(Le.a.editNotification,null)),Z.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.nrd=!1)}pSk(){try{this.Orc&&(If.c(G.a.editDocument),this.Orc=!1)}catch(a){this.Orc=!1,Z.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+a)}}}Object(e.a)(bt,"EditNotificationManager",null,[1318]);
class as{constructor(a,b,c,f,l){this.Nsd=this.Y0a=null;this.Qjb=this.Jnd=!1;this.Rd=b;this.suc=a;this.NKa=c;this.OO=f;this.lyd=l;this.dbh(null)}dbh(){const a=document.getElementById(u.AFrameworkApplication.oTb);!this.Qjb&&this.OO&&a&&(this.OO.ob(qa.a.Ns,a,Object(D.a)(this,this.fse,"mouseActivityHandler"),null),this.Qjb=!0);this.lyd(()=>{this.dispose()})}fse(){this.Qjb&&(this.OO.xb(qa.a.Ns,document.getElementById(u.AFrameworkApplication.oTb),Object(D.a)(this,this.fse,"mouseActivityHandler")),this.Qjb=
!1);this.Zzf();return!1}Zzf(){this.Jnd=!0;this.Nsd||(this.Nsd=new He.a(3,2,this.suc,Object(D.a)(this,this.dbh,"registerHandlerTask"),112),this.Rd.Gb(this.Nsd));this.Y0a||(this.ijc(null),this.Y0a=new He.a(3,2,this.suc,Object(D.a)(this,this.ijc,"sendPostMessageIfNecessary"),111),this.Rd.Gb(this.Y0a))}ijc(){this.Jnd&&(this.NKa.CWR(()=>this.NKa.result.sendMessage(Le.a.Kxl,null)),Z.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Jnd=!1)}dispose(){this.Qjb&&
(this.OO.xb(qa.a.Ns,document.getElementById(u.AFrameworkApplication.oTb),Object(D.a)(this,this.fse,"mouseActivityHandler")),this.Qjb=!1)}}Object(e.a)(as,"UserActivityHostNotificationManager",null,[1317,106]);var Nm=d(136),or=d(285);class Lp{constructor(){this.Da=null}get name(){return"Common.App.EditNotification"}init(){u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ff(Object(D.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){Lp.cJi&&0<Lp.zSd&&(this.Da.register(Nv,"Common.App.HostNotification.EditNotificationEventSource").ma(),
this.Da.register(as,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ma().na(()=>new as(6E4,Nm.a.instance,or.a.vu(this.Da.La("Postmessage.IHostPostmessenger")),ja.a.instance,u.AFrameworkApplication.Iea)),this.Da.register(bt,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ma().na(()=>new bt(Lp.zSd,Nm.a.instance,or.a.vu(this.Da.La("Postmessage.IHostPostmessenger")),this.Da.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.Da.pb("Common.Interface.IUserActivityHostNotificationManager"),Lp.dJi,Lp.aJi)),this.Da.resolve("Common.Interface.IEditNotificationManager"),Z.ULS.shipAssertTag(38086291,209,0<Lp.zSd,"EditNotification Interval is less than or equal to 0."))}Wb(a){this.Da=a}dispose(){}static get zSd(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get aJi(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||
"0"):0}static get cJi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationIsEnabled")}static get dJi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationPostMessageIsEnabled")}static main(){m.a.instance.Ac(new Lp)}}Object(e.a)(Lp,"CommonHostNotificationPackage",null,[2,3]);class en{}en.T4c="ReactSharedHeaderMeControlFlexPane";en.ZQa="headerui";en.PUb="chat_wrapper_pane";Object(e.a)(en,"ReactSharedHeaderConstants",null,[]);class ct{constructor(a){this.Xpf=
0;this.wpd=null;this.YSh=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get eKe(){return this.YSh.value}ub(){this.isInitialized?this.Ybd():this.HLk(Object(D.a)(this,this.Ybd,"registerActionsInternal"))}Ybd(){Z.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(D.a)(this,this.Yhk,"onChatContainerReady"))}).catch(a=>{Z.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",
a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(D.a)(this,this.hki,"chatCountChanged"))}).catch(a=>{Z.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(D.a)(this,this.aik,"onChatKeyPress"))}).catch(a=>{Z.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",a)}))}catch(a){Z.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}hki(a){Z.ULS.sendTraceTag(50595970,
333,50,"Chat count:{0}",a);if(!a)this.eKe.Xhk();else if(1===a&&!this.Xpf){const b=document.getElementById(this.wpd?this.wpd:en.PUb);b?this.eKe.bik(b,Object(D.a)(this,this.Lnl,"transferFocusToChat")):Z.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.Xpf=a}Yhk(a){this.wpd=a}aik(a){a.ctrlKey&&"f6"===a.key.toLowerCase()&&this.Knl(a.shiftKey)}HLk(a){Pf.a.instance.ob(qa.a.Gil,window.self,()=>{a();return!0})}Lnl(){Z.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&
this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{Z.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){Z.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",a)}}Knl(a){Z.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.eKe.Zhk(a)}}Object(e.a)(ct,"ChatManager",null,[1329]);class Ov{constructor(){this.Pa=new qd.a;this.jxf=!1}E4h(a){this.Pa.addHandler("OnTopRowControlsCreatedEvent",a)}l4h(a){this.Pa.addHandler("OnRenameTextboxStatusChangedEventKey",
a)}get dnl(){return this.jxf}lFk(){this.jxf=!1;this.Pa.raiseEvent("OnTopRowControlsDisposingEvent")}U9g(a){this.Pa.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(e.a)(Ov,"HeaderEventSource",null,[]);var nu=d(195);class ou{constructor(a,b,c,f,l){this.Uxc=null;this.Hd=a;this.jR=b;this.OO=c;this.UWh=f;this.Ca=l}cbh(a,b,c,f=null){const l=this.Hd.Bc(b);l.parent=c;l.IK=!0;f&&l.xaa(f);this.OO.q6(b,a,!1);this.UWh.q6(b,a,!1);b=new nu.DOMFocusListing(()=>a);b.mo(2);b.mo(1);b.mo(8);
b.mo(5);b.mo(3);b.mo(6);this.Hd.aha(()=>a,l,b).cW=!0;b=A.KeyInputManager.Na(w.a.Bq,0);c=A.KeyInputManager.Na(w.a.Bq,4);l.$o(b);l.$o(c)}onFlexPaneOpen(a){this.cbh(a,en.T4c,en.ZQa);this.Hd.Bf(en.T4c);this.jR.p1(en.T4c)}onFlexPaneClose(){this.jR.qo(en.T4c);this.Hd.Bf(en.ZQa)}bik(a,b){this.Uxc||(this.Uxc=b,this.cbh(a,en.PUb,y.AFrame.XC,Object(D.a)(this,this.$hk,"onChatFocus")));this.Hd.Bf(en.PUb);this.jR.p1(en.PUb)}$hk(){this.Uxc&&this.Uxc()}Xhk(){this.jR.qo(en.PUb);this.Hd.JJc(y.AFrame.mV)}Zhk(a){this.Ca.processAction(a?
G.a.cUd:G.a.Xmd,2)}}Object(e.a)(ou,"ReactSharedHeaderFocusManager",null,[553]);var Zx=d(514);class Mp{constructor(a){this.Ca=a}ub(){this.Ca.xa(G.a.VJc,de.a.frame,Object(D.a)(this,this.jUg,"navigateToUpsellPage"));this.Ca.xa(G.a.HUi,de.a.frame,Object(D.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.Ca.xa(G.a.vSk,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(G.a.seh,de.a.frame,ce.ActionManager.Fg)}jUg(a,b,c,f,l){if(1===c)return 32;a=8;2===c&&(c=this.LXd(l,"experience","gopremiumribbon"),
l=cg.a.vV("2116536"),l=cg.a.J2a(l,"ocid",Zx.b(u.AFrameworkApplication.Aa.gb.Am,u.AFrameworkApplication.Aa.gb.vGa,c)),kb.a.Um(l,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.Ca.processAction(G.a.seh,2),Z.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return a}launchUpsellExperience(a,b,c,f,l){if(1===c)return 32;var x=8;2===c&&(Z.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(x=hb.a.instance.pb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?
(a=this.LXd(l,"experience","gopremium"),l=this.LXd(l,"dimeCampaignId",null),x.launchUpsellExperience(a,l),x=32):(Z.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),x=this.jUg(a,b,c,f,l)));return x}LXd(a,b,c){a&&a[b]&&(c=Object(va.a)(String,a[b]));return c}}Object(e.a)(Mp,"UpsellActor",null,[1308]);class pu{constructor(){this.Da=null}get name(){return"Common.App.Header"}init(){hb.a.instance.resolve("Common.App.Header.IUpsellActor").ub();hb.a.instance.resolve("Common.App.Header.IChatManager").ub()}dispose(){}Wb(a){this.Da=
a;this.Da.register(Ov,"Common.App.Header.HeaderEventSource").ma();this.Da.register(Mp,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ma().na(()=>new Mp(u.AFrameworkApplication.Ta));this.Da.register(ou,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ma().na(()=>new ou(u.AFrameworkApplication.Aa.Cr,u.AFrameworkApplication.Aa.mw,u.AFrameworkApplication.Aa.VQ,u.AFrameworkApplication.Aa.bhb,u.AFrameworkApplication.Ta));this.Da.register(ct,
"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ma().na(()=>new ct(this.Da.Be("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){m.a.instance.Ac(new pu)}}Object(e.a)(pu,"CommonAppHeaderPackage",null,[2,3]);class Pv{constructor(a,b,c,f=null,l=null){this.uE=a;this.TMb=b;this.QMb=c;this.Zif=f;this.PPb=l}jIc(a){const b=new Sys.StringBuilder(this.uE.Cic);b.append("RoamingServiceHandler.ashx?action=");b.append("getFirstRunExperienceSettings");b.append("&");b.append(this.R_d(a));
b.append("&");b.append(u.AFrameworkApplication.Zg);u.AFrameworkApplication.He.vj(b.toString(),1,null,null,!0,2,Object(D.a)(this,this.WBa,"getRequestSuccessCallback"),Object(D.a)(this,this.hia,"getRequestFailureCallback"),null)}Fqb(a){var b=new Sys.StringBuilder(this.uE.Cic);b.append("RoamingServiceHandler.ashx?action=");b.append("saveFirstRunExperienceSettings");b.append("&");b.append(u.AFrameworkApplication.Zg);b=b.toString();a=fe.c(a);u.AFrameworkApplication.He.vj(b,2,a,null,!0,4,Object(D.a)(this,
this.dxk,"postRequestSuccessCallback"),Object(D.a)(this,this.J9,"postRequestFailureCallback"),null)}WBa(a){let b=!1,c=null;try{if(0<a.data.Zd.length){const f=Object(va.a)(Object,fe.a(a.data.Zd)),l=f?f[this.uE.tHd]:null;l&&(c=Object(va.a)(Object,fe.a(l.toString())))}b=!0}catch(f){this.hia(null)}b&&this.TMb&&this.TMb(a.data,c)}hia(a){this.QMb&&this.QMb(a?a.data:null)}dxk(a){this.Zif&&this.Zif(a?a.data:null)}J9(a){this.PPb&&this.PPb(a?a.data:null)}R_d(a){const b=new Sys.StringBuilder("requestedsettings=");
for(let c=0;c<a.count;c++)b.append(a.ga(c)),c<a.count-1&&b.append(";");return b.toString()}}Object(e.a)(Pv,"FirstRunExperienceRequestHandler",null,[]);var qu=d(389);class Qv{constructor(){this.AMb=this.rrc=this.uE=null}mLe(a){a?(this.uE=a,this.FIj()&&(Z.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),a=new Ha.a,a.add(this.uE.tHd),this.rrc=new Pv(this.uE,Object(D.a)(this,this.WBa,"getRequestSuccessCallback"),Object(D.a)(this,this.hia,
"getRequestFailureCallback"),null,Object(D.a)(this,this.J9,"postRequestFailureCallback")),this.rrc.jIc(a)),(this.uE.Bxg||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.nLe()):Z.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}FIj(){try{if(this.uE.Bxg)return!0;if(!u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||u.AFrameworkApplication.fa.ka("IsAnonymousUser"))return!1;
if(this.uE.AEj||this.uE.Ivb||u.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return!0;const a=u.AFrameworkApplication.fa.Ha("FlightId");return-1!==(a?a.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(a){Z.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",a?a.toString():null)}return!1}Rhh(a){const b={},c={};c.FREDisplayedDate=(new Date).toUTCString();c.VersionDisplayed=a;c.RemindMeLater=!1;b[this.uE.tHd]=fe.c(c);Z.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.rrc&&this.rrc.Fqb(b)}WBa(a,b){a=a?+a.Iu-+a.zt:-1;a>this.uE.ugh?Z.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",a,this.uE.ugh):b?this.sal(b)?(Z.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.uE.RSg),this.nLe()):(this.ERd(!1),
Z.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(Z.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.nLe())}hia(a){this.ERd(!1);Z.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",a?a.af:-1)}J9(a){Z.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
a?a.af:-1)}nLe(){this.ERd(!0);var a=hb.a.instance.pb("Common.ISystemInitiatedFeedback");a?this.Qph(a):(Z.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((a=hb.a.instance.La("Common.ISystemInitiatedFeedback"))?a.execute(b=>{this.Qph(b)}):Z.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Qph(a){if(a){var b=this.uE.ZSi;
b&&(u.AFrameworkApplication.Qj(b),u.AFrameworkApplication.Z5b(b));Z.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",b);a.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.AMb=Object(D.a)(this,this.Ljk,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.AMb,!0),window.addEventListener("FRELaunchedEvent",this.AMb,!0)):(Z.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.Rhh(this.uE.currentVersion))}else Z.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}Ljk(a){if(a){var b=a.detail;a=a.type;var c=this.uE&&this.uE.KKf?this.uE.KKf.split("-")[0]:null;if("FRELaunchedEvent"===a||c&&b&&b.id&&-1!==b.id.indexOf(c))b.success&&(Z.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.Rhh(this.uE.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.AMb,!0),window.removeEventListener("FRELaunchedEvent",
this.AMb,!0))}}sal(a){if("RemindMeLater"in a&&"FREDisplayedDate"in a){if("true"===a.RemindMeLater.toString()&&(+new Date-+new Date(a.FREDisplayedDate.toString()))/36E5>this.uE.RSg)return!0}else if(u.AFrameworkApplication.fa.ka("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in a&&a.VersionDisplayed<this.uE.currentVersion)return Z.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}ERd(a){u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
qu.a.dispatch("FREDecisionEvent",{["show"]:a})}}Object(e.a)(Qv,"FirstRunExperienceLauncher",null,[1280]);class ru{constructor(){this.Da=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Wb(a){this.Da=a;this.Da.register(1280,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ma().na(()=>new Qv)}init(){}dispose(){}static main(){m.a.instance.Ac(new ru)}}Object(e.a)(ru,"FirstRunExperienceLauncherPackage",null,[2,3]);class bs{constructor(){this.Gnd={}}SYh(a){this.Gnd[a.id.toString()]=
a}Hfk(a){const b=this.Gnd;for(let c in b)b[c].notify(a,!1);this.Gnd={}}DCk(a,b){b&&this.SYh(b);return this.x_g(a,b)}GSd(a){this.Hfk(a)}bZf(a,b){a.notify(b,!0)}}Object(e.a)(bs,"AEventEmitter",null,[1307]);var cs;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(cs||(cs={}));Object(e.b)("EventResultState",cs);class ds{constructor(){this._state=0}get state(){return this._state}set state(a){Z.ULS.sendTraceTag(5849616,202,
50,"Changing event result state. {0}",{["OldState"]:cs[this._state],["NewState"]:cs[a]},"ResultType",this.Ccg());this._state=a}}Object(e.a)(ds,"AEventResult",null,[1333]);class $x extends ds{constructor(){super();this.vCd=this.LPb=null;this.state=0;this.Vtd=this.O5e=!1}get EQ(){return this.LPb}get HIa(){return this.vCd}get bAj(){return this.O5e}Ccg(){return"GetMoreInfo Result"}}Object(e.a)($x,"GetMoreInfoResult",ds,[1332,1333]);var Rv=d(426),Sv=d(515);class qp{constructor(a,b,c,f,l,x,F,R){this.Ca=
a;this.Ei=b;this.lH=c;this.v5=f;this.Rd=l;this.PMb=x;this.uMh=F;this.mxc=R}uKk(){this.zBb.xa(G.a.BCb,de.a.frame,Object(D.a)(this,this.BCb,"openUrlInNewTab"));this.zBb.xa(G.a.Iwe,de.a.frame,Object(D.a)(this,this.Iwe,"openDocumentUrl"));u.AFrameworkApplication.dba?this.ZAg():this.zBb.pa(G.a.WGc,de.a.frame,Object(D.a)(this,this.WGc,"documentLoaded"),96)}BCb(a,b,c,f,l){l&&l.MenuItemId&&(Z.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:Sv.a[this.Jua]}),kb.a.Um(l.MenuItemId.toString(),
"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}Iwe(a,b,c,f,l){if(l&&l.MenuItemId){const x=u.AFrameworkApplication.fa.ka("WacInTabOpenMRUIsEnabledForUiHost"),F=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");Z.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",x,F);if(x&&F){Z.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:Sv.a[this.Jua]});a=l.MenuItemId.toString();
const R={};R[Gi.a.fEb]="1";R[Gi.a.documentUrl]=a;R[Gi.a.reason]=Rv.a.open;Z.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");u.AFrameworkApplication.zV().execute(fa=>{fa.sendMessage(Le.a.RAa,R)})}else this.BCb(a,b,c,f,l)}return 32}WGc(){this.ZAg();return 32}Bsa(a,b,c=""){if(b&&b.zt){const f=pk.a[b.status];b=b.zt.getTime();const l=this.QE()-b;Z.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:f,["ElapsedMs"]:l,
["StartTime"]:b,["Notes"]:c})}else Z.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}ZAg(){var a=u.AFrameworkApplication.fa.ka("QPGVCI"),b=cg.a.mS(document.URL,"wdNewAndOpenCt",a);if(b){b=parseInt(b);var c=cg.a.mS(document.URL,"wdPreviousSession",a);a=cg.a.mS(document.URL,"wdPreviousCorrelation",a);var f=u.AFrameworkApplication.fa.ka("NAOPLP");if(u.AFrameworkApplication.dba){var l=u.AFrameworkApplication.dba.getTime();!b||
b>l?Z.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:b,["DocumentLoadedTime"]:l,["SessionId"]:c,["Correlation"]:a}):Z.ULS.sendTraceTag(5849683,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:l-b,["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}else Z.ULS.sendTraceTag(5849681,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}}get zBb(){return this.Ca.value}get scc(){return this.Ei.value}get qUg(){return this.lH.value}get Jua(){return this.v5.value}get H5c(){return this.Rd.value}get QE(){return this.PMb}get yda(){return this.uMh.value}get KIa(){return this.mxc.value}static get instance(){return qp.Ja||(qp.Ja=qp.dr())}static dr(){return new qp(new le.a(()=>u.AFrameworkApplication.Ta),new le.a(()=>u.AFrameworkApplication.He),new le.a(()=>u.AFrameworkApplication.Aa),
new le.a(()=>u.AFrameworkApplication.Aa.gb.Am),new le.a(()=>u.AFrameworkApplication.ue),()=>(new Date).getTime(),new le.a(()=>u.AFrameworkApplication.Aa.gb.yda),new le.a(()=>u.AFrameworkApplication.KIa))}}qp.Ja=null;Object(e.a)(qp,"NewAndOpenCommonHelpers",null,[1306]);class su{constructor(a,b,c){this.Fwc=this.Hm=null;this.AAd=0;this.nUh=a;this.Rd=b;this.vZe=c}i7h(){this.AAd=this.aFb+1}YEe(a){this.Hm&&(this.Rd.Qg(this.Hm),this.Hm=null);a&&(this.AAd=0)}Hgl(a){const b=this.gml;0<=b?(this.i7h(),this.YEe(!1),
this.Hm=new He.a(4,1,b,a,107),this.Rd.Gb(this.Hm)):(this.YEe(!0),Z.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.vZe}))}get aFb(){return this.AAd}get gml(){return this.aFb>=this.Kjh.length?-1:this.Kjh[this.aFb]}get Kjh(){if(!this.Fwc){const a=(this.nUh.value||"0").split(",");this.Fwc=[];for(let b=0;b<a.length;b++){const c=parseInt(a[b]);isNaN(c)?Z.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.vZe,["Entry"]:a[b]}):
Array.add(this.Fwc,c)}}return this.Fwc}}Object(e.a)(su,"RetryHelper",null,[]);class fn extends bs{constructor(a,b){super();this.Zfa=a;this.pQb=new su(b,this.Ybc.H5c,"GetMoreInfo");this.qx=new $x}bak(){this.kre("Document opened")}jyi(a){return()=>{this.kre(a,!0)}}x_g(a,b=null){Z.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:a});3===this.qx.state?(b&&this.bZf(b,this.qx),Z.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):
this.kre(a);return this.qx}kre(a,b=!1){this.pQb.YEe(!b);1===this.qx.state?Z.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.pQb.aFb}):(Z.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.pQb.aFb}),this.qx.state=1,b=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.Ybc.yda,u.AFrameworkApplication.Zg),this.Ybc.scc.FY(b,1,null,null,[fn.Jgf,fn.Evf],5,this.mxi(),this.lxi(a),
null))}mxi(){return a=>{var b=!1;let c=!1;var f=!1,l;u.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody")&&(a.data.Zd?({Hv:l}=fe.d(a.data.Zd)).returnValue?l?(f=!0,this.qx.vCd=l.StorageServiceDisplayName,this.qx.LPb=fn.eyg(l.PersonalFileStorageUrl)?l.PersonalFileStorageUrl:"",""===this.qx.EQ&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ha("FileSource")&&(this.qx.LPb=cg.a.bma(u.AFrameworkApplication.breadcrumbFolderUrl)),b=""===this.qx.EQ&&""!==this.qx.HIa):Z.ULS.sendTraceTag(25298113,
202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):Z.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):Z.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));f||((l=a.data.mj)?(this.qx.vCd=(l[fn.Evf]||"").toString(),b=(l[fn.Jgf]||"").toString(),
this.qx.LPb=fn.eyg(b)?b:"",""===this.qx.EQ&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ha("FileSource")?(this.qx.LPb=cg.a.bma(u.AFrameworkApplication.breadcrumbFolderUrl),b=""===this.qx.EQ&&""!==this.qx.HIa):b=""===b&&""!==this.qx.HIa):(Z.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),c=!0));f=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.pQb.aFb,c,b,f);this.Ybc.Bsa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",
a.data,f);this.Xjh(3,b,c)}}lxi(a){return b=>{this.Ybc.Bsa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",b.data,"Failure");this.Xjh(2);this.pQb.Hgl(this.jyi(a))}}Xjh(a,b=!1,c=!1){this.qx.state=a;this.qx.O5e=b;this.qx.Vtd=c;this.GSd(this.qx)}get Ybc(){return this.Zfa.value}static get instance(){return fn.Ja||(fn.Ja=fn.dr())}static dr(){return new fn(new le.a(()=>qp.instance),new le.a(()=>u.AFrameworkApplication.u7i))}static eyg(a){if(!a)return Z.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),
!1;if(Ma.a.sg(a).startsWith("https://"))return!0;Z.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}fn.Jgf="PersonalFileStorageUrl";fn.Evf="StorageServiceDisplayName";fn.Ja=null;Object(e.a)(fn,"GetMoreInfoActor",bs,[]);class rp{constructor(a,b,c,f,l){this.XMh=6E4;this.nlg="inactive";this.Rzf="active";this.Sfa=!0;this.Rd=a;this.XLh=b;this.PMb=c;this.Nxc=f;this.Pa=new qd.a;l&&this.zgl();this.ybf=this.U$f()}jFd(a){this.Pa.addHandler(this.Rzf,a)}m0h(a){this.Pa.addHandler(this.nlg,
a)}zgl(){const a=new He.a(5,2,this.XMh,Object(D.a)(this,this.Suj,"inactiveLoop"),108);this.Tuj.Gb(a)}Suj(){const a=this.U$f(),b=this.QE()-a;b>this.Njd&&this.Sfa&&(Z.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:b}),this.Sfa=!1,this.Pa.raiseEvent(this.nlg));a-this.ybf>this.Njd&&(this.Sfa=!0,this.Pa.raiseEvent(this.Rzf));this.ybf=a}get Tuj(){return this.Rd.value}get U$f(){return this.XLh}get QE(){return this.PMb}get Njd(){return this.Nxc.value}static get instance(){return rp.Ja||
(rp.Ja=rp.dr())}static dr(){return new rp(new le.a(()=>Nm.a.instance),()=>u.AFrameworkApplication.lbe.getTime(),()=>(new Date).getTime(),new le.a(()=>u.AFrameworkApplication.Njd),!0)}}rp.Ja=null;Object(e.a)(rp,"InactivityManager",null,[]);var dt=d(897);class et extends ds{constructor(){super();this.vQh=this.hef=this.gef=null;this.state=this.fxf=0;this.Vtd=!1}get Hse(){return this.gef}get QTg(){return this.hef}get jml(){return this.fxf}Ccg(){return"MruActor Result"}}Object(e.a)(et,"MruResult",ds,[1334,
1333]);var Np=d(179);class ft{constructor(a,b,c){this.task=null;this.H7a=a;this.Nbk=b;this.taskManager=c;this.retryCount=this.P2b=0;this.wzd=this.t5b=null}uKj(a,b){return a===Np.a.cWd||20===b||18===b||3===b}WLj(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===a||28===a}get P$c(){return this.wzd}reset(){this.P2b=this.retryCount=0;this.wzd=this.t5b=null;this.task&&(this.taskManager.Qg(this.task),this.task=null)}Jyj(a,b,c,f){this.wzd=
String.format("{0}_{1}",c,f);if(this.retryCount>=this.Nbk)return Z.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.uKj(c,f))return Z.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.WLj(f)&&1<=this.P2b)return this.t5b=c,!1;b=Math.max(b,this.H7a*Math.pow(2,this.P2b));if(26===f)b=Math.max(b,3E4);else if(27===f||28===f)b=Math.max(b,6E4);9===f||412===c&&(null==this.t5b||412!==this.t5b)?b=500:this.P2b+=1;this.t5b=c;this.retryCount+=1;this.task&&
this.taskManager.Qg(this.task);Z.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",b);this.task=new He.a(2,1,b,a,107);this.taskManager.Gb(this.task);return!0}}Object(e.a)(ft,"RetryManager",null,[]);var Mq=d(214),Ag=d(73);class hq{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(e.a)(hq,"WriteOptions",null,[]);class vm extends bs{constructor(a,b,c,f,l,x,F){super();this.Zfa=a;this.CPh=b;this.XLa=new ft(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.tF.H5c);this.DMa=new ft(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.tF.H5c);this.bTh=c;this.rzf=f;this.lYh={};this.V5=new et;this.TLh=l;this.juc="";this.oE=x;this.Y0e=F;this.cTh=u.AFrameworkApplication.fa.Ec("WordRecentLinksCount",
25)}get Pmd(){return this.lYh}AMk(){this.tF.zBb.xa(G.a.Gdh,de.a.frame,Object(D.a)(this,this.ZQk,"renameMruEntry"))}ZQk(){return this.wUe("Rename")}lak(){this.yRg("File Opened")}mak(){this.yRg("IntervalUpdate")}yRg(a){Z.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.wUe(a)}uV(a){(a=Ma.a.uV(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}r6f(){switch(this.tF.Jua){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}Sgj(a){var b=this.TLh();if(!b)return null;const c=new hq;c.documentUrl=this.Y0e.value?encodeURI(b):b;c.mruItemId=this.juc;c.app=this.r6f();if(b=this.oE())c.folderName=b.breadcrumbFolderName,b=b.ux,c.documentName=Ma.a.lG(b),c.documentExt=this.uV(b);a&&(c.documentName?c.documentName.length?255<=c.documentName.length?a.set("DocumentNameLength","Long"):2084<=c.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength",
"Null"));return JSON.stringify(c)}wUe(a,b=!1){if(4===this.tF.Jua&&!u.AFrameworkApplication.VGc)return 2;var c=Mq.a.pz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"),c.set("MruIdSent",this.juc?"true":"false"),c.set("URLEncoded",this.Y0e.value?"true":"false"));Se.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",c);a=this.Sgj(c);if(!a)return b=!u.AFrameworkApplication.Rhb,c&&(c.set("WebEditingIsEnabled",u.AFrameworkApplication.Rhb?"true":"false"),c.set("ProtectedFile",u.AFrameworkApplication.bO?
"true":"false")),Se.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",b,!1,Object.assign(new Fk.a,{extendedProperties:c})),2;this.DMa&&!b&&this.DMa.reset();c=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.tF.yda,this.Vbe);this.rzf?this.Pmd["X-FileId"]=u.AFrameworkApplication.Zg:c+=String.format("&{0}",u.AFrameworkApplication.Zg);u.AFrameworkApplication.Yc&&(this.Pmd["X-Office-AudienceGroup"]=Object(va.a)(String,u.AFrameworkApplication.Yc.AudienceGroup)||"");this.Pmd["X-Timeout"]=
15E3;return this.tF.scc.vj(c,2,a,this.Pmd,!0,5,Object(D.a)(this,this.zBl,"writeMruV2EntryOnServerSuccessCallback"),Object(D.a)(this,this.IBi,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}zBl(a){this.uhg(a.data)}uhg(a){const b=Mq.a.pz();this.DMa&&(b&&this.DMa.P$c&&(b.set("LastError",this.DMa.P$c),b.set("NumRetries",this.DMa.retryCount.toString())),this.DMa.reset());const c=dt.c(a.Zd);c&&c.diagnostics_data&&(this.juc=c.diagnostics_data.mru_id);a=+a.Iu-+a.zt;b&&
b.set("RequestDuration",a.toString());Se.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Fk.a,{extendedProperties:b}))}IBi(a){if(a.data.af===Np.a.IWb)this.uhg(a.data);else{var b=a.data.af===Np.a.Dfc,c=Mq.a.pz();this.Shg(this.DMa,a,this.wBi(),c);c&&(c.set("StatusCode",a.data.af.toString()),b||this.tFd(a.data,c));Se.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.af),b,!1,Object.assign(new Fk.a,{extendedProperties:c}))}}wBi(){return()=>{this.wUe("Retry",
!0)}}A7i(){this.WAb("Polling")}z7i(){this.WAb("Retry",!0)}fak(){this.WAb("Open")}eak(){this.WAb("Activity")}dak(){this.WAb("OpenRecentLinks",!1,!0)}cak(){this.WAb("ActivityRecentLinks",!1,!0)}WAb(a,b=!1,c=!1){Z.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const f=Mq.a.pz();f&&(f.set("Trigger",a),f.set("IsRetry",b?"true":"false"),c&&f.set("RecentLinks","true"));Se.Health.instance.recordKpiUsage("GetMru",0,"smartfio",f);this.XLa&&!b&&this.XLa.reset();c?this.QRf(Object(D.a)(this,
this.B7i,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(D.a)(this,this.x7i,"getMruForRecentLinksFromServerFailureCallback"),!0):this.QRf(Object(D.a)(this,this.C7i,"getMruV2FromServerSuccessCallback"),Object(D.a)(this,this.y7i,"getMruFromServerFailureCallback"))}tFd(a,b){a&&a.mj&&(a=a.mj["X-CorrelationId"])&&b.set("ServerCorrelationId",a)}eWj(a,b){a&&(b&&b.set("RequestDuration",(+a.Iu-+a.zt).toString()),Se.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Fk.a,{extendedProperties:b})))}C7i(a){this.Kag(a)}Kag(a,
b=!1){var c="";let f=null,l=null,x=null;const F=dt.c(a.data.Zd);F&&(f=F.places?F.places.items:[],l=F.documents?F.documents.items:[],(x=dt.a(F,b))&&(c=fe.c(x)));u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.oDa&&Ag.c()&&!b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(c,!0));c=Mq.a.pz();this.XLa&&(c&&this.XLa.P$c&&(c.set("LastError",this.XLa.P$c),c.set("NumRetries",this.XLa.retryCount.toString())),this.XLa.reset());b&&c&&c.set("RecentLinks","true");x||f||l?(b?this.tF.Bsa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
a.data,"Success"):this.tF.Bsa("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.Dld(3,x,f,l),this.eWj(a.data,c)):(b?this.tF.Bsa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",a.data,"Failure: Invalid JSON"):this.tF.Bsa("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),c&&this.tFd(a.data,c),Se.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Fk.a,{extendedProperties:c})),this.Dld(3,null,null,null,!0));this.GSd(this.V5)}B7i(a){this.Kag(a,
!0)}Shg(a,b,c,f){let l=0,x=0;const F=dt.c(b.data.Zd);F&&(null!=F.response_code&&(l=F.response_code,f&&f.set("MruResponseCode",l.toString()),9===l&&(this.juc="")),F.error_data&&null!=F.error_data.retry_after_ms&&(x=F.error_data.retry_after_ms,f&&f.set("ExpectedRetryAfter",x.toString())));a&&(b=a.Jyj(c,x,b.data.af,l),f&&(f.set("CurrentRetryCount",a.retryCount.toString()),f.set("RetryScheduled",b?"true":"false")))}y7i(a){this.Jag(a)}Jag(a,b=!1){const c=a.data.af===Np.a.Dfc,f=Mq.a.pz();f&&(f.set("StatusCode",
a.data.af.toString()),b&&f.set("RecentLinks","true"),c||this.tFd(a.data,f));b?this.tF.Bsa("MruActor.GetMruForRecentLinksFromServerFailureCallback",a.data,"Failure"):this.tF.Bsa("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.Dld(2);this.Shg(this.XLa,a,Object(D.a)(this,this.z7i,"getMruFromServerRetryTask"),f);Se.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.af),c,!1,Object.assign(new Fk.a,{extendedProperties:f}));this.GSd(this.V5);u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.gb.oDa&&Ag.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),b||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}x7i(a){this.Jag(a,!0)}Dld(a,b=null,c=null,f=null,l=!1){if(3!==this.V5.state||3===a)this.V5.gef=b,this.V5.hef=c,this.V5.vQh=f,this.V5.state=a,this.V5.Vtd=l,this.V5.fxf=this.tF.QE()}x_g(a,b){Z.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.V5.state});b&&3===this.V5.state&&
this.bZf(b,this.V5);return this.V5}QRf(a,b,c=!1){this.Dld(1);let f;const l={};f=c?String.format(this.tF.yda+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.cTh,"OfficeSuite",this.Vbe,"ClassicMru"):String.format(this.tF.yda+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.r6f(),this.Vbe);this.bTh.value||(f+="&entity=docs");u.AFrameworkApplication.Yc&&(l["X-Office-AudienceGroup"]=Object(va.a)(String,u.AFrameworkApplication.Yc.AudienceGroup)||"");c&&(l["X-Office-Application"]=
"147");this.rzf?l["X-FileId"]=u.AFrameworkApplication.Zg:f+=String.format("&{0}",u.AFrameworkApplication.Zg);this.tF.scc.vj(f,1,null,l,!0,5,a,b,null)}get tF(){return this.Zfa.value}get Vbe(){return this.CPh.value}static get instance(){return vm.Ja||(vm.Ja=vm.dr())}static dr(){return new vm(new le.a(()=>qp.instance),new le.a(()=>sa.a.le(u.AFrameworkApplication.lcid).name),new le.a(()=>u.AFrameworkApplication.Aa.gb.QB),u.AFrameworkApplication.fa.ka("MruWriteFileIdInHeader"),()=>u.AFrameworkApplication.Aa.gb.Naa,
()=>u.AFrameworkApplication.fu,new le.a(()=>u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled")))}}vm.Ja=null;Object(e.a)(vm,"MruActor",bs,[]);class Tv{constructor(){this.RRb=this.Hqf=this.Da=null;this.Un=!1}get name(){return"Common.App.NewAndOpen.Core"}Wb(a){this.Da=a;a.register(1306,"Common.INewAndOpenCommonHelpers").ma().na(()=>qp.instance);a.register(1307,"Common.IEventEmitter<Common.IGetMoreInfoResult>").ma().na(()=>fn.instance);a.register(1307,"Common.IEventEmitter<Common.IMruResult>").ma().na(()=>
vm.instance)}init(){u.AFrameworkApplication.fa.ff(()=>{this.xCa()})}xCa(){this.Da.resolve("Common.INewAndOpenCommonHelpers");this.Da.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Da.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;qp.instance.uKk();u.AFrameworkApplication.Kua&&(a=!0);u.AFrameworkApplication.iCe&&(vm.instance.fak(),u.AFrameworkApplication.fa.ka("WordRecentLinksIsEnabled")&&vm.instance.dak(),0<u.AFrameworkApplication.RTg&&this.PAf(),this.o7k(),a=!0);u.AFrameworkApplication.KIa&&
a&&fn.instance.bak();u.AFrameworkApplication.gvl&&(a=vm.instance,a.AMk(),a.lak(),Nm.a.instance.Gb(this.hvl))}o7k(){rp.instance.jFd(Object(D.a)(vm.instance,vm.instance.eak,"makeGetMruRequestActivityTrigger"));u.AFrameworkApplication.fa.ka("WordRecentLinksIsEnabled")&&rp.instance.jFd(Object(D.a)(vm.instance,vm.instance.cak,"makeGetMruForRecentLinksRequestActivityTrigger"));rp.instance.jFd(Object(D.a)(this,this.PAf,"addGetMruFromServerTask"));rp.instance.m0h(Object(D.a)(this,this.iEi,"deleteGetMruFromServerTask"))}iEi(){Nm.a.instance.Qg(this.STg)}PAf(){Nm.a.instance.Gb(this.STg)}get STg(){return this.Hqf||
(this.Hqf=new He.a(5,2,u.AFrameworkApplication.RTg,Object(D.a)(vm.instance,vm.instance.A7i,"getMruFromServerTask"),109))}get hvl(){return this.RRb||(this.RRb=new He.a(2,2,6E4*u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(D.a)(vm.instance,vm.instance.mak,"makeUpdateMruTask"),197))}dispose(){this.Un||(this.Un=!0,this.RRb&&(Nm.a.instance.Qg(this.RRb),this.RRb=null))}}Object(e.a)(Tv,"CorePackageManager",null,[2,3,106]);var xi=d(122);
class Uv{constructor(a,b,c,f,l,x,F,R,fa,wa){this.UKg=new Ha.a;this.DOg=null;this.Yb=f;this.ta=l;this.Fa=c;this.Ksa=F;this.sja=R;this.ZB=x;this.ra=b;this.la=fa;this.xq=a;this.od=wa;this.la.vMj&&(this.ra&&this.ra.XJ(Object(D.a)(this,this.YG,"onSelectionChanged")),R&&R.CLk(this),this.xq.Bzc(Object(D.a)(this,this.wT,"onFocusChanged")),this.od.gDf(Object(D.a)(this,this.zdc,"onShapeViewElementUnlocked")),this.od.R5h(Object(D.a)(this,this.V0g,"onThumbnailsSetFakeImage")),this.od.S5h(Object(D.a)(this,this.W0g,
"onThumbnailsSetFocus")),this.od.T5h(Object(D.a)(this,this.X0g,"onThumbnailsSetSelected")),this.la.hSc&&this.xq.B4h(Object(D.a)(this,this.r0g,"onSlideshowNavigationToolbarClickedHandler")),this.la.vg&&this.xq.A4h(Object(D.a)(this,this.p0g,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.xq.wcd(Object(D.a)(this,this.wT,"onFocusChanged"));this.xq.POk(Object(D.a)(this,this.Uik,"onDesignerClickSuggestion"));this.od.ydh(Object(D.a)(this,this.zdc,"onShapeViewElementUnlocked"));this.od.QQk(Object(D.a)(this,
this.V0g,"onThumbnailsSetFakeImage"));this.od.RQk(Object(D.a)(this,this.W0g,"onThumbnailsSetFocus"));this.od.SQk(Object(D.a)(this,this.X0g,"onThumbnailsSetSelected"));this.la.hSc&&this.xq.cQk(Object(D.a)(this,this.r0g,"onSlideshowNavigationToolbarClickedHandler"));this.la.vg&&this.xq.bQk(Object(D.a)(this,this.p0g,"onSlideshowContextMenuFocusedHandler"))}YG(a,b){if(b&&b.Ok&&this.ra.BZ(b.Ok))try{this.Goj(b.Ok)}catch(c){a=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",
c.message,c.stack),ya.a.J(17367906,822,10,a)}}Goj(a){var b=this.ra.mg();if(1===a.length||1===b.length&&b[0].mh){if(a=this.ra.jq()){b=new Ha.a;let c=this.lcg(a,b,Object(D.a)(this,this.ecj,"getShapeName"));c||b.count||(c=this.sja.fdg(a,b));!c&&a.get_smartArtModelId()?c=ResourceStrings.l_AccMessageSmartArtSubIcon:Ma.a.Va(c)||(c+=ResourceStrings.L_ShapeSelected);const f=this.sja.ncj(a);({tGf:c,GUe:b}=this.IEf(f,c,b));!a.Lv&&a.isUnread&&({tGf:c,GUe:b}=this.IEf(this.sja.ocj(a,this.DOg),c,b));0<b.count?
this.Q$g(b):this.cea(c||"")}}else 1<a.length&&(a=this.sja.E7i(this.ra.ae()),this.cea(a||""))}IEf(a,b,c){a&&(c.count?c.add(document.createTextNode(a)):b=String.format(ResourceStrings.l_ShapeAndPresenceInfo,b,a));return{tGf:b,GUe:c}}wT(a,b){b=b.EBb;if(b===xi.a.$C||b===Nc.a.yg){a=this.ta.Ba;let c=null;b===xi.a.$C?c=(a=this.Yb.fmc.gja)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.w6a()+this.sja.y1d(a)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.w6a()):b!==Nc.a.yg||
!this.ra.ku()&&this.ra.G2()||(this.ZB&&this.ZB.value&&(b=this.ZB.value.Ld)&&a&&b.So&&ae.e(a,b.Ma),c=this.sja.Ocj());this.cea(c||"")}}setAttribute(a,b,c){a&&Uc.a.lO(a,b,c)}x4(a){this.UKg.add(a)}lcg(a,b,c=null){try{if(a&&this.Fa)for(let f of this.UKg)if(f){const l=f(a,this.Fa.ye?this.Fa.ye.name:null,b,c);if(l||b&&0<b.count)return l}}catch(f){a=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",f.message,f.stack),ya.a.J(17662480,822,10,a)}return null}Q$g(a){if(this.Ksa&&
this.Ksa.value){const b=this.Ksa.value.q6i();if(b&&a&&0<a.count){b.firstChild&&b.removeChild(b.firstChild);const c=document.createElement("p");for(let f of a)c.appendChild(f);b.appendChild(c)}}}T$g(a,b){if(a){const c=new Ha.a;let f=this.lcg(a,c);f||c.count||(f=this.sja.fdg(a,c));0<c.count?(b&&c.add(document.createTextNode(b)),this.Q$g(c)):(b&&(f+=" "+b),this.cea(f||""))}}cea(a){this.Ksa&&this.Ksa.value&&this.Ksa.value.sendNotification(a,!0)}zdc(a,b){b.presenceUser&&b.CMj&&this.cea(String.format(ResourceStrings.L_EditorLeavingHint,
b.presenceUser.userName))}Uik(a,b){this.cea(this.sja.p1i(b.gZk,b.iil))}V0g(a,b){this.setAttribute(b.h5.image,Uc.a.We,Uc.a.cNa)}W0g(a,b){b.hasFocus&&b.h5.isSelected&&this.cea(this.w6a()+this.sja.y1d(b.h5));this.setAttribute(b.h5.nIb,Uc.a.Z2a,b.hasFocus&&b.h5.isSelected?"true":"false")}X0g(a,b){b.h5.isSelected&&b.hasFocus?this.cea(this.w6a()+this.sja.y1d(b.h5)):b.h5.isSelected||this.cea(this.w6a());this.setAttribute(b.h5.nIb,Uc.a.Z2a,b.h5.isSelected?"true":"false")}r0g(a,b){this.cea(b.text)}ecj(a){this.DOg=
a||ResourceStrings.l_Object}p0g(a,b){this.cea(b.text)}w6a(){let a="";const b=this.ra.mf();b&&1<b.length&&(b.sort((c,f)=>c.De-f.De),this.unb(b)&&(a=this.sja.w6a(b[0].De+1,b[b.length-1].De+1)));return a}unb(a){if(!a||1>=a.length)return!1;const b=a.length;return a[b-1].De-a[0].De+1===b?!0:!1}}Object(e.a)(Uv,"AriaManager",null,[1217,106]);var oA=d(898);class Vv{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Aria"}Wb(a){this.K=a;this.K.register(882,"PowerPointWebEditor.IAriaMessageHelper").ma().na(()=>
new oA.a(this.K.La("PowerpointPresence.IPresenceUserManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.La("PowerPointWebEditor.Graph.ICommentReader"),this.K.La("PowerPointWebEditor.IAppForOfficeManager"),this.K.Be("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1217,
"PowerPointWebEditor.IAriaManager").ma().na(()=>new Uv(this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.Be("Box4.IInteractiveViewManager"),this.K.Be("Common.Utils.IAriaNotifier"),this.K.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){m.a.instance.Ac(new Vv)}}Object(e.a)(Vv,"PptAriaPackage",null,[2,3]);var pr=d(1001);class gt{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=gt.OJi;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=
this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}gt.OJi=[];Object(e.a)(gt,"Critique",null,[]);class Wv{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(e.a)(Wv,"Suggestion",null,[]);class ht{tQf(a){if(!a)return null;const b=[];for(const c of a)a=Object.assign(new gt,{TraceId:c.traceId,CategoryTitle:c.categoryTitle,ExplanationTitle:c.explanationTitle||
"",ExplanationLabel:c.explanationLabel||"",Explanation:c.explanation||"",TileId:c.tileId,RevisionId:c.revisionId,BucketId:c.bucketId,Status:c.status,Tag:c.tags?this.fui(c.tags):0,Start:c.start,Length:c.length,Priority:c.priority,TypeId:c.critiqueTypeId}),c.supportedActions&&(a.SupportedActions=this.Mti(c.supportedActions)),c.suggestions&&(a.Suggestions=this.eui(c.suggestions)),b.push(a);return b}eui(a){if(!a)return null;const b=[];for(const c of a)(a=this.cui(c))&&b.push(a);return b}cui(a){if(!a)return null;
const b=Object.assign(new Wv,{BucketId:a.bucketId,Description:a.description,NumberOfInstances:a.numberOfInstances,Source:a.source,Text:a.text,Level:this.Lti(a.confidenceLevel)});a.actions&&(b.Action=this.dui(a.actions));return b}Lti(a){return 1===a?0:2===a?1:2}dui(a){let b=0;a.autoCorrect&&(b|=4);a.changeOnce&&(b|=1);a.changeAll&&(b|=2);a.readAloud&&(b|=8);return b}fui(a){return a.consistency?1:0}Mti(a){let b=0;a.addToDictionary&&(b|=16);a.deleteText&&(b|=1);a.ignore&&(b|=2);a.ignoreAll&&(b|=4);a.ignoreCritiqueType&&
(b|=8);a.showDetails&&(b|=32);return b}}Object(e.a)(ht,"CloudALResponseTransformer",null,[1372]);var ag=d(81),ay=d(517);class Xv{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){this.Eta=a;this.oab=b;this.FOg=c;this.ta=f;this.Db=l;this.ia=x;this.rc=R;this.Gl=fa;this.Vh=wa;this.Mc=F;this.Jz=Xa;this.Eta.Bza(Object(D.a)(this,this.AGa,"onBeforeParagraphDisconnect"));this.Eta.xk(Object(D.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Mc.c3h(Object(D.a)(this,this.dZg,"onLanguageOnRangeChanged"));
this.oab.Bza(Object(D.a)(this,this.OWg,"onBeforeNumberListDisconnect"));this.oab.xk(Object(D.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.FOg.$F(Object(D.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}isEnabled(a){const b=this.ta.Ba;if(!b||!b.isConnected)return!1;const c=Object.assign(new ay.a,{slideId:b.Bb});this.ia.Ka(ba.a.MWa,2,c);return 0<c.Mkc?(ya.a.J(37025884,375,50,"{0}, current slide {1} is locked due to one more people are here. Skipping",
a,b.id),!1):!0}initialize(){this.I6d(this.ta.Ba)}dispose(){this.Eta.xHa(Object(D.a)(this,this.AGa,"onBeforeParagraphDisconnect"));this.Eta.Tm(Object(D.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Mc.dPk(Object(D.a)(this,this.dZg,"onLanguageOnRangeChanged"));this.oab.xHa(Object(D.a)(this,this.OWg,"onBeforeNumberListDisconnect"));this.oab.Tm(Object(D.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.FOg.iO(Object(D.a)(this,this.onShapeChildTopologyChanged,
"onShapeChildTopologyChanged"))}AGa(a,b){this.Omc(Object(va.a)(te.AParagraphNode,b.node),!1)}onParagraphPropertyChanged(a,b){b.property!==bb.a.Zp&&b.property!==Bb.a.listLevel||this.Omc(Object(va.a)(te.AParagraphNode,b.node),!1)}dZg(a,b){this.Omc(b.paragraphNode,!0)}OWg(a,b){b.node&&Object(Fa.a)(ag.a,b.node)&&this.Omc(this.Jz.JZd(Object(va.a)(ag.a,b.node)),!0)}onNumberListPropertyChanged(a,b){b.node&&Object(Fa.a)(ag.a,b.node)&&b.node.isConnected&&b.property===bb.a.Ni&&this.Omc(this.Jz.JZd(Object(va.a)(ag.a,
b.node)),!0)}onShapeChildTopologyChanged(a,b){if(a=Object(va.a)(4,b.node))a=this.rc.Sg(a),this.I6d(a)}Omc(a,b){!this.t9k(a)||b&&this.vqj(a)||(a=Object(va.a)(123,this.rc.Sg(a)),this.I6d(a))}I6d(a){if(a&&a.isConnected&&a.isSlideCritiqueReady){var b=this.Db.je(7,C.a.cTe);b.jc(a);a.isSlideCritiqueReady=!1;b.dispose()}}t9k(a){return!!a&&a.isConnected&&this.Vh.Wd(a)&&!this.Gl.Kia(a)&&!a.sa(ub.a.BS,!1)}vqj(a){a=a.sa(bb.a.Zp,"");return!a||!a.length}}Object(e.a)(Xv,"ConsistencyCheckManager",null,[1211,106]);
var wm=d(165),Op=d(516);class Co{constructor(){this.d=this.p=this.w=null}}Object(e.a)(Co,"ProofingDashboardTraceMetrics",null,[]);class Vk{}Vk.Vae="bs";Vk.IUc="bd";Vk.ODh="was";Vk.PDh="wad";Vk.ULj="rm";Vk.sBl="wd";Vk.fAl="ad";Vk.zUk="rs";Object(e.a)(Vk,"TelemetryFieldNames",null,[]);class Vl{}Vl.Wll="tcw";Vl.Kjd="tcc";Vl.Ryg="bs";Vl.nRj="bd";Vl.Qyg="bpc";Vl.IRg="md";Object(e.a)(Vl,"TelemetryValues",null,[]);class Nq{constructor(){this.wn=this.i=null}}Object(e.a)(Nq,"Workflow",null,[]);class Yv{constructor(a,
b,c,f,l,x,F,R,fa,wa,Xa,lb){this.ta=a;this.WB=b;this.Yne=c;this.Db=f;this.d0j=l;this.aNg=x;this.P8=F;this.Ea=R;this.Gl=fa;this.Ga=wa;this.pee=Xa;this.S8=lb}initialize(){this.P8.execute(a=>{a.addEventHandler(Op.a.VGf,Object(D.a)(this,this.Ijj,"handleAugResults"));this.Ga.pptAugmentationLoopCloudALEnabled&&a.addEventHandler(Op.a.DMd,Object(D.a)(this,this.jkj,"handleCloudALResults"))})}Ijj(a,b,c,f){ya.a.J(36962498,375,50,"Handle WAC AL results");if(b&&f&&b&&f){a=String.format("{0}, MarkStart:{1}",f.Telemetry,
(new Date).getTime().toString());var l=this.x6f(b.Content);c=this.Z1i(f.Payload);if(l&&c){var x=!1;if(this.Ga.pptRegisterSingleProofingWorkflowEnabled||!this.Ga.pptAugmentationLoopCloudALEnabled||this.Ga.pptAugmentationLoopShadowCloudALEnabled)this.JRg(c.Critiques,l),x=!0;l=(new Date).getTime();if(f=this.S8.VQd(f.DashboardTelemetry))try{const F={};F[Vk.zUk]=c.ResponseStatus;F[Vk.ULj]=x;F[Vk.sBl]=l-f.d[Vk.Vae];F[Vk.fAl]=f.d[Vk.PDh]-f.d[Vk.ODh];f.d=F;f.p=Vl.IRg;this.S8.track(f)}catch(F){ya.a.J(37487777,
375,15,"trace metrics exception {0}",F.message)}a=String.format("{0}, MarkDone:{1}",a,l.toString());ya.a.J(36702229,375,50,"Marked: {0}, TileID: {1}, critique count: {2}, {3}",x,b.Id,c.Critiques?c.Critiques.length:0,a)}else ya.a.J(36577357,375,10,c?"Aug slide is null":"Result is null")}}jkj(a,b,c,f){ya.a.J(36962502,375,50,"Handle Cloud AL results");c=(new Date).getTime();if(b&&f&&b&&f){f.partialSuccess&&ya.a.J(37057568,375,15,"Get partial success response");a=String.format("MarkStart:{0}",c.toString());
var l=this.x6f(b.Content);if(l){var x=!1;if(this.Ga.pptRegisterSingleProofingWorkflowEnabled||!this.Ga.pptAugmentationLoopShadowCloudALEnabled)x=this.pee.tQf(f.critiques),this.JRg(x,l),x=!0;l=(new Date).getTime();c=Object.assign(new Co,{w:Object.assign(new Nq,{wn:Vl.Kjd,i:b.Id}),p:Vl.IRg,d:{["ms"]:c,["md"]:l,["rm"]:x,["rs"]:f.partialSuccess?1:0}});this.S8.track(c);a=String.format("{0}, MarkDone:{1}",a,l.toString());ya.a.J(36783304,375,50,"Marked: {0}, Cloud AL tileID: {1}, critique count: {2}, {3}",
x,b.Id,f.critiques?f.critiques.length:0,a)}else ya.a.J(36783302,375,10,"Aug slide is null")}}x6f(a){let b=null;try{b=fe.a(a)}catch(c){return ya.a.J(36577355,375,10,"Try parse aug slide failed"),null}return b}Z1i(a){let b=null;try{b=fe.a(a)}catch(c){return ya.a.J(36525519,375,10,"ApplyEditorServiceResults - Try parse aug response failed {0}",c.message),null}if(!b)return ya.a.J(38545173,375,15,"ApplyEditorServiceResults - Parsed response is null"),null;if(1!==b.ResponseStatus&&0!==b.ResponseStatus)return ya.a.J(36525521,
375,15,"ApplyEditorServiceResults - Failed editor service call {0}",b.ResponseStatus),null;1===b.ResponseStatus&&ya.a.J(37057603,375,15,"Get partial success response");return b}JRg(a,b){try{const F=this.ta.Ba;if(!this.N$k(b,F)){var c=this.zbg(a,!1);if(c){var f=this.ta.Ba.dha,l=new Ha.a,x=this.Db.je(7,C.a.cTe);x.jc(F);for(const R of b.drawingElems)if(R.text&&R.text.paragraphs)for(const fa of R.text.paragraphs){const wa=fa.id;l.add(wa);const Xa=Object(va.a)(te.AParagraphNode,f.re(Ga.a.Yf(wa)));if(Xa&&
!Xa.sa(wm.a.eca,!1)){if(this.Ga.pptEditorGrammarAndWritingStyleIsEnabled)if(wa in c){const lb=Array.isArray(c[wa])?c[wa]:null;if(!lb||!lb.length||lb[0].RevisionId!==Xa.sa(wm.a.WUc,0).toString())continue;this.Rak(Xa,lb,this.Vaj(fa.cfRuns))}else this.$Nk(Xa);Xa.setValue(wm.a.eca,!0)}}if(this.Ga.pptEditorConsistencyCheckIsEnabled){const R=String.format("Start:{0}",(new Date).getTime().toString());b=0;const fa=F.isSlideCritiqueReady;c=!1;if(!fa){const wa=new Ha.a,Xa=this.zbg(a,!0);(c=this.IQi(Xa,l,F,
wa))&&(b=this.w9h(Xa,l,F,wa))}ya.a.J(37298713,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",R,(new Date).getTime().toString(),fa,c,b)}F.setValue(wm.a.Osg,!0);x.dispose()}}}catch(F){ya.a.J(36525523,375,10,"MarkEditorServiceResults failed {0}",F.message)}}Vaj(a){const b=new ua.ScriptSharpLegacyMap;if(!a)return b;let c=0;for(const f of a)f.cf&&b.add(c,f.cf.lang),c+=f.len;return b}Rak(a,b,c){var f=this.WB.RE(a,x=>!!x.Dh);const l=[];for(const x of f)1===x.Dh.proofingType&&Array.add(l,
x);b=this.HQi(a,b,l);f=this.GQi(b,f);this.WB.wHa(a,f);this.HRg(b,a,c);a.setValue(wm.a.eca,!0)}$Nk(a){const b=this.WB.RE(a,c=>!!c.Dh&&1!==c.Dh.proofingType);this.WB.wHa(a,b);a.setValue(wm.a.eca,!0)}w9h(a,b,c,f){const l=c.dha,x=new Me.a;let F=0;this.LTk(c);for(let fa in a){var R=a[fa];const wa=Object(va.a)(te.AParagraphNode,l.re(Ga.a.Yf(fa)));R=Array.isArray(R)?R:null;if(!(wa&&wa.isConnected&&R&&R.length))continue;const Xa=[];for(const lb of R)this.Krg(lb)&&!f.contains(lb.BucketId)&&Xa.push(lb);0<Xa.length&&
(this.HRg(Xa,wa),x.Jb(wa.id.toString())||x.$(wa.id.toString(),wa),F+=Xa.length)}if(0<x.count)for(let fa of b)x.Jb(fa)&&(a=x.ga(fa))&&c.yIa.add(a);c.isSlideCritiqueReady=!0;return F}IQi(a,b,c,f){var l=this.Z8i(c);if(b.count!==l.count)return this.GVc(String.format("Topology changed from {0} to {1}",b.count,l.count)),!1;c=c.dha;for(var x of b){if(!l.contains(x))return this.GVc("ParaId changed"),!1;b=Object(va.a)(te.AParagraphNode,c.re(Ga.a.Yf(x)));if(!b||!b.isConnected)return this.GVc("Invalid ParaId"),
!1;if(!b.sa(wm.a.eca,!1))return this.GVc("Para pending proofing"),!1}for(let F in a){x=a[F];l=Object(va.a)(te.AParagraphNode,c.re(Ga.a.Yf(F)));x=Array.isArray(x)?x:null;if(!x||!x.length)continue;b=this.WB.RE(l,fa=>!!fa.Dh&&(1===fa.Dh.proofingType||2===fa.Dh.proofingType||3===fa.Dh.proofingType));const R=this.WB.RE(l,fa=>{fa=Object(va.a)(384,fa.Dh);return!!fa&&5===fa.proofingType&&fa.sCa});l=this.Yne.mLc(l,!1,!0);for(const fa of x)if(this.Krg(fa)){if(this.vRc(fa,b)||this.nEj(fa,x))f.add(fa.BucketId),
ya.a.J(37298716,375,50,"Overlap critique: {0}",fa.BucketId);(this.vRc(fa,l)||this.vRc(fa,R))&&f.add(fa.BucketId)}}return!0}GVc(a){ya.a.J(37298718,375,50,"Skip apply: {0}",a)}HQi(a,b,c){const f=[];for(const l of b){if(this.oqj(b,l)||a.characterData.length<l.Start+l.Length||this.vRc(l,c))continue;const x=aj.b(l);2!==x&&3!==x||f.push(l)}return f}GQi(a,b){const c=[];for(const f of b)this.u9k(a,f)||Array.add(c,f);return c}u9k(a,b){const c=b.Dh.proofingType;if(1===c)return!0;if(2===c||3===c)return!1;if(5===
c){for(const f of a)if(this.mTc(f.Start,f.Start+f.Length,b.begin,b.end))return!1;return!0}return!1}vRc(a,b){const c=a.Start;a=a.Start+a.Length;for(const f of b)if(this.mTc(c,a,f.begin,f.end))return!0;return!1}zbg(a,b){const c={};if(a)for(const f of a)if(0!==f.Priority||b)f.TileId in c?Array.add(c[f.TileId],f):c[f.TileId]=[f];return c}ZPa(a,b){let c=0;for(let f of a)if(b>=f.key)c=f.value;else break;return c}HRg(a,b,c=null){if(a&&a.length&&b){var f={},l=[];for(const F of a){var x=F.Start;const R=x+
F.Length,fa=b.characterData.substring(x,R);a=this.d0j.create(F,this.aNg);a.token=fa;c&&(a.lcid=this.ZPa(c,x));x=new An(x,R,a);Array.add(l,x);a=1===a.proofingType?Df[a.proofingType]:a.typeId;f[a]=a in f?f[a]+1:1}this.WB.zAf(b,l);this.aNg.track(()=>Object.assign(new ff.a,{E:2,C:this.fvi(b.characterData),F:f}))}}oqj(a,b){const c=b.Start,f=b.Start+b.Length;for(const l of a)if(this.mTc(c,f,l.Start,l.Start+l.Length)&&aj.a(l)>aj.a(b))return!0;return!1}nEj(a,b){const c=a.Start,f=a.Start+a.Length;for(const l of b)if(l!==
a&&this.mTc(c,f,l.Start,l.Start+l.Length))return!0;return!1}mTc(a,b,c,f){return a>=c&&a<f||c>=a&&c<b}fvi(a){return Wr.a.instance.yfg(a,0,a.length-1)}N$k(a,b){return!a||!b||!b.isConnected||a.id!==b.id.toString()}Krg(a){return!!a&&5===aj.b(a)}Z8i(a){const b=new Ha.a;a=a?a.om():[];for(const c of a)this.Gl.gDa(c)||this.Ea.WI(c,f=>{b.add(f.id.toString())});return b}LTk(a){for(let b of a.yIa){const c=b;if(c){const f=this.WB.RE(c,l=>{l=Object(va.a)(384,l.Dh);return!!l&&5===l.proofingType&&!l.sCa});this.WB.wHa(c,
f)}}a.yIa.clear()}}Object(e.a)(Yv,"EditorServiceResultsManager",null,[]);class Zv extends Hp.a{constructor(a,b,c,f,l,x=null){super(a,b,c,f,x);this.oF=l}get proofingType(){const a=super.proofingType;return this.oF.sRa||2!==a?a:1}}Object(e.a)(Zv,"PPTEditorServiceErrorDetails",Hp.a,[]);class by{constructor(a,b,c){this.r3j=a;this.J6j=b;this.oF=c}create(a,b,c=null){return new Zv(a,b,this.r3j,this.J6j,this.oF,c)}}Object(e.a)(by,"PPTEditorServiceErrorDetailsFactory",null,[1208]);class cy{constructor(a){this.Ga=
a}filter(a){if(a&&(!this.Ga.pptEditorConsistencyCheckIsEnabled||!this.Ga.pptEditorGrammarAndWritingStyleIsEnabled))for(let c=a.length-1;0<=c;--c){const f=a[c].CritiqueTypeInfoList;for(let l=f.length-1;0<=l;--l){var b=f[l];b=aj.c(b.CritiquePriority,b.CritiqueTag);this.Ga.pptEditorConsistencyCheckIsEnabled||5!==b||Array.removeAt(f,l);this.Ga.pptEditorGrammarAndWritingStyleIsEnabled||2!==b&&3!==b||Array.removeAt(f,l)}f.length||Array.removeAt(a,c)}}}Object(e.a)(cy,"PPTProofingCritiqueCategoryInfoFilter",
null,[1209]);class $v extends dn.a{constructor(a,b){super(null);this.Dzd=a;this.errorType=2;this.pAg=b}get proofingType(){return this.Dzd}get suggestions(){return[]}kJa(){}}Object(e.a)($v,"UnknownErrorDetails",dn.a,[]);class tu{constructor(a,b,c,f,l){this.XWe=this.UWe=null;this.aEd=this.lxd=0;this.iqd=!1;this.Fi=a;this.VPb=b;this.gz=c;this.lm=f;this.mM=l;this.jqc=0}oah(a,b,c){return{C7g:a,$Vg:b,ZVg:c}}Lyh(){}Qbe(a,b,c,f,l,x,F,R){!x&&(c=!!c&&c[a],f=!!f&&f[a],b&&b[a]||c||f)&&(b=this.Fi.Ra.last.cp,x=
this.Fi.characterData.length,Array.add(F,new ke.a(b,x)),(c||f)&&Array.add(R,new An(b,x,new $v(this.mM.Hae?l?l[a]:0:f?2:1,c?1:2))))}svl(a,b){this.gz.oEe(this.Fi,a);b&&this.lm.QRk(this.Fi,b);this.B7g()}B7g(){this.VPb.RQ(this.Fi)}uXk(a,b,c,f){this.Phh(this.jqc,b,c,f);this.iGe(a,this.iqd)}Phh(a,b,c,f){b.add(1===a);c.add(2===a||3===a);f.add(this.mM.Hae?a:0)}iGe(a,b){a.add(b)}XTj(a){let b,c,f,l;b=this.Fi.sa(bb.a.Mua,null);c=this.Fi.sa(bb.a.EIa,null);f=this.Fi.sa(Bb.a.X6a,null);l=this.Fi.sa(Bb.a.CWa,null);
this.Fi.oub=this.Fi.sa(kh.a.ycc,!1);({Mua:b,EIa:c,X6a:f,CWa:l}=this.tDh(b,c,f,l,a,"loading"));return{Mua:b,EIa:c,X6a:f,CWa:l}}kGe(a,b,c,f,l){({Mua:a,EIa:b,X6a:c,CWa:f}=this.tDh(a,b,c,f,l,"saving"));this.HIe(bb.a.Mua,a);this.HIe(bb.a.EIa,b);this.NKe()&&this.HIe(Bb.a.X6a,c);this.B3k(Bb.a.CWa,f);this.Fi.oub?this.Fi.ke(kh.a.ycc,!0):this.Fi.removeProperty(kh.a.ycc)}NKe(){return!0}HIe(a,b){b&&Array.contains(b,!0)?this.Fi.ke(a,b):this.Fi.removeProperty(a)}B3k(a,b){!b||Pa.a.all(b,c=>0===c)?this.Fi.removeProperty(a):
this.Fi.ke(a,b)}Hni(a,b){(b=this.Fi.Ra.ga(b).formatting)?(a.formatting=b.Sd(a),H.a.instance.ga(57)&&(this.Fi.yu(),-1!==a.formatting.ig&&this.Fi.wordRunProperties.Ktb(b.ig,64))):(Z.ULS.shipAssertTag(18109325,324,!1,"There is a Chp that has spelling error, but its formatting object is null"),Sa.a.instance.Tb("CloneFormattingObjectError",{["Reason"]:"There is a Chp that has spelling error, but its formatting object is null"}))}tDh(a,b,c,f,l,x){const F=Sa.a.instance.Bp(C.a.Syl);F.properties.$(kf.a.source,
x);let R=!1;a&&a.length!==l&&(Z.ULS.sendTraceTag(18109326,324,10,"NotProofedRuns has inconstant length with expected. Length: [{0}], expected: [{1}], context:[{2}]",a.length,l,x),R=!0);b&&b.length!==l&&(Z.ULS.sendTraceTag(18109327,324,10,"SpellErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",b.length,l,x),R=!0);this.NKe()&&c&&c.length!==l&&(Z.ULS.sendTraceTag(20784798,324,10,"GrammarErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",
c.length,l,x),R=!0);f&&f.length!==l&&(Z.ULS.sendTraceTag(25274201,324,10,"ProofingErrorHints has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",f.length,l,x),R=!0);if(R)for(f=c=b=null,a=[],x=0;x<l;x++)Array.add(a,!0);F.end();return{returnValue:!R,Mua:a,EIa:b,X6a:c,CWa:f}}B0g(){}fue(){this.jqc=0;this.UWe=this.Fi.A_||[];this.XWe=this.Fi.dJb||[];this.aEd=this.lxd=0;this.iqd=!1}jue(a,b){a.Ap&&a.Ap.Dh?this.jqc=a.Ap.Dh.proofingType:a.HK&&(this.jqc=0);a=a.cp;b=b?b.cp:a;this.iqd=
({lNe:this.lxd}=this.Xrg(a,b,this.UWe,this.lxd)).returnValue||({lNe:this.aEd}=this.Xrg(a,b,this.XWe,this.aEd)).returnValue}Xrg(a,b,c,f){for(;f<c.length;){const l=c[f];if(l.end<=a)++f;else return{returnValue:b>l.begin,lNe:f}}return{returnValue:!1,lNe:f}}}Object(e.a)(tu,"ProofingDataHandler",null,[1399]);var uu=d(501);class es extends tu{constructor(a,b,c,f,l,x,F,R,fa){super(a,b,c,f,R);this.wIg=!1;this.H6b=null;this.FI=l;this.ia=x;this.Ea=F;this.rc=fa;this.eXc=null}B0g(){this.FI.Fql(this.Fi)}oah(a,
b,c){this.Fi.P7d||(a=!1,c=this.lm.RE(this.Fi));this.eXc=this.lm.RE(this.Fi,f=>{f=Object(va.a)(384,f.Dh);return!!f&&5===f.proofingType&&!f.sCa});return{C7g:a,$Vg:b,ZVg:c}}Lyh(a,b,c,f,l){const x=Object(va.a)(123,this.rc.Sg(this.Fi));this.Fi&&x&&x.isConnected&&x.isSlideCritiqueReady&&Ma.a.vId(this.Fi.characterData,b)&&this.eXc&&0<this.eXc.length&&(Array.addRange(l,this.eXc),l.sort((F,R)=>F.end-R.end));if(!a&&c&&0<c.length&&Ma.a.vId(this.Fi.characterData,b)&&f&&0<f.length){for(const F of c)this.Xvg(F,
f)&&!this.Xvg(F,l)&&Array.add(l,F);l.sort((F,R)=>F.end-R.end)}}Xvg(a,b){a=ul.c([a],b);return!Pa.a.Va(a)&&Pa.a.any(a,c=>c.begin<c.end)}B7g(){this.FI.mLj(this.Fi)&&this.VPb.RQ(this.Fi)}NKe(){return!1}iGe(a,b){this.wIg=!0;super.iGe(a,b);b&&(this.Fi.ke(wm.a.eca,!1),this.Fi.ke(wm.a.WUc,(new Date).getTime()))}Phh(a,b){this.H6b||(this.H6b=this.lm.RE(this.Fi));b.add(1===a)}fue(){super.fue();this.H6b=null}Qbe(a,b,c,f,l,x,F,R){x||(b=!!b&&b[a],a=!!c&&c[a],c=this.Fi.Ra.ga(this.Fi.Ra.length-1),b?(Array.add(F,
new ke.a(c.cp,this.Fi.characterData.length)),this.tXk()):(b=this.RYi(c.cp,this.Fi.characterData.length,this.Fi.characterData,fa=>{fa=fa.Dh.proofingType;return 2===fa||3===fa}))&&0<b.length&&Array.addRange(R,b),a&&(Array.add(F,new ke.a(c.cp,this.Fi.characterData.length)),Array.add(R,new An(c.cp,this.Fi.characterData.length,new $v(1,1)))))}kGe(a,b,c,f,l){this.wIg||this.hrj()||ya.a.J.apply(null,[37368030,375,50,"notProofedRuns:{0}, spellErrorRuns:{1}, grammarErrorRuns:{2}",a,b].concat(c));super.kGe(a,
b,c,null,l)}hrj(){if(!this.Fi)return ya.a.J(37368032,375,10,"ParagraphNode is null"),!1;var a=this.Ea.kn(this.Fi);if(!a)return ya.a.J(37368034,375,10,"ShapeNode is null"),!1;a=new uu.a(a,Gb.App.Im);this.ia.Ka(ba.a.Pdb,2,a);return a.asa}tXk(){const a=new We.GraphTransaction(4);a.fd(this.Fi);this.Fi.ke(wm.a.eca,!1);this.Fi.ke(wm.a.WUc,(new Date).getTime());a.dispose()}RYi(a,b,c,f){const l=[];if(this.H6b)for(const x of this.H6b){const F=Object(va.a)(An,x);F&&F.Dh&&F.Dh.token===c.substring(F.begin,F.end)&&
F.end>a&&F.end<=b&&f(F)&&Array.add(l,F)}return l}}Object(e.a)(es,"PPTProofingDataHandler",tu,[]);class aw{constructor(a,b,c,f,l,x,F,R){this.T8=a;this.a5j=b;this.WB=c;this.FI=f;this.oF=F;this.ia=l;this.rc=R;this.Ea=x}Wyi(a){return new es(a,this.T8,this.a5j,this.WB,this.FI,this.ia,this.Ea,this.oF,this.rc)}}Object(e.a)(aw,"PPTProofingDataHandlerFactory",null,[1212]);class vu{constructor(a,b){this.P8=a;this.NCg=b}initialize(){this.P8.execute(a=>{if(this.NCg)for(const b of this.NCg)this.zMk(a,b)})}zMk(a,
b){a.registerSimpleRemoteWorkflow(b.IF,b.Jnb,b.sEb,b.$mb)}}Object(e.a)(vu,"ProofingAugLoopRuntimeManager",null,[]);class bw{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc){this.Ea=a;this.Gl=b;this.rc=c;this.zm=f;this.Db=l;this.Mb=x;this.Bk=F;this.ta=R;this.T8=fa;this.WB=wa;this.ni=lb;this.Vh=Lb;this.Lka=kc;this.yb=lc;this.od=Jc;this.HMg=Dc;this.lVa=new Ha.a;this.Bk.Y5h(Object(D.a)(this,this.c1g,"onUndoRevisionStateChanged"));this.eT=Xa.Bd(12);this.eT.xk(Object(D.a)(this,this.onParagraphPropertyChanged,
"onParagraphPropertyChanged"));this.kL=Xa.Bd(10);this.kL.$F(Object(D.a)(this,this.X_g,"onShapeTopologyChanged"));this.r7j=new He.a(3,1,0,Object(D.a)(this,this.resumeProofingAfterUndo,"resumeProofingAfterUndo"),90,"14");this.yac=this.QEa=!1;this.od.GY(Object(D.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}dispose(){this.Bk.WQk(Object(D.a)(this,this.c1g,"onUndoRevisionStateChanged"));this.eT.Tm(Object(D.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.kL.iO(Object(D.a)(this,
this.X_g,"onShapeTopologyChanged"));this.od.Nva(Object(D.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}xjc(a,b){this.Ea.WI(a,c=>{this.tlh(c,b)})}ulh(a,b){this.Gl.Cfc(a,c=>{this.tlh(c,b)})}Hvl(a,b){b?this.Ea.WI(a,c=>{c&&this.WB.$Ld(c)}):this.Ea.WI(a,c=>{c&&(c.$Sb=!0)})}Myh(a){if(a&&a.isConnected&&!a.Kp){var b=this.Db.je(4);try{let c=!1;const f=this.Mb.Kc(a);b.jc(f);const l=this.zm.cqa(a);for(;l.moveNext();){const x=l.currentNode;this.e$k(x)&&(c=!0,x.$7c(),x.Rfc=!0)}c&&this.PRg(a)}finally{b&&
b.dispose()}this.ni.forceOutbound()}}Fql(a){if(this.fsa(a)&&a.$Sb)if(this.yac&&!this.lVa.contains(a))this.lVa.add(a);else{var b=this.Db.je(4);try{b.jc(a),a.$7c(),a.Rfc=!0,this.Sak(a)}finally{b&&b.dispose()}a.$Sb=!1}}V$c(a){this.fsa(a)&&this.Ea.WI(a,b=>{this.T8.RQ(b)})}IBk(a){this.fsa(a)&&this.Gl.Cfc(a,b=>{this.T8.RQ(b)})}mLj(a){return this.fsa(a)&&(this.oLj(a)||this.nLj(a))}PRg(a){a&&a.isConnected&&this.Ea.uDa(a)&&this.Elh(a)}Sak(a){const b=this.Ea.kn(a);this.PRg(b);this.Gl.Kia(a)&&(a=this.Gl.ssb(a))&&
a.isConnected&&this.Gl.gDa(a)&&this.Elh(a)}c1g(a,b){if(b)switch(b.state){case 0:this.yac=!0;break;case 3:this.yac=!1,this.QEa||(this.yb.Gb(this.r7j),this.QEa=!0)}}e$k(a){return this.fsa(a)?a.sa(bb.a.Mua,null)?!0:a.sa(bb.a.EIa,null)?!0:!1:!1}onParagraphPropertyChanged(a,b){this.yac&&b&&b.node&&(12!==b.node.type||this.lVa.contains(b.node)||this.lVa.add(b.node))}X_g(a,b){this.yac&&b&&b.node&&(10!==b.node.type||this.lVa.contains(b.node)||this.lVa.add(b.node))}resumeProofingAfterUndo(){this.QEa=!1;for(let b of this.lVa)if(this.fsa(b))if(this.Ea.uDa(b)){var a=
b;a&&(this.xjc(a,!0),this.V$c(a))}else this.Vh.Wd(b)&&(a=b)&&(a.$Sb=!0,this.T8.RQ(a));this.lVa.clear()}tlh(a,b){a&&(a.$Sb=b&&a.A_&&0<a.A_.length?!0:!1)}oLj(a){if(this.HMg){const b=this.ta.Ba;if(!this.fsa(b))return!1;a=this.Ea.Cba(a);return this.rc.Sg(a)===b}return this.Lka.RDj(a)}nLj(a){var b=this.ta.Ba;if(!this.fsa(b))return!1;a=this.Gl.ssb(a);b=b.dQa();return this.fsa(a)&&this.fsa(b)&&Ga.a.cP(a.id,b.id)}Elh(a){a.setValue(ub.a.W$c,a.sa(ub.a.W$c,0)+1)}fsa(a){return!!a&&a.isConnected}onActiveSlideDomReady(){if(this.HMg){var a=
this.ta.Ba;if(a&&(a=a.om())&&0<a.length)for(const b of a)this.Ea.yA(b)&&this.V$c(b)}}}Object(e.a)(bw,"ProofingBehaviorController",null,[1213,106]);class cw extends Ro.a{constructor(a,b,c,f,l,x=!0,F=!1,R=50){super(a,b,c,f,l,x);this.O3j=F;this.PKg=R}Cjh(a){a=Array.isArray(a)?a:null;if(!Pa.a.Va(a))if(a.length<=this.PKg)this.logTrace(a);else{const b=[];for(const c of a)Array.add(b,c),b.length===this.PKg&&(this.logTrace(b),Array.clear(b));0<b.length&&this.logTrace(b)}}logTrace(a){a&&ya.a.J(37325012,375,
this.O3j?15:50,"{0}",Ri.c(a))}}Object(e.a)(cw,"DashboardAggregator",Ro.a,[]);class Oq{constructor(a){this.S8=new cw(new le.a(()=>u.AFrameworkApplication.ue),u.AFrameworkApplication.Iea,15,a.pptProofingDashboardTraceIntervalInMinutes,new dq,!0,a.pptProofingDashboardTraceAsMonitorableEnabled,a.pptProofingDashboardMaxCountInEachLog)}track(a){this.S8.track(a,"")}VQd(a){let b=null;try{b=fe.a(a)}catch(c){ya.a.J(37325010,375,15,"Try parse dashboardTelemetry failed")}return b}}Object(e.a)(Oq,"ProofingDashboardAggregator",
null,[1210]);class dw{track(){}VQd(){return null}}Object(e.a)(dw,"ProofingDashboardNonOperationAggregator",null,[1210]);var ew=d(428),it=d(427);class wu{constructor(a){this.l7j=a}gx(a,b,c){this.l7j(b,c);return!0}}Object(e.a)(wu,"NonOpProofingALRequestManager",null,[1331]);class xu{constructor(a,b,c){this.p_=this.MZ=null;this.Bqe=a;this.Y6b=b.pptEditorConsistencyCheckIsEnabled;this.Zle=b.pptProofingLogWorkflowExceptionEnabled;this.S8=c;this.Xne=new wu(Object(D.a)(this,this.EEe,"requestAL"))}get IF(){return"ProofingTileCheckCloudALWorkflow"}get proto(){return""}get Jnb(){this.MZ||
(this.MZ=Object.assign(new it.a,{name:"LambdaBefore_ProofingTileCheckCloudAL",inputSchema:ew.a.Nkc,outputSchema:Op.a.hOf,func:Object(D.a)(this,this.a9a,"lambdaBeforeFunc")}));return this.MZ}get $mb(){return null}get sEb(){this.p_||(this.p_=Object.assign(new it.a,{name:"LambdaRemote_ProofingTileCheckCloudAL",inputSchema:Op.a.hOf,outputSchema:Op.a.DMd,func:null}));return this.p_}EEe(a,b){b(a)}a9a(a,b,c){try{ya.a.J(36962511,375,50,"{0}:LambdaBeforeStart",this.IF);const F=Object.assign(new Co,{d:{["bs"]:(new Date).getTime()},
w:Object.assign(new Nq,{wn:Vl.Kjd})});this.S8.track(Object.assign(new Co,{w:Object.assign(new Nq,{wn:Vl.Kjd}),p:Vl.Ryg}));let R=String.format("LambdaBeforeStart:{0}",F.d[Vk.Vae].toString());if(a){F.w.i=a.Id;try{var f=fe.a(a.Content)}catch(fa){ya.a.J(36763234,375,10,"Try parse tile response failed");c(null);return}if(f){var l=f.isSlideCritiqueReady;b=!1;var x=({nDa:b}=this.Bqe.zel(f)).returnValue;x?b&&(!this.Y6b||this.Y6b&&l)?(c(null),this.S8.track(Object.assign(new Co,{w:Object.assign(new Nq,{wn:Vl.Kjd}),
p:Vl.Qyg})),ya.a.J(36962520,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.IF,a.Id,b,l)):(F.d[Vk.IUc]=(new Date).getTime(),F.p=Vl.nRj,R=String.format("TileId:{0}, {1}, LambdaBeforeDone:{2}",a.Id,R,F.d[Vk.IUc].toString()),this.S8.track(F),ya.a.J(36783312,375,50,R),this.Xne.gx(f.id,x,c)):(c(null),ya.a.J(36962518,375,50,"{0}:LambdaBeforeDone,RequestNull,{1}",this.IF,a.Id))}else c(null)}else c(null),ya.a.J(36962513,375,50,"{0}:LambdaBeforeDone,InputNull",this.IF)}catch(F){a=
"CloudAL LambdaBefore Exception",this.Zle&&(a=String.format("CloudAL LambdaBefore Exception Message: {0}, Stack: {1}",F.message,F.stack)),ya.a.J(37835201,375,10,a),c(null)}}}Object(e.a)(xu,"ProofingTileCheckCloudALWorkflow",null,[824,1276]);class fw{}Object(e.a)(fw,"AugEditorServiceTileCheckRequest",null,[]);class gw{constructor(){this.contextId=this.JUc=null}}Object(e.a)(gw,"RequestStateObject",null,[]);class yu{constructor(a,b,c,f){this.m7j=0;this.p_=this.MZ=null;this.Bqe=a;this.LS=b;this.Y6b=c.pptEditorConsistencyCheckIsEnabled;
this.Zle=c.pptProofingLogWorkflowExceptionEnabled;this.S8=f;this.Xne=new wu(Object(D.a)(this,this.EEe,"requestAL"))}get IF(){return"ProofingTileCheckWacALWorkflow"}get proto(){return'syntax="proto3";message AugEditorServiceTileCheckRequest { string Topic = 1; string Data = 2; string ContextId = 3; string Telemetry = 4; string DashboardTelemetry = 5; };message AugEditorServiceTileCheckResponse { string  Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; string Telemetry = 6; string DashboardTelemetry = 7; }; '}get Jnb(){this.MZ||
(this.MZ=Object.assign(new it.a,{name:"LambdaBefore_ProofingTileCheckWacAL",inputSchema:ew.a.Nkc,outputSchema:Op.a.UGf,func:Object(D.a)(this,this.a9a,"lambdaBeforeFunc")}));return this.MZ}get $mb(){return null}get sEb(){this.p_||(this.p_=Object.assign(new it.a,{name:"LambdaRemote_ProofingTileCheckWacAL",inputSchema:Op.a.UGf,outputSchema:Op.a.VGf,func:Object(D.a)(this,this.Wae,"lambdaRemoteFunc")}));return this.p_}EEe(a,b){if(b){var c=this.S8.VQd(a.DashboardTelemetry);c&&(c.d[Vk.ODh]=(new Date).getTime());
var f=String.format("{0}, LambdaRemoteStart:{1}",a.Telemetry,(new Date).getTime());this.LS.execute(l=>{f=String.format("{0}, RequestWacALStart:{1}",f,(new Date).getTime().toString());l.gic(a.Topic,a.Data,a.ContextId,x=>{this.FHa(x,f,c)},x=>{this.DHa(x,f)},Object.assign(new gw,{contextId:a.ContextId,JUc:b}))})}}a9a(a,b,c){try{ya.a.J(36962523,375,50,"{0}:LambdaBeforeStart",this.IF);const F=Object.assign(new Co,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new Nq,{wn:Vl.Wll})});let R=String.format("LambdaBeforeStart:{0}",
F.d[Vk.Vae].toString());this.S8.track(Object.assign(new Co,{w:F.w,p:Vl.Ryg}));if(a){try{var f=fe.a(a.Content)}catch(fa){c(null);ya.a.J(36525525,375,10,"Try parse tile response failed");return}if(f){var l=f.isSlideCritiqueReady;b=!1;var x=({nDa:b}=this.Bqe.Ael(f,++this.m7j)).returnValue;x?b&&(!this.Y6b||this.Y6b&&l)?(c(null),this.S8.track(Object.assign(new Co,{w:F.w,p:Vl.Qyg})),ya.a.J(36962560,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.IF,a.Id,b,l)):(F.d[Vk.IUc]=
(new Date).getTime(),R=String.format("{0}, LambdaBeforeDone:{1}",R,F.d[Vk.IUc].toString()),c(Object.assign(new fw,{Topic:Op.a.BJi,Data:fe.c(x),ContextId:f.id,Telemetry:R,DashboardTelemetry:Ri.c(F)})),ya.a.J(36962562,375,50,"{0}:LambdaBeforeDone,{1}",this.IF,a.Id)):(c(null),ya.a.J(36962530,375,50,"{0}:LambdaBeforeDone,RequestNull{1},",this.IF,a.Id))}else c(null)}else c(null),ya.a.J(36962525,375,50,"{0}:LambdaBeforeDone,InputNull",this.IF)}catch(F){a="WACAL LambdaBefore Exception",this.Zle&&(a=String.format("WACAL LambdaBefore Exception Message: {0}, Stack: {1}",
F.message,F.stack)),ya.a.J(37835210,375,10,a),c(null)}}Wae(a,b,c){ya.a.J(36962564,375,50,"{0}:LambdaRemoteStart",this.IF);a?this.Xne.gx(a.ContextId,a,c):(c(null),ya.a.J(36962566,375,50,"{0}:LambdaRemoteDone,InputNull",this.IF))}FHa(a,b,c){if(!u.AFrameworkApplication.Xg&&a&&a.data){var f=(new Date).getTime(),l=a.data.state;if(l){try{var x=fe.a(a.data.Zd)}catch(F){l.JUc(null);ya.a.J(36525527,375,10,"Try parse aug response failed:{0}",F.message);return}x&&(x.Telemetry=String.format("{0}, LambdaRemoteDoneAndSucceed:{1}",
b,f.toString()),c&&(c.d[Vk.PDh]=f,x.DashboardTelemetry=Ri.c(c)));l.JUc(x);ya.a.J(36962571,375,50,"{0}:LambdaRemoteDone,Succeeded",this.IF)}}}DHa(a,b){!u.AFrameworkApplication.Xg&&a&&a.data&&(b=String.format("{0}, LambdaRemoteDoneAndFailed: {1}",b,(new Date).getTime().toString()),ya.a.J(36525529,375,10,"Tile check request failed with: {0}, time: {1}",a.data.Zd,b),(a=a.data.state)&&a.JUc(null))}}Object(e.a)(yu,"ProofingTileCheckWacALWorkflow",null,[824,1276]);class zu{constructor(){this.groupType=0}}
Object(e.a)(zu,"AnalyzerData",null,[]);class bj{constructor(){this.nodes=this.metadata=null}}Object(e.a)(bj,"TopologyNode",null,[]);class Wo{constructor(){this.TileElements=this.AnalyzerData=this.RevisionId=this.TileId=null}}Object(e.a)(Wo,"Content",null,[]);class hw{constructor(){this.value=this.typeName=this.name=this.languageId=this.id=null}}Object(e.a)(hw,"CritiqueTypeOption",null,[]);class Au{constructor(){this.isCompliant=!1;this.licenseType=0}}Object(e.a)(Au,"Descriptors",null,[]);class Bu{constructor(){this.AppId=
this.SessionId=null;this.RequestOrderInSession=0;this.OverriddenCritiqueTypeOptions=this.Descriptors=this.Topology=this.Content=this.LanguageUxId=null}}Object(e.a)(Bu,"EditorServiceTileCheckRequest",null,[]);class dy{constructor(){this.indentationLevel=this.listLevel=this.listType=0;this.listTag=null;this.listElementIndex=this.listNumeration=0}}Object(e.a)(dy,"ListMetadata",null,[]);var Do;(function(a){a[a.Undefined=0]="Undefined";a[a.AlphaLcParenBoth=1]="AlphaLcParenBoth";a[a.AlphaUcParenBoth=2]=
"AlphaUcParenBoth";a[a.AlphaLcParenR=3]="AlphaLcParenR";a[a.AlphaUcParenR=4]="AlphaUcParenR";a[a.AlphaLcPeriod=5]="AlphaLcPeriod";a[a.AlphaUcPeriod=6]="AlphaUcPeriod";a[a.ArabicParenBoth=7]="ArabicParenBoth";a[a.ArabicParenR=8]="ArabicParenR";a[a.ArabicPeriod=9]="ArabicPeriod";a[a.ArabicPlain=10]="ArabicPlain";a[a.RomanLcParenBoth=11]="RomanLcParenBoth";a[a.RomanUcParenBoth=12]="RomanUcParenBoth";a[a.RomanLcParenR=13]="RomanLcParenR";a[a.RomanUcParenR=14]="RomanUcParenR";a[a.RomanLcPeriod=15]="RomanLcPeriod";
a[a.RomanUcPeriod=16]="RomanUcPeriod";a[a.CircleNumDbPlain=17]="CircleNumDbPlain";a[a.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";a[a.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";a[a.ArabicDbPeriod=20]="ArabicDbPeriod";a[a.ArabicDbPlain=21]="ArabicDbPlain";a[a.Ea1ChsPeriod=22]="Ea1ChsPeriod";a[a.Ea1ChsPlain=23]="Ea1ChsPlain";a[a.Ea1ChtPeriod=24]="Ea1ChtPeriod";a[a.Ea1ChtPlain=25]="Ea1ChtPlain";a[a.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";a[a.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";a[a.Ea1JpnKorPeriod=
28]="Ea1JpnKorPeriod";a[a.Arabic1Minus=29]="Arabic1Minus";a[a.Arabic2Minus=30]="Arabic2Minus";a[a.Hebrew2Minus=31]="Hebrew2Minus";a[a.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";a[a.ThaiAlphaParenR=33]="ThaiAlphaParenR";a[a.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";a[a.ThaiNumPeriod=35]="ThaiNumPeriod";a[a.ThaiNumParenR=36]="ThaiNumParenR";a[a.ThaiNumParenBoth=37]="ThaiNumParenBoth";a[a.HindiAlphaPeriod=38]="HindiAlphaPeriod";a[a.HindiNumPeriod=39]="HindiNumPeriod";a[a.HindiNumParenR=40]="HindiNumParenR"})(Do||
(Do={}));Object(e.b)("ListNumeration",Do);var jt;(function(a){a[a.Undefined=0]="Undefined";a[a.Bullet=1]="Bullet";a[a.Numbered=2]="Numbered"})(jt||(jt={}));Object(e.b)("ListType",jt);class iw{constructor(){this.tileContextDictionary=this.readingOrderTopology=this.tiles=this.overriddenCritiqueTypeOptions=this.languageUxId=this.documentSessionId=this.documentId=this.descriptors=null}}Object(e.a)(iw,"ProofingRequest",null,[]);class fs{constructor(){this.Id=null;this.Type=0;this.NumberOfChildren=this.Children=
this.AnalyzerData=null;this.AreChildrenOrdered=!1}}Object(e.a)(fs,"TopologyNode",null,[]);class jw{constructor(){this.nodes=null}}Object(e.a)(jw,"ReadingOrderTopology",null,[]);class kw{constructor(){this.Length=this.Start=0;this.LanguageId=null;this.DoNotCheck=!1}}Object(e.a)(kw,"Span",null,[]);class lw{constructor(){this.elements=this.metadata=null;this.subType=0}}Object(e.a)(lw,"TextTile",null,[]);class Cu{constructor(){this.text=null;this.textUnit=0;this.spans=this.listMetadata=this.languageId=
null;this.isClean=!1}}Object(e.a)(Cu,"TextTileElement",null,[]);class Du{constructor(){this.doNotProcess=!1;this.languageId=null;this.start=this.length=0}}Object(e.a)(Du,"TextTileElementSpan",null,[]);class Eu{constructor(){this.analyzerData=null;this.numberOfChildrenOnClient=0}}Object(e.a)(Eu,"TileContext",null,[]);class Fu{constructor(){this.AnalyzerData=this.Text=null;this.TextUnit=0;this.LanguageId=null;this.IsClean=!1;this.Spans=null}}Object(e.a)(Fu,"TileElement",null,[]);class gs{constructor(){this.tileId=
this.revisionId=null;this.tileType=0}}Object(e.a)(gs,"TileMetadata",null,[]);class kt{constructor(a,b,c,f,l,x){this.$Mg=a;this.lXc=b;this.ZMg=c;this.oF=f;this.Ga=l;this.yc=x;this.CXc=null}get cxg(){return u.AFrameworkApplication.fa.ka("IsSubscriptionForProofingUser")&&this.oF.sRa}get descriptors(){this.CXc||(this.CXc=this.o1i(),ya.a.J(37090579,375,50,"Descriptors: {0}",fe.c(this.CXc)));return this.CXc}Ael(a,b){let c;c=!0;var f=sa.a.le(u.AFrameworkApplication.lcid);if(!f)return{returnValue:null,nDa:c};
var l=new fs,x=new fs;b=Object.assign(new Bu,{Descriptors:this.descriptors,AppId:"powerPoint_Online",LanguageUxId:f.name,RequestOrderInSession:b,SessionId:u.AFrameworkApplication.userSessionId,Content:[],Topology:l,OverriddenCritiqueTypeOptions:this.lXc.VXd()});this.Ga.powerPointTopologyAndListInfoInSlideTileIsEnabled&&(l.Id=lh.a.HWb(u.AFrameworkApplication.fa.Ha("ServerDocId")).toString(),l.Type=4,l.AnalyzerData=null,l.Children=[],l.NumberOfChildren=this.yc.Nj(),l.AreChildrenOrdered=!1,x.Id=a.id,
x.Type=3,x.AnalyzerData=null,x.Children=[],x.NumberOfChildren=null,x.AreChildrenOrdered=!0,Array.add(l.Children,x));for(var F of a.drawingElems)if(this.Ga.powerPointTopologyAndListInfoInSlideTileIsEnabled&&Array.add(x.Children,this.Onl(F)),F.text&&F.text.paragraphs)for(const fa of F.text.paragraphs){if(null===fa.chars||!fa.cfRuns||!fa.cfRuns.length)continue;a=new Wo;a.TileId=fa.id;a.TileElements=[];l=new Fu;l.Text=fa.chars;l.TextUnit=8;if(fa.pfRuns&&fa.pfRuns.length&&fa.pfRuns[0].pf){f=fa.pfRuns[0].pf;
l.AnalyzerData={};if(this.Ga.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==f.listType){l.AnalyzerData.ListLevel=f.lvl;var R=jt[this.EXd(f.listType)];1===f.listType?(l.AnalyzerData.ListType=R,l.AnalyzerData.ListTag=f.listTag):0===f.listType&&(l.AnalyzerData.ListType=R,l.AnalyzerData.ListNumeration=Do[this.A7f(f.listNumeration)],l.AnalyzerData.ListElementIndex=f.listElementIndex)}else l.AnalyzerData.IndentLevel=f.lvl;else l.AnalyzerData.ListLevel=f.lvl;l.IsClean=!f.proofingDirty;a.RevisionId=
f.revisionId}c=c&&l.IsClean;R=0;const wa=[];let Xa=null;for(const lb of fa.cfRuns)if(lb)if(f=sa.a.le(lb.cf.lang)){this.ZMg.b$c(lb.cf.lang);f=Object.assign(new kw,{Start:R,Length:lb.len,LanguageId:f.name,DoNotCheck:lb.cf.noProof});Xa||(Xa=f.LanguageId);if(Xa!==f.LanguageId||lb.cf.noProof)0<=f.Start&&0<f.Length&&f.Start+f.Length<=l.Text.length?wa.push(f):(f.Length||f.Start!==l.Text.length)&&ya.a.J(36823815,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",f.Start,f.Length,l.Text.length);
R+=lb.len}else R+=lb.len;!l.IsClean&&0<wa.length&&(l.Spans=Array.clone(wa));l.LanguageId=Xa;Ma.a.Va(l.LanguageId)?ya.a.J(38385410,375,15,"Empty LanguageId, span length {0}",wa.length):(a.TileElements.push(l),b.Content.push(a))}for(x=b.Content.length-1;0<=x;x--)F=b.Content[x],F.TileElements.length&&null!==F.TileElements[0].Text||(ya.a.J(37091085,375,50,"Empty TileElements or empty text in tile {0}",F.TileId),Array.removeAt(b.Content,x));b.Content.length||ya.a.J(37091087,375,50,"Empty tiles");return{returnValue:b,
nDa:c}}Onl(a){const b=Object.assign(new fs,{Id:a.id,Type:2,AnalyzerData:{},Children:[],NumberOfChildren:a.text.paragraphs.length,AreChildrenOrdered:!0});b.AnalyzerData.GroupType=a.mk.type;for(const c of a.text.paragraphs)a=Object.assign(new fs,{Id:c.id,Type:1,NumberOfChildren:null,AreChildrenOrdered:!1}),Array.add(b.Children,a);return b}zel(a){let b;b=!0;var c=sa.a.le(u.AFrameworkApplication.lcid);if(!c)return{returnValue:null,nDa:b};var f={};c=Object.assign(new iw,{descriptors:this.JZi(this.descriptors),
languageUxId:c.name,documentSessionId:u.AFrameworkApplication.userSessionId,tiles:[],overriddenCritiqueTypeOptions:this.IZi(this.lXc.VXd()),tileContextDictionary:f,documentId:lh.a.HWb(u.AFrameworkApplication.fa.Ha("ServerDocId")).toString(),readingOrderTopology:Object.assign(new jw,{nodes:[]})});const l=this.l1h(a,c.readingOrderTopology,f);for(var x of a.drawingElems)if(x.text&&x.text.paragraphs){a=this.E_h(x,l,f);for(const F of x.text.paragraphs)({nDa:b}=this.H1h(c.tiles,F,b)),this.w0h(F,a,f)}for(f=
c.tiles.length-1;0<=f;f--)x=c.tiles[f],x.elements.length&&null!==x.elements[0].text||(ya.a.J(37091090,375,50,"Empty TileElements or empty text in tile {0}",x.metadata?x.metadata.tileId:""),Array.removeAt(c.tiles,f));c.tiles.length||ya.a.J(37091092,375,50,"Empty tiles");return{returnValue:c,nDa:b}}o1i(){if(!this.$Mg.descriptors)return null;const a=Array.clone(this.$Mg.descriptors);for(const b of a)if(this.cxg&&"licensetype"===b.Name.toLowerCase())return b.Value="Subscription",a;this.cxg&&Array.add(a,
Object.assign(new Mm,{Name:"LicenseType",Value:"Subscription"}));return a}JZi(a){const b=new Au;for(const c of a)"iscompliant"===c.Name.toLowerCase()&&(b.isCompliant="true"===c.Value.toLowerCase()),"licensetype"===c.Name.toLowerCase()&&(b.licenseType="subscription"===c.Value.toLowerCase()?2:0);return b}EXd(a){switch(a){case 0:return 2;case 1:return 1;default:return 0}}IZi(a){const b=[];for(const c of a)a=Object.assign(new hw,{id:c.Id,languageId:c.LanguageId,value:c.Value}),b.push(a);return b}A7f(a){return a+
1}KZi(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}H1h(a,b,c){if(null===b.chars||!b.cfRuns||!b.cfRuns.length)return{returnValue:null,nDa:c};const f=new lw;f.metadata=new gs;f.metadata.tileId=b.id;f.metadata.tileType=1;f.elements=[];const l=new Cu;l.text=b.chars;l.textUnit=4;l.listMetadata=new dy;var x=l.isClean=!1;if(b.pfRuns&&b.pfRuns.length&&b.pfRuns[0].pf){x=b.pfRuns[0].pf;if(this.Ga.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==
x.listType){l.listMetadata.listLevel=x.lvl;var F=this.EXd(x.listType);1===x.listType?(l.listMetadata.listType=F,l.listMetadata.listTag=x.listTag):0===x.listType&&(l.listMetadata.listType=F,l.listMetadata.listNumeration=this.A7f(x.listNumeration),l.listMetadata.listElementIndex=x.listElementIndex)}else l.listMetadata.indentationLevel=x.lvl;else l.listMetadata.listLevel=b.pfRuns[0].pf.lvl,l.listMetadata.listType=this.EXd(b.pfRuns[0].pf.listType);f.metadata.revisionId=b.pfRuns[0].pf.revisionId;l.isClean=
x=!b.pfRuns[0].pf.proofingDirty;c=c&&x}F=0;const R=[];let fa=null;for(const wa of b.cfRuns)if(wa)if(b=sa.a.le(wa.cf.lang)){this.ZMg.b$c(wa.cf.lang);b=Object.assign(new Du,{start:F,length:wa.len,languageId:b.name,doNotProcess:wa.cf.noProof});fa||(fa=b.languageId);if(fa!==b.languageId||wa.cf.noProof)0<=b.start&&0<b.length&&b.start+b.length<=l.text.length?R.push(b):(b.length||b.start!==l.text.length)&&ya.a.J(36823817,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",b.start,b.length,
l.text.length);F+=wa.len}else F+=wa.len;!x&&0<R.length&&(l.spans=Array.clone(R));l.languageId=fa;if(Ma.a.Va(l.languageId))return ya.a.J(38385415,375,15,"Empty LanguageId, span length {0}",R.length),{returnValue:null,nDa:c};f.elements.push(l);a.push(f);return{returnValue:f,nDa:c}}l1h(a,b,c){const f=Object.assign(new bj,{metadata:Object.assign(new gs,{tileId:a.id,tileType:2}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new Eu,{analyzerData:new zu,numberOfChildrenOnClient:a.drawingElems.length});
c[a.id]=b;return f}E_h(a,b,c){const f=Object.assign(new bj,{metadata:Object.assign(new gs,{tileId:a.id}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new Eu,{analyzerData:Object.assign(new zu,{groupType:this.KZi(a.mk.type)}),numberOfChildrenOnClient:a.text.paragraphs.length});c[a.id]=b;return f}w0h(a,b,c){const f=Object.assign(new bj,{metadata:Object.assign(new gs,{tileId:a.id,tileType:1}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new Eu,{numberOfChildrenOnClient:0});c[a.id]=b}}Object(e.a)(kt,
"TileToTileCheckRequestTransformer",null,[1275]);class Gu{constructor(){this.oF=this.K=null}get name(){return"PowerPointWebEditor.Proofing"}Wb(a){this.K=a;this.Gri();this.Hri();this.K.register(1208,"Box4.Proofing.IEditorServiceErrorDetailsFactory").ma().na(()=>new by(u.AFrameworkApplication.fa.ka("ProofingFeedbackLoopIsEnabled"),this.K.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(1209,"Box4.Proofing.IProofingCritiqueCategoryInfoFilter").ma().na(()=>
new cy(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1210,"PowerPointWebEditor.Proofing.IProofingDashboardAggregator").ma().na(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptProofingDashboardTraceEnabled?new Oq(this.K.resolve("PowerPointWebEditor.IApplicationSettings")):new dw);this.K.register(Yv,"PowerPointWebEditor.Proofing.EditorServiceResultsManager").ma().na(()=>new Yv(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.Proofing.IProofingTextUtility"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.K.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator"),this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));this.K.register(1211,"PowerPointWebEditor.Proofing.IConsistencyCheckManager").ma().na(()=>new Xv(this.K.resolve("Box4.Graph.IGraphInstance").Bd(12),this.K.resolve("Box4.Graph.IGraphInstance").Bd(22),this.K.resolve("Box4.Graph.IGraphInstance").Bd(10),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.List.IListReader")));this.K.register(kt,"PowerPointWebEditor.Proofing.TileToTileCheckRequestTransformer").as("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer").ma().na(()=>
new kt(this.K.resolve("Box4.Proofing.IProofingDescriptors"),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(ht,"PowerPointWebEditor.Proofing.CloudALResponseTransformer").as("PowerPointWebEditor.Proofing.ICloudALResponseTransformer").ma().na(()=>
new ht);this.K.register(yu,"PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>new yu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(xu,"PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>
new xu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(vu,"PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").ma().na(()=>{const b=[],c=this.K.resolve("Common.IAppSettingsManager").ka("576");this.K.resolve("Common.IAppSettingsManager").ka("772")?b.push(c?this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"):
this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")):(b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")),c&&b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));return new vu(this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b)});this.K.register(pr.a,"Box4.Proofing.CritiqueTypeSettings").as("Box4.Proofing.ICritiqueTypeSettings").ma().na(()=>new pr.a(this.K.resolve("Box4.IRoamingServiceRequestManager"),
u.AFrameworkApplication.fa.Ha("PptRoamingServiceGetActionName"),u.AFrameworkApplication.fa.Ha("PptRoamingServiceSaveActionName")))}init(){this.K.resolve("PowerPointWebEditor.IPPTProofingDataHandlerFactory");const a=this.K.resolve("Common.IAppSettingsManager");a.ff(()=>{this.oF=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.oF.sRa=a.ka("810");this.oF.dub=a.ka("809");this.oF.YRa=a.ka("299");if(this.oF.sRa||this.oF.dub)this.K.resolve("Box4.Proofing.IProofingDescriptors").H5d(),this.K.resolve("PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").initialize(),
this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").initialize();this.oF.YRa&&(this.K.resolve("Box4.Proofing.IProofingConfigV2Manager").init(),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings").init());this.oF.dub&&(this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").initialize())});this.K.resolve("Box4.IProofingManager").suspend()}dispose(){this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController").dispose();
this.oF.dub&&this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").dispose()}Gri(){this.K.register(1212,"PowerPointWebEditor.IPPTProofingDataHandlerFactory").ma().na(()=>new aw(this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IModifiedRangeEditor"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.ISlideReader")))}Hri(){this.K.register(1213,"PowerPointWebEditor.Proofing.IProofingBehaviorController").ma().na(()=>new bw(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.View.IShapeViewHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").SKj))}static main(){m.a.instance.Ac(new Gu)}}Object(e.a)(Gu,"PPTWebEditorProofingPackage",null,[2,3]);class Hu{constructor(a,b,c,f,l,x,F,R,fa,wa){this.od=a;this.od.Qzc(Object(D.a)(this,this.Q0g,"onTextEditViewClose"));this.od.RSb(Object(D.a)(this,this.R0g,"onTextEditViewOpen"));this.od.p5h(Object(D.a)(this,this.TWg,"onBeforeTextEditViewClose"));this.od.t5h(Object(D.a)(this,
this.S0g,"onTextEditViewUpdate"));this.zee=b;this.ni=l;this.hv=x;this.FI=c;this.Jbb=f;this.r8b=F;this.D7b=R;this.l8j=fa;this.QG=wa}get qDc(){return this.zee.instance}dispose(){this.od.XDe(Object(D.a)(this,this.Q0g,"onTextEditViewClose"));this.od.Fcd(Object(D.a)(this,this.R0g,"onTextEditViewOpen"));this.od.xQk(Object(D.a)(this,this.TWg,"onBeforeTextEditViewClose"));this.od.AQk(Object(D.a)(this,this.S0g,"onTextEditViewUpdate"))}S0g(){this.D7b.OX()}R0g(a,b){a=b.jx.shapeNode;this.FI.xjc(a,!1);this.FI.V$c(a);
this.qDc&&this.qDc.dok(a)}TWg(a,b){this.r8b.jTd(b.jx.Fd)}Q0g(a,b){a=b.jx;const c=b.jx.shapeNode,f=!!c&&c.isConnected;b.asa?this.QG.instance&&((this.QG.instance.qvb||this.QG.instance.P7)&&2===this.QG.instance.fJ||this.QG.instance.FTc)?ya.a.J(38836432,822,15,"ShapeViewElementTextEditHandler::onTextEditViewClose skipped when session is closing reason:{0}, ForceSave:{1}",this.QG.instance.fJ,this.QG.instance.FTc):(f&&c.Tfd(),c.nd?(this.FI.Myh(c),this.Jbb.lXg(),this.hv.qOe()):(this.ni.O3a(c),this.hv.XLd())):
this.l8j||this.FI.Myh(c);this.FI.xjc(b.jx.shapeNode,f&&c.TRc);this.qDc&&!a.Kp&&this.qDc.cok(c)}}Object(e.a)(Hu,"ShapeViewElementTextEditHandler",null,[106]);class Iu{constructor(a){this.dbc=null;this.M3j=a;this.reset()}Xwh(a,b){a&&this.dbc.$(a,b)}Msb(a){let b=0;this.dbc.Jb(a)&&(b=this.dbc.ga(a)?1:2);return b}Nse(a){return this.M3j?1===this.Msb(a):!1}reset(){const a=this.dbc;this.dbc=new Me.a(!1);return a}}Object(e.a)(Iu,"TextEditingRevisionInfoTracker",null,[1277,1278]);var lt=d(1027),je=d(571),Ju=
d(405),Ku=d(828),zh=d(312);class ey{constructor(){this.typeField=this.startAtField=0}}Object(e.a)(ey,"CT_TextAutonumberBullet",null,[]);class fy{constructor(){this.charField=null}}Object(e.a)(fy,"CT_TextCharBullet",null,[]);class iq{}Object(e.a)(iq,"CT_TextNoAutofit",null,[]);class Lu{}Object(e.a)(Lu,"CT_TextNoBullet",null,[]);class Mu{constructor(){this.lnSpcReductionField=this.fontScaleField=0}}Object(e.a)(Mu,"CT_TextNormalAutofit",null,[]);class qr{constructor(){this.itemField=null}}Object(e.a)(qr,
"CT_TextSpacing",null,[]);class mt{constructor(){this.valField=0}}Object(e.a)(mt,"CT_TextSpacingPercent",null,[]);class gy{constructor(){this.tField=this.rPrField=null}}Object(e.a)(gy,"CT_WebRegularTextRun",null,[]);class hs{constructor(){this.pField=this.lstStyleField=this.bodyPrField=null}}Object(e.a)(hs,"CT_WebTextBody",null,[]);class hy{constructor(){this.lInsField=this.horzOverflowField=this.bInsField=this.anchorField=0;this.normAutofitField=this.noAutofitField=null;this.rotField=this.rInsField=
0;this.spAutoFitField=null;this.spcFirstLastParaField=!1;this.wrapField=this.vertOverflowField=this.vertField=this.tInsField=0}}Object(e.a)(hy,"CT_WebTextBodyProperties",null,[]);class rr{constructor(){this.altLangField=null;this.baselineField=0;this.bFieldSpecified=this.bField=this.baselineFieldSpecified=!1;this.blipFillField=null;this.capField=0;this.capFieldSpecified=!1;this.defsymField=this.deflatinField=this.defeaField=this.defcsField=this.csField=null;this.dirtyField=!1;this.embedImgLocField=
this.effectLstField=this.effectDagField=this.eaField=null;this.errField=!1;this.hlinkMouseOverField=this.hlinkClickField=this.highlightField=this.grpFillField=this.gradFillField=null;this.isDefFontFieldSpecified=this.isDefFontField=this.iFieldSpecified=this.iField=!1;this.kernField=0;this.kernFieldSpecified=!1;this.noFillField=this.lnField=this.latinField=this.langField=null;this.normalizeHFieldSpecified=this.normalizeHField=this.noProofFieldSpecified=this.noProofField=!1;this.pattFillField=null;
this.proofErrField=0;this.rawSolidFillField=null;this.rtlFieldSpecified=this.rtlField=!1;this.solidFillField=null;this.spcField=0;this.spcFieldSpecified=!1;this.stField=0;this.strikeFieldSpecified=this.strikeField=this.stFieldSpecified=!1;this.symField=null;this.szField=0;this.uFieldSpecified=this.uField=this.szFieldSpecified=!1;this.uLnTxField=this.uLnField=this.uFillTxField=this.uFillField=null;this.utField=0;this.utFieldSpecified=!1}}Object(e.a)(rr,"CT_WebTextCharacterProperties",null,[]);class is{constructor(){this.pPrField=
this.itemsField=this.endParaRPrField=null}}Object(e.a)(is,"CT_WebTextParagraph",null,[]);class gn{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.buSzTxField=this.buSzPtsField=this.buSzPctField=this.buNoneField=this.buFontTxField=this.buFontField=this.buClrTxField=this.buClrField=this.buCharField=this.buAutoNumField=null;this.defIndentFieldSpecified=this.defIndentField=!1;this.defIndentValueField=0;this.defListFieldSpecified=this.defListField=this.defIndentValueFieldSpecified=!1;this.defLnSpcField=
null;this.defMarginFieldSpecified=this.defMarginField=!1;this.defMarLValueField=0;this.defMarLValueFieldSpecified=!1;this.defSpcBefField=this.defSpcAftField=this.defRPrField=null;this.defTabSzField=0;this.eaLnBrkFieldSpecified=this.eaLnBrkField=this.defTabSzFieldSpecified=!1;this.fontAlgnField=0;this.hangingPunctFieldSpecified=this.hangingPunctField=this.fontAlgnFieldSpecified=!1;this.indentField=0;this.latinLnBrkFieldSpecified=this.latinLnBrkField=this.indentFieldSpecified=!1;this.lnSpcField=null;
this.lvlField=0;this.lvlFieldSpecified=!1;this.marLField=0;this.marLFieldSpecified=!1;this.marRField=0;this.rtlFieldSpecified=this.rtlField=this.marRFieldSpecified=!1;this.spcBefField=this.spcAftField=null}}Object(e.a)(gn,"CT_WebTextParagraphProperties",null,[]);class mw{constructor(a,b){this.shapeText=a;this.TJb=b}}Object(e.a)(mw,"ShapeTextState",null,[]);class Nu{constructor(){this.chngTyp=0;this.repChar=this.delChar=this.insChar=this.bodyPrChng=this.paraFrmtChng=this.charFrmtChng=null}}Object(e.a)(Nu,
"IncrementalRequestTextOperation",null,[]);class gk{constructor(a,b){this.len=this.cp=0;this.cp=a;this.len=b}eG(){return this.cp+this.len}contains(a){return this.cp<=a&&a<this.eG()}lva(a){return this.contains(a.cp)||a.contains(this.cp)}KCa(a){const b=Math.max(a.cp,this.cp);return new gk(b,Math.max(0,Math.min(a.eG(),this.eG())-1-b+1))}static copy(a){return new gk(a.cp,a.len)}}Object(e.a)(gk,"TextRange",null,[]);class hn{constructor(a){this.xp=a}}Object(e.a)(hn,"ChangeState",null,[]);const nw=(a,b)=>
{if(!(a&&b&&a.rPrField&&b.rPrField))return null;let c=!1;const f=new rr;a.rPrField.bField!==b.rPrField.bField&&(c=!0,f.bField=b.rPrField.bField,f.bFieldSpecified=b.rPrField.bFieldSpecified);a.rPrField.iField!==b.rPrField.iField&&(c=!0,f.iField=b.rPrField.iField,f.iFieldSpecified=b.rPrField.iFieldSpecified);a.rPrField.uField!==b.rPrField.uField&&(c=!0,f.uField=b.rPrField.uField,f.uFieldSpecified=b.rPrField.uFieldSpecified);a.rPrField.strikeField!==b.rPrField.strikeField&&(c=!0,f.strikeField=b.rPrField.strikeField,
f.strikeFieldSpecified=b.rPrField.strikeFieldSpecified);a.rPrField.szField!==b.rPrField.szField&&(c=!0,f.szField=b.rPrField.szField,f.szFieldSpecified=b.rPrField.szFieldSpecified);a.rPrField.spcField!==b.rPrField.spcField&&(c=!0,f.spcField=b.rPrField.spcField,f.spcFieldSpecified=b.rPrField.spcFieldSpecified);a.rPrField.kernField!==b.rPrField.kernField&&(c=!0,f.kernField=b.rPrField.kernField,f.kernFieldSpecified=b.rPrField.kernFieldSpecified);a.rPrField.capField!==b.rPrField.capField&&(c=!0,f.capField=
b.rPrField.capField,f.capFieldSpecified=b.rPrField.capFieldSpecified);a.rPrField.baselineField!==b.rPrField.baselineField&&(c=!0,f.baselineField=b.rPrField.baselineField,f.baselineFieldSpecified=b.rPrField.baselineFieldSpecified);!b.rPrField.latinField||a.rPrField.latinField&&a.rPrField.latinField.typefaceField===b.rPrField.latinField.typefaceField||(c=!0,f.latinField=b.rPrField.latinField);!b.rPrField.eaField||a.rPrField.eaField&&a.rPrField.eaField.typefaceField===b.rPrField.eaField.typefaceField||
(c=!0,f.eaField=b.rPrField.eaField);return c?f:null},ow=(a,b)=>{if(!(a&&b&&a.pPrField&&b.pPrField))return null;a=a.pPrField;b=b.pPrField;const c=new gn;let f=!1;sr(a.lnSpcField,b.lnSpcField)&&(c.lnSpcField=b.lnSpcField,f=!0);sr(a.defLnSpcField,b.defLnSpcField)&&(c.defLnSpcField=b.defLnSpcField,f=!0);sr(a.spcBefField,b.spcBefField)&&(c.spcBefField=b.spcBefField,f=!0);sr(a.defSpcBefField,b.defSpcBefField)&&(c.defSpcBefField=b.defSpcBefField,f=!0);sr(a.spcAftField,b.spcAftField)&&(c.spcAftField=b.spcAftField,
f=!0);sr(a.defSpcAftField,b.defSpcAftField)&&(c.defSpcAftField=b.defSpcAftField,f=!0);fe.c(a.defRPrField)!==fe.c(b.defRPrField)&&(c.defRPrField=b.defRPrField,f=!0);!a.buNoneField!==!b.buNoneField&&(c.buNoneField=b.buNoneField,f=!0);fe.c(a.buCharField)!==fe.c(b.buCharField)&&(c.buCharField=b.buCharField,f=!0);fe.c(a.buAutoNumField)!==fe.c(b.buAutoNumField)&&(c.buAutoNumField=b.buAutoNumField,f=!0);fe.c(a.buFontField)!==fe.c(b.buFontField)&&(c.buFontField=b.buFontField,f=!0);if(a.marLFieldSpecified!==
b.marLFieldSpecified||a.marLField!==b.marLField)c.marLFieldSpecified=b.marLFieldSpecified,c.marLField=b.marLField,f=!0;if(a.defMarLValueFieldSpecified!==b.defMarLValueFieldSpecified||a.defMarLValueField!==b.defMarLValueField)c.defMarLValueFieldSpecified=b.defMarLValueFieldSpecified,c.defMarLValueField=b.defMarLValueField,f=!0;if(a.marRFieldSpecified!==b.marRFieldSpecified||a.marRField!==b.marRField)c.marRFieldSpecified=b.marRFieldSpecified,c.marRField=b.marRField,f=!0;if(a.lvlFieldSpecified!==b.lvlFieldSpecified||
a.lvlField!==b.lvlField)c.lvlFieldSpecified=b.lvlFieldSpecified,c.lvlField=b.lvlField,f=!0;if(a.indentFieldSpecified!==b.indentFieldSpecified||a.indentField!==b.indentField)c.indentFieldSpecified=b.indentFieldSpecified,c.indentField=b.indentField,f=!0;if(a.defIndentFieldSpecified!==b.defIndentFieldSpecified||a.defIndentField!==b.defIndentField)c.defIndentFieldSpecified=b.defIndentFieldSpecified,c.defIndentField=b.defIndentField,f=!0;if(a.algnFieldSpecified!==b.algnFieldSpecified||a.algnField!==b.algnField)c.algnFieldSpecified=
b.algnFieldSpecified,c.algnField=b.algnField,f=!0;if(a.defTabSzFieldSpecified!==b.defTabSzFieldSpecified||a.defTabSzField!==b.defTabSzField)c.defTabSzFieldSpecified=b.defTabSzFieldSpecified,c.defTabSzField=b.defTabSzField,f=!0;if(a.rtlFieldSpecified!==b.rtlFieldSpecified||a.rtlField!==b.rtlField)c.rtlFieldSpecified=b.rtlFieldSpecified,c.rtlField=b.rtlField,f=!0;if(a.defListFieldSpecified!==b.defListFieldSpecified||a.defListField!==b.defListField)c.defListFieldSpecified=b.defListFieldSpecified,c.defListField=
b.defListField,f=!0;if(a.defMarginFieldSpecified!==b.defMarginFieldSpecified||a.defMarginField!==b.defMarginField)c.defMarginFieldSpecified=b.defMarginFieldSpecified,c.defMarginField=b.defMarginField,f=!0;if(a.eaLnBrkFieldSpecified!==b.eaLnBrkFieldSpecified||a.eaLnBrkField!==b.eaLnBrkField)c.eaLnBrkFieldSpecified=b.eaLnBrkFieldSpecified,c.eaLnBrkField=b.eaLnBrkField,f=!0;if(a.fontAlgnFieldSpecified!==b.fontAlgnFieldSpecified||a.fontAlgnField!==b.fontAlgnField)c.fontAlgnFieldSpecified=b.fontAlgnFieldSpecified,
c.fontAlgnField=b.fontAlgnField,f=!0;if(a.latinLnBrkFieldSpecified!==b.latinLnBrkFieldSpecified||a.latinLnBrkField!==b.latinLnBrkField)c.latinLnBrkFieldSpecified=b.latinLnBrkFieldSpecified,c.latinLnBrkField=b.latinLnBrkField,f=!0;return f?c:null},sr=(a,b)=>a||b?a&&b?a.itemField.valField!==b.itemField.valField:!0:!1;class tr{constructor(){this.Kn=this.lFa=null}}Object(e.a)(tr,"TextParaRange",null,[]);class js{constructor(){this.Kn=this.$Fa=null}}Object(e.a)(js,"TextRunRange",null,[]);class pw{constructor(a,
b,c,f,l,x){this.bda=this.Aka=null;this.N3=this.tja=0;this.NK=this.a3=null;this.Xta=this.UDa=0;this.WDa=c;this.AFa=f;this.uja=l;this.V8=x;this.Ifd(new gk(0,a.shapeText.length),new gk(0,b.shapeText.length))}Ifd(a,b){this.Aka=a;this.bda=b;for(a=Math.max(0,this.UDa-1);a<this.WDa.length;a++)if(this.WDa[a].Kn.lva(this.Aka)||this.Aka.eG()<=this.WDa[a].Kn.cp){this.UDa=a;break}for(a=Math.max(0,this.Xta-1);a<this.AFa.length;a++)if(this.AFa[a].Kn.lva(this.bda)||this.bda.eG()<=this.AFa[a].Kn.cp){this.Xta=a;break}this.NK=
this.a3=null;for(a=Math.max(0,this.tja-1);a<this.uja.length;a++)if(this.uja[a].Kn.lva(this.Aka)||this.Aka.eG()<=this.uja[a].Kn.cp){this.tja=a;break}for(a=Math.max(0,this.N3-1);a<this.V8.length;a++)if(this.V8[a].Kn.lva(this.bda)||this.bda.eG()<=this.V8[a].Kn.cp){this.N3=a;break}}GTf(){return this.UDa>=this.WDa.length?null:Object.assign(new tr,{lFa:this.WDa[this.UDa].lFa,Kn:this.WDa[this.UDa].Kn.KCa(this.Aka)})}HTf(){return this.Xta>=this.AFa.length?null:Object.assign(new tr,{lFa:this.AFa[this.Xta].lFa,
Kn:this.AFa[this.Xta].Kn.KCa(this.bda)})}ITf(){return this.b8d()&&this.a3?Object.assign(new js,{$Fa:this.uja[this.tja].$Fa,Kn:this.a3}):null}JTf(){return this.p3b()&&this.NK?Object.assign(new js,{$Fa:this.V8[this.N3].$Fa,Kn:this.NK}):null}a8d(){return this.Zrg()&&this.o3b()}Zrg(){return this.UDa>=this.WDa.length?!1:this.WDa[this.UDa].Kn.lva(this.Aka)}o3b(){return this.Xta>=this.AFa.length?!1:this.AFa[this.Xta].Kn.lva(this.bda)}b8d(){return!this.Zrg()||this.tja>=this.uja.length?!1:this.uja[this.tja].Kn.lva(this.WDa[this.UDa].Kn)&&
this.uja[this.tja].Kn.lva(this.Aka)}p3b(){return!this.o3b()||this.N3>=this.V8.length?!1:this.V8[this.N3].Kn.lva(this.AFa[this.Xta].Kn)&&this.V8[this.N3].Kn.lva(this.bda)}uyh(){this.a8d()&&(this.UDa++,this.Xta++);return this.a8d()}vyh(){this.o3b()&&this.Xta++;return this.o3b()}kql(){if(!this.b8d()||!this.p3b())return!1;if(this.a3&&this.NK){this.a3.eG()===this.uja[this.tja].Kn.eG()&&this.tja++;this.NK.eG()===this.V8[this.N3].Kn.eG()&&this.N3++;if(!this.b8d()||!this.p3b())return!1;var a=this.uja[this.tja].Kn.KCa(this.Aka);
this.a3.cp=Math.max(a.cp,this.a3.eG());this.a3.len=a.eG()-this.a3.cp;a=this.V8[this.N3].Kn.KCa(this.bda);this.NK.cp=Math.max(a.cp,this.NK.eG());this.NK.len=a.eG()-this.NK.cp}else this.a3=this.uja[this.tja].Kn.KCa(this.Aka),this.NK=this.V8[this.N3].Kn.KCa(this.bda);a=Math.min(this.a3.len,this.NK.len);this.a3.len=a;this.NK.len=a;return 0<a}lql(){if(!this.p3b())return!1;this.a3||(this.a3=this.uja[this.tja].Kn.KCa(this.Aka));if(this.NK){if(this.NK.eG()===this.V8[this.N3].Kn.eG()&&(this.N3++,!this.p3b()))return!1;
const a=this.V8[this.N3].Kn.KCa(this.bda);this.NK.cp=Math.max(a.cp,this.NK.eG());this.NK.len=a.eG()-this.NK.cp}else this.NK=this.V8[this.N3].Kn.KCa(this.bda);return 0<this.NK.len}}Object(e.a)(pw,"TextFormatIterator",null,[]);class ks{constructor(){this.txt=this.txtrng=null}}Object(e.a)(ks,"TextModificationData",null,[]);class nt{constructor(a,b){this.textRange=new gk(a.cp,a.len);this.text=b}}Object(e.a)(nt,"TextModificationInfo",null,[]);class qw{constructor(){this.len=this.cp=0}}Object(e.a)(qw,"TextRangeData",
null,[]);class rw{constructor(){this.charPrp=this.txtrng=null}}Object(e.a)(rw,"WebTextCharFormatChange",null,[]);class Om{constructor(){this.paraPrp=this.txtrng=null}}Object(e.a)(Om,"WebTextParaFormatChange",null,[]);class jn{constructor(a,b){this.RCg=this.qUa=this.Hyb=this.kka=this.dT=-1;this.bne=this.iee=null;this.mTa=new gk(0,0);this.Gja=new gk(0,0);this.i_=null;if(!a)throw Error.create("InputBaseTextStateNull");if(!b)throw Error.create("InputRevisedTextStateNull");this.Ewb=a;this.cbb=b;let c,
f;({PFe:a,lxe:c}=this.Feg(a.TJb));1<a.length&&(this.RCg=a[a.length-1].Kn.eG());({PFe:b,lxe:f}=this.Feg(b.TJb));this.uN=new pw(this.Ewb,this.cbb,c,f,a,b)}kqi(){this.bqi();this.cqi();this.mqi();const a=[],b=this.sqi();b&&a.push(b);a.push.apply(a,this.iqi());a.push.apply(a,this.hqi());a.push.apply(a,this.jqi());return a}Feg(a){const b=[],c=[];var f=[];var l=[];let x=0;if(!a.pField)return{PFe:f,lxe:l};for(const F of a.pField)if(a=new tr,a.lFa=F,a.Kn=new gk(x,0),f=0,F.itemsField&&F.itemsField.length){for(const R of F.itemsField)R.tField&&
R.tField.length&&(l=new js,l.Kn=new gk(x,R.tField.length),l.$Fa=R,x+=R.tField.length,f+=R.tField.length,b.push(l));x+=1;a.Kn.len=f;c.push(a)}return{PFe:b,lxe:c}}bqi(){this.dT=this.J4c(!0)}cqi(){this.dT===this.Ewb.shapeText.length?this.kka=0:(this.kka=this.J4c(!1),this.dT+this.kka>this.Ewb.shapeText.length?this.kka=this.Ewb.shapeText.length-this.dT:this.dT+this.kka>this.cbb.shapeText.length&&(this.kka=this.cbb.shapeText.length-this.dT))}mqi(){this.Hyb=this.Ewb.shapeText.length-this.dT-this.kka;this.qUa=
this.cbb.shapeText.length-this.dT-this.kka}iqi(){const a=[];if(!this.dT)return a;this.uN.Ifd(new gk(0,this.dT),new gk(0,this.dT));do this.i_=this.Sxh(),0!==this.i_.xp&&a.push(this.HKc(this.i_));while(0!==this.i_.xp);return a}sqi(){if(!this.Hyb&&!this.qUa)return null;this.mTa=new gk(this.dT,this.Hyb);this.Gja=new gk(this.dT,this.qUa);this.i_=!this.Hyb&&0<this.qUa?new hn(4):0<this.Hyb&&!this.qUa?new hn(5):new hn(6);return this.HKc(this.i_)}hqi(){const a=[];if(!this.qUa)return a;const b=new gk(this.dT-
1,1);b.cp=Math.max(0,b.cp);b.cp=Math.min(b.cp,this.RCg-1);this.uN.Ifd(b,new gk(this.dT,this.qUa));do this.i_=this.Dpl(),0!==this.i_.xp&&a.push(this.HKc(this.i_));while(0!==this.i_.xp);return a}jqi(){const a=[];if(!this.kka)return a;this.i_=null;this.uN.Ifd(new gk(this.dT+this.Hyb,this.kka),new gk(this.dT+this.qUa,this.kka));do this.i_=this.Sxh(),0!==this.i_.xp&&a.push(this.HKc(this.i_));while(0!==this.i_.xp);return a}HKc(a){if(!a)return null;const b=new Nu;b.chngTyp=a.xp;switch(a.xp){case 3:b.charFrmtChng=
Object.assign(new rw,{txtrng:this.Gja,charPrp:this.iee});break;case 2:b.paraFrmtChng=Object.assign(new Om,{txtrng:this.Gja,paraPrp:this.bne});break;case 4:b.insChar=jn.tPe(new nt(this.mTa,this.cbb.shapeText.substring(this.Gja.cp,this.Gja.eG())));break;case 5:b.delChar=jn.tPe(new nt(this.mTa,""));break;case 6:b.repChar=jn.tPe(new nt(this.mTa,this.cbb.shapeText.substring(this.Gja.cp,this.Gja.eG())))}return b}J4c(a){const b=this.Ewb.shapeText,c=this.cbb.shapeText,f=new gk(0,b.length),l=new gk(0,c.length);
let x=a?0:b.length-1,F=a?0:c.length-1;for(;f.contains(x)&&l.contains(F)&&b.charAt(x)===c.charAt(F);)x=a?x+1:x-1,F=a?F+1:F-1;return a?x:b.length-x-1}Dpl(){do{for(;this.uN.lql();){var a=this.uN.ITf(),b=this.uN.JTf();if(a&&b){var c=nw(a.$Fa,b.$Fa);this.mTa=gk.copy(a.Kn);this.Gja=gk.copy(b.Kn);if(c)return this.iee=c,new hn(3)}}if(this.uN.o3b()&&(a=this.uN.GTf(),b=this.uN.HTf(),a&&b&&(c=ow(a.lFa,b.lFa),this.mTa=gk.copy(a.Kn),this.Gja=gk.copy(b.Kn),c)))return this.bne=c,this.uN.vyh(),new hn(2)}while(this.uN.vyh());
return new hn(0)}Sxh(){do{for(;this.uN.kql();){var a=this.uN.ITf(),b=this.uN.JTf();if(a&&b){var c=nw(a.$Fa,b.$Fa);this.mTa=gk.copy(a.Kn);this.Gja=gk.copy(b.Kn);if(c)return this.iee=c,new hn(3)}}if(this.uN.a8d()&&(a=this.uN.GTf(),b=this.uN.HTf(),a&&b&&(c=ow(a.lFa,b.lFa),this.mTa=gk.copy(a.Kn),this.Gja=gk.copy(b.Kn),c)))return this.bne=c,this.uN.uyh(),new hn(2)}while(this.uN.uyh());return new hn(0)}static tPe(a){return Object.assign(new ks,{txt:a.text,txtrng:jn.sll(a.textRange)})}static sll(a){return Object.assign(new qw,
{cp:a.cp,len:a.len})}}Object(e.a)(jn,"IncrementalChangeIterator",null,[]);class sw{constructor(){this.rh=this.bh=this.increq=null}}Object(e.a)(sw,"TextLayoutDeltaClientRequestData",null,[]);class tw{constructor(){this.tb=null;this.h=this.w=0}}Object(e.a)(tw,"TextLayoutFullClientRequest",null,[]);class uw{constructor(){this.corr=this.id=null;this.h={};this.delta=this.full=null}}Object(e.a)(uw,"TextLayoutRequest",null,[]);class Ou{constructor(a,b,c,f,l,x){this.g$b=this.wl=null;this.U7b=!0;this.rFa=
-1;this.Z5j=(new Date).getTime();this.dab=this.Eja=0;this.Q6b=-1;this.nee=5E3;const F=document.createElement("a");F.href=a;F.protocol="http:"===F.protocol?"ws":"wss";this.LAb=F.href;this.q3=b;this.JVb();this.FKg=c;this.tLg=f;this.x5j=l;this.tne=x.nll;this.i0c=x.mll;this.LNg=x.jll;this.$1c=x.ill;this.Fka=this.LNg;this.LJe()}onMessage(a){if(a&&a.data)if(a.data.startsWith("pong"))this.lCb(a.data);else if(a=JSON.parse(a.data)){a.h||(a.h={});a.h.bEnd=(new Date).getTime().toString();try{this.tLg&&this.tLg(a)}catch(b){ya.a.J(578828128,
824,50,(this.q3?"Dark Traffic ":"")+"Exception in OnTextLayoutReceived: {0}",b.toString())}if(this.FKg){const b={Caller:"WebSocketTextLayoutFetcher.OnMessage"};b.Telemetry=a.h;b.Response=a.resp;b.First=this.U7b;this.FKg(b)}this.U7b=!1}else ya.a.J(592304271,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnMessage Empty Response")}onClose(a){ya.a.J(592840414,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnClose {0}",JSON.stringify(a))}onError(a){ya.a.J(592840412,
820,10,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnError {0}",JSON.stringify(a))}onOpen(){ya.a.J(592840410,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnOpen");this.lic();this.ping();this.x5j()}LJe(){this.g$b=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.Q6b),this.wl||(ya.a.J(587522389,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Tva())):this.Q6b=
window.setTimeout(()=>{this.wl&&(ya.a.J(587522387,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.wl.close(),this.wl=null,window.clearTimeout(this.rFa))},this.nee)};window.self.addEventListener("visibilitychange",this.g$b)}JVb(){this.wl&&this.wl.close();this.wl=new WebSocket(this.LAb,[]);this.wl.onopen=Object(D.a)(this,this.onOpen,"onOpen");this.wl.onerror=Object(D.a)(this,this.onError,"onError");this.wl.onclose=Object(D.a)(this,
this.onClose,"onClose");this.wl.onmessage=Object(D.a)(this,this.onMessage,"onMessage")}lic(){this.Eja=0}iHd(){0<this.$1c&&(new Date).getTime()-this.dab>this.$1c&&(this.lic(),ya.a.J(587337758,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server after long pause."))}aLd(){return(new Date).getTime()-this.dab>this.Fka&&this.Eja<this.i0c&&(!this.wl||3===this.wl.readyState||2===this.wl.readyState)}QIe(){this.dab=(new Date).getTime();this.Fka=Math.pow(2,this.Eja)*this.LNg;
0<this.$1c&&(this.Fka=Math.min(this.Fka,this.$1c));window.setTimeout(()=>{this.Tva()},this.Fka)}Tva(){this.iHd();this.aLd()&&(this.JVb(),this.QIe(),this.Eja++,ya.a.J(588071072,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server."),this.Eja===this.i0c&&ya.a.J(588071070,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Max retries reached."))}fetch(a){this.wl?(ya.a.J(587804674,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch. WebSocket state {0}",
np[this.wl.readyState]),1===this.wl.readyState?this.wl.send(fe.c(a)):this.Tva()):ya.a.J(587522383,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch Websocket is unavailable.")}ping(){this.wl?1===this.wl.readyState?this.wl.send("ping"+((new Date).getTime()-this.Z5j).toString()):(ya.a.J(588294232,820,10,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping. Wrong WebSocket state {0}",this.wl.readyState),this.Tva()):ya.a.J(587522380,820,50,(this.q3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping Websocket is unavailable.")}lCb(){-1!==
this.rFa&&window.clearTimeout(this.rFa);this.rFa=window.setTimeout(()=>{this.ping()},this.tne)}}Object(e.a)(Ou,"WebSocketTextLayoutFetcher",null,[1309]);class ur{constructor(a,b,c,f,l,x,F){this.eAb=this.rbb=this.iGg=this.hGg=null;this.nextId=1;this.vee=-1;this.uee=0;this.The=!0;if(!a)throw Error.argumentNull("shapeReader");if(!b)throw Error.argumentNull("topologyManager");if(!c)throw Error.argumentNull("clientRequestManager");if(!f)throw Error.argumentNull("walls");if(!l)throw Error.argumentNull("appSettings");
if(!x)throw Error.argumentNull("shapeViewLineBreakTelemetry");this.Ea=a;this.Vp=b;this.tda=f;this.la=l;this.tT=-1;x.execute(R=>{this.rbb=R});this.la.pll&&(this.hGg=new Ou(this.la.lll,!1,Object(D.a)(this,this.WWj,"logOnResponseReceived"),Object(D.a)(this,this.cpk,"onTextLayoutReceived"),Object(D.a)(this,this.qXg,"onConnectionOpen"),this.la),this.la.N5g&&(this.iGg=new Ou(this.la.kll,!0,Object(D.a)(this,this.VWj,"logOnDarkTrafficResponseReceived"),null,Object(D.a)(this,this.qXg,"onConnectionOpen"),this.la)));
this.Zca=F}vL(a,b,c){ya.a.J(512495621,820,50,"TextLayoutManager::OnTimeout - Fallback to HTML Text Layout for this shape ");if(-1!==this.tT){window.clearTimeout(this.tT);this.tT=-1;var f=this.Vp.presentation;f?(a=Object(va.a)(123,f.KB(oe.a.bE(a,b))))?(c=a.oS(c))?c.Fhb(!1):ya.a.J(512495618,820,50,"TextLayoutManager::OnTimeout, IShapeNode is null"):ya.a.J(512495619,820,50,"TextLayoutManager::OnTimeout, ISlide is null"):ya.a.J(512495620,820,50,"TextLayoutManager::OnTimeout, IPageManifestNode is null")}}UWj(){this.uee++;
-1===this.vee&&(this.vee=window.setTimeout(Object(D.a)(this,this.pik,"onCoauthLogTimer"),3E5))}pik(){this.vee=-1;ya.a.J(512495617,820,50,"TextLayoutManager::LogOnCoAuth, CoAuthRequestCount {0}",this.uee);this.uee=0}ldg(a){let b="";a.WI(c=>{(c=Object(va.a)(te.AParagraphNode,c))&&(b+=Ya.ParagraphReader.text(c)+"\n")});return b.substr(0,b.length-1)}lqi(a){try{var b=Object,c=b.assign,f=new sw,l=this.eAb;const wa=[];var x,F=l.TJb.bodyPrField,R=a.TJb.bodyPrField;let Xa=!1;F.anchorField!==R.anchorField&&
(Xa=!0);F.bInsField!==R.bInsField&&(Xa=!0);F.tInsField!==R.tInsField&&(Xa=!0);F.lInsField!==R.lInsField&&(Xa=!0);F.rInsField!==R.rInsField&&(Xa=!0);F.horzOverflowField!==R.horzOverflowField&&(Xa=!0);F.vertOverflowField!==R.vertOverflowField&&(Xa=!0);fe.c(F.normAutofitField)!==fe.c(R.normAutofitField)&&(Xa=!0);fe.c(F.spAutoFitField)!==fe.c(R.spAutoFitField)&&(Xa=!0);F.rotField!==R.rotField&&(Xa=!0);F.spcFirstLastParaField!==R.spcFirstLastParaField&&(Xa=!0);F.wrapField!==R.wrapField&&(Xa=!0);(x=Xa?
R:null)&&wa.push(Object.assign(new Nu,{chngTyp:1,bodyPrChng:x}));const lb=new jn(l,a);var fa=wa.concat.apply(wa,lb.kqi());const Lb=c.call(b,f,{increq:fa});ya.a.J(512495616,820,50,"TextLayoutManager::FetchLineBreakInfo Incremental request size {0}",fe.c(Lb).length);return Lb}catch(wa){ya.a.J(512493795,820,10,"TextLayoutManager::Generate Incremental Requests Exception {0}",wa.message)}return null}CUd(a,b){if(this.la.Hvh&&a)if(b&&ya.a.J(512493794,820,50,"TextLayoutManager::FetchLineBreakInfo, TextLayout- First request for this shape sent on Begin Edit."),
this.tda.kii())if(0!==this.tda.wli(a,this.Ea))a.Fhb(!1);else{if(!a.Axb)if(b)a.Fhb(this.la.lIb);else return;if(!a.PB&&a.Fba().length&&(a.YIa||4===a.LR))try{const c=this.V1d(a),f=Object.assign(new uw,{id:this.nextId.toString(),corr:lh.a.create().toString()});if(this.la.oll)if(!this.eAb||b||this.The)this.eAb=new mw(this.ldg(a),c),this.The=!1;else{const x=this.ldg(a),F=new mw(x,c),R=lt.a.urb(fe.c(this.eAb.TJb));f.delta=this.lqi(F);f.delta&&(f.delta.bh=R,f.delta.rh=lt.a.urb(fe.c(F.TJb)));if(f.delta&&!f.delta.increq.length)if(this.la.sPe)f.delta=
null;else return;if(f.delta&&f.delta.increq.length)for(const fa of f.delta.increq)if(fa.repChar){fa.repChar.txtrng.len===this.eAb.shapeText.length&&(f.delta=null);break}this.eAb=F}f.delta&&f.delta.increq.length&&!this.la.sPe||(f.full=Object.assign(new tw,{tb:c,w:a.YIa?a.YIa.Right:a.get_widthPersisted(),h:a.YIa?a.YIa.Bottom:a.get_heightPersisted()}));this.nextId+=1;-1!==this.tT&&window.clearTimeout(this.tT);this.tT=window.setTimeout(()=>{this.vL(a.slideId.sid,a.slideId.cid,a.get_shapeId())},this.la.qll);
f.h={["bStart"]:(new Date).getTime().toString()};f.h.shapeId=a.get_shapeId();f.h.sid=a.slideId.sid;f.h.cid=a.slideId.cid;f.h.timeoutId=this.tT;f.h.reqHash=lt.a.urb(fe.c(c));f.h.reqSz=fe.c(f).length;f.h.firstRequest=b;f.h.deltaCompare=this.la.sPe;const l=a.mfj();b&&l&&(f.h.initialTextLayout=l.toString());this.hGg.fetch(f);this.la.N5g&&this.iGg.fetch(f)}catch(c){ya.a.J(512493793,820,10,"WebSocketTextLayoutFetcher::FetchLineBreakInfo Exception {0}",c.message)}}else this.UWj(),a.Fhb(!1)}zQf(a,b){switch(a.listType){case 16:b.buNoneField=
new Lu;b.buCharField=null;b.buAutoNumField=null;break;case 0:b.buNoneField=null;b.buCharField=null;b.buAutoNumField=Object.assign(new ey,{startAtField:a.Yz});b.buAutoNumField.typeField=8;break;default:b.buNoneField=null,b.buCharField=new fy,b.buCharField.charField="\u2022",b.buAutoNumField=null,b.buFontField=new Dk,b.buFontField.typefaceField=a.font}}gQa(a){const b=new mt;b.__type=ur.JSj;b.valField=Math.floor(1E5*a);return b}Vti(a){const b=new gn;var c=new mb.GraphIterator;c.set(a);c.mc(11);c.Ng(11);
a.Rf.Fw(c)?this.zQf(a.Rf.Fw(c),b):this.zQf(uj.a.kP(16,0),b);c=a.sa(Bb.a.Il,Sg.a.leftMargin);const f=a.sa(Bb.a.kX,Sg.a.rightMargin);b.indentField=je.a.Tkd(a.sa(Bb.a.Mn,Sg.a.indent));b.indentFieldSpecified=!0;b.marLField=je.a.Tkd(c);b.marLFieldSpecified=!0;b.marRField=je.a.Tkd(f);b.marRFieldSpecified=!0;b.defTabSzField=je.a.Tkd(a.sa(Bb.a.Ppb,ur.RBc));b.defTabSzFieldSpecified=!0;b.lvlField=a.sa(Bb.a.listLevel,Sg.a.vCa);b.lvlFieldSpecified=!0;b.algnField=this.gll(a.sa(bb.a.pl,1));b.algnFieldSpecified=
!0;2===this.Zca.xV(a).lineSpacing.Pf&&(b.lnSpcField=new qr,b.lnSpcField.itemField=this.gQa(this.Zca.xV(a).lineSpacing.value));2===this.Zca.xV(a).beforeSpacing.Pf&&(b.spcBefField=new qr,b.spcBefField.itemField=this.gQa(this.Zca.xV(a).beforeSpacing.value));2===this.Zca.xV(a).afterSpacing.Pf&&(b.spcAftField=new qr,b.spcAftField.itemField=this.gQa(this.Zca.xV(a).afterSpacing.value));a=Yb.OutlineElementNavigator.rA(a);a.properties.Sa(bb.a.iX)&&(b.rtlField=a.Sh(bb.a.iX));return b}gll(a){switch(a){case 2:return 1;
case 1:return 0;case 3:return 2;case 4:return 3;default:return 0}}V1d(a){try{const b=Object.assign(new hs,{bodyPrField:new hy,pField:[]});b.bodyPrField.noAutofitField=a.w9?new iq:null;a.Sa(ub.a.z1)&&(b.bodyPrField.normAutofitField=new Mu,b.bodyPrField.normAutofitField.fontScaleField=Math.floor(1E5*a.z1));a.Sa(ub.a.Fpa)&&(b.bodyPrField.normAutofitField||(b.bodyPrField.normAutofitField=new Mu),b.bodyPrField.normAutofitField.lnSpcReductionField=Math.floor(1E5*a.Fpa));b.bodyPrField.rotField=Math.floor(a.vPe);
b.bodyPrField.vertField=a.f5;b.bodyPrField.lInsField=Math.floor(Fd.a.oBb(a.Wga));b.bodyPrField.tInsField=Math.floor(Fd.a.oBb(a.Yga));b.bodyPrField.rInsField=Math.floor(Fd.a.oBb(a.Xga));b.bodyPrField.bInsField=Math.floor(Fd.a.oBb(a.Vga));b.bodyPrField.anchorField=a.Wma;b.bodyPrField.wrapField=a.WTc?0:1;this.Ea.WI(a,c=>{if(c=Object(va.a)(te.AParagraphNode,c)){var f=Object.assign(new is,{itemsField:[]});f.pPrField=this.Vti(c);for(var l=Ya.ParagraphReader.text(c),x=0;x<c.Ra.length;){const R=new gy;R.__type=
"CT_WebRegularTextRun:#Microsoft.Office.Server.Powerpoint.Interface.Edit";var F=c.Ra.ga(x);const fa=F.cp,wa=x<c.Ra.length-1?c.Ra.ga(x+1).cp:Ya.ParagraphReader.textLength(c);x++;F.formatting?R.rPrField=this.Geg(F.formatting.cache):(F=Ju.c(c.Ra,F.cp).RUc,R.rPrField=F?this.Geg(F.cache):this.pfj(a));R.tField=Ma.a.substring(l,fa,wa);f.itemsField.push(R)}b.pField.push(f)}});return b}catch(b){throw ya.a.J(512493792,820,50,"WebSocketTextLayoutFetcher::GetWebTextBody Exception {0}",b.message),Error.create("GetWebTextBodyException");
}}Geg(a){const b=new rr;b.bField=a.isBold;b.bFieldSpecified=a.OQa;b.iField=a.isItalic;b.iFieldSpecified=a.n7a;b.uField=a.pD;b.uFieldSpecified=a.gtb;b.strikeFieldSpecified=a.ftb;b.strikeField=a.bF;b.szField=a.fontSize*Bk.a.dfc*Bk.a.w7a;b.szFieldSpecified=a.Cra;b.baselineFieldSpecified=a.Sa(ub.a.xM);b.baselineField=a.getValue(ub.a.xM);b.capFieldSpecified=a.PQa;b.capField=a.capitalization;if(a.Zig){const c=sa.a.le(a.language);b.langField=c?c.krb:"en-US"}a.Sa(ub.a.latinFont)&&(b.latinField=Object.assign(new Dk,
{typefaceField:a.getValue(ub.a.latinFont)}));a.Sa(ub.a.eastAsianFont)&&(b.eaField=Object.assign(new Dk,{typefaceField:a.getValue(ub.a.eastAsianFont)}));a.B2&&(b.rawSolidFillField=Object.assign(new zh.a,{srgbClrField:Object.assign(new Ku.a,{valField:Eb.a.Lnb(a.fontColor)})}));a.UQa&&(b.highlightField=Object.assign(new Fm.a,{srgbClrField:Object.assign(new Ku.a,{valField:Eb.a.Lnb(a.highlight)})}));a.Sa(ub.a.Hob)&&(b.spcField=a.getValue(ub.a.Hob),b.spcFieldSpecified=!0);a.Sa(ub.a.Nvb)&&(b.kernField=a.getValue(ub.a.Nvb),
b.kernFieldSpecified=!0);return b}pfj(a){const b=new rr;b.bField=a.isBold;b.bFieldSpecified=!0;b.iField=a.isItalic;b.iFieldSpecified=!0;b.uField=a.pD;b.uFieldSpecified=!0;b.strikeFieldSpecified=!0;b.strikeField=a.bF;b.szField=a.f$*Bk.a.dfc;b.szFieldSpecified=!!b.szField;const c=sa.a.le(a.ZPa());b.langField=c?c.krb:"en-US";a.Sa(ub.a.latinFont)&&(b.latinField=Object.assign(new Dk,{typefaceField:a.getValue(ub.a.latinFont)}));a.Sa(ub.a.eastAsianFont)&&(b.eaField=Object.assign(new Dk,{typefaceField:a.getValue(ub.a.eastAsianFont)}));
b.baselineField=a.xM;b.baselineFieldSpecified=!0;return b}WWj(a){if(a){ya.a.J(512493790,820,50,Ri.c(a));var b=new Map;for(let l in a){var c=l,f=a[l];"First"===c&&b.set(c,f.toString());"Telemetry"===c&&b.set(c,JSON.stringify(f))}Se.Health.instance.recordKpiUsage("TextLayoutServiceResponse",0,"pptotext",b)}else ya.a.J(512493791,820,50,"response data null")}VWj(a){a?ya.a.J(512493788,820,50,"Dark Traffic"+Ri.c(a)):ya.a.J(512493789,820,50,"Dark Traffic response data null")}qXg(){this.The=!0}p8f(a){var b=
this.Vp.presentation;if(!b)throw Error.argumentNull("Presentation is null");const c=this.uhb(a,"cid"),f=this.uhb(a,"sid");a=this.uhb(a,"shapeId");if(!c||!f||!a)return ya.a.J(512493787,820,50,"GetCurrentShapeNode - slideId or shapeId is not present in Hints"),null;b=Object(va.a)(123,b.KB(oe.a.bE(Number.parseInvariant(f),Number.parseInvariant(c))));return b?b.oS(Number.parseInvariant(a)):(ya.a.J(512493786,820,50,"GetCurrentShapeNode - ISlide is null"),null)}cpk(a){if(!a||!a.l||!a.h)if(a&&7===a.resp&&
a.h)ya.a.J(512493785,820,50,"OnTextLayoutReceived - State out of sync"),(a=this.p8f(a.h))?this.CUd(a,!0):ya.a.J(512493784,820,10,"OnTextLayoutReceived - shapenode null");else{if(ya.a.J(512493783,820,50,"OnTextLayoutReceived - Response data layout is null"),a&&!a.l){var b=new Map;b.set("CorrelationId",a.corr);4===a.resp?Se.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceWorkerFailure",!1,!0,Object.assign(new Fk.a,{extendedProperties:b})):(b.set("ResponseCode",a.resp.toString()),
Se.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceFailureResponse",!1,!0,Object.assign(new Fk.a,{extendedProperties:b})))}}else if(this.la.lIb){b=this.uhb(a.h,"timeoutId");var c=this.uhb(a.h,"firstRequest");if(b&&-1!==this.tT&&this.tT===Number.parseInvariant(b))window.clearTimeout(this.tT),this.tT=-1;else if(!c||!Boolean.parse(c))return;if(b=this.p8f(a.h)){var f=this.uhb(a.h,"initialTextLayout");c&&Boolean.parse(c)?f&&f!==a.l.toString()?(c=new Map,c.set("CorrelationId",
a.corr),c.set("ResponseCode",a.resp.toString()),c.set("InitialTextLayoutValue",f),c.set("ResponseLayout",a.l.toString()),Se.Health.instance.recordKpiFailure("TextLayoutServiceResponse","ResponseMismatchForFirstShapeRequest",!1,!0,Object.assign(new Fk.a,{extendedProperties:c})),ya.a.J(512493781,820,50,"Fallback to HTML Text Layout for this shape - different service response on begin edit."),b.Fhb(!1)):b.Fhb(!0):(f=this.uhb(a.h,"reqHash"))?(c=this.V1d(b),lt.a.urb(fe.c(c))!==f?ya.a.J(512493779,820,50,
"OnTextLayoutReceived - Response hash doesn't match the current shapetextbody"):(this.rbb&&this.rbb.D3k(f,a.l,b),b.Old(a.l))):ya.a.J(512493780,820,50,"OnTextLayoutReceived - missing request hash")}else ya.a.J(512493782,820,50,"OnTextLayoutReceived - IShapeNode is null")}}uhb(a,b){return b in a?a[b].toString():null}}ur.JSj="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";ur.RBc=1440;Object(e.a)(ur,"TextLayoutManager",null,[1215]);var ls;(function(a){a[a.noWall=0]="noWall";
a[a.coauth=1]="coauth";a[a.lineBreakBlobs=2]="lineBreakBlobs";a[a.table=3]="table";a[a.smartArt=4]="smartArt";a[a.nonRectShape=5]="nonRectShape"})(ls||(ls={}));Object(e.b)("TextLayoutWall",ls);var iy=d(847);class ot{constructor(a,b){this.ame=new Me.a(0);if(!a)throw Error.argumentNull("coauthManager");if(!b)throw Error.argumentNull("applicationSettings");this.hTa=a;this.tda=b.Kvh}j5b(a){switch(a){case 1:return!!this.tda.COAUTH;case 2:return!!this.tda.LINEBREAKBLOBS;case 3:return!!this.tda.TABLE;case 4:return!!this.tda.SMARTART;
case 5:return!!this.tda.NONRECTSHAPE}return!1}kii(){return!this.j5b(1)||this.hTa.xBa}Kli(a,b){return a?this.j5b(2)&&iy.a.v1f(a,b)?2:this.j5b(3)&&a.nd?3:this.j5b(4)&&a.Qf?4:this.j5b(5)&&4!==a.LR?5:0:0}wli(a,b){b=this.Kli(a,b);if(!this.ame.Jb(a.tJa)||this.ame.ga(a.tJa)!==b){const c=new Map;c.set("ShapeType",a.get_shapeTypeString());c.set("ShapeId",a.tJa.toString());c.set("IsShapeWalled",ls[b]);Se.Health.instance.recordKpiUsage("TextLayoutServiceBlockedShapes",0,"pptotext",c);0!==b&&(c.set("TextLayoutWall",
ls[b]),Se.Health.instance.recordKpiFailure("TextLayoutServiceBlockedShapes","TextLayoutClientWall",!1,!0,Object.assign(new Fk.a,{extendedProperties:c})))}this.ame.$(a.tJa,b);return b}}Object(e.a)(ot,"TextLayoutServiceWalls",null,[1214]);class Pu{constructor(a,b,c,f){this.jv=a;this.Le=b.Ma;this.zN=c;this.x2j=f}initialize(){this.jv.NMa(Object(D.a)(this,this.GDf,"adjustShapeViews"))}dispose(){this.jv.DEb(Object(D.a)(this,this.GDf,"adjustShapeViews"))}GDf(a,b){if((a=b.EF)&&a.Nd&&(a=a.Nd.o2(c=>c.isEditable&&
c.WP))&&a.length)for(const c of a)if(a=Object(va.a)(124,c.Ag(this.Le)))a.nCh(),c.nd&&a.Fn&&a.iwl(),!this.x2j||this.zN&&!b.JTc||a.kN||!a.yA||a.guh()}}Object(e.a)(Pu,"TextLocalRenderAdjustManager",null,[106]);class vw{constructor(){this.hbc=this.nzb=null;this.UDg=-1;this.b7b=Date.now()}yig(){return 0<=this.UDg}}Object(e.a)(vw,"LineBreakComparison",null,[]);class Qu{constructor(a){this.EG=new Me.a;this.SJg=0;this.xJf="TextLayoutServiceAccuracy";this.hQg=a}C3k(a,b){try{if(a&&b){var c=a.jD(),f=lt.a.urb(fe.c(b.V1d(a)));
if(!(0>c.length)){b=[];for(let l=0;l<c.length;l++){const x=om.a.Bi(c[l],ub.a.kIb,null);x&&(b.push.apply(b,x.Lines),b.push(-1))}if(b.length){if(!this.EG.Jb(f))this.EG.add(f,new vw);else if(this.EG.ga(f).yig())return;this.EG.ga(f).nzb=b;this.mPf(f,a)}}}}catch(l){ya.a.J(512493704,820,10,l.message)}}D3k(a,b,c){try{if(!this.EG.Jb(a))this.EG.add(a,new vw);else if(this.EG.ga(a).yig())return;this.EG.ga(a).hbc=b;this.mPf(a,c)}catch(f){ya.a.J(512493703,820,10,f.message)}}mPf(a,b){if(this.EG.ga(a)&&this.EG.ga(a).nzb&&
this.EG.ga(a).hbc){var c=!0;if(this.EG.ga(a).nzb.length!==this.EG.ga(a).hbc.length)c=!1;else for(var f=0;f<this.EG.ga(a).nzb.length;f++)if(this.EG.ga(a).nzb[f]!==this.EG.ga(a).hbc[f]){c=!1;break}ya.a.J(512493702,820,50,JSON.stringify({["UniFiedResponseMatchWithLayoutServiceResponse"]:c}));f=new Map;f.set("UniFiedResponseMatchWithLayoutServiceResponse",String.format("{0}",c));b=0<=b.Fba().indexOf("\u00a0");f.set("HasNoBreakSpace",b.toString());Se.Health.instance.recordKpiUsage(this.xJf,0,"pptotext",
f);c||(f.set("UnifiedResponseLineCount",this.EG.ga(a).nzb.length.toString()),f.set("TextLayoutResponseLineCount",this.EG.ga(a).hbc.length.toString()),Se.Health.instance.recordKpiFailure(this.xJf,"TextLayoutServiceResponseMismatchWithUnifiedResponse",!1,!0,Object.assign(new Fk.a,{extendedProperties:f})));this.EG.ga(a).UDg=Date.now()}this.Xli()}Xli(){const a=Date.now();a-this.SJg<this.hQg||(this.EG.keys.forEach(b=>{a-this.EG.get(b).b7b>this.hQg&&this.EG.remove(b);return!0}),this.SJg=a)}}Object(e.a)(Qu,
"ServiceComparisonLineBreakTelemetry",null,[1216]);class ww{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextEditing"}Wb(a){this.K=a;this.K.register(Iu,"PowerPointWebEditor.TextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoReader").ma().na(()=>new Iu(!a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));this.K.register(Hu,"PowerPointWebEditor.ShapeViewElementTextEditHandler").ma().na(()=>
new Hu(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.La("PowerpointPresence.ICoauthStateChangesHandler"),a.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),a.resolve("Box4.IEditingView"),a.resolve("PowerPointWebEditor.IApplicationSettings").skipProofingSaveWithNoEditHappened,
a.La("PowerPointWebEditor.ISessionLifetimeManager")));this.K.register(Pu,"PowerPointWebEditor.TextLocalRenderAdjustManager").ma().na(()=>new Pu(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptLayoutThrashingFixEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").msg));const b=a.resolve("PowerPointWebEditor.IApplicationSettings").Hvh;ya.a.J(590444175,820,50,"PPTWebEditorTextEditingPackage::Configure TextLayoutEnabled:{0}",
b);b&&(this.K.register(1214,"PowerPointWebEditor.ITextLayoutServiceWallManager").ma().na(()=>new ot(a.resolve("PowerPointWebEditor.CoauthManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(1215,"PowerPointWebEditor.ITextLayoutManager").ma().na(()=>{try{return new ur(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.AFrameworkApplication.He,a.resolve("PowerPointWebEditor.ITextLayoutServiceWallManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.La("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"))}catch(c){return ya.a.J(593892503,820,10,"PPTWebEditorTextEditingPackage::Configure Exception creating TextLayoutManager: "+c),null}}),this.K.resolve("PowerPointWebEditor.ITextLayoutManager"),this.K.register(1216,"PowerPointWebEditor.ITextLayoutLineBreakTelemetry").ma().na(()=>new Qu(this.K.resolve("PowerPointWebEditor.IApplicationSettings").hll)),this.K.resolve("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"))}init(){this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker");
this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler");this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").initialize()}dispose(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler").dispose();a.msg&&this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").dispose()}static main(){m.a.instance.Ac(new ww)}}Object(e.a)(ww,"PPTWebEditorTextEditingPackage",null,[2,3]);class pt{constructor(){this.capabilities=
2}}Object(e.a)(pt,"IExternalPeopleAPI",null,[]);class xw{constructor(a,b){this.OperationResult=a;this.Details=b}}Object(e.a)(xw,"ExternalGrantAccessResponse",null,[]);class yw{constructor(a,b,c,f){this.authorImageURL=this.authorColor=this.authorID=this.authorName=null;this.authorName=a;this.authorID=b;this.authorColor=c;this.authorImageURL=f}}Object(e.a)(yw,"PersonaIconProperties",null,[]);var qt=d(899),Pp=d(651),Ru=d(519);class rt extends pt{constructor(a,b,c,f,l){super();this.KU=a;this.WRh=b;this.q3e=
c;this.VGh=l}zrk(a){this.KU.bwa=a}atMentionsEnabledAsync(){return new Promise((a,b)=>{this.KU.hrg.continueWith(c=>{c.Dn||c.Wl?(Z.ULS.sendTraceTag(39068098,380,10,"AtMentionsEnabledAsync failed"),b(Pp.a.du(-2130915318))):a(this.KU.hrg.result)})})}checkUserAccess(a){return new Promise((b,c)=>{const f=this.KU.checkUserAccess([a]);f.continueWith(l=>{l.Dn||l.Wl?(Z.ULS.sendTraceTag(36287067,380,10,"PeopleManager CheckUserAccess Failed"),c(Pp.a.du(-2130915318))):b(f.result.Result[0])})})}grantUsersAccess(a){Z.ULS.sendTraceTag(37582727,
380,15,"PeopleManager CheckUserAccessAndGrantPermissions usage");return new Promise((b,c)=>{const f=this.KU.Vza(a);f.continueWith(l=>{if(l.Dn||l.Wl)Z.ULS.sendTraceTag(36287068,380,10,"PeopleManager CheckUserAccessAndGrantPermissions Failed"),c(Pp.a.du(-2130915318));else{l=f.result;var x=!l.Canceled;for(var F of l.Result)if(!F.UserCanWrite&&!F.UserCanReview){x=!1;break}F=new xw(x,l);b(F)}})})}getContactsForMentions(a,b,c){return new Promise((f,l)=>{const x=this.KU.getUserContacts(a,b,0,c,"AtMentions");
x.continueWith(F=>{F.Dn||F.Wl?(Z.ULS.sendTraceTag(36287069,380,10,"PeopleManager GetUserContacts Failed"),l(Pp.a.du(-2130915318))):f(x.result)})})}getAuthToken(){Z.ULS.sendTraceTag(539100293,380,15,"PeopleManager GetAuthToken usage");return new Promise((a,b)=>{this.q3e.continueWith(c=>{c.Dn||c.Wl?(Z.ULS.sendTraceTag(51658781,380,10,"getLokiTokenManagerTask Failed"),b(Pp.a.du(-2130915318))):this.q3e.result.x6i().then(f=>{f.isSuccess&&f.token&&0<f.token.length?(Z.ULS.sendTraceTag(539100294,380,15,"PeopleManager GetAuthToken use AAD token"),
a(f.token)):u.AFrameworkApplication.fa.Ha("LokiUserDataSignature")?(Z.ULS.sendTraceTag(539100295,380,15,"PeopleManager GetAuthToken trying alternateauth token"),this.VGh.execute(l=>{l.CXi().then(x=>{void 0!==x&&null!==x&&0<x.length?(Z.ULS.sendTraceTag(544556298,380,15,"Using LokiUserDataSignature from AlternateAuthHelper"),a(x)):0<u.AFrameworkApplication.fa.Ha("LokiUserDataSignature").length&&(Z.ULS.sendTraceTag(544556299,380,15,"Using boot LokiUserDataSignature since fail to get one from AlternateAuthHelper"),
a(u.AFrameworkApplication.fa.Ha("LokiUserDataSignature")))})})):f.isSuccess?f.token&&f.token.length||(Z.ULS.sendTraceTag(51658783,380,10,"Token is null: {0}",JSON.stringify(f)),b(Pp.a.du(-2130915318))):(Z.ULS.sendTraceTag(51658782,380,10,"GetLokiToken Failed : {0}",JSON.stringify(f)),b(Pp.a.du(-2130915318)))}).catch(f=>{Z.ULS.sendTraceTag(51658784,380,10,"Unexpected exception received from lokiTokenManager: {0}",JSON.stringify(f));b(Pp.a.du(-2130915318))})})})}getPersonaIconPropertiesArray(a){return new Promise(b=>
{const c=[];for(const l of a){let x=null;var f=l;let F=l.Email;F&&""!==F||!l.UserId||""===l.UserId||"AD"!==l.Provider||(F=Ru.a.j5a(l.UserId));F&&""!==F&&(x=this.KU.GWb(F,l.Provider,u.AFrameworkApplication.Zg,0),f=new qt.a(F,void 0,l.DisplayName));f=this.WRh.fCa(f,2);Array.add(c,new yw(l.DisplayName,l.UserId,f,x))}b(c)})}}Object(e.a)(rt,"ExternalPeopleAPI",pt,[]);class zw{constructor(){this.s2a={};this.qjb={};this.xxd={}}get(a){let b=null;const c=this.normalize(a.DisplayName);a.UserId&&a.UserId in
this.s2a?(b=this.s2a[a.UserId],!c||c in this.qjb||(this.qjb[c]=b)):c&&c in this.qjb&&(b=this.qjb[c],a.UserId&&(c in this.xxd?(delete this.xxd[c],this.s2a[a.UserId]=b):a.UserId in this.s2a||(b=null)));return b}add(a,b){a.UserId&&(this.s2a[a.UserId]=b);const c=this.normalize(a.DisplayName);!c||c in this.qjb||(this.qjb[c]=b,a.UserId||(this.xxd[c]=!0))}NZi(a){a=Array(a.ADc.length);for(var b=0;b<a.length;b++)a[b]=0;for(const c of xa.a.rK(this.s2a))b=this.s2a[c],b.sources.contains(1)&&a[b.xOf]++;return a}normalize(a){return a?
a.toLowerCase():null}}Object(e.a)(zw,"ColorLookupDict",null,[]);class Pq{constructor(a,b){this.xOf=a;this.sources=new Ha.a;this.sources.add(b)}o1h(a){this.sources.contains(a)||this.sources.add(a)}}Object(e.a)(Pq,"ColorSource",null,[]);class Aw{constructor(a){this.cLb=a;this.lEd=new zw;this.Abf=-1;this.dHh=0}fCa(a,b,c=!0){if(!this.cLb||!this.cLb.ADc.length)return Z.ULS.sendTraceTag(37053532,380,10,"Color table is null or empty"),null;if(a.IsAnonymous)a.UserId=a.ClientId||a.UserId||this.CVi();else if(!a.UserId&&
!a.DisplayName)return Z.ULS.sendTraceTag(37009498,380,100,"GetUserColor: Both userId and displayName are null"),null;const f=this.lEd.get(a);if(f)c=f.xOf,f.o1h(b);else{if(!c)return null;c=this.Q7i();this.lEd.add(a,new Pq(c,b));this.Abf=c}return this.TZi(this.cLb.ADc[c])}Q7i(){const a=this.cLb.ADc.length,b=this.lEd.NZi(this.cLb),c=this.slg(this.Abf,a);let f=c,l=!1;for(;f!==c||!l;)if(b[f])(f=this.slg(f,a))||(l=!0);else break;l&&Z.ULS.sendTraceTag(37009497,380,50,"GetNextColorIndex: relooped the color table.");
return f}slg(a,b){return(a+1)%b}CVi(){return"anonymous"+ ++this.dHh}TZi(a){return 16777215>=a?"#"+Ma.a.Gv((a&255)<<16|a&65280|(a&16711680)>>>16,6):null}}Object(e.a)(Aw,"PeopleColorUtils",null,[1328]);class jq{constructor(a,b,c,f,l,x){this.irg=new Wj.a;this.Coa=a;this.r2a=b;this.ryf=f;this.jb=c;this.ifa=l;this.vyf=x;this.jb.ff(()=>{this.fullAppSettingsReady()})}fullAppSettingsReady(){const a=u.AFrameworkApplication.Jhb||u.AFrameworkApplication.ZP,b=this.jb.ka("PeopleEndPointIsEnabled");let c=b&&!a&&
(this.Cec||this.NHb&&this.OHb);const f=this.jb.ka("DisableAtmentionsForTeams"),l=this.jb.ka("ConsumerMentionsHostIsEnabled")||this.ryf.Nth;c=c&&l&&this.Lth&&this.Kth&&!f;this.jb.ka("ConsumerMentionsHostIsEnabled")&&(c=c&&this.jb.ka("OneDriveConsumerMentionsIsEnabled"));Z.ULS.sendTraceTag(37083014,380,50,"isAtMentionsEnabled:{0}, PeopleEndPointIsEnabled:{1}, PermissionsPostMessage:{2}, SupportsCheckUserAccess:{3}, SupportsGrantUserAccess:{4}, SupportsAddActivities:{5}, IsAnonymousUser:{6}, SupportsActivitiesNotification:{7}",
c,b,this.Cec,this.NHb,this.OHb,this.Lth,a,this.Kth);this.irg.Bg(c);c&&this.ifa&&this.ifa.Xj(4,Object(D.a)(this,this.uve,"onInteractiveReady"))}uve(){const a=this.jb.Ec("NumberOfContactsToFetchOnBoot",100);0>=a||this.getUserContacts("",a,0,!1,"AtMentions").continueWith(b=>{(b.Wl||b.Dn)&&Z.ULS.sendTraceTag(50402056,380,50,"Failed to prefetch contacts on boot")})}get NHb(){return this.r2a.NHb}get tae(){return this.vyf.tae}get OHb(){return this.r2a.OHb}get Cec(){return this.r2a.Cec}get Lth(){return this.jb.ka("SupportsAddActivities")}get Kth(){return this.jb.ka("SupportsActivitiesNotification")}Vza(a){return this.r2a.Vza(a)}uWb(a,
b){return this.r2a.uWb(a,b)}get hrg(){return this.irg.task}get bwa(){return this.Coa.bwa}set bwa(a){this.Coa.bwa=a}checkUserAccess(a){Z.ULS.sendTraceTag(37083015,380,50,"CheckUserAccess");return this.r2a.checkUserAccess(a)}grantUserAccess(a,b,c,f,l){return this.r2a.grantUserAccess(a,b,c,f,l)}getUserContacts(a,b,c,f,l){return this.ryf.getUserContacts(a,b,c,f,l)}GWb(a,b,c,f){return this.vyf.GWb(a,b,c,f)}supportsExchangeRestApis(){const a=new Wj.a,b=this.Coa.supportsExchangeRestApis();b.continueWith(()=>
{b.Wl||b.Dn?a.Bg(!1):a.Bg(!0)});return a.task}}Object(e.a)(jq,"PeopleManager",null,[1327,1325]);var Qp=d(368);class Qq{}Object(e.a)(Qq,"CheckUserAccessRequestItem",null,[]);class Bw extends Qp.a{constructor(a,b,c){super(a,b);this.Users=null;this.Users=this.xOd(c)}xOd(a){const b=[];for(const c of a)Array.add(b,Object.assign(new Qq,{Id:c.UserId,Provider:c.Provider}));return b}Ik(){return 1}}Object(e.a)(Bw,"CheckUserAccessRequest",Qp.a,[]);class Su extends Qp.a{constructor(a,b,c,f,l,x,F){super(a,b);
this.Filter=null;this.Skip=this.Limit=0;this.SearchGal=!1;this.Scenario=null;this.Filter=c;this.Limit=f;this.SearchGal=x;this.Skip=l;this.Scenario=F}Ik(){return 2}}Object(e.a)(Su,"GetUserContactsRequest",Qp.a,[]);class Cw extends Qp.a{constructor(a,b,c,f,l,x,F){super(a,b);this.Scenario=this.Users=null;this.GrantReviewAccess=this.GrantWriteAccess=this.GrantReadAccess=!1;this.Users=this.xOd(c);this.Scenario=f;this.GrantReadAccess=l;this.GrantWriteAccess=x;this.GrantReviewAccess=F}xOd(a){const b=[];
for(const c of a)Array.add(b,Object.assign(new Qq,{Id:c.UserId,Provider:c.Provider}));return b}Ik(){return 4}}Object(e.a)(Cw,"GrantUserAccessRequest",Qp.a,[]);class Dw extends Qp.a{constructor(a,b){super(a,b)}Ik(){return 5}}Object(e.a)(Dw,"SupportsExchangeRestApisRequest",Qp.a,[]);var st=d(518);class ms{constructor(a,b,c,f){this.bwa=null;this.tTh=a;this.$Za=b;this.jb=c;this.j_a=f}get VSk(){return this.jb.Ec("GetUserContactsRequestSentTimeoutMs",6E4)}checkUserAccess(a){if(!a||!a.length)return Z.ULS.sendTraceTag(37757202,
380,15,"no user in the request"),a=new Wj.a,a.setException(Error.argumentNull("Can't pass empty list to checkUserAccess calls")),a.task;Z.ULS.sendTraceTag(37757203,380,50,"CheckUserAccess: num people:{0}",a.length);const b=new Wj.a,c=this.j_a.execute(new Bw(this.$Za(),null,a),(f,l,x)=>this.NGc(f,l,x,"CheckUserAccess"),this.bwa);c.continueWith(()=>{if(c.Dn||c.Wl)b.GF(c.Ui);else{var f=this.Dtk(c.result.Ri);b.Bg(f)}});return b.task}grantUserAccess(a,b,c,f,l){if(!a||!a.length)return Z.ULS.sendTraceTag(37757204,
380,15,"no user in the request"),a=new Wj.a,a.Bg(null),a.task;Z.ULS.sendTraceTag(37757205,380,15,"GrantUserAccess: num people:{0}, scenario:{1}, read:{2}, write:{3}, review:{4}",a.length,b,c,f,l);const x=new Wj.a,F=this.j_a.execute(new Cw(this.$Za(),null,a,b,c,f,l),(R,fa,wa)=>this.NGc(R,fa,wa,"GrantUserAccess"),this.bwa);F.continueWith(()=>{if(F.Dn||F.Wl)Z.ULS.sendTraceTag(37028121,380,15,"GetUserAccess: request failed: {0}",F.Ui),x.GF(F.Ui);else{var R=this.gtk(F.result.Ri);x.Bg(R)}});return x.task}Dtk(a){if(!a.data)return Z.ULS.sendTraceTag(24749450,
380,10,"CheckUserAccessResponse: Data is null"),null;if(!a.data.Zd)return Z.ULS.sendTraceTag(24749451,380,10,"CheckUserAccessResponse: ResponseData is null"),null;a=st.a.z4a(a.data.Zd);return a?a.Result?a.Result:(Z.ULS.sendTraceTag(24749453,380,10,"CheckUserAccessResponse: Result field is null."),null):(Z.ULS.sendTraceTag(24749452,380,10,"CheckUserAccessResponse: Failed parsing the response"),null)}gtk(a){if(!a.data)return Z.ULS.sendTraceTag(33645598,380,10,"GrantUserAccessResponse: Data is null"),
null;if(!a.data.Zd)return Z.ULS.sendTraceTag(33645599,380,10,"GrantUserAccessResponse: ResponseData is null"),null;a=st.a.z4a(a.data.Zd);return a?a.Result?a.Result:(Z.ULS.sendTraceTag(33645601,380,10,"GrantUserAccessResponse: Result field is null."),null):(Z.ULS.sendTraceTag(33645600,380,10,"GrantUserAccessResponse: Failed parsing the response"),null)}getUserContacts(a,b,c,f,l){const x=new Wj.a,F=this.j_a.execute(new Su(this.$Za(),null,a,b,c,f,l),(R,fa,wa)=>this.NGc(R,fa,wa,"GetUserContacts"),this.bwa);
F.continueWith(()=>{if(F.Dn||F.Wl)x.GF(F.Ui);else{var R=F.result;try{const fa=this.Ctk(R.Ri);x.Bg(fa.Result)}catch(fa){x.GF(fa)}}});return x.task}Ctk(a){if(!a.data)throw Error.create("ParseUserContactsFromResponse: Data is null");if(!a.data.Zd)throw Error.create("ParseUserContactsFromResponse: ResponseData is null");a=st.a.z4a(a.data.Zd);if(!a)throw Error.create("ParseUserContactsFromResponse: Failed parsing the response");if(!a.Result)throw Error.create("ParseUserContactsFromResponse: Result field is null.");
return a}supportsExchangeRestApis(){const a=new Wj.a,b=this.j_a.execute(new Dw(this.$Za(),null),(c,f,l)=>this.NGc(c,f,l,"SupportsExchangeRestApisRequest"),this.bwa);b.continueWith(()=>{b.Dn||b.Wl?(a.GF(b.Ui),Z.ULS.sendTraceTag(50657307,380,50,"SupportsExchangeRestApis: false")):(Z.ULS.sendTraceTag(50657308,380,50,"SupportsExchangeRestApis: true"),a.TL(!0))});return a.task}NGc(a,b,c,f){return this.tTh.Fmb(a,2,c,b,2,f,null,!1,null,this.VSk)}}Object(e.a)(ms,"PeopleRequestHandler",null,[1326]);class tt{constructor(a,
b){this.KU=a;this.Ca=b;this.Ca.xa(G.a.Dli,de.a.frame,Object(D.a)(this,this.yli,"checkUserAccessAction"));this.Ca.xa(G.a.Ggj,de.a.frame,Object(D.a)(this,this.Fgj,"getUserContactsAction"));this.Ca.xa(G.a.Cli,de.a.frame,Object(D.a)(this,this.Ali,"checkUserAccessAndGrantPermissionsAction"));this.Ca.xa(G.a.Kgj,de.a.frame,Object(D.a)(this,this.Jgj,"getUserProfilePictureAction"));this.Ca.xa(G.a.pil,de.a.frame,Object(D.a)(this,this.qil,"supportsExchangeRestApisTestAction"))}qil(){this.supportsExchangeRestApis();
return 32}yli(){const a=prompt("Check User Access:Enter user names separated by ;");this.checkUserAccess(a);return 32}Fgj(){const a=prompt("Get user contacts:filter;limit;skip;searchGal");this.getUserContacts(a);return 32}Ali(){const a=prompt("CheckUserAccessAndGrantPermissions PostMessage: u1;u2;u3");this.Vza(a);return 32}Jgj(){const a=prompt("Get user profile picture: userid;provider;dimension (e.g 48, 64, 96)");this.nfg(a);return 32}$gh(){const a=prompt("What's the operation you want to do:\r\n1) Check User Access \r\n2) Grant user access \r\n3) Check User Access And Grant Permissions \r\n4) GetUserContacts \r\n5) Get User Profile Picture \r\n6) SupportsExchangeRestApis \r\n7) Exit");
try{switch(a){case "1":this.checkUserAccess(prompt("Check User Access: u1;u2;u3"));break;case "2":this.grantUserAccess();break;case "3":this.Vza(prompt("CUAGP: u1;u2;u3"));break;case "4":this.getUserContacts(prompt("Get User Contacts:filter;limit;skip;searchGal"));break;case "5":this.nfg(prompt("Get User profile picture:userid;provider;dimension;"));break;case "6":this.supportsExchangeRestApis();break;case "7":return}}catch(b){alert(b.message)}io.Task.delay(5E3).continueWith(()=>{this.$gh()})}hWk(){window.setTimeout(Object(D.a)(this,
this.$gh,"runOperations"),1E4)}supportsExchangeRestApis(){const a=this.KU.supportsExchangeRestApis();a.continueWith(b=>{if(b.Wl)alert("Exception: "+b.Ui.message);else{b=a.result;var c=new rj.StandardDialog;c.vd=0;c.Re(1,"Close");document.createElement("pre").innerText=b.toString();c.Yw("SupportsExchangeRestApis check returned",b.toString(),3,null)}})}nfg(a){a=a.split(";");const b=a[0],c=a[1];a=a[2];let f;try{f=this.A1i(a)}catch(l){alert("Invalid dimension value");return}hb.a.instance.La("Common.App.People.IPeopleManager").execute(l=>
{var x=l.GWb(b,c,u.AFrameworkApplication.Zg,f);l=document.createElement("img");l.src=x;x=new rj.StandardDialog;x.vd=0;x.Re(1,"Close");x.Yw("Profile photo",null,3,null,l)})}A1i(a){if(!a)return 0;switch(a){case "48":return 1;case "64":return 2;case "96":return 3;case "120":return 4;case "240":return 5;case "360":return 6;case "432":return 7;case "504":return 8;case "default":return 0;default:throw Error.argumentOutOfRange("unknown dimension");}}checkUserAccess(a){a=a.split(";");a=this.KU.uWb(a,"O365");
const b=this.KU.checkUserAccess(a);b.continueWith(c=>{if(c.Wl)alert("Exception: "+c.Ui.message);else{var f=b.result;c="";for(var l of f.Result)c+=l.Id+"=>"+(l.UserCanWrite?"Write":"No Write")+"\r\n";l=new rj.StandardDialog;l.vd=0;l.Re(1,"Close");f=document.createElement("pre");f.innerText=c;l.Yw("Check User Access Results",null,3,null,f)}})}grantUserAccess(){var a=prompt("GRANT_USER_ACCESS\n\nEnter semicolon-separated user names.\n\nInclude CantGrant or NotExist in names to return CannnotGrantPermission and UserDoesNotExist on Blue Chicken.\n");
const b=prompt("Enter scenario (mention or share):"),c=prompt("Enter the list of permissions to grant (e.g. Read Write Review).");a=a.split(";");a=this.KU.uWb(a,"O365");const f=0<=c.toUpperCase().indexOf("READ"),l=0<=c.toUpperCase().indexOf("WRITE"),x=0<=c.toUpperCase().indexOf("REVIEW"),F=this.KU.grantUserAccess(a,b,f,l,x);F.continueWith(R=>{if(R.Wl)alert("Exception: "+R.Ui.message);else{R=F.result;var fa="RESULTS OF GRANT_USER_ACCESS CALL\n==========================\nScenario: "+b+"\nRequested Permissions: "+
(f?"READ":"")+(l?f?" WRITE":"WRITE":"")+(x?f||l?" REVIEW":"REVIEW":"")+"\n==========================\n\n";for(const wa of R.Result)fa+="User: "+wa.Id+"\nMessage: "+wa.Message+"\nStatus Code: "+wa.Status+"\nProvider: "+wa.Provider+"\n\n";alert(fa)}})}getUserContacts(a){var b=a.split(";");a=0<b.length?b[0]:"";var c=2<b.length?b[2]:"0",f=3<b.length?b[3]:"false";b=Number.parseInvariant(1<b.length?b[1]:"10");c=Number.parseInvariant(c);f=Boolean.parse(f);const l=this.KU.getUserContacts(a,b,c,f,"AtMentions");
l.continueWith(x=>{if(x.Wl)alert("Something went wrong"+x.Ui.message);else if(x.Dn)alert("Task was canceled");else{var F=l.result;x="";for(var R of F)F="ID => "+R.Id+" \n",F+="Provider => "+R.Provider+" \n",F+="DisplayName => "+R.DisplayName+" \n",F+="GivenName => "+R.GivenName+" \n",F+="Surname => "+R.Surname+" \n",F+="Email => "+R.Email+" \n",F+="Title => "+R.Title+" \n",x+=F+"----------------------\n";R=new rj.StandardDialog;R.vd=0;R.Re(1,"Close");F=document.createElement("pre");F.innerText=x;
R.Yw("Contacts",null,3,null,F)}})}Vza(a){a=a.split(";");a=this.KU.uWb(a,"O365");const b=this.KU.Vza(a);b.continueWith(c=>{if(c.Wl)alert("Exception: "+c.Ui.message);else{c=b.result;var f="";for(var l of c.Result){var x=[];Array.add(x,l.UserCanRead?"Read YES":"Read NO");Array.add(x,l.UserCanReview?"Review YES":"Review NO");Array.add(x,l.UserCanWrite?"Write YES":"Write NO");x=l.Id+"=>"+x.join(" | ");f+=x+"\r\n"}l=new rj.StandardDialog;l.vd=0;l.Re(1,"Close");c=f+"\r\nDialog Canceled="+c.Canceled;f=document.createElement("pre");
f.innerText=c;l.Yw("Check User Access And Grant Permissions Post GrantUserAccessPrompt Results",null,3,null,f)}})}}Object(e.a)(tt,"PeopleTestHook",null,[]);var Tu=d(217);class ut{constructor(a,b,c){this.Id=a;this.Persons=b;this.UserPermissionsVerified=c}}Object(e.a)(ut,"ShowSharingUiRequestBody",null,[]);class Eo{constructor(a,b){this.P1a=null;this.bwc=new Wj.a;this.XQb=new ut(this.Byi(),a,b);Z.ULS.sendTraceTag(25036160,380,50,"Creating request with {0} persons and UserPermissionsVerified {1}",this.XQb.Persons?
this.XQb.Persons.length:0,this.XQb.UserPermissionsVerified)}get vUk(){return this.bwc.task}get id(){return this.XQb.Id}get payload(){return this.XQb}x4k(a){this.P1a=a;this.dzl()?this.bwc.TL(this.P1a):this.bwc.GF(Error.format("Format of the "+Le.a.RLd+" body is not valid"))}setException(a){Z.ULS.sendTraceTag(37515586,380,10,"message:{0}",a.message);this.bwc.GF(a)}Byi(){return Eo.OMh++}ezl(a){if(void 0===a.Id)return Z.ULS.sendTraceTag(25036161,380,10,"Persons.Id field is missing from the postmessage showSharingUiResponse of the host"),
!1;if(void 0===a.Provider)return Z.ULS.sendTraceTag(25036162,380,10,"Persons.Provider field is missing from the postmessage showSharingUiResponse of the host"),!1;void 0===a.Reason&&(Z.ULS.sendTraceTag(25036163,380,50,"Persons.Reason field is missing from the postmessage showSharingUiResponse of the host"),a.Reason=null);return void 0===a.Status?(Z.ULS.sendTraceTag(25036164,380,10,"Person.Status field is undefined"),!1):Ma.a.Vub(a.Status)?!0:(Z.ULS.sendTraceTag(25036165,380,10,"Person.Status field is not a number"),
!1)}dzl(){if(void 0===this.P1a.Persons)return Z.ULS.sendTraceTag(25036166,380,10,"Persons field is missing from the postmessage showSharingUiResponse of the host"),!1;if(!Pa.a.isArray(this.P1a.Persons))return Z.ULS.sendTraceTag(25036167,380,10,"Persons field is not an array"),!1;for(let a=0;a<this.P1a.Persons.length;a++)if(!this.ezl(this.P1a.Persons[a]))return!1;return void 0===this.P1a.DialogCanceled?(Z.ULS.sendTraceTag(25036168,380,10,"DialogCanceled field is missing from the postmessage showSharingUiResponse of the host"),
!1):void 0===this.id?(Z.ULS.sendTraceTag(25036169,380,10,"Id field is undefined"),!1):Ma.a.Vub(this.id)?!0:(Z.ULS.sendTraceTag(25036170,380,10,"ID field is not a number"),!1)}}Eo.OMh=0;Object(e.a)(Eo,"PostmessageRequestState",null,[]);class Uu{constructor(a){this.lAd=new Tu.a;this.uNb=this.a0a=null;this.k5e=!1;this.NKa=a}vvj(){Z.ULS.sendTraceTag(25036171,380,50,"ShowSharingUiPostMessageHandler.InitAsync");if(this.uNb)return this.uNb.task;this.uNb=new Wj.a;this.NKa.continueWith(()=>{Z.ULS.sendTraceTag(25036172,
380,50,"hostPostMessenger Resolved successfully");this.a0a=this.NKa.result;this.u5d();this.uNb.Bg(!0)});return this.uNb.task}u5d(){this.k5e||(Z.ULS.sendTraceTag(25190624,380,50,"InitHostPostmessenger"),this.k5e=!0,this.a0a.Vt(Le.a.RLd),this.a0a.ZA(Le.a.RLd,Object(D.a)(this,this.Bli,"checkUserAccessAndGrantPermissionsPostmessageReceived")))}Bli(a){if(a=a.Values)if(void 0===a.Id||null===a.Id)Z.ULS.sendTraceTag(25036176,380,15,"ResponseBodyTask ID is null or undefined",a.Id);else{var b=null;({value:b}=
this.lAd.Of(a.Id)).returnValue?(Z.ULS.sendTraceTag(25036178,380,50,"Detected ResponseBodyTask for message id {0}",a.Id),b.x4k(a),this.lAd.remove(a.Id)):Z.ULS.sendTraceTag(25036177,380,15,"Response does not match any postmessageRequestState in the queue. ID:{0}",a.Id)}else Z.ULS.sendTraceTag(25036175,380,15,"Postmessage ResponseBodyTask is null")}zli(a,b){const c=new Eo(a,b);this.vvj().continueWith(()=>{const f=lh.a.create().toString(),l=String.format("PostMessageId:{0}, CorrelationId:{1}",c.id,f);
Z.ULS.sendTraceTag(25036179,380,50,l);this.a0a.sendMessage(Le.a.Vza,c.payload,f)||c.setException(Error.create("Failed to send the postmessage"));this.lAd.add(c.id,c)});return c.vUk}}Object(e.a)(Uu,"ShowSharingUiPostMessageHandler",null,[]);class ns{}Object(e.a)(ns,"GrantUserAccessResponse",null,[]);var Vh=d(82);class Ew extends Sys.EventArgs{constructor(a,b,c,f){super();this.result=b;this.Tuk=a;this.WIa=c;this.scenario=f}}Object(e.a)(Ew,"ShareAndNotifyEventArgs",Sys.EventArgs,[]);class os{static Awi(a){return Vh.a.EB(os.Zn,
CommonUIStrings.l_ShareAndNotifyDialogText,a)}}os.Zn="<span id='ShareAndNotifyDialogText' class='WACDialogSpan'>{0}</span> <br/> <br/> <span id='ShareAndNotifyDialogListOfUsers' class='WACDialogSpan'>{1}</span>";Object(e.a)(os,"ShareAndNotifyDialogHtml",null,[]);class vt extends Vh.a{constructor(a,b,c){super();this.wKa=!1;this.Pa=new qd.a;this.YRh=a;this.NXh=vt.nUi(a);this.Cv=b;this.vY=c}v5h(a){this.Pa.addHandler("SNEK",a)}WLe(){this.jg=os.Awi(this.NXh);this.vd=8;this.kg="ShareAndNotifyDialog";this.showDialog(CommonUIStrings.l_ShareAndNotifyDialogTitle,
Object(D.a)(this,this.P7k,"shareAndNotifyDialogResultHandler"));this.J4("ShareAndNotifyDialogTextId")}Wua(){}dispose(){this.wKa||(super.dispose(),this.wKa=!0)}P7k(a){this.Pa.raiseEvent("SNEK",new Ew(this.YRh,a,this.Cv,this.vY))}static nUi(a){const b=new Sys.StringBuilder;for(const c of a)b.append(0<c.DisplayName.length?c.DisplayName:c.Id),b.append(", ");return b.toString().substring(0,b.toString().length-2)}}Object(e.a)(vt,"ShareAndNotifyDialog",Vh.a,[]);class Fw{constructor(a,b,c){this.Id=a;this.Provider=
b;this.DisplayName=c}}Object(e.a)(Fw,"ShowSharingUiRequestPerson",null,[]);class vr{constructor(a,b,c,f,l,x){this.Coa=a;this.jb=b;this.iVh=c;this.QU=f;this.ZHh=l;this.Rd=x}get NHb(){return this.jb.ka("SupportsCheckUserAccess")}get OHb(){return this.jb.ka("SupportsGrantUserAccess")}get Cec(){return this.jb.ka("PermissionsPostMessage")&&!this.jb.ka("CrossDocumentMessengerDisabled")&&this.ZHh()}Vza(a){const b=new Wj.a;if(Pa.a.Va(a))return b.Bg(this.QU.UNa([])),b.task;let c;const f=({tUb:c}=this.QU.JTe(a)).returnValue,
l=vr.Wti(f);0<f.length?this.Cec?this.Nbl(f,b,c,l):this.NHb&&this.OHb&&this.WLe(l,b,"mention"):b.Bg(this.QU.UNa(a));return b.task}Nbl(a,b,c,f){const l=Date.now();Z.ULS.sendTraceTag(37822867,380,15,"ShowHostSharingUi-Usage");const x=this.iVh.zli(f,c);c=new He.a(4,1,this.jb.Ec("GrantPermissionSharingDialogWatchdogInternal",12E4),Object(D.a)(this,this.checkToMakeSureDialogWasOpened,"checkToMakeSureDialogWasOpened"),100);this.Rd.Gb(c);c.customData=x;x.continueWith(F=>{if(F.Wl)Z.ULS.sendTraceTag(36300673,
380,15,"CheckUserAccessAndGrantPermissions via PostMessage failed with exception. {0}",F.Ui?F.Ui.message:"No inner exception"),b.GF(F.Ui);else{F=x.result;this.QU.jtl(F);var R=this.QU.UNa(a);R.Canceled=F.DialogCanceled;b.Bg(R);Z.ULS.sendTraceTag(37791043,380,15,"CheckUserAccessAndGrantPermissions finished in {0}ms",Date.now()-l)}})}checkToMakeSureDialogWasOpened(a){Z.ULS.sendTraceTag(37822868,380,15,"ShowHostSharingUi-WatchDog-Usage");(a=a.customData)?a.Dn?Z.ULS.sendTraceTag(37791045,380,10,"Show Sharing UI task is canceled"):
a.Wl?Z.ULS.sendTraceTag(37791046,380,10,"Show Sharing UI task has faulted"):a.isCompleted||Z.ULS.sendTraceTag(37791047,380,10,"We have not got a response from host in long time"):Z.ULS.sendTraceTag(37791044,380,10,"Response of Sharing UI is null")}WLe(a,b,c){a=new vt(a,b,c);a.v5h(Object(D.a)(this,this.rok,"onShareAndNotify"));a.WLe()}rok(a,b){let c;const f=vr.$ti(b.Tuk);switch(b.result){case 1:this.grantUserAccess(f,b.scenario,!0,!0,!0).continueWith(l=>{l.Wl?(Z.ULS.sendTraceTag(36300674,380,15,"GrantUserAccess from OnShareAndNotify failed with exception. {0}",
l.Ui?l.Ui.message:"No inner exception"),b.WIa.GF(l.Ui)):(Z.ULS.sendTraceTag(36300675,380,50,"GrantUserAccess from OnShareAndNotify succeeded."),c=this.QU.UNa(f),c.Canceled=!1,b.WIa.Bg(c))});break;default:Z.ULS.sendTraceTag(36300676,380,50,"User cancelled Share and Notify dialog"),c=this.QU.UNa(f),c.Canceled=!0,b.WIa.Bg(c)}}checkUserAccess(a){const b=new Wj.a;if(!this.NHb)return Z.ULS.sendTraceTag(36300677,380,15,"Performing a CheckUserAccess call on a host that doesn't support the operation."),b.setException(Error.invalidOperation("CheckUserAccess is not supported on this host")),
b.task;if(!a||!a.length)return b.Bg(this.QU.UNa([])),b.task;let c;const f=({tUb:c}=this.QU.JTe(a)).returnValue;if(c)Z.ULS.sendTraceTag(36300680,380,50,"CheckUserAccess response populated from cache."),b.Bg(this.QU.UNa(a));else{const l=this.Coa.checkUserAccess(f);l.continueWith(()=>{if(l.Dn||l.Wl)Z.ULS.sendTraceTag(36300678,380,10,"CheckUserAccess call failed."),b.setException(Error.create("CheckUserAccess Call failed."));else{Z.ULS.sendTraceTag(36300679,380,50,"CheckUserAccess call succeeded.");var x=
l.result;x&&this.QU.htl(x);x=this.QU.UNa(a);b.Bg(x)}})}return b.task}grantUserAccess(a,b,c,f,l){const x=new Wj.a;if(!this.OHb)return Z.ULS.sendTraceTag(36300681,380,15,"Performing a GrantUserAccess call on a host that doesn't support the operation."),x.setException(Error.invalidOperation("GrantUserAccess is not supported on this host")),x.task;if(!a||!a.length)return x.Bg(this.QU.RRf([])),x.task;let F;const R=({tUb:F}=this.QU.JTe(a)).returnValue;if(F)Z.ULS.sendTraceTag(36300684,380,50,"GrantUserAccess response populated from cache."),
x.Bg(this.QU.RRf(a));else{const fa=this.Coa.grantUserAccess(R,b,c,f,l);fa.continueWith(()=>{if(fa.Dn||fa.Wl)Z.ULS.sendTraceTag(36300682,380,10,"GrantUserAccess call failed."),x.setException(Error.create("GrantUserAccess Call failed."));else{Z.ULS.sendTraceTag(36300683,380,50,"GrantUserAccess call succeeded.");var wa=fa.result;this.QU.itl(wa,c,f,l);wa=Object.assign(new ns,{Result:wa});x.Bg(wa)}})}return x.task}uWb(a,b){const c=[];for(const f of a)c.push(new qt.a(f,b));return c}static Wti(a){const b=
[];for(const c of a)a=new Fw(c.UserId,c.Provider,""),b.push(a);return b}static $ti(a){const b=[];for(const c of a)a=new qt.a(c.Id,c.Provider),b.push(a);return b}}Object(e.a)(vr,"UserAccessUtils",null,[1325]);class Gw{constructor(a=null){a&&(this.Id=a.Id,this.Provider=a.Provider,this.Email=a.Email,this.DisplayName=a.DisplayName,this.GivenName=a.GivenName,this.Surname=a.Surname,this.Title=a.Title)}}Object(e.a)(Gw,"PersonaProperties",null,[]);class wr{constructor(a,b){this.itf=[];this.dpd=[];this.pcf=
-1;this.jb=a;this.Coa=b}get Nth(){return this.jb.ka("IsContactsResolutionEnabled")}getUserContacts(a,b,c,f,l){Z.ULS.sendTraceTag(37611683,380,15,"GetUserContacts: limit:{0}, searchGal:{1}, scenario:{2}",b,f,l);const x=new Map;x.set("Limit",b.toString());x.set("SearchGal",f.toString());x.set("Scenario",l);Se.Health.instance.recordKpiUsageForAlertableKpi("PeopleEndPointGetUserContactsBrowser","wackpitesting",x);if(!this.Nth)return Z.ULS.sendTraceTag(39145936,380,10,"Trying to get user contacts when hosts doesn't support it"),
Se.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","TriedToGetUserContactsWhenHostDoesNotSupportIt",!0,!1,null),a=new Wj.a,a.GF(Error.invalidOperation("People operations not supported by this host")),a.task;if(0>=b)return Z.ULS.sendTraceTag(39145937,380,10,"Limit should be > 0"),Se.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","LimitShouldBeGreaterThanZero",!1,!0,null),a=new Wj.a,a.GF(Error.invalidOperation("Limit should be > 0")),a.task;"Unknown"===
l&&Z.ULS.sendTraceTag(37611712,380,15,"Scenario Name was not specified");if(b<=this.pcf&&!a&&!f)return a=new Wj.a,c=this.dpd.slice(0,Math.max(b-1,this.dpd.length-1)),c=this.ESg(this.itf,c),a.Bg(c),a.task;const F=new Wj.a;let R;try{R=this.Coa.getUserContacts(a,b,c,f,l)}catch(fa){return F.GF(fa),F.task}if(f||"AtMentions"!==l)return R;R.continueWith(fa=>{if(fa.Dn||fa.Wl){fa=fa.Dn?"Canceled":fa.Ui.message;Z.ULS.sendTraceTag(39145938,380,10,"Failed to get contacts from host {0}",fa);var wa=new Map;x.set("ErrorMessage",
fa);wa=Object.assign(new Fk.a,{extendedProperties:wa});Se.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","FailedToGetContactsFromHost",!1,!0,wa);F.GF(Error.create(fa))}else this.dpd=fa=R.result,this.pcf=b,fa=this.ESg(this.itf,fa),F.Bg(fa)});return F.task}ESg(a,b){if(!a&&!b)return[];if(!b)return a;if(!a)return b;const c={};a.forEach(f=>{this.TBf(f,c)});b.forEach(f=>{this.TBf(f,c)});a=[];for(let f in c)Array.add(a,c[f]);return a}TBf(a,b){if(a&&(a=new Gw(a),a.Email&&a.DisplayName&&
a.Id&&a.Provider)){const c=b[this.BSf(a)];c&&(a.Surname||(a.Surname=c.Surname),a.GivenName||(a.Surname=c.GivenName),a.Title||(a.Surname=c.Title));b[this.BSf(a)]=a}}BSf(a){return(a.Email+a.Provider).toLocaleLowerCase()}}Object(e.a)(wr,"UserContactsUtils",null,[1324]);class Hw{}Object(e.a)(Hw,"CheckUserAccessResponse",null,[]);class Iw{}Object(e.a)(Iw,"GrantUserAccessResponseItem",null,[]);class Vu{}Object(e.a)(Vu,"UserPermissions",null,[]);class Fo{constructor(){this.dM=new Ic.a;this.TNe=0}JTe(a){let b;
const c=[];if(!a)return Z.ULS.sendTraceTag(36299549,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with null people argument."),{returnValue:c,tUb:!1};if(!a.length)return Z.ULS.sendTraceTag(36299550,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with empty IPerson array."),{returnValue:c,tUb:!1};b=!0;const f={};for(const l of a){a=Fo.uOd(l);if(a in f)continue;f[a]=!0;const x=({value:a}=this.dM.Of(Fo.uOd(l))).returnValue;x&&(!a||a.UserCanWrite||a.UserCanReview)||
Array.add(c,l);b=b&&x}return{returnValue:c,tUb:b}}htl(a){if(!a)throw Error.argumentNull("result");for(const b of a){if(void 0===b.Id||null===b.Id||!b.Id.length)throw Error.argument("item.Id");if(void 0===b.Provider||null===b.Provider||!b.Provider.length)throw Error.argument("item.Provider");this.dM.remove(Fo.EEc(b));this.dM.add(Fo.EEc(b),b)}}itl(a,b,c,f){if(!a)throw Error.argumentNull("result");for(const l of a){if(void 0===l.Id||null===l.Id||!l.Id.length)throw Error.argument("item.Id");if(void 0===
l.Provider||null===l.Provider||!l.Provider.length)throw Error.argument("item.Provider");if(0===l.Status){const x=Fo.vOd(l.Id,l.Provider);({value:a}=this.dM.Of(x)).returnValue?(a.UserCanRead=b,a.UserCanWrite=c,a.UserCanReview=f):(a=Object.assign(new Vu,{Id:l.Id,Provider:l.Provider,UserCanRead:b,UserCanWrite:c,UserCanReview:f}),this.dM.remove(x),this.dM.add(x,a))}}}jtl(a){if(!a)throw Error.argumentNull("showSharingUiResponse");a=a.Persons;if(!a)throw Error.argumentNull("showSharingUiResponse.Persons");
for(let b=0;b<a.length;b++){const c=new Vu,f=a[b];if(void 0===f.Id||null===f.Id)throw Error.argument("showSharingUiRepsonePerson.Id");void 0===f.Status||null===f.Status?Z.ULS.sendTraceTag(25036183,380,15,"ShowSharingUiResponsePerson.Status is null or undefined"):(c.UserCanRead=f.Status===this.TNe,c.UserCanWrite=f.Status===this.TNe,c.UserCanReview=f.Status===this.TNe,c.Id=f.Id,c.Provider=f.Provider,this.dM.remove(Fo.EEc(c)),this.dM.add(Fo.EEc(c),c))}}mfg(a){const b=[];for(const c of a)a=Fo.uOd(c),
this.dM.Jb(a)&&Array.add(b,this.dM.ga(a));return b}UNa(a){a=this.mfg(a);return Object.assign(new Hw,{Result:a,Canceled:!1})}RRf(a){a=this.mfg(a);const b=[];for(const c of a)b.push(Object.assign(new Iw,{Id:c.Id,Provider:c.Provider,Message:"Success. User already exists in cache with requested permissions.",Status:0}));return Object.assign(new ns,{Result:b,Canceled:!1})}static EEc(a){return Fo.vOd(a.Id,a.Provider)}static uOd(a){return Fo.vOd(a.UserId,a.Provider)}static vOd(a,b){return b+a}}Object(e.a)(Fo,
"UserPermissionsCache",null,[1323]);class Jw{constructor(a,b,c,f){this.Coa=a;this.jb=b;this.QXh=c;this.OXh=f}GWb(a,b,c,f){var l=this.Coa.bwa;l=l?String.format("{0}/{1}",l,"people.ashx"):"people.ashx";l=new Lj.QueryStringBuilder(l);l.Hi("oid","3");l.Hi("bdqs",c);(c=this.Oti(f))&&2<=c.length&&(f=c[1],l.Hi("w",c[0]),l.Hi("h",f));l.Hi("uid",a);l.Hi("p",b);l.Hi("usid",this.QXh);l.Hi("WacUserType",this.OXh);return l.toString()}Oti(a){switch(a){case 1:return["48","48"];case 2:return["64","64"];case 3:return["96",
"96"];case 4:return["120","120"];case 5:return["240","240"];case 6:return["360","360"];case 7:return["432","432"];case 8:return["504","504"];case 0:return[];default:throw Error.argumentOutOfRange("unknown dimension");}}get tae(){return this.jb.ka("IsUserProfilePictureResolutionEnabled")}}Object(e.a)(Jw,"UserProfilePictureUtils",null,[1321,1322]);var jy=d(562);class Kw{get name(){return"Common.App.People"}Wb(a){a.register(ms,"Common.App.People.PeopleRequestHandler").as("Common.App.People.IPeopleRequestHandler").ma().na(()=>
new ms(u.AFrameworkApplication.He,()=>u.AFrameworkApplication.Zg,u.AFrameworkApplication.fa,new st.a));a.register(Fo,"Common.App.People.UserPermissionsCache").as("Common.App.People.IUserPermissionsCache").ma();a.register(Uu,"Common.App.People.ShowSharingUiPostMessageHandler").ma().na(()=>new Uu(or.a.vu(a.La("Postmessage.IHostPostmessenger"))));a.register(vr,"Common.App.People.UserAccessUtils").as("Common.App.People.IUserAccessUtils").ma().na(()=>new vr(a.resolve("Common.App.People.PeopleRequestHandler"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.ShowSharingUiPostMessageHandler"),a.resolve("Common.App.People.IUserPermissionsCache"),jy.a,Nm.a.instance));a.register(wr,"Common.App.People.UserContactsUtils").as("Common.App.People.IUserContactsUtils").ma().na(()=>new wr(u.AFrameworkApplication.fa,a.resolve("Common.App.People.PeopleRequestHandler")));a.register(Jw,"Common.App.People.UserProfilePictureUtils").as("Common.App.People.IUserProfilePictureUtilsV2").as("Common.App.People.IUserProfilePictureUtils").ma().na(()=>
new Jw(a.resolve("Common.App.People.PeopleRequestHandler"),u.AFrameworkApplication.fa,u.AFrameworkApplication.userSessionId,u.AFrameworkApplication.userType));a.register(Aw,"Common.App.People.PeopleColorUtils").as("Common.App.People.IPeopleColorUtils").ma().na(()=>new Aw(a.pb("Common.IColorTable")));a.register(jq,"Common.App.People.PeopleManager").as("Common.App.People.IPeopleManager").ma().na(()=>new jq(a.resolve("Common.App.People.PeopleRequestHandler"),a.resolve("Common.App.People.IUserAccessUtils"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.IUserContactsUtils"),pd.a.get_instance(),a.resolve("Common.App.People.IUserProfilePictureUtilsV2")));a.register(rt,"Common.App.People.ExternalPeopleAPI").as("Common.App.People.IExternalPeopleAPI").ma().na(()=>new rt(a.resolve("Common.App.People.IPeopleManager"),a.resolve("Common.App.People.IPeopleColorUtils"),or.a.vu(a.La("Common.ILokiTokenManager")),u.AFrameworkApplication.fa,a.La("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper")))}init(){u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.ff(Object(D.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){const a=hb.a.instance.resolve("Common.App.People.IPeopleManager");hb.a.instance.resolve("Common.App.People.IExternalPeopleAPI");u.AFrameworkApplication.fa.ka("GetUserContactsTestHookIsEnabled")&&(new tt(a,u.AFrameworkApplication.Ta)).hWk()}dispose(){}static main(){m.a.instance.Ac(new Kw)}}Object(e.a)(Kw,"PeoplePackage",null,[2,3]);var Rp={};Rp.ZJb=function(){function a(){return F()&&(lc()||3<=(lb()?Ec("version/"):
0))}function b(){return 0<=window.navigator.userAgent.indexOf("Windows")}function c(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function f(zd){zd=(new RegExp(zd+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var ne=-1;null!=zd&&2<=zd.length&&(ne=parseFloat(zd[1]),isNaN(ne)&&(ne=-1));return ne}function l(){xm||(xm=!0,Ik=f("Windows Phone"));return 8<=Ik}function x(){return"function"==typeof navigator.msLaunchUri&&!c()&&!kc()&&!R()}function F(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}
function R(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function fa(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function wa(){return fa()?8==window.document.documentMode:!1}function Xa(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function lb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Lb(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function kc(){var zd=window.navigator.userAgent.toLowerCase();
return 0<=zd.indexOf("android")&&0<=zd.indexOf("chrome")}function lc(){return 3<=(Xa()?Ec("firefox/"):0)}function Ec(zd){var ne=window.navigator.userAgent.toLowerCase(),yf=ne.indexOf(zd);return 0<=yf?parseInt(ne.substring(yf+zd.length,ne.length)):0}function Jc(zd,ne,yf,Zd,vg){if(Zd&&null!=ne)ne();else if(x())navigator.msLaunchUri(zd,ne,yf);else if(!(Lb()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&F())||R())Wd(zd,ne,
yf);else if(Lb()&&vg)a:{try{window.open(zd,"_self")}catch($h){null!=yf&&yf();break a}null!=ne&&ne()}else Dc(zd,ne,yf)}function Dc(zd,ne,yf){var Zd=document.getElementById("OICLinkTag");null==Zd&&(Zd=document.createElement("a"),Zd.id="OICLinkTag",Zd.style.visibility="hidden",Zd.href="",0==(nh.Options&ji.SupportsTopTargetNavigation)||nh.NoBrowserModalDialogs?Zd.target="_blank":Zd.target="_top",document.body.appendChild(Zd),null!=Zd.addEventListener&&Zd.addEventListener("click",function(vg){null!=vg.stopPropagation&&
vg.stopPropagation()},!1));try{Zd.href=zd,Zd.click()}catch(vg){null!=yf&&yf();return}null!=ne&&ne()}function Wd(zd,ne,yf){var Zd=document.getElementById("OICFrame");null==Zd&&(Zd=document.createElement("iframe"),Zd.className="ObjectInDialog",Zd.style.visibility="hidden",Zd.src="about:blank",document.body.appendChild(Zd),Zd.id="OICFrame");try{Zd.contentWindow.location.href=zd}catch(vg){null!=yf&&yf();return}null!=ne&&ne()}function xe(zd){return 0!=(zd.Options&ji.SkipProtocolHandler)||wa()}function Sd(zd){return zd===
vk.ReadOnly||zd===vk.ReadWrite}function Pe(zd,ne,yf,Zd){var vg;try{var $h=new ActiveXObject("SharePoint.OpenDocuments.4");return(vg=$h.ViewDocument3(window.self,zd,ne,Zd))?(Hk(ki.O14ActiveX),ng.None):ng.Failed}catch(zi){}if(ji.O14Only===(yf&ji.O14Only))return nh.DescriptiveUnattemptedEnums?ng.O14AttemptFailure:ng.Unattempted;try{return $h=new ActiveXObject("SharePoint.OpenDocuments.3"),(vg=$h.ViewDocument3(window.self,zd,ne,Zd))?(Hk(ki.O12ActiveX),ng.None):ng.Failed}catch(zi){}if(ji.O12UpOnly===(yf&
ji.O12UpOnly))return nh.DescriptiveUnattemptedEnums?ng.O12UpOnlyFail:ng.Unattempted;try{return $h=new ActiveXObject("SharePoint.OpenDocuments.2"),(vg=Sd(ne)?$h.ViewDocument2(window.self,zd,Zd):$h.EditDocument2(window.self,zd,Zd))?(Hk(ki.O11ActiveX),ng.None):ng.Failed}catch(zi){}return nh.DescriptiveUnattemptedEnums?ng.ActiveXUnattempted:ng.Unattempted}function Ue(zd,ne,yf,Zd,vg){zd==Rf.Visio&&yf==vk.ReadWrite&&(yf=vk.WriteOnly);zd=vg;Zd=Zd||c()&&!l();Zd||(Zd="",Zd=Sd(yf)?Zd+"ofv|ofc|":Zd+"ofe|",zd+=
dg(Zd+"u|"));zd+=dg(ne);nh.NewTelemetryDataIsEnabled&&(ne=-1!==zd.indexOf("?")?"&":"?",ne+=nh.SessionOrigin?"OR="+nh.SessionOrigin+"&":"",ne+=nh.ClickTime?"CT="+nh.ClickTime+"&":"",ne+=nh.CorrelationId?"CID="+nh.CorrelationId:"",ne="?"!=ne?ne:"",ne="&"!=ne.slice(-1)?ne:ne.slice(0,-1),zd+=dg(ne));ne=window.location.href;yf=ne.toLowerCase().indexOf("&wdlor=");-1!=yf?(yf+=7,Zd=ne.indexOf("&",yf),ne=-1==Zd?ne.substr(yf):ne.substring(yf,Zd)):ne=void 0;if(null!=ne&&"undefined"!=typeof ne){yf="";try{yf=
decodeURIComponent(ne)}catch($h){}0<yf.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(yf)&&(zd=zd+"|f|"+yf)}return zd}function Ef(zd,ne,yf,Zd,vg,$h){var zi=cj(zd);if(null==zi)return xj(nh.DescriptiveUnattemptedEnums?ng.ProtocolHandlerIsNull:ng.Unattempted,nh.Application),!1;zd=Ue(zd,ne,yf,Zd,zi);Jc(zd,Mg,Bg,vg,$h);return!0}function dg(zd){if(F()&&Lb()){var ne="";try{ne=decodeURI(zd)}catch(yf){}if(ne==zd)return encodeURI(zd)}return zd}function Mg(){Hk(ki.ProtocolHandler)}
function Bg(){nh.Options|=ji.SkipProtocolHandler;yi(nh,Oj,Zj)}function Lf(){null!=Wk&&Wk(ki.RoamingProtocolHandler)}function mh(){null!=Hj&&Hj(ng.ControlNeeded)}function Fg(){var zd=document.getElementById("npSharePointPlugin");if(null==zd){zd="application/x-sharepoint";F()&&3<=(lb()?Ec("version/"):0)&&ii("application/x-sharepoint-webkit",!0)&&(zd="application/x-sharepoint-webkit");if(!ii(zd,!0))if(F()&&ii("application/officelive",!0))zd="application/officelive";else return null;var ne=document.createElement("object");
ne.id="npSharePointPlugin";ne.type=zd;ne.style.width="0px";ne.style.height="0px";ne.style.setProperty("visibility","hidden","");document.body.appendChild(ne);zd=document.getElementById("npSharePointPlugin")}return zd}function ii(zd,ne){var yf=window.navigator.mimeTypes;if(null==yf)return!1;zd=yf[zd];return!zd||ne&&!zd.enabledPlugin?!1:!0}function Li(zd){try{if(null!=new ActiveXObject(zd))return!0}catch(ne){}return!1}function wj(zd){switch(zd){case Rf.OneNote:return"OneNote.Notebook";default:return""}}
function cj(zd){if(zd!=Rf.OneNote&&c()&&!l())return"office:";switch(zd){case Rf.Excel:return"ms-excel:";case Rf.OneNote:return"onenote:";case Rf.PowerPoint:return"ms-powerpoint:";case Rf.Visio:return"ms-visio:";case Rf.Word:return"ms-word:";case Rf.Project:return"ms-project:";case Rf.Publisher:return"ms-publisher:";case Rf.Infopath:return"ms-infopath:";case Rf.Access:return"ms-access:";default:return""}}function dj(zd){switch(zd){case Rf.Excel:return"root\\office15\\excel.exe";case Rf.PowerPoint:return"root\\office15\\powerpnt.exe";
case Rf.Visio:return"root\\office15\\visio.exe";case Rf.Word:return"root\\office15\\winword.exe";case Rf.Project:return"root\\office15\\winproj.exe";case Rf.Publisher:return"root\\office15\\mspub.exe";case Rf.Infopath:return"root\\office15\\infopath.exe";case Rf.Access:return"root\\office15\\msaccess.exe";default:return null}}function yi(zd,ne,yf){nh=zd;Oj=ne;Zj=yf;if(zd.DocumentUrl){var Zd=yf=ne=zd.DocumentUrl;try{Zd=decodeURIComponent(zd.DocumentUrl)}catch(Xo){}try{yf=encodeURI(zd.DocumentUrl)}catch(Xo){}ne=
ne+""+zd.CorrelationIdForWinClient;Zd+=zd.CorrelationIdForWinClient;yf+=zd.CorrelationIdForWinClient;zd.Mode===vk.ReadWrite&&ji.CheckoutRequired===(zd.Options&ji.CheckoutRequired)&&(zd.Mode=vk.ForceCheckout);ji.HostIsEditOnly===(zd.Options&ji.HostIsEditOnly)&&(zd.Mode=vk.WriteOnly);if(xe(zd)?0:F()&&(zd.Application==Rf.OneNote||ii("application/x-sharepoint-protocolhandler",!1)||ii("application/x-sharepoint-webkit-protocolhandler",!1))||x()||kc()||!(a()||lc()||"ActiveXObject"in window&&!c()||Lb())||
15<=uk())Ef(zd.Application,zd.EncodeUrl?yf:ne,zd.Mode,zd.Application==Rf.OneNote,zd.SilentExternalHandler,zd.NavigateUsingWindowOpen);else{var vg;if(vg=wa())a:{var $h=zd.EncodeUrl?ne:Zd,zi=zd.Mode,Yo=wj(zd.Application);try{vg=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,$h,zi,Yo);break a}catch(Xo){}vg=!1}if(vg)Hk(ki.O15ActiveX);else{if(a()||lc()){var hk=zd.EncodeUrl?ne:Zd;Zd=zd.Mode;vg=wj(zd.Application);$h=Fg();if(null==$h)hk=nh.DescriptiveUnattemptedEnums?ng.PluginIsNull:
ng.Unattempted;else{zi=!1;try{zi=$h.ViewDocument3(window.self,hk,Zd,vg)}catch(Xo){}if(!zi)try{zi=Sd(Zd)?$h.ViewDocument2(window.self,hk,vg):$h.EditDocument2(window.self,hk,vg)}catch(Xo){}zi?(Hk(ki.NpapiPlugin),hk=ng.None):hk=ng.Failed}}else{try{hk=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=hk&&hk.SaveSSOCreds()}catch(Xo){}hk=Pe(zd.EncodeUrl?ne:Zd,zd.Mode,zd.Options,wj(zd.Application))}if(hk!=ng.None){if(Zd=zd.CouldUseRoamingApps)hl||(hl=!0,Wl=f("Windows NT")),Zd=6.1<=Wl&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&
(fa()||lc()||Lb());if(Zd&&zd.Application!=Rf.OneNote){if(!Rp.ZJb.ZBl()){xj(ng.ControlNeeded,nh.Application);return}if(zd.RoamingAppsLauncher){"undefined"==typeof zd.RoamingAppsLauncher||null==zd.RoamingAppsLauncher?xj(nh.DescriptiveUnattemptedEnums?ng.RoamingLauncherIsNull:ng.Unattempted,nh.Application):"undefined"==typeof zd.RoamingBitsUrl||null==zd.RoamingBitsUrl?Rp.ZJb.$Bl(zd.DocumentUrl,zd.RoamingAppsLauncher,zd.Application,zd.ApplicationParameters,Oj,Zj):Rp.ZJb.LFh(zd.DocumentUrl,zd.RoamingAppsLauncher,
zd.RoamingApplicationExe,zd.ApplicationParameters,zd.RoamingPlatform,zd.RoamingBitsUrl,Oj,Zj);return}if(!zd.ContinueIfLauncherIsNull){xj(ng.LauncherNeeded,nh.Application);return}}ji.NoProtocolHandlerFallback==(zd.Options&ji.NoProtocolHandlerFallback)||xe(zd)||fa()||F()&&!(nh.DescriptiveUnattemptedEnums?hk>=ng.O14Unattempted&&hk<=ng.DocumentUrlIsNull:hk==ng.Unattempted)?xj(hk,nh.Application):Ef(zd.Application,zd.EncodeUrl?yf:ne,zd.Mode,zd.Application==Rf.OneNote,zd.SilentExternalHandler,zd.NavigateUsingWindowOpen)}}}}else xj(nh.DescriptiveUnattemptedEnums?
ng.DocumentUrlIsNull:ng.Unattempted,nh.Application)}function Hk(zd){null!=Oj&&Oj(zd)}function xj(zd,ne){"undefined"==typeof ne&&(ne=null);null!=Zj&&Zj(zd,ne)}function uk(){var zd=0;if(a()||lc()||Lb()){var ne=Fg();try{null!=ne&&(zd=ne.GetOfficeVersion())}catch(yf){}}else Li("SharePoint.OpenDocuments.5")?zd=15:Li("SharePoint.OpenDocuments.4")?zd=14:Li("SharePoint.OpenDocuments.3")?zd=12:Li("SharePoint.OpenDocuments.2")&&(zd=11);return zd}function Gl(){return F()&&(ii("application/x-sharepoint",!0)||
ii("application/x-sharepoint-webkit",!0))}var gl="",Hl="",Yj="",Oj,Zj,Wk,Hj,nh,hl,Wl,xm,Ik,vk={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},ji={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},ng={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,
ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},ki={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Rf={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:vk,OpenDocumentOptions:ji,OpenDocumentFailureType:ng,OpenDocumentControl:ki,OfficeApplication:Rf,EditDocumentInClient:yi,
EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Rf.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=
this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:uk,IsO14MacPluginInstalled:Gl,OfferOfficeInDialog:function(){return b()&&11>=uk()},OfferOfficeNoIntrusive:function(){return b()&&15>uk()},OfferMacOffice:function(){return F()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Gl()},InstallRoamingControl:function(){Xa()?window.InstallTrigger.install({Office:{URL:Hl}}):Wd(Yj,null,null)},CanUseRoamingControl:function(){if(x())return!0;if(Lb())return"undefined"!=typeof navigator.plugins.refresh&&
navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Xa()){var zd=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(zd);var ne=document.createEvent("Events");ne.initEvent("RoamingOfficeInstalled",!0,!1);zd.dispatchEvent(ne);return!!zd.getAttribute("installed")}if(fa())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(yf){}return!1},InitUrls:function(zd,ne,yf){gl=zd;Hl=yf;Yj=ne},LaunchRoamingApps:function(zd,
ne,yf,Zd,vg,$h){Rp.ZJb.LFh(zd,ne,dj(yf),Zd,"x86",gl,vg,$h)},LaunchRoamingApps2:function(zd,ne,yf,Zd,vg,$h,zi,Yo){var hk="";null!=Zd&&(hk+=" "+Zd);null!=zd&&(hk+=' "'+zd+'"');if(x()||Lb())Wk=zi,Hj=Yo,zi='office: "'+($h+'" "')+(yf+'" "ROAMING"'),zi+=' "'+ne+'"',zi+=' "'+vg+'"',zi+=" "+hk,Jc(zi,Lf,mh,!1,!1);else if(Xa())zd=document.createElement("RoamingExtensionElement"),zd.setAttribute("cabUrl",$h),zd.setAttribute("app",yf),zd.setAttribute("licensingEntitlements",ne),zd.setAttribute("platform",vg),
zd.setAttribute("args",hk),document.documentElement.appendChild(zd),ne=document.createEvent("Events"),ne.initEvent("RoamingOfficeLaunch",!0,!1),zd.dispatchEvent(ne),null!=zi&&zi(ki.RoamingFFExtension);else if(fa()){if(zd=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=zd)try{zd.HrConfigureSingle($h,yf,ne,vg,hk),null!=zi&&zi(ki.RoamingActiveX)}catch(Xo){}}else null!=Yo&&Yo(ng.Failed)},ShouldShowDialog:function(){return!c()},NavigateToUrlUsingClickingOnATag:Dc,OpenDocumentWithProtocolHandler:Ef,
OpenDocumentWithProtocolHandlerNoCallBack:function(zd,ne,yf,Zd){var vg=cj(zd);if(null==vg)return xj(nh.DescriptiveUnattemptedEnums?ng.ProtocolHandlerNoCallbackIsNull:ng.Unattempted,nh.Application),!1;zd=Ue(zd,ne,yf,Zd,vg);Jc(zd,null,null,!1,!1);return!0}}}();Rp.ClientUtils=Rp.ZJb;class Rq{constructor(a,b,c){this.Ca=a;this.fOh=b;this.SF=c}ub(){this.Ca.xa(G.a.tryMacOffice,de.a.frame,Object(D.a)(this,this.qpk,"onTryMacOffice"));this.Ca.xa(G.a.qyh,de.a.frame,Object(D.a)(this,this.$0g,"onTryMacOfficeFromViewer"));
this.Ca.xa(G.a.pyh,de.a.frame,Object(D.a)(this,this.$0g,"onTryMacOfficeFromViewer"))}qpk(a,b,c,f,l){if(1===c)return 32;l?(a=l.SourceControlId,"btnjTryMacOfficeForWordEditor"===a?kb.a.Um(cg.a.MBa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===a&&kb.a.Um(cg.a.MBa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.uzg();return 32}$0g(a,b,c){if(1===c)return 32;switch(a){case G.a.qyh:kb.a.Um(cg.a.MBa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");
break;case G.a.pyh:kb.a.Um(cg.a.MBa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}uzg(){kb.a.Um(Rq.O$j,"_blank",void 0,"LaunchMacTrialWindow")}get lkc(){return this.fOh&&n.a.ek&&!n.a.$9d&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get Goh(){const a=this.lkc;a||u.AFrameworkApplication.Zi.E0k();return a}get I9k(){return this.lkc}static get O$j(){return cg.a.vV("522401")}}Object(e.a)(Rq,"MacOfficeOffer",null,[1401]);class wt{constructor(a,b,c){this.Ca=a;this.iOh=b;this.pod=null;
(this.jyc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&hb.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{this.pod=f});this.SF=c}ub(){this.Ca.xa(G.a.tryOffice,de.a.frame,Object(D.a)(this,this.rpk,"onTryOffice"));this.Ca.xa(G.a.tRe,de.a.frame,Object(D.a)(this,this.tRe,"tryOfficeThroughTellMe"));this.Ca.xa(G.a.yyh,de.a.frame,Object(D.a)(this,this.zyh,"tryOfficeThroughViewer"));
this.Ca.xa(G.a.xyh,de.a.frame,Object(D.a)(this,this.zyh,"tryOfficeThroughViewer"))}rpk(a,b,c,f,l){if(this.jyc&&1===c)return this.isFreemiumUpsellEnabled&&this.mkc?32:8;2===c&&(l?(a=l.SourceControlId,"btnjTryOfficeForWordEditor"===a?kb.a.Um(cg.a.MBa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===a?kb.a.Um(cg.a.MBa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.pbe()):this.pbe());return 32}tRe(a,b,c,f,l){if(this.jyc&&1===c)return this.isFreemiumUpsellEnabled&&
this.mkc?32:8;2===c&&(l?(a=l.SourceControlId,kb.a.Um(cg.a.vV("862405")+this.f9i(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):kb.a.Um(cg.a.vV("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}zyh(a,b,c){if(this.jyc&&1===c)return this.isFreemiumUpsellEnabled&&this.mkc?32:8;if(2===c)switch(a){case G.a.yyh:kb.a.Um(cg.a.MBa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case G.a.xyh:kb.a.Um(cg.a.MBa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get JVg(){return this.mkc}get ugk(){return this.mkc&&
MSOJS.ClientUtils.OfferOfficeInDialog()}get mkc(){return this.iOh&&!n.a.ek}get isFreemiumUpsellEnabled(){let a=!1;this.pod&&(a=this.pod.isFreemiumUpsellEnabled());return a}pbe(a=null){let b=0;a&&(b=a);kb.a.Um(wt.X5i(b),"_blank",void 0,"LaunchOfficeOffer")}f9i(a){let b=0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":b=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":b=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":b=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":b=
4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":b=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":b=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":b=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":b=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":b=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":b=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":b=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":b=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":b=
18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":b=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":b=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":b=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":b=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":b=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":b=29}return 0===b?"":String.format("&pc={0:D}",b)}static X5i(a){if(n.a.Ki)switch(a){case 1:return cg.a.vV("393806");case 2:return cg.a.vV("393810");
case 3:return cg.a.vV("393809");case 5:return cg.a.vV("393805")}else if(n.a.eI)switch(a){case 1:return cg.a.vV("521979");case 3:return cg.a.vV("521980");case 5:return cg.a.vV("521978");case 2:return cg.a.vV("522490")}else{if(2===a)return cg.a.vV("517778");if(1===a)return cg.a.MBa(30)}return cg.a.vV("522402")}}Object(e.a)(wt,"OfficeTrialExperience",null,[1400]);class Lw{Wb(a){a.register(wt,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ma().na(()=>new wt(u.AFrameworkApplication.Ta,
u.AFrameworkApplication.F9d,u.AFrameworkApplication.lcid));a.register(Rq,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ma().na(()=>new Rq(u.AFrameworkApplication.Ta,u.AFrameworkApplication.xug,u.AFrameworkApplication.lcid))}}Object(e.a)(Lw,"OpenInClientConfiguration",null,[3]);var sp=d(169),Xe=d(47);class Wu{constructor(a,b,c){this.DW=this.Ft=this.K=null;this.vf=a;this.zI=b;this.fpe=c}WRf(a,b,c){if(!this.vf)return null;if(!this.K){this.K=Xe.a.Ee();this.K.id=this.zI;this.K.className=
"HTMLSpinnerIndicator";const f=Xe.a.Ee();f.className="HtmlspinnerOverlay";this.Ft=Xe.a.Ee();this.Ft.className="HtmlspinnerInner";const l=Xe.a.zn();l.className="BootSpinner";this.Ft.appendChild(l);this.fpe&&(this.DW=Xe.a.zn(),this.DW.id="htmlspinner_label",this.Ft.appendChild(this.DW));this.K.appendChild(f);this.K.appendChild(this.Ft);this.vf.appendChild(this.K)}this.fpe&&(this.DW.innerText=a||ResourceStrings.l_Loading);this.WGd(b,c);return this.K}oJb(a){this.DW&&(this.DW.innerText=a)}WGd(a,b){this.K.style.left=
Xe.a.Lc(a);this.K.style.top=Xe.a.Lc(b);this.Ft.style.bottom=this.fpe?Xe.a.Lc(this.vf.clientHeight/2+16):Xe.a.Lc(this.vf.clientHeight/2+24)}}Object(e.a)(Wu,"HtmlSpinnerIndicator",null,[]);class Sq extends Wu{constructor(a,b,c){super(a,b,!1);this.hpe=c}WRf(a,b,c){if(!this.vf)return null;if(!this.K){this.K=Xe.a.Ee();this.K.id=this.zI;this.K.className="HTMLProgressIndicator";const f=Xe.a.Ee();f.className="HtmlprogressOverlay";this.Ft=Xe.a.Ee();this.Ft.className="HtmlprogressInner";if(this.hpe){const l=
Xe.a.CB();l.src=sp.a.cK(qf.a.Sla);l.width=qf.a.LDb;l.height=qf.a.U$c;this.Ft.appendChild(l)}this.DW=Xe.a.zn();this.Ft.appendChild(this.DW);this.K.appendChild(f);this.K.appendChild(this.Ft);this.vf.appendChild(this.K)}this.DW.innerText=a||ResourceStrings.l_Loading;this.WGd(b,c);return this.K}WGd(a,b){this.K.style.left=Xe.a.Lc(a);this.K.style.top=Xe.a.Lc(b);this.K.style.display=Ve.a.Rk;this.Ft.style.position=Ve.a.Jwa;a=this.Ft.clientWidth;this.Ft.style.top=Xe.a.Lc(this.vf.clientHeight/2-this.Ft.clientHeight/
2);u.AFrameworkApplication.isRtl?(this.Ft.style.right=Xe.a.Lc(this.vf.clientWidth/2-a/2),this.Ft.style.direction=Ve.a.FYa):(this.Ft.style.left=Xe.a.Lc(this.vf.clientWidth/2-a/2),this.Ft.style.direction=Ve.a.zth);this.K.style.display=Ve.a.Sf}}Object(e.a)(Sq,"HtmlProgressIndicator",Wu,[]);class Mw{constructor(a,b){this.JI=this.RN=this.K=null;this.Ib=!0;this.oHg=a;this.sI=b}eHb(a,b,c,f,l){u.AFrameworkApplication.O4b()||(this.K=this.oHg.WRf(a,c,f),b?(this.RN&&(window.clearTimeout(this.RN),this.RN=null),
this.JI&&(window.clearTimeout(this.JI),this.JI=null),this.DLe(l)):this.RN||this.JI||(this.RN=window.setTimeout(()=>{this.bMe(l)},200)))}jPc(){this.RN&&(window.clearTimeout(this.RN),this.RN=null);this.JI&&(window.clearTimeout(this.JI),this.JI=null);this.K&&(this.K.style.display=Ve.a.Sf,this.K.style.opacity="0")}oJb(a){this.oHg.oJb(a)}DLe(a){this.K&&(this.K.style.opacity="1.0",this.K.style.visibility=Ve.a.Uy,this.Ib&&(this.K.style.display=Ve.a.Rk),ya.a.J(512496862,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",
this.Pmc(a)))}bMe(a){this.RN=null;this.K&&(this.K.style.visibility=Ve.a.Uy,this.Ib&&(this.K.style.display=Ve.a.Rk),this.K.style.opacity="0.0",this.JI||(this.JI=window.setTimeout(()=>{this.aMe(a)},1800)))}aMe(a){this.JI=null;this.K&&(this.K.style.opacity="1.0",this.Ib&&(this.K.style.display=Ve.a.Rk),ya.a.J(512496861,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.Pmc(a)))}Pmc(a){return a?Object.getType(a)===String?a:Object.getType(a)===Number?this.sI.D4(a):null:null}get visible(){return this.Ib}set visible(a){this.Ib=
a;this.K&&(this.K.style.display=a?Ve.a.Rk:Ve.a.Sf)}}Object(e.a)(Mw,"HtmlProgressIndicatorView",null,[1373]);class xt{constructor(){this.PresentationID=this.PodSessionID=this.PodEndpointUrl=null}}Object(e.a)(xt,"UploadConvertedFileToHostParams",null,[]);var ky=d(977),kq=d(72);const ps=a=>{for(let b=0;b<a.children.length;b++){const c=a.children[b];c.style.position="relative";c.style.top=(c.parentNode.offsetHeight-c.offsetHeight)/2+"px"}},qs=a=>a.lc.keyCode===w.a.aq||a.lc.keyCode===w.a.xO?(a.Fc.click(),
!0):!1,Tq=(a,b,c,f,l,x,F)=>{const R=document.createElement("a");R.className="ProtocolLaunchingDialogButtonAnchor";R.className+=" OICDialog";R.id=a;R.setAttribute(Uc.a.We,Uc.a.Xt);R.style.padding="0";R.style.margin="0";f&&ly(l,b,c,f,R);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=l;R.appendChild(a);R.tabIndex=0;x&&rc.a.instance.ob(qa.a.click,R,x);F&&A.KeyInputManager.instance.ob(qa.a.ol,R,F);return R},ly=(a,b,c,f,l)=>{var x=document.createElement("img");
x.alt=a;x.className=kq.getImageClassWithCluster(c,f);x.src=b;x.setAttribute(Uc.a.We,Uc.a.wM);a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(x);x=document.createElement("span");x.className="ProtocolLaunchingDialogIconContainer";x.appendChild(a);l.appendChild(x)};class yt{static get jg(){return Vh.a.EB(yt.Zn,CommonUIStrings.l_OICLaunchDialogTitle)}}yt.Zn="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(e.a)(yt,"OICLaunchDialogHtml",null,[]);class Nw extends Vh.a{constructor(a){super();this.Gib=this.d_a=null;this.wKa=!1;this.ww=a;this.jg=yt.jg;this.vd=5;this.kg="OICLaunchDialog";this.showDialog("",Object(D.a)(this,this.Agk,"oicLaunchDialogResultHandler"));this.Zkh();this.J4("ProtocolLaunchingDialogTitle");4!==u.AFrameworkApplication.Aa.gb.yqa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.MQ(this.d_a);Z.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Wua(){this.d_a=Tq("BtnRichClient",this.ww.aqb,this.ww.B7a,this.ww.Q4d,CommonUIStrings.l_OICLaunchRichClient,Object(D.a)(this,this.B_g,"onRichClientButtonClick"),qs);document.getElementById("OICLaunchRichClient").appendChild(this.d_a);ps(this.d_a);this.Gib=Tq("BtnReturn",this.ww.aqb,this.ww.B7a,this.ww.flg,CommonUIStrings.l_OICReturnToOnlineClient,Object(D.a)(this,this.z_g,"onReturnButtonClick"),
qs);document.getElementById("OICReturnToApp").appendChild(this.Gib);ps(this.Gib)}z_g(){this.hide();this.ww.oXa();return!0}B_g(){Z.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();u.AFrameworkApplication.Ta.processAction(G.a.Jeb,2);return!0}Agk(){this.ww.oXa()}dispose(){this.wKa||(this.d_a&&(rc.a.instance.xb(qa.a.click,this.d_a,Object(D.a)(this,this.B_g,"onRichClientButtonClick")),A.KeyInputManager.instance.xb(qa.a.ol,this.d_a,qs)),this.Gib&&(rc.a.instance.xb(qa.a.click,
this.Gib,Object(D.a)(this,this.z_g,"onReturnButtonClick")),A.KeyInputManager.instance.xb(qa.a.ol,this.Gib,qs)),super.dispose(),this.wKa=!0)}}Object(e.a)(Nw,"OICLaunchDialog",Vh.a,[]);class lq{static get jg(){return Vh.a.EB(lq.Zn,CommonUIStrings.l_OICDialogTitle)}}lq.Zn="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(e.a)(lq,"ProtocolLaunchingDialogV2Html",null,[]);var Ah=d(191);class k extends Vh.a{constructor(a){super();this.Fib=this.Exa=null;this.wKa=!1;this.aKa=null;this.ww=a;this.jg=lq.jg;this.vd=5;this.kg="ProtocolLaunchingDialog";this.pqc="OICRetryDialog";u.AFrameworkApplication.ue.Dra&&u.AFrameworkApplication.ue.nXa();u.AFrameworkApplication.ue.Gb(new He.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(D.a)(this,this.Sfc,"protocolLaunchingDialogResultHandler"));this.Zkh();
this.J4("Issues");this.l4f();Z.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Wua(){const a=document.getElementById("Issues");if(a){ly("",this.ww.aqb,this.ww.B7a,this.ww.Q4d,a);const b=document.createElement("span");b.className="WACDialogSectionTitle";b.innerText=5===this.ww.t1g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(b);ps(a);a.style.display="none"}u.AFrameworkApplication.Aa.gb.Rfg?
(this.Fib=Tq("GiveFeedback",this.ww.aqb,this.ww.B7a,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(D.a)(this,this.d7c,"onGiveFeedbackClick"),Object(D.a)(this,this.EYg,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.Fib),ps(this.Fib)):document.getElementById("ButtonGiveFeedback").style.display="none";0===u.AFrameworkApplication.Aa.gb.yqa||u.AFrameworkApplication.jGi?document.getElementById("ButtonEdit").style.display="none":(this.Exa=
Tq("Edit",this.ww.aqb,this.ww.B7a,"",2===u.AFrameworkApplication.Aa.gb.Am?4===u.AFrameworkApplication.Aa.gb.yqa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===u.AFrameworkApplication.Aa.gb.yqa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(D.a)(this,this.RXg,"onEditClick"),Object(D.a)(this,this.VXg,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Exa),ps(this.Exa));0===u.AFrameworkApplication.Aa.gb.yqa&&
!u.AFrameworkApplication.F9d&&a&&(a.style.display="none")}m4f(){return this.aKa?(this.MQ(this.aKa),!0):!1}l4f(){return this.Exa?(this.MQ(this.Exa),!0):!1}VXg(a){return this.que(a,0)}EYg(a){return this.que(a,2)}y_g(a){return this.que(a,1)}que(a,b){let c=!1;if(a.lc.keyCode===w.a.aq||a.lc.keyCode===w.a.xO)a.Fc.click(),c=!0;else if(a.lc.keyCode===Sys.UI.Key.down||a.lc.keyCode===Sys.UI.Key.up)switch(b){case 1:c=this.l4f();break;case 0:c=this.m4f()}return c}RXg(){this.hide();4===u.AFrameworkApplication.Aa.gb.yqa?
(Z.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.ww.oXa()):(Z.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.ww.k1b());return!0}d7c(){Z.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}e8c(){Z.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";u.AFrameworkApplication.Ta.processAction(G.a.Jeb,2);return!0}Sfc(){this.ww.oXa()}switchToBackupMode(){var a=document.getElementById("ProtocolLaunchingDialogTitle");
if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.aKa=Tq("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(D.a)(this,this.e8c,"onRetryOICClick"),Object(D.a)(this,this.y_g,"onRetryOICKeyUp")),a.appendChild(this.aKa),ps(this.aKa),this.Exa||this.m4f())}}dispose(){this.wKa||(this.Exa&&(rc.a.instance.xb(qa.a.click,this.Exa,Object(D.a)(this,
this.RXg,"onEditClick")),A.KeyInputManager.instance.xb(qa.a.ol,this.Exa,Object(D.a)(this,this.VXg,"onEditKeyUp"))),this.Fib&&(rc.a.instance.xb(qa.a.click,this.Fib,Object(D.a)(this,this.d7c,"onGiveFeedbackClick")),A.KeyInputManager.instance.xb(qa.a.ol,this.Fib,Object(D.a)(this,this.EYg,"onGiveFeedbackKeyUp"))),this.aKa&&(rc.a.instance.xb(qa.a.click,this.aKa,Object(D.a)(this,this.e8c,"onRetryOICClick")),A.KeyInputManager.instance.xb(qa.a.ol,this.aKa,Object(D.a)(this,this.y_g,"onRetryOICKeyUp"))),super.dispose(),
this.wKa=!0)}}Object(e.a)(k,"ProtocolLaunchingDialog",Vh.a,[]);class B extends rj.StandardDialog{constructor(a){super();this.ww=a;this.kg="ProtocolLaunchingDialog";u.AFrameworkApplication.ue.Dra&&u.AFrameworkApplication.ue.nXa();u.AFrameworkApplication.Aa.gb.Rfg&&this.zFd(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(D.a)(this,this.d7c,"onGiveFeedbackClick"));B.Eig?(this.vd=12,this.Re(1,CommonUIStrings.l_CloseFile),this.Re(2,CommonUIStrings.l_OICDialogContinueHere),this.Re(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(this.vd=4,this.Re(1,CommonUIStrings.l_OICDialogContinueHere),this.Re(2,CommonUIStrings.l_OICDialogLaunchAgain));this.aBb(CommonUIStrings.l_OICDialog2ndTitle,5===this.ww.t1g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(D.a)(this,this.Sfc,"protocolLaunchingDialogResultHandler"),null)}d7c(a){Z.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.hYg(a)}e8c(){Z.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");u.AFrameworkApplication.Ta.processAction(G.a.Jeb,
2)}Sfc(a){B.Eig?3===a?this.bgh():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.bgh():(1===a||0===a)&&this.continueEditing()}closeDocument(){Z.ULS.sendTraceTag(577783557,211,50,"Closing the document");u.AFrameworkApplication.Ta.Ka(G.a.close,2,Qi.a)}bgh(){Z.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(D.a)(this,this.e8c,"onRetryOICClick"),0)}continueEditing(){4===u.AFrameworkApplication.Aa.gb.yqa||u.AFrameworkApplication.fa.ka("WordConsumptionViewToEditRedirectIsEnabled")&&
1===u.AFrameworkApplication.Aa.mode?(Z.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.ww.oXa()):(Z.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.ww.k1b())}static get Eig(){return u.AFrameworkApplication.fa.ka("OICDialogThreeActions")&&32===u.AFrameworkApplication.Ta.processAction(G.a.close,1)}}Object(e.a)(B,"StandardProtocolLaunchingDialog",rj.StandardDialog,[]);var S=d(652);class ma{}Object(e.a)(ma,"EditDocumentInClientParams",null,[]);class Ka{static rYf(a,
b,c,f,l,x,F=!1,R=!1,fa="",wa=!1,Xa=!1,lb=!1,Lb="",kc="",lc="",Ec=!1){const Jc=new ma;Jc.DocumentUrl=a;Jc.Mode=b;Jc.Options=c;Jc.Application=f;Jc.SilentExternalHandler=F;Jc.EncodeUrl=R;Jc.CorrelationIdForWinClient=fa;Jc.NavigateUsingWindowOpen=wa;Jc.DescriptiveUnattemptedEnums=Xa;Jc.NoBrowserModalDialogs=lb;Jc.SessionOrigin=Lb;Jc.CorrelationId=kc;Jc.ClickTime=lc;Jc.NewTelemetryDataIsEnabled=Ec;MSOJS.ClientUtils.EditDocumentInClient(Jc,l,x)}}Object(e.a)(Ka,"ClientUtils",null,[]);var ab=d(556),Ab=d(520),
ac=d(139);class zc{constructor(a){this.Dya=this.RLb=this.YKb=null;this.FMb=!1;this.Mwd=this.hff=null;this.wpc=this.Ina=this.Jwc="";this.application=this.fy=0;this.yil=this.cOe=!1;this.vxl=a&&u.AFrameworkApplication.fa.ka("OICLaunchDialogIsEnabled");u.AFrameworkApplication.Ta.iS(G.a.Jeb)||u.AFrameworkApplication.Ta.xa(G.a.Jeb,de.a.frame,Object(D.a)(this,this.eVk,"retryOpenInClientAction"));this.Vqh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("SilentExternalHandler")}get t1g(){return this.fy}P5k(a,
b="",c=""){this.Ina=c||lh.a.create().toString();this.Jwc=b||ab.a.Yag();this.wpc=a}eVk(a,b,c){return b.contextId!==de.a.frame?2:1===c?32:this.Jeb()}get options(){let a=0;u.AFrameworkApplication.requiresCheckout&&(a|=1);u.AFrameworkApplication.y1g&&(a|=4);this.wil()&&(a|=64);return a}wil(){return!(2===this.application&&u.AFrameworkApplication.fa.ka("IsEmbeddedScenario"))}get aqb(){return u.AFrameworkApplication.Vl}get B7a(){return u.AFrameworkApplication.$M}get flg(){return""}get Q4d(){return""}get xil(){return u.AFrameworkApplication.fa.ka("OneNoteMobileViewerIsEnabled")}get zll(){return this.hff||
(this.hff=hb.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.cOe||this.VMi()}oXa(){this.yil||this.z0f()}MHk(a){return this.vxl&&n.a.Ki?(new Nw(this),32):this.bpb(a)}bpb(a){const b=({YYa:a}=this.FRj(a)).returnValue;Z.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===b,a);return b}begin(a,b,c,f,l,x){this.YKb=a;this.RLb=b;this.Dya=x;this.application=c;this.fy=f;return u.AFrameworkApplication.PXf?(this.qzg(),32):u.AFrameworkApplication.ZP&&!u.AFrameworkApplication.bkg?
(u.AFrameworkApplication.zqh(),8):this.uHf(l)}get zgk(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}Jeb(){this.zgk&&this.$Uj();return this.bpb(this.FMb)}vjh(){const a=new Ab.a(Le.a.openInClient);a.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();a.Values[S.a.MTf]=u.AFrameworkApplication.userSessionId;return this.Dya.value.send(a)?32:8}$Uj(){Se.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Fk.a,{inStaging:!0}))}i_k(a){const b=new Ab.a(Le.a.Xzl);b.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();b.Values[S.a.MTf]=u.AFrameworkApplication.userSessionId;b.Values[Gi.a.Wzl]=a;this.Dya.value.send(b)}FRj(a){this.FMb=a;this.i_k(5===this.fy?zc.jqk:zc.pqk);return 5===this.fy?this.ERj():this.GRj()}ERj(){this.vzg();return{returnValue:32,YYa:"HostEditUrl,"}}GRj(){let a;var b=a="";u.AFrameworkApplication.HBf&&(b="|f|"+u.AFrameworkApplication.userSessionId);
const c=u.AFrameworkApplication.fa.ka("IsAssignmentMode")&&u.AFrameworkApplication.fa.ka("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||u.AFrameworkApplication.c5b||n.a.xDa,f=u.AFrameworkApplication.fa.ka("UnattemptedEnumIsEnabled"),l=u.AFrameworkApplication.fa.ka("NoBrowserModalDialogs");if(u.AFrameworkApplication.Ta.M5c){var x=u.AFrameworkApplication.Ta.zNc(3588168074);x&&this.P5k(x.epochClickTime,x.sessionOrigin,x.correlationId);this.cBg()}if(u.AFrameworkApplication.U5g){a+="NewOrder,";
x=8;this.Dya&&this.Dya.value&&this.Dya.value.isEnabled()&&u.AFrameworkApplication.ync&&(a+="Post,",x=this.vjh());if(32===x)return{returnValue:x,YYa:a};Z.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return u.AFrameworkApplication.fu.hva?(Z.ULS.shipAssertTag(5566816,211,!!u.AFrameworkApplication.fu.hva),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.YN(!0,u.AFrameworkApplication.fu.hva),YYa:a}):this.YKb?(Z.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
u.AFrameworkApplication.userSessionId),a+="DocUrl,",Ka.rYf(this.YKb,this.fy,this.options,this.application,Object(D.a)(this,this.UXg,"onEditInClientSuccess"),Object(D.a)(this,this.TXg,"onEditInClientFailure"),this.Vqh,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.Jwc,this.Ina,this.wpc,u.AFrameworkApplication.Ta.M5c),{returnValue:32,YYa:a}):{returnValue:8,YYa:a}}a+="OldOrder,";if(!this.YKb&&u.AFrameworkApplication.fu.hva)return this.Dya&&this.Dya.value&&this.Dya.value.isEnabled()&&
u.AFrameworkApplication.ync?(a+="Post,",b=this.vjh()):(Z.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),b=8),32!==b?(Z.ULS.shipAssertTag(22595484,211,!!u.AFrameworkApplication.fu.hva),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.YN(!0,u.AFrameworkApplication.fu.hva),YYa:a}):{returnValue:b,YYa:a};Z.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId);a+="DocUrl,";Ka.rYf(this.YKb,
this.fy,this.options,this.application,Object(D.a)(this,this.UXg,"onEditInClientSuccess"),Object(D.a)(this,this.TXg,"onEditInClientFailure"),this.Vqh,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.Jwc,this.Ina,this.wpc,u.AFrameworkApplication.Ta.M5c);return{returnValue:32,YYa:a}}nSk(a){u.AFrameworkApplication.Zi.setDw(8981,a)}UXg(a){this.nSk(a);Z.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?(this.xil||this.vzg(),this.cBg()):
this.cOe||this.closeApplication()}TXg(a,b=0){Z.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,b);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const c=!!this.RLb&&!this.FMb;let f=0;1===a&&(f=2);6<=a&&13>=a&&(f=1,1===b&&(this.cOe=!0));this.zll.ugk?(Z.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",f),ky.a.instance.Myi(this.FMb?Object(D.a)(this,this.TVg,"oicErrorDialogHandlerCloseForced"):
Object(D.a)(this,this.UVg,"oicErrorDialogHandlerNoCloseForced"),c?Object(D.a)(this,this.eZg,"onLaunchDownload"):null,this.xWf(!1)?Object(D.a)(this,this.dtj,"iHaveOfficeButtonHandler"):null,f,b)):(Z.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",f),ky.a.instance.Kyi(this.FMb?Object(D.a)(this,this.TVg,"oicErrorDialogHandlerCloseForced"):Object(D.a)(this,this.UVg,"oicErrorDialogHandlerNoCloseForced"),c?Object(D.a)(this,this.eZg,"onLaunchDownload"):null,f))}}cBg(){try{const a=
[Object.assign(new ac.a,{name:"CorrelationId",string:this.Ina}),Object.assign(new ac.a,{name:"SessionOrigin",string:this.Jwc}),Object.assign(new ac.a,{name:"ClickTime",string:this.wpc}),Object.assign(new ac.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];If.a("OpenInClientCompleted",!0,0,a)}catch(a){Z.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}vzg(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.QB&&u.AFrameworkApplication.fa.ka("StandardProtocolDialogIsEnabled")?
new B(this):new k(this)}TVg(){this.closeApplication()}UVg(){this.oXa()}eZg(){this.qzg()}dtj(){return this.xWf(!0)}xWf(a){const b=(n.a.JRa||n.a.$n)&&!!u.AFrameworkApplication.tGc;b&&a&&(kb.a.Um(u.AFrameworkApplication.tGc,"_blank",void 0,"OpenInClient"),this.closeApplication());return b}}zc.pqk="OpenInDesktop";zc.jqk="OpenInBrowser";Object(e.a)(zc,"AOpenInClientOperation",null,[]);class Vc extends zc{constructor(a,b,c=!1){super(c);this.WMh=a;this.VMh=b}get flg(){return this.VMh}get Q4d(){return this.WMh}VMi(){u.AFrameworkApplication.Ta.Ka(G.a.close,
2,Qi.a)}z0f(){}uHf(a){return this.MHk(a)}qzg(){Z.ULS.shipAssertTag(5566817,211,!!this.RLb);u.AFrameworkApplication.Xba?u.AFrameworkApplication.Aa.YN(!0,this.RLb):kb.a.Um(this.RLb,void 0,void 0,"LaunchDownload")}k1b(){u.AFrameworkApplication.Aa.gb.k1b()}}Object(e.a)(Vc,"OpenInClientOperation",zc,[]);class rd extends Vc{constructor(a,b,c,f){super("PowerPoint_32x32x32","EditInPowerPointWebApp_32x32x32");if(!a)throw Error.argumentNull("pathManager");this.pLg=b;this.fe=a;this.Op=c;this.ia=f}get aqb(){return this.fe.Yj(this.B7a+
".png")}get B7a(){return"prt2"}uHf(a){return this.pLg?this.pLg(a):this.bpb(a)}z0f(){ya.a.J(512496860,801,50,"OpenInPowerPointOperation - restarting edit session");this.ia.Ka(ba.a.refresh,2,{refreshtrigger:"OpenInPowerPointOperation::ExecuteRestartApplication"})}bpb(a){this.Op.c4b=!0;return super.bpb(a)}}Object(e.a)(rd,"OpenInPowerPointOperation",Vc,[]);class he{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe){this.mHg=null;this.GD=x;this.ia=a;this.Fa=b;this.ra=c;this.fe=f;this.oLg=
new rd(this.fe,Object(D.a)(this,this.pbi,"beginSaveBeforeOpenInClient"),lb,a);F.execute(Ue=>{this.mHg=new le.a(()=>Ue)});this.M_j=l;this.ou=R;this.I$j=fa;this.ta=wa;this.Xb=Xa;this.Ga=Lb;this.Xa=kc;this.Yca=lc;this.Nb=Ec;this.Kd=Jc;this.vm=Dc;this.dv=Wd;this.Pab=xe;this.O8=Sd;this.KN=Pe}ub(){this.ia.xa(ba.a.openInClient,fc.a.application,Object(D.a)(this,this.u1g,"openExternal"));this.ia.xa(G.a.Kwe,fc.a.application,Object(D.a)(this,this.u1g,"openExternal"));this.ia.xa(ba.a.convertAndEdit,fc.a.application,
Object(D.a)(this,this.Iti,"convertBinaryFormat"));this.ia.xa(ba.a.repair,fc.a.application,Object(D.a)(this,this.LRk,"repairCorruptedFile"));this.ia.xa(ba.a.aic,fc.a.application,Object(D.a)(this,this.aic,"replaceOriginalFile"));this.ia.xa(ba.a.kFb,fc.a.application,Object(D.a)(this,this.kFb,"saveRepairedFile"));this.ia.xa(ba.a.VXb,fc.a.application,Object(D.a)(this,this.VXb,"editAnyway"));this.ia.xa(ba.a.X0b,fc.a.application,Object(D.a)(this,this.X0b,"goToEditMode"));this.ia.$d(ba.a.openInClient,12288)}pbi(a){if(this.vm.isPaused)return this.Fa.Ad(),
this.hGe(a),32;this.ra.Ph();this.Fa.Ad();if(1===this.Nb.mode&&this.Ga.isReadOnlyFilesForceEditingViaOICDisabled)return this.n3f(a),32;this.GD.f2(a,!0,()=>{this.hGe(a)},()=>{this.hGe(a);return!0},3);this.ou.show(!1,"OpenInClient");return 32}hGe(a){this.ou.hide();this.n3f(a)}n3f(a){Mc.a.ykd();this.oLg.bpb(a)}u1g(a,b,c){if(b.contextId!==fc.a.application)return 2;b=!(!this.fe.documentUrl&&!this.M_j.hva&&!u.AFrameworkApplication.ync);if(1===c)return b?32:8;if(!b)return 8;this.TWj();if(this.Xb.Zc(this.I$j.yf))return 16;
a=a===G.a.Kwe?5:2;1===this.Nb.mode&&this.Ga.isReadOnlyFilesForceEditingViaOICDisabled&&(a=1);return this.oLg.begin(this.fe.documentUrl,u.AFrameworkApplication.DOa,3,a,this.Ga.rJj,this.mHg)}TWj(){try{let a="";const b=this.ta.Mj;b&&(a=b.toString());ya.a.J(18956688,801,50,"User clicked OpenInClient. Slide index: {0}. Slide stats:{1}",this.ta.currentSlideIndex,a)}catch(a){ya.a.J(18956690,801,10,"Exception caught while logging slide stats for OpenInClient: {0}",a)}}Iti(a,b,c){ya.a.J(24130758,801,50,"PowerPointAppFrameCommandUIActor - ConvertBinaryFormat");
if(b.contextId!==fc.a.application)return 2;if(1===c)return 32;const f=Object.assign(new xt,{PodEndpointUrl:this.Ga.podsWebServiceBase,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string});this.Yca.Vld(f,Object(D.a)(this,this.Apk,"onUploadConvertedFileToHostSucceeded"),l=>{this.zpk(l,f.PodSessionID)});this.ou.jMe(!0,ResourceStrings.L_FileConverting,a);return 32}Apk(a){ya.a.J(24130760,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded");this.ou.hide();
if(this.Nb)if(a=a.result,a.EditUrl){var b=!1,c=!1,f=!1;u.AFrameworkApplication.fa&&(b=u.AFrameworkApplication.fa.ka("IsUIEmbedMode"),c=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),f=u.AFrameworkApplication.fa.ka("UiHostSupportsPPTConvertScenarios"));if(b&&c&&f){ya.a.J(589312029,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded Sending DocumentRefresh post message.");const l={};l[Gi.a.fEb]="1";l[Gi.a.documentUrl]=a.EditUrl;l[Gi.a.mode]="edit";l[Gi.a.reason]=
Rv.a.convert;u.AFrameworkApplication.zV().execute(x=>{x.sendMessage(Le.a.RAa,l)})}else this.Nb.YN(!0,a.EditUrl)}else ya.a.J(24130764,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no EditUrl");else ya.a.J(24130762,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no available app frame")}zpk(a,b){a=uf.a.EM(a.error.Lm);ya.a.J(24130766,801,10,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostFailed error: {0}",a);this.ou.hide();
a=Object.assign(new Kg.a,{Code:a,Source:5});this.Kd.Rr(a,b,c=>{c.xB=1;c.$za=6;c.title=ResourceStrings.L_FileConversionTitle;c.message=ResourceStrings.L_FileConversionError;return!1})}LRk(a,b,c){if(b.contextId!==fc.a.application)return 2;if(1===c)return 32;ya.a.J(25011969,801,50,"PowerPointAppFrameCommandUIActor - Start to repairCorruptedFile");this.NRk();return 32}NRk(){const a=new Date;ya.a.J(42858700,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Starting Document repair. Start-time {0}",
a);const b=Mc.a.hm("PowerPointAppFrameCommandUIActor.InlineDocumentRepair");this.KN.nob(()=>{ya.a.J(50677722,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closed the pop session early that was triggered due to late detection (after open early success) of corruption. To avoid lock mismatch while writing to host for overwrite case is the reason we do proactively.")},()=>{ya.a.J(50677724,801,15,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closing the pop session early failed. This might lead to overwrite the file  issues with a lock mismatch error.")});
this.Pab.ieh(b,()=>{ya.a.J(42858702,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Successfull,Time-Taken {0}",+new Date-+a);b.finish();this.mol()},c=>{ya.a.J(42858704,801,10,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Failed,Time-Taken {0}, Error: {1}",+new Date-+a,c);b.finish();this.kBk(c,this.Xa.podSessionId);return!0})}mol(){var a={failedMachineId:null,isPlanedShutdown:!1};a.podSessionId=this.Xa.podSessionId;a.fromInlineDocumentRepair=!0;this.dv.$He();
a=this.ia.Ka(ba.a.jEb,2,a);ya.a.J(42858706,801,50,"PowerPointAppFrameCommandUIActor::TriggerDocRefresh: Response-{0}",a)}kBk(a,b){a=Object.assign(new Kg.a,{Code:a,Source:5});this.Kd.Rr(a,b,c=>{c.xB=1;c.$za=52;c.title=ResourceStrings.l_RepairFailDialogTitle;c.message=ResourceStrings.l_RepairFailedMessage;return!1})}VXb(a,b,c,f,l){if(b.contextId!==fc.a.application)return 2;if(1===c)return 32;ya.a.J(38290632,801,50,"PowerPointAppFrameCommandUIActor - EditAnyway");a=this.dv.Srb();0!==a&&(ya.a.J(593268952,
801,15,"PowerPointAppFrameCommandUIActor::EditAnyway - Creating Pop session as emergencyViewModeEnabledReason: {0}",a),this.ESf());if(20===l)this.dv.Vtl();else return ya.a.J(38290634,801,10,"PowerPointAppFrameCommandUIActor - Unexpected EditAnyway operation"),8;return 32}kFb(a,b,c,f,l){if(b.contextId!==fc.a.application)return ya.a.J(42823955,801,15,"PowerPointAppFrameCommandUIActor - SaveRepairedFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return this.ia.processAction(l,
1);ya.a.J(42823957,801,50,"PowerPointAppFrameCommandUIActor - SaveRepairedFile - saveAsActionId : {0}",l);this.Gdg(1,l);return 32}Gdg(a,b){ya.a.J(42823959,801,50,"GetSnappedDownloadUrl for saving the repaired file");const c=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.Ga.podsWebServiceBase,this.Xa.podSessionId),f={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;const l=new Date;
u.AFrameworkApplication.He.vj(c,1,"",f,!1,0,x=>{this.ive(x,l,b)},x=>{this.hve(x,a,b)},null,null)}ive(a,b,c){ya.a.J(42823961,801,50,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+b);a=JSON.parse(a.data.Zd).downloadUrl;Ma.a.Va(a)?(ya.a.J(42823963,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty"),this.Nrh()):(b={SkipSaveToHost:"true"},b.FileDownloadUrl=a,this.ia.Ka(c,2,b))}hve(a,b,c){a=a.data?a.data.af:
-1;a===Np.a.Uai&&0<b--?(ya.a.J(42823965,801,15,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",a),this.Gdg(b,c)):(ya.a.J(42823967,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : HttpStatus: {0} , SaveAsActionId : {1}",a,c),this.Nrh())}Nrh(){const a=Object.assign(new Kg.a,{Code:20,Source:6});this.Kd.Rr(a,this.Xa.podSessionId,b=>{b.xB=1;b.$za=1;b.title=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogTitle;
b.message=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogMessage;return!1})}aic(a,b,c){if(b.contextId!==fc.a.application)return ya.a.J(50677769,801,15,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return a=u.AFrameworkApplication.fa.Ha("DocumentPermissions")||"",b=this.Xa.g2g&&-1<a.indexOf("W"),ya.a.J(51127232,801,b?50:15,"PowerPointAppFrameCommandUIActor::ReplaceOriginalFile- InlineRepairedFile case: IsReplaceRepairedEnabled : {0}, Document Permission : {1} ",
this.Xa.g2g,a),b?32:8;ya.a.J(50677771,801,50,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile");this.Xa.tk=this.O8.Q5a(this.Xa.presentationId.string);a=Object.assign(new Mj.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ga.podsWebServiceBase,PopSessionID:this.Xa.tk,UrlOverrides:this.Ga.Vda,IsCreateNewSession:this.Ga.xS,UseSharedHostFile:this.Ga.FJb});this.O8.$Bc(a,()=>{this.Bjk()},Object(D.a)(this,
this.dCb,"onEnsureHostSessionFailed"),0,!0);return 32}Bjk(){ya.a.J(50677773,801,50,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccess");this.dv.pTk();this.Xa.FTk();0!==this.dv.Srb()&&this.dv.aIe(!1)}dCb(){ya.a.J(50677775,801,10,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionFailed");this.dv.$He();0!==this.dv.Srb()&&this.dv.aIe(!0);return!1}X0b(a,b,c){if(b.contextId!==fc.a.application)return ya.a.J(593297441,801,15,"PowerPointAppFrameCommandUIActor - GoToEditMode. Context id don't match with Application. ContextId: {0}",
b.contextId),2;if(1===c)return 32;a=new Date;this.ESf();ya.a.J(593268936,801,15,"PowerPointAppFrameCommandUIActor::GoToEditMode. Time-Taken to create pop session : {0}",+new Date-+a);return 32}ESf(){this.Xa.tk=this.O8.Q5a(this.Xa.presentationId.string);const a=Object.assign(new Mj.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ga.podsWebServiceBase,PopSessionID:this.Xa.tk,UrlOverrides:this.Ga.Vda,
IsCreateNewSession:this.Ga.xS,UseSharedHostFile:this.Ga.FJb});this.O8.$Bc(a,()=>{this.Cjk()},null,15,!0);this.dv.aIe(!1)}Cjk(){ya.a.J(593297435,801,15,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccessForEmergencyViewMode")}}Object(e.a)(he,"PowerPointAppFrameCommandUIActor",null,[]);var Ie=d(497);class Mf{constructor(a,b,c){this.VCg=a;this.ZZ=b;this.Ake=c}show(a,b){this.Ake?(b=new Ie.a(b),b.message=ResourceStrings.l_Saving,b.qtg=!0,b.cHb=a,this.ZZ.mHa(b)):this.jMe(a,ResourceStrings.l_Saving,
b)}jMe(a,b,c){this.Ake?(c=new Ie.a(c),c.message=b,c.cHb=a,this.ZZ.mHa(c)):this.VCg.eHb(b,a,0,0,c)}hide(){this.Ake?this.ZZ.mHa(Object.assign(new Ie.a(null),{ptg:!0})):this.VCg.jPc()}}Object(e.a)(Mf,"SaveBlockingUI",null,[1207]);var Jg=d(232);class eh{constructor(a,b,c,f,l,x,F,R,fa){this.x9b=Gb.App.Im;this.rKg=Ga.a.nil;this.yb=a;this.ta=b;this.Mc=c;this.Bk=f;this.VK=l;this.q2c=x;this.KA=R;this.Ls=F;this.x4j=fa.EXk;this.l5j=fa.pptNotShowSavingStatusOfProofingOnlyRevision;this.Mc.tB(Object(D.a)(this,
this.VA,"onSessionEnd"));this.Bk.oGd(Object(D.a)(this,this.aCh,"updateSavingStatus"));this.Bk.WCf(Object(D.a)(this,this.$Bh,"updateSavedStatus"));this.Ls.vM(Object(D.a)(this,this.gna,"updateSaveStatusDisplay"));this.Y9j=new He.a(3,1,fa.DXk,Object(D.a)(this,this.updateSaveStatusText,"updateSaveStatusText"),90,"28");this.jSa=!1;this.h6j=fa.powerPointTextEditOnlyMode}initialize(){this.gna(this.Ls)}$Bh(){this.jSa||this.KA.P7||this.KA.Ewg||(this.yb.Gb(this.Y9j),this.jSa=!0)}aCh(a,b){this.KA.P7||this.KA.Ewg||
(this.l5j&&eh.pLj(b.node)||this.q2c.updateSaveStatusText(!1),this.x9b=new Date,this.rKg=b?b.revisionId:Ga.a.nil)}updateSaveStatusText(){this.jSa=!1;const a=!this.VK.KV(this.ta.presentation);this.q2c.updateSaveStatusText(a);a&&(this.teh(0,0),this.x9b=Gb.App.Im);this.h6j&&eh.kul(a)}gna(a){this.q2c.gna(!1,1===a.mode?1:3)}VA(a,b){this.q2c.updateSaveStatusText(!0);this.teh(1,b.fJ);this.x9b=Gb.App.Im}teh(a,b){if(this.x9b!==Gb.App.Im){var c=+new Date-+this.x9b;c>=this.x4j&&(c=String.format("SavingTime {0};Type {1};Revision {2};",
c,a,this.rKg),1===a&&(c+=String.format("CloseReason {0};",b)),ya.a.J(21604228,811,50,c))}}dispose(){this.Mc.gea(Object(D.a)(this,this.VA,"onSessionEnd"));this.Bk.LDe(Object(D.a)(this,this.aCh,"updateSavingStatus"));this.Bk.pdh(Object(D.a)(this,this.$Bh,"updateSavedStatus"));this.Ls.rX(Object(D.a)(this,this.gna,"updateSaveStatusDisplay"))}static kul(a){const b=document.getElementById("TipStatus"),c=document.getElementById("TipStatusIcon"),f=document.getElementById("TipStatusText");b.style.display=
"block";a?(c.setAttribute("class","TipStatusSaved"),f.innerText=ResourceStrings.l_SavedShort):(c.setAttribute("class","TipStatusLoading"),f.innerText=ResourceStrings.l_SavingShort)}static pLj(a){return a.Sa(ub.a.W$c)&&!a.Sa(Jg.a.ied)}}Object(e.a)(eh,"SaveStatusManager",null,[106]);class hj{constructor(){this.K=null;this.Yke=!1}get name(){return"PowerPointWebEditor.Actors"}Wb(a){(new Lw).Wb(a);this.K=a;a.register(he,"PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ma().na(()=>new he(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPoint.IPathManager"),a.resolve("Common.IDocPropertiesProvider"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.La("Postmessage.IHostPostmessenger"),a.resolve("PowerPointWebEditor.ISaveBlockingUI"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager")));a.register(1207,"PowerPointWebEditor.ISaveBlockingUI").ma().na(()=>new Mf(new Mw(new Sq(a.resolve("PowerPointWebEditor.IPaneManager").ya,"SaveBlockingUI",!0),a.resolve("PowerPointWebEditor.IActionNameResolver")),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").Vug));a.register(eh,"PowerPointWebEditor.SaveStatusManager").ma().na(()=>new eh(a.resolve("Common.ITaskManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){(this.Yke=this.K.resolve("PowerPointWebEditor.IApplicationSettings").UKj)&&
this.K.resolve("PowerPointWebEditor.SaveStatusManager").initialize();this.K.resolve("PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ub();this.K.resolve("Common.IOfficeTrialExperience").ub();this.K.resolve("Common.IMacOfficeOffer").ub()}dispose(){this.Yke&&this.K.resolve("PowerPointWebEditor.SaveStatusManager").dispose()}static main(){m.a.instance.Ac(new hj)}}Object(e.a)(hj,"PowerPointActorsPackage",null,[2,3]);var Ei=d(998),zl=d(1061);class Xg{constructor(){this.CMa=this.ER=this.tya=null;
this.ruf=!1;this.mVe=null;this.nVe=this.NOb=0}get messageId(){return this.tya}get values(){return this.ER}get userSessionId(){return this.CMa}get shouldRetry(){return this.ruf}get Dyc(){return this.mVe}get Fua(){return this.NOb}get CYh(){return this.nVe}static Lzi(a,b){var c=Le.a.bDi;const f=new Xg;f.tya=a;f.ER={};f.CMa=b;f.ruf=!0;f.mVe=c;f.NOb=3;f.nVe=1E3;return f}}Object(e.a)(Xg,"PostMessageData",null,[]);class Bm{constructor(a,b,c){this.ECd={};this.jb=a;this.mtd=c;this.fUj();this.ZJk(b)}fUj(){if(this.jb.ka("DocRebootIsSupported")||
this.jb.ka("UiHostSupportsDocRebootFeatures"))this.ECd[zl.a.refresh]=()=>this.XZk(Le.a.RAa)}ZJk(a){a.xa(G.a.q9g,de.a.frame,Object(D.a)(this,this.yZk,"sendActionToHostIfSupported"))}yZk(a,b,c,f,l){if(2!==c)return 32;if(!l)return Z.ULS.sendTraceTag(41972610,204,15,"HostActionExecutionManager - No actionData provided"),16;a=l.toLowerCase();return this.ECd[a]?(Z.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",a),this.ECd[a]()):2}XZk(a){const b=Xg.Lzi(a,
u.AFrameworkApplication.userSessionId);this.mtd.execute(c=>{c.postMessage(b)});return 32}}Object(e.a)(Bm,"HostActionExecutionManager",null,[]);var Wn=d(114),Xn=d(710);class ip extends S.a{constructor(a,b,c,f){super(a,b,c);this.cNb=this.J5=0;this.v4e=!1;this.eNb=0;this.ltd=this.Yrc=null;this.w4e=this.x4e=!1;this.Ca=f;this._name="HostIntegrationMessenger";this.create()}Csj(a){const b=a.message,c=a.Ti.origin;u.AFrameworkApplication.wopiHostOriginFromPostMessage||(u.AFrameworkApplication.wopiHostOriginFromPostMessage=
c);switch(b.MessageId){case Le.a.xJd:case Le.a.zJd:this.wsj(b);break;case Le.a.l2d:case Le.a.m2d:this.Fkd();break;case Le.a.r4d:this.Esj(b);break;case Le.a.V8a:this.DQj(b);break;case Le.a.bUe:this.gbi(a);break;case Le.a.fUe:this.Orl()}}nrl(a){switch(a.MessageId){case Le.a.n4d:u.AFrameworkApplication.Ta.Ka(G.a.rdd,2,a.Values[Gi.a.direction]);break;case Le.a.qtb:Z.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received");u.AFrameworkApplication.Ta.Ka(G.a.qtb,2,(new Date).getTime());break;case Le.a.o4d:Z.ULS.sendTraceTag(544221062,
204,50,"We received HostBackButtonPressed message in WAC");break;case Le.a.p4d:Z.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved");u.AFrameworkApplication.Ta.processAction(G.a.zZi,2);break;case Le.a.Y1b:Z.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved");u.AFrameworkApplication.Ta.processAction(G.a.Y1b,2);break;case Le.a.q4d:Z.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received");u.AFrameworkApplication.Ta.processAction(G.a.uhj,2);break;case Le.a.u4d:Z.ULS.sendTraceTag(537424842,
204,50,"Host_SendChannelId Received")}}Fkd(){v.FocusManager.instance()&&v.FocusManager.instance().ye&&v.FocusManager.instance().ye.name===u.AFrameworkApplication.udb&&v.FocusManager.instance().s4(v.FocusManager.instance().ye.name)}wsj(a){v.FocusManager.instance().oX(u.AFrameworkApplication.udb,!1);if(Gi.a.akc in a.Values){const b={};b[Gi.a.akc]=a.Values[Gi.a.akc];Z.ULS.sendTraceTag(38278996,204,50,fe.c(b))}}Esj(a){if(!cg.a.mS(document.URL,u.AFrameworkApplication.j5c)&&a.Values){var b=0,c=0;try{b=
a.Values[Gi.a.Fsj],c=a.Values[Gi.a.Gsj],Gi.a.gkg in a.Values?this.Yrc=a.Values[Gi.a.gkg]:Gi.a.hkg in a.Values&&(this.Yrc=a.Values[Gi.a.hkg]),Gi.a.ikg in a.Values&&(this.ltd=a.Values[Gi.a.ikg])}catch(f){return}this.cNb=b;this.eNb=c;this.J5&&this.PAg()}}DQj(a){Z.ULS.sendTraceTag(37536415,204,50,"JsApiDiagnostics");var b=a.Values[Gi.a.Bsj];b&&tj.a.instance.EIk(b);(b=a.Values[Gi.a.oMd])&&tj.a.instance.rIk(b);(a=a.Values[Gi.a.V8a])&&tj.a.instance.JIk(a)}gbi(a){Z.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",
Date.now());u.AFrameworkApplication.G4b=!0;u.AFrameworkApplication.Aa.n0.due(a.Ti.lc)}Orl(){Z.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now());u.AFrameworkApplication.Aa.n0.Eve(null,Sys.EventArgs.Empty)}PAg(){this.gWj();this.hWj();null!=this.Yrc&&tj.a.instance.FIk(this.Yrc);null!=this.ltd&&tj.a.instance.GIk(this.ltd)}gWj(){this.J5&&this.cNb&&!this.v4e&&(this.v4e=!0,this.cNb>this.J5||(u.AFrameworkApplication.Zi.setDw(10324,this.J5-this.cNb),tj.a.instance.sah(this.cNb)))}hWj(){this.J5&&
this.eNb&&!this.x4e&&(this.x4e=!0,this.eNb>this.J5||(u.AFrameworkApplication.Zi.setDw(10325,this.J5-this.eNb),tj.a.instance.kJk(this.eNb)))}lSk(){var a=kb.a.xfg();if(a){var b=0;a=a.fetchStart;void 0!==a&&null!==a&&(b=a);0>=b||b>this.J5||u.AFrameworkApplication.Zi.setDw(11045,this.J5-b)}}create(){u.AFrameworkApplication.Yrg&&this.disable();this.UIa!==Xn.a.fTb&&this.Tyc(this.UIa);this.Ca.pa(G.a.$Gi,de.a.frame,Object(D.a)(this,this.eHi,"disposeInstance"),96);this.Vt(Le.a.xJd);this.Vt(Le.a.zJd);this.Vt(Le.a.l2d);
this.Vt(Le.a.m2d);this.Vt(Le.a.r4d);this.Vt(Le.a.t4d);this.Vt(Le.a.vHd);const a=Object(D.a)(this,this.Csj,"hostMessageHandler");this.WWa(Le.a.xJd,a);this.WWa(Le.a.zJd,a);this.WWa(Le.a.l2d,a);this.WWa(Le.a.m2d,a);this.WWa(Le.a.r4d,a);u.AFrameworkApplication.fa.ka("OneNoteEmbedUnloadIsEnabled")&&(this.cAf(Le.a.bUe),this.cAf(Le.a.fUe),this.WWa(Le.a.bUe,a),this.WWa(Le.a.fUe,a));if(u.AFrameworkApplication.fa.ka("PostMessageEmbedded")||u.AFrameworkApplication.fa.ka("IsJsApi")){this.Vt(Le.a.qtb);const b=
Object(D.a)(this,this.nrl,"uiHostMessageHandler");u.AFrameworkApplication.fa.ka("SupportsAccessibilityLoop")&&(this.Vt(Le.a.n4d),this.ZA(Le.a.n4d,b));this.ZA(Le.a.qtb,b);u.AFrameworkApplication.fa.ka("MobileEmbedViewerIsEnabled")&&(this.Vt(Le.a.p4d),this.ZA(Le.a.p4d,b),this.Vt(Le.a.o4d),this.ZA(Le.a.o4d,b),this.Vt(Le.a.Y1b),this.ZA(Le.a.Y1b,b),this.Vt(Le.a.q4d),this.ZA(Le.a.q4d,b));u.AFrameworkApplication.fa.ka("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.Vt(Le.a.u4d),this.ZA(Le.a.u4d,b))}u.AFrameworkApplication.fa.ka("IsJsApi")&&
(this.Vt(Le.a.V8a),this.WWa(Le.a.V8a,a))}eHi(a,b,c){if(2!==c)return 32;Wn.a.ex(this);return 32}reportDocumentLoadedTime(a){this.w4e||(this.J5=a,this.lSk(),this.UIa!==Xn.a.fTb&&this.sendMessage(Le.a.i8h,{["DocumentLoadedTime"]:a}),this.PAg(),this.w4e=!0)}}Object(e.a)(ip,"HostIntegrationMessenger",S.a,[931,726,106]);class Ym{constructor(){this.Da=null}get name(){return"Common.App.Postmessengers"}init(){u.AFrameworkApplication.fa.ff(()=>{this.u5d(this.Da)})}u5d(a){u.AFrameworkApplication.NP=a.resolve("Common.App.Postmessengers.HostIntegrationMessenger");
u.AFrameworkApplication.fa.ka("HostActionExecutionIsEnabled")&&a.resolve("Common.App.HostActionExecutionManager")}dispose(){}Wb(a){this.Da=a;a.register(ip,"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").ma().na(()=>{u.AFrameworkApplication.fa.Zba||Z.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const b=u.AFrameworkApplication.Lla?u.AFrameworkApplication.Lla:Xn.a.fTb;Z.ULS.sendTraceTag(536987587,204,
50,"HostIntegrationMessenger instantiating");return new ip(window.parent,b,Ei.a.instance,u.AFrameworkApplication.Ta)});a.register(Bm,"Common.App.HostActionExecutionManager").ma().na(()=>{u.AFrameworkApplication.fa.Zba||Z.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready");return new Bm(u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.La("Postmessage.IHostPostmessenger"))})}}Object(e.a)(Ym,"PostmessengersPackage",null,[2,3]);var Zm=d(394),
sk=d(346),Si=d(288),Of=d(220);class Ys extends Of.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(e.a)(Ys,"PersonaButtonProps",Of.a,[]);class mu{vWb(a,b){if(a&&!(1>a.length)&&b){var c=Object.assign(new Si.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.Ywi(a,c.ControlList);b.push(c)}}Ywi(a,b){const c=Object.assign(new Zm.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new sk.a,
{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(b,c);b=Object.assign(new Si.a,{Title:"",ControlList:[]});Array.add(c.Menu.MenuSectionList,b);this.gzi(a,b.ControlList)}gzi(a,b){for(let c=0;c<a.length;c++){const f=Object.assign(new Ys,{ExternalId:String.format("CoauthorPersona_{0}",c),Command:"336231556",DisplayName:a[c].userName,LabelText:a[c].userName,ImageBackColor:a[c].color,PersonaId:a[c].email,IsAnonymous:a[c].isAnonymous});Array.add(b,f)}}}
Object(e.a)(mu,"PresenceContextMenuSectionBuilder",null,[806]);var Lv=d(345);class Mv{constructor(a,b,c,f){this.dY=this.Qn=this.Hm=this.tf=this.zna=null;this.Xwc=a;this.gVh=f;this.Xwc.s7d&&(this.Hm=new He.a(3,2,5E3,Object(D.a)(this,this.wai,"authenticationCheckTask"),2),u.AFrameworkApplication.ue.Gb(this.Hm),this.ub(b,c));this.Xwc.u2h(()=>{this.Kcc()});this.Xwc.dCf(()=>{this.Lcc()})}get businessBar(){return this.Qn||(this.Qn=hb.a.instance.pb("CommonUI.IBusinessBar"))}get dJf(){return this.dY||(this.dY=
hb.a.instance.pb("CommonUI.IBusinessBarEntryFactory"))}ub(a,b){const c=u.AFrameworkApplication.Ta;c.pa(G.a.YGf,de.a.frame,a,96);c.pa(G.a.ZGf,de.a.frame,b,96);c.xa(G.a.yLf,de.a.frame,ce.ActionManager.Mu);c.xa(G.a.zLf,de.a.frame,ce.ActionManager.Mu);c.xa(G.a.sbe,de.a.frame,ce.ActionManager.Mu)}Kcc(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);u.AFrameworkApplication.Ta.processAction(G.a.YGf,2)}Lcc(){this.zkl();u.AFrameworkApplication.Ta.processAction(G.a.ZGf,2)}wai(){this.Xwc.authenticationCheck()}zkl(){this.tf&&
(this.tf.hide(),this.tf.dispose(),this.tf=null);this.zna&&this.businessBar&&(u.AFrameworkApplication.Xg||this.businessBar.removeEntry(this.zna),this.zna.dispose(),this.zna=null)}showDialog(a){Wn.a.ex(this.tf);this.tf=new rj.StandardDialog;this.gVh||(this.tf.hr=!1,this.tf.vd=0);this.tf.Re(1,CommonUIStrings.l_SignIn);this.tf.mO(CommonUIStrings.l_DefaultDialogTitle,a,Object(D.a)(this,this.T1,"dialogHandler"))}T1(a){1===a?(Lv.a.I9c(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),
u.AFrameworkApplication.Ta.processAction(G.a.sbe,2)):(this.Gal(),u.AFrameworkApplication.Ta.processAction(G.a.zLf,2))}Gal(){this.businessBar&&this.dJf&&(this.zna=this.dJf.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.zna.closeable=!0,this.zna.addButton(CommonUIStrings.l_SignIn,Mv.jfi,""),this.zna.I1=Object(D.a)(this,this.kfi,"businessBarEntryCloseHandler"),this.businessBar.Rh(this.zna,!1))}kfi(){this.qGi();u.AFrameworkApplication.Ta.processAction(G.a.yLf,
2)}qGi(){this.Hm&&(u.AFrameworkApplication.ue.Qg(this.Hm),this.Hm=null)}dispose(){this.Hm=this.tf=this.zna=null}static jfi(){Lv.a.I9c();u.AFrameworkApplication.Ta.processAction(G.a.sbe,2)}}Object(e.a)(Mv,"SignOutResponseUI",null,[106]);class xr{get name(){return"Common.App.UI"}Wb(a){a.register(mu,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ma()}init(){}dispose(){Wn.a.ex(xr.laa);xr.laa=null}static main(){m.a.instance.Ac(new xr)}static pwj(a,
b,c){xr.ral()&&(xr.laa=new Mv(Lv.a.instance,a,b,c))}static ral(){return u.AFrameworkApplication.pUg&&!u.AFrameworkApplication.isEmbedded}}xr.laa=null;Object(e.a)(xr,"CommonAppUIPackage",null,[2,3]);class pA{constructor(a){this.Pya=this.Jya=this.Uya=this.Tya=null;this.V3e=this.Mbf=this.MO=this.V$=!1;this.kAd=this.dcf=null;this.Xbf=0;this.jb=this.ccf=null;this.Afa=a;this.tJ=3;this.CNb=!0}initialize(a,b,c){this.Tya=this.n0d(a,b);this.Uya=CommonUIStrings.l_SavingStatus;this.Jya=CommonUIStrings.l_ReadOnlyStatus;
this.Pya=CommonUIStrings.l_ReviewModeStatus;this.Afa&&this.Afa.execute(f=>{f.Ezc(Object(D.a)(this,this.qnc,"updateToSavingStatus"))});this.MO=!0;this.jb=c;return!0}gna(a,b){this.V$=a;this.tJ=b;this.updateSaveStatusText(this.CNb)}updateSaveStatusText(a){!this.CNb&&a&&(this.ccf=new Date);this.CNb=a;a=null;3===this.tJ&&(a=this.CNb?this.Tya:this.Uya);this.HGi(a)}n0d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,
b):CommonUIStrings.l_SavedStatus}qnc(){this.updateSaveStatusText(!1)}k7i(){switch(this.tJ){case 1:return this.Jya;case 2:return this.Pya;default:return null}}KEj(a){return this.Mbf===this.V$&&this.Xbf===this.tJ&&this.dcf===a}BRd(a){appChrome.getHeaderApi().then(b=>{b.updateDocumentTitleStatus(this.V$,a,this.k7i(),this.ccf,this.CNb);this.V3e=!0;return null});this.kAd=null}HGi(a){this.MO&&Ag.c()&&!this.KEj(a)&&(!this.V3e&&this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.BRd(a):kb.a.Yeh()?(this.kAd&&Z.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.kAd=window.requestIdleCallback(()=>{this.BRd(a)})):window.requestAnimationFrame(()=>{this.BRd(a)}),this.Mbf=this.V$,this.dcf=a,this.Xbf=this.tJ)}}Object(e.a)(pA,"ReactSaveStatusUIHandler",null,[1316]);class qA{constructor(a,b){this.NP=null;this.Tya=CommonUIStrings.l_SavedStatus;this.Uya=CommonUIStrings.l_SavingStatus;this.Jya=CommonUIStrings.l_ReadOnlyStatus;
this.Pya=CommonUIStrings.l_ReviewModeStatus;this.hya=b;this.Afa=a;this.tJ=3;this.fMa=!0}$I(){this.Afa&&this.Afa.execute(a=>{a.Ezc(Object(D.a)(this,this.qnc,"updateToSavingStatus"))});this.hya.execute(a=>{this.NP=a})}gna(a,b){this.tJ=b;3===b?this.updateSaveStatusText(this.fMa):2===b?this.ERe(this.Pya):this.ERe(this.Jya)}qnc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.fMa=a;this.ERe(this.fMa?this.Tya:this.Uya)}ERe(a){this.NP&&this.NP.sendMessage(Le.a.lrl,this.Csi(a))}Csi(a){const b=
{};b.StatusText=a;return b}}Object(e.a)(qA,"SaveStatusPostMessageHandler",null,[1316]);var ym=d(262);class rA{constructor(a,b,c,f){this.Pya=this.Jya=this.Uya=this.Tya=null;this.N0a=0;this.VO=this.YAd=this.UZa=this.kod=this.yDd=null;this.Ve=a;this.Yna=b;this.Afa=c;this.Qi=f;this.u7e=!0;this.V$=!1;this.tJ=3;this.fMa=!0}initialize(a,b){if(!this.Ve)return!1;this.Tya=this.n0d(a,b);this.Uya=CommonUIStrings.l_SavingStatus;this.Jya=CommonUIStrings.l_ReadOnlyStatus;this.Pya=CommonUIStrings.l_ReviewModeStatus;
this.$I();return!0}n0d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}$I(){this.Yna&&this.Yna.execute(a=>{a.E4h(Object(D.a)(this,this.dTf,"createStatusAndModeElements"));a.l4h(Object(D.a)(this,this.Lbl,"showHideSaveStatusElement"));a.dnl&&this.dTf(null,null)});this.Afa&&this.Afa.execute(a=>{a.Ezc(Object(D.a)(this,this.qnc,"updateToSavingStatus"))})}mxa(){this.VO&&
this.Ve&&this.Ve.gld(this.VO)}Lbl(a,b){this.gna("true"===b,this.tJ)}gna(a,b){this.V$=a;this.tJ=b;this.kod&&(this.kod.style.display=this.V$||3===this.tJ||!this.yDd?"none":"");this.UZa&&(this.UZa.style.display=this.V$||3===this.tJ?"none":"",this.UZa.innerText=1===this.tJ?this.Jya:this.Pya,this.UZa.title=1===this.tJ?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.YAd&&(this.YAd.style.display=this.V$||1===this.tJ||!this.yDd&&!this.UZa?"none":"");this.VO&&(this.VO.style.display=
this.V$||1===this.tJ?"none":"",this.updateSaveStatusText(this.fMa),this.VO.title=CommonUIStrings.l_SaveStatusTooltip)}dTf(a,b){a=document.getElementById(ym.CuiHelper.Drj);b&&b.CAl||!a||""===this.Tya||""===this.Uya||""===this.Jya||""===this.Pya||(this.yDd=document.getElementById(ym.CuiHelper.LJd),this.kod=ym.CuiHelper.DEc(a,"BreadcrumbAppModeDash","-"),this.UZa=ym.CuiHelper.DEc(a,"BreadcrumbAppModeStatus",1===this.tJ?this.Jya:this.Pya),this.SAh(this.UZa),this.YAd=ym.CuiHelper.DEc(a,"BreadcrumbSaveStatusDash",
"-"),this.VO=ym.CuiHelper.DEc(a,"BreadcrumbSaveStatus",this.Tya),this.SAh(this.VO),this.gna(this.V$,this.tJ))}qnc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.fMa=a;this.bwl(this.fMa?this.Tya:this.Uya)}bwl(a){!this.VO||3!==this.tJ&&2!==this.tJ||(this.u7e&&!this.fMa?(this.N0a=this.VO.offsetWidth<this.N0a?this.N0a:this.VO.offsetWidth,this.Tsl(this.Uya),this.u7e=!1):this.VO.innerText=a)}SAh(a){a.style.direction=this.Qi?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.Qi?"right":
"left";a.style.display=this.V$?"none":"";a.setAttribute("Unselectable","on")}Tsl(a){this.VO&&(this.VO.style.width="",this.VO.innerText=a,this.N0a=this.VO.offsetWidth<this.N0a?this.N0a:this.VO.offsetWidth,a=Vg.a.Ru(this.VO),this.VO.style.width=this.N0a-Ba.a.yL(a.paddingLeft)-Ba.a.yL(a.paddingRight)+1+"px")}}Object(e.a)(rA,"SaveStatusUIHandler",null,[1316]);class jF{constructor(){this.ZAd=this.Rzd=this.zQb=this.Da=null}get name(){return"Common.App.SaveStatus"}Wb(a){this.Da=a;u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&
u.AFrameworkApplication.LP?this.Da.register(qA,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new qA(this.Da.La("Common.App.HostNotification.EditNotificationEventSource"),this.Da.La("Postmessage.IHostPostmessenger"))):u.AFrameworkApplication.Aa.gb.kxg||(u.AFrameworkApplication.Aa.gb.iN?this.Da.register(pA,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new pA(this.Da.La("Common.App.HostNotification.EditNotificationEventSource"))):
this.Da.register(rA,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new rA(bd.EventHandlerManager.instance,this.Da.La("Common.App.Header.HeaderEventSource"),this.Da.La("Common.App.HostNotification.EditNotificationEventSource"),u.AFrameworkApplication.isRtl)))}init(){u.AFrameworkApplication.fa.ff(Object(D.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){const a=u.AFrameworkApplication.fa,b=!!u.AFrameworkApplication.Aa.gb&&4===u.AFrameworkApplication.Aa.gb.Am;
if(a.ka("WordEditorAutoSaveImprovementIsEnabled")||a.ka("PptEditorSaveStatusInHeaderEnabled")||b&&a.ka("SimplifiedReactRibbonUxIsEnabled")||a.ka("ExcelSaveStatusInHeaderEnabled")||a.ka("VisioSaveStatusInHeaderEnabled"))u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&u.AFrameworkApplication.LP?(this.ZAd=this.Da.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.ZAd.$I():u.AFrameworkApplication.Aa.gb.kxg||(u.AFrameworkApplication.Aa.gb.iN?(this.Rzd=this.Da.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&
this.Rzd.initialize(a.ka("IsSkyDrive"),a.Ha("HostNameToIncludeInSavedStatus"),u.AFrameworkApplication.fa):(this.zQb=this.Da.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.zQb.initialize(a.ka("IsSkyDrive"),a.Ha("HostNameToIncludeInSavedStatus")))}dispose(){this.zQb&&this.zQb.mxa()}}Object(e.a)(jF,"PackageManager",null,[2,3]);window.PPTCampaignsObj_FromAppPackage=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2022-09-30T00:00:00Z",
GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",
Question:"nps_OneClickPromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_OneClickRating_Values_1","nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURFhIWVJFRVVSTDRCSExHUEdXMzQ3OFoyMy4u"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",
LauncherType:"customervoice",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:22,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,
Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCpFge6Cl3sRFoOMTPf8V7pNUMFpIMk1RSVo3WDhFQ0tPM0JPQ0VZOFc0Ty4u"}}}},
{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",
IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",
LauncherType:"customervoice",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,
Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURDNVQ1BHVkxLUUpKTk80UDZDMk1TMFlPOC4u"}}}},
{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",
IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},
{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2021-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",
IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2","VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2022-08-26T00:00:00Z",
GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",
Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,
AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",
YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,
AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},
Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2022-08-21T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Please tell us about your experience using the Comments feature in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the Comments feature in PowerPoint for the web?",
RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-08-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},
CooldownPeriod:{Type:0,IntervalSeconds:31536E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},
{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:30,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},
Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"826063c4-f637-4317-9dd4-ec099224b8cd",
StartTimeUtc:"2021-04-01T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AgendaToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",
Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of adding slides automatically?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"f4aa2c06-b017-4702-a6db-83036ab55495",StartTimeUtc:"2021-04-23T00:00:00Z",EndTimeUtc:"2021-10-23T00:00:00Z",GovernedChannelType:0,
AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitTaskActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Please tell us about your experience using Tasks in PowerPoint",Question:"We have just two questions for you.",
YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with Tasks in PowerPoint for Web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",
RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4","FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},
{Type:0,Value:"fr-FR"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,
Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"ar-SA"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},{Type:0,Value:"he-IL"},{Type:0,Value:"hr-HR"},{Type:0,Value:"it-IT"},{Type:0,Value:"ko-KR"},{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},
CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1",
"FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,
Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IN"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},
{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ku-Arab-IQ"},{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"mso-ZA"},
{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,
Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184E3},CooldownPeriod:{Type:0,IntervalSeconds:15552E3},
FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3",
"FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"c551d75c-10b1-4de2-83cc-cce22d7c06bd",LauncherType:"coachingux",StartTimeUtc:"2021-08-15T00:00:00Z",EndTimeUtc:null,GovernedChannelType:3,Tags:["FirstRunExperienceV2"],PrimaryPriority:5,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#b7472a",buttonHoverColor:"#a92b1a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:"#BreadcrumbSaveStatus #documentTitle #documentTitleContainer #WACRibbon-QATRowCenter #BreadcrumbSaveStatusDash #ResponsiveCenterRegion #AppHeaderPanel div[role='toolbar'] div[class*='cui-topBar1-transistionalHeaderUI'] #o365header #O365_NavHeader".split(" "),
title1:"Never lose your work",description1:"Your file is automatically saved online. Just click the title to rename or change the save location.",illustrationImage1:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yjj0",primaryButtonText1:"Next",delayLoad1:1E3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share and collaborate",description2:"Share your presentation so others can leave comments and feedback, even if they don't have Office themselves.",
illustrationImage2:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yrdA",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='Present']","button[aria-label='Present']"],title3:"Start presenting",description3:"When you're ready, click Present to start your slideshow.",illustrationImage3:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4ytEj",primaryButtonText3:"Got it"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",
StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin\u200b",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",
primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,
Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",
userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"cbb7eaa0-6e95-422d-9647-2be7d2737d4a",
LauncherType:"coachingux",StartTimeUtc:"2022-01-20T08:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForContentAddin"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},
SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForContentAddin",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[data-unique-id='Ribbon-InsertAppsForOffice']\", \"button[data-unique-id='Ribbon-InsertAddIns']\", \"button[data-unique-id='Overflow-RibbonOverflowMenu-overflow']\"]",
title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchContentAddin",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2023-02-01T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",
NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2023-1-31T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"bf20f28c-af0a-4d43-a87b-239b0419c65f",
StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2023-06-30T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SimplicityEaseOfUseSurvey",IsAggregate:!0,Count:360},{Type:0,Activity:"SimplicityEaseOfUseSurveyTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"EaseOfUse_Floodgate_Prompt_Line1",
Question:"EaseOfUse_Floodgate_Prompt_Line2",YesLabel:"EaseOfUse_Floodgate_Prompt_Affirmative_Answer",NoLabel:"EaseOfUse_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"EaseOfUse_Floodgate_Rating_Question",RatingValuesAscending:["EaseOfUse_Floodgate_Rating_Scale_1","EaseOfUse_Floodgate_Rating_Scale_2","EaseOfUse_Floodgate_Rating_Scale_3","EaseOfUse_Floodgate_Rating_Scale_4","EaseOfUse_Floodgate_Rating_Scale_5"]},Question:{Question:"EaseOfUse_Floodgate_Comment_Question"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",
StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2022-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",
NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2022-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:75,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1",
"Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AddPenStrokePPTO",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"PenInkSurvey_Prompt",Question:"PenInkSurvey_PromptQuestion",YesLabel:"PenInkSurvey_Prompt_Sure",NoLabel:"PenInkSurvey_Prompt_NoNow"},Rating:{Question:"PenInkSurvey_RatingQuestion",RatingValuesAscending:["PenInkSurvey_QuestionChoice_5","PenInkSurvey_QuestionChoice_4","PenInkSurvey_QuestionChoice_3","PenInkSurvey_QuestionChoice_2","PenInkSurvey_QuestionChoice_1"]},Question:{Question:"PenInkSurvey_WhyQuestion"}}}}];var SO=d(653);class kF{o6f(){return null}WYi(){return fe.c(window.PPTCampaignsObj_FromAppPackage)}M1d(a){return SO.a.M1d(a,
"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(e.a)(kF,"PowerPointFeedbackAppData",null,[1204]);class sA{constructor(){this.Da=null}Wb(a){this.Da=a;a.register(1204,"Common.App.IAppSpecificFeedbackData").ma().na(()=>new kF)}init(){this.Da.pb("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){m.a.instance.Ac(new sA)}}Object(e.a)(sA,"PPTWebEditorFeedbackPackage",null,[2,3]);class tA{get name(){return"Box4.ListEditors"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Ac(new tA)}}
Object(e.a)(tA,"Box4ListEditorsPackage",null,[2,3]);var yj=d(138),il=d(123);const uA=a=>{a=document.createElement(a);a.setAttribute("unselectable","on");return a};class lF{constructor(a){this.sEd=this.Vsd=!1;this.kKa=null;this.hXe=!1;this.t5=null;this.U$=!1;this.XSh=a;ja.a.instance.ob(qa.a.mouseDown,this.n_b(),Object(D.a)(this,this.Fik,"onContextualUIMouseDown"));(a=hb.a.instance.La("Common.IActionContextProvider"))&&a.execute(b=>{this.t5=b});u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
u.AFrameworkApplication.Aa.gb.iN?pd.a.get_instance().Xj(16,()=>{this.ag?this.initializeContextualUI(this.n_b()):pd.a.get_instance().Xj(7,()=>{this.initializeContextualUI(this.n_b())})}):pd.a.get_instance().Xj(7,()=>{this.initializeContextualUI(this.n_b())})}get yub(){return this.U$}get ag(){return u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&u.AFrameworkApplication.Aa.gb.iN?pd.a.get_instance().isCompleted(16)&&pd.a.get_instance().isCompleted(7):pd.a.get_instance().isCompleted(7)}zii(){if(this.hXe)return!0;
try{return Promise.resolve(null),this.hXe=!0}catch(a){return!1}}VRe(a){if(!this.ag||this.sEd)return this.zce("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.zii())return this.zce("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(u.AFrameworkApplication.UGc)return this.zce("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.sEd=!0;let b=G.a.ze;switch(a){case 1:b=G.a.showContextMenu;break;case 0:b=
G.a.showFloatie;break;case 2:b=G.a.$gd}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.sEd=!1;If.c(b)},0)});return!1}wfg(a){return yj.UISurfaces.EBa().then(b=>{if(appChrome.api.isSmallDevice()&&b.getBlockedSmallScreenFloatieGroupList){b=b.getBlockedSmallScreenFloatieGroupList();const c=[];for(const f of a)Array.contains(b,f)||c.push(f);return c}return a})}showFloatie(a,b,c,f=null){this.VRe(0)||this.wfg(b).then(l=>{if(0>=l.length)return null;this.HJe(l).then(()=>{const x={};x.target=
a;yj.UISurfaces.EBa().then(F=>{appChrome.api.dispatch(F.showFloatie(x,c,void 0,this.$Zd(),f));this.U$=!0;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.processAction(G.a.gVj,2);return null})});return null})}showContextMenu(a,b,c=null,f=null){this.VRe(1)||this.Fph(a,b,c,f)}Fph(a,b,c=null,f=null){this.HJe(null).then(()=>{const l={};l.target=a;f&&(l.directionalHint=f);yj.UISurfaces.EBa().then(x=>
{appChrome.api.dispatch(x.showContextMenu(l,b,c,void 0,this.$Zd()));return null})})}uwa(a,b,c){this.VRe(2)||this.wfg(b).then(f=>{0>=f.length?this.Fph(a,c,null):this.HJe(f).then(()=>{const l={};l.target=a;const x={};x.target=a;yj.UISurfaces.EBa().then(F=>{appChrome.api.dispatch(F.showContextualUI(l,x,c,void 0,null,this.$Zd()));this.U$=!0;return null})});return null})}zce(a){Z.ULS.sendTraceTag(561394519,340,15,a)}yRd(){this.ag&&yj.UISurfaces.isLoaded()&&yj.UISurfaces.EBa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());
return null})}LM(){this.ag&&yj.UISurfaces.isLoaded()&&yj.UISurfaces.EBa().then(a=>{this.U$=!1;appChrome.api.dispatch(a.hideFloatie());return null})}zXb(){this.ag&&yj.UISurfaces.isLoaded()&&yj.UISurfaces.EBa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.U$=!1;return null})}initializeContextualUI(a){return yj.UISurfaces.EBa().then(b=>{this.Vsd||(b.initializeContextualUI(a),this.Vsd=!0);return null})}HJe(a){if(!this.Vsd)return this.initializeContextualUI(this.n_b()).then(()=>{this.setActiveFloatieGroups(a);
return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var b=[];b.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(b);var c=[];yj.UISurfaces.EBa().then(f=>{c.push.apply(c,this.XSh.cEb.KNc(f.selectors.getFloatieOnlyControlsMap(),9));0<c.length&&appChrome.api.dispatch(c);return null})}}n_b(){if(this.kKa)return this.kKa;this.kKa=uA("div");this.kKa.id="ReactContextualUIDiv";this.kKa.style.position="absolute";this.kKa.style.zIndex=
"1001";document.body.insertBefore(this.kKa,document.body.firstChild);return this.kKa}Fik(a){a.lc&&a.lc.target&&"input"===a.lc.target.tagName.toLowerCase()&&v.FocusManager.instance().qC("ribbon");return!1}$Zd(){return this.t5?this.t5.contentType:"Unknown"}}Object(e.a)(lF,"ReactContextualUILauncher",null,[1200]);var ej=d(132);class vA{constructor(a){this.jQb=a}create(a,b){const c=new Sys.StringBuilder;this.AWb(c,a,b);this.OOd(c,a);return c.toString()}au(a,b){const c=[];this.sPd(c,a,b);this.POd(c,a);
return c}AWb(a,b,c){switch(b.errorType){case 0:a.append(this.jQb.build());break;case 1:case 2:a.append(this.SJd(b,c))}}sPd(a,b,c){switch(b.errorType){case 0:a.push(this.jQb.LIf());break;case 1:case 2:a.push(this.Adi(b,c))}}OOd(a,b){H.a.instance.ga(92)||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(ej.a("btnIgrnoreSpellingError",(2===b.errorType?C.a.hld:C.a.Kra).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),a.append("</Controls></MenuSection>"))}POd(a,
b){if(!H.a.instance.ga(92)){var c=Object.assign(new Si.a,{ControlList:[]});b=2===b.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:b}));a.push(c)}}SJd(a,b){a=this.vWi(a.suggestions,b);return 0<a.length?ej.e("msUnknownWord",ej.c(null,a),"Menu16"):ej.e("msUnknownWord",ej.c(null,[ej.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}vWi(a,b){const c=[];if(a){const f=Math.min(b.length,a.length);for(let l=
0;l<f;++l)a[l]&&c.push(ej.a("btnCorrectWord"+l,b[l].toString(),a[l]))}return c}Adi(a,b){const c=Object.assign(new Si.a,{Id:"Suggestions",ControlList:[]});this.uWi(a.suggestions,b,c.ControlList);0>=c.ControlList.length&&(a=Object.assign(new Of.a,{ExternalId:"NoSuggestions"}),Array.add(c.ControlList,a));return c}uWi(a,b,c){if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l){if(!a[l])continue;const x=Object.assign(new Of.a,{ExternalId:"btnCorrectWord"+l,Command:b[l].toString(),LabelText:a[l]});
Array.add(c,x)}}}}Object(e.a)(vA,"DefaultProofingContextMenuCreator",null,[]);class wA{constructor(a,b){this.gZe=a;this.x0e=b;this.rMa=[C.a.Rwa,C.a.Swa,C.a.Twa,C.a.SIa,C.a.TIa]}create(a,b){return b?Object(Fa.a)(Hp.a,b)?this.x0e.create(a,b,this.rMa):this.gZe.create(b,this.rMa):""}vWb(a,b){return b?Object(Fa.a)(Hp.a,b)?this.x0e.au(a,b,this.rMa):this.gZe.au(b,this.rMa):null}}Object(e.a)(wA,"ProofingContextMenuSectionFactory",null,[1273]);class mF{build(){const a=[ej.a("btnDeleteRepeatedWord","2023591105",
Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return ej.e("msRepeatedWord",ej.c(null,a),"Menu16")}LIf(){const a=Object.assign(new Si.a,{ControlList:[]}),b=Object.assign(new Of.a,{ExternalId:"DeleteRepeatedWord"});Array.add(a.ControlList,b);return a}}Object(e.a)(mF,"ProofingRepeatedWordSectionBuilder",null,[1274]);var xA=d(1078);class Xu{constructor(a,b){this.q_a=a;this.Wm=b}get isVisible(){return this.q_a.yub}get controls(){return null}LM(){this.q_a.LM();return!0}Rph(a,b){this.q_a.showFloatie(Object.assign(new xA.a,
{x:a.x,y:a.y}),this.iKc(b),b,null)}sqa(){return this.LM()}iKc(){return[]}}Object(e.a)(Xu,"ReactFloatie",null,[398,399]);class nF{constructor(a){this.fqc=null;this.q_a=a}dispose(){}sqa(){this.q_a.zXb();return!0}showContextMenu(a,b){this.P4(a,b.clientPoint,b.Vf)}P4(a,b,c){this.Zgd(a,new Sys.UI.Bounds(b.x,b.y,0,0),c);Z.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}Zgd(a,b,c,f=null){this.fqc?this.q_a.uwa(Object.assign(new xA.a,{x:b.x,y:b.y}),this.fqc.iKc(c),c):this.q_a.showContextMenu(Object.assign(new xA.a,
{x:b.x,y:b.y}),c,void 0,f);this.fqc=null}$gd(a,b,c,f){this.fqc=Object(va.a)(Xu,c);f.b$(a,b);return!0}}Object(e.a)(nF,"ReactContextMenuController",null,[1201,106]);var yr=d(429);class my{static get jg(){return Vh.a.EB(my.Zn,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,
Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}my.Zn="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>";
Object(e.a)(my,"AutoCorrectOptionsDialogHTML",null,[]);class ny{static get jg(){return Vh.a.EB(ny.Zn,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}ny.Zn="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>";
Object(e.a)(ny,"AutoCorrectOptionsDialogHTML2",null,[]);class oF extends Vh.a{constructor(a,b){super();this.ZQ=a;this.k1=b;this.kg="AutoCorrectOptionsDialog"}zkc(){Z.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.jg=this.k1?ny.jg:my.jg;const a={};a.ReplaceTextAsYouType=this.ZQ.ueb;a.CapitalizeFirstLetterOfSentences=this.ZQ.nCc;a.ReplaceOrdianalsWithSuperscript=this.ZQ.Scd;a.ReplaceHyphensWithDash=this.ZQ.$hc;a.ReplaceFractionsWithFractionCharacter=this.ZQ.Qcd;this.k1&&
(a.ReplaceQuoteWithSmartQuote=this.ZQ.pEe);this.pj(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(D.a)(this,this.y0k,"setAutoCorrectOptionsHandler"),a)}y0k(a,b){H.a.instance.ga(70)&&(1!==a?Z.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):b.ReplaceTextAsYouType!==this.ZQ.ueb||b.CapitalizeFirstLetterOfSentences!==this.ZQ.nCc||b.ReplaceOrdianalsWithSuperscript!==this.ZQ.Scd||b.ReplaceHyphensWithDash!==this.ZQ.$hc||b.ReplaceFractionsWithFractionCharacter!==
this.ZQ.Qcd||this.k1&&b.ReplaceQuoteWithSmartQuote!==this.ZQ.pEe?(a={},a.ReplaceTextAsYouType=b.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=b.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=b.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=b.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=b.ReplaceFractionsWithFractionCharacter,this.k1&&(a.ReplaceQuoteWithSmartQuote=b.ReplaceQuoteWithSmartQuote),this.ZQ.lXk(a),Z.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:b.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:b.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:b.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:b.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:b.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.k1,["ReplaceQuoteWithSmartQuote"]:this.k1&&b.ReplaceQuoteWithSmartQuote}),
Gb.App.Fb.updateCommandUI(!0)):Z.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(e.a)(oF,"AutoCorrectOptionsDialog",Vh.a,[1203]);class oy{static get jg(){return Vh.a.EB(oy.Zn,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}oy.Zn="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(e.a)(oy,"AltTextDialogWithDescriptionHtml",null,[]);class mq extends Vh.a{constructor(a=!1){super(!1,!1,a);this.jg=oy.jg;this.kg=a?"AltTextDialog":"BaseAltTextDialogWithDescription"}pvi(a){this.pj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(D.a)(this,this.kHd,"altTextDialogHandler"),this.iLc(a));a=document.getElementById(mq.mHd);a.focus();a.select()}qvi(a){a={["id"]:"AltTextDialog",["bodyControls"]:this.iLc(a)};this.pj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(D.a)(this,this.kHd,
"altTextDialogHandler"),a)}iLc(a){const b={};b[mq.mHd]=this.getAltText(a);b[mq.jHd]=this.D8f(a)||"";return b}KM(a){return a.Fc.id===mq.jHd?!1:super.KM(a)}}mq.mHd="titleText";mq.jHd="descriptionText";Object(e.a)(mq,"BaseAltTextDialogWithDescription",Vh.a,[]);class zt extends mq{constructor(a,b=!1){super(b);this.kg=zt.mtj;b&&u.AFrameworkApplication.fa.ka("ReactAltTextDialogIsEnabled")?this.qvi(a):this.pvi(a)}}zt.mtj="AAltTextDialogWithDescription";Object(e.a)(zt,"AAltTextDialogWithDescription",mq,[]);
class pF extends zt{constructor(a,b,c,f,l){super(a);this.bmb=this.mLb=null;this.PC=b;this.rfa=c;this.jk=f;this.Wc=l}D8f(a){this.mLb=a.node;this.bmb=xd.TableReader.oeg(a);return xd.TableReader.k1d(this.bmb)}getAltText(a){this.mLb=a.node;this.bmb=xd.TableReader.oeg(a);return xd.TableReader.l1d(this.bmb)}kHd(a){if(1===a){xd.TableReader.l1d(this.bmb);xd.TableReader.k1d(this.bmb);this.hide();a=this.jk.je(15);try{a.fd(this.mLb)}finally{a&&a.dispose()}}H.a.instance.ga(50)&&this.rfa.Qv&&this.rfa.UX.epa(this.mLb)}}
Object(e.a)(pF,"TableAltTextDialog",zt,[]);class yA{constructor(a,b,c){this.PC=a;this.jk=b;this.Wc=c}create(a){return new pF(a,this.PC,Gb.App.Eh,this.jk,this.Wc)}}Object(e.a)(yA,"TableAltTextDialogFactory",null,[]);const TO=()=>{Gb.App.N7h=!0;return 32},UO=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Uu:b}=qF(l)).returnValue)return 16;Gb.App.Fb.uwa(a,b);return 32},VO=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Uu:b}=qF(l)).returnValue)return 16;Gb.App.Fb.Q4(a,b);return 32},qF=a=>{let b,c;b=null;
c=0;if(!a)return{returnValue:!1,point:b,Uu:c};a=a.split(",");if(3>a.length)return{returnValue:!1,point:b,Uu:c};b=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));c=parseInt(a[2]);return{returnValue:!0,point:b,Uu:c}};var WO=d(1079);class rF extends Sys.EventArgs{constructor(a,b,c,f,l,x=0,F=0,R=null){super();this.controlId=a;this.commandId=f;this.time=l;this.commandSurface=x;this.Uu=F;this.contentType=R}}Object(e.a)(rF,"CommandClickEventArgs",Sys.EventArgs,[]);class sF{constructor(a,b){this.S$=a.q0i();
this.sLb=a;this.QJa=b}A0f(a,b,c,f=null,l=null){c&&(this.QJa.gq=c.CommandLocation,this.QJa.vS=c.InvocationMethod,this.QJa.Tpa=c.CommandTabName);let x=this.sLb.f9f(parseInt(a),b,c);x.qF&&(x=this.sLb.f9f(x.Jm,b,c));if(void 0!==x.hK&&null!==x.hK)return x.hK;if(x.O3d)l=32;else{var F=null;this.S$&&this.S$.eze&&(F=this.S$.eze(x,l));x.TV||x.g$d?x.Jq?l=16:(l=this.QJa.Ka(x.Jm,x.f$d?2:1,x.ld,l),2===l&&(l=32)):x.Jq?l=this.QJa.R$c(null,x.Jm,x.ld,R=>{f&&f(R.response)},l):(l=this.QJa.Ka(x.Jm,2,x.ld,l),f&&f(l));
this.S$&&this.S$.Fye&&this.S$.Fye(x,l,F);if(b&&c&&-1!==c.InvocationMethod&&0!==c.InvocationMethod){c=b.LegacyId;if(void 0===c||null===c)c="";F=b.ParentMenuId;void 0!==F&&null!==F||!b.MenuId||(F=b.MenuId);let R=b.SqmControlId;void 0!==R&&null!==R||!b.SourceControlId||(R=b.SourceControlId);(void 0!==R&&null!==R||void 0!==F&&null!==F)&&WO.a.jEk(new rF(R,c,F,a,Date.now()))}}x.TV&&32===l&&this.S$&&this.S$.sTb&&this.S$.sTb(x,b);x.g$d&&32===l&&this.S$&&this.S$.YHd&&this.S$.YHd(x,b);return 32===l||1===l}z4b(a,
b=null){if(u.AFrameworkApplication.Xg||Nm.a.instance.Rv)return!1;const c=parseInt(a);b&&b.UILocation&&(this.QJa.gq=b.UILocation);if(!a||c===ce.ActionManager.jYb)return!0;a=this.sLb.wLc(c,b);a.qF&&(a=this.sLb.wLc(a.Jm,b));if(void 0!==a.hK&&null!==a.hK)return a.hK;c===G.a.I2a&&b&&(a.ld=b);return 32===this.QJa.Ka(a.Jm,1,a.ld)}clearCache(){this.sLb.clearCache()}}Object(e.a)(sF,"GeneralCuiUser",null,[1202,1272]);class tF{constructor(a,b,c,f){this.Rwf=a;this.uga=b;this.Uoc=c;this.y0a=f}Tcg(){let a;a=this.y0a.j$i(this.Rwf);
return{returnValue:this.y0a.cMc(this.Rwf),D7g:a}}amh(a,b){if(this.uga){var c=new E.DictionaryPropertySet;this.Uoc.execute(f=>{f.tYb(a)});c.setValue(bb.a.Gs,a);c.setValue(H.a.instance.ga(20)?Bb.a.noProof:be.a.Lua,b);b=new We.GraphTransaction(15);b.set(Gb.App.sO.gU);this.uga.UT(c);b.dispose()}}}Object(e.a)(tF,"LanguageEditor",null,[1112]);var Hi=d(213);class Uq{constructor(a=!1,b=0){this.cod=null;this.Pvd=Uq.Hdg(sa.a.s0i());this.Atc=new Tu.a;this.yoa=[];this.jlb=new oa.a;this.Lqf=a;this.Mqf=0>=b?7:
b;this.Kqf=this.Zzd=0;this.Q3e=!1;a&&(this.$xj(),u.AFrameworkApplication.Iea(()=>{this.lXj()}))}get languages(){return this.Pvd}$xj(){for(var a of this.Pvd)this.Atc.$(a.LCID,a);a=[];try{var b=Hi.a.get("RecentlyUsedLcids");if(b&&""!==b){const f=decodeURIComponent(b).split(",").slice(0,this.Mqf);for(const l of f){let x;({value:x}=this.Atc.Of(parseInt(l))).returnValue&&a.push(x)}}}catch(f){Z.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",
f.message),Array.clear(a)}if(a.length)for(var c of a)b=c.LCID,this.jlb.contains(b)||(this.yoa.push(c),this.jlb.add(b));else c=u.AFrameworkApplication.lcid,({value:b}=this.Atc.Of(c)).returnValue&&(this.yoa.push(b),this.jlb.add(c));this.Uhh()}Uhh(){const a=cb.toArray(cb.select(cb.asEnumerable(this.yoa),b=>b.LCID)).join(",");Hi.a.JL("RecentlyUsedLcids",a,180)}swk(a,b){if(a&&!(0<a.options.length)){var c=-1,f=Uq.Hdg(this.yoa);this.Lqf&&0<f.length&&(c=Uq.GIf(f),c=Uq.iBf(a,c,b),a.add(Uq.Fdi(),null));this.cod||
(this.cod=Uq.GIf(this.Pvd));b=Uq.iBf(a,this.cod,b);-1===c&&(c=b);a.selectedIndex=c}}P2k(a,b){if(this.Lqf&&({value:c}=this.Atc.Of(a)).returnValue){b=a!==b;if(this.jlb.contains(a))a=Array.indexOf(this.yoa,c),0<=a&&(Array.removeAt(this.yoa,a),this.yoa.push(c)),b&&this.Zzd++;else{this.jlb.add(a);this.yoa.push(c);if(this.yoa.length>this.Mqf){var c=this.yoa.shift();this.jlb.remove(c.LCID)}b&&this.Kqf++}this.Uhh()}}lXj(){const a=this.Zzd+this.Kqf;!this.Q3e&&0<a&&(Z.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.Zzd/a),this.Q3e=!0)}static GIf(a){return cb.toArray(cb.select(cb.asEnumerable(a),b=>{const c=document.createElement("OPTION");let f=b.displayName;c.value=b.LCID.toString();c.text=f;return c}))}static Fdi(){const a=document.createElement("OPTION");a.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";
a.value="-1";a.disabled=!0;return a}static iBf(a,b,c){c=c.toString();let f=-1;for(const l of b)a.add(l,null),l.value===c&&(f=a.options.length-1);return f}static Hdg(a){a=Array.clone(a);a.sort((b,c)=>b.displayName.localeCompare(c.displayName));return a}}Object(e.a)(Uq,"LanguageListHelper",null,[1270]);var Ow=d(249);class At extends Ow.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(e.a)(At,"NumberButtonProps",Ow.a,[]);class zr{static get rfl(){return zr.kvf||(zr.kvf=
hb.a.instance.pb("Box4.ISpacingCommands"))}static get Koh(){return!!zr.rfl}static ub(){const a=u.AFrameworkApplication.Ta;a.xa(C.a.$Ga,Fb.a.view,zr.$Ga);a.$d(C.a.$Ga,1126)}static $Ga(a,b,c,f,l){if(1===c||!zr.Koh)return zr.Koh?32:8;if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp)a=[],a.push(Object.assign(new At,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),a.push(Object.assign(new At,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),a.push(Object.assign(new At,{ExternalId:"LineSpacing1_50",
Number:1.5,Type:0})),a.push(Object.assign(new At,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),a.push(Object.assign(new At,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),a.push(Object.assign(new At,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),l.MenuItems=ej.d(a);else{a=ej.g("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0);b=ej.g("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0);c=ej.g("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0);f=ej.g("buttonLineSpacing2_00",
"2.00","2759860553","4080183461",2,0);const x=ej.g("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),F=ej.g("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),R=ej.a("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions);a=ej.c("LineSpacing.Menu.Controls",[a,b,c,f,x,F,R]);a=ej.e("msLineSpacing",a,"Menu");a=ej.f([a]);l.PopulationXML=a}return 32}}zr.kvf=null;Object(e.a)(zr,"LineSpacingRibbonMenu",null,[]);var XO=d(1077),YO=d(907);const ZO=(a,b,c)=>{if(1===
c)return 32;a=Gb.App.Fb.notificationBar.sAa("Automation test",!1);a.image=3;Gb.App.Fb.notificationBar.Rh(a);return 32},aP=(a,b,c,f,l)=>{let x;if(!({TCh:x}=$O(l)).returnValue)return 16;yj.UISurfaces.VM().then(F=>{let R=null;var fa=Object.assign(new XO.a,{label:"OK",onExecute:()=>{R&&F.removeNotification(R)}});fa=Object.assign(new YO.a,{target:"#"+I.AppFrame.ogh,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:fa,useTeachingStyles:x});fa=F.callout(fa);R=F.addNotification(fa);
return null},F=>{Z.ULS.sendTraceTag(541172639,383,15,"Failed to GetNotificationsAPIAsync: {0}",F);return null});return 32},$O=a=>{let b;b=!1;if(!a)return{returnValue:!1,TCh:b};b=Boolean.parse(a);return{returnValue:!0,TCh:b}};class zA{constructor(a){this.lH=a}jJb(a){this.lH&&this.lH.HF(a)}}Object(e.a)(zA,"RibbonButtonUpdater",null,[1269]);var uF=d(290);class AA{constructor(){this.F5=this.Da=null}get name(){return"Box4.UI"}Wb(a){this.Da=a;a.register(1200,"Common.IReactContextualUILauncher").ma().na(()=>
new lF(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping")));a.register(1201,"Box4.IContextMenuController").ma().na(()=>new nF(a.resolve("Common.IReactContextualUILauncher")));a.register(1202,"Box4.IGeneralCuiUser").na(()=>new sF(a.resolve("Box4.UI.CuiActionBridge"),u.AFrameworkApplication.Ta)).ma();a.register(yA,"Box4.UI.TableAltTextDialogFactory").ma().na(()=>new yA(a.resolve("Box4.ITableEditor"),new uF.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(1112,"Box4.UI.ILanguageEditor").na(()=>new tF(ld.a.instance.Dj,a.pb("Box4.ITextFormattingCommands"),a.La("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.register(1203,"Box4.UI.IAutoCorrectOptionsDialog").na(()=>new oF(a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(Uq,"Box4.UI.LanguageListHelper").as("Box4.UI.ILanguageListHelper").ma().na(()=>new Uq(u.AFrameworkApplication.fa.ka("RecentlyUsedLanguagesListIsEnabled")));
a.register(mF,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ma();a.register(vA,"Box4.UI.DefaultProofingContextMenuCreator").ma().na(()=>new vA(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder")));a.register(wA,"Box4.UI.ProofingContextMenuSectionFactory").as("Box4.UI.IProofingContextMenuSectionFactory").ma().na(()=>new wA(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator")));a.register(zA,
"Box4.RibbonButtonUpdater").as("Common.IRibbonButtonUpdater").ma().na(()=>new zA(this.Da.resolve("Box4.IAppFrame")))}init(){var a=Gb.App.Fb;const b=a.gb;xr.pwj(Object(D.a)(b,b.Kcc,"onAuthenticationLost"),Object(D.a)(b,b.Lcc,"onAuthenticationRestored"),a.Lii);yr.a.ub();a=u.AFrameworkApplication.Ta;a.xa(C.a.Rzk,Fb.a.application,TO);a.pa(C.a.Xal,Fb.a.application,UO,96);a.pa(C.a.xbl,Fb.a.application,VO,96);a=u.AFrameworkApplication.Ta;a.pa(C.a.kdl,Fb.a.application,ZO,96);a.pa(C.a.Nal,Fb.a.application,
aP,96);zr.ub();this.F5=this.Da.pb("Box4.IContextMenuController")}dispose(){this.F5&&(this.F5.dispose(),this.F5=null)}static main(){m.a.instance.Ac(new AA,6)}}Object(e.a)(AA,"Box4UIPackage",null,[2,3]);var vF=d(450),bP=d(859),rs=d(198),cP=d(533),Yu=d(366),kn=d(306),Ui=d(70);class wF{constructor(a){this.pla=a}}Object(e.a)(wF,"ValidParentData",null,[]);var py=d(361),dP=d(793),Zu=d(287),xF=d(792),$u=d(593),zm=d(239),yF=d(348),nq=d(219);class zF{constructor(){this.Rpb=0}}Object(e.a)(zF,"BelowOutlineElementData",
null,[]);var ss=d(406),eP=d(581),fP=d(470);class AF extends ss.a{constructor(a,b,c,f){super(4,f);this.ZJh=a;this.ond=b;this.Kod=c}get bGc(){return this.ZJh}get jSb(){return this.ond}get nJd(){return this.Kod}Psb(){var a=this.bGc;if(!a)return Z.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const b=[],c=new eP.a(this.bGc.id,this.bGc.Pn,this.jSb?this.jSb.id:null);""!==a.characterData&&a.characterData&&(a=new fP.DeleteTextUpdateHint(this.bGc.id,
0,a.characterData),Array.add(b,a));Array.add(b,c);return b}}Object(e.a)(AF,"DeleteParagraphOperation",ss.a,[]);var gP=d(580),hP=d(469);class BA extends ss.a{constructor(a,b,c,f,l){super(3,l);this.dyd=a;this.eyd=b;this.cPb=f}get wGa(){return this.dyd}get SBb(){return this.eyd}get nGa(){return this.cPb}Psb(){const a=[];var b=new gP.AddParagraphUpdateHint(this.nGa.id,this.nGa.Pn,this.wGa?this.wGa.id:null);Array.add(a,b);""!==this.nGa.characterData&&this.nGa.characterData&&(b=new hP.a(this.nGa.id,0,this.nGa.characterData),
Array.add(a,b));return a}}Object(e.a)(BA,"InsertNewParagraphOperation",ss.a,[]);var iP=d(579);class BF extends ss.a{constructor(a,b,c,f){super(2,f);this.dyd=a;this.eyd=b;this.oQh=c}get wGa(){return this.dyd}get SBb(){return this.eyd}get NSg(){return this.oQh}Psb(){const a=[],b=new iP.MergeParagraphUpdateHint(this.wGa.id,this.wGa.Pn,this.wGa.characterData.length,this.SBb.id,this.SBb.Pn,this.NSg.id,this.NSg.Pn);Array.add(a,b);return a}}Object(e.a)(BF,"MergeParagraphOperation",ss.a,[]);var jP=d(578);
class CF extends ss.a{constructor(a,b,c,f,l){super(1,l);this.gyd=a;this.DVh=b;this.ond=c;this.Kod=f}get xGa(){return this.gyd}get jSb(){return this.ond}get nJd(){return this.Kod}get Qfl(){return this.DVh}Psb(){const a=[],b=new jP.a(this.xGa.id,this.xGa.Pn,this.Qfl,this.jSb.id,this.jSb.Pn,this.nJd.id,this.nJd.Pn);Array.add(a,b);return a}}Object(e.a)(CF,"SplitParagraphOperation",ss.a,[]);var DF=d(309);class Pj{constructor(a,b,c,f,l,x=null){this.Lo=this.Wc=null;this.ox=a;this.Jo=b;this.Og=c;this.yJh=
f;this.lQh=l;this.Wna=x}DYh(a){H.a.instance.ga(50)&&Gb.App.Eh&&Gb.App.Eh.Qv&&Gb.App.Eh.UX.epa(a)}xfb(a,b,c){Yb.OutlineElementNavigator.oi(a);Ya.ParagraphReader.Lk(a)?Pj.paragraphEditor.Tu.xfb(a,b,c):xd.TableReader.Np(a)&&14===a.mi&&(b=(new Zu.a(1,c)).ZL,this.M5k(Object(va.a)(py.a,a.currentNode),b));Yb.OutlineElementNavigator.Je(a)}M5k(a,b){a&&Object(Fa.a)(py.a,a)&&(a.Il=b)}get Tu(){return Yu.a.osb}get Nf(){return this.Wc||(this.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get k5(){return this.Lo||
(this.Lo=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get ao(){return this.Jo.value}get Rf(){return this.Og.value}get WA(){return this.ox.value}get Wi(){return Qg.a.instance}$Od(){const a=cP.a.instance.createInstance(393229);a.setValue(bb.a.PD,kn.a.first);a.setValue(bb.a.KBi,new Date);a.xld();return a}Uyi(){const a=new bP.a;a.setValue(bb.a.PD,kn.a.first);return a}bfd(a,b,c){const f=a.Ch;if(f){f.id.equals(Pj.TWe)||(Pj.TWe=f.id,Pj.fpc={});var l=Pj.fpc[b];b in Pj.fpc&&
f.p7a(l.id)&&f.Dw&&f.Dw.zZ(l.id)||(l=new nq.a,l.setValue(bb.a.author,b),l=f.sHa(l));a.properties.setValue(c,l.id);Pj.fpc[b]=l}}cGb(a,b){a.properties.setValue(bb.a.lastModifiedTime,b)}mSe(a,b=null){const c=new We.GraphTransaction(7);c.fd(a);b||(b=new Date);this.cGb(a,b);this.bfd(a,this.NNc(),bb.a.HTb);""===Rd.OutlineElementReader.vKc(a,bb.a.VAc)&&this.bfd(a,this.NNc(),bb.a.VAc);c.dispose()}NNc(){return Gb.App.EPe.name}rSd(a,b,c=!1){if(H.a.instance.ga(56))Rd.OutlineElementReader.s$d(a)?(a=Rd.OutlineElementReader.isRtl(a),
c?this.Lfd(b,a):this.jIa(b,a)):this.rOk(b);else if(H.a.instance.ga(26)||H.a.instance.ga(89))a=Rd.OutlineElementReader.isRtl(a),c?this.Lfd(b,a):this.jIa(b,a)}yGb(a,b){var c=new mb.GraphIterator;c.set(a);c.mc(11);c=c.Ng(11);Rd.OutlineElementReader.Yl(c)!==b&&(this.jIa(c,b),H.a.instance.ga(54)?a.anchor.ir(4):(c=1,b&&(c=3),a.setValue(bb.a.pl,c),a.setValue(bb.a.rI,c)))}jIa(a,b){const c=new We.GraphTransaction(7);c.fd(a);this.Lfd(a,b);if(H.a.instance.ga(26)){var f=new mb.GraphIterator;f.set(a);f.zb(2)&&
Ya.ParagraphReader.Lk(f)&&(f=f.currentNode,b?(f.ke(kh.a.Jbd,!0),Pj.paragraphEditor.IL(f,3)):(f.removeProperty(kh.a.Jbd),Pj.paragraphEditor.IL(f,1)))}f=new mb.GraphIterator;f.set(a);DF.a.instance.uAj(f);if(f.mc(10)){const l=f.Ng(10);f.zb(1)===a&&this.WA.jIa(l,b)}c.dispose()}Lfd(a,b){let c=null,f=null;if(this.Nf.Zf&&a.isConnected){c=Ya.ParagraphReader.GMc(a,!0,!0);f=new Ha.a;for(let l=0;l<c.count;l++)12===c.ga(l).type&&f.add(c.ga(l).i7())}b?a.properties.setValue(bb.a.iX,!0):H.a.instance.ga(56)?a.properties.setValue(bb.a.iX,
!1):(H.a.instance.ga(26)||H.a.instance.ga(89))&&a.properties.removeProperty(bb.a.iX);if(this.Nf.Zf&&c&&f)if(c.count!==f.count)Z.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",c.count,f.count);else for(a=0;a<c.count;a++)c.ga(a),f.ga(a)}rOk(a){a.properties.removeProperty(bb.a.iX)}Vaa(a,b=null,c=!1){let f=null,l=null;if(!Rd.OutlineElementReader.Tg(a))return Z.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),
null;var x=null;let F=null,R=0;b&&(x=b.formatting,F=b.style,R=b.languageId);c||({wGa:f,SBb:l}=this.X5f(a));b=rs.a.instance.createInstance(393230);b.setValue(bb.a.Zp,"");a.hl(b,2);a.Ak(b);Pj.paragraphEditor.Hhc(b);Pj.paragraphEditor.Y$j(b);Pj.paragraphEditor.vJb(b);this.DYh(b);x&&(b.Ra.first.formatting.Sl=x);R||(R=u.AFrameworkApplication.lcid);a.currentNode.ke(bb.a.Leb,a.currentNode.sa(bb.a.Leb,R));H.a.instance.ga(54)&&a.currentNode.setValue(Bb.a.iec,0);!H.a.instance.ga(71)||H.a.instance.ga(61)||F||
(x=Tc.StyleReader.tK(b))&&(F=x.oG(Tc.StyleReader.Uma));this.yJh.KNi(a);F&&Pj.qO.Y9(F,b,!0);!c&&f&&(c=new BA(f,l,f,new $u.a(b),b.COa),a.currentNode.mG().graphTransactionOperations.CY(c));return b}X5f(a){let b;const c=new mb.GraphIterator;c.Nc(a);b=null;c.htg?c.currentNode.mG().graphTransactionOperations.Uga(6):(Yb.OutlineElementNavigator.Iua(c,!0,!1),b=this.ILc(c));c.Nc(a);a=this.H6f(c);return{wGa:b,SBb:a}}H6f(a){const b=new mb.GraphIterator;b.Nc(a);a=null;b.Gub||(Yb.OutlineElementNavigator.OI(b,!0,
!1),a=this.ILc(b));return a}ILc(a,b=!1){a=Yb.OutlineElementNavigator.oi(a,!0);return a?this.X9f(a,b):(Z.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}X9f(a,b=!1){if(12===a.type)return b?new $u.a(a):new xF.a(a);a.mG().graphTransactionOperations.Uga(5);return new dP.a(a)}Gni(a,b){var c=b.currentNode.clone();a.xK(c,null,1);a.Ak(c);c.SY=b.currentNode;Yb.OutlineElementNavigator.oi(b);b.FV&1&&b.currentNode.CZa(null);c=b.currentNode.clone();c.aU=b.currentNode.aU;a.xK(c,
null,2);a.Ak(c);a.uS(1);c.SY=b.currentNode;H.a.instance.ga(55)&&c.setValue(Bb.a.Pn,Md.a.PWa());b.oC(11)}Hhc(a){a.zb(2)&&a.Ii()}keh(a,b){const c=a.currentNode;Yb.OutlineElementNavigator.oi(a);const f=a.currentNode;Yb.OutlineElementNavigator.Je(a);b.uA(1);Yb.OutlineElementNavigator.oi(b);a.hl(b.currentNode,2);b.Ii();var l=new mb.GraphIterator;l.Nc(b);if(l.zb(1)){const x=new mb.GraphIterator;x.Nc(a);const F=new wF(null);if(!this.Ugj(x,l.currentNode,F))return;zm.h(x,null,1,1,l,-1)}b.Ii();l=null;a.WE(1)&&
(l=a.currentNode);for(a.uc();yh.OutlineNavigator.v9(b);)a.xK(b.currentNode,l,1),l=b.currentNode,b.Ii();a.Ak(c);a.Ak(f);a.Ii()}uHb(a,b,c,f,l,x=!1){this.Hhc(b);const F=b.mi;var R=a.currentNode;let fa=null;var wa=null;let Xa=null,lb=!1;Yb.OutlineElementNavigator.oi(a);const Lb=a.mi;if(Ya.ParagraphReader.Lk(a)){var kc=a.currentNode;(wa=Object(va.a)(te.AParagraphNode,kc))?wa.Ra&&wa.Ra.length||Z.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",wa):Z.ULS.sendTraceTag(38925731,
307,15,"srcParaNode is null");wa=new $u.a(wa);(lb=c.Qa===Ya.ParagraphReader.textLength(kc))&&(Xa=this.H6f(b));var lc=b.currentNode;fa=this.Vaa(b,void 0,!0);Pj.paragraphEditor.VMe(a,b,c,l,!0,x);H.a.instance.ga(71)&&(f?(l=Tc.StyleReader.kD(kc))&&Pj.qO.Y9(l,fa,!0):lb&&(l=Tc.StyleReader.kD(kc))&&((kc=l.sa(kh.a.GUg,null))?(l=Tc.StyleReader.tK(fa).oG(kc),Pj.qO.Y9(l,fa,!1)):Pj.qO.Y9(l,fa,!0)));this.rSd(R,lc);this.ao.qSd(R,lc)}Yb.OutlineElementNavigator.Je(a);Yb.OutlineElementNavigator.Je(b);R=Rd.OutlineElementReader.isEmpty(a,
!0);lc=Rd.OutlineElementReader.isEmpty(b,!0);H.a.instance.ga(27)&&R&&!lc&&(b.FV&1&&(R=new yF.a,R.Nc(b),b.currentNode.CZa(R)),this.bfd(b.currentNode,Rd.OutlineElementReader.vKc(a.currentNode,bb.a.HTb),bb.a.HTb),this.bfd(b.currentNode,Rd.OutlineElementReader.vKc(a.currentNode,bb.a.VAc),bb.a.VAc),this.cGb(b.currentNode,Rd.OutlineElementReader.F5i(a.currentNode)));Yb.OutlineElementNavigator.oi(a);(R=Object(va.a)(te.AParagraphNode,a.currentNode))?R.Ra&&R.Ra.length||Z.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",
R):Z.ULS.sendTraceTag(38925761,307,15,"srcPara is null");R=new $u.a(R);Yb.OutlineElementNavigator.Je(a);(a=fa)?a.Ra&&a.Ra.length||Z.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",a):(Z.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),Z.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:lb,["moveText"]:!0,["overrideParagraphStyle"]:f,["sourceOutlineElementContentNodeType"]:Lb,["destinationOutlineElementNodeType"]:F,
["alwaysMoveEopToDestinationPara"]:x}));lb?(c=new BA(wa,Xa,R,new $u.a(a),a.COa),b.currentNode.mG().graphTransactionOperations.CY(c)):(c=new CF(wa,c.Qa,R,new $u.a(a),a.COa),b.currentNode.mG().graphTransactionOperations.CY(c))}TKf(a,b){Yb.OutlineElementNavigator.oi(a);let c=Ya.ParagraphReader.Mr(a.currentNode);const f=a.currentNode;H.a.instance.ga(14)&&(c=b?c&&!this.Wi.isk(f):c&&!this.Wi.csk(f));Yb.OutlineElementNavigator.Je(a);return c}merge(a,b,c,f,l=null,x=!1,F=!1,R=!1){if(a.currentNode.id===b.currentNode.id)return!1;
let fa,wa;var Xa=new mb.GraphIterator;Xa.Nc(b);fa=this.ILc(Xa);Xa.Nc(a);wa=this.ILc(Xa,!0);if(!this.TKf(b,!0)||!this.TKf(a,!1))return!1;if(this.Rf.Ufc){var lb=Object(va.a)(te.AParagraphNode,a.currentNode);lb=(c||!lb||!lb.characterData.length)&&!Ib.ListReader.ak(a)}else lb=this.lQh.Exl(c,a);R||this.ao.merge(a,b,lb,l);Yb.OutlineElementNavigator.oi(a);l=a.currentNode.COa;Yb.OutlineElementNavigator.oi(b);if(Ya.ParagraphReader.Lk(b)){if(H.a.instance.ga(50)&&Gb.App.Eh.Qv){R=b.currentNode;lb=a.currentNode;
const Lb=vF.CoauthLockEditor.getInstance();if(Lb.UGb(this.Wi.j_b(R))||Lb.UGb(this.Wi.j_b(lb)))return b.uc(),a.uc(),!1}R=!1;Ib.ListReader.Lw&&(lb=a.parentNode)&&Rd.OutlineElementReader.O7(lb)&&(R=Ib.ListReader.LRa(lb));H.a.instance.ga(71)&&(lb=(lb=Ya.ParagraphReader.isEmpty(a)||c)&&!R)&&(lb=Tc.StyleReader.Ydg(b))&&Pj.qO.Y9(lb,a.currentNode,!0);c&&this.Wna.tck(b.currentNode,a.currentNode,R,F);c=Pj.paragraphEditor.merge(a,b,c,f,x);f=Xa.currentNode;Xa=a.currentNode;a.uc();c&&Rd.OutlineElementReader.isEmpty(b,
!0)&&this.LAa(b);a=new BF(wa,fa,new xF.a(f),l);Xa.mG().graphTransactionOperations.CY(a);return!0}b.uc();a.uc();return!1}vzj(a){const b=new mb.GraphIterator;b.set(a.node);b.Ze();Yb.OutlineElementNavigator.Je(b);const c=this.L2b(b),f=this.L2b(b);this.uHb(b,c,a,!1,!0);Rd.OutlineElementReader.isEmpty(b,!1)&&(this.ao.ema(b),b.Ii());Rd.OutlineElementReader.isEmpty(c,!1)&&!Rd.OutlineElementReader.v8a(c)&&(this.ao.ema(c),c.Ii());return f}Tba(a,b,c,f=null,l=!1){if(!this.Cii(a))return null;const x=a.currentNode,
F=Ib.ListReader.ak(a);b||l||Rd.OutlineElementReader.isEmpty(a,!1);l=this.ao.Y$k(F);b=b?a.WE(1):a.currentNode;a.uc();c=this.WA.K2b(a,b,c,f);if(!c)return null;this.rSd(x,c);this.ao.qSd(x,c);l&&this.ao.Mnl(a,x);return c}Cii(a){return Rd.OutlineElementReader.Tg(a)&&(a=a.parentNode,Ui.OutlineReader.g4b(a)||Rd.OutlineElementReader.O7(a)||Rd.OutlineElementReader.ksa(a))?!0:!1}nNk(a){const b=new mb.GraphIterator;b.set(a);b.Ze();b.oC(11);let c,f;({wGa:c,SBb:f}=this.X5f(b));let l=-1;12===a.type&&(l=a.COa);
b.currentNode.mG().graphTransactionOperations.CY(new AF(this.X9f(a,!0),c,f,l));this.LAa(b)}LAa(a){if(a.bI(1)){const b=new zF,c=new mb.GraphIterator;c.Nc(a);this.qYi(c,b)&&this.Tu.gGc(a,-b.Rpb)}a.Ii();xd.TableReader.Sr(a)&&this.axk(a)}m6d(a,b,c){if(!Ui.OutlineReader.At(a)&&!Rd.OutlineElementReader.Tg(a))return null;const f=this.Uyi();0<c&&c<kn.a.last&&f.setValue(bb.a.PD,Math.min(kn.a.nil,c));a.xK(f,b,1);return f}xzj(a,b){if(!Rd.OutlineElementReader.Tg(a)&&!Rd.OutlineElementReader.iI(a)||!Ui.OutlineReader.RV(a.parentNode)&&
!Rd.OutlineElementReader.O7(a.parentNode))return null;const c=a.currentNode;let f;f=a.currentNode;a.uc();b=this.m6d(a,f,b);a.Ak(c);return b}axk(a){Rd.OutlineElementReader.iI(a)&&(a.bI(1)||a.Ii());this.P3f(a,!1);this.DDf(a)}P3f(a,b){var c,f=null;for(c=a.zb(1);c;){var l=!1;Rd.OutlineElementReader.ksa(c)&&!a.bI(1)&&(l=!0);var x=c;c=a.wj(1);if(l)l=new mb.GraphIterator,l.set(x),l.Ze(),l.Ii();else if(Rd.OutlineElementReader.ksa(x)){if(f){l=new mb.GraphIterator;l.set(f);var F=new mb.GraphIterator;F.set(x);
F.Ze();l.hl(F.currentNode,1);F.Ii();F=Rd.OutlineElementReader.m2(x);F===kn.a.nil&&(F=1);(F=Math.max(0,Rd.OutlineElementReader.m2(x)-F))?x.setValue(bb.a.PD,Math.min(kn.a.nil,F)):(l.Ak(x),a.zb(1),zm.e(l),l.uc());b&&this.P3f(l,!0)}}else f=x}b=null;f=kn.a.last+1;for(c=a.zb(1);c;c=a.wj(1))if(Rd.OutlineElementReader.iI(a))x=Rd.OutlineElementReader.m2(c),f>x&&(f=x,b=c);else{a.uc();return}if(b){for(c=a.zb(1);c;c=a.wj(1))c!==b&&a.currentNode.setValue(bb.a.PD,Math.min(kn.a.nil,Rd.OutlineElementReader.m2(c)-
f));f+=Rd.OutlineElementReader.m2(a.currentNode);a.currentNode.setValue(bb.a.PD,Math.min(kn.a.nil,f));c=new mb.GraphIterator;c.Nc(a);c.Ak(b);c.zb(1);zm.e(c)}}Ugj(a,b,c){var f=Rd.OutlineElementReader.m2(a.currentNode);if(1===f)return!0;if(Rd.OutlineElementReader.iI(a))return!1;if(!a.f7(1)||this.EJj(a,b))return a.currentNode.setValue(bb.a.PD,Math.min(kn.a.nil,1)),!0;if(c.pla&&a.Ak(c.pla)){if(Rd.OutlineElementReader.iI(a)&&1===f+Rd.OutlineElementReader.m2(a.currentNode))return c.pla=a.uA(1),a.uc(),!0;
a.uc()}if(c.pla&&a.Ak(c.pla)||!c.pla&&a.zb(1)){if(a.currentNode!==b&&a.uf(1)&&Rd.OutlineElementReader.iI(a)&&1===f+Rd.OutlineElementReader.m2(a.currentNode))return c.pla=null,!0;a.uc()}if(a.RQa(b)&&this.DJj(a,b)){for(c=a.zb(1);c;c=a.wj(1))c!==b&&c.setValue(bb.a.PD,Math.min(kn.a.nil,Rd.OutlineElementReader.m2(c)+(f-1)));a.currentNode.setValue(bb.a.PD,Math.min(kn.a.nil,1));return!0}if(1>f)return f=this.m6d(a,c.pla,1-f),a.Ak(f),c.pla=null,!0;if(1<f){a.currentNode.setValue(bb.a.PD,Math.min(kn.a.nil,1));
b=null;let l=a.zb(1);for(;l;){if(Rd.OutlineElementReader.iI(a)){l.setValue(bb.a.PD,Math.min(kn.a.nil,f-1+Rd.OutlineElementReader.m2(l)));l=a.wj(1);continue}b||(b=this.xzj(a,f-1));const x=l;l=zm.j(a,b,1);l===b&&(l=a.wj(1));c.pla===x&&(c.pla=b,b=null)}return!0}return!1}EJj(a,b){return mb.GraphIterator.mba(()=>{if(1===a.f7(1)){const c=a.zb(1);a.uc();if(c===b)return!0}return!1})}DJj(a,b){return mb.GraphIterator.mba(()=>{let c;for(c=a.zb(1);c;c=a.wj(1))if(c!==b&&!Rd.OutlineElementReader.iI(a))return a.uc(),
!1;return!0})}qYi(a,b){b.Rpb=0;do{const c=a.currentNode;if(a.zb(1))b.Rpb-=Rd.OutlineElementReader.m2(c);else{if(Ui.OutlineReader.At(a)||null===a.currentNode)return!1;if(3!==a.role||!a.nia(1))for(;!a.wj(1);)if(b.Rpb+=Rd.OutlineElementReader.m2(a.currentNode),Ui.OutlineReader.At(a)||null===a.currentNode)return!1}}while(Rd.OutlineElementReader.iI(a));return!0}L2b(a,b=!1){return this.l6d(a,!1,b)}l6d(a,b,c=!1){const f=new mb.GraphIterator;f.Nc(a);a=new mb.GraphIterator;a.Nc(f);this.Tba(a,b,!1,null,c);
a.currentNode.setValue(bb.a.PD,Math.min(kn.a.nil,Rd.OutlineElementReader.m2(f.currentNode)));f.zb(1)&&zm.h(a,null,1,1,f,-1);return a}DDf(a){if(Rd.OutlineElementReader.cTk(a)){1!==Rd.OutlineElementReader.m2(a.currentNode)&&a.currentNode.setValue(bb.a.PD,kn.a.first);for(var b=a.zb(1);b;)if(Rd.OutlineElementReader.iI(a)){b=new mb.GraphIterator;b.Nc(a);b.uc();const c=new mb.GraphIterator;c.Nc(a);c.zb(1);zm.h(b,a.currentNode,1,1,c,-1);b=a.yOa(1)}else this.DDf(a),b=a.wj(1)}}static get qO(){return Pj.QJ||
(Pj.QJ=hb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static set qO(a){Pj.QJ=a}static get paragraphEditor(){return Pj.xw||(Pj.xw=hb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Pj.xw=a}}Pj.QJ=null;Pj.xw=null;Pj.TWe=null;Pj.fpc=null;Object(e.a)(Pj,"OutlineElementEditor",null,[1293]);var Pw=d(108),Qw=d(398),EF=d(584),oq=d(253);class jo{constructor(a){this.agf=a}Vyi(){const a=rs.a.instance.createInstance(393228);a.setValue(bb.a.PD,kn.a.first);a.setValue(bb.a.bci,0);
a.setValue(bb.a.Ex,Ui.OutlineReader.EUf);(new EF.OutlineIndentInfo(!0)).Yhh(a);return a}IY(a,b,c=null){const f=a.currentNode;if(!a.uA(1))return this.K2b(a,null,b,c);Rd.OutlineElementReader.iI(a)&&Yb.OutlineElementNavigator.Dse(a,!0);return Rd.OutlineElementReader.Tg(a)?jo.Jh.Tba(a,!1,b,c):(a.vic(f),null)}Bii(a){return Ui.OutlineReader.L9d(a.currentNode)||Rd.OutlineElementReader.Tg(a)||Rd.OutlineElementReader.iI(a)||De.isTableCell(a)}K2b(a,b=null,c=!1,f=null){if(!this.Bii(a))return null;const l=jo.Jh.$Od();
this.G4k(l,a);a.nQc(l,b,1,this.agf.J5f());a.Ak(l);c&&(jo.Jh.Vaa(a,f),Yb.OutlineElementNavigator.Je(a));H.a.instance.ga(25)&&jo.Jh.mSe(a.currentNode);return l}G4k(a,b){if(b=this.Saj(b))switch(b.type){case 11:jo.Jh.rSd(b,a,!0);break;case 8:b=jo.sk.isRtl(b),jo.Jh.Lfd(a,b)}}Saj(a){return this.agf.l0d(a)}b1i(a,b){a=jo.sk.kMc(a);return new Qw.a(a.x+Ui.OutlineReader.PFc*(b?-1:1),a.y+Ui.OutlineReader.MUf)}Dfd(a){if(H.a.instance.ga(17)){var b=new mb.GraphIterator;b.set(a);b.uv();b=this.b1i(b.origin,Ui.OutlineReader.Yl(a));
oq.c(a,b.x,b.y)}}jIa(a,b){H.a.instance.ga(43)&&ph.c(a)||a.setValue(bb.a.rI,b?11:9)}static get sk(){return Pw.PageReader.instance}static get Jh(){return jo.xi||(jo.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Jh(a){jo.xi=a}}jo.xi=null;jo.Gf=null;Object(e.a)(jo,"OutlineEditor",null,[1299]);const kP=a=>{a.register(jo,"Box4.OutlineLevelEditors.OutlineEditor").as("Box4.IOutlineEditor").ma().na(()=>new jo(a.resolve("Box4.IOutlineElementNodeIdFactory")));a.register(Pj,"Box4.OutlineLevelEditors.OutlineElementEditor").as("Box4.IOutlineElementEditor").ma().na(()=>
new Pj(a.Be("Box4.IOutlineEditor"),a.Be("Box4.List.IListEditor"),a.Be("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IFormattingPropertyTransitStrategy")))};class CA{get name(){return"Box4.OutlineLevelEditors"}Wb(a){kP(a)}init(){}dispose(){}static main(){m.a.instance.Ac(new CA)}}Object(e.a)(CA,"Box4OutlineLevelEditorsPackage",null,[2,3]);class DA{get name(){return"Box4.TableEditors"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Ac(new DA)}}
Object(e.a)(DA,"Box4TableEditorsPackage",null,[2,3]);class EA{get name(){return"Box4.TextLevelEditors"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Ac(new EA)}}Object(e.a)(EA,"Box4TextLevelEditorsPackage",null,[2,3]);class Ar{constructor(a,b,c){this.iyd=this.s1a=this.fyd=this.r1a=this.fwd=null;this.KF=a;this.DKh=b;this.Pc=c;this.init()}init(){this.DKh.ob(Object(D.a)(this,this.Wkj,"handleEditingViewUpdatesSafe"));this.r1a=new Me.a;this.fyd=new Me.a;this.s1a=new Me.a;this.iyd=new Hf.a}VWa(a){this.r1a.add(a.key,
a)}dDe(a){this.s1a.add(a.key,a)}Wkj(a){try{this.Vkj(a)}catch(b){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",b.message,b.stack),Z.ULS.sendTraceTag(5285580,334,10,a)}}Vkj(a){let b;({YPd:b}=Ar.Upl(this.Pc.Oa.kb)).returnValue&&(a=Ar.I_i(a,this.fwd,b),this.DAk(a,b),this.fwd=b)}DAk(a,b){a=this.nXi(a,b);let c;({notification:c}=Ar.Npl(a)).returnValue&&this.KF.sendNotification(c,!1)}nXi(a,b){const c=new Me.a;c.$(1,new Hf.a);c.$(0,new Hf.a);a.forEach(f=>
{3===f?(W.ImageReader.wG(b.node)||this.hTk(b),this.a9i(c,b)):0===f&&this.f0i(c,b);return!0});return c}hTk(a){this.r1a.forEach((b,c)=>{c.reset(a);return!0})}f0i(a,b){let c=new Me.a;W.ImageReader.wG(b.node)||(c=this.c0i(b.Qa));this.d0i(a,this.fyd,c,Ar.Zih(this.fwd,b));this.fyd=c}c0i(a){const b=new Me.a;this.r1a.forEach((c,f)=>{c=null;({sza:c}=f.Nmc(a)).returnValue&&b.$(f.key,c);return!0});return b}d0i(a,b,c,f){const l=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;b.forEach((x,F)=>{const R=this.r1a.ga(x).G6||
F.title;let fa;({value:fa}=c.Of(x)).returnValue?f&&fa.iP!==F.iP&&(R&&a.ga(1).add(R),x=this.r1a.ga(x).G6,x=String.format(l,fa.title,x),fa.description&&(x+=", "+fa.description),a.ga(0).add(x)):R&&a.ga(1).add(R);return!0});c.forEach((x,F)=>{b.Jb(x)||(x=this.r1a.ga(x).G6,x=String.format(l,F.title,x),F.description&&(x+=", "+F.description),a.ga(0).add(x));return!0})}a9i(a,b){b=this.Odj(b.node);b=this.Coi(b);this.Pdj(a,this.iyd,b);this.iyd=b}Odj(a){const b=new mb.GraphIterator;b.set(a);if(!b.mc(1))return null;
const c=new Hf.a;for(;1!==b.mi;)this.s1a.forEach((f,l)=>{let x;({gpb:x}=l.eRe(b)).returnValue&&c.add(x);return!0}),b.uc();c.reverse();return c}Coi(a){a=a.toArray();let b=0;for(;b<a.length-1;){var c=a[b];if(c.K_===a[b+1].K_&&(this.s1a.ga(c.K_),({Foi:c}={returnValue:!1,Foi:null}).returnValue)){a.splice(b,2,c);continue}b++}return new Hf.a(a)}Pdj(a,b,c){var f;for(f=0;f<Math.min(c.length,b.length)&&c.ga(f).contentId.equals(b.ga(f).contentId);f++){var l=this.s1a.ga(c.ga(f).K_).bLc(c.ga(f),b.ga(f));l&&(c.ga(f).description&&
(l+=", "+c.ga(f).description),a.ga(0).add(l))}for(l=f;l<c.length;l++){let x=this.s1a.ga(c.ga(l).K_).bLc(c.ga(l),null);x&&(c.ga(l).description&&(x+=", "+c.ga(l).description),a.ga(0).add(x))}for(c=f;c<b.length;c++)(f=this.s1a.ga(b.ga(c).K_).G6)&&a.ga(1).add(f)}static I_i(a,b,c){const f=new Hf.a;(a=a||Ar.oZk(b,c))?(f.add(3),f.add(0)):Ar.Zih(b,c)&&f.add(0);return f}static oZk(a,b){return!a||!a.node.id.equals(b.node.id)}static Zih(a,b){return!a||!a.equals(b)}static Upl(a){let b;b=null;if(!a||!(fb.SelectionEditor.Jw(a)||
(a=fb.SelectionEditor.yl(a,!0,!1),fb.SelectionEditor.Jw(a)||a.Ua&&W.ImageReader.wG(a.Ua.node))))return{returnValue:!1,YPd:b};b=a.Ua;return{returnValue:!!b,YPd:b}}static Npl(a){const b=new Hf.a;a.ga(1).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,c);b.add(c);return!0});a.ga(0).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,c);b.add(c);return!0});a=b.toArray().join(" ");return{returnValue:0<b.length,notification:a}}}
Object(e.a)(Ar,"AccessibilityContextManager",null,[1267]);class Rw{constructor(a,b){this.y$e=!1;this.BQb=null;this.Awc=this.hyc=!1;this.w0e=null;this.Rd=a;this.Xib=b}get erj(){return!!this.BQb}ob(a){this.y$e||(this.Xib.oCf(Object(D.a)(this,this.$zc,"afterEditingViewValidateEventHandler")),this.y$e=!0);this.w0e=a}$zc(a,b){(b.WL||b.OT)&&this.Pfk(b.WL,b.OT)}Pfk(a,b){this.erj&&this.Rd.Qg(this.BQb);this.hyc=this.hyc||a;this.Awc=this.Awc||b;this.BQb=new He.a(4,1,Rw.NMi,()=>{this.w0e(this.hyc,this.Awc);
this.reset()},126);this.Rd.Gb(this.BQb)}reset(){this.BQb=null;this.Awc=this.hyc=!1}}Rw.NMi=100;Object(e.a)(Rw,"EditingViewOnAfterValidateEventsConsolidator",null,[1266]);class FA{constructor(){this.Da=null}get name(){return"Box4.Accessibility"}init(){Gb.App.rGf&&this.Da.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}Wb(a){this.Da=a;a.register(Rw,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ma().na(()=>
new Rw(u.AFrameworkApplication.ue,a.resolve("Box4.ContentEditableViewEventSource")));a.register(Ar,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").ma().na(()=>new Ar(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),ld.a.instance))}static main(){m.a.instance.Ac(new FA)}}Object(e.a)(FA,"Box4AccessibilityPackage",null,[2,3]);class GA{constructor(a,b){this.osf=a;this.k1=b;this.Drf=
this.nrf=this.orf=this.Crf=this.oXe=this.Erf=!0}get ueb(){return this.Erf}get nCc(){return this.oXe}get Scd(){return this.Crf}get $hc(){return this.orf}get Qcd(){return this.nrf}get pEe(){return this.Drf}gKf(a){if(a)for(let c in a){var b=c;const f=Boolean.parse(a[c].toString()||"false");switch(b){case "ReplaceTextAsYouType":this.Erf=f;break;case "CapitalizeFirstLetterOfSentences":this.oXe=f;break;case "ReplaceOrdianalsWithSuperscript":this.Crf=f;break;case "ReplaceHyphensWithDash":this.orf=f;break;
case "ReplaceFractionsWithFractionCharacter":this.nrf=f;break;case "ReplaceQuoteWithSmartQuote":this.Drf=this.k1&&f}}}cYi(){this.osf.N1d("getAutoCorrectOptionsSettings","ReplaceTextAsYouType CapitalizeFirstLetterOfSentences ReplaceOrdianalsWithSuperscript ReplaceHyphensWithDash ReplaceFractionsWithFractionCharacter ReplaceQuoteWithSmartQuote".split(" ")).continueWith(Object(D.a)(this,this.lkk,"onGetRequestFinished"),8);Z.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")}lXk(a){this.osf.Fmh("saveAutoCorrectOptionsSettings",
a);Z.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service.");this.gKf(a)}lkk(a){a.Wl?Z.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service."):((a=a.result)&&this.gKf(a),Z.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!a||!xa.a.count(a)))}}Object(e.a)(GA,"AutoCorrectOptionsInfo",null,[1268]);var qy=d(211);class lj{static get bHf(){lj.AKb||(lj.AKb=[],lj.$Ab(sa.a.le("ar-sa")),
lj.$Ab(sa.a.le("de-de")),lj.$Ab(sa.a.le("es-es")),lj.zQ(sa.a.le("en-029"),sa.a.le("en-us")),lj.zQ(sa.a.le("en-au"),sa.a.le("en-us")),lj.zQ(sa.a.le("en-bz"),sa.a.le("en-us")),lj.zQ(sa.a.le("en-ca"),sa.a.le("en-us")),lj.zQ(sa.a.le("en-gb"),sa.a.le("en-us")),lj.zQ(sa.a.le("en-id"),sa.a.le("en-us")),lj.zQ(sa.a.le("en-my"),sa.a.le("en-us")),lj.zQ(sa.a.le("en-ph"),sa.a.le("en-us")),lj.zQ(sa.a.le("zh-tw"),sa.a.le("en-us")),lj.$Ab(sa.a.le("fr-fr")),lj.zQ(sa.a.le("hr-ba"),sa.a.le("hr-hr")),lj.zQ(sa.a.le("it-ch"),
sa.a.le("it-it")),lj.zQ(sa.a.le("nb-no"),sa.a.le("nn-no")),lj.$Ab(sa.a.le("nl-nl")),lj.zQ(sa.a.le("ro-md"),sa.a.le("ro-ro")),lj.zQ(sa.a.le("ru-md"),sa.a.le("ru-ru")),lj.zQ(sa.a.le("sr-latn-ba"),sa.a.le("sr-latn-cs")),lj.zQ(sa.a.le("sr-latn-me"),sa.a.le("sr-latn-cs")),lj.zQ(sa.a.le("sr-latn-rs"),sa.a.le("sr-latn-cs")),lj.$Ab(sa.a.le("sr-cyrl-cs")),lj.zQ(sa.a.le("sv-fi"),sa.a.le("sv-se")));return lj.AKb}static $Ab(a){lj.AKb[a.languageId]=a.LCID}static zQ(a,b){lj.AKb[a.LCID]=b.LCID}static l9f(a){var b=
sa.a.le(a);if(!b)return 0;b=lj.bHf[b.LCID]||lj.bHf[b.languageId]||0;return b===a?0:b}}lj.AKb=null;Object(e.a)(lj,"AutoCorrectListFallback",null,[]);class ko{constructor(a,b,c,f,l){this.r7e=!1;this.ncf=0;this.JKa=null;this.iUh=!1;this.hcf=this.qef=!0;this.T5e=null;this.ytc=!0;this.Yjb=a;this.KKa=b;this.M0a=c;this.T5=f;this.Vg=l;this.qPb=a?a.innerText:Ya.ParagraphReader.text(b)}get Iw(){throw Error.notImplemented("The inherit class should have the default value.");}set Iw(a){}get iVc(){return this.ncf}Xmh(a){this.ncf=
a}get kb(){return this.JKa}set kb(a){this.JKa=a}get rkg(){return this.Yjb}get wgg(){return this.KKa}get Rz(){return this.M0a}get AQ(){return this.T5}get xBb(){return this.qef}set xBb(a){this.qef=a}get atg(){return this.r7e}get Sxg(){return!1}get Gla(){return this.qPb}invoke(){this.r7e=!0;if(this.Yjb&&this.Yjb.parentNode&&!this.Iw){var a=this.Yjb.innerText;if(this.xBb&&Ma.a.substring(this.qPb,this.M0a,this.T5)!==Ma.a.substring(a,this.M0a,this.T5))return 0;this.H4a(this.Yjb);this.Xmh(this.Yjb.innerText.length-
a.length);return 1}this.ytc||Sa.a.instance.Tb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.hcf)return Sa.a.instance.Tb("AbortedAction",{["Reason"]:this.T5e}),0;var b=Ya.ParagraphReader.text(this.KKa);a=b.length;var c=this.qPb.length,f=Ma.a.substring(this.qPb,this.M0a,this.T5).trimEnd();b=Ma.a.substring(b,this.M0a,this.T5).trimEnd();f===b&&this.T5>c&&(this.T5=c);if(this.xBb&&f!==b)if(c=f.replace(RegExp('"',"g"),""),c===Ma.a.substr(b,0,c.length))this.T5-=2;else return 0;if(H.a.instance.ga(50)&&
Gb.App.Eh.Qv&&vF.CoauthLockEditor.getInstance().UGb(ko.Wi.j_b(this.KKa)))return 0;c=new We.GraphTransaction(15);c.fd(this.KKa);c.$c=this.commandId;this.T6(this.KKa);this.Xmh(Ya.ParagraphReader.textLength(this.KKa)-a);this.JKa&&!this.iUh&&fb.SelectionEditor.Jw(this.JKa)&&(b=this.JKa.Ua,a=b.Qa,f=b.Kb,b=b.node,b===this.KKa&&this.iVc&&(a>=this.T5&&(a+=this.iVc),f>=this.T5&&(f+=this.iVc),this.JKa=nd.SelectionFactory.P1(b,a,f)));c.dispose();return 2}hDh(){this.ytc=this.sMf()}H4a(){}sMf(){var a=Ya.ParagraphReader.text(this.KKa);
const b=Ma.a.substring(this.qPb,this.M0a,this.T5).trimEnd();a=Ma.a.substring(a,this.M0a,this.T5).trimEnd();return b===a}static get Wi(){return Qg.a.instance}}Object(e.a)(ko,"AutoCorrectAction",null,[1313]);class lo extends ko{constructor(a,b,c,f,l,x){super(a,b,c,f,x);this.xcf=null;this.$ka=l;this.sU=x}get ESa(){return this.xcf||(this.xcf=hb.a.instance.pb("Box4.List.IListCommands"))}get ao(){return lo.Jo||(lo.Jo=hb.a.instance.resolve("Box4.List.IListEditor"))}get Iw(){return!0}get commandId(){return C.a.YId}set Iw(a){super.Iw=
a}}lo.Jo=null;Object(e.a)(lo,"RegexCorrectAction",ko,[]);const av={[0]:{"a)":{autonumberBulletType:2,Ni:[65533,4,41]},"a.":{autonumberBulletType:4,Ni:[65533,4,46]},"A.":{autonumberBulletType:5,Ni:[65533,3,46]},"1)":{autonumberBulletType:7,Ni:[65533,0,41]},"1.":{autonumberBulletType:8,Ni:[65533,0,46]},"i.":{autonumberBulletType:14,Ni:[65533,2,46]},"I.":{autonumberBulletType:15,Ni:[65533,1,46]}},[1]:{"*":{Ni:[8226],font:"Arial"},"-":{Ni:[45],font:"Calibri"},"--":{Ni:[167],font:"Wingdings"},">":{Ni:[216],
font:"Wingdings"},"<>":{Ni:[118],font:"Wingdings"}}};class Zo extends lo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x);Zo.gKa=x}get commandId(){return C.a.QId}T6(a){if(this.ESa){var b=mb.GraphIterator.mb(a);b.Ze();Yb.OutlineElementNavigator.Je(b);if(this.ao.Cgd()){var c=Zo.Rf.Fw(b),f=this.$ka[0];switch(Ma.a.charAt(f,0)){case "*":var l=uj.a.kP(1,1);l.Gpa="*";break;default:l=uj.a.kP(1,0)}c&&l.w3d(c)||(c=new We.GraphTransaction(15),c.Tx(b),b=this.KYi(l.listType,l.listStyle,f),null!=b&&this.ESa.ifi(b)&&
(Z.ULS.sendTraceTag(509747285,393,50,"Found list insert matching string "+f),Zo.gKa.replaceTextRange(Pc.a.createTextRange(a,this.Rz,this.AQ+1),"",!0,!1)),c.dispose())}}}KYi(a,b,c){var f;let l=null===(f=null===av||void 0===av?void 0:av[a])||void 0===f?void 0:f[c];if(null==l)return null;c=new E.DictionaryPropertySet;c.setValue(be.a.tD,a);c.setValue(be.a.nca,b);c.setValue(bb.a.Ni,l.Ni);c.setValue(bb.a.font,l.font);return c}static get characterPropertiesEditor(){return Zo.gKa||(Zo.gKa=hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Rf(){return Zo.Og||
(Zo.Og=hb.a.instance.resolve("Box4.List.IListReader"))}static BB(a,b,c,f,l){return new Zo(null,a,b,c,f,l)}static lP(a,b,c,f,l){return new Zo(a,Sc.a(a).$a,b,c,f,l)}}Zo.gKa=null;Zo.Og=null;Object(e.a)(Zo,"BulletListAction",lo,[]);class Ng extends lo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x);this.JNb=!1;this.Iw=!a;this.gKa=x;Ng.Tk=new Ic.a}get Iw(){return this.JNb}set Iw(a){this.JNb=a}H4a(a){this.MLd(a.innerText,(b,c,f)=>{a.innerText=Ma.a.substring(a.innerText,0,b)+f+Ma.a.right(a.innerText,c)})}T6(a){this.MLd(Ya.ParagraphReader.text(a).substring(this.Rz,
this.AQ),(b,c,f)=>{this.gKa.replaceTextRange(Pc.a.createTextRange(a,this.Rz+b,this.Rz+c),f,!0,!1)})}MLd(a,b){if(!(2>this.$ka.length)&&this.$ka[1]){var c=this.$ka[1];Ng.Tk.count||this.U4g();Ng.Tk.Jb(c)&&(a=a.lastIndexOf(c),-1!==a&&b(a,a+c.length,Ng.Tk.ga(c)))}}}Ng.Tk=null;Object(e.a)(Ng,"DictionarySequenceReplacerAction",lo,[]);class Sw extends Ng{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return C.a.ITb}U4g(){Ng.Tk.$("--","\u2014");Ng.Tk.$(" -- "," \u2013 ");Ng.Tk.$(" - "," \u2013 ");
Ng.Tk.$("-- ","\u2014");Ng.Tk.$(" --"," \u2013");Ng.Tk.$(" -"," \u2013")}static BB(a,b,c,f,l){return new Sw(null,a,b,c,f,l)}static lP(a,b,c,f,l){return new Sw(a,Sc.a(a).$a,b,c,f,l)}}Object(e.a)(Sw,"DashAction",Ng,[]);class Bt extends Ng{constructor(a,b,c,f,l,x,F){super(a,b,c,f,l,x);this.Ca=F}get commandId(){return C.a.SId}U4g(){Ng.Tk.$(":)","\ud83d\ude0a");Ng.Tk.$(":-)","\ud83d\ude0a");Ng.Tk.$(":|","\ud83d\ude10");Ng.Tk.$(":-|","\ud83d\ude10");Ng.Tk.$(":(","\ud83d\ude41");Ng.Tk.$(":-(","\ud83d\ude41");
Ng.Tk.$(";)","\ud83d\ude09");Ng.Tk.$(";-)","\ud83d\ude09");Ng.Tk.$(":D","\ud83d\ude00");Ng.Tk.$(":-D","\ud83d\ude00");Ng.Tk.$(":')","\ud83d\ude02");Ng.Tk.$("=D","\ud83d\ude03");Ng.Tk.$(":>","\ud83d\ude06");Ng.Tk.$(":->","\ud83d\ude06");Ng.Tk.$(":3","\ud83d\ude0a");Ng.Tk.$(":-3","\ud83d\ude0a");Ng.Tk.$("B-)","\ud83d\ude0e");Ng.Tk.$("*-*","\ud83d\ude0d");Ng.Tk.$(":*","\ud83d\ude19");Ng.Tk.$(":-*","\ud83d\ude19");Ng.Tk.$(":X","\ud83d\ude36");Ng.Tk.$(":-X","\ud83d\ude36");Ng.Tk.$(":O","\ud83d\ude2e");
Ng.Tk.$(":-O","\ud83d\ude2e");Ng.Tk.$(":#","\ud83e\udd10");Ng.Tk.$(":-#","\ud83e\udd10");Ng.Tk.$(":P","\ud83d\ude1b");Ng.Tk.$(":-P","\ud83d\ude1b");Ng.Tk.$(";P","\ud83d\ude1c");Ng.Tk.$(";-P","\ud83d\ude1c");Ng.Tk.$(":-/","\ud83d\ude15");Ng.Tk.$("$-$","\ud83e\udd11");Ng.Tk.$(":S","\ud83d\ude16");Ng.Tk.$(":-S","\ud83d\ude16");Ng.Tk.$(":[","\ud83d\ude1f");Ng.Tk.$(":-[","\ud83d\ude1f");Ng.Tk.$(":\u2019(","\ud83d\ude22");Ng.Tk.$(":'(","\ud83d\ude22");Ng.Tk.$("@-@","\ud83d\ude31")}T6(a){this.MLd(Ya.ParagraphReader.text(a).substring(this.Rz,
this.AQ),(b,c,f)=>{b=Pc.a.createTextRange(a,this.Rz+b,this.Rz+c);c={};c.MenuItemId=f;this.Ca.ii(b,C.a.ezj,2,!1,null,c,null)})}static BB(a,b,c,f,l,x){return new Bt(null,a,b,c,f,l,x)}static lP(a,b,c,f,l,x){return new Bt(a,Sc.a(a).$a,b,c,f,l,x)}}Object(e.a)(Bt,"EmojiAction",Ng,[]);class Sp{constructor(a,b,c,f){this.AJ=a;this.Xxc=b;this.sbf=f;this.hz=c}mvg(){if(!this.hz)return!1;this.AJ=this.AJ.trimStart();return this.AJ===this.hz?!0:!1}nQj(){if(!this.AJ)return!1;const a=this.AJ.lastIndexOf(" ");return-1!==
a&&"."===this.AJ.charAt(a-1)&&"."===this.AJ.charAt(a-3)?!0:!1}mQj(){if(!this.AJ)return!1;const a=this.AJ.lastIndexOf(" ");return-1!==a&&"."===this.AJ.charAt(this.AJ.substring(0,a-1).lastIndexOf(" ")+2)?!0:!1}wJj(){return this.mvg()&&(1===this.hz.length&&"."===this.Xxc||"."===this.AJ.charAt(1))?!0:!1}xJj(){return this.hz?0<="\\/".indexOf(this.Xxc)||3===this.hz.length&&0<="\\/".indexOf(this.hz.charAt(1))?!0:!1:!1}yIj(){return this.hz?0<=this.hz.indexOf("@")?!0:!1:!1}Fs(){if(!this.hz)return!1;for(const a of Sp.c2d())if(Ma.a.startsWith(this.hz+
this.Xxc,a))return!0;return!1}hIj(){return this.hz?"i"===this.hz&&0<=Sp.quotes.indexOf(this.Xxc)?!0:!1:!1}KDj(){if(!this.AJ)return!1;const a=Ma.a.CDa(this.AJ,this.AJ.length-1);if(-1!==a&&this.AJ.substring(a+1,this.AJ.length)===this.hz){const b=this.AJ.charAt(a-1);if(0<=Sp.tHe.indexOf(b)||0<=Sp.quotes.indexOf(b)&&0<=Sp.tHe.indexOf(this.AJ.charAt(a-2)))return!0}return!1}vki(){return!this.AJ||this.nQj()||this.wJj()||this.xJj()||this.mQj()||this.yIj()||this.Fs()?!1:this.mvg()||this.hIj()||this.KDj()?
!0:!1}static c2d(){return Sp.vcf||(Sp.vcf="http: https: ftp:// mailto: \\\\ www.".split(" "))}}Sp.tHe=".!?";Sp.quotes="'\"";Sp.vcf=null;Object(e.a)(Sp,"FirstLetterUpperCaseRules",null,[]);class pq{constructor(a){this.hz=a}uUi(){if(!this.hz)return null;for(let a=0;a<pq.Ifg().length;a++)if(this.hz===pq.Ifg()[a])return pq.Rhj()[a];return null}static Ifg(){return pq.N2e||(pq.N2e=["1/2","1/4","3/4"])}static Rhj(){return pq.M2e||(pq.M2e=["\u00bd","\u00bc","\u00be"])}}pq.N2e=null;pq.M2e=null;Object(e.a)(pq,
"FractionsCollection",null,[]);class HA extends ko{constructor(a,b,c,f,l,x){super(a,b,c,f,x);this.qLb=l;this.sU=x}get Iw(){return!0}get commandId(){return C.a.TId}H4a(a){a.innerText=Ma.a.substring(a.innerText,0,this.Rz)+this.qLb+Ma.a.right(a.innerText,this.AQ)}T6(a){this.sU.replaceTextRange(Pc.a.createTextRange(a,this.Rz,this.AQ),this.qLb,!0,!1)}set Iw(a){super.Iw=a}static BB(a,b,c,f,l){return new HA(null,a,b,c,f,l)}}Object(e.a)(HA,"FractionsReplaceCorrectAction",ko,[]);class ts extends lo{constructor(a,
b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return C.a.VId}T6(a){if(this.ESa){var b=mb.GraphIterator.mb(a);b.Ze();Yb.OutlineElementNavigator.Je(b);if(this.ao.Cgd()){var c=this.$ka[0],f=ts.egk(c),l=Ma.a.e5b(c.charAt(0))?4:2,x=Pc.a.createTextRange(a,this.Rz,this.AQ+1);this.ao.gNa(a,b,l,f,x,c,this.ESa)}}}static BB(a,b,c,f,l){return new ts(null,a,b,c,f,l)}static lP(a,b,c,f,l){return new ts(a,Sc.a(a).$a,b,c,f,l)}static egk(a){if(!a)return 0;a=Ma.a.sg(a);if(!Ma.a.ZQc(a.charAt(0)))return 0;const b=a.charCodeAt(0)-
97+1;let c;for(c=1;c<a.length&&a.charAt(c)===a.charAt(0);c++);return 26*(c-1)+b}}Object(e.a)(ts,"LetterListAction",lo,[]);class Tw extends lo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return C.a.gNa}T6(a){if(this.ESa){var b=mb.GraphIterator.mb(a);b.Ze();Yb.OutlineElementNavigator.Je(b);if(this.ao.Cgd()){var c=this.$ka[0],f=parseInt(c);if(!(99999999<=f)){var l=Pc.a.createTextRange(a,this.Rz,this.AQ+1);this.ao.gNa(a,b,1,f,l,c,this.ESa)}}}}static BB(a,b,c,f,l){return new Tw(null,a,
b,c,f,l)}static lP(a,b,c,f,l){return new Tw(a,Sc.a(a).$a,b,c,f,l)}}Object(e.a)(Tw,"NumberListAction",lo,[]);class Tp extends ko{constructor(a,b,c,f,l){super(a,b,c,f,l);Tp.sU=l}get Iw(){return!0}get commandId(){return C.a.WId}H4a(){}T6(a){const b=Pc.a.createTextRange(a,this.AQ-2,this.AQ),c=new We.GraphTransaction(15);c.fd(a);let f=!1,l=null,x=0;for(;x<a.Ra.length;){var F=a.Ra.ga(x),R=!!F.ro||F.gca;let fa=!!F.fieldRangeEnd||F.wZ;if(F.cp>=b.Qa){F.cp>b.Qa||!F.formatting?l=f?F.formatting:Tp.sU.Gea(a,x,
b.Qa,l):(l=F.formatting,fa&&(f=!1),R&&(f=!0));x++;break}F.formatting&&(l=F.formatting);fa&&(f=!1);R&&(f=!0);x++}for(;x<a.Ra.length;){R=a.Ra.ga(x);if(R.cp>=b.Kb){if(R.cp>b.Kb||!R.formatting&&!R.Cj)f||Tp.sU.Gea(a,x,b.Kb,l);f||Tp.$g.GX(l,!0);break}R.formatting&&(f||Tp.$g.GX(l,!0),l=R.formatting);F=!!R.ro||R.gca;R=!!R.fieldRangeEnd||R.wZ;F&&(f=!0);!F&&R&&(f=!1);x++}c.dispose()}set Iw(a){super.Iw=a}static get $g(){return Tp.Gf||(Tp.Gf=hb.a.instance.resolve("Box4.IFormattingEditor"))}static BB(a,b,c,f){return new Tp(null,
a,b,c,f)}}Tp.sU=null;Tp.Gf=null;Object(e.a)(Tp,"OrdinalsReplaceCorrectAction",ko,[]);class vl extends lo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x);vl.ilb||vl.$gl();this.gKa=x}get commandId(){return C.a.XId}T6(a){if(!a.mqj){var b=this.JKa.Ua.node===a,c=-1,f=3;this.$ka[2]&&(c=parseInt(this.$ka[2]));this.$ka[1]&&(f=parseInt(this.$ka[1]));if(!(20<c||100<f)){a.mG().graphTransactionOperations.Uga(7);var l=mb.GraphIterator.mb(a);l.Ze();Yb.OutlineElementNavigator.Je(l);vl.Jh.Tba(l,!1,!1);vl.Jh.Vaa(l);for(let R=
0;R<f;++R){const fa=[];var x=R%vl.ilb.length,F=0<c?c:vl.ilb[x].length;for(let wa=0;wa<F;++wa)Array.add(fa,vl.ilb[x][wa%vl.ilb[x].length]);x=Pc.a.Uj(l.currentNode,0);F=tb.a.Bs(x);2!==Gb.App.mode?vl.$g.RXa(F,1142):vl.$g.im(F,Bb.a.noProof,!0);this.gKa.replaceTextRange(x,fa.join(" "),!0,!1);R<f-1&&(Yb.OutlineElementNavigator.Je(l),vl.Jh.Tba(l,!1,!1),vl.Jh.Vaa(l))}c=l.currentNode;l=mb.GraphIterator.mb(a);l.Ze();Yb.OutlineElementNavigator.Je(l);l.Ii();b&&(this.JKa=nd.SelectionFactory.Jg(c,Ya.ParagraphReader.textLength(c)))}}}static get Jh(){return vl.xi||
(vl.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get $g(){return vl.Gf||(vl.Gf=hb.a.instance.resolve("Box4.IFormattingEditor"))}static $gl(){vl.ilb=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.",
"Proin pharetra nonummy pede.","Mauris et orci."]]}static BB(a,b,c,f,l){return new vl(null,a,b,c,f,l)}static lP(a,b,c,f,l){return new vl(a,Sc.a(a).$a,b,c,f,l)}}vl.ilb=null;vl.xi=null;vl.Gf=null;Object(e.a)(vl,"RandAction",lo,[]);class FF{constructor(a,b,c,f){this.pattern=f&8?new RegExp(a,"i"):new RegExp(a);this.Rsj=b;this.Mij=c;this.flags=f}}Object(e.a)(FF,"RegexAutoCorrectEntry",null,[]);class Cn extends lo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return C.a.ZId}T6(a){if(this.ESa){var b=
mb.GraphIterator.mb(a);b.Ze();Yb.OutlineElementNavigator.Je(b);if(this.ao.Cgd()){var c=this.$ka[0],f=Ma.a.substring(c,0,c.indexOf("."));f=Cn.fgk(f);if(!(0>=f)){var l=Ma.a.e5b(c.charAt(0))?5:3,x=Pc.a.createTextRange(a,this.Rz,this.AQ+1);this.ao.gNa(a,b,l,f,x,c,this.ESa)}}}}static BB(a,b,c,f,l){return new Cn(null,a,b,c,f,l)}static lP(a,b,c,f,l){return new Cn(a,Sc.a(a).$a,b,c,f,l)}static YLi(){Cn.Foa||(Cn.Foa={},Cn.Foa.M=1E3,Cn.Foa.D=500,Cn.Foa.C=100,Cn.Foa.L=50,Cn.Foa.X=10,Cn.Foa.V=5,Cn.Foa.I=1)}static fgk(a){if(!a)return 0;
Cn.YLi();a=Ma.a.cB(a);let b=0,c=0;for(let f=a.length-1;0<=f;f--){const l=Cn.Foa[Ma.a.charAt(a,f).toString()];c=l<b?c-l:c+l;b=l}return c}}Cn.Foa=null;Object(e.a)(Cn,"RomanListAction",lo,[]);class Uw extends ko{constructor(a,b,c,f,l,x){super(a,b,c,c+1,x);this.sU=x;this.fXh=f;this.LYe=l;this.xBb=!1}get Iw(){return!1}get commandId(){return C.a.yai}H4a(a){a.innerText=Ma.a.substring(a.innerText,0,this.Rz)+this.LYe+Ma.a.right(a.innerText,this.AQ)}T6(a){this.sU.replaceTextRange(Pc.a.createTextRange(a,this.Rz,
this.AQ),this.fXh,!0,!1);this.sU.replaceTextRange(Pc.a.createTextRange(a,this.Rz,this.Rz+1),this.LYe,!0,!1)}set Iw(a){super.Iw=a}static BB(a,b,c,f,l,x){if("'"!==c&&'"'!==c)return null;var F=mb.GraphIterator.mb(a);F.Ze();Yb.OutlineElementNavigator.Je(F);if(Rd.OutlineElementReader.Yl(F.currentNode))return null;f=!b||Ma.a.Dae(f)||-1!==Array.indexOf(Uw.aqk,f);F="'"===c;return new Uw(x,a,b,c+"",f?F?"\u2018":"\u201c":F?"\u2019":"\u201d",l)}}Uw.aqk=["[","{","("];Object(e.a)(Uw,"SmartQuoteCorrectAction",
ko,[]);class us extends ko{constructor(a,b,c,f,l,x){super(a,b,c,f,x);this.qLb=l;this.sU=x}get Iw(){return us.JNb}set Iw(a){us.JNb=a}get commandId(){return C.a.aJd}hDh(){this.ytc=this.sMf();this.ytc||(this.hcf=!1,this.T5e="MatchTextIsNotTheSame")}H4a(a){a.innerText=Ma.a.substring(a.innerText,0,this.Rz)+this.qLb+Ma.a.right(a.innerText,this.AQ)}T6(a){this.sU.replaceTextRange(Pc.a.createTextRange(a,this.Rz,this.AQ),this.qLb,!0,!1)}static lP(a,b,c,f,l){const x=Sc.a(a);return new us(a,x?x.$a:null,b,c,f,
l)}static BB(a,b,c,f,l){return new us(null,a,b,c,f,l)}}us.JNb=!1;Object(e.a)(us,"StringReplaceCorrectAction",ko,[]);class ry extends ko{constructor(a,b,c,f,l,x,F,R){super(a,b,c,f,l);this.sU=l;this.LC=x;this.eOh=F;this.QC=R}get Iw(){return!0}get commandId(){return C.a.cJd}H4a(a){let b=Ma.a.substring(a.innerText,this.Rz,this.AQ);b.charAt(0)!==b.charAt(0).toUpperCase()&&(b=b.charAt(0).toUpperCase()+b.substring(1,b.length));a.innerText=Ma.a.substring(a.innerText,0,this.Rz)+b+Ma.a.right(a.innerText,this.AQ)}T6(a){const b=
this.Rz,c=this.Rz+1,f=a.characterData.substring(b,c).charAt(0);Ma.a.e5b(f)||(a=Pc.a.createTextRange(a,b,c),this.aEj(a)||this.sU.replaceTextRange(a,f.toUpperCase().toString(),!0,!1))}aEj(a){return this.eOh?!!this.LC&&this.LC.gsa(a):!1}set Iw(a){super.Iw=a}static lP(a,b,c,f){const l=Sc.a(a);return new ry(a,l?l.$a:null,b,c,f,null,!1,null)}static BB(a,b,c,f,l,x,F){return new ry(null,a,b,c,f,l,x,F)}}Object(e.a)(ry,"UpperFirstLetterAutoCorrect",ko,[]);class Br{constructor(a,b){this.sbf=b;this.hz=a}Kyl(){const a=
Number.parseInvariant(this.hz.substring(0,this.hz.length-2));switch(Number.parseInvariant(this.hz.charAt(this.hz.length-3).toString())){case 1:return 11===a?"th":"st";case 2:return 12===a?"th":"nd";case 3:return 13===a?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}HJj(){var a=sa.a.le(this.sbf);if(!a||!a.name.toLowerCase().startsWith("en")||!this.hz||2>=this.hz.length)return!1;for(a=0;a<Br.XNc().length;a++)if(this.hz.toLowerCase().endsWith(Br.XNc()[a])){if(RegExp("^\\d+$").test(this.hz.substr(0,
this.hz.length-2))){const b=this.Kyl();if(this.hz.toLowerCase().endsWith(Br.XNc()[a])&&b===Br.XNc()[a])return!0}break}return!1}static XNc(){return Br.Mff||(Br.Mff=["st","nd","rd","th"])}}Br.Mff=null;Object(e.a)(Br,"ValidateOrdinalsRule",null,[]);class ln{constructor(a,b,c,f,l,x,F){this.q1a=[];this.zib=[];this.zKb=[];this.zod=[];this.aoa=-1;this.Dud=this.M4e=this.k1=this.Sqc=!1;this.csc=a;this.Vg=b;this.LC=c;this.Ca=f;this.ZQ=x;this.QC=F;l?(this.Sqc=l.ka("WordEditorEmoticonAutoCorrectIsEnabled")||
l.ka("OneNoteInsertEmojiIsEnabled"),this.k1=l.ka("ReplaceQuoteWithSmartQuoteIsEnabled"),this.M4e=l.ka("HyperlinkUrlValidationIsEnabled"),this.Dud=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertBulletViaKeyboardEnabled",!1),Z.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.Sqc,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.k1})):(Z.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),
this.k1=this.Sqc=!1)}e8d(a){return 0<=ln.RId.indexOf(a)}bPj(a){return 0<=ln.bJd.indexOf(a)}vug(a){return a.toLowerCase()===a}e5b(a){return a.toUpperCase()===a}ZQc(a){return a.toLowerCase()!==a.toUpperCase()}RFj(a,b,c,f){return(new Sp(a,b,c,f)).vki()}r0i(a){do{if(a.getAttribute("xml:lang"))return sa.a.le(a.getAttribute("xml:lang"))||sa.a.W2b;if(a.getAttribute("lang"))return sa.a.le(a.getAttribute("lang"))||sa.a.W2b;a=a.parentNode}while(a&&1===a.nodeType);return sa.a.W2b}$Xd(a){return sa.a.le(tb.a.language(tb.a.Bs(a)))||
sa.a.W2b}aJc(a,b){0>b&&(b=0);let c=-1;const f=ln.RId.length;for(let l=0;l<f;++l){const x=a.lastIndexOf(Ma.a.charAt(ln.RId,l),b);x>c&&(c=x)}a=Ma.a.CDa(a,b);a>c&&(c=a);return c}$Qi(a){for(let b=0;b<a.length;++b)if(this.ZQc(Ma.a.charAt(a,b)))return b;return-1}j3f(a,b){if(!a||0>b)return-1;let c=b;c=c?this.aJc(a,c-1):-1;c=c>Ma.a.CDa(a,b-1)?c:Ma.a.CDa(a,b-1);c++;return c}c3f(a,b,c){if(!H.a.instance.ga(70))return null;this.tYb(b);if(!this.zib[b])if(b=lj.l9f(b),0<b){if(this.tYb(b),!this.zib[b])return null}else return null;
if(c&&this.zKb[b]&&Array.contains(this.zKb[b],a+c))return null;c=this.zib[b][Ma.a.sg(a)];if("string"!==typeof c||c===a)return null;if(c){var f=this.$Qi(a);if(0>f||this.vug(Ma.a.charAt(a,f)))return c;b=!0;for(f+=1;f<a.length;++f){const l=Ma.a.charAt(a,f);b&&!this.e5b(l)&&(b=!1)}return b?Ma.a.cB(c):Ma.a.cB(Ma.a.substring(c,0,1))+Ma.a.right(c,1)}return null}hRi(a,b,c,f){N.a.mark(4666);const l=this.r0i(b).LCID;let x=0,F=a;const R=b.innerText;if(this.w8d(R.substring(R.lastIndexOf(" ",a)+1,a)))return N.a.mark(4667),
null;let fa=null;var wa=!1;do{F=F?this.aJc(R,F-1):-1;if(-1===F&&!c){wa=b;var Xa=null;if(!this.e8d(R.charAt(0))){do{for(;wa&&!wa.previousSibling;)wa=wa.parentNode;wa&&(wa=wa.previousSibling,Xa=wa.innerText)}while(wa&&!Xa);if(wa&&Xa&&!this.e8d(Ma.a.charAt(Xa,Xa.length-1)))return N.a.mark(4667),null}wa=!0}Xa=Ma.a.substring(R,F+1,a);++x;var lb=this.c3f(Xa,l,f.toString());if(lb)fa=us.lP(b,F+1,a,lb,this.Vg);else for(lb=0;lb<this.q1a.length;++lb){const Lb=this.q1a[lb];if(!(Lb.flags&1&&!(c&&1>F)||Lb.flags&
4||Lb.flags&2&&" "!==f)){const kc=Lb.pattern.exec(Xa);if(kc){fa=Lb.Rsj(b,F+1,a,kc,this.Vg,this.Ca);break}}}}while(!wa&&!fa&&x<ln.cSg&&0<=F);N.a.mark(4667);return fa}dRi(a,b,c){const f=a.node;let l=Ya.ParagraphReader.text(f);0>b&&(b=a.Qa);a=this.$Xd(a).LCID;if(this.w8d(l.substring(Ma.a.CDa(l,b)+1,b)))return null;var x=-1,F=Rb.HyperlinkReader.B_b(f);for(var R=0;R<F.length;R++)if(b>F[R].Kb)x=F[R].Kb;else{if(b>F[R].Qa)return null;break}F=null;R=(R=b)?this.aJc(l,R-1):-1;R<x&&(R=x-1);x=Ma.a.substring(l,
R+1,b);x=x.trimStart();if(1>R)for(let fa=0;fa<this.q1a.length;++fa){const wa=this.q1a[fa];let Xa=l;" "!==c&&(Xa=l+c);if(wa.pattern.exec(Xa))return null}l=l.substring(0,b);if(!this.RFj(l,c.toString(),x,a))return null;x.charAt(0).toUpperCase()!==x.charAt(0)&&(F=ry.BB(f,R+1,b,this.Vg,this.LC,H.a.instance.ga(14),this.QC));return F}H2f(a,b,c){a=nd.SelectionFactory.nj(a,!1);if(!a)return null;a=a.Te;return fb.SelectionEditor.Kg(a)?this.dRi(a,b,c):null}w8d(a){return Ma.a.J7(a)}fVd(a,b,c,f){N.a.mark(4666);
const l=a.node,x=this.$Xd(a).LCID,F=Ya.ParagraphReader.text(l);0>b&&(b=a.Qa);if(c&&!this.e8d(Ma.a.charAt(F,b))||this.w8d(F.substring(Ma.a.CDa(F,b)+1,b)))return N.a.mark(4667),null;a=-1;c=Rb.HyperlinkReader.B_b(l);for(var R=0;R<c.length;R++)if(b>c[R].Kb)a=c[R].Kb;else{if(b>c[R].Qa)return null;break}c=0;R=b;let fa=null;do{R=R?this.aJc(F,R-1):-1;R<a&&(R=a-1);const Xa=Ma.a.substring(F,R+1,b);++c;var wa=this.c3f(Xa,x,this.Dud&&f==w.a.CJa?".":null);if(wa)this.ZQ.ueb&&(fa=us.BB(l,R+1,b,wa,this.Vg));else for(wa=
0;wa<this.q1a.length;++wa){const lb=this.q1a[wa];if(!(!(!(lb.flags&1)||(this.Dud?0>R:1>R))||lb.flags&4&&f!==w.a.aq||lb.flags&2&&f!==w.a.xO)){const Lb=lb.pattern.exec(Xa);if(Lb){fa=lb.Mij(l,R+1,b,Lb,this.Vg,this.Ca);if(fa.commandId!==C.a.ITb&&!this.ZQ.ueb||fa.commandId===C.a.ITb&&!this.ZQ.$hc)fa=null;break}}}}while(0<=R&&R>=a&&!fa&&c<ln.cSg);N.a.mark(4667);return fa}G2f(a,b,c){a=nd.SelectionFactory.nj(a,!1);if(!a)return null;a=a.Te;return fb.SelectionEditor.Kg(a)?this.fVd(a,b,!1,c):null}N2f(a,b){a=
nd.SelectionFactory.nj(a,!1);if(!a)return null;a=a.Te;if(!fb.SelectionEditor.Kg(a)||Rb.HyperlinkReader.Uia(a,!1))return null;var c=Ya.ParagraphReader.text(a.node);const f=0<b?Ma.a.CDa(c,b-1)+1:Ma.a.CDa(c,c.length-1)+1;b=0<b?b:c.length;c=Ma.a.substring(c,f,b);return!c||this.M4e&&!Rb.HyperlinkReader.zae(c)||!Ma.a.J7(c)&&!Ma.a.v3b(c)||!ln.hyperlinkEditor.fOk(a,f,b)?null:this.csc.Axi(a.node,f,b)}R2f(a,b){var c=nd.SelectionFactory.nj(a,!1);if(!c)return null;var f=c.Te;if(!fb.SelectionEditor.Kg(f))return null;
0>b&&(b=f.Qa);var l=Ya.ParagraphReader.text(f.node);c=this.j3f(l,b);const x=ln.bJd.length;for(let F=0;F<x;++F){const R=l.lastIndexOf(Ma.a.charAt(ln.bJd,F),b-1);R>c&&(c=R+1)}l=Ma.a.substring(l,c,b);if(!l)return null;f=this.$Xd(f).LCID;return(new Br(l,f)).HJj()?Tp.BB(a,c,b,this.Vg):null}F2f(a,b){var c=nd.SelectionFactory.nj(a,!1);if(!c)return null;c=c.Te;if(!fb.SelectionEditor.Kg(c))return null;0>b&&(b=c.Qa);var f=Ya.ParagraphReader.text(c.node);c=this.j3f(f,b);f=Ma.a.substring(f,c,b);return f?(f=(new pq(f)).uUi())?
HA.BB(a,c,b,f,this.Vg):null:null}LRi(a,b,c,f,l){var x=nd.SelectionFactory.nj(a,!1);if(!x)return null;x=x.Te;if(c>b||!fb.SelectionEditor.Kg(x))return null;0>b&&(b=x.Qa);if(0>b)return null;x=Ya.ParagraphReader.text(x.node);return Uw.BB(a,c,l,b?x.charAt(b-1):"\x00",this.Vg,f)}yza(a,b,c,f){Array.add(this.q1a,new FF("^"+a+"$",b,c,f))}Mre(a){if(this.zib[this.aoa]){const b=this.zib[this.aoa];for(let c in a)b[c]=a[c]}else this.zib[this.aoa]=a}Nre(a){this.zKb[this.aoa]?Array.addRange(this.zKb[this.aoa],a):
this.zKb[this.aoa]=a}TEe(){this.aoa=-1}$Id(){this.eLi(this.aoa);this.aoa=-1}lTj(a,b){this.zod[b]||(this.zod[b]=!0,this.aoa=b,b=document.createElement("script"),b.type="text/javascript",b.src=a,b.setAttribute("onload","ResetListLcid();"),b.setAttribute("onerror","AutoCorrectRulesFallbackLogic();"),document.body.appendChild(b))}eLi(a){a=lj.l9f(a);0<a&&this.tYb(a)}vTj(){H.a.instance.ga(70)&&(this.tYb(1033),this.yza("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",vl.lP,vl.BB,5),this.yza("(\\d+)[\\.|\\)]",Tw.lP,
Tw.BB,3),this.yza("(L|l|C|c|D|d|M|m){1}\\.",ts.lP,ts.BB,3),this.yza("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",Cn.lP,Cn.BB,11),this.yza("([A-Za-z]){1}[\\.|\\)]",ts.lP,ts.BB,3),this.yza("\\*{1}$|^\\-{1,2}$|^>{1}$|^<>",Zo.lP,Zo.BB,3),this.yza("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",Sw.lP,Sw.BB,0),this.Sqc&&(this.yza("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Bt.lP,Bt.BB,0),this.yza("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Bt.lP,Bt.BB,0)))}tYb(a){this.zod[a]||this.lTj(qy.a.xci(String.format("Acl/Acl{0}.js",
a)),a)}static get hyperlinkEditor(){return ln.Xm||(ln.Xm=hb.a.instance.resolve("Box4.IHyperlinkEditor"))}}ln.RId=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";ln.bJd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";ln.tHe=".!?";ln.cSg=5;ln.Xm=null;Object(e.a)(ln,"AutoCorrectRules",null,[1265]);class IA{constructor(a,b,c,f,l,x){this.eoa=this.xE=null;this.uJ=a;this.Pc=b;this.hd=c;this.mWe=f.ka("AutoCorrectFirstLetterUpperCaseEnabled");this.pWe=
f.ka("AutoFormatOrdinalNumberAndFractionsEnabled");this.k1=f.ka("ReplaceQuoteWithSmartQuoteIsEnabled");this.gaa=l;this.Axa=!!x;this.rs=x;this.gTh=new Tu.a;this.Axa&&this.Pc.XJ(Object(D.a)(this,this.sCb,"onSetSelectionFinished"))}Qmc(a,b,c=-1){if(this.gaa.ueb||this.gaa.$hc)if(b=this.uJ.N2f(a,c)||this.uJ.G2f(a,c,b))this.xE||(this.xE=new Ye),this.xE.xa(b);this.mWe&&this.gaa.nCc&&(b=this.uJ.H2f(a,c," "))&&(this.xE||(this.xE=new Ye),0<this.xE.GDa&&(this.xE.Yqa(0).Iw=!0,b.xBb=!1),this.xE.xa(b));this.pWe&&
(this.gaa.Scd&&4!==Gb.App.mode&&(b=this.uJ.R2f(a,c))&&(this.xE||(this.xE=new Ye),this.xE.xa(b),Z.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created.")),this.gaa.Qcd&&(a=this.uJ.F2f(a,c))&&(this.xE||(this.xE=new Ye),this.xE.xa(a),Z.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created.")))}pRf(a,b,c,f,l,x){const F=new Ye;if(0<b){if(!this.mWe&&this.gaa.ueb){var R=this.uJ.hRi(c,f,l,x);R&&F.xa(R)}else{if(this.gaa.ueb||this.gaa.$hc)if(R=0," "===x?R=w.a.xO:u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertBulletViaKeyboardEnabled",
!1)&&"."===x&&(R=w.a.CJa),R=this.uJ.G2f(a,b,R))R.Iw=!0,F.xa(R);this.gaa.nCc&&(R=this.uJ.H2f(a,b,x))&&(0<F.GDa&&(R.xBb=!1),F.xa(R))}this.pWe&&(this.gaa.Scd&&4!==Gb.App.mode&&(R=this.uJ.R2f(a,b))&&(F.xa(R),Z.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created.")),this.gaa.Qcd&&(R=this.uJ.F2f(a,b))&&(F.xa(R),Z.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created.")))}0<=b&&("'"===x||'"'===x)&&this.k1&&this.gaa.pEe&&(R=this.uJ.LRi(a,b,c,f,x))&&(F.xa(R),Z.ULS.sendTraceTag(37363807,
324,50,"Smart quote action is created."));for(let fa of this.gTh.values)if((R=fa.pRf(a,b,c,f,l,x))&&!R.isEmpty())for(let wa=0;wa<R.GDa;wa++)F.xa(R.Yqa(wa));return F}lre(a,b){return this.uJ.N2f(a,b)}iih(a){this.xE||(this.xE=new Ye);this.xE.xa(a)}VAj(a){if(this.xE){var b=!1;for(var c=0;c<this.xE.GDa;c++){var f=this.xE.Yqa(c);if(!f)return;if(!f.atg){b=!0;break}}if(b){b=this.eoa=null;c=new We.GraphTransaction(15);c.$c=a;a=!1;for(f=0;f<this.xE.GDa;f++){let l=this.xE.Yqa(f);if(!l)return;if(l.atg)continue;
this.Axa&&l.Iw&&l.Sxg&&(b=l);a||(a=!0,c.fd(l.wgg));l.kb=this.Pc.Oa.kb;const x=this.hd.Bp(l.commandId);l.invoke();x.end();this.Pc.setSelection(l.kb)}this.xE=null;this.eoa=b?b.commandId:null;a&&c.dispose()}}}WAj(a){this.eoa=null;const b=new We.GraphTransaction(15);b.fd(a.wgg);b.$c=a.commandId;a.kb=this.Pc.Oa.kb;const c=this.hd.Bp(a.commandId);a.invoke();c.end();this.Pc.setSelection(a.kb);this.Axa&&a.Iw&&a.Sxg&&(this.eoa=a.commandId);b.dispose()}XAj(a){this.eoa=null;return a.invoke()}qrj(){return this.Axa&&
!!this.eoa}Jhk(a){if(!this.Axa||!this.eoa)return!1;const b=this.eoa;this.eoa=null;if(!a||!this.rs.AV||this.rs.ZPd!==b)return!1;this.rs.undo();return!0}sCb(){this.eoa=null}}Object(e.a)(IA,"AutoCorrectScheduler",null,[1264]);class Cr extends ko{constructor(a,b,c,f,l,x){super(a,b,c,f,l);this.Xif=this.b1=null;this.sU=l;this.Wc=x}get z7(){return this.b1||(this.b1=hb.a.instance.pb("Box4.IInternalLinkManager"))}get a5g(){return this.Xif||(this.Xif=hb.a.instance.pb("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get Iw(){return!0}get commandId(){return C.a.UId}T6(a){N.a.mark(7012);
const b=new We.GraphTransaction(15);b.fd(a);var c=this.Rz,f=this.AQ,l=Ya.ParagraphReader.text(a),x=l.substring(c,f);const F=({ucc:R}=Ma.a.wNe(x)).returnValue;x!==F&&(c+=R,f=c+F.length);x=Pc.a.createTextRange(a,c,f);var R=l.substring(c,f);Cr.EHj(l,c,f)&&(this.sU.replaceTextRange(Pc.a.createTextRange(a,c-1,f+1),R,!0,!1),--c,--f,x=Pc.a.createTextRange(a,c,f),c=nd.SelectionFactory.Jg(a,f),ld.a.instance.setSelection(c));c=Rb.HyperlinkReader.YBa(R);Cr.hyperlinkEditor.qha(x,c,!1);l=R="";f=!1;this.z7&&({zbh:R,
KUi:l}=this.z7.Mxh(c,!0)).returnValue&&(c=R,f=!0,R=Rb.HyperlinkReader.FB(x,!1),Cr.hyperlinkEditor.hO(R[0].paragraph,R[0].hyperlink),""!==l&&(this.sU.replaceTextRange(x,l,!0,!1),x=Pc.a.createTextRange(a,this.Rz,this.Rz+l.length),a=nd.SelectionFactory.Jg(a,this.Rz+this.Rz+l.length),ld.a.instance.setSelection(a)),Cr.hyperlinkEditor.qha(x,c,!1));b.dispose();!f&&this.a5g&&this.a5g.qDl(x,c);N.a.mark(7013)}set Iw(a){super.Iw=a}static get hyperlinkEditor(){return Cr.Xm||(Cr.Xm=hb.a.instance.resolve("Box4.IHyperlinkEditor"))}static EHj(a,
b,c){c=c!==a.length&&('"'===a.charAt(c)||"\u201d"===a.charAt(c));return!!b&&('"'===a.charAt(b-1)||"\u201c"===a.charAt(b-1))&&c}}Cr.Xm=null;Object(e.a)(Cr,"HyperlinkAction",ko,[]);class JA{constructor(a,b){this.Vg=a;this.Wc=b}Axi(a,b,c){return new Cr(null,a,b,c,this.Vg,this.Wc)}}Object(e.a)(JA,"Factory",null,[1263]);class KA{constructor(){this.Da=null}get name(){return"Box4.AutoCorrect"}Wb(a){this.Da=a;a.register(ln,"Box4.AutoCorrect.AutoCorrectRules").as("Box4.IAutoCorrectRules").ma().na(()=>new ln(a.resolve("Box4.IHyperlinkActionFactory"),
a.resolve("Box4.ICharacterPropertiesEditor"),Qg.a.instance,u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));a.register(GA,"Box4.AutoCorrect.AutoCorrectOptionsInfo").as("Box4.IAutoCorrectOptionsInfo").ma().na(()=>new GA(a.resolve("Box4.IRoamingServiceRequestManager"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(IA,"Box4.AutoCorrect.AutoCorrectScheduler").as("Box4.IAutoCorrectScheduler").ma().na(()=>
new IA(a.resolve("Box4.IAutoCorrectRules"),ld.a.instance,Sa.a.instance,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.resolve("Box4.IUndoManager"):null));a.register(JA,"Box4.AutoCorrect.HyperlinkAction.Factory").as("Box4.IHyperlinkActionFactory").ma().na(()=>new JA(a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance))}init(){this.Da.resolve("Box4.IAutoCorrectRules").vTj();
const a=u.AFrameworkApplication.fa;a.ka("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.ka("IsRoamingServiceEnabled")&&this.Da.resolve("Box4.IAutoCorrectOptionsInfo").cYi()}dispose(){}static main(){m.a.instance.Ac(new KA)}}Object(e.a)(KA,"Box4AutoCorrectPackage",null,[2,3]);class LA{get name(){return"Box4.Clipboard"}init(){}dispose(){}Wb(){}static main(){m.a.instance.Ac(new LA)}}Object(e.a)(LA,"Box4ClipboardPackage",null,[2,3]);var MA=d(572),Vw=d(487),$o=d(317);class Dr{}Dr.fontSize=0;Dr.bold=
!1;Dr.italic=!1;Dr.spacing=0;Object(e.a)(Dr,"DefaultTextCharPropertyBag",null,[]);class NA{constructor(a,b,c,f,l,x,F,R){this.EWc=[bb.a.fontColor,ub.a.erb];this.c0c=[bb.a.Ni,bb.a.font,ub.a.autonumberBulletType,bb.a.HSa,be.a.FSa];this.k4j=[new Vw.a(ub.a.ZV,ub.a.Nw),new Vw.a(ub.a.mja,ub.a.lca),new Vw.a(ub.a.lja,ub.a.kca)];this.yUa=a;this.DN=b;this.z9b=c;this.kj=f;this.RTa=l;this.g9b=x;this.Mb=F;this.Ea=R}tob(a){return this.$Kd(a,-1)}dCc(a){return this.$Kd(a,1)}$Kd(a,b){return mb.GraphIterator.mba(()=>
this.g9b?Rd.OutlineElementReader.Tg(a)&&!a.z1b(14)&&a.z1b(12)&&!this.sHj(a)&&this.fLf(a,b):Ib.ListReader.ak(a)&&this.fLf(a,b))}sHj(a){return(a=this.Ea.kn(a.currentNode))?a.T2:!1}fLf(a,b){return mb.GraphIterator.mba(()=>{const c=a.currentNode.sa(Bb.a.listLevel,Sg.a.vCa)+b;if(0>c||c>=$o.a.C6||!this.DN.vP(a,c))return!1;this.g9b||(Yb.OutlineElementNavigator.oi(a),Yb.OutlineElementNavigator.Je(a));return!0})}Idb(a,b){this.Z1g(a,b)}gGc(a,b){this.Z1g(a,b)}Z1g(a,b){if(this.$Kd(a,b)&&(this.g9b||Ib.ListReader.ak(a))){var c=
a.zb(2);a.uc();(new mb.GraphIterator).Nc(a);const f=a.currentNode.sa(Bb.a.listLevel,Sg.a.vCa);(0>f||f>=$o.a.C6)&&ya.a.J(8959444,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} is out of bounds",f);(0>f+b||f+b>=$o.a.C6)&&ya.a.J(8959447,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} + depth-{1} is out of bounds",f,b);const l=this.DN.vP(a,f),x=this.DN.vP(a,f+b);if(l&&x){a.currentNode.setValue(Bb.a.listLevel,f+b);c.setValue(Bb.a.listLevel,
f+b);for(b=0;b<c.Ra.length;b++)c.Ra.ga(b).formatting&&c.Ra.ga(b).formatting.J6d();this.O6h(c,l,x);this.G6h(c,l,x);this.L6h(c,l,x);c=a.zb(4);a.uc();c&&this.A6h(c,l,x)}}}G6h(a,b,c){b=c.sa(bb.a.fontSize,Dr.fontSize)-b.sa(bb.a.fontSize,Dr.fontSize);a.Sa(bb.a.fontSize)&&a.setValue(bb.a.fontSize,a.getValue(bb.a.fontSize)+b);for(c=0;c<a.Ra.length;++c){const f=a.Ra.ga(c);f||ya.a.J(8959450,820,10,"OutlineElementIndentationEditor::AdjustFontSizeBasedOnIndentLevel - paraNode.CharacterProperties[{0}] is null",
c);if(f&&f.formatting&&f.formatting.sz&&f.formatting.sz.Sa(bb.a.fontSize)){const l=f.formatting.sz.getValue(bb.a.fontSize);this.kj.yr(f.formatting,l+b)}}this.RTa&&this.RTa.Sa(bb.a.fontSize)&&(a=this.RTa.fontSize(),this.RTa.yr(a+b))}O6h(a,b,c){if(a.Sa(Bb.a.Il)){var f=a.getValue(Bb.a.Il);let l=b.sa(Bb.a.Il,Sg.a.leftMargin),x=c.sa(Bb.a.Il,Sg.a.leftMargin);const F=this.Ea.kn(a);F&&!F.nd&&(l=b.sa(ub.a.fXb,Sg.a.leftMargin),x=c.sa(ub.a.fXb,Sg.a.leftMargin));f=f+x-l;0>f&&a.setValue(Bb.a.Mn,a.sa(Bb.a.Mn,Sg.a.indent)+
f);this.yUa.Tu.wfd(a,1,f)}this.vIc(a,b,Bb.a.Mn)&&this.YPc(a,c,Bb.a.Mn)}L6h(a,b,c){for(const f of this.k4j)this.vIc(a,b,f.first,f.second)&&this.YPc(a,c,f.first,f.second)}A6h(a,b,c){if(this.vIc(a,b,bb.a.Ni,bb.a.font)){if(0===this.z9b.isb(a)&&a.sa(ub.a.autonumberBulletType,8)!==b.sa(ub.a.autonumberBulletType,8))return;if(c.sa(bb.a.Ni,null))this.z9b.bVb(a),a.Nn.apply(a,this.c0c),this.YPc.apply(this,[a,c].concat(this.c0c));else{const f=this.Mb.Kc(a);f.mc(11);f.Ii()}}for(const f of this.EWc)this.vIc(a,
b,f)&&(a.removeProperty(f),this.YPc(a,c,f))}vIc(a,b,...c){for(const f of c)if(a.Sa(f)||b.Sa(f))if(!a.Sa(f)||!b.Sa(f)||!MA.APropertySet.FWa(f.type,a.Sh(f),b.Sh(f)))return!1;return!0}YPc(a,b,...c){for(const f of c)b.Sa(f)&&a.ke(f,b.Sh(f))}}Object(e.a)(NA,"OutlineElementIndentationEditor",null,[1382]);var sy=d(150);class tp{constructor(a,b){this.Lo=this.Wc=this.$s=null;this.Jo=b;tp.Og=a}get ao(){return this.Jo.value}get insertionPointFormatting(){return this.$s||(this.$s=hb.a.instance.pb("Box4.IInsertionPointFormatting"))}get Nf(){return this.Wc||
(this.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get k5(){return this.Lo||(this.Lo=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}X0d(a){const b=a.node;var c=this.insertionPointFormatting?this.insertionPointFormatting.q7f():null;if(c&&!c.equals(Ga.a.nil)){a=b.Ch;if(!a)return null;c=a.re(c);if(!c||c&&1!==Tc.StyleReader.yra(c))return null}else c=tb.a.Bs(a),c=tb.a.Erb(c);return c}Y9(a,b,c){if(Ya.ParagraphReader.Wd(b))if(a)if(Tc.StyleReader.jUc(a))if(2!==
Tc.StyleReader.yra(a))Z.ULS.shipAssertTag(7467991,324,!1);else{var f=Tc.StyleReader.tK(b);if(f){var l=Tc.StyleReader.BP(a);if(!l)Z.ULS.shipAssertTag(7467993,324,!1);else if(f.oG(l)){l=null;this.Nf.Zf&&b.i7();c||(l=this.ao.OHk(l),tp.paragraphEditor.cVb(b,!0));this.nnc(b,f);H.a.instance.ga(61)||(a=f.oG(Tc.StyleReader.BP(a)));b.properties.setValue(kh.a.paragraphStyle,a.id);b.aU=a;for(c=0;c<b.Ra.length;c++)b.Ra.ga(c).formatting&&b.Ra.ga(c).formatting.J6d();tp.MVc.NXb(a)&&(l||(l=new mb.GraphIterator,l.set(b),
l.Ze(),Yb.OutlineElementNavigator.Je(l)),Ib.ListReader.ak(l)||(b.Nn(Bb.a.Il,Bb.a.nva,Bb.a.Mn,Bb.a.NGa,Bb.a.iec,Bb.a.B2g),this.JHd(l,a)))}}else Z.ULS.shipAssertTag(7467992,324,!1)}else Z.ULS.shipAssertTag(7467990,324,!1);else Z.ULS.shipAssertTag(7467989,324,!1);else Z.ULS.shipAssertTag(7467988,324,!1)}JHd(){}ZCc(a,b=!1){let c;c=ph.c(a)?ph.d(a)?Tc.StyleReader.tK(a).oG(Tc.StyleReader.jid):Tc.StyleReader.tK(a).oG(Tc.StyleReader.lid):Tc.StyleReader.tK(a).oG(H.a.instance.ga(61)?Tc.StyleReader.HJa:Tc.StyleReader.Uma);
this.Y9(c,a,b)}fJe(a,b){const c=Tc.StyleReader.tK(b);c&&c.oG(Tc.StyleReader.BP(a))&&(this.nnc(b,c),this.insertionPointFormatting&&(this.insertionPointFormatting.kXa(),this.insertionPointFormatting.vea(a,b)))}nnc(a,b){return(a=tp.Hl.wBb(a))?b.C5k(a):!1}static get paragraphEditor(){return tp.xw||(tp.xw=hb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){tp.xw=a}static get MVc(){return tp.Og||(tp.Og=hb.a.instance.resolve("Box4.List.IListReader"))}static get Hl(){return sy.PageNavigator.instance}}
tp.xw=null;tp.Og=null;Object(e.a)(tp,"StyleEditor",null,[1381]);class Vq{static d2d(){return Vq.HYj}static R0f(a){return new Ga.a(a,1)}static HQf(a){a=a.toString();a=a.split("-")[0]+"-0000-0000-0000-000000000000";return lh.a.Yf(a)}}Vq.HYj=[ub.a.ova,ub.a.cellId,ub.a.rowId,ub.a.shapeId];Object(e.a)(Vq,"TransformHelper",null,[]);class OA{constructor(a,b){this.CWc=new tp(a,b);this.Jz=a;this.DN=b.value}X0d(a){return this.CWc.X0d(a)}fJe(a,b){this.CWc.fJe(a,b)}Y9(a,b){const c=new mb.GraphIterator;c.set(b);
c.uv();c.uc();zm.d(a,c.currentNode,[Bb.a.listLevel]);zm.d(a,b,[bb.a.pl,bb.a.rI,Bb.a.Mn,Bb.a.Il,ub.a.Nw,ub.a.ZV,ub.a.mja,ub.a.lca,ub.a.lja,ub.a.kca]);if(this.Jz.NXb(a)&&!Ib.ListReader.ak(c)){a=uj.a.uAa(a,a);const f=uj.a.kP(a.listType,a.listStyle);f.Yz=a.Yz;a.propertySet.Sa(bb.a.Ni)&&f.propertySet.setValue(bb.a.Ni,a.propertySet.getValue(bb.a.Ni));a.propertySet.Sa(bb.a.font)&&f.propertySet.setValue(bb.a.font,a.propertySet.getValue(bb.a.font));a.propertySet.Sa(ub.a.autonumberBulletType)&&f.propertySet.setValue(ub.a.autonumberBulletType,
a.propertySet.getValue(ub.a.autonumberBulletType));this.DN.V2a(c,f,!1,!1,0);a=c.zb(4);zm.b(b,a,Vq.d2d());c.uc()}}ZCc(a,b=!1){this.CWc.ZCc(a,b)}nnc(a,b){return this.CWc.nnc(a,b)}}Object(e.a)(OA,"StyleEditor",null,[1381]);class PA{constructor(a){this.OGg=a;this.OGg.ppa(Object(D.a)(this,this.YVa,"onBeforeValidatePersistence"))}dispose(){this.OGg.Qhc(Object(D.a)(this,this.YVa,"onBeforeValidatePersistence"))}YVa(a,b){10!==b.node.type&&60!==b.node.type||b.node.nBh()}}Object(e.a)(PA,"LockableGraphNodeEditBehavior",
null,[106]);class QA{constructor(){}KNi(a){const b=a.parentNode.getValue(ub.a.shapeId),c=a.parentNode.getValue(ub.a.ova);let f=null,l=null;const x=Object(va.a)(5,a.currentNode);x&&x.Sr()&&(f=a.parentNode.getValue(ub.a.rowId),l=a.parentNode.getValue(ub.a.cellId));this.MIe(a.currentNode,b,c,f,l)}MIe(a,b,c,f,l){a.ke(ub.a.shapeId,b);a.ke(ub.a.ova,c);l&&(a.ke(ub.a.rowId,f),a.ke(ub.a.cellId,l))}}Object(e.a)(QA,"PptCreateParagraphStrategy",null,[1374]);var lP=d(29);class RA{constructor(a){this.Tw=a;this.Tw.ppa(Object(D.a)(this,
this.YVa,"onBeforeValidatePersistence"))}dispose(){this.Tw.Qhc(Object(D.a)(this,this.YVa,"onBeforeValidatePersistence"))}YVa(a,b){Mc.a.Cb&&(a=Mc.a.Cb,a.Ar&&Mc.a.dea(Mc.a.Cb),b.revisionId&&(b=Mc.a.D6a(b.revisionId.toString()),"ReplicateOutbound"===a.actionName?Z.ULS.sendTraceTag(41714057,305,50,"Refuse to override RevisionId for ReplicateOutbound. RevisionId={0}; StackTrace={1}",b.toString(),lP.Debug.xt()):a.dB(ri.a.uX,b.toString())))}}Object(e.a)(RA,"PresentationNodeEditBehavior",null,[106]);class SA{njc(a,
b,c){let f;({value:f}=a.Of(b)).returnValue||(f=new Ha.a,a.$(b,f));f.add(c)}Skd(a,b,c,f){if(a.count)for(let l of a)l&&l!==Ga.a.nil&&(a=b.xMc(l,Ga.a.nil),a=f.ga(a))&&(b.$(l,a),this.njc(c,a,l))}Pkd(a,b,c){a.Jb(b)&&Ga.a.cP(a.ga(b),c)&&a.remove(b)}}Object(e.a)(SA,"GraphHotColdHelper",null,[1262]);var Wq=d(201),ty;(function(a){a[a.presentation=0]="presentation";a[a.slide=1]="slide";a[a.slideChildren=2]="slideChildren";a[a.shapeLevel=3]="shapeLevel"})(ty||(ty={}));Object(e.b)("GraphNodeModificationType",
ty);class GF{constructor(a,b,c,f,l,x){this.BUa=a;this.Nka=b;this.Kka=c;this.lT=f;this.nQ=l;this.Ska=x;this.p$b=Ga.a.nil}CF(a){return!!a&&(7===a.type||68===a.type)}Zcc(a,b){this.BUa.$(a.id,b);this.Ska.Nse(b)?this.p$b=a.id:this.nQ.njc(this.lT,b,a.id)}eTe(a){if(this.p$b&&this.p$b!==Ga.a.nil){let b;this.nQ.Skd((b=new Ha.a,b.add(this.p$b),b),this.BUa,this.lT,a);this.p$b=Ga.a.nil}}qCb(a,b){this.nQ.Pkd(this.BUa,a,b)}Yra(a){return this.BUa.Jb(a.id)}KV(a){return this.Yra(a)||0<this.Nka.count||0<this.Kka.count}}
Object(e.a)(GF,"PresentationHotColdHandler",null,[1289,1260]);class HF extends Sys.EventArgs{constructor(a,b){super();this.revisionId=a;this.node=b}}Object(e.a)(HF,"RevisionPersistArgs",Sys.EventArgs,[]);var IF=d(881);class JF{constructor(a,b,c,f,l,x,F){this.hua=a;this.Kka=b;this.lT=c;this.nQ=f;this.Ska=l;this.rc=x;this.Ea=F;this.b1c=new Ha.a;this.qFa=new Ha.a}CF(a){return!!a&&(10===a.type||60===a.type||39===a.type)}Zcc(a,b){let c=a;const f=this.rc.Sg(a);60!==a.type&&39!==a.type&&(c=this.Ea.kn(a));
f&&c&&(this.Kka.$(c.id,b),this.hua.$(f.id,b),this.Ska.Nse(b)?(this.b1c.contains(c.id)||this.b1c.add(c.id),this.qFa.contains(f.id)||this.qFa.add(f.id)):(this.nQ.njc(this.lT,b,c.id),this.nQ.njc(this.lT,b,f.id)))}eTe(a){this.nQ.Skd(this.b1c,this.Kka,this.lT,a);this.nQ.Skd(this.qFa,this.hua,this.lT,a);this.b1c.clear();this.qFa.clear()}qCb(a,b){this.nQ.Pkd(this.Kka,a,b);this.nQ.Pkd(this.hua,a,b)}Yra(a){return this.CF(a)&&this.Kka.Jb(a.id)}KV(a){return this.Yra(a)}}Object(e.a)(JF,"ShapeLevelHotColdHandler",
null,[1289,1260]);class KF{constructor(a,b,c,f,l){this.Nka=a;this.hua=b;this.lT=c;this.nQ=f;this.Ska=l;this.qFa=new Ha.a}CF(a){return!!a&&8===a.type}Zcc(a,b){this.Nka.$(a.id,b);this.Ska.Nse(b)&&!this.qFa.contains(a.id)?this.qFa.add(a.id):this.nQ.njc(this.lT,b,a.id)}eTe(a){this.nQ.Skd(this.qFa,this.Nka,this.lT,a);this.qFa.clear()}qCb(a,b){this.nQ.Pkd(this.Nka,a,b)}Yra(a){return this.Nka.Jb(a.id)}KV(a){return this.Yra(a)||this.nDj(a)}nDj(a){return this.hua.Jb(a.id)}}Object(e.a)(KF,"SlideHotColdHandler",
null,[1289,1260]);class uy{constructor(a,b,c,f,l,x,F,R,fa,wa=null,Xa=null,lb=null){this.fl=this.lT=this.Kka=this.hua=this.Nka=this.BUa=null;this.rc=a;this.Ea=b;this.Mc=c;this.Ur=f;this.nQ=l;this.Tw=x;this.hne=!1;this.ZZ=F;this.ta=R;this.Ska=fa;this.Ur.Ozc(Object(D.a)(this,this.f8c,"onRevisionProcessedOnServerHandler"));this.Ur.X5h(Object(D.a)(this,this.e7c,"onGraphNodePersistHandler"));this.Tw.ppa(Object(D.a)(this,this.e7c,"onGraphNodePersistHandler"));this.Mc.tB(Object(D.a)(this,this.VA,"onSessionEnd"));
this.Mc.M2h(Object(D.a)(this,this.dYg,"onFailoverHandler"));this.Mc.uB(Object(D.a)(this,this.jo,"onSessionRehydrated"));this.initialize(wa,Xa,lb);this.KTa=new Me.a}reset(){this.initialize();this.Ur.X9g(new IF.a(null));this.bzh()}initialize(a=null,b=null,c=null){a||this.J6i();this.lT=b||new Me.a;this.fl=c||this.$ha()}dYg(){this.reset()}f8c(a,b){b&&(a=b.P9)&&this.bwe(a)}e7c(a,b){this.Zcc(b.node,b.revisionId)}Zcc(a,b){if(!this.hne&&(a.isDirty||10===a.type||60===a.type||39===a.type))for(const c of this.fl)if(c.CF(a)){c.Zcc(a,
b);this.Ur.oEk(new HF(b,a));break}}bwe(a){const b=Ga.a.Yf(a.Id),c=this.lT.ga(b);if(c&&c.count){for(let f of c)for(const l of this.fl)l.qCb(f,b);this.lT.remove(b);this.Ur.X9g(new IF.a(a));this.bzh()}}RIi(){const a={},b=uy.Byj(a);b(0,this.BUa);b(1,this.Nka);b(2,this.hua);b(3,this.Kka);xa.a.isEmpty(a)||ya.a.J(21112097,811,50,xa.a.toJSON(a))}KV(a){for(const b of this.fl)if(b.CF(a))return b.KV(a);return!1}Yra(a){for(const b of this.fl)if(b.CF(a))return b.Yra(a);return!1}mCh(a){if(0<a.count)for(const b of this.fl)b.eTe(a)}dispose(){this.Mc.gea(Object(D.a)(this,
this.VA,"onSessionEnd"));this.Mc.UOk(Object(D.a)(this,this.dYg,"onFailoverHandler"));this.Tw.Qhc(Object(D.a)(this,this.e7c,"onGraphNodePersistHandler"));this.Ur.qdh(Object(D.a)(this,this.f8c,"onRevisionProcessedOnServerHandler"));this.Ur.VQk(Object(D.a)(this,this.e7c,"onGraphNodePersistHandler"));this.Mc.hea(Object(D.a)(this,this.jo,"onSessionRehydrated"));this.KTa&&0<this.KTa.count&&ya.a.J(22153251,822,15,String.format("Disposed with {0} listening node",this.KTa.count))}VA(){this.hne=!0;this.RIi();
this.reset()}jo(){this.ta.presentation.ZEe();this.reset();this.hne=!1;this.ZZ.mHa(new Ie.a("SessionRehydrated"))}$ha(){return[new JF(this.hua,this.Kka,this.lT,this.nQ,this.Ska,this.rc,this.Ea),new KF(this.Nka,this.hua,this.lT,this.nQ,this.Ska),new GF(this.BUa,this.Nka,this.Kka,this.lT,this.nQ,this.Ska)]}J6i(){this.BUa=new Me.a;this.Nka=new Me.a;this.hua=new Me.a;this.Kka=new Me.a}EXb(a,b){var c=Object(va.a)(500,a);c.Fra+=1;({value:c}=this.KTa.Of(b.id)).returnValue||(c=new Ha.a,this.KTa.add(b.id,c));
c.add(a)}bzh(){if(this.KTa.count&&this.ta.presentation&&this.ta.presentation.Ch){var a=this.ta.presentation.Ch;this.KTa.forEach((b,c)=>{if(!this.Yra(Object(va.a)(9,a.re(b)))){for(let f of c)if(c=Object(va.a)(500,f))--c.Fra,this.Qub(c)&&(this.ZZ.mHa(new Ie.a("SessionRehydrated")),this.Wcd(f));this.KTa.remove(b)}return!0})}}Qub(a){return a?!a.Fra&&!a.Rha:!1}Wcd(a){var b=Object(va.a)(500,a);a&&b&&(b=+new Date-+b.Wpa,12E4<b&&ya.a.J(22153281,822,15,String.format("{0} been blocked {1}",a.type,b)))}static Byj(a){return(b,
c)=>{c=Wq.b(c.values.toArray(),f=>f.toString());c.length&&(a[ty[b]]=c)}}}Object(e.a)(uy,"GraphHotColdManager",null,[1259,1260,106,1261]);class TA{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphEditor"}Wb(a){this.K=a;this.K.register(PA,"PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").ma().na(()=>new PA(this.K.resolve("Box4.Graph.IGraphInstance").DPa));this.K.register(RA,"PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").ma().na(()=>new RA(this.K.resolve("Box4.Graph.IGraphInstance").Bd(7)));
this.K.register(NA,"PowerPointWebEditor.OutlineElementIndentationEditor").as("Box4.IOutlineElementIndentationEditor").na(()=>new NA(this.K.resolve("Box4.IParagraphEditor"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IListInfoHelper"),this.K.resolve("Box4.IFormattingEditor"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").isPromoteDemoteOnParagraphEnabled,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(OA,"PowerPointWebEditor.StyleEditor").as("Box4.Styles.IStyleEditor").ma().na(()=>new OA(this.K.resolve("Box4.List.IListReader"),this.K.Be("Box4.List.IListEditor")));this.K.register(SA,"PowerPointWebEditor.GraphHotColdHelper").as("PowerPointWebEditor.IGraphHotColdHelper").na(()=>new SA);this.K.register(uy,"PowerPointWebEditor.GraphHotColdManager").as("PowerPointWebEditor.IGraphHotColdManager").as("PowerPointWebEditor.IGraphBlockContentHandler").ma().na(()=>
new uy(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdHelper"),a.resolve("Box4.Graph.IGraphInstance").DPa,a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader")));
this.K.register(QA,"PowerPointWebEditor.PptCreateParagraphStrategy").as("Box4.ICreateParagraphStrategy").ma().na(()=>new QA(this.K.resolve("Box4.ITableCellReader")))}init(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior");this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior");this.K.resolve("PowerPointWebEditor.IGraphHotColdManager");this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager").addHandler(this.K.resolve("PowerPointWebEditor.IGraphBlockContentHandler"))}dispose(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").dispose();
this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").dispose()}static main(){m.a.instance.Ac(new TA)}}Object(e.a)(TA,"PPTWebEditorGraphEditorPackage",null,[2,3]);var mP=d(754),vy=d(756),nP=d(755),mo=d(442);const LF=a=>{a.element.style.top=""};var bv=d(765);class MF{constructor(a,b,c){this.n6=!1;this.pKa=0;this.tfa=this.Sff=null;this.AR=a;this.kWh=b;this.Qn=c;this.JO=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.d1=!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.gb.pDa)&&!this.Qn.IGc&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";n.a.$f&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.JO}get visible(){return this.n6}set_visible(a){if(this.n6!==a)return(this.n6=a)?this.LId():this.sXb(),a}dispose(){this.visible&&this.sXb();Ba.a.Xza(this.htmlElement);this.AR=this.JO=null}Oph(a,b){const c=a.htmlElement||a.createElement();b===this.htmlElement.childNodes.length?
this.htmlElement.appendChild(c):this.htmlElement.insertBefore(c,this.htmlElement.childNodes[b]);a.Hfh();this.pKa+=a.htmlElement.clientHeight;var f=this.htmlElement.childNodes,l=a.fEf,x=Object(D.a)(this,this.dhk,"onAfterShowEntry");mo.WacAirSpace.KXa(c,"Shared_BasicClass");var F=new nP.a(c);F.dTb(0,1);const R=new vy.a(c);R.eTb(c.clientTop-30,c.clientTop);l?(mo.WacAirSpace.JVa(F,null,null),mo.WacAirSpace.JVa(R,null,x)):(mo.WacAirSpace.animate(F,null,null),mo.WacAirSpace.animate(R,null,x));for(b+=1;b<
f.length;b++)x=f[b],mo.WacAirSpace.KXa(x,"Shared_BasicClass"),F=new vy.a(x),F.eTb(x.clientTop-c.clientHeight,x.clientTop),l?mo.WacAirSpace.JVa(F,null,null):mo.WacAirSpace.animate(F,null,null);a.kbl();this.set_visible(!0)}Jjg(a){const b=a.htmlElement;if(Ba.a.HRa(b)){this.pKa-=a.htmlElement.clientHeight;var c=b.parentNode.children;a=a.fEf;var f=Object(D.a)(this,this.Zgk,"onAfterHideEntry");mo.WacAirSpace.KXa(b,"Shared_BasicClass");var l=new mP.a(b);l.dTb(1,0);a?mo.WacAirSpace.JVa(l,null,f):mo.WacAirSpace.animate(l,
null,f);f=!1;for(l=0;l<c.length;l++){if(f){const x=c[l];mo.WacAirSpace.KXa(x,"Shared_BasicClass");const F=new vy.a(x);F.eTb(x.clientTop,-b.clientHeight);a?mo.WacAirSpace.JVa(F,null,LF):mo.WacAirSpace.animate(F,null,LF)}f||c[l]!==b||(f=!0)}}}dhk(a){a.element.style.top="";u.AFrameworkApplication.Aa.yq()}Zgk(a){a.element.parentNode.removeChild(a.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);u.AFrameworkApplication.Aa.yq()}LId(){""===this.AR.style.top.trim()&&(this.AR.style.top=this.AR.offsetTop+
"px");this.htmlElement.style.left=this.AR.style.left;this.htmlElement.style.top=this.AR.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.Sff=this.AR.style.top;this.pKa=a.height;this.Mld();u.AFrameworkApplication.Aa.Lga(Object(D.a)(this,this.onResize,"onResize"));yd.a.addHandler(this.htmlElement,qa.a.Ced,yd.a.uob);this.tfa=Object(D.a)(this,this.zB,"contextMenuHandler");u.AFrameworkApplication.Aa.g$.ob(this.htmlElement,
this.tfa,null);if(v.FocusManager.XL()){var b=v.FocusManager.instance();a=b.Bc(bv.a.n3a);a.parent=y.AFrame.gj;const c=new nu.DOMFocusListing(()=>this.htmlElement);c.mo(1);c.mo(2);c.mo(8);b.aha(()=>this.htmlElement,a,c);b=b.zP(bv.a.n3a);b.ieb();b.cW=!0;b.PNa=!0;const f=u.AFrameworkApplication.Aa.mw;a.G2a(()=>{f.qo(bv.a.n3a)});f.jpa(bv.a.n3a);(c.Qha||u.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled"))&&f.TJ(bv.a.n3a)}}sXb(){this.sph()&&(this.AR.style.top=this.Sff);this.htmlElement.style.visibility=
"hidden";u.AFrameworkApplication.Aa&&(v.FocusManager.XL()&&v.FocusManager.instance().zEb(bv.a.n3a),this.tfa&&(u.AFrameworkApplication.Aa.g$.xb(this.htmlElement,this.tfa),this.tfa=null));yd.a.removeHandler(this.htmlElement,qa.a.Ced,yd.a.uob)}Mld(){if(this.sph()&&this.visible){var a=this.AR,b=this.pKa+this.kWh;const c=Ba.a.yL(a.style.top);mo.WacAirSpace.KXa(a,"Shared_BasicClass");a=new vy.a(a);a.eTb(c,b);mo.WacAirSpace.animate(a,null,null)}}sph(){return!this.d1&&!this.Qn.IGc}onResize(){const a=this.Qn.entries.length,
b=Sys.UI.DomElement.getBounds(this.htmlElement).height;let c;for(let f=0;f<a;++f)c=this.Qn.entries[f],c.htmlElement&&c.Hfh();this.pKa=Sys.UI.DomElement.getBounds(this.htmlElement).height;b!==this.pKa&&this.Mld()}zB(){return!0}}Object(e.a)(MF,"BusinessBarDom",null,[804,106]);var Ct;(function(a){a[a.none=0]="none";a[a.corruptPage=1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]=
"fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=
17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=
27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=32]="citationStylePrompt";a[a.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=
36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=43]="testEntry4";a[a.testEntry5=44]="testEntry5";a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(Ct||(Ct={}));Object(e.b)("BusinessBarId",Ct);class qq{constructor(a,b=0,c=null,f=null){this.p$e=this.V_e=!1;this.alb=null;
this.GO=[];this.Fxa=f||new MF(a,b,this);this.Wxj(c)}Wxj(a){if(a){this.alb={};a=a.ranking;for(let b=0;b<a.length;b++)this.alb[Ct[a[b]]]=b}}dispose(){this.Fxa.dispose();Wn.a.hed(this.GO);this.GO=null}get htmlElement(){return this.Fxa.htmlElement}get visible(){return this.Fxa.visible}get IGc(){return this.V_e}set IGc(a){this.V_e=a}get i$d(){return this.p$e}set i$d(a){this.p$e=a}get entries(){return this.GO}set entries(a){this.GO=a}Yba(a){for(let b=0;b<this.GO.length;b++)if(this.GO[b].id===a)return!0;
return!1}Rh(a,b=!1,c=null){a.businessBar=this;let f=this.J4i(a.id);b&&!this.alb&&(f=0);f<qq.dcb&&(this.Fxa.Oph(a,f),this.GO.length>=qq.dcb&&this.Fxa.Jjg(this.GO[qq.dcb-1]),this.Fxa.Mld());Array.insert(this.GO,f,a);Z.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Ct[a.id],void 0===a.iAa||null===a.iAa?"":a.iAa);a.errorCode&&u.AFrameworkApplication.Xo(a.errorCode,c,null,null)}removeEntry(a){const b=Array.indexOf(this.GO,a);-1!==b&&b<qq.dcb&&(this.GO.length>qq.dcb&&
this.Fxa.Oph(this.GO[qq.dcb],qq.dcb),this.Fxa.Jjg(a),this.Fxa.Mld());Array.remove(this.GO,a);a.businessBar=null;a.dispose()}J4i(a){if(!this.alb||0===a)return this.GO.length;a=this.alb[Ct[a]];if(void 0===a||null===a)return this.GO.length;for(let b=0;b<this.GO.length;b++)if(a<this.alb[Ct[this.GO[b].id]])return b;return this.GO.length}}qq.dcb=2;Object(e.a)(qq,"BusinessBar",null,[768,106,769]);class UA{constructor(a){this.BFc=null;this.PVg=a.Ha("OfficeOnlineChromeExtensionId");this.YVg=a.Ha("ChromeClipboardAccessExtensionId");
this.YCj=a.ka("OfficeOnlineChromeExtensionIsEnabled");this.fuf=!this.vJj();this.BFc=this.owa?this.YVg:this.PVg}xLc(){return this.BFc}QEe(){this.BFc===this.PVg&&this.pug&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.BFc=this.YVg;this.fuf=!0}get owa(){return this.fuf}vJj(){if(this.YCj&&this.pug){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&
"true"===a}return!1}get pug(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(b){Z.ULS.sendTraceTag(19452045,307,50,b.toString())}return a}}Object(e.a)(UA,"ChromeExtensionHelper",null,[1143]);class NF{constructor(a=null,b=null,c=null){this.l$=a||{};this.Fxh=b||[];this.Wol=c||{}}}Object(e.a)(NF,"RibbonTrimmingProperties",
null,[]);var oP=d(447);class OF{create(a,b,c){return new oP.a(a,b,c)}}Object(e.a)(OF,"Factory",null,[803]);class PF{constructor(){u.AFrameworkApplication.Ta.xa(G.a.rzg,de.a.frame,Object(D.a)(this,this.bHk,"reactFileMenuOpenFromTellMe"))}bHk(a,b,c,f,l){if(1===c||!l)return 32;a=l.SourceControlId;17!==l.UILocation||"New"!==a&&"Open"!==a||(l=[],Ag.d("setFileMenuSelectedPage")&&("New"===a&&u.AFrameworkApplication.Aa?2===u.AFrameworkApplication.Aa.gb.Am?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
l.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===a&&u.AFrameworkApplication.Aa&&(2===u.AFrameworkApplication.Aa.gb.Am?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),l.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(l));return 32}IRj(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}}Object(e.a)(PF,"ReactFileMenu",null,[1403]);class QF{createFileMenu(){const a=
new PF,b=[];b.push(appChrome.actions.updateFileMenuExpandedValue(!1));b.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(b);return a}}Object(e.a)(QF,"ReactFileMenuFactory",null,[1385]);var ai=d(523);class RF{constructor(a,b,c,f,l,x,F){this.FEa=!1;this.Fz=null;this.$ja=this.r3c=this.dUa=!1;this.Rxb="Edit";this.cOg=!1;this.hc=f;this.ia=a;this.dv=b;this.Nb=l;this.tm=F;this.Nb.vM(Object(D.a)(this,this.k5c,"modeSwitched"));this.Ga=c;this.ub()}ub(){this.ia.xa(ba.a.fdk,de.a.frame,
Object(D.a)(this,this.gdk,"modeSwitcherHandler"));this.ia.xa(ba.a.Fid,de.a.frame,Object(D.a)(this,this.Fid,"switchToDocumentEditMode"));this.ia.xa(ba.a.tlc,de.a.frame,Object(D.a)(this,this.tlc,"switchToEmergencyViewMode"));this.ia.xa(ba.a.Gid,de.a.frame,Object(D.a)(this,this.Gid,"switchToDocumentViewMode"));this.ia.pa(ba.a.N8g,de.a.frame,Object(D.a)(this,this.U7g,"queryDocumentModeSwitchMenuItem"),96);this.ia.pa(ba.a.O8g,de.a.frame,Object(D.a)(this,this.U7g,"queryDocumentModeSwitchMenuItem"),96);
this.ia.xa(ba.a.NAa,fc.a.application,Object(D.a)(this,this.NAa,"displayCallout"));this.ia.xa(G.a.cuh,de.a.frame,Object(D.a)(this,this.Hil,"switchFromViewModeToEditMode"))}dispose(){this.Nb.rX(Object(D.a)(this,this.k5c,"modeSwitched"))}we(){}gdk(){return 32}Gid(a,b,c){if(1===c||"View"===this.c6a())return 32;this.dv.iuh();this.Red("View");this.r3c=!0;return 32}Fid(a,b,c){if(u.AFrameworkApplication.UP)return 8;a=this.c6a();if(1===c){if("Edit"===a||this.FEa||this.r3c||this.dUa&&this.hc.getState(1))return 32;
Z.ULS.sendTraceTag(512500510,306,10,"ModeSwitcherControlActor:SwitchToDocumentEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;this.dv.r6k();c=this.dUa?this.ia.Ka(ba.a.VXb,2,20):this.ia.processAction(ba.a.X0b,2);this.FEa=this.dUa=this.r3c=!1;this.Red("Edit");return c}Hil(a,b,c){if(u.AFrameworkApplication.UP)return 8;a=this.c6a();if(1===c){if("Edit"===a||this.FEa||this.r3c||this.dUa&&this.hc.getState(1))return 32;Z.ULS.sendTraceTag(512500509,306,10,"ModeSwitcherControlActor:SwitchFromViewModeToEditMode:: DocModeSwitcher Editing Option Disabled");
return 8}if("Edit"===a)return 32;if(2!==c)return Z.ULS.sendTraceTag(512500508,306,15,String.format("Unexpected ActionBehavior {0} for switching to edit mode",c)),2;this.ia.Ka(ba.a.refresh,2,{refreshtrigger:"SwitchFromViewModeToEditMode"});return 32}tlc(a,b,c){if(1===c)return 32;this.FEa=!0;return this.initialize()}U7g(a,b,c,f,l){b=this.c6a();l[ai.a.On]=a===ba.a.N8g&&"Edit"===b||a===ba.a.O8g&&"View"===b?!0:!1;return 32}NAa(a,b,c,f,l){if(!l||!Object(Fa.a)(Vj,l))return 8;this.Fz=l;this.initialize();
this.tm&&!this.cOg&&"View"===this.Rxb&&(this.tm.OQe(),this.cOg=!0);return this.initialize()}initialize(){if(!Ag.c())return Z.ULS.sendTraceTag(512500507,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - AppChrome Actions being Null"),8;this.Rxb=this.C$f();!this.$ja&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.c6a()!==this.Rxb&&Z.ULS.sendTraceTag(512500506,306,50,"ModeSwitcher was initially rendered in the incorrect mode. Expected: {0}, Actual: {1}",
this.Rxb,this.c6a());var a=this.Fz?this.Fz.u3b||this.Fz.y3b:!1,b=this.Fz?this.Fz.PRa:this.hc.getState(16);this.dUa=this.Fz?this.Fz.r9d:this.hc.getState(524288);var c=this.Fz?this.Fz.k7a:this.hc.getState(1);const f=this.FEa||a||this.dUa||b||!c,l={hidden:!1};l.hasEditPermission=c;l.activeMode=this.Rxb;l.isMarkedAsFinal=b;l.isMarkedAsOpenReadOnly=this.dUa;l.isReviewer=!1;l.isServiceDefaultedToView=this.FEa||a;l.forceShowNotificationByExternalTrigger=this.Fz&&this.Fz.VRc?!this.Fz.VRc:f;a&&(a={},c={},
c.title=ResourceStrings.L_BizBarTitle_Readonly,this.Fz.u3b?c.text=ResourceStrings.L_BizBarMessage_PasswordProtected:this.Fz.y3b&&(c.text=ResourceStrings.L_BizBarMessage_FileFormatNotEditable),c.confirmationButtonText=ResourceStrings.L_InsertTableDialogButtonText,c.icon="pptEditorSprite.CancelGlyph_16",c.label=ResourceStrings.L_Close,a.serviceDefaultedToViewCallout=c,l.notificationCalloutProps=a);a=appChrome.actions.updateModeSwitcher(l);if(!a)return Z.ULS.sendTraceTag(512500505,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - Redux Action being Null"),
8;Z.ULS.sendTraceTag(512500504,306,50,"ModeSwitcherControlActor:Initialize:: Dispatching Mode switcher action. ActionDataAvailable:{0}, HasEditPerm: {1}, Mode:{2}, MarkedFinal: {3}, MarkedOpenRO: {4}, EditProtected: {5}, FormatUnsupported: {6}, EmergencyMode: {7}, InReadingMode: {8}",!!this.Fz,l.hasEditPermission,this.Rxb,b,this.dUa,!!this.Fz&&this.Fz.u3b,!!this.Fz&&this.Fz.y3b,this.FEa,this.Wqg());b=this.ARd(a);this.$ja=!0;return b}ARd(a){if(appChrome.api)return appChrome.api.dispatch(a),32;Z.ULS.sendTraceTag(512500503,
306,10,"ModeSwitcherControlActor:DispatchAction:: Failed to Initialize DocModeSwitcher - PPT App Chrome API being Null");return 8}Wqg(){return!!u.AFrameworkApplication.Aa&&1===u.AFrameworkApplication.Aa.mode}C$f(){return this.Fz?this.FEa||this.Fz.PRa||this.Fz.r9d||this.Fz.u3b||this.Fz.y3b||this.Fz.VRc?"View":this.Fz.k7a?"Edit":"View":this.FEa||this.Wqg()?"View":"Edit"}c6a(){if(Ag.c())switch(appChrome.selectors.getModeSwitcherMode()){case null:case "Edit":break;case "View":return"View";default:Z.ULS.sendTraceTag(512500502,
306,15,"ModeSwitcherControlActor:GetCurrentDocumentMode:: ModeSwitcher Actor received an invalid active mode from the control.")}return"Edit"}Red(a){if(Ag.c()&&this.c6a()!==a){var b={};b.activeMode=a;Z.ULS.sendTraceTag(512500501,306,50,"ModeSwitcherControlActor:SendUpdateModeReduxAction:: ModeSwitcher control switching to mode {0}",a);a=appChrome.actions.updateModeSwitcher(b);this.ARd(a)}}k5c(a){this.$ja&&(1===a.mode?this.Red("View"):2===a.mode&&this.Red("Edit"))}gRk(){const a={hidden:!1};a.activeMode=
this.C$f();this.ARd(appChrome.actions.updateModeSwitcher(a))}}Object(e.a)(RF,"ModeSwitcherControlActor",null,[1192]);var SF=d(248);class VA{constructor(a,b,c,f){this.jza=this.N1e=this.Qkb=this.B_e=this.uKa=this.MYe=null;this.Txf=!1;this.Qn=a;this.dY=b;this.Ca=c;this.jb=f}Kuk(){this.QUb();this.RUb();this.xli()}QUb(){const a=Gb.App.Fb.Ed.zi;a&&(this.MYe=this.Nld(this.MYe,1,2===Gb.App.Fb.mode&&a.uRc,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get jPj(){if(!Gb.App.iAh)return!1;n.a.PV&&
u.AFrameworkApplication.Qj("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled");return n.a.xj}xli(){this.jPj&&!this.Qkb&&(this.Qkb=this.dY.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.Qkb.id=15,this.Qkb.closeable=!0,this.Qkb.addButton(Box4Intl.Box4Strings.L_DownloadNow,I.AppFrame.Asl,""),If.a("NewBrowserSuggestionShown"),this.Qn.Rh(this.Qkb,!1))}RUb(){let a=null;const b=Gb.App.Fb.Ed.vaa;if(b){const c=b.Xdc;SF.a.f3b(c)?22===c?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:
19===c||20===c?a=n.a.Ki?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===c?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===c?a=n.a.Ki?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===c&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):2!==Gb.App.Fb.mode||SF.a.WOc(b.mSb)||Gb.App.w4b||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.N1e=this.Nld(this.N1e,5,!!a,a)}s6k(a){!!this.jza===
a||this.Txf||(a?(this.jza=this.dY.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,null),this.jza.id=13,this.jza.closeable=!0,this.jza.I1=()=>{this.Txf=!0;this.jza=null},this.Qn.Rh(this.jza)):(this.Qn.removeEntry(this.jza),this.jza=null))}Uph(a,b,c,f){a=this.dY.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.dBf(b,()=>{kb.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+c)});f&&(a.I1=f);this.Qn.Rh(a,!0)}Dbl(a,b,c){this.Uph(a,b,c,null)}abl(a){a=this.dY.create(null,
a,null);a.closeable=!0;a.id=24;a.image=1;this.Qn.Rh(a,!0)}Pbl(a){a=this.dY.create(null,a,null);a.closeable=!0;a.id=20;this.Qn.Rh(a)}gbl(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.uKa||(this.uKa=this.dY.create(a,b,null),this.uKa.closeable=!0,this.uKa.id=27,this.Qn.Rh(this.uKa))}Vrj(){this.uKa&&(this.uKa=this.Nld(this.uKa,27,!1,""))}iLe(a){this.B_e=this.Nld(this.B_e,30,!0,a)}Nld(a,b,c,f){c?a?a.message=f:(a=this.dY.create("",
f,null),a.id=b,a.closeable=!1,this.Qn.Rh(a,!1)):a&&(this.Qn.removeEntry(a),a=null);return a}}Object(e.a)(VA,"BusinessBarController",null,[1384]);class WA extends VA{constructor(a,b,c,f,l,x,F,R){super(a,b,f,x);this.Mce=this.dHg=!1;this.L$b=[];this.uwb=0;this.qoe=null;this.Gce=c;this.ia=f;this.p8=l;this.Fa=F;this.CD=R.XCa;this.FMg=R.powerPointDragInsertMultipleImageQuantityLimit}initialize(){this.Gce.vM(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"))}dispose(){this.Gce.rX(Object(D.a)(this,this.$v,
"onAppFrameModeSwitched"))}Lu(a,...b){this.AXb.apply(this,[a,this.p8.RMc(a),this.p8.E1d(a),this.p8.a_d(a)].concat(b))}AXb(a,b,c,f){0===a||this.qoe||(c=this.dY.create(c,f||"",null),c.closeable=!0,c.errorCode=uf.a.Mh(a),c.I1=Object(D.a)(this,this.AMi,"errorEntryClosedHandler"),a=!!(b&8),b=!!(b&4),a&&c.addButton(ResourceStrings.L_Refresh,Object(D.a)(this,this.Sbd,"refreshActionHandler"),""),b&&(a?c.PFd(ResourceStrings.L_OpenInPowerPoint,Object(D.a)(this,this.M8c,"openInClientActionHandler")):c.addButton(ResourceStrings.L_OpenInPowerPoint,
Object(D.a)(this,this.M8c,"openInClientActionHandler"),"")),this.qoe=c,this.vSb(c))}MM(a){var b="";let c="",f=null,l="",x=null;var F=!1;switch(a){case 0:b=ResourceStrings.L_BizBarTitle_MarkedAsFinal;a=ResourceStrings.L_BizBarMessage_MarkedAsFinal;F=!0;break;case 20:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;F=!0;break;case 1:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_EditPermissionDenied;F=!0;break;case 2:b=
ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatNotEditable;F=!0;break;case 3:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditCheckedOutByAnother;F=!0;break;case 4:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_RequiresCheckout;F=!0;break;case 5:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_LockedForOfflineCheckout;F=!0;break;case 6:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditLock;F=!0;break;case 7:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditSharedLock;F=!0;break;case 8:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_NumberOfCoauthorsReachedMax;F=!0;break;case 9:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditExistingExclusiveLock;F=!0;break;case 10:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatConvertible;
c=ResourceStrings.L_BizBarButton_Convert;f=Object(D.a)(this,this.Fti,"convertActionHandler");F=!0;break;case 11:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PasswordProtected;F=!0;break;case 12:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FontRestricted;F=!0;break;case 13:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_SessionRestricted;F=!0;break;case 14:b=u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle?
u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle:"";a=u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription?u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription:"";F=!0;break;case 15:b=ResourceStrings.L_BizBarTitle_SessionExpired;a=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;F=!0;break;case 18:b=ResourceStrings.L_BizBarTitle_DragDropNotSupportFormat;a=ResourceStrings.L_BizBarMessage_DragDropNotSupportFormat;F=!1;break;case 19:b=String.format(ResourceStrings.L_BizBarTitle_DragDropMoreFilesThanLimite,
this.FMg);a=String.format(ResourceStrings.L_BizBarMessage_DragDropMoreFilesThanLimite,this.FMg);F=!1;break;case 22:b=ResourceStrings.L_BizBarTitle_Readonly;a=this.ebj();F=!1;a&&(this.uwb=a,a=this.ia.Ka(ba.a.kFb,1,this.uwb),8!==a&&16!==a&&(F=!0,c=ResourceStrings.L_BizBarInlineRepairSaveAsText,f=Object(D.a)(this,this.ORk,"repairSaveCopyHandler")));32===this.ia.processAction(ba.a.aic,1)&&(F?(l=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,x=Object(D.a)(this,this.neh,"replaceOriginalFileHandler")):
(F=!0,c=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,f=Object(D.a)(this,this.neh,"replaceOriginalFileHandler")));a=F?ResourceStrings.L_BizBarInlineRepairWithSaveMessage:ResourceStrings.L_BizBarInlineRepairWithoutSaveMessage;F=!0;break;case 23:b=ResourceStrings.L_BizBarTitle_ViewOnly;a=ResourceStrings.L_BizBarEmergencyViewingModeMessage2;c=ResourceStrings.L_BizBarEmergencyViewingModeEditButton;f=Object(D.a)(this,this.Aij,"goToEditModeHandler");F=!0;break;case 24:b=ResourceStrings.L_BizBarTitle_MinorVersionLimitReached;
a=ResourceStrings.L_BizBarInlineMinorVersionLimitReached;c=ResourceStrings.L_LearnMore;f=Object(D.a)(this,this.Hqk,"openVersioningPageHandler");break;case 25:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_UserNetworkLocationUnauthorized;break;case 26:a=ResourceStrings.L_BizBarMessage_CannotCropCurrentSelection;F=!1;break;default:return}b=this.dY.create(b,a,null);b.image=3;b.closeable=!0;b.I1=F?Object(D.a)(this,this.O$g,"readOnlyInfoEntryClosedHandler"):Object(D.a)(this,
this.Clg,"infoEntryClosedHandler");f&&b.addButton(c,f,"");x&&b.PFd(l,x);this.vSb(b);F&&Array.add(this.L$b,b)}OAa(a){let b;switch(a){case 22:var c=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;b=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}c=this.dY.create(c,b,null);c.id=a;c.image=1;c.closeable=!0;this.vSb(c)}GGc(a,b){let c,f=!1,l=!1,x=!1,
F=!1;switch(a){case 1:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.L_BizBarMessage_EditPermissionDenied;b=1;break;case 0:a=ResourceStrings.L_BizBarTitle_MarkedAsFinal;c=b?ResourceStrings.L_BizBarMessage_MarkedAsFinal_DocIsEdited:ResourceStrings.L_BizBarMessage_MarkedAsFinal;l=b;b=1;break;case 20:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;x=!0;b=3;break;case 16:a=ResourceStrings.L_BizBarTitle_CannotConnectToInternet;c=ResourceStrings.L_BizBarMessage_CannotConnectToInternet;
f=!0;b=1;break;case 17:a=b?ResourceStrings.L_BizBarTitle_ChangesCannotBeSavedInThisFile:ResourceStrings.L_BizBarTitle_Readonly;c=b?ResourceStrings.L_BizBarMessage_ServerError_UserHasEditedDoc_Download:ResourceStrings.L_BizBarMessage_ServerError_UserNotEditedDoc;F=b;b=1;break;case 15:a=ResourceStrings.L_BizBarTitle_SessionExpired;c=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;f=!0;b=1;break;case 21:a=ResourceStrings.L_BizBarTitle_WopiTokenOutOfRefreshRange;c=ResourceStrings.L_BizBarMessage_WopiTokenOutOfRefreshRange;
f=!0;b=1;break;default:return}a=this.dY.create(a,c||"",null);a.closeable=!0;a.I1=Object(D.a)(this,this.O$g,"readOnlyInfoEntryClosedHandler");a.image=b;f?(ya.a.J(37520129,801,15,"Refresh button is show"),a.addButton(ResourceStrings.L_Refresh,Object(D.a)(this,this.Sbd,"refreshActionHandler"),"")):l?(ya.a.J(37520131,801,15,"SaveACopy button is show"),a.addButton(ResourceStrings.L_BizBarButton_SaveACopy,Object(D.a)(this,this.dXk,"saveAsActionHandler"),"")):F?(ya.a.J(39978897,801,15,"DownloadACopy button is show"),
a.addButton(ResourceStrings.L_DownloadCopy,Object(D.a)(this,this.jIi,"downloadACopyActionHandler"),"")):x&&(ya.a.J(38290691,801,15,"EditAnyway button is show"),a.addButton(ResourceStrings.l_BizBarButton_EditAnyway,Object(D.a)(this,this.XIi,"editAnywayActionHandler"),""));this.vSb(a);Array.add(this.L$b,a)}Yba(a){return this.Qn.Yba(a)}ebj(){let a=0;if(this.jb.ka("IsUIEmbedMode")||this.jb.ka("DisablePrint")||!this.jb.Ha("DownloadACopyUrl")||"true"===this.jb.Ha("ProtectInClient")||n.a.Ki)return a;let b=
!0;this.jb.ka("SaveToAnotherFolderBrsIsEnabled")&&this.jb.ka("SupportsGetMoreInfoForPersonalStorage")||(b=!1);let c=!0;this.jb.ka("SaveACopyBrsIsEnabled")||(c=!1);let f=!0;this.jb.ka("SaveAsToHostBrsIsEnabled")&&this.jb.ka("UserCanWriteRelative")&&this.jb.ka("SupportsEditing")||(f=!1);a=b?G.a.Ueb:c?G.a.Qic:a;ya.a.J(50370196,801,(b||c)&&(b||f)&&(c||f)?15:50,"BusinessBarController::GetSaveAsCommand saveToSharePoint:{0}, saveACopy:{1}, saveAsToHost:{2}, CommandName: {3} ",b,c,f,a);return a}vSb(a){const b=
this.Qn.visible;this.Qn.Rh(a);b||this.Fa.Gj(xi.a.hKd,!0)}Sbd(a){ya.a.J(37310492,801,15,"Refresh button is clicked, ErrorCode:{0}",a.errorCode);this.ia.processAction(ba.a.refresh,2)}Clg(){this.Qn.entries.length||this.Fa.Gj(xi.a.hKd,!1)}AMi(){this.qoe=null;this.Qn.entries.length||this.Fa.Gj(xi.a.hKd,!1)}O$g(a){Array.remove(this.L$b,a);this.Clg(a);ya.a.J(38290694,801,50,"Read-only info entry is closed")}M8c(){this.ia.Ka(ba.a.openInClient,2,!0)}Fti(){this.ia.Ka(ba.a.convertAndEdit,2,!1)}ORk(){u.AFrameworkApplication.XI?
this.TLe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.Ka(ba.a.kFb,2,this.uwb)}neh(){this.ia.processAction(ba.a.aic,2)}Aij(){this.ia.processAction(ba.a.X0b,2)}dXk(){ya.a.J(37310494,801,15,"SaveACopy button is clicked");u.AFrameworkApplication.XI?this.TLe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.Ka(G.a.Ueb,2,!0)}jIi(){ya.a.J(39978903,801,15,"DownloadACopy button is clicked");u.AFrameworkApplication.XI?this.TLe(CommonUIStrings.l_SensitivityDownloadDocumentError):this.ia.Ka(G.a.downloadACopy,
2,!0)}TLe(a){ya.a.J(50922395,801,50,"Unable to save/download ppt from business bar as document is protected");const b=new rj.StandardDialog;b.vd=0;b.Vx(uf.a.VHi,dk.a.g2(ResourceStrings.l_GenericDialogTitle),dk.a.g2(a),null)}XIi(){ya.a.J(38290697,801,50,"EditAnyway button is clicked");this.ia.Ka(ba.a.VXb,2,20)}Hqk(){ya.a.J(558470216,801,50,"Learn More button is clicked");Ah.Redirect.showHelp("0f6cd105-974f-44a4-aadb-43ac5bdfd247")}ILd(){if(this.Gce.i7a&&!this.Mce&&!this.dHg){this.Mce=!0;var a=this.dY.create("",
CommonUIStrings.l_OdfFileCompatWarningBusinessBar,null);a.closeable=!0;a.I1=()=>{this.dHg=!0;this.Mce=!1};a.addButton(CommonUIStrings.l_OdfFileCompatWarningBusinessBarButton,Object(D.a)(this,this.xik,"onCompatWarningButtonClick"),"");this.vSb(a)}}xik(){Ah.Redirect.showHelp("PPTODF")}WWf(){for(const a of this.L$b)this.Qn.removeEntry(a);Array.clear(this.L$b)}$v(a){this.CD&&2===a.mode&&this.WWf()}}Object(e.a)(WA,"BusinessBarController",VA,[1383,1384,106]);class TF{constructor(a,b,c,f){this.eTa=null;
this.D3c=b;this.S6j=c;this.vb=document.createElement("div");this.vb.className="BusinessBarPanel";this.vb.id="BusinessBarPanel";this.h_=f;this.wbc=document.createElement("div");this.wbc.id="BusinessBarPanelWorking";this.vb.insertBefore(this.wbc,this.vb.firstChild);a.execute(l=>{this.eTa=l;this.S6j&&this.eTa&&(this.eTa.IGc=!0);this.wbc.insertBefore(this.eTa.htmlElement,this.wbc.firstChild)});if(this.h_||this.D3c)this.vb.style.position=Ve.a.llc}dispose(){}layout(a,b){if(!this.eTa||!this.eTa.visible)return this.Ds(),
a;this.RGi(b);if(this.D3c||this.h_)return this.vb.style.height=Xe.a.Lc(this.eTa.htmlElement.offsetHeight),a;b=a.Yfl(this.eTa.htmlElement.offsetHeight);Xe.a.zX(this.vb,b);return a}Ds(){"none"!==this.vb.style.display&&(this.vb.style.display="none")}RGi(a){this.vb.style.display.length&&(this.vb.style.display="");a&&(this.vb.style.direction=Ve.a.FYa)}get ya(){return this.vb}get tBl(){return this.wbc}get order(){return 2}}Object(e.a)(TF,"BusinessBarPane",null,[1196,481,106]);var Ww=d(560);class ap{}ap.Value=
"value";ap.MinValue="MinValue";ap.MaxValue="MaxValue";ap.Text="Text";Object(e.a)(ap,"SliderCommandProperties",null,[]);var Up=d(1081);class rq{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(e.a)(rq,"CommonOptionalButtonProperties",null,[]);class cv extends rq{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(e.a)(cv,
"OptionalButtonProperties",rq,[]);class UF extends cv{constructor(){super();this.animateTransition=!1}}Object(e.a)(UF,"AdditionalInkButtonProperties",cv,[]);class wy extends rq{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(e.a)(wy,"OptionalFlyoutAnchorProperties",rq,[]);class VF extends wy{constructor(){super();this.animateTransition=!1}}Object(e.a)(VF,
"AdditionalInkFlyoutAnchorProperties",wy,[]);class WF{constructor(){this.selected=!1;this.iconColor=null}}Object(e.a)(WF,"InkControlState",null,[]);class XF{constructor(){this.keytip=this.rCa=this.label=null}}Object(e.a)(XF,"InkFlyoutAnchorResources",null,[]);class vs{constructor(){this.vwb=[]}xa(a){this.vwb.push(a)}commit(){appChrome.api.dispatch(this.vwb);Array.clear(this.vwb)}}Object(e.a)(vs,"AppChromeTransaction",null,[]);class $d{}$d.MB="InkPen1";$d.ZE="InkPen2";$d.YE="InkHighlighter";$d.Ora=
"InkRuler";$d.J7a="InkColorPicker1";$d.Bia="InkColorPicker2";$d.zCa="InkColorPicker3";$d.Cia="InkColorPickerMRU1";$d.Dia="InkColorPickerMRU2";$d.ACa="InkColorPickerMRU3";$d.DCa="InkThicknessSlider1";$d.ECa="InkThicknessSlider2";$d.FCa="InkThicknessSlider3";$d.BCa="InkDrawWithTouch";$d.w7="InkEraser";$d.x7="InkLasso";$d.CCa="InkSelect";$d.h4f="label";$d.f4f="iconName";$d.g4f="keytip";$d.Y5d=4;Object(e.a)($d,"InkRibbonManagerConstants",null,[]);class sq{constructor(a,b,c,f){this.tUa=this.vUa=this.uUa=
sq.EBc;this.s7=(l,x,F,R,fa)=>{if(1===F)return this.f$a?8:32;x=this.kta.ga($d.Ora).selected;l!==ba.a.YGe&&this.dMd(l===ba.a.CXa);F=new vs;if(this.oKe(this.U9d(fa)))switch(l){case ba.a.WGe:case ba.a.XGe:case ba.a.UGe:case ba.a.TGe:case ba.a.VGe:case ba.a.NGe:case ba.a.OGe:case ba.a.PGe:case ba.a.QGe:case ba.a.RGe:case ba.a.SGe:this.iJ($d.BCa,!0,!1,F,!1)}switch(l){case ba.a.WGe:this.iJ($d.MB,!0,!0,F,!0);this.ia.Ka(ba.a.MB,2,fa);this.LG=$d.MB;break;case ba.a.QGe:this.iJ($d.MB,!0,!0,F,!0);this.sFb($d.MB,
this.NTa,$d.Bia,[$d.Cia,$d.Dia],"#000000",fa,F);this.ia.Ka(ba.a.Cia,2,fa);this.LG=$d.MB;break;case ba.a.NGe:this.iJ($d.MB,!0,!0,F,!0);this.sFb($d.MB,this.NTa,$d.Bia,[$d.Cia,$d.Dia],"#000000",fa,F);this.ia.Ka(ba.a.J7a,2,fa);this.LG=$d.MB;break;case ba.a.XGe:this.iJ($d.ZE,!0,!0,F,!0);this.ia.Ka(ba.a.ZE,2,fa);this.LG=$d.ZE;break;case ba.a.RGe:this.iJ($d.ZE,!0,!0,F,!0);this.sFb($d.ZE,this.NTa,$d.Bia,[$d.Cia,$d.Dia],"#e71224",fa,F);this.ia.Ka(ba.a.Dia,2,fa);this.LG=$d.ZE;break;case ba.a.OGe:this.sFb($d.ZE,
this.NTa,$d.Bia,[$d.Cia,$d.Dia],"#e71224",fa,F);this.iJ($d.ZE,!0,!0,F,!0);this.ia.Ka(ba.a.Bia,2,fa);this.LG=$d.ZE;break;case ba.a.UGe:this.iJ($d.YE,!0,!0,F,!0);this.ia.Ka(ba.a.YE,2,fa);this.LG=$d.YE;break;case ba.a.SGe:this.iJ($d.YE,!0,!0,F,!0);this.sFb($d.YE,this.Uxb,$d.zCa,[$d.ACa],"#fffc00",fa,F);this.ia.Ka(ba.a.ACa,2,fa);this.LG=$d.YE;break;case ba.a.PGe:this.iJ($d.YE,!0,!0,F,!0);this.sFb($d.YE,this.Uxb,$d.zCa,[$d.ACa],"#fffc00",fa,F);this.ia.Ka(ba.a.zCa,2,fa);this.LG=$d.YE;break;case ba.a.TGe:this.iJ($d.w7,
!0,!1,F,!1);this.ia.Ka(ba.a.w7,2,fa);break;case ba.a.YGe:this.iJ($d.Ora,!x,!1,F,!1);this.ia.Ka(ba.a.Ora,2,fa);break;case ba.a.VGe:this.iJ($d.x7,!0,!1,F,!1);this.ia.Ka(ba.a.x7,2,fa);break;case ba.a.CXa:this.iJ($d.CCa,!0,!1,F,!1),this.iJ($d.BCa,!1,!1,F,!1),this.ia.processAction(ba.a.CCa,2)}F.commit();this.F3j&&Ww.ShyRibbon.CNa(1,2);return 32};this.ia=a;this.F3j=f;this.kta=new Ic.a;this.aka=new Ic.a;for(const l of sq.U5d){a="";switch(l){case $d.MB:a="#000000";break;case $d.ZE:a="#E71224";break;case $d.YE:a=
"#FFFC00"}this.kta.$(l,Object.assign(new WF,{selected:!1,iconColor:a}))}u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb&&u.AFrameworkApplication.Aa.gb.Mp&&this.ub();this.NTa=new Ha.a;this.NTa.add("#FFC114");this.NTa.add("#F6630D");this.NTa.add("#FF0066");this.NTa.add("#5B2D90");this.Uxb=new Ha.a;this.Uxb.add("#00F900");this.Uxb.add("#00FDFF");this.Uxb.add("#FF40FF");this.Uxb.add("#FF8517");this.LG=$d.MB;b.vGd(Object(D.a)(this,this.wT,"onFocusChanged"));this.f$a=!c||!c.Jc}ub(){this.ia.pa(ba.a.V5d,
Fb.a.application,Object(D.a)(this,this.fKi,"enableMRUPenAndDisableDrawWithTouch"),4);this.ia.pa(ba.a.omg,Fb.a.application,Object(D.a)(this,this.hoj,"handleRefreshInkUIValues"),4);this.ia.pa(ba.a.iQc,Fb.a.application,Object(D.a)(this,this.Llj,"handleInkSetInkRibbonManagerDisabledState"),4);this.ia.pa(ba.a.WGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.XGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.UGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.YGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.NGe,
Fb.a.application,this.s7,4);this.ia.pa(ba.a.OGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.PGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.QGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.RGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.SGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.Lih,Fb.a.application,Object(D.a)(this,this.g3d,"handleThicknessSliderChanged"),4);this.ia.pa(ba.a.Mih,Fb.a.application,Object(D.a)(this,this.g3d,"handleThicknessSliderChanged"),4);this.ia.pa(ba.a.Nih,Fb.a.application,
Object(D.a)(this,this.g3d,"handleThicknessSliderChanged"),4);this.ia.pa(ba.a.Kih,Fb.a.application,Object(D.a)(this,this.Jlj,"handleInkDrawWithTouchSelected"),4);this.ia.pa(ba.a.TGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.VGe,Fb.a.application,this.s7,4);this.ia.pa(ba.a.CXa,Fb.a.application,this.s7,4)}Llj(a,b,c,f,l){if(1===c)return 32;this.f$a=l;return 32}hoj(a,b,c){if(1===c)return 32;a=new vs;this.aGb($d.DCa,this.uUa,a);this.aGb($d.ECa,this.vUa,a);this.aGb($d.FCa,this.tUa,a);a.commit();this.aka.count||
this.KTj();return 32}Jlj(a,b,c,f,l){if(1===c)return this.f$a?8:32;a=l&&l.forceDisable?l.forceDisable:!1;this.kta.ga($d.BCa).selected||a?this.EWf():(this.dMd(!1),a=new vs,this.iJ($d.BCa,!0,!1,a,!1),this.iJ(this.LG,!0,!0,a,!0),a.commit(),this.ia.Ka(ba.a.T5d,2,{enable:!0}));return 32}g3d(a,b,c,f,l){if(1===c)return 32;b=new vs;this.iJ($d.BCa,!0,!1,b,!1);l&&l&&(l[sq.Fel]=ap.Value);switch(a){case ba.a.Lih:this.ia.Ka(ba.a.DCa,2,l);this.uUa=this.N6a(l);this.aGb($d.DCa,this.uUa,b);this.LG=$d.MB;break;case ba.a.Mih:this.ia.Ka(ba.a.ECa,
2,l);this.vUa=this.N6a(l);this.aGb($d.ECa,this.vUa,b);this.LG=$d.ZE;break;case ba.a.Nih:this.ia.Ka(ba.a.FCa,2,l),this.tUa=this.N6a(l),this.aGb($d.FCa,this.tUa,b),this.LG=$d.YE}b.commit();return 32}isEnabled(a){return this.kta.ga(a).selected}fKi(a,b,c){if(1===c)return 32;if(!Ag.c())return ya.a.J(512493019,801,15,"Ribbon should be initialized when calling EnableMRUPenAndDisableDrawWithTouch."),8;if(!this.aka.count)return 32;this.dMd(!1);this.EWf();this.kta.ga(this.LG).selected=!1;a=new vs;this.iJ(this.LG,
!0,!0,a,!0);this.ia.processAction(ba.a.nmg,2);a.commit();return 32}KTj(){for(const a of sq.U5d)switch(a){case $d.MB:this.M5b($d.MB);break;case $d.ZE:this.M5b($d.ZE);break;case $d.YE:this.M5b($d.YE);break;case $d.w7:this.M5b($d.w7);break;case $d.x7:this.M5b($d.x7)}}M5b(a){const b=appChrome.selectors.getInkButtonState(a);this.aka.$(a,Object.assign(new XF,{label:$d.h4f in b?Object(va.a)(String,b[$d.h4f]):"",rCa:$d.f4f in b?Object(va.a)(String,b[$d.f4f]):"",keytip:$d.g4f in b?Object(va.a)(String,b[$d.g4f]):
""}))}dMd(a){const b=new vs;for(const c of sq.U5d)if(c!==$d.Ora)switch(this.iJ(c,!1,!1,b,!0),c){case $d.MB:this.apb($d.MB,b,!0,a);break;case $d.ZE:this.apb($d.ZE,b,!0,a);break;case $d.YE:this.apb($d.YE,b,!0,a);break;case $d.w7:this.apb($d.w7,b,!0,a);break;case $d.x7:this.apb($d.x7,b,!0,a)}b.commit()}qCh(a,b,c){c.xa(appChrome.actions.toggleButton(a,b));this.kta.ga(a).selected=b}iJ(a,b,c,f,l){c?b?(b&&!this.kta.ga(a).selected&&this.ypi(a,f,l),this.qCh(a,b,f)):this.apb(a,f,l,a!==$d.CCa):this.qCh(a,b,
f)}apb(a,b,c,f){if(this.aka.Jb(a)){var l=this.aka.ga(a).rCa,x=this.aka.ga(a).keytip,F=this.aka.ga(a).label;a=appChrome.api.createInkButtonModel(a,F,Object.assign(new UF,{iconSet:(new Up.a(l)).iconSet,iconColor:this.kta.ga(a).iconColor,keytip:x,animateTransition:c&&!f}));b.xa(appChrome.actions.addControls([a]))}}ypi(a,b,c){if(this.aka.Jb(a)){var f=this.aka.ga(a).rCa,l=this.aka.ga(a).keytip,x=this.aka.ga(a).label;a=appChrome.api.createInkFlyoutAnchorModel(a,x,Object.assign(new VF,{iconSet:(new Up.a(f)).iconSet,
iconColor:this.kta.ga(a).iconColor,keytip:l,menuModel:appChrome.getInkFlyoutAnchorMenuModel(a),animateTransition:c}));b.xa(appChrome.actions.addControls([a]))}}G2k(a,b,c){c.xa(appChrome.actions.updateIconColor(a,b))}H2k(a,b,c){c.xa(appChrome.actions.populateColorPickerCells(a,b))}aGb(a,b,c){c.xa(appChrome.actions.updateSliderSelectedValue(a,b))}twk(a,b,c,f){if(a=appChrome.selectors.getColorPickerState(a)){a=this.Xvi(Array.isArray(a.colorCells)?a.colorCells:null);for(const l of b)this.H2k(l,this.E6i(a,
c),f)}}F6i(a,b){const c=a.indexOf(b);-1===c?a.removeAt(a.count-1):a.removeAt(c);a.insert(0,b)}Xvi(a){const b={};for(const c of a)b[c.id]=c;return b}E6i(a,b){const c=[];for(let f of b)f in a&&Array.add(c,a[f]);return c}U9d(a){return a&&a.InputMethod?a.InputMethod===$d.Y5d:!1}oKe(a){return!a||n.a.Ki||n.a.i3b}qbj(a,b){a&&a.Color&&(b=6===Object(va.a)(String,a.Color).length?"#"+a.Color:Object(va.a)(String,a.Color));return b}sFb(a,b,c,f,l,x,F){l=this.qbj(x,l);this.kta.ga(a).iconColor=l;this.G2k(a,l,F);
this.F6i(b,l);this.twk(c,f,b,F)}EWf(){const a=new vs;this.iJ($d.BCa,!1,!1,a,!1);this.ia.Ka(ba.a.T5d,2,{enable:!1});a.commit()}wT(a,b){b.Ifc===Nc.a.dO&&b.EBb!==Nc.a.dO&&this.ia.processAction(ba.a.mmg,2);b.Ifc!==Nc.a.yg&&b.EBb===Nc.a.yg&&this.ia.processAction(ba.a.qmg,2)}N6a(a){return a&&a[ap.Value]?a[ap.Value]:sq.EBc}}sq.Fel="SliderCommandPropertiesValueKey";sq.EBc=3;sq.U5d=[$d.MB,$d.ZE,$d.BCa,$d.w7,$d.YE,$d.Ora,$d.x7,$d.CCa];Object(e.a)(sq,"InkRibbonManager",null,[1198]);class YF{constructor(a){this.kee=
a}get owa(){return this.kee.owa}xLc(){return this.kee.xLc()}QEe(){this.kee.QEe()}}Object(e.a)(YF,"PPTChromeExtensionHelper",null,[1191,1143]);var Va=d(522);class Og{constructor(a,b){this.populateQueryCommandId=null;this.populateOnlyOnce=!1;this.populateQueryCommandId=a;this.populateOnlyOnce=b}}Object(e.a)(Og,"MenuPopulationProperties",null,[]);class Xw{constructor(){this.Wpc={};this.Tpc={};this.awf={};this.Upc={};this.Jsd={};this.Ksd={};this.ttd={};this.sZh()}CBa(a){return this.Tpc[a]}uYd(a){return this.Upc[a]}T3i(a){return this.Jsd[a]}getCommandByExternalUxId(a){return this.Wpc[a]}i1d(a){return this.awf[a]}i9f(a){if(a in
this.ttd)return this.ttd[a];Z.ULS.sendTraceTag(39946131,306,15,"ReactCommandDefinitionMapping.GetExternalIconIdByLegacyIconId: can't find mapping for legacy icon {0}",a);return"MissingIcon_20"}S3i(a){return this.Ksd[a]}bAf(a){this.addCommandToMaps(a)}addCommandToMaps(a){var b=this.Wpc[a.externalUxCommand];if(b){delete this.Wpc[b.externalUxCommand];const c=this.Tpc[b.commandId];for(let f=0;f<c.length;f++)if(c[f].externalUxCommand===b.externalUxCommand){Array.remove(c,c[f]);break}}this.Wpc[a.externalUxCommand]=
a;b=this.Tpc[a.commandId];if(void 0===b||null===b)b=[],this.Tpc[a.commandId]=b;b.push(a);a.legacyControlId&&(this.Upc[a.legacyControlId]||(this.Upc[a.legacyControlId]=new Ha.a),this.Upc[a.legacyControlId].add(a.externalUxCommand))}addTabToMap(a,b){this.awf[a]=b}addIconToMap(a,b){this.ttd[b]=a}Ai(a){if(a.legacyGroupId){var b=this.Jsd[a.legacyGroupId];b||(b=[],this.Jsd[a.legacyGroupId]=b);b.push(a)}a.externalUxGroupId&&(b=this.Ksd[a.externalUxGroupId],b||(b=[],this.Ksd[a.externalUxGroupId]=b),b.push(a))}sZh(){this.addCommandToMaps(Object.assign(new Va.a("AccessibilityHelp",
"3276527670"),{legacyControlId:"jbtnAccessibilityHelp"}));this.addCommandToMaps(new Va.a("AlwaysShowRibbon","336231556"));this.addCommandToMaps(new Va.a("CoauthorsRendered","691867605"));this.addCommandToMaps(Object.assign(new Va.a("CopyLink","981334692"),{legacyControlId:"CopyLink"}));this.addCommandToMaps(Object.assign(new Va.a("ShareMenu","336231556"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Va.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",
queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Va.a("CheckAccessibility","2529583086"),{legacyControlId:"btnOpenAccCheckerPane",queryCommandId:"1949220702"}));this.addCommandToMaps(Object.assign(new Va.a("ContactSupport","2918242107"),{legacyControlId:"btnContactSupport"}));this.addCommandToMaps(Object.assign(new Va.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(Object.assign(new Va.a("DownloadACopy","3555692408"),
{legacyControlId:"jbtnDownloadACopy"}));this.addCommandToMaps(new Va.a("FileMenuLauncher","1784018444"));this.addCommandToMaps(Object.assign(new Va.a("GiveFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"}));this.addCommandToMaps(Object.assign(new Va.a("Help","1454393937"),{legacyControlId:"jbtnHelp"}));this.addCommandToMaps(new Va.a("HideRibbon","336231556"));this.addCommandToMaps(new Va.a("InsertAddIns","1945259303"));this.addCommandToMaps(new Va.a("InsertAddInsFromBackstage","1945259303"));
this.addCommandToMaps(new Va.a("InsertComment","2423504651"));this.addCommandToMaps(Object.assign(new Va.a("InsertComment","2423504651"),{legacyControlId:"btnInsertComment"}));this.addCommandToMaps(new Va.a("ManageAccess","981334692"));this.addCommandToMaps(new Va.a("MenuClose","336231556"));this.addCommandToMaps(new Va.a("MenuOpen","336231556"));this.addCommandToMaps(new Va.a("MenuPopulate","336231556"));this.addCommandToMaps(new Va.a("MoveToFolder","1182470434"));this.addCommandToMaps(new Va.a("NavigateToCoauthor",
"4033456482"));this.addCommandToMaps(new Va.a("New","1056925771"));this.addCommandToMaps(new Va.a("NewBrowserSuggestionClicked","3734060499"));this.addCommandToMaps(Object.assign(new Va.a("NewComment","2423504651"),{legacyControlId:"btnNewComment"}));this.addCommandToMaps(Object.assign(new Va.a("PeopleWell","929022654"),{queryCommandId:"3798167515",populationProps:new Og("1285265560",!1)}));this.addCommandToMaps(Object.assign(new Va.a("Privacy","1208554566"),{legacyControlId:"jbtnPrivacy"}));this.addCommandToMaps(Object.assign(new Va.a("Rename",
"2382951455"),{legacyControlId:"jbtnRenameDialog"}));this.addCommandToMaps(Object.assign(new Va.a("SaveAs","4246497969"),{legacyControlId:"jbtnSaveACopy"}));this.addCommandToMaps(Object.assign(new Va.a("SaveAsToHost","2316717900"),{legacyControlId:"jbtnSaveAsToHost"}));this.addCommandToMaps(Object.assign(new Va.a("SaveToSharePoint","3050207199"),{legacyControlId:"jbtnSaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Va.a("SearchHelp","2918242107"),{legacyControlId:"btnHelp"}));this.addCommandToMaps(Object.assign(new Va.a("Share",
"981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Va.a("ShareTopBar","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Va.a("SmartLookUp","1435347209"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Va.a("TabSwitch","336231556"));this.addCommandToMaps(Object.assign(new Va.a("TermsOfUse","2349775795"),{legacyControlId:"jbtnTermsOfUse"}));this.addCommandToMaps(Object.assign(new Va.a("Training","2918242107"),
{legacyControlId:"btnShowTraining"}));this.addCommandToMaps(Object.assign(new Va.a("VersionHistory","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Va.a("WhatsNew","2918242107"),{legacyControlId:"btnWhatsNew"}));this.addCommandToMaps(Object.assign(new Va.a("Zoom","1738002952"),{legacyControlId:"btnViewZoomDialog"}));this.addCommandToMaps(Object.assign(new Va.a("ToggleRibbonUXDialog","1342108365"),{legacyControlId:"toggleBtnSimpleRibbon",queryCommandId:"1536028887"}));
this.addCommandToMaps(new Va.a("CommitNewDocumentTitle","1808554760"));this.addCommandToMaps(new Va.a("RibbonModeToggledToMLR","536345575"));this.addCommandToMaps(new Va.a("RibbonModeToggledToSLR","4031133701"));this.addCommandToMaps(new Va.a("Workflow","2988588587"));this.addCommandToMaps(new Va.a("ToggleVNextLook","1650341290"));this.addCommandToMaps(Object.assign(new Va.a("DefinitionsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(Object.assign(new Va.a("GetHelpFromTellMe",
"2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Va.a("GetHelpFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Va.a("GetHelpFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Va.a("GetHelpWithDescriptionFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Va.a("GetHelpWithDescriptionFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));
this.addCommandToMaps(new Va.a("AnswerForSearch","1914896509"));this.addCommandToMaps(new Va.a("AnswerForSearchSingleLine","1914896509"));this.addCommandToMaps(new Va.a("ReuseFileQuickActionForSearch","1914896509"));this.addCommandToMaps(new Va.a("PeopleSuggestion1","2133437452"));this.addCommandToMaps(new Va.a("PeopleSuggestion2","2133437453"));this.addCommandToMaps(new Va.a("PeopleSuggestion3","2133437454"));this.addCommandToMaps(new Va.a("FileSuggestion1","2260671807"));this.addCommandToMaps(new Va.a("FileSuggestion2",
"2260671810"));this.addCommandToMaps(new Va.a("FileSuggestion3","2260671809"));this.addCommandToMaps(new Va.a("FileSuggestion4","2260671804"));this.addCommandToMaps(new Va.a("FileSuggestion5","2260671803"));this.addCommandToMaps(new Va.a("NotesSuggestion1","1914896509"));this.addCommandToMaps(new Va.a("NotesSuggestion2","1914896509"));this.addCommandToMaps(new Va.a("NotesSuggestion3","1914896509"));this.addCommandToMaps(new Va.a("OnenoteNotesSuggestion1","4083547050"));this.addCommandToMaps(new Va.a("OnenoteNotesSuggestion2",
"4083547053"));this.addCommandToMaps(new Va.a("OnenoteNotesSuggestion3","4083547052"));this.addCommandToMaps(new Va.a("TellMeFeedback","2230755196"));this.addCommandToMaps(new Va.a("TemplateForSearch","57037313"));this.addCommandToMaps(new Va.a("AddinSuggestion1","1385019911"));this.addCommandToMaps(new Va.a("AddinSuggestion2","981735384"));this.addCommandToMaps(new Va.a("AddinSuggestion3","2547819325"));this.addCommandToMaps(new Va.a("LaunchAddinDialogFromTellMe","1421877154"));u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.gb.RGb?(this.addCommandToMaps(new Va.a("FindWithMatchesParameterized","1914896509")),this.addCommandToMaps(new Va.a("FindParameterized","1914896509")),this.addCommandToMaps(new Va.a("FindInDocumentSuggestion1","1914896509")),this.addCommandToMaps(new Va.a("FindInDocumentSuggestion2","1914896509")),this.addCommandToMaps(new Va.a("FindInDocumentSuggestion3","1914896509"))):(this.addCommandToMaps(new Va.a("FindWithMatchesParameterized","1540292897")),this.addCommandToMaps(new Va.a("FindParameterized",
"1540292897")),this.addCommandToMaps(new Va.a("FindInDocumentSuggestion1","1540292897")),this.addCommandToMaps(new Va.a("FindInDocumentSuggestion2","1540292897")),this.addCommandToMaps(new Va.a("FindInDocumentSuggestion3","1540292897")));this.addCommandToMaps(new Va.a("ImageForSearch","1914896509"));this.addCommandToMaps(new Va.a("LearningForSearch","1006342541"));this.addCommandToMaps(new Va.a("SmartLookupFromTellMe","1914896509"));this.addCommandToMaps(new Va.a("SmartLookupFromTellMeQueryTermAtTop",
"1914896509"));this.addCommandToMaps(new Va.a("SmartLookupFromTellMeZeroTerm","3359903192"));!u.AFrameworkApplication.JCa||u.AFrameworkApplication.Bwa||u.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||(this.addCommandToMaps(Object.assign(new Va.a("SmartLookupFromTellMe","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new Va.a("SmartLookupFromTellMeQueryTermAtTop","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new Va.a("AnswerForSearch",
"3317204163")),this.addCommandToMaps(new Va.a("AnswerForSearchSingleLine","3317204163")));this.addCommandToMaps(Object.assign(new Va.a("SynonymsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Va.a("TellMeLogMenuClose","4266170064"));this.addCommandToMaps(new Va.a("TellMeLogMenuOpen","2480888384"));this.addCommandToMaps(new Va.a("TellMeMenuItemExecuted","878547493"));this.addCommandToMaps(new Va.a("TellMeSearchResultChange","2652476189"));this.addCommandToMaps(new Va.a("TellMeSuggestion_1",
"1404166600"));this.addCommandToMaps(new Va.a("TellMeSuggestion_2","1404166600"));this.addCommandToMaps(new Va.a("TellMeSuggestion_3","1404166600"));this.addCommandToMaps(new Va.a("TellMeSuggestion_4","1404166600"));this.addCommandToMaps(new Va.a("TellMeSuggestion_5","1404166600"));this.addCommandToMaps(new Va.a("TryOfficeUpsell","215809929"));this.addCommandToMaps(Object.assign(new Va.a("TellMeControl","336231556"),{legacyControlId:"TellMeControl"}));this.addCommandToMaps(Object.assign(new Va.a("DiagnosticsSection",
"336231556"),{legacyControlId:"AboutInformationMenuSectionDiagnostics"}));this.addCommandToMaps(Object.assign(new Va.a("FileAboutPage","336231556"),{legacyControlId:"faAbout"}));this.addCommandToMaps(Object.assign(new Va.a("FileHelpPage","336231556"),{legacyControlId:"faHelp"}));this.addCommandToMaps(Object.assign(new Va.a("FileHomePage","2074131365"),{legacyControlId:"faHome"}));this.addCommandToMaps(Object.assign(new Va.a("FileGetAddinsPage","336231556"),{legacyControlId:"faGetAddinsFromBackstage"}));
this.addCommandToMaps(Object.assign(new Va.a("FileInfoPage","336231556"),{legacyControlId:"faInfo"}));this.addCommandToMaps(Object.assign(new Va.a("FileNewPage","2074131365"),{legacyControlId:"faNew"}));this.addCommandToMaps(Object.assign(new Va.a("FileOpenPage","2799130311"),{legacyControlId:"faOpen"}));this.addCommandToMaps(Object.assign(new Va.a("FilePrintPage","336231556"),{legacyControlId:"faPrint"}));this.addCommandToMaps(Object.assign(new Va.a("FileSaveAsPage","336231556"),{legacyControlId:"faSaveAs"}));
this.addCommandToMaps(Object.assign(new Va.a("FileSharePage","336231556"),{legacyControlId:"faShare"}));this.addCommandToMaps(Object.assign(new Va.a("FileTransformPage","336231556"),{legacyControlId:"faTransform"}));this.addCommandToMaps(new Va.a("NewDocument","1056925771"));this.addCommandToMaps(new Va.a("OpenUrlInNewTab","1959943459"));this.addCommandToMaps(new Va.a("OpenDocumentUrl","2155708348"));this.addCommandToMaps(Object.assign(new Va.a("ReplyWithChanges","1197060601"),{legacyControlId:"jbtnShareRWC"}));
this.addCommandToMaps(Object.assign(new Va.a("ReportAbuse","3237171630"),{legacyControlId:"jbtnReportAbuse"}));this.addCommandToMaps(Object.assign(new Va.a("ThirdPartyNotices","2220417879"),{legacyControlId:"jbtnThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Va.a("TrustCenter","2583751502"),{legacyControlId:"jbtnTrustCenter"}));this.addCommandToMaps(Object.assign(new Va.a("TryOfficeForWordEditor","1773624819"),{legacyControlId:"btnjTryMacOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Va.a("TryMacOfficeForWordEditor",
"3901198658"),{legacyControlId:"btnjTryOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Va.a("PreviousVersions","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Va.a("FileVersionHistory","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Va.a("FilePreviousVersions","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Va.a("HostConversation","710925581"),{legacyControlId:"HostConversation"}));
this.addCommandToMaps(Object.assign(new Va.a("HostClose","3033402446"),{legacyControlId:"HostClose"}));this.addCommandToMaps(Object.assign(new Va.a("HostDownload","3555692408"),{legacyControlId:"HostDownload"}));this.addCommandToMaps(Object.assign(new Va.a("HostOpenInBrowser","2596942163"),{legacyControlId:"HostOpenInBrowser"}));this.addCommandToMaps(Object.assign(new Va.a("HostMoreOptions","336231556"),{legacyControlId:"HostMoreOptions"}));this.addCommandToMaps(Object.assign(new Va.a("Sensitivity",
"941487903"),{legacyControlId:"flySensitivity",queryCommandId:"3134802707",populationProps:new Og("1145315516",!0)}));this.addCommandToMaps(Object.assign(new Va.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));this.addCommandToMaps(new Va.a("FreemiumUpsellEligible","1274543852"));this.addCommandToMaps(new Va.a("FreemiumUpsellDialogShowUI","4180531998"));this.addCommandToMaps(new Va.a("ReportFreemiumUpsellEligibleDisplayed","2539564555"));this.addCommandToMaps(new Va.a("HandleDiscoverPremiumButtonClick",
"2280081216"));this.addCommandToMaps(new Va.a("RequestFontInfo","3169500754"));this.addCommandToMaps(new Va.a("PinOrUnpinFont","1500655301"));this.addCommandToMaps(new Va.a("FontPickerMenuClose","146595126"));this.addCommandToMaps(new Va.a("ShowAccessibilitySettingsDialog","2236763780"));this.addCommandToMaps(Object.assign(new Va.a("ShowZoomDialog","1738002952"),{queryCommandId:"433063458",legacyControlId:"buttonShowZoomDialog"}));this.addCommandToMaps(Object.assign(new Va.a("ZoomToPercentage","3745693956"),
{queryCommandId:"2901130581",legacyControlId:"ZoomSlider"}));this.addCommandToMaps(new Va.a("ZoomToPercentageCompleted","3139946409"));u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("WordRecentLinksIsEnabled")&&(this.addCommandToMaps(Object.assign(new Va.a("RecentLinks","2535492938"),{queryCommandId:"2535492938",populationProps:new Og("860679239",!1)})),this.addCommandToMaps(Object.assign(new Va.a("InsertLinkFlyout","1052791248"),{queryCommandId:"1052791248",populationProps:new Og("276140882",
!1)})))}}Object(e.a)(Xw,"ReactCommandDefinitionMapping",null,[1500]);class Wf{constructor(a){this.externalUxCommandIds=this.commandId=this.externalUxGroupId=this.legacyGroupId=null;this.legacyGroupId=a}}Object(e.a)(Wf,"GroupMetadata",null,[]);class XA extends Xw{constructor(a){super();this.fZj="AnimationNone AnimationAppear AnimationFadeIn AnimationFlyIn AnimationSplit AnimationWipe AnimationRandomBars AnimationGrowAndTurn AnimationZoom AnimationBasicZoom AnimationBlinds AnimationBox AnimationCheckerboard AnimationExpand AnimationPeekIn AnimationRiseUp AnimationStretch AnimationStrips AnimationEmphasis_Spin AnimationEmphasis_GrowShrink AnimationEmphasis_Transparency AnimationEmphasis_LineColor AnimationEmphasis_FillColor AnimationEmphasis_FontColor AnimationExit_Disappear AnimationExit_Fade AnimationExit_FlyOut AnimationExit_Split AnimationExit_Wipe AnimationExit_RandomBars AnimationExit_Zoom AnimationExit_BasicZoom AnimationExit_Blinds AnimationExit_Box AnimationExit_Checkerboard AnimationExit_PeekOut AnimationExit_Stretchy AnimationExit_Strips AnimationGalleryNone AnimationGalleryEntrance AnimationGalleryEmphasis AnimationGalleryExit".split(" ");
this.cZj=26;this.bZj="AnimationEffectOptionsDataSpin_Quarter AnimationEffectOptionsDataSpin_Half AnimationEffectOptionsDataSpin_Full AnimationEffectOptionsDataSpin_Two AnimationEffectOptionsDataTransparency_25 AnimationEffectOptionsDataTransparency_50 AnimationEffectOptionsDataTransparency_75 AnimationEffectOptionsDataTransparency_100 AnimationEffectOptionsDataGrowShrink_Tiny AnimationEffectOptionsDataGrowShrink_Smaller AnimationEffectOptionsDataGrowShrink_Larger AnimationEffectOptionsDataGrowShrink_Huge".split(" ");
this.eZj=31;this.dZj="AnimationEffectOptionsDirectionFromBottom AnimationEffectOptionsDirectionFromBottomLeft AnimationEffectOptionsDirectionFromLeft AnimationEffectOptionsDirectionFromTopLeft AnimationEffectOptionsDirectionFromTop AnimationEffectOptionsDirectionFromTopRight AnimationEffectOptionsDirectionFromRight AnimationEffectOptionsDirectionFromBottomRight AnimationEffectOptionsDirectionToBottom AnimationEffectOptionsDirectionToBottomLeft AnimationEffectOptionsDirectionToLeft AnimationEffectOptionsDirectionToTopLeft AnimationEffectOptionsDirectionToTop AnimationEffectOptionsDirectionToTopRight AnimationEffectOptionsDirectionToRight AnimationEffectOptionsDirectionToBottomRight AnimationEffectOptionsDirectionHorizontal AnimationEffectOptionsDirectionHorizontalIn AnimationEffectOptionsDirectionHorizontalOut AnimationEffectOptionsDirectionVertical AnimationEffectOptionsDirectionVerticalIn AnimationEffectOptionsDirectionVerticalOut AnimationEffectOptionsDirectionLeftDown AnimationEffectOptionsDirectionLeftUp AnimationEffectOptionsDirectionRightDown AnimationEffectOptionsDirectionRightUp AnimationEffectOptionsDirectionIn AnimationEffectOptionsDirectionInBottom AnimationEffectOptionsDirectionInCenter AnimationEffectOptionsDirectionInSlightly AnimationEffectOptionsDirectionOut AnimationEffectOptionsDirectionOutBottom AnimationEffectOptionsDirectionOutCenter AnimationEffectOptionsDirectionOutSlightly AnimationEffectOptionsDirectionFloatUp AnimationEffectOptionsDirectionFloatDown AnimationEffectOptionsDirectionObjectCenter AnimationEffectOptionsDirectionSlideCenter AnimationEffectOptionsDirectionObjectCenterOut AnimationEffectOptionsDirectionSlideCenterOut AnimationEffectOptionsDirectionClockwise AnimationEffectOptionsDirectionCounterClockwise AnimationEffectOptionsDirectionAcross AnimationEffectOptionsDirectionUp AnimationEffectOptionsDirectionDown AnimationEffectOptionsDirectionGrowShrinkHorizontal AnimationEffectOptionsDirectionGrowShrinkVertical AnimationEffectOptionsDirectionGrowShrinkBoth".split(" ");
this.P9j=23;this.O9j="TransitionEffectOptionsTransitionExisting TransitionEffectOptionsTransitionExistingInMenu TransitionEffectOptionsTransitionNone TransitionEffectOptionsTransitionFade TransitionEffectOptionsTransitionFadeSmoothly TransitionEffectOptionsTransitionFadeThroughBlack TransitionEffectOptionsTransitionPush TransitionEffectOptionsTransitionPushFromBottom TransitionEffectOptionsTransitionPushFromLeft TransitionEffectOptionsTransitionPushFromRight TransitionEffectOptionsTransitionPushFromTop TransitionEffectOptionsTransitionCut TransitionEffectOptionsTransitionCutNone TransitionEffectOptionsTransitionCutThroughBlack TransitionEffectOptionsTransitionWipe TransitionEffectOptionsTransitionWipeFromRight TransitionEffectOptionsTransitionWipeFromTop TransitionEffectOptionsTransitionWipeFromLeft TransitionEffectOptionsTransitionWipeFromBottom TransitionEffectOptionsTransitionWipeFromTopRight TransitionEffectOptionsTransitionWipeFromBottomRight TransitionEffectOptionsTransitionWipeFromTopLeft TransitionEffectOptionsTransitionWipeFromBottomLeft TransitionEffectOptionsTransitionMorph TransitionEffectOptionsTransitionMorphByObject TransitionEffectOptionsTransitionMorphByWord TransitionEffectOptionsTransitionMorphByChar TransitionEffectOptionsTransitionSplit TransitionEffectOptionsTransitionSplitVerticalOut TransitionEffectOptionsTransitionSplitHorizontalIn TransitionEffectOptionsTransitionSplitHorizontalOut TransitionEffectOptionsTransitionSplitVerticalIn TransitionEffectOptionsTransitionRandom TransitionEffectOptionsTransitionRandomBars TransitionEffectOptionsTransitionRandomBarsVertical TransitionEffectOptionsTransitionRandomBarsHorizontal TransitionEffectOptionsTransitionShape TransitionEffectOptionsTransitionShapeCircle TransitionEffectOptionsTransitionShapeDiamond TransitionEffectOptionsTransitionShapePlus TransitionEffectOptionsTransitionShapeIn TransitionEffectOptionsTransitionShapeOut TransitionEffectOptionsTransitionCombHorizontal TransitionEffectOptionsTransitionCombVertical TransitionEffectOptionsTransitionWheelClockwise TransitionEffectOptionsTransitionWheelCounterclockwise TransitionEffectOptionsTransitionWheelWedge TransitionEffectOptionsTransitionRevealFromLeft TransitionEffectOptionsTransitionRevealFromRight TransitionEffectOptionsTransitionRevealSmoothlyFromLeft TransitionEffectOptionsTransitionRevealSmoothlyFromRight TransitionEffectOptionsTransitionDissolve TransitionEffectOptionsTransitionBlindsHorizontal TransitionEffectOptionsTransitionBlindsVertical TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionCoverFromBottom TransitionEffectOptionsTransitionCoverFromBottomLeft TransitionEffectOptionsTransitionCoverFromBottomRight TransitionEffectOptionsTransitionCoverFromLeft TransitionEffectOptionsTransitionCoverFromRight TransitionEffectOptionsTransitionCoverFromTop TransitionEffectOptionsTransitionCoverFromTopLeft TransitionEffectOptionsTransitionCoverFromTopRight TransitionEffectOptionsTransitionUncoverFromBottom TransitionEffectOptionsTransitionUncoverFromBottomLeft TransitionEffectOptionsTransitionUncoverFromBottomRight TransitionEffectOptionsTransitionUncoverFromLeft TransitionEffectOptionsTransitionUncoverFromRight TransitionEffectOptionsTransitionUncoverFromTop TransitionEffectOptionsTransitionUncoverFromTopLeft TransitionEffectOptionsTransitionUncoverFromTopRight TransitionEffectOptionsTransitionRippleCenter TransitionEffectOptionsTransitionRippleBottomLeft TransitionEffectOptionsTransitionRippleBottomRight TransitionEffectOptionsTransitionRippleTopRight TransitionEffectOptionsTransitionRippleTopLeft TransitionEffectOptionsTransitionCubeFromBottom TransitionEffectOptionsTransitionCubeFromLeft TransitionEffectOptionsTransitionCubeFromRight TransitionEffectOptionsTransitionCubeFromTop TransitionEffectOptionsTransitionBoxFromBottom TransitionEffectOptionsTransitionBoxFromLeft TransitionEffectOptionsTransitionBoxFromRight TransitionEffectOptionsTransitionBoxFromTop TransitionEffectOptionsTransitionSwitchLeft TransitionEffectOptionsTransitionSwitchRight TransitionEffectOptionsTransitionFallOverLeft TransitionEffectOptionsTransitionFallOverRight TransitionEffectOptionsTransitionDrapeLeft TransitionEffectOptionsTransitionDrapeRight TransitionEffectOptionsTransitionFlipLeft TransitionEffectOptionsTransitionFlipRight TransitionEffectOptionsTransitionWindLeft TransitionEffectOptionsTransitionWindRight TransitionEffectOptionsTransitionPrestige TransitionEffectOptionsTransitionFracture TransitionEffectOptionsTransitionCrush TransitionEffectOptionsTransitionPeelOffLeft TransitionEffectOptionsTransitionPeelOffRight TransitionEffectOptionsTransitionPageCurlSingleLeft TransitionEffectOptionsTransitionPageCurlSingleRight TransitionEffectOptionsTransitionPageCurlDoubleLeft TransitionEffectOptionsTransitionPageCurlDoubleRight TransitionEffectOptionsTransitionAirplaneLeft TransitionEffectOptionsTransitionAirplaneRight TransitionEffectOptionsTransitionOrigamiLeft TransitionEffectOptionsTransitionOrigamiRight TransitionEffectOptionsTransitionCheckerFromLeft TransitionEffectOptionsTransitionCheckerFromTop TransitionEffectOptionsTransitionVortexFromLeft TransitionEffectOptionsTransitionVortexFromTop TransitionEffectOptionsTransitionVortexFromRight TransitionEffectOptionsTransitionVortexFromBottom TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionGlitterHexagonLeft TransitionEffectOptionsTransitionGlitterHexagonTop TransitionEffectOptionsTransitionGlitterHexagonRight TransitionEffectOptionsTransitionGlitterHexagonBottom TransitionEffectOptionsTransitionGlitterDiamondLeft TransitionEffectOptionsTransitionGlitterDiamondTop TransitionEffectOptionsTransitionGlitterDiamondRight TransitionEffectOptionsTransitionGlitterDiamondBottom TransitionEffectOptionsTransitionOrbitFromTop TransitionEffectOptionsTransitionOrbitFromBottom TransitionEffectOptionsTransitionOrbitFromLeft TransitionEffectOptionsTransitionOrbitFromRight TransitionEffectOptionsTransitionRotateFromTop TransitionEffectOptionsTransitionRotateFromBottom TransitionEffectOptionsTransitionRotateFromLeft TransitionEffectOptionsTransitionRotateFromRight TransitionEffectOptionsTransitionConveyorFromRight TransitionEffectOptionsTransitionConveyorFromLeft TransitionEffectOptionsTransitionGalleryIconFromRight TransitionEffectOptionsTransitionGalleryIconFromLeft TransitionEffectOptionsTransitionPanFromBottom TransitionEffectOptionsTransitionPanFromLeft TransitionEffectOptionsTransitionPanFromRight TransitionEffectOptionsTransitionPanFromTop TransitionEffectOptionsTransitionDoorsVertical TransitionEffectOptionsTransitionDoorsHorizontal TransitionEffectOptionsTransitionWindowVertical TransitionEffectOptionsTransitionWindowHorizontal TransitionEffectOptionsTransitionZoomIn TransitionEffectOptionsTransitionZoomOut TransitionEffectOptionsTransitionZoomAndRotate TransitionEffectOptionsTransitionFlyThroughIn TransitionEffectOptionsTransitionFlyThroughOut TransitionEffectOptionsTransitionFlyThroughInWithBounce TransitionEffectOptionsTransitionFlyThroughOutWithBounce".split(" ");
this.V5j="PictureStyles_SimpleFrameWhite_15505 PictureStyles_BeveledMatteWhite_15506 PictureStyles_MetalFrame_15507 PictureStyles_DropShadowRectangle_15508 PictureStyles_ReflectedRoundedRectangle_15509 PictureStyles_SoftEdgeRectangle_15510 PictureStyles_DoubleFrameBlack_15511 PictureStyles_ThickMatteBlack_15512 PictureStyles_SimpleFrameBlack_15513 PictureStyles_BeveledOvalBlack_15514 PictureStyles_CompoundFrameBlack_15515 PictureStyles_ModerateFrameBlack_15516 PictureStyles_CenterShadowRectangle_15517 PictureStyles_RoundedDiagonalCornerWhite_15518 PictureStyles_SnipDiagonalCornerWhite_15519 PictureStyles_ModerateFrameWhite_15520 PictureStyles_RotatedWhite_15521 PictureStyles_PerspectiveShadowWhite_15522 PictureStyles_RelaxedPerspectiveWhite_15523 PictureStyles_SoftEdgeOval_15524 PictureStyles_BevelEdgeRectangle_15525 PictureStyles_BevelPerspective_15526 PictureStyles_ReflectedPerspectiveRight_15527 PictureStyles_BevelPerspectiveLeftWhite_15528 PictureStyles_ReflectedBevelBlack_15529 PictureStyles_ReflectedBevelWhite_15530 PictureStyles_MetalRoundedRectangle_15531 PictureStyles_MetalOval_15532".split(" ");
this.T5j="PictureCrop_ShapeAlternateProcess_126 PictureCrop_ShapeArc_84 PictureCrop_ShapeBentArrow_28 PictureCrop_ShapeBentUpArrow_31 PictureCrop_ShapeBevel_74 PictureCrop_ShapeBlockArc_77 PictureCrop_ShapeCan_7 PictureCrop_ShapeCard_139 PictureCrop_ShapeChevron_38 PictureCrop_ShapeChord_66 PictureCrop_ShapeCircularArrow_45 PictureCrop_ShapeCloud_83 PictureCrop_ShapeCloudCallout_93 PictureCrop_ShapeCollate_143 PictureCrop_ShapeConnector_137 PictureCrop_ShapeCross_72 PictureCrop_ShapeCube_8 PictureCrop_ShapeCurvedArrowConnector_153 PictureCrop_ShapeCurvedConnector_25 PictureCrop_ShapeCurvedDoubleArrowConnector_154 PictureCrop_ShapeCurvedDownArrow_46 PictureCrop_ShapeCurvedDownRibbon_120 PictureCrop_ShapeCurvedLeftArrow_33 PictureCrop_ShapeCurvedRightArrow_32 PictureCrop_ShapeCurvedUpArrow_34 PictureCrop_ShapeCurvedUpRibbon_119 PictureCrop_ShapeData_128 PictureCrop_ShapeDecagon_63 PictureCrop_ShapeDecision_127 PictureCrop_ShapeDelay_148 PictureCrop_ShapeDiagonalStripe_71 PictureCrop_ShapeDiamond_58 PictureCrop_ShapeDirectAccessStorage_151 PictureCrop_ShapeDisplay_152 PictureCrop_ShapeDocument_131 PictureCrop_ShapeDodecagon_64 PictureCrop_ShapeDonut_75 PictureCrop_ShapeDoubleBrace_86 PictureCrop_ShapeDoubleBracket_85 PictureCrop_ShapeDoubleWave_124 PictureCrop_ShapeDownArrow_0 PictureCrop_ShapeDownArrowCallout_40 PictureCrop_ShapeDownRibbon_118 PictureCrop_ShapeElbowArrowConnector_155 PictureCrop_ShapeElbowConnector_26 PictureCrop_ShapeElbowDoubleArrowConnector_156 PictureCrop_ShapeEllipse_9 PictureCrop_ShapeExplosion1_106 PictureCrop_ShapeExplosion2_107 PictureCrop_ShapeExtract_145 PictureCrop_ShapeFoldedCorner_78 PictureCrop_ShapeFrame_68 PictureCrop_ShapeGallery PictureCrop_ShapeHalfFrame_69 PictureCrop_ShapeHeart_18 PictureCrop_ShapeHeptagon_61 PictureCrop_ShapeHexagon_60 PictureCrop_ShapeHorizontalScroll_122 PictureCrop_ShapeInternalStorage_130 PictureCrop_ShapeLeftArrow_1 PictureCrop_ShapeLeftArrowCallout_41 PictureCrop_ShapeLeftBrace_89 PictureCrop_ShapeLeftBracket_87 PictureCrop_ShapeLeftRightArrow_2 PictureCrop_ShapeLeftRightArrowCallout_43 PictureCrop_ShapeLeftRightUpArrow_27 PictureCrop_ShapeLeftUpArrow_30 PictureCrop_ShapeLightningBolt_80 PictureCrop_ShapeLineCallout1_94 PictureCrop_ShapeLShape_70 PictureCrop_ShapeMagneticDisk_150 PictureCrop_ShapeManualInput_135 PictureCrop_ShapeManualOperation_136 PictureCrop_ShapeMathDivide_22 PictureCrop_ShapeMathEqual_23 PictureCrop_ShapeMathMinus_20 PictureCrop_ShapeMathMultiply_21 PictureCrop_ShapeMathNotEqual_24 PictureCrop_ShapeMathPlus_19 PictureCrop_ShapeMerge_146 PictureCrop_ShapeMoon_82 PictureCrop_ShapeMultidocument_132 PictureCrop_ShapeNoSymbol_76 PictureCrop_ShapeNotchedRightArrow_36 PictureCrop_ShapeOctagon_62 PictureCrop_ShapeOffpageConnector_138 PictureCrop_ShapeOr_142 PictureCrop_ShapeOvalCallout_92 PictureCrop_ShapeParallelogram_56 PictureCrop_ShapePentagon_37 PictureCrop_ShapePie_65 PictureCrop_ShapePlaque_73 PictureCrop_ShapePredefinedProcess_129 PictureCrop_ShapePreparation_134 PictureCrop_ShapeProcess_125 PictureCrop_ShapePunchedTape_140 PictureCrop_ShapeQuadArrow_47 PictureCrop_ShapeQuadArrowCallout_44 PictureCrop_ShapeRectangle_10 PictureCrop_ShapeRectangularCallout_91 PictureCrop_ShapeRightArrow_3 PictureCrop_ShapeRightArrowCallout_39 PictureCrop_ShapeRightBrace_90 PictureCrop_ShapeRightBracket_88 PictureCrop_ShapeRightTriangle_55 PictureCrop_ShapeRoundDiagonalCornerRectangle_48 PictureCrop_ShapeRoundedRectangle_11 PictureCrop_ShapeRoundedRectangleCallout_6 PictureCrop_ShapeRoundSameSideCornerRectangle_49 PictureCrop_ShapeRoundSingleCornerRectangle_50 PictureCrop_ShapeSequentialActionStorage PictureCrop_ShapeSequentialActionStorage_149 PictureCrop_ShapeSmileyFace_79 PictureCrop_ShapeSnipDiagonalCornerRectangle_52 PictureCrop_ShapeSnipRoundSingleCornerRectangle_51 PictureCrop_ShapeSnipSameSideCornerRectangle_53 PictureCrop_ShapeSnipSingleCornerRectangle_54 PictureCrop_ShapeSort_144 PictureCrop_ShapeSPentagon_59 PictureCrop_ShapeStar10_112 PictureCrop_ShapeStar12_113 PictureCrop_ShapeStar16_114 PictureCrop_ShapeStar24_115 PictureCrop_ShapeStar32_116 PictureCrop_ShapeStar4_108 PictureCrop_ShapeStar5_15 PictureCrop_ShapeStar6_109 PictureCrop_ShapeStar7_110 PictureCrop_ShapeStar8_111 PictureCrop_ShapeStoredData_147 PictureCrop_ShapeStraightConnector_12 PictureCrop_ShapeStraightConnectorArrow_13 PictureCrop_ShapeStraightConnectorTwoArrow_14 PictureCrop_ShapeStripedRightArrow_35 PictureCrop_ShapeSummingJunction_141 PictureCrop_ShapeSun_81 PictureCrop_ShapeTeardrop_67 PictureCrop_ShapeTerminator_133 PictureCrop_ShapeTrapezoid_57 PictureCrop_ShapeTriangle_17 PictureCrop_ShapeUpArrow_4 PictureCrop_ShapeUpArrowCallout_42 PictureCrop_ShapeUpDownArrow_5 PictureCrop_ShapeUpRibbon_117 PictureCrop_ShapeUTurnArrow_29 PictureCrop_ShapeVerticalScroll_121 PictureCrop_ShapeWave_123".split(" ");
this.S0j=["FormatBackgroundStandardColorsFromCanvas","FormatBackgroundThemeColorsFromCanvas","FormatBackgroundThemeColorsMCUFromCanvas"];this.T0j=["FormatBackgroundStandardColorsFromThumbnailPane","FormatBackgroundThemeColorsFromThumbnailPane","FormatBackgroundThemeColorsMCUFromThumbnailPane"];this.lPg="SmartArtLayouts__orgChart1__hierarchy SmartArtLayouts__hList1__list SmartArtLayouts__vList2__list SmartArtLayouts__hierarchy1__hierarchy SmartArtLayouts__chevron2__process SmartArtLayouts__process3__process SmartArtLayouts__hProcess4__process SmartArtLayouts__process5__process SmartArtLayouts__default__list SmartArtLayouts__chevron1__process SmartArtLayouts__cycle2__cycle SmartArtLayouts__process1__process SmartArtLayouts__pyramid1__pyramid SmartArtLayouts__hProcess11__process SmartArtLayouts__cycle5__cycle SmartArtLayouts__lProcess3__process SmartArtLayouts__bProcess2__process SmartArtLayouts__hChevron3__process SmartArtLayouts__hProcess3__process SmartArtLayouts__hProcess9__process SmartArtLayouts__cycle3__cycle SmartArtLayouts__arrow5__relationship SmartArtLayouts__hProcess7__process SmartArtLayouts__arrow1__relationship SmartArtLayouts__equation1__relationship SmartArtLayouts__lProcess2__list SmartArtLayouts__hierarchy3__hierarchy SmartArtLayouts__hierarchy2__hierarchy SmartArtLayouts__hierarchy5__hierarchy SmartArtLayouts__pyramid3__pyramid SmartArtLayouts__hierarchy6__hierarchy SmartArtLayouts__venn3__relationship SmartArtLayouts__cycle7__cycle SmartArtLayouts__cycle6__cycle SmartArtLayouts__hProcess6__process SmartArtLayouts__lProcess1__process SmartArtLayouts__pyramid2__pyramid SmartArtLayouts__radial2__relationship SmartArtLayouts__bProcess3__process SmartArtLayouts__process4__process SmartArtLayouts__hList9__list SmartArtLayouts__hierarchy4__hierarchy SmartArtLayouts__hList3__list SmartArtLayouts__cycle1__cycle SmartArtLayouts__hList6__list SmartArtLayouts__arrow2__process SmartArtLayouts__vList6__process SmartArtLayouts__bProcess4__process SmartArtLayouts__list1__list SmartArtLayouts__equation2__relationship SmartArtLayouts__process2__process SmartArtLayouts__BasicTimeline__timeline SmartArtLayouts__HexagonTimeline__timeline SmartArtLayouts__RoundedRectangleTimeline__timeline SmartArtLayouts__DropPinTimeline__timeline SmartArtLayouts__HorizontalLabelsTimeline__timeline SmartArtLayouts__HorizontalPathTimeline__timeline SmartArtLayouts__AccentHomeChevronProcess__timeline".split(" ");
this.la=a;this.nFd();this.NZh();this.wZh();this.vZh();this.zZh();this.CZh();this.EZh();this.MZh();this.FZh();this.BZh();this.yZh();this.JZh();this.GZh();this.HZh();this.LZh();this.UFd();this.B_h();this.KZh();this.K_h();this.tZh();this.AZh();this.xZh();this.uZh();this.DZh();this.IZh()}K_h(){this.addIconToMap("CheckMark_20","per_QuickSearchCompletedToday_16x16x32");this.addIconToMap("Info_20","per_Info_16x16x32")}nFd(){this.addCommandToMaps(new Va.a("AddSection","2203490252"));this.addCommandToMaps(new Va.a("AlternativeText",
"3296909722"));this.addCommandToMaps(new Va.a("AlignAnchor","3320425830"));this.addCommandToMaps(Object.assign(new Va.a("AlwaysUseSubtitles","1906012838"),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:"3244674241"}));this.addCommandToMaps(new Va.a("ArrangeAnchor","200712034"));this.addCommandToMaps(Object.assign(new Va.a("AudioSettings","2346722376"),{queryCommandId:"1234363616"}));this.addCommandToMaps(new Va.a("LivePollTaskPane","3902591294"));this.addCommandToMaps(new Va.a("ArrangeShapeAnchor",
"200712034"));this.addCommandToMaps(new Va.a("BeginEditShapeText","3618312345"));this.addCommandToMaps(Object.assign(new Va.a("Bold","2913964"),{queryCommandId:"2523547740"}));this.addCommandToMaps(Object.assign(new Va.a("BottomOverlaid","348484772"),{legacyControlId:"PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",queryCommandId:"1824785548"}));this.addCommandToMaps(new Va.a("BringToFrontFlyout","4230958419"));this.addCommandToMaps(new Va.a("BringForward","3270113035"));this.addCommandToMaps(new Va.a("BringToFront",
"2814941514"));this.addCommandToMaps(Object.assign(new Va.a("BulletLibrary","3627016479"),{legacyControlId:"PptRibbon.Home.Paragraph.BulletGallery",queryCommandId:"2324278473",populationProps:new Og("1142350707",!1)}));this.addCommandToMaps(Object.assign(new Va.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Va.a("ChangeCaseCapitalizeEachWord","1880533947"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Capitalization"}));
this.addCommandToMaps(Object.assign(new Va.a("ChangeCaseLower","768894625"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Lower"}));this.addCommandToMaps(Object.assign(new Va.a("ChangeCaseMenuEnabled","3679012070"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase"}));this.addCommandToMaps(Object.assign(new Va.a("ChangeCaseSentence","2981608035"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.SentenceCase"}));this.addCommandToMaps(Object.assign(new Va.a("ChangeCaseToggle","3502060538"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.ToggleCase"}));
this.addCommandToMaps(Object.assign(new Va.a("ChangeCaseUpper","4291024442"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Upper"}));this.addCommandToMaps(new Va.a("ChangeLayout","4017322732"));this.addCommandToMaps(Object.assign(new Va.a("ChangeGraphicContextMenu","1373490814"),{legacyControlId:"PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Va.a("ChangeGraphicFlyout","1373490814"),{legacyControlId:"PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"}));
this.addCommandToMaps(Object.assign(new Va.a("ChangePicture","2958402736"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.ChangePicture"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureContextMenu","3244031780"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureContextMenuBing","3565639685"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureContextMenuM365",
"148018230"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureContextMenuIcons","1332899609"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureContextMenuDevice","2958402736"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureContextMenuOneDrive",
"2057552935"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost",queryCommandId:"3612507612"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureContextMenuMobileDevice","1101801264"),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureFlyout","3244031780"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureFlyoutBing","3565639685"),
{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureFlyoutM365","148018230"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureFlyoutIcons","1332899609"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureFlyoutDevice","2958402736"),
{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureFlyoutOneDrive","2057552935"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost",queryCommandId:"3612507612"}));this.addCommandToMaps(Object.assign(new Va.a("ChangePictureFlyoutMobileDevice","1101801264"),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Va.a("ChangeSmartArtColorAnchor","396312034"),
{populationProps:new Og("3273638293",!1)}));this.addCommandToMaps(new Va.a("CheckAccessibility","2295549531"));this.addCommandToMaps(Object.assign(new Va.a("ClearFormatting","2319895756"),{legacyControlId:"PptRibbon.Home.Font.ClearFormatting"}));this.addCommandToMaps(new Va.a("ClearTableFormatting","3835123874"));this.addCommandToMaps(Object.assign(new Va.a("CommentsPane","1991203991"),{queryCommandId:"3845423030"}));this.addCommandToMaps(new Va.a("CopyHyperlink","3037606367"));this.addCommandToMaps(Object.assign(new Va.a("ContextMenu",
"1451516907"),{populationProps:new Og("2071563036",!1)}));this.addCommandToMaps(Object.assign(new Va.a("SelectionPane","654924585"),{queryCommandId:"2763753566"}));this.addCommandToMaps(Object.assign(new Va.a("RenderFooterPane","1278690195"),{queryCommandId:"2945242850"}));this.addCommandToMaps(new Va.a("InsertSlideNumber","150011355"));this.addCommandToMaps(Object.assign(new Va.a("RenderSelectionPane","654924585"),{queryCommandId:"2763753566"}));this.addCommandToMaps(Object.assign(new Va.a("CommentsShowMarkUp",
"410757179"),{queryCommandId:"992822777"}));this.addCommandToMaps(Object.assign(new Va.a("CommentsShowAdvancedMarkUp","1016800201"),{queryCommandId:"775043447"}));this.addCommandToMaps(new Va.a("Copy","49968134"));this.addCommandToMaps(new Va.a("CopyInVersionHistory","2758158609"));this.addCommandToMaps(new Va.a("ClickVersionHistoryRestore","2138207060"));this.addCommandToMaps(new Va.a("ClickVersionHistorySaveACopy","2623258827"));this.addCommandToMaps(new Va.a("ClickVersionHistoryDownloadVersion",
"1316171850"));this.addCommandToMaps(new Va.a("Cut","158451065"));this.addCommandToMaps(new Va.a("Delete","1680865470"));this.addCommandToMaps(new Va.a("DeleteAllCommentsInPresentation","1737510757"));this.addCommandToMaps(new Va.a("DeleteAllCommentsInSlide","469473574"));this.addCommandToMaps(new Va.a("DeleteAllResolvedComments","2766426586"));this.addCommandToMaps(Object.assign(new Va.a("DeleteComment","869210402"),{queryCommandId:"2614767758"}));this.addCommandToMaps(new Va.a("DeleteRepeatedWord",
"2023591105"));this.addCommandToMaps(new Va.a("DeleteSlide","1235090158"));this.addCommandToMaps(Object.assign(new Va.a("DesignerHome","3070664289"),{legacyControlId:"PptRibbon.Home.ShowHide.Designer",queryCommandId:"562763405"}));this.addCommandToMaps(Object.assign(new Va.a("DesignerNew","4250022162"),{legacyControlId:"PptRibbon.Design.ShowHide.Designer.New",queryCommandId:"562763405"}));this.addCommandToMaps(Object.assign(new Va.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",
populationProps:new Og("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Va.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(new Va.a("DoNotCheckThisCritiqueType","2157977488"));this.addCommandToMaps(new Va.a("Duplicate","486800848"));this.addCommandToMaps(new Va.a("DuplicateSlide","3006547192"));this.addCommandToMaps(new Va.a("EditHyperlink","2711544537"));this.addCommandToMaps(Object.assign(new Va.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));
this.addCommandToMaps(Object.assign(new Va.a("EditInAppWithIcon","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Va.a("EditorPane","97211136"),{legacyControlId:"PptRibbon.Review.Proofing.EditorPane",queryCommandId:"974334176"}));this.addCommandToMaps(Object.assign(new Va.a("EditorPaneSplitButton","97211136"),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButton",queryCommandId:"2161272628"}));this.la.aWf&&this.addCommandToMaps(Object.assign(new Va.a("DexLitePane",
ba.a.dhd.toString()),{queryCommandId:ba.a.iad.toString()}));this.addCommandToMaps(new Va.a("Find","1891435765"));this.addCommandToMaps(new Va.a("FitToWindow","2470172091"));this.addCommandToMaps(Object.assign(new Va.a("FixIt","3100655080"),{legacyControlId:"FixIt",queryCommandId:"1559931984"}));this.addCommandToMaps(Object.assign(new Va.a("FontColor","3314514081"),{populationProps:new Og("3238769791",!1)}));this.addCommandToMaps(Object.assign(new Va.a("FontPicker","3430668515"),{legacyControlId:"fontPicker",
queryCommandId:"3287122076",populationProps:new Og("1965039802",!0)}));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Va.a("FontName","3145621451"),{queryCommandId:"1052225825",populationProps:new Og("2923358157",!1),commandPreviewId:"539266573",commandRevertId:"1026923615"})),this.addCommandToMaps(Object.assign(new Va.a("FontSize","2016320825"),{queryCommandId:"3075296939",commandPreviewId:"4169085911",commandRevertId:"200151849"}))):(this.addCommandToMaps(Object.assign(new Va.a("FontName",
"3145621451"),{queryCommandId:"1052225825",populationProps:new Og("2923358157",!1)})),this.addCommandToMaps(Object.assign(new Va.a("FontSize","2016320825"),{queryCommandId:"3075296939"})));this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundApplyToAll","2080761994"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundPicture","2640793597"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundSolidFill","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new Og("3004618427",!1)}));this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundStandardColors","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundThemeColors","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundThemeColorsMCU","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(new Va.a("FormatBackgroundRecentColors","1912773268"));this.addCommandToMaps(Object.assign(new Va.a("FormatPainter","3794362040"),{queryCommandId:"3309569663"}));this.addCommandToMaps(Object.assign(new Va.a("HideProofingErrors","3041519999"),{legacyControlId:"PptRibbon.Review.Proofing.HideProofingErrors",queryCommandId:"3699667717"}));
this.addCommandToMaps(Object.assign(new Va.a("GiveFeedback","2918242107"),{legacyControlId:"btnFeedback"}));this.addCommandToMaps(Object.assign(new Va.a("GrammarOptions","3380187414"),{legacyControlId:"PptRibbon.Review.Proofing.GrammarOptions"}));this.addCommandToMaps(Object.assign(new Va.a("ProofingOptions","3380187414"),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButtonFallback"}));this.addCommandToMaps(Object.assign(new Va.a("Grow","3444541960"),{legacyControlId:"PptRibbon.Home.Font.Grow"}));
this.addCommandToMaps(Object.assign(new Va.a("HideSlide","3945504187"),{queryCommandId:"3032837727"}));this.la.c4d&&this.addCommandToMaps(new Va.a("UnhideSlide","1774836750"));this.addCommandToMaps(Object.assign(new Va.a("Highlight","2904102419"),{legacyControlId:"PptRibbon.Home.Font.FontBackgroundColor"}));this.addCommandToMaps(new Va.a("HighlighterColor","1784019754"));this.addCommandToMaps(new Va.a("IgnoreSpellingError","3549510372"));this.addCommandToMaps(new Va.a("Indent","1288324077"));this.addCommandToMaps(new Va.a("InsertAddIns",
"2300394269"));this.addCommandToMaps(new Va.a("InsertAddInsFromBackstage","2300394269"));this.addCommandToMaps(new Va.a("InsertComment","1221260928"));this.addCommandToMaps(Object.assign(new Va.a("InsertIcons","3143141002"),{legacyControlId:"InsertIconDialog"}));this.addCommandToMaps(new Va.a("InsertLink","2711544537"));this.addCommandToMaps(new Va.a("InsertSocialMediaVideo","1182875165"));this.addCommandToMaps(new Va.a("InsertPicturesFlyoutDalle","4268462963"));this.addCommandToMaps(new Va.a("InsertPicturesDalle",
"2421869509"));this.addCommandToMaps(new Va.a("InsertLiveFeed","791426823"));this.addCommandToMaps(Object.assign(new Va.a("InsertOnlineVideo","2948423841"),{legacyControlId:"PptRibbon.InsertTab.Media.OnlineVideo"}));this.addCommandToMaps(Object.assign(new Va.a("InsertPicturesFlyout","4210426229"),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture"}));this.addCommandToMaps(Object.assign(new Va.a("InsertPicturesFlyoutBing","1685987254"),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture.FromSearch"}));
var a;this.addCommandToMaps((a=new Va.a("InsertPicturesFlyoutM365","2691408781"),a.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",a));let b;this.addCommandToMaps((b=new Va.a("InsertPicturesM365","2582565347"),b.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",b));let c;this.addCommandToMaps((c=new Va.a("InsertPicturesFlyoutDevice","1403967063"),c.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromDevice",c));let f;this.addCommandToMaps((f=new Va.a("InsertPicturesFlyoutOneDrive",
"720118144"),f.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromHost",f.queryCommandId="3612507612",f));let l;this.addCommandToMaps((l=new Va.a("InsertPicturesFlyoutMobileDevice","509870209"),l.legacyControlId="InsertPictureFromMobileDevice",l));this.addCommandToMaps(new Va.a("InsertSlides","2325171983"));let x;this.addCommandToMaps((x=new Va.a("NewSlideSplit","82992945"),x.populationProps=new Og("82992945",!1),x));let F;this.addCommandToMaps((F=new Va.a("InsertSlideSplit","82992945"),F.populationProps=
new Og("82992945",!1),F));this.addCommandToMaps(new Va.a("NewDefaultSlide","3455582195"));let R;this.addCommandToMaps((R=new Va.a("ChangeLayoutFlyout","3827850816"),R.populationProps=new Og("3827850816",!1),R));this.addCommandToMaps(new Va.a("InsertTextBox","621502440"));this.addCommandToMaps(new Va.a("InsertAudio","1970478872"));let fa;this.addCommandToMaps((fa=new Va.a("InsertFooterFlyout","3104125356"),fa.legacyControlId="PptRibbon.InsertTab.FooterFlyout",fa));let wa;this.addCommandToMaps((wa=
new Va.a("InsertSymbol","3471878106"),wa.populationProps=new Og("1256496096",!0),wa));this.addCommandToMaps(new Va.a("InsertTable","975293073"));this.addCommandToMaps(new Va.a("InvokeFilesSerplet","2670256092"));let Xa;this.addCommandToMaps((Xa=new Va.a("Italic","2465268493"),Xa.queryCommandId="1611154215",Xa));this.addCommandToMaps(new Va.a("LeftToRight","3104595117"));let lb;this.addCommandToMaps((lb=new Va.a("LineSpacing","2060090051"),lb.legacyControlId="PptRibbon.Home.Paragraph.LineSpacing",
lb.populationProps=new Og("1834449059",!1),lb));let Lb;this.addCommandToMaps((Lb=new Va.a("LineSpacingButton1_00","2116781230"),Lb.queryCommandId="35350118",Lb.menuItemId="1.00",Lb));let kc;this.addCommandToMaps((kc=new Va.a("LineSpacingButton1_50","2116781230"),kc.queryCommandId="35350118",kc.menuItemId="1.50",kc));let lc;this.addCommandToMaps((lc=new Va.a("LineSpacingButton2_00","2116781230"),lc.queryCommandId="35350118",lc.menuItemId="2.00",lc));let Ec;this.addCommandToMaps((Ec=new Va.a("LineSpacingButton2_50",
"2116781230"),Ec.queryCommandId="35350118",Ec.menuItemId="2.50",Ec));let Jc;this.addCommandToMaps((Jc=new Va.a("LineSpacingButton3_00","2116781230"),Jc.queryCommandId="35350118",Jc.menuItemId="3.00",Jc));this.addCommandToMaps(new Va.a("LineSpacingOptionsForParagraphDialog","2465215107"));this.addCommandToMaps(new Va.a("MarkActivitiesAsRead","4050369966"));let Dc;this.addCommandToMaps((Dc=new Va.a("ModeSwitcherEditing","3913721881"),Dc.queryCommandId="1628548419",Dc.legacyControlId="ModeSwitcherModeEditing",
Dc));let Wd;this.addCommandToMaps((Wd=new Va.a("ModeSwitcherViewing","1819007276"),Wd.queryCommandId="805191912",Wd.legacyControlId="ModeSwitcherModeViewing",Wd));this.addCommandToMaps(new Va.a("ModeSwitcher","951953502"));this.addCommandToMaps(new Va.a("MoreSymbols","3574218963"));let xe;this.addCommandToMaps((xe=new Va.a("MoreVariantsAnchor","2759977169"),xe.queryCommandId="1425701611",xe.populationProps=new Og("1296027845",!1),xe.previewControlIds=["Variant1","Variant2","Variant3","Variant4"],
xe));this.addCommandToMaps(new Va.a("MoveEarlier","3807076847"));this.addCommandToMaps(new Va.a("MoveLater","1987590765"));this.addCommandToMaps(new Va.a("MoveSectionDown","28073490"));this.addCommandToMaps(new Va.a("MoveSectionUp","1653897933"));let Sd;this.addCommandToMaps((Sd=new Va.a("NewComment","1221260928"),Sd.queryCommandId="3603834084",Sd));this.addCommandToMaps(new Va.a("NewSlide","2325171983"));this.addCommandToMaps(new Va.a("NewSlideWithoutDialog","3455582195"));let Pe;this.addCommandToMaps((Pe=
new Va.a("NextComment","1216077466"),Pe.queryCommandId="960339554",Pe));this.addCommandToMaps(new Va.a("NoHighlight","562361573"));let Ue;this.addCommandToMaps((Ue=new Va.a("Notes","3113372712"),Ue.queryCommandId="850829913",Ue));let Ef;this.addCommandToMaps((Ef=new Va.a("NumberingLibrary","1839018819"),Ef.legacyControlId="PptRibbon.Home.Paragraph.NumberedGallery",Ef.queryCommandId="3839110149",Ef.populationProps=new Og("579378886",!1),Ef));this.addCommandToMaps(new Va.a("OpenHyperlink","2898648224"));
this.addCommandToMaps(new Va.a("OpenPowerPointLanguageDialog","3274206189"));let dg;this.addCommandToMaps((dg=new Va.a("OpenSetSlideSizeDialog","2541495854"),dg.queryCommandId="3939319117",dg));this.addCommandToMaps(new Va.a("OpenVersionHistory","3828599598"));this.addCommandToMaps(new Va.a("Outdent","3770030225"));this.addCommandToMaps(new Va.a("ParagraphOptions","2465215107"));this.addCommandToMaps(new Va.a("Paste","3642315978"));this.addCommandToMaps(new Va.a("PasteGalleryIcon","3642315978"));
this.addCommandToMaps(new Va.a("PasteKeepingDestinationTheme","4207422373"));this.addCommandToMaps(new Va.a("PasteKeepingSourceFormatting","2529825506"));let Mg;this.addCommandToMaps((Mg=new Va.a("PasteTextOnlyGalleryIcon","2061487721"),Mg.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",Mg));this.addCommandToMaps(new Va.a("PasteAsImage","1302928870"));let Bg;this.addCommandToMaps((Bg=new Va.a("PasteSlideKeepDestinationFromClipService","771058974"),Bg.queryCommandId="565176158",Bg));let Lf;this.addCommandToMaps((Lf=
new Va.a("PasteSlideKeepSourceFromClipService","756680259"),Lf.queryCommandId="565176158",Lf));let mh;this.addCommandToMaps((mh=new Va.a("PasteTextOnly","2061487721"),mh.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",mh));this.addCommandToMaps(new Va.a("PlayFromBeginning","3477644587"));this.addCommandToMaps(new Va.a("PlayFromBeginningTopBar","4039328901"));this.addCommandToMaps(new Va.a("PlayFromCurrentSlide","1989200744"));let Fg;this.addCommandToMaps((Fg=new Va.a("PresentLive","1637880125"),
Fg.legacyControlId="PresentLive",Fg));let ii;this.addCommandToMaps((ii=new Va.a("PresentLiveTopBar","1865567899"),ii.legacyControlId="PresentLiveTopBar",ii));let Li;this.addCommandToMaps((Li=new Va.a("PresentLiveSetAccessControlAnyone","946150894"),Li.legacyControlId="PresentLiveSetAccessControlAnyone",Li.queryCommandId="677830988",Li));let wj;this.addCommandToMaps((wj=new Va.a("PresentLiveSetAccessControlOrganization","2341101003"),wj.legacyControlId="PresentLiveSetAccessControlOrganization",wj.queryCommandId=
"289063903",wj));let cj;this.addCommandToMaps((cj=new Va.a("PresentLiveConsumer","1637880125"),cj.legacyControlId="PresentLiveConsumer",cj));let dj;this.addCommandToMaps((dj=new Va.a("PresentLiveEnterprise","1637880125"),dj.legacyControlId="PresentLiveEnterprise",dj));let yi;this.addCommandToMaps((yi=new Va.a("PresentToTeams","455397214"),yi.legacyControlId="PresentToTeams",yi));let Hk;this.addCommandToMaps((Hk=new Va.a("PresentToTeamsTopBar","3640090982"),Hk.legacyControlId="PresentToTeamsTopBar",
Hk));let xj;this.addCommandToMaps((xj=new Va.a("PreviousComment","3774691014"),xj.queryCommandId="1093530254",xj));this.addCommandToMaps(new Va.a("ReadingView","3849298593"));let uk;this.addCommandToMaps((uk=new Va.a("PictureCrop","1517579890"),uk.queryCommandId="3115882543",uk));this.addCommandToMaps(new Va.a("PictureCropAnchor","3997897477"));let Gl;this.addCommandToMaps((Gl=new Va.a("PictureCropMoreOptions","1751580504"),Gl.queryCommandId="2750148704",Gl));this.addCommandToMaps(new Va.a("Redo",
"4096109295"));let gl;this.addCommandToMaps((gl=new Va.a("RehearsalFeedbackSettings","4006743010"),gl.legacyControlId="PptRibbon.View.Coach.Menu.FeedbackSettings",gl.queryCommandId="4191121318",gl));let Hl;this.addCommandToMaps((Hl=new Va.a("RehearsePresentation","1256345977"),Hl.legacyControlId="PptRibbon.View.Coach.RehearseWithCoach",Hl));let Yj;this.addCommandToMaps((Yj=new Va.a("RehearsePresentationTopBar","4242063947"),Yj.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachTopBar",Yj));let Oj;
this.addCommandToMaps((Oj=new Va.a("RehearsePresentationDropDown","2954393506"),Oj.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachSplit",Oj));this.addCommandToMaps(new Va.a("RemoveHyperlink","3041840712"));this.addCommandToMaps(new Va.a("RemoveSection","3170937055"));this.addCommandToMaps(new Va.a("RenameSection","2116436229"));this.addCommandToMaps(new Va.a("Replace","3610473921"));this.addCommandToMaps(new Va.a("ResetPicture","2916220093"));this.addCommandToMaps(new Va.a("ResetPictureAndSize",
"196543355"));this.addCommandToMaps(new Va.a("ResetPictureSplitButton","539331929"));this.addCommandToMaps(new Va.a("RightToLeft","3544607309"));this.addCommandToMaps(new Va.a("RotateAnchor","508548220"));this.addCommandToMaps(new Va.a("RotateShapeAnchor","1974731707"));let Zj;this.addCommandToMaps((Zj=new Va.a("RotateLeft","3198368600"),Zj.commandPreviewId="3069929632",Zj.commandRevertId="2958393181",Zj));let Wk;this.addCommandToMaps((Wk=new Va.a("RotateRight","4074498273"),Wk.commandPreviewId="1789937815",
Wk.commandRevertId="2958393181",Wk));this.addCommandToMaps(new Va.a("RotateFlipVertical","2497743792"));this.addCommandToMaps(new Va.a("RotateFlipHorizontal","2421665126"));this.addCommandToMaps(new Va.a("SelectHyperlink","942179484"));this.addCommandToMaps(new Va.a("SendBackward","565697619"));this.addCommandToMaps(new Va.a("SendToBack","3409991090"));this.addCommandToMaps(new Va.a("SendToBackFlyout","380857685"));this.la.YMa&&(this.addCommandToMaps(new Va.a("SetAnimationDuration","2191769768")),
this.addCommandToMaps(new Va.a("SetAnimationDelay","3045176093")),this.addCommandToMaps(new Va.a("AnimationStart","3585107924")),a=new Va.a("AnimationPane","2041032783"),a.queryCommandId="3793934102",this.addCommandToMaps(a));let Hj;this.addCommandToMaps((Hj=new Va.a("SetHeight","2298348760"),Hj.queryCommandId="1846108968",Hj));let nh;this.addCommandToMaps((nh=new Va.a("SetWidth","3074609079"),nh.queryCommandId="2155304935",nh));let hl;this.addCommandToMaps((hl=new Va.a("SetSlideSize","410316994"),
hl.legacyControlId="PptRibbon.Design.Customize.SetSlideSizeAnchor",hl));let Wl;this.addCommandToMaps((Wl=new Va.a("SetSlideSize4x3","991302939"),Wl.queryCommandId="117694331",Wl));let xm;this.addCommandToMaps((xm=new Va.a("SetSlideSize16x9","1045213174"),xm.queryCommandId="3694235222",xm));let Ik;this.addCommandToMaps((Ik=new Va.a("SetTransitionApplyAll","36898206"),Ik.queryCommandId="1981682194",Ik));this.addCommandToMaps(Object.assign(new Va.a("SetTransitionDuration","2632939091"),{queryCommandId:"1116601283"}));
this.addCommandToMaps(new Va.a("ShapeAlignAnchor","3459695103"));this.addCommandToMaps(new Va.a("ShapeAlignLeft","3305017221"));this.addCommandToMaps(new Va.a("ShapeAlignRight","1461684922"));this.addCommandToMaps(new Va.a("ShapeAlignTop","4227848161"));this.addCommandToMaps(new Va.a("ShapeAlignBottom","3217780865"));this.addCommandToMaps(new Va.a("ShapeAlignCenter","716806441"));this.addCommandToMaps(new Va.a("ShapeAlignMiddle","3185305339"));this.addCommandToMaps(Object.assign(new Va.a("ShapeAlignToSlide",
"3006728226"),{queryCommandId:"3837288634"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeAlignToSelectedObjects","96121440"),{queryCommandId:"4251588920"}));this.addCommandToMaps(new Va.a("ShareSlide","4016340186"));this.addCommandToMaps(new Va.a("DistributeShapesVertically","56689666"));this.addCommandToMaps(Object.assign(new Va.a("ImmersiveReader","1676602274"),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(Object.assign(new Va.a("ImmersiveReaderRibbon","4161584078"),{legacyControlId:"fseaImmersiveReader"}));
this.addCommandToMaps(new Va.a("DistributeShapesHorizontally","1208810892"));this.addCommandToMaps(new Va.a("ShareSlide","4016340186"));this.addCommandToMaps(Object.assign(new Va.a("Shrink","3739304922"),{legacyControlId:"PptRibbon.Home.Font.Shrink"}));this.addCommandToMaps(Object.assign(new Va.a("ShowCommentsTopBar","2281051331"),{legacyControlId:"ShowCommentsTopBar",queryCommandId:"847427893"}));this.addCommandToMaps(Object.assign(new Va.a("ShowComments","1991203991"),{queryCommandId:"3845423030"}));
this.addCommandToMaps(Object.assign(new Va.a("ShowEditTriPaneView","12696731"),{queryCommandId:"363623614"}));this.addCommandToMaps(Object.assign(new Va.a("ShowHideChanges","3927853644"),{queryCommandId:"3387413100"}));let vk;this.addCommandToMaps((vk=new Va.a("ShowHideComments","1991203991"),vk.legacyControlId="PptRibbon.View.ShowHide.CommentsSplitButton",vk.queryCommandId="3845423030",vk));let ji;this.addCommandToMaps((ji=new Va.a("ShowHideCommentsInReview","1991203991"),ji.queryCommandId="3845423030",
ji));let ng;this.addCommandToMaps((ng=new Va.a("ShowHideRuler","2898025271"),ng.legacyControlId="btnShowHideRuler",ng.queryCommandId="2852668822",ng));this.addCommandToMaps(new Va.a("ShowRevisionTrackingWithUrlOverrides","3206663165"));let ki;this.addCommandToMaps((ki=new Va.a("ShowMarkup","410757179"),ki.queryCommandId="992822777",ki));let Rf;this.addCommandToMaps((Rf=new Va.a("ShowTranslatePane","119484543"),Rf.legacyControlId="PptRibbon.Review.Show.Translate",Rf));let zd;this.addCommandToMaps((zd=
new Va.a("ShowSmartLookupPane","4195071443"),zd.legacyControlId="PptRibbon.Review.Show.SmartLookup",zd));this.addCommandToMaps(new Va.a("SmartLookupContextMenu","2861781337"));this.addCommandToMaps(new Va.a("SmartLookupSynonyms","720345883"));let ne;this.addCommandToMaps((ne=new Va.a("ShowSorterView","1659792175"),ne.queryCommandId="2246678568",ne));let yf;this.addCommandToMaps((yf=new Va.a("ShowVersionHistoryDialog","466976539"),yf.legacyControlId="PptJewel.Info.VersionHistory",yf));let Zd;this.addCommandToMaps((Zd=
new Va.a("SpokenLanguage","1014932740"),Zd.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage",Zd.queryCommandId="1014932740",Zd.populationProps=new Og("1014932740",!0),Zd));this.addCommandToMaps(new Va.a("StandardFontColorPicker","3314514081"));let vg;this.addCommandToMaps((vg=new Va.a("Strikethrough","1470251202"),vg.legacyControlId="PptRibbon.Home.Font.Strikethrough",vg.queryCommandId="1885033626",vg));let $h;this.addCommandToMaps(($h=new Va.a("SubtitleLanguage","3756604230"),
$h.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage",$h.queryCommandId="3756604230",$h.populationProps=new Og("3756604230",!0),$h));let zi;this.addCommandToMaps((zi=new Va.a("SubtitleSettingsAnchor","2442582554"),zi.legacyControlId="PptRibbon.View.Subtitles.SubtitleSettings",zi));let Yo;this.addCommandToMaps((Yo=new Va.a("Subscript","2764952028"),Yo.legacyControlId="PptRibbon.Home.Font.Subscript",Yo.queryCommandId="1002244424",Yo));let hk;this.addCommandToMaps((hk=new Va.a("Superscript",
"3148114157"),hk.legacyControlId="PptRibbon.Home.Font.Superscript",hk.queryCommandId="2241670795",hk));this.addCommandToMaps(new Va.a("TabSwitch","3190032724"));this.addCommandToMaps(new Va.a("TextAlignmentAnchor","2988805339"));let Xo;this.addCommandToMaps((Xo=new Va.a("TextAlignmentCenterJustify","33632174"),Xo.queryCommandId="2252885982",Xo));let ws;this.addCommandToMaps((ws=new Va.a("TextAlignmentFullJustify","1344066782"),ws.legacyControlId="PptRibbon.Home.Paragraph.FullJustify",ws.queryCommandId=
"2466914778",ws));let Dt;this.addCommandToMaps((Dt=new Va.a("TextAlignmentLeftJustify","1845468918"),Dt.queryCommandId="712471458",Dt));let Et;this.addCommandToMaps((Et=new Va.a("TextAlignmentRightJustify","3813372745"),Et.queryCommandId="3610192823",Et));let Ft;this.addCommandToMaps((Ft=new Va.a("TextAnchoringBottom","4124180856"),Ft.queryCommandId="4231771752",Ft));let Gt;this.addCommandToMaps((Gt=new Va.a("TextAnchoringMiddle","1377620466"),Gt.queryCommandId="967867926",Gt));let Ht;this.addCommandToMaps((Ht=
new Va.a("TextAnchoringTop","3318339922"),Ht.queryCommandId="1945464878",Ht));this.addCommandToMaps(new Va.a("ThemeFontColorPicker","3314514081"));this.addCommandToMaps(new Va.a("ThemeFontColorPickerMCU","3314514081"));let xs;this.addCommandToMaps((xs=new Va.a("TopOverlaid","3728831786"),xs.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",xs.queryCommandId="87234146",xs));let It;this.addCommandToMaps((It=new Va.a("Underline","704785013"),It.queryCommandId="451272227",It));this.addCommandToMaps(new Va.a("Undo",
"2066390191"));let YA;this.addCommandToMaps((YA=new Va.a("UsePresenterView","1082097282"),YA.queryCommandId="2289226602",YA));this.addCommandToMaps(new Va.a("Zoom","3864281841"));let xy;this.addCommandToMaps((xy=new Va.a("ToggleUseSubtitles","1906012838"),xy.legacyControlId="PptRibbon.View.Subtitles.UseSubtitles",xy.queryCommandId="3244674241",xy));let ZA;this.addCommandToMaps((ZA=new Va.a("ToggleShapeAlignToSlide","3006728226"),ZA.queryCommandId="3837288634",ZA));let $A;this.addCommandToMaps(($A=
new Va.a("ToggleShapeAlignToSelectedObjects","96121440"),$A.queryCommandId="4251588920",$A));let yy;this.addCommandToMaps((yy=new Va.a("ToggleSubtitlesBottomOverlay","348484772"),yy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",yy.queryCommandId="1824785548",yy));let zy;this.addCommandToMaps((zy=new Va.a("ToggleSubtitlesTopOverlay","3728831786"),zy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",zy.queryCommandId="87234146",zy));let Ay;this.addCommandToMaps((Ay=
new Va.a("ToggleRehearsalVisionEnabled","2400267914"),Ay.legacyControlId="PptRibbon.View.Coach.Menu.Vision",Ay.queryCommandId="2360689666",Ay));let aB;this.addCommandToMaps((aB=new Va.a("HostOpenInClient","3588168074"),aB.legacyControlId="HostOpenInClient",aB));let By;this.addCommandToMaps((By=new Va.a("ToggleSubtitlesBelowSlide","3783536693"),By.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",By.queryCommandId="793233593",By));let Cy;this.addCommandToMaps((Cy=new Va.a("ToggleSubtitlesAboveSlide",
"3886090397"),Cy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",Cy.queryCommandId="3771385025",Cy));let Dy;this.addCommandToMaps((Dy=new Va.a("BelowSlide","3783536693"),Dy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",Dy.queryCommandId="793233593",Dy));let Ey;this.addCommandToMaps((Ey=new Va.a("AboveSlide","3886090397"),Ey.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",Ey.queryCommandId="3771385025",Ey));let bB;this.addCommandToMaps((bB=
new Va.a("PreviousVersions","3681556347"),bB.legacyControlId="PptJewel.Info.FileVersion",bB));this.addCommandToMaps(new Va.a("Present","149770451"));this.addCommandToMaps(new Va.a("PresentDropDown","2832668252"))}DZh(){this.addCommandToMaps(Object.assign(new Va.a("CenterJustify","33632174"),{queryCommandId:"2252885982"}));this.addCommandToMaps(Object.assign(new Va.a("FullJustify","1344066782"),{queryCommandId:"2466914778"}));this.addCommandToMaps(Object.assign(new Va.a("LeftJustify","1845468918"),
{queryCommandId:"712471458"}));this.addCommandToMaps(Object.assign(new Va.a("RightJustify","3813372745"),{queryCommandId:"3610192823"}));this.addCommandToMaps(Object.assign(new Va.a("TextAnchoringAnchor","4088099806"),{queryCommandId:"4088099806"}));this.addCommandToMaps(Object.assign(new Va.a("AlignBottom","4124180856"),{queryCommandId:"4231771752"}));this.addCommandToMaps(Object.assign(new Va.a("AlignMiddle","1377620466"),{queryCommandId:"967867926"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTop",
"3318339922"),{queryCommandId:"1945464878"}));this.addCommandToMaps(Object.assign(new Va.a("UseSubtitles","1906012838"),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:"3244674241"}));this.addCommandToMaps(Object.assign(new Va.a("SubtitleSettings","2442582554"),{legacyControlId:"PptRibbon.View.Subtitles.SubtitleSettings"}));this.addCommandToMaps(new Va.a("NewBringForwardAnchorMLR","200712034"));this.addCommandToMaps(new Va.a("NewSendBackwardAnchorMLR","200712034"));this.addCommandToMaps(new Va.a("PowerPointGroupFlyoutAnchorMLR",
"3206512596"));this.addCommandToMaps(Object.assign(new Va.a("SetLockAspectRatio","3110635152"),{queryCommandId:"393974196"}));this.addCommandToMaps(Object.assign(new Va.a("SetTableHeight","2276581567"),{queryCommandId:"2124999663"}));this.addCommandToMaps(Object.assign(new Va.a("SetTableWidth","1330950330"),{queryCommandId:"1194765274"}));this.addCommandToMaps(Object.assign(new Va.a("SetTableColumnWidth","673579960"),{queryCommandId:"480435988"}));this.addCommandToMaps(Object.assign(new Va.a("SetTableRowHeight",
"1676474821"),{queryCommandId:"2851222057"}));this.addCommandToMaps(Object.assign(new Va.a("UpdatePictureCropWidth","3859579721"),{queryCommandId:"2405860646"}));this.addCommandToMaps(Object.assign(new Va.a("UpdatePictureCropHeight","2435251774"),{queryCommandId:"520230123"}));this.addCommandToMaps(Object.assign(new Va.a("UpdatePictureCropLeft","436396424"),{queryCommandId:"1395081307"}));this.addCommandToMaps(Object.assign(new Va.a("UpdatePictureCropTop","1511741212"),{queryCommandId:"4078650667"}));
this.addCommandToMaps(Object.assign(new Va.a("Paste_MLR","3642315978"),{queryCommandId:"616071690"}));this.addCommandToMaps(new Va.a("PasteKeepingDestinationThemeMLR","4207422373"));this.addCommandToMaps(new Va.a("PasteKeepingSourceFormattingMLR","2529825506"));this.addCommandToMaps(new Va.a("PasteAsImageMLR","1302928870"));this.addCommandToMaps(Object.assign(new Va.a("TableCellBottomAnchoringMLR","4124180856"),{queryCommandId:"4231771752"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellCenterJustifyMLR",
"33632174"),{queryCommandId:"2252885982"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellLeftJustifyMLR","1845468918"),{queryCommandId:"712471458"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellMiddleAnchoringMLR","1377620466"),{queryCommandId:"967867926"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellRightJustifyMLR","3813372745"),{queryCommandId:"3610192823"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellTopAnchoringMLR","3318339922"),{queryCommandId:"1945464878"}));
this.addCommandToMaps(new Va.a("ParagraphOptionsMLR","2465215107"));this.addCommandToMaps(new Va.a("Delete_MLR","1680865470"));this.addCommandToMaps(new Va.a("SmartArtStylesMLR","3002291327"));this.addCommandToMaps(new Va.a("PictureCropMLR","1775519606"))}UFd(){this.addTabToMap("FormatShape","107954394");this.addTabToMap("FormatPicture","4025007766");this.addTabToMap("SmartArtDesign","405308450");this.addTabToMap("Table","4018640415");this.addTabToMap("Graphics","1515418926");this.addTabToMap("Playback",
"2572738953");this.addTabToMap("AudioFormat","1107276369");this.addTabToMap("Audio","3778566220");this.addTabToMap("AccessibleAuthoring","906344264")}KZh(){this.addCommandToMaps(Object.assign(new Va.a("PptJewelDownloadACopyAsOdp","1249692773"),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsOdp"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelDownloadACopyAsPdf","2439343378"),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsPdf"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelDownloadACopy",
"3555692408"),{legacyControlId:"PptJewel.DownloadAs.DownloadACopy"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelDownloadAsImages","1191538800"),{legacyControlId:"PptJewel.DownloadAs.DownloadAsImages"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelNew","1784018444"),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelOpen","1784018444"),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Va.a("New","1784018444"),{legacyControlId:"PptJewel.New"}));
this.addCommandToMaps(Object.assign(new Va.a("Open","1784018444"),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelPrintFullSlide","1588554917"),{legacyControlId:"PptJewel.Print.PrintFullSlide"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelPrintHandouts","2255327903"),{legacyControlId:"PptJewel.Print.PrintHandouts"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelPrintNotes","277798930"),{legacyControlId:"PptJewel.Print.PrintNotes"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelPrintToPdf",
"1588554917"),{legacyControlId:"PptJewel.Print.PrintToPdf"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelRename","2382951455"),{legacyControlId:"PptJewel.Rename.RenameDialog"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelSaveACopy","1924572812"),{legacyControlId:"PptJewel.SaveACopy.SaveACopy"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelSaveAsToHost","3098027807"),{legacyControlId:"PptJewel.SaveACopy.SaveAsToHost"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelSaveToSharePoint",
"3131236268"),{legacyControlId:"PptJewel.SaveACopy.SaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelTrustCenter","2583751502"),{legacyControlId:"PptJewel.About.TrustCenter"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelVersionHistory","466976539"),{legacyControlId:"PptJewel.Info.VersionHistory"}));this.addCommandToMaps(Object.assign(new Va.a("PptJewelPreviousVersions","3681556347"),{legacyControlId:"PptJewel.Info.FileVersion"}))}GZh(){this.addCommandToMaps(Object.assign(new Va.a("ApplyShapeStyleAnchor",
"3720025301"),{populationProps:new Og("3882730173",!1)}));this.addCommandToMaps(Object.assign(new Va.a("ApplyShapeStylePreviewGallery","1963674920"),{queryCommandId:"2375118752",populationProps:new Og("3882730173",!1),previewControlIds:"ApplyShapeStyle0 ApplyShapeStyle1 ApplyShapeStyle2 ApplyShapeStyle3 ApplyShapeStyle4 ApplyShapeStyle5 ApplyShapeStyle6".split(" ")}));this.addCommandToMaps(Object.assign(new Va.a("ApplyGraphicsStyleAnchor","1151870219"),{populationProps:new Og("4014445414",!1)}));
this.addCommandToMaps(new Va.a("FontRecentColors","1298905754"));this.addCommandToMaps(Object.assign(new Va.a("GraphicsStylePreviewGallery","2748140308"),{queryCommandId:"1903137544",populationProps:new Og("4014445414",!1),previewControlIds:"ApplyGraphicsStyle0 ApplyGraphicsStyle1 ApplyGraphicsStyle2 ApplyGraphicsStyle3 ApplyGraphicsStyle4 ApplyGraphicsStyle5 ApplyGraphicsStyle6".split(" ")}));this.addCommandToMaps(Object.assign(new Va.a("GraphicsFill","3761243910"),{populationProps:new Og("2646172177",
!1)}));this.addCommandToMaps(new Va.a("GraphicNoFill","3260600091"));this.addCommandToMaps(new Va.a("GraphicNoOutline","730443428"));this.addCommandToMaps(Object.assign(new Va.a("GraphicsOutline","546881287"),{populationProps:new Og("3094707506",!1)}));this.addCommandToMaps(new Va.a("MoreFillColors","1532790410"));this.addCommandToMaps(new Va.a("MoreFontColors","862825906"));this.addCommandToMaps(new Va.a("MoreFormatBackgroundColors","3938657252"));this.addCommandToMaps(new Va.a("MoreOutlineColors",
"3472910327"));this.addCommandToMaps(Object.assign(new Va.a("ShowHideFormatShapePane","3440753649"),{queryCommandId:"1038885196"}));this.addCommandToMaps(Object.assign(new Va.a("MoreRotationOptions","3440753649"),{queryCommandId:"1038885196"}));this.addCommandToMaps(Object.assign(new Va.a("PictureBorders","2359362870"),{populationProps:new Og("3094707506",!1)}));this.addCommandToMaps(Object.assign(new Va.a("ShapeFill","2501194553"),{populationProps:new Og("2646172177",!1),commandPreviewId:"3187150127",
commandRevertId:"4061576225"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeFillRecentColors","3745557472"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(new Va.a("ShapeNoFill","2667121814"));this.addCommandToMaps(new Va.a("ShapeNoOutline","1732643493"));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutline","2359362870"),{populationProps:new Og("3094707506",!1)}));this.addCommandToMaps(new Va.a("ShapeOutlineRecentColors","1244537109"));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineDashStyle_1",
"4208988856"),{menuItemId:"ShapeOutlineDashStyle,1"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineDashStyle_2","4208988856"),{menuItemId:"ShapeOutlineDashStyle,2"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineDashStyle_4","4208988856"),{menuItemId:"ShapeOutlineDashStyle,4"}));this.addCommandToMaps(new Va.a("ShapeOutlineDashStyleAnchor","1735838055"));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineSketchStyle_1","106876572"),{menuItemId:"ShapeOutlineSketchStyle,1"}));
this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineSketchStyle_2","106876572"),{menuItemId:"ShapeOutlineSketchStyle,2"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineSketchStyle_3","106876572"),{menuItemId:"ShapeOutlineSketchStyle,3"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineSketchStyle_4","106876572"),{menuItemId:"ShapeOutlineSketchStyle,4"}));this.addCommandToMaps(new Va.a("ShapeOutlineSketchStyleAnchor","1427890675"));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineEndStyle_1",
"2315200227"),{menuItemId:"ShapeOutlineEndStyle,1"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineEndStyle_2","2315200227"),{menuItemId:"ShapeOutlineEndStyle,2"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineEndStyle_3","2315200227"),{menuItemId:"ShapeOutlineEndStyle,3"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineEndStyle_4","2315200227"),{menuItemId:"ShapeOutlineEndStyle,4"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineEndStyle_5","2315200227"),
{menuItemId:"ShapeOutlineEndStyle,5"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineEndStyle_6","2315200227"),{menuItemId:"ShapeOutlineEndStyle,6"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineEndStyle_7","2315200227"),{menuItemId:"ShapeOutlineEndStyle,7"}));this.addCommandToMaps(new Va.a("ShapeOutlineEndStyleAnchor","819989304"));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineWidth_1","774557385"),{menuItemId:"ShapeOutlineWidth,1"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineWidth_2",
"774557385"),{menuItemId:"ShapeOutlineWidth,2"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineWidth_3","774557385"),{menuItemId:"ShapeOutlineWidth,3"}));this.addCommandToMaps(Object.assign(new Va.a("ShapeOutlineWidth_4","774557385"),{menuItemId:"ShapeOutlineWidth,4"}));this.addCommandToMaps(new Va.a("ShapeOutlineWidthAnchor","94872576"));this.addCommandToMaps(new Va.a("StandardGraphicFillColorPicker","3761243910"));this.addCommandToMaps(new Va.a("StandardGraphicOutlineColorPicker","546881287"));
this.addCommandToMaps(Object.assign(new Va.a("StandardShapeFillColorPicker","2501194553"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(new Va.a("StandardShapeOutlineColorPicker","2359362870"));this.addCommandToMaps(new Va.a("ThemeGraphicFillColorPicker","3761243910"));this.addCommandToMaps(new Va.a("ThemeGraphicFillColorPickerMCU","3761243910"));this.addCommandToMaps(new Va.a("ThemeGraphicOutlineColorPicker","546881287"));this.addCommandToMaps(new Va.a("ThemeGraphicOutlineColorPickerMCU",
"546881287"));this.addCommandToMaps(Object.assign(new Va.a("ThemeShapeFillColorPickerMCU","2501194553"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(Object.assign(new Va.a("ThemeShapeFillColorPicker","2501194553"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(new Va.a("ThemeShapeOutlineColorPicker","2359362870"));this.addCommandToMaps(new Va.a("ThemeShapeOutlineColorPickerMCU","2359362870"))}LZh(){this.addCommandToMaps(Object.assign(new Va.a("Themes",
"2963456035"),{queryCommandId:"2203652940",previewControlIds:"ThemesOfficeTheme ThemesAtlas ThemesMadison ThemesIon ThemesOrganic ThemesFrame".split(" ")}));this.addCommandToMaps(Object.assign(new Va.a("ThemesOfficeTheme","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesAtlas","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesMadison","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesIon",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesOrganic","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesFrame","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesIonBoardroom","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesMesh","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesRetrospect",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesSlice","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesSavon","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesBanded","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesQuotable","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesWoodType",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesBasis","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesIntegral","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesWisp","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesDividend","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesCelestial",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesParallax","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesMetropolitan","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesFacet","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Va.a("ThemesViewTheme","2963456035"),{queryCommandId:"2203652940"}))}NZh(){this.addCommandToMaps(Object.assign(new Va.a("Transitions",
"2024601249"),{queryCommandId:"149145197",previewControlIds:"TransitionExisting TransitionNone TransitionMorph TransitionCut TransitionFade TransitionPush TransitionWipe".split(" ")}));this.addCommandToMaps(Object.assign(new Va.a("TransitionExisting","3752636652"),{legacyControlId:"TransitionExisting",queryCommandId:"3476251476"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionExistingInMenu","4036532528"),{legacyControlId:"TransitionExistingInMenu",queryCommandId:"2831233208"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionNone",
"2024601249"),{legacyControlId:"TransitionNone",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionMorph","2024601249"),{legacyControlId:"TransitionMorph",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionCut","2024601249"),{legacyControlId:"TransitionCut",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionFade","2024601249"),{legacyControlId:"TransitionFade",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionPush",
"2024601249"),{legacyControlId:"TransitionPush",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionWipe","2024601249"),{legacyControlId:"TransitionWipe",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionSplit","2024601249"),{legacyControlId:"TransitionSplit",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionRandomBars","2024601249"),{legacyControlId:"TransitionRandomBars",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Va.a("TransitionShape","2024601249"),{legacyControlId:"TransitionShape",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionComb","2024601249"),{legacyControlId:"TransitionComb",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionBlinds","2024601249"),{legacyControlId:"TransitionBlinds",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionBox","2024601249"),
{legacyControlId:"TransitionBox",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionCover","2024601249"),{legacyControlId:"TransitionCover",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionCube","2024601249"),{legacyControlId:"TransitionCube",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionCurtains","2024601249"),{legacyControlId:"TransitionCurtains",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionDissolve",
"2024601249"),{legacyControlId:"TransitionDissolve",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionOrbit","2024601249"),{legacyControlId:"TransitionOrbit",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionPageCurl","2024601249"),{legacyControlId:"TransitionPageCurl",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionPeelOff","2024601249"),{legacyControlId:"TransitionPeelOff",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Va.a("TransitionRandom","2024601249"),{legacyControlId:"TransitionRandom",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionReveal","2024601249"),{legacyControlId:"TransitionReveal",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionRotate","2024601249"),{legacyControlId:"TransitionRotate",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionUncover","2024601249"),
{legacyControlId:"TransitionUncover",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionWheel","2024601249"),{legacyControlId:"TransitionWheel",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionRipple","2024601249"),{legacyControlId:"TransitionRipple",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionBox","2024601249"),{legacyControlId:"TransitionBox",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionCube",
"2024601249"),{legacyControlId:"TransitionCube",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionSwitch","2024601249"),{legacyControlId:"TransitionSwitch",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionFallOver","2024601249"),{legacyControlId:"TransitionFallOver",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionDrape","2024601249"),{legacyControlId:"TransitionDrape",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Va.a("TransitionFlip","2024601249"),{legacyControlId:"TransitionFlip",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionWind","2024601249"),{legacyControlId:"TransitionWind",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionPrestige","2024601249"),{legacyControlId:"TransitionPrestige",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionFracture","2024601249"),
{legacyControlId:"TransitionFracture",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionCrush","2024601249"),{legacyControlId:"TransitionCrush",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionAirplane","2024601249"),{legacyControlId:"TransitionAirplane",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionOrigami","2024601249"),{legacyControlId:"TransitionOrigami",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Va.a("TransitionChecker","2024601249"),{legacyControlId:"TransitionChecker",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionVortex","2024601249"),{legacyControlId:"TransitionVortex",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionGlitter","2024601249"),{legacyControlId:"TransitionGlitter",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionPan","2024601249"),
{legacyControlId:"TransitionPan",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionGalleryIcon","2024601249"),{legacyControlId:"TransitionGalleryIcon",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionConveyor","2024601249"),{legacyControlId:"TransitionConveyor",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionZoom","2024601249"),{legacyControlId:"TransitionZoom",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Va.a("TransitionFlyThrough","2024601249"),{legacyControlId:"TransitionFlyThrough",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionWindow","2024601249"),{legacyControlId:"TransitionWindow",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Va.a("TransitionDoors","2024601249"),{legacyControlId:"TransitionDoors",queryCommandId:"149145197"}))}wZh(){this.addCommandToMaps(Object.assign(new Va.a("Animations",
"2676673376"),{queryCommandId:"1852964326",previewControlIds:["AnimationExisting","AnimationNone","AnimationAppear","AnimationFadeIn","AnimationFlyIn"]}));this.addCommandToMaps(Object.assign(new Va.a("AnimationExisting","298832323"),{queryCommandId:"1852964326"}));this.addCommandToMaps(Object.assign(new Va.a("AnimationExistingInMenu","1264919631"),{queryCommandId:"1852964326"}));for(const a of this.fZj)this.addCommandToMaps(Object.assign(new Va.a(a,"2676673376"),{queryCommandId:"1852964326"}))}vZh(){this.addCommandToMaps(Object.assign(new Va.a("AnimationEffectOptions",
"1880806010"),{populationProps:new Og("4148576519",!1)}));for(const a of this.bZj)this.addCommandToMaps(Object.assign(new Va.a(a,"2949363495"),{queryCommandId:"4132852551",menuItemId:a.slice(this.cZj)}));for(const a of this.dZj)this.addCommandToMaps(Object.assign(new Va.a(a,"2289594085"),{queryCommandId:"3782857737",menuItemId:a.slice(this.eZj)}));this.addCommandToMaps(new Va.a("AnimationEffectOptionsThemeColorPickerMCU","679168237"));this.addCommandToMaps(new Va.a("AnimationEffectOptionsThemeColorPicker",
"679168237"));this.addCommandToMaps(new Va.a("AnimationEffectOptionsStandardColorPicker","679168237"));this.addCommandToMaps(Object.assign(new Va.a("AnimationEffectOptionsSequenceAsOneObject","1850236812"),{queryCommandId:"1125291975",menuItemId:"AsOneObject"}));this.addCommandToMaps(Object.assign(new Va.a("AnimationEffectOptionsSequenceAllAtOnce","2048458448"),{queryCommandId:"1125291975",menuItemId:"AllAtOnce"}));this.addCommandToMaps(Object.assign(new Va.a("AnimationEffectOptionsSequenceByParagraph",
"3467781846"),{queryCommandId:"1125291975",menuItemId:"ByParagraph"}));this.addCommandToMaps(Object.assign(new Va.a("AnimationEffectOptionsSequenceOneByOne","1486892994"),{queryCommandId:"1125291975",menuItemId:"OneByOne"}))}zZh(){this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundSolidFillFromCanvas","2710524593"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new Og("1073160204",!1)}));for(const a of this.S0j)this.addCommandToMaps(Object.assign(new Va.a(a,
"2710524593"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundSolidFillFromThumbnailPane","2624409683"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new Og("4086319974",!1)}));for(const a of this.T0j)this.addCommandToMaps(Object.assign(new Va.a(a,"2624409683"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundApplyToAllFromCanvas",
"797658758"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundApplyToAllFromThumbnailPane","317738424"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundPictureFromCanvas","1067172319"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Va.a("FormatBackgroundPictureFromThumbnailPane",
"713045573"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}))}MZh(){this.addCommandToMaps(Object.assign(new Va.a("TransitionEffectOptions","317477235"),{populationProps:new Og("1348655508",!1)}));for(const a of this.O9j)this.addCommandToMaps(Object.assign(new Va.a(a,"961566706"),{queryCommandId:"3535869262",menuItemId:a.slice(this.P9j)}))}FZh(){this.addCommandToMaps(new Va.a("PictureStyles","1158868185"));for(const a of this.V5j){const b=a.split("_")[2];this.addCommandToMaps(Object.assign(new Va.a(a,
"1158868185"),{queryCommandId:"1384172858",menuItemId:b}))}}HZh(){this.addCommandToMaps(new Va.a("ChangeSmartArtLayoutAnchor","1203133001"));for(const a of this.lPg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Va.a("Change"+a,"3290078594"),{queryCommandId:"1384172858",menuItemId:b[1]+","+b[2]}))}this.addCommandToMaps(Object.assign(new Va.a("SmartArtEditText","2301457975"),{queryCommandId:"2686363697"}));this.addCommandToMaps(new Va.a("SmartArtDemote","4035125371"));this.addCommandToMaps(new Va.a("SmartArtPromote",
"1313422623"));this.addCommandToMaps(new Va.a("SmartArtResetGraphic","2099122511"));this.addCommandToMaps(Object.assign(new Va.a("SmartArtReverse","2753397958"),{queryCommandId:"2648853014"}));this.addCommandToMaps(new Va.a("SmartArtStyles","3002291327"));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__simple1__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple1,simple"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__simple2__simple","3002291327"),{queryCommandId:"1384172858",
menuItemId:"simple2,simple"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__simple3__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple3,simple"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__simple4__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple4,simple"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__simple5__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple5,simple"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__3d1__3D",
"3002291327"),{queryCommandId:"1384172858",menuItemId:"3d1,3D"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__3d2__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d2,3D"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__3d3__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d3,3D"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__3d4__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d4,3D"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__3d5__3D",
"3002291327"),{queryCommandId:"1384172858",menuItemId:"3d5,3D"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__3d6__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d6,3D"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__3d7__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d7,3D"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__3d8__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d8,3D"}));this.addCommandToMaps(Object.assign(new Va.a("SmartArtStyle__3d9__3D",
"3002291327"),{queryCommandId:"1384172858",menuItemId:"3d9,3D"}))}CZh(){this.addCommandToMaps(new Va.a("InsertSmartArtAnchor","3732507656"));for(const a of this.lPg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Va.a(a,"2734600169"),{queryCommandId:"1384172858",menuItemId:b[1]+","+b[2]}))}}EZh(){this.addCommandToMaps(new Va.a("PictureCropToShapeAnchor","1658415763"));for(const a of this.T5j)this.addCommandToMaps(Object.assign(new Va.a(a,"682334988"),{queryCommandId:"1384172858"}))}BZh(){this.addCommandToMaps(new Va.a("InsertShapesAll",
"650246100"));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStraightConnector","2523939501"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStraightConnectorArrow","1750723594"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStraightConnectorTwoArrow","3559452754"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeElbowConnector","1025603538"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Va.a("InsertShapeElbowArrowConnector","254882197"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeElbowDoubleArrowConnector","3675479226"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeCurvedConnector","3570382728"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeCurvedArrowConnector","2475247497"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeCurvedDoubleArrowConnector",
"3609233104"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeRectangle","645832025"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeRoundedRectangle","2299510778"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeSnipSingleCornerRectangle","3474758074"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeSnipSameSideCornerRectangle","3850613247"),
{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeSnipDiagonalCornerRectangle","2293630353"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeSnipRoundSingleCornerRectangle","3574790146"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeRoundSingleCornerRectangle","2164607454"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeRoundSameSideCornerRectangle",
"2967902753"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeRoundDiagonalCornerRectangle","93314647"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeTextBox","621502440"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeEllipse","2935469250"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeTriangle","1504176348"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Va.a("InsertShapeRightTriangle","2485319550"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeParallelogram","770491129"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeTrapezoid","3412378376"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeDiamond","3524776812"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeSPentagon",
"2830940407"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeHexagon","656392472"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeHeptagon","1899461382"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeOctagon","3089112743"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeDecagon","2150987117"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeDodecagon",
"21081030"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapePie","2034251078"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeChord","3297467250"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeTeardrop","2496477627"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeFrame","4089189445"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeHalfFrame",
"529510678"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeLShape","2250730235"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeDiagonalStripe","3980577126"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeCross","2988290636"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapePlaque","1062940640"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeCan",
"2289466566"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeCube","1564078521"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeBevel","1069783708"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeDonut","603375116"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeNoSymbol","2566066899"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeBlockArc",
"2964829157"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeFoldedCorner","3416217987"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeSmileyFace","3384731998"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeHeart","3360918184"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeLightningBolt","1658476285"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Va.a("InsertShapeSun","253099274"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeMoon","4091449115"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeCloud","3297467381"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeArc","3122886792"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeDoubleBracket",
"1269508949"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeDoubleBrace","3209338176"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeLeftBracket","961803587"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeRightBracket","2545917082"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeLeftBrace","2654567264"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Va.a("InsertShapeRightBrace","2181960791"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeRightArrow","3795105589"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeLeftArrow","1270568434"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeUpArrow","2638665078"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeDownArrow",
"671609167"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeLeftRightArrow","954768594"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeUpDownArrow","3735909846"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeQuadArrow","2763384452"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeLeftRightUpArrow","781992111"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Va.a("InsertShapeBentArrow","4266113576"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeUTurnArrow","3732223469"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeLeftUpArrow","3750115875"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeBentUpArrow","4033796289"),{queryCommandId:"1384172858"}));let a;this.addCommandToMaps((a=new Va.a("InsertShapeCurvedRightArrow",
"3819554122"),a.queryCommandId="1384172858",a));let b;this.addCommandToMaps((b=new Va.a("InsertShapeCurvedLeftArrow","4069343241"),b.queryCommandId="1384172858",b));let c;this.addCommandToMaps((c=new Va.a("InsertShapeCurvedUpArrow","2185082291"),c.queryCommandId="1384172858",c));let f;this.addCommandToMaps((f=new Va.a("InsertShapeCurvedDownArrow","976313414"),f.queryCommandId="1384172858",f));let l;this.addCommandToMaps((l=new Va.a("InsertShapeStripedRightArrow","1658124824"),l.queryCommandId="1384172858",
l));let x;this.addCommandToMaps((x=new Va.a("InsertShapeNotchedRightArrow","457802308"),x.queryCommandId="1384172858",x));let F;this.addCommandToMaps((F=new Va.a("InsertShapePentagon","2602819900"),F.queryCommandId="1384172858",F));let R;this.addCommandToMaps((R=new Va.a("InsertShapeChevron","287050691"),R.queryCommandId="1384172858",R));let fa;this.addCommandToMaps((fa=new Va.a("InsertShapeRightArrowCallout","1246382169"),fa.queryCommandId="1384172858",fa));let wa;this.addCommandToMaps((wa=new Va.a("InsertShapeDownArrowCallout",
"3010992915"),wa.queryCommandId="1384172858",wa));let Xa;this.addCommandToMaps((Xa=new Va.a("InsertShapeLeftArrowCallout","1220509638"),Xa.queryCommandId="1384172858",Xa));let lb;this.addCommandToMaps((lb=new Va.a("InsertShapeUpArrowCallout","287463130"),lb.queryCommandId="1384172858",lb));let Lb;this.addCommandToMaps((Lb=new Va.a("InsertShapeLeftRightArrowCallout","2303744502"),Lb.queryCommandId="1384172858",Lb));let kc;this.addCommandToMaps((kc=new Va.a("InsertShapeQuadArrowCallout","1929705096"),
kc.queryCommandId="1384172858",kc));let lc;this.addCommandToMaps((lc=new Va.a("InsertShapeCircularArrow","3229643138"),lc.queryCommandId="1384172858",lc));let Ec;this.addCommandToMaps((Ec=new Va.a("InsertShapeMathPlus","3675536706"),Ec.queryCommandId="1384172858",Ec));let Jc;this.addCommandToMaps((Jc=new Va.a("InsertShapeMathMinus","4100001190"),Jc.queryCommandId="1384172858",Jc));let Dc;this.addCommandToMaps((Dc=new Va.a("InsertShapeMathMultiply","2861422166"),Dc.queryCommandId="1384172858",Dc));
let Wd;this.addCommandToMaps((Wd=new Va.a("InsertShapeMathDivide","168064503"),Wd.queryCommandId="1384172858",Wd));let xe;this.addCommandToMaps((xe=new Va.a("InsertShapeMathEqual","2402760486"),xe.queryCommandId="1384172858",xe));let Sd;this.addCommandToMaps((Sd=new Va.a("InsertShapeMathNotEqual","4184383381"),Sd.queryCommandId="1384172858",Sd));let Pe;this.addCommandToMaps((Pe=new Va.a("InsertShapeProcess","1040093007"),Pe.queryCommandId="1384172858",Pe));let Ue;this.addCommandToMaps((Ue=new Va.a("InsertShapeAlternateProcess",
"2060186255"),Ue.queryCommandId="1384172858",Ue));let Ef;this.addCommandToMaps((Ef=new Va.a("InsertShapeDecision","2994325646"),Ef.queryCommandId="1384172858",Ef));let dg;this.addCommandToMaps((dg=new Va.a("InsertShapeData","3600704532"),dg.queryCommandId="1384172858",dg));let Mg;this.addCommandToMaps((Mg=new Va.a("InsertShapePredefinedProcess","1912938133"),Mg.queryCommandId="1384172858",Mg));let Bg;this.addCommandToMaps((Bg=new Va.a("InsertShapeInternalStorage","3699646902"),Bg.queryCommandId="1384172858",
Bg));let Lf;this.addCommandToMaps((Lf=new Va.a("InsertShapeDocument","372614031"),Lf.queryCommandId="1384172858",Lf));let mh;this.addCommandToMaps((mh=new Va.a("InsertShapeMultidocument","3076056292"),mh.queryCommandId="1384172858",mh));let Fg;this.addCommandToMaps((Fg=new Va.a("InsertShapeTerminator","3309718409"),Fg.queryCommandId="1384172858",Fg));let ii;this.addCommandToMaps((ii=new Va.a("InsertShapePreparation","2972619841"),ii.queryCommandId="1384172858",ii));let Li;this.addCommandToMaps((Li=
new Va.a("InsertShapeManualInput","3307458778"),Li.queryCommandId="1384172858",Li));let wj;this.addCommandToMaps((wj=new Va.a("InsertShapeManualOperation","3480100343"),wj.queryCommandId="1384172858",wj));let cj;this.addCommandToMaps((cj=new Va.a("InsertShapeConnector","2767398707"),cj.queryCommandId="1384172858",cj));let dj;this.addCommandToMaps((dj=new Va.a("InsertShapeOffpageConnector","245535631"),dj.queryCommandId="1384172858",dj));let yi;this.addCommandToMaps((yi=new Va.a("InsertShapeCard",
"851618206"),yi.queryCommandId="1384172858",yi));let Hk;this.addCommandToMaps((Hk=new Va.a("InsertShapePunchedTape","2805408817"),Hk.queryCommandId="1384172858",Hk));let xj;this.addCommandToMaps((xj=new Va.a("InsertShapeSummingJunction","1742457506"),xj.queryCommandId="1384172858",xj));let uk;this.addCommandToMaps((uk=new Va.a("InsertShapeOr","3387115369"),uk.queryCommandId="1384172858",uk));let Gl;this.addCommandToMaps((Gl=new Va.a("InsertShapeCollate","1523313274"),Gl.queryCommandId="1384172858",
Gl));let gl;this.addCommandToMaps((gl=new Va.a("InsertShapeSort","240172272"),gl.queryCommandId="1384172858",gl));let Hl;this.addCommandToMaps((Hl=new Va.a("InsertShapeExtract","2871548753"),Hl.queryCommandId="1384172858",Hl));let Yj;this.addCommandToMaps((Yj=new Va.a("InsertShapeMerge","331056848"),Yj.queryCommandId="1384172858",Yj));let Oj;this.addCommandToMaps((Oj=new Va.a("InsertShapeStoredData","2965521551"),Oj.queryCommandId="1384172858",Oj));let Zj;this.addCommandToMaps((Zj=new Va.a("InsertShapeDelay",
"3728895005"),Zj.queryCommandId="1384172858",Zj));let Wk;this.addCommandToMaps((Wk=new Va.a("InsertShapeSequentialActionStorage","1187616446"),Wk.queryCommandId="1384172858",Wk));let Hj;this.addCommandToMaps((Hj=new Va.a("InsertShapeMagneticDisk","2595473951"),Hj.queryCommandId="1384172858",Hj));let nh;this.addCommandToMaps((nh=new Va.a("InsertShapeDirectAccessStorage","3522000044"),nh.queryCommandId="1384172858",nh));let hl;this.addCommandToMaps((hl=new Va.a("InsertShapeDisplay","2830261794"),hl.queryCommandId=
"1384172858",hl));let Wl;this.addCommandToMaps((Wl=new Va.a("InsertShapeExplosion1","609854846"),Wl.queryCommandId="1384172858",Wl));let xm;this.addCommandToMaps((xm=new Va.a("InsertShapeExplosion2","609854843"),xm.queryCommandId="1384172858",xm));let Ik;this.addCommandToMaps((Ik=new Va.a("InsertShapeStar4","1751654576"),Ik.queryCommandId="1384172858",Ik));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStar5","3317738517"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStar6",
"588855162"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStar7","2154939103"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStar8","3721023044"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStar10","579353105"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStar12","579353107"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStar16",
"579353103"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStar24","2145437042"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeStar32","3711520989"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a("InsertShapeUpRibbon","3965372919"),{queryCommandId:"1384172858"}));let vk;this.addCommandToMaps((vk=new Va.a("InsertShapeDownRibbon","1643393380"),vk.queryCommandId="1384172858",vk));let ji;
this.addCommandToMaps((ji=new Va.a("InsertShapeCurvedUpRibbon","1364669940"),ji.queryCommandId="1384172858",ji));let ng;this.addCommandToMaps((ng=new Va.a("InsertShapeCurvedDownRibbon","1056258459"),ng.queryCommandId="1384172858",ng));let ki;this.addCommandToMaps((ki=new Va.a("InsertShapeVerticalScroll","1834894867"),ki.queryCommandId="1384172858",ki));let Rf;this.addCommandToMaps((Rf=new Va.a("InsertShapeHorizontalScroll","2820192427"),Rf.queryCommandId="1384172858",Rf));let zd;this.addCommandToMaps((zd=
new Va.a("InsertShapeWave","3130421197"),zd.queryCommandId="1384172858",zd));let ne;this.addCommandToMaps((ne=new Va.a("InsertShapeDoubleWave","3519851372"),ne.queryCommandId="1384172858",ne));let yf;this.addCommandToMaps((yf=new Va.a("InsertShapeRectangularCallout","1809100996"),yf.queryCommandId="1384172858",yf));let Zd;this.addCommandToMaps((Zd=new Va.a("InsertShapeRoundedRectangleCallout","238089374"),Zd.queryCommandId="1384172858",Zd));let vg;this.addCommandToMaps((vg=new Va.a("InsertShapeOvalCallout",
"4206313904"),vg.queryCommandId="1384172858",vg));let $h;this.addCommandToMaps(($h=new Va.a("InsertShapeCloudCallout","1032389169"),$h.queryCommandId="1384172858",$h));let zi;this.addCommandToMaps((zi=new Va.a("InsertShapeLineCallout1BorderAccent","3475705525"),zi.queryCommandId="1384172858",zi));let Yo;this.addCommandToMaps((Yo=new Va.a("InsertShapeLineCallout2BorderAccent","1472318264"),Yo.queryCommandId="1384172858",Yo));let hk;this.addCommandToMaps((hk=new Va.a("InsertShapeLineCallout3BorderAccent",
"1768130487"),hk.queryCommandId="1384172858",hk));let Xo;this.addCommandToMaps((Xo=new Va.a("InsertShapeLineCallout1Accent","733785093"),Xo.queryCommandId="1384172858",Xo));let ws;this.addCommandToMaps((ws=new Va.a("InsertShapeLineCallout2Accent","733609894"),ws.queryCommandId="1384172858",ws));let Dt;this.addCommandToMaps((Dt=new Va.a("InsertShapeLineCallout3Accent","733857095"),Dt.queryCommandId="1384172858",Dt));let Et;this.addCommandToMaps((Et=new Va.a("InsertShapeLineCallout1","1956296899"),
Et.queryCommandId="1384172858",Et));let Ft;this.addCommandToMaps((Ft=new Va.a("InsertShapeLineCallout2","1956296896"),Ft.queryCommandId="1384172858",Ft));let Gt;this.addCommandToMaps((Gt=new Va.a("InsertShapeLineCallout3","1956296897"),Gt.queryCommandId="1384172858",Gt));let Ht;this.addCommandToMaps((Ht=new Va.a("InsertShapeLineCallout1NoBorder","627424020"),Ht.queryCommandId="1384172858",Ht));let xs;this.addCommandToMaps((xs=new Va.a("InsertShapeLineCallout2NoBorder","621637973"),xs.queryCommandId=
"1384172858",xs));let It;this.addCommandToMaps((It=new Va.a("InsertShapeLineCallout3NoBorder","629787286"),It.queryCommandId="1384172858",It));this.addCommandToMaps(new Va.a("InsertShapeTextBoxBig","621502440"))}yZh(){this.addCommandToMaps(Object.assign(new Va.a($d.x7,"2131010772"),{queryCommandId:"2524310320"}));this.addCommandToMaps(Object.assign(new Va.a($d.MB,"2959280052"),{queryCommandId:"2162608508"}));this.addCommandToMaps(Object.assign(new Va.a($d.ZE,"2959280049"),{queryCommandId:"2565893035"}));
this.addCommandToMaps(Object.assign(new Va.a($d.YE,"2032762671"),{queryCommandId:"103713021"}));this.addCommandToMaps(Object.assign(new Va.a($d.Ora,"1898254474"),{queryCommandId:"958499386"}));this.addCommandToMaps(Object.assign(new Va.a($d.J7a,"3738895990"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a($d.Bia,"3738895993"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a($d.zCa,"3738895992"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a($d.Cia,
"657096778"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a($d.Dia,"2223180719"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a($d.ACa,"3789264660"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a($d.BCa,"3496085635"),{queryCommandId:"1964687729"}));this.addCommandToMaps(Object.assign(new Va.a($d.w7,"2964465598"),{queryCommandId:"2403188966"}));this.addCommandToMaps(Object.assign(new Va.a($d.CCa,"893000638"),
{queryCommandId:"2949649726"}));this.addCommandToMaps(Object.assign(new Va.a($d.DCa,"186315452"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a($d.ECa,"186315449"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Va.a($d.FCa,"186315450"),{queryCommandId:"1384172858"}))}JZh(){this.addCommandToMaps(Object.assign(new Va.a("Select","1203133001"),{legacyControlId:"idTableSelect"}));this.addCommandToMaps(Object.assign(new Va.a("SelectTable","2306914518"),
{legacyControlId:"btnSelectTable"}));this.addCommandToMaps(Object.assign(new Va.a("SelectColumn","2341852628"),{legacyControlId:"btnSelectColumn"}));this.addCommandToMaps(Object.assign(new Va.a("SelectRow","3508003794"),{legacyControlId:"btnSelectRow"}));this.addCommandToMaps(Object.assign(new Va.a("TableDelete","1203133001"),{legacyControlId:"idTableDelete"}));this.addCommandToMaps(Object.assign(new Va.a("PowerPointDeleteTableColumn","2998998226"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Va.a("PowerPointDeleteTableRow",
"3269723356"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Va.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Va.a("InsertRowAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Va.a("InsertRowBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Va.a("InsertColumnLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));
this.addCommandToMaps(Object.assign(new Va.a("InsertColumnRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(new Va.a("ApplyTableStyleOptionAnchor","1203133001"));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableStyleOptionHeaderRow","1583455318"),{legacyControlId:"buttonFirstRow",queryCommandId:"1762426222",menuItemId:"buttonFirstRow"}));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableStyleOptionFirstColumn","1583455318"),{legacyControlId:"buttonFirstColumn",
queryCommandId:"1762426222",menuItemId:"buttonFirstColumn"}));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableStyleOptionTotalRow","1583455318"),{legacyControlId:"buttonLastRow",queryCommandId:"1762426222",menuItemId:"buttonLastRow"}));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableStyleOptionLastColumn","1583455318"),{legacyControlId:"buttonLastColumn",queryCommandId:"1762426222",menuItemId:"buttonLastColumn"}));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableStyleOptionBandedRows",
"1583455318"),{legacyControlId:"buttonBandedRow",queryCommandId:"1762426222",menuItemId:"buttonBandedRow"}));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableStyleOptionBandedColumns","1583455318"),{legacyControlId:"buttonBandedColumn",queryCommandId:"1762426222",menuItemId:"buttonBandedColumn"}));this.addCommandToMaps(Object.assign(new Va.a("PowerPointCellShadingMenuOpen","3704601382"),{legacyControlId:"cellShadingColor",populationProps:new Og("2450035180",!1),menuItemId:"cellShadingColor"}));
this.addCommandToMaps(new Va.a("StandardCellShadingColorPicker","3704601382"));this.addCommandToMaps(new Va.a("ThemeCellShadingColorPicker","3704601382"));this.addCommandToMaps(new Va.a("ThemeCellShadingColorPickerMCU","3704601382"));this.addCommandToMaps(new Va.a("NoCellShading","2292419401"));this.addCommandToMaps(new Va.a("CellShadingMoreColors","1736670660"));this.addCommandToMaps(new Va.a("CellShadingRecentColors","4078162917"));this.addCommandToMaps(Object.assign(new Va.a("SetSizeAnchor","3089059537"),
{queryCommandId:"149527692"}));this.addCommandToMaps(Object.assign(new Va.a("MergeTableCells","93109791"),{legacyControlId:"btnMergeTableCells"}));this.addCommandToMaps(Object.assign(new Va.a("SplitTableCells","1112879997"),{legacyControlId:"btnSplitTableCells"}));this.addCommandToMaps(new Va.a("TableAnchor","2806772911"));this.addCommandToMaps(Object.assign(new Va.a("TableStyles","4171428777"),{legacyControlId:"fsfaMoreTableStyles",queryCommandId:"2135594455",populationProps:new Og("3359297384",
!1),previewControlIds:"buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" ")}));this.addCommandToMaps(new Va.a("TableAlignmentAnchor","3250360533"));this.addCommandToMaps(Object.assign(new Va.a("TableCellBottomAnchoring","4124180856"),{legacyControlId:"btnTableCellBottomAnchoring",queryCommandId:"4231771752"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellCenterJustify",
"33632174"),{legacyControlId:"btnTableCellCenterJustify",queryCommandId:"2252885982"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellLeftJustify","1845468918"),{legacyControlId:"btnTableCellLeftJustify",queryCommandId:"712471458"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellMiddleAnchoring","1377620466"),{legacyControlId:"btnTableCellMiddleAnchoring",queryCommandId:"967867926"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellRightJustify","3813372745"),{legacyControlId:"btnTableCellRightJustify",
queryCommandId:"3610192823"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellTopAnchoring","3318339922"),{legacyControlId:"btnTableCellTopAnchoring",queryCommandId:"1945464878"}));this.addCommandToMaps(new Va.a("TableAlternativeText","3296909722"));this.addCommandToMaps(new Va.a("DistributeRows","791526052"));this.addCommandToMaps(new Va.a("DistributeColumns","4255324272"));this.addCommandToMaps(new Va.a("TableDistribute","1576337241"));this.addCommandToMaps(Object.assign(new Va.a("SetCellBorderColor",
"1742993766"),{populationProps:new Og("3585221234",!1)}));this.addCommandToMaps(new Va.a("CellBorderColorPickerMCU","71763897"));this.addCommandToMaps(new Va.a("CellBorderColorPicker","71763897"));this.addCommandToMaps(new Va.a("StandardCellBorderColorPicker","71763897"));this.addCommandToMaps(new Va.a("CellBorderRecentColors","1124206375"));this.addCommandToMaps(new Va.a("CellBorderMoreColors","1138519801"));this.addCommandToMaps(new Va.a("TableBorderWidthAnchor","1025523929"));this.addCommandToMaps(Object.assign(new Va.a("TableBorderWidth_1",
"1181009968"),{queryCommandId:"1928723436"}));this.addCommandToMaps(Object.assign(new Va.a("TableBorderWidth_2","1181009968"),{queryCommandId:"1928723435"}));this.addCommandToMaps(Object.assign(new Va.a("TableBorderWidth_3","1181009968"),{queryCommandId:"1928723434"}));this.addCommandToMaps(Object.assign(new Va.a("TableBorderWidth_4","1181009968"),{queryCommandId:"1928723441"}));this.addCommandToMaps(Object.assign(new Va.a("TableBorderWidth_5","1181009968"),{queryCommandId:"1928723440"}));this.addCommandToMaps(Object.assign(new Va.a("TableBorderWidth_6",
"1181009968"),{queryCommandId:"1928723439"}));this.addCommandToMaps(Object.assign(new Va.a("TableBorderWidth_7","1181009968"),{queryCommandId:"1928723438"}));this.addCommandToMaps(Object.assign(new Va.a("TableBorderWidth_8","1181009968"),{queryCommandId:"1928723429"}));this.addCommandToMaps(Object.assign(new Va.a("TableBorderWidth_9","1181009968"),{queryCommandId:"1928723428"}));this.addCommandToMaps(new Va.a("TableBorderTypeAnchor","316937739"));this.addCommandToMaps(Object.assign(new Va.a("TableBordersNoBorder",
"920953916"),{queryCommandId:"2666589896"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersAllBorders","920953916"),{queryCommandId:"3505971410"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersOutsideBorders","920953916"),{queryCommandId:"259981150"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersInsideBorders","2426125916"),{queryCommandId:"1088761899"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersTopBorder","920953916"),{queryCommandId:"2150808318"}));
this.addCommandToMaps(Object.assign(new Va.a("TableBordersBottomBorder","920953916"),{queryCommandId:"3072152572"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersLeftBorder","920953916"),{queryCommandId:"10301274"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersRightBorder","920953916"),{queryCommandId:"3005649147"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersInsideHorizontalBorder","2595242660"),{queryCommandId:"2049270673"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersInsideVerticalBorder",
"3890138642"),{queryCommandId:"4266964333"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersDiagonalUpBorder","920953916"),{queryCommandId:"4243465577"}));this.addCommandToMaps(Object.assign(new Va.a("TableBordersDiagonalDownBorder","920953916"),{queryCommandId:"1969875420"}));this.addCommandToMaps(new Va.a("TableCellMarginAnchor","3624082799"));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableCellMarginNormal","929276597"),{queryCommandId:"3122906487"}));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableCellMarginNone",
"570150258"),{queryCommandId:"2335710142"}));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableCellMarginNarrow","2448307869"),{queryCommandId:"1985856563"}));this.addCommandToMaps(Object.assign(new Va.a("ApplyTableCellMarginWide","1262149989"),{queryCommandId:"2537223195"}));this.addCommandToMaps(Object.assign(new Va.a("TableCellMarginCustom","3089059537"),{queryCommandId:"149527692"}))}B_h(){this.Ai(Object.assign(new Wf("ContextualTabs.Tables.Design.Shading"),{externalUxCommandIds:["PowerPointCellShadingMenuOpen"]}));
this.Ai(Object.assign(new Wf("ContextualTabs.Tables.Design.TableStyleOptions"),{externalUxGroupId:"TableTableStyleOptions"}));this.Ai(Object.assign(new Wf("ContextualTabs.Tables.Design.TableStyles"),{externalUxGroupId:"TableStyles"}));this.Ai(Object.assign(new Wf("ContextualTabs.Tables.Layout.Alignment"),{externalUxGroupId:"Alignment"}));this.Ai(Object.assign(new Wf("ContextualTabs.Tables.Layout.CellSize"),{externalUxCommandIds:["SetSizeAnchor"]}));this.Ai(Object.assign(new Wf("ContextualTabs.Tables.Layout.Properties"),
{externalUxCommandIds:["AlternativeText"]}));this.Ai(Object.assign(new Wf("ContextualTabs.Tables.Layout.RowColumn"),{externalUxCommandIds:["TableDelete","InsertRowAbove","InsertRowBelow","InsertColumnLeft","InsertColumnRight"]}));this.Ai(Object.assign(new Wf("ContextualTabs.Tables.Layout.Table"),{externalUxCommandIds:["Select"]}));this.Ai(Object.assign(new Wf("ContextualTabs.Tables.Layout.TableSize"),{externalUxGroupId:"TableSize"}));this.Ai(Object.assign(new Wf("PptRibbon.Animation.Gallery"),{externalUxGroupId:"AnimationGallery"}));
this.Ai(Object.assign(new Wf("PptRibbon.Animation.Timing"),{externalUxGroupId:"Timing"}));this.Ai(Object.assign(new Wf("PptRibbon.Design.Customize"),{externalUxGroupId:"Customize"}));this.Ai(Object.assign(new Wf("PptRibbon.Design.Designer"),{externalUxGroupId:"Designer"}));this.Ai(Object.assign(new Wf("PptRibbon.Design.Designer.New"),{externalUxGroupId:"DesignerNew"}));this.Ai(Object.assign(new Wf("PptRibbon.Home.Designer"),{externalUxGroupId:"DesignerHome"}));this.Ai(Object.assign(new Wf("PptRibbon.Home.Ideas"),
{externalUxGroupId:"Ideas"}));this.Ai(Object.assign(new Wf("PptRibbon.Design.ThemeVariants"),{externalUxGroupId:"MoreVariants"}));this.Ai(Object.assign(new Wf("PptRibbon.DrawingFormat.InsertShapes"),{externalUxGroupId:"InsertShapes"}));this.Ai(Object.assign(new Wf("PptRibbon.DrawingFormat.ShapeStyles"),{externalUxGroupId:"ShapeStyles"}));this.Ai(Object.assign(new Wf("PptRibbon.Home.ClipboardCutEnabled"),{externalUxCommandIds:["Cut"]}));this.Ai(Object.assign(new Wf("PptRibbon.Home.Delete"),{externalUxGroupId:"Delete"}));
this.Ai(Object.assign(new Wf("PptRibbon.Home.Dictation"),{externalUxGroupId:"Dictation"}));this.Ai(Object.assign(new Wf("PptRibbon.Home.Drawing"),{externalUxGroupId:"Drawing"}));this.Ai(Object.assign(new Wf("PptRibbon.Home.Editing"),{externalUxGroupId:"Editing"}));this.Ai(Object.assign(new Wf("PptRibbon.Home.Font"),{externalUxGroupId:"Font"}));this.Ai(Object.assign(new Wf("PptRibbon.Home.Slides"),{externalUxGroupId:"Slides"}));this.Ai(Object.assign(new Wf("PptRibbon.Home.UndoRedo"),{externalUxGroupId:"Undo"}));
this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.AppForOffice"),{externalUxCommandIds:["InsertAddIns"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.Comments"),{externalUxCommandIds:["InsertComment"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.Illustrations"),{externalUxCommandIds:["InsertShapesAll","InsertIconDialog","InsertSmartArtAnchor"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.Images"),{externalUxCommandIds:["Picture","OnlinePictures"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.InsertHyperlink"),
{externalUxCommandIds:["InsertLink"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.InsertSlides"),{externalUxCommandIds:["InsertSlides"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.InsertTables"),{externalUxCommandIds:["TableAnchor"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.InvokeFilesSerplet"),{externalUxCommandIds:["InvokeFilesSerplet"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.Media"),{externalUxCommandIds:["InsertOnlineVideo"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.Symbols"),
{externalUxCommandIds:["InsertSymbol"]}));this.Ai(Object.assign(new Wf("PptRibbon.InsertTab.Text"),{externalUxCommandIds:["InsertTextBox"]}));this.Ai(Object.assign(new Wf("PptRibbon.PictureFormat.Adjust"),{externalUxGroupId:"Adjust"}));this.Ai(Object.assign(new Wf("PptRibbon.PictureFormat.Size"),{externalUxCommandIds:["PictureCropAnchor"]}));this.Ai(Object.assign(new Wf("PptRibbon.PictureFormat.Style"),{externalUxGroupId:"PictureStyles"}));this.Ai(Object.assign(new Wf("PptRibbon.Review.Comments"),
{externalUxGroupId:"Comments"}));this.Ai(Object.assign(new Wf("PptRibbon.Review.Inspect"),{externalUxGroupId:"Accessibility"}));this.Ai(Object.assign(new Wf("PptRibbon.Review.Translate "),{externalUxGroupId:"Translate"}));this.Ai(Object.assign(new Wf("PptRibbon.Review.Activity"),{externalUxGroupId:"Activity"}));this.Ai(Object.assign(new Wf("PptRibbon.SmartArt.CreateGraphic"),{externalUxGroupId:"SmartArtCreateGraphic"}));this.Ai(Object.assign(new Wf("PptRibbon.SmartArt.Layouts"),{externalUxGroupId:"SmartArtLayouts"}));
this.Ai(Object.assign(new Wf("PptRibbon.SmartArt.Reset"),{externalUxGroupId:"SmartArtReset"}));this.Ai(Object.assign(new Wf("PptRibbon.SmartArt.Styles"),{externalUxGroupId:"SmartArtStyles"}));this.Ai(Object.assign(new Wf("PptRibbon.Transition.AllSlides"),{externalUxGroupId:"TransitionAllSlides"}));this.Ai(Object.assign(new Wf("PptRibbon.Transition.Gallery"),{externalUxGroupId:"Transitions"}));this.Ai(Object.assign(new Wf("PptRibbon.Transition.Timing"),{externalUxGroupId:"TransitionTiming"}));this.Ai(Object.assign(new Wf("PptRibbon.Review.Proofing"),
{externalUxGroupId:"Proofing"}));this.Ai(Object.assign(new Wf("PptRibbon.View.PresentationViews"),{externalUxCommandIds:["ReadingView"]}));this.Ai(Object.assign(new Wf("PptRibbon.View.ShowHide"),{externalUxCommandIds:["Notes","ShowHideComments"]}));this.Ai(Object.assign(new Wf("PptRibbon.View.StartSlideShow"),{externalUxGroupId:"StartSlideShow"}));this.Ai(Object.assign(new Wf("PptRibbon.View.Zoom"),{externalUxGroupId:"Zoom"}));this.Ai(Object.assign(new Wf("PptRibbon.View.Subtitles"),{externalUxGroupId:"Subtitles"}));
this.Ai(Object.assign(new Wf("PptRibbon.Help.GroupHelp"),{externalUxGroupId:"Help"}));this.Ai(Object.assign(new Wf("PptRibbon.PictureFormat.PictureBorders"),{externalUxGroupId:"PictureBorders"}));this.Ai(Object.assign(new Wf("PptRibbon.DrawingFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.Ai(Object.assign(new Wf("PptRibbon.PictureFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.Ai(Object.assign(new Wf("PptRibbon.Graphics.NewArrange"),{externalUxGroupId:"GraphicsArrange"}));this.Ai(Object.assign(new Wf("PptRibbon.DrawingFormat.FormatOptions"),
{externalUxGroupId:"Properties"}));this.Ai(Object.assign(new Wf("PptRibbon.PictureFormat.FormatOptions"),{externalUxGroupId:"Size"}));this.Ai(Object.assign(new Wf("PptRibbon.Graphics.FormatOptions"),{externalUxGroupId:"Properties"}))}tZh(){this.addCommandToMaps(Object.assign(new Va.a("PptFileMenuEmbed","981175184"),{legacyControlId:"PptJewel.Share.Embed"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileMenuShare","981334692"),{legacyControlId:"PptJewel.Share.ShareWithPeople"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileMenuTermsOfUse",
"2349775795"),{legacyControlId:"PptJewel.About.TermsOfUse"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileMenuThirdPartyNotices","2220417879"),{legacyControlId:"PptJewel.About.ThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileMenuPrivacy","1208554566"),{legacyControlId:"PptJewel.About.Privacy"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileAboutPage","336231556"),{legacyControlId:"PptJewel.About"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileHomePage",
"2074131365"),{legacyControlId:"PptJewel.Home"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileAddinPage","336231556"),{legacyControlId:"PptJewel.Addin"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileInfoPage","336231556"),{legacyControlId:"PptJewel.Info"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileNewPage","2074131365"),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileOpenPage","2799130311"),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Va.a("PptFilePrintPage",
"336231556"),{legacyControlId:"PptJewel.Print"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileSaveAsPage","336231556"),{legacyControlId:"PptJewel.SaveACopy"}));this.addCommandToMaps(Object.assign(new Va.a("PptFileSharePage","336231556"),{legacyControlId:"PptJewel.Share"}))}AZh(){this.addCommandToMaps(new Va.a("GroupAnchor","3206512596"));this.addCommandToMaps(new Va.a("GroupShapes","1084571292"));this.addCommandToMaps(new Va.a("UngroupShapes","2681035587"))}xZh(){this.addCommandToMaps(new Va.a("AudioPlay",
"354524898"));this.addCommandToMaps(new Va.a("AudioPause","381759002"));this.addCommandToMaps(Object.assign(new Va.a("SetAudioOptions","3754409354"),{queryCommandId:"934802286"}));this.addCommandToMaps(Object.assign(new Va.a("PlayAcrossSlides","2830952303"),{queryCommandId:"4262270261"}));this.addCommandToMaps(Object.assign(new Va.a("LoopUntilStopped","3632291603"),{queryCommandId:"3552942809"}));this.addCommandToMaps(Object.assign(new Va.a("HideDuringShow","3215231982"),{queryCommandId:"532089170"}));
this.addCommandToMaps(Object.assign(new Va.a("RewindAfterPlaying","3190911303"),{queryCommandId:"1283553413"}));this.addCommandToMaps(Object.assign(new Va.a("PlayInBackground","1867854189"),{queryCommandId:"2980229931"}));this.addCommandToMaps(Object.assign(new Va.a("NoAudioStyle","215519670"),{queryCommandId:"2550125834"}));this.addCommandToMaps(new Va.a("SetVolume","489231152"));this.addCommandToMaps(Object.assign(new Va.a("SetVolumeLow","3743080814"),{queryCommandId:"1369975562"}));this.addCommandToMaps(Object.assign(new Va.a("SetVolumeMedium",
"3138571443"),{queryCommandId:"2162671853"}));this.addCommandToMaps(Object.assign(new Va.a("SetVolumeHigh","2824132372"),{queryCommandId:"2284865724"}));this.addCommandToMaps(Object.assign(new Va.a("SetVolumeMute","2837428403"),{queryCommandId:"2835961045"}));this.addCommandToMaps(Object.assign(new Va.a("StartAudio","333691564"),{queryCommandId:"646903900"}))}IZh(){this.addCommandToMaps(Object.assign(new Va.a("GetSlideInformation","798637440"),{queryCommandId:"1740197325"}));this.addCommandToMaps(Object.assign(new Va.a("OpenLanguageDialog",
"3274206189"),{legacyControlId:"PptEditingStatusBar.LanguageButton",queryCommandId:"2048144900"}));this.addCommandToMaps(Object.assign(new Va.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));this.addCommandToMaps(Object.assign(new Va.a("TextForOfficeOnlineInGallatin","798637440"),{legacyControlId:"PptEditingStatusBar.MiddleStatus"}));this.addCommandToMaps(Object.assign(new Va.a("GetEnvironmentName","798637440"),{legacyControlId:"EnvironmentLabel",queryCommandId:"3887408216"}));
this.addCommandToMaps(Object.assign(new Va.a("GetSlideScore","798637440"),{legacyControlId:"SlideScoreLabel",queryCommandId:"1312683093"}));this.addCommandToMaps(Object.assign(new Va.a("GetCoAuthStatus","798637440"),{legacyControlId:"CoauthStatusLabel",queryCommandId:"587300872"}));this.addCommandToMaps(Object.assign(new Va.a("GetDataSyncMode","798637440"),{legacyControlId:"DataSyncModeLabel",queryCommandId:"119594198"}));this.addCommandToMaps(Object.assign(new Va.a("GetOfflineStatus","798637440"),
{legacyControlId:"PptEditingStatusBar.OfflineModeStatusLabel",queryCommandId:"225752111"}));this.addCommandToMaps(Object.assign(new Va.a("ShowAddInCommandsLoadStatusCallout","516359383"),{legacyControlId:"PptEditingStatusBar.AddInCommandsLoadStatus",queryCommandId:"1309495434"}));this.addCommandToMaps(Object.assign(new Va.a("OpenFeedbackDialog","802602464"),{legacyControlId:"PptEditingStatusBar.GiveFeedback"}));this.addCommandToMaps(Object.assign(new Va.a("GiveFeedbackPane","2918242107"),{legacyControlId:"PptEditingStatusBar.GiveFeedbackPane"}));
this.addCommandToMaps(Object.assign(new Va.a("ShowHidePerfStats","2319158239"),{legacyControlId:"PptEditingStatusBar.PerfStats",queryCommandId:"298865648"}));this.addCommandToMaps(Object.assign(new Va.a("ShowHideNotes","3113372712"),{legacyControlId:"PptEditingStatusBar.Notes",queryCommandId:"850829913"}));this.addCommandToMaps(Object.assign(new Va.a("ShowEditTriPaneViewInStatusBar","12696731"),{legacyControlId:"PptEditingStatusBar.Edit",queryCommandId:"363623614"}));this.addCommandToMaps(Object.assign(new Va.a("ShowSorterViewInStatusBar",
"1659792175"),{legacyControlId:"PptEditingStatusBar-SlideSorterView",queryCommandId:"2246678568"}));this.addCommandToMaps(Object.assign(new Va.a("SwitchToReadingMode","3849298593"),{legacyControlId:"PptEditingStatusBar.Reading"}));this.addCommandToMaps(Object.assign(new Va.a("StartSlideShowFromCurrentSlide","1989200744"),{legacyControlId:"PptEditingStatusBar.SlideShow"}));this.addCommandToMaps(new Va.a("ZoomOut","195579685"));this.addCommandToMaps(Object.assign(new Va.a("OpenZoomConfig","3864281841"),
{legacyControlId:"PptEditingStatusBar.ZoomScale",queryCommandId:"1923067973"}));this.addCommandToMaps(new Va.a("ZoomIn","3018530951"));this.addCommandToMaps(Object.assign(new Va.a("ZoomToFit","2470172091"),{legacyControlId:"PptEditingStatusBar.FitToWindow"}))}uZh(){this.addCommandToMaps(new Va.a("AccessibleAuthoringHelp","378041226"));this.addCommandToMaps(new Va.a("AddHiddenSlideTitle","4032980552"));this.addCommandToMaps(new Va.a("AddSlideTitle","2061524948"));this.addCommandToMaps(new Va.a("EditSlideTitle",
"1049013003"));this.addCommandToMaps(new Va.a("InsertCaptions","960930904"));this.addCommandToMaps(new Va.a("InsertCaptionsSplitButton","327712988"));this.addCommandToMaps(new Va.a("LinkText","2488223096"));this.addCommandToMaps(new Va.a("RemoveAllCaptions","2891615490"));this.addCommandToMaps(new Va.a("SetAsSlideTitle","2069673123"));this.addCommandToMaps(new Va.a("SlideTitle","3898323075"))}}Object(e.a)(XA,"PPTWebEditReactCommandDefinitionMapping",Xw,[]);class Fy{}Fy.suh="TabId";Object(e.a)(Fy,
"RibbonSQMProperties",null,[]);class cB{constructor(a){this.Ca=a;this.Ca.xa(G.a.Xcd,de.a.frame,Object(D.a)(this,this.Xcd,"reportTabSwitch"));this.Ca.xa(G.a.Oeh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(G.a.Qeh,de.a.frame,ce.ActionManager.Fg)}Xcd(a,b,c,f,l){this.Ca.processAction(this.taj(l[Fy.suh]),2);return 32}}Object(e.a)(cB,"RibbonSQMInformation",null,[1197]);class oh{}oh.bzc="PptRibbon.AddIns";oh.Aaa="PptRibbon.Animation";oh.design="PptRibbon.Design";oh.nGc="PptRibbon.Developer";oh.mOc="PptRibbon.Graphics";
oh.help="PptRibbon.Help";oh.home="PptRibbon.Home";oh.insert="PptRibbon.InsertTab";oh.picture="PptRibbon.PictureFormat";oh.review="PptRibbon.Review";oh.shape="PptRibbon.DrawingFormat";oh.slideShow="PptRibbon.SlideShow";oh.smartArt="PptRibbon.SmartArt";oh.Suh="ContextualTabs.Tables.Design";oh.tableLayout="ContextualTabs.Tables.Layout";oh.ZYa="PptRibbon.Transition";oh.view="PptRibbon.View";Object(e.a)(oh,"MLRTabIds",null,[]);class mj{}mj.bzc="AddIns";mj.Aaa="Animations";mj.design="Design";mj.nGc="Developer";
mj.draw="Draw";mj.mOc="Graphics";mj.help="Help";mj.home="Home";mj.insert="Insert";mj.picture="FormatPicture";mj.review="Review";mj.shape="FormatShape";mj.slideShow="SlideShow";mj.smartArt="SmartArtDesign";mj.table="Table";mj.ZYa="Transitions";mj.view="View";Object(e.a)(mj,"SLRTabIds",null,[]);class ZF extends cB{constructor(a){super(a)}gMk(){this.Ca.xa(G.a.Aeh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(ba.a.Beh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(ba.a.Ceh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(G.a.Deh,
de.a.frame,ce.ActionManager.Fg);this.Ca.xa(ba.a.Feh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(G.a.Geh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(G.a.Heh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(G.a.Ieh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(ba.a.Jeh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(G.a.Keh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(ba.a.Leh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(ba.a.Meh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(ba.a.Neh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(ba.a.AEe,
de.a.frame,ce.ActionManager.Fg);this.Ca.xa(ba.a.Peh,de.a.frame,ce.ActionManager.Fg);this.Ca.xa(G.a.Reh,de.a.frame,ce.ActionManager.Fg)}taj(a){let b=G.a.Qeh,c="PptRibbon.Unknown";switch(a){case oh.bzc:case mj.bzc:c=oh.bzc;b=G.a.Aeh;break;case oh.Aaa:case mj.Aaa:c=oh.Aaa;b=ba.a.Beh;break;case oh.design:case mj.design:c=oh.design;b=ba.a.Ceh;break;case oh.nGc:case mj.nGc:c=oh.nGc;b=G.a.Deh;break;case mj.draw:c=a;b=ba.a.Eeh;break;case oh.mOc:case mj.mOc:c=oh.mOc;b=ba.a.Feh;break;case oh.help:case mj.help:c=
oh.help;b=G.a.Geh;break;case oh.home:case mj.home:c=oh.home;b=G.a.Heh;break;case oh.insert:case mj.insert:c=oh.insert;b=G.a.Ieh;break;case oh.picture:case mj.picture:c=oh.picture;b=ba.a.Jeh;break;case oh.review:case mj.review:c=oh.review;b=G.a.Keh;break;case oh.shape:case mj.shape:c=oh.shape;b=ba.a.Leh;break;case oh.slideShow:case mj.slideShow:c=oh.slideShow;b=ba.a.Meh;break;case oh.smartArt:case mj.smartArt:c=oh.smartArt;b=ba.a.Neh;break;case oh.Suh:case oh.tableLayout:c=a;b=ba.a.AEe;break;case mj.table:c=
oh.Suh;b=ba.a.AEe;break;case oh.ZYa:case mj.ZYa:c=oh.ZYa;b=ba.a.Peh;break;case oh.view:case mj.view:c=oh.view,b=G.a.Reh}if(a=Mc.a.Cb)a.actionName=c,a.Ij=!0,a.Ar=!1;return b}}Object(e.a)(ZF,"PPTWebEditorRibbonSQMInformation",cB,[]);var dv=d(902);class dB{constructor(){this.gKb=null}Dql(){this.gKb||(this.gKb=hb.a.instance.pb("Common.App.AccountSwitching.IAccountSwitching"))||Z.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}OWi(){this.Dql();return this.gKb?this.gKb.getCustomAuthConfig():
null}static uEj(){return u.AFrameworkApplication.fa.ka("UiHostSupportsCustomAuthConfig")}}Object(e.a)(dB,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class eB{constructor(){this.s5b=this.cultureName=null}}Object(e.a)(eB,"HeaderCultureInfo",null,[]);var Gy=d(657);class $F{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(e.a)($F,"SearchInitializationSettings",null,[]);class aG{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=
!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(e.a)(aG,"DocumentTitleAppProps",null,[]);class bG{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=
!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(e.a)(bG,"DocumentTitleCalloutAppProps",null,[]);class cG{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=
this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=
!1}}Object(e.a)(cG,"HeaderAppProps",null,[]);class dG{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(e.a)(dG,"HeaderControls",null,[]);class eG{constructor(){this.command=this.label=null}}Object(e.a)(eG,"WorkflowButtonAppProps",null,[]);var Hy;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]="insufficientPermission";a[a.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(Hy||
(Hy={}));Object(e.b)("RenameDisableReason",Hy);class fG{constructor(a=""){this.zGe=this.documentTitleAppProps=this.tUe=null;this.KVh=""!==a?a:sp.a.pO}G$i(a){const b=hb.a.instance.pb("Common.IExternalUICommandDefinitionMapping").CBa(a);if(b&&0<b.length)return b[0].externalUxCommand;Z.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",a));return null}Z1d(){if(!this.tUe){const a=dv.a();if(a){const b=this.G$i(a.command);b&&(this.tUe=Object.assign(new eG,
{command:b,label:a.label}))}}return this.tUe}R_i(){return Object.assign(new dG,{workflowButton:this.Z1d()})}rjk(){pd.a.get_instance().gJ(17)}onMove(){const a={};a.MoveButtonClickedTime=new Date;u.AFrameworkApplication.Ta.Ka(G.a.qcb,2,a)}faj(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}M1i(){let a=
null,b=null;var c=hb.a.instance.pb("Common.IRenameProps");c?(c=c.ucg(),0!==c&&(a=this.faj(c),b=Hy[c])):Z.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new bG,{breadcrumbBrandName:u.AFrameworkApplication.fu.breadcrumbBrandName,breadcrumbBrandUrl:u.AFrameworkApplication.fu.breadcrumbBrandUrl,breadcrumbFolderName:u.AFrameworkApplication.fu.breadcrumbFolderName,breadcrumbFolderUrl:u.AFrameworkApplication.fu.breadcrumbFolderUrl,hideDocumentTitleInput:u.AFrameworkApplication.Aa.gb.Wrj,
isVersionHistoryEnabled:this.I$k(),documentExtension:Ma.a.uV(u.AFrameworkApplication.fileName),isMoveEnabled:32===u.AFrameworkApplication.Ta.processAction(G.a.qcb,1),onMove:Object(D.a)(this,this.onMove,"onMove"),message:a,renameDisableReason:b,openBreadcrumbsInNewTab:u.AFrameworkApplication.fa.ka("OpenLinksInNewWindow")})}S8f(){if(!this.documentTitleAppProps){const a=u.AFrameworkApplication.fu.ux;this.documentTitleAppProps=Object.assign(new aG,{documentTitle:u.AFrameworkApplication.VGc?a:Ma.a.lG(a),
onFirstRender:Object(D.a)(this,this.rjk,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(D.a)(this,this.M1i,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}I$k(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Kwg}S8k(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.aNj}t$k(){const a=!dv.b()&&!u.AFrameworkApplication.hideHeader&&!u.AFrameworkApplication.Gjg&&(u.AFrameworkApplication.fa.ka("SkypeWebControlIsEnabled")||u.AFrameworkApplication.fa.ka("TeamsChatIsEnabled"));
Z.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}yti(a){appChrome.getHeaderApi().then(b=>{b.setNavBarData(a.result);return null});Z.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}tKk(){appChrome.getHeaderApi().then(a=>{const b=hb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");a.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});a.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});a.setHeaderCommandHandler("OnFlexPaneOpen",
c=>{b.onFlexPaneOpen(c)});a.setHeaderCommandHandler("OnFlexPaneClose",c=>{b.onFlexPaneClose(c)});a.setHeaderCommandHandler("SetCookie",c=>Hi.a.set(c.cookieName,c.value));a.setHeaderCommandHandler("GetCookie",c=>this.S_i(c));a.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(D.a)(this,this.Z1d,"getWorkflowButtonAppProps"));a.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(D.a)(this,this.S8f,"getDocumentTitleAppProps"));a.setHeaderCommandHandler("OnDocumentTitleReducerReady",
()=>{this.sjk();return null});Gy.a.uTc()&&a.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(D.a)(this,this.Qcg,"getSearchInitializationSettings"))})}sjk(){hb.a.instance.La("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.gna(!1,u.AFrameworkApplication.Ta.mode)})}S_i(a){a=Hi.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}sej(){return lk.AppChromeOverrideUtilities.isEnabled?lk.AppChromeOverrideUtilities.getPath("suiteux-shell",!1):this.KVh+
u.AFrameworkApplication.Y_+"suiteux-shell"}onFirstRender(){hb.a.instance.La("Common.App.O365Shell.IO365ShellActor").execute(a=>{a.g8k.continueWith(Object(D.a)(this,this.yti,"continueShellServiceDataAsync"),3)});pd.a.get_instance().gJ(15)}onFullyLoaded(){pd.a.get_instance().gJ(16)}q$i(){a:{try{var a=sa.a.le(u.AFrameworkApplication.lcid);if(a){var b=Object.assign(new eB,{cultureName:a.name,s5b:a.s5b});break a}}catch(c){Z.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+
u.AFrameworkApplication.lcid.toString())}b=Object.assign(new eB,{cultureName:"en-us",s5b:"en"})}a=hb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");b=Object.assign(new cG,{appName:CommonUIStrings.l_AppNameShort,culture:b.cultureName,language:b.s5b,isConsumer:!u.AFrameworkApplication.bmd,showAppLauncher:dv.f(),showMeControl:dv.e(),hideUserName:u.AFrameworkApplication.X3d,defaultDocumentTitleToLeft:u.AFrameworkApplication.vUf,assetsContainerOverride:this.sej(),controls:this.R_i(),
documentTitleAppProps:this.S8f(),showDocumentTitleControl:!0,showWorkflowButton:!!this.Z1d(),showChatControl:this.t$k(),showGoPremiumControl:dv.g(),showDiscoverPremiumButton:dv.d(),enableSearchControl:Gy.a.AMj(),onFlexPaneOpen:Object(D.a)(a,a.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(D.a)(a,a.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.S8k(),testTraffic:u.AFrameworkApplication.fa.ka("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(D.a)(this,this.onFirstRender,"onFirstRender"),
onFullyLoaded:Object(D.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:u.AFrameworkApplication.T8k()});!u.AFrameworkApplication.Jhb||u.AFrameworkApplication.nMe?(b.userDisplayName=u.AFrameworkApplication.userName,b.emailAddress=u.AFrameworkApplication.fa.Ha("UserPrincipalName"),b.userID=u.AFrameworkApplication.fa.Ha("Puid")||"",b.signOutLink=u.AFrameworkApplication.nMe):u.AFrameworkApplication.signInUrl&&(b.signInLink=u.AFrameworkApplication.signInUrl);Gy.a.uTc()&&(a=this.Qcg(),
b.loadTellMeResources=a.loadTellMeResources,b.getTokenRequestDictionary=a.getTokenRequestDictionary,b.enableVanillaSearchBox=u.AFrameworkApplication.fa.ka("VanillaSearchUxInHeaderIsEnabled"),b.userRing=a.userRing);dB.uEj()&&(a=new dB,b.shellAuthProviderConfigPromise=Object(D.a)(a,a.OWi,"getAccountSwitchingConfig"));this.tKk();return b}Qcg(){if(!this.zGe){const a=new Gy.a;let b=u.AFrameworkApplication.fa.Ha("Microsoft365Ring");b&&b.length||(b="generalAudience");this.zGe=Object.assign(new $F,{loadTellMeResources:a.gUj(),
getTokenRequestDictionary:Object(D.a)(a,a.Mfj,"getTokenRequestDict"),userRing:b})}return this.zGe}}Object(e.a)(fG,"ReactSharedHeaderPropsHelper",null,[552]);var og=d(336),pP=d(1184),qP=d(1034);d(903);var gG=d(656);const Jt=(a,b)=>{let c=0;for(;b()&&c<a.length;)a[c](),c++},hG=(a,b,c,f)=>{if(a&&a.parentNode&&a.parentNode.parentNode){var l=(l=Vg.a.Ru(a))?Ba.a.yL(l.paddingLeft)+Ba.a.yL(l.paddingRight):0;var x=Vg.a.Ru(a.parentNode);x=x?Ba.a.yL(x.paddingLeft)+Ba.a.yL(x.paddingRight):0;let F=0,R=a;for(;R.nextSibling;)R=
R.nextSibling,F+=R.offsetWidth;l=l+x+F;"auto"!==a.parentNode.style.width&&(a.style.width=a.parentNode.offsetWidth-l+"px");x=f?c:b;c=f?b:c;f=kb.a.Yh(a.parentNode.parentNode);b=x?kb.a.Yh(x):new Sys.UI.Bounds(f.x,0,0,0);c=c?kb.a.e6a(c):new Sys.UI.Point(f.x+f.width,0);"absolute"===a.parentNode.style.position?b=c.x-(b.x+b.width)-l-1:(f=kb.a.Yh(a.nextSibling?a.parentNode:a),f=f.x+f.width/2,b=2*Math.min(f-(b.x+b.width),c.x-f)-l-1);a.style.maxWidth=b+"px"}},Iy=a=>{a&&Xq(a)&&(a.style.display="",a._isHidden=
"0")},jl=a=>{a&&!Xq(a)&&(a.style.display="none",a._isHidden="1")},Xq=a=>{if(!a)return!0;a=a._isHidden;return!(void 0===a||null===a||"0"===a)},ys=(a,b,c)=>{if(a&&!Xq(a)){var f=Vg.a.Ru(a);f=Ba.a.yL(f.paddingLeft)+Ba.a.yL(f.paddingRight);c=a.offsetWidth-c-f;let l=0;for(;b&&b!==a;)(f=Vg.a.Ru(b))&&(l+=Ba.a.yL(f.paddingLeft)+Ba.a.yL(f.paddingRight)),b=b.parentNode;c=Math.max(c,75+l);a.style.width=c+"px"}},Er=a=>{a&&(a.style.width="auto",a.style.maxWidth="none")},rP=(a,b,c)=>{if(a&&b){let f=0,l=0;({left:f,
top:l}=kb.a.Z8f(b,f,l));b=c?f-a.offsetWidth:f+b.offsetWidth;a&&(a.style.position="absolute",a.style.left=b+"px")}},tq=(a,b,c)=>!a||!b||Xq(a)||Xq(b)?!1:kb.a.Bzg(kb.a.Yh(a),kb.a.Yh(b),c),zs=(a,b,c)=>{let f=0;a&&b&&(f=kb.a.wbe(kb.a.Yh(a),kb.a.Yh(b),c));return f};var Fr=d(355);class Jy{constructor(a,b,c){this.qqb=this.iYb=this.pqb=this.T4a=this.sHc=this.hYb=this.hG=this.gYb=this.POa=this.tP=this.tHc=this.OOa=this.iba=this.Ou=this.iK=this.eS=this.NOa=this.S4a=this.R4a=this.XAa=null;this.iR=a;this.$Lb=
b;this.Qi=c}NXk(a){this.iR=a;this.$Lb=null;this.rVd(this.iR);this.Hzh();this.dih()}xXa(){this.iR&&this.$Lb&&this.$Lb.clientHeight&&(this.rVd(this.iR),this.Hzh(),this.dih(),-1!==this.$Lb.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.f3f(this.$Lb),this.Erl(),this.RXk()))}rVd(a){if(a)for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c],l=Ba.a.Yha(f),x=!!f.id;if(-1!==l.indexOf("cui-QATRowLeft"))this.XAa=f;else if(-1!==l.indexOf("OfficeOnlineBrandBreadcrumbSeparator"))this.R4a=
f;else if(f.id===ym.CuiHelper.JJd)this.S4a=f;else if(f.id===ym.CuiHelper.r4f)this.NOa=f;else if(f.id===ym.CuiHelper.KJd)this.eS=f;else if(-1!==l.indexOf("cui-QATRowCenter"))this.iK=f;else if(f.id===ym.CuiHelper.LJd)this.Ou=f;else if(-1!==l.indexOf("cui-QATRowRight"))this.iba=f;else{var b;if(b=x)b=f,b=!!b.id&&(b.id.startsWith(ym.CuiHelper.ZJe)||b.id.startsWith(ym.CuiHelper.Vcd));b?this.OOa=f:x&&f.id.startsWith(ym.CuiHelper.Sdl)?this.tHc=f:-1!==l.indexOf("UsernameNameContainer")?this.tP=f:-1!==l.indexOf("UsernameNameItem")&&
(this.POa=f)}this.rVd(f)}}Hzh(){var a=[this.iK,this.Ou,this.tP],b=[this.R4a,this.S4a,this.NOa,this.eS,this.iK,this.Ou,this.iba,this.OOa,this.tHc,this.tP];for(const c of b)Iy(c);for(const c of a)Er(c);if(a=this.iK)a.style.position="static",a.style.left="auto"}dih(){this.RNd()?this.PXk():this.QXk();var a=this.NOa,b=this.eS;a&&b&&(a.style.marginTop=(b.offsetHeight-a.offsetHeight)/2+"px")}PXk(){let a;const b=this.IYd();a=[()=>{ys(this.eS,this.eS,zs(this.XAa,b,this.Qi))},()=>{jl(this.R4a);jl(this.S4a);
jl(this.NOa);jl(this.eS)}];Jt(a,()=>tq(this.eS,b,this.Qi));tq(this.hG,this.iK,this.Qi)&&rP(this.iK,this.hG,this.Qi);this.Mfh();a=[()=>{ys(this.tP,this.POa,zs(this.hG,this.iba,this.Qi))},()=>{jl(this.OOa)}];this.Nfh();Xq(this.iK)||Xq(this.Ou)||hG(this.Ou,this.hG,this.iba,this.Qi)}QXk(){const a=!!this.eS,b=!!this.Ou;let c=0;if((a||b)&&0<(c=zs(this.XAa,this.iK,this.Qi))){let f=a;b&&(!a||this.Ou.offsetWidth>this.eS.offsetWidth)&&(f=!1);ys(f?this.eS:this.Ou,f?this.eS:this.Ou,f?c:2*c);a&&b&&0<(c=zs(this.XAa,
this.iK,this.Qi))&&(f=!f,ys(f?this.eS:this.Ou,f?this.eS:this.Ou,f?c:2*c))}Jt([()=>{jl(this.R4a);jl(this.S4a);jl(this.NOa);jl(this.eS);Er(this.Ou)},()=>{ys(this.Ou,this.Ou,2*zs(this.XAa,this.iK,this.Qi))},()=>{jl(this.Ou)}],()=>tq(this.XAa,this.iK,this.Qi));this.Mfh();this.Nfh();Xq(this.iK)||Xq(this.Ou)||hG(this.Ou,this.XAa,this.iba,this.Qi)}Mfh(){const a=Xq(this.Ou);Jt([()=>{this.eFe()},()=>{jl(this.OOa);Er(this.Ou);Er(this.tP);a||Iy(this.Ou)},()=>{this.eFe()},()=>{jl(this.tHc);Er(this.Ou);Er(this.tP);
a||Iy(this.Ou)},()=>{this.eFe()}],()=>tq(this.iK,this.iba,this.Qi))}eFe(){const a=!!this.Ou,b=!!this.tP;let c=0;if((a||b)&&0<(c=zs(this.iK,this.iba,this.Qi))){const f=!!this.iK&&"absolute"!==this.iK.style.position;let l=a;b&&(!a||this.tP.offsetWidth>this.Ou.offsetWidth)&&(l=!1);ys(l?this.Ou:this.tP,l?this.Ou:this.POa,l&&f?2*c:c);a&&b?(0<(c=zs(this.iK,this.iba,this.Qi))&&(l=!l,ys(l?this.Ou:this.tP,l?this.Ou:this.POa,l&&f?2*c:c)),tq(this.iK,this.iba,this.Qi)&&(jl(this.iK),Er(this.tP))):a&&tq(this.iK,
this.iba,this.Qi)&&jl(this.Ou)}}Nfh(){const a=()=>{ys(this.tP,this.POa,zs(this.XAa,this.iba,this.Qi))};Jt([a,()=>{jl(this.OOa);Er(this.tP)},a,()=>{jl(this.tHc);Er(this.tP)},a,()=>{jl(this.tP)}],()=>tq(this.XAa,this.iba,this.Qi))}RNd(){if(!this.hG)return!1;for(let a=0;a<this.hG.childNodes.length;a++)if(-1!==Ba.a.Yha(this.hG.childNodes[a]).indexOf("cui-cg"))return!0;return!1}IYd(){if(!this.hG)return null;let a=null;for(let b=this.hG.childNodes.length-1;0<=b;b--){const c=this.hG.childNodes[b];if(-1===
Ba.a.Yha(c).indexOf("cui-cg"))break;a=c}return a}f3f(a){if(a)for(let b=0;b<a.childNodes.length;b++){const c=a.childNodes[b],f=Ba.a.Yha(c),l=!!c.id;-1!==f.indexOf("cui-jewel-container")?this.gYb=c:-1!==f.indexOf("cui-tts")?this.hG=c:-1!==f.indexOf("cui-TabRowInline")?this.hYb=c:-1!==f.indexOf("cui-separator")?this.sHc=c:l&&c.id.startsWith(ym.CuiHelper.x1g)?this.T4a=c:l&&c.id.startsWith(ym.CuiHelper.a2f)?this.pqb=c:-1!==f.indexOf("cui-TabRowRight")?this.iYb=c:l&&c.id.startsWith(ym.CuiHelper.Oxe)&&(this.qqb=
c);this.f3f(c)}}Erl(){var a=[this.hG,this.hYb,this.sHc,this.T4a,this.pqb,this.iYb,this.qqb];for(const b of a)Iy(b);this.wGb(0)}RXk(){let a;a=[()=>{jl(this.sHc);jl(this.T4a)},()=>{this.wGb(1)},()=>{this.wGb(2)},()=>{jl(this.hYb);this.wGb(0)}];Jt(a,()=>tq(this.hG,this.hYb,this.Qi));a=[()=>{jl(this.sHc);jl(this.T4a)},()=>{jl(this.pqb)},()=>{jl(this.qqb)},()=>{jl(this.iYb)}];Jt(a,()=>tq(this.hYb,this.iYb,this.Qi)||tq(this.hG,this.iYb,this.Qi));a=[()=>{this.wGb(1)},()=>{this.wGb(2)},()=>{jl(this.hG)}];
Jt(a,()=>tq(this.gYb,this.hG,this.Qi))}wGb(a){this.hG&&(this.hG.className=Jy.Vil[a],this.hG._scaleStep=a)}}Jy.Vil=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(e.a)(Jy,"TopBarScalingManager",null,[]);class iG{constructor(a,b){this.iR=this.fya=null;this._clientId=a;this.Prf=b}jMi(){if(!il.b(this.iR))return this.iR;this.mLi();this.iR.style.display="block";this.Prf&&this.Prf.Lga(Object(D.a)(this,this.onResize,"onResize"));return this.iR}onResize(){this.xXa()}xXa(){this.IKi()?(document.getElementById("application").style.minWidth=
"0px",(new Jy(this.iR,null,u.AFrameworkApplication.isRtl)).NXk(this.iR)):u.AFrameworkApplication.Aa.gb.iN||gG.a.OXk(this.iR,u.AFrameworkApplication.isRtl)}IKi(){return u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("EnhancedMobileViewIsEnabled"):!1}mLi(){if(il.b(this.fya)){var a;({N1b:a}=Fr.a.RIb(!u.AFrameworkApplication.LP)).returnValue&&(this.fya=uA("div"),this.fya.className=Fr.a.PNi,this.fya.id=ym.CuiHelper.aUd,a.appendChild(this.fya),this.dLi(),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.aSa&&
!u.AFrameworkApplication.LP&&this.gLi(),this.iMi())}}iMi(){il.b(this.iR)&&(this.iR=uA("div"),this.iR.className=Fr.a.cnl,this.iR.style.display="none",this.fya.appendChild(this.iR))}dLi(){Sys.UI.DomElement.addCssClass(this.fya,Fr.a.QNi);if(u.AFrameworkApplication.isRtl){var a=this.fya;if(!il.b(a)){var b=a.className;if(il.b(b)||-1===b.indexOf("cui-rtl"))b=b.trim()+" cui-rtl",b=b.trim(),a.className=b}}}gLi(){Sys.UI.DomElement.addCssClass(this.fya,"FlexBoxLayout")}}Object(e.a)(iG,"HeaderSkeleton",null,
[]);var sP=d(1209),fB=d(1160);class gB{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(e.a)(gB,"CommandDefinition",null,[]);class jG{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(e.a)(jG,"CommandDefinitionMapping",null,[]);const tP=a=>Object.assign(new jG,{getCommandByExternalUxId:b=>{const c=a.getCommandByExternalUxId(b);return c?Object.assign(new gB,{commandId:parseInt(c.commandId),externalUxCommand:c.externalUxCommand}):
Object.assign(new gB,{externalUxCommand:b})},getDoNothingCommand:()=>parseInt(G.a.ze),addCommandToMaps:Object(D.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(D.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(D.a)(a,a.addTabToMap,"addTabToMap")});var kG=d(913);class lG{}Object(e.a)(lG,"RibbonInitState",null,[]);var uP=d(384),mG=d(504);let As;class up{static Vol(a){u.AFrameworkApplication.Aa.gb.Irg||(a.ShowCommentsTopBar=!0);u.AFrameworkApplication.Aa.gb.xrg||(a.CatchUpWithChanges=
!0)}static Bxh(a){for(let b of up.CMh)a[b]=!0}static Ywl(a,b){var c=u.AFrameworkApplication.$1b;if(u.AFrameworkApplication.fa.Aw(c)&&u.AFrameworkApplication.fa.Ha(c)){up.Bxh(b);c=u.AFrameworkApplication.fa.HB("HostDefinedUIControls");for(let f=0;f<c.length;f++)up.Zwl(a,b,c[f]);up.Qol(b);up.Pol(b)}}static Zwl(a,b,c){if(c.id in a){a=a[c.id];for(let f of a)1===c.visibility?b[f]=!1:c.visibility||(b[f]=!0)}}static Qol(a){a.HostMoreOptions=a.HostOpenInBrowser&&a.HostOpenInClient&&a.HostDownload?!0:!1}static usa(){const a=
u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.oJ);return!!a&&"teams"===a.toLowerCase()}static y$k(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)}static aal(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",!1)}static Pol(a){up.usa()&&
(up.y$k()&&(a.HostOpenInClient=!1),up.aal()&&(a.HostMoreOptions=!0))}}up.CMh=(As=new Ha.a,As.add("HostOpenInClient"),As.add("HostConversation"),As.add("HostClose"),As.add("HostDownload"),As.add("HostOpenInBrowser"),As.add("HostMoreOptions"),As);Object(e.a)(up,"CommandTrimmer",null,[]);class nG{constructor(){}flatten(a){const b=[];for(const c of a)b.push.apply(b,c);return b}}Object(e.a)(nG,"ReactAsyncDispatcher",null,[]);class hB{}hB.bec="PageId";Object(e.a)(hB,"FileMenuSQMProperties",null,[]);class oG{constructor(a,
b){this.fq=null;this.Svc=!1;this.uLa=0;this.Bbf="";this.ipd={};this.hxd=a;this.Hd=b;this.yff=Object(D.a)(this,this.Dve,"onModalMouseWheel");this.V$e=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Q7;this.d1=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.pDa}gCb(){0<this.uLa?this.uLa++:(this.uLa++,u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(D.a)(this,
this.O7g,"pushTransientFocusScope"),0)}):this.O7g(),this.showModal())}O7g(){this.Hd&&this.Hd.oX(y.AFrame.dO,!0)}SYi(){const a=Ag.f(),b=appChrome.selectors.getShyState();return String.format("{0}{1}",a,this.V$e&&b.isActive&&1===b.state?"_ShyRibbon":"")}Sfj(a){var b=0;if(this.d1){if(this.ipd[a])return this.ipd[a];(b=document.getElementById("BusinessBar"))||Z.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");b=b?b.offsetTop:0;this.ipd[a]=
b}return b}showModal(){if(!this.fq)if(this.fq=this.createElement("div"),this.fq.setAttribute("id","ReactModalDiv"),this.fq.style.position="absolute",this.fq.style.bottom="0px",this.fq.style.left="0px",this.fq.style.right="0px",this.fq.style.backgroundColor="white",this.fq.style.opacity="0.0",this.d1){var a=document.getElementById("regionComposerRoot");a&&a.appendChild(this.fq)}else this.hxd.appendChild(this.fq);a=this.SYi();if(a!==this.Bbf){const b=this.Sfj(a),c=appChrome.selectors.getShyState();
this.V$e&&c.isActive&&1===c.state&&Ag.a("getRibbonHeight")?this.fq.style.top=String.format("{0}px",b+appChrome.api.getRibbonHeight(Ag.f())):this.fq.style.top=String.format("{0}px",b);this.Bbf=a}this.fq.style.display="block";this.fq.style.visibility="visible";this.fq.style.zIndex="1000";this.Svc||(window.addEventListener("wheel",this.yff,!0),this.CSc()?qe.a.instance.ob(qa.a.GQ,this.fq,Object(D.a)(this,this.D7c,"onModalPointerUp")):qe.a.instance.ob(qa.a.pointerDown,this.fq,Object(D.a)(this,this.C7c,
"onModalPointerDown")),this.Svc=!0)}Blk(){this.uLa--;0<this.uLa||(0>this.uLa?this.uLa=0:this.Qjg())}Bue(){this.uLa=0;this.yRd();this.Qjg()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}Pjg(){this.Hd&&this.Hd.ye&&this.Hd.ye.name===y.AFrame.dO&&!u.AFrameworkApplication.ue.Rv&&this.Hd.s4(y.AFrame.dO,!1);this.fq&&(this.fq.style.zIndex="-1",this.fq.style.visibility="hidden",this.fq.style.display="none");this.Svc&&(window.removeEventListener("wheel",this.yff,
!0),this.CSc()?qe.a.instance.xb(qa.a.GQ,this.fq,Object(D.a)(this,this.D7c,"onModalPointerUp")):qe.a.instance.xb(qa.a.pointerDown,this.fq,Object(D.a)(this,this.C7c,"onModalPointerDown")),this.Svc=!1)}Qjg(){this.CSc()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Pjg()},0)}):this.Pjg()}C7c(){this.zXb();this.YWf();this.Bue();this.$Ha();return!0}D7c(){this.zXb();this.YWf();this.Bue();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.$Ha()},0)});return!0}$Ha(){4===u.AFrameworkApplication.Aa.gb.Am&&
u.AFrameworkApplication.fa.ka("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?u.AFrameworkApplication.Aa.$Ha():this.Hd.Bf(y.AFrame.mV)}Dve(a){a.stopPropagation()}zXb(){const a=hb.a.instance.pb("Common.IReactContextualUILauncher");a&&a.zXb()}yRd(){const a=hb.a.instance.pb("Common.IReactContextualUILauncher");a&&a.yRd()}YWf(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.oDa&&(this.CSc()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}CSc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(e.a)(oG,"ReactModalDiv",null,[]);var Dn=d(524);class pG{constructor(a,b){this.pVh=a;this.SIh=b}}Object(e.a)(pG,"ReactExecuteCommandContext",null,[]);class ev{}ev.Color="Color";ev.IndexColorSelected="ColorSelected";Object(e.a)(ev,"ColorPickerCommandProperties",null,[]);var no=d(909);class oo{}oo.SelectedFont="SelectedFont";oo.Formatting="Format";oo.RequestUpdateMru="RequestUpdateMru";oo.FontPickerId="fontPickerId";oo.IsPinned="IsPinned";oo.Trigger="Trigger";Object(e.a)(oo,"FontPickerCommandProperties",
null,[]);class bp{}bp.Trigger="FontTrigger";bp.Name="FontName";bp.Action="FontAction";bp.Level="FontLevel";bp.IsPinned="FontIsPinned";Object(e.a)(bp,"FontPickerLogProperties",null,[]);class Yw{}Yw.Rows="Rows";Yw.Columns="Columns";Object(e.a)(Yw,"InsertTableCommandProperties",null,[]);class mn{}mn.Alt="Alt";mn.Number="Number";mn.UnitType="UnitType";mn.Text="Text";mn.MaxValue="MaxValue";Object(e.a)(mn,"SpinnerCommandProperties",null,[]);class qG{constructor(a,b,c,f,l,x,F,R,fa,wa=null,Xa=null){this.P0a=
null;this.guf=!1;this.Ard=[];this.eqc=-1;this.Cxc=!1;this.ZVh=0;this.fLb=null;this.Zpf=!1;this.TO=a;this.WLa=b;this.tsf=Object(va.a)(1499,a);this.Wm=c;this.Hd=f;l&&(this.P0a=new oG(l,f));this.MTh=x;this.nLh=F;this.zR=wa;this.Ca=R;this.B0a={};this.jb=fa;this.cVe=Xa;fa&&(fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||fa.ka("EnqueueTasksWhenTaskMgrIsYielding"))&&tj.a.instance.rEf.CWR(()=>this.guf=!0);fa&&(a=this.jb.Ha("CommandControlIdPairsForLoggingOverride")||
"")&&0<=a.trim().length&&({Hv:this.fLb}=fe.d(a));this.fLb||(this.fLb={})}get hjh(){return!!window.appChrome&&!!appChrome.selectors}lih(){-1!==this.eqc&&window.clearTimeout(this.eqc);this.eqc=window.setTimeout(()=>{for(this.eqc=-1;0<this.Ard.length;){if(Nm.a.instance.Rv){this.lih();break}const a=this.Ard.shift();a&&this.executeCommand(a.pVh,a.SIh)}},0)}executeCommand(a,b){if(Nm.a.instance.Rv){if(this.guf){this.Ard.push(new pG(a,b));this.lih();return}Z.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
a,b.modelType,xa.a.toJSON(b.payload));if(this.jb.ka("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(b){const c=this.Wm.getCommandByExternalUxId(a),f=b.modelType;this.cVe&&this.cVe.lVj(a,b);c?this.XMi(a,c,f,b):this.YMi(a,f,b);this.Fki(b);this.nak(a,b)}}YMi(a,b,c){switch(b){case "GalleryModel":case "PreviewGalleryModel":this.n0f(c,a)}}vvl(a,b,c,f,l){if(c.payload)switch(c.payload.type){case "CoauthorMenuPayload":a.MenuItemId=c.payload.coauthorId;break;case "ButtonPayload":a.MenuItemId=b.menuItemId;
a.CommandValueId=c.payload.commandValueId;this.N3a();break;case "ButtonPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandPreviewId;break;case "ButtonRevertPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandRevertId;break;default:a.MenuItemId=b.menuItemId}else a.MenuItemId=b.menuItemId;a.SourceControlId=f;return l}wvl(a,b,c){if(b.payload)switch(b.payload.type){case "MenuOpenPayload":a=this.Wm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;
break;case "MenuClosePayload":a=this.Wm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":c.CommandId=b.payload.executedControl;c.ControlId=b.payload.executedControl;c.ParentControlId=b.payload.parentControl;c.CloseAllMenus=!0;this.N3a();break;case "TellMeSearchResultChangePayload":c.Value=b.payload.searchText;break;case "SmartLookupPayload":c.CommandValueId=b.payload.selectionContextJson}return a}XMi(a,b,c,f){var l=this.awk(f,c),x=b.commandId;const F={},
R={};switch(c){case "SplitButtonModel":if(this.n1b(f.payload,Object(D.a)(this,this.wwl,"updateSplitButtonMenuState"),l))return;F.MenuItemId=b.menuItemId;this.kJe(f,F);break;case "StatefulSplitButtonModel":if(this.n1b(f.payload,Object(D.a)(this,this.Awl,"updateStatefulSplitButtonMenuState"),l))return;c=f.payload.statefulData;l=f.payload.statefulMode;"color"===l?F.Color=c:"icon"===l&&(c=this.Wm.getCommandByExternalUxId(c))&&(F.MenuItemId=c.menuItemId);break;case "FileMenu":F.MenuItemId=b.menuItemId;
F.SourceControlId=a;f.payload&&"FileMenuPageSwitchPayload"===f.payload.type&&this.jlj(x,f.payload,a);break;case "TellMe":x=this.wvl(x,f,F);F.SourceControlId=a;F.Location=f.payload.location;break;case "ButtonModel":f.payload&&"TabSwitchPayload"===f.payload.type?this.rpj(F,f):x=this.vvl(F,b,f,a,x);break;case "CompoundButtonModel":F.MenuItemId=b.menuItemId;F.CommandValueId=f.payload.commandValueId;F.SourceControlId=a;this.kJe(f,F);this.N3a();break;case "ToggleButtonModel":case "InkButtonModel":F.MenuItemId=
b.menuItemId;F.SourceControlId=a;this.kJe(f,F);this.N3a();break;case "FontPickerModel":switch(f.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":x=this.Wm.getCommandByExternalUxId("FontPickerMenuClose").commandId;F[oo.FontPickerId]=f.payload.launcherId;break;case "FontPickerFontSelectedPayload":c=f.payload.font;l=null;"string"===typeof c?(l=ia.FontUtils.rF(c),F.CommandValueId=l,l=ia.FontUtils.$Ec(l)):(c.data?(F.CommandValueId=c.data.fontToApply,F.MenuItemId=c.data.themeIndex,F[oo.Formatting]=
c.data):F.CommandValueId=c.name,l=c);F.SourceControlId=a;F[oo.RequestUpdateMru]=l;R[bp.Name]=f.payload.nameToLog?f.payload.nameToLog:"string"===typeof c?ia.FontUtils.oRc(c)?"*"+c:ia.FontUtils.q8d(c)?"[EF]":"[MF]":"";R[bp.IsPinned]=f.payload.isPinned;R[bp.Level]=f.payload.level;this.hce();break;case "FontPickerFontInfoRequestedPayload":F.CommandValueId=f.payload.font.name;F[oo.Trigger]=f.payload.trigger;R[bp.Trigger]=f.payload.trigger;R[bp.Name]=f.payload.nameToLog;this.hce();break;case "FontPickerFontPinningPayload":c=
f.payload.isPinned;F.CommandValueId=f.payload.fontKey;F[oo.IsPinned]=c;R[bp.Name]=f.payload.nameToLog;R[bp.Action]=c?"pin":"unpin";R[bp.Level]=f.payload.level;this.hce();break;default:return}break;case "ComboBoxModel":var fa=f.payload.type;switch(fa){case "MenuOpenPayload":case "MenuPopulatePayload":this.VGb(f.payload.launcherId,l)&&(x={},x[f.payload.launcherId]=c,this.WLa.Lec(x,Ag.g(f.payload)),this.B0a[a]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":c=
f.payload.newValue;if(!c)return;c.value?(F[no.a.Value]=c.value,F[no.a.IsFreeForm]=!0):(F[no.a.Value]=c.text,F.MenuItemId=c.key,F.CommandValueId=c.commandValueId);"ComboBoxPreviewPayload"===fa&&(x=b.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":x=b.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(f.payload.type){case "ZeroTermContextMenuClosePayload":c=xa.a.rK(f.payload);for(fa of c)F[fa]=f.payload[fa];break;default:this.n1b(f.payload,Object(D.a)(this,this.lul,
"updateFlyoutAnchorMenuState"),l),F.launcherId=f.payload.launcherId}break;case "InkFlyoutAnchorModel":this.n1b(f.payload,Object(D.a)(this,this.Ful,"updateInkFlyoutAnchorMenuState"),l);F.launcherId=f.payload.launcherId;break;case "ColorPickerModel":switch(f.payload.type){case "ColorPickerPayload":F[ev.Color]=f.payload.selectedColorId;break;case "ColorPickerPreviewPayload":x=b.commandPreviewId;F[ev.Color]=f.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":x=b.commandRevertId;break;
default:return}break;case "SpinButtonModel":F[mn.Number]=f.payload.value;F[mn.UnitType]=je.a.XVb(f.payload.unitType.toLowerCase());F[mn.Text]=f.payload.reservedValue;break;case "SliderModel":F[ap.Value]=f.payload.value;break;case "InsertTableModel":F[Yw.Rows]=f.payload.rows;F[Yw.Columns]=f.payload.columns;break;case "CheckboxModel":F[ai.a.On]=f.payload.checked;F.MenuItemId=b.menuItemId;break;case "PreviewGalleryModel":if(this.n1b(f.payload,Object(D.a)(this,this.Gvl,"updatePreviewGalleryMenuState"),
l)){F.launcherId=f.payload.launcherId;break}this.n0f(f,a);return;case "DocumentTitleModel":switch(f.payload.type){case "DocumentTitleRenamePayload":F.getNewDocumentTitle=f.payload.getNewDocumentTitle;break;case "MenuOpenPayload":x={};x[f.payload.launcherId]=c;this.WLa.Lec(x,Ag.g(f.payload));this.B0a[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":F.MenuItemId=f.payload.url;this.SVj(f.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":F.MenuItemId=
f.payload.assetId;F.SourceControlId=a;u.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&(F.IsPremium=f.payload.isPremium||!1);this.TVj(f.payload.pageId);break;case "CoauthorGallery":F.RenderTime=f.triggerTime;break;case "PeopleWell":F.RenderTime=f.triggerTime;break;case "SyncStatus":F.SourceControlId=a;break;case "InputBoxModel":F.Text=f.payload.newValue;break;case "PersonaButtonModel":F.CommandValueId=f.payload.commandValueId;this.enj(f.payload);break;default:return}x&&
!this.isShadowMenuOpen(f.payload)&&(F.CommandValueId||(F.CommandValueId=F.MenuItemId),b.legacyControlId&&(F.LegacyId=b.legacyControlId),F.SourceControlId||(F.SqmControlId=a),this.jb&&this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&F.launcherId&&(b=this.Wm.getCommandByExternalUxId(F.launcherId))&&(F.launcherCommandId=parseInt(b.commandId)),f.payload&&!il.b(f.payload.PRIReadinessCheck)&&(F.PRIReadinessCheck=f.payload.PRIReadinessCheck,this.Zpf=!0),f.payload&&
!il.b(f.payload.shouldTakeFocus)&&(F[Dn.a.xea]=f.payload.shouldTakeFocus),b=this.VAf(f,F),il.b(f.triggerTime)||(R.TriggerTime=f.triggerTime),f.payload&&!il.b(f.payload.userActionKey)&&(R.userActionKey=f.payload.userActionKey),this.pkh(R,f,a,x),this.tsf.executeCommand(x,F,this.getSelectedTabId(),b,!0,()=>{this.vTg(F,a)},R,Ag.g(f.payload)))}pkh(a,b,c,f){this.jb&&this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&c&&f&&(c=b.payload&&!il.b(b.payload.launcherId)?
b.payload.launcherId:c,a.ControlId=this.Fhh(this.h8i(c,f),f,!1));this.jb&&this.jb.ka("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&b.payload&&"terminalParentControlId"in b.payload&&(a.TerminalParentControlId=this.Fhh(b.payload.terminalParentControlId,f,!0))}Fhh(a,b,c){if(RegExp("^[a-zA-Z0-9_]*$").test(a))return a;Z.ULS.sendTraceTag(510247689,207,15,c?"CommandId: "+b+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+b+" has a controlId that is non-alphanumeric and may need to be changed");
return"MalformedId"}h8i(a,b){b=parseInt(b);b=ce.ActionManager.LMd(b)||ce.ActionManager.z2a(b)||"";return!il.b(b)&&b in this.fLb?this.fLb[b]:100<a.length?"":a}hce(){this.zR&&this.zR.execute(a=>{a.Zbe("ModernFontPickerExperience")})}VAf(a,b){let c=2;a.payload&&"inputMethod"in a.payload&&a.payload.inputMethod&&(c=a.payload.inputMethod,b[Dn.a.Uu]=c);return c}vTg(a,b){const c=Object(va.a)(y.AFrame,u.AFrameworkApplication.Aa);if(this.Hd&&this.Eoh(a)){if(!this.Hd.ye&&c){let f="null";if(a){const l=a.Value;
delete a.Value;f=xa.a.toJSON(a);il.b(l)||(a.Value=l)}Z.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",b,f,c.MHa)}this.Hd.wTi()}(this.Hd&&this.Hd.ye&&this.Hd.ye.name!==y.AFrame.dO&&c&&this.Hd.ye.name!==c.MHa||this.Eoh(a))&&this.Eoi(a)}Eoh(a){return!!a&&!il.b(a[Dn.a.xea])&&a[Dn.a.xea]}Eoi(a){Dn.a.Uu in a&&1===a[Dn.a.Uu]&&Ww.ShyRibbon.CNa(1,0)}rpj(a,b){Ag.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.N3a();this.TO.Kec();if(this.MTh&&this.Ca){const c={};c[Fy.suh]=b.payload.tabId;this.Ca.Ka(G.a.Xcd,2,c,this.zNc(b));il.b(b.payload.inputMethod)||(this.Ca.processAction(G.a.Oeh,2),this.Cxc||this.fdl(b.payload.tabId))}b=b.payload.tabId;a.NewContextId=b;a.NewContextCommand=this.Wm.i1d(b);Z.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+b);if(this.zR&&b){const c=b+"TabSwitchActivity";this.zR.execute(f=>
{f.Zbe(c)})}}n1b(a,b,c){const f=a.type;return"MenuClosePayload"===f?!0:"MenuOpenPayload"===f?(b(a,c),!0):!1}enj(a){a=a.type;"MenuOpenPayload"===a?u.AFrameworkApplication.Tth=!0:"MenuClosePayload"===a&&(u.AFrameworkApplication.Tth=!1)}awk(a,b){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&"MenuPopulatePayload"!==a.payload.type)return!1;const c=a.payload.launcherId,f=this.Wm.getCommandByExternalUxId(c);return f&&f.populationProps?((a=this.WLa.wye(f,b,a.payload))&&c in this.B0a&&
delete this.B0a[c],a):!1}lul(a,b){const c=a.launcherId;this.VGb(c,b)&&(b=appChrome.selectors.getFlyoutAnchorMenuItems(c),this.qJb(b,c,Ag.g(a)))}Ful(a,b){const c=a.launcherId;this.VGb(c,b)&&(b=Ag.j("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(c):appChrome.selectors.getFlyoutAnchorMenuItems(c),this.qJb(b,c,Ag.g(a)))}Gvl(a,b){const c=a.launcherId;this.VGb(c,b)&&(b=appChrome.selectors.getPreviewGalleryMenuItems(c),this.qJb(b,c,Ag.g(a)))}wwl(a,b){const c=a.launcherId;
this.VGb(c,b)&&(b=appChrome.selectors.getSplitButtonMenuItems(c),this.qJb(b,c,Ag.g(a)))}Awl(a,b){const c=a.launcherId;this.VGb(c,b)&&(b=appChrome.selectors.getStatefulSplitButtonMenuItems(c),this.qJb(b,c,Ag.g(a)))}getSelectedTabId(){return this.hjh?appChrome.selectors.getSelectedTabId():null}qJb(a,b,c){this.WLa.Lec(a,c);this.B0a[b]=new Date}VGb(a,b){let c=!0;a in this.B0a&&(c=this.B0a[a].getTime()<this.TO.TUc.getTime());return c&&!b&&this.hjh}n0f(a,b){const c={};var f=a.payload.selectedGalleryId;
const l=this.Wm.getCommandByExternalUxId(f);if(l){c.SourceControlId=f;c.MenuItemId=l.menuItemId;c.SqmControlId=b;l.legacyControlId&&(c.LegacyId=l.legacyControlId);a.payload&&!il.b(a.payload.shouldTakeFocus)&&(c[Dn.a.xea]=a.payload.shouldTakeFocus);this.h9i(a.payload,c);(f=this.zNc(a))||(f={});this.pkh(f,a,b,l.commandId);const x=this.VAf(a,c);this.tsf.executeCommand(l.commandId,c,this.getSelectedTabId(),x,!0,()=>{this.vTg(c,b)},f,Ag.g(a.payload))}}h9i(a,b){"CharacterGalleryPayload"===a.type&&(b.MenuItemId=
a.character)}kJe(a,b){a.payload&&"toggled"in a.payload&&(b[ai.a.On]=a.payload.toggled)}nak(a,b){"MenuOpen"===a?!this.P0a||"isShadowRendering"in b.payload&&b.payload.isShadowRendering||this.P0a.gCb():"MenuClose"===a&&this.P0a&&this.P0a.Blk()}N3a(){this.P0a&&this.P0a.Bue()}zNc(a){let b=null;il.b(a.triggerTime)||(b={},b.TriggerTime=a.triggerTime);return b}jlj(a,b,c){if(this.nLh&&this.Ca){const f={};f[hB.bec]=c;this.Ca.Ka(G.a.sSk,2,f)}this.qJb(b.pageControlIdMap,a,Ag.g(b))}TVj(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(G.a.HSk,
2);break;case "FileNewPage":this.Ca.processAction(G.a.ISk,2)}}SVj(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(G.a.ASk,2);break;case "FileOpenPage":this.Ca.processAction(G.a.BSk,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}fdl(a){if(u.AFrameworkApplication.fa.ka("TellMeHelpCoachMarkActivityEnabled")&&"Help"===a)this.zR.execute(b=>{b.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Cxc=!0;else{if(u.AFrameworkApplication.fa.ka("TellMe3TabSwitchCoachMarkActivityEnabled")&&
(this.zR.execute(b=>{b.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.ZVh)){this.Cxc=!0;return}u.AFrameworkApplication.fa.ka("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.Ca.processAction(G.a.kgb,2)&&(this.Cxc=!0)}}Fki(a){a&&a.payload&&a.payload.PRIReadinessCheck&&!this.Zpf&&appChrome.PRIToastManager.dismissToast()}}Object(e.a)(qG,"ReactExecuteCommandHandler",null,[]);class rG{constructor(){this.fileMenu=null}get rTe(){return 0}xXa(){}sqa(){return!1}x0(){return!1}get Xih(){return null}I4(){}V7d(){return!1}lNa(){}VOa(){}refresh(){}get controls(){return null}MDc(){}Kec(){}get S9(){return null}set S9(a){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(e.a)(rG,"ReactRibbonExternal",null,[1194,1485,1486]);var vP=d(268);class sG{constructor(a,b,c,f){this.Hd=a;this.Ca=b;this.Uyf=c;this.vlb=f}initialize(){this.Ca.xa(G.a.Aic,de.a.frame,Object(D.a)(this,this.ngh,"ribbonMoveForwardAction"));this.Ca.xa(G.a.zic,de.a.frame,Object(D.a)(this,this.mgh,"ribbonMoveBackwardAction"));this.Ca.xa(G.a.Ddd,de.a.frame,Object(D.a)(this,this.lgh,"ribbonEscAction"));var a=Fr.a.G5d(this.vlb,null,this.Uyf,!1);a.IK=!0;this.eEb(a,G.a.Aic,G.a.zic);a.bindAction(A.KeyInputManager.Na(w.a.B0,
0),G.a.Ddd);a=this.Hd.Bc(y.AFrame.dO);a.IK=!0;this.eEb(a,G.a.uqa,G.a.uqa);ja.a.instance.ob(qa.a.mouseDown,this.Uyf,Object(D.a)(this,this.unk,"onRibbonMouseDown"));a=vP.a.instance;Ag.a("enterKeytipMode")&&a.gGb(this.vlb,()=>{appChrome.api.enterKeytipMode(!1)});Ag.a("exitKeytipMode")&&a.wjc(this.vlb,()=>{appChrome.api.exitKeytipMode();Ww.ShyRibbon.CNa(1,0)});u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Q7&&(a=Object(va.a)(v.FocusManager,this.Hd))&&a.T3h(Object(D.a)(this,this.Tjk,"onFocusScopeChanged"))}Tjk(a,
b){if((a=Object(va.a)(y.AFrame,u.AFrameworkApplication.Aa))&&b.EUg&&u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Q7){const c=appChrome.selectors.getShyState();c.isActive&&b.EUg.name===a.MHa&&Ww.ShyRibbon.CNa(c.state,1)}}ngh(){return 4}mgh(){return 4}lgh(){Ag.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Q7&&appChrome.selectors.getShyState().isActive&&Ww.ShyRibbon.CNa(1,0),this.Hd.Bf(y.AFrame.mV));return 4}eEb(a,b,c){const f=
A.KeyInputManager.Na(w.a.Bq,0),l=A.KeyInputManager.Na(w.a.Bq,4);a.$o(f);a.$o(l);a.bindAction(f,b);a.bindAction(l,c)}unk(a){a.lc&&a.lc.target&&"input"!==a.lc.target.tagName.toLowerCase()&&a.lc.preventDefault();return!1}dispose(){this.Ca.eO(G.a.Aic,de.a.frame,Object(D.a)(this,this.ngh,"ribbonMoveForwardAction"));this.Ca.eO(G.a.zic,de.a.frame,Object(D.a)(this,this.mgh,"ribbonMoveBackwardAction"));this.Ca.eO(G.a.Ddd,de.a.frame,Object(D.a)(this,this.lgh,"ribbonEscAction"))}}Object(e.a)(sG,"ReactRibbonFocusManager",
null,[106]);class iB{constructor(){this.CommandLocation=0;this.CommandTabName=null;this.InvocationMethod=0}}Object(e.a)(iB,"CommandSqmInfo",null,[]);var Zw=d(347),$w;(function(a){a[a.UnspecifiedGallery=0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=
7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})($w||($w={}));Object(e.b)("GalleryType",$w);class Go{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(e.a)(Go,"CommonGalleryButtonProps",null,[]);class Ky extends Go{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(e.a)(Ky,"AdditionalTableStyleGalleryButtonProps",Go,[]);class tG extends Ky{constructor(){super()}}Object(e.a)(tG,"AdditionalChangeColorsGalleryButtonProps",
Ky,[]);class uG extends Go{constructor(){super();this.character=null}}Object(e.a)(uG,"AdditionalCharacterCodeGalleryButtonProps",Go,[]);class vG extends Go{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(e.a)(vG,"AdditionalFontStyleGalleryButtonProps",Go,[]);class wG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(e.a)(wG,"AdditionalGalleryProperties",
null,[]);class xG extends Go{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(e.a)(xG,"AdditionalIconButtonProperties",Go,[]);class yG extends Go{constructor(){super();this.styleDisplayName=null}}Object(e.a)(yG,"AdditionalInkThicknessGalleryButtonProps",Go,[]);class zG extends Go{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(e.a)(zG,"AdditionalListGallerButtonProps",
Go,[]);class AG extends Go{constructor(){super();this.text=null}}Object(e.a)(AG,"AdditionalPageNumberGalleryButtonProps",Go,[]);var Ly=d(655),fm=d(910),BG=d(1080);class jB{}jB.Text="Text";Object(e.a)(jB,"TextBoxCommandProperties",null,[]);var Am=d(296);const wP=(a,b)=>{var c=appChrome.selectors.getActiveControlStates();if(c=Object(va.a)(Object,c[a])){if((a=Object(va.a)(String,c.value))&&a===b)return!1;a=Object(va.a)(String,c.selectedKey);if(!b&&!a)return!1;if(a){c=Array.isArray(c.options)?c.options:
null;let f=null;for(let l=0;l<c.length;l++){const x=Object(va.a)(Object,c[l]);if(Object(va.a)(String,x.key)===a){f=x;break}}if(f&&Object(va.a)(String,f.text)===b)return!1}}return!0},DG=(a,b,c,f)=>{if(0<(f&2)){f=[];switch(b){case "ToggleButtonModel":case "InkButtonModel":f.push(My(a,c[ai.a.On]));break;case "CheckboxModel":f.push(appChrome.actions.toggleCheckbox(a,c[ai.a.On]));break;case "ComboBoxModel":if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||
u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!wP(a,c[no.a.Value]))break;(b=c[no.a.Key])?f.push(appChrome.actions.updateComboBoxKey(a,b,c[no.a.Value])):f.push(appChrome.actions.updateComboBoxValue(a,c[no.a.Value]));break;case "FontPickerModel":f.push(appChrome.actions.updateFontPickerSelectedFont(a,c[oo.SelectedFont]));break;case "SplitButtonModel":f.push(My(a,c[BG.a.On]));break;case "SpinButtonModel":f.push(appChrome.actions.updateSpinButton(a,
c[mn.Number],je.a.YVb(c[mn.UnitType]),c[mn.Text],c[mn.MaxValue],c[mn.Alt]));break;case "ColorPickerModel":f.push(appChrome.actions.updateColorPickerSelectedColor(a,c[ev.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":f.push(appChrome.actions.updatePageNumberGalleryButtonText(a,c[fm.a.Text]));break;case "CompoundButtonModel":c[ai.a.Description]&&f.push(appChrome.actions.updateCompoundButtonDescription(a,c[ai.a.Description]));ai.a.On in c&&f.push(My(a,c[ai.a.On]));break;case "SliderModel":c.snapToStep?
f.push(appChrome.actions.updateSliderSelectedValue(a,c[ap.Value])):f.push(appChrome.actions.updateSliderValue(a,c[ap.Value],c[ap.MinValue]||0,c[ap.MaxValue],c[ap.Text]));break;case "FlyoutAnchorModel":Ly.a.ImageIsVisible in c&&f.push(appChrome.actions.hideFlyoutAnchorIcon(a,!c[Ly.a.ImageIsVisible]));ai.a.On in c&&f.push(My(a,c[ai.a.On]));break;case "InputBoxModel":f.push(appChrome.actions.updateInputBoxValue(a,c[jB.Text]))}b=f;var l=Object(va.a)(String,c[Am.a.iconColor]);void 0!==l&&null!==l&&b.push(appChrome.actions.updateIconColor(a,
l));CG(a,c,f);b=f;(l=Object(va.a)(Object,c[Am.a.IconSet]))&&b.push(appChrome.actions.setControlIconSet(a,l));b=f;l=Object(va.a)(String,c[Am.a.customTooltip]);void 0!==l&&null!==l&&b.push(appChrome.actions.setControlCustomTooltip(a,l));a=f;(c=Array.isArray(c[Am.a.Eah])?c[Am.a.Eah]:null)&&a.push.apply(a,c);return f}return null},Kt=(a,b)=>appChrome.actions.updateControlEnabledDisabledState(a,b),My=(a,b)=>appChrome.actions.toggleButton(a,b),CG=(a,b,c)=>{b=Object(va.a)(String,b[Am.a.Icon]);void 0!==b&&
null!==b&&c.push(appChrome.actions.setControlIcon(a,b))};class EG{constructor(a,b,c,f){this.Wm=f;this.Goa=a;this.NJ=b;this.wlb=c;this.dOb={}}mwk(a,b,c,f,l=null){const x=a.ExternalGalleryId||a.ExternalId;var F=a.ExternalId;f.push(x);if(appChrome.selectors.isControlDefined(x))a.GalleryStyle&&Ag.d("setGalleryStyles")&&b.push(appChrome.actions.setGalleryStyles(x,a.GalleryStyle));else{if(4!==a.Type)return;c.push(appChrome.api.createGalleryModel(x,Object.assign(new wG,{columns:a.Width,sections:[appChrome.api.gallerySection([],
F)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}c=0;f=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Ag.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){F=[];const fa=[],wa=[],Xa={};for(var R of a.GallerySections){F.push(appChrome.api.gallerySection([],R.SectionId,R.Title));0===c&&R.GalleryButtons&&
0<R.GalleryButtons.length&&(c=R.GalleryButtons[0].Type);f&&this.Tbg(R.GalleryButtons,l,Xa);const lb=this.CFd(fa,R.GalleryButtons,Xa);fa.push.apply(fa,this.O_d(lb,x,R.SectionId,!1,c,l,!0,Xa));wa.push.apply(wa,lb)}b.push(appChrome.actions.setGallerySections(x,F));b.push.apply(b,fa);b.push.apply(b,this.YYd(x,$w[c],wa,null,5===a.Type,!0,null,Xa))}else a.GalleryItems&&0<a.GalleryItems.length&&(c=a.GalleryItems[0].Type),R=f?this.Tbg(a.GalleryItems,l):null,b.push.apply(b,this.O_d(this.CFd(b,a.GalleryItems,
R),x,F,!1,c,l,!1,R))}c$i(a,b){const c=[];let f=null,l=!1;if(!a)return null;const x=this.Goa.Jec(this.NJ,a.commandId,b);c.push(Kt(a.externalUxCommand,!x));if(a.previewControlIds){const fa=[];for(let wa=0;wa<a.previewControlIds.length;wa++){var F={},R=a.previewControlIds[wa];F.SourceControlId=R;const Xa=this.Wm.getCommandByExternalUxId(R);this.KMc(Xa||a,F);F[fm.a.On]&&(f=F.SourceControlId,F[fm.a.HighlightOn]&&(l=!0));CG(R,F,c);if(F=Object(va.a)(Zw.a,F[fm.a.GalleryButtonProps]))fa.push(F),x&&(R=this.Goa.Jec(this.NJ,
F.Command,b),F.IsDisabled=!R)}0<fa.length&&c.push.apply(c,this.O_d(this.CFd(c,fa),a.externalUxCommand,a.externalUxCommand,!0,fa[0].Type));c.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,f));l&&(Z.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",f),c.push(appChrome.actions.highlightSelectedFontStyle(f)))}return c}CFd(a,b,c=null){const f=[],l=[];for(let F=0;F<b.length;F++){const R=b[F],fa=il.a(R.ExternalId)?R.Id:R.ExternalId;f.push(fa);const wa=
c&&c[fa]?c[fa].result:-1;switch(R.Type){case 1:var x=R;l.push(appChrome.api.createCharacterCodeGalleryButtonModel(fa,Object.assign(new uG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,character:x.Character,style:x.Style,title:x.Alt})));break;case 2:x=R;l.push(appChrome.api.createFontStylesGalleryButtonModel(fa,Object.assign(new vG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,styleDisplayName:x.LabelText,style:x.Style,title:x.Alt,previewStyleLabel:x.PreviewStyleLabel})));break;case 3:x=R;l.push(appChrome.api.createInkThicknessGalleryButtonModel(fa,
Object.assign(new yG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,styleDisplayName:x.LabelText,style:x.Style,title:x.Alt})));break;case 4:x=R;l.push(appChrome.api.createIconGalleryButtonModel(fa,Object.assign(new xG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,icon:[x.Icon],fullIconStyle:x.FullIconStyle,previewIconStyle:x.PreviewIconStyle,largePreviewIconStyle:x.LargePreviewIconStyle,label:x.LabelText,title:x.Alt})));break;case 5:x=R;l.push(appChrome.api.createListGalleryButtonModel(fa,Object.assign(new zG,
{disabled:-1!==wa?1>(wa&1):x.IsDisabled,infoAtLevel:x.LevelInfo,ariaLabel:x.Alt})));break;case 6:x=R;l.push(appChrome.api.createTableStyleGalleryButtonModel(fa,Object.assign(new Ky,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,tableCellStyles:x.TableCellStyles,tableStyles:x.TableStyles,title:x.Alt,columns:x.columns})));break;case 8:x=R;l.push(appChrome.api.createChangeColorsGalleryButtonModel(fa,Object.assign(new tG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,tableCellStyles:x.TableCellStyles,tableStyles:x.TableStyles,
title:x.Alt})));break;case 7:x=R,l.push(appChrome.api.createPageNumberGalleryButtonModel(fa,Object.assign(new AG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,text:x.Text,title:x.Alt})))}this.Wm.addCommandToMaps(Object.assign(new Va.a(fa,R.Command),{queryCommandId:R.QueryCommand,menuItemId:R.MenuItemId}))}a.push(appChrome.actions.addControls(l));return f}O_d(a,b,c,f,l,x=null,F=!1,R=null){const fa=[];f?fa.push(appChrome.actions.populateGalleryItems(b,a)):(this.dOb[b]=!1,F||(f=!0,appChrome.selectors.isControlDefined(b)&&
(f=appChrome.selectors.getGalleryState(b),f=f.disableIndividualButtons?f.disableIndividualButtons:!0),fa.push.apply(fa,this.YYd(b,$w[l],a,null,5===l,f,x,R))),fa.push(appChrome.actions.updateGallerySectionItems(b,c,a)));return fa}H3i(a){return this.YYd(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}YYd(a,b,c,f,l,x=!0,F=null,R=null){const fa=[];if(a in this.dOb){if(this.dOb[a])return delete this.dOb[a],fa;this.dOb[a]=!0}let wa=
null,Xa=-1;if(c)({z5f:Xa,returnValue:wa}=this.NAf(b,c,fa,x,F,R));else if(f)for(const lb of f)(c=({z5f:Xa}=this.NAf(b,lb.galleryButtons,fa,x,null,R)).returnValue)&&(wa=c);fa.push(appChrome.actions.updateGallerySelectedId(a,wa));x&&fa.push(Kt(a,!1));l&&0<Xa&&fa.push(appChrome.actions.updateListGalleryTextDirection(a,2===Xa));return fa}Sbg(a,b=null){const c={},f={};f.SourceControlId=a;f.Location=b;a=this.Wm.getCommandByExternalUxId(a);if(!a)return c.result=-1,c.props=f,c;a=this.KMc(a,f);c.result=a;c.props=
f;return c}Tbg(a,b=null,c=null){c||(c={});for(const f of a)a=il.a(f.ExternalId)?f.Id:f.ExternalId,c[a]=this.Sbg(a,b);return c}NAf(a,b,c,f,l=null,x=null){let F,R=null;F=-1;let fa=!1;for(const Xa of b){var wa=this.F3i(a);b=x&&x[Xa]&&-1!==x[Xa].result?x[Xa]:this.Sbg(Xa,l);const lb=b.result;b=b.props;f&&c.push(Kt(Xa,1>(lb&1)));(wa=DG(Xa,wa,b,lb))&&c.push.apply(c,wa);b[fm.a.On]&&(R=Xa,b[fm.a.HighlightOn]&&b[fm.a.HighlightOn]&&(fa=!0));void 0!==b[Am.a.labelText]&&null!==b[Am.a.labelText]&&(wa=this.Wm.getCommandByExternalUxId(Xa),
c.push(appChrome.actions.setControlLabel(wa.externalUxCommand,b[Am.a.labelText])));b[fm.a.IsRtl]&&0>F&&(F=b[fm.a.IsRtl])}fa&&(Z.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",R),c.push(appChrome.actions.highlightSelectedFontStyle(R)));return{returnValue:R,z5f:F}}F3i(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";
case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}KMc(a,b){b.MenuItemId=a.menuItemId;return this.Goa.$9c(this.NJ,this.wlb,a.commandId,a.queryCommandId,b)}}Object(e.a)(EG,"ReactGalleryPoller",null,[]);var xP=d(574),Ny=d(773),yP=d(775);class kB extends Of.a{constructor(){super()}get ControlType(){return 3}}
Object(e.a)(kB,"CompoundButtonProps",Of.a,[]);class FG extends Ow.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.IconName=this.Label=null}get ControlType(){return 12}}Object(e.a)(FG,"ErrorViewProps",Ow.a,[]);var uq=d(772);class GG{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(e.a)(GG,"PopulateFontPickerDataProps",null,[]);var Gr=d(395);class HG extends rq{constructor(){super();
this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(e.a)(HG,"OptionalCompoundButtonProperties",rq,[]);class IG extends rq{constructor(){super();this.onRetryCommandId=this.retryButtonTitle=null}}Object(e.a)(IG,"OptionalErrorViewProperties",rq,[]);class JG extends cv{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(e.a)(JG,"OptionalPersonaButtonProperties",cv,[]);class Oy extends rq{constructor(){super();this.toggled=!1;
this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(e.a)(Oy,"OptionalToggleButtonProperties",rq,[]);var zP=d(912),AP=d(911),Py=d(466);class KG{constructor(){this.OOf=this.actions=null;this.SDh=!1}}Object(e.a)(KG,"PopulateActions",null,[]);class lB{Sdg(a,b){switch(b){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);case "ToggleButtonModel":return this.u$i(a);case "InkButtonModel":return this.t$i(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);
case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}u$i(a){const b={};b[ai.a.On]=appChrome.selectors.getButtonToggleState(a);return b}t$i(a){const b={};b[ai.a.On]=Ag.j("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);return b}}Object(e.a)(lB,"ReactStatePropsSelector",null,[]);class Qy{constructor(a,b,c,f,l){this.Goa=a;this.NJ=b;this.wlb=c;this.Wm=f;this.DCd={};this.ZSh=new lB;this.p1a=l}brh(a){const b=a.populationProps.populateQueryCommandId;
return a.populationProps.populateOnlyOnce&&b in this.DCd}R$i(a,b,c=null){const f=[],l={};if(!this.brh(a)){const x=a.populationProps.populateQueryCommandId,F={};F.MenuId=a.externalUxCommand;F.IsShadowMenuOpen=this.isShadowMenuOpen(c);if(0<(this.Goa.$9c(this.NJ,this.wlb,x,x,F,this.S4i(c))&1))if("FontPickerModel"===b)this.DCd[x]=!0,f.push(Qy.O9i(a,F)),l[a.externalUxCommand]="FontPickerModel";else if(F.MenuItems)switch(this.DCd[x]=!0,b){case "ComboBoxModel":f.push(Qy.M9i(a,F));l[a.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":f.push.apply(f,this.ifg(a.externalUxCommand,b,F.MenuItems,l,c&&"location"in c?c.location:null))}}return Object.assign(new KG,{actions:f,OOf:l,SDh:this.isShadowMenuOpen(c)})}ifg(a,b,c,f,l=null){const x=[],F=[],R=[],fa=[];for(let wa=0;wa<c.MenuSectionList.length;wa++){const Xa=Object(va.a)(Si.a,c.MenuSectionList[wa]);if(!Xa)continue;let lb=null;
const Lb=[];il.b(Xa.Title)||(lb=Xa.Title);for(let kc=0;kc<Xa.ControlList.length;kc++){const lc=Object(va.a)(Ow.a,Xa.ControlList[kc]);if(!lc||lc.ExternalId)f&&this.h_i(lc,f),x.push.apply(x,this.N9i(lc,F,Lb,fa,a,b,l))}c.UpdateDynamically&&R.push(appChrome.api.menuSection(Lb,lb,Xa.Lang))}c.UpdateDynamically&&x.push(appChrome.actions.updateMenu(a,R,c.Title,c.AriaLabel,c.ShouldAutoOpen,c.AriaRoleDescription,c.MenuTargetDescriptor));0<F.length&&x.splice(0,0,appChrome.actions.addControls(F));0<fa.length&&
Ag.d("setStatefulSplitButtonMruBypassControls")&&x.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,fa));return x}h_i(a,b){switch(a.ControlType){case 1:case 3:b[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:b[a.ExternalId]="ToggleButtonModel";break;case 6:b[a.ExternalId]="CheckboxModel";break;case 7:b[a.ExternalId]="ColorPickerModel";a=Object(va.a)(Ny.a,a);a.McuLayout&&(b[a.McuExternalId]="ColorPickerModel");break;case 9:b[a.ExternalId]="FlyoutAnchorModel"}}N9i(a,
b,c,f,l,x,F=null){const R=[];switch(a.ControlType){case 1:case 3:f=Object(va.a)(Of.a,a);this.Rvk(f,R,b,c);f.MenuItemsStatefulData&&Ag.d("setStatefulSplitButtonMenuItemsStatefulData")&&R.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(l,f.MenuItemsStatefulData));break;case 2:this.Owk(Object(va.a)(Py.a,a),R,b,c);break;case 6:this.Wvk(Object(va.a)(xP.a,a),R,b,c);break;case 4:this.Cwk(Object(va.a)(Ys,a),R,b,c);break;case 7:this.Xvk(Object(va.a)(Ny.a,a),R,b,c);break;case 12:this.cwk(Object(va.a)(FG,
a),R,c);break;case 9:l=Object(va.a)(Zm.a,a);this.fwk(l,R,b,c);"StatefulSplitButtonModel"===x&&f.push(l.ExternalId);break;case 8:this.p1a.mwk(Object(va.a)(uq.a,a),R,b,c,F)}return R}Rvk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&b.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&b.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,
a.CommandValueId)),this.fAc()&&((c=this.kra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Up.a(c)).iconSet)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(Fa.a)(kB,a)?c.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,a.Description,Object.assign(new HG,{iconSet:(new Up.a(this.kra(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==
a.Alt?a.Alt:null}))):c.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new cv,{iconSet:(new Up.a(this.kra(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus}))),this.Wm.addCommandToMaps(Object.assign(new Va.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));
a.Lang&&Ag.d("setControlLanguage")&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}Wvk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.fAc()&&((c=this.kra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Up.a(c)).iconSet)),a.IsChecked&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,
a.Alt)))):(c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Oy,{iconSet:(new Up.a(this.kra(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),this.Wm.addCommandToMaps(Object.assign(new Va.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}cwk(a,b,c){c.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?
(a.Label&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.Label)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):appChrome.api.createErrorViewModel(a.ExternalId,a.Label,a.IconName,Object.assign(new IG,{retryButtonTitle:a.RetryButtonTitle,onRetryCommandId:a.OnRetryCommandId}))}Owk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),
this.fAc()&&((c=this.kra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Up.a(c)).iconSet)),u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,
Object.assign(new Oy,{iconSet:(new Up.a(this.kra(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Oy,{iconSet:(new Up.a(this.kra(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),this.Wm.addCommandToMaps(Object.assign(new Va.a(a.ExternalId,a.Command),
{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}Cwk(a,b,c,f){f.push(a.ExternalId);f=this.z9i(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&b.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,f,a.LabelText)):Ag.a("createPersonaButtonModel")&&c.push(appChrome.api.createPersonaButtonModel(a.ExternalId,f,a.LabelText,Object.assign(new JG,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}fwk(a,b,c,f){f.push(a.ExternalId);
if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.fAc()&&((c=this.kra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Up.a(c)).iconSet)),void 0!==a.ImageIsVisible&&null!==a.ImageIsVisible&&b.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.Toggled)));else{f=!(void 0===
a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const l=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;c.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new wy,{iconSet:(new Up.a(this.kra(a))).iconSet,keytip:a.KeyTip,hideIcon:f,toggled:l,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null})));this.Wm.addCommandToMaps(Object.assign(new Va.a(a.ExternalId,a.Command),{queryCommandId:a.QueryCommand,populationProps:new Og(a.PopulateQueryCommand,
a.PopulateOnlyOnce)}))}a.Menu&&b.push.apply(b,this.ifg(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}Xvk(a,b,c,f){a.McuLayout&&f.push(a.McuExternalId);f.push(a.ExternalId);f=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&(f=this.ZSh.Sdg(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(c.push(appChrome.api.createColorPickerModel(a.McuExternalId,a.Width)),this.Wm.addCommandToMaps(Object.assign(new Va.a(a.McuExternalId,
a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),f=a.Width),c.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.Wm.addCommandToMaps(Object.assign(new Va.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));c=[];const l=[];for(let x=0;x<a.Colors.length;x++){const F=a.Colors[x];x<f?c.push(appChrome.api.colorPickerCell(F.Color,F.DisplayColor,F.Alt)):l.push(appChrome.api.colorPickerCell(F.Color,F.DisplayColor,
F.Alt))}0<c.length&&b.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,c));b.push(appChrome.actions.populateColorPickerCells(a.ExternalId,l));a.SelectedColorId&&(0<c.length&&b.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),b.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,a.SelectedColorId)))}kra(a){return a.Image32by32Class?this.Wm.i9f(a.Image32by32Class):a.Image16by16Class?this.Wm.i9f(a.Image16by16Class):a.ExternalImageId}z9i(a){return a?
Object.assign(new AP.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new zP.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}S4i(a){let b=2;a&&"inputMethod"in a&&a.inputMethod&&(b=a.inputMethod);return b}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}fAc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static O9i(a,b){return appChrome.actions.populateFontPickerDataAsync(new Promise((c,
f)=>{hb.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(l=>{l.isFeatureEnabled(Gr.a.ySa,!1).then(x=>{let F=b.fonts;x||l.isFreemiumUpsellEnabled()||(F=Pa.a.pna(F,R=>R.fontType!==Gr.a.jze));x=Object.assign(new GG,{commandId:a.externalUxCommand,fonts:F,isSubscriber:x,mruList:b.mruList,initialPinnedFontKeys:b.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});c(x)}).catch(f)})}))}static M9i(a,b){const c=[];for(let f=0;f<b.MenuItems.MenuSectionList.length;f++){const l=
b.MenuItems.MenuSectionList[f];l.Title&&c.push(appChrome.api.comboBoxHeader("Header-"+f.toString(),l.Title));for(let x=0;x<l.ControlList.length;x++){const F=Object(va.a)(yP.a,l.ControlList[x]);F&&c.push(appChrome.api.comboBoxItem(F.MenuItemId,F.LabelText,F.Styles,F.CommandValueId,F.AriaLabel,F.Data,F.Disabled))}f<b.MenuItems.MenuSectionList.length-1&&c.push(appChrome.api.comboBoxDivider("Divider-"+f.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,c)}}Object(e.a)(Qy,
"ReactPopulateQueryCommandPoller",null,[]);class LG{constructor(a,b,c,f,l){this.Wm=c;this.Goa=a;this.NJ=b;this.wlb=f;this.p1a=l}Q$i(a,b,c){const f=[];if(this.PDj(b))a=this.Edj(a,b,c),void 0!==a&&null!==a&&f.push.apply(f,a);else if(a){var l=this.KMc(a,c);Am.a.visible in c&&f.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!c[Am.a.visible]));f.push(Kt(a.externalUxCommand,1>(l&1)));void 0!==c[Am.a.labelText]&&null!==c[Am.a.labelText]&&f.push(appChrome.actions.setControlLabel(a.externalUxCommand,
c[Am.a.labelText]));void 0!==b&&null!==b&&(l=DG(a.externalUxCommand,b,c,l),void 0!==l&&null!==l&&f.push.apply(f,l),"PeopleWell"===b&&this.B0h(a.externalUxCommand,c,f))}return f}o2i(a,b,c){const f=[];switch(b){case "FlyoutAnchorModel":var l=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var x=appChrome.selectors.getSplitButtonState(a);if(x=this.Wm.getCommandByExternalUxId(x.command))c=this.Goa.Jec(this.NJ,x.commandId,c),f.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,
!c)),f.push(Kt(a,!1));return f;default:return null}b=!1;for(x in l)if(l=this.Wm.getCommandByExternalUxId(x),il.b(l))b=!0;else if(c.SourceControlId=l.externalUxCommand,this.Goa.Jec(this.NJ,l.commandId,c))return f.push(Kt(a,!1)),f;f.push(Kt(a,!b));return f}Edj(a,b,c){switch(b){case "PreviewGalleryModel":return this.p1a.c$i(a,c);case "GalleryModel":return this.p1a.H3i(c)}return null}PDj(a){return"GalleryModel"===a||"PreviewGalleryModel"===a}KMc(a,b){b.MenuItemId=a.menuItemId;return this.Goa.$9c(this.NJ,
this.wlb,a.commandId,a.queryCommandId,b)}B0h(a,b,c){const f=b[Ly.a.LabelTextUserGeneratedPlaceholderReplacements];b=b[Ly.a.LabelText];f&&0<f.length&&(b=String.format.apply(null,[b].concat(f)));c.push(this.wgj(a,b))}wgj(a,b){return appChrome.actions.updatePeopleWell(this.RZi(a),b)}RZi(a){const b=[];var c={};a=this.Wm.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.Goa.$9c(this.NJ,this.wlb,"1285265560",a,c);c=c.MenuItems;if(!c)return b;c=c.MenuSectionList[0];for(a=0;a<c.ControlList.length;a++){const f=
c.ControlList[a],l={};l.name=f.Alt;l.id=f.MenuItemId;l.description=f.Description;l.color=f.ImageBackColor;l.joinTime=f.JoinTimeInMS;l.imageUrl=f.ImageUrl;l.activeStatus=f.ActiveStatus;l.isAnonymous=f.IsAnonymous;l.canJump=f.CanJump;l.upn=f.Upn;b.push(l)}return b}}Object(e.a)(LG,"ReactQueryCommandPoller",null,[]);class MG{$9c(a,b,c,f,l,x){let F=0;a&&(this.Jec(a,c,l)&&(F|=1),c=new iB,c.CommandLocation=b,void 0!==x&&null!==x&&(c.InvocationMethod=x),!il.b(f)&&a.A0f(f,l,c)&&(F|=2));return F}Jec(a,b,c=
null){return a?a.z4b(b,c):!1}}Object(e.a)(MG,"RootPoller",null,[]);class NG{constructor(a,b,c){this.Wm=a;this.NJ=b;a=new MG;this.IVh=new lB;this.p1a=new EG(a,this.NJ,c,this.Wm);this.Dqf=new Qy(a,this.NJ,c,this.Wm,this.p1a);this.xqf=new LG(a,this.NJ,this.Wm,c,this.p1a)}iQa(){const a=[];if(!Ag.c())return a;a.push.apply(a,this.ugj());var b=this.E1i();if(0<b.length)a.push.apply(a,b);else if(b=appChrome.selectors.getActiveControlIds(),Object.keys(b).length){const c=this.F1i();for(const f of c)a.push(appChrome.actions.updateControlEnabledDisabledState(f,
!0)),delete b[f];a.push.apply(a,this.KNc(b))}return a}Lec(a,b){Ag.c()&&(a=this.KNc(a,b),appChrome.api.dispatch(a))}wye(a,b,c=null){if(!il.b(a)&&a.populationProps&&!this.Dqf.brh(a)){a=this.Dqf.R$i(a,b,c);if(!a.SDh){let f;(f=a.actions).push.apply(f,this.KNc(a.OOf,Ag.g(c)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}KNc(a,b=0){const c=[],f={};if(Ag.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&
""!==appChrome.selectors.getSelectedTabId())for(var l of appChrome.selectors.getActiveGroupIds())for(var x of appChrome.selectors.getVisibleControlsInGroup(l))f[x]=!0;for(let F in a)l=F,x=a[F],0===b&&f[l]&&(b=2),c.push.apply(c,this.tgj(l,x,b));return c}tgj(a,b,c=0){const f=[],l=this.Wm.getCommandByExternalUxId(a);let x={};appChrome.selectors.isControlDefined(a)&&(x=this.IVh.Sdg(a,b));x[Dn.a.szh]=c;il.b(l)?(x.ExternalUxId=a,(a=this.xqf.o2i(a,b,x))&&0<a.length&&f.push.apply(f,a)):(x.MenuItemId=l.menuItemId,
x.SourceControlId=a);f.push.apply(f,this.xqf.Q$i(l,b,x));return f}ugj(){const a=[],b=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),c=appChrome.selectors.getContextualTabIds();let f=[];b&&(f=appChrome.selectors.getActiveContextualTabIds());for(let x=0;x<c.length;x++){var l=this.Wm.i1d(c[x]);if(l){l=this.NJ.z4b(l);let F=!0;b&&(F=0<=
Array.indexOf(f,c[x]));b&&F===l||a.push(appChrome.actions.activateDeactivateContextualTab(c[x],l))}}return a}E1i(){var a=appChrome.selectors.getSelectedTabId();const b=[],c=this.Wm.i1d(a);c&&(this.NJ.z4b(c)||b.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return b}F1i(){var a=appChrome.selectors.getActiveGroupIds();const b=[];for(const c of a)if(a=this.Wm.S3i(c))for(const f of a)this.NJ.z4b(f.commandId)||((a=f.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(f.externalUxGroupId)),
b.push.apply(b,a));return b}}Object(e.a)(NG,"ReactRibbonRootPoller",null,[1498]);class ax{constructor(a,b,c=null){this.NJ=this.oOb=this.WLa=null;this.WSh=b;a.Hmb(this);this.S9=c}get TUc(){this.oOb||(this.oOb=new Date,this.oOb.setTime(0));return this.oOb}set TUc(a){this.oOb=a}get HVk(){return 2}get S9(){return this.NJ}set S9(a){this.NJ=a}get cEb(){this.WLa||(this.WLa=new NG(this.WSh,this.S9,this.HVk));return this.WLa}MDc(){const a=document.activeElement;Ba.a.isEditable(a)&&a.blur()}executeCommand(a,
b,c,f,l,x,F,R=2){il.b(this.S9)||(l=new iB,l.CommandLocation=R,l.InvocationMethod=f,l.CommandTabName=c,b[Dn.a.szh]=R,this.S9.A0f(a,b,l,x,F),this.jVj(a,b))}iQa(){return il.b(this.S9)?[]:this.cEb.iQa()}Kec(){const a=this.iQa();0<a.length&&(this.TUc=new Date,appChrome.api.dispatch(a))}rJb(){Ag.c()&&this.cEb.Lec({PeopleWell:"PeopleWell"},18)}jVj(a,b){try{const c=hb.a.instance.pb("Common.ISystemInitiatedFeedback");if(c&&b){const f=b.SourceControlId||b.launcherId||b.LegacyId||b.NewContextId;let l=(f?"_"+
f:"")+(b.SqmControlId?"_"+b.SqmControlId:"");l=l.length?l:"_"+a;c.Zbe("Ribbon"+l)}}catch(c){Z.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(c?c.toString():""))}}}Object(e.a)(ax,"ReactRibbonRoot",null,[1486,1499]);class mB{constructor(){this.Hoa=[]}Hmb(a){a&&!Array.contains(this.Hoa,a)&&Array.add(this.Hoa,a)}qch(a){Array.remove(this.Hoa,a)}MDc(){for(const a of this.Hoa)a.MDc()}dispose(){this.Hoa=null}}Object(e.a)(mB,"RootManagerBase",null,[316,106]);class Hr extends mB{constructor(){super()}static get instance(){return Hr.Ja||
Hr.fyj()}static fyj(){Hr.Ja=new Hr;return Hr.Ja}}Hr.Ja=null;Object(e.a)(Hr,"ReactRootManager",mB,[315,316]);class vp{constructor(a,b,c,f,l,x,F,R=null,fa=!0,wa=null,Xa=null){this.uMb=this.cyc=this.Ppd=this.TO=null;this.Utf=[];this.iwc=null;this.x1a=a;this.hxd=b;this.vlb=c;this.Hd=f;this.Ca=l;this.Wm=x;this.TO=wa?wa:new ax(Hr.instance,this.Wm);this.w0a=F;this.lsf=new rG;this.dMa=R;this.MBd=fa;new nG;this.Q1e=Xa;pd.a.get_instance().Xj(7,Object(D.a)(this,this.C4k,"setRibbonPostInteractiveReady"));pd.a.get_instance().Xj(7,
Object(D.a)(this,this.sXj,"logRibbonLoadedActivity"));pd.a.get_instance().Xj(19,Object(D.a)(this,this.YUj,"logAppLoadedActivity"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&pd.a.get_instance().Xj(7,Object(D.a)(this,this.mMk,"registerSubComponentReporting"));pd.a.get_instance().Xj(7,Object(D.a)(this,this.MDk,"queueSettingsDependentActions"))}initialize(a,b,c=null){this.MBd||this.gJ(5);c?c.then(()=>{this.Tdh()}).catch(()=>Z.ULS.sendTraceTag(561394319,
340,10,"Failed to load the resources for the Ribbon")):mG.a.Zvh(mG.a.Zvh(io.Task.WAA(this.iAg(a),this.hAg(vp.WIh)),()=>this.hAg(vp.eHh)),()=>this.iAg(b)).continueWith(()=>{this.Tdh()},11)}dispose(){this.xrl();this.iwc&&this.iwc.dispose();for(const a of this.Utf)pd.a.get_instance().smi(a);u.AFrameworkApplication.Ta.eO(G.a.CSk,de.a.frame,ce.ActionManager.Fg)}hAg(a){return hb.a.instance.resolve("Common.ISharedDependencyLoader").hwb(u.AFrameworkApplication.Fk(a,2))}iAg(a){return""===a?io.Task.wt(!0):
hb.a.instance.resolve("Common.ISharedDependencyLoader").hwb(u.AFrameworkApplication.Fk(a,3))}emg(){(this.dMa||this.w0a)&&appChrome.api.dispatch(this.efg());this.pJe();Ag.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(u.AFrameworkApplication.Hea);this.TO.Kec()}Tdh(){this.emg();this.MBd&&(appChrome.renderAppChrome(this.x1a,Ag.e()),this.gJ(10));this.hAf();this.sBc();this.MBd&&this.gJ(5);this.fQc()}fQc(){this.Hd&&this.Ca&&this.vlb&&(this.iwc=new sG(this.Hd,this.Ca,this.x1a,this.vlb),this.iwc.initialize())}get sVk(){return this.lsf}setCommandDefinitionMapping(){if(Ag.a("setCommandDefinitionMapping")){const a=
tP(this.Wm);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Q7&&Ag.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{0===b&&this.fDb()})}hAf(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(va.a)(ax,this.TO);this.Ppd=new qG(this.TO,a.cEb,this.Wm,this.Hd,this.hxd,hb.a.instance.pb("Common.IRibbonSQMInformation"),hb.a.instance.pb("Common.IFileMenuSQMInformation"),
u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,hb.a.instance.La("Common.ISystemInitiatedFeedback"),null);this.Kbi();this.Ojj()}Kbi(){this.cyc=appChrome.api.bindCommandHandler((a,b)=>{this.Ppd.executeCommand(a,b)})}xrl(){this.cyc&&(this.cyc(),this.cyc=null)}pJe(){appChrome.api.initializeLogger(new uP.a)}iQa(){return this.TO?this.TO.iQa():[]}fDb(){nc.a.instance.wF(()=>{let a=null;nc.a.instance.wF(()=>{a=this.iQa()},"RB:GA");a&&0<a.length&&(this.TO.TUc=new Date,nc.a.instance.wF(()=>{appChrome.api.dispatch(a)},
"RB:DA"));this.uMb&&nc.a.instance.wF(()=>{},"RB:J")},"RB:PFSU")}rJb(){this.TO.rJb()}NYh(a){a=[appChrome.actions.activateDeactivateContextualTab(a,!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}efg(){var a=u.AFrameworkApplication.fa;const b=[];a.ka("EnableTellMeForOneLineRibbonIsEnabled")?a.ka("OcpsIsEnabled")&&hb.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(c=>
{c.isFeatureEnabled("ConnectedServices",!0).then(f=>{f&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):b.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));b.push.apply(b,this.m9f());a=new kG.a(this.Wm);this.dMa.l$&&(up.Vol(this.dMa.l$),b.push.apply(b,a.PWd(this.dMa.l$)));if(this.dMa.Fxh)for(const c of this.dMa.Fxh)b.push(appChrome.actions.updateGallerySectionHiddenState(c.uVi,c.yF,c.Xol));b.push.apply(b,a.SWi(this.dMa.Wol));
return b}m9f(){const a=[];if(this.w0a&&this.w0a.l$){const c=this.w0a.l$;for(let f in c){var b=c[f];const l=this.Wm.uYd(f);if(l)for(let x of l)a.push(appChrome.actions.updateControlHiddenState(x,b))}}return a}jJb(a){a&&this.TO.cEb.Lec(a,0)}wye(a){this.TO.cEb.wye(this.Wm.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}xal(a){pd.a.get_instance().Xj(5,null).continueWith(()=>{appChrome.api.dispatch(this.Fcj(a))})}IGi(){const a=u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled")?
"ShareMenu":"Share",b=u.AFrameworkApplication.fa.appSettings;b&&appChrome.api.dispatch(this.kwl(a,"Shared"===(b.SharingStatus||"")))}MDk(){u.AFrameworkApplication.fa.ff(()=>{this.IGi()})}kwl(a,b){return appChrome.actions.updateSharingStatusIndicator(a,b)}Fcj(a){return appChrome.actions.updateControlHiddenState(a,!1)}Gcj(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}gJ(a){pd.a.get_instance().gJ(a);this.Utf.push(a)}C4k(){Ag.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new lG,
{postRibbonInteractiveReady:!0})))}sBc(){this.w0a&&this.Q1e&&(this.uMb=this.Q1e.createFileMenu(this.w0a,this.TO.S9),this.lsf.fileMenu=this.uMb)}MRj(){this.uMb&&this.uMb.IRj()}Fdd(a,b,c){if(1===c)return 32;this.Bjc(!0);this.fDb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}Gdd(a,b,c){if(1===c)return 32;this.Bjc(!1);this.H4k();this.fDb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}H4k(){Hi.a.JL(u.AFrameworkApplication.fa.Ha("IsSimplifiedRibbonOnCookieName"),"true",Hi.a.rL)}Bjc(a){Hi.a.JL(u.AFrameworkApplication.fa.Ha("ReactRibbonMLRPreferenceCookieName"),
a.toString(),Hi.a.rL)}sXj(){if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.uo){const a=hb.a.instance.La("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(b=>{b.logActivity("SingleRibbonModeActivity",null)}),u.AFrameworkApplication.mN("d79fg304;61jba833")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(b=>{b.logActivity("MultiRibbonModeActivity",null)}),u.AFrameworkApplication.mN("69a7h198;dfd7j584"))}}YUj(){const a=Hi.a.yBa(u.AFrameworkApplication.fa.Ha("VNextStyleOptOutCookieName"),
!1);window.setTimeout(()=>{const b=hb.a.instance.La("Common.ISystemInitiatedFeedback");b&&(u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?(b.execute(c=>{c.logActivity("VNextStylesOn",null)}),b.execute(c=>{c.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):u.AFrameworkApplication.fa.ka("Fluent2StyleFGOnlyIsEnabled")&&a&&b.execute(c=>{c.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}mMk(){pd.a.get_instance().Xj(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",
!1)});const a=appChrome.api.getRibbonSubComponentMappings();for(let c in a){var b=c;const f=a[c];if(f)for(const l of f)u.AFrameworkApplication.Ta.iS(l)?appChrome.api.reportRibbonSubComponentBehaviorMapped(b):u.AFrameworkApplication.Ta.x3k(l,this.Oyi(b));else appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}Oyi(a){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}Ojj(){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&Ag.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&u.AFrameworkApplication.aDb.ZEd){const a=u.AFrameworkApplication.aDb.ZEd,b=u.AFrameworkApplication.aDb.Szf;b.payload||(b.payload={});const c=b.payload.launcherId?b.payload.launcherId:a;vp.Hdd.Jb(c)?vp.Hdd.ga(c)():"StatefulSplitButtonModel"===b.modelType?appChrome.PRIToastManager.dismissToast():(b.payload.PRIReadinessCheck=!0,this.Ppd.executeCommand(a,b))}}}vp.WIh="common";vp.eHh=
"appChrome";vp.Hdd=new sP.a(fB.a.Kfg());Object(e.a)(vp,"ReactRibbonUser",null,[308,313,106]);class nB{constructor(){this.label=this.value=null}}Object(e.a)(nB,"TextInfoSectionField",null,[]);class OG{constructor(a,b){this.l$=b}}Object(e.a)(OG,"ReactRibbonJewelProperties",null,[]);class oB extends vp{constructor(a,b,c,f,l,x,F,R,fa=null,wa=!0,Xa=null,lb=null){super(a,b,f,l,x,F,R,fa,wa,Xa,lb);this.Frc=null;this.Grc=c;this.Grc.execute(Lb=>{this.Frc=Lb});this.Grc.execute(Lb=>{this.TO.S9=Lb})}iQa(){return this.Frc?
(this.Frc.clearCache(),super.iQa()):[]}}Object(e.a)(oB,"ReactRibbonUser",vp,[]);var pB=d(874),Ry=d(241),qB=d(365),PG=d(698),rB=d(1076);class bx{static get sxg(){return"teams"===(u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.oJ)||"").toLowerCase()}static get hoh(){return bx.sxg?(ya.a.J(576030427,811,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.qPa,u.AFrameworkApplication.ppb),u.AFrameworkApplication.qPa&&u.AFrameworkApplication.ppb):u.AFrameworkApplication.qPa}}
Object(e.a)(bx,"CopyLinkHelper",null,[]);class QG{constructor(a,b){this.uqe=null;this.la=a;this.T7j=b}dispose(){this.uqe&&(ym.CuiHelper.kHi(this.uqe),this.uqe=null)}Tfj(){if(u.AFrameworkApplication.workflowEnabled){let a="";switch(u.AFrameworkApplication.$nc){case "Assign":a=CommonUIStrings.l_Assign;break;case "Submit":a=CommonUIStrings.l_Submit}if(a.length)return Object.assign(new rB.a,{command:"2988588587",label:a,id:"btnWorkflow"})}return u.AFrameworkApplication.o$d&&u.AFrameworkApplication.cXa||
u.AFrameworkApplication.znc?Object.assign(new rB.a,{command:"1197060601",label:ResourceStrings.L_ReplyWithChanges,id:ym.CuiHelper.Vcd}):u.AFrameworkApplication.qPa?Object.assign(new rB.a,{command:"981334692",label:ResourceStrings.L_Share,image:ym.CuiHelper.Q7k,id:ym.CuiHelper.ZJe}):null}q$k(){if(bx.sxg&&!this.T7j)return!1;const a=this.Tfj();return a&&"981334692"===a.command?this.la.Ovg||this.la.WKj:!1}u$k(){ya.a.J(512496021,820,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.qPa,
u.AFrameworkApplication.ppb);return u.AFrameworkApplication.qPa&&(u.AFrameworkApplication.ppb||u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled"))}}Object(e.a)(QG,"CuiControlUser",null,[106]);class RG extends oB{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd){super(b,a.Dha,f,Nc.a.mea,l,x,F,null,wa,!0,null,Lb);this.FDg=this.o6b=this.SCg=this.txb=this.tm=this.fFa=this.la=this.gh=this.dTa=this.h2c=this.Xee=this.lje=null;this.kJg=!1;this.M6=0;this.dke=this.XZc=this.B8=!1;this.nu=this.e1c=
this.Rab=null;b=new qB.a("ReactRibbonUser::InitPptReactRibbon",!1);try{this.fFa=lb,this.la=Xa,this.Xee=new QG(this.la,Ec.ka("ShareMenuIsEnabled")),this.lje=a,this.h2c=fa,this.txb=F,this.dTa=R||new PG.a,this.gh=this.dTa.aPd(2,"ReactRibbonUser"),this.M6=0,this.SCg=wa.l$,this.B8=!!window.performance&&!!window.performance.now,this.tm=kc,this.XZc=lc,this.Rab=Ec,this.dke=Jc,this.e1c=Dc,this.nu=Wd,this.aRk(),pd.a.get_instance().Xj(10,Object(D.a)(this,this.oxj,"initializeFullPptRibbon"),11),pd.a.get_instance().Xj(10,
Object(D.a)(this,this.createHeader,"createHeader"),3)}finally{b&&b.dispose()}}dmg(){og.a.instance.ic("InitRibbon",(new Date).getTime());ya.a.J(512496020,801,50,"Initialize SLR Iteration: {0}; IsReactMLRRendered: {1}",this.la.zyk?"2":"1",this.la.Mma);this.la.podsRibbonEarlyRendererExposureControl&&!this.la.VUf?PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(Object(D.a)(this,this.cxj,"initializeEarlyRenderedPptRibbon")):(og.a.instance.ic("RenderRibbonStart",
Date.now()),this.r6i(Ry.a(hb.a.instance)).catch(()=>{ya.a.J(512496019,801,10,"Failed to load the resources for the Ribbon.")}).then(()=>{og.a.instance.ic("AppChromeReadyTime",Date.now());appChrome.setScriptLoader(Ry.a(hb.a.instance));this.la.xKk&&Ag.a("setCookieWithExpirationCallback")&&Ag.a("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((a,b)=>Hi.a.JL(a,b,Hi.a.rL)),appChrome.api.setGetCookieValueCallback(a=>Hi.a.get(a)));appChrome.setAppSettings(u.AFrameworkApplication.fa.appSettings);
if(this.la.ka("DynamicBundlesIsEnabled")){const a=u.AFrameworkApplication.Hea+"exp/";appResourceLoader.init(pP.a.resolveScript,a);appChrome.api.setWebpackPublicPath(a)}PowerPointWebEditor.AppChromeSettingsLoadedHandler.OnAppChromeSettingsLoaded();this.pJe();ee.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?appChrome.initializeRibbonStore(this.la.Mma):appChrome.initializeRibbonStore();this.emg();this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PerceivedRibbonInteractiveIsEnabled",
!1)&&1!==u.AFrameworkApplication.Aa.mode&&(this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)?this.fbh():this.S5d());this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.fFa&&this.fFa.gRk();appChrome.renderAppChrome(this.x1a,Ag.e());this.la.fBb&&ee.a("ModernRibbonShimmerCGEnabled")&&PowerPointWebEditor.MinimalBoot.SetRealRibbon("ContentEditable");pd.a.get_instance().gJ(5);pd.a.get_instance().gJ(10);
ee.a("React.SetRibbonBehaviorAttached")&&pd.a.get_instance().gJ(6);this.jBg();og.a.instance.ic("Stage1Ribbon",pB.a.uUd&&void 0!==PowerPointWebEditor.FakeRibbon.ShowTime&&null!==PowerPointWebEditor.FakeRibbon.ShowTime?PowerPointWebEditor.FakeRibbon.ShowTime:(new Date).getTime())}))}fbh(){pd.a.get_instance().Xj(4,()=>{pd.a.get_instance().isCompleted(7)||this.S5d()})}r6i(a){return ee.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?this.la.hHk?a(this.la.Mma?"powerpoint-ribbon-mlr-intl":"powerpoint-ribbon-intl").catch(()=>
{}).then(()=>a("appChrome")):this.la.Mma?a("powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("powerpoint-ribbon-mlr-intl")).catch(()=>{}).then(()=>a("appChrome")):a("powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):a("appChrome")}cxj(){void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&og.a.instance.ic("RenderRibbonStart",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime);void 0!==
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&og.a.instance.ic("AppChromeReadyTime",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&og.a.instance.ic("Stage1Ribbon",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive?
(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive(),this.S5d()):this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)&&this.fbh();PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData&&this.e1c.Tjh(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand,PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData);
void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime?og.a.instance.ic("AppInitStatus_ribbonSkeletonDismissed",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime):this.jBg();for(const a of PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache)4===a.length&&Z.ULS.sendTraceTag(a[0],a[1],a[2],a[3]);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache.length=0;this.pJe();
pd.a.get_instance().gJ(5);pd.a.get_instance().gJ(10);ee.a("React.SetRibbonBehaviorAttached")&&pd.a.get_instance().gJ(6);qu.a.dispatch("RibbonVisible")}oxj(){og.a.instance.ic("InitFullRibbon",(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{og.a.instance.ic("RibbonLazyPromiseFulfilled",(new Date).getTime());u.AFrameworkApplication.fa.ff(()=>{this.Xee.u$k()?pd.a.get_instance().Xj(7,()=>{ya.a.J(512496018,801,50,"Render CopyLink button on Teams session after the full app settings and Chrome ready!");
appChrome.api.dispatch(this.Gcj())}):pd.a.get_instance().Xj(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl("CopyLink"))})});this.dMa&&a.push.apply(a,this.efg());if(u.AFrameworkApplication.Aa.gb.Q7){const b=[];b.push(document.getElementById("WACDocumentPanel"));a.push(appChrome.actions.setShyState(Object.assign(new qP.a,{shyDismissalRegions:b})))}appChrome.api.dispatch(a);this.rMk();this.Grc.execute(b=>{if(void 0===this.TO.S9||null===this.TO.S9)this.TO.S9=b;this.hAf()});this.XJk();
this.sBc();this.createFileMenu();this.fFa&&(a=this.fFa.initialize(),ya.a.J(512496017,801,50,"Doc Mode Switcher Initialize response: "+a.toString()));this.fQc();pd.a.get_instance().gJ(7);og.a.instance.ic("Stage3Ribbon",(new Date).getTime());this.B8&&og.a.instance.ic("RibbonInteractivePerfMark",window.performance.now());this.tXj();this.xNk();this.pxj();Ba.a.OH(this.lje.kG(),"ScrollableRibbon");return null})}tXj(){if(og.a.instance.o7a)ya.a.J(512496016,813,15,"Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");
else{var a={};og.a.instance.Wn("Stage1Ribbon")&&(a.RibbonDisplayed=og.a.instance.Rg("Stage1Ribbon"));og.a.instance.Wn("Stage3Ribbon")&&(a.RibbonInteractive=og.a.instance.Rg("Stage3Ribbon"));og.a.instance.Wn("InitRibbon")&&(a.InitRibbon=og.a.instance.Rg("InitRibbon"));og.a.instance.Wn("InitFullRibbon")&&(a.InitFullRibbon=og.a.instance.Rg("InitFullRibbon"));og.a.instance.Wn("RibbonLazyPromiseFulfilled")&&(a.RibbonLazyPromiseFulfilled=og.a.instance.Rg("RibbonLazyPromiseFulfilled"));og.a.instance.Wn("RenderRibbonStart")&&
(a.RenderRibbonStart=og.a.instance.Rg("RenderRibbonStart"));og.a.instance.Wn("AppChromeReadyTime")&&(a.AppChromeReadyTime=og.a.instance.Rg("AppChromeReadyTime"));og.a.instance.Wn("AppInitStatus_ribbonSkeletonDismissed")&&(a.RibbonSkeletonDismissed=og.a.instance.Rg("AppInitStatus_ribbonSkeletonDismissed"));ya.a.J(512496015,809,50,"Ribbon Perf metrics: "+xa.a.toJSON(a))}}EWj(){if(og.a.instance.o7a)ya.a.J(512496014,813,15,"Lazy Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");
else{var a={};og.a.instance.Wn("Stage2Ribbon")&&(a.RibbonEnabled=og.a.instance.Rg("Stage2Ribbon"));og.a.instance.Wn("Stage4Ribbon")&&(a.RibbonFull=og.a.instance.Rg("Stage4Ribbon"));ya.a.J(512496013,809,50,"Lazy Ribbon Perf metrics: "+xa.a.toJSON(a))}}pxj(){appChrome.getExtRibbonInitializationActions().then(a=>{appChrome.api.dispatch(a);og.a.instance.ic("Stage4Ribbon",(new Date).getTime());this.EWj();return null})}fDb(){this.Frc&&pd.a.get_instance().isCompleted(7)&&(N.a.mark(4893),super.fDb(),N.a.mark(4894),
this.kJg||(og.a.instance.ic("Stage2RibbonStart",Date.now()),appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0)),og.a.instance.ic("Stage2Ribbon",Date.now()),this.kJg=!0))}uF(){this.fDb()}selectRibbonTabById(a){this.NYh(a)}get Xih(){return appChrome.selectors.getSelectedTabId()}DGi(){appChrome.getHeaderApi().then(a=>a.dismissPlaceholder())}createHeader(){const a=(new Date).getTime();u.AFrameworkApplication.fa.ff(()=>{if(!ee.a("PPTOHideLegacySharedHeaderBugFix")||!u.AFrameworkApplication.LP){var b=
(new Date).getTime(),c=this.gh.Zt("createHeader"),f=u.AFrameworkApplication.Aa.gb.iN,l=document.getElementById("HeaderPlaceholder"),x=(new iG(qf.a.eJi,this.lje)).jMi();if(f)try{ya.a.J(512496012,801,50,"Shared Header - Calling RenderSharedHeader");const F=new fG;appChrome.renderSharedHeader(x,F.q$i()).then(()=>{this.SUj(b,a);l&&this.DGi()})}catch(F){ya.a.J(512496011,801,10,"Exception while trying to render shared header {0}",F)}else throw ya.a.J(512496010,801,10,"Invalid request to render legacy Shared Header."),
Error.invalidOperation("Invalid request to render legacy Shared Header");u.AFrameworkApplication.LP||(x=Fr.a.G5d(I.AppFrame.ZQa,null,x,!0),f&&(x.IK=!0,this.eEb(x,G.a.Aic,G.a.zic),x.bindAction(A.KeyInputManager.Na(w.a.B0,0),G.a.Ddd)));!l&&pB.a.T1f&&PowerPointWebEditor.FakeHeader.RemoveFakeHeader();this.gh.gu(c);this.M6|=1;this.Umc()}})}SUj(a,b){var c=(new Date).getTime();const f={};f.headerCallbackRegistrationTime=b;f.headerCallbackInvokedTime=a;f.headerRenderCompleteTime=c;ya.a.J(512496009,809,50,
"Create Header Perf metrics: "+xa.a.toJSON(f))}eEb(a,b,c){const f=A.KeyInputManager.Na(w.a.Bq,0),l=A.KeyInputManager.Na(w.a.Bq,4);a.$o(f);a.$o(l);a.bindAction(f,b);a.bindAction(l,c)}sBc(){const a=()=>{const b=this.gh.Zt("createJewel");this.w0a=this.Zxj();vp.prototype.sBc.call(this);this.gh.gu(b);this.M6|=2;this.Umc()};this.XZc&&this.Rab?this.Rab.Ztb(a):u.AFrameworkApplication.fa.ff(a)}createFileMenu(){const a=(new Date).getTime(),b=()=>{const c=(new Date).getTime(),f=this.gh.Zt("createFileMenu"),
l=[];if(this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var x=[Object.assign(new nB,{label:CommonUIStrings.L_DiagnosticsSessionId,value:u.AFrameworkApplication.userSessionId}),Object.assign(new nB,{label:CommonUIStrings.L_DiagnosticsBuild,value:u.AFrameworkApplication.buildVersion})];l.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",x))}l.push.apply(l,this.m9f());x=document.createElement("div");document.body.appendChild(x);appChrome.renderFileMenu(x,l);this.RUj(c,a);this.gh.gu(f);
this.M6|=22;this.Umc()};this.XZc&&this.Rab?this.Rab.Ztb(b):u.AFrameworkApplication.fa.ff(b)}RUj(a,b){var c=(new Date).getTime();const f={};f.fileMenuCallbackRegistrationTime=b;f.fileMenuCallbackInvokedTime=a;f.fileMenuRenderCompleteTime=c;ya.a.J(512496008,809,50,"File Menu Perf metrics: "+xa.a.toJSON(f))}XJk(){const a=()=>{const b=this.gh.Zt("refreshRibbon");this.o6b||(this.o6b={},up.Bxh(this.o6b),this.h2c.rCh(this.o6b),this.FDg=this.gZi(this.SCg,this.o6b));const c=new kG.a(this.txb);appChrome.api.dispatch(c.PWd(this.FDg));
this.gh.gu(b);this.M6|=4;this.Umc()};this.XZc&&this.Rab?this.Rab.Ztb(a):u.AFrameworkApplication.fa.ff(a)}gZi(a,b){const c={};for(let l in b){var f=b[l];const x=l;f!==a[x]&&(c[x]=f,ya.a.J(512496007,801,50,"TrimedId changed after full settings ready, TrimId:{0} PreviousValue:{1} CurrentValue:{2}",x,a[x],f))}return c}Zxj(){const a={};this.h2c.N2k(a);this.h2c.rCh(a);return new OG(null,a,"jewelPPTEditor")}xNk(){pB.a.uUd&&PowerPointWebEditor.FakeRibbon.RemoveFakeRibbon()}wch(a){pd.a.get_instance().Xj(7,
()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl(a))})}aRk(){const a=this.la.ka("ShareMenuIsEnabled"),b=a?"ShareTopBar":"Share";u.AFrameworkApplication.ppb?this.wch(b):u.AFrameworkApplication.fa.ff(()=>{const c=this.gh.Zt("createShareAction"),f=this.Xee.q$k();f?this.xal(b):(this.wch(b),this.la.Qeb&&this.tm.y9(this.tm.F4,this.tm.wgd));a&&(f?this.la.Qeb&&pd.a.get_instance().Xj(7,()=>{this.tm.Qua(this.tm.F4,this.tm.wgd);this.tm.Pua(this.tm.F4,this.tm.wgd)}):pd.a.get_instance().Xj(7,
()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShareMenu",!f))}));this.gh.gu(c);this.M6|=8;this.Umc()})}Umc(){31===this.M6&&(this.dTa.IVc(2),this.M6=0)}S5d(){this.e1c.Jbi();appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0));pd.a.get_instance().Xj(7,()=>{this.e1c.wrl();Ag.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&this.dke||appChrome.PRIToastManager.dismissToast()},11)}jBg(){pd.a.get_instance().gJ(18);
qu.a.dispatch("RibbonVisible")}vRg(){return()=>{this.nu.Gzc(()=>{appChrome.PRIToastManager.dismissToast()})}}rMk(){this.dke&&(vp.Hdd.$("NewDefaultSlide",this.vRg()),vp.Hdd.$("ChangeLayoutFlyout",this.vRg()))}}Object(e.a)(RG,"ReactRibbonUser",oB,[1193,313,106]);class SG{constructor(a,b,c,f,l,x,F){this.Ayb=null;this.yb=a;this.SLg=b;this.ra=c;this.FD=f;this.vN=l;this.ia=x;this.vp=F;this.SLg.xk(Object(D.a)(this,this.kgh,"ribbonChangeTabHandler"))}dispose(){this.SLg.Tm(Object(D.a)(this,this.kgh,"ribbonChangeTabHandler"))}get pI(){return this.Ayb}set pI(a){this.Ayb!==
a&&a&&(this.Ayb=a,this.vN.AZ?this.vN.AZ=!1:this.vp&&this.vN.mSa&&this.ia.processAction(C.a.Tha,2))}kgh(a,b){b.node.Sa(ub.a.shapeId)&&(a=b.node.getValue(ub.a.shapeId),this.Ayb&&this.Ayb.id===b.node.id&&a&&(this.yb.Gb(new He.a(2,1,0,()=>{const c=this.ra.obj(this.FD.Xih,b.node);0<c.length&&this.FD.selectRibbonTabById(c)},90,"10")),this.Ayb=null))}}Object(e.a)(SG,"RibbonChangeManager",null,[1195]);class TG{constructor(a,b,c){this.uVi=a;this.yF=b;this.Xol=c}}Object(e.a)(TG,"GallerySectionData",null,[]);
let sB,tB,Sy,uB,cx,vB,wB,xB,yB;class fv{constructor(a,b,c,f,l,x){this.la=a;this.O0c=b;this.g0c=c;this.JMg=f;this.vxb=l;this.tm=x}egd(a){this.la.Eug&&(a["PptRibbon.Home.Drawing.TextBox"]=!0,a["PptRibbon.Home.Drawing.Rectangle"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangle"]=!0,a["PptRibbon.Home.Drawing.Ellipse"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangleCallout"]=!0,a["PptRibbon.Home.Drawing.Star5"]=!0,a["PptRibbon.Home.Drawing.Triangle"]=!0,a["PptRibbon.Home.Drawing.Can"]=!0,a["PptRibbon.Home.Drawing.Cube"]=
!0,a["PptRibbon.Home.Drawing.StraightConnector"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorArrow"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorTwoArrow"]=!0,a["PptRibbon.Home.Drawing.RightArrow"]=!0,a["PptRibbon.Home.Drawing.DownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftArrow"]=!0,a["PptRibbon.Home.Drawing.UpArrow"]=!0,a["PptRibbon.Home.Drawing.UpDownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftRightArrow"]=!0,a["PptRibbon.Home.Drawing.MoreShapes"]=!0,a["PptRibbon.Home.Font.ChangeCase"]=!this.la.Hji,
a["PptRibbon.InsertTab.Illustrations.TextBox"]=!0,a["PptRibbon.InsertTab.Illustrations.Rectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Ellipse"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangleCallout"]=!0,a["PptRibbon.InsertTab.Illustrations.Star5"]=!0,a["PptRibbon.InsertTab.Illustrations.Triangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Can"]=!0,a["PptRibbon.InsertTab.Illustrations.Cube"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnector"]=
!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorTwoArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.RightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.DownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpDownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftRightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.MoreShapes"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBox"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Rectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Ellipse"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangleCallout"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Star5"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Triangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Can"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Cube"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnector"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorTwoArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.DownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpDownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftRightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.MoreShapes"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.Duplicate"]=!0);this.la.Eug||(a["PptRibbon.Home.Drawing.AllShapes"]=!0,a["PptRibbon.InsertTab.Illustrations.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBoxBig"]=!0);this.la.gae||(a["PptRibbon.InsertTab.InsertTables"]=!0);a["ContextualTabs.Tables.Design"]=!0;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!0;a.buttonFirstRow=!0;a.buttonFirstColumn=!0;a.buttonLastRow=!0;a.buttonLastColumn=
!0;a.buttonBandedRow=!0;a.buttonBandedColumn=!0;a["ContextualTabs.Tables.Design.TableStyles"]=!0;a.buttonTableStyleRibbon0=!0;a.buttonTableStyleRibbon1=!0;a.buttonTableStyleRibbon2=!0;a.buttonTableStyleRibbon3=!0;a.buttonTableStyleRibbon4=!0;a.buttonTableStyleRibbon5=!0;a.buttonTableStyleRibbon6=!0;a.fsfaMoreTableStyles=!0;a.fsfaTableStyleTheme=!0;a["ContextualTabs.Tables.Design.Shading"]=!0;a.cellShadingColor=!0;a["ContextualTabs.Tables.Design.TableBorderStyle"]=!0;a["ContextualTabs.Tables.Design.DrawBorders"]=
!0;a.TableBorders=!0;a.TableBordersPenColor=!0;a.TableBorderPenWeight=!0;a["ContextualTabs.Tables.Layout"]=!0;a["ContextualTabs.Tables.Layout.Table"]=!0;a.idTableSelect=!0;a.btnSelectTable=!0;a.btnSelectColumn=!0;a.btnSelectRow=!0;a["ContextualTabs.Tables.Layout.RowColumn"]=!0;a.idTableDelete=!0;a.btnTableDelete=!0;a.btnColumnDelete=!0;a.btnRowDelete=!0;a["ContextualTabs.Tables.Layout.MergeSplit"]=!0;a.btnMergeTableCells=!0;a.btnSplitTableCells=!0;a.btnInsertRowAbove=!0;a.btnInsertRowBelow=!0;a.btnInsertColumnLeft=
!0;a.btnInsertColumnRight=!0;a.btnDistributeRows=!0;a.btnDistributeColumns=!0;a["ContextualTabs.Tables.Layout.Alignment"]=!0;a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!0;a.btnTableCellLeftJustify=!0;a.btnTableCellCenterJustify=!0;a.btnTableCellRightJustify=!0;a.btnTableCellTopAnchoring=!0;a.btnTableCellMiddleAnchoring=!0;a.btnTableCellBottomAnchoring=!0;if(this.la.eae){if(this.la.fae||this.la.Dvb||this.la.dae)a["ContextualTabs.Tables.Layout"]=!1;this.la.dae&&(a["ContextualTabs.Tables.Layout.Alignment"]=
!1,a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!1,a.btnTableCellLeftJustify=!1,a.btnTableCellCenterJustify=!1,a.btnTableCellRightJustify=!1,a.btnTableCellTopAnchoring=!1,a.btnTableCellMiddleAnchoring=!1,a.btnTableCellBottomAnchoring=!1);a["ContextualTabs.Tables.Design"]=!1;this.la.fae&&(a["ContextualTabs.Tables.Layout.Table"]=!1,a.idTableSelect=!1,a.btnSelectTable=!1,a.btnSelectColumn=!1,a.btnSelectRow=!1);this.la.Dvb&&(a["ContextualTabs.Tables.Layout.RowColumn"]=!1,a.idTableDelete=!1,a.btnTableDelete=
!1,a.btnColumnDelete=!1,a.btnRowDelete=!1,a.btnInsertRowAbove=!1,a.btnInsertRowBelow=!1,a.btnInsertColumnLeft=!1,a.btnInsertColumnRight=!1);a["ContextualTabs.Tables.Design.Shading"]=!1;a.cellShadingColor=!1;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!1;a.buttonFirstRow=!1;a.buttonFirstColumn=!1;a.buttonLastRow=!1;a.buttonLastColumn=!1;a.buttonBandedRow=!1;a.buttonBandedColumn=!1;a["ContextualTabs.Tables.Design.TableStyles"]=!1;a.buttonTableStyleRibbon0=!1;a.buttonTableStyleRibbon1=!1;a.buttonTableStyleRibbon2=
!1;a.buttonTableStyleRibbon3=!1;a.buttonTableStyleRibbon4=!1;a.buttonTableStyleRibbon5=!1;a.buttonTableStyleRibbon6=!1;a.fsfaMoreTableStyles=!1;this.la.K9&&(a["ContextualTabs.Tables.Design.TableBorderStyle"]=!1,a.TableBorders=!1,this.la.yDb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBorderPenWeight=!1),this.la.wdb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBordersPenColor=!1));this.la.QTc&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnMergeTableCells=!1);this.la.iae&&
(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnSplitTableCells=!1);this.la.zfc&&(a.btnDistributeRows=!1,a.btnDistributeColumns=!1)}this.la.powerPointFullTextJustifyIsEnabled||(a["PptRibbon.Home.Paragraph.FullJustify"]=!0);this.la.powerPointSmartLookupIsEnabled||(a["PptRibbon.Review.SmartLookup"]=!0,a["PptRibbon.Review.Show.SmartLookup"]=!0,a["PptRibbon.Review.ShowHide.SmartLookup"]=!0);this.la.powerPointFormatBackgroundEnabled||(a["PptRibbon.Design.Customize.FormatBackgroundAnchor"]=!0);a["PptRibbon.InsertTab.Symbols"]=
!u.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled");this.la.Fvg||(a["PptRibbon.Home.Font.Shrink"]=!0,a["PptRibbon.Home.Font.Grow"]=!0);this.la.OKj||(a["PptRibbon.Home.Font.Strikethrough"]=!0);this.la.K7d||(a["PptRibbon.InsertTab.Images.Clipart"]=!0);this.Dxh(a,!0,!0,!0);this.Cxh(a,!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media.OnlineVideo"]=!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media"]=!0);this.la.K5g||(a["PptRibbon.AudioPlayback"]=!0);this.la.wDb||
(a["PptRibbon.AudioFormat"]=!0);if(u.AFrameworkApplication.KAa||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.M9d)a["PptRibbon.InsertTab.AppForOffice"]=!0;this.la.tub||(a["PptRibbon.View.Zoom"]=!0);this.la.jIj||(a["PptRibbon.Home.Paragraph.LineSpacing"]=!0);this.la.Rqg||(a["ContextualTabs.Tables.Layout.Properties"]=!0,a["PptRibbon.PictureFormat.Properties"]=!0,a["PptRibbon.DrawingFormat.Properties"]=!0,a["PptRibbon.SmartArt.Properties"]=!0,a["PptRibbon.AudioFormat.Properties"]=!0);var b=[];
this.la.mJa&&(b=this.la.mJa.split(","));for(const c of b){const f=c.trim().substring(0,1).toUpperCase()+c.trim().substring(1,c.length);a["Transition"+f]=!0}Array.contains(b,"Wipe")&&Array.contains(b,"Shape")&&Array.contains(b,"Split")&&Array.contains(b,"RandomBars")&&(a.TransitionMore=!0);this.la.nId||(a.AnimationMore=!0);this.la.aPj?a["PptRibbon.Transition.AllSlides"]=!0:a["PptRibbon.Transition.Timing"]=!0;this.la.powerPointEnableAccCheck||(a["PptRibbon.Review"]=!0);this.la.vg&&(a["PptRibbon.View.PresentationViews"]=
!0);this.JMg?a["PptRibbon.Home.Clipboard.Paste"]=!0:a["PptRibbon.Home.Clipboard.NewPaste"]=!0;this.la.Iug?a["PptRibbon.Design.OldThemes"]=!0:a["PptRibbon.Design.Themes"]=!0;a["PptRibbon.View.ShowHide.CommentsSplitButton"]=!0;this.la.pptEditorConsistencyCheckIsEnabled||(a["PptRibbon.Review.Proofing.EditorPane"]=!0);this.la.proofingSettingIsEnabled||(a["PptRibbon.Review.Proofing.GrammarOptions"]=!0);this.la.pptHideProofingErrorIsEnabled||(a["PptRibbon.Review.Proofing.HideProofingErrors"]=!0);this.la.I9d||
(a["PptRibbon.Review.Activity"]=!0);a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?a["PptRibbon.Review.Proofing"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0;(b=u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.SHb&&!u.AFrameworkApplication.KAa)||(a["PptRibbon.Help"]=!0);a.btnContactSupport=!(b&&u.AFrameworkApplication.fa.ka("HelpTabContactSupportIsEnabled"));
a.btnShowTraining=!(b&&u.AFrameworkApplication.fa.ka("HelpTabShowTrainingIsEnabled"));a.btnWhatsNew=!(b&&u.AFrameworkApplication.fa.ka("HelpTabWhatsNewIsEnabled"));a.btnFeedbackPane=!0;this.la.L7a&&this.la.i6d&&this.la.i6d.length||(a.InsertIconDialog=!0);a["PptRibbon.View.Subtitles.UseSubtitles"]=!0;a["PptRibbon.View.Subtitles.SubtitleSettings"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=
!0;a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!0;a.AlwaysUseSubtitles=!0;a.UseSubtitles=!0;a["PptRibbon.View.Coach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!0;a["PptRibbon.View.Coach.Menu.Vision"]=!0;a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=
!0;a["PptRibbon.View.Coach.Menu"]=!0;a["PptRibbon.View.StartSlideShow.PresentLive"]=!0;a.PresentLive=!0;a.PresentLiveConsumer=!0;a.PresentLiveEnterprise=!0;a.PresentLiveTopBar=!0;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CacheDictateVisibility",!1)||(a["PptRibbon.Home.Dictation"]=!0,a.btnStartDictation=!0);this.vxb&&(a["PptRibbon.Review.Comments.Markers"]=!0);u.AFrameworkApplication.fa.ka("OcpsIsEnabled")&&(a.TellMeControl=!0);a["PptRibbon.Review.Translate"]=
!this.la.x4g;a["PptRibbon.Review.Activity.ShowVersionHistory"]=!this.la.Ryk;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"]=!this.la.cHa;a["PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"]=!this.la.cHa;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture"]=!this.la.cHa;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture"]=!this.la.cHa;a["PptRibbon.PictureFormat.Adjust.ChangePicture"]=this.la.cHa;a.FixIt=!this.la.oJc}p6k(a){if(!u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")||u.AFrameworkApplication.SHb||
u.AFrameworkApplication.KAa)a.Help=!0;a.Draw=!this.la.vg}jgj(){const a=new Ha.a;if(this.la.mJa){var b=this.la.mJa.split(",");for(const c of b)b=c.trim(),"MenuSection"===b.substring(0,11)&&a.add(new TG("TransitionMore","Transition"+b,!0))}return a.toArray()}N2k(a){a["PptJewel.Menu"]=!0;u.AFrameworkApplication.fa.ka("WheresSaveButtonBrsIsEnabled")||(a["PptJewel.SaveACopy.WheresTheSaveButton"]=!0);this.la.printingEnabled||(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,
a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);a["PptJewel.Print.PrintToPdf"]=!0;this.O0c&&this.O0c.JVg||(a["PptJewel.About.TryOffice"]=!0);this.g0c&&this.g0c.Goh||(a["PptJewel.About.TryMacOffice"]=!0);u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&
u.AFrameworkApplication.fu.ux||(a.lblBreadcrumbDocName=!0);u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.SHb&&(a["PptJewel.Help"]=!0)}rCh(a){delete a["PptJewel.Menu"];const b=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.oJ);if(b&&"teams"===b.toLowerCase()){a["PptJewel.Share"]=!0;a["PptJewel.Share.Embed"]=!0;var c=u.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost");const f=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");c&&f||(a["PptJewel.SaveACopy.SaveACopy"]=
!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0)}u.AFrameworkApplication.Kua||(a["PptJewel.New"]=!0);u.AFrameworkApplication.iCe||(a["PptJewel.Open"]=!0);u.AFrameworkApplication.aE||(a["PptJewel.Help.GiveFeedback"]=!0,a.btnFeedback=!0,a.btnFeedbackPane=!0);u.AFrameworkApplication.Exh&&(a["PptJewel.Info.OpenInClient"]=!0,a.btnOpenInClient=!0);u.AFrameworkApplication.cXa||(a["PptJewel.Share.ReplyWithChanges"]=!0);u.AFrameworkApplication.UUd||u.AFrameworkApplication.yTe||
(a["PptJewel.Info.FileVersion"]=!0);u.AFrameworkApplication.uvb?(a["PptJewel.Info.FileVersion"]=!0,u.AFrameworkApplication.Qj("Microsoft.Office.PPT.Server.Flighting.PPTOneDriveConsumerSharedVersionHistoryIsEnabled"),Z.ULS.sendTraceTag(512262734,832,15,"PPT external version history menu item for OneDriveConsummer trimmed.")):u.AFrameworkApplication.kUc()?this.la.tvk?(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(512262732,832,15,"PPT shared version history menu item trimmed for internet explorer.")):
u.AFrameworkApplication.fa.ka("DisableAnonymousUserCheckForBlueChickenForVH")?u.AFrameworkApplication.fa.ka("IsAnonymousUserCheckSupportedForVH")&&u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(512262731,832,15,"PPT shared version history menu item due to anonymous user.")):u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(512262730,832,15,"PPT shared version history menu item due to anonymous user.")):
(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(512262733,832,15,"PPT shared version history menu item trimmed."));a["PptJewel.Info.OpenInClient"]&&a["PptJewel.Info.FileVersion"]&&a["PptJewel.Info.VersionHistory"]&&(a["PptJewel.Info"]=!0);u.AFrameworkApplication.qPa||(a["PptJewel.Share.ShareWithPeople"]=!0);if(u.AFrameworkApplication.bO||!u.AFrameworkApplication.wTe&&!u.AFrameworkApplication.ptb&&!u.AFrameworkApplication.KUd)a["PptJewel.Share.Embed"]=!0;a["PptJewel.Share.ShareWithPeople"]&&
a["PptJewel.Share.Embed"]&&a["PptJewel.Share.ReplyWithChanges"]&&(a["PptJewel.Share"]=!0);u.AFrameworkApplication.Sol&&(a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.fa.ka("DisablePrint")&&
(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.bO&&(a["PptJewel.Print"]=!0,a["PptJewel.Share"]=!0);u.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")||
(a["PptJewel.SaveACopy.SaveACopy"]=!0);u.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&u.AFrameworkApplication.fa.ka("UserCanWriteRelative")&&u.AFrameworkApplication.fa.ka("SupportsEditing")||(a["PptJewel.SaveACopy.SaveAsToHost"]=!0);u.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&u.AFrameworkApplication.fa.ka("SupportsGetMoreInfoForPersonalStorage")||(a["PptJewel.SaveACopy.SaveToSharePoint"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&
a["PptJewel.SaveACopy.SaveToSharePoint"]&&(a["PptJewel.SaveACopy"]=!0);this.la.TKj||(a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0);this.la.Nvg&&this.la.vg||(a["PptJewel.DownloadAs.DownloadAsImages"]=!0);if(!u.AFrameworkApplication.fa.ka("153")||".odp"===u.AFrameworkApplication.fa.appSettings["152"].toLowerCase()||u.AFrameworkApplication.bO)a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0;u.AFrameworkApplication.fa.ka("RenameDialogIsEnabled")&&u.AFrameworkApplication.t4b()&&!u.AFrameworkApplication.bO||
(a["PptJewel.Rename"]=!0);u.AFrameworkApplication.dic||(a["PptJewel.Help.ReportAbuse"]=!0);c=!u.AFrameworkApplication.$4c||!u.AFrameworkApplication.fa.ka("1072");u.AFrameworkApplication.GDb||!c||u.AFrameworkApplication.Qlc||this.O0c&&this.O0c.JVg||this.g0c&&this.g0c.Goh||u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About"]=!0);u.AFrameworkApplication.GDb||(a["PptJewel.About.Privacy"]=!0);a["PptJewel.About.TrustCenter"]=c;u.AFrameworkApplication.Qlc||(a["PptJewel.About.TermsOfUse"]=
!0);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About.DiagnosticsSection"]=!0);u.AFrameworkApplication.Xba||(a["PptJewel.SecondaryMenu"]=!0);c=!u.AFrameworkApplication.fa.ka("248");a["PptRibbon.Design.Designer.New"]=c;a["PptRibbon.Design.ShowHide.Designer.New"]=c;a["PptRibbon.Home.Designer"]=c;(a["PptRibbon.Home.ShowHide.Designer"]=c)&&this.tm&&this.tm.y9(this.tm.F4,this.tm.cRd);c=!u.AFrameworkApplication.fa.ka("822");a["PptRibbon.Review.SmartLookup"]=c;
a["PptRibbon.Review.Show.SmartLookup"]=c;(c=(a["PptRibbon.Review.ShowHide.SmartLookup"]=c)||!fv.XLj())||Z.ULS.sendTraceTag(512262729,1303,15,"ReuseSlides is not trimmed");a["PptRibbon.Home.Slides.InvokeFilesSerplet"]=c;a["PptRibbon.InsertTab.InvokeFilesSerplet"]=c;Z.ULS.sendTraceTag(512262728,352,50,"IsInsertOnlinePictureFromHostSupported: {0}; InsertOnlinePictureFromHostEnabled: {1}; HostSupportsInsertOnlinePictureFromHost: {2}; IsSkyDrive: {3}; AppSupportsInsertOnlinePictureFromHost: {4}; AppSupportsInsertOnlinePictureFromSharePoint: {5}",
u.AFrameworkApplication.O3b(),u.AFrameworkApplication.insertOnlinePictureFromHostEnabled,u.AFrameworkApplication.vPc,u.AFrameworkApplication.uvb,u.AFrameworkApplication.xAc,u.AFrameworkApplication.jTb);u.AFrameworkApplication.fa.ka("671")&&this.Dxh(a,this.la.pptInsertOnlinePictureEnabled,u.AFrameworkApplication.O3b(),this.la.L7a);this.Cxh(a,this.la.zQc);u.AFrameworkApplication.fa.ka("670")&&(c=!u.AFrameworkApplication.fa.ka("124"),a["PptRibbon.InsertTab.Media.OnlineVideo"]=c,a["PptRibbon.InsertTab.Media"]=
!!c);a["PptRibbon.Review.Proofing.EditorPane"]=!u.AFrameworkApplication.fa.ka("809");a["PptRibbon.Review.Proofing.GrammarOptions"]=!u.AFrameworkApplication.fa.ka("299");a["PptRibbon.Review.Proofing.HideProofingErrors"]=!u.AFrameworkApplication.fa.ka("619");a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?(a["PptRibbon.Review.Proofing"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0):(a["PptRibbon.Review.Proofing"]=
!1,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!1):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!1);c=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");this.la.dja&&c&&(a["PptRibbon.View.Subtitles.UseSubtitles"]=!1,ee.a("ReactMLRSubtitleSettingsTeamsFix")||(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1),a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=
!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!1);this.la.a5b&&this.la.bwg&&(a["PptRibbon.View.Coach"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!1,this.la.pptRehearsalVisionEnabled||this.la.xDb?(a["PptRibbon.View.Coach.Menu"]=
!1,a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!1,this.la.pptRehearsalVisionEnabled&&(a["PptRibbon.View.Coach.Menu.Vision"]=!1),this.la.xDb&&(a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!1)):a["PptRibbon.View.Coach.RehearseWithCoach"]=!1);this.la.ZOj&&this.la.dja&&c&&(!b||"teams"!==b.toLowerCase())&&(a.AlwaysUseSubtitles=!1,a.UseSubtitles=!1,ee.a("ReactMLRSubtitleSettingsTeamsFix")&&(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1));this.la.powerPointLiveBroadcastEnabled&&(a["PptRibbon.View.StartSlideShow.PresentLive"]=
!1,a.PresentLive=!1,a.PresentLiveTopBar=!1);u.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&u.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&u.AFrameworkApplication.fa.ka("SupportsPolicies")||(a["PptRibbon.Home.Sensitivity"]=!0,a.flySensitivity=!0,this.tm&&this.tm.y9(this.tm.F4,this.tm.Ejh));this.la.dictationIsEnabled&&n.a.Sth&&u.AFrameworkApplication.fa.ka("UserCanUseDictation")?
(a["PptRibbon.Home.Dictation"]=!1,a.btnStartDictation=!1):this.tm&&this.tm.y9(this.tm.F4,this.tm.gWf);a["PptJewel.Open"]&&a["PptJewel.New"]&&(a["PptJewel.Home"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&a["PptJewel.Rename"]&&a["PptJewel.DownloadAs.DownloadACopy"]&&a["PptJewel.DownloadAs.DownloadACopyAsPdf"]&&a["PptJewel.DownloadAs.DownloadACopyAsOdp"]&&a["PptJewel.DownloadAs.DownloadAsImages"]?a["PptJewel.SaveACopy"]=!0:
a["PptJewel.SaveACopy"]&&delete a["PptJewel.SaveACopy"];a["PptRibbon.Review.Translate"]=!this.la.x4g;a.FixIt=!this.la.oJc;u.AFrameworkApplication.fa.Aw("IsPresentToTeamsSupportedHost")&&!u.AFrameworkApplication.fa.ka("IsPresentToTeamsSupportedHost")?(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0):b&&"sharepointcom"!==b&&(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0);u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a.CatchUpWithChanges=!0);up.Ywl(fv.zsj,a)}Dxh(a,b,c,f){a["PptRibbon.InsertTab.Images.FlyPicture"]=
!1;a["PptRibbon.InsertTab.Images.FlyPicture.FromHost"]=!c;a["PptRibbon.InsertTab.Images.FlyPicture.FromSearch"]=!b;a["PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromDevice"]=!1;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromHost"]=!c;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromSearch"]=!b;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Icon"]=
!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost"]=!c;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost"]=!c;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"]=
!b;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"]=!f}Cxh(a,b){a.InsertPictureFromMobileDevice=!b;a.ChangePictureFromMobileDevice=!b}static XLj(){const a=u.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"),b=u.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");var c=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.oJ);c=!!c&&"teams"===c.toLowerCase();return(!a||!a.length)&&b&&!c}}fv.zsj=
{["ellipsisOpenInApp"]:(yB=new Ha.a,yB.add("HostOpenInClient"),yB),["ellipsisOpenInBrowser"]:(xB=new Ha.a,xB.add("HostOpenInBrowser"),xB),["ellipsisDownload"]:(wB=new Ha.a,wB.add("HostDownload"),wB),["conversation"]:(vB=new Ha.a,vB.add("HostConversation"),vB),["close"]:(cx=new Ha.a,cx.add("HostClose"),cx.add("btnjClose"),cx.add("msJewelSecondary"),cx),["copyLink"]:(uB=new Ha.a,uB.add("CopyLink"),uB),["share"]:(Sy=new Ha.a,Sy.add("jbtnFileSharing"),Sy.add("btnFileSharing"),Sy),["docChat"]:(tB=new Ha.a,
tB.add("DocChat"),tB),["openInApp"]:(sB=new Ha.a,sB.add("btnOpenInClient"),sB)};Object(e.a)(fv,"RibbonCommandTrimmer",null,[1258]);class zB{constructor(){this.fFa=this.ql=this.K=null}get name(){return"PowerPointWebEditor.Ribbon"}Wb(a){this.K=a;a.register(XA,"PowerPointWebEditor.Ribbon.PPTWebEditReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").ma().na(()=>new XA(a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1191,"PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ma().na(()=>
new YF(new UA(u.AFrameworkApplication.fa)));let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Xub;n.a.Hj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").owa);var c=this.K.resolve("PowerPointWebEditor.IFileInfo").iha;let f=2===c||3===c||0===c;c=1===c;const l=a.resolve("PowerPointWebEditor.IApplicationSettings").Qeb?a.resolve("PowerPointWebEditor.IPPTRumTracker"):null;f=f&&!c;a.register(fv,"PowerPointWebEditor.Ribbon.RibbonCommandTrimmer").ma().na(()=>new fv(a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("Common.IOfficeTrialExperience"),a.resolve("Common.IMacOfficeOffer"),b,f,l));a.register(1192,"PowerPointWebEditor.IModeSwitcherControlActor").ma().na(()=>new RF(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IAppFrame"),pd.a.get_instance(),l));a.register(1193,"PowerPointWebEditor.IRibbonUser").ma().na(()=>{const x=
a.resolve("PowerPointWebEditor.IApplicationSettings"),F=a.resolve("PowerPointWebEditor.Ribbon.RibbonCommandTrimmer");var R={};F.egd(R);var fa={};F.p6k(fa);R=new NF(R,F.jgj(),fa);fa=new QF;const wa=a.resolve("Common.IAppSettingsManager"),Xa=new RG(a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("PowerPointWebEditor.IRibbonPane").ya,a.resolve("PowerPoint.IPathManager"),a.La("Box4.IGeneralCuiUser"),a.resolve("Common.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IExternalUICommandDefinitionMapping"),
a.pb("PowerPointWebEditor.Core.IBundleMetricRecorder"),F,R,x,a.resolve("PowerPointWebEditor.IModeSwitcherControlActor"),fa,l,wa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InvokeFullAppSettingsCallbackImmediately",!1),Object(Fa.a)(109,wa)?wa:null,wa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1),u.AFrameworkApplication.aDb,a.resolve("PowerPointWebEditor.IPresentationResourcesManager"));x.VUf?this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Ytb(()=>
{Xa.dmg()}):Xa.dmg();return Xa});a.register(1194,"Common.IRibbonExternal").ma().na(()=>a.resolve("PowerPointWebEditor.IRibbonUser").sVk);a.register(1195,"PowerPointWebEditor.IRibbonChangeManager").ma().na(()=>new SG(a.resolve("Common.ITaskManager"),a.resolve("Box4.Graph.IGraphInstance").Bd(10),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(WA,"PowerPointWebEditor.BusinessBarController").as("PowerPointWebEditor.IBusinessBarController").as("Box4.IBusinessBarController").ma().na(()=>new WA(a.resolve("CommonUI.IBusinessBar"),new OF,a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IErrorMapping"),u.AFrameworkApplication.fa,a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")));
a.register(1196,"PowerPointWebEditor.IBusinessBarPane").ma().na(()=>new TF(a.La("CommonUI.IBusinessBar"),a.resolve("PowerPointWebEditor.IApplicationSettings").RWa,a.resolve("PowerPointWebEditor.IApplicationSettings").jhc,a.resolve("PowerPointWebEditor.IApplicationSettings").mEb));a.register(qq,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ma().na(()=>new qq(a.resolve("PowerPointWebEditor.IBusinessBarPane").tBl));a.register(1197,"Common.IRibbonSQMInformation").ma().na(()=>{const x=new ZF(u.AFrameworkApplication.Ta);
x.gMk();return x});a.register(1198,"PowerPointWebEditor.IInkRibbonManager").ma().na(()=>new sq(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),u.AFrameworkApplication.Aa.gb.Q7))}init(){this.fFa=this.K.resolve("PowerPointWebEditor.IModeSwitcherControlActor");this.K.resolve("PowerPointWebEditor.BusinessBarController").Kuk();this.ql=this.K.resolve("PowerPointWebEditor.IBusinessBarController");
this.ql.initialize();u.AFrameworkApplication.fa.ka("EarlyInitRibbonUser")?(this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("Common.IRibbonExternal")):this.K.La("PowerPointWebEditor.IRibbonUser").execute(()=>{this.K.resolve("Common.IRibbonExternal")});const a=this.K.resolve("PowerPointWebEditor.IBusinessBarPane"),b=this.K.resolve("PowerPointWebEditor.IPaneManager");var c=document.getElementById("WACDocumentAndTaskPanel");this.K.resolve("PowerPointWebEditor.IApplicationSettings").mEb?
(c=document.getElementById("BusinessBarRegion"),b.KMa(a,c,null)):this.K.resolve("PowerPointWebEditor.IApplicationSettings").RWa&&c?b.KMa(a,this.K.resolve("PowerPointWebEditor.AppFrame").F0,c):b.uM(a);this.K.resolve("CommonUI.IBusinessBar");this.K.resolve("PowerPointWebEditor.IInkRibbonManager")}dispose(){this.ql&&this.ql.dispose();this.fFa&&this.fFa.dispose()}static main(){m.a.instance.Ac(new zB)}}Object(e.a)(zB,"PPTWebEditorRibbonPackage",null,[2,3]);var dx=d(658);class UG{get name(){return"Box4.Insights"}init(){}dispose(){}Wb(a){a.register(dx.a,
"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().na(()=>new dx.a)}}Object(e.a)(UG,"Box4InsightsPackage",null,[2,3]);class AB{constructor(a,b){this.Ixd=0;this.cga=new Ha.a;this.Ca=a;this.hd=b}get Tc(){return this.hd}get Y4d(){return 0<this.Ixd}B9(a){this.Kug(a)&&this.Ixd++;this.Y4d?this.Tc.enabled=!1:this.cga.add(this.Tc.Bp(a.actionId))}z9(a){!this.Y4d&&0<this.cga.count&&(this.cga.ga(this.cga.count-1),this.vZf(this.cga.count-
1));this.Kug(a)&&this.Ixd--;this.Y4d||(this.Tc.enabled=!0)}vZf(a){if(0<this.cga.count&&0<=a&&a<this.cga.count){const b=this.cga.ga(a);this.cga.removeAt(a);b.end()}}Nni(){let a=this.cga.count-1;for(;0<=a;){var b=this.cga.ga(a);(b=this.Ca.iS(b.activityName))&&b.flags[128]&&this.vZf(a);a--}}Kug(a){if(2!==a.behavior)return!0;a=this.Ca.iS(a.actionId);return!!a&&a.flags[32]}}Object(e.a)(AB,"ActivityActionListener",null,[156]);var Ty;(function(a){a[a.timeOut=0]="timeOut";a[a.appClose=1]="appClose";a[a.appError=
2]="appError"})(Ty||(Ty={}));Object(e.b)("ActivityAutoEndReason",Ty);class BB{constructor(a){this.wga=new $g.a;this.oKb=a}zai(){for(let a of this.wga.keys)this.Aai(a)}E4f(a){if(this.oKb.WAc)for(let b of this.wga.keys){const c=Array.clone(this.wga.ga(b));for(let f=0;f<c.length;f++){const l=c[f];l.dWd();this.hah(b,a,l.uniqueID)}}}Aai(a){var b=this.wga.ga(a);b=this.C6i(b);for(let c=0;c<b.length;c++){const f=b[c];f.dWd();this.hah(a,0,f.uniqueID)}}C6i(a){const b=[];for(let c=0;c<a.length;c++){const f=
a[c];(new Date).getTime()-f.startTime>f.bSg&&Array.add(b,f)}return b}hah(a,b,c){const f={};f.AID=c;f.A=a;f.AE=Ty[b];Sa.a.instance.Tb("AutoEnded",f)}f7k(){if(this.oKb.WAc){var a=new He.a(2,2,this.oKb.Bai,Object(D.a)(this,this.zai,"autoEndLongRunningActivities"),67);u.AFrameworkApplication.ue.Gb(a)}}register(a){if(this.oKb.WAc){var b=a.activityName;this.wga.Jb(b)&&this.wga.ga(b)||this.wga.$(b,[]);Array.add(this.wga.ga(b),a)}}unregister(a){if(this.oKb.WAc){var b=a.activityName;this.wga.Jb(b)&&this.wga.ga(b)&&
Array.remove(this.wga.ga(b),a)}}}Object(e.a)(BB,"ActivityAutoEndHelper",null,[1300]);class Lt{constructor(a){this.uVe=null;this.Ptc=0;this.zrd=this.OF=!1;this.WDd=0;this.px=new Ic.a;this.lrb=new Ic.a;this.DGh=a}get cFd(){return this.uVe||(this.uVe=this.DGh())}get properties(){return this.px}get bSg(){return this.Ptc}get enabled(){return this.OF}get ended(){return this.zrd}get uniqueID(){return this.WDd}xRg(){const a={};a.ID=this.uniqueID;a.A=this.activityName;a.ST=this.startTime;a.ET=this.endTime;
cb.Ct(this.properties.keys)&&(a.P=Lt.icg(this.properties));cb.Ct(this.lrb.keys)&&(a.FP=Lt.icg(this.lrb));return a}static icg(a){const b={};for(let c of a)b[c.key]=c.value;return b}}Object(e.a)(Lt,"AActivity",null,[1315,607]);class CB extends Lt{constructor(a,b,c,f,l,x,F,R){super(F);this.Zs=0;this.FGh=a;this.YKh=b;this.hfa=c;this.Bj=(new Date).getTime();this.AQh=f;this.Hnd=x;this.Ptc=l;this.Hnd.register(this);this.WDd=R()}get activityName(){return this.hfa}get startTime(){return this.Bj}get endTime(){return this.Zs}EZf(a){this.Zs=
(new Date).getTime();this.ended?this.NIk():(this.zrd=!0,this.Zs=(new Date).getTime(),this.Zs<this.Bj&&(Z.ULS.sendTraceTag(8184544,213,50,String.format("EndTime ({0}) is less than StartTime ({1}) for Activity ({2}).",this.Zs,this.Bj,this.hfa)),this.Zs=this.Bj),this.Hnd.unregister(this),this.AQh&&(!a&&this.cFd&&this.cFd.enabled?this.Nmb():this.DVb()))}end(){this.EZf(!1)}dWd(){this.EZf(!0)}NIk(){const a={};a.AN=this.activityName;a.AT=(new Date).getTime();a.AID=this.uniqueID;this.YKh("AlreadyEnded",this.endTime,
a)}Nmb(){this.cFd.Nmb()}DVb(){this.FGh(this.xRg())}cancel(){this.ended||(this.zrd=!0,this.Hnd.unregister(this))}}Object(e.a)(CB,"ActivityImpl",Lt,[]);class VG extends Sys.EventArgs{constructor(){super();this.name=this.properties=null}}Object(e.a)(VG,"ActivityRecordedEventArgs",Sys.EventArgs,[]);class Mt{constructor(a,b,c){this.Pa=new qd.a;this.OF=!0;this.settings=a;this.Ind=b;this.Mnd=c}get enabled(){return this.OF&&this.settings.enabled}set enabled(a){this.OF=a}Bp(a,b=-1){-1===b&&(b=this.settings.rDi);
return this.Ind(Object(D.a)(this,this.DVb,"completeActivity"),Object(D.a)(this,this.iah,"recordEventInternal"),a,this.qBj(a.toString()),b)}Tb(a,b=null){this.iah(a,(new Date).getTime(),b);this.Pa.raiseEvent("HHR",Object.assign(new VG,{name:a,properties:b}))}iah(a,b,c){this.Isg(a)&&(a=this.bdg(a,c,b),Z.ULS.sendTraceTag(6068304,213,100,a))}recordError(a,b=null){this.Isg(a.toString())&&(a=this.bdg(a.toString(),b,(new Date).getTime()),Z.ULS.sendTraceTag(6415520,213,100,a))}qBj(a){return this.enabled&&
!this.rBj(a)}Isg(a){return this.enabled&&!this.zFj(a)}rBj(a){return this.settings.tGi.contains(a)}zFj(a){return this.settings.uGi.contains(a)}DVb(a){if(this.Mnd.bLf(a.A.toString())){var b=[];Array.add(b,a);a=fe.c(b);Z.ULS.sendTraceTag(5894867,213,100,a)}}bdg(a,b,c){const f={};f.ID=Mt.KWd();f.V=a;f.VT=c;b&&(f.P=b);a=[];Array.add(a,f);return fe.c(a)}static KWd(){return Mt.vXh++}}Mt.vXh=0;Object(e.a)(Mt,"ActivityManagerImpl",null,[572]);class cp{constructor(){this.OF=!1;this.iZe=this.oWe=0;this.nWe=
!1;this.R_e=new Ln.a;this.S_e=new Ln.a}MYb(a){this.OF=Boolean.parse(a[cp.tFj]||"false");this.R_e=this.b3g(a[cp.sGi]);this.S_e=this.b3g(a[cp.vGi]);this.YNi(a)}get enabled(){return this.OF}get tGi(){return this.R_e}get uGi(){return this.S_e}YNi(a){this.nWe=Boolean.parse(a[cp.pCj]||"false");this.oWe=parseInt(a[cp.Cai]||"60000");this.iZe=parseInt(a[cp.sDi]||"5000")}get Bai(){return this.oWe}get rDi(){return this.iZe}get WAc(){return this.nWe}b3g(a){const b=new Ln.a;for(const c of(a||"").split(","))""!==
c&&b.add(c);return b}}cp.tFj="ActivityLoggingIsEnabled";cp.sGi="DisabledClientActivityNames";cp.vGi="DisabledClientActivityEventNames";cp.pCj="ActivityAutoEndEnabled";cp.Cai="ActivityAutoEndTaskInterval";cp.sDi="ActivityDefaultMaxDuration";Object(e.a)(cp,"ActivitySettings",null,[1292]);class gv{constructor(a){this.Vqd=new Ln.a;this.wQb=new Ic.a;this.Lxc=a;this.g7k()}g7k(){this.Lxc.enabled&&(gv.Vwf=new He.a(2,2,this.Lxc.interval,Object(D.a)(this,this.JHi,"doThrottle"),65),u.AFrameworkApplication.ue.Gb(gv.Vwf))}JHi(){this.KTk()}KTk(){this.wQb=
new Ic.a;this.Vqd=new Ln.a}sBj(a){return this.Vqd.contains(a)}gpl(a){if(this.wQb.Jb(a)){if(this.wQb.ga(a)>=this.Lxc.nbk)return this.Vqd.add(a),Z.ULS.sendTraceTag(7696902,213,50,"Activity {0} will be throttled due to too much logging.",a),!1;let b;(b=this.wQb).$(a,b.ga(a)+1)}else this.wQb.add(a,1);return!0}bLf(a){return this.Lxc.enabled?!this.sBj(a)&&this.gpl(a):!0}}gv.Vwf=null;Object(e.a)(gv,"ActivityThrottler",null,[1291]);class Ir{constructor(){this.OF=!1;this.R5e=this.odf=0}MYb(a){this.OF=Boolean.parse(a[Ir.QSd]||
"false");this.odf=parseInt(a[Ir.obk]||"600");this.R5e=parseInt(a[Ir.hAj]||"600000")}get enabled(){return this.OF}get nbk(){return this.odf}get interval(){return this.R5e}}Ir.QSd="ActivityThrottlerEnabled";Ir.obk="ActivityThrottlerMaxActivities";Ir.hAj="ActivityThrottlerInterval";Object(e.a)(Ir,"ActivityThrottlerSettings",null,[1290]);class DB{constructor(){this.Da=null}get name(){return"Common.App.Activities"}init(){this.Iwj()}Iwj(){const a=this.Da.resolve("Common.App.Activities.IActivitySettings"),
b=u.AFrameworkApplication.fa.appSettings;a.MYb(b);this.Da.resolve("Common.App.Activities.IActivityThrottlerSettings").MYb(b);if(a.enabled){Sa.a.instance=new Mt(this.Da.resolve("Common.App.Activities.IActivitySettings"),(l,x,F,R,fa)=>new CB(l,x,F,R,fa,this.Da.resolve("Common.App.Activities.IActivityAutoEndHelper"),()=>this.Da.pb("Common.App.Activities.IActivityAggregationManager"),Mt.KWd),this.Da.resolve("Common.App.Activities.IActivityThrottler"));var c=this.Da.resolve("Common.App.Activities.ActivityAutoEndHelper"),
f=this.Da.resolve("Common.App.Activities.ActivityActionListener");c.f7k();u.AFrameworkApplication.Iea(()=>{f.Nni();c.E4f(1)});u.AFrameworkApplication.Ta.Zla(f);u.AFrameworkApplication.Azc((l,x)=>{Sa.a.instance.recordError(x.errorCode,{["ErrorCause"]:x.zTd,["ErrorResolution"]:x.ATd});c.E4f(2)})}}dispose(){}Wb(a){this.Da=a;a.register(cp,"Common.App.Activities.ActivitySettings").as("Common.App.Activities.IActivitySettings").ma();a.register(BB,"Common.App.Activities.ActivityAutoEndHelper").as("Common.App.Activities.IActivityAutoEndHelper").ma().na(()=>
new BB(a.resolve("Common.App.Activities.IActivitySettings")));a.register(AB,"Common.App.Activities.ActivityActionListener").na(()=>new AB(u.AFrameworkApplication.Ta,a.resolve("Common.IActivityManager")));a.register(Ir,"Common.App.Activities.ActivityThrottlerSettings").as("Common.App.Activities.IActivityThrottlerSettings").ma().na(()=>new Ir);a.register(gv,"Common.App.Activities.ActivityThrottler").as("Common.App.Activities.IActivityThrottler").ma().na(()=>new gv(a.resolve("Common.App.Activities.IActivityThrottlerSettings")))}static main(){m.a.instance.Ac(new DB)}}
Object(e.a)(DB,"ActivitiesPackage",null,[2,3]);class WG{constructor(){this.wna=new Ic.a}HHe(a,b){this.wna.$(a,b)}SWd(a){({value:a}=this.wna.Of(a));return a}}Object(e.a)(WG,"AggregationMethodsForActivityName",null,[]);class EB{constructor(){this.uvc=new $g.a;this.wna=new $g.a}HHe(a,b,c){this.wna.Jb(a)&&this.wna.ga(a)||this.wna.$(a,new WG);this.wna.ga(a).HHe(b,c)}SWd(a,b){return this.wna.Jb(a)&&this.wna.ga(a)?this.wna.ga(a).SWd(b):null}U_b(a){this.uvc.Jb(a)&&this.uvc.ga(a)||this.uvc.$(a,new Ln.a);return this.uvc.ga(a)}SCi(a,
b){this.U_b(a).add(b)}}Object(e.a)(EB,"ActivityAggregationInfo",null,[1305]);class ex extends Lt{constructor(a,b){super(a);this.WDd=(this.EGh=b)?b.o3i():Mt.KWd()}get Bga(){return this.EGh}get activityName(){return this.Bga.name}get startTime(){return this.Bga.startTime}get endTime(){return this.Bga.endTime}end(){}cancel(){}dWd(){}pul(){this.lrb.$("AM",this.Bga.mode.toString());this.lrb.$("C",this.Bga.count.toString());this.lrb.$("DA",this.Bga.lYf.toFixed(2));this.lrb.$("DV",this.Bga.SIi.toFixed(2))}Q_d(a){return this.Bga.Q_d(a)}r0d(){return this.Bga.r0d()}Nmb(){for(let a of this.Bga.Cga)a.Nmb()}}
Object(e.a)(ex,"AggregatedActivity",Lt,[]);class XG{constructor(a,b){this.aod=0;this.hfa=a;this.zxa=b}z7h(a,b){this.aod=b;for(b=0;b<a.count;b++){const c=a.ga(b);this.A7h(c)}}A7h(a){const b=Object(va.a)(ex,a);if(b)if(1===this.aod)this.w7h(b);else if(2===this.aod){this.B7h(b);for(let c of this.zxa.U_b(this.hfa)){const f=b.Bga.Cga.ga(0);f.properties.Jb(c)&&a.properties.$(c,f.properties.ga(c))}}}w7h(a){for(let b of this.zxa.U_b(this.hfa))this.Sgh(a,b)}B7h(a){for(let b of a.r0d())this.Sgh(a,b)}Sgh(a,b){const c=
this.zxa.SWd(this.hfa,b);if(c){const f=a.Q_d(b);a.properties.$(b,c(f))}}}Object(e.a)(XG,"PropertyAggregationHelper",null,[]);class FB{constructor(a,b,c,f,l){this.oib=a;this.zxa=b;this.xYe=l;this.Mnd=f;this.ePh=c}get Yzf(){return this.ePh.value}DVb(a){if(Object(Fa.a)(CB,a))a.DVb();else if(Object(Fa.a)(ex,a)&&this.Mnd.bLf(a.activityName.toString())){a=Object(va.a)(ex,a);a.pul();a=a.xRg();var b=[];Array.add(b,a);a=fe.c(b);Z.ULS.sendTraceTag(6907266,213,50,a)}}XSb(a,b){const c=(new Date).getTime();var f=
this.xYe.list.ga(a);const l=({C7h:f}=this.mXi(f)).returnValue;this.xYe.list.$(a,new Ha.a);b&&(f=this.Vui(f,c,this.oib.igg));0<f.count&&(new XG(a,this.zxa)).z7h(f,l)}Vui(a,b,c){const f=new Ha.a;for(let l=0;l<a.count;l++){const x=a.ga(l);x.startTime>b-c?x.Nmb():f.add(x)}return f}mXi(a){const b=this.Yzf.kwh(a);a=this.Yzf.bml(a);const c=this.D7h(b,a);return{returnValue:c,C7h:1===c?b:a}}D7h(a,b){return a.count*this.oib.jTg<b.count?1:2}get enabled(){return this.oib.enabled}Nmb(){}}Object(e.a)(FB,"ActivityAggregationManager",
null,[1304]);class Ho{constructor(a){this.enabled=!1;this.iSg=500;this.PSg=2;this.jjd=6E4;this.jTg=5;this.igg=3E4;this.MYb(a.appSettings)}MYb(a){this.enabled=Boolean.parse(a[Ho.QSd]||"false");this.iSg=parseInt(a[Ho.Dbk]||"500");this.PSg=parseInt(a[Ho.Qck]||"2");this.jjd=parseInt(a[Ho.nkl]||"60000");this.jTg=parseInt(a[Ho.edk]||"5");this.igg=parseInt(a[Ho.Jij]||"30000")}}Ho.QSd="ActivityAggregationEnabled";Ho.Dbk="ActivityAggregationMaxInterval";Ho.Qck="ActivityAggregationMinChain";Ho.nkl="ActivityAggregationTaskInterval";
Ho.edk="ActivityAggregationModeFactor";Ho.Jij="ActivityAggregationGraceWindow";Object(e.a)(Ho,"ActivityAggregationParams",null,[]);class GB{constructor(a,b){this.zxa=a;this.vVe=b}kwh(a,b=1){if(!a||!a.count)return a;const c=new Ha.a;var f=null;for(let l=0;l<a.count;l++){const x=a.ga(l);if(!x)continue;const F=x.activityName;f?f.hQj(x)?f.add(x):(f=f.process(),c.addRange(f),f=this.vVe(F,b),f.add(x)):(f=this.vVe(F,b),f.add(x))}f&&(a=f.process(),c.addRange(a));return c}bml(a){if(!a||!a.count)return a;const b=
{};var c=null;for(let l=0;l<a.count;l++){const x=a.ga(l);if(x){if(!c){c=new Ha.a;var f=this.zxa.U_b(x.activityName);for(let F of f)c.add(F)}f=this.p$i(x,c);null!==f&&(f in b&&b[f]||(b[f]=new Ha.a),b[f].add(x))}}a=new Ha.a;for(const l of xa.a.rK(b))c=this.kwh(b[l],2),a.addRange(c);return a}p$i(a,b){let c="";for(let f of b)c+=f,c=a.properties.Jb(f)&&void 0!==a.properties.ga(f)&&null!==a.properties.ga(f)?c+a.properties.ga(f):c+"null";return c}}Object(e.a)(GB,"ActivityAggregationSchemes",null,[1303]);
class YG{constructor(a,b,c,f,l){this.Zs=this.Bj=0;this.oib=c;this.Ind=f;this.zxa=l;this.name=a;this.fy=b;this.Cga=new Ha.a}get mode(){return this.fy}get count(){return this.Cga.count}get startTime(){return this.Bj}get endTime(){return this.Zs}get lYf(){if(!this.count)return 0;let a=0;for(let b of this.Cga)a+=b.endTime-b.startTime;return a/this.count}get SIi(){if(!this.count)return 0;let a=0;const b=this.lYf;for(let c of this.Cga){const f=c.endTime-c.startTime;a+=(f-b)*(f-b)}return a/this.count}add(a){this.count?
this.Zs=a.endTime>this.endTime?a.endTime:this.endTime:(this.Bj=a.startTime,this.Zs=a.endTime);this.Cga.add(a)}hQj(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.oib.iSg}process(){if(this.count>=this.oib.PSg){const a=new Ha.a,b=this.Ind(this);a.add(b);return a}return this.Cga}Q_d(a){const b=new Ha.a;for(let c of this.Cga)if(c.properties.Jb(a)){const f=c.properties.ga(a);b.add(f)}else b.add(null);return b}r0d(){const a=this.zxa.U_b(this.name),b=new Ln.a;for(let c of this.tXi())a.contains(c)||
b.add(c);return b}tXi(){const a=new Ln.a;if(!this.Cga)return a;for(let b of this.Cga)for(let c of b.properties.keys)a.add(c);return a}o3i(){return this.Cga.ga(0).uniqueID}}Object(e.a)(YG,"ActivityCollection",null,[1302]);class HB{constructor(){this.k_a=new $g.a}get list(){return this.k_a}add(a){const b=a.activityName;if(this.k_a.Jb(b)&&this.k_a.ga(b)){const c=this.I4i(this.k_a.ga(b),a);this.k_a.ga(b).insert(c,a)}else this.k_a.$(b,new Ha.a),this.k_a.ga(b).add(a)}I4i(a,b){for(let c=a.count-1;0<=c;c--)if(b.startTime>
a.ga(c).startTime)return c+1;return 0}}Object(e.a)(HB,"CompletedActivitiesHelper",null,[1301]);class IB{constructor(){this.Da=null}get name(){return"Common.App.ActivityAggregator"}init(){u.AFrameworkApplication.Iea(()=>{this.Da.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}Wb(a){this.Da=a;const b=f=>new ex(()=>a.pb("Common.App.Activities.IActivityAggregationManager"),f),c=(f,l)=>new YG(f,l,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b,a.resolve("Common.IActivityAggregationInfo"));
a.register(FB,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ma().na(()=>new FB(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.Be("Common.App.ActivityAggregator.IActivityAggregationSchemes"),a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(Ho,"Common.App.ActivityAggregator.ActivityAggregationParams").ma().na(()=>
new Ho(u.AFrameworkApplication.fa));a.register(EB,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ma().na(()=>new EB);a.register(GB,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ma().na(()=>new GB(a.resolve("Common.IActivityAggregationInfo"),c));a.register(HB,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ma().na(()=>new HB)}static main(){m.a.instance.Ac(new IB)}}
Object(e.a)(IB,"ActivityAggregatorPackage",null,[2,3]);var ZG=d(15);class Yq{constructor(){this.DVk="getAddinShortcutsPreference";this.EVk="saveAddinShortcutsPreference";this.FVk="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.fXi=6E4;this.N5c=this.O6=this.IX=null}Fcg(a){return String.format(this.FVk,u.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",a,u.AFrameworkApplication.Zg)}executeRequest(a,b,c,f,l=null){return Yq.Maa.Fmb(a,b,l,null,2,c,f,!1,null,this.fXi)}saveSetting(a,
b,c,f,l){return this.Vhh(a,b,c,null,f,l)}startBatchUpdateScope(){this.N5c=[]}saveShortcutInfoArrayBatch(a,b,c){this.wXk(c,a,b)}wXk(a,b,c){const f={action:"",addinId:"",ownerType:0};f.timestamp=(new Date).toUTCString();const l=this.getShortcutInfoArray(b.toString(),c.toString());a?(f.shortcutInfoArray=a,this.qFd(b,c,a)):l&&(f.shortcutInfoArray=l);a={};a[b.toString()]=f;b=new ZG.a(c.toString(),a);this.N5c.push(b)}commitBatchUpdateScope(){return this.vkc()?this.yXk().then(()=>{this.Ynb();return Promise.resolve(!0)}):
this.AXk().then(()=>{this.Ynb();return Promise.resolve(!0)})}yXk(){return this.getSetting().then(a=>{let b=null;if(a&&!({Hv:b}=fe.d(a)).returnValue)return Z.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);b||(b={});for(const c of this.N5c){(a=b[c.key])||(a={});const f=c.value;for(const l of xa.a.rK(f))a[l]=f[l];b[c.key]=a}this.IX=b;try{return localStorage.setItem("AddinShortcutPreferenceData",fe.c(b)),Promise.resolve(!0)}catch(c){return Z.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",c),Promise.resolve(!1)}})}AXk(){return this.A_k().then(a=>this.led(a))}A_k(){return this.x0d().then(a=>{let b=null;a&&(({Hv:b}=fe.d(a)).returnValue||Z.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));b||(b={});for(const c of this.N5c){(a=b[c.key])||(a={});const f=c.value;for(const l of xa.a.rK(f))a[l]=f[l];b[c.key]=a}this.IX=b;return fe.c(b)})}saveShortcutInfoArray(a,b,
c){return this.Vhh(0,"","",c,a,b)}Vhh(a,b,c,f,l,x){const F=this.vkc(),R={};R.action=c;R.addinId=b;R.ownerType=a;R.timestamp=(new Date).toUTCString();b=this.getShortcutInfoArray(l.toString(),x.toString());0===a&&f?(R.shortcutInfoArray=f,this.qFd(l,x,f)):b&&(R.shortcutInfoArray=b);a={};a[l.toString()]=R;l=new ZG.a(x.toString(),a);return F?this.xXk(l):this.zXk(l)}xXk(a){return this.getSetting().then(b=>{let c=null;if(b&&!({Hv:c}=fe.d(b)).returnValue)return Z.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);c||(c={});c[a.key]=a.value;this.IX=c;try{return localStorage.setItem("AddinShortcutPreferenceData",fe.c(c)),Promise.resolve(!0)}catch(f){return Z.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",f),Promise.resolve(!1)}})}zXk(a){return this.z_k(a).then(b=>this.led(b))}z_k(a){return this.x0d().then(b=>{let c=null;b&&(({Hv:c}=fe.d(b)).returnValue||Z.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
c||(c={});c[a.key]=a.value;this.IX=c;return fe.c(c)})}saveSettings(a){this.IX=fe.a(a);this.Ynb();return this.vkc()?this.Whh(a):this.led(a)}Whh(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(b){return Z.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",b),Promise.resolve(!1)}}led(a){const b={};b.Wac=a;const c=fe.c(b);return new Promise(f=>{try{if(void 0===c||null===c||!c.length||1E6<=c.length)f(!1);else{var l=this.executeRequest(this.Fcg(this.EVk),
2,"SaveAddinShortcutsPreferenceRequest","38",c);l.continueWith(()=>{if(l.Dn||l.Wl)Z.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),f(!1);else{var x=l.result;void 0!==x.Ri&&null!==x.Ri&&void 0!==x.Ri.data&&null!==x.Ri.data&&x.Ri.data.af===Np.a.Yy?f(!0):f(!1)}})}}catch(x){Z.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",x.toString()),f(!1)}})}getSetting(){const a=this.vkc();return this.IX?Promise.resolve(fe.c(this.IX)):a?this.Xbj():
this.x0d()}vkc(){const a=u.AFrameworkApplication.fa.ka("IsAnonymousUser"),b=u.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled");return a||!b}Xbj(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return Z.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}x0d(){return new Promise((a,b)=>{try{const c=this.executeRequest(this.Fcg(this.DVk),1,"GetSettingRequest","37");c.continueWith(()=>{if(c.Dn||c.Wl)Z.ULS.sendTraceTag(522739862,
0,10,"GetSettingFromRoaming : Request failure");else{let l="";var f=c.result;f&&f.Ri&&f.Ri.data?f.Ri.data.af!==Np.a.Yy?Z.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",f.Ri.data.af):f.Ri.data.Zd?(f=fe.a(f.Ri.data.Zd),f.Wac&&(l=f.Wac)):Z.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):Z.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");a(l)}})}catch(c){Z.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",
c.toString()),b("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const b=this.vkc(),c=this;return this.getSetting().then(f=>{let l=null;f&&(l=fe.a(f));if(!l)return Z.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const x of xa.a.rK(l)){f=l[x.toString()];for(const F of xa.a.rK(f)){const R=f[F];if(R.addinId===a)delete f[F.toString()];else if(0===R.ownerType&&R.shortcutInfoArray){const fa=R.shortcutInfoArray,wa=new Ha.a;
for(let Xa=0;Xa<fa.length;++Xa)fa[Xa].addinId!==a&&wa.add(fa[Xa]);R.shortcutInfoArray=wa.toArray()}}xa.a.count(f)||delete f[x]}c.IX=l;c.rNk(a);return b?c.Whh(fe.c(l)):c.led(fe.c(l))})}Ynb(){if(this.IX){this.O6=null;const c=this.IX;for(let f in c){var a=f;const l=c[f];for(let x in l){var b=x;const F=l[x];F.shortcutInfoArray&&this.qFd(parseInt(b),parseInt(a),F.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(a=>{let b=null;if(a&&!({Hv:b}=fe.d(a)).returnValue)return Z.ULS.sendTraceTag(522739868,
0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.IX=b;this.Ynb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(a,b,c){return this.IX&&(c=this.IX[c])&&(b=c[b])&&b.addinId===a?b:null}getShortcutInfoArray(a,b){return this.IX&&(b=this.IX[b])&&(a=b[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,b,c){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(b),c)}setShortcutInfoArray(a,
b,c){return this.saveShortcutInfoArray(parseInt(a),parseInt(b),c).then(()=>{this.Ynb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,b){if(!this.O6)return Promise.resolve(!0);var c=this.O6[a];if(!c)return Promise.resolve(!0);var f=c[b];c=f.modifiers;f=f.keyCode;const l=this.getShortcutInfoArray(c.toString(),f.toString());if(!l||!l.length)return Promise.resolve(!0);let x=0;for(const F of l){if(F.addinId===a&&F.action===b)break;++x}if(x>=l.length)return Promise.resolve(!0);l.splice(x,
1);return this.saveShortcutInfoArray(c,f,l).then(()=>{this.Ynb();return Promise.resolve(!0)})}qFd(a,b,c){this.O6||(this.O6={});for(const f of c){c=f.addinId;const l=f.action;let x=this.O6[c];x||(x={});const F={};F.modifiers=a;F.keyCode=b;x[l]=F;this.O6[c]=x}}rNk(a){a in this.O6&&delete this.O6[a]}isActionCustomized(a,b){return this.O6&&(a=this.O6[a])&&a[b]?!!a[b]:!1}getShortcutByCustomizedAction(a,b){return this.O6&&(a=this.O6[a])?a[b]:null}getShortcutsPreferenceMappingTable(){return this.IX}static instance(){Yq.OGd||
(Z.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),Yq.OGd=new Yq,Yq.Maa=u.AFrameworkApplication.He);return Yq.OGd}}Yq.OGd=null;Yq.Maa=null;Object(e.a)(Yq,"AddinShortcutsPreferenceSettingHelper",null,[]);class $G{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=
this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(e.a)($G,"BrowserInfo",null,[]);class aH{constructor(){this.Version=this.Name=null}}Object(e.a)(aH,"PluginInfo",null,[]);class ak{static vWj(){if(u.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var a=
ak.xVi();try{const b=JSON.stringify(a);Z.ULS.sendTraceTag(6903563,102,50,b)}catch(b){Z.ULS.sendTraceTag(6903564,102,15,b.message)}}else Z.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static G9i(){const a=window.navigator.plugins;if(!a||!a.length)return null;const b=[];for(let c=0;c<a.length;c++){const f=a[c].name,l=a[c].version;Array.add(b,Object.assign(new aH,{Name:f,Version:l}))}return b}static xVi(){const a=new $G,b=new Sys.StringBuilder;ak.sA(c=>{a.DocElemClientHeight=
c},()=>document.documentElement.clientHeight,b);ak.sA(c=>{a.DocElemClientWidth=c},()=>document.documentElement.clientWidth,b);ak.sA(c=>{a.DocElemOffsetHeight=c},()=>document.documentElement.offsetHeight,b);ak.sA(c=>{a.DocElemOffsetWidth=c},()=>document.documentElement.offsetWidth,b);ak.sA(c=>{a.ScreenAvailHeight=c},()=>window.screen.availHeight,b);ak.sA(c=>{a.ScreenAvailWidth=c},()=>window.screen.availWidth,b);ak.sA(c=>{a.ScreenWidth=c},()=>window.screen.width,b);ak.sA(c=>{a.ScreenHeight=c},()=>window.screen.height,
b);ak.sA(c=>{a.ScreenLogicalXdpi=c},()=>window.screen.logicalXDPI,b);ak.sA(c=>{a.ScreenLogicalYdpi=c},()=>window.screen.logicalYDPI,b);ak.sA(c=>{a.ScreenDeviceXdpi=c},()=>window.screen.deviceXDPI,b);ak.sA(c=>{a.ScreenDeviceYdpi=c},()=>window.screen.deviceYDPI,b);ak.sA(c=>{a.WinInnerHeight=c},()=>window.self.innerHeight,b);ak.sA(c=>{a.WinInnerWidth=c},()=>window.self.innerWidth,b);ak.sA(c=>{a.WinOuterHeight=c},()=>window.self.outerHeight,b);ak.sA(c=>{a.WinOuterWidth=c},()=>window.self.outerWidth,b);
ak.sA(c=>{a.WinOrientation=c},()=>window.self.orientation,b);ak.sA(c=>{a.WinDevicePixelRatio=c},()=>window.self.devicePixelRatio,b);ak.sA(c=>{a.SupportsTouch=c},()=>n.a.LIa,b);ak.sA(c=>{a.NavAppName=c},()=>window.navigator.appName,b);ak.sA(c=>{a.NavAppVersion=c},()=>window.navigator.appVersion,b);ak.sA(c=>{a.NavLanguage=c},()=>window.navigator.browserLanguage||window.navigator.language,b);ak.sA(c=>{a.NavUserAgent=c},()=>window.navigator.userAgent,b);ak.sA(c=>{a.NavPlatform=c},()=>window.navigator.platform,
b);ak.sA(c=>{a.NavPlugins=c},ak.G9i,b);ak.sA(c=>{a.CalculatedDevicePixelRatio=c},()=>ak.devicePixelRatio,b);a.Error=b.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/window.screen.logicalXDPI:a}static sA(a,b,c){try{const f=b();a(f)}catch(f){c.isEmpty()||c.append(" | "),c.append(f.message||"null")}}}Object(e.a)(ak,"BrowserInfoLogger",null,[]);class JB{get name(){return"Common.App.BrowserInfoLogger"}Wb(){}init(){ak.vWj()}dispose(){}static main(){m.a.instance.Ac(new JB)}}
Object(e.a)(JB,"BrowserInfoLoggerPackage",null,[2,3]);class KB{get name(){return"Common.App.DialogWithLinkToResource"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Ac(new KB)}}Object(e.a)(KB,"CommonAppDialogWithLinkToResourcePackage",null,[2,3]);var BP=d(693);class LB{get name(){return"Common.App.EventsCachePackage"}Wb(){}init(){BP.a.instance.init()}dispose(){}static main(){m.a.instance.Ac(new LB)}}Object(e.a)(LB,"EventsCachePackage",null,[2,3]);class MB{constructor(a,b,c){this.O1a=null;this.Rd=
a;this.Ca=b;this.o2e=c.create()}Ahc(){this.O1a?Z.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(Z.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.O1a=new He.a(2,1,3E4,Object(D.a)(this,this.bhd,"showFloatPane"),67),this.Rd.Gb(this.O1a))}bhd(){this.O1a=null;Z.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.o2e.display()}Hva(){this.Ca.xa(G.a.bhd,de.a.frame,Object(D.a)(this,this.vbl,
"showFloatPaneHandler"))}vbl(a,b,c,f,l){return a!==G.a.bhd?2:1===c?32:2===c&&l?(Z.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",l),l?this.Ahc():(this.O1a?(Z.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Rd.Qg(this.O1a)):(Z.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.o2e.remove(null)),this.O1a=null),32):8}}Object(e.a)(MB,"FloatPaneActor",null,[1341]);class bH{constructor(a,b,c,f,l){this.twd=
this.aNb=this.Wvc=this.Lya=this.h1=this.Ixa=this.Tod=this.tY=this.xPb=this.AOb=this.BOb=this.fsd=null;this.Rd=b;this.jb=a;this.tn=c;this.Da=l;this.v5=f}xRf(){this.tY=document.createElement("div");this.tY.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.tY.style.width=this.h1.width+"px";(this.twd=this.s8i(this.v5))?(this.Lya=document.createElement("a"),this.Lya.setAttribute(Uc.a.We,Uc.a.wM),this.tn.ob(qa.a.click,this.Lya,Object(D.a)(this,this.j_g,"onRedirectClick")),this.Lya.href=
this.twd,this.Lya.target="_blank",this.Lya.appendChild(this.h1),this.tY.appendChild(this.Lya)):this.tY.appendChild(this.h1);this.Ixa=document.createElement("a");this.Ixa.setAttribute(Uc.a.We,Uc.a.Xt);this.Ixa.className="StandardButton WACFloatPaneCloseButton";this.Ixa.title=CommonUIStrings.l_Close;this.Ixa.tabIndex=-1;this.Tod=kq.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Tod.setAttribute(Uc.a.We,Uc.a.wM);this.Ixa.appendChild(this.Tod);
this.tn.ob(qa.a.click,this.Ixa,Object(D.a)(this,this.onClose,"onClose"));this.tY.appendChild(this.Ixa);this.xPb.appendChild(this.tY)}Yj(a){const b=this.jb.ka("O365PromotionHasStarted");switch(a){case 2:return sp.a.cK(String.format("adppt{0}.png",b?"sale":""));case 1:return sp.a.cK(String.format("adxls{0}.png",b?"sale":""));case 3:return sp.a.cK(String.format("addoc{0}.png",b?"sale":""))}return null}s8i(a){const b=this.jb.Ha("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(b,"Excel");
case 2:return String.format(b,"PowerPoint");case 3:return String.format(b,"Word")}return null}hide(a=null){this.aNb=null;this.tY&&!this.Wvc&&(a?Z.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):Z.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.tY.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.tY.style.height="0px",this.Wvc=new He.a(2,1,1E3,Object(D.a)(this,this.remove,"remove"),67),this.Rd.Gb(this.Wvc))}remove(){this.tY&&
this.xPb&&(this.Lya&&this.tn.xb(qa.a.click,this.Lya,Object(D.a)(this,this.j_g,"onRedirectClick")),this.tn.xb(qa.a.click,this.Ixa,Object(D.a)(this,this.onClose,"onClose")),this.xPb.removeChild(this.tY),this.tY=null);this.Wvc=null}display(){if(this.fsd=this.Da.pb("Common.IFloatPaneContainer"))if(this.xPb=this.fsd.container){var a=this.Yj(this.v5);a?(Z.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.h1=document.createElement("img"),this.h1.className="WACFloatPaneImage",
this.BOb=Object(D.a)(this,this.ulk,"onLoadImageFinish"),yd.a.addHandler(this.h1,qa.a.load,this.BOb),this.AOb=Object(D.a)(this,this.tlk,"onLoadImageError"),yd.a.addHandler(this.h1,qa.a.error,this.AOb),this.h1.src=a):Z.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else Z.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else Z.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}ulk(){const a=
this.jb.Ec("O365AdPaneShowingDuration",60);this.xRf();this.tY.style.display="block";this.tY.style.height=this.h1.height+"px";this.aNb=new He.a(2,1,1E3*a,Object(D.a)(this,this.hide,"hide"),67);this.Rd.Gb(this.aNb);this.$bh()}tlk(){Z.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.$bh();this.h1=null}$bh(){this.BOb&&this.h1&&yd.a.removeHandler(this.h1,qa.a.load,this.BOb);this.BOb=null;this.AOb&&this.h1&&yd.a.removeHandler(this.h1,qa.a.error,this.AOb);
this.AOb=null}j_g(){Z.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.aNb&&this.Rd.Qg(this.aNb);this.hide();return!0}dispose(){this.hide()}}Object(e.a)(bH,"FloatPane",null,[1375]);class NB{constructor(a,b,c,f,l){this.Rd=b;this.jb=a;this.tn=c;this.Da=l;this.v5=f}create(){return new bH(this.jb,this.Rd,this.tn,this.v5,this.Da)}}Object(e.a)(NB,"FloatPaneFactory",null,[1340]);class OB{constructor(){this.Da=null}get name(){return"Common.App.FloatPane"}get ltg(){return u.AFrameworkApplication.fa.ka("O365AdvertisementIsEnabled")&&
u.AFrameworkApplication.fa.ka("IsShowAdvertisementPaneEnabled")}init(){this.ltg&&(Z.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").Ahc(),Z.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").Hva())}Wb(a){this.Da=a;this.ltg&&(this.Da.register(NB,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").na(()=>
new NB(u.AFrameworkApplication.fa,u.AFrameworkApplication.ue,rc.a.instance,u.AFrameworkApplication.Aa.gb.Am,this.Da)).ma(),this.Da.register(MB,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").na(()=>new MB(u.AFrameworkApplication.ue,u.AFrameworkApplication.Ta,this.Da.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ma())}dispose(){}static main(){m.a.instance.Ac(new OB)}}Object(e.a)(OB,"FloatPanePackage",null,[2,3]);const cH=(a,b)=>{a=Math.atan2(b.y-a.y,b.x-a.x);
0>a&&(a+=2*Math.PI);return a};class CP{constructor(a,b,c){this.QO=this.Bjb=this.Ulb=null;this.Cxa=this.oqd=this.Dna=0;this.RF=this.Msc=this.urc=this.trc=!1;this.Btd=this.$4e=this.b5e=0;this.VKa=a;this.Ca=b;this.AY=c}Wu(a){return Gb.App.Fb.Ed.isEditingAllowed?""!==this.LLc(a.Fc):!1}su(a){if(!this.Wu(a))return!1;this.Cxa=this.VKa.GCl();this.u4k(a);this.v4k();({U8d:this.Msc,Aae:this.RF}=this.Plh(this.oqd));this.w4k();this.Ulb=a.VD;this.QO=new Sys.UI.Point(0,0);({width:this.b5e,height:this.$4e}=this.VKa.getDimensions());
Z.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}aw(a){this.Bjb=a.VD;this.nhi();var b=this.QO.x,c=this.QO.y;a=this.b5e;var f=this.$4e,l=this.Msc,x=this.RF,F=1;(b||c)&&a&&f&&(l&&x?(F=a+b,l=f+c,b=1/a,c=1/f,x=b>c?b:c,1>F?F=1:1920<F&&(F=1920),1>l?l=1:1280<l&&(l=1280),b=F-a,c=l-f,F=Math.abs(b/a)>Math.abs(c/f)?F/a:l/f,F<x&&(F=x)):l?(b=a+b,1>b?b=1:1920<b&&(b=1920),F=b/a):x&&(b=f+c,1>b?b=1:1280<b&&(b=1280),F=b/f));a=F;this.Btd=a;this.VKa.lEl(this.Btd,this.Msc,this.RF);return!0}Ln(){this.yh();
Z.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}Nt(){this.VKa.FDl();Z.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}v4k(){this.oqd=(Math.floor((this.Cxa+22)/45)%8+this.Dna)%8}Plh(a){let b,c;if(this.Cxa&&90!==this.Cxa&&180!==this.Cxa&&270!==this.Cxa&&360!==this.Cxa||this.IHj(a))return{U8d:!0,Aae:!0};c=b=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:b=!0}return{U8d:b,Aae:c}}w4k(){this.urc=this.trc=!1;switch(this.oqd){case 0:this.urc=this.trc=!0;break;case 1:case 2:this.urc=
!0;break;case 7:case 6:this.trc=!0}}IHj(a){return!(a%2)}LLc(a){var b=a.className;-1===b.indexOf("WACImageResizeHandle")&&a.parentNode&&(b=a.parentNode.className);a=b.split(" ");for(b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==c)return c}return""}u4k(a){switch(this.LLc(a.Fc)){case "WACImageResizeHandleNW":this.Dna=0;break;case "WACImageResizeHandleN":this.Dna=1;break;case "WACImageResizeHandleNE":this.Dna=2;break;case "WACImageResizeHandleE":this.Dna=
3;break;case "WACImageResizeHandleSE":this.Dna=4;break;case "WACImageResizeHandleS":this.Dna=5;break;case "WACImageResizeHandleSW":this.Dna=6;break;case "WACImageResizeHandleW":this.Dna=7}}nhi(){var a=1;this.AY.instance&&(a=this.AY.instance.S1);const b=(this.Bjb.x-this.Ulb.x)/a;a=(this.Bjb.y-this.Ulb.y)/a;this.QO.x=this.trc?-b:b;this.QO.y=this.urc?-a:a}yh(){const a=new E.DictionaryPropertySet;a.setValue(be.a.vuj,100*this.Btd);a.setValue(be.a.wuj,!0);if(90===this.Cxa||270===this.Cxa){let b,c;({U8d:b,
Aae:c}=this.Plh(this.Dna));a.setValue(be.a.Zkg,b);a.setValue(be.a.$kg,c)}else a.setValue(be.a.Zkg,this.Msc),a.setValue(be.a.$kg,this.RF);this.Ca.Ka(C.a.tuj,2,a)}}Object(e.a)(CP,"ImageResizeDragAdapter",null,[239]);class PB{constructor(a,b){this.Ca=a;this.AY=b}}Object(e.a)(PB,"ImageResizeDragAdapterFactory",null,[1120]);class dH{constructor(a,b,c,f,l,x){this.xlb=this.mwc=this.Etd=this.Bjb=this.Ulb=this.nwc=null;this.Puc=this.zyc=0;this.px=null;this.Un=!1;this.Ca=a;this.Pc=b;this.Eg=c;this.VKa=f;this.AY=
l;this.Ecf=this.mga=0;this.Clb=x}Wu(a){return Gb.App.Fb.Ed.isEditingAllowed&&a?(this.nwc=this.Pc.Dj)?!0:!1:!1}su(a){if(!this.Wu(a))return!1;this.nwc=this.Pc.Dj;if(this.px=W.ImageReader.OBa(this.nwc))return this.Ulb=this.fra(a),this.Etd=Sys.UI.DomElement.getBounds(this.Clb),this.zyc=0<W.ImageReader.p$f(this.px)?W.ImageReader.p$f(this.px):0,this.Puc=W.ImageReader.A4i(this.px),Z.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;Z.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");
return!1}aw(a){this.Bjb=this.fra(a);this.phi();if(this.VKa)return this.VKa.Wvl(this.mga,this.Ecf),Z.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0;Z.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}Ln(){var a=this.mga;a%=360;0>a&&(a+=360);this.zyc=this.mga=a;this.setRotation();Z.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}Nt(){this.VKa.Wvl(this.Puc,0);Z.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")}fra(a){return this.Eg.Xha(a)}phi(){var a=
1;this.AY&&this.AY.instance&&(a=this.AY.instance.S1);var b=new Sys.UI.Point(this.Etd.x+this.Clb.clientWidth/2*a,this.Etd.y+this.Clb.clientHeight/2*a);a=cH(this.Ulb,b);b=cH(this.Bjb,b);this.mga=Math.round(je.a.cO(b-a));0<this.zyc&&(this.mga+=this.zyc-this.Puc);this.Ecf=this.mga;this.mga+=this.Puc}setRotation(){const a=new E.DictionaryPropertySet;a.setValue(be.a.uuj,0);a.setValue(be.a.q2b,this.mga);this.Ca.Ka(C.a.imageRotate,2,a)}dispose(){Z.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");
this.Un||(this.xlb&&(this.mwc&&this.xlb.contains(this.mwc)&&(this.xlb.removeChild(this.mwc),this.mwc=null),this.Clb&&this.Clb.contains(this.xlb)&&(this.Clb.removeChild(this.xlb),this.xlb=null)),this.Un=!0)}}Object(e.a)(dH,"ImageRotateDragAdapter",null,[1129,239,106]);class QB{constructor(a,b,c){this.Ca=a;this.Pc=b;this.AY=c}create(a,b,c){return new dH(this.Ca,this.Pc,a,b,this.AY,c)}}Object(e.a)(QB,"ImageRotateDragAdapterFactory",null,[1114]);class RB{constructor(){this.Da=null}get name(){return"Box4.Images"}Wb(a){this.Da=
a;this.Da.register(PB,"Box4.Images.ImageResizeDragAdapterFactory").as("Box4.Images.IImageResizeDragAdapterFactory").ma().na(()=>new PB(u.AFrameworkApplication.Ta,hb.a.instance.La("Common.IZoomManager")));this.Da.register(QB,"Box4.Images.ImageRotateDragAdapterFactory").as("Box4.Images.IImageRotateDragAdapterFactory").ma().na(()=>new QB(u.AFrameworkApplication.Ta,ld.a.instance,hb.a.instance.La("Common.IZoomManager")))}init(){this.Da.resolve("Box4.Images.IImageRotateDragAdapterFactory")}dispose(){}static main(){m.a.instance.Ac(new RB)}}
Object(e.a)(RB,"Box4ImagesPackage",null,[2,3]);class eH{create(a){return new od.a(a)}}Object(e.a)(eH,"Factory",null,[1149]);var Uy=d(430);class fH{constructor(){this.Fi=null}get key(){return"COMMENTTEXTANCHOR"}get G6(){return Box4Intl.Box4Strings.l_CommentContentTitle}reset(a){this.Fi=Object(va.a)(te.AParagraphNode,a.node)}Nmc(a){a=(a=this.j_i(a))?Object.assign(new Uy.a,{K_:this.key,iP:a}):null;return{returnValue:!!a,sza:a}}j_i(a){if(!this.Fi.Ra)return null;const b=new Ha.a;for(let c=0;c<this.Fi.Ra.length;c++){const f=
this.Fi.Ra.ga(c);if(f.cp>a)break;if(f.tg)for(let l=0;l<f.tg.length;l++){const x=f.tg.ga(l);x.fk?b.add(x.KH.lq.toString()):b.remove(x.KH.lq.toString())}}return 0<b.count?b.ga(0):null}}Object(e.a)(fH,"CommentTextAnchorDetailsProvider",null,[691,397]);class fx{constructor(){this.Fi=null}get G6(){return null}getTitle(){return null}C8f(){return null}reset(a){this.Fi=a.node}Nmc(a){const b=fg.d(this.Fi,a);a=null;if(!b||b.Eq!==this.Eq)return{returnValue:!1,sza:a};a=Object.assign(new Uy.a,{K_:this.key,iP:b,
title:this.getTitle(b),description:this.C8f(b)});return{returnValue:!0,sza:a}}}Object(e.a)(fx,"BlobDetailsProvider",null,[691,397]);class gH extends fx{constructor(){super()}get key(){return"EQUATION"}get Eq(){return 11}get G6(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(e.a)(gH,"EquationDetailsProvider",fx,[]);class hH{constructor(){this.L4e=null}get key(){return"LINK"}get G6(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.L4e=Rb.HyperlinkReader.B_b(a.node)}Nmc(a){let b;
b=null;for(const c of this.L4e)if(c.Qa<=a&&a<c.Kb)return b=Object.assign(new Uy.a,{K_:this.key,iP:c.hyperlink}),{returnValue:!0,sza:b};return{returnValue:!1,sza:b}}}Object(e.a)(hH,"HyperlinkDetailsProvider",null,[691,397]);class iH extends fx{constructor(){super()}get key(){return"IMAGE"}get Eq(){return 5}get G6(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return W.ImageReader.QLc(a.properties)}C8f(a){return W.ImageReader.hZd(a.properties)}}Object(e.a)(iH,"ImageDetailsProvider",fx,
[]);class Vy{constructor(){this.description=this.contentId=this.iP=this.K_=null}}Object(e.a)(Vy,"StructuralContentDetails",null,[438]);class jH{get key(){return"IMAGENODE"}get G6(){return Box4Intl.Box4Strings.l_ImageContentTitle}eRe(a){let b;b=null;if(!a||!W.ImageReader.wG(a.currentNode))return{returnValue:!1,gpb:b};b=Object.assign(new Vy,{K_:this.key,contentId:a.currentNode.id,iP:a.currentNode});return{returnValue:!0,gpb:b}}bLc(a,b){a=a.iP;const c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
let f="";b&&a.id===b.iP.id||(f=String.format(c,W.ImageReader.QLc(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return f}}Object(e.a)(jH,"ImageNodeDetailsProvider",null,[396,397]);let gx,hx;class Jr{constructor(a,b){this.m1e=null;this.lm=b;this.Dzd=a;this.eOb=Jr.keys.ga(a);this.kJh=Jr.oti.ga(a)}get key(){return this.eOb}get G6(){return this.kJh}reset(a){this.m1e=this.lm.RE(a.node)}Nmc(a){var b=Jr.kSi(this.m1e||[],c=>this.mEj(a,c));b=this.lwi(b);return{returnValue:!!b,sza:b}}mEj(a,b){return b.begin<=
a&&a<b.end&&(!b.Dh||this.Dzd===b.Dh.proofingType)}lwi(a){return a?Object.assign(new Uy.a,{K_:this.key,iP:a.Dh,description:this.SXd()}):null}SXd(){return u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static kSi(a,b){for(const c of a)if(b(c))return c;return null}}Jr.keys=(hx=new Xb.a,hx.add(1,"SPELLINGERROR"),hx.add(2,"GRAMMATICALERROR"),hx.add(3,"ADVANCEDERROR"),hx);Jr.oti=(gx=new Xb.a,
gx.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),gx.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),gx.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),gx);Object(e.a)(Jr,"ProofingDetailsProvider",null,[691,397]);class kH{constructor(){this.tableNode=null;this.rDc=this.Rdd=this.columns=this.rows=0}}Object(e.a)(kH,"TableInfo",null,[]);var Nn=d(145),Dd=d(83),ik=d(125);class lH{get key(){return"TABLE"}get G6(){return Box4Intl.Box4Strings.l_TableContentTitle}eRe(a){var b=
null;if(!De.isTableCell(a))return{returnValue:!1,gpb:b};b=new mb.GraphIterator;b.Nc(a);a=new kH;a.Rdd=ik.c(b)+1;a.rDc=Nn.a(b)+1;Dd.returnToContainingTable(b);a.tableNode=b.currentNode;a.columns=xd.TableReader.ui(a.tableNode);a.rows=xd.TableReader.$j(a.tableNode);b=Object.assign(new Vy,{K_:this.key,contentId:a.tableNode.id,iP:a});return{returnValue:!0,gpb:b}}bLc(a,b){a=a.iP;const c=new Hf.a;b||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));b&&b.iP.rDc===a.rDc||
c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.rDc));b&&b.iP.Rdd===a.Rdd||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.Rdd));return c.toArray().join(" ")}}Object(e.a)(lH,"TableDetailsProvider",null,[396,397]);class SB{constructor(a,b){this.QLh=a;this.lm=b}UCe(){this.QLh.execute(a=>{a.VWa(new hH);a.VWa(new Jr(1,this.lm));a.VWa(new Jr(2,this.lm));a.VWa(new Jr(3,this.lm));a.VWa(new gH);a.VWa(new iH);a.VWa(new fH);a.dDe(new lH);a.dDe(new jH)})}}
Object(e.a)(SB,"AccessibilityActor",null,[]);class TB{constructor(a,b,c){this.vRb=a;this.hd=b;this.EHh=c}ub(){this.vRb.pa(C.a.Zpk,Fb.a.view,Object(D.a)(this,this.$pk,"openAutoCorrectOptionsView"),1028)}$pk(a,b,c){if(1===c)return 32;this.EHh().zkc();return 32}}Object(e.a)(TB,"AutoCorrectActor",null,[]);class UB{constructor(a){this.kOh=a}XJj(a){if(!a||!a.Nv||1>a.Nv.count)return!1;const b=[mc.a.aCi,mc.a.$Bi];return!!this.NKc(a.Nv,1,c=>this.YDc(c,b))}wsg(a){return!a||!a.Nv||1>a.Nv.count?!1:!!this.NKc(a.Nv,
1,b=>this.YDc(b,[mc.a.OM]))}qHj(a){return!a||!a.Nv||1>a.Nv.count?!1:!!this.NKc(a.Nv,2,b=>this.YDc(b,[mc.a.F5b]))}Lk(a){return!a||!a.Nv||1>a.Nv.count?!1:!!this.NKc(a.Nv,1,b=>this.YDc(b,[mc.a.Pda]))}cSc(a){if(!a||!a.Nv)return!1;a=a.Nv;for(let b=0;b<a.count;++b)if(!a.ga(b)||0<a.ga(b).jai)return!1;return!0}EMi(a,b){return this.wsg(b)||this.qHj(b)?"":a}get XSc(){return this.kOh}NKc(a,b,c){if(a&&0<a.count)for(let f=a.count-1;0<=f;--f){if(c(a.ga(f)))return a.ga(f);if(a.count-f>=b)break}return null}YDc(a,
b){a=a&&a.nkg?a.nkg.split(" "):null;if(!a)return!1;for(const c of b)if(0<=Array.indexOf(a,c))return!0;return!1}}Object(e.a)(UB,"Box4PasteStewardUtils",null,[1177]);class mH{constructor(){this.XX=0;this.bwb=Array(9)}}Object(e.a)(mH,"FullListMetadata",null,[]);class Wy{constructor(){this.level=0;this.GJa=null;this.XX=0;this.tPi=this.Udc=null;this.YCb=!1}}Object(e.a)(Wy,"ListItemMetadata",null,[]);class Nt{constructor(){this.aY=[]}b8f(){const a=new Nt;for(let b=0;b<this.aY.length;b++)a.add(this.ga(b));
return a}get count(){return this.aY.length}ga(a){return this.aY[a]}$(a,b){return this.aY[a]=b}add(a){Array.add(this.aY,a)}clear(){Array.clear(this.aY)}contains(a){return Array.contains(this.aY,a)}indexOf(a){return Array.indexOf(this.aY,a)}insert(a,b){Array.insert(this.aY,a,b)}remove(a){return Array.remove(this.aY,a)}removeAt(a){Array.removeAt(this.aY,a)}removeRange(a,b){for(let c=0;c<b;c++)Array.removeAt(this.aY,a)}reverse(){this.aY.reverse()}sort(){this.aY.sort()}toArray(){return Array.clone(this.aY)}}
Object(e.a)(Nt,"List",null,[]);class nH{constructor(){this.level=0;this.tagName="UL";this.IVa=null;this.ignore=!1;this.Ccc=0;this.listStyle="BulletListStyle1";this.Y7=new Nt;this.font=this.levelText=""}}Object(e.a)(nH,"ListLevelMetadata",null,[]);class VB{constructor(){this.bAg={};this.AFc=-1}}Object(e.a)(VB,"LevelLists",null,[]);class WB{constructor(a){this.nodes=a;this.Q1=0;this.lists={};this.Y7=[];this.Tvb=null;this.tha=[];this.tha[0]=new VB}}Object(e.a)(WB,"WordConverterArguments",null,[]);class oH{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(e.a)(oH,"AbsolutePosition",null,[]);class nn{constructor(a,b,c,f,l){this.cultureName=this.o4=this.Nv=this.xT=null;a&&(this.xT=a);b&&(this.Nv=b);this.o4=c?c:new Ha.a;f&&""!==f&&(this.cultureName=f);this.zga=l}}Object(e.a)(nn,"GlobalAttributesArgs",null,[]);class Ot{constructor(a,b,c="",f=0){this.Av=!1;this.C4e=this.D4e=null;let l=!1;Ot.NGj(a)&&(l=!0,this.D4e=a);Ot.aHj(b)&&(this.C4e=b);this.HMh=c;this.AHh=f;this.Av=l&&this.b2b?!0:!1}get isValid(){return this.Av}get pkg(){return this.D4e}get b2b(){return this.C4e}get nkg(){return this.HMh}get jai(){return this.AHh}static NGj(a){return a?
-1===a.indexOf(" ")&&0<a.length:!0}static aHj(a){return a?-1===a.indexOf(" ")&&0<a.length:!1}}Object(e.a)(Ot,"HtmlElementInfo",null,[]);class pH{constructor(a){this.next=null;this.data=a}}Object(e.a)(pH,"StackNode",null,[]);class ix{constructor(){this.Fu=null;this.Gk=0}get count(){return this.Gk}get isEmpty(){return!this.Gk||!this.Fu}push(a){a=new pH(a);a.next=this.Fu;this.Fu=a;this.Gk++}peek(){return this.isEmpty?null:this.Fu.data}pop(){if(this.isEmpty)return null;const a=this.Fu;this.Fu=a.next;
this.Gk--;return a.data}clear(){this.Fu=null;this.Gk=0}toArray(){const a=Array(this.count);let b=this.Fu;for(let c=this.count-1;0<=c&&b;c--)a[c]=b.data,b=b.next;return a}}Object(e.a)(ix,"Stack",null,[]);class Tg{constructor(a){this.JMb=this.Guc=null;this.Oqc=!1;this.Dg=a}get hOa(){return this.JMb.peek()}reset(){this.Dg.reset();this.Guc=new ix;this.JMb=new ix;this.JMb.push(this.Dg.eXb);this.Oqc=!1}s6c(){this.Oqc=!1}nC(a){this.Oqc||(this.Guc.push(null),this.Oqc=!0);this.Guc.push(a)}onClose(){for(;;){const a=
this.Guc.pop();if(!a)break;a()}}Fkh(){return!1}Sfk(){this.mq(()=>!0)}mq(a){const b=this.hOa.clone();return a(b)?(this.JMb.push(b),this.Dg.xla(b),this.nC(Object(D.a)(this,this.Xjk,"onFormattingEnd")),!0):!1}z2d(a){return a.style?this.mq(b=>this.Fkh(b,a))?1:2:2}Xjk(){this.JMb.pop();this.Dg.xla(this.hOa)}I_(){}l6c(){return 2}Lte(){return 2}Mte(){return 2}Nte(){return 2}Ute(){return 3}Xte(){}q6c(){return 2}Yte(){}Zte(){}$te(){return 2}w6c(){return 2}x6c(){return 2}nue(){return 2}y6c(){}rue(){return 2}z6c(){return 2}B6c(){return 2}E6c(){return 2}G6c(){return 2}Due(){}Eue(){return 2}J6c(){return 2}K6c(){return 2}M6c(){return 2}N6c(){return 2}P6c(){return 2}Q6c(){return 2}R6c(){return 2}U6c(){return 2}Yue(){return 2}b7c(){return 2}dve(){return 2}eve(){}fve(){return 2}g7c(){return 2}h7c(){return 2}i7c(){return 2}j7c(){return 2}k7c(){return 2}l7c(){return 2}jve(){return 3}m7c(){}lve(){return 2}n7c(){return 2}nve(){return 3}o7c(){}pve(){}p7c(){return 2}wve(){return 3}q7c(){return 2}s7c(){return 2}u7c(){return 2}v7c(){return 2}zve(){}Ave(){return 3}z7c(){return 2}gCb(){return 2}Cve(){}Fve(){return 2}Gve(){return 2}Hve(){return 3}G7c(){return 2}Ive(){return 2}K7c(){return 2}N7c(){return 2}Kve(){}Z7c(){return 2}Uve(){return 2}g8c(){return 2}h8c(){return 2}ewe(){return 3}fwe(){return 2}r8c(){return 2}s8c(){return 2}t8c(){return 2}u8c(){return 2}lwe(){return 3}v8c(){return 2}w8c(){return 2}A8c(){return 2}owe(){return 2}Hdc(){return 2}qwe(){return 2}rwe(){return 2}B8c(){return 2}swe(){return 2}uwe(){return 3}C8c(){return 2}F8c(){return 2}G8c(){return 2}H8c(){return 2}J8c(){return 2}static rra(a){return a&&
-1!==a.indexOf("px")&&(a=parseInt(Ma.a.substring(a,0,a.indexOf("px"))),!isNaN(a))?a:0}static Mcj(a){if(!a||""===a)return-1;const b=Ma.a.sg(a);if(-1!==b.indexOf("pt")){if(a=parseFloat(Ma.a.substring(a,0,b.indexOf("pt"))),!isNaN(a))return a}else if(-1!==b.indexOf("px")&&(a=parseFloat(Ma.a.substring(a,0,b.indexOf("px"))),!isNaN(a)))return 3*a/4;return-1}static Vbg(a){return a&&""!==a?Tg.rra(a):null}static Qx(a){let b=null,c=null,f=null,l=null;a&&a.Tf&&(b=Tg.jra(a.Tf,"id"),c=Tg.jra(a.Tf,"lang"),f=a.Tf.tagName,
a.M8h&&(l=Object.assign(new oH,{x:Tg.rra(a.Tf.style.left),y:Tg.rra(a.Tf.style.top),left:Tg.Vbg(a.Tf.style.left),top:Tg.Vbg(a.Tf.style.top)})),void 0===b&&(b=""),void 0===c&&(c=""));return new nn(new Ot(b,f),a.Nv,null,c,l)}static jra(a,b){return a[b]}}Object(e.a)(Tg,"AHtmlTranslator",null,[1206]);class qH extends nn{constructor(a,b,c,f=0,l=0,x=null){super(x?x.xT:null,x?x.Nv:null,x?x.o4:null,x?x.cultureName:null,x?x.zga:null);this.width=f;this.height=l}}Object(e.a)(qH,"AugmentationSemanticArgs",nn,
[]);class rH{constructor(){this.stop=this.color=null}}Object(e.a)(rH,"ColorStopPair",null,[]);class Xy{constructor(a,b){this.value=a;this.LUi=b}get dSc(){return this.LUi}}Object(e.a)(Xy,"ElementValueWrapper",null,[]);class sH extends Xy{constructor(a,b,c){super(a,b);this.dwg=c}}Object(e.a)(sH,"DimensionWrapper",Xy,[]);class XB{constructor(a=0,b=0,c=0,f=0,l="",x="",F="",R="",fa="0pt",wa="0pt",Xa="0pt",lb="0pt"){this.borderTopStyle=a;this.borderRightStyle=b;this.borderBottomStyle=c;this.borderLeftStyle=
f;this.borderTopColor=l;this.borderRightColor=x;this.borderBottomColor=F;this.borderLeftColor=R;this.borderTopWidth=fa;this.borderRightWidth=wa;this.borderBottomWidth=Xa;this.borderLeftWidth=lb}}Object(e.a)(XB,"TableCellBorderProperties",null,[]);class YB{constructor(a="",b="",c="",f=""){this.Aji=a;this.zji=b;this.xji=c;this.yji=f}}Object(e.a)(YB,"TableCellMarginProperties",null,[]);class Cg{static get okg(){return Cg.JMh}static get Zid(){return Cg.cWh}static get Qid(){return Cg.aWh}static Q1d(a,
b,...c){b=Cg.qfg(b);let f=!1;b||(b=Cg.$gj.apply(null,[a].concat(c)),f=!!b);return new Xy(b,f)}static qfg(a){for(const b of a)if(void 0!==b&&null!==b&&""!==b)return b.trim();return null}static $gj(a,...b){for(const c of b)if(b=a.getAttribute(c),void 0!==b&&null!==b&&(b+="",void 0!==b&&null!==b&&""!==b))return b.trim();return null}static B9i(a,b){b=parseFloat(b);if(isNaN(b))return 0;switch(a){case "px":return Math.round(b);case "pt":return Math.round(Fd.a.Wda(b,0,!1));case "in":return Math.round(Fd.a.sZ(b,
0,!1));case "cm":return Math.round(Fd.a.sZ(je.a.VLf(b),0,!1));case "mm":return Math.round(Fd.a.sZ(je.a.VLf(.1*b),0,!1));default:return b}}static udd(a,b,...c){a=Cg.Q1d.apply(null,[a,b].concat(c));c=0;b=!1;if(a.value){b=a.value.endsWith("%");let f;b?(c="%",f=Ma.a.substring(a.value,0,a.value.length-1)):a.dSc?(c="px",f=a.value):(c=a.value.substr(a.value.length-2),isNaN(parseFloat(c))?f=Ma.a.substring(a.value,0,a.value.length-2):(c="px",f=a.value));c=Cg.B9i(c,f)}return new sH(c,a.dSc,b)}static Qsb(a){return Cg.udd(a,
[a.style.width],"width","WIDTH","Width")}static l6a(a){return Cg.udd(a,[a.style.height],"height","HEIGHT","Height")}static VZd(a){return Cg.udd(a,[a.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static WZd(a){return Cg.udd(a,[a.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static fhj(a){a=Cg.Q1d(a,[a.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return a.value&&a.value in Cg.Zid&&void 0!==Cg.Zid[a.value]&&null!==Cg.Zid[a.value]?Cg.Zid[a.value]:0}static gOj(a){a=
Cg.qfg([a.style.borderCollapse]);return!!a&&!(void 0===a||null===a)&&("collapse"===a||"COLLAPSE"===a||"Collapse"===a)}static hYi(a){return Cg.Q1d(a,[a.style.backgroundColor,a.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static Zti(a){const b=Ma.a.substring(a,0,1),c=Ma.a.substring(a,1,2);a=Ma.a.substring(a,2,3);return b+b+c+c+a+a}static lha(a){let b="";if(!a||""===a)return b;b=a.trim();if(b.startsWith("rgb")){b=Ma.a.substring(b,b.indexOf("(")+1,b.length-1);a=b.split(",");if(3!==
a.length)return"";b="";for(let f=0;f<a.length;f++){var c=parseInt(a[f]);if(isNaN(c)||0>c||255<c)return"";c=c.toString(16);1===c.length&&(c="0"+c);b+=c}return Ma.a.cB(b)}if(Cg.okg[Ma.a.sg(b)])return Cg.okg[Ma.a.sg(b)];b.startsWith("#")&&(b=Ma.a.substring(b,1,b.length));if(isNaN(parseInt(b,16)))return"";3===b.length&&(b=Cg.Zti(b));return 6!==b.length?"":b}static ntk(a){var b=a.indexOf("mso-tab-count");if(-1===b)return 0;const c=RegExp("([\\d])");let f="";for(b=b+13+1;b<a.length;b++){const l=a.charAt(b).toString();
if(c.test(l))f+=l;else break}a=0;""!==f&&(a=parseInt(f));return a}static pOc(a,b){const c=Cg.hYi(a);c&&""!==c&&b.mq(f=>f.efd(Cg.lha(c)))}static e7f(a){a=a.style;if(!a)return null;const b=Cg.Qid[a.borderTopStyle],c=Cg.lha(a.borderTopColor),f=a.borderTopWidth,l=Cg.Qid[a.borderRightStyle],x=Cg.lha(a.borderRightColor),F=a.borderRightWidth,R=Cg.Qid[a.borderBottomStyle],fa=Cg.lha(a.borderBottomColor),wa=a.borderBottomWidth,Xa=Cg.Qid[a.borderLeftStyle],lb=Cg.lha(a.borderLeftColor);return new XB(b,l,R,Xa,
c,x,fa,lb,f,F,wa,a.borderLeftWidth)}static aZi(a){const b=a.firstChild;return(a=b&&b.className&&-1!==b.className.indexOf("TableCellContent")?a.firstChild.style:a.style)?new YB(a.paddingTop,a.paddingRight,a.paddingBottom,a.paddingLeft):null}}Cg.JMh=xa.a.gH("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood",
"DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B",
"darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo",
"4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00",
"limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500",
"orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD",
"slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");Cg.cWh=xa.a.gH("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);Cg.aWh=xa.a.gH("",0,"initial",3,"inherit",
11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(e.a)(Cg,"DefaultHtmlTranslatorHelper",null,[]);class tH{constructor(){this.direction=null;this.tVb=new Nt}Oig(){return!!this.direction&&0<this.direction.length}}Object(e.a)(tH,"LinearGradient",null,[]);class ZB{constructor(){this.tRc=!1}}Object(e.a)(ZB,"HtmlTranslatorContext",null,[]);class $B{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,x=!1,F=!0,R=!1,fa=!0,wa=!0,Xa=!0,lb=!1,Lb=!1,
kc=!1,lc=!1,Ec=!1,Jc=!1,Dc=null,Wd=null,xe=null,Sd=null,Pe=null,Ue=null,Ef=null){this.tRc=!1;this.QRh=a;this.VRh=b;this.NRh=c;this.URh=f;this.GUh=l;this.EUh=x;this.zUh=F;this.AUh=R;this.CUh=fa;this.DUh=wa;this.BUh=Xa;this.PUh=lb;this.dVh=Lb;this.OUh=kc;this.SVh=lc;this.JUh=Ec;this.fNh=Jc;this.IUh=Dc;this.NUh=Wd;this.FUh=Pe;this.LUh=xe;this.HUh=Sd;this.KUh=Ue;this.MUh=Ef}get sWa(){return this.QRh}get duk(){return this.VRh}get n3g(){return this.NRh}get cuk(){return this.URh}get ooh(){return this.GUh}get noh(){return this.EUh}get $8k(){return this.zUh}get a9k(){return this.AUh}get c9k(){return this.CUh}get e9k(){return this.DUh}get b9k(){return this.BUh}get kYa(){return this.JUh}get Qyj(){return this.fNh}get soh(){return this.PUh}get K$k(){return this.dVh}get m9k(){return this.OUh}get mil(){return this.SVh}get poh(){return this.IUh||
Object(D.a)(this,this.ydd,"returnFalse")}get l9k(){return this.NUh||Object(D.a)(this,this.ydd,"returnFalse")}get k9k(){return this.LUh||Object(D.a)(this,this.tFe,"returnTrue")}get g9k(){return this.HUh||Object(D.a)(this,this.tFe,"returnTrue")}get f9k(){return this.FUh||Object(D.a)(this,this.ydd,"returnFalse")}get j9k(){return this.KUh||Object(D.a)(this,this.tFe,"returnTrue")}get roh(){return this.MUh||Object(D.a)(this,this.ydd,"returnFalse")}tFe(){return!0}ydd(){return!1}}Object(e.a)($B,"HtmlTranslatorSettings",
null,[262]);class uH extends nn{constructor(a,b,c,f,l=null,x=0,F=0,R=null,fa=null){super(l?l.xT:null,l?l.Nv:null,l?l.o4:null,l?l.cultureName:null,l?l.zga:null);this.src=a;this.alt=b;this.width=c;this.height=f;this.maxWidth=x;this.maxHeight=F;this.href=R;this.desc=fa}}Object(e.a)(uH,"ImageSemanticArgs",nn,[]);class vH{constructor(a,b){this.pfl=a;this.ofl=b}}Object(e.a)(vH,"IndentationProperties",null,[]);class jx extends nn{constructor(a,b,c,f=0,l=-1,x=!1,F=!1,R="",fa="",wa=null,Xa=-1){super(c?c.xT:
null,c?c.Nv:null,c?c.o4:null,c?c.cultureName:null,c?c.zga:null);this.Pff=a;this.xOb=0;this.mCd=b;this.zNb=1===b&&-1===l&&!this.L_a;this.uwd=f;this.vwd=l;this.Ryd=x;this.L_a=F;this.D0a=R;this.Jjb=fa;this.spc=wa;this.cpc=Xa;this.hjb=-1;this.lyc=!0}get listStyleType(){return this.nIj?this.xOb:this.Pff}get nIj(){return 0!==this.xOb}get Igl(){return this.mCd}get listLevel(){return this.vwd}set listLevel(a){this.vwd=a}get listId(){return this.uwd}set listId(a){this.uwd=a}get YCb(){return this.Ryd}set YCb(a){this.Ryd=
a}get i5a(){return this.L_a}set i5a(a){this.L_a=a}get levelText(){return this.D0a}set levelText(a){this.D0a=a}get font(){return this.Jjb}set font(a){this.Jjb=a}get ENa(){return this.spc}set ENa(a){this.spc=a}get Wnb(){return this.cpc}set Wnb(a){this.cpc=a}get lug(){return 6<=this.listStyleType}get qCj(){return this.zNb}get oCi(){return this.lyc?this.mCd+this.hjb:this.hjb}clone(){const a=new jx(this.Pff,this.mCd,new nn(this.xT,this.Nv,this.o4,this.cultureName,this.zga),this.uwd,this.vwd,this.Ryd,this.L_a);
a.xOb=this.xOb;a.zNb=this.zNb;a.hjb=this.hjb;a.lyc=this.lyc;a.D0a=this.D0a;a.Jjb=this.Jjb;a.spc=this.spc;a.cpc=this.cpc;return a}j9h(a,b,c){this.xOb=a;0<b?(this.zNb=!1,this.hjb=b,this.lyc=!1):(this.hjb++,this.zNb=!c)}}Object(e.a)(jx,"ListSemanticArgs",nn,[]);class Yy extends nn{constructor(a,b,c,f,l=null,x=0,F=null,R=null,fa=!1,wa=!1,Xa=69905,lb=null){super(lb?lb.xT:null,lb?lb.Nv:null,lb?lb.o4:null,lb?lb.cultureName:null,lb?lb.zga:null);this.colSpan=a;this.rowSpan=b;this.width=c;this.tvb=wa;this.height=
f;this.qDa=fa;this.Rjc=l;this.verticalAlignment=x;this.Z4=F;this.Vid=R;this.qCc=Xa}}Object(e.a)(Yy,"TableCellSemanticArgs",nn,[]);class aC extends nn{constructor(a,b=null){super(b?b.xT:null,b?b.Nv:null,b?b.o4:null,b?b.cultureName:null,b?b.zga:null);this.height=a}}Object(e.a)(aC,"TableRowSemanticArgs",nn,[]);class bC extends nn{constructor(a,b,c,f,l,x,F,R,fa,wa=null,Xa=-1,lb=null){super(lb?lb.xT:null,lb?lb.Nv:null,lb?lb.o4:null,lb?lb.cultureName:null,lb?lb.zga:null);this.KNa=null;this.wX=a;this.Spa=
b;this.width=c;if(l)for(this.KNa=Array(l.length),a=0;a<l.length;++a)this.KNa[a]=l[a];this.prg=x;this.yOe=R;this.JCj=F;this.qDa=f;this.m5d=fa;this.Ath=wa;this.tableLook=Xa}}Object(e.a)(bC,"TableSemanticArgs",nn,[]);let Kr;class Jk extends Tg{constructor(a,b=null,c=null,f=null){super(a);this.I0a=null;this.yPh=xa.a.gH("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",
9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Gc=b||new $B;this.Bu=c||new ZB;this.xwd=f}get Yzg(){return this.yPh}iag(a,b){var c;if((c=a.style?a.style.listStyleType:"")&&""!==c&&(c=this.Yzg[Ma.a.sg(c)])||(c=Tg.jra(a,"type"))&&""!==c&&(c=this.Yzg[c]))return c;if(this.Gc.sWa&&(c=a.tagName.toLowerCase())&&("ol"===c||"ul"===c)&&(a=a.className)&&""!==a)if("ul"===c)switch(a=Jk.GNc(a,"BulletListStyle"),a){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===
c)switch(a=Jk.GNc(a,"NumberListStyle"),a){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return b}bag(a){let b=-1,c=a.tagName.toLowerCase();if("ol"===c||"ul"===c){a=Ba.a.s9f(a,"li");if(!a)return b;c="li"}if("li"===c){b=(b=this.uKc(a,"data-aria-level",0))?b:-1;if(0<b)return b-1;if(a=Ba.a.s9f(a,"p"))return Jk.c6i(a)-1}return b}uKc(a,b,c){a=this.Gc.sWa?a.getAttribute(b):Tg.jra(a,b);
a=parseInt(a);return isNaN(a)||0>a?c:a}plk(){this.I0a.pop();this.Dg.Ala()}m1b(a,b){this.mq(l=>l.hIa(0,0));const c=this.iag(a.Tf,b?6:2);let f=1;b&&(f=this.uKc(a.Tf,"start",1));b=!1;this.Gc.sWa&&(b=a.Tf.getAttribute("data-pasteFromRc"),(b=!!b&&"true"===b)&&a.Tf.removeAttribute("data-pasteFromRc"),(n.a.AS||n.a.$f)&&Jk.WCc(a.Tf));a=new jx(c,f,Tg.Qx(a),0,-1,b,this.Gc.sWa);this.I0a.push(a);this.Dg.Cla(a);this.nC(Object(D.a)(this,this.plk,"onListElementClose"));return 1}reset(){super.reset();this.I0a=new ix}Fkh(a,
b){let c=!1;try{var f=b.getAttribute("xml:lang")||Tg.jra(b,"lang")}catch(R){f=null}f&&""!==f&&(c=a.rIe(f)||c);(f=Tg.jra(b,"dir"))&&(c=a.yGb(f)||c);if(f=b.style){if(f.fontWeight){var l=Ma.a.cB(f.fontWeight),x=parseInt(l);isNaN(x)?"BOLD"===l?c=a.hJ(!0)||c:"NORMAL"===l&&(c=a.hJ(!1)||c):c=600<=x?a.hJ(!0)||c:a.hJ(!1)||c}this.Gc.noh&&f.fontSize&&(l=Tg.Mcj(f.fontSize),0<l&&(c=u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PasteKeepSourceFontSizeFixIsEnabled")?a.OFb(Math.floor(2*l))||c:a.sfd(Math.floor(2*
l))||c));this.Gc.k9k(this.Bu)&&(this.Gc.soh&&b.getAttribute?(l=b.getAttribute("data-indent"))&&0<l.length&&(l=Fd.a.nJ(parseInt(l),0)+"px",c=a.Zfd(l)||c):f.textIndent&&(c=a.Zfd(f.textIndent)||c));this.Gc.g9k(this.Bu)&&f.marginLeft&&(this.Gc.soh&&b.getAttribute?(l=b.getAttribute("data-margin"))&&0<l.length&&(c=a.vjc(f.marginLeft)||c):"TABLE"!==b.tagName&&(c=a.vjc(f.marginLeft)||c));this.Gc.f9k(this.Bu)&&f.lineHeight&&(c=a.c0(f.lineHeight)||c);if(this.Gc.b9k)if(l=f.fontVariantCaps?Ma.a.sg(f.fontVariantCaps):
null,x=f.fontVariant?Ma.a.sg(f.fontVariant):null,"uppercase"===(f.textTransform?Ma.a.sg(f.textTransform):null))c=a.Yfd("uppercase")||c;else if("small-caps"===l||x&&0<=x.indexOf("small-caps"))c=a.Yfd("small-caps")||c;this.Gc.j9k(this.Bu)&&f.textAlign&&(c=a.Mfb(Ma.a.sg(f.textAlign))||c);f.fontStyle&&(l=Ma.a.cB(f.fontStyle),"ITALIC"===l||"OBLIQUE"===l?c=a.QXa(!0)||c:"NORMAL"===l&&(c=a.QXa(!1)||c));l=Jk.dfj(b);if(f.textDecoration||l){x=Ma.a.sg(f.textDecoration||"");l=Ma.a.sg(l||"");if(b.parentNode&&b.parentNode.tagName&&
"a"===Ma.a.sg(b.parentNode.tagName)){var F=(b.querySelector(".TextRun")||b).className;F&&-1<F.indexOf("Underlined")&&(c=a.e0(!0)||c)}else if(f.fEl||Jk.pD(x)||Jk.pD(l))c=a.e0(!0)||c;if(f.eEl||Jk.kug(x)||Jk.kug(l))c=a.EX(!0)||c}if(f.verticalAlign){l=Ma.a.cB(f.verticalAlign);if("SUB"===l||this.Gc.roh(this.Bu)&&b.className&&-1<b.className.indexOf("Subscript"))c=a.L4(!0)||c;else if("SUPER"===l||this.Gc.roh(this.Bu)&&b.className&&-1<b.className.indexOf("Superscript"))c=a.GX(!0)||c;this.Gc.noh&&("SUB"===
l||"SUPER"===l)&&b.getAttribute&&(l=parseFloat(b.getAttribute("data-fontsize")),isNaN(l)||(c=a.sfd(Math.floor(2*l))||c))}this.Gc.e9k&&f.fontFamily&&(this.Gc.m9k&&b.getAttribute?(l=b.getAttribute("data-usefontface"))&&"true"===l&&(c=this.Bkh(a,f.fontFamily,c)):c=this.Bkh(a,f.fontFamily,c));l=null;this.Gc.c9k&&f.color&&(l=Cg.lha(f.color));x=!!l;this.Gc.l9k(this.Bu)&&b.getAttribute&&(l=b.getAttribute("data-scheme-color"),l=null!==l?l:"",x=""!==l||!this.Bu.tRc||Jk.DOj(b));x&&(c=a.Ss(l)||c);this.Gc.$8k&&
f.backgroundColor&&(this.Gc.duk&&b.tagName&&Jk.gkl.contains(Ma.a.cB(b.tagName))||(c=a.Ema(Cg.lha(f.backgroundColor))||c));if(this.Gc.a9k&&f.backgroundImage&&b.className&&-1<b.className.indexOf("Highlight")&&(f=Jk.ahj(f.backgroundImage))&&0<f.tVb.count){l=f.tVb.ga(0).color;x=!0;for(F=0;F<f.tVb.count&&(x=x&&l===f.tVb.ga(F).color,x);F++);x&&(Z.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),c=a.Ema(Cg.lha(l))||c)}}this.Gc.poh(this.Bu)&&b.getAttribute&&(f=b.getAttribute("data-ccp-props"))&&
(c=a.Gma(f)||c);if(b.getAttribute){if(f=b.getAttribute("data-ccp-charstyle"))u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Gc.kYa&&(c=a.vea(f)||c);if(b=b.getAttribute("data-ccp-parastyle"))u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Gc.kYa&&(c=a.Ffd(b)||c)}return c}J$k(a){if(this.Gc.K$k)for(a=a.parentNode;a&&a.tagName;){if(a.className&&Object.getType(a.className)===
String&&-1<Ma.a.cB(a.className).indexOf("MSOCOM"))return!0;if("DIV"===Ma.a.cB(a.tagName))break;a=a.parentNode}return!1}Bkh(a,b,c){b=Jk.E9f(b);return a.aIa(b,this.Gc.mil)||c}I_(a,b){"\u200b"===a&&(a="\u00a0");b&&b.Tf&&this.J$k(b.Tf)&&(a="");this.Dg.I_(a,Tg.Qx(b))}l6c(a){const b=Tg.jra(a.Tf,"href");return b&&""!==b?(this.Dg.Tua(b,Tg.Qx(a)),this.nC(Object(D.a)(this.Dg,this.Dg.Sua,"onAnchorEnd")),1):2}q6c(){return this.mq(a=>a.hJ(!0))?1:2}w6c(){return this.mq(a=>a.w2d())?1:2}x6c(a){this.Dg.Uz(Tg.Qx(a));
this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}y6c(a){this.Dg.zla(Tg.Qx(a))}z6c(a){this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}E6c(){return this.mq(a=>a.QXa(!0))?1:2}B6c(a){this.mq(b=>b.Mfb("center"));this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}G6c(){return this.mq(a=>a.aIa("consolas"))?1:2}K6c(){return this.mq(a=>a.EX(!0))?1:2}J6c(a){return this.m1b(a,!1)}M6c(){return this.mq(a=>a.QXa(!0))?
1:2}N6c(a){return this.m1b(a,!1)}P6c(a){var b=a.Tf.getAttribute("data-render-src");const c=a.Tf.getAttribute("data-render-method");if(b&&""!==b&&c&&""!==c){const F=a.Tf.getAttribute("data-render-fallback");let R=0,fa=0;if(a.Tf.currentStyle){var f=a.Tf.currentStyle.width,l=a.Tf.currentStyle.height;f&&-1!==f.indexOf("px")&&(f=parseInt(Ma.a.substring(f,0,f.indexOf("px"))),isNaN(f)||(R=f));l&&-1!==l.indexOf("px")&&(l=parseInt(Ma.a.substring(l,0,l.indexOf("px"))),isNaN(l)||(fa=l))}a=new qH(b,c,F,R,fa,
Tg.Qx(a));this.Dg.gWa(a);return 2}this.Gc.sWa&&(n.a.AS||n.a.$f)&&(b=a.Tf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Gc.sWa&&b&&b.length&&Jk.WCc(a.Tf));const x=a.Tf.getAttribute("align");this.mq(F=>F.Mfb(x));this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}Q6c(a){this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}R6c(a){this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}U6c(){return this.mq(a=>
a.QXa(!0))?1:2}b7c(a){return this.mq(b=>{var c=Jk.E9f(a.Tf.getAttribute("face"));c=b.aIa(c);b=b.Ss(Cg.lha(a.Tf.getAttribute("color")));return c||b})?1:2}g7c(a){this.mq(b=>this.Gc.kYa?b.VXa(1):b.WXa(1));this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}h7c(a){this.mq(b=>this.Gc.kYa?b.VXa(2):b.WXa(2));this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}i7c(a){this.mq(b=>this.Gc.kYa?b.VXa(3):b.WXa(3));this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,
this.Dg.Tz,"onParagraphEnd"));return 1}j7c(a){this.mq(b=>this.Gc.kYa?b.VXa(4):b.WXa(4));this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}k7c(a){this.mq(b=>this.Gc.kYa?b.VXa(5):b.WXa(5));this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}l7c(a){this.mq(b=>this.Gc.kYa?b.VXa(6):b.WXa(6));this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}m7c(a){this.Dg.zla(Tg.Qx(a))}o7c(a){var b=a.Tf;const c=
b.src,f=b.alt,l=b.eDl;let x=0,F=0;b.style&&(x=Tg.rra(b.style.width),F=Tg.rra(b.style.height));x&&F||(x=b.width,F=b.height);let R=b=0;a.Tf.currentStyle&&(x||F||(x=Tg.rra(a.Tf.currentStyle.width),F=Tg.rra(a.Tf.currentStyle.height)),b=Tg.rra(a.Tf.currentStyle.maxWidth),R=Tg.rra(a.Tf.currentStyle.maxHeight));a=new uH(c,f,x,F,Tg.Qx(a),b,R,l);this.Dg.yla(a)}n7c(){return this.mq(a=>a.QXa(!0))?1:2}p7c(){return this.mq(a=>a.e0(!0))?1:2}q7c(){return this.mq(a=>a.aIa("consolas"))?1:2}s7c(a){this.Dg.Uz(Tg.Qx(a));
this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}u7c(a){this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}v7c(a){let b;const c=this.iag(a.Tf,0);let f=this.uKc(a.Tf,"value",0);var l=!1;0<this.I0a.count?b=this.I0a.peek():(b=new jx(2,1,Tg.Qx(a)),f||(f=1));if(this.Gc.sWa){l=b.listLevel;let fa=b.listId;this.Gc.ooh?(l=this.bag(a.Tf),l=0>l&&0>b.listLevel&&0<this.I0a.count?b.listLevel=this.I0a.count-1:b.listLevel=0<=l?l:b.listLevel,this.xwd&&this.xwd.b<
l&&(this.xwd.b=l)):0>l&&(l=b.listLevel=this.bag(a.Tf));1>fa&&(fa=b.listId=this.uKc(a.Tf,"data-listid",0));a.Tf.getAttribute("data-leveltext")&&(b.levelText=a.Tf.getAttribute("data-leveltext"));var x=a.Tf.getAttribute("data-font");x&&(b.font=x);x=!1;u.AFrameworkApplication.fa&&(x=u.AFrameworkApplication.fa.ka("FollowDestinationThemePasteIsEnabled"));if(x){var F=a.Tf.getAttribute("data-charcodes");x=[];if(F&&""!==F)if(-1<F.indexOf(",")){F=F.split(",");for(var R=0;R<F.length;R++)Array.add(x,parseInt(F[R]))}else Array.add(x,
parseInt(F));if(x&&0<x.length){F=Array(x.length);for(R=0;R<x.length;R++)F[R]=x[R];b.ENa=F}(x=a.Tf.getAttribute("data-buAutoNum"))&&0<x.length&&(b.Wnb=parseInt(x))}(l=0<=l&&0<fa)&&Jk.WCc(a.Tf)}b.j9h(c,f,l);this.Dg.Xua(b.clone());this.nC(Object(D.a)(this.Dg,this.Dg.Bla,"onListItemEnd"));return 1}gCb(a){return this.m1b(a,!1)}z7c(a){if(this.mq(b=>b.fGb(!0))){const b=a.Tf.getAttribute("OuterHtml");this.Dg.Yua(b,Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.HGa,"onMathEnd"))}return 1}G7c(a){return this.m1b(a,
!0)}K7c(a){this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}N7c(a){const b=a.Tf.getAttribute("align");this.mq(c=>c.Mfb(b));if(this.Gc.sWa){const c=a.Tf.parentNode;c&&c.tagName.toLowerCase().startsWith("li")&&Jk.WCc(a.Tf,n.a.AS||n.a.$f)}this.Dg.Uz(Tg.Qx(a));this.nC(Object(D.a)(this.Dg,this.Dg.Tz,"onParagraphEnd"));return 1}Z7c(){this.mq(a=>a.aIa("consolas"));this.Dg.fWa();this.nC(Object(D.a)(this.Dg,this.Dg.eWa,"onPreFormattedTextEnd"));return 1}g8c(){return this.mq(a=>
a.EX(!0))?1:2}h8c(){return this.mq(a=>a.aIa("consolas"))?1:2}r8c(){return this.mq(a=>a.lMe())?1:2}s8c(a){var b=a.Tf.attributes.getNamedItem("style"),c="";b&&b.value&&(c=b.value);b=Cg.ntk(c);if(0<b&&this.Gc.Qyj){for(c=0;c<b;c++)this.Dg.kWa(Tg.Qx(a));return 3}return 2}t8c(){return this.mq(a=>a.EX(!0))?1:2}u8c(){return this.mq(a=>a.hJ(!0))?1:2}v8c(){return this.mq(a=>a.L4(!0))?1:2}w8c(){return this.mq(a=>a.GX(!0))?1:2}A8c(a){this.mq(Xa=>Xa.clearFormatting()&&Xa.SEe());Cg.pOc(a.Tf,this);const b=Cg.Qsb(a.Tf),
c=Cg.e7f(a.Tf),f=Cg.VZd(a.Tf),l=Cg.WZd(a.Tf),x=!parseInt(Tg.jra(a.Tf,"border")),F=Cg.gOj(a.Tf);let R=-1,fa="";var wa=-1;a.Tf.attributes.hasOwnProperty("style")&&-1!==(wa=a.Tf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?R=parseInt(a.Tf.attributes.getNamedItem("style").value.substr(wa+17)):a.Tf.attributes.hasOwnProperty(za.a.lQd.toString())&&(R=parseInt(a.Tf.attributes.getNamedItem(za.a.lQd.toString()).value));wa=-1;a.Tf.attributes.hasOwnProperty("class")&&-1!==(wa=a.Tf.attributes.getNamedItem("class").value.indexOf("Mso"))?
fa=a.Tf.attributes.getNamedItem("class").value.substr(wa).split(" ")[0]:a.Tf.attributes.hasOwnProperty(za.a.mQd.toString())&&(fa=a.Tf.attributes.getNamedItem(za.a.mQd.toString()).value);this.Dg.gX(new bC(0,0,b.value,b.dwg,null,x,F,c,new vH(f.value,l.value),fa,R,Tg.Qx(a)));this.nC(Object(D.a)(this.Dg,this.Dg.dX,"onTableEnd"));u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}Hdc(a){const b=Cg.l6a(a.Tf),c=Cg.Qsb(a.Tf);if(!c.value&&
c.dSc&&(u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Gc.n3g))return 3;let f=parseInt(Tg.jra(a.Tf,"colSpan"));if(void 0===f||null===f||""===f+"")f=c.value?1:0;let l=parseInt(Tg.jra(a.Tf,"rowSpan"));if(void 0===l||null===l||""===l+"")l=b.value?1:0;let x=!1;a.Tf.attributes.hasOwnProperty("style")&&(x=-1!==a.Tf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==a.Tf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));
!x&&a.Tf.attributes.hasOwnProperty("class")&&(x=-1!==a.Tf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let F=69905;if(a.Tf.attributes.hasOwnProperty(za.a.kQd.toString())){var R=parseInt(a.Tf.attributes.getNamedItem(za.a.kQd.toString()).value);isNaN(R)||(F=R)}R=Cg.lha(a.Tf.style.backgroundColor);const fa=Cg.fhj(a.Tf);this.mq(lb=>lb.hIa(0,0));Cg.pOc(a.Tf,this);const wa=Cg.e7f(a.Tf),Xa=this.Gc.cuk?Cg.aZi(a.Tf):null;a=new Yy(f,l,c.value,b.value,R,fa,wa,Xa,c.dwg,x,F,Tg.Qx(a));this.Dg.cX(a);
this.nC(Object(D.a)(this.Dg,this.Dg.bX,"onTableCellEnd"));this.Sfk();return 1}B8c(a){const b=this.Hdc(a);if(3===b)return b;this.mq(c=>{const f=c.hJ(!0);c=c.Mfb("center");return f||c});Cg.pOc(a.Tf,this);return 1}C8c(a){Cg.pOc(a.Tf,this);const b=Cg.l6a(a.Tf);if(b.dSc&&!b.value&&(u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Gc.n3g))return 3;this.Dg.fX(new aC(b.value,Tg.Qx(a)));this.nC(Object(D.a)(this.Dg,this.Dg.eX,"onTableRowEnd"));return 1}F8c(){return this.mq(a=>
a.aIa("consolas"))?1:2}G8c(){return this.mq(a=>a.e0(!0))?1:2}H8c(a){return this.m1b(a,!1)}J8c(){return this.mq(a=>a.e0(!0))?1:2}static h2i(a){return a?a.split(",")[0]:null}static Rol(a){if(!a)return null;a=Ma.a.CDe(a,'"');return a=Ma.a.CDe(a,"'")}static E9f(a){if(!a)return null;a=Jk.h2i(a);return a=Jk.Rol(a)}static MBf(a,b){b=b.trim();var c=b.match(RegExp("^-?[0-9]+deg$"));if(c&&0<c.length){if(a.Oig())return!1;a.direction=b;return!0}if((c=b.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&
0<c.length){if(a.Oig())return!1;a.direction=b;return!0}var f=(c=b.match(RegExp("^rgb\\(.*\\)")))&&0<c.length?b.indexOf(")")+1:b.indexOf(" ");c=-1===f?b:Cg.lha(b.substr(0,f).trim());if(!c||""===c)return!1;b=-1===f?"":b.substr(f).trim();f=new rH;f.color=c;f.stop=b;a.tVb.add(f);return!0}static ahj(a){try{if(!a)return null;a=a.trim();if(!a.startsWith("linear-gradient(")||!a.endsWith(")"))return null;let b=a.substr(16);b=b.substr(0,b.lastIndexOf(")"));const c=new tH;for(;0<b.trim().length;){let f=b.indexOf(",");
const l=b.indexOf("(");if(0<l&&l<f){const x=b.indexOf(")");if(x<l)return null;f=b.indexOf(",",x)}if(-1===f){if(!Jk.MBf(c,b))return null;b=""}else{const x=b.substr(0,f);b=b.substr(f+1);if(!Jk.MBf(c,x))return null}}return c}catch(b){return null}}static GNc(a,b){a=a.split(" ");if(0<a.length)for(let c=0;c<a.length;c++)if(0<=a[c].indexOf(b))return a[c];return""}static WCc(a,b=!1){a&&3!==a.nodeType&&(a.style.margin="",b&&Jk.gNf(a,b))}static gNf(a,b){if(a)for(a=a.firstChild;a;)3!==a.nodeType&&(a.style&&
(a.style.margin=""),b&&Jk.gNf(a,b)),a=a.nextSibling}static c6i(a){if("p"!==a.tagName.toLowerCase())return-1;if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf("mso-list")){a=a.split(";");for(let c=0;c<a.length;c++){var b=a[c].split(":");if(2===b.length&&"mso-list"===b[0].trim()&&(b=b[1].trim().split(" "),3===b.length))return Number.parseInvariant(b[1].substr(5))}}return-1}static DOj(a){return!(void 0===a.className||null===a.className)&&a.className.startsWith("TextRun")}static dfj(a){a=a.style.textDecorationLine;
return void 0===a||null===a?null:a}static kug(a){return 0<=a.indexOf("line-through")}static pD(a){return 0<=a.indexOf("underline")}}Jk.gkl=(Kr=new Ha.a,Kr.add("TABLE"),Kr.add("THEAD"),Kr.add("TBODY"),Kr.add("TFOOT"),Kr.add("TR"),Kr.add("TH"),Kr.add("TD"),Kr);Object(e.a)(Jk,"DefaultHtmlTranslator",Tg,[]);var Pm=d(304);class Qj{constructor(a=null){this.CR=a||Pm.a.Y1d("");this.nuc=Number.parseInvariant((new Date).format("HHmmss"))}get Hb(){return this.CR}process(a,b){if(a&&a.querySelectorAll){const x=
a.querySelectorAll("p");if(x&&0<x.length){for(var c=0,f=!1,l=x[0].parentNode;5>c&&l&&l!==a;){c++;const F=l.id.toLowerCase();if(F&&F.length&&-1!==F.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(l,"WACEditing")&&Sys.UI.DomElement.containsCssClass(l,"EditingSurfaceBody")){f=!0;break}l=l.parentNode}if(f&&l!==a){c=a.firstChild;for(f=!1;0<l.children.length&&l.children[0]!==c;)a.insertBefore(l.children[0],c),f=!0;if(f)for(;c;)l=c.nextSibling,a.removeChild(c),c=l}a=new wc.a(b,Object(D.a)(this,
this.Tze,"processNodesDiscovery"),new WB(x));a.xl("Word Converter Operation");a.Vi=!b||b.Vi;a.run()}}}Tze(a,b){const c=b.nodes[b.Q1];var f=Qj.GZd(c);if(f){let x=f.GJa.replace(RegExp("level[0-9]"),"").trim();x=x&&x.length?x:f.GJa;let F=b.lists[x];F||(F=new mH,F.XX=this.nuc++);let R=F.bwb[f.level-1];R||(R=new nH,R.level=f.level);var l=c.parentNode;if(l&&"li"===l.tagName.toLowerCase()){if(l=l.parentNode)!(l=l.tagName.toUpperCase())||"OL"!==l&&"UL"!==l||(R.tagName=l)}else R.IVa=Qj.k9f(c,5),R.IVa&&R.IVa.length||
(R.IVa=Qj.e1d(c,5)),R.ignore=!R.IVa||!R.IVa.length,R.tagName=Qj.yLc(R.IVa);f.XX=F.XX;R.Ccc++;R.ignore||"li"===c.parentNode.tagName.toLowerCase()||(l=(l=Qj.e1d(c,5))?l:R.IVa)&&l.length&&(f.tPi=l,(l=Qj.c3k(c,l,R.listStyle,f.level-1))&&l.length&&(R.listStyle=l));b.Y7[b.Y7.length]=f;R.Y7.contains(f)||R.Y7.add(f);if(void 0===F.bwb[f.level-1]||null===F.bwb[f.level-1]||F.bwb[f.level-1]!==R)F.bwb[f.level-1]=R;b.lists[x]&&b.lists[x]===F||(b.lists[x]=F);b.Tvb=c}else if((f=b.Tvb)&&Qj.Y_b(c)===f&&c.tagName===
f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.Q1++;if(b.nodes.length<=b.Q1){if(!b.Y7.length)return!1;b.Q1=0;a.Wg(Object(D.a)(this,this.Sze,"processNodeConvert"))}return!0}Sze(a,b){a=b.Y7[b.Q1];var c=a.Udc,f=a.GJa.replace(RegExp("level[0-9]"),"").trim();f=f&&f.length?f:a.GJa;f=b.lists[f];var l=f.bwb[a.level-1],x=c.parentNode.tagName.toLowerCase();
if(!l.ignore&&c.parentNode&&"li"!==x){if(x=Qj.Yxi(c,l)){Qj.YUb(c,5);const F=c.ownerDocument.createElement("LI");F.setAttribute("data-aria-level",String.format("{0}",a.level));for(F.setAttribute("data-listid",String.format("{0}",f.XX));c.firstChild;)F.appendChild(c.firstChild);x.appendChild(F);c.parentNode.removeChild(c);"UL"===l.tagName?this.Hb.b++:this.Hb.c++}}else"li"===x&&(l=l.tagName,c=c.parentNode,a.YCb&&(a=c.parentNode)&&a.tagName.toUpperCase()===l&&a.setAttribute("data-pasteFromRc","true"),
c.setAttribute("data-listid",String.format("{0}",f.XX)),"UL"===l?this.Hb.b++:this.Hb.c++);b.Q1++;return b.Q1<b.Y7.length}static Yxi(a,b){a=Qj.Vxi(a,b.tagName);return Qj.VNd(a,b)}static VNd(a,b){if(b.tagName!==a.tagName){for(b=a.ownerDocument.createElement(b.tagName);a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static Vxi(a,b){b=a.ownerDocument.createElement(b?b:"UL");var c=a.getAttribute("start");c&&0<c.length&&(b.setAttribute("start",
c),a.removeAttribute("start"));(c=a.className)&&0<c.length&&(c="OL"===b.tagName?Jk.GNc(c,"NumberListStyle"):Jk.GNc(c,"BulletListStyle"),0<c.length&&(Sys.UI.DomElement.addCssClass(b,c),Sys.UI.DomElement.removeCssClass(a,c)));a.parentNode.insertBefore(b,a);return b}static YUb(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&Qj.YUb(f,b-1);if(Qj.s8d(f)||Qj.J3b(f))a.removeChild(f),c--}}static GZd(a){if(1===a.nodeType){var b=Qj.y0b(a,"mso-list");if(b&&0<b.length)try{var c=
b.split(" ");if(3===c.length){var f=new Wy;f.level=Number.parseInvariant(c[1].substr(5));f.GJa=b;f.Udc=a;f.YCb=!0;return f}}catch(l){}else if((c=a.parentNode)&&"li"===c.tagName.toLocaleLowerCase()&&(b=c.getAttribute("data-"+Uc.a.zTb),c=c.getAttribute("data-listid"),b&&c&&0<b.length&&0<c.length))return f=new Wy,f.level=Number.parseInvariant(b),f.GJa=c+" level"+b,f.Udc=a,f.YCb=!1,f}return null}static c3k(a,b,c,f){if("p"===a.tagName.toLowerCase()&&b&&b.length){if("UL"===Qj.yLc(b))return c=Qj.LYi(b),
Sys.UI.DomElement.addCssClass(a,c),c;var l;return(l=b.match(RegExp("^[0-9]+")))&&l.length?(c="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,c),a.setAttribute("start",l[0]),c):(l=b.match(RegExp("^[a-zA-Z]+")))&&l.length&&(l=l[0],f=(b=l.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&b.length?Qj.yaj(c,f):1,1!==f&&((c=Qj.iEc(a,l,RegExp("^[ivxlcdm]+"),Ma.a.xQf,"NumberListStyle3"))||(c=Qj.iEc(a,l,RegExp("^[IVXLCDM]+"),Ma.a.xQf,"NumberListStyle5")))||f&&((c=Qj.iEc(a,l,RegExp("^[a-z]+"),Ma.a.wQf,"NumberListStyle2"))||
(c=Qj.iEc(a,l,RegExp("^[A-Z]+"),Ma.a.wQf,"NumberListStyle4"))))?c:"NumberListStyle1"}return null}static LYi(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static yaj(a,b){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(b%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static iEc(a,
b,c,f,l){return(b=b.match(c))&&b.length?(f=f(b[0]),f=1>f?1:f,Sys.UI.DomElement.addCssClass(a,l),a.setAttribute("start",f+""),l):null}static yLc(a){return a&&"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static e1d(a,b){let c=null;var f;let l,x;for(let F=-1;!c&&F<a.childNodes.length;F++){const R=-1===F?a:a.childNodes[F];if(R)if((f=R.innerHTML)&&0<f.length){if(l=f.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=l&&(x=f.indexOf("\x3c!--[endif]--\x3e"),0<=x)){f=f.substring(l,x+14);R.innerHTML=
R.innerHTML.replace(f,"");if(f.length){a=a.ownerDocument.createElement("span");a.innerHTML=f;c=a.innerText.trim();break}c&&c.length||(c="o")}}else 0<=F&&1===R.nodeType&&1<b&&(c=Qj.e1d(R,b-1))}return c}static k9f(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];Qj.J3b(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o"),l.parentNode.removeChild(l)):1===l.nodeType&&1<b&&(c=Qj.k9f(l,b-1))}return c}static J3b(a){return 1===a.nodeType&&
(a=Qj.y0b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static s8d(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static y0b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static Y_b(a){do a=a.previousSibling;while(a&&Qj.w3b(a));return a}static w3b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Qj.swd,
""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Qj.w3b(a.firstChild):!0}}Qj.swd=RegExp("[\n|\r]","gi");Object(e.a)(Qj,"WacAndRichClientWordConverter",null,[1185]);class wH{constructor(){this.XX=0;this.tagName="UL";this.lZb=null;this.ignore=!1;this.Ccc=0}}Object(e.a)(wH,"ListMetadata",null,[]);class kl{constructor(a=null){this.nuc=1;this.CR=a||Pm.a.Y1d("")}get Hb(){return this.CR}process(a,b){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&
0<a.length&&(a=new wc.a(b,Object(D.a)(this,this.Tze,"processNodesDiscovery"),new WB(a)),a.xl("Word Converter Operation"),a.Vi=!b||b.Vi,a.run())}Tze(a,b){const c=b.nodes[b.Q1];var f=kl.GZd(c);if(f){let l=b.tha[f.level-1];l||(l=new VB,b.tha[f.level-1]=l);b.Tvb&&kl.Y_b(c)!==b.Tvb&&kl.nTk(b);let x=l.bAg[f.GJa];if(!x)x=new wH,x.XX=this.nuc++,x.lZb=kl.wYd(c,5),x.ignore=!x.lZb||!x.lZb.length,x.tagName=kl.yLc(x.lZb),l.bAg[f.GJa]=x,b.lists[x.XX.toString()]=x;else if(!x.ignore&&1===x.Ccc){const F=kl.wYd(c,
5);x.tagName=x.lZb===F?"UL":"OL"}f.XX=x.XX;x.ignore||"OL"===x.tagName&&0<x.Ccc&&l.AFc!==f.XX?(x.ignore=!0,b.tha[0].AFc=-1,b.tha=b.tha.slice(0,1)):(b.tha.length>f.level&&(b.tha=b.tha.slice(0,f.level)),l.AFc=f.XX,b.Y7[b.Y7.length]=f,x.Ccc++);b.Tvb=c}else if((f=b.Tvb)&&kl.Y_b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.Q1++;
if(b.nodes.length<=b.Q1){if(!b.Y7.length)return!1;b.Q1=0;a.Wg(Object(D.a)(this,this.Sze,"processNodeConvert"))}return!0}Sze(a,b){var c=b.Y7[b.Q1];a=c.Udc;const f=b.lists[c.XX.toString()];if(!f.ignore&&(c=kl.G8i(a,c,f))){kl.YUb(a,5);const l=a.ownerDocument.createElement("LI");for(;a.firstChild;)l.appendChild(a.firstChild);c.appendChild(l);a.parentNode.removeChild(a);"UL"===f.tagName?this.Hb.b++:this.Hb.c++}b.Q1++;return b.Q1<b.Y7.length}static G8i(a,b,c){let f=kl.zah(a,b.level,c);const l=L.a.re(f,
"UniqueListId");if(l&&l!==b.XX||!l&&f.firstChild)a=a.ownerDocument.createElement(c.tagName),f.parentNode.insertBefore(a,f.nextSibling),f=a;L.a.ov(f,"UniqueListId",b.XX);return kl.VNd(f,c)}static VNd(a,b){if(b.tagName!==a.tagName){b=a.ownerDocument.createElement(b.tagName);for(L.a.ov(b,"UniqueListId",L.a.re(a,"UniqueListId"));a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static zah(a,b,c){let f=null,l;1===b?l=kl.Y_b(a):(f=kl.zah(a,
b-1,null),l=f.lastChild);if(l&&1===l.nodeType){const x=l.tagName.toUpperCase();if("UL"===x||"OL"===x)return l}c=a.ownerDocument.createElement(c?c.tagName:"UL");1===b?a.parentNode.insertBefore(c,a):f.appendChild(c);return c}static YUb(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&kl.YUb(f,b-1);if(kl.s8d(f)||kl.J3b(f))a.removeChild(f),c--}}static GZd(a){if(1===a.nodeType){const b=kl.y0b(a,"mso-list");if(b&&0<b.length)try{const c=b.split(" ");if(3===c.length){const f=
new Wy;f.level=Number.parseInvariant(c[1].substr(5));f.GJa=b;f.Udc=a;return f}}catch(c){}}return null}static yLc(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static wYd(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];kl.J3b(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o")):1===l.nodeType&&1<b&&(c=kl.wYd(l,b-1))}return c}static J3b(a){return 1===a.nodeType&&(a=kl.y0b(a,"mso-list"))&&0<a.length&&"ignore"===
a.trim().toLowerCase()?!0:!1}static s8d(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static y0b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static Y_b(a){do a=a.previousSibling;while(a&&kl.w3b(a));return a}static w3b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(kl.swd,""),!a.trim().length):1!==a.nodeType||
a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:kl.w3b(a.firstChild):!0}static nTk(a){for(let b=0;b<a.tha.length;b++){const c=a.tha[b];c&&(c.AFc=-1)}}}kl.swd=RegExp("[\n|\r]","gi");Object(e.a)(kl,"WordConverter",null,[1185]);class cC{constructor(a){this.L_a=a.ka("ExternalPasteImprovementsEnabled")&&a.ka("ListMarkerIsEnabled")}get i5a(){return this.L_a}create(a=null){return this.L_a?new Qj(a):new kl(a)}}Object(e.a)(cC,"Box4WordConverterFactory",null,[1176]);var xH=d(685);class yH{constructor(a,
b,c,f,l){this.g1e=0;this.hd=a;this.qd=b;this.Pib=l;this.xY=c;this.oMa=f}vli(a,b,c){Z.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",b,c,this.qd.iy);a.Vi&&this.qd.Hj&&window.chrome&&Z.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",b);this.xY.lba(!!(b&16));this.oMa.create(a,Object(D.a)(this,this.gUe,"waitingForEnsureAccessOperationResult"),null).xl("ClipboardPreProcess");this.g1e=Date.now()}PTk(){this.xY.reset()}gUe(a){let b=
!0;const c=this.xY.RLi,f=null==this.xY.xLi;null!=c?(a.m4=c,b=!1):Date.now()-this.g1e>this.Pib&&!f&&(Z.ULS.sendTraceTag(18354843,307,50,null),this.hd.Tb(Ed.a.Mha,{["Reason"]:Bd.a.O1g}),b=a.m4=!1);return b}}Object(e.a)(yH,"ClipboardOperationClipboardAccessHelper",null,[1152]);class Zy{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){this.Ca=a;this.hd=b;this.Jr=c;this.xi=f;this.Pc=l;this.xY=x;this.Zq=F;this.$e=R;this.dga=fa;this.FJ=wa;this.ega=Xa;this.llb=lb;this.E1a=Lb;this.ik=lc;this.pNb=kc?kc.ka("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.LNb=kc?kc.ka("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.YNb=kc?kc.ka("TextLayoutServiceUseResponse"):!1}get Jh(){return this.xi}get Tc(){return this.hd}gAl(a){a.qna();return!0}LQf(a,b){a=b.yw;Z.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&256){n.a.osa&&u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");let c=null;b.Df&&b.Df.ug&&(c=b.Df.ug.Bn);let f=!1;this.pNb&&n.a.osa&&this.ik.Rcd(c,"data-src","data-srcurl");this.LNb&&(f=this.ik.HUb(b.Df.ug.Bn,
b.Df.Cd,!0));this.YNb&&this.ik.yld(c,!1);a=this.xY.copy();this.pNb&&n.a.osa&&this.ik.Rcd(c,"data-srcurl","data-src");this.LNb&&f&&this.ik.HUb(b.Df.ug.Bn,b.Df.Cd,!1);this.YNb&&this.ik.yld(c,!0);if(!a)return Z.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Tc.Tb(Ed.a.m5a,{["Reason"]:Bd.a.wOe}),b.J_&&b.J_.fail("SystemClipboard did not copy",!1),b.failed=!0,!1}return!0}$Vb(a,b){const c=b.Df;Z.ULS.shipAssertTag(18130961,307,!!(b.yw&16));b.Idl?this.Jr.mNf():this.Jr.dOd(c,a);return!0}XFc(a,
b){var c=b.context,f=b.ld;const l=b.bJ;var x=!1;a=this.Pc.Oa.kb.Te;if(this.Zq.Xl(a)||this.$e.Cl(a)){const F=this.FJ.Kc(a.node);let R=F.Ze();Z.ULS.shipAssertTag(18130962,307,R);this.dga.Je(F);this.ega.v8a(F)&&(x=!0)}f=b.yw&64?new E.DictionaryPropertySet:f||new E.DictionaryPropertySet;f.setValue(be.a.bqb,!1);c=this.Ca.ii(c,C.a.eK,2,!0,l,f);8===c&&(Z.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Tc.Tb(Ed.a.Mha,{["Reason"]:Bd.a.hVf}),b.J_&&b.J_.fail("DeleteKey failed",!1),b.failed=!0);32===
c&&x&&(b=this.Pc.Oa.kb,this.$e.Jw(b)&&b.Ua.node===a.node&&!this.Zq.textLength(b.Ua.node)&&(b=this.FJ.Kc(b.Ua.node),a=this.$e.Vs(b),Z.ULS.shipAssertTag(18130964,307,a),this.dga.Je(b),this.ega.xub(b)||(a=this.llb.create(),a.Nc(b),this.dga.Iua(a,!1,!1),x=this.dga.oi(a),this.Zq.Wd(x)&&(this.dga.Je(a),this.Jh.merge(a,b,!1,!1),this.Pc.setSelection(this.E1a.Jg(x,this.Zq.textLength(x)))))));return!0}}Object(e.a)(Zy,"ClipboardOperationCutCopy",null,[1126]);class zH{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,
Lb,kc,lc){this.Ca=a;this.hd=b;this.Jr=c;this.xY=x;this.Pc=l;this.xi=f;this.Zq=F;this.$e=R;this.dga=fa;this.FJ=wa;this.ega=Xa;this.llb=lb;this.E1a=Lb;this.jb=kc;this.ik=lc}create(){return new Zy(this.Ca,this.hd,this.Jr,this.xi,this.Pc,this.xY,this.Zq,this.$e,this.dga,this.FJ,this.ega,this.llb,this.E1a,this.jb,this.ik)}}Object(e.a)(zH,"Factory",null,[251]);class AH{eoh(){return!0}}Object(e.a)(AH,"ClipboardOperationCutStrategy",null,[270]);var Bs=d(458),dC=d(1179),eC=d(222);class dp{constructor(a,b,
c,f,l,x=null,F="",R=!0){this.Oqa=this.Shd=this.EWa=this.Ucd=null;this.N3b=!1;this.e5d=null;this.Bte=0;this.context=a;this.Df=a.view;this.yw=b;this.ld=l;this.J_=c;this.bJ=f;this.vFb=this.failed=!1;this.P8c=null;this.d8a=this.Wub=!1;this.Idl=dp.KNd(a);this.browserName=F;this.SCh=R;this.zJa=!1;this.TNa=0;this.tMd=Ga.a.create().toString();if(a=Object(Fa.a)(10,l)?l:null){this.EWa=new E.DictionaryPropertySet;this.EWa.vx(a);if(a.sa(be.a.A9c,!1)){this.Wub=!0;this.d8a=a.sa(be.a.d8a,!1);this.P8c=x;for(x=this.Df.Eb.Dj;x.Hw;)x=
x.getContext(0);if(l=Object(va.a)(te.AParagraphNode,x.node)){c=0;f=Ya.ParagraphReader.textLength(l);switch(x.contextId){case Fb.a.textRange:c=x.Qa;f=x.Kb;break;case Fb.a.endOfParagraph:c=f}this.Ucd=tb.a.c3i(x.node,c);Z.ULS.shipAssertTag(6305503,307,!!this.Ucd);l=Rb.HyperlinkReader.B_b(l);for(const fa of l)fa.Kb<=c||fa.Qa>=f||dp.hyperlinkEditor.hO(x.node,fa.hyperlink)}}this.vFb=a.sa(be.a.vFb,!1);this.zJa=a.sa(be.a.zJa,!1)}b&64&&(this.vFb=!0)}static get Tc(){return Sa.a.instance}static get hyperlinkEditor(){return dp.Xm||
(dp.Xm=hb.a.instance.resolve("Box4.IHyperlinkEditor"))}static KNd(a){if(a){if(a.Hw){for(let b=0;b<a.length;b++)if(dp.KNd(a.getContext(b)))return!0;return!1}if(Object(Fa.a)(eC.a,a))return dp.KNd(a.MD);if(Ya.ParagraphReader.Wd(a.node)&&a.node.yB)return!0}return!1}}dp.Xm=null;Object(e.a)(dp,"ClipboardActionArguments",null,[]);var hv;(function(a){a[a.paste=1]="paste";a[a.textOnly=2]="textOnly";a[a.overtype=4]="overtype";a[a.copy=16]="copy";a[a.deleteSelection=32]="deleteSelection";a[a.move=64]="move";
a[a.useSystemClipboard=256]="useSystemClipboard";a[a.forceInternalClipboard=512]="forceInternalClipboard";a[a.reformatPastedContent=4096]="reformatPastedContent";a[a.pasteAsPlainText=8192]="pasteAsPlainText";a[a.showPlaceholderGlossary=65536]="showPlaceholderGlossary"})(hv||(hv={}));Object(e.b)("ClipboardActionFlags",hv);const BH=a=>{a=a.Oa.clone();const b=[];for(let c=0;c<a.length;c++)Array.addRange(b,a.ga(c).toArray());return b},CH=a=>{const b={};let c;for(let f=0;f<a.length;f++)c=Object.getType(a[f].node).getName(),
b[c]=b[c]?b[c]+1:1;a="";for(let f in b)a+=b[f]+" "+f+" elements,";return a=a.substring(0,a.length-1)};class DH extends Bs.a{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg=!0){super();this.kBd=this.faa=this.C5=this.mB=null;this.init(a);this.xl("ClipboardOperation");this.wCa(fa,b,l,x,F);this.hd=wa;this.$e=Xa;this.qd=lb;this.jk=Lb;this.UXe=kc;this.XXe=lc;this.VXe=Ec;this.YXe=Jc;this.ypc=Dc;this.Hpd=Wd;this.XKb=R;this.OKb=xe;this.oMa=Sd;this.IXh=Bg;this.QC=Pe;this.Wc=
Ue;this.rs=Ef;this.soa=dg;this.Bu=f;this.fza=Mg;F&&Object(Fa.a)(10,F)&&(this.faa=Object(va.a)(1187,F.sa(be.a.INa,null)));this.faa||(this.faa=this.fza.fNe());this.OZa=void 0===c||null===c?"NotAvailable":Object(dC.a)(hv,c);this.faa.A8h(this.OZa.split(", "));a=this.Bu;a.view.Hh?(this.Eg=a.view,this.Eg.Eb?(this.zH=0,this.pU=c,this.dmb=Jc.ZCb,!Bg||this.dmb&&this.dmb.kb&&this.dmb.length?(Jc=fb.SelectionEditor.Jw(this.dmb.kb),Jc=!(this.pU&16&&Jc),Jc=Wd.zDj(c,this.Dj)&&Jc,1!==this.behavior&&Jc||(Jc||this.faa.fail("Clipboard operation disabled for selection",
!0),this.fp=Jc?32:8,this.BX())):(this.hd.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),this.faa.fail("No selection when one required",!0),this.fp=8,this.finish())):(this.hd.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),this.faa.fail("No selection manager",!1),this.fp=8,this.finish())):(this.hd.Tb(Ed.a.ph,{["Reason"]:Bd.a.W5c}),this.faa.fail("Not in interactive view",!0),this.fp=8,this.finish())}get Dj(){this.kBd||(this.kBd=ld.a.Znb(this.dmb));return this.kBd}R_(){super.R_();this.dmb=null}run(){0===this.zH&&
this.setup();1===this.zH&&this.process();2===this.zH&&this.teardownSync();3===this.zH&&this.teardownAsync();4===this.zH&&this.finish()}setup(){if(this.pU&256&&this.XKb){this.oz||this.ypc.vli(this,this.pU,this.OZa);this.oz.run();if(this.oz.inProgress)return;const a=this.oz.m4;this.RCc();if(!a){this.faa.fail("No access to system clipboard",!0);this.fp=8;this.zH=4;this.rVj();return}}else Z.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this.pU,this.OZa,this.qd.iy);
this.pU&32&&!this.$e.zRc(this.Eg.Eb.Dj)?(Z.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.hd.Tb(Ed.a.ph,{["Reason"]:Bd.a.gQd}),this.faa.fail("Cut not allowed",!0),this.OKb.show(),this.fp=8,this.zH=4):(this.pU&4096&&(this.soa.UBe(Object.assign(new Kh,{ntg:!0,m3g:this.OZa})),this.rs.undo()),this.Hpd.szk(this.pU),this.mB=this.jk.je(15),this.mB.fd(this.Eg.rg),this.zH=1)}process(){if(!this.oz){Z.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.pU,this.OZa,
this.qd.iy);Z.ULS.shipAssertTag(6305507,307,!this.C5);this.C5=new dp(this.Bu,this.pU,this.faa,this.bJ,this.oU,void 0,this.qd.iy,this.IXh);let a;a=this.pU&65536?Object(D.a)(this.UXe,this.UXe.process,"process"):this.pU&64?Object(D.a)(this.XXe,this.XXe.process,"process"):this.pU&1?Object(D.a)(this.YXe,this.YXe.process,"process"):Object(D.a)(this.VXe,this.VXe.process,"process");this.pU&16&&this.Eg.Eb.Xma.gWd();this.oMa.create(this,a,this.C5).xl("ClipboardAction")}Z.ULS.shipAssertTag(6305536,307,!!this.oz);
this.oz.run();this.oz.inProgress||(this.RCc(),this.zH=this.Vi?2:3)}teardownSync(){this.C5.Wub&&(this.mB.$c=C.a.typing);this.C5.N3b&&this.mB.B4c(this.C5.e5d,this.C5.Bte);this.mB.dispose();this.fp=this.C5.failed?8:32;this.zH=4}teardownAsync(){if(this.oz){if(this.oz.run(),this.oz.inProgress)return}else if(this.C5.Wub&&(this.mB.$c=C.a.typing),this.mB.QT(this),this.C5.N3b&&this.mB.B4c(this.C5.e5d,this.C5.Bte),this.mB.dispose(),this.Pyc)return;this.fp=this.C5.failed?8:32;this.zH=4}finish(){this.soa.UBe(Object.assign(new Kh,
{ntg:!1}));this.BX();32===this.response?Z.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.pU,this.OZa,this.qd.iy):Z.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.pU,this.OZa,this.qd.iy);this.fza.$Aa(this.faa)}rVj(){var a=!!(this.pU&1),b=this.Bu.view;if(b){var c=b.Eb;b=this.qd.iy;u.AFrameworkApplication.Ta.processAction(C.a.YTf,
2);a?Z.ULS.sendTraceTag(18617483,307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",b):(Z.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",b),a=BH(c),1===a.length?Z.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(a[0].node).getName(),b):(c=CH(a),Z.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",a.length,c,b)))}}}Object(e.a)(DH,
"ClipboardOperation",Bs.a,[]);class EH{constructor(a,b){this.Npc=null;this.Jr=a;this.uU=b;this.iB=0}process(a,b){this.iB||(this.Npc=[Object(D.a)(this,this.zui,"copyGlossarySelection"),Object(D.a)(this.uU,this.uU.Stk,"pasteGlossaryPlaceholder")]);let c=!0;this.iB<this.Npc.length&&(c=this.Npc[this.iB++](a,b));return c?this.iB<this.Npc.length:!1}zui(a,b){if(!Object(Fa.a)(10,b.ld))return!1;const c=Object(va.a)(10,b.ld);if(!c.Sa(be.a.Sfg))return!1;const f=c.getValue(be.a.Sfg),l=b.Df,x=l.Eb;this.Jr.Gxl();
x.Xdd(()=>{x.setSelection(f,void 0,!0);this.Jr.dOd(l,a)},!0);return!0}}Object(e.a)(EH,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[1186]);class FH{constructor(a){this.u_a=null;this.aR=a;this.iB=-1}process(a,b){-1===this.iB&&(this.ECi(a,b),this.iB=0);let c=!1;this.iB<this.u_a.length&&(c=this.u_a[this.iB++](a,b));return c?this.iB<this.u_a.length:!1}ECi(a,b){n.a.N7||b.yw&512?(this.u_a=[Object(D.a)(this.aR,this.aR.$Vb,"copyInternal")],Z.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!a.Vi&&b.yw&256?(this.u_a=[Object(D.a)(this.aR,this.aR.gAl,"waitBeforeCopy"),Object(D.a)(this.aR,this.aR.LQf,"copyExternal"),Object(D.a)(this.aR,this.aR.$Vb,"copyInternal")],Z.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.u_a=[Object(D.a)(this.aR,this.aR.LQf,"copyExternal"),Object(D.a)(this.aR,this.aR.$Vb,"copyInternal")],Z.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
b.yw&32&&(a=Object(D.a)(this.aR,this.aR.XFc,"deleteForCut"),this.u_a.push(a),Z.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));a=b.browserName;Z.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",a);if(b.Df)if(b=BH(b.Df.Eb),1===b.length)Z.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(b[0].node).getName(),a);else{const c=CH(b);Z.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",b.length,
c,a)}}}Object(e.a)(FH,"ClipboardOperationCutCopyProcessor",null,[1183]);class GH{constructor(a,b,c,f){this.iuc=null;this.Jr=a;this.Pc=b;this.aR=c;this.uU=f;this.iB=0}process(a,b){this.iB||(this.iuc=[Object(D.a)(this,this.Dui,"copyMovedSelection"),Object(D.a)(this.aR,this.aR.XFc,"deleteForCut"),Object(D.a)(this,this.xTg,"moveIp"),Object(D.a)(this.uU,this.uU.u3g,"pasteInternal"),Object(D.a)(this.uU,this.uU.cmh,"setSelectionAfterPaste")]);let c=!0;this.iB<this.iuc.length&&(c=this.iuc[this.iB++](a,b));
return c?this.iB<this.iuc.length:!1}Dui(a,b){b=b.Df;this.Jr.txl();this.Jr.dOd(b,a);return!0}xTg(a,b){b=new $a.Selection([b.ld],!0);this.Pc.setSelection(b,a);return!0}}Object(e.a)(GH,"ClipboardOperationMoveProcessor",null,[1182]);class HH{constructor(a,b,c,f,l,x){this.Qyd=null;this.Npf=0;this.hd=f;this.qd=b;this.uU=l;this.ptd=c;this.XKb=u.AFrameworkApplication.Wgd()&&!(n.a.yS&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix"));this.Pib=a.appSettings.ChromeClipboardAccessOperationTimeout;
this.iB=0;this.FIh=x}get ZCb(){return this.uU.ZCb}process(a,b){if(0===this.iB)return this.$tk(b);if(1===this.iB)return this.prepareForPaste(a,b);if(2===this.iB)return this.iB=3,this.Qyd(a,b);3===this.iB&&this.uU.cmh(a,b);return!1}$tk(a){this.qd.N7||a.yw&512?(this.Qyd=a.yw&2?Object(D.a)(this.uU,this.uU.paste,"paste"):Object(D.a)(this.uU,this.uU.u3g,"pasteInternal"),this.iB=2):(this.XKb?(this.iB=1,this.Npf=Date.now()):this.iB=2,this.Qyd=Object(D.a)(this.uU,this.uU.paste,"paste"));Z.ULS.sendTraceTag(18617486,
307,50,"Paste operation in {0}.",a.browserName);return!0}prepareForPaste(a,b){a=!0;if(this.ptd.value.X5g())this.iB=2;else{const c=Date.now()-this.Npf;c>this.Pib&&(Z.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",c),this.hd.Tb(Ed.a.Mha,{["Reason"]:Bd.a.O1g}),b.J_&&b.J_.fail("Prepare for paste timed out",!1),b.failed=!0,a=!1,this.FIh.PTk())}return a}}Object(e.a)(HH,"ClipboardOperationPasteProcessor",null,[1181]);class IH{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc){this.Jr=a;this.Ca=
b;this.XKb=c;this.hd=f;this.$e=l;this.qd=x;this.jk=F;this.JIh=R;this.HIh=fa;this.ypc=wa;this.Hpd=Xa;this.OKb=lb;this.oMa=Lb;this.QC=kc;this.Wc=lc;this.rs=Ec;this.soa=Jc;this.fza=Dc}create(a,b,c,f,l,x,F,R,fa=!0){const wa=this.JIh.create(f,Object(va.a)(10,R));var Xa=this.HIh.create();const lb=new EH(this.Jr,wa),Lb=new GH(this.Jr,ld.a.instance,Xa,wa);Xa=new FH(Xa);f=new HH(u.AFrameworkApplication.fa,Cb.a.instance,f,Sa.a.instance,wa,this.ypc);return new DH(a,b,c,l,x,F,R,this.XKb,this.Ca,this.hd,this.$e,
this.qd,this.jk,lb,Lb,Xa,f,this.ypc,this.Hpd,this.OKb,this.oMa,this.QC,this.Wc,this.rs,this.soa,this.fza,fa)}}Object(e.a)(IH,"Factory",null,[1154]);class $y{constructor(a,b){this.Y6a=a.JLc(b);this.kOd=a.g0i(b);this.F3a=a.KKc(b);this.mNa=a.xKc(b)}static qV(a){return $y.dr(a)}static dr(a){return new $y(eg.a.instance,a)}}Object(e.a)($y,"CpUsageHelper",null,[]);var Cs=d(171);class JH{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb){this.hd=a;this.Jr=b;this.EPb=c;this.raa=f;this.Pc=l;this.Ca=x;this.ptd=F;this.ORb=
fa;this.Tyd=R;this.Zqd=wa;this.Gpd=Xa;this.Wc=lb}get rn(){return this.ORb.value}get r$(){return this.raa}get Tc(){return this.hd}get ZCb(){return this.Tyd.ZCb}paste(a,b){const c=this.Wc.Knb();try{const f=b.Df;Z.ULS.shipAssertTag(18131010,307,!!(b.yw&1));Object(Fa.a)(10,b.ld)&&b.ld.setValue(Cs.a.YXb,f.ug.Bn.clientWidth);this.Gpd.Rql(a,b);let l;if(!({eEc:l}=this.ptd.value.ayh()).returnValue)return b.J_&&b.J_.fail("HTML import strategy failed",!1),b.failed=!0,!1;this.rn.Pv();let x=!0,F=null;const R=
this.Zqd.create(l),fa=b.SCh;f.Eb.Xdd(()=>{fa&&2===this.Ca.processAction(C.a.FAa,2)?x=!1:(F=fa?this.Pc.Oa.kb.Ua:b.ld,Z.ULS.shipAssertTag(18158338,307,fb.SelectionEditor.Kg(F)),this.XAg(F,"paste"))},this.Tyd.uvg);if(!x)return!1;f.editingView.disable(!0,25);R.restore();this.EPb.Ntk(l,F,a);return!0}finally{c&&c.dispose()}}Stk(a,b){this.rn.Pv();const c=(new uF.a).je(15);c.fd(this.Jr.CPe);b=Object(va.a)(10,b.ld).getValue(be.a.tij);Z.ULS.shipAssertTag(20492440,307,fb.SelectionEditor.Kg(b));this.EPb.Zpg(b,
a);this.Jr.mNf();c.dispose();return!0}u3g(a){this.rn.Pv();this.Ca.processAction(C.a.FAa,2);const b=this.Pc.Oa.kb.Ua;Z.ULS.shipAssertTag(18158339,307,fb.SelectionEditor.Kg(b));this.XAg(b,"intPaste");this.EPb.Zpg(b,a);return!0}XAg(a,b){b=$y.qV(b);this.r$.xIk(b,a.node,a.Qa);this.r$.sVj(b.kOd);this.r$.ice(b.Y6a);this.r$.cce(b.F3a);this.r$.bce(b.mNa)}cmh(a,b){if(!b.SCh)return!1;b.yw&64&&this.Jr.Fxl();if(!b.Oqa)return Z.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Tc.Tb(Ed.a.v0,{["Reason"]:Bd.a.eqg}),
b.J_&&b.J_.fail("No selection after paste",!1),b.failed=!0,!1;this.Tyd.lxl(b);this.rn.Pv();return!1}}Object(e.a)(JH,"ClipboardOperationPaste",null,[1180]);class KH{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){this.hd=a;this.Jr=b;this.EPb=c;this.raa=f;this.Pc=l;this.Ca=x;this.ORb=R;this.TRh=F;this.Zqd=fa;this.Gpd=wa;this.Wc=Xa}create(a,b){b=this.TRh.create(this.Pc,b);return new JH(this.hd,this.Jr,this.EPb,this.raa,this.Pc,this.Ca,a,b,this.ORb,this.Zqd,this.Gpd,this.Wc)}}Object(e.a)(KH,"Factory",null,[1151]);
class LH{constructor(a,b){this.PVh=a;this.IRh=b}get stylePropertySet(){return this.PVh}get Msk(){return this.IRh}}Object(e.a)(LH,"ParagraphFormatStore",null,[]);class MH{constructor(a,b,c,f){this.Pc=a;this.Zq=b;this.RJ=c;this.BOh=f}Rql(a,b){if(b.Wub&&this.BOh){b=a.m4;var c=this.Pc.Oa.kb.Ua.node,f=null;this.Zq.Wd(c)&&(f=this.RJ.kD(c),c=this.Zq.hQa(c),f=new LH(f,c));b=new dp(b.context,b.yw,b.J_,b.bJ,b.ld,f);a.m4=b}}}Object(e.a)(MH,"ClipboardOperationPasteOvertypeStrategy",null,[1150]);class kx{constructor(a){this.ywd=
null;this.Pc=a;a.Xdd(b=>{this.ywd=b},!1)}get uvg(){return!1}lxl(a){a=this.WSb(a);this.setSelection(this.Pc,a)}WSb(a){let b=a.Oqa;(a.zJa||a.vFb)&&a.Shd&&(b=nd.SelectionFactory.PM(a.Shd,b.Ua));return b}setSelection(a,b){a.setSelection(b)}}Object(e.a)(kx,"AClipboardOperationPasteStrategy",null,[1205]);class NH extends kx{constructor(a){super(a)}get ZCb(){return this.ywd}}Object(e.a)(NH,"ClipboardOperationPasteToLiveSelectionStrategy",kx,[]);class OH extends kx{constructor(a,b){super(a);this.rEd=null;
this.VOb=b;a.Xdd(c=>{this.rEd=c},!0)}get uvg(){return!0}get ZCb(){return this.rEd}WSb(a){let b=super.WSb(a);a.ld.setValue(be.a.fuk,b);return b=this.VOb.KCl(this.ywd.kb,this.rEd.kb,b)}}Object(e.a)(OH,"ClipboardOperationPasteToVirtualSelectionStrategy",kx,[]);class PH{constructor(a){this.VOb=null;this.qEd=a.ka("EnableVirtualSelectionInSelectionManager")}create(a,b){return b&&b.sa(be.a.zJa,!1)&&this.qEd?new OH(a,this.Mzl):new NH(a)}get Mzl(){this.VOb||(this.VOb=hb.a.instance.pb("Box4.Actors.IVirtualSelectionMerger"));
return this.VOb}}Object(e.a)(PH,"ClipboardOperationPasteStrategyFactory",null,[1153]);class fC{constructor(a,b,c,f,l,x){this.hd=a;this.Pc=b;this.rfa=c;this.LC=f;this.dOh=l;this.POh=x}szk(a){this.POh&&(a&1||a&32)&&this.rfa.Qv&&this.Pc.nSb()}zDj(a,b){return this.dOh?a&1&&this.LC.Z3a(b)?(this.hd.Tb(Ed.a.ph,{["Reason"]:Bd.a.cD}),!1):!0:!0}}Object(e.a)(fC,"ClipboardOperationWordStrategy",null,[]);class QH{constructor(a){this.DJh=a.ka("CssConverterFidelityImprovementIsEnabledIsEnabled")}bui(a,b){if(b)if(b=
b.sheet)if(b=b.cssRules){var c=Array.clone(b);u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordCssConverterFidelityImprovementIsEnabledSettings");this.DJh&&c.reverse();var f=b=0,l=0,x=0;for(const R of c){c=R.style;var F=R.selectorText;c=c?c.cssText:null;F=F?F.split(","):null;if(c&&F&&R.type===R.STYLE_RULE){x+=F.length;for(const fa of F){0<=fa.indexOf("#")&&b++;0<=fa.indexOf(".")&&f++;0>fa.indexOf("#")&&0>fa.indexOf(".")&&l++;F=null;try{F=a.querySelectorAll(fa)}catch(wa){Z.ULS.sendTraceTag(41427107,
307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",fa,wa.message)}if(F)for(let wa=0;wa<F.length;wa++)F[wa].setAttribute("style",c+(F[wa].getAttribute("style")||""))}}}Z.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",x,b,f,l)}else this.pBg();else this.pBg()}pBg(){Z.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",
n.a.iy)}}Object(e.a)(QH,"ExternalPasteCssConverter",null,[1158]);var az=d(1186);class lx{constructor(a){this.zU=this.bOb=null;this.sRb=a.currentNode;const b=new mb.GraphIterator;b.Nc(a);this.yyd=new mb.GraphIterator;this.yyd.Nc(a);this.vyd=b.origin;this.zpd=Array(b.depth);this.Oib=Array(b.depth);this.Apd=Array(b.depth);for(a=b.depth-1;0<=a;--a){const c=b.currentNode;this.Oib[a]=b.role;this.Apd[a]=c;b.uc();this.zpd[a]=b.rZi(c,this.Oib[a])}}Jl(a,b){this.bOb=a;this.zU=b}restore(a){const b=new az.a,c=
new az.a;this.Sfh(a,b,c);return c.value}Sfh(a,b,c){b.value=!0;if(this.yyd.isValid)a.Nc(this.yyd),c.value=!1;else{for(let f=this.Apd.length-1;0<=f;--f){const l=this.Apd[f];if(l.anchor&&!l.anchor.jI&&(a.set(l),a.m$(this.vyd)||this.vyd.R8d&&a.Yyh())){c.value=this.P0f(a,f+1);return}b.value=!1}a.set(this.vyd);c.value=this.P0f(a,0)}}P0f(a,b){let c=!1,f,l;f=this.zpd[b];l=this.Oib[b];const x=a.f7(l);if(f<x)a.Jp(f,l);else if(c=!0,!a.uA(l))return!0;if(!this.ETg(a,l))return c;for(b+=1;b<this.zpd.length;++b){if(c){if(!a.uA(this.Oib[b]))return!0}else if(!a.zb(this.Oib[b]))return!1;
if(!this.ETg(a,this.Oib[b]))break}return c}ETg(a,b){if(this.bOb&&!this.bOb(a,this.zU)){const c=new mb.GraphIterator;c.Nc(a);let f=!0;do if(!a.uf(b)){f=!1;break}while(!this.bOb(a,this.zU));if(!f){a.Nc(c);do if(!a.WE(b))return a.uc(),!1;while(!this.bOb(a,this.zU))}}return!0}}Object(e.a)(lx,"NodeReference",null,[]);var En=d(181);class zj{constructor(a,b,c,f){this.llb=this.Wyd=this.fKa=this.Wc=this.QC=this.Lo=this.Hwh=this.aRb=this.Jo=this.Og=this.xw=this.QJ=this.AH=null;this.bub=a;this.UVd=this.xdb=
null;this.ih=b;this.transaction=c;this.yga=f}get fa(){return u.AFrameworkApplication.fa}get qO(){return this.QJ||(this.QJ=hb.a.instance.resolve("Box4.Styles.IStyleEditor"))}get paragraphEditor(){return this.xw||(this.xw=hb.a.instance.resolve("Box4.IParagraphEditor"))}get SI(){return this.AH||(this.AH=hb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}get WA(){return zj.ox||(zj.ox=hb.a.instance.resolve("Box4.IOutlineEditor"))}get Rf(){return this.Og||(this.Og=hb.a.instance.resolve("Box4.List.IListReader"))}get ao(){return this.Jo||
(this.Jo=hb.a.instance.resolve("Box4.List.IListEditor"))}get Lkc(){return this.aRb||(this.aRb=hb.a.instance.pb("Box4.List.ISingleLevelListEditor"))}get k5(){return this.Lo||(this.Lo=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get Emc(){return this.QC||(this.QC=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get Nf(){return this.Wc||(this.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get sLd(){return this.fKa||
(this.fKa=hb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get z9c(){return this.Wyd||(this.Wyd=hb.a.instance.pb("Box4.IPastedParagraphSpaceHandler"))}set z9c(a){this.Wyd=a}get O3g(){return!1}get qoh(){return this.fa.ka("WordEditorAutoResizeImageIsEnabled")}t0f(){}z3g(a){var b=void 0===this.ih.yw||null===this.ih.yw?"not available":Object(dC.a)(hv,this.ih.yw);Z.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.ih.yw,b);Z.ULS.shipAssertTag(6305487,307,fb.SelectionEditor.Kg(this.bub));
if(this.$5c)return Z.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.ih.Oqa=nd.SelectionFactory.eu(this.bub),a.Wg(Object(D.a)(this,this.tWa,"pasteTeardown")),!0;b=new mb.GraphIterator;b.set(this.bub.node);fb.SelectionEditor.Vs(b);Yb.OutlineElementNavigator.Je(b);this.Hwh=b.origin;if(this.O3g)return b.oC(10),this.t0f(b,a),a.Wg(Object(D.a)(this,this.V4k,"setSelectionAfterPastingOutlines")),!0;if(ph.b(b)){if(this.Qrg)return this.ih.Oqa=this.Ztk(this.bub,this.ZPf),a.Wg(Object(D.a)(this,this.tWa,
"pasteTeardown")),!0;this.bub=this.Ddk(b).ga(0)}this.Vfl(this.bub);const c=new En.a;c.Nc(b);Yb.OutlineElementNavigator.OI(c,!1,!1);this.xdb=new lx(b);this.UVd=new lx(c);a.Wg(Object(D.a)(this,this.Qtk,"pasteExecution"));return!0}Qtk(a){N.a.mark(5568);this.s0f(a);let b=Object(D.a)(this,this.ack,"mergeAfterPaste");if(this.Bug){const c=this.cph();c&&(b=Object(D.a)(this,this.tWa,"pasteTeardown"));Z.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",c)}a.Wg(b);return!0}cph(){return!1}get Bug(){return this.fa.ka("PptCcpFix2IsEnabled")}get i9k(){return this.fa.ka("CopyAndPasteOneParagraphIndentationFixIsEnabled")}ack(a){N.a.mark(5569);
var b=new mb.GraphIterator;this.xdb.restore(b);this.xdb=null;var c=new mb.GraphIterator;this.UVd.restore(c);this.UVd=null;Z.ULS.shipAssertTag(6305489,307,Rd.OutlineElementReader.Tg(b));Z.ULS.shipAssertTag(6305490,307,Rd.OutlineElementReader.Tg(c));Yb.OutlineElementNavigator.oi(b);Ya.ParagraphReader.Lk(b)&&Ya.ParagraphReader.textLength(b.currentNode);Yb.OutlineElementNavigator.Je(b);Yb.OutlineElementNavigator.oi(c);Z.ULS.shipAssertTag(6305491,307,Ya.ParagraphReader.Lk(c));var f=Ya.ParagraphReader.textLength(c.currentNode);
Yb.OutlineElementNavigator.Je(c);const l=this.Coh;var x=new En.a;x.Nc(b);Yb.OutlineElementNavigator.OI(x,!1,!1);var F=x.currentNode===c.currentNode;var R=!!this.ih&&!!(this.ih.yw&8192);let fa=!1;!R&&this.ih.ld&&Object(Fa.a)(E.DictionaryPropertySet,this.ih.ld)&&2===Gb.App.mode&&(R=(R=this.ih.ld.Sh(be.a.mdb))&&""!==R?!0:!1);if(F)x=mb.GraphIterator.mb(b.currentNode),Ya.ParagraphReader.Mr(Yb.OutlineElementNavigator.oi(x))||(b=c),b.currentNode.id!==c.currentNode.id&&(Z.ULS.sendTraceTag(40691869,307,50,
"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Ib.ListReader.ak(b),Ib.ListReader.ak(c)),x=zj.Jh.merge(b,c,!0,R),Z.ULS.shipAssertTag(6305492,307,x)),c=b,R=!0;else{var wa=!!(this.ih.yw&4);F=this.Nf.Zf&&this.Nf.jy&&wa&&this.ih.d8a;this.z9c&&this.ih&&2===Gb.App.mode&&!wa&&(this.z9c.hpj(b,!1),this.z9c.hpj(c,!0));Yb.OutlineElementNavigator.oi(x);Ya.ParagraphReader.Lk(x)&&Ya.ParagraphReader.textLength(x.currentNode);Yb.OutlineElementNavigator.Je(x);this.K9h(x,
b,c);if(this.sLd.CUb||this.i9k)if(wa=new En.a,wa.Nc(x),Yb.OutlineElementNavigator.OI(wa,!1,!1),wa.hq.id!==c.hq.id){for(;x.currentNode.id!==c.currentNode.id;)Yb.OutlineElementNavigator.oi(x,!1),Pc.a.create(x.currentNode),x.uc(),Yb.OutlineElementNavigator.OI(x,!1,!1);x.Nc(b);Yb.OutlineElementNavigator.OI(x,!1,!1)}else fa=!0;if(this.ih.Ucd&&(Z.ULS.shipAssertTag(6305493,307,this.ih.Wub),wa=new mb.GraphIterator,wa.Nc(x),wa=Yb.OutlineElementNavigator.oi(wa))){var Xa=this.ih.Ucd.Sd(wa.Ra.ga(0));wa.Ra.ga(0).formatting=
Xa}Ib.ListReader.ak(b)?(zj.KK.H4b&&this.Lkc&&this.Lkc.UCl(b),wa=Ib.ListReader.ak(x)?this.Doh:!0):Rd.OutlineElementReader.isEmpty(b,!0)?(zj.Jh.LAa(b),wa=!1):wa=Ib.ListReader.Lw||!Ib.ListReader.ak(x);this.ih.Shd=null;if(this.ih.vFb||this.ih.zJa)this.ih.Shd=this.Adj(wa?b.currentNode:x.currentNode,wa);if(wa&&(Xa=Ib.ListReader.ak(b),Z.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Xa,Ib.ListReader.ak(c)),zj.Jh.merge(b,x,!0,R,c,void 0,
fa,F),Ib.ListReader.ak(b)&&this.Rf.Ufc)){var lb=new En.a;lb.Nc(b);Yb.OutlineElementNavigator.OI(lb,!1,!1);if(lb.hq.id!==c.hq.id){var Lb=this.Rf.Fw(b);this.Rf.gla(b);const Ec=b.currentNode.sa(Bb.a.listID,0);b.uc();for(Lb.Yz=Pk.a.kw;lb.currentNode.id!==c.currentNode.id;){if(!Ib.ListReader.ak(lb))({G7a:Lb}=this.ao.onb(Lb.propertySet,lb,Lb));else if(Xa){var kc=this.Rf.d6i(lb),lc=this.Rf.KZd(b.currentNode,Ec,kc);lc=lc?uj.a.uAa(lc,null):Lb;kc=uj.a.kP(lc.listType,Lb.listStyle,null,0,kc,"","");kc.sgk=b.currentNode;
this.ao.T3k(kc);this.ao.uIe(lb,!0)}Yb.OutlineElementNavigator.OI(lb,!1,!1)}}}l?(Xa=new En.a,Xa.Nc(c),Yb.OutlineElementNavigator.Iua(Xa,!1,!1),lb=Ib.ListReader.ak(Xa),Lb=Ib.ListReader.ak(c),R=zj.Jh.merge(Xa,c,!0,R,void 0,!0,void 0,F),Z.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",lb,Lb,R?"True":"False, will cause IP to reset to zero."),c=R?Xa:c):(R=!1,Z.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero."));
this.sLd.CUb&&fa&&(wa?(x=new mb.GraphIterator,x.Nc(b),Yb.OutlineElementNavigator.oi(x)):l?(b=new mb.GraphIterator,b.Nc(x),Yb.OutlineElementNavigator.oi(b)):(b=new mb.GraphIterator,b.Nc(x),b=Yb.OutlineElementNavigator.oi(b),Pc.a.create(b)))}Z.ULS.shipAssertTag(6305494,307,c.isValid);b=Yb.OutlineElementNavigator.oi(c);f=R?Ya.ParagraphReader.textLength(b)-f:0;x=!1;Object(Fa.a)(10,this.ih.ld)&&(x=this.ih.ld.sa(be.a.nSc,!1));x&&H.a.instance.ga(11)?this.ih.Oqa=nd.SelectionFactory.P1(b,f-1,f):this.ih.Oqa=
nd.SelectionFactory.Jg(b,f);H.a.instance.ga(71)&&this.ih&&this.ih.Wub&&Ya.ParagraphReader.Wd(b)&&this.ih.P8c&&((f=this.ih.P8c.stylePropertySet)&&this.qO.Y9(f,b,!0),(f=this.ih.P8c.Msk)&&this.paragraphEditor.FFf(b,f));a.Wg(Object(D.a)(this,this.tWa,"pasteTeardown"));return!0}K9h(a,b,c){var f=!1;this.Nf.Zf&&this.Nf.jy&&(f=!0);if(f){for(;a.currentNode!==c.currentNode;){Yb.OutlineElementNavigator.oi(a,!1);f=this.Emc.Nfl(Pc.a.create(a.currentNode));f.hfg();for(let l=0;l<f.length;l++){let x;const F=({Mxg:x}=
f.getContext(l)).returnValue;x&&zj.hyperlinkEditor.KBb(F,1)}a.uc();Yb.OutlineElementNavigator.OI(a,!1,!1)}a.Nc(b);Yb.OutlineElementNavigator.OI(a,!1,!1)}}Adj(a,b){a=mb.GraphIterator.mb(a);Yb.OutlineElementNavigator.oi(a);return Ya.ParagraphReader.Wd(a.currentNode)?(b=b?Ya.ParagraphReader.textLength(a.currentNode):0,nd.SelectionFactory.Jg(a.currentNode,b)):xd.TableReader.O8a(a.currentNode)?nd.SelectionFactory.Xk(a.currentNode):null}V4k(a){const b=mb.GraphIterator.mb(this.Hwh);b.uA(1);this.ih.Oqa=nd.SelectionFactory.nj(b.currentNode,
!1);a.Wg(Object(D.a)(this,this.tWa,"pasteTeardown"));return!0}tWa(){var a=void 0===this.ih.yw||null===this.ih.yw?"not available":Object(dC.a)(hv,this.ih.yw);Z.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.ih.yw,a);Z.ULS.shipAssertTag(6305497,307,!!this.ih.Oqa);this.transaction.dispose();a=this.yga.VJ;if(!a.Hh||!a.editingView.Bl)return!1;a.editingView.xkl();return!1}y8k(a,b){const c=new mb.GraphIterator;c.Nc(a);a=Yb.OutlineElementNavigator.oi(c);b=Ya.ParagraphReader.Wd(a)&&b===Ya.ParagraphReader.textLength(a);
Z.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",b);return b}Vfl(a){Z.ULS.shipAssertTag(6305498,307,fb.SelectionEditor.Kg(a));const b=mb.GraphIterator.mb(a.node);var c=b.Ze();Yb.OutlineElementNavigator.Je(b);Z.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:c,["ipContextNodeType"]:a.node.type});c=zj.Jh.L2b(b,!0);const f=this.y8k(b,a.Qa);zj.Jh.uHb(b,c,a,!1,!1,f)}Ztk(a,b){Z.ULS.shipAssertTag(6305500,307,a.contextId===Fb.a.Lf);
const c=a.node;b=b.replace(Ma.a.Dtc," ");zj.characterPropertiesEditor.replaceTextRange(a,b);return nd.SelectionFactory.Jg(c,a.Qa+b.length)}Ddk(a){a.uv();zj.Hl.KHa(a);const b=zj.sk.qbg(a),c=this.SI.tWb(a);b?oq.c(a.currentNode,b+1,b+2):this.WA.Dfd(c,Gb.App.Fb.Ed.en.T0b());this.WA.K2b(a,null,!0);return nd.SelectionFactory.nj(a.currentNode,!0)}static get Hl(){return sy.PageNavigator.instance}static get characterPropertiesEditor(){return zj.Vg||(zj.Vg=hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hyperlinkEditor(){return zj.Xm||
(zj.Xm=hb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get sk(){return Pw.PageReader.instance}static get Jh(){return zj.xi||(zj.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get KK(){return zj.GJ||(zj.GJ=hb.a.instance.pb("Box4.List.ListSettings"))}static get pe(){return zj.Xc||(zj.Xc=hb.a.instance.pb("Box4.IFeatureHelper"))}}zj.ox=null;zj.Xc=null;zj.xi=null;zj.Vg=null;zj.Xm=null;zj.GJ=null;Object(e.a)(zj,"APasteExecutionManager",null,[]);var DP=d(1185);class RH{constructor(){this.yw=
0;this.aWb=6;this.xWd=this.wWd=this.W4f=this.vWd=this.uWd=this.tWd=this.sWd=!1;this.pAe=null;this.V4f=this.K5a=this.HZb=this.U4f=this.Y4f=!1;this.H3g=this.XCb=0;this.Nwe=this.platform=null;this.c0a={}}get LMe(){if(this.xWd)return"Word Online";if(this.vWd)return"Google Docs";if(this.wWd||this.tWd||this.uWd)return"PowerPoint Online";if(this.sWd)return"Excel Online";switch(this.pAe){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}kWj(){Z.ULS.sendTraceTag(51406241,
307,50,JSON.stringify(this.Xdi()))}lWj(){const a=this.c0a;for(let c in a){var b=c;const f=a[c];f&&(f.SourceApp=this.LMe,f.Browser=DP.a[this.XCb],f.TagName=b,f.OperationId=this.Nwe,Z.ULS.sendTraceTag(51406242,307,50,JSON.stringify(f)))}}cvj(a,b){a&&a.length&&b&&b.length&&(a=a.toLowerCase(),b=b.toLowerCase(),a in this.c0a||(this.c0a[a]={}),this.c0a[a][b]=this.Vdj(a,b)+1)}Vdj(a,b){if(!(a&&a.length&&b&&b.length&&this.c0a&&a in this.c0a))return 0;a=a.toLowerCase();b=b.toLowerCase();return(a=this.c0a[a])&&
b in a?a[b]:0}Xdi(){const a={};a.ActionIdFlags=this.yw;a.FoundDataCcpTimestampAttribute=this.sWd;a.FoundDataClipserviceCcpidAttribute=this.tWd;a.FoundDataShapeIdsAttribute=this.uWd;a.FoundGoogleDocsInternalGuidId=this.vWd;a.FoundOneNoteOnlineSequenceClass=this.W4f;a.FoundPowerPointOnlineSequenceClass=this.wWd;a.FoundWordOnlineSequenceClass=this.xWd;a.ProgId=this.pAe;a.SourceApp=this.LMe;a.FoundText=this.Y4f;a.FoundEquation=this.U4f;a.FoundList=this.HZb;a.FoundTable=this.K5a;a.FoundImage=this.V4f;
a.CopySourceBrowser=this.aWb;a.PasteBrowser=this.XCb;a.IsSameBrowserPaste=this.mMj(this.aWb,this.XCb);a.IsCrossBrowserPaste=this.pEj(this.aWb,this.XCb);a.IsUncategorizedBrowserPaste=this.fPj(this.aWb,this.XCb);a.Platform=this.platform;a.PastedHtmlLength=this.H3g;a.OperationId=this.Nwe;return a}mMj(a,b){return 5===a||6===a?!1:a===b}pEj(a,b){return 6===a?!1:a!==b}fPj(a,b){return 5===a&&5===b}}Object(e.a)(RH,"HtmlContentMetadata",null,[]);class bz{constructor(a,b,c=!1){this.Tf=a;this.Nv=b;this.M8h=c}}
Object(e.a)(bz,"TagEventParam",null,[]);class gC{constructor(a,b=null){this.Fqc=this.uqf=this.SDd=this.Ryf=null;this.Ic=a;this.CR=b||Pm.a.j$f("");this.u6k()}get Hb(){return this.CR}cgk(a,b,c){this.SDd[b]?this.nVg():(this.Hb.e++,(b=this.Fqc[b])&&b(new bz(a,c,!1)),this.Hb.b++)}nVg(){this.Hb.d++}Wfk(){this.Hb.c++}Qfk(a,b,c){if(this.SDd[b])this.nVg();else{if(b=this.Fqc[b])return this.Hb.b++,b(new bz(a,c,!1));this.Hb.f++}return 2}u6k(){this.Ryf=xa.a.gH("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,
"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.SDd=xa.a.gH("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this.uqf=xa.a.gH("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);let a=this.Ic,b=
this.Ic,c=this.Ic,f=this.Ic,l=this.Ic,x=this.Ic,F=this.Ic,R=this.Ic,fa=this.Ic,wa=this.Ic,Xa=this.Ic,lb=this.Ic,Lb=this.Ic,kc=this.Ic,lc=this.Ic,Ec=this.Ic,Jc=this.Ic,Dc=this.Ic,Wd=this.Ic,xe=this.Ic;this.Fqc=xa.a.gH("A",Object(D.a)(this.Ic,this.Ic.l6c,"onAOpen"),"ABBR",Object(D.a)(this.Ic,this.Ic.Lte,"onAbbrOpen"),"ACRONYM",Object(D.a)(this.Ic,this.Ic.Mte,"onAcronymOpen"),"ADDRESS",Object(D.a)(this.Ic,this.Ic.Nte,"onAddressOpen"),"APPLET",Object(D.a)(this.Ic,this.Ic.Ute,"onAppletOpen"),"AREA",Object(D.a)(this.Ic,
this.Ic.Xte,"onAreaTag"),"B",Object(D.a)(this.Ic,this.Ic.q6c,"onBOpen"),"BASE",Object(D.a)(this.Ic,this.Ic.Yte,"onBaseTag"),"BASEFONT",Object(D.a)(this.Ic,this.Ic.Zte,"onBasefontTag"),"BDO",Object(D.a)(this.Ic,this.Ic.$te,"onBdoOpen"),"BIG",Object(D.a)(this.Ic,this.Ic.w6c,"onBigOpen"),"BLOCKQUOTE",Object(D.a)(this.Ic,this.Ic.x6c,"onBlockquoteOpen"),"BODY",Object(D.a)(this.Ic,this.Ic.nue,"onBodyOpen"),"BR",Object(D.a)(this.Ic,this.Ic.y6c,"onBrTag"),"BUTTON",Object(D.a)(this.Ic,this.Ic.rue,"onButtonOpen"),
"CAPTION",Object(D.a)(this.Ic,this.Ic.z6c,"onCaptionOpen"),"CENTER",Object(D.a)(this.Ic,this.Ic.B6c,"onCenterOpen"),"CITE",Object(D.a)(this.Ic,this.Ic.E6c,"onCiteOpen"),"CODE",Object(D.a)(this.Ic,this.Ic.G6c,"onCodeOpen"),"COL",Object(D.a)(this.Ic,this.Ic.Due,"onColTag"),"COLGROUP",Object(D.a)(this.Ic,this.Ic.Eue,"onColgroupOpen"),"DD",Object(D.a)(this.Ic,this.Ic.J6c,"onDdOpen"),"DEL",Object(D.a)(this.Ic,this.Ic.K6c,"onDelOpen"),"DFN",Object(D.a)(this.Ic,this.Ic.M6c,"onDfnOpen"),"DIR",Object(D.a)(this.Ic,
this.Ic.N6c,"onDirOpen"),"DIV",Object(D.a)(this.Ic,this.Ic.P6c,"onDivOpen"),"DL",Object(D.a)(this.Ic,this.Ic.Q6c,"onDlOpen"),"DT",Object(D.a)(this.Ic,this.Ic.R6c,"onDtOpen"),"EM",Object(D.a)(this.Ic,this.Ic.U6c,"onEmOpen"),"FIELDSET",Object(D.a)(this.Ic,this.Ic.Yue,"onFieldsetOpen"),"FONT",Object(D.a)(this.Ic,this.Ic.b7c,"onFontOpen"),"FORM",Object(D.a)(this.Ic,this.Ic.dve,"onFormOpen"),"FRAME",Object(D.a)(this.Ic,this.Ic.eve,"onFrameTag"),"FRAMESET",Object(D.a)(this.Ic,this.Ic.fve,"onFramesetOpen"),
"H1",Object(D.a)(this.Ic,this.Ic.g7c,"onH1Open"),"H2",Object(D.a)(this.Ic,this.Ic.h7c,"onH2Open"),"H3",Object(D.a)(this.Ic,this.Ic.i7c,"onH3Open"),"H4",Object(D.a)(this.Ic,this.Ic.j7c,"onH4Open"),"H5",Object(D.a)(this.Ic,this.Ic.k7c,"onH5Open"),"H6",Object(D.a)(this.Ic,this.Ic.l7c,"onH6Open"),"HEAD",Object(D.a)(this.Ic,this.Ic.jve,"onHeadOpen"),"HR",Object(D.a)(this.Ic,this.Ic.m7c,"onHrTag"),"HTML",Object(D.a)(this.Ic,this.Ic.lve,"onHtmlOpen"),"I",Object(D.a)(this.Ic,this.Ic.n7c,"onIOpen"),"IFRAME",
Object(D.a)(this.Ic,this.Ic.nve,"onIframeOpen"),"IMG",Object(D.a)(this.Ic,this.Ic.o7c,"onImgTag"),"INPUT",Object(D.a)(this.Ic,this.Ic.pve,"onInputTag"),"INS",Object(D.a)(this.Ic,this.Ic.p7c,"onInsOpen"),"ISINDEX",Object(D.a)(this.Ic,this.Ic.wve,"onIsindexOpen"),"KBD",Object(D.a)(this.Ic,this.Ic.q7c,"onKbdOpen"),"LABEL",Object(D.a)(this.Ic,this.Ic.s7c,"onLabelOpen"),"LEGEND",Object(D.a)(this.Ic,this.Ic.u7c,"onLegendOpen"),"LI",Object(D.a)(this.Ic,this.Ic.v7c,"onLiOpen"),"LINK",Object(D.a)(this.Ic,
this.Ic.zve,"onLinkTag"),"MAP",Object(D.a)(this.Ic,this.Ic.Ave,"onMapOpen"),"MATH",Object(D.a)(this.Ic,this.Ic.z7c,"onMathOpen"),"MENU",Object(D.a)(this.Ic,this.Ic.gCb,"onMenuOpen"),"META",Object(D.a)(this.Ic,this.Ic.Cve,"onMetaTag"),"NOFRAMES",Object(D.a)(this.Ic,this.Ic.Fve,"onNoframesOpen"),"NOSCRIPT",Object(D.a)(this.Ic,this.Ic.Gve,"onNoscriptOpen"),"OBJECT",Object(D.a)(this.Ic,this.Ic.Hve,"onObjectOpen"),"OL",Object(D.a)(this.Ic,this.Ic.G7c,"onOlOpen"),"OPTGROUP",Object(D.a)(this.Ic,this.Ic.Ive,
"onOptgroupOpen"),"OPTION",Object(D.a)(this.Ic,this.Ic.K7c,"onOptionOpen"),"P",Object(D.a)(this.Ic,this.Ic.N7c,"onPOpen"),"PARAM",Object(D.a)(this.Ic,this.Ic.Kve,"onParamTag"),"PRE",Object(D.a)(this.Ic,this.Ic.Z7c,"onPreOpen"),"Q",Object(D.a)(this.Ic,this.Ic.Uve,"onQOpen"),"S",Object(D.a)(this.Ic,this.Ic.g8c,"onSOpen"),"SAMP",Object(D.a)(this.Ic,this.Ic.h8c,"onSampOpen"),"SCRIPT",Object(D.a)(this.Ic,this.Ic.ewe,"onScriptOpen"),"SELECT",Object(D.a)(this.Ic,this.Ic.fwe,"onSelectOpen"),"SMALL",Object(D.a)(a,
a.r8c,"onSmallOpen"),"SPAN",Object(D.a)(b,b.s8c,"onSpanOpen"),"STRIKE",Object(D.a)(c,c.t8c,"onStrikeOpen"),"STRONG",Object(D.a)(f,f.u8c,"onStrongOpen"),"STYLE",Object(D.a)(l,l.lwe,"onStyleOpen"),"SUB",Object(D.a)(x,x.v8c,"onSubOpen"),"SUP",Object(D.a)(F,F.w8c,"onSupOpen"),"TABLE",Object(D.a)(R,R.A8c,"onTableOpen"),"TBODY",Object(D.a)(fa,fa.owe,"onTbodyOpen"),"TD",Object(D.a)(wa,wa.Hdc,"onTdOpen"),"TEXTAREA",Object(D.a)(Xa,Xa.qwe,"onTextareaOpen"),"TFOOT",Object(D.a)(lb,lb.rwe,"onTfootOpen"),"TH",
Object(D.a)(Lb,Lb.B8c,"onThOpen"),"THEAD",Object(D.a)(kc,kc.swe,"onTheadOpen"),"TITLE",Object(D.a)(lc,lc.uwe,"onTitleOpen"),"TR",Object(D.a)(Ec,Ec.C8c,"onTrOpen"),"TT",Object(D.a)(Jc,Jc.F8c,"onTtOpen"),"U",Object(D.a)(Dc,Dc.G8c,"onUOpen"),"UL",Object(D.a)(Wd,Wd.H8c,"onUlOpen"),"VAR",Object(D.a)(xe,xe.J8c,"onVarOpen"))}}Object(e.a)(gC,"AHtmlProcessor",null,[]);class hC{constructor(a,b){this.childNodes=a.childNodes;this.Nv=b;this.PPd=0;this.wRc=!1}}Object(e.a)(hC,"HtmlProcessorArguments",null,[]);class Zq extends gC{constructor(a,
b=null){super(a,b);this.Vud=null}get pKj(){null==this.Vud&&(this.Vud=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.Vud}process(a,b=null){a&&(this.Ic.reset(),this.V6g(new hC(a,new Nt),b))}V6g(a,b){a.childNodes.length&&(a=new wc.a(b,Object(D.a)(this,this.AAk,"processChild"),a),a.xl("HTML Processing Operation"),b||(a.Vi=!0),a.run())}AAk(a,b){const c=b.childNodes[b.PPd];if(3===c.nodeType)return this.Ic.s6c(),this.Ic.I_(c.nodeValue,
new bz(c,b.Nv.b8f())),Zq.YIb(b);if(1!==c.nodeType)return Zq.YIb(b);if(!b.wRc){const l=Ma.a.cB(c.tagName);if(!Zq.iqj(c))if(this.uqf[l])this.Wfk();else{Zq.Cak(c);this.Ic.s6c();var f=c.id;const x=c.tagName,F=b.Nv.b8f(),R=c.getAttribute?c.getAttribute("class"):null;f=new Ot(f,x,R?R:"",c.attributes?c.attributes.length:0);f.isValid&&F.add(f);if(this.Ryf[l])return this.cgk(c,l,F),Zq.YIb(b);f=!1;switch(this.Qfk(c,l,F)){case 1:f=!0;break;case 3:return Zq.YIb(b)}switch(this.Ic.z2d(c)){case 1:f=!0}b.wRc=f;this.V6g(new hC(c,
F),a);if(!a.Vi)return!0}}if(b.wRc){if(this.pKj&&!this.Fqc[Ma.a.cB(c.tagName)])return Zq.YIb(b);this.Ic.onClose()}return Zq.YIb(b)}static Cak(a){3!==a.nodeType&&L.a.ov(a,"alreadyPasted",!0)}static iqj(a){return 3!==a.nodeType&&L.a.re(a,"alreadyPasted")}static YIb(a){a.PPd++;a.wRc=!1;return a.PPd<a.childNodes.length}}Object(e.a)(Zq,"HtmlProcessor",gC,[]);var Lr=d(915);class SH{constructor(a,b=null,c=null,f=null){this.Vd=a;this.CR=b||Pm.a.i$f(n.a.l3a,"");this.eq=c;this.Moa=f?f.ka("ParseStyleForHtmlTagEventIsEnabled"):
!1}get Hb(){return this.CR}get xn(){return this.eq}zf(a){return a?a+1:1}reset(){this.Vd.reset()}s6c(){this.Vd.s6c()}z2d(a){if(a&&this.xn&&(a.getAttribute&&(a.getAttribute(Lr.a.cUf)&&(this.xn.sWd=!0),a.getAttribute(Lr.a.dUf)&&(this.xn.tWd=!0),a.getAttribute(Lr.a.hUf)&&(this.xn.uWd=!0)),a.id&&a.id.startsWith&&a.id.startsWith(Lr.a.ggg)&&(this.xn.vWd=!0),a.className&&a.className.split))for(const b of a.className.split(" ")){b.startsWith(Lr.a.m1g)&&(this.xn.W4f=!0);b.startsWith(Lr.a.p5g)&&(this.xn.wWd=
!0);b.startsWith(Lr.a.iEh)&&(this.xn.xWd=!0);if(b.startsWith(n.a.WTb)&&b.length===n.a.WTb.length+1){const c=parseInt(Ma.a.substring(b,b.length-1,b.length));isNaN(c)||(this.xn.aWb=c)}if(b===Lr.a.aUg||b===Lr.a.bUg)this.xn.HZb=!0}return this.Vd.z2d(a)}onClose(){this.Vd.onClose()}I_(a,b){this.xn&&(this.xn.Y4f=!0);this.Hb.d=this.zf(this.Hb.d);this.Moa&&this.qva(b);this.Vd.I_(a,b)}l6c(a){this.Hb.e=this.zf(this.Hb.e);this.Moa&&this.qva(a);return this.Vd.l6c(a)}Lte(a){this.Hb.f=this.zf(this.Hb.f);return this.Vd.Lte(a)}Mte(a){this.Hb.g=
this.zf(this.Hb.g);return this.Vd.Mte(a)}Nte(a){this.Hb.h=this.zf(this.Hb.h);return this.Vd.Nte(a)}Ute(a){this.Hb.i=this.zf(this.Hb.i);return this.Vd.Ute(a)}Xte(a){this.Hb.j=this.zf(this.Hb.j);this.Vd.Xte(a)}q6c(a){this.Hb.k=this.zf(this.Hb.k);return this.Vd.q6c(a)}Yte(a){this.Hb.l=this.zf(this.Hb.l);this.Vd.Yte(a)}Zte(a){this.Hb.m=this.zf(this.Hb.m);this.Vd.Zte(a)}$te(a){this.Hb.n=this.zf(this.Hb.n);return this.Vd.$te(a)}w6c(a){this.Hb.o=this.zf(this.Hb.o);return this.Vd.w6c(a)}x6c(a){this.Hb.p=
this.zf(this.Hb.p);return this.Vd.x6c(a)}nue(a){this.Hb.q=this.zf(this.Hb.q);return this.Vd.nue(a)}y6c(a){this.Hb.r=this.zf(this.Hb.r);this.Vd.y6c(a)}rue(a){this.Hb.s=this.zf(this.Hb.s);return this.Vd.rue(a)}z6c(a){this.Hb.t=this.zf(this.Hb.t);return this.Vd.z6c(a)}B6c(a){this.Hb.u=this.zf(this.Hb.u);return this.Vd.B6c(a)}E6c(a){this.Hb.v=this.zf(this.Hb.v);return this.Vd.E6c(a)}G6c(a){this.Hb.w=this.zf(this.Hb.w);return this.Vd.G6c(a)}Due(a){this.Hb.x=this.zf(this.Hb.x);this.Vd.Due(a)}Eue(a){this.Hb.y=
this.zf(this.Hb.y);return this.Vd.Eue(a)}J6c(a){this.Hb.z=this.zf(this.Hb.z);return this.Vd.J6c(a)}K6c(a){this.Hb.ba=this.zf(this.Hb.ba);return this.Vd.K6c(a)}M6c(a){this.Hb.bb=this.zf(this.Hb.bb);return this.Vd.M6c(a)}N6c(a){this.Hb.bc=this.zf(this.Hb.bc);return this.Vd.N6c(a)}P6c(a){this.Hb.bd=this.zf(this.Hb.bd);return this.Vd.P6c(a)}Q6c(a){this.Hb.be=this.zf(this.Hb.be);return this.Vd.Q6c(a)}R6c(a){this.Hb.bf=this.zf(this.Hb.bf);return this.Vd.R6c(a)}U6c(a){this.Hb.bg=this.zf(this.Hb.bg);return this.Vd.U6c(a)}Yue(a){this.Hb.bh=
this.zf(this.Hb.bh);return this.Vd.Yue(a)}b7c(a){this.Hb.bi=this.zf(this.Hb.bi);return this.Vd.b7c(a)}dve(a){this.Hb.bj=this.zf(this.Hb.bj);return this.Vd.dve(a)}eve(a){this.Hb.bk=this.zf(this.Hb.bk);this.Vd.eve(a)}fve(a){this.Hb.bl=this.zf(this.Hb.bl);return this.Vd.fve(a)}g7c(a){this.Hb.bm=this.zf(this.Hb.bm);return this.Vd.g7c(a)}h7c(a){this.Hb.bm=this.zf(this.Hb.bm);return this.Vd.h7c(a)}i7c(a){this.Hb.bm=this.zf(this.Hb.bm);return this.Vd.i7c(a)}j7c(a){this.Hb.bm=this.zf(this.Hb.bm);return this.Vd.j7c(a)}k7c(a){this.Hb.bm=
this.zf(this.Hb.bm);return this.Vd.k7c(a)}l7c(a){this.Hb.bm=this.zf(this.Hb.bm);return this.Vd.l7c(a)}jve(a){this.Hb.bn=this.zf(this.Hb.bn);return this.Vd.jve(a)}m7c(a){this.Hb.bo=this.zf(this.Hb.bo);this.Vd.m7c(a)}lve(a){this.Hb.bp=this.zf(this.Hb.bp);return this.Vd.lve(a)}n7c(a){this.Hb.bq=this.zf(this.Hb.bq);return this.Vd.n7c(a)}nve(a){this.Hb.br=this.zf(this.Hb.br);return this.Vd.nve(a)}o7c(a){this.xn&&(this.xn.V4f=!0);this.Moa&&this.qva(a);this.Hb.bs=this.zf(this.Hb.bs);this.Vd.o7c(a)}pve(a){this.Hb.bt=
this.zf(this.Hb.bt);this.Vd.pve(a)}p7c(a){this.Hb.bu=this.zf(this.Hb.bu);return this.Vd.p7c(a)}wve(a){this.Hb.bv=this.zf(this.Hb.bv);return this.Vd.wve(a)}q7c(a){this.Hb.bw=this.zf(this.Hb.bw);return this.Vd.q7c(a)}s7c(a){this.Hb.bx=this.zf(this.Hb.bx);return this.Vd.s7c(a)}u7c(a){this.Hb.by=this.zf(this.Hb.by);return this.Vd.u7c(a)}v7c(a){this.xn&&(this.xn.HZb=!0);this.Hb.bz=this.zf(this.Hb.bz);this.Moa&&this.qva(a);return this.Vd.v7c(a)}zve(a){this.Hb.ca=this.zf(this.Hb.ca);this.Vd.zve(a)}Ave(a){this.Hb.cb=
this.zf(this.Hb.cb);return this.Vd.Ave(a)}z7c(a){this.xn&&(this.xn.U4f=!0);this.Hb.cc=this.zf(this.Hb.cc);return this.Vd.z7c(a)}gCb(a){this.Hb.cd=this.zf(this.Hb.cd);return this.Vd.gCb(a)}Cve(a){this.Hb.ce=this.zf(this.Hb.ce);this.Vd.Cve(a)}Fve(a){this.Hb.cf=this.zf(this.Hb.cf);return this.Vd.Fve(a)}Gve(a){this.Hb.cg=this.zf(this.Hb.cg);return this.Vd.Gve(a)}Hve(a){this.Hb.ch=this.zf(this.Hb.ch);return this.Vd.Hve(a)}G7c(a){this.xn&&(this.xn.HZb=!0);this.Hb.ci=this.zf(this.Hb.ci);this.Moa&&this.qva(a);
return this.Vd.G7c(a)}Ive(a){this.Hb.cj=this.zf(this.Hb.cj);return this.Vd.Ive(a)}K7c(a){this.Hb.ck=this.zf(this.Hb.ck);return this.Vd.K7c(a)}N7c(a){this.Hb.cl=this.zf(this.Hb.cl);this.Moa&&this.qva(a);return this.Vd.N7c(a)}Kve(a){this.Hb.cm=this.zf(this.Hb.cm);this.Vd.Kve(a)}Z7c(a){this.Hb.cn=this.zf(this.Hb.cn);return this.Vd.Z7c(a)}Uve(a){this.Hb.co=this.zf(this.Hb.co);return this.Vd.Uve(a)}g8c(a){this.Hb.cp=this.zf(this.Hb.cp);return this.Vd.g8c(a)}h8c(a){this.Hb.cq=this.zf(this.Hb.cq);return this.Vd.h8c(a)}ewe(a){this.Hb.cr=
this.zf(this.Hb.cr);return this.Vd.ewe(a)}fwe(a){this.Hb.cs=this.zf(this.Hb.cs);return this.Vd.fwe(a)}r8c(a){this.Hb.ct=this.zf(this.Hb.ct);return this.Vd.r8c(a)}s8c(a){this.Hb.cu=this.zf(this.Hb.cu);this.Moa&&this.qva(a);return this.Vd.s8c(a)}t8c(a){this.Hb.cv=this.zf(this.Hb.cv);return this.Vd.t8c(a)}u8c(a){this.Hb.cw=this.zf(this.Hb.cw);return this.Vd.u8c(a)}lwe(a){this.Hb.cx=this.zf(this.Hb.cx);return this.Vd.lwe(a)}v8c(a){this.Hb.cy=this.zf(this.Hb.cy);return this.Vd.v8c(a)}w8c(a){this.Hb.cz=
this.zf(this.Hb.cz);return this.Vd.w8c(a)}A8c(a){this.xn&&(this.xn.K5a=!0);this.Hb.da=this.zf(this.Hb.da);this.Moa&&this.qva(a);return this.Vd.A8c(a)}owe(a){this.xn&&(this.xn.K5a=!0);this.Hb.db=this.zf(this.Hb.db);this.Moa&&this.qva(a);return this.Vd.owe(a)}Hdc(a){this.xn&&(this.xn.K5a=!0);this.Hb.dc=this.zf(this.Hb.dc);this.Moa&&this.qva(a);return this.Vd.Hdc(a)}qwe(a){this.Hb.dd=this.zf(this.Hb.dd);return this.Vd.qwe(a)}rwe(a){this.Hb.de=this.zf(this.Hb.de);return this.Vd.rwe(a)}B8c(a){this.xn&&
(this.xn.K5a=!0);this.Hb.df=this.zf(this.Hb.df);return this.Vd.B8c(a)}swe(a){this.xn&&(this.xn.K5a=!0);this.Hb.dg=this.zf(this.Hb.dg);return this.Vd.swe(a)}uwe(a){this.Hb.dh=this.zf(this.Hb.dh);return this.Vd.uwe(a)}C8c(a){this.xn&&(this.xn.K5a=!0);this.Hb.di=this.zf(this.Hb.di);return this.Vd.C8c(a)}F8c(a){this.Hb.dj=this.zf(this.Hb.dj);return this.Vd.F8c(a)}G8c(a){this.Hb.dk=this.zf(this.Hb.dk);return this.Vd.G8c(a)}H8c(a){this.xn&&(this.xn.HZb=!0);this.Hb.dl=this.zf(this.Hb.dl);return this.Vd.H8c(a)}J8c(a){this.Hb.dm=
this.zf(this.Hb.dm);return this.Vd.J8c(a)}qva(a){if((a=a.Tf)&&a.style&&this.xn){var b=a.style;if(b)for(const c of b)c&&0<c.length&&this.xn.cvj(a.tagName,c)}}}Object(e.a)(SH,"HtmlEventUsageCollector",null,[1206]);class TH{constructor(a,b=null,c=null){this.Vd=a;this.CR=b||Pm.a.$cg("");this.hWh=c||Pm.a.adg("")}get Hb(){return this.CR}get HOe(){return this.hWh}gX(a){this.HOe.b++;this.Vd.gX(a)}dX(){this.Vd.dX()}fX(a){this.HOe.c++;this.Vd.fX(a)}eX(){this.Vd.eX()}cX(a){this.HOe.d++;this.Vd.cX(a)}bX(){this.Vd.bX()}reset(){this.Vd.reset()}get eXb(){return this.Vd.eXb}I_(a,
b){this.Hb.b++;this.Vd.I_(a,b)}zla(a){this.Hb.c++;this.Vd.zla(a)}kWa(a){this.Hb.b++;this.Vd.kWa(a)}yla(a){this.Hb.d++;this.Vd.yla(a)}xla(a){this.Hb.f++;this.Vd.xla(a)}Tua(a,b){this.Hb.g++;this.Vd.Tua(a,b)}Sua(){this.Vd.Sua()}Uz(a){this.Hb.h++;this.Vd.Uz(a)}Tz(){this.Vd.Tz()}fWa(){this.Vd.fWa()}eWa(){this.Vd.eWa()}Yua(a,b){this.Hb.i++;this.Vd.Yua(a,b)}HGa(){this.Vd.HGa()}Cla(a){this.Hb.j++;this.Vd.Cla(a)}Ala(){this.Vd.Ala()}Xua(a){this.Hb.k++;this.Vd.Xua(a)}Bla(){this.Vd.Bla()}gWa(a){this.Hb.l++;this.Vd.gWa(a)}}
Object(e.a)(TH,"SemanticEventUsageCollector",null,[1190,402]);class iC{constructor(a){this.qh=a}reset(){this.qh.reset()}get eXb(){return this.qh.eXb}I_(a,b){this.qh.I_(a,b)}zla(a){this.qh.zla(a)}kWa(a){this.qh.kWa(a)}yla(a){this.qh.yla(a)}xla(a){this.qh.xla(a)}Tua(a,b){this.qh.Tua(a,b)}Sua(){this.qh.Sua()}Uz(a){this.qh.Uz(a)}Tz(){this.qh.Tz()}fWa(){this.qh.fWa()}eWa(){this.qh.eWa()}Cla(a){this.qh.Cla(a)}Ala(){this.qh.Ala()}Xua(a){this.qh.Xua(a)}Bla(){this.qh.Bla()}gWa(a){this.qh.gWa(a)}gX(a){this.qh.gX(a)}dX(){this.qh.dX()}fX(a){this.qh.fX(a)}eX(){this.qh.eX()}cX(a){this.qh.cX(a)}bX(){this.qh.bX()}Yua(a,
b){this.qh.Yua(a,b)}HGa(){this.qh.HGa()}}Object(e.a)(iC,"AHtmlNormalizer",null,[1190,402]);class jC extends iC{constructor(a){super(a);this.mC=!1}I_(a,b){this.mC?this.xF.KE(()=>{this.lAe(a,b)}):this.lAe(a,b)}lAe(a,b){this.qh.I_(a,b)}zla(a){this.mC?this.xF.KE(()=>{this.Mze(a)}):this.Mze(a)}Mze(a){this.qh.zla(a)}yla(a){this.mC?this.xF.KE(()=>{this.Ofc(a)}):this.Ofc(a)}Ofc(a){this.qh.yla(a)}xla(a){this.mC?this.xF.KE(()=>{this.Lze(a)}):this.Lze(a)}Lze(a){this.qh.xla(a)}Tua(a,b){this.mC?this.xF.KE(()=>
{this.Hze(a,b)}):this.Hze(a,b)}Hze(a,b){this.qh.Tua(a,b)}Sua(){this.mC?this.xF.KE(Object(D.a)(this,this.Gze,"processAnchorEnd")):this.Gze()}Gze(){this.qh.Sua()}Uz(a){this.mC?this.xF.KE(()=>{this.Wze(a)}):this.Wze(a)}Wze(a){this.qh.Uz(a)}Tz(){this.mC?this.xF.KE(Object(D.a)(this,this.Vze,"processParagraphEnd")):this.Vze()}Vze(){this.qh.Tz()}fWa(){this.mC?this.xF.KE(Object(D.a)(this,this.Yze,"processPreFormattedTextStart")):this.Yze()}Yze(){this.qh.fWa()}eWa(){this.mC?this.xF.KE(Object(D.a)(this,this.Xze,
"processPreFormattedTextEnd")):this.Xze()}Xze(){this.qh.eWa()}Cla(a){this.mC?this.xF.KE(()=>{this.Qze(a)}):this.Qze(a)}Qze(a){this.qh.Cla(a)}Ala(){this.mC?this.xF.KE(Object(D.a)(this,this.Nze,"processListEnd")):this.Nze()}Nze(){this.qh.Ala()}Xua(a){this.mC?this.xF.KE(()=>{this.Pze(a)}):this.Pze(a)}Pze(a){this.qh.Xua(a)}Bla(){this.mC?this.xF.KE(Object(D.a)(this,this.Oze,"processListItemEnd")):this.Oze()}Oze(){this.qh.Bla()}gX(a){this.mC?this.xF.KE(()=>{this.kAe(a)}):this.kAe(a)}kAe(a){this.qh.gX(a)}dX(){this.mC?
this.xF.KE(Object(D.a)(this,this.hAe,"processTableEnd")):this.hAe()}hAe(){this.qh.dX()}fX(a){this.mC?this.xF.KE(()=>{this.jAe(a)}):this.jAe(a)}jAe(a){this.qh.fX(a)}eX(){this.mC?this.xF.KE(Object(D.a)(this,this.iAe,"processTableRowEnd")):this.iAe()}iAe(){this.qh.eX()}cX(a){this.mC?this.xF.KE(()=>{this.gAe(a)}):this.gAe(a)}gAe(a){this.qh.cX(a)}bX(){this.mC?this.xF.KE(Object(D.a)(this,this.fAe,"processTableCellEnd")):this.fAe()}fAe(){this.qh.bX()}Yua(a,b){this.mC?this.xF.KE(()=>{this.Rze(a,b)}):this.Rze(a,
b)}Rze(a,b){this.qh.Yua(a,b)}HGa(){this.mC?this.xF.KE(Object(D.a)(this,this.i7g,"processMathEnd")):this.i7g()}i7g(){this.qh.HGa()}}Object(e.a)(jC,"AQueuingHtmlNormalizer",iC,[]);class UH{constructor(a){this.next=null;this.data=a}}Object(e.a)(UH,"QueueNode",null,[]);class kC{constructor(){this.R_a=this.ZZa=null;this.Gk=0}get count(){return this.Gk}get isEmpty(){return!this.Gk||!this.ZZa||!this.R_a}enqueue(a){a=new UH(a);this.isEmpty?this.R_a=this.ZZa=a:this.ZZa=this.ZZa.next=a;this.Gk++}back(){return this.isEmpty?
null:this.ZZa.data}dequeue(){if(this.isEmpty)return null;const a=this.R_a;this.R_a=a.next;this.Gk--;this.R_a||(this.ZZa=null);return a.data}clear(){this.R_a=this.ZZa=null;this.Gk=0}toArray(){const a=Array(this.count);let b=this.R_a;for(let c=0;c<this.count&&b;c++)a[c]=b.data,b=b.next;return a}}Object(e.a)(kC,"Queue",null,[]);class mx{constructor(){this.Nzd=new kC}KE(a){this.Nzd.enqueue(a)}flush(a=!1){for(a&&this.ifd();!this.Nzd.isEmpty;)this.Nzd.dequeue()();a&&this.ddd()}ifd(){}ddd(){}}Object(e.a)(mx,
"QueuedEventManager",null,[]);class cz extends mx{constructor(a){super();this.id=void 0;this.UPd=null;this.tSc=!1;this.mec="";this.sSc=this.hTc=!1;this.SPd=this.Gpb=null;this.qcc=0;this.Q3b=this.b5b=this.qae=!1;this.table=null;this.Qse=0;this.PO=a}get bTb(){return!!this.table}ifd(){this.PO.CCb.push(this.PO.currentState);this.PO.currentState=this}ddd(){this.PO.currentState=this.PO.CCb.pop()}}cz.nextId=void 0;Object(e.a)(cz,"ContentState",mx,[]);class VH{constructor(a,b,c){this.colSpan=a.colSpan;this.rowSpan=
a.rowSpan;this.width=a.width;this.height=a.height;this.qDa=a.qDa;this.Rjc=a.Rjc;this.verticalAlignment=a.verticalAlignment;this.Z4=a.Z4;this.Vid=a.Vid;this.tvb=a.tvb;this.qCc=a.qCc;this.contents=c;this.rij=b}}Object(e.a)(VH,"TableCell",null,[]);class WH extends mx{constructor(a,b){super();this.PO=a;this.hwf=new Nt;this.MF=new Nt;this.axd=[];this.owc=[];this.Lna=-1;this.Nxa=0;this.CNh=b.prg;this.BNh=b.JCj;this.$Vh=b.yOe;this.w2a=b.width;this.A$e=b.qDa;this.lMh=new nn(new Ot(b.xT.pkg,b.xT.b2b),b.Nv,
b.o4,b.cultureName,b.zga);this.bNh=b.m5d;this.xxc=b.Ath;this.fWh=b.tableLook}get qh(){return this.PO.qh}Bzk(a){this.Lna++;this.hwf.add(a);this.owc[this.Lna]=a.height;this.Nxa=0}get kCi(){for(;this.Nxa>=this.MF.count;)this.MF.add(Array(this.Lna+1));return this.MF.ga(this.Nxa)}lFd(a,b,c,f,l,x,F){if(0>this.Lna)return!1;for(;this.axd[this.Nxa]>=this.Lna;)this.Nxa++;a=new VH(a,new nn(b,c,f,l,x),F);this.kCi[this.Lna]=a;if(1<a.rowSpan)for(b=this.Lna+a.rowSpan-1,f=this.Nxa,c=this.Nxa+a.colSpan-1;f<=c;f++)this.axd[f]>=
b||(this.axd[f]=b);this.Nxa+=a.colSpan;this.owc[this.Lna]<a.height&&(this.owc[this.Lna]=a.height);return!0}ifd(){this.PO.currentState.table=this}ddd(){this.PO.currentState.table=null}e4f(){this.flush(!0);const a=this.Lna+1;var b=Array(a);for(var c=0;c<a;c++)b[c]=Array(this.MF.count);c=!0;var f=0;for(var l=0;l<this.MF.count;l++){var x=this.MF.ga(l),F=!0;for(var R=0;R<a;R++){var fa=x[R];fa&&(F=!1,b[R][l+f]=new Yy(fa.colSpan,fa.rowSpan,fa.width,fa.height,void 0,void 0,void 0,void 0,fa.qDa,fa.tvb))}F?
(this.MF.removeAt(l),l--,++f):c=!1}if(!c){(b=this.A$e?this.PO.FKf(b,this.w2a/100):this.PO.FKf(b))&&b.length!==this.MF.count&&(b=null);this.PO.aBa(!0);this.PO.jDc();this.qh.gX(new bC(a,this.MF.count,this.w2a,this.A$e,b,this.CNh,this.BNh,this.$Vh,this.bNh,this.xxc,this.fWh,this.lMh));for(b=0;b<a;b++){c=this.hwf.ga(b);this.qh.fX(new aC(this.owc[b],new nn(c.xT,c.Nv,c.o4,c.cultureName,c.zga)));for(c=0;c<this.MF.count;c++){f=this.MF.ga(c)[b];var wa=!!this.xxc&&""!==this.xxc&&"Custom"!==this.xxc;l=f?f.colSpan:
0;x=f?f.rowSpan:0;F=f?f.width:0;R=f?f.height:0;fa=f?f.qCc:0;const Xa=f?f.qDa:!1,lb=f&&(65536&fa||!wa)?f.Rjc:"",Lb=f?f.verticalAlignment:0,kc=f?f.tvb:!1;wa=f?this.PO.k8i(f.Z4,c,b,this.MF,wa,f.qCc):new XB;const lc=f?f.Vid:new YB,Ec=f?f.rij:null;this.qh.cX(new Yy(l,x,F,R,lb,Lb,wa,lc,Xa,kc,fa,new nn(Ec?Ec.xT:null,Ec?Ec.Nv:null,Ec?Ec.o4:null,Ec?Ec.cultureName:null,Ec?Ec.zga:null)));f&&!f.tvb&&(f.contents.ifd(),f.contents.flush(),this.PO.aBa(!1),this.PO.jDc(),f.contents.ddd());this.qh.bX()}this.qh.eX()}this.qh.dX();
this.PO.currentState.Q3b=!1;this.PO.s_f(!1)}}}Object(e.a)(WH,"NormalizedTable",mx,[]);class lC{constructor(a=!1,b=!1){this.ZNh=a;this.EH=b}get xHj(){return this.ZNh}get YT(){return this.EH}}Object(e.a)(lC,"HtmlNormalizerSettings",null,[261]);class Mr extends jC{constructor(a,b=null){super(a);this.currentState=null;this.CCb=new ix;this.Xjb=b||new lC}reset(){super.reset();this.currentState=new cz(this);this.CCb.clear();this.mC=!1}get xF(){return this.currentState&&this.currentState.bTb?this.currentState.table:
this.currentState}UHc(a=!1){this.currentState.tSc||(this.jDc(),this.qh.Uz(this.currentState.UPd),this.currentState.tSc=!0,this.currentState.Q3b=!1);a||!this.currentState.Gpb||this.currentState.sSc||(this.qh.Tua(this.currentState.Gpb,this.currentState.SPd),this.currentState.sSc=!0)}yYb(){this.currentState.sSc&&(this.qh.Sua(),this.currentState.sSc=!1)}SLi(){this.currentState.tSc&&(this.qh.Tz(),this.currentState.tSc=!1,this.currentState.mec="")}s_f(a){this.currentState.b5b&&(this.currentState.Q3b?a||
(this.qh.Uz(null),this.qh.Tz(),this.qh.Bla(),this.currentState.b5b=!1):(this.qh.Bla(),this.currentState.b5b=!1,this.currentState.Q3b=!0))}aBa(a){this.yYb();this.SLi();this.s_f(a)}xqk(a){this.qh.Cla(new jx(2,1,a));this.currentState.qcc++;this.currentState.qae=!0}jDc(){!this.currentState.b5b&&this.currentState.qae&&(this.qh.Ala(),this.currentState.qcc--,this.currentState.qae=!1)}lAe(a,b){a=this.jfk(a);if(""!==a)if(this.UHc(),this.currentState.hTc)this.mAe(a,b);else{a=a.split(Mr.Rgi);for(let c=0;c<a.length-
1;c++)this.mAe(a[c],b),this.qh.kWa(b);this.mAe(a[a.length-1],b)}}Rze(a,b){""!==a&&(this.UHc(),this.qh.Yua(a,b))}Mze(a){this.Xjb.YT||this.yYb();this.UHc(!0);this.qh.zla(a)}Lze(a){this.currentState.bTb||this.qh.xla(a)}Ofc(a){this.currentState.Gpb&&(a.href=this.currentState.Gpb);super.Ofc(a)}Hze(a,b){this.yYb();this.currentState.Gpb=a;this.currentState.SPd=b}Gze(){this.yYb();this.currentState.Gpb=null;this.currentState.SPd=null}Wze(a){this.currentState.UPd=a;this.aBa(!0)}Vze(){this.currentState.UPd=
null;this.aBa(!0)}Yze(){this.currentState.hTc=!0}Xze(){this.currentState.hTc=!1}Qze(a){this.aBa(!1);this.jDc();this.qh.Cla(a);this.currentState.qcc++}Nze(){this.aBa(!1);this.qh.Ala();this.currentState.qcc--}Pze(a){this.aBa(!1);this.currentState.qcc||this.xqk(a);this.qh.Xua(a);this.currentState.b5b=!0;this.currentState.Q3b=!0}Oze(){this.aBa(!1)}gX(a){this.currentState.bTb||(this.mC=!0,this.currentState.table=new WH(this,a))}kAe(){}dX(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=
null;this.CCb.isEmpty?(this.mC=!1,a.e4f()):this.xF.KE(Object(D.a)(a,a.e4f,"flushTable"))}}hAe(){}fX(a){this.currentState.bTb&&this.currentState.table.Bzk(a)}jAe(){}eX(){}iAe(){}cX(a){let b=!1;if(this.currentState.bTb){const c=new cz(this);this.currentState.table.lFd(a,new Ot(a.xT.pkg,a.xT.b2b),a.Nv,a.o4,a.cultureName,a.zga,c)?(this.CCb.push(this.currentState),this.currentState=c):b=!0}else b=!0;b&&this.currentState.Qse++}gAe(){}bX(){0<this.currentState.Qse?this.currentState.Qse--:this.currentState=
this.CCb.pop()}fAe(){}FKf(a,b=1){if(!a)return null;const c=a.length;if(!c)return null;const f=a[0].length;for(var l=1;l<c;l++)if(a[l].length!==f)return null;l=Array(f+1);l[0]=0;const x=Array(f+1);for(var F=0;F<x.length;F++)x[F]=!1;F=new Ha.a;for(let fa=0;fa<f;fa++){for(var R=0;R<c;R++)if(a[R][fa]&&0<a[R][fa].width){const wa=Math.min(fa+a[R][fa].colSpan,f);l[wa]=l[fa]+a[R][fa].width*(a[R][fa].qDa?b:1);x[wa]=!0}if(x[fa+1]){R=l[fa+1]-l[fa];if(0>=R)return null;F.add(R)}else l[fa+1]=l[fa]}return F.toArray()}$ak(a,
b){1&b||(a.borderTopStyle=12);16&b||(a.borderRightStyle=12);256&b||(a.borderBottomStyle=12);4096&b||(a.borderLeftStyle=12);return a}k8i(a,b,c,f,l,x){if(!a)return null;l&&(a=this.$ak(a,x));if(0>c||0>b||b>f.count-1)return a;0<=b-1&&c<=f.ga(b-1).length-1&&1===a.borderLeftStyle&&(l=f.ga(b-1)[c])&&1!==l.Z4.borderRightStyle&&(a.borderLeftStyle=l.Z4.borderRightStyle,a.borderLeftColor=l.Z4.borderRightColor,a.borderLeftWidth=l.Z4.borderRightWidth);0<=c-1&&c<=f.ga(b).length-1&&1===a.borderTopStyle&&(b=f.ga(b)[c-
1])&&1!==b.Z4.borderBottomStyle&&(a.borderTopStyle=b.Z4.borderBottomStyle,a.borderTopColor=b.Z4.borderBottomColor,a.borderTopWidth=b.Z4.borderBottomWidth);return a}jfk(a){this.currentState.hTc||(a=this.Xjb.xHj?a.replace(Mr.Xsj," "):a.replace(Mr.Wsj," "));a.startsWith(" ")&&(this.currentState.mec.endsWith(" ")||""===this.currentState.mec)&&(a=Ma.a.substring(a,1,a.length));return a}mAe(a,b){""!==a&&(this.qh.I_(a,b),this.currentState.mec+=a)}}Mr.Wsj=RegExp("[ \t\f\u200b\r\n]+","g");Mr.Xsj=RegExp("[ \f\u200b\r\n]+",
"g");Mr.Rgi="\t";Object(e.a)(Mr,"DefaultHtmlNormalizer",jC,[]);class XH extends Mr{constructor(a,b,c){super(a,c);this.e4e=!1;this.f0a=b}Ofc(a){this.f0a.L9c&&(u.AFrameworkApplication.ZP?this.e4e||(a=new rj.StandardDialog,a.vd=0,a.Re(1,CommonUIStrings.l_DialogClose),a.Yw(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.e4e=!0):this.f0a.Jbk?this.f0a.lSg=!0:a.src&&""!==a.src?cg.a.lS(a.src)===cg.a.lS(window.location.href)?u.AFrameworkApplication.Ta.processAction(C.a.M3g,
2):a.src.startsWith("data:")&&19922944<a.src.length?u.AFrameworkApplication.Ta.processAction(C.a.K3g,2):a.src.startsWith("webkit-fake-url")?u.AFrameworkApplication.Ta.processAction(C.a.J3g,2):(H.a.instance.ga(1)?this.aBa(!1):H.a.instance.ga(11)&&(this.yYb(),this.UHc(!0)),this.qh.yla(a)):u.AFrameworkApplication.Ta.processAction(C.a.L3g,2))}}Object(e.a)(XH,"Box4HtmlNormalizer",Mr,[]);class YH{constructor(a,b,c,f,l,x,F,R,fa,wa){this.htmlProcessor=a;this.P4d=b;this.gEh=c;this.sUi=f;this.vZk=l;this.wZk=
x;this.xPc=F;this.Qsj=R;this.Ssj=fa;this.fTj=wa}}Object(e.a)(YH,"ExecutePasteArguments",null,[]);class ZH extends zj{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){super(b,c,f,Xa);this.N5=null;this.iga=a;this.Ood=l;this.Ctd=x;this.SCd=F;this.CEd=R;this.gNb=fa;this.Xjb=Lb;this.jb=wa;this.F4e=Object.assign(new ZB,{tRc:2===this.ih.TNa||3===this.ih.TNa});this.Ord=lb;this.RQb=wa.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.wUh=wa.ka("ParseStyleFromRawHtmlHeadIsEnabled")}get $5c(){return!1}get Qrg(){return!Ma.a.Ukl(Ma.a.Dtc,
this.iga.innerText)}get ZPf(){return this.iga.innerText}s0f(a){this.N5=new mb.GraphIterator;this.xdb.restore(this.N5);Z.ULS.shipAssertTag(6305550,307,Rd.OutlineElementReader.Tg(this.N5));this.ih.J_&&this.ih.J_.yAc("external");var b=this.ih.yw&8192?1:0,c=this.Ctd.value.create(b,this.N5);const f=this.SCd.value.create(b,this.N5),l=Pm.a.Y1d(u.AFrameworkApplication.userSessionId),x=Pm.a.UYd(n.a.l3a,this.ih.tMd),F=Pm.a.$cg(u.AFrameworkApplication.userSessionId),R=Pm.a.adg(u.AFrameworkApplication.userSessionId),
fa=this.RQb?this.wxj():null,wa=Pm.a.i$f(n.a.l3a,this.ih.tMd),Xa=Pm.a.j$f(u.AFrameworkApplication.userSessionId),lb=this.gNb.ooh?Pm.a.o6i(u.AFrameworkApplication.userSessionId):null;b=this.Ood.value.create(b,this.N5,c,f,null,x);b=new TH(b,F,R);b=new XH(b,c,this.Xjb);b=new Jk(b,this.gNb,this.F4e,lb);b=new SH(b,wa,fa,this.jb);b=new Zq(b,Xa);c=new YH(b,c,l,x,F,R,fa,wa,Xa,lb);c=new wc.a(a,Object(D.a)(this,this.Dzk,"preprocessStyle"),c);c.xl("paste and request pictures");c.Vi=!a||a.Vi;c.run()}Dzk(a){if(this.wUh){const b=
this.iga.getElementsByTagName("style");if(b&&0<b.length){Z.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let c=0;c<b.length;c++)this.Ord.bui(this.iga,b[c]),b[c]&&(b[c].parentNode.removeChild(b[c]),c--)}}a.Wg(Object(D.a)(this,this.uui,"convertWordListHtml"));return!0}uui(a,b){this.CEd.value.create(b.gEh).process(this.iga,a);a.Wg(Object(D.a)(this,this.PAk,"processHtml"));return!0}PAk(a,b){b.htmlProcessor.process(this.iga,a);b=b.P4d&&
b.P4d.L9c?Object(D.a)(this,this.bdd,"requestImages"):Object(D.a)(this,this.HZf,"endPasteOperation");a.Wg(b);return!0}bdd(a,b){if(b=b.P4d){let c=!1,f=!1,l=!1,x=!1,F=-1;const R=new E.DictionaryPropertySet,fa=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Fa.a)(10,this.ih.ld)){c=this.ih.ld.sa(Bb.a.X8d,!1);const wa=this.ih.ld.sa(be.a.zT,"");l=this.ih.ld.sa(be.a.nSc,!1);x=this.ih.ld.sa(bb.a.gN,!1);fa.test(wa)&&(f=!0);this.qoh&&(F=this.ih.ld.sa(Cs.a.YXb,-1))}else this.ih.yw&256&&this.iga&&
(c=!0,fa.test(this.iga.innerHTML)&&(f=!0));R.setValue(Bb.a.X8d,c);R.setValue(be.a.oPj,f);R.setValue(be.a.nSc,l);R.setValue(Cs.a.YXb,F);R.setValue(bb.a.gN,x);b.vVg&&(this.ih.N3b=!0,this.ih.e5d=b.lGc,this.ih.Bte=b.vVg,u.AFrameworkApplication.Ta.processAction(C.a.bdd,2))}a.Wg(Object(D.a)(this,this.HZf,"endPasteOperation"));return!0}HZf(a,b){Pm.a.kYj(b.gEh);Pm.a.nWj(b.Ssj);Pm.a.yXj(b.vZk);Pm.a.zXj(b.wZk);Pm.a.GWj(b.fTj);a="Others";b.xPc&&(b.xPc.kWj(),b.xPc.lWj(),a=b.xPc.LMe);Pm.a.mWj(b.Qsj,a);Pm.a.bWj(b.sUi,
a);return!1}wxj(){const a=new RH;a.XCb=n.a.l3a;this.ih&&(a.yw=this.ih.yw,a.Nwe=this.ih.tMd,this.ih.ld&&(a.pAe=this.ih.ld.sa(be.a.I3g,"")));this.iga&&this.iga.innerHTML&&(a.H3g=this.iga.innerHTML.length);u.AFrameworkApplication.Yc&&(a.platform=u.AFrameworkApplication.Yc.Platform);return a}get Doh(){return!0}get Coh(){Z.ULS.shipAssertTag(6305551,307,!!this.N5);if(this.gNb.poh(this.F4e)){let a=!1;Rd.OutlineElementReader.Tg(this.N5)&&(this.N5.Z0b(),a=!0);const b=Ya.ParagraphReader.Lk(this.N5)&&!this.N5.currentNode.sa(be.a.Gsg,
!1);a&&this.N5.uc();return b}return Ya.ParagraphReader.Lk(this.N5)}}Object(e.a)(ZH,"ExternalPasteExecutionManager",zj,[]);class $H{constructor(a,b,c,f,l,x,F,R){this.Ood=a;this.Ctd=b;this.SCd=c;this.CEd=f;this.gNb=l;this.jb=x;this.Ord=F;this.Xjb=R}create(a,b,c,f){return new ZH(a,b,c,f,this.Ood,this.Ctd,this.SCd,this.CEd,this.gNb,this.jb,Gb.App.Fb.Ed,this.Ord,this.Xjb)}}Object(e.a)($H,"Factory",null,[1155]);class dz{constructor(a){this.Gia=a.a5i();this.Y6a=a.JLc("intCopy");this.c9c=a.A_d("intCopy");
this.F3a=a.KKc("intCopy");this.mNa=a.xKc("intCopy")}static qV(){return dz.dr()}static dr(){return new dz(eg.a.instance)}}Object(e.a)(dz,"InternalCopyUsageHelper",null,[]);class nx{constructor(a,b,c){this.rM=dz.qV();this.KCc=null;this.Fgd=this.Zld=!1;this.I1e=null;this.source=a;this.target=b;this.nxe=c}get r5(){return this.rM}get kK(){return this.I1e}set kK(a){this.I1e=a}}Object(e.a)(nx,"InternalCopyArguments",null,[]);class aI extends nx{constructor(a,b,c,f){super(a,b,{});this.xFb=[];for(a=0;a<c.length;a++)Array.addRange(this.xFb,
c.ga(a).toArray());this.Ypa=0;this.Rij=f}}Object(e.a)(aI,"BasicInternalCopyArguments",nx,[]);class bI extends Sys.EventArgs{constructor(a){super();this.kK=a}}Object(e.a)(bI,"BeforePasteArguments",Sys.EventArgs,[]);class ez extends nx{constructor(a,b){super(a.source,a.target,a.nxe);this.ih=a;this.insertAfter=b}get r5(){return this.ih.r5}get kK(){return this.ih.kK}set kK(a){this.ih.kK=a}}Object(e.a)(ez,"CoreInternalCopyArguments",nx,[]);class fz{constructor(a,b,c,f,l=null){this.source=a;this.target=
b;this.insertAfter=c;this.R8c=f;this.kK=l||{}}}Object(e.a)(fz,"CoreInternalPasteArguments",null,[]);class cI{constructor(a,b,c,f,l,x,F,R,fa){this.ZHb=a;this.source=b;this.target=c;this.R8c=f;this.rowIndex=l;this.hha=x;this.w3g=R;this.Df=fa}}Object(e.a)(cI,"CoreInternalTablePasteArguments",null,[]);class gz extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.operation=a;this.clone=f;this.kK=l}}Object(e.a)(gz,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var $q=d(200);class li{static Xq(){li.eFb=
new Xb.a;li.eFb.$(88,!0);li.eFb.$(4,!0)}static Xqa(a,b,c){const f=[];if(H.a.instance.ga(104)&&a.nl&&nd.SelectionFactory.mOj(a))a=mb.GraphIterator.mb(a.kb.gg.Ua.node),a.mc(14),c=Pc.a.create(a.origin),c=li.OAc(c,!0,!0,null),a.set(c),fb.SelectionEditor.Vs(a),li.BPa(a,f);else for(let wa=0;wa<a.length&&!(c&&0<f.length);++wa){var l=a.ga(wa),x=li.DLc(l,!0),F=li.DLc(l,!1);if(!x||!F)continue;if(x===F&&x.contextId===Fb.a.Lf){l=mb.GraphIterator.mb(x.node);l.mc(11)&&li.BPa(l,f);continue}var R=void 0;R=l=null;
var fa=-1;let Xa;if(x.node===F.node)Xa=x.node,F=F.node;else{R=li.e6f(x.node);l=li.e6f(F.node);for(fa=0;fa<R.length&&fa<l.length&&R[fa]===l[fa];++fa);R=R[fa-1];--fa;Xa=li.OAc(x,!0,!1,R);F=li.OAc(F,!1,!0,R)}if(Xa===F)l=Xa===x.node?x:Pc.a.create(Xa),l=li.OAc(l,!0,!0,null),x=new En.a,x.set(l),fb.SelectionEditor.Vs(x),li.BPa(x,f);else{x=new En.a;x.set(Xa);fb.SelectionEditor.Vs(x);Xa===R&&x.Ji();for(li.BPa(x,f);x.parentNode!==R;){for(;x.jp();)li.BPa(x,f);x.uc()}if(F===R)for(;x.jp();)li.BPa(x,f);else{x.jp();
for(R=fa+1;R<l.length;++R){for(;x.currentNode!==l[R];)li.BPa(x,f),x.jp();if(F===l[R])break;x.Ji()}li.BPa(x,f)}}}if(0>=f.length)return null;if(b)for(b=new mb.GraphIterator,a=0;a<f.length;++a)b.set(f[a].node),Yb.OutlineElementNavigator.oi(b),f[a]=Pc.a.create(b.currentNode);return Ea.a.cOa(f)}static DLc(a,b){if(b)for(b=0;b<a.length;++b){if(a.ga(b).Kk)return a.ga(b);if(a.ga(b).Hw){var c=a.ga(b);for(var f=0;f<c.length;++f)if(c.getContext(f).Kk)return c.getContext(f)}}else for(b=a.length-1;0<=b;--b){if(a.ga(b).Kk)return a.ga(b);
if(a.ga(b).Hw)for(c=a.ga(b),f=c.length-1;0<=f;--f)if(c.getContext(f).Kk)return c.getContext(f)}return null}static BPa(a,b){li.rvg(a)?li.PQi(a,b):li.eFb.Jb(a.role)||(a=a.rw(11),!a||b.length&&b[b.length-1].node===a||Array.add(b,Pc.a.create(a)))}static e6f(a){const b=[],c=new mb.GraphIterator;c.set(a);fb.SelectionEditor.Vs(c);for(Array.add(b,a);c.uc();)Array.add(b,c.currentNode);b.reverse();return b}static OAc(a,b,c,f){let l=a.node;if(fb.SelectionEditor.Pj(a)&&(b&&0<a.Qa||c&&a.Kb<Ya.ParagraphReader.textLength(l))||
fb.SelectionEditor.Cl(a)&&b&&0<Ya.ParagraphReader.textLength(l))return l;a=new En.a;a.set(l);for(fb.SelectionEditor.Vs(a);!a.Oq;){l=a.currentNode;if(f===l||b&&!li.UFj(a)||c&&!li.aIj(a))return l;a.uc()}return a.currentNode}static aIj(a){let b=!0;if(a.jp())for(b=!1;li.eFb.Jb(a.role)||H.a.instance.ga(77)&&16===a.mi&&De.isGhostCell(a);)if(!a.jp()){b=!0;break}return b}static UFj(a){const b=a.currentNode;let c=!0;if(a.mCa())for(c=!1;li.eFb.Jb(a.role);)if(!a.mCa()){c=!0;break}a.uc();a.Ak(b);return c}static PQi(a,
b){a=wi.a.Ju(a);for(a.Jl(li.FQi,null);a.moveNext();)Rd.OutlineElementReader.O7(a.currentNode)&&Array.add(b,Pc.a.create(a.currentNode))}static FQi(a){return li.rvg(a)}static rvg(a){return a.Oq||1===a.role||27===a.role}}li.eFb=null;Object(e.a)(li,"OutlineElementGeneralizer",null,[]);li.Xq();class dI{constructor(){this.controlCell=this.No=null;this.colSpan=this.rowSpan=0;this.response=2}}Object(e.a)(dI,"ComplexCellData",null,[]);var ox=d(172);class mC{constructor(a){this.Gm=a;a.IUj()}dispose(){this.Gm.Trl()}static mb(a){return new mC(a.yk)}}
Object(e.a)(mC,"TempGraphAlgorithmLock",null,[106]);class Gh{constructor(a,b,c){this.Y_e=this.AH=null;this.$uc=[];this.uqc=[];this.rxc=[];this.dLb={};this.hyd={};this.jod={};this.PC=null;this.a2a=Gh.Rfj(a);this.a2a.ebk();this.zWh=mC.mb(this.a2a);Gh.gjb=this;this.e6=1;this.Aqd=b;this.x_a=c}get Aq(){return this.PC||(this.PC=hb.a.instance.resolve("Box4.ITableEditor"))}get SI(){return this.AH||(this.AH=hb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}normalize(){if(!(0<--this.e6)){var a=new We.GraphTransaction(7);
a.fd(this.a2a);this.dCk();this.cck();this.tSi();H.a.instance.ga(63)&&this.hmi();this.vSi();a.dispose();this.E1()}}I5k(a){this.Y_e=a}vSi(){var a=mb.GraphIterator.mb(this.a2a);if(!a.oCa()){const b=this.SI.tWb(a);Gh.WA.IY(a,!0);a=Gb.App.Fb.Ed.en;a.So&&Gh.WA.Dfd(b,a.T0b())}}cancel(){if(!(0<--this.e6)){var a=ox.a.qz(this.a2a);for(a.Jl(Gh.gXe,null);a.moveNext();)a.iterator.Oq||a.iterator.ZX(16,!1);this.E1()}}E1(){this.a2a.Vrl();this.zWh.dispose();Gh.gjb=null}ana(a){a.Kk?(Gh.iPj(a)&&Array.add(this.$uc,a.node),
this.Wwh(a.node)):a.Hw&&this.rnl(a)}rnl(a){for(let b=0;b<a.length;++b)this.ana(a.getContext(b))}Wwh(a){a.anchor.uS(16)}cck(){for(let b=0;b<this.$uc.length;++b){var a=this.$uc[b];if(!a.anchor||a.anchor.jI)continue;const c=new mb.GraphIterator;c.set(a);if(!fb.SelectionEditor.Vs(c))continue;Yb.OutlineElementNavigator.Je(c);if(this.x_a.wii(c)){Gh.Jh.LAa(c);continue}a=new En.a;a.Nc(c);if(!Yb.OutlineElementNavigator.OI(a,!1,!1))continue;if(36===a.role)continue;Yb.OutlineElementNavigator.oi(a);if(a.currentNode.IV)continue;
if(xd.TableReader.Np(a))continue;Yb.OutlineElementNavigator.Je(a);const f=new mb.GraphIterator;f.Nc(a);f.uc();Gh.Jh.merge(c,a,!1,!1);Rd.OutlineElementReader.iI(f)&&!f.oCa()&&a.Ii()}Array.clear(this.$uc)}hmi(){for(let a=0;a<this.rxc.length;++a){const b=this.rxc[a];if(!b.anchor||b.anchor.jI)continue;if(De.isGhostCellNode(b))continue;const c=new mb.GraphIterator;c.set(b);c.uA(1);c.zb(2);xd.TableReader.Np(c)&&(c.uc(),Gh.Jh.Tba(c,!1,!0,null))}Array.clear(this.rxc)}YZi(a){const b=a.id.toString();if(this.dLb[b])return this.dLb[b];
const c=Array(xd.TableReader.ui(a));for(let f=0;f<xd.TableReader.ui(a);++f)c[f]=0;this.dLb[b]=c;this.hyd[b]=xd.TableReader.$j(a);return c}dCk(){const a=ox.a.qz(this.a2a);a.Jl(Gh.gXe,null);var b=a.moveNext();const c=new mb.GraphIterator;let f=0;for(;b;)if(a.iterator.Oq)this.Vli(a.iterator),b=a.moveNext();else if(this.x_a.jKj(a.iterator)&&Array.add(this.uqc,a.iterator.currentNode),H.a.instance.ga(63)&&De.isTableCell(a.iterator)&&Array.add(this.rxc,a.iterator.currentNode),Gh.Dii(a.iterator))switch(a.iterator.mi){case 16:b=
Dd.getContainingTable(a.iterator);if(this.Aqd&&!xd.TableReader.ju(b)&&!De.isGhostCell(a.iterator)){b=this.YZi(b);var l=Nn.a(a.iterator);++b[l]}b=a.moveNext();break;case 15:b=Dd.getContainingTable(a.iterator);this.Aqd&&!xd.TableReader.ju(b)?(this.jod[b.id.toString()]=!0,c.Nc(a.iterator),b=a.moveNext(),this.Aq.YFc(c)):b=a.moveNext();break;case 14:a.iterator.currentNode!==this.Y_e?(a.moveNext(),c.Nc(a.iterator),b=a.moveNext(),Gh.Jh.LAa(c)):(a.iterator.ZX(16,!1),b=a.moveNext());break;case 23:c.Nc(a.iterator);
b=a.moveNext();c.Ii();break;case 11:f++;ph.b(a.iterator)?(a.iterator.ZX(16,!1),b=a.moveNext()):(c.Nc(a.iterator),Ib.ListReader.ak(c)&&!this.x_a.AKe(c,f)&&Gh.ao.ema(c),c.bI(2)?this.x_a.v9k(c,f)?b=a.moveNext():(c.Nc(a.iterator),b=a.moveNext(),Gh.Jh.LAa(c)):(b=a.moveNext(),Gh.Jh.LAa(c)));break;case 12:b=a.moveNext();break;default:b=a.moveNext()}else{l=!0;if(xd.TableReader.Np(a.iterator)&&this.Aqd){var x=a.currentNode;let F=x.id.toString();const R=this.dLb[F];let fa=!1;if(R){const wa=this.hyd[F];for(x=
xd.TableReader.ui(x)-1;0<=x;--x)R[x]===wa&&(this.Aq.WFc(a.iterator,x),fa=!0)}xd.TableReader.ui(a.iterator.currentNode)?H.a.instance.ga(30)&&(fa||this.jod[F])&&xd.TableReader.M$d(a.iterator.currentNode)&&(c.Nc(a.iterator),Dd.moveToFirstRow(c),Dd.moveToFirstColumn(c),b=a.moveNext(),Gh.Jh.keh(a.iterator,c)):(a.moveNext(),c.Nc(a.iterator),b=a.moveNext(),c.Ii(),l=!1)}l&&(a.iterator.ZX(16,!1),b=a.moveNext())}this.dLb={};this.hyd={};this.jod={}}Vli(a){if(a.Ji()){do a.ZX(16,!1);while(a.lCa())}}tSi(){for(let b=
0;b<this.uqc.length;++b){var a=this.uqc[b];if(a.anchor&&!a.anchor.jI){const c=new mb.GraphIterator;c.set(a);yh.OutlineNavigator.v9(c)||(c.currentNode.setValue(bb.a.PD,kn.a.first),H.a.instance.ga(41)&&10===c.mi&&(a=Gh.Jh.m6d(c,null,1),c.Ak(a)),Gh.WA.IY(c,!0))}}Array.clear(this.uqc)}static get ao(){return Gh.Jo||(Gh.Jo=hb.a.instance.resolve("Box4.List.IListEditor"))}static get WA(){return Gh.ox||(Gh.ox=hb.a.instance.resolve("Box4.IOutlineEditor"))}static get Jh(){return Gh.xi||(Gh.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get iH(){return kk.a.instance}static get Wi(){return Qg.a.instance}static tMc(a,
b){Gh.gjb?Gh.gjb.e6++:Gh.gjb=new Gh(a,b,hb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"));return Gh.gjb}static Rfj(a){a=mb.GraphIterator.mb(a);fb.SelectionEditor.Vs(a);a.cFb(b=>b.Z4b);return a.currentNode}static iPj(a){let b=!1;fb.SelectionEditor.Cl(a)&&(b=!H.a.instance.ga(14)||!Gh.Wi.QRc(a));!b&&Ya.ParagraphReader.Xl(a)&&(b=!H.a.instance.ga(14)||!Gh.Wi.SSc(a)&&!a.node.sa(Bb.a.F8a,!1));return b}static Dii(a){switch(a.mi){case 12:return a.currentNode.cCc}if(!a.Ji())return Gh.iH.Vxg(a)?
Gh.iH.QKd(a.currentNode):!0;let b=!0;do{switch(a.role){case 2:case 1:case 3:case 86:case 87:a.FV&16||16===a.mi&&De.isGhostCell(a)||(b=!1)}a.ZX(16,!0)}while(a.lCa());b&&Gh.iH.Vxg(a)&&(b=Gh.iH.QKd(a.currentNode));return b}static vii(a){return a.Oq||!!(a.FV&16)}}Gh.gXe=Gh.vii;Gh.gjb=null;Gh.Pa=new qd.a;Gh.ox=null;Gh.Jo=null;Gh.xi=null;Object(e.a)(Gh,"GraphStructureNormalizer",null,[]);class Pt{constructor(){this.jHb=this.No=this.lC=null;this.Acb=0;this.response=2}}Object(e.a)(Pt,"TableGeneralizeData",
null,[]);class bi{static get Pl(){return Rg.ContextSetEditor.instance}static r4(a,b,c,f,l,x,F){let R=!1;x&&x[bi.MJb]&&x[bi.MJb]&&(R=!0);if(!b.view.Hh)return 2;const fa=b.view;var wa=fa.Eb;if(1===c){if(!wa||!wa.Oa.kb)return 8;b=0===F?b.MD:bi.Pl.MZb(b.MD,F,!0);return u.AFrameworkApplication.Ta.ii(b,a,c,!0,f,l)}x&&x[bi.nna]&&N.a.mark(x[bi.nna]);const Xa=um.SelectionReferenceFactory.instance.dqa(),lb=wa.Oa.kb.Ua;wa=new We.GraphTransaction(15);wa.fd(lb.node);wa.dwa();b=0===F?b.MD:bi.Pl.MZb(b.MD,F);a=u.AFrameworkApplication.Ta.ii(b,
a,c,!0,f,l);32===a&&Xa.IT(R);v.FocusManager.instance().Bf(fa.RH);wa.dispose();Gb.App.Fb.updateCommandUI();x&&x[bi.mna]&&N.a.mark(x[bi.mna]);return a}static odb(a,b,c,f,l,x){var F=ld.a.instance;let R,fa=!1;x&&x[bi.MJb]&&x[bi.MJb]&&(fa=!0);if(1===c)return F&&F.Oa.kb?(R=li.Xqa(F.Oa,!1,!0))?u.AFrameworkApplication.Ta.ii(R,a,c,!0,f,l):8:8;x&&x[bi.nna]&&N.a.mark(x[bi.nna]);const wa=um.SelectionReferenceFactory.instance.dqa(),Xa=F.Oa.kb.Ua;R=li.Xqa(F.Oa,!1);if(!R)return 8;F=new We.GraphTransaction(15);F.fd(Xa.node);
F.dwa();a=u.AFrameworkApplication.Ta.ii(R,a,c,!0,f,l);32===a&&wa.IT(fa);(b=b.view)&&v.FocusManager.instance().Bf(b.RH);F.dispose();Gb.App.Fb.updateCommandUI();x&&x[bi.mna]&&N.a.mark(x[bi.mna]);return a}}bi.nna="PerfMarkStart";bi.mna="PerfMarkEnd";bi.MJb="CollapseIp";Object(e.a)(bi,"ViewActionHandler",null,[]);var eI=d(549);class fI{constructor(){this.controlCell=null;this.tOf=this.Ggh=0;this.y3f=this.z3f=null}}Object(e.a)(fI,"MergedCellInfo",null,[]);var px=d(308),gI=d(659),EP=d(705),On=d(357);class iv extends lf.a{constructor(a){super(0,
0,0);this.F6=a;this.hKa=Array(a)}a_i(a){return this.hKa[a]}kkh(a,b){this.hKa[a]=b}copy(){const a=new iv(this.F6);for(let b=0;b<this.F6;++b)a.hKa[b]=this.hKa[b];return a}kck(){let a=On.a.Qgb;for(let b=0;b<this.F6;++b)a+=this.hKa[b]+1;return a}static Poi(a,b){const c=new iv(a.F6);for(let f=0;f<c.F6;f++)c.hKa[f]=Math.max(a.hKa[f],b.hKa[f]);return c}}Object(e.a)(iv,"TableRowViewSizeConstraints",lf.a,[]);class Qt extends Cl.a{constructor(a,b,c,f,l,x=null){super(a,b,c);this.YZa=null;this.$pd=0;this.rpc=
-1;this.Xc=f;this.Wc=l;this.jc(this.Fd.Oo(ka.a.tr));this.htmlElement.className="TableRow";Ca.d(this.htmlElement,za.a.role,"row");this.Ydh();this.l0e=x}cA(){this.$a.O2g=[];this.htmlElement.style.height=this.Egh;this.Ydh()}Ydh(){this.Xc&&this.Xc.UCa(65)&&(this.$a.RVb?Sys.UI.DomElement.addCssClass(this.htmlElement,Pb.F2):Sys.UI.DomElement.removeCssClass(this.htmlElement,Pb.F2))}S0k(a){const b=this.rpc!==a;this.rpc=a;return b}Yvl(){this.htmlElement.style.height=this.Fgh+"px"}get Fgh(){let a=0>=this.rpc?
Qt.cTg:this.rpc;this.$a.Sa(Bb.a.Rt)&&(a=Math.max(a,this.Fd.Cd.Ge(this.$a.getValue(Bb.a.Rt),1)));return a}get Egh(){return this.$a.Sa(Bb.a.Rt)?this.Fd.Cd.Ge(this.$a.getValue(Bb.a.Rt),1)+"px":"auto"}DT(a){super.DT(a);var b=xd.TableReader.ui(Dd.getContainingTable(a));let c=0;b=new iv(b);if(a.zb(1)){do b.kkh(c,a.Gq.wIa.total),c++;while(a.wj(1))}return b}VL(a){super.VL(a);this.JQ.uT(this.htmlElement)}get author(){return this.YZa}nSe(a){let b=!0;if(this.Oc.So&&this.Oc.nCj){a=wi.a.Ju(a);for(var c={};a.moveNext();){if(!Rd.OutlineElementReader.Tg(a.iterator)||
Rd.OutlineElementReader.K3d(a.iterator))continue;const f=Rd.OutlineElementReader.vKc(a.currentNode,bb.a.HTb);f&&(c[f]="")}a=xa.a.join(c,Box4Intl.Box4Strings.l_UserInitialsDelimeter,"");c=Sys.UI.DomElement.getBounds(this.htmlElement);0<c.height&&(this.YZa=a,this.$pd=c.height,b=!1)}b&&(this.YZa="",this.$pd=-1)}get HNd(){return this.$pd}fRk(){this.l0e&&this.l0e.iEl(this)}}Qt.cTg=20;Object(e.a)(Qt,"TableRowViewElement",Cl.a,[692]);class Hh{constructor(a,b){Hh.ox=a;Hh.xi=b}ITk(a){const b=a.bjd.currentNode;
this.qul(b);let c=this.avi(b);var f=this.Oej(b,c);let l=f.length;a.cGc=this.BRi(f);a.aGc=this.TQi(f);f=a.cGc.toArray().length;const x=a.aGc.toArray().length;if(0<f||0<x)l-=f,c-=x,this.Fwl(a);this.iGb(Object(va.a)(ag.a,b),l);this.TFb(Object(va.a)(ag.a,b),c);this.lTk(a)}TQi(a){const b=new Ha.a;for(let c=0;c<a[0].length;c++){let f=!0;for(let l=0;l<a.length;l++)if(1===a[l][c]){f=!1;break}f&&b.add(c)}return b}BRi(a){const b=new Ha.a;for(let c=0;c<a.length;c++){let f=!0;for(let l=0;l<a[c].length;l++)if(1===
a[c][l]){f=!1;break}f&&b.add(c)}return b}avi(a){let b=0;a=mb.GraphIterator.mb(a);Dd.moveToFirstRow(Object(va.a)(mb.GraphIterator,a));Dd.moveToFirstColumn(Object(va.a)(mb.GraphIterator,a));let c=Object(va.a)(126,a.hq),f=!1;for(;c;)!c.isGhostCell||De.isSkippedCell(Object(va.a)(ag.a,c))?(b+=c.h7a?c.colSpan:1,f=!0):f||b++,c=Object(va.a)(126,Dd.moveToNextColumn(Object(va.a)(mb.GraphIterator,a)));return b}Fwl(a){const b=mb.GraphIterator.mb(a.bjd.hq);let c=0;Dd.moveToFirstRow(Object(va.a)(mb.GraphIterator,
b));var f=b.hq;const l=Fd.a.Ef(Qt.cTg,1);for(;f;){for(;a.cGc.contains(c);)c++;var x=1,F=a.Tkc?a.Tkc.rowIndex:0,R=a.Urh[F+c];for(R<l&&(R=l);a.cGc.contains(c+x);){var fa=a.Urh[F+c+x];fa<l&&(fa=l);R+=fa;x++}f.setValue(Bb.a.Rt,R);f=x-1;x=0;Dd.moveToFirstColumn(Object(va.a)(mb.GraphIterator,b));for(F=Object(va.a)(126,b.hq);F;){R=F.h7a?F.colSpan:1;if(!F.isGhostCell||1<R){0<f&&(F.rowSpan-=f,1>F.rowSpan&&(F.rowSpan=1));fa=0;for(let wa=1;wa<R;wa++)a.aGc.contains(x+wa)&&fa++;0<fa&&(F.colSpan-=fa,1>F.colSpan&&
(F.colSpan=1))}x+=R;F=Object(va.a)(126,Dd.moveToNextColumn(Object(va.a)(mb.GraphIterator,b)))}c++;Dd.moveToFirstColumn(Object(va.a)(mb.GraphIterator,b));b.uc();f=Dd.moveToNextRow(Object(va.a)(mb.GraphIterator,b))}}qul(a){const b=new Ha.a;a=mb.GraphIterator.mb(a);Dd.moveToFirstRow(Object(va.a)(mb.GraphIterator,a));for(var c=a.hq;c;){c=!1;let l=0;Dd.moveToFirstColumn(Object(va.a)(mb.GraphIterator,a));for(var f=Object(va.a)(px.TableCellNode,a.currentNode);f;){if(f.isGhostCell)f.h7a?(c=!0,b.contains(l)||
(f.isGhostCell=!1,f.ZLd())):De.isSkippedCell(Object(va.a)(ag.a,f))||b.contains(l)&&(c||H.a.instance.ga(77))||(f.isGhostCell=!1,f.ZLd());else{c=!0;f=f.h7a?f.colSpan:1;for(let x=0;x<f;x++)b.contains(l+x)||b.add(l+x)}l++;f=Object(va.a)(px.TableCellNode,Dd.moveToNextColumn(Object(va.a)(mb.GraphIterator,a)))}Dd.moveToFirstColumn(Object(va.a)(mb.GraphIterator,a));a.uc();c=Dd.moveToNextRow(Object(va.a)(mb.GraphIterator,a))}}Oej(a,b){const c=[];let f=0;a=mb.GraphIterator.mb(a);Dd.moveToFirstRow(Object(va.a)(mb.GraphIterator,
a));for(var l=a.hq;l;){l=0;Dd.moveToFirstColumn(Object(va.a)(mb.GraphIterator,a));for(var x=Object(va.a)(126,a.hq);x;){if(!x.isGhostCell||De.isSkippedCell(Object(va.a)(ag.a,x))){const F=x.h7a?x.colSpan:1;for(x=x.F3d?x.rowSpan:1;f<c.length&&2===c[f][l];)l++,(l%=b)||f++;for(let R=0;R<x;R++){const fa=f+R;fa===c.length&&Array.add(c,Array(b));for(let wa=0;wa<F;wa++)c[fa][l+wa]=0<R||0<wa?2:1}l+=F}x=Object(va.a)(126,Dd.moveToNextColumn(Object(va.a)(mb.GraphIterator,a)))}Dd.moveToFirstColumn(Object(va.a)(mb.GraphIterator,
a));a.uc();l=Dd.moveToNextRow(Object(va.a)(mb.GraphIterator,a));f++}return c}lTk(a){if(xd.TableReader.Np(a.bjd)&&a.Tkc&&a.Srh){var b=Object(va.a)(133,a.bjd.hq),c=a.Srh,f=Array(b.F6),l=a.Tkc.hha;for(let x=0;x<f.length;x++)for(f[x]=c[l],l++;a.aGc.contains(l-a.Tkc.hha);)f[x]+=c[l],l++;b.MNa=f}}oxa(a){if(H.a.instance.ga(77)||H.a.instance.ga(63))Dd.forEachCellInTable(a,b=>{b.currentNode.kGa=null;return!0}),Dd.forEachCellInTable(a,b=>{const c=b.currentNode;if(!c.isGhostCell){const f=c.rowSpan,l=c.colSpan;
1<f||1<l?this.pyi(b,f,l):c.OEe()}return!0})}pyi(a,b,c){const f=a.currentNode,l=new mb.GraphIterator;l.Nc(a);Dd.forEachCell(l,b,c,(x,F,R)=>{const fa=x.currentNode;if(fa!==f){fa.isGhostCell=!0;let Xa=!1;var wa=!0;const lb=Hh.pe;lb&&(Xa=lb.isFeatureEnabled(136),lb.p9a(136));do{x.zb(1);if(Object(Fa.a)(eI.a,x.currentNode)){if((wa=wa&&Rd.OutlineElementReader.isEmpty(x,!1))||!Xa)wa=mb.GraphIterator.mb(x.hq),wa.mc(16),wa=!wa.uf(1);wa||a.hl(x.currentNode,1);x.Ii()}wa=!1}while(Xa&&x.bI(1))}fa.kGa=Object.assign(new fI,
{controlCell:f,Ggh:F,tOf:R});1!==F||R||(f.kGa.y3f=fa);F||1!==R||(f.kGa.z3f=fa);fa.OEe();R||(fa.colSpan=c)});f.rowSpan=b;f.colSpan=c}b6d(a){const b=new mb.GraphIterator;b.Nc(a);Dd.returnToContainingRow(b);var c=b.currentNode;b.zb(1);const f=new mb.GraphIterator;f.Nc(a);Dd.returnToContainingTable(f);a=f.currentNode;this.oxa(f);const l=rs.a.instance.createInstance(393251);this.M2b(f,l,c,c,!1);f.Ak(l);c=xd.TableReader.ui(a);for(let x=0;x<c;++x){const F=b.currentNode,R=this.gqa();this.xSb(f,R,F,!1,!0);
if(!R.isGhostCell)if(F.isGhostCell){let fa;(fa=F.kGa.controlCell).rowSpan=fa.rowSpan+1}else F.rowSpan=2;b.uf(1)}this.iGb(a,xd.TableReader.$j(a)+1);Dd.returnToContainingTable(f);this.oxa(f);return l}a6d(a){const b=mb.GraphIterator.mb(a.KCh());let c=xd.TableReader.ui(b.currentNode);a=Nn.a(a);const f=a+1;this.oxa(b);b.zb(1);do{const x=b.Jp(a,1);b.uc();const F=this.gqa();this.D2b(b,F,x,!1,!1);if(!F.isGhostCell)if(x.isGhostCell){var l=void 0;(l=x.kGa.controlCell).colSpan=l.colSpan+1}else x.colSpan=2}while(b.wj(1));
this.oxa(b);(l=b.currentNode.sa(bb.a.uu,null))&&(l=Pa.a.clone(l));this.TFb(b.currentNode,++c);l&&(Array.insert(l,f,l[a]),b.currentNode.setValue(bb.a.uu,l));this.bdc(b.currentNode,f,!1,1,null)}pcd(a,b){xd.TableReader.ju(a.currentNode)&&H.a.instance.ga(63)&&this.Kbh(a,c=>this.a4i(c,b),(c,f)=>{c.ke(Bb.a.Rt,f)},Bb.a.complexTable)}Plj(a,b,c,f){let l=b;const x=b.kGa;H.a.instance.ga(77)&&(a.isGhostCell=!1);if(x)if(Hh.vMc(x,!f))a.isGhostCell=!0;else{const F=Hh.Drb(x.controlCell,f);!b.isGhostCell&&c||!c&&
Hh.vMc(x,f)===F-1?(l=x.controlCell,!f&&l.F3d&&(a.rowSpan=l.rowSpan)):(a.isGhostCell=!0,Hh.pfb(x.controlCell,f,F+1));f&&l.h7a&&(a.colSpan=l.colSpan)}return l}zkj(a,b,c){var f=a.kGa;if(f)if(a.isGhostCell)this.vlj(f,b);else if(f=Hh.Drb(a,b),1<f){const l=Hh.Drb(a,!b),x=new mb.GraphIterator;x.set(a);x.mc(14);a=new mb.GraphIterator;a.Nc(x);const F=b?Dd.moveToNextRow(a):a.uf(1);Hh.pfb(F,b,f-1);Hh.pfb(F,!b,l);c(a,x)}}vlj(a,b){Hh.vMc(a,!b)||Hh.pfb(a.controlCell,b,Hh.Drb(a.controlCell,b)-1)}pJb(a,b){let c=
!1;Dd.forEachCellInTable(a,f=>De.isGhostCell(f)?(c=!0,!1):!0);a.currentNode.ke(b,c)}Kbh(a,b,c,f){var l=xd.TableReader.$j(a.currentNode);const x=xd.TableReader.ui(a.currentNode);if(l&&x){var F=!1,R=!1,fa=Array(l);Dd.forEachCellInTable(a,(kc,lc,Ec)=>{Ec||(fa[lc]=Array(x));kc=kc.currentNode;kc.isGhostCell?De.isSkippedCell(kc)?fa[lc][Ec]=2:fa[lc][Ec]=1:fa[lc][Ec]=0;return!0});var wa=Array(l),Xa=Array(l);for(var lb=0;lb<l;lb++){var Lb=!!lb;let kc=!0;for(let lc=0;lc<x;lc++)if(fa[lb][lc])1===fa[lb][lc]?
kc=!1:lb&&2===fa[lb-1][lc]||(Lb=!1);else{kc=Lb=!1;break}wa[lb]=Lb;Xa[lb]=kc}for(--l;0<=l;l--)Xa[l]?(a.Jp(l,1),this.YFc(a),Array.removeAt(fa,l),F=!0):wa[l]&&b&&(a.Jp(l,1),F=a.T_b(1),lb=b(a.currentNode),Lb=b(F),c(F,lb+Lb),this.YFc(a),Array.removeAt(fa,l),F=!0);l=fa.length;if(0<l){wa=Array(x);Xa=Array(x);for(b=0;b<x;b++){c=!!b;lb=!0;for(Lb=0;Lb<l;Lb++)if(fa[Lb][b])1===fa[Lb][b]?lb=!1:b&&2===fa[Lb][b-1]||(c=!1);else{lb=c=!1;break}wa[b]=c;Xa[b]=lb}b=a.currentNode.sa(bb.a.uu,null);c=!1;if(b)for(c=!0,b=
Array.clone(b),l=0;l<b.length;l++)if(!b[l]){c=!1;break}for(l=x-1;0<=l;l--)Xa[l]?(b&&Array.removeAt(b,l),this.WFc(a,l),R=!0):wa[l]&&c&&(b[l-1]+=b[l],Array.removeAt(b,l),this.WFc(a,l),R=!0);R&&b&&a.currentNode.setValue(bb.a.uu,b)}(F||R)&&this.pJb(a,f)}}a4i(a,b){let c=ik.b(a);c||(a=a.oc(b))&&(c=je.a.$G(a.htmlElement.offsetHeight));return c}iGb(a,b){xd.TableReader.$j(a)!==b&&a.properties.setValue(bb.a.Qwa,b)}TFb(a,b){const c=xd.TableReader.ui(a);c!==b&&(b&&c&&a.properties.Nn(bb.a.uu,bb.a.OYa),a.properties.setValue(bb.a.Oea,
b))}K6(a,b,c,f=null,l=!1,x=!1){a=this.gTf(a);H.a.instance.ga(71);this.l3f(a,b,c,f,l,x);H.a.instance.ga(71);return a}gTf(a){H.a.instance.ga(63)&&xd.TableReader.Sr(a)&&Dd.getContainingTable(a);const b=rs.a.instance.createInstance(393250);a.hl(b,2);a.Ak(b);return b}nJk(a,b,c,f,l){a=this.gTf(a);H.a.instance.ga(71);this.l3f(a,b,c,f,!1,l);Z.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",a.id.toString(),b,c));return a}l3f(a,b,c,f=null,l=!1,x=!1){const F=
mb.GraphIterator.mb(a);this.NSf(F,b,c,f,l);this.iGb(a,b);this.TFb(a,c);H.a.instance.ga(63);a.setValue(bb.a.Pgb,!x)}NSf(a,b,c,f=null,l=!1){for(var x=0;x<b;++x){var F=new EP.a;a.hl(F,1);H.a.instance.ga(55)&&F.setValue(Bb.a.Pn,Md.a.PWa())}b=null;x=!0;a.zb(1);do for(F=0;F<c;++F){const R=this.gqa();a.hl(R,1);({yih:b,isFirst:x}=this.k3f(a,R,l,f,b,x));Dd.returnToContainingRow(a)}while(a.wj(1))}k3f(a,b,c,f,l,x){a.Ak(b);l&&c?Hh.xi.Gni(a,l):(Hh.ox.IY(a,!0,f),!x&&c&&(l=new mb.GraphIterator,l.Nc(a)),x=!1);return{yih:l,
isFirst:x}}r6d(a,b,c,f){const l=new mb.GraphIterator;l.Nc(a);var x=l.currentNode;l.zb(1);let F=ik.c(a);if(b)var R=a.WE(1);else R=a.currentNode,F++;const fa=a.uc();H.a.instance.ga(63);this.oxa(a);let wa=null,Xa=null;for(var lb=0;lb<c;++lb){var Lb=rs.a.instance.createInstance(393251);Xa||(Xa=Lb);wa=Lb;this.M2b(a,Lb,R,x,b)}x=xd.TableReader.ui(a.currentNode);R=!0;do{R?(a.Ak(wa),R=!1):a.uf(1);for(lb=0;lb<x;++lb){Lb=this.gqa();const kc=this.xSb(a,Lb,l.currentNode,b,!0);this.JEf(a,Lb,f(kc));l.uf(1)}l.nia(1)}while(a.currentNode!==
Xa);this.iGb(fa,xd.TableReader.$j(fa)+c);this.rve(fa,b,F,c)}YFc(a){const b=ik.c(a);var c=b+1;a.uc();H.a.instance.ga(63);this.oxa(a);for(--c;c>=b;--c){a.Jp(c,1);let f=a.zb(1);for(;f;)this.tue(f,!0),f=a.wj(1);a.Ii()}this.iGb(a.currentNode,xd.TableReader.$j(a.currentNode)-1);this.Mue(a,b,1)}Cmg(a,b,c,f,l){H.a.instance.ga(63);this.oxa(a);let x=xd.TableReader.ui(a.currentNode);-1===b&&(b=x);const F=c?b:b-1;a.zb(1);do{const R=a.Jp(F,1);a.uc();for(let fa=0;fa<f;++fa){const wa=this.gqa(),Xa=this.D2b(a,wa,
R,c,!1);this.JEf(a,wa,l(Xa))}}while(a.wj(1));this.$Hk(a,x+f,f,b,c);this.bdc(a.currentNode,b,c,f,l)}$Hk(a,b,c,f,l){let x=a.currentNode.sa(bb.a.OYa,null),F=a.currentNode.sa(bb.a.uu,null);x&&(x=Pa.a.clone(x));F&&(F=Pa.a.clone(F));this.TFb(a.currentNode,b);if(H.a.instance.ga(30)&&x){const R=Array(b);let fa=0;for(;fa<f;++fa)R[fa]=x[fa];for(;fa<f+c;++fa)R[fa]=!1;for(;fa<b;++fa)R[fa]=x[fa-c];a.currentNode.setValue(bb.a.OYa,R)}F&&(b=this.WDf(a,F,b,f,l,c),a.currentNode.setValue(bb.a.uu,b))}WDf(a,b,c,f,l,x){a=
Array(c);let F=l=0;for(;l<f;++l)a[l]=b[l],F+=a[l];for(;l<c;++l)a[l]=0>l-x?b[0]:b[l-x],F+=a[l];if(H.a.instance.ga(63)&&0<F)for(b=0/F,l=0;l<c;++l)a[l]=Math.max(Fd.a.Ef(On.a.Xid,0),a[l]*b);return a}bdc(){}rve(){}M2b(a,b,c){a.nQc(b,c,1,Hh.S_a?Hh.S_a():null)}D2b(a,b,c,f){a.Ak(c);f=f?a.T_b(1):c;a.uc();a.nQc(b,f,1,Hh.S_a?Hh.S_a():null);return c}xSb(a,b,c){a.mAf(b,1,Hh.S_a?Hh.S_a():null);return c}JEf(a,b,c){De.isGhostCellNode(b)||(a.Ak(b),Hh.ox.IY(a,!0,c),Dd.returnToContainingRow(a))}WFc(a,b){H.a.instance.ga(63);
this.oxa(a);let c=xd.TableReader.ui(a.currentNode);-1===b&&(b=c-1);a.zb(1);do for(let f=b+1-1;f>=b;--f)a.Jp(f,1),this.tue(a.currentNode,!1),a.Ii();while(a.wj(1));this.ZHk(a,c-1,b);this.Lue(a,b,1)}ZHk(a,b,c){var f=a.currentNode.sa(bb.a.OYa,null);let l=a.currentNode.sa(bb.a.uu,null);f&&(f=Pa.a.clone(f));l&&(l=Pa.a.clone(l));this.TFb(a.currentNode,b);if(f){var x=Array(b);let F=0;for(;F<c;++F)x[F]=f[F];for(;F<b;++F)x[F]=f[F+1];a.currentNode.setValue(bb.a.OYa,x)}if(l){f=Array(b);for(x=0;x<c;++x)f[x]=l[x];
for(;x<b;++x)f[x]=l[x+1];a.currentNode.setValue(bb.a.uu,f)}}FVa(){}tue(){}Mue(){}Lue(){}eEi(a){const b=Nn.a(a);a.uc();a.uc();this.WFc(a,b)}gqa(){const a=rs.a.instance.createInstance(393252);a.setValue(bb.a.PD,kn.a.first);(new EF.OutlineIndentInfo(!0)).Yhh(a);return a}IL(a,b){a.setValue(bb.a.pl,b);a.setValue(bb.a.rI,b)}iNf(){}MXa(a,b,c){const f=xd.TableReader.ui(a);let l=a.sa(bb.a.OYa,null);l=l?Pa.a.clone(l):Array(f);let x=a.sa(bb.a.uu,null);x=x?Pa.a.clone(x):Array(f);l[b]=!0;x[b]=c;a.setValue(bb.a.uu,
x);a.setValue(bb.a.OYa,l)}static get $g(){return Hh.Gf||(Hh.Gf=hb.a.instance.resolve("Box4.IFormattingEditor"))}static get pe(){return Hh.Xc||(Hh.Xc=hb.a.instance.pb("Box4.IFeatureHelper"))}static sbg(a,b=!0){const c=new gI.a;if(a){let f=null;a=nd.SelectionFactory.nj(a,b);if(!a)Z.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");else for(b=0;b<a.length;b++)if(tb.a.MPf(a.ga(b))){f=a.ga(b);break}f&&(a=tb.a.Bs(f),a.cache.Fs&&(a=a.Sd(null),Hh.$g.aJ(a)),c.formatting=a.Sl,c.languageId=tb.a.language(a),
H.a.instance.ga(71)&&(c.style=Tc.StyleReader.kD(f.node)))}return c}static pfb(a,b,c){b?a.rowSpan=c:a.colSpan=c}static Drb(a,b){return b?a.rowSpan:a.colSpan}static vMc(a,b){return b?a.Ggh:a.tOf}static d3i(a,b){return b?a.z3f:a.y3f}static ymi(a,b,c){let f=a.sa(bb.a.uu,null);f=f?Pa.a.clone(f):Array(c);f[b]=0;a.setValue(bb.a.uu,f)}}Hh.Gf=null;Hh.Xc=null;Hh.ox=null;Hh.xi=null;Hh.S_a=null;Object(e.a)(Hh,"TableEditor",null,[742]);class ar{constructor(a){this.Lib=this.QO=0;fb.SelectionEditor.Jw(a)||(a=fb.SelectionEditor.yl(a,
!0,!1));a=a.Ua;const b=new mb.GraphIterator;b.set(a.node);fb.SelectionEditor.Vs(b);fb.SelectionEditor.Kg(a)&&(this.QO=a.Qa,this.Lib=a.TR);fb.SelectionEditor.C7(a)&&b.Ng(12);this.Ief=new lx(b)}restore(){var a=new mb.GraphIterator;this.Ief.Jl(Object(D.a)(this,this.bZk,"selectableFilter"),null);var b=new az.a;const c=new az.a;this.Ief.Sfh(a,c,b);if(Ya.ParagraphReader.Mr(a.currentNode)){if(!c.value&&b.value)return nd.SelectionFactory.nj(a.currentNode,!1);b=Pc.a.Uj(a.currentNode,this.QO);-1!==this.Lib&&
(a=Ya.ParagraphReader.NPa(a.currentNode,this.QO),0<this.Lib&&this.Lib<=a&&(b.TR=this.Lib,b.Lpa=this.Lib));return nd.SelectionFactory.eu(b)}return a.currentNode.zA?fb.SelectionEditor.yl(nd.SelectionFactory.Xk(a.currentNode),!b.value,!1):(a=fb.SelectionEditor.Oha(a,!b.value))?Ya.ParagraphReader.Mr(a)?nd.SelectionFactory.Jg(a,b.value?Ya.ParagraphReader.textLength(a):0):nd.SelectionFactory.Xk(a):null}bZk(a){return a.currentNode.sDa||a.currentNode.kI}}Object(e.a)(ar,"IpReference",null,[]);class hI{constructor(){this.tableNode=
null;this.columns=this.rows=0;this.$Lj=!1}}Object(e.a)(hI,"TableActionData",null,[]);var FP=d(180);class Ds{constructor(){this.GZb=!1}}Object(e.a)(Ds,"TrackChangeDeletionActionData",null,[]);class xc{static get Daa(){return xc.zu||(xc.zu=hb.a.instance.pb("Box4.IAutoCorrectScheduler"))}static get xL(){return xc.TF||(xc.TF=hb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get Yil(){return xc.cwf||(xc.cwf=hb.a.instance.pb("Box4.UI.TableAltTextDialogFactory"))}static get oEi(){return xc.rZe||
(xc.rZe=hb.a.instance.resolve("Box4.Actors.IDeleteTableSegmentStrategy"))}static Mq(){return xc.nm||(xc.nm=hb.a.instance.La("Box4.IExternalSelectionManager"))}static get lsb(){return xc.U_a||(xc.U_a=a=>Hh.sbg(a))}static set lsb(a){xc.U_a=a}static get Y_d(){return xc.Bsd||(xc.Bsd=xc.Z$i)}static set Y_d(a){xc.Bsd=a}static get V_d(){return xc.ysd||(xc.ysd=xc.T$i)}static set V_d(a){xc.ysd=a}static get W_d(){return xc.zsd||(xc.zsd=xc.V$i)}static set W_d(a){xc.zsd=a}static get X_d(){return xc.Asd||(xc.Asd=
xc.X$i)}static set X_d(a){xc.Asd=a}static get Z_d(){return xc.Csd||(xc.Csd=xc.aaj)}static set Z_d(a){xc.Csd=a}static get k2d(){return xc.Esd||(xc.Esd=xc.Iij)}static set k2d(a){xc.Esd=a}static get j0d(){return xc.Dsd||(xc.Dsd=xc.Maj)}static set j0d(a){xc.Dsd=a}static get jvb(){return xc.evd||(xc.evd=xc.fMj)}static set jvb(a){xc.evd=a}static get pe(){return xc.Xc||(xc.Xc=hb.a.instance.pb("Box4.IFeatureHelper"))}static get $g(){return xc.Gf||(xc.Gf=hb.a.instance.resolve("Box4.IFormattingEditor"))}static get Nf(){return xc.Wc||
(xc.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get k5(){return xc.Lo||(xc.Lo=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get sLd(){return xc.fKa||(xc.fKa=hb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}static get iH(){return kk.a.instance}static get Wi(){return Qg.a.instance}static get Rf(){return xc.Og||(xc.Og=hb.a.instance.resolve("Box4.List.IListReader"))}static get ao(){return xc.Jo||(xc.Jo=hb.a.instance.resolve("Box4.List.IListEditor"))}static get Jh(){return xc.xi||
(xc.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Pl(){return xc.ufa||(xc.ufa=Rg.ContextSetEditor.instance)}static set Pl(a){xc.ufa=a}static get Tc(){return Sa.a.instance}static get Aq(){return xc.PC||(xc.PC=hb.a.instance.resolve("Box4.ITableEditor"))}static get Xu(){null==xc.gA&&(xc.gA=u.AFrameworkApplication.fa.ka("UnblockComplexTableIsEnabled")&&!H.a.instance.ga(30));return xc.gA}static ub(a){const b=x=>li.Xqa(x.Oa,!1),c=(x,F,R,fa,wa)=>{const Xa=Gb.App.aJa.ARf(b);wa[xc.CTf]=
{};return Xa(x,F,R,fa,wa)};xc.Hwj();const f=u.AFrameworkApplication.Ta;a=a.BRf();f.xa(C.a.K6,Fb.a.view,xc.eBi);f.xa(C.a.K6,Fb.a.Lf,xc.K6);f.$d(C.a.K6,1028);f.xa(C.a.HCa,Fb.a.view,xc.q6d);f.xa(C.a.HCa,Fb.a.tableRow,xc.insertRow);f.$d(C.a.HCa,1028);f.xa(C.a.N7a,Fb.a.view,xc.q6d);f.xa(C.a.N7a,Fb.a.tableRow,xc.insertRow);f.$d(C.a.N7a,1028);f.xa(C.a.lRa,Fb.a.view,xc.E2b);f.xa(C.a.lRa,Fb.a.tableCell,xc.Z5d);f.$d(C.a.lRa,4);f.xa(C.a.qQc,Fb.a.view,xc.E2b);f.$d(C.a.qQc,4);f.xa(C.a.K7a,Fb.a.view,xc.E2b);f.xa(C.a.K7a,
Fb.a.tableCell,xc.Z5d);f.$d(C.a.K7a,4);f.xa(C.a.pQc,Fb.a.view,xc.E2b);f.$d(C.a.pQc,4);f.xa(C.a.EAa,Fb.a.view,xc.qVf);f.xa(C.a.EAa,Fb.a.tableCell,xc.EAa);f.$d(C.a.EAa,4);f.xa(C.a.deleteRow,Fb.a.view,xc.qVf);f.xa(C.a.deleteRow,Fb.a.tableRow,xc.deleteRow);f.$d(C.a.deleteRow,1028);f.xa(C.a.aba,Fb.a.view,xc.pEi);f.xa(C.a.aba,Fb.a.table,xc.aba);f.$d(C.a.aba,1028);f.xa(C.a.R3a,Fb.a.table,xc.R3a);f.xa(C.a.R3a,Fb.a.view,a);f.$d(C.a.R3a,4);f.xa(C.a.insertTable,Fb.a.view,xc.Pzj);f.xa(C.a.insertTable,Fb.a.Lf,
xc.insertTable);f.$d(C.a.insertTable,1036);f.xa(C.a.FVa,Fb.a.view,xc.fck);f.xa(C.a.FVa,Fb.a.tableCell,xc.FVa);f.$d(C.a.FVa,4);f.xa(C.a.vHb,Fb.a.view,xc.Rfl);f.xa(C.a.vHb,Fb.a.tableCell,xc.vHb);f.$d(C.a.vHb,4);f.pa(C.a.xDk,Fb.a.view,yr.a.O_,96);f.pa(C.a.zDk,Fb.a.view,yr.a.O_,96);f.xa(C.a.Hjl,Fb.a.view,yr.a.rG);f.xa(C.a.Vjl,Fb.a.view,yr.a.rG);f.xa(C.a.DQc,Fb.a.view,xc.DQc);f.$d(C.a.DQc,1124);f.xa(C.a.kHc,Fb.a.view,xc.kHc);f.$d(C.a.kHc,100);f.xa(C.a.Xic,Fb.a.view,xc.Xic);f.xa(C.a.Aed,Fb.a.view,xc.XYk);
f.xa(C.a.IGe,Fb.a.view,xc.IGe);f.xa(C.a.HGe,Fb.a.view,xc.HGe);f.xa(C.a.tmc,Fb.a.view,a);f.xa(C.a.tmc,Fb.a.table,xc.tmc);f.$d(C.a.tmc,4);f.xa(C.a.Xfc,Fb.a.view,a);f.xa(C.a.Xfc,Fb.a.table,xc.Xfc);f.$d(C.a.Xfc,96);H.a.instance.ga(30)&&(f.xa(C.a.uYa,Fb.a.view,xc.E2b),f.xa(C.a.uYa,Fb.a.Lf,xc.Z5d),f.$d(C.a.uYa,4),f.xa(C.a.Vkc,Fb.a.Lf,xc.insertRow),f.xa(C.a.Vkc,Fb.a.view,xc.q6d),f.$d(C.a.Vkc,4));f.xa(C.a.YDb,Fb.a.view,xc.YDb);H.a.instance.ga(63)?f.$d(C.a.YDb,96):f.$d(C.a.YDb,1124);a=[C.a.Hyg,C.a.Fyg,C.a.Jyg,
C.a.Gyg,C.a.Kyg,C.a.Iyg,C.a.Eyg,C.a.AUc,C.a.zUc,C.a.BUc,C.a.xUc,C.a.wUc,C.a.yUc,C.a.tUc,C.a.sUc,C.a.uUc];for(var l of a)f.xa(l,Fb.a.view,xc.Wha),f.xa(l,Fb.a.tableCell,xc.C9h),f.$d(l,4);l=[C.a.WAe,C.a.VAe,C.a.XAe,C.a.TAe,C.a.SAe,C.a.UAe,C.a.QAe,C.a.PAe,C.a.RAe];for(const x of l)f.xa(x,Fb.a.view,c),f.xa(x,Fb.a.paragraph,xc.tCk),f.$d(x,68)}static Hwj(){xc.AC.$(C.a.Kyg,xc.AC.$(C.a.AUc,xc.AC.$(C.a.zUc,xc.AC.$(C.a.BUc,xc.AC.$(C.a.WAe,xc.AC.$(C.a.VAe,xc.AC.$(C.a.XAe,xc.Gwh)))))));xc.AC.$(C.a.Iyg,xc.AC.$(C.a.xUc,
xc.AC.$(C.a.wUc,xc.AC.$(C.a.yUc,xc.AC.$(C.a.TAe,xc.AC.$(C.a.SAe,xc.AC.$(C.a.UAe,xc.Nck)))))));xc.AC.$(C.a.Eyg,xc.AC.$(C.a.tUc,xc.AC.$(C.a.sUc,xc.AC.$(C.a.uUc,xc.AC.$(C.a.QAe,xc.AC.$(C.a.PAe,xc.AC.$(C.a.RAe,xc.qci)))))));xc.hB.$(C.a.Hyg,xc.hB.$(C.a.AUc,xc.hB.$(C.a.xUc,xc.hB.$(C.a.tUc,xc.hB.$(C.a.WAe,xc.hB.$(C.a.TAe,xc.hB.$(C.a.QAe,1)))))));xc.hB.$(C.a.Fyg,xc.hB.$(C.a.zUc,xc.hB.$(C.a.wUc,xc.hB.$(C.a.sUc,xc.hB.$(C.a.VAe,xc.hB.$(C.a.SAe,xc.hB.$(C.a.PAe,2)))))));xc.hB.$(C.a.Jyg,xc.hB.$(C.a.BUc,xc.hB.$(C.a.yUc,
xc.hB.$(C.a.uUc,xc.hB.$(C.a.XAe,xc.hB.$(C.a.UAe,xc.hB.$(C.a.RAe,3)))))));xc.hB.$(C.a.Gyg,6)}static kHc(a,b,c){if(1===c)return 32;if(!b.view.Hh)return 2;a=b.view;if(!a.Eb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ola}),8;a=a.Eb.Dj;a=xc.Pl.w1(a,14);if(!a)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.Jqa}),8;xc.Yil.create(a);return 32}static Xic(a,b,c){N.a.mark(5756);if(!b.view.Hh)return 2;const f=b.view;if(!f.Eb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ola}),8;a=f.Eb.Dj;a=xc.Pl.w1(a,14);if(!a)return xc.Tc.Tb(Ed.a.ph,
{["Reason"]:Bd.a.Jqa}),8;if(2===c){let l=null;b=a.node;c=xd.TableReader.ju(b);const x=xc.Xu;if(!H.a.instance.ga(104)||c&&!x)l=nd.SelectionFactory.Xk(a.node);else if(H.a.instance.ga(77))c=nd.SelectionFactory.iFc(b,x),f.Eb.kGb(c,null);else{a=mb.GraphIterator.mb(b);a.zb(1);for(b=[$q.TableNodeContext.create(a.currentNode)];a.uf(1);)c&&ik.h(a)||Array.add(b,$q.TableNodeContext.create(a.currentNode));l=new $a.Selection(b,!0)}l&&(c=new wc.a(null,F=>{f.Eb.setSelection(l,F);return!1},null),c.xl("SelectTable"),
c.run())}N.a.mark(5757);return 32}static XYk(a,b,c){N.a.mark(5752);if(!b.view.Hh)return 2;a=b.view;if(!a.Eb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ola}),8;b=a.Eb.Oa;if(!b)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),2;b=xc.Z_d(b);if(32!==b.response)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.Jqa}),b.response;if(2===c){var f=b.lC;b=c=f[0].node;var l=mb.GraphIterator.mb(c);l.mc(14);let R=null;var x=Dd.getContainingTable(l);x=xd.TableReader.ju(x);var F=xc.Xu;F=H.a.instance.ga(104)&&(!x||F);
const fa=[];for(let wa=0;wa<f.length;++wa){const Xa=l.currentNode===f[wa].node;if(Xa||x&&ik.d(l))b=l.currentNode,!F||x&&ik.h(l)||Array.add(fa,$q.TableNodeContext.create(l.currentNode)),Dd.moveToNextRow(l),Xa||--wa}f=a.Eb.Oa.kb;l=null;F?H.a.instance.ga(77)?(l=new mb.GraphIterator,F=new mb.GraphIterator,f.qf?(l.set(c),F.set(b)):(l.set(b),F.set(c)),l.mc(14),Dd.moveToFirstColumn(l),F.mc(14),Dd.moveToLastColumn(F),l=x?nd.SelectionFactory.CWb(l,F):nd.SelectionFactory.eTf(l,F)):R=new $a.Selection(fa,H.a.instance.ga(63)||
f.qf):R=nd.SelectionFactory.RSf(c,b);R&&(l=new md.SelectionCollection([R],0));a.Eb.kGb(l,null)}N.a.mark(5753);return 32}static IGe(a,b,c){N.a.mark(5754);if(!b.view.Hh)return 2;a=b.view;if(!a.Eb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ola}),8;b=a.Eb.Oa;if(!b)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),2;b=xc.X_d(b);if(32!==b.response)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.Jqa}),b.response;if(2===c){c=[];var f=b.lC,l=new mb.GraphIterator;l.set(f[0].node);l.mc(14);b=Dd.getContainingTable(l);
var x=Number.MAX_VALUE,F=0;if(f.length===xd.TableReader.ui(Dd.getContainingTable(l)))F=null,H.a.instance.ga(104)&&(F=nd.SelectionFactory.iFc(b,xc.Xu))?c=F.toArray():(F=nd.SelectionFactory.Xk(b),Array.add(c,F)),x=0,F=xd.TableReader.ui(b)-1;else{for(l=0;l<f.length;++l){var R=mb.GraphIterator.mb(f[l].node);R.mc(14);R=Nn.a(R);x=Math.min(x,R);F=Math.max(F,R)}f=mb.GraphIterator.mb(b);Dd.moveToFirstRow(f);Dd.moveToColumnByIndex(f,x);l=new mb.GraphIterator;l.Nc(f);Dd.moveToColumnByIndex(l,F);var fa;R=b.lp();
R=H.a.instance.ga(104)&&(!R||xc.Xu);do(fa=R?nd.SelectionFactory.gFc(f,l,!0,!0):nd.SelectionFactory.RSf(f.currentNode,l.currentNode))&&Array.add(c,fa),fa=!Dd.moveToNextRow(f),Dd.moveToNextRow(l);while(!fa)}f=mb.GraphIterator.mb(b);Dd.moveToCell(f,0,x);x=xd.TableReader.$j(b);b=mb.GraphIterator.mb(b);Dd.moveToCell(b,x-1,F);c=new md.SelectionCollection(c,c.length-1,0,f,b);a.Eb.kGb(c,null)}N.a.mark(5751);return 32}static HGe(a,b,c){N.a.mark(5750);if(!b.view.Hh)return 2;a=b.view;if(!a.Eb)return xc.Tc.Tb(Ed.a.ph,
{["Reason"]:Bd.a.ola}),8;b=a.Eb.Dj;if(!b)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),2;var f=xc.Pl.jA(b);b={};for(var l=0;l<f.length;++l)if(f[l].Kk){var x=mb.GraphIterator.mb(f[l].node);x.Ze();if(!De.isTableCellOrInside(x))return 8;Dd.returnToCell(x);b[x.currentNode.id.toString()]=x}if(2===c){if(H.a.instance.ga(104)){c=a.Eb.Oa;if(c.kb.gg)return N.a.mark(5751),32;f=c.kb;x=f.qf?f.Ua:f.Te;l=f.qf?f.Te:f.Ua;c=new mb.GraphIterator;c.set(x.node);c.Ze();x=new mb.GraphIterator;x.set(l.node);x.Ze();
l=null;if((l=Dd.returnToLowestCommonTable(c,x))&&!l.lp()){var F=fb.SelectionEditor.yl(f,!0,!1);F=$q.TableNodeContext.create(c.currentNode,F.Ua);F=nd.SelectionFactory.yWb(nd.SelectionFactory.eu(F));a.Eb.ZD(F);N.a.mark(5751);return 32}}c=[];for(F in b)f=nd.SelectionFactory.Xk(b[F].currentNode),Array.add(c,f);0<c.length&&(F=new md.SelectionCollection(c,c.length-1),a.Eb.kGb(F,null))}N.a.mark(5751);return 32}static Cej(){return u.AFrameworkApplication.fa.ka("WacTableCellAlignmentIsEnabled")}static C9h(a,
b,c,f,l){f=xc.G7h();if(1===c)return f?32:8;if(!(l&&f&&b&&b.node))return 2;b=b.node;if(De.isGhostCellNode(b))return 32;xc.AC.Jb(a)&&(c=xc.AC.ga(a),b.ke(Bb.a.AOe,c));xc.hB.Jb(a)&&(a=xc.hB.ga(a),xc.wFf(b,a));return 32}static wFf(a,b){if(!De.isGhostCellNode(a)&&(a=mb.GraphIterator.mb(a),yh.OutlineNavigator.v9(a))){do if(a.zb(2)){const c=a.currentNode;12===c.type?c.ke(bb.a.pl,b):14===c.type?xd.TableReader.L4f(c,f=>{xc.wFf(f,b)}):Z.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",
FP.a[c.type]);a.uc()}while(a.jp())}}static tCk(a,b,c,f,l){if(!l)return 2;if(1===c)return 32;c=l[xc.CTf];if(xc.tNd in c&&!c[xc.tNd])return 32;f=xc.hB.ga(a);a=xc.AC.ga(a);if(!b||!b.node)return 2;var x=b.node;b=Ya.ParagraphReader.UM(x);x=mb.GraphIterator.mb(x);x.mc(16);x.Ng(16);x=x.currentNode.sa(Bb.a.AOe,xc.Gwh);c[xc.tNd]=l[ai.a.On]=f===b&&a===x;return 32}static pEi(a,b,c,f,l){if(!b.view.Hh)return 2;a=b.view;if(!a.Eb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ola}),8;let x=a.Eb.Dj;x=xc.Pl.w1(x,14);if(!x)return xc.Tc.Tb(Ed.a.ph,
{["Reason"]:Bd.a.Jqa}),8;if(1===c)return u.AFrameworkApplication.Ta.ii(x,C.a.aba,c,!0,f,l);N.a.mark(7117);const F=new ar(fb.SelectionEditor.yl(nd.SelectionFactory.eu(x),!0,!1)),R=new We.GraphTransaction(15);try{R.fd(b.view.rg);const fa=Gh.tMc(x.node,!0);fa.ana(x);const wa=Object(va.a)(Ds,l)||new Ds;let Xa=u.AFrameworkApplication.Ta.ii(x,C.a.aba,c,!0,f,xc.Nf.Zf?wa:l);const lb=!xc.Nf.Zf||!xc.Nf.jy||wa.GZb;32===Xa&&2===c&&lb?(fa.normalize(),a.Eb.setSelection(F.restore()),v.FocusManager.instance().Bf(a.RH)):
fa.cancel()}finally{R&&R.dispose()}N.a.mark(7118);return 32}static eBi(a,b,c,f,l){N.a.mark(4943);let x=null;2===c&&(x=new We.GraphTransaction(15),x.fd(b.view.rg));a=u.AFrameworkApplication.Ta.ii(b.MD,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Hh)return 2;b=b.view;c=b.Eb.Dj;c=xc.Pl.w1(c,16);f=new mb.GraphIterator;f.set(c.node);f.mc(14);Dd.moveToNextOrPreviousCell(f,!1);b.Eb.setSelection(nd.SelectionFactory.nj(f.currentNode,!0))}x&&x.dispose();N.a.mark(4944);return a}static E2b(a,b,c,f){if(!b.view.Hh)return 2;
var l=b.view;if(!l.Eb||!l.Eb.Oa.kb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),8;N.a.mark(4945);var x=l.Eb.Dj;if(!x)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),8;l=a===C.a.lRa||a===C.a.uYa;var F=xc.Pl.jA(x);if(!F||0>=F.length)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),8;F=F[0].node;if(!F)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),8;l=xd.TableReader.Yl(F)?a===C.a.pQc||l:a===C.a.qQc||l;const R=xc.V_d(x,l);if(32!==R.response)return R.response;x=R.No;F=xd.TableReader.ju(x);
const fa=a;let wa;wa=l?Object(va.a)(167,R.lC[R.lC.length-1]):Object(va.a)(167,R.lC[0]);a!==C.a.uYa&&(a=l?C.a.lRa:C.a.K7a);l=null;2===c&&(l=new We.GraphTransaction(15),l.fd(b.view.rg));a=u.AFrameworkApplication.Ta.ii(wa,a,c,!0,f,R.Acb);l&&l.dispose();2===c&&Z.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",fa,C.a.vz(fa)||"Unknown",H.a.instance.ga(77),F,a,x.id.toString(),xd.TableReader.ui(x)));
N.a.mark(4946);return a}static q6d(a,b,c,f){if(!b.view.Hh)return 2;const l=a===C.a.Vkc,x=a===C.a.N7a;N.a.mark(4947);var F=b.view;if(!F.Eb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ola}),8;const R=F.Eb.Dj;if(!R)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),8;F=xc.Y_d(R,x);if(32!==F.response)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.Jqa}),F.response;const fa=xd.TableReader.ju(F.No);let wa=null;2===c&&(wa=new We.GraphTransaction(15),wa.fd(b.view.rg));b=x?Object(va.a)(167,F.lC[0]):Object(va.a)(167,
F.lC[F.lC.length-1]);f=u.AFrameworkApplication.Ta.ii(l?R:b,a,c,!1,f,F.Acb);wa&&wa.dispose();2===c&&Z.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",a,C.a.vz(a)||"Unknown",H.a.instance.ga(77),fa,f,F.No.id.toString(),xd.TableReader.$j(F.No)));N.a.mark(4948);return f}static FTg(a){for(Dd.moveToFirstColumn(a);De.isGhostCell(a)&&Dd.moveToPreviousRow(a););}static Ndk(a){for(Dd.moveToFirstRow(a);De.isGhostCell(a)&&
Dd.moveToPreviousColumn(a););}static fck(a,b,c,f){if(H.a.instance.ga(30)||!b.view.Hh)return 2;const l=b.view;if(!l.Eb||!l.Eb.Oa.kb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),8;const x=xc.S6i(l.Eb.Dj);if(32!==x.response)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.Jqa}),x.response;let F=null,R=null;2===c&&(F=new ar(l.Eb.Oa.kb),F.restore(),R=new We.GraphTransaction(15),R.fd(b.view.rg));a=u.AFrameworkApplication.Ta.ii(Pc.a.create(x.controlCell),a,c,!1,f,x);2===c&&32===a&&(b=mb.GraphIterator.mb(x.No),
b.Ze()&&xc.Aq.pcd(b,l.Ma),F&&(l.Eb.setSelection(nd.SelectionFactory.nj(x.controlCell,!0)),v.FocusManager.instance().Bf(l.RH)));R&&R.dispose();2===c&&Z.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",a));return a}static S6i(a){const b=new dI;b.No=null;b.controlCell=null;if(!a)return b.response=8,b;var c=xc.Pl.jA(a);if(1>=c.length)return b.response=2,b;const f=new Ha.a;a={};for(let R=0;R<c.length;++R)if(c[R].Kk){const fa=mb.GraphIterator.mb(c[R].node);fa.Ze();
if(!De.isTableCellOrInside(fa))return b.response=8,b;var l=Object(va.a)(te.AParagraphNode,fa.currentNode);if(l&&!l.sa(Bb.a.O8d,!0))return b.response=8,b;Dd.returnToCell(fa);l=fa.currentNode;if(!f.contains(l.id.toString())){f.add(l.id.toString());var x=Dd.getContainingTable(fa),F=Dd.getContainingTableRow(fa).id.toString();if(b.No)if(b.No!==x)if(fa.LQa(b.No))continue;else if(mb.GraphIterator.mb(b.No).m$(x))a={},b.No=x,b.controlCell=l,a[F]=l.colSpan;else return b.response=8,b;else a[F]=F in a?a[F]+l.colSpan:
l.colSpan;else a={},b.No=x,b.controlCell=l,a[F]=l.colSpan;for(x=1;x<l.rowSpan;x++)Dd.moveToNextRow(fa),F=Dd.getContainingTableRow(fa).id.toString(),a[F]=F in a?a[F]+l.colSpan:l.colSpan}}if(!b.controlCell)return b.response=2,b;c=Object.keys(a);b.rowSpan=c.length;b.colSpan=a[c[0]];for(const R of c)if(b.colSpan!==a[R])return b.response=2,b;b.response=32;return b}static Rfl(a,b,c,f,l){if(H.a.instance.ga(30)||!b.view.Hh)return 2;const x=b.view;if(!x.Eb||!x.Eb.Oa.kb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),
8;if(fb.SelectionEditor.Jw(x.Eb.Oa.kb))var F=x.Eb.Oa.kb.Ua.node;else{F=x.Eb.Dj;if(!F)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.Jqa}),8;F=xc.Pl.jA(F);if(1!==F.length||!Object(Fa.a)(Pc.a,F[0]))return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.RPf}),8;F=F[0].node}F=mb.GraphIterator.mb(F);F.Ze();if(!De.isInTableCell(F))return 2;Dd.returnToContainingCell(F);F=F.currentNode;let R=null,fa=null;2===c&&(R=new ar(x.Eb.Oa.kb),R.restore(),fa=new We.GraphTransaction(15),fa.fd(b.view.rg));b=Pc.a.create(F);a=u.AFrameworkApplication.Ta.ii(b,
a,c,!1,f,l);2===c&&32===a&&R&&(x.Eb.setSelection(nd.SelectionFactory.nj(F,!0)),v.FocusManager.instance().Bf(x.RH));fa&&fa.dispose();2===c&&Z.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",a));return a}static qVf(a,b,c,f,l){if(!b.view.Hh)return 2;const x=a===C.a.deleteRow;x?N.a.mark(4951):N.a.mark(4949);const F=b.view;if(!F.Eb||!F.Eb.Oa.kb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),8;var R=F.Eb.Dj;const fa=xc.j0d(R,x,F.Eb);if(32!==fa.response)return xc.Tc.Tb(Ed.a.ph,
{["Reason"]:Bd.a.Jqa}),fa.response;const wa=xd.TableReader.ju(fa.No);var Xa=null,lb=null,Lb=null;let kc=!1;var lc=!1;2===c&&(Xa=new ar(F.Eb.Oa.kb),lc=Xa.restore(),Lb=mb.GraphIterator.mb(lc.Ua.node),Lb.mc(14),Dd.returnToContainingCell(Lb),lc=De.isLastCellInRow(Lb),Dd.returnToContainingRow(Lb),kc=ik.j(Lb),lb=Gh.tMc(b.view.rg,!0),wa&&(R=xc.oEi.f0f(R)),lb.ana(R),Lb=new We.GraphTransaction(15),Lb.fd(b.view.rg));b=Object(va.a)(Ds,l)||new Ds;f=u.AFrameworkApplication.Ta.ii(Ea.a.cOa(fa.lC),a,c,!1,f,xc.Nf.Zf&&
x?b:l);R=!xc.Nf.Zf||!xc.Nf.jy||!x||b.GZb;b=l=!1;if(2===c&&32===f&&R){let Ec=mb.GraphIterator.mb(fa.No);Ec.Ze()&&xc.Aq.pcd(Ec,F.Ma)}2===c&&32===f&&H.a.instance.ga(30)&&xd.TableReader.M$d(fa.No)&&R&&mb.GraphIterator.mb(fa.No).Ze()&&(Xa=x?new ar(nd.SelectionFactory.nj(fa.No,!kc)):new ar(nd.SelectionFactory.nj(fa.No,!lc)),F.Eb.setSelection(fb.SelectionEditor.yl(nd.SelectionFactory.Xk(fa.No),!1,!1)),u.AFrameworkApplication.Ta.processAction(C.a.R3a,2),b=l=!0);if(32===f&&2===c&&R){if(!l&&0>=xd.TableReader.ui(fa.No)||
0>=xd.TableReader.$j(fa.No))l=!0;lb.normalize();if(Xa){Xa=Xa.restore();if(l)Xa=b&&!x?nd.SelectionFactory.nj(Xa.Ua.node,!lc):nd.SelectionFactory.nj(Xa.Ua.node,!0);else if(lb=mb.GraphIterator.mb(Xa.Ua.node),lb.mc(14),x)Dd.returnToContainingRow(lb),kc&&!H.a.instance.ga(77)?(lb.Ze(),Yb.OutlineElementNavigator.Je(lb),xc.Jh.Tba(lb,!1,!0)):xc.FTg(lb),Xa=nd.SelectionFactory.nj(lb.currentNode,!0);else if(Dd.returnToCell(lb),lc&&H.a.instance.ga(30))Dd.moveToLastRow(lb),Xa=nd.SelectionFactory.nj(lb.currentNode,
!1);else if(H.a.instance.ga(63)||H.a.instance.ga(77))xc.Ndk(lb),Xa=nd.SelectionFactory.nj(lb.currentNode,!0);F.Eb.setSelection(Xa);v.FocusManager.instance().Bf(F.RH)}}else lb&&lb.cancel();Lb&&Lb.dispose();2===c&&Z.ULS.sendTraceTag(9011549,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",a,C.a.vz(a)||"Unknown",H.a.instance.ga(77),wa,f,fa.No.id.toString()));x?N.a.mark(4952):N.a.mark(4950);return f}static Iij(a,b){Dd.moveToFirstRow(a);
const c=Object(va.a)(px.TableCellNode,a.currentNode).colSpan;if(b)for(b=0;b<c;b++)Dd.moveToNextColumn(a);else Dd.moveToPreviousColumn(a)}static Z$i(a){return xc.NZb(a,!1,!0)}static T$i(a){return xc.NZb(a,!0,!0)}static V$i(a,b){let c=Nn.a(a);b&&(c+=a.currentNode.colSpan-1);return c}static X$i(a){a=ld.a.Znb(a);return xc.NZb(a,!0,H.a.instance.ga(104)&&xc.Xu)}static aaj(a){a=ld.a.Znb(a);return xc.NZb(a,!1,H.a.instance.ga(104)&&xc.Xu)}static Maj(a,b){return xc.NZb(a,!b,!0)}static NZb(a,b,c){const f=new Pt;
f.No=null;if(!a)return f.response=8,f;var l={};let x=[],F=!1;a=xc.Pl.jA(a);1===a.length&&(F=!0);for(let Xa=0;Xa<a.length;++Xa)if(a[Xa].Kk){const lb=[];let Lb=mb.GraphIterator.mb(a[Xa].node);Lb.Ze();if(!De.isTableCellOrInside(Lb))return f.response=8,f;if(b)Dd.returnToCell(Lb),c&&1<De.getColSpan(Lb.currentNode)?De.foreachMergedCells(Lb.currentNode,kc=>{kc=mb.GraphIterator.mb(kc);kc.Ze();Dd.moveToFirstRow(kc);Array.add(lb,kc)},2):Array.add(lb,Lb),Dd.moveToFirstRow(Lb);else{De.isTableCell(Lb)||Dd.returnToCell(Lb);
var R=Lb.currentNode.rowSpan;Dd.returnToContainingRow(Lb);if(1<R)for(var fa=1;fa<R;fa++){var wa=mb.GraphIterator.mb(Lb.currentNode);wa.Ze();Array.add(lb,wa);Dd.moveToNextRow(Lb)}Array.add(lb,Lb)}for(R=0;R<lb.length;++R)if(Lb=lb[R],fa=Dd.getContainingTable(Lb),wa=Lb.currentNode.id.toString(),!l[wa])if(l[wa]=!0,f.No)if(f.No!==fa)if(Lb.LQa(f.No))xc.A5f(Lb,f.No,b),wa=Lb.currentNode.id.toString(),l[wa]||(l[wa]=!0,Array.add(x,Lb));else if(l[wa]=!1,mb.GraphIterator.mb(f.No).m$(fa)){const kc=[];for(let lc=
0;lc<x.length;lc++){const Ec=x[lc];xc.A5f(Ec,fa,b);wa=Ec.currentNode.id.toString();l[wa]||(l[wa]=!0,Array.add(kc,Ec))}wa=Lb.currentNode.id.toString();l[wa]||(l[wa]=!0,Array.add(kc,Lb));f.No=fa;Array.clear(x);x=kc}else return f.response=8,f;else Array.add(x,Lb);else f.No=fa,Array.add(x,Lb);Array.clear(lb)}if(!x.length)return f.response=8,f;f.jHb=x[0].currentNode;b=[];for(l=0;l<x.length;l++){a=x[l];if(!c&&xd.TableReader.Cub(a))return f.response=8,f;Array.add(b,Pc.a.create(a.currentNode))}f.Acb=F?1:
b.length;f.lC=b;f.response=32;return f}static A5f(a,b,c){do c?Dd.returnToContainingCell(a):Dd.returnToContainingRow(a);while(Dd.getContainingTable(a)!==b);c&&Dd.moveToFirstRow(a)}static DQc(a,b,c,f,l){return 1===c?(a=b.MD)&&fb.SelectionEditor.Kg(a)?u.AFrameworkApplication.Ta.ii(a,C.a.insertTable,c,!0,f,l):2:32}static Pzj(a,b,c,f,l){f.pP=0;f.P6=0;let x=-1,F=null,R=null,fa=null;if(!b.view.Hh)return 2;const wa=b.view;if(!wa.Eb)return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ola}),8;N.a.mark(4941);if(2===c){const Xa=
wa.Eb.Dj;Xa.Kk&&(fa=new We.GraphTransaction(15),R=DF.a.instance.ggj(Xa.node),fa.Tx(R),F=new mb.GraphIterator,F.Nc(R),F.uc(),x=F.KPa(R.currentNode))}a=u.AFrameworkApplication.Ta.ii(b.MD,a,c,!0,f,l);32===a&&2===c&&(R.isValid?(Yb.OutlineElementNavigator.OI(R,!1,!1),Yb.OutlineElementNavigator.oi(R),c=nd.SelectionFactory.nj(R.currentNode,!0)):(F.j2d(x),Yb.OutlineElementNavigator.oi(F),c=nd.SelectionFactory.nj(F.currentNode,!0)),wa.Eb.setSelection(c),v.FocusManager.instance().Bf(wa.RH));fa&&fa.dispose();
N.a.mark(4942);return a}static YDb(a,b){if(!b.view.Hh)return 8;a=b.view;if(!a.Eb)return 8;a=xc.Pl.jA(a.Eb.Dj);if(0>=a.length)return 8;b=new mb.GraphIterator;for(let c=0;c<a.length;++c)if(b.set(a[c].node),b.Ze(),!xd.TableReader.Sr(b))return 8;return 32}static K6(a,b,c){var f=b.contextId===Fb.a.Lf;let l=null,x=null;if(f){l=b;if(Rb.HyperlinkReader.Uia(l,!0))return xc.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.NPf}),8;x=new mb.GraphIterator;x.set(l.node);fb.SelectionEditor.Vs(x);ph.b(x)&&(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.BNd}),
f=!1);!l.Qa&&x.htg&&(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.gqg}),f=!1)}if(1===c||!f)return f?32:8;N.a.mark(4929);b=new We.GraphTransaction(7);b.Tx(x);Yb.OutlineElementNavigator.Je(x);c=x.currentNode;xc.Jh.Tba(x,!1,!1);f=xc.Aq.K6(x,1,2);const F=new mb.GraphIterator;F.set(c);F.Ze();Dd.moveToCellContent(x,0,1);xc.Jh.uHb(F,x,l,!0,!0);Dd.returnToContainingTable(x);Dd.moveToCellContent(x,0,0);x.Ii();zm.i(F,x,null,F.role);xc.ao.V2a(F,null);Dd.returnToContainingTable(x);Yb.OutlineElementNavigator.Je(x);F.zb(1)&&
zm.h(x,null,1,1,F,-1);xc.Daa&&xc.Daa.Qmc(c,w.a.Bq);b.dispose();Z.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,C.a.vz(a)||"Unknown",H.a.instance.ga(77),f.id.toString()));N.a.mark(4930);return 32}static Z5d(a,b,c,f,l){u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?Z.ULS.sendTraceTag(541172701,324,50,"PPTO TestEcsFeature Client Flight Enabled. Box4."):Z.ULS.sendTraceTag(541172702,
324,50,"PPTO TestEcsFeature Client Flight Disabled. Box4.");var x=fb.SelectionEditor.Kg(b)&&a===C.a.uYa||b.contextId===Fb.a.tableCell;f=null;if(x&&(f=new mb.GraphIterator,f.set(b.node),f.mc(14),De.isTableCellOrInside(f)||(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.QVb}),x=!1),x&&!xc.jvb(f,a)&&(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.PVb}),x=!1),x)){Dd.returnToContainingCell(f);var F=H.a.instance.ga(63)?63:255;if(xd.TableReader.ui(Dd.getContainingTable(f))>=F)return xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.dSg}),8}if(1===
c||!x)return x?32:8;N.a.mark(4931);c=a!==C.a.K7a;x=new We.GraphTransaction(15);x.Tx(f);b.node.mG().graphTransactionOperations.Uga(2);F=new mb.GraphIterator;F.set(f.currentNode);F.mc(15);Dd.returnToContainingTable(f);let R=xc.W_d(F,c);c&&R++;xc.Aq.Cmg(f,R,!c,l?l:1,xc.lsb);f.set(b.node);f.mc(16);a===C.a.uYa?(Dd.moveToNextColumn(F),yh.OutlineNavigator.v9(F),Yb.OutlineElementNavigator.Je(f),xc.Jh.Hhc(F),xc.Jh.uHb(f,F,b,!0,!0),xc.Daa&&xc.Daa.Qmc(f.currentNode,w.a.Bq)):(a=Gb.App.Fb.Ed,b=mb.GraphIterator.mb(b.node),
b.Ze(),xc.k2d(b,c),a.en.Eb.setSelection(nd.SelectionFactory.nj(b.currentNode,!0)));x.dispose();N.a.mark(4932);return 32}static fMj(a){return!(H.a.instance.ga(14)&&xd.TableReader.rHj(a))&&!(H.a.instance.ga(30)&&xd.TableReader.Cub(a))}static insertRow(a,b,c,f,l){const x=a===C.a.Vkc;f=a===C.a.N7a;var F=b.node;const R=new mb.GraphIterator;R.set(F);R.Ze();let fa=!0;ik.m(F)||xd.TableReader.Sr(R)||(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.$Rd}),fa=!1);fa&&!xc.jvb(R,a)&&(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.PVb}),
fa=!1);if(1===c||!fa)return fa?32:8;N.a.mark(4933);a=new We.GraphTransaction(15);a.Tx(R);b.node.mG().graphTransactionOperations.Uga(2);x?(l=new mb.GraphIterator,l.Nc(R),Yb.OutlineElementNavigator.Je(l),Dd.returnToContainingRow(R),xc.Aq.r6d(R,f,1,xc.lsb),Dd.moveToFirstColumn(R),yh.OutlineNavigator.v9(R),xc.Jh.uHb(l,R,b,!1,!0),Dd.returnToContainingRow(R),xc.Daa&&xc.Daa.Qmc(l.currentNode,w.a.Bq)):xc.Aq.r6d(R,f,l?l:1,xc.lsb);b=Gb.App.Fb.Ed;F=mb.GraphIterator.mb(F);F.mc(14);ik.l(F)||Dd.returnToContainingRow(F);
f?Dd.moveToPreviousRow(F):Dd.moveToNextRow(F);xc.FTg(F);b.en.Eb.setSelection(nd.SelectionFactory.nj(F.currentNode,!0));a.dispose();N.a.mark(4934);return 32}static Wha(a,b,c,f,l){b=bi.r4(a,b,c,f,l,{},16);2===c&&xc.Lma(a)&&Z.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",a,C.a.vz(a)||"Unknown",b));return b}static Lma(a){return a===C.a.AUc||a===C.a.zUc||a===C.a.BUc||a===C.a.xUc||a===C.a.wUc||a===C.a.yUc||a===C.a.tUc||a===C.a.sUc||a===C.a.uUc}static EAa(a,b,
c){const f=new mb.GraphIterator;let l=b.isValid;l&&(f.set(b.node),f.Ze()||(xc.Tc.Tb(Ed.a.v0,{["Reason"]:Bd.a.DIc}),l=!1),De.isTableCellNode(b.node)||(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.QVb}),l=!1));l&&!xc.jvb(f,a)&&(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.PVb}),l=!1);if(l&&!xc.iH.oId()){a=new mb.GraphIterator;a.Nc(f);do if(!xc.iH.vUb(a.currentNode)){xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.dEc});l=!1;break}while(Dd.moveToNextRow(a))}if(l&&(a=new mb.GraphIterator,a.Nc(f),1!==c&&H.a.instance.ga(50)&&Gb.App.Eh.Qv)){do for(b=
wi.a.qz(a.currentNode);b.moveNext();){const x=b.currentNode;Ya.ParagraphReader.Wd(x)&&Gb.App.Eh.UX.epa(x)}while(Dd.moveToNextRow(a))}if(1===c)return l?32:8;if(l){N.a.mark(4935);c=new We.GraphTransaction(7);try{c.Tx(f),xc.Aq.eEi(f)}finally{c&&c.dispose()}N.a.mark(4936);return 32}return 2}static FVa(a,b,c,f,l){a=new mb.GraphIterator;if(f=b.isValid){a.set(b.node);a.Ze()||(xc.Tc.Tb(Ed.a.v0,{["Reason"]:Bd.a.DIc}),f=!1);De.isTableCellNode(b.node)||(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.QVb}),f=!1);if(f&&!xc.iH.oId()){b=
new mb.GraphIterator;b.Nc(a);var x=new mb.GraphIterator;x.Nc(a);for(var F=0;F<l.rowSpan;F++){for(var R=0;R<l.colSpan;R++){if(!xc.iH.vUb(b.currentNode)){xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.dEc});f=!1;break}b.uf(1)}if(!f)break;Dd.moveToNextRow(x);b.Nc(x)}}if(f&&1!==c&&H.a.instance.ga(50)&&Gb.App.Eh.Qv)for(b=new mb.GraphIterator,b.Nc(a),x=new mb.GraphIterator,x.Nc(a),F=0;F<l.rowSpan;F++){for(R=0;R<l.colSpan;R++)Gb.App.Eh.UX.epa(b.currentNode),b.uf(1);if(!f)break;Dd.moveToNextRow(x);b.Nc(x)}}if(1===c)return f?
32:8;if(f){c=new We.GraphTransaction(7);try{c.Tx(a),xc.Aq.FVa(a,l.rowSpan,l.colSpan)}finally{c&&c.dispose()}return 32}return 2}static vHb(a,b,c){a=new mb.GraphIterator;let f=b.isValid;f&&(a.set(b.node),a.Ze()||(xc.Tc.Tb(Ed.a.v0,{["Reason"]:Bd.a.DIc}),f=!1),De.isTableCellNode(b.node)||(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.QVb}),f=!1),f&&1!==c&&H.a.instance.ga(50)&&Gb.App.Eh.Qv&&(b=new mb.GraphIterator,b.Nc(a),Gb.App.Eh.UX.epa(b.currentNode)));if(1===c)return f?32:8;if(f){c=new We.GraphTransaction(7);
try{c.Tx(a)}finally{c&&c.dispose()}return 32}return 2}static aba(a,b,c,f,l){b=b.node;f=!0;xd.TableReader.O8a(b)||(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.bEc}),f=!1);xc.iH.vUb(b)||(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.dEc}),f=!1);f&&(H.a.instance.ga(14)||H.a.instance.ga(63))&&xc.Wi.hae(b)&&(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),f=!1);if(1===c)return f?32:8;if(f){if(H.a.instance.ga(50)&&Gb.App.Eh.Qv)for(c=wi.a.qz(b);c.moveNext();)f=c.currentNode,12===f.type&&Gb.App.Eh.UX.epa(f);l=Object(va.a)(Ds,l);c=new We.GraphTransaction(7);
c.fd(b);f=new mb.GraphIterator;f.set(b);f.Ze();f.uc();xc.Jh.LAa(f);c.dispose();l&&(l.GZb=!0);Z.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,C.a.vz(a)||"Unknown",H.a.instance.ga(77),b.id.toString()));return 32}return 2}static deleteRow(a,b,c,f,l){b=b.node;if(!xc.iH.vUb(b))return 8;f=new mb.GraphIterator;f.set(b);f.Ze();let x=ik.m(b);x||xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.UPf});x&&!xc.jvb(f,a)&&(xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.PVb}),x=
!1);if(1===c)return x?32:8;if(x){if(H.a.instance.ga(50)&&!Gb.App.Eh.amIAlone)for(a=wi.a.qz(b);a.moveNext();)c=a.currentNode,12===c.type&&Gb.App.Eh.UX.epa(c);N.a.mark(4937);l=Object(va.a)(Ds,l);a=new We.GraphTransaction(7);a.fd(b);xc.Aq.YFc(f);a.dispose();l&&(l.GZb=!0);N.a.mark(4938);return 32}return 2}static R3a(a,b,c){let f=!1;a=null;b.Kk&&(a=new mb.GraphIterator,a.set(b.node),(f=xd.TableReader.Np(a)&&xd.TableReader.M$d(a.currentNode))?a.Ze():xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.TPf}));return 1===c?
f?32:8:f?(N.a.mark(4939),b=new mb.GraphIterator,b.Nc(a),Dd.moveToCell(b,0,0),Yb.OutlineElementNavigator.Je(a),c=new We.GraphTransaction(7),c.Tx(b),xc.Jh.keh(a,b),c.dispose(),N.a.mark(4940),32):2}static insertTable(a,b,c,f,l){if(!b.Kk||!fb.SelectionEditor.Kg(b))return 2;if(H.a.instance.ga(14)&&xc.Wi.gsa(b))return xc.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),2;if(xc.Mq()&&xc.Mq().instance&&xc.Mq().instance.LV(b))return 2;var x=new mb.GraphIterator;x.set(b.node);fb.SelectionEditor.Vs(x);if(ph.b(x))return xc.Tc.Tb(Ed.a.Eo,
{["Reason"]:Bd.a.BNd}),2;if(1===c)return 32;c=1;x=2;l&&(c=l.rows,x=l.columns);f.pP=x;f.P6=c;if(fb.SelectionEditor.Kg(b)){f=new We.GraphTransaction(7);N.a.mark(4927);f.fd(b.node);b.node.mG().graphTransactionOperations.Uga(2);const R=new gI.a;H.a.instance.ga(50)&&Gb.App.Eh.Qv&&Gb.App.Eh.UX.epa(b.node);var F=tb.a.Bs(b);H.a.instance.ga(49)&&(F.cache.Fs&&(F=F.Sd(null),xc.$g.aJ(F)),R.formatting=F.Sl);R.languageId=tb.a.language(F);H.a.instance.ga(71)&&(R.style=Tc.StyleReader.kD(b.node),xc.Rf.NXb(R.style)&&
(F=Tc.StyleReader.tK(b.node)))&&(R.style=F.oG(Tc.StyleReader.HJa));H.a.instance.ga(54)?(F=mb.GraphIterator.mb(b.node),F.mc(11),xc.xL.m7(F.currentNode)):new Zu.a(1,-1);b=xc.Jh.vzj(b);F=l&&l.$Lj?xc.Aq.K6(b,c,x,R):xc.Aq.K6(b,c,x,R,!0);l&&(l.tableNode=F);Yb.OutlineElementNavigator.Je(b);H.a.instance.ga(56)&&R.style&&!Rd.OutlineElementReader.s$d(b.currentNode)&&R.style.sa(bb.a.iX,!1)&&xc.Jh.jIa(b.currentNode,!0);xc.ao.V2a(b,null,!0,!1,-1);Rd.OutlineElementReader.v8a(b)&&xc.Jh.Tba(b,!1,!0,R);f.dispose();
Z.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",a,C.a.vz(a)||"Unknown",H.a.instance.ga(77),F.id.toString(),c,x));N.a.mark(4928);u.AFrameworkApplication.mN("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings");return 32}return 2}static tmc(a,b,c){if(1===c)return 32;N.a.mark(5748);a=b.node;b=new We.GraphTransaction(15);b.fd(a);a.setValue(bb.a.Pgb,!a.sa(bb.a.Pgb,!0));b.dispose();
N.a.mark(5749);return 32}static Xfc(a,b,c,f,l){l.setValue(bb.a.Pgb,!b.node.sa(bb.a.Pgb,!0));return 32}}xc.Gwh="top";xc.Nck="center";xc.qci="bottom";xc.CTf="__cumulative__";xc.tNd="__consistent__";xc.hB=new $g.a;xc.AC=new $g.a;xc.xi=null;xc.zu=null;xc.TF=null;xc.cwf=null;xc.rZe=null;xc.gA=null;xc.nm=null;xc.U_a=null;xc.G7h=xc.Cej;xc.Bsd=null;xc.ysd=null;xc.zsd=null;xc.Asd=null;xc.Csd=null;xc.Esd=null;xc.Dsd=null;xc.evd=null;xc.Xc=null;xc.Gf=null;xc.Wc=null;xc.Lo=null;xc.fKa=null;xc.Og=null;xc.Jo=null;
xc.ufa=null;xc.PC=null;Object(e.a)(xc,"TableActor",null,[]);var iI=d(302),GP=d(804),jI=d(862),HP=d(392),IP=d(789);class kI{constructor(a,b,c,f){this.cGc=this.aGc=null;this.Tkc=a;this.bjd=b;this.Srh=c;this.Urh=f}}Object(e.a)(kI,"TableSimplificationInformation",null,[]);var jv=d(407),JP=d(443),Rt=d(251),vq=d(210);class Oh{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){this.Og=this.U_a=this.rM=this.gp=null;this.Gxd=!1;this.SQh=x;this.TF=F;this.$jb=a;this.PC=b;this.ox=c;this.xi=f;this.Jo=l;this.jb=
R;this.jk=wa;this.kEd=fa.create(2097162);this.TCe(this.kEd);this.n0e=fa.create(2097162);this.TCe(this.n0e);this.Nyf=fa.create(2097162);this.TCe(this.Nyf);this.Q0=this.kEd;this.QCd=Xa;this.QC=lb;this.Wc=Lb;this.MQb=kc;this.lUh=kc.substr(0,3);this.Wna=lc}get Rf(){return this.Og||(this.Og=hb.a.instance.resolve("Box4.List.IListReader"))}get xr(){return this.gp?this.gp.xr:0}get X3a(){return this.gp.kb.X3a}get Hha(){return this.gp.kb.Hha}get CPe(){return this.Q0}get ANd(){return this.gp.xG&&!this.Gxd}Qmh(){this.Gxd=
!0}get p1g(){return!this.gp.xG}get r$(){return eg.a.instance}get oKj(){return this.jb.ka("InternalPasteTableWithReplacingCellIsEnabled")&&H.a.instance.ga(63)||H.a.instance.ga(77)}TCe(a){var b=new JP.a(-1);this.SQh.gU.Hmb(b);const c=new mb.GraphIterator;c.set(b);b=this.jk.je(3);b.Tx(c);c.hl(a,80);b.dispose()}dOd(a,b=null){a=a.Eb;this.gp=a.Oa.clone();this.Gxd=!1;a=mb.GraphIterator.mb(a.ahb);const c=mb.GraphIterator.mb(this.Q0),f=this.jk.je(3);f.Tx(c);a.zb(82);do a.currentNode.CZa(null);while(a.wj(82));
a=new wc.a(b,Object(D.a)(this,this.Omi,"clearInternalClipboard"),new aI(a,c,this.gp,f));a.xl("InternalCopy");a.Vi=!b||b.Vi;a.run()}Omi(a,b){N.a.mark(5566);b=b.target;if(b.Ji())return b.Ii(),!0;a.Wg(Object(D.a)(this,this.gIc,"executeCopy"));return!0}gIc(a,b){b=new ez(b,null);b=new wc.a(a,Object(D.a)(this,this.cWb,"coreCopySetup"),b);b.xl("ExecuteCoreCopyToInternalClipboard");b.run();a.Wg(Object(D.a)(this,this.Uol,"trimNewText"));return!0}cWb(a,b){if(!b.source.Ji())return b.ih&&(b.ih.KCc=null),Z.ULS.shipAssertTag(6305560,
307,!1),!1;a.Wg(Object(D.a)(this,this.VQf,"coreCopyIteration"));return!0}VQf(a,b){const c=b.insertAfter,f=b.source,l=b.target,x=f.currentNode;var F=this.p1g;if(!x.V9d)return a.Wg(Object(D.a)(this,this.tEc,"coreCopyIncrement")),!0;b.ih.Fgd&&(b.Fgd=!0);if(!b.Fgd&&(x.HYb()&&b.r5.Gia.c++,x.HYb()||F&&!x.Yub(this.xr)))return a.Wg(Object(D.a)(this,this.tEc,"coreCopyIncrement")),!0;if(!b.Fgd&&F&&!x.Rx)return f.oCa()&&(b.Zld=!0,b=new wc.a(a,Object(D.a)(this,this.cWb,"coreCopySetup"),new ez(b,c)),b.xl("RecursiveCoreCopyToInternalClipboard"),
b.run()),a.Wg(Object(D.a)(this,this.tEc,"coreCopyIncrement")),!0;F=l.currentNode.to().ri;F=zm.a(x,F,!0);this.r$.phc(b.r5.Y6a,F);l.xK(F,c,18===f.parentNode.type?1:f.role);l.Ak(F);b.insertAfter=F;Ya.ParagraphReader.Wd(F)&&(this.GAk(a,Object(D.a)(this,this.cWb,"coreCopySetup"),x,F,b),this.FAk(x,F));this.E_f(x,F);f.oCa()&&(Z.ULS.shipAssertTag(6305562,307,!b.Zld),b=new wc.a(a,Object(D.a)(this,this.cWb,"coreCopySetup"),new ez(b,null)),b.xl("RecursiveCoreCopyToInternalClipboard"),b.run());a.Wg(Object(D.a)(this,
this.Nui,"coreCopyIterationPostProcessing"));return!0}Nui(a,b){var c=b.source;const f=b.target;var l=f.currentNode,x=c.currentNode;Ya.ParagraphReader.Lk(f)&&(b.nxe[x.id.toString()]=l);if(H.a.instance.ga(54)&&Ya.ParagraphReader.Wd(l)){if(0<Ya.ParagraphReader.ieg(x))if(0<this.TF.k6a(x).ZL)x.setValue(Bb.a.iec,0);else{var F=this.TF.Xrb(x).ZL;Oh.paragraphEditor.Tu.wfb(l,F)}if(!this.T7a&&this.Wna.t9c){c.uc();if(!xd.TableReader.Sr(f)&&c.Gub&&!this.Hha)for(var R of this.Wna.gsk)l.removeProperty(R);c.Ak(x)}}if(H.a.instance.ga(57)&&
Ya.ParagraphReader.Wd(l)){F=[];R=[];for(let fa=0;fa<l.wordRunProperties.length;fa++)l.wordRunProperties.xX.$(fa,iI.CharacterPropertiesEditor.Ada),l.wordRunProperties.Oda.$(fa,iI.CharacterPropertiesEditor.zda),F[fa]=!0,R[fa]=!1;l.ke(Bb.a.P5c,F);Z.ULS.shipAssertTag(6305563,307,F.length===l.wordRunProperties.length);Z.ULS.shipAssertTag(6305564,307,H.a.instance.ga(50));Z.ULS.shipAssertTag(6305565,307,!!Gb.App.Eh);H.a.instance.ga(50)&&Gb.App.Eh.Qv&&(l.ke(Cs.a.gw,R),Z.ULS.shipAssertTag(6305566,307,R.length===
l.wordRunProperties.length));(this.Wc.Zf&&this.Wc.jy||H.a.instance.ga(45)&&Gb.App.YC.FIb)&&l.setValue(Bb.a.Y3b,!0);H.a.instance.ga(14)&&l.Nn(Bb.a.GUd,Bb.a.Wrk,Bb.a.Yrk);H.a.instance.ga(45)&&Ya.ParagraphReader.Wd(l)&&l.Nn(Bb.a.F8a)}this.n1g(f)&&(F=f.currentNode.mG(),l=W.ImageReader.IMc(f.currentNode.properties,F.ri,!1),F=W.ImageReader.IMc(f.currentNode.properties,F.ri,!0),R=null,eb.EmbeddedFileReader.NRc(f)&&(R=eb.EmbeddedFileReader.tLc(f.currentNode)),this.IUd(l,x),this.IUd(F,x),this.IUd(R,x));this.p1g&&
(this.D_f(f),xd.TableReader.Np(f)&&(x=this.gp.jV(),x.moveNext(),(x=De.getCellLocation(c,x.current.node))||(x=new IP.a(0,0)),c=new kI(x,f,xd.TableReader.b_i(c),xd.TableReader.Jaj(c)),this.PC.ITk(c)));Rd.OutlineElementReader.Tg(f)&&!f.bI(2)&&(this.xi.Vaa(f),f.uc());f.uc();b.ih&&(b.ih.KCc=b.insertAfter);a.Wg(Object(D.a)(this,this.tEc,"coreCopyIncrement"));return!0}tEc(a,b){b.Zld&&(b.insertAfter=b.KCc,b.Zld=!1);if(!b.source.lCa()){b.ih&&(b.ih.KCc=b.insertAfter);const c=b.source;11!==c.mi||c.sMc(-1)||
this.aBk(a,c.currentNode,b.target.currentNode,b);return!1}a.Wg(Object(D.a)(this,this.VQf,"coreCopyIteration"));return!0}FAk(a,b){a=fg.f(a);fg.f(b);for(b=0;b<a.length;b++)Object(D.a)(this,this.cWb,"coreCopySetup")}Uol(a,b){if(b.Ypa>=b.xFb.length)return a.Wg(Object(D.a)(this,this.Mui,"copyTeardown")),!0;a=b.xFb[b.Ypa];var c=a.node,f=a.Qa,l=a.Kb;if(!fb.SelectionEditor.lu(a))if(!b.Ypa&&fb.SelectionEditor.Cl(a))l=f=Ya.ParagraphReader.textLength(c);else if(Ya.ParagraphReader.Xl(a))f=0,l=Ya.ParagraphReader.textLength(c);
else if(fb.SelectionEditor.C7(a)){Z.ULS.shipAssertTag(6305568,307,!b.Ypa);var x=mb.GraphIterator.mb(c);f=x.mc(12);Z.ULS.shipAssertTag(6305569,307,f);c=x.origin;l=f=Ya.ParagraphReader.textLength(c)}else{if(Ui.OutlineReader.e4b(a))for(a=ox.a.qz(a.node);a.moveNext();)x=a.currentNode,Ya.ParagraphReader.Wd(x)&&Array.add(b.xFb,Pc.a.createTextRange(x,0,Ya.ParagraphReader.textLength(x)));b.Ypa++;return!0}x=b.nxe[c.id.toString()];Z.ULS.shipAssertTag(6305570,307,!!x);if(!x)return Z.ULS.sendTraceTag(21041548,
307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:b.Ypa,["SelectedContextsLength"]:b.xFb.length,["SelectedNodeType"]:c.type,["ContextId"]:a.contextId}),b.Ypa++,!0;c=fg.f(x);let F,R=!1;for(F=c.length-1;0<=F;F--)if(!c[F].bCc)if(4===c[F].Eq)c[F].xe.blob=null,c[F].xe.blob=new jv.a(c[F].xe,jv.a.QFc),b.r5.Gia.e++;else{c[F].xe.blob=null;if(H.a.instance.ga(57)&&-1!==c[F].ig){var fa=c[F].xe.formatting,wa=void 0,Xa=void 0;fa&&-1===fa.ig?(Xa=c[F].ig+1,wa=c[F].x9-1,fa.ig=c[F].ig):(wa=c[F].x9,Xa=c[F].ig);
for(fa=0;fa<wa;fa++)x.wordRunProperties.removeAt(Xa,16);0<wa&&(R=!0)}wa="";Rt.f(c[F])?(wa=" ",b.r5.Gia.f++):Rt.g(c[F])&&(Xa=Rt.b(c[F]))&&(wa=Rt.a(Xa),b.r5.Gia.g++);Xa=c[F].xe.cp;Xa>=f&&Xa<l&&(Oh.characterPropertiesEditor.replaceTextRange(Pc.a.createTextRange(x,Xa,Xa+1),wa),l=l-1+wa.length,b.r5.Gia.i++)}R&&x.yu();this.gOk(x);c=Ya.ParagraphReader.textLength(x);l<c&&Oh.characterPropertiesEditor.replaceTextRange(Pc.a.createTextRange(x,l,c),"");0<f&&Oh.characterPropertiesEditor.replaceTextRange(Pc.a.createTextRange(x,
0,f),"");f=0;l=mb.GraphIterator.mb(x);for(l.zb(6);!l.Oq;)c=l.currentNode,l.wj(6),W.ImageReader.wG(c)?W.ImageReader.p$d(c)?(Oh.paragraphEditor.qQf(c,Pc.a.Uj(x,f)),f++,b.r5.Gia.d++):(c=mb.GraphIterator.mb(c),c.mc(12),c.Ii(),b.r5.Gia.h++):Z.ULS.shipAssertTag(6305571,307,!1);!Ya.ParagraphReader.textLength(x)&&b.Ypa===b.xFb.length-1&&fb.SelectionEditor.lu(a)&&(a=mb.GraphIterator.mb(x),a.mc(25)&&(Yb.OutlineElementNavigator.Je(a),this.xi.LAa(a),b.Ypa&&(this.gp.kb.Hha=!0)));this.r$.SWa(b.r5.c9c,b.r5.F3a,
b.r5.mNa,x);b.Ypa++;return!0}gOk(a){const b=H.a.instance.ga(14),c=!this.Wc.Zf&&H.a.instance.ga(45),f=Oh.eN,l=a.Ra;if(H.a.instance.ga(57)&&l&&(b||c)){var x=new Ha.a,F=new Ha.a;for(let fa=0;fa<l.length;fa++){const wa=l.ga(fa);if(b){wa.Yk&&x.add(wa);if(f){if(wa.Oh){for(var R=0;R<wa.Oh.length;R++)F.add(wa.Oh.ga(R).ig);wa.Oh=null}}else wa.fieldRangeEnd&&(F.add(wa.fieldRangeEnd.ig),wa.fieldRangeEnd=null),wa.ro&&(F.add(wa.ro.ig),wa.ro=null);if(wa.Tj){for(R=0;R<wa.Tj.length;R++)F.add(wa.Tj.ga(R).ig);wa.Tj=
null}}if(c){if(Gb.App.YC.FIb){wa.formatting&&Oh.$g.aJ(wa.formatting);if(wa.hyperlink){for(R=0;R<wa.hyperlink.x9;R++)F.add(wa.hyperlink.ig+R);wa.hyperlink=null}wa.Nm=!1}wa.trackedChange=null;wa.mI=!1}}a.uHa(!0,F);for(let fa of x)fa.Yk=null;c&&1<l.length&&(a=l.first,a.trackedChange=new GP.a(a),l.last.mI=!0)}}Mui(a,b){this.Q0.CZa(null);b.Rij.dispose();N.a.mark(5567);this.dfk();this.rM=b.r5;this.EAg("Copy");this.ADj&&Z.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get ADj(){return!mb.GraphIterator.mb(this.Q0).Ji()}Gxl(){this.Q0=
this.Nyf}Fxl(){this.Q0=this.kEd}txl(){this.Q0=this.n0e}mNf(){const a=mb.GraphIterator.mb(this.Q0);for(;a.Ji();)a.Ii()}EAg(a){const b=this.rM.Gia.b;a+="-"+b;this.rM.Gia.b=a;this.rM.Y6a.b=a;this.rM.c9c.b=a;this.rM.F3a.b=a;this.rM.mNa.b=a;this.r$.xWj(this.rM.Gia);this.r$.ice(this.rM.Y6a);this.r$.dBg(this.rM.c9c);this.r$.cce(this.rM.F3a);this.r$.bce(this.rM.mNa);this.rM.Gia.b=b;this.rM.Y6a.b=b;this.rM.c9c.b=b;this.rM.F3a.b=b;this.rM.mNa.b=b}r3g(a,b,c,f,l=null,x=null){this.EAg("Paste");b=mb.GraphIterator.mb(b);
const F=mb.GraphIterator.mb(this.Q0);var R=null;l&&(R=new Qw.a(Ui.OutlineReader.PFc,Ui.OutlineReader.MUf),R=l.equals(new Qw.a(-1,-1))?new Qw.a(0,0):l.bU(R));if(this.JQc())if(F.Ji(),W.ImageReader.wG(F.currentNode))l=F.currentNode,F.uc(),F.xK(this.xi.$Od(),null,1),F.Ji(),F.xK(l,null,2),F.uc(),F.Ak(l),F.Ii(),this.$jb.Pjk(),this.Qmh();else if(eb.EmbeddedFileReader.i8a(F.currentNode)){l=F.currentNode;F.uc();F.xK(this.xi.$Od(),null,1);F.Ji();var fa=this.xi.Vaa(F);fa=Pc.a.Uj(fa,0);Oh.characterPropertiesEditor.replaceTextRange(fa,
"<<"+eb.EmbeddedFileReader.uLc(l)+">>");F.uc();F.uc();F.Ak(l);F.Ii();this.Qmh()}this.oKj&&this.Lxg(F,b)?(F.currentNode.CZa(null),Z.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.URk(x,F,b,R,a),Z.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.")):(N.a.mark(5564),F.currentNode.CZa(null),a={},a[Oh.ruj]=f,Ib.ListReader.LRa(c)&&this.Rf.Ufc&&(a[jI.a.Xpg]=!0),c=new fz(F,b,c,R,a),f=new wc.a(x,Object(D.a)(this,this.dWb,"corePasteSetup"),
c),f.xl("ExecuteCorePasteFromInternalClipboard"),f.Vi=!x||x.Vi,this.wAk(c),f.run())}nxg(a){if(a&&a.isValid){const b=mb.GraphIterator.mb(this.Q0);return this.Lxg(b,a)}return!1}Lxg(a,b){if(De.isTableCellOrInside(b)&&1===a.Y5a()){a.zb(1);if(Rd.OutlineElementReader.Tg(a)){Yb.OutlineElementNavigator.oi(a);if(xd.TableReader.Np(a)){xd.TableReader.ju(a.currentNode)&&Z.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(b.mc(14)&&!xd.TableReader.ju(Dd.getContainingTable(b)))return Z.ULS.sendTraceTag(19269659,
307,50,"Target table is not a complex table."),!0;Z.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table.");if(this.T7a)return!0}Yb.OutlineElementNavigator.Je(a)}a.uc()}return!1}URk(a,b,c,f,l){c.mc(14);const x=ik.c(c),F=Nn.a(c);c.Ng(14);var R=xd.TableReader.$j(c.currentNode);const fa=xd.TableReader.ui(c.currentNode),wa=xd.TableReader.$j(b.currentNode),Xa=xd.TableReader.ui(b.currentNode);Z.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",
R,fa,wa,Xa);this.U_a=xc.lsb;if(this.jOj(x+wa,F+Xa)){var lb=x+wa-R;0<lb&&(Dd.moveToLastRow(c),Z.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+lb),this.PC.r6d(c,!1,lb,this.U_a),Z.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),c.Ng(14));lb=F+Xa-fa;if(0<lb){Z.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+lb);try{this.PC.Cmg(c,fa,!1,lb,this.U_a)}catch(Lb){throw Z.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Lb.toString()),Lb;}Z.ULS.sendTraceTag(8716377,
307,50,"Completed inserting columns.")}R=this.fZi(R,fa,wa,Xa,x,F);Z.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new wc.a(this.T7a?a:null,Object(D.a)(this,this.euk,"pasteTableOperationRun"),new cI(null,b,c,f,x,F,R,null,l));a.xl("ExecuteCorePasteTableInTable");a.Vi=!1;a.run()}}jOj(a,b){if(!this.Lug)return!0;const c={};a>Oh.JBc&&(c.rowCount=a,c.c_maxTableRowColCount=Oh.JBc);b>Oh.JBc&&(c.columnCount=b,c.c_maxTableRowColCount=Oh.JBc);const f=a*b;f>Oh.PJf&&(c.rowCount=a,c.columnCount=
b,c.cellsCount=f,c.c_maxTableCellCount=Oh.PJf);0<vq.a(c).length&&Z.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",c);return!vq.a(c).length}euk(a,b){if(b.ZHb){if(b.ZHb.inProgress)return!0;De.isTableCell(b.source)||b.source.Ng(16);this.Lug&&De.isFirstCellInTable(b.source)&&this.WSb(b.Df,b.target.currentNode);if(De.isLastCellInTable(b.source))return this.ffk(Dd.getContainingTable(b.target)),Z.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;De.isTableCell(b.target)||
b.target.Ng(16);const c=!this.T7a;De.isLastCellInRow(b.source)?(Dd.moveToNextRow(b.target),Dd.moveToColumnByIndex(b.target,b.hha),Z.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):Dd.moveToNextOrPreviousCell(b.target,!1,c);Dd.moveToNextOrPreviousCell(b.source,!1,c)}else xd.TableReader.Np(b.target)||b.target.Ng(14),xd.TableReader.Np(b.source)||b.source.Ng(14),Dd.moveToCell(b.target,b.rowIndex,b.hha),Dd.moveToCell(b.source,0,0);for(;b.target.Ji();)b.target.Ii();b.ZHb=new wc.a(a,
b.w3g?b.w3g:Object(D.a)(this,this.dWb,"corePasteSetup"),new fz(b.source,b.target,null,b.R8c));b.ZHb.xl("ExecuteCorePasteCellContentInCell");b.ZHb.Vi=!1;b.ZHb.run();return!0}dfk(){if(this.T7a){for(var a=mb.GraphIterator.mb(this.CPe),b=a.currentNode;14!==a.mi;)if(b=a.Ji(),!b){Z.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.SUg(b)}}ffk(a){this.T7a&&this.SUg(a)}nml(a){const b=mb.GraphIterator.mb(a);this.ox.K2b(b,null,
!0);a.isGhostCell=!1;a.rowSpan=1;a.colSpan=1}SUg(a){if(a&&14===a.type){Z.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var b={},c=xd.TableReader.$j(a),f=xd.TableReader.ui(a),l=mb.GraphIterator.mb(a);Dd.forEachCellInTable(l,(x,F,R)=>{const fa={};x=x.currentNode;if(16===x.type)if(x.isGhostCell)Oh.sPf(F,R)in b||(this.nml(x),fa.IsGhostCell="->false");else{H.a.instance.ga(77);Oh.FJk(a,x,F,R,c,(Xa,lb,Lb)=>{fa.rowSpan=String.format("{0}:{1}->{2}",Xa,lb,Lb)});Oh.EJk(a,x,R,F,f,(Xa,
lb,Lb)=>{fa.colSpan=String.format("{0}:{1}->{2}",Xa,lb,Lb)});const wa=String.format("{0},{1}-{2},{3}",F,R,F+x.rowSpan,R+x.colSpan);for(let Xa=0;Xa<x.rowSpan;Xa++)for(let lb=0;lb<x.colSpan;lb++)if(Xa||lb)b[Oh.sPf(F+Xa,R+lb)]=wa}if(0<vq.a(fa).length){if(void 0===fa.IsGhostCell||null===fa.IsGhostCell){if(void 0===fa.rowSpan||null===fa.rowSpan)fa.rowSpan=x.rowSpan;if(void 0===fa.colSpan||null===fa.colSpan)fa.colSpan=x.colSpan}Z.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",F,R,fa)}return!0});
Oh.NIi(b)}}get Lug(){return H.a.instance.ga(77)}get T7a(){return!!this.jb&&this.jb.ka("ComplexTableCellPasteWithFormattingIsEnabled")}WSb(a,b){a?(b=mb.GraphIterator.mb(b),b.uA(1)?(b=b.zb(2))?(b=nd.SelectionFactory.Jg(b,0),a.Eb.setSelection(b)):Z.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found."):Z.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")):Z.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")}fZi(a,
b,c,f,l,x){const F=[];for(let R=0;R<Math.max(l+c,a);R++){let fa=0,wa=x+f;for(R<l?fa=b:R>=l&&R<Math.min(l+c,a)?fa=x:R>=l+c&&R<a?fa=b:wa=Math.max(x+f,b);fa<wa;fa++)Array.add(F,Array(2)),F[F.length-1][0]=R,F[F.length-1][1]=fa}return F}dWb(a,b){if(!b.source.Ji())return a.Wg(Object(D.a)(this,this.tWa,"pasteTeardown")),!0;a.Wg(Object(D.a)(this,this.WQf,"corePasteIteration"));return!0}cSk(a,b){if(this.T7a)if(!b||!a)Z.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:b});
else if(16===b.currentNode.type&&16===a.parentNode.type){b=b.currentNode;a=a.parentNode;var c={};b.isGhostCell!==a.isGhostCell&&(b.isGhostCell=a.isGhostCell,c.IsGhostCell=b.isGhostCell);b.isSkippedCell!==a.isSkippedCell&&(b.isSkippedCell=a.isSkippedCell,c.IsSkippedCell=b.isSkippedCell);b.$fb!==a.$fb&&(b.$fb=a.$fb,c.ShouldRenderCell=b.$fb);b.colSpan!==a.colSpan&&(c.ColSpan=String.format("{0}<={1}.",b.colSpan,a.colSpan),b.colSpan=a.colSpan);b.rowSpan!==a.rowSpan&&(c.RowSpan=String.format("{0}<={1}.",
b.rowSpan,a.rowSpan),b.rowSpan=a.rowSpan);vq.a(c)}}WQf(a,b){const c=b.source,f=b.target,l=c.currentNode;if(!l.V9d||!l.rob)return a.Wg(Object(D.a)(this,this.uEc,"corePasteIncrement")),!0;if(this.Wc.Zf&&Rd.OutlineElementReader.Tg(c)){if(!Yb.OutlineElementNavigator.oi(c).rob)return Yb.OutlineElementNavigator.Je(c),a.Wg(Object(D.a)(this,this.uEc,"corePasteIncrement")),!0;Yb.OutlineElementNavigator.Je(c)}Z.ULS.shipAssertTag(6305608,307,!l.HYb());var x=f.currentNode.to().ri;x=zm.a(l,x,!0);x.Fcb();this.cSk(c,
f);f.xK(x,b.insertAfter,c.role);f.Ak(x);b.insertAfter=x;H.a.instance.ga(50)&&Gb.App.Eh.Qv&&Gb.App.Eh.UX.epa(x);this.E_f(l,x);b=new wc.a(a,Object(D.a)(this,this.dWb,"corePasteSetup"),new fz(c,f,null,b.R8c,b.kK));b.xl("RecursiveCorePasteOperation");b.run();a.Wg(Object(D.a)(this,this.Sui,"corePasteIterationPostProcessing"));return!0}gBk(a,b,c){b=fg.f(b);c=fg.f(c);for(let f=b.length-1;0<=f;f--)b[f].lue(c[f],a,Object(D.a)(this,this.dWb,"corePasteSetup"))}IUd(a,b){a&&(Z.ULS.shipAssertTag(6305610,307,a.Sa(Jg.a.Vdc)),
a.Sa(Jg.a.Vdc)||a.setValue(Jg.a.Vdc,a.sa(Jg.a.DVg,"")),b=(b=HP.SectionNavigator.Rcg(b))?b.fileId:Gb.App.Fb.Ed.vaa?Gb.App.Fb.Ed.vaa.fileId:null,!a.Sa(Jg.a.fileId)&&b&&a.setValue(Jg.a.fileId,b))}JUd(a){a&&this.$jb.r3k()}Sui(a,b){const c=b.target,f=c.currentNode,l=b.source.currentNode;Ya.ParagraphReader.Wd(f)&&(this.hBk(a,Object(D.a)(this,this.dWb,"corePasteSetup"),l,f,b),this.gBk(a,l,f));f.oWg();b.kK[jI.a.Xpg]&&22===f.type&&f.setValue(Bb.a.listID,Number.MAX_VALUE);if(H.a.instance.ga(11)&&Ya.ParagraphReader.Wd(f)){var x=
fg.j(f,5);if(0<x.length){for(var F of x)!F.properties.Sa(Bb.a.r4g)&&F.properties.Sa(Bb.a.q4g)&&(x=F.properties.getValue(Bb.a.q4g),F.properties.setValue(Bb.a.r4g,x)),W.ImageReader.n$d(F.properties)||this.$jb.MXk();f.to().contentReplicator.forceOutbound(null,null,null)}}H.a.instance.ga(25)&&Rd.OutlineElementReader.Tg(c)&&this.xi.mSe(c.currentNode);H.a.instance.ga(10)&&Ui.OutlineReader.NSc(f)&&(F=oq.b(f),b=b.R8c,oq.c(f,F.x+b.x,F.y+b.y));if(this.n1g(c)){b=c.currentNode.mG();F=W.ImageReader.IMc(c.currentNode.properties,
b.ri,!1);x=W.ImageReader.IMc(c.currentNode.properties,b.ri,!0);let R=null;eb.EmbeddedFileReader.NRc(c)&&(R=eb.EmbeddedFileReader.tLc(c.currentNode));this.JUd(F);this.JUd(x);this.JUd(R);if(F||x||R)b.AJj=!0,b.BJj=!0}H.a.instance.ga(24)&&eb.EmbeddedFileReader.NRc(c)&&(b=c.currentNode,eb.EmbeddedFileReader.ZFj(c)?(c.uc(),F=this.ox.Vyi(),F.setValue(bb.a.rI,Oh.sk.isRtl(b)?11:9),x=oq.b(f),oq.c(F,x.x,x.y),c.xK(F,b,1),c.Ak(b),c.SWf(),this.ox.IY(c,!1)):c.Ii(),F=this.xi.Vaa(c),F=Pc.a.Uj(F,0),Oh.characterPropertiesEditor.replaceTextRange(F,
"<<"+eb.EmbeddedFileReader.uLc(b)+">>"));this.D_f(c);this.Gwl(l,f);c.uc();a.Wg(Object(D.a)(this,this.uEc,"corePasteIncrement"));return!0}n1g(a){return H.a.instance.ga(1)&&W.ImageReader.K3b(a)||H.a.instance.ga(24)&&eb.EmbeddedFileReader.NRc(a)}Gwl(a,b){if(this.Wc.Zf&&xd.TableReader.O8a(a)){let c=0;const f=xd.TableReader.$j(a);for(let l of xd.TableReader.VMc(a,0,f-1))l.Fmc&&c++;a=this.jk.je(4);a.fd(b);b.properties.setValue(bb.a.Qwa,f-c);a.dispose()}}uEc(a,b){if(!b.source.lCa())return a.Wg(Object(D.a)(this,
this.tWa,"pasteTeardown")),!0;a.Wg(Object(D.a)(this,this.WQf,"corePasteIteration"));return!0}tWa(){N.a.mark(5565);return!1}$5c(){return!mb.GraphIterator.mb(this.Q0).Ji()}JQc(){return this.ANd?1===mb.GraphIterator.mb(this.Q0).Y5a():!1}dAj(){const a=mb.GraphIterator.mb(this.Q0);this.JQc()&&a.Ji();return 1===a.Y5a()&&(a.Ji(),Rd.OutlineElementReader.Tg(a)&&1===a.Y5a()&&a.zb(2))?Ya.ParagraphReader.Lk(a)&&!Oh.iH.VPf(a):!1}DZi(){const a=mb.GraphIterator.mb(this.Q0);this.JQc()&&a.Ji();a.Ji();a.Ji();Z.ULS.shipAssertTag(6305614,
307,Ya.ParagraphReader.Lk(a));return Ya.ParagraphReader.text(a.currentNode)}d8f(a){try{return this.U_i(a)}catch(b){return Z.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",b.message),0}}U_i(a){let b=0;if(a&&(b=this.T_i(a),0===b&&a.childNodes))for(let c=0;c<a.childNodes.length&&(b=this.d8f(a.childNodes[c]),0===b);c++);return b}T_i(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const b of a)if(b.startsWith(this.lUh))return b.startsWith(this.MQb)?
this.xr&&b===this.MQb+this.xr?3:2:1}return 0}GAk(a,b,c,f,l){l.kK||(l.kK={});Oh.Pa.raiseEvent("OnParagraphCopy",new gz(a,b,c,f,l.kK))}aBk(a,b,c,f){f.kK||(f.kK={});Oh.Pa.raiseEvent("OnCopyComplete",new gz(a,null,b,c,f.kK))}wAk(a){a.kK||(a.kK={});Oh.Pa.raiseEvent("BeforePaste",new bI(a.kK))}hBk(a,b,c,f,l){Oh.Pa.raiseEvent("OnParagraphPaste",new gz(a,b,c,f,l.kK))}D_f(a){De.isTableCell(a)&&(a.zb(1)||this.ox.IY(a,!0),a.uc())}E_f(a,b){this.QCd.isTableCellNode(b)&&(b.width=a.width)}static get $g(){return Oh.Gf||
(Oh.Gf=hb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Oh.Vg||(Oh.Vg=hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Oh.xw||(Oh.xw=hb.a.instance.resolve("Box4.IParagraphEditor"))}static get eN(){const a=hb.a.instance.pb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(79)}static get iH(){return kk.a.instance}static get sk(){return Pw.PageReader.instance}static NIi(a){const b={};for(const c of vq.a(a)){const f=
a[c];b[f]=f in b?String.format("{0}|{1}",b[f],c):c}1<=vq.a(b).length&&Z.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",b)}static EJk(a,b,c,f,l,x){b.colSpan>l-c&&(x&&x("A",b.colSpan,l-c),b.colSpan=l-c);a=Oh.wdl(a,b,f,c);b.colSpan!==a&&(x&&x("B",b.colSpan,a),b.colSpan=a)}static FJk(a,b,c,f,l,x){b.rowSpan>l-c&&(x&&x("A",b.rowSpan,l-c),b.rowSpan=l-c);a=Oh.xdl(a,b,c,f);b.rowSpan!==a&&(x&&x("B",b.rowSpan,a),b.rowSpan=a)}static wdl(a,b,c,f){return Oh.Oqh(a,b.colSpan,(l,x)=>{Dd.moveToCell(l,
c,f+x)})}static xdl(a,b,c,f){return Oh.Oqh(a,b.rowSpan,(l,x)=>{Dd.moveToCell(l,c+x,f)})}static Oqh(a,b,c){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!c)throw Error.argumentNull("MoveToCellAction");for(let l=1;l<b;l++){var f=mb.GraphIterator.mb(a);c(f,l);f=f.currentNode;if(!f||16!==f.type||!f.isGhostCell)return l}return b}static sPf(a,b){return a+","+b}}Oh.Pa=new qd.a;Oh.Gf=null;Oh.Vg=null;Oh.xw=null;Oh.JBc=50;Oh.PJf=1225;Oh.ruj="PasteConstrainingWidth";Object(e.a)(Oh,"InternalClipboard",
null,[]);class lI extends zj{constructor(a,b,c,f,l,x){super(a,b,c,l);this.Jr=f;this.nwd=x}get d9k(){return u.AFrameworkApplication.fa.ka("AutoResizeDragDropImageIsEnabled")}get jh(){return this.nwd.value}get $5c(){return this.Jr.$5c()}get O3g(){const a=this.Jr;return a.ANd&&!a.JQc()}t0f(a,b){Z.ULS.shipAssertTag(6305616,307,Ui.OutlineReader.At(a));const c=oq.b(a.currentNode);if(Ui.OutlineReader.isEmpty(a)){var f=Pc.a.create(a.currentNode);a.oC(8);u.AFrameworkApplication.Ta.ii(f,C.a.eK,2,!0,null,null)}else a.oC(8);
(f=a.uA(1))&&a.uc();this.Jr.r3g(this.ih.Df,a.currentNode,f,-1,c,b)}get Qrg(){return this.Jr.dAj()}get ZPf(){return this.Jr.DZi()}s0f(a){const b=new mb.GraphIterator;this.xdb.restore(b);Z.ULS.shipAssertTag(6305618,307,Rd.OutlineElementReader.Tg(b));this.ih.J_&&this.ih.J_.yAc("internal");let c=-1;if(this.qoh&&Object(Fa.a)(10,this.ih.ld))c=this.ih.ld.sa(Cs.a.YXb,-1);else if(this.d9k){const f=this.K0i(b.currentNode);c=f?f.clientWidth:c}this.Jr.r3g(this.ih.Df,b.parentNode,b.currentNode,c,null,a);this.Bug&&
(this.xdb.restore(b),Rd.OutlineElementReader.Tg(b)&&this.Jr.nxg(b)&&(a=Yb.OutlineElementNavigator.oi(b)))&&(this.ih.Oqa=nd.SelectionFactory.Jg(a,0))}K0i(a){return a?(a=a?a.oc(this.jh.Ma):null)?a.htmlElement:null:null}cph(){const a=new mb.GraphIterator;this.xdb.restore(a);return this.Jr.nxg(a)}get Doh(){return Ib.ListReader.Lw}get Coh(){return!this.Jr.Hha&&!this.Jr.ANd}}Object(e.a)(lI,"InternalPasteExecutionManager",zj,[]);class mI{constructor(a,b){this.Jr=a;this.nwd=b}create(a,b,c){return new lI(a,
b,c,this.Jr,Gb.App.Fb.Ed,this.nwd)}}Object(e.a)(mI,"Factory",null,[1156]);var hz;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(hz||(hz={}));Object(e.b)("CopySource",hz);class Nr{constructor(a,b,c){this.Jr=a;this.P5e=b;this.$Kh=c}Ntk(a,b,c){Z.ULS.shipAssertTag(6305620,307,!!a);Z.ULS.shipAssertTag(6305621,307,fb.SelectionEditor.Kg(b));Z.ULS.shipAssertTag(6305622,
307,!!c);Z.ULS.shipAssertTag(6305623,307,Object(Fa.a)(dp,c.m4));const f=c.m4;f.TNa=this.Jr.d8f(a);this.wWj(a,f);const l=this.d9d(a,b,f);if(l||this.rKe(a,b,f)){var x=new We.GraphTransaction(7);x.fd(b.node);b.node.mG().graphTransactionOperations.Uga(8);l?(Z.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",f.yw,f.browserName),a=this.P5e.create(b,f,x)):(Z.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",f.yw,f.TNa,f.browserName),Nr.pWj(a),a=
this.$Kh.create(a,b,f,x));c=new wc.a(c,Object(D.a)(a,a.z3g,"pasteSetup"),null);c.xl("Paste");c.run()}else f.Oqa=nd.SelectionFactory.eu(b)}d9d(a,b,c){return!this.tvg(c)&&3===c.TNa}rKe(){return!0}tvg(a){return 1===(a.yw&8192?1:0)}Zpg(a,b){Z.ULS.shipAssertTag(6305624,307,fb.SelectionEditor.Kg(a));Z.ULS.shipAssertTag(6305625,307,!!b);Z.ULS.shipAssertTag(6305626,307,Object(Fa.a)(dp,b.m4));const c=new We.GraphTransaction(7);c.fd(a.node);a=this.P5e.create(a,b.m4,c);b=new wc.a(b,Object(D.a)(a,a.z3g,"pasteSetup"),
null);b.xl("InternalPasteAtIp");b.run()}wWj(a,b){if(a){let c=!1,f=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?f=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(c=!0);if(c||f)u.AFrameworkApplication.mN("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),Z.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",hz[b.TNa],c,f)}}static pWj(a){a&&Nr.dYh.test(a.innerText)&&Z.ULS.sendTraceTag(6350173,
307,50,"External paste operation starts on WebUrl")}}Nr.dYh=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(e.a)(Nr,"PasteCoordinator",null,[]);class nC{constructor(a,b){this.ik=a;this.E5=b}}Object(e.a)(nC,"PasteFloatieFeatureSetBuilder",null,[]);class po{constructor(a,b){this.JLb=a;this.EIh=b}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get S4f(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get HFc(){return CommonUIStrings.l_ClipboardCut}get gre(){return CommonUIStrings.l_ClipboardCut_Mac}get sEc(){return CommonUIStrings.l_ClipboardCopy}get fre(){return CommonUIStrings.l_ClipboardCopy_Mac}get RGa(){return CommonUIStrings.l_ClipboardPaste}get hre(){return CommonUIStrings.l_ClipboardPaste_Mac}get tva(){return CommonUIStrings.l_ClipboardPasteText}get ire(){return CommonUIStrings.l_ClipboardPasteText_Mac}get sMd(){return this.EIh}get RNf(){return CommonUIStrings.l_ClipboardExtensionLink}get HNa(){return CommonUIStrings.l_ClipboardExtensionSuggestion}V0f(){Z.ULS.sendTraceTag(8716421,
307,50,null);kb.a.Um(this.sMd,"_blank",void 0,"ClipboardAccessExtensionLink")}W_(a,b){let c=n.a.ek;u.AFrameworkApplication.fa.ka("CcpFixIPadShortcutStringsIsEnabled")&&(c=n.a.Ki||c);return c?String.format(b,"\u2318"):a}dispose(){this.JLb=null}gCe(a){this.OQf(a)}rSj(a){this.OQf(a)}OQf(a){this.JLb&&this.JLb(a)}}po.id="CopyPasteShortcutDialog";po.Fvh="CopyPasteText";Object(e.a)(po,"ACopyPasteShortcutDialog",null,[106]);class nI extends po{constructor(a,b,c){super(a,b);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";b=document.createElement("span");b.id=po.Fvh;var f=document.createElement("span");f.innerText=this.S4f;var l=document.createElement("span");l.className="UIFontBold";l.innerText=this.W_(this.HFc,this.gre);const x=document.createElement("span");x.className="UIFontBold";x.innerText=this.W_(this.sEc,this.fre);const F=document.createElement("span");F.className="UIFontBold";F.innerText=this.W_(this.RGa,this.hre);b.appendChild(f);b.appendChild(document.createElement("br"));
b.appendChild(l);b.appendChild(x);b.appendChild(F);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(n.a.Hj||n.a.$f)&&(c=document.createElement("span"),c.className="UIFontBold",c.innerText=this.W_(this.tva,this.ire),b.appendChild(c));a.appendChild(b);this.sMd?(Z.ULS.sendTraceTag(8716420,307,50,null),c=document.createElement("span"),b=document.createElement("a"),b.href="#",b.innerText=this.RNf,yd.a.addHandler(b,"click",Object(D.a)(this,this.V0f,"extensionLinkHandler")),c.appendChild(b),l=this.HNa.indexOf("{0}"),
-1!==l&&(f=this.HNa.substring(l+3,this.HNa.length),l=document.createTextNode(this.HNa.substring(0,l)),f=document.createTextNode(f),c.insertBefore(l,b),c.appendChild(f)),a.appendChild(document.createElement("br")),a.appendChild(c)):Z.ULS.sendTraceTag(8716422,307,50,null);c=new rj.StandardDialog;c.vd=0;c.kg=po.id;c.Yw(this.titleText,null,0,Object(D.a)(this,this.rSj,"legacyCopyPasteShortcutDialogHandler"),a);c.J4(po.Fvh)}}Object(e.a)(nI,"CopyPasteShortcutDialog",po,[]);class oI extends po{constructor(a,
b){super(a,b);b={};a=this.$zj;b.extensionStartText=this.ONi;b.extensionLink=null;b.extensionEndText=null;b.shortcutsMessageText=this.k8k;b.cutText=this.W_(this.HFc,this.gre);b.copyText=this.W_(this.sEc,this.fre);b.pasteText=this.W_(this.RGa,this.hre);4!==u.AFrameworkApplication.Aa.gb.Am&&(b.pasteTextOnly=this.W_(this.tva,this.ire));b={["id"]:"CopyPasteInstallDialog",["bodyControls"]:b};const c=new Vh.a(!1,!1,!0);c.kg="CopyPasteInstallDialog";c.vd=0;c.Re(1,this.Zzj);c.fwa(1);c.pj(a,Object(D.a)(this,
this.gCe,"reactCopyPasteShortcutDialogHandler"),b)}get k8k(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get Zzj(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get $zj(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get ONi(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}}Object(e.a)(oI,"ReactCopyPasteInstallDialog",po,[]);class pI extends po{constructor(a){super(a,null);this.zzg="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";
var b={};a=this.Sek;var c="";let f="";this.messageText&&(c=this.messageText.split(" {")[0],f=this.messageText.split("} ")[1]);b.startText=c;b.endText=f;b.cutText=this.HCi;b.copyText=this.Cui;b.pasteText=this.Vtk;b.cutShortcutText=this.W_(this.ICi,this.N$j);b.copyShortcutText=this.W_(this.Kui,this.M$j);b.pasteShortcutText=this.W_(this.auk,this.P$j);b.imageSrc=sp.a.cK("NoClipboardAccessDialogImage.svg");b.imageAltText=this.uCa;b.primaryButtonLabel=this.FDb;this.zzg&&(Z.ULS.sendTraceTag(527986756,307,
50,"Learn more link is available"),b.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.xSa,["onExecute"]:()=>{this.oSj()}});b={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:b};c=new Vh.a(!1,!1,!0);c.vd=0;c.kg="CopyPasteNoClipboardAccessDialog";c.pj(a,Object(D.a)(this,this.gCe,"reactCopyPasteShortcutDialogHandler"),b)}get Sek(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get xSa(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get uCa(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get FDb(){return CommonUIStrings.l_DialogOk}get HCi(){return CommonUIStrings.l_CutString}get ICi(){return CommonUIStrings.l_CutShortcut}get N$j(){return CommonUIStrings.l_CutShortcut_Mac}get Cui(){return CommonUIStrings.l_CopyString}get Kui(){return CommonUIStrings.l_CopyShortcut}get M$j(){return CommonUIStrings.l_CopyShortcut_Mac}get Vtk(){return CommonUIStrings.l_PasteString}get auk(){return CommonUIStrings.l_PasteShortcut}get P$j(){return CommonUIStrings.l_PasteShortcut_Mac}oSj(){Z.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");kb.a.Um(this.zzg,"_blank",void 0,"learnMoreLink")}}Object(e.a)(pI,"ReactCopyPasteNoClipboardAccessDialog",po,[]);class qI extends po{constructor(a,b,c){super(a,b);a={};a.forwardElementText=this.S4f;a.cutText=this.W_(this.HFc,this.gre);a.copyText=this.W_(this.sEc,this.fre);a.pasteText=this.W_(this.RGa,this.hre);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(n.a.Hj||n.a.$f)&&(a.pasteTextOnly=this.W_(this.tva,this.ire));this.sMd?(Z.ULS.sendTraceTag(40726914,307,50,
null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.RNf,["onExecute"]:f=>{this.V0f(f)}},c=this.HNa.indexOf("{0}"),-1!==c&&(a.suggestionPrefixElement=this.HNa.substring(0,c),a.suggestionSuffixElement=this.HNa.substring(c+3,this.HNa.length))):Z.ULS.sendTraceTag(40726915,307,50,null);c={["id"]:po.id,["bodyControls"]:a};a=new Vh.a(!1,!1,!0);a.vd=0;a.kg=po.id;a.pj(this.titleText,Object(D.a)(this,this.gCe,"reactCopyPasteShortcutDialogHandler"),c)}}Object(e.a)(qI,"ReactCopyPasteShortcutDialog",
po,[]);class wq{constructor(){this.boa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.QB}tpb(a,b,c=!1,f=!1){Z.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.boa,c));f?new pI(a):this.boa?c?new oI(a,b):new qI(a,b,u.AFrameworkApplication.fa):new nI(a,b,u.AFrameworkApplication.fa)}static get instance(){return wq.Ja||(wq.Ja=new wq)}}wq.Ja=null;Object(e.a)(wq,"CopyPasteShortcutDialogFactory",null,[772]);class rI{constructor(a,b,c,f,l,
x,F){this.c8e=this.qCd=!1;this.pRb=a;this.Hf=b;this.yga=c;this.Hd=f;this.jd=l;this.jf=x;this.qd=F}get RL(){return this.pRb}get $Ca(){return this.c8e}set $Ca(a){this.c8e=a;this.jf.EPc=a}lba(a){this.RL.lba(a);a||this.XIa(!0)}E3a(a){this.RL.E3a(a)}get RLi(){return this.RL.E4}get xLi(){return this.RL.Bx}prepareForPaste(a){this.$Ca=!0;this.RL.prepareForPaste(a,!1,this.LOe)}wba(a,b){this.RL.wba(a,!1,b)}reset(){this.$Ca=!1}paste(){var a=this.Hf.Ld;a&&this.Hd.Bf(a.RH);var b=this.yga.VJ;if(!b.Hh||!b.editingView.Bl)return null;
a=b.editingView;let c=this.jd.Tl();this.$Ca=!0;b.txa();b=null;try{a.rzk(),b=c=this.RL.a5a(this.LOe,c)}catch(f){Z.ULS.shipAssertTag(6305672,307,!1),this.j1b(!0)}this.$Ca=!1;return b}copy(){var a=this.Hf.Ld;a&&this.Hd.Bf(a.RH);a=this.yga.VJ;if(!a.Hh||1!==a.editingView.mode)return!1;this.$Ca=!0;let b;try{this.RL.hIc(this.LOe),b=!0}catch(c){Z.ULS.shipAssertTag(6305673,307,n.a.$f),Z.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",n.a.iy),b=!1}this.$Ca=
!1;return b?!0:!1}XIa(a){if(this.qCd)return!0;var b=this.yga.VJ;if(!b.Hh||!b.editingView.Bl)return!1;const c=b.editingView;b=this.jd.Tl();this.$Ca=!0;const f=new od.a(b);let l=!1;try{l=this.RL.XIa(b,()=>{c.bni()},()=>{c.RHa()})}catch(x){Z.ULS.shipAssertTag(6305674,307,!n.a.xj)}f.restore();this.$Ca=!1;l?this.qCd=!0:(Z.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",n.a.iy),n.a.xj||this.j1b(a));return l}j1b(){this.qCd=!1;if(u.AFrameworkApplication.wacCopyPasteShortcutDialogIsEnabled)wq.instance.tpb(null,
null);else{const a=new rj.StandardDialog;a.vd=0;a.mO(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get LOe(){const a=this.jd.JBa();return a?a.zl:null}}Object(e.a)(rI,"SystemClipboard",null,[1146]);class oC{constructor(a){this.Zhb=2147483647;this.ZKb=null;this.ym=0;this.XIg=!0;this.mef=window.navigator.clipboard;this.nef=window.navigator.permissions;this.vR=a}getData(a,b){Z.ULS.sendTraceTag(538240020,307,50,"GetData: Started");try{if(this.ZKb){var c=this.EZi(this.ZKb,
a);c?this.ZKb[0].getType(c).then(f=>{"image/png"===c?this.vR.WVb([f],l=>{this.ove(l,b,c)}):f.text().then(l=>{l="text/html"===c?this.wSi(l):l;Z.ULS.sendTraceTag(528859362,307,50,"GetData: Retrieved data with type: {0} and size: {1}",c,l.length);b(a,l)}).catch(()=>{this.bW(!1,"getDataFailed");b(a,null)})}).catch(()=>{this.bW(!1,"getDataFailed");b(a,null)}):(this.bW(!1,"unSupportedType"),b(a,null))}else this.bW(!1,"invalidClipboardItems"),b(a,null)}catch(f){this.bW(!1,"getDataFailed"),b(a,null)}}EZi(a,
b){let c=null;a&&0<a.length&&(a=a[0].types,b?c=Array.contains(a,b)?b:null:Array.contains(a,"text/html")?c="text/html":Array.contains(a,"image/png")?c="image/png":Array.contains(a,"text/plain")&&(c="text/plain"));return c}ove(a,b,c){a&&this.vR.nkc&&(a=String.format('<img src="{0}">',a));Z.ULS.sendTraceTag(528818690,307,50,"OnImageConverted: Retrieved data with type: {0} and size: {1}",c,a.length);b("image/png",a)}wSi(a){return this.trim(a,"\n")}trim(a,b){if(!a)return null;let c=0;for(;c<a.length&&
a.charAt(c)===b;)c++;let f=a.length-1;for(;f>c&&a.charAt(f)===b;)f--;return a.substr(c,f-c+1)}sRe(a,b,c){this.ZKb=b;a(c)}Kkd(a){try{this.ZKb=null,this.mef.read().then(b=>{let c;this.ym&&(c=Date.now()-this.ym,Z.ULS.sendTraceTag(526952409,307,50,"Time taken to read data: {0}",c));this.bW(!0,"none");this.sRe(a,b,!0)},()=>{this.bW(!1,"clipboardReadFailed");this.sRe(a,null,!1)}).catch(()=>{this.bW(!1,"clipboardReadFailed");this.sRe(a,null,!1)})}catch(b){this.bW(!1,"clipboardReadNotSupported"),a(!1)}}xMf(a,
b){this.XIg=a?!0:!1;if(this.mef)if(this.nef)try{this.nef.query({name:"clipboard-read"}).then(c=>{c?(c=c.state,"granted"===c?(this.ym=Date.now(),this.Kkd(b)):"prompt"===c&&a?this.Kkd(b):(this.bW(!1,"permissionDenied"),b(!1))):(this.bW(!1,"invalidPermissionStatus"),b(!1))},()=>{this.bW(!1,"permissionQueryFailed");a?this.Kkd(b):b(!1)}).catch(()=>{this.bW(!1,"permissionQueryFailed");b(!1)})}catch(c){this.bW(!1,"permissionQueryNotSupported"),b(!1)}else this.bW(!1,"navigatorPermissionNotSupported"),a&&
this.Kkd(b);else this.bW(!1,"navigatorClipboardNotSupported"),b(!1)}bW(a,b){const c={};c.AsyncAPISuccess=a.toString();c.IsPasteEvent=this.XIg;"none"!==b&&(c.AsyncAPIFailureReason=b);Z.ULS.sendTraceTag(522814493,307,50,JSON.stringify(c))}}Object(e.a)(oC,"AsyncClipboardAPI",null,[]);class iz{constructor(){this.pptObjectData=this.pptObjectMetaData=this.pptSlide=this.text=this.html=this.img=null;this.isImageAvailable=!1}}Object(e.a)(iz,"ExtensionClipboardData",null,[]);class sI{constructor(a,b,c,f){this.e1=
this.jz=this.Wbf=this.Fna=null;this.upc=a.ka("ChromeClipboardAccessExtensionSuggestionIsEnabled");a.ka("ChromeClipboardAccessRichFormatContentIsEnabled");a.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.mMh=a.Ha("ChromeClipboardAccessExtensionLink");this.BKa=b;this.ik=c;this.XQh=a.Ha("ChromeClipboardAccessExtensionId");this.vR=f;this.K0=new oC(this.vR);this.mMb=null;this.h6e=l=>!!l.tagName&&"a"===l.tagName.toLowerCase()}lba(a){a?this.jz=!0:(this.e1=this.jz=null,chrome.runtime&&chrome.runtime.sendMessage?
(this.mMb=this.BKa.xLc(),this.BKa.owa?this.mMf(!0,null):(this.jz=!0,Z.ULS.sendTraceTag(19256732,307,50,Ga.a.create().toString()))):this.K0?this.Job(!0,null):(this.Cye(),this.jz=!1))}E3a(a){this.e1=this.jz=null;chrome.runtime&&chrome.runtime.sendMessage?(this.mMb=this.BKa.xLc(),this.BKa.owa?this.mMf(!1,a):(this.jz=!0,Z.ULS.sendTraceTag(19256732,307,50,Ga.a.create().toString()),a(this.E4))):this.K0?this.Job(!1,a):(this.jz=!1,a(this.E4))}get E4(){return this.jz}get Bx(){return this.e1}XIa(){return!0}hIc(a){Z.ULS.sendTraceTag(24402115,
307,50,"Execute chrome copy");kb.a.$4a(a,"copy")||Z.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))}a5a(a,b){this.Fna&&(a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.Fna,b=a.body,this.Fna=null);return b}u8f(a,b){const c=Ga.a.create();this.Wbf=c;this.BKa.owa?Z.ULS.sendTraceTag(7377737,307,50,c.toString()):Z.ULS.sendTraceTag(19256735,307,50,c.toString());const f={};f.command=b;chrome.runtime&&
chrome.runtime.sendMessage?chrome.runtime.sendMessage(this.mMb,f,l=>{c.equals(this.Wbf)?this.Fna=l:Z.ULS.sendTraceTag(7385868,307,50,null);Z.ULS.sendTraceTag(7377738,307,50,c.toString());chrome.runtime.lastError&&(this.JIi(),this.BKa.owa?Z.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):Z.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));a(l)}):(Z.ULS.sendTraceTag(526951574,307,10,"ChromeApi.RuntimeSendMessage not supported"),a(null))}prepareForPaste(a,b){const c=
()=>{a(!1)},f=(l,x)=>{this.Fna=x;a(!0)};null!=this.Bx&&this.Bx?this.K0.getData(b?"image/png":null,f):this.u8f(c,"paste")}wba(a,b,c){a=(f,l)=>{const x=new iz;"image/png"==f?x.img=l:x.html=l;c(x)};null!=this.Bx&&this.Bx?this.K0.getData(b?"image/png":null,a):this.u8f(c,"getClipboardData")}Cye(){Z.ULS.sendTraceTag(8716423,307,50,null);wq.instance.tpb(Object(D.a)(this,this.Twk,"popupInstallDialogHandler"),this.upc?this.mMh+this.mMb:null)}Twk(a){1===a?Z.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",
this.upc)):0===a&&Z.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.upc))}Qwk(){Z.ULS.sendTraceTag(527966608,307,50,null);wq.instance.tpb(Object(D.a)(this,this.Rwk,"popupClipboardAccessDialogHandler"),null,!1,!0)}Rwk(){Z.ULS.sendTraceTag(527966609,307,50,String.format("ClipboardAccessDialog OK Clicked",this.upc))}JIi(){this.BKa.QEe();this.Cye()}Ajh(a,b){const c={command:"test",object:"ping"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(a,c,b):(Z.ULS.sendTraceTag(526951575,
307,10,"ChromeApi.RuntimeSendMessage not supported"),b(null))}Job(a,b){Z.ULS.sendTraceTag(538478226,307,50,"CheckAsyncClipboardApiSupport");this.K0.xMf(a,c=>{this.e1=c;this.jz=this.Bx;a&&this.fbl();b&&b(this.E4)})}fbl(){null==this.Bx||this.Bx||this.Qwk()}mMf(a,b){const c=Ga.a.create();Z.ULS.sendTraceTag(7726105,307,50,c.toString());this.Ajh(this.mMb,f=>{Z.ULS.sendTraceTag(7726106,307,50,c.toString());f&&"ping"===f?this.jz=!0:(f?"ping"!==f&&Z.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",
f,chrome.runtime.lastError?chrome.runtime.lastError.message:null):Z.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.K0?this.Job(a,b):(a&&this.Cye(),this.jz=!1));b&&b(this.E4)})}TAg(a,b){const c={};c.OfficeOnlineExtensionInstallationStatus=a;c.OfficeClipboardExtensionInstallationStatus=b;Z.ULS.sendTraceTag(51144839,307,50,JSON.stringify(c))}LVj(){if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.BKa.owa;
this.Ajh(this.XQh,b=>{this.TAg(a,!!b)})}else this.TAg(!1,!1)}}Object(e.a)(sI,"ChromeSystemClipboardAccessManager",null,[1145]);class tI{constructor(a,b,c,f){this.e1=this.jz=this.Hxc=this.Fna=this.K0=null;this.qd=a;this.jb=b;this.CWe=!this.jb.ka("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.jb.ka("BlockCopyCutOnFirefoxIsEnabled");this.vR=c;this.ik=f;this.Twd=b.Ec("ClipboardDataImageBlobLimitaton",10);n.a.YNe||(this.K0=new oC(this.vR))}lba(a){this.CWe&&a&&this.qd.$f?(wq.instance.tpb(null,null),this.jz=
!1):(this.jz=!0,this.e1=!1,this.K0&&(this.e1=this.jz=null,this.Job(!0,null)))}E3a(a){this.CWe&&this.qd.$f&&(this.jz=!1,a(this.E4));this.jz=!0;this.e1=!1;this.K0?(this.e1=this.jz=null,this.Job(!1,a)):a(this.E4)}Job(a,b){Z.ULS.sendTraceTag(512356674,307,50,"CheckAsyncClipboardApiSupport");this.K0.xMf(a,c=>{this.e1=c;this.jz=this.Bx;a&&this.Bal();b&&b(this.E4)})}Bal(){null==this.Bx||this.Bx||this.Pwk()}Pwk(){wq.instance.tpb(null,null)}get E4(){return this.jz}get Bx(){return this.e1}hIc(a){kb.a.$4a(a,
"copy")}a5a(a,b){if(this.Fna&&null!=this.Bx&&this.Bx)return a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.Fna,b=a.body,this.Fna=null,b;const c=Date.now(),f=kb.a.$4a(a,"paste");b&&""===b.innerHTML&&(this.AZi(a),b.innerHTML=this.Hxc?this.Hxc:"",this.Hxc="");Z.ULS.sendTraceTag(512356673,307,50,"ExecutePasteCommand: time taken: {0}, result: {1}",Date.now()-c,f);return b}AZi(a){const b=c=>{if(c){c=c.clipboardData;const f=this.ik.OLc(c);this.Hxc=f&&""!==f?f:this.ik.H_d(c)}};
window.addEventListener("paste",b,!1);kb.a.$4a(a,"paste");window.removeEventListener("paste",b,!1)}prepareForPaste(a,b){const c=(f,l)=>{this.Fna=l;a(!0)};null!=this.Bx&&this.Bx?this.K0.getData(b?"image/png":null,c):a(!1)}wba(a,b,c){if(c){var f=(l,x)=>{const F=new iz;"image/png"==l?F.img=x:F.html=x;c(F)};null!=this.Bx&&this.Bx?this.K0.getData(null,f):n.a.YNe&&this.BZi(a,b,c)}else Z.ULS.sendTraceTag(512356672,307,10,"GetClipboardData: null callback")}BZi(a,b,c){Z.ULS.sendTraceTag(512356643,307,50,"GetClipboardDataViaExecCommand: called");
a=a.contentWindow.document;Ba.a.$t(a.body);try{const f=l=>{const x=new iz;l=l.clipboardData;if(b){var F=null;({o2b:F}=this.ik.Dkd(l,this.Twd,this.vR.Gbc));F&&0<F.length&&(x.isImageAvailable=!0)}else F=this.ik.getData(l,"ppt/slides"),x.pptSlide=F,F&&""!==F||(l=(F=this.ik.OLc(l))&&""!==F?F:this.ik.H_d(l),x.html=l);c(x)};a.addEventListener("paste",f,!1);kb.a.$4a(a,"paste");a.removeEventListener("paste",f,!1)}catch(f){Z.ULS.sendTraceTag(512356642,307,10,"GetClipboardDataViaExecCommand: failed to extract the data using exec command with exception : {0}",
f)}}XIa(a,b,c){if(this.qd.yS&&!this.jb.ka("ElectronClipboardAccessFix"))return this.jz=!1;b();c();a=this.a5a(a.ownerDocument,a);b=a.innerHTML;a.innerHTML=lh.a.create().toString();c();a=this.a5a(a.ownerDocument,a);a=b===a.innerHTML;this.K0?a&&(this.jz=!0):this.jz=a;return a}}Object(e.a)(tI,"DefaultSystemClipboardAccessManager",null,[1145]);class uI{constructor(a,b,c,f){this.e1=this.jz=this.FU=this.Zkb=this.c6=this.Bya=this.xpc=null;this.ik=b;this.vR=c;this.Twd=a.Ec("ClipboardDataImageBlobLimitaton",
10);this.INh=a.ka("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.yKh=f;this.QUh=a.ka("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}lba(a){this.QUh&&a&&(this.jz=!0);this.e1=!1}E3a(a){a(!0)}get E4(){return this.jz}get Bx(){return this.e1}hIc(a){a&&kb.a.$4a(a,qa.a.copy)}a5a(a,b){this.Bya&&(b=this.Bya,this.Bya=null);return b}wba(a,b,c){c?c(null):Z.ULS.sendTraceTag(540553600,307,10,"GetClipboardData null callback")}prepareForPaste(a,b,c=null){if(a&&c){this.xpc=a;this.Zkb=c;$addHandler(this.Zkb,
qa.a.paste,Object(D.a)(this,this.VZg,"onPasteEvent"));this.FU=this.c6=null;this.INh&&this.yKh.AYb();if(this.Lkd(this.Zkb)){if(this.FU&&0<this.FU.length&&(!this.c6||this.ik.$ld(this.c6))){this.vR.WVb(this.FU,Object(D.a)(this,this.ove,"onImageConverted"));this.Bya&&!this.Bya.hasChildNodes()&&Z.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.c6&&this.c6.innerHTML&&((this.Bya=this.qkg(this.c6.innerHTML))&&!this.Bya.hasChildNodes()&&Z.ULS.sendTraceTag(42592152,307,
50,"pastedContentDom has no child nodes."),Ba.a.$t(this.c6))}this.o3f()}else a&&a(!1)}XIa(a){return this.jz=a=this.Lkd(a.ownerDocument)}VZg(a){try{a&&a.rawEvent&&((this.c6=a.rawEvent.target)&&this.c6.id&&-1<this.c6.id.indexOf("Paste")?(Z.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.c6.id),this.c6=null):this.FU=this.v4i(a.rawEvent))}catch(b){Z.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+b.toString())}}ove(a){a&&(this.vR.nkc&&
(a=String.format('<img src="{0}">',a)),this.Bya=this.qkg(a));this.o3f()}o3f(){this.Zkb&&($removeHandler(this.Zkb,qa.a.paste,Object(D.a)(this,this.VZg,"onPasteEvent")),this.Zkb=null);this.xpc&&(this.xpc(!1),this.xpc=null)}v4i(a){let b=null;(a=this.ik.DXd(a))&&({o2b:b}=this.ik.Dkd(a,this.Twd,this.vR.Gbc));return b}Lkd(a){return kb.a.$4a(a,qa.a.paste)}qkg(a){const b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=a;return b.body}}Object(e.a)(uI,"EdgeSystemClipboardAccessManager",null,
[1145]);class vI{constructor(a,b,c,f){this.jb=a;this.BIh=b;this.ik=c;this.qd=f}create(){var a=null;a=this.qd.yS&&this.jb.ka("ElectronClipboardAccessFix"),u.AFrameworkApplication.Wgd()&&this.qd.Hj&&window.chrome&&!a?(Z.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),a=new sI(this.jb,this.BIh,this.ik,hb.a.instance.resolve("Box4.IProcessImageStrategy")),this.jb.ka("LogChromeExtensionInstallationStatusIsEnabled")&&a.LVj()):this.jb.ka("EdgeContextMenuPasteFixIsEnabled")&&this.qd.$n?
(Z.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new uI(this.jb,hb.a.instance.resolve("Box4.IClipboardDataHelper"),hb.a.instance.resolve("Box4.IProcessImageStrategy"),hb.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(Z.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),a=new tI(this.qd,this.jb,hb.a.instance.resolve("Box4.IProcessImageStrategy"),this.ik));return a}}Object(e.a)(vI,"SystemClipboardAccessManagerFactory",
null,[1144]);class wI{f0f(a){return a}}Object(e.a)(wI,"DeleteTableSegmentStrategy",null,[271]);var KP=d(1169),LP=d(624);class xq{constructor(a,b){this.Hk=new E.DictionaryPropertySet;this.yud=!1;this.uga=this.hga=this.n_a=null;this.DU=a;this.FLh=b}get RYa(){return this.uga||(this.uga=hb.a.instance.pb("Box4.ITextFormattingCommands"))}get $g(){return xq.Gf||(xq.Gf=hb.a.instance.resolve("Box4.IFormattingEditor"))}kXa(){this.yud||(this.Hk.lDe(),this.n_a=null,this.QNk())}Jui(a){a=tb.a.Bs(a);if(!a.cache.Fs){var b=
a.sz;if(b){var c=new E.DictionaryPropertySet;c.vx(b);c.vx(this.Hk);c.Sa(kh.a.D1)&&(this.n_a=a.paragraph.Ch);this.Hk=c}}}Sa(a){return this.Hk.Sa(a)}E3d(){return 0<this.Hk.O0}get R7a(){return this.Hk}freeze(){this.yud=!0}BPe(){this.yud=!1}WH(a,b){return this.R7a.sa(a,b)}yr(a){this.Hk.setValue(bb.a.fontSize,this.$g.LVb(a));this.NQ()}fontSize(){return this.Hk.sa(bb.a.fontSize,fd.Font.MH)}rfd(a){this.Hk.setValue(bb.a.font,a);this.FLh.rfd(this.Hk,a);this.DU&&this.DU.enabled&&(Oe.c(40506690,306,50,"InsertionPointFomatting: Set font slot values"),
this.DU.SDl(this.Hk,a));this.NQ()}mIa(a){this.Hk.setValue(Bb.a.iU,a);this.DU&&this.DU.enabled&&(Oe.c(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.DU.WDl(this.Hk,a));this.NQ()}Ss(a){a=LP.a.instance.JMd(ld.a.instance.Oa.kb.Ua.node,a);this.Hk.setValue(bb.a.fontColor,a);this.NQ()}eV(){this.Hk.setValue(bb.a.fontColor,Eb.a.auto);this.NQ()}fontColor(){return this.Hk.sa(bb.a.fontColor,Eb.a.nil)}Ema(a){this.Hk.setValue(bb.a.highlight,parseInt(a,16));this.NQ()}aVb(){this.Hk.setValue(bb.a.highlight,
Eb.a.auto);this.NQ()}isBold(){return this.Hk.sa(bb.a.bold,!1)}hJ(a){this.Hk.setValue(bb.a.bold,a);this.NQ()}isItalic(){return this.Hk.sa(bb.a.italic,!1)}setItalic(a){this.Hk.setValue(bb.a.italic,a);this.NQ()}pD(){return this.Hk.sa(bb.a.underline,!1)}e0(a){this.Hk.setValue(bb.a.underline,a);this.Hk.setValue(bb.a.qw,a?fd.Font.bld:fd.Font.mU);this.NQ()}qw(){return this.Hk.sa(bb.a.qw,fd.Font.mU)}Ima(a){a<fd.Font.bld||a>fd.Font.mU||(this.Hk.setValue(bb.a.underline,a!==fd.Font.mU),this.Hk.setValue(bb.a.qw,
a),this.NQ())}isSuperscript(){return this.Hk.sa(bb.a.superscript,!1)}GX(a){this.Hk.setValue(bb.a.superscript,a);a&&this.isSuperscript()&&this.Hk.setValue(bb.a.subscript,!1);this.NQ()}cF(){return this.Hk.sa(bb.a.subscript,!1)}L4(a){this.Hk.setValue(bb.a.subscript,a);a&&this.cF()&&this.Hk.setValue(bb.a.superscript,!1);this.NQ()}bF(){return this.Hk.sa(bb.a.strikethrough,!1)}EX(a){this.Hk.setValue(bb.a.strikethrough,a);this.NQ()}vZ(){return this.Hk.sa(kh.a.ys,!1)}tfb(a){this.Hk.setValue(kh.a.ys,a);this.NQ()}q7f(){return this.Hk.sa(kh.a.D1,
null)}vea(a,b){this.Hk.lDe();this.Hk.setValue(kh.a.D1,a.id);this.n_a=b.Ch;this.NQ()}UT(a){let b=bb.a.Gs;if(H.a.instance.ga(13)){const c=KP.a.C5b(a);switch(c){case 1:b=Bb.a.Pvb;break;case 2:b=Bb.a.Qvb}this.Hk.setValue(Bb.a.languageHint,c)}this.Hk.setValue(b,a);this.NQ()}language(){let a=bb.a.Gs;if(H.a.instance.ga(13))switch(this.Hk.sa(Bb.a.languageHint,0)){case 1:a=Bb.a.Pvb;break;case 2:a=Bb.a.Qvb}return this.Hk.sa(a,0)}t3k(a){this.Hk.setValue(xq.cte,a);this.NQ()}URa(){return this.Hk.sa(xq.cte,!1)}iJj(){return this.Hk.Sa(xq.cte)}ZHj(){return H.a.instance.ga(13)?
this.Hk.Sa(bb.a.Gs)||this.Hk.Sa(Bb.a.Pvb)||this.Hk.Sa(Bb.a.Qvb):this.Hk.Sa(bb.a.Gs)}NQ(){if(n.a.QHb){var a=ld.a.instance.Oa.kb.Ua,b=a.node;if(b===this.hga)this.hga.Vu(16,!0);else{this.hga=b;b=this.hga.LYa();try{this.hga.xqb(a.Qa).P2=!0}finally{b&&b.dispose()}}}}QNk(){if(n.a.QHb&&this.hga){var a=0,b=this.hga.LYa();try{for(let c=this.hga.Ra.length-1;0<=c;c--){const f=this.hga.Ra.ga(c);f.P2&&(f.P2=!1,a++,f.isEmpty&&this.hga.Ra.removeAt(c))}}finally{b&&b.dispose()}this.hga=null}}qti(a){if(a.Qa!==a.Kb)return!1;
a=a.node.Ra.jS(a.Qa);return!!a&&a.P2}e9h(a){if(this.RYa){this.freeze();var b=new We.GraphTransaction(7);b.fd(a.node);this.RYa.ZFb(a);this.BPe();this.kXa();b.dispose()}}h0b(a){const b=Ya.ParagraphReader.text(a.node);return a.Qa&&a.Qa!==b.length&&!Ma.a.yy(b.charCodeAt(a.Qa))&&Wr.a.instance.HLc(b,a.Qa-1)!==a.Qa&&fb.SelectionEditor.pvb(a)?(a=fb.SelectionEditor.bPa(a,!1))?1<a.length||fb.SelectionEditor.Pj(a.Ua)?a:null:null:null}static get cte(){return H.a.instance.ga(20)?Bb.a.noProof:be.a.Lua}}xq.Gf=null;
Object(e.a)(xq,"InsertionPointFormatting",null,[259]);class xI{constructor(a){this.Ca=a}get Ym(){return this.Ca}ifi(a){return 32===this.Ym.Ka(C.a.tO,2,a)}numbering(a){return 32===this.Ym.Ka(C.a.XQ,2,a)}}Object(e.a)(xI,"ListCommands",null,[1157]);class pC{constructor(a){this.$e=a}C3a(a){a=Object(va.a)(eC.a,a);return!!a&&!!a.view&&a.view.Hh}Y6g(){return!0}Uze(){return!0}Z6g(){}Zrh(a){if(a.Oq)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}m$i(a){if(!a||!this.$e)return a;const b=new En.a;
b.set(a);if(this.$e.Vs(b)){for(;!b.Oq;)b.uc();return b.currentNode}return a}}Object(e.a)(pC,"SimpleProofingWholeDocumentCallBacks",null,[1199]);class yI{constructor(a){this.value=a}}Object(e.a)(yI,"RefBool",null,[]);class jz{constructor(){this.bIc=this.DBb=null;this.Czh=new yI(!1)}}Object(e.a)(jz,"FindNextErrorOperationParam",null,[]);class zI extends pC{constructor(a,b){super(b);this.lm=a}Y6g(a,b){return!this.Wbe(a.node,a.Qa,b)}Uze(a,b){return!this.Wbe(a,0,b)}Z6g(a,b){this.Wbe(a.node,0,b);Object(va.a)(jz,
b)}Wbe(a,b,c){c=Object(va.a)(jz,c);if(Ya.ParagraphReader.Wd(a)&&!a.IV)if(tb.a.Bs(Pc.a.Uj(a,b)).cache.URa)c.Czh.value=!0;else{const f=u.AFrameworkApplication.fa.ka("SkipIgnoredProofingErrorsFromRibbon"),l=this.lm.RE(a);for(let x=0;x<l.length;x++){const F=l[x],R=f&&F.Dh.W8d();if(F.begin>=b&&!R)return c.DBb=F,c.bIc=a,!0}}return!1}}Object(e.a)(zI,"FindNextErrorCallbackSteps",pC,[]);class AI extends Bs.a{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){super();this.flb=this.Gi=this.Pxa=null;this.init(a);this.xl(Xa);
this.wCa(R,b,f,l,x);this.oU=x;this.Bu=c;this.Pc=fa;this.$e=wa;this.voa=F;this.zH=0}run(){this.C3a();0===this.zH&&this.MJe();1===this.zH&&this.dAe();2===this.zH&&this.ROe();3===this.zH&&this.tVd()}C3a(){this.Pc.Oa&&this.Pc.Oa.kb?1===this.behavior&&(this.voa.C3a(this.Bu)?this.fp=32:this.fp=2,this.zH=3):(Z.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.fp=2,this.zH=3)}MJe(){this.yei();this.Wdi();this.zH=1}dAe(){this.oz||new wc.a(this,Object(D.a)(this,this.HAk,"processCurrentNodeAtBegin"),
this.oU);do if(this.oz.run(),this.oz.inProgress&&!this.Vi)return;while(this.oz.inProgress);this.RCc();this.zH=2}ROe(){this.fp=32;this.zH=3}tVd(){this.BX()}HAk(a,b){b=this.voa.Y6g(this.Pxa,b);a.Wg(Object(D.a)(this,this.UUi,"fromHereToEnd"));return b}UUi(a,b){if(this.Gi.moveNext())return a=this.Gi.currentNode,12!==a.type||a===this.Pxa.node?!0:this.voa.Uze(a,b);this.Oei();a.Wg(Object(D.a)(this,this.dVi,"fromStartToHere"));return!0}dVi(a,b){if(this.Gi.moveNext()){const c=this.Gi.currentNode;return 12!==
c.type?!0:c===this.Pxa.node?(a.Wg(Object(D.a)(this,this.IAk,"processCurrentNodeAtEnd")),!0):this.voa.Uze(c,b)}return!1}IAk(a,b){this.voa.Z6g(this.Pxa,b);return!1}yei(){let a=this.Pc.Oa.kb;if(a=this.$e.yl(a,!0,!1))this.Pxa=a.Ua;this.Pxa&&this.Pxa.node&&(this.flb=this.voa.m$i(this.Pxa.node))}Wdi(){if(!this.flb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new En.a;a.set(this.Pxa.node);a.mc(this.flb.type);this.Gi=ox.a.O1(a,this.flb);this.Gi.Jl(Object(D.a)(this.voa,this.voa.Zrh,"spellErrorFilter"),
null)}Oei(){if(!this.flb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new En.a;a.set(this.flb);this.Gi=ox.a.Ju(a);this.Gi.Jl(Object(D.a)(this.voa,this.voa.Zrh,"spellErrorFilter"),null)}}Object(e.a)(AI,"ProofingWholeDocumentOperation",Bs.a,[]);class qC{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){this.Ca=b;this.lm=a;this.bPh=c;this.Vg=f;this.jk=l;this.Pc=x;this.nm=F;this.$e=R;this.D1a=fa;this.LC=wa;this.hd=Xa;this.Vsc=Lb.e$d;this.lqf=kc;this.AO=lc;this.uoc=new Xb.a;this.uoc.$(1,
C.a.$rh);this.uoc.$(2,C.a.jgg);this.uoc.$(3,C.a.mth);this.Uvc=new Xb.a;this.Uvc.$(1,C.a.ash);this.Uvc.$(2,C.a.kgg);this.Uvc.$(3,C.a.nth)}ub(){const a=this.Ca,b=Object(D.a)(this,this.Uui,"correctError"),c=Object(D.a)(this,this.Boi,"collapseIp");a.pa(C.a.sqk,Fb.a.view,Object(D.a)(this,this.tqk,"openLanguageDialogView"),1028);a.xa(C.a.uOa,Fb.a.Lf,Object(D.a)(this,this.uOa,"deleteRepeatedWord"));a.xa(C.a.Kra,Fb.a.Lf,Object(D.a)(this,this.Kra,"ignoreSpellingError"));a.xa(C.a.Rwa,Fb.a.Lf,b);a.xa(C.a.Swa,
Fb.a.Lf,b);a.xa(C.a.Twa,Fb.a.Lf,b);a.xa(C.a.SIa,Fb.a.Lf,b);a.xa(C.a.TIa,Fb.a.Lf,b);a.xa(C.a.uOa,Fb.a.view,c);a.xa(C.a.Kra,Fb.a.view,c);a.xa(C.a.Rwa,Fb.a.view,c);a.xa(C.a.Swa,Fb.a.view,c);a.xa(C.a.Twa,Fb.a.view,c);a.xa(C.a.SIa,Fb.a.view,c);a.xa(C.a.TIa,Fb.a.view,c);a.$d(C.a.uOa,1028);a.$d(C.a.Kra,1028);a.$d(C.a.Rwa,1028);a.$d(C.a.Swa,1028);a.$d(C.a.Twa,1028);a.$d(C.a.SIa,1028);a.$d(C.a.TIa,1028);a.xa(C.a.gjd,de.a.frame,ce.ActionManager.Fg);this.Vsc&&a.pa(C.a.Aye,Fb.a.view,Object(D.a)(this,this.Aye,
"populateProofingSecondaryMenu"),1124);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||a.pa(C.a.R5c,Fb.a.view,Object(D.a)(this,this.qRi,"findNextProofingError"),1028);this.BLk([C.a.Efl,C.a.$rh,C.a.ash,C.a.Kij,C.a.jgg,C.a.kgg,C.a.Mhl,C.a.mth,C.a.nth])}BLk(a){for(let b=0;b<a.length;b++)this.Ca.pa(a[b],Fb.a.view,ce.ActionManager.Mu,1028)}Boi(a,b,c,f,l){b=this.Pc.Oa.kb;if(!b)return this.hd.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),
2;b=this.$e.yl(b,!0,!1);return this.Ca.ii(b.Ua,a,c,!1,f,l)}tqk(a,b,c){if(1===c)return this.Ca.processAction(C.a.UT,1);this.bPh().zkc();return 32}mRe(a){return a?a.Dh?!1:(Z.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.hd.Tb(Ed.a.m5a,{["Reason"]:"ErrorRangeMissingErrorDetails"}),N.a.mark(4671),!0):(Z.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.hd.Tb(Ed.a.m5a,{["Reason"]:"RequestedErrorRangeNotFound"}),N.a.mark(4671),
!0)}uOa(a,b,c){if(1===c)return 32;N.a.mark(4670);c=this.lm.TPa(b);if(this.mRe(c))return 8;b=b.node;const f=this.jk.je(15);let l=c.begin;" "===Ya.ParagraphReader.text(b).charAt(l-1)&&l--;f.fd(b);const x=this.Vg.replaceTextRange(Pc.a.createTextRange(b,0<c.begin?c.begin-1:0,c.end),"",!0,!1);this.Pc.setSelection(nd.SelectionFactory.Jg(b,x+l));f.dispose();c.Dh.kJa(a);N.a.mark(4671);return 32}mXj(a){let b;({value:b}=this.Uvc.Of(a.Dh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}Kra(a,b,c){if(1===
c)return 32;Z.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");N.a.mark(4670);c=this.lm.TPa(b);if(this.mRe(c))return 8;b=b.node;const f=this.jk.je(15);f.fd(b);this.lm.wHa(b,[c],!0);b.setValue(bb.a.PPf,!0);f.dispose();c.Dh.kJa(a,1);N.a.mark(4671);Z.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.mXj(c);return 32}Y_i(a){switch(a){case C.a.Rwa:return 0;case C.a.Swa:return 1;case C.a.Twa:return 2;case C.a.SIa:return 3;case C.a.TIa:return 4;default:return-1}}JUj(a){let b;
({value:b}=this.uoc.Of(a.Dh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}Uui(a,b,c){var f=!0;this.AO.ga(14)&&(f=!this.LC.gsa(b));this.nm&&this.nm.instance&&this.nm.instance.LV(b)&&(f=!1);if(1===c||!f)return f?32:8;this.Ca.processAction(C.a.gjd,2);N.a.mark(4670);f=this.Y_i(a);if(0>f)return 8;c=this.lm.TPa(b);if(this.mRe(c))return 8;b=b.node;var l=c.Dh.suggestions;if(!l)return this.hd.Tb(Ed.a.m5a,{["Reason"]:"NoSuggestionsFound"}),N.a.mark(4671),8;f=f<l.length?l[f]:null;if(!f)return this.hd.Tb(Ed.a.m5a,
{["Reason"]:"RequestedSuggestionIsNull"}),N.a.mark(4671),8;this.AO.ga(50)&&Gb.App.Eh.Qv&&Gb.App.Eh.UX.epa(b);f=f.replace("  "," \u00a0");l=this.jk.je(15);l.fd(b);const x=this.Vg.replaceTextRange(Pc.a.createTextRange(b,c.begin,c.end),f,!0,!1,C.a.gjd);this.Pc.setSelection(nd.SelectionFactory.Jg(b,c.begin+f.length+x));l.dispose();c.Dh.kJa(a);N.a.mark(4671);this.JUj(c);return 32}rYk(a,b,c,f){a.$va();(a=c.oc(a.Ma))?(f=P.a.qt(a,u.AFrameworkApplication.isRtl?f.begin:f.end),this.D1a.b$(new Sys.UI.Point(f.x,
f.y+f.height),b)):Z.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}qRi(a,b,c,f,l){if(!b.view.Hh)return 2;const x=b.view;if(!this.Pc.Oa.kb)return this.hd.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),2;if(1===c)return 32;const F=new jz,R=new zI(this.lm,this.$e);b=new AI(null,a,b,c,f,F,R,this.Ca,this.Pc,this.$e,null);b.Vi=!0;b.run();if(b.isCompleted&&F.DBb){if(b=nd.SelectionFactory.Jg(F.bIc,F.DBb.begin),b=nd.SelectionFactory.PM(b,Pc.a.Uj(F.bIc,F.DBb.end)),!this.lqf.instance||
!this.lqf.instance.rDl(F.DBb,b,x)){this.Pc.setSelection(b);let fa=0;l&&(fa=l.Uu);x.Mgd=!1;Nm.a.instance.Gb(new He.a(1,1,1,()=>{this.rYk(x,fa,F.bIc,F.DBb)}))}}else{const fa=new rj.StandardDialog;fa.vd=0;Gb.App.WQ.V$d?fa.jgb(CommonUIStrings.l_DefaultDialogTitle,F.Czh.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(fa.jgb(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Gb.App.WQ.L0h(()=>
{fa.VP&&(fa.hide(),this.Ca.processAction(a,2))}))}return 32}Aye(){return 32}}Object(e.a)(qC,"ProofingActor",null,[]);var BI=d(702),MP=d(1057);class Ug{static bij(){Ug.QL||(Ug.QL=Array(Ug.Qhl),Ug.QL[0]=bb.a.fontColor,Ug.QL[1]=kh.a.OQ,Ug.QL[2]=bb.a.Gs,Ug.QL[3]=bb.a.underline,Ug.QL[4]=bb.a.qw,Ug.QL[5]=kh.a.ys,Ug.QL[6]=bb.a.font,Ug.QL[7]=bb.a.fontSize,Ug.QL[8]=bb.a.superscript,Ug.QL[9]=bb.a.subscript,Ug.QL[10]=bb.a.En,Ug.QL[11]=Bb.a.noProof,Ug.QL[12]=be.a.Lua,Ug.QL[13]=kh.a.capitalization,Ug.QL[14]=bb.a.bold,
Ug.QL[15]=bb.a.italic,Ug.QL[16]=bb.a.underline);return Ug.QL}static $hj(){Ug.kC||(Ug.kC=Array(Ug.dsk),Ug.kC[0]=Bb.a.Mn,Ug.kC[1]=Bb.a.NGa,Ug.kC[2]=Bb.a.Il,Ug.kC[3]=Bb.a.nva,Ug.kC[4]=Bb.a.kX,Ug.kC[5]=Bb.a.edb,Ug.kC[6]=Bb.a.JCb,Ug.kC[7]=Bb.a.ddb,Ug.kC[8]=kh.a.TCb,Ug.kC[9]=kh.a.SCb,Ug.kC[10]=Bb.a.PCb,Ug.kC[11]=Bb.a.MCb,Ug.kC[12]=Bb.a.ASa,Ug.kC[13]=Bb.a.Nw,Ug.kC[14]=Bb.a.hdb,Ug.kC[15]=Bb.a.gdb,Ug.kC[16]=Bb.a.hec,Ug.kC[17]=Bb.a.gec,Ug.kC[18]=bb.a.pl,Ug.kC[19]=bb.a.rI,Ug.kC[20]=kh.a.Jbd,Ug.kC[21]=bb.a.iX);
return Ug.kC}}Ug.Qhl=17;Ug.dsk=22;Ug.QL=null;Ug.kC=null;Object(e.a)(Ug,"StyleConstants",null,[]);class br{static get YBk(){return br.DO||(br.DO=new MP.a)}static z$d(a,b){if(!a||!a.node||!b)return!1;const c=tb.a.Bs(a);if(br.stg(c?c.sz:null,b,Ug.bij()))return Z.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;a=a.node.i7();return br.stg(a,b,Ug.$hj())?(Z.ULS.sendTraceTag(51218399,324,50,"Difference in paragraph attributes b/w text selection and style"),
!0):!1}static stg(a,b,c){let f=!1;if(a)for(const l of c)f=(a.Sa(l)?b.Sa(l)?!br.YBk.compare(a,b,l):!0:!1)||f;return f}}br.DO=null;Object(e.a)(br,"StyleUtils",null,[]);class rC{constructor(a,b,c,f,l,x,F,R,fa,wa){this.s0a=this.IHb=null;this.Vg=a;this.QJ=b;this.RJ=c;this.Gf=f;this.ufa=l;this.$s=x;this.LC=F;this.hd=R;this.uMa=fa;this.WXh=wa}get characterPropertiesEditor(){return this.Vg}get qO(){return this.QJ}get W4(){return this.RJ}get Pl(){return this.ufa}get insertionPointFormatting(){return this.$s}get $g(){return this.Gf}get Wi(){return this.LC}get Tc(){return this.hd}get nPe(){return this.uMa}get Qnc(){return this.WXh}get FRa(){null==
this.s0a&&(u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.s0a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.s0a}ub(){const a=u.AFrameworkApplication.Ta,b=Gb.App.aJa.JEc(12);H.a.instance.ga(61)&&(a.xa(C.a.X2a,Fb.a.textRange,Object(D.a)(this,this.z9h,"applyStyleToTextRange")),a.xa(C.a.Ngc,Fb.a.textRange,Object(D.a)(this,this.rDk,"queryStyleTextRange")),
a.xa(C.a.X2a,Fb.a.Lf,Object(D.a)(this,this.x9h,"applyStyleToIp")),a.xa(C.a.Ngc,Fb.a.Lf,Object(D.a)(this,this.pDk,"queryStyleIp")));a.xa(C.a.X2a,Fb.a.paragraph,Object(D.a)(this,this.y9h,"applyStyleToParagraph"));a.xa(C.a.X2a,Fb.a.view,Object(D.a)(this,this.A9h,"applyStyleView"));a.$d(C.a.X2a,1036);a.xa(C.a.Ngc,Fb.a.view,Object(D.a)(this,this.sDk,"queryStyleView"));a.xa(C.a.Ngc,Fb.a.paragraph,Object(D.a)(this,this.qDk,"queryStyleParagraph"));a.$d(C.a.Ngc,99|(H.a.instance.ga(7)?0:4));a.xa(C.a.Sec,Fb.a.view,
b);a.xa(C.a.Sec,Fb.a.paragraph,Object(D.a)(this,this.Sec,"populateMenuMoreStyles"));a.$d(C.a.Sec,1127);a.pa(C.a.ZHd,Fb.a.view,Object(D.a)(this,this.wpa,"applyStyleShortcut"),4);a.pa(C.a.$Hd,Fb.a.view,Object(D.a)(this,this.wpa,"applyStyleShortcut"),4);a.pa(C.a.aId,Fb.a.view,Object(D.a)(this,this.wpa,"applyStyleShortcut"),4);a.pa(C.a.bId,Fb.a.view,Object(D.a)(this,this.wpa,"applyStyleShortcut"),4);a.pa(C.a.dId,Fb.a.view,Object(D.a)(this,this.wpa,"applyStyleShortcut"),4);a.pa(C.a.eId,Fb.a.view,Object(D.a)(this,
this.wpa,"applyStyleShortcut"),4);a.pa(C.a.fId,Fb.a.view,Object(D.a)(this,this.wpa,"applyStyleShortcut"),4);a.pa(C.a.OFf,Fb.a.view,Object(D.a)(this,this.wpa,"applyStyleShortcut"),4);a.pa(C.a.PFf,Fb.a.view,Object(D.a)(this,this.wpa,"applyStyleShortcut"),4);a.pa(C.a.QFf,Fb.a.view,Object(D.a)(this,this.wpa,"applyStyleShortcut"),4);this.IHb=Array(10);this.W4.eJe(this.IHb)}Udj(a){switch(a){case C.a.ZHd:return 0;case C.a.$Hd:return 1;case C.a.aId:return 2;case C.a.bId:return 3;case C.a.dId:return 4;case C.a.eId:return 5;
case C.a.fId:return 6;case C.a.OFf:return 7;case C.a.PFf:return 8;case C.a.QFf:return 9;default:return-1}}wpa(a,b,c,f){a=this.Udj(a);return 0>a||a>this.IHb.length?2:(a=this.IHb[a])?u.AFrameworkApplication.Ta.ii(b,C.a.X2a,c,!0,f,a):2}Sec(a,b,c,f,l){a=!0;b.contextId!==Fb.a.paragraph&&b.contextId!==Fb.a.textRange&&b.contextId!==Fb.a.Lf&&(a=!1);if(1===c||!a)return a?32:8;if(2===c&&!l)return 8;b=this.W4.tK(b.node);c=H.a.instance.ga(61);u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp&&(l.MenuItems=
BI.StylePreviewGenerator.Fag(b,c));l.PopulationXML=BI.StylePreviewGenerator.jWi(b,c);return 32}qDk(a,b,c,f,l){a=!0;b.contextId!==Fb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;a=this.W4.kD(c);if(!a||!l)return Z.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",l,c,a),8;l.KNe.vx(a);this.FRa&&(l.T8d=br.z$d(b,a));return 32}y9h(a,b,c,f,l){if(b.contextId!==Fb.a.paragraph)return 8;if(H.a.instance.ga(14)&&this.Wi.kDa(b))return this.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),
8;if(1===c)return 32;a=b.node;if(!l)return 8;b=this.$0d(l,a);if(!b)return this.Tc.Tb(Ed.a.v0,{["Reason"]:Bd.a.UYb}),8;if(2!==this.W4.yra(b))return 2;c=new We.GraphTransaction(15);c.fd(a);this.insertionPointFormatting.kXa();this.qO.Y9(b,a,!1);c.dispose();l=Ma.a.zM(l);f.pP=l>>>16^l&65535;return 32}rDk(a,b,c,f,l){a=!0;b.contextId!==Fb.a.textRange&&(a=!1);if(1===c&&!a)return 2;c=b.node;a=tb.a.Bs(b);a=tb.a.Erb(a);if(this.FRa){if(!l||!c)return Z.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",
l,c),8;a=a||this.W4.kD(c);if(!a)return Z.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;l.T8d=br.z$d(b,a)}else{if(!a)return 2;if(!l)return 8}l.KNe.vx(a);return 32}z9h(a,b,c,f,l){if(b.contextId!==Fb.a.textRange||!H.a.instance.ga(61))return 8;if(this.Wi.kDa(b))return this.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),8;if(1===c)return 32;a=b.node;if(!l)return 8;const x=this.$0d(l,b.node);if(!x)return this.Tc.Tb(Ed.a.v0,{["Reason"]:Bd.a.UYb}),8;if(1!==this.W4.yra(x))return 2;
c=this.W4.tK(a);if(!c)return this.Tc.Tb(Ed.a.v0,{["Reason"]:Bd.a.M1f}),8;if(!c.oG(this.W4.BP(x)))return this.Tc.Tb(Ed.a.v0,{["Reason"]:Bd.a.UYb}),8;const F=new We.GraphTransaction(7);try{F.fd(a),this.qO.nnc(a,c),this.nPe.BAc(b,R=>{this.$g.Wza(R);this.$g.vea(R,x)})}finally{F&&F.dispose()}b=Ma.a.zM(l);f.pP=b>>>16^b&65535;return 32}pDk(a,b,c,f,l){a=!0;b.contextId!==Fb.a.Lf&&(a=!1);if(1===c&&!a)return 2;c=this.qO.X0d(b);a=b.node;if(this.FRa){if(!l||!a)return Z.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",
l,a),8;c=c||this.W4.kD(a);if(!c)return Z.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;l.T8d=br.z$d(b,c)}else{if(!c)return 2;if(!l)return 8}l.KNe.vx(c);return 32}x9h(a,b,c,f,l){if(b.contextId!==Fb.a.Lf||!H.a.instance.ga(61))return 8;if(this.Wi.kDa(b))return this.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),8;if(1===c)return 32;c=b.node;if(!l)return 8;const x=this.$0d(l,b.node);if(!x)return this.Tc.Tb(Ed.a.v0,{["Reason"]:Bd.a.UYb}),8;const F=this.W4.yra(x);if(1!==F&&2!==
F)return 2;(b=this.insertionPointFormatting.h0b(b))?(c=ld.a.YNa(b),a=u.AFrameworkApplication.Ta.ii(c,a,2,!1,f,l)):(a=new We.GraphTransaction(7),a.fd(c),this.qO.fJe(x,c),a.dispose(),a=32);l=Ma.a.zM(l);f.pP=l>>>16^l&65535;return a}sDk(a,b,c,f,l){if(H.a.instance.ga(61)){const x=this.Qnc.r4(a,b,c,f,l,null,0);if(2!==x)return x}return this.Qnc.r4(a,b,c,f,l,null,12)}A9h(a,b,c,f,l){const x={};x[this.Qnc.nna]=6168;x[this.Qnc.mna]=6169;let F=12;if(H.a.instance.ga(61)){if(!b.view.Hh)return 2;var R=b.view.Eb,
fa=R?R.Dj:null;if(!fa)return this.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),8;if(H.a.instance.ga(11)&&this.Pl.Xpa(W.ImageReader.gub,fa))return this.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.OVb}),8;if(H.a.instance.ga(14)&&this.Wi.sRc(fa))return this.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.cD}),8;fa=this.W4.Ksb();if(l&&fa){var wa=fa.oG(l);wa&&(fa=this.W4.CZd(wa,fa),wa=this.W4.yra(wa),fa&&(R=R.Oa.ga(0),R.Paa&&R.Ua.contextId===Fb.a.textRange||2===R.length&&R.Ua.contextId===Fb.a.textRange&&R.Te.contextId===Fb.a.endOfParagraph)&&
(wa=1,l=fa.getValue(kh.a.UCb)),1===wa?F=0:3===wa&&(F=14))}}return this.Qnc.r4(a,b,c,f,l,x,F)}$0d(a,b){if(a&&b&&Ya.ParagraphReader.Wd(b))b=this.W4.tK(b);else return null;return b.oG(a)}}Object(e.a)(rC,"StyleActor",null,[]);const CI=a=>a.contextId===Fb.a.HVd;class pg{static get Pl(){return Rg.ContextSetEditor.instance}static get Wi(){return Qg.a.instance}static get Tc(){return Sa.a.instance}static get pe(){return pg.Xc||(pg.Xc=hb.a.instance.resolve("Box4.IFeatureHelper"))}static Mq(){return pg.nm||
(pg.nm=hb.a.instance.La("Box4.IExternalSelectionManager"))}static get xL(){return pg.TF||(pg.TF=hb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static p4b(a){return u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===C.a.eHa||a===C.a.qXa||a===C.a.u4||a===C.a.LHa)}static w6(a,b,c,f,l){var x=!0;if(!b.view.Hh)return 2;var F=b.view,R=F.Eb;R&&R.Oa.kb||(pg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),x=!1);if(H.a.instance.ga(11)&&(pg.Pl.Xpa(W.ImageReader.L3b,F.Eb.Dj)&&(pg.Tc.Tb(Ed.a.ph,
{["Reason"]:Bd.a.zNd}),x=!1),pg.Pl.Xpa(W.ImageReader.gub,F.Eb.Dj)))return pg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.OVb}),8;H.a.instance.ga(14)&&pg.Wi.sRc(F.Eb.Dj)&&(pg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.cD}),x=!1);pg.Pl.Xpa(W.ImageReader.F8d,F.Eb.Dj)&&(pg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.KPf}),x=!1);pg.Pl.Xpa(Rt.c,F.Eb.Dj)&&(pg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.LPf}),x=!1);pg.Pl.Xpa(CI,F.Eb.Dj)&&(pg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.JPf}),x=!1);pg.Mq()&&pg.Mq().instance&&pg.Mq().instance.LV(F.Eb.Dj)&&(pg.Tc.Tb(Ed.a.ph,
{["Reason"]:Bd.a.externalSelection}),x=!1);a!==C.a.c0||H.a.instance.ga(54)||H.a.instance.ga(84)||(x=!1);var fa=null;R&&R.Oa.kb&&(fa=R.Oa.kb);a===C.a.vfl&&fa&&fa.Paa&&Ya.ParagraphReader.MV(fa.Ua.node)&&!Ib.ListReader.Lw&&(x=!1);if(1===c||!x||!fa)return x?32:8;x=a===C.a.jja||a===C.a.eha||a===C.a.sma||a===C.a.uBa;F=a===C.a.GBk||a===C.a.sEi||a===C.a.Tbh;const wa=a===C.a.Jfb||a===C.a.Kfb||a===C.a.c0,Xa=new We.GraphTransaction(15);Xa.fd(fa.Ua.node);fa=new Ha.a;let lb=!1;if(x||F||wa)N.a.mark(7121),b=pg.Pl.AVi(b.MD);
else{N.a.mark(7119);b=li.Xqa(R.Oa,!0);if(!b)return pg.Tc.Tb(Ed.a.Mha,{["Reason"]:Bd.a.CIc}),Xa.dispose(),8;R=a===C.a.evj||a===C.a.fvj;b.Hw&&R&&(lb=pg.Mqj(fa,b))}b.Hw&&1<b.length&&pg.Nqj(b)&&(l||(l={}),l.InContextSet=!0);u.AFrameworkApplication.Ta.ii(b,a,c,!0,f,l);lb&&pg.efk(fa,b,l);Xa.dispose();Gb.App.Fb.updateCommandUI();x||F||wa?N.a.mark(7122):N.a.mark(7120);return 32}static Mqj(a,b){if(!b.Hw)return!1;let c=!1,f=!1;for(let x=0;x<b.length;x++)if(b.getContext(x).Kk){var l=b.getContext(x).node;if(l)if(l=
pg.xL.dsb(l),2===l.specialIndentType)c=!0,a.add(x);else if(1===l.specialIndentType||0===l.specialIndentType)f=!0}return f&&c}static efk(a,b,c){if(b.Hw)for(let l=0;l<a.count;l++){var f=b.getContext(a.ga(l));if(!f.Kk)continue;f=f.node;const x=pg.xL.dsb(f);2!==x.specialIndentType||Md.a.ty(c.value,x.aN)||f.setValue(Bb.a.Il,x.aN-x.tHb)}}static W8k(a,b){let c=!0;b.contextId!==Fb.a.paragraph?c=!1:H.a.instance.ga(14)&&pg.Wi.kDa(b)?(pg.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),c=!1):pg.Mq()&&pg.Mq().instance&&pg.Mq().instance.LV(b)&&
(pg.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.externalSelection}),c=!1);return{returnValue:1!==a&&c,CE:c?32:8}}static joh(a,b){let c=!0;b.contextId!==Fb.a.image&&b.contextId!==Fb.a.embeddedFile&&(c=!1);H.a.instance.ga(11)&&(c=!1);return{returnValue:1!==a&&c,CE:c?32:8}}static Nqj(a){if(!a.Hw)return!1;let b=1;for(let f=0;f<a.length;f++)if(a.getContext(f).Kk){var c=a.getContext(f).node;if(c)if(c=Ya.ParagraphReader.UM(c),!f)b=c;else if(c!==b)return!0}return!1}}pg.Xc=null;pg.nm=null;pg.TF=null;Object(e.a)(pg,"FormattingActionHelper",
null,[]);class Es extends Bs.a{constructor(a,b,c,f,l,x,F,R){super();this.vtf=this.mB=null;this.init(a);this.xl("FormattingViewOperation");this.wCa(u.AFrameworkApplication.Ta,b,f,l,x);this.Bu=c;this.NJa=0;this.Dp=!0;this.yLh=F;this.nm=R}get Fqa(){return this.nm.instance}run(){const a=this.Bu.view;var b=null;a.Hh&&(b=a.Eb);if(b){var c=b.Oa.kb;!c||H.a.instance.ga(14)&&Es.Wi.E$d(c)?(Es.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.cD}),this.Dp=!1):this.Fqa&&this.Fqa.wub(c)&&(Es.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.externalSelection}),
this.Dp=!1)}else Es.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ola}),this.Dp=!1;1!==this.behavior&&this.Dp||(this.Dp&&(c=b.Oa.kb,1===b.Oa.length&&1===c.length&&fb.SelectionEditor.Pj(c.Ua)&&fg.b(c.Ua)&&(Es.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.$Dc}),this.Dp=!1)),(c=this.Dp)&&this.actionId===C.a.UT&&((c=cb.AT(b.Oa.kb,tb.a.MPf))||Es.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ZRd})),this.fp=c?32:8,this.NJa=3);0===this.NJa&&(N.a.mark(5730),this.vtf=um.SelectionReferenceFactory.instance.dqa(),c=b.Oa.kb.Ua,this.mB=new We.GraphTransaction(15),
this.mB.fd(c.node),this.NJa=1);if(1===this.NJa){this.oz||this.sfb(this.Bu.MD);if(1===this.Rla())return;this.NJa=2}if(2===this.NJa){if(this.actionId===C.a.UT)if(b=b.Dj,b.Hw)for(c=0;c<b.length;c++){let f=b.getContext(c);this.Uyh(f)}else this.Uyh(b);b=this.actionId===C.a.W9||this.actionId===C.a.Yza||this.actionId===C.a.clearFormatting||this.actionId===C.a.eV;pg.p4b(this.actionId)||this.vtf.IT(b);(b=Object(va.a)(1175,this.ld))&&!b.xea||v.FocusManager.instance().Bf(a.RH);this.mB.dispose();this.mB=null;
pg.p4b(this.actionId)||Gb.App.Fb.updateCommandUI();N.a.mark(5731);this.NJa=3;this.fp=32}3===this.NJa&&(this.yLh.process(this.actionId,this.Bu,this.behavior,this.response),this.BX())}Uyh(a){(fb.SelectionEditor.lu(a)||fb.SelectionEditor.Cl(a))&&Gb.App.WQ.RQ(a.node)}static get Wi(){return Qg.a.instance}static get Tc(){return Sa.a.instance}}Object(e.a)(Es,"FormattingViewOperation",Bs.a,[]);var NP=d(473),OP=d(400);class ud{constructor(a,b,c,f,l){this.mya=new ua.ScriptSharpLegacyMap;this.q6k=x=>{x=Rb.HyperlinkReader.o4i(x,
this.JC);for(let F of x)(x=F.paragraph)&&x.Ra&&(x=x.Ra.jS(F.Qa))&&x.formatting&&ud.$g.Ifh(x.formatting)};this.KLh=a;this.i1e=b;this.Dv=c;this.JC=f;if(!l)throw Error.argumentNull("interactiveViewManager");ud.Hf=l;this.gkb=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("FontPreviewEnabled")}ub(){const a=u.AFrameworkApplication.Ta,b=Object(D.a)(this,this.PCk,"queryNonParagraphFormatting");H.a.instance.ga(105)&&(ud.pe?ud.pe.UCa(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"))?
(a.xa(C.a.font,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.yr,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.$H,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.lJ,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.Ss,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.eV,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.W9,Fb.a.endOfParagraph,
Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.Yza,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.bold,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.setItalic,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.underline,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.Ima,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.superscript,Fb.a.endOfParagraph,
Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.subscript,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.strikethrough,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.ys,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.UT,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP")),a.xa(C.a.clearFormatting,Fb.a.endOfParagraph,Object(D.a)(this,this.bP,"applyFormattingEOP"))):Gb.App.h9a&&(a.xa(C.a.font,
Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),a.xa(C.a.yr,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),a.xa(C.a.Ss,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),a.xa(C.a.eV,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),Ib.ListReader.Lw&&(a.xa(C.a.bold,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),a.xa(C.a.setItalic,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),
a.xa(C.a.superscript,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),a.xa(C.a.subscript,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),a.xa(C.a.strikethrough,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),a.xa(C.a.ys,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP"))),H.a.instance.ga(94)||H.a.instance.ga(96))&&(a.xa(C.a.$H,Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")),a.xa(C.a.lJ,
Fb.a.endOfParagraph,Object(D.a)(this,this.Baa,"applyListFormattingEOP")));const c=Gb.App.aJa.ARf(f=>li.Xqa(f.Oa,!0));a.pa(C.a.Vjd,Fb.a.textRange,Object(D.a)(this,this.Vjd,"toggleChangeCase"),1028);H.a.instance.ga(77)||a.xa(C.a.Cva,Fb.a.table,Object(D.a)(this,this.yDk,"queryTableFormatting"));a.xa(C.a.TDb,Fb.a.view,Object(D.a)(this,this.T7g,"queryCharacterFormatting"));a.xa(C.a.MAe,Fb.a.view,Object(D.a)(this,this.T7g,"queryCharacterFormatting"));a.xa(C.a.Cva,Fb.a.view,c);a.xa(C.a.Cva,Fb.a.paragraph,
Object(D.a)(this,this.Cva,"queryParagraphFormatting"));a.xa(C.a.Cva,Fb.a.image,Object(D.a)(this,this.ICk,"queryImageFormatting"));a.xa(C.a.Cva,Fb.a.unsupportedObject,b);a.$d(C.a.TDb,99|(H.a.instance.ga(7)?0:1028));a.$d(C.a.MAe,1127);a.$d(C.a.Cva,97|(H.a.instance.ga(7)?0:1028));u.AFrameworkApplication.fa.ka("RulerEnabled")&&(a.xa(C.a.VDb,Fb.a.view,c),a.xa(C.a.VDb,Fb.a.paragraph,Object(D.a)(this,this.VDb,"queryParagraphIndentation")),a.$d(C.a.VDb,97|(H.a.instance.ga(7)?0:1028)));this.pB(a,C.a.font);
this.pB(a,C.a.yr);this.gkb&&(this.pB(a,C.a.eHa),this.pB(a,C.a.qXa),this.pB(a,C.a.u4),this.pB(a,C.a.LHa));if(H.a.instance.ga(94)||H.a.instance.ga(96))this.pB(a,C.a.$H),this.pB(a,C.a.lJ);a.tza(C.a.v4f,Fb.a.view,Object(D.a)(this,this.GHd,"applyCharacterFormattingViewAsync"));a.$d(C.a.v4f,1092);this.pB(a,C.a.Ss);this.pB(a,C.a.eV);this.pB(a,C.a.W9);this.pB(a,C.a.vCc);this.pB(a,C.a.FUb);this.pB(a,C.a.GUb);this.pB(a,C.a.Eob);this.pB(a,C.a.wCc);this.pB(a,C.a.Yza);this.pB(a,C.a.bold);a.gfb(C.a.bold,Object(D.a)(this,
this.N5a,"generateActionArguments"));this.pB(a,C.a.setItalic);a.gfb(C.a.setItalic,Object(D.a)(this,this.N5a,"generateActionArguments"));this.pB(a,C.a.underline);a.gfb(C.a.underline,Object(D.a)(this,this.N5a,"generateActionArguments"));this.pB(a,C.a.Ima);this.pB(a,C.a.superscript);a.gfb(C.a.superscript,Object(D.a)(this,this.N5a,"generateActionArguments"));this.pB(a,C.a.subscript);a.gfb(C.a.subscript,Object(D.a)(this,this.N5a,"generateActionArguments"));this.pB(a,C.a.strikethrough);a.gfb(C.a.strikethrough,
Object(D.a)(this,this.N5a,"generateActionArguments"));this.pB(a,C.a.ys);a.gfb(C.a.ys,Object(D.a)(this,this.N5a,"generateActionArguments"));a.pa(C.a.R7a,Fb.a.textRange,Object(D.a)(this,this.AAc,"applyCharacterFormatting"),96);a.tza(C.a.UT,Fb.a.view,Object(D.a)(this,this.GHd,"applyCharacterFormattingViewAsync"));a.xa(C.a.UT,Fb.a.paragraph,Object(D.a)(this,this.MHd,"applyParagraphFormatting"));a.xa(C.a.UT,Fb.a.textRange,Object(D.a)(this,this.AAc,"applyCharacterFormatting"));a.xa(C.a.UT,Fb.a.Lf,Object(D.a)(this,
this.HHd,"applyFormattingIp"));a.xa(C.a.clearFormatting,Fb.a.view,Object(D.a)(this,this.Kmi,"clearFormattingView"));a.xa(C.a.clearFormatting,Fb.a.paragraph,Object(D.a)(this,this.Jmi,"clearFormattingParagraph"));a.xa(C.a.clearFormatting,Fb.a.textRange,Object(D.a)(this,this.AAc,"applyCharacterFormatting"));a.xa(C.a.clearFormatting,Fb.a.Lf,Object(D.a)(this,this.HHd,"applyFormattingIp"));a.$d(C.a.clearFormatting,1028);a.xa(C.a.H3a,Fb.a.textRange,Object(D.a)(this,this.H3a,"clearFormattingParagraphLevel"));
a.xa(C.a.H3a,Fb.a.Lf,Object(D.a)(this,this.H3a,"clearFormattingParagraphLevel"));a.xa(C.a.cMd,Fb.a.view,Object(D.a)(this,this.cMd,"clearFormattingMultiParagraphLevel"));a.xa(C.a.lIa,Fb.a.view,pg.w6);a.xa(C.a.lIa,Fb.a.paragraph,Object(D.a)(this,this.MHd,"applyParagraphFormatting"));a.xa(C.a.lIa,Fb.a.image,Object(D.a)(this,this.TFf,"applyTextDirectionToImage"));a.xa(C.a.lIa,Fb.a.unsupportedObject,Object(D.a)(this,this.UFf,"applyTextDirectionToNonParagraph"));a.$d(C.a.lIa,1028);a.xa(C.a.bYa,Fb.a.view,
pg.w6);a.xa(C.a.bYa,Fb.a.paragraph,Object(D.a)(this,this.MHd,"applyParagraphFormatting"));a.xa(C.a.bYa,Fb.a.image,Object(D.a)(this,this.TFf,"applyTextDirectionToImage"));a.xa(C.a.bYa,Fb.a.unsupportedObject,Object(D.a)(this,this.UFf,"applyTextDirectionToNonParagraph"));a.$d(C.a.bYa,1028)}pB(a,b){a.tza(b,Fb.a.view,Object(D.a)(this,this.GHd,"applyCharacterFormattingViewAsync"));a.xa(b,Fb.a.textRange,Object(D.a)(this,this.AAc,"applyCharacterFormatting"));a.xa(b,Fb.a.Lf,Object(D.a)(this,this.HHd,"applyFormattingIp"));
a.$d(b,1028)}N5a(){return new K(2)}Vjd(a,b,c){if(1===c)return 32;a=b.node.characterData.substr(b.Qa,b.Kb-b.Qa);return ud.aae(a,0,a.length)?this.uCc(b,C.a.FUb):ud.LNj(a)?this.uCc(b,C.a.Eob):this.uCc(b,C.a.GUb)}T7g(a,b,c,f,l){f=!0;b.contextId!==Fb.a.view&&(f=!1);if(1===c&&!f)return 8;if(a===C.a.MAe)a=l.formatting,l=l.cEl;else{if(!b.view||!b.view.Hh)return 2;b=b.view;if(!b.Eb||!b.Eb.Oa.kb)return 8;a=l;l=b.Eb.Oa}this.eqi(l,a);return 32}eqi(a,b){for(let l of a){a=l.nl;for(let x of l){let F=null;if(x.contextId===
Fb.a.textRange){if(fg.b(x))continue;F=[];var c=x.node.Ra;if(c){var f=c.length-1;const R=x.Qa,fa=x.Kb;let wa=!1;for(let Xa=0;Xa<f;Xa++){const lb=c.ga(Xa).cp,Lb=c.ga(Xa+1).cp;if(c.ga(Xa).formatting&&Math.max(lb,R)<Math.min(Lb,fa))wa=!0,Array.add(F,c.ga(Xa).formatting);else if(wa)break}c.ga(f).formatting&&x.Kb>c.ga(f).cp&&Array.add(F,c.ga(f).formatting)}}else if(x.contextId===Fb.a.paragraph){if(F=[],c=x.node.Ra)for(f=0;f<c.length;f++)c.ga(f).formatting&&Array.add(F,c.ga(f).formatting)}else if(x.contextId===
Fb.a.endOfParagraph)F=[tb.a.Bs(x)];else if(x.contextId===Fb.a.Lf){this.mCk(x,b);return}if(F&&0<F.length)for(const R of F)if(tb.a.nld(b,R.cache,x,a))return}}}mCk(a,b){var c=tb.a.Bs(a);if(c){c=c.cache;var f=ud.insertionPointFormatting.WH(bb.a.bold,c.isBold);b.bold=f?1:0;f=ud.insertionPointFormatting.WH(bb.a.italic,c.isItalic);b.italic=f?1:0;f=ud.insertionPointFormatting.WH(bb.a.underline,c.pD);b.underline=f?1:0;b.qw=ud.insertionPointFormatting.WH(bb.a.qw,c.qw);f=ud.insertionPointFormatting.WH(bb.a.superscript,
c.isSuperscript);b.superscript=f?1:0;f=ud.insertionPointFormatting.WH(bb.a.subscript,c.cF);b.subscript=f?1:0;f=ud.insertionPointFormatting.WH(bb.a.strikethrough,c.bF);b.strikethrough=f?1:0;f=ud.insertionPointFormatting.WH(kh.a.ys,c.vZ);b.ys=f?1:0;b.fontName=fd.Font.LBa(ud.insertionPointFormatting.WH(bb.a.font,c.TM));b.Yma=c.iU;b.fontSize=this.Dv.i6a(ud.insertionPointFormatting.WH(bb.a.fontSize,c.fontSize),a.node);b.fontColor=ud.insertionPointFormatting.WH(bb.a.fontColor,c.fontColor);b.highlight=ud.insertionPointFormatting.WH(bb.a.highlight,
c.highlight)}}GHd(a,b,c,f,l,x){return new Es(a,b,c,f,l,x,this.KLh,ud.Mq())}AAc(a,b,c,f,l){f=!0;let x=b;b.contextId!==Fb.a.textRange&&b.contextId!==Fb.a.Lf?f=!1:(H.a.instance.ga(14)&&ud.Wi.gsa(x)&&(ud.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),f=!1),ud.Mq()&&ud.Mq().instance&&ud.Mq().instance.LV(x)&&(f=!1),f&&fb.SelectionEditor.Pj(b)&&fg.b(x)&&(ud.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.$Dc}),f=!1));if(1===c||!f)return f?32:8;if(b.contextId===Fb.a.Lf)return 2;this.Dv.nph(a)&&(b=fb.SelectionEditor.OIb(x),fb.SelectionEditor.Kg(b)||
(x=b));b=x.node;pg.p4b(a)&&(b.Vma=!0);a==C.a.Ss&&H.a.instance.ga(119)&&u.AFrameworkApplication.fa.isChangeGateEnabled("HyperlinkPartialColorSupported")&&this.q6k(x);ud.nPe.BAc(x,F=>{this.hkh(F,a,l,x.Kb)});pg.p4b(a)&&(b.Vma=!1);this.gDj(a)&&this.uCc(x,a);return 32}FMc(a){if(!this.gkb||!a||!a.paragraph)return null;const b=ud.Hf.Ld;if(!b)return null;a=Object(va.a)(443,a.paragraph.Ag(b.Ma));return a?(a=Object(va.a)(477,a))?a:null:null}TOc(a){return this.gkb&&!!a&&!!a.Di}Akh(a,b,c){if(a&&a.ld){var f=b.cache,
l=a.ld,x=-1;if("string"===typeof l)this.gkb&&c===C.a.u4&&this.t3a(b,f.TM,bb.a.font),a=l;else if(this.gkb&&c===C.a.u4&&(this.t3a(b,f.TM,bb.a.font),this.t3a(b,f.iU,Bb.a.iU)),a=l.fontName,x=l.Yma,fd.Font.SRa()){this.gkb&&c===C.a.u4&&(this.t3a(b,f.isBold,bb.a.bold),this.t3a(b,f.isItalic,bb.a.italic));const F=1===l.bold;l=1===l.italic;if(F||l)ud.$g.hJ(b,F),ud.$g.setItalic(b,l)}a=a.substr(0,31);ud.$g.AX(b,a);H.a.instance.ga(53)&&(c===C.a.u4&&this.t3a(b,f.iU,Bb.a.iU),ud.$g.mIa(b,x))}}t3a(a,b,c){this.mya.Jb(a.xe.cp)||
this.mya.$(a.xe.cp,new ua.ScriptSharpLegacyMap);this.mya.ga(a.xe.cp).Jb(c)||this.mya.ga(a.xe.cp).$(c,b)}c_b(a,b){if(!this.mya.Jb(a.xe.cp))return null;const c=this.mya.ga(a.xe.cp).ga(b);this.mya.ga(a.xe.cp).remove(b);this.mya.ga(a.xe.cp).count||this.mya.remove(a.xe.cp);return c}hkh(a,b,c,f){var l=a.cache,x=Object(va.a)(1175,c);switch(b){case C.a.bold:2===c.value&&(c.value=l.isBold?0:1);ud.$g.hJ(a,1===c.value);break;case C.a.setItalic:2===c.value&&(c.value=l.isItalic?0:1);ud.$g.setItalic(a,1===c.value);
break;case C.a.underline:2===c.value&&(c.value=l.pD?0:1);ud.$g.e0(a,1===c.value);break;case C.a.Ima:ud.$g.Ima(a,c);break;case C.a.superscript:2===c.value&&(c.value=l.isSuperscript?0:1);ud.$g.GX(a,1===c.value);break;case C.a.subscript:2===c.value&&(c.value=l.cF?0:1);ud.$g.L4(a,1===c.value);break;case C.a.strikethrough:2===c.value&&(c.value=l.bF?0:1);ud.$g.EX(a,1===c.value);break;case C.a.ys:2===c.value&&(c.value=l.vZ?0:1);ud.$g.tfb(a,1===c.value);break;case C.a.font:this.Akh(x,a,C.a.font);break;case C.a.u4:c=
this.FMc(a);this.TOc(c)&&(this.Akh(x,a,C.a.u4),c.VL(null));break;case C.a.LHa:c=this.FMc(a);this.TOc(c)&&(x=this.c_b(a,bb.a.font))&&(f=this.c_b(a,bb.a.bold),l=this.c_b(a,bb.a.italic),f&&ud.$g.hJ(a,f),l&&ud.$g.setItalic(a,l),x=x.substr(0,31),ud.$g.AX(a,x),f=this.c_b(a,Bb.a.iU),H.a.instance.ga(53)&&f&&ud.$g.mIa(a,f),c.VL(null));break;case C.a.Ss:ud.$g.Ss(a,c,null);break;case C.a.eV:ud.$g.eV(a);break;case C.a.W9:ud.$g.Ema(a,c);break;case C.a.Yza:ud.$g.aVb(a);break;case C.a.yr:ud.$g.yr(a,x.ld);break;
case C.a.eHa:c=this.FMc(a);this.TOc(c)&&(this.t3a(a,l.fontSize,bb.a.fontSize),ud.$g.yr(a,x.ld),c.VL(null));break;case C.a.qXa:c=this.FMc(a);this.TOc(c)&&(f=this.c_b(a,bb.a.fontSize))&&(ud.$g.yr(a,f),c.VL(null));break;case C.a.$H:ud.$g.oOc(a);break;case C.a.lJ:ud.$g.uhd(a);break;case C.a.UT:l=H.a.instance.ga(20)?Bb.a.noProof:be.a.Lua;l=c.sa(l,!1);ud.$g.tjc(a,c.getValue(bb.a.Gs),f,l);break;case C.a.R7a:ud.$g.ZFb(a);break;case C.a.clearFormatting:ud.$g.Wza(a);break;case C.a.FUb:case C.a.GUb:case C.a.vCc:case C.a.Eob:case C.a.wCc:l.PQa&&
2===l.capitalization&&ud.$g.YLd(a)}}H3a(a,b,c){a=!0;b.contextId!==Fb.a.textRange&&b.contextId!==Fb.a.Lf?a=!1:(H.a.instance.ga(14)&&ud.Wi.gsa(b)&&(ud.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),a=!1),a&&fb.SelectionEditor.Pj(b)&&fg.b(b)&&(ud.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.$Dc}),a=!1));if(1===c||!a)return a?32:8;ud.paragraphEditor.cVb(b.node,!1);return 32}cMd(a,b,c,f,l){a={};a[bi.nna]=6168;a[bi.mna]=6169;const x=b.view;var F=null;x.So&&(F=x);var R=!0;let fa=32;F&&(F=F.Eb.Oa.kb)&&H.a.instance.ga(14)&&(ud.Wi.E$d(F)?
(ud.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.cD}),fa=8,R=!1):1===c&&(fa=32,R=!1));R&&H.a.instance.ga(54)&&(R=new We.GraphTransaction(1===c?3:15),R.fd(x.root),fa=bi.r4(C.a.H3a,b,c,f,l,a,12),R.dispose());return fa}HHd(a,b,c,f,l){var x=!0,F=32;b.contextId!==Fb.a.Lf?x=!1:H.a.instance.ga(14)&&ud.Wi.gsa(b)&&(ud.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),x=!1);if(1===c||!x)return x?32:8;c=b.node;x=null;if(H.a.instance.ga(54)&&H.a.instance.ga(61)&&a===C.a.clearFormatting){ud.ao.Rob(c);ud.paragraphEditor.INf(c);const R=Tc.StyleReader.tK(c).oG(Tc.StyleReader.HJa);
ud.qO.Y9(R,c,!0)}if(a!==C.a.clearFormatting||H.a.instance.ga(49))x=ud.insertionPointFormatting.h0b(b);if(x)F=ld.a.YNa(x),F=u.AFrameworkApplication.Ta.ii(F,a,2,!1,f,l);else switch(f=Object(va.a)(1175,l),b=tb.a.Bs(b).cache,a){case C.a.font:f&&f.ld&&(l=f.ld,f=-1,"string"===typeof l?b=l:(b=l.fontName,f=l.Yma),ud.insertionPointFormatting.rfd(b),H.a.instance.ga(53)&&ud.insertionPointFormatting.mIa(f));break;case C.a.Ss:ud.insertionPointFormatting.Ss(l);break;case C.a.eV:ud.insertionPointFormatting.eV();
break;case C.a.W9:ud.insertionPointFormatting.Ema(l);break;case C.a.Yza:ud.insertionPointFormatting.aVb();break;case C.a.yr:ud.insertionPointFormatting.yr(f.ld);break;case C.a.$H:l=ud.insertionPointFormatting.WH(bb.a.fontSize,b.fontSize);ud.insertionPointFormatting.yr(ud.$g.$H(l));break;case C.a.lJ:l=ud.insertionPointFormatting.WH(bb.a.fontSize,b.fontSize);ud.insertionPointFormatting.yr(ud.$g.lJ(l));break;case C.a.bold:ud.insertionPointFormatting.hJ(!ud.insertionPointFormatting.WH(bb.a.bold,b.isBold));
break;case C.a.setItalic:ud.insertionPointFormatting.setItalic(!ud.insertionPointFormatting.WH(bb.a.italic,b.isItalic));break;case C.a.underline:ud.insertionPointFormatting.e0(!ud.insertionPointFormatting.WH(bb.a.underline,b.pD));break;case C.a.Ima:ud.insertionPointFormatting.Ima(l);break;case C.a.superscript:ud.insertionPointFormatting.GX(!ud.insertionPointFormatting.WH(bb.a.superscript,b.isSuperscript));break;case C.a.subscript:ud.insertionPointFormatting.L4(!ud.insertionPointFormatting.WH(bb.a.subscript,
b.cF));break;case C.a.strikethrough:ud.insertionPointFormatting.EX(!ud.insertionPointFormatting.WH(bb.a.strikethrough,b.bF));break;case C.a.ys:ud.insertionPointFormatting.tfb(!ud.insertionPointFormatting.WH(kh.a.ys,b.vZ));break;case C.a.clearFormatting:ud.insertionPointFormatting.kXa();H.a.instance.ga(54)||(ud.ao.Rob(c),ud.paragraphEditor.cVb(c,!0),H.a.instance.ga(71)&&ud.qO.ZCc(c));break;case C.a.UT:l.Sa(bb.a.Gs)&&ud.insertionPointFormatting.UT(l.getValue(bb.a.Gs)),b=H.a.instance.ga(20)?Bb.a.noProof:
be.a.Lua,l.Sa(b)&&(l=l.getValue(b),ud.insertionPointFormatting.t3k(l))}pg.p4b(a)||Gb.App.Fb.updateCommandUI();return F}mOk(a,b){C.a.clearFormatting===b&&Yb.OutlineElementNavigator.rA(a).properties.removeProperty(bb.a.iX)}bP(a,b,c,f,l){f=ud.Tc.Bp(C.a.I1k);var x=!0;b.contextId!==Fb.a.endOfParagraph&&(x=!1);if(1===c||!x)return x?32:8;c=b.node;b=mb.GraphIterator.mb(b.node);b.Ze();x=b.nia(4);if((b=!!x&&ud.Rf.cca(x))&&!Gb.App.h9a)return 8;const F=!Ya.ParagraphReader.textLength(c);f.properties.$("Action",
a.toString());f.properties.$("ListContext",b.toString());f.properties.$("IsEmptyParagraph",F.toString());Z.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",a,b,F);this.i1e.Rth(b)?this.rBh(a,l,x):(b=c.Ra.last,this.mOk(c,a),x=b.formatting,c=ud.characterPropertiesEditor.iTd(c),this.i1e.Wug(x)&&(c.Sd(c.xe),this.hkh(c,a,l,b.cp)));f.end();return 32}rBh(a,b,c){const f=Object(va.a)(1175,b);switch(a){case C.a.Ss:ud.mca.Ss(c,b);break;case C.a.yr:ud.mca.yr(c,
f.ld);break;case C.a.eV:ud.mca.eV(c);break;case C.a.$H:ud.mca.$H(c);break;case C.a.lJ:ud.mca.lJ(c);break;case C.a.font:ud.mca.e2k(c,f.ld);break;case C.a.bold:a=this.TEb(b,bb.a.bold,c);ud.mca.hJ(c,a);break;case C.a.setItalic:a=this.TEb(b,bb.a.italic,c);ud.mca.setItalic(c,a);break;case C.a.subscript:a=this.TEb(b,bb.a.subscript,c);ud.mca.L4(c,a);break;case C.a.superscript:a=this.TEb(b,bb.a.superscript,c);ud.mca.GX(c,a);break;case C.a.strikethrough:a=this.TEb(b,bb.a.strikethrough,c);ud.mca.EX(c,a);break;
case C.a.ys:a=this.TEb(b,kh.a.ys,c),ud.mca.tfb(c,a)}}TEb(a,b,c){2===a.value&&(a.value=c?c.sa(b,!1)?0:1:0);return 1===a.value}Baa(a,b,c,f,l){f=!0;const x=mb.GraphIterator.mb(b.node);x.Ze();b.contextId===Fb.a.endOfParagraph&&x.nia(4)||(ud.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.Ibe}),f=!1);b=x.currentNode;if(!ud.Rf.cca(b))return 8;if(1===c||!f)return f?32:8;this.rBh(a,l,b);return 32}Cva(a,b,c,f,l){a=!0;b.contextId!==Fb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;-1!==l.pl?l.pl!==Ya.ParagraphReader.UM(c)&&
(l.pl=0):l.pl=Ya.ParagraphReader.UM(c);H.a.instance.ga(54)&&(H.a.instance.ga(59)||H.a.instance.ga(34))&&(a=ud.xL.dsb(c),l.xA?(!l.RCl&&this.Oqj(l.xA,a)&&2===l.xA.specialIndentType&&(l.xA.specialIndentType=0),l.xA.UPc===a.UPc&&Md.a.ty(l.xA.aN,a.aN)||(l.xA.aN=Number.MAX_VALUE),l.xA.WPc===a.WPc&&Md.a.ty(l.xA.Etb,a.Etb)||(l.xA.Etb=Number.MAX_VALUE)):l.xA=a,b=ud.Pl.PGf(b.MD),void 0!==b&&null!==b&&(b=b.node,void 0!==b&&null!==b&&(b=NP.WordSectionNavigator.instance.Kse(b),void 0!==b&&null!==b&&(b=ud.pUe.qra(b)-
(ud.pUe.VZd(b)+ud.pUe.WZd(b)+Gb.App.RAl),a.VPc=b-a.aN,a.TPc=b-a.Etb,l.xA.TPc=Math.min(l.xA.TPc,a.TPc),l.xA.VPc=Math.min(l.xA.VPc,a.VPc)))));if(H.a.instance.ga(54)&&H.a.instance.ga(59)||H.a.instance.ga(84))b=ud.ISj.xV(c),l.spacing?(l.spacing.beforeSpacing=ud.xDf(b.beforeSpacing,l.spacing.beforeSpacing),l.spacing.afterSpacing=ud.xDf(b.afterSpacing,l.spacing.afterSpacing),l.spacing.lineSpacing.Pf===b.lineSpacing.Pf&&Md.a.ty(l.spacing.lineSpacing.value,b.lineSpacing.value)||(l.spacing.lineSpacing.Pf=
0,l.spacing.lineSpacing.value=0)):l.spacing=b;b=new mb.GraphIterator;b.set(c);b.mc(11);if(c=b.Ng(11))l.isRtl=Rd.OutlineElementReader.Yl(c);c=ud.Rf.Fw(b);b=16;void 0!==c&&null!==c&&(b=c.listType);l.listType=ud.t0i(l.listType,b);l.GS=16===l.listType?null:c;return 32}Oqj(a,b){return this.gGf(a,b)||this.gGf(b,a)}gGf(a,b){return(1===a.specialIndentType||0===a.specialIndentType)&&2===b.specialIndentType}PCk(a,b,c,f,l){a=Yb.OutlineElementNavigator.rA(b.node);l.isRtl=Rd.OutlineElementReader.Yl(a);return 32}UFf(a,
b,c){if(a===C.a.bYa)a=!0;else if(a===C.a.lIa)a=!1;else return 2;a&&this.vce(b);if(1===c)return 32;b=Yb.OutlineElementNavigator.rA(b.node);ud.Jh.jIa(b,a);return 32}ICk(a,b,c,f,l){a=b.node;b=Yb.OutlineElementNavigator.rA(a);l.isRtl=Rd.OutlineElementReader.isRtl(b);l.pl=W.ImageReader.UM(a);return 32}yDk(a,b,c,f,l){a=b.node;b=Yb.OutlineElementNavigator.rA(a);l.isRtl=Rd.OutlineElementReader.isRtl(b);l.pl=xd.TableReader.UM(a);if(-1===l.pl||0===l.pl)l.pl=l.isRtl?3:1;return 32}TFf(a,b,c){if(!({CE:c}=pg.joh(c,
b)).returnValue)return c;c=b.node;switch(a){case C.a.lIa:case C.a.bYa:c=Yb.OutlineElementNavigator.rA(c);let f=!0;a===C.a.lIa&&(f=!1);ud.Jh.jIa(c,f);f&&this.vce(b)}return 32}MHd(a,b,c,f,l){let x;if(!({CE:x}=pg.W8k(c,b)).returnValue)return x;const F=b.node;switch(a){case C.a.lIa:ud.Jh.yGb(F,!1);break;case C.a.bYa:this.vce(b);ud.Jh.yGb(F,!0);break;case C.a.UT:x=u.AFrameworkApplication.Ta.ii(b.MD,a,c,!0,f,l),32===x&&Ya.ParagraphReader.Xl(b)&&ud.Qfc&&ud.Qfc.RQ(F)}return 32}Kmi(a,b,c,f,l){const x={};x[bi.nna]=
6168;x[bi.mna]=6169;var F=b.view;const R=new We.GraphTransaction(1===c?3:15);R.fd(F.root);let fa=bi.r4(a,b,c,f,l,x,0),wa=null;F.So&&(wa=F);F=!0;let Xa=null;wa&&(Xa=wa.Eb.Oa.kb)&&H.a.instance.ga(14)&&(ud.Wi.E$d(Xa)?(ud.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.cD}),fa=8,F=!1):1===c&&(fa=32,F=!1));F&&this.PNj(Xa)&&(fa=H.a.instance.ga(54)?bi.r4(C.a.H3a,b,c,f,l,x,12):bi.r4(a,b,c,f,l,x,12));R.dispose();return fa}Jmi(a,b,c){a=!0;b.contextId!==Fb.a.paragraph&&b.contextId!==Fb.a.Lf?a=!1:H.a.instance.ga(14)&&ud.Wi.kDa(b)&&
(ud.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),a=!1);if(1===c||!a)return a?32:8;b=b.node;c=new We.GraphTransaction(15);c.fd(b);ud.ao.Rob(b);ud.paragraphEditor.cVb(b,!0);ud.qO.ZCc(b);c.dispose();return 2}VDb(a,b,c,f,l){a=b.contextId===Fb.a.paragraph;if(1===c&&!a)return 8;l.xA||(b=b.node,c=ud.xL.dsb(b),l.xA=c,c=new mb.GraphIterator,c.set(b),c.mc(11),b=c.Ng(11),l.isRtl=b?Rd.OutlineElementReader.Yl(b):!1);return 32}PNj(a){return!a||fb.SelectionEditor.Jw(a)||1===a.length&&fb.SelectionEditor.Pj(a.Ua)&&!fb.SelectionEditor.uub(a.Ua)?
!1:!0}vce(a){ud.Hsf.Jb(a.contextId)||(Z.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",a.contextId),ud.Hsf.$(a.contextId,!0))}gDj(a){return a===C.a.vCc||a===C.a.FUb||a===C.a.GUb||a===C.a.Eob||a===C.a.wCc}uCc(a,b){const c=a.node;b=ud.$kl(c.characterData.substr(a.Qa,a.Kb-a.Qa),b);c.characterData=c.characterData.substr(0,a.Qa)+b+c.characterData.substr(a.Kb);return 32}static get $g(){return ud.Gf||(ud.Gf=hb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return ud.Vg||
(ud.Vg=hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return ud.xw||(ud.xw=hb.a.instance.resolve("Box4.IParagraphEditor"))}static get ISj(){return ud.jLa||(ud.jLa=hb.a.instance.resolve("Box4.ILineSpacingHelper"))}static get qO(){return ud.QJ||(ud.QJ=hb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Jh(){return ud.xi||(ud.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get insertionPointFormatting(){return ud.$s||(ud.$s=hb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get mca(){return ud.Bkb||
(ud.Bkb=hb.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get xL(){return ud.TF||(ud.TF=hb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static Mq(){return ud.nm||(ud.nm=hb.a.instance.La("Box4.IExternalSelectionManager"))}static get Pl(){return Rg.ContextSetEditor.instance}static get Wi(){return Qg.a.instance}static get Tc(){return Sa.a.instance}static get pe(){return ud.Xc||(ud.Xc=hb.a.instance.pb("Box4.IFeatureHelper"))}static get Qfc(){return Gb.App.WQ}static get Nf(){return ud.Wc||
(ud.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get k5(){return ud.Lo||(ud.Lo=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get nPe(){return ud.uMa||(ud.uMa=hb.a.instance.resolve("Box4.TextFormattingHelper"))}static get Rf(){return ud.Og||(ud.Og=hb.a.instance.resolve("Box4.List.IListReader"))}static get ao(){return ud.Jo||(ud.Jo=hb.a.instance.resolve("Box4.List.IListEditor"))}static get pUe(){return OP.a.instance}static t0i(a,
b){return 42===a?b:a!==b||16===a?16:a}static xDf(a,b){a.Srg||(b.Srg?b=a:b.Pf===a.Pf&&Md.a.ty(b.value,a.value)||(b.value=-1));return b}static $kl(a,b){switch(b){case C.a.FUb:return a.toLowerCase();case C.a.GUb:return a.toUpperCase();case C.a.vCc:case C.a.Eob:return ud.bki(a,b===C.a.Eob);case C.a.wCc:return ud.Kml(a);default:return a}}static Kml(a){let b="";for(let c=0;c<a.length;c++)b=a.charAt(c)===a.charAt(c).toUpperCase()?b+a.charAt(c).toLowerCase():b+a.charAt(c).toUpperCase();return b}static bki(a,
b){let c,f,l=!0,x=a.length,F=0,R=ud.aae(a,F,x);for(;0<x;){f=c=!1;var fa=x;let Xa;var wa=void 0;for(wa=0;0<fa&&ud.Mli(a.charAt(F+wa));wa++,fa--)f=ud.BTc(a.charAt(F+wa));for(Xa=wa;0<fa&&!(c=ud.BTc(a.charAt(F+wa)))&&" "!==a.charAt(F+wa)&&"/"!==a.charAt(F+wa);wa++,fa--);fa=wa-Xa;if(0>=fa)break;F+=Xa;wa=a.substr(F,fa);wa=wa===wa.toUpperCase();if(R||!wa)a=l||f||b?a.substr(0,F)+a.charAt(F).toUpperCase()+a.substr(F+1,fa-1).toLowerCase()+a.substr(F+fa):a.substr(0,F)+a.substr(F,fa).toLowerCase()+a.substr(F+
fa);x-=fa+Xa;F+=fa;if(l=c)F++,x--,R=ud.aae(a,F,x)}return a}static aae(a,b,c){for(;0<c&&!ud.BTc(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toUpperCase())return!1;b++;c--}return!0}static LNj(a){for(var b=0;b<a.length&&!ud.BTc(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toLowerCase())return!1;b++}return!0}static BTc(a){return"."===a||"!"===a||"?"===a?!0:!1}static Mli(a){return-1==="0123456789".indexOf(a)&&a.toUpperCase()===a.toLowerCase()}}ud.Gf=null;ud.xi=null;ud.Hsf=new $g.a;ud.Hf=null;ud.jLa=null;
ud.Vg=null;ud.xw=null;ud.QJ=null;ud.$s=null;ud.Bkb=null;ud.TF=null;ud.nm=null;ud.Xc=null;ud.Wc=null;ud.Lo=null;ud.uMa=null;ud.Og=null;ud.Jo=null;Object(e.a)(ud,"TextFormattingActor",null,[]);class DI{constructor(a){this.Ca=a}get Ym(){return this.Ca}ZFb(a,b=!1){this.Ym.ii(a,C.a.R7a,2,!0,null,b)}UT(a){this.Ym.Ka(C.a.UT,2,a)}}Object(e.a)(DI,"TextFormattingCommands",null,[1160]);class St{get nna(){return bi.nna}get mna(){return bi.mna}get MJb(){return bi.MJb}r4(a,b,c,f,l,x,F){return bi.r4(a,b,c,f,l,x,
F)}odb(a,b,c,f,l,x){return bi.odb(a,b,c,f,l,x)}static get instance(){St.Ja||(St.Ja=new St);return St.Ja}}St.Ja=null;Object(e.a)(St,"ViewActionHandlerProxy",null,[1174]);class EI{constructor(a){this.Ca=a}get Ym(){return this.Ca}zdk(a){if(4===a)a=C.a.leftArrow;else if(2===a)a=C.a.rightArrow;else if(1===a)a=C.a.upArrow;else if(3===a)a=C.a.downArrow;else return;this.Ym.processAction(a,2)}Eqa(){this.Ym.processAction(C.a.Eqa,2)}}Object(e.a)(EI,"SelectionCommands",null,[1159]);class FI{Jg(a,b){return nd.SelectionFactory.Jg(a,
b)}PM(a,b){return nd.SelectionFactory.PM(a,b)}eu(a,b=!0){return nd.SelectionFactory.eu(a,b)}P1(a,b,c){return nd.SelectionFactory.P1(a,b,c)}Xk(a){return nd.SelectionFactory.Xk(a)}SIb(a,b,c=!1){return nd.SelectionFactory.SIb(a,b,c)}}Object(e.a)(FI,"SelectionFactoryProxy",null,[1147]);var PP=d(861),qx=d(245),kz=d(974);class GI extends kz.a{constructor(a,b,c,f,l,x,F=null,R=null){super(a,x,F,R);this.Tn=this.xw=this.b1=null;this.Vna=!1;this.P_a=u.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");
this.T0a=0;this.WCd=new Ha.a;Oe.a(8128527,307,Rd.OutlineElementReader.Tg(a));this.yE=b;this.yE.Nnb(this);this.Jtd=c;this.Jo=f;this.Og=l;this.Uuk=R;this.Xyd=Ib.ListReader.ak(this.wb)}get z7(){return this.b1||(this.b1=hb.a.instance.pb("Box4.IInternalLinkManager"))}get paragraphEditor(){return this.xw||(this.xw=hb.a.instance.resolve("Box4.IParagraphEditor"))}get hOa(){return null}get $3a(){return this.Xyd&&!this.yE.$aa}get p4a(){return 0<this.T0a}get Tu(){return this.Jtd}get ao(){return this.Jo}get Rf(){return this.Og}get lBc(){return this.Uuk}I_(a,
b){if(!this.cY.lRe(b)){Oe.a(8701077,307,Ya.ParagraphReader.Lk(this.wb));var c=this.wb.currentNode,f=Pc.a.XNa(c);this.P_a&&this.Tn.J5a&&(c=c.Ra.last,this.Vna&&(c.formatting=this.Tn.J5a.Sd(c),this.Vna=!1),a=this.cY.Q2d(a,b),this.cY.Gma(this.wb.currentNode,this.Tn.Qda,b));this.characterPropertiesEditor.replaceTextRange(f,a)}}zla(){Oe.a(8701078,307,Ya.ParagraphReader.Lk(this.wb));const a=Pc.a.XNa(this.wb.currentNode);this.characterPropertiesEditor.lQc(a,b=>new jv.a(b,jv.a.QFc),te.AParagraphNode.cZ)}kWa(){}xla(){this.P_a&&
(this.Vna=!0)}Tua(){Oe.a(8701079,307,Ya.ParagraphReader.Lk(this.wb))}Sua(){Oe.a(8701080,307,Ya.ParagraphReader.Lk(this.wb))}Uz(a){this.yE.$aa||(this.P_a?(this.zHd(a),this.Tn.wkd(this.wb.currentNode),a&&"P"===a.xT.b2b&&this.lBc.hIa(this.wb.currentNode,this.Tn.a9c),this.cY.Gma(this.wb.currentNode,this.Tn.Qda,a)):this.lbi(a))}Tz(){this.yE.$aa||this.X1()}Yua(){}HGa(){}Cla(){Oe.a(8701081,307,Rd.OutlineElementReader.Tg(this.wb)||Ui.OutlineReader.At(this.wb)||Ya.ParagraphReader.Lk(this.wb)&&this.yE.$aa);
let a=!1;this.p4a||(a=this.$3a||!0);a||(this.zL+=1);this.T0a++}Ala(){this.T0a--;let a=!1;this.p4a||(a=this.$3a||!0);a||--this.zL}Xua(a){Oe.a(8701082,307,Rd.OutlineElementReader.Tg(this.wb)||Ui.OutlineReader.At(this.wb)||Ya.ParagraphReader.Lk(this.wb)&&this.yE.$aa);Oe.a(8701083,307,0!==a.listStyleType)}Bla(){Oe.a(8701084,307,Rd.OutlineElementReader.Tg(this.wb)||Ya.ParagraphReader.Lk(this.wb)&&this.yE.$aa);this.yE.$aa||Oe.a(8701085,307,this.wb.bI(2))}gX(a){this.yE.gX(a)}dX(){this.yE.dX()}jkd(a){this.WCd.add(a)}fX(a){this.yE.fX(a)}eX(){this.yE.eX()}cX(a){this.yE.cX(a)}bX(){this.yE.bX()}lbi(a){this.nBb(!1);
(new mb.GraphIterator).Nc(this.wb);a=kz.a.Jh.Vaa(this.wb,this.aQa(a));Oe.a(8128534,307,a===this.wb.currentNode);Oe.a(8128535,307,Ya.ParagraphReader.Wd(a))}X1(){Oe.a(8128536,307,Ya.ParagraphReader.Lk(this.wb));Yb.OutlineElementNavigator.Je(this.wb)}reset(){this.P_a&&(super.reset(),this.Tn=this.hYd(!0))}zHd(a){this.nBb(!1);(new mb.GraphIterator).Nc(this.wb);a=kz.a.Jh.Vaa(this.wb,this.aQa(a));Oe.a(36577367,307,a===this.wb.currentNode);Oe.a(36577368,307,Ya.ParagraphReader.Wd(a));-1!==this.Tn.rD&&this.paragraphEditor.IL(a,
this.Tn.rD);this.Tn.lineSpacing&&this.lBc.c0(a,this.Tn.lineSpacing);this.Tn.Eea&&this.lBc.jmh(a,this.Tn.Eea);this.Tn.gVc&&this.lBc.alh(a,this.Tn.gVc);this.Vna=!0;this.Tn.paragraph=a}static WNd(a,b){let c=0;switch(b){case 3:c=je.a.Mra(a);break;case 7:c=Fd.a.Uda(a,0);break;case 1:c=je.a.pLd(a);break;case 5:c=je.a.Mra(je.a.Y9c(a));break;default:Z.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,b)}return c}}Object(e.a)(GI,"TextOnlyBox4PasteSteward",
kz.a,[]);class sC{constructor(a,b,c,f){this.sPb=a;this.Jo=b;this.Og=c;this.cY=f}create(a,b,c,f,l=null,x=null){return 1===a?new GI(b,f,this.sPb,this.Jo,this.Og,l,x,this.cY):new qx.Box4PasteSteward(b,c,f,this.sPb,this.Jo,this.Og,l,x,this.cY)}}Object(e.a)(sC,"Box4PasteStewardFactory",null,[1172]);class wg{static get Osj(){return wg.IMh}static get Usj(){return wg.LMh}static get Tsj(){return wg.KMh}static YAk(a,b){const c=a.currentNode;Dd.forEachCell(a,b.rowSpan,b.colSpan,(f,l,x)=>{const F=f.currentNode;
F!==c&&(F.isGhostCell=!0,wg.LVf(f),!x&&1<=b.colSpan&&(F.colSpan=b.colSpan),wg.Hkh(f,b.Z4,l,x,b.rowSpan,b.colSpan))})}static rBk(a,b){Dd.forEachCell(a,b.rowSpan,b.colSpan,c=>{wg.v9h(c);wg.LVf(c)})}static v9h(a){a=a.currentNode;a.isGhostCell=!0;a.isSkippedCell=!0;a.$fb=!0}static LVf(a){a&&(a.zb(1),Object(Fa.a)(eI.a,a.currentNode)&&a.Ii())}static N9h(a,b,c){0<b&&(a=Object(va.a)(px.TableCellNode,a.currentNode))&&(a.width=c?b:Fd.a.Ef(b,0))}static b9h(a,b,c){if(a=Object(va.a)(py.a,a.currentNode))0<b&&(a.Il=
Fd.a.Uda(b,0)),0<c&&(a.kX=Fd.a.Uda(c,0))}static XFf(a,b){void 0!==b&&null!==b&&a.currentNode.properties.setValue(Bb.a.AOe,wg.Usj[b+""])}static JFf(a,b){void 0!==b&&null!==b&&""!==b&&a.currentNode.properties.setValue(bb.a.sCc,parseInt(qx.Box4PasteSteward.b4a(b),16))}static Bgj(a){const b=new mb.GraphIterator;b.Nc(a);return(a=yh.OutlineNavigator.zdd(b))&&Ui.OutlineReader.At(b)?a.Sh(Bb.a.Nda)-a.Sh(Bb.a.marginLeft)-a.Sh(Bb.a.marginRight):0}static OLj(a){return!(void 0===a||null===a||1===a)}static H0k(a,
b,c,f,l){if(void 0===b||null===b||""!==b){switch(b){case "thin":b=je.a.X9c(.25);break;case "initial":case "medium":b=je.a.X9c(.5);break;case "thick":b=je.a.X9c(1);break;default:b=wg.Jdj(b,c,f)}l.currentNode.properties.setValue(a,b)}}static PHe(a,b,c){void 0!==b&&null!==b&&0!==b&&c.currentNode.properties.setValue(a,wg.Tsj[b+""])}static G0k(a,b,c){void 0!==b&&null!==b&&""!==b&&c.currentNode.properties.setValue(a,parseInt(qx.Box4PasteSteward.b4a(b),16))}static Jdj(a,b,c){let f=0;const l=({Pf:a}=qx.Box4PasteSteward.j9c(a)).returnValue;
switch(a){case 5:f=je.a.X9c(l);break;case 1:f=je.a.Fji(l);break;case 3:f=je.a.qlg(l);break;case 7:f=Fd.a.nvk(l,c)}if(6===b||7===b||10===b)f/=3;return Math.round(f)}static Kdj(a,b){let c=0;const f=({Pf:a}=qx.Box4PasteSteward.j9c(a)).returnValue;switch(a){case 5:c=je.a.$G(f);break;case 1:c=je.a.Gji(f);break;case 3:c=je.a.DV(f);break;case 7:c=Fd.a.Ef(f,b)}return c}static cfd(a,b,c,f,l,x,F){if(l&&(!F||16===l.mi||F||14!==l.mi)&&12!==c){if(F)switch(f){case 7:f=Bb.a.Guh;var R=Bb.a.Iuh;var fa=Bb.a.Huh;var wa=
0;break;case 6:f=Bb.a.Duh;R=Bb.a.Fuh;fa=Bb.a.Euh;wa=1;break;case 0:f=Bb.a.xuh;R=Bb.a.zuh;fa=Bb.a.yuh;wa=0;break;case 5:f=Bb.a.Auh;R=Bb.a.Cuh;fa=Bb.a.Buh;wa=1;break;default:return}else switch(f){case 7:f=Bb.a.Cjl;R=Bb.a.Ejl;fa=Bb.a.Djl;wa=0;break;case 6:f=Bb.a.zjl;R=Bb.a.Bjl;fa=Bb.a.Ajl;wa=1;break;case 0:f=Bb.a.tjl;R=Bb.a.vjl;fa=Bb.a.ujl;wa=0;break;case 5:f=Bb.a.wjl;R=Bb.a.yjl;fa=Bb.a.xjl;wa=1;break;default:return}void 0!==l.currentNode&&null!==l.currentNode&&(wg.OLj(c)?(wg.G0k(f,a,l),wg.PHe(R,c,l),
wg.H0k(fa,b,c,wa,l)):x||F||l.currentNode.properties.setValue(R,"nil"))}}static Hkh(a,b,c,f,l,x){f||(wg.DFf(b,a,!1,!1),wg.PHd(b,a,!0,!1));f===x-1&&wg.PHd(b,a,!0,!1);c||wg.VFf(b,a,!0,!1);c===l-1&&wg.uFf(b,a,!0,!1)}static sFf(a,b,c,f){a&&(wg.VFf(a,b,c,f),wg.PHd(a,b,c,f),wg.uFf(a,b,c,f),wg.DFf(a,b,c,f))}static VFf(a,b,c,f){wg.cfd(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,7,b,c,f)}static PHd(a,b,c,f){wg.cfd(a.borderRightColor,a.borderRightWidth,a.borderRightStyle,6,b,c,f)}static uFf(a,b,c,f){wg.cfd(a.borderBottomColor,
a.borderBottomWidth,a.borderBottomStyle,0,b,c,f)}static DFf(a,b,c,f){wg.cfd(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,5,b,c,f)}static dfd(a,b,c){if(c&&16===c.mi&&""!==a){switch(b){case 3:b=Bb.a.aIb;var f=0;break;case 2:b=Bb.a.$Hb;f=1;break;case 0:b=Bb.a.XHb;f=0;break;case 1:b=Bb.a.YHb;f=1;break;default:return}(a=wg.Kdj(a,f))&&c.currentNode.properties.setValue(b,a)}}static N8h(a,b){b&&(wg.I9h(b,a),wg.r9h(b,a),wg.O8h(b,a),wg.g9h(b,a))}static I9h(a,b){wg.dfd(a.Aji,3,b)}static r9h(a,b){wg.dfd(a.zji,
2,b)}static O8h(a,b){wg.dfd(a.xji,0,b)}static g9h(a,b){wg.dfd(a.yji,1,b)}}wg.qek=8;wg.GDi="Table Grid";wg.IMh=xa.a.gH("MsoNormalTable","Normal Table","MsoTableGrid",wg.GDi,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2",
"Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5",
"Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2",
"Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5",
"Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6",
"MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1",
"List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3",
"MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4",
"MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3",
"MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5",
"List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6",
"List Table 7 Colorful Accent 6");wg.LMh=xa.a.gH("0","center","1","top","2","center","3","bottom");wg.KMh=xa.a.gH("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(e.a)(wg,"Box4TableStewardHelper",null,[]);class rx{constructor(a,b,c,f=!1,l=!1,x=!1){this.vv=null;this.U0a=0;this.wb=a;this.ao=b;this.Aq=c;this.amb=f;this.DPb=l;this.Uyd=x}Nnb(a){this.vv=a}get $aa(){return 0<this.U0a}gX(a){Oe.a(7869459,
307,!!this.vv);Oe.a(7869460,307,Rd.OutlineElementReader.Tg(this.wb)||Ui.OutlineReader.At(this.wb));Oe.c(38563978,307,50,"Table pasting started");this.vv.nBb(!0);const b=new mb.GraphIterator;b.Nc(this.wb);Object(va.a)(String,wg.Osj[a.Ath]);const c=this.Aq.nJk(this.wb,a.wX,a.Spa,this.vv.aQa(a),a.prg);if(this.amb&&(Oe.c(23938568,307,50,a.KNa?"Table-widths exist":"Table-widths missing, table may be invalid"),a.yOe&&wg.sFf(a.yOe,this.wb,!1,!0),wg.b9h(this.wb,a.m5d.pfl,a.m5d.ofl),a.KNa)){var f=0;const R=
Array(a.KNa.length);var l=0;a.qDa&&H.a.instance.ga(63)&&(l=(l=je.a.hzh(wg.Bgj(this.wb)))?l:1);for(var x=0;x<a.KNa.length;x++)R[x]=0<l?l/100*a.KNa[x]:Fd.a.Ef(a.KNa[x],0),f+=R[x];l=c.getValue(bb.a.uu);var F=new mb.GraphIterator;F.Nc(this.wb);a=0;if(De.isInTableCell(F)){if(l=Dd.returnToContainingCell(F))a=l.width;x=Nn.a(F);F=Dd.returnToContainingTable(F);if(-1!==x&&x<=F.MNa.length){let fa=0;for(let wa=x;wa<x+l.colSpan&&wa<F.MNa.length;wa++)fa+=F.MNa[wa];a=Math.min(a,fa);a===fa&&(a-=Fd.a.Ef(wg.qek,0))}}else if(l)for(x=
0;x<l.length;x++)a+=l[x];if(0<a&&f>a&&f)for(f=a/f,a=0;a<R.length;a++)R[a]*=f;c.setValue(bb.a.uu,R)}this.vv.EAc(b,!1);this.U0a++;H.a.instance.ga(63)&&Ib.ListReader.ak(b)&&this.vv.jkd(b.currentNode);Oe.a(7869461,307,xd.TableReader.Np(this.wb))}dX(){Oe.a(7869462,307,!!this.vv);Oe.a(7869463,307,ik.l(this.wb));Oe.c(38563979,307,50,"Table pasting finished");Yb.OutlineElementNavigator.Je(this.wb);this.U0a--}fX(a){Oe.a(7869464,307,!!this.vv);xd.TableReader.Np(this.wb)?Dd.moveToFirstRow(this.wb):ik.l(this.wb)&&
Dd.moveToNextRow(this.wb);this.amb&&a.height&&this.wb.currentNode.setValue(Bb.a.Rt,Fd.a.Ef(a.height,1));Oe.a(7869465,307,ik.l(this.wb))}eX(){Oe.a(7869466,307,!!this.vv);Oe.a(7869467,307,De.isTableCell(this.wb));Dd.returnToContainingRow(this.wb)}cX(a){Oe.a(7869468,307,!!this.vv);Oe.a(7869469,307,!this.vv.zL);ik.l(this.wb)?Dd.moveToFirstColumn(this.wb):De.isTableCell(this.wb)?Dd.moveToNextColumn(this.wb):Oe.a(7869471,307,!1);u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings");
if(this.DPb){if(!this.wb.currentNode)return;var b=Object(va.a)(px.TableCellNode,this.wb.currentNode);Oe.a(50689760,307,!b&&16!==this.wb.currentNode.type||!!b&&16===this.wb.currentNode.type);if(!b)return;let c=new mb.GraphIterator;c.Nc(this.wb);if(!a.colSpan||!a.rowSpan)return;if(a.tvb){wg.rBk(c,a);return}if(1<a.colSpan||1<a.rowSpan){const f=Dd.returnToContainingTable(c);if(!f)return;f.setValue(Bb.a.complexTable,!0);c.Nc(this.wb);wg.YAk(c,a);b.rowSpan=a.rowSpan;b.colSpan=a.colSpan}}this.amb&&(wg.JFf(this.wb,
a.Rjc),wg.XFf(this.wb,a.verticalAlignment),this.Uyd&&wg.N8h(this.wb,a.Vid));this.DPb&&wg.sFf(a.Z4,this.wb,!a.colSpan&&!a.rowSpan,!1);this.amb&&(this.DPb||(b=new mb.GraphIterator,b.Nc(this.wb),Dd.forEachCell(b,a.rowSpan,a.colSpan,(c,f,l)=>{wg.JFf(c,a.Rjc);wg.XFf(c,a.verticalAlignment);wg.Hkh(c,a.Z4,f,l,a.rowSpan,a.colSpan)})),wg.N9h(this.wb,a.width,a.qDa));Oe.a(7869472,307,Ui.OutlineReader.At(this.wb))}bX(){Oe.a(7869473,307,!!this.vv);Oe.a(7869474,307,Rd.OutlineElementReader.Tg(this.wb)||De.isTableCell(this.wb));
Dd.returnToCell(this.wb);Oe.a(7869475,307,0>=this.vv.zL);this.vv.gMd()}static get Jh(){return rx.xi||(rx.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}}rx.xi=null;Object(e.a)(rx,"Box4TableSteward",null,[401,402]);class Tt{constructor(a,b,c){this.vv=null;this.U0a=0;this.wb=a;this.ao=b;this.Aq=c}Nnb(a){this.vv=a}get $aa(){return 0<this.U0a}gX(){this.$aa&&(Oe.a(8787101,307,Ya.ParagraphReader.Lk(this.wb)),Yb.OutlineElementNavigator.Je(this.wb));Oe.a(8701086,307,!!this.vv);Oe.a(8701087,307,Rd.OutlineElementReader.Tg(this.wb)||
Ui.OutlineReader.At(this.wb));this.U0a++}dX(){Oe.a(8701088,307,!!this.vv);Yb.OutlineElementNavigator.Je(this.wb);this.U0a--;if(this.$aa){this.vv.nBb(!0);const a=Tt.Jh.Vaa(this.wb);Oe.a(8787102,307,a===this.wb.currentNode);Oe.a(8787103,307,Ya.ParagraphReader.Lk(this.wb))}}fX(a){Oe.a(8701089,307,!!this.vv);this.vv.nBb(!0);const b=new mb.GraphIterator;b.Nc(this.wb);this.vv.EAc(b,!1);H.a.instance.ga(63)&&Ib.ListReader.ak(b)&&this.vv.jkd(b.currentNode);a=Tt.Jh.Vaa(this.wb,this.vv.aQa(a));Oe.a(8701090,
307,a===this.wb.currentNode);Oe.a(8701091,307,Ya.ParagraphReader.Lk(this.wb))}eX(){Oe.a(8701120,307,!!this.vv);Oe.a(8701121,307,Ya.ParagraphReader.Lk(this.wb));Yb.OutlineElementNavigator.Je(this.wb)}cX(){Oe.a(8701122,307,!!this.vv);Oe.a(8701123,307,Ya.ParagraphReader.Lk(this.wb));Oe.a(8701124,307,!this.vv.zL);var a=this.wb.currentNode;Ya.ParagraphReader.textLength(a)&&(a=Pc.a.XNa(a),this.vv.characterPropertiesEditor.replaceTextRange(a,", "))}bX(){Oe.a(8701125,307,!!this.vv);Oe.a(8701126,307,Ya.ParagraphReader.Lk(this.wb));
Oe.a(8701127,307,0>=this.vv.zL);this.vv.gMd()}static get Jh(){return Tt.xi||(Tt.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}}Tt.xi=null;Object(e.a)(Tt,"TextOnlyBox4TableSteward",null,[401,402]);class tC{constructor(a,b,c=!1,f=!1,l=!1){this.Jo=a;this.PC=b;this.amb=c;this.DPb=f;this.Uyd=l}create(a,b){return 1===a?new Tt(b,this.Jo,this.PC):new rx(b,this.Jo,this.PC,this.amb,this.DPb,this.Uyd)}}Object(e.a)(tC,"Box4TableStewardFactory",null,[374]);class HI{create(){return new En.a}}Object(e.a)(HI,
"Factory",null,[1148]);class II{Wb(a){a.register(sC,"Box4.Actors.Box4PasteStewardFactory").as("Box4.Actors.IBox4PasteStewardFactory").ma().na(()=>new sC(Yu.a.osb,a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.Actors.IBox4PasteStewardBridge")));a.register(UB,"Box4.Actors.Box4PasteStewardUtils").as("Box4.Actors.IBox4PasteStewardUtils").ma().na(()=>new UB(u.AFrameworkApplication.fa.ka("WacPasteBrAsNewParagraphIsEnabled")));a.register(xH.ClipboardActor,"Box4.Actors.ClipboardActor").ma().na(()=>
new xH.ClipboardActor(a.Be("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),Sa.a.instance,a.resolve("Box4.IClipboardDataHelper"),ld.a.instance,u.AFrameworkApplication.Ta,a.resolve("Box4.IUndoManager"),u.AFrameworkApplication.fa));a.register(1143,"Common.App.ChromeExtensionHelper.IChromeExtensionHelper").ma().na(()=>new UA(u.AFrameworkApplication.fa));a.register(1144,"Box4.Clipboard.ISystemClipboardAccessManagerFactory").ma().na(()=>new vI(u.AFrameworkApplication.fa,
a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),Cb.a.instance));a.register(1145,"Box4.Clipboard.ISystemClipboardAccessManager").ma().na(()=>a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create());a.register(1146,"Box4.Actors.ISystemClipboard").ma().na(()=>new rI(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),pa.InteractiveViewManager.instance,Gb.App.Fb.Ed,v.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.IEditViewStateManager"),Cb.a.instance));a.register(270,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().na(()=>new AH);a.register(271,"Box4.Actors.IDeleteTableSegmentStrategy").ma().na(()=>new wI);a.register(1147,"Box4.ISelectionFactory").ma().na(()=>new FI);a.register(1148,"Box4.IRenderOrderGraphIteratorFactory").ma().na(()=>new HI);a.register(1149,"Common.IDomElementContentStateFactory").ma().na(()=>new eH);a.register(1150,"Box4.Actors.IClipboardOperationPasteOvertypeStrategy").ma().na(()=>
new MH(ld.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IStyleReader"),H.a.instance.ga(71)));a.register(nC,"Box4.Actors.PasteFloatieFeatureSetBuilder").ma().na(()=>new nC(a.resolve("Box4.IClipboardDataHelper"),Gb.App.YC.VR));a.register(1151,"Box4.Actors.IClipboardOperationPasteFactory").ma().na(()=>new KH(Sa.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),eg.a.instance,ld.a.instance,u.AFrameworkApplication.Ta,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),
a.Be("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(251,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().na(()=>new zH(u.AFrameworkApplication.Ta,Sa.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),ld.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),
mg.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper")));a.register(1152,"Box4.Actors.IClipboardOperationClipboardAccessHelper").ma().na(()=>new yH(Sa.a.instance,Cb.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),
u.AFrameworkApplication.fa.appSettings.ChromeClipboardAccessOperationTimeout));a.register(1153,"Box4.Actors.IClipboardOperationPasteStrategyFactory").ma().na(()=>new PH(u.AFrameworkApplication.fa));a.register(1154,"Box4.Actors.IClipboardOperationFactory").ma().na(()=>new IH(a.resolve("Box4.Actors.InternalClipboard"),u.AFrameworkApplication.Ta,u.AFrameworkApplication.Wgd()&&!(n.a.yS&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")),Sa.a.instance,mg.a.instance,Cb.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),
a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),
a.resolve("Common.Utils.Telemetry.ITelemetry")));a.register(1155,"Box4.Actors.IExternalPasteExecutionManagerFactory").ma().na(()=>new $H(a.Be("Box4.Actors.IBox4PasteStewardFactory"),a.Be("Box4.Actors.IBox4ImageStewardFactory"),a.Be("Box4.Actors.IBox4TableStewardFactory"),a.Be("Box4.Actors.IBox4WordConverterFactory"),a.resolve("HtmlImport.IHtmlTranslatorSettings"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings")));
a.register(Oh,"Box4.Actors.InternalClipboard").ma().na(()=>new Oh(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.ITableEditor"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),Gb.App.sO,a.resolve("Box4.IParagraphIndentationReader"),u.AFrameworkApplication.fa,a.resolve("Box4.Graph.IGraphNodeFactory"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").Fjh,a.resolve("Box4.IFormattingPropertyTransitStrategy")));a.register(1156,"Box4.Actors.IInternalPasteExecutionManagerFactory").ma().na(()=>new mI(a.resolve("Box4.Actors.InternalClipboard"),new le.a(()=>Gb.App.Fb.Ed.en)));a.register(1157,"Box4.List.IListCommands").ma().na(()=>new xI(u.AFrameworkApplication.Ta));a.register(Nr,"Box4.Actors.PasteCoordinator").ma().na(()=>new Nr(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory")));H.a.instance.ga(78)||a.register(tC,"Box4.Actors.Box4TableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().na(()=>new tC(hb.a.instance.resolve("Box4.List.IListEditor"),hb.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").ka("TablePasteRefactoringAndFixesIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("PasteComplexTablesIsEnabled"),
a.resolve("Common.IAppSettingsManager").ka("PasteTableCellMarginImprovementsIsEnabled")));a.register(fC,"Box4.Actors.ClipboardOperationWordStrategy").ma().na(()=>new fC(Sa.a.instance,ld.a.instance,Gb.App.Eh,Qg.a.instance,H.a.instance.ga(14),H.a.instance.ga(50)));a.register(cC,"Box4.Actors.Box4WordConverterFactory").as("Box4.Actors.IBox4WordConverterFactory").ma().na(()=>new cC(u.AFrameworkApplication.fa));a.register(1158,"Box4.Actors.IExternalPasteCssConverter").ma().na(()=>new QH(u.AFrameworkApplication.fa));
a.register(1159,"Box4.ISelectionCommands").ma().na(()=>new EI(u.AFrameworkApplication.Ta));a.register(1160,"Box4.ITextFormattingCommands").ma().na(()=>new DI(u.AFrameworkApplication.Ta));a.register(SB,"Box4.Actors.AccessibilityActor").ma().na(()=>new SB(a.La("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor")));a.register(xq,"Box4.Actors.InsertionPointFormatting").as("Box4.IInsertionPointFormatting").ma().na(()=>new xq(a.pb("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy")));
a.register(qC,"Box4.Actors.ProofingActor").ma().na(()=>new qC(hb.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),u.AFrameworkApplication.Ta,()=>hb.a.instance.resolve("Box4.UI.ILanguageDialog"),hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),hb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),ld.a.instance,hb.a.instance.La("Box4.IExternalSelectionManager"),mg.a.instance,hb.a.instance.resolve("Box4.ISelectionContextMenuProvider"),Qg.a.instance,Sa.a.instance,hb.a.instance.resolve("Box4.IContextMenuController"),
hb.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),hb.a.instance.La("Box4.Actors.IProofingErrorPresenter"),H.a.instance));a.register(rC,"Box4.Actors.StyleActor").ma().na(()=>new rC(hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),hb.a.instance.resolve("Box4.Styles.IStyleEditor"),PP.a.instance,hb.a.instance.resolve("Box4.IFormattingEditor"),Rg.ContextSetEditor.instance,hb.a.instance.resolve("Box4.IInsertionPointFormatting"),Qg.a.instance,Sa.a.instance,hb.a.instance.resolve("Box4.TextFormattingHelper"),
St.instance));a.register(ud,"Box4.Actors.TextFormattingActor").ma().na(()=>new ud(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.Actors.IEopFormattingStrategy"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.IHyperlinkStrategy"),pa.InteractiveViewManager.instance));a.register(TB,"Box4.Actors.AutoCorrectActor").ma().na(()=>new TB(u.AFrameworkApplication.Ta,Sa.a.instance,()=>hb.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog")))}}Object(e.a)(II,
"Box4ActorsComponentConfiguration",null,[3]);const RP=(a,b,c)=>Gb.App.sRd?8:2===c?(a=new rj.StandardDialog,a.vd=4,a.fwa(1),a.Re(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Re(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.Fcl(QP),32):2,QP=a=>{1===a&&u.AFrameworkApplication.Ta.processAction(C.a.eSd,2)},JI=(a,b,c)=>{if(Gb.App.sRd)return 8;if(1===c)return b.node.Sa(bb.a.embeddedFileContainer)?32:2;if(2===c&&(b.contextId===Fb.a.view&&b.view.Eb&&(b=b.view.Eb.Dj),eb.EmbeddedFileReader.jFj(b))){a=
eb.EmbeddedFileReader.EYd(b.node);Hi.a.K6k();try{SP(a)}catch(f){Z.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",f)}}return 32},SP=a=>{if(1!==Gb.App.mode||!u.AFrameworkApplication.fa.ka("OneNoteSaveFileThroughRequest")||u.AFrameworkApplication.fa.ka("IsTeamsSession")&&n.a.yS)window.open(a);else{var b=(new Lj.QueryStringBuilder(a)).e9i(),c=new XMLHttpRequest;c.onloadstart=()=>{c.responseType="blob"};c.open("GET",a,!0);c.onload=()=>{try{const F=c.response;let R=b;R||(R="GetImage",
F.type&&-1!=F.type.indexOf("image/")&&"bmp gif ico jpeg png svg tiff webp".split(" ").forEach(fa=>{-1!=F.type.indexOf(fa)&&(R="GetImage."+fa)}));R=decodeURIComponent(escape(R));if(n.a.AS)"undefined"!==typeof navigator.msSaveBlob?navigator.msSaveBlob(F,R):window.open(a);else{var f=window.URL||window.webkitURL,l=f.createObjectURL(F),x=document.createElement("a");x.href=l;x.download=R;document.body.appendChild(x);x.click();setTimeout(()=>{document.body.removeChild(x);f.revokeObjectURL(l)},0)}}catch(F){window.open(a)}};
c.send()}};var TP=d(545),yq=d(1187),kv;(function(a){a[a.automatic=1]="automatic";a[a.clear=2]="clear";a[a.themeColors=3]="themeColors";a[a.standardColors=4]="standardColors";a[a.recentColors=5]="recentColors"})(kv||(kv={}));Object(e.b)("ColorMenuControls",kv);class sx{constructor(a){this.SOb=this.TOb=null;this.Hpc={};this.g1=a}S2b(){this.SOb=this.TOb=null}D5f(a,b){if(this.SOb)return this.SOb;if(!a)return null;const c=Object.assign(new sk.a,{Id:String.format("menu{0}Color",this.g1),ExternalId:String.format("{0}Color",
this.g1)});c.MenuSectionList=[];Array.add(c.MenuSectionList,this.gZh());Array.add(c.MenuSectionList,this.pZh());Array.add(c.MenuSectionList,this.I1h(a,b));Array.add(c.MenuSectionList,this.r1h());return this.SOb=c}Yvi(a,b){if(this.TOb)return this.TOb;a=this.D5f(a,b);return this.TOb=ej.l(a)}fzc(a,b){kv[a]in this.Hpc||(this.Hpc[kv[a]]=b)}M1h(a){a.kAf(Object(D.a)(this,this.S2b,"invalidateMenu"),1)}gZh(){if(!({actionId:b}=this.Akd(1)).returnValue)return null;const a=Object.assign(new Si.a,{Id:String.format("{0}Color",
this.g1),ControlsId:String.format("{0}.Color.Menu.Controls",this.g1),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new Of.a,{Command:b.toString(),LabelText:Ma.a.ie(Box4Intl.Box4Strings.L_Automatic),Image16by16:u.AFrameworkApplication.Vl,Image16by16Class:kq.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});Array.add(a.ControlList,b);return a}pZh(){if(!({actionId:b}=this.Akd(2)).returnValue)return null;const a=Object.assign(new Si.a,{Id:String.format("{0}Color",
this.g1),ControlsId:String.format("{0}.Color.Menu.Controls",this.g1),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new Of.a,{Command:b.toString(),LabelText:Ma.a.ie(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:u.AFrameworkApplication.Vl,Image16by16Class:kq.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});Array.add(a.ControlList,b);return a}I1h(a,b){if(!({actionId:f}=this.Akd(3)).returnValue)return null;const c=Object.assign(new Si.a,{Id:"Colors",
ControlsId:String.format("{0}.Color.Menu.Controls",this.g1),ControlList:[]});var f=Object.assign(new Ny.a,{Id:String.format("Theme{0}ColorPicker",this.g1),ExternalId:String.format("Theme{0}ColorPicker",this.g1),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.g1),McuLayout:!0,Command:f.toString(),Width:10});f.Colors=sx.tfj(a,b);Array.add(c.ControlList,f);return c}r1h(){if(!({actionId:b}=this.Akd(4)).returnValue)return null;const a=Object.assign(new Si.a,{Id:String.format("{0}Colors",this.g1),
ControlsId:String.format("{0}.Color.Menu.Controls",this.g1),Title:Ma.a.ie(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var b=Object.assign(new Ny.a,{Id:String.format("Standard{0}ColorPicker",this.g1),ExternalId:String.format("Standard{0}ColorPicker",this.g1),Command:b.toString(),Width:10,Colors:[]});b.Colors=sx.zdj();Array.add(a.ControlList,b);return a}Akd(a){a=kv[a];return a in this.Hpc?{returnValue:!0,actionId:this.Hpc[a]}:{returnValue:!1,actionId:0}}static zdj(){const a=[];a.push(Object.assign(new yq.a,
{Color:"0000C0",Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));a.push(Object.assign(new yq.a,{Color:"0000FF",Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));a.push(Object.assign(new yq.a,{Color:"00C0FF",Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));a.push(Object.assign(new yq.a,{Color:"00FFFF",Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));a.push(Object.assign(new yq.a,{Color:"50D092",
Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));a.push(Object.assign(new yq.a,{Color:"50B000",Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));a.push(Object.assign(new yq.a,{Color:"F0B000",Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));a.push(Object.assign(new yq.a,{Color:"C07000",Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));a.push(Object.assign(new yq.a,{Color:"602000",
Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));a.push(Object.assign(new yq.a,{Color:"A03070",Alt:Ma.a.ie(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return a}static tfj(a,b){const c=a.properties.sa(Bb.a.themeColors,null);a=a.properties.getValue(Bb.a.Yvh).split(" ");const f=Array(10);f[0]=Box4Intl.Box4Strings.l_ThemeLabel1;f[1]=Box4Intl.Box4Strings.l_ThemeLabel2;f[2]=Box4Intl.Box4Strings.l_ThemeLabel3;f[3]=Box4Intl.Box4Strings.l_ThemeLabel4;f[4]=
Box4Intl.Box4Strings.l_ThemeLabel5;f[5]=Box4Intl.Box4Strings.l_ThemeLabel6;f[6]=Box4Intl.Box4Strings.l_ThemeLabel7;f[7]=Box4Intl.Box4Strings.l_ThemeLabel8;f[8]=Box4Intl.Box4Strings.l_ThemeLabel9;f[9]=Box4Intl.Box4Strings.l_ThemeLabel10;const l=[];for(let R=0;6>R;R++)for(let fa=0;10>fa;fa++){var x=10*R+fa,F=c[x];x=x+1<<24;F=F&4278190080|(F&255)<<16|F&65280|(F&16711680)>>>16;const wa=sx.$ml(f,R,fa,b[a[fa]],c[fa]);l.push(Object.assign(new yq.a,{Color:Ma.a.Gv(x,8),DisplayColor:"#"+Ma.a.Gv(F,6),Alt:Ma.a.ie(wa)}))}return l}static $ml(a,
b,c,f,l){if(b){var x=l&255,F=(l&65280)>>>8;l=(l&16711680)>>>16;x=Math.floor((Math.min(Math.min(x,F),l)+Math.max(Math.max(x,F),l))/2);--b;x?255===x?(x=!0,b=[242,217,191,166,127][b]):204<x?(x=!1,b=[229,191,127,64,25][b]):51>x?(x=!0,b=[25,64,127,191,229][b]):(F=[51,102,153],l=[191,127],b=(x=b<F.length)?F[b]:l[b-F.length]):(x=!1,b=[127,166,191,217,242][b]);b=255-b;return String.format(x?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,f,a[c],Math.round(100*
b/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,f,a[c])}}Object(e.a)(sx,"ColorMenu",null,[1135]);class cr{constructor(a){this.Gpc=null;this.jQh=a}get u4f(){this.Gpc||(this.Gpc=new sx(cr.Joi),this.Gxj(this.Gpc));return this.Gpc}Gxj(a){a.fzc(1,C.a.eV);a.fzc(3,C.a.Ss);a.fzc(4,C.a.Ss);a.fzc(5,C.a.Ss);a.M1h(this.jQh)}ub(){const a=u.AFrameworkApplication.Ta;a.xa(C.a.hDb,Fb.a.view,Object(D.a)(this,this.hDb,"populateFontColor"));a.$d(C.a.hDb,1127)}hDb(a,b,c,f,l){if(1===c)return 32;
if(2===c&&!l)return 8;a=cr.sk.S8i(b);if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp){b=this.u4f.D5f(a,Gb.App.yOf);if(!b)return 8;l.MenuItems=b}a=this.u4f.Yvi(a,Gb.App.yOf);if(!a)return 8;l.PopulationXML=a;return 32}static v3i(){return new cr(TP.a.instance)}static get instance(){return cr.it||(cr.it=cr.v3i())}static get sk(){return Pw.PageReader.instance}}cr.Joi="Font";cr.it=null;Object(e.a)(cr,"FontColorActor",null,[]);class gf{constructor(a){this.Ffa=this.Lo=this.b1=null;this.ENb=
!1;this.Eg=pa.InteractiveViewManager.instance.Ld;this.Fj=a;gf.GR&&fb.SelectionEditor.Pj(a)&&(a=fb.SelectionEditor.Jmc(this.Fj),fb.SelectionEditor.Pj(a)?this.Fj=a:Z.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=fb.SelectionEditor.OIb(this.Fj);fb.SelectionEditor.Pj(a)&&(this.Fj=a)}get z7(){return this.b1||(this.b1=hb.a.instance.pb("Box4.IInternalLinkManager"))}get k5(){return this.Lo||(this.Lo=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get Bmg(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}I0f(a,
b,c){if(b!==this.Fj.Kb||a!==this.Fj.Qa)a=nd.SelectionFactory.P1(c,a,b),this.Eg.Eb.setSelection(a),this.Fj=fb.SelectionEditor.OIb(a.Ua.clone())}H8f(a){let b,c,f,l;l=Rb.HyperlinkReader.g0b(this.Fj);c=this.Fj.Qa;f=this.Fj.Kb;b="";if(!l.length)return this.Ffa=a.substring(this.Fj.Qa,this.Fj.Kb),{returnValue:!0,Hed:b,mIc:c,nIc:f,BPc:l};if(l[0].hyperlink){let x,F=0,R=Math.max(0,a.length-1),fa=0;for(let wa=0;wa<l.length;wa++)l[wa].Qa>=F&&({Qa:x,Kb:F}=gf.yt.kZ(this.Fj,l[wa]),R=Math.min(x,R),fa=Math.max(F,
fa));c=Math.min(R,c);f=Math.max(fa,f);this.Ffa=a.substring(c,f);c===R&&(b=l[0].hyperlink.url);return{returnValue:!0,Hed:b,mIc:c,nIc:f,BPc:l}}return{returnValue:!1,Hed:b,mIc:c,nIc:f,BPc:l}}sQc(a,b){if(this.Eg.Ro){var c=gf.Ira?Rb.HyperlinkReader.g0b(this.Fj):Rb.HyperlinkReader.FB(this.Fj,!0);var f=this.Eg.Eb.Oa.kb;if(f){f=f.Ua;Ya.ParagraphReader.Xl(f)&&(f=Pc.a.createTextRange(f.node,0,Ya.ParagraphReader.textLength(f.node)));if(gf.GR&&fb.SelectionEditor.Pj(f)){var l=fb.SelectionEditor.Jmc(f);fb.SelectionEditor.Pj(l)?
f=l:Z.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}l=fb.SelectionEditor.OIb(f);fb.SelectionEditor.Pj(l)&&(f=l);0===a||H.a.instance.ga(22)&&32!==u.AFrameworkApplication.Ta.ii(f,C.a.insertHyperlink,1,!0,null,null)||this.LHj(c)||!this.Fj.equals(f)?this.Eg.TQ():(N.a.mark(5562),H.a.instance.ga(50)&&Gb.App.Eh&&Gb.App.Eh.Qv&&this.Eg.Eb.nSb(),a=new We.GraphTransaction(15),a.fd(this.Fj.node),this.Fj.node.mG().graphTransactionOperations.Uga(4),
f=b.txtDisplay,b=b.txtLink.trim(),this.insertLink(f,b,c),a.dispose(),N.a.mark(5563),this.E1())}else Z.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}LHj(a){return gf.Ira?!1:1<a.length||1===a.length&&(a[0].Qa>this.Fj.Qa||a[0].Kb<this.Fj.Kb)}insertLink(a,b,c){var f=null;a||(a=b);if(b&&(!c.length||b!==c[0].hyperlink.url)){b=Rb.HyperlinkReader.YBa(b);var l="";this.z7&&({zbh:l}=this.z7.Mxh(b,!1)).returnValue&&(b=l)}this.ENb||(a=gf.hyperlinkEditor.ZRk(a));
if((!c.length||gf.Ira)&&b)(f=0<c.length)&&gf.yt.wEb(this.Fj,c),c=!0,gf.WHj&&(c=Ya.ParagraphReader.text(this.Fj.node).substring(this.Fj.Qa,this.Fj.Kb)!==a),c&&gf.characterPropertiesEditor.replaceTextRange(this.Fj,a,!0),c=Pc.a.createTextRange(this.Fj.node,this.Fj.Qa,this.Fj.Qa+a.length),gf.hyperlinkEditor.qha(c,b,f,!1),f=nd.SelectionFactory.Jg(this.Fj.node,this.Fj.Qa+a.length);else if(0<c.length){l=c[0];let x;const F=({Qa:c,Kb:x}=gf.yt.kZ(this.Fj,l)).returnValue;if(b)if(l.hyperlink.TQa){if(b!==l.hyperlink.url)if(gf.Nf.EIb){let R=
Pc.a.createTextRange(this.Fj.node,c,c+a.length);gf.hyperlinkEditor.bJi(R,l.hyperlink,b)}else gf.yt.fBh(b,F);a!==this.Ffa&&(gf.yt.Lse()&&gf.yt.wEb(this.Fj,F),gf.characterPropertiesEditor.replaceTextRange(Pc.a.createTextRange(this.Fj.node,c,x),a,!0),f=Pc.a.createTextRange(this.Fj.node,c,c+a.length),gf.yt.Lse()&&gf.hyperlinkEditor.qha(f,b,!1),f=nd.SelectionFactory.Jg(this.Fj.node,c+a.length))}else gf.yt.wEb(this.Fj,F),gf.characterPropertiesEditor.replaceTextRange(Pc.a.createTextRange(this.Fj.node,c,
x),a,!0),f=Pc.a.createTextRange(this.Fj.node,c,c+a.length),gf.hyperlinkEditor.qha(f,b,!1),f=nd.SelectionFactory.Jg(this.Fj.node,c+a.length);else gf.hyperlinkEditor.hO(l.paragraph,l.hyperlink)}f&&this.Eg.Eb.setSelection(f)}static get hyperlinkEditor(){return gf.Xm||(gf.Xm=hb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return gf.Vg||(gf.Vg=hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Nf(){return gf.Wc||(gf.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get yt(){return gf.JC||
(gf.JC=hb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Ira(){null==gf.KZa&&(gf.KZa=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return gf.KZa}static get WHj(){null==gf.Hud&&(gf.Hud=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("KeepHyperlinkFormatFixIsEnabled"):!1);return gf.Hud}static get m8a(){null==gf.t0a&&(gf.t0a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return gf.t0a}static get GR(){null==
gf.bM&&(gf.bM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return gf.bM}}gf.Xm=null;gf.Vg=null;gf.Wc=null;gf.JC=null;gf.KZa=null;gf.Hud=null;gf.t0a=null;gf.bM=null;gf.source="Source";gf.NOf="CommandingInterface";gf.G4a="DisplayText";gf.url="Url";gf.id="InsertLinkDialog";Object(e.a)(gf,"AInsertLinkDialog",null,[106]);class tx{static get jg(){return Vh.a.EB(tx.Zn,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}
tx.Zn="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(e.a)(tx,"InsertLinkDialogHtml",null,[]);class KI extends gf{constructor(a,b){super(a,b);this.tf=
new Vh.a;this.tf.kg=gf.id;var c=this.Ffa="";const f=Ya.ParagraphReader.text(this.Fj.node);let l=this.Fj.Qa,x=this.Fj.Kb,F;gf.Ira?{Hed:c,mIc:l,nIc:x,BPc:F}=this.H8f(f):(F=Rb.HyperlinkReader.FB(this.Fj,!0),1===F.length&&F[0].Qa<=this.Fj.Qa&&F[0].Kb>=this.Fj.Kb&&F[0].hyperlink?(this.Ffa=gf.yt.PLc(a,F[0],f),c=F[0].hyperlink.url):F.length||(this.Ffa=f.substring(this.Fj.Qa,this.Fj.Kb)));(b=Object(va.a)(Object,b))&&(b[gf.source]&&b[gf.source]===gf.NOf||b[gf.url]&&b[gf.G4a])?this.insertLink(b[gf.G4a],b[gf.url],
F):(gf.Ira&&F[0]&&this.I0f(l,x,F[0].paragraph),this.tf.jg=tx.jg,""===c.trim()&&this.tf.Re(1,this.Bmg),c={["txtLink"]:c,["txtDisplay"]:this.Ffa},this.tf.qGc=Object(D.a)(this,this.KM,"dialogDefaultEnterKeyHandler"),this.tf.pGc=Object(D.a)(this,this.KM,"dialogDefaultEnterKeyHandler"),this.tf.pj(this.titleText,Object(D.a)(this,this.sQc,"insertLinkDialogHandler"),c),gf.m8a&&(c=document.getElementById("txtLink"),yd.a.addHandler(c,qa.a.input,Object(D.a)(this,this.GGa,"onLinkChanged")),yd.a.addHandler(c,
qa.a.change,Object(D.a)(this,this.GGa,"onLinkChanged"))),document.getElementById("txtLink").focus(),gf.GR?0<fg.h(Pc.a.VNa(l,x,!1,this.Fj.node)).length&&(this.ENb=!0,document.getElementById("txtDisplay").disabled=!0):1>=F.length&&gf.yt.xNd(a,F[0],1===F.length)&&(this.ENb=!0,document.getElementById("txtDisplay").disabled=!0))}GGa(){if(this.tf){const a=document.getElementById("txtLink");this.tf.sC(1,!a||!a.value.length||Rb.HyperlinkReader.zae(a.value))}}KM(a){return this.tf?gf.m8a?this.tf.R6f(this.tf.njb)?
this.tf.KM(a):!1:this.tf.KM(a):!1}E1(){if(gf.m8a){const a=document.getElementById("txtLink");a&&(yd.a.removeHandler(a,qa.a.change,Object(D.a)(this,this.GGa,"onLinkChanged")),yd.a.removeHandler(a,qa.a.input,Object(D.a)(this,this.GGa,"onLinkChanged")))}this.tf&&(this.tf=null)}}Object(e.a)(KI,"InsertLinkDialog",gf,[]);class LI extends gf{constructor(a,b,c){super(a,b);const f=new Vh.a(!1,!1,!0),l={};l.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;l.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
l.textDisplayInitialFocus=c;c=this.Ffa="";const x=Ya.ParagraphReader.text(this.Fj.node);let F=this.Fj.Qa,R=this.Fj.Kb,fa;gf.Ira?{Hed:c,mIc:F,nIc:R,BPc:fa}=this.H8f(x):(fa=Rb.HyperlinkReader.FB(this.Fj,!0),1===fa.length&&fa[0].Qa<=this.Fj.Qa&&fa[0].Kb>=this.Fj.Kb&&fa[0].hyperlink?(this.Ffa=gf.yt.PLc(a,fa[0],x),c=fa[0].hyperlink.url):fa.length||(this.Ffa=x.substring(this.Fj.Qa,this.Fj.Kb)));(b=Object(va.a)(Object,b))&&(b[gf.source]&&b[gf.source]===gf.NOf||b[gf.url]&&b[gf.G4a])?this.insertLink(b[gf.G4a],
b[gf.url],fa):(gf.Ira&&fa[0]&&this.I0f(F,R,fa[0].paragraph),b=CommonUIStrings.l_DialogOk,""===c.trim()&&(b=this.Bmg),f.Re(1,b),l.txtLink=c,l.txtDisplay=this.Ffa,gf.GR?0<fg.h(Pc.a.VNa(F,R,!1,this.Fj.node)).length&&(this.ENb=!0,l.textDisplayDisabled=!0):1>=fa.length&&gf.yt.xNd(a,fa[0],1===fa.length)&&(this.ENb=!0,l.textDisplayDisabled=!0),a={["id"]:gf.id,["bodyControls"]:l},f.pj(this.titleText,Object(D.a)(this,this.sQc,"insertLinkDialogHandler"),a))}E1(){}}Object(e.a)(LI,"ReactInsertLinkDialog",gf,
[]);class Ut{constructor(){this.boa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.QB}ZRf(a,b,c){this.boa?new LI(a,b,c):new KI(a,b)}static get instance(){return Ut.Ja||(Ut.Ja=new Ut)}}Ut.Ja=null;Object(e.a)(Ut,"InsertLinkDialogFactory",null,[1136]);class Xk extends Vh.a{constructor(a){super();this.PJ=a;this.Eg=pa.InteractiveViewManager.instance.Ld;this.C1a=this.Eg.Eb.Oa.kb;this.vVd=a[0].Qa;this.abe=a[a.length-1].Kb;this.kg="InsertMultiParagraphLinkDialog";a=this.hul();this.showDialog("",
a)}showDialog(a,b){Z.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.jg=tx.jg;""===b.trim()&&this.Re(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:b,["txtDisplay"]:a};this.pj(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(D.a)(this,this.sQc,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;Xk.m8a&&(a=document.getElementById("txtLink"),yd.a.addHandler(a,qa.a.input,Object(D.a)(this,
this.GGa,"onLinkChanged")),yd.a.addHandler(a,qa.a.change,Object(D.a)(this,this.GGa,"onLinkChanged")))}hide(){if(Xk.m8a){const a=document.getElementById("txtLink");a&&(yd.a.removeHandler(a,qa.a.change,Object(D.a)(this,this.GGa,"onLinkChanged")),yd.a.removeHandler(a,qa.a.input,Object(D.a)(this,this.GGa,"onLinkChanged")))}super.hide()}GGa(){const a=document.getElementById("txtLink");this.sC(1,!a||!a.value.length||Rb.HyperlinkReader.zae(a.value))}KM(a){return Xk.m8a?this.R6f(this.njb)?super.KM(a):!1:
super.KM(a)}hul(){let a;let b;a="";const c=this.PJ.length,f=Rb.HyperlinkReader.FB(this.PJ[0],!1);0<f.length&&({Qa:l,Kb:b}=Xk.yt.kZ(this.PJ[0],f[0]),l<=this.PJ[0].Qa&&(a=f[0].hyperlink.url),this.vVd=Math.min(this.vVd,l));var l=Rb.HyperlinkReader.FB(this.PJ[c-1],!1);0<l.length&&({Qa:l,Kb:b}=Xk.yt.kZ(this.PJ[c-1],l[l.length-1]),this.abe=Math.max(this.abe,b));this.spl(this.vVd,this.abe);return a}spl(a,b){const c=this.PJ.length;if(a!==this.PJ[0].Qa||b!==this.PJ[c-1].Kb){a=Pc.a.Uj(this.PJ[0].node,a);a=
nd.SelectionFactory.eu(a);b=Pc.a.Uj(this.PJ[c-1].node,b);b=nd.SelectionFactory.PM(a,b);a=this.Eeg(b.Ua.clone());const f=this.Eeg(b.Te.clone());a&&f&&(this.PJ[0]=a,this.PJ[c-1]=f,this.Eg.Eb.setSelection(b),this.C1a=b)}}sQc(a,b){if(this.Eg.Ro){var c=this.Eg.Eb.Oa.kb;if(c)if(c.equals(this.C1a)&&0!==a){a=new We.GraphTransaction(15);a.fd(this.PJ[0].node);for(c=0;c<this.PJ.length;c++)this.PJ[c].node.mG().graphTransactionOperations.Uga(4);b=b.txtLink.trim();this.aEi();this.jzj(b);this.hide();a.dispose()}else this.Eg.TQ()}}jzj(a){if(a){a=
Rb.HyperlinkReader.YBa(a);for(let c=0;c<this.PJ.length;c++){var b=this.PJ[c];if(Xk.GR&&fb.SelectionEditor.Pj(b)&&(b=fb.SelectionEditor.Jmc(b),!fb.SelectionEditor.Pj(b)))continue;b=Pc.a.createTextRange(this.PJ[c].node,b.Qa,b.Kb);Xk.hyperlinkEditor.qha(b,a,!1)}}}Eeg(a){return Ya.ParagraphReader.Xl(a)&&!fb.SelectionEditor.JV(a)&&Ya.ParagraphReader.textLength(a.node)?Pc.a.createTextRange(a.node,0,Ya.ParagraphReader.textLength(a.node)):fb.SelectionEditor.Pj(a)?a:null}aEi(){let a=!1;for(const b of this.PJ){const c=
Rb.HyperlinkReader.FB(b,!1);c&&(a=Xk.yt.wEb(b,c)||a)}}static get yt(){return Xk.JC||(Xk.JC=hb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Nf(){return Xk.Wc||(Xk.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Xk.Xm||(Xk.Xm=hb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get GR(){null==Xk.bM&&(Xk.bM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Xk.bM}static get m8a(){null==
Xk.t0a&&(Xk.t0a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return Xk.t0a}}Xk.JC=null;Xk.Wc=null;Xk.Xm=null;Xk.bM=null;Xk.t0a=null;Object(e.a)(Xk,"InsertMultiParagraphLinkDialog",Vh.a,[]);class ve{static get Wi(){return Qg.a.instance}static get hyperlinkEditor(){return ve.Xm||(ve.Xm=hb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get yt(){return ve.JC||(ve.JC=hb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static Mq(){return ve.nm||(ve.nm=
hb.a.instance.La("Box4.IExternalSelectionManager"))}static get Nf(){return ve.Wc||(ve.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Emc(){return ve.QC||(ve.QC=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get NJb(){null==ve.mnd&&(ve.mnd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("ViewAndOpenImageHyperlinksIsEnabled"):!1);return ve.mnd}static get Ira(){null==ve.KZa&&(ve.KZa=u.AFrameworkApplication.fa?
u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return ve.KZa}static get lcc(){null==ve.LZa&&(ve.LZa=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return ve.LZa}static get GR(){null==ve.bM&&(ve.bM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ve.bM}static ub(){const a=u.AFrameworkApplication.Ta;a.xa(C.a.insertHyperlink,Fb.a.view,ve.rtb);a.xa(C.a.insertHyperlink,
Fb.a.Lf,ve.insertLink);a.xa(C.a.insertHyperlink,Fb.a.textRange,ve.insertLink);a.$d(C.a.insertHyperlink,1028);a.xa(C.a.hO,Fb.a.view,ve.rtb);a.xa(C.a.hO,Fb.a.Lf,ve.ech);a.xa(C.a.hO,Fb.a.textRange,ve.ech);a.$d(C.a.hO,1028);a.xa(C.a.MGe,Fb.a.view,ve.rtb);a.xa(C.a.MGe,Fb.a.Lf,ve.Pih);a.xa(C.a.MGe,Fb.a.textRange,ve.Pih);a.xa(C.a.nWa,Fb.a.view,ve.rtb);a.xa(C.a.nWa,Fb.a.Lf,ve.N1g);a.xa(C.a.nWa,Fb.a.textRange,ve.N1g);a.xa(C.a.nWa,Fb.a.image,ve.Jwe);a.xa(C.a.nWa,Fb.a.tZb,ve.Jwe);a.xa(C.a.g2b,Fb.a.view,ve.rtb);
a.xa(C.a.g2b,Fb.a.Lf,ve.linkText);a.xa(C.a.g2b,Fb.a.textRange,ve.linkText);a.$d(C.a.g2b,1028);ve.NJb&&a.xa(C.a.nWa,Fb.a.anchoredObject,ve.Jwe);a.xa(C.a.aOd,Fb.a.view,ve.rtb)}static rtb(a,b,c,f,l){if(ve.lcc)return ve.btj(a,b,c,f,l);if(!b.view.Hh)return 2;var x=b.view.Eb;if(!x||!x.Oa||!x.Oa.length)return 8;var F=x.Oa.kb;let R=F.Ua.clone();if(2===F.length){if(F=F.ga(1),!fb.SelectionEditor.Pj(R)||!fb.SelectionEditor.Cl(F)||R.node!==F.node)return 8}else if(2<F.length)return 8;if(x.Oa.xG)return 8;Ya.ParagraphReader.Xl(R)&&
!fb.SelectionEditor.JV(R)&&(x=R.node,R=Pc.a.createTextRange(x,0,Ya.ParagraphReader.textLength(x)));return a===C.a.aOd?ve.MQf(b,R,c,f,l):u.AFrameworkApplication.Ta.ii(R,a,c,!0,f,l)}static btj(a,b,c,f,l){if(!b.view.Hh)return 2;var x=b.view.Eb;if(!x||!x.Oa||!x.Oa.length||x.Oa.xG)return 8;var F=x.Oa.kb;if(x=ve.J4b(F))F=ve.v1d(F.Ua.clone(),!0);else{let R=F.ga(0).clone(),fa=1;for(;fa<F.length&&(!Ya.ParagraphReader.textLength(R.node)||fb.SelectionEditor.Cl(R)||ve.GR&&fg.m(R));)R=F.ga(fa).clone(),fa++;F=
ve.v1d(R,!1)}return ve.GR&&fb.SelectionEditor.Pj(F)&&fg.m(F)||!fb.SelectionEditor.Pj(F)&&!x?8:a===C.a.aOd?ve.MQf(b,F,c,f,l):u.AFrameworkApplication.Ta.ii(F,a,c,!0,f,l)}static J4b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua.clone();a=a.ga(1);return fb.SelectionEditor.Pj(b)&&fb.SelectionEditor.Cl(a)&&b.node===a.node?!0:!1}return!1}static rPf(a){let b;b=null;const c=[];for(let f=0;f<a.length;f++){const l=ve.v1d(a.ga(f).clone(),!1);if(fb.SelectionEditor.Pj(l))ve.GR&&fg.m(l)||Array.add(c,
l);else if(!fb.SelectionEditor.Cl(l)&&!Ya.ParagraphReader.Xl(l))return{returnValue:!1,QNd:b}}b=Pa.a.uIb(c);return{returnValue:!ve.GR||0<b.length?!0:!1,QNd:b}}static Jmg(a,b,c,f){if(ve.lcc)return ve.ozj(a,b,c,f);if(!ve.YKd()||!ve.gCc(a)||ld.a.instance.Oa.xG)return 8;if(ve.NJb&&fb.SelectionEditor.bDa(a))return 2;let l;if(!({hyperlink:l}=ve.qSa(a,!0)).returnValue||ve.ZDc())return 8;if(1===b)return 32;if(!l&&fb.SelectionEditor.Kg(a)&&fb.SelectionEditor.pvb(a)&&(b=fb.SelectionEditor.bPa(a,!1))&&(ld.a.instance.setSelection(b),
a=b.Ua,ve.ZDc()))return 8;Ut.instance.ZRf(a,c,f);return 32}static ozj(a,b,c,f){var l=ld.a.instance.Oa.kb;const x=ve.J4b(l);if(x)a=[a];else if(!({QNd:a}=ve.rPf(l)).returnValue)return 8;if(!ve.YKd())return 8;for(l=0;l<a.length;l++)if(!ve.gCc(a[l]))return 8;if(ld.a.instance.Oa.xG)return 8;l=Array(a.length);let F=null;for(let R=0;R<a.length;R++)if(l[R]=a[R],!({hyperlink:F}=ve.qSa(l[R],!0)).returnValue||ve.ZDc())return 8;if(f&&!ve.RPj(l[0]))return 8;if(1===b)return 32;if(!F&&1===l.length&&x&&fb.SelectionEditor.Kg(l[0])&&
fb.SelectionEditor.pvb(l[0])&&(b=fb.SelectionEditor.bPa(l[0],!1))&&(ld.a.instance.setSelection(b),l[0]=b.Ua,ve.ZDc()))return 8;x?Ut.instance.ZRf(l[0],c,f):new Xk(l,c);return 32}static insertLink(a,b,c,f,l){return ve.Jmg(b,c,l,!1)}static linkText(a,b,c,f,l){return ve.Jmg(b,c,l,!0)}static ech(a,b,c){if(ve.lcc)return ve.VNk(a,b,c);if(!ve.gCc(b)||ve.NJb&&fb.SelectionEditor.bDa(b))return 2;let f;if(!({hyperlink:f}=ve.qSa(b,!1)).returnValue)return 2;if(2===c){c=new We.GraphTransaction(15);try{c.$c=a,c.fd(f.paragraph),
ve.Ira?ve.uch(b):ve.yt.hO(b,f)}finally{c&&c.dispose()}}return 32}static VNk(a,b,c){var f=ld.a.instance.Oa.kb;if(ve.J4b(f))b=[b];else if(!({QNd:b}=ve.rPf(f)).returnValue)return 8;if(!ve.YKd())return 8;for(f=0;f<b.length;f++)if(!ve.gCc(b[f]))return 8;if(1===c&&!ve.qSa(b[0],!1).returnValue)return 2;if(2===c){for(c=0;c<b.length;c++)if(!ve.qSa(b[c],!0).returnValue)return 2;c=new We.GraphTransaction(15);try{let l=b[0];c.$c=a;c.fd(l.node);for(a=0;a<b.length;a++)ve.uch(b[a])}finally{c&&c.dispose()}}return 32}static uch(a){const b=
Rb.HyperlinkReader.g0b(a);let c=0;for(let f=0;f<b.length;f++)if(b[f].Qa>=c){const l=({Kb:c}=ve.yt.kZ(a,b[f])).returnValue;ve.yt.wEb(a,l)}}static Pih(a,b,c){if(ve.NJb&&W.ImageReader.iub(b)||!({hyperlink:a}=ve.qSa(b,!1)).returnValue)return 2;2===c&&({Qa:b,Kb:c}=ve.yt.kZ(b,a),ld.a.instance.setSelection(nd.SelectionFactory.P1(a.paragraph,b,c)));return 32}static N1g(a,b,c){let f;if(ve.NJb&&({hyperlink:f}=ve.FPj(b)).returnValue)Z.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");
else if(!({hyperlink:f}=ve.qSa(b,!1)).returnValue)return 2;2===c&&Gb.App.BZb(f.hyperlink.url);return 32}static Jwe(a,b,c){a=W.ImageReader.kZ(b.node);if(!a)return 2;2===c&&Gb.App.BZb(a);return 32}static MQf(a,b,c,f,l){if(ve.NJb&&W.ImageReader.iub(b))return 2;const x=pa.InteractiveViewManager.instance.editingView;if(!x.Bl)return 2;let F;if(!({hyperlink:F}=ve.qSa(b,!1)).returnValue)return 2;if(1===c)return 32;({Qa:b,Kb:c}=ve.yt.kZ(b,F));ld.a.instance.setSelection(nd.SelectionFactory.P1(F.paragraph,b,
c));var R=x.ownerDocument;c=x.Bn;b=new od.a(c);Ba.a.$t(c);R=R.createElement("span");c.appendChild(R);R.innerText=F.hyperlink.url;x.RHa();x.Z4k();a=u.AFrameworkApplication.Ta.ii(a,C.a.copy,2,!0,f,l);b.restore();return a}static qSa(a,b){let c;c=null;if(fb.SelectionEditor.Pj(a)){var f=fg.h(a);const l=Pa.a.all(f,x=>6===x.Eq);if(0<f.length&&(!ve.GR||!l))return{returnValue:!1,hyperlink:c}}if(ve.Ira)return ve.BPj(a,b);f=Rb.HyperlinkReader.FB(a,!0);return 1===f.length&&f[0].Qa<=a.Qa&&f[0].Kb>=a.Kb&&f[0].hyperlink?
(c=f[0],{returnValue:!0,hyperlink:c}):{returnValue:!f.length&&b,hyperlink:c}}static FPj(a){let b;b=null;return W.ImageReader.iub(a)&&(b=Rb.HyperlinkReader.RLc(a))?{returnValue:!0,hyperlink:b}:{returnValue:!1,hyperlink:b}}static BPj(a,b){let c;c=null;const f=Rb.HyperlinkReader.g0b(a);return f.length?f[0].hyperlink?(c=f[0],a.Qa<f[0].Qa?{returnValue:b,hyperlink:c}:{returnValue:!0,hyperlink:c}):{returnValue:!1,hyperlink:c}:{returnValue:b,hyperlink:c}}static RPj(a){if(fb.SelectionEditor.Pj(a)){var b=fg.h(a),
c=Pa.a.all(b,f=>6===f.Eq);if(0<b.length&&!c)return!1}b=Rb.HyperlinkReader.FB(a,!0);if(!(1===b.length&&b[0].Qa<=a.Qa&&b[0].Kb>=a.Kb&&b[0].hyperlink))return!1;c=Ya.ParagraphReader.text(a.node);a=ve.yt.PLc(a,b[0],c);return!(0<=a.indexOf("\r")||0<=a.indexOf("\n")||0<=a.indexOf("\x0B")||0<=a.indexOf("\ufffc"))}static ZDc(){if(ve.Nf.Zf)for(let a=0;a<null.count;++a)if(2===null.ga(a).oCl.changeType)return!0;return!1}static YKd(){return ve.Nf.Zf?!0:!H.a.instance.ga(45)||!Gb.App.YC.FIb}static gCc(a){return H.a.instance.ga(14)&&
ve.Wi.Z3a(a)||ve.Mq()&&ve.Mq().instance&&ve.Mq().instance.LV(a)?!1:!0}static v1d(a,b){return Ya.ParagraphReader.Xl(a)&&!fb.SelectionEditor.JV(a)&&(Ya.ParagraphReader.textLength(a.node)||b)?Pc.a.createTextRange(a.node,0,Ya.ParagraphReader.textLength(a.node)):a}}ve.Xm=null;ve.JC=null;ve.nm=null;ve.Wc=null;ve.QC=null;ve.mnd=null;ve.KZa=null;ve.LZa=null;ve.bM=null;Object(e.a)(ve,"HyperlinkActor",null,[]);class xg{static get Tu(){return Yu.a.osb}static get Pl(){return Rg.ContextSetEditor.instance}static get Wi(){return Qg.a.instance}static get Tc(){return Sa.a.instance}static Mq(){return xg.nm||
(xg.nm=hb.a.instance.La("Box4.IExternalSelectionManager"))}static get paragraphEditor(){return xg.xw||(xg.xw=hb.a.instance.resolve("Box4.IParagraphEditor"))}static get p4(){return xg.Zq||(xg.Zq=hb.a.instance.resolve("Box4.IParagraphReader"))}static get xL(){return xg.TF||(xg.TF=hb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get esk(){return xg.paragraphEditor.Tu}static get Rf(){return xg.Og||(xg.Og=hb.a.instance.resolve("Box4.List.IListReader"))}static ub(){const a=u.AFrameworkApplication.Ta;
a.xa(C.a.Ry,Fb.a.view,xg.HFf);a.xa(C.a.Ry,Fb.a.outlineElement,xg.GFf);a.$d(C.a.Ry,1028);a.xa(C.a.HE,Fb.a.view,xg.HFf);a.xa(C.a.HE,Fb.a.outlineElement,xg.GFf);a.$d(C.a.HE,1028)}static HFf(a,b,c,f,l){var x=b.view;if(!x.Hh)return 2;const F=x.Eb;if(!F)return xg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.ola}),8;var R=F.Dj;if(!R)return xg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.noSelection}),8;if(H.a.instance.ga(62)&&1===c)return 32;if(H.a.instance.ga(11)&&xg.Pl.Xpa(xg.oHd,R))return xg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.OVb}),
8;if(H.a.instance.ga(14)&&xg.Wi.sRc(R))return xg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.cD}),8;if(xg.Mq()&&xg.Mq().instance&&xg.Mq().instance.LV(R))return xg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.externalSelection}),8;R={};R[bi.nna]=5794;R[bi.mna]=5795;let fa=2;if(u.AFrameworkApplication.fa.ka("Box4PartialPromoteDemoteIsEnabled")){x=xg.gLf(a===C.a.Ry,b,!0);if(1===c)return x?32:8;x&&(fa=bi.odb(a,b,c,f,l,R))}else fa=bi.odb(a,b,1,f,l,R),1!==c&&32===fa?(x.Eb.gwe(),x=new We.GraphTransaction(15),x.fd(b.view.rg),fa=xg.gLf(a===
C.a.Ry,b,!1)?bi.odb(a,b,c,f,l,R):8,x.dispose()):1!==c&&8===fa&&(x.Eb.gwe(),xg.Ipi(a,b,F));return fa}static gLf(a,b,c){b=b.view.Eb;if(!b||!b.Oa.kb)return xg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.W5c}),!1;if(b.Oa.xG)return xg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.SPf}),!1;b=li.Xqa(b.Oa,!1);if(!b)return xg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.CIc}),!1;let f=!1;for(let l=0;l<b.length;l++){const x=b.getContext(l),F=new mb.GraphIterator;F.set(x.node);fb.SelectionEditor.Vs(F);if(!Rd.OutlineElementReader.Tg(F))if(c)continue;
else return xg.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.eba}),!1;if(a?!xg.Tu.tob(F):!xg.Tu.dCc(F))if(c)continue;else return xg.Tc.Tb(Ed.a.IXb,{["Reason"]:Bd.a.DLf}),!1;f=!0}return c?f:!0}static GFf(a,b,c,f,l){if(b.contextId!==Fb.a.outlineElement)return 2;if(H.a.instance.ga(14))if(f=b.clone().RMe(),xd.TableReader.oxg(f)){if(xg.Wi.pxg(f))return xg.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),8}else if(xg.Wi.kDa(f))return xg.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),2;f=new mb.GraphIterator;f.set(b.node);fb.SelectionEditor.Vs(f);
if(!Rd.OutlineElementReader.Tg(f))return 2;switch(a){case C.a.Ry:b=xg.Tu.tob(f);break;case C.a.HE:b=xg.Tu.dCc(f);break;default:return 2}if(1===c||!b)return b?32:8;c=0;a===C.a.HE&&l&&l.sa(be.a.cHf,!1)&&(c|=2);switch(a){case C.a.Ry:xg.Tu.Idb(f,-1,c);break;case C.a.HE:xg.Tu.gGc(f,1)}return 32}static Ipi(a,b,c){const f=new We.GraphTransaction(15);try{f.fd(b.view.rg);b=!0;var l=li.Xqa(c.Oa,!1);for(let x=0;x<l.length;x++){const F=l.getContext(x);let R=new mb.GraphIterator;R.set(F.node);fb.SelectionEditor.Vs(R);
if(!Rd.OutlineElementReader.Tg(R))b=!1;else if(a===C.a.Ry?xg.Tu.tob(R):xg.Tu.dCc(R))switch(b=!1,a){case C.a.Ry:xg.Tu.Idb(R,-1,0);break;case C.a.HE:xg.Tu.gGc(R,1)}}if(b){const x=c.Oa.kb;for(c=0;c<x.length;c++){const F=x.ga(c);if(F.Kk){const R=xg.xL.dsb(F.node),fa=R.tHb;if(a===C.a.Ry?R.aN>fa:R.aN<18*fa){let wa=new mb.GraphIterator;wa.set(F.node);l=fa;l=a===C.a.Ry?R.aN>=2.5*fa?R.aN-2*fa:fa:R.aN<16*fa?R.aN+2*fa:18*fa;xg.esk.xfb(wa,1,l)}}}}}finally{f&&f.dispose()}}}xg.nm=null;xg.xw=null;xg.Zq=null;xg.TF=
null;xg.Og=null;xg.oHd=W.ImageReader.gub;Object(e.a)(xg,"IndentationActor",null,[]);class Xf{static get N4d(){return Xf.$jb||(Xf.$jb=hb.a.instance.resolve("Box4.Images.IImageEditor"))}static get paragraphEditor(){return Xf.xw||(Xf.xw=hb.a.instance.resolve("Box4.IParagraphEditor"))}static get Aq(){return Xf.PC||(Xf.PC=hb.a.instance.resolve("Box4.ITableEditor"))}static get Wi(){return Qg.a.instance}static get Tc(){return Sa.a.instance}static Mq(){return Xf.nm||(Xf.nm=hb.a.instance.La("Box4.IExternalSelectionManager"))}static ub(){const a=
u.AFrameworkApplication.Ta;H.a.instance.ga(77)||(a.xa(C.a.leftJustify,Fb.a.table,Xf.gId),a.xa(C.a.centerJustify,Fb.a.table,Xf.gId),a.xa(C.a.rightJustify,Fb.a.table,Xf.gId));a.xa(C.a.leftJustify,Fb.a.view,pg.w6);a.xa(C.a.leftJustify,Fb.a.paragraph,Xf.Qga);a.xa(C.a.leftJustify,Fb.a.image,Xf.Iza);a.xa(C.a.leftJustify,Fb.a.embeddedFile,Xf.Iza);a.$d(C.a.leftJustify,1028);a.xa(C.a.centerJustify,Fb.a.view,pg.w6);a.xa(C.a.centerJustify,Fb.a.paragraph,Xf.Qga);a.xa(C.a.centerJustify,Fb.a.image,Xf.Iza);a.xa(C.a.centerJustify,
Fb.a.embeddedFile,Xf.Iza);a.$d(C.a.centerJustify,1028);a.xa(C.a.rightJustify,Fb.a.view,pg.w6);a.xa(C.a.rightJustify,Fb.a.paragraph,Xf.Qga);a.xa(C.a.rightJustify,Fb.a.image,Xf.Iza);a.xa(C.a.rightJustify,Fb.a.embeddedFile,Xf.Iza);a.$d(C.a.rightJustify,1028);H.a.instance.ga(54)&&(a.xa(C.a.fullJustify,Fb.a.view,pg.w6),a.xa(C.a.fullJustify,Fb.a.paragraph,Xf.Qga),a.$d(C.a.fullJustify,1028),a.xa(C.a.DXb,Fb.a.view,pg.w6),a.xa(C.a.DXb,Fb.a.paragraph,Xf.Qga),a.$d(C.a.DXb,1028),a.xa(C.a.m5b,Fb.a.view,pg.w6),
a.xa(C.a.m5b,Fb.a.paragraph,Xf.Qga),a.$d(C.a.m5b,1028),a.xa(C.a.Njc,Fb.a.view,pg.w6),a.xa(C.a.Njc,Fb.a.paragraph,Xf.Qga),a.$d(C.a.Njc,1028));a.xa(C.a.jja,Fb.a.view,pg.w6);a.xa(C.a.jja,Fb.a.paragraph,Xf.Qga);a.xa(C.a.jja,Fb.a.image,Xf.Iza);a.$d(C.a.jja,1028);a.xa(C.a.eha,Fb.a.view,pg.w6);a.xa(C.a.eha,Fb.a.paragraph,Xf.Qga);a.xa(C.a.eha,Fb.a.image,Xf.Iza);a.$d(C.a.eha,1028);a.xa(C.a.sma,Fb.a.view,pg.w6);a.xa(C.a.sma,Fb.a.paragraph,Xf.Qga);a.xa(C.a.sma,Fb.a.image,Xf.Iza);a.$d(C.a.sma,1028);H.a.instance.ga(54)&&
(a.xa(C.a.uBa,Fb.a.view,pg.w6),a.xa(C.a.uBa,Fb.a.paragraph,Xf.Qga),a.$d(C.a.uBa,1028))}static gId(a,b,c){let f=!0;if(!b)return 8;xd.TableReader.oxg(b)?H.a.instance.ga(14)&&Xf.Wi.pxg(b)?(Xf.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),f=!1):Xf.Mq()&&Xf.Mq().instance&&Xf.Mq().instance.LV(b)&&(Xf.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.externalSelection}),f=!1):(Xf.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.$Rd}),f=!1);if(1===c||!f)return f?32:8;b=b.node;switch(a){case C.a.leftJustify:Xf.Aq.IL(b,1);break;case C.a.centerJustify:Xf.Aq.IL(b,
2);break;case C.a.rightJustify:Xf.Aq.IL(b,3)}return 32}static Iza(a,b,c){if(!({CE:c}=pg.joh(c,b)).returnValue)return c;b=b.node;switch(a){case C.a.leftJustify:case C.a.jja:Xf.N4d.IL(b,1);break;case C.a.centerJustify:case C.a.eha:Xf.N4d.IL(b,2);break;case C.a.rightJustify:case C.a.sma:Xf.N4d.IL(b,3)}return 32}static Qga(a,b,c,f,l){f=!0;b.contextId!==Fb.a.paragraph?f=!1:H.a.instance.ga(14)&&Xf.Wi.kDa(b)?(Xf.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.cD}),f=!1):Xf.Mq()&&Xf.Mq().instance&&Xf.Mq().instance.LV(b)&&
(Xf.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.externalSelection}),f=!1);if(1===c||!f)return f?32:8;b=b.node;c=Ya.ParagraphReader.UM(b);switch(a){case C.a.leftJustify:case C.a.jja:Xf.paragraphEditor.IL(b,1===c&&Xf.XTc(l)?6:1);break;case C.a.centerJustify:case C.a.eha:Xf.paragraphEditor.IL(b,2===c&&Xf.XTc(l)?1:2);break;case C.a.rightJustify:case C.a.sma:Xf.paragraphEditor.IL(b,3===c&&Xf.XTc(l)?1:3);break;case C.a.fullJustify:case C.a.uBa:Xf.paragraphEditor.IL(b,6===c&&Xf.XTc(l)?1:6);break;case C.a.m5b:Xf.paragraphEditor.IL(b,
11);break;case C.a.DXb:Xf.paragraphEditor.IL(b,7);break;case C.a.Njc:Xf.paragraphEditor.IL(b,13)}return 32}static XTc(a){let b=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(b=a.InContextSet);return!b&&H.a.instance.ga(110)}}Xf.$jb=null;Xf.PC=null;Xf.xw=null;Xf.nm=null;Object(e.a)(Xf,"JustificationActor",null,[]);class Vt{ub(){const a=u.AFrameworkApplication.Ta;a.xa(C.a.activateRibbonTab,Fb.a.view,Object(D.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.$d(C.a.activateRibbonTab,
5);a.xa(C.a.wyg,Fb.a.view,Object(D.a)(this,this.NRj,"launchJewelOpenMenuShortcut"))}activateRibbonTab(){return 32}NRj(){u.AFrameworkApplication.mN("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Gb.App.YC.VR.vyg();return 32}static get instance(){return Vt.Ja||(Vt.Ja=Vt.GB())}static GB(){return new Vt}}Vt.Ja=null;Object(e.a)(Vt,"RibbonActor",null,[]);class Pn{constructor(a,b,c){this.mxf=!1;this.Ca=a;this.jb=b;this.Nrc=c}ub(){this.Ca.pa(G.a.SL,Fb.a.view,Object(D.a)(this,this.lnl,
"touchStartHandler"),4);this.Ca&&this.jb&&(this.jb.ka("TouchImageGrippiesResizedIsEnabled")&&(this.Ca.pa(C.a.Qwh,Fb.a.view,Object(D.a)(this,this.TAk,"processImageOnTouchSelection"),4),this.Ca.pa(C.a.Rwh,Fb.a.view,Object(D.a)(this,this.SAk,"processImageOnClickSelection"),4)),this.jb.ka("HideGrippersWhenPinchingIsEnabled")&&(this.Ca.pa(G.a.Kgl,Fb.a.application,Object(D.a)(this,this.tBk,"processStartPinchToZoom"),4),this.Ca.pa(G.a.zKi,Fb.a.application,Object(D.a)(this,this.LAk,"processEndPinchToZoom"),
4)))}lnl(a,b,c){if(2!==c)return 2;this.mxf||(this.mxf=!0);u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");n.a.Hj&&u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordForceSelectionIntoTopWhenTouchSettings");return 32}TAk(a,b,c,f,l){if(2!==c)return 2;this.e7g(l,!0);return 32}SAk(a,b,c,f,l){if(2!==c)return 2;this.e7g(l,!1);return 32}e7g(a,
b){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,Pn.xuj)){for(a=a.firstChild;a;)this.K6h(a,b),a=a.nextSibling;break}a=a.nextSibling}}K6h(a,b){if(Sys.UI.DomElement.containsCssClass(a,Pn.Ykg)){b&&!Sys.UI.DomElement.containsCssClass(a,Pn.MPc)?Sys.UI.DomElement.addCssClass(a,Pn.MPc):!b&&Sys.UI.DomElement.containsCssClass(a,Pn.MPc)&&Sys.UI.DomElement.removeCssClass(a,Pn.MPc);const c="WACImageResizeHandleTouch"+this.V3i(a);b&&!Sys.UI.DomElement.containsCssClass(a,
c)?Sys.UI.DomElement.addCssClass(a,c):!b&&Sys.UI.DomElement.containsCssClass(a,c)&&Sys.UI.DomElement.removeCssClass(a,c)}}LLc(a){a=a.className.split(" ");for(let b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&c!==Pn.Ykg)return c}return""}V3i(a){a=this.LLc(a);return""!==a?Ma.a.substring(a,20,a.length):""}tBk(a,b,c){if(2!==c)return 2;if(!this.Nrc)return 8;this.Nrc.$rj();return 32}LAk(a,b,c){if(2!==c)return 2;if(!this.Nrc)return 8;this.Nrc.HUk();return 32}static bgj(){return new Pn(u.AFrameworkApplication.Ta,
u.AFrameworkApplication.fa,jf.GrippersManager.instance)}static get instance(){return Pn.it||(Pn.it=Pn.bgj())}}Pn.Ykg="WACImageResizeHandles";Pn.MPc="WACImageResizeHandlesTouch";Pn.xuj="WACImgSelection";Pn.it=null;Object(e.a)(Pn,"TouchInputActor",null,[]);class dr{constructor(a){this.rs=null;this.yY=a}get rn(){return this.rs||(this.rs=this.yY())}ub(){const a=u.AFrameworkApplication.Ta,b=Object(D.a)(this,this.undoRedo,"undoRedo");a.pa(C.a.undo,Fb.a.view,b,1028);a.pa(C.a.redo,Fb.a.view,b,1028)}undoRedo(a,
b,c,f,l){b=b.view;if(!b.Hh)return dr.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.W5c}),8;f=a===C.a.undo?this.rn.AV:this.rn.uia;if(1===c)return f?32:8;if(!f)return Z.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===C.a.undo?"undo":"redo"),dr.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.Brl}),2;c=new We.GraphTransaction(3);c.fd(b.rg);c.mfb();a=a===C.a.undo?this.rn.undo():this.rn.redo();c.dispose();l&&jf.GrippersManager.instance.vZa(l.Uu);if(a)return 32;dr.Tc.Tb(Ed.a.IXb,{["Reason"]:Bd.a.KUg});return 8}static get instance(){return dr.Ja||
(dr.Ja=dr.GB())}static GB(){const a=hb.a.instance;return new dr(()=>a.resolve("Box4.IUndoManager"),a.Be("Box4.ICoauthCashTelemetry"))}static get Tc(){return Sa.a.instance}}dr.Ja=null;Object(e.a)(dr,"UndoActor",null,[]);class uC{constructor(){this.Da=null}get name(){return"Box4.Actors"}Wb(a){this.Da=a;(new II).Wb(a)}init(){this.Da.resolve("Box4.Actors.ClipboardActor").ub();u.AFrameworkApplication.Ta.xa(C.a.nIi,Fb.a.embeddedFile,RP);u.AFrameworkApplication.Ta.xa(C.a.eSd,Fb.a.embeddedFile,JI);u.AFrameworkApplication.Ta.xa(C.a.eSd,
Fb.a.sZb,JI);cr.instance.ub();ve.ub();xg.ub();Xf.ub();Pn.instance.ub();this.Da.resolve("Box4.ISelectAllHandlers").ub();H.a.instance.ga(70)&&this.Da.resolve("Box4.Actors.ProofingActor").ub();Vt.instance.ub();const a=this.Da.pb("Box4.IFeatureHelper");a?a.Nij.continueWith(()=>{this.kbh()}):this.kbh();xc.ub(Gb.App.aJa);this.Da.resolve("Box4.Actors.TextFormattingActor").ub();dr.instance.ub();this.Da.resolve("Box4.Actors.AccessibilityActor").UCe();this.Da.resolve("Box4.IClipboardCommands");Gb.App.Fb.updateCommandUI()}kbh(){H.a.instance.ga(71)&&
this.Da.resolve("Box4.Actors.StyleActor").ub()}dispose(){}static main(){m.a.instance.Ac(new uC)}}Object(e.a)(uC,"Box4ActorsPackage",null,[2,3]);class Qm{constructor(a,b){this.W5=this.sPh=null;this.uPh=a;this.Jjb=b}get O$c(){return this.levelText}get E5b(){return this.sPh}get levelText(){return this.uPh}get listStyle(){return 6}get rD(){return"left"}get hla(){return this.W5}get font(){return this.Jjb}}Object(e.a)(Qm,"ListMarkerBullet",null,[1132]);class vf{static get ao(){return vf.Jo||(vf.Jo=hb.a.instance.resolve("Box4.List.IListEditor"))}static get Rf(){return vf.Og||
(vf.Og=hb.a.instance.resolve("Box4.List.IListReader"))}static get insertionPointFormatting(){return vf.$s||(vf.$s=hb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Mq(){return vf.nm||(vf.nm=hb.a.instance.La("Box4.IExternalSelectionManager"))}static get Pl(){return Rg.ContextSetEditor.instance}static get Wi(){return Qg.a.instance}static get Tc(){return Sa.a.instance}static get KK(){return vf.GJ||(vf.GJ=hb.a.instance.pb("Box4.List.ListSettings"))}static get Lkc(){return vf.aRb||(vf.aRb=
hb.a.instance.pb("Box4.List.ISingleLevelListEditor"))}static ub(){const a=u.AFrameworkApplication.Ta;a.xa(C.a.tO,Fb.a.view,vf.rTb);a.xa(C.a.tO,Fb.a.outlineElement,vf.onb);a.$d(C.a.tO,1036);a.xa(C.a.XQ,Fb.a.view,vf.rTb);a.xa(C.a.XQ,Fb.a.outlineElement,vf.onb);a.$d(C.a.XQ,1036);vf.Rf.j9a&&(a.xa(C.a.OVa,Fb.a.view,vf.rTb),a.xa(C.a.OVa,Fb.a.outlineElement,vf.onb),a.$d(C.a.OVa,1036));a.xa(C.a.EFf,Fb.a.view,ce.ActionManager.Fg);a.xa(C.a.nNf,Fb.a.view,ce.ActionManager.Fg);a.xa(C.a.joinList,Fb.a.view,ce.ActionManager.Fg);
a.xa(C.a.FHd,Fb.a.view,ce.ActionManager.Fg);a.xa(C.a.LHd,Fb.a.view,ce.ActionManager.Fg);a.xa(C.a.auh,Fb.a.view,ce.ActionManager.Fg);a.xa(C.a.buh,Fb.a.view,ce.ActionManager.Fg);a.xa(C.a.SRe,Fb.a.view,ce.ActionManager.Fg)}static rTb(a,b,c,f,l){if(!b.view.Hh)return 2;const x=vf.Tc.Bp(C.a.rTb);f.pP=42;f.P6=42;const F={};F[bi.nna]=5796;F[bi.mna]=5797;var R=b.view;if(H.a.instance.ga(11)){if(vf.Pl.Xpa(vf.Ztj,R.Eb.Dj))return vf.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.zNd}),x.end(),8;if(vf.Pl.Xpa(vf.oHd,R.Eb.Dj))return vf.Tc.Tb(Ed.a.ph,
{["Reason"]:Bd.a.OVb}),x.end(),8}if(H.a.instance.ga(14)&&vf.Wi.sRc(R.Eb.Dj))return vf.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.cD}),x.end(),8;if(vf.Mq()&&vf.Mq().instance&&vf.Mq().instance.LV(b))return vf.Tc.Tb(Ed.a.ph,{["Reason"]:Bd.a.externalSelection}),x.end(),8;if(1===c)return x.end(),32;l||(l=new E.DictionaryPropertySet);let fa=null;var wa=2;if(2===c){fa=new We.GraphTransaction(15);fa.fd(b.view.rg);vf.U4b=!1;const lb=li.Xqa(R.Eb.Oa,!1);if(!lb)return fa.dispose(),vf.Tc.Tb(Ed.a.Mha,{["Reason"]:Bd.a.CIc}),
x.end(),8;u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");1<lb.length&&l.setValue(be.a.cUg,null);const Lb=l.sa(be.a.HS,-1),kc=l.sa(be.a.tD,-1);vf.KK.H4b&&vf.Lkc&&vf.Lkc.pCl(lb);if(vf.Rf.$th){var Xa=vf.w8k(Lb,kc,lb);Xa&&(l.setValue(be.a.tD,16),l.setValue(be.a.nca,0));if(!fb.SelectionEditor.Kg(R.Eb.Dj)&&!Xa&&a!==C.a.OVa&&0<lb.length&&Lb){R=new mb.GraphIterator;Xa=Array(lb.length);for(let lc=0;lc<lb.length;lc++)R.set(lb.getContext(lc).node),
Xa[lc]=vf.Rf.Fw(R);vf.v8k(Xa,l)&&(wa=new E.DictionaryPropertySet,wa.setValue(be.a.tD,16),wa.setValue(be.a.nca,0),wa=bi.r4(a,b,c,f,wa,F,11),u.AFrameworkApplication.Ta.processAction(C.a.buh,2),Z.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),vf.U4b=!0)}}R=new mb.GraphIterator;R.set(lb.getContext(0).node);R=vf.Rf.Fw(R);vf.FWj(Lb,kc,R,lb.length)}H.a.instance.ga(63)||H.a.instance.ga(77)?wa=bi.r4(a,b,c,f,l,F,11):H.a.instance.ga(30)&&(wa=bi.odb(a,b,c,f,l,F));32===wa&&
l.sa(be.a.cHf,!1)&&(H.a.instance.ga(62)?wa=bi.r4(C.a.HE,b,c,f,l,F,11):H.a.instance.ga(29)?wa=bi.odb(C.a.HE,b,c,f,l,F):H.a.instance.ga(76));fa&&fa.dispose();x.end();return wa}static v8k(a,b){let c=null;var f=!1;for(let l=a.length-1;0<=l&&(c?(f=a[l],f=-1!==b.sa(be.a.HS,-3)?f?c.listType!==f.listType||c.listStyle!==f.listStyle:!0:f?c.listType!==f.listType:!0):c=a[l],!f);l--);return c&&(a=!1,f||(a=b.sa(be.a.HS,-3),a=b.sa(be.a.tD,42)!==c.listType||0<a),f||a)?!0:!1}static FWj(a,b,c,f){0>=f||vf.U4b||(a?c?
(c=c.listType,-1===a&&b===c?(u.AFrameworkApplication.Ta.processAction(C.a.SRe,2),Z.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(0===b||1===b)&&(u.AFrameworkApplication.Ta.processAction(0===b?C.a.LHd:C.a.FHd,2),Z.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet"))):(u.AFrameworkApplication.Ta.processAction(0===b?C.a.LHd:C.a.FHd,2),Z.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",0===b?
"Numbering":"Bullet")):(u.AFrameworkApplication.Ta.processAction(C.a.SRe,2),Z.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static w8k(a,b,c){if(-1!==a&&a||!c.length)return!1;a=new mb.GraphIterator;let f=null;for(let l=c.length-1;0<=l&&!(a.set(c.getContext(l).node),f=vf.Rf.Fw(a));l--);return f&&b===f.listType?!0:!1}static onb(a,b,c,f,l){if(b.contextId!==Fb.a.outlineElement)return 2;if(H.a.instance.ga(14)){var x=b.clone().RMe();if(vf.Wi.kDa(x))return vf.Tc.Tb(Ed.a.Eo,
{["Reason"]:Bd.a.cD}),2}const F=new mb.GraphIterator;F.set(b.node);fb.SelectionEditor.Vs(F);if(!Rd.OutlineElementReader.Tg(F))return 2;if(1===c)switch(a){case C.a.tO:return 32;case C.a.XQ:return 32;case C.a.OVa:return 32;default:return 2}x=vf.Rf.Fw(F);let R=l;if(!R)return 8;!Ib.ListReader.Lw&&a===C.a.XQ&&F.mCa()&&(F.bI(4)||R.setValue(be.a.FSa,1),F.jp());vf.Rf.j9a?(a===C.a.XQ||a===C.a.tO?(R=vf.ao.G_f(a,R),b=uj.a.kP(R.getValue(be.a.tD),R.getValue(be.a.nca))):b=a===C.a.OVa?uj.a.kP(0,1):null,vf.aQ(a,
R),vf.b3k(b,R)):(R=vf.ao.G_f(a,R),b=uj.a.kP(R.getValue(be.a.tD),R.getValue(be.a.nca)));Ib.ListReader.Lw||(b.Yz=R.sa(bb.a.HSa,Pk.a.kw));vf.i4k(R,F);if(!({G7a:b}=vf.ao.onb(R,F,b,!1)).returnValue)return vf.Tc.Tb(Ed.a.Eo,{["Reason"]:Bd.a.Ibe}),2;2===c&&(u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),a=l.sa(be.a.tD,-1),b&&-1!==a&&((l=l.sa(Bb.a.IZ,"Invalid MultiLevel Type"),x)?0!==b.listType&&1!==b.listType||vf.U4b||(u.AFrameworkApplication.Ta.processAction(C.a.auh,
2),Z.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",a?"Bullet":"Numbering",l)):16===b.listType?(u.AFrameworkApplication.Ta.processAction(C.a.nNf,2),Z.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",a?"Bullet":"Numbering",l)):0!==b.listType&&1!==b.listType||vf.U4b||(u.AFrameworkApplication.Ta.processAction(C.a.EFf,2),Z.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",a?"Bullet":"Numbering",l))),l=v.FocusManager.instance(),
l.ye.name===I.AppFrame.Edd&&l.qC(y.AFrame.mV));f.pP=b.listType;f.P6=b.listStyle;return 32}static i4k(a,b){var c=new mb.GraphIterator;c.Nc(b);(b=c.zb(2))&&Ya.ParagraphReader.Wd(b)&&(c=ld.a.instance.Oa.kb)&&c.Ua&&c.Ua.node===b&&fb.SelectionEditor.ATc(c)&&(vf.f2k(a),vf.d2k(a))}static b3k(a,b){b.Sa(Bb.a.IZ)&&a.a3k(b.getValue(Bb.a.IZ));a.HS=b.sa(be.a.HS,-1);a.Y$d?(b=vf.e6i(a,b),vf.f4k(a,b)):vf.s1k(a)}static s1k(a){if(a.MSc)a.NOc&&-1===a.HS||(a.levelText="%1.",a.propertySet.Sa(bb.a.Ni)||a.eIa(0,1));else if(1===
a.listType)a.NOc&&-1===a.HS||(a.font=Pk.a.eDi,a.levelText=Pk.a.defaultBullet,a.propertySet.Sa(bb.a.Ni)||a.eIa(1,6));else return;a.rD="left"}static f4k(a,b){1===a.IZ?vf.p3k(a,b):vf.r2k(a,b)}static p3k(a,b){a.hla=b.hla}static r2k(a,b){a.levelText=b.levelText;a.MSc?a.eIa(0,b.listStyle):(a.font=b.font,a.eIa(1,1));a.rD=b.rD}static e6i(a,b){let c=null;2===a.IZ?c=a.MSc?hb.a.instance.pb("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):hb.a.instance.pb("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===
a.IZ&&(c=hb.a.instance.pb("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let f=c.Tzg.value;a=a.HS+"";a in f||(f=c.YSj);return a in f||!b.Sa(bb.a.font)?f[a]:new Qm(Ma.a.fromCharCode(parseInt(a)),b.sa(bb.a.font,""))}static d2k(a){vf.insertionPointFormatting.Sa(bb.a.fontColor)&&a.setValue(bb.a.fontColor,vf.insertionPointFormatting.fontColor())}static f2k(a){vf.insertionPointFormatting.Sa(bb.a.fontSize)&&a.setValue(bb.a.fontSize,vf.insertionPointFormatting.fontSize())}static aQ(a,b){Z.ULS.sendTraceTag(22923024,
324,50,"{ListType:%1, ListStyleId:%2}",a===C.a.tO?0:a===C.a.XQ?1:a===C.a.OVa?2:-1,b.sa(be.a.HS,-1))}}vf.Ztj=W.ImageReader.L3b;vf.oHd=W.ImageReader.gub;vf.Jo=null;vf.Og=null;vf.$s=null;vf.nm=null;vf.GJ=null;vf.aRb=null;vf.U4b=!1;Object(e.a)(vf,"ListActor",null,[]);var MI=d(1161);class Wt{constructor(){this.vPh=new le.a(Object(D.a)(this,this.ROd,"createListMarkerDictionary"));this.wPh={}}get Tzg(){return this.vPh}get YSj(){return this.wPh}}Object(e.a)(Wt,"AListMarkerGalleryLoader",null,[1133]);var NI=
d(1188);class lz extends Zw.a{constructor(){super();this.LevelInfo=null}get Type(){return 5}}Object(e.a)(lz,"ListGalleryButtonProps",Zw.a,[]);class Fs{constructor(a,b,c,f){this.wOb=null;this.WIf="BulletLibraryGallery";this.mgk="NumberingLibraryGallery";this.Ydk="MultilevelGallery";this.J0a=a;this.xPh=b;switch(a){case 0:this.wOb="BulletStyle";break;case 1:this.wOb="NumberingStyle";break;case 2:this.wOb="MultilevelStyle";break;default:this.wOb="BulletStyle"}this.yOh=f}get ZSj(){return this.xPh}eBf(a){let b;
var c=1;switch(this.J0a){case 0:var f=Box4Intl.Box4Strings.L_BulletsLibraryTitle;var l=b="BulletsLibrary";break;case 1:f=Box4Intl.Box4Strings.L_NumberingLibraryTitle;b="NumberingLibrary";c=5;l="NumberingLibrary";break;case 2:f=Box4Intl.Box4Strings.L_ListLibraryTitle;b="MultilevelLibrary";c=5;l="Multilevel";break;default:f=Box4Intl.Box4Strings.L_BulletsLibraryTitle,l=b="BulletsLibrary"}f=Object.assign(new Si.a,{Id:String.format("msListMarkersPosition{0}",b),Title:f,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",
ControlList:[]});var x=0===this.J0a?"Size40by40":"Size48by48";c=Object.assign(new uq.a,{Id:String.format("galleryListMarkersPosition{0}",b),ExternalId:l,ExternalGalleryId:this.XYd(this.J0a),Type:c,Width:6,ElementDimensions:x,GalleryItems:[]});l=this.ZSj.Tzg.value;x=vq.a(l);const F=Math.min(18,x.length);for(let R=0;R<F;R++){const fa=l[x[R]];this.yOh&&a&&((1===this.J0a||2===this.J0a)&&!fa.E5b||0===this.J0a&&fa.levelText===Box4Intl.Box4Strings.L_ListStyleNone)||c.GalleryItems.push(this.WYd(this.wOb+
b+"_"+R,fa,this.J0a))}Array.add(f.ControlList,c);return f}XYd(a){switch(a){case 0:return this.WIf;case 1:return this.mgk;case 2:return this.Ydk;default:return this.WIf}}J9f(a){const b={},c=ia.FontUtils.mha(a.font);b.fontFamily=ia.FontUtils.Pmb(c,a.font,!0,!1,!1);return b}WYd(a,b,c){var f="";let l=!1;0===c&&b.levelText!==Box4Intl.Box4Strings.L_ListStyleNone&&(f=Ma.a.Gv(b.levelText.charCodeAt(0),4),f=Fs.hCj(b.font)&&!f.indexOf("f")?" 0x0"+f.substr(1):" 0x"+f,f=b.font+f,l=!0);let x,F;switch(c){case 0:c=
C.a.tO;x=C.a.n8g;F=Object.assign(new NI.a,{Character:b.levelText,Style:this.J9f(b)});break;case 1:c=C.a.XQ;x=C.a.MCk;F=Object.assign(new lz,{LevelInfo:b.E5b});break;case 2:c=C.a.OVa;x=C.a.LCk;F=Object.assign(new lz,{LevelInfo:b.E5b});b.hla&&(f=b.hla.description,l=!0);break;default:c=C.a.tO,x=C.a.n8g,F=Object.assign(new NI.a,{Character:b.levelText,Style:this.J9f(b)})}F.Id=a;F.Command=c.toString();F.QueryCommand=x.toString();F.Alt=f;F.InnerHTML=Ma.a.ie(this.WSj(b));F.ShouldSetTitle=l.toString();return F}WSj(a){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.IZd(a),this.HZd(a))}IZd(a){const b=new Sys.StringBuilder;b.append("position: relative; ");if(a.O$c===Box4Intl.Box4Strings.L_ListStyleNone&&a.font===Fs.cqg)b.append("font-size: 12pt; "),b.append("top: 22%;");else{b.append("font-family: ");const c=ia.FontUtils.mha(a.font);b.append(ia.FontUtils.Pmb(c,a.font,!0,!1,!1));b.append("; ");b.append("font-size: 24pt;")}return b.toString()}HZd(a){return a.O$c}static hCj(a){for(let b=0;b<Fs.zGf.length;b++)if(a===Fs.zGf[b])return!0;return!1}}Fs.cqg="EXYdHRyjlYTe8nDSGfyW";
Fs.zGf=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];Object(e.a)(Fs,"ListMarkerGalleryUtility",null,[]);class vC extends Wt{constructor(){super();new MI.a(fB.a.Qr())}ROd(){const a={};a["0"]=new Qm(Box4Intl.Box4Strings.L_ListStyleNone,Fs.cqg);a["1"]=new Qm(String.fromCharCode(61623),"Symbol");a["2"]=new Qm(String.fromCharCode(111),"Courier New");a["3"]=new Qm(String.fromCharCode(61607),"Wingdings");a["4"]=new Qm(String.fromCharCode(9643),"Courier New");a["5"]=new Qm(String.fromCharCode(61611),
"Wingdings");a["6"]=new Qm(String.fromCharCode(61614),"Symbol");a["7"]=new Qm(String.fromCharCode(61483),"Symbol");a["8"]=new Qm(String.fromCharCode(61485),"Symbol");a["9"]=new Qm(String.fromCharCode(9830),"Courier New");a["10"]=new Qm(String.fromCharCode(61664),"Symbol");a["11"]=new Qm(String.fromCharCode(61558),"Wingdings");a["12"]=new Qm(String.fromCharCode(61656),"Wingdings");a["13"]=new Qm(String.fromCharCode(61514),"Wingdings");a["14"]=new Qm(String.fromCharCode(61516),"Wingdings");a["15"]=
new Qm(String.fromCharCode(61692),"Wingdings");a["16"]=new Qm(String.fromCharCode(61691),"Wingdings");a["17"]=new Qm(String.fromCharCode(61553),"Wingdings");return a}}Object(e.a)(vC,"ListMarkerBulletLoader",Wt,[]);class Yk{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(e.a)(Yk,"InfoAtLevel",null,[]);class Xt{constructor(a){this.W5=a}get font(){return"Calibri"}get listStyle(){return 42}get rD(){return"left"}get hla(){return this.W5}get O$c(){return this.W5?this.Tzk():this.Vzk()}get E5b(){return this.W5?
this.Uzk():null}get levelText(){return""}h3i(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}Tzk(){let a="";for(let b=0;3>b;b++)a+=this.VBa(b);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Xt.YXd(),a)}Uzk(){const a=[];for(let b=0;3>b;b++)a.push(Object.assign(new Yk,{textAtLevel:this.Zbg(b),styleAtLevel:this.Wdj(b)}));return a}Vzk(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
Xt.ZXd(),Box4Intl.Box4Strings.L_ListStyleNone)}Zbg(a){a=this.W5.Ezg[a];for(let b=0;9>b;b++)a=Ma.a.replaceAll(a,"%"+(b+1),this.h3i(this.W5.nVc[b]));return a}Wdj(a){const b={};b.fontFamily=6===this.W5.nVc[a]?this.W5.s4f[a]:this.font;return b}VBa(a){const b=this.Zbg(a),c=new Sys.StringBuilder;6===this.W5.nVc[a]&&c.append(String.format("font-family:{0};",this.W5.s4f[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,c.toString(),b)}static YXd(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static ZXd(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(e.a)(Xt,"ListMarkerMultilevel",null,[1132]);class mz{constructor(a,b,c,f,l){this.Ezg=a;this.nVc=b;this.KQj=f;this.s4f=c;this.description=l}}Object(e.a)(mz,"MultilevelDefInfo",null,[]);class OI{twi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle;
let b="";const c=Array(9),f=Array(9),l=Array(9),x=Array(9);for(let F=0;9>F;F++)b+="%"+(F+1)+".",c[F]=b,f[F]=1,l[F]="left";return new mz(c,f,x,l,a)}Hyi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle;const b=Array(9),c=Array(9);for(let f=0;9>f;f++)b[f]=2===f%3?"right":"left";return new mz("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3],c,b,a)}Kvi(){var a=[61558,61656,61607,61623,9830,61656,61607,61623,9830],b=Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle;
const c=Array(9),f=Array(9),l=Array(9);for(let x=0;9>x;x++)l[x]=String.fromCharCode(a[x]),c[x]=6,f[x]="left";return new mz(l,c,"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";"),f,b)}}Object(e.a)(OI,"MultilevelDefInfoAdaptor",null,[]);class wC extends Wt{constructor(){super()}ROd(){const a=new OI,b={};b["0"]=new Xt(null);b["1"]=new Xt(a.twi());b["2"]=new Xt(a.Hyi());b["3"]=new Xt(a.Kvi());return b}}Object(e.a)(wC,"ListMarkerMultilevelLoader",Wt,[]);
class on{constructor(a,b){this.W5=null;this.D0a=a;this.Etc=b}get font(){return"Calibri"}get listStyle(){return this.Etc}get rD(){switch(this.Etc){case 3:case 5:return"right";default:return"left"}}get hla(){return this.W5}get O$c(){switch(this.Etc){case 1:return this.fHa("1","2","3");case 2:return this.fHa("a","b","c");case 3:return this.fHa("i","ii","iii");case 4:return this.fHa("A","B","C");case 5:return this.fHa("I","II","III");case 0:return this.Wzk();default:return this.fHa("1","2","3")}}get E5b(){const a=
[],b={};b.fontFamily=ia.FontUtils.mha(this.font);switch(this.Etc){case 1:return a.push(Object.assign(new Yk,{textAtLevel:this.WM("1"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("2"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("3"),styleAtLevel:b})),a;case 2:return a.push(Object.assign(new Yk,{textAtLevel:this.WM("a"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("b"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("c"),
styleAtLevel:b})),a;case 3:return a.push(Object.assign(new Yk,{textAtLevel:this.WM("i"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("ii"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("iii"),styleAtLevel:b})),a;case 4:return a.push(Object.assign(new Yk,{textAtLevel:this.WM("A"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("B"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("C"),styleAtLevel:b})),a;case 5:return a.push(Object.assign(new Yk,
{textAtLevel:this.WM("I"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("II"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("III"),styleAtLevel:b})),a;case 0:return null;default:return a.push(Object.assign(new Yk,{textAtLevel:this.WM("1"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("2"),styleAtLevel:b})),a.push(Object.assign(new Yk,{textAtLevel:this.WM("3"),styleAtLevel:b})),a}}get levelText(){return this.D0a}fHa(a,b,c){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',
on.YXd(),this.VBa(a),this.VBa(b),this.VBa(c))}Wzk(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',on.ZXd(),Box4Intl.Box4Strings.L_ListStyleNone)}VBa(a){a=this.WM(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}WM(a){return Ma.a.replaceAll(this.D0a,"%1",a)}static YXd(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static ZXd(){const a=
new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(e.a)(on,"ListMarkerNumbering",null,[1132]);class xC extends Wt{constructor(){super();new MI.a(fB.a.Qr())}ROd(){const a={};a["0"]=new on(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new on("%1.",5);a["2"]=new on("%1.",4);a["3"]=new on("%1.",1);a["4"]=new on("%1.",2);a["5"]=new on("%1.",3);a["6"]=new on("%1)",5);a["7"]=new on("%1)",4);a["8"]=new on("%1)",1);a["9"]=new on("%1)",
2);a["10"]=new on("%1)",3);a["11"]=new on("(%1)",5);a["12"]=new on("(%1)",4);a["13"]=new on("(%1)",1);a["14"]=new on("(%1)",2);a["15"]=new on("(%1)",3);return a}}Object(e.a)(xC,"ListMarkerNumberingLoader",Wt,[]);class yC{constructor(){this.Da=null}get name(){return"Box4.ListMarker"}init(){vf.ub()}dispose(){}Wb(a){this.Da=a;this.Da.register(vC,"Box4.ListMarkerGallery.ListMarkerBulletLoader").ma().na(()=>new vC);this.Da.register(xC,"Box4.ListMarkerGallery.ListMarkerNumberingLoader").ma().na(()=>new xC);
this.Da.register(wC,"Box4.ListMarkerGallery.ListMarkerMultilevelLoader").ma().na(()=>new wC)}static main(){m.a.instance.Ac(new yC)}}Object(e.a)(yC,"Box4ListMarkerPackage",null,[2,3]);class zC{constructor(a){this.eod=a}ssg(a){if(!this.eod)return!0;a=cg.a.MLc(a);if(!a)return!1;a=a.toLowerCase();for(let b=0;b<this.eod.length;b++)if(a.endsWith(this.eod[b]))return!0;return!1}}Object(e.a)(zC,"DomainAllowListManager",null,[]);class PI{constructor(a,b){this.dQd=null;this.xDd=a;this.url=b}get tTe(){return cg.a.bma(this.url)}get bB(){return this.xDd}YPe(){const a=
{},b=this.bB;a.a=this.tTe;a.b=this.round(b.navigationStart);a.c=this.round(b.unloadEventStart);a.d=this.round(b.unloadEventEnd);a.e=this.round(b.redirectStart);a.f=this.round(b.redirectEnd);a.g=this.round(b.fetchStart);a.h=this.round(b.domainLookupStart);a.i=this.round(b.domainLookupEnd);a.j=this.round(b.connectStart);a.k=this.round(b.connectEnd);a.l=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.m=this.round(b.requestStart);a.n=this.round(b.responseStart);
a.o=this.round(b.responseEnd);a.q=this.round(b.domInteractive);a.r=this.round(b.domContentLoadedEventStart);a.s=this.round(b.domContentLoadedEventEnd);a.t=this.round(b.domComplete);a.u=this.round(b.loadEventStart);a.v=this.round(b.loadEventEnd);a.w=this.dQd;return a}round(a){return Math.round(1E3*a)/1E3}}Object(e.a)(PI,"PerformanceTimingEntry",null,[]);const QI=(a,b)=>{const c={};let f=null;switch(a){case 0:f="ResourceTiming";a=b.a;null!=a&&(c.Url=a);a=b.b;null!=a&&(c.InitiatorType=a);a=null==b.c?
null:b.c.toString();null!=a&&(c.RedirectStart=a);a=null==b.d?null:b.d.toString();null!=a&&(c.RedirectEnd=a);a=null==b.e?null:b.e.toString();null!=a&&(c.FetchStart=a);a=null==b.f?null:b.f.toString();null!=a&&(c.DomainLookupStart=a);a=null==b.g?null:b.g.toString();null!=a&&(c.DomainLookupEnd=a);a=null==b.h?null:b.h.toString();null!=a&&(c.ConnectStart=a);a=null==b.i?null:b.i.toString();null!=a&&(c.ConnectEnd=a);a=null==b.j?null:b.j.toString();null!=a&&(c.SecureConnectionStart=a);a=null==b.k?null:b.k.toString();
null!=a&&(c.RequestStart=a);a=null==b.l?null:b.l.toString();null!=a&&(c.ResponseStart=a);a=null==b.m?null:b.m.toString();null!=a&&(c.ResponseEnd=a);a=b.n;null!=a&&(c.CustomText=a);a=null==b.o?null:b.o.toString();null!=a&&(c.DecodedBodySize=a);a=null==b.p?null:b.p.toString();null!=a&&(c.EncodedBodySize=a);b=null==b.q?null:b.q.toString();null!=b&&(c.TransferSize=b);break;case 1:f="PerformanceTiming",a=b.a,null!=a&&(c.Url=a),a=null==b.b?null:b.b.toString(),null!=a&&(c.NavigationStart=a),a=null==b.c?
null:b.c.toString(),null!=a&&(c.UnloadEventStart=a),a=null==b.d?null:b.d.toString(),null!=a&&(c.UnloadEventEnd=a),a=null==b.e?null:b.e.toString(),null!=a&&(c.RedirectStart=a),a=null==b.f?null:b.f.toString(),null!=a&&(c.RedirectEnd=a),a=null==b.g?null:b.g.toString(),null!=a&&(c.FetchStart=a),a=null==b.h?null:b.h.toString(),null!=a&&(c.DomainLookupStart=a),a=null==b.i?null:b.i.toString(),null!=a&&(c.DomainLookupEnd=a),a=null==b.j?null:b.j.toString(),null!=a&&(c.ConnectStart=a),a=null==b.k?null:b.k.toString(),
null!=a&&(c.ConnectEnd=a),a=null==b.l?null:b.l.toString(),null!=a&&(c.SecureConnectionStart=a),a=null==b.m?null:b.m.toString(),null!=a&&(c.RequestStart=a),a=null==b.n?null:b.n.toString(),null!=a&&(c.ResponseStart=a),a=null==b.o?null:b.o.toString(),null!=a&&(c.ResponseEnd=a),a=null==b.p?null:b.p.toString(),null!=a&&(c.DomLoading=a),a=null==b.q?null:b.q.toString(),null!=a&&(c.DomInteractive=a),a=null==b.r?null:b.r.toString(),null!=a&&(c.DomContentLoadedEventStart=a),a=null==b.s?null:b.s.toString(),
null!=a&&(c.DomContentLoadedEventEnd=a),a=null==b.t?null:b.t.toString(),null!=a&&(c.DomComplete=a),a=null==b.u?null:b.u.toString(),null!=a&&(c.LoadEventStart=a),a=null==b.v?null:b.v.toString(),null!=a&&(c.LoadEventEnd=a),b=b.w,null!=b&&(c.CustomText=b)}c.Table=f;return Sys.Serialization.JavaScriptSerializer.serialize(c)};var Wh=d(282);class Or{constructor(a,b=null,c=null){this.ki=a;this.sTe=this;this.ULh=b||(()=>window.location.href);this.crd=new zC(c)}run(){if(Or.Rza(window.performance))try{const l=
this.ULh();if(Or.XWh.exec(l)&&this.crd.ssg(l)){var a=new PI(window.performance.timing,l);tj.a.instance.oIk(a.bB.fetchStart);tj.a.instance.qIk(a.bB.navigationStart);tj.a.instance.DVa(Wh.a.wUi,"connectStart","requestStart");tj.a.instance.DVa(Wh.a.CUi,"requestStart","responseStart");tj.a.instance.DVa(Wh.a.EUi,"responseStart","responseEnd");this.sTe.m9a(1,a.YPe());this.ki.ic(Wh.a.rBa,a.bB.fetchStart);this.ki.ic(Wh.a.AUi,a.bB.domainLookupStart);this.ki.ic(Wh.a.Z4f,a.bB.domainLookupEnd);this.ki.ic(Wh.a.yUi,
a.bB.connectStart);this.ki.ic(Wh.a.FUi,a.bB.secureConnectionStart);this.ki.ic(Wh.a.xUi,a.bB.connectEnd);this.ki.ic(Wh.a.a5f,a.bB.requestStart);this.ki.ic(Wh.a.TJc,a.bB.responseStart);this.ki.ic(Wh.a.$4f,a.bB.responseEnd-a.bB.responseStart);this.ki.ic(Wh.a.DUi,a.bB.responseStart-a.bB.requestStart);var b=0,c=0,f=0;({transferSize:b,SSd:c,oQd:f}=this.nql(l)).returnValue&&(this.ki.ic(Wh.a.GUi,b),this.ki.ic(Wh.a.zUi,f),this.ki.ic(Wh.a.BUi,c));this.ki.ic(Wh.a.JZb,a.bB.navigationStart)}}catch(l){Z.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",l)}}nql(a){let b,c,f;f=c=b=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:b,SSd:c,oQd:f};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:b,SSd:c,oQd:f};a=a[0];var l=a.transferSize;void 0!==b&&null!==b&&(b=l);l=a.decodedBodySize;void 0!==l&&null!==l&&(f=l);a=a.encodedBodySize;void 0!==
a&&null!==a&&(c=a);return{returnValue:!0,transferSize:b,SSd:c,oQd:f}}m9a(a,b){Z.ULS.sendTraceTag(4551815,306,50,QI(a,b))}static get instance(){return Or.Ja||(Or.Ja=new Or(og.a.instance,null,u.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?u.AFrameworkApplication.fa.HB("ResourceLoggerDomainAllowList"):null))}static Rza(a){return!(void 0===a||null===a)&&!(void 0===a.timing||null===a.timing)}}Or.Ja=null;Or.XWh=RegExp("^https?://.*","i");Object(e.a)(Or,"PerformanceTimingLogger",
null,[1128]);class Gs{constructor(a,b){this.dQd=null;this.xDd=a;this.behavior=b;this.url=this.bB.name}get tTe(){return 2===this.behavior?this.url:cg.a.bma(this.url)}get bB(){return this.xDd}YPe(){const a={},b=this.bB;a.a=this.tTe;a.b=b.initiatorType;a.c=this.round(b.redirectStart);a.d=this.round(b.redirectEnd);a.e=this.round(b.fetchStart);a.f=this.round(b.domainLookupStart);a.g=this.round(b.domainLookupEnd);a.h=this.round(b.connectStart);a.i=this.round(b.connectEnd);a.j=void 0!==b.secureConnectionStart&&
null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.k=this.round(b.requestStart);a.l=this.round(b.responseStart);a.m=this.round(b.responseEnd);a.o=this.round(Gs.ysb(b,"decodedBodySize"));a.p=this.round(Gs.ysb(b,"encodedBodySize"));a.q=this.round(Gs.ysb(b,"transferSize"));a.n=this.dQd;return a}round(a){return Math.round(1E3*a)/1E3}static ysb(a,b){return a[b]}}Object(e.a)(Gs,"ResourceTimingEntry",null,[1168]);class RI{constructor(a,b=null,c=100){this.UVe=a;this.dxc=b;this.rKb={};
this.iIh=c}cpl(a){var b=a.name.toLowerCase();const c=cg.a.u_d(b);this.tUk(c,b)&&(c in this.rKb?Z.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.KOj(a),b.encodedsize=Gs.ysb(a,"encodedBodySize"),b.decodedsize=Gs.ysb(a,"decodedBodySize"),this.rKb[c]=b))}tUk(a,b){if(this.UVe)return Array.contains(this.UVe,a);if(this.dxc)for(a=cg.a.TE(b),b=0;b<this.dxc.length;b++)if(this.dxc[b]&&
a.endsWith(this.dxc[b]))return!0;return!1}KOj(a){try{const b=Gs.ysb(a,"transferSize");if(void 0!==b&&null!==b)return!b;Z.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.iIh}catch(b){Z.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",b.message)}return!1}cJk(){if(xa.a.Va(this.rKb))Z.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var a=u.AFrameworkApplication.hS?u.AFrameworkApplication.hS.split(";"):[],b=Object.assign(new Fk.a,{extendedProperties:Mq.a.pz()});b.extendedProperties.set("Flights",fe.c(a));this.CWj(b,this.rKb,Se.Health.instance)}}CWj(a,b,c){if(b){var f=0,l=0,x=0,F=0,R=0,fa=0,wa=0,Xa=0,lb=0,Lb=0,kc=0;for(let Ec in b){var lc=b[Ec];try{const Jc=Object(va.a)(Object,lc);if(!Jc)continue;const Dc=Jc.iscached?Boolean.parse(Jc.iscached.toString()):!1,Wd=Jc.fetchstart?this.parseFloat(Jc.fetchstart.toString()):0,xe=
(Jc.responseend?this.parseFloat(Jc.responseend.toString()):0)-Wd,Sd=Jc.encodedsize?this.parseFloat(Jc.encodedsize.toString()):0,Pe=Jc.decodedsize?this.parseFloat(Jc.decodedsize.toString()):0;f+=xe;F+=Sd;wa+=Pe;Lb++;Dc?(x+=xe,fa+=Sd,lb+=Pe,kc++):(l+=xe,R+=Sd,Xa+=Pe)}catch(Jc){Z.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Jc.message)}}a.extendedProperties.set("StaticResources",fe.c(b));a.extendedProperties.set("TotalResourceDownloadLatency",
f.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",l.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",x.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",F.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",R.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",fa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",wa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",
Xa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",lb.toString());a.extendedProperties.set("TotalNumberOfResourcesDownloaded",Lb.toString());a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",kc.toString());c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(e.a)(RI,
"AppStaticResourceManager",null,[]);class SI extends Sys.EventArgs{constructor(a){super();this.entries=a}}Object(e.a)(SI,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class lv{constructor(a,b,c=null,f=null,l=100){this.wvd=!1;this.Hm=null;this.tLb=0;this.Pa=new qd.a;this.vKb=null;this.Sfa=!1;this.exf=0;this.Rd=a;this.fZe=0;this.sTe=this;this.crd=new zC(c);this.NC=b;f&&(this.vKb=new RI(null,f,l))}get oIf(){try{return!(void 0===this.NC||null===this.NC)&&!(void 0===this.NC.getEntriesByType||null===this.NC.getEntriesByType)}catch(a){return Z.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",a),!1}}get cDi(){return this.fZe}get isActive(){return this.Sfa}get QPe(){return this.exf}gCf(a){this.Pa.addHandler(lv.wTd,a)}Gch(a){this.Pa.removeHandler(lv.wTd,a)}Wb(a,b){const c=this.QPe!==a;this.exf=a;this.isActive&&this.Rd&&c&&(this.Qg(),this.Gb());this.fZe=b}activate(){!this.isActive&&this.oIf&&(this.Gb(),this.Sfa=!0)}deactivate(a){this.isActive&&(this.Qg(),a&&this.flush(),this.Sfa=!1)}flush(){if(this.isActive&&
this.oIf)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.tLb&&Z.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",a.length-this.tLb);const b=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);b&&(window.performance.clearResourceTimings(),this.tLb=0);const c=[];for(let f=this.tLb;f<a.length;f++)this.crd.ssg(a[f].name)&&(this.vKb&&this.vKb.cpl(a[f]),c.push(new Gs(a[f],
this.cDi)));b||(this.tLb=a.length);this.Pa.raiseEvent(lv.wTd,new SI(c));for(a=0;a<c.length;a++)0!==c[a].behavior&&2!==c[a].behavior||this.sTe.m9a(0,c[a].YPe());0<c.length&&Z.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",c.length)}catch(b){Z.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",b)}}m9a(a,b){Z.ULS.sendTraceTag(4310804,306,50,QI(a,b))}jIk(){this.vKb.cJk()}Gb(){this.Rd&&0<this.QPe&&
(this.Hm=new He.a(3,2,1E3*this.QPe,()=>{this.flush()},5),this.Rd.Gb(this.Hm),this.wvd=!0)}Qg(){this.wvd&&(this.Rd.Qg(this.Hm),this.Hm=null,this.wvd=!1)}}lv.wTd="EntriesAvailable";Object(e.a)(lv,"ResourceTimingLogger",null,[1113,1128]);class AC{constructor(){this.Da=null}get name(){return"Common.ResourceTiming"}init(){this.Da.resolve("Common.NetworkTiming.IResourceTimingLogger");Or.instance.run()}dispose(){}Wb(a){this.Da=a;let b=null;if(u.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{b=
u.AFrameworkApplication.fa.HB("ResourceLoggerDomainAllowList")}catch(l){Z.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const c=[];c.push(cg.a.TE(sp.a.pO).toLowerCase());c.push(cg.a.TE(sp.a.KGb).toLowerCase());const f=u.AFrameworkApplication.fa.Ec("AppStaticResourceMonitorCacheThresholdInMs",100);a.register(1113,"Common.NetworkTiming.IResourceTimingLogger").ma().na(()=>new lv(u.AFrameworkApplication.ue,window.performance,b,c,f))}static main(){m.a.instance.Ac(new AC)}}
Object(e.a)(AC,"ResourceTimingPackage",null,[2,3]);class mv{}mv.visible="visible";mv.hidden="hidden";Object(e.a)(mv,"PlatformVisibilityState",null,[]);var nz=d(192);class TI extends Sys.EventArgs{constructor(a,b){super();this.Jcf={};this.$Qh=a;this.IQh=b}get oldState(){return this.$Qh}get newState(){return this.IQh}xeb(a,b){this.Jcf[a]=b}toString(){return fe.c(this.Jcf)}}Object(e.a)(TI,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class BC{constructor(a,b,c,f){this.cxf=this.AMa=null;this.juf=
!0;this.Pa=new qd.a;this.Rd=a;this.xsd=b;this.pZe=c;this.aYh=f;this.m$e=!1;u.AFrameworkApplication.fa&&(this.m$e=u.AFrameworkApplication.fa.ka("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),this.juf=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.WVe=0;this.axf=new Date;this.xsd()===mv.hidden&&this.hRf();$addHandler(window,"focus",Object(D.a)(this,this.YZg,"onPlatformFocusHandler"));$addHandler(window,"blur",Object(D.a)(this,this.V7c,
"onPlatformBlurHandler"));$addHandler(document,"freeze",Object(D.a)(this,this.ZZg,"onPlatformFreezeHandler"));$addHandler(document,"visibilitychange",Object(D.a)(this,this.$Zg,"onPlatformVisibilityChangeHandler"));this.juf&&($addHandler(document,"pageshow",Object(D.a)(this,this.V7c,"onPlatformBlurHandler")),$addHandler(document,"resume",Object(D.a)(this,this.V7c,"onPlatformBlurHandler")))}get U2a(){return this.WVe}get isVisible(){return 2!==this.U2a}Mzc(a){this.Pa.addHandler("VST",a)}fQk(a){this.Pa.removeHandler("VST",
a)}V7c(a){this.JIb(a.type,this.S1d())}YZg(a){this.JIb(a.type,0)}ZZg(a){3!==this.U2a&&(this.ENf(),this.JIb(a.type,2),this.JIb(a.type,3),u.AFrameworkApplication.Pg.Zak())}S1d(){return this.xsd()===mv.hidden?2:document.hasFocus()?0:1}JIb(a,b){const c=this.U2a;this.WVe=b;if(c!==this.U2a){3===c&&this.m$e&&this.$Xk();const f=new Date,l=new TI(c,this.U2a);l.xeb("FromState",jj[c]);l.xeb("ToState",jj[b]);l.xeb("OriginatingEvent",a);l.xeb("TimeInState",(+f-+this.axf).toString());this.axf=f;this.aYh.tBg(l);
this.Pa.raiseEvent("VST",l)}}$Zg(a){this.xsd()===mv.hidden?this.AMa?this.Rd.B4(this.AMa,this.pZe):this.hRf():(this.ENf(),this.JIb(a?a.type:"",this.S1d()))}dispose(){$removeHandler(window,"focus",Object(D.a)(this,this.YZg,"onPlatformFocusHandler"));$removeHandler(window,"blur",Object(D.a)(this,this.V7c,"onPlatformBlurHandler"));$removeHandler(document,"freeze",Object(D.a)(this,this.ZZg,"onPlatformFreezeHandler"));$removeHandler(document,"visibilitychange",Object(D.a)(this,this.$Zg,"onPlatformVisibilityChangeHandler"))}ENf(){this.AMa&&
(this.Rd.Qg(this.AMa),this.AMa=null)}hRf(){this.AMa=new He.a(4,1,this.pZe,Object(D.a)(this,this.Rpj,"handleVisibilityUpdate"),157);this.Rd.Gb(this.AMa)}Rpj(){this.AMa=null;this.JIb("TaskItem",this.S1d())}WXj(a){Z.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",a.BBg,+new Date-+this.cxf,nz.SessionStatusManager.instance.tia)}$Xk(){this.cxf=new Date;this.Rd.Gb(this.DWb(0,"Realtime"));this.Rd.Gb(this.DWb(1,"AboveNormal"));this.Rd.Gb(this.DWb(2,
"Normal"));this.Rd.Gb(this.DWb(3,"Background"));this.Rd.Gb(this.DWb(4,"Low"))}DWb(a,b){return new He.a(a,1,0,Object(D.a)(this,this.WXj,"logTimeToExecuteTask"),0,b)}}Object(e.a)(BC,"VisibilityManager",null,[1130,106]);class UP{tBg(){}}Object(e.a)(UP,"NullVisibilityManagerTelemetry",null,[1131]);class oz{constructor(){this.Pa=new qd.a}tBg(a){Z.ULS.sendTraceTag(590901976,324,50,a.toString())}static create(){return new oz}}Object(e.a)(oz,"VisibilityManagerTelemetry",null,[1131]);class CC{constructor(){this.Da=
null}get name(){return"Common.App.VisibilityManager"}init(){this.Da.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const a=this.Da.pb("Common.App.VisibilityManagement.VisibilityManager");a&&a.dispose()}Wb(a){this.Da=a;this.Da.register(oz,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").na(()=>oz.create()).ma();this.Da.register(BC,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").na(()=>
new BC(u.AFrameworkApplication.ue,()=>window.document.visibilityState,6E4*u.AFrameworkApplication.fa.Ec("VisibilityManagerDelayTransitionToHiddenInMin",1),this.Da.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).ma()}static main(){m.a.instance.Ac(new CC)}}Object(e.a)(CC,"VisibilityManagerPackage",null,[2,3]);var VP=d(1176);class UI{constructor(a,b){this.OXc=new Me.a;this.RXc=new Me.a;this.tzb=b;this.sTa=a}kp(a){!a||this.OXc.Jb(a.id)||this.RXc.Jb(a.id)||this.sTa.kp(a)}Zah(a){this.KKk(a)}$ah(a){this.MKk(a)}KKk(a){var b=
null;this.tzb&&a&&(this.kp(a),b=b||Object(D.a)(this,this.Sue,"onDragOver"),this.OXc.$(a.id,b),this.sTa.ob(qa.a.drop,a,b))}MKk(a){var b=null;this.tzb&&a&&(this.kp(a),b=b||Object(D.a)(this,this.Tue,"onDrop"),this.RXc.$(a.id,b),this.sTa.ob(qa.a.N4a,a,b))}xb(a){this.tzb&&a&&(this.sTa.Iq(a),this.OXc.ga(a.id)&&this.sTa.xb(qa.a.N4a,a,this.OXc.ga(a.id)),this.RXc.ga(a.id)&&this.sTa.xb(qa.a.drop,a,this.RXc.ga(a.id)))}ctj(){this.sTa&&this.sTa.dispose()}Tue(a){a=a.lc;a.preventDefault();a.stopPropagation();return!0}Sue(a){a=
a.lc;a.preventDefault();a.stopPropagation();return!0}}Object(e.a)(UI,"PPTDragDropInputHelper",null,[1092]);class DC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.DragDrop"}Wb(a){if(!a)throw Error.argumentNull("container");this.K=a;this.K.register(1092,"PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ma().na(()=>new UI(VP.a.instance,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointDragInsertImageIsEnabled))}init(){const a=this.K.resolve("PowerPointWebEditor.AppFrame").AHd;
a?(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Zah(a),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").$ah(a)):(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Zah(this.K.resolve("PowerPointWebEditor.AppFrame").F0),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").$ah(this.K.resolve("PowerPointWebEditor.AppFrame").F0))}dispose(){this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").xb(this.K.resolve("PowerPointWebEditor.AppFrame").AHd);
this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ctj()}static main(){m.a.instance.Ac(new DC)}}Object(e.a)(DC,"PPTWebEditorDragDropPackage",null,[2,3]);class VI{constructor(a){this.qSh=a}pKe(){return Math.random()<this.qSh}}Object(e.a)(VI,"RandomSampler",null,[1501]);class WI{constructor(a){this.LMb=null;this.ZUh=a}XSb(a,b){if("ForceSample"===b||this.ZUh())this.LMb||(this.LMb=[]),Array.add(this.LMb,a)}getData(){return this.LMb}reset(){this.LMb=null}}Object(e.a)(WI,"SampleDataAggregator",
null,[1495]);var XI=d(525);class YI{constructor(){this.metadata=null;this.duration=this.ths=this.timeStamp=0;this.isCoauth=null}}Object(e.a)(YI,"PPTEventTimingData",null,[]);class zq{constructor(){this.Zne=!1;this.E8={};this.Q6j=a=>{window.requestAnimationFrame(a)};this.rxb=[];this.E8.ArrowDown=!0;this.E8.ArrowLeft=!0;this.E8.ArrowRight=!0;this.E8.ArrowUp=!0;this.E8.Backspace=!0;this.E8.Delete=!0;this.E8.End=!0;this.E8.Enter=!0;this.E8.Home=!0;this.E8.PageDown=!0;this.E8.PageUp=!0;this.E8.Tab=!0}jkc(a){return a.ctrlKey&&
"Control"!==a.key||a.altKey&&"Alt"!==a.key||a.key in this.E8}gei(a){const b={};b.key=this.jkc(a)?a.key:" "===a.key?"Space":"Char";b.alt=(void 0===a.altKey||null===a.altKey?!1:a.altKey).toString();b.ctrl=a.ctrlKey.toString();b.shift=a.shiftKey.toString();return b}Msh(a){const b=new YI;b.metadata=this.gei(a);b.ths=window.performance.now()-a.timeStamp;b.timeStamp=a.timeStamp;b.isCoauth=zq.JNa?(!zq.JNa.amIAlone).toString():"null";this.rxb.push(b);this.ZLk()}cth(a){if(this.rxb.length)for(const b of this.rxb)if(b.timeStamp===
a.timeStamp){b.duration=window.performance.now()-a.timeStamp-b.ths;break}}ZLk(){this.Zne||(this.Q6j(()=>{this.Zne=!1;window.dispatchEvent(XI.a.instance.create(qa.a.dHd,this.rxb.slice(0,this.rxb.length)));this.rxb=[]}),this.Zne=!0)}keyPressedEventHandlerStart(a){zq.SRc(a)&&!this.jkc(a)&&this.Msh(a)}keyPressedEventHandlerEnd(a){zq.SRc(a)&&!this.jkc(a)&&this.cth(a)}keyDownEventHandlerStart(a){zq.SRc(a)&&this.jkc(a)&&this.Msh(a)}keyDownEventHandlerEnd(a){zq.SRc(a)&&this.jkc(a)&&this.cth(a)}static get JNa(){return zq.oOf||
(zq.oOf=hb.a.instance.pb("PowerPointWebEditor.ICoauthStateGetter"))}static SRc(a){return!!a&&a.timeStamp<window.performance.now()}}zq.oOf=null;Object(e.a)(zq,"PPTEventTimingMeter",null,[1087]);class Pr{constructor(){this.n8b=[];this.Oyb=this.G_c=this.cFa=this.R1c=null;this.Q1c=0;this.o_c=!1}start(a){if(!this.o_c){Array.clear(this.n8b);for(let b=0;b<Pr.IZb.length;++b)this.n8b.push(0);this.R1c=window.setInterval(Object(D.a)(this,this.ueh,"reportMeasuredFrames"),1E3*a);this.Q1c=window.performance.now();
this.QSe(null);$addHandler(window,"visibilitychange",Object(D.a)(this,this.QSe,"updateMeasureCurrentFrameLoop"));this.o_c=!0}}stop(){this.o_c&&($removeHandler(window,"visibilitychange",Object(D.a)(this,this.QSe,"updateMeasureCurrentFrameLoop")),null!=this.R1c&&(window.clearInterval(this.R1c),this.R1c=null),null!=this.cFa&&(window.cancelAnimationFrame(this.cFa),this.cFa=null),this.ueh(),this.o_c=!1)}ueh(){if(null!=this.Oyb){var a={};for(var b=0;b<Pr.IZb.length;++b)a[Pr.IZb[b].toString()]=this.n8b[b],
this.n8b[b]=0;b=window.performance.now();var c={};c.intervalStart=this.Q1c;c.duration=b-this.Q1c;c.maxFrameLengthMs=this.Oyb;c.frameData=a;window.dispatchEvent(XI.a.instance.create(qa.a.zEe,c));this.Oyb=null;this.Q1c=b}}QSe(){Pr.$Jj&&null==this.cFa?(this.G_c=null,this.cFa=window.requestAnimationFrame(Object(D.a)(this,this.xSg,"measureCurrentFrame"))):null!=this.cFa&&(window.cancelAnimationFrame(this.cFa),this.cFa=null)}xSg(a){if(null!=this.G_c){const b=a-this.G_c;if(null==this.Oyb||this.Oyb<b)this.Oyb=
b;for(let c=0;c<Pr.IZb.length;++c)if(b<Pr.IZb[c]){++this.n8b[c];break}}this.G_c=a;this.cFa=window.requestAnimationFrame(Object(D.a)(this,this.xSg,"measureCurrentFrame"))}static get $Jj(){return"visible"===window.document.visibilityState}}Pr.IZb=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Object(e.a)(Pr,"PPTFrameTimingMeter",null,[1088]);class EC{constructor(){this.S$b=this.r6b=null;this.CIg=this.vIg=!1}Wb(a){window.performance&&window.performance.now&&window.requestAnimationFrame&&
(u.AFrameworkApplication.fa.ka("PodEventTimingMeterIsEnabled")&&!n.a.xj&&(a.register(1087,"Common.IEventTimingMeter").ma().na(()=>new zq),this.vIg=!0),a.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterIsEnabled&&(a.register(1088,"Common.IFrameTimingMeter").ma().na(()=>new Pr),this.CIg=!0))}get name(){return"PowerPointWebEditor.EventTimingMeter"}init(){if(this.vIg){var a=new VI(u.AFrameworkApplication.fa.Ec("PodEventTimingMeterEventSamplingPercent",0)/100);a=new WI(Object(D.a)(a,
a.pKe,"shouldBeInSample"));const b=Ro.a.qV(16,1,a);this.r6b=c=>{if(c&&(c=c.rawEvent.detail))for(const f of c)b.track(f,"EventTimingData")};yd.a.addHandler(window.self,qa.a.dHd,this.r6b)}this.CIg&&(this.S$b=b=>{b&&(b=b.rawEvent)&&ya.a.J(39706653,306,50,fe.c(b.detail))},yd.a.addHandler(window.self,qa.a.zEe,this.S$b))}dispose(){this.r6b&&(yd.a.removeHandler(window.self,qa.a.dHd,this.r6b),this.r6b=null);this.S$b&&(yd.a.removeHandler(window.self,qa.a.zEe,this.S$b),this.S$b=null)}static main(){m.a.instance.Ac(new EC)}}
Object(e.a)(EC,"PPTEventTimingMeterPackage",null,[2,3]);var FC=d(444);class ZI{constructor(a){this.Cdf=new Me.a(null);this.vLh=a}ga(a){let b;({value:b}=this.Cdf.Of(a)).returnValue||(b=this.vLh(a),this.Cdf.$(a,b));return b}}Object(e.a)(ZI,"MemoizedLookup",null,[1527]);var WP=d(821),XP=d(694);class GC{constructor(a){this.Ftk=0;this.WN=a}}Object(e.a)(GC,"GraphMergerResponse",null,[]);var YP=d(311);class HC extends Yg.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=
this.BaseRevisions=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Reason=this.Source=0}Ik(){return 33}static construct(a,b,c,f,l,x,F,R,fa){const wa=new HC;wa.BaseRevisions=a;wa.TheirRevisions=b;wa.YourRevisions=c;wa.IgnoreConflictsInLastServerRevision=f;wa.MergeHint=l;wa.ObjectSpaceId=x?we.a(x):null;wa.RequestId=F?we.a(F):null;wa.Source=R;wa.Reason=fa;return wa}}Object(e.a)(HC,"CreateGraphMergeReplayRequest",Yg.a,[]);d(814);class pz{Sa(a){return a.Sa(void 0)}hcg(a,
b){return a.sa(b,null)}OMc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Hf.a(a)}kcg(a,b){return a.sa(b,"")}Hlh(a,b,c){a.setValue(b,c)}}Object(e.a)(pz,"MergeableObjectUtilities",null,[1118]);class ZP{constructor(a,b=null,c=null){this.$wd=b||new pz;c||Object(D.a)(this,this.DHi,"doParagraphMergeNoOP")}DHi(a,b){return{KDl:a,JDl:b}}}Object(e.a)(ZP,"GraphMergeSelectionRecordUpdater",null,[]);class $I{constructor(){this.source=0;this.ru=this.VJb=this.dJa=null;this.Pbc=0;this.FPc=!1;this.nNe=0}}Object(e.a)($I,
"InputState",null,[]);class aJ{constructor(){this.timeout=this.succeeded=this.crash=!1;this.WN=null}}Object(e.a)(aJ,"OutputState",null,[]);class bJ{constructor(){this.cKc=this.Sgd=this.tkc=!1;this.UYa=this.Krl=this.CPi=this.Qre=this.Kzh=this.Z1f=this.rHf=this.NDc=null}}Object(e.a)(bJ,"RuntimeState",null,[]);class cJ{constructor(){this.input=new $I;this.runtime=new bJ;this.output=new aJ}}Object(e.a)(cJ,"MergeState",null,[]);var Yc=d(1059);class ux{constructor(a,b,c){this.ISh=a;this.aRh=b;this.JQh=
c;this.jud=new le.a(Object(D.a)(this,this.Mki,"checkIfDifferent"))}get PDb(){return this.ISh}get oldValue(){return this.aRh}get newValue(){return this.JQh}get B7(){return!!this.newValue&&!this.oldValue}get isDeleted(){return!this.newValue&&!!this.oldValue}get Z7a(){return this.B7||this.isDeleted||this.jud.value}Mki(){return this.B7||this.isDeleted?!0:!Yc.a.lGf(this.PDb,this.oldValue,this.newValue)}}Object(e.a)(ux,"PropertyDiff",null,[]);class vx{constructor(a,b){this.YQh=a;this.GQh=b;this.jud=new le.a(()=>
this.FRc(null));this.KSh=new le.a(Object(D.a)(this,this.KMi,"evaluatePropertyDiffs"))}get TBb(){return this.YQh}get h4(){return this.GQh}get B7(){return!!this.h4&&!this.TBb}get isDeleted(){return!this.h4&&!!this.TBb}get Z7a(){return this.B7||this.isDeleted||this.jud.value}get DWa(){return this.KSh.value}FRc(a){let b=!1;this.DWa.forEach((c,f)=>{b=f.Z7a&&(!a||7!==a.ga(c));return!b});return b}KMi(){const a=new Me.a;var b=this.h4,c=this.TBb;if(this.B7){c=b.Bz();for(var f=0;f<c.length;f++){var l=c[f];
a.$(Yc.a.qb(l),new ux(l,null,b.mra(l)))}}else if(this.isDeleted)for(b=c.Bz(),f=0;f<b.length;f++)l=b[f],a.$(Yc.a.qb(l),new ux(l,c.mra(l),null));else{f=c.Bz();for(l=0;l<f.length;l++){var x=f[l];a.$(Yc.a.qb(x),new ux(x,c.mra(x),b.Sa(x)?b.mra(x):null))}f=b.Bz();for(l=0;l<f.length;l++)x=f[l],c.Sa(x)||a.$(Yc.a.qb(x),new ux(x,null,b.mra(x)))}return a}}Object(e.a)(vx,"MergeableObjectDiff",null,[]);class wx{constructor(a,b){this.d4=b?a.M3a():a;this.Sxc=new oa.a}h6k(a){this.Sxc=a}LSg(a){(new vx(this.d4,a)).DWa.forEach((b,
c)=>{c.Z7a&&!this.Sxc.contains(b)&&(this.Sxc.add(b),c.isDeleted?(c=this.d4,c.Sa(Yc.a.Vqa(b))&&c.removeProperty(Yc.a.Vqa(b))):this.d4.fIa(Yc.a.Vqa(b),c.newValue));return!0})}}Object(e.a)(wx,"PartialMergeResult",null,[]);class dJ extends Yg.a{constructor(){super();this.Location=null}Ik(){return 34}static construct(a){const b=new dJ;b.Location=a;return b}}Object(e.a)(dJ,"PlayGraphMergeReplayRequest",Yg.a,[]);class nv{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){this.Kde=new WP.a;this.v7j=a;this.P4j=b;this.sUa=
c(this.K_b());this.o1j=f;this.p1j=l;this.b2c=x;this.l0c=F;this.FGg=R;this.l1j=Xa;this.m1j=fa;this.n1j=wa}qK(){return(new Date).getTime()}Dgb(a,...b){return String.format.apply(null,[a].concat(b))}Mll(a){throw Ia.a.invalidOperation(a);}E2i(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",a.name,a.message,a.stack)}Gmj(a,b,c,f){f.$(a,new wx(b,!1));Z.ULS.sendTraceTag(19019783,808,50,"Merging Object: [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored.",
a,c.Oe);return!0}Tvl(a,b){const c=new vo.a;c.id=Te.a.kea;c.fIa(ub.a.Cdd,5===b?2:4);a.xBf(c);a.Rjd().hwa(c.id,4)}zZk(a){var b=!a.output.succeeded&&(this.m1j||a.output.crash),c=!!a.input.dJa&&0<a.input.dJa.length;if(c=this.n1j&&c&&(this.l1j||b)){b=c?Ga.a.create():Ga.a.nil;c=c?String.format(" [Merge Request Id: {0}]",b):"";nv.KWj(a,c);var f,l;({Zai:x,Gll:f,KBl:l}=this.fAi(a,Object(D.a)(this,this.TSf,"createSerializedRevisionFrom")));c=nv.M3i(a);b=HC.construct(x._list,f._list,l._list,a.input.FPc,a.input.Pbc,
a.input.ru,b,a.input.source,c);var x=a.output.WN;3===c&&0<x.length&&(b.MergedRevision=this.TSf(a.output.WN.last()));a=new YP.a;a.bH=b;a.status=1;b=this.Kde.YZb(0,null);b.CY(a);b.MAa()}}TSf(a){const b=a.aV,c=Gb.App.Fb.Ed.zi;return new XP.a(a,b,c.ri,null,c.Chc,c.contextId,b?b.id:Ga.a.nil,this.b2c,!1,!0)}V4c(a,b,c,f,l,x,F){c=this.qyi(a,b,f,l,x,F);f=0;const R=c.runtime.Sgd;try{if(R){const fa=a.length?a.getItemAt(a.length-1):null,wa=b.length?b.getItemAt(b.length-1):null;Z.ULS.sendTraceTag(18641173,808,
50,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",a.length,fa?fa.id:Ga.a.nil,fa?fa.aV?fa.aV.id:Ga.a.nil:Ga.a.nil,b.length,wa?wa.id:Ga.a.nil,wa?wa.aV?wa.aV.id:Ga.a.nil:Ga.a.nil,l,x,this.l0c,this.FGg,F)}for(a=!0;f<this.sUa.length&&a;f++)a=(0,this.sUa[f])(c);return new GC(c.output.WN)}catch(fa){const wa=
!c.output.timeout;c.output.crash=wa;const Xa=String.format("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",wa?"Crashed":"Timed Out",this.E2i(fa),!!c.output.WN);wa?Z.ULS.sendTraceTag(18613134,808,10,"MergeChanges Crash. [Error: {0}]",Xa):Z.ULS.sendTraceTag(18613136,808,15,"MergeChanges Timeout. [Error: {0}]",Xa);if(c.output.WN)return new GC(c.output.WN);throw fa;}finally{c.output.succeeded?R&&Z.ULS.sendTraceTag(18613138,808,50,this.u_b(c,f,"Succeeded")):c.output.timeout?Z.ULS.sendTraceTag(18641178,
808,15,this.u_b(c,f,"Timeout")):c.output.crash?c.output.WN?Z.ULS.sendTraceTag(18613142,808,15,this.u_b(c,f,"Crash - Rejection")):Z.ULS.sendTraceTag(18613144,808,15,this.u_b(c,f,"Crash - Failed")):R&&Z.ULS.sendTraceTag(18613140,808,50,this.u_b(c,f,"Rejection")),this.zZk(c)}}u_b(a,b,c){const f=a.output.WN,l=f&&f.length?f.getItemAt(f.length-1):null;return this.Dgb("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",c,this.qK()-
a.input.nNe,b,f?f.length:0,l?l.id:Ga.a.nil,l?l.aV?l.aV.id:Ga.a.nil:Ga.a.nil,a.input.source)}qyi(a,b,c,f,l,x){const F=new cJ,R=F.input;R.dJa=a;R.VJb=b;R.ru=c;R.Pbc=f;R.FPc=l;R.nNe=this.qK();R.source=x;a=F.runtime;a.cKc=this.FGg;a.tkc=!0;a.Sgd=!0;let fa="";a.UYa=wa=>{if(this.l0c){var Xa=this.qK()-R.nNe,lb=Xa>this.l0c;fa+=this.Dgb(" ({0}: {1})",wa,Xa);lb&&(F.output.timeout=!0,wa=this.Dgb("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",this.l0c,wa,
Xa,fa),this.Mll(wa))}};return F}K_b(){return[Object(D.a)(this,this.Vqk,"otherAuthorsHaveChangesToMerge"),Object(D.a)(this,this.AHj,"isInputValid"),Object(D.a)(this,this.Oxj,"initializeOutputMergeState"),Object(D.a)(this,this.hyj,"initializeRuntimeMergeState"),Object(D.a)(this,this.oql,"tryObjectMerge"),Object(D.a)(this,this.g0h,"addMergeResultsToOutput")]}Vqk(a){const b=a.input.dJa;a=a.output;return b?b.length?!0:(Z.ULS.sendTraceTag(18613150,808,100,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),
a.WN=b,a.succeeded=!0,!1):(Z.ULS.sendTraceTag(18613148,808,100,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),a.WN=b,a.succeeded=!0,!1)}AHj(a){var b=a.input;const c=b.dJa,f=b.VJb,l=b.ru,x=b.Pbc;b=b.FPc;a=a.output;if(!f||!f.length)return a.WN=c,!1;let F=!0;if(2!==x&&1!==x)return a.WN=c,!1;l&&l!==Ga.a.nil||(F=!1);c.length<(b?2:1)&&(Z.ULS.sendTraceTag(18613155,808,100,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",
b),F=!1);F||(a.WN=2===x?c:f);return F}hyj(a){var b=a.input,c=b.dJa,f=b.VJb;const l=b.Pbc;let x,F;({Fll:x,JBl:F,NDc:b}=this.H5i(a,c,f,b.FPc));if(!b)return Z.ULS.sendTraceTag(18613185,808,15,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",x.id,F.id),this.iBg(x,c.length,"TheirChanges"),this.iBg(F,f.length,"YourChanges"),a.output.WN=2===l?c:f,!1;a.runtime.NDc=b;({Irl:c,APi:f}=this.vFi(l,x,F));({Jrl:b,BPi:c,$ai:f}=nv.p7i(a,c,f,b));a.runtime.rHf=f;
a.runtime.Kzh=b;a.runtime.Z1f=c;a.runtime.Qre=new Me.a;return!0}iBg(a,b,c){const f=new Hf.a;for(;a;)f.add(a),a=a.aV;const l=new Sys.StringBuilder;l.append(this.Dgb("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",c,b,f.length));let x=f.length,F=0;f.forEach(R=>({xkg:x,ABg:F}=this.g1h(l,R,f,x,F)).returnValue);Z.ULS.sendTraceTag(18613187,808,50,l.toString())}g1h(a,b,c,f,l){a.append(this.Dgb(" [{0} {1} {2}]",f,b.bja?"S":"B",b.id));f--;l++;return 50<l&&c.length!==l?(a.append(" ...Truncated."),{returnValue:!1,
xkg:f,ABg:l}):{returnValue:!0,xkg:f,ABg:l}}H5i(a,b,c,f){b=b.getItemAt(b.length-1-(f?1:0));c=c.getItemAt(c.length-1);f=b.VKc(c);a.runtime.UYa("GetCommonBase");return{Fll:b,JBl:c,NDc:f}}vFi(a,b,c){2===a?(a=b,b=c):a=c;return{Irl:b,APi:a}}Oxj(a){const b=a.input,c=b.dJa,f=b.VJb;a.output.WN=(2===b.Pbc?c:f).u7k();a.runtime.UYa("InitializeOutputMergeState");return!0}g0h(a){var b=a.input.ru;const c=a.runtime.Qre,f=a.output.WN;b=this.ryi(a,f.getItemAt(f.length-1),b,Ga.a.create());this.vQi(a,b,c);this.Tvl(b,
a.input.source);f.add(b);return a.output.succeeded=!0}ryi(a,b,c,f){a.runtime.Sgd&&Z.ULS.sendTraceTag(18613189,808,50,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",c,f);a=this.v7j(f);a.nbi(b,c);return a}vQi(a,b,c){a.runtime.Sgd&&Z.ULS.sendTraceTag(18613191,808,50,"FillRevision: Adding {0} objects to merged revision.",c.count);c.forEach((f,l)=>{Te.a.kea.equals(f)||b.xBf(l.d4);return!0})}oql(a){const b=a.runtime,c=b.rHf,f=b.Kzh,l=b.Z1f,x=b.Qre;let F=!0;
const R=a.runtime.tkc;let fa=0,wa=0,Xa=0;f.forEach((lb,Lb)=>{R&&Z.ULS.sendTraceTag(18613193,808,100,"Merging Object: [Id: {0}] [ClassId: {1}]",lb,Lb.Oe);wa++;50===wa&&(fa++,a.runtime.UYa(this.Dgb("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",fa,Xa)),wa=0);if(nv.Jdl(Lb.Oe))return!0;var kc=l.get(lb);if(!kc)return x.Jb(lb)?x.ga(lb).LSg(Lb):x.$(lb,new wx(Lb,!1)),!0;if(!c.ga(lb))return F=this.Gmj(lb,kc,Lb,x);const lc=x.xMc(lb,new wx(c.ga(lb),!0));({t9:kc,returnValue:F}=this.p1j.merge(a,this.o1j,this.P4j,
lc,kc,Lb));Xa++;F&&(a.runtime.UYa(this.Dgb("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",lb,Lb.Oe,Xa,fa)),kc&&(x.Jb(kc.d4.id)?x.ga(kc.d4.id).LSg(kc.d4):x.$(kc.d4.id,kc)));return F});R&&Z.ULS.sendTraceTag(18613199,808,100,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",f.count,Xa);return F}fAi(a,b){const c=new Hf.a,f=new Hf.a,l=new Hf.a;var x=a.runtime.NDc;const F=x?x.id:Ga.a.nil;this.Kbe(x).forEach(R=>{c.add(b(R));return!0});x=a.input.dJa.getItemAt(a.input.dJa.length-
1);this.Kbe(x,F).forEach(R=>{f.add(b(R));return!0});a=a.input.VJb.getItemAt(a.input.VJb.length-1);this.Kbe(a,F).forEach(R=>{l.add(b(R));return!0});return{Zai:c,Gll:f,KBl:l}}Kbe(a,b=null){const c=new Hf.a;b||(b=Ga.a.nil);for(;a&&!b.equals(a.id);)c.add(a),a=a.aV;c.reverse();return c}ub(){}get delayedMergeOperation(){return null}set delayedMergeOperation(a){}static KWj(a,b){Z.ULS.sendTraceTag(18613146,808,50,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.output.crash,a.output.timeout,b)}static M3i(a){return a.output.crash?
2:a.output.succeeded?3:1}static p7i(a,b,c,f){let l;({result:l}=b.X4c(f));a.runtime.UYa("GetUnfavoredChanges");let x;new Me.a;({result:x}=c.X4c(f));5===a.input.source&&(a.runtime.CPi=FC.a.tcg(c.Rjd()),a.runtime.Krl=FC.a.tcg(b.Rjd()));b=x;a.runtime.UYa("GetFavoredChanges");f=new ZI(Object(D.a)(f,f.jsb,"getMergeableObject"));a.runtime.UYa("GetModifiedObjects");return{Jrl:l,BPi:b,$ai:f}}static Jdl(a){switch(a){case 1074135137:case 1074135138:case 1074135140:return!0}return!1}}Object(e.a)(nv,"GraphMerger",
null,[1163,1091]);class eJ{get DAa(){return 8}get pHa(){return[]}get IJa(){return[Yc.a.qb(ub.a.NL),Yc.a.qb(ub.a.Klc)]}get AJa(){return[]}get GNa(){return[Yc.a.qb(bb.a.pA)]}get nOa(){return[]}CF(a){return 1074135126===a.Oe}dZa(){return!0}get CAa(){return[Yc.a.qb(ub.a.cid),Yc.a.qb(ub.a.sid)]}get lYa(){return!0}}Object(e.a)(eJ,"CommentContentNodeComplexMerge",null,[1117]);class fJ{get DAa(){return 8}get pHa(){return[]}get IJa(){return[Yc.a.qb(ub.a.$ob),Yc.a.qb(ub.a.ZMd),Yc.a.qb(ub.a.Yob),Yc.a.qb(ub.a.zVb),
Yc.a.qb(ub.a.qze),Yc.a.qb(ub.a.pze),Yc.a.qb(ub.a.NL),Yc.a.qb(ub.a.Klc),Yc.a.qb(ub.a.nMd)]}get AJa(){return[Yc.a.qb(ub.a.Upa),Yc.a.qb(ub.a.gAa),Yc.a.qb(ub.a.PMd),Yc.a.qb(ub.a.AVb),Yc.a.qb(ub.a.EDc)]}get GNa(){return[]}get nOa(){return[]}CF(a){return 1074135127===a.Oe}dZa(){return!0}get CAa(){return[Yc.a.qb(ub.a.cid),Yc.a.qb(ub.a.sid),Yc.a.qb(ub.a.commentId),Yc.a.qb(ub.a.pva),Yc.a.qb(Bb.a.QMd),Yc.a.qb(ub.a.RMd),Yc.a.qb(ub.a.AVb),Yc.a.qb(ub.a.EDc)]}get lYa(){return!0}}Object(e.a)(fJ,"CommentNodeComplexMerge",
null,[1117]);class gJ{constructor(a){this.K2c=a}get DAa(){return 8}get pHa(){return[]}get IJa(){return this.K2c.IJa}get AJa(){return[]}get GNa(){return[Yc.a.qb(bb.a.pA)]}get nOa(){return[]}CF(a){return 393326===a.Oe}dZa(){return!0}get CAa(){const a=new Ha.a;Wq.a(a,this.K2c.pHa);Wq.a(a,this.K2c.CAa);Wq.a(a,this.K2c.AJa);Wq.a(a,[Yc.a.qb(ub.a.Uub),Yc.a.qb(ub.a.Z5c)]);return a.toArray()}get lYa(){return!0}}Object(e.a)(gJ,"NotesContentNodeComplexMerge",null,[1117]);class hJ{get DAa(){return 8}get pHa(){return[Yc.a.qb(ub.a.THi),
Yc.a.qb(ub.a.NHi),Yc.a.qb(ub.a.v2b),Yc.a.qb(ub.a.d8k)]}get IJa(){return[Yc.a.qb(ub.a.bnb),Yc.a.qb(ub.a.cnb),Yc.a.qb(ub.a.mnb),Yc.a.qb(ub.a.nnb),Yc.a.qb(ub.a.IAa),Yc.a.qb(ub.a.Fse),Yc.a.qb(ub.a.jse),Yc.a.qb(ub.a.Gse),Yc.a.qb(ub.a.IEb),Yc.a.qb(ub.a.LEb),Yc.a.qb(ub.a.ytb),Yc.a.qb(ub.a.Spb),Yc.a.qb(ub.a.eDb)]}get AJa(){return[]}get GNa(){return[Yc.a.qb(bb.a.ipb),Yc.a.qb(Bb.a.appsNode)]}get nOa(){return[]}CF(a){return 393271===a.Oe}get CAa(){return[Yc.a.qb(ub.a.presentationId),Yc.a.qb(ub.a.slideWidth),
Yc.a.qb(ub.a.slideHeight),Yc.a.qb(ub.a.sX),Yc.a.qb(ub.a.M9),Yc.a.qb(ub.a.i7a),Yc.a.qb(ub.a.VAb),Yc.a.qb(ub.a.r9),Yc.a.qb(ub.a.LBb),Yc.a.qb(ub.a.Cda),Yc.a.qb(ub.a.embeddedFonts),Yc.a.qb(ub.a.dHa)]}get lYa(){return!0}dZa(){return!0}}Object(e.a)(hJ,"PresentationNodeComplexMerge",null,[1117]);class iJ{get DAa(){return 8}get pHa(){return[Yc.a.qb(ub.a.oHa),Yc.a.qb(ub.a.xic)]}get IJa(){return[Yc.a.qb(bb.a.font),Yc.a.qb(ub.a.wA),Yc.a.qb(ub.a.mCc),Yc.a.qb(ub.a.qdb),Yc.a.qb(ub.a.NL),Yc.a.qb(ub.a.yYa),Yc.a.qb(ub.a.Cm),
Yc.a.qb(ub.a.uWa),Yc.a.qb(ub.a.Atb),Yc.a.qb(ub.a.xia),Yc.a.qb(ub.a.nYa),Yc.a.qb(ub.a.V_),Yc.a.qb(ub.a.lna),Yc.a.qb(ub.a.tXb),Yc.a.qb(ub.a.irb),Yc.a.qb(ub.a.HHa),Yc.a.qb(ub.a.Awa),Yc.a.qb(ub.a.Pma),Yc.a.qb(ub.a.zwa),Yc.a.qb(ub.a.mediaType),Yc.a.qb(ub.a.qdb),Yc.a.qb(ub.a.Gvb),Yc.a.qb(ub.a.$1g),Yc.a.qb(ub.a.b2g),Yc.a.qb(ub.a.Ufb),Yc.a.qb(ub.a.eYa),Yc.a.qb(ub.a.qnh),Yc.a.qb(ub.a.vgd),Yc.a.qb(bb.a.pl),Yc.a.qb(bb.a.rI),Yc.a.qb(ub.a.Cvh),Yc.a.qb(ub.a.Dvh),Yc.a.qb(ub.a.gIb),Yc.a.qb(ub.a.ZIa),Yc.a.qb(ub.a.f$),
Yc.a.qb(ub.a.Xlc),Yc.a.qb(ub.a.DCb),Yc.a.qb(ub.a.outlineWidth),Yc.a.qb(Jg.a.ied),Yc.a.qb(ub.a.W$c),Yc.a.qb(wm.a.h3b),Yc.a.qb(ub.a.CM),Yc.a.qb(ub.a.hP),Yc.a.qb(ub.a.Klc),Yc.a.qb(ub.a.pHb),Yc.a.qb(ub.a.qYa),Yc.a.qb(ub.a.Hob),Yc.a.qb(ub.a.Nvb),Yc.a.qb(ub.a.xM),Yc.a.qb(ub.a.Drh),Yc.a.qb(ub.a.Btb)]}get AJa(){return[Yc.a.qb(ub.a.alt),Yc.a.qb(ub.a.altTitle),Yc.a.qb(ub.a.w9),Yc.a.qb(ub.a.isHorizontallyFlipped),Yc.a.qb(ub.a.isVerticallyFlipped),Yc.a.qb(ub.a.Eia),Yc.a.qb(ub.a.shapeType),Yc.a.qb(ub.a.hIb),Yc.a.qb(ub.a.rotation),
Yc.a.qb(ub.a.Fic),Yc.a.qb(ub.a.gba),Yc.a.qb(ub.a.fba),Yc.a.qb(bb.a.Ex),Yc.a.qb(bb.a.sD),Yc.a.qb(bb.a.My),Yc.a.qb(bb.a.Ny),Yc.a.qb(ub.a.widthPersisted),Yc.a.qb(ub.a.heightPersisted),Yc.a.qb(ub.a.xPersisted),Yc.a.qb(ub.a.yPersisted),Yc.a.qb(ub.a.z1),Yc.a.qb(ub.a.UQ),Yc.a.qb(ub.a.Wga),Yc.a.qb(ub.a.Vga),Yc.a.qb(ub.a.Yga),Yc.a.qb(ub.a.Xga),Yc.a.qb(ub.a.BMe),Yc.a.qb(ub.a.sgd),Yc.a.qb(ub.a.lea),Yc.a.qb(ub.a.ugd),Yc.a.qb(ub.a.ysa),Yc.a.qb(ub.a.Zzc)]}get GNa(){return[Yc.a.qb(bb.a.pA)]}get nOa(){return[]}CF(a){return 1074135132===
a.Oe}dZa(){return!0}get CAa(){return[Yc.a.qb(ub.a.cid),Yc.a.qb(ub.a.sid),Yc.a.qb(ub.a.shapeId),Yc.a.qb(ub.a.TRa),Yc.a.qb(ub.a.oWa),Yc.a.qb(ub.a.qGa),Yc.a.qb(ub.a.oEj),Yc.a.qb(ub.a.EK),Yc.a.qb(ub.a.isResizable),Yc.a.qb(ub.a.isEditable),Yc.a.qb(ub.a.wDa),Yc.a.qb(ub.a.fI),Yc.a.qb(ub.a.zj),Yc.a.qb(ub.a.KT),Yc.a.qb(ub.a.HOa),Yc.a.qb(ub.a.IOa),Yc.a.qb(ub.a.g7a),Yc.a.qb(ub.a.K4b),Yc.a.qb(ub.a.hasText),Yc.a.qb(ub.a.HV),Yc.a.qb(ub.a.Pq),Yc.a.qb(ub.a.isConnected),Yc.a.qb(ub.a.Mf),Yc.a.qb(ub.a.aDa),Yc.a.qb(ub.a.Nq),
Yc.a.qb(ub.a.uy),Yc.a.qb(ub.a.Lp),Yc.a.qb(ub.a.dca),Yc.a.qb(ub.a.al),Yc.a.qb(ub.a.BS),Yc.a.qb(ub.a.qk),Yc.a.qb(ub.a.Qf),Yc.a.qb(ub.a.CZ),Yc.a.qb(ub.a.Np),Yc.a.qb(ub.a.wy),Yc.a.qb(ub.a.Fpa),Yc.a.qb(ub.a.gAc),Yc.a.qb(ub.a.Iob),Yc.a.qb(bb.a.gN),Yc.a.qb(Bb.a.HZ),Yc.a.qb(ub.a.v2b),Yc.a.qb(ub.a.AYf),Yc.a.qb(ub.a.ASd),Yc.a.qb(ub.a.DRk),Yc.a.qb(ub.a.Jcd),Yc.a.qb(ub.a.lh),Yc.a.qb(ub.a.U5c),Yc.a.qb(ub.a.u3d),Yc.a.qb(ub.a.j3d),Yc.a.qb(ub.a.LR),Yc.a.qb(ub.a.Vra),Yc.a.qb(ub.a.STb),Yc.a.qb(ub.a.WP),Yc.a.qb(ub.a.cJb),
Yc.a.qb(ub.a.embeddedFonts),Yc.a.qb(ub.a.RCa),Yc.a.qb(ub.a.Wlc),Yc.a.qb(ub.a.rEh),Yc.a.qb(ub.a.A7g),Yc.a.qb(ub.a.cVc),Yc.a.qb(ub.a.tgd),Yc.a.qb(ub.a.Bda),Yc.a.qb(ub.a.jma),Yc.a.qb(ub.a.A7),Yc.a.qb(ub.a.GBb),Yc.a.qb(ub.a.HBb),Yc.a.qb(ub.a.IBb),Yc.a.qb(ub.a.nla),Yc.a.qb(ub.a.J2)]}get lYa(){return!0}}Object(e.a)(iJ,"ShapeNodeComplexMerge",null,[1117]);class xx{constructor(a,b){this.b8j=a;this.L8j=b}get DAa(){return this.L8j}get pHa(){return[]}get IJa(){return[]}get AJa(){return[]}get GNa(){return[]}get nOa(){return[]}CF(a){return this.b8j(a)}dZa(){return!1}get CAa(){return[]}get lYa(){return!1}}
Object(e.a)(xx,"SimpleStrategyComplexMerge",null,[1117]);class jJ{get DAa(){return 8}get pHa(){return[]}get IJa(){return[Yc.a.qb(ub.a.backgroundColor),Yc.a.qb(ub.a.wqa),Yc.a.qb(ub.a.FPe),Yc.a.qb(ub.a.u$),Yc.a.qb(ub.a.Qla),Yc.a.qb(ub.a.N9),Yc.a.qb(ub.a.$A),Yc.a.qb(ub.a.upa),Yc.a.qb(ub.a.CM),Yc.a.qb(ub.a.hP),Yc.a.qb(ub.a.NL),Yc.a.qb(ub.a.Dwa)]}get AJa(){return[Yc.a.qb(ub.a.ZYa),Yc.a.qb(ub.a.uj),Yc.a.qb(ub.a.Xn),Yc.a.qb(ub.a.Se),Yc.a.qb(ub.a.Aaa),Yc.a.qb(ub.a.aKc),Yc.a.qb(ub.a.hEf)]}get GNa(){return[Yc.a.qb(bb.a.pA),
Yc.a.qb(ub.a.notesContentNode),Yc.a.qb(Bb.a.commentContentNode)]}get nOa(){return[]}CF(a){return 393227===a.Oe}dZa(){return!0}get CAa(){return[Yc.a.qb(ub.a.cid),Yc.a.qb(ub.a.sid),Yc.a.qb(ub.a.KY),Yc.a.qb(ub.a.erh),Yc.a.qb(bb.a.En),Yc.a.qb(ub.a.nSa),Yc.a.qb(ub.a.Mba),Yc.a.qb(ub.a.MQa),Yc.a.qb(ub.a.s7a),Yc.a.qb(ub.a.title),Yc.a.qb(ub.a.sX),Yc.a.qb(ub.a.M9),Yc.a.qb(ub.a.v2b),Yc.a.qb(ub.a.r7a),Yc.a.qb(ub.a.j7a),Yc.a.qb(ub.a.lh),Yc.a.qb(ub.a.jma)]}get lYa(){return!0}}Object(e.a)(jJ,"SlideNodeComplexMerge",
null,[1117]);class kJ{constructor(a,b){this.eFg=a;this.x_j=b}ga(a){return this.eFg.xMc(a,this.x_j)}get ETd(){return this.eFg}}Object(e.a)(kJ,"PropertyMergeStrategies",null,[]);const IC=(a,b,c,f,l)=>{if(b){f=f||new pz;if(!a){a=b=b.M3a();const x=a.Bz();for(let F=0;F<x.length;F++){const R=x[F];if(U.a.h5f(R)===U.a.string){const fa=f.kcg(a,R);f.Hlh(a,R,fa?"Redacted: "+fa.length:"null")}}}Z.ULS.sendTraceTag(18613206,l,50,c,b.Qjd())}else Z.ULS.sendTraceTag(18613204,l,10,c,"{0}: Node was null.",c)};class lJ{constructor(a,
b,c){this.IDg=new oa.a;this.p0c=a;this.yta=b;this.sUa=c(this.K_b());this.O4j=new le.a(Object(D.a)(this,this.ETd,"evalPropertyMergeStrategies"))}MVj(a){if(!a.QDh){a.QDh=!0;var b=a.Y4c.runtime.cKc,c=a.Dck;IC(b,a.f3a.value.TBb,"Base",c,808);IC(b,a.f3a.value.h4,"Favored",c,808);IC(b,a.KTb.value.h4,"Conflict",c,808)}}jql(a,b,c,f){this.KSa(a,c);const l=a.t9;if(2===f||7===f||a.Rbc.contains(c))return!0;if(5===f)return!1;if(4===f||3===f){if(({value:x}=a.f3a.value.DWa.Of(c)).returnValue&&x.Z7a)return 4!==f;
f=0}if(0===f){if(!b.isDeleted)return l.fIa(Yc.a.Vqa(c),b.newValue),!0;f=6}if(8===f){let F=a.TDc.value;b=!0;if(({value:x}=F.DWa.Of(c)).returnValue&&F.Z7a){var x=this.p0c.Obj(a.Y4c.input.source,x);void 0!==x&&null!==x?l.fIa(Yc.a.Vqa(c),x):(b=!1,f=6)}if(b)return!0}return 9===f&&(b=!0,({value:x}=a.TDc.value.DWa.Of(c)).returnValue&&(x=this.p0c.lfg(a.Y4c.input.source,x),void 0!==x&&null!==x?l.fIa(Yc.a.Vqa(c),x):(b=!1,f=6)),b)?!0:6===f?(l.removeProperty(Yc.a.Vqa(c)),!0):1===f?this.yta.dZa(a,c):!1}zVa(a){return a}K_b(){return[Object(D.a)(this,
this.sql,"tryPreProcessFavoredRevision"),Object(D.a)(this,this.Ini,"cloneObjectAndRemoveNeededProperties"),Object(D.a)(this,this.iql,"tryMergeNodeInternal")]}get Z$c(){return this.O4j.value}hql(a){const b=a.f3a.value;Z.ULS.sendTraceTag(18659235,808,100,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",b.h4.id,b.h4.Oe);for(let c=0;c<this.sUa.length;c++)if(!(0,this.sUa[c])(a))return Z.ULS.sendTraceTag(18659265,808,50,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",
b.h4.id,b.h4.Oe,c),this.MVj(a),a.t9=null,!1;Z.ULS.sendTraceTag(18659267,808,100,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",b.h4.id,b.h4.Oe);return!0}sql(a){const b=a.f3a.value;if(!b.Z7a)return!0;const c=this.Z$c;let f=!0;b.DWa.forEach((l,x)=>{if(!x.Z7a||a.Rbc.contains(l))return!0;x=c.ga(l);if(5===x)return Z.ULS.sendTraceTag(18659269,808,50,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",
b.TBb.Oe,l,x),f=!1;6===x&&a.tAe.add(l);return!0});return f}Ini(a){a.t9=a.f3a.value.h4.M3a();const b=a.tAe,c=a.t9;b&&b.forEach(f=>{c.removeProperty(Yc.a.Vqa(f));return!0});return!0}iql(a){const b=a.KTb.value,c=b.TBb.Oe,f=this.Z$c;let l=!0;b.DWa.forEach((x,F)=>{if(this.yta.lYa&&!this.Z$c.ETd.Jb(x)){var R=String.format("prop id: {0} is missed in merge handlers for class {1}, please add it",x,c);Z.ULS.sendTraceTag(18970259,808,50,R)}R=f.ga(x);l=this.jql(a,F,x,R);l||(a.t9=null,Z.ULS.sendTraceTag(18659271,
808,50,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",c,x,R));return l});return l}t4i(){return[Yc.a.qb(bb.a.OZf),Yc.a.qb(bb.a.lastModifiedTime),Yc.a.qb(bb.a.PD),Yc.a.qb(bb.a.Leb),Yc.a.qb(bb.a.jgh),Yc.a.qb(kh.a.ycc),Yc.a.qb(Bb.a.vqi),Yc.a.qb(Bb.a.zYf),Yc.a.qb(Cs.a.gw)]}ETd(){var a=this.t4i(),b=this.yta.pHa,c=this.yta.IJa,f=this.yta.AJa,l=this.yta.nOa,x=this.yta.GNa;const F=this.yta.CAa,R=new Me.a(0);for(let fa=0;fa<a.length;fa++)R.$(a[fa],this.zVa(7));for(a=0;a<
b.length;a++)R.$(b[a],this.zVa(8));for(b=0;b<c.length;b++)R.$(c[b],this.zVa(7));for(c=0;c<f.length;c++)R.$(f[c],this.zVa(9));for(f=0;f<l.length;f++)R.$(l[f],this.zVa(1));for(l=0;l<x.length;l++)R.$(x[l],this.zVa(9)),this.IDg.add(x[l]);for(x=0;x<F.length;x++)R.$(F[x],this.zVa(this.yta.DAa));return new kJ(R,this.zVa(this.yta.DAa))}KSa(a,b){this.IDg.contains(b)&&(a=a.t9,Z.ULS.sendTraceTag(18956752,808,50,"Merge child nodes for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}] []",a.id,a.Oe,b))}}Object(e.a)(lJ,
"GraphNodeComplexMerge",null,[1134]);class mJ{constructor(a,b){this.fl=a;this.hZc=b;this.b_j=this.qxi()}qxi(){const a=[];this.fl.forEach(b=>{a.push(new lJ(this.hZc,b,c=>c))});return a}pxi(a){for(let b=0;b<this.fl.length;b++)if(this.fl[b].CF(a))return this.b_j[b];return null}}Object(e.a)(mJ,"GraphNodeComplexMergeFactory",null,[1089]);class nJ{Obj(a,b){this.sDh(a);return 5===a?b.newValue:b.oldValue}lfg(a,b){this.sDh(a);return 5===a?b.oldValue:b.newValue}sDh(a){1!==a&&5!==a&&Z.ULS.sendTraceTag(18613264,
808,15,"Unexpected merge source: {0}",a)}}Object(e.a)(nJ,"GraphNodeComplexMergeHelper",null,[1119]);class oJ{constructor(a,b,c,f,l,x){this.tAe=this.Rbc=null;this.T4b=this.QDh=!1;this.t9=null;this.tkc=a.runtime.tkc;this.Y4c=a;this.Dck=b;this.f3a=c;this.KTb=f;this.TDc=l;this.qgg=x}}Object(e.a)(oJ,"GraphNodeComplexMergeState",null,[]);class pJ{constructor(a){this.sUa=a(this.K_b())}K_b(){return[Object(D.a)(this,this.Cdl,"simpleMerge"),Object(D.a)(this,this.Mpi,"complexMerge")]}p7k(a,b,c,f,l,x){a=new oJ(a,
c,new le.a(()=>new vx(f.d4,l)),new le.a(()=>new vx(f.d4,x)),new le.a(()=>new vx(x,l)),b.pxi(l));a.Rbc=f.Sxc;a.tAe=new Hf.a;return a}merge(a,b,c,f,l,x){a=this.p7k(a,b,c,f,l,x);b=!0;for(c=0;c<this.sUa.length&&b;c++)b=(0,this.sUa[c])(a);(b=a.T4b&&a.t9?new wx(a.t9,!1):null)&&b.h6k(a.Rbc);return{returnValue:a.T4b,t9:b}}Cdl(a){var b=a.qgg.Z$c;return a.KTb.value.FRc(b)&&a.TDc.value.FRc(b)?a.f3a.value.FRc(b)?!0:(b=a.KTb.value.h4,a.T4b=!0,a.t9=b.M3a(),!1):(a.T4b=!0,!1)}Mpi(a){const b=a.KTb.value.h4;a.tkc&&
Z.ULS.sendTraceTag(18613266,808,100,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.id,b.Oe);const c=a.qgg.hql(a);a.T4b=c;Z.ULS.sendTraceTag(18613268,808,c?100:50,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",c?"Succeeded":"Failed",b.id,b.Oe,!!a.t9);return c}}Object(e.a)(pJ,"GraphNodeMerge",null,[1090]);class Yt{constructor(a){this.p0c=a}vHi(a){const b=a.TDc.value,c=a.t9;a=a.Y4c.input.source;for(const l of Yt.fed)if(({value:f}=b.DWa.Of(l)).returnValue){var f=
this.p0c.lfg(a,f);void 0!==f&&null!==f?c.fIa(Yc.a.Vqa(l),f):c.removeProperty(Yc.a.Vqa(l))}}get pHa(){return[Yc.a.qb(ub.a.BS),Yc.a.qb(ub.a.c8d),Yc.a.qb(ub.a.d8d),Yc.a.qb(ub.a.C7d)]}get IJa(){return[]}get AJa(){return[]}get GNa(){return[]}get nOa(){return Yt.fed}get CAa(){return[]}get lYa(){return!1}get DAa(){return 9}CF(a){return 393230===a.Oe}dZa(a,b){return 0<=Array.indexOf(Yt.fed,b)?(this.vHi(a),Yt.fed.forEach(c=>{a.Rbc.add(c)}),!0):!1}}Yt.fed=[Yc.a.qb(bb.a.Zp),Yc.a.qb(bb.a.Ygb),Yc.a.qb(bb.a.Ylc),
Yc.a.qb(bb.a.EIa),Yc.a.qb(bb.a.Mua),Yc.a.qb(Bb.a.CWa)];Object(e.a)(Yt,"ParagraphNodeComplexMerge",null,[1117]);class JC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphMerge"}Wb(a){this.K=a;a.register(nJ,"PowerPointWebEditor.GraphMerge.GraphNodeComplexMergeHelper").as("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper").ma();const b=[393229,393234,1074135136,131073,1179649,393252,393250,393251];a.register(1089,"PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory").ma().na(()=>
{const c=new iJ;return new mJ([new hJ,new jJ,c,new Yt(a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper")),new eJ,new fJ,new gJ(c),new xx(f=>Array.contains(b,f.Oe),9),new xx(f=>131140===f.Oe,6),new xx(f=>131164===f.Oe,8),new xx(()=>!0,5)],a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper"))});a.register(pz,"PowerPointWebEditor.GraphMerge.MergeableObjectUtilities").as("Box4.StorageObjectSpace.IMergeableObjectUtilities").ma();a.register(1090,"PowerPointWebEditor.GraphMerge.IGraphNodeMerge").ma().na(()=>
new pJ(c=>c));a.register(1091,"Box4.IBrowserGraphMerger").ma().na(()=>new nv(c=>new FC.a(c),a.resolve("Box4.StorageObjectSpace.IMergeableObjectUtilities"),c=>c,a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory"),a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeMerge"),(c,f,l)=>new z.a(c,f,l),a.resolve("PowerPointWebEditor.IApplicationSettings").gOc,a.resolve("PowerPointWebEditor.IApplicationSettings").vtg,a.resolve("PowerPointWebEditor.IApplicationSettings").EGj,a.resolve("PowerPointWebEditor.IApplicationSettings").CGj,
a.resolve("PowerPointWebEditor.IApplicationSettings").DGj))}init(){const a=this.K.resolve("Box4.IBrowserGraphMerger");Gb.App.bJa.Lbi(a)}dispose(){}static main(){m.a.instance.Ac(new JC)}}Object(e.a)(JC,"PPTWebEditorGraphMergePackage",null,[2,3]);class qJ{constructor(a,b){this.fl=a;this.vQ=b}bWi(a){let b=null,c=null;if(a&&a.rootNode)for(const f of this.fl)if(f.rCj(a)){c=f;const l=this.vQ.wi("UserAction",f.name);b=f.ZVi(a);l.stop();break}b||ya.a.J(21860568,307,15,"{0} processed {1} but did not generate any HTML",
c?c.name:"NoHandler",a&&a.rootNode?a.rootNode.type:0);return b}aWi(a){if(!a||1>a.length)return null;const b=document.createElement("div");for(const c of a)(a=this.bWi(c))&&b.appendChild(a);return b}}Object(e.a)(qJ,"HtmlExportProcessor",null,[1080]);class KC{constructor(){this.lwc=null}get rootNode(){return this.lwc}clone(){return Object.assign(new KC,{lwc:this.rootNode})}}Object(e.a)(KC,"HtmlExportContext",null,[]);class rJ{$Vi(a,b){const c=[];for(const f of a)b&&!b(f)||c.push(Object.assign(new KC,
{lwc:f}));return c}}Object(e.a)(rJ,"HtmlExportUtils",null,[1082]);class sJ{constructor(a){this.Ife=null;this.qq=a}get MIi(){return this.Ife=this.Ife||document.createElement("div")}cWi(a,b){if(!a||!a.rootNode||!b)return null;b.Pza(this.MIi);const c=this.qq.je(3);try{c.fd(a.rootNode),c.oIa(b.Ma),b.iA(a.rootNode),b.txa()}finally{c&&c.dispose()}a=b.N0f;b.detach();return a}}Object(e.a)(sJ,"HtmlGenerator",null,[1081]);class LC{constructor(a,b,c){this.C1j=a;this.D1j=b;this.Mb=c}get name(){return"PPTTableHtmlExportHandler"}rCj(a){return 14===
a.rootNode.type?!0:10===a.rootNode.type?(a=Object(va.a)(4,a.rootNode),!!a&&a.nd):!1}ZVi(a){return this.D1j.cWi(this.Lej(a),this.C1j)}Lej(a){if(10===a.rootNode.type){const b=a.clone();a=this.Mb.Kc(a.rootNode);a.zb(1);b.lwc=a.zb(2);return b}return a}}Object(e.a)(LC,"PPTTableHtmlExportHandler",null,[1167]);class MC extends Ch.a{constructor(a,b){super(new Th.a,a,b)}get N0f(){return this.Svh}}Object(e.a)(MC,"AHtmlExportView",Ch.a,[1127,390,202,106]);class NC{}NC.HNi="ExportedPPTTable";Object(e.a)(NC,"HtmlExportConstants",
null,[]);class OC extends MC{constructor(a,b){super(a,b)}get N0f(){const a=this.Svh.getElementsByTagName("table");return 0<a.length?(Sys.UI.DomElement.addCssClass(a[0],NC.HNi),a[0]):null}get Bl(){return!0}get dI(){return 480}}Object(e.a)(OC,"PPTTableHtmlExportView",MC,[]);class PC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.HtmlExport"}Wb(a){this.K=a;this.K.register(1080,"PowerPointWebEditor.HtmlExport.IHtmlExportProcessor").ma().na(()=>new qJ([this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler")],
this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));this.K.register(1081,"PowerPointWebEditor.HtmlExport.IHtmlGenerator").ma().na(()=>new sJ(this.K.resolve("Box4.Graph.IGraphTransactionFactory")));this.K.register(1082,"PowerPointWebEditor.HtmlExport.IHtmlExportUtils").ma().na(()=>new rJ);this.zri()}init(){}dispose(){}zri(){this.K.register(OC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView").ma().na(()=>new OC(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("Box4.IViewManager")));
this.K.register(LC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler").ma().na(()=>new LC(this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView"),this.K.resolve("PowerPointWebEditor.HtmlExport.IHtmlGenerator"),this.K.resolve("Box4.Graph.IGraphIteratorFactory")))}static main(){m.a.instance.Ac(new PC)}}Object(e.a)(PC,"HtmlExportPackage",null,[2,3]);class qz extends Vh.a{constructor(a,b){super();this.gqc=0;this.Ovd=null;this.Zn="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>";
this.vbf=a;this.ubf=b;this.kg="LanguageDialog"}zkc(){this.jg=this.EWd();this.gqc=({D7g:a}=this.vbf.Tcg()).returnValue;var a={["LanguageList"]:10,["DoNotCheckSpelling"]:!a};this.pj(Box4Intl.Box4Strings.l_Language,Object(D.a)(this,this.R2k,"setLanguageHandler"),a);this.Ovd=document.getElementById("LanguageList");this.ubf.swk(this.Ovd,this.gqc)}EWd(){return Vh.a.EB(this.Zn,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)}R2k(a,
b){if(H.a.instance.ga(70)){var c=Sa.a.instance.Bp(C.a.Q2k);1!==a?c.properties.$("canceled","true"):(a=b.DoNotCheckSpelling,0<=b.LanguageList&&(b=parseInt(this.Ovd.value),this.vbf.amh(b,a),c.properties.$("PreviousLCID",this.gqc.toString()),c.properties.$("ChangedLCID",b.toString()),c.properties.$("NoProof",a.toString()),this.ubf.P2k(b,this.gqc)),Gb.App.Fb.updateCommandUI(!0));c.end()}}}Object(e.a)(qz,"LanguageDialog",Vh.a,[1166]);class tJ{constructor(){this.wQj=["version","xmlns","xmlns:xlink","style"]}sanitize(a){try{const b=
{};b.inputString=a;b.unsupportedContentCallback=Object(D.a)(this,this.FQj,"jsanityUnsupportedCallBack");return jSanity.sanitize(b)}catch(b){ya.a.J(38398044,815,10,"Unexpected exception when converting svg: {0}, stack: {1}",b.message,b.stack)}return null}YWk(a){var b=this.sanitize(a);let c=null;if(b&&b.innerHTML&&b.innerHTML.startsWith("<svg")){c=b.innerHTML;if(0<a.indexOf("viewBox")&&0>c.indexOf("viewBox"))if((b=a.match(RegExp('viewBox="[^"]*')))&&1===b.length&&b[0])c=c.replace("<svg",String.format('<svg {0}"',
b[0]));else return null;if(0<a.replace(" ","").indexOf('xmlns="http://www.w3.org/'))c=0<c.indexOf("xmlns=")?c:c.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else return null}return c}FQj(a,b){b=b.toLowerCase();for(const c of this.wQj)if(b===c)return;ya.a.J(38398046,822,50,"JSanity unsupported callback unsupportContentName: {0}, unsupportContentValue:{1} ",a,b)}}Object(e.a)(tJ,"JSanityHelper",null,[1085]);class QC extends qz{constructor(a,
b,c){super(a,c);this.B0j=b}EWd(){return this.B0j.sRa?Vh.a.EB(this.Zn,Box4Intl.Box4Strings.l_MarkSelectedText,ResourceStrings.l_LanguageDialogDescription,ResourceStrings.l_DoNotCheckSpellingOrGrammar):super.EWd()}}Object(e.a)(QC,"PPTLanguageDialog",qz,[]);class uJ{constructor(a,b,c,f){this.P7j=a;this.w_j=b;this.$3j=c;this.oF=f}getInstance(a){return new QC((a?this.P7j:this.w_j)(),this.oF,this.$3j)}}Object(e.a)(uJ,"PPTLanguageDialogFactory",null,[1083]);var Kk=d(111);class vJ{constructor(){this.iOe=
"rect,circle,ellipse,line,polyline,polygon,path";this.Eid=[];this.Lea=[[],[1,3],[4,3],[4,3,1,3],[8,3,1,3],[8,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];this.lye=96}brl(a,b=null){try{const c=this.m0d(a);if(!c)return null;const f=b?Eb.a.LH(b.zC):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const x=c[b];x.setAttribute(Kk.a.VUd,f);x.setAttribute(Kk.a.r2f,l)}return a}catch(c){return ya.a.J(38536015,815,10,"TryUpdateSVGDomelementFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",
c.message,c.stack),null}}czh(a,b=null){try{const c=this.m0d(a);if(!c)return null;const f=b?Eb.a.LH(b.zC):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const x=c[b];x.setAttribute(Kk.a.fid,f);x.setAttribute(Kk.a.jth,l)}return a}catch(c){return ya.a.J(38536017,815,10,"TryUpdateSVGDomelementLineFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}crl(a,b){try{const f=this.m0d(a);if(!f)return null;var c=this.Yaj(b);let l="";for(const x of c)l+=
x+" ";for(c=0;c<f.length;++c){if(!f[c])continue;const x=f[c];x.setAttribute(Kk.a.ith,l);x.setAttribute(Kk.a.yNe,"miter");x.setAttribute(Kk.a.Lhl,"4");switch(b){case 8:x.setAttribute(Kk.a.xNe,"round");break;case 2:case 0:x.setAttribute(Kk.a.xNe,"butt");break;default:x.setAttribute(Kk.a.xNe,"round")}}return a}catch(f){return ya.a.J(38536019,815,10,"TryUpdateSVGDomelementLineDashIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",f.message,f.stack),null}}dzh(a,b,c,f){try{if(!a)return null;
this.omh(c,b*this.lye*f/je.a.YAa,a);return a}catch(l){return ya.a.J(38536021,815,10,"TryUpdateSVGDomelementLineWidthIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",l.message,l.stack),null}}$aj(){if(!this.Eid||1>this.Eid.length)this.Eid=this.iOe.split(",");return this.Eid}m0d(a){if(!a)return null;a=a.querySelectorAll(this.iOe);return 1>a.length?null:a}omh(a,b,c){if(c){var f=c.getAttribute(Kk.a.HIb)?c.getAttribute(Kk.a.HIb).toString():"";1<f.length?(f=f.substring(f.indexOf("(")+
1,f.indexOf(")")),f=f.split(","),6===f.length?(f=Math.sqrt(Math.abs(parseFloat(f[0])*parseFloat(f[3]))+Math.abs(parseFloat(f[1])*parseFloat(f[2]))),f*=a):f=a):f=a;a=c.tagName.toLowerCase();for(var l of this.$aj())if(l===a){c.setAttribute(Kk.a.zNe,(b/f).toString());break}if(c.children&&0<c.children.length)for(l=0;l<c.children.length;++l)this.omh(f,b,c.children[l])}}Yaj(a){switch(a){case 0:return this.Lea[0];case 1:return this.Lea[1];case 2:return this.Lea[2];case 3:return this.Lea[3];case 4:return this.Lea[4];
case 5:return this.Lea[5];case 6:return this.Lea[6];case 7:return this.Lea[7];case 8:return this.Lea[8];case 9:return this.Lea[9];case 10:return this.Lea[10];default:return ya.a.J(38536023,815,15,"GetSVGDashArray: unsupport ST_PresetLineDashVal."),this.Lea[0]}}}Object(e.a)(vJ,"SVGIconLocalEditor",null,[1086]);class wJ{constructor(a,b){this.AOg=b;this.Kd=a}lI(a,b){if(!a)return!1;const c=a.o2(f=>!f.al).length;return!this.I8k(a.wXb,c+b)}kJ(a){const b=a.De+1;this.Kd.qG(222,c=>{c.xB=1;c.ePa=[b.toString(),
this.AOg.toString()];return!1})}I8k(a,b){if(!a&&b<this.AOg)return!1;ya.a.J(22410754,822,50,"Can not edit. Shape count:{0}.",b);return!0}}Object(e.a)(wJ,"ShapeCountValidator",null,[1084]);class RC{constructor(a,b,c,f,l,x){this.f4j=a;this.Fa=b;this.gQg=c;this.Db=f;this.FI=l;this.Ea=x}get Eb(){return this.f4j.value}Tcg(){let a,b=0;a=!0;const c=this.Eb.ae();1===c.length&&c[0].jTc&&(b=this.Ea.ZPa(c[0]),a=!this.Ea.i_d(c[0]));return{returnValue:b,D7g:a}}amh(a,b){const c=this.Eb.ae();if(1===c.length&&c[0].jTc&&
this.gQg){var f=new E.DictionaryPropertySet;f.setValue(bb.a.Gs,a);f.setValue(be.a.Lua,b);a=this.Db.rd(15);try{a.jc(c[0]);c[0].Uqa();const l=Object(va.a)(4,c[0]);l&&this.FI&&this.FI.Hvl(l,b);this.gQg.UT(f);this.Fa.Ad()}finally{a&&a.dispose()}}}}Object(e.a)(RC,"ShapeLanguageEditor",null,[1112]);class SC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeEdit"}Wb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationContext");this.K.register(qz,"Box4.UI.LanguageDialog").as("Box4.UI.ILanguageDialog").na(()=>
new QC(this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("Box4.UI.ILanguageListHelper")));this.K.register(1083,"PowerPointWebEditor.IPPTLanguageDialogFactory").ma().na(()=>new uJ(()=>this.K.resolve("PowerPointWebEditor.ShapeLanguageEditor"),()=>this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.UI.ILanguageListHelper"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(RC,"PowerPointWebEditor.ShapeLanguageEditor").ma().na(()=>
new RC(this.K.Be("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.pb("Box4.ITextFormattingCommands"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(1084,"PowerPointWebEditor.ShapeEdit.IShapeCountValidator").ma().na(()=>new wJ(hb.a.instance.resolve("PowerPointWebEditor.IErrorHandler"),b.kd.powerPointEditServerEditableShapeCountThreshold));
this.K.register(1085,"PowerPointWebEditor.IJSanityHelper").ma().na(()=>new tJ);this.K.register(1086,"PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor").ma().na(()=>new vJ)}init(){this.K.resolve("PowerPointWebEditor.IJSanityHelper")}dispose(){}static main(){m.a.instance.Ac(new SC)}}Object(e.a)(SC,"PPTWebEditorShapeEditPackage",null,[2,3]);var TC=d(279);class Hs{static get iZ(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?
"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullscreen?a.requestFullscreen():Z.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():
document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():Z.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get C3b(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get I7(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(e.a)(Hs,
"FullscreenUtils",null,[]);class xJ{get iZ(){return Hs.iZ}requestFullscreen(a){Hs.requestFullscreen(a)}exitFullscreen(){Hs.exitFullscreen()}get C3b(){return Hs.C3b}get I7(){return Hs.I7}get $Kf(){return this.C3b&&!n.a.Kw}}Object(e.a)(xJ,"FullscreenUtilsProxy",null,[1073]);class yJ{Q4i(a){return inkButton.InkButtonManagerFactory.createInkButtonManager(a)}}Object(e.a)(yJ,"InkButtonHelper",null,[1077]);class zJ{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=
!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(e.a)(zJ,"FlyoutMenuExtraProps",null,[]);class yx{}yx.Qfi="_136_16_N_20";yx.Rfi="none";Object(e.a)(yx,"InkButtonConstants",null,[]);class rz{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(e.a)(rz,"InkButtonProps",null,[]);class UC{constructor(){this.onInkMenuActivity=null}}Object(e.a)(UC,"IInkButtonSettings",null,
[]);class AJ extends UC{constructor(){super()}}Object(e.a)(AJ,"InkButtonSettings",UC,[]);class BJ{constructor(){this.color=this.item=null}}Object(e.a)(BJ,"InkManagerActivity",null,[]);class sz{constructor(){this.fle=!1;this.ppe=this.Ope=0;this.yfe=""}get R2(){return this.fle}set R2(a){this.fle=a}get startingSlideIndex(){return this.Ope}set startingSlideIndex(a){this.Ope=a}get xIa(){return this.ppe}set xIa(a){this.ppe=a}get KWf(){return this.yfe}set KWf(a){this.yfe=a}get BMk(){const a={};a.IsStartRehearsal=
this.fle;a.StartingSlideIndex=this.Ope;a.SlideCount=this.ppe;a.DisabledRehearsalRealtimeFeaturesStr=this.yfe;return JSON.stringify(a)}}Object(e.a)(sz,"RehearsalContext",null,[1076]);class tz extends Vh.a{constructor(a,b,c){super(!1,!0);this.Xme=50001;this.eb=a;this.fe=b;this.Bo=new sz;this.Xa=c;this.eb.Jga(Object(D.a)(this,this.Lda,"onSlideshowExitHandler"));this.eb.PSb(Object(D.a)(this,this.Gda,"onGetCurrentPositionHandler"));this.eb.getCurrentPosition();this.PEa=!1}dispose(){super.dispose();this.PEa||
this.eb.restoreFocus()}$w(){super.$w();document.getElementById("WACDialogOverlay").style.zIndex=String(this.Xme);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideshowSubtitleProactiveDialogContainer")}DF(){super.DF();var a=document.getElementById(this.hi("WACDialogPanel"));a.style.minWidth=Xe.a.Lc(300);a.style.width=Xe.a.Lc(300);a=document.getElementById(this.hi("WACDialogButtonPanel"));var b=document.getElementById(this.hi("WACDialogActionButton"));
a&&b&&a.removeChild(b);if(a=document.getElementById(this.hi("WACDialogCancelButton")))a.style.color="#ffffff",a.style.font="12pt",a.style.background="#A92B1A",a.innerText="Got it";if(a=document.getElementById(this.hi("WACDialogPanel"))){b=Xe.a.Ee();b.style.position="absolute";b.style.bottom="20px";b.style.left="20px";const c=Xe.a.Saa();c.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");
c.setAttribute("target","_blank");c.innerText="More Tips";b.appendChild(c);a.appendChild(b)}}open(){ya.a.J(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var a=this.fe.Yj("SubtitleProactive_clearly.png");const b=this.fe.Yj("SubtitleProactive_network.png"),c=this.fe.Yj("SubtitleProactive_noNoise.png");this.jg="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
a+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+c+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
b+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";a={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.pj("",Object(D.a)(this,this.Fda,"onClickHandler"),a);this.eb.setVisibility(!0)}A6(){super.A6()}pqa(){super.pqa()}meb(){}Gda(){this.eb.oeb(Object(D.a)(this,this.Gda,"onGetCurrentPositionHandler"));this.open()}Lda(){this.PEa=!0;this.eb.fea(Object(D.a)(this,
this.Lda,"onSlideshowExitHandler"));this.eb.oeb(Object(D.a)(this,this.Gda,"onGetCurrentPositionHandler"));this.hide()}Fda(a){0===a&&(a=Date.now(),this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,3,a,this.Bo))}static ozg(a,b,c){new tz(a,b,c)}}Object(e.a)(tz,"SlideshowSubtitleProactiveDialog",Vh.a,[]);var th=d(661);class CJ{constructor(){this.buttonIdDictionary=null}}Object(e.a)(CJ,"SlideshowToolbarSettings",null,[]);class zx extends Sys.EventArgs{constructor(a){super();
this.text=a}}Object(e.a)(zx,"ReadOutEventArgs",Sys.EventArgs,[]);class VC{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){this.Txb=this.Bo=this.Dc=this.wca=this.ee=this.JYc=this.Epe=this.Xi=null;this.nT=this.UUa=this.WUa=this.Hxb=this.ITa=this.gje=0;this.ZK=!1;this.Die=!0;this.NZc=this.oQ=this.rqe=this.bee=!1;this.eb=c;this.vf=F;this.Gt=R;this.Xa=wa;this.ia=a;this.Ga=b;this.Vqe=l;this.Pb=x;this.V1j=hb.a.instance.La("PowerPointWebEditor.IInkButtonHelper");this.fe=f;this.Et=Xa}init(a,b){ya.a.J(512495955,830,
50,"ReactSlideshowToolbar.Init");this.Die=!0;this.bee=!1;var c={};c[th.a.MicButton]=this.Ga.isMicButtonInSlideShowToolbarEnabled;c[th.a.PrevButton]=!0;c[th.a.NextButton]=!0;c[th.a.GridButton]=!0;c[th.a.InkButton]=!0;c[th.a.SubtitlesButton]=!0;c[th.a.LiveButton]=!0;c[th.a.MoreButton]=!0;c[th.a.ExitButton]=!0;c[th.a.CoachButton]=this.Ga.isCoachButtonInSlideShowToolbarEnabled;this.Epe=new CJ;this.Epe.buttonIdDictionary=c;if(!document.getElementById("slideshow-toolbar")){this.ee=document.createElement("div");
this.ee.id="slideshow-toolbar";this.ee.className="ReactSlideshowToolbar";this.Ga.pptEditorVoiceUXEnabled&&(this.JYc=document.getElementById("slideshowfooterContainerElement"),this.ee.className="ReactSlideshowToolbarWithFooter");c=document.createElement("div");c.id="slideshow-toolbar-accessibility";c.style.position="absolute";c.style.left="0px";c.style.top="auto";c.style.width="0px";c.style.height="0px";c.style.overflow="hidden";c.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);this.Ga.pptEditorVoiceUXEnabled?
this.JYc.appendChild(this.ee):this.vf.appendChild(this.ee);this.Xi=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.Epe,this.ee);if(!this.Xi){ya.a.J(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");const f=uf.a.Mh(359);u.AFrameworkApplication.Xo(f);Se.Health.instance.recordQosError(uf.a.Qaa(f),["SlideShowACE"],!1,!0,!0,!1,null)}this.Xi.renderToolbar();this.ee.appendChild(c);this.ee.tabIndex=0}this.wca||(this.wca=document.createElement("div"),this.wca.id=
"SlideshowToolbarCalloutMenuContainer",this.wca.className="SlideshowToolbarCalloutMenuContainer",this.Gt()&&(this.wca.style.direction=Ve.a.FYa),this.vf.appendChild(this.wca));this.Dc=a;this.Bo=b;this.Xi.registerButtonCallback(th.a.MicButton,()=>{this.Jlk()});this.Xi.registerButtonCallback(th.a.CoachButton,()=>{this.nik()});this.Dc.Gh||this.Pb&&this.Pb.instance&&this.Pb.instance.Lq?(this.oQ=!0,this.Xi.setToolbarButtonToggleState(th.a.MicButton,this.oQ),this.Xi.showToolbarButton(th.a.MicButton)):(this.oQ=
!1,this.Xi.setToolbarButtonToggleState(th.a.MicButton,this.oQ),this.Xi.hideToolbarButton(th.a.MicButton));this.Xi.registerButtonCallback(th.a.PrevButton,f=>{this.nCb(f)});this.Xi.registerButtonCallback(th.a.NextButton,f=>{this.iCb(f)});this.Xi.registerButtonCallback(th.a.GridButton,f=>{this.fCb(f)});this.Xi.showToolbarButton(th.a.GridButton);this.Dc.Mqb&&!this.Bo.R2&&(this.Xi.registerButtonCallback(th.a.SubtitlesButton,f=>{this.D8c(f)}),this.Xi.setToolbarButtonToggleState(th.a.SubtitlesButton,this.Dc.Gh),
this.Xi.showToolbarButton(th.a.SubtitlesButton));this.Xi.registerButtonCallback(th.a.ExitButton,f=>{this.eCb(f)});this.Ga.isInkingInSlideShowEnabled&&this.Ga.isInkUIInSlideShowEnabled&&(a=rz.create(),a.icon=yx.Qfi,a.selectedColor=yx.Rfi,this.Xi.updateElementProps(th.a.InkButton,a),this.Xi.registerButtonCallback(th.a.InkButton,()=>{this.Pvj()}),this.Xi.showToolbarButton(th.a.InkButton));this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&!this.Bo.R2&&(this.Xi.registerButtonCallback(th.a.LiveButton,()=>
{this.rlk()}),this.Xi.updateFlyoutButtonCallback(th.a.LiveButton,this.Pb.instance.Lq),this.Xi.setToolbarButtonToggleState(th.a.LiveButton,this.Pb.instance.Lq),this.Xi.showToolbarButton(th.a.LiveButton),this.Pb.instance.KCf(Object(D.a)(this,this.hdc,"onLiveSessionStarted")),this.Pb.instance.ICf(Object(D.a)(this,this.gdc,"onLiveSessionEnded")),this.Pb.instance.GCf(Object(D.a)(this,this.fdc,"onLiveRelaunchPausedSession")),this.Pb.instance.A3h(Object(D.a)(this,this.jZg,"onLiveCalloutMenuDefintionChanged")));
this.hJb();this.grb();this.eb.Jga(Object(D.a)(this,this.vla,"onExitHandler"));this.eb.nGd(Object(D.a)(this,this.Gcb,"onBrowserEventHandler"));this.eb.Fzc(Object(D.a)(this,this.Vua,"onGetCurrentSlideDimensionsHandler"));this.eb.Jzc(Object(D.a)(this,this.fva,"onSpecialKeyHandler"));this.eb.pGd(Object(D.a)(this,this.Hcb,"onContextMenuHandler"));this.eb.qGd(Object(D.a)(this,this.V6c,"onEnterEndOfShowHandler"));this.eb.sGd(Object(D.a)(this,this.t7c,"onLeaveEndOfShowHandler"));yd.a.addHandler(this.ee,qa.a.Ns,
Object(D.a)(this,this.Ncb,"onMouseOverHandler"));yd.a.addHandler(this.ee,qa.a.Zv,Object(D.a)(this,this.jdc,"onMouseOutHandler"));yd.a.addHandler(this.wca,qa.a.click,Object(D.a)(this,this.Fda,"onClickHandler"));yd.a.addHandler(this.ee,qa.a.eg,Object(D.a)(this,this.FGa,"onKeyDownHandler"))}icl(){window.clearTimeout(this.gje);this.gje=window.setTimeout(Object(D.a)(this,this.bsj,"hideMouse"),3E3);this.eb.zea(!0)}bsj(){this.ZK||(window.clearTimeout(this.gje),this.eb.zea(!1))}sC(a,b){b?this.Xi.showToolbarButton(a):
this.Xi.hideToolbarButton(a)}setToolbarButtonToggleState(a,b){this.Xi.setToolbarButtonToggleState(a,b)}show(){if(this.Gt()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.WUa+this.nT-16-this.Xi.getToolbarWidth()).toString()+"px";a.style.left=b}}this.Xi.showToolbar();this.Xi.enterFocusTrapZone();window.clearTimeout(this.ITa);window.clearTimeout(this.Hxb);this.Die?(this.ITa=window.setTimeout(Object(D.a)(this,this.hide,"hide"),2E3),this.Die=!1,this.bee=!0):this.ITa=window.setTimeout(Object(D.a)(this,
this.hide,"hide"),3E3);this.eb.zea(!0)}Kqh(){if(this.Gt()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.WUa+this.nT-16-this.Xi.getToolbarWidth()).toString()+"px";a.style.left=b}}this.Xi.showToolbar();this.Xi.enterFocusTrapZone();window.clearTimeout(this.ITa);window.clearTimeout(this.Hxb);this.Hxb=window.setTimeout(Object(D.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.ZK){const a=document.getElementById("slideshow-toolbar");a&&!this.Xi.isAnyToolbarElementFocused()&&document.activeElement===
a&&this.eZa(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.ITa);window.clearTimeout(this.Hxb);this.Xi.hideToolbar();this.eb.zea(!1);this.ee.style.display===Ve.a.Sf&&this.eb.restoreFocus()}}grb(){this.ZK||(this.bee&&this.eZa(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.ITa),window.clearTimeout(this.Hxb),this.Xi.forceHideToolbar(),this.eb.zea(!1),this.ee.style.display===Ve.a.Sf&&this.eb.restoreFocus())}remove(){this.Xi.closeToolbar();this.wca.style.visibility=
Ve.a.Us;this.NZc=!1;this.eb.fea(Object(D.a)(this,this.vla,"onExitHandler"));this.eb.KDe(Object(D.a)(this,this.Gcb,"onBrowserEventHandler"));this.eb.zcd(Object(D.a)(this,this.Vua,"onGetCurrentSlideDimensionsHandler"));this.eb.Ccd(Object(D.a)(this,this.fva,"onSpecialKeyHandler"));this.eb.MDe(Object(D.a)(this,this.Hcb,"onContextMenuHandler"));this.eb.NDe(Object(D.a)(this,this.V6c,"onEnterEndOfShowHandler"));this.eb.PDe(Object(D.a)(this,this.t7c,"onLeaveEndOfShowHandler"));yd.a.removeHandler(this.ee,
qa.a.Ns,Object(D.a)(this,this.Ncb,"onMouseOverHandler"));yd.a.removeHandler(this.ee,qa.a.Zv,Object(D.a)(this,this.jdc,"onMouseOutHandler"));yd.a.removeHandler(this.wca,qa.a.click,Object(D.a)(this,this.Fda,"onClickHandler"));yd.a.removeHandler(this.ee,qa.a.eg,Object(D.a)(this,this.FGa,"onKeyDownHandler"));this.ee&&(this.vf.contains(this.ee)||this.JYc&&this.JYc.contains(this.ee))&&(this.ZK=!1);this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&(this.Pb.instance.ddh(Object(D.a)(this,this.hdc,"onLiveSessionStarted")),
this.Pb.instance.cdh(Object(D.a)(this,this.gdc,"onLiveSessionEnded")),this.Pb.instance.adh(Object(D.a)(this,this.fdc,"onLiveRelaunchPausedSession")),this.Pb.instance.rPk(Object(D.a)(this,this.jZg,"onLiveCalloutMenuDefintionChanged")))}vla(){this.remove()}eZa(a){Ma.a.Va(a)?ya.a.J(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.Vqe.o$g(new zx(a))}Vua(a,b){try{this.WUa=b.jrh;this.UUa=b.grh;this.nT=b.slideWidth;if("NaN"===this.WUa.toString()||
"NaN"===this.UUa.toString()){ya.a.J(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");const c=uf.a.Mh(359);u.AFrameworkApplication.Xo(c);Se.Health.instance.recordQosError(uf.a.Qaa(c),["SlideShowACE"],!1,!0,!0,!1,null)}else{const c=this.Pb.instance&&this.Pb.instance.Lq&&!this.NZc?26:0;if(this.Ga.pptEditorVoiceUXEnabled){const f=document.getElementById("slideshowfooterContainerElement");if(f){let l;l=this.Gt()?(this.WUa+this.nT-16-this.Xi.getToolbarWidth()).toString()+
"px":(this.WUa+2).toString()+"px";f.style.left=l;if(this.Dc.Gh&&"AboveSlide"===this.Dc.tv)f.style.bottom="0px";else{const F=Ba.a.RNc();a=0;const R=document.getElementById("AppHeaderPanel");R&&(a=R.clientHeight);f.style.bottom=this.Et.I7?(F-this.UUa-c).toString()+"px":(F-this.UUa-a-c).toString()+"px"}f.style.top="auto";const x=document.getElementById("ReactToolbarInnerContainer");x&&(x.style.position="relative")}}else{const f=document.getElementById("slideshow-toolbar");if(f){let l;l=this.Gt()?(this.WUa+
this.nT-16-this.Xi.getToolbarWidth()).toString()+"px":(this.WUa+2).toString()+"px";f.style.left=l;const x=this.Pb.instance&&this.Pb.instance.Lq?(this.UUa+c).toString()+"px":this.UUa.toString()+"px";"AboveSlide"===this.Dc.tv?(f.style.bottom="0px",f.style.top="auto"):(f.style.top=x,f.style.bottom="auto");f.style.top=x}}}this.show()}catch(c){ya.a.J(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",
c)}}V6c(){this.NZc=!0}t7c(){this.NZc=!1}FGa(a){this.Xi.isAnyCalloutMenuOpen()||(this.ZK=!1);try{this.ee.style.display===Ve.a.Rk&&(a.keyCode===w.a.cib||a.keyCode===w.a.gB||a.keyCode===w.a.C0?this.eb.prev():a.keyCode===w.a.xxa||a.keyCode===w.a.fB||a.keyCode===w.a.A0?this.eb.next():a.keyCode===w.a.YQ?this.Gt()?this.eb.next():this.eb.prev():a.keyCode===w.a.wO?this.Gt()?this.eb.prev():this.eb.next():a.keyCode===w.a.BJa?(this.rqe=!0,this.grb()):a.shiftKey&&a.keyCode===w.a.tna||a.keyCode===w.a.cKb?this.grb():
this.eb.rHe(a))}catch(b){ya.a.J(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",b)}}fva(a,b){this.Xi.isAnyCalloutMenuOpen()||(this.ZK=!1);if(b.key===w.a.cKb||b.shiftKey&&b.key===w.a.tna)a="off",this.ee.style.display===Ve.a.Sf?(this.Kqh(),a="on"):this.grb(),ya.a.J(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",a)}Hcb(){if(this.rqe)this.rqe=!1;else{var a="off";this.ee.style.display===Ve.a.Sf?(this.Kqh(),
a="on"):this.Xi.isAnyCalloutMenuOpen()||this.grb();ya.a.J(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",a)}}Gcb(a,b){this.icl();b.clientY<this.UUa+8+20&&b.clientY>this.UUa-20-8&&this.show()}Ncb(a){(a=a.target)&&this.ee.contains(a)&&(this.ZK=!0)}jdc(a){a.target&&(this.Xi.isAnyCalloutMenuOpen()?this.wca.style.visibility=Ve.a.Uy:(this.ZK=!1,this.show()));this.Xi.isAnyCalloutMenuOpen()||this.Xi.enterFocusTrapZone()}Fda(a){this.ZK=
!1;window.clearTimeout(this.ITa);window.clearTimeout(this.Hxb);this.wca.style.visibility=Ve.a.Us;this.ITa=window.setTimeout(Object(D.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===a.target.id&&this.Xi.enterFocusTrapZone()}nCb(){ya.a.J(512495947,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.eb.prev()}iCb(){ya.a.J(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.eb.next()}eCb(){ya.a.J(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.Xi.closeToolbar();
this.eb.exit()}fQe(a){const b=!!this.Pb&&!!this.Pb.instance&&this.Pb.instance.Lq;var c=this.Dc.j1f&&5!==a&&!b;5!==a&&(this.Dc.Gh&&(Hi.a.JL("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Hi.a.rL)||ya.a.J(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.Dc.Gh=!this.Dc.Gh);this.Xi.setToolbarButtonToggleState(th.a.SubtitlesButton,this.Dc.Gh);ya.a.J(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Dc.Gh);this.Dc.Gh&&c&&tz.ozg(this.eb,this.fe,this.Xa);c||(c=Date.now(),b?this.oQ||this.Pb.instance.Qqb()?this.eb.toggleTranscriberUIVisibility(null):(this.Pb.instance.qhg(),this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,a,c,this.Bo)):this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,a,c,this.Bo));this.oQ=this.Dc.Gh||b;this.Bld();this.hJb()}Bld(){this.Xi.setToolbarButtonToggleState(th.a.MicButton,
this.oQ);this.oQ?this.Xi.showToolbarButton(th.a.MicButton):this.Xi.hideToolbarButton(th.a.MicButton)}hJb(){const a=this.Dc.Gh,b=!!this.Pb&&!!this.Pb.instance&&this.Pb.instance.Lq,c=this.Bo.R2,f=32!==this.ia.processAction(ba.a.$la,1);a||b||c||f?this.Xi.hideToolbarButton(th.a.CoachButton):this.Xi.showToolbarButton(th.a.CoachButton)}Jlk(){ya.a.J(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.oQ=!this.oQ;this.Xi.setToolbarButtonToggleState(th.a.MicButton,this.oQ);this.eb.setMicrophoneState(!this.oQ);
if(this.Pb&&this.Pb.instance&&this.Pb.instance.Lq&&this.oQ&&!this.Pb.instance.Qqb()){this.Pb.instance.qhg();const a=this.Dc.Gh;this.Pb.instance.oba=!this.Dc.Gh;this.Dc.Gh=!0;this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,5,Date.now(),this.Bo);this.Dc.Gh=a}}nik(){ya.a.J(512495941,830,50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.Ka(ba.a.$la,2,{entryPoint:2})?this.Ga.pptEditorRehearsalSpeechClientEnabled||(this.Bo.R2=
!0):ya.a.J(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")}D8c(){ya.a.J(512495939,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.fQe(3)}fCb(){ya.a.J(512495938,830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");this.ia.Ka(ba.a.$Gb,2,null)}rlk(){this.Pb&&this.Pb.instance&&(ya.a.J(512495937,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Pb.instance.Lq),this.Pb.instance.Lq||(this.Pb.instance.Zkc(3,u.AFrameworkApplication.userSessionId,
this.Ga.podsWebServiceBase,this.Xa.podSessionId,u.AFrameworkApplication.Zg),this.Pb.instance.oba=!this.Dc.Gh,this.Dc.Mqb&&!this.Dc.Gh&&(ya.a.J(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Dc.Gh=!0,this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,5,Date.now(),this.Bo),this.Dc.Gh=!1,this.oQ=!0,this.Bld()),this.ZK=!1,this.Xi.setToolbarButtonToggleState(th.a.LiveButton,!0)));this.hJb()}hdc(){this.Xi.setToolbarButtonToggleState(th.a.LiveButton,
!0);this.Ald(!1,!1);this.oQ=!0;this.Bld();this.hJb();this.dUg()}gdc(){this.Xi.setToolbarButtonToggleState(th.a.LiveButton,!1);this.Ald(!1,!0);this.Pb&&this.Pb.instance&&this.Pb.instance.oba&&!this.Dc.Gh&&(ya.a.J(512495907,830,50,"Stopping subtitle for stopping live session."),this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,5,Date.now(),this.Bo));this.Pb.instance.oba=!1;this.Dc.Gh||(this.oQ=!1,this.Bld());this.hJb()}fdc(){this.Pb&&
this.Pb.instance&&(this.ZK=!0,this.show(),this.wca.style.visibility=Ve.a.Uy,this.Ald(!0,!1),this.dUg());this.hJb()}dUg(){this.Ga.B$c&&!this.Pb.instance.Qqb()&&(this.oQ=!1,this.Xi.setToolbarButtonToggleState(th.a.MicButton,this.oQ),this.Dc.Gh=!1,this.Xi.setToolbarButtonToggleState(th.a.SubtitlesButton,this.Dc.Gh))}jZg(){this.Ald(!1,!1)}Ald(a,b){if(this.Pb&&this.Pb.instance){const c=new zJ;c.menuDefinition=b?null:this.Pb.instance.getCalloutMenuDefinition();c.autoOpenMenu=a;this.Xi.updateElementProps(th.a.LiveButton,
c);this.Xi.updateFlyoutButtonCallback(th.a.LiveButton,!b)}}Pvj(){this.V1j.execute(Object(D.a)(this,this.Ovj,"initInkButton"));const a=new BJ;a.item="Init";this.eb.Iye(a);this.Xi.registerButtonCallback(th.a.InkButton,()=>{})}Ovj(a){const b=new AJ;b.onInkMenuActivity=c=>{this.Qkk(c)};this.Txb=a.Q4i(b);a=rz.create();a.icon=this.Txb.getIcon();a.menuDefinition=this.Txb.getControlsInMenu();a.menuHostId="SlideshowToolbarCalloutMenuContainer";this.Xi.updateElementProps(th.a.InkButton,a)}Qkk(a){this.eb.Iye(a);
a=rz.create();a.selectedColor=this.Txb.getSelectedColor();a.icon=this.Txb.getIcon();a.menuDefinition=this.Txb.getControlsInMenu();this.Xi.updateElementProps(th.a.InkButton,a);ee.a("DismissToolbarOnSelection")&&this.grb()}}Object(e.a)(VC,"ReactSlideshowToolbar",null,[1109,1110]);class WC{constructor(a,b){this.Wh=a;this.j8b=document.createElement("div");this.j8b.id="slideshowfooterContainerElement";this.j8b.className="slideshowFooterContainer";this.ia=b}init(){ya.a.J(595198370,830,50,"SlideShowFooterContainer.Init");
this.Wh&&this.Wh.appendChild(this.j8b)}remove(){this.Wh&&this.Wh.contains(this.j8b)&&this.Wh.removeChild(this.j8b)}ub(){this.ia.xa(ba.a.Tph,fc.a.application,Object(D.a)(this,this.Bbl,"showFooterElements"));this.ia.xa(ba.a.Ljg,fc.a.application,Object(D.a)(this,this.Yrj,"hideFooterElements"))}Bbl(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display="flex");return 32}Yrj(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=
Ve.a.Sf);return 32}}Object(e.a)(WC,"SlideShowFooterContainer",null,[1111]);class DJ{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(e.a)(DJ,"IVoiceActorSettings",null,[]);class EJ{constructor(){this.rbc=this.Wh=this.Ybb=null}init(){ya.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.Ybb=document.createElement("div");this.Ybb.id="voiceNotificationContainerElement";this.Ybb.className="voiceNotificationContainer";(this.Wh=document.getElementById("slideshowfooterContainerElement"))&&
this.Wh.insertBefore(this.Ybb,this.Wh.firstChild);const a=new DJ;a.baseZIndex=50002;a.hostElement=this.Ybb;this.rbc=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(a)}remove(){this.Wh&&this.Wh.contains(this.Ybb)&&this.Wh.removeChild(this.Ybb)}show(a,b){this.rbc&&this.rbc.showNotification(a,b)}hide(){this.rbc&&this.rbc.hideNotification()}}Object(e.a)(EJ,"SlideShowVoiceNotification",null,[1078]);class XC extends Vh.a{constructor(a,b){super(!1,!0);this.Aac=null;this.b$a=this.pTa=0;this.Xme=50001;this.uyb=
null;this.eb=a;this.p5j=b;this.eb.Jga(Object(D.a)(this,this.Lda,"onSlideshowExitHandler"));this.eb.PSb(Object(D.a)(this,this.Gda,"onGetCurrentPositionHandler"));this.eb.getCurrentPosition();this.PEa=!1}get Bhd(){if(void 0===this.Aac||null===this.Aac)this.Aac=document.getElementById("GotoDlgInput");return this.Aac}Ayl(){if(!RegExp("^[0-9]+$").test(this.Bhd.value))return this.Bhd.value=this.pTa.toString(),!1;this.b$a=Number.parseInvariant(this.Bhd.value);this.b$a=Math.min(this.b$a,this.p5j);this.b$a=
Math.max(this.b$a,1);return!0}dispose(){super.dispose();this.Aac=null;this.PEa||this.eb.restoreFocus()}$w(){super.$w();document.getElementById("WACDialogOverlay").style.zIndex=String(this.Xme);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideShowGoToDialogContainer")}DF(){super.DF();const a=document.getElementById(this.hi("WACDialogPanel"));a.style.minWidth=Xe.a.Lc(300);a.style.width=Xe.a.Lc(300)}open(){ya.a.J(24133980,830,50,"SlideshowGoToDialog: Open");
this.jg="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const a={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.pTa.toString()};this.pj(ResourceStrings.L_GoTo,Object(D.a)(this,this.Fda,"onClickHandler"),a);this.eb.setVisibility(!0);this.Bhd.focus()}A6(){super.A6();this.uyb=Object(D.a)(this,this.FGa,"onKeyDownHandler");u.AFrameworkApplication.Aa.FF.acd(qa.a.eg,window.document,this.uyb,null)}pqa(){super.pqa();void 0!==
this.uyb&&null!==this.uyb&&u.AFrameworkApplication.Aa.FF.cSe(qa.a.eg,window.document,this.uyb);this.uyb=null}meb(){}Gda(a,b){this.eb.oeb(Object(D.a)(this,this.Gda,"onGetCurrentPositionHandler"));this.pTa=b.slideIndex+1;this.open()}Lda(){this.PEa=!0;this.eb.fea(Object(D.a)(this,this.Lda,"onSlideshowExitHandler"));this.eb.oeb(Object(D.a)(this,this.Gda,"onGetCurrentPositionHandler"));this.hide()}FGa(a){a=a.lc.keyCode;return a===w.a.aq?(this.Ayl()&&(this.xQa(this.b$a),this.hide()),!0):a===w.a.dKb||a===
w.a.CJa||a===w.a.eDh||a===w.a.hmd?!0:!1}Fda(a){1===a&&this.xQa(this.b$a)}xQa(a){this.eb.xQa(a-1)}static QRj(a,b){1>=b||void 0!==Ej.a.Cw&&null!==Ej.a.Cw||new XC(a,b)}}Object(e.a)(XC,"SlideshowGoToDialog",Vh.a,[]);class YC{constructor(a,b,c,f,l,x,F,R,fa){this.A3=this.K=null;this.Yxb=!1;this.h3=[];this.tTa=this.zD=this.o8b=null;this.eb=a;this.Sb=b;this.lta=c;this.ia=f;this.gf=l;this.vf=x;this.Gt=F;this.Et=R;this.Pb=fa}init(){this.K||(this.K=document.createElement("div"),this.K.id="SlideshowContextMenuContainer",
this.K.className="SlideshowContextMenuContainer");this.A3=document.createElement("div");this.A3.className="SlideshowContextMenu cui-menu";this.A3.tabIndex=0;const a=document.createElement("ul");a.className="SlideshowContextMenuList cui-menusection-items";const b=this.Gt();let c=this.dK(ResourceStrings.L_Next,Object(D.a)(this,this.iCb,"onNextClickHandler"),b);Array.add(this.h3,c);a.appendChild(c);c=this.dK(ResourceStrings.L_Previous,Object(D.a)(this,this.nCb,"onPrevClickHandler"),b);Array.add(this.h3,
c);a.appendChild(c);c=this.dK(ResourceStrings.l_GotoCell,Object(D.a)(this,this.Akk,"onGoToClickHandler"),b);Array.add(this.h3,c);a.appendChild(c);c=this.dK(ResourceStrings.L_GridView_SeeAllSlides,Object(D.a)(this,this.fCb,"onGridViewClickHandler"),b);Array.add(this.h3,c);a.appendChild(c);this.Et.$Kf&&(this.o8b=this.dK(this.Et.I7?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,Object(D.a)(this,this.EGa,"onFullscreenClickHandler"),b),Array.add(this.h3,this.o8b),a.appendChild(this.o8b),
this.Et.iZ&&!this.zD&&(this.zD=Object(D.a)(this,this.Ycc,"onFullscreenChangeHandler"),$addHandler(this.vf,this.Et.iZ,this.zD)));c=this.dK(ResourceStrings.L_EndShow,Object(D.a)(this,this.eCb,"onExitClickHandler"),b);Array.add(this.h3,c);a.appendChild(c);this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&(this.tTa=this.dK(ResourceStrings.l_EndLivePresentation,Object(D.a)(this,this.zjk,"onEndLivePresentationClickHandler"),b),Array.add(this.h3,this.tTa));this.A3.appendChild(a);this.K.appendChild(this.A3);
this.vf.appendChild(this.K);this.lta.addHandler(this.K,qa.a.click,Object(D.a)(this,this.Fda,"onClickHandler"));this.lta.addHandler(this.K,qa.a.contextMenu,Object(D.a)(this,this.IYg,"onHostContextMenuHandler"));this.lta.addHandler(this.A3,qa.a.Ns,Object(D.a)(this,this.Ncb,"onMouseOverHandler"));this.eb.pGd(Object(D.a)(this,this.Hcb,"onContextMenuHandler"));this.eb.Jga(Object(D.a)(this,this.vla,"onExitHandler"))}show(){if(this.Pb&&this.Pb.instance&&this.Pb.instance.Lq&&this.tTa&&!this.tTa.parentNode){const a=
this.A3.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].appendChild(this.tTa)}this.Yxb||(this.lta.addHandler(window.document,qa.a.eg,Object(D.a)(this,this.FGa,"onKeyDownHandler")),this.lta.addHandler(window.document,qa.a.ol,Object(D.a)(this,this.edc,"onKeyUpHandler")),this.Yxb=!0);this.K.style.visibility=Ve.a.Uy}hide(){this.lta.removeHandler(window.document,qa.a.eg,Object(D.a)(this,this.FGa,"onKeyDownHandler"));this.lta.removeHandler(window.document,qa.a.ol,
Object(D.a)(this,this.edc,"onKeyUpHandler"));this.Yxb=!1;this.K.style.visibility=Ve.a.Us;if(this.tTa&&this.tTa.parentNode){const a=this.A3.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].removeChild(this.tTa)}}remove(){this.K&&(this.lta.removeHandler(this.K,qa.a.click,Object(D.a)(this,this.Fda,"onClickHandler")),this.lta.removeHandler(this.K,qa.a.contextMenu,Object(D.a)(this,this.IYg,"onHostContextMenuHandler")),this.vf.contains(this.K)&&this.vf.removeChild(this.K));
this.K=null;Array.clear(this.h3)}vla(){this.eb.fea(Object(D.a)(this,this.vla,"onExitHandler"));this.eb.MDe(Object(D.a)(this,this.Hcb,"onContextMenuHandler"));this.o8b&&($removeHandler(this.vf,this.Et.iZ,this.zD),this.zD=null);this.remove()}Fda(a){"SlideshowContextMenuContainer"===a.target.id&&(this.hide(),this.eb.restoreFocus())}Hcb(a,b){this.r1g(b.clientX,b.clientY)}IYg(a){this.r1g(a.clientX,a.clientY)}Ncb(a){(a=a.target)&&"li"===a.tagName.toLowerCase()&&(this.qDe(document.activeElement),this.MQ(a))}FGa(a){const b=
a.keyCode,c=a.shiftKey;b===w.a.Bq||b===w.a.s5?this.fUg(!!(1^c)):b===w.a.YX&&this.fUg(!!(0^c));a.preventDefault()}edc(a){var b=a.keyCode;b===w.a.aq||b===w.a.xO?(b=document.activeElement,Array.contains(this.h3,b)&&b.click()):b===w.a.B0&&this.eb.exit();a.preventDefault()}r1g(a,b){this.setPosition(a,b);this.Imi();this.show();this.A3.focus();this.gf.n$g(new zx(ResourceStrings.L_ControlMenu))}setPosition(a,b){if(this.A3){var c=this.A3.offsetWidth,f=this.A3.offsetHeight,l=this.K.clientHeight;a+c>this.K.clientWidth&&
(a-=c);b+f>l&&(b-=f);this.A3.style.top=Xe.a.Lc(b);this.A3.style.left=Xe.a.Lc(a)}}dK(a,b,c){const f=document.createElement("li");f.className="SlideshowContextMenuItem cui-ctl-mediumlabel";f.innerText=a;f.style.direction=c?"rtl":"ltr";f.tabIndex=1;this.lta.addHandler(f,qa.a.click,b);return f}nCb(){ya.a.J(24133957,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.eb.prev();this.hide();this.eb.restoreFocus()}iCb(){ya.a.J(24133959,830,50,"SlideshowContextMenu.OnNextClickHandler");this.eb.next();this.hide();
this.eb.restoreFocus()}Akk(){ya.a.J(24133961,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();XC.QRj(this.eb,this.Sb.Nj())}fCb(){ya.a.J(50602842,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.Ka(ba.a.$Gb,2,null)}EGa(){ya.a.J(40935580,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.eb.bQe();this.hide();this.eb.restoreFocus()}Ycc(){this.o8b.innerText=this.Et.I7?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen}eCb(){ya.a.J(24133963,
830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.eb.exit()}zjk(){ya.a.J(50619421,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");this.hide();this.eb.restoreFocus();this.Pb&&this.Pb.instance&&this.Pb.instance.Lq&&this.Pb.instance.showEndSessionDialog(()=>{this.Pb.instance.pYb(4)},()=>{})}fUg(a){const b=document.activeElement,c=Array.indexOf(this.h3,b);a=this.h3[((-1===c?a?0:-1:a?c+1:c-1)+this.h3.length)%this.h3.length];void 0!==a&&null!==a&&(this.qDe(b),this.MQ(a))}Imi(){this.h3.forEach(a=>
{this.qDe(a)})}MQ(a){void 0!==a&&null!==a&&(Sys.UI.DomElement.addCssClass(a,"SlideshowContextMenuItemFocus"),a.focus(),this.gf.n$g(new zx(a.innerText)))}qDe(a){void 0!==a&&null!==a&&Sys.UI.DomElement.removeCssClass(a,"SlideshowContextMenuItemFocus")}}Object(e.a)(YC,"SlideshowContextMenu",null,[1110]);var $P=d(970),Ax=d(257);class FJ{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe){this.va=new qd.a;this.zD=null;this.Cpe=this.Dpe=this.a3c=this.Eac=-1;this.kDg=this.mDg=this.lDg=this.wyb=
null;this.m6b="";this.n4c=this.f3c=-1;this.nKg=new Date(0);this.aKg="";this.KEg=null;this.rGg=this.A$a=this.gie=this.jke=!1;this.vFa=this.Bo=this.Dc=null;this.i7b=-1;this.IFg=this.ZFg=!1;this.Et=a;this.eb=b;this.Hca=c;this.Sb=fa;this.la=F;this.h_j=f;this.ni=l;this.Uv=x;this.Ls=R;this.Xa=wa;this.Gy=Xa;this.Kd=lb;this.gua=Lb;this.Mc=kc;this.t4c=lc;this.tua=Ec;this.Lt=this.Ls.kG();this.vPg=this.la.pptEditorHermesSlideShowStartTimeout;this.Zqe=this.la.slideShowWaitForRehydrationTimeoutInMs;this.Mc.tB(Object(D.a)(this,
this.VA,"onSessionEnd"));this.Gy.yGd(Object(D.a)(this,this.mCb,"onPodSessionUnavailable"));this.Mc.uB(Object(D.a)(this,this.jo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.Gy.Qmb(Object(D.a)(this,this.Hda,"onPodSessionRefreshed")),this.Gy.RCf(Object(D.a)(this,this.X7c,"onPodSessionRefreshedFromBrowser")));this.ia=Jc;this.Pb=Dc;this.Z2c=Wd;this.vl=xe;a=document.createElement("div");a.id="HiddenFocusTrapAnchor";u.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")||
u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?a.style.position="absolute":a.style.position="position: absolute";a.style.left="-10000px";a.style.top="auto";a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";a.tabIndex=-1;this.Lt.insertBefore(a,this.Lt.firstChild)}dispose(){this.Mc.gea(Object(D.a)(this,this.VA,"onSessionEnd"));this.Gy.kQk(Object(D.a)(this,this.mCb,"onPodSessionUnavailable"));this.Mc.hea(Object(D.a)(this,this.jo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&
(this.Gy.reb(Object(D.a)(this,this.Hda,"onPodSessionRefreshed")),this.Gy.idh(Object(D.a)(this,this.X7c,"onPodSessionRefreshedFromBrowser")))}rwj(a,b,c,f){this.KEg=b;"Legacy"==this.eb.u2()&&this.eb.init(a,b,c,this.Xa.podSessionId);this.Dc=f;this.Bo=new sz}u2(){return this.eb.u2()}N4b(){return!Ma.a.Va(this.m6b)}get d4d(){return this.A$a}set d4d(a){this.A$a=a}o3k(){this.IFg=!0}Phd(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){Se.Health.instance.addQosPillar("Present");this.N4b()&&ya.a.J(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");
u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&(this.vFa=hb.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&this.vFa.W$a&&(this.i7b=b,this.ia.processAction(ba.a.ohd,2,null),this.vFa.f4h(Object(D.a)(this,this.Omk,"onPresenterViewSyncMessageReceivedHandler")));const kc=c;this.la.pptEditorRehearsalSpeechClientEnabled&&(c=!1);this.Eac=wa;this.a3c=Date.now();const lc=document.createElement("div");lc.id="startingSlideshowHiddenDiv";lc.style.position="position: absolute";
lc.style.left="-10000px";lc.style.top="auto";lc.style.width="1px";lc.style.height="1px";lc.style.overflow="hidden";lc.tabIndex=-1;lc.setAttribute("aria-live","assertive");this.Lt.insertBefore(lc,this.Lt.firstChild);lc.innerText=ResourceStrings.l_StartingSlideShow;const Ec=R+wa.toString();this.m6b=Ec;this.gua&&this.gua.Hjc(!0);this.la.nNj&&this.t4c&&this.t4c.Hjc(!0);this.Bo&&(this.Bo.R2=c,this.Bo.startingSlideIndex=b,this.Bo.xIa=this.Sb.Nj(),this.Bo.KWf=this.la.CMk);this.la.pptEditorVoiceUXEnabled&&
this.Z2c&&this.Z2c.init();this.la.pptEditorVoiceUXEnabled&&this.vl&&this.vl.execute(Dc=>{Dc.init()});this.Hca.execute(Dc=>{Dc.init(this.Dc,this.Bo)});this.lDg=this.Lt.style.top;this.Lt.style.top=Xe.a.Lc(0);this.la.WRa&&(this.mDg=this.Lt.style.width,this.kDg=this.Lt.style.height,this.Lt.style.width="100%",this.Lt.style.height="100%");this.eb.show();this.szg();this.la.orh&&Fr.a.RIb(!1);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.vFa&&this.vFa.W$a&&this.eb.PMa(Object(D.a)(this,this.n8c,
"onSlideChangedHandler"));this.eb.Jga(Object(D.a)(this,this.vla,"onExitHandler"));this.eb.BCf(Object(D.a)(this,this.EGa,"onFullscreenClickHandler"));this.eb.Izc(Object(D.a)(this,this.t0g,"onSlideshowReadyHandler"));this.eb.yCf(Object(D.a)(this,this.X6c,"onErrorHandler"));this.eb.Jzc(Object(D.a)(this,this.fva,"onSpecialKeyHandler"));this.eb.tGd(Object(D.a)(this,this.W7c,"onPodSessionExpiredHandler"));this.eb.FCf(Object(D.a)(this,this.x7c,"onLogEndOfTranscriptionSessionHandler"));this.eb.ECf(Object(D.a)(this,
this.w7c,"onLiveSubtitlesDockedViewHandler"));this.eb.VCf(Object(D.a)(this,this.Qbd,"recordQosErrorHandler"));this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Gy.Qmb(Object(D.a)(this,this.Hda,"onPodSessionRefreshed")),this.Gy.RCf(Object(D.a)(this,this.X7c,"onPodSessionRefreshedFromBrowser")));this.a4h(Object(D.a)(this,this.r7c,"onKeydownHandler"));c=Date.now();let Jc=!this.la.Cvg||Xa;Jc||(Jc=this.ni.dLc().JP());this.ZFg=Jc;wa=Date.now();ya.a.J(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",
wa-c,Jc?"True":"False",Xa?"True":"False");this.Dpe=Date.now();this.ni.dLc().forceOutbound(()=>{ya.a.J(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.ni.flush(()=>{this.Cpe=Date.now();ya.a.J(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.Cpe-this.Dpe);this.m6b===Ec&&Jc&&(Xa&&lb&&(ya.a.J(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),l=lb.Wj,x=lb.podSessionId),this.ysh(a,b,f,l,x,F,R,fa,Lb,kc),ya.a.J(512495811,
830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},Dc=>{ya.a.J(512495810,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",Dc.ServerError);return!1})},(Dc,Wd)=>{ya.a.J(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",Wd)},null);this.m6b!==Ec||Jc||(this.ysh(a,b,f,l,x,F,R,fa,Lb,kc),ya.a.J(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}ysh(a,b,c,f,l,x,F,R,fa,wa=!1){const Xa=
lh.a.create().toString();this.la.Dtg&&this.vuk(c,l,F,Xa);const lb={};lb.SlideShowKind=this.eb.u2();lb.IsFrameNull=this.eb?"false":"true";lb.slideshowClickTimeMs=this.Eac;void 0!==window.performance.timing&&null!==window.performance.timing&&(lb.slideshowClickTimePerformanceAPI=this.Eac-window.performance.timing.navigationStart);ya.a.J(590976135,830,15,JSON.stringify(lb));this.eb.Phd(a,b,f,l,x,F,R,Xa,this.Eac);0<this.vPg&&(this.f3c=window.setTimeout(Object(D.a)(this,this.Pok,"onStartSlideshowTimeoutHandler"),
this.vPg));this.Pb&&this.Pb.instance&&this.Pb.instance.q8c(a,b,c,f,l,x,F,u.AFrameworkApplication.Zg,fa);this.Dc&&this.Dc.CXk();wa&&(this.Dc.Gh=!1);ee.a("PresenterCoachTabFix")&&this.eb.zjh()}fva(a,b){if(b.key===w.a.B0)ya.a.J(512495779,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.Hca.execute(c=>{c.remove()}),this.eb.exit();else if(b.key===w.a.aKb)this.ia.Ka(ba.a.Xjd,2,null);else if(b.key===w.a.fnd&&this.la.dja&&this.Dc&&this.Dc.fBa&&this.Bo&&this.Sb&&!this.Bo.R2&&this.la.WOj&&this.Dc.l1f)try{this.Dc.Gh&&
(Hi.a.JL("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Hi.a.rL)||ya.a.J(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));this.Dc.Gh=!this.Dc.Gh;ya.a.J(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.Dc.Gh);const c=document.getElementById("buttonSubtitle");if(c){const l=c.getElementsByTagName("span")[0].getElementsByTagName("img")[0];l&&(l.className=this.Dc.Gh?"prt2_SubtitleSlideShowToggleHover_40x40x32":
"prt2_SubtitleSlideShowToggleOff_40x40x32")}const f=!!this.Pb&&!!this.Pb.instance&&this.Pb.instance.Lq;if(f)this.eb.toggleTranscriberUIVisibility(null);else{let l=Date.now();this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,4,l,this.Bo)}this.Hca.execute(l=>{l.setToolbarButtonToggleState(th.a.SubtitlesButton,this.Dc.Gh);l.sC(th.a.CoachButton,!this.Dc.Gh&&!f)})}catch(c){ya.a.J(512495776,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",
c)}else if(b.key===w.a.poc&&this.Pb&&this.Pb.instance&&this.Pb.instance.fBa&&this.Pb.instance.rOi&&this.Bo&&!this.Bo.R2)try{if(this.Pb.instance.Lq)this.Pb.instance.showWelcomeScreen();else{this.Pb.instance.oba=!this.Dc.Gh;if(this.Dc.Mqb&&!this.Dc.Gh){this.Dc.Gh=!0;let c=Date.now();this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,5,c,this.Bo);this.Dc.Gh=!1}this.Pb.instance.Zkc(4,u.AFrameworkApplication.userSessionId,this.la.podsWebServiceBase,
this.Xa.podSessionId,u.AFrameworkApplication.Zg)}}catch(c){ya.a.J(512495775,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",c)}}Omk(a,b){b&&(a=b.slideIndex,a!==this.i7b&&(this.i7b=a,this.eb.xQa(a)))}mWa(){ya.a.J(512495774,830,50,"OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.jke=!0}vuk(a,b,c,f){ya.a.J(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",f);a=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",
a,b,!0);b={WaitForSessionTimeoutMs:"0"};b["X-UserSessionId"]=c;b["X-CorrelationID"]=f;b["X-WacCluster"]=this.KEg;this.Uv.vj(a,2,null,b,!1,2,()=>{ya.a.J(512495772,830,50,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},()=>{ya.a.J(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},null,void 0,void 0,void 0,void 0,Ax.a("14"))}Jga(a){this.va.addHandler("OnExitSlideshow",
a)}fea(a){this.va.removeHandler("OnExitSlideshow",a)}PMa(a){this.va.addHandler("OnPositionChangeEventId",a)}peb(a){this.va.removeHandler("OnPositionChangeEventId",a)}a4h(a){this.wyb||(this.wyb=a,yd.a.addHandler(window.document.body,"keydown",this.wyb))}ODe(){this.wyb&&(yd.a.removeHandler(window.document.body,"keydown",this.wyb),this.wyb=null)}Ycc(){if(this.Et.I7)ya.a.J(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.ZMf();this.eb.TDe(Object(D.a)(this,
this.mWa,"onVisibilityChangeHandler"));ya.a.J(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");var a=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.oJ);a=!!a&&"teams"===a.toLowerCase();this.jke||this.gie||!document.hasFocus()||a||(ya.a.J(512495768,830,50,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.Hca.execute(b=>{b.remove()}),this.eb.exit());this.jke=!1}this.gie=!1}n8c(a,b){b&&this.i7b!==b.slideIndex&&(this.i7b=b.slideIndex,
this.vFa.h_k(b))}vla(a,b){ya.a.J(512495767,830,50,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.CNf();var c=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var f of c)(c=document.getElementById(f))&&Sys.UI.DomElement.removeCssClass(c,"SlideShowAXItemNavigationFocusTrap");this.m6b="";this.gua&&this.gua.Hjc(!1);this.t4c&&this.t4c.Hjc(!1);this.Dc&&this.Dc.NUk();this.eb.fea(Object(D.a)(this,this.vla,"onExitHandler"));this.eb.Xch(Object(D.a)(this,
this.EGa,"onFullscreenClickHandler"));this.eb.Bcd(Object(D.a)(this,this.t0g,"onSlideshowReadyHandler"));this.eb.Uch(Object(D.a)(this,this.X6c,"onErrorHandler"));this.eb.Ccd(Object(D.a)(this,this.fva,"onSpecialKeyHandler"));this.eb.TDe(Object(D.a)(this,this.mWa,"onVisibilityChangeHandler"));this.eb.QDe(Object(D.a)(this,this.W7c,"onPodSessionExpiredHandler"));this.eb.Zch(Object(D.a)(this,this.x7c,"onLogEndOfTranscriptionSessionHandler"));this.eb.Ych(Object(D.a)(this,this.w7c,"onLiveSubtitlesDockedViewHandler"));
this.eb.odh(Object(D.a)(this,this.Qbd,"recordQosErrorHandler"));this.ODe(Object(D.a)(this,this.r7c,"onKeydownHandler"));(f=document.getElementById("startingSlideshowHiddenDiv"))&&f.parentNode.removeChild(f);this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Gy.reb(Object(D.a)(this,this.Hda,"onPodSessionRefreshed")),this.Gy.idh(Object(D.a)(this,this.X7c,"onPodSessionRefreshedFromBrowser")));this.la.orh&&(Fr.a.RIb(!0),this.Et.I7||gG.a.xXa(u.AFrameworkApplication.isRtl));this.ZMf();Hs.exitFullscreen();
this.Lt.style.top=this.lDg;this.la.WRa&&(this.Lt.style.width=this.mDg,this.Lt.style.height=this.kDg);this.Ls.yq();this.va.raiseEvent("OnExitSlideshow",b,a);this.Pb&&this.Pb.instance&&this.Pb.instance.Aok();this.Bo&&this.Bo.R2&&b.summary&&this.ia.Ka(ba.a.vIa,2,b.summary);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.vFa&&this.vFa.W$a&&this.ia.processAction(ba.a.mDc,2,null);this.Bo&&(this.Bo.R2=!1);this.la.pptEditorVoiceUXEnabled&&this.vl&&this.vl.instance&&this.vl.instance.remove();
this.la.pptEditorVoiceUXEnabled&&this.Z2c&&this.Z2c.remove();this.dol()}dol(){u.AFrameworkApplication.fa.ka("798")&&hb.a.instance.La("Common.ISystemInitiatedFeedback").execute(a=>{window.setTimeout(()=>{ya.a.J(512495766,830,15,"Trigger NPS after slideshow");a.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}EGa(){this.gie=!0;this.Et.I7?Hs.exitFullscreen():this.szg()}szg(){this.Et.C3b&&(this.Et.iZ&&!this.zD&&(this.zD=Object(D.a)(this,this.Ycc,"onFullscreenChangeHandler"),$addHandler(this.Lt,this.Et.iZ,
this.zD)),this.Et.requestFullscreen(this.Lt),this.eb.OCf(Object(D.a)(this,this.mWa,"onVisibilityChangeHandler")))}t0g(){this.CNf();var a=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var b of a)(a=document.getElementById(b))&&Sys.UI.DomElement.addCssClass(a,"SlideShowAXItemNavigationFocusTrap");if(-1!==this.a3c){b=Date.now();ya.a.J(23098073,830,15,"slideshow ready in {0} ms",b-this.a3c);a={};a.SlideshowClickTimeMs=this.Eac;a.SlideshowStartTimeMs=
this.a3c;a.SlideshowStartFlushTimeMs=this.Dpe;a.SlideshowFinishFlushTimeMs=this.Cpe;a.SlideShowFinishedTimeMs=b;a.NoBlockingOutBoundSetting=this.la.Cvg;a.NoBlockingOutBound=!this.ZFg;ya.a.J(512495765,830,50,JSON.stringify(a));this.Hca.execute(()=>{this.la.Z3b&&this.eb.getCurrentSlideDimensions()});!this.la.vg||!this.la.J5g&&this.la.Z3b||this.h_j.init(this.Dc,this.Bo);b=!!this.Pb&&!!this.Pb.instance&&this.Pb.instance.ar&&this.Pb.instance.eBa;a=!!this.Pb&&!!this.Pb.instance&&(this.Pb.instance.jPa||
this.Pb.instance.Lq);if((this.la.dja||this.la.a5b)&&this.Dc&&this.Bo&&this.Sb&&(this.Dc.Gh||this.Bo.R2||b||a)&&this.Dc.l1f){const c=Date.now();let f=2;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp&&(f=1);const l=this.Dc.Gh;b||a?(this.Dc.Gh||(f=5),this.Pb.instance.oba=!this.Dc.Gh,this.Dc.Gh=!0):this.Pb&&this.Pb.instance&&(this.Pb.instance.oba=!1);this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,f,c,this.Bo);this.Dc.Gh=
l}b&&(this.Pb.instance.eBa=!1);this.ODe(Object(D.a)(this,this.r7c,"onKeydownHandler"));this.eb.zea(!1);this.eb.setOsfLocalStorage()}}r7c(a){27===a.keyCode&&(ya.a.J(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.ODe(Object(D.a)(this,this.r7c,"onKeydownHandler")),this.Hca.execute(b=>{b.remove()}),this.eb.exit())}x7c(a,b){a={};try{const c=xa.a.rK(b.hx);for(const f of c)try{a[f]=b.hx[f]}catch(l){ya.a.J(512495763,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",
f,l)}}catch(c){ya.a.J(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",c)}ya.a.J(512495761,830,50,JSON.stringify(a));try{!(this.Bo&&this.Bo.R2||!this.la.Eyk||this.rGg)&&a.WebSocketConnectionDurationMS&&6E4<parseInt(a.WebSocketConnectionDurationMS.toString())&&(ya.a.J(512495760,830,50,"Floodgate survey triggered for transcription."),this.rGg=!0,this.tua.continueWith(()=>{this.tua.result.logActivity("TranscriptionUsed",
"PPTTranscriptionFloodgateSurveyEnabled")}))}catch(c){ya.a.J(512495759,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",c)}}w7c(a,b){this.la.Z3b||((a=document.getElementById("slideshow-toolbar"))?b.Q4b?"BelowSlide"===b.tv?(a.style.bottom="15%",a.style.left="8%"):"AboveSlide"===b.tv?(a.style.bottom="6px",a.style.left="8%"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):(a.style.left="0%",a.style.bottom=
"6px",a.style.top="auto"):ya.a.J(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}W7c(a,b){ya.a.J(512495757,830,50,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",b.code,b.reason,b.podSessionId);if(b.podSessionId!==this.Xa.podSessionId)ya.a.J(512495756,830,15,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",
this.Xa.podSessionId,b.podSessionId);else{if((a=this.la.slideShowErrorsThatTriggerRehydration)&&0<a.length&&a[0]){var c=new Date(this.nKg.getTime()+1E3*this.la.slideShowMinimumTimeBetweenRehydrationAttemptsInSec);const f=new Date,l=f>c;ya.a.J(512495755,830,50,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",f,c,l);if(l)for(c=0;c<a.length;c++){if(a[c]===b.code.toString()&&(ya.a.J(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",
b.code),this.Kd.Rr(Object.assign(new Kg.a,{Code:223,Source:4}),b.podSessionId),0<this.Zqe)){ya.a.J(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",this.Zqe);this.nKg=new Date;this.aKg=b.podSessionId;this.n4c=window.setTimeout(Object(D.a)(this,this.GMk,"rehydrationTimeout"),this.Zqe);return}}else if(this.aKg===b.podSessionId){ya.a.J(512495752,830,50,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",
b.podSessionId);return}}u.AFrameworkApplication.Xo(uf.a.Mh(359));Se.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!1,!0,!1,null);this.la.podExitSlideshowOnError&&(ya.a.J(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.Hca.execute(f=>{f.remove()}),this.eb.exit())}}X6c(a,b){a=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",b.category,
b.code,b.sessionId,b.correlationId,b.message,b.my,b.VBj.toString());ya.a.J(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",a);u.AFrameworkApplication.Xo(uf.a.Mh(359));Se.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.la.podExitSlideshowOnError&&(ya.a.J(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.Hca.execute(c=>{c.remove()}),this.eb.exit())}ZMf(){this.zD&&(ya.a.J(512495748,
830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(this.Lt,this.Et.iZ,this.zD),this.zD=null)}Pok(){ya.a.J(512495747,830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");u.AFrameworkApplication.Xo(uf.a.Mh(360));Se.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.Hca.execute(a=>{a.remove()});this.eb.exit()}GMk(){ya.a.J(512495746,830,15,"SlideshowManager.RehydrationTimeout");u.AFrameworkApplication.Xo(uf.a.Mh(371));Se.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",
["SlideShowACE"],!1,!0,!0,!0,null);this.Hca.execute(a=>{a.remove()});this.eb.exit()}Qbd(a,b){a=0<b.durationMs?Object.assign(new Fk.a,{durationMs:b.durationMs}):null;Se.Health.instance.recordQosError(b.errorName,[b.vetoName],b.isIntentional,b.isInternal,b.alertOnPillar,b.isSessionEndingError,a)}Hda(a,b){ya.a.J(512495745,830,50,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);
this.A$a=!1;this.HNf();this.N4b()||"Legacy"!=this.eb.u2()?(ya.a.J(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.YW,this.Xa.Wj),this.eb.refreshPodSession(b.YW,this.Xa.Wj)):ya.a.J(512495744,830,50,"SlideshowManager.OnPodSessionRefreshed: Skip updating due to not active.")}X7c(a,b){ya.a.J(512495714,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration);this.A$a=!1;this.HNf();this.N4b()||"Legacy"!=this.eb.u2()?(ya.a.J(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.YW,this.Xa.Wj),this.eb.refreshPodSession(b.YW,this.Xa.Wj)):ya.a.J(512495713,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Skip updating due to not active.")}jo(){this.A$a=!1;ya.a.J(512495711,830,50,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration)}VA(){this.A$a=!0;ya.a.J(512495710,830,50,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}mCb(){this.A$a=!0;ya.a.J(512495709,830,50,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}CNf(){-1!==
this.f3c&&(window.clearTimeout(this.f3c),this.f3c=-1)}HNf(){-1!==this.n4c&&(window.clearTimeout(this.n4c),this.n4c=-1)}}Object(e.a)(FJ,"SlideshowManager",null,[1079]);class ZC{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){this.vta=this.s8b=this.Dbb=this.sxb=this.l$a=this.uTa=this.Vyb=this.yzb=this.Bo=this.Dc=this.ee=null;this.u8b=0;this.ZK=!1;this.zD=null;this.eb=c;this.fe=f;this.Vqe=l;this.vf=F;this.Gt=R;this.Xa=wa;this.Et=Xa;this.ia=a;this.Ga=b;this.Vle=null;this.d6j=fa;this.Pb=x}init(a,b){this.ee=document.createElement("div");
this.ee.id="slideshow-toolbar";this.ee.className="SlideshowToolbar";this.vf.appendChild(this.ee);this.Dc=a;this.Bo=b;this.Gt()?(this.yzb=this.bqa("buttonPrevSlide","navigationButton navigationButtonRtl","SlideShowNextServer",ResourceStrings.L_Next),this.Vyb=this.bqa("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.yzb=this.bqa("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),
this.Vyb=this.bqa("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.ee.appendChild(this.yzb);this.ee.appendChild(this.Vyb);yd.a.addHandler(this.yzb,qa.a.click,Object(D.a)(this,this.nCb,"onPrevClickHandler"));yd.a.addHandler(this.Vyb,qa.a.click,Object(D.a)(this,this.iCb,"onNextClickHandler"));this.s8b=this.bqa("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.ee.appendChild(this.s8b);
yd.a.addHandler(this.s8b,qa.a.click,Object(D.a)(this,this.fCb,"onGridViewClickHandler"));this.l$a=this.uTa=null;this.Et.$Kf&&(this.uTa=this.bqa("buttonEnterFullscreen","navigationButton navigationButtonLtr","SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.l$a=this.bqa("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),a=this.Et.I7,this.uTa.style.display=a?Ve.a.Sf:Ve.a.Rk,this.l$a.style.display=a?Ve.a.Rk:Ve.a.Sf,this.ee.appendChild(this.uTa),
this.ee.appendChild(this.l$a),yd.a.addHandler(this.uTa,qa.a.click,Object(D.a)(this,this.EGa,"onFullscreenClickHandler")),yd.a.addHandler(this.l$a,qa.a.click,Object(D.a)(this,this.EGa,"onFullscreenClickHandler")),this.Et.iZ&&!this.zD&&(this.zD=Object(D.a)(this,this.Ycc,"onFullscreenChangeHandler"),$addHandler(this.vf,this.Et.iZ,this.zD)));this.Dbb=null;this.Dc.Mqb&&!this.Bo.R2&&(this.Dbb=this.bqa("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),
this.ee.appendChild(this.Dbb),yd.a.addHandler(this.Dbb,qa.a.click,Object(D.a)(this,this.D8c,"onTranscribeHandler")));this.sxb=this.bqa("buttonExitSlideShow","navigationButton navigationButtonLtr","ExitSlideShowServer",ResourceStrings.L_EndShow);this.ee.appendChild(this.sxb);yd.a.addHandler(this.sxb,qa.a.click,Object(D.a)(this,this.eCb,"onExitClickHandler"));this.vta=null;this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&!this.Bo.R2&&(this.Pb.instance.KCf(Object(D.a)(this,this.hdc,"onLiveSessionStarted")),
this.Pb.instance.ICf(Object(D.a)(this,this.gdc,"onLiveSessionEnded")),this.Pb.instance.z3h(Object(D.a)(this,this.iZg,"onLiveCalloutDismissed")),this.Pb.instance.GCf(Object(D.a)(this,this.fdc,"onLiveRelaunchPausedSession")),this.Pb.instance.k5a?this.fSf():this.Pb.instance.p4h(Object(D.a)(this,this.kZg,"onLivePresenterResourcesLoaded")));this.ZK=!1;this.hide();this.eb.Jga(Object(D.a)(this,this.vla,"onExitHandler"));this.eb.nGd(Object(D.a)(this,this.Gcb,"onBrowserEventHandler"));yd.a.addHandler(this.ee,
qa.a.Ns,Object(D.a)(this,this.Ncb,"onMouseOverHandler"));yd.a.addHandler(this.ee,qa.a.Zv,Object(D.a)(this,this.jdc,"onMouseOutHandler"))}show(){this.ee.style.display=Ve.a.Rk;window.clearTimeout(this.u8b);this.u8b=window.setTimeout(Object(D.a)(this,this.hide,"hide"),3E3);this.eb.zea(!0)}hide(){this.ZK||(window.clearTimeout(this.u8b),this.ee.style.display=Ve.a.Sf,this.eb.zea(!1))}remove(){this.ee&&this.vf.contains(this.ee)&&(this.vf.removeChild(this.ee),this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&
(this.Pb.instance.ddh(Object(D.a)(this,this.hdc,"onLiveSessionStarted")),this.Pb.instance.cdh(Object(D.a)(this,this.gdc,"onLiveSessionEnded")),this.Pb.instance.qPk(Object(D.a)(this,this.iZg,"onLiveCalloutDismissed")),this.Pb.instance.UPk(Object(D.a)(this,this.kZg,"onLivePresenterResourcesLoaded")),this.Pb.instance.adh(Object(D.a)(this,this.fdc,"onLiveRelaunchPausedSession"))),this.ZK=!1)}sC(){}setToolbarButtonToggleState(){}vla(){this.eb.fea(Object(D.a)(this,this.vla,"onExitHandler"));this.eb.KDe(Object(D.a)(this,
this.Gcb,"onBrowserEventHandler"));yd.a.removeHandler(this.ee,qa.a.Ns,Object(D.a)(this,this.Ncb,"onMouseOverHandler"));yd.a.removeHandler(this.ee,qa.a.Zv,Object(D.a)(this,this.jdc,"onMouseOutHandler"));yd.a.removeHandler(this.yzb,qa.a.click,Object(D.a)(this,this.nCb,"onPrevClickHandler"));yd.a.removeHandler(this.Vyb,qa.a.click,Object(D.a)(this,this.iCb,"onNextClickHandler"));yd.a.removeHandler(this.sxb,qa.a.click,Object(D.a)(this,this.eCb,"onExitClickHandler"));this.vta&&yd.a.removeHandler(this.vta,
qa.a.click,Object(D.a)(this,this.hZg,"onLiveBroadcastHandler"));this.Dbb&&yd.a.removeHandler(this.Dbb,qa.a.click,Object(D.a)(this,this.D8c,"onTranscribeHandler"));this.uTa&&(yd.a.removeHandler(this.uTa,qa.a.click,Object(D.a)(this,this.EGa,"onFullscreenClickHandler")),yd.a.removeHandler(this.l$a,qa.a.click,Object(D.a)(this,this.EGa,"onFullscreenClickHandler")),$removeHandler(this.vf,this.Et.iZ,this.zD),this.zD=null);this.s8b&&yd.a.removeHandler(this.s8b,qa.a.click,Object(D.a)(this,this.fCb,"onGridViewClickHandler"));
this.remove()}Gcb(){this.show()}Ycc(){const a=this.Et.I7;this.uTa.style.display=a?Ve.a.Sf:Ve.a.Rk;this.l$a.style.display=a?Ve.a.Rk:Ve.a.Sf}Ncb(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?a.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(a.className=a.className.replace("Off_40x40x32","Hover_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(a.className=
a.className.replace("_40x40x32","Hover_40x40x32")):a.className=a.className.replace("_40x40x32","Hvr_40x40x32"),this.ZK=!0}jdc(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.Dc.Gh&&a.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&(a.className=a.className.replace("Hover_40x40x32","Off_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Pb&&!this.Pb.instance.Lq&&a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&
(a.className=a.className.replace("Hover_40x40x32","_40x40x32")):a.className=a.className.replace("Hvr_40x40x32","_40x40x32"),this.iUd()||(this.ZK=!1);this.iUd()||this.eb.restoreFocus()}nCb(){ya.a.J(23954837,830,50,"SlideshowToolbar.OnPrevClickHandler");this.eZa(this.yzb.title);this.eb.prev();this.eb.restoreFocus()}iCb(){ya.a.J(23954839,830,50,"SlideshowToolbar.OnNextClickHandler");this.eZa(this.Vyb.title);this.eb.next();this.eb.restoreFocus()}eCb(){ya.a.J(23954841,830,50,"SlideshowToolbar.OnExitClickHandler");
this.eZa(this.sxb.title);this.eb.exit()}EGa(){ya.a.J(40449118,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.eb.bQe()}hZg(){this.Pb&&this.Pb.instance&&(this.eZa(this.vta.title),ya.a.J(41231116,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Pb.instance.Lq),this.Pb.instance.Lq?(this.eb.pausePresentation(),this.Pb.instance.showCallout(this.vta)):(this.Pb.instance.Zkc(3,u.AFrameworkApplication.userSessionId,this.d6j,this.Xa.podSessionId,u.AFrameworkApplication.Zg),this.Pb.instance.oba=
!this.Dc.Gh,this.Dc.Mqb&&!this.Dc.Gh&&(ya.a.J(41682897,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Dc.Gh=!0,this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,5,Date.now(),this.Bo),this.Dc.Gh=!1)),this.MSe())}fQe(a,b){this.eZa(this.Dbb.title);const c=!!this.Pb&&!!this.Pb.instance&&this.Pb.instance.Lq,f=this.Dc.j1f&&5!==a&&!c;5!==a&&(this.Dc.Gh=!this.Dc.Gh);ya.a.J(39682065,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Dc.Gh);b&&(this.Dc.Gh?(b.className="prt2_SubtitleSlideShowToggleHover_40x40x32",f&&tz.ozg(this.eb,this.fe,this.Xa)):b.className="prt2_SubtitleSlideShowToggleOff_40x40x32");f||(b=Date.now(),c?this.eb.toggleTranscriberUIVisibility(null):this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,a,b,this.Bo))}D8c(a){this.fQe(3,a.target)}fCb(){ya.a.J(595204312,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.Ka(ba.a.$Gb,2,null)}fSf(){this.vta||
(this.vta=this.bqa("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.ee.insertBefore(this.vta,this.sxb),yd.a.addHandler(this.vta,qa.a.click,Object(D.a)(this,this.hZg,"onLiveBroadcastHandler")))}bqa(a,b,c,f){const l=document.createElement("div");l.id=a;l.className=b;if("buttonSubtitle"===a)return a=kq.createClusteredImageFromCluster(40,40,"SubtitleSlideShowToggle"+(this.Dc.Gh?"Hover_40x40x32":"Off_40x40x32"),"prt2",
this.fe.Yj("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,l;if("buttonLiveBroadcast"===a)return a=kq.createClusteredImageFromCluster(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Pb&&this.Pb.instance&&this.Pb.instance.Lq?"Hover_40x40x32":"_40x40x32"),"prt2",this.fe.Yj("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,1===a.children.length&&(this.Vle=a.children[0]),l;a=kq.createClusteredImageFromCluster(40,40,c+"_40x40x32","prt2",this.fe.Yj("prt2.png"),null,null,!0,null);l.appendChild(a);
l.title=f;return l}eZa(a){Ma.a.Va(a)?ya.a.J(23396621,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.Vqe.o$g(new zx(a))}iUd(){return!!this.Pb&&!!this.Pb.instance&&this.Pb.instance.GOi}MSe(){this.Pb&&this.Pb.instance&&this.Vle&&(this.Vle.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Pb.instance.Lq?"Hover_40x40x32":"_40x40x32"))}kZg(){this.fSf()}hdc(){this.MSe()}gdc(){this.Pb&&this.Pb.instance&&this.Pb.instance.oba&&!this.Dc.Gh&&(ya.a.J(41682899,
830,50,"Stopping subtitle for stopping live session."),this.eb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.Wj,u.AFrameworkApplication.Zg,5,Date.now(),this.Bo));this.Pb.instance.oba=!1;this.MSe()}fdc(){this.Pb&&this.Pb.instance&&(this.ZK=!0,this.show(),this.eb.pausePresentation(),this.Pb.instance.showCallout(this.vta))}iZg(){this.ZK=this.iUd();this.ZK||(window.clearTimeout(this.u8b),this.u8b=window.setTimeout(Object(D.a)(this,this.hide,"hide"),3E3))}}Object(e.a)(ZC,
"SlideshowToolbar",null,[1109,1110]);class Zt{constructor(a){this.Jxb=this.i9=this.MAb=null;this.Upe="BelowSlide";this.n$a=this.xFg=!1;this.Z7b=!0;this.xYc=-1;this.XFg=this.L7b=this.die=!1;this.Vne=this.Vpe=this.Xpe=this.Wpe=null;this.la=a;u.AFrameworkApplication.fa.ff(Object(D.a)(this,this.Bm,"onFullAppSettingsReady"));a=fe.b(u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());this.LCg=a.Ring||"Unknown";this.cDg=u.AFrameworkApplication.buildVersion||"Unknown";this.BKg=this.la.ZGa||
"Unknown";this.aRg=a.Host||"Unknown";this.$Qg=a.WACDatacenter||"Unknown";this.qPg=this.e1i();this.ebc=this.h1i();this.xQg=this.PNc();this.zxb=Zt.zTe;switch(this.la.Fnl){case "ByUIHostName":a=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.oJ);this.n$a=!(!a||"teams"!==a.toLowerCase());break;case "ByAppIsEmmbeded":this.n$a=u.AFrameworkApplication.isEmbedded;break;default:this.n$a=u.AFrameworkApplication.fa.ka("IsUIEmbedMode")}ya.a.J(40977669,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",
this.zxb,this.Upe)}Bm(){this.MAb=this.getUserId();this.i9=u.AFrameworkApplication.fa.Ha("TenantId");this.Jxb=this.la.hostAuthType||u.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown"}getUserId(){let a=u.AFrameworkApplication.fa.Ha("PptEditingUserId");Ma.a.Va(a)&&(a=u.AFrameworkApplication.fa.Ha("LoggableUserId"),ya.a.J(593793674,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",Ma.a.Va(a)));return a}get OYb(){return this.xFg}set OYb(a){ya.a.J(40407360,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",
a);this.xFg=a}get Gh(){return this.la.dja&&this.OYb&&this.zxb&&!this.n$a}set Gh(a){this.zxb!==a&&(this.zxb=a,Zt.zTe=this.zxb)}get NYb(){return this.la.dja&&this.L7b}set NYb(a){this.L7b!==a&&(this.L7b=a)}get F1f(){return this.XFg}get l1f(){return!this.n$a}get Sqb(){return this.die}set Sqb(a){this.die!==a&&(this.die=a)}get Mqb(){return this.la.dja&&this.OYb&&this.la.TOj&&!this.n$a}get j1f(){const a=Hi.a.get("PPTLiveSubtitleEnabled");return this.la.dja&&this.la.YOj&&Ma.a.Va(a)&&!this.n$a}get WNe(){if(!this.Vpe){const b=
new Ha.a;var a=this.la.y5g;if(!Ma.a.Va(a)){a=a.split(",");for(const c of a)c.endsWith("*")||b.add(c)}this.Vpe=Zt.aEf(b)}return this.Vpe}get VNe(){if(!this.Vne){const b=new Ha.a;var a=this.la.y5g;if(!Ma.a.Va(a)){a=a.split(",");for(const c of a)c.endsWith("*")&&b.add(c.replace("*"," ").trim())}this.Vne=Zt.aEf(b)}return this.Vne}get MHb(){this.Wpe||(this.Wpe=Ma.a.Va(this.la.z5g)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.la.z5g,!0));return this.Wpe}get KMe(){this.Xpe||(this.Xpe=Zt.O7h(this.MHb));
return this.Xpe}CXk(){this.xYc=this.zxb?1:0}NUk(){-1!==this.xYc&&(this.Gh=1===this.xYc?!0:!1,this.xYc=-1)}e1i(){try{const a=sa.a.le(u.AFrameworkApplication.lcid);if(!a)return ya.a.J(41158484,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en-us";const b=a.name.toLowerCase();for(let c of this.WNe)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;for(let c of this.VNe)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;
this.L7b=!0;return"en-us"}catch(a){ya.a.J(41158486,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}this.L7b=!0;return"en-us"}h1i(){try{const a=sa.a.le(u.AFrameworkApplication.lcid);if(!a||Ma.a.Va(a.name))return ya.a.J(41158488,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),
"en";const b=a.name.toLowerCase();if(!Ma.a.Va(b)&&this.MHb[b])return b;const c=sa.a.le(a.languageId);if(!c||Ma.a.Va(c.name))return ya.a.J(41158490,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en";let f=c.name.toLowerCase();this.MHb[f]||(ya.a.J(41972259,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",
b,f,u.AFrameworkApplication.lcid),f="en");return f}catch(a){ya.a.J(41158492,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}return"en"}PNc(){try{if(Ma.a.Va(this.ebc))return ya.a.J(41972290,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",u.AFrameworkApplication.lcid),"en-us";const a=this.MHb[this.ebc.toLowerCase()];
if(!Ma.a.Va(a))return a}catch(a){ya.a.J(41972292,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.ebc,u.AFrameworkApplication.lcid,a)}return"en-us"}HZi(a){if(Ma.a.Va(a))return ya.a.J(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var b=a.split("-");if(!b.length)return ya.a.J(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",
a),null;b=b[0];const c=this.MHb;var f=this.KMe;for(let l of f)if(f=c[l.toLowerCase()],f.startsWith(b))return f;ya.a.J(595140820,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",a);return null}get Qma(){return this.qPg}set Qma(a){this.qPg=a;this.XFg=!0}get userId(){return this.MAb}set userId(a){this.MAb=a}get locale(){return this.BKg}set locale(a){this.BKg=a}get audienceGroup(){return this.LCg}set audienceGroup(a){this.LCg=
a}get buildVersion(){return this.cDg}set buildVersion(a){this.cDg=a}get identityProvider(){return this.Jxb}set identityProvider(a){this.Jxb=a}get wacHost(){return this.aRg}set wacHost(a){this.aRg=a}get wacDatacenter(){return this.$Qg}set wacDatacenter(a){this.$Qg=a}get tenantId(){return this.i9}set tenantId(a){this.i9=a}get gxa(){return this.ebc}set gxa(a){this.ebc=a}get ohb(){return this.xQg}set ohb(a){this.xQg=a}get tv(){return this.Upe}set tv(a){this.Upe=a}get bil(){const a={};a.UserId=this.userId;
a.TenantId=this.tenantId;a.AudienceGroup=this.audienceGroup;a.BuildVersion=this.buildVersion;a.IdentityProvider=this.identityProvider;a.Locale=this.locale;a.WacHost=this.wacHost;a.WacDatacenter=this.wacDatacenter;a.SubtitlesPosition=this.tv;a.SpeechLanguage=this.Qma;a.TranslationLanguages=this.ohb;a.FUseSubtitles=this.Gh;return JSON.stringify(a)}get fBa(){return this.Z7b}set fBa(a){this.Z7b=a}get yOi(){return 0<=this.la.pptEditorTranscribeRTLTranslationLanguages.indexOf(this.gxa)}static get zTe(){const a=
Hi.a.get("PPTLiveSubtitleEnabled");return a?"true"===a.toLowerCase():!1}static set zTe(a){Hi.a.JL("PPTLiveSubtitleEnabled",a.toString(),Hi.a.rL)||ya.a.J(40977672,822,10,"Failed to set cookie for use live subtitle to {0}",a.toString())}static aEf(a){const b={},c=new Ha.a;for(let f of a)try{const l=sa.a.le(f).displayName;c.add(l);b[l]=f}catch(l){ya.a.J(40423770,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((f,l)=>f.localeCompare(l));
a=new Ha.a;for(let f of c)f&&0<f.length&&a.add(b[f]);return a}static O7h(a){const b=xa.a.rK(a);a={};const c=new Ha.a;for(var f of b)try{const l=sa.a.le(f).displayName;Ma.a.Va(l)?ya.a.J(41972252,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",f,u.AFrameworkApplication.lcid):(c.add(l),a[l]=f)}catch(l){ya.a.J(40423772,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
f,l)}c.Sc((l,x)=>l.localeCompare(x));f=new Ha.a;for(let l of c)l&&0<l.length&&f.add(a[l]);return f}}Object(e.a)(Zt,"SubtitleContext",null,[1075]);const $C=()=>{var a=window.navigator.userAgent.toLowerCase();(a=-1!==a.indexOf("windows nt 6.3")&&-1!==a.indexOf("rv:11.0"))||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("windows")?(a=GJ(a,"msie (\\d+)"),a=!isNaN(a)&&10>=a):a=!1);a||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("iphone")||-1!==a.indexOf("ipad")||-1!==a.indexOf("ipod")?
(a=GJ(a,"os (\\d+)_"),a=!isNaN(a)&&9>=a):a=!1);if(a||-1!==window.navigator.userAgent.indexOf("Windows NT 6.3; ARM"))return!1;try{const b=document.createElement("canvas");if(window.self.WebGLRenderingContext&&(b.getContext("webgl")||b.getContext("experimental-webgl")))return!0}catch(b){}return!1},GJ=(a,b)=>(a=(new RegExp(b)).exec(a))&&2<=a.length?parseInt(a[1]):Number.NaN;class HJ{constructor(a){this.vo=a}Zci(){return $C()}Yci(){let a=!1;const b=this.Zci();if(b&&!this.vo.jN(1))try{const c=document.createElement("canvas"),
f=c.getContext("2d");if(f){const l=new Image;l.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";f.drawImage(l,0,0,10,10);c.toDataURL("image/png");a=!0}}catch(c){}ya.a.J(33595541,830,50,"IsRenderingSVGInWebGLSupported - {0}",{["Browser"]:this.vo.iy,["SupportWebGL"]:b,["SupportSVGInWebGL"]:a});return a}}Object(e.a)(HJ,"WebGLHelperProxy",null,[1074]);var IJ=d(630),aQ=d(695);class aD{constructor(){this.la=this.vb=this.K=null}get name(){return"PowerPointWebEditor.SlideShow"}Wb(a){this.K=
a;const b=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.vb=b.kG();this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(1073,"PowerPointWebEditor.IFullscreenHelper").ma().na(()=>new xJ);this.K.register(1074,"PowerPointWebEditor.IWebGLHelper").ma().na(()=>new HJ(this.K.resolve("Common.IBrowserUtils")));this.K.register(1075,"PowerPointWebEditor.ISubtitleContext").ma().na(()=>new Zt(this.la));this.K.register(1076,"PowerPointWebEditor.IRehearsalContext").ma().na(()=>
new sz);this.a6b({["Type"]:"CheckBrowserStart"});a={};var c=this.VCj(a);const f=$C()&&this.la.cSa&&c&&this.UCj(),l=this.la.cSa&&this.TCj(),x=!f&&l;this.a6b({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:f||l,["IsModernWebGLSupportedBrowser"]:f,["IsModernSupportedBrowser"]:l,["IsBrowserShapeBuilderCompatible"]:c,["log"]:a,["useSvg"]:x});if(this.la.ka("DefaultToModernSlideShow")&&(f||l)){this.K.register(924,"PowerPointWebEditor.ISlideshowFrame").ma().na(()=>new aQ.SlideShowCoreFrame(this.vb,this.la,
this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.resolve("Common.IDynamicScriptLoaderProvider").yv,this.K.La("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.La("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),x,this.K.resolve("PowerPoint.IPathManager"),this.K.La("Common.App.HostNotification.EditNotificationEventSource"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,u.AFrameworkApplication.He));const wa={};wa.loadScriptStart=Date.now();a=TC.a.create(u.AFrameworkApplication.Fk("powerpoint-slideshow-strings",3));Xi.a.wx(a);a=new Ha.a;c=this.K.resolve("Common.IDynamicScriptLoaderProvider").yv;a.add(c.loadScript("SlideShowCore"));a.add(c.loadScript("PodsProxy"));a.add(c.loadScript("PPTSpeechClient"));Promise.all(a.toArray()).then(()=>{wa.loadScriptEnd=Date.now();const Xa={Type:"LoadedJS"};xa.a.forEach(wa,
(lb,Lb)=>{Xa[lb]=Lb},null);this.a6b(Xa);this.K.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders();this.K.resolve("PowerPointWebEditor.ISlideshowFrame").init(u.AFrameworkApplication.buildVersion,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").Wj,u.AFrameworkApplication.userSessionId,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId);this.K.resolve("PowerPointWebEditor.ISlideshowManager").o3k();this.K.La("PowerPointWebEditor.IRibbonUser").execute(lb=>{lb.uF()});
return null}).catch(Xa=>{this.a6b({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});ya.a.J(512309318,830,10,"LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Xa)})}else this.la.ka("DefaultToModernSlideShow")?this.a6b({["Type"]:"Fallback",["Reason"]:"UnSupportedBrowser"}):ya.a.J(512309319,830,50,"PptDefaultToModernSlideShow is disabled"),this.K.register(924,"PowerPointWebEditor.ISlideshowFrame").ma().na(()=>new $P.SlideshowFrame(this.K.resolve("PowerPointWebEditor.IWebGLHelper"),
this.vb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.La("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.La("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("Common.IDynamicScriptLoaderProvider").yv));this.K.register(WC,"PowerPointWebEditor.SlideShowFooterContainer").na(()=>new WC(this.vb,u.AFrameworkApplication.Ta));this.K.resolve("PowerPointWebEditor.SlideShowFooterContainer").ub();
let F;if(!this.la.Z3b||this.la.J5g)this.K.register(ZC,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>new ZC(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.La("PowerPointLive.ILivePresenter"),this.vb,()=>u.AFrameworkApplication.isRtl,this.la.podsWebServiceBase,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),
this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");else{a=Ry.a(this.K);c=new Ha.a;c.add(a("slideshowToolbar"));this.la.oyk&&c.add(a("uiFabricLazy"));Promise.all(c.toArray()).catch(Xa=>ya.a.J(50907106,830,10,"Failed to load the resources for the slideshowToolbar feature: {0}",Xa)).then(()=>this.Iok()).catch(Xa=>ya.a.J(50907136,830,10,"Failed to load the React slideshowToolbar: {0}",Xa));this.la.isInkUIInSlideShowEnabled&&(a("inkButton").catch(Xa=>
ya.a.J(51218050,830,10,"Failed to load the resources for the ink button feature: {0}",Xa)).then(()=>this.Rkk()).catch(Xa=>ya.a.J(51218052,830,10,"Failed to load the React ink button: {0}",Xa)),this.K.register(1077,"PowerPointWebEditor.IInkButtonHelper").ma().na(()=>new yJ));if(this.la.pptEditorVoiceUXEnabled){const Xa=this;a("voiceUI").catch(lb=>ya.a.J(595198419,830,10,"Failed to load the resources for the voice UI feature: {0}",lb)).then(()=>Xa.Jok()).catch(lb=>ya.a.J(595198417,830,10,"Failed to load the voice UI script: {0}",
lb));this.K.register(1078,"PowerPointWebEditor.ISlideShowVoiceNotification").ma().na(()=>new EJ)}const wa=this;this.K.register(VC,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>new VC(u.AFrameworkApplication.Ta,wa.la,wa.K.resolve("PowerPointWebEditor.ISlideshowFrame"),wa.K.resolve("PowerPoint.IPathManager"),wa.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),wa.K.La("PowerPointLive.ILivePresenter"),wa.vb,()=>u.AFrameworkApplication.isRtl,
wa.la.podsWebServiceBase,wa.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),wa.K.resolve("PowerPointWebEditor.IFullscreenHelper")))}F=this.K.La("PowerPointWebEditor.ISlideshowToolbar");const R=this;this.K.register(YC,"PowerPointWebEditor.SlideshowContextMenu").na(()=>new YC(R.K.resolve("PowerPointWebEditor.ISlideshowFrame"),R.K.resolve("PowerPointWebEditor.IPresentationReader"),R.K.resolve("PowerPointWebEditor.IInputHandlerManager"),u.AFrameworkApplication.Ta,R.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
R.vb,()=>u.AFrameworkApplication.isRtl,R.K.resolve("PowerPointWebEditor.IFullscreenHelper"),R.K.La("PowerPointLive.ILivePresenter")));const fa=this;this.K.register(1079,"PowerPointWebEditor.ISlideshowManager").ma().na(()=>new FJ(fa.K.resolve("PowerPointWebEditor.IFullscreenHelper"),fa.K.resolve("PowerPointWebEditor.ISlideshowFrame"),F,fa.K.resolve("PowerPointWebEditor.SlideshowContextMenu"),fa.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.AFrameworkApplication.He,fa.la,b,fa.K.resolve("PowerPointWebEditor.IPresentationReader"),
fa.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),fa.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),fa.K.resolve("PowerPointWebEditor.IErrorHandler"),hb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),fa.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),fa.K.resolve("PowerPointWebEditor.IZoomContentFetcher"),or.a.vu(hb.a.instance.La("Common.ISystemInitiatedFeedback")),u.AFrameworkApplication.Ta,hb.a.instance.La("PowerPointLive.ILivePresenter"),fa.K.resolve("PowerPointWebEditor.SlideShowFooterContainer"),
fa.K.La("PowerPointWebEditor.ISlideShowVoiceNotification")))}a6b(a){ya.a.J(594583632,830,15,JSON.stringify(a))}UCj(){const a=this.la.Ha("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ha("SessionStartInfoJson").toString());ya.a.J(512309317,830,50,"IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||
"",10)<parseInt(c.split(":")[1],10))return ya.a.J(512309316,830,50,"IsBrowserModernWebGLCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}TCj(){const a=this.la.Ha("PptModernSlideShowBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ha("SessionStartInfoJson").toString());ya.a.J(512309315,830,50,"IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&
parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return ya.a.J(512309314,830,50,"IsBrowserModernCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}VCj(a){return IJ.a(a)}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(D.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){pd.a.get_instance().Xj(10,null).continueWith(()=>{if(!this.la.xS&&this.la.F5g&&this.la.Gzk)try{or.a.vu(hb.a.instance.La("Common.ISystemInitiatedFeedback")).continueWith(a=>{a.result.logActivity("HasPresentButtonSeen",
"PresentTeachingUIEnabled")}),ya.a.J(512495957,830,50,"Present Teaching UI triggered")}catch(a){ya.a.J(512495956,830,10,"Exception thrown when trying to trigger Present teaching UI. Exception: {0}",a)}})}Iok(){this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}Rkk(){this.K.resolve("PowerPointWebEditor.IInkButtonHelper");return null}Jok(){this.K.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");return null}dispose(){}static main(){m.a.instance.Ac(new aD)}}Object(e.a)(aD,"PPTWebEditorSlideShowPackage",
null,[2,3]);var bQ=d(757);class JJ{constructor(){this.x7b=null}bbl(a,b){yj.UISurfaces.VM().then(c=>{this.x7b=a.LGi(c,a.azi(b),b,this.x7b)});ya.a.J(527303443,843,50,"{0} Toast is displayed",Object.getType(a).toString())}sNk(a){yj.UISurfaces.VM().then(b=>{this.x7b=a.hNk(b,this.x7b)});ya.a.J(523871965,843,50,"{0} Toast is removed",this.x7b)}}Object(e.a)(JJ,"DeferredNotificationCalloutVisibilityManager",null,[]);var KJ=d(989);const cQ=a=>{const b={featureArea:"Partial Presentation"};b.sourceContext=a;
a={};a.telemetryGroup=b;return a},dQ=(a,b,c,f)=>{const l=new rj.StandardDialog;l.vd=0;if(u.AFrameworkApplication.aE){const x=cQ(b);l.zFd(ResourceStrings.L_GiveFeedback,void 0,void 0,x)}l.Yw(c,f,0,a?x=>{1===x?(ya.a.J(526989467,830,50,"User selected Present Anyway in {0}",b),a()):ya.a.J(526989468,830,50,"User selected Cancel in {0}",b)}:null)};class bD{constructor(a,b,c,f,l,x,F){this.j8={};this.iua=new Me.a;this.w1c=this.Wne=null;this.j0c=this.fme=0;this.zFg=!1;this.w0j=ee.a("PartialDoc.SkipCheckGraphForPresentationDeferred");
this.E2c={};if(!F)throw Error.argumentNull("coreEventSource");this.kL=a;this.oq=c;this.kL.xk(Object(D.a)(this,this.R_g,"onShapeNodePropertyChanged"));this.kL.Kga(Object(D.a)(this,this.xdc,"onShapeNodeLoaded"));this.kL.Iga(Object(D.a)(this,this.Q_g,"onShapeNodeConnected"));this.rEg=new JJ;this.fh=l;b.dGd(Object(D.a)(this,this.Aue,"onClientError"));b.BGd(Object(D.a)(this,this.hwe,"onServerError"));u.AFrameworkApplication.Azc(Object(D.a)(this,this.Wue,"onErrorDialogDisplayed"));this.EEg=f;this.Rja=x;
this.Ci=F;this.Ci.uB(Object(D.a)(this,this.G_g,"onSessionRehydratedHandler"))}UBf(a,b){this.iua.Jb(a)||this.iua.$(a,new oa.a);const c=this.iua.ga(a);c.add(b);this.iua.$(a,c)}Ubh(a,b){if(this.iua.Jb(a)){var c=this.iua.ga(a);c.remove(b);this.iua.$(a,c);this.r3d(a)||this.iua.remove(a);vq.a(this.j8).length||ya.a.J(520927263,843,50,"DeferredContentManager::RemoveFromSlideDeferredInfo - no more deferred content in document")}else ya.a.J(524321747,843,15,"DeferredContentManager::RemoveFromSlideDeferredInfo - no deferred content on slideId:{0} shapeNodeId:{1}",
a,b)}r3d(a){return this.iua.Jb(a)&&0<this.iua.ga(a).count}kMf(a){if(a.slideId&&a.slideId.sid&&a.CVc){var b=a.CVc;a.J2?(this.zFg||(this.zFg=!0,ya.a.J(555836314,843,50,"DeferredContentManager - deferred content detected: FForceShowDeferralUI: {0}",this.Rja)),b in this.j8||(this.j8[b]=new Date),this.UBf(a.slideId.sid.toString(),b)):b in this.j8&&(delete this.j8[b],this.Ubh(a.slideId.sid.toString(),b),ya.a.J(520927262,843,15,"DeferredContentManager - Rehydration scenario, Node already in deferred list on load/connect."))}}xdc(a,
b){(a=Object(va.a)(4,b.node))?this.kMf(a):ya.a.J(557126034,843,10,"IDeferrable object is null")}Q_g(a,b){(a=Object(va.a)(4,b.node))?this.kMf(a):ya.a.J(557126035,843,10,"IDeferrable object is null")}R_g(a,b){var c=Object(va.a)(4,b.node);if(!c)ya.a.J(557126873,843,10,"IDeferrable object is null");else if((b.property===ub.a.J2||this.Rja&&c.CVc in this.j8&&!c.J2)&&c.slideId)if(b=c.CVc,a=c.slideId.sid.toString(),c.J2)b in this.j8?ya.a.J(557164308,843,15,"ShapeNode is already deferred:{0}, FForceShowDeferralUI: {1}",
b,this.Rja):(ya.a.J(527720478,843,50,"ShapeNode is deferred:{0}, FForceShowDeferralUI: {1}",b,this.Rja),this.j8[b]=new Date,this.UBf(a,b));else{if(c=this.j8[b])c=(new Date).getTime()-c.getTime(),ya.a.J(557164309,843,50,"ShapeNode:{0}, DeferredDurationMS:{1}, FForceShowDeferralUI:{2}",b,c,this.Rja),delete this.j8[b],this.Ubh(a,b),this.j0c=c>this.j0c?c:this.j0c;this.EEg&&!this.hasDeferredContent()&&(ya.a.J(520471008,843,50,"All deferred blobs loaded"),this.npa("AllDeferredBlobsLoaded","true"),this.w1c&&
(ya.a.J(520471007,843,50,"Previously called user requested actions triggered"),this.npa("PreviouslyDeferredActionsTriggeredOnBlobsLoad","true"),this.w1c(),this.rEg.sNk(this.Wne),this.Wne=this.w1c=null))}}G_g(){ya.a.J(520722338,843,50,"Session rehydrated with {0} currently deferred blobs",vq.a(this.j8).length)}fLe(a,b,c){this.EEg?(this.Wne=b,this.w1c=c,this.rEg.bbl(b,this.fh)):(c=Object(Fa.a)(KJ.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle,
b=Object(Fa.a)(KJ.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage,dQ(null,a.toString(),c,b));ya.a.J(526989469,801,100,"ShowDeferredContentWaitUI shown for :{0}",a)}npa(a,b){this.E2c[a]&&ya.a.J(522269249,843,15,"DeferredContentManager - This action has been requested before. Key: {0}, Value: {1}",a,this.E2c[a]);this.E2c[a]=b}Aue(a,b){this.recordError("ClientError",b)}hwe(a,b){this.recordError("ServerError",b)}Wue(a,b){(a=Object(va.a)(bQ.a,
b))&&this.recordError("Crash",a.errorCode)}recordError(a,b){this.hasDeferredContent()&&ya.a.J(556364418,843,15,"DeferredContentManager - Error while there is deferred content: ErrorType:{0}, ErrorInfo:{1}, FForceShowDeferralUI:{2}",a,b,this.Rja)}dispose(){this.kL.Tm(Object(D.a)(this,this.R_g,"onShapeNodePropertyChanged"));this.kL.ZWa(Object(D.a)(this,this.xdc,"onShapeNodeLoaded"));this.kL.ima(Object(D.a)(this,this.Q_g,"onShapeNodeConnected"));this.Ci.hea(Object(D.a)(this,this.G_g,"onSessionRehydratedHandler"));
this.log()}hasDeferredContent(){const a=vq.a(this.j8),b=(!this.w0j||this.Rja)&&0<a.length||0<this.oq.v4a;if(b){const c={};c.DeferredNodeCount=a.length.toString();c.DeferredBlobCount=this.oq.v4a.toString();c.FForceShowDeferralUI=this.Rja.toString();ya.a.J(521175389,843,50,JSON.stringify(c));this.fme=Math.max(this.oq.v4a,this.fme)}return b}qqj(a){return Pa.a.any(a,b=>b.hasDeferredContent)?(ya.a.J(556312344,843,50,"{0} DeferredSlideCount: {1}, FForceShowDeferralUI: {2}","CutCopySlides",a.length,this.Rja),
!0):!1}q3d(a,b){return Pa.a.any(a,c=>c.J2)?(ya.a.J(556312348,843,50,"{0} DeferredShapeCount: {1}, FForceShowDeferralUI: {2}",b,a.length,this.Rja),!0):!1}log(){const a=vq.a(this.j8),b={};b.MaxDeferredTime=this.j0c.toString();b.DeferredCountOnClose=a.length.toString();b.MaxNumberOfDeferredBlobs=this.fme.toString();b.FForceShowDeferralUI=this.Rja.toString();ya.a.J(556364419,843,15,"SessionLogs: {0}, PersistedLogs: {1}",JSON.stringify(b),JSON.stringify(this.E2c))}}Object(e.a)(bD,"DeferredContentManager",
null,[1108]);class cD{constructor(){this.Wv=this.K=null}get name(){return"PowerPointWebEditor.PartialDoc"}Wb(a){this.K=a;this.K.register(bD,"PowerPointWebEditor.DeferredContentManager").as("PowerPointWebEditor.IDeferredContentManager").ma().na(()=>new bD(this.K.resolve("Box4.Graph.IGraphInstance").Bd(10),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),this.K.resolve("Common.IF6Manager"),
0<this.K.resolve("Common.IAppSettingsManager").Ec("ForceShowDeferralUIMS",0),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource")))}init(){this.Wv=this.K.resolve("PowerPointWebEditor.IDeferredContentManager")}dispose(){this.Wv&&this.Wv.dispose()}static main(){m.a.instance.Ac(new cD)}}Object(e.a)(cD,"PPTWebEditorPartialDocPackage",null,[2,3]);class ov{constructor(a,b){this.shapeNode=a;this.position=b}}Object(e.a)(ov,"MoveShapeData",null,[]);class LJ{constructor(a,b){this.GN=null;this.Uo=a;this.ia=
b}start(){this.GN=[];for(let a=0;a<this.Uo.length;++a)Array.add(this.GN,new ad.a(this.Uo[a].x,this.Uo[a].y)),this.Uo[a].eD(!1)}SKd(a,b){if(1!==a||this.Uo.length!==b.length)return!1;for(a=0;a<b.length;a++)if(!this.fFj(b[a]))return!1;return!0}fFj(a){for(let b=0;b<this.Uo.length;b++)if(a.$a.equals(this.Uo[b].$a))return!0;return!1}perform(a){for(let c=0;c<this.Uo.length;c++){var b=new ad.a(this.Uo[c].x,this.Uo[c].y);b=ad.a.add(b,a);this.Uo[c].setPosition(b.x,b.y,!0)}}end(){this.GN&&ya.a.J(17597603,815,
50,"ShapeKeyboardDragManager::ShapeMoveAction - moving {0} shapes by ( {1}, {2} )",this.Uo.length,this.Uo[0].x-this.GN[0].x,this.Uo[0].y-this.GN[0].y);const a=[];for(let b=0;b<this.Uo.length;++b){const c=this.Uo[b].MKc();Array.add(a,new ov(this.Uo[b].shapeNode,c));this.Uo[b].rz(!1)}this.ia.Ka(ba.a.lGa,2,a)}}Object(e.a)(LJ,"ShapeMoveAction",null,[446]);class uz{constructor(a,b,c=null,f=null){this.g0=a;this.V_=b;this.PXb=c;this.tTg=f}}Object(e.a)(uz,"ResizeShapeData",null,[]);class MJ{constructor(a,
b){this.QDa=this.Mwb=this.Npe=null;this.pF=a;this.ia=b}start(){this.Npe=[];this.Mwb=[];this.QDa=[];for(const c of this.pF){c.DK=!0;c.eD(!1);Array.add(this.Npe,c.UVa);Array.add(this.Mwb,new Pd.a);var a=c.Arb(),b=ad.a.Rl(a.Zj(Kd.a.qu),a.Zj(Kd.a.ND));a=ad.a.Rl(a.Zj(Kd.a.qu),a.Zj(Kd.a.fH));Array.add(this.QDa,a?b/a:1);c.shapeNode.Mf&&c.shapeNode.isEditable&&(b=c,b.zk&&(b.zk.visible=!0))}}SKd(a,b){if(2!==a)return!1;for(a=0;a<b.length;a++)if(b[a].ll||!b[a].$a.equals(this.pF[a].$a))return!1;return!0}perform(a,
b){for(let f=0;f<this.pF.length;f++){var c=a;let l=b;({deltaX:c,deltaY:l}=this.Ntl(c,l,f));let x;(x=this.Mwb[f]).right=x.right+c;let F;(F=this.Mwb[f]).bottom=F.bottom+l;this.pF[f].setOffsets(Pd.a.add(this.Npe[f],this.Mwb[f]),!0);this.pF[f].shapeNode.Mf&&this.pF[f].shapeNode.isEditable&&(c=this.pF[f],c.U3d(),c.nPc())}}Ntl(a,b,c){if(!this.pF[c].shapeNode.isAspectRatioLocked)return{deltaX:a,deltaY:b};b?a=b*this.QDa[c]:b=a/this.QDa[c];return{deltaX:a,deltaY:b}}end(){const a=[];for(let b=0;b<this.pF.length;b++)this.pF[b].ll||
(this.pF[b].shapeNode.Mf&&this.pF[b].shapeNode.isEditable||(this.pF[b].DK=!1),this.pF[b].rz(!1),Array.add(a,new uz(this.pF[b].shapeNode,this.Mwb[b])));this.ia.Ka(ba.a.Deb,2,a);this.pF=null}}Object(e.a)(MJ,"ShapeResizeAction",null,[446]);class wp{constructor(a,b){this.shapeNode=a;this.RUf=b%wp.Odc}}wp.Odc=360;Object(e.a)(wp,"ShapeRotateData",null,[]);class NJ{constructor(a,b){this.EDg=null;this.Wce=0;this.Pd=a;this.ia=b}start(){this.Pd.eD(!1);this.EDg=this.Pd.Arb().Uf()}SKd(a,b){return 3===a&&!this.Pd.ll&&
this.Pd.$a.equals(b[0].$a)}perform(a){this.Wce=(this.Pd.rotation+a)%wp.Odc;this.Pd.setRotation(this.Wce,this.EDg)}end(){if(!this.Pd.ll){this.Pd.rz(!1);var a=new wp(this.Pd.shapeNode,this.Wce);this.ia.Ka(ba.a.Dic,2,a)}}}Object(e.a)(NJ,"ShapeRotateAction",null,[446]);class xp{constructor(a){this.aGa=this.bQ=null;this.ia=a}pnc(){this.aGa&&Mc.a.Pob(this.aGa);this.aGa=Mc.a.Z9(Object(D.a)(this,this.uZf,"endAction"),xp.Tgi)}aTd(a,b){this.bQ&&!this.bQ.SKd(a,b)&&(this.bQ.end(),this.bQ=null);if(!this.bQ){this.bQ=
this.PWi(a,b);if(!this.bQ)throw Error.invalidOperation("Could not create keyboard action");this.bQ.start()}this.pnc();return this.bQ}uZf(){this.bQ&&(this.bQ.end(),this.bQ=null);this.aGa=null}move(a,b){a=this.aTd(1,a);b=this.yWf(b);a.perform(b)}resize(a,b){a=this.aTd(2,a);b=this.yWf(b);a.perform(b.x,b.y)}rotate(a,b,c){a=this.aTd(3,a);c=c?xp.Kgi:xp.Jgi;a.perform(b?c:-1*c)}yWf(a){let b=0,c=0;a.equals(Kd.a.north)?c=-1*xp.KBc:a.equals(Kd.a.east)?b=xp.KBc:a.equals(Kd.a.south)?c=xp.KBc:a.equals(Kd.a.west)&&
(b=-1*xp.KBc);return new ad.a(b,c)}PWi(a,b){return b?1===a?new LJ(b,this.ia):2===a?new MJ(b,this.ia):3===a&&(1<b.length&&ya.a.J(17651872,815,15,"ShapeKeyboardDragManager::GetActionForType - Currently we don't support multi-shapes rotation, will only rotate the first shape by keyboard."),3===a)?new NJ(b[0],this.ia):null:null}}xp.Tgi=1E3;xp.KBc=1;xp.Jgi=15;xp.Kgi=1;Object(e.a)(xp,"ShapeKeyboardDragManager",null,[407]);var sg=d(152),Is=d(535);const Qn=a=>{a&&Mc.a.Cb&&(Mc.a.Cb.zgg=a.Mf,Mc.a.Cb.Gth=a.mh)};
var Aq=d(240),OJ=d(491),Bx=d(316);class dD{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe){if(!Ec)throw Error.argumentNull("ISessionInfoOwner is null");if(!Jc)throw Error.argumentNull("IPPTUnitConversion is null");if(!Dc)throw Error.argumentNull("IZoomContext is null");lc||ya.a.J(560321568,815,10,"ShapeManipulationActor constructor null WebSocketFrontDoor");this.ia=a;this.Af=b;this.Vp=c;this.Fa=f;this.nb=l;this.J2c=x;this.Db=F;this.Qb=R;this.Ea=fa;this.gf=wa;this.Ur=Lb;this.Iz=Xa;
this.z7j=lb;this.Ga=kc;this.t9b=new ua.ScriptSharpLegacyMap;this.vVa=lc;this.Xa=Ec;this.Rj=Jc;this.Yi=Dc;this.vi=Wd;this.fta=xe}ub(){this.ia.pa(ba.a.I3a,fc.a.application,Object(D.a)(this,this.Ekj,"handleDeleteSelectedShapes"),4);this.ia.pa(ba.a.mXb,fc.a.application,Object(D.a)(this,this.Fkj,"handleDeleteShapes"),4);this.ia.pa(ba.a.lGa,fc.a.application,Object(D.a)(this,this.wmj,"handleMoveShapes"),4);this.ia.pa(ba.a.Deb,fc.a.application,Object(D.a)(this,this.voj,"handleResizeShapes"),4);this.ia.pa(ba.a.Dic,
fc.a.application,Object(D.a)(this,this.$2d,"handleRotateShape"),4);this.ia.pa(ba.a.JVk,fc.a.application,Object(D.a)(this,this.Uhg,"handleRotateShapeAnchor"),4);this.ia.pa(ba.a.KVk,fc.a.application,Object(D.a)(this,this.Uhg,"handleRotateShapeAnchor"),4);this.ia.pa(ba.a.nea,fc.a.application,Object(D.a)(this,this.Vhg,"handleRotateShapeByDirection"),4);this.ia.pa(ba.a.Bgh,fc.a.application,Object(D.a)(this,this.Vhg,"handleRotateShapeByDirection"),4);ee.a("FlipInMultiSelectEnabledV2")?(this.ia.pa(ba.a.Ndd,
fc.a.application,Object(D.a)(this,this.bhg,"handleFlipShape"),4),this.ia.pa(ba.a.Mdd,fc.a.application,Object(D.a)(this,this.bhg,"handleFlipShape"),4)):(this.ia.pa(ba.a.Ndd,fc.a.application,Object(D.a)(this,this.chg,"handleFlipShapeForSingleSelection"),4),this.ia.pa(ba.a.Mdd,fc.a.application,Object(D.a)(this,this.chg,"handleFlipShapeForSingleSelection"),4));this.ia.pa(ba.a.T3a,fc.a.application,Object(D.a)(this,this.mkj,"handleCommitKeyboardShapeManipulation"),4);this.ia.pa(ba.a.ccc,Fb.a.view,Object(D.a)(this,
this.tOc,"handleMoveShapesKeyboard"),4);this.ia.pa(ba.a.dcc,Fb.a.view,Object(D.a)(this,this.tOc,"handleMoveShapesKeyboard"),4);this.ia.pa(ba.a.ecc,Fb.a.view,Object(D.a)(this,this.tOc,"handleMoveShapesKeyboard"),4);this.ia.pa(ba.a.fcc,Fb.a.view,Object(D.a)(this,this.tOc,"handleMoveShapesKeyboard"),4);this.ia.pa(ba.a.nic,Fb.a.view,Object(D.a)(this,this.BOc,"handleResizeShapesKeyboard"),4);this.ia.pa(ba.a.oic,Fb.a.view,Object(D.a)(this,this.BOc,"handleResizeShapesKeyboard"),4);this.ia.pa(ba.a.pic,Fb.a.view,
Object(D.a)(this,this.BOc,"handleResizeShapesKeyboard"),4);this.ia.pa(ba.a.qic,Fb.a.view,Object(D.a)(this,this.BOc,"handleResizeShapesKeyboard"),4);this.ia.pa(ba.a.CFe,Fb.a.view,Object(D.a)(this,this.COc,"handleRotateShapeKeyboard"),4);this.ia.pa(ba.a.Pdd,Fb.a.view,Object(D.a)(this,this.COc,"handleRotateShapeKeyboard"),4);this.ia.pa(ba.a.Odd,Fb.a.view,Object(D.a)(this,this.COc,"handleRotateShapeKeyboard"),4);this.ia.pa(ba.a.Eic,Fb.a.view,Object(D.a)(this,this.COc,"handleRotateShapeKeyboard"),4);this.ia.pa(ba.a.jBe,
fc.a.application,Object(D.a)(this,this.L2d,"handleIsDirectManipulationEnabled"),97);this.ia.pa(ba.a.p6g,fc.a.application,Object(D.a)(this,this.Jhg,"handlePreviewRotate"),4);this.ia.pa(ba.a.q6g,fc.a.application,Object(D.a)(this,this.Jhg,"handlePreviewRotate"),4);this.ia.pa(ba.a.jVk,fc.a.application,Object(D.a)(this,this.yoj,"handleRevertPreviewRotate"),4)}we(){const a=this.Fa.Bc(Nc.a.yg);a.bindAction(A.KeyInputManager.Na(w.a.s5,4),ba.a.nic);a.bindAction(A.KeyInputManager.Na(w.a.t$,4),ba.a.oic);a.bindAction(A.KeyInputManager.Na(w.a.afa,
4),ba.a.pic);a.bindAction(A.KeyInputManager.Na(w.a.YX,4),ba.a.qic);a.bindAction(A.KeyInputManager.Na(w.a.t$,5),ba.a.Odd);a.bindAction(A.KeyInputManager.Na(w.a.afa,5),ba.a.Eic);a.bindAction(A.KeyInputManager.Na(w.a.t$,1),ba.a.CFe);a.bindAction(A.KeyInputManager.Na(w.a.afa,1),ba.a.Pdd);a.bindAction(A.KeyInputManager.Na(w.a.kna,0),ba.a.I3a);a.bindAction(A.KeyInputManager.Na(w.a.jH,0),ba.a.I3a);this.Fa.Bc(Nc.a.gj).bindAction(A.KeyInputManager.Na(w.a.t$,1),G.a.ze)}wmj(a,b,c,f,l){if(!l||!Object(Fa.a)(Array,
l)||1>l.length)return 8;for(const F of l)if(b=F.shapeNode,this.YOa(b),b.get_smartArtModelId()&&(b=this.Ea.er(b)),!this.cLf(b)||this.Af.Zc(F.shapeNode))return 16;if(1===c)return 32;if(Mc.a.Cb){Mc.a.Cb.Ij=!0;for(var x of l)if((c=x.shapeNode)&&(c.Mf||c.mh)){Qn(c);break}}x=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{x.jc(l[0].shapeNode);x.$c=a;const F=this.Qb.Cd;for(const R of l){const fa=new ad.a(F.Ef(R.position.x,0),F.Ef(R.position.y,1));oq.c(R.shapeNode.get_smartArtModelId()?this.Ea.er(R.shapeNode):
R.shapeNode,fa.x,fa.y)}}finally{x&&x.dispose()}return 32}voj(a,b,c,f,l){if(!l||!Object(Fa.a)(Array,l)||1>l.length)return 8;for(b=0;b<l.length;b++){if(!this.zUb(l[b].g0))return ya.a.J(17622101,815,15,"ShapeManipulationActor::ResizeShapes - Try to execute HandleResizeShapes when {0} shape is not resizable.",l[b].g0.get_shapeId()),16;if(this.Af.Zc(l[b].g0))return 16}if(1===c)return 32;if(Mc.a.Cb){Mc.a.Cb.Ij=!0;for(var x of l)if((c=x.g0)&&(c.Mf||c.mh)){Qn(c);break}}x=this.Db.rd(15,void 0,()=>{this.nb.hj();
const F=this.Fa.ye;!F||F.name!==Nc.a.yg&&F.name!==Nc.a.pC||this.Fa.Ad()});try{for(x.jc(l[0].g0),x.$c=a,a=0;a<l.length;a++)l[a].g0.pnh=l[a].V_}finally{x&&x.dispose()}if(this.nb.GK()&&(a=this.nb.$Ba(),(a=this.Jk(a))&&Object(Fa.a)(Is.a,a.zk)&&Object(va.a)(Is.a,a.zk).clearChildSelection(),this.vVa&&this.Ga.Lel))for(const F of l)this.e_k(F);return 32}e_k(a){const b=a.g0;if(b&&b.Qf&&!b.mh){var c=Mc.a.Cb?Mc.a.Cb.actionId:lh.a.create().toString(),f=u.AFrameworkApplication.userSessionId,l=this.Xa.podSessionId,
x=this.Eel,F=this.lgb,R=F/x,fa=Fd.a.lX(this.Rj.KQ(a.V_.left,R),0),wa=Fd.a.lX(this.Rj.KQ(a.V_.top,R),1),Xa=Fd.a.lX(this.Rj.KQ(a.V_.right,R),0);a=Fd.a.lX(this.Rj.KQ(a.V_.bottom,R),1);R=Math.abs(b.get_widthPersisted()+Xa-fa);var lb=Math.abs(b.get_heightPersisted()+a-wa);Xa=fl.o(b.slideCid,b.slideSid);a=fl.b(b.get_shapeId(),null);var Lb=fl.f(Xa,a);fa=fl.m((b.get_xPersisted()+fa).toString(),(b.get_yPersisted()+wa).toString());fa=fl.n(R,lb,fa);fa=fl.c(Lb,fa);wa=null;this.vi&&this.vi.highContrastColors&&
(wa=fl.k(fl.j(this.vi.highContrastColors.foregroundTextColor),fl.j(this.vi.highContrastColors.backgroundColor),fl.j(this.vi.highContrastColors.linkColor)));f=fl.d(Xa,a,1,b.lh,0,0,c,f,this.vi.isInHighContrastMode,wa,this.Ga.sjh&&this.fta?this.fta.q5i():null);l=fl.e(f,[],l);l.editOps.push(fa);l=fl.q(null,l,null,null,this.Xa.Wj);f=Mc.a.VX();Mc.a.Cb&&f&&(Mc.a.Cb.Wa("editOpCorrelationId",c),Mc.a.Cb.Wa("editOpRequestStartTick",f.toString()));this.vVa.gx(l);ya.a.J(561292930,815,50,"ShapeManipulationActor::HandleResizeShapes Sent SmartArtEditOpRequest; correlationId:{0}, slideSid:{1}, slideCid:{2}, shapeId:{3}, slideZoomFactor:{4}, slideImageZoom:{5}, SendKnownGlyphsForSmartArtResizeEditOp:{6}",
c,b.slideSid,b.slideCid,b.get_shapeId(),x,F,this.Ga.sjh)}}get Eel(){let a=this.Yi.ZF;this.Vp&&this.Vp.Ba&&this.Vp.Ba.uw&&null!=this.Vp.Ba.uw.Fr&&(a=this.Vp.Ba.uw.Fr);a||(ya.a.J(561292931,815,15,"ShapeManipulationActor.SlideZoomFactor: zero slideZoomFactor"),a=1);return a}get lgb(){let a=1;if(this.Vp&&this.Vp.Ba){const b=Object(va.a)(253,this.Vp.Ba.Ag(this.Qb.Ma));b?a=b.BV:ya.a.J(561292932,815,15,"ShapeManipulationActor.SlideImageZoom: no active ISlideViewElement; imageZoom:{0}",a)}else ya.a.J(561292933,
815,15,"ShapeManipulationActor.SlideImageZoom: no active slide; imageZoom:{0}",a);a||(ya.a.J(561292934,815,15,"ShapeManipulationActor.SlideImageZoom: zero imageZoom"),a=1);return a}Vhg(a,b,c,f,l){return 1===c?32:sg.a("Rotate",a,()=>{ya.a.J(50598791,822,50,"ShapeManipulationActor::HandleRotateShapeByDirection, Rotate operation performed");const x=this.nb.mg();if(!x)return ya.a.J(50598793,822,10,"ShapeManipulationActor::HandleRotateShapeByDirection, selected nodes: null"),16;this.z7j&&1===x.length&&
this.YOa(x[0]);switch(a){case ba.a.nea:ya.a.J(50598795,822,50,"ShapeManipulationActor::RotateLeft: Rotate Left is selected");for(const F of x)l=new wp(F,Math.round(F.get_shapeRotation()+270)),this.$2d(a,b,c,f,l);break;case ba.a.Bgh:ya.a.J(50598797,822,50,"ShapeManipulationActor::RotateRight: Rotate Right is selected");for(const F of x)l=new wp(F,Math.round(F.get_shapeRotation()+90)),this.$2d(a,b,c,f,l);break;default:return 8}return 32})}$2d(a,b,c,f,l){if(!l||!Object(Fa.a)(wp,l))return 8;b=l.shapeNode;
f=this.AUb(b);if(1===c)return f?32:8;if(!f||this.Af.Zc(b))return 16;Mc.a.Cb&&(Mc.a.Cb.Ij=!0,b&&(b.Mf||b.mh)&&Qn(b));c=this.Db.rd(15,void 0,()=>{this.nb.hj();const x=this.Fa.ye;!x||x.name!==Nc.a.yg&&x.name!==Nc.a.pC||this.Fa.Ad()});try{c.jc(b),c.$c=a,b.set_shapeRotation(l.RUf)}finally{c&&c.dispose()}return 32}Uhg(){const a=this.nb.mg();return 0<a.length&&this.eMj(a)?32:8}Jhg(a,b,c){return this.Ga.Afc?1===c?32:sg.a("HandlePreviewRotate:",a,()=>{var f=this.nb.mg();for(const l of f){if(!l){ya.a.J(562317533,
822,50,"HandlePreviewRotate, shape with shape id : {0} is null",l.get_shapeId());continue}if(l.nd)continue;this.t9b.Jb(l.get_shapeId())?this.t9b.$(l.get_shapeId(),l.get_shapeRotation()):this.t9b.add(l.get_shapeId(),l.get_shapeRotation());f=this.Jk(l);if(!f){ya.a.J(562317534,822,50,"HandlePreviewRotate, shapeViewElement with shape id : {0} is null",l.get_shapeId());continue}const x=f.Arb().Uf();switch(a){case ba.a.p6g:f.setRotation((l.get_shapeRotation()+270)%wp.Odc,x);break;case ba.a.q6g:f.setRotation((l.get_shapeRotation()+
90)%wp.Odc,x)}}return 32}):2}yoj(a,b,c){if(!this.Ga.Afc)return 2;if(1===c)return 32;a=this.nb.mg();for(const f of a)if(!f)ya.a.J(562317535,822,50,"HandleRevertPreviewRotate, shape with shape id : {0} is null",f.get_shapeId());else if(!f.nd)if(a=this.Jk(f))if(b=a.Arb().Uf(),this.t9b.Jb(f.get_shapeId()))a.setRotation(this.t9b.ga(f.get_shapeId()),b);else return ya.a.J(562626886,815,10,"HandleRevertPreviewRotate: Revert Preview operation on the shape failed with id : {0}",f.get_shapeId()),8;else ya.a.J(562317536,
822,50,"HandleRevertPreviewRotate, shapeViewElement with shape id : {0} is null",f.get_shapeId());return 32}Ekj(a,b,c,f,l){b=this.nb.mg();if(1===b.length&&this.nb.lD())return 16;f=1===b.length&&!!b[0]&&b[0].NCa();f=0<b.length&&!f;if(1===c)return f?32:8;if(!f)return 16;if(Mc.a.Cb){Mc.a.Cb.actionName="ClearPlaceholders";Mc.a.Cb.Ij=!0;for(const x of b)if(x.Mf||x.mh){Qn(x);break}}if(this.nb.GK()&&ee.a("EnableSmartArtSubShapeDeletion")&&this.H2d(b[0],a,l))return 32;c=null;if(l=this.Ea.h6a(b))ee.a("SmartArtSubNodeEditing")?
c=this.Ea.er(l):(this.nb.Tcd(l),b=this.nb.mg());return this.mXb(a,b,this.nb.Ip(),c)?32:16}Fkj(a,b,c,f,l){if(!l)return 1===c?8:16;b=this.Vp.presentation;if(!b)throw Error.argumentNull("Presentation is null");l=Array.isArray(l.shapeNodes)?l.shapeNodes:null;if(!l)return 1===c?8:16;if(1===c)return 32;Mc.a.Cb&&(Mc.a.Cb.actionName="DeleteShapes",Mc.a.Cb.Ij=!0);return l.length&&this.mXb(a,l,Object(va.a)(123,b.KB(l[0].slideId)))?32:16}mXb(a,b,c,f=null){if(!c||!b.length||this.Af.NB(b))return!1;let l=!1;for(var x of b)if(x.RCa){l=
!0;break}x=this.Db.rd(15,void 0,()=>{this.nb.Ph()});try{f?x.fd(f):x.fd(c);x.$c=a;x.my[Aq.a.$sb]=l;for(const F of b)if(F&&F.mh){const R=this.Ea.Pr(F);if(R){const fa=ae.c(R,this.Qb.Ma);fa&&(fa.zk.visible=!1)}}f?f.ych(b):c.HT(b)}finally{x&&x.dispose()}for(const F of b)this.Ur.e$g(new OJ.a(F));return!0}chg(a,b,c){b=this.nb.mg();const f=0<b.length?b[0]:null,l=1===b.length&&this.WKd(f);if(1===c)return l?32:8;if(!l||this.Af.Zc(f))return 16;this.YOa(f);for(const x of b)if(x.Mf||x.mh){Qn(x);break}return sg.a("Rotate",
a,()=>{let x,F;switch(a){case ba.a.Mdd:F=f.get_isVerticallyFlipped();x=!f.get_isHorizontallyFlipped();break;case ba.a.Ndd:F=!f.get_isVerticallyFlipped();x=f.get_isHorizontallyFlipped();break;default:return 8}const R=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{R.jc(f),R.$c=a,f.set_isVerticallyFlipped(F),f.set_isHorizontallyFlipped(x)}finally{R&&R.dispose()}return 32})}bhg(a,b,c){const f=this.nb.mg();b=!0;if(!f||f&&!f.length)b=!1;for(const F of f)if(b=this.WKd(F),!b)break;if(1===c)return b?
32:8;if(!b)return ya.a.J(537499273,815,10,"ShapeManipulationActor:: HandleFlipShape shape horizontal flip change with no rotateable shape selected"),16;for(const F of f){if(this.Af.Zc(F))return 16;this.YOa(F)}for(const F of f)if(F.Mf||F.mh){Qn(F);break}const l=a===ba.a.Mdd,x=a===ba.a.Ndd;return l||x?sg.a("Rotate",a,()=>{const F=Array(f.length),R=Array(f.length);for(var fa=0;fa<f.length;fa++)R[fa]=!!(x^f[fa].get_isVerticallyFlipped()),F[fa]=!!(l^f[fa].get_isHorizontallyFlipped());fa=this.Db.rd(15,
void 0,()=>{this.nb.hj();this.Fa.Ad()});try{fa.jc(f[0]);fa.$c=a;for(let wa=0;wa<f.length;wa++)f[wa].set_isVerticallyFlipped(R[wa]),f[wa].set_isHorizontallyFlipped(F[wa])}finally{fa&&fa.dispose()}return 32}):(ya.a.J(538589339,815,10,"ShapeManipulationActor:: HandleFlipShape Invalid request"),8)}mkj(){this.J2c.uZf();return 32}tOc(a,b,c){const f=ae.b(b);if(!f)return 16;b=this.nb.mg();if(!b.length)return 16;let l=!0;const x=[];for(const F of b)if(F.get_smartArtModelId()){x.push(this.Ea.er(F));break}else x.push(F);
for(const F of x)if(!this.cLf(F)){l=!1;break}if(1===c)return l?32:8;if(!l)return 16;c=ae.d(x,f.Ma);if(this.Af.NB(b))return 16;switch(a){case ba.a.ccc:a=Kd.a.south;break;case ba.a.dcc:a=Kd.a.west;break;case ba.a.ecc:a=Kd.a.east;break;case ba.a.fcc:a=Kd.a.north;break;default:return 8}this.J2c.move(c,a);this.Iz&&this.nb.GK()&&(a=this.nb.$Ba(),this.gf.Xdb(new Bx.a(a)));Mc.a.Cb&&(Mc.a.Cb.Ij=!0,Mc.a.Cb.BE=new Date);return 32}BOc(a,b,c){const f=ae.b(b);b=this.nb.mg();const l=[];for(var x of b){if(x.get_smartArtModelId()){this.nb.Tcd(x);
Array.add(l,this.Ea.er(x));break}!x.isResizable||x.fI||x.nd||Array.add(l,x)}x=ae.d(l,f.Ma);if(1===c)return 0<l.length?32:8;if(0>=b.length||this.Af.NB(l))return 16;switch(a){case ba.a.nic:a=Kd.a.south;break;case ba.a.oic:a=Kd.a.west;break;case ba.a.pic:a=Kd.a.east;break;case ba.a.qic:a=Kd.a.north;break;default:return 8}this.J2c.resize(x,a);this.Iz&&this.nb.GK()&&(a=this.nb.$Ba(),this.gf.Xdb(new Bx.a(a)));Mc.a.Cb&&(Mc.a.Cb.Ij=!0,Mc.a.Cb.BE=new Date);return 32}COc(a,b,c){var f=this.nb.mg();const l=0<
f.length?f[0]:null,x=1===f.length&&this.AUb(l);if(1===c)return x?32:8;if(!x||this.Af.Zc(l))return 16;b=ae.b(b);f=ae.d(f,b.Ma);c=a===ba.a.Pdd||a===ba.a.Eic;a=a===ba.a.Odd||a===ba.a.Eic;0<f.length&&f[0].shapeNode.Mf&&f[0].shapeNode.isEditable&&(b=f[0].shapeNode.Ag(b.Ma))&&b.nPc();this.J2c.rotate(f,c,a);Mc.a.Cb&&(Mc.a.Cb.Ij=!0,Mc.a.Cb.BE=new Date);return 32}L2d(a,b,c,f,l){return l&&Object(Fa.a)(9,l)?this.Af.Zc(l)?16:32:8}eMj(a){for(const b of a)if(!this.AUb(b)&&!this.WKd(b))return!1;return!0}cLf(a){return!!a&&
a.hI&&a.zA&&!a.fI}zUb(a){return!!a&&a.isResizable&&a.zA&&!a.fI}AUb(a){return!!a&&a.EK&&!a.fI}WKd(a){return!!a&&a.YFj&&!a.fI}Jk(a){return a?Object(va.a)(124,a.oc(this.Qb.Ma)):null}YOa(a){a&&a.yx&&(a=this.Jk(a))&&a.$_(!1)}H2d(a,b,c){return(a=this.Jk(a))&&Object(Fa.a)(Is.a,a.zk)&&(a=Object(va.a)(Is.a,a.zk))?a.F9c(ba.a.vz(b),c):!1}}Object(e.a)(dD,"ShapeManipulationActor",null,[]);var pv=d(409),Ii=d(67);class eD extends pv.DragSelectionDragAdapter{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){super(a,b,
c);this.ra=f;this.Fa=l;this.la=R;this.Ea=x;this.x$j=F;this.eC=fa;this.Mb=wa;this.Pp=Xa;this.$ca=lb;this.sc=Lb;this.jpc=this.kpc=null}get VBc(){return this.kpc}get UBc(){return this.jpc}su(a){for(var b=this.kRe(),c=a.Fc,f=c,l=this.eC.VH(f);!l&&f;){l=this.eC.VH(f);if(Sys.UI.DomElement.containsCssClass(f,"Outline")&&Sys.UI.DomElement.containsCssClass(f,"OutlineSized"))break;f=f.parentNode}l||ya.a.J(39175171,820,15,"The element doesn't have a owner and it's parent don't have owner className: "+c.className+
" tagName: "+c.tagName);if(!b||!l)return!1;b=b.node;l=l.$a;c=this.Mb.Kc(l);if(b===l||c.Ze()&&c.AZa()===b){l=super.su(a);if(!l)return l;this.Ea.L2(b)&&(c=this.sc.XM(Object(va.a)(4,b)))&&c.lp()&&(c=this.$ca.gVd(a.clientPoint,c,null,null))&&(f=c.oc(this.Df.Ma),this.Df.m5(a.clientPoint,f,c,this.Df,a.shiftKey));null!==this.Pp&&(a=this.Ea.nd(b),this.Pp.ewa(Ii.a.V4),a&&(this.kpc=this.$ca.OZd(b),this.jpc=this.$ca.kag(b)));return l}return!1}Nt(a){super.Nt(a);this.j_f();null!==this.Pp&&this.Pp.Mva();this.VBc&&
(this.kpc=null);this.UBc&&(this.jpc=null)}Ln(a){super.Ln(a);this.j_f();null!==this.Pp&&this.Pp.Mva();this.VBc&&(this.kpc=null);this.UBc&&(this.jpc=null)}JBb(a,b,c){({Er:b,graphNode:c}=super.JBb(a,b,c));if(this.la.wwg&&(a=this.kRe())){const f=this.u_i(c);f&&f===a||(c=a,b=c.oc(this.Df.Ma))}return{Er:b,graphNode:c}}Smc(a){let b=super.Smc(a);if(!b&&this.la.wwg){let c=this.kRe();if(c&&this.Ea.nd(c.node)){const f=this.ra.Po();this.$ca.kRc(a.clientPoint,f)&&(c=this.$ca.gVd(a.clientPoint,f,this.VBc,this.UBc))}c&&
(b=c.oc(this.Df.Ma))}return b}u_i(a){return a?this.Ea.kn(a):null}kRe(){const a=this.x$j.Wcg(this.Df.Ma);return!a||a.xG?null:this.ra.jq()}j_f(){(this.ra.uG()||this.ra.ku())&&this.Fa.Ad()}}Object(e.a)(eD,"PPTDragSelectionDragAdapter",pv.DragSelectionDragAdapter,[405,239]);class PJ{constructor(a,b,c){this.Le=a;this.l8=b;this.sc=c}kRc(a,b){if(!a||!b)return!1;b=b.oc(this.Le);return b?(b=kb.a.Yh(b.htmlElement))?!!a&&!!b&&a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height:!1:!1}gVd(a,b,c=null,f=null){return(a=
this.P2f(a,b,c,f))?a.oy():null}P2f(a,b,c=null,f=null){if(!a||!b)return null;c&&f||(f=this.kag(b),c=this.OZd(b));if(!(c&&f&&c.length&&f.length))return null;var l=b.oc(this.Le);if(!l)return null;var x=kb.a.Yh(l.htmlElement);if(!x)return null;l=a.x-x.x;x=a.y-x.y;var F=0;for(a=0;a<c.length&&!(F+=c[a],F>=x);a++);for(F=x=0;F<f.length&&!(x+=f[F],x>=l);F++);a=Math.min(a,c.length-1);F=Math.min(F,f.length-1);return 0>a||a>=c.length||0>F||F>=f.length?null:b.ef(a,F)}OZd(a){if(a){a=this.sc.lia(a);if(!a||!a.length)return null;
const c=a.length,f=Array(c);for(let l=0;l<c;l++){var b=a[l].oc(this.Le);if(!b)return null;b=kb.a.Yh(b.htmlElement);f[l]=b.height}return f}return null}kag(a){if(a){a=Nn.b(Object(va.a)(ag.a,a));if(!a||!a.length)return null;const b=a.length,c=Array(b);for(let f=0;f<b;f++)c[f]=this.l8.Ge(a[f],0);return c}return null}}Object(e.a)(PJ,"PptTableDragSelectionHelper",null,[369]);var Qr=d(635),vz=d(331);class QJ{constructor(a,b,c,f,l,x,F){this.ua=this.qm=null;if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!f)throw Error.argumentNull("pageView");if(!l)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!x)throw Error.argumentNull("insertShapeOverlayViewElement");if(!F)throw Error.argumentNull("graphTopologyManager");this.ia=a;this.Hc=b;this.Rj=c;this.Qb=f;this.Vxb=l;this.Oca=x;this.ta=F}Wu(a){try{return a?a.Sz===Sys.UI.MouseButton.rightButton?!1:2===this.Vxb.Fog?!0:!1:(ya.a.J(512336010,822,10,"Event argument is null in isDragPossible for shapes"),
!1)}catch(b){throw ya.a.J(512336009,822,10,"Exception {0} occured in isDragPossible for shapes",b),b;}}su(a){try{if(!a)return ya.a.J(512336008,822,10,"Event argument is null in OnDragStart for shapes"),!1;if(!this.Wu(a))return!1;this.Oca.Pk(Ii.a.AHb);this.qm=Qr.a(a.clientPoint,this.Hc.Jc);const b=new Pd.a;b.left=this.qm.x;b.top=this.qm.y;b.bottom=this.qm.y+5;b.right=this.qm.x+5;a={};a.offsets=b;a.insertShapeActionId=this.Oca.Ntb;a.insertLocalShape=!0;if(32!=this.ia.Ka(ba.a.BQc,2,a))return!1;this.ua=
a.node;return!0}catch(b){throw ya.a.J(512336007,822,10,"Exception {0} occured in OnDragStart for shapes",b),b;}}aw(a){try{if(!a)return ya.a.J(512336006,822,10,"Event argument is null in OnDragMove for shapes"),!1;if(!this.Qb.isActive)return!1;const b=Qr.a(a.clientPoint,this.Hc.Jc),c=Qr.b(this.Sjd(Math.min(this.qm.y,b.y)-this.qm.y),this.Sjd(Math.max(this.qm.y,b.y)-this.qm.y-5),this.Sjd(Math.min(this.qm.x,b.x)-this.qm.x),this.Sjd(Math.max(this.qm.x,b.x)-this.qm.x-5));Object(va.a)(vz.a,this.ua.oc(0)).setOffsets(c,
!0);return!0}catch(b){throw ya.a.J(512336005,822,10,"Exception {0} occured in OnDragMove for shapes",b),b;}}Ln(a){try{if(a)if(this.qm){var b=Qr.a(a.clientPoint,this.Hc.Jc),c=Qr.b(Math.min(this.qm.y,b.y),Math.max(this.qm.y,b.y),Math.min(this.qm.x,b.x),Math.max(this.qm.x,b.x));a={};a.offsets=c;a.insertShapeActionId=this.Oca.Ntb;a.insertLocalShape=!1;this.iVf();this.ia.Ka(ba.a.BQc,2,a);this.$J()}else ya.a.J(512336003,822,10,"m_dragBeginPosition should not be null in OnDragEnd for shapes");else ya.a.J(512336004,
822,10,"Event argument is null in OnDragEnd for shapes")}catch(f){throw ya.a.J(512336002,822,10,"Exception {0} occured in OnDragEnd for shapes",f),f;}}Nt(){this.$J()}dispose(){this.$J()}Sjd(a){return this.Rj.ML(a,this.Hc.Jc.BV)}$J(){this.qm=null;this.ua&&(this.iVf(),this.Vxb.Cwh(0),this.ua=null)}iVf(){this.ta.Ba.HT([this.ua])}}Object(e.a)(QJ,"ShapeDrawDragAdapter",null,[239,106]);class Cx{constructor(a,b){this.QEg=null;this.jxb=-1;this.gne=a;this.m0j=b}su(a){return this.QXg(a)?(this.gne.B9c(),!0):
!1}aw(a){if(!a)return!1;this.m0j?(this.QEg=a,this.WXk()):this.Rue(a);return!0}Ln(a){this.Kxh()&&this.$Xf(0);this.NXg(a);this.gne.uic()}Nt(){this.Kxh();this.LXg();this.gne.uic()}WXk(){-1===this.jxb&&(this.jxb=window.requestAnimationFrame(Object(D.a)(this,this.$Xf,"dragMoveTask")))}Kxh(){return-1!==this.jxb?(window.cancelAnimationFrame(this.jxb),this.jxb=-1,!0):!1}$Xf(){this.Rue(this.QEg);this.jxb=-1}}Object(e.a)(Cx,"ShapeDragAdapter",null,[239]);class RJ extends Cx{constructor(a,b,c,f,l,x,F,R,fa,wa,
Xa,lb,Lb,kc,lc,Ec,Jc,Dc){super(kc,Ec);this.C7b=0;this.z7b=this.Uo=this.GN=this.NEg=null;this.OEa=!1;this.Qb=a;this.ia=b;this.RZ=c;this.wq=f;this.hv=l;this.YB=x;this.nb=F;this.yD=R;this.eC=fa;this.Ea=wa;this.sc=Xa;this.gf=lb;this.Gac=Lb;this.Pp=lc;this.Iz=Jc;this.vp=Dc}Wu(a){return this.gI(a).returnValue}gI(a){let b;var c=[];b=!1;if(!a||a.Sz!==Sys.UI.MouseButton.leftButton||this.YB.AZ)return{returnValue:!1,$bc:c,n5b:b};const f=Object(va.a)(254,this.eC.VH(a.Fc));if(!f||!f.n8d(a.Fc))return{returnValue:!1,
$bc:c,n5b:b};if((b=f.isSelected)||f.shapeNode.mh){c=[];a=Object(va.a)(124,this.eC.VH(a.Fc));a.shapeNode.Mf&&this.nb.uVf(a.shapeNode);a=this.nb.mg();for(const l of a)if(l.get_smartArtModelId()){c.push(this.Ea.er(l));break}else c.push(l);c=ae.d(c,this.Qb.Ma);for(const l of c)if(!this.Csg(l))return{returnValue:!1,$bc:c,n5b:b}}else{if(!this.Csg(f))return{returnValue:!1,$bc:c,n5b:b};Array.add(c,f)}return{returnValue:!0,$bc:c,n5b:b}}Csg(a){return a&&a.$a&&a.$a.hI&&a.$a.zA&&!a.shapeNode.fI&&32===this.ia.Ka(ba.a.jBe,
1,a.$a)?!0:!1}QXg(a){var b;let c;if(!({$bc:b,n5b:c}=this.gI(a)).returnValue)return!1;this.ia.processAction(ba.a.T3a,2);this.NEg=ad.a.APa(a.clientPoint);this.z7b=Object(va.a)(254,this.eC.VH(a.Fc));null!==this.RZ&&this.RZ.Pk(3);if(!this.z7b||!b||!b.length)return!1;null!==this.Pp&&this.Pp.ewa(Ii.a.Hwa);this.z7b.shapeNode.yx||(this.nb.hj(),this.yD.Ad());for(a=0;a<b.length;++a)this.gzc(b[a]);c||(this.nb.setSelection(nd.SelectionFactory.Xk(this.Uo[0].$a)),this.hv.Pv());for(b=0;b<this.Uo.length;++b)this.Uo[b].eD(!0);
this.OEa=1<this.Uo.length?!1:!0;this.C7b=Date.now();this.Iz&&this.nb.GK()&&this.gf.cCe();this.vp&&this.ia.processAction(C.a.Tha,2);return!0}gzc(a){this.Uo||(this.Uo=[]);this.GN||(this.GN=[]);Array.add(this.Uo,a);Array.add(this.GN,new ad.a(a.x,a.y))}Rue(a){if(a){var b=this.pMc(ad.a.APa(a.clientPoint),this.NEg);a=null;var c=this.OEa&&!this.z7b.shapeNode.yx;for(let f=0;f<this.Uo.length;++f)a=ad.a.add(this.GN[f],b),this.Uo[f].setPosition(a.x,a.y,!c);b=this.Gac.K_g(!1,this.OEa,this.Uo[0],null);c&&!b&&
a&&this.Uo[0].setPosition(a.x,a.y,!0)}}pMc(a,b){a=ad.a.bU(a,b);return new ad.a(this.wq.qn(a.x),this.wq.qn(a.y))}NXg(a){const b=[];for(var c=0;c<this.Uo.length;++c){var f=this.Uo[c].MKc();Array.add(b,new ov(this.Uo[c].shapeNode,f));this.Uo[c].rz(!1);if(f=this.sc.XM(this.Uo[c].shapeNode))f=f.lp(),ya.a.J(512497684,815,50,"Drag to move table, isComplexTable:{0}",f)}this.z7b.shapeNode.yx||(c={},a&&a.lc&&a.lc.rawEvent&&(c[ri.a.dBa]=a.lc.rawEvent.timeStamp),this.ia.Ka(ba.a.lGa,2,b,c));1===b.length&&(ya.a.J(512497683,
815,50,"ShapeMoveDragAdapter - moving shape {0} - timespan by {1}",this.Uo[0].shapeNode?this.Uo[0].shapeNode.jr:"",(Date.now()-this.C7b).toString()),this.Iz&&this.nb.GK()&&(a=this.nb.$Ba(),this.gf.Xdb(new Bx.a(a))));this.U1()}LXg(){if(this.Uo){for(let a=0;a<this.Uo.length;++a)this.Uo[a].setPosition(this.GN[a].x,this.GN[a].y,!0),this.Uo[a].rz(!0);this.U1()}}U1(){this.Gac.O_g(this.OEa);null!==this.RZ&&this.RZ.U_();this.Qb.TQ();this.GN=this.Uo=null;null!==this.Pp&&this.Pp.Mva()}}Object(e.a)(RJ,"ShapeMoveDragAdapter",
Cx,[]);class fD{constructor(a){this.HXc=this.b_=this.z_=this.$9b=this.m_=null;this.Pd=a}E3k(a,b,c,f,l){this.m_=a;this.$9b=b;this.z_=c;this.b_=f;this.HXc=l}}Object(e.a)(fD,"ResizeShapesCalculationData",null,[]);var gD=d(612);class Zk{static FKd(a,b,c,f,l){return f?Zk.xKf(a,c):Zk.Fhi(a,b,c,l)}static xKf(a,b){const c=new Pd.a;if(a.equals(Kd.a.qu)||a.Pub(Kd.a.qu))c.left=b.x,c.top=b.y;else if(a.equals(Kd.a.cE)||a.Pub(Kd.a.cE))c.right=b.x,c.bottom=b.y;return c}static Fhi(a,b,c,f){b=a.n3b()?Zk.vhi(a,b,c,
f):Zk.Hhi(a,b,c);c=new Pd.a;if(a.Pub(Kd.a.north)||a.equals(Kd.a.north))c.top=-1*b.y;if(a.Pub(Kd.a.east)||a.equals(Kd.a.east))c.right=b.x;if(a.Pub(Kd.a.south)||a.equals(Kd.a.south))c.bottom=b.y;if(a.Pub(Kd.a.west)||a.equals(Kd.a.west))c.left=-1*b.x;return c}static vhi(a,b,c,f){var l=b.Zj(a),x=b.Zj(a.w5a()),F=b.Zj(a.$Si());a=b.Zj(a.aTi());var R=new ad.a(l._x+c.x,l._y+c.y);const fa=gD.b(x,F,R);b=gD.b(x,a,R);c=Zk.OLd(x,F,fa);l=Zk.OLd(x,a,b);b=ad.a.Rl(b,R);R=ad.a.Rl(fa,R);F=ad.a.Rl(x,F);x=ad.a.Rl(x,a);
f?(x||(ya.a.J(8959632,822,10,"ResizeHelper - shape has height 0"),x=1),F||(ya.a.J(8959634,822,10,"ResizeHelper - shape has width 0"),F=1),f=F/x,!R||b/R>f?(b<Zk.C1&&(b=Zk.C1),R=b/f,R<Zk.C1&&(R=Zk.C1,b=R*f)):(R<Zk.C1&&(R=Zk.C1),b=R*f,b<Zk.C1&&(b=Zk.C1,R=b/f))):(b<Zk.C1&&(b=Zk.C1),R<Zk.C1&&(R=Zk.C1));return new ad.a(b*c-F,R*l-x)}static Hhi(a,b,c){var f=a.rMc();a=a.ksb();f=b.Zj(f);var l=b.Zj(a);b=b.Zj(a.w5a());a=ad.a.v6a(f,l);a.qL(c.x,c.y);c=gD.b(b,f,a);a=ad.a.Rl(b,c);l=ad.a.Rl(f,b);a<Zk.C1&&(a=Zk.C1);
f=a*Zk.OLd(b,f,c)-l;return new ad.a(f,f)}static OLd(a,b,c){return b._x!==a._x?0>(c._x-a._x)/(b._x-a._x)?-1:1:0>(c._y-a._y)/(b._y-a._y)?-1:1}}Zk.C1=6;Object(e.a)(Zk,"ResizeHelper",null,[]);class Js extends Cx{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec){super(Xa,kc);this.vja=this.j_=this.VEa=this.Ide=this.Jde=this.Pd=this.pF=null;this.OEa=!1;this.sQ=this.kQ=null;this.Qb=a;this.ia=b;this.YB=c;this.PUa=f;this.yD=l;this.eC=x;this.Rj=F;this.gf=R;this.Ea=fa;this.Gac=wa;this.Iz=lc;this.Pp=lb;this.ve=
Lb;this.vp=Ec}Wu(a){if(!a||a.Sz===Sys.UI.MouseButton.rightButton)return!1;this.sQ=[];this.Pd=Object(va.a)(124,this.eC.VH(a.Fc));if(!this.Pd||!this.Pd.XE(a.Fc))return!1;a=this.Pd.shapeNode;if(!a||!a.isResizable||this.YB.AZ)return!1;this.pF=[];if(a.uy)Array.add(this.pF,this.Pd);else{var b=this.PUa.ae();(b=this.Ea.h6a(b))&&this.PUa.Tcd(b);a.Mf&&this.PUa.uVf(a);b=this.PUa.mg();this.pF=ae.d(b,this.Qb.Ma)}if(this.Ea.L2(this.Pd.shapeNode))Array.add(this.sQ,new fD(this.Pd));else for(const c of this.pF){if(!this.WMj(c))return this.sQ=
null,!1;c.shapeNode.isResizable&&!c.shapeNode.nd&&Array.add(this.sQ,new fD(c))}return!0}WMj(a){return 32!==this.ia.Ka(ba.a.jBe,1,a.$a)||this.YB.AZ||!a.KP?!1:!0}QXg(a){if(!a||!this.Wu(a))return!1;this.PUa.hj();this.yD.Ad();this.ia.processAction(ba.a.T3a,2);this.vja=this.Pd.$Zb();if(!this.Pd.XE(a.Fc))return!1;null!==this.Pp&&this.Pp.ewa(Ii.a.AHb);this.kQ=this.fcg(this.Pd.XE(a.Fc),this.Pd,this.vja,!1);this.VEa=this.$pa(a.clientPoint);({width:this.Jde,height:this.Ide}=this.HKf(this.vja,this.Pd.shapeNode.CZ));
this.j_=new ad.a(0,0);for(const c of this.sQ){var b=c.Pd.$Zb();a=c.Pd;let f,l;({width:f,height:l}=this.HKf(b,this.Pd.shapeNode.CZ));const x=this.fcg(this.kQ,a,b,!0);c.E3k(b,a.UVa,f,l,x);a.DK=!0;a.eD(!0);b=ae.c(a.shapeNode,this.Qb.Ma);a.shapeNode.Mf&&b.zk&&(b.zk.visible=!0)}this.OEa=this.Ea.L2(this.Pd.shapeNode)?!0:1<this.pF.length?!1:!0;this.Iz&&this.PUa.GK()&&this.gf.cCe();this.vp&&this.ia.processAction(C.a.Tha,2);return!0}Rue(a){if(a){var b=this.$pa(a.clientPoint),c=ad.a.bU(b,this.VEa);this.j_=
ad.a.add(this.j_,this.gcg(c,this.vja,!1));var f=null;c=this.OEa&&!this.Pd.shapeNode.yx;for(const l of this.sQ){let x=new ad.a(l.z_/this.Jde*this.j_.x,l.b_/this.Ide*this.j_.y);new Pd.a;if(l.Pd.shapeNode.uy){this.Pd.shapeNode.uy&&(x=this.j_);if(!l.HXc)continue;f=Zk.xKf(l.HXc,x)}else f=Zk.FKd(l.HXc,l.m_,this.gcg(x,l.m_,!0),l.Pd.shapeNode.uy,l.Pd.shapeNode.isAspectRatioLocked||a.shiftKey);f=Pd.a.add(l.$9b,this.W3f(f,l.m_));l.Pd.setOffsets(f,!c);l.Pd.shapeNode.Mf&&l.Pd.shapeNode.isEditable&&l.Pd.U3d()}this.VEa=
b;a=this.Gac.K_g(!0,this.OEa,this.Pd,this.kQ);c&&!a&&f&&this.Pd.setOffsets(f,!0)}}W3f(a,b){if(this.Ea.L2(this.Pd.shapeNode))return a;const c=new Pd.a;c.left=b.YRc?a.right:a.left;c.right=b.YRc?a.left:a.right;c.top=b.h8a?a.bottom:a.top;c.bottom=b.h8a?a.top:a.bottom;return c}NXg(a){const b=[];for(var c=0;c<this.sQ.length;c++){let f=Pd.a.bU(this.sQ[c].Pd.UVa,this.sQ[c].$9b);f=this.W3f(f,this.sQ[c].m_);Array.add(b,new uz(this.sQ[c].Pd.shapeNode,f,this.kQ,this.j_));this.sQ[c].Pd.shapeNode.Mf&&this.sQ[c].Pd.shapeNode.isEditable||
(this.sQ[c].Pd.DK=!1);this.sQ[c].Pd.rz(!1)}this.Pd.shapeNode.yx?Gb.App.Fb.updateCommandUI():(c={},a&&a.lc&&a.lc.rawEvent&&(c[ri.a.dBa]=a.lc.rawEvent.timeStamp),this.Ea.L2(this.Pd.shapeNode)?(this.Pd.ZOa(),this.ia.Ka(ba.a.Gfh,2,b,c)):this.ia.Ka(ba.a.Deb,2,b,c));this.Iz&&this.PUa.GK()&&(a=this.PUa.$Ba(),this.gf.Xdb(new Bx.a(a)));this.$J()}LXg(){if(this.sQ){for(const a of this.sQ)a.Pd.setOffsets(a.$9b,!0),a.Pd.DK=!1,a.Pd.rz(!0);this.$J()}}$J(){this.Gac.O_g(this.OEa);this.vja=this.Ide=this.Jde=this.Pd=
this.pF=this.sQ=this.kQ=this.j_=this.VEa=null;null!==this.Pp&&this.Pp.Mva()}HKf(a,b){let c;var f=b?this.qXd(a):a;c=ad.a.Rl(f.ga(0),f.ga(1));f=ad.a.Rl(f.ga(0),f.ga(3));b||(a=je.a.cO(ad.a.bG(a.ga(0),a.ga(1))),Math.floor((a+45)/90)%2&&(a=f,f=c,c=a),c||(ya.a.J(17622149,822,10,"ShapeResizeDragAdapter - shape {0} has width 0",this.Pd.shapeNode.jr),c=1),f||(ya.a.J(17622151,822,10,"ShapeResizeDragAdapter - shape {0} has height 0",this.Pd.shapeNode.jr),f=1));return{width:c,height:f}}fcg(a,b,c,f){if(b.shapeNode.uy){if(this.Pd.shapeNode.uy)return a;
if(a.equals(Kd.a.ND)||a.equals(Kd.a.fH))return null;if(a.equals(Kd.a.qu)||a.equals(Kd.a.cE))return c.ga(0).x>c.ga(1).x?a.w5a():a;if(b.shapeNode.CZ){f=je.a.cO(ad.a.bG(c.ga(0),c.ga(1)));if(a.equals(Kd.a.north)||a.equals(Kd.a.south))return Math.abs(f-90)<Js.I9b||Math.abs(f-270)<Js.I9b?c.ga(0).y<c.ga(1).y?a:a.w5a():null;if(a.equals(Kd.a.east)||a.equals(Kd.a.west))if(Math.abs(f-180)<Js.I9b||360-f<Js.I9b||f<Js.I9b)return c.ga(0).x<c.ga(1).x?a:a.w5a()}return null}c=ad.a.bG(c.ga(0),c.ga(1));c=Math.floor((c+
Math.PI/4)/(Math.PI/2));for(b=0;b<c;b++)a=f?a.rMc().rMc():a.ksb().ksb();return a}gcg(a,b,c){if(this.Pd.shapeNode.uy||this.Ea.L2(this.Pd.shapeNode))return a;var f=ad.a.bG(b.ga(0),b.ga(1));const l=Math.floor((f+Math.PI/4)/(Math.PI/2))%4;f=b.ga(3-l);b=b.ga(3>l?2-l:3);f=ad.a.bG(f,b);return c?new ad.a(Math.cos(f)*a.x-Math.sin(f)*a.y,Math.sin(f)*a.x+Math.cos(f)*a.y):new ad.a(Math.cos(f)*a.x+Math.sin(f)*a.y,Math.cos(f)*a.y-Math.sin(f)*a.x)}$pa(a){var b=this.Pd.F1(this.Rj.qn(a.x)),c=this.Pd.F1(this.Rj.qn(a.y));
if(this.Ea.L2(this.Pd.shapeNode)){c=this.kQ;this.kQ.n3b()||(c=c.ksb());b=this.ve.Yh(this.Pd.iNa);b.x+=qf.a.ngd;b.y+=qf.a.ngd;b.width-=2*qf.a.ngd;b.height-=2*qf.a.ngd;var f=td.a.tba(b);b=f.Zj(c);f=f.Zj(c.w5a());c=b.y<=f.y?Math.min(a.y,f.y):Math.max(a.y,f.y);b=this.Pd.F1(this.Rj.qn(b.x<=f.x?Math.min(a.x,f.x):Math.max(a.x,f.x)));c=this.Pd.F1(this.Rj.qn(c))}return new ad.a(b,c)}qXd(a){const b=ad.a.v6a(a.ga(0),a.ga(3));a=ad.a.v6a(a.ga(1),a.ga(2));return new td.a(new ad.a(b.x,b.y),new ad.a(a.x,b.y),new ad.a(a.x,
a.y),new ad.a(b.x,a.y))}}Js.I9b=3;Object(e.a)(Js,"ShapeResizeDragAdapter",Cx,[]);var SJ=d(187);class wz{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.zle=this.Ume=null;this.Z9b=0;this.Eoe=this.oac=null;this.BXc=0;this.nLg=8;this.dNg=4;this.aZj="AngleUIRendered";this.MG=this.Pd=null;this.Qb=a;this.ia=b;this.YB=f;this.RZ=c;this.ra=l;this.yD=x;this.eC=F;this.Rj=R;this.rc=fa;this.fe=wa;this.Pp=Xa;this.vp=lb;this.AEa=Lb}Wu(a){if(!a||a.Sz!==Sys.UI.MouseButton.leftButton||this.YB.AZ)return!1;this.Pd=
Object(va.a)(124,this.eC.VH(a.Fc));return this.Pd&&this.Pd.r$d(a.Fc)?(this.MG=this.Pd.shapeNode)&&this.MG.EK&&this.Pd.KP?!0:!1:!1}su(a){if(!a||!this.Wu(a))return!1;this.ra.hj();this.yD.Ad();this.ia.processAction(ba.a.T3a,2);null!==this.Pp&&this.Pp.ewa(Xe.a.nP(this.fe.Yj("rotatehandlecursor.cur"),Ii.a.qth));this.Z9b=this.MG.get_shapeRotation();this.oac=this.Pd.$Zb().Uf();this.Eoe=this.Pd.Arb().Uf();this.Ume=this.$pa(a.clientPoint);this.Pd.$ia=!0;this.AEa&&this.RIe(!0);this.Pd.eD(!0);this.vp&&this.ia.processAction(C.a.Tha,
2);return!0}aw(a){if(!a)return!1;this.zle=this.$pa(a.clientPoint);if(!this.zle)return!1;this.BXc=je.a.cO(ad.a.bG(this.zle,this.oac))-je.a.cO(ad.a.bG(this.Ume,this.oac));let b=this.Z9b+this.BXc;this.AEa&&(b=this.Mrh(b));this.Pd.setRotation(Math.round(b),this.Eoe);this.AEa&&(a=this.$pa(a.clientPoint,!1),this.Vvl(a,Math.round(b)));return!0}Mrh(a){return this.vbi(a)?10*Math.round(a/10):a}vbi(a){0>a&&(a=(a+360)%360);return(a+this.dNg/2)%90<=this.dNg?!0:!1}Vvl(a,b){var c=this.rc.Sg(this.Pd.$a);c=ae.e(c,
this.Qb.Ma);c.Gic.uC(2);c.Gic.setPosition(a.x+this.nLg,a.y+this.nLg);c.Gic.ya.style.position="absolute";0>b&&(b+=360);c.Gic.ya.innerText=(b%360).toString()+"\u00b0"}RIe(a){const b=this.rc.Sg(this.Pd.$a);ae.e(b,this.Qb.Ma).Gic.Qd(a)}Ln(a){this.AEa&&this.RIe(!1);this.Pd.$ia=!1;this.Pd.rz(!1);var b=this.Z9b+this.BXc;this.AEa&&(b=this.Mrh(b));b=new wp(this.MG,Math.round(b));const c={};a&&a.lc&&a.lc.rawEvent&&(c[ri.a.dBa]=a.lc.rawEvent.timeStamp);this.AEa&&(c[this.aZj]=1);this.ia.Ka(ba.a.Dic,2,b,c);this.U1()}Nt(){this.oac&&
(this.Pd.setRotation(this.Z9b,this.Eoe),this.AEa&&this.RIe(!1),this.Pd.$ia=!1,this.Pd.rz(!0),this.U1())}$pa(a,b=!0){var c=this.rc.Sg(this.Pd.$a);return(c=ae.e(c,this.Qb.Ma).rC)?(a=ad.a.APa(SJ.a.QPa(a,c)),b?new ad.a(this.Pd.F1(this.Rj.qn(a.x)),this.Pd.F1(this.Rj.qn(a.y))):a):null}U1(){null!==this.RZ&&this.RZ.U_();null!==this.Pp&&this.Pp.Mva();this.Qb.TQ();this.Ume=null;this.Z9b=0;this.oac=null;this.BXc=0;this.Pd=this.MG=null}static getInstance(a){return wz.GB(a)}static GB(a){return new wz(a,hb.a.instance.resolve("Common.IActionManagerExtended"),
hb.a.instance.resolve("Common.ICursorPinningTool"),hb.a.instance.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),hb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),hb.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),hb.a.instance.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),hb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),hb.a.instance.resolve("PowerPointWebEditor.ISlideReader"),hb.a.instance.resolve("PowerPoint.IPathManager"),
hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?hb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").dze)}}Object(e.a)(wz,"ShapeRotateDragAdapter",null,[239]);var hD=d(321);class TJ{constructor(a,b,c,f,l){this.qm=this.qr=null;if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("pageView");if(!f)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!l)throw Error.argumentNull("insertShapeOverlayViewElement");this.ia=a;this.Hc=b;this.Qb=c;this.Vxb=f}KLi(){if(this.qr)return this.qr;this.qr=new xn.a;this.qr.ot("MarqueeDiv");this.qr.Qk(0);this.qr.ya.style.borderStyle="solid";this.qr.ya.style.borderWidth="thin";this.qr.ya.style.borderColor="black";this.qr.ya.style.opacity="0.5";
this.qr.Qd(!1);return this.qr}$yh(a,b){this.qr&&this.qr.yh(a,b)}Zyh(a,b){this.qr&&this.qr.setPosition(a,b)}$J(){this.qm=null;this.qr&&(this.qr.Qd(!1),this.qr.iq())}KId(a){const b=this.Hc.Jc;if(!b||!b.oe||!b.oe.ya)return ya.a.J(512497682,822,10,"Unable to attach marquee element to the slide view element"),!1;b.oe.ya.appendChild(a.ya);a.uC(2+hD.a.z$);a.Qd(!0);return!0}Wu(a){try{return a?a.Sz===Sys.UI.MouseButton.rightButton?!1:1===this.Vxb.Fog?!0:!1:(ya.a.J(512497681,822,10,"Event argument is null in isDragPossible"),
!1)}catch(b){throw ya.a.J(512497680,822,10,"Exception {0} occured in isDragPossible",b),b;}}su(a){try{if(!a)return ya.a.J(512497679,822,10,"Event argument is null in OnDragStart"),!1;if(!this.Wu(a))return!1;this.qm=Qr.a(a.clientPoint,this.Hc.Jc);const b=this.KLi();if(!this.KId(b))return!1;this.Zyh(this.qm.x,this.qm.y);this.$yh(0,0);return!0}catch(b){throw ya.a.J(512497678,822,10,"Exception {0} occured in OnDragStart",b),b;}}aw(a){try{if(!a)return ya.a.J(512497677,822,10,"Event argument is null in OnDragMove"),
!1;if(!this.Qb.isActive)return!1;const b=Qr.a(a.clientPoint,this.Hc.Jc),c=Math.min(this.qm.x,b.x),f=Math.min(this.qm.y,b.y),l=Math.max(this.qm.x,b.x),x=Math.max(this.qm.y,b.y);this.Zyh(c,f);this.$yh(l-c,x-f);return!0}catch(b){throw ya.a.J(512497676,822,10,"Exception {0} occured in OnDragMove",b),b;}}Ln(a){try{if(a)if(this.qm){var b=Qr.a(a.clientPoint,this.Hc.Jc),c=Qr.b(Math.min(this.qm.y,b.y),Math.max(this.qm.y,b.y),Math.min(this.qm.x,b.x),Math.max(this.qm.x,b.x));this.ia.Ka(ba.a.N2b,2,c);ee.a("TelemetryForClickAndDragOperation")&&
ya.a.J(512497673,822,50,"TextboxDrawDragAdapter::OnDragEnd");this.$J()}else ya.a.J(512497674,822,10,"m_dragBeginPosition should not be null in OnDragEnd");else ya.a.J(512497675,822,10,"Event argument is null in OnDragEnd")}catch(f){throw ya.a.J(512497672,822,10,"Exception {0} occured in OnDragEnd",f),f;}}Nt(){this.$J()}dispose(){this.$J();this.qr=null}}Object(e.a)(TJ,"TextboxDrawDragAdapter",null,[239,106]);class Ks{constructor(a,b,c){this.T0c=0;this.GN=null;this.g6b=!1;this.Nme=this.PXc=null;this.Zyb=
new ad.a(0,0);this.Ika=1;this.Yi=a;this.Hc=b;this.f0j=c;this.f0j.GY(Object(D.a)(this,this.jWa,"onSlideNavigation"))}sob(a){return a?!0:!1}jWa(){this.Ika=1;this.Zyb=new ad.a(0,0);this.setTransform(new ad.a(0,0))}Nub(a){if(!a)return!1;a=this.afg(a.lc);return!!a&&1<a.length}vwe(a){if(!a)return!1;this.T0c=this.Yi.MT;if(!this.Nub(a))return!1;this.GN=this.JMc(a.lc);return!1}Kdc(a){if(!a)return!1;this.Nub(a)?(a=this.JMc(a.lc),this.GN||(this.GN=a),this.Smd(this.Uhi(this.GN,a))):this.lpk(a);return!0}lpk(a){a&&
(a=this.JMc(a.lc),this.g6b?(a=this.qKf(this.PXc,a),this.setTransform(a)):(this.g6b=!0,this.PXc=a))}Ln(a){if(this.g6b&&a){a=this.JMc(a.lc);var b=this.qKf(this.PXc,a);a=b.x+this.Zyb.x;b=b.y+this.Zyb.y;this.g6b=!1;this.Zyb=new ad.a(a,b)}}qKf(a,b){return!a||1>a.length||!b||1>b.length?new ad.a(0,0):new ad.a(b[0].x-a[0].x,b[0].y-a[0].y)}setTransform(a){if(this.Hc&&this.Hc.Jc&&this.Hc.Jc.yT){var b=this.Hc.Jc.yT;this.Nme||(this.Nme=b.style.cssText);b.style.cssText=this.Nme+"  width:100%;height:100%; transform:translate("+
(a.x+this.Zyb.x+"px,"+(a.y+this.Zyb.y)+"px) scale("+this.Ika+","+this.Ika+")")}}J4k(){this.setTransform(new ad.a(0,0))}wCb(a){if(!a)return!1;this.Ln(a);this.hnl();return!1}Smd(a){this.T0c&&(a*=this.T0c,a<Ks.TSg?a=Ks.TSg:a>Ks.pSg&&(a=Ks.pSg),this.Yi.Qia=!1,this.Ika=this.Yi.MT=a,this.J4k())}pKf(a){if(!a||1>=a.length)return-1;const b=a.length;return Math.sqrt(Math.pow(a[0].x-a[b-1].x,2)+Math.pow(a[0].y-a[b-1].y,2))}Uhi(a,b){a=this.pKf(a);b=this.pKf(b);return-1!==a&&-1!==b&&a?b/a:0}afg(a){let b=null;
if(!a)return null;a=a.rawEvent?a.rawEvent:a;a.touches&&(b=a.touches,!b.length&&a.changedTouches&&(b=a.changedTouches));return b}JMc(a){let b=null;a=this.afg(a);if(!a)return b;b=[];for(const c of a)Array.add(b,new ad.a(c.screenX,c.screenY));return b}hnl(){this.T0c=0;this.GN=null;this.g6b=!1;this.PXc=null}}Ks.TSg=1;Ks.pSg=5;Object(e.a)(Ks,"ZoomSettingTouchAdapter",null,[403]);var eQ=d(410);class UJ{constructor(a,b,c,f,l,x){this.dme=!1;this.qm=null;this.ale=!1;this.Qb=a;this.a4=b;this.nb=c;this.Hc=f;
this.Fa=l;this.ta=x;this.qr=new xn.a;this.qr.ot("Marquee");this.qr.Qk(0);this.qr.ya.style.backgroundColor="darkgrey";this.qr.ya.style.opacity="0.5";this.qr.Qd(!1)}KId(){this.qr&&(this.Hc.Jc.oe.ya.appendChild(this.qr.ya),this.dme=!0)}$J(){this.qm=null;this.qr&&(this.qr.Qd(!1),this.qr.iq(),this.dme=!1);this.ale=!1}Wu(a){if(!a||a.Sz===Sys.UI.MouseButton.rightButton)return!1;a=new eQ.a(a,this.Qb);return this.Qb.M4b(a)}su(a){if(!a||!this.Qb.isActive||!this.Wu(a))return!1;this.a4.k$g(new dm(!0));a.ctrlKey||
a.shiftKey?ya.a.J(8959586,816,50,"MarqueeSelectDragAdapter used: Ctrl {0}, Shift {1}",a.ctrlKey,a.shiftKey):this.nb.Ph();this.Fa.Ad();this.ale=a.shiftKey?!0:!1;this.qm=this.$pa(a.clientPoint);this.dme||this.KId();this.qr.setPosition(this.qm.x,this.qm.y);this.qr.yh(0,0);this.qr.uC(1+hD.a.z$);this.qr.Qd(!0);return!0}aw(a){if(!a||!this.Qb.isActive)return!1;var b=this.$pa(a.clientPoint);a=Math.min(this.qm.x,b.x);const c=Math.min(this.qm.y,b.y),f=Math.max(this.qm.x,b.x);b=Math.max(this.qm.y,b.y);this.qr.setPosition(a,
c);this.qr.yh(f-a,b-c);return!0}Ln(a){if(a){var b=this.$pa(a.clientPoint);a=Math.min(this.qm.x,b.x);var c=Math.min(this.qm.y,b.y),f=Math.max(this.qm.x,b.x);b=Math.max(this.qm.y,b.y);var l=this.ta.Ba,x=l?l.om():[];l=[];var F=[],R=this.nb.ae();for(const fa of x)(x=Object(va.a)(124,fa.oc(this.Qb.Ma)))&&x.KP&&(x.Kp?x.lhd():(x=x.T1d(!1),x.Zb>=a&&x.fc>=c&&x.Vb<=f&&x.Ub<=b&&(this.ale?Array.contains(R,fa)?F.push(fa):l.push(fa):Array.contains(R,fa)||l.push(fa))));0<l.length&&this.nb.DXa(l,!1);0<F.length&&
this.nb.qXb(F);this.$J()}}Nt(){this.qm&&this.$J()}$pa(a){const b=this.Hc.Jc.rC;return b?ad.a.APa(SJ.a.QPa(a,b)):ad.a.APa(a)}dispose(){this.qm&&this.$J();this.qr=null}}Object(e.a)(UJ,"MarqueeSelectDragAdapter",null,[239,106]);class VJ{constructor(a){this.pW=null;this.Cdi(a);this.p3d=!1}Cdi(a){null!==a&&(this.pW=Xe.a.Ee(),this.pW.style.position=Ii.a.absolute,this.pW.style.top="0px",this.pW.style.left="0px",a.appendChild(this.pW))}ewa(a){null!==a&&null!==this.pW&&null!==this.pW.parentNode&&(this.pW.style.cursor=
a,this.pW.style.zIndex=String(Ii.a.LBl),this.pW.style.height="100%",this.pW.style.width="100%",this.p3d=!0)}Mva(){if(null!==this.pW||this.p3d)this.pW.style.height="0px",this.pW.style.width="0px",this.pW.style.cursor=Ii.a.qth,this.pW.style.zIndex="-1",this.p3d=!1}}Object(e.a)(VJ,"CursorContainerManager",null,[368]);class iD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeManipulation"}Wb(a){this.K=a;a.register(368,"PowerPointWebEditor.ShapeManipulation.ICursorContainerManager").ma().na(()=>
new VJ(a.resolve("PowerPointWebEditor.AppFrame").F0));a.register(dD,"PowerPointWebEditor.ShapeManipulationActor").ma().na(()=>new dD(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),new xp(a.resolve("Common.IActionManagerExtended")),a.resolve("Common.Transaction.ITransactionFactory"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").DFe,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),
a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Common.Utils.IHighContrastDetector"),a.resolve("Gc2.IGlyphStore")));a.register(eD,"PowerPointWebEditor.ShapeManipulation.PPTDragSelectionDragAdapter").as("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter").ma().na(()=>new eD(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IActivityManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeReader"),pa.InteractiveViewManager.instance,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader")));a.register(369,"PowerPointWebEditor.IPptTableDragSelectionHelper").ma().na(()=>new PJ(a.resolve("Box4.IPageView").Ma,a.resolve("Box4.IPageView").Cd,a.resolve("PowerPointWebEditor.Graph.ITableReader")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTextEditOnlyMode||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled||
this.Gvj();this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled&&this.ywj();this.uvj()}ywj(){const a=this.K.resolve("PowerPointWebEditor.IZoomContext");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").JKk(new Ks(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}Gvj(){var a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const b=this.K.resolve("Common.IActionManagerExtended");
var c=this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext");const f=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),l=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?null:this.K.resolve("Common.CursorManager"),x=this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),F=this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),R=this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),fa=this.K.resolve("PowerPointWebEditor.ISlideReader"),
wa=this.K.resolve("PowerPointWebEditor.IShapeReader"),Xa=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),lb=this.K.resolve("PowerPointWebEditor.ISmartGuideManager"),Lb=this.K.resolve("PowerPointWebEditor.Core.IPauseTheWorldManager"),kc=this.K.resolve("PowerPoint.IPathManager"),lc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Ec=!!window.requestAnimationFrame&&
!!window.cancelAnimationFrame;this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").oEb(2,this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").oEb(1,new RJ(a,b,l,R,this.K.resolve("Box4.IUndoManager"),c,f,x,F,wa,this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),Xa,lb,Lb,lc,Ec,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),
new Js(a,b,c,f,x,F,R,Xa,wa,lb,Lb,lc,this.K.resolve("PowerPoint.IBrowserHelperManager"),Ec,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),new wz(a,b,l,c,f,x,F,R,fa,kc,lc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").dze),new UJ(a,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
f,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));this.K.resolve("PowerPointWebEditor.IApplicationSettings").s6d&&(c=new QJ(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").bbh(c));this.K.resolve("PowerPointWebEditor.IApplicationSettings").Qtb&&(a=new TJ(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").bbh(a));ya.a.J(22126852,
813,50,"Shape manipulation drag adapter init complete")}uvj(){const a=this.K.resolve("PowerPointWebEditor.ShapeManipulationActor");a.we();a.ub()}dispose(){}static main(){m.a.instance.Ac(new iD)}}Object(e.a)(iD,"PPTWebEditorShapeManipulationPackage",null,[2,3]);var fQ=d(1107),xz=d(1163),er=d(117);class Dx{constructor(a,b,c,f,l,x,F,R){this.Hle=null;this.wle=new Date;this.bQ=a;this.R4j=b;this.I9j=c;this.KZj=f;this.D4j=l;this.gFa=x;F.Gb(new He.a(R,2,this.KZj,Object(D.a)(this,this.BMf,"checkTask"),90,
"61"))}BMf(){this.vql()}vql(){var a=new Date;const b=+new Date-+this.Hle>this.I9j;if(!(this.wle<this.Hle)||b){if(+a-+this.wle<this.R4j)return;this.bQ()}a=+new Date-+a;a>this.D4j&&ya.a.J(8958035,813,10,"PrefetchManager::PrefetchThrottler::TryPrefetchIfAppropriate() took too long to check  prefetch: {0}ms for {1}",a,this.gFa)}ljd(){this.Hle=new Date}ijd(){this.wle=new Date}}Object(e.a)(Dx,"PrefetchThrottler",null,[]);class Vp{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc){this.ged=250;this.B8b=
this.$6b=null;this.GIg=this.jIg=!1;this.Hzb=[];this.pgi=5;this.NJf=10;this.Izb=[];this.qgi=5;this.AUa=!1;this.JQg=this.nN=this.fWc=null;this.t_c=!1;this.Nne=[];this.Yb=a;this.ta=b;this.GG=c;this.rj=f;this.Aee=l;this.Cy=Jc;this.Vka=x;this.Ga=F;this.yb=R;this.rc=fa;this.$u=wa;this.lL=Xa;this.od=lb;this.q8j=Lb;this.Mc=kc;this.Bk=lc;this.Fx=Ec;this.d8j=this.Ga.dLj;this.y6j=u.AFrameworkApplication.fa.ka("PrefetchThrottlerNormalPriorityEnabled");this.v6j=u.AFrameworkApplication.fa.ka("PrefetchLookaheadSlideEnabled");
!n.a.Ki||this.Ga.eLj?this.setEnabled(this.Ga.WDj,this.Ga.lHj):this.setEnabled(!1,!1);this.x6j=this.Ga.prefetchSlideForwardMax;this.w6j=this.Ga.prefetchSlideBackwardMax;this.F_j=u.AFrameworkApplication.fa.ka("PodDisableAlwaysPrefetchSlidesInVisibleRange");this.MWk=u.AFrameworkApplication.fa.Ec("SlidePrefetchLookaheadCount",0);this.PG=!1;this.Mc.tB(Object(D.a)(this,this.uL,"onSessionClosed"));this.Mc.O2a(Object(D.a)(this,this.Kda,"onSessionRehydrating"));this.Mc.uB(Object(D.a)(this,this.jo,"onSessionRehydrated"));
u.AFrameworkApplication.fa.ka("SlidePrefetchThrottlerMinDelayReduced")&&(this.ged=125);this.Fx&&this.Fx.LCa(()=>{this.Mgl()})}Mgl(){this.JQg=new He.a(2,1,this.ged,Object(D.a)(this,this.updateSlidePrefetchRange,"updateSlidePrefetchRange"),90,"59");this.t_c=!1;const a=this.y6j?2:3;this.$6b=new Dx(Object(D.a)(this,this.tql,"tryPrefetchContentModel"),this.ged,Vp.NWk,Vp.yhh,Vp.shh,"content model",this.yb,a);this.od.Tmb(Object(D.a)(this,this.Zcb,"onVisibleThumbnailsChanged"));this.Bk.WJ(Object(D.a)(this,
this.iC,"onActiveSlideChanged"));this.B8b=new Dx(Object(D.a)(this,this.wql,"tryPrefetchImages"),this.ged,Vp.LWk,Vp.yhh,Vp.shh,"image",this.yb,3);this.lL&&(this.lL.Kga(Object(D.a)(this,this.oAg,"loadedHandler")),this.lL.xk(Object(D.a)(this,this.F7g,"propertyChangedHandler")))}get yf(){this.fWc&&this.fWc.isConnected||(this.fWc=this.Yb.yf);return this.fWc}get Ba(){this.nN||(this.nN=this.ta.Ba);return this.nN}setEnabled(a,b){this.jIg=a;this.GIg=b}p6c(){this.Hzb=[];this.Izb=[];this.AUa=!1}dispose(){this.od.Edh(Object(D.a)(this,
this.Zcb,"onVisibleThumbnailsChanged"));this.Bk.z4(Object(D.a)(this,this.iC,"onActiveSlideChanged"));this.Mc.gea(Object(D.a)(this,this.uL,"onSessionClosed"));this.Mc.WDe(Object(D.a)(this,this.Kda,"onSessionRehydrating"));this.Mc.hea(Object(D.a)(this,this.jo,"onSessionRehydrated"));this.lL&&(this.lL.ZWa(Object(D.a)(this,this.oAg,"loadedHandler")),this.lL.Tm(Object(D.a)(this,this.F7g,"propertyChangedHandler")))}uL(){this.PG=!0}Kda(){this.p6c()}jo(){this.PG=!1}tql(){this.jIg&&this.Loh()&&this.azk()}azk(){var a=
this.O1d();const b=this.AUa?null:Wq.b(a,c=>c?c.Bb:null);(a=this.k4g(0,a))?(a=a.Bb,this.$6b&&this.$6b.ljd(),this.$u.prefetchSlide(a,b,()=>{this.AUa=!0}),this.gCk(a)):this.AUa||this.$u.prefetchSlide(oe.a.empty,b,()=>{this.AUa=!0})}iC(){this.nN=null;this.AUa=!1}Zcb(){this.Kol();this.AUa=!1}oAg(a,b){(a=Object(va.a)(123,b.node))&&a.mD&&this.Scc(a)}F7g(a,b){a=b.property;b.node&&a===ub.a.cid&&(this.AUa=!1)}Scc(a){if(a.isConnected){var b=Object(va.a)(123,a);b&&(b.mDa=!0,this.yb.Gb(new He.a(2,1,0,Object(D.a)(this.B8b,
this.B8b.BMf,"checkTask"),90,"60")),u.AFrameworkApplication.fa.ka("PPTOTextPreloadServiceFonts")&&(Array.clear(this.Nne),this.WFd(b.C3f),this.WFd(b.$vh),this.WFd(b.Ozh),b=new He.a(3,1,0,Object(D.a)(this,this.uql,"tryPrefetchFonts"),90,"114"),b.customData=this.Nne,this.yb.Gb(b)))}this.$6b&&(this.$6b.ijd(),this.Hzb=[]);a.eJa=!0;this.Vka.aZa()}gCk(a){this.Hzb.length>=this.NJf&&(this.Hzb=[]);Array.add(this.Hzb,a)}WFd(a){if(!Ma.a.Va(a)){a=a.split(",");for(const b of a)this.Nne.push(b)}}k4g(a,b=null){const c=
this.Ba;if(!c||!c.isConnected)return null;b||(b=this.O1d());return this.U7i(c,a,b)}U7i(a,b,c){for(const f of c)if(f)if(c=f.Bb,this.irj(c))ya.a.J(512497862,813,50,"PrefetchManager::PickBestSlide() prefetching content model for slide={0} and fetchType={1} failed many times",c,b);else if(this.O9k(f,b)){const l=a.Bb;a=this.rc.p0b(a);const x=this.rc.p0b(f);ya.a.J(512497861,813,50,"PrefetchManager::PickBestSlide() prefetching {0} at {1} with offset {2} from currentSlide {3} at {4} for fetchType={5}",c,
x,x-a,l,a,b);return f}return null}irj(a){let b=0;for(const c of this.Hzb)a.equals(c)&&(b+=1);if(b>=this.pgi)return!0;b=0;for(const c of this.Izb)a.equals(c)&&(b+=1);return b>=this.qgi}O9k(a,b){if(!a)return!1;const c=a.Bb;if(oe.a.xz(c))return!1;const f=!!a&&a.mD;if(0===b)return!f;if(!f||!a.mDa)return!1;b=a.fRa(new er.a(a.Yp,a.Ek));if(null===b)return ya.a.J(512497860,813,50,"PrefetchManager::ShouldPrefetchSlide() null images for {0}",c),!1;for(const l of b)if(!this.GG.JPc.tdd(l).data)return!0;return a.mDa=
!1}wql(){if(this.GIg&&this.Loh()){const b=this.k4g(1);if(b){var a=b.Bb;this.B8b.ljd();this.UPi(b);this.hCk(a)}}}uql(a){a=Array.isArray(a.customData)?a.customData:null;for(const b of a)this.Cy.pIi(b)}Loh(){return this.PG||!this.d8j&&2===this.rj.Yaa||!this.yf||this.Aee.Yra(this.yf)||!this.Ba||this.Ba.CK?!1:!0}hCk(a){this.Izb.length>=this.NJf&&(this.Izb=[]);Array.add(this.Izb,a)}UPi(a){if(a){var b=a.fRa(new er.a(a.Yp,a.Ek));b&&0<b.length?this.GG.Wqb(b,!0,()=>{this.B8b.ijd();this.Izb=[];a.mDa=!1},u.AFrameworkApplication.fa.ka("FetchSlideImageBatchInRealTimeEnabled")):
a.mDa=!1}}Kol(){this.t_c||(this.yb.Gb(this.JQg),this.t_c=!0)}updateSlidePrefetchRange(){this.t_c=!1;this.$u.syncCurrentSlideIdAndPrefetchRange(this.Ba,null,this.Vka.ona,null)}Vgj(){return Wq.b(this.O1d(),a=>a?a.Bb:null)}O1d(){var a=this.Ba;if(!a||!a.isConnected)return[];a=this.rc.p0b(a);var b=this.ta.presentation;if(!b)throw Error.argumentNull("Presentation is null");b=b.slides||[];const c=b.length,f=[],l=[];if(!this.F_j)for(var x of this.Vka.ona.u7)x!==a&&x<c&&(Array.add(l,b[x]),f[x]=!0);if(this.v6j&&
!f.length)for(x=1;x<=this.MWk;x++){const F=this.Vka.ona.lastIndex+x;F!==a&&F<c&&(Array.add(l,b[F]),f[F]=!0)}if(0<=a){a=this.q8j.rdg(a,b.length,this.x6j,this.w6j);for(const F of a)if(void 0===f[F]||null===f[F])f[F]=!0,Array.add(l,b[F])}return l}}Vp.yhh=1E3;Vp.NWk=2E3;Vp.LWk=6E4;Vp.shh=500;Object(e.a)(Vp,"PrefetchManager",null,[367,106]);class jD{constructor(a,b,c,f){this.ni=b;this.GD=c;this.ra=f;this.Mc=a;this.Mc.SMa(Object(D.a)(this,this.Ucb,"onSessionEnding"))}Ucb(a,b){if(this.ra.lD()){a=this.ra.ae();
if(!a.length){const c=this.ra.Ucg();c&&a.push(c)}for(const c of a)this.ni.O3a(c)}this.GD.cUi(b.fJ)}dispose(){this.Mc.VDe(Object(D.a)(this,this.Ucb,"onSessionEnding"))}}Object(e.a)(jD,"SessionCleanupHandler",null,[106]);var WJ=d(423),gQ=d(929);class kD{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.mvd=this.$sc=this.lpe=!1;if(!b)throw Error.argumentNull("taskManager");if(!c)throw Error.argumentNull("context");this.Ga=a;this.xOg=a.sessionTimeoutInMs;this.yb=b;this.xD=c;this.ra=f;this.DTa=l;this.UB=
x;this.Kd=F;this.ta=R;this.Xb=fa;this.vm=wa;this.yOg=Xa;this.zo=lb;this.QDg=Lb;this.fac=0}get xba(){return this.DTa.instance}get P7(){return u.AFrameworkApplication.Xg}get Ewg(){return 1===this.fac}get qvb(){return this.$sc}get FTc(){return this.mvd}get fJ(){return this.fac}set fJ(a){this.fac=a}get iLf(){return this.Ga.podsSeamlessFailoverEnabled&&!!this.zo.instance}start(){if(!this.P7){var a=new He.a(4,2,3E4,Object(D.a)(this,this.zRg,"manageLifetime$p"),90,"56");this.yb.Gb(a)}}oak(){this.zRg(null)}zRg(){if(!this.lpe){var a=
+new Date-+Mc.a.w5b;a>this.xOg&&this.ENi(a);u.AFrameworkApplication.zz&&u.AFrameworkApplication.fa.ka("WOPITokenRefreshStopWhenOutOfRangeIsEnabled")&&a>=this.Ga.wopiTokenRefreshMaxDurationInMs&&this.UB.QGk()}}ENi(a){this.P7||(this.dOf(2),this.iLf?this.QDg.instance&&this.QDg.instance.f7a&&(ya.a.J(512360777,805,15,"SessionLifetimeManager::ExpireSession - ShowCustomizedTimeoutMessageForCommentDraft"),Se.Health.instance.recordQosError("TimeoutDialogForCommentDraft",["SessionExpired"],!0,!0,!1,!0,null),
this.yOg.idl()):this.yOg.hdl(),this.UB.PFk(),ya.a.J(512360776,801,15,"SessionLifetimeManager::ExpireSession - Session has expired after idle {0}, timeout {1}. CanRehydrate:{2}; ValidFailoverInstance:{3}; SeamlessFailoverEnabled:{4};",a,this.xOg,this.iLf,!!this.zo.instance,this.Ga.podsSeamlessFailoverEnabled))}closeSession(a=1){this.dOf(a)}dOf(a){0===a&&ya.a.J(512360775,801,50,"SessionCloseReason should not be unknown!");if(!this.P7)try{this.$sc=!0,ya.a.J(512360774,801,15,"SessionLifetimeManager::CloseSession() - closing session, reason:{0}",
WJ.a[a]),this.fac=a,this.ra.setSelection(null),u.AFrameworkApplication.Xg=!0,this.xD.y6a().W6c=!0,this.Kd.disabled=!0,Ej.a.Cw&&4!==a&&Ej.a.Cw.hide(),this.UB.OBe(new gQ.a(a)),this.xba&&0<this.xba.jBa.count&&this.xba.Dhc(this.xD.kQa().presentationId,"instanceId",!0,!1),this.Ga.podsSeamlessFailoverEnabled&&this.zo.instance&&(1===a?this.zo.instance.PEd("abortedOnExitApp"):this.zo.instance.PEd("SessionClose_"+a)),this.yb.stop(),this.vm.isPaused||this.vm.pause(),4!==a&&2!==a&&this.Xb.blockContent(this.ta.presentation,
"CloseSession",!0),this.UB.Cbd(new In.a(a))}finally{this.mvd=this.$sc=!1}}Pdl(){this.lpe=!0}YUk(){this.lpe=!1}markSessionClosingAtForceSave(a){ya.a.J(512360773,801,15,"SessionLifetimeManager::MarkSessionClosingAtForceSave reason:{0}",WJ.a[a]);this.mvd=this.$sc=!0;this.fac=a}}Object(e.a)(kD,"SessionLifetimeManager",null,[612]);var Uf=d(412);class XJ{constructor(){this.trigger=null;this.k$=this.wgb=this.JYa=0;this.fOd={}}}Object(e.a)(XJ,"SuggestionsInfo",null,[]);class YJ{constructor(){this.SessionID=
this.SerializedUser=this.BaseDocQueryStringWithoutVersion=null}}Object(e.a)(YJ,"StartRtcConnectionRequest",null,[]);class ZJ{constructor(){this.SessionID=null}}Object(e.a)(ZJ,"StopRtcConnectionRequest",null,[]);var hQ=d(303);class $J{constructor(a,b){this.slideId=a;this.imageId=hQ.a.TEc(b)}}Object(e.a)($J,"ThumbnailImageId",null,[]);var Ls=d(314);const aK=a=>{let b,c,f;var l;let x,F;b=null;f=c=0;x=l=null;F=-1;return(a=a.match(RegExp("/IncSuggestion/(.*),(\\d+),(\\d+),(\\d+),(\\d+),(.*),(\\d+)")))&&
8===a.length?(b=a[1],c=Number.parseInvariant(a[2]),f=Number.parseInvariant(a[3]),l=Object.assign(new Ls.a,{Sid:Number.parseInvariant(a[4]),Cid:Number.parseInvariant(a[5])}),l=new oe.a(l),x=a[6],F=Number.parseInvariant(a[7]),{returnValue:!0,correlationID:b,cU:c,k$:f,slideID:l,trigger:x,wgb:F}):{returnValue:!1,correlationID:b,cU:c,k$:f,slideID:l,trigger:x,wgb:F}},iQ=a=>{const b=new Ha.a;try{const c=fe.a(a);for(const f of c.SlideSuggestions)b.add(f.Index)}catch(c){ya.a.J(42342594,829,10,"ContentKeyHelper:TryGetSuggestionIndexesListFromValue - parsing suggestionResults failed.")}return b};
var yz;(function(a){a[a.none=0]="none";a[a.alone=1]="alone";a[a.coauthoring=2]="coauthoring"})(yz||(yz={}));Object(e.b)("CoauthorStatus",yz);class bK extends Sys.EventArgs{constructor(a){super();this.Pga=a}}Object(e.a)(bK,"AppliedPolicyIdEventArgs",Sys.EventArgs,[]);class cK extends Sys.EventArgs{constructor(a){super();this.QIc=a}}Object(e.a)(cK,"FileRevisionHistoryEventArgs",Sys.EventArgs,[]);class dK extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.iOc=a;this.FIc=b;this.AGj=c;this.confidence=
f;this.imageDescription=l}}Object(e.a)(dK,"ImageDescriptionReadyEventArgs",Sys.EventArgs,[]);class eK extends Sys.EventArgs{constructor(a){super();this.T3b=a}}Object(e.a)(eK,"IsManuallyAppliedEventArgs",Sys.EventArgs,[]);class fK extends Sys.EventArgs{constructor(){super()}}Object(e.a)(fK,"CommentsChangedEventArgs",Sys.EventArgs,[]);class gK extends Sys.EventArgs{constructor(a){super();this.pVd=a}}Object(e.a)(gK,"FindRtcSessionEventArgs",Sys.EventArgs,[]);class hK extends Sys.EventArgs{constructor(){super()}}
Object(e.a)(hK,"LastMergeEditUTCChangedEventArgs",Sys.EventArgs,[]);class iK extends Sys.EventArgs{constructor(){super()}}Object(e.a)(iK,"RealTimeEditEventArgs",Sys.EventArgs,[]);class lD extends Sys.EventArgs{constructor(a,b=null){super();this.S8j=a;this.i0j=b}get ouh(){return this.S8j}get VNi(){return this.i0j}}Object(e.a)(lD,"SyncLoopStatusNotifiedEventArgs",Sys.EventArgs,[]);class jK extends Sys.EventArgs{constructor(a){super();this.Kzk=a}}Object(e.a)(jK,"PresentationLastModifiedTimeReceivedEventArgs",
Sys.EventArgs,[]);var jQ=d(858);class kK extends Sys.EventArgs{constructor(a){super();this.slideId=a}}Object(e.a)(kK,"DesignerSuggestionCoauthModifiedEventArgs",Sys.EventArgs,[]);class zz extends Sys.EventArgs{constructor(a,b,c,f,l,x,F){super();this.d5d=!1;this.olc=null;this.correlationId=a;this.JYa=b;this.k$=c;this.trigger=l;this.slideId=x;this.QAa=F;this.GIa=f}}Object(e.a)(zz,"DesignerSuggestionsUpdatedEventArgs",Sys.EventArgs,[]);class Ex extends Sys.EventArgs{constructor(a,b,c){super();this.correlationId=
a;this.slideId=b;this.QAa=c}}Object(e.a)(Ex,"FixItSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class lK extends Sys.EventArgs{constructor(a,b,c,f){super();this.slideId=a;this.LX=c;this.shapeId=b;this.QAa=f}}Object(e.a)(lK,"IconSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class mK extends Sys.EventArgs{constructor(a,b,c,f,l,x){super();this.correlationId=a;this.ica=b;this.slideId=c;this.shapeId=f;this.BHa=l;this.QAa=x}}Object(e.a)(mK,"ReplaceObjectUpdatedEventArgs",Sys.EventArgs,[]);class mD{constructor(a,
b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg){this.che=this.Wge=!1;this.UJg=null;this.gLg={};this.Vka=b;this.ql=dg;this.oq=l;this.gXc=x;this.Yb=R;this.ta=fa;this.$u=wa;this.p1c=Xa;this.Kd=lb;this.UB=Lb;this.gf=kc;this.kXc=lc;this.Xv=Ec;this.Xa=a;this.KN=Jc;this.ozb=Dc;this.Mc=Wd;this.KXc=c;this.Ga=xe;this.Bt=Sd;this.yb=Pe;this.dv=Ue;this.hc=Ef;this.SIg=this.Ga.vg&&this.Ga.pptNoRtcConnectWhenReadOnlyEnabled;this.Mc.SMa(Object(D.a)(this,this.VA,"onSessionEnd"));this.Mc.tB(Object(D.a)(this,
this.JVd,"flushOnSessionEnd"));this.KXc.CCf(Object(D.a)(this,this.AZg,"onNormalChannelDocNotifyClientItemsUpdated"));f&&f.CCf(Object(D.a)(this,this.AZg,"onNormalChannelDocNotifyClientItemsUpdated"));this.Ga.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&this.Mc.uB(Object(D.a)(this,this.E9,"onPodSessionRehydrated"));this.SIg&&this.Mc.Mga(Object(D.a)(this,this.Vz,"onUnifiedAppStateChanged"))}AZg(a,b){this.njk(b,this.gXc)}njk(a,b){let c=!1;const f=[],l=[],x=new XJ;for(const Dc of a.items){const Wd=
new Date,xe=this.Bt.ZCa;var F=void 0,R=void 0,fa=void 0,wa=void 0,Xa=void 0,lb=void 0;if(Dc.Key===Uf.a.g6g)b.uZd(Uf.a.g6g)>Dc.TimeStamp||(ya.a.J(512497797,813,50,"Need to reload the whole presentation."),c=!0);else{var Lb=void 0;Lb=null;(R=Dc.Key.match(RegExp("/Thumb\\[(\\d+),(\\d+)\\]/ID\\[(\\d+),(\\d+)\\]")))&&5===R.length?(Lb=new Ls.a,Lb.Sid=Number.parseInvariant(R[3]),Lb.Cid=Number.parseInvariant(R[4]),Lb=new oe.a(Lb),R={returnValue:!0,slideId:Lb}):R={returnValue:!1,slideId:Lb};if(({slideId:R}=
R).returnValue)R=Uf.a.A1d(R.sid,R.cid),b.uZd(R)>=Dc.TimeStamp||(R=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),Array.add(f,new jQ.a(R,0<R.SnapshotTimeStamp?R.SnapshotTimeStamp:Dc.TimeStamp)));else if(Dc.Key.startsWith(Uf.a.HYf))R=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),this.oq.xBh(R),ya.a.J(512497796,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Notify clientID to websession; clientId: {0};",R);else if(Dc.Key===Uf.a.FJi)R=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),
ya.a.J(512497795,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - EditorTable; LastRequestCorrelationID:{0}; TimeStamp:{1}; EditorsCount:{2};",Dc.LastRequestCorrelationID,Dc.TimeStamp,R.length),this.oq.RAh(R);else if(Dc.Key===Uf.a.koi)R=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),ya.a.J(512497794,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - CoauthStatus; LastRequestCorrelationID:{0}; TimeStamp:{1}; NewStatus:{2};",Dc.LastRequestCorrelationID,
Dc.TimeStamp,yz[R]),this.oq.fnc(R);else if(Dc.Key===Uf.a.pti)ya.a.J(39913162,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - Content update; LastEditorID:{0}; LastRequestCorrelationID:{1}; TimeStamp:{2}; RevisionId:{3}; IsFromRealTimeChannel:{4}",Dc.LastEditorID,Dc.LastRequestCorrelationID,Dc.TimeStamp,Dc.Value,!1),this.UB.pEk(),this.$u.OE(this.Yb.zi);else{if(Lb=Dc.Key.startsWith(Uf.a.yVf)){a:{Lb=void 0;R=Dc.Value;try{const Sd=R?R.split(","):[];if(3!==Sd.length){Lb=oe.a.bE(0,0);
ya.a.J(23089477,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Coauth modified value member is not expected; value:{0}.",R);var kc={returnValue:!1,slideId:Lb};break a}const Pe=Number.parseInvariant(Sd[0]),Ue=Number.parseInvariant(Sd[1]),Ef=Sd[2];Lb=oe.a.bE(Number.parseInvariant(Sd[0]),Number.parseInvariant(Sd[1]));ya.a.J(23089479,823,50,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Sid:{0}, Cid:{1}, modified Guid:{2}.",Pe,Ue,Ef)}catch(Sd){ya.a.J(23089481,
823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Cannot get slide id from coauth modified key. Value:{0}, exception log:{0}.",R,Sd.toString());Lb=oe.a.bE(0,0);kc={returnValue:!1,slideId:Lb};break a}kc={returnValue:!0,slideId:Lb}}Lb=({slideId:R}=kc).returnValue}if(Lb)ya.a.J(512497793,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Coauth Modified notification returned, slide id:{0}",Dc.Value),this.gf.tEk(new kK(R));else{if(Lb=Dc.Key.startsWith(Uf.a.Jth)){{var lc=
void 0;let Sd;R=null;F=0;lc=Sd=null;(Lb=Dc.Key.match(RegExp("/Suggestion\\[(.*),(\\d+)]/ID\\[(\\d+),(\\d+),(.*),(.*)]")))&&7===Lb.length?(R=Lb[1],F=Number.parseInvariant(Lb[2]),lc=Object.assign(new Ls.a,{Sid:Number.parseInvariant(Lb[3]),Cid:Number.parseInvariant(Lb[4])}),Sd=new oe.a(lc),lc=Lb[6],F={returnValue:!0,correlationID:R,cU:F,slideID:Sd,trigger:lc}):F={returnValue:!1,correlationID:R,cU:F,slideID:Sd,trigger:lc}}Lb=({correlationID:F,cU:x.JYa,slideID:R,trigger:x.trigger}=F).returnValue}if(Lb)ya.a.J(512497792,
829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer suggestion notification returned, CorrelationId:{0}",F),R=new zz(F,x.JYa,x.JYa,0,x.trigger,R,Dc.Value),R.olc=new Ha.a,this.eAe(R);else if(this.Ga.designerIncrementalRenderEnabled&&Dc.Key.startsWith(Uf.a.f5d)&&({correlationID:F,cU:x.JYa,k$:x.k$,slideID:R,trigger:x.trigger,wgb:x.wgb}=aK(Dc.Key)).returnValue)ya.a.J(512497763,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer incremental suggestion notification returned, CorrelationId: {0}; startIdx: {1}; Suggestions in notification: {2}; Expected total: {3}",
F,x.wgb,x.JYa,x.k$),R=new zz(F,x.JYa,x.k$,x.wgb,x.trigger,R,Dc.Value),F in x.fOd||(x.fOd[F]=this.nej(F,a.items)),R.olc=x.fOd[F],R.d5d=!0,this.eAe(R);else{if(Lb=Dc.Key.startsWith(Uf.a.M3f))R=F=null,(Lb=Dc.Key.match(RegExp("/FixItSuggestion\\[(.*)]/ID\\[(\\d+),(\\d+),(.*)]")))&&5===Lb.length?(F=Lb[1],R=Object.assign(new Ls.a,{Sid:Number.parseInvariant(Lb[2]),Cid:Number.parseInvariant(Lb[3])}),R=new oe.a(R),F={returnValue:!0,correlationID:F,slideID:R}):F={returnValue:!1,correlationID:F,slideID:R},Lb=
({correlationID:F,slideID:R}=F).returnValue;if(Lb)ya.a.J(512497762,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - FixIt suggestion notification returned, CorrelationId:{0}",F),this.eAe(new Ex(F,R,Dc.Value));else{if(Lb=Dc.Key.startsWith(Uf.a.Opg))lb=null,fa=0,Lb=null,F=R=0,(wa=Dc.Key.match(RegExp("/Intelligence\\[(.*),(\\d+),(\\d+),(\\d+),(\\d+),(\\d+)]")))&&7===wa.length?(lb=wa[1],fa=Number.parseInvariant(wa[2]),F=Object.assign(new Ls.a,{Sid:Number.parseInvariant(wa[3]),Cid:Number.parseInvariant(wa[4])}),
Lb=new oe.a(F),R=Number.parseInvariant(wa[5]),F=Number.parseInvariant(wa[6]),fa={returnValue:!0,correlationID:lb,ica:fa,slideID:Lb,shapeId:R,BHa:F}):fa={returnValue:!1,correlationID:lb,ica:fa,slideID:Lb,shapeId:R,BHa:F},Lb=({correlationID:F,ica:fa,slideID:R,shapeId:wa,BHa:lb}=fa).returnValue;if(Lb)ya.a.J(512497761,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - ReplaceObject notification returned, CorrelationId:{0}",F),this.gf.GFk(new mK(F,fa,R,wa,lb,Dc.Value));else if(Dc.Key===Uf.a.CBl)this.Vpj();
else if(Dc.Key===Uf.a.R1f&&this.UJg!==Dc.Value)this.hlj(Dc);else if(Dc.Key===Uf.a.puh)!Ma.a.Va(Dc.Value)&&Ma.a.Vub(Dc.Value)?(R=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),ya.a.J(512497760,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; PopSessionID:{1}; PodSessionID:{2}",R,this.Xa.tk,this.Xa.podSessionId),240===R?this.KN.eea(1):(432!==R||this.che||this.gXf(),this.ozb.p$g(new lD(R)))):(R=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),
ya.a.J(512497759,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; HasExtraErrorParams:{1}; PopSessionID:{2}; PodSessionID:{3}",R.Code,!!R.ExtraErrorParam,this.Xa.tk,this.Xa.podSessionId),240===R.Code?this.KN.eea(1):(432!==R.Code||this.che||this.gXf(),this.ozb.p$g(new lD(R.Code,R.ExtraErrorParam))));else if(Dc.Key===Uf.a.kzg)this.cmj(Dc);else if(Dc.Key===Uf.a.Ksj)ya.a.J(512497758,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Host Session Failover notification received oldsessionId:{0};",
this.Xa.tk),this.KN.eea(1);else if(Dc.Key===Uf.a.Lzk)R=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),this.Yb.yf.oze=R,this.Xv.zFk(new jK(R));else if(Dc.Key.startsWith(Uf.a.dPf)){ya.a.J(512497757,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Comment has been createed or updated with key: {0}",Dc.Key);a:{R=Dc.Key;try{const Sd=R.match(RegExp("\\d+","g"));if(Sd&&0<Sd.length&&!(Sd.length%2)){Lb=[];for(lc=0;lc<Sd.length;lc+=2)Lb.push(Object.assign(new Ls.a,{Sid:Number.parseInvariant(Sd[lc]),
Cid:Number.parseInvariant(Sd[lc+1])}));var Ec=Lb;break a}}catch(Sd){ya.a.J(25011930,805,10,"ContentKeyHelper::TryGetSlideIdsFromCommentPrefixKey - Cannot get slide id array from key. Key:{0}, Exception:{1}",R,Sd)}Ec=null}(R=Ec)&&0<R.length&&this.UB.kEk(new fK(R))}else if(Dc.Key.startsWith(Uf.a.Wkg))this.Flj(Dc);else if(Dc.Key===Uf.a.p2f)this.kXc.CEk(new cK(Dc.Value));else{if(Lb=Dc.Key.startsWith(Uf.a.zkg)){a:{Xa=Dc.Key;Lb=null;R=0;wa="";try{const Sd=Xa.match(RegExp("/IconSuggestion\\[(\\d+),(\\d+),(\\d+),{(.*)}]"));
if(Sd&&5===Sd.length){const Pe=Object.assign(new Ls.a,{Sid:Number.parseInvariant(Sd[1]),Cid:Number.parseInvariant(Sd[2])});Lb=new oe.a(Pe);R=Number.parseInvariant(Sd[3]);wa=Sd[4];var Jc={returnValue:!0,slideID:Lb,shapeId:R,nodeId:wa};break a}}catch(Sd){ya.a.J(38279246,823,10,"ContentKeyHelper::TryGetIconSuggestionInfoFromServiceKey - Cannot get IconSuggestionInfo from key. Value:{0}, exception log:{0}.",Xa,Sd.toString())}Jc={returnValue:!1,slideID:Lb,shapeId:R,nodeId:wa}}Lb=({slideID:R,shapeId:wa,
nodeId:Xa}=Jc).returnValue}if(Lb)ya.a.J(512497756,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IconSuggestion notification returned."),this.gf.NEk(new lK(R,wa,Xa,Dc.Value));else if(Dc.Key===Uf.a.CRi)this.ozb.DEk(new gK(Dc.Value));else{if(Lb=Dc.Key.startsWith(Uf.a.ewh))Lb=null,(R=Dc.Key.match(RegExp("/ThumbImgId\\[(\\d+),(\\d+)\\]")))&&3===R.length?(Lb=new Ls.a,Lb.Sid=Number.parseInvariant(R[1]),Lb.Cid=Number.parseInvariant(R[2]),Lb=new oe.a(Lb),R={returnValue:!0,slideId:Lb}):R=
{returnValue:!1,slideId:Lb},Lb=({slideId:R}=R).returnValue;if(Lb)R=new $J(R,Dc.Value),R.imageId&&l.push(R);else if(Dc.Key===Uf.a.PHi)this.dv.zSe(parseInt(Dc.Value));else if(Dc.Key===Uf.a.qFf)this.kXc.bEk(new bK(Dc.Value));else if(Dc.Key===Uf.a.zug)this.kXc.VEk(new eK("true"===Dc.Value.toLowerCase()));else if(Dc.Key===Uf.a.XVk)this.oq.Jgh=Dc.Value,this.oq.d_g();else if(Dc.Key===Uf.a.VVk)try{this.oq.Egd=Boolean.parse(Dc.Value)}catch(Sd){ya.a.J(512497755,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",
Sd)}else if(Dc.Key===Uf.a.bzg)R=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),ya.a.J(512497754,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - LastMergeEditUTC updated: {0}",R.toString()),this.UB.$Ek(new hK(R));else if(Dc.Key===Uf.a.V$g)R=Sys.Serialization.JavaScriptSerializer.deserialize(Dc.Value),ya.a.J(512497753,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated- Raising a RealTimeChannelEditEvent. UTC Time: {0}",R.toString()),this.UB.BFk(new iK(R));
else if(Dc.Key===Uf.a.Puj)try{this.oq.S7d=Boolean.parse(Dc.Value),ya.a.J(512497752,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IsConnectedToOCS: {0}",this.oq.S7d)}catch(Sd){ya.a.J(512497751,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Sd)}else if(Dc.Key===Uf.a.Isj)this.oq.Pec=Dc.Value,ya.a.J(512497750,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - PopsHostProtocol: {0}",this.oq.Pec);else if(Dc.Key===
Uf.a.MBl)ya.a.J(512497749,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received ZeroByteFileEnsuredOnHost notification"),this.oq.GEh=!0;else if(Dc.Key===Uf.a.GUj)ya.a.J(512497748,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockId: {0}",Dc.Value),this.oq.U2=Dc.Value;else if(Dc.Key===Uf.a.HUj)ya.a.J(512497747,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockIsCoauthorable: {0}",Dc.Value),this.oq.tAg=Boolean.parse(Dc.Value);
else if(Dc.Key===Uf.a.QUf)try{this.oq.v4a=Number.parseInvariant(Dc.Value),ya.a.J(512497746,843,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - DeferredBlobCount: {0}",this.oq.v4a)}catch(Sd){ya.a.J(512497745,843,15,"Can't parse the notification message: {0}",Sd)}else if(Dc.Key===Uf.a.ZDf){let Sd;try{Sd=Boolean.parse(Dc.Value),this.oq.minorVersionLimitReached=Sd}catch(Pe){Sd=this.oq.minorVersionLimitReached=!1}Sd&&!this.Wge&&(this.VGi(),this.Wge=!0);ya.a.J(512497744,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received AllowSaveAtMinorVersionLimit: {0}, m_fIsMinorVersionLimitReachedDisplayed: {1}",
Dc.Value,this.Wge)}else ya.a.J(512497743,817,50,"Notification key ignored {0}",Dc.Key)}}}}}}}ya.a.J(512497742,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated docItem.Key:{0}, ProcessNotificationStart:{1}, ProcessNotificationDuration:{2}",Dc.Key,Mc.a.Ye(Wd),(+new Date-+Wd).toString());xe&&!this.Bt.ZCa&&ya.a.J(512497741,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Dragging is stopped while processing docItem.Key:{0}",Dc.Key)}this.Ctl(c,f,b,l)}nej(a,b){const c=new Ha.a;
b=vj.e(b,f=>f.Key.startsWith(Uf.a.f5d));for(const f of b)b=aK(f.Key),b.returnValue&&b.correlationID===a&&(1===b.cU?c.add(b.wgb):1<b.cU&&c.addRange(iQ(f.Value)));return c}VGi(){this.ql.MM(24);ya.a.J(512497740,809,50,"CoauthNotificationManager::DisplayVersionLimitHitInfo reached - business bar for MinorVersionLimit")}gXf(){this.che=!0;this.ql.MM(25);ya.a.J(512497739,809,15,"CoauthNotificationManager::DisplayNetworkLocationUnauthorizedInfo reached - business bar for UserNetworkLocationUnauthorized Shown")}eAe(a){let b;
b=Object(Fa.a)(Ex,a)?()=>{this.gf.raiseFixItSuggestionUpdatedEvent(Object(va.a)(Ex,a))}:()=>{this.gf.raiseDesignerSuggestionsUpdatedEvent(Object(va.a)(zz,a))};if(this.Bt.ZCa&&this.Ga.processSuggestionNotificationInTaskIfInDragIsEnabled){const c=new He.a(2,1,0,()=>{b()},90,Object(Fa.a)(Ex,a)?"114":"92");this.yb.Gb(c)}else b()}Ctl(a,b,c,f){a&&(this.Vka.kjj(),this.p1c.instance&&this.p1c.instance.p6c());b.forEach(l=>{const x=l.ZXb.Id;c.Atl(Uf.a.A1d(x.Sid,x.Cid),l.uea)});this.Vka.ilj(b,f)}Vpj(){ya.a.J(512497738,
817,10,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Document was already opened by antoher DC.");this.Yb.zi&&this.Yb.zi.contentReplicator&&(this.Yb.zi.contentReplicator.enabled=0);this.Kd.qG(158,a=>{a.xB=1;return!1})}hlj(a){ya.a.J(512497737,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Failover notification received");this.UB.BEk(new mm(!1,!0));let b=null;this.p1c.instance&&(b=this.p1c.instance.Vgj());this.$u.syncCurrentSlideIdAndPrefetchRange(this.ta.Ba,b,null,null);
this.UJg=a.Value}cmj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);if(this.Xa.podSessionId!==a)if(this.Ga.ignorePodSessionRefreshedFromPops)ya.a.J(512497736,817,50,"CoauthNotificationManager::HandleLatestPodSessionNotification - Ignore Pop rehydrated Pod session");else{const b=this.Xa.podSessionId;this.Xa.podSessionId=a;this.ozb.O9g(new aq.a(b,a))}else ya.a.J(512497735,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Same PodSessionId:{0}",a)}Flj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);
try{if(a){const b=a.split(";",6);a=!0;for(let c=0;5>c;c++)if(!b[c]){a=!1;break}if(6>b.length||!a)ya.a.J(512497733,817,15,"Invalid format of image description notification");else{const c=Ga.a.Yf(b[1]),f=Boolean.parse(b[2]),l=Boolean.parse(b[3]);this.kXc.OEk(new dK(c,f,l,parseFloat(b[4]),b[5]))}}else ya.a.J(512497734,817,15,"Response data is null")}catch(b){ya.a.J(512497732,817,15,"Can't parse the notification message: {0}",b)}}nTi(){let a=0;const b=[],c=(new Date).getTime(),f=this.gLg;for(let x in f){var l=
x;0<c-f[x]&&(a++,delete this.gLg[l])}(0<a||0<b.length)&&ya.a.J(512497731,817,50,"FlushDocNotifyTelemetry - normal channel only:{0}, normal channel delay:{1}",a,Pa.a.join(b,","))}JVd(){this.nTi()}Ish(){if(this.SIg&&!this.hc.BK)ya.a.J(512497730,801,50,"StartServerRtcConnection: Do not start server RTC in readonly mode");else{var a=hb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=lh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StartRtcConnection&source=Browser",
this.Ga.podsWebServiceBase),f=Object.assign(new YJ,{BaseDocQueryStringWithoutVersion:u.AFrameworkApplication.Zg,SerializedUser:this.Ga.serializedBaseUser,SessionID:a}),l={};l.PodSID=a;l["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;l["X-CorrelationID"]=b;a=fe.c(f);u.AFrameworkApplication.He.FY(c,2,a,l,[gg.a.q4],0,x=>{this.nBg(50,String.format("EnqueueTime:{0}; InvokedTime:{1}; CompletedTime: {2}; ResponseData:{3}",x.data.NH,x.data.zt,x.data.Iu,x.data.Zd))},x=>{const F=hb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");
this.nBg(10,F.bia(x))},null,void 0,void 0,void 0,void 0,Ax.a("3"))}}ath(){var a=hb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const b=lh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StopRtcConnection",this.Ga.podsWebServiceBase),f={};f.PodSID=a;f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;a=Object.assign(new ZJ,{SessionID:a});a=fe.c(a);u.AFrameworkApplication.He.FY(c,2,a,f,[gg.a.q4],0,()=>{ya.a.J(38904456,801,50,
"StopServerRtcConnection - request succeeded")},l=>{const x=hb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");ya.a.J(38904458,801,10,"StopServerRtcConnection -  Failed with status code: {0}",x.bia(l))},null,void 0,void 0,void 0,void 0,Ax.a("9"))}nBg(a,b){ya.a.J(512497729,801,a,"StartServerRtcResult: {0}",b)}E9(){this.Ish()}Vz(a,b){b.$8d&&!this.hc.BK&&(ya.a.J(512497728,801,50,"OnUnifiedAppStateChanged: Disconnect from server RTC in readonly mode"),this.ath())}VA(){this.ath()}}Object(e.a)(mD,
"CoauthNotificationManager",null,[]);class nK{constructor(a,b){this.OIh=a;this.fYe=b}get coauthoringStartTime(){return this.OIh}get pOf(){return this.fYe}Z0k(a){this.fYe=a}}Object(e.a)(nK,"CoauthoringDurationRecord",null,[]);var kQ=d(927);class oK extends Sys.EventArgs{constructor(a,b,c=!1){super();this.yGf=a;this.Azg=b;this.SFj=c}}Object(e.a)(oK,"EditorTableChangedEventArgs",Sys.EventArgs,[]);class Az{constructor(a,b,c){this.Xka=this.mab=null;this.M9a=[];this.NDg=new Wj.a;this.bLg=new Wj.a;this.vme=
null;this.sFg=!1;this.nme=0;this.HFg=this.mYc=!1;this.j1c="";this.Jgh=null;this.minorVersionLimitReached=this.GEh=this.Evg=this.Egd=this.E1f=!1;this.Xle=null;this.tAg=!1;this.v4a=0;this.iTc=!1;this.YDa=a;this.Mc=b;this.qXc=0;this.g$a=[];this.Mc.zGd(Object(D.a)(this,this.Pcb,"onPopSessionClosed"));this.e4j=c}get hC(){return this.mab}set hC(a){this.mab!==a&&(this.mab&&0<this.mab.length&&2===this.qXc&&ya.a.J(19163158,804,10,String.format("MyEditorID is changed from {0} to {1}",this.mab,a)),this.mab=
a)}get userName(){return this.Xka}get S7d(){return this.mYc}set S7d(a){(this.mYc=a)&&!this.HFg&&Se.Health.instance&&(this.HFg=!0,Se.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.mYc.toString()))}get Pec(){return this.j1c}set Pec(a){a!==this.j1c&&(this.j1c=a,ya.a.J(556799194,804,50,"CoauthStateCache - PopsHostProtocol:{0}",this.j1c))}get U2(){return this.Xle}set U2(a){this.Xle=a;(a=this.e4j.value.instance)?(a.FMd=this.Xle,ya.a.J(545338634,804,50,"CoauthStateCache::LockId - renameProps.CoauthLockId: {0}",
a.FMd)):ya.a.J(545338635,804,50,"CoauthStateCache::LockId - renameProps == null");this.YDa.cFk()}get bZ(){const a=[];Array.addRange(a,this.g$a);return a}get Rxl(){return this.bZ.length?this.bZ.length:1}get amIAlone(){return 2!==this.Yaa}get Qv(){return this.tAg}get Yaa(){return this.qXc}set Yaa(a){this.qXc!==a&&(ya.a.J(8958419,804,50,"Coauth State Changing to: {0}",1===a?"alone":"coauthoring"),this.qXc=a)}get eAa(){return this.NDg.task}get n5c(){return this.bLg.task}get kJc(){return this.vme}set kJc(a){this.vme||
(this.vme=a,this.bLg.Bg(a.getTime()))}RAh(a){let b;({FId:a,leaving:b}=this.aul(a)).returnValue&&(a=new oK(a,b,!this.iTc),this.BIk(),this.YDa.xEk(a))}BIk(){const a=[],b=this.bZ;for(const c of b)Array.add(a,c.ID)}fnc(a){const b=this.Yaa;2===a&&(this.kJc=new Date);0!==b||this.sFg||(ya.a.J(50440395,804,50,"Set coauthoring start point: {0}",1===a?"alone":"coauthoring"),this.sFg=!0,this.NDg.Bg(1===a?1:0));this.Yaa=a;b!==this.Yaa&&(this.YDa.iEk(new kQ.a(this.Yaa)),this.otl(this.Yaa))}otl(a){var b=new Date;
2===a?(b=new nK(b,new Date(9999,12,31)),Array.add(this.M9a,b)):(a=this.M9a.length,0<a&&this.M9a[a-1].Z0k(b))}xBh(a){this.hC=a;ya.a.J(23437834,814,50,"App::UpdateMyEditorID; MyClientId: {0}; EditorTableCount: {1}",this.hC,this.bZ.length);this.YDa.hEk()}vhb(a){let b;a&&(a=a.toLowerCase());b=null;for(let c=0;c<this.g$a.length;c++){const f=this.g$a[c];if(a===f.ID){b=f;break}}return{returnValue:!!b,editor:b}}aul(a){let b,c;const f=[];b=[];c=[];let l=!1;const x=a?a.length:0;for(let F=0;F<x;F++){const R=
a[F];R&&R.ID&&(R.ID=R.ID.toLowerCase());let fa;({editor:fa}=this.vhb(R.ID)).returnValue?(l=l||!Az.IJi(R,fa),Array.remove(this.g$a,fa)):(R.ID!==this.mab?Array.add(b,R):this.Xka=R.Name,l=!0);Array.add(f,R)}Array.addRange(c,this.g$a);l=l||0<c.length;this.g$a=f;this.nme=Math.max(this.nme,this.g$a.length);Se.Health.instance&&Se.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.nme.toString());return{returnValue:l,FId:b,leaving:c}}OKc(a,b){let c=0;const f=this.M9a.length;if(0<f&&a<this.M9a[f-
1].pOf){a=a.getTime();b=b.getTime();for(let l=0;l<f;++l){const x=Math.max(this.M9a[l].coauthoringStartTime.getTime(),a),F=Math.min(this.M9a[l].pOf.getTime(),b);x<F&&(c+=F-x)}}return c}d_g(){this.Evg=!0;this.YDa.yFk()}Pcb(){this.Pec=""}static IJi(a,b){return a.EmailAddress===b.EmailAddress&&a.ColorIndex===b.ColorIndex&&a.Name===b.Name&&a.ID===b.ID&&a.SIPAddress===b.SIPAddress}}Object(e.a)(Az,"CoauthStateCache",null,[610,611]);var $t=d(421);class wl{constructor(){this.KeyRoot=null;this.TimeStamp=0}}
Object(e.a)(wl,"KeyRootSubscription",null,[]);class qv{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.Yac=$t.a.empty;this.Zr=[];this.ita=[];this.KFg=this.Jge=!1;this.KXc=a;this.kZc=b;this.Ue=c;this.DWc=wa.Lci;this.Vka=f;this.gXc=l;this.rj=x;this.D$j=F.HOd(1E3,Object(D.a)(this,this.qMi,"ensureVisibleThumbnailsSubscriptionImpl"));this.Mc=R;this.od=fa;this.Xa=wa;Xa.hFd(this);this.V6j=lb;this.h9b=Lb;this.PG=!1;this.V6j&&this.Mc.s3h(Object(D.a)(this,this.Chk,"onBackendChanged"));this.Mc.tB(Object(D.a)(this,
this.uL,"onSessionClosed"));this.Mc.uB(Object(D.a)(this,this.jo,"onSessionRehydrated"))}bva(){this.PG=!1;this.gXc.reset();this.lmg()}lmg(){Array.clear(this.Zr);this.Yac=$t.a.empty;this.Fjd=this.Vka.ona;this.od.Tmb(()=>{this.Fjd=this.Vka.ona});const a=new wl;a.KeyRoot=Uf.a.M6f(this.DWc);a.TimeStamp=0;this.Zr.push(a);var b=new wl;b.KeyRoot=Uf.a.f6g;b.TimeStamp=0;this.Zr.push(b);b=new wl;b.KeyRoot=Uf.a.joi;this.Zr.push(b);var c=new wl;c.KeyRoot=Uf.a.Jth;this.Zr.push(c);c=new wl;c.KeyRoot=Uf.a.f5d;this.Zr.push(c);
c=new wl;c.KeyRoot=Uf.a.Opg;this.Zr.push(c);c=new wl;c.KeyRoot=Uf.a.yVf;this.Zr.push(c);c=new wl;c.KeyRoot=Uf.a.R1f;this.Zr.push(c);c=new wl;c.KeyRoot=Uf.a.puh;this.Zr.push(c);const f=new wl;f.KeyRoot=Uf.a.kzg;this.Zr.push(f);const l=new wl;l.KeyRoot=Uf.a.Msj;this.Zr.push(l);var x=new wl;x.KeyRoot=Uf.a.dPf;this.Zr.push(x);x=new wl;x.KeyRoot=Uf.a.Wkg;this.Zr.push(x);x=Object.assign(new wl,{KeyRoot:Uf.a.p2f,TimeStamp:0});this.Zr.push(x);x=new wl;x.KeyRoot=Uf.a.zkg;this.Zr.push(x);this.h9b&&(x=new wl,
x.KeyRoot=Uf.a.ewh,this.Zr.push(x));x=new wl;x.KeyRoot=Uf.a.qFf;this.Zr.push(x);x=new wl;x.KeyRoot=Uf.a.zug;this.Zr.push(x);x=new wl;x.KeyRoot=Uf.a.bzg;this.Zr.push(x);x=new wl;x.KeyRoot=Uf.a.V$g;this.Zr.push(x);x=new wl;x.KeyRoot=Uf.a.M3f;this.Zr.push(x);x=new wl;x.KeyRoot=Uf.a.ZDf;this.Zr.push(x);const F=new wl;F.KeyRoot=Uf.a.QUf;this.Zr.push(F);this.KXc.Jjc(this.Zr);this.kZc&&(Array.clear(this.ita),this.ita.push(b),this.ita.push(a),this.ita.push(c),this.ita.push(f),this.ita.push(l),this.ita.push(x),
this.Ue.Xz?(this.kZc.Jjc(this.ita),this.Jge=!0):this.Ue.Zea?(this.Mc.AGd(Object(D.a)(this,this.dWa,"onPopSessionInitialized")),this.KFg=!0):this.Ue.Oec.task.continueWith(()=>{this.Ue.Xz&&this.kZc.Jjc(this.ita)}))}dWa(){this.Jge||(this.kZc.Jjc(this.ita),this.Jge=!0)}get Fjd(){return this.Yac}set Fjd(a){$t.a.equals(this.Yac,a)||($t.a.equals(a,$t.a.empty)?this.Yac=$t.a.empty:this.Yac=$t.a.KZb(a.gZ,a.lastIndex),this.D$j.perform())}Chk(a,b){this.PG||(a=b.Pqk)&&0<a.length&&(ya.a.J(512497699,817,50,"CoauthManager::OnBackendChanged - Backend machine id changed from {0} to {1}",
a,this.Xa.YAc),this.bva())}uL(){this.PG=!0}jo(){this.bva()}qMi(){const a=this.Zr;var b=this.gXc;const c=[];var f=null;for(const x of this.Fjd.u7){var l=Uf.a.Ffj(x);f&&f.KeyRoot!==l&&(c.push(f),f=null);f||(f=new wl,f.KeyRoot=l,f.TimeStamp=Number.MAX_VALUE);if(l=this.Vka.Isb(x))l=b.uZd(Uf.a.A1d(l.sid,l.cid)),f.TimeStamp>l&&(f.TimeStamp=l)}f&&c.push(f);vj.d(a,Object(D.a)(this,this.XOi,"fNeedResetBrowserKeySubscription"),x=>{x.TimeStamp=0},1);b=vj.e(a,x=>x.KeyRoot.startsWith(Uf.a.gwh));f=vj.a(c,b,qv.Sae);
vj.a(b,f,qv.Sae);if(b.length||c.length)vj.a(a,b,qv.Sae),Array.addRange(a,c),this.KXc.Jjc(a)}XOi(a){return a.KeyRoot.startsWith(Uf.a.M6f(this.DWc))&&!this.rj.hC?(ya.a.J(512497698,817,50,"CoauthSubscriptionManager::ResetBrowserKeyIfNeeded; Resetting timestamp of BrowserID Key subscription as clientId has not been received"),!0):!1}dispose(){this.Mc.gea(Object(D.a)(this,this.uL,"onSessionClosed"));this.Mc.hea(Object(D.a)(this,this.jo,"onSessionRehydrated"));this.KFg&&this.Mc.UDe(Object(D.a)(this,this.dWa,
"onPopSessionInitialized"))}static Sae(a,b){return a.KeyRoot===b.KeyRoot}}Object(e.a)(qv,"CoauthSubscriptionManager",null,[609,106,608]);class pK extends Sys.EventArgs{constructor(){super();this.items=null}}Object(e.a)(pK,"ItemsModifiedEventArgs",Sys.EventArgs,[]);class qK{constructor(a,b,c,f,l,x){this.id=lh.a.create();this.RWc=a;this.hg=b;this.Xa=c;this.Ga=l;this.Kd=f;this.OW=x}poj(a,b){this.OW&&!this.RWc.SV&&this.OW.mGc(a.tX);a&&a.telemetry&&0<a.telemetry.length&&this.hg.GVa(a.telemetry);Mc.a.LE(this.hg,
()=>{this.RWc.w_g(this.id,a.result,a.tX,b)})}ooj(a,b,c){if(!this.RWc.SV&&(this.OW&&this.OW.mGc(a.tX),a&&a.error&&this.Ga.pptFailoverInLongPollingFailHandlerEnabled&&a.error.Lm===uf.a.Mh(223))){ya.a.J(35497247,801,15,"LongPollingResponseHandler::HandleRequestFailedEventHandler. The server is unable to find PodSessionId:{0}.",this.Xa.podSessionId||"NULL");this.Kd.Rr(Object.assign(new Kg.a,{Code:223,Source:6}),c);return}Mc.a.LE(this.hg,()=>{this.RWc.w_g(this.id,null,a.tX,b)})}}Object(e.a)(qK,"LongPollingResponseHandler",
null,[]);var lQ=d(857);class nD{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){this.XEa=this.TEa=null;this.dKg=lh.a.nil;this.nAb=this.zTa=0;this.tEg=[10,100,1E3,1E4];this.lUa=null;this.EW=[];this.e3=Xa?"GetPopWacUpdates":"GetUpdates";this.O3=a;this.Xa=c;this.Ue=f;this.Mc=l;this.o8=x;this.Kd=F;this.hc=R;this.OW=fa;this.Mc.tB(Object(D.a)(this,this.uL,"onSessionClosed"));this.Mc.O2a(Object(D.a)(this,this.Kda,"onSessionRehydrating"));this.Mc.uB(Object(D.a)(this,this.jo,"onSessionRehydrated"));this.Ue.Zea&&Xa&&
(this.Mc.AGd(Object(D.a)(this,this.dWa,"onPopSessionInitialized")),this.Mc.zGd(Object(D.a)(this,this.Pcb,"onPopSessionClosed")));this.nqe=a.Zll;this.c3j=a.SJj;this.rzb=a.I4g;this.vyb=[];b.y6a().hFd(this);this.W9j=wa;this.nOh=Xa;this.Aja=!1;this.lzb=Xa?3E4:6E4}uL(){this.close("SessionClosed")}Kda(){this.lUa&&this.lUa.xkd()}jo(){this.qHa("SessionRehydrated")}w_g(a,b,c,f){this.TEa=null;const l=+new Date-+this.XEa;if(this.Aja)ya.a.J(512360732,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since DocNotifyClient is closed.",
this.e3);else if(a.equals(this.dKg))if(this.O3.clientIgnoreClosePopsErrorCodeEnable&&this.SV&&this.Aja)ya.a.J(512360730,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since pops is closing.",this.e3);else if(a=this.Ue.jca,f&&f.length&&a!==f)ya.a.J(512360729,801,15,"DocNotifyClient.PerformCall - {0} - Ignore {1} response since PopSessionId is changed. CurrentPopSession:{2}; LastAttemptedEnsureHostSessionId:{3}; RequestPopSession:{4}; RetryAttempts:{5}. Triggering another request in {6}ms.",
this.e3,b?"Success":"Failure",this.Xa.tk,this.Ue.jca,f,this.nAb,this.nqe),this.nAb++,this.x1f(l,this.nAb)||this.Sic(this.nqe);else if(this.nAb=0,b){this.XEa=new Date;this.zTa=0;this.Ue.jbe=this.XEa;this.Ue.ibe=f;ya.a.J(512360727,801,50,"DocNotifyClient.OnResponseReceived - {0} - Success response. TimeSinceLastServerConnected:{1}, Now:{2}, PopSessionID:{3}",this.e3,l,Mc.a.Ye(new Date),this.SV?this.Xa.tk:"Not Applicable");c=0;f={};for(const x of b.Items)x.TimeStamp>c&&(c=x.TimeStamp),f[x.LastRequestCorrelationID]=
x.LastRequestCorrelationID in f?String.format("{0},{1}",f[x.LastRequestCorrelationID].toString(),x.Key):x.Key,vj.d(this.vyb,F=>x.Key.startsWith(F.KeyRoot),F=>{x.TimeStamp>F.TimeStamp&&(F.TimeStamp=x.TimeStamp)},1);this.Sic(this.nqe);0<Object.keys(f).length&&Mc.a.hk("RequestCorrelationIDsAndKeyRoots",Ri.c(f));c=new Date;Mc.a.LE(Mc.a.Cb,()=>{const x=Object.assign(new pK,{items:b.Items});for(const F of this.EW)try{F(this,x)}catch(R){ya.a.J(512360726,801,15,"DocNotifyClient::OnResponseReceived - {0} - Unhandled exception notifying clients {1}, {2}",
this.e3,R.toString(),R.stack)}});Mc.a.hk("ProcessItemStartTime",Mc.a.Ye(c));Mc.a.hk("ProcessItemDurationInMS",(+new Date-+c).toString());Mc.a.Cb.finish()}else ya.a.J(512360728,801,15,"DocNotifyClient.PerformCall - {0} - NULL response, TimeSinceLastServerConnected:{1}, RequestStatus:{2}, HttpStatusCode:{3}, PodSessionId:{4}, PopSessionId:{5}",this.e3,l,c?c.status:3,c?c.af:-1,this.Xa.podSessionId,this.SV?this.Xa.tk:"Not Applicable"),this.x1f(l,this.zTa)||(f=3<=this.zTa?this.tEg[3]:this.tEg[this.zTa],
this.zTa++,this.Sic(f),Mc.a.hk("FailureCountSinceLastSuccess",this.zTa.toString()),Mc.a.hk("NextDelayInMS",f.toString()),c&&(Mc.a.hk("RequestStatus",pk.a[c.status]),Mc.a.hk("HttpStatus",c.af.toString()),Mc.a.hk("Duration",(+c.Iu-+c.zt).toString())),Mc.a.Cb.finish());else ya.a.J(512360731,801,50,"DocNotifyClient.PerformCall - {0} - requestID not matched.",this.e3)}x1f(a,b){return this.SV&&(a>=this.rzb||b>this.O3.getHostSessionInfoMaxRetryCount)?(ya.a.J(512360725,801,15,"DocNotifyClient.PerformCall - {0} - Failed enough times, for a time long enough. FailureCount:{1}, PopSessionId:{2}, PopSessionInitialized:{3}",
this.e3,b,this.Xa.tk,this.Ue.Xz),!0):!1}close(a){ya.a.J(512360724,801,50,"DocNotifyClient.Close - {0} - Reason: {1}",this.e3,a);this.Aja=!0;this.lUa&&this.lUa.xkd()}Sic(a){const b=Mc.a.hm(this.e3,2);b.Wa("DelayInMS",a.toString());this.c3j?Mc.a.Z9(()=>{Mc.a.LE(b,Object(D.a)(this,this.c4g,"performCall"))},a,0):window.setTimeout(()=>{Mc.a.LE(b,Object(D.a)(this,this.c4g,"performCall"))},a)}c4g(){if(!this.enabled||u.AFrameworkApplication.Xg||this.TEa&&+new Date-+this.TEa<this.lzb||this.SV&&!this.hc.BK||
this.o8.HSc)ya.a.J(512360723,801,50,"DocNotifyClient.PerformCall - {0} - Skipped. Enabled:{1}, IsShuttingDown:{2}, LastCallStartTime:{3}, Now:{4}, PerformCallExpireTimeInMs:{5}, IsNonDismissibleDialogShown:{6}, AppInReadMode:{7}, AppInReadModeAndCanNotEditAnyway:{8}",this.e3,this.enabled,u.AFrameworkApplication.Xg,this.TEa?Mc.a.Ye(this.TEa):"null",Mc.a.Ye(new Date),this.lzb,this.o8.HSc,!this.hc.ln,!this.hc.BK);else{var a=lh.a.create().toString();ya.a.J(512360722,801,50,"DocNotifyClient.PerformCall - {0} - Executed, LastCallStartTime:{1}, Now:{2}, PerformCallExpireTimeInMs:{3}, PopSessionId:{4}, CorrelationId:{5}",
this.e3,this.TEa?Mc.a.Ye(this.TEa):"null",Mc.a.Ye(new Date),this.lzb,this.SV?this.Xa.tk:"Not Applicable",a);if(!this.SV){var b=vj.e(this.vyb,x=>x.KeyRoot===Uf.a.f6g);b&&b.length&&ya.a.J(512360721,801,50,"Getupdates. CurrentTimestamp:{0}",b[0].TimeStamp)}this.TEa=new Date;b=Mc.a.Cb;var c=new qK(this,b,this.Xa,this.Kd,this.O3,this.SV?null:this.OW);this.dKg=c.id;this.lUa=new lQ.a;var f=this.SV?this.Xa.tk:"",l=this.SV?"":this.Xa.podSessionId;b.Wa(ri.a.qpb,a);this.W9j(f,this.Xa.presentationId.string,this.vyb,
x=>{c.poj(x,f)},x=>{c.ooj(x,f,l)},this.lUa,{["X-CorrelationId"]:a},null,this.lzb)}}get enabled(){return 0<this.vyb.length&&!this.Aja}get SV(){return this.nOh}nlc(){this.Ue.Zea||this.Ue.Oec.task.continueWith(()=>{this.Rve()})}dWa(){this.qHa("PopSessionInitialized")}Pcb(){this.close("PopsUninitialized")}Rve(){this.Ue.Xz?this.qHa("PopSessionInitialized"):this.close("PopsUninitialized");this.nlc()}Jjc(a){a||(a=[]);ya.a.J(512360719,801,50,"DocNotifyClient.SetSubscriptions - {0} - {1} subscriptions.",this.e3,
a.length);for(const b of a);this.vyb=a;this.XEa=new Date;this.nAb=this.zTa=0;this.SV&&!this.Ue.Zea&&this.nlc();this.Sic(0)}CCf(a){Array.add(this.EW,a)}bva(){this.qHa("AppListener:OnReboot")}qHa(a){ya.a.J(512360718,801,50,"DocNotifyClient.Reboot - {0} - Reason: {1}, PopSession: {2}",this.e3,a,this.SV?this.Xa.tk:"Not Applicable");this.SV&&"PopSessionInitialized"===a&&this.OTk();this.Aja=!1;this.TEa=null;this.XEa=new Date;this.nAb=this.zTa=0;this.lUa&&this.lUa.xkd();this.Sic(0)}OTk(){for(const a of this.vyb)a.TimeStamp=
0}dispose(){this.Mc.gea(Object(D.a)(this,this.uL,"onSessionClosed"));this.Mc.WDe(Object(D.a)(this,this.Kda,"onSessionRehydrating"));this.Mc.hea(Object(D.a)(this,this.jo,"onSessionRehydrated"));this.SV&&this.Ue.Zea&&(this.Mc.jdh(Object(D.a)(this,this.Pcb,"onPopSessionClosed")),this.Mc.UDe(Object(D.a)(this,this.dWa,"onPopSessionInitialized")))}}Object(e.a)(nD,"DocNotifyClient",null,[352,106,353,608]);class oD{constructor(){this.VUc=0}}Object(e.a)(oD,"TimeStampData",null,[]);class rK{constructor(){this.cEa=
{}}reset(){this.cEa={}}copy(a){this.reset();a=a.cEa;for(let f in a){var b=f,c=a[f];const l=new oD;l.VUc=c.VUc;this.cEa[b]=l}}Atl(a,b){var c=a in this.cEa?this.cEa[a]:new oD;this.cEa[a]=c;c=this.cEa;for(let l in c){var f=c[l];l.startsWith(a)&&(f.VUc=b)}}uZd(a){return a in this.cEa?this.cEa[a].VUc:0}}Object(e.a)(rK,"HermesContentTimeStampManager",null,[354]);var Fx=d(320);class Gx{constructor(a,b,c,f=null){this.i9d=a;this.vda=b;this.acc=c;this.Ba=f}}Object(e.a)(Gx,"SlideMoveData",null,[]);var mQ=d(633),
Ij=d(318);class sK{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){this.A7b=this.ata=null;this.US=0;this.hF=null;this.Sie=0;this.SWc=null;this.Cje=this.B_c=this.PHg=this.RHg=0;this.nN=this.MFa=this.rW=null;this.Jka=this.J_c=0;this.Wp=a;this.Fa=b;this.ia=c;this.Yb=f;this.ta=l;this.Bt=x;this.yc=F;this.hc=R;this.Gt=fa;this.n_=this.Wp.jX;this.R$a=wa;this.ra=Xa;this.qq=lb;this.Sp=Lb;this.Esa=kc}Kwj(){this.US=-1;this.ata=document.createElement("div");this.ata.style.visibility=Ve.a.Us;this.ata.className=
Ij.a.AIi;this.n_.appendChild(this.ata);this.Sie=this.Jka=this.J_c=0;if(this.Esa){this.A7b=document.createElement("div");this.A7b.className=Ij.a.nij;const a=document.createElement("span");a.className=Ij.a.oij;this.A7b.appendChild(a)}}dispose(){this.n_.removeChild(this.ata);this.Bt.hE(this.n_,this);this.ata=this.hF=null}Wu(a){return a?this.gI(a).returnValue:!1}gI(a){var b=null;if(3===a.Vf||a.Sz!==Sys.UI.MouseButton.leftButton||!this.n_.contains(a.Fc)||!this.hc.ln)return{returnValue:!1,iqb:b,D2:null};
var c=a.clientPoint.y-this.lQe+this.n_.scrollTop;b=a.clientPoint.x-this.n_.offsetLeft;this.Gt&&(b-=this.n_.offsetWidth-this.n_.clientWidth);b=this.Cfj(b,c);if(!b||!b.NV)return{returnValue:!1,iqb:b,D2:null};if(this.Esa){a=this.ra.mf();if(1>a.length)return{returnValue:!1,iqb:b,D2:null};for(var f of a)if(f.dN||32!==this.ia.Ka(ba.a.oBe,1,f.Bb))return{returnValue:!1,iqb:b,D2:null};f=this.Wp.o0-this.ra.mf().length+1;this.PHg=Math.min(this.a7f(c),f);this.RHg=Math.min(b.slideIndex,f-1)}else if(c=b.slideId,
oe.a.xz(c)||32!==this.ia.Ka(ba.a.oBe,1,c))return{returnValue:!1,iqb:b,D2:null};return{returnValue:!0,iqb:b,D2:null}}su(a){if(!a)return!1;this.ata||this.Kwj();this.SWc=mQ.a(0,0);if(!({iqb:this.rW,D2:F}=this.gI(a)).returnValue)return!1;if(this.Sp){var b=!1,c=this.rW.slideId,f=this.ra.mf();for(var l of f)if(l.Bb.equals(c)){b=!0;break}if(b){if(this.nN=this.ta.Ba,1<f.length&&!this.Esa)return!1}else this.ra.Ph(),this.nN=this.rW.Nd,this.ra.DX(this.rW.Nd)}if(this.Esa){this.oCh();var x=this.rW.p2b;var F=x.cloneNode(!0);
b=F.getElementsByTagName("img")[0];this.Jkh(b,Ij.a.f2d,Ij.a.e2d,Ij.a.A3f,Ij.a.A3f);F.className=Ij.a.Qfg;c=this.ra.mf();f=1;if(1<c.length){for(l=0;l<c.length;l++)if(this.rW.slideIndex!==c[l].slideIndex){f++;x=this.Wp.v2(c[l].slideIndex).p2b;x=(x=x.getElementsByTagName("img"))&&0<x.length?x[0].cloneNode(!0):b.cloneNode(!0);const R=Ij.a.e2d*f;this.Jkh(x,Ij.a.f2d-f,Ij.a.e2d-1,R,R);F.appendChild(x);if(3===f)break}F.appendChild(this.A7b);this.A7b.firstChild.innerText=this.ra.mf().length.toString()}this.hF?
this.Wp.jX.replaceChild(F,this.hF):this.Wp.jX.appendChild(F);this.hF=F}else b=this.rW.p2b,this.hF?(b=this.hF.getElementsByTagName("img"),F=F.cloneNode(!0),F.style.zIndex=String(Ij.a.f2d),this.hF.replaceChild(F,b[0]),this.hF.style.zIndex=String(Ij.a.lij)):(this.hF=b.cloneNode(!0),this.Wp.jX.appendChild(this.hF),this.hF.className=Ij.a.Qfg);this.Sie=parseInt(Vg.a.Ru(this.hF).height);Xe.a.Dma(this.hF,Ij.a.A2g+Ij.a.X1g+Ij.a.xmg,this.Gt);this.hF.style.visibility=Ve.a.Uy;this.hF.style.cursor=Ve.a.hlc;u.AFrameworkApplication.Qj("Microsoft.Office.Server.Powerpoint.Web.IPptSlideReorderingImprovementSettings");
ya.a.J(512497671,819,50,"PPT drag slide start.");this.aw(a);return!0}oCh(){this.B_c=this.PHg;this.Cje=this.RHg;let a=0;for(let b=0;b<this.Wp.o0;b++){const c=this.Wp.v2(b);c.isSelected?c.Tld(-2):(a===this.rW.slideIndex&&(a+=1),c.Tld(a),a++)}}Jkh(a,b,c,f,l){a.className=Ij.a.kij;a.style.zIndex=String(b);a.style.borderWidth=c.toString()+"px";a.style.top=f.toString()+"px";a.style.left=l.toString()+"px"}aw(a){if(!a)return!1;var b=a.clientPoint,c=b.y-this.lQe+this.n_.scrollTop,f=this.Sie/2;if(this.R$a){if(n.a.AS&&
!a.lc.rawEvent.buttons)return ya.a.J(512497670,819,50,"PPT cancel drag slide in IE/Edge because release mouse button outside of the browser window."),!1;this.hF.style.top=Math.min(c-f,this.Esa?Fx.a.i5+(this.Wp.o0-this.ra.mf().length)*this.Wp.PAa:Fx.a.i5+this.Wp.o0*this.Wp.PAa)+"px"}else{a=this.U0b(this.Wp.o0)+this.Wp.PAa/2;if(this.ZOi(b.x)||c>a)return this.mlh(),!0;this.hF.style.top=c-f+"px"}this.Ikh(!0);this.pki(b.y);this.w1k(Math.min(this.a7f(c),this.Esa?this.Wp.o0-this.ra.mf().length+1:this.Wp.o0));
this.ata.style.visibility=this.dTc(b)&&!this.Esa?Ve.a.Uy:Ve.a.Us;if(this.Esa&&0<=this.US)if(this.dTc(b)){this.hF.style.visibility=Ve.a.Uy;if(this.B_c===this.US)return!0;b=this.B_c<this.US?0>this.US-1?0:this.US-1:0>this.US?0:this.US;c=0;for(f=0;f<this.Wp.o0;f++)a=this.Wp.v2(f),a.isSelected||(c<b?a.Tld(c):a.Tld(c+1),c++);this.B_c=this.US;this.Cje=b}else this.oCh(),this.hF.style.visibility=Ve.a.Us;return!0}Ln(a){if(!this.ta.presentation)throw Error.argumentNull("Presentation is null");var b=a.clientPoint;
if(this.Esa){if(a=this.ra.mf(),0<a.length&&0<=this.US&&this.dTc(b)){b=[];for(const c of a)c&&b.push(Object(va.a)(122,c));this.Tll(b,this.$cj(this.Cje));ya.a.J(512497669,819,50,"PPT drag slide succeed.")}}else 0<=this.US&&this.rW&&this.dTc(b)&&this.rW.slideIndex!==this.US&&this.rW.slideIndex+1!==this.US&&(this.Oll(this.rW.slideIndex,this.US),ya.a.J(512497668,819,50,"PPT drag slide succeed."));this.$J()}$cj(a){let b=0;for(let c=0;c<this.Wp.o0;c++)if(!this.Wp.v2(c).isSelected&&(b++,a===b))return c+1;
return 0}dTc(a){a=a.x>=this.n_.offsetLeft&&a.x<=this.n_.offsetLeft+this.n_.offsetWidth;return!this.R$a||a}Nt(){this.$J()}Cfj(a,b){if(!this.Wp.PAa)return null;var c=Math.floor((b-Fx.a.i5)/this.Wp.PAa);if(0<=c&&c<=this.Wp.o0-1){c=this.Wp.v2(c);if(!c)return null;const f=c.nIb;a=this.Gt?a-parseInt(f.style.right.replace("px","")):a-parseInt(f.style.left.replace("px",""));b-=parseInt(f.style.top.replace("px",""));if(0<=a&&0<=b&&a<=f.clientWidth&&b<=f.clientHeight)return c}return null}ZOi(a){return this.Gt?
this.SWc.width-Ij.a.aYf>a||this.SWc.width<a:0>a||Ij.a.aYf<a}pki(a){const b=a-this.lQe,c=this.SWc.height;if(Ij.a.fHf>b)this.Jka=-Ij.a.eHf;else if(Ij.a.hHf>b)this.Jka=-Ij.a.gHf;else if(Ij.a.jHf>b)this.Jka=-Ij.a.iHf;else if(c-Ij.a.fHf<a)this.Jka=Ij.a.eHf;else if(c-Ij.a.hHf<a)this.Jka=Ij.a.gHf;else if(c-Ij.a.jHf<a)this.Jka=Ij.a.iHf;else{this.Jka=0;return}this.b4g()}b4g(){if(0!==this.Jka){const a=this.J_c,b=(new Date).getTime();0<a&&(this.n_.scrollTop=Math.max(0,this.n_.scrollTop+Math.floor((b-a)*this.Jka/
1E3)));this.J_c=b;window.setTimeout(Object(D.a)(this,this.b4g,"performAutoScrolling"),Ij.a.Gai)}else this.J_c=0}U0b(a){return this.Wp.PAa*a+Fx.a.i5*(this.R$a?.75:1)}a7f(a){a+=this.Wp.PAa/2;a-=Fx.a.i5;a=Math.floor(a/this.Wp.PAa);return this.R$a?Math.max(0,a):a}w1k(a){this.US!==a&&(this.US=a,0>this.US||(this.ata.style.top=Xe.a.Lc(this.U0b(a))))}mlh(){this.Ikh(!1)}Ikh(a){this.hF.style.cursor=a?Ve.a.hlc:Ve.a.Ohl}Oll(a,b){const c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");
if((this.MFa=Pa.a.clone(this.ta.presentation.LL))&&!(b>this.MFa.length||a>=this.MFa.length)){var f=null;a=c.L0d(a);b&&(f=c.L0d(b-1));b=new Gx(!1,[a],f);this.ia.Ka(ba.a.gcc,2,b)}}Tll(a,b){const c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");!(this.MFa=Pa.a.clone(this.ta.presentation.LL))||b>this.MFa.length||!this.MIj(a,b)||(b=b?c.L0d(b-1):null,a=new Gx(!1,a,b,this.nN),this.ia.Ka(ba.a.gcc,2,a))}MIj(a,b){const c=Object.assign(new Ha.a,{});for(var f=0;f<a.length;f++)c.add(a[f].slideIndex);
c.Sc((l,x)=>l-x);a=c.count;for(f=0;f<a-1;f++)if(1!==c.ga(f+1)-c.ga(f))return!0;return c.ga(0)<=b&&c.ga(a-1)+1>=b?!1:!0}$J(){this.Gsl();this.mlh();this.hF.style.visibility=Ve.a.Us;this.hF.style.top="0px";this.hF.style.cursor=Ve.a.aA;this.ata.style.visibility=Ve.a.Us;if(this.Esa){const a=this.qq.je(3);try{const b=this.ta.presentation;if(!b)throw Error.argumentNull("Presentation is null");a.fd(b);a.oIa(this.Wp.Ma);const c=b.slides||[];for(const f of c){const l=Object(va.a)(123,f);l&&l.anchor.Oj(this.Wp.Ma,
16)}}finally{a&&a.dispose()}this.Wp.Yeb()}this.Jka=0;this.rW&&(this.rW=null);this.Fa.ye&&this.Fa.ye.name===Nc.a.dE||this.Fa.Bf(Nc.a.dE)}Gsl(){this.Sp?this.nN&&(this.Yb.Ba=this.yc.$k(this.nN.Bb)):this.rW&&(this.Yb.Ba=this.rW.Nd)}get lQe(){let a=this.n_,b=0;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b}}Object(e.a)(sK,"ThumbnailNavPaneDragAdapter",null,[362,239,106]);class pD{}pD.HYh=[ba.a.print,ba.a.find,ba.a.A4,ba.a.O4a,ba.a.x$c,ba.a.w$c,ba.a.bringForward,ba.a.bringToFront,ba.a.sendBackward,ba.a.sendToBack,
ba.a.jha,ba.a.Gjd,ba.a.Hjd,ba.a.WYa,ba.a.VYa,ba.a.ehb,ba.a.dhb,ba.a.rYa,ba.a.mHb,ba.a.bJb,ba.a.Wic,ba.a.Aea,ba.a.h0,ba.a.O7a,ba.a.mgb,ba.a.ngb,ba.a.ogb,ba.a.pgb,ba.a.nic,ba.a.oic,ba.a.pic,ba.a.qic,ba.a.Odd,ba.a.Eic,ba.a.CFe,ba.a.Pdd,ba.a.I3a,ba.a.H5a,ba.a.Sha,ba.a.XXa,ba.a.YXa,ba.a.ZXa,ba.a.Wjc,ba.a.JGb,ba.a.mGb,ba.a.GGb,ba.a.Ifb,ba.a.Vfb,ba.a.JM,ba.a.bS,ba.a.kla,ba.a.pcb,ba.a.mcb,ba.a.ocb,ba.a.ncb,ba.a.Ddb,ba.a.Cdb,ba.a.Lek,ba.a.Zzk,ba.a.yoi,ba.a.zoi,ba.a.mse,ba.a.nse,ba.a.ose,ba.a.pse,ba.a.bqk,
ba.a.gpi,ba.a.deleteComment,ba.a.Jtb,ba.a.rQc,ba.a.hSk,ba.a.Mek,ba.a.$zk,ba.a.imc,ba.a.cmc,ba.a.emc,ba.a.dmc,ba.a.hmc,ba.a.gmc];Object(e.a)(pD,"ActionHandledList",null,[]);class Ms{constructor(a,b,c,f){this.v_=new $g.a;this.Yoe=new $g.a;this.ia=a;this.Ga=b;this.ra=c;this.fh=f;this.mwj();this.nwj()}Nlj(a,b,c=null){this.Ga.remapShapeEditCommandEnabled&&((this.ra.uG()||this.ra.ku())&&this.v_.Jb(a)?a=this.v_.ga(a):this.ra.lD()&&this.Yoe.Jb(a)&&(a=this.Yoe.ga(a)));if(this.Ga.podsTableRTTEnabled&&this.Ga.podsTableCellLockEnabled&&
Array.contains(Ms.yWk,a)&&(this.ra.L7()||this.ra.wIj()))return 32;if(!Array.contains(pD.HYh,a))return this.ia.Ka(a,2,b,c);const f=this.ia.gq,l=this.ia.vS;let x=this.ia.Ka(a,1,b);32===x&&(this.Ga.pptDragCancelFix&&(this.ia.gq=f,this.ia.vS=l),x=this.ia.Ka(a,2,b,c));return x}X8k(a){return this.fh.Iqb!==a&&this.fh.Jqb!==a}Zqb(a,b,c){return b&&b.name===Nc.a.yg&&!this.ra.ku()&&1===this.ra.ae().length&&this.ra.lD()&&this.X8k(c)?a.Zqb(a.Bc(b.parent),c):a.Zqb(b,c)}mwj(){this.v_.$(C.a.upArrow,ba.a.pgb);this.v_.$(C.a.downArrow,
ba.a.mgb);this.v_.$(C.a.leftArrow,ba.a.ngb);this.v_.$(C.a.rightArrow,ba.a.ogb);this.v_.$(C.a.LGb,ba.a.qic);this.v_.$(C.a.Xfb,ba.a.nic);this.v_.$(C.a.gYa,ba.a.oic);this.v_.$(C.a.hYa,ba.a.pic);this.v_.$(C.a.Eqa,ba.a.Wic);this.v_.$(C.a.LVa,ba.a.ehb);this.v_.$(C.a.KVa,ba.a.dhb);this.v_.$(ba.a.jha,ba.a.MTb);for(const a of Ms.QWk)this.v_.$(a,G.a.ze)}nwj(){for(const a of Ms.RWk)this.Yoe.$(a,G.a.ze)}}Ms.QWk=[C.a.wAa,C.a.xAa,C.a.PWb,C.a.Dpb,C.a.eOa,C.a.fOa,C.a.k4a,C.a.dOa,C.a.lcb,C.a.dPa,C.a.f5a,C.a.kcb,C.a.cPa,
C.a.e5a];Ms.RWk=[ba.a.O4a,ba.a.H5a,ba.a.Sha,ba.a.bJb];Ms.yWk=[C.a.backspace,C.a.eK,ba.a.I3a];Object(e.a)(Ms,"ProcessInputStrategy",null,[359]);class tK{get ADc(){return[361033,9175267,13924352,749464,2893476,15559503,11745730,8880899,3750201,748043,12084359,1837941,7632250,9195008,3036814,8288617,9967496,7363328]}}Object(e.a)(tK,"PPTColorTable",null,[351]);var nQ=d(928);class uK{constructor(){this.n2c={}}lYd(a){return a&&a in this.n2c?this.n2c[a]:null}JIf(a,b){a&&b&&a!==b&&(a in this.n2c||(this.n2c[a]=
b))}}Object(e.a)(uK,"PresenceEmailConverter",null,[422]);class qD{constructor(){this.rpe=new qd.a}Dbd(a){this.rpe.raiseEvent("SPC",a)}P2a(a){this.rpe.addHandler("SPC",a)}YDe(a){this.rpe.removeHandler("SPC",a)}}Object(e.a)(qD,"PresenceEventSource",null,[424,425,426]);var Hx;(function(a){a[a.appInitInteractivityReady=0]="appInitInteractivityReady";a[a.appInitChromeReady=1]="appInitChromeReady";a[a.B2I=2]="B2I";a[a.fHasTabSwitch=3]="fHasTabSwitch";a[a.presentationIdReady=4]="presentationIdReady";a[a.earlyDownloadEditorTableCount=
5]="earlyDownloadEditorTableCount";a[a.earlyDownloadEditorTable=6]="earlyDownloadEditorTable";a[a.firstCoauthoringStatus=7]="firstCoauthoringStatus";a[a.presenceJsLoadStart=8]="presenceJsLoadStart";a[a.peoplesWellPackageRegister=9]="peoplesWellPackageRegister";a[a.peoplesWellPackageConfig=10]="peoplesWellPackageConfig";a[a.peoplesWellInit=11]="peoplesWellInit";a[a.peoplesWellInited=12]="peoplesWellInited";a[a.peopleWellPageHiddenDuration=13]="peopleWellPageHiddenDuration";a[a.peoplesWellControlViewRefresh=
14]="peoplesWellControlViewRefresh";a[a.peoplesWellUpdateTriggered=15]="peoplesWellUpdateTriggered";a[a.peoplesWellUpdateTriggeredAfterChromeReady=16]="peoplesWellUpdateTriggeredAfterChromeReady";a[a.peoplesWellDisplayed=17]="peoplesWellDisplayed";a[a.jquerySignalRLoadStart=18]="jquerySignalRLoadStart";a[a.jquerySignalRLoadEnd=19]="jquerySignalRLoadEnd";a[a.presence1JsLoadStart=20]="presence1JsLoadStart";a[a.presencePackageRegister=21]="presencePackageRegister";a[a.presencePackageConfigure=22]="presencePackageConfigure";
a[a.presencePackageInitInternalStart=23]="presencePackageInitInternalStart";a[a.presencePackageInit=24]="presencePackageInit";a[a.presencePackageInited=25]="presencePackageInited";a[a.usedEarlyFindSessionResult=26]="usedEarlyFindSessionResult";a[a.startRTCConnection=27]="startRTCConnection";a[a.rtcConnected=28]="rtcConnected";a[a.rehydrationCount=29]="rehydrationCount";a[a.presenceCount=30]="presenceCount";a[a.presenceDisplayed=31]="presenceDisplayed";a[a.presencePageHiddenDuration=32]="presencePageHiddenDuration";
a[a.presenceUpdateNotificationReceived=33]="presenceUpdateNotificationReceived";a[a.presenceUpdateProcessed=34]="presenceUpdateProcessed";a[a.presenceFirstMessageSent=35]="presenceFirstMessageSent";a[a.coauthoringStartTime=36]="coauthoringStartTime";a[a.isSecondUser=37]="isSecondUser";a[a.getFirstPresenceStateUserCount=38]="getFirstPresenceStateUserCount";a[a.receivedCompletePeristentState=39]="receivedCompletePeristentState";a[a.networkConnectivityLoss=40]="networkConnectivityLoss"})(Hx||(Hx={}));
Object(e.b)("EntryName",Hx);class vK{constructor(a,b,c,f){this.zo=null;this.Pne=this.d1c=0;this.gle=this.iIg=this.uke=this.h_c=!1;this.ode=this.pde=this.fje=this.Fde=this.Bie=0;this.VWc=this.Ige=null;this.u1c=new Wj.a;this.fNg=new Wj.a;this.pMg=new Wj.a;this.whe=this.Bhe=!1;this.f$b=a;this.uoe=b;this.rj=c;f.execute(l=>{this.zo=l});this.NW={};io.Task.WAA(this.rj.eAa,this.u1c.task,this.fNg.task).continueWith(()=>{try{this.jkh(),this.MHc(this.NW),0<xa.a.count(this.NW)&&Z.ULS.sendTraceTag(51242144,814,
15,xa.a.toJSON(this.NW)),this.Bhe=!0}catch(l){Z.ULS.sendTraceTag(51242145,814,10,l.toString())}});io.Task.WAA(this.rj.eAa,this.pMg.task).continueWith(()=>{try{this.jkh(),this.MHc(this.NW),0<xa.a.count(this.NW)&&Z.ULS.sendTraceTag(594879178,814,15,xa.a.toJSON(this.NW)),this.whe=!0}catch(l){Z.ULS.sendTraceTag(594879177,814,10,l.toString())}});this.GXc={};this.Hie={}}yLi(a){this.dzc(a,8,"g_hermesPresenceJS");this.dzc(a,20,"g_hermesPresence1JS");this.dzc(a,18,"g_JquerySignalRMergeJS");this.dzc(a,19,"g_JquerySignalRMergeJSEnd")}dzc(a,
b,c){b=Hx[b];b in a||(c=this.h5i(c),0<c&&this.Ega(a,b,c))}h5i(a){a=window[a];return void 0===a||null===a?-1:a.getTime()}dispose(){this.c4f();this.qTi();this.zzh();this.NW=this.Hie=this.GXc=null}ILi(){this.ipa(25)}HLi(){this.ipa(12)}bXj(){this.ipa(15);0<this.appInitChromeReady&&this.ipa(16)}CLi(a){try{this.d1c||(this.d1c=a,this.Rh(17,this.d1c),this.Rh(13,this.e$f(this.B2I,this.d1c)),this.pMg.TL(!0))}catch(b){Z.ULS.sendTraceTag(594879176,814,10,b.toString())}}EVj(a,b){this.Rh(6,a);this.Rh(5,b)}DLi(){this.Pne||
(this.Pne=Date.now(),this.Rh(31,this.Pne),this.c4f())}ELi(){this.ipa(28)}FLi(){this.ipa(27)}GLi(){this.ipa(40)}Ssk(a){const b=[];for(let f in a){var c=a[f];c&&Array.add(b,c.Presence)}return b}JLi(a){a&&(a=this.Ssk(a),this.Rh(38,a.length),this.Rh(37,0<a.length),this.ipa(39));this.fNg.Bg(!0)}WVj(a){try{this.u1c.task.isCompleted||xa.a.Va(a)||(this.ipa(34),this.u1c.TL(!0))}catch(b){Z.ULS.sendTraceTag(51242146,814,10,b.toString())}}XVj(a){if(!(xa.a.Va(a)||"presenceUpdateNotificationReceived"in this.NW)){var b=
Date.now();this.Rh(33,b);this.fje=this.e$f(this.B2I,b);this.Rh(32,this.fje);this.Rh(30,xa.a.count(a));this.zo&&this.Rh(29,this.zo.Q1f)}}dPi(){return!this.u1c.task.isCompleted&&(!this.zo||!this.zo.Q1f)&&!this.fje}VVj(){this.ipa(35);this.rj.kJc&&this.Rh(36,this.rj.kJc.getTime())}XLi(){this.uoe&&!this.h_c&&(this.h_c=!0,this.uoe.gCf(Object(D.a)(this,this.sdc,"onResourceTimingEntriesAvailable")))}sdc(a,b){try{a={};for(let c=0;c<b.entries.length;c++){const f=b.entries[c],l=cg.a.bma(f.url);!this.uke&&l.endsWith("rtc2/signalr/negotiate")?
(this.uke=!0,this.vzc(a,"Negotiate",f.bB)):l.endsWith("rtc2/signalr/connect")?(this.iIg=!0,this.vzc(a,"Connect",f.bB)):!this.gle&&l.endsWith("rtc2/signalr/start")?(this.gle=!0,this.vzc(a,"Start",f.bB)):l.endsWith("rtc2/findsession")&&(this.vzc(a,this.Bie.toString()+"_FindSession",f.bB),this.Bie++)}if(this.uke||this.iIg||this.gle||0<this.Bie)this.zzh(),this.b4f(a)}catch(c){Z.ULS.sendTraceTag(51242147,814,10,c.toString())}}vzc(a,b,c){this.Ega(a,b+"FS",c.fetchStart);this.Ega(a,b+"RS",c.responseStart);
this.Ega(a,b+"RE",c.responseEnd)}zzh(){this.h_c&&(this.h_c=!1,this.uoe.Gch(Object(D.a)(this,this.sdc,"onResourceTimingEntriesAvailable")))}ipa(a){this.Rh(a,Date.now())}Rh(a,b){this.i_h(Hx[a],b)}i_h(a,b){this.Ega(this.GXc,a,b);this.Ega(this.NW,a,b)}Ega(a,b,c){b in a||(a[b]=c)}MHc(a){this.yLi(a);this.Ega(a,"B2I",this.B2I);null!=this.fHasTabSwitch&&this.Ega(a,"fHasTabSwitch",this.fHasTabSwitch);null!=this.VWc&&this.Ega(a,"firstCoauthoringStatus",this.VWc);this.appInitInteractivityReady&&this.Ega(a,"appInitInteractivityReady",
this.appInitInteractivityReady);this.appInitChromeReady&&this.Ega(a,"appInitChromeReady",this.appInitChromeReady)}jkh(){null==this.VWc&&(this.VWc=this.rj.eAa.result)}c4f(){this.b4f({})}b4f(a){try{this.MHc(this.GXc),xa.a.forEach(this.GXc,(b,c)=>{b in this.Hie||(this.Hie[b]=c,a[b]=c)},null),0<xa.a.count(a)&&Z.ULS.sendTraceTag(41239941,828,50,xa.a.toJSON(a))}catch(b){Z.ULS.sendTraceTag(51242176,814,10,b.toString())}}qTi(){Z.ULS.sendTraceTag(51242177,814,100,"FlushRecords: m_fPresenceUpdateLogged={0}, m_fPeoplesWellDisplayed={1}",
this.Bhe,this.whe);if(!this.Bhe||!this.whe)try{this.MHc(this.NW),0<xa.a.count(this.NW)&&Z.ULS.sendTraceTag(51242178,814,50,xa.a.toJSON(this.NW))}catch(a){Z.ULS.sendTraceTag(51242179,814,10,a.toString())}}get B2I(){!this.Fde&&og.a.instance.Wn(Wh.a.contentEditable)&&(this.Fde=og.a.instance.Rg(Wh.a.contentEditable));return this.Fde}get appInitInteractivityReady(){!this.pde&&og.a.instance.Wn("AppInitStatus_interactivityReady")&&(this.pde=og.a.instance.Rg("AppInitStatus_interactivityReady"));return this.pde}get appInitChromeReady(){!this.ode&&
og.a.instance.Wn("AppInitStatus_chromeReady")&&(this.ode=og.a.instance.Rg("AppInitStatus_chromeReady"));return this.ode}get fHasTabSwitch(){null==this.Ige&&og.a.instance.Wn(Wh.a.ymd)&&(this.Ige=og.a.instance.Rg(Wh.a.ymd));return this.Ige}e$f(a,b){return this.f$b?this.f$b.xbg(new Date(a),new Date(b)):-1}}Object(e.a)(vK,"PresencePerfLogger",null,[356,106]);class wK{constructor(a,b,c){this.ZNg=this.F7b=this.YXc=this.Xka=null;this.dge=!1;this.Joe=null;this.Zh=a;this.O3=b;this.oq=c}NNc(){this.yqb();return this.Xka}$1i(){this.yqb();
return this.YXc}getFindSessionResponse(){return this.Zh?this.Zh.FindSessionResponse:null}a9f(){this.yqb();return this.F7b}Raj(){this.yqb();return this.ZNg}Paj(){this.yqb();return this.Joe}Egd(){this.yqb();return this.dge}$Wj(){if(this.Zh){const a=!!this.Zh.PresenceException,b=!isNaN(this.Zh.PresenceDownloadEditorTableHttpStatus)&&200!==this.Zh.PresenceDownloadEditorTableHttpStatus||!isNaN(this.Zh.PresenceFindSessionHttpStatus)&&200!==this.Zh.PresenceFindSessionHttpStatus,c={};c.EarlyFindSessionEnabled=
this.O3.presenceEarlyFindSessionEnabled;c.EditorCount=this.YXc?this.YXc.length:0;c.ShouldConnectToRtcByDefault=this.dge;c.EditorTableHttpStatus=this.Zh.PresenceDownloadEditorTableHttpStatus;c.FindSessionHttpStatus=this.Zh.PresenceFindSessionHttpStatus;c.CachedException=this.Zh.PresenceException;c.IsFindSessionResponseEmpty=!this.Zh.FindSessionResponse;c.IsEditorTableResponseEmpty=!this.Zh.CoauthHandlerResponse;c.RtcBootTokenContainsValue=!!this.Joe;ya.a.J(41501202,804,a||b?15:50,xa.a.toJSON(c))}}yqb(){if(this.Zh&&
!this.Xka)try{if(this.Zh.CoauthHandlerResponse){const a=Sys.Serialization.JavaScriptSerializer.deserialize(this.Zh.CoauthHandlerResponse);this.YXc=a.EditorTable;this.Xka=a.UserName;this.F7b=a.Email;this.ZNg=a.RtcEndpointUrl;this.dge=a.FConnectByDefault;this.Joe=a.RtcBootToken;this.oq.d_g()}}catch(a){ya.a.J(41501204,804,10,"PresencePrepCacheParser - caught exception when parse cache: "+a)}}}Object(e.a)(wK,"PresencePrepCacheParser",null,[365]);class rD{constructor(a,b,c,f=5E3){if(!a)throw Error.create("RTCParams : ClientId is null");
this.clientId=a;this.userSessionId=u.AFrameworkApplication.userSessionId;this.Vdd=u.AFrameworkApplication.Vdd;this.Maa=u.AFrameworkApplication.He;this.lw=b;this.Mjh=c;this.Igh=f}}Object(e.a)(rD,"RtcParams",null,[]);class xK{constructor(a,b,c){this.FYj=a;this.Goe=b;this.QVc=c}Gmi(a,b,c){Ba.a.$t(a);Ba.a.$t(b);Ba.a.$t(c)}XGd(a,b,c,f){return f=!a&&0>b?f+Math.abs(b):this.FYj?(c-b)/4:(c-b)/2}YGd(a,b,c){if(!this.QVc||!b)return c;if(0<=b.className.indexOf(mc.a.OM))if(b.previousSibling)b=b.previousSibling;
else return c;const f=this.oNc(b,aa.a.lVc),l=this.oNc(b,aa.a.CJc);if(isNaN(f)||!f||isNaN(l)||!l||f>=l)return c;const x=new Sys.UI.Bounds(c.x,c.y,c.width,c.height);if(f>=.9*l)return c=(l-f)/2,x.y+=c,x.height-=2*c,x;a=this.Jcj(b,a);if(isNaN(a)||!a)return c;c=(a-f)/2;x.y+=c;x.height-=2*c;return x}qdj(a,b){if(!this.QVc)return 0;a=this.oNc(a,aa.a.lVc);b=Math.ceil((a-b)/2);if(isNaN(b)||0>b)b=0;return b}Jcj(a,b){let c=Object(va.a)(423,b);b||(c=Object(va.a)(423,this.Goe.c0b(a)));if(c&&this.Goe.DDj(c))return this.oNc(a,
aa.a.CJc);b=0;const f=a.getClientRects();f&&0<f.length&&(b=f[0],b=new Sys.UI.Bounds(Math.floor(b.left),Math.floor(b.top),Math.floor(b.width),Math.floor(b.height)),b=this.Goe.Sea(b,c,()=>a.offsetWidth/a.offsetHeight).height);return b}oNc(a,b){let c=a;for(a=null;!a&&c&&"P"!==c.tagName;)a=L.a.re(c,b),c=0<=c.className.indexOf(mc.a.F5b)?c.previousSibling:c.parentNode;b=0;a&&(b=parseInt(a.toString(),10));return b}}Object(e.a)(xK,"PptMeasureBoundsUsingSpansStrategy",null,[360]);class sD{constructor(){this.TFa=
null}get Gbc(){return this.TFa?this.TFa.Gbc:0}get nkc(){return this.TFa?this.TFa.nkc:!1}get Igd(){return this.TFa?this.TFa.Igd:!1}WVb(a,b){b&&(this.TFa?this.TFa.WVb(a,b):b(null))}Ibi(a){this.TFa=a}}Object(e.a)(sD,"PPTProcessImageStrategyProxy",null,[419,420]);class tD{constructor(a,b){this.FRh=a;this.fgf=b}get Jrk(){return this.FRh}get dxe(){return this.fgf}L3k(a){this.fgf=a}}Object(e.a)(tD,"PageHiddenRecord",null,[]);class yK{constructor(){this.qka=[];ya.a.J(24440908,801,50,"Init PageHiddenMeter");
if(this.Eke=window.document.hidden){const a=new tD(new Date,new Date(9999,12,31));this.qka.push(a)}hb.a.instance.pb("Common.ITaskManager").Gb(new He.a(4,2,9E5,Object(D.a)(this,this.maintainPageHiddenRecords,"maintainPageHiddenRecords"),90,"2"));$addHandler(window,"visibilitychange",Object(D.a)(this,this.onVisibilityChange,"onVisibilityChange"))}xbg(a,b){const c=this.qka.length;let f=0;if(0<c&&a<this.qka[c-1].dxe){a=a.getTime();b=b.getTime();for(let l=0;l<c;++l){const x=Math.max(this.qka[l].Jrk.getTime(),
a),F=Math.min(this.qka[l].dxe.getTime(),b);x<F&&(f+=F-x)}}return f}onVisibilityChange(){ya.a.J(24440910,801,50,"Page hidden: {0}",window.document.hidden);this.TIk()}TIk(){var a=window.document.hidden,b=new Date;this.Eke!==a&&((this.Eke=a)?(b=new tD(b,new Date(9999,12,31)),this.qka.push(b)):(a=this.qka.length,0<a&&this.qka[a-1].L3k(b)))}maintainPageHiddenRecords(){const a=new Date;for(;0<this.qka.length&&9E5<+a-+this.qka[0].dxe;)Array.removeAt(this.qka,0)}}Object(e.a)(yK,"PageHiddenMeter",null,[350]);
class uD{D4(a){let b=ba.a.vz(a);return b||(b=C.a.vz(a))?b:(b=G.a.vz(a))?b:""}}Object(e.a)(uD,"ActionNameResolver",null,[418]);class vD{constructor(){this.va=new qd.a}hEk(){this.va.raiseEvent("CIU",Sys.EventArgs.Empty)}iEk(a){this.va.raiseEvent("CSC",a)}xEk(a){this.va.raiseEvent("ETC",a)}u$g(a){this.va.raiseEvent("TLSC",a)}yGk(a){this.va.raiseEvent("TCVEL",a)}yFk(){this.va.raiseEvent("PRTCC",null)}cFk(){this.va.raiseEvent("LCK",null)}eGd(a){this.va.addHandler("CSC",a)}GDe(a){this.va.removeHandler("CSC",
a)}fGd(a){this.va.addHandler("ETC",a)}Fch(a){this.va.removeHandler("ETC",a)}V5h(a){this.va.addHandler("TLSC",a)}UQk(a){this.va.removeHandler("TLSC",a)}O5h(a){this.va.addHandler("TCVEL",a)}P4h(a){this.va.addHandler("PRTCC",a)}kdh(a){this.va.removeHandler("PRTCC",a)}f3h(a){this.va.addHandler("LCK",a)}}Object(e.a)(vD,"CoauthEventSource",null,[415,416,417]);class wD{constructor(){this.va=new qd.a}oGk(){var a=new Sys.EventArgs;this.va.raiseEvent("OnShowHideAltTextPane",a)}OEk(a){this.va.raiseEvent("OnImageDescriptionReady",
a)}CEk(a){this.va.raiseEvent("FRHRE",a)}bEk(a){this.va.raiseEvent("APIRE",a)}VEk(a){this.va.raiseEvent("IMARE",a)}y4h(a){this.va.addHandler("OnShowHideAltTextPane",a)}$Pk(a){this.va.removeHandler("OnShowHideAltTextPane",a)}X3h(a){this.va.addHandler("OnImageDescriptionReady",a)}GPk(a){this.va.removeHandler("OnImageDescriptionReady",a)}Q3h(a){this.va.addHandler("FRHRE",a)}BPk(a){this.va.removeHandler("FRHRE",a)}q3h(a){this.va.addHandler("APIRE",a)}lPk(a){this.va.removeHandler("APIRE",a)}$3h(a){this.va.addHandler("IMARE",
a)}IPk(a){this.va.removeHandler("IMARE",a)}}Object(e.a)(wD,"CoreExtEventSource",null,[412,413,414]);var zK=d(994);class xD extends zK.a{constructor(a,b,c,f,l,x,F){super(f,c,a,x,F);this.FWc=new Me.a(0);this.dTa=b;this.Yle=l}bwj(a,b){let c;(c=this.FWc).$(b,c.ga(b)+1);this.QZf(a.name,Object(D.a)(this,this.Nlg,"initPackageCallback"),a)}cwj(a,b){let c;(c=this.FWc).$(b,c.ga(b)+1);this.RZf(a.name,Object(D.a)(this,this.Nlg,"initPackageCallback"),1,a)}Nlg(a){a.awj()}xph(a,b){return!!a&&!!b&&a.context.aJf!==
b.context.aJf}$ue(a,b){if(b>=this.Yle){const c=new Sys.StringBuilder;for(let f=0;f<a.length;++f)0<f&&c.append(","),c.append(String.format('{{"N":"{0}","D":{1}}}',a[f].name,Md.a.vX(a[f].duration,0)));Z.ULS.sendTraceTag(39966927,813,50,"{0}:{1}",c.toString(),Md.a.vX(b,0))}}onIdle(a){const b=[];this.FWc.forEach((c,f)=>{0<f&&(b.push(c),this.FWc.$(c,0),this.dTa.IVc(c));return!0});Z.ULS.sendTraceTag(39966928,813,50,"[{0}]:{1}",b.join(","),Md.a.vX(a,0))}}Object(e.a)(xD,"DelayLoadedPackageInitializer",zK.a,
[]);class Ix{constructor(a,b,c,f,l,x,F,R,fa){this.kpe=this.jpe=null;this.Ga=a;this.wI=b;this.oq=c;this.rj=f;this.ia=l;this.uI=x;this.Nb=F;this.fe=fa;this.h8j=R;this.wI.fGd(Object(D.a)(this,this.RYf,"editorTableUpdate"))}dispose(){this.wI.Fch(Object(D.a)(this,this.RYf,"editorTableUpdate"))}RYf(){const a=this.rj.bZ;this.t_f();this.oq.iTc&&(ya.a.J(512496593,814,50,"App::EditorTableUpdate; Refresh Peoples well; MyClientId: {0}; new editor table count: {1}",this.rj.hC,a.length),this.ia.processAction(G.a.P3a,
2))}t_f(){if(!this.oq.iTc&&this.rj.hC){ya.a.J(23437903,814,50,"App::EnsurePresence; Presence not loaded yet. Ensure presence on editor table update");try{if(!this.Nb)throw Error.create("Presence is being loaded before the app frame");this.ool()}catch(a){ya.a.J(512496591,814,10,"App : EnsurePresence; Exception loading presence: {0}",a)}}}ool(){ya.a.J(512496590,814,50,"App::EnsurePresence: trigger download js");if(this.Ga.anc)hb.a.instance.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Iha("pptedit.presence",
null,()=>d.e(12).then(d.bind(null,1203)));else{const a=xz.a.create("pptedit.presence",this.szi(),()=>d.e(12).then(d.bind(null,1203)));Xi.a.wx(a)}}szi(){this.Tqh.HR((a,b)=>{this.h8j.I$d=b.succeeded});return[this.Tqh]}get Adl(){this.kpe||(this.kpe=this.xag());return this.kpe}get Tqh(){this.jpe||(this.jpe=this.pAi());return this.jpe}pAi(){return this.W6i()}W6i(){return TC.a.create(this.xag(),null,null,Gb.App.Mwg)}xag(){return this.Ga.podsUseVersionLessJqueryAndSignalR?this.fe.ehj("jquery.signalr.merge.1.1"+
Ix.qKd):u.AFrameworkApplication.Fk("jquery.signalr.merge.1.1",2)}}Ix.qKd=".min.js";Object(e.a)(Ix,"PresenceLoader",null,[]);class AK{constructor(a,b,c,f,l,x,F,R,fa){this.CEa=this.DEa=!1;this.Lja=this.Bja=null;this.Ga=a;this.Fx=b;this.sW=c;this.Ea=f;this.u$a=l;this.Nie=x;this.yb=F;this.SB=R;this.Ay=fa;this.A8=this.Ga.podsHtmlTextForEmbeddedFontsIsEnabled&&!!window.self.Promise&&this.u$a.dxg}ccd(a){if(this.A8&&a&&!a.ll&&a.dvb)if(a.pae)a.pae=!1;else if(this.Ea.ORc(a.shapeNode)){var b=this.Ea.JNc(a.shapeNode);
b.length&&(this.Ay&&this.Ay.isEnabled||this.Ay&&this.Ay.isEnabled?(this.Bja=this.Lja=null,this.CEa=this.DEa=!1,this.Ay&&this.Ay.isEnabled&&this.Ay.$R&&(this.Ay.P7a(c=>{ya.a.J(51217114,801,50,"CustomFontListDownloadAndParseCompleted");this.Lja=c;this.PGc(a,b)}),this.Ay.$R.Q7a(()=>{ya.a.J(51217116,801,15,"CustomFontWebRequestFailed");this.DEa=!0;this.PGc(a,b)})),this.SB&&this.SB.isEnabled&&this.SB.$R&&(this.SB.P7a(c=>{ya.a.J(41521282,801,50,"CloudFontListDownloadAndParseCompleted");this.Bja=c;this.PGc(a,
b)}),this.SB.$R.Q7a(()=>{ya.a.J(41494535,801,15,"CloudFontWebRequestFailed");this.CEa=!0;this.PGc(a,b)}))):this.Iyh(a,b,null,null))}}SCa(a){return a?!0:!1}PGc(a,b){(this.SCa(this.Bja)&&this.SCa(this.Lja)||this.SCa(this.Bja)&&this.DEa||this.CEa&&this.SCa(this.Lja)||this.CEa&&this.DEa)&&this.Iyh(a,b,this.Bja,this.Lja)}Iyh(a,b,c,f){a&&!a.ll&&b&&b.length&&(ya.a.J(41521286,801,50,"TryRemoveFidelityViewOnEmbeddedFontsLoaded"),Promise.all(this.Nie.VDh(b,c,Object(D.a)(this.SB,this.SB.createFontUrl,"createFontUrl"),
f,Object(D.a)(this.Ay,this.Ay.createFontUrl,"createFontUrl"),this.sW.gDh,Object(D.a)(this.sW,this.sW.createFontUrl,"createFontUrl"))).then(()=>{ya.a.J(41521288,801,50,"WebFontsLoadCompleted");this.Fx.LCa(()=>{this.yb.Gb(new He.a(2,1,0,()=>{a&&!a.ll&&(ya.a.J(41494539,801,50,"TriggerDrawByRemoveFidelityViewOnEmbeddedFontsLoaded"),a.ZOa(),a.pae=!0,a.eE())},90,"109"))})},l=>{ya.a.J(41494541,801,10,"WebFontsLoad failed: {0}",l.toString());a&&!a.ll&&a.shapeNode&&(a.shapeNode.WQa=!0)}))}}Object(e.a)(AK,
"RemoveShapeFidelityViewForEmbeddedFontController",null,[364]);class BK{constructor(a,b,c,f,l,x,F,R,fa){this.CEa=this.DEa=!1;this.Lja=this.Bja=null;this.rka=new Ha.a;this.Jsa=a;this.pp=b;this.sW=c;this.Ea=f;this.u$a=l;this.Nie=x;this.yb=F;this.SB=R;this.Ay=fa}zNk(a){window.self.Promise&&this.u$a.dxg?this.yb.Gb(new He.a(2,1,0,()=>{try{this.removeFidelityViewOnWebFontsLoaded(a)}catch(b){ya.a.J(40429063,801,10,"RemoveFidelityViewOnWebFontsLoaded exception {0}",b),this.NIb(a)}},90,"102")):this.NIb(a)}NIb(a){if(a&&
a.length){for(var b of a)b.ll||(b.dvb=!0,b.eE()),this.pp.xlh();b=0;og.a.instance.Wn(Wh.a.jP)&&(b=(new Date).getTime()-og.a.instance.Rg(Wh.a.jP));ya.a.J(560837531,801,50,"RemoveFidelityView - MissingFonts: {0}, Total Duration Since Viewable : {1}",this.rka.count,b);if(0<this.rka.count){const c=new Map;c.set("PendingFontsCount",this.rka.count.toString());c.set("FidelityViewDuration",b.toString());Se.Health.instance.recordQosError("RemoveFidelityViewWithMissingFonts",["MissingFont"],!1,!1,!0,!1,Object.assign(new Fk.a,
{extendedProperties:c}))}a.length=0;ya.a.J(40429065,801,50,"shapeViewElementsDuringBoot draw done")}}removeFidelityViewOnWebFontsLoaded(a){ya.a.J(40429067,801,50,"RemoveFidelityViewOnWebFontsLoadedAndBootComplete");for(var b of a)!b.ll&&b.yA&&b.ZOa();b=new Date;for(const c of a)if(!c.ll){const f=this.Ea.Q6a(c.shapeNode);for(const l of f)this.rka.contains(l)||this.rka.add(l)}ya.a.J(40429069,801,50,"GetUnsupportedFontsDuration: {0}",+new Date-+b);if(this.rka.count){if(!this.Ay||!this.Ay.isEnabled)if(!ee.a("EnableRemoveFidelityCloudServiceCheck")||
!this.SB||!this.SB.isEnabled){this.Sbh(a,this.rka,null,null);return}this.Bja=this.Lja=null;this.CEa=this.DEa=!1;this.Ay&&this.Ay.isEnabled&&(this.Ay.P7a(c=>{ya.a.J(51217157,801,50,"CustomFontListDownloadAndParseCompleted");this.Lja=c;this.QGc(a,this.rka)}),this.Ay.$R&&this.Ay.$R.Q7a(()=>{ya.a.J(51217159,801,50,"CustomFontWebRequestFailed");this.DEa=!0;this.QGc(a,this.rka)}));this.SB&&this.SB.isEnabled&&(this.SB.P7a(c=>{ya.a.J(40429075,801,50,"CloudFontListDownloadAndParseCompleted");this.Bja=c;this.QGc(a,
this.rka)}),this.SB.$R&&this.SB.$R.Q7a(()=>{ya.a.J(40429083,801,50,"CloudFontWebRequestFailed");this.CEa=!0;this.QGc(a,this.rka)}))}else ya.a.J(40429071,801,50,"No unsupported fonts"),this.NIb(a)}SCa(a){return a?!0:!1}QGc(a,b){(this.SCa(this.Bja)&&this.SCa(this.Lja)||this.SCa(this.Bja)&&(this.DEa||ee.a("FidelityCustomServiceDisableCheck")&&!this.Ay.isEnabled)||this.CEa&&this.SCa(this.Lja)||this.CEa&&this.DEa)&&this.Sbh(a,b,this.Bja,this.Lja)}Sbh(a,b,c,f){b&&b.count?(ya.a.J(41521300,801,50,"RemoveFidelityViewOnWebFontsLoadedInternal"),
Promise.all(this.Nie.VDh(b.toArray(),c,Object(D.a)(this.SB,this.SB.createFontUrl,"createFontUrl"),f,Object(D.a)(this.Ay,this.Ay.createFontUrl,"createFontUrl"),this.sW.gDh,Object(D.a)(this.sW,this.sW.createFontUrl,"createFontUrl"))).then(l=>{ya.a.J(40429079,801,50,"WebFontsLoadCompleted");if(l)for(let x=0;x<l.length;x++)if(l[x])for(let F=0;F<l[x].length;F++)if(l[x][F]){ya.a.J(40429081,801,50,"Status {0}",l[x][F].status);const R=l[x][F].family;Ma.a.Va(R)||l[x][F].status!==Fj.loaded||-1===R.lastIndexOf("_")||
b.remove(R.substring(0,R.lastIndexOf("_")))}this.NIb(a)},l=>{ya.a.J(41521304,801,10,"WebFontsLoad failed: {0}",l.toString());this.yb.Gb(new He.a(2,1,this.Jsa.pptWaitForWebFontsLoadingTimeoutMs,()=>{ya.a.J(40429073,801,50,"Check removing Fidelity View");this.NIb(a)},90,"103"))})):this.NIb(a)}}Object(e.a)(BK,"RemoveShapeFidelityViewOnBootController",null,[363]);class CK{constructor(a){this.ia=a}hdl(){this.Iqh(ResourceStrings.l_SessionTimeoutErrorMessage)}idl(){this.Iqh(ResourceStrings.l_SessionTimeoutErrorMessageForCommentDraft)}Iqh(a){const b=
new rj.StandardDialog;b.vd=4;b.kg="PPTTimeoutDialog";b.Re(1,ResourceStrings.L_Refresh);b.Re(2,ResourceStrings.L_Close);b.mO(ResourceStrings.l_GenericDialogTitle,a,Object(D.a)(this,this.V_k,"sessionTimeoutDialogHandler"))}V_k(a,b){1===a?(ya.a.J(24261827,801,50,"Button={0};DontShowAgain={1}",a,b),this.U9k()?(ya.a.J(24655755,801,50,"Session Token is expired or about to expire, refresh the page."),this.ia.processAction(ba.a.refreshPage,2)):this.ia.Ka(ba.a.refresh,2,{refreshtrigger:"SessionTimeoutIndicator::SessionTimeoutDialogHandler"})):
(ya.a.J(24261829,801,50,"Button={0};DontShowAgain={1}",a,b),this.ia.processAction(ba.a.frb,2))}U9k(){const a=u.AFrameworkApplication.Ml,b=u.AFrameworkApplication.Aga;return 0<a&&(new Date).getTime()>=a-1E3*b}}Object(e.a)(CK,"SessionTimeoutIndicator",null,[357]);class DK{constructor(){this.n_c=!1;this.lMg=[]}get I$d(){return this.n_c}set I$d(a){if(!this.n_c&&(this.n_c=a)){for(const b of this.lMg)b();Array.clear(this.lMg)}}}Object(e.a)(DK,"SignalRLoadCompletedListener",null,[358]);var oQ=d(876);class rv{constructor(a){this.Def=
a}onBlur(a,b){this.lce("OnBlur",a,b);(a=pa.InteractiveViewManager.instance.Ld)&&v.FocusManager.XL()&&a.endEditing(!1,20)}setFocus(a,b){this.lce("SetFocus",a,b);const c=this.Def();c&&!c.isActive&&(a.name!==I.AppFrame.Hrj&&a.name!==I.AppFrame.RTi||b.name!==y.AFrame.mV||(c.Mgd=!1),c.pMi())}onFocus(a,b){this.lce("OnFocus",a,b);if(v.FocusManager.XL()&&(b=this.Def())&&b.isActive){var c=!!b.editingView;a=a?a.name:"";n.a.Ki&&(a.startsWith(Ej.a.uXb)&&(jf.GrippersManager.instance.R1b=!0),a.startsWith(Ej.a.uXb)||
a===y.AFrame.icb||a===y.AFrame.kuh)&&(c=!1);c&&this.oMi(b,a)}}oMi(a,b){const c=a.editingView,f=v.FocusManager.instance();f.Z4d=!0;a.TQ();1===c.mode&&3!==u.AFrameworkApplication.Ta.mode&&b===y.AFrame.icb&&(a.Eb.Xma.gWd(),c.afb());f.Z4d=!1}lce(a,b,c){a=String.format("InteractiveViewFocusScopeActions.{0} called. (Scope is moving from '{1}' to '{2}')",a,b?b.name:null,c?c.name:null);Nm.a.instance.Rv&&Z.ULS.sendTraceTag(38293642,321,15,String.format("{0} {1}","Handling focus/blur events while TaskManager.Instance.IsYielding!",
a))}static DPf(a){const b=new rv(()=>a),c=a.RH,f=v.FocusManager.instance();f.Bc(c).uza(Object(D.a)(b,b.onBlur,"onBlur"));f.Bc(c).zaa(Object(D.a)(b,b.setFocus,"setFocus"));f.Bc(c).xaa(Object(D.a)(b,b.onFocus,"onFocus"))}}Object(e.a)(rv,"InteractiveViewFocusScopeActions",null,[]);class yD extends rv{constructor(a){super(()=>a);this.Qb=a}Prk(){this.Qb.isActive||this.Qb.TLi()}static isi(a,b){const c=new yD(a);a=a.RH;b.Bc(a).uza(Object(D.a)(c,c.onBlur,"onBlur"));b.Bc(a).zaa(Object(D.a)(c,c.Prk,"pageViewSetFocus"));
b.Bc(a).xaa(Object(D.a)(c,c.onFocus,"onFocus"))}}Object(e.a)(yD,"PageViewInteractiveViewFocusScopeActions",rv,[]);class Bz{constructor(){this.Ga=this.K=null;this.jJg=!1}get name(){return"PowerPointWebEditor.CoreExt"}Wb(a){this.K=a;this.Ga=a.resolve("PowerPointWebEditor.IApplicationSettings");this.Ga.Kqg&&a.register(350,"PowerPointWebEditor.IPageHiddenMeter").ma().na(()=>new yK);Bz.Eri(this.K);a.register(vD,"PowerPointWebEditor.CoreExt.CoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventNotifier").as("PowerPointWebEditor.CoreExt.ICoauthEventHandler").ma().na(()=>
new vD);a.register(wD,"PowerPointWebEditor.CoreExt.CoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier").as("PowerPointWebEditor.CoreExt.ICoreExtEventHandler").ma().na(()=>new wD);a.register(351,"Common.IColorTable").ma().na(()=>new tK);a.register(Az,"PowerPointWebEditor.CoauthStateCache").as("PowerPointWebEditor.ICoauthStateGetter").as("PowerPointWebEditor.ICoauthStateSetter").ma().na(()=>new Az(a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),new le.a(()=>hb.a.instance.La("Common.IRenameProps"))));a.register(352,"PowerPointWebEditor.IDocNotifyClient").ma().na(()=>new nD(this.Ga,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ga.vg?a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"):null,(b,c,f,l,x,F)=>{a.resolve("PowerPointWebEditor.IPPTWebService").J1d(c,f,l,x,F)},!1));a.register(353,"PowerPointWebEditor.IPodsDocNotifyClient").ma().na(()=>new nD(this.Ga,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"),(b,c,f,l,x,F,R,fa,wa)=>{a.resolve("PowerPointWebEditor.IPopWebService").LMc(b,c,f,l,x,F,R,fa,wa)},!0));a.register(354,"PowerPointWebEditor.IContentTimeStampManager").ma().na(()=>new rK);a.register(qv,"PowerPointWebEditor.CoauthSubscriptionManager").as("PowerPointWebEditor.ICoauthSubscriptionManager").ma().na(()=>new qv(a.resolve("PowerPointWebEditor.IDocNotifyClient"),
this.Ga.vg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.NotificationManager"),this.Ga.GCe,this.Ga.podsPushThumbnailImageIds));a.register(mD,"PowerPointWebEditor.CoauthNotificationManager").ma().na(()=>new mD(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IDocNotifyClient"),this.Ga.vg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),
a.resolve("PowerPointWebEditor.ICoauthSubscriptionManager"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.La("PowerPointWebEditor.IPrefetchManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.Ga,a.resolve("Common.DragInputManager"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IBusinessBarController")));a.register(Ix,"PowerPointWebEditor.PresenceLoader").ma().na(()=>new Ix(this.Ga,
a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IPPTApp"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener"),a.resolve("PowerPoint.IPathManager")));a.register(uK,"PowerpointPresence.PresenceEmailConverter").as("PowerpointPresence.IPresenceEmailConverter").ma();
a.register(355,"PowerpointPresence.IPresenceColorProvider").ma().na(()=>new nQ.a(a.resolve("Common.App.People.IPeopleColorUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").Svg,a.resolve("PowerPointWebEditor.IApplicationSettings").podsDefaultToRtcForPresenceEnabled));a.register(356,"PowerpointPresence.IPresencePerfLogger").ma().na(()=>new vK(a.pb("PowerPointWebEditor.IPageHiddenMeter"),a.resolve("PowerPointWebEditor.IApplicationSettings").podsLogRealTimeChannelResourceTiming?a.resolve("Common.NetworkTiming.IResourceTimingLogger"):
null,a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.La("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(rD,"PowerpointPresence.RtcParams").ma().na(()=>new rD(a.resolve("PowerPointWebEditor.ICoauthStateGetter").hC,a.resolve("PowerPointWebEditor.IApplicationContext").Udg(),a.La("Common.ISessionExpirationManager"),a.resolve("Common.IAppSettingsManager").Ec("RTCReconnectionSlowDurationMilliseconds",5E3)));a.register(357,"PowerPointWebEditor.ISessionTimeoutIndicator").ma().na(()=>
new CK(a.resolve("Common.IActionManager")));a.register(358,"PowerPointWebEditor.ISignalRLoadCompletedListener").ma().na(()=>new DK);a.register(kD,"PowerPointWebEditor.SessionLifetimeManager").as("PowerPointWebEditor.ISessionLifetimeManager").ma().na(()=>new kD(this.Ga,a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.La("PowerPointWebEditor.IGetDocumentCopyHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.ISessionTimeoutIndicator"),a.La("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.La("PowerPointWebEditor.ICommentSessionManager")));a.register(jD,"PowerPointWebEditor.SessionCleanupHandler").ma().na(()=>new jD(a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(359,"Common.IProcessInputStrategy").ma().na(()=>new Ms(a.resolve("Common.IActionManager"),this.Ga,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Common.IF6Manager")));a.register(qD,"PowerpointPresence.PresenceEventSource").as("PowerpointPresence.IPresenceEventSource").as("PowerpointPresence.IPresenceEventNotifier").as("PowerpointPresence.IPresenceEventHandlers").ma().na(()=>
new qD);a.register(360,"Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy").ma().na(()=>new xK(this.Ga.pptEditorDifferentLineHeightEnabled,a.resolve("Box4.IRotatingCoordinateConverter"),this.Ga.Hvg));a.register(361,"Box4.TextMetricsApi.ITextMetricsHelper").ma().na(()=>new Q);a.register(362,"PowerPointWebEditor.IThumbnailNavPaneDragAdapter").ma().na(()=>new sK(a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.DragInputManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),u.AFrameworkApplication.isRtl,this.Ga.Qvg,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.Ga.yz,this.Ga.c$d));a.register(363,"PowerPointWebEditor.IRemoveShapeFidelityViewOnBootController").ma().na(()=>
new BK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(364,"PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController").ma().na(()=>
new AK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(uD,"PowerPointWebEditor.ActionNameResolver").as("PowerPointWebEditor.IActionNameResolver").ma().na(()=>
new uD);a.register(sD,"PowerPointWebEditor.PPTProcessImageStrategyProxy").as("PowerPointWebEditor.IPPTProcessImageStrategy").as("Box4.IProcessImageStrategy").ma().na(()=>new sD);a.register(xD,"PowerPointWebEditor.DelayLoadedPackageInitializer").ma().na(()=>{let b=2;const c=hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptDelayLoadedPackageInitializerTaskPriority;0<=c&&6>c?b=c:ya.a.J(512360583,809,50,"Invalid delay loaded initializer task priority:{0}",c);return new xD(hb.a.instance.resolve("Common.ITaskManager"),
hb.a.instance.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),hb.a.instance.resolve("PowerPointWebEditor.Core.IPerformanceHelper"),hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").delayLoadedPackageInitTimeSliceInMs,hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorCPUMeterProfilingLogThresholdInMS,b,94)});a.register(365,"PowerpointPresence.IPresencePrepCacheParser").ma().na(()=>new wK(window.self,a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.ICoauthStateSetter")));this.Ga.bXa||(a.register(366,"PowerPointWebEditor.ISorterViewActorMain").na(()=>new oQ.a(u.AFrameworkApplication.Ta,a.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),a.resolve("PowerPointWebEditor.IPPTApp").Jae,a.resolve("PowerPointWebEditor.ISessionState"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.La("PowerPointWebEditor.ISorterViewActorLazy"))).ma(),a.resolve("PowerPointWebEditor.ISorterViewActorMain"))}init(){var a=
window.g_hermesExtJS;void 0!==a&&null!==a&&og.a.instance.ic("FirstExtJsExecTime",a);a=new qB.a("CoreExtPackage::Init");try{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Iia&&this.WWg();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").LCa(()=>{this.K.resolve("Common.ITaskManager").Gb(new He.a(0,1,0,Object(D.a)(this,this.Qhk,"onBootComplete_DelayExecuted"),90,"21"))});this.Ga.Kqg&&this.K.resolve("PowerPointWebEditor.IPageHiddenMeter");this.K.resolve("Common.IProcessInputStrategy");
this.K.resolve("PowerPointWebEditor.SessionCleanupHandler");this.K.resolve("PowerPointWebEditor.Graph.GraphNodeDelayConnectValidator").disable();this.K.resolve("Box4.IEditingView");const b=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");yD.isi(b,this.K.resolve("Common.IFocusManager"));b.Kwi(this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.IThumbnailNavPaneDragAdapter");this.K.resolve("PowerPointWebEditor.DelayLoadedPackageInitializer");
this.K.resolve("PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController");this.K.resolve("PowerPointWebEditor.IPPTApp").Nik()}finally{a&&a.dispose()}}dispose(){this.K.resolve("PowerPointWebEditor.IPrefetchManager").dispose();this.K.resolve("PowerPointWebEditor.SessionCleanupHandler").dispose();this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").dispose();this.K.resolve("PowerPointWebEditor.IDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.IPodsDocNotifyClient").dispose();
this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").dispose()}WWg(){const a=new qB.a("App::DelayLoadRibbon");try{this.K.resolve("PowerPointWebEditor.IRibbonUser")}finally{a&&a.dispose()}this.jJg=!0;this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").pFb(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)}Urj(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableRibbon&&(document.getElementById("PptEditingRibbon").parentNode.style.display=
"none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableTitleBar&&(document.getElementById("AppHeaderPanel").style.display="none",document.getElementById("AppHeaderPanel").style.visibility="hidden");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableStatusBar&&(document.getElementById("WACStatusBarContainer").style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableNotes&&(document.getElementById("EditingNotesPanel").parentNode.style.display=
"none")}V8h(){"bottom"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").thumbnailPos&&(this.yHd("WACDocumentPanelContent","Horizontal"),this.yHd("EditingThumbnailsPanel","Horizontal"),this.yHd("EditingThumbnailsPanel","EditingThumbnailsPanelShadow"))}yHd(a,b){let c=document.getElementById(a).getAttribute("class").toString();c+=" "+b;document.getElementById(a).setAttribute("class",c)}O6d(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba;if(a){const b=new We.GraphTransaction(2);
try{b.fd(a),a.Uba(16)}finally{b&&b.dispose()}}}N5b(a,b){const c=this.K.resolve("PowerPointWebEditor.ISessionState");a.HR(()=>{c&&c.w4(b+"DownloadFinished")});Xi.a.wx(a)}rTj(){if(this.Ga.anc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Iha("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1199)));else{const a=xz.a.create("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1199)));this.N5b(a,"comment")}}qTj(){if(this.Ga.anc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Iha("pptedit.chronosslim",
null,()=>d.e(5).then(d.bind(null,1196)));else{const a=xz.a.create("pptedit.chronosslim",null,()=>d.e(5).then(d.bind(null,1196)));this.N5b(a,"chronosslim")}}Qhk(){this.K.resolve("PowerPointWebEditor.IPrefetchManager");this.jJg||this.WWg();this.Urj();this.V8h();const a=this.K.resolve("PowerPointWebEditor.ISessionState");this.Ga.separateDownloadSignalREnabled&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Iha(this.K.resolve("PowerPointWebEditor.PresenceLoader").Adl,(f,l)=>{Gb.App.Mwg()&&
(this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").I$d=l.succeeded)},null);const b=()=>{ya.a.J(512360582,809,50,"Start to download chronos.js file");this.rTj();this.qTj();this.Ga.rrh||this.Ga.bXa||this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").tVc()},c=()=>{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").xqg(()=>{b()})};(new bq.a(this.Ga.Vda)).iMj?this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader").kAg().continueWith(()=>{this.O6d()}).continueWith(()=>
{c()}):c();this.K.resolve("PowerPointWebEditor.ISessionTimeUpdater").PQe();this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager").start();a&&a.w4("ChronosStartDownloadTime");try{if(this.Ga.wacAirSpaceResourceLink){const f=sp.a.CVb("wacairspaceanimationlibrary.js"),l=TC.a.create(f,null,null);Xi.a.wx(l)}}catch(f){ya.a.J(512360581,814,10,"App : OnBootComplete; Exception loading wacAirSpace Resource: {0}",f)}this.Ga.vg&&this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").rxj();
u.AFrameworkApplication.fa.ff(()=>{fQ.a.instance.Fli()});MSOJS.ClientUtils.InitUrls(u.AFrameworkApplication.BVk,u.AFrameworkApplication.zVk,u.AFrameworkApplication.AVk)}static main(){u.AFrameworkApplication.Xg&&n.a.$f?ya.a.J(512360580,809,15,"Firefox attempts to load core ext package when App is disposing"):m.a.instance.Ac(new Bz)}static Eri(a){a.register(367,"PowerPointWebEditor.IPrefetchManager").ma().na(()=>new Vp(a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.Image.IImageManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.resolve("Box4.Graph.IGraphInstance").Bd(8),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.ISlideCacheStrategy"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IFontUtilsManager")))}}Object(e.a)(Bz,"CoreExtPackage",null,[2,3]);class EK{constructor(){this.zXc=this.vf=this.gd=this.vb=null;this.va=new qd.a;this.Ib=!1}init(a,b){this.vf=a;this.gd=b;this.ZC()}dispose(){this.vb&&(this.visible=!1,this.gd.xb(qa.a.click,
this.vb,Object(D.a)(this,this.zGa,"onBackgroundClick")),this.vf&&this.vb&&(this.vf.removeChild(this.vb),this.vb=null),this.va&&(this.va.dispose(),this.va=null))}ZC(){this.vb=document.createElement("div");this.vb.className="EditingNotesDefaultView";u.AFrameworkApplication.isRtl&&(this.vb.style.direction=Ve.a.FYa);this.vf.appendChild(this.vb);this.zXc=document.createElement("p");this.zXc.className="EditingNotesDefaultViewContent";this.zXc.innerText=ResourceStrings.l_ClickToAddNotes;this.vb.appendChild(this.zXc);
this.gd.ob(qa.a.click,this.vb,Object(D.a)(this,this.zGa,"onBackgroundClick"))}zGa(a){this.va.raiseEvent("OnBackgroundClick",a);return!0}rCf(a){this.va.addHandler("OnBackgroundClick",a)}onResize(){}get visible(){return this.Ib}set visible(a){this.Ib=a;this.vb.style.display=a?Ii.a.block:Ii.a.none}get ya(){return this.vb}}Object(e.a)(EK,"NotesPromptView",null,[615,616,106]);class FK{constructor(a){this.E1c=this.vf=this.vb=null;this.tZc=this.Ib=!1;this.t3j=a}init(a,b){b.Tub&&(this.vf=a,this.vb=document.createElement("div"),
this.vb.className="EditingNotesReadOnlyView",this.t3j&&(this.vb.style.direction=Ve.a.FYa),this.vf.appendChild(this.vb),this.E1c=document.createElement("div"),this.E1c.className="EditingNotesReadOnlyViewContent",a={},a.inputString=b.Z5c,b=jSanity.sanitize(a),this.E1c.appendChild(b),this.vb.appendChild(this.E1c),this.tZc=!0)}dispose(){this.tZc&&(this.visible=!1,this.vf&&this.vb&&(this.vf.removeChild(this.vb),this.vb=null),this.tZc=!1)}get visible(){return this.Ib}set visible(a){this.tZc&&(this.Ib=a,
this.vb.style.display=a?Ii.a.block:Ii.a.none)}get ya(){return this.vb}}Object(e.a)(FK,"NotesReadOnlyView",null,[614,106]);var Cz=d(483),zD=d(629);class fr extends Cz.a{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe){super(a,b);this.Wyb=this.fg=this.nh=this.nab=null;this.WTa=!1;this.rta=Gb.App.Im;this.hFa=Object(va.a)(375,b);this.vb=this.Fd.container;this.jc(this.vb);this.gd=c;this.Fa=f;this.Yab=l;this.Ezb=wa;this.Gl=x;this.ni=F;this.hv=R;this.FI=fa;this.nb=Xa;this.r9a=lb;this.z8=
Object(va.a)(252,a);this.r8b=Lb;this.hc=kc;this.Fne=lc;this.Kta=Ec;this.NI=Jc;this.fe=Dc;this.f6j=Wd;this.vp=xe;this.NYc=this.fe.Yj("formatpaintertext.cur");this.vp&&this.NI.GGd(Object(D.a)(this,this.Jdc,"onTextFPActiveChanged"));this.nh||this.ZC()}dispose(){this.gd.xb(qa.a.click,this.vb.parentNode,Object(D.a)(this,this.zGa,"onBackgroundClick"));this.vp&&this.NI.ZDe(Object(D.a)(this,this.Jdc,"onTextFPActiveChanged"));this.Yab&&(this.Yab.dispose(),this.Yab=null);this.Ezb&&(this.Ezb.dispose(),this.Ezb=
null);super.dispose()}cA(a){super.cA(a);this.qSe()}Xea(a){this.fD(this.fg,a,-1)}q5(){this.mhd()}ZC(){this.f6j&&(this.Wyb=this.Fd.createElement("div"),this.Wyb.className="NotesResizeHandle",Sc.c(this.Wyb,!0),Sys.UI.DomElement.addCssClass(this.Wyb,"NotesResizeHandle"),this.htmlElement.appendChild(this.Wyb),this.Ho(this.Wyb));this.nab=this.Fd.createElement("div");this.nab.className="NotesContentContainer";this.nab.id="NotesContentContainer";this.Ho(this.nab);this.htmlElement.appendChild(this.nab);this.nh=
this.Fd.createElement("div");Sys.UI.DomElement.addCssClass(this.nh,"NotesView");Sys.UI.DomElement.addCssClass(this.nh,"NotesEditViewVisible");this.nab.appendChild(this.nh);this.Ho(this.nh);this.fg=this.Fd.createElement("div");Sys.UI.DomElement.addCssClass(this.fg,"NotesViewContent");this.nh.appendChild(this.fg);this.Ho(this.fg);u.AFrameworkApplication.isRtl&&(this.nh.style.direction=Ve.a.FYa);this.gd.ob(qa.a.click,this.vb.parentNode,Object(D.a)(this,this.zGa,"onBackgroundClick"));this.Yab.init(this.vb.parentNode,
this.gd);this.Ezb.init(this.vb.parentNode,this.hFa);this.mhd();this.Yab.rCf(Object(D.a)(this,this.Rik,"onDefaultViewClick"))}mhd(){if(this.hFa.Tub)this.rIa(!1),this.RLe(!1),this.Gcl();else{var a=this.Gl.B9d(this.hFa);a=this.WTa||!a;this.rIa(a);this.RLe(!a);this.vp&&this.XD(fr.Fca)}}Jdc(a,b){fr.Fca=b.SJc;this.XD(fr.Fca)}XD(a){const b=this.vb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===a)for(this.vb.style.cursor=Xe.a.nP(this.NYc,Ii.a.aA),this.fg.style.cursor=Xe.a.nP(this.NYc,Ii.a.aA),
a=0;a<b.length;a++)if(b[a].style.cursor!==Xe.a.nP(this.NYc,Ii.a.aA))b[a].style.cursor=Xe.a.nP(this.NYc,Ii.a.V4);else break;else for(this.vb.style.cursor=Ii.a.aA,this.fg.style.cursor=Ii.a.aA,a=0;a<b.length;a++)b[a].style.cursor=Ii.a.V4}qSe(){this.htmlElement.style.zIndex="0";const a=this.Gl.fQa(this.hFa,this.Fd.Cd),b=this.Gl.D_b(this.hFa,this.Fd.Cd);var c=a.width-b[1]-b[3];0>c&&(b[1]+=c/2,b[3]+=c/2);c=a.height-b[0]-b[2];0>c&&(b[1]+=c/2,b[3]+=c/2);fr.IIe(this.nh,b);fr.IIe(this.Yab.ya,b);fr.IIe(this.Ezb.ya,
b);this.Kta.Efb(new ad.a(a.x,a.y),u.AFrameworkApplication.isRtl,this.nh,!0)}adb(){this.WTa=!0;this.uT();this.startEditing()}bdb(){this.WTa=!1;this.uT();this.endEditing()}uK(){return this.WTa}startEditing(){this.Nua.Tub?this.nb.hj():(this.mhd(),this.Pug()||(this.rta=this.Nua.BDa,this.FI.ulh(this.hFa,!1),this.FI.IBk(this.hFa)))}endEditing(){if(!this.Nua.Tub&&(this.r9a.setVisibility(!1),this.mhd(),!this.Pug())){this.$Ug.endEditing(!0,14);this.r8b.jTd(this.z8);var a=this.Fne.asa(this.Nua,this.rta),b=
!!this.Nua&&this.Nua.isConnected;a&&(b&&this.Nua.Tfd(),this.ni.O3a(this.Nua),this.hv.XLd());this.FI.ulh(this.hFa,b&&this.Nua.TRc)}}Rik(a,b){this.zGa(b)}zGa(){this.Fa.Gj(xi.a.B1,!0);this.rIa(!0);this.RLe(!1);this.$Ug.TQ();this.eMe();this.rta=this.Nua.BDa;return!0}Pug(){return!this.hc.ln}get ya(){return this.htmlElement}get Nua(){return this.hFa}get $Ug(){return this.Oc}eMe(){this.q$(!0)}Gcl(){this.Ezb.visible=!0}RLe(a){this.Yab.visible=a}rIa(a){zD.b(a,this.nab,"NotesContentContainerHidden","NotesContentContainerVisible")}q$(a){zD.b(a,
this.nh,"NotesEditViewHidden","NotesEditViewVisible")}static IIe(a,b){a&&(a.style.paddingTop=Xe.a.Lc(b[0]),a.style.paddingRight=Xe.a.Lc(b[1]),a.style.paddingBottom=Xe.a.Lc(b[2]),a.style.paddingLeft=Xe.a.Lc(b[3]))}static nJj(a){return a?Sys.UI.DomElement.containsCssClass(a,"NotesResizeHandle"):!1}}fr.Fca=0;Object(e.a)(fr,"NotesViewElement",Cz.a,[437,444]);var Rr=d(373),pQ=d(601),qQ=d(817),GK=d(481),Dz=d(480);class HK extends Dz.a{constructor(a,b){super(a,b);this.Dca=[];this.B7b=0}oEb(a,...b){Array.addRange(this.Dca,
b);this.B7b=a}yhc(){if(this.Dca)for(const a of this.Dca)this.ut.xhc(this.container,a,this.B7b);this.ut.ZI(this.container,this.V1)}cnc(){this.ut.hE(this.container,this.V1);for(const a of this.Dca)this.ut.hE(this.container,a)}}Object(e.a)(HK,"NotesViewDomManager",Dz.a,[]);var Ez=d(543);class IK extends Ez.ViewSelectionChangedHandler{constructor(a,b){super(a);this.ra=b}zpb(){return[Object(D.a)(this,this.vdc,"onSetup"),Object(D.a)(this,this.Tcc,"onEnsurePageViewElementsCreated"),Object(D.a)(this,this.Ucc,
"onEnsureSelectedContentViewElementsCreated"),Object(D.a)(this,this.idc,"onMainLoop"),Object(D.a)(this,this.Ylk,"onNotesContentSelect"),Object(D.a)(this,this.Pcc,"onCommit"),Object(D.a)(this,this.Idc,"onTearDown")]}Ylk(a,b){this.wea(b);a=Object(va.a)(375,this.uh.rg);if(!a)return!0;a=Object(va.a)(437,a.oc(this.uh.Ma));if(!a)return!0;this.ra.Wia()?a.uK()||a.adb():a.uK()&&a.bdb();return!0}}Object(e.a)(IK,"NotesViewSelectionChangedHandler",Ez.ViewSelectionChangedHandler,[]);class AD extends pv.DragSelectionDragAdapter{constructor(a,
b,c,f,l,x){super(a,b,c);this.Pp=f;this.Qce=x;this.Gl=l}su(a){if(this.Qce){var b=this.Smc(a);const c=b?b.$a:null;if(c){const f=this.Gl.gDa(c)?Object(va.a)(375,c):this.Gl.ssb(c);if(f&&this.Gl.B9d(f))return!1}if(a.ctrlKey&&b&&c&&(b=this.Df.fZa(a.clientPoint,b,c,this.Df,!1))&&Rb.HyperlinkReader.Uia(b,!0))return!1}a=super.su(a);null!==this.Pp&&a&&this.Pp.ewa(Ii.a.V4);return a}Nt(a){super.Nt(a);null!==this.Pp&&this.Pp.Mva()}Ln(a){super.Ln(a);null!==this.Pp&&this.Pp.Mva()}gI(a){return this.Df.isActive?super.gI(a):
!1}static E_b(a){return new AD(a,hb.a.instance.resolve("Common.IActionManagerExtended"),hb.a.instance.resolve("Common.IActivityManager"),hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?hb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,hb.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix)}}Object(e.a)(AD,
"NotesDragSelectionDragAdapter",pv.DragSelectionDragAdapter,[]);var Fz=d(225);class BD{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){this.ILg=this.T9b=this.IEg=this.Mme=this.WEa=0;this.a9=this.w7b=this.G0c=null;this.I6b=this.pDg=this.m0c=0;this.Dfe=!1;this.z8=a;this.RZ=b;this.Rj=c;this.Nb=f;this.Kz=l;this.Gg=x;this.yc=F;this.Hc=R;this.Db=fa;wa.OMa(Object(D.a)(this,this.ndc,"onOutboundReplication"));this.ia=Xa}Wu(a){return a&&a.Sz!==Sys.UI.MouseButton.rightButton?fr.nJj(a.Fc):!1}su(a){if(!this.Wu(a))return!1;
this.Dfe=!0;this.G0c=this.Kz.ya;if(!this.G0c)return!1;this.a9=this.Hc.Jc;if(this.a9&&(this.w7b=this.Gg.ya))this.IEg=this.w7b.clientHeight;else return!1;this.m0c=Math.floor(.75*(this.G0c.clientHeight+this.w7b.clientHeight));this.Mme=this.G0c.clientHeight;this.T9b=this.WEa=a.clientPoint.y;this.ILg=this.a9.BV;this.RZ.Pk(7);this.z8.endEditing(!0,14);return!0}aw(a){if(!a)return!1;this.WEa=a.clientPoint.y;a=this.zKf(this.WEa);this.Kz.Cda=a;this.Nb.yq();a=this.IEg+this.Mme-a;this.w7b.style.height=a+"px";
this.a9.K3k(a-1);this.a9.R5k(this.ILg);return!0}Ln(a){this.RZ.U_();this.z8.TQ();this.I6b=this.zKf(a?a.clientPoint.y:this.WEa);this.ia.Ka(ba.a.DIe,2,this.I6b)}Nt(){this.Dfe&&(this.Dfe=!1,this.Ln(null))}ndc(){this.I6b!==this.pDg&&2===Gb.App.Fb.mode&&(this.pDg=this.I6b,this.crk(this.I6b))}crk(a){const b=this.yc.An,c=this.Db.rd(4);try{c.jc(b),b.LBb=4320,b.Cda=this.Bhi(a)}finally{c&&c.dispose()}}zKf(a){a=this.Mme+this.Rj.qn(this.T9b-a);0<this.m0c&&a>this.m0c?a=this.m0c:a<Fz.a.JOa&&a>qf.a.jHc?a=Fz.a.JOa:
a<qf.a.jHc&&(a=qf.a.vYf);return a}Bhi(a){return this.Rj.mye(a,1)}static E_b(a){return new BD(a,hb.a.instance.resolve("Common.CursorManager"),hb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),hb.a.instance.resolve("Box4.IAppFrame"),hb.a.instance.resolve("PowerPointWebEditor.INotesPane"),hb.a.instance.resolve("PowerPointWebEditor.ISlidePane"),hb.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),hb.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),hb.a.instance.resolve("Common.Transaction.ITransactionFactory"),
hb.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),hb.a.instance.resolve("Common.IActionManagerExtended"))}}Object(e.a)(BD,"NotesResizeDragAdapter",null,[239]);class JK extends Rr.a{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){super(xi.a.B1,a,b,c,f,l,F,R,lb);this.zke=!1;this.Xbb=x;this.hc=fa;this.$h=wa;this.vN=Xa;this.Qce=Lb;this.vp=kc}get wHd(){return u.AFrameworkApplication.fa}iA(a,b=null){this.vp&&this.$h.ob(qa.a.WW,this.container,Object(D.a)(this,this.p5c,"mouseUpHandlerFilter"));
super.iA(a,b);(a=Object(va.a)(375,a))&&a.Tub&&this.ug&&this.ug.Bn&&this.ug.Bn.setAttribute("aria-readonly","true")}detach(){this.vp&&this.Ro&&this.$h.xb(qa.a.WW,this.container,Object(D.a)(this,this.p5c,"mouseUpHandlerFilter"));super.detach()}$Tb(a,b){return new HK(a,b)}Sba(a){a=super.Sba(a);a.V1=AD.E_b(this);a.oEb(1,BD.E_b(this));return a}Zua(a){this.ttc=a.Vf;if(!this.lhc||this.isActive||!this.Qce||(a.lc.type===qa.a.mouseDown||a.lc.type===qa.a.qNa)&&a.Sz!==Sys.UI.MouseButton.leftButton)return!1;var b=
a.Fc;if(b&&Sys.UI.DomElement.containsCssClass(b,"NotesResizeHandle"))return!1;let c=!1;Rr.a.H6&&(c=Rr.a.H6.sqa());Gb.App.YC.VR&&Gb.App.YC.VR.xFe(f=>{f&&(c=!0)});b=!ee.a("DeprecateIE.NotesView")&&c&&n.a.PV;a=new pQ.a(a,this,!0,b);this.iBk(a);return!1}iBk(a){this.kze();this.K4(n.a.$f||n.a.JRa);this.hp.raiseEvent(Rr.a.IQc,new qQ.a(a.graphNode));this.HJc(a.graphNode);this.QTe();const b=[Object(D.a)(this,this.gte,"noneClickHandler"),Object(D.a)(this,this.Cfk,"notesSnapToContentClickHandler"),Object(D.a)(this,
this.xfk,"notesDefaultClickHandler")];for(const c of b)if(c(a).z2){this.zke=!0;break}}p5c(){return this.zke&&this.vN.mSa?(this.Ca.processAction(C.a.Sha,2),!0):this.zke=!1}xfk(a){const b=Rr.a.Tc.Bp(C.a.Tob);b.properties.$(kf.a.source,"DefaultClickHandler");this.m5(a.eU,a.Er,a.graphNode,a.Oc,a.Ti.shiftKey,a.Ti.ctrlKey,a.Ti.Vf);b.end();a.hrb&&this.K4(!0);this.editingView.d9a(a.Ti.shiftKey,a.eU,a.Ti.Vf);return Uh.a.Al(!0)}Cfk(a){if(!a.Er){const b=a.Er,c=a.graphNode,f=Rr.a.Tc.Bp(C.a.Tob);f.properties.$(kf.a.source,
"SnapToContentClickHandler");this.m5(a.eU,b,c,this,a.Ti.shiftKey,a.Ti.ctrlKey,a.Ti.Vf);f.end();a.hrb&&this.K4(!0);this.editingView.d9a(a.Ti.shiftKey,a.eU,a.Ti.Vf);return Uh.a.Al(!0)}return Uh.a.notHandled}sla(){super.sla();this.ug&&this.ug.Bn&&(this.wHd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.ug.ojc(Uc.a.NAc):this.ug.FHe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",Uc.a.NAc),this.ug.Bn.setAttribute(Uc.a.vs,ResourceStrings.l_NotesPane))}Did(){this.sE.Ld===this&&
this.suspend()}qdd(){this.sE.Ld===this&&this.resume()}dNc(){return new IK(this,hb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}LKc(){return[Object(D.a)(this,this.gte,"noneClickHandler"),Object(D.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(D.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(D.a)(this,this.defaultClickHandler,"defaultClickHandler")]}oLc(){return[Object(D.a)(this,this.gte,"noneClickHandler"),Object(D.a)(this,this.defaultDoubleClickHandler,
"defaultDoubleClickHandler")]}gte(a){return this.Uub(a)||this.oJj()?Uh.a.Al(!0):Uh.a.notHandled}cLc(){return[Object(D.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(D.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(D.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}uwa(a){this.Uub(a)||super.uwa(a)}noContextMenuHandler(a){return this.Uub(a)?Jn.a.Al(null):Jn.a.notHandled}Uub(a){return!!a&&!!a.graphNode&&
60===a.graphNode.type&&a.graphNode.Tub}oJj(){return!this.hc.ln}G6a(){return GK.a.Xre}get dI(){return super.dI|96}get dkc(){return!0}bfa(a,b,c=null){this.Xbb.C_(this)&&super.bfa(a,b,c)}}Object(e.a)(JK,"NotesView",Rr.a,[349,389,390,202,106,252,391,392,393,394]);var KK=d(482),Gz=d(206);class CD{constructor(a,b,c,f){this.jLg=null;this.Ata=a;this.ta=b;this.xq=c;this.Uie=f}Ixj(){this.jLg=new KK.a(Gz.App.B2a.Afk,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.Ata.Pza(this.jLg.wxa);rv.DPf(this.Ata);
this.JGf(this.ta.Ba);this.xq.s2h(Object(D.a)(this,this.FWg,"onAttachNotesView"))}FWg(a,b){this.QLi();this.JGf(b.Nd)}JGf(a){this.ta.presentation&&a&&a.isConnected&&(a=this.Uie.t9f(a,27),this.Ata.iA(a))}QLi(){this.Ata.Ro&&(this.Ata.editingView.disable(!0,14),this.Ata.detach())}dispose(){this.xq.IOk(Object(D.a)(this,this.FWg,"onAttachNotesView"))}}Object(e.a)(CD,"NotesViewHelper",null,[106]);class DD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Notes"}Wb(a){this.K=a;this.K.register(349,
"PowerPointWebEditor.INotesView").ma().na(()=>new JK(this.K.resolve("Box4.IWorkspace"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.La("Box4.ITextMetricsAdapter"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));this.K.register(CD,"PowerPointWebEditor.Notes.NotesViewHelper").ma().na(()=>new CD(this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new Em.a((a,b)=>Object(Fa.a)(349,a)?new fr(a,b,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),new EK,this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new FK(u.AFrameworkApplication.isRtl),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.K.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").k5g,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled):null));this.K.resolve("Box4.IEditingView");this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").Ixj()}dispose(){this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){m.a.instance.Ac(new DD)}}Object(e.a)(DD,"PPTWebEditorNotesPackage",null,[2,3]);class ED extends pv.DragSelectionDragAdapter{constructor(a,
b,c,f){super(a,b,c);this.Pp=f}su(a){a=super.su(a);null!==this.Pp&&a&&this.Pp.ewa(Ii.a.V4);return a}Nt(a){super.Nt(a);null!==this.Pp&&this.Pp.Mva()}Ln(a){super.Ln(a);null!==this.Pp&&this.Pp.Mva()}gI(a){return this.Df.isActive?super.gI(a):!1}static E_b(a){return new ED(a,hb.a.instance.resolve("Common.IActionManagerExtended"),hb.a.instance.resolve("Common.IActivityManager"),hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?hb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null)}}Object(e.a)(ED,"SmartArtTextViewDragSelectionDragAdapter",pv.DragSelectionDragAdapter,[]);class LK extends Dz.a{constructor(a,b){super(a,b);this.Dca=[];this.B7b=0}oEb(a,...b){Array.addRange(this.Dca,b);this.B7b=a}yhc(){if(this.Dca)for(const a of this.Dca)this.ut.xhc(this.container,a,this.B7b);this.ut.ZI(this.container,this.V1)}cnc(){this.ut.hE(this.container,this.V1);for(const a of this.Dca)this.ut.hE(this.container,a)}}Object(e.a)(LK,"SmartArtTextViewDomManager",Dz.a,[]);class MK extends Ez.ViewSelectionChangedHandler{constructor(a,
b,c,f){super(a);this.ra=b;this.Le=c;this.PN=f}zpb(){return[Object(D.a)(this,this.vdc,"onSetup"),Object(D.a)(this,this.Tcc,"onEnsurePageViewElementsCreated"),Object(D.a)(this,this.Ucc,"onEnsureSelectedContentViewElementsCreated"),Object(D.a)(this,this.idc,"onMainLoop"),Object(D.a)(this,this.Lok,"onSmartArtContentSelect"),Object(D.a)(this,this.Pcc,"onCommit"),Object(D.a)(this,this.Idc,"onTearDown")]}Lok(a,b){this.wea(b);b=Object(va.a)(4,this.uh.rg);if(!b)return!1;a=Object(va.a)(618,b.oc(this.uh.Ma));
b=Object(va.a)(124,b.oc(this.Le));if(!a)return!1;this.ra.gSa()?a.uK()||(a.adb(),this.PN.Yo(!0),b&&b.adb()):a.uK()&&(a.bdb(),this.PN.Yo(!1),b&&b.bdb());return!0}}Object(e.a)(MK,"SmartArtTextViewSelectionChangedHandler",Ez.ViewSelectionChangedHandler,[]);class NK extends Rr.a{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){super(Nc.a.WT,a,c,f,l,F,fa,wa,Xa);this.Xbb=R;this.ra=b;this.qq=x;this.Le=lb;this.PN=Lb;this.Fa=kc;this.Cd.ATe=!0;this.Cd.kWd=!1}get wHd(){return u.AFrameworkApplication.fa}$Tb(a,b){return new LK(a,
b)}Sba(a){a=super.Sba(a);a.V1=ED.E_b(this);return a}sla(){super.sla();this.ug&&this.ug.Bn&&(this.wHd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.ug.ojc(Uc.a.NAc):this.ug.FHe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage,Uc.a.NAc),this.ug.Bn.setAttribute(Uc.a.vs,ResourceStrings.l_SmartArtTextPane))}Did(){this.sE.Ld===this&&this.suspend()}qdd(){this.sE.Ld===this&&this.resume()}dNc(){return new MK(this,
hb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Le,this.PN)}Kob(){this.sE.Ld===this&&this.ra.LLd();return!1}LKc(){return[Object(D.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(D.a)(this,this.floatieClickHandler,"floatieClickHandler"),Object(D.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(D.a)(this,this.defaultClickHandler,"defaultClickHandler")]}oLc(){return[Object(D.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}cLc(){return[Object(D.a)(this,
this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(D.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}onClick(a){a=super.onClick(a);this.Fa.Gj(Nc.a.WT,!0);return a}G6a(){return GK.a.Xre}get dI(){let a=super.dI;return a=ee.a("SmartArt.ListensToRenderOverlayInvalidations")?a|64:a|96}get dkc(){return!0}bfa(a,b,c=null){this.Xbb.C_(this)&&super.bfa(a,b,c)}Y4k(a){const b=this.qq.je(2);try{b.fd(a);let c=null;c=nd.SelectionFactory.nj(a,
!0);this.setSelection(c)}finally{b&&b.dispose()}}}Object(e.a)(NK,"SmartArtTextView",Rr.a,[347,389,390,202,106,252,391,392,393,394]);class OK extends Cz.a{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){super(a,b);this.fg=this.nh=null;this.WTa=!1;this.rta=Gb.App.Im;this.b3c=b;this.vb=this.Fd.container;this.jc(this.vb);this.gd=c;this.Fa=f;this.ia=l;this.ni=x;this.hv=F;this.FI=R;this.r9a=fa;this.z8=a;this.r8b=wa;this.od=Xa;this.ZC()}dispose(){this.gd.xb(qa.a.click,this.vb.parentNode,Object(D.a)(this,this.zGa,
"onBackgroundClick"));this.od.LQk(Object(D.a)(this,this.x0g,"onSmartArtTextPaneWidthChanged"));super.dispose()}cA(a){super.cA(a)}Xea(a){this.fD(this.fg,a,-1)}q5(){this.rIa(!0)}ZC(){this.nh=this.Fd.createElement("div");Sys.UI.DomElement.addCssClass(this.nh,"SmartArtTextView");Sys.UI.DomElement.addCssClass(this.nh,"SmartArtTextViewVisible");this.htmlElement.appendChild(this.nh);this.Ho(this.nh);this.fg=this.Fd.createElement("div");Sys.UI.DomElement.addCssClass(this.fg,"SmartArtTextViewContent");this.fg.style.width=
Xe.a.Lc(qf.a.Pkc-2*qf.a.oHb-2*qf.a.DMe-qf.a.Erh);this.nh.appendChild(this.fg);this.Ho(this.fg);u.AFrameworkApplication.isRtl&&(this.nh.style.direction=Ve.a.FYa);this.rIa(!0);this.gd.ob(qa.a.click,this.vb.parentNode,Object(D.a)(this,this.zGa,"onBackgroundClick"));this.od.I5h(Object(D.a)(this,this.x0g,"onSmartArtTextPaneWidthChanged"))}adb(){this.WTa=!0;this.uT();this.startEditing()}bdb(){this.WTa=!1;this.uT();this.endEditing()}uK(){return this.WTa}startEditing(){this.rIa(!0);this.rta=this.tYa.BDa;
this.FI.xjc(this.b3c,!1);this.FI.V$c(this.b3c)}endEditing(){this.r9a.setVisibility(!1);this.rIa(!0);this.Grh.endEditing(!0,14);this.r8b.jTd(this.z8);const a=new uu.a(this.tYa,this.rta);this.ia.Ka(ba.a.Pdb,2,a);const b=!!this.tYa&&this.tYa.isConnected;a.asa&&(b&&this.tYa.Tfd(),this.ni.O3a(this.tYa),this.hv.XLd());this.FI.xjc(this.b3c,b&&this.tYa.TRc)}zGa(){this.Fa.Gj(Nc.a.WT,!0);this.Grh.TQ();this.rIa(!0);this.rta=this.tYa.BDa;return!0}get ya(){return this.htmlElement}get tYa(){return this.b3c}get Grh(){return this.Oc}rIa(a){zD.b(a,
this.nh,"SmartArtTextViewHidden","SmartArtTextViewVisible")}x0g(a,b){this.fg.style.width=Xe.a.Lc(Xe.a.jn(b.width))}}Object(e.a)(OK,"SmartArtTextViewElement",Cz.a,[618,444]);class PK{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb){this.mPg=this.C9a=null;this.PN=a;this.QFa=b;this.od=c;this.Fa=f;this.hv=l;this.kL=x;this.ra=F;this.Qb=Object(va.a)(252,R);this.xq=fa;this.fh=wa;this.hc=Xa;this.e_=lb}lyj(){this.mPg=new KK.a(this.PN.xYf,"SmartArtTextViewContainer","SmartArtTextViewContainer InteractiveView EditMode");
this.QFa.Pza(this.mPg.wxa);rv.DPf(this.QFa);this.od.z5h(Object(D.a)(this,this.e0g,"onSingleSmartArtShapeViewElementSelected"));this.od.A5h(Object(D.a)(this,this.f0g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.od.H5h(Object(D.a)(this,this.w0g,"onSmartArtShapeViewElementDeselected"));this.od.SSb(Object(D.a)(this,this.o8c,"onSlideHtmlUpdated"));this.od.A2h(Object(D.a)(this,this.v0g,"onSmartArtCommentsVisibilityChanged"));this.kL.t6(Object(D.a)(this,this.wdc,"onShapeDisconneted"));
this.xq.vGd(Object(D.a)(this,this.wT,"onFocusChanged"));this.xq.Bzc(Object(D.a)(this,this.wT,"onFocusChanged"));this.Qb.RMa((a,b)=>{this.o8c(a,b)})}rsa(){return!this.hc.ln}$Le(a){if(this.e_){if(this.rsa()||a.nla)return}else if(this.rsa())return;a&&a.Qf&&!a.get_smartArtModelId()&&a.isConnected?(ya.a.J(38618783,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is SmartArt"),a.AMe||(this.C9a!==a&&(this.C9a=a,this.rTd(),this.KGf(a)),this.PN.aTe(a),this.PN.Yo(!0))):ya.a.J(38618785,822,50,
"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is not SmartArt or not connected")}Vcl(a){this.rsa()||(a&&a.Qf&&!a.get_smartArtModelId()&&a.isConnected?(ya.a.J(38618787,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is SmartArt"),a.AMe||(this.C9a!==a&&(this.C9a=a,this.rTd(),this.KGf(a)),this.Fa.Gj(Nc.a.WT,!0),this.hv.Pv(),this.QFa.Y4k(a),this.PN.aTe(a),this.PN.Yo(!0))):ya.a.J(38618817,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is not SmartArt or not connected"))}$Wf(){this.PN.isVisible&&
(ya.a.J(38618819,822,50,"SmartArtTextViewHelper::DismissSmartArtTextPane"),this.PN.Yo(!1))}e0g(a,b){this.rsa()||this.$Le(b.shapeNode)}f0g(a,b){this.rsa()||this.Vcl(b.shapeNode)}w0g(){this.rsa()||this.$Wf()}o8c(){if(!this.rsa()&&this.ra.GK()){const a=this.ra.$Ba();ya.a.J(38618821,822,50,"SmartArtTextViewHelper::OnSlideHtmlUpdated");a&&this.PN.aTe(a)}}wT(a,b){this.rsa()||(a=b.EBb,a===Nc.a.WT?this.fh.TJ(Nc.a.WT):this.fh.z3b(a)&&this.fh.qo(Nc.a.WT))}KGf(a){a&&a.isConnected&&this.QFa.iA(a)}rTd(){this.QFa.Ro&&
(this.QFa.editingView.disable(!0,14),this.QFa.detach())}wdc(a,b){this.rsa()||b.node!==this.C9a||(this.C9a=null,this.rTd(),this.PN.Yo(!1))}v0g(a,b){this.rsa()||((a=b.B7k)?a.Qf&&this.$Le(a):(a=this.ra.$Ba())?this.C9a!==a&&this.$Le(a):this.$Wf())}dispose(){this.od.DQk(Object(D.a)(this,this.e0g,"onSingleSmartArtShapeViewElementSelected"));this.od.EQk(Object(D.a)(this,this.f0g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.od.KQk(Object(D.a)(this,this.w0g,"onSmartArtShapeViewElementDeselected"));
this.od.NOk(Object(D.a)(this,this.v0g,"onSmartArtCommentsVisibilityChanged"));this.kL.yHa(Object(D.a)(this,this.wdc,"onShapeDisconneted"));this.xq.edh(Object(D.a)(this,this.wT,"onFocusChanged"));this.xq.wcd(Object(D.a)(this,this.wT,"onFocusChanged"));this.od.Cdh(Object(D.a)(this,this.o8c,"onSlideHtmlUpdated"));this.Qb.Shc((a,b)=>{this.o8c(a,b)})}}Object(e.a)(PK,"SmartArtTextViewHelper",null,[348,106]);class FD{constructor(){this.K=null;this.Iz=!1}get name(){return"PowerPointWebEditor.SmartArt"}Wb(a){this.K=
a;this.K.register(347,"PowerPointWebEditor.ISmartArtTextView").ma().na(()=>new NK(this.K.resolve("Box4.IWorkspace"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),
this.K.La("Box4.ITextMetricsAdapter"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.register(348,"PowerPointWebEditor.ISmartArtTextViewHelper").ma().na(()=>new PK(this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").qia))}init(){const a=this.K.resolve("Common.IAppSettingsManager");
a.ff(()=>{if(this.Iz=a.ka("341"))this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(1074135132,new Em.a((b,c)=>Object(Fa.a)(347,b)?(c=Object(va.a)(4,c))&&c.Qf?new OK(b,c,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")):null:null)),this.K.resolve("Box4.IEditingView"),this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").lyj()})}dispose(){this.Iz&&(this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").dispose(),this.K.resolve("PowerPointWebEditor.ISmartArtTextView").dispose())}static main(){m.a.instance.Ac(new FD)}}Object(e.a)(FD,
"PPTWebEditorSmartArtPackage",null,[2,3]);class QK{constructor(){this.lvl9pPrField=this.lvl8pPrField=this.lvl7pPrField=this.lvl6pPrField=this.lvl5pPrField=this.lvl4pPrField=this.lvl3pPrField=this.lvl2pPrField=this.lvl1pPrField=this.defPPrField=null}}Object(e.a)(QK,"CT_WebTextListStyle",null,[]);var Hz=d(494),Mi=d(236);class sv{constructor(a,b,c,f){this.type=a;this.stops=b;this.angle=c;this.ruk=f}jU(){const a=Wq.b(this.stops,b=>b.jU()).join(",");if(0===this.type)return String.format("linear-gradient({0}deg, {1})",
this.angle,a);if(1===this.type||2===this.type)return String.format("radial-gradient(circle at {0}, {1})",this.ruk.jU(),a);ya.a.J(18392962,822,15,String.format("Unexpected gradient type encountered: {0}.",this.type));return Mi.Color.auto.jU()}static createLinearGradient(a,b){return new sv(0,a,b,null)}static czi(a,b){return new sv(1,a,0,b)}}Object(e.a)(sv,"GradientFill",null,[]);class GD{constructor(a,b){this.left=a;this.top=b}jU(){return String.format("{0}% {1}%",this.left,this.top)}}Object(e.a)(GD,
"GradientPathCenter",null,[]);class RK{constructor(a,b){this.color=a;this.position=b}jU(){return String.format("{0} {1}%",this.color.jU(),this.position)}}Object(e.a)(RK,"GradientStop",null,[]);const Iz=a=>{a=Ri.a(a);return!a||!a.blipFillField&&!a.gradFillField&&!a.grpFillField&&!a.noFillField&&!a.pattFillField&&!a.solidFillField},Jx=a=>{Cf.Box4ColorHelper.ROa(a)},rQ=(a,b)=>{if(!a)return null;var c=a.gsLstField;if(c){var f=new Ha.a;for(const l of c)c=Cf.Box4ColorHelper.rIc(l),Cf.Box4ColorHelper.L7d(c)?
ya.a.J(18397184,822,15,"Encountered invalid gradient stop color."):f.add(new RK(Cf.Box4ColorHelper.CL(c,b),l.posField/1E3));b=f.toArray()}else b=null;if(a.linField)return f=90,a.linField.angFieldSpecified&&(f=(a.linField.angField/6E4+90)%360),sv.createLinearGradient(b,f);if(a.pathField)return f=new GD(50,50),a.pathField.fillToRectField&&(f=new GD(a.pathField.fillToRectField.lField/1E3,a.pathField.fillToRectField.tField/1E3)),sv.czi(b,f);ya.a.J(18397154,822,50,"Gradient fill's linField and pathField are both null");
return sv.createLinearGradient(b,90)},SK=a=>{if(!a)return null;a=Ri.a(a);return Object.assign(new Hz.a,{blipFillField:a.blipFillField||null,gradFillField:a.gradFillField||null,grpFillField:a.grpFillField||null,noFillField:a.noFillField||null,pattFillField:a.pattFillField||null,solidFillField:a.solidFillField||null})};class TK{constructor(a){this.xja=a}u1(a,b){const c=a.tableStyle;if(c){var f=a.tableLook,l=!!(f&32)&&!!c.firstRowField,x=!!(f&64)&&!!c.lastRowField,F=!!(f&128)&&!!c.firstColField,R=!!(f&
256)&&!!c.lastColField,fa=l&&F&&!!c.nwCellField,wa=l&&R&&!!c.neCellField,Xa=x&&F&&!!c.swCellField,lb=x&&R&&!!c.seCellField,Lb=!!(f&512)&&!!c.band1HField,kc=!!(f&512)&&!!c.band2HField,lc=!!(f&1024)&&!!c.band1VField;f=!!(f&1024)&&!!c.band2VField;var Ec=!b.ge,Jc=b.Wf===a.wX,Dc=!b.Yd;a=b.Jf===a.Spa;var Wd=1===b.ge%2===l;b=1===b.Yd%2===F;var xe=!(l&&Ec)&&!(x&&Jc),Sd=!(F&&Dc)&&!(R&&a);c.wholeTblField&&this.apply(c.wholeTblField);xe&&(Lb&&Wd||kc&&!Wd)&&(Wd?this.apply(c.band1HField):this.apply(c.band2HField));
Sd&&(lc&&b||f&&!b)&&(b?this.apply(c.band1VField):this.apply(c.band2VField));a&&R&&this.apply(c.lastColField);Dc&&F&&this.apply(c.firstColField);Jc&&x&&(this.apply(c.lastRowField),a&&lb&&this.apply(c.seCellField),Dc&&Xa&&this.apply(c.swCellField));Ec&&l&&(this.apply(c.firstRowField),a&&wa&&this.apply(c.neCellField),Dc&&fa&&this.apply(c.nwCellField))}}apply(a){if(a.tcTxStyleField){var b=a.tcTxStyleField;a=Ri.a(b);Cf.Box4ColorHelper.L7d(a)||(Cf.Box4ColorHelper.ROa(this.xja),this.xja.solidFillField=new zh.a,
Cf.Box4ColorHelper.$8h(this.xja.solidFillField,a));a=b.bField;var c=b.iField;if(b.fontRefField){b=b.fontRefField.idxField;var f=this.xja;0===b||1===b?(f.latinField=Je.Bpb(b,0),f.eaField=Je.Bpb(b,1),f.csField=Je.Bpb(b,2)):ya.a.J(8959121,820,10,"StyleResolverHelper::ResolveToThemeFont - Invalid font collection index encountered")}else b.fontField&&(b=b.fontField,null!==b.latinField&&(this.xja.latinField=b.latinField),null!==b.eaField&&(this.xja.eaField=b.eaField),null!==b.csField&&(this.xja.csField=
b.csField));if(0===a||1===a)this.xja.bFieldSpecified=!0,this.xja.bField=0===a;if(0===c||1===c)this.xja.iFieldSpecified=!0,this.xja.iField=0===c}}}Object(e.a)(TK,"CellTextStylePartApplier",null,[]);class Ns{constructor(a){this.iQg=a}get value(){return this.iQg.valField/1E5}set value(a){this.iQg.valField=Math.floor(1E5*a)}get type(){return Ns.rUb}}Ns.rUb="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(e.a)(Ns,"LineSpacingPercent",null,[642,643]);class gr{constructor(a){this.jQg=
a}get value(){return this.jQg.valField/100}set value(a){this.jQg.valField=Math.floor(100*a)}get type(){return gr.rUb}}gr.rUb="CT_TextSpacingPoint:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(e.a)(gr,"LineSpacingPoint",null,[642,643]);class sQ{constructor(){this.valField=0}}Object(e.a)(sQ,"CT_TextSpacingPoint",null,[]);class Os{constructor(a){this.jee=a}get lineSpacing(){return this.jee}get value(){return this.jee.value}set value(a){this.jee.value=a}static rWb(a){if(a.__type===Ns.rUb)return new Os(new Ns(a));
if(a.__type===gr.rUb)return new Os(new gr(a));ya.a.J(8958300,820,10,"Unsupported line spacing format {0}",a.__type);return null}}Object(e.a)(Os,"LineSpacingWrapper",null,[]);const UK=(a,b)=>{switch(b){case 0:return a.defPPrField;case 1:return a.lvl1pPrField;case 2:return a.lvl2pPrField;case 3:return a.lvl3pPrField;case 4:return a.lvl4pPrField;case 5:return a.lvl5pPrField;case 6:return a.lvl6pPrField;case 7:return a.lvl7pPrField;case 8:return a.lvl8pPrField;case 9:return a.lvl9pPrField;default:return null}},
VK=(a,b)=>{b.baselineFieldSpecified&&(a.baselineFieldSpecified=!0,a.baselineField=b.baselineField);b.bFieldSpecified&&(a.bFieldSpecified=!0,a.bField=b.bField);b.capFieldSpecified&&(a.capFieldSpecified=!0,a.capField=b.capField);b.iFieldSpecified&&(a.iFieldSpecified=!0,a.iField=b.iField);b.noProofFieldSpecified&&(a.noProofFieldSpecified=!0,a.noProofField=b.noProofField);b.rtlFieldSpecified&&(a.rtlFieldSpecified=!0,a.rtlField=b.rtlField);b.strikeFieldSpecified&&(a.strikeFieldSpecified=!0,a.strikeField=
b.strikeField);b.szFieldSpecified&&(a.szFieldSpecified=!0,a.szField=b.szField);b.uFieldSpecified&&(a.uFieldSpecified=!0,a.uField=b.uField);b.altLangField&&(a.altLangField=b.altLangField);b.blipFillField&&(a.blipFillField=b.blipFillField);b.csField&&(a.csField=b.csField);a.dirtyField=b.dirtyField;b.eaField&&(a.eaField=b.eaField);a.errField=b.errField;b.gradFillField&&(a.gradFillField=b.gradFillField);b.grpFillField&&(a.grpFillField=b.grpFillField);b.highlightField&&(a.highlightField=b.highlightField);
b.hlinkClickField&&(a.hlinkClickField=b.hlinkClickField);b.hlinkMouseOverField&&(a.hlinkMouseOverField=b.hlinkMouseOverField);b.langField&&(a.langField=b.langField);b.latinField&&(a.latinField=b.latinField);b.noFillField&&(a.noFillField=b.noFillField);b.pattFillField&&(a.pattFillField=b.pattFillField);b.solidFillField&&(a.solidFillField=b.solidFillField);b.symField&&(a.symField=b.symField)},tQ=a=>{switch(a){case 1:return 2;case 2:return 3;case 3:return 6;case 4:return 10;case 5:return 7;case 6:return 13;
default:return 1}};class Kx{constructor(){this.Gob=Array(Kx.Mwh);this.kxe=Array(Kx.Mwh)}}Kx.Mwh=9;Object(e.a)(Kx,"TextListStyleCache",null,[]);class WK{constructor(){this.restartInfo=this.nextNumber=1;this.listStyle=this.nextListId=0;this.autonumberBulletType=8}}Object(e.a)(WK,"NumberingData",null,[]);class tv{}tv.ZJd="\u2022";tv.efi="p";tv.ffi="n";Object(e.a)(tv,"ListFormats",null,[]);class XK{constructor(a,b,c,f){this.OQg=this.PQg=Gb.App.Im;this.oDg=null;this.rc=a;this.Gl=b;this.eL=c;this.Jz=f}get caches(){return this.oDg||
(this.oDg={})}g7f(a,b,c){const f=c-1;let l=a.HZ;var x;const F=!!l&&!Ga.a.nil.equals(l[f]);if(F&&(x=this.caches[l[f].toString()]))return x=x.clone(),b=Ga.a.create(),a.Ch.SD(x,b),x;if(!F)if(l)l=Array.clone(l);else for(l=Array(9),x=0;x<l.length;x++)l[x]=Ga.a.nil;const R=F?l[f]:Ga.a.create();x=this.Opi(a,b,c);l[f]=R;this.caches[R.toString()]=x;F||(a.HZ=l);a.Ch.SD(x,R);F&&(x=x.clone(),a.Ch.SD(x,Ga.a.create()));return x}Opi(a,b,c){const f=go.a.instance.createInstance(131073);if(b){var l=b.W6f(a.rowIndex,
a.li,a.rowSpan,a.colSpan);b=(b=(b=a.listStyle)?UK(b,c):null)||new gn;if(l){var x=c-1;c=l.Gob[x];x=l.kxe[x];if(c||x){l=b.defRPrField||new rr;if(x){const F=fe.a(fe.c(x));x=F;b.algnFieldSpecified&&(x.algnFieldSpecified=!0,x.algnField=b.algnField);b.indentFieldSpecified&&(x.indentFieldSpecified=!0,x.indentField=b.indentField);b.lvlFieldSpecified&&(x.lvlFieldSpecified=!0,x.lvlField=b.lvlField);b.marLFieldSpecified&&(x.marLFieldSpecified=!0,x.marLField=b.marLField);b.marRFieldSpecified&&(x.marRFieldSpecified=
!0,x.marRField=b.marRField);b.rtlFieldSpecified&&(x.rtlFieldSpecified=!0,x.rtlField=b.rtlField);b.buAutoNumField&&(x.buAutoNumField=b.buAutoNumField);b.buCharField&&(x.buCharField=b.buCharField);b.buClrField&&(x.buClrField=b.buClrField);b.buClrTxField&&(x.buClrTxField=b.buClrTxField);b.buFontField&&(x.buFontField=b.buFontField);b.buFontTxField&&(x.buFontTxField=b.buFontTxField);b.buNoneField&&(x.buNoneField=b.buNoneField);b.buSzPctField&&(x.buSzPctField=b.buSzPctField);b.buSzPtsField&&(x.buSzPtsField=
b.buSzPtsField);b.buSzTxField&&(x.buSzTxField=b.buSzTxField);b.defRPrField&&(x.defRPrField=b.defRPrField);b.lnSpcField&&(x.lnSpcField=b.lnSpcField);b.spcAftField&&(x.spcAftField=b.spcAftField);b.spcBefField&&(x.spcBefField=b.spcBefField);b=F}c&&(c=fe.a(fe.c(c)),VK(c,l),b.defRPrField=c)}}a=Object(va.a)(122,this.rc.Sg(a));this.Wpi(f,b,a?a.Se:null)}f.ke(ub.a.x2b,!0);return f}Wpi(a,b,c){this.Vpi(a,b);if(b){if(b.algnFieldSpecified){var f=tQ(b.algnField);a.setValue(bb.a.pl,f);a.setValue(bb.a.rI,f)}b.marLFieldSpecified&&
a.ke(Bb.a.Il,je.a.sqb(b.marLField));b.marRFieldSpecified&&a.ke(Bb.a.kX,je.a.sqb(b.marRField));b.indentFieldSpecified&&a.ke(Bb.a.Mn,je.a.sqb(b.indentField));b.defTabSzFieldSpecified&&a.setValue(Bb.a.Ppb,je.a.sqb(b.defTabSzField));b.spcAftField&&(f=Os.rWb(b.spcAftField.itemField),Object(Fa.a)(Ns,f.lineSpacing)?a.setValue(ub.a.lja,2):Object(Fa.a)(gr,f.lineSpacing)&&a.setValue(ub.a.lja,4),a.setValue(ub.a.kca,f.value));b.spcBefField&&(f=Os.rWb(b.spcBefField.itemField),Object(Fa.a)(Ns,f.lineSpacing)?a.setValue(ub.a.mja,
2):Object(Fa.a)(gr,f.lineSpacing)&&a.setValue(ub.a.mja,4),a.setValue(ub.a.lca,f.value));b.lnSpcField&&(f=Os.rWb(b.lnSpcField.itemField),Object(Fa.a)(Ns,f.lineSpacing)?a.setValue(ub.a.ZV,2):Object(Fa.a)(gr,f.lineSpacing)&&a.setValue(ub.a.ZV,4),a.setValue(ub.a.Nw,f.value))}else ya.a.J(8959502,820,10,"TextPropertyHelper::ComposeParagraphProperties - ParagraphProperties is null");b.defRPrField&&Uj.Ppi(a,b.defRPrField,c)}jTk(a){if(a=a.HZ)for(let b=0;b<a.length;b++){const c=a[b];c&&!Ga.a.nil.equals(c)&&
delete this.caches[c.toString()]}}Vpi(a,b){var c=this.Fw(b);a.vx(c.propertySet);b.marLFieldSpecified&&a.setValue(Bb.a.Il,je.a.sqb(b.marLField));b.indentFieldSpecified&&a.setValue(Bb.a.Mn,je.a.sqb(b.indentField));b.defRPrField&&b.defRPrField.szFieldSpecified&&a.setValue(bb.a.fontSize,Uj.vQf(b.defRPrField.szField));b.spcAftField&&(c=Os.rWb(b.spcAftField.itemField),Object(Fa.a)(gr,c.lineSpacing)&&(a.setValue(ub.a.lja,4),a.setValue(ub.a.kca,c.value)));b.spcBefField&&(b=Os.rWb(b.spcBefField.itemField),
Object(Fa.a)(gr,b.lineSpacing)&&(a.setValue(ub.a.mja,4),a.setValue(ub.a.lca,b.value)))}Fw(a){let b;({Fce:b,xYj:c}=this.LZd(a));var c=uj.a.kP(b,c);0===b&&(c.Yz=c.YV=a.buAutoNumField.startAtField);return c}LZd(a){let b,c;b=16;c=1;if(a)if(a.buCharField)switch(b=1,a.buCharField.charField){case tv.efi:case tv.ffi:c=3}else if(a.buAutoNumField)switch(b=0,a.buAutoNumField.typeField){case 9:case 8:case 6:case 7:c=1;break;case 4:case 0:case 2:c=2;break;case 14:case 10:case 12:c=3;break;case 5:case 1:case 3:c=
4;break;case 15:case 11:case 13:c=5}return{Fce:b,xYj:c}}validate(a){if(Object(va.a)(ag.a,a)&&(this.Gl.gDa(a)||Ui.OutlineReader.RV(a))&&a.isConnected){this.PQg=new Date;var b=Array($o.a.C6);for(var c=0;c<$o.a.C6;++c)b[c]=new WK;c=-1;var f=0,l=!1;a=wi.a.qz(a);for(a.Jl(Object(D.a)(this,this.aTj,"listOEFilter"),null);a.moveNext();){16===a.iterator.currentNode.type&&(c=-1,f=0,l=!1,this.MQc(b,0),this.M6d(b,0,0));if(11!==a.iterator.currentNode.type)continue;const x=a.iterator,F=this.Bba(x);let R=b[F].nextListId,
fa=null;if(Ib.ListReader.ak(x)){this.Jz.gla(x);fa=this.Jz.EZd(x);const wa=this.fYi(x);x.uc();if(!fa){Sa.a.instance.Tb("PossibleIncorrectListNumbering",{["Reason"]:"ListInfoNotFound"});continue}if(0===fa.listType){if(fa.Yz!==Pk.a.kw&&b[F].restartInfo!==fa.Yz||fa.listStyle!==b[F].listStyle||wa!==b[F].autonumberBulletType)l=!0,b[F].restartInfo=b[F].nextNumber=fa.Yz===Pk.a.kw?1:fa.Yz,R=b[F].nextListId=0,b[F].listStyle=fa.listStyle,b[F].autonumberBulletType=wa;fa.YV=b[F].nextNumber;c!==F||l?(fa.Eha=b[F].nextNumber,
l=!1):fa.Eha=Pk.a.kw;this.eL.isEmpty(x,!1)?l=!0:b[F].nextNumber++}else 1!==fa.listType&&Sa.a.instance.Tb("PossibleUnexpectedListAlteration",{["Reason"]:"UnknownListType"});R||(R=b[F].nextListId=++f);x.currentNode.listID=R}c=F;fa?(0===fa.listType?this.MQc(b,F+1):this.MQc(b,F),this.M6d(b,F+1,R)):(this.MQc(b,F),this.M6d(b,F,0))}this.OQg=new Date;ya.a.J(22344988,820,50,"ListCore::Validate {0}",+this.OQg-+this.PQg)}}Bba(a){this.eL.Tg(a)||Sa.a.instance.Tb("PossibleListLevelIncorrect",{["Reason"]:Bd.a.eba});
return a.currentNode.sa(Bb.a.listLevel,Sg.a.vCa)}Z5i(a){this.eL.Tg(a)||Sa.a.instance.Tb("PossibleLossOfAccessibilityInfoForList",{["Reason"]:Bd.a.eba});return a.currentNode.listID}aTj(a){return this.eL.Tg(a)||xd.TableReader.Np(a)||ik.l(a)||De.isTableCell(a)}MQc(a,b){for(;b<$o.a.C6;++b)a[b].nextNumber=a[b].restartInfo=1}M6d(a,b,c){for(;b<$o.a.C6;++b)a[b].nextListId=c}fYi(a){return a.currentNode.sa(ub.a.autonumberBulletType,8)}}Object(e.a)(XK,"ListCore",null,[343]);class Wp{constructor(a,b,c=null){this.Rf=
a;this.xi=b;this.gt=null;this.Bkb=c}get X9k(){return!1}OHk(a){return a}dGb(a){let b,c,f;b=Ib.ListReader.i5a;c=a.propertySet.sa(Bb.a.listID,0);f=a.propertySet.sa(Bb.a.listLevel,-1);if(H.a.instance.ga(85)||b&&0<c&&0<=f)this.gt=a;else{let l=1;const x=a.listStyle;b&&42!==x&&0<x&&(l=x);this.gt=uj.a.kP(a.listType,l,null,c,f,void 0,"")}}T3k(a){a&&(this.gt=a)}qSd(){}createList(a){const b=Sa.a.instance.Bp(C.a.createList);Rd.OutlineElementReader.Tg(a)||Sa.a.instance.Tb("PossiblyIncorrectListCreation",{["Reason"]:Bd.a.eba});
Ib.ListReader.ak(a)&&Sa.a.instance.Tb("PossiblyIncorrectListCreation",{["Reason"]:Bd.a.Qsi});const c=this.ayi();a.hl(c,4);a.Ak(c);b.end();return c}ayi(){return rs.a.instance.createInstance(393234)}ema(a){const b=Sa.a.instance.Bp(C.a.ema);Rd.OutlineElementReader.Tg(a)||Sa.a.instance.Tb("PossiblyIncorrectListRemoval",{["Reason"]:Bd.a.eba});Ib.ListReader.ak(a)&&this.aOk(a);b.end()}aOk(a){this.Rf.gla(a);a.Ii()}onb(a,b,c,f=!1){const l=Sa.a.instance.Bp(C.a.P8h);if(!this.VKf(b,c))return{returnValue:!1,G7a:c};
this.Rlh(a,c,f);f=a.Sa(be.a.cUg);var x=a.sa(be.a.wrg,!1);let F=!1;1===c.IZ&&c.Y$d&&!c.HS&&(F=!0);const R=c.propertySet.sa(Bb.a.I5b,null);R&&R===Box4Intl.Box4Strings.L_ListStyleNone&&(1===c.listType?F=c.Y$d&&!c.HS:0===c.listType&&(F=0===c.listStyle));x?F&&(c.eIa(16,0),a.setValue(be.a.tD,16),a.setValue(be.a.nca,0)):(x=this.Rf.Fw(b),this.jph(c,x,f,F,a)&&(l.properties.$("ToggledOff","true"),c.eIa(16,0),this.d3k(a)),0===c.listType&&a.Sa(be.a.FSa)&&(c.Yz=a.getValue(be.a.FSa),a.removeProperty(be.a.FSa)));
if(f&&(l.properties.$("MultipleOESelection","true"),({G7a:c}=this.aph(b,c)).returnValue))return l.end(),{returnValue:!1,G7a:c};this.v6h(b,c,a);a.setValue(be.a.wrg,!0);l.end();return{returnValue:!0,G7a:c}}jph(a,b,c,f){if(f)return!0;if(b){f=a.listType===b.listType;const l=0===a.listStyle&&a.Yz===Pk.a.kw;a=a.listStyle===b.listStyle&&a.Yz===b.Yz;this.Rf.j9a&&(a=a&&!c);return f&&(l||a)}return!1}d3k(a){a.setValue(be.a.tD,16);a.setValue(be.a.nca,0)}Rlh(){}VKf(){return!0}aph(a,b){return{returnValue:16!==
b.listType&&Rd.OutlineElementReader.isEmpty(a,!0),G7a:b}}Rob(a){const b=Sa.a.instance.Bp(C.a.Rob);Ya.ParagraphReader.Wd(a)||Sa.a.instance.Tb("ClearingListFromNonParagraph",{["Reason"]:Bd.a.ZRd});const c=new mb.GraphIterator;c.set(a);c.Ze();c.oC(12);Yb.OutlineElementNavigator.Je(c);this.V2a(c,null);b.end()}JHd(){}merge(a,b,c){const f=Sa.a.instance.Bp(C.a.$Sj);Rd.OutlineElementReader.Tg(b)||Sa.a.instance.Tb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Rd.OutlineElementReader.Tg(a)||Sa.a.instance.Tb("PossibleIncorrectMergeOfOEs",
{["Reason"]:"DestIsNotOE"});if(Ib.ListReader.ak(b)){f.properties.$("UseSourceListWithNonlistDestination",c.toString());let l;l=Ib.ListReader.i5a;c&&this.X9k&&Ib.ListReader.ak(a)&&this.ema(a);if(!Ib.ListReader.ak(a)||c&&l)c&&(u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),c=this.DZd(b),this.Rf.$th&&c.propertySet.ke(bb.a.HSa,Pk.a.kw),1===c.IZ&&c.CMf(),this.V2a(a,c),f.properties.$("MoveListInfoFromSrcToDestOE","true")),u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
Wp.KK.kTc&&this.jji(b,a);this.ema(b);f.properties.$("RemoveListFromSrcOE","true")}f.end();return!0}jji(a,b){a=Ya.ParagraphReader.Yrb(a.currentNode);b=this.Rf.gag(b);this.zfd(b,a,null)}DZd(a){return this.Rf.Fw(a)}zfd(a,b,c){if(a){b=Pc.a.create(b);b=tb.a.Bs(b);this.TXa(a,bb.a.fontColor,c,b);this.TXa(a,bb.a.fontSize,c,b);if(this.Bkb){let f,l;({value:f}=this.getPropertyValue(bb.a.font,c,b,"")).returnValue&&this.Bkb.AX(a,f);({value:l}=this.getPropertyValue(Bb.a.iU,c,b,-1)).returnValue&&this.Bkb.mIa(a,
l)}else this.TXa(a,bb.a.font,c,b),this.TXa(a,Bb.a.iU,c,b);u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");Wp.KK.kTc&&(this.TXa(a,bb.a.bold,c,b),this.TXa(a,bb.a.italic,c,b),this.TXa(a,bb.a.superscript,c,b),this.TXa(a,bb.a.subscript,c,b))}}Flh(){}TXa(a,b,c,f){c&&c.Sa(b)?a.setValue(b,c.getValue(b)):f&&f.cache&&(c=f.cache,c.Sa(b)&&a.setValue(b,c.getValue(b)))}getPropertyValue(a,b,c,f){if(b&&b.Sa(a))return f=b.getValue(a),{returnValue:!0,
value:f};if(!c||!c.cache)return{returnValue:!1,value:f};b=c.cache;return b.Sa(a)?(f=b.getValue(a),{returnValue:!0,value:f}):{returnValue:!1,value:f}}G_f(a,b){b.Sa(be.a.tD)||(a===C.a.tO?b.setValue(be.a.tD,1):a===C.a.XQ&&b.setValue(be.a.tD,0));b.Sa(be.a.nca)||b.setValue(be.a.nca,0);return b}gNa(a,b,c,f,l,x,F){a=Sa.a.instance.Bp(C.a.gNa);const R=this.Rf.Fw(b);c=uj.a.kP(0,c);c.Yz=f;c.Gpa=x;R&&c.w3d(R)&&c.Yz===R.YV||(f=new We.GraphTransaction(15),f.Tx(b),b=this.r8i(c),null!=b&&F.numbering(b)&&(Z.ULS.sendTraceTag(509747284,
393,50,"Found list insert matching string "+x),Wp.characterPropertiesEditor.replaceTextRange(l,"")),f.dispose());a.end()}r8i(a){var b;let c=null===(b=null===av||void 0===av?void 0:av[a.listType])||void 0===b?void 0:b[a.Gpa];if(null==c)return null;b=new E.DictionaryPropertySet;b.setValue(be.a.tD,a.listType);b.setValue(be.a.nca,a.listStyle);b.setValue(be.a.FSa,a.Yz);b.setValue(bb.a.Ni,c.Ni);this.z0k(b,c.autonumberBulletType);return b}static get characterPropertiesEditor(){return Wp.Vg||(Wp.Vg=hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get KK(){return Wp.GJ||
(Wp.GJ=hb.a.instance.pb("Box4.List.ListSettings"))}}Wp.Vg=null;Wp.GJ=null;Object(e.a)(Wp,"ListEditor",null,[342]);class Rn{}Rn.pre=80640;Rn.qre=0;Rn.i5d=80640;Rn.j5d=-80640;Object(e.a)(Rn,"ParagraphConstants",null,[]);var Xl=d(182);class YK extends Wp{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){super(a,b);this.EWc=[bb.a.Ni,bb.a.font];this.c0c=[bb.a.Ni,bb.a.font,bb.a.fontColor,ub.a.autonumberBulletType,ub.a.erb];this.Aab=c;this.z9b=f;this.Cke=l.hvg;this.eL=x;this.Gl=F;this.KG=fa;this.Qz=wa;this.kj=
Xa;this.yUa=lb;this.VIg=l.O9d;this.b_c=l.jvg;this.WK=Lb;this.Mb=kc;this.Ea=lc;this.ota=l.pptCopyPasteListMarkerEnabled;this.c9b=l.pptCopyPasteMarginAndIndentationEnabled;this.bJg=l.pptCopyPasteTextWithSpacingFromExternal}dGb(a){super.dGb(a);this.b_c&&this.qEc(a.propertySet,this.gt.propertySet)}uIe(a){if(this.Cke&&this.gt&&this.gt.propertySet){const b=this.gt.propertySet.sa(Bb.a.listLevel,-1);-1!==b&&this.vIe(a,b)}this.ota&&this.gt&&(this.gt.mrb=!0);this.bJg&&this.slh(a);this.KHd(a,this.gt);this.gt=
null}elh(a,b,c){b=this.xi.L2b(a);this.xi.uHb(a,b,c,!1,!0)}VKf(a,b){if(!a||!b)return!1;if(a.zb(4)){var c=this.Rf.EZd(a);this.Aab.Je(a);if(c&&c.listType===b.listType&&(1===b.listType||0===b.listType))return!0}c=a.zb(2);const f=c.sa(Bb.a.Mn,Sg.a.indent),l=c.sa(Bb.a.Il,Sg.a.leftMargin);this.Aab.Je(a);a=f;let x=l;({indent:a,margin:x}=this.CKd(Uj.WHf(Ya.ParagraphReader.Nha(c,bb.a.fontSize,0)),b.listType,f,l,a,x));return!!(this.zIj(x)&this.uHj(a))}t$f(a,b,c,f){if(!a)return ya.a.J(512496326,820,15,"ListEditor::GetIndentationFromListStyle - paragraphNode is null"),
{xbe:c,h5d:f};b&&(c=b.sa(ub.a.fXb,Sg.a.leftMargin),f=b.sa(ub.a.yQd,Sg.a.indent),(a=this.Ea.kn(a))&&a.nd&&(c=b.sa(Bb.a.Il,Sg.a.leftMargin),f=b.sa(Bb.a.Mn,Sg.a.indent)));return{xbe:c,h5d:f}}nKf(a,b,c,f){if(!a||!this.eL.Tg(b))return ya.a.J(512496325,820,15,"ListEditor::CalculateDefaultMarginAndIndent - paragraphNode is null or iterator is not outline element "),{$Ud:c,ZUd:f};var l=this.vP(b,this.KG.Bba(b));if(l){const x=a.sa(Bb.a.Il,Sg.a.leftMargin),F=a.sa(Bb.a.Mn,Sg.a.indent);c=x;f=F;let R=Sg.a.leftMargin,
fa=Sg.a.indent;({xbe:R,h5d:fa}=this.t$f(a,l,R,fa));l=uj.a.uAa(l,null).listType;const wa=x+(0<=F?0:F),Xa=R+(0<=fa?0:fa),lb=b.zb(4);let Lb=16;lb&&(Lb=this.z9b.isb(lb),b.uc());fa&&wa===Xa&&l===Lb?(c=R,f=fa):({indent:f,margin:c}=this.CKd(this.i6a(a),Lb,F,x,f,c),c=Math.max(Math.min(c,Rn.pre),Rn.qre),f=Math.max(Math.min(f,Rn.i5d),Rn.j5d))}return{$Ud:c,ZUd:f}}a1i(a,b){if(!a||!this.eL.Tg(b))return ya.a.J(512496324,820,15,"ListEditor::GetDefaultMargin - paragraphNode is null or iterator is not outline element "),
Sg.a.leftMargin;let c=Sg.a.leftMargin,f=Sg.a.indent;({$Ud:c,ZUd:f}=this.nKf(a,b,c,f));0<c&&ya.a.J(512496323,820,50,"Get defaultMargin from liststyle");return c}X0i(a,b){if(!a||!this.eL.Tg(b))return ya.a.J(512496322,820,15,"ListEditor::GetDefaultIndent - paragraphNode is null or iterator is not outline element "),Sg.a.indent;let c=Sg.a.leftMargin,f=Sg.a.indent;({$Ud:c,ZUd:f}=this.nKf(a,b,c,f));0<f&&ya.a.J(512496321,820,50,"Get defaultIndent from liststyle");return f}aph(a,b){return{returnValue:!1,
G7a:b}}jph(a,b,c,f,l){return f?!0:!b||l&&l.Sa(bb.a.Ni)?!1:a.listType===b.listType}zIj(a){return a<Rn.pre&&a>=Rn.qre}uHj(a){return a<Rn.i5d&&a>=Rn.j5d}Cgd(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertBulletViaKeyboardEnabled",!1)}z0k(a,b){a.setValue(ub.a.autonumberBulletType,b)}Y$k(a){return a}qSd(a,b){a.Sa(Bb.a.listLevel)&&b.ke(Bb.a.listLevel,a.Sh(Bb.a.listLevel))}l6i(a,b){return Object(Fa.a)(Xl.TableCellNode,a)?this.KG.g7f(a,this.Qz.xNc(a),b):
this.b8i(a,b)}b8i(a,b){--b;const c=a.sa(Bb.a.HZ,[]);return 0>b||b>=c.length?(ya.a.J(512496320,820,10,"ListEditor::DictionaryPropertySet - Level is out of bounds {0}",b),Sa.a.instance.Tb("PossibleLossOfListStyle",{["Reason"]:"ListLevelOutOfBounds"}),null):a.Ch.re(c[b])}zfd(){}vIe(a,b){if(this.eL.Tg(a)&&0<=b&&b<$o.a.C6){const c=a.currentNode,f=a.zb(2);c&&c.setValue(Bb.a.listLevel,b);f&&(f.setValue(Bb.a.listLevel,b),a.uc())}}u3k(a,b){if(this.eL.Tg(a)&&b&&b.propertySet){var c=a.zb(4);c&&(b.btb&&b.X7&&
(this.b_c?(this.qEc(b.propertySet,c),this.ota&&b.propertySet.Sa(ub.a.autonumberBulletType)&&c.setValue(ub.a.autonumberBulletType,b.propertySet.getValue(ub.a.autonumberBulletType))):c.setValue(bb.a.Ni,b.X7)),a.uc())}}Flh(a){if(this.eL.Tg(a)){if(this.Cke&&this.gt&&this.gt.propertySet){const b=this.gt.propertySet.sa(Bb.a.listLevel,-1);-1!==b&&this.vIe(a,b);this.u3k(a,this.gt)}this.c9b&&this.V2k(a);this.ota&&(this.gt&&this.gt.propertySet?this.wGj(this.gt)||(ya.a.J(512496285,820,50,"Copied from external, such as website."),
this.wIe(a)):(ya.a.J(512496286,820,50,"Copied from external, such as win32 ppt."),this.wIe(a)));this.bJg&&this.slh(a);this.gt=null}else ya.a.J(512496288,820,10,"ListEditorCssVersion::SetProperPendingListInfoAfterPaste - input GraphIterator is not outline element ")}slh(a){const b=this.KG.Bba(a),c=this.vP(a,b),f=a.zb(2);c&&f&&0<=b&&b<$o.a.C6&&(this.gt&&this.gt.propertySet&&this.gt.propertySet.Sa(ub.a.Nw)||(ya.a.J(512496284,820,50,"Get master defined line-spacing "),f.setValue(ub.a.Nw,c.sa(ub.a.oDi,
Sg.a.lineSpacing)),f.setValue(ub.a.ZV,c.sa(ub.a.pDi,2))),this.gt&&this.gt.propertySet&&this.gt.propertySet.Sa(ub.a.lca)||(ya.a.J(512496283,820,50,"Get master defined line-spacing before"),f.setValue(ub.a.lca,c.sa(ub.a.DDi,Sg.a.Izg)),f.setValue(ub.a.mja,c.sa(ub.a.EDi,4))),this.gt&&this.gt.propertySet&&this.gt.propertySet.Sa(ub.a.kca)||(ya.a.J(512496282,820,50,"Get master defined line-spacing after"),f.setValue(ub.a.kca,c.sa(ub.a.BDi,Sg.a.Hzg)),f.setValue(ub.a.lja,c.sa(ub.a.CDi,4))));a.uc()}wGj(a){if(a.propertySet.Sa(bb.a.Ni)){const b=
a.propertySet.getValue(bb.a.Ni).length;if(1===b&&a.propertySet.Sa(bb.a.font)||3===b&&a.propertySet.Sa(ub.a.autonumberBulletType))return!0}return!1}V2k(a){var b=this.KG.Bba(a);const c=this.vP(a,b),f=a.zb(2);c&&f&&0<=b&&b<$o.a.C6&&(this.gt&&this.gt.propertySet&&this.gt.propertySet.Sa(Bb.a.Il)||(ya.a.J(512496281,820,50,"Get master defined indent-left."),c.Sa(ub.a.fXb)&&f.setValue(Bb.a.Il,c.getValue(ub.a.fXb)),(b=this.Ea.kn(f))&&b.nd&&f.setValue(Bb.a.Il,c.sa(Bb.a.Il,Sg.a.leftMargin))),this.gt&&this.gt.propertySet&&
this.gt.propertySet.Sa(Bb.a.Mn)||(ya.a.J(512496280,820,50,"Get master defined firstline indent."),c.Sa(ub.a.yQd)&&f.setValue(Bb.a.Mn,c.getValue(ub.a.yQd)),(b=this.Ea.kn(f))&&b.nd&&f.setValue(Bb.a.Mn,c.sa(Bb.a.Mn,Sg.a.leftMargin))));a.uc()}wIe(a){const b=this.KG.Bba(a),c=this.vP(a,b),f=a.zb(4);c&&f&&0<=b&&b<$o.a.C6&&(ya.a.J(512496279,820,50,"Get master defined list marker"),c.Sa(bb.a.Ni)?(f.setValue(bb.a.Ni,c.getValue(bb.a.Ni)),c.Sa(bb.a.font)?f.setValue(bb.a.font,c.getValue(bb.a.font)):c.Sa(ub.a.autonumberBulletType)&&
f.setValue(ub.a.autonumberBulletType,c.getValue(ub.a.autonumberBulletType))):(f.setValue(bb.a.font,Ak.VIf),f.setValue(bb.a.Ni,[Ak.ZJd])));a.uc()}wSc(a){return a?16!==this.KG.LZd(a).Fce:!1}Rob(){ya.a.J(512496278,820,10,"ListEditor::ClearListFromParagraph - Ppt doesn't implement ClearFormatting command");Sa.a.instance.Tb("FormattingNotCleared",{["Reason"]:Bd.a.aqg})}dNk(a){if(this.eL.Tg(a)){var b=a.zb(4);b&&(1===this.z9b.isb(b)&&b.removeProperty(ub.a.autonumberBulletType),a.uc())}}R3k(a){this.eL.Tg(a)&&
(a=a.currentNode)&&a.setValue(ub.a.JJj,!0)}merge(a,b,c,f){const l=this.KG.Bba(b),x=this.vP(a,this.KG.Bba(a)),F=this.vP(b,l);x&&a&&(a.zb(2),a.currentNode&&(a.currentNode.Sa(Bb.a.Il)&&x.Sa(Bb.a.Il)&&!MA.APropertySet.FWa(Bb.a.Il.type,a.currentNode.Sh(Bb.a.Il),x.Sh(Bb.a.Il))&&x.ke(Bb.a.Il,a.currentNode.Sh(Bb.a.Il)),a.currentNode.Sa(Bb.a.Mn)&&x.Sa(Bb.a.Mn)&&!MA.APropertySet.FWa(Bb.a.Mn.type,a.currentNode.Sh(Bb.a.Mn),x.Sh(Bb.a.Mn))&&x.ke(Bb.a.Mn,a.currentNode.Sh(Bb.a.Mn))),a.uc());super.merge(a,b,c);c&&
this.Cke&&(this.vIe(a,l),this.R3k(a),this.dNk(a));this.H6h(b,F,x);if(f&&(a.zb(2),c=a.currentNode.sa(ub.a.oHa,""),a.uc(),c.length))for(a=this.Mb.$Yd(b);a.uf(1)&&a.currentNode!==f.currentNode;)a.zb(2),a.currentNode.setValue(ub.a.oHa,c),a.uc();return!0}v6h(a,b,c){const f=Mc.a.Cb;f&&(f.Ij=!0);this.KHd(a,b,c)}Mnl(a,b){var c=mb.GraphIterator.mb(b);this.Rf.gla(c);b=c.currentNode;c.uc();c=this.createList(a);a.uc();c.c4a(b,ub.a.shapeId,ub.a.ova)}V2a(a,b){this.KHd(a,b)}CDf(a,b,c){this.eL.Tg(a)||Sa.a.instance.Tb("PossibleIndentNotAdjusted",
{["Reason"]:Bd.a.eba});const f=a.zb(2),l=f.sa(Bb.a.Mn,Sg.a.indent),x=f.sa(Bb.a.Il,Sg.a.leftMargin);this.Aab.Je(a);if(16===b)this.yUa.Tu.wfb(f,0),0>l&&(Sa.a.instance.Tb("UnexpectedlyChangingLeftIdent",{["Reason"]:"NegativeLeftIndent"}),this.xi.xfb(a,1,Math.max(x+l,0)));else{var F=this.vP(a,this.KG.Bba(a));F||(F=new E.DictionaryPropertySet,ya.a.J(512496273,820,50,"listStyle is null"));var R=Sg.a.indent;let fa=Sg.a.leftMargin;c?{xbe:fa,h5d:R}=this.t$f(f,F,fa,R):(R=F.sa(Bb.a.Mn,Sg.a.indent),fa=F.sa(Bb.a.Il,
Sg.a.leftMargin));F=uj.a.uAa(F,null).listType;const wa=fa+(0<=R?0:R);R&&x+(0<=l?0:l)===wa&&F===b?(this.yUa.Tu.wfb(f,R),this.xi.xfb(a,1,fa)):(R=l,F=x,{indent:R,margin:F}=this.CKd(this.i6a(f),b,l,x,R,F),0<this.KG.Bba(a)&&c&&(F+=fa),F=Math.max(Math.min(F,Rn.pre),Rn.qre),R=Math.max(Math.min(R,Rn.i5d),Rn.j5d),this.yUa.Tu.wfb(f,R),this.xi.xfb(a,1,F))}}i6a(a){if(!a)return 0;a=this.Gl.Kia(a)?this.Gl.efj(this.Gl.ssb(a)):Ya.ParagraphReader.Nha(a,bb.a.fontSize,0);return Uj.WHf(a)}CKd(a,b,c,f,l,x){let F=(b=1===
b)?.3125:.375;0<a&&(F=12>=a?b?.1875:.25:12<a&&18>=a?b?.3125:.375:18<a&&25>=a?b?.375:.5:25<a&&35>=a?b?.5:.5625:35<a&&44>=a?b?.625:.8125:44<a&&56>=a?b?.75:1:56<a&&72>=a?b?.9375:1.25:b?1.25:1.5);a=-1*je.a.Mra(F);0>=c&&a<c?(x=a-c,l=c+x,x=f-x):0<c&&(l=a,x=f-a);return{indent:l,margin:x}}H6h(a,b,c){if(b&&c){Yb.OutlineElementNavigator.oi(a);var f=a.hq;if(Ya.ParagraphReader.Lk(a)){b=b.sa(bb.a.fontSize,Dr.fontSize);c=c.sa(bb.a.fontSize,Dr.fontSize);for(let l=0;l<f.Ra.length;++l){const x=f.Ra.ga(l);x&&x.formatting&&
x.formatting.sz&&x.formatting.sz.Sa(bb.a.fontSize)&&x.formatting.sz.getValue(bb.a.fontSize)===b&&this.kj.yr(x.formatting,c)}}Yb.OutlineElementNavigator.Je(a)}}DZd(a){if(this.ota){if(a=this.Rf.Fw(a))a.mrb=!0;return a}return super.DZd(a)}KHd(a,b,c=null){if(this.eL.Tg(a)){this.N6h(b,c,a);var f=a.zb(4);if(!f||b&&16!==b.listType)if(b&&0!==b.listStyle){f?uj.a.uAa(f,f).bVb():f=this.createList(a);a.uc();const l=a.zb(2);a.uc();this.VIg&&l.sa(be.a.j4b,!1)||this.ota&&b.mrb?f.c4a(b.propertySet,ub.a.shapeId,ub.a.ova,
Bb.a.listLevel,bb.a.Ni,be.a.tD):f.c4a(b.propertySet,ub.a.shapeId,ub.a.ova,Bb.a.listLevel,ub.a.fDa);c&&c.Sa(ub.a.autonumberBulletType)&&f.setValue(ub.a.autonumberBulletType,c.getValue(ub.a.autonumberBulletType));this.ota&&b.mrb&&b.btb&&(3===b.X7.length&&b.propertySet.Sa(ub.a.autonumberBulletType)?(f.setValue(bb.a.Ni,b.X7),c=b.propertySet.getValue(ub.a.autonumberBulletType),f.setValue(ub.a.autonumberBulletType,c),ya.a.J(512496267,826,50,"Support CCP customized number list")):1===b.X7.length&&b.l7a?
(f.setValue(bb.a.Ni,b.X7),f.setValue(bb.a.font,b.font),ya.a.J(512496266,826,50,"Support CCP customized bullet")):(ya.a.J(512496265,826,50,"Set list use dst master liststyle."),this.wIe(a)))}else return;else a.Ii();b&&b.d5f||(this.VIg?(f=this.Rf.Fw(a),this.CDf(a,f?f.listType:16,b?b.mrb:!1)):this.CDf(a,b?b.listType:16,b?b.mrb:!1))}else ya.a.J(512496269,820,10,"ListEditor::ApplyListInfoInternal - iterator is not outline element "),Sa.a.instance.Tb("FailedToApplyListProperties",{["Reason"]:Bd.a.eba})}N6h(a,
b,c){b&&a&&(1===a.listType||0===a.listType)&&(this.WK.vx(b,a.propertySet,this.EWc),c=this.vP(c,this.KG.Bba(c))||new E.DictionaryPropertySet,1===a.listType&&(a.propertySet.setValue(be.a.nca,6),b.Sa(bb.a.Ni)||(a.propertySet.setValue(bb.a.font,Ak.VIf),a.propertySet.setValue(bb.a.Ni,[Ak.ZJd]),c.Sa(bb.a.Ni)&&(b=c.getValue(bb.a.Ni)[0],b!==Ak.cQd&&b!==Ak.uGa&&this.WK.vx(c,a.propertySet,this.EWc)))))}vP(a,b){this.eL.Tg(a)||Sa.a.instance.Tb("PossibleLossOfListStyle",{["Reason"]:Bd.a.eba});a=this.cfj(a);return a?
this.l6i(a,1+b):(ya.a.J(512496263,820,10,"ListEditor::DictionaryPropertySet - Outline is null"),Sa.a.instance.Tb("PossibleLossOfListStyle",{["Reason"]:Bd.a.IPf}),null)}cfj(a){a=mb.GraphIterator.iG(a);a.l5(Ui.OutlineReader.g4b);const b=a.rw(16);return b?b:a.AZa()}isb(a){return this.KG.LZd(a).Fce}Rlh(a,b,c){c||0!==b.listType||(b.Yz=a.sa(bb.a.HSa,Pk.a.kw))}qEc(a,b){this.WK.Hui(a,b,this.c0c)}}Object(e.a)(YK,"ListEditor",Wp,[341,342]);class Ps{constructor(a,b){this.eUb=a;this.$nb=b}}Object(e.a)(Ps,"BulletMarker",
null,[]);class Qs{constructor(a,b){this.YIf=a;this.CVg=b}}Object(e.a)(Qs,"ListMarkerPreview",null,[]);class Rs{constructor(a,b,c){this.sVg=a;this.yVg=b;this.eJd=c}}Object(e.a)(Rs,"NumberingMarker",null,[]);class ZK{constructor(a,b){this.Mb=a;this.AAb=b;this.l4j=new le.a(Object(D.a)(this,this.Wxi,"createListBulletDictionary"));this.q4j=new le.a(Object(D.a)(this,this.byi,"createListNumberingDictionary"));this.p4j=new le.a(Object(D.a)(this,this.$xi,"createListMarkerPreviewDictionary"));this.n4j=new le.a(Object(D.a)(this,
this.Zxi,"createListMarkerAltTextDictionary"))}Wxi(){const a=new Me.a;a.$(3,new Ps(8226,"Arial"));a.$(4,new Ps(111,"Courier New"));a.$(5,new Ps(167,"Wingdings"));a.$(6,new Ps(113,"Wingdings"));a.$(7,new Ps(118,"Wingdings"));a.$(8,new Ps(216,"Wingdings"));a.$(9,new Ps(252,"Wingdings"));return a}byi(){const a=new Me.a;a.$(11,new Rs(0,".",8));a.$(12,new Rs(0,")",7));a.$(13,new Rs(1,".",15));a.$(14,new Rs(3,".",5));a.$(15,new Rs(4,")",2));a.$(16,new Rs(4,".",4));a.$(17,new Rs(2,".",14));return a}$xi(){const a=
new Me.a;a.$(1,new Qs("\u2022",["1.","2.","3."]));a.$(2,new Qs("o",["1)","2)","3)"]));a.$(3,new Qs("\uf0a7",["I.","II.","III."]));a.$(4,new Qs("\uf071",["A.","B.","C."]));a.$(5,new Qs("\uf076",["a)","b)","c)"]));a.$(6,new Qs("\uf0d8",["a.","b.","c."]));a.$(7,new Qs("\uf0fc",["i.","ii.","iii."]));return a}Zxi(){const a=new Me.a;a.$(3,ResourceStrings.l_ListMarkerAltText_Bullet_1);a.$(4,ResourceStrings.l_ListMarkerAltText_Bullet_2);a.$(5,ResourceStrings.l_ListMarkerAltText_Bullet_3);a.$(6,ResourceStrings.l_ListMarkerAltText_Bullet_4);
a.$(7,ResourceStrings.l_ListMarkerAltText_Bullet_5);a.$(8,ResourceStrings.l_ListMarkerAltText_Bullet_6);a.$(9,ResourceStrings.l_ListMarkerAltText_Bullet_7);a.$(11,ResourceStrings.l_ListMarkerAltText_Numbered_1);a.$(12,ResourceStrings.l_ListMarkerAltText_Numbered_2);a.$(13,ResourceStrings.l_ListMarkerAltText_Numbered_3);a.$(14,ResourceStrings.l_ListMarkerAltText_Numbered_4);a.$(15,ResourceStrings.l_ListMarkerAltText_Numbered_5);a.$(16,ResourceStrings.l_ListMarkerAltText_Numbered_6);a.$(17,ResourceStrings.l_ListMarkerAltText_Numbered_7);
return a}get DSa(){return this.l4j.value}get h6c(){return this.q4j.value}get mVc(){return this.p4j.value}get Qzg(){return this.n4j.value}$Ff(a,b){const c=this.Mb.Kc(a);c.set(a);for(a=c.zb(1);a;){var f=c.zb(4);if(f){if(1===b){if(1!==f.sa(be.a.tD,16))return!1}else if(2===b){if(0!==f.sa(be.a.tD,16))return!1}else if(a=f.sa(bb.a.Ni,null),this.AAb.aRc(b)){f=f.sa(bb.a.font,"");const l=this.DSa.ga(b);if(!a||1!==a.length||l.eUb!==a[0]||l.$nb!==f)return!1}else if(this.AAb.bRc(b)){if(f=this.h6c.ga(b),!a||3!==
a.length||f.sVg!==a[1]||f.yVg!==Ma.a.fromCharCode(a[2]))return!1}else return!1;c.uc()}else if(0!==b)return!1;a=c.uf(1)}return!0}aRc(a){return this.AAb.aRc(a)}bRc(a){return this.AAb.bRc(a)}I0b(a){return this.AAb.I0b(a)}BNc(a){return this.AAb.BNc(a)}}Object(e.a)(ZK,"PptListMarkersLoader",null,[345,344]);class $K{Exl(a,b){if(!a)return!1;b.zb(2);a=b.currentNode.sa(be.a.j4b,!1);b.uc();return!a}}Object(e.a)($K,"PptMergeListEditorInOutlineElementStrategy",null,[346]);class Jz{constructor(){this.dfi=[0,3,
4,5,6,7,8,9];this.lgk=[0,11,12,13,14,15,16,17]}aRc(a){return 3<=a&&9>=a}bRc(a){return 11<=a&&17>=a}I0b(a){return Jz.Beg(a,this.dfi,1)}BNc(a){return Jz.Beg(a,this.lgk,2)}static Beg(a,b,c){return 0<=a&&a<b.length?b[a]:c}}Object(e.a)(Jz,"TextBulletTypeHelper",null,[344]);class HD{get name(){return"PowerPointWebEditor.ListEditor"}Wb(a){a.register(341,"PowerPointWebEditor.IPptListEditor").ma().na(()=>new YK(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementNavigator"),
a.resolve("PowerPointWebEditor.IListInfoHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("PowerPointWebEditor.ListReader"),a.resolve("PowerPointWebEditor.IPptListCore"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IGraphUtils"),a.resolve("Box4.Graph.IGraphIteratorFactory"),
a.resolve("PowerPointWebEditor.IShapeReader")));a.register(342,"Box4.List.IListEditor").ma().na(()=>a.resolve("PowerPointWebEditor.IPptListEditor"));a.register(343,"PowerPointWebEditor.IPptListCore").ma().na(()=>new XK(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.ListReader")));a.register(344,"PowerPointWebEditor.ITextBulletTypeHelper").ma().na(()=>new Jz);a.register(345,"PowerPointWebEditor.IPptListMarkersLoader").ma().na(()=>
new ZK(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.ITextBulletTypeHelper")));a.register(346,"Box4.IMergeListEditorInOutlineElementStrategy").ma().na(()=>new $K)}init(){}dispose(){}static main(){m.a.instance.Ac(new HD)}}Object(e.a)(HD,"PPTWebEditorListEditorPackage",null,[2,3]);var uQ=d(863);class aL{$j(a){return xd.TableReader.$j(a)}ui(a){return xd.TableReader.ui(a)}VMc(a,b,c){return xd.TableReader.VMc(a,b,c)}ju(a){return xd.TableReader.ju(a)}O8a(a){return xd.TableReader.O8a(a)}Sr(a){return xd.TableReader.Sr(a)}UM(a){return xd.TableReader.UM(a)}}
Object(e.a)(aL,"TableReaderProxy",null,[723]);class bL{iug(){return ik.j(void 0)}Kaj(a){return ik.c(a)}}Object(e.a)(bL,"TableRowReaderProxy",null,[722]);class cL extends Cl.a{constructor(a,b,c,f,l){super(a,b);this.TOh=l;this.RJ=f;a=l&&this.$a.sa(Bb.a.skippedCell,!1);b=this.Fd.Oo(ka.a.td);this.jc(b);a?this.htmlElement.className="SkippedGhostCell":(this.htmlElement.className=this.RJ.Vq?"GhostWithBorder":"Ghost",this.htmlElement.title=Box4Intl.Box4Strings.l_GhostCellTooltip);this.htmlElement.innerText=
"\u00a0";this.LWf()}DT(){return lf.a.wcc}cA(){this.TOh&&this.$a.sa(Bb.a.skippedCell,!1)&&this.k5k()}k5k(){this.RJ.Vq&&(this.htmlElement.style.borderTop="",this.htmlElement.style.borderLeft="",this.htmlElement.style.borderBottom="",this.htmlElement.style.borderRight="")}}Object(e.a)(cL,"GhostTableCellViewElement",Cl.a,[708,443,395,106]);class dL{constructor(a,b,c){this.QCd=a;this.RJ=b;this.ojb=c}create(a,b){return De.isGhostCellNode(b.node)?De.shouldRenderGhostCellNode(b.node)?new cL(a,b,this.QCd,
this.RJ,H.a.instance.ga(63),H.a.instance.ga(77)):null:this.ojb.create(a,b)}}Object(e.a)(dL,"GhostTableCellViewElementFactory",null,[617]);class eL{constructor(a,b,c){this.sc=a;this.$ca=b;this.GMg=c;this.gF=null;this.Exb=this.Fxb=-1}L5k(a,b=null){this.N5k(a);this.gF&&this.k2k(b)}cni(){this.gF=null;this.Exb=this.Fxb=-1}y7f(a,b,c){if(!a||!this.gF)return{row:b,column:c};var f=this.$ca.P2f(a,this.gF,this.GMg.VBc,this.GMg.UBc);if(!f)return{row:b,column:c};let l=f.rowIndex;f=f.li;l===b||this.$ca.kRc(a,this.gF)||
(l=b);var x=0,F=this.sc.ui(this.gF)-1;let R=0,fa=this.sc.$j(this.gF)-1;this.$ca.kRc(a,this.gF)&&b>=R&&b<=fa&&c>=x&&c<=F&&(a=(x=(x=this.gF.ef(b,c))?x.oy():null)?x.rowSpan:0,F=x?x.colSpan:0,x=c,F=c+F-1,R=b,fa=b+a-1);l>=R&&l<=fa&&f>=x&&f<=F&&(b=l,c=f);return{row:b,column:c}}mek(a){a=this.neg(a);return!!a&&14===a.type&&a.lp()}T6h(a,b,c,f,l,x){if(!this.gF||!a||14!==a.type||this.gF!==a||!b)return{m5f:c,b5f:f,uwh:l,rwh:x};this.gF.ef(c,f).isControllingCell&&({rowIndex:c,hha:f}=this.D3i(c,f));if(this.gF.ef(l,
x).isControllingCell||!this.$ca.kRc(b,this.gF))({row:l,column:x}=this.y7f(b,l,x));ya.a.J(41209862,816,50,"Drag to select table cells in complex table.");return{m5f:c,b5f:f,uwh:l,rwh:x}}N5k(a){(a=this.neg(a))&&14===a.type&&(this.gF=a)}neg(a){return 1074135132===a.Oe&&a.nd?this.sc.XM(a):this.sc.E0b(a)}k2k(a){this.gF&&a&&({row:this.Fxb,column:this.Exb}=this.y7f(a,this.Fxb,this.Exb))}D3i(a,b){if(!this.gF)return{rowIndex:a,hha:b};let c=null;0<=a&&a<this.sc.$j(this.gF)&&0<=b&&b<this.sc.ui(this.gF)&&(c=
this.gF.ef(a,b));this.uGj(c)&&(a=this.Fxb,b=this.Exb);return{rowIndex:a,hha:b}}uGj(a){if(!this.gF)return!1;let b=0;var c=this.sc.ui(this.gF)-1;let f=0;var l=this.sc.$j(this.gF)-1;if(a){l=a.rowIndex;c=a.li;const x=a.rowSpan;a=a.colSpan;b=c;c=c+a-1;f=l;l=l+x-1}return this.Fxb>=f&&this.Fxb<=l&&this.Exb>=b&&this.Exb<=c}}Object(e.a)(eL,"PptTableDragSelectionCellExtendStrategy",null,[323]);var fL=d(812),pn=d(233);class gL{constructor(){this.cPc=this.colSpan=this.Sdd=0}}Object(e.a)(gL,"HeightInfo",null,
[]);class hL{constructor(){this.ANa=null;this.rowSpan=this.height=this.width=this.top=this.offsetTop=this.left=0;this.Fig=this.ijg=this.Ntg=this.Ptg=this.Otg=!1}}Object(e.a)(hL,"TableCellInfo",null,[]);class iL{constructor(){this.sIh=[]}get cells(){return this.sIh}lFd(a){this.cells.push(a)}}Object(e.a)(iL,"TableRowInfo",null,[]);class jL{constructor(){this.ANa=null;this.height=this.width=this.left=this.top=this.offsetTop=0;this.btg=this.hug=this.gtg=!1}}Object(e.a)(jL,"UpdateInfo",null,[]);var vQ=
d(1028),kL=d(547);class uv extends kL.a{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){super(a,b,lb);this.cLa=!1;this.m0a=this.zsf=this.IAd=this.l0a=this.$Da=null;this.gxd=0;this.Eji=1;this.Cji=16;this.tji=256;this.wji=4096;this.Dji=65536;this.usc=this.Psc=this.Zsc=this.itc=!1;this.GWe=this.ixf=this.jwc=this.Ctc=this.ofa=0;this.sfe=this.tfe=null;this.bWh=Object(va.a)(126,b);this.Y$=c;this.naa=kc;this.Xc=Xa;this.OU=Lb;this.RJ=wa;this.txc=R;this.ega=fa;this.dga=F;this.Zq=x;this.LZc=!!u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.ka("PPTOTableCellDiagonalBordersEnabled");a=this.Fd.Oo(ka.a.td);this.jc(a);this.gY=this.Fd.Oo(ka.a.div);a.appendChild(this.gY);this.gY.className="TableCellContent";this.Ho(this.gY)}e_b(){return this.gY.offsetHeight+this.gY.offsetTop}lnc(a,b,c,f){a=this.cLa?a:a+c;this.$Da||(this.$Da=this.GEc());this.$Da.style.left=a-2.5+"px";this.$Da.style.top=b+"px";this.$Da.style.height=f+"px"}KSf(){const a=this.Fd.Oo(ka.a.div);Sc.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);
return a}GEc(){const a=this.KSf();a.className="TableColumnResizeHandle";return a}iPd(){const a=this.Fd.Oo(ka.a.div);Sc.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);a.className=Jf.a.KMk;return a}qtl(a,b,c,f){f?(a=this.cLa?a:a+b,this.l0a||(this.l0a=this.Zvi()),b=this.l0a.style,b.top=c+"px",b.left=a+"px"):this.l0a&&(this.aNf(this.l0a,!1),this.l0a=null);return this.l0a}Zvi(){const a=this.iPd(),b=this.Fd.Oo(ka.a.div);Sc.c(b,!0);b.className=Jf.a.W5d;a.appendChild(b);return a}Xvl(a,
b,c,f){this.ZLi();const l=this.IAd.style;l.top=c+"px";l.left=f+"px";c=this.zsf.style;c.marginTop=b-2.5+"px";c.width=a+"px"}ZLi(){if(!this.IAd){const a=this.iPd(),b=this.Fd.Oo(ka.a.div);Sc.c(b,!0);b.className=Jf.a.umg;a.appendChild(b);this.IAd=a;this.zsf=b}}awl(a,b,c){c?(this.m0a||(this.m0a=this.Tzi()),c=this.m0a.style,c.top=a+b-10+"px",this.cLa?c.right="-15px":c.left="-15px"):this.m0a&&(this.aNf(this.m0a,!0),this.m0a=null);return this.m0a}Tzi(){const a=this.iPd(),b=this.Fd.Oo(ka.a.div);Sc.c(b,!0);
b.className=Jf.a.X5d;a.appendChild(b);return a}Mbh(a){(a=this.htmlElement.querySelector("."+a))&&this.htmlElement.removeChild(a.parentNode)}aNf(a,b){b?pn.a.omi(a):pn.a.jmi(a);this.htmlElement.removeChild(a)}Utg(a){a=a?C.a.HCa:u.AFrameworkApplication.isRtl?C.a.K7a:C.a.lRa;return 8!==u.AFrameworkApplication.Ta.ii(Pc.a.create(this.$a),a,1,!0,new vQ.a,null)}DT(a){super.DT(a);const b=super.DT(a);this.gxd=this.Fej(a);if(this.naa.Lw&&!this.Oc.Bl){var c=jg.a.mb(a.E0,a.currentNode);c.Ze();this.dga.Je(c);a=
this.txc.getContainingTable(a);this.ega.Tg(c)&&a&&!this.Zq.jAa(a)&&(c=c.Gq)&&c.htmlElement&&this.Y$.kRf(c.htmlElement,a,this.Ma)}return new lf.a(b.bla+this.Ctc+On.a.Qgb,Math.max(b.minWidth,this.gxd),b.dla+this.jwc+On.a.Qgb)}Fej(a){return xd.TableReader.Cub(a)?(a=this.naa.K9d?this.$a.sa(kh.a.mLd,1):1,a*On.a.zOe+(a-1)*(this.Ctc+this.jwc+On.a.Qgb)):On.a.zOe}q5(a){this.gY.style.paddingLeft=a.bla-On.a.Qgb+"px";this.gY.style.paddingRight=a.dla-On.a.Qgb+"px";this.naa.KSc&&this.naa.K9d&&(this.gY.style.minWidth=
this.gxd+"px")}Xea(a){this.fD(this.gY,a,1)}cA(){this.CAh();this.gkh();var a=mb.GraphIterator.mb(this.$a);a.mc(14);const b=Dd.getContainingTable(a),c=De.isFirstCellInColumn(a);a=De.isFirstCellInRow(a);let f="";c&&uv.rxg(b,32)&&(f="columnheader");a&&!c&&uv.rxg(b,128)&&(f="rowheader");""!==f?Ca.d(this.htmlElement,za.a.role,f):this.htmlElement.removeAttribute(Uc.a.We);this.Xc&&this.Xc.UCa(65)&&(this.$a.RVb?Sys.UI.DomElement.addCssClass(this.htmlElement,Pb.F2):Sys.UI.DomElement.removeCssClass(this.htmlElement,
Pb.F2));this.RJ.Vq&&(this.htmlElement.style.border="",this.iTk(),this.Q0k(b),this.htmlElement.style.verticalAlign=this.RJ.Vq.cZi(this.$a));this.F4k();this.naa.KSc&&this.naa.K9d&&(this.$a.Sa(kh.a.TLf)?this.Wlh():this.htmlElement.removeAttribute("rowspan"),this.$a.Sa(kh.a.mLd)?this.lkh():this.htmlElement.removeAttribute("colspan"));this.Oc.Bl&&this.naa.hOj&&(this.htmlElement.style.width=this.Fd.Cd.Ge(this.bWh.width,0)+"px")}F4k(){if(this.naa.PKj||this.naa.qQj)this.$a.F3d?this.Wlh():this.htmlElement.removeAttribute("rowspan"),
this.$a.h7a?this.lkh():this.htmlElement.removeAttribute("colspan")}CAh(){let a=null;if(this.Xc&&this.Xc.UCa(65)){var b=mb.GraphIterator.mb(this.$a);b.mc(15);b=b.rw(15);if(b.Fmc){Sys.UI.DomElement.addCssClass(this.htmlElement,Pb.Xuh);return}if(b.kkd){Sys.UI.DomElement.addCssClass(this.htmlElement,Pb.$uh);return}}this.$a.Sa(bb.a.sCc)?(a=Eb.a.LH(this.$a.sa(bb.a.sCc,Eb.a.nil)),this.ofa|=this.Dji):this.naa.KNj&&this.RJ.Vq&&(a=this.RJ.Vq.l7f(this.$a));a=a||"transparent";this.htmlElement.style.backgroundColor=
a;"transparent"!==a&&4.5>Eb.a.UZi(a)?this.htmlElement.className="LowContrastShading":this.htmlElement.className=this.htmlElement.className.replace("LowContrastShading","");this.Xc&&this.Xc.UCa(65)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,Pb.Xuh),Sys.UI.DomElement.removeCssClass(this.htmlElement,Pb.$uh))}Wlh(){Ca.d(this.htmlElement,za.a.rowSpan,this.naa.KSc?this.$a.sa(kh.a.TLf,1):this.$a.rowSpan)}lkh(){Ca.d(this.htmlElement,za.a.colSpan,this.naa.KSc?this.$a.sa(kh.a.mLd,1):this.$a.colSpan)}iTk(){this.usc=
this.Zsc=this.Psc=this.itc=!1}Q0k(a){this.RJ.Vq&&(this.L2k(),this.htmlElement.style.border="0px none",this.QFb(this.$a,a,7),this.QFb(this.$a,a,5),this.QFb(this.$a,a,0),this.QFb(this.$a,a,6),this.LZc&&(this.QFb(this.$a,a,2),this.QFb(this.$a,a,1)),Ca.d(this.htmlElement,za.a.kQd,this.ofa),this.mRk())}gkh(){var a=new mb.GraphIterator;a.set(this.$a);a.mc(14);a.Ng(14);a=a.currentNode;this.Ctc=On.a.wNc(this.$a,a,Bb.a.YHb,this.RJ.Vq,Bb.a.ckl,0);this.jwc=On.a.wNc(this.$a,a,Bb.a.$Hb,this.RJ.Vq,Bb.a.dkl,0);
this.ixf=On.a.wNc(this.$a,a,Bb.a.aIb,this.RJ.Vq,Bb.a.ekl,1);this.GWe=On.a.wNc(this.$a,a,Bb.a.XHb,this.RJ.Vq,Bb.a.Zjl,1);this.gY.style.paddingLeft=this.Ctc+"px";this.gY.style.paddingRight=this.jwc+"px";this.gY.style.paddingTop=this.ixf+"px";this.gY.style.paddingBottom=this.GWe+"px"}L2k(){var a=mb.GraphIterator.mb(this.$a);a.mc(14);a=this.txc.getContainingTable(a);this.cLa=xd.TableReader.Yl(a)}QFb(a,b,c){this.OU&&this.OU.fDj(b);a=this.RJ.Vq.e2i(a,c);b=a.pci;const f=a.Xij;if(""!==b)switch(""!==f&&Sys.UI.DomElement.addCssClass(this.htmlElement,
f),c){case 7:this.htmlElement.style.borderTop=b;this.kSc(b)&&(this.itc=!0);a.uGc&&(this.ofa|=this.Eji);break;case 5:this.bkh(5,b);this.kSc(b)&&(this.Psc=!0);a.uGc&&(this.ofa|=this.wji);break;case 0:this.htmlElement.style.borderBottom=b;this.kSc(b)&&(this.usc=!0);a.uGc&&(this.ofa|=this.tji);break;case 6:this.bkh(6,b);this.kSc(b)&&(this.Zsc=!0);a.uGc&&(this.ofa|=this.Cji);break;case 2:this.tfe=b;break;case 1:this.sfe=b}}kSc(a){return!a||a.startsWith("0px none")?!1:!0}bkh(a,b){if(5===a&&!this.cLa||6===
a&&this.cLa)this.htmlElement.style.borderLeft=b;if(5===a&&this.cLa||6===a&&!this.cLa)this.htmlElement.style.borderRight=b}mRk(){if(this.x$k()){var a=mb.GraphIterator.mb(this.$a);if(a.mc(14)){var b=De.isFirstCellInRow(a),c=De.isLastCellInRow(a);this.itc||(this.htmlElement.style.borderTop="solid 1px #c8cacc",this.itc=!0);this.usc||(this.htmlElement.style.borderBottom="solid 1px #c8cacc",this.usc=!0);b=b?"solid 1px #c8cacc":"dashed 1px #c8cacc";c=c?"solid 1px #c8cacc":"dashed 1px #c8cacc";a=a.rw(14);
a=!xd.TableReader.Yl(a);this.Psc||(this.htmlElement.style.borderLeft=a?b:c,this.Psc=!0);this.Zsc||(this.htmlElement.style.borderRight=a?c:b,this.Zsc=!0)}}}x$k(){const a=this.Oc;return a.Hh&&a.features.F$k?!0:!1}get kha(){return this.gY}VL(a){super.VL(a);this.uT()}uT(){if(!this.Fd.Bl&&this.zA){const a=Object(va.a)(670,this.JQ);a&&a.NRg(this.gY)}}get Xob(){return this.$Da}static rxg(a,b){return null!==a&&a.Sa(Bb.a.tableLook)?!!(a.properties.getValue(Bb.a.tableLook)&b):!1}}Object(e.a)(uv,"TableCellViewElement",
kL.a,[693,443,395,106]);class gm extends Cl.a{constructor(a,b,c,f=null){super(a,b);this.cR=null;this.apc=!0;this.km=[];this.Au=[];this.fyc=this.PF=null;this.hYe=this.ysf=0;gm.GSa=c;this.OU=f;b=this.Fd.Oo(ka.a.div);b.className="TableContainer";this.Lj=this.Fd.Oo(ka.a.table);b.appendChild(this.Lj);this.Lj.className="Table";Sys.UI.DomElement.addCssClass(this.Lj,gm.Nid);this.Kyf=a;this.dza=this.Fd.Oo(ka.a.div);this.dza.id=Ga.a.create().toString();this.dza.className=gm.Ijl;this.dza.setAttribute(Uc.a.YJ,
Uc.a.vB);b.insertBefore(this.dza,this.Lj);Sc.c(this.dza,!0);a.Bl&&Ca.d(this.Lj,za.a.border,this.$a.sa(bb.a.Pgb,!0)?"1":"0");this.jc(b);a.Bl||(this.cR=this.Fd.Oo(ka.a.soi),this.Lj.appendChild(this.cR));this.BR=this.Fd.Oo(ka.a.ukl);this.Lj.appendChild(this.BR);this.Ho(this.Lj)}get m0(){return this.BR}get table(){return this.Lj}get CDc(){return this.cR}cA(a){this.Lj.style.borderCollapse="collapse";if(Tc.StyleReader.Vq)Sys.UI.DomElement.removeCssClass(this.Lj,gm.Nid),Sys.UI.DomElement.removeCssClass(this.Lj,
gm.COe);else{var b=this.$a.sa(bb.a.Pgb,!0);b&&!this.apc?(Sys.UI.DomElement.removeCssClass(this.Lj,gm.COe),Sys.UI.DomElement.addCssClass(this.Lj,gm.Nid),this.apc=!0):!b&&this.apc&&(Sys.UI.DomElement.removeCssClass(this.Lj,gm.Nid),Sys.UI.DomElement.addCssClass(this.Lj,gm.COe),this.apc=!1)}H.a.instance.ga(71)&&Tc.StyleReader.Vq&&(Ca.d(this.Lj,za.a.mQd,"Custom"),Ca.d(this.Lj,za.a.lQd,0));var c=this.cR?xd.TableReader.ui(this.$a):0;b=this.cR?c-this.cR.childNodes.length:0;for(var f=0;f<b;++f){var l=this.Fd.Oo(ka.a.col);
this.cR.appendChild(l)}for(f=0;f>b;--f)this.cR.removeChild(this.cR.firstChild);f=Nn.b(this.$a);var x=0;this.OU&&(x=this.OU.b0d(this.$a));l=Array(c);var F=!0;b=0;for(var R=0;R<c;++R){let fa=this.n7(R);0<=f[R]?(l[R]=Math.max(fa,this.Fd.Cd.Ge(f[R],0)-x),this.cR.childNodes[R].style.width=l[R]+"px",b+=l[R]):(l[R]=-1,F=!1,this.cR.childNodes[R].style.width="",b+=fa)}if(H.a.instance.ga(63)||H.a.instance.ga(77))F?Sys.UI.DomElement.addCssClass(this.Lj,gm.oEh):Sys.UI.DomElement.removeCssClass(this.Lj,gm.oEh);
if(this.km.length===c)for(x=this.IKc(),F=0;F<c;++F)R=this.n7(F),this.km[F].childNodes[x].style.width=0<=f[F]?Math.max(R,l[F])+"px":R+"px";c=xd.TableReader.Yl(this.$a);if(this.$a.Sa(bb.a.pl))switch(xd.TableReader.UM(this.$a)){case 1:this.Lj.style.marginLeft="";this.Lj.style.marginRight="auto";break;case 2:this.Lj.style.marginLeft="auto";this.Lj.style.marginRight="auto";break;case 3:this.Lj.style.marginLeft="auto";this.Lj.style.marginRight="";break;case 14:this.Lj.style.marginLeft=c?"auto":"";this.Lj.style.marginRight=
c?"":"auto";break;case 15:this.Lj.style.marginLeft=c?"":"auto";this.Lj.style.marginRight=c?"auto":"";break;default:this.Lj.style.marginLeft="",this.Lj.style.marginRight=""}else this.Lj.style.marginLeft="",this.Lj.style.marginRight="",H.a.instance.ga(63)&&this.$a.Sa(Bb.a.Il)&&(f=({Pf:a}=xd.TableReader.aia(a)).returnValue,a=(new Zu.a(a,f)).KJb+"px",c?this.Lj.style.marginRight=a:this.Lj.style.marginLeft=a);(H.a.instance.ga(71)||H.a.instance.ga(77))&&this.J5k(Tc.StyleReader.Vq,this.$a,this.Lj);this.$a.properties.sa(bb.a.Jrg,
!1)?(Sys.UI.DomElement.addCssClass(this.Lj,gm.BPf),Ca.d(this.Lj,za.a.s$h,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(this.Lj,gm.BPf),this.Lj.removeAttribute(Uc.a.zpa));(a=xd.TableReader.l1d(this.$a))&&this.Lj.setAttribute("title",a);(a=xd.TableReader.k1d(this.$a))?this.Kyf.Bl&&1===this.Kyf.mode?this.Lj.removeAttribute(Uc.a.zpa):(this.dza.innerText=a,this.Lj.setAttribute(Uc.a.zpa,this.dza.id)):(this.dza.innerText="",this.Lj.removeAttribute(Uc.a.zpa));Cb.a.instance.Hj&&!H.a.instance.ga(30)&&
(this.Lj.style.width="0px");H.a.instance.ga(30)&&(this.Lj.style.minWidth=b+"px");this.U0k();this.O5k()}U0k(){if(this.OU){const a=this.OU.tDl(this.$a);""!==a&&(this.Lj.style["border-spacing"]=a);this.F7d&&(this.Lj.style.borderCollapse="separate")}}get F7d(){return!!this.OU&&this.OU.fDj(this.$a)}xXd(a){return this.OU?this.OU.OCl(this.$a,a):0}O5k(){this.Lj.style.borderTop="";this.Lj.style.borderBottom="";this.Lj.style.borderLeft="";this.Lj.style.borderRight=""}n7(a){return(Tc.StyleReader.Vq?Tc.StyleReader.Vq.n7(this.$a,
a):On.a.Xid)+(this.OU?this.OU.b0d(this.$a):0)}J5k(a,b,c){a&&(c.style.background=a.Mej(b))}Xea(a){this.fD(this.htmlElement,a,88);1<this.htmlElement.children.length&&this.htmlElement.firstChild===this.Lj&&(this.Ghc(this.htmlElement,this.Lj),this.htmlElement.appendChild(this.Lj));this.fD(this.BR,a,1);let b=!1;this.BR.firstChild!==this.PF&&(this.PF=this.BR.firstChild,b=!0);H.a.instance.ga(30)&&xd.TableReader.ju(a.currentNode)||!this.cR||(u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")?
(a=!1,(this.km&&this.km.length?this.km[0].parentNode:null)!==(this.PF?this.PF.firstChild:null)&&(a=!0),this.Ldh(b||a)):this.dRk(b),pn.a.Xu||this.fEe(b))}IKc(){let a=1;(H.a.instance.ga(63)||H.a.instance.ga(30))&&xd.TableReader.ju(this.$a)&&(a=0);return a}dispose(){H.a.instance.ga(50)&&Gb.App.Eh&&Gb.App.Eh.Qv&&this.Ibh();this.Au=this.km=this.Lj=this.BR=this.cR=this.dza=this.PF=null;super.dispose()}DT(a){var b=Nn.b(this.$a),c=null;if(a.zb(1)){do{var f=a.Gq.wIa;c=c?iv.Poi(c,f):f.copy()}while(a.wj(1))
}c||(c=new iv(b.length));for(f=0;f<b.length;f++)-1<b[f]&&c.kkh(f,Math.max(c.a_i(f),this.Fd.Cd.Ge(b[f],0)));b=On.a.Qgb;c=new lf.a(b,Math.max(0,c.kck()-2*b),b);b=new mb.GraphIterator;b.set(this.$a);f=!1;b.mc(16)&&(f=!0);c=f?new lf.a(0,c.total,0):new lf.a(c.bla,c.minWidth,c.dla);a.zb(88)&&(c=lf.a.max(c,a.Gq.wIa),a.uc());return c}vAj(){this.Ibh();this.km=[];this.Au=[]}Ibh(){if(this.Au)for(var a=0;a<this.Au.length;++a)L.a.tHa(this.Au[a]),Ba.a.fO(this.Au[a]);if(this.km)for(a=0;a<this.km.length;++a)L.a.tHa(this.km[a]),
this.Au&&this.Au[a]&&this.Au[a].parentNode&&Ba.a.fO(this.km[a])}Ldh(a){if(this.km&&this.PF&&this.PF.firstChild){var b=n.a.Kw||n.a.$n?"":" 16 20",c=String.format("url('{0}'){1}, pointer",qy.a.box4Image("ColumnSelect.cur"),b);b=Nn.b(this.$a);var f=b.length,l=this.PF.firstChild;if(a){a=Math.min(f,this.km.length);for(var x=0;x<a;x++)l.insertBefore(this.km[x],l.firstChild)}if(f>this.km.length)for(a=this.km.length;a<f;a++){x=this.Fd.createElement("div");x.className="TableColumnHandleAnchor";Sc.c(x,!0);
Array.add(this.km,x);var F=this.Fd.createElement("div");F.className=pn.a.BOe;F.style.cursor=c;x.appendChild(F);F=this.Fd.createElement("div");F.className="TableColumnWidthSpacer";x.appendChild(F);l.insertBefore(this.km[a],l.firstChild)}if(f<this.km.length){for(c=f;c<this.km.length;c++)L.a.tHa(this.km[c]),Ba.a.fO(this.km[c]);c=[];for(l=0;l<f;l++)Array.add(c,this.km[l]);this.km=c}c=this.IKc();l=0;for(a=0;a<f;a++)x=this.n7(a),x=Math.max(x,this.Fd.Cd.Ge(b[a],0)),this.km[a].childNodes[c].style.width=x+
"px",this.km[a].style.left=l+"px",this.km[a].setAttribute("ColumnIndex",a.toString()),l+=x}}dRk(a){var b=n.a.Kw||n.a.$n?"":" 16 20";b=String.format("url('{0}'){1}, pointer",qy.a.box4Image("ColumnSelect.cur"),b);if(a){a=this.PF.firstChild;var c=Math.min(this.PF.childNodes.length,this.km.length);for(var f=0;f<c;++f)a.insertBefore(this.km[f],a.firstChild),a=a.nextSibling}a=this.PF.childNodes.length;if(a>this.km.length){c=this.PF.firstChild;for(f=0;f<this.km.length;++f)c.insertBefore(this.km[f],c.firstChild),
c=c.nextSibling;for(f=this.km.length;f<a;++f){const x=this.Fd.createElement("div");x.className="TableColumnHandleAnchor";Sc.c(x,!0);Array.add(this.km,x);var l=this.Fd.createElement("div");l.className=pn.a.BOe;l.style.cursor=b;x.appendChild(l);l=this.Fd.createElement("div");l.className="TableColumnWidthSpacer";x.appendChild(l);c.insertBefore(x,c.firstChild);c=c.nextSibling}}else if(a<this.km.length){for(b=a;b<this.km.length;++b)L.a.tHa(this.km[b]),Ba.a.fO(this.km[b]);b=[];for(c=0;c<a;++c)Array.add(b,
this.km[c]);this.km=b;b=this.PF.firstChild;for(a=0;a<this.km.length;++a)b.insertBefore(this.km[a],b.firstChild),b=b.nextSibling}b=this.IKc();a=Nn.b(this.$a);for(c=0;c<this.km.length;++c)f=this.n7(c),this.km[c].childNodes[b].style.width=0<=a[c]?Math.max(f,this.Fd.Cd.Ge(a[c],0))+"px":f+"px"}fEe(a){if(!this.Au.length){a=this.Fd.createElement("div");a.innerText="\u00a0";a.className="TableLastResizeAnchor";var b=this.Fd.createElement("div");b.className=pn.a.ajd+" Last";a.appendChild(b);Array.add(this.Au,
a);Sc.c(a,!0);a=!0}if(a){a=Math.min(this.Au.length,this.PF.childNodes.length);for(b=1;b<a;++b){var c=this.PF.childNodes[b];c.insertBefore(this.Au[b],c.firstChild)}(a=this.PF.lastChild)?a.insertBefore(this.Au[0],a.firstChild):Z.ULS.sendTraceTag(38285521,324,15,"Table first row has no child")}a=this.PF.childNodes.length;if(a>this.Au.length){for(b=1;b<this.Au.length;++b)c=this.PF.childNodes[b],c.insertBefore(this.Au[b],c.firstChild);for(b=this.Au.length;b<a;++b){c=this.Fd.createElement("div");c.className=
pn.a.ajd;Sc.c(c,!0);Array.add(this.Au,c);let f=this.PF.childNodes[b];f.insertBefore(c,f.firstChild)}a=this.PF.lastChild;a.insertBefore(this.Au[0],a.firstChild)}else if(a<this.Au.length){for(b=a;b<this.Au.length;++b)L.a.tHa(this.Au[b]),Ba.a.fO(this.Au[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.Au[c]);this.Au=b;for(a=1;a<this.Au.length;++a)b=this.PF.childNodes[a],b.insertBefore(this.Au[a],b.firstChild);(a=this.PF.lastChild)?a.insertBefore(this.Au[0],a.firstChild):Z.ULS.sendTraceTag(38285522,324,15,"Table first row has no child")}}JGe(a,
b){let c=-1;if(xd.TableReader.Yl(this.$a))if(b<=Sys.UI.DomElement.getLocation(this.BR.firstChild.lastChild).x)c=this.BR.firstChild.childNodes.length-1;else for(var f=0;f<this.BR.firstChild.childNodes.length;++f){var l=Sys.UI.DomElement.getLocation(this.BR.firstChild.childNodes[f]);if(b>=l.x){c=f;break}}else if(b<=Sys.UI.DomElement.getLocation(this.BR.firstChild.firstChild).x)c=0;else for(f=this.BR.firstChild.childNodes.length-1;0<=f;--f)if(l=Sys.UI.DomElement.getLocation(this.BR.firstChild.childNodes[f]),
b>=l.x){c=f;break}c<a&&(b=c,c=a,a=b);f=[];l=mb.GraphIterator.mb(this.$a);const x=new mb.GraphIterator;b=new We.GraphTransaction(2);b.Tx(l);Dd.moveToFirstRow(l);Dd.moveToColumnByIndex(l,a);x.Nc(l);Dd.moveToColumnByIndex(x,c);do(a=nd.SelectionFactory.gFc(l,x))&&Array.add(f,a),Dd.moveToNextRow(x);while(Dd.moveToNextRow(l));a=new md.SelectionCollection(f,f.length-1,0);this.Oc.Eb.ZD(a);b.dispose()}Ljc(a,b){const c=this.IKc();this.km&&a<this.km.length&&this.km[a]&&(this.km[a].childNodes[c].style.width=
Math.max(this.n7(a),b)+"px");this.cR.childNodes[a].style.width=Math.max(1,b)+"px"}w0i(a){return this.BR.firstChild.childNodes[a]?this.BR.firstChild.childNodes[a].offsetWidth:(Z.ULS.sendTraceTag(36726402,341,10,"Column {0} does not exist in first row of table. Table Rows: {1} | First row view cells {2}",a,this.BR.childNodes.length,this.BR.firstChild.childNodes.length),0)}PKc(a){a=parseInt(this.cR.childNodes[a].style.width);return isNaN(a)?On.a.zOe:a}q5(a){super.q5(a);H.a.instance.ga(63)&&this.Zvl();
this.oTe()}oTe(){this.fyc||(this.fyc=new He.a(3,1,0,Object(D.a)(this,this.updateTableDOMElements,"updateTableDOMElements"),119),u.AFrameworkApplication.ue.Gb(this.fyc))}updateTableDOMElements(){this.fyc=null;this.m0&&(H.a.instance.ga(63)?this.BBk(this.JHk()):pn.a.Xu&&this.aAe(this.e0d()),u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")&&this.Ldh(!1))}vld(){this.wRk()}dZi(a){return a.offsetWidth+this.xXd(0)/2}e0d(){const a=this.nQa(),b=a.length,c=[];let f=0,l=!1;const x=
xd.TableReader.ju(this.$a);for(let R=0;R<b;R++){const fa=a[R];if(x){let Xa;({Udd:Xa}=this.Ekd(fa)).returnValue&&(l=ik.f(Xa.$a))}const wa=fa.childNodes;for(let Xa=0;Xa<wa.length;Xa++){var F=wa[Xa];if(void 0!==F.colSpan&&null!==F.colSpan&&void 0!==F.rowSpan&&null!==F.rowSpan){let lb;({oLd:lb}=this.cRe(F)).returnValue&&(F=Object.assign(new jL,{ANa:lb,left:F.offsetLeft,top:this.F7d?fa.offsetTop:f,width:this.dZi(F),height:F.offsetHeight,gtg:!R,hug:R+F.rowSpan===b,btg:!l&&!Xa}),c.push(F))}}f+=fa.offsetHeight}return c}Zvl(){if(this.m0){var a=
new mb.GraphIterator;a.set(this.$a);if(xd.TableReader.WPf(a)&&this.cR){a=this.cR.childNodes.length;var b=Array(a),c=[],f=this.nQa(),l=f.length,x=0;for(let F=0;F<l;F++){let R=0;const fa=f[F],wa=fa.childNodes;let Xa=0;for(let lb=0;lb<a;lb++){let Lb;if(b[lb]){let kc;(kc=b[lb]).cPc=kc.cPc-x;let lc;(lc=b[lb]).Sdd=lc.Sdd-1;Lb=b[lb].colSpan;1===b[lb].Sdd&&(R=Math.max(R,b[lb].cPc),b[lb]=null)}else{const kc=wa[Xa];Xa++;if(!kc)continue;let lc=0,Ec;({oLd:Ec}=this.cRe(kc)).returnValue&&(lc=Ec.e_b());Lb=kc.colSpan;
1<kc.rowSpan?b[lb]=Object.assign(new gL,{colSpan:kc.colSpan,cPc:lc,Sdd:kc.rowSpan}):R=Math.max(R,lc)}lb+=Lb-1}({Udd:x}=this.Ekd(fa)).returnValue?(x.S0k(R)&&c.push(x),x=x.Fgh):x=0}for(const F of c)F.Yvl()}}}wRk(){const a=this.nQa();if(Gb.App.instance.JRc&&a.length&&!(a.length<=this.ysf&&a[0].childNodes.length===this.hYe)){this.ysf=a.length;this.hYe=a[0].childNodes.length;var b;for(let c=0;c<a.length;c++)!Ba.a.uba(a[c].firstChild,"DragHandle")&&({Udd:b}=this.Ekd(a[c])).returnValue&&b.fRk()}}Arg(a,b){b=
a.querySelector("."+b);return!!b&&b.parentNode.parentNode===a}aAe(a){if(a)for(const b of a)b.ANa.lnc(b.left,b.top,b.width,b.height,b.gtg,b.hug,b.btg)}nQa(){return this.m0.children}cRe(a){let b;b=null;a&&(a=Sc.a(a),b=Object(va.a)(uv,a));return{returnValue:!!b,oLd:b}}Ekd(a){let b;b=null;a&&(a=Sc.a(a),b=Object(va.a)(Qt,a));return{returnValue:!!b,Udd:b}}JHk(){let a=0;const b=xd.TableReader.ju(this.$a),c=this.F7d,f=this.nQa(),l=[];let x=!1;for(let R=0,fa=f.length;R<fa;R++){const wa=f[R];if(!wa)continue;
if(b){let kc;({Udd:kc}=this.Ekd(wa)).returnValue&&(x=ik.f(kc.$a))}const Xa=new iL,lb=!R,Lb=wa.childNodes;for(let kc=0,lc=Lb.length;kc<lc;kc++){var F=Lb[kc];let Ec;if(({oLd:Ec}=this.cRe(F)).returnValue){const Jc=F.offsetTop,Dc=F.rowSpan,Wd=!kc;F=Object.assign(new hL,{ANa:Ec,left:F.offsetLeft,offsetTop:Jc,top:c?Jc:a,width:F.offsetWidth,height:F.offsetHeight,rowSpan:Dc,Otg:lb,Ptg:R+Dc===fa,Ntg:!x&&Wd,ijg:!Wd&&this.Arg(F,Jf.a.X5d),Fig:!lb&&this.Arg(F,Jf.a.W5d)});Xa.lFd(F)}}a+=wa.offsetHeight;l.push(Xa)}return l}BBk(a){if(a.length){var b=
this.xXd(1)/2,c=this.xXd(0)/2,f=a[0].cells[0].ANa,l=f.Utg(!1);f=f.Utg(!0);var x=[];for(var F of a[0].cells){var R=F.ANa.qtl(F.left,F.width+c,F.offsetTop,l);R&&x.push(R)}pn.a.rKk(x);l=[];for(F=0;F<a.length;F++)x=a[F].cells[0],(R=x.ANa.awl(x.height+b,x.offsetTop,f))&&l.push(R),1<x.rowSpan&&(F+=x.rowSpan-1);pn.a.hMk(l);for(const fa of a)for(const wa of fa.cells)a=wa.ANa,f=wa.width,l=wa.height,a.Xvl(f,l+b,wa.offsetTop,wa.left),a.lnc(wa.left,wa.top,f+c,l,wa.Otg,wa.Ptg,wa.Ntg),wa.ijg&&a.Mbh(Jf.a.X5d),wa.Fig&&
a.Mbh(Jf.a.W5d)}}}gm.Nid="Border";gm.COe="NoBorder";gm.BPf="Conflict";gm.oEh="TableWordWrap";gm.Ijl="WACAltTextDescribedBy";gm.GSa=null;Object(e.a)(gm,"TableViewElement",Cl.a,[625,443,395,106]);class vv extends Qt{constructor(a,b,c){super(a,b,c,null,null)}xGb(a){this.htmlElement.style.height=a+"px"}get Egh(){return this.Fd.Cd.Ge(this.$a.sa(ub.a.Rt,0),1)+"px"}static ufg(a){a=Sc.a(a);let b=null;a&&(b=Object(va.a)(vv,a));return b}}Object(e.a)(vv,"TableRowViewElement",Qt,[]);class Lx{constructor(a,b,
c=!1){this.pci=a;this.Xij=b;this.uGc=c}}Object(e.a)(Lx,"TableBorderProperty",null,[]);var xl=d(493);class Xp{constructor(a,b,c,f,l){this.l8=a;this.rc=c;this.Mb=b;this.xAb=f;this.T2j=l}R9i(a){switch(a){case 0:a=Bb.a.XHb;break;case 1:a=Bb.a.YHb;break;case 2:a=Bb.a.$Hb;break;case 3:a=Bb.a.aIb;break;default:a=null}return{returnValue:!!a,zak:a}}bra(a,b){let c=0;if(!a)return c;let f;({zak:f}=this.R9i(b)).returnValue&&(c=3===b||0===b?a.sa(f,.1):a.sa(f,Xp.Qxk));return c}vKf(a){return.0555555555555556+this.bra(a,
1)+this.bra(a,2)}DKd(a,b){const c=xd.TableReader.$j(a);if(0>b||b>=c)return.0555555555555556;a=this.Mb.Kc(a).Jp(b,1);return this.XBc(a)}XBc(a){let b=.0555555555555556;a=this.Mb.Kc(a);a.zb(1);do{const c=a.currentNode;b=Math.max(b,.0555555555555556+this.bra(c,0)+this.bra(c,3))}while(a.uf(1));return b}job(a,b){var c=xd.TableReader.ui(a);if(0>b||b>=c)return.0555555555555556;c=.0555555555555556;a=this.Mb.Kc(a);a.zb(1);do{const f=a.Jp(b,1);c=Math.max(c,this.vKf(f));a.uc()}while(a.uf(1));return c}FYd(a){return a&&
a.tblBgField&&a.tblBgField.fillField&&(a.tblBgField.fillField.solidFillField||a.tblBgField.fillField.gradFillField)?a.tblBgField.fillField:xl.a.Opb}m1d(a,b){let c=b;if(this.T2j&&b&&b.cellShading){let f;({kja:f}=this.hRe(a,b.cellShading)).returnValue&&(b=Object(va.a)(122,this.rc.Sg(b)),c=this.xAb.Lfh(a,b?b.Se:null,f))}return c}ZZb(a,b){let c=xl.a.Npb;const f=Xp.jQa(b);f.returnValue&&(a=this.m1d(b,a),a.Sa(f.nNa)&&(c=a.getValue(f.nNa)));return c}DWd(a,b,c){if(c&&c.zC===Eb.a.auto)return Kk.a.none;a=this.L0i(a);
b=this.pXd(b);c=c.jU();return String.format("{0} {1}px {2}",a,b,c)}pXd(a){a=this.l8.Ge(a,0);n.a.xsa&&0<a&&1>a&&(a=1);return a}Hnb(a,b,c=!1){let f=Eb.a.pOa.jU();if(a.solidFillField){var l=Cf.Box4ColorHelper.CL(Cf.Box4ColorHelper.Cwa(a.solidFillField),b);c&&(l.r=l.g=l.b=255);f=l.jU()}else if(a.gradFillField){a=rQ(a.gradFillField,b);if(c)for(l of a.stops)l.color.r=l.color.g=l.color.b=255;f=a.jU()}return f}xij(a){const b=a.currentNode.li;a.uc();const c=a.WE(1);a.Jp(b,1);return c?a.currentNode:null}Cij(a){return a.WE(1)}hRe(a,
b){switch(a){case 7:a=b.lnTField;break;case 0:a=b.lnBField;break;case 5:a=b.lnLField;break;case 6:a=b.lnRField;break;default:a=null}return{returnValue:!!a,kja:a}}L0i(a){switch(a){case 2:case 3:case 4:case 5:case 6:case 7:case 9:case 10:return"dashed";case 1:case 8:return"dotted";default:return"solid"}}static jQa(a){let b,c;switch(a){case 7:a=ub.a.Owa;b=ub.a.Mgb;c=ub.a.fjl;break;case 0:a=ub.a.Mea;b=ub.a.Lwa;c=ub.a.ajl;break;case 5:a=ub.a.Nwa;b=ub.a.Lgb;c=ub.a.djl;break;case 6:a=ub.a.Nea;b=ub.a.Mwa;
c=ub.a.ejl;break;case 2:a=ub.a.Ogb;b=ub.a.Kgb;c=ub.a.cjl;break;case 1:a=ub.a.Ngb;b=ub.a.Jgb;c=ub.a.bjl;break;default:c=b=a=null}return{returnValue:!!a,nNa:a,k3a:b,Pnb:c}}}Xp.Qxk=.2;Object(e.a)(Xp,"TableStyleReaderHelper",null,[328]);class ID{constructor(a,b,c=-1){this.uua=a;this.ADg=b;this.MHg=c}}Object(e.a)(ID,"TableStyle",null,[]);var hr=d(322);class Kz{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe){this.uua=new Me.a;this.z3c=new Me.a;this.y3c=new Me.a;this.u3c=new Me.a;
this.IOe=[];this.Mb=a;this.KG=c;this.rc=b;this.Dk=f;this.l8=l;this.oda=x;this.ZFa=F;this.yc=R;this.Zpe=fa;this.j9j=wa;this.e9j=Xa;this.W8j=lb;this.sc=Lb;this.hVa=kc;this.KI=lc;this.vo=Ec;this.xq=Jc;this.EZc=Dc;this.J3j=Wd;this.nyb=xe;this.MEa=Sd;this.gUa=Pe;this.ZFa.Iga(Object(D.a)(this,this.z8c,"onTableConnectedOrDisconnected"));this.ZFa.t6(Object(D.a)(this,this.z8c,"onTableConnectedOrDisconnected"));this.ZFa.xk(Object(D.a)(this,this.M0g,"onTablePropertyChanged"));this.xq.e4h(Object(D.a)(this,this.OZg,
"onPageViewBeforeValidate"))}dispose(){this.ZFa.ima(Object(D.a)(this,this.z8c,"onTableConnectedOrDisconnected"));this.ZFa.yHa(Object(D.a)(this,this.z8c,"onTableConnectedOrDisconnected"));this.ZFa.Tm(Object(D.a)(this,this.M0g,"onTablePropertyChanged"));this.xq.MPk(Object(D.a)(this,this.OZg,"onPageViewBeforeValidate"))}k7f(a){if(!a||!a.length)return null;const b=this.GKc(Object(va.a)(ag.a,a[0]));if(!b)return null;for(let c=1;c<a.length;c++){const f=this.GKc(Object(va.a)(ag.a,a[c]));if(!f||f.zC!==b.zC)return null}return b}Y0d(a){let b=
null;if(a=this.F0b(a))b=new nq.a,b.ke(ub.a.tableStyle,new ID(a,Number.MAX_VALUE));return b}xNc(a){if(14!==a.type){a=this.Mb.Kc(a);a.mc(14);var b=a.Ng(14)}else b=a;a=b.id;this.y3c.Jb(a)||(b=this.Z0d(b),this.y3c.$(a,this.e9j(b)));return this.y3c.ga(a)}m6i(a){return(a=this.yc.Q0d(Object(va.a)(122,this.rc.Sg(a))))?a.TableListStyle:null}Z0d(a){const b=Object(va.a)(122,this.rc.Sg(a));return this.Zpe(()=>a.wX,()=>a.F6,()=>a.tableLook,()=>this.m6i(a),()=>b?b.Se:null,()=>this.F0b(a))}z8c(a,b){this.oqg(b.node)}M0g(a,
b){a=b.property;b=b.node;if(a===ub.a.RIa||a===ub.a.Alc||a===bb.a.Qwa||a===bb.a.Oea||a===bb.a.pA){if(a===bb.a.Qwa||a===bb.a.pA)b.Blc=!1;a!==ub.a.RIa&&a!==ub.a.Alc||this.oqg(b);this.R2b(b)}}abk(a){Array.contains(this.IOe,a)||(this.R2b(a),this.IOe.push(a))}OZg(){Array.clear(this.IOe)}JAj(a){this.u3c.remove(a.id)}oqg(a){a=a.id;this.uua.remove(a);this.z3c.remove(a);this.y3c.remove(a)}vNc(a){const b=a.id;this.u3c.Jb(b)||this.u3c.$(b,this.W8j(this.Z0d(a)));return this.u3c.ga(b)}F0b(a){const b=a.id;if(this.uua.Jb(b))return this.uua.ga(b);
var c=a.sa(ub.a.RIa,null);if(!c)return null;let f=null;const l=Vq.R0f(c);l&&a.Ch&&(f=a.Ch.re(l));a=null;if(f)a=om.a.MPa(f,ub.a.tableStyle);else if(c=this.oda.peg("{"+c.toString()+"}"))a=c.uua;a&&this.uua.$(b,a);return a}TZd(a){return a.tableLook}n7(a,b){a=this.Dk.job(a,b);return this.l8.Ge(a,0)}cZi(a){if(a.Sa(ub.a.UQ))switch(a.sa(ub.a.UQ,0)){case 2:return"bottom";case 1:return"middle"}return"top"}l7f(a){var b=null;if(!a)return null;if(a.cellShading){var c=SK(a.cellShading);Iz(c)||(b=c)}b||(b=this.Ara(a,
ub.a.cellShading,xl.a.Opb));c=Object(va.a)(122,this.rc.Sg(a));b=this.Dk.Hnb(b,c?c.Se:null,this.EZc);a.rowIndex||1!==a.li||ya.a.J(9242778,822,50,"CellId={0} BGCss={1}",a.id.toString(),b);return b}GKc(a){var b=null;let c=null;if(!a)return null;if(a.cellShading){const f=SK(a.cellShading);Iz(f)||(b=f)}b||(b=this.Ara(a,ub.a.cellShading,xl.a.Opb));a=(a=Object(va.a)(122,this.rc.Sg(a)))?a.Se:null;(b=b.solidFillField)&&(c=Cf.Box4ColorHelper.BBa(b,a));return c}K6a(a){var b=null;var c=Object(va.a)(5,a);c&&(a=
c.sa(Bb.a.listLevel,Sg.a.vCa),c=this.Mb.Kc(c),c.mc(7)&&xd.TableReader.Sr(c)&&(c=Object(va.a)(Xl.TableCellNode,c.Ng(16))))&&(this.Z5g(c),b=1+a,b=this.KG.g7f(c,this.xNc(c),b));return{tableStyle:b,V3a:null}}Mej(a){let b=om.a.Bi(a,ub.a.cellShading,xl.a.Opb);if(Iz(b)){const c=this.F0b(a);c&&(b=this.Dk.FYd(c))}a=Object(va.a)(122,this.rc.Sg(a));return this.Dk.Hnb(b,a?a.Se:null)}Q0i(a){return!ee.a("PPTOEnableTableDiagonalBorders")||2!==a&&1!==a?xl.a.Npb:xl.a.hDi}e2i(a,b){if(this.J3j&&this.vo.AS&&!this.KCj(a,
b))return new Lx("","");var c=Object(va.a)(125,a);if(({nNa:x,k3a:F,Pnb:R}=Xp.jQa(b)).returnValue)if(this.gUa&&ee.a("TableBordersLocalRenderingFix")){var f=this.Ara(c,x,this.Q0i(b),!0);var l=this.Ara(c,R,xl.a.Mpb,!0);var x=c.sa(x,f);f={};if(ee.a("FixClearTableBorder")){let fa=this.Mb.Kc(c);fa.mc(14);if(fa.Ng(14).Sa(ub.a.RIa)){f.Color="##T,0,0,0";f=Cf.Box4ColorHelper.s0(f);f=this.Ara(c,F,f,!0);var F=om.a.Bi(c,F,f);F=Cf.Box4ColorHelper.Cwa(F);a=this.rc.Sg(a);a=(a=Cf.Box4ColorHelper.CL(F,a?a.Se:null))?
Cf.Box4ColorHelper.$ma(a):null}else f.Color="#000000",a=Cf.Box4ColorHelper.s0(f),a=Cf.Box4ColorHelper.Wqa(a)}else f.Color="##T,0,0,0",f=Cf.Box4ColorHelper.s0(f),f=this.Ara(c,F,f,!0),F=om.a.Bi(c,F,f),F=Cf.Box4ColorHelper.Cwa(F),a=this.rc.Sg(a),a=(a=Cf.Box4ColorHelper.CL(F,a?a.Se:null))?Cf.Box4ColorHelper.$ma(a):null;l=c.sa(R,l)}else l=this.Dk.m1d(b,c),x=l.Sa(x)?l.getValue(x):this.Ara(c,x,xl.a.Npb,!0),a=this.d7f(l,c,F),l=l.Sa(R)?l.getValue(R):this.Ara(c,R,xl.a.Mpb,!0);else x=xl.a.Npb,a=xl.a.OFc,l=xl.a.Mpb;
5!==b||a.zC===Eb.a.auto||c.rowIndex||1!==c.li||ya.a.J(9242780,822,50,"CellId={0} BGR={1} Alpha={2}",c.id.toString(),a.zC,a.alpha);var R=!1;a.zC!==Eb.a.auto||7!==b&&5!==b||(f=this.Mb.Kc(c),f.mc(14),7===b?(F=ub.a.Lwa,f=this.Dk.xij(f)):(F=ub.a.Mwa,f=this.Dk.Cij(f)),f&&(c=this.Dk.m1d(b,c),this.d7f(c,f,F).zC===Eb.a.auto&&(l=xl.a.Mpb,x=xl.a.Wij,a=xl.a.Vij,R=!0)));c=this.Dk.DWd(l,x,a);return R&&7===b?new Lx(c,"Top"):R&&5===b?new Lx(c,"Left"):new Lx(c,"")}rLc(a,b){switch(b){case 7:b=ub.a.Owa;break;case 6:b=
ub.a.Nea;break;case 0:b=ub.a.Mea;break;case 5:b=ub.a.Nwa;break;default:b=null}const c=this.Ara(a,b,xl.a.Npb,!0);return a.sa(b,c)}KCj(a,b){if(!a||a.isGhostCell||2===b||1===b)return!0;const c=this.Mb.Kc(a);if(!c.mc(14))return!0;var f=c.rw(14);if(!f.lp())return!0;const l=a.rowSpan,x=a.colSpan;if(1===l&&1===x)return!0;f=this.sc.Jej(f);const F=new hr.a;F.ge=this.hVa.Kaj(c);F.Wf=F.ge+l;F.Yd=this.KI.QKc(Object(va.a)(125,a));F.Jf=F.Yd+x;switch(b){default:ya.a.J(560562957,822,15," Unknown position type: {0} ",
b);break;case 5:if(!F.Yd||1===l)break;if(4!==(f.Or(F.ge,F.Yd-1)&4)||8!==(f.Or(F.Wf-1,F.Yd-1)&8))break;for(a=F.ge+1;a<F.Wf;++a)if(4===(f.Or(a,F.Yd-1)&4))return!1;break;case 6:if(F.Jf===f.CQ||1===l)break;if(4!==(f.Or(F.ge,F.Jf)&4)||8!==(f.Or(F.Wf-1,F.Jf)&8))break;for(a=F.ge+1;a<F.Wf;++a)if(4===(f.Or(a,F.Jf)&4))return!1;break;case 7:if(!F.ge||1===x)break;if(1!==(f.Or(F.ge-1,F.Yd)&1)||2!==(f.Or(F.ge-1,F.Jf-1)&2))break;for(a=F.Yd+1;a<F.Jf;++a)if(1===(f.Or(F.ge-1,a)&1))return!1;break;case 0:if(F.Wf!==f.$N&&
1!==x&&1===(f.Or(F.Wf,F.Yd)&1)&&2===(f.Or(F.Wf,F.Jf-1)&2))for(a=F.Yd+1;a<F.Jf;++a)if(1===(f.Or(F.Wf,a)&1))return!1}return!0}d7f(a,b,c){if(this.gUa){const f=Cf.Box4ColorHelper.s0({Color:"##T,0,0,0"});a=om.a.Bi(a,c,f);a=Cf.Box4ColorHelper.Cwa(a);b=this.rc.Sg(b);b=(b=Cf.Box4ColorHelper.CL(a,b?b.Se:null))?Cf.Box4ColorHelper.$ma(b):null}else a.Sa(c)?(b=a.Sh(c),b=Object(Fa.a)(Eb.a,b)?b:new Eb.a(a.getValue(c))):b=this.Ara(b,c,xl.a.OFc,!0);this.EZc&&(b=new Eb.a(0,b.alpha));return b}R2b(a){const b=this.MEa?
this.Mb.NZd(a):this.Mb.Kc(a);let c=Object(va.a)(153,b.Ji());for(a=Object(va.a)(179,a);c;)c.Qdd=!1,c=Object(va.a)(153,b.jp());this.JAj(a);this.MEa?this.sAj(a):a.Uba(4)}sAj(a){if(a&&a.isConnected)for(a=this.Mb.NZd(a),a=wi.a.Ju(a);a.moveNext();)a.currentNode.anchor.ir(4)}mAl(a){a&&(this.xNc(a),this.F0b(a),this.vNc(a))}Ara(a,b,c,f=!1){if(!a)return c;var l=this.Mb.Kc(a);l.mc(14);l=l.Ng(14);var x=l.id;if(this.nyb&&f){if(!l.Sa(ub.a.RIa))return c;x=a.rowIndex;a=a.li;return(a=this.vNc(l).AYi(l,x,a))&&a.Sa(b)?
a.Sh(b):c}this.Z5g(a);f=a.aU;if(!f){if(!l.Sa(ub.a.RIa))return c;f=a.rowIndex;let F=a.li;const R=a.rowSpan,fa=a.colSpan;this.z3c.Jb(x)||this.z3c.$(x,this.j9j(this.Z0d(l)));f=this.z3c.ga(x).uXd(f,F,R,fa);a.aU=f}return f&&f.Sa(b)?f.Sh(b):c}mhi(a){const b=this.Mb.XPa();b.set(a);let c=0,f=Object(va.a)(153,b.zb(1));for(;f;)f.rowIndex=c,c++,f=Object(va.a)(153,b.jp());a.Blc=!0}Azk(a){let b=0;const c=a.rowIndex,f=this.Mb.XPa();f.set(a);let l=Object(va.a)(125,f.zb(1));for(;l;)l.rowIndex=c,l.li=b,l.aU=null,
this.KG.jTk(l),l.$Zf(),l=Object(va.a)(125,f.jp()),b++;a.Qdd=!0}Z5g(a){var b=this.Mb.Kc(a);b.mc(14);a=Object(va.a)(153,b.Ng(15));(b=Object(va.a)(179,b.Ng(14)))&&!b.Blc&&this.mhi(b);a&&!a.Qdd&&this.Azk(a)}}Object(e.a)(Kz,"TableStyleReader",null,[651,652,653]);class Il extends gm{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc){super(a,b,c);this.A_c=this.Pz=this.Yzb=this.Usa=this.AG=null;this.Lac=l;this.Dk=x;this.vo=F;this.ve=R;this.s_=[];this.yc=f;this.Oab=lb;this.hc=Lb;this.rc=kc;this.Yi=
lc;this.pyb=wa.pptIsTableColumnRowResizeHandleRenderedByCSSEnabled;this.Yje=wa.pptComplexTableLayoutSyncEnabled;this.e_=wa.qia;this.KMg=Xa;this.sc=Ec;this.Mb=Jc;this.ile=wa.K9;this.r_c=wa.Wuh;if(Dc)this.Pz=Dc;else throw Error.argumentNull("slideDimensionsHelper");if(this.Oc.So){if(this.AG=fa?fa(a):null)this.AG.xzh(),this.pk&&this.pk.PT&&(this.AG.Mbi(this,this.pk.PT,this.table),this.AG.Ux(!this.hc.ln));ee.a("DeprecateIE.TableViewElement.ctor")||!this.vo.q8a&&!this.vo.s8a||(this.htmlElement.style.backgroundColor=
"rgba(0,0,0,0)")}this.pk&&(this.pk.M3h(Object(D.a)(this,this.M_g,"onShapeEnterTextEditing")),this.pk.$Cf(Object(D.a)(this,this.V_g,"onShapeSelectionChanged")),this.pk.O3h(Object(D.a)(this,this.N_g,"onShapeExitTextEditing")),this.pk.o3h(Object(D.a)(this,this.kWg,"onAfterDraw")),this.pk.V4h(Object(D.a)(this,this.h_g,"onReadModeChanged")),this.pk.K3h(Object(D.a)(this,this.IXg,"onDisplayOnActiveSlide")))}get Pli(){return this.AG}IXg(){this.vOe()}get pk(){if(this.Usa)return this.Usa;if(this.Oc.So){const a=
jg.a.mb(this.Oc.Ma,this.$a);a.Ze();a.pXa();this.Usa=Object(va.a)(124,a.lOa)}return this.Usa}I_d(){if(!this.r_c)return 1;var a=this.rc.Sg(this.$a);if(!a)return 1;var b=a.oc(this.Ma);if(!b)return 1;b=b.Oaa?b.Oaa.ya.style.visibility===Ii.a.visible:!1;var c=new er.a(a.Yp,a.Ek);if(!this.Pz)return 1;b=this.Pz.o0b(c,b).kO;c=this.Yi.ZF;a=this.yc.kNc(a)*c;return b/a}cih(a){if(1!==a&&this.r_c){var b=this.sc.lia(this.$a);for(var c of b)b=this.Fd.Cd.Ge(c.sa(ub.a.Rt,0),1)*a,c.oc(this.Ma).htmlElement.style.height=
b+"px";c=Nn.b(this.$a);for(b=0;b<c.length;b++){const f=this.Fd.Cd.Ge(c[b],0)*a;this.CDc.childNodes[b].style.width=f+"px"}}}cA(a){super.cA(a);this.cih(this.I_d());this.Awh(this.Oab.pub?!!this.pk&&this.pk.uK()&&(this.pk.yA||this.pk.Fn):!!this.pk&&this.pk.Fn)}DT(){const a=this.Lac,b=Nn.b(this.$a),c=xd.TableReader.ui(this.$a);let f=0;for(let l=0;l<c;l++)f+=Math.max(a.n7(this.$a,l),this.Fd.Cd.Ge(b[l],0));return new lf.a(0,f,0)}q5(a){super.q5(a);if(this.Oc.So&&(a=this.KMg.fNc(this.$a,this.Ma))&&0!==a.OQc){const b=
this.$a;if(b.hN)return;this.Yje?a.pBh(b):a.OQc&2?a.pBh(b):a.Qul(b,c=>{c&&this.vOe()})}this.vOe()}vOe(){this.AG&&this.pk&&this.pk.Fn&&this.uOe()}vmh(a,b){Object(va.a)(Kz,Tc.StyleReader.Vq);if(1!==b)for(var c=0;c<this.m0.childNodes.length;c++){var f=this.m0.childNodes[c];if(!f||"TR"!==f.tagName.toUpperCase())continue;const x=f.offsetHeight*b;var l=this.Dk.DKd(this.$a,c);l=this.Fd.Cd.Ge(l,1);f.style.height=(x<l?0:x)+"px"}if(1!==a)for(b=0;b<this.CDc.childNodes.length;b++)c=Xe.a.jn(this.CDc.childNodes[b].style.width),
f=this.Dk.job(this.$a,b),f=this.Fd.Cd.Ge(f,0),this.Ljc(b,Math.max(c*a,f))}Caj(a){a>this.m0.childNodes.length&&Error.argumentOutOfRange("rowIdx");const b=this.m0.childNodes[a];b&&"TR"===b.tagName.toUpperCase()||Error.invalidOperation(String.format("Child node '{0}' is not a table row",a));return Xe.a.jn(b.style.height)}B0b(){return td.a.tba(this.ve.Yh(this.table))}get dIj(){const a=this.KMg.fNc(this.$a,this.Ma);return!a||0===a.OQc}Jcg(){const a=[0];for(let b=1;b<=this.m0.childNodes.length;++b)a[b]=
a[b-1]+this.m0.childNodes[b-1].offsetHeight;return a}D7f(){const a=[0];for(let b=1;b<=this.CDc.childNodes.length;++b)a[b]=a[b-1]+this.PKc(b-1);return a}fEe(a){if(14!==this.$a.type)ya.a.J(512497121,808,10,"The source node of the table view element is not a table node but {0}",this.$a.type);else if(this.$a.sa(ub.a.complexTable,!0))ya.a.J(512497118,808,50,"Disable column resizing for table with merged cells");else{super.fEe(a);a=new mb.GraphIterator;a.set(this.$a);Dd.moveToFirstRow(a);Dd.moveToFirstColumn(a);
let b=1;const c=this.Fd.Cd.Ge(this.Dk.ZZb(a.currentNode,6),0);for(;!De.isLastCellInRow(a);){Dd.moveToNextColumn(a);const f=this.Au[b++],l=Xe.a.Lc(-1*c);xd.TableReader.Yl(this.$a)?f.style.marginRight=l:f.style.marginLeft=l}this.Au.length!==b&&ya.a.J(512497119,808,10,"Table has inconsistent column resize handles: {0} handles, {1} columns",this.Au.length,b)}}Xea(a){super.Xea(a);this.Oc.Bl||this.yRk();this.$a.sa(ub.a.complexTable,!0)||pn.a.Xu||this.xRk()}dispose(){super.dispose();this.AG&&(this.AG.dispose(),
this.AG=null);this.pk&&(this.pk.zPk(Object(D.a)(this,this.M_g,"onShapeEnterTextEditing")),this.pk.sdh(Object(D.a)(this,this.V_g,"onShapeSelectionChanged")),this.pk.APk(Object(D.a)(this,this.N_g,"onShapeExitTextEditing")),this.pk.jPk(Object(D.a)(this,this.kWg,"onAfterDraw")),this.pk.nQk(Object(D.a)(this,this.h_g,"onReadModeChanged")),this.pk.xPk(Object(D.a)(this,this.IXg,"onDisplayOnActiveSlide")));this.Usa=null}kWg(){this.pk.kN&&this.uOe(!0)}Jji(){if(this.ile){var a=this.$a,b=a.D0b();if(a.Blc)for(const c of b){a=
c;if(!a)continue;a=a.oc(this.Ma);if(!a)continue;b=this.Lac.rLc(c,7);const f=this.Lac.rLc(c,6),l=this.Lac.rLc(c,0),x=this.Lac.rLc(c,5);0===b&&a.Xbd("Top");0===f&&a.Xbd("Right");0===l&&a.Xbd("Bottom");0===x&&a.Xbd("Left")}}}V_g(a,b){this.Awh(b.isSelected);a=this.table;this.Jji();b.isSelected?Sys.UI.DomElement.containsCssClass(a,"Selected_Table")||Sys.UI.DomElement.addCssClass(a,"Selected_Table"):Sys.UI.DomElement.containsCssClass(a,"Selected_Table")&&Sys.UI.DomElement.removeCssClass(a,"Selected_Table")}h_g(a,
b){this.AG&&this.AG.Ux(b.BLj)}Awh(a){if(this.AG)if(this.e_){const b=this.Mb.Kc(this.$a);b.Ze();b.pXa().getValue(ub.a.isResizable)?this.AG.visible=a:this.AG.visible=!1}else this.AG.visible=a;this.pk&&this.pk.Ld&&this.pk.shapeNode&&this.pk.shapeNode.WP&&(this.pk.Ld.visible=a)}xRk(){if(!this.s_.length){var a=this.aOa();Sys.UI.DomElement.addCssClass(a,"First");this.s_.push(a);a=this.Vzi();Sys.UI.DomElement.addCssClass(Il.$9f(a),"Last");this.s_.push(a)}var b=this.nQa();a=b.length;var c=a+1-this.s_.length;
if(!(0>=a)){if(0<c)for(var f=0;f<c;f++){let l=this.aOa();this.s_.splice(this.s_.length-1,0,l)}if(0>c){for(f=0;f<c;f++)this.vEb(this.s_[f+1]);this.s_.splice(1,c)}for(c=0;c<a;c++)f=b[c].firstChild,f.insertBefore(this.s_[c],f.firstChild);b=b[a-1].firstChild;b.insertBefore(this.s_[a],b.firstChild);this.J6h()}}J6h(){const a=new mb.GraphIterator;a.set(this.$a);Dd.moveToFirstRow(a);Dd.moveToFirstColumn(a);let b=1;for(;b<this.s_.length;){var c=this.Fd.Cd.Ge(this.Dk.ZZb(a.currentNode,5),0),f=this.Fd.Cd.Ge(this.Dk.ZZb(a.currentNode,
0),1);let l=this.s_[b];Il.rOj(l)&&(l=Il.$9f(l));c=Xe.a.Lc(-1*c);f=Xe.a.Lc(-1*f-(b===this.s_.length-1?4:0));xd.TableReader.Yl(this.$a)?l.style.marginRight=c:l.style.marginLeft=c;l.style.marginTop=f;Dd.moveToNextRow(a);b++}}yRk(){if(!this.Yzb){const a=String.format("url('{0}'), pointer",qy.a.box4Image("RowSelect.cur"));this.Yzb=this.Fd.createElement("div");this.Yzb.className=Ul.a.Xjl;Sc.c(this.Yzb,!0);const b=this.Fd.createElement("div");b.className=Ul.a.DOe;b.style.cursor=a;this.Yzb.appendChild(b);
this.table.appendChild(this.Yzb)}}Eaj(){return this.nQa()}aOa(){const a=this.Fd.createElement("div");a.className="TableRowResizeHandle";a.style.width="100%";Sc.c(a,!0);return a}Vzi(){const a=this.Fd.createElement("div");a.className="TableRowResizeAnchor";const b=this.aOa();a.appendChild(b);Sc.c(a,!0);return a}vEb(a){L.a.tHa(a);Ba.a.fO(a)}Bej(a){var b=this.rc.Sg(this.$a);let c=this.Yi.ZF;b&&b.uw&&null!=b.uw.Fr&&(c=b.uw.Fr);b=this.yc.kNc(this.rc.Sg(this.$a))*c;a=a.copy();a.move(-a.Zb,-a.fc);a.scale(1/
b,1/b);return a}M_g(){this.table.clientWidth&&this.uOe(!0);!this.Oab.pub&&this.AG&&(this.AG.visible=!0,this.pk&&this.pk.Ld&&(this.pk.Ld.visible=!0));this.pk&&this.pk.uK()&&!Sys.UI.DomElement.containsCssClass(this.table,"Selected_Table")&&Sys.UI.DomElement.addCssClass(this.table,"Selected_Table")}N_g(){this.AG&&(this.AG.visible=!1);this.pk&&this.pk.Ld&&(this.pk.Ld.visible=!1)}uOe(a=!1){var b=this.B0b();let c=Pd.a.Rmd;this.A_c&&(c=td.a.N_b(b,this.A_c));const f=ad.a.xUe;a=!!this.pk&&(!this.A_c||!f.equals(ad.a.xUe)||
!c.equals(Pd.a.Rmd)||a);this.A_c=b;if(a&&(a=this.pk.hSe,b=td.a.N_b(this.Bej(b),a),this.pk.setOffsets(b,!0),!ee.a("DeprecateIE.TableViewElement.SynchronizeViews")&&this.vo.q8a&&0<this.m0.childNodes.length))for(b=this.m0.childNodes[0].offsetWidth,a=0;a<this.s_.length;a++)this.s_[a].style.width=b+"px";this.AG&&this.AG.jm();this.pyb||this.oTe()}e0d(){return this.pyb?null:super.e0d()}aAe(a){if(this.pyb){var b=this.sc.$j(this.$a);a=Object(va.a)(mb.GraphIterator,this.Mb.Kc(this.$a));Dd.forEachCellInTable(a,
(c,f,l)=>{c=c.currentNode;const x=c.oc(this.Ma);x&&x.lnc(0,0,0,0,!f,f+c.rowSpan===b,!l);return!0})}else super.aAe(a)}I7i(a){let b=-1;var c=xd.TableReader.ui(this.$a),f=Nn.b(this.$a);const l=Array(c);for(let x=0;x<c;x++)l[x]=Math.floor(this.Fd.Cd.Ge(f[x],0));if(xd.TableReader.Yl(this.$a))if(a<=Sys.UI.DomElement.getLocation(this.m0.firstChild.lastChild).x)b=c-1;else{a-=Sys.UI.DomElement.getLocation(this.m0.firstChild.lastChild).x;for(--c;0<=c;c--)if(a>=l[c])a-=l[c];else{b=c;break}-1===b&&(b=0)}else if(a<=
Sys.UI.DomElement.getLocation(this.m0.firstChild.firstChild).x)b=0;else{a-=Sys.UI.DomElement.getLocation(this.m0.firstChild.firstChild).x;for(f=0;f<c;f++)if(a>=l[f])a-=l[f];else{b=f;break}-1===b&&(b=c-1)}return b}Uih(a,b,c=!0){const f=mb.GraphIterator.mb(this.$a),l=new mb.GraphIterator,x=new We.GraphTransaction(2);x.Tx(f);Dd.moveToFirstRow(f);c?(Dd.moveToRowByIndex(f,a),Dd.moveToFirstColumn(f)):Dd.moveToColumnByIndex(f,a);l.Nc(f);c?(Dd.moveToRowByIndex(l,b),Dd.moveToLastColumn(l)):(Dd.moveToColumnByIndex(l,
b),Dd.moveToLastRow(l));a=nd.SelectionFactory.CWb(f,l);this.Oc.Eb.ZD(a);x.dispose()}static Gaj(a){return Il.Haj(a,pn.a.Xu)}static Haj(a,b){return b?Il.Faj(a):Il.Iaj(a)}static Iaj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){Il.A8d(a)||Il.k9d(a)||(b=b.previousSibling);break}b=b.parentNode}return vv.ufg(b)}static Faj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){if(Il.k9d(a)){if((a=a.parentNode)&&void 0!==a.rowSpan&&null!==a.rowSpan){a=a.rowSpan;for(let c=1;c<a&&b;c++)b=b.nextSibling}}else Il.A8d(a)||
(b=b.previousSibling);break}b=b.parentNode}return b?vv.ufg(b):null}static S2(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnResizeHandle")}static iSa(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeHandle")}static rOj(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeAnchor")}static tsa(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnHandle")}static W4b(a){return Sys.UI.DomElement.containsCssClass(a,Ul.a.DOe)}static Iej(a){for(;a;){if("TABLE"===a.nodeName.toUpperCase())return a;
a=a.parentNode}return null}static A8d(a){return Sys.UI.DomElement.containsCssClass(a,"First")}static k9d(a){return Sys.UI.DomElement.containsCssClass(a,"Last")}static ctg(a){return Sys.UI.DomElement.containsCssClass(a,"FirstLeft")}static $9f(a){return a.firstChild}}Object(e.a)(Il,"TableViewElement",gm,[623,624,625,443,395,106]);class lL extends fL.a{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){super(a,b);this.vJf="ShowDashedLine";this.oka=this.Ud=this.Pd=this.ELg=this.yLg=this.MLg=this.zab=this.Tme=this.Sme=
this.ee=this.GLg=null;this.BNg=this.ANg=this.M3=this.L3=this.abb=this.dda=0;this.f9=c;this.Q$a=f;this.$r=l;this.sc=x;this.ra=F;this.Qz=R;this.ia=fa;this.vp=Xa;this.Y8b=this.bke=!1;this.K3j=wa}get bFe(){this.wMf();return this.ee.offsetLeft}set bFe(a){this.wMf();this.ee.style.left=Xe.a.Lc(a)}get zoom(){return 1}su(a){const b=super.su(a);if(b&&this.nM){this.yKd(a.Fc);Sys.UI.DomElement.addCssClass(this.ee,this.vJf);if(this.T$=Il.ctg(a.Fc))this.ji=0,this.vE=this.Wk.PKc(this.ji);this.Pd=this.Wk.pk;this.Ud=
this.sc.E0b(this.Pd.$a);this.Y8b=!1;this.mKe()&&this.$Zi(a)}else b&&!this.nM&&(a=a.Fc,Il.tsa(a)&&(ya.a.J(512497184,816,50,"Drag from table column handle"),this.ji=parseInt(a.parentNode.getAttribute("columnindex").toString())));b&&this.vp&&this.ia.processAction(C.a.Tha,2);return b}aw(a){this.nM?(a=this.wKf(a.clientPoint.x),this.bFe=this.GLg+(a-this.vE)*(this.T$?-1:1)):(a=this.Wk.I7i(a.clientPoint.x),this.Wk.Uih(this.ji,a,!1));return!0}Ln(a){if(this.nM){const f=this.f9.wi("UserAction","PPTColumnResize");
a&&ya.a.J(8959051,822,50,String.format("Start Column resize for table: {0}, IsComplex: {1}",this.Wk.$a.sa(ub.a.hBb,""),this.Wk.$a.lp()));const l=new We.GraphTransaction(15);l.fd(this.Wk.$a);const x=this.Wk.$a.sa(bb.a.uu,null);var b=this.wKf(a.clientPoint.x),c=this.Wk.Fd.Cd;const F=c.Ef(b,0);(this.T$||this.ji===this.MF-1)&&this.$r.MXa(this.Wk.$a,this.ji,F);if(this.T$&&b!==this.vE&&(b=this.vE-b)){this.Pd.setPosition(this.Pd.x+b,this.Pd.y,!0);b=c.Ef(this.Pd.x,0);c=c.Ef(this.Pd.y,1);const R=this.Wk.pk.shapeNode;
R.My=b;R.Ny=c}!this.T$&&this.ji<this.MF-1&&this.gJe(F,x);this.Cmc();l.dispose();Gb.App.Fb.updateCommandUI();this.end();this.Ud?this.$r.UWa(this.Ud):ya.a.J(512497183,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");f&&f.stop();a&&ya.a.J(8959053,822,50,String.format("End Column resize for table: {0}, IsComplex: {1}, IsFirstColumnLeftResizeHandle: {2}",this.Wk.$a.sa(ub.a.hBb,""),this.Wk.$a.lp(),this.T$))}else a&&Gb.App.Fb.Q4(a.clientPoint,a.Vf),super.Ln(a)}Nt(a){super.Nt(a);
this.nM&&this.Cmc()}keg(){return null}wMf(){if(!this.ee)throw Error.argumentNull("m_element","Try to use the resize handle before it is initialized");if(!pn.a.S2(this.ee))throw Error.invalidOperation("Element is not the table column resize handle");}yKd(a){this.ee=a;this.GLg=this.bFe;this.Sme=this.ee.style.marginLeft;this.Tme=this.ee.style.marginRight;this.zab=this.ee.style.height;this.MLg=this.ee.style.top;this.yLg=this.ee.style.bottom;this.ELg=this.ee.style.left;this.ee.style.marginLeft=this.ee.style.marginRight=
"auto";this.ee.style.top="0";this.ee.style.height="auto";this.ee.style.bottom="0";this.Q$a&&(a=pn.a.G0b(a))&&(this.ee.style.top=-a.offsetTop+"px",this.ee.style.bottom=-(this.Wk.getBounds().height-a.offsetTop-a.offsetHeight)+"px")}Cmc(){this.ee&&(Sys.UI.DomElement.removeCssClass(this.ee,this.vJf),this.ee.style.marginLeft=this.Sme,this.ee.style.marginRight=this.Tme,this.Sme=this.Tme="auto",this.ee.style.left=this.K3j?this.ELg:"auto",this.ee.style.top=this.MLg,this.ee.style.height=this.zab,this.ee.style.bottom=
this.yLg,this.ee=null)}$Zi(a){this.Y8b=this.bke=!1;a=a.Fc;if(pn.a.S2(a)){var b=null,c=null;({f9a:b,Meb:c}=this.ZZi(a,b,c)).returnValue&&this.J_i(b,c)&&this.d0d()&&this.Ud&&(a=this.sc.ui(this.Ud),b=this.sc.$j(this.Ud),0<=this.dda&&this.dda<b&&0<=this.abb&&this.abb<b&&0<=this.L3&&this.L3<a&&0<=this.M3&&this.M3<a&&(this.Y8b=!0))}}ZZi(a,b,c){if(!pn.a.S2(a)||!this.Ud)return{returnValue:!1,f9a:b,Meb:c};var f=pn.a.G0b(a);f=Sc.a(f);this.oka=Object(va.a)(Xl.TableCellNode,f.$a);if(!this.oka)return{returnValue:!1,
f9a:b,Meb:c};f=this.dMc(this.oka);if(0>f||f>=this.sc.ui(this.Ud))return{returnValue:!1,f9a:b,Meb:c};const l=this.oka.rowIndex;if(0>l||l>=this.sc.$j(this.Ud))return{returnValue:!1,f9a:b,Meb:c};if(Il.ctg(a))return{returnValue:!1,f9a:null,Meb:c};b=this.Ud.ef(l,f);if(f===this.sc.ui(this.Ud)-1)return{returnValue:!1,f9a:b,Meb:null};c=this.Ud.ef(l,f+1);return{returnValue:!0,f9a:b,Meb:c}}J_i(a,b){if(!this.Ud||!a||!b)return!1;this.dda=a.rowIndex;if(0>this.dda||this.dda>=this.sc.$j(this.Ud))return!1;this.abb=
this.dda;this.L3=this.o_b(a);if(0>this.L3||this.L3>=this.sc.ui(this.Ud))return!1;this.M3=this.dMc(b);if(0>this.M3||this.M3>=this.sc.ui(this.Ud))return!1;var c=this.JWi(a,b);a=c?this.pYi(a,b):!1;if(c=c&&a)this.bke=this.REj(b.li);return c}REj(a){let b=!0;if(0<this.dda)for(var c=this.dda-1;0<=c;){var f=this.Ud.ef(c,a);if(f&&!f.isGhostCell){b=!1;break}--c}if(this.abb<this.Ud.wX-1)for(c=this.dda+1;c<=this.Ud.wX-1;){if((f=this.Ud.ef(c,a))&&!f.isGhostCell){b=!1;break}c+=1}return b}d0d(){if(!this.Ud)return!1;
const a=this.sc.ui(this.Ud);if(0>this.L3||this.L3>=a||0>this.M3||this.M3>=a||0>this.ji||this.ji>=a||0>this.ji+1||this.ji+1>=a)return!1;this.ANg=this.W1d(this.Ud,this.L3,this.ji)-this.b_d(this.Ud,this.L3);this.BNg=this.W1d(this.Ud,this.M3,this.ji+1)-this.b_d(this.Ud,this.M3);return!0}W1d(a,b,c){if(b>c)return this.W1d(a,c,b);if(!a||0>b||b>=this.sc.ui(a)||0>c||c>=this.sc.ui(a))return-1;a=a.GXd;let f=0;for(;b<=c;b++)f+=a[b];return Math.floor(this.Wk.Fd.Cd.Ge(f,0))}b_d(a,b){return Tc.StyleReader.Vq?Tc.StyleReader.Vq.n7(a,
b):On.a.Xid}RBa(a,b){return this.Wk.Fd.Cd.Ef(this.b_d(a,b),0)}JWi(a,b){if(!a||!b)return!1;a=a.g_b();const c=b.li;for(b=b.g_b();b&&(!b.isGhostCell||this.o_b(b)===c);)this.dda--,this.L3=Math.max(this.L3,this.o_b(a)),this.M3=Math.min(this.M3,this.dMc(b)),a=a.g_b(),b=b.g_b();return!0}pYi(a,b){if(!a||!b)return!1;a=a.EKc();const c=b.li;for(b=b.EKc();b&&(!a.isGhostCell||this.o_b(b)===c);)this.abb++,this.L3=Math.max(this.L3,this.o_b(a)),this.M3=Math.min(this.M3,this.dMc(b)),a=a.EKc(),b=b.EKc();return!0}o_b(a){return a?
(a=a.oy())?a.li:-1:-1}dMc(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.oy());a=null;b&&(a=b.rZd(2));return a?a.li:-1}wKf(a){this.mKe()&&this.Y8b?(a=this.Wk.$a.gMj?Math.floor((this.Z5-a)/this.zoom)+this.vE:Math.floor((a-this.Z5)/this.zoom)+this.vE,a=Math.min(a,this.vE+this.BNg),a=Math.max(a,this.vE-this.ANg)):a=this.EKd(a);return a}gJe(a,b){if(this.mKe()&&this.Y8b){if(!this.ra.uG()){var c=nd.SelectionFactory.Jg(Object(va.a)(ag.a,this.oka.mZb),0);this.ra.setSelection(c)}let f=c=-1,l=-1;({WXf:c,pXf:f,
qXf:l}=this.R1i(a-b[this.ji],b,c,f,l));this.bke&&(c===this.ji&&Math.abs(f)>=this.RBa(this.Ud,c)||c===this.ji+1&&c<this.sc.ui(this.Ud)-1&&Math.abs(l)>=this.RBa(this.Ud,c+1)||c===this.ji+1&&c===this.sc.ui(this.Ud)-1)?(ya.a.J(512497182,815,50,"DragAcrossColumn: scenario-1, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ji.toString(),c.toString(),f.toString(),l.toString()),a=b[this.ji]+b[this.ji+1],c===this.ji?(f=Math.max(f,this.RBa(this.Ud,
c)),l=a-f):c===this.ji+1&&(l=Math.max(l,this.RBa(this.Ud,c)),f=a-l),this.$r.MXa(this.Ud,this.ji,f),this.$r.MXa(this.Ud,this.ji+1,l)):(c>this.L3&&Math.abs(f)<this.RBa(this.Ud,c)?(ya.a.J(512497181,815,50,"DragAcrossColumn: scenario-2, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ji.toString(),c.toString(),f.toString(),l.toString()),this.gcb(c,this.ji+1)):c<this.M3&&Math.abs(l)<this.RBa(this.Ud,c+1)?(ya.a.J(512497180,815,50,"DragAcrossColumn: scenario-3, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.ji.toString(),c.toString(),f.toString(),l.toString()),this.gcb(c+1,this.ji+1)):(ya.a.J(512497179,815,50,"DragAcrossColumn: scenario-4, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ji.toString(),c.toString(),f.toString(),l.toString()),this.Lfl(c,f,l)),this.$r.DDe(this.Ud),a=mb.GraphIterator.mb(this.Ud),this.$r.pSe(a),this.Ud.Uba(511),this.Qz.R2b(this.Ud))}else this.$r.MXa(this.Ud,this.ji,a),this.$r.MXa(this.Ud,this.ji+1,b[this.ji]+
b[this.ji+1]-a)}R1i(a,b,c,f,l){if(!a)return c=this.ji,f=b[this.ji],{WXf:c,pXf:f,qXf:0};f=0;if(0<a){for(c=this.ji;f<=a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.ji+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{WXf:c,pXf:f,qXf:l}}gcb(a,b){if(b!==a){var c=this.L_i(b-1);for(let f=this.dda;f<=this.abb;f++){const l=this.Ud.ef(f,b),x=this.Ud.ef(f,a);this.lse(c[f],l,x)}}}lse(a,b,c){if(c.isGhostCell){var f=b.rowSpan,l=a.colSpan+c.li-b.li,x=a.colSpan+b.colSpan-l;zm.c(Object(va.a)(ag.a,b),Object(va.a)(ag.a,c),
this.$r.nLd);zm.c(Object(va.a)(ag.a,b),Object(va.a)(ag.a,c),[ub.a.oHa]);var F=mb.GraphIterator.mb(c);F.Ze();var R=new mb.GraphIterator;R.set(Object(va.a)(ag.a,b));R.zb(1)&&zm.h(F,null,1,1,R,-1);c.isGhostCell=b.isGhostCell;this.BVd(F);b.Nn(ub.a.rowSpan,ub.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=x,c.rowSpan=f);a.rowIndex===c.rowIndex&&(a.colSpan=l)}}BVd(a){const b=a.currentNode.getValue(ub.a.rowId),c=a.currentNode.getValue(ub.a.cellId);for(a=wi.a.Ju(a);a.moveNext();){const f=a.currentNode.sa(ub.a.cellId,
null);a.currentNode.sa(ub.a.rowId,null)&&a.currentNode.setValue(ub.a.rowId,b);f&&a.currentNode.setValue(ub.a.cellId,c)}}Lfl(a,b,c){var f=mb.GraphIterator.mb(this.Ud);Dd.moveToFirstRow(f);f.Jp(a,1);this.$r.a6d(f);if(f=this.Ud.sa(bb.a.uu,null))f=Pa.a.clone(f),b<this.RBa(this.Ud,a)?(b=this.RBa(this.Ud,a),c=f[a]-b):(c=Math.max(c,this.RBa(this.Ud,a+1)),b=f[a]-c),f[a]=b,f[a+1]=c,this.Ud.setValue(bb.a.uu,f);b=this.ji+1;a+=1;a<=b&&(b+=1);this.gcb(a,b)}L_i(a){const b=Array(this.sc.$j(this.Ud));for(let c=this.dda;c<=
this.abb;c++){const f=this.Ud.ef(c,a);b[c]=f.oy()}return b}mKe(){return!!this.Ud&&this.Ud.lp()&&!this.T$&&this.ji<this.MF-1}}Object(e.a)(lL,"PowerPointColumnDragAdapter",fL.a,[]);class JD{constructor(a,b){this.Xw=this.V3=null;this.T9b=this.uab=0;this.Ozb=!1;this.z8=a;this.RZ=b}Wu(a){if(3===a.Vf)return!1;a=a.Fc;return Il.iSa(a)||Il.W4b(a)}Nt(){if(this.Ozb){const a=new We.GraphTransaction(3);a.fd(this.V3.$a);this.V3.source.Vu(4,!0);a.dispose()}this.end()}end(){this.z8.TQ()}dispose(){this.V3=null}}Object(e.a)(JD,
"CommonRowHandleDragAdapter",null,[239,106]);class mL extends JD{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){super(a,b);this.qke=this.eyb=!1;this.BLg=this.WEa=0;this.oka=this.Ud=this.Pd=this.Vta=this.FLg=this.DLg=this.zLg=this.CLg=this.ALg=null;this.LLg=this.Le=this.zNg=this.yNg=this.K3=this.J3=this.zFa=this.q_=this.Mz=0;this.f9=f;this.wq=c;this.Dk=l;this.Q$a=x;this.$r=F;this.sc=R;this.ra=fa;this.Qz=wa;this.a9j=Xa;this.ia=Lb;this.vp=kc;this.fVa=null;this.Z8b=this.MZc=this.BZc=!1;this.Tq=lb}su(a){if(!this.Wu(a))return!1;
const b=a.Fc;if(Il.W4b(b)){ya.a.J(512497178,816,50,"drag from table row handle");this.Ozb=!1;var c=Il.Iej(b);if(!c)return!1;this.Ud=Sc.a(c).$a;this.Xw=this.Ud.oc(this.Le);if(!this.Xw)return ya.a.J(512497177,816,10,"OnDragStart : m_tableViewElement is null"),!1;this.LLg=this.Tq.f_d(this.Xw,a.clientPoint);this.RZ.M9c(b);return!0}this.V3=Il.Gaj(b);if(!this.V3)return!1;c=Object(va.a)(153,this.V3.$a);this.Le=this.V3.Ma;this.Ud=c?c.getContainingTable():null;if(!this.Ud)return!1;this.Xw=this.Ud.oc(this.Le);
this.fVa=this.a9j.OZd(this.Ud);if(!this.Xw||!this.fVa)return!1;this.eyb=Il.A8d(b);this.qke=Il.k9d(b);this.uab=this.V3.htmlElement.offsetHeight;this.T9b=this.WEa=a.clientPoint.y;this.RZ.Pk(21);this.z8.endEditing(!0,14);this.Pd=this.Xw.pk;this.MZc=this.BZc=this.Z8b=!1;this.Ozb=!0;this.nKe()&&this.Oaj(b);this.yKd(b);this.vp&&this.ia.processAction(C.a.Tha,2);return!0}aw(a){this.Ozb?(this.WEa=a.clientPoint.y,a=(this.AKf(this.WEa)-this.uab)*(this.eyb?-1:1)+this.BLg,this.Vta.style.top=a+"px"):(a=this.Tq.f_d(this.Xw,
a.clientPoint),this.Xw.Uih(this.LLg,a));return!0}Ln(a){let b=null;a&&(b=this.f9.wi("UserAction","PPTRowResize"),ya.a.J(512497175,822,50,String.format("Start Row resize for table: {0}, IsComplex: {1}",this.Xw.$a.sa(ub.a.hBb,""),this.Xw.$a.lp())));if(this.Ozb){var c=this.AKf(a?a.clientPoint.y:this.WEa),f=new We.GraphTransaction(15);if(this.nKe()&&this.Z8b&&this.MZc)N.a.mark(11077),f.fd(this.Ud),this.gJe(c);else{this.V3.xGb(c);var l=this.V3.htmlElement.offsetHeight;N.a.mark(11077);var x=this.V3.$a;f.fd(x);
c=this.z8.Cd;x.setValue(ub.a.Rt,c.Ef(l,1));this.eyb&&l!==this.uab&&(l=this.uab-l)&&(this.Pd.setPosition(this.Pd.x,this.Pd.y+l,!0),l=c.Ef(this.Pd.x,0),c=c.Ef(this.Pd.y,1),x=this.Xw.pk.shapeNode,x.My=l,x.Ny=c)}this.Cmc();f.dispose();Gb.App.Fb.updateCommandUI();N.a.mark(11078);this.end();this.Ud?this.$r.UWa(this.Ud):ya.a.J(512497174,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");b&&b.stop();a&&ya.a.J(512497173,822,50,String.format("End Row resize for table: {0}, IsComplex: {1}",
this.Xw.$a.sa(ub.a.hBb,""),this.Xw.$a.lp()))}else a&&Gb.App.Fb.Q4(a.clientPoint,a.Vf),this.RZ.U_()}Nt(a){a.QQe?(super.Nt(a),this.Ozb&&this.Cmc()):this.Ln(null)}end(){this.RZ.U_();super.end()}AKf(a){a=this.uab+this.wq.qn(a-this.T9b)*(this.eyb?-1:1);if(this.nKe()&&this.Z8b&&this.MZc)a=Math.min(a,this.uab+this.zNg),a=Math.max(a,this.uab-this.yNg);else{var b=this.Dk.XBc(this.V3.$a);b=this.V3.Fd.Cd.Ge(b,1);a=Math.max(b,a)}return a}yKd(a){this.Vta=a;Sys.UI.DomElement.addCssClass(this.Vta,"ShowDashedLine");
this.BLg=a.offsetTop;this.FLg=a.style.marginTop;this.DLg=a.style.width;this.ALg=a.style.left;this.CLg=a.style.top;this.zLg=a.style.bottom;a.style.marginTop="auto";a.style.width="auto";a.style.right=a.style.left="0";a.style.bottom="auto";if(this.Q$a){const b=pn.a.G0b(a);b&&(a.style.left=-b.offsetLeft+"px",a.style.right=-(this.V3.getBounds().width-b.offsetLeft-b.offsetWidth)+"px")}}Cmc(){Sys.UI.DomElement.removeCssClass(this.Vta,"ShowDashedLine");this.Vta.style.marginTop=this.FLg;this.Vta.style.width=
this.DLg;this.Vta.style.left=this.ALg;this.Vta.style.right="auto";this.Vta.style.top=this.CLg;this.Vta.style.bottom=this.zLg}Oaj(a){this.Z8b=this.BZc=!1;if(this.Ud&&Il.iSa(a)){var b=null,c=null;({y2a:b,j3a:c}=this.Naj(a,b,c)).returnValue&&this.K_i(b,c)&&this.d0d()&&(a=this.sc.ui(this.Ud),b=this.sc.$j(this.Ud),0<=this.q_&&this.q_<a&&0<=this.zFa&&this.zFa<a&&0<=this.J3&&this.J3<b&&0<=this.K3&&this.K3<b&&(this.Z8b=!0),this.MZc=0<this.q_||this.zFa<a-1?!0:!1)}}Naj(a,b,c){if(!Il.iSa(a)||!this.Ud)return{returnValue:!1,
y2a:b,j3a:c};a=pn.a.G0b(a);a=Sc.a(a);this.oka=Object(va.a)(Xl.TableCellNode,a.$a);if(!this.oka)return{returnValue:!1,y2a:b,j3a:c};a=this.Mz=this.oka.rowIndex-1;if(0>a||a>=this.sc.$j(this.Ud))return{returnValue:!1,y2a:b,j3a:c};const f=this.oka.li;if(0>f||f>=this.sc.ui(this.Ud))return{returnValue:!1,y2a:b,j3a:c};if(this.eyb)return{returnValue:!1,y2a:null,j3a:c};b=this.Ud.ef(a,f);if(this.qke)return{returnValue:!1,y2a:b,j3a:null};c=this.Ud.ef(a+1,f);return{returnValue:!0,y2a:b,j3a:c}}K_i(a,b){if(!this.Ud||
!a||!b)return!1;this.q_=a.li;if(0>this.q_||this.q_>=this.sc.ui(this.Ud))return!1;this.zFa=this.q_;var c=a.oy();this.J3=c?c.rowIndex:-1;if(0>this.J3||this.J3>=this.sc.$j(this.Ud))return!1;this.K3=this.sZd(b);if(0>this.K3||this.K3>=this.sc.$j(this.Ud))return!1;a=(c=this.L5i(a,b))?this.vaj(a,b):!1;if(a=c&&a)this.BZc=this.SEj(b.rowIndex);return a}d0d(){if(!this.Ud)return!1;const a=this.sc.$j(this.Ud);if(0>this.J3||this.J3>=a||0>this.K3||this.K3>=a)return!1;this.yNg=this.cZd(this.Ud,this.J3,this.Mz)-this.$Pa(this.Ud,
this.J3);this.zNg=this.cZd(this.Ud,this.K3,this.Mz+1)-this.$Pa(this.Ud,this.K3);return!0}L5i(a,b){if(!a||!b)return!1;a=a.X5a();const c=b.rowIndex;for(b=b.X5a();b&&a;){var f=b.oy();if(b.isGhostCell&&f&&f.rowIndex!==c)break;this.q_--;if(f=a.oy())this.J3=Math.max(this.J3,f.rowIndex);this.K3=Math.min(this.K3,this.sZd(b));a=a.X5a();b=b.X5a()}return!0}vaj(a,b){if(!a||!b)return!1;a=a.jZ();const c=b.rowIndex;for(b=b.jZ();b&&(!b.isGhostCell||b.oy().rowIndex===c);)this.zFa++,this.J3=Math.max(this.J3,a.oy().rowIndex),
this.K3=Math.min(this.K3,this.sZd(b)),a=a.jZ(),b=b.jZ();return!0}SEj(a){let b=!0,c;if(0<this.q_)for((c=this.Ud.ef(a,this.q_))&&(c=c.X5a());c;){if(!c.isGhostCell){b=!1;break}c=c.X5a()}if(this.zFa<this.Ud.F6-1)for((c=this.Ud.ef(a,this.zFa))&&(c=c.jZ());c;){if(!c.isGhostCell){b=!1;break}c=c.jZ()}return b}sZd(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.oy());return b&&(b=b.rZd(1))?b.rowIndex:-1}cZd(a,b,c){if(b>c)return this.cZd(a,c,b);if(!a||0>b||b>=this.sc.$j(a)||0>c||c>=this.sc.$j(a))return-1;for(a=
0;b<=c;b++)a+=this.fVa[b];return Math.floor(a)}$Pa(a,b){a=this.Dk.DKd(a,b);return Math.floor(this.z8.Cd.Ge(a,1))}gJe(a){if(!this.ra.uG()){var b=this.oka.g_b().oy().mZb;b=nd.SelectionFactory.Jg(Object(va.a)(ag.a,b),0);this.ra.setSelection(b)}let c=b=-1;var f=-1;({XXf:b,nXf:c,oXf:f}=this.S1i(a-this.fVa[this.Mz],this.fVa,b,c,f));if(this.BZc&&(b===this.Mz&&Math.abs(c)>=this.$Pa(this.Ud,this.Mz)||b===this.Mz+1&&b<this.sc.$j(this.Ud)&&Math.abs(f)>=this.$Pa(this.Ud,this.Mz+1)||b===this.Mz+1&&b===this.sc.$j(this.Ud)-
1)){ya.a.J(512497172,815,50,"DragAcrossRow: scenario-1, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Mz.toString(),b.toString(),c.toString(),f.toString());f=mb.GraphIterator.mb(this.Ud);this.kcc(f,this.Mz);a=f.currentNode;var l=this.fVa[this.Mz];const F=a.oc(this.Le);Dd.moveToNextRow(f);f=f.currentNode;var x=this.fVa[this.Mz+1];const R=f.oc(this.Le);x=l+x;l=this.z8.Cd;b===this.Mz+1&&(c+=this.fVa[this.Mz]);F.xGb(Math.floor(c));b=F.htmlElement.offsetHeight;
a.setValue(ub.a.Rt,l.Ef(b,1));b=x-b;b=Math.max(b,this.$Pa(this.Ud,this.Mz+1));R.xGb(Math.floor(b));f.setValue(ub.a.Rt,l.Ef(R.htmlElement.offsetHeight,1))}else b>this.J3&&Math.abs(c)<this.$Pa(this.Ud,b)?(ya.a.J(512497171,815,50,"DragAcrossRow: scenario-2, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Mz.toString(),b.toString(),c.toString(),f.toString()),this.gcb(b,this.Mz+1)):b<this.K3&&Math.abs(f)<this.$Pa(this.Ud,b+1)?(ya.a.J(512497170,
815,50,"DragAcrossRow: scenario-3, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Mz.toString(),b.toString(),c.toString(),f.toString()),this.gcb(b+1,this.Mz+1)):(ya.a.J(512497169,815,50,"DragAcrossRow: scenario-4, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Mz.toString(),b.toString(),c.toString(),f.toString()),this.Mfl(b,c,f)),this.$r.DDe(this.Ud),b=mb.GraphIterator.mb(this.Ud),
this.$r.pSe(b),this.Ud.Uba(511),this.Qz.R2b(this.Ud)}S1i(a,b,c,f,l){if(!a)return c=this.Mz,f=b[this.Mz],{XXf:c,nXf:f,oXf:0};f=0;if(0<a){for(c=this.Mz;f<a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.Mz+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{XXf:c,nXf:f,oXf:l}}gcb(a,b){if(b!==a){var c=this.M_i(b-1);b=this.Ud.ef(b,this.q_);a=this.Ud.ef(a,this.q_);for(let f=this.q_;f<=this.zFa;f++)this.lse(c[f],b,a),b=b.jZ(),a=a.jZ()}}lse(a,b,c){if(c.isGhostCell){var f=b.colSpan,l=a.rowSpan+c.rowIndex-b.rowIndex,x=
a.rowSpan+b.rowSpan-l;zm.c(Object(va.a)(ag.a,b),Object(va.a)(ag.a,c),this.$r.nLd);zm.c(Object(va.a)(ag.a,b),Object(va.a)(ag.a,c),[ub.a.oHa]);var F=mb.GraphIterator.mb(c);F.Ze();var R=new mb.GraphIterator;R.set(Object(va.a)(ag.a,b));R.zb(1)&&zm.h(F,null,1,1,R,-1);c.isGhostCell=b.isGhostCell;this.BVd(F);b.Nn(ub.a.rowSpan,ub.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=f,c.rowSpan=x);a.li===F.hq.li&&(a.rowSpan=l)}}BVd(a){const b=a.currentNode.getValue(ub.a.rowId),c=a.currentNode.getValue(ub.a.cellId);
for(a=wi.a.Ju(a);a.moveNext();){const f=a.currentNode.sa(ub.a.cellId,null);a.currentNode.sa(ub.a.rowId,null)&&a.currentNode.setValue(ub.a.rowId,b);f&&a.currentNode.setValue(ub.a.cellId,c)}}Mfl(a,b,c){var f=mb.GraphIterator.mb(this.Ud);this.kcc(f,a);const l=f.currentNode;f=this.$r.b6d(f);const x=this.z8.Cd,F=l.oc(this.Le);F.xGb(Math.floor(b));l.setValue(ub.a.Rt,x.Ef(F.htmlElement.offsetHeight,1));c=Math.max(c,this.$Pa(this.Ud,a+1));f.setValue(ub.a.Rt,x.Ef(Math.floor(c),1));b=this.Mz+1;a+=1;a<=b&&(b+=
1);this.gcb(a,b)}kcc(a,b){if(!(14!==a.mi||0>b||b>=this.sc.$j(a.currentNode)))for(Dd.moveToFirstRow(a);0<b--;)Dd.moveToNextRow(a)}M_i(a){a=this.Ud.ef(a,this.q_);const b=Array(this.sc.ui(this.Ud));for(let c=this.q_;c<=this.zFa;c++)b[c]=a.oy(),a=a.jZ();return b}nKe(){return!!this.Ud&&this.Ud.lp()&&!this.eyb&&!this.qke}}Object(e.a)(mL,"PowerpointRowHandleDragAdapter",JD,[]);class KD{constructor(a,b,c,f){this.Qz=f;this.xEa=a;this.xEa.xk(Object(D.a)(this,this.xh,"onPropertyChanged"))}xh(a,b){a=b.property;
(b=Object(va.a)(125,b.node))&&(a===ub.a.colSpan||a===ub.a.rowSpan)&&(b=b.getContainingTable())&&(this.Qz.abk(b),b.PX=null)}dispose(){this.xEa.Tm(Object(D.a)(this,this.xh,"onPropertyChanged"))}}Object(e.a)(KD,"TableCellNodeBehavior",null,[106]);class nL extends Qb.a{constructor(a,b){super(a,b,"TableCellSelected")}NRg(a){this.selected&&!Sys.UI.DomElement.containsCssClass(a,this.EXa)?Sys.UI.DomElement.addCssClass(a,this.EXa):!this.selected&&Sys.UI.DomElement.containsCssClass(a,this.EXa)&&Sys.UI.DomElement.removeCssClass(a,
this.EXa)}}Object(e.a)(nL,"TableCellSelectionBehavior",Qb.a,[670,540]);class oL extends Sys.EventArgs{constructor(a){super();this.dWh=a}get tableCellNode(){return this.Gjl.tableCellNode}get Gjl(){return this.dWh}}Object(e.a)(oL,"TableCellViewElementLockedEventArgs",Sys.EventArgs,[]);class LD extends Sys.EventArgs{constructor(a){super();this.uCi=a}}Object(e.a)(LD,"TypingLockStatusChangedEventArgs",Sys.EventArgs,[]);var Yp=d(205);class Ss extends uv{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){super(a,
b,f,l,hb.a.instance.resolve("Box4.ITableCellReader"),hb.a.instance.resolve("Box4.IParagraphReader"),hb.a.instance.resolve("Box4.IOutlineElementNavigator"),hb.a.instance.resolve("Box4.ITableNavigator"),hb.a.instance.resolve("Box4.IOutlineElementReader"),hb.a.instance.resolve("Box4.Styles.IStyleReader"),hb.a.instance.pb("Box4.IFeatureHelper"),new nL(a,b),hb.a.instance.pb("Box4.Styles.ITableCellspacingReader"),hb.a.instance.resolve("Box4.TableCellViewElementSettings"));this.Rle=this.Sle=this.p3c=this.v3c=
this.vAb=this.wh=this.Hbb=this.tN=this.BN=this.r_=null;this.dka=!1;this.Ija=null;this.fj=Object(va.a)(125,b);this.Ea=c;this.Qz=x;this.Dk=F;this.Qc=R;this.YDa=fa;this.sc=wa;this.Q$a=Xa;this.pyb=lb;this.e_=Lb;this.q_c=kc;this.O8b=ee.a("PPTOEnableTableDiagonalBorders");this.ra=lc;this.Usa=this.X7f();(this.Q$a||this.pyb)&&Sys.UI.DomElement.addCssClass(this.htmlElement,"TableCellRelativePosition")}q5(){}cA(a){super.cA(a);this.Q$a&&!this.Fd.Bl&&this.R0k()}ABa(a,b){return a&&a.length&&"none"!==a&&b&&b.length&&
b.endsWith("px")?parseFloat(b.substr(0,b.length-2)):0}svg(){const a=this.ra.uXi(),b=this.fj.getContainingTable();return b?Array.contains(a,b):!1}SJk(a){switch(a){case "Top":this.wh.style.top="-0.5px";this.wh.style.borderTopWidth="1px";break;case "Right":this.wh.style.right="-0.5px";this.wh.style.borderRightWidth="1px";break;case "Bottom":this.wh.style.bottom="-0.5px";this.wh.style.borderBottomWidth="1px";break;case "Left":this.wh.style.left="-0.5px",this.wh.style.borderLeftWidth="1px"}}RJk(a){switch(a){case "Top":this.wh.style.top=
"0px";this.wh.style.borderTopWidth="0px";break;case "Right":this.wh.style.right="0px";this.wh.style.borderRightWidth="0px";break;case "Bottom":this.wh.style.bottom="0px";this.wh.style.borderBottomWidth="0px";break;case "Left":this.wh.style.left="0px",this.wh.style.borderLeftWidth="0px"}}Xbd(a){this.wh&&(this.svg()?this.SJk(a):this.RJk(a))}P0k(a,b,c){const f=!ee.a("TableBorderOutsideBorderHalfClippingDisabled");this.sTd();var l=mb.GraphIterator.mb(this.$a);l.mc(14);var x=l.Ng(14);l=this.sc.$j(x);x=
this.sc.ui(x);c=c?c.jU():"";switch(a){case "Top":b=this.Fd.Cd.Ge(b,1);!this.fj.rowIndex&&f?(this.wh.style.top="0px",this.wh.style.borderTopWidth=b/2+"px"):(this.wh.style.top=-b/2+"px",this.wh.style.borderTopWidth=b+"px");this.wh.style.borderTopColor=c;break;case "Bottom":b=this.Fd.Cd.Ge(b,1);this.fj.rowIndex+this.fj.rowSpan===l&&f?(this.wh.style.bottom="0px",this.wh.style.borderBottomWidth=b/2+"px"):(this.wh.style.bottom=-b/2+"px",this.wh.style.borderBottomWidth=b+"px");this.wh.style.borderBottomColor=
c;break;case "Left":b=this.Fd.Cd.Ge(b,0);!this.fj.li&&f?(this.wh.style.left="0px",this.wh.style.borderLeftWidth=b/2+"px"):(this.wh.style.left=-b/2+"px",this.wh.style.borderLeftWidth=b+"px");this.wh.style.borderLeftColor=c;break;case "Right":b=this.Fd.Cd.Ge(b,0);this.fj.li+this.fj.colSpan===x&&f?(this.wh.style.right="0px",this.wh.style.borderRightWidth=b/2+"px"):(this.wh.style.right=-b/2+"px",this.wh.style.borderRightWidth=b+"px");this.wh.style.borderRightColor=c;break;case "DiagonalUp":this.O8b&&
(b=this.Fd.Cd.Ge(b,0),this.gYf(a,b,c));break;case "DiagonalDown":this.O8b&&(b=this.Fd.Cd.Ge(b,0),this.fYf(a,b,c))}this.Nmh()}gYf(a,b,c){this.b_f();this.Sle||(this.Sle=this.DRf());this.ukh(this.Sle,a,b,c)}fYf(a,b,c){this.b_f();this.Rle||(this.Rle=this.DRf());this.ukh(this.Rle,a,b,c)}DRf(){const a=new Rl.a;this.v3c.appendChild(a.ya);this.Ho(a.ya);return a}ukh(a,b,c,f){b=this.rwi(b);a.a0(b);a.qv(f);a.zr(c)}rwi(a){switch(a){case "DiagonalUp":return String.format("M 0 {0} L {1} 0",this.wXd(),this.yXd());
case "DiagonalDown":return String.format("M 0 0 L {0} {1}",this.yXd(),this.wXd())}ya.a.J(571479943,822,10,"CreateDAttrib : Unknown borderType "+a);return null}b_f(){this.sTd();this.vAb||(this.vAb=this.Fd.Oo(ka.a.div),this.vAb.className="PPTTableDiagonalBorder",this.Hbb.appendChild(this.vAb),this.Ho(this.vAb));this.p3c||(this.p3c=new Zn.a,this.v3c=this.p3c.ya,this.vAb.appendChild(this.v3c),this.Ho(this.v3c));this.p3c.mwa(String.format("0 0 {0} {1}",this.yXd(),this.wXd()))}sTd(){this.Hbb||(this.Hbb=
this.Fd.Oo(ka.a.div),this.Hbb.className="PPTTableBorderContainer",this.htmlElement.insertBefore(this.Hbb,this.htmlElement.firstChild),this.Ho(this.Hbb));this.wh||(this.wh=this.Fd.Oo(ka.a.div),this.wh.className="PPTTableBorder",this.Hbb.appendChild(this.wh),this.Ho(this.wh))}Nmh(){this.q_c&&ee.a("MergeDifferentBordersFixEnabled")?this.wh.style.zIndex=this.Cvb(this.fj)?"1":(this.xRa(this.fj.Owa)||this.xRa(this.fj.Mea))&&(this.xRa(this.fj.Nwa)||this.xRa(this.fj.Nea))?"3":"2":this.wh.style.zIndex=(this.xRa(this.fj.Owa)||
this.xRa(this.fj.Mea))&&(this.xRa(this.fj.Nwa)||this.xRa(this.fj.Nea))?"1":"0"}Cvb(a){return 1<a.rowSpan||1<a.colSpan}FEj(a){return"DiagonalUp"===a||"DiagonalDown"===a}YHa(a,b,c,f){const l=this.q_c&&ee.a("MergeDifferentBordersFixEnabled")&&this.Cvb(this.fj);this.q_c&&!this.FEj(a)&&this.svg()&&0===b&&(b=1,c="rgb(255, 255, 255)");switch(a){case "Top":l&&!this.UBj()&&(b=0);this.wh.style.borderTopWidth=b+"px";this.wh.style.borderTopColor=c;this.wh.style.borderTopStyle=f;this.wh.style.top=-b/2+"px";break;
case "Right":l&&!this.TBj()&&(b=0);this.wh.style.borderRightWidth=b+"px";this.wh.style.borderRightColor=c;this.wh.style.borderRightStyle=f;this.wh.style.right=-b/2+"px";break;case "Bottom":l&&!this.OBj()&&(b=0);this.wh.style.borderBottomWidth=b+"px";this.wh.style.borderBottomColor=c;this.wh.style.borderBottomStyle=f;this.wh.style.bottom=-b/2+"px";break;case "Left":l&&!this.QBj()&&(b=0);this.wh.style.borderLeftWidth=b+"px";this.wh.style.borderLeftColor=c;this.wh.style.borderLeftStyle=f;this.wh.style.left=
-b/2+"px";break;case "DiagonalUp":this.O8b&&this.gYf(a,b,c);break;case "DiagonalDown":this.O8b&&this.fYf(a,b,c)}}yXd(){var a=0;for(let b=0;b<this.fj.colSpan;b++)a+=this.fj.getContainingTable().GXd[this.fj.li+b];a=this.Fd.Cd.Ge(a,0);return Math.round(100*a)/100}wXd(){var a=this.sc.VMc(this.fj.getContainingTable(),this.fj.rowIndex,this.fj.rowIndex+this.fj.rowSpan-1);let b=0;for(let c of a)Object(Fa.a)(153,c)?b+=c.sa(ub.a.Rt,0):ya.a.J(571479944,822,15,String.format("GetCellHeight : node {0} is not of the type ITableRowNode",
c));this.fj.marginTop+this.fj.marginBottom>b&&ya.a.J(559724693,822,15,String.format("GetCellHeight :: degenerate case : cell height : {0} is less than sum of margins top : {1}  and bottom : {2} ",b,this.fj.marginTop,this.fj.marginBottom));b=Math.max(b,this.fj.marginTop+this.fj.marginBottom);a=this.Fd.Cd.Ge(b,1);return Math.round(100*a)/100}UBj(){if(!this.fj.rowIndex)return!0;const a=this.fj.getContainingTable();if(!a)return!0;const b=this.fj.rowIndex-1;var c=this.fj.li;const f=c+this.fj.colSpan-1;
for(;c<=f;c++){const l=a.ef(b,c);if(l&&(l.isGhostCell||this.Cvb(l)))return!0}return!1}QBj(){if(!this.fj.li)return!0;const a=this.fj.getContainingTable();if(!a)return!0;const b=this.fj.li-1;var c=this.fj.rowIndex;const f=c+this.fj.rowSpan-1;for(;c<=f;c++){const l=a.ef(c,b);if(l&&(l.isGhostCell||this.Cvb(l)))return!0}return!1}TBj(){const a=this.fj.getContainingTable();if(!a||this.fj.li+this.fj.colSpan===this.sc.ui(a))return!0;const b=this.fj.li+this.fj.colSpan;var c=this.fj.rowIndex;const f=c+this.fj.rowSpan-
1;for(;c<=f;c++){const l=a.ef(c,b);if(l&&(l.isGhostCell||this.Cvb(l)))return!0}return!1}OBj(){const a=this.fj.getContainingTable();if(!a||this.fj.rowIndex+this.fj.rowSpan===this.sc.$j(a))return!0;const b=this.fj.rowIndex+this.fj.rowSpan;var c=this.fj.li;const f=c+this.fj.colSpan-1;for(;c<=f;c++){const l=a.ef(b,c);if(l&&(l.isGhostCell||this.Cvb(l)))return!0}return!1}R0k(){var a=!ee.a("TableBorderOutsideBorderHalfClippingDisabled");this.sTd();if(a){a=mb.GraphIterator.mb(this.$a);a.mc(14);var b=a.Ng(14);
a=this.sc.$j(b);b=this.sc.ui(b);var c=this.ABa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth);this.YHa("Left",c,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle);this.fj.li?this.wh.style.left=-c/2+"px":(this.wh.style.left="0px",this.wh.style.borderLeftWidth=c/2+"px");c=this.ABa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth);this.YHa("Right",c,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle);
this.fj.li+this.fj.colSpan===b?(this.wh.style.right="0px",this.wh.style.borderRightWidth=c/2+"px"):this.wh.style.right=-c/2+"px";b=this.ABa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth);this.YHa("Top",b,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle);this.fj.rowIndex?this.wh.style.top=-b/2+"px":(this.wh.style.top="0px",this.wh.style.borderTopWidth=b/2+"px");b=this.ABa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth);
this.YHa("Bottom",b,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.fj.rowIndex+this.fj.rowSpan===a?(this.wh.style.bottom="0px",this.wh.style.borderBottomWidth=b/2+"px"):this.wh.style.bottom=-b/2+"px"}else a=this.ABa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth),this.YHa("Left",a,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle),a=this.ABa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth),
this.YHa("Right",a,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle),a=this.ABa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth),this.YHa("Top",a,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle),a=this.ABa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth),this.YHa("Bottom",a,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.eYf();this.q_c&&this.Nmh();
this.htmlElement.style.border=""}eYf(){this.O8b&&(this.tfe&&this.tkh("DiagonalUp",this.tfe),this.sfe&&this.tkh("DiagonalDown",this.sfe))}xRa(a){return!!a}tkh(a,b){const c=b.split(" ");if(3!==c.length)ya.a.J(570832849,822,10,String.format("SetDiagonalBorderProps : split of string [ {0} ] has greater or less than 3 sub-parts",b));else{var f=c[0];b=this.ABa(b,c[1]);this.YHa(a,b,c[2],f)}}lnc(a,b,c,f,l,x,F){if(!this.e_||this.Ea.kn(this.fj).getValue(ub.a.isResizable))this.pyb?this.Rvl(l,x,F):this.Qvl(a,
b,c,f,l,x,F)}Rvl(a,b,c){this.$Da||(this.$Da=this.GEc(),this.Ho(this.$Da));this.r_||(this.r_=this.aOa(),this.Ho(this.r_));a?Sys.UI.DomElement.addCssClass(this.r_,"First"):Sys.UI.DomElement.removeCssClass(this.r_,"First");b^!!this.BN&&(b?(this.BN=this.aOa(),this.Ho(this.BN)):(this.vEb(this.BN),this.BN=null));this.BN&&Sys.UI.DomElement.addCssClass(this.BN,"Last");c^!!this.tN&&(c?(this.tN=this.GEc(),this.Ho(this.tN)):(this.vEb(this.tN),this.tN=null));this.tN&&Sys.UI.DomElement.addCssClass(this.tN,"FirstLeft")}Qvl(a,
b,c,f,l,x,F){super.lnc(a,b,c,f,l,x,F);this.Xob&&this.Ho(this.Xob);this.r_||(this.r_=this.aOa(),this.Ho(this.r_));this.r_.style.left=a+"px";this.r_.style.top=b+"px";this.r_.style.width=c+"px";l?Sys.UI.DomElement.addCssClass(this.r_,"First"):Sys.UI.DomElement.removeCssClass(this.r_,"First");x^!!this.BN&&(x?(this.BN=this.aOa(),this.Ho(this.BN)):(this.vEb(this.BN),this.BN=null));this.BN&&(this.BN.style.bottom="0",this.BN.style.left=a+"px",this.BN.style.width=c+"px",Sys.UI.DomElement.addCssClass(this.BN,
"Last"));F^!!this.tN&&(F?(this.tN=this.GEc(),this.Ho(this.tN)):(this.vEb(this.tN),this.tN=null));this.tN&&(this.tN.style.left="0",this.tN.style.top=b+"px",this.tN.style.height=f+"px",Sys.UI.DomElement.addCssClass(this.tN,"FirstLeft"));this.Q$a&&(this.r_.style.left="0",this.r_.style.top="0",this.Xob&&(this.Xob.style.left=c+"px",this.Xob.style.top="0",this.Xob.style.height=f+"px"),this.BN&&(this.BN.style.left="0"),this.tN&&(this.tN.style.top="0"))}gkh(){var a=this.Fd.Cd,b=a.Ge(this.Dk.bra(this.$a,3),
1);this.kha.style.paddingTop=b+"px";b=a.Ge(this.Dk.bra(this.$a,0),1);this.kha.style.paddingBottom=b+"px";b=a.Ge(this.Dk.bra(this.$a,1),0);this.kha.style.paddingLeft=b+"px";a=a.Ge(this.Dk.bra(this.$a,2),0);this.kha.style.paddingRight=a+"px"}T0k(a,b){const c=this.Fd.Cd;switch(b){case ba.a.zlc:a=c.sZ(a.marginTop,1);this.kha.style.paddingTop=a+"px";break;case ba.a.wlc:a=c.sZ(a.marginBottom,1);this.kha.style.paddingBottom=a+"px";break;case ba.a.xlc:a=c.sZ(a.marginLeft,0);this.kha.style.paddingLeft=a+"px";
break;case ba.a.ylc:a=c.sZ(a.marginRight,0),this.kha.style.paddingRight=a+"px"}}DT(){var a=this.Dk.bra(this.$a,1),b=this.Dk.bra(this.$a,2);const c=this.Dk.ZZb(this.$a,5),f=this.Dk.ZZb(this.$a,6);var l=this.Fd.Cd;a=l.Ge(a+c,0);b=l.Ge(b+f,0);l=l.Ge(this.Dk.vKf(this.$a),0);return new lf.a(a,l,b)}CAh(){this.htmlElement.style.background=this.Qz.l7f(this.$a)}uT(){if(!this.wh)super.uT();else if(!this.Fd.Bl&&this.zA){const a=Object(va.a)(670,this.JQ);a&&a.NRg(this.wh)}}aOa(){const a=this.KSf();a.className=
"TableRowResizeHandle";return a}vEb(a){L.a.tHa(a);Ba.a.fO(a)}get tableCellNode(){return this.fj}get vVc(){return this.Ija}get pk(){this.Usa||(this.Usa=this.X7f());return this.Usa}set pk(a){this.Usa=a}get Kp(){return this.dka}DGb(a){this.dka=a;this.tableCellNode.lub=a}lock(a){this.Kp&&this.Ija===a||(this.pk.Hid(),this.Ija=a,this.DGb(!0),this.Qc.RD(new Yp.a(7)),this.YDa.u$g(new LD(a)),this.YDa.yGk(new oL(this)))}unlock(){this.Kp&&(this.Ija=null,this.DGb(!1),this.Qc.RD(new Yp.a(7)),this.YDa.u$g(new LD(null)))}X7f(){let a=
null;const b=this.Ea.kn(this.fj);b&&(a=Object(va.a)(124,b.Ag(this.Ma)));return a}}Object(e.a)(Ss,"TableCellViewElement",uv,[554,443,395,106]);var Lz=d(294),wQ=d(495);class hm extends Hh{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){super(a,b);Hh.S_a=()=>Vq.R0f(lh.a.create());this.Dk=c;this.zm=f;this.KI=x;this.hVa=l;this.sc=F;this.U3=R;this.eVa=fa;this.nyb=wa;this.Le=Xa;this.LZc=ee.a("PPTOEnableTableDiagonalBorders")}iNf(a,b){Hh.ymi(a,b,xd.TableReader.ui(a))}NSf(a,b,c,f=null,l=!1){const x=a.parentNode.getValue(ub.a.shapeId);
a.currentNode.setValue(ub.a.shapeId,x);for(var F=0;F<b;++F){var R=new wQ.a;a.hl(R,1);R.setValue(ub.a.shapeId,x);R.setValue(ub.a.rowId,lh.a.create())}b=null;F=!0;a.zb(1);do{R=a.currentNode.getValue(ub.a.rowId);for(let fa=0;fa<c;++fa){const wa=this.gqa();a.hl(wa,1);wa.setValue(ub.a.shapeId,x);wa.setValue(ub.a.rowId,R);wa.setValue(ub.a.cellId,lh.a.create());({yih:b,isFirst:F}=this.k3f(a,wa,l,f,b,F));Dd.returnToContainingRow(a)}}while(a.wj(1))}UWa(a){if(this.LZc&&a&&(a=this.sc.UE(a)))for(const b of a)b&&
!b.isGhostCell&&(a=Object(va.a)(Ss,b.oc(this.Le)))&&a.eYf()}cFe(a,b,c,f,l){var x=this.KI.RKc(a);for(var F=0;F<x.length;F++){const R=this.Dk.job(a,F);x[F]=Math.max(R,x[F]*b)}a.setValue(bb.a.uu,x);if(1!==c)for((new mb.GraphIterator).set(a),b=a?a.firstRow:null,c=0;b;){x=l.Ef(f.Caj(c),1);F=this.Dk.DKd(a,c);x<=F&&(x=0);b.setValue(ub.a.Rt,x);if(b.iug())break;else b=b.pGa;c++}this.UWa(a)}O0k(a,b){a=this.sc.UE(a);for(let c=0;c<a.length;c++){const f=a[c].cellShading;f.anchorField=b;a[c].cellShading=f;a[c].Wma=
b}}N0k(a,b){for(let f=0;f<a.length;f++){const l=a.ga(f);for(let x=0;x<l.length;x++){var c=l.ga(x).iterator;c.mc(16);c.Ng(16);c=c.hq;const F=c.cellShading;F.anchorField=b;c.cellShading=F;c.Wma=b}}}M2b(a,b,c,f,l){super.M2b(a,b,c,f,l);c=[];Array.add(c,ub.a.Rt);zm.b(f,b,c);c=a.currentNode.getValue(ub.a.shapeId);const x=a.hq.getValue(ub.a.sid);a=a.hq.getValue(ub.a.cid);const F=Vq.HQf(lh.a.create());b.setValue(ub.a.sid,x);b.setValue(ub.a.cid,a);b.setValue(ub.a.shapeId,c);b.setValue(ub.a.rowId,F);this.$vl(f,
b,l)}D2b(a,b,c,f,l){super.D2b(a,b,c,f,l);return this.A6c(a.currentNode,b,c,f,!1,!1)}xSb(a,b,c,f,l){super.xSb(a,b,c,f,l);return this.A6c(a.currentNode,b,c,f,l,!1)}get nLd(){if(!hm.U9){hm.U9=[];let a,b,c;for(const f of hm.AWc)if(this.LZc||2!==f&&1!==f)({nNa:b,k3a:a,Pnb:c}=Xp.jQa(f)),Array.add(hm.U9,b),Array.add(hm.U9,a),Array.add(hm.U9,c);Array.add(hm.U9,bb.a.PD);Array.add(hm.U9,ub.a.cellShading);Array.add(hm.U9,Bb.a.YHb);Array.add(hm.U9,Bb.a.$Hb);Array.add(hm.U9,Bb.a.aIb);Array.add(hm.U9,Bb.a.XHb);
Array.add(hm.U9,ub.a.UQ)}return hm.U9}A6c(a,b,c,f,l,x){c=x?this.Olj(b,c,l):this.Plj(b,c,f,l);zm.c(c,b,this.nLd);f=a.getValue(ub.a.sid);x=a.getValue(ub.a.cid);const F=a.getValue(ub.a.shapeId),R=c.getValue(ub.a.cellId);a=a.getValue(ub.a.rowId);b.setValue(ub.a.sid,f);b.setValue(ub.a.cid,x);b.setValue(ub.a.shapeId,F);b.setValue(ub.a.rowId,a);l?b.setValue(ub.a.cellId,R):b.setValue(ub.a.cellId,b.id.lq);return c}WDf(a,b,c,f,l,x){a=a.currentNode;const F=Array(c);let R=0,fa=0,wa=0;for(;R<f;R++)F[R]=b[R],fa+=
F[R];for(l=l?b[f]:b[f-1];R<f+x;R++)F[R]=l,wa+=F[R];for(;R<c;R++)F[R]=b[R-x],fa+=F[R];b=fa/(wa+fa);for(R=0;R<c;R++)F[R]=Math.max(F[R]*b,this.Dk.job(a,R));return F}bdc(a,b,c,f,l){super.bdc(a,b,c,f,l);var x=a.getValue(ub.a.Rgb);l=Array(x.length+f);let F=0;for(;F<b;F++)l[F]=x[F];for(;F<b+f;F++)l[F]=hm.zyi();for(;F<l.length;F++)l[F]=x[F-f];a.setValue(ub.a.Rgb,l);x=c?l[b+f]:l[b-1];a=Object(va.a)(Lz.TableNode,a);this.ptl(a,x,l.slice(b,f+b),b,c);if(this.nyb)for(l=this.eVa.create(a),f=b+f,x=(!c||!b)&&b<this.sc.ui(a)-
1,b+=c?1:0,f+=c?1:0,c=b;c<f;c++)this.U3.DVd(a,l,c,0,this.sc.$j(a),x)}rve(a,b,c,f){super.rve(a,b,c,f);if(this.nyb){a=Object(va.a)(179,a);const l=this.eVa.create(a);f=c+f;const x=(!b||!c)&&c<this.sc.$j(a)-1;c+=b?1:0;f+=b?1:0;for(b=c;b<f;b++)this.U3.CVd(a,l,b,0,this.sc.ui(a),x)}}Mue(a,b,c){super.Mue(a,b,c);this.pJb(a,ub.a.complexTable);this.nyb&&(a=Object(va.a)(179,a.currentNode),c=this.eVa.create(a),this.U3.CVd(a,c,b,0,this.sc.ui(a),!0))}Lue(a,b,c){super.Lue(a,b,c);const f=a.currentNode.getValue(ub.a.Rgb),
l=Array(f.length-c);let x=0;for(;x<b;x++)l[x]=f[x];for(;x<l.length;x++)l[x]=f[x+c];a.currentNode.setValue(ub.a.Rgb,l);this.pJb(a,ub.a.complexTable);this.nyb&&(a=Object(va.a)(179,a.currentNode),c=this.eVa.create(a),this.U3.DVd(a,c,b,0,this.sc.$j(a),!0))}$vl(a,b,c){a=a.getValue(ub.a.rowId);b.setValue(ub.a.wJk,a);b.setValue(ub.a.insertBefore,c)}ptl(a,b,c,f,l){a=a.firstRow;do for(let x=0;x<c.length;++x){const F=mb.GraphIterator.mb(a),R=F.Jp(f+x,1);R.setValue(ub.a.vJk,b);R.setValue(ub.a.insertBefore,l);
R.setValue(ub.a.cellId,c[x]);hm.Ilh(F,ub.a.cellId,c[x])}while(a=a.pGa)}gqa(){const a=super.gqa();a.isGhostCell=!0;a.rowSpan=1;a.colSpan=1;return a}tue(a,b){this.zkj(a,b,c=>{c.currentNode.isGhostCell=!1;Hh.ox.K2b(c,null,!0);const f=c.currentNode.getValue(ub.a.rowId),l=c.currentNode.getValue(ub.a.cellId);for(c=wi.a.Ju(c);c.moveNext();){const x=c.currentNode.sa(ub.a.cellId,null);c.currentNode.sa(ub.a.rowId,null)&&c.currentNode.setValue(ub.a.rowId,f);x&&c.currentNode.setValue(ub.a.cellId,l)}})}pcd(a){xd.TableReader.ju(a.currentNode)&&
this.Kbh(a,b=>b.Sh(ub.a.Rt),(b,c)=>{b.ke(ub.a.Rt,c)},ub.a.complexTable)}DDe(a){a&&(a=mb.GraphIterator.mb(a),this.pcd(a,0))}jwa(a,b){if(a)for(a=this.zm.cqa(a),a.Jl(c=>15===c.mi,null);a.moveNext();){const c=Object(va.a)(153,a.iterator.currentNode),f=this.hVa.l6a(c);c.setValue(ub.a.Rt,f*b)}}aYa(a,b){if(a&&14===a.type){const c=this.KI.RKc(a);for(let f=0;f<c.length;f++){const l=this.Dk.job(a,f);c[f]=Math.max(l,c[f]*b)}a.setValue(bb.a.uu,c)}}smh(a,b){if(a&&0<a.length)for(const c of a)c.setValue(ub.a.Rt,
je.a.DV(b))}rmh(a,b,c){if(a&&b&&0<b.length){const f=this.KI.RKc(a);for(let l=0;l<b.length;l++)f[b[l]]=je.a.DV(c);a.setValue(bb.a.uu,f)}}b6d(a){const b=new mb.GraphIterator;b.Nc(a);var c=b.currentNode;b.zb(1);const f=a.uc();this.oxa(a);const l=rs.a.instance.createInstance(393251);this.M2b(a,l,c,c,!1);a.Ak(l);c=this.sc.ui(f);for(let x=0;x<c;++x){const F=this.gqa();super.xSb(a,F,b.currentNode,!1,!0);this.A6c(l,F,b.currentNode,!1,!0,!0);b.uf(1)}this.iGb(f,this.sc.$j(f)+1);return a.currentNode}a6d(a){const b=
mb.GraphIterator.mb(a.KCh());let c=this.sc.ui(b.currentNode);var f=this.KI.QKc(Object(va.a)(125,a.currentNode));a=f+1;this.oxa(b);b.zb(1);do{const l=b.Jp(f,1);b.uc();const x=this.gqa();super.D2b(b,x,l,!1,!1);this.A6c(b.currentNode,x,l,!1,!1,!0)}while(b.wj(1));(f=b.currentNode.sa(bb.a.uu,null))&&(f=Pa.a.clone(f));this.TFb(b.currentNode,++c);f&&(Array.insert(f,a,0),b.currentNode.setValue(bb.a.uu,f));this.bdc(b.currentNode,a,!1,1,null)}pSe(a){this.pJb(a,ub.a.complexTable)}Olj(a,b,c){let f=b;const l=
b.kGa;if(l)if(b.isGhostCell)Hh.vMc(l,!c)||Hh.pfb(l.controlCell,c,Hh.Drb(l.controlCell,c)+1);else{let x=Hh.Drb(b,c);1<x&&(f=Hh.d3i(l,!c));Hh.pfb(b,c,x+1)}else Hh.pfb(b,c,2);a.isGhostCell=!0;return f}static Ilh(a,b,c){a.currentNode.ke(b,c);let f=a.Ji();if(f){for(;f;)hm.Ilh(a,b,c),f=a.jp();a.uc()}}static zyi(){return Vq.HQf(lh.a.create())}}hm.U9=null;hm.AWc=[5,6,7,0,2,1];Object(e.a)(hm,"TableEditor",Hh,[721]);const pL=(a,b,c,f,l)=>{const x=l.wX,F=l.Spa;var R=l.tableLook;const fa=0<(R&32);l=0<(R&128);
const wa=0<(R&64),Xa=0<(R&256),lb=fa?1:0,Lb=l?1:0;R=a?a===x-c?wa?3:(a-lb)%2+lb:(a-lb)%2+lb:0;x-c||(R=fa?0:wa?3:(a-lb)%2+lb);a=b?b===F-f?Xa?3:(b-Lb)%2+Lb:(b-Lb)%2+Lb:0;F-f||(a=l?0:Xa?3:(b-Lb)%2+Lb);return{jKf:R,hKf:a}};class MD{constructor(a){this.x_=a;this.d0c=Array(4);for(a=0;4>a;a++)this.d0c[a]=Array(4)}W6f(a,b,c,f){let l,x;({jKf:l,hKf:x}=pL(a,b,c,f,this.x_));if(!this.d0c[l][x]){c=Object.assign(new hr.a,{Yd:b,Jf:b+f,ge:a,Wf:a+c});a=this.d0c[l];b=x;f=this.x_;var F=f.tableStyle,R=new rr;R.latinField=
Je.Bpb(1,0);R.eaField=Je.Bpb(1,1);R.csField=Je.Bpb(1,2);R.solidFillField=Object.assign(new zh.a,{schemeClrField:Object.assign(new Nl.a,{valField:1})});F&&(new TK(R)).u1(f,c);c=R;F=f.eTj;f=new Kx;F=F||new QK;for(R=1;9>=R;R++){var fa=UK(F,R);const wa=R-1;f.kxe[wa]=fa?fe.a(fe.c(fa)):new gn;fa=f.kxe[wa].defRPrField;f.Gob[wa]=fa?fe.a(fe.c(fa)):new rr}for(F=1;9>=F;F++)VK(f.Gob[F-1],c);a[b]=f}return this.d0c[l][x]}y8f(a,b,c,f,l){let x=Eb.a.pOa;a&&(b=this.W6f(b,c,f,l))&&b.Gob&&0<b.Gob.length&&(b=b.Gob[0])&&
(x=Cf.Box4ColorHelper.SEb(b,a));return x}}Object(e.a)(MD,"TableListStyleCache",null,[720]);class ND{constructor(a,b,c,f){this.xEa=a;this.NPg=b;this.xEa.xk(Object(D.a)(this,this.xh,"onPropertyChanged"));this.xEa.Iga(Object(D.a)(this,this.onConnected,"onConnected"));this.Le=c;this.kke=f}onConnected(a,b){a=Object(va.a)(179,b.node);this.NPg.xCh(a)}xh(a,b){a=b.property;b=Object(va.a)(179,b.node);a===bb.a.uu?this.NPg.xCh(b):a===bb.a.Qwa||a===bb.a.Oea||a===bb.a.pA?b.PX=null:!this.kke||a!==ub.a.TRa&&a!==
ub.a.isResizable&&a!==ub.a.EK||b.oc(this.Le).oTe()}dispose(){this.xEa.Tm(Object(D.a)(this,this.xh,"onPropertyChanged"));this.xEa.ima(Object(D.a)(this,this.onConnected,"onConnected"))}}Object(e.a)(ND,"TableNodeBehavior",null,[106]);var xQ=d(183);class wv{constructor(a,b,c,f,l,x,F,R){this.m_=this.kQ=this.pn=this.VEa=this.j_=this.x3c=this.qEa=null;this.zab=this.S0c=0;this.HLg=this.$9b=this.Pd=this.Xw=null;this.vN=a;this.ia=c;this.wq=f;this.$r=l;this.eC=x;this.f9=b;this.Pp=F;this.vp=R}$J(){this.m_=this.kQ=
this.pn=this.j_=this.VEa=null;null!==this.Pp&&this.Pp.Mva()}Wu(a){if(!a||a.Sz===Sys.UI.MouseButton.rightButton||this.vN.AZ)return!1;this.Pd=(this.Xw=Object(va.a)(624,this.eC.VH(a.Fc)))?this.Xw.pk:null;if(!this.Pd)return!1;this.qEa=this.Xw.Pli;if(!this.qEa)return!1;this.kQ=this.qEa.Ikg(a.Fc);if(!this.kQ)return!1;this.vp&&this.ia.processAction(C.a.Tha,2);return!0}su(a){if(!a||!this.Wu(a))return!1;this.x3c=this.Xw=this.eC.VH(this.qEa.ya);if(!this.Xw)return ya.a.J(8959070,808,10,"The draggable chrome should be owned by Box4 TableViewElement"),
!1;this.ia.processAction(ba.a.T3a,2);this.qEa.eD(!0);this.Pd.eD(!0);null!==this.Pp&&this.Pp.ewa(Ii.a.AHb);this.m_=this.x3c.B0b();this.S0c=this.wq.qn(ad.a.Rl(this.m_.ga(0),this.m_.ga(1)));this.zab=this.wq.qn(ad.a.Rl(this.m_.ga(0),this.m_.ga(3)));this.VEa=this.FQf(a.clientPoint);this.j_=new ad.a(0,0);this.pn=new Pd.a;this.HLg=new ad.a(this.Pd.x+this.S0c,this.Pd.y+this.zab);return!0}aw(a){if(!a)return!1;a=this.FQf(a.clientPoint);var b=ad.a.bU(a,this.VEa);this.j_=ad.a.add(this.j_,b);b=Zk.FKd(this.kQ,
this.m_,this.j_,!1,!1);this.pn=Object.assign(new Pd.a,{bottom:this.wq.qn(b.bottom),left:this.wq.qn(b.left),right:this.wq.qn(b.right),top:this.wq.qn(b.top)});let c;({AEh:b,EEh:c}=this.BKf());const f=new xQ.a;f.yaa(b,c);f.sB(this.pn.left,this.pn.top);this.qEa.Uq(f);this.VEa=a;return!0}Ln(a){let b=null;a&&(b=this.f9.wi("UserAction","PPTTableResize"),ya.a.J(19142416,822,50,String.format("Start Table resize for table: {0}, IsComplex: {1}",this.Xw.$a.sa(ub.a.hBb,""),xd.TableReader.ju(this.Xw.$a))));this.qEa.rz(!1);
({AEh:l,EEh:x}=this.BKf());this.Xw.vmh(l,x);this.tOe();const c=new We.GraphTransaction(15);c.fd(this.Xw.$a);var f=this.Xw.Fd.Cd;this.$r.cFe(Object(va.a)(Lz.TableNode,this.Xw.$a),l,x,this.x3c,f);if(wv.MCa(this.kQ)||wv.MCa(this.kQ,!0)){var l=this.Xw.pk.shapeNode;var x=f.Ef(this.Pd.x,0);f=f.Ef(this.Pd.y,1);l.My=x;l.Ny=f}this.Pd.rz(!1);c.dispose();this.$J();Gb.App.Fb.updateCommandUI();b&&b.stop();a&&ya.a.J(8959107,822,50,String.format("End Table resize for table: {0}, IsComplex: {1}",this.Xw.$a.sa(ub.a.hBb,
""),xd.TableReader.ju(this.Xw.$a)))}tOe(){var a=wv.MCa(this.kQ),b=wv.MCa(this.kQ,!0);if(a||b){b=this.x3c.B0b();a=this.wq.qn(b.Vb-b.Zb);b=this.wq.qn(b.Ub-b.fc);const c=this.HLg;c._x+=this.pn.right;c._y+=this.pn.bottom;this.Pd.setPosition(c.x-a,c.y-b,!0)}}Nt(){this.j_&&(this.qEa.rz(!0),this.qEa.Uq(null),this.Pd.rz(!0),this.$J())}BKf(){return{AEh:this.S0c?1+(this.pn.right-this.pn.left)/this.S0c:1,EEh:this.zab?1+(this.pn.bottom-this.pn.top)/this.zab:1}}FQf(a){a=ad.a.APa(a);var b=this.kQ;this.kQ.n3b()||
(b=b.ksb());const c=this.m_.Zj(b);b=this.m_.Zj(b.w5a());return a=new ad.a(c.x<=b.x?Math.min(a.x,b.x):Math.max(a.x,b.x),c.y<=b.y?Math.min(a.y,b.y):Math.max(a.y,b.y))}static MCa(a,b=!1){return a.equals(Kd.a.qu)?!0:b?a.equals(Kd.a.north)||a.equals(Kd.a.ND):a.equals(Kd.a.west)||a.equals(Kd.a.fH)}}Object(e.a)(wv,"TableResizeDragAdapter",null,[239]);class OD{constructor(a,b){this.x_=a;this.xAb=b;this.Zh=Array(4);for(a=0;4>a;a++)this.Zh[a]=Array(4);this.bre=Array(16)}uXd(a,b,c,f){let l,x;({jKf:l,hKf:x}=
pL(a,b,c,f,this.x_));this.Zh[l][x]||(this.Zh[l][x]=this.xAb.XTk(this.x_,a,b,c,f));c=this.Zh[l][x].clone();if(a=this.vhj(a,b))for(const F of a.Bz())c.Sa(F)||c.ke(F,a.Sh(F));return c}clear(){for(let a=0;4>a;a++)this.Zh[a]=Array(4);this.bre=Array(16)}vhj(a,b){var c=a===this.x_.wX-1;const f=b===this.x_.Spa-1;let l=0;a||(l|=8);!b&&(l|=4);c&&(l|=2);f&&(l|=1);(c=this.bre[l])||(this.bre[l]=c=this.xAb.oUk(this.x_,a,b));return c}}Object(e.a)(OD,"TableStyleCache",null,[719]);class qL{constructor(a){this.gUa=
a}XTk(a,b,c,f,l){const x=a.wX;var F=a.Spa,R=a.tableLook;const fa=a.tableStyle;a=a.Se;const wa=new nq.a,Xa=0<(R&32),lb=0<(R&128),Lb=!b&&Xa,kc=!c&&lb;f=b===x-f&&0<(R&64);l=c===F-l&&0<(R&256);F=!(R&512)&&!Lb&&!f;R=!(R&1024)&&!kc&&!l;this.pUk(fa.wholeTblField,wa);F&&this.Sva((Xa?1!==(b&1):b&1)?fa.band2HField:fa.band1HField,a,wa);R&&this.Sva((lb?1!==(c&1):c&1)?fa.band2VField:fa.band1VField,a,wa);l&&this.Sva(fa.lastColField,a,wa);kc&&this.Sva(fa.firstColField,a,wa);f&&(this.Sva(fa.lastRowField,a,wa),l&&
this.Sva(fa.seCellField,a,wa),kc&&this.Sva(fa.swCellField,a,wa));Lb&&(this.Sva(fa.firstRowField,a,wa),l&&this.Sva(fa.neCellField,a,wa),kc&&this.Sva(fa.nwCellField,a,wa));return wa}oUk(a,b,c){var f=a.wX;const l=a.Spa;var x=a.tableStyle;a=a.Se;const F=new nq.a;if(x&&0<=b&&b<f&&0<=c&&c<l){const R=!c;f=b===f-1;c=c===l-1;(x=x.wholeTblField)&&x.tcStyleField&&(x=x.tcStyleField.tcBdrField)&&(this.lXa(7,b?x.insideHField:x.topField,a,F),this.lXa(0,f?x.bottomField:x.insideHField,a,F),this.lXa(5,R?x.leftField:
x.insideVField,a,F),this.lXa(6,c?x.rightField:x.insideVField,a,F))}return F}Lfh(a,b,c){const f=new nq.a;this.Jfh(a,c,b,f);return f}pUk(a,b){a&&a.tcStyleField&&a.tcStyleField.fillField&&b.ke(ub.a.cellShading,a.tcStyleField.fillField)}Sva(a,b,c){a&&a.tcStyleField&&(a.tcStyleField.fillField&&c.ke(ub.a.cellShading,a.tcStyleField.fillField),a=a.tcStyleField.tcBdrField)&&(this.lXa(7,a.topField,b,c),this.lXa(0,a.bottomField,b,c),this.lXa(5,a.leftField,b,c),this.lXa(6,a.rightField,b,c))}lXa(a,b,c,f){b&&b.itemField&&
this.Jfh(a,b.itemField,c,f)}Jfh(a,b,c,f){let l;({nNa:l,k3a:a}=Xp.jQa(a));b.wFieldSpecified&&f.ke(l,je.a.LSd(b.wField));if(b.solidFillField)if(this.gUa)f.ke(a,b.solidFillField);else{if(b=Cf.Box4ColorHelper.REb(b.solidFillField,c))b=Cf.Box4ColorHelper.$ma(b),f.ke(a,b)}else b.noFillField&&(this.gUa&&ee.a("TableBordersLocalRenderingFix")?(b=Cf.Box4ColorHelper.s0({Color:"##T,0,0,0"}),f.ke(a,b),f.ke(l,0)):f.ke(a,Eb.a.pOa))}}Object(e.a)(qL,"TableStyleResolver",null,[329]);var rL=d(319),PD=d(190);class Mx{constructor(a,
b,c,f=null){this.Dua=!1;this.DA=this.Jn=this.vb=this.KDg=this.VQg=null;this.aC=[];this.Fl=this.IG=!1;this.t_=null;this.yo=this.K$a=!1;this.Fa=b;this.fMg=a;this.gd=f;this.XS=(this.HZc=c)?10:6;this.Soe=c?2:qf.a.$D}get visible(){return this.Dua}set visible(a){this.Dua!==a&&(this.Dua=a,this.Slh())}get ya(){return this.vb.viewport.ya}Mbi(a,b,c){this.VQg=a;this.KDg=c;this.$m();this.gd.ob(qa.a.click,this.ya,Object(D.a)(this,this.mVg,"notifySelectShapeByClick"));b.appendChild(this.vb.viewport);this.VQg.QX(this.ya,
!0);this.K$a=!0;this.setZIndex(2+hD.a.z$+1)}xzh(){this.K$a&&this.vb&&this.gd.xb(qa.a.click,this.ya,Object(D.a)(this,this.mVg,"notifySelectShapeByClick"));this.K$a=!1}setZIndex(a){this.K$a&&this.vb.uC(a)}$m(){this.vb||(this.vb=new PD.a,this.Jn=new Rl.a,this.Jn.BF(Kk.a.none),this.Jn.qv(qf.a.f0),this.Jn.zr(qf.a.$D),this.vb.Pk(Ii.a.aA),this.vb.appendChild(this.Jn),this.DA=new rk.a,this.zWb(this.DA),this.vb.appendChild(this.DA),this.vb.Qd(!1),this.vb.viewport.ya.setAttribute(Kk.a.cDb,Kk.a.none))}jm(){if(this.K$a){var a=
this.Jbj(this.KDg);this.IG?(this.t_&&this.t_.il(a),this.Jn.Qt(a.points)):(a=a.points,this.Jn.Qt(a),a=new td.a(a[0],a[1],a[2],a[3]));this.mX(a);this.vb.jm()}}zWb(a){for(let f=0;8>f;++f){var b="selectionHandle"+f;const l=new rk.a;l.ya.id=b;if(n.a.LIa){var c=new rL.a;c.ya.id=b;c.ya.setAttribute("class",Ul.a.cjd);c.setVisibility(!1);c.setPosition(-10,-10);c.yh(20,20);l.appendChild(c)}c=new rL.a;c.ya.id=b;c.ya.setAttribute("class",Ul.a.cjd);b=this.XS/2*-1;c.setPosition(b,b);c.yh(this.XS,this.XS);this.HZc&&
c.Vlh(this.XS/2,this.XS/2);c.BF("white");c.qv(qf.a.f0);c.zr(this.Soe);c.nmh();l.appendChild(c);l.Qk(1);this.aC[f]=l;a.appendChild(l)}}mX(a){for(let b=0;8>b;++b){const c=this.aC[b];c.Pk(Mx.Mic[b]);this.bIa(c,a.Zj(new Kd.a(b)))}}Jbj(a){return new td.a(new ad.a(0,0),new ad.a(a.offsetWidth,0),new ad.a(a.offsetWidth,a.offsetHeight),new ad.a(0,a.offsetHeight))}AF(a){this.yo||((this.IG=a)?(this.Jn.BF(qf.a.bYf),this.Jn.qv(qf.a.f0),this.Jn.zr(qf.a.$D),this.DA.Qd(!1),this.fMg.endEditing(!0,14)):(this.Jn.BF(Kk.a.none),
this.Jn.qv(qf.a.f0),this.Jn.zr(qf.a.$D),this.DA.Qd(!0),this.Fa.Bf(Nc.a.yg),this.fMg.TQ()))}dispose(){this.Fl||(this.xzh(),this.Jn=this.vb=null,Array.clear(this.aC),this.DA=null,this.K$a=!1,this.Fl=!0)}Ikg(a){if(!this.K$a)return null;for(let b=0;8>b;++b)if(this.aC[b].ya.id===a.id)return new Kd.a(b);return null}bIa(a,b){a.setPosition(b.x,b.y)}mVg(a){return this.Ikg(a.Fc)?!0:!1}eD(a){this.AF(!0,a)}rz(){this.AF(!1)}Uq(a){this.t_&&this.t_.clear();this.t_=a;this.jm()}Ux(a){this.yo=a;this.Slh()}Slh(){this.vb&&
this.vb.Qd(!this.yo&&this.Dua)}static kWb(a){return new Mx(a,hb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptChangeResizeHandleEnabled,u.AFrameworkApplication.Aa.Xx)}}Mx.Mic=[Ii.a.ENe,Ii.a.DNe,Ii.a.CNe,Ii.a.BNe,Ii.a.FNe,Ii.a.GNe,Ii.a.HNe,Ii.a.INe];Object(e.a)(Mx,"DraggablePandoraChromeView",null,[630]);class sL{}Object(e.a)(sL,"TableStyleCategoryInfo",null,[]);class sf{static dMi(){if(sf.Ug)return sf.Ug;sf.Ug=new Ic.a;
sf.Ug.$("No Style, No Grid",ResourceStrings.l_TableThemedStyle1);sf.Ug.$("Themed Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,1));sf.Ug.$("Themed Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,2));sf.Ug.$("Themed Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,3));sf.Ug.$("Themed Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,1,4));sf.Ug.$("Themed Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,5));sf.Ug.$("Themed Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,6));sf.Ug.$("No Style, Table Grid",ResourceStrings.l_TableThemedStyle2);sf.Ug.$("Themed Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,1));sf.Ug.$("Themed Style 2 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,2));sf.Ug.$("Themed Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,3));sf.Ug.$("Themed Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,4));sf.Ug.$("Themed Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,5));sf.Ug.$("Themed Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,2,6));sf.Ug.$("Light Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,1));sf.Ug.$("Light Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,1));sf.Ug.$("Light Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,2));sf.Ug.$("Light Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
1,3));sf.Ug.$("Light Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,4));sf.Ug.$("Light Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,5));sf.Ug.$("Light Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,6));sf.Ug.$("Light Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,2));sf.Ug.$("Light Style 2 - Accent 1",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,1));sf.Ug.$("Light Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,2));sf.Ug.$("Light Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,3));sf.Ug.$("Light Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,4));sf.Ug.$("Light Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleLight,2,5));sf.Ug.$("Light Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,6));sf.Ug.$("Light Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,3));sf.Ug.$("Light Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,1));sf.Ug.$("Light Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
3,2));sf.Ug.$("Light Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,3));sf.Ug.$("Light Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,4));sf.Ug.$("Light Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,5));sf.Ug.$("Light Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,6));sf.Ug.$("Medium Style 1",
String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,1));sf.Ug.$("Medium Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,1));sf.Ug.$("Medium Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,2));sf.Ug.$("Medium Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,3));sf.Ug.$("Medium Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,1,4));sf.Ug.$("Medium Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,5));sf.Ug.$("Medium Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,6));sf.Ug.$("Medium Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,2));sf.Ug.$("Medium Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
2,1));sf.Ug.$("Medium Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,2));sf.Ug.$("Medium Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,3));sf.Ug.$("Medium Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,4));sf.Ug.$("Medium Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,5));
sf.Ug.$("Medium Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,6));sf.Ug.$("Medium Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,3));sf.Ug.$("Medium Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,1));sf.Ug.$("Medium Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,2));sf.Ug.$("Medium Style 3 - Accent 3",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,3));sf.Ug.$("Medium Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,4));sf.Ug.$("Medium Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,5));sf.Ug.$("Medium Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,6));sf.Ug.$("Medium Style 4",String.format(ResourceStrings.l_TableStyleNoAccent,
ResourceStrings.l_TableStyleMedium,4));sf.Ug.$("Medium Style 4 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,1));sf.Ug.$("Medium Style 4 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,2));sf.Ug.$("Medium Style 4 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,3));sf.Ug.$("Medium Style 4 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
4,4));sf.Ug.$("Medium Style 4 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,5));sf.Ug.$("Medium Style 4 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,6));sf.Ug.$("Dark Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));sf.Ug.$("Dark Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,1));sf.Ug.$("Dark Style 1 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,2));sf.Ug.$("Dark Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,3));sf.Ug.$("Dark Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,4));sf.Ug.$("Dark Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,5));sf.Ug.$("Dark Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleDark,1,6));sf.Ug.$("Dark Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));sf.Ug.$("Dark Style 2 - Accent 1/Accent 2",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,1,2));sf.Ug.$("Dark Style 2 - Accent 3/Accent 4",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,2,3));sf.Ug.$("Dark Style 2 - Accent 5/Accent 6",String.format(ResourceStrings.l_TableStyleNameAccent,
ResourceStrings.l_TableStyleDark,2,4,5));return sf.Ug}static qeg(a){const b=sf.dMi();return b.Jb(a)?b.ga(a):a}}sf.Ug=null;Object(e.a)(sf,"TableStyleNameReader",null,[]);class tL{constructor(a){this.rFg=!1;this.Lwb=[];this.nje=new Me.a(0);this.$de=[];this.DNg=a}YZf(){this.rFg||(this.rFg=this.Svk())}Svk(){const a=this.DNg.instance?this.DNg.instance.akl:null;if(a&&a.tblStyleCategoriesField){let b=0;this.Lwb=[];this.nje=new Me.a(0);this.$de=[];for(let c=0;c<a.tblStyleCategoriesField.length;c++){const f=
a.tblStyleCategoriesField[c];if(f.tblStylesField&&0<f.tblStylesField.length){Array.add(this.$de,Object.assign(new sL,{id:f.idField,begin:b,end:b+f.tblStylesField.length-1}));for(let l=0;l<f.tblStylesField.length;l++){const x=f.tblStylesField[l],F=new E.DictionaryPropertySet,R=new ID(x,f.idField,l);F.ke(ub.a.tableStyle,R);this.Lwb.push(F);this.nje.$(x.styleIdField.toLowerCase(),b++)}}}return!0}return!1}VWd(){return this.Lwb}Jsb(a){return 0<=a&&a<this.Lwb.length?this.Lwb[a]:null}Qdj(a,b){let c=null;
for(const f of this.$de)if(f.id===a){c=f;break}return c&&(a=c.begin+b,a<=c.end)?this.Jsb(a):null}Zdj(a){return this.x0b(a).uua.styleIdField}$dj(a){return(a=this.x0b(a).uua.styleNameField)?ee.a("TableStyleNameLocalization")?sf.qeg(a):a:""}Tdj(a){return this.x0b(a).ADg}x0b(a){return a.Sh(ub.a.tableStyle)}peg(a){return(a=this.Qej(a))?a.Sh(ub.a.tableStyle):null}Qej(a){this.YZf();return this.Lwb[this.nje.ga(a.toLowerCase())]}}Object(e.a)(tL,"TableStyleGalleryManager",null,[330]);class uL{constructor(a,
b,c,f,l){this.LK=0;f||(f=Object.assign(new hr.a,{ge:0,Wf:c.$N,Yd:0,Jf:c.CQ}));this.hee=a;this.V8j=b;this.Qka=c;this.DD=f;this.Ez=new hr.a;this.LN=this.LK=-1;this.CYc=l}get hwg(){return-1===this.LN||-1===this.LK}moveNext(){this.hwg&&(this.LN=this.DD.ge,this.Ez.Jf=this.DD.Yd);for(;;){this.LK=this.Ez.Jf;if(this.LK>=this.DD.Jf&&(this.LK=this.DD.Yd,++this.LN>=this.DD.Wf))return this.reset(),!1;this.Ez=this.hee.QH(this.Qka,this.LN,this.LK);if(this.LN===this.DD.ge||this.LN===this.Ez.ge)if(!this.CYc||this.CYc.QEd(this))return!0}}Idk(){this.hwg&&
(this.LK=this.DD.Yd,this.Ez.Wf=this.DD.ge);for(;;){this.LN=this.Ez.Wf;if(this.LN>=this.DD.Wf&&(this.LN=this.DD.ge,++this.LK>=this.DD.Jf)){this.reset();break}this.Ez=this.hee.QH(this.Qka,this.LN,this.LK);if(this.LK===this.DD.Yd||this.LK===this.Ez.Yd)if(!this.CYc||this.CYc.QEd(this))break}}moveTo(a,b){this.Ez=this.hee.QH(this.Qka,a,b);if(!this.Ez.DOi(this.DD))return this.reset(),!1;this.LN=Math.min(Math.max(a,this.DD.ge),this.DD.Wf-1);this.LK=Math.min(Math.max(b,this.DD.Yd),this.DD.Jf-1);return!0}reset(){this.LN=
this.LK=-1}d_b(){return this.V8j.ef(this.Ez.ge,this.Ez.Yd)}}Object(e.a)(uL,"CellIterator",null,[650]);class vL{constructor(a){this.vq=a}bBa(a,b,c,f=null){return new uL(this.vq,a,b,c,f)}}Object(e.a)(vL,"CellIteratorFactory",null,[324]);class QD{constructor(a,b,c){this.vq=b;this.Qka=c;this.XB=this.vq.oIc(this.Qka,a.DD);this.b8=Array(this.XB.CQ*(this.XB.$N+1));this.LN=this.XB.ge;this.N9a=this.XB.Yd;this.Qwb=this.XB.Yd-1;this.xp=0;this.E5d(a)}E5d(a){const b=a.DD;for(;a.moveNext();){const f=a.Ez;for(let l=
f.Yd;l<f.Jf;l++){var c=this.zBa(f.ge,l);this.b8[c]=0!==this.b8[c]?2:l<b.Yd&&f.ge>b.ge?16:l>=b.Jf&&f.ge>b.ge?64:1;c=this.zBa(f.Wf,l);this.b8[c]=0!==this.b8[c]?2:l<b.Yd&&f.Wf<b.Wf?16:l>=b.Jf&&f.Wf<b.Wf?64:4}}}zBa(a,b){return this.XB.CQ*(a-this.XB.ge)+(b-this.XB.Yd)}moveNext(){this.N9a=this.Qwb;do{this.N9a++;this.N9a>=this.XB.Jf&&(this.LN++,this.N9a=this.XB.Yd);if(this.LN>this.XB.Wf)return!1;this.xp=this.b8[this.zBa(this.LN,this.N9a)]}while(0===this.xp);for(this.Qwb=this.N9a;this.Qwb+1<this.XB.Jf&&this.b8[this.zBa(this.LN,
this.Qwb+1)]===this.xp;)this.Qwb++;return!0}SZi(){return this.Qwb+1}static O7d(a){return!!(a&87)}}Object(e.a)(QD,"HorizontalTableBorderIterator",null,[646,432]);class wL{constructor(a){this.vq=a}wxi(a,b){return new QD(a,this.vq,b)}}Object(e.a)(wL,"HorizontalTableBorderIteratorFactory",null,[325]);var Mz;(function(a){a[a.none=0]="none";a[a.firstLayout=1]="firstLayout";a[a.paragraphPropertyChange=2]="paragraphPropertyChange";a[a.cellChildTopoChange=3]="cellChildTopoChange";a[a.rowPropertyChange=4]=
"rowPropertyChange";a[a.cellPropertyChange=5]="cellPropertyChange";a[a.panelLayoutChange=6]="panelLayoutChange";a[a.tablePropertyChange=7]="tablePropertyChange";a[a.tableNodeConnected=8]="tableNodeConnected";a[a.tableViewElementDisconnected=9]="tableViewElementDisconnected";a[a.tableComplexityChange=10]="tableComplexityChange";a[a.slideInvalidateRenderSize=11]="slideInvalidateRenderSize"})(Mz||(Mz={}));Object(e.b)("LayoutInvalidateTrigger",Mz);class xL{constructor(){this.hha=this.DJd=this.Bmc=this.HNd=
0}get rowSpan(){return this.DJd-this.Bmc}toString(){return String.format("C[{0}][{1}]",this.Bmc,this.hha)}}Object(e.a)(xL,"CellInfo",null,[]);class ir{constructor(){this.cRc=!1;this.Uc=this.ULf=this.telemetry=null;this.e9a=this.qkc=!1;this.ejd=null;this.tSg=0;this.tableNode=this.tbe=this.Ewa=null;this.oUd=!1}}Object(e.a)(ir,"LayoutContext",null,[]);class yL{constructor(){this.crh=this.zmd=0}}Object(e.a)(yL,"LayoutTelemtry",null,[]);class RD{constructor(){this.offset=this.Ubc=this.index=0}toString(){return String.format("Index {0}, H {1}, O {2}",
this.index,this.Ubc,this.offset)}}Object(e.a)(RD,"RowSeamInfo",null,[]);class uh{constructor(a,b,c,f,l,x,F){this.$B=null;this.Xxb=[];this.FFa=[];this.yW=0;this.Fl=this.R_c=!1;this.Jab=null;this.YZc=!1;this.V_c=0;this.hg=null;this.fC=a;this.yb=f;this.Dk=x;this.Mb=c;this.QW=F;this.Q2b(1)}tAj(a,b){if(!this.R_c&&!this.YZc)try{2!==this.yW&&(1===this.yW?this.Xxb[0]!==a&&this.Q2b(b):(this.Xxb[this.Xxb.length]=a,this.yW=1,this.V_c=b))}catch(c){this.Q2b(0),ya.a.J(512495695,808,10,"PPTTableLayoutService::InvalidateCell failed {0}",
c.toString())}}Q2b(a){this.YZc||2===this.yW||this.R_c||(this.yW=2,this.Xxb=[],this.V_c=a)}C3d(){return 0!==this.yW&&!this.R_c}get OQc(){return this.yW}pBh(a){this.C3d()&&(a=Object.assign(new ir,{tableNode:a}),this.layout(a))}Qul(a,b){this.C3d()?this.Jab||(this.Jab=new He.a(3,1,0,Object(D.a)(this,this.Luk,"performLayout"),90,"9"),this.Jab.customData=Object.assign(new ir,{tableNode:a,cRc:!0,tbe:b}),this.yb.Gb(this.Jab)):b&&b(!1)}Luk(a){this.layout(Object(va.a)(ir,a.customData))}layout(a){this.YZc=!0;
const b=new wc.a(null,Object(D.a)(this,this.Cxj,"initializeLayoutState"),a);b.Vi=!a.cRc;b.run()}Cxj(a,b){b=Object(va.a)(ir,b);try{this.ALi();b.Uc=this.hg;b.telemetry=new yL;this.Pyl();if(!this.C3d())return a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout")),!0;this.yW=0;if(!b.tableNode.isConnected)return a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout")),!0;const c=Object(va.a)(624,b.tableNode.oc(this.fC));if(!c)return a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout")),!0;b.ejd=c;b.Uc.Wa(uh.M$h,b.cRc.toString());
b.tableNode.lp()?(b.Uc.Wa(uh.xzg,Mz[this.V_c]),a.Wg(Object(D.a)(this,this.zzk,"prepareTableMetrics"))):(b.Uc.Wa(uh.xzg,"tableComplexityChange"),b.qkc=!0,b.e9a=!0,a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout")))}catch(c){b.Uc.Wa(uh.B5b,c.message),a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout"))}return!0}zzk(a,b){b=Object(va.a)(ir,b);try{b.Ewa=new Date,this.QW.b6g(b.tableNode,this.fC),b.Uc.Wa(uh.uzk,(+new Date-+b.Ewa).toString()),b.Uc.Wa(uh.Kck,this.QW.yEj.toString()),a.Wg(Object(D.a)(this,this.XRj,
"layoutBaselineTable"))}catch(c){b.Uc.Wa(uh.B5b,c.message),a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout"))}return!0}XRj(a,b){b=Object(va.a)(ir,b);try{b.Ewa=new Date;b.oUd=!0;b.tSg=uh.Tbk;this.$B=[];this.$B[this.$B.length]=Object.assign(new RD,{index:0,Ubc:0,offset:0});const c=new jg.a(this.fC);c.set(b.tableNode);if(!c.zb(1))throw Error.invalidOperation(uh.S1f);const f=b.tableNode;let l=c.currentNode,x=l,F=0,R=0,fa=0;for(;l;){15===l.type&&(x=l,fa=F=0,l=c.zb(1));const wa=l;if(!wa)throw ya.a.J(512495690,
808,10,"PPTTableLayoutService::LayoutBaselineTable Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");if(1===wa.rowSpan){const Xa=Object(va.a)(Ss,l.oc(this.fC));F=Math.max(F,this.QW.e_b(f,Xa.kha,R,fa))}l=c.wj(1);fa++;if(!l){const Xa=Object.assign(new RD,{index:this.$B.length});let lb=x.sa(ub.a.Rt,0);lb=Math.max(lb,this.Dk.XBc(x));let Lb=b.ejd.Fd.Cd.Ge(lb,1);Lb=Math.max(Lb,F);Xa.offset=Lb+this.$B[Xa.index-1].offset;Xa.Ubc=Lb;this.$B[this.$B.length]=Xa;l=c.uf(1);R++}}a.Wg(Object(D.a)(this,
this.bSj,"layoutRowSeams"));b.Uc.Wa(uh.$Rj,(+new Date-+b.Ewa).toString())}catch(c){b.Uc.Wa(uh.B5b,c.message),b.qkc=!0,a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout"))}return!0}bSj(a,b){b=Object(va.a)(ir,b);try{if(1===this.$B.length)throw Error.create(uh.qPi);let c=b.ULf;if(!c){b.Ewa=new Date;c=new jg.a(this.fC);c.set(b.tableNode);if(!c.zb(1))throw Error.invalidOperation(uh.S1f);b.ULf=c}const f=b.tableNode;let l=c.currentNode,x=0,F=0,R=0;for(;l&&x<b.tSg;){15===l.type&&(l=c.zb(1),F=0);const fa=l;if(!fa)throw ya.a.J(512495687,
808,10,"PPTTableLayoutService::LayoutRowSeams Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");x++;b.telemetry.zmd++;1===fa.rowSpan||Ui.OutlineReader.isEmpty(c)?b.telemetry.crh++:this.dSj(this.Ovi(f,fa,R,F),b.Uc);l=c.wj(1);F++;l||(l=c.uf(1),R++)}l||(this.Qil(),a.Wg(Object(D.a)(this,this.USi,"fixupTableMinRowHeight")),b.Uc.Wa(uh.cSj,(+new Date-+b.Ewa).toString()))}catch(c){b.Uc.Wa(uh.B5b,c.message),b.qkc=!0,a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout"))}return!0}USi(a,b){b=
Object(va.a)(ir,b);try{const l=b.ejd;b.Ewa=new Date;const x=[];var c=new jg.a(this.fC);c.set(b.tableNode);for(var f=c.zb(1);f;)x[x.length]=c.Gq,f=c.wj(1);if(this.FFa.length===x.length){c=[];for(f=0;f<x.length;++f)c[f]=0,1<Math.abs(this.FFa[f]-x[f].htmlElement.offsetHeight)&&(c[f]=this.FFa[f]);for(f=0;f<c.length;++f)0<c[f]&&x[f].xGb(c[f]*l.I_d())}else throw Error.invalidOperation(String.format("RowMisMatch{0},{1}",this.FFa.length,x.length));a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout"));b.Uc.Wa(uh.QSi,
(+new Date-+b.Ewa).toString());b.e9a=!0}catch(l){b.Uc.Wa(uh.B5b,l.message),b.qkc=!0,a.Wg(Object(D.a)(this,this.Vwa,"tearDownLayout"))}return!0}Vwa(a,b){a=Object(va.a)(ir,b);a.Ewa=new Date;a.qkc?(this.KUk(a.Uc,a.tableNode,a.ejd),a.oUd=!0):a.Uc&&(a.Uc.Wa(uh.fSj,a.telemetry.zmd.toString()),a.Uc.Wa(uh.eSj,a.telemetry.crh.toString()));this.Jab&&!a.cRc&&this.yb.Qg(this.Jab);this.YZc=!1;this.Jab=null;this.V_c=0;a.Uc&&(a.Uc.Wa(uh.e9a,a.e9a.toString()),!a.e9a&&a.Uc&&a.Uc.Wa(uh.tableLayout,this.QW.pSd(a.tableNode)),
a.Uc.Wa(uh.ykl,(+new Date-+a.Ewa).toString()),a.Uc.finish());a.e9a||(this.R_c=!0);this.$B=null;this.Xxb=[];this.hg=null;this.QW.reset();a.tbe&&a.tbe(a.oUd);return!1}KUk(a,b,c){if(b.isConnected)try{const f=new jg.a(this.fC);f.set(b);let l=f.zb(1);for(;l;){const x=Object(va.a)(vv,f.lOa);if(!x)throw Error.argument("tableRowViewElement");let F=c.Fd.Cd.Ge(l.sa(ub.a.Rt,0),1);const R=c.I_d();F*=R;x.xGb(F);l=f.wj(1)}}catch(f){a&&a.Wa(uh.JUk,f.message)}}dSj(a,b){if(!a)throw Error.create(uh.pPi);var c=this.$B[a.Bmc];
const f=this.$B[a.DJd];c=Math.max(this.e7i(c,f),a.HNd)-(f.offset-c.offset);if(!(0>=c)&&(this.V6h(f.index,c),f.offset<=this.$B[f.index-1].offset)){b.Wa(uh.vji,a.toString());for(a=0;a<=f.index;++a)b.Wa(uh.sYk,this.$B[a].toString());throw Error.create(uh.rPi);}}Qil(){if(this.$B){this.FFa=[];for(let a=1;a<this.$B.length;++a)this.FFa[this.FFa.length]=this.$B[a].offset-this.$B[a-1].offset}else this.FFa=null}V6h(a,b){if(b)for(var c=a,f=0;c<this.$B.length;){b=c===a?b:b+this.$B[c].Ubc-this.$B[c].offset+f;
if(0>=b)break;f=this.$B[c].offset;this.$B[c].offset+=b;c++}}e7i(a,b){if(a.index>=b.index)return 0;let c=0;for(a=a.index;a<b.index;)c+=this.$B[a+1].Ubc,a++;return c}Ovi(a,b,c,f){if(!b||!b.isConnected)return null;const l=Object(va.a)(Ss,b.oc(this.fC)),x=this.Mb.Kc(b);x.mc(14);a=Object.assign(new xL,{HNd:this.QW.e_b(a,l.kha,c,f),Bmc:ik.c(x),hha:f});a.DJd=a.Bmc+b.rowSpan;return a}dispose(){this.Fl||(this.Xxb=this.$B=this.FFa=null,this.yW=0,this.Fl=!0)}Pyl(){if(this.Fl)throw Error.invalidOperation("table layout service is already disposed");
}ALi(){this.hg||(this.hg=Mc.a.hm("TableLayout"))}get Ma(){return this.fC}}uh.Tbk=25;uh.B5b="FailureReason";uh.JUk="RestoreFailureReason";uh.tableLayout="Layout";uh.sYk="SI";uh.vji="CI";uh.M$h="FAsync";uh.fSj="CellVisited";uh.eSj="CellSkipped";uh.e9a="Succeeded";uh.$Rj="LETD";uh.cSj="LRST";uh.QSi="FMTR";uh.ykl="TDLD";uh.uzk="PM";uh.xzg="Trigger";uh.Kck="MC";uh.pPi="CellDisconnected";uh.qPi="ChildOfTableNotLoaded";uh.rPi="SeamPositionInvariant";uh.S1f="NoRowViewElement";Object(e.a)(uh,"PPTTableLayoutService",
null,[649,106]);class zL{constructor(a,b,c,f,l){this.Mb=a;this.yb=b;this.Z8j=c;this.Dk=f;this.QW=l}create(a,b){return new uh(a,b,this.Mb,this.yb,this.Z8j,this.Dk,this.QW)}}Object(e.a)(zL,"PPTTableLayoutServiceFactory",null,[332]);class AL{constructor(a,b,c,f,l,x,F,R,fa){this.s6j=a;this.vo=b;this.Mb=c;this.gVa=f;this.QPg=l;this.Ibb=x;this.j$b=F;this.jv=R;this.DZc=!0;this.Yje=fa;this.tta=new Ic.a;this.vo.dF&&!this.vo.Hj&&(this.DZc=!1);this.DZc&&(this.gVa.mGd(Object(D.a)(this,this.RWg,"onBeforeTableViewElementDisconnected")),
this.gVa.Iga(Object(D.a)(this,this.J0g,"onTableNodeConnected")),this.gVa.xk(Object(D.a)(this,this.L0g,"onTableNodePropertyChanged")),this.gVa.t6(Object(D.a)(this,this.K0g,"onTableNodeDisconnected")),this.QPg.xk(Object(D.a)(this,this.N0g,"onTableRowNodePropertyChanged")),this.Ibb.xk(Object(D.a)(this,this.x8c,"onTableCellNodePropertyChanged")),this.Ibb.$F(Object(D.a)(this,this.I0g,"onTableCellNodeChildTopoChanged")),this.j$b.xk(Object(D.a)(this,this.RZg,"onParagraphNodePropertyChanged")),this.jv.E5h(Object(D.a)(this,
this.i0g,"onSlideInvalidateRenderSize")))}fNc(a,b){if(!this.DZc)return null;var c=a.id.toString();this.tta.Jb(c)||this.tta.$(c,new Tu.a);c=this.tta.ga(c);var f=a.lp();f=this.Yje?f&&xd.TableReader.WPf(Object(va.a)(mb.GraphIterator,this.Mb.Kc(a))):f;if(c.Jb(b))return b=c.ga(b),f||0!==b.OQc||(this.dch(a),b=null),b;if(f)c.$(b,this.s6j.create(b,a.id));else return null;return c.ga(b)}Wtb(a,b,c){a.lp()?this.dqg(a.id.toString(),b,c):10===c&&this.dqg(a.id.toString(),b,c)}dqg(a,b,c){if(this.tta.Jb(a))for(let f of this.tta.ga(a).values)b?
f.tAj(b,c):f.Q2b(c)}H6d(a,b,c){a.isConnected&&(a=this.Mb.Kc(a),a.mc(14)&&this.Wtb(a.rw(14),b,c))}lAj(a){a.isConnected&&(a=this.Mb.Kc(a),a.mc(14)&&this.Wtb(a.rw(14),a.rw(16),2))}RWg(a,b){b.Er.Oc.So&&this.Wtb(b.Er.$a,null,9)}J0g(a,b){this.Wtb(b.node,null,8);a=Object(va.a)(Lz.TableNode,b.node);a=!!a&&a.lp();ya.a.J(41007133,808,50,"Render table, isComplexTable: {0}",a)}K0g(a,b){this.dch(b.node)}dch(a){a=a.id.toString();if(this.tta.Jb(a)){const b=this.tta.ga(a);for(let c of b.values)c&&c.dispose();this.tta.remove(a)}}L0g(a,
b){a=b.property;b.node.isConnected&&(a===bb.a.uu||a===bb.a.Oea||a===bb.a.pA||a===ub.a.Rgb||a===ub.a.cid||a===ub.a.RIa||a===ub.a.Alc?this.Wtb(b.node,null,7):a===ub.a.complexTable&&this.Wtb(b.node,null,10))}N0g(a,b){a=b.property;b.node.isConnected&&a===ub.a.Rt&&this.H6d(b.node,null,4)}x8c(a,b){a=b.property;!b.node.isConnected||a!==ub.a.rowSpan&&a!==ub.a.colSpan||this.H6d(b.node,null,5)}I0g(a,b){b.node.isConnected&&1===b.PY&&this.H6d(b.node,b.node,3)}RZg(a,b){a=Object(va.a)(5,b.node);b=b.property;a&&
a.isConnected&&a.Sa(ub.a.cellId)&&!a.Rfc&&(b===bb.a.Zp||b===bb.a.Ygb)&&this.lAj(a)}i0g(){for(let a of this.tta.keys)for(let b of this.tta.ga(a).values)b.Q2b(11)}dispose(){this.DZc&&(this.gVa.JDe(Object(D.a)(this,this.RWg,"onBeforeTableViewElementDisconnected")),this.gVa.ima(Object(D.a)(this,this.J0g,"onTableNodeConnected")),this.gVa.Tm(Object(D.a)(this,this.L0g,"onTableNodePropertyChanged")),this.gVa.yHa(Object(D.a)(this,this.K0g,"onTableNodeDisconnected")),this.QPg.Tm(Object(D.a)(this,this.N0g,"onTableRowNodePropertyChanged")),
this.Ibb.Tm(Object(D.a)(this,this.x8c,"onTableCellNodePropertyChanged")),this.Ibb.iO(Object(D.a)(this,this.I0g,"onTableCellNodeChildTopoChanged")),this.j$b.Tm(Object(D.a)(this,this.RZg,"onParagraphNodePropertyChanged")),this.jv.HQk(Object(D.a)(this,this.i0g,"onSlideInvalidateRenderSize")))}}Object(e.a)(AL,"PPTTableLayoutServiceManager",null,[333,106]);class SD{constructor(a,b,c){this.vq=b;this.Qka=c;this.XB=this.vq.oIc(this.Qka,a.DD);this.b8=Array(this.XB.$N*(this.XB.CQ+1));this.LK=this.XB.Yd;this.ibb=
this.XB.ge;this.Xzb=this.XB.ge-1;this.xp=0;this.E5d(a)}E5d(a){const b=a.DD;for(;a.moveNext();){const f=a.Ez;for(let l=f.ge;l<f.Wf;l++){var c=this.zBa(l,f.Yd);this.b8[c]=0!==this.b8[c]?32:l<b.ge&&f.Yd>b.Yd?1:l>=b.Wf&&f.Yd>b.Yd?4:16;c=this.zBa(l,f.Jf);this.b8[c]=0!==this.b8[c]?32:l<b.ge&&f.Jf<b.Jf?1:l>=b.Wf&&f.Jf<b.Jf?4:64}}}zBa(a,b){return this.XB.$N*(b-this.XB.Yd)+(a-this.XB.ge)}moveNext(){this.ibb=this.Xzb;do{this.ibb++;this.ibb>=this.XB.Wf&&(this.LK++,this.ibb=this.XB.ge);if(this.LK>this.XB.Jf)return!1;
this.xp=this.b8[this.zBa(this.ibb,this.LK)]}while(0===this.xp);for(this.Xzb=this.ibb;this.Xzb+1<this.XB.Wf&&this.b8[this.zBa(this.Xzb+1,this.LK)]===this.xp;)this.Xzb++;return!0}Laj(){return this.Xzb+1}static O7d(a){return!!(a&117)}}Object(e.a)(SD,"VerticalTableBorderIterator",null,[431,432]);class yl{constructor(a,b,c,f,l,x,F){this.Dk=a;this.vq=b;this.Mb=c;this.Qz=f;this.yca=l;this.y1j=x;this.o$j=F}ltl(a,b,c){const f=b.getContainingTable();f&&(this.npl(b,f,a,c.Jf,c.ge),this.lpl(b,f,a,c.Wf,c.Yd))}CVd(a,
b,c,f,l,x){if(c&&c!==b.$N)for(;f<l;f++)if(9===(b.Or(c-1,f)&9)&&5===(b.Or(c,f)&5)){var F=this.vq.QH(b,c-1,f),R=this.vq.QH(b,c,f);F=a.ef(F.ge,F.Yd);R=a.ef(R.ge,R.Yd);x?this.opb(R,F,7,0):this.opb(F,R,0,7)}}PHe(a,b,c,f,l){l=this.yca.bBa(a,b,c,l);c=f.BYi();if(SD.O7d(c)){let x=this.o$j.zBi(l,b);for(;x.moveNext();)0!==(c&x.xp)&&this.sJe(a,b,x.LK,x.ibb,x.Laj(),f.Jsb(x.xp),!0)}if(QD.O7d(c))for(l=this.y1j.wxi(l,b);l.moveNext();)0!==(c&l.xp)&&this.nIe(a,b,l.LN,l.N9a,l.SZi(),f.Jsb(l.xp),!0)}sJe(a,b,c,f,l,x,F=
!1){let R=this.Qz.vNc(a),fa=null;0<c&&(fa=a.ef(f,c-1));let wa=null;for(c<b.CQ&&(wa=a.ef(f,c));f<l;){if(fa){if(6===(b.Or(f,c-1)&6)){var Xa=this.vq.QH(b,f,c-1),lb=a.ef(Xa.ge,Xa.Yd);F&&R?R=this.RFb(R,lb,Xa.ge,Xa.Yd,6,x):yl.Kjc(6,lb,x)}f+1<l&&(fa=a.ef(f+1,c-1))}wa&&(5===(b.Or(f,c)&5)&&(Xa=this.vq.QH(b,f,c),lb=a.ef(Xa.ge,Xa.Yd),F&&R?R=this.RFb(R,lb,Xa.ge,Xa.Yd,5,x):yl.Kjc(5,lb,x)),f+1<l&&(wa=a.ef(f+1,c)));f+=1}}DVd(a,b,c,f,l,x){if(c&&c!==b.CQ)for(;f<l;f++)if(6===(b.Or(f,c-1)&6)&&5===(b.Or(f,c)&5)){var F=
this.vq.QH(b,f,c-1),R=this.vq.QH(b,f,c);F=a.ef(F.ge,F.Yd);R=a.ef(R.ge,R.Yd);x?this.opb(R,F,5,6):this.opb(F,R,6,5)}}nIe(a,b,c,f,l,x,F=!1){let R=this.Qz.vNc(a),fa=null;0<c&&(fa=a.ef(c-1,f));let wa=null;for(c<b.$N&&(wa=a.ef(c,f));f<l;){if(fa){if(9===(b.Or(c-1,f)&9)){var Xa=this.vq.QH(b,c-1,f),lb=a.ef(Xa.ge,Xa.Yd);F&&R?R=this.RFb(R,lb,Xa.ge,Xa.Yd,0,x):yl.Kjc(0,lb,x)}f+1<l&&(fa=a.ef(c-1,f))}wa&&(5===(b.Or(c,f)&5)&&(Xa=this.vq.QH(b,c,f),lb=a.ef(Xa.ge,Xa.Yd),F&&R?R=this.RFb(R,lb,Xa.ge,Xa.Yd,7,x):yl.Kjc(7,
lb,x)),f+1<l&&(wa=a.ef(c,f)));f+=1}}Vxh(a,b,c,f){var l=null;if(!({ge:f}=yl.iyh(b,c,f)).returnValue)return{returnValue:!1,kja:l};l=6;0<c&&yl.zub(b,f,c-1)?(b=this.vq.QH(b,f,c-1),a=this.Mb.Kc(a.ef(b.ge,b.Yd))):(l=5,b=this.vq.QH(b,f,c),a=this.Mb.Kc(a.ef(b.ge,b.Yd)));l=this.Y$f(a,l);return{returnValue:!0,kja:l}}Rxh(a,b,c,f){const l=yl.byh(b,c,f);if(!l.returnValue)return{returnValue:!1,kja:null};f=0;0<c&&yl.U8a(b,l.Yd,c-1)?(b=this.vq.QH(b,c-1,l.Yd),a=this.Mb.Kc(a.ef(b.ge,b.Yd))):(f=7,b=this.vq.QH(b,c,l.Yd),
a=this.Mb.Kc(a.ef(b.ge,b.Yd)));return{returnValue:!0,kja:this.Y$f(a,f)}}RFb(a,b,c,f,l,x){const F=b.rowSpan;b=b.colSpan;for(let R=c;R<c+F;R++)for(let fa=f;fa<f+b;fa++)a.RFb(R,fa,l,x);return a}Y$f(a,b){a=a.hq;if(!a||!a.cellShading)return null;let c=null;({kja:c}=this.Dk.hRe(b,a.cellShading));return c}opb(a,b,c,f){if(a!==b&&!a.id.equals(b.id)){var l=null;b.cellShading&&(l=om.a.MPa(b,ub.a.cellShading));l&&({kja:b}=this.Dk.hRe(f,l),yl.Kjc(c,a,b))}}npl(a,b,c,f,l){let x;({ge:x}=yl.iyh(c,f,l)).returnValue&&
(l=6,0<f&&yl.zub(c,x,f-1)?c=this.vq.QH(c,x,f-1):(l=5,c=this.vq.QH(c,x,f)),b=b.ef(c.ge,c.Yd),this.opb(a,b,6,l))}lpl(a,b,c,f,l){let x;({Yd:x}=yl.byh(c,f,l)).returnValue&&(l=0,0<f&&yl.U8a(c,x,f-1)?c=this.vq.QH(c,f-1,x):(l=7,c=this.vq.QH(c,f,x)),b=b.ef(c.ge,c.Yd),this.opb(a,b,0,l))}static Kjc(a,b,c){let f=null;b.cellShading&&(f=b.cellShading);if(f){switch(a){case 7:f.lnTField=c;break;case 0:f.lnBField=c;break;case 5:f.lnLField=c;break;case 6:f.lnRField=c}b.cellShading=f}}static iyh(a,b,c){let f,l;f=c;
l=c+1;if(!yl.U8a(a,b,c))return{returnValue:!1,ge:f,Wf:l};for(;0<f&&!(0<b&&yl.zub(a,f,b-1))&&!(b<a.CQ&&yl.zub(a,f,b));f--);for(;l<a.$N&&!(0<b&&yl.zub(a,l,b-1))&&!(b<a.CQ&&yl.zub(a,l,b));l++);return{returnValue:!0,ge:f,Wf:l}}static byh(a,b,c){let f;f=c;for(c+=1;0<f&&!(0<b&&yl.U8a(a,f,b-1))&&!(b<a.$N&&yl.U8a(a,f,b));f--);for(;c<a.CQ&&!(0<b&&yl.U8a(a,c,b-1))&&!(b<a.$N&&yl.U8a(a,c,b));c++);return{returnValue:!0,Yd:f,Jf:c}}static U8a(a,b,c){return 0<b&&!(a.Or(c,b-1)&2)||b<a.CQ&&!(a.Or(c,b)&1)?!1:!0}static zub(a,
b,c){return 0<b&&!(a.Or(b-1,c)&8)||b<a.$N&&!(a.Or(b,c)&4)?!1:!0}}Object(e.a)(yl,"TableBorderEditor",null,[620,621]);class BL{constructor(a,b,c,f){this.Yde=!1;this.x_=a;this.X8j=b;this.xAb=c;this.ile=f;this.Zh=Array(this.x_.wX);for(a=0;a<this.x_.wX;a++)for(this.Zh[a]=Array(this.x_.Spa),b=0;b<this.x_.Spa;b++)this.Zh[a][b]=new nq.a}AYi(a,b,c){this.Yde||(this.X8j.gUk(a,this.x_),this.Yde=!0);if(ee.a("BugFixCacheInvalidIndex")){if(this.Zh&&0<=b&&b<this.Zh.length&&this.Zh[b]&&0<=c&&c<this.Zh[b].length)return this.Zh[b][c];
a=String.format("GetBorderStylePropertySet : Illegal cache access m_cache : {0} ,  row : {1}, col : {2} ",this.Zh,b,c);this.Zh&&(a+=String.format(" m_cache.Length : {0} ",this.Zh.length),a=this.Zh[b]?a+String.format(" m_cache[ row ].Length : {0} ",this.Zh[b].length):a+" m_cache[ row ] is null ");ya.a.J(559724692,822,15,a);return null}return this.Zh[b][c]}RFb(a,b,c,f){var l=this.xAb.Lfh(c,this.x_.Se,f);a=this.Zh[a][b];for(var x of l.Bz())a.ke(x,l.Sh(x));this.ile&&ee.a("TableBordersLocalRenderingFix")&&
({nNa:l,k3a:c,Pnb:x}=Xp.jQa(c),f.wFieldSpecified&&(f.noFillField?a.ke(l,0):a.ke(l,je.a.LSd(f.wField))),f.solidFillField&&a.ke(c,f.solidFillField),f.prstDashField&&a.ke(x,f.prstDashField))}dispose(){this.Zh=null;this.Yde=!1}}Object(e.a)(BL,"TableBorderStyleCache",null,[619,106]);class TD{constructor(a){this.dne=a?1:0}QEd(a){const b=a.Ez;a=a.DD;return b.Yd%2===this.dne&&a.Lqb(b)}}Object(e.a)(TD,"BandedColumnFilter",null,[645]);class UD{constructor(a){this.dne=a?1:0}QEd(a){const b=a.Ez;a=a.DD;return b.ge%
2===this.dne&&a.Lqb(b)}}Object(e.a)(UD,"BandedRowFilter",null,[645]);class CL{constructor(){this.diagBL2TR=this.right=this.insideVer=this.left=this.diagTL2BR=this.bottom=this.insideHor=this.top=null}BYi(){let a=0;this.top&&(a|=1);this.insideHor&&(a|=2);this.bottom&&(a|=4);this.diagTL2BR&&(a|=8);this.left&&(a|=16);this.insideVer&&(a|=32);this.right&&(a|=64);this.diagBL2TR&&(a|=128);return a}Jsb(a){switch(a){case 1:return this.top;case 2:return this.insideHor;case 4:return this.bottom;case 8:return this.diagTL2BR;
case 16:return this.left;case 32:return this.insideVer;case 64:return this.right;case 128:return this.diagBL2TR;default:return null}}}Object(e.a)(CL,"TableBorderSet",null,[]);class DL{constructor(a,b){this.U3=a;this.c9j=b}gUk(a,b){const c=b.wX,f=b.Spa;var l=b.tableLook;b=b.tableStyle;const x=this.c9j.create(a),F=!!(l&32)&&!!b.firstRowField,R=!!(l&64)&&!!b.lastRowField,fa=!!(l&128)&&!!b.firstColField,wa=!!(l&256)&&!!b.lastColField,Xa=F&&fa&&!!b.nwCellField,lb=F&&wa&&!!b.neCellField,Lb=R&&fa&&!!b.swCellField,
kc=R&&wa&&!!b.seCellField;var lc=!(l&512)&&!!b.band1HField,Ec=!(l&512)&&!!b.band2HField,Jc=!(l&1024)&&!!b.band1VField;const Dc=!(l&1024)&&!!b.band2VField;l=new hr.a;b.wholeTblField&&(l.ge=0,l.Wf=c,l.Yd=0,l.Jf=f,this.apply(a,x,b.wholeTblField,l));l.ge=F?1:0;l.Wf=c-(R?1:0);l.Yd=0;l.Jf=f;lc&&(lc=new UD(F),this.apply(a,x,b.band1HField,l,lc));Ec&&(Ec=new UD(!F),this.apply(a,x,b.band2HField,l,Ec));l.ge=0;l.Wf=c;l.Yd=fa?1:0;l.Jf=f-(wa?1:0);Jc&&(Jc=new TD(fa),this.apply(a,x,b.band1VField,l,Jc));Dc&&(Jc=new TD(!Dc),
this.apply(a,x,b.band2VField,l,Jc));wa&&(l.ge=0,l.Wf=c,l.Yd=f-1,l.Jf=f,this.apply(a,x,b.lastColField,l));fa&&(l.ge=0,l.Wf=c,l.Yd=0,l.Jf=1,this.apply(a,x,b.firstColField,l));R&&(l.ge=c-1,l.Wf=c,l.Yd=0,l.Jf=f,this.apply(a,x,b.lastRowField,l),kc&&(l.Yd=f-1,l.Jf=f,this.apply(a,x,b.seCellField,l)),Lb&&(l.Yd=0,l.Jf=1,this.apply(a,x,b.swCellField,l)));F&&(l.ge=0,l.Wf=1,l.Yd=0,l.Jf=f,this.apply(a,x,b.firstRowField,l),lb&&(l.Yd=f-1,l.Jf=f,this.apply(a,x,b.neCellField,l)),Xa&&(l.Yd=0,l.Jf=1,this.apply(a,x,
b.nwCellField,l)))}apply(a,b,c,f,l=null){if(!f.hPa()&&c&&c.tcStyleField&&(c=c.tcStyleField.tcBdrField)){const x=new CL;c.topField&&c.topField.itemField&&(x.top=c.topField.itemField);c.bottomField&&c.bottomField.itemField&&(x.bottom=c.bottomField.itemField);c.insideHField&&c.insideHField.itemField&&(x.insideHor=c.insideHField.itemField);c.leftField&&c.leftField.itemField&&(x.left=c.leftField.itemField);c.rightField&&c.rightField.itemField&&(x.right=c.rightField.itemField);c.insideVField&&c.insideVField.itemField&&
(x.insideVer=c.insideVField.itemField);this.U3.PHe(a,b,f,x,l)}}}Object(e.a)(DL,"TableBorderStyleResolver",null,[327]);class xv{constructor(){}bji(a,b){const c=new hr.a;if(a.hPa())return c;const f=xv.$2f(b,a,a.ge,!0),l=xv.$2f(b,a,a.Wf-1,!1),x=xv.B2f(b,a,a.Yd,!0);a=xv.B2f(b,a,a.Jf-1,!1);c.ge=f;c.Wf=l+1;c.Yd=x;c.Jf=a+1;return c}eDj(a,b){for(var c=a.ge;c<a.Wf;++c)if(!(b.Or(c,a.Yd)&1&&b.Or(c,a.Jf-1)&2))return!1;for(c=a.Yd;c<a.Jf;++c)if(!(b.Or(a.ge,c)&4&&b.Or(a.Wf-1,c)&8))return!1;return!0}i7f(a){let b;
b=null;const c=new hr.a;if(!(a&&a.nl&&a.kb&&a.a5))return{returnValue:c,tableNode:b};var f=a.ga(0).gg.Ua,l=Object(va.a)(Xl.TableCellNode,f.node);l&&(b=l.getContainingTable());if(!l||!b)return{returnValue:c,tableNode:b};f=l.rowIndex;l=l.li;var x=Object(va.a)(Xl.TableCellNode,a.ga(0).gg.Te.node);var F=0;x&&(F=x.li+1);if(b.lp()&&1!==a.length){F=Object(va.a)(Xl.TableCellNode,a.AYa.currentNode);f=Object(va.a)(Xl.TableCellNode,a.Gha.currentNode);if(!F||!f)return{returnValue:c,tableNode:b};l=F.rowIndex;a=
F.li;x=f.rowIndex;F=f.li;f=Math.min(l,x);x=Math.max(l,x)+1;l=Math.min(a,F);F=Math.max(F,a)+1}else x=f+a.length;c.ge=f;c.Wf=x;c.Yd=l;c.Jf=F;return{returnValue:c,tableNode:b}}QH(a,b,c){b=Object.assign(new hr.a,{ge:b,Wf:b+1,Yd:c,Jf:c+1});return this.oIc(a,b)}oIc(a,b){const c=new hr.a;let f=b.ge,l=b.Wf-1;for(var x=b.Yd;x<b.Jf;x++){for(var F=b.ge;0<F&&!(a.Or(F,x)&4);F--);F<f&&(f=F);F=b.Wf-1;for(var R=a.$N-1;F<R&&!(a.Or(F,x)&8);F++);F>l&&(l=F)}x=b.Yd;F=b.Jf-1;for(R=b.ge;R<b.Wf;R++){let fa=b.Yd;for(;0<fa&&
!(a.Or(R,fa)&1);fa--);fa<x&&(x=fa);fa=b.Jf-1;for(const wa=a.CQ-1;fa<wa&&!(a.Or(R,fa)&2);fa++);fa>F&&(F=fa)}c.ge=f;c.Yd=x;c.Jf=F+1;c.Wf=l+1;return c}static $2f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.Yd;f<b.Jf;++f){if(a.Or(c,f)&4)return c}else for(f=a.$N-1;c<f;c++)for(let l=b.Yd;l<b.Jf;++l)if(a.Or(c,l)&8)return c;return c}static B2f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.ge;f<b.Wf;++f){if(a.Or(f,c)&1)return c}else for(f=a.CQ-1;c<f;++c)for(let l=b.ge;l<b.Wf;++l)if(a.Or(l,c)&2)return c;return c}}Object(e.a)(xv,
"TableCellSelectionHelper",null,[322]);class EL{constructor(a,b,c){this.fQ=null;this.d3=!1;if(!a||!a.isConnected||14!==a.type)throw Error.argument("tableNode");this.Ud=a;this.sc=b;this.QW=c;this.yW=3}OTe(){try{var a=mb.GraphIterator.mb(this.Ud);Dd.forEachCellInTable(a,(b,c,f)=>{var l=Object(va.a)(125,b.currentNode);if(l&&!l.isGhostCell){b=l.rowSpan+c;l=l.colSpan+f;for(let x=c;x<b;++x)for(let F=f;F<l;++F)x===c&&(this.fQ[x][F]|=4),x===b-1&&(this.fQ[x][F]|=8),F===f&&(this.fQ[x][F]|=1),F===l-1&&(this.fQ[x][F]|=
2)}return!0})}catch(b){a=this.QW.pSd(this.Ud),ya.a.J(38043909,822,15,"TableLayoutInfo:{0}, Message:{1}",a,b.message)}}validate(){if(this.d3)throw Error.invalidOperation("cache disposed");if(0!==this.yW){if(3===(this.yW&3)){const a=this.sc.$j(this.Ud),b=this.sc.ui(this.Ud);this.fQ=Array(a);for(let c=0;c<a;++c){this.fQ[c]=Array(b);for(let f=0;f<b;++f)this.fQ[c][f]=0}}1===(this.yW&1)&&this.OTe();this.yW=0}}Or(a,b){try{this.validate();var c=this.fQ[a][b]}catch(f){c=this.QW.pSd(this.Ud),ya.a.J(38043911,
822,15,"NumRows:{0} NumCols:{1} Row:{2} Col:{3}, TableLayoutInfo:{4}, Message:{5}",this.$N,this.CQ,a,b,c,f.message),c=0}return c}rRa(a){this.yW|=a}dispose(){this.d3=!0;this.fQ=null}get $N(){this.validate();return this.fQ?this.fQ.length:0}get CQ(){this.validate();return this.fQ&&this.fQ.length?this.fQ[0].length:0}}Object(e.a)(EL,"TableInfoCache",null,[644,106]);class FL{constructor(a,b){this.sc=a;this.QW=b}create(a){return new EL(a,this.sc,this.QW)}}Object(e.a)(FL,"TableInfoCacheFactory",null,[334]);
class Nz{constructor(a,b,c,f,l,x){this.A7j=a;this.UZj=b;this.f9j=c;this.r4j=f;this.x9j=l;this.k9j=x}get wX(){return this.A7j()}get Spa(){return this.UZj()}get tableLook(){return this.f9j()}get eTj(){return this.r4j()}get Se(){return this.x9j()}get tableStyle(){return this.k9j()}static hTf(a,b,c,f,l,x){return new Nz(a,b,c,f,l,x)}}Object(e.a)(Nz,"TableListStyleParams",null,[373]);class GL{constructor(a){this.Yka=null;this.TZc=!1;this.Ype=this.Pwb=null;this.Mb=a}get yEj(){return!!this.Pwb}b6g(a,b){this.Ype=
a.id.toString();this.TZc=!this.Mb.L3i(a).currentNode.oc(b).QSc();this.Pwb=null;this.TZc&&(a=a.oc(b),this.OLi(),Ba.a.ZVb(a.htmlElement,this.Yka),this.Pwb=this.NRi(this.Yka))}e_b(a,b,c,f){if(a.id.toString()!==this.Ype)throw Error.argument("table","Wrong table metrics");if(this.TZc){if(!this.Pwb)throw Error.invalidOperation("m_clonedTableNode is null");a=this.Pwb.rows[c].cells[f];c=a.lastChild;c.className!==b.className&&(Z.ULS.sendTraceTag(587465758,808,10,"Cell content DOM structure changed, last child {0}",
c.className),c=Ba.a.uba(a,b.className));if(!c)throw Error.invalidOperation("No content");b=c}return b.offsetHeight}reset(){Ba.a.HRa(this.Yka)&&this.Yka.parentNode.removeChild(this.Yka);this.Pwb=this.Yka=null;this.TZc=!1;this.Ype=null}pSd(a){const b=new Sys.StringBuilder;try{b.append(String.format("Row:{0},Col:{1},",a.properties.sa(bb.a.Qwa,0),a.properties.sa(bb.a.Oea,0)));const c=this.Mb.Kc(a);Dd.forEachCellInTable(c,(f,l,x)=>{var F=f.currentNode;f=F.rowSpan;F=F.colSpan;(1<f||1<F)&&b.append(String.format("C[{0}][{1}]:{2}|{3},",
l,x,f,F));return!0});return b.toString()}catch(c){return b.append(c.message),b.toString()}}OLi(){this.Yka||(this.Yka=document.createElement("div"),this.Yka.className="TableMetricsWorkingDiv",document.body.appendChild(this.Yka));Ba.a.Xza(this.Yka)}NRi(a){for(a=a.firstChild;a;){if("table"===a.nodeName.toLowerCase())return a;a=a.nextSibling}return null}}Object(e.a)(GL,"TableMetrics",null,[331]);class HL{constructor(a){this.Qz=a}hUk(a,b,c){return b&&a&&c&&(a=this.Qz.xNc(a).y8f(c,b.rowIndex,b.li,b.rowSpan,
b.colSpan))&&a!==Eb.a.auto?a.zC:-1}}Object(e.a)(HL,"TableThemeColorHelper",null,[335]);class IL{constructor(a){this.vq=a}zBi(a,b){return new SD(a,this.vq,b)}}Object(e.a)(IL,"VerticalTableBorderIteratorFactory",null,[326]);class VD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Table"}Wb(a){this.K=a;this.K.register(322,"PowerPointWebEditor.ITableCellSelectionHelper").ma().na(()=>new xv);a.register(323,"Box4.ITableDragSelectionCellExtendStrategy").ma().na(()=>new eL(this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter")));this.K.register(yl,"PowerPointWebEditor.TableBorderEditor").as("PowerPointWebEditor.ITableBorderEditor").as("PowerPointWebEditor.ITableBorderHelper").ma().na(()=>new yl(this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("PowerPointWebEditor.IHorizontalTableBorderIteratorFactory"),this.K.resolve("PowerPointWebEditor.IVerticalTableBorderIteratorFactory")));this.K.register(324,"PowerPointWebEditor.ICellIteratorFactory").ma().na(()=>new vL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(325,"PowerPointWebEditor.IHorizontalTableBorderIteratorFactory").ma().na(()=>new wL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));
this.K.register(326,"PowerPointWebEditor.IVerticalTableBorderIteratorFactory").ma().na(()=>new IL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(327,"PowerPointWebEditor.ITableBorderStyleResolver").ma().na(()=>new DL(this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory")));this.K.register(hm,"PowerPointWebEditor.TableEditor").as("PowerPointWebEditor.ITableEditor").as("Box4.ITableEditor").ma().na(()=>
new hm(this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("Box4.IOutlineElementEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("Box4.IPageView").Ma));this.K.register(ND,"PowerPointWebEditor.TableNodeBehavior").ma().na(()=>new ND(this.K.resolve("Box4.Graph.IGraphInstance").Bd(14),this.K.resolve("Box4.ITableNodeBehaviorHelper"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IApplicationSettings").t2d));this.K.register(328,"PowerPointWebEditor.ITableStyleReaderHelper").ma().na(()=>new Xp(this.K.resolve("Box4.IPageView").Cd,
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.ITableStyleResolver"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").QTc));this.K.register(Kz,"PowerPointWebEditor.TableStyleReader").as("Box4.Styles.ITableStyleReader").as("PowerPointWebEditor.IPPTTableStyleReader").as("PowerPointWebEditor.ITableStyleCacheHelper").ma().na(()=>new Kz(this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Box4.IPageView").Cd,this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(14),this.K.resolve("PowerPointWebEditor.IPresentationReader"),Nz.hTf,b=>new OD(b,a.resolve("PowerPointWebEditor.ITableStyleResolver")),b=>new MD(b),b=>new BL(b,a.resolve("PowerPointWebEditor.ITableBorderStyleResolver"),
a.resolve("PowerPointWebEditor.ITableStyleResolver"),a.resolve("PowerPointWebEditor.IApplicationSettings").K9),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").org,this.K.resolve("PowerPointWebEditor.IApplicationSettings").fOj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNewResolveTableBorderStyleEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderNonActiveTableAsyncEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").K9));this.K.register(329,"PowerPointWebEditor.ITableStyleResolver").ma().na(()=>new qL(this.K.resolve("PowerPointWebEditor.IApplicationSettings").K9));this.K.register(330,"PowerPointWebEditor.ITableStyleGalleryManager").ma().na(()=>new tL(this.K.La("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(331,"PowerPointWebEditor.ITableMetrics").ma().na(()=>
new GL(this.K.resolve("Box4.Graph.IGraphIteratorFactory")));this.K.register(332,"PowerPointWebEditor.IPPTTableLayoutServiceFactory").ma().na(()=>new zL(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(333,"PowerPointWebEditor.IPPTTableLayoutServiceManager").ma().na(()=>new AL(this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceFactory"),
this.K.resolve("Common.IBrowserUtils"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(14),this.K.resolve("Box4.Graph.IGraphInstance").Bd(15),this.K.resolve("Box4.Graph.IGraphInstance").Bd(16),this.K.resolve("Box4.Graph.IGraphInstance").Bd(12),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptComplexTableLayoutSyncEnabled));this.K.register(KD,"PowerPointWebEditor.TableCellNodeBehavior").ma().na(()=>
new KD(this.K.resolve("Box4.Graph.IGraphInstance").Bd(16),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")));this.K.register(aL,"Box4.TableReaderProxy").as("Box4.ITableReader").ma();this.K.register(bL,"Box4.TableRowReaderProxy").as("Box4.ITableRowReader").ma();this.K.register(uQ.a,"Box4.TableCellReaderProxy").as("Box4.ITableCellReader").ma();this.K.register(334,"PowerPointWebEditor.ITableInfoCacheFactory").ma().na(()=>
new FL(this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(335,"PowerPointWebEditor.ITableThemeColorHelper").ma().na(()=>new HL(this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,b=this.K.resolve("Common.IActionManagerExtended");this.K.resolve("PowerPointWebEditor.ITableThemeColorHelper");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").oEb(1,
new wv(this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a),new mL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),b,a),new lL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),b,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,a));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393250,new Em.a((c,f)=>new Il(c,f,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPoint.IBrowserHelperManager"),l=>Mx.kWb(l),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager"),this.K.resolve("PowerPointWebEditor.Core.IPkgLoadStatusContext"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IZoomContext"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393251,new Em.a((c,f)=>new vv(c,f,new Qb.a(c,f,Qb.a.Wjl))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393252,new dL(this.K.resolve("Box4.ITableCellReader"),this.K.resolve("Box4.Styles.IStyleReader"),
new Em.a((c,f)=>new Ss(c,f,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").qia,this.K.resolve("PowerPointWebEditor.IApplicationSettings").K9,this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))));Tc.StyleReader.Vq=this.K.resolve("Box4.Styles.ITableStyleReader");this.K.resolve("PowerPointWebEditor.TableNodeBehavior");this.K.resolve("PowerPointWebEditor.TableCellNodeBehavior");this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager")}dispose(){this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager").dispose()}static main(){m.a.instance.Ac(new VD)}}
Object(e.a)(VD,"PPTWebEditorTablePackage",null,[2,3]);var yQ=d(1189),Ph=d(107);class JL{constructor(){this.podsUrl=this.fileUrl=null}}Object(e.a)(JL,"IFileInfo",null,[]);class KL extends Sys.EventArgs{constructor(a){super();this.slideIndex=a.SlideIndex}}Object(e.a)(KL,"OnPresenterViewSyncMessageEventArgs",Sys.EventArgs,[]);class LL{constructor(){this.messageType=0;this.data=this.sender=null}}Object(e.a)(LL,"IPresentationMessage",null,[]);class ML{constructor(){this.useDefaultResourceProvider=this.thumbnailsEnabled=
!1;this.presenterWindowWidth=this.presenterWindowHeight=0}}Object(e.a)(ML,"IPresenterViewSettings",null,[]);class NL{constructor(){this.uiHost=this.userSessionId=null}}Object(e.a)(NL,"ISessionInfo",null,[]);var zQ=d(526);class OL{constructor(a,b,c){this.jQ="";this.m8=null;this.W$a=!1;this.xzb=null;this.va=new qd.a;this.ia=a;this.la=b;this.Qc=c;this.qzk()}ub(){this.ia.pa(ba.a.ehc,fc.a.application,Object(D.a)(this,this.ehc,"queryUsePresenterView"),96);this.ia.xa(ba.a.PCh,fc.a.application,Object(D.a)(this,
this.Nml,"toggleUsePresenterView"));this.ia.xa(ba.a.ohd,Fb.a.application,Object(D.a)(this,this.ohd,"showPresenterView"));this.ia.xa(ba.a.mDc,fc.a.application,Object(D.a)(this,this.mDc,"closePresenterView"));this.W$a=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")}ehc(a,b,c,f,l){(a=Object(va.a)(Ph.a,l))&&a.Kf(this.W$a);return 32}Nml(a,b,c){if(1===c&&!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return ya.a.J(512496092,830,10,"PresenterViewManager: presenter view is not enabled but ToggleUsePresenterView is triggered."),
8;2===c&&(this.W$a=!this.W$a,this.Qc.RD(new Yp.a(1)));return 32}ohd(a,b,c){try{if(!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return ya.a.J(512496091,822,10,"PresenterViewManager: ShowPresenterView triggered but feature is disabled by BRS."),2;if(2===c&&0<this.jQ.length){if(!this.xzb){const f=this.la.podsWebServiceBase,l=String.format("{0}presenter.aspx",f),x=new JL;x.fileUrl=this.jQ;x.podsUrl=f;const F=new NL;F.userSessionId=u.AFrameworkApplication.userSessionId;F.uiHost="UnifiedApp";
const R=new ML;R.presenterWindowWidth=1024;R.presenterWindowHeight=576;this.xzb=new PresenterView.PresentationProxy(2,l,x,F,R)}this.xzb.startPresentation();this.xzb.subscribe(Object(D.a)(this,this.Lmk,"onPresentationChannelMessageHandler"))}return 32}catch(f){return ya.a.J(512496090,822,10,"PresenterViewManager: Failed to handle ShowPresenterView: {0}",f),16}}mDc(a,b,c){2===c&&(ya.a.J(512496089,822,50,"PresenterViewManager: ClosePresenterView called"),this.xzb.terminatePresentation());return 32}f4h(a){this.va.addHandler("OnPresenterViewSyncMessageReceived",
a)}h_k(a){a=this.D$h(a);this.xzb.sendMessage(a)}D$h(a){const b=new LL;b.sender="slideshow";b.messageType=1;b.data=JSON.stringify({["slideLocation"]:{["slideId"]:{["sid"]:a.slideId,["cid"]:0},["slideIndex"]:a.slideIndex},["timelineMappings"]:a.pmc});return b}Lmk(a){try{if(!a||0>=a.length)ya.a.J(512496088,830,15,"No message");else{var b=JSON.parse(a),c=b.sender;if(c&&"slideshow"!==c)switch(b.messageType||ya.a.J(512496087,830,15,"No message"),b.messageType){case 1:const l=b.data;if(l&&!(0>=l.length)){var f=
JSON.parse(l).slideLocation.slideIndex;this.va.raiseEvent("OnPresenterViewSyncMessageReceived",new KL({["SlideIndex"]:f}))}}}}catch(l){ya.a.J(512496086,830,10,"Exception: {0}",l)}}qzk(){var a=hb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;a=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",b,a);b=new yQ.a(u.AFrameworkApplication.He);this.m8=zQ.b(b.pHe(a));this.m8.then(c=>
{try{const f=JSON.parse(c),l=f.downloadUrl;Ma.a.Va(l)?ya.a.J(512496085,822,10,"PresenterViewManager: GetSnappedDownloadLink returned a bad response: {0}",f):this.jQ=l}catch(f){ya.a.J(512496084,822,10,"PresenterViewManager: Failed to retreive document download URL: {0}",f)}return null})}}Object(e.a)(OL,"PresenterViewManager",null,[321]);class WD{constructor(){this.vb=this.la=this.K=null;this.dJg=!1}get name(){return"PowerPointWebEditor.PresenterView"}Wb(a){this.K=a;this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.vb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").kG()}init(){u.AFrameworkApplication.fa.ff(Object(D.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){try{(this.dJg=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))&&this.K.resolve("Common.IDynamicScriptLoaderProvider").yv.loadScript("presenterView").catch(a=>ya.a.J(594031833,830,10,"Failed to load presenterView js: {0}",a)).then(()=>this.Nmk()).catch(a=>ya.a.J(594031831,830,10,"Failure in OnPresenterScriptLoaded: {0}",a))}catch(a){Z.ULS.sendTraceTag(594031830,
811,10,"PPTWebEditorPresenterViewPackage: exception in OnFullAppSettingsReady: {0}",a)}}Nmk(){this.lWb();return null}lWb(){const a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",u.AFrameworkApplication.fa.Ha("PPTPresenterViewCssUrl"));this.vb.appendChild(a);this.K.register(321,"PowerPointWebEditor.PresenterView.IPresenterViewManager").na(()=>new OL(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();
this.K.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager").ub()}dispose(){}static main(){m.a.instance.Ac(new WD)}}Object(e.a)(WD,"PPTWebEditorPresenterViewPackage",null,[2,3]);class PL{constructor(a){this.yca=a}$Ai(a,b,c){if(c.hPa())return null;a=this.yca.bBa(a,b,c);for(b=Array(b.$N);a.moveNext();){c=a.d_b();var f=a.Ez;b[f.ge]||(b[f.ge]=[]);f=b[f.ge];f[f.length]=$q.TableNodeContext.create(c)}a=[];for(c=0;c<b.length;++c)b[c]&&(a[a.length]=new $a.Selection(b[c],!0));return new md.SelectionCollection(a,
a.length-1,0)}}Object(e.a)(PL,"PPTSelectionFactory",null,[319]);class QL{constructor(a,b,c,f){this.Rke=this.Qka=this.cee=null;this.gWh=a;this.rIh=b;this.vq=c;this.eVa=f}get Bji(){return this.rIh}get yob(){this.cee||(this.cee=this.vq.bji(this.Bji,this.PX));return this.cee}get tableNode(){return this.gWh}get PX(){this.Qka||(this.Qka=this.eVa.create(this.tableNode));return this.Qka}get KLj(){this.Rke||(this.Rke=this.vq.eDj(this.yob,this.PX));return this.Rke}}Object(e.a)(QL,"TableCellSelectionInfo",null,
[]);class RL{constructor(a,b){this.eVa=a;this.vq=b}create(a,b){return new QL(b,a,this.vq,this.eVa)}}Object(e.a)(RL,"TableCellSelectionInfoFactory",null,[317]);var AQ=d(976);class SL{constructor(a,b,c){this.JPg=a;this.vq=b;this.dEa=c}C0b(a){let b=null;const c=new Date,f=({tableNode:a}=this.vq.i7f(a)).returnValue,l=!f.hPa();l&&(b=this.JPg.create(f,a),Mc.a.Cb&&Mc.a.Cb.Wa("CellRange",f.toString()));ya.a.J(512495623,808,l?50:10,"Table cell selection range {0}, took {1}",f.toString(),+new Date-+c);return b}Icj(a){if(!a)return null;
var b=this.dEa.jA(a);let c=a=null;for(let l=0;l<b.length;++l)if(b[l].Kk){var f=Object(va.a)(5,b[l].node);if(f){f=f.pK();if(!f)return null;if(!a)a=f,c=a.id.toString();else if(c!==f.id.toString())return null}}if(!a)return null;b=Object.assign(new hr.a,{ge:a.rowIndex,Yd:a.li});b.Wf=b.ge+1;b.Jf=b.Yd+1;return this.JPg.create(b,a.getContainingTable())}}Object(e.a)(SL,"TableSelectionAdapter",null,[318]);class XD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableMergeSplit"}Wb(a){this.K=
a;this.K.register(317,"PowerPointWebEditor.ITableCellSelectionInfoFactory").ma().na(()=>new RL(this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(318,"PowerPointWebEditor.ITableSelectionAdapter").ma().na(()=>new SL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionInfoFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Box4.ITableNavigator")));this.K.register(319,"PowerPointWebEditor.ISelectionFactory").ma().na(()=>new PL(this.K.resolve("PowerPointWebEditor.ICellIteratorFactory")));this.K.register(320,"PowerPointWebEditor.ITableMergeSplitEditor").ma().na(()=>new AQ.TableMergeSplitEditor(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Styles.ITableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableBorderHelper"),this.K.resolve("PowerPointWebEditor.IGraphUtils"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("Box4.ISelectionManager"),this.K.resolve("PowerPointWebEditor.ISelectionFactory")))}init(){}dispose(){}static main(){m.a.instance.Ac(new XD)}}Object(e.a)(XD,"PPTWebEditorTableMergeSplitPackage",null,[2,3]);class ll{constructor(a,b,c,f,l,x,F,R){this.cmb=a;this.VCd=b;this.Ca=c;this.TCd=f;this.jk=l;this.$s=x;this.Wc=F;this.GOh=R}ub(){this.Ybd(Gb.App.aJa.BRf())}Ybd(a){this.Ca.xa(C.a.ahc,Fb.a.view,a);this.Ca.xa(C.a.ahc,Fb.a.table,Object(D.a)(this,this.ahc,"queryTableStyle"));this.Ca.$d(C.a.ahc,
103);this.Ca.xa(C.a.u1,Fb.a.view,Object(D.a)(this,this.FOe,"tableStyleGenericViewActionHandler"));this.Ca.xa(C.a.u1,Fb.a.table,Object(D.a)(this,this.u1,"applyTableStyle"));this.Ca.$d(C.a.u1,6);this.Ca.xa(C.a.X2a,Fb.a.table,Object(D.a)(this,this.u1,"applyTableStyle"));this.Ca.xa(C.a.Jza,Fb.a.view,Object(D.a)(this,this.FOe,"tableStyleGenericViewActionHandler"));this.Ca.xa(C.a.Jza,Fb.a.table,Object(D.a)(this,this.Jza,"applyTableStyleOption"));this.Ca.$d(C.a.Jza,14);this.Ca.xa(C.a.bhc,Fb.a.view,a);this.Ca.xa(C.a.bhc,
Fb.a.table,Object(D.a)(this,this.bhc,"queryTableStyleOption"));this.Ca.$d(C.a.bhc,103);this.Ca.xa(C.a.Tec,Fb.a.view,a);this.Ca.xa(C.a.Tec,Fb.a.table,Object(D.a)(this,this.Tec,"populateMenuMoreTableStyles"));this.Ca.$d(C.a.Tec,102);this.Ca.xa(C.a.Sob,Fb.a.view,Object(D.a)(this,this.FOe,"tableStyleGenericViewActionHandler"));this.Ca.xa(C.a.Sob,Fb.a.table,Object(D.a)(this,this.Sob,"clearTableFormatting"));this.Ca.$d(C.a.Sob,4)}ahc(a,b,c,f,l){if(!({CE:a}=this.fkc(b,c,l,!0,!0)).returnValue)return a;this.VCd.gxi(l,
b.node);return 32}bhc(a,b,c,f,l){return this.kig(b,c,f,l,!0)}Tec(a,b,c,f,l){if(!({CE:a}=this.fkc(b,c,l,!1,!0)).returnValue)return a;this.VCd.nyi(l,b.node);Z.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}u1(a,b,c,f,l){if(!({CE:c}=this.fkc(b,c,l,!1,!0)).returnValue)return c;const x=b.node;let F=null;(F=a===C.a.u1?this.VCd.djd(l[ai.a.SourceControlId],x):null)?(this.Sxe(x,()=>{this.TCd.B5k(F,x)}),c=32):c=8;a===C.a.u1&&32===c&&Z.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");
Z.ULS.shipAssertTag(541172699,324,32===c);return c}Jza(a,b,c,f,l){return this.kig(b,c,f,l,!1)}kig(a,b,c,f,l){if(!({CE:b}=this.fkc(a,b,f,l,!0)).returnValue)return b;a=a.node;b=this.cmb.TZd(a);const x=f[ai.a.On],F=ll.Kej(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp?f.MenuItemId:f[ai.a.SourceControlId]);l?f[ai.a.On]=ll.p$k(b,F):(this.D9h(b,F,x,a),c.pP=F,c.P6=x?0:1,Z.ULS.shipAssertTag(541172700,324,0!==F));return 32}FOe(a,b,c,f,l){return bi.r4(a,b,c,f,l,{},14)}Sxe(a,b){const c=this.jk.je(15);
try{c.fd(a),this.$s.kXa(),b()}finally{c&&c.dispose()}}fkc(a,b,c,f,l){return this.sOj(a,b,c,f,l)?{returnValue:f||2===b,CE:32}:{returnValue:!1,CE:8}}sOj(a,b,c,f,l){if(a.contextId!==Fb.a.table)return!1;if(f||2===b)if(l&&!c||!Object(Fa.a)(py.a,a.node)||this.GOh(a.node))return!1;return!0}D9h(a,b,c,f){const l=(512===b||1024===b?!c:c)?a|b:a&~b;l!==a&&this.Sxe(f,()=>{this.TCd.e3k(l,f)})}Sob(a,b,c,f,l){if(!({CE:a}=this.fkc(b,c,l,!1,!1)).returnValue)return a;const x=b.node;this.Sxe(x,()=>{this.TCd.eni(x)});
return 32}static Xq(){ll.qMa[ll.nSi]=32;ll.qMa[ll.iSi]=128;ll.qMa[ll.yRj]=64;ll.qMa[ll.qRj]=256;ll.qMa[ll.Xai]=512;ll.qMa[ll.Wai]=1024}static p$k(a,b){a=!!(a&b);if(512===b||1024===b)a=!a;return a}static Kej(a){let b=0;a in ll.qMa&&(b=ll.qMa[a]);return b}}ll.nSi="buttonFirstRow";ll.iSi="buttonFirstColumn";ll.yRj="buttonLastRow";ll.qRj="buttonLastColumn";ll.Xai="buttonBandedRow";ll.Wai="buttonBandedColumn";ll.qMa={};Object(e.a)(ll,"TableStyleActor",null,[]);ll.Xq();class yp{constructor(a){this.oda=
a}B5k(a,b){a=this.oda.x0b(a);yp.jNf(b);b.setValue(ub.a.RIa,lh.a.Yf(a.uua.styleIdField))}e3k(a,b){b.setValue(ub.a.Alc,a)}eni(a){yp.jNf(a);a.removeProperty(ub.a.RIa)}static jNf(a){if(a=Object(va.a)(Lz.TableNode,a)){a=a.D0b();for(const c of a){if(c.cellShading){var b=Ri.b(c.cellShading);b?(a=b,Jx(a),a&&(a.cell3DField=null,a.extLstField=null,a.lnBField=null,a.lnBlToTrField=null,a.lnLField=null,a.lnRField=null,a.lnTField=null,a.lnTlToBrField=null),c.cellShading=b):ya.a.J(22078240,822,15,"Encountered null cell shading.")}for(const f of yp.oci){let l;
({nNa:b,k3a:a,Pnb:l}=Xp.jQa(f));c.removeProperty(a);c.removeProperty(b);c.removeProperty(l)}yp.Dmi(Object(va.a)(ag.a,c))}}else ya.a.J(587531030,822,10,"Casting of GraphNode to ITableNode is null")}static Dmi(a){const b=new yF.a;b.set(a);for(a=b.zb(1);a;){for(a=b.zb(2);a;)12===a.type&&yp.Emi(a),a=b.wj(2);a=b.wj(1)}}static Emi(a){if(a.Ra&&0<a.Ra.length)for(let b=0;b<a.Ra.length;b++)a.Ra.ga(b)&&yp.Fmi(a.Ra.ga(b))}static Fmi(a){if(a=a.formatting){const f=a.paragraph.Ch;if(f){var b=a.sz,c=!1;if(b){for(let l=
0;l<yp.bGe.length;l++)b.Sa(yp.bGe[l])&&(c||(c=!0,b=b.clone()),b.removeProperty(yp.bGe[l]));c&&(b=f.sHa(b),a.Sl=b.id)}}}}}yp.bGe=[bb.a.font,ub.a.latinFont,ub.a.eastAsianFont,ub.a.complexScriptFont,ub.a.WHb,bb.a.fontColor,bb.a.bold,bb.a.italic,ub.a.schemeColor];yp.oci=[5,6,7,0];Object(e.a)(yp,"PPTTableStyleEditor",null,[383]);class YD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableStyleEditor"}Wb(a){this.K=a}init(){(new ll(this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("Box4.TableEditors.ITableStyleRibbonControls"),
this.K.resolve("Common.IActionManagerExtended"),new yp(this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager")),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,()=>!1)).ub()}dispose(){}static main(){m.a.instance.Ac(new YD)}}Object(e.a)(YD,"PPTWebEditorTableStyleEditorPackage",null,[2,3]);class ZD{constructor(a,b,c){this.zqe=0;this.bje=!1;this.Bk=a;
this.Tw=b;this.ra=c;this.Bk.iCf(Object(D.a)(this,this.vHf,"beforeForceOutboundGraphTransactionInitialize"));this.Bk.Aza(Object(D.a)(this,this.xgg,"graphTransactionDisposed"));this.Tw.ppa(Object(D.a)(this,this.YVa,"onBeforeValidatePersistence"))}dispose(){this.Bk.Hch(Object(D.a)(this,this.vHf,"beforeForceOutboundGraphTransactionInitialize"));this.Bk.YWa(Object(D.a)(this,this.xgg,"graphTransactionDisposed"));this.Tw.Qhc(Object(D.a)(this,this.YVa,"onBeforeValidatePersistence"))}vHf(){this.zqe++}YVa(){0<
this.zqe&&(this.bje=!0)}xgg(){if(!(0<--this.zqe)&&this.bje){this.bje=!1;var a=Mc.a.Cb;if(a){const b=this.ra.ae();let c=0;for(const f of b)f.FK&&c++;a.Wa("ShapeCount",b.length.toString());a.Wa("SupportSVGCount",c.toString())}}}}Object(e.a)(ZD,"SVGShapeTelemetry",null,[106]);class $D{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Telemetry"}Wb(a){this.K=a;this.K.register(ZD,"PowerPointWebEditor.Telemetry.SVGShapeTelemetry").ma().na(()=>new ZD(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").Bd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))}init(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry")}dispose(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry").dispose()}static main(){m.a.instance.Ac(new $D)}}Object(e.a)($D,"PPTWebEditorTelemetryPackage",null,[2,3]);class Oz{}Oz.E7g="faProofing";Object(e.a)(Oz,"ContextMenuControlId",null,[]);class aE{constructor(a,b,c,f,l,x,F){this.mM=b;this.jQb=a;
this.Asc=b.LEj;this.Vsc=b.e$d;this.UNh=x;this.isc=f;this.jsc=l;this.TKa=c;this.IO=F;this.PKa=new Xb.a;this.PKa.$(1,"SpellingIssue_16x16x32");this.PKa.$(2,"GrammarIssue_16x16x32");this.PKa.$(3,"WritingIssue_16x16x32");this.PKa.$(4,null);this.PKa.$(0,null)}create(a,b,c){b=Object(va.a)(Hp.a,b);if(!b)return Z.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const f=new Sys.StringBuilder;a=this.N$f(a);this.AWb(f,b,c,a);this.OOd(f,b);this.uzi(f,b,a);return f.toString()}au(a,b,c){b=
Object(va.a)(Hp.a,b);if(!b)return Z.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];const f=[];a=this.N$f(a);this.sPd(f,b,c,a);this.POd(f,b);this.vzi(f,b,a);return f}AWb(a,b,c,f=null){0===b.errorType?a.append(this.jQb.build()):1===b.errorType&&(this.$Oa(b)||a.append(this.SJd(b,c,f)))}sPd(a,b,c,f=null){0===b.errorType?a.push(this.jQb.LIf()):1===b.errorType&&(this.$Oa(b)||a.push(this.zdi(b,c,f)))}OOd(a,b){if(!H.a.instance.ga(92)){const c=new Sys.StringBuilder;this.xqh(b)?c.append(ej.a("btnIgnoreAllSpellingError",
(2===b.errorType?C.a.hld:C.a.F4d).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.$Oa(b)||c.append(ej.a("btnIgrnoreSpellingError",this.o$f(b.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.Bqh(b)&&(this.mM.i8d&&c.append(ej.a("btnDoNotCheckForThisIssue","2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),c.append(ej.a("btnGrammarOptions","3380187414",Ma.a.ie(Box4Intl.Box4Strings.l_GrammarOptions),null)));c.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),
a.append(c.toString()),a.append("</Controls></MenuSection>"))}}POd(a,b){if(!H.a.instance.ga(92)){const f=Object.assign(new Si.a,{ControlList:[]});if(this.xqh(b)){var c=Object.assign(new Of.a,{ExternalId:2===b.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});Array.add(f.ControlList,c)}else this.$Oa(b)||(c=Object.assign(new Of.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.o$f(b.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),Array.add(f.ControlList,
c));this.Bqh(b)&&(this.mM.i8d&&(b=Object.assign(new Of.a,{ExternalId:"DoNotCheckForThisIssue",Command:"2157977488",LabelText:Box4Intl.Box4Strings.l_DoNotCheckForThisIssue}),Array.add(f.ControlList,b)),b=Object.assign(new Of.a,{ExternalId:"GrammerSettingsContext",Command:"3380187414",LabelText:Box4Intl.Box4Strings.l_GrammarOptions}),Array.add(f.ControlList,b));a.push(f)}}N$f(a){if(!this.IO)return null;a=this.IO.language(this.IO.Bs(a.Ua));return sa.a.le(a).name}o$f(a){return 2===a?C.a.hld:this.mM.Gtg?
C.a.HPc:C.a.Kra}uzi(a,b,c=null){if(this.tKe(b)){var f=Ma.a.ie(b.GM.CategoryTitle);f=ej.j(Oz.E7g,G.a.gnb,this.PKa.ga(b.proofingType),""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.isc,this.jsc);f=ej.c("cgProofingOuter",[f]);a.clear();a.append(ej.e("msProofingOuter",f,"Menu16",void 0,void 0,c,"ariaLabelledById"));Z.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}vzi(a,b,c=null){if(this.tKe(b)){var f=
Ma.a.ie(b.GM.CategoryTitle);c=Object.assign(new Zm.a,{ExternalId:String.format("{0}_{1}",Oz.E7g,b.proofingType),Command:"798637440",Image16by16Class:this.PKa.ga(b.proofingType),LabelText:""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:c,Menu:Object.assign(new sk.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.XXi(b),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(c.Menu.MenuSectionList,
a);Array.clear(a);f=Object.assign(new Si.a,{ControlList:[]});Array.add(f.ControlList,c);a.push(f);Z.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}SJd(a,b,c=null){const f=this.s2i(a);var l=[];let x=!1;var F=a.GM.Suggestions;if(F)if(F=F.slice(0,Math.min(3,F.length)),this.Asc&&(x=!Pa.a.any(F,R=>!R||!R.Description)),1===F.length&&0===F[0].Action)b=Ma.a.ie(F[0].Text),l.push(ej.a("btnCorrectWord0","3587447601",b,null,null,null,null,null,
null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,f,b)));else{let R=0,fa=null;x&&(fa="font-weight: bold;");for(const wa of F){if(!wa)continue;F=null;let Xa="",lb=Ma.a.ie(wa.Text);x&&(F=this.Q6f(wa.Description),Xa=this.P6f(wa.Description));l.push(ej.a("btnCorrectWord"+R,b[R].toString(),lb,null,null,null,null,null,fa,null,F,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,f,lb),"ariaLabelledById",
String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.DQf(a.token)),"ariaDescribedById",Xa));R++}}b="Menu16";0<l.length?x&&(b="Menu16DescriptionEnabled"):l=[ej.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)];return ej.e("msUnknownWord",ej.c(null,l),b,f,this.Q6i(a),c,"ariaLabelledById")}zdi(a,b,c=null){var f=1!==a.proofingType&&0!==a.proofingType?a.GM.ExplanationTitle:"";f=Object.assign(new Si.a,{Title:f,Lang:c,ControlList:[]});let l=
!1;var x=a.GM.Suggestions;if(x)if(x=x.slice(0,Math.min(3,x.length)),this.Asc&&(l=!Pa.a.any(x,F=>!F||!F.Description)),1===x.length&&0===x[0].Action)a=x[0],a=Object.assign(new Of.a,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:a.Text}),Array.add(f.ControlList,a);else{let F=0;for(const R of x){if(!R)continue;x=null;let fa="";l&&(x=this.Q6f(R.Description),fa=this.P6f(R.Description));if(F>=b.length)break;x?(x=Object.assign(new kB,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",
F,a.proofingType),Command:b[F].toString(),LabelText:R.Text,Description:x,Lang:c,AriaDescription:fa}),Array.add(f.ControlList,x)):(x=Object.assign(new Of.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",F,a.proofingType),Command:b[F].toString(),LabelText:R.Text,Lang:c,RoleInMenu:"menuitem"}),Array.add(f.ControlList,x));F++}}0>=f.ControlList.length&&Array.add(f.ControlList,Object.assign(new Of.a,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));
return f}s2i(a){return Ma.a.ie(1!==a.proofingType&&0!==a.proofingType?a.GM.ExplanationTitle:"")}Q6i(a){return this.tKe(a)?null:this.PKa.ga(a.proofingType)}tKe(a){return this.Vsc&&2!==a.errorType&&(1!==a.errorType||!this.$Oa(a))}xqh(a){return this.UNh&&0!==a.errorType&&1===a.proofingType&&!this.$Oa(a)}XXi(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.DQf(a.token)):""}Bqh(a){return this.mM.YRa&&this.Vsc&&1===a.errorType&&(2===
a.proofingType||3===a.proofingType)}$Oa(a){return 0!==a.errorType&&!!this.TKa&&this.TKa.contains(a.token,a.lcid)}Q6f(a){return""===a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}P6f(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,a):""}DQf(a){let b="";if(a){let c;for(c=0;c<a.length-1;c++)b=b+a.charAt(c)+",";b+=a.charAt(c)}return b}}Object(e.a)(aE,"EditorServiceProofingContextMenuCreator",null,[]);class Bq{b$(a,b){this.Kii&&this.Yal(a,
b,Bq.DSg,Bq.kb)}Yal(a,b,c,f){switch(c){case 1:case 6:case 2:case 3:case 4:case 5:Bq.hJi.show(f,a,b)}}BSg(){switch(Bq.DSg){case 5:case 1:return!0;default:return!1}}get Kii(){return 1!==Gb.App.Fb.state}static get hJi(){return Bq.t0e||(Bq.t0e=hb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static R6i(a){if(!a)return 0;if(2===Gb.App.Fb.mode)if(H.a.instance.ga(17)&&1===a.length&&Ui.OutlineReader.e4b(a.Ua)&&Gb.App.Fb.Ed.en&&Gb.App.Fb.Ed.en.So){if(a=mb.GraphIterator.mb(a.Ua.node),a.uv(),!ph.b(a))return 5}else{const b=
a.Ua.node;let c=mb.GraphIterator.mb(b);c.uv();return Rt.e(c.currentNode)?2:u.AFrameworkApplication.Jhb||!eb.EmbeddedFileReader.c8a(b)||eb.EmbeddedFileReader.O2(b)?a.Ua.contextId===Fb.a.iFrame||CI(a.Ua)?6:1:3}else return 4;return 0}static get kb(){return ld.a.instance.Oa.kb}static get DSg(){return Bq.R6i(Bq.kb)}}Bq.t0e=null;Object(e.a)(Bq,"SelectionContextMenuProvider",null,[231]);class TL{constructor(a){this.la=a}LVd(a,b,c,f,l){const x=c?u.AFrameworkApplication.Vl:"";c=c?kq.getImageClass(c):"";return String.format('<FlyoutAnchor Id="{0}" Command="{1}" Image16by16="{2}" \r\n              Image16by16Class="{3}" LabelText="{4}"> {5} </FlyoutAnchor>',
a,b,x,c,Ma.a.ie(f),l)}menu(a,b){return String.format('<Menu Id="{0}"> {1} </Menu>',a,b)}menuSection(a,b){return String.format('<MenuSection Id="{0}" DisplayMode="Menu16"><Controls> {1} </Controls></MenuSection>',a,b)}HAi(){let a=ResourceStrings.l_ContextMenuSmartLookup;var b=(new dx.a).getSelectedText();b=(b=b.neighborhood.substr(b.mentionStart,b.mentionLength))?b.trim():null;let c=20;b&&0<b.length&&(b.length>c&&(c=Ma.a.Mw(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b);b&&0<b.length&&(a=String.format(ResourceStrings.l_ContextMenuTextSmartLookup,
b));return a}Vki(){var a=(new dx.a).getSelectedText();a=a.neighborhood.substr(a.mentionStart,a.mentionLength);return!(a&&0<a.trim().length)}XAi(){let a=ResourceStrings.l_SynonymsSerpletContextMenu;var b=(new dx.a).getSelectedText();b=b.neighborhood.substr(b.mentionStart,b.mentionLength);if(!b)return a;b=b.trim();let c=14;0<b.length&&(b.length>c&&(c=Ma.a.Mw(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b,a=String.format(ResourceStrings.l_ContextMenuTextSynonyms,b));return a}}Object(e.a)(TL,"ContextMenuHelper",
null,[237]);class Nx extends Xu{constructor(a,b,c,f){super(a,c);this.ODg=b;this.lTa=f}iKc(a){let b=null,c=!1;var f=ld.a.instance.Oa.kb;f=hb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu").n3d(f,a);switch(this.lTa){case 7:b=["Picture","Comment"];c=!0;break;case 15:case 6:case 10:case 5:b=["Shape","Comment"];c=!0;break;case 8:b=["SmartArtStylesOptions","Comment"];c=!0;break;case 13:case 11:b=["SVG","Comment"];c=!0;break;default:const l=!!this.ODg&&this.ODg.jwg("1898844988"),x=hb.a.instance.resolve("Box4.ISelectionContextMenuProvider").BSg(),
F=u.AFrameworkApplication.fa.ka("PPTOTableCellBordersEnabled");l?b=F?3===a&&f?"Paste FontFormatting Table TableStyle Comment ContextMenu".split(" "):["FontFormatting","Table","TableStyle","Comment"]:3===a&&f?["Paste","FontFormatting","Table","Comment","ContextMenu"]:["FontFormatting","Table","Comment"]:x&&(b=3===a&&f?["Paste","FontFormatting","Comment","ContextMenu"]:["FontFormatting","Comment"])}3===a&&f&&c&&b.push("ContextMenu");return b}static fxj(a,b,c,f){a.Hbi(()=>Nx.vsi(b,c,f))}static vsi(a,
b,c){return new Nx(a,b,c,0)}}Object(e.a)(Nx,"PowerPointReactFloatie",Xu,[]);class UL{constructor(a,b){this.SEg=b;this.Tee=a}dispose(){}uF(){}BGi(){this.Tee.sqa()}P4(a,b,c,f){this.SEg.okh(f);this.Tee.P4(a,b,c)}Zal(a,b,c,f){14===f?this.P4(a,b,c,f):(this.SEg.okh(f),a=new Nx(hb.a.instance.pb("Common.IReactContextualUILauncher"),Gb.App.YC.VR,hb.a.instance.pb("Common.IExternalUICommandDefinitionMapping"),f),this.Tee.$gd(b,c,a,hb.a.instance.pb("Box4.ISelectionContextMenuProvider")))}}Object(e.a)(UL,"ReactContextMenuUser",
null,[235]);class VL{constructor(){this.whitelistedControlIds=this.l$=this.HF=null;this.bQj=!1;this.W1k=this.Sma=this.Ush=null}}Object(e.a)(VL,"ReactStatusBarInitOptions",null,[]);class XL{constructor(){this.whitelistedControlIds=null}}Object(e.a)(XL,"StatusBarProps",null,[]);class yv{constructor(a,b,c=!0){this.Szd=!1;this.Eqf=null;this.p2a=b.HF;this.zvf=b.Ush;c?pd.a.get_instance().Xj(7,()=>{this.vBc(a,b)}):this.vBc(a,b)}vBc(a,b){const c={};c.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>
{c.FirstTimeoutCallbackExecutionStartTime=Date.now();nc.a.instance.wF(()=>{yj.UISurfaces.Fdj().then(f=>{c.StatusBarApiResolutionTime=Date.now();const l=Object.assign(new XL,{whitelistedControlIds:b.whitelistedControlIds});f.initializeNewStatusBar(a,l,this.zvf);this.Eqf=f;this.Szd=!0;c.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{c.SecondTimeoutCallbackExecutionStartTime=Date.now();nc.a.instance.wF(()=>{const x=[];if(b.l$){const F=b.l$;for(let R in F)x.push(appChrome.actions.updateControlHiddenState(R,
F[R]));appChrome.api.dispatch(x)}c.PollingStartTime=Date.now();this.uF();c.PollingEndTime=Date.now();Z.ULS.sendTraceTag(509748573,813,50,JSON.stringify(c))},"RSB:I2")},0);return null}).catch(()=>{Z.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(b.Sma&&a){yv.T3e||(u.AFrameworkApplication.Ta.xa(G.a.Wsh,de.a.frame,Object(D.a)(this,this.Xsh,"statusBarTabAction")),u.AFrameworkApplication.Ta.xa(G.a.Vsh,de.a.frame,Object(D.a)(this,this.Xsh,"statusBarTabAction")),
yv.T3e=!0);const f=Fr.a.G5d(b.Sma,b.W1k,a,!1);f.IK=!0;this.eEb(f,G.a.Wsh,G.a.Vsh)}},0)}uF(){this.Szd&&this.p2a&&window.setTimeout(()=>{this.p2a(this.Eqf.selectors.getStatusBarControlsMap(this.zvf),7)},0)}I4(a,b){this.Szd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(a,b))},0)}eEb(a,b,c){const f=A.KeyInputManager.Na(w.a.Bq,0),l=A.KeyInputManager.Na(w.a.Bq,4);a.$o(f);a.$o(l);a.bindAction(f,b);a.bindAction(l,c)}Xsh(){return 4}}yv.T3e=!1;Object(e.a)(yv,"ReactStatusBar",
null,[]);class bE{constructor(a,b,c,f,l,x,F,R,fa){this.Dzb=null;this.i3c={};this.$b=R;this.qAb=a;this.tm=l;this.T6j=x;this.J8j=F;this.dTa=f||new PG.a;this.gh=this.dTa.aPd(3,"StatusBarUser");this.lZj=fa;a=()=>{this.vBc();this.dTa.IVc(3)};this.i3c.callbackRegisterTime=Date.now();ee.a("StatusBarTTVRImprovementEnabled")&&Object(Fa.a)(109,this.$b)?this.$b.Ztb(a):this.$b.ff(a);this.aMg=c;this.aMg.$F(Object(D.a)(this,this.Fdc,"onSlidesTopologyChanged"))}dispose(){this.aMg.iO(Object(D.a)(this,this.Fdc,"onSlidesTopologyChanged"))}vBc(){this.i3c.callbackExecutionStartTime=
Date.now();const a=this.gh.Zt("createStatusBar"),b=new VL;b.l$=this.M$i();b.bQj=!1;b.HF=Object(D.a)(this,this.Bwl,"updateStatusBarControls");b.Ush="PptEditingStatusBar";ee.a("ReactStatusBarRTLSupport")&&u.AFrameworkApplication.isRtl&&this.qAb&&(this.qAb.style.direction="rtl");ee.a("StatusBarTTVRImprovementEnabled")?this.lZj.Xj(5,()=>{this.Dzb=new yv(this.qAb,b,!1)}):this.Dzb=new yv(this.qAb,b);this.gh.gu(a);this.i3c.callbackExecutionEndTime=Date.now();ya.a.J(512313048,813,50,JSON.stringify(this.i3c))}uF(){this.Dzb&&
this.Dzb.uF()}I4(a,b){this.Dzb&&this.Dzb.I4(this.zsb(a),!b)}zsb(a){const b=this.T6j.uYd(a);return b&&0<b.count?b.ga(0):a}Fdc(a,b){2===b.PY&&this.uF()}Bwl(a){Gb.App.Fb&&Gb.App.Fb.HF(a)}M$i(){const a=this.J8j.igj(),b={};for(const c of Object.keys(a))b[this.zsb(c)]=a[c];u.AFrameworkApplication.fa.ka("FeedbackPaneExperienceIsEnabled")&&u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(b[this.zsb("PptEditingStatusBar.GiveFeedbackPane")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.zsb("PptEditingStatusBar.GiveFeedback")]=
!0):(b[this.zsb("PptEditingStatusBar.GiveFeedback")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.zsb("PptEditingStatusBar.GiveFeedbackPane")]=!0);return b}}bE.Grc=null;Object(e.a)(bE,"ReactStatusBarUser",null,[313,234]);class YL{constructor(a){this.la=a}igj(){const a={};this.la.tub||(a["PptEditingStatusBar.ZoomScale"]=!0,a["PptEditingStatusBar.FitToWindow"]=!0);this.la.NDb||(a["PptEditingStatusBar.LanguageButton"]=!0);this.la.Rra||(a["PptEditingStatusBar.AddInCommandsLoadStatus"]=!0);this.la.officeOnlineInGallatinTextVisible||
(a["PptEditingStatusBar.MiddleStatus"]=!0);this.la.Cph||(a["PptEditingStatusBar.PerfStats"]=!0);this.la.vg&&(a["PptEditingStatusBar.Reading"]=!0);u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")||(a["PptEditingStatusBar-SlideSorterView"]=!0);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")||(a["PptEditingStatusBar-PresenterView"]=!0);return a}}Object(e.a)(YL,"StatusBarUserHelper",null,[233]);class cE{constructor(){this.vsf=null}get ygh(){return this.vsf||(this.vsf=hb.a.instance.pb("Common.IRootManager"))}ub(){}we(){}vyg(){}IVk(){this.ygh&&
this.ygh.MDc()}}Object(e.a)(cE,"ABox4BridgeCommandUi",null,[236,106]);class ZL extends cE{constructor(a,b,c,f){super();this.bEg=a;this.FD=b;this.ia=c;this.i2c=f}HF(a){Object(va.a)(308,this.FD).jJb(a)}x0(a){return 32===this.ia.Ka(ba.a.x0,2,a)}Lvk(){this.bEg.clearCache();this.FD.uF()}rJb(){this.FD.rJb()}xFe(a){a?a(this.i2c.sqa()):this.i2c.sqa()}jwg(a){return this.bEg.z4b(a)}vyg(){const a=Object(va.a)(308,this.FD);a&&a.MRj()}dispose(){}}Object(e.a)(ZL,"Box4BridgeCommandUi",cE,[]);var dE=d(1190);class jr{static get H6(){return jr.F5||
(jr.F5=hb.a.instance.resolve("Box4.IContextMenuController"))}static showContextMenu(a,b){jr.H6.showContextMenu(a,b)}static P4(a,b,c){jr.H6.P4(a,b,c)}static Zgd(a,b,c,f=null){jr.H6.Zgd(a,b,c,f)}}jr.F5=null;Object(e.a)(jr,"BaseContextMenu",null,[]);class zp extends Xw{constructor(){super();this.nFd();this.UFd()}nFd(){this.addCommandToMaps(Object.assign(new Va.a("AlignCenter","4284004393"),{legacyControlId:"CenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Va.a("AlignLeft",
"2539120357"),{legacyControlId:"LeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Va.a("AlignRight","393413924"),{legacyControlId:"RightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableTopLeft","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableTopCenter","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));
this.addCommandToMaps(Object.assign(new Va.a("AlignTableTopRight","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableCenterLeft","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableCenter","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableCenterRight",
"4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableBottomLeft","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableBottomCenter","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableBottomRight","719753309"),{legacyControlId:"TableCellJustifyBottomRight",
queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableTopLeft_MLR","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableTopCenter_MLR","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableTopRight_MLR","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));
this.addCommandToMaps(Object.assign(new Va.a("AlignTableCenterLeft_MLR","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableCenter_MLR","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableCenterRight_MLR","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableBottomLeft_MLR",
"12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableBottomCenter_MLR","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Va.a("AlignTableBottomRight_MLR","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Va.a("ApplyStyle","1040747875"),{queryCommandId:"3123760305",
populationProps:new Og("681481568",!1),previewControlIds:["buttonStyle0","buttonStyle1","buttonStyle2","buttonStyle3","buttonStyle4"]}));this.addCommandToMaps(Object.assign(new Va.a("AutoCorrectOptions","880879461"),{legacyControlId:"fseaOpenAutoCorrectOptionsDialog"}));this.addCommandToMaps(Object.assign(new Va.a("AutomaticFontColor","3491966299"),{legacyControlId:"fontColor"}));this.addCommandToMaps(Object.assign(new Va.a("Bold","4143129361"),{legacyControlId:"fsbcBold",queryCommandId:"1465813983"}));
this.addCommandToMaps(Object.assign(new Va.a("BulletLibrary","3552651681"),{queryCommandId:"3827179399",populationProps:new Og("2466004410",!1)}));this.addCommandToMaps(Object.assign(new Va.a("BulletNone","3552651681"),{queryCommandId:"990335323",menuItemId:"BulletStyleBulletsLibrary_0"}));this.addCommandToMaps(Object.assign(new Va.a("CellShading","2765388691"),{legacyControlId:"cellShadingColor",populationProps:new Og("462656847",!1)}));this.addCommandToMaps(Object.assign(new Va.a("ClearFormatting",
"2319895756"),{legacyControlId:"fseaClearFormatting"}));this.addCommandToMaps(Object.assign(new Va.a("ClearShadingColor","3275596206"),{legacyControlId:"clear"}));this.addCommandToMaps(new Va.a("ClearStyleFormatting","2319895756"));this.addCommandToMaps(Object.assign(new Va.a("ClearTableFormatting","3835123874"),{legacyControlId:"fseaClearTableFormatting"}));this.addCommandToMaps(Object.assign(new Va.a(zp.yui,"3383614517"),{legacyControlId:"fseaCopy"}));this.addCommandToMaps(Object.assign(new Va.a(zp.GCi,
"2309168610"),{legacyControlId:"fseaCut"}));this.addCommandToMaps(Object.assign(new Va.a("DecreaseIndent","3376107472"),{legacyControlId:"fseaOutdent",queryCommandId:"1599543798"}));this.addCommandToMaps(Object.assign(new Va.a("DeleteColumn","2983091615"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Va.a("DeleteRow","1368263559"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Va.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));
this.addCommandToMaps(Object.assign(new Va.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",populationProps:new Og("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Va.a("DictationFloatieToggle","1394650145"),{legacyControlId:"btnDictationFloatieToggle",queryCommandId:"2417470717"}));this.addCommandToMaps(Object.assign(new Va.a("DictationSettingsLanguages","3662249320"),{queryCommandId:"569982264",populationProps:new Og("3836866597",!0)}));this.addCommandToMaps(new Va.a("DictationSettingsHelp",
"3819824931"));this.addCommandToMaps(new Va.a("DictationSettingsHelpShowCommands","2729830074"));this.addCommandToMaps(Object.assign(new Va.a("DictationSettingsAutoPunctuation","992784617"),{queryCommandId:"1118940415"}));this.addCommandToMaps(Object.assign(new Va.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Va.a("EditingView","329275380"),{legacyControlId:"btnEditOnWeb",queryCommandId:"214409533"}));this.addCommandToMaps(Object.assign(new Va.a("EditTableAltText",
"868579142"),{legacyControlId:"btnTableAltText"}));this.addCommandToMaps(Object.assign(new Va.a("FlipHorizontal","2545543284"),{legacyControlId:"buttonFlipHorizontal",menuItemId:"buttonFlipHorizontal"}));this.addCommandToMaps(Object.assign(new Va.a("FlipVertical","2545543284"),{legacyControlId:"buttonFlipVertical",menuItemId:"buttonFlipVertical"}));this.addCommandToMaps(Object.assign(new Va.a("FontColor","1970784898"),{legacyControlId:"fontColor",populationProps:new Og("2077552168",!1)}));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")?
(this.addCommandToMaps(Object.assign(new Va.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Og("179506844",!1),commandPreviewId:"2655634065",commandRevertId:"1138852411"})),this.addCommandToMaps(Object.assign(new Va.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462",commandPreviewId:"1666858098",commandRevertId:"1250696292"}))):(this.addCommandToMaps(Object.assign(new Va.a("FontName","3430668515"),{legacyControlId:"fontName",
queryCommandId:"1223894949",populationProps:new Og("179506844",!1)})),this.addCommandToMaps(Object.assign(new Va.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462"})));this.addCommandToMaps(Object.assign(new Va.a("FormatPainter","2458503775"),{legacyControlId:"fseaFormatPainter",queryCommandId:"2544399836"}));this.addCommandToMaps(Object.assign(new Va.a("GrammarSettings","3380187414"),{legacyControlId:"btnGrammarSettings"}));this.addCommandToMaps(Object.assign(new Va.a("GrowFontSize",
"286819199"),{legacyControlId:"fseaGrowFontSize"}));this.addCommandToMaps(Object.assign(new Va.a("Highlighter","1784019754"),{legacyControlId:"fontBackgroundColor"}));this.addCommandToMaps(new Va.a("HighlighterColor","1784019754"));this.addCommandToMaps(Object.assign(new Va.a("ImmersiveReader","1925081555"),{legacyControlId:"btnImmersiveMode"}));this.addCommandToMaps(Object.assign(new Va.a("IncreaseIndent","4073520836"),{legacyControlId:"fseaIndent",queryCommandId:"2667230914"}));this.addCommandToMaps(Object.assign(new Va.a("IndentFirstLine",
"682091331"),{legacyControlId:"buttonSpecialIndentFirstLine",queryCommandId:"1728659747"}));this.addCommandToMaps(Object.assign(new Va.a("IndentHanging","4114875119"),{legacyControlId:"buttonSpecialIndentHanging",queryCommandId:"4115573199"}));this.addCommandToMaps(Object.assign(new Va.a("IndentLeft","3058254979"),{legacyControlId:"spnIndentBefore",queryCommandId:"2987841675"}));this.addCommandToMaps(Object.assign(new Va.a("IndentNone","3839386673"),{legacyControlId:"buttonSpecialIndentNone",queryCommandId:"738769293"}));
this.addCommandToMaps(Object.assign(new Va.a("IndentRight","1217598046"),{legacyControlId:"spnIndentAfter",queryCommandId:"3085515826"}));this.addCommandToMaps(Object.assign(new Va.a("InsertAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Va.a("InsertBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Va.a("InsertCameraPicture","2935789186"),{legacyControlId:"fseaInsertCameraPicture"}));this.addCommandToMaps(Object.assign(new Va.a("InsertEmoji",
"2994090608"),{legacyControlId:"flyInsertEmojis",queryCommandId:"35811376",populationProps:new Og("1124716226",!0)}));this.addCommandToMaps(Object.assign(new Va.a("InsertLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Va.a("InsertRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(Object.assign(new Va.a("InsertLink","2711544537"),{legacyControlId:"fseaInsertHyperlink"}));this.addCommandToMaps(Object.assign(new Va.a("InsertPicture",
"2670646631"),{legacyControlId:"fseaInsertPicture"}));this.addCommandToMaps(Object.assign(new Va.a("InsertOnlinePicture","1685987254"),{legacyControlId:"fseaFlyInsertOnlinePictureFromSearch"}));this.addCommandToMaps(Object.assign(new Va.a("InsertPictureFromHost","720118144"),{legacyControlId:"fseaFlyInsertOnlinePictureFromHost",queryCommandId:"3612507612"}));let a;this.addCommandToMaps((a=new Va.a("InsertSymbol","3471878106"),a.legacyControlId="flyInsertSymbols",a.populationProps=new Og("1256496096",
!0),a));let b;this.addCommandToMaps((b=new Va.a("InsertTable","975293073"),b.legacyControlId="flyInsertTable",b));let c;this.addCommandToMaps((c=new Va.a("Italic","3569444222"),c.legacyControlId="fsbcItalic",c.queryCommandId="4231335074",c));let f;this.addCommandToMaps((f=new Va.a("Justify","1733835213"),f.legacyControlId="FullJustify",f.queryCommandId="1257252315",f));let l;this.addCommandToMaps((l=new Va.a("LeftToRightTextDirection","927903232"),l.legacyControlId="TextDirLTR",l.queryCommandId="1154761034",
l));let x;this.addCommandToMaps((x=new Va.a("LineSpacing","2222099814"),x.legacyControlId="flyLineSpacing",x.populationProps=new Og("2818132660",!0),x));let F;this.addCommandToMaps((F=new Va.a("LineSpacingOptions","2465215107"),F.legacyControlId="grpParagraphDialogLauncherButton",F));let R;this.addCommandToMaps((R=new Va.a("LockAspectRatio","3369422509"),R.legacyControlId="toggleBtnLockAspectRatio",R.queryCommandId="4201275867",R));let fa;this.addCommandToMaps((fa=new Va.a("Margins","1451516907"),
fa.legacyControlId="flyMargins",fa));let wa;this.addCommandToMaps((wa=new Va.a("MergeCells","4127468093"),wa.legacyControlId="btnMergeTableCells",wa));this.addCommandToMaps(new Va.a("MoreEmojis","1145444901"));this.addCommandToMaps(new Va.a("MoreStyles","3340688468"));let Xa;this.addCommandToMaps((Xa=new Va.a("MoreSymbols","3574218963"),Xa.legacyControlId="btnMoreSymbols",Xa));let lb;this.addCommandToMaps((lb=new Va.a("MultilevelStyle1","3062940477"),lb.queryCommandId="1240192421",lb.menuItemId="MultilevelStyleMultilevelLibrary_1",
lb));let Lb;this.addCommandToMaps((Lb=new Va.a("MultilevelStyle2","3062940477"),Lb.queryCommandId="1240192421",Lb.menuItemId="MultilevelStyleMultilevelLibrary_2",Lb));let kc;this.addCommandToMaps((kc=new Va.a("MultilevelStyle3","3062940477"),kc.queryCommandId="1240192421",kc.menuItemId="MultilevelStyleMultilevelLibrary_3",kc));let lc;this.addCommandToMaps((lc=new Va.a("NoHighlight","562361573"),lc.legacyControlId="noFontBackgroundColor",lc));let Ec;this.addCommandToMaps((Ec=new Va.a("NumberingLibrary",
"2213049770"),Ec.queryCommandId="3488367157",Ec.populationProps=new Og("3149136033",!1),Ec));let Jc;this.addCommandToMaps((Jc=new Va.a("Orientation","1451516907"),Jc.legacyControlId="flyOrientation",Jc));let Dc;this.addCommandToMaps((Dc=new Va.a("ParagraphOptions","2465215107"),Dc.legacyControlId="grpLayoutParagraphDialogLauncherButton",Dc));this.addCommandToMaps(new Va.a(zp.Rtk,"237279923"));let Wd;this.addCommandToMaps((Wd=new Va.a(zp.Mtk,"1656143904"),Wd.legacyControlId="fseaNewPaste",Wd));this.addCommandToMaps(new Va.a(zp.Ltk,
"1656143904"));let xe;this.addCommandToMaps((xe=new Va.a("PageSize","1451516907"),xe.legacyControlId="flySize",xe));this.addCommandToMaps(new Va.a("Photos","2670646631"));let Sd;this.addCommandToMaps((Sd=new Va.a("PictureAbsoluteHeight","2808088361"),Sd.legacyControlId="spnAbsoluteHeight",Sd.queryCommandId="2181343285",Sd));let Pe;this.addCommandToMaps((Pe=new Va.a("PictureAbsoluteWidth","3108736954"),Pe.legacyControlId="spnAbsoluteWidth",Pe.queryCommandId="1960824158",Pe));this.addCommandToMaps(new Va.a("Print",
"1588554917"));let Ue;this.addCommandToMaps((Ue=new Va.a("PrintToWeb","1997662572"),Ue.legacyControlId="jbtnDigitalPrint",Ue));let Ef;this.addCommandToMaps((Ef=new Va.a("ReadingView","3849298593"),Ef.legacyControlId="btnReadingMode",Ef));let dg;this.addCommandToMaps((dg=new Va.a("Redo","4183277502"),dg.legacyControlId="btnRedo",dg));let Mg;this.addCommandToMaps((Mg=new Va.a("ResetPicture","2916220093"),Mg.legacyControlId="btnResetPicture",Mg));let Bg;this.addCommandToMaps((Bg=new Va.a("RightToLeftTextDirection",
"2632572640"),Bg.legacyControlId="TextDirRTL",Bg.queryCommandId="1154760330",Bg));let Lf;this.addCommandToMaps((Lf=new Va.a("RotatePictureMenu","2545543284"),Lf.legacyControlId="flyRotate",Lf));let mh;this.addCommandToMaps((mh=new Va.a("RotateLeft90","2545543284"),mh.legacyControlId="buttonRotateLeft90",mh.menuItemId="buttonRotateLeft90",mh));let Fg;this.addCommandToMaps((Fg=new Va.a("RotateRight90","2545543284"),Fg.legacyControlId="buttonRotateRight90",Fg.menuItemId="buttonRotateRight90",Fg));let ii;
this.addCommandToMaps((ii=new Va.a("SelectCell","111222446"),ii.legacyControlId="btnSelectCell",ii));let Li;this.addCommandToMaps((Li=new Va.a("SelectColumn","2341852628"),Li.legacyControlId="btnSelectColumn",Li));let wj;this.addCommandToMaps((wj=new Va.a("SelectRow","3508003794"),wj.legacyControlId="btnSelectRow",wj));let cj;this.addCommandToMaps((cj=new Va.a("SelectTable","2306914518"),cj.legacyControlId="btnSelectTable",cj));let dj;this.addCommandToMaps((dj=new Va.a("ShrinkFontSize","3575191971"),
dj.legacyControlId="fseaShrinkFontSize",dj));let yi;this.addCommandToMaps((yi=new Va.a("SetProofingLanguage","510284732"),yi.legacyControlId="fseaOpenLanguageDialog",yi));let Hk;this.addCommandToMaps((Hk=new Va.a("SpacingAfter","2322582597"),Hk.legacyControlId="spnSpacingAfter",Hk.queryCommandId="2340669283",Hk));let xj;this.addCommandToMaps((xj=new Va.a("SpacingBefore","1804274502"),xj.legacyControlId="spnSpacingBefore",xj.queryCommandId="26138520",xj));let uk;this.addCommandToMaps((uk=new Va.a("SpecialIndent",
"2798144440"),uk.legacyControlId="flySpecialIndent",uk));let Gl;this.addCommandToMaps((Gl=new Va.a("Spelling","2646312425"),Gl.legacyControlId="fseaNextSpellingError",Gl));let gl;this.addCommandToMaps((gl=new Va.a("StandardShadingColorPicker","2765388691"),gl.legacyControlId="cellShadingColorTable",gl));this.addCommandToMaps(new Va.a("StandardFontColorPicker","1970784898"));this.addCommandToMaps(new Va.a("RecentFontColorPicker","1970784898"));let Hl;this.addCommandToMaps((Hl=new Va.a("Strikethrough",
"4169095173"),Hl.legacyControlId="fsbcStrikethrough",Hl.queryCommandId="2742230607",Hl));let Yj;this.addCommandToMaps((Yj=new Va.a("StyleOptionsBandedColumns","1583455318"),Yj.legacyControlId="buttonBandedColumn",Yj.queryCommandId="1762426222",Yj.menuItemId="buttonBandedColumn",Yj));let Oj;this.addCommandToMaps((Oj=new Va.a("StyleOptionsBandedRows","1583455318"),Oj.legacyControlId="buttonBandedRow",Oj.queryCommandId="1762426222",Oj.menuItemId="buttonBandedRow",Oj));let Zj;this.addCommandToMaps((Zj=
new Va.a("StyleOptionsFirstColumn","1583455318"),Zj.legacyControlId="buttonFirstColumn",Zj.queryCommandId="1762426222",Zj.menuItemId="buttonFirstColumn",Zj));let Wk;this.addCommandToMaps((Wk=new Va.a("StyleOptionsHeaderRow","1583455318"),Wk.legacyControlId="buttonFirstRow",Wk.queryCommandId="1762426222",Wk.menuItemId="buttonFirstRow",Wk));let Hj;this.addCommandToMaps((Hj=new Va.a("StyleOptionsLastColumn","1583455318"),Hj.legacyControlId="buttonLastColumn",Hj.queryCommandId="1762426222",Hj.menuItemId=
"buttonLastColumn",Hj));let nh;this.addCommandToMaps((nh=new Va.a("StyleOptionsTotalRow","1583455318"),nh.legacyControlId="buttonLastRow",nh.queryCommandId="1762426222",nh.menuItemId="buttonLastRow",nh));let hl;this.addCommandToMaps((hl=new Va.a("Subscript","1455408143"),hl.legacyControlId="fsbcSubscript",hl.queryCommandId="3960255053",hl));let Wl;this.addCommandToMaps((Wl=new Va.a("Superscript","1107614"),Wl.legacyControlId="fsbcSuperscript",Wl.queryCommandId="692901994",Wl));let xm;this.addCommandToMaps((xm=
new Va.a("Table","28738965"),xm.legacyControlId="flyInsertTable",xm));let Ik;this.addCommandToMaps((Ik=new Va.a("TableStyles","4171428777"),Ik.queryCommandId="2135594455",Ik.populationProps=new Og("3359297384",!1),Ik.previewControlIds="buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" "),Ik));this.addCommandToMaps(Object.assign(new Va.a("TextAlignmentAnchor",null),{legacyControlId:"legacyTextAlignmentAnchor"}));
this.addCommandToMaps(Object.assign(new Va.a("TextAlignmentCenterJustify","4284004393"),{legacyControlId:"legacyTextAlignmentCenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Va.a("TextAlignmentFullJustify","1733835213"),{legacyControlId:"legacyTextAlignmentFullJustify",queryCommandId:"1257252315"}));this.addCommandToMaps(Object.assign(new Va.a("TextAlignmentLeftJustify","2539120357"),{legacyControlId:"legacyTextAlignmentLeftJustify",queryCommandId:"3797776291"}));
this.addCommandToMaps(Object.assign(new Va.a("TextAlignmentRightJustify","393413924"),{legacyControlId:"legacyTextAlignmentRightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(new Va.a("ThemeShadingColorPicker","2765388691"));this.addCommandToMaps(new Va.a("ThemeShadingColorPickerMCU","2765388691"));this.addCommandToMaps(new Va.a("ThemeFontColorPicker","1970784898"));this.addCommandToMaps(new Va.a("ThemeFontColorPickerMCU","1970784898"));this.addCommandToMaps(new Va.a("ToggleChangeCase",
"1208649786"));this.addCommandToMaps(Object.assign(new Va.a("Underline","1863297734"),{legacyControlId:"fsbcUnderline",queryCommandId:"2302164066"}));this.addCommandToMaps(Object.assign(new Va.a("Undo","2792113512"),{legacyControlId:"btnUndo"}));this.addCommandToMaps(new Va.a("OpenInClientUpsell","3588168074"));this.addCommandToMaps(Object.assign(new Va.a("SelectAll","344786228"),{legacyControlId:"SelectAllButton"}));this.addCommandToMaps(Object.assign(new Va.a("EditInClient","3588168074"),{legacyControlId:"btnjEditInClient"}));
this.addCommandToMaps(Object.assign(new Va.a("OpenInClient","3588168074"),{legacyControlId:"btnjOpenInClient"}));let vk;this.addCommandToMaps((vk=new Va.a("PrintDocument","1588554917"),vk.legacyControlId="jbtnDirectPrint",vk));let ji;this.addCommandToMaps((ji=new Va.a("PrintToPdf","1588554917"),ji.legacyControlId="jbtnPrintToPdf",ji));let ng;this.addCommandToMaps((ng=new Va.a("ProtectDocument","1642700244"),ng.legacyControlId="btnProtectDocument",ng.queryCommandId="3993403020",ng));let ki;this.addCommandToMaps((ki=
new Va.a("TransformToWebPage","1997662572"),ki.legacyControlId="jbtnTransformToWeb",ki));let Rf;this.addCommandToMaps((Rf=new Va.a("OpenInClientWithIcon","3588168074"),Rf.legacyControlId="btnOpenInClient",Rf));let zd;this.addCommandToMaps((zd=new Va.a("BulletLibrary_MLR","3552651681"),zd.queryCommandId="3827179399",zd.populationProps=new Og("2466004410",!1),zd));let ne;this.addCommandToMaps((ne=new Va.a("InsertPicture_MLR","2670646631"),ne.legacyControlId="fseaInsertPicture",ne));let yf;this.addCommandToMaps((yf=
new Va.a("NumberingLibrary_MLR","2213049770"),yf.queryCommandId="3488367157",yf.populationProps=new Og("3149136033",!1),yf));let Zd;this.addCommandToMaps((Zd=new Va.a("PasteStandalone","237279923"),Zd.legacyControlId="fseaPaste",Zd));let vg;this.addCommandToMaps((vg=new Va.a("Clipboard_MLR","237279923"),vg.legacyControlId="fseaNewPaste",vg));let $h;this.addCommandToMaps(($h=new Va.a("InsertOnlinePictureStandalone","1685987254"),$h.legacyControlId="fseaInsertOnlinePicture",$h));let zi;this.addCommandToMaps((zi=
new Va.a("InsertPictureFromHostStandalone","720118144"),zi.legacyControlId="fseaInsertOnlinePictureFromHost",zi.queryCommandId="3612507612",zi))}UFd(){this.addTabToMap("Picture","3523575366");this.addTabToMap("Table","1898844988")}}zp.GCi="Cut";zp.yui="Copy";zp.Rtk="Paste";zp.Mtk="PasteAsTextOnly";zp.Ltk="PasteAsTextOnlyContextMenu";Object(e.a)(zp,"Box4ReactCommandDefinitionMapping",Xw,[]);class Aj extends jr{constructor(a,b,c){super();this.kqf=b;this.lm=c;this.ub(a)}ub(a){a.pa(C.a.xye,Fb.a.application,
Object(D.a)(this,this.J4g,"populateContextMenu"),96);a.pa(C.a.O4g,Fb.a.application,Object(D.a)(this,this.J4g,"populateContextMenu"),96)}show(a,b,c){let f=null,l=new Sys.UI.Bounds(0,0,0,0);const x=this.l$i(a);if(x&&(a=a.Ua.node)&&(a=a.oc(pa.InteractiveViewManager.instance.Ld.Ma))){l=P.a.qt(a,x.end);if(u.AFrameworkApplication.isRtl&&l.x>b.x||!u.AFrameworkApplication.isRtl&&l.x+l.width<b.x||l.y+l.height<b.y)l=P.a.qt(a,x.end-1);b.x=l.x+(u.AFrameworkApplication.isRtl?0:l.width);b.y=l.y+l.height;f=6}jr.Zgd("mnuSpellingError",
new Sys.UI.Bounds(b.x,b.y,l.width,l.height),c,f)}J4g(a,b,c,f,l){if(1===c)return 32;a=l.Uu;l=l.ld;b=Object.assign(new sk.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.oyi(b,a);l.MenuItems=b;return 32}n3d(a,b){return this.Dqh(a)||Aj.fMf(C.a.FVa)||Aj.fMf(C.a.vHb)||this.cdl(a,b)||this.Qal(a,b)||Aj.acl()||Aj.hqh(a).returnValue}Dqh(a){return 2===Gb.App.Fb.mode&&this.DSc(a)}AWb(a,b,c,f=null){if(this.Dqh(a)){c=this.k$i(a);var l=sa.a.le(c.lcid);l=l?l.name:"UNKNOWN";var x=Object(Fa.a)(Hp.a,
c)?c.typeId:"";Z.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,x,l);f?(a=this.kqf.vWb(a,c))&&f.push.apply(f,a):b.append(this.kqf.create(a,c))}}k$i(a){return this.lm.TPa(a.Ua).Dh}DSc(a){return this.lm.$ic(a)}K8f(){return null}l$i(a){return this.DSc(a)?this.lm.TPa(a.Ua):(a=this.K8f(a))?new ke.a(a.FM,a.Kb):null}cdl(a,b){if(2!==Gb.App.Fb.mode||!a||!Aj.yJj&&this.ddl(a,b))return!1;a=Ea.a.cOa(a.toArray());return!!Aj.Pl.w1(a,14)}ddl(a,
b){return 2===b||3===b&&!this.DSc(a)}Qal(a,b){return 3!==b||this.DSc(a)}static get Rf(){return Aj.Og||(Aj.Og=hb.a.instance.resolve("Box4.List.IListReader"))}static get Pl(){return Rg.ContextSetEditor.instance}static get yJj(){return 1===Gb.App.mode}static get cHj(){null==Aj.Aud&&(Aj.Aud=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Aj.Aud}static get lcc(){null==Aj.LZa&&(Aj.LZa=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):
!1);return Aj.LZa}static get GR(){null==Aj.bM&&(Aj.bM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Aj.bM}static fMf(a){return 32===u.AFrameworkApplication.Ta.processAction(a,1)}static acl(){return 2===Gb.App.Fb.mode&&!!Gb.App.YC.VR&&Gb.App.YC.VR.jwg("510284732")}static hqh(a){let b,c;b=c=!1;if(!a)return{returnValue:!1,VQa:b,d2b:c};if(Aj.lcc)return Aj.Obl(a);if(!(a.Paa||Aj.cHj&&2===a.length&&a.Te.contextId===Fb.a.endOfParagraph))return{returnValue:!1,
VQa:b,d2b:c};a=a.Ua.clone();b=32===u.AFrameworkApplication.Ta.ii(a,C.a.nWa,1,!0,null,null);c=32===u.AFrameworkApplication.Ta.ii(a,C.a.insertHyperlink,1,!0,null,null);return{returnValue:b||c,VQa:b,d2b:c}}static Obl(a){let b;let c;var f=a.Ua.clone();c=Aj.GR&&fg.m(f);b=!c&&32===u.AFrameworkApplication.Ta.ii(f,C.a.nWa,1,!0,null,null);if(a.Paa||2===a.length&&a.Te.contextId===Fb.a.endOfParagraph)f=!c&&32===u.AFrameworkApplication.Ta.ii(f,C.a.insertHyperlink,1,!0,null,null);else{f=!0;const l=a.length;for(let x=
0;x<l;x++){const F=a.ga(x).clone();if(F.contextId===Fb.a.paragraph||F.contextId===Fb.a.textRange)(c=Aj.GR&&fg.m(F))||(f=32===u.AFrameworkApplication.Ta.ii(F,C.a.insertHyperlink,1,!0,null,null)&&f);else if(F.contextId!==Fb.a.endOfParagraph)return f=b=!1,{returnValue:!1,VQa:b,d2b:f}}}return{returnValue:b||f,VQa:b,d2b:f}}static Cxi(a,b){let c=!1,f=!1;({VQa:c,d2b:f}=Aj.hqh(a)).returnValue&&(c?f?b.push(Aj.ZZd(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):b.push(Aj.ZZd(["OpenHyperlink"])):
f&&b.push(Aj.ZZd(["InsertLink"])))}static ZZd(a){const b=Object.assign(new Si.a,{ControlList:[]});for(const c of a)Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:c}));return b}}Aj.Aud=null;Aj.Og=null;Aj.LZa=null;Aj.bM=null;Object(e.a)(Aj,"AEditSurfaceContextMenu",jr,[]);class Pz extends Aj{constructor(a,b,c,f,l,x,F,R,fa,wa){super(a,c,b,void 0,wa);this.lTa=0;this.Uee=f;this.dEa=l;this.la=x;this.L6j=this.la.NDb;this.IHg=this.la.s2b;this.LPg=this.la.QTc;this.RPg=this.la.iae;this.bac=this.la.Peb;
this.yGg=this.la.gUi;this.H_j=this.la.zfc;this.JMg=wa;this.WB=b;this.SMg=F;this.ED=R;this.Sb=fa}oyi(a,b){const c=[];switch(this.lTa){case 4:this.hpa(c,!0);this.cBf(c);this.s_h(c);this.L_h(c);this.bac&&this.V0h(c);this.DSb(c);this.LMa(c);break;case 7:case 8:case 13:case 15:case 11:case 14:case 16:this.hpa(c,!1);this.RFd(c,this.lTa);this.DSb(c);this.LMa(c);this.xpb(c);break;case 6:case 5:this.hpa(c,!1);this.RFd(c,this.lTa);this.la.NDb&&this.la.onh&&this.aBf(c);this.LMa(c);this.xpb(c);break;case 2:this.hpa(c,
!0);this.rzc(c,!0);break;case 1:this.hpa(c,!1);this.rzc(c,!1);this.cBf(c);this.t_h(c);this.SAf(c);bx.hoh&&this.LBf(c);this.DSb(c);this.LMa(c);this.xpb(c);break;case 3:this.iZh(c);this.xpb(c);break;case 19:this.n1h(c);this.rzc(c,!1);this.SAf(c);bx.hoh&&this.LBf(c);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.EBf(c);this.DSb(c);break;case 21:this.$1h(c);break;case 20:this.hpa(c,!0);this.rzc(c,!0);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.EBf(c);
this.DSb(c);break;case 9:this.hpa(c,!1);this.LMa(c);break;case 22:this.hpa(c,!1);this.RFd(c,this.lTa);this.LMa(c);break;case 10:this.hpa(c,!1);this.j0h(c);this.LMa(c);this.xpb(c);break;case 17:this.e0h(c);break;case 18:this.f0h(c);break;case 0:if(this.Sb.Nj()){var f=pa.InteractiveViewManager.instance.Ld.Eb.Oa.kb;this.AWb(f,null,b,c);this.hpa(c,!1);this.la.powerPointSmartLookupIsEnabled&&(this.m1h(c),this.z1h(c));3===b&&this.HIj(f)&&this.XZh(c);this.z0h(c);Aj.Cxi(f,c);this.bBi(f,c);this.aBi(f,c);this.L6j&&
this.aBf(c);this.hwi(c);this.LMa(c);this.xpb(c)}}for(const l of c)Array.add(a.MenuSectionList,l);this.lTa=0}okh(a){this.lTa=a}au(){return Object.assign(new Si.a,{ControlList:[]})}bdl(a){if(!this.LPg&&!this.RPg||2!==Gb.App.Fb.mode)return!1;a=Ea.a.cOa(a.toArray());return!!this.dEa.w1(a,14)}adl(a){if(!a||!this.H_j||2!==Gb.App.Fb.mode)return!1;a=Ea.a.cOa(a.toArray());return!!this.dEa.w1(a,14)}hpa(a,b){const c=this.au();b||(Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"Cut"})),Array.add(c.ControlList,
Object.assign(new Of.a,{ExternalId:"Copy"})));this.oBf(a,c)}oBf(a,b){const c=Object.assign(new Si.a,{DisplayMode:"Size24by24",ControlList:[],Title:ResourceStrings.L_PasteOptions,ShowMenuSectionTitleIcon:!1,ShowMenuSectionTitleBackground:!1,MenuSectionTitleFocusable:!1}),f=Object.assign(new uq.a,{Id:"PasteOptions",ExternalId:"PasteOptionsSection",ExternalGalleryId:"PasteOptionsGallery",Type:4,Width:5,ElementDimensions:"Size24by24",GalleryItems:[]});Array.add(c.ControlList,f);for(let l=1;5>=l;l++)f.GalleryItems.push(this.gKc(l));
a.push(b);a.push(c)}gKc(a){const b={root:{width:"24px",height:"24px"}};let c,f,l;switch(a){case 1:l="ContextMenu.Paste";a="Paste_20";c="3642315978";f=ResourceStrings.L_Paste;break;case 2:l="ContextMenu.PasteKeepingDestinationTheme";a="Pastedestinationtheme_20";c="4207422373";f=ResourceStrings.L_PasteWithDestinationTheme;break;case 3:l="ContextMenu.PasteKeepingSourceFormatting";a="Pastesourceformatting_20";c="2529825506";f=ResourceStrings.l_PasteWithSourceTheme;break;case 4:l="ContextMenu.PasteAsImage";
a="Pasteaspicture_20";c="1302928870";f=ResourceStrings.l_PasteAsImage;break;case 5:l="ContextMenu.PasteTextOnly";a="PasteTextOnly_20";c="2061487721";f=ResourceStrings.L_PasteTextOnly;break;default:l="ContextMenu.Paste",a="Paste_20",c="3642315978",f=ResourceStrings.L_Paste}return Object.assign(new dE.a,{Id:l,Icon:a,Alt:f,PreviewIconStyle:b,FullIconStyle:b,Command:c})}$1h(a){const b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"CopyInVersionHistory"}));a.push(b)}n1h(a){const b=
this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"Cut"}));Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"Copy"}));this.oBf(a,b)}rzc(a,b){const c=this.au();Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"NewSlideWithoutDialog"}));b||(Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"DuplicateSlide"})),Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"DeleteSlide"})));a.push(c)}s_h(a){if(this.yGg){const b=this.au();b.ControlList.push(Object.assign(new Of.a,
{ExternalId:"FormatBackgroundFromCanvas"}));a.push(b)}}t_h(a){if(this.yGg){const b=this.au();b.ControlList.push(Object.assign(new Of.a,{ExternalId:"FormatBackgroundFromThumbnailPane"}));a.push(b)}}iZh(a){const b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"Paste"}));Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}SAf(a){const b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"HideSlide"}));this.la.c4d&&Array.add(b.ControlList,
Object.assign(new Of.a,{ExternalId:"UnhideSlide"}));a.push(b)}LBf(a){const b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ShareSlide"}));a.push(b)}f0h(a){const b=this.R7f();a.push(b)}EBf(a){const b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"AddSection"}));a.push(b)}RFd(a,b){const c=this.au();7===b?(this.la.cHa?Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"ChangePictureContextMenu"})):Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"ChangePicture"})),
this.la.GRa&&Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"AlternativeText"}))):13===b?this.la.cHa&&Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"ChangeGraphicContextMenu"})):8===b?Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"SmartArtEditText"})):14!==b&&15!==b&&16!==b&&22!==b&&Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"BeginEditShapeText"}));22!==b&&(this.RAf(c),this.la.oJc&&this.JAf(c));this.xAf(c);this.fIf(c);this.Bjh(c);a.push(c)}cBf(a){const b=
this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:this.la.QWa?"ChangeLayoutFlyout":"ChangeLayout"}));a.push(b)}aBf(a){const b=this.au();this.IHg&&Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ImmersiveReader"}));Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"OpenPowerPointLanguageDialog"}));a.push(b)}DSb(a){if(this.IHg){var b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ImmersiveReader"}));a.push(b)}}Bjh(a){Array.add(a.ControlList,
Object.assign(new Of.a,{ExternalId:"SendToBackFlyout"}))}fIf(a){Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"BringToFrontFlyout"}))}RAf(a){Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"GroupAnchor"}))}xAf(a){Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"ShowHideFormatShapePane"}))}JAf(a){Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"FixIt"}))}j0h(a){const b=this.au();this.RAf(b);this.la.oJc&&this.JAf(b);this.xAf(b);this.fIf(b);this.Bjh(b);a.push(b)}LMa(a){const b=
this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"InsertComment"}));a.push(b)}L_h(a){const b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"DesignerHome"}));a.push(b)}V0h(a){const b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ShowHideRuler"}));a.push(b)}Lxi(){const a=this.Uee.HAi();return Object.assign(new Of.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}m1h(a){const b=this.au();Array.add(b.ControlList,this.Lxi());a.push(b)}z1h(a){if(!this.Uee.Vki()){var b=
this.Uee.XAi();if(b){var c=this.au();Array.add(c.ControlList,Object.assign(new Of.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}));a.push(c)}}}z0h(a){const b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"ParagraphOptions"}));a.push(b)}XZh(a){const b=this.au();Array.add(b.ControlList,Object.assign(new Of.a,{ExternalId:"Delete"}));a.push(b)}hwi(a){var b=hb.a.instance.pb("PowerPointWebEditor.IContextMenuExtensibilityHandler");b&&(b=b.PVi())&&a.push(b)}bBi(a,b){a&&this.bdl(a)&&
(a=this.au(),this.LPg&&Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"MergeTableCells"})),this.RPg&&Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"SplitTableCells"})),b.push(a))}aBi(a,b){this.adl(a)&&(a=this.au(),Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"SetSizeAnchor"})),Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"TableDistribute"})),b.push(a))}HIj(a){return this.WB.$ic(a)}e0h(a){const b=this.R7f();Array.add(b.ControlList,Object.assign(new Of.a,
{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}R7f(){const a=this.au();Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"RenameSection"}));Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"RemoveSection"}));Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"MoveSectionUp"}));Array.add(a.ControlList,Object.assign(new Of.a,{ExternalId:"MoveSectionDown"}));return a}xpb(a){this.SMg&&this.SMg.vWb(this.SZb(),a)}SZb(){return this.ED.instance?this.ED.instance.SZb():[]}}Object(e.a)(Pz,
"EditSurfaceContextMenu",Aj,[]);class $L{constructor(a,b,c,f,l,x,F,R,fa,wa){this.gac=null;this.Wzb=0;this.QN=b;this.FD=c;this.Fja=f;this.yb=x;this.n_j=F;this.ia=fa;this.Qc=R;this.Qc.C2h(Object(D.a)(this,this.aXg,"onCUIStatusChanged"));this.Qc.Bzc(Object(D.a)(this,this.wT,"onFocusChanged"));this.Qc.vGd(Object(D.a)(this,this.k8c,"onSetFocus"));this.i2c=wa}get inKeytipMode(){return appChrome.api.inKeytipMode()}dispose(){this.Qc.OOk(Object(D.a)(this,this.aXg,"onCUIStatusChanged"));this.Qc.wcd(Object(D.a)(this,
this.wT,"onFocusChanged"));this.Qc.edh(Object(D.a)(this,this.k8c,"onSetFocus"))}initialize(){this.ub();this.uF()}wT(){}k8c(a,b){b.EBb!==Nc.a.mea||b.Ifc===y.AFrame.icb||b.Ifc.endsWith("/modal")||appChrome.api.enterKeytipMode()}Bol(a){this.Wzb|=a;this.gac||(this.gac=new He.a(0,1,0,Object(D.a)(this,this.a6k,"setTimeOutWithCurrentActionContext"),90,"11"),this.gac.customData=new Date,this.yb.Gb(this.gac))}ub(){this.ia.pa(ba.a.x0,fc.a.application,Object(D.a)(this,this.Jmj,"handleOpenMenu"),64)}Jmj(a,b,
c,f,l){return this.x0(l)?32:8}a6k(a){Mc.a.TMi(Object(D.a)(this,this.uF,"poll"),Object(va.a)(Date,a.customData));this.gac=null}aXg(a,b){this.Bol(b.ghl)}uF(){this.n_j.clearCache();0!==(this.Wzb&1)&&this.FD.uF();0!==(this.Wzb&2)&&this.QN.uF();0!==(this.Wzb&4)&&this.Fja.uF();this.Wzb=0}x0(a){return this.i2c.x0(a)}}Object(e.a)($L,"CUIManager",null,[232,106]);var eE=d(1191),fE=d(1162),BQ=d(1029),gE=d(1050);class Ts{constructor(){this.italic=0;this.oUc=!1;this.underline=0;this.mU=this.Zkd=!1;this.superscript=
0;this.xid=!1;this.subscript=0;this.pid=!1;this.strikethrough=0;this.eid=!1;this.ys=0;this.$Gc=!1;this.fontName=null;this.CZb=this.Djd=this.BJc=this.AJc=!1;this.highlight=0;this.rPc=!1;this.bold=this.italic=this.underline=this.strikethrough=this.ys=this.superscript=this.subscript=2;this.fontColor=this.highlight=this.fontSize=-1;this.qw=fd.Font.qAj;this.Yma=-1;this.AJd=this.oUc=this.Zkd=this.mU=this.xid=this.pid=this.eid=this.$Gc=this.AJc=this.BJc=this.Djd=this.CZb=this.rPc=!1}}Object(e.a)(Ts,"FormattingData",
null,[]);var hE=d(808),CQ=d(774);class $k{constructor(){this.Jm=this.$cb=0;this.ld=null;this.qF=!1;this.hK=null}}Object(e.a)($k,"CuiEnabledInfo",null,[]);class Pg{constructor(){this.Jm=this.$cb=0;this.ld=null;this.qF=this.f$d=this.g$d=this.TV=this.Jq=this.O3d=!1;this.hK=null}}Object(e.a)(Pg,"CuiExecuteInfo",null,[]);class DQ{constructor(){this.KNe=new nq.a;this.T8d=!1}}Object(e.a)(DQ,"TextRangeStyleData",null,[]);class ig{constructor(){this.hb=new Me.a;this.Vc=new Me.a;this.K2e=new Ts;this.jgf=new hE.a;
this.Rsd=this.Qsd=!1}initialize(){ig.luh=ig.tPd();this.hb.$(C.a.undo,ig.C2b);this.hb.$(C.a.redo,ig.C2b);this.hb.$(C.a.R5c,ig.C2b);this.hb.$(C.a.O4g,ig.jnl);this.hb.$(C.a.openInClient,ig.lqk);this.hb.$(G.a.close,ig.Vni);this.hb.$(C.a.eK,ig.YFi);this.hb.$(C.a.font,ig.WVd);this.hb.$(C.a.yr,Object(D.a)(this,this.LWd,"genericFontSizeExecuteBridge"));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(this.hb.$(C.a.u4,ig.WVd),this.hb.$(C.a.LHa,ig.WVd),this.hb.$(C.a.eHa,Object(D.a)(this,this.LWd,"genericFontSizeExecuteBridge")),
this.hb.$(C.a.qXa,Object(D.a)(this,this.iVk,"revertPreviewFontSizeExecuteBridge")));this.hb.$(C.a.bold,ig.jrb);this.hb.$(C.a.setItalic,ig.jrb);this.hb.$(C.a.underline,ig.jrb);this.hb.$(C.a.strikethrough,ig.jrb);this.hb.$(C.a.superscript,ig.jrb);this.hb.$(C.a.subscript,ig.jrb);this.hb.$(C.a.Wfc,Object(D.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(C.a.bgc,Object(D.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(C.a.dhc,Object(D.a)(this,this.Bva,"queryFormattingExecuteBridge"));
this.hb.$(C.a.Mgc,Object(D.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(C.a.Ogc,Object(D.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(C.a.uBe,Object(D.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(C.a.Ugc,Object(D.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(C.a.jad,Object(D.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(C.a.$fc,Object(D.a)(this,this.Bva,"queryFormattingExecuteBridge"));this.hb.$(C.a.KAe,Object(D.a)(this,this.Bva,
"queryFormattingExecuteBridge"));this.hb.$(C.a.LAe,Object(D.a)(this,this.ECk,"queryFormatPainterExecuteBridge"));this.hb.$(C.a.dgc,Object(D.a)(this,this.wad,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.Dgc,Object(D.a)(this,this.wad,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.Zfc,Object(D.a)(this,this.wad,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.agc,Object(D.a)(this,this.wad,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.HE,ig.h0f);this.hb.$(C.a.Ry,ig.h0f);this.hb.$(G.a.IMd,
ig.Yfc);this.hb.$(C.a.rbe,ig.C2b);this.Vc.$(C.a.hDb,ig.sGc);this.Vc.$(C.a.iDb,ig.sGc);this.Vc.$(C.a.Qec,ig.sGc);this.Vc.$(C.a.d$c,ig.sGc);this.Vc.$(C.a.Wfc,ig.Kva);this.Vc.$(C.a.bgc,ig.Kva);this.Vc.$(C.a.dhc,ig.Kva);this.Vc.$(C.a.Mgc,ig.Kva);this.Vc.$(C.a.Ogc,ig.Kva);this.Vc.$(C.a.uBe,ig.Kva);this.Vc.$(C.a.Ugc,ig.Kva);this.Vc.$(C.a.jad,ig.Kva);this.Vc.$(C.a.$fc,ig.Kva);this.Vc.$(C.a.KAe,ig.Kva);this.Vc.$(C.a.dgc,ig.kcd);this.Vc.$(C.a.Zfc,ig.kcd);this.Vc.$(C.a.Dgc,ig.kcd);this.Vc.$(C.a.agc,ig.kcd);
this.hb.$(C.a.IOf,Object(D.a)(this,this.hzj,"insertHyperLinkBridge"));this.hb.$(C.a.NMd,Object(D.a)(this,this.HOf,"commandingInputMethodExecuteBridge"));this.hb.$(C.a.MOf,Object(D.a)(this,this.HOf,"commandingInputMethodExecuteBridge"));this.hb.$(C.a.JOf,Object(D.a)(this,this.rzj,"insertOnLinePictureExecuteBridge"));this.hb.$(C.a.KOf,Object(D.a)(this,this.Kzj,"insertSymbolBridge"));this.hb.$(C.a.LOf,Object(D.a)(this,this.epi,"commandingInsertTableExecuteBridge"));this.hb.$(C.a.fpi,Object(D.a)(this,
this.cek,"navToPageExecuteBridge"));this.hb.$(C.a.GOf,ig.FOf);this.hb.$(C.a.MMd,ig.FOf);u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")&&this.Vc.$(G.a.ued,ig.xYk)}clearCache(){this.K2e=new Ts;this.jgf=new hE.a;this.Rsd=this.Qsd=!1}f9f(a,b,c){const f=this.hb.ga(a);f?c=f(a,b,c):(c=new Pg,c.ld=b);c.$cb=a;c.Jm||(c.Jm=ig.sak(a));Ag.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.FlagExclusivelyMappedCommands")&&this.Woi(a,b)&&(c.ld||
(c.ld={}),"object"===typeof c.ld&&(c.ld.MappedCommand=!0));return c}wLc(a,b=null){const c=this.Vc.ga(a);b=c?c(a,b):new $k;b.$cb=a;b.Jm||(b.Jm=a);return b}Bva(){const a=new Pg;a.O3d=this.Rsd;this.Rsd=!0;a.Jm=C.a.TDb;a.ld=this.K2e;a.TV=!0;return a}wad(){const a=new Pg;a.O3d=this.Qsd;this.Qsd=!0;a.Jm=C.a.Cva;a.ld=this.jgf;a.f$d=!0;a.TV=!0;return a}LWd(a,b){const c=new Pg;c.Jq=!0;let f=0;({number:f}=Ma.a.otk(b.CommandValueId||b.Value,u.AFrameworkApplication.numberFormat));if(isNaN(f))return Gb.App.Fb.updateCommandUI(),
c.hK=!1,c;a===C.a.eHa&&(b[Dn.a.xea]=!1);c.ld=ig.lOd(Math.floor(2*f),b);return c}iVk(a,b){a=new Pg;a.Jq=!0;b[Dn.a.xea]=!1;a.ld=ig.lOd(0,b);return a}HOf(a){var b={Visible:!0};a===C.a.NMd?(b.LabelText="Undo",b.SourceControlId="btnUndo"):(b.LabelText="Redo",b.SourceControlId="btnRedo");a=new fE.a(b,2);b=new Pg;b.ld=a;return b}rzj(a,b){a=new Pg;const c=new E.DictionaryPropertySet;b=b.Value?b.Value:null;if(!b||""===b)return null;b=String.format("<img src={0}>",b);c.setValue(be.a.zT,b);a.ld=c;return a}hzj(a,
b){a=new Pg;b.Source="CommandingInterface";a.ld=b;return a}epi(a,b){a=new Pg;a.Jq=!0;const c=new hI;c.rows=b.Row;c.columns=b.Col;a.ld=c;return a}Kzj(a,b){a=new Pg;a.Jq=!0;b=b.Value;a.ld=new E.DictionaryPropertySet;const c=this.uNc(b),f={};f.SourceControlId="symbol_"+b+"_"+c;f.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',c);a.ld=f;return a}cek(a,b){a=new Pg;a.ld=b.Value?b.Value:"";return a}ECk(){const a=new Pg;a.ld=hb.a.instance.pb("Box4.IFormatPainter");
a.TV=!0;return a}uNc(a){return ig.luh[a.toString()]}Woi(a,b){a=b&&b.launcherCommandId?b.launcherCommandId:a;b=!!this.Vc.ga(a)||!!this.hb.ga(a);return!u.AFrameworkApplication.Ta.iS(a)&&b}static tPd(){return{0:"\u2022",1:"\u20ac",2:"\u00a3",3:"\u00a5",4:"\u00a9",5:"\u00ae",6:"\u2122",7:"\u00b1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\u00f7",12:"\u00d7",13:"\u221e",14:"\u00b5",15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\u00b0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"}}static sTb(a,
b){var c=Object(va.a)(Ts,a.ld),f=Object(va.a)(hE.a,a.ld);let l=!0;switch(a.$cb){default:l=!1;break;case C.a.S7g:b[ai.a.On]=!0;break;case C.a.Wfc:b[ai.a.On]=1===c.bold;break;case C.a.bgc:b[ai.a.On]=1===c.italic;break;case C.a.dhc:b[ai.a.On]=1===c.underline;break;case C.a.uBe:b[BG.a.On]=1===c.subscript;break;case C.a.Ogc:b[ai.a.On]=1===c.subscript;break;case C.a.Ugc:b[ai.a.On]=1===c.superscript;break;case C.a.Mgc:b[ai.a.On]=1===c.strikethrough||1===c.ys;break;case C.a.jad:b[no.a.IsFreeForm]=!0;b[no.a.Value]=
void 0!==c.fontName&&null!==c.fontName?tb.a.M8f(c.fontName,c.Yma):"";break;case C.a.$fc:a="";-1!==c.fontSize&&(a=Ma.a.NJc(c.fontSize/2,0,u.AFrameworkApplication.numberFormat));b[no.a.IsFreeForm]=!0;b[no.a.Value]=a;break;case C.a.KAe:if(void 0!==c.fontName&&null!==c.fontName){if(a=1===c.bold,f=1===c.italic,a=ia.FontUtils.FCk(c.fontName,a,f,a&&f?Box4Intl.Box4Strings.L_FontNameBoldItalic:a?Box4Intl.Box4Strings.L_FontNameBold:f?Box4Intl.Box4Strings.L_FontNameItalic:"{0}"),void 0===c.fontName||null===
c.fontName)a=tb.a.M8f(c.fontName,c.Yma),a=appChrome.api.selectedFont(a,c.fontName)}else a=appChrome.api.selectedFont("");void 0!==a.isMissingFont&&null!==a.isMissingFont||void 0===a.name||null===a.name||""===a.name||(a.isMissingFont=ia.FontUtils.isMissingFont(void 0!==a.key&&null!==a.key&&""!==a.key?a.key:a.name));b[oo.SelectedFont]=a;break;case C.a.dgc:b[ai.a.On]=1===f.pl;break;case C.a.Zfc:b[ai.a.On]=2===f.pl;break;case C.a.Dgc:b[ai.a.On]=3===f.pl;break;case C.a.agc:b[ai.a.On]=6===f.pl;break;case C.a.LAe:if(c=
Object(va.a)(382,a.ld))b[ai.a.On]=c.yK;case G.a.IMd:}return l}static h0f(){return new Pg}static Yfc(a,b){a=new Pg;a.ld=b;a.TV=!0;return a}static C2b(a,b,c){a=new fE.a(b,c.InvocationMethod);b=new Pg;b.ld=a;return b}static jnl(a,b){a=new fE.a(b,3);b=new Pg;b.ld=a;return b}static lqk(a,b,c){a=new Pg;BQ.a.sAg(c.CommandLocation)||26===c.CommandLocation||(a.ld=!1);return a}static EAe(){const a=new Pg;a.ld=new E.DictionaryPropertySet;a.TV=!0;return a}static YFi(){const a=new Pg;a.ld=new E.DictionaryPropertySet;
return a}static Vni(){const a=new Pg;a.ld=Qi.b;return a}static sGc(){const a=new $k;a.ld=new E.DictionaryPropertySet;return a}static xYk(a,b=null){a=new $k;a.ld=b;return a}static jrb(){const a=new Pg;a.ld=new K(2);a.Jq=!0;return a}static kcd(){const a=new $k;a.Jm=C.a.Cva;return a}static Kva(){const a=new $k;a.Jm=C.a.TDb;return a}static WVd(a,b){const c=new Pg;c.Jq=!0;var f=b.CommandValueId?b.CommandValueId:b.Value;c.ld=f;if(fd.Font.SRa()){const x=new Ts;var l=b.MenuItemId;l&&(x.Yma=fd.Font.ufj(l));
(l=Object(va.a)(CQ.a,b[oo.Formatting]))&&(l.isBold||l.isItalic)&&(x.bold=l.isBold?1:0,x.italic=l.isItalic?1:0);x.fontName=f;c.ld=x}ig.aWj(b);(a=u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===C.a.u4||a===C.a.LHa))&&(b[Dn.a.xea]=!1);c.ld=ig.lOd(c.ld,b);a||(ia.FontUtils.hzc(f),f=b[oo.RequestUpdateMru],void 0!==f&&null!==f&&appChrome.api.dispatch(appChrome.actions.addFontToMru(b.SourceControlId,f)));return c}static aWj(a){void 0!==a[no.a.IsFreeForm]&&null!==a[no.a.IsFreeForm]&&a[no.a.IsFreeForm]?
Z.ULS.sendTraceTag(51390360,324,50,"Font applied is not a valid menu item"):void 0!==a.MenuItemId&&null!==a.MenuItemId&&Z.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is in MenuItemID:{0}",a.MenuItemId))}static FOf(a,b){a=new Pg;b=b.Color?b.Color:null;if(!b||6!==b.length)return null;a.ld=ig.b4a(b);a.Jq=!0;return a}static b4a(a){return 6!==a.length?null:a.substring(4,6)+a.substring(2,4)+a.substring(0,2)}static sak(a){switch(a){case C.a.NMd:return C.a.undo;case C.a.MOf:return C.a.redo;
case C.a.LOf:return C.a.insertTable;case C.a.JOf:return C.a.Jpa;case C.a.KOf:return C.a.oRa;case C.a.IOf:return C.a.insertHyperlink;case C.a.GOf:return C.a.Ss;case C.a.MMd:return C.a.W9;default:return a}}static lOd(a,b){const c=new gE.a(a);return u.AFrameworkApplication.Aa.gb.Mp?new gE.a(a,b[Dn.a.xea]):c}}ig.luh={};Object(e.a)(ig,"CuiActionBridge",null,[]);class aM{constructor(){this.YHd=this.sTb=this.Fye=this.eze=null}}Object(e.a)(aM,"GeneralCuiUserHooks",null,[]);var EQ=d(492);class zv{constructor(){this.XT=
this.LWa=null;this.menuItemId=0}}Object(e.a)(zv,"QueryData",null,[]);let cf;class wd extends ig{constructor(a,b,c,f,l,x,F,R){super();this.la=a;this.ra=b;this.IYj=c;this.uzb=f;this.sc=l;this.Sb=x;this.Qb=F;this.OTa=R}initialize(){super.initialize();this.gyj();this.yyj();this.zxj();this.kyj();this.Pwj();this.vyj();this.Rxj();this.Swj();this.qxj();this.$wj()}wLc(a,b=null){if(u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")){const c=this.Vc.ga(a);b=c?c(a,b):new $k;b.$cb=
a;b.Jm||(b.Jm=a);b&&this.Qb&&1===this.Qb.Nu&&!wd.M7d(a)&&(b.hK=!1);return b}(b=super.wLc(a))&&this.Qb&&1===this.Qb.Nu&&!wd.M7d(a)&&(b.hK=!1);return b}gyj(){this.la.Qeb&&(this.Vc.$(ba.a.CDb,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge")),this.Vc.$(ba.a.Ffc,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge")),this.Vc.$(G.a.umc,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge")),this.Vc.$(ba.a.fhd,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge")),this.Vc.$(C.a.vmc,Object(D.a)(this,
this.ama,"remapRumTrackerEnabledBridge")),this.Vc.$(G.a.kBa,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge")));this.Vc.$(ba.a.hgb,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge"));this.Vc.$(ba.a.fgb,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge"));this.Vc.$(ba.a.pYa,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge"));this.Vc.$(ba.a.DYa,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge"));this.Vc.$(ba.a.yUe,Object(D.a)(this,this.ama,"remapRumTrackerEnabledBridge"))}yyj(){this.hb.$(ba.a.igc,
Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.ogc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.zgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.kgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.pgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.sgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.ngc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.wgc,Object(D.a)(this,
this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.vgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.ugc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.lgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.mgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.jgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.rgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.iHa,Object(D.a)(this,this.UD,"remapTextQueryExecute"));
this.hb.$(ba.a.Qdb,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.XDb,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.WDb,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.t8g,wd.hf);this.hb.$(ba.a.tgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.qgc,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.dBe,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.cBe,Object(D.a)(this,this.UD,"remapTextQueryExecute"));
this.hb.$(ba.a.Rdb,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.hb.$(ba.a.Sdb,Object(D.a)(this,this.UD,"remapTextQueryExecute"));this.Vc.$(ba.a.igc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.ogc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.zgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.kgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.pgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.sgc,
Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.ngc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.wgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.vgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.ugc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.lgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.mgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.jgc,Object(D.a)(this,
this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.rgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.iHa,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.Qdb,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.XDb,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.WDb,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.tgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.qgc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));
this.Vc.$(ba.a.dBe,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.cBe,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.Rdb,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.Sdb,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.hb.$(ba.a.Yec,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.efc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.wfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.kDb,Object(D.a)(this,
this.vUc,"justifyExecuteBridge"));this.hb.$(ba.a.rDb,Object(D.a)(this,this.vUc,"justifyExecuteBridge"));this.hb.$(ba.a.uDb,Object(D.a)(this,this.vUc,"justifyExecuteBridge"));this.hb.$(ba.a.pDb,Object(D.a)(this,this.vUc,"justifyExecuteBridge"));this.hb.$(ba.a.nDb,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.kfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.nfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.oDb,Object(D.a)(this,this.Qs,"remapTextExecute"));
this.hb.$(ba.a.lfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.ofc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.vDb,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.qDb,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.Pla,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.Ola,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.Nla,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.qfc,Object(D.a)(this,this.Qs,"remapTextExecute"));
this.hb.$(ba.a.gfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.hfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.ifc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.jfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.s$c,wd.Rzg);this.hb.$(ba.a.t$c,wd.Rzg);this.hb.$(ba.a.wva,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.xWa,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.FGb,Object(D.a)(this,this.Szg,"listMarkerGalleryShapeExecuteBridge"));
this.hb.$(ba.a.nGb,Object(D.a)(this,this.Szg,"listMarkerGalleryShapeExecuteBridge"));this.hb.$(ba.a.k$c,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.l$c,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.mDb,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.cfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.Zec,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.bfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.mfc,Object(D.a)(this,
this.Qs,"remapTextExecute"));this.hb.$(ba.a.y$c,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.pfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.insertHyperlink,Object(D.a)(this,this.QMk,"remapInsertHyperlinkExecute"));this.hb.$(ba.a.ffc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.sDb,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.rfc,Object(D.a)(this,this.Qs,"remapTextExecute"));this.hb.$(ba.a.sfc,Object(D.a)(this,this.Qs,"remapTextExecute"));
this.Vc.$(ba.a.Yec,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.efc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.wfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.kDb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.rDb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.uDb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.pDb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.nDb,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));
this.Vc.$(ba.a.kfc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.nfc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.oDb,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.lfc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.ofc,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.Vc.$(ba.a.vDb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.qDb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.Pla,Object(D.a)(this,
this.es,"remapTextEnabled"));this.Vc.$(ba.a.Ola,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.Nla,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.qfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.gfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.hfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.ifc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.jfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.wva,
Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.xWa,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.k$c,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.l$c,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.mDb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.cfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.Zec,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.bfc,Object(D.a)(this,this.es,"remapTextEnabled"));
this.Vc.$(ba.a.mfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.y$c,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.pfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.ffc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.sDb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.insertHyperlink,Object(D.a)(this,this.PMk,"remapInsertHyperlinkEnabled"));this.Vc.$(ba.a.Rdb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.Sdb,Object(D.a)(this,
this.es,"remapTextEnabled"));this.Vc.$(ba.a.rfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.sfc,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.Rdb,Object(D.a)(this,this.es,"remapTextEnabled"));this.Vc.$(ba.a.Sdb,Object(D.a)(this,this.es,"remapTextEnabled"))}zxj(){this.hb.$(ba.a.g8g,Object(D.a)(this,this.Odb,"queryInkControlToggledExecuteBridge"));this.hb.$(ba.a.a8g,Object(D.a)(this,this.Odb,"queryInkControlToggledExecuteBridge"));this.hb.$(ba.a.d8g,Object(D.a)(this,
this.Odb,"queryInkControlToggledExecuteBridge"));this.hb.$(ba.a.b8g,Object(D.a)(this,this.Odb,"queryInkControlToggledExecuteBridge"));this.hb.$(ba.a.e8g,Object(D.a)(this,this.Odb,"queryInkControlToggledExecuteBridge"));this.hb.$(ba.a.f8g,Object(D.a)(this,this.Odb,"queryInkControlToggledExecuteBridge"));this.hb.$(ba.a.c8g,Object(D.a)(this,this.Odb,"queryInkControlToggledExecuteBridge"))}kyj(){this.hb.$(ba.a.Fgc,wd.hf);this.hb.$(ba.a.Ggc,wd.hf);this.hb.$(ba.a.Igc,wd.hf);this.hb.$(ba.a.Sad,wd.hf);this.hb.$(ba.a.Rad,
wd.hf);this.hb.$(ba.a.Tad,wd.hf);this.hb.$(ba.a.Uad,wd.hf);this.hb.$(ba.a.Wad,wd.hf);this.hb.$(ba.a.Qad,wd.hf);this.hb.$(ba.a.Yad,wd.hf);this.hb.$(ba.a.Vad,wd.hf);this.hb.$(ba.a.cbd,wd.hf);this.hb.$(ba.a.bbd,wd.hf);this.hb.$(ba.a.abd,wd.hf);this.hb.$(ba.a.Vdb,wd.hf);this.hb.$(ba.a.Wdb,wd.hf);this.hb.$(ba.a.JWa,Object(D.a)(this,this.oad,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ba.a.KWa,Object(D.a)(this,this.oad,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ba.a.Pad,wd.hf);this.hb.$(ba.a.Oad,
wd.hf);this.hb.$(ba.a.Hgc,wd.hf);this.hb.$(ba.a.Zad,wd.hf);this.hb.$(ba.a.$ad,wd.hf);this.Vc.$(ba.a.Gfb,wd.YA);this.Vc.$(ba.a.Hfb,wd.YA);this.Vc.$(ba.a.lGb,wd.YA);this.Vc.$(ba.a.Sfb,wd.YA);this.Vc.$(ba.a.HGb,wd.YA);this.Vc.$(ba.a.SJe,wd.YA);this.hb.$(ba.a.Gfb,Object(D.a)(this,this.ETi,"fontNameExecuteBridge"));this.hb.$(ba.a.Hfb,Object(D.a)(this,this.LWd,"genericFontSizeExecuteBridge"));this.hb.$(ba.a.lGb,wd.pOe);this.hb.$(ba.a.Sfb,wd.pOe);this.hb.$(ba.a.HGb,wd.pOe);this.Vc.$(ba.a.KFf,wd.fYa);this.Vc.$(ba.a.LFf,
wd.fYa);this.Vc.$(ba.a.XHd,wd.fYa);this.Vc.$(ba.a.THd,wd.fYa);this.Vc.$(ba.a.WHd,wd.fYa);this.Vc.$(ba.a.UHd,wd.fYa);this.Vc.$(ba.a.MFf,wd.fYa);this.Vc.$(ba.a.CFf,wd.fYa);this.hb.$(ba.a.Pfd,wd.Jzg);this.hb.$(ba.a.IWa,wd.l8g);this.hb.$(ba.a.Xad,wd.l8g);this.hb.$(ba.a.Ila,wd.Jzg)}Pwj(){this.hb.$(ba.a.aea,Object(D.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.Fva,Object(D.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.lHa,Object(D.a)(this,this.Eva,
"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.chc,Object(D.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.bEb,Object(D.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.GBe,Object(D.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.kHa,wd.P_);this.hb.$(ba.a.kwa,Object(D.a)(this,this.skd,"transitionExecuteBridge"));this.hb.$(ba.a.AGb,Object(D.a)(this,this.skd,"transitionExecuteBridge"));this.Vc.$(ba.a.kwa,
wd.YA);this.Vc.$(ba.a.lwa,wd.YA);this.Vc.$(ba.a.nIa,wd.YA);this.Vc.$(ba.a.dgd,wd.YA);this.Vc.$(ba.a.BGb,wd.YA);this.hb.$(ba.a.Ldb,Object(D.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.Jdb,Object(D.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.Kdb,Object(D.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.Mdb,Object(D.a)(this,this.Eva,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ba.a.$A,Object(D.a)(this,
this.skd,"transitionExecuteBridge"));this.hb.$(ba.a.PFb,Object(D.a)(this,this.skd,"transitionExecuteBridge"));this.Vc.$(ba.a.$A,wd.YA);this.Vc.$(ba.a.ifb,wd.YA);this.Vc.$(ba.a.PFb,wd.YA);this.Vc.$(ba.a.kjc,wd.YA);this.Vc.$(ba.a.lfb,wd.YA);this.Vc.$(ba.a.jfb,wd.YA);this.Vc.$(ba.a.kfb,wd.YA);this.Vc.$(ba.a.JHe,wd.YA);this.Vc.$(ba.a.KHe,wd.YA);this.Vc.$(ba.a.LHe,wd.YA);this.Vc.$(ba.a.MHe,wd.YA)}vyj(){this.hb.$(C.a.YDb,ig.EAe);this.hb.$(ba.a.A8g,ig.EAe);this.hb.$(ba.a.Zgc,wd.P_);this.hb.$(ba.a.$gc,wd.P_);
this.hb.$(ba.a.gbd,wd.P_);this.hb.$(ba.a.BBe,wd.P_);this.hb.$(ba.a.Wgc,wd.P_);this.hb.$(ba.a.Xgc,wd.P_);this.hb.$(ba.a.Ygc,wd.P_);this.hb.$(ba.a.Vgc,wd.P_);this.hb.$(ba.a.m$c,Object(D.a)(this,this.jcd,"remapTableExecute"));this.hb.$(C.a.aba,Object(D.a)(this,this.jcd,"remapTableExecute"));this.hb.$(C.a.Xic,Object(D.a)(this,this.jcd,"remapTableExecute"));this.hb.$(C.a.insertTable,Object(D.a)(this,this.jcd,"remapTableExecute"));this.Vc.$(C.a.insertTable,Object(D.a)(this,this.Yki,"checkInsertTableRibbonEnabledBridge"));
this.Vc.$(C.a.aba,Object(D.a)(this,this.Mob,"checkWholeTableLockEnabledBridge"));this.Vc.$(C.a.u1,Object(D.a)(this,this.Mob,"checkWholeTableLockEnabledBridge"));this.Vc.$(C.a.Jza,Object(D.a)(this,this.Mob,"checkWholeTableLockEnabledBridge"));this.Vc.$(ba.a.j5g,Object(D.a)(this,this.Mob,"checkWholeTableLockEnabledBridge"));this.Vc.$(ba.a.xva,Object(D.a)(this,this.Mob,"checkWholeTableLockEnabledBridge"));this.Vc.$(ba.a.yWa,Object(D.a)(this,this.Mob,"checkWholeTableLockEnabledBridge"));this.hb.$(C.a.u1,
Object(D.a)(this,this.FNa,"checkSelectionBeforeExecute"));this.hb.$(C.a.Jza,Object(D.a)(this,this.FNa,"checkSelectionBeforeExecute"));this.hb.$(C.a.Sob,Object(D.a)(this,this.FNa,"checkSelectionBeforeExecute"));this.hb.$(ba.a.vfc,Object(D.a)(this,this.FNa,"checkSelectionBeforeExecute"));this.hb.$(ba.a.ufc,Object(D.a)(this,this.FNa,"checkSelectionBeforeExecute"));this.hb.$(ba.a.tfc,Object(D.a)(this,this.FNa,"checkSelectionBeforeExecute"));this.hb.$(ba.a.xva,Object(D.a)(this,this.FNa,"checkSelectionBeforeExecute"));
this.hb.$(ba.a.yWa,Object(D.a)(this,this.FNa,"checkSelectionBeforeExecute"));this.hb.$(ba.a.b9g,wd.hf);this.hb.$(ba.a.c9g,wd.hf);this.hb.$(ba.a.d9g,wd.hf);this.hb.$(ba.a.e9g,wd.hf);this.hb.$(ba.a.f9g,wd.hf);this.hb.$(ba.a.g9g,wd.hf);this.hb.$(ba.a.h9g,wd.hf);this.hb.$(ba.a.i9g,wd.hf);this.hb.$(ba.a.j9g,wd.hf);this.hb.$(ba.a.Q8g,wd.hf);this.hb.$(ba.a.R8g,wd.hf);this.hb.$(ba.a.S8g,wd.hf);this.hb.$(ba.a.T8g,wd.hf);this.hb.$(ba.a.U8g,wd.hf);this.hb.$(ba.a.V8g,wd.hf);this.hb.$(ba.a.W8g,wd.hf);this.hb.$(ba.a.X8g,
wd.hf);this.hb.$(ba.a.Y8g,wd.hf);this.hb.$(ba.a.Z8g,wd.hf);this.hb.$(ba.a.$8g,wd.hf);this.hb.$(ba.a.a9g,wd.hf);this.hb.$(ba.a.zBe,wd.hf);this.hb.$(ba.a.yBe,wd.hf);this.hb.$(ba.a.xBe,wd.hf);this.hb.$(ba.a.ABe,wd.hf)}Rxj(){this.Vc.$(ba.a.fBe,wd.YA);this.hb.$(ba.a.fBe,wd.hf);this.Vc.$(ba.a.Ipg,wd.OMk);this.hb.$(ba.a.nRa,Object(D.a)(this,this.n9c,"parseSmartArtParametersBridge"));this.hb.$(ba.a.MUb,Object(D.a)(this,this.n9c,"parseSmartArtParametersBridge"));this.hb.$(ba.a.zCc,Object(D.a)(this,this.n9c,
"parseSmartArtParametersBridge"));this.hb.$(ba.a.ACc,Object(D.a)(this,this.n9c,"parseSmartArtParametersBridge"));this.Vc.$(ba.a.FAe,wd.YA);this.hb.$(ba.a.FAe,wd.hf);this.hb.$(ba.a.BNa,Object(D.a)(this,this.Xji,"changePictureStyleExecuteBridge"));this.hb.$(ba.a.dbd,wd.hf);this.hb.$(ba.a.egc,wd.P_);this.hb.$(ba.a.ggc,wd.P_);this.hb.$(ba.a.fgc,wd.P_);this.hb.$(ba.a.Bad,wd.P_)}Swj(){this.hb.$(ba.a.u8g,ig.EAe);this.hb.$(ba.a.ead,wd.hf);this.hb.$(ba.a.Dad,wd.hf);this.hb.$(ba.a.uad,wd.hf);this.hb.$(ba.a.Lad,
wd.hf);this.hb.$(ba.a.Mad,wd.hf);this.hb.$(ba.a.Kad,wd.hf);this.hb.$(ba.a.Nad,wd.hf);this.hb.$(ba.a.fbd,wd.hf);this.hb.$(ba.a.Cad,wd.hf);this.hb.$(ba.a.rad,wd.hf);this.hb.$(ba.a.mad,wd.hf);this.hb.$(ba.a.Had,wd.hf)}qxj(){this.hb.$(ba.a.gad,wd.hf);this.hb.$(ba.a.vad,wd.hf);this.hb.$(ba.a.xgc,Object(D.a)(this,this.oad,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ba.a.ygc,Object(D.a)(this,this.oad,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ba.a.aEb,wd.hf);this.hb.$(ba.a.$Db,wd.hf);this.hb.$(ba.a.ZDb,
wd.hf);this.hb.$(ba.a.pBe,wd.hf);this.hb.$(ba.a.wDk,wd.hf);this.hb.$(ba.a.ibd,wd.Ead);this.hb.$(ba.a.hbd,wd.Ead);this.hb.$(ba.a.kBe,wd.Ead);this.hb.$(ba.a.NAe,wd.Ead);this.hb.$(ba.a.Lgc,Object(D.a)(this,this.RMk,"remapRumTrackerExecuteQueryBridge"));this.hb.$(ba.a.cgc,wd.hf);this.hb.$(ba.a.Iad,ig.Yfc);this.hb.$(ba.a.o8g,wd.hf);this.hb.$(ba.a.zad,wd.hf);this.hb.$(ba.a.had,wd.hf);this.hb.$(ba.a.Cgc,wd.hf);this.hb.$(ba.a.ebd,wd.hf);this.hb.$(ba.a.n9g,ig.Yfc);this.hb.$(ba.a.sBe,wd.hf);this.hb.$(ba.a.rBe,
wd.hf);this.hb.$(ba.a.H8g,wd.hf);this.hb.$(ba.a.Pgc,wd.hf);this.hb.$(ba.a.Sgc,wd.hf);this.hb.$(ba.a.Tgc,wd.hf);this.hb.$(ba.a.Rgc,wd.hf);this.hb.$(ba.a.Qgc,wd.hf);this.hb.$(ba.a.Agc,wd.hf);this.hb.$(ba.a.Jgc,wd.hf);this.hb.$(ba.a.Bgc,wd.hf);this.hb.$(G.a.Vfc,ig.Yfc);this.Vc.$(ba.a.ixe,wd.YA);this.hb.$(ba.a.y3a,wd.Fhd);this.hb.$(ba.a.DNa,wd.Fhd);this.hb.$(ba.a.uTb,wd.Fhd);this.hb.$(ba.a.CAc,wd.Fhd);this.Vc.$(ba.a.P4f,wd.dUi);this.hb.$(ba.a.nBe,wd.OCk);this.Vc.$(ba.a.bBe,wd.YA);this.hb.$(ba.a.bBe,wd.hf);
this.Vc.$(ba.a.H5a,Object(D.a)(this,this.ew,"remapTextQueryEnabled"));this.hb.$(ba.a.jHa,ig.Yfc);this.hb.$(ba.a.D8g,wd.hf);this.hb.$(ba.a.lBe,wd.hf);this.hb.$(ba.a.v8g,wd.hf);this.hb.$(ba.a.w8g,wd.hf);this.hb.$(ba.a.ehc,wd.hf);this.hb.$(ba.a.Y7g,wd.hf);this.hb.$(C.a.xye,ig.C2b);this.hb.$(C.a.cut,Object(D.a)(this,this.GFc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.copy,Object(D.a)(this,this.GFc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.paste,Object(D.a)(this,this.GFc,"cutCopyPasteExecuteBridge"));
this.hb.$(C.a.tva,Object(D.a)(this,this.GFc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.openInClient,Object(D.a)(this,this.rqk,"openInPowerPointExecuteBridge"));this.hb.$(C.a.nad,wd.hf);this.hb.$(ba.a.pad,wd.hf);this.hb.$(ba.a.z$c,Object(D.a)(this,this.Cbh,"remapUndoRedoExecute"));this.hb.$(ba.a.u$c,Object(D.a)(this,this.Cbh,"remapUndoRedoExecute"));this.hb.$(ba.a.afc,Object(D.a)(this,this.icd,"remapCutCopyPasteExecute"));this.hb.$(ba.a.$ec,Object(D.a)(this,this.icd,"remapCutCopyPasteExecute"));this.hb.$(ba.a.tDb,
Object(D.a)(this,this.icd,"remapCutCopyPasteExecute"));this.hb.$(ba.a.r$c,Object(D.a)(this,this.icd,"remapCutCopyPasteExecute"));this.Vc.$(ba.a.z$c,Object(D.a)(this,this.Bbh,"remapUndoRedoEnabled"));this.Vc.$(ba.a.u$c,Object(D.a)(this,this.Bbh,"remapUndoRedoEnabled"));this.Vc.$(ba.a.afc,Object(D.a)(this,this.geb,"remapCutCopyPasteEnabled"));this.Vc.$(ba.a.$ec,Object(D.a)(this,this.geb,"remapCutCopyPasteEnabled"));this.Vc.$(ba.a.tDb,Object(D.a)(this,this.geb,"remapCutCopyPasteEnabled"));this.Vc.$(ba.a.r$c,
Object(D.a)(this,this.geb,"remapCutCopyPasteEnabled"));this.Vc.$(C.a.cut,Object(D.a)(this,this.geb,"remapCutCopyPasteEnabled"));this.Vc.$(C.a.paste,Object(D.a)(this,this.geb,"remapCutCopyPasteEnabled"));this.Vc.$(C.a.tva,Object(D.a)(this,this.geb,"remapCutCopyPasteEnabled"));this.hb.$(C.a.W9,wd.EGf);this.hb.$(C.a.Ss,wd.EGf);this.hb.$(C.a.tO,Object(D.a)(this,this.$zg,"listsExecuteBridge"));this.hb.$(C.a.XQ,Object(D.a)(this,this.$zg,"listsExecuteBridge"));this.hb.$(ba.a.aHb,wd.Ibl);this.hb.$(ba.a.RDb,
wd.P_);this.hb.$(ba.a.SDb,wd.P_);this.hb.$(ba.a.Jad,wd.hf);this.hb.$(ba.a.kad,wd.hf);this.hb.$(ba.a.lad,wd.hf);this.hb.$(ba.a.Gad,wd.hf);this.la.YMa&&this.hb.$(ba.a.dad,wd.hf)}$wj(){this.Vc.$(ba.a.zzj,Object(D.a)(this,this.JXb,"doPresentationCheckEnableRemap"));this.Vc.$(ba.a.Vji,Object(D.a)(this,this.JXb,"doPresentationCheckEnableRemap"));this.Vc.$(ba.a.Mji,Object(D.a)(this,this.JXb,"doPresentationCheckEnableRemap"));this.Vc.$(ba.a.Fzj,Object(D.a)(this,this.JXb,"doPresentationCheckEnableRemap"));
this.Vc.$(ba.a.Ozj,Object(D.a)(this,this.JXb,"doPresentationCheckEnableRemap"))}JXb(a){const b=new $k;this.Qb&&1===this.Qb.Nu&&!wd.M7d(a)?b.hK=!1:(b.qF=!0,b.Jm=ba.a.cqb);return b}q0i(){const a=new aM;a.sTb=wd.jxk;a.YHd=wd.kxk;a.eze=Object(D.a)(this,this.Oxk,"powerPointPreExecCommand");a.Fye=null;return a}Oxk(a,b){var c=this.ra.ae();c=1===c.length&&c[0].nd&&this.ra.uG()&&!c[0].WP;switch(a.Jm){case C.a.font:case C.a.u4:case C.a.LHa:case C.a.bold:case C.a.setItalic:case C.a.underline:case C.a.strikethrough:case C.a.Ss:case C.a.W9:case C.a.Yza:case C.a.$H:case C.a.lJ:case C.a.eHa:case C.a.qXa:case C.a.HE:case C.a.Ry:case C.a.tO:case C.a.XQ:case C.a.eha:case C.a.jja:case C.a.sma:case C.a.uBa:case ba.a.Ila:case ba.a.Pla:case ba.a.Ola:case ba.a.Nla:case C.a.uOa:case C.a.Kra:case C.a.Rwa:case C.a.Swa:case C.a.Twa:case C.a.SIa:case C.a.TIa:case C.a.Jza:case C.a.u1:case ba.a.xva:case ba.a.yWa:case ba.a.Lfb:case ba.a.$Xa:case ba.a.jwa:case ba.a.aYa:case ba.a.Ihd:case ba.a.Hhd:b||
(b={}),b[ri.a.Myc]=!(this.ra.gSa()||c),b[ri.a.Nzf]=!!this.ra.kia()}return null}Szg(a,b,c){const f=new Pg;b=b.MenuItemId;f.ld=this.ore(b,a);b&&ya.a.J(512493027,820,50,"ListGallery Set on Shape from {0}",c.CommandLocation);return f}ore(a,b){a=a?parseInt(a):-1;switch(b){case ba.a.FGb:case C.a.tO:case ba.a.xgc:case ba.a.JWa:return this.uzb.I0b(a);case ba.a.nGb:case C.a.XQ:case ba.a.ygc:case ba.a.KWa:return this.uzb.BNc(a);default:return 18}}ETi(a,b){a=new Pg;a.ld=b.CommandValueId;return a}oad(a,b){const c=
new Pg,f=new zv;f.LWa=new Ph.a;f.menuItemId=this.ore(b.MenuItemId,a);c.ld=f;c.TV=!0;return c}Eva(a,b){a=new Pg;const c={};c.queryResult=new Ph.a;const f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.ld=c;a.TV=!0;return a}skd(a,b){a=new Pg;const c={},f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.ld=c;return a}Xji(a,b){a=new Pg;a.ld=parseFloat(b[b.MenuItemId?
"MenuItemId":"SourceControlId"]);return a}Odb(a){const b=new Pg,c={},f=new Ph.a;switch(a){case ba.a.g8g:f.Kf(this.OTa.isEnabled($d.CCa));break;case ba.a.a8g:f.Kf(this.OTa.isEnabled($d.BCa));break;case ba.a.d8g:f.Kf(this.OTa.isEnabled($d.x7));break;case ba.a.b8g:f.Kf(this.OTa.isEnabled($d.w7));break;case ba.a.e8g:f.Kf(this.OTa.isEnabled($d.MB));break;case ba.a.f8g:f.Kf(this.OTa.isEnabled($d.ZE));break;case ba.a.c8g:f.Kf(this.OTa.isEnabled($d.YE));break;case ba.a.JCk:f.Kf(this.OTa.isEnabled($d.Ora))}c.queryResult=
f;b.ld=c;b.TV=!0;return b}$zg(a,b,c){const f=new Pg;f.ld=new E.DictionaryPropertySet;b=b.MenuItemId;this.Uul(f.ld,a,this.ore(b,a));b&&ya.a.J(512493026,820,50,"ListGallery Set in Box4 View from {0}",c.CommandLocation);return f}Yki(){return Object.assign(new $k,{ld:new Ph.a,hK:!!this.IYj.Ba})}Mob(){const a=new $k,b=this.ra.Po();if(!b)return a;this.sc.o7d(b)&&(a.qF=!1,a.hK=!1,a.Jm=ce.ActionManager.jYb);return a}Uul(a,b,c){let f=14,l=0;0===c?(f=16,l=0):b===C.a.tO?(l=f=1,this.uzb.aRc(c)&&(b=this.uzb.DSa.ga(c),
a.setValue(bb.a.Ni,[b.eUb]),a.setValue(bb.a.font,b.$nb))):b===C.a.XQ&&(f=0,l=1,a.setValue(bb.a.HSa,1),a.setValue(ub.a.autonumberBulletType,8),this.uzb.bRc(c)&&(b=this.uzb.h6c.ga(c),a.setValue(ub.a.autonumberBulletType,b.eJd),a.setValue(bb.a.Ni,[65533,b.sVg,Ma.a.charCodeAt(b.yVg,0)])));a.setValue(be.a.tD,f);a.setValue(be.a.nca,l)}Okd(a){let b;if(this.Boh()||this.ra.kia()){if(({te:b}=wd.Ikd(a,this.ra.lD())).returnValue)return{returnValue:!0,g4:b}}else if(this.B9k()&&({te:b}=wd.syh(a)).returnValue)return{returnValue:!0,
g4:b};return{returnValue:!1,g4:0}}zRe(a){let b;b=0;a===ba.a.z$c?b=ba.a.Ddb:a===ba.a.u$c&&(b=ba.a.Cdb);return{returnValue:!!b,g4:b}}yRe(a){let b;b=0;this.Boh()?a===ba.a.afc?b=C.a.cut:a===ba.a.$ec?b=C.a.copy:a===ba.a.tDb?b=C.a.paste:a===ba.a.r$c&&(b=C.a.tva):(a===ba.a.afc&&(b=ba.a.Kpb),a===ba.a.$ec?b=ba.a.bWb:a===ba.a.tDb&&(b=ba.a.vec));return{returnValue:!!b,g4:b}}Gyh(a){switch(a){case C.a.aba:return a=ba.a.lDb,{returnValue:!0,te:a};case C.a.Xic:return a=ba.a.Sye,{returnValue:!0,te:a};case C.a.insertTable:return a=
ba.a.n5g,{returnValue:!0,te:a}}a=ce.ActionManager.j4;return{returnValue:!1,te:a}}Qs(a){let b=new Pg;if(({result:b}=this.eub(a)).returnValue)return b;({g4:a}=this.Okd(a)).returnValue&&(b.qF=!0,b.Jm=a);return b}Xnh(a){switch(a){case ba.a.oDb:case ba.a.lfc:case ba.a.ofc:case ba.a.qDb:case ba.a.vDb:case ba.a.sDb:if(this.ra.Wia()||this.ra.GK())return Object.assign(new $k,{qF:!1,hK:!1});break;case ba.a.XDb:case ba.a.WDb:case ba.a.kfc:case ba.a.nfc:case ba.a.nDb:if(this.ra.Wia())return Object.assign(new $k,
{qF:!1,hK:!1});break;case ba.a.xWa:case ba.a.wva:case ba.a.u5g:case ba.a.kDb:case ba.a.rDb:case ba.a.uDb:case ba.a.pDb:case ba.a.mfc:case ba.a.bfc:if(this.ra.GK())return Object.assign(new $k,{qF:!1,hK:!1});break;case ba.a.pfc:case ba.a.y$c:if(this.ra.GK()){var b=this.ra.Oa.kb;if(b)for(let c of b)if(c&&c.node&&(b=c.node.sa(Bb.a.listLevel,0),a===ba.a.pfc&&!b||$o.a.etg(c.node)))return Object.assign(new $k,{qF:!1,hK:!1})}}return null}es(a){let b;new $k;if(({result:b}=this.i7d(a)).returnValue)return this.Bfd(b,
a);b=this.Xnh(a);if(!b){let c;b=new $k;({g4:c}=this.Okd(a)).returnValue&&(b.qF=!0,b.Jm=c)}return this.Bfd(b,a)}ama(a,b=null){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new $k,{$cb:a,Jm:ba.a.KFe,ld:c})}RMk(a,b){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Pg,{Jm:ba.a.KFe,ld:c,TV:!0})}UD(a){let b=new Pg;if(({result:b}=this.eub(a)).returnValue)return b;({g4:a}=this.Okd(a)).returnValue?(b.qF=!0,b.Jm=a):(b.ld=new Ph.a,b.TV=!0);return b}ew(a){let b;new $k;
if(({result:b}=this.i7d(a)).returnValue)return this.Bfd(b,a);b=this.Xnh(a);if(!b){let c;b=new $k;({g4:c}=this.Okd(a)).returnValue?(b.qF=!0,b.Jm=c):b.ld=new Ph.a}return this.Bfd(b,a)}Cbh(a){const b=new Pg;({g4:a}=this.zRe(a)).returnValue&&(b.qF=!0,b.Jm=a);return b}Bbh(a){const b=new $k;({g4:a}=this.zRe(a)).returnValue&&(b.qF=!0,b.Jm=a);return b}PMk(){const a=new $k;a.qF=!0;a.Jm=ba.a.Oye;return a}QMk(){const a=new Pg;a.qF=!0;a.Jm=ba.a.Oye;return a}icd(a){let b=new Pg;if(({result:b}=this.eub(a)).returnValue)return b;
({g4:a}=this.yRe(a)).returnValue&&(b.qF=!0,b.Jm=a);return b}jcd(a){let b=new Pg;if(({result:b}=this.eub(a)).returnValue)return b;({te:a}=this.Gyh(a)).returnValue&&(b.qF=!0,b.Jm=a);return b}FNa(a,b){let c=new Pg;if(({result:c}=this.eub(a)).returnValue)return c;if(this.ra.ku())return c.qF=!0,c.Jm=ce.ActionManager.jYb,c;c.Jm=a;c.ld=b;return c}geb(a){let b=new $k;if(!this.Sb.Nj())return b.hK=!1,b;if(({result:b}=this.i7d(a)).returnValue)return b;({g4:a}=this.yRe(a)).returnValue&&(b.qF=!0,b.Jm=a);return b}Boh(){return this.ra.lD()}B9k(){return this.ra.uG()}n9c(a,
b){const c=new Pg;if(!b)throw Error.argumentNull();b=b[b.MenuItemId?"MenuItemId":"SourceControlId"].split(",");b=Object.assign(new EQ.a,{Uri:b[0],Category:b[1]});const f=b.Uri;a!==ba.a.nRa&&a!==ba.a.zCc||ya.a.J(512493024,801,50,(a===ba.a.nRa?"InsertSmartArt: ":"ChangeSmartArtLayout: ")+"{0}",f);c.ld=b;return c}vUc(a,b,c){return this.Qs(a,b,c)}GFc(a){let b=new Pg;if(({result:b}=this.eub(a)).returnValue)return b;b.Jq=this.la.iRc||this.la.ysg&&this.la.WEj&&n.a.$n;return b}rqk(a,b,c){a=new Pg;ya.a.J(512493023,
801,50,"CuiActionBridge::OpenInPowerPointExecuteBridge - Open In PowerPoint from {0}",c.CommandLocation);return a}eub(a){let b;b=new Pg;return this.Dqg(a)?(b.qF=!1,b.hK=!1,b.Jm=ce.ActionManager.jYb,{returnValue:!0,result:b}):{returnValue:!1,result:b}}i7d(a){let b;b=new $k;return this.Dqg(a)?(b.qF=!1,b.hK=!1,b.Jm=ce.ActionManager.jYb,{returnValue:!0,result:b}):{returnValue:!1,result:b}}Dqg(a){return this.jBj(a)}jBj(a){return this.la.podsTableCellLockEnabled&&this.la.podsTableRTTEnabled&&wd.Mfi.contains(a)?
this.ra.L7()?!0:!1:!1}Bfd(a,b){if(ee.a("SetMappedCommandActionData")){let c=0;if(({te:c}=wd.Ikd(b,this.ra.lD())).returnValue||({te:c}=wd.syh(b)).returnValue||({g4:c}=this.zRe(b)).returnValue||({g4:c}=this.yRe(b)).returnValue||({te:c}=this.Gyh(b)).returnValue)a.ld||(a.ld={}),a.ld.MappedCommand=c}return a}static M7d(a){const b=wd.pdj();let c=!1;for(const f of b)if(f===a){c=!0;break}return c}static pdj(){wd.Hac||(wd.Hac=[ba.a.z$c,ba.a.u$c,ba.a.tDb,ba.a.idb,ba.a.jdb,ba.a.$ec,ba.a.deleteObject,ba.a.kYf,
ba.a.cqb,ba.a.oGa,ba.a.mPc,ba.a.Lzh,ba.a.bS,ba.a.print,ba.a.fAk,ba.a.A6g,ba.a.B6g,ba.a.v$c,ba.a.r5g,ba.a.s5g,ba.a.downloadACopy,ba.a.aHc,ba.a.bHc,ba.a.cHc,ba.a.y3a,ba.a.sad,ba.a.DNa,ba.a.bJe,ba.a.aJe,ba.a.I1g,ba.a.Uec,ba.a.chc,ba.a.kHa,ba.a.bEb,ba.a.aea,ba.a.Fva,ba.a.kwa,ba.a.AGb,ba.a.dgd,ba.a.BGb,ba.a.lwa,ba.a.dlc,ba.a.DYa,ba.a.yIb,ba.a.Pgc,ba.a.DDb,ba.a.Gfc,ba.a.L$c,ba.a.Bgc,ba.a.Bdb,ba.a.Agc,ba.a.Jgc,ba.a.M8g,ba.a.e$c,ba.a.f$c,ba.a.bkd,ba.a.Sgc,ba.a.ckd,ba.a.Tgc,ba.a.akd,ba.a.Rgc,ba.a.$jd,ba.a.Qgc,
ba.a.xmc,ba.a.Cgc,ba.a.$la,ba.a.fcd,ba.a.ehc,ba.a.PCh,ba.a.klg,G.a.gnb,G.a.fad,ba.a.openInClient,G.a.iMe,G.a.Qdc,G.a.Lfc,G.a.Ckc,G.a.Dkc,ba.a.fgb,ba.a.pYa,ba.a.H1g,ba.a.cgc,ba.a.Fid,ba.a.Gid,C.a.xye,ba.a.$vk,ba.a.kla,ba.a.P4f,ba.a.bS,ba.a.JM,ba.a.aEe,ba.a.tch,ba.a.BTg,ba.a.ATg,ba.a.gTe,ba.a.Jmb,ba.a.immersiveReader,C.a.copy,C.a.paste,ba.a.Kpb,ba.a.bWb,ba.a.vec,ba.a.Ddb,ba.a.Cdb,ba.a.tnh,G.a.kBa,G.a.renameFile,ba.a.CDb,ba.a.d6g,ba.a.P9c,ba.a.M$c,ba.a.gcd]);wd.Hac.push(ba.a.Vfd);if(u.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")){const a=
[ba.a.T4g,ba.a.tad,ba.a.CQc];let b;(b=wd.Hac).push.apply(b,a)}return wd.Hac}static kxk(a,b){const c=a.$cb;let f=!0,l=null;if(null===a||null===a.ld)return!1;a=a.ld;null!==a.queryResult&&(l=a.queryResult);if(null!==l&&null!==l.Fea)switch(c){case ba.a.kHa:case ba.a.Zgc:case ba.a.$gc:case ba.a.gbd:case ba.a.BBe:case ba.a.Wgc:case ba.a.Xgc:case ba.a.Ygc:case ba.a.Vgc:case ba.a.egc:case ba.a.ggc:case ba.a.fgc:case ba.a.Bad:case ba.a.RDb:case ba.a.SDb:a=parseFloat(l.Fea);0<a||c===ba.a.kHa||c===ba.a.egc||
c===ba.a.ggc||c===ba.a.fgc||c===ba.a.Bad||c===ba.a.RDb||c===ba.a.SDb||0<=a&&(c===ba.a.Wgc||c===ba.a.Xgc||c===ba.a.Ygc||c===ba.a.Vgc)?(b[mn.Text]=l.Fea,b[mn.Number]=a):(b[mn.Text]="",b[mn.Number]=Number.NaN);b[mn.UnitType]=c===ba.a.kHa?8:3;break;default:f=!1}return f}static jxk(a,b){if(ig.sTb(a,b))return!0;if(!a||!a.ld)return!1;var c=null;Object(Fa.a)(Ph.a,a.ld)?c=a.ld:Object(Fa.a)(zv,a.ld)?(c=a.ld,b.SourceControlId=c.XT,c=c.LWa):Object(Fa.a)(Object,a.ld)&&(a=a.ld,a.queryResult&&(c=a.queryResult));
c&&(b[ai.a.On]=c.Ujd?c.Ujd.value:!1,c.DDc&&(b[no.a.IsFreeForm]=c.DDc.value),c.vBa&&(b[fm.a.InnerHTML]=c.vBa),c.rrb&&(b[fm.a.Alt]=c.rrb),c.fKc&&(b[fm.a.On]=c.fKc.value),void 0!==c.K1&&null!==c.K1&&(b[no.a.Value]=c.K1),void 0!==c.zBc&&null!==c.zBc&&(b[eE.a.LabelText]=c.zBc),c.h2&&(b[fm.a.GalleryButtonProps]=c.h2),c.gJf&&(b[eE.a.Image32by32Class]=c.gJf),void 0!==c.M5a&&null!==c.M5a&&(b[Am.a.labelText]=c.M5a));return!0}static YA(){const a=new $k;a.ld=new Ph.a;return a}static hf(){const a=new Pg;a.ld=
new Ph.a;a.TV=!0;return a}static Rzg(a,b,c){ya.a.J(512493021,820,50,"ListGallery Dropdown from {0}",c.CommandLocation);a=new Pg;a.ld=b;return a}static pOe(a,b){a=new Pg;a.ld=b.Color;return a}static EGf(a,b){a=new Pg;a.ld=b.Color;a.Jq=!0;return a}static Ibl(){const a=new Pg;a.ld={InvokeSource:0,ShowRevisionTrackingStatus:1};return a}static Ead(a,b){a=new Pg;const c=new zv;c.LWa=new Ph.a;c.XT=b.SourceControlId;a.ld=c;a.TV=!0;return a}static Fhd(a,b){a=new Pg;a.ld=b.SourceControlId;return a}static P_(){const a=
new Pg,b={},c=new Ph.a;b.queryResult=c;a.ld=b;a.g$d=!0;return a}static fYa(a){const b=new $k;switch(a){case ba.a.KFf:b.Jm=ba.a.tTb;break;case ba.a.LFf:b.Jm=ba.a.snb;break;case ba.a.XHd:b.Jm=ba.a.HAc;break;case ba.a.THd:b.Jm=ba.a.FAc;break;case ba.a.WHd:b.Jm=ba.a.VHd;break;case ba.a.UHd:b.Jm=ba.a.GAc;break;case ba.a.MFf:b.Jm=ba.a.uTb;break;case ba.a.CFf:b.Jm=ba.a.CAc}return b}static dUi(){const a=new $k;a.Jm=ba.a.G5a;return a}static OCk(){const a=new Pg,b={},c=new Ph.a;c.Kf(!1);b.queryResult=c;a.ld=
b;a.TV=!0;return a}static Ikd(a,b){switch(a){case ba.a.Yec:return a=C.a.bold,{returnValue:!0,te:a};case ba.a.kDb:return a=C.a.eha,{returnValue:!0,te:a};case ba.a.nDb:return a=C.a.font,{returnValue:!0,te:a};case ba.a.kfc:return a=C.a.u4,{returnValue:!0,te:a};case ba.a.nfc:return a=C.a.LHa,{returnValue:!0,te:a};case ba.a.mDb:return a=C.a.Ss,{returnValue:!0,te:a};case ba.a.cfc:return a=C.a.W9,{returnValue:!0,te:a};case ba.a.Zec:return a=C.a.Yza,{returnValue:!0,te:a};case ba.a.efc:return a=C.a.setItalic,
{returnValue:!0,te:a};case ba.a.rDb:return a=C.a.jja,{returnValue:!0,te:a};case ba.a.gfc:return a=ba.a.ixe,{returnValue:!0,te:a};case ba.a.hfc:return a=C.a.iDb,{returnValue:!0,te:a};case ba.a.oDb:return a=C.a.yr,{returnValue:!0,te:a};case ba.a.lfc:return a=C.a.eHa,{returnValue:!0,te:a};case ba.a.ofc:return a=C.a.qXa,{returnValue:!0,te:a};case ba.a.vDb:return a=C.a.lJ,{returnValue:!0,te:a};case ba.a.qDb:return a=C.a.$H,{returnValue:!0,te:a};case ba.a.qfc:return a=C.a.strikethrough,{returnValue:!0,
te:a};case ba.a.ifc:return a=ba.a.z2g,{returnValue:!0,te:a};case ba.a.jfc:return a=ba.a.$Ga,{returnValue:!0,te:a};case ba.a.uDb:return a=C.a.sma,{returnValue:!0,te:a};case ba.a.pDb:return a=C.a.uBa,{returnValue:!0,te:a};case ba.a.wfc:return a=C.a.underline,{returnValue:!0,te:a};case ba.a.mfc:return a=C.a.Ry,{returnValue:!0,te:a};case ba.a.bfc:return a=C.a.HE,{returnValue:!0,te:a};case ba.a.pfc:return a=C.a.Ry,{returnValue:!0,te:a};case ba.a.y$c:return a=C.a.HE,{returnValue:!0,te:a};case ba.a.wva:return a=
C.a.tO,{returnValue:!0,te:a};case ba.a.xWa:return a=C.a.XQ,{returnValue:!0,te:a};case ba.a.ffc:return a=ba.a.Ila,{returnValue:!0,te:a};case ba.a.sDb:return a=ba.a.Abe,{returnValue:!0,te:a};case ba.a.H5a:return a=C.a.OJc,{returnValue:!0,te:a};case ba.a.rfc:return a=C.a.subscript,{returnValue:!0,te:a};case ba.a.sfc:return a=C.a.superscript,{returnValue:!0,te:a}}return b?wd.gql(a):wd.ryh(a)}static syh(a){switch(a){case ba.a.Yec:return a=ba.a.XXa,{returnValue:!0,te:a};case ba.a.kDb:return a=ba.a.GGb,
{returnValue:!0,te:a};case ba.a.nDb:return a=ba.a.Gfb,{returnValue:!0,te:a};case ba.a.oDb:return a=ba.a.Hfb,{returnValue:!0,te:a};case ba.a.efc:return a=ba.a.YXa,{returnValue:!0,te:a};case ba.a.rDb:return a=ba.a.Ifb,{returnValue:!0,te:a};case ba.a.uDb:return a=ba.a.Vfb,{returnValue:!0,te:a};case ba.a.pDb:return a=ba.a.mGb,{returnValue:!0,te:a};case ba.a.wfc:return a=ba.a.ZXa,{returnValue:!0,te:a};case ba.a.wva:return a=ba.a.FGb,{returnValue:!0,te:a};case ba.a.k$c:return a=ba.a.Vjc,{returnValue:!0,
te:a};case ba.a.l$c:return a=ba.a.rgd,{returnValue:!0,te:a};case ba.a.mDb:return a=ba.a.lGb,{returnValue:!0,te:a};case ba.a.cfc:return a=ba.a.Sfb,{returnValue:!0,te:a};case ba.a.Zec:return a=ba.a.HGb,{returnValue:!0,te:a};case ba.a.xWa:return a=ba.a.nGb,{returnValue:!0,te:a};case ba.a.hfc:return a=ba.a.SJe,{returnValue:!0,te:a};case ba.a.vDb:return a=ba.a.JGb,{returnValue:!0,te:a};case ba.a.qDb:return a=ba.a.Wjc,{returnValue:!0,te:a};case ba.a.qfc:return a=ba.a.oGb,{returnValue:!0,te:a};case ba.a.Pla:return a=
ba.a.Sfd,{returnValue:!0,te:a};case ba.a.Ola:return a=ba.a.Rfd,{returnValue:!0,te:a};case ba.a.Nla:return a=ba.a.Qfd,{returnValue:!0,te:a};case ba.a.ifc:case ba.a.gfc:return wd.Ikd(a,!0);case ba.a.jfc:return wd.Ikd(a,!0);case ba.a.ffc:return a=ba.a.Pfd,{returnValue:!0,te:a};case ba.a.sDb:return a=ba.a.QJe,{returnValue:!0,te:a};case ba.a.rfc:return a=ba.a.Zjc,{returnValue:!0,te:a};case ba.a.sfc:return a=ba.a.$jc,{returnValue:!0,te:a}}return wd.ryh(a)}static gql(a){switch(a){case ba.a.igc:return a=
C.a.Wfc,{returnValue:!0,te:a};case ba.a.kgc:return a=C.a.Zfc,{returnValue:!0,te:a};case ba.a.ogc:return a=C.a.bgc,{returnValue:!0,te:a};case ba.a.XDb:return a=G.a.gnb,{returnValue:!0,te:a};case ba.a.WDb:return a=G.a.gnb,{returnValue:!0,te:a};case ba.a.lgc:return a=C.a.jad,{returnValue:!0,te:a};case ba.a.mgc:return a=C.a.$fc,{returnValue:!0,te:a};case ba.a.pgc:return a=C.a.dgc,{returnValue:!0,te:a};case ba.a.sgc:return a=C.a.Dgc,{returnValue:!0,te:a};case ba.a.ngc:return a=C.a.agc,{returnValue:!0,
te:a};case ba.a.wgc:return a=ba.a.aEb,{returnValue:!0,te:a};case ba.a.vgc:return a=ba.a.$Db,{returnValue:!0,te:a};case ba.a.ugc:return a=ba.a.ZDb,{returnValue:!0,te:a};case ba.a.zgc:return a=C.a.dhc,{returnValue:!0,te:a};case ba.a.jgc:return a=ba.a.gad,{returnValue:!0,te:a};case ba.a.rgc:return a=ba.a.vad,{returnValue:!0,te:a};case ba.a.iHa:return a=ba.a.xgc,{returnValue:!0,te:a};case ba.a.Qdb:return a=ba.a.ygc,{returnValue:!0,te:a};case ba.a.tgc:return a=C.a.Mgc,{returnValue:!0,te:a};case ba.a.qgc:return a=
ba.a.IWa,{returnValue:!0,te:a};case ba.a.Rdb:return a=C.a.Ogc,{returnValue:!0,te:a};case ba.a.Sdb:return a=C.a.Ugc,{returnValue:!0,te:a}}a=ce.ActionManager.j4;return{returnValue:!1,te:a}}static ryh(a){switch(a){case ba.a.igc:return a=ba.a.Fgc,{returnValue:!0,te:a};case ba.a.kgc:return a=ba.a.Qad,{returnValue:!0,te:a};case ba.a.ogc:return a=ba.a.Ggc,{returnValue:!0,te:a};case ba.a.lgc:return a=ba.a.Tad,{returnValue:!0,te:a};case ba.a.mgc:return a=ba.a.Uad,{returnValue:!0,te:a};case ba.a.pgc:return a=
ba.a.Wad,{returnValue:!0,te:a};case ba.a.sgc:return a=ba.a.Yad,{returnValue:!0,te:a};case ba.a.ngc:return a=ba.a.Vad,{returnValue:!0,te:a};case ba.a.wgc:return a=ba.a.cbd,{returnValue:!0,te:a};case ba.a.vgc:return a=ba.a.bbd,{returnValue:!0,te:a};case ba.a.ugc:return a=ba.a.abd,{returnValue:!0,te:a};case ba.a.zgc:return a=ba.a.Igc,{returnValue:!0,te:a};case ba.a.jgc:return a=ba.a.Vdb,{returnValue:!0,te:a};case ba.a.XDb:return a=ba.a.Sad,{returnValue:!0,te:a};case ba.a.WDb:return a=ba.a.Rad,{returnValue:!0,
te:a};case ba.a.rgc:return a=ba.a.Wdb,{returnValue:!0,te:a};case ba.a.iHa:return a=ba.a.JWa,{returnValue:!0,te:a};case ba.a.Qdb:return a=ba.a.KWa,{returnValue:!0,te:a};case ba.a.tgc:return a=ba.a.Hgc,{returnValue:!0,te:a};case ba.a.qgc:return a=ba.a.Xad,{returnValue:!0,te:a};case ba.a.Rdb:return a=ba.a.Zad,{returnValue:!0,te:a};case ba.a.Sdb:return a=ba.a.$ad,{returnValue:!0,te:a}}a=ce.ActionManager.j4;return{returnValue:!1,te:a}}static OMk(a){const b=new $k;switch(a){case ba.a.Ipg:b.Jm=ba.a.nRa}return b}static Jzg(a,
b){a=new Pg;if(!b)throw Error.argumentNull();a.ld=wd.Z$f(b.MenuItemId);return a}static l8g(a,b){a=new Pg;const c={},f=new Ph.a;f.Kf(!1);c.queryResult=f;c.MenuItemId=wd.Z$f(b.MenuItemId);c.LineSpacingValue=-1;c.LineSpacingUnit=0;a.ld=c;a.TV=!0;a.f$d=!0;return a}static Z$f(a){return parseFloat(a)}}wd.Hac=null;wd.Mfi=(cf=new Ha.a,cf.add(C.a.cut),cf.add(C.a.paste),cf.add(C.a.tva),cf.add(C.a.aba),cf.add(C.a.W9),cf.add(C.a.MMd),cf.add(C.a.Yza),cf.add(C.a.u4),cf.add(C.a.LHa),cf.add(C.a.eHa),cf.add(C.a.qXa),
cf.add(ba.a.igc),cf.add(ba.a.ogc),cf.add(ba.a.zgc),cf.add(ba.a.kgc),cf.add(ba.a.pgc),cf.add(ba.a.sgc),cf.add(ba.a.ngc),cf.add(ba.a.wgc),cf.add(ba.a.vgc),cf.add(ba.a.ugc),cf.add(ba.a.lgc),cf.add(ba.a.mgc),cf.add(ba.a.jgc),cf.add(ba.a.rgc),cf.add(ba.a.iHa),cf.add(ba.a.Qdb),cf.add(ba.a.XDb),cf.add(ba.a.WDb),cf.add(ba.a.tgc),cf.add(ba.a.qgc),cf.add(ba.a.Rdb),cf.add(ba.a.Sdb),cf.add(ba.a.x8g),cf.add(ba.a.z8g),cf.add(ba.a.y8g),cf.add(ba.a.dBe),cf.add(ba.a.cBe),cf.add(ba.a.Yec),cf.add(ba.a.efc),cf.add(ba.a.wfc),
cf.add(ba.a.kDb),cf.add(ba.a.rDb),cf.add(ba.a.uDb),cf.add(ba.a.pDb),cf.add(ba.a.cfc),cf.add(ba.a.Zec),cf.add(ba.a.nDb),cf.add(ba.a.kfc),cf.add(ba.a.nfc),cf.add(ba.a.oDb),cf.add(ba.a.lfc),cf.add(ba.a.ofc),cf.add(ba.a.vDb),cf.add(ba.a.qDb),cf.add(ba.a.Pla),cf.add(ba.a.Ola),cf.add(ba.a.Nla),cf.add(ba.a.qfc),cf.add(ba.a.gfc),cf.add(ba.a.hfc),cf.add(ba.a.ifc),cf.add(ba.a.jfc),cf.add(ba.a.s$c),cf.add(ba.a.t$c),cf.add(ba.a.wva),cf.add(ba.a.xWa),cf.add(ba.a.FGb),cf.add(ba.a.Sfb),cf.add(ba.a.HGb),cf.add(ba.a.nGb),
cf.add(ba.a.k$c),cf.add(ba.a.l$c),cf.add(ba.a.mDb),cf.add(ba.a.bfc),cf.add(ba.a.mfc),cf.add(ba.a.insertHyperlink),cf.add(ba.a.ffc),cf.add(ba.a.sDb),cf.add(ba.a.rfc),cf.add(ba.a.sfc),cf.add(ba.a.afc),cf.add(ba.a.tDb),cf.add(ba.a.r$c),cf.add(ba.a.lDb),cf.add(ba.a.Mye),cf.add(ba.a.m$c),cf.add(ba.a.vfc),cf.add(ba.a.ufc),cf.add(ba.a.tfc),cf);Object(e.a)(wd,"CuiActionBridge",ig,[]);class iE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UI"}Wb(a){this.K=a;this.K.register(231,"Box4.ISelectionContextMenuProvider").ma().na(()=>
new Bq);let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Xub;n.a.Hj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").owa);this.K.register(Pz,"PowerPointWebEditor.EditSurfaceContextMenu").as("Box4.UI.AEditSurfaceContextMenu").ma().na(()=>new Pz(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.UI.IProofingContextMenuSectionFactory"),this.K.resolve("PowerPointWebEditor.IContextMenuHelper"),
this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),this.K.La("PowerpointPresence.IPresenceManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),b));a.register(232,"PowerPointWebEditor.ICUIManager").ma().na(()=>new $L(a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.IContextMenuUser"),
a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.CuiActionBridge"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IRibbonExternal")));a.register(wd,"PowerPointWebEditor.CuiActionBridge").as("Box4.UI.CuiActionBridge").ma().na(()=>new wd(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IInkRibbonManager")));this.K.register(233,"PowerPointWebEditor.IStatusBarUserHelper").ma().na(()=>new YL(a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(234,"PowerPointWebEditor.IStatusBarUser").ma().na(()=>new bE(a.resolve("PowerPointWebEditor.IStatusBarPane").ya,
a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Graph.IGraphInstance").Bd(7),a.pb("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("PowerPointWebEditor.IStatusBarUserHelper"),a.resolve("Common.IAppSettingsManager"),pd.a.get_instance()));a.register(ax,"CommandUI.ReactRibbonRoot").ma().na(()=>new ax(Hr.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),
a.resolve("Box4.IGeneralCuiUser")));a.register(235,"PowerPointWebEditor.IContextMenuUser").ma().na(()=>new UL(a.resolve("Box4.IContextMenuController"),Object(va.a)(Pz,a.resolve("Box4.UI.AEditSurfaceContextMenu"))));a.register(236,"Box4.IBox4BridgeCommandUi").ma().na(()=>new ZL(a.resolve("Box4.IGeneralCuiUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("Common.IActionManager"),a.resolve("Common.IRibbonExternal")));this.K.register(237,"PowerPointWebEditor.IContextMenuHelper").ma().na(()=>
new TL(a.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(aE,"Box4.UI.EditorServiceProofingContextMenuCreator").ma().na(()=>new aE(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.pb("Box4.Proofing.IIgnoreAllKeywords"),"pegal",a.resolve("PowerPoint.IPathManager").Yj("pegal.png"),!1,a.resolve("Box4.IFormattingReader")))}init(){this.K.resolve("PowerPointWebEditor.ActionCommandsRumTrackerReporter");this.K.resolve("PowerPointWebEditor.CuiActionBridge").initialize();
this.K.resolve("PowerPointWebEditor.ICUIManager").initialize();this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").Ebi(this.K.resolve("Box4.IBox4BridgeCommandUi"))}dispose(){this.K.resolve("PowerPointWebEditor.ICUIManager").dispose();this.K.resolve("PowerPointWebEditor.IStatusBarUser").dispose();this.K.resolve("PowerPointWebEditor.IContextMenuUser").dispose()}static main(){m.a.instance.Ac(new iE)}}Object(e.a)(iE,"PPTWebEditorUIPackage",null,[2,3]);class bM{constructor(a){this.TIh="FontPicker";
this.Iud=null;this.J0=a;this.erc=this.J0.deb(Gr.a.ySa,Object(D.a)(this,this.Uqb,"featureStateChangeCallback"));this.J0.isFeatureEnabled(Gr.a.ySa,!1).then(b=>{this.Iud=b})}get isLicensed(){return this.Iud}Uqb(a){this.Iud=a.isEnabled;a=appChrome.actions.updateFontPickerLicenseState(this.TIh,a.isEnabled);appChrome.api.dispatch(a)}dispose(){this.J0.uEb(Gr.a.ySa,this.erc)}}Object(e.a)(bM,"ModernFontPickerFeatureHelper",null,[221,106]);class Qz{constructor(a){this.sFa=null;a?Object.getType(a)===String?
this.sFa=Qz.deserialize(a):this.sFa=a:(Z.ULS.sendTraceTag(543475146,3021,10,"Failed to populate pinned fonts."),this.sFa=[]);this.EEa=!1}get isDirty(){return this.EEa}get N9c(){return Array.clone(this.sFa)}p_h(a){Array.contains(this.sFa,a)||(Array.add(this.sFa,a),this.EEa=!0)}CNk(a){Array.contains(this.sFa,a)&&(Array.remove(this.sFa,a),this.EEa=!0)}serialize(){return JSON.stringify(this.sFa)}oTk(){this.EEa=!1}static deserialize(a){try{return JSON.parse(a)}catch(b){return Z.ULS.sendTraceTag(543475147,
3021,10,"Deserialize failed: {0}",b.toString()),[]}}}Object(e.a)(Qz,"PinnedFontStore",null,[]);class cM{constructor(a,b,c,f){this.ia=a;this.la=c;this.VNg=b;this.yb=f;this.E3=null}initialize(){this.ia.xa(G.a.Fec,de.a.frame,Object(D.a)(this,this.Fec,"pinOrUnpinFont"));this.ia.pa(G.a.x4f,de.a.frame,Object(D.a)(this,this.AYg,"onFontPickerMenuClose"),96);this.VNg.N1d("getPPTPinnedFontsSettings").continueWith(Object(D.a)(this,this.vnk,"onRoamingSettingLoaded"))}bMj(a){return a.Dn?!1:a.Wl?(Z.ULS.sendTraceTag(543273993,
3021,10,"Load setting failed with exception {0}",a.Ui),!1):!0}vnk(a){this.bMj(a)?this.E3=new Qz(a.result||this.Wbg()):this.E3=new Qz(this.Wbg());this.P7g()}P7g(){appChrome.api.dispatch(appChrome.actions.updatePinnedFonts("FontPicker",this.N9c))}get N9c(){return this.E3?this.E3.N9c:[]}Wbg(){return this.la.Ha("RecommendedFonts")}Fec(a,b,c,f,l){if(!this.E3)return Z.ULS.sendTraceTag(543475150,3021,50,"Roaming setting is not available yet"),64;(a=l.CommandValueId)&&(l.IsPinned?this.E3.p_h(a):this.E3.CNk(a));
return 32}AYg(){if(!this.E3||!this.E3.isDirty)return 32;const a=He.a.bFc(10,Object(D.a)(this,this.updatePinnedFonts,"updatePinnedFonts"));this.yb.Gb(a);return 32}updatePinnedFonts(){this.E3&&(this.P7g(),this.Thh(),this.E3.oTk())}Thh(){if(this.E3&&this.E3.isDirty){var a=this.E3.serialize();this.VNg.y6k(a)}}dispose(){this.Thh();this.ia.eO(G.a.Fec,de.a.frame,Object(D.a)(this,this.Fec,"pinOrUnpinFont"));this.ia.eO(G.a.x4f,de.a.frame,Object(D.a)(this,this.AYg,"onFontPickerMenuClose"))}}Object(e.a)(cM,
"FontPinningHandler",null,[222,106]);class Cq{static get ICb(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}Cq.pBa="fontInfoTaskPane";Cq.CNi="modernfontpicker";Object(e.a)(Cq,"FontInfoPaneConstants",null,[]);class dM{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(e.a)(dM,"FontInfoTaskPaneProps",null,[]);var au=d(634);class Rz{constructor(a,b,c,f=null){this.j2a=
this.BU=this.erc=null;this._state=this.wkb=0;this.dPh=a;this.J0=b;this.MHh=c;this.Hd=f}get Ym(){return this.dPh.value}initialize(){this.Ym.xa(G.a.GEe,de.a.frame,Object(D.a)(this,this.GEe,"requestFontInfo"));this.erc=this.J0.deb(Gr.a.ySa,Object(D.a)(this,this.Uqb,"featureStateChangeCallback"));this.Qfb()}Kl(a=!1){const b=yj.UISurfaces.Cs(),c=this.J0.isFeatureEnabled(Gr.a.ySa,!1),f=[];f.push(b);f.push(c);Promise.all(f).then(l=>{l[0].showTaskPane(Cq.pBa,this.hqa(l[1]));a&&this.Dr()})}KBh(a){yj.UISurfaces.Cs().then(b=>
{b.updateTaskPane(Cq.pBa,this.hqa(a));return null})}Uqb(a){this.KBh(a.isEnabled)}GEe(a,b,c,f,l){this.BU=l.CommandValueId;this.j2a=l.Trigger;this.wkb=l.InputMethod;this.Kl(2===this._state&&1===this.wkb);return 32}hqa(a){const b=new dM;b.onUpsellButtonClicked=Object(D.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");b.fontName=this.BU;b.isLicensed=a;b.trigger=this.j2a;b.helpArticleUrl=this.ysi();b.paneId=Cq.pBa;a=this.wwj();a.contentProps=b;return a}wwj(){return Object.assign(new au.a,{title:Cq.ICb,
hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(D.a)(this,this.onOpen,"onOpen"),onClose:Object(D.a)(this,this.onClose,"onClose"),onShow:Object(D.a)(this,this.onShow,"onShow"),onHide:Object(D.a)(this,this.onHide,"onHide")})}Qfb(){if(this.Hd){var a=this.Hd.Bc(Cq.pBa);a.parent=y.AFrame.gj;a.IK=!0}}onOpen(){this._state=2;this.Dr()}onShow(a){0!==this._state&&(this._state=2,1===a&&(this.wkb=a),this.Dr())}onClose(){this.wkb=this._state=
0;this.blur()}onHide(){this._state=1;this.wkb=0}Dr(){this.Hd&&1===this.wkb&&this.Hd.Bf(Cq.pBa)}blur(){this.Hd&&this.Hd.ye&&this.Hd.ye.name===Cq.pBa&&this.Hd.Bf(this.Hd.Q6)}onUpsellButtonClicked(){this.J0.launchUpsellExperience(Cq.CNi)}dispose(){this.J0.uEb(Gr.a.ySa,this.erc)}ysi(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.MHh,this.b4i(),"PPWAENDUSER",u.AFrameworkApplication.lcid)}b4i(){switch(this.j2a){case "missing":return"hlpFontInfoMissingFont";
case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Rz.kdi(this.BU)}static kdi(a){let b="hlpFontInfo";for(let c=0;c<a.length;++c){const f=Ma.a.charAt(a,c);if(255<a.charCodeAt(c)||Ma.a.Qqg(f))b+=f}return b}}Object(e.a)(Rz,"FontInfoPane",null,[223,106]);class eM extends Rz{constructor(a,b,c,f){super(a,b,c.Ha("FontInfoHelpBaseUrl"),f)}Uqb(a){this.KBh(a.isEnabled)}}Object(e.a)(eM,"PPTFontInfoPane",Rz,[]);
class jE{constructor(){this.v0c=this.h8b=this.i8b=this.K=null}get name(){return"PowerPointWebEditor.ModernFontPicker"}Wb(a){this.K=a;this.K.register(221,"Common.ModernFontPicker.IModernFontPickerFeatureHelper").ma().na(()=>new bM(this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(222,"Box4.IFontPinningStore").ma().na(()=>new cM(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IRoamingServiceRequestManager"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("Common.ITaskManager")));this.K.register(223,"Common.ModernFontPicker.IFontInfoPane").ma().na(()=>new eM(new le.a(()=>u.AFrameworkApplication.Ta),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.IFocusManager")))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.ff(()=>{this.K.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{a.ka("PPTOModernFontPickerIsEnabled")&&
(this.v0c=this.K.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper"),this.h8b=this.K.resolve("Common.ModernFontPicker.IFontInfoPane"),this.h8b.initialize(),b.isFeatureEnabled(Gr.a.ySa,!1).then(c=>{!u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&c&&(this.i8b=this.K.resolve("Box4.IFontPinningStore"),this.i8b.initialize())}),Gb.App.Fb.updateCommandUI())})})}dispose(){this.h8b&&(this.h8b.dispose(),this.h8b=null);this.i8b&&(this.i8b.dispose(),this.i8b=null);this.v0c&&(this.v0c.dispose(),
this.v0c=null)}static main(){m.a.instance.Ac(new jE)}}Object(e.a)(jE,"PPTModernFontPickerPackage",null,[2,3]);var kE=d(1038);class fM{constructor(a){this.f9=a;this.Cbb=this.f9.ZAb("UserAction","ImageProcessor");this.yZj=67}eAg(a,b){if(b)if(a&&this.ePj){let c=new Image;c.onload=()=>{b(c);URL.revokeObjectURL(c.src);c=null};(a=URL.createObjectURL(a))?c.src=a:b(null)}else b(null)}Nqh(a,b,c){c-=this.yZj;if(0>=c||!a)return null;let f=a.width,l=a.height;if(0>=f||0>=l)return null;let x=null,F=1,R=0;try{const fa=
Math.ceil(1.37*b);if(c<=fa){const wa=Math.sqrt(c/(1.3*fa));f=Math.floor(a.width*wa);l=Math.floor(a.height*wa)}if(x=this.zXf(a,f,l))if(R=x.length,x.length>=c){const wa=this.qdg(a.width,a.height);wa*Math.floor(a.width)*wa*Math.floor(a.height)>=f*l?x=null:(F++,(x=this.vdl(a))&&x.length>=c&&(x=null))}}catch(fa){x=null,Z.ULS.sendTraceTag(20841025,826,15,"ShrinkImageBySize failed. Error message: "+fa.message+", Call stack: "+fa.stack)}a=String.format("ShrinkImageBySize: BlobSize={0},numTry={1},Base64AfterFirstShrink={2},FinalBase64Length={3}",
b,F,R,x?x.length:0);Z.ULS.sendTraceTag(20841026,826,50,a);return x}vdl(a){let b=null;if(a){let c=a.width,f=a.height;const l=this.qdg(c,f);c=Math.floor(c*l);f=Math.floor(f*l);try{b=this.zXf(a,c,f)}catch(x){Z.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+x.message+", Call stack: "+x.stack)}}return b}zXf(a,b,c){if(0>=b||0>=c)return null;let f;this.Cbb.start();var l=document.createElement("canvas");l.width=b;l.height=c;var x=l.getContext("2d");f=this.Cbb.Dq;x.drawImage(a,
0,0,b,c);x=this.Cbb.Dq-f;l=l.toDataURL("image/png");a=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",a.width,a.height,b,c,f,x,this.Cbb.Dq-(f+x));Z.ULS.sendTraceTag(20841028,813,50,a);return l}qdg(a,b){return 0>=a||0>=b?0:1280<a||1280<b?Math.min(1280/a,1280/b):1}get ePj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}get URL(){return window.URL||window.webkitURL}}Object(e.a)(fM,"ImageProcessor",null,[291]);class lE{constructor(a,
b,c,f,l){this.Ca=a;this.YHh=b;this.XHh=c;this.MWe=f;this.PRh=l}get Ym(){return this.Ca}Hci(a){this.Ym.R$c(a,this.YHh,null,null)}Fci(a){this.Ym.R$c(a,this.XHh,null,null)}Jpa(a,b,c){c?this.Ym.R$c(a,this.MWe,b,null):this.Ym.Ka(this.MWe,2,b)}t3g(a,b=!1){const c=new E.DictionaryPropertySet;c.setValue(be.a.zT,a);c.setValue(be.a.A9c,!0);c.setValue(be.a.d8a,b);this.Ym.Ka(this.PRh,2,c)}}Object(e.a)(lE,"ClipboardCommands",null,[260]);class mE{AYb(){}}Object(e.a)(mE,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[1070]);class Dq{constructor(a,b,c,f,l,x){this.LC=a;this.Vg=b;this.zu=c;this.nm=f;this.Lo=l;this.Wc=x}nzj(a,b){a=b.view;b=b.MD;if(!b||H.a.instance.ga(14)&&!this.LC.Esg(b,!0)||this.nm&&this.nm.instance&&this.nm.instance.LV(b))return 2;var c=Dq.YT?!Dq.yt.Uia(b):!0;this.zu&&c&&this.zu.Qmc(b.node,w.a.aq,b.Qa);this.Vg.lQc(b,l=>new jv.a(l,jv.a.QFc),te.AParagraphNode.cZ);if(this.Wc.Zf&&this.Wc.jy){c=new We.GraphTransaction(15);try{c.fd(b.node)}finally{c&&c.dispose()}}var f=b.node;c=b.Kb+1;" "===Ya.ParagraphReader.text(f).charAt(c)&&
(f=Pc.a.createTextRange(f,c,c+1),this.Vg.replaceTextRange(f,"\u00a0"));b=Pc.a.Uj(b.node,c);a.Eb.setSelection(nd.SelectionFactory.eu(b));return 32}static get yt(){return Dq.JC||(Dq.JC=hb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get YT(){null==Dq.EH&&(Dq.EH=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Dq.EH}}Dq.JC=null;Dq.EH=null;Object(e.a)(Dq,"InsertLineBreakStrategy",null,[]);class Sn{static get Jh(){return Sn.xi||(Sn.xi=
hb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Pl(){return Rg.ContextSetEditor.instance}static get k5(){return Sn.Lo||(Sn.Lo=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Nf(){return Sn.Wc||(Sn.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static wzj(a,b,c,f,l){if(l&&l.Sa(be.a.targetObject)){var x=b.view.rg.Ch.re(l.getValue(be.a.targetObject));x=Pc.a.create(x)}else x=Sn.Pl.w1(b.MD,11);if(!x)return 8;a=
u.AFrameworkApplication.Ta.ii(x,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Hh)return 2;b=b.view;f=b.Eb.Dj;if(f=Sn.Pl.w1(f,11)){c=new En.a;c.set(f.node);c.Ze();if(l&&l.Sa(be.a.targetObject))for(l=l.Sh(be.a.targetObject);!c.currentNode.id.equals(l)&&c.uc()&&(Yb.OutlineElementNavigator.Je(c),11===c.mi););Yb.OutlineElementNavigator.Iua(c,!1,!1);l=fb.SelectionEditor.Oha(c,!0);l=Ya.ParagraphReader.Mr(l)?nd.SelectionFactory.Jg(l,0):nd.SelectionFactory.Xk(l);b.Eb.setSelection(l)}}return a}static l6d(a,b,c,
f,l){a=a===C.a.I2b;b=b.node;if(l&&l.Sa(be.a.targetObject)&&!b.id.equals(l.Sh(be.a.targetObject)))return 2;if(1===c)return 32;c=new mb.GraphIterator;c.set(b);c.mc(10);Sn.Jh.Tba(c,a,!0);Sn.Nf.Zf&&Sn.Nf.jy&&Yb.OutlineElementNavigator.oi(c);return 32}}Sn.xi=null;Sn.Lo=null;Sn.Wc=null;Object(e.a)(Sn,"InsertOutlineElementStrategy",null,[]);var FQ=d(402);class Sz{constructor(a,b,c,f,l,x,F,R){this.zu=b;this.RKh=a;this.$s=l;this.Jo=f;this.xi=c;this.LC=x;this.Pc=F;this.E1a=R}Cek(a,b,c,f,l){if(!b.view.Hh)return 2;
b=b.view;let x=null;b.So&&(x=b);const F=b.Eb.Dj;let R=!0,fa=!1,wa=null;if(!F)return 2;const Xa=new We.GraphTransaction(15);Xa.fd(b.rg);let lb=null;2===c&&(lb=new En.a,lb.set(F.node),lb.Ze(),wa=new lx(lb),2===Gb.App.mode&&fb.SelectionEditor.Kg(F)&&(lb.oC(11)&&Ib.ListReader.ak(lb)&&Rd.OutlineElementReader.isEmpty(lb,!1)&&(R=!1),R&&Gb.App.Eh.Qv&&Rd.OutlineElementReader.OB(lb,F,!1)&&!Rd.OutlineElementReader.OB(lb,F,!0)&&(R=!1)),Yb.OutlineElementNavigator.Je(lb),Rd.OutlineElementReader.isEmpty(lb,!1)&&
(FQ.a.LJj(lb)&&(R=!1),1===Gb.App.mode&&Ib.ListReader.ak(lb)&&(fa=!0)));a=u.AFrameworkApplication.Ta.ii(F,a,c,!1,f,l);R&&32===a&&2===c&&(fa||Yb.OutlineElementNavigator.mGa(lb,!1,!fb.SelectionEditor.Kg(F),!1),fa&&wa&&wa.restore(lb),H.a.instance.ga(101)&&this.$s.freeze(),b.Eb.setSelection(nd.SelectionFactory.nj(lb.currentNode,!0)),H.a.instance.ga(101)&&this.$s.BPe(),this.RKh.rn.Pv());x&&(R||x.$va());jf.GrippersManager.instance.vZa(1);Xa.dispose();return a}SA(a,b,c){a=!1;if(W.ImageReader.bDa(b)||W.ImageReader.gub(b))b=
this.Tti(b),a=!0;const f=b;b=fb.SelectionEditor.Kg(b);if(1===c)return 32;const l=f.node,x=new mb.GraphIterator;x.set(l);x.Ze();Yb.OutlineElementNavigator.Je(x);c=new We.GraphTransaction(15);c.Tx(x);b?(b=!0,H.a.instance.ga(101)&&Ya.ParagraphReader.Wd(l)&&f.Qa===Ya.ParagraphReader.textLength(l)&&fg.n(f)&&9===Ya.ParagraphReader.BMc(l)&&this.$s.Jui(f),1===Gb.App.mode&&Rd.OutlineElementReader.isEmpty(x,!1)&&Ib.ListReader.ak(x)&&(b=!1),this.Jo.elh(x,b,f,l),this.zu&&this.zu.Qmc(l,w.a.aq,f.Qa),a&&(Yb.OutlineElementNavigator.OI(x,
!1,!1),a=x.zb(2),(a=this.E1a.Jg(a,0))&&this.Pc.setSelection(a))):this.xi.Tba(x,!0,!0);c.dispose();Gb.App.Fb&&Gb.App.Fb.updateCommandUI();return 32}Tti(a){if(W.ImageReader.bDa(a))var b=Pc.a.Uj(a.node,a.Qa);else{b=Ya.ParagraphReader.jAa(a.node);var c=b.properties.Sh(Bb.a.xX);a=a.node.properties.getValue(Bb.a.runId);c=Sz.e0i(a,c,b.Ra);b=Pc.a.Uj(b,c)}return b}static DRi(a,b){let c=0;for(;c<b.length&&!(a<b[c]);)c++;return c}static e0i(a,b,c){let f=0;a=Sz.DRi(a,b);let l=0;if(a===b.length)l=c.length-1;else for(;l<
c.length;){b=c.ga(l);if(b.formatting&&b.formatting.ig===a)break;l++}l<c.length&&(f=c.ga(l).cp);return f}}Object(e.a)(Sz,"NewLineStrategy",null,[]);class bu{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.rs=null;this.yY=a;this.Wqc=x;this.muc=new Sz(this,b,c,f,l,F,wa,Xa);this.r5e=new Dq(F,R,b,fa,lb,Lb)}get rn(){return this.rs||(this.rs=this.yY())}ub(){const a=u.AFrameworkApplication.Ta,b=Object(D.a)(this.muc,this.muc.SA,"newLine");a.pa(C.a.enter,Fb.a.view,Object(D.a)(this.Wqc.value,this.Wqc.value.uMi,
"enterView"),1124);a.pa(C.a.ygd,Fb.a.view,Object(D.a)(this.Wqc.value,this.Wqc.value.i8k,"shiftEnterView"),1124);a.xa(C.a.SA,Fb.a.view,Object(D.a)(this.muc,this.muc.Cek,"newLineView"));a.xa(C.a.SA,Fb.a.Lf,b);a.xa(C.a.SA,Fb.a.image,b);a.xa(C.a.SA,Fb.a.textRange,b);a.xa(C.a.SA,Fb.a.anchoredObject,b);a.xa(C.a.SA,Fb.a.embeddedFile,b);a.xa(C.a.SA,Fb.a.ink,b);a.xa(C.a.SA,Fb.a.paragraph,b);a.xa(C.a.SA,Fb.a.iFrame,b);a.xa(C.a.SA,Fb.a.unsupportedObject,b);a.$d(C.a.SA,1124);a.pa(C.a.G2b,Fb.a.view,Object(D.a)(this.r5e,
this.r5e.nzj,"insertLineBreakView"),1028);a.xa(C.a.I2b,Fb.a.view,Sn.wzj);a.xa(C.a.I2b,Fb.a.outlineElement,Sn.l6d);a.$d(C.a.I2b,1092)}static get instance(){return bu.Ja||(bu.Ja=bu.GB())}static GB(){return new bu(()=>hb.a.instance.resolve("Box4.IUndoManager"),hb.a.instance.pb("Box4.IAutoCorrectScheduler"),hb.a.instance.resolve("Box4.IOutlineElementEditor"),hb.a.instance.resolve("Box4.List.IListEditor"),hb.a.instance.resolve("Box4.IInsertionPointFormatting"),hb.a.instance.Be("Box4.Actors.IEnterViewStrategy"),
Qg.a.instance,hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),hb.a.instance.La("Box4.IExternalSelectionManager"),ld.a.instance,hb.a.instance.resolve("Box4.ISelectionFactory"),hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}}bu.Ja=null;Object(e.a)(bu,"EnterActor",null,[]);class gM{Rth(a){return a}Wug(){return!0}}Object(e.a)(gM,"EopFormattingStrategy",null,[266]);var hM=d(149);class nE{constructor(a,
b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.MLa=this.BPb=this.Mib=null;this.eCd=0;this.Ztd=!1;this.Pa=new qd.a;this.HMb=null;this.QJ=a;this.$s=b;this.Gf=c;this.xw=f;this.Zq=l;this.Jo=x;this.Og=F;this.Vg=R;this.LC=fa;this.Xc=wa;this.Wc=Xa;this.Lo=lb;this.uMa=Lb}get xKi(){return H.a.instance.ga(105)?this.Xc?this.Xc.isFeatureEnabled(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"):!1}get sba(){return this.HMb||(this.HMb=hb.a.instance.resolve("Box4.IFormatPainterStrategy"))}get yK(){return this.Ztd}set yK(a){this.Ztd!==
a&&(this.Ztd=a,this.Pa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}x2h(a){this.Pa.addHandler("FormatPainterBrushActiveStatusChanged",a)}m4g(a){const b=a.Ua;Z.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",b.contextId);this.reset();var c=b.node;a=this.Fug(a);if(this.sba.Joh(b.contextId,a))try{this.MLa=this.Zq.hQa(c)}catch(f){throw Z.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",f.message),f;}this.BPb=Tc.StyleReader.kD(c);c=tb.a.Bs(b);c.sz&&(this.Mib=
Object(va.a)(nq.a,c.sz.clone()));this.eCd=a?Fb.a.paragraph:b.contextId;this.sba.BDf(b.node,this.MLa,this.Mib)}yFf(a){const b=H.a.instance.ga(14),c=this.Fug(a);for(let R=0;R<a.length;R++){var f=a.ga(R);if(f.Kk){var l=void 0;if(f.contextId===Fb.a.Lf||f.contextId===Fb.a.textRange)l=b&&this.LC.gsa(f);else if(f.contextId===Fb.a.paragraph)l=b&&this.LC.SSc(f);else if(f.contextId===Fb.a.endOfParagraph)l=b&&this.LC.QRc(f);else{Z.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",f.contextId);
continue}Z.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",f.contextId);if(l)Z.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{l=Object(va.a)(te.AParagraphNode,f.node);var x=!1;l&&(x=f.contextId===Fb.a.textRange&&!!l&&!f.Qa&&f.Kb===this.Zq.textLength(l));if(x=this.sba.$nh(this.eCd,f.contextId,c,x))try{Ya.ParagraphReader.Wd(l)?(this.BPb&&this.QJ.Y9(this.BPb,l,!0),this.xw.FFf(l,this.MLa)):Z.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",
f.node.type)}catch(fa){throw Z.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",fa.message),fa;}var F=f;f.contextId===Fb.a.paragraph?F=Pc.a.createTextRange(l,0,Ya.ParagraphReader.textLength(l)):f.contextId===Fb.a.Lf&&(F=this.$s.h0b(f),F=ld.a.YNa(F));if(F&&F.contextId===Fb.a.textRange)try{this.Z8h(F,this.Mib,x?null:this.BPb)}catch(fa){throw Z.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",fa.message),fa;}if(f.contextId===Fb.a.paragraph||f.contextId===
Fb.a.endOfParagraph){x=new mb.GraphIterator;x.set(l);x.Ze();x.Ng(11);F=Ib.ListReader.ak(x);const fa=!Ya.ParagraphReader.textLength(l);Z.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",F,fa);F?(this.Og.gla(x),f=x.currentNode,this.Og.cca(f)&&this.Jo.zfd(f,l,this.Mib)):this.xKi&&this.Y8h(f,this.Mib)}}}else Z.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",f.contextId)}}Y8h(a,b){b&&(a=this.Vg.iTd(a.node),a.Sd(a.xe),this.zFf(a,
b,null))}Z8h(a,b,c){if(b||c)0<fg.h(a).length&&Z.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.uMa.BAc(a,f=>{this.zFf(f,b,c)})}zFf(a,b,c){this.Gf.Wza(a);a.sz&&a.sz.removeProperty(bb.a.highlight);this.Gf.QCc(a);this.vx(a,c);this.vx(a,b)}vx(a,b){if(b){var c=a.paragraph.Ch;if(c){var f=a.sz;f=f?Object(va.a)(hM.a,f.clone()):nq.a.hAa(1179725);for(const x of b.Bz())if(x!==Bb.a.cG&&x!==Bb.a.fieldInstruction&&x!==bb.a.Fs&&x!==bb.a.yZ&&x!==Bb.a.W7a&&x!==bb.a.Gs&&x!==Bb.a.languageHint&&
x!==Bb.a.noProof){if(x===kh.a.D1){var l=b.sa(kh.a.D1,Ga.a.nil);if(l!==Ga.a.nil&&(l=Object(va.a)(nq.a,c.re(l)),l=Tc.StyleReader.tNc(l),l===Box4Intl.Box4Strings.L_StyleWordHyperlink)){l=Tc.StyleReader.tK(a.paragraph).Sdj(l);f.vx(l);continue}}f.setValue(x,b.Sh(x))}f.J8a?b=c.sHa(f):(c.SD(f),b=f);a.Sl=b.id}}}Fug(a){return!a.Paa&&a.Te.contextId!==Fb.a.endOfParagraph}reset(){this.MLa=this.BPb=this.Mib=null;this.eCd=Fb.a.none}}Object(e.a)(nE,"FormatPainter",null,[382]);class Tz{constructor(a){this.Ok=this.transaction=
null;this.Df=a;this.kpb=this.$p=0}}Object(e.a)(Tz,"SelectAllArguments",null,[]);class Sr{constructor(a,b,c,f,l){this.ERh=a;this.Wfa=b;this.jk=c;this.pud=f;this.$Nb=l}get bxe(){return this.ERh}get rn(){return this.Wfa.value}get IYk(){return this.pud?this.$Nb?Object(D.a)(this,this.yNi,"expandSelectionOneNote"):Object(D.a)(this,this.zNi,"expandSelectionWord"):Object(D.a)(this,this.Fih,"selectAllInOutline")}get Gih(){return this.$Nb?Object(D.a)(this,this.xed,"selectAllOutlines"):null}ub(){const a=u.AFrameworkApplication.Ta;
this.Gih&&a.pa(C.a.xed,Fb.a.view,this.Gih,2);a.xa(C.a.b$,de.a.frame,Sr.Eph);a.xa(C.a.zgd,de.a.frame,Sr.Eph);a.pa(C.a.Eqa,Fb.a.view,this.IYk,2);a.pa(C.a.R7h,Fb.a.view,y.AFrame.ze,100);a.pa(C.a.tse,Fb.a.view,Sr.tse,4)}yNi(a,b,c){return this.Eqa(b,c,null)}Eqa(a,b,c){if(1===b)return 32;if(!a.view.Hh)return 2;b=a.view;if(!b.Eb)return 8;const f=b.Eb.Oa;if(!f||!f.length)return 8;N.a.mark(5798);Gb.App.Fb.Ed.isEditingAllowed||Gb.App.Fb.Ed.vy?a=fb.SelectionEditor.h_d(f):(v.FocusManager.instance().qC(y.AFrame.mV),
a=nd.SelectionFactory.GGe(b.rg));if(!a)return 8;this.pud&&!f.iqa&&Z.ULS.sendTraceTag(39098305,324,50,"Progress selection start");c&&this.bxe.x8a(fb.SelectionEditor.o8f(a))?c=c(b):(c=new Tz(b),c.Ok=a,c=new wc.a(null,Object(D.a)(this,this.JDb,"processSetSelection"),c),c.xl("ExpandSelection"),c.run());return c.inProgress?1:32}zNi(a,b,c,f,l){return b.view.So?this.Eqa(b,c,Object(D.a)(this,this.Dsh,"startOperationOfSelectAllInOutline")):this.Fih(a,b,c,f,l)}JDb(a,b){return 0===b.$p?(b.transaction=this.jk.je(2),
b.transaction.fd(b.Df.rg),b.$p=1,!0):1===b.$p?(b.Df.Eb.kGb(b.Ok,a),b.$p=2,!0):2===b.$p?(b.Df.Eb.Oa.iqa=b.Ok.iqa,this.rn.Pv(),b.transaction.QT(a),b.$p=3,b.transaction.dispose(),N.a.mark(5799),!0):!1}Fih(a,b,c){if(1===c)return 32;if(!b.view.Hh)return 2;a=b.view;return a.Eb&&a.Eb.Oa&&a.Eb.Oa.kb?this.Dsh(a).inProgress?1:32:8}Dsh(a){u.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.pud&&a.So&&Z.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");
a=new wc.a(null,Object(D.a)(this,this.nBk,"processSelectAllInOutline"),new Tz(a));a.xl("SelectAllInOutline");a.run();return a}nBk(a,b){if(0===b.$p)return b.Ok=nd.SelectionFactory.JYk(b.Df.Eb.Oa.kb),b.transaction=this.jk.je(2),b.transaction.fd(b.Df.rg),b.$p=1,!0;if(1===b.$p){if(!b.kpb)return H.a.instance.ga(77)&&H.a.instance.ga(104)&&b.Ok.nl?(b.Df.Eb.kGb(b.Ok,a),b.kpb=b.Ok.length):(b.Df.Eb.setSelection(b.Ok.ga(0),a),++b.kpb),!0;if(b.kpb<b.Ok.length)return b.Df.Eb.GBf(b.Ok.ga(b.kpb),a),++b.kpb,!0;b.$p=
2}return 2===b.$p?(b.Df.Eb.Oa.iqa=b.Ok.iqa,this.rn.Pv(),b.transaction.QT(a),b.$p=3,b.transaction.dispose(),!0):!1}xed(a,b,c){if(1===c)return 32;if(!b.view.Hh)return 2;b=b.view;a=nd.SelectionFactory.GGe(b.rg);if(!a)return 8;b=new Tz(b);b.Ok=a;a=new wc.a(null,Object(D.a)(this,this.JDb,"processSetSelection"),b);a.xl("ExpandSelection");a.run();return a.inProgress?1:32}static get dfb(){return Sr.D1a||(Sr.D1a=hb.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static tse(a,b,c){if(1===c)return 32;
if(!b.view.Hh)return 8;a=b.view;b=nd.SelectionFactory.nj(a.root.graphNode,!0);if(!b)return 8;a.Eb.setSelection(b);return 32}static Eph(){if(!H.a.instance.ga(75))return 2;var a=Gb.App.Fb.Ed.VJ;if(!a.Hh)return 2;if(a.Hh&&1!==Gb.App.Fb.state){N.a.mark(4668);var b=a.Eb.Oa.kb;if(!b&&u.AFrameworkApplication.fa.ka("ContextMenuOnSelectionFixIsEnabled"))return 2;b=fb.SelectionEditor.Zga(b);let c=b.x,f=b.y+b.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(b.y<a.y||b.y>a.y+a.height||
b.x<a.x||b.x>a.x+a.width)c=a.x,f=a.y;Sr.dfb.b$(new Sys.UI.Point(c,f),1);N.a.mark(4669)}return 32}}Sr.D1a=null;Object(e.a)(Sr,"SelectAllHandlers",null,[267]);class iM extends rj.StandardDialog{constructor(a,b,c=null){super();this.vd=1;b?(b=CommonUIStrings.l_GoToClassicRibbonDialogMesage,this.zFd(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,c)):b=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage;this.aBb(CommonUIStrings.l_ToggleRibbonUXDialogTitle,b,null,null,a,null)}}Object(e.a)(iM,"ToggleRibbonUXDialog",
rj.StandardDialog,[]);const IQ=()=>{const a=u.AFrameworkApplication.Ta;a.pa(G.a.eDk,de.a.frame,GQ,101);a.xa(G.a.Gml,de.a.frame,HQ)},HQ=(a,b,c)=>{if(1===c)return 32;if(b.contextId!==de.a.frame)return 2;Z.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",u.AFrameworkApplication.Aa.gb.Mp?"Single Line Ribbon":"Classic Ribbon");new iM(f=>{1===f&&u.AFrameworkApplication.Ta.processAction(G.a.Fwh,2)},u.AFrameworkApplication.Aa.gb.Mp);return 32},GQ=(a,b,c,f,l)=>{l[ai.a.On]=
u.AFrameworkApplication.Aa.gb.Mp;return 32};class oE{constructor(a){this.Gf=a}kIe(a,b){this.Gf.AX(a,b.cache.TM);this.Gf.yr(a,b.cache.fontSize)}XHe(){}AZd(){return null}xV(){return null}sQa(){return null}m7(){return null}bph(){return!1}}Object(e.a)(oE,"FormattingStewardBridge",null,[256]);var jM=d(714),JQ=d(665);class kM{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb){if(a)if(b)if(c)if(f)if(l)if(x)if(F){if(!R)throw Error.argumentNull("errorHandler");if(!fa)throw Error.argumentNull("sessionInfo");}else throw Error.argumentNull("graphActionBlockingManager");
else throw Error.argumentNull("graphTopologyManager");else throw Error.argumentNull("graphOperationEventSource");else throw Error.argumentNull("pptWorkspace");else throw Error.argumentNull("transactionFactory");else throw Error.argumentNull("pptSelectionManager");else throw Error.argumentNull("actionManager");this.ia=a;this.nb=b;this.Db=c;this.KW=f;this.Ur=l;this.ta=x;this.Xb=F;this.Kd=R;this.Ce=fa;this.cCg=wa;this.TQg=Xa;this.lab=lb}ub(){this.ia.pa(ba.a.e_h,fc.a.application,Object(D.a)(this,this.djj,
"handleAddEditOrSetAsSlideTitle"),4);this.ia.pa(ba.a.editSlideTitle,fc.a.application,Object(D.a)(this,this.Vgg,"handleEditSlideTitle"),4);this.ia.pa(ba.a.addSlideTitle,fc.a.application,Object(D.a)(this,this.Cgg,"handleAddSlideTitle"),4);this.ia.pa(ba.a.G_h,fc.a.application,Object(D.a)(this,this.fjj,"handleAddHiddenSlideTitle"),4);this.ia.pa(ba.a.setAsSlideTitle,fc.a.application,Object(D.a)(this,this.Zhg,"handleSetAsSlideTitle"),4);this.ia.pa(ba.a.rxk,fc.a.application,Object(D.a)(this,this.Blj,"handleHyperlinkText"),
4);this.ia.xa(ba.a.yYh,fc.a.application,Object(D.a)(this,this.bjj,"handleAccessibleAuthoringHelp"));this.ia.pa(ba.a.Zyj,Fb.a.application,Object(D.a)(this,this.oig,"handleUploadCaptionsDialog"),4);this.ia.pa(ba.a.$yj,Fb.a.application,Object(D.a)(this,this.oig,"handleUploadCaptionsDialog"),4);this.ia.pa(ba.a.ZMk,fc.a.application,Object(D.a)(this,this.ioj,"handleRemoveAllCaptions"),4)}we(){}dCa(){const a=this.nb.Ip();return a?a.dCa():null}onShapeSelected(a,b){this.Ur.xdh(Object(D.a)(this,this.onShapeSelected,
"onShapeSelected"));b.shapeNode.T2?32!==this.ia.processAction(ba.a.MTb,2)&&ya.a.J(509724675,822,10,"Not able to begin edit shape text on title placeholder"):ya.a.J(509724674,822,10,"After selecting title placeholder, the selected shape is not the title placeholder")}Iih(){const a=this.dCa();return a?(this.Ur.dDf(Object(D.a)(this,this.onShapeSelected,"onShapeSelected")),this.nb.selectShape(a,!0),!0):!1}Asg(){const a=this.nb.mf();return!!a&&1===a.length&&!!this.dCa()}Jqg(){for(const a of this.nb.mf())if(a&&
!a.dCa())return!0;return!1}Fwg(){var a=this.nb.ae();if(1!==a.length)return!1;a=a[0];return!a.T2&&!a.Mf&&!a.mh&&!a.Qf&&a.hasText&&0<a.textLength()}djj(a,b,c,f,l){if(1===c)return 32;var x=this.dCa();const F=this.nb.ae(),R=1===F.length?F[0]:null;0<F.length&&R!==x?this.Fwg()?(x=3,a=this.Zhg(a,b,c,f,l)):(x=4,a=32):this.Asg()?(x=1,a=this.Vgg(a,b,c,f,l)):this.Jqg()?(x=2,a=this.Cgg(a,b,c,f,l)):(ya.a.J(509724673,822,10,"SlideTitle performed no action since none were enabled"),x=5,a=8);If.a("AddEditOrSetAsSlideTitle",
32===a,void 0,[Object.assign(new ac.a,{name:"SubAction",int64:x})]);return a}Vgg(a,b,c){return 1===c?this.Asg()?32:2:this.Iih()?32:8}Dgg(a,b,c){if(1===b)return this.Jqg()?32:2;b=new Date;const f=this.Db.rd(15,void 0,void 0,()=>{const l=this.nb.mf();if(l&&1===l.length){const x=new Date;let F=0;F=window.setInterval(()=>{this.Iih()?window.clearInterval(F):2E3<+new Date-+x&&(ya.a.J(509724672,822,50,"AddSlideTitle or AddHiddenSlideTitle couldn't find title placeholder {0}ms after executing",2E3),window.clearInterval(F))},
100)}});try{ya.a.J(509724643,822,50,"HandleAddSlideTitle called with isOffSlideTitle {0}",c);f.jc(this.KW.yf);f.$c=a;for(const l of this.nb.mf())l&&!l.dCa()&&(l.hDa=c)}finally{f&&f.dispose()}a=new Date;ya.a.J(509724642,822,50,"HandleAddSlideTitle completed with isOffSlideTitle {0}",c);if(c=Mc.a.Cb)c.Km("AddSlideTitleStart",b),c.Km("AddSlideTitleEnd",a),c.Ij=!1,c.Ar=!0,Mc.a.dea(c);return 32}Cgg(a,b,c){return this.Dgg(a,c,!1)}fjj(a,b,c){return this.Dgg(a,c,!0)}Zhg(a,b,c){if(1===c)return this.Fwg()?
32:2;c=this.nb.Ip();const f=this.nb.ae();if(1!==f.length)return ya.a.J(509724641,822,10,"SetAsSlideTitle should only be enabled with 1 shape selected"),8;b=new Date;const l=this.Db.rd(15);try{ya.a.J(509724640,822,50,"HandleSetAsSlideTitle called for SlideId.Cid {0} with shapeId {1}",c.Bb.cid,f[0].get_shapeId()),l.jc(c),l.$c=a,c.pIa=f[0].get_shapeId()}finally{l&&l.dispose()}a=new Date;ya.a.J(509724639,822,50,"HandleSetAsSlideTitle completed for SlideId.Cid {0} with shapeId {1}",c.Bb.cid,f[0].get_shapeId());
if(c=Mc.a.Cb)c.Km("SetAsSlideTitleStart",b),c.Km("SetAsSlideTitleEnd",a),c.Ij=!1,c.Ar=!0,Mc.a.dea(c);32!==this.ia.processAction(ba.a.MTb,2)&&ya.a.J(509724638,822,10,"Not able to begin edit shape text after Set as Slide Title");return 32}Blj(a,b,c){return this.nb.D7()?this.ia.processAction(C.a.g2b,c):this.ia.processAction(ba.a.hAc,c)}bjj(a,b,c){if(1===c)return 32;a={};this.cCg&&(a.query="AssetID="+this.cCg);b={};b.fU=ResourceStrings.L_Help;b.assetId="FA000000012";b.nonPersistedSettings=a;return this.ia.Ka(ba.a.sIa,
2,b)}DHj(){if(!this.TQg)return!1;const a=this.nb.ae();return 1!==a.length?!1:a[0].YP}oig(a,b,c){b=this.ta.Ba;if(!b||this.Xb.Zc(b))return 8;if(1===c)return this.DHj()?32:2;c=Mc.a.hm("Captions::Insert");try{return JQ.a.fMe(".vtt",jM.b,()=>jM.a(a,Object(D.a)(this,this.azj,"insertCaptionsSuccessAfterUpload"),"captions",this.Ce),"captions",this.ta.presentation,this.Xb,this.Kd,c,!1,this.lab,50,10,3),c&&c.Wa("CaptionsDialogInitialized","true"),32}catch(f){ya.a.J(509724637,818,10,"Error while rendering new captions selection dialog.")}c&&
(c.Wa("CaptionsDialogInitialized","false"),c.finish(),c=null);return 8}azj(a,b,c,f,l,x){f.QP(c)&&ya.a.J(509724636,822,15,"Captions::InsertCaptionsSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+c.Wpa);f.vO(c);l&&l.Wa("CaptionsUploadToRC","true");if((c=this.ta.Ba)&&c.isConnected){var F=x.files[0].name;f=x="";var R=F.split(".");2<=R.length&&(f=R[R.length-2]);sa.a.le(f)||(x=F.lastIndexOf("."),x=0<=x?F.substring(0,x):F,f="");F=this.nb.ae();if(1===F.length){F=F[0];
R=this.Db.rd(15);try{R.jc(c),R.$c=a,l&&l.Wa("InsertCaptionsInProgress","true"),F.Bob=b,F.zob=x,F.Aob=f}finally{R&&R.dispose()}l&&(l.Wa("InsertCaptionsSuccessful","true"),l.finish())}}}LLj(){if(!this.TQg)return!1;const a=this.nb.ae();return 1!==a.length?!1:a[0].YP}ioj(a,b,c){if(1===c)return this.LLj()?32:2;b=this.nb.ae();if(1!==b.length)return 16;c=b[0];b=new Date;const f=this.Db.rd(15);try{ya.a.J(509724635,822,50,"RemoveAllCaptions started"),f.jc(this.KW.yf),f.$c=a,c.fvb=!0}finally{f&&f.dispose()}a=
new Date;ya.a.J(509724634,822,50,"RemoveAllCaptions completed");if(c=Mc.a.Cb)c.Km("RemoveAllCaptionsStart",b),c.Km("RemoveAllCaptionsEnd",a),c.Ij=!1,c.Ar=!0,Mc.a.dea(c);return 32}}Object(e.a)(kM,"AccessibleAuthoringActor",null,[244]);var KQ=d(141),LQ=d(167),MQ=d(178);class lM{constructor(a,b,c,f){this.AZc=!1;this.i8="";this.byb=!1;this.SUa=null;this.hXc=-1;this.hyb=!1;this.pja=[];this.$b=b;this.la=c;this.a4c=f;a&&this.$b.ff(()=>{a.XJ(Object(D.a)(this,this.Rnk,"onSelectionChangeFinished"))})}ub(){}we(){}d0b(a,
b,c){const f=[];for(const l of a)f.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:b,["controlId"]:l},c));return f}NMc(a){const b=[];for(let c=0;4>c;c++){const f={["type"]:"DropPreviewItemFromGallery",["controlId"]:a};let l=null;2>c&&(l=0);b.push(appChrome.actions.addScalingStepInTab("Home",f,l))}b.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:"GalleryToFlyout",["controlId"]:a},null));return b}Ocg(a){const b=[];let c=!1;if(a){switch(this.i8){case "FormatPicture":Array.addRange(b,
this.NMc("PictureStyles"));c=!0;break;case "Table":this.hyb||Array.addRange(b,this.NMc("TableStyles"));c=!0;break;case "SmartArtDesign":Array.addRange(b,this.NMc("ChangeSmartArtLayoutAnchor"));c=!0;break;case "Graphics":Array.addRange(b,this.NMc("GraphicsStylePreviewGallery"));c=!0;break;case "Audio":c=!0;break;case "FormatShape":Array.addRange(b,this.d0b(["InsertShapeTextBoxBig","AlternativeText"],"DropLabel",0)),Array.addRange(b,this.d0b(["InsertShapeTextBoxBig","AlternativeText"],"MoveToOverflow",
0)),Array.addRange(b,this.d0b(["SetWidth","SetHeight"],"MoveToOverflow",null))}c&&(a=null,this.hyb&&(a=0),Array.addRange(b,this.d0b(this.SUa,"DropLabel",a)),a=this.SUa.slice(0,this.SUa.length).reverse(),Array.addRange(b,this.d0b(a,"MoveToOverflow",null)))}else for(const f of this.SUa)b.push(appChrome.actions.removeControlScalingStepsFromTab(f,"Home"));return b}UXd(a){const b={};for(const c of a)try{b[c]=appChrome.selectors.getModelType(c)}catch(f){return this.KDa("Error","GetModelType failed for "+
c),null}return b}gYd(a){switch(a){case "FormatPicture":case "SmartArtDesign":case "Audio":case "Graphics":return["Font","Paragraph","Drawing"]}return[]}iJb(a){this.a4c&&(a=this.UXd(a))&&this.a4c(a)}Ksl(a){if(a.length){if(this.a4c){var b=this.UXd(a);if(!b)return;var c=this.gYd(this.i8);if(0<c.length&&!this.byb){for(var f of c)this.pja.push(appChrome.actions.updateGroupHiddenState(f,!0));this.byb=!0}else if(this.byb&&!c.length){c=[];f=this.gYd("FormatPicture");for(var l of f)this.pja.push(appChrome.actions.updateGroupHiddenState(l,
!1)),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup(l));if(l=this.UXd(c))for(let x in l)b[x]=l[x];this.byb=!1}this.a4c(b)}this.SUa=a;b=[];for(const x of a)appChrome.selectors.isControlDisabled(x)&&b.push(x);0<b.length&&this.KDa("Disabled",b.join(","));0<this.SUa.length&&(this.pja.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),this.pja.push(appChrome.actions.updateControlsInGroup("Adaptive",this.SUa)),Array.addRange(this.pja,this.Ocg(!0)),this.AZc=!0)}}qfh(a){""!==this.i8&&
this.i8!==a&&Array.addRange(this.pja,this.Ocg(!1))}kSe(a,b){if(a||this.AZc)if(this.pja.push(appChrome.actions.updateGroupHiddenState("Adaptive",!a)),this.AZc=a,b=this.gYd(b),a&&0<b.length||this.byb){for(var c of b)this.pja.push(appChrome.actions.updateGroupHiddenState(c,a));a||(c=appChrome.selectors.getVisibleControlsInGroup("Font"),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup("Paragraph")),this.iJb(c));this.byb=a}}bXf(){0<this.pja.length&&(appChrome.api.dispatch(this.pja),this.pja=
[])}mli(a,b){if(0>Array.indexOf(a,b)||"SmartArtDesign"===b&&(this.iJb(["SmartArtEditText"]),appChrome.selectors.getButtonToggleState("SmartArtEditText")))return!1;a=!1;if("Table"===b&&Dj.a.instance.kb){const c=!Dj.a.instance.kb.nl&&!Dj.a.instance.kb.STc;if(a=(""===this.i8||this.i8===b)&&c!==this.hyb)this.hyb=c}a?this.qfh("TableCellEdit"):this.qfh(b);this.i8=b;return!0}QYk(){const a="Table FormatPicture SmartArtDesign Audio Graphics FormatShape".split(" ");let b=!1;const c=appChrome.selectors.getActiveContextualTabIds();
for(const f of a)if(this.mli(c,f)){b=!0;break}return b?this.i8:""}WXi(){switch(this.i8){case "FormatPicture":return"ChangePictureFlyout ChangePicture ResetPicture PictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");case "Table":return this.hyb?["Select","TableDelete","TableInsert","TableAlignmentAnchor"]:"Select TableDelete TableInsert MergeTableCells SplitTableCells SetSizeAnchor TableDistribute TableAlignmentAnchor TableCellMarginAnchor ApplyTableStyleOptionAnchor TableStyles PowerPointCellShadingMenuOpen TableAlternativeText TableBordersMenuOpen TableBorderWidthAnchor SetCellBorderColor".split(" ");
case "SmartArtDesign":return"SmartArtEditText SmartArtPromote SmartArtDemote SmartArtReverse ChangeSmartArtLayoutAnchor ChangeSmartArtColorAnchor SmartArtStyles SmartArtResetGraphic AlternativeText SetWidth SetHeight".split(" ");case "FormatShape":return["SetWidth","SetHeight","InsertShapeTextBoxBig","AlternativeText"];case "Audio":return"AudioPlay AudioPause SetVolume StartAudio SetAudioOptions PlayInBackground NoAudioStyle ChangePictureFlyout ChangePicture ResetPicture AudioPictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");
case "Graphics":return"GraphicsStylePreviewGallery ChangeGraphicFlyout GraphicsFill GraphicsOutline AlternativeText ArrangeAnchor SetWidth SetHeight".split(" ")}return[]}Rnk(a,b){if(!this.la.Mma&&"Home"===appChrome.selectors.getSelectedTabId()&&b.Ok&&b.Ok.kb&&b.Ok.length){var c=()=>{const f=this.i8;""===this.QYk()?this.kSe(!1,f):this.hyb||""===f||f!==this.i8?this.Ksl(this.WXi()):this.AZc||(this.iJb(this.SUa),this.kSe(!0,this.i8));this.bXf()};-1!==this.hXc&&window.clearTimeout(this.hXc);this.hXc=window.setTimeout(()=>
{this.hXc=-1;let f=!1;try{window.self.requestIdleCallback(c)}catch(l){f=!0}f&&window.self.requestAnimationFrame(c)},250)}else this.kSe(!1,this.i8),this.bXf()}KDa(a,b){a={["Time"]:window.performance.now(),["Event"]:a,["Message"]:b,["Scenario"]:"AdaptiveTabGroup"};KQ.a.sendActivityEvent(Object.assign(new MQ.a,{name:"Office.TellMe.TellMeWAC.Events",dataFields:LQ.a.dD(a),durationMs:window.performance.now()}))}}Object(e.a)(lM,"AdaptiveTabGroupUpdaterActor",null,[244]);class mM extends zt{constructor(a,
b){super(a);this.VWh=b;this.Bu=a}getAltText(a){return(a=this.nS(a))?a.get_altTitle():""}D8f(a){return(a=this.nS(a))?a.get_alt():""}kHd(a,b){if(1===a)if(this.hide(),a=this.nS(this.Bu)){const c=this.VWh.je(15);c.jc(a);a.qYa=!1;a.set_altTitle(b[mq.mHd]);a.set_alt(b[mq.jHd]);c.dispose()}else ya.a.J(17876899,822,10,"Try to set alternative text on a null shape.")}nS(a){let b;return(a=(a=ae.b(a))?a.Eb:null)&&(b=a.ae())&&1===b.length?b[0]:null}}Object(e.a)(mM,"ShapeAltTextDialog",zt,[]);class nM{constructor(a,
b,c,f,l,x){this.Db=l;this.ia=a;this.la=b;this.nb=f;this.S9a=c;this.Xb=x}ub(){this.la.Rqg&&this.ia.pa(ba.a.hAc,Fb.a.view,Object(D.a)(this,this.P7h,"altTextDispatcher"),4)}we(){}BXi(a){new mM(a,this.Db)}P7h(a,b,c){if(a!==ba.a.hAc)return 16;a=this.nb.ae();if(!a||1!==a.length||this.Xb.Zc(a[0]))return ya.a.J(17876881,822,50,"No or multiple shapes selected or the selected shape is blocked. Disable the alternative text button."),16;if(1===c)return 32;ya.a.J(17876883,822,50,"Begin setting the alternative text for shape.");
a[0].qk&&!a[0].get_isSVGBlipFilled()&&this.la.GRa?this.S9a.oGk():this.BXi(b);return 32}}Object(e.a)(nM,"AltTextActor",null,[244]);class oM{constructor(a,b,c,f,l,x,F,R){this.uD=null;this.ia=a;this.nb=b;this.Fa=c;this.Db=f;this.D9a=l;this.nta=x;this.hc=R;this.D9a&&this.D9a.execute(fa=>{this.uD=fa})}ub(){this.ia.pa(ba.a.NId,fc.a.application,Object(D.a)(this,this.Hjj,"handleAudioPlay"),96);this.ia.pa(ba.a.SAc,fc.a.application,Object(D.a)(this,this.Gjj,"handleAudioPause"),96);this.ia.pa(ba.a.TGf,fc.a.application,
Object(D.a)(this,this.nai,"audioPlayPauseCommandHandler"),96);this.ia.pa(ba.a.w0k,fc.a.application,Object(D.a)(this,this.q1b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.ead,fc.a.application,Object(D.a)(this,this.ead,"queryAudioOptions"),96);this.ia.pa(ba.a.playAcrossSlides,fc.a.application,Object(D.a)(this,this.q1b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.Cad,fc.a.application,Object(D.a)(this,this.Cad,"queryPlayAcrossSlides"),96);this.ia.pa(ba.a.loopUntilStopped,fc.a.application,Object(D.a)(this,
this.q1b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.rad,fc.a.application,Object(D.a)(this,this.rad,"queryLoopUntilStopped"),96);this.ia.pa(ba.a.hideDuringShow,fc.a.application,Object(D.a)(this,this.q1b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.mad,fc.a.application,Object(D.a)(this,this.mad,"queryHideDuringShow"),96);this.ia.pa(ba.a.rewindAfterPlaying,fc.a.application,Object(D.a)(this,this.q1b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.Had,fc.a.application,Object(D.a)(this,this.Had,"queryRewindAfterPlaying"),
96);this.ia.xa(ba.a.playInBackground,fc.a.application,Object(D.a)(this,this.$hg,"handleSetAudioStyles"));this.ia.xa(ba.a.noAudioStyle,fc.a.application,Object(D.a)(this,this.$hg,"handleSetAudioStyles"));this.ia.pa(ba.a.Dad,fc.a.application,Object(D.a)(this,this.Dad,"queryPlayInBackground"),96);this.ia.pa(ba.a.uad,fc.a.application,Object(D.a)(this,this.uad,"queryNoAudioStyle"),96);this.ia.pa(ba.a.setVolume,fc.a.application,Object(D.a)(this,this.r1b,"handleSetVolume"),96);this.ia.pa(ba.a.zJe,fc.a.application,
Object(D.a)(this,this.r1b,"handleSetVolume"),96);this.ia.pa(ba.a.Lad,fc.a.application,Object(D.a)(this,this.Lad,"querySetVolumeLow"),96);this.ia.pa(ba.a.AJe,fc.a.application,Object(D.a)(this,this.r1b,"handleSetVolume"),96);this.ia.pa(ba.a.Mad,fc.a.application,Object(D.a)(this,this.Mad,"querySetVolumeMedium"),96);this.ia.pa(ba.a.yJe,fc.a.application,Object(D.a)(this,this.r1b,"handleSetVolume"),96);this.ia.pa(ba.a.Kad,fc.a.application,Object(D.a)(this,this.Kad,"querySetVolumeHigh"),96);this.ia.pa(ba.a.BJe,
fc.a.application,Object(D.a)(this,this.r1b,"handleSetVolume"),96);this.ia.pa(ba.a.Nad,fc.a.application,Object(D.a)(this,this.Nad,"querySetVolumeMute"),96);this.ia.pa(ba.a.ngl,fc.a.application,Object(D.a)(this,this.kpj,"handleStartAudio"),96);this.ia.pa(ba.a.fbd,fc.a.application,Object(D.a)(this,this.fbd,"queryStartAudio"),96)}we(){}Hjj(a,b,c,f,l){b=this.nb.ae();if(1<b.length||!this.uD)return 16;const x=this.uD.nK(b[0]);if(!x||!x.isPlayerReady())return 16;if(1===c)return 32;let F=!1;l&&(F=!!l.ActionFromPlayer);
return sg.b("AudioPlaybackOptionsActor::HandleAudioPlay ActionFromPlayer",F.toString(),a,()=>{x&&!F&&x.startPlaying();const R=[appChrome.actions.updateControlHiddenState("AudioPlay",!0),appChrome.actions.updateControlEnabledDisabledState("AudioPause",!1),appChrome.actions.updateControlHiddenState("AudioPause",!1)];appChrome.api.dispatch(R);return 32})}Gjj(a,b,c,f,l){const x=this.nb.ae();if(1<x.length||!this.uD)return 16;if(1===c)return 32;let F=!1;l&&(F=!!l.ActionFromPlayer);return sg.b("AudioPlaybackOptionsActor::HandleAudioPause ActionFromPlayer",
F.toString(),a,()=>{var R=this.uD.nK(x[0]);R&&!F&&R.pause();R=[appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPause",!0)];appChrome.api.dispatch(R);return 32})}nai(){var a=this.nb.jNc();if(!a||!this.uD)return 2;(a=this.uD.nK(a))&&!a.isPlayerFocused()&&(a.isAudioPlaying()?this.ia.processAction(ba.a.SAc,2):this.ia.processAction(ba.a.NId,2));return 32}q1b(a,b,c,f,l){if(1===
c)return 32;if(!l)return ya.a.J(512500762,822,10,"AudioPlaybackOptionsActor::HandleSetAudioOptions actionData is null"),8;const x=l.On;return sg.b("AudioPlaybackOptionsActor::HandleSetAudioOptions audioOption: ",l.SqmControlId,a,()=>{const F=this.nb.mg();if(F&&0<F.length){const R=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{R.jc(F[0]);for(const fa of F){if(!fa||!fa.media)continue;const wa=fa.media;switch(a){case ba.a.playAcrossSlides:wa.plyAcrssSldsField=x;break;case ba.a.loopUntilStopped:wa.repeatField=
x;break;case ba.a.hideDuringShow:wa.hideDrngShwField=x;break;case ba.a.rewindAfterPlaying:wa.rewindField=x}fa.media=wa;if(this.nta&&this.uD&&(a===ba.a.loopUntilStopped||a===ba.a.rewindAfterPlaying)){const Xa=this.uD.nK(fa);Xa&&(a===ba.a.loopUntilStopped?Xa.setRepeat(wa.repeatField):a===ba.a.rewindAfterPlaying&&Xa.setRewind(wa.rewindField))}}}finally{R&&R.dispose()}}return 32})}$hg(a,b,c,f,l){return 1===c?32:l?sg.b("AudioPlaybackOptionsActor::HandleSetAudioStyles",l.SourceControlId,a,()=>{const x=
this.nb.mg();if(x&&0<x.length){const F=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{F.jc(x[0]);for(const R of x){if(!R||!R.media||R.mh)continue;const fa=R.media;switch(a){case ba.a.playInBackground:fa.plyAcrssSldsField=!0;fa.repeatField=!0;fa.hideDrngShwField=!0;fa.strtField=0;break;case ba.a.noAudioStyle:fa.plyAcrssSldsField=!1,fa.repeatField=!1,fa.hideDrngShwField=!1,fa.strtField=2}R.media=fa}}finally{F&&F.dispose()}}return 32}):(ya.a.J(512500761,822,10,"AudioPlaybackOptionsActor::HandleSetAudioStyles actionData is null"),
8)}kpj(a,b,c,f,l){if(1===c)return 32;if(!l)return ya.a.J(512500760,822,10,"AudioPlaybackOptionsActor::HandleStartAudio actionData is null"),8;const x=l.CommandValueId;return sg.b("AudioPlaybackOptionsActor::HandleStartAudio Start Option: ",x,a,()=>{if(!x||""===x.trim())return 32;const F=this.nb.mg();if(F&&0<F.length){const R=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{R.jc(F[0]);for(const fa of F){if(!fa||!fa.media||fa.mh)continue;const wa=fa.media;wa.strtField="Automatically"===x?0:
2;fa.media=wa}}finally{R&&R.dispose()}}return 32})}Dad(a,b,c,f,l){return this.Dva(l,1)}uad(a,b,c,f,l){return this.Dva(l,0)}r1b(a,b,c,f,l){return 1===c?32:l?sg.b("AudioPlaybackOptionsActor::HandleSetVolume Volume: ",l.SourceControlId,a,()=>{const x=this.nb.mg();if(x&&0<x.length){const F=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{F.jc(x[0]);for(const R of x){if(!R||!R.media)continue;const fa=R.media;switch(a){case ba.a.BJe:fa.mteField=!0;break;case ba.a.zJe:fa.vlmField=.2;fa.mteField=
!1;break;case ba.a.AJe:fa.vlmField=.5;fa.mteField=!1;break;case ba.a.yJe:fa.vlmField=.8,fa.mteField=!1}this.hc.BK&&(R.media=fa);const wa=l.ActionFromPlayer;if(this.nta&&this.uD&&!wa){const Xa=this.uD.nK(R);Xa&&(Xa.setMute(fa.mteField),Xa.setVolume(fa.vlmField))}}}finally{F&&F.dispose()}}return 32}):(ya.a.J(512500759,822,10,"AudioPlaybackOptionsActor::HandleSetVolume actionData is null"),8)}Lad(a,b,c,f,l){return this.Dva(l,2)}Mad(a,b,c,f,l){return this.Dva(l,3)}Kad(a,b,c,f,l){return this.Dva(l,4)}Nad(a,
b,c,f,l){return this.Dva(l,5)}fbd(a,b,c,f,l){if(a=Object(va.a)(Ph.a,l))c=this.nb.mg(),b=this.zvg(c,2),c=this.zvg(c,0),b?(a.K1=ResourceStrings.L_AudioStartWhenClickedOn,a.ffd()):c&&(a.K1=ResourceStrings.L_AudioStartAutomatically,a.ffd());return 32}ead(){this.K$d()&&Gb.App.Fb.HF({PlayAcrossSlides:"CheckboxModel",LoopUntilStopped:"CheckboxModel",RewindAfterPlaying:"CheckboxModel",HideDuringShow:"CheckboxModel"});return 32}Cad(a,b,c,f,l){return this.Dva(l,6)}rad(a,b,c,f,l){return this.Dva(l,7)}mad(a,
b,c,f,l){return this.Dva(l,9)}Had(a,b,c,f,l){return this.Dva(l,8)}hKi(a){return a.media.plyAcrssSldsField&&a.media.repeatField&&!a.media.strtField}gKi(a){return!a.media.plyAcrssSldsField&&!a.media.repeatField&&!!a.media.strtField}zvg(a,b){if(a&&0<a.length){for(const c of a)if(!c||!c.media||c.media.strtField!==b)return!1;return!0}return!1}Dva(a,b){if(a=Object(va.a)(Ph.a,a)){const c=this.nb.mg();if(c&&0<c.length){let f=!1;for(const l of c)if(l&&l.media){switch(b){case 0:f=this.gKi(l);break;case 1:f=
this.hKi(l);break;case 5:f=l.media.mteField;break;case 2:f=!l.media.mteField&&.2>=l.media.vlmField;break;case 3:f=!l.media.mteField&&.2<l.media.vlmField&&.8>l.media.vlmField;break;case 4:f=!l.media.mteField&&.8<=l.media.vlmField;break;case 6:f=l.media.plyAcrssSldsField;break;case 7:f=l.media.repeatField;break;case 8:f=l.media.rewindField;break;case 9:f=l.media.hideDrngShwField;break;default:f=!1}if(!f)break}a.Kf(f)}}return 32}K$d(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp}}
Object(e.a)(oM,"AudioPlaybackOptionsActor",null,[244]);class pM{constructor(){this.type="AudioSettingsTaskPaneProps";this.hiddenSettings=this.onSubtitleLanguageUpdated=this.onSpokenLanguageUpdated=this.onSpeakersUpdated=this.onMicrophoneUpdated=this.availableSubtitleLanguages=this.availableSpokenLanguages=this.deviceSpeakers=this.deviceMicrophones=null;this.disableDeviceDropdown=!0;this.showDeviceErrorMessage=!1}}Object(e.a)(pM,"AudioSettingsTaskPaneProps",null,[]);class cu{constructor(){this.text=
this.key=null;this.itemType=0;this.selected=!1}}Object(e.a)(cu,"DropdownOption",null,[]);class qM{constructor(a,b,c,f,l){this.jL=null;this.KEa=this.Ib=!1;a.loadScript("audio-settings-strings").then(()=>{this.KEa=!0;ya.a.J(592447300,833,50,"audio-settings-strings loaded successfully")}).catch(x=>{ya.a.J(592447298,833,10,"Failed to load audio-settings-strings "+x.toString())});this.ia=b;this.yD=f;this.Dc=c;this.rN=l}ub(){this.ia.xa(ba.a.pLe,fc.a.application,Object(D.a)(this,this.pLe,"showHideAudioSettingsPane"));
this.ia.pa(ba.a.Jgc,fc.a.application,Object(D.a)(this,this.Jgc,"queryShowHideAudioSettingsPane"),96)}we(){}pLe(a,b,c){return b.contextId===fc.a.application&&this.KEa?1===c?32:sg.a("AudioSettingsPaneToggle",a,()=>{(this.Ib=!this.Ib)?(this.Kl(),this.rN.t2h(Object(D.a)(this,this.GWg,"onAudioDevicesChanged")),ya.a.J(592447296,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane show")):(this.rN.JOk(Object(D.a)(this,this.GWg,"onAudioDevicesChanged")),this.bK(),ya.a.J(592447266,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane close"));
return 32}):2}Jgc(a,b,c,f,l){if(!Object(Fa.a)(Ph.a,l))return 8;l.Kf(this.Ib);return 32}Kl(a=!1){a||this.IB();const b=Object.assign(new au.a,{title:ResourceStrings.L_AudioSettings,hideHeader:!1,width:320,location:2,contentProps:this.jL,onOpen:()=>{},onClose:()=>{this.Ib=!1},isModernPane:!0}),c=document.getElementById("AudioSettingsPaneFocus-panel");this.yD.v7(Nc.a.fNa,Nc.a.gj,c,()=>{this.Zz(!0)},()=>{this.Zz(!1)});yj.UISurfaces.Cs().then(f=>{a?this.Ib&&f.updateTaskPane(Nc.a.fNa,b):f.showTaskPane(Nc.a.fNa,
b);return null}).catch(f=>{ya.a.J(592447264,833,10,"AudioSettingsPaneActor::ShowPane exception: {0}",f.toString())})}bK(){yj.UISurfaces.Cs().then(a=>{a.hideTaskPane(Nc.a.fNa,2);return null}).catch(a=>{ya.a.J(592447262,833,10,"AudioSettingsPaneActor::ClosePane exception: {0}",a.toString())})}IB(){this.jL=Object.assign(new pM,{deviceMicrophones:[],deviceSpeakers:[],availableSpokenLanguages:this.wdj(),availableSubtitleLanguages:this.hej(),onMicrophoneUpdated:Object(D.a)(this,this.dvl,"updateMicrophone"),
onSpeakersUpdated:Object(D.a)(this,this.uwl,"updateSpeaker"),onSpokenLanguageUpdated:Object(D.a)(this,this.xwl,"updateSpokenLanguage"),onSubtitleLanguageUpdated:Object(D.a)(this,this.Dwl,"updateSubtitleLanguage"),hiddenSettings:["Speaker"],disableDeviceDropdown:!0,showDeviceErrorMessage:!1});this.rN.enumerateDevices(Object(D.a)(this,this.Vcc,"onEnumerateDevicesSuccess"),Object(D.a)(this,this.bWa,"onDevicesFailure"),Object(D.a)(this,this.lWa,"onUnsupported"))}Zz(a){const b=document.getElementById("TaskPaneCloseBtnAudioSettingsPaneFocus");
a&&b&&b.focus()}Vcc(a){if(0!==a.length)if(Ma.a.Va(a[0].label))this.rN.requestPermission(Object(D.a)(this,this.pnk,"onRequestPermissionSuccess"),Object(D.a)(this,this.bWa,"onDevicesFailure"),Object(D.a)(this,this.lWa,"onUnsupported")),ya.a.J(592447260,833,50,"AudioSettingsPaneActor::OnEnumerateDevicesSuccess requesting device permission");else{var b=new Ha.a,c=new Ha.a;for(const f of a)Ma.a.Va(f.deviceId)||(a=Object.assign(new cu,{key:f.deviceId,text:Ma.a.Va(f.label)?f.deviceId:f.label}),"audiooutput"===
f.kind?c.add(a):"audioinput"===f.kind&&b.add(a));0<b.count&&(b.ga(0).selected=!0);0<c.count&&(c.ga(0).selected=!0);this.jL.deviceMicrophones=b.toArray();this.jL.deviceSpeakers=c.toArray();this.jL.disableDeviceDropdown=!1;this.jL.showDeviceErrorMessage=!1;this.Kl(!0)}}pnk(){this.rN.enumerateDevices(Object(D.a)(this,this.Vcc,"onEnumerateDevicesSuccess"),Object(D.a)(this,this.bWa,"onDevicesFailure"),Object(D.a)(this,this.lWa,"onUnsupported"));ya.a.J(592447258,833,50,"AudioSettingsPaneActor::OnRequestPermissionSuccess successfully received permissions")}bWa(a){this.jL.disableDeviceDropdown=
!0;this.jL.showDeviceErrorMessage=!0;this.Kl(!0);ya.a.J(592447256,833,10,"AudioSettingsPaneActor::OnDevicesFailure unable to get devices. Error: {0}",a.toString())}lWa(){this.jL.disableDeviceDropdown=!0;this.Kl(!0);ya.a.J(592447254,833,10,"AudioSettingsPaneActor::OnDevicesUnsupported mediaDevices API not available for browser: {0}",n.a.iy)}dvl(a){this.rN.microphoneDeviceId=a.key;ya.a.J(592447252,833,50,"AudioSettingsPaneActor::UpdateMicrophone user updated microphone")}uwl(){ya.a.J(592447250,833,
50,"AudioSettingsPaneActor::UpdateSpeaker user updated speaker")}GWg(a,b){b.Ybk&&this.rN.enumerateDevices(Object(D.a)(this,this.Vcc,"onEnumerateDevicesSuccess"),Object(D.a)(this,this.bWa,"onDevicesFailure"),Object(D.a)(this,this.lWa,"onUnsupported"))}wdj(){const a=new Ha.a;for(let b of this.Dc.WNe)a.add(Object.assign(new cu,{key:b,text:sa.a.le(b).displayName,selected:this.Dc.Qma.toLowerCase()===b.toLowerCase()}));a.add(Object.assign(new cu,{key:"seperator",text:"-",itemType:1}));a.add(Object.assign(new cu,
{key:"header",text:ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle,itemType:2}));for(let b of this.Dc.VNe)a.add(Object.assign(new cu,{key:b,text:sa.a.le(b).displayName,selected:this.Dc.Qma.toLowerCase()===b.toLowerCase()}));return a.toArray()}hej(){const a=new Ha.a;for(let b of this.Dc.KMe)a.add(Object.assign(new cu,{key:b,text:sa.a.le(b).displayName,selected:this.Dc.gxa.toLowerCase()===b.toLowerCase()}));return a.toArray()}xwl(a){this.Dc.Qma=a.key;ya.a.J(592447248,833,50,"AudioSettingsPaneActor::UpdateSpokenLanguage user updated spoken language")}Dwl(a){this.Dc.gxa=
a.key;this.Dc.ohb=this.Dc.PNc();ya.a.J(592447246,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated subtitle language")}}Object(e.a)(qM,"AudioSettingsPaneActor",null,[244]);class rM{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(e.a)(rM,"CaptionDiscoverabilityTaskPaneProps",null,[]);class Av{constructor(a,b,
c,f,l,x,F,R,fa,wa){this.AJg=!1;a.loadScript("powerpoint-discoverability-strings").then(()=>{this.AJg=!0;ya.a.J(591971352,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Xa=>{ya.a.J(591971350,801,10,"Failed to load powerpoint-discoverability-strings "+Xa.toString())});this.ia=b;this.Qc=c;this.yc=f;this.fe=l;this.yD=x;this.Dc=F;this.rN=R;this.a4j=wa;this.B8j=fa;this.POg=Hi.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.S8b=!1;this.Qc.Rmb(Object(D.a)(this,this.eva,
"onRibbonTabSwitched"))}dispose(){this.Qc.Rhc(Object(D.a)(this,this.eva,"onRibbonTabSwitched"))}ub(){this.ia.xa(ba.a.wkc,fc.a.application,Object(D.a)(this,this.wkc,"showCaptionDiscoverabilityPane"))}we(){}wkc(a,b,c){if(b.contextId!==fc.a.application||!this.AJg)return 2;if(1===c)return 32;if(Av.Z8d||Av.QRd||!this.VOi()||!this.UOi())return 8;this.S8b||this.oki(a);return 32}oki(a){sg.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",a,()=>{this.S8b=!0;this.rN.enumerateDevices(Object(D.a)(this,
this.zhk,"onAudioInputAvailable"),Object(D.a)(this,this.bWa,"onDevicesFailure"),Object(D.a)(this,this.lWa,"onUnsupported"));return 32})}zhk(a){if(a.length){for(const b of a)if("audioinput"===b.kind&&!this.B8j.yvb()){Av.Z8d=!0;this.Kl();break}this.S8b=!1}}bWa(a){this.S8b=!1;ya.a.J(591538019,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",a.toString())}lWa(){this.S8b=!1;ya.a.J(591538017,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",
n.a.iy)}Kl(){const a=this.IB(),b=Object.assign(new au.a,{title:ResourceStrings.l_CaptionDiscoverabilityPane,hideHeader:!1,width:320,location:2,contentProps:a,onOpen:()=>{ya.a.J(591538015,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{ya.a.J(591738121,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.yD.v7(Nc.a.x3a,Nc.a.gj,null,()=>{},()=>{});yj.UISurfaces.Cs().then(c=>{c.showTaskPane(Nc.a.x3a,b);return null}).catch(c=>{ya.a.J(591971348,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",
c.toString())})}Ds(){yj.UISurfaces.Cs().then(a=>{a.hideTaskPane(Nc.a.x3a,2);return null}).catch(a=>{ya.a.J(591971346,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",a.toString())})}IB(){return Object.assign(new rM,{podiumPresentationImageUrl:this.fe.Yj("CaptionDiscoverabilityPromptViewImage.png"),enableDoNotShowAgain:this.POg,onTurnOnButtonClicked:Object(D.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(D.a)(this,this.onDismissButtonClicked,
"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(D.a)(this,this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){sg.a("CaptionDiscoverabilityPaneTurnOn",ba.a.yIb,()=>{let a=8;this.Dc.Gh||(a=this.ia.Ka(ba.a.yIb,2,{}));this.a4j&&8!==a||this.Ds();return a})}onDismissButtonClicked(){this.POg&&(Av.QRd=!0,ya.a.J(591738117,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.Ds()}onLaunchSlideShowButtonClicked(){sg.a("CaptionDiscoverabilityPaneLaunchSlideshow",
ba.a.dlc,()=>{this.Ds();return this.ia.processAction(ba.a.dlc,2)})}eva(a,b){2!==b.Uu&&3!==b.Uu&&4!==b.Uu||!b.jla||"SlideShow"!==b.jla||sg.a("OnRibbonTabSwitched",ba.a.wkc,()=>this.ia.processAction(ba.a.wkc,2))}UOi(){let a=0,b=!1,c=!1;for(var f of this.yc.oKc()){if(f.En){b=!0;break}if(f.MQa&&(a+=f.rP.length,4<=a))break;if(f.s7a){c=!0;break}}f=c||b||4<=a;ya.a.J(591738113,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",
f.toString(),a.toString(),b.toString(),c.toString());return f}VOi(){return!this.Dc.Gh&&this.COi()}COi(){const a=sa.a.le(u.AFrameworkApplication.lcid);return!a||Ma.a.Va(a.name)?!1:a.name.toLowerCase()===this.Dc.Qma}static get Z8d(){var a=Hi.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!a)return!1;const b=new Date;a=new Date(decodeURIComponent(a));return 14>(+b-+a)/864E5}static set Z8d(a){Hi.a.JL("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),Hi.a.rL)||ya.a.J(591971344,822,
10,"Failed to set cookie for discoverability last shown time to {0}",a.toString())}static get QRd(){const a=Hi.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return a?"true"===a.toLowerCase():!1}static set QRd(a){Hi.a.JL("PPTCaptionDiscoverabiltyDoNotShowAgain",a.toString(),Hi.a.rL)||ya.a.J(591971342,822,10,"Failed to set cookie for discoverability opt out to {0}",a.toString())}}Object(e.a)(Av,"CaptionDiscoverabilityPaneActor",null,[244]);var sM=d(712);class Us{constructor(a,b){this.id=a;this.version=
b}}Object(e.a)(Us,"PackageAccessKey",null,[]);const Bv=a=>a?fe.c({["I"]:a.id,["V"]:a.version}):null;var Ap=d(323);class Ox{constructor(a,b){this.rt=a;this.Rb=b}}Object(e.a)(Ox,"ClipServiceCopyParams",null,[]);class Px extends Ox{constructor(a,b,c){super(a,b);this.a$=c}}Object(e.a)(Px,"ClipServiceShapeCopyParams",Ox,[]);class Uz extends Ox{constructor(a,b,c){super(a,b);this.lrh=c}}Object(e.a)(Uz,"ClipServiceSlideCopyParams",Ox,[]);var pE=d(696),qE=d(433);class Qx{constructor(a,b,c){this.ia=a;this.Fa=
b;this.nFa=c}QM(a){a=Qx.w_b(a);return this.nFa.d3b(this.Fa)&&!!a&&!!a.src}paste(a){u.AFrameworkApplication.ZP?qE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.ia.Ka(ba.a.wec,2,a)}static w_b(a){if(!a||!a.Cm)return ya.a.J(558445148,826,15,"ImagePasteHandler: User attempted to paste null content."),null;a=a.Cm.getElementsByTagName(Xe.a.Qba);if(!a.length)return null;a=a[0];return a.src?a:null}}Object(e.a)(Qx,"ImagePasteHandler",null,[458]);var Rm=d(369);class rE{constructor(){this.s6g=
this.aSd=null}}Object(e.a)(rE,"PasteSlideAsImageData",null,[]);class sE{constructor(){this.pastedContent=this.rva=null}}Object(e.a)(sE,"PasteSlideAsImageFromRibbonData",null,[]);class Vz extends Sys.EventArgs{constructor(){super()}}Object(e.a)(Vz,"SlidesChangedArgs",Sys.EventArgs,[]);class tE extends Sys.EventArgs{constructor(a,b,c){super();this.Fp=a;this.pji=b;this.qji=c}}Object(e.a)(tE,"UpdateCcpInfoEventArgs",Sys.EventArgs,[]);class tM{constructor(){this.ShapeId=this.Cid=this.Sid=0}}Object(e.a)(tM,
"CopiedShape",null,[]);class uM{constructor(){this.Cid=this.Sid=0}}Object(e.a)(uM,"CopiedSlide",null,[]);class uE extends Yg.a{constructor(){super();this.Shapes=this.Slides=this.Location=this.CcpId=null;this.MultiSlideCopy=!1;this.PackageAccessKey=this.CcpCorrelation=null}Ik(){return 65}}Object(e.a)(uE,"CopyRequest",Yg.a,[]);class Rx{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf){this.Ale=this.zta=null;this.ia=a;this.NS=f;this.Fa=l;this.Xb=x;this.ta=F;this.Db=
R;this.VK=Dc;this.ni=fa;this.Yb=wa;this.Pw=Xa;this.eEa=lb;this.Qb=Lb;this.gl=kc;this.la=b;this.ra=lc;this.CDg=Ec;this.Q5j=Wd;this.Ie=Jc;this.Sb=xe;this.R5j=Sd;this.rr=Pe;this.fne=this.la.Rvg;this.Boe=this.la.rgh;this.Ur=Ue;this.tc=Ef;this.OG=dg;this.Vw=Mg;this.iMg=Bg;this.eQ=Lf;if(!this.OG)throw ya.a.J(512356641,826,10,"ClipServiceActor pastemanager is null"),Error.argumentNull("ClipServiceActor pastemanager is null");}ub(){this.ia.pa(ba.a.SQf,fc.a.application,Object(D.a)(this,this.ukj,"handleCopySlidesToClipService"),
0);this.ia.pa(ba.a.x9c,fc.a.application,Object(D.a)(this,this.T2d,"handlePasteSlidesFromClipService"),4);this.ia.pa(ba.a.y9c,fc.a.application,Object(D.a)(this,this.Zmj,"handlePasteSlideKeepingDestinationThemeFromFloatie"),4);this.ia.pa(ba.a.xec,fc.a.application,Object(D.a)(this,this.$mj,"handlePasteSlideKeepingSourceFormattingFromFloatie"),4);this.ia.pa(ba.a.UCk,fc.a.application,Object(D.a)(this,this.yad,"queryPasteOptions"),97);this.ia.pa(ba.a.RQf,fc.a.application,Object(D.a)(this,this.tkj,"handleCopyShapesToClipService"),
0);this.ia.pa(ba.a.B3g,fc.a.application,Object(D.a)(this,this.Wmj,"handlePasteShapesFromClipService"),4);this.ia.pa(ba.a.D3g,fc.a.application,Object(D.a)(this,this.S2d,"handlePasteSlideFromDesktop"),4);this.ia.pa(ba.a.w9c,fc.a.application,Object(D.a)(this,this.Xmj,"handlePasteSlideAsImage"),4);this.ia.pa(ba.a.C3g,fc.a.application,Object(D.a)(this,this.Ymj,"handlePasteSlideAsImageFromRibbon"),4);this.ia.pa(ba.a.ZTf,fc.a.application,Object(D.a)(this,this.vkj,"handleCutShapes"),4);this.ia.pa(ba.a.QTd,
fc.a.application,Object(D.a)(this,this.QTd,"expandPasteFloatieMenu"),96);this.ia.pa(ba.a.$Tf,Fb.a.application,Object(D.a)(this,this.wkj,"handleCutSlides"),4);this.ia.pa(ba.a.G3g,Fb.a.application,Object(D.a)(this,this.Pmj,"handlePasteCancelledByUser"),2048)}we(){}Ymj(a,b,c,f,l){ya.a.J(512356640,826,50,"HandlePasteSlideAsImageFromRibbon called");a=Object(va.a)(sE,l);if(!a||!a.rva)return ya.a.J(512356639,826,10,"HandlePasteSlideAsImageFromRibbon pasteSlideAsImageFromRibbonData is invalid"),8;if(1===
c)return 32;c=a.rva.Rb;b=this.tc.oO(2,1,"HandlePasteSlideAsImageFromRibbon");this.tc.Rh("PasteSlideAsImageFromRibbon",c,b);a.rva.Rb=b;this.OG.paste(a.rva,a.pastedContent,!0);return 32}Xmj(a,b,c,f,l){a=Object(va.a)(rE,l);if(!a||!a.aSd)return ya.a.J(512356638,826,10,"HandlePasteSlideAsImage PasteSlideAsImageData is null"),8;if(1===c)return 32;this.OG.w9c(a.aSd,a.s6g);return 32}QTd(a,b,c){if(1===c)return 32;this.Q5j.AEk();return 32}yad(a,b,c,f,l){if(!this.rr||!this.rr.kdb)return 8;a=this.rr.kdb.Sy;l.SourceControlId&&
("PasteSlideKeepDestinationFromClipService"===l.SourceControlId?l[ai.a.On]=null!=a&&!a:"PasteSlideKeepSourceFromClipService"===l.SourceControlId&&(l[ai.a.On]=null!=a&&a));return 32}$mj(a,b,c,f){if(1===c)return 32;const l=this.rr.kdb;if(!l)return 8;const x=l.rt,F=l.VI;if(!x&&!F)return 8;if(null!=l.Sy&&l.Sy)return 32;l.Rb=this.tc.oO(2,2,"HandlePasteSlideKeepingSourceFormattingFromFloatie");l.Sy=!0;const R=this.Sb.XH(this.rr.zxe);ya.a.J(512356637,307,50,"HandlePasteSlideKeepingSourceFormattingFromFloatie - KeepSource set to true");
if(F)return F.skipUndo=!0,F.selectionSlide=R,this.S2d(a,b,c,f,l);x.skipUndo=!0;x.selectionSlide=R;return this.T2d(a,b,c,f,l)}Zmj(a,b,c,f){if(1===c)return 32;const l=this.rr.kdb;if(!l)return 8;const x=l.rt,F=l.VI;if(!x&&!F)return 8;if(null!=l.Sy&&!l.Sy)return 32;l.Rb=this.tc.oO(2,2,"HandlePasteSlideKeepingDestinationThemeFromFloatie");l.Sy=!1;const R=this.Sb.XH(this.rr.zxe);ya.a.J(512356636,307,50,"HandlePasteSlideKeepingDestinationThemeFromFloatie - KeepSource set to false");if(F)return F.skipUndo=
!0,F.selectionSlide=R,this.S2d(a,b,c,f,l);x.skipUndo=!0;x.selectionSlide=R;return this.T2d(a,b,c,f,l)}tkj(a,b,c,f,l){a=Object(va.a)(Px,l);if(!a)return ya.a.J(512356635,307,50,"ClipServiceCopyParams are null."),8;b=a.rt;c=a.a$;if(!b||!c||!c.length)return ya.a.J(512356634,307,50,"Copied shapes are empty."),this.tc.Cg(!1,a.Rb,23),8;if(this.Xb.ARa())return this.tc.Cg(!1,a.Rb,2),16;if(Pa.a.any(c,F=>F.J2))return ya.a.J(512356633,826,15,"HandleCopyShapesToClipService: deferred content detected."),8;f=[];
for(var x of c)f.push(Object.assign(new tM,{Sid:x.slideSid,Cid:x.slideCid,ShapeId:x.get_shapeId()}));x=Object.assign(new uE,{CcpId:b.Fp,Location:b.location,Shapes:f,CcpCorrelation:a.Rb,PackageAccessKey:Bv(new Us(a.rt.Qy,b.version))});this.gIc(x,2,a.Rb);return 32}Wmj(a,b,c,f,l){b=Object(va.a)(Rm.a,l);if(!b)return 8;3!==b.rt.dataType?this.tc.aB(2,b.Rb):(this.tc.aB(7,b.Rb),this.tc.iw(5,b.Rb));c=b.rt;if(!c)return this.tc.Cg(!1,b.Rb,16),ya.a.J(512356632,307,50,"HandlePasteShapesFromClipService: Cross-session pasted shapes are empty."),
8;3!==b.rt.dataType&&this.tc.iw(pE.ClipboardHelper.Drg(c)?2:3,b.Rb);f=this.ta.Ba;if(!f||!f.isConnected)return this.tc.Cg(!1,b.Rb,3),ya.a.J(512356631,307,50,"HandlePasteShapesFromClipService: targetSlide: {0}.",f?"not null":"null"),16;if(this.Xb.Zc(f))return this.tc.Cg(!1,b.Rb,3),ya.a.J(512356630,307,50,"HandlePasteShapesFromClipService: failed since the targetSlide is blocked."),2;if(!this.gl.lI(f,c.objectCount))return this.tc.Cg(!1,b.Rb,8),ya.a.J(512356629,307,50,"HandlePasteShapesFromClipService: failed since there are too many shapes on the target slide."),
this.gl.kJ(f),16;this.kFd(c.Fp,b.Rb);Mc.a.lxa("PasteShapesFromClipService",!0);Mc.a.uO(!1,!1);this.Ale&&this.Ale===c.Fp||(this.zta=new Me.a(0));f.CM=c.Fp;f.hP=c.location;f.G1=c.jE;f.QY=Rx.TPe(c.Gqa);f.Qy=Bv(new Us(c.Qy,c.version));l=null;this.tc.y4b(b.Rb)&&(l=Qx.w_b(b));if(this.Boe&&3===b.rt.dataType)try{let x=0;this.zta&&this.zta.Jb(f.Bb)&&(x=this.zta.ga(f.Bb));this.Xb.sJd(f,a,x);ya.a.J(512356628,307,50,"HandlePasteShapesFromClipService: shimmer view successful")}catch(x){ya.a.J(512356627,307,10,
"HandlePasteShapesFromClipService: failed to show shimmer view")}this.eEa.NBi(f,c,this.zta,a,b.Rb,l);this.Ale=c.Fp;this.tc.Cg(!0,b.Rb);return 32}vkj(a,b,c,f,l){if(this.Xb.ARa())return 16;if(1===c)return 32;Mc.a.uO(!0,!0);const x=this.ra.mg();b=this.ra.Ip();var F=f=c=null;let R=[];l=Object(va.a)(Px,l);if(!l)return 8;if(l.rt){var fa=l.rt;R=l.a$;if(!R||!R.length)return 8;c=fa.Fp;F=fa.version;f=fa.location;F=Bv(new Us(fa.Qy,F))}else for(fa of x)fa.OTc&&R.push(fa);for(var wa of R)if(wa.Mf||wa.mh){Qn(wa);
break}wa=this.Db.rd(15,void 0,()=>{this.ra.Ph()});try{wa.jc(b),wa.$c=a,this.CDg.w$g(new tE(c,f,F)),b.Rb=l.Rb,b.HT(R)}finally{wa&&wa.dispose()}for(const Xa of R)this.Ur.e$g(new OJ.a(Xa));this.NS.$ae=c;return 32}wkj(a,b,c,f,l){b=this.ra.mf();if(!b||!b.length||!this.ta.Ba)return 16;for(var x of b)if(!x||this.Xb.Zc(x)||!x.isConnected)return 16;if(1===c)return 32;Mc.a.Cb&&(Mc.a.Cb.actionName="CutSlide",Mc.a.Cb.Ar=!1,Mc.a.Cb.Ij=!0,Mc.a.Cb.BE=new Date,Mc.a.Cb.Wa("SlideCount",b.length.toString()));f=x=c=
null;var F=[];l=Object(va.a)(Uz,l);if(!l)return 8;if(l.rt){f=l.rt;F=l.lrh;if(!F||!F.length)return 8;c=f.Fp;F=f.version;x=f.location;f=Bv(new Us(f.Qy,F))}F=this.Yb.yf;if(!F)return 16;const R=this.Db.rd(15,void 0,()=>{this.ra.Ph()});try{this.CDg.w$g(new tE(c,x,f));R.jc(F);for(const fa of b)fa&&!fa.Bb.equals(this.ta.Ba.Bb)&&F.JM(fa);F.JM(this.ta.Ba);R.$c=a;F.Rb=l.Rb}finally{R&&R.dispose()}this.la.unblockContentWhenDeletingSlideEnabled||this.Xb.zw(F,a);this.Ur?this.Ur.aCe(new Vz(b)):ya.a.J(512356626,
826,10,"HandleCutSlides: graphOperationEventNotifier is null for raising event.");this.NS.$ae=c;return 32}gIc(a,b){this.NS.Ghk(a);var c=[String.format("{0}={1}","CcpId",a.CcpId),String.format("{0}={1}",Ap.a.type,sM.a(b))];Mc.a.hk("CcpId",a.CcpId);c=new Nf.a(a,()=>{this.Mik(a)},f=>this.Lik(f,a,b),f=>0===f.StatusCode,void 0,c);ya.a.J(512356625,307,50,String.format("Created task: {0} for ccpid: {1}",c.id,a.CcpId));this.ni.Gb(c)}Mik(a){this.NS.jWg(!0,a)}Lik(a,b,c){ya.a.J(512356624,307,10,String.format("Failed to copy {0} for ccpid: {1} with statuscode: {2}.",
sM.a(c),b.CcpId,a.StatusCode));this.NS.jWg(!1,b);return!0}kFd(a,b){const c=Mc.a.Cb;c&&(c.Wa("CcpId",a),this.tc.Rh("CcpId",a,b))}ukj(a,b,c,f,l){a=Object(va.a)(Uz,l);if(!a||!a.rt)return ya.a.J(512356623,307,50,"HandleCopySlidesToClipService: either copyParams '{0}' or copyParams.ClipServiceObject is null.",a?"not null":"null"),8;ya.a.J(512356622,307,50,"HandleCopySlidesToClipService: executing for ccpid: {0}",a.rt.Fp);b=a.lrh;if(!b||!b.length||0>=vj.e(b,x=>Object(Fa.a)(123,x)).length)return ya.a.J(512356621,
307,50,"HandleCopySlidesToClipService: no slide is copied"),8;if(Pa.a.any(b,x=>x.hasDeferredContent))return ya.a.J(512356620,826,15,"HandleCopySlidesToClipService: trying to copy slides with deferred content to clipboard service"),8;b=Object.assign(new uE,{CcpId:a.rt.Fp,Location:a.rt.location,MultiSlideCopy:!0,Slides:vj.c(b,x=>Object.assign(new uM,{Sid:x.sid,Cid:x.cid})),CcpCorrelation:a.Rb,PackageAccessKey:Bv(new Us(a.rt.Qy,a.rt.version))});this.gIc(b,1,a.Rb);return 32}S2d(a,b,c,f,l){if(1===c)return 32;
b=Object(va.a)(Rm.a,l);if(!b)return ya.a.J(512356619,826,10,"HandlePasteSlideFromDesktop: PasteParams is null."),8;c=b.VI;if(!c||Ma.a.Va(c.ccpid)||Ma.a.Va(c.data))return ya.a.J(512356618,826,10,String.format("HandlePasteSlideFromDesktop: Invalid pickling data ccpid: {0}",c?c.ccpid:"null")),this.tc.Cg(!1,b.Rb,28),8;Mc.a.lxa("PasteSlideFromDesktop",!0);this.kFd(c.ccpid,b.Rb);this.tc.iw(12,b.Rb);f={};f.CcpCorrId=b.Rb;return this.Fhg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.Sy?b.Sy:!0,c.ccpid,
null,null,u.AFrameworkApplication.userSessionId,0,f,c.data,c.isDataCompressed)}T2d(a,b,c,f,l){if(1===c)return 32;b=Object(va.a)(Rm.a,l);if(!b)return ya.a.J(51520671,307,10,"HandlePasteSlidesFromClipService: PasteParams is null."),8;Mc.a.lxa("PasteSlidesFromClipService",!0);c=b.rt;if(!c)return this.tc.Cg(!1,b.Rb,16),ya.a.J(512356617,307,10,"HandlePasteSlidesFromClipService: Cross-session pasted slides are empty."),8;this.tc.iw(pE.ClipboardHelper.Drg(c)?2:3,b.Rb);this.kFd(c.Fp,b.Rb);f=this.Pw.$7d(c);
return!this.la.Mvg&&f?(this.tc.Cg(!1,b.Rb,17),ya.a.J(34481168,307,10,"HandlePasteSlidesFromClipService: Don't support cross-dc paste slide: {0}",c),16):this.Fhg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.Sy?b.Sy:!0,c.Fp,c.location,c.jE,c.Qy,c.version,c.Gqa,null,!1)}Fhg(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){this.tc.aB(19,a.Rb);const lc=this.ta.presentation;if(!lc)return this.tc.Cg(!1,a.Rb,3),ya.a.J(512356616,307,10,"HandlePasteSlide: Failed because presentation node is null"),16;if(this.Xb.Zc(lc))return this.tc.Cg(!1,
a.Rb,3),ya.a.J(512356615,307,10,"HandlePasteSlide: Can't continue because the presentation was being blocked."),2;var Ec=this.ta.Ba;if(Ec&&!Ec.isConnected)return this.tc.Cg(!1,a.Rb,3),ya.a.J(512356614,307,10,"HandlePasteSlide: Failed since the selected slide is disconnected."),16;ya.a.J(512356613,307,50,String.format("HandlePasteSlide skipUndo: {0} and keepSource value is: {1}",c.toString(),x.toString()));this.fne&&!this.Pw.lrg(a)&&this.R5j.b1h();this.rr.NUc=Date.now();this.VK.KV(this.Sb.An)&&ya.a.J(512356612,
307,50,"cross session paste slide happened before last action server result is not returned");Mc.a.uO(!1,!1);let Jc;var Dc=null;Ec=this.la.Chd&&!Ma.a.Va(Lb)&&1!==this.Qb.Nu;if(c)Dc=f,Jc=null;else{Dc=this.ta.presentation;if(!Dc)throw Error.argumentNull("Presentation is null");Jc=Array.isArray(Dc.$Sf(l,a.Rb,Ec))?Dc.$Sf(l,a.Rb,Ec):null;f=Dc=this.r9i();this.rr.position=null;this.rr.zxe=Dc?Dc.slideIndex:0}l=null;c||(l=()=>{let Wd;(Wd=this.ra).DX.apply(Wd,Jc)});l=this.Db.rd(15,void 0,()=>{this.Fa.Bf(Nc.a.dE)},
l);try{if(l.jc(lc),l.$c=c?lc.X8a?ba.a.xec:ba.a.y9c:b,Ec?(lc.Xra=!0,this.Vw.init(F)):(lc.CM=F,lc.X8a=x,lc.xxe=Dc?Dc.Bb:null,lc.hP=R,lc.G1=fa,lc.QY=Rx.TPe(lb),lc.skipUndo=c,lc.Qy=Bv(new Us(wa,Xa)),lc.Zub=null==kc?!1:kc,lc.yec=Lb,lc.Rb=a.Rb),!c){R=Dc;for(fa=0;fa<Jc.length;fa++)lc.Ptb(Jc[fa],R,null),R=Jc[fa],Ec&&(Jc[fa].Xra=!0,this.Vw.oia.add(Jc[fa].id));this.Yb.Ba=Jc[Jc.length-1];this.Ie.Aqb=!0}}finally{l&&l.dispose()}Ec?(this.Vw.tAh(!0),this.Xb.blockContent(lc,b)):this.Xb.zw(lc,b);this.rr.kdb=a;this.rr.dgb=
!0;this.rr.TGa=null;this.Ie.Aqb=!0;this.rr.SWb=this.Sb.An.LL;Ec&&(this.tc.Rh("DisplayNewPasteProgressUX","true",a.Rb),this.OCi(Lb,u.AFrameworkApplication.userSessionId,Dc,c,x,F,lb,kc,a.Rb));this.tc.Cg(!0,a.Rb);return 32}OCi(a,b,c,f,l,x,F,R,fa){const wa=this.tc.oO(2,0,"DataUploadInit");this.tc.iw(13,wa);this.tc.aB(19,wa);this.tc.Rh("DataUploadInitOldCcpCorrId",fa,wa);this.Vw.ktl(wa);const Xa=(new Date).getTime();this.iMg.Xgl(a,b,x,()=>{const lb=(new Date).getTime()-Xa;ya.a.J(512356611,826,50,"DataUploadInit: Upload pasted data successful for ccpid: {0} time: {1}",
x,lb);this.tc.Rh("DataUploadTime",lb.toString(),wa);this.NCi(wa,b,c,f,l,x,F,R)},lb=>{ya.a.J(512356610,826,10,"DataUploadInit: Upload pasted data failed for ccpid: {0}, error:{1} time: {2}",x,Nk.a[lb.error.Code],(new Date).getTime()-Xa);this.xkj();this.tc.Cg(!1,wa,30)})}NCi(a,b,c,f,l,x,F,R){const fa=this.ta.presentation;if(fa){this.Vw.Mfk();Mc.a.uO(!1,!1);ya.a.J(512356608,307,50,"DataUploadFinish: FakeSlideIds: {0}",this.Vw.oia.toArray().join(",").toString());var wa=this.Db.rd(15);try{wa.jc(fa),wa.$c=
ba.a.xec,fa.xxe=c?c.Bb:null,fa.VUb=b,fa.zec=this.Vw.oia.toArray().join(",").toString(),fa.CM=x,fa.QY=Rx.TPe(F),fa.skipUndo=f,fa.Zub=null==R?!1:R,fa.X8a=l,fa.Rb=a}finally{wa&&wa.dispose()}this.tc.Cg(!0,a)}else ya.a.J(512356609,307,10,"DataUploadFinish: Failed because presentation node is null")}Pmj(a,b,c,f,l){if(1===c)return 32;if(!(l&&"UploadId"in l&&"CcpCorrId"in l))return ya.a.J(512356579,307,10,"HandlePasteCancelledByUser: actionDataDictionary invalid {0}",l),8;a=l.UploadId;l=l.CcpCorrId;ya.a.J(512356578,
307,50,"HandlePasteCancelledByUser: uploadId: {0}",a);this.iMg.$ii(a);this.tc.Cg(!1,l,31);return 32}xkj(){this.Vw.uLf(!0);this.eQ.twa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,20)}ifl(a){a.sort((b,c)=>c.slideIndex-b.slideIndex)}r9i(){const a=this.ra.mf();return 0<a.length&&(this.ifl(a),a[0])?a[0]:this.ta.Ba}static TPe(a){return JSON.stringify(a)}}Object(e.a)(Rx,"ClipServiceActor",null,[244]);class vE{constructor(){this.actionId=
0;this.context=null;this.behavior=0;this.ld=this.bJ=null}}Object(e.a)(vE,"AActionArgs",null,[]);class wE extends vE{constructor(){super()}}Object(e.a)(wE,"ActionArgs$2",vE,[]);class xE extends wE{constructor(){super()}}Object(e.a)(xE,"ActionArgs$1",wE,[]);var Eq=d(453),du=d(374);class Vs{constructor(a,b=!1){this.Trg=!0;this.Rb=null;this.dataType=0;this.SOi=a;this.Zra=b}}Object(e.a)(Vs,"CutCopyParams",null,[]);var Cv=d(432),vM=d(527);class Wz{constructor(a,b,c,f){this.ia=a;this.j4j=f;this.nFa=c;this.Fa=
b}QM(a){return this.nFa.d3b(this.Fa)&&!!Wz.x9f(a)}paste(a){this.j4j?qE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):(ya.a.J(17310402,826,50,"TablePasteHandler: Execute command to paste table from clipboard."),this.ia.Ka(ba.a.sva,2,a))}static x9f(a){return a&&a.Cm?(a=a.Cm.getElementsByTagName(Xe.a.dIb))&&a.length?a[0]:null:null}}Object(e.a)(Wz,"TablePasteHandler",null,[458]);class al{static get bA(){return hb.a.instance.pb("PowerPointWebEditor.ISystemClipboard")}}Object(e.a)(al,
"SystemClipboardFactory",null,[]);class wM{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg){this.zta=this.C_c=null;this.ZEg=0;if(!Bg)throw Error.argumentNull("DeferredContentManager");this.ia=a;this.Fa=b;this.ra=c;this.ah=Lb;this.Xb=wa;this.Mja=Xa;this.OG=lb;this.Yb=f;this.Vp=l;this.Wv=Bg;this.Db=x;this.Gz=F;this.rq=fa;this.eEa=kc;this.Sb=lc;this.xm=Ec;this.Qb=Jc;this.yEg=Dc;this.K9a=Wd;this.gl=xe;this.kW=Sd;this.QTa=Ue;this.yb=Ef;this.y8=dg;this.tc=Mg;this.la=
R}ub(){this.la.iRc?(this.ia.pa(ba.a.Kpb,fc.a.application,Object(D.a)(this,this.Rgg,"handleCutCopyToSystemClipboardAsync"),4),this.ia.pa(ba.a.bWb,fc.a.application,Object(D.a)(this,this.Rgg,"handleCutCopyToSystemClipboardAsync"),0),this.ia.pa(ba.a.vec,fc.a.application,Object(D.a)(this,this.wOc,"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(ba.a.idb,fc.a.application,Object(D.a)(this,this.wOc,"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(ba.a.jdb,fc.a.application,Object(D.a)(this,this.wOc,
"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(ba.a.WCb,fc.a.application,Object(D.a)(this,this.wOc,"handlePasteFromSystemClipboardAsync"),4)):(this.ia.pa(ba.a.Kpb,fc.a.application,Object(D.a)(this,this.Qgg,"handleCutCopyToSystemClipboard"),4),this.ia.pa(ba.a.bWb,fc.a.application,Object(D.a)(this,this.Qgg,"handleCutCopyToSystemClipboard"),0),this.ia.pa(ba.a.vec,fc.a.application,Object(D.a)(this,this.vOc,"handlePasteFromSystemClipboard"),4),this.ia.pa(ba.a.idb,fc.a.application,Object(D.a)(this,
this.vOc,"handlePasteFromSystemClipboard"),4),this.ia.pa(ba.a.jdb,fc.a.application,Object(D.a)(this,this.vOc,"handlePasteFromSystemClipboard"),4),this.ia.pa(ba.a.WCb,fc.a.application,Object(D.a)(this,this.vOc,"handlePasteFromSystemClipboard"),4));this.ia.pa(ba.a.QQf,fc.a.application,Object(D.a)(this,this.skj,"handleCopyShapes"),0);this.ia.pa(ba.a.u9c,Fb.a.application,Object(D.a)(this,this.Vmj,"handlePasteShapes"),4);this.ia.pa(ba.a.wec,fc.a.application,Object(D.a)(this,this.Umj,"handlePastePicture"),
4);this.ia.pa(ba.a.sva,Fb.a.application,Object(D.a)(this,this.bnj,"handlePasteTable"),4);this.ia.pa(ba.a.v9c,fc.a.application,Object(D.a)(this,this.anj,"handlePasteSlides"),4);this.ia.pa(ba.a.Dxe,fc.a.application,Object(D.a)(this,this.cnj,"handlePasteTextIntoNewShape"),4);this.ia.SU(ba.a.i5g,fc.a.application,Object(D.a)(this,this.Qjj,"handleBrowserCut"),4);this.ia.SU(ba.a.Jye,fc.a.application,Object(D.a)(this,this.Pjj,"handleBrowserCopy"),0);this.ia.SU(ba.a.j$c,fc.a.application,Object(D.a)(this,this.Rjj,
"handleBrowserPaste"),4);this.ia.SU(ba.a.q5g,fc.a.application,Object(D.a)(this,this.Smj,"handlePasteGivenText"),4);this.ia.pa(ba.a.o3g,fc.a.application,Object(D.a)(this,this.Rmj,"handlePasteContentFromPandora"),4);this.ia.pa(ba.a.QGa,Fb.a.application,Object(D.a)(this,this.handlePasteHtml,"handlePasteHtml"),4);this.ia.pa(ba.a.s9c,Fb.a.application,Object(D.a)(this,this.Tmj,"handlePasteHtmlAsync"),4);this.ia.pa(ba.a.cOd,de.a.frame,Object(D.a)(this,this.Qmj,"handlePasteChartAsImage"),4);this.ia.xa(ba.a.hQd,
de.a.frame,Object(D.a)(this,this.Pgg,"handleCutCopyThroughShortcuts"));this.ia.xa(ba.a.UQf,de.a.frame,Object(D.a)(this,this.Pgg,"handleCutCopyThroughShortcuts"));this.ia.pa(ba.a.F3g,de.a.frame,Object(D.a)(this,this.dnj,"handlePasteThroughShortcuts"),4)}we(){if(ee.a("ShortcutsFixInMac")&&n.a.C4b){const a=[this.Fa.Bc(xi.a.$C),this.Fa.Bc(Nc.a.yg)];for(const b of a)b.bindAction(A.KeyInputManager.Na(w.a.KJa,A.KeyInputManager.Fe),ba.a.UQf),b.bindAction(A.KeyInputManager.Na(w.a.dib,A.KeyInputManager.Fe),
ba.a.F3g)}}Pgg(a){a=ba.a.hQd===a;const b=this.tc.oO(a?1:0,0,a?"OnBrowserCut":"OnBrowserCopy");this.Mja.vqa(Object.assign(new Vs(!1,a),{Rb:b}));return 32}dnj(){const a=this.tc.oO(2,0,"OnBrowserPaste");this.OG.paste(Object.assign(new Rm.a(!0),{Rb:a}),null,!1);return 32}Rgg(a,b,c,f){let l,x;if(!({CE:l,FFc:x}=this.mQf(c,a)).returnValue)return l;if(!al.bA)return this.tc.Cg(!1,x.Rb,1),8;this.lba(a,b,c,f,!0,x.Rb);return 32}wOc(a,b,c,f){if(1===c)return this.ra.vRa()?2:a===ba.a.idb?2:a===ba.a.jdb?this.ekc(!1):
a===ba.a.WCb?this.ekc(!0):32;const l=this.tc.oO(2,1,"HandlePasteFromSystemClipboardAsync");if(this.ra.L7())return this.tc.Cg(!1,l,3),16;if(!al.bA)return this.tc.Cg(!1,l,1),8;this.lba(a,b,c,f,!1,l);Mc.a.uO(!0,!1);return 32}ekc(a){ya.a.J(512356577,826,50,"ShouldEnablePasteAsOptions called");return this.ra.D7()?(ya.a.J(512356576,826,15,"ShouldEnablePasteAsOptions: inside textbox hence disabled"),2):this.OG.kki(a)?32:2}sXf(a,b){a===ba.a.Kpb?this.Mja.vqa(Object.assign(new Vs(!1,!0),{Rb:b})):a===ba.a.bWb?
this.Mja.vqa(Object.assign(new Vs(!1),{Rb:b})):a===ba.a.vec?this.OG.paste(Object.assign(new Rm.a(!1),{Rb:b}),null,!1):a===ba.a.idb?this.OG.paste(Object.assign(new Rm.a(!1),{Rb:b,Sy:!1}),null,!1):a===ba.a.jdb?this.OG.paste(Object.assign(new Rm.a(!1),{Rb:b,Sy:!0}),null,!1):a===ba.a.WCb?this.OG.paste(Object.assign(new Rm.a(!1),{Rb:b,kPa:!0}),null,!1):(ya.a.J(512356575,826,50,"Only Copy or Paste command are accepted."),this.tc.Cg(!1,b,5))}lba(a,b,c,f,l,x){al.bA.lba(l);l=al.bA.E4;null!=l&&l?this.sXf(a,
x):(a=new wc.a(null,Object(D.a)(this,this.gUe,"waitingForEnsureAccessOperationResult"),Object.assign(new xE,{actionId:a,context:b,behavior:c,bJ:f,ld:x})),a.xl("ClipboardPreProcess"),this.ZEg=Date.now(),a.run())}gUe(a,b){a=!0;let c=!1;const f=b.ld.toString(),l=al.bA.E4,x=al.bA.Bx;null!=l?(a=!1,l?this.sXf(b.actionId,f):c=!0):Date.now()-this.ZEg>this.la.MMf&&null!=x&&(ya.a.J(512356574,826,15,"Timeout while trying to execute SystemClipboardAccessManager.EnsureSystemClipboardAccess method."),a=!1,c=!0);
c&&this.tc.Cg(!1,f,29);return a}Qgg(a,b,c){if(!({CE:a,FFc:b}=this.mQf(c,a)).returnValue)return a;this.Mja.vqa(b);return 32}mQf(a,b){let c;c=32;const f=ba.a.Kpb===b;b=new Vs(!1,f);const l=!!this.Mja&&this.Mja.QM(b);if(1===a)return c=this.ra.vRa()?2:l?32:16,{returnValue:!1,CE:c,FFc:b};a=this.tc.oO(f?1:0,1,"HandleCutCopyToSystemClipboard");this.tc.iw(1,a);b.Rb=a;return!l||this.Xb.ARa()?(this.tc.Cg(!1,a,2),{returnValue:!1,CE:16,FFc:b}):{returnValue:!0,CE:c,FFc:b}}vOc(a,b,c){if(1===c)return this.ra.vRa()?
2:a===ba.a.idb?this.ekc(!1):a===ba.a.jdb?this.ekc(!1):a===ba.a.WCb?this.ekc(!0):32;b=this.tc.oO(2,1,"HandlePasteFromSystemClipboard");c=this.Vp.Ba;if(!c||this.Xb.Zc(c)||this.ra.L7())return this.tc.Cg(!1,b,3),16;c=null;let f=!1;a===ba.a.idb?c=!1:a===ba.a.jdb?c=!0:a===ba.a.WCb&&(f=!0);this.OG.paste(Object.assign(new Rm.a(!1),{Rb:b,Sy:c,kPa:f}),null,!1);return 32}skj(a,b,c){if(this.Xb.ARa())return 16;if(1===c)return 32;a=this.ra.mg();for(const f of a)if(f.Mf||f.mh){Qn(f);break}this.Oul(a);return 32}Oul(a){if(!a||
!a.length)this.zta=this.C_c=null;else if(!this.C_c||!this.g$h(this.C_c,a)){const b=[];for(const c of a)b.push(c);this.zta=new Me.a(0);this.zta.$(b[0].slideId,1);this.C_c=b}}g$h(a,b){if(a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}icj(a,b,c,f){let l;l=b?b.msb(110,75):this.Sb.tra(c.clientWidth,c.clientHeight);a=this.xm.bPd(a.Bb.cid,a.Bb.sid,!0,l._x,l._y,c.width,c.height,a.Qu()+1,c.src,c.alt&&c.alt.length?c.alt:"image",f);b&&(a.Iaa=b.id);return a}Umj(a,b,c,
f,l){b=this.Vp.Ba;if(!b)return ya.a.J(512356573,826,50,"Active Slide is null"),8;if(1===c)return this.Xb.Zc(b)?16:32;if(!l)return 16;this.tc.aB(5,l.Rb);if(!this.gl.lI(b,1))return this.tc.Cg(!1,l.Rb,8),this.gl.kJ(b),16;Mc.a.lxa("PastePicture",!1);f=Qx.w_b(l);if(!f||!f.src)return this.tc.Cg(!1,l.Rb,10),8;if((c=b.j2(this.ra.ae()))&&this.Xb.Zc(c))return this.tc.Cg(!1,l.Rb,3),16;const x=this.icj(b,c,f,l.Rb);f=this.Db.rd(15,void 0,()=>{this.ra.ly();this.Fa.Ad()},()=>{this.ra.selectShape(x,!0)});try{f.jc(b),
f.$c=a,f.my[Aq.a.D1b]=!0,c&&b.HT([c]),b.rB(x)}finally{f&&f.dispose()}this.tc.Cg(!0,l.Rb);return 32}uYi(){if(!this.Vp.Ba)return null;const a=this.Vp.Ba.om();for(const b of a)if(b.fCc)return b;return null}bnj(a,b,c,f,l){b=this.Vp.Ba;if(!b)return ya.a.J(512356572,826,50,"Active Slide is null"),8;if(1===c)return b&&!this.Xb.Zc(b)?32:16;if(!l)return 8;this.tc.aB(6,l.Rb);if(!this.gl.lI(b,1))return this.gl.kJ(b),this.tc.Cg(!1,l.Rb,8),16;const x=this.uYi();if(x){if(this.Xb.Zc(x))return this.tc.Cg(!1,l.Rb,
3),16;if(x.fI)return ya.a.J(512356571,826,50,"Unable to block placeholder because the shape {0} is changing ShapeIds",x.id),this.tc.Cg(!1,l.Rb,3),32}f=Wz.x9f(l);if(!(f&&f.innerHTML&&f.rows&&f.rows.length&&f.getElementsByTagName(Xe.a.Yid).length))return this.tc.Cg(!1,l.Rb,24),8;c=document.createElement("div");if(!c)return this.tc.Cg(!1,l.Rb,24),8;c.appendChild(f.cloneNode(!0));c=c.innerHTML;if(!c||0>=c.length)return this.tc.Cg(!1,l.Rb,24),8;ya.a.J(512356570,826,50,"Paste table with {0} rows, table length {1}",
f.rows.length,c.length);var F=this.E$f();f=F.x-55;F=F.y-37.5;if(x){b=this.Db.rd(15,void 0,()=>{this.ra.ly();this.ra.Ph();this.Fa.Ad()},()=>{this.ra.selectShape(x,!0)});try{b.jc(x),b.$c=a,b.my[Aq.a.E1b]=!0,x.Rb=l.Rb,x.uWa=c}finally{b&&b.dispose()}this.Xb.zw(x,a)}else c=b.bzi(f,F,b.Qu()+1,c,l.Rb),c.Rb=l.Rb,this.Gz.Z1([Object(va.a)(4,c)],Object(va.a)(123,b),a);this.tc.Cg(!0,l.Rb);return 32}Tmj(a,b,c,f,l){if(1===c)return 32;b=l?Object(va.a)(vM.a,l):null;if(!b)return ya.a.J(512356569,826,50,"Html paste context should not be null."),
8;c=this.Vp.Ba;if(!c)return ya.a.J(512356568,826,50,"Active Slide is null"),8;if(!c||this.Xb.Zc(c))return this.tc.Cg(!1,b.Rb,3),16;Mc.a.lxa("PasteHtmlAsync",!0);ya.a.J(512356567,826,50,"Paste html start");return this.xXf(b,c,a)}handlePasteHtml(a,b,c,f,l){if(1===c)return this.ra.vRa()?2:32;const x=l?Object(va.a)(vM.a,l):null;if(!x)return ya.a.J(512356566,826,50,"Html paste context should not be null"),8;b=this.Vp.Ba;if(!b)return ya.a.J(512356565,826,50,"Active Slide is null"),8;if(!b||this.Xb.Zc(b))return this.tc.Cg(!1,
x.Rb,3),16;ya.a.J(512356564,826,50,"Paste html start");Mc.a.uO(!1,!1);Mc.a.lxa("PasteHtml",!0);Mc.a.hk(ri.a.Wtk,"Image:"+x.Oba.length.toString()+",Table:"+x.Tgb.length.toString()+",Text:"+(x.TX?x.TX.length.toString():"0"));f=this.ra.ae();a=Eq.a.ofh(0<x.Oba.length?!0:!1,!1,0<x.Tgb.length?!0:!1,!1,this.la.hxa,a);if(x.okc)return ya.a.J(512356563,826,50,"Will replace text"),this.tc.aB(1,x.Rb),a=this.GHi(x,f[0],a),16!==a?this.tc.Cg(!0,x.Rb):this.tc.Cg(!1,x.Rb,15),a;ya.a.J(512356562,826,50,"Will paste html into new shapes");
if(x.ZSc){if(this.la.Kvg){const F=Mc.a.Cb;this.yb.Gb(new He.a(2,1,0,()=>{Mc.a.LE(F,()=>{this.ia.Ka(ba.a.s9c,c,x)})},90,"66"));return 64}return this.xXf(x,b,a)}return this.EHi(x,b,f,a)}GHi(a,b,c){if(this.Xb.Zc(b))return 16;if(a.TX&&0<a.TX.length){ya.a.J(512356561,826,50,String.format("ReplaceText: {0}",this.eEa.GKd([b])));if(this.Fxg(a.TX))return 16;this.Xb.zw(b,c);const f=this.Db.rd(15);try{b.Rb=a.Rb,f.jc(b),f.$c=c,b.bic=a.TX,Object(Fa.a)(1068,f)&&b.id&&(Object(va.a)(1068,f).my[Aq.a.N3g]=b.id.toString())}finally{f&&
f.dispose()}}return 32}EHi(a,b,c,f){const l=[],x=b.Qu();var F=this.E$f(),R=F.x,fa=F.y;F=0;for(var wa=0;wa<a.Tgb.length;++wa)F=this.xm.cPd(!0,b.cid,b.sid,!1,R,fa,110,75,x+1,a.Tgb[wa],a.Rb),l.push(F),F=6;R=a.Oba;fa=1===R.length?0:Eq.a.D6;for(wa=0;wa<R.length;wa++){const Xa=this.xm.bPd(b.cid,b.sid,!1,fa,fa,R[wa].width,R[wa].height,x+1,R[wa].src,R[wa].alt,a.Rb);l.push(Xa);fa+=Eq.a.D6;F=0===F?5:20}if(a.TX&&0<a.TX.length)if(ya.a.J(512356560,826,50,String.format("PasteTextIntoNewTextbox: {0}",this.eEa.GKd(c))),
!this.Fxg(a.TX))c=this.xm.dPd(b.cid,b.sid,x+1,a.TX,a.Rb),l.push(c),F=0===F?1:20;else if(!l.length)return this.tc.aB(1,a.Rb),this.tc.Cg(!1,a.Rb,7),16;this.tc.aB(F,a.Rb);if(0<l.length){if(!this.gl.lI(b,l.length))return this.gl.kJ(b),this.tc.Cg(!1,a.Rb,8),16;1===l.length&&a&&this.la.insertVideoWithPasteEnabled?(c=a.TX,this.y8.gyg(c)?(this.tc.aB(8,a.Rb),ya.a.J(512356559,826,50,String.format("[Insert Online Video]: Inserting online video by paste!")),this.Gz.Z1(l,b,f),this.y8.dql(c,Object(D.a)(this,this.tzl,
"videoInsertionFail"))):(this.Gz.Z1(l,b,f),this.Xb.zw(b,f))):(this.Gz.Z1(l,b,f),this.Xb.zw(b,f));this.tc.Cg(!0,a.Rb)}else this.tc.Cg(!1,a.Rb,9);return 32}tzl(){ya.a.J(512356557,826,50,String.format("[Insert Online Video] Failed to insert online video by paste!"))}xXf(a,b,c){this.tc.aB(5,a.Rb);if(Pa.a.Va(a.Oba))return this.tc.Cg(!1,a.Rb,10),16;if(!b)return 16;var f=Object(va.a)(253,b.oc(this.Qb.Ma));if(!f)return this.tc.Cg(!1,a.Rb,3),8;var l=Mc.a.Cb;l&&(l.actionName="SinglePicturePaste",l.Ar=!0,l.Ij=
!0,l.Wa("PreloadImageDuration",a.Cxe.toString()));l=a.Oba[0];const x=b.j2(this.ra.ae());var F=b.Qu();let R,fa;({FUd:fa,vC:R}=this.QTa.pNd(x,l.width,l.height));F=this.xm.bPd(b.cid,b.sid,!1,R.x,R.y,fa.width,fa.height,F+1,l.src,l.alt,a.Rb);Mc.a.hk("ImageSrcSize",l.src.length.toString());f=this.QTa.EJd(this.Qb.Cd,fa,R,f.BV);F.KT=f;x&&(F.Iaa=x.id);F.isResizable=!0;F.X3b=!0;F.EK=!0;F.qGa=!0;F.qca=l.src;this.Gz.Z1([F],b,c,null,x);this.tc.Cg(!0,a.Rb);return 32}Fxg(a){return 65535<a.length?(ya.a.J(512356556,
826,50,"Exceed text size limit: {0}",a.length),!0):!1}Vmj(a,b,c,f,l){b=this.Vp.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(1===c)return 32;c=Object(va.a)(Rm.a,l);if(!c)return 8;f=c.tS;if(Pa.a.Va(f))return this.tc.Cg(!1,c.Rb,11),8;this.tc.aB(2,c.Rb);this.tc.iw(2,c.Rb);l=this.Vp.Ba;if(!l||this.Xb.Zc(l))return this.tc.Cg(!1,c.Rb,3),16;Mc.a.lxa("PasteShape",!1);if(!this.gl.lI(l,f.length))return this.gl.kJ(l),this.tc.Cg(!1,c.Rb,8),16;ya.a.J(512356555,826,50,"Start Handle paste shapes");
var x=Wq.b(f,fa=>fa.shapeNode);this.Wv.q3d(x,"HandlePasteShapes");for(var F of f){if(!F||!F.shapeNode.isConnected)return ya.a.J(512356554,826,50,"Paste deleted shapes"),this.yEg.Ikc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),this.tc.Cg(!1,c.Rb,12),16;if(this.Xb.QP(F.shapeNode))return this.tc.Cg(!1,c.Rb,3),16;if(!F.shapeNode.get_shapeId())return this.tc.Cg(!1,c.Rb,12),16}F=[];for(x=0;x<f.length;x++)F.push(f[x].shapeNode);
for(var R of F)if(R.Mf||R.mh){Qn(R);break}R=Object(va.a)(123,b.KB(f[0].shapeNode.slideId));this.eEa.A3g(R,l,F,this.zta,a,c.Rb);ya.a.J(512356553,826,50,({contentType:a}=this.eEa.HKd(F)).returnValue);this.tc.aB(a,c.Rb);Mc.a.uO(!0,!0);this.tc.Cg(!0,c.Rb);return 32}Qmj(a,b,c,f,l){(a=Object(va.a)(Rm.a,l))&&this.OG.Otk(a.Rb);return 32}anj(a,b,c,f,l){if(1===c)return 32;b=Object(va.a)(Rm.a,l);if(!b)return 8;this.tc.aB(19,b.Rb);this.tc.iw(2,b.Rb);if(Pa.a.Va(b.tS))return this.tc.Cg(!1,b.Rb,11),8;Mc.a.lxa("PasteSlide",
!0);if(c=Array.isArray(b.tS)?b.tS:null){let F=0;c.forEach(R=>{R.Nd&&R.Nd.hasDeferredContent&&F++});0<F&&ya.a.J(512356552,843,50,"HandlePasteSlides total: {0}, deferredSlideCount: {1}",c.length,F)}c=[];for(var x of b.tS){f=Object(va.a)(Cv.a,x);if(!f)return this.tc.Cg(!1,b.Rb,11),8;f=f.Nd;if(!f||!f.isConnected)return ya.a.J(512356551,826,50,"Paste deleted slide"),this.yEg.Ikc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),b.Hwe&&
(this.rq.Hq=null),this.tc.Cg(!1,b.Rb,13),16;if(this.Xb.Zc(f))return this.tc.Cg(!1,b.Rb,3),16;Array.add(c,f)}x=Array.clone(this.ra.mf());x.sort((F,R)=>F.De-R.De);x=x[x.length-1];if(!x)return ya.a.J(512356550,826,50,"Paste slides with no slide selected"),this.tc.Cg(!1,b.Rb,13),8;Mc.a.hk("SlideCount",c.length.toString());x=this.Gz.m0f(c,a,x,b.Rb,!1);c=!0;for(const F of x)if(!F.VV){c=!1;break}c||this.Xb.zw(this.Yb.yf,a);Mc.a.uO(!0,!0);this.tc.Cg(!0,b.Rb);return 32}EKe(){return this.ra.ku()||this.ra.uG()}C9k(){if(this.ra.ku())return!0;
if(this.ra.uG()){const a=this.ra.ae();return 1!==a.length||!a[0].isEditable}return!1}Qjj(a,b,c,f,l,x){const F=this.tc.oO(1,0,"HandleBrowserCut");this.tc.aB(1,F);this.EKe()?(a=this.K9a(a,this.ia,b,c,f,l,x,this.tc,F),a.U3a(16)):(Mc.a.uO(!0,!0),this.tc.Cbc(F),a=this.K9a(a,this.ia,C.a.XTb,c,f,l,x,this.tc,F),a.ZPc());return a}Pjj(a,b,c,f,l,x){const F=this.tc.oO(0,0,"HandleBrowserCopy");this.tc.aB(1,F);this.EKe()?(a=this.K9a(a,this.ia,b,c,f,l,x,this.tc,F),2===f&&this.Mja.vqa(Object.assign(new Vs(!0),{Trg:!1,
Rb:F})),a.U3a(32)):(this.tc.Cbc(F),a=this.K9a(a,this.ia,C.a.mBc,c,f,l,x,this.tc,F),a.ZPc());return a}Rjj(a,b,c,f,l,x){const F=this.tc.oO(2,0,"HandleBrowserPaste"),R=this.EKe();a=this.K9a(a,this.ia,R?b:C.a.Jpa,c,f,l,x,this.tc,F);x=Object(va.a)(10,x);Mc.a.uO(!0,!1);if(this.ra.L7())return a.U3a(16),this.tc.Cg(!1,F,3),a;x&&x.Sa(be.a.zT)?2===f&&this.Lkd(x,F)?a.U3a(32):R?(2===f&&this.OG.paste(Object.assign(new Rm.a(!0),{T9d:!1}),x.getValue(be.a.zT),!1),a.U3a(32)):a.ZPc():(ya.a.J(512356549,826,50,"Invalid action data for browser paste, expect PastedHtmlContent"),
a.U3a(16),this.tc.Cg(!1,F,14));return a}Smj(a,b,c,f,l,x){Mc.a.lxa("PasteGivenText",!1);this.C9k()?(a=this.K9a(a,this.ia,b,c,f,l,x,this.tc,""),a.U3a(16)):(Mc.a.uO(!0,!0),a=this.K9a(a,this.ia,C.a.r9c,c,f,l,x,this.tc,""),a.ZPc());return a}cnj(a,b,c,f,l){if(1===c)return 32;if((b=this.ra.ae())&&0<b.length)return ya.a.J(512356548,826,50,"HandlePasteTextIntoNewShape: do not paste text into a new textbox since a shape is selected. {0}",this.eEa.GKd(b)),16;ya.a.J(512356547,826,50,"HandlePasteTextIntoNewShape: a. Paste text as new shape.");
if(!(l&&l.Cm&&l.Cm.innerHTML&&l.Cm.innerHTML.length))return ya.a.J(512356546,826,50,"HandlePasteTextIntoNewShape: a. User attempted to paste null content."),8;Mc.a.lxa("PasteTextIntoNewShape",!0);b=this.Vp.Ba;if(!b)return ya.a.J(512356545,826,50,"insert shape with no slide selected"),16;if(!this.gl.lI(b,1))return this.gl.kJ(b),16;l=this.xm.dPd(b.cid,b.sid,b.Qu()+1,l.Cm.innerHTML,l.Rb);this.Gz.Z1([l],b,a);return 32}E$f(){const a=this.Sb.Jv();return new ad.a(Math.floor(a.width/2),Math.floor(a.height/
2))}Rmj(a,b,c,f,l){if(1===c)return 32;a="";l&&(a=l.getAttribute(du.a.PLf).toString());this.tc.Hvb(a)||(a=this.tc.oO(2,1,"HandlePasteContentFromPandora"));b=this.ia.processAction(ba.a.jha,2);if(32!==b)return this.tc.Cg(!1,a,15),ya.a.J(512356544,826,50,"Exit from box4 failed."),b;a=Object.assign(new Rm.a(!0),{Rb:a});this.kW.BGj(l)?a.Cm=l:(Xe.a.VCc(this.ah),this.ah.contentWindow.document.body.appendChild(l));this.OG.paste(a,null,!1);ya.a.J(512356515,826,50,null);return 32}Lkd(a,b){if(a){if(this.la.B7d){const c=
a.sa(be.a.LPc,"");if(c.startsWith("data:image/"))return this.tc.aB(5,b),this.OG.Bxe(c,b)}a=a.getValue(be.a.zT);Ma.a.Va(a)||(a=this.kW.rWa(a),this.tc.Q5k(a,b))}return!1}}Object(e.a)(wM,"ClipboardActor",null,[244]);var Fq=d(1087);class xM{constructor(a,b){this.ia=a;this.oq=b;this.ub()}ub(){this.ia.pa(ba.a.oCk,de.a.frame,Object(D.a)(this,this.fnc,"updateCoauthStatus"),96)}we(){}fnc(a,b,c,f,l){if(1===c)return 32;a=this.oq.Pec;Ma.a.Va(a)&&(a="NotConnected");this.oq.v4a&&(a=String.format("{0} ~:{1}",a,
this.oq.v4a));l[Fq.a.Value]=a;l[Am.a.labelText]=a;l[Fq.a.Visible]=!0;return 32}}Object(e.a)(xM,"CoauthActor",null,[244]);var eu=d(256),bl=d(339);class yM{constructor(a,b,c,f){this.JEa=!1;a("powerpoint-editor-intl").then(()=>{ya.a.J(51519637,801,50,"Icons and strings script is loaded successfully");a("colorPickerManager").then(()=>{ya.a.J(51519639,801,50,"Color Picker Manager script is loaded successfully");this.JEa=!0}).catch(l=>{ya.a.J(51519641,801,10,"Failed to load colorpickerManager "+l.toString())})}).catch(l=>
{ya.a.J(51519643,801,10,"Failed to load powerpoint-editor-intl "+l.toString())});this.ia=b;this.Fa=c;this.Yb=f}ub(){this.ia.xa(ba.a.renderColorPicker,fc.a.application,Object(D.a)(this,this.renderColorPicker,"renderColorPicker"));this.ia.xa(ba.a.xza,fc.a.application,Object(D.a)(this,this.xza,"addRecentColor"))}we(){}renderColorPicker(a,b,c,f,l){if(1===c)return this.JEa?32:8;a=!1;b=l.currentColor;c=l.handleCommand;l.hideAlphaSlider&&(a=!0);this.cRk(b,c,a);return 32}xza(a,b,c,f,l){if(a=eu.a.parse(l.Color)){b=
this.Yb.yf;if(!b)return ya.a.J(595186576,822,10,"AddRecentColor: pagemanifestnode is null"),8;b.ke(ub.a.zCi,a.RGBColor);b.ke(ub.a.J1,JSON.stringify(bl.g(b.J1,a.RGBColor)))}else return ya.a.J(595186574,822,10,"AddRecentColor: failed to parse colorinfo, colorInfo is null"),8;return 32}cRk(a,b,c){let f="#000000",l=100;a&&(f=Eb.a.LH(a.zC),l=100*a.alpha);a=document.getElementById("colorPickerDiv");a||(a=document.createElement("div"),a.id="colorPickerDiv",document.getElementById("WACInnerFrame").appendChild(a),
this.Fa.cQc(Nc.a.sVb,Nc.a.gj,a));const x=colorPickerManager.FactoryGlobal.getColorPickerManagerInstance();if(x)if(x.addEventListener("onColorChange",fa=>{const wa={};wa.Color=fa;wa.sourceControlId="CustomColors";let Xa=8;sg.a("ColorPicker_ColorApplied",b,()=>Xa=this.ia.Ka(b,2,wa));32===Xa?ya.a.J(595186570,822,50,"RenderColorPickerDialog: Color applied successfully from color picker dialog through {0} command.",b):ya.a.J(595186568,822,50,"RenderColorPickerDialog: Color not applied successfully from color picker dialog through {0} command.",
b);this.Fa.Gj(Nc.a.sVb,!1)}),x.addEventListener("onCancel",()=>{this.Fa.Gj(Nc.a.sVb,!1)}),sg.a("ColorPicker_DialogInvocation",b,()=>{x.render("colorPickerDiv",f,l,c);return 32}),ya.a.J(595186566,822,50,"RenderColorPickerDialog: Color Picker Dialog invoked through {0} command.",b),this.Fa.Gj(Nc.a.sVb,!0),a=this.Fa.Bc(Nc.a.sVb)){a.IK=!0;var F=A.KeyInputManager.Na(w.a.Bq,0),R=A.KeyInputManager.Na(w.a.Bq,4);a.$o(F);a.$o(R);a.bindAction(F,G.a.uqa);a.bindAction(R,G.a.uqa)}else ya.a.J(595186564,822,10,"RenderColorPickerDialog: colorPickerScope is null");
else ya.a.J(595186572,822,10,"RenderColorPickerDialog: colorPickerManagerInstace is null")}}Object(e.a)(yM,"ColorPickerActor",null,[244]);var NQ=d(1006);class zM{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa=!1){this.ia=a;this.o7b=b;this.iQ=c;this.Uka=l.fmc;this.Fja=f;this.ta=x;this.Ea=F;this.ra=R;this.Fa=fa;this.l_=wa;this.s2j=Xa}ub(){this.ia.xa(ba.a.fEc,fc.a.application,Object(D.a)(this,this.zpj,"handleThumbnailPanelContextMenu"));this.ia.xa(ba.a.PNd,fc.a.application,Object(D.a)(this,this.fpj,"handleSorterViewThumbnailContextMenu"));
this.ia.xa(ba.a.hQf,fc.a.application,Object(D.a)(this,this.epj,"handleSorterViewBlankSpaceMenu"));this.ia.xa(ba.a.MNd,fc.a.application,Object(D.a)(this,this.Eoj,"handleSectionContextMenu"));this.ia.xa(ba.a.ONd,Fb.a.view,Object(D.a)(this,this.$oj,"handleSlidePanelContextMenu"));this.ia.xa(ba.a.NNd,Fb.a.view,Object(D.a)(this,this.zmj,"handleMultiSelectShapeContextMenu"));this.ia.xa(ba.a.kQf,fc.a.application,Object(D.a)(this,this.Qpj,"handleVersionHistoryThumbnailContextMenu"));this.ia.$d(ba.a.fEc,2048)}we(){this.s2j&&
n.a.Hj&&(this.Fa.Bc(I.AppFrame.nV).bindAction(A.KeyInputManager.Na(w.a.BJa,0),C.a.b$),this.Fa.Bc(I.AppFrame.jCe).bindAction(A.KeyInputManager.Na(w.a.BJa,0),C.a.b$))}zpj(a,b,c,f,l){if(1===c)return 32;if(this.ia.QV)return this.l_.show(1,-1),32;this.o7b.D5a();if(l.Fc&&Sys.UI.DomElement.containsCssClass(l.Fc,yg.a.Gza))return 16;if(this.iQ.uZ||!l.Fc)return 32;2===l.Vf||3===l.Vf?(a=l.clientPoint.y-Ve.a.B8i(this.Uka.jX)+this.Uka.jX.scrollTop,a=this.Uka.u1f(a),b=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y)):
(a=0>this.Uka.selectedIndex?2:1,b=Sys.UI.DomElement.getLocation(this.Uka.jX),b=new Sys.UI.Point(b.x+qf.a.Zpa,b.y+qf.a.Zpa));this.Fja.value.P4(qf.a.xqa,b,l.Vf,a);return 32}Qpj(a,b,c,f,l){if(1===c)return 32;if(l.Fc&&Sys.UI.DomElement.containsCssClass(l.Fc,yg.a.Gza))return 16;if(!l.Fc)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);this.Fja.value.P4(qf.a.xqa,a,l.Vf,21);return 32}epj(a,b,c,f,l){if(1===c)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);this.Fja.value.P4(qf.a.xqa,
a,l.Vf,20);return 32}fpj(a,b,c,f,l){if(1===c)return 32;if(l.Fc&&Sys.UI.DomElement.containsCssClass(l.Fc,yg.a.Gza))return 16;if(this.iQ.uZ||!l.Fc)return 32;if(2===l.Vf||3===l.Vf||1===l.Vf)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y),this.Fja.value.P4(qf.a.xqa,a,l.Vf,19);return 32}Eoj(a,b,c,f,l){if(1===c)return 32;u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&(a=l.contextMenuArgs,b=new Sys.UI.Point(a.clientPoint.x,a.clientPoint.y),l.isEmptySection?this.Fja.value.P4(qf.a.xqa,
b,a.Vf,17):this.Fja.value.P4(qf.a.xqa,b,a.Vf,18));return 32}$oj(a,b,c,f,l){if(1===c)return 32;this.o7b.D5a();if(l.Fc&&Sys.UI.DomElement.containsCssClass(l.Fc,yg.a.Gza))return 16;if(this.iQ.uZ||!l.Fc)return 32;if(2===l.Vf||3===l.Vf)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{a=ae.b(b);a=ae.e(this.ta.Ba,a.Ma);if(!a)return 16;a=Sys.UI.DomElement.getLocation(a.rC);a=new Sys.UI.Point(a.x+qf.a.Zpa,a.y+qf.a.Zpa)}this.Fja.value.P4(qf.a.xqa,a,l.Vf,4);return 32}zmj(a,b,c,f,l){if(1===c||l.Fc&&Sys.UI.DomElement.containsCssClass(l.Fc,
qf.a.$7h))return 32;this.o7b.D5a();if(l.Fc&&Sys.UI.DomElement.containsCssClass(l.Fc,yg.a.Gza))return 16;if(this.iQ.uZ||!l.Fc)return 32;b=ae.b(b);var x;if(!(b&&b.Eb&&(x=this.ra.mg())&&x.length))return 16;a=this.a8i(x);if(2===l.Vf||3===l.Vf)x=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{x=ae.c(x[0],b.Ma);if(!x||!x.ya)return 16;x=kb.a.Yh(x.ya.ya);b=kb.a.Yh(b.container);c=x.x+qf.a.Zpa<b.x?b.x:x.x+qf.a.Zpa;x=x.y+qf.a.Zpa<b.y?b.y:x.y+qf.a.Zpa;c=c>b.x+b.width?b.x+b.width:c;x=x>b.y+b.height?b.y+
b.height:x;x=new Sys.UI.Point(c,x)}1===l.Vf||4===a?this.Fja.value.P4(qf.a.xqa,x,l.Vf,a):this.Fja.value.Zal(qf.a.xqa,x,l.Vf,a);return 32}a8i(a){let b=a[0];b.get_smartArtModelId()&&(b=this.Ea.er(b));return 1<a.length?this.Ea.eAc(a)?11:10:b.uy||!b.wDa||b.Mf?5:b.get_isSVGBlipFilled()?13:b.qk||1===b.mediaType?7:b.Qf?8:b.wy?6:b.Nq?22:b.Pq?9:b.nd?14:b.Lp?15:b.A7?16:0}}Object(e.a)(zM,"ContextMenuActor",null,[244]);class AM{constructor(a,b,c,f,l,x,F){this.ia=a;this.ra=b;this.Ea=c;this.s9a=f;this.i3j=l;this.Qje=
x;this.$S=F}ub(){this.ia.pa(ba.a.fvk,fc.a.application,Object(D.a)(this,this.gvk,"pictureToolsTabViewHandler"),4);this.ia.pa(ba.a.GIi,fc.a.application,Object(D.a)(this,this.HIi,"drawingToolsTabViewHandler"),4);this.ia.pa(ba.a.oai,fc.a.application,Object(D.a)(this,this.pai,"audioPlaybackToolsTabViewHandler"),4);this.ia.pa(ba.a.lai,fc.a.application,Object(D.a)(this,this.mai,"audioFormatToolsTabViewHandler"),4);this.ia.pa(ba.a.qai,fc.a.application,Object(D.a)(this,this.rai,"audioSettingsTabViewHandler"),
4);this.ia.pa(ba.a.HCk,fc.a.application,Object(D.a)(this,this.Uij,"graphicsTabViewHandler"),100);this.ia.pa(ba.a.A8g,fc.a.application,Object(D.a)(this,this.fkl,"tableTabViewHandler"),100);this.ia.pa(ba.a.u8g,fc.a.application,Object(D.a)(this,this.kai,"audioContextualGroupHandler"),100);this.ia.pa(ba.a.Hzf,fc.a.application,Object(D.a)(this,this.AYh,"accessibleAuthoringViewHandler"),4)}we(){}gvk(){return this.HGj()?32:this.yvg(this.ra.mg())?32:8}HIi(){const a=this.ra.mg();return a&&a.length?1===a.length?
this.rtg(a)?32:16:this.H7h(a)||this.lCj(a)&&this.rtg(a)?32:this.dnb(a)||this.DIj(a)?16:32:16}pai(){return this.Qje?this.gSc()?32:this.dnb(this.ra.mg())?32:8:2}mai(){return this.$S?this.gSc()?32:this.dnb(this.ra.mg())?32:8:2}rai(){return this.$S&&this.Qje?this.gSc()?32:this.dnb(this.ra.mg())?32:8:2}Uij(){return this.i3j?this.IGj()?32:this.Ea.Xth(this.ra.mg())?32:16:2}fkl(){const a=this.ra.ae();return a&&1===a.length&&a[0].nd?32:8}kai(){return this.$S||this.Qje?this.gSc()?32:this.dnb(this.ra.mg())?
32:8:2}AYh(){return this.s9a&&this.s9a.isVisible?32:2}DIj(a){if(!a)return!1;let b=!0;for(const c of a){if(c.Lp||1===c.mediaType)return!0;c.qk||(b=!1)}return b}H7h(a){if(!a)return!1;for(const b of a)if(!b.Lp)return!1;return!0}yvg(a){if(!a)return!1;let b=!1;for(const c of a)if(c)if(c.qk&&!c.get_isSVGBlipFilled())b=!0;else if(c.Lp)return!1;return b}dnb(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1!==b.mediaType)return!1;return!0}lCj(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1===b.mediaType)return!0;
return!1}rtg(a){if(!a)return!1;for(const b of a)if(b&&(b.dsa||b.A7))return!0;return!1}HGj(){return this.S8d(this.ra.mg())&&this.yvg(this.ra.gO(this.ra.ae()))}IGj(){return this.S8d(this.ra.mg())&&this.jMj(this.ra.gO(this.ra.ae()))}gSc(){return this.S8d(this.ra.mg())&&this.dnb(this.ra.gO(this.ra.ae()))}jMj(a){if(!a)return!1;for(const b of a)if(b&&b.mh&&b.get_isSVGBlipFilled())return!0;return!1}S8d(a){if(!a)return!1;for(const b of a)if(b&&b.Mf)return!0;return!1}}Object(e.a)(AM,"ContextualTabsActor",
null,[244]);class BM{constructor(a,b,c,f){this.Aoe=null;this.ia=a;this.ta=b;this.Db=c;this.nFg=f;this.nFg.xk(Object(D.a)(this,this.A_g,"onRichApiResponseReceived"))}ub(){this.ia.pa(ba.a.LTd,Fb.a.application,Object(D.a)(this,this.dlj,"handleExecuteAddinBatchOperation"),4)}we(){}dispose(){this.nFg.Tm(Object(D.a)(this,this.A_g,"onRichApiResponseReceived"))}A_g(a,b){this.Aoe&&(a=Object(va.a)(1066,b.node))&&a.fFe&&this.Aoe(a.fFe)}dlj(a,b,c,f,l){b=this.ta.presentation;if(1===c)return b?32:8;if(!b)return ya.a.J(590995482,
802,10,"HandleExecuteAddinBatchOperation with null IPageManifestNode."),16;if(!l)return ya.a.J(590995480,802,10,"HandleExecuteAddinBatchOperation with null action data."),16;this.Aoe=l.promiseToResolve;c=this.Db.rd(15,void 0,void 0,void 0,!0);try{c.jc(b),c.$c=a,b.LFd(l.requestBody)}finally{c&&c.dispose()}return 32}}Object(e.a)(BM,"ExtensibilityActor",null,[244]);var Sx;(function(a){a[a.height=0]="height";a[a.width=1]="width";a[a.rotation=2]="rotation";a[a.leftMargin=3]="leftMargin";a[a.rightMargin=
4]="rightMargin";a[a.topMargin=5]="topMargin";a[a.bottomMargin=6]="bottomMargin"})(Sx||(Sx={}));Object(e.b)("FormatPaneProperty",Sx);class Xz{constructor(a,b){this.g0=a;this.s9=b}}Object(e.a)(Xz,"MarginShapeData",null,[]);class yE{constructor(){this.type="FormatShapeTaskPaneProps";this.onToggleAspectRatio=this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.rotation=this.width=this.height=this.numberFormatInfo=null;this.isMarginFieldEnabled=this.isAspectRatioFeatureEnabled=
this.isAspectRatioDisabled=this.isAspectRatioLocked=!1;this.emptyValueFields=this.disabled=0}}Object(e.a)(yE,"FormatShapeTaskPaneProps",null,[]);class CM{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc){this.aGa=this.gbb=this.FW=this.Uta=null;this.gKg=0;this.Ib=!1;this.OUa=null;this.BEa=this.mta=!1;this.W2j=!0;this.nb=b;this.Nb=c;this.ia=f;this.Fa=l;this.Lg=F;this.od=R;this.Qc=fa;this.Qb=wa;this.LDa=Xa;this.Yb=lb;this.Lg.WJ(Object(D.a)(this,this.Uua,"onChangeRenderFormatShapePane"));this.Lg.Aza(Object(D.a)(this,
this.Uua,"onChangeRenderFormatShapePane"));this.Qc.QMa(Object(D.a)(this,this.Uua,"onChangeRenderFormatShapePane"));this.od.Dza(Object(D.a)(this,this.Uua,"onChangeRenderFormatShapePane"));this.Nb.vM(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"));this.bIg=kc;this.cYc=lc;this.Ea=Lb;this.e_=Ec;this.pp=Jc;ee.a("FixHeightAndWidthButtonValues")&&this.pp&&this.pp.gGd(Object(D.a)(this,this.Uua,"onChangeRenderFormatShapePane"))}dispose(){this.Lg.z4(Object(D.a)(this,this.Uua,"onChangeRenderFormatShapePane"));
this.Lg.YWa(Object(D.a)(this,this.Uua,"onChangeRenderFormatShapePane"));this.Qc.qeb(Object(D.a)(this,this.Uua,"onChangeRenderFormatShapePane"));this.od.seb(Object(D.a)(this,this.Uua,"onChangeRenderFormatShapePane"));this.Nb.rX(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"));ee.a("FixHeightAndWidthButtonValues")&&this.pp.xcd(Object(D.a)(this,this.Uua,"onChangeRenderFormatShapePane"))}ub(){this.ia.pa(ba.a.rLe,fc.a.application,Object(D.a)(this,this.rLe,"showHideFormatShapePane"),4);this.ia.pa(ba.a.DHe,
fc.a.application,Object(D.a)(this,this.DHe,"setAbsoluteHeight"),4);this.ia.pa(ba.a.TMe,fc.a.application,Object(D.a)(this,this.TMe,"spinAbsoluteHeight"),4);this.ia.pa(ba.a.RDb,fc.a.application,Object(D.a)(this,this.RDb,"queryAbsoluteHeight"),100);this.ia.pa(ba.a.EHe,fc.a.application,Object(D.a)(this,this.EHe,"setAbsoluteWidth"),4);this.ia.pa(ba.a.UMe,fc.a.application,Object(D.a)(this,this.UMe,"spinAbsoluteWidth"),4);this.ia.pa(ba.a.SDb,fc.a.application,Object(D.a)(this,this.SDb,"queryAbsoluteWidth"),
100);this.ia.pa(ba.a.kad,fc.a.application,Object(D.a)(this,this.kad,"queryFormatShapePane"),96)}we(){}Uua(){this.Ib&&this.Kl(!0)}$v(a){1===a.mode&&this.Ib&&(this.Ib=!1,this.Ds(),this.Fa.Gj(Nc.a.hZ,this.Ib))}qGj(a){return this.Yb.isEditingAllowed&&this.W2j&&!this.HKe(a)}kad(a,b,c,f,l){(a=Object(va.a)(Ph.a,l))&&a.Kf(this.Ib);return 32}rLe(a,b,c){b=this.nb.mg();return 1===c?b.length&&this.qGj(b)?32:8:sg.b("FormatShapePaneActor::ShowHideFormatShapePane PaneOpen:",this.Ib.toString(),a,()=>{(this.Ib=!this.Ib)?
this.Kl():this.Ds();return 32})}DHe(a,b,c,f,l){b=this.nb.mg();return 1===c?this.foh(b)?8:32:sg.a("FormatShapePaneActor::SetAbsoluteHeight",a,()=>{if(!l)return ya.a.J(512500608,822,10,"FormatShapePaneActor::SetAbsoluteHeight actionData == null"),8;const x=l.Number;void 0===x||null===x||isNaN(x)||this.ava(x,0);return 32})}TMe(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.ava(0,0),this.W2a());return 32}RDb(a,b,c,f,l){if(!l)return ya.a.J(512500579,822,10,"FormatShapePaneActor::QueryAbsoluteHeight actionData is null"),
8;if(a=l.queryResult)b=this.IB(),a.Fea=b.height.toFixed(2).toString()+'"',1===(b.emptyValueFields&1)&&(a.Fea="");return 32}EHe(a,b,c,f,l){b=this.nb.mg();return 1===c?this.foh(b)?8:32:sg.a("FormatShapePaneActor::SetAbsoluteWidth",a,()=>{if(!l)return ya.a.J(512500578,822,10,"FormatShapePaneActor::SetAbsoluteWidth actionData == null"),8;const x=l.Number;void 0===x||null===x||isNaN(x)||this.ava(x,1);return 32})}UMe(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.ava(0,1),this.W2a());return 32}SDb(a,b,c,
f,l){if(!l)return ya.a.J(512500577,822,10,"FormatShapePaneActor::QueryAbsoluteWidth actionData is null"),8;if(a=l.queryResult)b=this.IB(),a.Fea=b.width.toFixed(2).toString()+'"',2===(b.emptyValueFields&2)&&(a.Fea="");return 32}Kl(a=!1){const b=this.IB(),c=Object.assign(new au.a,{title:ResourceStrings.l_FormatOptions,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Ib=!1},isModernPane:!0});yj.UISurfaces.Cs().then(f=>{a?f.updateTaskPane(Nc.a.hZ,c):f.showTaskPane(Nc.a.hZ,
c);return null})}Ds(){yj.UISurfaces.Cs().then(a=>{a.hideTaskPane(Nc.a.hZ,2);return null})}IB(){const a=this.nb.mg();var b=[];for(var c of a)c.Mf?b=Array.isArray(b.concat.apply(b,this.Ea.py(c)))?b.concat.apply(b,this.Ea.py(c)):null:b.push(c);if(!(c=this.Jk(a[0]))||this.HKe(a))return this.BEa=!0,this.Ekh(0,0,0,0,0,0,0,127,127);var f=this.getBounds(a[0]),l=c.yd;c=this.dZd(f);c=this.jEc(c,1,l);f=this.X1d(f);f=this.jEc(f,0,l);this.BEa=0===c||0===f?!0:!1;l=Math.round(a[0].get_shapeRotation());b=this.Jk(b[0]);
let x=0,F=0,R=0,fa=0;b&&(x=b.hRa[0],F=b.hRa[1],R=b.hRa[2],fa=b.hRa[3]);c=this.Ekh(c,f,l,x,F,R,fa,this.G1i(a),0);this.Kvl(a,c);return c}G1i(a){let b=[];for(var c of a)c.Mf?b=Array.isArray(b.concat.apply(b,this.Ea.py(c)))?b.concat.apply(b,this.Ea.py(c)):null:b.push(c);c=0;for(let f=0;f<a.length;f++)this.AUb(a[f])||(c|=4),this.e_&&!this.zUb(a[f])&&(c|=1,c|=2);for(a=0;a<b.length;a++)if(!b[a].Fvb){c|=120;break}return c}AUb(a){return!!a&&a.EK&&!a.fI}zUb(a){return!!a&&a.isResizable&&!a.fI}foh(a){if(0>=a.length)return!0;
let b=!1;if(this.e_){b=!0;for(let c=0;c<a.length;c++)if(a[c]&&this.zUb(a[c])){b=!1;break}}return b||this.HKe(a)}HKe(a){if(!a.length)return!0;let b=!1;for(let c=0;c<a.length;c++)if(a[c]&&a[c].nd){b=!0;break}return b}Kvl(a,b){if(this.cYc){var c=[];for(var f of a)f.Mf?c=Array.isArray(c.concat.apply(c,this.Ea.py(f)))?c.concat.apply(c,this.Ea.py(f)):null:c.push(f);var l=f=!0,x=!0,F=!0;if(2<=c.length)for(var R=1;R<c.length;R++){var fa=c[R];if(!fa)continue;if(!this.getBounds(fa))continue;fa=this.Jk(fa);
let wa=0,Xa=0,lb=0,Lb=0;fa&&(wa=fa.hRa[0],Xa=fa.hRa[1],lb=fa.hRa[2],Lb=fa.hRa[3]);f&&b.leftMargin!==wa&&(b.leftMargin=0,b.emptyValueFields|=8,f=!1);l&&b.rightMargin!==Xa&&(b.rightMargin=0,b.emptyValueFields|=16,l=!1);x&&b.topMargin!==lb&&(b.topMargin=0,b.emptyValueFields|=32,x=!1);F&&b.bottomMargin!==Lb&&(b.bottomMargin=0,b.emptyValueFields|=64,F=!1);if(!(f||l||x||F))break}}if(!(2>a.length))for(l=f=c=!0,x=1;x<a.length;x++)if(F=a[x])if(R=this.getBounds(F))if(fa=this.Jk(F).yd,F=this.dZd(R),F=this.jEc(F,
1,fa),R=this.X1d(R),R=this.jEc(R,0,fa),fa=a[x].get_shapeRotation(),c&&b.height.toFixed(2).localeCompare(F.toFixed(2))&&(b.height=0,b.emptyValueFields|=1,c=!1),f&&b.width.toFixed(2).localeCompare(R.toFixed(2))&&(b.width=0,b.emptyValueFields|=2,f=!1),l&&b.rotation!==fa&&(b.rotation=0,b.emptyValueFields|=4,l=!1),!(c||f||l))break}h2k(a,b,c,f,l,x,F,R,fa){const wa=new yE,Xa=Object(va.a)(Object,Ag.e().numberFormatInfo);wa.numberFormatInfo=Xa;wa.height=a;wa.width=b;wa.rotation=c;wa.leftMargin=f;wa.rightMargin=
l;wa.topMargin=x;wa.bottomMargin=F;wa.disabled=R;wa.onChange=Object(D.a)(this,this.ava,"onPropertyChange");wa.emptyValueFields=fa;wa.isAspectRatioLocked=this.mta;wa.isAspectRatioDisabled=this.BEa;wa.onToggleAspectRatio=Object(D.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");wa.isAspectRatioFeatureEnabled=this.bIg;wa.isMarginFieldEnabled=this.cYc;return wa}i2k(a,b,c,f,l){const x=new yE,F=Object(va.a)(Object,Ag.e().numberFormatInfo);x.numberFormatInfo=F;x.height=a;x.width=b;x.rotation=c;x.disabled=
f;x.onChange=Object(D.a)(this,this.ava,"onPropertyChange");x.emptyValueFields=l;x.isAspectRatioLocked=this.mta;x.isAspectRatioDisabled=this.BEa;x.onToggleAspectRatio=Object(D.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");x.isAspectRatioFeatureEnabled=this.bIg;return x}Ekh(a,b,c,f,l,x,F,R,fa){return this.cYc?this.h2k(a,b,c,f,l,x,F,R,fa):this.i2k(a,b,c,R,fa)}ava(a,b){const c=this.nb.mg();this.gKg!==b&&(this.W2a(),this.gKg=b);switch(b){case 0:case 1:this.resize(a,c,b);break;case 3:case 4:case 5:case 6:this.Oji(a,
c,b);break;case 2:this.rotate(a,c)}}onToggleAspectRatio(a){this.mta=a}oKf(a,b,c,f){a/=b;return c?Math.round(c/a):Math.round(f*a)}Oji(a,b,c){let f=[];for(const x of b)x.Mf?f=Array.isArray(f.concat.apply(f,this.Ea.py(x)))?f.concat.apply(f,this.Ea.py(x)):null:f.push(x);this.OUa=b=f;let l=!0;this.FW||(this.FW=[],l=!1);sg.b("FormatShapePaneActor::ChangeMargin Property:",Sx[c]+"; AspectRatioLocked: "+(!this.BEa&&this.mta),ba.a.Mjc,()=>{for(let x=0;x<b.length;x++){const F=b[x],R=this.Jk(F);if(!R)continue;
l||this.FW.push(new Xz(F,new Pd.a));this.FW.length===x&&this.FW.push(new Xz(F,new Pd.a));this.FW[x]||(this.FW[x]=new Xz(F,new Pd.a));const fa=this.FW[x];fa.s9.left=F.Wga;fa.s9.right=F.Xga;fa.s9.top=F.Yga;fa.s9.bottom=F.Vga;3===c&&(this.FW[x].s9.left=a);4===c&&(this.FW[x].s9.right=a);5===c&&(this.FW[x].s9.top=a);6===c&&(this.FW[x].s9.bottom=a);R.pxa(this.FW[x].s9)}return 32});this.pnc()}resize(a,b,c){this.OUa=b;let f=!0;const l=[],x=[];this.Uta||(this.Uta=[],f=!1);0===a&&(this.BEa=!0);sg.b("FormatShapePaneActor::Resize Property:",
Sx[c]+"; AspectRatioLocked: "+(!this.BEa&&this.mta),ba.a.Deb,()=>{for(let wa=0;wa<b.length;wa++){var F=b[wa];const Xa=this.Jk(F);if(this.e_){if(!Xa||!this.zUb(F))continue}else if(!Xa)continue;var R=this.getBounds(F),fa=this.dZd(R);R=this.X1d(R);f||(Array.add(this.Uta,new uz(F,new Pd.a)),Xa.DK=!0,Xa.eD(!1));Array.add(l,Xa.UVa);Array.add(x,new Pd.a);Xa.shapeNode.Mf&&Xa.shapeNode.isEditable&&Xa.zk&&(Xa.zk.visible=!0);F=Xa.yd;if(0===c){F=this.yQf(a,1,F);F=Math.round(F-fa);x[wa].bottom=F;let lb;(lb=this.Uta[wa].V_).bottom=
lb.bottom+F;if(!this.BEa&&this.mta){fa=this.oKf(R,fa,0,F);x[wa].right=fa;let Lb;(Lb=this.Uta[wa].V_).right=Lb.right+fa}}else{F=this.yQf(a,0,F);F=Math.round(F-R);x[wa].right=F;let lb;(lb=this.Uta[wa].V_).right=lb.right+F;if(!this.BEa&&this.mta){fa=this.oKf(R,fa,F,0);x[wa].bottom=fa;let Lb;(Lb=this.Uta[wa].V_).bottom=Lb.bottom+fa}}Xa.setOffsets(Pd.a.add(l[wa],x[wa]),!0);Xa.shapeNode.Mf&&Xa.shapeNode.isEditable&&(Xa.U3d(),Xa.nPc())}return 32});this.pnc()}rotate(a,b){this.OUa=b;let c=!0;a=Math.round(a);
this.gbb||(this.gbb=[],c=!1);sg.a("FormatShapePaneActor::Rotate",ba.a.Dic,()=>{for(let f=0;f<b.length;f++){const l=b[f],x=this.Jk(l);if(!x)continue;const F=x.Arb().Uf(),R=a%wp.Odc;c||(x.eD(!1),Array.add(this.gbb,new wp(l,R)));this.gbb[f].RUf=R;x.setRotation(R,F)}return 32});this.pnc()}Jk(a){return a?Object(va.a)(vz.a,a.Ag(this.Qb.Ma)):(ya.a.J(512500576,822,10,"shapeNode == null"),null)}getBounds(a){var b=this.Jk(a);if(!b)return ya.a.J(512500575,822,10,"shapeViewElement == null"),null;b=b.$Zb();a.CZ&&
(b=this.qXd(b));return b}yQf(a,b,c){return this.LDa.ML(this.Qb.Cd.sZ(a,b),c)}jEc(a,b,c){a=this.Qb.Cd.Ef(this.LDa.KQ(a,c),b);return je.a.mv(a)}dZd(a){a=ad.a.Rl(a.Zj(Kd.a.qu),a.Zj(Kd.a.fH));return 1>=a?0:a}X1d(a){a=ad.a.Rl(a.Zj(Kd.a.qu),a.Zj(Kd.a.ND));return 1>=a?0:a}W2a(){this.cYc&&this.FW&&(this.ia.Ka(ba.a.Mjc,2,this.FW),this.FW=null);if(this.Uta){for(var a=0;a<this.OUa.length;a++){var b=this.Jk(this.OUa[a]);b&&!b.ll&&(b.shapeNode.Mf&&b.shapeNode.isEditable||(b.DK=!1),b.rz(!1))}this.ia.Ka(ba.a.Deb,
2,this.Uta);this.Uta=null}if(this.gbb){for(a=0;a<this.OUa.length;a++)(b=this.Jk(this.OUa[a]))&&!b.ll&&(b.rz(!1),this.ia.Ka(ba.a.Dic,2,this.gbb[a]));this.gbb=null}this.aGa=this.OUa=null}pnc(){this.aGa&&Mc.a.Pob(this.aGa);this.aGa=Mc.a.Z9(Object(D.a)(this,this.W2a,"applyPendingChangesToServerIfRequired"),1E3)}qXd(a){const b=ad.a.v6a(a.ga(0),a.ga(3));a=ad.a.v6a(a.ga(1),a.ga(2));return new td.a(new ad.a(b.x,b.y),new ad.a(a.x,b.y),new ad.a(a.x,a.y),new ad.a(b.x,a.y))}}Object(e.a)(CM,"FormatShapePaneActor",
null,[106,244]);class Yz{constructor(a,b,c,f,l,x,F){this.type="FormatTableTaskPaneProps";this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.tableWidth=this.tableHeight=this.cellWidth=this.cellHeight=this.numberFormatInfo=null;this.isAspectRatioLocked=!1;this.onToggleAspectRatio=null;this.disabled=!1;this.emptyValueFields=0;const R=Object(va.a)(Object,Ag.e().numberFormatInfo);if(!R)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=R;this.cellHeight=
b;this.cellWidth=c;this.tableHeight=f;this.tableWidth=l;this.leftMargin=a.leftMargin;this.rightMargin=a.rightMargin;this.topMargin=a.topMargin;this.bottomMargin=a.bottomMargin;this.disabled=x;this.emptyValueFields=F}}Object(e.a)(Yz,"FormatTableTaskPaneProps",null,[]);class DM{constructor(){this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=0;this.j6g=this.m6g=this.l6g=this.k6g=-1}}Object(e.a)(DM,"Margins",null,[]);class EM{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){this.mta=
this.Ib=!1;this.cgi=320;this.MUa=!1;if(!a)throw Error.argumentNull("pptSelectionManager");if(!b)throw Error.argumentNull("appFrame");if(!c)throw Error.argumentNull("actionManager");if(!f)throw Error.argumentNull("focusManager");if(!l)throw Error.argumentNull("formatTablePane");if(!x)throw Error.argumentNull("graphOperationEventHandler");if(!F)throw Error.argumentNull("viewElementEventHandlers");if(!R)throw Error.argumentNull("viewEventSource");if(!fa)throw Error.argumentNull("pageView");if(!wa)throw Error.argumentNull("unitConversion");
if(!Xa)throw Error.argumentNull("workspace");if(!Lb)throw Error.argumentNull("tableReader");if(!kc)throw Error.argumentNull("rowReader");if(!lc)throw Error.argumentNull("columnReader");if(!lb)throw Error.argumentNull("dynamicScriptLoader");lb.loadScript("powerpoint-editor-intl").then(()=>{this.MUa=!0}).catch(Ec=>{ya.a.J(512500574,801,10,"Failed to load powerpoint-editor-intl "+Ec.toString())});this.nb=a;this.Nb=b;this.ia=c;this.Fa=f;this.Lg=x;this.od=F;this.Qc=R;this.Lg.WJ(Object(D.a)(this,this.ZVa,
"onChangeRenderFormatTablePane"));this.Lg.Aza(Object(D.a)(this,this.ZVa,"onChangeRenderFormatTablePane"));this.Qc.QMa(Object(D.a)(this,this.ZVa,"onChangeRenderFormatTablePane"));this.od.Dza(Object(D.a)(this,this.ZVa,"onChangeRenderFormatTablePane"));this.Nb.vM(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"));this.KI=lc;this.hVa=kc;this.sc=Lb}dispose(){this.Lg.z4(Object(D.a)(this,this.ZVa,"onChangeRenderFormatTablePane"));this.Lg.YWa(Object(D.a)(this,this.ZVa,"onChangeRenderFormatTablePane"));this.Qc.qeb(Object(D.a)(this,
this.ZVa,"onChangeRenderFormatTablePane"));this.od.seb(Object(D.a)(this,this.ZVa,"onChangeRenderFormatTablePane"));this.Nb.rX(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"))}ub(){this.ia.pa(ba.a.xLe,fc.a.application,Object(D.a)(this,this.xLe,"showHideReactFormatTablePane"),4);this.ia.pa(ba.a.Gad,fc.a.application,Object(D.a)(this,this.Gad,"queryReactFormatTablePane"),96)}we(){}ZVa(){this.Ib&&this.Kl(!0)}$v(a){1===a.mode&&this.Ib&&(this.Ib=!1,this.Ds(),this.Fa.Gj(Nc.a.PIa,this.Ib))}Gad(a,b,c,f,
l){(a=Object(va.a)(Ph.a,l))&&a.Kf(this.Ib);return 32}xLe(a,b,c){if(!this.MUa)return 8;b=this.nb.mg();if(1===c)return b.length?32:8;this.Ib=!this.Ib;return sg.b("FormatTablePaneActor::ShowHideFormatTablePane PaneOpen: ",this.Ib.toString(),a,()=>{this.Ib?this.Kl():this.Ds();return 32})}Kl(a=!1){const b=this.IB(),c=Object.assign(new au.a,{title:ResourceStrings.L_FormatTable,hideHeader:!1,width:this.cgi,location:2,contentProps:b,onOpen:()=>{ya.a.J(512500573,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now visible")},
onClose:()=>{this.Ib=!1;ya.a.J(512500572,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now hidden")},isModernPane:!0});yj.UISurfaces.Cs().then(f=>{a?f.updateTaskPane(Nc.a.PIa,c):f.showTaskPane(Nc.a.PIa,c);return null}).catch(f=>{ya.a.J(512500571,822,10,"FormatTablePaneActor::ShowPane, Failed to show format table pane. Exception: "+f.toString())})}Ds(){yj.UISurfaces.Cs().then(a=>{a.hideTaskPane(Nc.a.PIa,2);return null}).catch(a=>{ya.a.J(512500570,822,10,"FormatTablePaneActor::HidePane, Failed to hide format table pane. Exception: "+
a.toString())})}IB(){var a=this.nb.Po();const b=new DM;if(!a)return a=new Yz(b,0,0,0,0,!0,255),this.iIe(a);let c=0,f=0;({cellHeight:c,cellWidth:f}=this.s$i(a,c,f));const l=je.a.mv(this.sc.q1d(a)),x=je.a.mv(this.sc.s1d(a));let F=this.nb.ny();F&&F.length||(F=this.sc.UE(a));if(!F||!F.length)return a=new Yz(b,c,f,l,x,!0,255),this.iIe(a);this.r$i(F,b);a=new Yz(b,c,f,l,x,!1,0);this.iIe(a);this.Jvl(a);return a}iIe(a){a.onChange=Object(D.a)(this,this.ava,"onPropertyChange");a.isAspectRatioLocked=this.mta;
a.onToggleAspectRatio=Object(D.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");return a}s$i(a,b,c){let f=this.nb.aNc(),l=this.nb.Esb();f&&f.length||(f=this.sc.lia(a));l&&l.length||(l=this.Lsb(a));f.length&&(b=je.a.mv(this.hVa.Q7f(f)));l.length&&(c=je.a.mv(this.KI.S7f(a,l)));return{cellHeight:b,cellWidth:c}}r$i(a,b){let c=!0,f=!0,l=!0,x=!0;for(const F of a)F&&!F.isGhostCell&&({gRc:c,rCc:b.leftMargin,N$c:b.k6g}=this.kld(c,b.leftMargin,F.marginLeft,b.k6g),{gRc:f,rCc:b.rightMargin,N$c:b.l6g}=
this.kld(f,b.rightMargin,F.marginRight,b.l6g),{gRc:l,rCc:b.topMargin,N$c:b.m6g}=this.kld(l,b.topMargin,F.marginTop,b.m6g),{gRc:x,rCc:b.bottomMargin,N$c:b.j6g}=this.kld(x,b.bottomMargin,F.marginBottom,b.j6g))}kld(a,b,c,f){a&&(b=je.a.mv(c),0<=f&&f!==b&&(b=-1,a=!1),f=b);return{gRc:a,rCc:b,N$c:f}}Jvl(a){0>a.cellHeight&&(a.emptyValueFields|=1);0>a.cellWidth&&(a.emptyValueFields|=2);0>a.leftMargin&&(a.emptyValueFields|=16);0>a.rightMargin&&(a.emptyValueFields|=32);0>a.topMargin&&(a.emptyValueFields|=64);
0>a.bottomMargin&&(a.emptyValueFields|=128)}ava(a,b){const c={};c.Number=a;switch(b){case 0:this.ia.Ka(ba.a.Lfb,2,c);break;case 1:this.ia.Ka(ba.a.$Xa,2,c);break;case 2:this.ia.Ka(ba.a.jwa,2,c);break;case 3:this.ia.Ka(ba.a.aYa,2,c);break;case 4:this.ia.Ka(ba.a.xlc,2,c);break;case 5:this.ia.Ka(ba.a.ylc,2,c);break;case 6:this.ia.Ka(ba.a.zlc,2,c);break;case 7:this.ia.Ka(ba.a.wlc,2,c)}}onToggleAspectRatio(a){this.mta=a;this.ia.Ka(ba.a.Afd,2,null)}Lsb(a){let b=null;a&&14===a.type&&(b=this.sc.o1d(a.firstRow));
return b}}Object(e.a)(EM,"FormatTablePaneActor",null,[106,244]);class Zz{constructor(a,b,c){this.ra=a;this.Qb=b;this.Ea=c}process(a,b,c,f){2===c&&32===f&&b.contextId===Fb.a.view&&Array.contains(Zz.GWk,a)&&(a=this.ra.ae(),0<a.length&&0<this.Ea.textLength(a[0])&&this.qki(a[0]))}qki(a){if(!a.w9){var b=nd.SelectionFactory.Xk(a);b=fb.SelectionEditor.fZb(b);var c=fb.SelectionEditor.eZb(b,!1);b=nd.SelectionFactory.PM(b,c.Ua,!1);if((c=this.ra.Oa)&&c.kb&&c.kb.contains(b)&&2===a.Ty){var f=Object(va.a)(124,
a.oc(this.Qb.Ma));if(f){b=a.Ty;c=a.i0;var l=a.j0;a.Ty=1;a.i0=1;a.j0=0;f=f.UZf();f.EHf();f.LGf();f.txa();f.h1f()&&(a.Ty=b,a.i0=c,a.j0=l);f.detach();f.WRe()}}}}}Zz.GWk=[C.a.yr,C.a.$H,C.a.lJ];Object(e.a)(Zz,"FormattingViewOperationFinishedStageProcessor",null,[293]);var OQ=d(607);class FM extends Sys.EventArgs{constructor(a){super();this.section=a}}Object(e.a)(FM,"SectionNodeChangedArgs",Sys.EventArgs,[]);class GM{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.gQ=null;this.Ms=a;this.Db=b;this.Yb=c;
this.ra=f;this.Fa=l;this.la=R;this.Sp=this.la.yz;this.Ie=F;this.LEa=this.la.c$d;this.Sb=x;this.T3j=this.la.d5b;this.Xb=fa;this.Xv=wa;this.ta=Xa;this.Qb=lb;Lb.execute(kc=>{this.gQ=kc})}hNi(a,b,c){if(a&&a.length){for(var f of a)if(!f||oe.a.xz(f.Bb))return;f=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Qb&&1===this.Qb.Nu;var l=this.Db.rd(15,void 0,()=>{this.Fa.Bf(xi.a.$C);this.ra.Ph()});try{l.jc(this.Ms),this.LEa?this.Ms.Ase(a,b,c,f):this.Ms.zse(a[0],b,c,f)}finally{l&&l.dispose()}}}q0f(a,
b){var c=this.Sb.An;if(c&&c.zp)if(b&&!a||!b&&a===c.zp.length-1)ya.a.J(50856009,822,50,"ExecuteMoveSectionGraphTransaction: User has attempted to move a section out of range.");else{var f=c.zp,l=Date.now(),x=this.Db.rd(15,void 0,()=>{},()=>{});try{x.jc(this.Ms);const F=f[a],R=b?f[a-1]:f[a+1];c.setValue(ub.a.Qdk,F);c.setValue(ub.a.vdk,R);if(F&&R){let fa=-1,wa=-1;for(let Xa=0;Xa<f.length&&!(F===f[Xa]&&(fa=Xa),R===f[Xa]&&(wa=Xa),0<=fa&&0<=wa);Xa++);Array.removeAt(f,fa);Array.insert(f,wa,F);c.anchor?c.anchor.Igb(f,
34,!1):ya.a.J(50856011,822,10,"ExecuteMoveSectionGraphTransaction: Presentation node should have valid anchor.")}}finally{x&&x.dispose()}this.ta.oA=b?0<=a-1?a-1:0:a+1;c=Date.now();ya.a.J(50954449,822,50,"ExecuteMoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, isMoveUp: {4}",a,l,c,c-l,b);this.Xv?this.Xv.YBe():ya.a.J(51172825,822,10,"ExecuteMoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else ya.a.J(50856007,
808,10,"ExecuteMoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}RMi(a,b){if(a){var c=this.Sb.An;if(c){var f=c.zp;f&&f.length||ya.a.J(50676770,822,50,"ExecuteAddSectionGraphTransaction: User has added first section.");c=Date.now();var l=this.Db.rd(15,void 0,()=>{},()=>{});try{l.jc(this.Ms);l.$c=b;const x=f&&f.length?this.Ie.t2(a.Bb):0;this.Ms.Jmb(a,x)}finally{l&&l.dispose()}this.Xb.zw(this.Ms,b);b=Date.now();ya.a.J(50954454,822,50,"ExecuteAddSectionGraphTransaction: selectedSlideIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}",
a.slideIndex,c,b,b-c);this.Xv?this.Xv.YBe():ya.a.J(51172831,822,10,"ExecuteAddSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else ya.a.J(50676768,808,10,"ExecuteAddSectionGraphTransaction: pageManifest is null.")}else ya.a.J(50676766,808,10,"ExecuteAddSectionGraphTransaction: selectedSlideNode is null.")}tNi(a){var b=this.Sb.An;if(b&&b.zp){var c=b.zp;if(!a||a.sectionIndex>=c.length)ya.a.J(50647325,808,10,"ExecuteUpdateSectionGraphTransaction: invalid .");else{var f=
b.Scg(a.sectionIndex);c=null;f&&(c=Object(va.a)(OQ.a,b.lbj(f.yF)));b=Date.now();f=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()},()=>{});try{f.jc(c),c.title=a.kxl}finally{f&&f.dispose()}c=Date.now();ya.a.J(50954458,822,50,"ExecuteUpdateSectionGraphTransaction: updateSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, ",a.sectionIndex,b,c,c-b)}}else ya.a.J(50647323,808,10,"ExecuteUpdateSectionGraphTransaction: pageManifest or SectionNodes are null.")}mNi(a,
b){const c=this.Sb.An;if(c&&c.zp){var f=c.zp,l=this.ta.vaa,x=Date.now(),F=f.length,R=this.Db.rd(15,void 0,()=>{},()=>{});try{R.jc(this.Ms);R.$c=b;if(a){const fa=this.Sb.Dsb(a-1);let wa=l.$z;if(fa&&wa){const Xa=fa.$z?fa.$z:[];for(let lb=0;lb<wa.length;lb++)Array.insert(Xa,Xa.length,wa[lb]);wa=[];fa.$z=Xa}}Array.removeAt(f,a);c.mVf(l)}finally{R&&R.dispose()}this.ta.oA=0<=a-1?a-1:0;this.Xb.zw(this.Ms,b);b=Date.now();ya.a.J(50954461,822,50,"ExecuteRemoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, initialSectionArrayLength: {4}, finialSectionArrayLength: {5}",
a,x,b,b-x,F,f.length);this.Xv?this.Xv.MFk(new FM(l)):ya.a.J(51172866,822,10,"ExecuteRemoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else ya.a.J(50689950,808,10,"ExecuteRemoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}lIc(a,b,c,f){if(!b||!this.T3j&&!c)return null;let l=null;const x=this.Db.rd(15,void 0,()=>{ee.a("FixDocumentFocusIssue")||this.Fa.Ad();this.ra.Ph()},()=>{1!==this.Qb.Nu&&(ee.a("FixDocumentFocusIssue")?this.Fa.Bf(this.Fa.ye.name):
this.Fa.Bf(xi.a.$C))});try{const F=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Qb&&1===this.Qb.Nu;let R;R=ee.a("SlideSorterInsertionAfterFirstSlide")?!!this.Qb&&1===this.Qb.Nu&&-1===this.Yb.bDb:!!this.Qb&&1===this.Qb.Nu&&!this.Yb.bDb;const fa=this.ta.vaa;if(F&&fa&&(!fa.LL||!fa.LL.length)||R)R&&(this.Yb.bDb=-1),a=null;x.jc(this.Yb.yf);x.$c=f;l=Object(va.a)(123,this.Ms.kzc(a,fa,b,c,F));this.Sp&&this.ra.DX(l);this.Yb.Ba=l;this.Yb.yf.removeProperty(ub.a.yxe)}finally{x&&x.dispose()}return l}gNi(a,
b,c,f,l){if(5!==f)throw Error.invalidOperation();const x=Object(va.a)(123,this.Ms.qPd(a,b,c));if(!x)return ya.a.J(51676491,822,10,"CreateSlideNodeForInsertion returned null"),null;b=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Qb&&1===this.Qb.Nu;c=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()},()=>{this.Sp&&this.ra.DX(x);this.Fa.Bf(xi.a.$C)});try{c.jc(this.Yb.yf),c.$c=l,this.Ms.Ptb(x,a,null,b),this.Yb.Ba=x}finally{c&&c.dispose()}return x}bNi(a,b){var c=null;if(!a)throw Error.argumentNull("srcSlideNode");
c||(c=a);const f=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Qb&&1===this.Qb.Nu;let l=null;const x=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()},()=>{1!==this.Qb.Nu&&this.Fa.Bf(xi.a.$C)});try{x.jc(this.Yb.yf),x.$c=b,l=Object(va.a)(123,this.Ms.bS(Object(va.a)(122,a),Object(va.a)(122,c),f,!0)),this.gQ&&this.gQ.VVf([l]),this.Sp&&this.ra.DX(l),this.Yb.Ba=l}finally{x&&x.dispose()}return l}m0f(a,b,c,f,l){if(!a||!a.length)throw Error.argumentNull("srcSlideNodes");const x=[];a=Array.clone(a);
a.sort((fa,wa)=>wa.De-fa.De);c||(c=a[0]);const F=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Qb&&1===this.Qb.Nu,R=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()},()=>{1!==this.Qb.Nu&&this.Fa.Bf(xi.a.$C)});try{R.jc(this.Yb.yf);R.$c=b;for(b=0;b<a.length;b++){if(!a[b])continue;const wa=Object(va.a)(123,this.Ms.bS(Object(va.a)(122,a[b]),Object(va.a)(122,c),F,l));Ma.a.Va(f)||(wa.Rb=f);Array.add(x,wa)}0<x.length&&this.gQ&&this.gQ.VVf(x);let fa;(fa=this.ra).DX.apply(fa,x);this.Yb.Ba=
x[x.length-1];this.Ie.Aqb=!0}finally{R&&R.dispose()}return x}Z1(a,b,c,f=null,l=null,x=!0){if(!a)throw Error.argumentNull("shapeNodes");if(!a.length)throw Error.argumentOutOfRange("shapeNodes.Length",a.length);if(!b)throw Error.argumentNull("slideNode");if(f&&a.length!==f.length)throw Error.invalidOperation();let F=null;x&&1!==this.Qb.Nu&&(F=()=>{this.ra.DXa(a,!0)});x=this.Db.rd(15,void 0,()=>{this.ra.ly();this.ra.Ph();this.Fa.Ad()},F);try{x.jc(b);x.$c=c;this.T1h(x,a);const R=new Sys.StringBuilder;
for(c=0;c<a.length;c++){const fa=f?f[c]:null;a[c]&&(b.rB(a[c],fa),a[c].id&&R.append(a[c].id.toString()+";"))}x.my[Aq.a.N3g]=R.toString();l&&b.HT([l])}finally{x&&x.dispose()}}T1h(a,b){if(1!==b.length||!b[0].nd&&Ma.a.Va(b[0].uWa))for(const c of b){if(c.z8a||c.qk)a.my[Aq.a.D1b]=!0;if(c.Lp||2===c.mediaType||1===c.mediaType)a.my[Aq.a.QOc]=!0;c.Pq&&(a.my[Aq.a.POc]=!0)}else a.my[Aq.a.E1b]=!0}c5a(a,b){if(!(1>b.length)){var c=this.Db.rd(15);try{c.jc(b[0]);const f=this.ra.gO(Array.isArray(b)?b:null);for(const l of f)a(l)}finally{c&&
c.dispose()}}}Jha(a,b){this.c5a(c=>{(c=Object(va.a)(4,c))&&a(c)},b)}}Object(e.a)(GM,"GraphTransactionHelperProxy",null,[257]);var $z=d(292),qo=d(293);class HM{constructor(a,b,c,f){this.Jic=a;this.Kic=b;this.GUc=c;this.HUc=f}USe(a,b,c,f){a<this.Jic&&(this.Jic=a);b<this.Kic&&(this.Kic=b);a+c>this.GUc&&(this.GUc=a+c);b+f>this.HUc&&(this.HUc=b+f)}}Object(e.a)(HM,"GroupShapeOffset",null,[]);class IM{constructor(a,b,c,f,l,x,F,R,fa,wa){this.ia=a;this.Db=b;this.ra=c;this.Ea=f;this.ta=l;this.xm=x;this.Qb=
F;this.Rj=R;this.xI=fa;this.la=wa}ub(){this.ia.pa(ba.a.m5g,fc.a.application,Object(D.a)(this,this.xlj,"handleGroupShapes"),4);this.ia.pa(ba.a.v5g,fc.a.application,Object(D.a)(this,this.Epj,"handleUngroupShapes"),4);this.ia.pa(ba.a.qxk,fc.a.application,Object(D.a)(this,this.wlj,"handleGroupFlyoutAnchor"),4)}we(){const a=this.xI.so.Bc(Nc.a.yg);a.bindAction(A.KeyInputManager.Na(w.a.aKb,A.KeyInputManager.Fe),ba.a.m5g);a.bindAction(A.KeyInputManager.Na(w.a.aKb,A.KeyInputManager.Fe|4),ba.a.v5g)}ZKf(a){let b=
1<a.length&&!a[0].mh&&!a[1].mh;if(b)for(const c of a)if(this.la.qia){if(c.HBb||c.al||c.nd){b=!1;break}}else if(c.al||c.nd){b=!1;break}return b}j8i(a){a=a.get_shapeRotation()%180;0<=a&&45>a?a=0:45<=a&&135>a?a=90:135<=a&&180>a&&(a=0);return a}xlj(a,b,c){const f=this.ra.ae();return this.ZKf(f)?1===c?32:sg.a("GroupOperations_GroupShapes",a,()=>{const l=[];for(var x of f)l.push(x.id);x=Object(va.a)(123,this.ta.Ba);if(!x)throw Error.argumentNull("ActiveSlide is null");const F=x.Qu(),R=new HM(x.Yp,x.Ek,
0,0);var fa=0;let wa=fa=0;for(var Xa of f)(fa=this.j8i(Xa),Xa.uy)?(fa=Xa.My,wa=Xa.Ny,R.USe(fa,wa,Xa.gba,Xa.fba)):fa?90===fa&&(fa=Xa.My+Xa.Ex/2-Xa.sD/2,wa=Xa.Ny+Xa.sD/2-Xa.Ex/2,R.USe(fa,wa,Xa.sD,Xa.Ex)):(fa=Xa.My,wa=Xa.Ny,R.USe(fa,wa,Xa.Ex,Xa.sD));const lb=this.xm.j4a(!1,x.Bb.cid,x.Bb.sid,0,10,R.Jic,R.Kic,R.GUc-R.Jic,R.HUc-R.Kic,F+1);ya.a.J(595359714,822,50,"GroupUngroupShapesActor::HandleGroupShapes : Group Action performed on {0}",f.length);this.Bzj(lb,x.Bb,R.GUc-R.Jic,R.HUc-R.Kic);x.rB(lb);Xa=this.Db.rd(15,
void 0,void 0,()=>{this.ra.selectShape(lb,!0)});try{Xa.jc(x),Xa.$c=a,1<l.length&&(x.q7=l)}finally{Xa&&Xa.dispose()}return 32}):8}nLf(a){for(const b of a)if(this.la.qia){if(b.Mf&&!b.IBb)return!0}else if(b.Mf)return!0;return!1}Epj(a,b,c){const f=this.ra.ae();return this.nLf(f)?1===c?32:sg.a("GroupOperations_UngroupShapes",a,()=>{const l=[];var x=[];for(const R of f)if(R.Mf){l.push(R.id);const fa=this.Ea.py(R);for(const wa of fa)x.push(wa);this.ra.R6(R)}for(var F of x)x=ae.c(F,this.Qb.Ma),this.ra.R6(F),
x.via(),x.uFb=!0;F=this.ta.Ba;ya.a.J(595359712,822,50,"GroupUngroupShapesActor::HandleUngroupShapes : Ungroup Action performed on {0}",f.length);x=this.Db.rd(15);try{x.jc(F),x.$c=a,F.dna=l}finally{x&&x.dispose()}return 32}):8}wlj(a,b,c){b=this.ra.ae();a=this.ZKf(b);b=this.nLf(b);return 1===c?a||b?32:8:32}Bzj(a,b,c,f){var l=Object(va.a)(253,Object(va.a)(123,this.ta.Ba).Ag(this.Qb.Ma));const x=this.Qb.Cd,F=Math.round(this.Rj.ML(x.Ge(c,0),l.BV));l=Math.round(this.Rj.ML(x.Ge(f,1),l.BV));a.setValue(bb.a.Ex,
c);a.setValue(bb.a.sD,f);a.setValue(ub.a.widthPersisted,c);a.setValue(ub.a.heightPersisted,f);a.isEditable=!0;a.Mf=!0;a.setValue(ub.a.LR,4);a.setValue(ub.a.Jcd,!0);a.gba=Fd.a.XGa(F,0);a.fba=Fd.a.XGa(l,1);a.setValue(ub.a.HOa,0);a.setValue(ub.a.IOa,0);a.setValue(ub.a.TRa,!0);a.setValue(ub.a.isResizable,!0);a.setValue(ub.a.EK,!0);a.gN=!0;a.MRa=!0;a.EK=!0;a.isResizable=!0;a.OL=oe.a.bE(b.sid,b.cid);a.tgb=a.get_shapeId();a.setValue(ub.a.Vra,!0);b=Object.assign(new $z.a,{TopLeft:Object.assign(new qo.a,{X:0,
Y:0}),TopRight:Object.assign(new qo.a,{X:F,Y:0}),BottomLeft:Object.assign(new qo.a,{X:0,Y:l}),BottomRight:Object.assign(new qo.a,{X:F,Y:l})});a.KT=b;this.Ea.FK(a)&&Mc.a.Cb&&(Mc.a.Cb.Ij=!0)}}Object(e.a)(IM,"GroupUngroupShapesActor",null,[244]);class JM{constructor(){this.isFooterInsert=this.omitOnTitle=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.isSlideNumInsert=!1}}Object(e.a)(JM,"FooterPaneInfo",null,[]);var KM=d(606);class zE{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=
0;this.IsToggled=this.IsSlideNumInsert=this.IsOmitOnTitlePh=this.IsFooterInsert=!1;this.SFooterName=null}}Object(e.a)(zE,"PresFooterInfo",null,[]);var LM=d(631);class MM{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.Xja=null;a("powerpoint-editor-intl").then(()=>{ya.a.J(594321887,801,50,"Icons and strings script is loaded successfully");a("headerFooterManager").then(()=>{ya.a.J(594321885,801,50,"Header Footer Pane Manager script is loaded successfully");this.Xja=headerFooterManager.FactoryGlobal.getHeaderFooterManagerInstance();
this.lLk()}).catch(kc=>{ya.a.J(594321883,801,10,"Failed to load headerfooter pane manager "+kc.toString())})}).catch(kc=>{ya.a.J(594321881,801,10,"Failed to load powerpoint-editor-intl "+kc.toString())});this.nb=b;this.Nb=c;this.ia=f;this.Yb=l;this.ta=x;this.Fa=F;this.Zu=R;this.Lg=fa;this.od=wa;this.Qc=Xa;this.Db=lb;this.Lg.WJ(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Lg.Smb(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Lg.Aza(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));
this.Qc.QMa(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.od.Dza(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Nb.vM(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"));this.Dy=null;this.Ryb=!1;this.gAb=Lb}dispose(){this.Lg.z4(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Lg.Gcd(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Lg.YWa(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Qc.qeb(Object(D.a)(this,this.QI,
"onChangeRenderHeaderFooterPane"));this.od.seb(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Nb.rX(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"))}we(){}ub(){this.ia.pa(ba.a.Ltb,fc.a.application,Object(D.a)(this,this.Ltb,"insertFooterFlyoutMenu"),4);this.ia.pa(ba.a.h0,fc.a.application,Object(D.a)(this,this.h0,"showHideHeaderFooterPane"),4);this.ia.pa(ba.a.O7a,fc.a.application,Object(D.a)(this,this.O7a,"insertSlideNumber"),4);this.ia.pa(ba.a.lad,fc.a.application,Object(D.a)(this,
this.lad,"queryHeaderFooterPane"),96)}lad(a,b,c,f,l){(a=Object(va.a)(Ph.a,l))&&a.Kf(this.Zu.isVisible);return 32}Ltb(){return this.Xja&&this.Yb&&this.ta.Ba&&this.Yb.isEditingAllowed?32:8}h0(a,b,c){if(1===c)return this.Zu&&this.ta.Ba?32:8;if(!this.Zu)return 8;this.Dy=null;this.Zu.isVisible=!this.Zu.isVisible;this.Zu.isVisible?(sg.a("FooterPaneOpen",a,()=>{this.Vhc();return 32}),this.gAb||(this.Fa.Gj(Nc.a.vK,!0),this.Xja.focus())):this.Fa.Gj(Nc.a.vK,!1);return 32}O7a(a,b,c,f,l){return 1===c?this.ta.Ba?
32:8:sg.a("FooterPaneInsertSldNumber",a,()=>{const x=this.Rec();this.mnc(x.OmitOnTitlePh,x.IsFooterInsert,x.SFooterName,!0);return this.h0(a,b,c,f,l)})}$v(a){1===a.mode&&this.Zu&&this.Zu.isVisible&&(this.Dy=null,this.Zu.isVisible=!1,this.Fa.Gj(Nc.a.vK,!1))}D_d(a){const b=new Ha.a;a=a.jD();for(const c of a)(a=Ya.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}Rec(){const a=new KM.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ta.Ba;if(!b)return a;
if((b=b.om(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.al&&(5===c.zj?a.IsSlideNumInsert=!0:6===c.zj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.PB?this.D_d(c):"",0<b.length?a.SFooterName=b:ya.a.J(594321879,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Yb.yf.yGa;return a}isMultipleSlidesSelected(){const a=this.nb.mf();return a&&1<a.length?!0:!1}Vhc(){if(this.Zu.isVisible)if(this.ta.Ba){var a=this.Rec(),b=this.isMultipleSlidesSelected();if(!this.Dy||a.IsFooterInsert!==this.Dy.IsFooterInsert||
a.IsSlideNumInsert!==this.Dy.IsSlideNumInsert||a.OmitOnTitlePh!==this.Dy.OmitOnTitlePh||a.SFooterName.localeCompare(this.Dy.SFooterName)||b!==this.Ryb){this.Dy=a;this.Ryb=b;var c=new JM;c.isFooterInsert=a.IsFooterInsert;c.isSlideNumInsert=a.IsSlideNumInsert;c.sFooterName=a.SFooterName;c.omitOnTitle=a.OmitOnTitlePh;c.isMultipleSlidesSelected=b;this.Xja.renderHeaderFooterTaskPane(LM.a.A4d,c)}}else this.Zu.isVisible=!1,this.Dy=null}QI(){this.Vhc()}lLk(){this.Xja.addCloseHeaderFooterPaneEventListener(()=>
{this.Zu.isVisible=!1;this.Dy=null});this.Xja.addFocusHeaderFooterPaneListener(()=>{this.Fa.Gj(Nc.a.vK,!0)});this.Xja.addUpdateHeaderFooterListener((a,b,c,f,l)=>{this.FSe(a,b,c,f,l)});this.Xja.addUpdateMultiSlideHeaderFooterListener((a,b,c,f)=>{this.RSe(a,b,c,f)})}FSe(a,b,c,f,l){this.ta.Ba&&(l?this.bTe(a,b,c,f):this.mnc(a,b,c,f))}RSe(a,b,c,f){this.ta.Ba&&sg.a("FooterPaneMultiSlide",ba.a.h0,()=>{const l=this.Db.rd(15,void 0,()=>{this.nb.hj()});try{l.jc(this.ta.Ba);const x=this.nb.mf();if(x&&1<x.length){for(const F of x){const R=
F.a7;R.IsSlideNumInsert=f;R.IsFooterInsert=b;R.OmitOnTitlePh=a;R.SFooterName=c;R.IsToggled=!R.IsToggled;F.a7=R}this.Yb.yf.yGa=a}}finally{l&&l.dispose()}return 32})}mnc(a,b,c,f){let l="FooterPaneSingleSlide";const x=this.ta.Ba,F=x.a7;if(a||b||f)F.OmitOnTitlePh!==a?l+="_OPH":F.IsSlideNumInsert!==f?l+="_ISN":F.IsFooterInsert!==b&&(l+="_IFT");sg.a(l,ba.a.h0,()=>{const R=this.Db.rd(15,void 0,()=>{this.nb.hj()});try{R.jc(this.ta.Ba),F.IsSlideNumInsert=f,F.IsFooterInsert=b,F.OmitOnTitlePh=a,F.SFooterName=
c,F.IsToggled=!F.IsToggled,this.Yb.yf.yGa=a,x.a7=F}finally{R&&R.dispose()}return 32})}bTe(a,b,c,f){sg.a("FooterPaneAllSlides",ba.a.h0,()=>{const l=this.Db.rd(15,void 0,()=>{this.nb.hj()});try{const x=this.Yb.yf;l.jc(x);let F=x.dHa;F||(F=new zE);const R=this.ta.Ba;F.ActiveSlideCid=R.cid;F.ActiveSlideSid=R.sid;F.IsSlideNumInsert=f;F.IsFooterInsert=b;F.IsOmitOnTitlePh=a;F.SFooterName=c;F.IsToggled=!F.IsToggled;x.yGa=a;x.dHa=F}finally{l&&l.dispose()}return 32})}}Object(e.a)(MM,"HeaderFooterPaneActor",
null,[244]);class NM{constructor(){this.isFooterInsert=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.omitOnTitle=this.isSlideNumInsert=!1}}Object(e.a)(NM,"FooterPaneInfo",null,[]);class OM{constructor(){this.type="HeaderFooterContentProps";this.onFocusPane=this.onUpdateMultiSlideHeaderFooter=this.onUpdateHeaderFooter=this.activeSlideFooterInfo=null}}Object(e.a)(OM,"HeaderFooterContentProps",null,[]);class PM{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.gZc=!1;Lb?this.gZc=!0:a("powerpoint-editor-intl").then(()=>
{ya.a.J(590210325,801,50,"Icons and strings script is loaded successfully");a("powerpoint-ribbon-intl").then(()=>{ya.a.J(590210323,801,50,"Ribbon script is loaded successfully");a("taskPanes").then(()=>{ya.a.J(590210321,801,50,"Header Footer Pane script is loaded successfully");this.gZc=!0}).catch(()=>{ya.a.J(590210319,801,10,"Failed to load Header Footer Pane script")})}).catch(()=>{ya.a.J(590210317,801,10,"Failed to load Ribbon script")})}).catch(kc=>{ya.a.J(590210315,801,10,"Failed to load powerpoint-editor-intl "+
kc.toString())});this.nb=b;this.Nb=c;this.ia=f;this.Yb=l;this.ta=x;this.Zu=R;this.Lg=fa;this.od=wa;this.Qc=Xa;this.Db=lb;this.Lg.WJ(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Lg.Smb(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Lg.Aza(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Qc.QMa(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.od.Dza(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Nb.vM(Object(D.a)(this,
this.$v,"onAppFrameModeSwitched"));this.Dy=null;this.Ryb=!1;this.gAb=Lb}dispose(){this.Lg.z4(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Lg.Gcd(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Lg.YWa(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Qc.qeb(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.od.seb(Object(D.a)(this,this.QI,"onChangeRenderHeaderFooterPane"));this.Nb.rX(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"))}we(){}ub(){this.ia.pa(ba.a.Ltb,
fc.a.application,Object(D.a)(this,this.Ltb,"insertFooterFlyoutMenu"),4);this.ia.pa(ba.a.h0,fc.a.application,Object(D.a)(this,this.h0,"showHideHeaderFooterPane"),4);this.ia.pa(ba.a.O7a,fc.a.application,Object(D.a)(this,this.O7a,"insertSlideNumber"),4)}Ltb(){return this.Yb&&this.ta.Ba&&this.Yb.isEditingAllowed?32:8}h0(a,b,c){if(1===c)return this.gZc?32:8;if(!this.Zu)return 8;this.Dy=null;this.Zu.isVisible=!this.Zu.isVisible;this.Zu.isVisible?sg.a("WACFooterPaneOpen:: IsTabbedPaneEnabled: "+this.gAb.toString(),
a,()=>{this.Vhc();return 32}):this.Ds();return 32}$v(a){1===a.mode&&this.Zu&&this.Zu.isVisible&&(this.Dy=null,this.Zu.isVisible=!1,this.Ds())}Kl(a=!1){const b=this.IB(),c=Object.assign(new au.a,{title:ResourceStrings.l_InsertFooter,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Zu.isVisible=!1},isModernPane:!0});this.gAb?yj.UISurfaces.Cs().then(f=>{a?f.updateTaskPane(Nc.a.vK,c):f.showTaskPane(Nc.a.vK,c);return null}):(this.Zu.isVisible=!0,taskPanes.taskPane.renderTaskPane(LM.a.A4d,
c))}Ds(){this.gAb&&yj.UISurfaces.Cs().then(a=>{a.hideTaskPane(Nc.a.vK,2);return null})}IB(){const a=new NM;a.isFooterInsert=this.Dy.IsFooterInsert;a.sFooterName=this.Dy.SFooterName;a.isSlideNumInsert=this.Dy.IsSlideNumInsert;a.omitOnTitle=this.Dy.OmitOnTitlePh;a.isMultipleSlidesSelected=this.Ryb;const b=new OM;b.activeSlideFooterInfo=a;b.onUpdateHeaderFooter=Object(D.a)(this,this.FSe,"updateFooterInfo");b.onUpdateMultiSlideHeaderFooter=Object(D.a)(this,this.RSe,"updateMultiSlidesFooterInfo");return b}O7a(a,
b,c,f,l){return 1===c?this.gZc?32:8:sg.a("WACFooterPaneInsertSldNumber:: IsTabbedPaneEnabled: "+this.gAb.toString(),a,()=>{const x=this.Rec();this.mnc(x.OmitOnTitlePh,x.IsFooterInsert,x.SFooterName,!0);return this.h0(a,b,c,f,l)})}D_d(a){const b=new Ha.a;a=a.jD();for(const c of a)(a=Ya.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}Rec(){const a=new KM.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ta.Ba;if(!b)return a;if((b=b.om(!0))&&0<b.length)for(const c of b)!c.isLocal&&
c.al&&(5===c.zj?a.IsSlideNumInsert=!0:6===c.zj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.PB?this.D_d(c):"",0<b.length?a.SFooterName=b:ya.a.J(590210313,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Yb.yf.yGa;return a}isMultipleSlidesSelected(){const a=this.nb.mf();return a&&1<a.length?!0:!1}Vhc(a=!1){if(this.Zu.isVisible)if(this.ta.Ba){var b=this.Rec(),c=this.isMultipleSlidesSelected();if(!this.Dy||b.IsFooterInsert!==this.Dy.IsFooterInsert||b.IsSlideNumInsert!==this.Dy.IsSlideNumInsert||b.OmitOnTitlePh!==
this.Dy.OmitOnTitlePh||b.SFooterName.localeCompare(this.Dy.SFooterName)||c!==this.Ryb)this.Dy=b,this.Ryb=c,this.Kl(a)}else this.Zu.isVisible=!1,this.Dy=null}QI(){this.Vhc(!0)}FSe(a,b,c,f,l){this.ta.Ba&&(f?this.bTe(a,b,l,c):this.mnc(a,b,l,c))}RSe(a,b,c,f){this.ta.Ba&&sg.a("FooterPaneMultiSlide",ba.a.h0,()=>{const l=this.Db.rd(15,void 0,()=>{this.nb.hj()});try{l.jc(this.ta.Ba);const x=this.nb.mf();if(x&&1<x.length){for(const F of x){const R=F.a7;R.IsSlideNumInsert=c;R.IsFooterInsert=b;R.OmitOnTitlePh=
a;R.SFooterName=f;R.IsToggled=!R.IsToggled;F.a7=R}this.Yb.yf.yGa=a}}finally{l&&l.dispose()}return 32})}mnc(a,b,c,f){let l="FooterPaneSingleSlide";const x=this.ta.Ba,F=x.a7;if(a||b||f)F.OmitOnTitlePh!==a?l+="_OPH":F.IsSlideNumInsert!==f?l+="_ISN":F.IsFooterInsert!==b&&(l+="_IFT");sg.a(l,ba.a.h0,()=>{const R=this.Db.rd(15,void 0,()=>{this.nb.hj()});try{R.jc(this.ta.Ba),F.IsSlideNumInsert=f,F.IsFooterInsert=b,F.OmitOnTitlePh=a,F.SFooterName=c,F.IsToggled=!F.IsToggled,this.Yb.yf.yGa=a,x.a7=F}finally{R&&
R.dispose()}return 32})}bTe(a,b,c,f){sg.a("FooterPaneAllSlides",ba.a.h0,()=>{const l=this.Db.rd(15,void 0,()=>{this.nb.hj()});try{const x=this.Yb.yf;l.jc(x);let F=x.dHa;F||(F=new zE);const R=this.ta.Ba;F.ActiveSlideCid=R.cid;F.ActiveSlideSid=R.sid;F.IsSlideNumInsert=f;F.IsFooterInsert=b;F.IsOmitOnTitlePh=a;F.SFooterName=c;F.IsToggled=!F.IsToggled;x.yGa=a;x.dHa=F}finally{l&&l.dispose()}return 32})}}Object(e.a)(PM,"HeaderFooterPaneWacActor",null,[244]);class QM{constructor(a,b,c,f,l){this.gv=a;this.ia=
b;this.Yb=c;this.ta=f;this.Xb=l}ub(){this.ia.pa(ba.a.rQc,Fb.a.application,Object(D.a)(this,this.Qlj,"handleInsertContentFromStream"),4)}we(){}Qlj(a,b,c,f,l){b=this.ta.Ba;if(this.Xb.Zc(b))return 16;if(1===c)return 32;Mc.a.hk("SlideCount","1");this.gv.gNi(b,l.streamUrl,l.formatType,l.objectType,a).VV||this.Xb.zw(this.Yb.yf,a);return 32}}Object(e.a)(QM,"InsertContentFromStreamActor",null,[244]);class RM{constructor(a,b){this.Rj=a;this.Sb=b}EJd(a,b,c,f){const l=F=>this.Rj.ML(a.Ge(Fd.a.Ef(F,0),0),f),x=
Math.round(l(c.x+b.width))-Math.round(l(c.x));b=Math.round(l(c.y+b.height))-Math.round(l(c.y));return Object.assign(new $z.a,{TopLeft:Object.assign(new qo.a,{X:0,Y:0}),TopRight:Object.assign(new qo.a,{X:x,Y:0}),BottomLeft:Object.assign(new qo.a,{X:0,Y:b}),BottomRight:Object.assign(new qo.a,{X:x,Y:b})})}pNd(a,b,c){var f=a?a.Q3d:9;const l=Fd.a.Ge(a?a.kUe:6,0,!1);f=Fd.a.Ge(f,1,!1);b=this.pqi(l,f,b,c);a=a?a.msb(b.width,b.height,!0):this.Sb.tra(b.width,b.height);return{FUd:b,vC:a}}pqi(a,b,c,f){let l=0,
x=0;0<c&&0<f&&(a=Math.min(1*a/c,1*b/f,1),l=Math.max(c*a,1),x=Math.max(f*a,1));return new er.a(l,x)}}Object(e.a)(RM,"InsertImageHelper",null,[298]);class Nd{constructor(a,b,c,f){this.zYa=a;this.shapeType=b;this.height=c;this.width=f}}Object(e.a)(Nd,"AutoShapeProps",null,[]);class fu{static nPd(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc){x=lb.j4a(!1,a.cid,a.sid,0,b.shapeType,x,F,R,fa,wa+1);x.setValue(ub.a.LR,b.zYa);({snh:f,knh:kc}=l.gdg(f,b,c,lc,Lb,kc));Lb=Lb.Cd;x.setValue(bb.a.Ex,Lb.Ef(lc.KQ(f,c),0));x.setValue(bb.a.sD,
Lb.Ef(lc.KQ(kc,c),1));x.setValue(ub.a.widthPersisted,x.Ex);x.setValue(ub.a.heightPersisted,x.sD);x.setValue(ub.a.Jcd,!0);x.gba=Fd.a.XGa(f,0);x.fba=Fd.a.XGa(kc,1);x.setValue(ub.a.HOa,0);x.setValue(ub.a.IOa,0);x.setValue(ub.a.TRa,!0);x.setValue(ub.a.isResizable,!0);x.setValue(ub.a.EK,!0);x.gN=!0;x.MRa=!0;lc=(Lb=95===b.zYa||97===b.zYa)||Array.contains(fu.Gzg,b.zYa);x.EK=!Lb;x.isResizable=!0;x.setValue(ub.a.uy,Lb);x.setValue(ub.a.CZ,95===b.zYa);x.OL=oe.a.bE(a.sid,a.cid);x.tgb=x.get_shapeId();x.setValue(ub.a.Vra,
!0);a=l.qRf(f,kc,c);x.KT=a;(Xa.FK(x)||Xa.Sia(x))&&Mc.a.Cb&&(Mc.a.Cb.Ij=!0);lc?l.clh(x):l.nlh(x);return x}}fu.Gzg=[88,93,94,89,90,91,92];Object(e.a)(fu,"InsertContentShapeNodeFactory",null,[]);class SM{gdg(a,b,c,f){b=a.right-a.left;let l=a.bottom-a.top;b=Math.max(b,1);l=Math.max(l,1);ee.a("FixInkDotInsertionAtHighZooms")?(a=f.ML(b,c),c=f.ML(l,c)):(a=Math.round(f.ML(b,c)),c=Math.round(f.ML(l,c)));return{snh:a,knh:c}}qRf(a,b,c){return Object.assign(new $z.a,{TopLeft:Object.assign(new qo.a,{X:0,Y:0}),
TopRight:Object.assign(new qo.a,{X:a*c,Y:0}),BottomLeft:Object.assign(new qo.a,{X:0,Y:b*c}),BottomRight:Object.assign(new qo.a,{X:a*c,Y:b*c})})}clh(){}nlh(){}}Object(e.a)(SM,"InsertInkActorHelper",null,[971]);var PQ=d(496);class aA{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.x8=Lb;this.gv=a;this.ia=b;this.ta=c;this.Xb=f;this.Qb=l;this.Mx=R;this.xm=fa;this.gl=wa;this.Ea=Xa;this.Rj=lb}dispose(){}ub(){this.ia.pa(ba.a.Hmg,Fb.a.application,Object(D.a)(this,this.Rlj,"handleInsertInk"),4)}we(){}Rlj(a,
b,c,f,l){if(!l)return 16;b=l.Nd;if(!b)return ya.a.J(595080221,822,15,"HandleInsertInk was called with invalid slideNode!"),8;f=b.Bb;if(oe.a.xz(f)||this.Xb.Zc(b))return 16;if(1===c)return 32;c=this.XZb(a);if(!c)return 8;if(!this.gl.lI(b,1))return this.gl.kJ(b),16;var x=l.mzj;if(!x)return ya.a.J(595153805,822,15,"HandleInsertInk was called with invalid actionData!"),8;if(!x.count)return ya.a.J(595153803,822,15,"HandleInsertInk was called with 0 ink objects!"),8;l=new Ha.a;for(let Xa of x){x=Xa.sci;
if(!x)return 16;var F=b.uw;F=F&&null!=F.Fr?F.Fr:1;x.right=x.left+(x.right-x.left)/(1/F);x.bottom=x.top+(x.bottom-x.top)/(1/F);var R=x.right-x.left,fa=x.bottom-x.top;R=Math.max(R,1);fa=Math.max(fa,1);var wa=this.Qb.Cd;R=Fd.a.Ef(R,0);fa=Fd.a.Ef(fa,1);const lb=wa.Ef(x.left,0);wa=wa.Ef(x.top,1);const Lb=b.Qu();x=fu.nPd(f,c,F,x,new SM,lb,wa,R,fa,Lb,this.Ea,this.xm,this.Qb,this.ta,this.Rj);x.setValue(ub.a.Eia,Xa.json);x.setValue(ub.a.aDa,!0);Mc.a.Cb&&(Mc.a.Cb.actionName=aA.nOc);x.IH=new PQ.a([Xa.stroke],
Xa.json,!1);l.add(x)}this.gv.Z1(l.toArray(),b,a,void 0,void 0,!1);for(let Xa of l)this.x8.registerInkWithStrokeCollection(Xa.IH.Fwa,Xa.id);this.Mx.pI=l.ga(l.count-1);return 32}XZb(){return new Nd(4,10,1,1)}}aA.nOc="InsertInk";Object(e.a)(aA,"InsertInkActor",null,[244,106]);class TM{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa){this.Bj=null;this.JZc=!1;this.Qb=a;this.xm=b;this.Fa=c;this.ta=f;this.Sb=l;this.ra=F;this.Mx=R;this.gl=fa;this.Db=wa;this.Xb=Xa;this.la=x;this.sxl=x.insertOnlineVideoUrlPatterns;this.dfh=
x.insertOnlineVideoEndpoint;this.Uv=u.AFrameworkApplication.He;this.iml=3E4}get startTime(){return this.Bj}lOi(a){if(!a)return null;const b=a.trim();this.gHj(b)&&(ya.a.J(38322700,352,50,"[Insert Online Video] Used iframe instead of url"),a=this.mOi(b));return a}gyg(a){if(!a)return!1;a=a.trim();for(const b of this.sxl)if((new RegExp(b)).test(a))return!0;return!1}XPj(a){if(!a)return!1;a=a.trim();a=cg.a.TE(a).toLowerCase();return!this.la.g8a&&"shorts.flipgrid.com"===a||"flipgrid.com"===a||"www.flipgrid.com"===
a||!this.la.Bvb&&("embed.ted.com"===a||"www.ted.com"===a||"ted.com"===a)?!1:!0}dql(a,b){this.requestVideoData(a,c=>{this.Jpg(c)},b)}requestVideoData(a,b,c){this.JZc?ya.a.J(38901280,352,15,"[Insert Online Video] Multiple videos at the same time!"):(this.JZc=!0,c=c||Object(D.a)(this,this.CHi,"doNothingCallback"),this.Bj=new Date,a=Ma.a.Me(a),a=this.dfh+(0<this.dfh.indexOf("?")?"&":"?")+"url="+a,this.Uv.vj(a,1,null,null,!1,2,f=>{b(f);this.JZc=!1},f=>{c(f);this.JZc=!1},null,void 0,void 0,void 0,this.iml,
Ax.a("1")))}Jpg(a){var b=+new Date-+this.startTime;ya.a.J(38322702,352,50,"[Insert Online Video] Success!!! Hubble call completed in {0}ms",b);Mc.a.hk("HubbleCallDuration",b.toString());if((b=this.ta.Ba)&&!this.Xb.Zc(b)&&this.gl.lI(b,1))try{const R=b.j2(this.ra.ae());if(!R||!this.Xb.Zc(R)){var c=this.H6a(b,R),f=JSON.parse(a.data.Zd),l=f.width,x=f.height;c.GIe(f.embed_url,f.thumbnail_url,f.title,f.description,0<l?l:0,0<x?x:0);var F=this.Db.rd(15,void 0,()=>{this.ra.ly();this.ra.Ph();this.Fa.Ad()},
()=>{this.ra.selectShape(c,!0)});try{F.fd(b),this.la.jol&&(F.$c=ba.a.GCa,F.my[Aq.a.WAa]=Aq.a.online),R&&b.HT([R]),b.rB(c)}finally{F&&F.dispose()}this.Xb.zw(b,"InsertOnlineVideo");this.Mx.pI=c;ya.a.J(38322704,352,50,"[Insert Online Video] Video inserted")}}catch(R){ya.a.J(38322706,352,10,"[Insert Online Video] Exception after successful Hubble callback: Exception = [{0}], stack = {1}.",R.message,R.stack)}else this.gl.kJ(b)}CHi(){}H6a(a,b){if(!a)return null;var c=a.Bb;a=a.Qu();let f;const l=qf.a.VW,
x=qf.a.e4;f=b?b.msb(qf.a.VW,qf.a.e4):this.Sb.tra(qf.a.VW,qf.a.e4);const F=b?0:0*Eq.a.D6;c=this.xm.fqa(!0,c.cid,c.sid,0,f.x+F,f.y+F,l,x,a+1,!0);b&&(c.Iaa=b.id);return c}mOi(a){if(!a)return null;a=RegExp("src\\s*=\\s*['\"][^'\"]*").exec(a);if(!a||1!==a.length)return ya.a.J(38322708,352,10,"[Insert Online Video] iframe error"),null;a=a[0];let b=a.indexOf('"');-1===b&&(b=a.indexOf("'"));return a=a.substr(b+1)}gHj(a){return a?RegExp(".*iframe.*").test(a):!1}U8f(a){if(!a)return"NA";let b=a.indexOf(".com/");
if(-1===b)return"NA";if(a.startsWith("https://"))a=a.substring(8,b);else if(a.startsWith("http://"))a=a.substring(7,b);else return"NA";b=a.lastIndexOf(".");return-1===b?a:a.substr(b+1)}}Object(e.a)(TM,"InsertOnlineVideoDialogHelper",null,[258]);class AE{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(e.a)(AE,"CT_LineJoinMiterProperties",null,[]);class bA{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=
0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(e.a)(bA,"CT_LineProperties",null,[]);class UM{constructor(){this.valField=0}}Object(e.a)(UM,"CT_PositiveFixedPercentage",null,[]);class cA{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(e.a)(cA,"CT_PresetLineDashProperties",
null,[]);class BE{gdg(a,b,c,f,l,x){a=Object(va.a)(253,x.Ba.Ag(l.Ma));c=l.Cd;l=Math.round(f.ML(c.Ge(b.width*je.a.XN,0),a.BV));b=Math.round(f.ML(c.Ge(b.height*je.a.XN,1),a.BV));return{snh:l,knh:b}}qRf(a,b){return Object.assign(new $z.a,{TopLeft:Object.assign(new qo.a,{X:0,Y:0}),TopRight:Object.assign(new qo.a,{X:a,Y:0}),BottomLeft:Object.assign(new qo.a,{X:0,Y:b}),BottomRight:Object.assign(new qo.a,{X:a,Y:b})})}clh(a){a.lineStyle=Object.assign(new bA,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,
cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new AE,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new cA,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new zh.a,{schemeClrField:Object.assign(new Nl.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}nlh(a){a.fill=Object.assign(new Hz.a,{solidFillField:Object.assign(new zh.a,{schemeClrField:Object.assign(new Nl.a,{valField:4})})});a.lineStyle=Object.assign(new bA,{algnField:0,algnFieldSpecified:!0,capField:2,
capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new AE,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new cA,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new zh.a,{schemeClrField:this.Zzi(Object.assign(new UM,{valField:5E4}))}),wField:12700,wFieldSpecified:!0})}Zzi(a){const b={itemsElementNameField:[26]};b.itemsField=[a];b.valField=4;return b}}Object(e.a)(BE,"InsertShapeActorHelper",null,[971]);class Jj{constructor(a,b,c,f,l,x,F,
R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg){this.w0c=this.kab=0;if(!Dc)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!Sd)throw Error.argumentNull("appFrame");if(!Pe)throw Error.argumentNull("viewEventNotifier");this.gv=a;this.ia=b;this.Fa=c;this.ra=f;this.Hja=0;this.ta=fa;this.Xb=l;this.Qb=x;this.eEa=F;this.Mx=Xa;this.QMg=R;this.Lg=wa;this.Ms=fa.presentation;this.xm=lb;this.gl=Lb;this.P2j=kc;this.dAb=lc;this.Ea=Ec;this.Rj=Jc;this.Vxb=Dc;this.Oca=Wd;this.jyb=xe;this.Nb=
Sd;this.gf=Pe;this.UZc=Ue;this.Aee=Ef;this.COg=dg;this.Lg.WJ(Object(D.a)(this,this.jWa,"onSlideNavigation"));this.QMg.xk(Object(D.a)(this,this.Rcb,"onPresentationPropertyChanged"));this.jyb&&(this.Nb.vM(Object(D.a)(this,this.$v,"onAppFrameModeSwitched")),this.gf.Rmb(Object(D.a)(this,this.eva,"onRibbonTabSwitched")),this.gf.J2h(Object(D.a)(this,this.$Xg,"onEscapeKeyPressed")));this.UZc&&(Jj.Y5c.push(ba.a.z6d),Jj.Y5c.push(ba.a.x6d));this.tKf()}dispose(){this.QMg.Tm(Object(D.a)(this,this.Rcb,"onPresentationPropertyChanged"));
this.Lg.z4(Object(D.a)(this,this.jWa,"onSlideNavigation"));this.jyb&&(this.Nb.rX(Object(D.a)(this,this.$v,"onAppFrameModeSwitched")),this.gf.Rhc(Object(D.a)(this,this.eva,"onRibbonTabSwitched")),this.gf.ROk(Object(D.a)(this,this.$Xg,"onEscapeKeyPressed")))}ub(){for(const a of Jj.cll)this.ia.pa(a,Fb.a.application,Object(D.a)(this,this.nhg,"handleInsertShape"),4);for(const a of Jj.X5c)this.ia.pa(a,Fb.a.application,Object(D.a)(this,this.nhg,"handleInsertShape"),4);this.ia.pa(ba.a.BQc,Fb.a.application,
Object(D.a)(this,this.Tlj,"handleInsertShapeAtSpecifiedLocation"),4);this.ia.pa(ba.a.N2b,Fb.a.application,Object(D.a)(this,this.Ulj,"handleInsertShapeTextBoxAtSpecifiedLocation"),4);this.ia.pa(ba.a.Wii,Fb.a.application,Object(D.a)(this,this.Jgg,"handleCancelInsertShape"),4);this.ia.pa(ba.a.tLf,Fb.a.application,Object(D.a)(this,this.Jgg,"handleCancelInsertShape"),4);this.ia.pa(ba.a.O4a,Fb.a.application,Object(D.a)(this,this.Rkj,"handleDuplicateShape"),4)}we(){this.Fa.Bc(Nc.a.yg).bindAction(A.KeyInputManager.Na(w.a.LJa,
A.KeyInputManager.Fe),ba.a.O4a);this.Fa.Bc(Nc.a.sP).bindAction(A.KeyInputManager.Na(w.a.LJa,A.KeyInputManager.Fe),ba.a.O4a)}tKf(){if(this.Ms){var a=Math.min(this.Ms.Cel,this.Ms.eel);a=Math.max(a-50,0);this.kab=Math.floor(a/(2*Eq.a.D6))-1;this.kab=Math.max(this.kab,0);this.w0c=-1*this.kab}else this.kab=1,this.w0c=-1}Rcb(a,b){b.property!==ub.a.slideWidth&&b.property!==ub.a.slideHeight||this.tKf()}jWa(){this.Hja=0;this.jyb&&this.Zwa(0)}$v(a){1===a.mode&&this.Zwa(0)}eva(){this.Zwa(0)}$Xg(){this.Zwa(0)}Zwa(a){1===
a&&this.Fa.Ad();this.Vxb.Cwh(a)}nhg(a,b,c,f,l){b=this.ta.Ba;if(!b)return 16;f=b.Bb;if(oe.a.xz(f)||this.Xb.Zc(b))return 16;if(1===c)return 32;c=this.XZb(a);if(!c)return 8;if(!this.gl.lI(b,1))return this.gl.kJ(b),16;const x=this.P2j&&this.dAb.fN;var F=b.Se.HasDefaultShape,R=b.Se.HasDefaultLine,fa=95===c.zYa||97===c.zYa||Array.contains(fu.Gzg,c.zYa);R=R&&fa;F=F&&!fa;if(this.jyb||this.UZc){fa=!1;l&&(Dn.a.Uu in l?l=l[Dn.a.Uu]:(ya.a.J(512349792,829,15,"actionData {0} does not contain the InputMethod",l),
l=0),fa=!Array.contains(Jj.rfk,l));if(fa){if(a===ba.a.Otb)return this.Zwa(1),this.UZc&&(this.Oca.instance.Ntb=-1),32;if(this.UZc&&x&&!Array.contains(Jj.Y5c,a)&&!F&&!R){this.Zwa(2);if(null==this.Oca.instance)throw Error.argumentNull("insertShapeOverlayViewElement");this.Oca.instance.Ntb=a;return 32}}this.Zwa(0)}let wa,Xa;var lb=this.Ms.slideWidth,Lb=this.Ms.slideHeight;fa=new ad.a((lb-c.width*je.a.XN)/2,(Lb-c.height*je.a.XN)/2);l=fa.x+Fd.a.Ef(this.Hja*Eq.a.D6,0);Xa=fa.y+Fd.a.Ef(this.Hja*Eq.a.D6,1);
x?(fa=c.width*je.a.XN,wa=c.height*je.a.XN):(fa=Fd.a.Ef(Jj.TJf,0),wa=Fd.a.Ef(Jj.SJf,1),l=lb/2-Fd.a.Ef(Jj.TJf/2-this.Hja*Eq.a.D6,0),Xa=Lb/2-Fd.a.Ef(Jj.SJf/2-this.Hja*Eq.a.D6,1));this.Hja++;this.Hja>this.kab&&(this.Hja=this.w0c);lb=b.Qu();Lb=Object(va.a)(253,this.ta.Ba.Ag(this.Qb.Ma));Mc.a.Cb&&(R||F)&&Mc.a.Cb.Wa(ri.a.U1f,R?"HasDefaultLine":"HasDefaultShape");!x||a===ba.a.Otb||Array.contains(Jj.Y5c,a)||F||R?f=this.xm.j4a(!1,f.cid,f.sid,0,c.shapeType,l,Xa,fa,wa,lb+1):(f=fu.nPd(f,c,Lb.BV,null,new BE,l,
Xa,fa,wa,lb,this.Ea,this.xm,this.Qb,this.ta,this.Rj),Mc.a.Cb&&(Mc.a.Cb.actionName=Jj.nOc));ee.a("MoveCursorToTextboxAfterKeyboardInsert")&&a===ba.a.Otb&&(this.bBf(),this.aab=f);f.isEditable=!Array.contains(Jj.X5c,a);this.gv.Z1([f],b,a);this.Mx.pI=f;this.LQe();return 32}bBf(){this.pke||(this.COg.ppa(this.Shh.bind(this)),this.Lg.Ozc(this.uTg.bind(this)),this.pke=!0)}RNk(){this.pke&&(this.COg.Qhc(this.Shh.bind(this)),this.Lg.qdh(this.uTg.bind(this)),this.pke=!1)}Shh(a,b){a=b.node;null!=a&&a==this.aab&&
(this.aab=a,this.ZJg=b.revisionId.toString())}uTg(a,b){b.P9&&b.P9.Id&&this.ZJg==b.P9.Id&&(null==this.aab||this.Aee.Yra(this.aab)||setTimeout(()=>{this.ia.Ka(ba.a.kNa,2,new zn.a(this.aab,!0,null));this.RNk();this.ZJg=this.aab=null},0))}Ulj(a,b,c,f,l){if(1===c)return 2;this.Zwa(0);b=this.ta.Ba;if(!b)return 16;c=b.Bb;if(oe.a.xz(c)||this.Xb.Zc(b))return 16;f=this.XZb(a);if(!f)return 16;if(!this.gl.lI(b,1))return this.gl.kJ(b),16;this.Hja++;this.Hja>this.kab&&(this.Hja=this.w0c);if(!ee.a("IsAnyOffsetZeroForTextbox")){if(!(l&&
l.left&&l.right&&l.bottom&&l.top))return ya.a.J(512349791,829,10,"Invalid offsets : {0}",l),16}else if(!l)return ya.a.J(512336011,829,10,"Invalid offsets"),16;const x=this.ta.Ba.uw.Fr;let F=Fd.a.Ef(this.Rj.ML(l.right-l.left,x),0),R=Fd.a.Ef(this.Rj.ML(l.bottom-l.top,x),1);R||F||(F=Fd.a.Ef(Jj.Tfi,0),R=Fd.a.Ef(Jj.Sfi,1));F=F?F:Fd.a.Ef(Jj.tgi,0);R=R?R:Fd.a.Ef(Jj.sgi,1);const fa=Fd.a.Ef(this.Rj.ML(l.left,x),0);l=Fd.a.Ef(this.Rj.ML(l.top,x),1);l=this.xm.j4a(!1,c.cid,c.sid,0,f.shapeType,fa,l,F,R,b.Qu()+
1);if(!l)return ya.a.J(512349790,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;ee.a("MoveCursorToTextboxAfterInsert")&&this.bBf();l.isEditable=!Array.contains(Jj.X5c,a);this.aab=l;this.gv.Z1([l],b,a);this.Mx.pI=l;this.LQe();ya.a.J(512349789,829,50,"Successfully inserted the textbox at specified location");return 32}Tlj(a,b,c,f,l){if(1===c)return ya.a.J(512349511,829,10,"behavior is ActionBehavior.isEnabled"),2;this.Zwa(0);b=this.ta.Ba;if(!b)return ya.a.J(512349510,829,
10,"slideNode is null"),16;c=b.Bb;if(oe.a.xz(c))return ya.a.J(512349509,829,10,"slideNode is fake"),16;if(this.Xb.Zc(b))return ya.a.J(512349508,829,10,"GraphNodeAndParent is blocked"),16;f=this.XZb(l.insertShapeActionId);if(!f)return ya.a.J(512349507,829,10,"autoShapeProps is null"),16;if(!this.gl.lI(b,1))return this.gl.kJ(b),16;var x=l.offsets;if(!x)return ya.a.J(512349788,829,10,"Invalid offsets"),16;const F=this.ta.Ba.Ag(this.Qb.Ma);let R=this.Qb.Cd.Ef(x.right-x.left,0),fa=this.Qb.Cd.Ef(x.bottom-
x.top,1);fa||R||(R=f.width*je.a.XN,fa=f.height*je.a.XN);const wa=this.Qb.Cd.Ef(x.left,0);x=this.Qb.Cd.Ef(x.top,1);f.height=fa/je.a.XN;f.width=R/je.a.XN;const Xa=b.Qu();c=fu.nPd(c,f,F.BV,null,new BE,wa,x,R,fa,Xa,this.Ea,this.xm,this.Qb,this.ta,this.Rj);Mc.a.Cb&&(Mc.a.Cb.actionName=Jj.nOc);if(!c)return ya.a.J(512349787,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;c.isEditable=!Array.contains(Jj.X5c,a);l.insertLocalShape?b.rB(c,null):(this.gv.Z1([c],b,a),this.Oca.instance.Ntb=
-1,this.Mx.pI=c,this.LQe());l.node=c;ya.a.J(512349786,829,50,"Successfully inserted the shape at specified location");return 32}Jgg(a,b,c){if(1===c)return 32;this.Zwa(0);return 32}XZb(a){switch(a){case ba.a.Otb:return new Nd(34,16,.5,3);case ba.a.N2b:return new Nd(34,16,.5,3);case ba.a.Fng:return new Nd(34,9,1,1);case ba.a.Apg:return new Nd(2,17,1,1.16);case ba.a.Wog:return new Nd(3,55,1,1);case ba.a.Gog:return new Nd(6,56,1,1.33);case ba.a.zpg:return new Nd(7,57,1.33,1);case ba.a.tng:return new Nd(5,
58,1,1);case ba.a.bpg:return new Nd(9,59,1,1.05);case ba.a.Ong:return new Nd(10,60,1,1.16);case ba.a.Nng:return new Nd(11,61,1,1);case ba.a.Bog:return new Nd(12,62,1,1);case ba.a.nng:return new Nd(13,63,1,1);case ba.a.xng:return new Nd(14,64,1,1);case ba.a.Iog:return new Nd(39,65,1,1);case ba.a.Ymg:return new Nd(87,66,1,1);case ba.a.xpg:return new Nd(35,67,1,1);case ba.a.Kng:return new Nd(83,68,1,1);case ba.a.Lng:return new Nd(84,69,1,1);case ba.a.Rng:return new Nd(85,70,1,1);case ba.a.qng:return new Nd(86,
71,1,1);case ba.a.eng:return new Nd(130,72,1,1);case ba.a.Jog:return new Nd(33,73,1,1);case ba.a.Vmg:return new Nd(73,7,1.33,1);case ba.a.fng:return new Nd(72,8,1.33,1.33);case ba.a.Tmg:return new Nd(82,74,1.14,1.14);case ba.a.yng:return new Nd(41,75,1,1);case ba.a.zog:return new Nd(42,76,1,1);case ba.a.Umg:return new Nd(40,77,1,1);case ba.a.Jng:return new Nd(81,78,1,1);case ba.a.dpg:return new Nd(78,79,1,1);case ba.a.Mng:return new Nd(75,18,1,1);case ba.a.$ng:return new Nd(74,80,1,1);case ba.a.wpg:return new Nd(76,
81,1,1);case ba.a.xog:return new Nd(77,82,1,.5);case ba.a.$mg:return new Nd(120,83,1,1);case ba.a.Qmg:return new Nd(88,84,1,1);case ba.a.Ang:return new Nd(93,85,1,1);case ba.a.zng:return new Nd(94,86,1,1.17);case ba.a.Vng:return new Nd(89,87,1,.08);case ba.a.Vog:return new Nd(90,88,1,.08);case ba.a.Ung:return new Nd(91,89,1,.17);case ba.a.Uog:return new Nd(92,90,1,.17);case ba.a.vog:return new Nd(175,19,1,1);case ba.a.sog:return new Nd(176,20,1,1);case ba.a.tog:return new Nd(177,21,1,1);case ba.a.qog:return new Nd(178,
22,1,1);case ba.a.rog:return new Nd(179,23,1,1);case ba.a.uog:return new Nd(180,24,1,1);case ba.a.z6d:return new Nd(95,12,1,1);case ba.a.A6d:return new Nd(95,13,1,1);case ba.a.B6d:return new Nd(95,14,1,1);case ba.a.x6d:return new Nd(97,26,1,1);case ba.a.w6d:return new Nd(97,155,1,1);case ba.a.y6d:return new Nd(97,156,1,1);case ba.a.u6d:return new Nd(101,25,1,1);case ba.a.t6d:return new Nd(101,153,1,1);case ba.a.v6d:return new Nd(101,154,1,1);case ba.a.Cng:return new Nd(46,0,1.07,.53);case ba.a.Sng:return new Nd(44,
1,.53,1.07);case ba.a.Wng:return new Nd(50,2,.53,1.33);case ba.a.Sog:return new Nd(43,3,.53,1.07);case ba.a.Cpg:return new Nd(45,4,1.07,.53);case ba.a.Epg:return new Nd(51,5,1.33,.53);case ba.a.Yng:return new Nd(53,27,.93,1.33);case ba.a.Rmg:return new Nd(62,28,.95,.89);case ba.a.Bpg:return new Nd(63,29,.96,.97);case ba.a.Zng:return new Nd(52,30,.93,.93);case ba.a.Smg:return new Nd(49,31,.8,.93);case ba.a.jng:return new Nd(67,32,1.33,.8);case ba.a.ing:return new Nd(68,33,1.33,.8);case ba.a.kng:return new Nd(69,
34,.8,1.33);case ba.a.gng:return new Nd(70,46,.8,1.33);case ba.a.upg:return new Nd(47,35,.53,1.07);case ba.a.Aog:return new Nd(48,36,.53,1.07);case ba.a.Hog:return new Nd(36,37,.53,1.07);case ba.a.Xmg:return new Nd(37,38,.53,.53);case ba.a.Tog:return new Nd(56,39,1,1);case ba.a.Dng:return new Nd(58,40,1,1);case ba.a.Tng:return new Nd(55,41,1,1);case ba.a.Dpg:return new Nd(57,42,1,1);case ba.a.Xng:return new Nd(59,43,.63,1.33);case ba.a.Pog:return new Nd(61,44,1.33,1.33);case ba.a.Zmg:return new Nd(64,
45,1.07,1.07);case ba.a.Oog:return new Nd(54,47,1.33,1.33);case ba.a.Qog:return new Nd(4,10,1,1);case ba.a.$og:return new Nd(25,11,1,1);case ba.a.Xog:return new Nd(28,48,1,1);case ba.a.Yog:return new Nd(27,49,1,1);case ba.a.Zog:return new Nd(26,50,1,1);case ba.a.fpg:return new Nd(29,51,1,1);case ba.a.epg:return new Nd(32,52,1,1);case ba.a.gpg:return new Nd(31,53,1,1);case ba.a.hpg:return new Nd(30,54,1,1);case ba.a.Rog:return new Nd(116,91,.67,1);case ba.a.apg:return new Nd(117,6,.67,1);case ba.a.Eog:return new Nd(118,
92,.67,1);case ba.a.bng:return new Nd(119,93,.67,1);case ba.a.aog:return new Nd(104,94,.67,1);case ba.a.eog:return new Nd(105,95,.67,1);case ba.a.iog:return new Nd(106,96,.67,1);case ba.a.bog:return new Nd(107,97,.67,1);case ba.a.fog:return new Nd(108,98,.67,1);case ba.a.jog:return new Nd(109,99,.67,1);case ba.a.cog:return new Nd(110,100,.67,1);case ba.a.gog:return new Nd(111,101,.67,1);case ba.a.kog:return new Nd(112,102,.67,1);case ba.a.dog:return new Nd(113,103,.67,1);case ba.a.hog:return new Nd(114,
104,.67,1);case ba.a.mog:return new Nd(115,105,.67,1);case ba.a.Gng:return new Nd(79,106,1,1);case ba.a.Hng:return new Nd(80,107,1,1);case ba.a.opg:return new Nd(15,108,1,1);case ba.a.ppg:return new Nd(16,15,1,1);case ba.a.qpg:return new Nd(17,109,1,1);case ba.a.rpg:return new Nd(18,110,1,1);case ba.a.spg:return new Nd(19,111,1,1);case ba.a.jpg:return new Nd(20,112,1,1);case ba.a.kpg:return new Nd(21,113,1,1);case ba.a.lpg:return new Nd(22,114,1,1);case ba.a.mpg:return new Nd(23,115,1,1);case ba.a.npg:return new Nd(24,
116,1,1);case ba.a.Fpg:return new Nd(122,117,.67,1.33);case ba.a.Eng:return new Nd(121,118,.67,1.33);case ba.a.lng:return new Nd(124,119,.83,1.33);case ba.a.hng:return new Nd(123,120,.83,1.33);case ba.a.Gpg:return new Nd(126,121,1.25,1.13);case ba.a.Png:return new Nd(127,122,1.13,1.25);case ba.a.Hpg:return new Nd(128,123,1,1);case ba.a.Bng:return new Nd(129,124,1,1);case ba.a.Mog:return new Nd(131,125,.67,1);case ba.a.Pmg:return new Nd(158,126,.67,1);case ba.a.ong:return new Nd(132,127,.67,1);case ba.a.mng:return new Nd(133,
128,.67,1);case ba.a.Kog:return new Nd(134,129,.67,1);case ba.a.Qng:return new Nd(135,130,.67,.67);case ba.a.wng:return new Nd(136,131,.67,1);case ba.a.yog:return new Nd(137,132,.83,1.16);case ba.a.ypg:return new Nd(138,133,.33,1);case ba.a.Log:return new Nd(139,134,.67,1.16);case ba.a.oog:return new Nd(140,135,.5,1);case ba.a.pog:return new Nd(141,136,.67,1);case ba.a.dng:return new Nd(142,137,.5,.5);case ba.a.Cog:return new Nd(159,138,.67,.67);case ba.a.Wmg:return new Nd(143,139,.88,1);case ba.a.Nog:return new Nd(144,
140,.88,1);case ba.a.vpg:return new Nd(145,141,.67,.67);case ba.a.Dog:return new Nd(146,142,.67,.67);case ba.a.cng:return new Nd(147,143,1,.5);case ba.a.ipg:return new Nd(148,144,1,.5);case ba.a.Ing:return new Nd(149,145,.75,.75);case ba.a.wog:return new Nd(150,146,.75,.75);case ba.a.tpg:return new Nd(152,147,.67,1);case ba.a.png:return new Nd(157,148,.67,.67);case ba.a.cpg:return new Nd(153,149,.67,.67);case ba.a.nog:return new Nd(154,150,.67,1);case ba.a.ung:return new Nd(155,151,.75,1);case ba.a.vng:return new Nd(156,
152,.67,1);default:return null}}Rkj(a,b,c){b=this.ra.mg();if(!(b&&0<b.length&&Eq.a.dZk(b)))return 16;if(1===c)return 32;c=this.ta.Ba;if(!c)return 16;if(!this.gl.lI(c,b.length))return this.gl.kJ(c),16;if(this.Xb.Zc(c))return 16;this.eEa.A3g(c,c,b,null,a);return 32}LQe(){try{const a=hb.a.instance.La("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("InsertShapeActivity",null)})}catch(a){ya.a.J(512349783,829,10,"Exception thrown while triggering InsertShapeActivity. Exception: {0}",a)}}}
Jj.TJf=110;Jj.SJf=75;Jj.Tfi=19;Jj.Sfi=38;Jj.tgi=4;Jj.sgi=4;Jj.nOc="InsertShape";Jj.cll=[ba.a.vog,ba.a.sog,ba.a.tog,ba.a.qog,ba.a.rog,ba.a.uog,ba.a.Otb,ba.a.Fng,ba.a.Apg,ba.a.Wog,ba.a.Gog,ba.a.zpg,ba.a.tng,ba.a.bpg,ba.a.Ong,ba.a.Nng,ba.a.Bog,ba.a.nng,ba.a.xng,ba.a.Iog,ba.a.Ymg,ba.a.xpg,ba.a.Kng,ba.a.Lng,ba.a.Rng,ba.a.qng,ba.a.eng,ba.a.Jog,ba.a.Vmg,ba.a.fng,ba.a.Tmg,ba.a.yng,ba.a.zog,ba.a.Umg,ba.a.Jng,ba.a.dpg,ba.a.Mng,ba.a.$ng,ba.a.wpg,ba.a.xog,ba.a.$mg,ba.a.Qmg,ba.a.Ang,ba.a.zng,ba.a.Vng,ba.a.Vog,
ba.a.Ung,ba.a.Uog,ba.a.Qog,ba.a.$og,ba.a.Xog,ba.a.Yog,ba.a.Zog,ba.a.fpg,ba.a.epg,ba.a.gpg,ba.a.hpg,ba.a.Rog,ba.a.apg,ba.a.Eog,ba.a.bng,ba.a.aog,ba.a.eog,ba.a.iog,ba.a.bog,ba.a.fog,ba.a.jog,ba.a.dog,ba.a.hog,ba.a.mog,ba.a.cog,ba.a.gog,ba.a.kog,ba.a.Gng,ba.a.Hng,ba.a.opg,ba.a.ppg,ba.a.qpg,ba.a.rpg,ba.a.spg,ba.a.jpg,ba.a.kpg,ba.a.lpg,ba.a.mpg,ba.a.npg,ba.a.Fpg,ba.a.Eng,ba.a.lng,ba.a.hng,ba.a.Gpg,ba.a.Png,ba.a.Hpg,ba.a.Bng,ba.a.Mog,ba.a.Pmg,ba.a.ong,ba.a.mng,ba.a.Kog,ba.a.Qng,ba.a.wng,ba.a.yog,ba.a.ypg,
ba.a.Log,ba.a.oog,ba.a.pog,ba.a.dng,ba.a.Cog,ba.a.Wmg,ba.a.Nog,ba.a.vpg,ba.a.Dog,ba.a.cng,ba.a.ipg,ba.a.Ing,ba.a.wog,ba.a.tpg,ba.a.png,ba.a.cpg,ba.a.nog,ba.a.ung,ba.a.vng,ba.a.Sog,ba.a.Cng,ba.a.Sng,ba.a.Cpg,ba.a.Epg,ba.a.Wng,ba.a.Yng,ba.a.Rmg,ba.a.Bpg,ba.a.Zng,ba.a.Smg,ba.a.jng,ba.a.ing,ba.a.gng,ba.a.kng,ba.a.upg,ba.a.Aog,ba.a.Hog,ba.a.Xmg,ba.a.Tog,ba.a.Dng,ba.a.Tng,ba.a.Dpg,ba.a.Xng,ba.a.Pog,ba.a.Zmg,ba.a.Oog];Jj.X5c=[ba.a.z6d,ba.a.A6d,ba.a.B6d,ba.a.u6d,ba.a.t6d,ba.a.v6d,ba.a.x6d,ba.a.w6d,ba.a.y6d];
Jj.Y5c=[ba.a.A6d,ba.a.B6d,ba.a.u6d,ba.a.t6d,ba.a.v6d,ba.a.w6d,ba.a.y6d];Jj.rfk=[1,5];Object(e.a)(Jj,"InsertShapeActor",null,[244,106]);class VM{constructor(){this.type="LivePollTaskPaneProps";this.formsUrl=this.onCloseButtonClicked=null}}Object(e.a)(VM,"LivePollTaskPaneProps",null,[]);class WM{constructor(a,b,c,f,l,x,F,R){this.jL=null;this.KEa=this.Ib=!1;a.loadScript("powerpoint-live-strings").then(()=>{this.KEa=!0;ya.a.J(512500544,833,50,"powerpoint-live-strings loaded successfully")}).catch(fa=>
{ya.a.J(512500515,833,10,"Failed to load powerpoint-live-strings "+fa.toString())});if(!b)throw Error.argumentNull("formsDesignPageUrl LivePollPaneActor is null");if(!c)throw Error.argumentNull("formsResultsPageUrl for LivePollPaneActor is null");if(!f)throw Error.argumentNull("actionManager for LivePollPaneActor is null");if(!l)throw Error.argumentNull("actionBlockingManager for LivePollPaneActor is null");if(!x)throw Error.argumentNull("graphTopologyManager for LivePollPaneActor is null");if(!F)throw Error.argumentNull("selectionManager for LivePollPaneActor is null");
if(!R)throw Error.argumentNull("shapeCountValidator for LivePollPaneActor is null");this.W0j=b;this.X0j=c;this.ia=f;this.ta=x;this.Af=l;this.ra=F;this.gl=R;this.cMg=Object(D.a)(this,this.pkl,"taskPaneMessageHandler")}ub(){this.ia.xa(ba.a.tLe,fc.a.application,Object(D.a)(this,this.tLe,"showHideLivePollPane"))}we(){}tLe(a,b,c){return b.contextId===fc.a.application&&this.KEa?1===c?32:sg.a("LivePollPaneToggle",a,()=>{(this.Ib=!this.Ib)?(this.Kl(),ya.a.J(512500514,833,50,"LivePollPaneActor::ShowHideLivePollPane show")):
(this.bK(),ya.a.J(512500513,833,50,"LivePollPanePaneActor::ShowHideLivePollPanePane close"));return 32}):2}Kl(){this.IB();const a=Object.assign(new au.a,{title:ResourceStrings.L_LivePollTaskPane,hideHeader:!1,width:320,location:2,contentProps:this.jL,onOpen:()=>{},onClose:()=>{this.Ib=!1},isModernPane:!0});yj.UISurfaces.Cs().then(b=>{b.showTaskPane("LivePollTaskPaneProps",a);window.addEventListener("message",this.cMg,!1);return null}).catch(b=>{ya.a.J(512500512,833,10,"LivePollPaneActor::ShowPane exception: {0}",
b.toString())})}bK(){yj.UISurfaces.Cs().then(a=>{a.hideTaskPane("LivePollTaskPaneProps",2);window.removeEventListener("message",this.cMg);return null}).catch(a=>{ya.a.J(512500511,833,10,"LivePollPaneActor::ClosePane exception: {0}",a.toString())})}IB(){this.jL=Object.assign(new VM,{onCloseButtonClicked:Object(D.a)(this,this.onCloseButtonClicked,"onCloseButtonClicked"),formsUrl:this.A3i()})}A3i(){return String.format("{0}{1}{2}",this.W0j,"&auth_upn=",u.AFrameworkApplication.fa.Ha("UserPrincipalName"))}onCloseButtonClicked(){this.bK()}pkl(a){if("data"in
a){var b;({Hv:b}=fe.d(a.data)).returnValue&&b&&"type"in b&&"PollCreated"===b.type&&"payload"in b&&(a=b.payload,"formId"in a&&(a=String.format("{0}{1}{2}{3}{4}",this.X0j,"?Id=",a.formId,"&auth_pvr=OrgId&auth_upn=",u.AFrameworkApplication.fa.Ha("UserPrincipalName")),this.Slj(a)))}}Slj(a){const b=this.ta.Ba;if(b&&!this.Af.Zc(b))if(this.gl.lI(b,1)){var c=b.Bb;b.Iyi(c.sid,c.cid,a,b.Qu());b.j2(this.ra.ae())}else this.gl.kJ(b)}}Object(e.a)(WM,"LivePollPaneActor",null,[244]);var QQ=d(935);class Tx{constructor(a,
b,c,f,l,x,F,R,fa,wa,Xa,lb){this.Kz=f;this.Ata=l;this.ia=a;this.Xb=b;this.Fa=c;this.xI=R;this.Yb=x;this.ta=F;this.Hc=fa;this.Nb=wa;this.gua=Xa;this.Qb=lb}ub(){this.ia.xa(ba.a.hgb,fc.a.application,Object(D.a)(this,this.hgb,"showHideNotes"));this.ia.pa(ba.a.o8g,fc.a.application,Object(D.a)(this,this.QCk,"queryNotesPaneState"),96);this.ia.pa(ba.a.x$c,fc.a.application,Object(D.a)(this,this.t2g,"pageScrollNotesPane"),64);this.ia.pa(ba.a.w$c,fc.a.application,Object(D.a)(this,this.t2g,"pageScrollNotesPane"),
64);this.ia.xa(ba.a.DIe,fc.a.application,Object(D.a)(this,this.Bfk,"notesResize"))}we(){const a=this.Fa.Bc(xi.a.B1);a.bindAction(A.KeyInputManager.Na(w.a.gB,0),ba.a.x$c);a.bindAction(A.KeyInputManager.Na(w.a.fB,0),ba.a.w$c)}hgb(a,b,c,f,l){if(this.Qb&&0!==this.Qb.Nu)return 2;a=this.Yb.yf;if(!this.ta.Ba||!a||this.Xb.QP(a))return 16;if(1===c)return 32;l&&Object(Fa.a)(QQ.a,l)?l.rkc?this.Kz.NLe():this.Kz.csj():(this.Kz.ipk(),this.Kz.wTb()&&this.Ata.Ro?this.Fa.Gj(xi.a.B1,!0):this.Fa.Gj(xi.a.B1,!1));this.xI.BQa();
return 32}QCk(a,b,c,f,l){if(!l||!Object(Fa.a)(Ph.a,l))return 8;l.Kf(this.Kz.wTb());return 32}t2g(a,b,c){return 1===c?32:this.Kz?(a===ba.a.w$c?this.Kz.ya.scrollTop+=Tx.aKf:a===ba.a.x$c&&(this.Kz.ya.scrollTop-=Tx.aKf),32):8}Bfk(a,b,c,f,l){ya.a.J(37524685,822,50,"Notes Resize Begin");if(!this.Kz||!l||"number"!==typeof l)return ya.a.J(37524687,822,50,"Notes Resize Fail"),8;this.Kz.Cda=l;this.Hc.Jc.gmh(1);this.Nb.yq();this.gua.Vyl();ya.a.J(37524689,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",
this.Kz.zfk?"On":"Off",this.Kz.Cda);return 32}}Tx.aKf=80;Object(e.a)(Tx,"NotesActor",null,[244]);class XM{constructor(a,b,c,f){this.ia=a;this.S9b=b;this.la=c;this.lKg=0;this.QN=f}we(){}ub(){this.ia.pa(ba.a.RCk,de.a.frame,Object(D.a)(this,this.SCk,"queryOfflineStatusHandler"),2144)}SCk(a,b,c,f,l){if(1===c)return 32;switch(this.S9b.status){case 0:1===this.lKg&&(l[Fq.a.Value]=CommonUIStrings.L_Connected,l[Am.a.labelText]=CommonUIStrings.L_Connected,l[Fq.a.Visible]=!0,this.hideIcon(),Nm.a.instance.Gb(new He.a(2,
1,this.la.offlineLabelTimeoutInMs,()=>{this.Qbl();this.QN.I4("GetOfflineStatus",!1);this.QN.uF()},90,"108")));break;case 2:l[Fq.a.Value]=CommonUIStrings.L_Disconnected;l[Am.a.labelText]=CommonUIStrings.L_Disconnected;l[Fq.a.Visible]=!0;break;case 1:l[Fq.a.Value]=CommonUIStrings.L_Reconnecting,l[Am.a.labelText]=CommonUIStrings.L_Reconnecting,l[Fq.a.Visible]=!0}this.lKg=this.S9b.status;return 32}hideIcon(){this.Pkh(Ii.a.hidden)}Qbl(){this.Pkh(Ii.a.visible)}Pkh(a){const b=document.querySelector("[data-icon-name='SBVBASecurity_16']");
b&&(b.style.visibility=a)}}Object(e.a)(XM,"OfflineStatusLabelActor",null,[244]);class YM{constructor(a,b,c,f,l,x,F,R){this.oJg=!1;this.jfe=null;this.ia=a;this.Af=b;this.xI=c;this.Fa=c.so;this.Db=f;this.ra=l;this.Ea=x;this.Vp=F;this.$Z=R}ub(){this.ia.pa(ba.a.bringForward,fc.a.application,Object(D.a)(this,this.uOc,"handleOrganizeAction"),4);this.ia.pa(ba.a.bringToFront,fc.a.application,Object(D.a)(this,this.uOc,"handleOrganizeAction"),4);this.ia.pa(ba.a.sendBackward,fc.a.application,Object(D.a)(this,
this.uOc,"handleOrganizeAction"),4);this.ia.pa(ba.a.sendToBack,fc.a.application,Object(D.a)(this,this.uOc,"handleOrganizeAction"),4);this.ia.pa(ba.a.Cci,fc.a.application,Object(D.a)(this,this.dhg,"handleFrontBackFlyout"),4);this.ia.pa(ba.a.o_k,fc.a.application,Object(D.a)(this,this.dhg,"handleFrontBackFlyout"),4);u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ee.a("DelayRegisterArrangeShapesAction")?this.jfe=()=>{this.ia.pa(ba.a.wGf,fc.a.application,
Object(D.a)(this,this.Bhg,"handleOrganizeShapeAnchor"),4)}:this.ia.pa(ba.a.wGf,fc.a.application,Object(D.a)(this,this.Bhg,"handleOrganizeShapeAnchor"),4)}we(){const a=this.xI.so.Bc(Nc.a.yg);a.bindAction(A.KeyInputManager.Na(w.a.Jnc,A.KeyInputManager.Fe),ba.a.bringForward);a.bindAction(A.KeyInputManager.Na(w.a.Jnc,A.KeyInputManager.Fe|4),ba.a.bringToFront);a.bindAction(A.KeyInputManager.Na(w.a.Hnc,A.KeyInputManager.Fe),ba.a.sendBackward);a.bindAction(A.KeyInputManager.Na(w.a.Hnc,A.KeyInputManager.Fe|
4),ba.a.sendToBack)}dhg(a,b,c){return 1===c?this.ra.G2()?32:8:32}Bhg(){return this.oJg?32:this.ra.G2()?32:16}uOc(a,b,c){b=this.Vp.presentation;if(!b)throw Error.argumentNull("Presentation is null");let f=this.ra.mg();var l=this.Ea.h6a(f);l&&(this.ra.Tcd(l),f=this.ra.mg());if(!this.ra.G2()||this.Af.NB(f))return 16;if(1===c)return 32;switch(a){case ba.a.bringForward:c=1;break;case ba.a.bringToFront:c=0;break;case ba.a.sendBackward:c=3;break;case ba.a.sendToBack:c=2;break;default:return 8}Mc.a.Cb&&(Mc.a.Cb.Ar=
!1,Mc.a.Cb.Ij=!0);1===f.length?ya.a.J(17598029,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing only one shape."):1<f.length&&ya.a.J(17598031,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing {0} shapes.",f.length);l=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{l.jc(f[0]);l.$c=a;const x=Object(va.a)(123,b.KB(f[0].slideId));this.Oqk(x,f,c)}finally{l&&l.dispose()}return 32}Jdk(a,b){const c=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{const f=this.Vp.Ba,
l=f.JB(a),x=f.JB(b);c.jc(l);this.Kdk(f,l.id,x.id)}finally{c&&c.dispose()}}X4k(){this.oJg=!0;ee.a("DelayRegisterArrangeShapesAction")&&this.jfe&&this.jfe()}Oqk(a,b,c){a&&b&&0<b.length&&ya.a.J(51164099,815,50,"OrganizeShapes has invalid params");let f=Pa.a.clone(a.getValue(bb.a.pA));const l=[];let x=null;Pa.a.pna(b,F=>!F.mh).length||(x=this.Ea.Pr(b[0]))&&(f=Pa.a.clone(x.getValue(bb.a.pA)));for(const F of b)l.push(F.id);a.PYb(c,f,l)&&(x&&x.anchor?x.anchor.Igb(f,1,!1):a.anchor?a.anchor.Igb(f,1,!1):ya.a.J(51164101,
815,50,"slideNode/groupNode should have valid anchor"))}Nqk(a,b,c){var f=this.ra.ae(),l=this.g2i(f,b);a.reverse();b=new Ha.a;f=[];let x=-1,F=!1;for(let fa=0;fa<a.length;fa++){let wa=!1;for(var R of l)if(R.equals(a[fa])){b.add(R);wa=F=!0;break}wa||f.push(a[fa]);c.equals(a[fa])&&(x=fa)}if(F)if(-1===x)ya.a.J(593514880,815,10,"Invalid param endShapeId"),F=!1;else{c=0;R=a.length;for(l=0;c<x;)a[c++]=f[l++];for(let fa of b)a[c++]=fa;for(;c<R;)a[c++]=f[l++]}a.reverse();return F}g2i(a,b){let c=[],f=!1;for(const l of a)l.id.equals(b)&&
(f=!0),c.push(l.id);f||(c=[],c.push(b));return c}Kdk(a,b,c){if(a){var f=Pa.a.clone(a.getValue(bb.a.pA));var l=this.$Z.Eba(b);var x=this.$Z.Eba(c);l=this.Ea.Pr(l);x=this.Ea.Pr(x);l?x===l&&(f=Pa.a.clone(l.getValue(bb.a.pA))):x&&(c=x.id);this.Nqk(f,b,c)&&(ya.a.J(51385985,815,50,"ReorderShapeInSelectionPane : Reorder shape"),l?l.anchor?l.anchor.Igb(f,1,!1):ya.a.J(594023564,815,10,"shapeNode should have valid anchor"):a.anchor?a.anchor.Igb(f,1,!1):ya.a.J(51385987,815,10,"slideNode should have valid anchor"))}else ya.a.J(51385955,
815,10,"MoveShapeOnTopOfShape has invalid params")}}Object(e.a)(YM,"OrganizeShapesActor",null,[244]);class ZM extends Bs.a{constructor(a,b,c,f,l,x,F,R,fa){super();this.d3c=0;this.hg=f;this.tc=R;this.BDg=fa;this.init(a);this.xl("PPTClipboardActionOperation");(a=Object(va.a)(10,F))||(a=new E.DictionaryPropertySet);a.setValue(wm.a.Rb,fa);this.wCa(b,c,l,x,a)}ZPc(){this.sfb(this.hg)}U3a(a){this.fp=a;this.d3c=1}run(){if(0===this.d3c){if(1===this.Rla())return;this.d3c=1}1===this.d3c&&this.BX();this.tc.PCj(this.BDg)&&
this.tc.Cg(!0,this.BDg)}}Object(e.a)(ZM,"PPTClipboardActionOperation",Bs.a,[949,249,250]);var $M=d(363),CE=d(528);class gu{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf,mh){this.ia=a;this.ra=b;this.Fa=c;this.Jz=f;this.fab=l;this.Db=x;this.QGg=F;this.Mb=R;this.Wca=fa;this.bzb=wa;this.Ea=Xa;this.dEa=lb;this.$K=Lb;this.m3j=kc;this.g9b=lc;this.WZj=Ec;this.cJg=Jc;this.sc=Dc;this.vp=Wd;this.$r=xe;this.dQ=Sd;this.Nb=Pe;this.Yb=Ue;this.vN=Ef;this.RTa=dg;this.kT=Mg;
if(ee.a("RulerIndentBugFix")){if(!Bg)throw Error.argumentNull("paragraphIndentationReader");if(!Lf)throw Error.argumentNull("paragraphEditor");}this.K8=Bg;this.yUa=Lf;this.bac=mh}ub(){this.ia.pa(ba.a.ixe,fc.a.application,Object(D.a)(this,this.knj,"handlePopulateFontColorDropdown"),101);this.ia.pa(ba.a.z2g,fc.a.application,Object(D.a)(this,this.mnj,"handlePopulateFontSizeDropdown"),100);this.ia.pa(ba.a.jha,fc.a.application,Object(D.a)(this,this.okj,"handleCommitShapeText"),4);this.ia.pa(ba.a.gad,fc.a.application,
Object(D.a)(this,this.m8g,"queryListCommonLevel"),96);this.ia.pa(ba.a.vad,fc.a.application,Object(D.a)(this,this.m8g,"queryListCommonLevel"),96);this.ia.pa(ba.a.xgc,fc.a.application,Object(D.a)(this,this.l9g,"queryTextListMarkerGallery"),96);this.ia.pa(ba.a.ygc,fc.a.application,Object(D.a)(this,this.l9g,"queryTextListMarkerGallery"),96);this.ia.pa(ba.a.s$c,fc.a.application,Object(D.a)(this,this.Ihg,"handlePopulateListMarkerDropdown"),100);this.ia.pa(ba.a.t$c,fc.a.application,Object(D.a)(this,this.Ihg,
"handlePopulateListMarkerDropdown"),100);this.ia.pa(ba.a.Abe,Fb.a.view,Object(D.a)(this,this.gmj,"handleLineSpacingMenuOpen"),68);this.ia.pa(ba.a.tdk,fc.a.application,Object(D.a)(this,this.omj,"handleMoreFontColors"),96);this.ia.pa(ba.a.p$c,fc.a.application,Object(D.a)(this,this.pmj,"handleMoreFontColorsResponse"),96);this.ia.xa(ba.a.IWa,Fb.a.paragraph,Object(D.a)(this,this.IWa,"queryLineSpacing"));this.ia.xa(ba.a.IWa,Fb.a.view,this.Wca);this.ia.$d(ba.a.IWa,96);this.ia.xa(ba.a.Ila,Fb.a.paragraph,
Object(D.a)(this,this.c0,"setLineSpacing"));this.ia.xa(ba.a.Ila,Fb.a.view,this.Wca);this.ia.$d(ba.a.Ila,68);this.ia.xa(ba.a.$Ga,fc.a.application,Object(D.a)(this,this.$Ga,"populateLineSpacingFlyout"));this.ia.xa(ba.a.y2g,fc.a.application,Object(D.a)(this,this.Mmj,"handlePandoraEscapeKeyPressed"));this.ia.xa(ba.a.Kfb,Fb.a.paragraph,Object(D.a)(this,this.NFf,"applySpacingToParagraph"));this.ia.xa(ba.a.Kfb,Fb.a.view,this.Wca);this.ia.$d(ba.a.Kfb,4);this.ia.xa(ba.a.Jfb,Fb.a.paragraph,Object(D.a)(this,
this.NFf,"applySpacingToParagraph"));this.ia.xa(ba.a.Jfb,Fb.a.view,this.Wca);this.ia.$d(ba.a.Jfb,4);this.ia.xa(ba.a.zia,Fb.a.paragraph,Object(D.a)(this,this.rnb,"applyIndentationToParagraph"));this.ia.xa(ba.a.zia,Fb.a.view,this.Wca);this.ia.$d(ba.a.zia,4);this.ia.xa(ba.a.qGb,Fb.a.paragraph,Object(D.a)(this,this.rnb,"applyIndentationToParagraph"));this.ia.xa(ba.a.qGb,Fb.a.view,this.Wca);this.ia.$d(ba.a.qGb,4);this.ia.xa(ba.a.sGb,Fb.a.paragraph,Object(D.a)(this,this.rnb,"applyIndentationToParagraph"));
this.ia.xa(ba.a.sGb,Fb.a.view,this.Wca);this.ia.$d(ba.a.sGb,4);this.ia.xa(ba.a.uGb,Fb.a.paragraph,Object(D.a)(this,this.rnb,"applyIndentationToParagraph"));this.ia.xa(ba.a.uGb,Fb.a.view,this.Wca);this.ia.$d(ba.a.uGb,4);this.bac&&(this.ia.xa(ba.a.rGb,Fb.a.paragraph,Object(D.a)(this,this.rnb,"applyIndentationToParagraph")),this.ia.xa(ba.a.rGb,Fb.a.view,this.Wca),this.ia.$d(ba.a.rGb,4),this.ia.xa(ba.a.tGb,Fb.a.paragraph,Object(D.a)(this,this.rnb,"applyIndentationToParagraph")),this.ia.xa(ba.a.tGb,Fb.a.view,
this.Wca),this.ia.$d(ba.a.tGb,4));this.ia.pa(ba.a.hxk,fc.a.application,Object(D.a)(this,this.tnj,"handlePowerPointTextAlignmentAnchor"),4);this.ia.pa(ba.a.u5g,fc.a.application,Object(D.a)(this,this.unj,"handlePowerPointTextAnchoringAnchor"),4);this.ia.xa(ba.a.Pla,Fb.a.view,this.bzb);this.ia.xa(ba.a.Ola,Fb.a.view,this.bzb);this.ia.xa(ba.a.Nla,Fb.a.view,this.bzb);this.ia.xa(ba.a.Pla,Fb.a.outline,Object(D.a)(this,this.X2d,"handlePowerPointTextAnchoring"));this.ia.xa(ba.a.Ola,Fb.a.outline,Object(D.a)(this,
this.X2d,"handlePowerPointTextAnchoring"));this.ia.xa(ba.a.Nla,Fb.a.outline,Object(D.a)(this,this.X2d,"handlePowerPointTextAnchoring"));this.ia.$d(ba.a.Pla,4);this.ia.$d(ba.a.Ola,4);this.ia.$d(ba.a.Nla,4);this.ia.xa(ba.a.aEb,Fb.a.view,this.bzb);this.ia.xa(ba.a.aEb,Fb.a.outline,Object(D.a)(this,this.CBe,"queryTextAnchoring"));this.ia.$d(ba.a.aEb,96);this.ia.xa(ba.a.$Db,Fb.a.view,this.bzb);this.ia.xa(ba.a.$Db,Fb.a.outline,Object(D.a)(this,this.CBe,"queryTextAnchoring"));this.ia.$d(ba.a.$Db,96);this.ia.xa(ba.a.ZDb,
Fb.a.view,this.bzb);this.ia.xa(ba.a.ZDb,Fb.a.outline,Object(D.a)(this,this.CBe,"queryTextAnchoring"));this.ia.$d(ba.a.ZDb,96);this.vp&&(this.ia.pa(C.a.OJc,Fb.a.view,Object(D.a)(this,this.qlj,"handleFormatPainterPick"),4),this.ia.pa(ba.a.qWd,Fb.a.view,Object(D.a)(this,this.rjj,"handleApplyFormatToText"),4),this.ia.pa(C.a.Tha,Fb.a.view,Object(D.a)(this,this.plj,"handleFormatPainterCancel"),4),this.dQ.x2h(()=>{this.vN.mSa=this.dQ.yK;this.Nb.updateCommandUI()}))}we(){var a=this.Fa.Bc(Nc.a.sP);const b=
this.Fa.Bc(xi.a.B1),c=this.Fa.Bc(Nc.a.WT),f=A.KeyInputManager.Na(w.a.B0,0);a.bindAction(A.KeyInputManager.Na(w.a.koc,0),ba.a.jha);a.bindAction(f,ba.a.y2g);c.bindAction(f,ba.a.jha);b.bindAction(A.KeyInputManager.Na(w.a.hnd,2),G.a.ze);a.bindAction(A.KeyInputManager.Na(w.a.hnd,2),G.a.ze);this.g9b&&(a.bindAction(A.KeyInputManager.Na(w.a.afa,5),ba.a.HE),a.bindAction(A.KeyInputManager.Na(w.a.t$,5),ba.a.Ry));this.vp&&(a=this.Fa.Bc(xi.a.$C),a.$o(f),a.bindAction(f,C.a.Tha))}qlj(a,b,c){a=this.ra.jq();b=!1;
let f=null,l=this.ra.Oa.kb;const x=!!this.ra.Oa&&this.ra.Oa.nl;x&&(l=this.ra.Oa.ga(0));l&&(f=l.Ua);if(f){switch(f.contextId){case Fb.a.textRange:case Fb.a.paragraph:case Fb.a.endOfParagraph:case Fb.a.Lf:b=!0}b&&fb.SelectionEditor.Pj(f)&&fg.b(f)&&(b=!1);f.contextId===Fb.a.outline&&a.nd&&(b=!0);a&&!a.Pth&&(b=!1)}if(1===c||!b)return b?32:8;6!==this.ia.gq?(this.dQ.yK?ya.a.J(40703699,820,50,"User deactivated the Format Painter button"):(ya.a.J(40703697,820,50,"User activated the Format Painter button"),
this.l4g(l,x,a)),this.dQ.yK=!this.dQ.yK):(ya.a.J(40703701,820,50,"User picked format from keyboard shortcut"),this.l4g(l,x,a));return 32}l4g(a,b,c){this.dQ.m4g(a);var f=a.Ua;const l=Object(va.a)(te.AParagraphNode,f.node);var x=Object(va.a)(547,this.Nb.Ed);let F=null;if(l&&x&&(F=x.zi)){x=this.Db.je(4);const fa=F.ri;x.jc(F);var R=this.Mb.Kc(l);R.mc(8);const wa=this.sc.Sr(R);let Xa=f.Qa,lb=f.Kb-f.Qa;a=!a.Paa&&a.Te.contextId!==Fb.a.endOfParagraph;b?(Xa=0,lb=Ya.ParagraphReader.textLength(l)+1):({selectionStart:Xa,
bjh:lb}=this.CKf(f,l,R,Xa,lb,null,!1),a&&f.contextId===Fb.a.textRange&&lb++);b=this.kT.XBa(fa);f=null;wa&&(R.Ng(16),f=Object(va.a)(125,R.currentNode));R.oC(8);R=Object(va.a)(123,R.currentNode);this.kT.fTe(b,!0,l.sa(ub.a.fDa,!1),R,c,f,null,Xa,lb);(c=fa.Tfc(b))&&F.fwb(c);x.dispose()}}CKf(a,b,c,f,l,x,F){switch(a.contextId){case Fb.a.Lf:l=null;F&&(l=this.RTa.h0b(a))?(l=l.Ua,f=l.Qa,l=l.Kb-l.Qa):(f=0<f?f-1:0,l=1);break;case Fb.a.paragraph:f=0;l=Ya.ParagraphReader.textLength(b)+1;break;case Fb.a.endOfParagraph:f=
Ya.ParagraphReader.textLength(b),l=1}for(c.oC(11);c.mCa();)c.zb(2),(a=Object(va.a)(te.AParagraphNode,c.currentNode))&&(f+=Ya.ParagraphReader.textLength(a)+1),c.oC(11);if(F)for(c=1;c<x.length;c++)if((F=Object(va.a)(Pc.a,x.ga(c)))&&Ya.ParagraphReader.Wd(F.node))switch(F.contextId){case Fb.a.textRange:l+=F.Kb-F.Qa;break;case Fb.a.Lf:l+=1;break;case Fb.a.paragraph:l+=Ya.ParagraphReader.textLength(F.node)+1;break;case Fb.a.endOfParagraph:l+=1}return{selectionStart:f,bjh:l}}rjj(a){if(6===this.ia.gq||this.dQ.yK){ya.a.J(40703703,
820,50,"User applied the Format Painter from command location: {0}",this.ia.gq);const F=this.ra.jq();if(F&&!gu.$Mj(F))return 2;var b=this.ra.Oa.kb;if(b&&b.Ua){var c=b.Ua;const R=Object(va.a)(te.AParagraphNode,c.node);var f=Object(va.a)(547,this.Nb.Ed),l=null;if(R&&f&&(l=f.zi)){f=this.Db.je(15);f.jc(l);f.$c=a;const fa=this.ra.Oa.nl;a=R.sa(ub.a.fDa,!1);if(fa)for(var x of this.ra.Oa)this.dQ.yFf(x);else this.dQ.yFf(b);Mc.a.Cb&&(Mc.a.Cb.Ij=!1,Mc.a.Cb.actionName="FormatPainterApplyToText",Mc.a.Cb.BE=new Date);
const wa=this.Mb.Kc(R);wa.mc(8);x=c.Qa;let Xa=c.Kb-c.Qa;fa?x=Xa=-1:{selectionStart:x,bjh:Xa}=this.CKf(c,R,wa,x,Xa,b,!0);wa.Ng(8);b=Object(va.a)(123,wa.currentNode);c=this.ra.ny();l=this.kT.XBa(l.ri);this.kT.fTe(l,!1,a,b,F,null,c,x,Xa);6!==this.ia.gq&&(this.dQ.yK=!1);f.dispose()}}}return 32}Mmj(a,b,c,f,l){this.vp&&this.ia.Ka(C.a.Tha,c,l);ee.a("PandoraEscapeKeyPressed")&&this.ia.Ka(ba.a.jha,c,l);return 32}plj(){this.vN.mSa&&(this.dQ.yK=!1);return 32}tnj(){return this.nZf()}unj(){return this.nZf()}X2d(a,
b,c){let f=!1;b=this.QGg.jcj(b);var l=this.ra.Po();if(b&&b.Fvb||l)f=!0;if(!f)return 16;if(1===c)return 32;switch(a){case ba.a.Pla:c=0;break;case ba.a.Ola:c=1;break;case ba.a.Nla:c=2;break;default:return 8}if(l)this.ra.uG()?this.$r.O0k(l,c):(b=this.Db.je(15),b.jc(l),b.$c=a,this.$r.N0k(this.ra.Oa,c),b.dispose());else{l=this.Db.je(15);try{l.jc(b),l.$c=a,b.setValue(ub.a.UQ,c)}finally{l&&l.dispose()}}return 32}CBe(a,b,c,f,l){c=!1;b=this.QGg.W9f(b);f=this.ra.Oa;let x=0;const F=this.ra.Po();if(b.Sa(ub.a.UQ)||
F){switch(a){case ba.a.aEb:c=F?({kva:x}=this.sc.Ckd(f)).returnValue&&0===x:0===b.getValue(ub.a.UQ);break;case ba.a.$Db:c=F?({kva:x}=this.sc.Ckd(f)).returnValue&&1===x:1===b.getValue(ub.a.UQ);break;case ba.a.ZDb:c=F?({kva:x}=this.sc.Ckd(f)).returnValue&&2===x:2===b.getValue(ub.a.UQ)}l.Kf(c);return 32}return 8}m8g(a,b,c,f,l){if(this.ra.ku())return l.Kf(!1),32;b=this.dEa.jA(this.ra.Dj);c=!0;for(const x of b)if((b=x.Kk?x.node:null)?(c=this.Mb.Kc(b),c.set(b),c.mc(11),c.Ng(11),c=(b=this.Jz.Fw(c))?a===ba.a.gad?
1===b.listType:a===ba.a.vad?0===b.listType:!1:!1):c=!1,!c)break;l.Kf(c);return 32}l9g(a,b,c,f,l){b=l.LWa;l=l.menuItemId;if(this.ra.ku())return b.Kf(!1),32;f=this.dEa.jA(this.ra.Dj);c=!0;for(const F of f){if(f=F.Kk?F.node:null){var x=this.Mb.Kc(f);x.set(f);x.mc(11);x.Ng(11);if(f=this.Jz.Fw(x)){if(0===l){c=!1;break}a===ba.a.xgc?(c=this.$K.DSa.ga(l).eUb,x=this.$K.DSa.ga(l).$nb,c=f.btb&&0<f.X7.length&&f.X7[0]===c&&f.l7a&&f.font===x):a===ba.a.ygc?(c=this.$K.h6c.ga(l).eJd,c=!!f.propertySet&&f.propertySet.Sa(ub.a.autonumberBulletType)&&
f.propertySet.getValue(ub.a.autonumberBulletType)===c):c=!1}else 0!==l&&(c=!1)}if(!c)break}b.Kf(c);return 32}mnj(a,b,c,f,l){if(1===c)return 32;l.PopulationXML=String.format("<Menu Id='menuFontSize'>\r\n               <MenuSection Id='fontSizes'>\r\n                    <Controls Id='ctrlFontSizes'>\r\n                        <Button MenuItemId='8'  Id='8'  Command='{0}' LabelText='8'/>\r\n                        <Button MenuItemId='9'  Id='9'  Command='{0}' LabelText='9'/>\r\n                        <Button MenuItemId='10' Id='10' Command='{0}' LabelText='10'/>\r\n                        <Button MenuItemId='10.5' Id='10.5' Command='{0}' LabelText='10.5'/>\r\n                        <Button MenuItemId='11' Id='11' Command='{0}' LabelText='11'/>\r\n                        <Button MenuItemId='12' Id='12' Command='{0}' LabelText='12'/>\r\n                        <Button MenuItemId='14' Id='14' Command='{0}' LabelText='14'/>\r\n                        <Button MenuItemId='16' Id='16' Command='{0}' LabelText='16'/>\r\n                        <Button MenuItemId='18' Id='18' Command='{0}' LabelText='18'/>\r\n                        <Button MenuItemId='20' Id='20' Command='{0}' LabelText='20'/>\r\n                        <Button MenuItemId='24' Id='24' Command='{0}' LabelText='24'/>\r\n                        <Button MenuItemId='28' Id='28' Command='{0}' LabelText='28'/>\r\n                        <Button MenuItemId='32' Id='32' Command='{0}' LabelText='32'/>\r\n                        <Button MenuItemId='36' Id='36' Command='{0}' LabelText='36'/>\r\n                        <Button MenuItemId='40' Id='40' Command='{0}' LabelText='40'/>\r\n                        <Button MenuItemId='44' Id='44' Command='{0}' LabelText='44'/>\r\n                        <Button MenuItemId='48' Id='48' Command='{0}' LabelText='48'/>\r\n                        <Button MenuItemId='54' Id='54' Command='{0}' LabelText='54'/>\r\n                        <Button MenuItemId='60' Id='60' Command='{0}' LabelText='60'/>\r\n                        <Button MenuItemId='66' Id='66' Command='{0}' LabelText='66'/>\r\n                        <Button MenuItemId='72' Id='72' Command='{0}' LabelText='72'/>\r\n                        <Button MenuItemId='80' Id='80' Command='{0}' LabelText='80'/>\r\n                        <Button MenuItemId='88' Id='88' Command='{0}' LabelText='88'/>\r\n                        <Button MenuItemId='96' Id='96' Command='{0}' LabelText='96'/>\r\n                     </Controls>\r\n               </MenuSection>\r\n            </Menu>",
"2016320825");return 32}omj(a,b,c,f,l){if(1===c)return this.ia.Ka(ba.a.renderColorPicker,1,l);u.AFrameworkApplication.Ta.Ka(C.a.TDb,2,l);a=new Eb.a(l&&0<=l.fontColor&&16777215>=l.fontColor?l.fontColor:0);b={};b.currentColor=a;b.handleCommand=ba.a.p$c;b.hideAlphaSlider=!0;return this.ia.Ka(ba.a.renderColorPicker,2,b)}pmj(a,b,c,f,l){if(1===c)return this.ia.Ka(ba.a.Ss,c,l);if(!l)return ya.a.J(595186523,820,10,"HandleMoreFontColorsResponse: actionData is null"),16;if(a=eu.a.parse(l.Color))return a=this.ia.Ka(ba.a.Ss,
c,"@"+a.RGBColor),32===a&&this.ia.Ka(ba.a.xza,c,l),a;ya.a.J(595186521,820,10,"HandleMoreFontColorsResponse: failed to parse colorinfo, colorInfo is null");return 8}knj(a,b,c,f,l){if(1===c)return 32;a=(a=this.ra.Ip())?a.Se:null;b=ba.a.mDb;var x=ba.a.p$c;c=this.Yb.yf.J1;if(!l.MenuId||0>Ma.a.sg(l.MenuId).indexOf("floatie")){f=b.toString();x=x.toString();b=Object.assign(new sk.a,{Id:"menuFontColor",MenuSectionList:[]});const F=ee.a("ColorPickerHighlighterFix")?CE.a.themeColors:"Colors";Array.add(b.MenuSectionList,
bl.e(a,F,"Font.Color.Menu.Controls","fontColor","ThemeFontColorPicker",f,0,!this.cJg));Array.add(b.MenuSectionList,bl.d("fontColor","Font.Color.Menu.Controls","fontColor","StandardFontColorPicker",f,!0));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",!1)),Array.add(b.MenuSectionList,bl.c(c,"Recent Colors","Font.Color.Menu.Controls","recentColor","FontRecentColors",x,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",
!0));Array.add(b.MenuSectionList,bl.a("More Font Color","Font.Color.Menu.Controls","862825906",ResourceStrings.l_MoreFontColors,"Color.Menu.MoreFontColors","MoreFontColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFontColorsKeytip));if(ee.a("ColorPickerHighlighterFix")&&(c=new Ts,32===u.AFrameworkApplication.Ta.Ka(C.a.TDb,2,c)&&c&&!c.CZb))if(c=c.fontColor,-1===c)bl.h(b,null,a);else if(c=Ol.i(c)||"",c=eu.a.parse(c))c=Cf.Box4ColorHelper.BBa(c.iJa(),a),bl.h(b,c,a);l.MenuItems=b}else a=
this.WZj.H7f(a,!this.cJg),l.PopulationXML=a.cfi(b,c,ba.a.p$c);return 32}okj(a,b,c){if(!this.ra.lD())return 16;if(1===c)return 32;a=this.ra.ae();if(!a||1!==a.length)return 16;this.ra.selectShape(a[0],!0);this.Fa.Ad();return 32}gmj(){return 32}$Ga(a,b,c,f,l){if(1===c)return 32;a=new sk.a;a.MenuSectionList=[];b=Object.assign(new Si.a,{ControlList:[]});for(c=0;5>c;++c)f=Object.assign(new Py.a,{Id:"buttonLineSpacing"+gu.Bbe[c].replace(".","_"),LabelText:gu.Bbe[c].substring(0,3),ExternalId:"LineSpacingButton"+
gu.Bbe[c].replace(".","_")}),Array.add(b.ControlList,f);Array.add(a.MenuSectionList,b);l.MenuItems=a;return 32}Ihg(a,b,c,f,l){if(1===c)return 32;a=a===ba.a.s$c?1:a===ba.a.t$c?0:14;Mc.a.Cb&&(1===a?Mc.a.Cb.actionName="PowerPointPopulateListMarkerBulletsDropDown":0===a&&(Mc.a.Cb.actionName="PowerPointPopulateListMarkerNumberingsDropDown"));!l.MenuId||0>Ma.a.sg(l.MenuId).indexOf("floatie")?l.MenuItems=this.Qpi(a):l.PopulationXML=this.Rpi(a);return 32}IWa(a,b,c,f,l){var x=l.MenuItemId;a=l.queryResult;
c=l.LineSpacingValue;f=l.LineSpacingUnit;let F=!1;b=this.fab.xV(b.node);x=Md.a.ty(b.lineSpacing.value,x)&&2===b.lineSpacing.Pf;if(-1===c)f=b.lineSpacing.Pf,c=b.lineSpacing.value;else if(c!==b.lineSpacing.value||f!==b.lineSpacing.Pf)c=f=0;0!==f&&(F=x);a.Kf(F);l.LineSpacingUnit=f;l.LineSpacingValue=c;return 32}c0(a,b,c,f,l){if(1===c)return 32;if(void 0===l||null===l)return ya.a.J(8955530,820,10,"PandoraActor::SetLineSpacing - Null action data passed. "),8;c=this.Db.je(15);b=b.node;c.jc(b);c.$c=a;b.setValue(ub.a.ZV,
2);a=l;this.m3j&&(a+=this.Ea.eXd(this.Ea.kn(b)));b.setValue(ub.a.Nw,a);c.dispose();return 32}NFf(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;c=new $M.a(l.Pf,l.value);l=c.Pf;c=c.value;switch(a){case ba.a.Kfb:b.setValue(ub.a.lca,c);b.setValue(ub.a.mja,l);break;case ba.a.Jfb:b.setValue(ub.a.kca,c),b.setValue(ub.a.lja,l)}return 32}rnb(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;l=(new Zu.a(l.Pf,l.value)).ZL;c=this.K8.m7(b).ZL;f=this.K8.sQa(b);switch(a){case ba.a.zia:b.setValue(Bb.a.Il,l);break;
case ba.a.qGb:b.setValue(Bb.a.Mn,l);break;case ba.a.sGb:b.setValue(Bb.a.Mn,-l);break;case ba.a.uGb:b.setValue(Bb.a.Mn,0);break;case ba.a.rGb:this.bac&&b.setValue(Bb.a.Mn,l-c);break;case ba.a.tGb:this.bac&&(this.yUa.Tu.wfb(b,(1===f.specialIndentType?c+f.ZL:c-f.ZL)-l),this.yUa.Tu.wfd(b,1,l))}return 32}Rpi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="menuListMarkersDropDown">');b.append('<MenuSection Id="msListMarkersPosition" ShowMenuSectionSeparator="false" DispalyMode="Menu16">');b.append('<Gallery Id="galleryListMarkersPosition" Width="3" ElementDimensions="Size48by48">');
let c,f,l;switch(a){case 1:c="BulletsLibrary_";f=ba.a.wva;l=ba.a.iHa;break;case 0:c="NumberingLibrary_";f=ba.a.xWa;l=ba.a.Qdb;break;default:c="BulletsLibrary_",f=ba.a.wva,l=ba.a.iHa}for(let x=0;8>x;++x)b.append(String.format('<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" InnerHTML="{3}" Alt="{4}" MenuItemId="{5}" ShouldSetTitle="true" />',c+x,f,l,Ma.a.ie(String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.IZd(a,x),this.HZd(a,x))),this.cag(a,x),x));b.append("</Gallery>");
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}Qpi(a){const b=Object.assign(new sk.a,{Id:"menuListMarkersDropDown",MenuSectionList:[]});Array.add(b.MenuSectionList,this.eBf(a));return b}eBf(a){var b="",c="";let f="",l=ba.a.wva,x=ba.a.iHa;switch(a){case 1:b="Bullets Library";f="BulletsLibrary_";l=ba.a.wva;x=ba.a.iHa;c="BulletLibrarySection";break;case 0:b="Numbering Library",f="NumberingLibrary_",l=ba.a.xWa,x=ba.a.Qdb,c="NumberingLibrarySection"}b=Object.assign(new Si.a,{Id:"msListMarkersPosition",
Title:b,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});c=Object.assign(new uq.a,{Id:"galleryListMarkersPosition",ExternalId:c,ExternalGalleryId:this.XYd(a),Type:5,Width:3,ElementDimensions:"Size48by48",GalleryItems:[]});for(let F=0;8>F;++F)c.GalleryItems.push(this.WYd(a,F,f+F,l.toString(),x.toString(),this.cag(a,F)));Array.add(b.ControlList,c);return b}XYd(a){switch(a){case 1:return"BulletLibraryGallery";case 0:return"NumberingLibraryGallery";default:return""}}WYd(a,b,c,f,l,x){a=
Object.assign(new lz,{LevelInfo:this.O5i(a,b)});a.Id=c;a.Command=f;a.QueryCommand=l;a.Alt=x;a.ShouldSetTitle="true";a.MenuItemId=b.toString();return a}O5i(a,b){const c=[],f={};f.fontFamily=ia.FontUtils.mha("Calibri");if(!b)return Object.assign(new Yk,{textAtLevel:Box4Intl.Box4Strings.L_ListStyleNone,styleAtLevel:f});f.fontFamily=ia.FontUtils.mha(this.eag(a,b));1===a?(a=this.$K.mVc.ga(b).YIf,c.push(Object.assign(new Yk,{textAtLevel:a,styleAtLevel:f})),c.push(Object.assign(new Yk,{textAtLevel:a,styleAtLevel:f})),
c.push(Object.assign(new Yk,{textAtLevel:a,styleAtLevel:f}))):0===a&&(a=this.$K.mVc.ga(b).CVg,c.push(Object.assign(new Yk,{textAtLevel:a[0],styleAtLevel:f})),c.push(Object.assign(new Yk,{textAtLevel:a[1],styleAtLevel:f})),c.push(Object.assign(new Yk,{textAtLevel:a[2],styleAtLevel:f})));return c}cag(a,b){return 1===a?this.$K.Qzg.ga(this.$K.I0b(b)):0===a?this.$K.Qzg.ga(this.$K.BNc(b)):""}HZd(a,b){return b?1===a?(a=this.$K.mVc.ga(b).YIf,this.fHa([a,a,a])):0===a?(a=this.$K.mVc.ga(b).CVg,this.fHa(a)):
"":Box4Intl.Box4Strings.L_ListStyleNone}fHa(a){return a&&3===a.length?String.format('<DIV class="ListNumberPreview" style="padding-left: 2pt; font-size: 9pt; ">{0}{1}{2}</DIV>',this.VBa(a[0]),this.VBa(a[1]),this.VBa(a[2])):""}VBa(a){return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}IZd(a,b){const c=new Sys.StringBuilder;c.append("position: relative; ");b?(c.append("font-family: "),c.append(ia.FontUtils.mha(this.eag(a,
b))),c.append("; "),c.append("font-size: 24pt;")):(c.append("font-size: 12pt; "),c.append("top: 22%;"));c.append("color: black;");return c.toString()}eag(a,b){return 1===a?this.$K.DSa.ga(this.$K.I0b(b)).$nb:0===a?"Calibri":""}nZf(){let a=16;if(this.ra.L7())return 16;const b=this.ra.jq(),c=this.ra.Po();if(b&&b.Fvb||c)a=32;return a}static $Mj(a){return!!a&&(a.Oth||a.nd)}}gu.Bbe=["1.00","1.50","2.00","2.50","3.00"];Object(e.a)(gu,"PandoraActor",null,[244]);var RQ=d(729);class hu{constructor(a,b){this.ntd=
this.a0a=null;this.Ca=a;this.hya=b;if(this.Vie=u.AFrameworkApplication.fa.ka("HandleRaceConditionInHostManagerInit"))this.ntd=RQ.a.create();this.zR=hb.a.instance.La("Common.ISystemInitiatedFeedback")}get NP(){return this.a0a}ub(){this.Ca.pa(G.a.close,de.a.frame,Object(D.a)(this,this.closeDocument,"closeDocument"),2176);this.Ca.pa(G.a.XYb,de.a.frame,Object(D.a)(this,this.XYb,"fileProperties"),128);this.Ca.xa(G.a.kBa,de.a.frame,Object(D.a)(this,this.kBa,"fileSharing"));this.Ca.pa(G.a.copyAndEdit,de.a.frame,
Object(D.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.Ca.pa(G.a.OEb,de.a.frame,Object(D.a)(this,this.OEb,"replyWithChanges"),128);this.Ca.pa(G.a.lLe,de.a.frame,Object(D.a)(this,this.sQi,"fileVersion"),128);this.Ca.xa(G.a.downloadACopy,de.a.frame,Object(D.a)(this,this.downloadACopy,"downloadACopy"));this.Ca.xa(G.a.kIi,de.a.frame,ce.ActionManager.Fg);this.Ca.pa(G.a.wEe,de.a.frame,Object(D.a)(this,this.wEe,"reportAbuseLink"),128);this.Ca.pa(G.a.whd,de.a.frame,Object(D.a)(this,this.Jkc,"signInInternal"),
128);this.Ca.xa(G.a.workflow,de.a.frame,Object(D.a)(this,this.workflow,"workflow"));u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&this.Ca.pa(G.a.fad,de.a.frame,Object(D.a)(this,this.fad,"queryBreadcrumbDocName"),96);this.Ca.pa(G.a.BAe,de.a.frame,Object(D.a)(this,this.BAe,"queryCopyAndEditButton"),96);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.Ca.pa(G.a.yAe,de.a.frame,Object(D.a)(this,this.yAe,"queryBuildVersion"),2144),this.Ca.pa(G.a.iBe,
de.a.frame,Object(D.a)(this,this.iBe,"querySessionId"),2144));this.Ca.xa(G.a.UVb,de.a.frame,Object(D.a)(this,this.UVb,"conversation"));this.hya.execute(Object(D.a)(this,this.$cc,"onHostPostmessengerCreated"));Z.ULS.sendTraceTag(536987588,306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}$cc(a){this.a0a=a;this.Vie&&(this.ntd.instance=a);Z.ULS.sendTraceTag(536987589,306,this.NP?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.NP))}closeDocument(a,
b,c,f,l){a=2===c;c=Qi.h;l&&(c=l);return b&&a&&!this.dBc(c)?8:this.Uni(a,c)}dBc(){return!0}Uni(a,b){if(u.AFrameworkApplication.Aa.gb.qKe("3033402446"))return Z.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),this.Ama(a,Le.a.i2f,!0,{});if(u.AFrameworkApplication.dic&&b&&b===Qi.f)return Z.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),u.AFrameworkApplication.Aa.YN(a,u.AFrameworkApplication.dic);
if(u.AFrameworkApplication.isEmbedded)return a&&Z.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(u.AFrameworkApplication.gOf){if(!a)return 32;Z.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");try{return window.top.close(),32}catch(l){return Z.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",l),8}}let c=u.AFrameworkApplication.oDc;if(!c)return a&&Z.ULS.sendTraceTag(6070361,
306,50,"CloseDocumentInternal - no closeUrl found"),8;b||(b=Qi.h);if(b===Qi.c||b===Qi.h)return u.AFrameworkApplication.Aa.YN(a,c);let f;if(u.AFrameworkApplication.cXa)return a&&Z.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),f=b===Qi.d||b===Qi.b?this.Ama(a,Le.a.OEb,u.AFrameworkApplication.znc,{["event_source"]:b}):2,32!==f?(c=b?cg.a.ej(u.AFrameworkApplication.cXa,Qi.e,b):u.AFrameworkApplication.cXa,u.AFrameworkApplication.Aa.YN(a,c)):f;a&&Z.ULS.sendTraceTag(6070363,
306,50,"CloseDocumentInternal - Using FileClose postmessage");f=b===Qi.b?this.Ama(a,Le.a.i2f,u.AFrameworkApplication.vTe,null):2;return 32!==f?u.AFrameworkApplication.Aa.YN(a,c):f}Jkc(a,b,c,f,l){a=this.Ama(2===c,Le.a.whd,!0,l);8===a&&(window.top.location=u.AFrameworkApplication.signInUrl,a=32);return a}XYb(a,b,c){a=this.Ama(2===c,Le.a.XYb,u.AFrameworkApplication.JCh,null);return 32!==a?u.AFrameworkApplication.Aa.YN(2===c,u.AFrameworkApplication.n2f):a}kBa(a,b,c,f,l){if(1===c)return nz.SessionStatusManager.instance.tia?
8:32;a=G.a.S7k;b=lh.a.create().toString();f={};f.event_source=l;f[Gi.a.akc]=b;var x=l?l.nav:null;x&&(f[Gi.a.V7k]=x);(x=l?l.scenarioId:null)&&(f[Gi.a.W7k]=x);l&&"CopyLink"===l.SourceControlId&&(l.mode="copy",a=G.a.R7k);l&&"ManageAccess"===l.SourceControlId&&(l.mode="manageAccess",a=G.a.T7k);l&&"ShareTopBar"===l.SourceControlId&&(u.AFrameworkApplication.Z5b("CfShareVsInviteA;TfShareVsInviteB;TfShareVsInviteC"),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",
!1)&&hu.hp.raiseEvent(hu.yki));(x=l?l.mode:null)&&(f[Gi.a.U7k]=x);if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShareWithSummaryIsEnabled",!1)){var F=l?l.additionalData:null;F&&(f[Gi.a.r6h]=F)}2===c&&(F={},F[Gi.a.akc]=b,x&&(F.mode=x),Z.ULS.sendTraceTag(38278995,306,50,fe.c(F)));b=this.Ama(2===c,Le.a.f8k,u.AFrameworkApplication.xTe,f);if(32!==b){if(u.AFrameworkApplication.YYb)return l=l?cg.a.ej(u.AFrameworkApplication.YYb,Qi.e,l):u.AFrameworkApplication.YYb,u.AFrameworkApplication.Aa.YN(2===
c,l,!0);Z.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:b})}If.c(a);return b}UVb(a,b,c){return this.Ama(2===c,Le.a.UVb,!0,{})}workflow(a,b,c){a=this.Ama(2===c,Le.a.workflow,u.AFrameworkApplication.DTe,{["WorkflowType"]:u.AFrameworkApplication.$nc});if(32!==a){if(u.AFrameworkApplication.Nmd)return u.AFrameworkApplication.Aa.YN(2===c,u.AFrameworkApplication.Nmd,!0);Z.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",
{["Result"]:a})}return a}wEe(a,b,c){a=2===c;return b&&a&&!this.dBc(Qi.f)?8:u.AFrameworkApplication.Aa.YN(a,u.AFrameworkApplication.dic)}copyAndEdit(a,b,c){a={};2===c&&(a=u.AFrameworkApplication.Aa.gb.c8f());a=this.Ama(2===c,Le.a.copyAndEdit,u.AFrameworkApplication.ICh,a);return 32!==a?u.AFrameworkApplication.Aa.YN(2===c,u.AFrameworkApplication.ZNd,u.AFrameworkApplication.hideHeader):a}downloadACopy(a,b,c){return 1===c?u.AFrameworkApplication.XI||u.AFrameworkApplication.UP||nz.SessionStatusManager.instance.tia?
8:32:u.AFrameworkApplication.Aa.YN(2===c,u.AFrameworkApplication.DOa,!0)}OEb(a,b,c){a=2===c;if(b&&a&&!this.dBc(Qi.d))return 8;b=this.Ama(a,Le.a.OEb,u.AFrameworkApplication.znc,{["event_source"]:Qi.d});return 32!==b?(b=cg.a.ej(u.AFrameworkApplication.cXa,Qi.e,Qi.d),u.AFrameworkApplication.Aa.YN(a,b)):b}sQi(a,b,c){a=this.Ama(2===c,Le.a.tQi,u.AFrameworkApplication.yTe,null);return 32!==a?u.AFrameworkApplication.Aa.YN(2===c,u.AFrameworkApplication.UUd):a}fad(a,b,c,f,l){if(2===c){if(!l)return 8;l.Value=
Ma.a.lG(u.AFrameworkApplication.fu.ux)}return 32}yAe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=u.AFrameworkApplication.instance.xFi}return 32}iBe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=u.AFrameworkApplication.instance.yFi}return 32}Ama(a,b,c,f){return this.Vie?this.ZZk(a,b,c,f):c?a?this.NP.sendMessage(b,f)?32:8:32:2}ZZk(a,b,c,f){return c?a?this.NP?this.NP.sendMessage(b,f)?32:8:(Z.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),
this.ntd.execute(()=>{Z.ULS.sendTraceTag(528234242,306,50,"HostPostmessenger now available. Executing the request.");this.NP.sendMessage(b,f)}),32):32:2}BAe(a,b,c,f,l){if(2===c){if(!l)return 8;u.AFrameworkApplication.fa.ka("IsEditAndReplyFlow")&&(l.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}hu.hp=new qd.a;hu.yki="CheckEditorSuggestions";Object(e.a)(hu,"WebAppFrameCommandUIActor",null,[]);class aN extends hu{constructor(a,b,c,f,l,x,F){super(a,b);this.ou=c;this.GD=f;this.ra=l;this.Ga=x;this.Xa=
F}ub(){super.ub();this.Ga.pptEnablePreviousVersionsOptionForOneDriveConsumer&&this.Ca.xa(ba.a.t5g,de.a.frame,Object(D.a)(this,this.$ye,"pptoShowFileVersion"))}$ye(a,b,c){return 1===c&&this.Xa.aca?2:this.Ca.processAction(G.a.lLe,c)}workflow(a,b,c,f,l){if(1===c)return 32;this.ra.Ph();this.ou.jMe(!0,ResourceStrings.l_Loading,a);ya.a.J(20187205,801,50,"PPT save and launch workflow");this.GD.f2(!1,!0,()=>{this.fii(l)},Object(D.a)(this,this.Xva,"saveFailureCallback"));return 32}dBc(a){return a!==Qi.a||
u.AFrameworkApplication.isEmbedded||u.AFrameworkApplication.gOf||u.AFrameworkApplication.oDc||this.sJj()?!0:(ya.a.J(37007442,306,15,"PptWebAppFrameCommandUIActor::BeforeCloseDocument - CloseUrl is null, fallback to RefreshPage"),this.Ca.Ka(ba.a.refresh,2,{refreshtrigger:"PptWebAppFrameCommandUIActor::BeforeCloseDocument"}),!1)}sJj(){var a=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.oJ);a=u.AFrameworkApplication.S8a&&!!a&&"teams"===a.toLowerCase();return ee.a("ReactDialogsProtocolLaunchingTeamsFix")&&
this.Ga.OSd&&a&&u.AFrameworkApplication.Aa.gb.qKe("3033402446")}fii(a){this.ou.hide();super.workflow(0,null,2,null,a)}Xva(){this.ou.hide();return!1}}Object(e.a)(aN,"PptWebAppFrameCommandUIActor",hu,[]);class bN{constructor(a,b,c){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("focusManager");if(!c)throw Error.argumentNull("presentationReader");this.ia=a;this.Fa=b;this.yc=c}ub(){this.ia.pa(ba.a.Pcd,fc.a.application,Object(D.a)(this,this.Pcd,"replaceFonts"),4)}we(){const a=
[this.Fa.Bc(xi.a.$C),this.Fa.Bc(xi.a.B1),this.Fa.Bc(Nc.a.yg),this.Fa.Bc(Nc.a.sP)];for(const b of a)b.bindAction(A.KeyInputManager.Na(w.a.bKb,A.KeyInputManager.Fe),ba.a.Pcd)}Pcd(a,b,c){return b.contextId!==fc.a.application?2:1===c?this.yc.Nj()?32:8:32}}Object(e.a)(bN,"ReplaceFontsActor",null,[]);var cN=d(1037);class dN extends Sys.EventArgs{constructor(a,b,c){super();this.XVg=a;this.jla=b;this.Uu=c}}Object(e.a)(dN,"RibbonTabSwitchedEventArgs",Sys.EventArgs,[]);class eN{constructor(a,b,c,f,l,x,F,R){if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("frameContext");if(!c)throw Error.argumentNull("ribbonUser");if(!f)throw Error.argumentNull("focusManager");if(!F)throw Error.argumentNull("ribbonExternal");this.Fa=f;this.ia=a;this.xI=b;this.FD=c;this.aEg=l;this.gf=x;this.$Yj=R}ub(){this.ia.xa(G.a.yFe,de.a.frame,Object(D.a)(this,this.tnk,"onRibbonFocus"));this.ia.pa(G.a.uVk,de.a.frame,Object(D.a)(this,this.Aoj,"handleRibbonStateChanged"),64);this.ia.xa(G.a.Zjd,fc.a.application,Object(D.a)(this,this.Zjd,"toggleRibbonState"));
this.ia.xa(G.a.xVk,Fb.a.view,Object(D.a)(this,this.Boj,"handleRibbonTabSwitched"));this.ia.xa(G.a.Fdd,Fb.a.view,Object(D.a)(this,this.Fdd,"ribbonModeToggledToMLR"));this.ia.xa(G.a.Gdd,Fb.a.view,Object(D.a)(this,this.Gdd,"ribbonModeToggledToSLR"));pd.a.get_instance().Xj(7,Object(D.a)(this,this.registerOnShyRibbonStateChange,"registerOnShyRibbonStateChange"))}we(){const a=v.FocusManager.instance().Bc(xi.a.rJf);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.loc,A.KeyInputManager.Fe),G.a.Zjd);y.AFrame.Sj(a,A.KeyInputManager.Na(n.a.ek?
w.a.$ea:w.a.nmd,1),G.a.yFe);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.CJa,n.a.ek?2:1),G.a.yFe);this.$Yj&&(this.xI.Y8a.acd(qa.a.ol,window.document,Object(D.a)(this,this.Rtj,"ignoreAltKeyUpOnDocument")),kE.a.instance().DCf(Object(D.a)(this,this.dmk,"onOnlyAltKeyPressed")))}Fdd(a,b,c){try{if(1===c)return 32;ee.a("ReactMLRReuseSLRCookieForMLR")?this.Ylh(!1):this.Bjc(!0);ya.a.J(512500443,822,50,"[ReactRibbon] - Ribbon mode toggled to MLR");this.xI.BQa()}catch(f){ya.a.J(512500442,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to MLR",
f)}return 32}Gdd(a,b,c){try{if(1===c)return 32;ee.a("ReactMLRReuseSLRCookieForMLR")||this.Bjc(!1);this.Ylh(!0);ya.a.J(512500441,822,50,"[ReactRibbon] - Ribbon mode toggled to SLR");this.xI.BQa()}catch(f){ya.a.J(512500440,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to SLR",f)}return 32}Ylh(a){Hi.a.JL(u.AFrameworkApplication.fa.Ha("IsSimplifiedRibbonOnCookieName"),a.toString(),Hi.a.rL)}Bjc(a){Hi.a.JL(u.AFrameworkApplication.fa.Ha("ReactRibbonMLRPreferenceCookieName"),a.toString(),Hi.a.rL)}Aoj(a,
b,c){if(1===c)return 32;this.xI.BQa();return 32}Zjd(){return 32}Boj(a,b,c,f,l){if(!l)return 8;l&&l.NewContextId!==l.OldContextId&&(a=0,l&&l[Dn.a.Uu]&&(a=l[Dn.a.Uu]),this.gf.KFk(new dN(l.OldContextId,l.NewContextId,a)));this.Fa.ye&&2===l[Dn.a.Uu]&&this.Fa.ye.name===Nc.a.mea&&(b=b.view)&&!Ma.a.Va(b.RH)&&this.Fa.Bf(b.RH);return 32}dmk(){cN.a.instance.keyCode===w.a.BZa&&(appChrome.api.inKeytipMode()?appChrome.api.exitKeytipMode():appChrome.api.enterKeytipMode(),this.Thg())}Rtj(a){return a.lc.keyCode===
w.a.BZa}Thg(){if(document.activeElement&&document.activeElement.id!==qf.a.jVb)return this.Fa.Dwh(!this.aEg.inKeytipMode,!1),32;this.Fa.ye&&this.Fa.Dwh(this.Fa.ye.name===Nc.a.mea||this.aEg.inKeytipMode,!0);return 32}tnk(a,b,c){return 1===c?32:this.Thg()}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.uo&&Ag.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{if(3===a&&3!==b||0===a&&3===b)ya.a.J(512500439,822,50,"[ReactRibbon] - Ribbon shy mode toggled. Relayout the app."),
this.xI.BQa()})}}Object(e.a)(eN,"RibbonStateActor",null,[244]);class dA{constructor(a,b){this.sectionIndex=a;this.slideIndex=b}}Object(e.a)(dA,"SelectSectionAndSlidesData",null,[]);class fN{constructor(a,b,c,f,l){this.NUa=null;this.ia=a;this.Gz=b;this.ta=c;this.C$b=f;this.Xv=l;this.C$b.$F(Object(D.a)(this,this.UA,"onChildTopologyChanged"));this.ta.presentation&&(this.NUa=this.ta.presentation.zp)}ub(){this.ia.pa(ba.a.tch,Fb.a.application,Object(D.a)(this,this.koj,"handleRemoveSection"),4);this.ia.pa(ba.a.BTg,
Fb.a.application,Object(D.a)(this,this.umj,"handleMoveSectionUp"),4);this.ia.pa(ba.a.ATg,Fb.a.application,Object(D.a)(this,this.tmj,"handleMoveSectionDown"),4);this.ia.pa(ba.a.gTe,Fb.a.application,Object(D.a)(this,this.Kpj,"handleUpdateSectionTitle"),4);this.ia.pa(ba.a.Jmb,Fb.a.application,Object(D.a)(this,this.hjj,"handleAddSection"),4)}we(){}Kpj(a,b,c,f,l){if(1===c)return(a=this.ta.presentation)&&a.zp&&a.zp.length?32:8;if(!l)return ya.a.J(50647327,822,10,"HandleUpdateSectionTitle with null action data."),
8;this.Gz.tNi(l);return 32}koj(a,b,c){b=this.ta.oA;const f=this.ta.vaa;if(1===c){const l=this.ta.presentation;if(!l||!l.zp||!l.zp.length)return 8;if(!b&&1<l.zp.length)return f&&!f.LL.length?32:8}if(2===c){ya.a.J(50652321,822,50,"HandleRemoveSection called.");try{f&&this.Gz.mNi(b,a),this.NUa=this.ta.presentation.zp,this.ia.Ka(ba.a.Bed,2,new dA(this.ta.oA,this.ta.Ba.slideIndex))}catch(l){ya.a.J(50689955,822,10,"SectionActor: Exception in HandleRemoveSection: {0}.",l)}}return 32}umj(a,b,c){a=this.ta.oA;
if(1===c)return c=this.ta.presentation,!c||!c.zp||!c.zp.length||0>=a?8:32;if(2===c){ya.a.J(50652323,822,50,"HandleMoveSectionUp called.");try{-1!==a&&(this.Gz.q0f(a,!0),this.ia.Ka(ba.a.Bed,2,new dA(this.ta.oA,this.ta.Ba.slideIndex)))}catch(f){ya.a.J(50856024,822,10,"SectionActor: Exception in HandleMoveSectionUp: {0}.",f)}}return 32}tmj(a,b,c){a=this.ta.oA;if(1===c)return(c=this.ta.presentation)&&c.zp&&c.zp.length&&a!==c.zp.length-1&&-1!==a?32:8;if(2===c){ya.a.J(50652353,822,50,"HandleMoveSectionDown called.");
try{-1!==a&&(this.Gz.q0f(a,!1),this.ia.Ka(ba.a.Bed,2,new dA(this.ta.oA,this.ta.Ba.slideIndex)))}catch(f){ya.a.J(50856027,822,10,"SectionActor: Exception in HandleMoveSectionDown: {0}.",f)}}return 32}hjj(a,b,c){if(2===c){b=-1;c=this.ta.oA;ya.a.J(50676807,822,50,"HandleAddSection called.");try{this.Gz.RMi(this.ta.Ba,a),b=this.ta.oA}catch(f){ya.a.J(50676809,822,10,"SectionActor: Exception in HandleAddSection: {0}.",f)}-1!==b&&b!==c&&this.ia.processAction(ba.a.NQe,2)}return 32}UA(a,b){try{if(34===b.PY&&
!b.node.isDirty){const c=this.NUa?Array.clone(this.NUa):null;this.NUa=Array.clone(this.ta.presentation.zp);if(!c&&this.NUa||c.length<this.NUa.length)2===this.NUa.length&&-1===this.ta.oA&&(this.ta.oA=1),this.Xv?this.Xv.YBe():ya.a.J(51172877,822,10,"SectionActor: graphOperationEventNotifier is null for raising event."),this.ia.processAction(ba.a.NQe,2)}}catch(c){ya.a.J(51144129,822,10,"SectionActor: Exception in OnChildTopologyChanged: {0}.",c)}}dispose(){this.C$b.iO(Object(D.a)(this,this.UA,"onChildTopologyChanged"))}}
Object(e.a)(fN,"SectionActor",null,[244]);var gN=d(617);class hN{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd){if(!Dc)throw Error.argumentNull("viewEventNotifier");this.ia=a;this.Af=b;this.Fa=c;this.iQ=f;this.Yb=l;this.ta=x;this.nb=F;this.YB=R;this.Sb=fa;this.ZSa=wa;this.Ie=Xa;this.Sp=lb;this.a4=Lb;this.Ea=kc;this.EA=lc;this.p9=Ec;this.nta=Jc;this.gf=Dc;this.j2j=Wd}ub(){this.ia.xa(ba.a.Gjd,fc.a.application,Object(D.a)(this,this.tFb,"selectNextSlideHandler"));this.ia.xa(ba.a.Hjd,fc.a.application,
Object(D.a)(this,this.tFb,"selectNextSlideHandler"));this.ia.xa(ba.a.WYa,fc.a.application,Object(D.a)(this,this.tFb,"selectNextSlideHandler"));this.ia.xa(ba.a.VYa,fc.a.application,Object(D.a)(this,this.tFb,"selectNextSlideHandler"));this.ia.xa(ba.a.ehb,fc.a.application,Object(D.a)(this,this.tFb,"selectNextSlideHandler"));this.ia.xa(ba.a.dhb,fc.a.application,Object(D.a)(this,this.tFb,"selectNextSlideHandler"));this.Sp&&(this.ia.xa(ba.a.imc,fc.a.application,Object(D.a)(this,this.Vsb,"handleKeyboardMultiSelectSlides")),
this.ia.xa(ba.a.cmc,fc.a.application,Object(D.a)(this,this.Vsb,"handleKeyboardMultiSelectSlides")),this.ia.xa(ba.a.emc,fc.a.application,Object(D.a)(this,this.Vsb,"handleKeyboardMultiSelectSlides")),this.ia.xa(ba.a.dmc,fc.a.application,Object(D.a)(this,this.Vsb,"handleKeyboardMultiSelectSlides")),this.ia.xa(ba.a.hmc,fc.a.application,Object(D.a)(this,this.Vsb,"handleKeyboardMultiSelectSlides")),this.ia.xa(ba.a.gmc,fc.a.application,Object(D.a)(this,this.Vsb,"handleKeyboardMultiSelectSlides")),this.ia.xa(ba.a.Hih,
fc.a.application,Object(D.a)(this,this.LYk,"selectAllSlidesHandler")),this.ia.xa(ba.a.Yeb,fc.a.application,Object(D.a)(this,this.Doj,"handleScrollSelectedThumbnailsIntoView")));this.ia.xa(ba.a.oFb,fc.a.application,Object(D.a)(this,this.Coj,"handleScrollActiveThumbnailIntoViewSlim"));this.ia.xa(ba.a.rYa,fc.a.application,Object(D.a)(this,this.Rih,"selectNextShapeHandler"));this.ia.xa(ba.a.mHb,fc.a.application,Object(D.a)(this,this.Rih,"selectNextShapeHandler"));this.ia.xa(ba.a.bJb,fc.a.application,
Object(D.a)(this,this.xsl,"unselectShapesHandler"));this.ia.xa(ba.a.Wic,fc.a.application,Object(D.a)(this,this.KYk,"selectAllShapesHandler"));this.ia.xa(ba.a.jnh,fc.a.application,Object(D.a)(this,this.z7k,"shapeEscapeKeyPressedHandler"));this.ia.xa(ba.a.mgb,fc.a.application,Object(D.a)(this,this.EOc,"handleSlideScopeArrowKeyboard"));this.ia.xa(ba.a.ngb,fc.a.application,Object(D.a)(this,this.EOc,"handleSlideScopeArrowKeyboard"));this.ia.xa(ba.a.ogb,fc.a.application,Object(D.a)(this,this.EOc,"handleSlideScopeArrowKeyboard"));
this.ia.xa(ba.a.pgb,fc.a.application,Object(D.a)(this,this.EOc,"handleSlideScopeArrowKeyboard"));this.ia.xa(ba.a.Vrh,fc.a.application,Object(D.a)(this,this.gpj,"handleSpaceKeyPressed"));this.ia.xa(ba.a.t4g,fc.a.application,Object(D.a)(this,this.svk,"playVideoCommandHandler"))}we(){var a=this.Fa.Bc(xi.a.$C);const b=this.Fa.Bc(Nc.a.yg),c=this.Fa.Bc(Nc.a.sP);a.bindAction(A.KeyInputManager.Na(w.a.Bq,0),ba.a.Gjd);a.bindAction(A.KeyInputManager.Na(w.a.Bq,4),ba.a.Hjd);a.bindAction(A.KeyInputManager.Na(w.a.gB,
0),ba.a.WYa);a.bindAction(A.KeyInputManager.Na(w.a.C0,0),ba.a.WYa);a.bindAction(A.KeyInputManager.Na(w.a.fB,0),ba.a.VYa);a.bindAction(A.KeyInputManager.Na(w.a.A0,0),ba.a.VYa);a.bindAction(A.KeyInputManager.Na(w.a.iE,0),ba.a.ehb);a.bindAction(A.KeyInputManager.Na(w.a.tw,0),ba.a.dhb);this.Sp&&(a.bindAction(A.KeyInputManager.Na(w.a.C0,4),ba.a.imc),a.bindAction(A.KeyInputManager.Na(w.a.A0,4),ba.a.cmc),a.bindAction(A.KeyInputManager.Na(w.a.iE,4),ba.a.emc),a.bindAction(A.KeyInputManager.Na(w.a.tw,4),ba.a.dmc),
a.bindAction(A.KeyInputManager.Na(w.a.gB,4),ba.a.hmc),a.bindAction(A.KeyInputManager.Na(w.a.fB,4),ba.a.gmc),a.bindAction(A.KeyInputManager.Na(w.a.GZa,2),ba.a.Hih));b.bindAction(A.KeyInputManager.Na(w.a.gB,0),ba.a.WYa);b.bindAction(A.KeyInputManager.Na(w.a.fB,0),ba.a.VYa);b.bindAction(A.KeyInputManager.Na(w.a.iE,0),ba.a.ehb);b.bindAction(A.KeyInputManager.Na(w.a.tw,0),ba.a.dhb);b.bindAction(A.KeyInputManager.Na(w.a.Bq,0),ba.a.rYa);b.bindAction(A.KeyInputManager.Na(w.a.Bq,4),ba.a.mHb);b.bindAction(A.KeyInputManager.Na(w.a.B0,
0),ba.a.jnh);b.bindAction(A.KeyInputManager.Na(w.a.GZa,2),ba.a.Wic);b.bindAction(A.KeyInputManager.Na(w.a.s5,0),ba.a.mgb);b.bindAction(A.KeyInputManager.Na(w.a.t$,0),ba.a.ngb);b.bindAction(A.KeyInputManager.Na(w.a.afa,0),ba.a.ogb);b.bindAction(A.KeyInputManager.Na(w.a.YX,0),ba.a.pgb);a=A.KeyInputManager.Na(w.a.gB,0);c.$o(a);c.bindAction(a,ba.a.WYa);a=A.KeyInputManager.Na(w.a.fB,0);c.$o(a);c.bindAction(a,ba.a.VYa);b.bindAction(A.KeyInputManager.Na(w.a.xO,0),ba.a.Vrh)}tFb(a,b,c){if(this.iQ.uZ||this.Af.Zc(this.Yb.yf))return 16;
if(1===c)return 32;if(!this.Yb.yf||!this.ta.Ba)return 16;32===this.ia.processAction(ba.a.icc,1)&&this.ia.processAction(ba.a.hcc,2);b=this.$7i(this.ta.Ba,a);if(b===this.ta.Ba.De)return 32;if(this.EA&&a!==ba.a.ehb&&a!==ba.a.dhb&&(a=this.Ie.v2(b),!a||!a.NV))return 16;this.Fa.Xaa===Nc.a.yg&&this.Fa.Ad();return this.Ie.wda(b)}$7i(a,b){a=a.De;const c=this.Sb.Nj();switch(b){case ba.a.VYa:a=Math.min(a+1,c-1);break;case ba.a.Gjd:a=a+1>c-1?0:a+1;break;case ba.a.WYa:a=Math.max(a-1,0);break;case ba.a.Hjd:a=0>
a-1?c-1:a-1;break;case ba.a.ehb:a=0;break;case ba.a.dhb:a=c-1}return a}Vsb(a,b,c){if(this.iQ.uZ||this.Af.Zc(this.Yb.yf)||!this.Yb.yf||!this.ta.Ba)return 16;if(1===c)return 32;32===this.ia.processAction(ba.a.icc,1)&&this.ia.processAction(ba.a.hcc,2);if(1>=this.Sb.Nj())return 32;ya.a.J(34395531,816,50,"Selected multiple Slides by Shift+Up/Down, Shift+Home/End and Shift+PageUp/PageDown");switch(a){case ba.a.imc:case ba.a.cmc:case ba.a.emc:case ba.a.dmc:this.Ipj(a);break;case ba.a.hmc:case ba.a.gmc:this.Lmj(a);
break;default:return ya.a.J(25751680,816,50,"SelectionActor::HandleKeyboardMultiSelectSlides does not recognize this action"),8}return 32}cdj(a,b){const c=[];var f=this.Sb.Nj();for(b=b>f-1?f-1:b;a<=b;a++)(f=this.Sb.XH(a))&&c.push(f);return c}Ipj(a){if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");const b=this.nb.mf();b.sort((Xa,lb)=>Xa.De-lb.De);const c=b[0].De,f=b[b.length-1].De,l=this.ta.Ba.De,x=this.Sb.Nj();var F=[];let R=l,fa=l,wa=l;F=!0;switch(a){case ba.a.imc:1===b.length?wa=R=
0<=l-1?l-1:l:l===c?fa=0<=f-1?f-1:f:c?wa=R=c-1:F=!1;break;case ba.a.cmc:1===b.length?wa=fa=l<x-1?l+1:l:l===c&&f<x-1?wa=fa=f+1:l===c&&f===x-1?F=!1:R=c+1;break;case ba.a.emc:R=0;break;case ba.a.dmc:fa=x-1}if(this.EA&&wa!==l&&(a=this.Ie.v2(wa),!a||!a.NV))return;if(F){F=this.cdj(R,fa);let Xa;(Xa=this.nb).DX.apply(Xa,F);this.Ie.PHa(R===l?fa:R)}}Lmj(a){const b=this.nb.mf();b.sort((fa,wa)=>fa.De-wa.De);const c=b[0].De,f=b[b.length-1].De,l=this.ta.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");const x=
l.De,F=this.Sb.Nj();let R=null;if(!(1>=F)){switch(a){case ba.a.hmc:if(!x)break;(R=this.Sb.XH(x-1))&&1<b.length&&x===f&&this.unb(b)&&this.nb.Nhc(l);break;case ba.a.gmc:x!==F-1&&(R=this.Sb.XH(x+1))&&1<b.length&&x===c&&this.unb(b)&&this.nb.Nhc(l)}if(R){if(this.EA&&(a=R.Ag(this.Ie.Ma),!a||!a.NV))return;this.Yb.Ba=R;this.nb.L2a(R);this.Ie.PHa(R.De)}}}unb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].De-a[b].De)return!1;return!0}Doj(a,b,c){if(!this.Yb.yf||!this.ta.Ba||
this.Af.Zc(this.Yb.yf))return 16;2===c&&this.Ie.Yeb();return 32}Coj(a,b,c){if(!this.Yb.yf||!this.ta.Ba||this.Af.Zc(this.Yb.yf))return 16;2===c&&this.Ie.vGe();return 32}EOc(a,b,c){return this.nb.G2()?this.vmj(a,c):this.Joj(a,c)}Joj(a,b){if(this.Sp&&1!==this.nb.mf().length)return 8;let c;switch(a){case ba.a.mgb:case ba.a.ogb:a=ba.a.VYa;c="ThumbnailPageDownNavigation";break;case ba.a.pgb:case ba.a.ngb:a=ba.a.WYa;c="ThumbnailPageUpNavigation";break;default:return ya.a.J(8955553,816,50,"SelectionActor::HandleSelectSlideKeyboard does not recognize this action"),
8}Mc.a.Cb&&(Mc.a.Cb.actionName=c,Mc.a.Cb.Ij=!1,Mc.a.Cb.Ar=!0);return this.ia.processAction(a,b)}vmj(a,b){switch(a){case ba.a.mgb:a=ba.a.ccc;break;case ba.a.ngb:a=ba.a.dcc;break;case ba.a.ogb:a=ba.a.ecc;break;case ba.a.pgb:a=ba.a.fcc;break;default:return ya.a.J(8955555,816,50,"SelectionActor::HandleMoveShapeKeyboard does not recognize this action"),8}return this.ia.processAction(a,b)}Rih(a,b,c,f,l){if(this.iQ.uZ)return 16;if(1===c)return 32;b=this.ta.Ba;if(!b)return 16;c=b.om();if(!c||!c.length)return 16;
this.Ad();f=this.nb.mg();if(this.nb.yFb){if(c=this.nb.yFb.Ag(this.Yb.VJ.Ma))c.$3d(),c.Sjh(!1);f.length||f.push(this.nb.yFb);this.nb.yFb=null}f&&this.uIa(f,!1);c=null;a===ba.a.rYa?c=l?l:b.x6a(f,!1,0):a===ba.a.mHb&&(c=b.x6a(f,!0,0));if(!c)return Z.ULS.sendTraceTag(587563472,816,10,"SelectionActor.SelectNextShapeHandler: failed to find next shape to select"),16;if(this.j2j){l=Object(va.a)(vz.a,c.Ag(this.Yb.VJ.Ma));if(c.cDa&&l&&a===ba.a.mHb){const x=document.getElementById(gN.a.Vwe+l.E2);if(x&&document.activeElement!==
x)return l.uIa(),x.focus(),32}if(f.length&&(l=f[0],f=Object(va.a)(vz.a,l.Ag(this.Yb.VJ.Ma)),l.cDa&&f&&a===ba.a.rYa&&(a=document.getElementById(gN.a.Vwe+f.E2))&&document.activeElement!==a))return a.focus(),32}return this.r7g(c,b)}KYk(a,b,c){if(this.iQ.uZ)return 16;if(1===c)return 32;a=this.ta.Ba;if(!a)return 16;b=a.om();if(!b.length)return 16;a=[];for(const f of b)(b=Object(va.a)(124,f.Ag(this.Yb.VJ.Ma)))&&b.Kp?b.uIa():(b&&b.shapeNode&&b.shapeNode.yx&&b.$_(!1),a.push(f));this.nb.DXa(a,!0);this.a4.mGk();
this.uIa(a,!0);this.Ad();return 32}LYk(a,b,c){if(1===c)return 32;a=this.ta.presentation;if(!a)throw Error.argumentNull("Presentation is null");a=a.slides||[];if(!a.length)return 16;ya.a.J(34358608,816,50,"Selected All Slides");let f;(f=this.nb).DX.apply(f,a);this.Ie.PHa(this.Sb.Nj()-1);return 32}z7k(a,b,c){if(1===c)return 32;this.ia.processAction(ba.a.V5d,2);this.ia.processAction(ba.a.bJb,2);ee.a("RaiseEscapeKeyPressedEvent")&&this.gf.yEk();return 32}xsl(a,b,c){if(!this.nb.uG())return 16;if(1===c)return 32;
this.YB.wNa();a=this.nb.ae();if(b=this.Ea.h6a(a))return a=this.Ea.er(b),this.r7g(a,this.ta.Ba);this.uIa(a,!1);this.nb.Ph();this.Ad();return 32}gpj(){this.ia.processAction(ba.a.t4g,2);this.nta&&this.ia.processAction(ba.a.TGf,2);return 32}svk(){if(!this.nb.T9h()&&!this.nb.U9h())return 2;const a=this.nb.ae();if(1<a.length)return 2;for(let b=0;b<a.length;b++){const c=this.p9.wQa(a[b]);c&&c.startPlaying()}return 32}r7g(a,b){const c=a.Ag(this.Yb.VJ.Ma);if(c){if(c.Kp)return this.nb.Ph(),c.uIa(),c.Sjh(!0),
c.MQ(),b=null,c.vVc?b=String.format(ResourceStrings.L_CannotEditHint,c.vVc.userName):ya.a.J(19140689,828,10,"Shape is locked but the LockOwner is null. Shape: {0}.",c.shapeNode?c.shapeNode.get_shapeId().toString():""),this.ZSa.T$g(a,b),this.nb.yFb=a,32}else return Z.ULS.sendTraceTag(587563469,816,10,"SelectionActor.SelectNextShapeHandler: ShapeViewElement of next shape is null"),8;this.nb.selectShape(a,!0);(a=b.Ag(this.Yb.VJ.Ma))&&a.$va();c&&(c.uIa(),c.MQ());return 32}Ad(){this.Yb.VJ.So||this.Fa.Ad()}uIa(a,
b){for(const c of a)(a=c.Ag(this.Yb.VJ.Ma))&&(b?a.uIa():a.$3d())}}Object(e.a)(hN,"SelectionActor",null,[244]);class eA{constructor(){this.isHiddenShape=!1;this.shapeName=null;this.shapeId=0;this.key=null;this.isFocussedShape=!1;this.children=null}}Object(e.a)(eA,"SelectionPaneShapeNode",null,[]);var SQ=d(870);class iN{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc){this.K9b=this.uQ=null;a("powerpoint-editor-intl").then(()=>{ya.a.J(512500438,801,50,"Icons and strings script is loaded successfully");
a("selectionPaneManager").then(()=>{ya.a.J(512500437,801,50,"selection Pane Manager script is loaded successfully");this.uQ=selectionPaneManager.FactoryGlobal.getSelectionPaneManagerInstance();this.jMk();fa.X4k()}).catch(Dc=>{ya.a.J(512500436,801,10,"Failed to load selectionPaneManager "+Dc.toString())})}).catch(Dc=>{ya.a.J(512500435,801,10,"Failed to load powerpoint-editor-intl "+Dc.toString())});this.nb=b;this.Nb=c;this.ia=f;this.ta=l;this.Fa=x;this.Oz=F;this.KOg=R;this.D5j=fa;this.Lg=wa;this.od=
Xa;this.Qc=lb;this.f9=Lb;this.xI=kc;this.Ea=lc;this.fC=Ec;this.Db=Jc;this.KBg=!1;this.Lg.WJ(Object(D.a)(this,this.$Va,"onChangeRenderSelectionPane"));this.Lg.Aza(Object(D.a)(this,this.$Va,"onChangeRenderSelectionPane"));this.Qc.QMa(Object(D.a)(this,this.$Va,"onChangeRenderSelectionPane"));this.od.Dza(Object(D.a)(this,this.$Va,"onChangeRenderSelectionPane"));this.Nb.vM(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"));this.RSa=!1;this.YMg=null}dispose(){this.Lg.z4(Object(D.a)(this,this.$Va,"onChangeRenderSelectionPane"));
this.Lg.YWa(Object(D.a)(this,this.$Va,"onChangeRenderSelectionPane"));this.Qc.qeb(Object(D.a)(this,this.$Va,"onChangeRenderSelectionPane"));this.od.seb(Object(D.a)(this,this.$Va,"onChangeRenderSelectionPane"));this.Nb.rX(Object(D.a)(this,this.$v,"onAppFrameModeSwitched"))}we(){const a=this.Fa.Bc(Nc.a.WD);a.bindAction(A.KeyInputManager.Na(w.a.HZa,6),ba.a.bjc);a.bindAction(A.KeyInputManager.Na(w.a.sna,6),ba.a.VTb)}bjc(a){return sg.a("SelectionPaneBringBackward",a,()=>{this.RSa=!0;this.ia.processAction(ba.a.sendBackward,
2);ya.a.J(512500434,822,50,"SelectionPane SendBackwardSelectionPane action is generated");return 32})}VTb(a){return sg.a("SelectionPaneBringForward",a,()=>{this.RSa=!0;this.ia.processAction(ba.a.bringForward,2);ya.a.J(512500433,822,50,"SelectionPane BringForwardSelectionPane action is generated");return 32})}ub(){this.ia.pa(ba.a.Aea,fc.a.application,Object(D.a)(this,this.Aea,"showHideSelectionPane"),4);this.ia.pa(ba.a.Jad,fc.a.application,Object(D.a)(this,this.Jad,"querySelectionPane"),96);this.ia.xa(ba.a.bjc,
fc.a.application,Object(D.a)(this,this.bjc,"sendBackwardSelectionPane"));this.ia.xa(ba.a.VTb,fc.a.application,Object(D.a)(this,this.VTb,"bringForwardSelectionPane"))}Jad(a,b,c,f,l){(a=Object(va.a)(Ph.a,l))&&a.Kf(this.Oz.isVisible);return 32}Aea(a,b,c){return 1===c?this.uQ&&this.ta.Ba?32:8:sg.a("SelectionPaneOpen",a,()=>{this.Oz.isVisible=!this.Oz.isVisible;this.Xdh();this.Oz.isVisible?(this.xI.notesPane&&this.xI.notesPane.wTb()&&this.Fa.Ad(),this.Fa.Gj(Nc.a.WD,!0),this.uQ.focusShowAllButton()):this.Fa.Gj(Nc.a.WD,
!1);return 32})}$v(a){1===a.mode&&this.Oz&&this.Oz.isVisible&&(this.Oz.isVisible=!1,this.Fa.Gj(Nc.a.WD,!1))}Fsi(){const a={};this.K9b=new ua.ScriptSharpLegacyMap;var b=this.ta.Ba,c=b?b.om(!0):null;b=this.nb.mg();const f=new Ha.a;let l=0;if(c){c.reverse();for(const F of c)if(!F.isLocal)if(c=this.Ycg(F,b),F.Mf){if(l++,c=this.Ea.py(F)){c.reverse();for(const R of c){c=this.Ycg(R,b);let fa=null;for(const wa of R.vA){var x=void 0;wa.ShapeId.toString()in a?(x=Object(va.a)(eA,a[wa.ShapeId.toString()]),this.K9b.ga(wa.ShapeId).push(R.get_shapeId())):
(x=[R.get_shapeId()],this.K9b.add(wa.ShapeId,x),x=this.Ibj(wa,b),a[wa.ShapeId.toString()]=x,fa?fa.children.push(x):f.add(x));fa=x}fa.children.push(c)}}}else f.add(c)}0<l&&!this.KBg&&(ya.a.J(512500432,822,50,"SelectionPane Group count:{0}",l),this.KBg=!0);return f}Ycg(a,b){const c=new eA;c.shapeId=a.get_shapeId();c.key=a.get_shapeId().toString();c.shapeName=a.shapeName;c.isHiddenShape=a.isHiddenShape;c.isFocussedShape=Array.contains(b,a);c.children=[];return c}Ibj(a,b){const c=new eA;c.shapeId=a.ShapeId;
c.shapeName=a.ShapeName;c.isHiddenShape=a.IsHidden;c.isFocussedShape=!1;const f=this.ta.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");if(a=f.JB(a.ShapeId))c.isFocussedShape=Array.contains(b,a),c.shapeName=a.shapeName,c.isHiddenShape=a.isHiddenShape;c.children=[];return c}Xdh(){if(!this.ta.Ba)this.Oz.isVisible=!1;else if(this.Oz.isVisible){var a=this.Fsi();if(this.hGf(a?a.toArray():null,this.YMg)){this.YMg=a?a.toArray():null;var b=this.f9.wi("UserAction","SelectionPane Rendering started");
this.uQ.renderSelectionPane(SQ.a.cjh,a.toArray());a=b.Dq.toString();b.stop();ya.a.J(512500430,822,50,"SelectionPane Rendering Completed. Time(in ms) : {0}",a)}else ya.a.J(512500431,822,50,"SelectionPane Rendering not required.")}}hGf(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b||!a.length&&!b.length)return!1;if(a.length!==b.length)return!0;for(let c=0;c<a.length;c++){const f=a[c],l=b[c];if(f||l)if(!f&&l||f&&!l||f.shapeId!==l.shapeId||f.key!==l.key||f.shapeName!==l.shapeName||f.isHiddenShape!==l.isHiddenShape||
f.isFocussedShape!==l.isFocussedShape||this.hGf(f.children,l.children))return!0}return!1}$Va(){this.Xdh();this.RSa&&(this.Oz.isVisible?this.Fa.Gj(Nc.a.WD,!0):this.Fa.Gj(Nc.a.WD,!1));this.RSa=!1}uLe(a,b,c){let f;const l=c.vA.length,x=[];f=!1;for(let F=0;F<l;F++){const R=c.vA[F];R.ShapeId===a&&(2===b?(R.IsHidden=!R.IsHidden,f=R.IsHidden):0===b?f=R.IsHidden=!0:1===b&&(f=R.IsHidden=!1));x.push(R)}return{returnValue:x,VIj:f}}Pji(a){var b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");
var c=this.K9b.ga(a);if(!c||1>=c.length)ya.a.J(512500429,801,10,"There should be atleast 2 child shapes in the nested group");else{var f=b.JB(c[0]);if(f){var l=!1;a=({VIj:l}=this.uLe(a,2,f)).returnValue;for(const x of c){const F=(c=b.JB(x))?Object(va.a)(124,c.oc(this.fC)):null;F&&(l?(F.via(),this.nb.WV(c)&&this.nb.R6(c)):!l&&F.rJa())}b=this.Db.rd(15);try{b.jc(f),f.vA=a}finally{b&&b.dispose()}}else ya.a.J(512500428,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}Zph(a){const b=
this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=b.om(!0),f=[];for(const l of c)if(l.Mf){const x=this.Ea.py(l);f=f.concat.apply(f,x)}if((c=c.concat.apply(c,f))&&c.length){a&&(this.nb.hj(),this.nb.qXb(c));for(const l of c)!a&&l.isHiddenShape?Object(va.a)(124,l.oc(this.fC)).rJa():a&&!l.isHiddenShape&&Object(va.a)(124,l.oc(this.fC)).via();f=this.Db.rd(15);try{f.jc(b);for(const l of c)!a&&l.isHiddenShape?l.isHiddenShape=!1:a&&!l.isHiddenShape&&(l.isHiddenShape=!0);for(let l of this.K9b)if(!b.JB(l.key)){const x=
l.value;if(!x||1>=x.length){ya.a.J(512500427,801,10,"There should be atleast 2 child shapes in the nested group");continue}const F=b.JB(x[0]);F?(c=[],c=a?this.uLe(l.key,0,F).returnValue:this.uLe(l.key,1,F).returnValue,F.vA=c):ya.a.J(512500426,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}finally{f&&f.dispose()}}}jMk(){this.uQ.addCloseSelectionPaneEventListener(()=>{ya.a.J(512500425,822,50,"SelectionPane AddCloseSelectionPaneEventListener event is generated");this.Oz.isVisible=
!1});this.uQ.addFocusSelectionPaneListener(()=>{ya.a.J(512500424,822,50,"SelectionPane AddFocusSelectionPaneListener event is generated");this.Fa.Gj(Nc.a.WD,!0)});this.uQ.addSelectShapeEventListener(a=>{ya.a.J(512500423,822,50,"SelectionPane AddSelectShapeEventListener event is generated");const b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");(a=b.JB(a))&&(a.isHiddenShape||this.nb.selectShape(a,!0))});this.uQ.addSelectMultipleShapesEventListener(a=>{ya.a.J(512500422,822,50,"SelectionPane AddSelectMultipleShapesEventListener event is generated");
const b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");sg.a("SelectionPaneMultiSelect",ba.a.Aea,()=>{if(!a.length){var c=this.nb.ae();this.nb.qXb(c)}c=0;for(const f of a){const l=b.JB(f);l&&!l.isHiddenShape&&(c?this.nb.selectShape(l,!1):(this.nb.selectShape(l,!0),c++))}return 32})});this.uQ.addToggleVisibilityListener(a=>{ya.a.J(512500421,822,50,"SelectionPane ToggleShapeVisibility event is generated");var b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");const c=
b.JB(a);b="";if(!c||c.mh||c.Mf)b="Group";sg.b("SelectionPaneToggleVisibilty",b,ba.a.Aea,()=>{c?this.KOg.Iml(a):this.Pji(a);return 32})});this.uQ.addShapeRenameListener((a,b)=>{ya.a.J(512500420,822,50,"SelectionPane AddShapeRenameListener event is generated");var c=this.ta.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");c=c.JB(a);let f="";if(!c||c.mh||c.Mf)f="Group";sg.b("SelectionPaneRename",f,ba.a.Aea,()=>{this.KOg.d5k(a,b);return 32})});this.uQ.addShapeReorderListener((a,b)=>{ya.a.J(512500419,
822,50,"SelectionPane AddShapeReorderListener event is generated");var c=this.ta.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");const f=c.JB(a);let l="";if(!f||f.mh||f.Mf)l="Group";else if(c=c.JB(b),!c||c.mh||c.Mf)l="Group";sg.b("SelectionPaneReorder",l,ba.a.Aea,()=>{this.D5j.Jdk(a,b);return 32})});this.uQ.addShowAllButtonEventListener(()=>{this.RSa=!0;ya.a.J(512500418,822,50,"SelectionPane ShowOrHideAllShapes event is generated");sg.a("SelectionPaneShowAll",ba.a.Aea,()=>{this.Zph(!1);return 32})});
this.uQ.addHideAllButtonEventListener(()=>{this.RSa=!0;ya.a.J(512500417,822,50,"SelectionPane AddHideAllButtonEventListener event is generated");sg.a("SelectionPaneHideAll",ba.a.Aea,()=>{this.Zph(!0);return 32})});this.uQ.addBringForwardButtonEventListener(()=>{this.RSa=!0;ya.a.J(512500416,822,50,"SelectionPane AddBringForwardButtonEventListener event is generated");sg.a("SelectionPaneBringForward",ba.a.Aea,()=>{this.ia.processAction(ba.a.bringForward,2);return 32})});this.uQ.addBringBackwardButtonEventListener(()=>
{this.RSa=!0;ya.a.J(512500387,822,50,"SelectionPane AddBringBackwardButtonEventListener event is generated");sg.a("SelectionPaneBringBackward",ba.a.Aea,()=>{this.ia.processAction(ba.a.sendBackward,2);return 32})});ya.a.J(512500386,822,50,"SelectionPane RegisterSelectionPaneEventListeners is finished")}}Object(e.a)(iN,"SelectionPaneActor",null,[244]);class jN{constructor(a,b,c,f){this.uca=!1;this.y9b="ShapeAlignToSelectedObjects";this.ia=a;this.Qb=c;this.nb=b;this.e_=f}ub(){ya.a.J(50630811,822,50,
"ShapeAlignmentActor::RegisterActions() - OptIn: True");this.ia.pa(ba.a.F7h,fc.a.application,Object(D.a)(this,this.KQa,"handleShapesAlignment"),4);this.ia.pa(ba.a.v7k,fc.a.application,Object(D.a)(this,this.KQa,"handleShapesAlignment"),4);this.ia.pa(ba.a.NJe,fc.a.application,Object(D.a)(this,this.KQa,"handleShapesAlignment"),4);this.ia.pa(ba.a.mgd,fc.a.application,Object(D.a)(this,this.KQa,"handleShapesAlignment"),4);this.ia.pa(ba.a.OJe,fc.a.application,Object(D.a)(this,this.KQa,"handleShapesAlignment"),
4);this.ia.pa(ba.a.jgd,fc.a.application,Object(D.a)(this,this.KQa,"handleShapesAlignment"),4);this.ia.pa(ba.a.kgd,fc.a.application,Object(D.a)(this,this.KQa,"handleShapesAlignment"),4);this.ia.pa(ba.a.lgd,fc.a.application,Object(D.a)(this,this.KQa,"handleShapesAlignment"),4);this.ia.pa(ba.a.zOa,fc.a.application,Object(D.a)(this,this.cig,"handleShapesDistribution"),4);this.ia.pa(ba.a.KGc,fc.a.application,Object(D.a)(this,this.cig,"handleShapesDistribution"),4);this.ia.pa(ba.a.Pad,fc.a.application,
Object(D.a)(this,this.Pad,"queryShapeAlignToSlide"),96);this.ia.xa(ba.a.dQe,fc.a.application,Object(D.a)(this,this.dQe,"toggleShapeAlignToSlide"));this.ia.pa(ba.a.Oad,fc.a.application,Object(D.a)(this,this.Oad,"queryShapeAlignToSelectedObjects"),96);this.ia.xa(ba.a.cQe,fc.a.application,Object(D.a)(this,this.cQe,"toggleShapeAlignToSelectedObjects"))}we(){}K$d(){return u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp?!0:!1}KQa(a,b,c){if(this.e_){b=this.nb.ae();for(const l of b)if(!l.getValue(ub.a.TRa))return 16}const f=
this.nb.mg();return f?1===c?f.length?32:8:sg.a("Align",a,()=>{ya.a.J(50598728,822,50,"ShapeAlignmentActor::HandleShapesAlignment, Align operation performed");const l=[],x=1===f.length||this.uca?this.Y2f(a):this.X2f(a,f);if(null===x)return ya.a.J(50598730,822,10,"ShapeAlignmentActor::HandleShapesAlignment, error in finding reference point"),16;for(const F of f)l.push(new ov(F,this.w7i(a,F,x)));if(!l[0].shapeNode.mh)for(const F of l)this.Jk(F.shapeNode).setPosition(F.position.x,F.position.y,!0);this.ia.Ka(ba.a.lGa,
2,l);return 32}):(ya.a.J(50598726,822,10,"ShapeAlignmentActor::HandleShapesAlignment, selected nodes: null"),16)}Pad(a,b,c,f,l){if(!l||!Object(Fa.a)(Ph.a,l))return ya.a.J(50598732,822,10,"ShapeAlignmentActor::QueryShapeAlignToSlide Invalid actionData"),8;l.Kf(this.uca);ya.a.J(50598734,822,50,"ShapeAlignmentActor::QueryShapeAlignToSlide: Align to Slide button is selected");return 32}dQe(a,b,c,f,l){a=this.nb.mg();if(1===c)return 2>a.length&&(this.uca=!0,this.y9b="ShapeAlignToSlide",ya.a.J(50598736,
822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide single shape selected, enable Align to slide button")),32;if(!l||"object"!==typeof l)return ya.a.J(50598738,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSlide requires actionData"),8;this.pAh(l)&&(this.uca=!0,ya.a.J(50598740,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide: Align to slide is enabled"));return 32}Oad(a,b,c,f,l){if(!l||!Object(Fa.a)(Ph.a,l))return ya.a.J(50598742,822,10,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects Invalid actionData"),
8;l.Kf(!this.uca);ya.a.J(50598744,822,50,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects: Align Selected Objects button is enabled");return 32}cQe(a,b,c,f,l){a=this.nb.mg();if(1===c)return 1<a.length?32:8;if(!l||"object"!==typeof l)return ya.a.J(50598746,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects requires actionData"),8;this.pAh(l)&&(this.uca=!1,ya.a.J(50598748,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects: Align Selected Objects is enabled"));return 32}w7i(a,
b,c){let f=null;var l=this.Jk(b);b=l.MKc();l=l.As();switch(a){case ba.a.NJe:ya.a.J(50598750,822,50,"ShapeAlignmentActor::ShapeAlignLeft: Align Left is selected ");f=new ad.a(b.x-l.Zb+c,b.y);break;case ba.a.mgd:ya.a.J(50598752,822,50,"ShapeAlignmentActor::ShapeAlignRight: Align Right is selected");f=new ad.a(b.x+(c-l.Vb),b.y);break;case ba.a.OJe:ya.a.J(50598754,822,50,"ShapeAlignmentActor::ShapeAlignTop: Align Top is selected");f=new ad.a(b.x,b.y-l.fc+c);break;case ba.a.jgd:ya.a.J(50598784,822,50,
"ShapeAlignmentActor::ShapeAlignBottom: Align Bottom is selected");f=new ad.a(b.x,b.y+(c-l.Ub));break;case ba.a.kgd:ya.a.J(50598786,822,50,"ShapeAlignmentActor::ShapeAlignCenter: Align Center is selected");f=new ad.a(b.x+(c-l.Uf().x),b.y);break;case ba.a.lgd:ya.a.J(50598788,822,50,"ShapeAlignmentActor::ShapeAlignMiddle: Align Middle is selected"),f=new ad.a(b.x,b.y+(c-l.Uf().y))}return f}cig(a,b,c){const f=this.nb.mg();return f?1===c?!f.length||2===f.length&&!this.uca?8:32:sg.a("Align",a,()=>{ya.a.J(50902275,
822,50,"ShapeAlignmentActor::HandleShapesDistribution, Distribute operation performed");this.JMe(f,a,0,f.length-1);var l=1===f.length||2===f.length||this.uca?this.Y2f(a):this.X2f(a,f);if(null===l)return ya.a.J(527013341,815,10,"ShapeAlignmentActor::HandleShapesDistribution, error in finding reference point"),16;var x=l-this.Phi(a,f);l=this.zhi(f,x);x=this.Dhi(a,f,x,l);this.pHi(a,f,f.length-1,l,x);return 32}):(ya.a.J(50902273,822,10,"ShapeAlignmentActor::HandleShapesDistribution, selected nodes: null"),
16)}Phi(a,b){return a===ba.a.zOa?this.Qhi(b):this.Rhi(b)}Qhi(a){let b=0;for(const c of a)a=this.Jk(c),b+=a.As().Ub-a.As().fc;return b}Rhi(a){let b=0;for(const c of a)a=this.Jk(c),b+=a.As().Vb-a.As().Zb;return b}Dhi(a,b,c,f){if(1===b.length||this.uca)return 0<c?f:0;b=this.Jk(b[0]);return a===ba.a.zOa?b.As().Ub+f:b.As().Vb+f}zhi(a,b){return(1===a.length||this.uca)&&0<b?1*b/(a.length+1):1*b/(a.length-1)}pHi(a,b,c,f,l){var x=0;const F=[];1<b.length&&!this.uca?(ya.a.J(50902277,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Selected Objects"),
x++,c--):ya.a.J(50902279,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Slide");for(a===ba.a.zOa?ya.a.J(50902281,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Vertically"):ya.a.J(50902283,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Horizontally");x<=c;x++){const fa=b[x];if(!fa)continue;let wa=this.Jk(fa);if(wa){var R=wa.MKc();a===ba.a.zOa?(R=new ad.a(R.x,l),F.push(new ov(fa,R)),l+=wa.As().Ub-wa.As().fc+f):(R=new ad.a(l,R.y),F.push(new ov(fa,R)),l+=wa.As().Vb-
wa.As().Zb+f)}}if(F[0]&&!F[0].shapeNode.mh)for(const fa of F)this.Jk(fa.shapeNode).setPosition(fa.position.x,fa.position.y,!0);this.ia.Ka(ba.a.lGa,2,F)}Y2f(a){const b=Object(va.a)(253,this.nb.Ip().oc(this.Qb.Ma));if(!b)return ya.a.J(51500956,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide,Error in finding reference point: SlideViewElement is NULL, ActionID: {0}",a),null;switch(a){case ba.a.mgd:case ba.a.KGc:return b.rC.clientWidth;case ba.a.jgd:case ba.a.zOa:return b.rC.clientHeight;
case ba.a.kgd:return b.rC.clientWidth/2;case ba.a.lgd:return b.rC.clientHeight/2;default:return ya.a.J(51500958,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide, Error in finding reference point, ActionID: {0}",a),0}}X2f(a,b){switch(a){case ba.a.NJe:var c=Number.MAX_VALUE;for(const x of b)b=this.Jk(x),c=Math.min(b.As().Zb,c);return c;case ba.a.mgd:c=-Number.MAX_VALUE;for(const x of b)b=this.Jk(x),c=Math.max(b.As().Vb,c);return c;case ba.a.OJe:c=Number.MAX_VALUE;for(const x of b)b=this.Jk(x),
c=Math.min(b.As().fc,c);return c;case ba.a.jgd:c=-Number.MAX_VALUE;for(const x of b)b=this.Jk(x),c=Math.max(b.As().Ub,c);return c;case ba.a.kgd:var f=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(c of b)b=this.Jk(c),f=Math.min(b.As().Zb,f),l=Math.max(b.As().Vb,l);return f+(l-f)/2;case ba.a.lgd:c=Number.MAX_VALUE;l=-Number.MAX_VALUE;for(f of b)b=this.Jk(f),c=Math.min(b.As().fc,c),l=Math.max(b.As().Ub,l);return c+(l-c)/2;case ba.a.zOa:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(l of b)b=this.Jk(l),c=Math.min(c,
b.As().fc),f=Math.max(b.As().Ub,f);return f-c;case ba.a.KGc:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(const x of b)b=this.Jk(x),c=Math.min(c,b.As().Zb),f=Math.max(b.As().Vb,f);return f-c;default:return ya.a.J(51500960,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSelectedObjects, Error in finding reference point, ActionID: {0}, No of selectedNodes: {1}",a,b.length),null}}JMe(a,b,c,f){if(!(c>=f)){var l=this.Htk(a,b,c,f);this.JMe(a,b,c,l-1);this.JMe(a,b,l+1,f)}}Htk(a,b,c,f){if(b===ba.a.zOa)return this.Jtk(a,
c,f);if(b===ba.a.KGc)return this.Itk(a,c,f);ya.a.J(50902285,822,10,"ShapeAlignmentActor::SortSelectedShapes:PartitionSelectedNodesList, actionId not supported");return-1}Jtk(a,b,c){var f=this.Jk(a[c]).As().Uf().y;let l=b-1;for(;b<=c-1;b++)if(this.Jk(a[b]).As().Uf().y<f){l++;const x=a[l];a[l]=a[b];a[b]=x}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}Itk(a,b,c){var f=this.Jk(a[c]).As().Uf().x;let l=b-1;for(;b<=c-1;b++)if(this.Jk(a[b]).As().Uf().x<f){l++;const x=a[l];a[l]=a[b];a[b]=x}f=a[l+1];a[l+1]=a[c];a[c]=
f;return l+1}pAh(a){const b=a.SourceControlId;return a[ai.a.On]&&this.y9b!==b?(this.uca="ShapeAlignToSelectedObjects"===this.y9b,this.K$d()&&(a={},a[b]="ToggleButtonModel",a[this.y9b]="ToggleButtonModel",Gb.App.Fb.HF(a)),this.y9b=b,!0):!1}Jk(a){return a?Object(va.a)(124,a.oc(this.Qb.Ma)):null}}Object(e.a)(jN,"ShapeAlignmentActor",null,[244]);class Ux{}Object(e.a)(Ux,"CT_NoFillProperties",null,[]);class fA{constructor(a,b){this.Pkl=a;this.Jlc=b}}Object(e.a)(fA,"FormatPainterData",null,[]);var kN=d(713);
class gi{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe){this.Dil="data:image/svg+xml;charset=utf8,";this.lye=96;this.ia=a;this.ra=F;this.fe=f;this.Db=c;this.Fa=b;this.YB=l;this.Xb=x;this.hje=fa;this.vI=R;this.rle=Xa;this.BJg=(a=!Dc||!Dc.isInHighContrastMode)&&Jc.w7d;this.zW=Jc.powerPointGraphicToolTabIsEnabled;this.Xke=a&&Jc.svgIconLocalEditingIsEnabled;this.Fbb=wa;this.fC=Pe;this.Ea=lb;this.dQ=Lb;this.kT=kc;this.Yb=lc;this.ta=Ec;this.sc=Wd;this.vp=Jc.pptTextFormatPainterIsEnabled;
this.zGg=Jc.formatPainterApplyRemappedIsEnabled;this.uJg=Jc.HTc;this.V$a=Jc.Qyk;this.$S=Jc.wDb;this.la=Jc;this.Yi=xe;this.s9b=new ua.ScriptSharpLegacyMap;this.Qz=Sd}ub(){this.ia.pa(ba.a.Fwk,fc.a.application,Object(D.a)(this,this.onj,"handlePopulateShapeFillMenu"),96);this.ia.pa(ba.a.pTg,fc.a.application,Object(D.a)(this,this.nmj,"handleMoreFillColors"),96);this.ia.pa(ba.a.qTg,fc.a.application,Object(D.a)(this,this.smj,"handleMoreOutlineColors"),96);this.ia.pa(ba.a.tTb,fc.a.application,Object(D.a)(this,
this.Ggg,"handleApplyShapeFillColor"),4);this.ia.pa(ba.a.RHd,fc.a.application,Object(D.a)(this,this.yjj,"handleApplyShapeFillCustomColor"),4);this.ia.pa(ba.a.AFf,fc.a.application,Object(D.a)(this,this.Ggg,"handleApplyShapeFillColor"),4);this.ia.pa(ba.a.zDe,fc.a.application,Object(D.a)(this,this.Mhg,"handleRemoveShapeFill"),4);this.ia.pa(ba.a.Wbh,fc.a.application,Object(D.a)(this,this.Mhg,"handleRemoveShapeFill"),4);this.ia.pa(ba.a.Gwk,fc.a.application,Object(D.a)(this,this.pnj,"handlePopulateShapeOutlineMenu"),
96);this.ia.pa(ba.a.snb,fc.a.application,Object(D.a)(this,this.Hgg,"handleApplyShapeOutlineColor"),4);this.ia.pa(ba.a.SHd,fc.a.application,Object(D.a)(this,this.zjj,"handleApplyShapeOutlineCustomColor"),4);this.ia.pa(ba.a.BFf,fc.a.application,Object(D.a)(this,this.Hgg,"handleApplyShapeOutlineColor"),4);this.ia.pa(ba.a.HAc,fc.a.application,Object(D.a)(this,this.Djj,"handleApplyShapeOutlineWidth"),4);this.ia.pa(ba.a.FAc,fc.a.application,Object(D.a)(this,this.Ajj,"handleApplyShapeOutlineDashStyle"),
4);this.uJg&&this.ia.pa(ba.a.VHd,fc.a.application,Object(D.a)(this,this.Cjj,"handleApplyShapeOutlineSketchStyle"),4);this.ia.pa(ba.a.GAc,fc.a.application,Object(D.a)(this,this.Bjj,"handleApplyShapeOutlineEndStyle"),4);this.ia.pa(ba.a.ADe,fc.a.application,Object(D.a)(this,this.Nhg,"handleRemoveShapeOutline"),4);this.ia.pa(ba.a.Xbh,fc.a.application,Object(D.a)(this,this.Nhg,"handleRemoveShapeOutline"),4);this.ia.pa(ba.a.H5a,fc.a.application,Object(D.a)(this,this.Apj,"handleToggleFormatPainterActive"),
4);this.ia.pa(ba.a.Sha,fc.a.application,Object(D.a)(this,this.pjj,"handleApplyFormat"),4);this.ia.pa(ba.a.pWd,fc.a.application,Object(D.a)(this,this.qjj,"handleApplyFormatToShape"),5);this.ia.pa(ba.a.bBe,fc.a.application,Object(D.a)(this,this.Enj,"handleQueryFormatPainter"),97);this.ia.pa(ba.a.Xzk,fc.a.application,Object(D.a)(this,this.vnj,"handlePreviewShapeFillColor"),4);this.ia.pa(ba.a.kVk,fc.a.application,Object(D.a)(this,this.zoj,"handleRevertPreviewShapeFillColor"),4)}we(){const a=this.Fa.Bc(Nc.a.yg);
a.bindAction(A.KeyInputManager.Na(w.a.KJa,6),ba.a.H5a);const b=this.Fa.Bc(Nc.a.sP);let c=A.KeyInputManager.Na(w.a.KJa,6);b.$o(c);this.vp?b.bindAction(c,C.a.OJc):b.bindAction(c,ba.a.H5a);ya.a.J(512500379,815,50,"formatPainterApplyRemapped: {0}",this.zGg);this.zGg||(c=A.KeyInputManager.Na(w.a.dib,6),a.bindAction(c,ba.a.Sha),b.$o(c),this.vp?b.bindAction(c,ba.a.qWd):b.bindAction(c,ba.a.Sha))}asb(a,b){const c=[];if(a)for(const f of a)(f.dsa||b&&f.get_isSVGBlipFilled()||f.qk||this.$S&&1===f.mediaType)&&
Array.add(c,f);return c}j6a(a,b){const c=[];if(a)for(const f of a)(f.dsa&&!f.uy||b&&f.get_isSVGBlipFilled()||this.V$a&&f.nd)&&Array.add(c,f);return c}onj(a,b,c,f,l){if(!this.ra.G2()||this.Xb.NB(this.ra.ae()))return 16;if(1===c)return 32;if(!l)return 8;b=this.ta.presentation;if(!b)throw Error.argumentNull("Presentation is null");a=b.J1;b=(c=this.ra.jq())?b.KB(c.slideId):null;if(!b)return 16;var x=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");c=x?ba.a.AFf:ba.a.tTb;f=x?ba.a.Wbh:ba.a.zDe;const F=ba.a.pTg;
if(l.MenuId&&"fill"===l.MenuId){var R=new kN.a(b.Se);x=new Sys.StringBuilder;x.append(String.format(gi.RJf,"PptRibbon.Drawing.ShapeFill"));if(!b.Se)return 8;x.append(R.$1d(c,a,ba.a.RHd));x.append(gi.ZJf);x.append(String.format(gi.XJf,f,u.AFrameworkApplication.Vl,ResourceStrings.L_RemoveShapeFill,CommonUIStrings.l_RemoveShapeFillKeytip));x.append(gi.YJf);x.append(gi.wgi);x.append(String.format(gi.ugi,F,u.AFrameworkApplication.Vl,ResourceStrings.L_MoreFillColors,CommonUIStrings.l_MoreFillColorsKeytip));
x.append(gi.vgi);x.append(gi.QJf);l.PopulationXML=x.toString()}else{R=Object.assign(new sk.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});const fa=x?"StandardGraphicFillColorPicker":"StandardShapeFillColorPicker",wa=x?"GraphicNoFill":"ShapeNoFill";Array.add(R.MenuSectionList,bl.f(b.Se,CE.a.themeColors,"Color.Menu.Controls","themeColor",x?"ThemeGraphicFillColorPicker":"ThemeShapeFillColorPicker",c.toString(),1));Array.add(R.MenuSectionList,bl.d("Standard Colors","Color.Menu.Controls","standardColor",
fa,c.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!1)),Array.add(R.MenuSectionList,bl.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeFillRecentColors","3745557472",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!0));Array.add(R.MenuSectionList,bl.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor",wa,
"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));Array.add(R.MenuSectionList,bl.a("More Fill Color","Color.Menu.Controls",F.toString(),ResourceStrings.L_MoreFillColors,"Color.Menu.MoreFillColor","MoreFillColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreFillColorsKeytip));ee.a("ColorPickerHighlighterFix")&&(a=this.ubj(b.Se),bl.h(R,a,b.Se));l.MenuItems=R}return 32}pnj(a,b,c,f,l){a=this.ta.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.ra.G2()||
this.Xb.NB(this.ra.ae()))return 16;if(1===c)return 32;if(!l)return 8;c=(c=this.ra.jq())?a.KB(c.slideId):null;if(!c||!c.Se)return 8;a=a.J1;var x=this.fe.Yj("pegal.png"),F=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");b=F?ba.a.BFf:ba.a.snb;f=F?ba.a.Xbh:ba.a.ADe;const R=ba.a.qTg;if(l.MenuId&&"outline"===l.MenuId){var fa=new Sys.StringBuilder;fa.append(String.format(gi.RJf,"PptRibbon.Drawing.ShapeOutline"));c=new kN.a(c.Se);fa.append(c.$1d(b,a,ba.a.SHd));fa.append(gi.ZJf);fa.append(String.format(gi.XJf,
f,u.AFrameworkApplication.Vl,ResourceStrings.L_RemoveShapeOutline,CommonUIStrings.l_RemoveShapeOutlineKeytip));fa.append(gi.YJf);fa.append(gi.zgi);fa.append(String.format(gi.xgi,R,u.AFrameworkApplication.Vl,ResourceStrings.L_MoreOutlineColors,CommonUIStrings.l_MoreOutlineColorsKeytip));fa.append(gi.ygi);c=this.ra.ae();a=gi.Zaj(c,this.zW);if(!a||!a.length||c&&c.length!==a.length)fa.append('<MenuSection Id="OutlineEffects"><Controls Id="OutlineControls">'),fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineWeightAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineWidth_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineWeight">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineWeight" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineWeight.Controls">\r\n                         <Button\r\n                            Id="OutlineWidthPresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ba.a.XHd,ba.a.HAc,u.AFrameworkApplication.Vl,ResourceStrings.L_ApplyShapeOutlineWidth,ResourceStrings.L_ApplyShapeOutlineWidth_1,ResourceStrings.L_ApplyShapeOutlineWidth_2,ResourceStrings.L_ApplyShapeOutlineWidth_3,ResourceStrings.L_ApplyShapeOutlineWidth_4,x,CommonUIStrings.l_ApplyShapeOutlineWidthKeytip)),fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineDashesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_DashStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{8}">\r\n                   <Menu Id="MenuOutlineDashStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineDashStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineDashStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ba.a.THd,ba.a.FAc,u.AFrameworkApplication.Vl,ResourceStrings.L_ApplyShapeOutlineDashStyle,ResourceStrings.L_ApplyShapeOutlineDashStyle_1,ResourceStrings.L_ApplyShapeOutlineDashStyle_2,ResourceStrings.L_ApplyShapeOutlineDashStyle_3,x,CommonUIStrings.l_PPTApplyShapeOutlineDashStyleKeytip)),this.uJg&&fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineSketchesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineSketchy_16x16x32"\r\n                   LabelText="{3}">\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineSketchStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineSketchStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineSketchStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchNone_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleCurve_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleWave_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchIntenseWave_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ba.a.WHd,ba.a.VHd,u.AFrameworkApplication.Vl,ResourceStrings.l_ApplyShapeOutlineSketchStyle,ResourceStrings.l_ApplyShapeOutlineSketchStyle_1,ResourceStrings.l_ApplyShapeOutlineSketchStyle_2,ResourceStrings.l_ApplyShapeOutlineSketchStyle_3,ResourceStrings.l_ApplyShapeOutlineSketchStyle_4,x,CommonUIStrings.l_PPTApplyShapeOutlineSketchStyleKeytip)),fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineArrowsAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_ArrowStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{12}">\r\n                   <Menu Id="MenuOutlineEndStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineEndStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineEndStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,5"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle5_16x16x32"\r\n                            LabelText="{8}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,6"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle6_16x16x32"\r\n                            LabelText="{9}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,7"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle7_16x16x32"\r\n                            LabelText="{10}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ba.a.UHd,ba.a.GAc,u.AFrameworkApplication.Vl,ResourceStrings.L_ApplyShapeOutlineEndStyle,ResourceStrings.L_ApplyShapeOutlineEndStyle_1,ResourceStrings.L_ApplyShapeOutlineEndStyle_2,ResourceStrings.L_ApplyShapeOutlineEndStyle_3,ResourceStrings.L_ApplyShapeOutlineEndStyle_4,ResourceStrings.L_ApplyShapeOutlineEndStyle_5,ResourceStrings.L_ApplyShapeOutlineEndStyle_6,ResourceStrings.L_ApplyShapeOutlineEndStyle_7,x,CommonUIStrings.l_ApplyShapeOutlineEndStyleKeytip)),fa.append("</Controls></MenuSection>");
fa.append(gi.QJf);l.PopulationXML=fa.toString()}else{x=F?"ThemeGraphicOutlineColorPicker":"ThemeShapeOutlineColorPicker";fa=F?"StandardGraphicOutlineColorPicker":"StandardShapeOutlineColorPicker";const wa=F?"GraphicNoOutline":"ShapeNoOutline";F=Object.assign(new sk.a,{Id:"PptRibbon.Drawing.ShapeOutline",MenuSectionList:[]});Array.add(F.MenuSectionList,bl.f(c.Se,"Theme Colors","Color.Menu.Controls","themeColor",x,b.toString(),1));Array.add(F.MenuSectionList,bl.d("Standard Colors","standardColor","Standard Colors",
fa,b.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!1)),Array.add(F.MenuSectionList,bl.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeOutlineRecentColors","1244537109",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!0));Array.add(F.MenuSectionList,bl.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeOutline,"Color.Menu.RemoveColor",
wa,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeOutlineKeytip));Array.add(F.MenuSectionList,bl.a("More Outline Color","Color.Menu.Controls",R.toString(),ResourceStrings.L_MoreOutlineColors,"Color.Menu.MoreOutlineColor","MoreOutlineColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreOutlineColorsKeytip));ee.a("ColorPickerHighlighterFix")&&(a=this.tbj(c.Se),bl.h(F,a,c.Se));l.MenuItems=F}return 32}vnj(a,b,c,f,l){if(!l)return ya.a.J(512500374,815,10,"HandlePreviewShapeFillColor: action data cannot be null."),
8;if(!this.la.yfc)return 2;b=this.ra.mg();const x=this.j6a(b,this.zW);return x&&x.length?this.V$a&&1===x.length&&x[0].nd?(ya.a.J(512500372,815,50,"HandlePreviewShapeFillColor: Preview for table shapes to be handled separately."),32):sg.a("HandlePreviewShapeFillColor:",a,()=>{const F=this.ra.gO(x),R=this.vI.s0(l),fa=Object.assign(new Hz.a,{});fa.solidFillField=R;for(const wa of F)wa?wa.nd||(this.s9b.Jb(wa.get_shapeId())?this.s9b.$(wa.get_shapeId(),wa.fill):this.s9b.add(wa.get_shapeId(),wa.fill),wa.fill=
fa,wa.lea=null):ya.a.J(512500371,822,50,"HandlePreviewShapeFillColor, shape with shape id : {0} is null",wa.get_shapeId());return 32}):(ya.a.J(512500373,815,50,"HandlePreviewShapeFillColor: No shape is selected to show preview color."),16)}zoj(a,b,c,f,l){if(!l)return ya.a.J(512500370,815,10,"HandleRevertPreviewShapeFillColor: action data cannot be null."),8;if(!this.la.yfc)return 2;a=this.ra.mg();a=this.j6a(a,this.zW);if(!a||!a.length)return ya.a.J(512500369,815,50,"HandleRevertPreviewShapeFillColor: No shape is selected to show preview color."),
16;if(this.V$a&&1===a.length&&a[0].nd)return ya.a.J(512500368,815,50,"HandleRevertPreviewShapeFillColor: Preview for table shapes to be handled separately."),32;a=this.ra.gO(a);for(const x of a)if(!x)ya.a.J(512500367,822,50,"HandleRevertPreviewShapeFillColor, shape with shape id : {0} is null",x.get_shapeId());else if(!x.nd)if(this.s9b.Jb(x.get_shapeId()))x.fill=this.s9b.ga(x.get_shapeId()),x.lea=null;else return ya.a.J(512500366,815,10,"HandleRevertPreviewShapeFillColor: last applied shape fill color cannot be empty."),
8;return 32}Ggg(a,b,c,f,l){var x=this.ta.presentation;if(!x)throw Error.argumentNull("Presentation is null");f=this.ra.mg();b=this.j6a(f,this.zW);const F={type:"ColorPickerPayload",color:""};l&&(F.color=l.Color);if(!(b&&0<b.length||this.ra.GK()&&this.Twg(f[0],a,F))||this.Xb.NB(b))return 16;const R=this.ra.jq();x=R?x.KB(R.slideId):null;if(!x||!x.Se||!x.Se.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;if(this.V$a&&1===b.length&&b[0].nd)return ya.a.J(512500364,815,50,"HandleApplyShapeFillColor: send PowerPointCellShadingColor"),
this.ia.Ka(ba.a.xva,c,l);c=gi.uec(l);if(!c)return 8;1<f.length?ya.a.J(512500362,815,50,"HandleApplyShapeFillColor: Apply shape fill color on {0} selected shapes.",f.length):ya.a.J(512500361,815,50,"HandleApplyShapeFillColor: Apply shape fill color on one selected shape.");for(var fa of f)if(fa.Mf||fa.mh){Qn(fa);break}if(this.ra.GK()&&this.Twg(f[0],a,F)&&this.H2d(f[0],a,F))return 32;fa=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{fa.jc(b[0]);fa.$c=a;const wa=this.vI.s0(l),Xa=this.ra.gO(b);
for(const lb of Xa)if(lb.nd){if(!this.V$a)continue;ya.a.J(512500360,815,50,"HandleApplyShapeFillColor: Process table");const Lb=this.sc.XM(lb);if(!Lb){ya.a.J(512500359,815,10,"HandleApplyShapeFillColor: Table Node from shape is null");continue}const kc=Lb.D0b();for(const lc of kc){const Ec=lc.cellShading;Jx(Ec);Ec.solidFillField=wa;lc.cellShading=Ec}}else{const Lb=this.A_f(lb);Lb&&(this.vI.ROa(Lb),Lb.solidFillField=wa,lb.fill=Lb,lb.lea=null,this.ZBh(lb,Lb));lb.eYa=JSON.stringify(c);this.MFb(lb)}}finally{fa&&
fa.dispose()}return 32}nmj(a,b,c,f,l){if(1===c)return this.ia.Ka(ba.a.renderColorPicker,1,l);a=this.sbj();b={};b.currentColor=a;b.handleCommand=ba.a.RHd;return this.ia.Ka(ba.a.renderColorPicker,2,b)}yjj(a,b,c,f,l){if(1===c)return this.ia.Ka(ba.a.tTb,c,l);if(!l)return ya.a.J(512500358,815,10,"HandleApplyShapeFillCustomColor: actionData is null"),16;a=this.ia.Ka(ba.a.tTb,c,l);32===a&&this.ia.Ka(ba.a.xza,c,l);return a}smj(a,b,c,f,l){a=this.ra.mg();a=ee.a("FixColorPickerPictureBorderColor")?this.asb(a,
this.zW):this.j6a(a,this.zW);a=this.ra.gO(a);if(1===c)return this.ia.Ka(ba.a.renderColorPicker,1,l);c=null;1===a.length&&a[0].ysa&&(c=Cf.Box4ColorHelper.Wqa(a[0].ysa));l={};l.currentColor=c;l.handleCommand=ba.a.SHd;return this.ia.Ka(ba.a.renderColorPicker,2,l)}Mhg(a,b,c,f,l){f=this.ra.mg();b=this.j6a(f,this.zW);const x=!!b&&0<b.length;if(this.Xb.NB(b))return 16;if(1===c)return x?32:8;if(!x)return 16;1<f.length?ya.a.J(512500357,815,50,"HandleRemoveShapeFill: Remove shape fill on {0} selected shapes.",
f.length):ya.a.J(512500356,815,50,"HandleRemoveShapeFill: Remove shape fill on one selected shape.");if(this.V$a&&1===b.length&&b[0].nd)return ya.a.J(512500355,815,50,"HandleRemoveShapeFill: send PowerPointRemoveCellShading"),this.ia.Ka(ba.a.yWa,c,l);c=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{c.jc(b[0]);c.$c=a;const F=this.ra.gO(b);for(const R of F)if(R.nd){if(!this.V$a)continue;ya.a.J(512500354,815,50,"HandleRemoveShapeFill: Process table");const fa=this.sc.XM(R);if(!fa){ya.a.J(512500353,
815,10,"HandleRemoveShapeFill: Table Node from shape is null");continue}const wa=fa.D0b();for(const Xa of wa){const lb=Xa.cellShading;Jx(lb);lb.noFillField=new Ux;Xa.cellShading=lb}}else{const fa=this.A_f(R);fa&&(this.vI.ROa(fa),fa.noFillField=new Ux,R.fill=fa,R.lea=null,this.ZBh(R,fa));R.ANk();this.MFb(R)}}finally{c&&c.dispose()}return 32}Hgg(a,b,c,f,l){var x=this.ta.presentation;if(!x)throw Error.argumentNull("Presentation is null");f=this.ra.mg();b=this.asb(f,this.zW);if(!(b&&0<b.length)||this.Xb.NB(b))return 16;
const F=this.ra.jq();x=F?x.KB(F.slideId):null;if(!x||!x.Se||!x.Se.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;c=gi.uec(l);if(!c)return 8;1<f.length?ya.a.J(512500322,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on {0} selected shapes.",f.length):ya.a.J(512500321,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on one selected shape.");for(var R of f)if(R.Mf||R.mh){Qn(R);break}R=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{R.jc(b[0]);
R.$c=a;const fa=this.ra.gO(b);for(const wa of fa){const Xa=this.qTd(wa);if(Xa){this.vI.ROa(Xa);const lb=this.vI.s0(l);Xa.solidFillField=lb;wa.lineStyle=Xa;wa.ysa=null;this.Ild(wa,Xa)}wa.Ufb=JSON.stringify(c);this.MFb(wa)}}finally{R&&R.dispose()}return 32}zjj(a,b,c,f,l){if(1===c)return this.ia.Ka(ba.a.snb,c,l);if(!l)return ya.a.J(512500320,815,10,"HandleApplyShapeOutlineCustomColor: actionData is null"),16;a=this.ia.Ka(ba.a.snb,c,l);32===a&&this.ia.Ka(ba.a.xza,c,l);return a}Djj(a,b,c,f,l){f=this.ra.mg();
b=this.asb(f,this.zW);if(!(b&&0<b.length)||this.Xb.NB(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.HNc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(c>=gi.Bhh.length||0>c)return 8;1<f.length?ya.a.J(512500317,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on {0} selected shapes.",f.length):ya.a.J(512500316,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on one selected shape.");l=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{l.jc(b[0]);
l.$c=a;const x=this.ra.gO(b);for(const F of x){const R=this.qTd(F);R&&(R.wField=gi.XWk[c],R.wFieldSpecified=!0,this.Ild(F,R),this.r_f(R),F.lineStyle=R);F.outlineWidth=gi.Bhh[c];this.MFb(F)}}finally{l&&l.dispose()}return 32}MFb(a){this.Ea.FK(a)&&Mc.a.Cb&&(Mc.a.Cb.Ij=!0)}A_f(a){if(!this.BJg)return null;let b=a.fill;b||!a.FK&&!a.get_isSVGBlipFilled()||(b=new Hz.a);return b}qTd(a){var b=this.ta.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(!this.BJg)return null;let c=a.lineStyle;
if(this.Xke&&a.rTc()&&c&&c.wFieldSpecified){b=Object(va.a)(123,b.KB(a.slideId));var f=this.Yi.ZF;b&&b.uw&&null!=b.uw.Fr&&(f=b.uw.Fr);b=c.wField/f;f=this.k0b(a);if(!f||!f.iNa||!f.XAc)return c.wField=b,c;var l;(l=f.zk&&f.zk.yG&&f.zk.yG.AK()&&1===f.zk.yG.ya.childNodes.length?f.zk.yG.ya.childNodes[0].getAttribute("width"):f.iNa.getAttribute("width"))&&!Ma.a.Va(l.toString())&&(l=parseFloat(l.toString()),isNaN(l)||(f=Math.sqrt(l*l/(f.Kai*f.XAc)),1E-6<f&&(b/=f)));c.wField=b}c||!a.FK&&!a.get_isSVGBlipFilled()||
(c=new bA);return c}r_f(a){if(a.noFillField||Iz(a))a.noFillField=null,a.solidFillField=Object.assign(new zh.a,{schemeClrField:Object.assign(new Nl.a,{valField:1})})}Ajj(a,b,c,f,l){f=this.ra.mg();b=this.asb(f,this.zW);if(!(b&&0<b.length)||this.Xb.NB(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.HNc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return 8;1<f.length?ya.a.J(512500313,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on {0} selected shapes.",
f.length):ya.a.J(512500312,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on one selected shape.");l=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{l.jc(b[0]);l.$c=a;const x=this.ra.gO(b);for(const F of x){const R=this.qTd(F);R&&(R.prstDashField=R.prstDashField||new cA,R.prstDashField.valField=this.b$i(c),R.prstDashField.valFieldSpecified=!0,R.custDashField=null,this.Ild(F,R),this.r_f(R),F.lineStyle=R);F.DCb=c;this.MFb(F)}}finally{l&&l.dispose()}return 32}b$i(a){switch(a){case 0:return 0;
case 1:return 8;case 3:return 2;default:return 0}}Bjj(a,b,c,f,l){f=this.ra.mg();b=gi.V5i(f);if(!(b&&0<b.length)||this.Xb.NB(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.HNc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);l=parseInt(c)-1;if(0>l||l>=gi.ohh.length)return 8;c=gi.ohh[l];l=gi.TWk[l];1<f.length?ya.a.J(512500308,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on {0} selected shapes.",f.length):ya.a.J(512500307,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on one selected shapes.");
f=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{f.jc(b[0]);f.$c=a;const x=this.ra.gO(Array.isArray(b)?b:null);for(const F of x)F.e5k(c,l)}finally{f&&f.dispose()}return 32}Nhg(a,b,c){const f=this.ra.mg();b=this.asb(f,this.zW);if(!(b&&0<b.length)||this.Xb.NB(b))return 16;if(1===c)return 32;1<f.length?ya.a.J(512500306,815,50,"HandleRemoveShapeOutline: Remove shape outline on {0} selected shapes.",f.length):ya.a.J(512500305,815,50,"HandleRemoveShapeOutline: Remove shape outline on one selected shape.");
c=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{c.jc(b[0]);c.$c=a;const l=this.ra.gO(b);for(const x of l){const F=x.lineStyle;F&&(this.vI.ROa(F),F.noFillField=new Ux,x.lineStyle=F,x.ysa=null,this.Ild(x,F));x.eOk();this.MFb(x)}}finally{c&&c.dispose()}return 32}Cjj(a,b,c,f,l){f=this.ra.mg();b=this.asb(f,this.zW);if(!(b&&0<b.length)||gi.eZk(f))return 8;if(this.Xb.NB(b))return 16;if(1===c)return 32;if(!l)return ya.a.J(512500304,815,50,"HandleApplyShapeOutlineSketchStyle requires actionData"),
8;c=this.HNc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return ya.a.J(512500303,815,50,"Invalid outline sketch style ",c),8;1<f.length?ya.a.J(512500301,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on {0} selected shapes.",f.length):ya.a.J(512500300,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on one selected shape.");l=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{l.jc(b[0]);l.$c=a;for(const x of b)x.Ydc=c,
x.setValue(ub.a.K4b,!0)}finally{l&&l.dispose()}return 32}Apj(a,b,c){b=this.ra.mg();a=this.ra.jq();if(!(this.YB.isActive||1===b.length&&a&&a.Pth||this.vp&&this.ra.Wia()))return 16;if(1===c)return 32;if(this.Xb.Zc(a))return 16;c=32;if(this.YB.isActive)this.YB.wNa();else if(this.vp)if(this.dQ.yK)this.dQ.yK=!1;else{b=this.ra.Oa.kb;var f=null;if(b&&(f=b.Ua)&&(f.contextId===Fb.a.Lf||f.contextId===Fb.a.textRange||f.contextId===Fb.a.endOfParagraph||f.contextId===Fb.a.paragraph))c=this.ia.processAction(C.a.OJc,
2);else if(a.nd&&this.ra.BZ(this.ra.Oa)){if(b=a.j1d())if(b=b.ef(0,0)){b.g2k(this.dQ);var l=b.mZb;f=-1;l&&(f=Ya.ParagraphReader.textLength(Object(va.a)(ag.a,l))+1);if(l=this.Yb.zi){const x=this.Db.je(4),F=l.ri;x.jc(l);const R=this.kT.XBa(F),fa=Object(va.a)(123,this.hje.xdg(b));this.kT.fTe(R,!0,!1,fa,a,b,null,0,f);(a=F.Tfc(R))&&l.fwb(a);x.dispose()}}}else this.YB.p4g(a)}else this.YB.p4g(a);Gb.App.Fb.updateCommandUI();return c}pjj(a,b,c){return this.vp&&(a=this.ra.Oa.kb)&&(a=a.Ua)&&(a.contextId===Fb.a.Lf||
a.contextId===Fb.a.textRange||a.contextId===Fb.a.endOfParagraph||a.contextId===Fb.a.paragraph)?(this.YB.wNa(),this.ia.processAction(ba.a.qWd,2)):(a=this.ra.jq())?this.ia.Ka(ba.a.pWd,c,new fA(this.YB.Okl,a)):16}qjj(a,b,c,f,l){if(!l||!Object(Fa.a)(fA,l))return ya.a.J(512500299,822,10,"Invalid ActionData. Type: {0}",l?Object.getType(l).getName():"null"),8;if(this.vp&&this.dQ.yK)return this.dQ.yK=!1,16;b=l.Jlc;if(!(this.YB.isActive&&b&&b.Oth))return this.YB.wNa(),16;if(this.Xb.Zc(b))return 16;if(1===
c)return 32;Mc.a.Cb&&(Mc.a.Cb.Ij=!1,Mc.a.Cb.actionName="FormatPainterApplyToShape",Mc.a.Cb.Ar=!0);c=this.Db.rd(15,void 0,()=>{this.ra.hj();this.Fa.Ad()});try{c.jc(l.Jlc),c.$c=a,l.Jlc.irb=l.Pkl.id}finally{c&&c.dispose()}this.YB.wNa();return 32}Enj(a,b,c,f,l){if(!l||!Object(Fa.a)(Ph.a,l))return 8;l.Kf(this.YB.isActive||(this.vp?this.dQ.yK:!1));return 32}GCk(a,b,c){return(a=this.k0b(a))&&Object(Fa.a)(Is.a,a.zk)&&(a=Object(va.a)(Is.a,a.zk))?a.AAe(ba.a.vz(b),c):!1}H2d(a,b,c){return(a=this.k0b(a))&&Object(Fa.a)(Is.a,
a.zk)&&(a=Object(va.a)(Is.a,a.zk))?a.F9c(ba.a.vz(b),c):!1}HNc(a){return a.split(",")[1]}ZBh(a,b){if(this.Xke&&a.rTc()){var c=this.k0b(a),f=this.CQf(c,a);a=b.noFillField?null:this.CL(b,a);f=this.Fbb.brl(f,a);this.HEf(c,f)}}Ild(a,b){var c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(this.Xke&&a.rTc()){var f=this.k0b(a),l=this.CQf(f,a);if(null!==l){if(b.noFillField)l=this.Fbb.czh(l);else{if(b.wFieldSpecified){var x=Object(va.a)(123,c.KB(a.slideId)),F=this.Yi.ZF;x&&x.uw&&
null!=x.uw.Fr&&(F=x.uw.Fr);l=this.Fbb.dzh(l,b.wField,f.yd,F)}b.prstDashField&&b.prstDashField.valFieldSpecified&&(l=this.Fbb.crl(l,b.prstDashField.valField));if(b.solidFillField){b=this.CL(b,a);l=this.Fbb.czh(l,b);if(!l)return;b=l.querySelectorAll(this.Fbb.iOe);x=!0;for(F=0;F<b.length;++F){const R=b[F].getAttribute("stroke-width");if(R&&!Ma.a.Va(R.toString())){x=!1;break}}x&&(a=Object(va.a)(123,c.KB(a.slideId)),c=this.Yi.ZF,a&&a.uw&&null!=a.uw.Fr&&(c=a.uw.Fr),l=this.Fbb.dzh(l,je.a.sye/this.lye,f.yd,
c))}}this.HEf(f,l)}}}CL(a,b){const c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");b=c.KB(b.slideId);return this.vI.SEb(a,b.Se)}HEf(a,b){if(b&&a&&a.zk){a.zk.LY.Qd(!1);var c=a.zk.yG.ya.childNodes;for(let f=0;f<c.length;++f)a.zk.yG.ya.removeChild(c[f]);a.zk.yG.ya.appendChild(b);(b=a.iNa.getAttribute("transform"))&&a.zk.yG.ya.setAttribute("transform",b.toString());a.zk.yG.Qd(!0);Mc.a.Cb&&(Mc.a.Cb.Ij=!0,Mc.a.Cb.BE=new Date)}}Twg(a,b,c){return ee.a("EnableSmartArtFillColor")&&
this.GCk(a,b,c)}sbj(){var a=this.ra.mg();a=this.j6a(a,this.zW);var b=this.ra.gO(a),c=null;a=null;ee.a("FixColorPickerSelectedColor")&&(a=this.ta.Ba);if(1===b.length){if(b[0].lea)c=Cf.Box4ColorHelper.Wqa(b[0].lea);else if(b[0].nd&&ee.a("FixColorPickerSelectedColor")){const f=this.ra.ny();if(!f||!f.length){if(b=this.ra.Po())b=b.ef(0,0),c=Cf.Box4ColorHelper.BBa(b.cellShading.solidFillField,a.Se);return c}c=f[0];c=c.cellShading&&c.cellShading.solidFillField&&a?Cf.Box4ColorHelper.BBa(c.cellShading.solidFillField,
a.Se):this.Qz.GKc(Object(va.a)(ag.a,c))}!c&&ee.a("FixColorPickerSelectedColor")&&b[0].fill&&b[0].fill.solidFillField&&(c=Cf.Box4ColorHelper.BBa(b[0].fill.solidFillField,a.Se))}return c}Iml(a){var b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");b=b.JB(a).isHiddenShape;this.g5k(a,b)}Hml(a,b){a.isHiddenShape=!b;const c=Object(va.a)(124,a.oc(this.fC));b?c.rJa():(c.via(),this.ra.WV(a)&&this.ra.R6(a))}g5k(a,b){const c=this.Db.rd(15,void 0,()=>{this.ra.hj()});try{const f=this.ta.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");
const l=f.JB(a);c.jc(l);this.Hml(l,b)}finally{c&&c.dispose()}}d5k(a,b){const c=this.Db.rd(15,void 0,()=>{this.ra.hj()});try{const f=this.ta.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");const l=f.JB(a);c.jc(l);l.shapeName=b}finally{c&&c.dispose()}}rbj(){var a=this.ra.mg();a=this.j6a(a,this.zW);return this.ra.gO(a)}ubj(a){const b=this.rbj();return b&&1===b.length?b[0].nd?this.Qz.k7f(this.ra.ny()):b[0].fill&&b[0].fill.solidFillField?Cf.Box4ColorHelper.BBa(b[0].fill.solidFillField,a):null:
null}tbj(a){const b=this.ra.mg();return b&&1===b.length&&b[0].lineStyle&&b[0].lineStyle.solidFillField?Cf.Box4ColorHelper.BBa(b[0].lineStyle.solidFillField,a):null}k0b(a){return a?Object(va.a)(124,a.oc(this.fC)):null}CQf(a,b){try{if(!(a&&a.iNa&&a.zk&&a.zk.yG))return null;if(a.zk.yG.AK()){if(!a.zk.yG.ya)return null;const l=a.zk.yG.ya.childNodes;for(a=0;a<l.length;++a)if("svg"===l[a].tagName.toLowerCase())return l[a];return null}if(!a.iNa.getAttribute(Kk.a.NPc))return null;let c=a.iNa.getAttribute(Kk.a.NPc).toString();
if(!c.toLowerCase().startsWith(this.Dil))return null;c=decodeURIComponent(c.substr(c.indexOf(",")+1));const f=this.rle.sanitize(c);return f&&1===f.children.length?f.children[0]:(b.YQa=!0,null)}catch(c){return ya.a.J(512500295,815,10,"ConvertSourceToDOMElement Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}static Zaj(a,b){const c=[];if(a)for(const f of a)b&&f.get_isSVGBlipFilled()&&Array.add(c,f);return c}static V5i(a){if(!a)return null;const b=[];for(const c of a)c.uy&&
Array.add(b,c);return b}static eZk(a){let b;for(let c=0;c<a.length;c++){if(!a[c])return!0;b=a[c].shapeType;if(127===b||121===b||124===b)return!0}return!1}static uec(a){return eu.a.parse(a.Color)}}gi.Bhh=[.5,1,2.25,4.5];gi.XWk=[6350,12700,28575,57150];gi.ohh=[0,0,2,2,0,1,1];gi.TWk=[0,2,0,2,1,0,1];gi.RJf='<Menu Id="{0}">';gi.ZJf='<MenuSection Id="Remove Color"><Controls Id="Color.Menu.Controls">';gi.XJf='<Button Id="Color.Menu.RemoveColor" Command="{0}" Image16by16="{1}" Image16by16Class="per_AppointmentColor0_16x16x32" LabelText="{2}" Keytip="{3}" />';
gi.YJf="</Controls> </MenuSection>";gi.wgi='<MenuSection Id="More Fill Colors"><Controls Id="Color.Menu.Controls">';gi.ugi='<Button Id="Color.Menu.MoreFillColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';gi.vgi="</Controls> </MenuSection>";gi.zgi='<MenuSection Id="More Outline Colors"><Controls Id="Color.Menu.Controls">';gi.xgi='<Button Id="Color.Menu.MoreOutlineColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';
gi.ygi="</Controls> </MenuSection>";gi.QJf="</Menu>";Object(e.a)(gi,"ShapesFormatActor",null,[244]);class mi{constructor(a,b,c){this.I2c=Array(mi.cV);this.a0c=Array(mi.cV);this.Sce=Array(mi.cV);if(!a)throw Error.argumentNull("mainMasterResources");if(!b)throw Error.argumentNull("theme");if(!c)throw Error.argumentNull("resourceViewElementResolver");this.AI=a;this.gm=b;this.i4c=c;this.Pta={}}dispose(){Array.clear(this.I2c);Array.clear(this.a0c);this.gm=this.AI=null;const a=xa.a.rK(this.Pta);a.length&&
appChrome.api.unregisterIcons(a);this.Pta=null}get uj(){return this.AI.MasterId}S_d(a,b,c){const f=Object.assign(new sk.a,{Id:"PptRibbon.DrawingFormat.StylesMenu",MenuSectionList:[]});var l=Object.assign(new Si.a,{Id:"MenuSectionShapeStyles",ControlsId:"MenuSectionShapeStyles.Controls",Title:"Quick Styles",DisplayMode:"Size48by48",ControlList:[]});Array.add(f.MenuSectionList,l);var x=c?"GraphicsStyleSection":"ApplyShapeStyleSection",F=c?"GraphicsStyleGallery":"ApplyShapeStyleGallery";x=Object.assign(new uq.a,
{Id:"ControlsShapeStyles",ExternalId:x,ExternalGalleryId:F,Type:4,Width:mi.cV,ElementDimensions:"Size48by48",GalleryItems:[]});Array.add(l.ControlList,x);l=mi.cV*(a?mi.qJf:mi.uJf);c&&(l=mi.cV*mi.tJf);for(F=0;F<l;++F){const R=c?"ApplyGraphicsStyle"+F:"ApplyShapeStyle"+F;Array.add(x.GalleryItems,c?this.JWd(R,F,a,b,!0):this.JWd(R,F,a,b,!1))}return f}JWd(a,b,c,f,l){if(l){var x=this.AI?this.AI.SVGStyles[b]:null;c="SVGStyle";x=x?x.ToolTip:""}else x=this.AI?this.AI.ShapeStyles[b]:null,c=c?"LineStyle":"ShapeStyle",
x=x?this.G0d(x.StyleId):"";return Object.assign(new dE.a,{Id:a,ExternalId:a,Icon:mi.X_b(c,f,b),PreviewIconStyle:mi.d$i(),Command:l?"2748140308":"1963674920",QueryCommand:l?"1903137544":"2375118752",Alt:x})}bcd(a){this.addIconToMap(this.AI.ShapeStyles,"ShapeStyle");this.addIconToMap(this.AI.LineStyles,"LineStyle");a&&this.addIconToMap(this.AI.SVGStyles,"SVGStyle");appChrome.api.registerIconProvider(()=>this.Pta)}$bj(a){if(a<mi.cV&&this.I2c[a])return this.I2c[a];if(a>=this.AI.ShapeStyles.length)return"";
var b=this.AI.ShapeStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.G0d(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.oYd(this.i4c.resolve(gg.a.kqb,b.Icon.ImgId)),
l,f);a<mi.cV&&(this.I2c[a]=b);return b}Xaj(a){if(a<mi.cV&&this.Sce[a])return this.Sce[a];if(a>=this.AI.SVGStyles.length)return"";var b=this.AI.SVGStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.Kcg(b.StyleId);b=
String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.oYd(this.i4c.resolve(gg.a.kqb,b.Icon.ImgId)),l,f);a<mi.cV&&(this.Sce[a]=b);return b}T5i(a){if(a<mi.cV&&this.a0c[a])return this.a0c[a];if(a>=this.AI.LineStyles.length)return"";var b=this.AI.LineStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",
-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.$$f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.oYd(this.i4c.resolve(gg.a.kqb,b.Icon.ImgId)),l,f);a<mi.cV&&(this.a0c[a]=b);return b}G0d(a){let b=null;switch(parseInt(String(a/mi.cV))){case 0:b=ResourceStrings.l_ShapeStyleColoredOutline;break;case 1:b=ResourceStrings.l_ShapeStyleColoredFill;break;case 2:b=ResourceStrings.l_ShapeStyleLightOutlineColoredFill;break;case 3:b=ResourceStrings.l_ShapeStyleSubtleEffect;
break;case 4:b=ResourceStrings.l_ShapeStyleModerateEffect;break;case 5:b=ResourceStrings.l_ShapeStyleIntenseEffect}let c;({color:a,Vvh:c}=this.F7f(a));return String.format(b,a.toString(),c)}Kcg(a){return(a=this.AI?this.AI.SVGStyles[a]:null)?a.ToolTip:""}$$f(a){let b=null;switch(parseInt(String(a/mi.cV))){case 0:b=ResourceStrings.l_LineStyleSubtleEffect;break;case 1:b=ResourceStrings.l_LineStyleModerateEffect;break;case 2:b=ResourceStrings.l_LineStyleIntenseEffect}let c;({color:a,Vvh:c}=this.F7f(a));
return String.format(b,a.toString(),c)}oYd(a){return null===a?"":Ma.a.a2b(a)}addIconToMap(a,b){for(let f=0;f<a.length;++f){var c=a[f];const l=mi.X_b(b,this.uj,f),x={},F={};F.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top);F.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left);F.position="absolute";x.root=F;c=appChrome.buildImageIconFromUrl(this.i4c.resolve(gg.a.kqb,c.Icon.ImgId),x);this.Pta[l]=c}}F7f(a){let b,c;c=b=null;a%=mi.cV;switch(a){case 0:b=Mi.Color.Oi(this.gm.Dark1);c=String.format(ResourceStrings.l_DarkFormat,
1);break;case 1:b=Mi.Color.Oi(this.gm.Accent1);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 2:b=Mi.Color.Oi(this.gm.Accent2);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 3:b=Mi.Color.Oi(this.gm.Accent3);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 4:b=Mi.Color.Oi(this.gm.Accent4);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 5:b=Mi.Color.Oi(this.gm.Accent5);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 6:b=Mi.Color.Oi(this.gm.Accent6),
c=String.format(ResourceStrings.L_AccentFormat,a)}return{color:b,Vvh:c}}static get Pbi(){return mi.wWk}static get Nbi(){return mi.uWk}static get Obi(){return mi.vWk}static d$i(){const a={},b=28/48,c=(28-28*b)/2,f={};f.width=String.format("{0}px",28);f.height=String.format("{0}px",28);f.transform=String.format("matrix({0},0,0,{1},-{2},-{3})",b,b,c,c);a.root=f;return a}static mXd(a,b){const c=new Sys.StringBuilder;c.append('<Menu Id="PptRibbon.DrawingFormat.StylesMenu">');c.append('<MenuSection Id="MenuSectionShapeStyles"><Gallery Id="ControlsShapeStyles" ElementDimensions="Size48by48" Width="7">');
a*=mi.cV;for(let f=0;f<a;++f)c.append(String.format('<GalleryButton Id="Style{0}" ElementDimensions="Size48by48" Command="{1}" QueryCommand="{2}" Alt="" InnerHTML=""/>',f,b?ba.a.CAc:ba.a.uTb,b?ba.a.NAe:ba.a.kBe));c.append("</Gallery> </MenuSection>");c.append("</Menu>");return c.toString()}static X_b(a,b,c){return String.format("{0}_{1}_{2}",a,b,c)}}mi.cV=7;mi.uJf=6;mi.tJf=4;mi.qJf=3;mi.wWk=mi.mXd(mi.uJf,!1);mi.vWk=mi.mXd(mi.qJf,!1);mi.uWk=mi.mXd(mi.tJf,!0);Object(e.a)(mi,"StyleGalleryBuilder",null,
[106]);class lN{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb){this.sAb="";this.Gxb=[];this.ia=a;this.Vp=b;this.Af=c;this.Fa=l;this.Db=f;this.nu=x;this.Pzb=F;this.ra=R;this.Ea=fa;this.Xa=wa;this.zW=Xa;lb.uB(Object(D.a)(this,this.jo,"onSessionRehydrated"));this.Xa.JCf(Object(D.a)(this,this.j8c,"onSessionInfoChanged"))}ub(){this.ia.pa(ba.a.kBe,fc.a.application,Object(D.a)(this,this.Hnj,"handleQueryShapesStyle"),97);this.ia.pa(ba.a.Hwk,fc.a.application,Object(D.a)(this,this.qnj,"handlePopulateShapesStyles"),
96);this.ia.pa(ba.a.uTb,fc.a.application,Object(D.a)(this,this.Ejj,"handleApplyShapesStyle"),4);this.ia.pa(ba.a.NAe,fc.a.application,Object(D.a)(this,this.Fnj,"handleQueryGraphicsStyle"),97);this.ia.pa(ba.a.nwk,fc.a.application,Object(D.a)(this,this.nnj,"handlePopulateGraphicsStyles"),96);this.ia.pa(ba.a.CAc,fc.a.application,Object(D.a)(this,this.sjj,"handleApplyGraphicsStyle"),4)}we(){}Fnj(a,b,c,f,l){return this.w0f(l,!0)}Hnj(a,b,c,f,l){return this.w0f(l,!1)}w0f(a,b){var c=this.Vp.presentation;if(!c)throw Error.argumentNull("Presentation is null");
if(!a||!Object(Fa.a)(zv,a))return 8;var f=a.XT.startsWith("Style")?"Style":b?"ApplyGraphicsStyle":"ApplyShapeStyle";f=parseInt(a.XT.substr(f.length));if(isNaN(f)||0>f)return ya.a.J(17598104,822,10,"ExecuteQuery{0}Style: Invalid style id recieved from the gallery",b?"Graphics":"Shapes"),8;var l=this.ra.mg();if(!l||!l.length)return 16;const x=a.LWa;if(!x)return 8;var F=c.KB(l[0].slideId);if(!F)return 16;c=F.uj;F=this.T9f(F);a.XT.startsWith(b?"ApplyGraphicsStyle":"ApplyShapeStyle")?(this.sAb=(l=this.ZSb(l))?
"SGT_Line":"SGT_Shape",x.h2=F?F.JWd(a.XT,f,l,c,b?!0:!1):null):F?(this.ZSb(l)?(this.sAb="SGT_Line",x.vBa=F.T5i(f),x.rrb=F.$$f(f)):b?(this.sAb="SGT_SVG",x.vBa=F.Xaj(f),x.rrb=F.Kcg(f)):(this.sAb="SGT_Shape",x.vBa=F.$bj(f),x.rrb=F.G0d(f)),x.TT(!1)):(x.vBa="",x.rrb="");return 32}nnj(a,b,c,f,l){return this.u0f(c,l,!0)}qnj(a,b,c,f,l){return this.ra.vRa()?8:this.u0f(c,l,!1)}u0f(a,b,c){var f=this.Vp.presentation;if(!f)throw Error.argumentNull("Presentation is null");if(1===a)return 32;if(!b)return ya.a.J(17598107,
822,10,"ExecutePopulate{0}Styles - Invalid action data",c?"Graphics":"Shapes"),8;a=this.ra.mg();f=a[0]?f.KB(a[0].slideId):null;const l=this.T9f(f);if(b.MenuId&&"style"===b.MenuId)this.ZSb(a)?b.PopulationXML=mi.Obi:b.PopulationXML=c?mi.Nbi:mi.Pbi;else{this.sAb=(a=this.ZSb(a))?"SGT_Line":"SGT_Shape";if(!f)return 16;b.MenuItems=l?l.S_d(a,f.uj,c?!0:!1):null}return 32}sjj(a,b,c,f,l){return this.Ea.Xth(this.ra.mg())?this.Igg(a,c,l,!0):16}Ejj(a,b,c,f,l){return this.E7k(this.ra.mg())?this.Igg(a,c,l,!1):16}Igg(a,
b,c,f){var l=this.Vp.presentation;if(!l)throw Error.argumentNull("Presentation is null");const x=this.ra.mg();if(!x||!x.length||this.Af.NB(x))return 16;l=l.KB(x[0].slideId);var F=this.nu.qag(l);if(!F)return this.nu.Dgl(l),ya.a.J(17598111,822,15,"HandleApply{0}Style - MainMasterResources are missing",f?"Graphics":"Shapes"),8;if(1===b)return 32;if(!c)return ya.a.J(17598109,822,10,"HandleApply{0}Style - Invalid action data",f?"Graphics":"Shapes"),8;b=this.ZSb(x)?F.LineStyles.length:F.ShapeStyles.length;
F=c.startsWith("Style")?"Style":f?"ApplyGraphicsStyle":"ApplyShapeStyle";c=parseInt(c.substr(F.length));if(isNaN(c)||0>c||c>=b)return ya.a.J(17598113,822,10,"HandleApply{0}Style - Invalid style id recieved from gallery",f?"Graphics":"Shapes"),16;1===x.length?ya.a.J(17598115,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on only one {1}.",f?"Graphics":"Shapes",f?"SVG":"Shape"):1<x.length&&ya.a.J(17598145,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on {1} {2}.",f?"Graphics":
"Shapes",x.length,f?"SVGs":"Shapes");f=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.hj()});try{f.jc(Object(va.a)(123,l));f.$c=a;const R=this.ra.gO(Array.isArray(x)?x:null);for(const fa of R)fa&&fa.f5k(c,this.sAb)}finally{f&&f.dispose()}return 32}j8c(){for(const a of this.Gxb)a.dispose();Array.clear(this.Gxb)}T9f(a){const b=this.nu.qag(a);if(!b||!a)return ya.a.J(36811143,815,15,"ShapesStyleActor::GetGalleryBuilderForCurrentSlide: MainMasterResource is null now!"),null;for(const c of this.Gxb)if(c.uj===
a.uj)return c;a=new mi(b,a.Se,this.Pzb);Array.add(this.Gxb,a);a.bcd(this.zW);return a}E7k(a){if(!a||!a.length||this.Ea.eAc(a))return!1;for(const b of a)if(b.dsa)return!0;return!1}ZSb(a){if(!a)return!1;for(const b of a)if(!b.uy)return!1;return!0}jo(){this.bva()}bva(){this.nu.clearCache();for(const a of this.Gxb)a.dispose();Array.clear(this.Gxb)}}Object(e.a)(lN,"ShapesStyleActor",null,[244,608]);class Dv{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb){this.Qw=this.ym=-1;this.gv=a;this.ia=b;this.Fa=c;this.Af=
f;this.Cy=l;this.ra=x;this.kj=F;this.Ea=R;this.p2j=fa;this.u2j=wa;this.cka=Xa;this.sc=lb}get Eb(){return this.ra}ub(){this.ia.pa(ba.a.XXa,fc.a.application,Object(D.a)(this,this.AQa,"handleFontFormatAction"),4);this.ia.pa(ba.a.YXa,fc.a.application,Object(D.a)(this,this.AQa,"handleFontFormatAction"),4);this.ia.pa(ba.a.ZXa,fc.a.application,Object(D.a)(this,this.AQa,"handleFontFormatAction"),4);this.ia.pa(ba.a.Wjc,fc.a.application,Object(D.a)(this,this.AQa,"handleFontFormatAction"),4);this.ia.pa(ba.a.JGb,
fc.a.application,Object(D.a)(this,this.AQa,"handleFontFormatAction"),4);this.ia.pa(ba.a.oGb,fc.a.application,Object(D.a)(this,this.AQa,"handleFontFormatAction"),4);this.ia.pa(ba.a.lGb,fc.a.application,Object(D.a)(this,this.l1b,"handleFont"),5);this.ia.pa(ba.a.Gfb,fc.a.application,Object(D.a)(this,this.l1b,"handleFont"),5);this.ia.pa(ba.a.Hfb,fc.a.application,Object(D.a)(this,this.l1b,"handleFont"),5);this.ia.pa(ba.a.SJe,fc.a.application,Object(D.a)(this,this.lnj,"handlePopulateFontNameDropdown"),
97);this.ia.pa(ba.a.Sfb,fc.a.application,Object(D.a)(this,this.l1b,"handleFont"),4);this.ia.pa(ba.a.HGb,fc.a.application,Object(D.a)(this,this.l1b,"handleFont"),4);this.ia.pa(ba.a.$jc,fc.a.application,Object(D.a)(this,this.AQa,"handleFontFormatAction"),4);this.ia.pa(ba.a.Zjc,fc.a.application,Object(D.a)(this,this.AQa,"handleFontFormatAction"),4);this.ia.pa(ba.a.Fgc,fc.a.application,Object(D.a)(this,this.Xsb,"handleQueryFontToggleButton"),97);this.ia.pa(ba.a.Ggc,fc.a.application,Object(D.a)(this,this.Xsb,
"handleQueryFontToggleButton"),97);this.ia.pa(ba.a.Igc,fc.a.application,Object(D.a)(this,this.Xsb,"handleQueryFontToggleButton"),97);this.ia.pa(ba.a.Hgc,fc.a.application,Object(D.a)(this,this.Xsb,"handleQueryFontToggleButton"),97);this.ia.pa(ba.a.Sad,fc.a.application,Object(D.a)(this,this.xOc,"handleQueryFont"),100);this.ia.pa(ba.a.Rad,fc.a.application,Object(D.a)(this,this.xOc,"handleQueryFont"),100);this.ia.pa(ba.a.Tad,fc.a.application,Object(D.a)(this,this.xOc,"handleQueryFont"),97);this.ia.pa(ba.a.Uad,
fc.a.application,Object(D.a)(this,this.xOc,"handleQueryFont"),97);this.ia.pa(ba.a.$ad,fc.a.application,Object(D.a)(this,this.Xsb,"handleQueryFontToggleButton"),97);this.ia.pa(ba.a.Zad,fc.a.application,Object(D.a)(this,this.Xsb,"handleQueryFontToggleButton"),97)}we(){const a=this.Fa.Bc(Nc.a.yg);a.bindAction(A.KeyInputManager.Mv(ResourceStrings.l_HK_Bold),ba.a.XXa);a.bindAction(A.KeyInputManager.Mv(ResourceStrings.l_HK_Italic),ba.a.YXa);a.bindAction(A.KeyInputManager.Mv(ResourceStrings.l_HK_Underline),
ba.a.ZXa);a.bindAction(A.KeyInputManager.Na(w.a.CJa,A.KeyInputManager.Fe|4),ba.a.Wjc);a.bindAction(A.KeyInputManager.Na(w.a.hmd,A.KeyInputManager.Fe|4),ba.a.JGb)}xOc(a,b,c,f,l){c=this.Eb.mg();if(!c||1>c.length)return 16;f=this.Ea.mZ(c);var x=this.Eb.kia();if(1>f.length&&!x)return 16;b=null;this.ym=Date.now();x&&(b=this.sc.W7f(x,new Ts),this.Qw=Date.now(),ya.a.J(512500294,815,50,"Query table shape font timespan by {0}",(this.Qw-this.ym).toString()));c=x?[c[0]]:f;for(const F of c){switch(a){case ba.a.Sad:case ba.a.Rad:break;
case ba.a.Tad:c=this.Cy.H_b(F.nd&&b?b.fontName:F.iIb);if(l.K1&&l.K1!==c){l.K1="";break}l.K1=c;l.ffd();break;case ba.a.Uad:c="";F.nd&&b?-1!==b.fontSize&&(c=Ma.a.NJc(b.fontSize/2,0,u.AFrameworkApplication.numberFormat)):c=F.f$?Dv.U7f(F).toString():"";f=parseFloat(c);if(!isNaN(f)&&(x=l.K1)&&x!==c){x=Math.min(f,parseFloat(x)).toString()+"+";l.K1=x;break}l.K1=c;l.ffd();break;default:return ya.a.J(512500293,820,10,"Unexpected actionId for HandleQueryFont"),8}if(l&&l.K1&&!l.K1.length)break}return 32}Xsb(a,
b,c,f,l){b=this.Eb.mg();if(!b||1>b.length)return 16;b=this.Ea.mZ(b);c=this.Eb.kia();if(1>b.length&&!c)return 16;a=c?this.ADk(c,a,new Ts):this.B8g(b,a);l.Kf("select"===a);return"disable"!==a?32:8}l1b(a,b,c,f,l){b=this.Eb.mg();if(!b||1>b.length)return 16;const x=this.Eb.kia();f=this.Ea.mZ(b);if(1>f.length&&!x||this.Af.NB(f)||this.Af.NB([x]))return 16;if(1===c)return 32;this.Eb.hj();this.Fa.Ad();switch(a){case ba.a.lGb:const R=this.vra(l,!0);if(!R)return 8;1<b.length?ya.a.J(512500292,815,50,"Set {0} shapes font color.",
b.length):ya.a.J(512500291,815,50,"Set one shape font color.");for(const lb of b)if(lb.Mf||lb.mh){Qn(lb);break}this.gv.Jha(lb=>{lb.ZIa=R},f);break;case ba.a.Sfb:case ba.a.HGb:let fa;if(a===ba.a.Sfb){if(fa=this.vra(l,!1),!fa)return 8}else fa="";1<b.length?ya.a.J(512500290,815,50,"Set {0} shapes highlight.",b.length):ya.a.J(512500289,815,50,"Set one shape highlight.");this.gv.Jha(lb=>{lb.highlight=fa},f);break;case ba.a.Gfb:if(!l)return 8;const wa=this.Cy.H_b(l);if(wa.length){1<b.length?ya.a.J(512500288,
815,50,"Set {0} shapes font name.",b.length):ya.a.J(512500259,815,50,"Set one shape font name.");var F=null;for(const lb of b)if(lb.Mf||lb.mh)Qn(lb),lb.Mf&&(F=lb);if(1>this.Eag(f,a,wa).length)return 16;this.gv.Jha(lb=>{lb.iIb=wa},f);F&&(F.iIb=wa);this.Cy.hzc(l)}break;case ba.a.Hfb:l=Object(va.a)(gE.a,l);if(!l||!l.ld)return 8;const Xa=this.kj.LVb(l.ld);if(isNaN(Xa))return 8;1<b.length?ya.a.J(512500258,815,50,"Set {0} shapes font size.",b.length):ya.a.J(512500257,815,50,"Set one shape font size.");
l=null;for(F of b)if(F.Mf||F.mh)Qn(F),F.Mf&&(l=F);if(1>this.Eag(f,a,Xa*Bk.a.w7a).length)return 16;this.gv.Jha(lb=>{lb.xmh(Xa)},f);l&&l.xmh(Xa);break;default:return ya.a.J(512500256,820,10,"Unexpected actionId for HandleFont"),8}return 32}AQa(a,b,c){b=this.Eb.mg();if(!b||1>b.length)return 16;const f=this.Eb.kia(),l=this.Ea.mZ(b);if(1>l.length&&!f||this.Af.NB(l)||this.Af.NB([f]))return 16;if(1===c)return 32;const x="select"!==this.B8g(this.Ea.mZ(b),a);this.Eb.hj();this.Fa.Ad();switch(a){case ba.a.XXa:1<
b.length?ya.a.J(512500255,815,50,"Set {0} shapes bold.",b.length):ya.a.J(512500254,815,50,"Set one shape bold.");f&&Object(ee.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ba.a.bold,2);this.gv.Jha(R=>{R.isBold=x},l);break;case ba.a.YXa:1<b.length?ya.a.J(512500253,815,50,"Set {0} shapes italic.",b.length):ya.a.J(512500252,815,50,"Set one shape italic.");f&&Object(ee.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ba.a.setItalic,2);this.gv.Jha(R=>{R.isItalic=x},l);break;case ba.a.ZXa:1<
b.length?ya.a.J(512500251,815,50,"Set {0} shapes underline.",b.length):ya.a.J(512500250,815,50,"Set one shape underline.");f&&Object(ee.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ba.a.underline,2);this.gv.Jha(R=>{R.pD=x},l);break;case ba.a.oGb:1<b.length?ya.a.J(512500249,815,50,"Set {0} shapes strikethrough.",b.length):ya.a.J(512500248,815,50,"Set one shape strikethrough.");this.gv.Jha(R=>{R.bF=x},l);break;case ba.a.Wjc:case ba.a.JGb:const F=a===ba.a.JGb?!1:!0;1<b.length?ya.a.J(512500247,
815,50,"Step {0} shapes font size.",b.length):ya.a.J(512500246,815,50,"Step one shape font size.");this.gv.Jha(R=>{R.Gvb=F},l);break;case ba.a.$jc:1<b.length?ya.a.J(512500245,815,50,"Step {0} shapes superscript.",b.length):ya.a.J(512500244,815,50,"Step one shape superscript.");this.gv.Jha(R=>{R.xM=x?3E4:0},l);break;case ba.a.Zjc:1<b.length?ya.a.J(512500243,815,50,"Step {0} shapes subscript.",b.length):ya.a.J(512500242,815,50,"Step one shape subscript.");this.gv.Jha(R=>{R.xM=x?-25E3:0},l);break;default:return 8}return 32}lnj(a,
b,c,f,l){if(1===c)return 32;fd.Font.K5d(b);l.MenuItems=ia.FontUtils.H5f(Dv.Rgd,Dv.QJc,this.p2j,this.cka,this.u2j);return 32}B8g(a,b){let c="select";for(const f of a){switch(b){case ba.a.Fgc:case ba.a.XXa:c=f.isBold?"select":"normal";break;case ba.a.Ggc:case ba.a.YXa:c=f.isItalic?"select":"normal";break;case ba.a.Igc:case ba.a.ZXa:c=f.pD?"select":"normal";break;case ba.a.Hgc:case ba.a.oGb:c=f.bF?"select":"normal";break;case ba.a.$ad:case ba.a.$jc:c=0<f.xM?"select":"normal";break;case ba.a.Zad:case ba.a.Zjc:c=
0>f.xM?"select":"normal";break;default:return"disable"}if("select"!==c)break}return c}ADk(a,b,c){this.ym=Date.now();c=this.sc.W7f(a,c);switch(b){case ba.a.Fgc:a=1===c.bold?"select":"normal";break;case ba.a.Ggc:a=1===c.italic?"select":"normal";break;case ba.a.Igc:a=1===c.underline?"select":"normal";break;case ba.a.Hgc:a=1===c.strikethrough?"select":"normal";break;default:return"disable"}this.Qw=Date.now();ya.a.J(512500241,815,50,"Query table shape font state timespan by {0}",(this.Qw-this.ym).toString());
return a}Eag(a,b,c){const f=[];for(const l of a)switch(b){case ba.a.XXa:l.isBold!==c&&Array.add(f,l);break;case ba.a.YXa:l.isItalic!==c&&Array.add(f,l);break;case ba.a.ZXa:l.pD!==c&&Array.add(f,l);break;case ba.a.oGb:l.bF!==c&&Array.add(f,l);break;case ba.a.Gfb:l.iIb!==c&&Array.add(f,l);break;case ba.a.Hfb:Dv.U7f(l)!==c&&Array.add(f,l);break;case ba.a.$jc:0<l.xM!==c&&Array.add(f,l);break;case ba.a.Zjc:0>l.xM!==c&&Array.add(f,l);break;default:ya.a.J(512500240,820,10,"ShapesTextFontActor::GetModifiedShapeMonikers unsupported action Id: {0}.",
b)}return f}vra(a,b){if(b)return b=Re.SchemeColor.parse(a),b&&b.Bra?Ol.i(Ol.g(b.fP)):(ya.a.J(512500239,820,10,"Font color '{0}' is incorrect",a),null);b=eu.a.parse(a);return b&&b.RGBColor?b.RGBColor:(ya.a.J(512500238,820,10,"Color '{0}' is incorrect",a),null)}static QJc(a,b){return b}static Rgd(){return!1}static U7f(a){const b=a.z1;return Md.a.ty(b,1)?a.f$:Math.round(a.f$)*b}}Object(e.a)(Dv,"ShapesTextFontActor",null,[244]);class mN{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.Qw=this.ym=-1;this.gv=
a;this.ia=b;this.Fa=c;this.Af=f;this.ra=l;this.Ea=x;this.fab=F;this.$K=R;this.Mb=fa;this.Db=wa;this.RVc=Xa;this.sc=lb;this.Jz=Lb}get Eb(){return this.ra}ub(){this.ia.pa(ba.a.FGb,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.nGb,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.Ifb,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.GGb,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),
4);this.ia.pa(ba.a.Vfb,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.mGb,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.Vjc,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.rgd,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.Sfd,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.Rfd,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),
4);this.ia.pa(ba.a.Qfd,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.Pfd,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.QJe,fc.a.application,Object(D.a)(this,this.Khg,"handleQueryLineSpacing"),4);this.ia.pa(ba.a.Mjc,fc.a.application,Object(D.a)(this,this.r7,"handleFormatAction"),4);this.ia.pa(ba.a.Vdb,fc.a.application,Object(D.a)(this,this.CQa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.Wdb,fc.a.application,Object(D.a)(this,
this.CQa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.JWa,fc.a.application,Object(D.a)(this,this.CQa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.KWa,fc.a.application,Object(D.a)(this,this.CQa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.Wad,fc.a.application,Object(D.a)(this,this.CQa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.Qad,fc.a.application,Object(D.a)(this,this.CQa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.Yad,fc.a.application,Object(D.a)(this,this.CQa,"handleQueryToggleButton"),
97);this.ia.pa(ba.a.Vad,fc.a.application,Object(D.a)(this,this.CQa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.cbd,fc.a.application,Object(D.a)(this,this.Y2d,"handleQueryTextAnchoring"),97);this.ia.pa(ba.a.bbd,fc.a.application,Object(D.a)(this,this.Y2d,"handleQueryTextAnchoring"),97);this.ia.pa(ba.a.abd,fc.a.application,Object(D.a)(this,this.Y2d,"handleQueryTextAnchoring"),97);this.ia.pa(ba.a.Xad,fc.a.application,Object(D.a)(this,this.Khg,"handleQueryLineSpacing"),97)}we(){const a=this.Fa.Bc(Nc.a.yg);
a.bindAction(A.KeyInputManager.Mv(ResourceStrings.l_HK_FullJustify),ba.a.mGb);a.bindAction(A.KeyInputManager.Mv(ResourceStrings.l_HK_CenterJustify),ba.a.GGb);n.a.ek?(a.bindAction(A.KeyInputManager.Mv(ResourceStrings.l_HK_LeftJustify_Mac),ba.a.Ifb),a.bindAction(A.KeyInputManager.Mv(ResourceStrings.l_HK_RightJustify_Mac),ba.a.Vfb)):(a.bindAction(A.KeyInputManager.Mv(ResourceStrings.l_HK_LeftJustify),ba.a.Ifb),a.bindAction(A.KeyInputManager.Mv(ResourceStrings.l_HK_RightJustify),ba.a.Vfb))}CQa(a,b,c,
f,l){const x=this.Eb.mg();if(!x||1>x.length)return 16;b=this.Eb.kia();const F=this.Ea.mZ(x);if(1>F.length&&!b)return 16;f=c=null;let R=a===ba.a.Vdb?1:a===ba.a.Wdb?2:18;Object(Fa.a)(Ph.a,l)?f=l:Object(Fa.a)(zv,l)&&(f=l.LWa,R=l.menuItemId);l=b?[x[0]]:F;this.ym=Date.now();for(const fa of l){switch(a){case ba.a.Vdb:c=fa.nd?this.r1d(R,a):this.D0d(R,fa,a);break;case ba.a.Wdb:c=fa.nd?this.r1d(R,a):this.D0d(R,fa,a);break;case ba.a.JWa:case ba.a.KWa:c=fa.nd?this.r1d(R,a):this.D0d(R,fa,a);break;case ba.a.Wad:c=
fa.nd?1===this.sc.WKc(b)?"select":"normal":1===fa.pl?"select":"normal";break;case ba.a.Qad:c=fa.nd?2===this.sc.WKc(b)?"select":"normal":2===fa.pl?"select":"normal";break;case ba.a.Yad:c=fa.nd?3===this.sc.WKc(b)?"select":"normal":3===fa.pl?"select":"normal";break;case ba.a.Vad:c=fa.nd?6===this.sc.WKc(b)?"select":"normal":4===fa.pl?"select":"normal";break;default:c="disable"}if("normal"===c)break}f.Kf("select"===c);this.Qw=Date.now();b&&ya.a.J(512500237,815,50,"Query table shape timespan by {0}",(this.Qw-
this.ym).toString());return"disable"!==c?32:8}D0d(a,b,c){return c===ba.a.JWa||c===ba.a.Vdb||c===ba.a.KWa||c===ba.a.Wdb?this.$K.$Ff(b,a)?"select":"normal":"normal"}r1d(a,b){var c=!0,f=this.Eb.kia();f=nd.SelectionFactory.QEc(Object(va.a)(ag.a,f));for(const l of f){if(c=l.Kk?l.node:null)if(f=this.Mb.Kc(c),f.set(c),f.mc(11),f.Ng(11),c=this.Jz.Fw(f)){if(0===a){c=!1;break}if(b===ba.a.Vdb)c=1===c.listType;else if(b===ba.a.Wdb)c=0===c.listType;else if(b===ba.a.JWa){f=this.$K.DSa.ga(a).eUb;const x=this.$K.DSa.ga(a).$nb;
c=c.btb&&0<c.X7.length&&c.X7[0]===f&&c.l7a&&c.font===x}else b===ba.a.KWa?(f=this.$K.h6c.ga(a).eJd,c=!!c.propertySet&&c.propertySet.Sa(ub.a.autonumberBulletType)&&c.propertySet.getValue(ub.a.autonumberBulletType)===f):c=!1}else c=0===a?b===ba.a.JWa||b===ba.a.KWa?!0:!1:!1;else c=!1;if(!c)break}return c?"select":"normal"}r7(a,b,c,f,l){f=this.Eb.mg();if(!f||1>f.length)return 16;b=this.Ea.mZ(f);const x=this.Eb.kia(),F=!!x&&(a===ba.a.Vjc||a===ba.a.rgd);if(!b.length&&!x||F||this.Af.NB(b)||this.Af.NB([x]))return 16;
if(1===c)return 32;this.Eb.hj();a!==ba.a.Mjc&&this.Fa.Ad();switch(a){case ba.a.FGb:case ba.a.nGb:if(Object.getType(l)!==Number)return 8;this.c5k(f,b,l);break;case ba.a.Ifb:case ba.a.GGb:case ba.a.Vfb:case ba.a.mGb:var R=this.tVf(b);this.a5k(b,a,l);R&&this.ra.selectShape(R,!1);Mc.a.uO(!0,!1);break;case ba.a.Vjc:case ba.a.rgd:l=[];const fa=a===ba.a.Vjc?1:2;for(R of b)Array.add(l,R);1<f.length?ya.a.J(512500236,815,50,"Set {0} shapes text direction.",f.length):ya.a.J(512500235,815,50,"Set one shape text direction.");
this.gv.c5a(Xa=>{if(Xa=Object(va.a)(4,Xa))Xa.hIb=fa},l);break;case ba.a.Mjc:if(!l||!Object(Fa.a)(Array,l)||1>l.length)return 8;Mc.a.Cb&&(Mc.a.Cb.Ij=!0);b=this.Db.rd(15);try{for(b.jc(l[0].g0),b.$c=a,a=0;a<l.length;a++)l[a].g0.Wga=l[a].s9.left,l[a].g0.Xga=l[a].s9.right,l[a].g0.Yga=l[a].s9.top,l[a].g0.Vga=l[a].s9.bottom}finally{b&&b.dispose()}Mc.a.uO(!0,!1);break;case ba.a.Sfd:case ba.a.Rfd:case ba.a.Qfd:l=[];let wa=1;switch(a){case ba.a.Sfd:wa=0;break;case ba.a.Rfd:wa=1;break;case ba.a.Qfd:wa=2}for(const Xa of b)Array.add(l,
Xa);ya.a.J(512500234,815,50,"Set text anchoring, shape count: {0}.",f.length);this.gv.c5a(Xa=>{if(Xa=Object(va.a)(4,Xa))Xa.Wma=wa},l);Mc.a.uO(!0,!1);break;case ba.a.Pfd:if(!l||Object.getType(l)!==Number)return 8;R=this.tVf(b);this.b5k(b,l,a);R&&this.ra.selectShape(R,!1);Mc.a.uO(!0,!1);break;default:return 8}return 32}Y2d(a,b,c,f,l){b=this.Eb.mg();if(!b||1>b.length)return 16;b=this.Eb.LYd(b);f=b.Fvb;c=0;const x=this.Eb.kia();if(!f&&!x)return 16;switch(a){case ba.a.cbd:a=x?({kva:c}=this.sc.dRe(x)).returnValue&&
0===c?"select":"normal":0===b.Wma?"select":"normal";break;case ba.a.bbd:a=x?({kva:c}=this.sc.dRe(x)).returnValue&&1===c?"select":"normal":1===b.Wma?"select":"normal";break;case ba.a.abd:a=x?({kva:c}=this.sc.dRe(x)).returnValue&&2===c?"select":"normal":2===b.Wma?"select":"normal";break;default:a="disable"}l.Kf("select"===a);return"disable"!==a?32:8}Khg(a,b,c,f,l){c=this.Eb.mg();if(!c||1>c.length)return 16;b=this.Eb.kia();c=this.Ea.mZ(c);if(!c.length&&!b)return 16;this.ym=Date.now();switch(a){case ba.a.QJe:break;
case ba.a.Xad:a=new $M.a;a.Pf=2;a.value=l.MenuItemId;f=!0;b&&(f=this.X$k(b,l),this.Qw=Date.now(),ya.a.J(512500233,815,50,"Query table shape timespan by {0}",(this.Qw-this.ym).toString()));for(const x of c){b=this.Ea.C0d(x);if(!b||!this.fab.fGf(b,a)){f=!1;break}this.RVc&&2===b.Pf&&(b.value=Math.max(0,b.value-this.Ea.eXd(x)))}l.queryResult.Kf(f);break;default:return 8}return 32}b5k(a,b,c){const f=this.Db.rd(15);try{f.jc(a[0]);f.$c=c;for(const l of a)l.Uqa();this.ia.Ka(ba.a.Ila,2,b)}finally{f&&f.dispose()}}a5k(a,
b,c){const f=[];let l=0,x=0;switch(b){case ba.a.Ifb:l=1;x=C.a.jja;break;case ba.a.GGb:l=2;x=C.a.eha;break;case ba.a.Vfb:l=3;x=C.a.sma;break;case ba.a.mGb:l=4,x=C.a.uBa}a=this.ra.gO(a);for(const F of a)F.pl!==l&&Array.add(f,F);if(x&&f.length){for(const F of a)if(F.Mf||F.mh){Qn(F);break}a=this.Db.rd(15);try{a.jc(f[0]);for(const F of f)F.Uqa(),F.S5k(l);this.ia.Ka(x,2,c)}finally{a&&a.dispose()}}}c5k(a,b,c){const f=[];let l=1===c||2===c;for(const F of b)this.$K.$Ff(F,c)||(l=!1,Array.add(f,F));1<a.length?
ya.a.J(512500231,815,50,"ListGallery enabled, set {0} shapes bullet.",a.length):ya.a.J(512500230,815,50,"ListGallery enabled, set one shape bullet.");for(const F of a)if(F.Mf||F.mh){Qn(F);break}a=l?b:f;2!==c||l||(a=b,c=11);if(l||0===c)c=18;const x=this.$K.DSa.ga(c);0<a.length&&this.gv.c5a(F=>{F.setValue(ub.a.gIb,c);x&&(F.setValue(ub.a.Dvh,x.$nb),F.setValue(ub.a.Cvh,x.eUb))},a)}X$k(a,b){let c=!1;const f=b.MenuItemId;let l=b.LineSpacingValue;b=b.LineSpacingUnit;a=nd.SelectionFactory.QEc(Object(va.a)(ag.a,
a));for(const x of a){if(a=x.Kk?x.node:null){a=this.fab.xV(a);const F=Md.a.ty(a.lineSpacing.value,f)&&2===a.lineSpacing.Pf;if(-1===l)b=a.lineSpacing.Pf,l=a.lineSpacing.value;else if(l!==a.lineSpacing.value||b!==a.lineSpacing.Pf)l=b=0,c=!1;0!==b&&(c=F)}if(!c)break}return c}tVf(a){return 0<a.length&&a[0].mh&&(a=this.Ea.Pr(a[0]))?(this.ra.R6(a),a):null}}Object(e.a)(mN,"ShapesTextParagraphActor",null,[244]);var TQ=d(664);class nN{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.ia=a;this.Af=b;this.Db=
c;this.Gz=f;this.Fa=l;this.ra=x;this.Yb=F;this.ta=R;this.Sb=fa;this.Ga=wa;this.Xv=Xa;this.Qb=lb;if(!Lb)throw Error.argumentNull("GraphOperationEventHandler is null");this.Lg=Lb}ub(){this.ia.pa(ba.a.deleteObject,Fb.a.application,Object(D.a)(this,this.ykj,"handleDelete"),4);this.Ga.podsEnableSlideScoreCard&&this.ia.pa(ba.a.fDk,de.a.frame,Object(D.a)(this,this.pwl,"updateSlideScore"),96);this.ia.pa(ba.a.kYf,fc.a.application,Object(D.a)(this,this.Qkj,"handleDuplicate"),4);this.ia.pa(ba.a.HAf,fc.a.application,
Object(D.a)(this,this.ejj,"handleAddFirstSlide"),4);this.Ga.YKj?(this.ia.pa(ba.a.JM,Fb.a.application,Object(D.a)(this,this.Hkj,"handleDeleteSlides"),4),this.ia.pa(ba.a.bS,fc.a.application,Object(D.a)(this,this.Tkj,"handleDuplicateSlides"),4),this.Ga.c4d?(this.ia.pa(ba.a.mPc,fc.a.application,Object(D.a)(this,this.Alj,"handleHideSlides"),4),this.ia.pa(ba.a.Lzh,fc.a.application,Object(D.a)(this,this.Fpj,"handleUnhideSlides"),4),this.Lg.Smb(Object(D.a)(this,this.Gel,"slidesSelectionChangedHandler"))):
this.ia.pa(ba.a.mPc,fc.a.application,Object(D.a)(this,this.I2d,"handleHideSlidesOld"),4),this.ia.pa(ba.a.pBe,Fb.a.application,Object(D.a)(this,this.Knj,"handleQuerySlidesHidden"),96)):(this.ia.pa(ba.a.JM,Fb.a.application,Object(D.a)(this,this.Gkj,"handleDeleteSlide"),4),this.ia.pa(ba.a.bS,fc.a.application,Object(D.a)(this,this.Skj,"handleDuplicateSlide"),4),this.ia.pa(ba.a.mPc,fc.a.application,Object(D.a)(this,this.zlj,"handleHideSlide"),4),this.ia.pa(ba.a.pBe,Fb.a.application,Object(D.a)(this,this.Jnj,
"handleQuerySlideHidden"),96));this.ia.pa(ba.a.MQd,Fb.a.application,Object(D.a)(this,this.Akj,"handleDeleteFakeSlides"),2048);this.ia.pa(ba.a.eNf,Fb.a.application,Object(D.a)(this,this.fkj,"handleClearAndResizeSlideCanvas"),2048);this.ia.xa(ba.a.tnh,fc.a.application,Object(D.a)(this,this.Voj,"handleShareSlide"));this.ia.pa(ba.a.oBe,Fb.a.application,Object(D.a)(this,this.L2d,"handleIsDirectManipulationEnabled"),97)}we(){const a=this.Fa.Bc(xi.a.$C);a.bindAction(A.KeyInputManager.Na(w.a.kna,0),ba.a.JM);
a.bindAction(A.KeyInputManager.Na(w.a.jH,0),ba.a.JM);a.bindAction(A.KeyInputManager.Na(w.a.LJa,A.KeyInputManager.Fe),ba.a.bS)}ykj(a,b,c,f,l){if(this.Fa.ye)if(this.Fa.Xaa===xi.a.$C||1===this.Qb.Nu)a=ba.a.JM;else if(this.Fa.Xaa===Nc.a.yg)a=ba.a.I3a;else return 8;else return 8;return this.ia.Ka(a,c,l)}Gkj(a,b,c){b=this.ta.Ba;if(!b||this.Af.Zc(b)||this.Ga.yz&&1!==this.ra.mf().length)return 16;if(1===c)return 32;if(!b.isConnected)return 16;Mc.a.Cb&&(Mc.a.Cb.actionName="DeleteSlide",Mc.a.Cb.Ar=!1,Mc.a.Cb.Ij=
!0,Mc.a.Cb.Wa("SlideCount","1"));c=this.Yb.yf;if(!c)return 16;const f=this.Db.rd(15,void 0,()=>{this.ra.Ph()});try{f.jc(c),f.$c=a,c.JM(b)}finally{f&&f.dispose()}this.Af.zw(c,a);a=[];a.push(b);this.Xv?this.Xv.aCe(new Vz(a)):ya.a.J(512313375,822,10,"HandleDeleteSlide: graphOperationEventNotifier is null for raising event.");return 32}fkj(a,b,c){a=this.Sb.XH(this.ta.MUc?this.ta.MUc.slideIndex:0);if(!a)return ya.a.J(512313374,822,50,"HandleClearAndResizeSlideCanvas: slideNode null"),8;a=Object(va.a)(253,
a.oc(this.Qb.Ma));if(!a)return ya.a.J(512313373,822,50,"HandleClearAndResizeSlideCanvas: slideViewElement null"),16;if(1===c)return 32;ya.a.J(512313372,822,50,"HandleClearAndResizeSlideCanvas: updating slideViewElement");a.JIe(!1);a.updateOffSlideView(0,!0);return 32}Akj(a,b,c){b=[];for(const f of this.Sb.oKc())f.dN&&Array.add(b,f);if(!b.length||!this.ta.Ba)return ya.a.J(512313371,822,50,"HandleDeleteFakeSlides: empty fake slides"),8;if(1===c)return 32;ya.a.J(512313370,822,50,"HandleDeleteFakeSlides: deleting fake slides");
return this.pVf(b,"DeleteFakeSlide",a)}Hkj(a,b,c){b=this.ra.mf();if(!b||!b.length||!this.ta.Ba)return 16;for(const f of b)if(!f||this.Af.Zc(f))return 16;if(1===c)return 32;for(const f of b)if(!f.isConnected)return 16;return this.pVf(b,"DeleteSlide",a)}pVf(a,b,c){Mc.a.Cb&&(Mc.a.Cb.actionName=b,Mc.a.Cb.Ar=!1,Mc.a.Cb.Ij=!0,Mc.a.Cb.Wa("SlideCount",a.length.toString()));1<a.length?ya.a.J(512313369,822,50,"HandleDeleteSlides: Selected slidenodes: {0}",a.length):ya.a.J(512313368,822,50,"HandleDeleteSlides: Selected one slidenode.");
b=this.Yb.yf;if(!b)return 16;this.nEi(b,a,c,()=>{this.ra.Ph()});return 32}nEi(a,b,c,f){f=this.Db.rd(15,void 0,f);try{f.jc(a);for(const l of b)l&&!l.Bb.equals(this.ta.Ba.Bb)&&a.JM(l);a.JM(this.ta.Ba);f.$c=c}finally{f&&f.dispose()}this.Ga.unblockContentWhenDeletingSlideEnabled||this.Af.zw(a,c);this.Xv?this.Xv.aCe(new Vz(b)):ya.a.J(512313367,822,10,"HandleDeleteSlides: graphOperationEventNotifier is null for raising event.")}Jnj(a,b,c,f,l){a=this.ta.Ba;if(!a)return 16;l.Kf(a.En);return 32}Knj(a,b,c,
f,l){a=this.ra.mf();if(!a||!a.length)return 16;a=this.qId(a);l.Kf(a);return 32}Voj(a,b,c,f,l){a=this.ta.Ba;if(!a||this.Af.Zc(a)||1!==this.ra.mf().length)return 16;if(1===c)return 32;Mc.a.Cb&&(Mc.a.Cb.Ar=!1,Mc.a.Cb.Wa("SlideCount","1"));c=a.Bb;if(!c)return 16;c=JSON.stringify({["sId"]:c.sid,["cId"]:c.cid});l.nav=TQ.a(c);l.mode="copy";ya.a.J(512313364,822,50,"HandleShareSlide: nav:{0}",c);this.ia.Ka(G.a.kBa,2,l);return 32}zlj(a,b,c){b=this.ta.Ba;if(!b||this.Af.Zc(b)||this.Ga.yz&&1!==this.ra.mf().length)return 16;
if(1===c)return 32;Mc.a.Cb&&(Mc.a.Cb.Ar=!1,Mc.a.Cb.Wa("SlideCount","1"));c=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()},()=>{1!==this.Qb.Nu&&this.Fa.Bf(xi.a.$C)});try{c.jc(b),c.$c=a,b.En=!b.En}finally{c&&c.dispose()}return 32}I2d(a,b,c){b=this.ra.mf();if(!b||!b.length)return 16;for(var f of b)if(!f||this.Af.Zc(f))return 8;if(1===c)return 32;ya.a.J(512313363,822,50,"HandleHideSlidesOld: Selected slidenodes: {0}",b.length);Mc.a.Cb&&(Mc.a.Cb.Ar=!1,Mc.a.Cb.Wa("SlideCount",b.length.toString()));
c=!this.qId(b);f=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()},()=>{1!==this.Qb.Nu&&this.Fa.Bf(xi.a.$C)});try{f.jc(this.Yb.yf);f.$c=a;for(const l of b)l.En=c}finally{f&&f.dispose()}return 32}Alj(a,b,c,f,l){const x=this.ra.mf();if(!x||!x.length)return 16;for(const F of x)if(!F||this.Af.Zc(F))return 8;if(this.qId(x))return this.HOc(),32;this.I2d(a,b,c,f,l);this.HOc();return 32}Fpj(a,b,c,f,l){const x=this.ra.mf();if(!x||!x.length)return 16;for(const F of x)if(!F||this.Af.Zc(F))return 8;if(1===
c)return 32;this.I2d(a,b,c,f,l);this.HOc();return 32}HOc(){var a=this.ra.mf();if(a&&a.length){for(var b of a)if(!b||this.Af.Zc(b))return;if(Ag.c()){b=!0;for(const c of a)if(!c.En){b=!1;break}a=[appChrome.actions.updateControlHiddenState("HideSlide",b),appChrome.actions.updateControlEnabledDisabledState("UnhideSlide",!b),appChrome.actions.updateControlHiddenState("UnhideSlide",!b)];appChrome.api.dispatch(a)}else ya.a.J(512313362,822,50,"HandleToggleHiddenBehavior: appChrome not defined")}}Gel(){this.HOc()}pwl(a,
b,c,f,l){if(1===c)return 32;this.ta.Ba&&(a="Slide Complex: "+this.ta.Ba.sa(ub.a.jma,0).toString(),l[Fq.a.Value]=a,l[Am.a.labelText]=a,l[Fq.a.Visible]=!0);return 32}Qkj(a,b,c,f,l){if(this.Fa.ye)if(this.Fa.Xaa===xi.a.$C)a=ba.a.bS;else if(this.Fa.Xaa===Nc.a.yg)a=ba.a.O4a;else return 8;else return 8;return this.ia.Ka(a,c,l)}Skj(a,b,c){b=this.ta.Ba;if(!b||this.Af.Zc(b)||this.Ga.yz&&1!==this.ra.mf().length)return 16;if(1===c)return 32;Mc.a.hk("SlideCount","1");this.Gz.bNi(b,a).VV||this.Af.zw(this.Yb.yf,
a);return 32}Tkj(a,b,c){b=this.ra.mf();if(!b||!b.length)return 16;for(var f of b)if(!f||this.Af.Zc(f))return 16;if(1===c)return 32;1<b.length?ya.a.J(512313361,822,50,"HandleDuplicateSlides: Selected slidenodes: {0}",b.length):ya.a.J(512313360,822,50,"HandleDuplicateSlides: Selected one slidenode.");Mc.a.hk("SlideCount",b.length.toString());c=this.Gz.m0f(b,a,null,null,!0);f=!0;for(const l of c)if(!l.VV){f=!1;break}f||this.Af.zw(this.Yb.yf,a);return 32}ejj(){try{ya.a.J(512313359,801,50,"SlideActor: HandleAddFirstSlide called.");
const a=this.Sb.TH();a&&0<a.length&&this.Gz.lIc(null,a[0].Id,this.Ga.d5b?0:a[0].ContentMasters[0].Id,ba.a.BBb);return 32}catch(a){return ya.a.J(512313358,801,10,"Exception in HandleAddFirstSlide: {0}.",a),8}}L2d(a,b,c,f,l){return l&&Object(Fa.a)(oe.a,l)?this.Af.Zc(this.Sb.$k(l))?16:32:8}qId(a){for(const b of a)if(!b.En)return!1;return!0}}Object(e.a)(nN,"SlideActor",null,[244]);class oN{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(e.a)(oN,"GallerySectionProps",
null,[]);const DE=()=>{appChrome.PRIToastManager.dismissToast()};class EE{constructor(a,b,c){this.slideId=a;this.S$j=b;this.iti=c}}Object(e.a)(EE,"NewSlideWithLayoutData",null,[]);class nj{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){this.sta=0;this.nZc={};this.oOg=this.pOg=0;this.ia=a;this.Xb=b;this.Fa=c;this.z2j=nj.VEj(f);this.ra=l;this.Db=x;this.Gz=F;this.Yb=R;this.ta=fa;this.Sb=wa;this.ufe=Xa;this.nu=lb;this.nu.Gzc(Object(D.a)(this,this.w1g,"openIgnoredDialog"));this.Ga=Lb;this.Pzb=kc;this.Pta=
{}}ub(){this.Ga.XKj?this.ia.pa(ba.a.Mpa,fc.a.application,Object(D.a)(this,this.gig,"handleSlidesChangeLayout"),4):this.ia.pa(ba.a.Mpa,fc.a.application,Object(D.a)(this,this.Yjj,"handleChangeLayout"),4);this.ia.pa(ba.a.oGa,fc.a.application,Object(D.a)(this,this.whg,"handleNewSlideWithLayoutOptions"),4);this.ia.pa(ba.a.kla,fc.a.application,Object(D.a)(this,this.vhg,"handleNewSlideWithDefaultLayout"),4);this.ia.pa(ba.a.BBb,fc.a.application,Object(D.a)(this,this.vhg,"handleNewSlideWithDefaultLayout"),
4);this.ia.pa(ba.a.L5c,fc.a.application,Object(D.a)(this,this.Emj,"handleNewSlideWithLayout"),4);this.ia.pa(ba.a.T4g,fc.a.application,Object(D.a)(this,this.whg,"handleNewSlideWithLayoutOptions"),4);this.ia.pa(ba.a.CQc,fc.a.application,Object(D.a)(this,this.goj,"handleReactInsertSlideWithLayout"),4);this.ia.pa(ba.a.Vvk,fc.a.application,Object(D.a)(this,this.gig,"handleSlidesChangeLayout"),4);this.ia.pa(ba.a.ALd,fc.a.application,Object(D.a)(this,this.foj,"handleReactChangeSlideLayout"),4);this.ia.pa(ba.a.tad,
fc.a.application,Object(D.a)(this,this.tad,"queryNewSlideLayout"),4);this.ia.pa(ba.a.zAe,fc.a.application,Object(D.a)(this,this.zAe,"queryChangeSlideLayout"),4)}we(){const a=this.Fa.Bc(xi.a.$C),b=this.Fa.Bc(xi.a.B1),c=this.Fa.Bc(Nc.a.yg),f=this.Fa.Bc(Nc.a.sP);a.bindAction(A.KeyInputManager.Na(w.a.aq,0),ba.a.kla);a.bindAction(A.KeyInputManager.Na(w.a.ffa,A.KeyInputManager.Fe),ba.a.kla);c.bindAction(A.KeyInputManager.Na(w.a.ffa,A.KeyInputManager.Fe),ba.a.kla);b.bindAction(A.KeyInputManager.Na(w.a.ffa,
A.KeyInputManager.Fe),ba.a.kla);f.bindAction(A.KeyInputManager.Na(w.a.ffa,A.KeyInputManager.Fe),ba.a.kla)}skc(){return this.z2j||this.Sb.t3d()}Yjj(a,b,c){const f=this.ta.Ba;if(!f||this.Xb.Zc(f)||this.Ga.yz&&1!==this.ra.mf().length)return 16;a=f.uj;if(!a)return 8;b=this.Sb.TH();if(!this.Ga.fSa){if(!b)return ya.a.J(512500229,822,10,"SlideLayoutActor::HandleChangeLayout fails to get mainMasters"),8;if(!this.Mhb(b,a))return 8}if(1===c)return 32;if((!this.Ga.fSa||b&&this.Mhb(b,a))&&this.nu.VN.Jb(a)&&this.ube()){this.sta=
0;c=f.Xn;if(!c)return ya.a.J(512500227,822,10,"SlideLayoutActor::HandleChangeLayout fails to get contentMasterId"),8;this.ufe.BOd(0,this.Sb.Jv(),b,this.nu.VN,a,Object(D.a)(this,this.ALd,"changeSlideLayout"),this.skc(),u.AFrameworkApplication.isRtl).khd(c)}else ya.a.J(512500228,822,50,"SlideLayoutActor::HandleChangeLayout does not have MainMasterResources ready yet"),this.nu.eNe(a),this.sta=ba.a.Mpa;return 32}gig(a,b,c,f,l){b=this.ra.mf();if(!b||!b.length)return 8;f=0;const x=[],F=this.Sb.TH();if(!F)return ya.a.J(512500226,
822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get mainMasters"),8;for(var R of b){if(this.Xb.Zc(R)||!R)return 16;f=R.uj;if(!f)return ya.a.J(512500225,822,50,"SlideLayoutActor::HandleSlidesChangeLayout MainmasterId is 0"),8;x.push(f);if(!this.Ga.fSa&&!this.Mhb(F,f))return ya.a.J(512500224,822,50,"SlideLayoutActor::HandleSlidesChangeLayout fails to validate masters"),8}if(1===c&&!this.Ga.QWa)return 32;for(const fa of x)if(this.Ga.fSa&&!this.Mhb(F,f)||!this.nu.VN.Jb(fa)){ya.a.J(512500195,
822,50,"SlideLayoutActor::HandleSlidesChangeLayout does not have MainMasterResources ready yet");this.nu.eNe(f);if(this.Ga.QWa)return this.h3d(a,c,()=>{this.nu.Gzc(DE)},l);this.sta=ba.a.Mpa;return 32}R=this.sta=0;for(const fa of b)if(R=fa.Xn,!R)return ya.a.J(512500194,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get contentMasterId"),8;1<b.length?ya.a.J(512500193,822,50,"HandleSlidesChangeLayout: Selected slidenodes: {0}",b.length):ya.a.J(512500192,822,50,"HandleSlidesChangeLayout: Selected one slidenode.");
1<b.length&&(R=0);if(!this.ube())return ya.a.J(512500191,822,50,"HandleSlidesChangeLayout: Layout masters not ready yet "),ee.a("RaiseFirstMasterRetrievedEvent")?this.h3d(a,c,()=>{this.nu.R3h(DE)},l):8;if(this.Ga.QWa){if(1===c)return 32;if(!l)return 8;this.oOg=R;this.S4g(l,F,f,!0)}else this.ufe.BOd(0,this.Sb.Jv(),F,this.nu.VN,f,Object(D.a)(this,this.ZLf,"changeSlidesLayout"),this.skc(),u.AFrameworkApplication.isRtl).khd(R);return 32}ALd(a,b){const c=this.ta.Ba;if(c){var f=()=>{this.Fa.Ad();this.ra.Ph()},
l=()=>{this.Fa.Bf(xi.a.$C)};a=parseInt(a);b=parseInt(b);if(a!==c.uj||b!==c.Xn){const x=Mc.a.Cb;Mc.a.Qkd("ChangeSlideLayout");Mc.a.Cb&&(Mc.a.Cb.Ar=!0,Mc.a.Cb.Wa("SlideCount","1"));f=this.Db.rd(15,void 0,f,l);try{f.jc(c),f.$c=ba.a.Mpa,c.uj=a,c.Xn=b}finally{f&&f.dispose()}this.Xb.zw(c,"ChangeSlideLayout");Mc.a.Cb=x}}}ZLf(a,b){const c=this.ra.mf();if(c&&c.length){a=parseInt(a);b=parseInt(b);var f=Mc.a.Cb;Mc.a.Qkd("ChangeSlidesLayout");Mc.a.Cb.Ar=!0;var l=[];for(var x of c)a===x.uj&&b===x.Xn||l.push(x);
if(l.length){Mc.a.hk("SlideCount",l.length.toString());x=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()},()=>{this.Fa.Bf(xi.a.$C)});try{x.jc(this.ta.Ba);x.$c=ba.a.Mpa;for(const F of l)F.uj=a,F.Xn=b}finally{x&&x.dispose()}for(const F of c)this.Xb.zw(F,"ChangeSlidesLayout");Mc.a.Cb=f}}}foj(a,b,c,f,l){if(1===c)return 32;if(!l)return 8;try{let x,F;if(!({masterId:x,layoutId:F}=this.vRe(l.SourceControlId)).returnValue)return 8;ya.a.J(512500189,822,50,"SlideLayoutActor:: React Change Layout Dropdown invoked command to Change Layout.");
this.ZLf(x,F)}catch(x){return ya.a.J(512500188,822,10,"SlideLayoutActor:: react change slide layout failed with Exception {0} ",x),8}return 32}whg(a,b,c,f,l){f=this.Yb.yf;if((b=this.ta.Ba)&&this.Xb.Zc(b)||this.Xb.Zc(f))return ya.a.J(512500187,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutOptions Graph node blocked"),16;f=this.Sb.TH();if(!f||!f.length)return ya.a.J(512500186,822,10,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to get mainMasters"),8;let x=0;if(b){if(x=b.uj,!x)return ya.a.J(512500185,
822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog MainMasterId is 0"),8}else x=f[0].Id;let F=0;({uj:x,Xn:F}=this.hLc(f,b));if(!this.Ga.fSa&&!this.Mhb(f,x))return ya.a.J(512500184,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to validate mainMasters"),8;if(1===c){if(!this.Sb.Nj())return 8;if(!this.Ga.QWa)return 32}if(this.Ga.fSa&&!this.Mhb(f,x)||!this.nu.VN.Jb(x)||!this.ube()){ya.a.J(512500183,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog does not have MainMasterResources ready yet");
this.nu.eNe(x);if(this.Ga.QWa)return this.h3d(a,c,()=>{this.nu.Gzc(DE)},l);this.sta=ba.a.oGa}else if(this.sta=0,this.Ga.QWa){if(1===c)return 32;if(!l)return 8;this.pOg=F;this.S4g(l,f,x,!1)}else this.ufe.BOd(1,this.Sb.Jv(),f,this.nu.VN,x,Object(D.a)(this,this.CQc,"insertSlideWithLayout"),this.skc(),u.AFrameworkApplication.isRtl).khd(F);return 32}S4g(a,b,c,f){a.MenuId&&"style"===a.MenuId||(a.MenuItems=ee.a("ReactSlideLayoutSectionsAPIEnabled")?this.S_d(b,c,f):this.I$i(b,c,f));ya.a.J(512500182,822,50,
"SlideLayoutActor:: React Slide Layout DropDown Invoked. Type : IsChangeLayout : {0}  ",f)}o0d(){const a=this.Sb.Jv();if(!a||!a.width||!a.height)return ya.a.J(512500181,822,15,"SlideLayoutActor:: Slide size is null or 0"),new er.a(nj.LJf,nj.igi);const b=nj.LJf;return new er.a(b,a.height/a.width*b)}U9f(){const a={},b={},c=this.o0d();b.root=this.Rzi(c.width+nj.VJf,c.height+nj.VJf+nj.bgi+nj.ogi);b.flexContainer={flexDirection:"column"};b.label={"margin-top":"5px","max-width":"100px","font-size":"10px"};
a.galleryButtonInExpanded=b;return a}Rzi(a,b){const c={};c.width=a;c.height=b;c.backgroundColor="transparent";return c}I$i(a,b,c){this.bcd();const f=Object.assign(new sk.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});let l=0,x=!1;const F=a.length;if(!F||1===F&&a&&a[0]&&!a[0].InContent)return f;for(var R=0;R<F;R++)a[R].Id===b&&(l=R,x=!0);x&&(b=this.wag(a[l],b,c,l),Array.add(f.MenuSectionList,b));for(b=0;b<F;b++)x&&b===l||(R=this.wag(a[b],a[b].Id,
c,b),Array.add(f.MenuSectionList,R));return f}wag(a,b,c,f){const l=Object.assign(new Si.a,{ControlList:[],Title:a.Name});if(!(a.InContent&&this.nu.VN&&this.nu.VN.Jb(a.Id)))return l;var x=this.U9f(),F=c?"ChangeLayout":"NewSlide",R=c?"ChangeLayoutControls":"NewSlideLayoutControls";nj.Y3c++;f=ee.a("ReactSlideLayoutUniqueIdFix")?f.toString():b.toString()+"_"+nj.Y3c.toString();x=Object.assign(new uq.a,{Id:R,ExternalId:F+"_"+f,Type:4,Title:a.Name,GalleryStyle:x,Width:3,GalleryItems:[]});a=a.ContentMasters;
if(!a)return l;F=a.length;for(R=0;R<F;R++)f=a[R],!f||!this.skc()&&this.Sb.$7a(f)||Array.add(x.GalleryItems,this.gKc(f,b,c));Array.add(l.ControlList,x);return l}Nmi(){try{const a=[],b=this.Pta;for(let c in b)a.push(c);this.Pta={};this.nZc={};appChrome.api.unregisterIcons(a)}catch(a){ya.a.J(512500180,822,15,"SlideLayoutActor::Failed to unregister icons for react new slide layout {0}",a)}}bcd(){this.Nmi();try{const a=this.Sb.TH();if(a){for(let b=0;b<a.length;b++){const c=a[b];c&&this.nu.VN&&this.nu.VN.count&&
this.nu.VN.Jb(c.Id)&&this.addIconToMap(this.nu.VN.ga(c.Id).LayoutIcons,c.Id)}appChrome.api.registerIconProvider(()=>this.Pta)}}catch(a){ya.a.J(512500179,822,15,"SlideLayoutActor::Failed to register icons for react new slide layout {0}",a)}}X_b(a,b){a=String.format("{0}_{1}_{2}",nj.itj,a,b);a in this.nZc||(nj.Y3c++,this.nZc[a]=a+"_"+nj.Y3c.toString());return this.nZc[a]}addIconToMap(a,b){if(this.ta.Ba&&a)for(let f=0;f<a.length;++f){var c=a[f];if(!c)continue;const l=this.X_b(b,c.LayoutId),x={},F={};
c.Icon&&c.Icon.Clip&&c.Icon.Clip.Bounds&&(F.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top),u.AFrameworkApplication.isRtl&&ee.a("ReactSlideLayoutRTLFix")?F.right=String.format("-{0}px",c.Icon.Clip.Bounds.Left):F.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left));F.position="absolute";const R={},fa={},wa=this.o0d();fa.height=wa.height.toString()+"px";fa.width=wa.width.toString()+"px";fa.position="relative";fa.overflow="hidden";fa.display="inline-block";R.root=fa;x.root=F;this.Pzb&&c.Icon&&(c=
appChrome.buildLayoutImageIconFromUrlWithStyles(this.Pzb.resolve(gg.a.kqb,c.Icon.ImgId),x,R),this.Pta[l]=c)}}S_d(a,b,c){this.bcd();const f=Object.assign(new sk.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});var l=Object.assign(new Si.a,{Id:c?"ChangeLayoutMenuSection":"NewSlideLayoutMenuSection",ControlsId:c?"ChangeLayoutMenuSection.Controls":"NewSlideLayoutMenuSection.Controls",ControlList:[]});Array.add(f.MenuSectionList,l);var x=this.U9f();
x=Object.assign(new uq.a,{Id:c?"ChangeLayoutControls":"NewSlideLayoutControls",ExternalId:c?"ChangeLayoutSection":"NewSlideSection",ExternalGalleryId:c?"ChangeLayoutGallery":"NewSlideGallery",GalleryStyle:x,Width:3,Type:4,GallerySections:[]});Array.add(l.ControlList,x);l=0;let F=!1;const R=a.length;ya.a.J(512500178,822,50,"React Slide layout: Count of main masters :{0}",R);if(!R||1===R&&a&&a[0]&&!a[0].InContent)return ya.a.J(512500177,822,10,"React Slide layout rendered empty as main masters not loaded; Type: IsChangelayout:{0} cMainMasters: {1} InContent: {2} ",
c,R,1===R&&!!a&&!!a[0]&&a[0].InContent),f;for(var fa=0;fa<R;fa++)a[fa].Id===b&&(l=fa,F=!0);F&&(b=this.Q4g(a[l],b,c),x.GallerySections.push(b));for(b=0;b<R;b++)F&&b===l||(fa=this.Q4g(a[b],a[b].Id,c),x.GallerySections.push(fa));return f}Q4g(a,b,c){const f=Object.assign(new oN,{SectionId:b.toString(),Title:a.Name,GalleryButtons:[]});if(!(a.InContent&&this.nu.VN&&this.nu.VN.Jb(a.Id)))return ya.a.J(512500176,822,50,"React Slide layout: Gallery section rendered empty as main masters not loaded;Type: IsChangelayout:{0} , mainMaster.InContent: {1} , presentatonresourcemanager contains main master : {2} ",
c,a.InContent,!!this.nu.VN&&this.nu.VN.Jb(a.Id)),f;a=a.ContentMasters;if(!a)return ya.a.J(512500175,822,50,"React Slide layout: Gallery section rendered empty as content master is null ;Type: IsChangelayout:{0} ",c),f;const l=a.length;for(let x=0;x<l;x++){const F=a[x];!F||!this.skc()&&this.Sb.$7a(F)||Array.add(f.GalleryButtons,this.gKc(F,b,c))}return f}FBa(a,b,c){return ee.a(nj.XLf)?(c?"ChangeLayoutButton_":"NewSlideLayoutButton_")+a+"_"+b:a+"_"+b}gKc(a,b,c){const f=a.Id,l=this.FBa(b.toString(),f.toString(),
c),x={},F={},R=this.o0d();F.width=R.width.toString()+"px";F.height=R.height.toString()+"px";ee.a("ReactNewSlideLayoutIconBorderFix")||(F.border="#858585 1px solid");x.root=F;return Object.assign(new dE.a,{Id:l,ExternalId:l,Icon:this.X_b(b,f),Command:c?"3430900587":"1579226270",QueryCommand:ee.a("NewSlideLayoutShowCurrentLayout")?c?"630989293":"2230133927":null,LabelText:a.Name,FullIconStyle:x,Alt:a.Name})}vhg(a,b,c){if(this.Xb.QP(this.Yb.yf))return 16;b=this.Sb.TH();if(!b)return 8;let f=null;if(this.Ga.yz){var l=
this.ra.mf();1<=l.length&&(l.sort((F,R)=>F.De-R.De),a!==ba.a.BBb&&(f=l[l.length-1]))}else a!==ba.a.BBb&&(f=this.ta.Ba);if(this.Xb.Zc(f))return 16;let x;({uj:l,Xn:x}=this.hLc(b,this.ta.Ba));if(!this.Mhb(b,l))return 8;if(1===c)return 32;c=this.Gz.lIc(Object(va.a)(123,f),l,x,a);this.YAf(l,x);c.VV||this.Xb.zw(c,a);return 32}Emj(a,b,c,f,l){if(this.Xb.QP(this.Yb.yf))return 16;if(1===c)return 32;if(!l)return 8;c=l.slideId;b=l.S$j;l=l.iti;f=null;this.Ga.yz?(c=this.ra.mf(),1<=c.length&&(c.sort((x,F)=>x.De-
F.De),f=c[c.length-1])):f=this.Sb.$k(c);c=this.Gz.lIc(f,b,l,a);this.YAf(b,l);c.VV||this.Xb.zw(c,a);return 32}dispose(){this.nu.KPk(Object(D.a)(this,this.w1g,"openIgnoredDialog"));this.Pta=null}CQc(a,b){const c=this.ta.Ba;let f=oe.a.empty;c&&(f=c.Bb);const l=this.Sb.TH();l&&("0"===a||"0"===b?{uj:a,Xn:b}=this.hLc(l,c):(a=parseInt(a),b=parseInt(b)),this.ia.Ka(ba.a.L5c,2,new EE(f,a,b)))}goj(a,b,c,f,l){if(1===c)return 32;if(!l||!({masterId:c,layoutId:b}=this.vRe(l.SourceControlId)).returnValue)return 8;
f=this.ta.Ba;a=oe.a.empty;f&&(a=f.Bb);l=this.Sb.TH();if(!l)return 8;"0"===c||"0"===b?{uj:c,Xn:b}=this.hLc(l,f):(c=parseInt(c),b=parseInt(b));ya.a.J(512500172,822,50,"SlideLayoutActor:: React New Slide Dropdown invoked command to insert new slide.");return this.ia.Ka(ba.a.L5c,2,new EE(a,c,b))}hLc(a,b){let c,f;f=c=0;if(!this.wOi(a))return{uj:c,Xn:f};if(b){c=b.uj;if(!c)return{uj:c,Xn:f};if(!this.Ga.d5b||this.TOi(c)){f=b.Xn;if(!f)return{uj:c,Xn:f};if(b.nSa)for(b=0;b<a.length;b++)if(a[b].Id===c&&1<a[b].ContentMasters.length){f=
a[b].ContentMasters[1].Id;break}}}else c=a[0].Id,f=this.Ga.d5b?0:a[0].ContentMasters[0].Id;return{uj:c,Xn:f}}v0f(a,b,c){if(1===a)return 32;a=this.vRe(b.SourceControlId);if(!a.returnValue)return 8;a.layoutId&&"0"!==a.layoutId&&(b[fm.a.On]=a.layoutId===(c?this.oOg.toString():this.pOg.toString()));return 32}tad(a,b,c,f,l){return this.v0f(c,l,!1)}zAe(a,b,c,f,l){return this.v0f(c,l,!0)}vRe(a){let b,c;c=b=null;if(!a)return ya.a.J(512500171,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),
{returnValue:!1,masterId:b,layoutId:c};a=a.split("_");const f=ee.a(nj.XLf),l=f?1:0,x=f?2:1;if(!a||a.length!==(f?3:2))return ya.a.J(512500170,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};b=a[l];c=a[x];return{returnValue:!0,masterId:b,layoutId:c}}wOi(a){if(0===a.length)return!1;for(let b=0;b<a.length;++b)if(0!==a[b].ContentMasters.length)return!0;return!1}w1g(){this.sta&&(ya.a.J(512500169,822,50,"SlideLayoutActor::OpenIgnoredDialog is auto-opening dialog {0}",
this.sta===ba.a.Mpa?"ChangeLayout":"NewSlide"),this.ia.processAction(this.sta,2));this.sta=0}Mhb(a,b){for(let c=0;c<a.length;c++)if(a[c].Id===b)return!0;return!1}YAf(a,b){Mc.a.hk("MainMasterId",a.toString());Mc.a.hk("ContentMasterId",b.toString());const c=this.Sb.TH(),f=new Sys.StringBuilder;if(c){for(let l=0;l<c.length;l++)f.appendLine(String.format("MainMasterId={0}, ContentMasterCount={1}; ",c[l].Id,c[l].ContentMasters.length));ya.a.J(512500168,813,50,"Insert slide with layout: MainMasterCount={0}. {1}. SelectedMainMasterId={2}, SelectedContentMasterId={3}",
c.length,f,a,b)}}ube(){return this.nu.HGf()}TOi(a){if(0===a)return!1;const b=this.Sb.vrb();if(b&&0<b.length)for(const c of b)if(c.idField===a&&0<c.layoutCountField)return!0;return!1}h3d(a,b,c,f){this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)?1===b?a=32:2===b?(b={},f=!!f&&f.IsShadowMenuOpen,b.payload={["isShadowRendering"]:f},u.AFrameworkApplication.aDb.handleCommand(ce.ActionManager.z2a(a),b),f||c(),a=2):a=8:a=8;return a}static VEj(a){return a===nj.lgi||a===
nj.mgi||a===nj.jgi||a===nj.ngi||a===nj.kgi}}nj.lgi=1041;nj.mgi=1042;nj.jgi=2052;nj.ngi=1028;nj.kgi=3076;nj.itj="LayoutIcon";nj.XLf="ReactSlideLayoutButtonIdChange";nj.LJf=145;nj.igi=82;nj.VJf=24;nj.bgi=14;nj.ogi=5;nj.Y3c=1;Object(e.a)(nj,"SlideLayoutActor",null,[244,106]);class pN{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.mF=this.M8=this.Kab=this.N8=null;this.ia=a;this.iQ=b;this.Fa=c;this.Xb=f;this.Gz=l;this.Yb=x;this.ta=F;this.yc=R;this.Ie=fa;this.kfe=wa(500,Object(D.a)(this,this.G9c,"performKeyboardThumbnailReorder"));
this.ra=Xa;this.Sp=lb;this.LEa=Lb}ub(){this.ia.pa(ba.a.gcc,Fb.a.application,Object(D.a)(this,this.xmj,"handleMoveSlide"),4);this.ia.pa(ba.a.CTg,Fb.a.application,Object(D.a)(this,this.ymj,"handleMoveSlideById"),4);this.ia.pa(ba.a.pcb,fc.a.application,Object(D.a)(this,this.AOc,"handleReorderSlide"),4);this.ia.pa(ba.a.mcb,fc.a.application,Object(D.a)(this,this.AOc,"handleReorderSlide"),4);this.ia.pa(ba.a.ocb,fc.a.application,Object(D.a)(this,this.AOc,"handleReorderSlide"),4);this.ia.pa(ba.a.ncb,fc.a.application,
Object(D.a)(this,this.AOc,"handleReorderSlide"),4);this.ia.pa(ba.a.hcc,fc.a.application,Object(D.a)(this,this.nkj,"handleCommitPendingMoveSlideData"),4);this.ia.pa(ba.a.icc,fc.a.application,Object(D.a)(this,this.Bnj,"handleQueryCommitMoveSlideDataEnabled"),100)}we(){const a=this.Fa.Bc(xi.a.$C);a.bindAction(A.KeyInputManager.Na(w.a.C0,A.KeyInputManager.Fe),ba.a.pcb);a.bindAction(A.KeyInputManager.Na(w.a.A0,A.KeyInputManager.Fe),ba.a.mcb);a.bindAction(A.KeyInputManager.Na(w.a.C0,A.KeyInputManager.Fe|
4),ba.a.ocb);a.bindAction(A.KeyInputManager.Na(w.a.A0,A.KeyInputManager.Fe|4),ba.a.ncb)}ymj(a,b,c,f,l){a=this.ta.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.LEa&&(this.Sp&&1<this.ra.mf().length||this.Xb.ARa()))return 16;if(1===c)return 32;if(!l)return ya.a.J(50348433,822,10,"HandleMoveSlideById with no null action data."),8;b=l.vda;c=[];for(var x of b)(b=a.KB(x))?c.push(b):ya.a.J(50348435,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",
x.sid,x.cid);x=l.Ba?a.KB(l.Ba):null;b=a.KB(l.acc);f=null;0<=l.sectionIndex&&(f=a.Scg(l.sectionIndex));return this.thg(c,b,x,f,l.i9d)}xmj(a,b,c,f,l){return!this.LEa&&(this.Sp&&1<this.ra.mf().length||this.Xb.ARa())?16:1===c?32:l?this.thg(l.vda,l.acc,l.Ba,null,l.i9d):8}thg(a,b,c,f,l){if(this.LEa)for(var x of a)if(!x||this.Xb.Zc(this.yc.$k(x.Bb)))return 16;x=[];for(var F of a){if(!F)continue;const R=this.yc.$k(F.Bb);R?x.push(R):ya.a.J(591737178,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",
F.Bb.sid,F.Bb.cid)}if(F=Mc.a.Cb)F.Ij=!0,F.BE||(F.BE=new Date),x&&F.Wa("SlideCount",a.length.toString());F=null;l||(this.LEa?c&&(F=c):a&&0<a.length&&(F=a[0]),F&&!this.Yb.Ba.Bb.equals(F.Bb)&&(this.Yb.Ba=this.yc.$k(F.Bb)));a=b?this.yc.$k(b.Bb):null;this.Gz.hNi(x,a,f);return 32}AOc(a,b,c){if(this.iQ.uZ||!this.ta.Ba||this.Xb.Zc(this.Yb.yf)||!this.LEa&&this.Sp&&1<this.ra.mf().length)return 16;if(1===c)return 32;if(this.LEa){b=this.ra.mf();if(!b||!b.length)return 16;this.Ull(b,a)}else this.Pll(this.ta.Ba,
a);return 32}nkj(a,b,c){if(this.Xb.Zc(this.Yb.yf)||!this.tMf())return 16;if(1===c)return 32;this.G9c();return 32}Bnj(){return this.N8?32:16}unb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].slideIndex-a[b].slideIndex)return!1;return!0}Pll(a,b){var c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Ie.o0;if(!(1>=f)){var l=!1;this.Kab||(this.Kab=a,this.mF=c.slides||[],l=!0);a=-1;for(c=0;c<f;c++)if(this.mF[c]&&this.Kab.Bb.equals(this.mF[c].Bb)){a=
c;break}if((b!==ba.a.pcb&&b!==ba.a.ocb||a)&&(b!==ba.a.mcb&&b!==ba.a.ncb||a!==f-1)){switch(b){case ba.a.pcb:b=a-1;break;case ba.a.mcb:b=a+1;break;case ba.a.ocb:b=0;break;case ba.a.ncb:b=f-1;break;default:return}Array.removeAt(this.mF,a);Array.insert(this.mF,b,this.Kab);for(l=0;l<f;l++)this.mF[l]?this.mF[l].De=l:ya.a.J(576758465,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",l,f);this.Ie.PHa(b);f=new Gx(!0,[this.Kab],0<b?this.mF[b-1]:null);this.NGf(f)}else l&&
(this.mF=this.Kab=null)}}Ull(a,b){var c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Ie.o0;if(!(1>=f)&&(a.sort((x,F)=>x.slideIndex-F.slideIndex),this.unb(a))){var l=!1;this.M8||(this.M8=a,this.mF=c.slides||[],l=!0);a=this.lNc(this.M8[0],this.mF);c=this.lNc(this.M8[this.M8.length-1],this.mF);if((b!==ba.a.pcb&&b!==ba.a.ocb||a)&&(b!==ba.a.mcb&&b!==ba.a.ncb||c!==f-1)){l=null;switch(b){case ba.a.pcb:l=0<=a-2?this.mF[a-2]:null;b=a-1;break;case ba.a.mcb:b=a+this.M8.length<
f?a+this.M8.length:f-1;l=this.mF[b];break;case ba.a.ocb:l=null;b=0;break;case ba.a.ncb:l=this.mF[f-1];b=f-1;break;default:return}for(a=this.M8.length-1;0<=a;a--)this.a7h(this.M8[a],l);for(a=0;a<f;a++)this.mF[a]?this.mF[a].De=a:ya.a.J(576758466,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",a,f);this.Ie.PHa(b);f=new Gx(!0,this.M8,l);this.NGf(f)}else l&&(this.mF=this.M8=null)}}a7h(a,b){const c=this.lNc(a,this.mF);Array.removeAt(this.mF,c);b=this.lNc(b,this.mF)+
1;Array.insert(this.mF,b,a)}lNc(a,b){if(a&&b)for(let c=0;c<b.length;c++)if(a.Bb.equals(b[c].Bb))return c;return-1}j$h(a,b){if(!a||!b)return a!==b?!1:!0;if(a.length!==b.length)return!1;for(const c of a){a=!1;for(const f of b)if(c&&f&&c.Bb.equals(f.Bb)){a=!0;break}if(!a)return!1}return!0}NGf(a){if(!a)throw Error.argumentNull("moveData");this.LEa?this.j$h(this.M8,a.vda)||this.G9c():this.N8&&this.N8.vda&&a.vda&&this.N8.vda[0]&&a.vda[0]&&!this.N8.vda[0].Bb.equals(a.vda[0].Bb)&&this.G9c();this.N8=a;this.kfe.perform()}G9c(){if(this.tMf()){var a=
this.N8;this.M8=this.Kab=this.N8=null;Array.clear(this.mF);this.ia.Ka(ba.a.gcc,2,a)}}tMf(){const a=this.ta.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.N8)return!1;let b=!0,c=!this.N8.acc;for(let f=0;f<this.N8.vda.length;f++)b=!!a.KB(this.N8.vda[f].Bb)&&b;c||(c=!!a.KB(this.N8.acc.Bb));return b&&c}}Object(e.a)(pN,"SlideMoveActor",null,[244]);class Vx extends Zw.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(e.a)(Vx,"TableGalleryButtonProps",
Zw.a,[]);class qN extends Vx{constructor(){super()}get Type(){return 8}}Object(e.a)(qN,"ChangeColorsGalleryButtonProps",Vx,[]);class rN{constructor(){this.hasMath=this.fReverseEnabled=this.fReverseChecked=!1;this.SemanticNodes=null;this.SmartArtLayout=0}}Object(e.a)(rN,"SmartArtInfo",null,[]);var Ws=d(485);class Ai{constructor(a,b,c){this.zI=a;this.O5j=b;this.q7j=c}get id(){return this.zI}get parameter(){return this.O5j}get Pfh(){return this.q7j}}Object(e.a)(Ai,"SmartArtColorInfo",null,[]);class sN{constructor(a,
b,c,f,l,x,F,R,fa,wa,Xa,lb){this.Up=[];this.ia=a;this.Xb=b;this.nb=c;this.Db=f;this.Fa=l;this.ta=x;this.Mx=F;this.Sb=R;this.Qb=wa;this.gl=Xa;this.Ea=lb;this.Kwk()}ub(){this.ia.pa(ba.a.nRa,Fb.a.view,Object(D.a)(this,this.Vlj,"handleInsertSmartArt"),4);this.ia.pa(ba.a.Uel,Fb.a.application,Object(D.a)(this,this.dpj,"handleSmartArtToolsTabViewHandler"),4);this.ia.pa(ba.a.zCc,Fb.a.application,Object(D.a)(this,this.ckj,"handleChangeSmartArtLayout"),4);this.ia.pa(ba.a.Jwk,Fb.a.application,Object(D.a)(this,
this.rnj,"handlePopulateSmartArtColorStyles"),96);this.ia.pa(ba.a.MUb,Fb.a.application,Object(D.a)(this,this.akj,"handleChangeSmartArtColor"),4);this.ia.pa(ba.a.aki,Fb.a.application,Object(D.a)(this,this.bkj,"handleChangeSmartArtColorAnchor"),4);this.ia.pa(ba.a.ACc,Fb.a.application,Object(D.a)(this,this.dkj,"handleChangeSmartArtStyle"),4);this.ia.pa(ba.a.HHa,Fb.a.application,Object(D.a)(this,this.toj,"handleResetSmartArt"),4);this.ia.pa(ba.a.egh,Fb.a.application,Object(D.a)(this,this.xoj,"handleReverseSmartArt"),
4);this.ia.pa(ba.a.fBe,Fb.a.application,Object(D.a)(this,this.Gnj,"handleQueryReverseSmartArt"),97);this.ia.pa(ba.a.gJi,Fb.a.application,Object(D.a)(this,this.Ukj,"handleEditSmartArtText"),4);this.ia.pa(ba.a.FAe,Fb.a.application,Object(D.a)(this,this.Cnj,"handleQueryEditSmartArtText"),96)}we(){}Vlj(a,b,c,f,l){b=this.ta.Ba;if(!b||this.Xb.Zc(b))return 16;if(1===c)return 32;this.m9c(l,a);if(!l)return 8;if((c=b.j2(this.nb.ae()))&&this.Xb.Zc(c))return 16;if(!this.gl.lI(b,1))return this.gl.kJ(b),16;const x=
this.hdj(b,c,l);l=this.Db.rd(15,void 0,()=>{this.nb.ly();this.nb.Ph();this.Fa.Ad()},()=>{this.nb.selectShape(Object(va.a)(4,x),!0)});try{l.jc(b),l.$c=a,c&&b.HT([c]),b.rB(Object(va.a)(4,x))}finally{l&&l.dispose()}this.Mx.pI=Object(va.a)(4,x);return 32}dpj(){return Object(va.a)(946,this.kxa())?32:16}ckj(a,b,c,f,l){b=this.kxa();if(!b||this.Xb.Zc(b))return 16;if(1===c)return 32;c=this.nb.ae();for(var x of c){if(x.Qf){b=x;break}if(x.get_smartArtModelId()){b=this.Ea.er(x);this.nb.R6(x);this.nb.selectShape(b,
!1);break}}this.m9c(l,a);x=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{x.jc(b),x.$c=a,Object(va.a)(946,b).ensureModelData().get_elementCollection().documentElement.Pma=l}finally{x&&x.dispose()}return 32}rnj(a,b,c,f,l){if(!this.kxa())return 16;a=this.nb.Ip();if(!a)return 16;if(1===c)return 32;if(!l)return 8;l.MenuId&&"color"===l.MenuId?l.PopulationXML=this.Mei(a):l.MenuItems=this.Dei(a);return 32}akj(a,b,c,f,l){b=this.kxa();if(!b||this.Xb.Zc(b))return 16;if(1===c)return 32;this.m9c(l,
a);c=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{c.jc(b),c.$c=a,Object(va.a)(946,b).ensureModelData().get_elementCollection().documentElement.zwa=l}finally{c&&c.dispose()}return 32}bkj(){return this.kxa()?32:16}dkj(a,b,c,f,l){b=this.kxa();if(!b||this.Xb.Zc(b))return 16;if(1===c)return 32;this.m9c(l,a);c=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{c.jc(b),c.$c=a,Object(va.a)(946,b).ensureModelData().get_elementCollection().documentElement.Awa=l}finally{c&&c.dispose()}return 32}toj(a,
b,c){b=Object(va.a)(946,this.kxa());if(!b||this.Xb.Zc(Object(va.a)(4,b)))return 16;if(1===c)return 32;c=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{c.jc(b),c.$c=a,b.HHa=!0}finally{c&&c.dispose()}return 32}xoj(a,b,c){b=this.kxa();if(!b||!b.R$d||this.Xb.Zc(b))return 16;if(1===c)return 32;c=new rN;c.fReverseEnabled=b.R$d;c.fReverseChecked=!b.Q$d;const f=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{f.jc(b),f.$c=a,Object(va.a)(946,b).ensureModelData().get_elementCollection().documentElement.smartArtInfo=
c}finally{f&&f.dispose()}return 32}Gnj(a,b,c,f,l){a=this.kxa();a=!!a&&a.Q$d;if(!Object(Fa.a)(Ph.a,l))return 8;l.Kf(a);return 32}Ukj(a,b,c){a=this.kxa();if(!a||this.Xb.Zc(a))return 16;if(1===c)return 32;this.ia.Ka(ba.a.kNa,2,new zn.a(a,!0,null));return 32}Cnj(a,b,c,f,l){a=this.nb.lD();if(!Object(Fa.a)(Ph.a,l))return 8;l.Kf(a);return 32}hdj(a,b,c){if(!a)return null;const f=a.Qu();let l;l=b?b.msb(qf.a.VW,qf.a.e4):this.Sb.tra(qf.a.VW,qf.a.e4);return a.rPd(!0,0,b,c,l.x,l.y,qf.a.VW,qf.a.e4,f+1)}kxa(){const a=
this.nb.ae();for(const b of a){if(b.Qf)return b;if(b.get_smartArtModelId())return this.Ea.er(b)}return null}Kwk(){Array.add(this.Up,new Ai(0,"accent0_1,mainScheme",ResourceStrings.L_SmartArtDark1Outline));Array.add(this.Up,new Ai(1,"accent0_2,mainScheme",ResourceStrings.L_SmartArtDark2Outline));Array.add(this.Up,new Ai(2,"accent0_3,mainScheme",ResourceStrings.L_SmartArtDark2Fill));Array.add(this.Up,new Ai(3,"colorful1,colorful",ResourceStrings.L_SmartArtColorful1));Array.add(this.Up,new Ai(4,"colorful2,colorful",
ResourceStrings.L_SmartArtColorful2));Array.add(this.Up,new Ai(5,"colorful3,colorful",ResourceStrings.L_SmartArtColorful3));Array.add(this.Up,new Ai(6,"colorful4,colorful",ResourceStrings.L_SmartArtColorful4));Array.add(this.Up,new Ai(7,"colorful5,colorful",ResourceStrings.L_SmartArtColorful5));Array.add(this.Up,new Ai(8,"accent1_1,accent1",ResourceStrings.L_SmartArtColoredOutline1));Array.add(this.Up,new Ai(9,"accent1_2,accent1",ResourceStrings.L_SmartArtColoredFill1));Array.add(this.Up,new Ai(10,
"accent1_3,accent1",ResourceStrings.L_SmartArtGradientRange1));Array.add(this.Up,new Ai(11,"accent1_4,accent1",ResourceStrings.L_SmartArtGradientLoop1));Array.add(this.Up,new Ai(12,"accent1_5,accent1",ResourceStrings.L_SmartArtTransparentGradientRange1));Array.add(this.Up,new Ai(13,"accent2_1,accent2",ResourceStrings.L_SmartArtColoredOutline2));Array.add(this.Up,new Ai(14,"accent2_2,accent2",ResourceStrings.L_SmartArtColoredFill2));Array.add(this.Up,new Ai(15,"accent2_3,accent2",ResourceStrings.L_SmartArtGradientRange2));
Array.add(this.Up,new Ai(16,"accent2_4,accent2",ResourceStrings.L_SmartArtGradientLoop2));Array.add(this.Up,new Ai(17,"accent2_5,accent2",ResourceStrings.L_SmartArtTransparentGradientRange2));Array.add(this.Up,new Ai(18,"accent3_1,accent3",ResourceStrings.L_SmartArtColoredOutline3));Array.add(this.Up,new Ai(19,"accent3_2,accent3",ResourceStrings.L_SmartArtColoredFill3));Array.add(this.Up,new Ai(20,"accent3_3,accent3",ResourceStrings.L_SmartArtGradientRange3));Array.add(this.Up,new Ai(21,"accent3_4,accent3",
ResourceStrings.L_SmartArtGradientLoop3));Array.add(this.Up,new Ai(22,"accent3_5,accent3",ResourceStrings.L_SmartArtTransparentGradientRange3));Array.add(this.Up,new Ai(23,"accent4_1,accent4",ResourceStrings.L_SmartArtColoredOutline4));Array.add(this.Up,new Ai(24,"accent4_2,accent4",ResourceStrings.L_SmartArtColoredFill4));Array.add(this.Up,new Ai(25,"accent4_3,accent4",ResourceStrings.L_SmartArtGradientRange4));Array.add(this.Up,new Ai(26,"accent4_4,accent4",ResourceStrings.L_SmartArtGradientLoop4));
Array.add(this.Up,new Ai(27,"accent4_5,accent4",ResourceStrings.L_SmartArtTransparentGradientRange4));Array.add(this.Up,new Ai(28,"accent5_1,accent5",ResourceStrings.L_SmartArtColoredOutline5));Array.add(this.Up,new Ai(29,"accent5_2,accent5",ResourceStrings.L_SmartArtColoredFill5));Array.add(this.Up,new Ai(30,"accent5_3,accent5",ResourceStrings.L_SmartArtGradientRange5));Array.add(this.Up,new Ai(31,"accent5_4,accent5",ResourceStrings.L_SmartArtGradientLoop5));Array.add(this.Up,new Ai(32,"accent5_5,accent5",
ResourceStrings.L_SmartArtTransparentGradientRange5));Array.add(this.Up,new Ai(33,"accent6_1,accent6",ResourceStrings.L_SmartArtColoredOutline6));Array.add(this.Up,new Ai(34,"accent6_2,accent6",ResourceStrings.L_SmartArtColoredFill6));Array.add(this.Up,new Ai(35,"accent6_3,accent6",ResourceStrings.L_SmartArtGradientRange6));Array.add(this.Up,new Ai(36,"accent6_4,accent6",ResourceStrings.L_SmartArtGradientLoop6));Array.add(this.Up,new Ai(37,"accent6_5,accent6",ResourceStrings.L_SmartArtTransparentGradientRange6))}Dei(a){const b=
Object.assign(new sk.a,{Id:"ControlsChangeSmartArtColor",MenuSectionList:[]}),c=Object.assign(new Si.a,{Id:"MenuSectionChangeSmartArtColor",ControlList:[]});Array.add(b.MenuSectionList,c);const f=Mi.Color.Oi(a.Se.Light1),l=Mi.Color.Oi(a.Se.Dark1),x=Mi.Color.Oi(a.Se.Light2),F=Mi.Color.Oi(a.Se.Dark2),R=Array(6);R[0]=Mi.Color.Oi(a.Se.Accent1);R[1]=Mi.Color.Oi(a.Se.Accent2);R[2]=Mi.Color.Oi(a.Se.Accent3);R[3]=Mi.Color.Oi(a.Se.Accent4);R[4]=Mi.Color.Oi(a.Se.Accent5);R[5]=Mi.Color.Oi(a.Se.Accent6);a=0;
Array.add(c.ControlList,({k2b:a}=this.xei(a,f,l,x,F)).returnValue);Array.add(c.ControlList,({k2b:a}=this.tdi(a,f,R)).returnValue);Array.addRange(c.ControlList,({k2b:a}=this.ddi(a,f,R)).returnValue);return b}xei(a,b,c,f,l){const x=Object.assign(new uq.a,{Id:"PrimaryThemeColorsGallery",ExternalId:"ChangeSmartArtColorGalleryPrimary",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_PrimaryThemeColors,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(x.GalleryItems,
this.Abc(b,c,a++));Array.add(x.GalleryItems,this.Abc(b,l,a++));Array.add(x.GalleryItems,this.Abc(l,f,a++));return{returnValue:x,k2b:a}}tdi(a,b,c){const f=Object.assign(new uq.a,{Id:"ColorfulGallery",ExternalId:"ChangeSmartArtColorGalleryColorful",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_Colorful,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(f.GalleryItems,this.D4c(c[1],c[2],c[3],c[4],c[5],c[1],b,a++));for(let l=1;5>l;l++)Array.add(f.GalleryItems,
this.nre(c[l],c[l+1],b,a++));return{returnValue:f,k2b:a}}ddi(a,b,c){const f=[];for(let F=0;6>F;F++){const R=Object.assign(new uq.a,{Id:"ColorfulGallery"+(F+1),ExternalId:"ChangeSmartArtColorGalleryAccent"+(F+1),ExternalGalleryId:"ChangeSmartArtColorGallery",Title:String.format(ResourceStrings.L_AccentFormat,F+1),Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});var l=new Mi.Color;l.r=l.g=l.b=255;var x=new Mi.Color;l=Mi.Color.NY(c[F],l,.5);x=Mi.Color.NY(c[F],x,.25);Array.add(R.GalleryItems,
this.Abc(b,c[F],a++));Array.add(R.GalleryItems,this.Abc(c[F],b,a++));Array.add(R.GalleryItems,this.nre(c[F],l,b,a++));Array.add(R.GalleryItems,this.hak(x,c[F],l,b,a++));Array.add(R.GalleryItems,this.nre(c[F],l,b,a++));Array.add(f,R)}return{returnValue:f,k2b:a}}Abc(a,b,c){return this.D4c(a,a,a,a,a,a,b,c)}nre(a,b,c,f){const l=Ws.a.NY(a,b,2/6),x=Ws.a.NY(a,b,.5),F=Ws.a.NY(a,b,4/6),R=Ws.a.NY(a,b,5/6);return this.D4c(a,l,x,F,R,b,c,f)}hak(a,b,c,f,l){const x=Mi.Color.NY(b,c,.5);return this.D4c(a,b,x,c,x,
b,f,l)}D4c(a,b,c,f,l,x,F,R){R=this.Ddg(R);const fa="ChangeSmartArtColor__"+R.parameter.replace(",","__");return Object.assign(new qN,{Id:fa,ExternalId:fa,MenuItemId:R.parameter,Command:"367274693",QueryCommand:"1384172858",Alt:R.Pfh,TableCellStyles:[this.XAb(a,F),this.XAb(b,F),this.XAb(c,F),this.XAb(f,F),this.XAb(l,F),this.XAb(x,F)]})}XAb(a,b){const c={};c.backgroundColor=this.BOf(a);c.border=String.format("1px solid {0}",this.BOf(b));return c}BOf(a){return String.format("rgb( {0:d},{1:d},{2:d} )",
a.r,a.g,a.b)}Mei(a){const b=new Sys.StringBuilder;b.append('<Menu Id="ControlsChangeSmartArtColor">');const c=new Mi.Color;c.r=c.g=c.b=255;const f=new Mi.Color,l=Mi.Color.Oi(a.Se.Light1);var x=Mi.Color.Oi(a.Se.Dark1),F=Mi.Color.Oi(a.Se.Light2),R=Mi.Color.Oi(a.Se.Dark2);const fa=Array(6);fa[0]=Mi.Color.Oi(a.Se.Accent1);fa[1]=Mi.Color.Oi(a.Se.Accent2);fa[2]=Mi.Color.Oi(a.Se.Accent3);fa[3]=Mi.Color.Oi(a.Se.Accent4);fa[4]=Mi.Color.Oi(a.Se.Accent5);fa[5]=Mi.Color.Oi(a.Se.Accent6);a=0;b.append(String.format('<MenuSection Id="PrimaryThemeColors" Title="{0}">',
ResourceStrings.L_PrimaryThemeColors));b.append('<Gallery Id="PrimaryThemeColorsGallery" ElementDimensions="Size64by48" Width="5">');this.zbc(b,l,x,a++);this.zbc(b,l,R,a++);this.zbc(b,R,F,a++);b.append("</Gallery>");b.append("</MenuSection>");b.append(String.format('<MenuSection Id="Colorful" Title="{0}">',ResourceStrings.L_Colorful));b.append('<Gallery Id="ColorfulGallery" ElementDimensions="Size64by48" Width="5">');this.A4c(b,fa[1],fa[2],fa[3],fa[4],fa[5],fa[1],l,a++);for(x=1;5>x;x++)this.jre(b,
fa[x],fa[x+1],l,a++);b.append("</Gallery>");b.append("</MenuSection>");for(x=0;6>x;x++)F=String.format(ResourceStrings.L_AccentFormat,x+1),b.append(String.format('<MenuSection Id="Accent{0}" Title="{1}">',x+1,F)),b.append(String.format('<Gallery Id="ColorfulGallery{0}" ElementDimensions="Size64by48" Width="5">',x+1)),F=Mi.Color.NY(fa[x],c,.5),R=Mi.Color.NY(fa[x],f,.25),this.zbc(b,l,fa[x],a++),this.zbc(b,fa[x],l,a++),this.jre(b,fa[x],F,l,a++),this.aak(b,R,fa[x],F,l,a++),this.jre(b,fa[x],F,l,a++),b.append("</Gallery>"),
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}zbc(a,b,c,f){this.A4c(a,b,b,b,b,b,b,c,f)}jre(a,b,c,f,l){const x=Ws.a.NY(b,c,2/6),F=Ws.a.NY(b,c,.5),R=Ws.a.NY(b,c,4/6),fa=Ws.a.NY(b,c,5/6);this.A4c(a,b,x,F,R,fa,c,f,l)}aak(a,b,c,f,l,x){const F=Mi.Color.NY(c,f,.5);this.A4c(a,b,c,F,f,F,c,l,x)}A4c(a,b,c,f,l,x,F,R,fa){fa=this.Ddg(fa);a.append('<GalleryButton Id="');a.append(fa.parameter);a.append('" Command="');a.append(ba.a.MUb.toString());a.append('" QueryCommand="');a.append(ba.a.nBe.toString());
a.append('" InnerHTML="');a.append("&lt;div style=&quot;width:64px;height:48px;position:relative;font-size:1px;&quot;&gt;");this.YAb(a,b,R,8,-1);this.YAb(a,c,R,34,-1);this.YAb(a,f,R,8,16);this.YAb(a,l,R,34,16);this.YAb(a,x,R,8,33);this.YAb(a,F,R,34,33);a.append("&lt;/div&gt;");a.append('" Alt="');a.append(fa.Pfh);a.append('"/>')}m9c(a,b){a.Uri=b===ba.a.MUb?"urn:microsoft.com/office/officeart/2005/8/colors/"+a.Uri:b===ba.a.ACc?"3d8"===a.Uri?"urn:microsoft.com/office/officeart/2009/2/quickstyle/3d8":
"urn:microsoft.com/office/officeart/2005/8/quickstyle/"+a.Uri:"timeline"===a.Category?"BasicTimeline"===a.Uri||"HexagonTimeline"===a.Uri||"RoundedRectangleTimeline"===a.Uri||"AccentHomeChevronProcess"===a.Uri?"urn:microsoft.com/office/officeart/2016/7/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2017/3/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2005/8/layout/"+a.Uri}Ddg(a){let b;for(let c=0;c<this.Up.length;c++)if(b=this.Up[c],b.id===a)return b;return new Ai(-1,"","")}YAb(a,b,c,f,l){a.append("&lt;div style=&quot;");
b.mUd()||(b=String.format("rgb( {0:d},{1:d},{2:d} )",b.r,b.g,b.b),a.append("background-color:"),a.append(b),a.append(";"));a.append("left:");a.append(f.toString());a.append("px;top:");a.append(l.toString());a.append("px;width:22px;height:14px;position:absolute;");c.mUd()||(c=String.format("rgb( {0:d},{1:d},{2:d} )",c.r,c.g,c.b),a.append("border:solid 1px "),a.append(c),a.append(";"));a.append("&quot;&gt;&lt;/div&gt;")}}Object(e.a)(sN,"SmartArtActor",null,[244]);class Wx{constructor(a,b,c,f){this.Fpe=
"BottomOverlaid";this.ia=a;this.Dc=f;this.yc=b;this.Qc=c;this.Gpe="productionSpokenLanguages_"+this.Dc.Qma;this.Hpe="productionSubtitleLanguages_"+this.Dc.gxa}ub(){ya.a.J(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.Dc.Gh);this.ia.pa(ba.a.Pgc,fc.a.application,Object(D.a)(this,this.Pgc,"querySubtitleIsEnabled"),96);this.ia.xa(ba.a.yIb,fc.a.application,Object(D.a)(this,this.yIb,"toggleUseSubtitles"));this.ia.pa(ba.a.M8g,fc.a.application,Object(D.a)(this,this.tDk,
"querySubtitleSettingsIsEnabled"),96);this.ia.pa(ba.a.f$c,fc.a.application,Object(D.a)(this,this.f$c,"populateTranscriptionSubtitleLanguage"),96);this.ia.pa(ba.a.e$c,fc.a.application,Object(D.a)(this,this.e$c,"populateTranscriptionSpokenLanguage"),96);this.ia.xa(ba.a.Lml,fc.a.application,Object(D.a)(this,this.Bpj,"handleToggleTranscriptionSpokenLanguage"));this.ia.xa(ba.a.Mml,fc.a.application,Object(D.a)(this,this.Cpj,"handleToggleTranscriptionSubtitleLanguage"));this.ia.pa(ba.a.EBe,fc.a.application,
Object(D.a)(this,this.EBe,"queryToggleTranscriptionSpokenLanguage"),96);this.ia.pa(ba.a.FBe,fc.a.application,Object(D.a)(this,this.FBe,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.pa(ba.a.Sgc,fc.a.application,Object(D.a)(this,this.Sgc,"querySubtitlesBottomOverlay"),96);this.ia.xa(ba.a.bkd,fc.a.application,Object(D.a)(this,this.bkd,"toggleSubtitlesBottomOverlay"));this.ia.pa(ba.a.Tgc,fc.a.application,Object(D.a)(this,this.Tgc,"querySubtitlesTopOverlay"),96);this.ia.xa(ba.a.ckd,fc.a.application,
Object(D.a)(this,this.ckd,"toggleSubtitlesTopOverlay"));this.ia.pa(ba.a.Rgc,fc.a.application,Object(D.a)(this,this.Rgc,"querySubtitlesBelowSlide"),96);this.ia.xa(ba.a.akd,fc.a.application,Object(D.a)(this,this.akd,"toggleSubtitlesBelowSlide"));this.ia.pa(ba.a.Qgc,fc.a.application,Object(D.a)(this,this.Qgc,"querySubtitlesAboveSlide"),96);this.ia.xa(ba.a.$jd,fc.a.application,Object(D.a)(this,this.$jd,"toggleSubtitlesAboveSlide"))}we(){}Pgc(a,b,c,f,l){if(!l||!Object(Fa.a)(Ph.a,l))return 8;l.Kf(this.Dc.Gh);
return 32}tDk(a,b,c,f,l){return 1===c?this.yc.Nj()?32:8:l&&"object"===typeof l?this.Dc&&this.Dc.OYb?32:(ya.a.J(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(ya.a.J(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}Sgc(a,b,c,f,l){if(!l||!Object(Fa.a)(Ph.a,l))return ya.a.J(512500163,822,10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;l.Kf("BottomOverlay"===this.Dc.tv);ya.a.J(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",
this.Dc.tv);return 32}Tgc(a,b,c,f,l){if(!l||!Object(Fa.a)(Ph.a,l))return 8;l.Kf("TopOverlay"===this.Dc.tv);ya.a.J(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.Dc.tv);return 32}Rgc(a,b,c,f,l){try{l&&l.Kf("BelowSlide"===this.Dc.tv)}catch(x){ya.a.J(512500131,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",x)}return 32}Qgc(a,b,c,f,l){try{l&&l.Kf("AboveSlide"===this.Dc.tv)}catch(x){ya.a.J(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",
x)}return 32}yIb(a,b,c,f,l){if(1===c)return this.yc.Nj()?32:8;if(!l||"object"!==typeof l)return 8;this.Dc.Gh&&(Hi.a.JL("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Hi.a.rL)||ya.a.J(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));this.Dc.Gh=!this.Dc.Gh;ya.a.J(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.Dc.Gh);Gb.App.Fb.HF({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});
return 32}f$c(a,b,c,f,l){try{if(1===c)return 32;if(!l)return ya.a.J(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.R4g(l,!1)}catch(x){ya.a.J(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",x)}return 32}e$c(a,b,c,f,l){try{if(1===c)return 32;if(!l)return ya.a.J(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.R4g(l,!0)}catch(x){ya.a.J(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",
x)}return 32}Cpj(a,b,c,f,l){try{if(l){this.Dc.gxa=l.MenuItemId;this.Dc.ohb=this.Dc.PNc();const x=l.SourceControlId;this.Hpe!==x&&(a={},a[x]="ToggleButtonModel",a[this.Hpe]="ToggleButtonModel",Gb.App.Fb.HF(a),this.Hpe=x)}}catch(x){ya.a.J(512500122,822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",x)}return 32}FBe(a,b,c,f,l){try{l&&(l[ai.a.On]=l.MenuItemId.toLowerCase()===this.Dc.gxa.toLowerCase())}catch(x){ya.a.J(512500121,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",
x)}return 32}Bpj(a,b,c,f,l){try{if(l){this.Dc.Qma=l.MenuItemId;const x=l.SourceControlId;this.Gpe!==x&&(a={},a[x]="ToggleButtonModel",a[this.Gpe]="ToggleButtonModel",Gb.App.Fb.HF(a),this.Gpe=x)}}catch(x){ya.a.J(512500120,822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",x)}return 32}EBe(a,b,c,f,l){try{l&&(l[ai.a.On]=l.MenuItemId.toLowerCase()===this.Dc.Qma.toLowerCase())}catch(x){ya.a.J(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",x)}return 32}bkd(a,
b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;l[ai.a.On]&&(this.Dc.tv="BottomOverlay",ya.a.J(512500117,822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.Lld(l.SourceControlId);return 32}ckd(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;l[ai.a.On]&&
(this.Dc.tv="TopOverlay",ya.a.J(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.Lld(l.SourceControlId);return 32}akd(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;l[ai.a.On]&&(this.Dc.tv="BelowSlide",ya.a.J(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.Lld(l.SourceControlId);return 32}$jd(a,b,c,f,l){if(1===
c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;l[ai.a.On]&&(this.Dc.tv="AboveSlide",ya.a.J(512500111,822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.Lld(l.SourceControlId);return 32}R4g(a,b){a.MenuItems=Object.assign(new sk.a,{Id:b?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});b?((b=this.Dc.WNe)&&0<b.count&&(b=Wx.bTf(b,"productionSpokenLanguages",
""),Array.add(a.MenuItems.MenuSectionList,b)),(b=this.Dc.VNe)&&0<b.count&&(b=Wx.bTf(b,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),Array.add(a.MenuItems.MenuSectionList,b))):(b=this.Dc.MHb)&&0<xa.a.count(b)&&(b=Wx.SAi(this.Dc.KMe),Array.add(a.MenuItems.MenuSectionList,b));a.PopulationXML=ej.l(a.MenuItems)}Lld(a){if(this.Fpe!==a){const b={};b[a]="ToggleButtonModel";b[this.Fpe]="ToggleButtonModel";Gb.App.Fb.HF(b);this.Fpe=a;this.Qc.RD(new Yp.a(1))}}static bTf(a,
b,c){c=Object.assign(new Si.a,{DisplayMode:"Menu",Title:c,Id:b,ControlsId:"ctr"+b,ControlList:[]});for(let f of a)try{const l=f.toLowerCase(),x=Object.assign(new Py.a,{Id:b+"_"+l,ExternalId:b+"_"+l,LabelText:sa.a.le(f).displayName,Command:"892576938",MenuItemId:l,QueryCommand:"1887433262",Visible:!0,AriaLabel:Uc.a.xnb});Array.add(c.ControlList,x)}catch(l){ya.a.J(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",f,l)}return c}static SAi(a){const b=
Object.assign(new Si.a,{DisplayMode:"Menu",Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",ControlList:[]});for(let c of a)try{const f=Object.assign(new Py.a,{Id:"productionSubtitleLanguages_"+c,ExternalId:"productionSubtitleLanguages_"+c,LabelText:sa.a.le(c).displayName,Command:"2717950896",MenuItemId:c,QueryCommand:"4282741576",Visible:!0,AriaLabel:Uc.a.xnb});Array.add(b.ControlList,f)}catch(f){ya.a.J(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",
c,f)}return b}}Object(e.a)(Wx,"SubtitleActor",null,[244]);var UQ=d(393);class ro{constructor(a){this.ox=this.rs=this.zu=this.uJ=this.AH=null;this.yY=a}get JTb(){return this.uJ||(this.uJ=hb.a.instance.pb("Box4.IAutoCorrectRules"))}get Daa(){return this.zu||(this.zu=hb.a.instance.pb("Box4.IAutoCorrectScheduler"))}get SI(){return this.AH||(this.AH=hb.a.instance.pb("Box4.Pages.IPageContentEditor"))}get WA(){return this.ox||(this.ox=hb.a.instance.pb("Box4.IOutlineEditor"))}get rn(){return this.rs||(this.rs=
this.yY())}$vb(a,b,c){if(this.WA&&ro.$g){var f=Rg.ContextSetEditor.qZd(b);a=f.node;fb.SelectionEditor.Cl(f)&&(f=Pc.a.Uj(a,Ya.ParagraphReader.textLength(a)));var l=tb.a.language(tb.a.Bs(f));f=mb.GraphIterator.mb(c.rg);ro.Hl.KHa(f);var x=a=null;if(f)for(let F=f.zb(1);F&&!x;F=f.wj(1))Ui.OutlineReader.RV(F)&&(x=F);if(f&&!x){if(!this.SI||!this.WA)return;a=new We.GraphTransaction(7);a.Tx(f);x=this.SI.tWb(f);this.WA.Dfd(x,c.T0b());this.WA.IY(f,!0);l&&(Yb.OutlineElementNavigator.oi(f),f=Pc.a.Uj(f.currentNode,
0),ro.$g.RXa(tb.a.Bs(f),l))}l=nd.SelectionFactory.nj(x,!0);c.Eb.setSelection(l);fb.SelectionEditor.Kg(b)&&(c=mb.GraphIterator.mb(b.node),c.uv(),yh.OutlineNavigator.zdd(c),this.JTb&&this.Daa&&Ui.OutlineReader.OB(c,b,!0)&&(b=this.JTb.fVd(b,-1,!1,w.a.Bq))&&this.Daa.iih(b));this.rn&&this.rn.Pv();a&&a.dispose()}}vTd(a,b,c){a=mb.GraphIterator.mb(c.rg);a=UQ.a(a);a=nd.SelectionFactory.nj(a,!1);c.Eb.setSelection(a)}static get $g(){return ro.Gf||(ro.Gf=hb.a.instance.pb("Box4.IFormattingEditor"))}static get instance(){return ro.Ja||
(ro.Ja=ro.GB())}static GB(){return new ro(()=>hb.a.instance.pb("Box4.IUndoManager"))}static get Hl(){return sy.PageNavigator.instance}}ro.Ja=null;ro.Gf=null;Object(e.a)(ro,"TitleViewEditor",null,[]);class iu{constructor(a,b,c,f=null,l=null,x,F,R=null,fa=null){this.rs=null;this.uyf=!1;this.yY=a;this.OCd=b;this.nm=c;this.uJ=f;this.zu=l;this.Xc=R;this.jk=fa}get rn(){return this.rs||(this.rs=this.yY())}ub(){const a=u.AFrameworkApplication.Ta,b=Object(D.a)(this,this.Xil,"tabView");a.pa(C.a.tab,Fb.a.view,
b,1124);a.pa(C.a.ckc,Fb.a.view,b,1124);a.xa(C.a.wmg,Fb.a.view,ce.ActionManager.Fg)}Xil(a,b,c,f,l){if(1===c)return 32;const x=a===C.a.ckc;if(!b.view.Hh)return 2;const F=b.view,R=F.Eb;var fa=R.Dj;if(!fa||H.a.instance.ga(14)&&iu.Wi.Z3a(fa))return 2;if(this.nm&&this.nm.instance&&this.nm.instance.LV(fa))return 4;var wa=null,Xa=ce.ActionManager.j4,lb=!1,Lb=fb.SelectionEditor.Kg(fa);if(fa.Hw){if(R.Oa.xG&&(Xa=fa.getContext(0),wa=new mb.GraphIterator,wa.set(Xa.node),wa.uv(),Xa=x?C.a.aHe:C.a.zed),Xa=this.OCd.jAk(Xa,
x?C.a.Ry:C.a.HE),Xa===ce.ActionManager.j4){var kc=iu.Pl.w1(fa,16);if(kc)x&&(Xa=C.a.F5c),wa=new mb.GraphIterator,wa.set(kc.node),wa.Ze();else{if(H.a.instance.ga(77))return 2;if(iu.dEj(fa)){if(x)return 2;Xa=C.a.$vb}else Xa=x?C.a.Ry:C.a.HE}}}else if(fa.Kk)wa=new mb.GraphIterator,wa.set(fa.node),fb.SelectionEditor.Vs(wa),Ui.OutlineReader.Xia(fa)?Xa=x?C.a.aHe:C.a.zed:(Xa=x?this.OCd.Qij(wa,fa,Xa):this.OCd.Pij(wa,fa,Xa),Rd.OutlineElementReader.Tg(wa)&&fa.contextId===Fb.a.Lf&&(lb=Rd.OutlineElementReader.OB(wa,
fa,!1)),kc=Ib.ListReader.ak(wa)&&lb,Xa!==ce.ActionManager.j4||De.isTableCellOrInside(wa)||kc||(this.uyf||(Z.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.uyf=!0),u.AFrameworkApplication.Ta.processAction(C.a.wmg,2),u.AFrameworkApplication.mN("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),this.Xc&&this.Xc.isFeatureEnabled(84)&&this.Xc.isFeatureEnabled(83)));else return 2;if(!x&&Xa===ce.ActionManager.j4&&De.isTableCellOrInside(wa))if(Dd.returnToCell(wa),
De.isLastCellInTable(wa)||xd.TableReader.Cub(wa)&&De.isLastCellInTableIgnoringGhostCells(wa)){if(Xa=this.YEd(wa,fa),!Xa)return 2}else Xa=C.a.gUg;if(Xa===ce.ActionManager.j4)return 2;switch(Xa){case C.a.$vb:ro.instance.$vb(a,fa,b.view);fa=32;break;case C.a.vTd:ro.instance.vTd(a,fa,b.view);fa=32;break;case C.a.gUg:case C.a.F5c:lb=Xa===C.a.F5c;Lb&&this.uJ&&this.zu&&(Lb=this.uJ.fVd(fa,-1,!0,w.a.Bq))&&this.zu.iih(Lb);fa=32;Dd.returnToCell(wa);Dd.moveToNextOrPreviousCell(wa,lb)&&(Lb=!0,lb=!1,Ui.OutlineReader.OOc(wa)||
(yh.OutlineNavigator.Cse(wa,!1),Yb.OutlineElementNavigator.oi(wa),Ya.ParagraphReader.Mr(wa.currentNode)&&(Lb=!1,Ya.ParagraphReader.textLength(wa.currentNode)||(lb=!0)),lb||Dd.returnToCell(wa)),lb?wa=nd.SelectionFactory.Jg(wa.currentNode,0):(wa=nd.SelectionFactory.Xk(wa.currentNode),!Lb&&fb.SelectionEditor.Cl(wa.Te)&&(Lb=wa.toArray(),Array.removeAt(Lb,Lb.length-1),wa=new $a.Selection(Lb,wa.qf))),R.setSelection(wa));break;case C.a.aHe:case C.a.zed:Xa===C.a.zed?yh.OutlineNavigator.KTg(wa,!1):yh.OutlineNavigator.KTg(wa,
!0);R.setSelection(nd.SelectionFactory.Xk(wa.currentNode));fa=32;break;case C.a.uYa:fa=u.AFrameworkApplication.Ta.ii(b,Xa,c,!0,f,l);1===Gb.App.mode&&Dd.moveToNextOrPreviousCell(wa,!1)&&(Dd.returnToCell(wa),wa=nd.SelectionFactory.nj(wa.currentNode,!0),fb.SelectionEditor.Cl(wa.Te)&&(Lb=wa.toArray(),Array.removeAt(Lb,Lb.length-1),wa=new $a.Selection(Lb,wa.qf)),R.setSelection(wa));break;default:if(fa=u.AFrameworkApplication.Ta.ii(b,Xa,c,!0,f,l),!lb&&Lb&&(Xa===C.a.Ry||Xa===C.a.HE)){const lc=fb.SelectionEditor.Zga(R.Oa.kb).y;
Gb.App.cKk(()=>{this.Hdk(R,F,lc)})}}32===fa&&b.view.Hh&&this.rn.Pv();return fa}Hdk(a,b,c){if(a&&b){var f=a.Oa.kb;fb.SelectionEditor.Zga(f).y<c?(b=fb.SelectionEditor.bZb(b,f,!1),b=fb.SelectionEditor.Pqa(b,!1,!1,!1,!0)):b=fb.SelectionEditor.bJc(b,f,!1);a.setSelection(b)}}YEd(){return C.a.HCa}xTg(a,b,c){if(a&&b){var f=a.Oa.kb;fb.SelectionEditor.Zga(f).y<c?(b=fb.SelectionEditor.bZb(b,f,!1),b=fb.SelectionEditor.Pqa(b,!1,!1,!1,!0)):b=fb.SelectionEditor.Pqa(f,!1,!1,!1,!0);a.setSelection(b)}}static get Wi(){return Qg.a.instance}static get Pl(){return Rg.ContextSetEditor.instance}static dEj(a){a=
iu.Pl.w1(a,10);return!!a&&ph.a(a)}}Object(e.a)(iu,"TabActor",null,[]);class tN extends iu{constructor(a,b,c,f){super(a,b,c);this.la=f}YEd(a,b){return this.la.Dvb?super.YEd(a,b):0}}Object(e.a)(tN,"Box4TabActor",iu,[]);class uN{constructor(a,b,c,f){this.U8j=new tN(a,b,c,f)}ub(){this.U8j.ub()}we(){}}Object(e.a)(uN,"TabActor",null,[244]);class vN{constructor(a,b,c){this.LHg=b;this.ra=a;this.dEa=c}jAk(a,b){const c=this.ra.Dj;return c&&this.dEa.w1(c,16)?a:this.wKe(b)?b:G.a.ze}Qij(a,b,c){(c=Object(va.a)(5,
b.node))&&c.Sr()?c=C.a.F5c:(Yb.OutlineElementNavigator.Je(a),c=(fb.SelectionEditor.Pj(b)||fb.SelectionEditor.Kg(b)&&Rd.OutlineElementReader.OB(a,b,!1))&&this.LHg.tob(a)&&this.wKe(C.a.Ry)?C.a.Ry:G.a.ze,ya.a.J(8955994,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanPromote actionToTake={0}",c===C.a.Ry?"Promote":"DoNothing"));return c}Pij(a,b,c){const f=Object(va.a)(5,a.hq);if(f&&f.Sr())return c;Yb.OutlineElementNavigator.Je(a);c=(fb.SelectionEditor.Pj(b)||fb.SelectionEditor.Kg(b)&&Rd.OutlineElementReader.OB(a,
b,!1))&&this.LHg.dCc(a)&&this.wKe(C.a.HE)?C.a.HE:G.a.ze;ya.a.J(8955996,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanDemote actionToTake={0}",c===C.a.Ry?"Demote":"DoNothing");return c}wKe(a){var b=this.ra.Oa.kb;let c=!1;if(b)for(let f of b)if(f&&f.node)if(Ya.ParagraphReader.MV(f.node)){if(b=f.node.sa(Bb.a.listLevel,0),a===C.a.HE&&b>=$o.a.C6-1||a===C.a.Ry&&!b||this.ra.GK()&&$o.a.etg(f.node)){c=!0;break}}else{c=!0;break}return!c}}Object(e.a)(vN,"TabActorPromoteDemoteStrategy",null,[807]);var wN=
d(385),VQ=d(838),xN=d(937);class Ev extends Vh.a{constructor(a,b,c,f,l,x,F,R,fa){super(void 0,void 0,!0);this.$sa=null;this.E_j=b;this.YKg=f;this.WKg=l;this.TKg=x;this.OKg=F;this.oEg=R;this.nEg=fa;this.xua=a;this.H9a=c}ahd(){this.kg=this.E_j;const a={};a.bodyControls=this.nXd();this.pj(this.xua,Object(D.a)(this,this.lRd,"dialogResultHandler"),a)}lRd(a,b){1===a&&this.H9a(parseInt(this.nQa(b)),parseInt(this.c_i(b)));this.dispose()}nXd(){this.$sa=Ev.iYd();const a={};this.Lri(a);this.Nqi(a);return a}Lri(a){const b=
String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.YKg,this.TKg),c=[xN.a("None",0,this.YKg,this.TKg,1)];a.rowsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogRowSpinner",["label"]:ResourceStrings.l_InsertTableDialogRowLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.oEg,["validUnits"]:c,["numberFormatInfo"]:this.$sa,["validReservedValues"]:[""]}}Nqi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.WKg,this.OKg),c=[xN.a("None",
0,this.WKg,this.OKg,1)];a.columnsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogColumnSpinner",["label"]:ResourceStrings.l_InsertTableDialogColumnLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.nEg,["validUnits"]:c,["numberFormatInfo"]:this.$sa,["validReservedValues"]:[""]}}nQa(a){return a.rows&&""!==a.rows.toString()?a.rows.toString():this.oEg.toString()}c_i(a){return a.columns&&""!==a.columns.toString()?a.columns.toString():this.nEg.toString()}static iYd(){return{["negativeSign"]:"-",
["numberDecimalDigits"]:0,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}}Object(e.a)(Ev,"AReactTableSizeDialog",Vh.a,[]);class yN extends Ev{constructor(a){super(ResourceStrings.L_InsertTableDialogTitleText,"InsertTableDialog",a,1,1,35,35,2,5)}}Object(e.a)(yN,"ReactInsertTableDialog",Ev,[]);class zN extends Ev{constructor(a,b,c){super(ResourceStrings.L_SplitTableCells,"SplitTableCellsDialog",a,1,1,b,c,1,Math.min(2,c))}}Object(e.a)(zN,
"ReactSplitTableCellsDialog",Ev,[]);var Fv=d(608),AN=d(931);class ju{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg){this.VSa={};this.D9b=!1;this.o1c=null;this.mz=[0,.25,.5,.75,1,1.5,2.25,3,4.5,6];this.$E=new ua.ScriptSharpLegacyMap;this.Yb=kc;this.ta=lc;this.Mb=b;this.ia=a;this.Af=c;this.ra=Ec;this.Fa=f;this.Jz=l;this.Ea=x;this.$r=Xa;this.xm=wa;this.Ga=lb;this.Db=Lb;this.KI=fa;this.hVa=R;this.sc=F;this.gl=Jc;this.wAb=Dc;this.MPg=Wd;this.yca=xe;this.Qb=Sd;this.LDa=
Pe;this.Mx=Ue;this.QW=Ef;this.IIg=dg;this.SG=1;this.Ww=Cf.Box4ColorHelper.s0({Color:"##T,1,0,0"});this.FD=Mg;this.Qz=Bg}ub(){this.VSa["465284484"]=0;this.VSa["212166888"]=1;this.VSa["530759702"]=2;this.VSa["1915511548"]=0;this.VSa["2003354004"]=1;this.VSa["2257534378"]=2;xc.j0d=Object(D.a)(this,this.i0d,"getRowOrColumnsForDelete");xc.Y_d=Object(D.a)(this,this.Y$i,"getRefRowWhenInsertRow");xc.V_d=Object(D.a)(this,this.S$i,"getRefCellWhenInsertColumn");xc.W_d=Object(D.a)(this,this.U$i,"getRefColumnFromRefCell");
xc.X_d=Object(D.a)(this,this.W$i,"getRefColumnsWhenSelectColumn");xc.Z_d=Object(D.a)(this,this.$$i,"getRefRowsWhenSelectRow");xc.k2d=Object(D.a)(this,this.Hij,"gotoFocusCellAfterInsertColumn");xc.lsb=Object(D.a)(this,this.Nag,"getNewOutlineElementInfoFromCell");xc.jvb=a=>this.Ga.Xu||!xd.TableReader.Cub(a);this.ia.pa(ba.a.lDb,fc.a.application,Object(D.a)(this,this.Ikj,"handleDeleteTable"),4);this.ia.pa(ba.a.m$c,Fb.a.view,Object(D.a)(this,this.Kkj,"handleDeleteTableRow"),4);this.ia.pa(ba.a.Mye,Fb.a.view,
Object(D.a)(this,this.Jkj,"handleDeleteTableColumn"),4);this.ia.pa(ba.a.Sye,fc.a.application,Object(D.a)(this,this.Koj,"handleSelectTable"),4);this.ia.pa(ba.a.n$c,fc.a.application,Object(D.a)(this,this.Wlj,"handleInsertTable"),4);this.ia.pa(ba.a.Pye,fc.a.application,Object(D.a)(this,this.Xlj,"handleInsertTableDialog"),4);this.ia.pa(ba.a.n5g,fc.a.application,Object(D.a)(this,this.Ylj,"handleInsertTableFromRibbon"),4);this.ia.pa(ba.a.Rxk,fc.a.application,yr.a.rG,4);this.ia.pa(ba.a.Sxk,fc.a.application,
yr.a.rG,4);this.ia.pa(ba.a.XCk,fc.a.application,yr.a.O_,96);this.ia.pa(ba.a.YCk,fc.a.application,yr.a.O_,96);this.ia.pa(ba.a.z8g,Fb.a.view,Object(D.a)(this,this.wBe,"queryTableCellAnchoring"),96);this.ia.pa(ba.a.y8g,Fb.a.view,Object(D.a)(this,this.wBe,"queryTableCellAnchoring"),96);this.ia.pa(ba.a.x8g,Fb.a.view,Object(D.a)(this,this.wBe,"queryTableCellAnchoring"),96);this.ia.xa(ba.a.vfc,Fb.a.view,xc.Wha);this.ia.xa(ba.a.ufc,Fb.a.view,xc.Wha);this.ia.xa(ba.a.tfc,Fb.a.view,xc.Wha);this.ia.xa(ba.a.vfc,
Fb.a.tableCell,Object(D.a)(this,this.f3d,"handleTableCellAnchoring"));this.ia.xa(ba.a.ufc,Fb.a.tableCell,Object(D.a)(this,this.f3d,"handleTableCellAnchoring"));this.ia.xa(ba.a.tfc,Fb.a.tableCell,Object(D.a)(this,this.f3d,"handleTableCellAnchoring"));this.ia.$d(ba.a.vfc,4);this.ia.$d(ba.a.ufc,4);this.ia.$d(ba.a.tfc,4);this.ia.xa(ba.a.j5g,Fb.a.view,Object(D.a)(this,this.Vjj,"handleCellShadingMenuOpen"));this.ia.pa(ba.a.Nxk,Fb.a.view,Object(D.a)(this,this.gnj,"handlePopulateCellShadingColor"),96);this.ia.xa(ba.a.xva,
Fb.a.view,xc.Wha);this.ia.xa(ba.a.xva,Fb.a.tableCell,Object(D.a)(this,this.Tjj,"handleCellShadingColor"));this.ia.xa(ba.a.Mxk,Fb.a.view,Object(D.a)(this,this.mmj,"handleMoreCellShadingColor"));this.ia.xa(ba.a.Kye,Fb.a.view,xc.Wha);this.ia.xa(ba.a.Kye,Fb.a.tableCell,Object(D.a)(this,this.Ujj,"handleCellShadingCustomColor"));this.ia.xa(ba.a.yWa,Fb.a.view,xc.Wha);this.ia.xa(ba.a.yWa,Fb.a.tableCell,Object(D.a)(this,this.joj,"handleRemoveCellShading"));this.ia.$d(ba.a.xva,4);this.ia.$d(ba.a.yWa,4);this.ia.pa(ba.a.pad,
Fb.a.application,Object(D.a)(this,this.pad,"queryLockAspectRatio"),96);this.ia.pa(ba.a.Afd,Fb.a.application,Object(D.a)(this,this.Afd,"setLockAspectRatio"),4);this.ia.pa(ba.a.$gc,Fb.a.view,Object(D.a)(this,this.$gc,"queryTableRowHeight"),96);this.ia.pa(ba.a.Zgc,Fb.a.view,Object(D.a)(this,this.Zgc,"queryTableColumnWidth"),96);this.ia.pa(ba.a.Lfb,Fb.a.view,Object(D.a)(this,this.Lfb,"setTableRowHeight"),4);this.ia.pa(ba.a.$Xa,Fb.a.view,Object(D.a)(this,this.$Xa,"setTableColumnWidth"),4);this.ia.pa(ba.a.Ihd,
Fb.a.view,Object(D.a)(this,this.Lfb,"setTableRowHeight"),4);this.ia.pa(ba.a.Hhd,Fb.a.view,Object(D.a)(this,this.$Xa,"setTableColumnWidth"),4);this.ia.pa(ba.a.Gfh,fc.a.application,Object(D.a)(this,this.uoj,"handleResizeFallbackTable"),4);this.ia.pa(ba.a.gbd,Fb.a.view,Object(D.a)(this,this.k9g,"queryTableSize"),96);this.ia.pa(ba.a.BBe,Fb.a.view,Object(D.a)(this,this.k9g,"queryTableSize"),96);this.ia.pa(ba.a.jwa,Fb.a.view,Object(D.a)(this,this.tmh,"setTableSize"),4);this.ia.pa(ba.a.aYa,Fb.a.view,Object(D.a)(this,
this.tmh,"setTableSize"),4);this.ia.pa(ba.a.mergeTableCells,Fb.a.view,Object(D.a)(this,this.kmj,"handleMergeTableCells"),4);this.ia.pa(ba.a.splitTableCells,Fb.a.view,Object(D.a)(this,this.jpj,"handleSplitTableCells"),4);this.ia.pa(ba.a.oHi,Fb.a.view,Object(D.a)(this,this.Tgg,"handleDistributeRows"),4);this.ia.pa(ba.a.nHi,Fb.a.view,Object(D.a)(this,this.Mkj,"handleDistributeColumns"),4);this.ia.pa(ba.a.Jjl,Fb.a.view,Object(D.a)(this,this.Tgg,"handleDistributeRows"),4);this.ia.pa(ba.a.Uvk,Fb.a.view,
Object(D.a)(this,this.fnj,"handlePopulateCellBorderColorMenu"),96);this.ia.pa(ba.a.lxk,Fb.a.view,Object(D.a)(this,this.Sjj,"handleCellBorderRecentColor"),96);this.ia.pa(ba.a.rdk,Fb.a.view,Object(D.a)(this,this.lmj,"handleMoreCellBorderColors"),96);this.ia.pa(ba.a.rjl,Fb.a.view,Object(D.a)(this,this.upj,"handleTableBorderWidthAnchor"),4);this.ia.pa(ba.a.sjl,Fb.a.view,Object(D.a)(this,this.Moj,"handleSelectTableBorderWidth"),4);this.ia.pa(ba.a.$il,Fb.a.view,Object(D.a)(this,this.spj,"handleTableBorderColorAnchor"),
4);this.ia.pa(ba.a.Oid,Fb.a.view,Object(D.a)(this,this.Loj,"handleSelectTableBorderColor"),4);this.ia.pa(ba.a.pjl,Fb.a.view,Object(D.a)(this,this.tpj,"handleTableBorderTypeAnchor"),4);this.ia.pa(ba.a.qjl,Fb.a.view,Object(D.a)(this,this.DOc,"handleSelectTableBorderType"),4);this.ia.pa(ba.a.kjl,Fb.a.view,Object(D.a)(this,this.Hoj,"handleSelectInsideTableBorderType"),4);this.ia.pa(ba.a.jjl,Fb.a.view,Object(D.a)(this,this.Xhg,"handleSelectInsideHorizontalTableBorderType"),4);this.ia.pa(ba.a.ojl,Fb.a.view,
Object(D.a)(this,this.Yhg,"handleSelectInsideVerticalTableBorderType"),4);this.ia.pa(ba.a.b9g,Fb.a.view,Object(D.a)(this,this.Xnj,"handleQueryTableBorderWidth_1"),96);this.ia.pa(ba.a.c9g,Fb.a.view,Object(D.a)(this,this.Ynj,"handleQueryTableBorderWidth_2"),96);this.ia.pa(ba.a.d9g,Fb.a.view,Object(D.a)(this,this.Znj,"handleQueryTableBorderWidth_3"),96);this.ia.pa(ba.a.e9g,Fb.a.view,Object(D.a)(this,this.$nj,"handleQueryTableBorderWidth_4"),96);this.ia.pa(ba.a.f9g,Fb.a.view,Object(D.a)(this,this.aoj,
"handleQueryTableBorderWidth_5"),96);this.ia.pa(ba.a.g9g,Fb.a.view,Object(D.a)(this,this.boj,"handleQueryTableBorderWidth_6"),96);this.ia.pa(ba.a.h9g,Fb.a.view,Object(D.a)(this,this.coj,"handleQueryTableBorderWidth_7"),96);this.ia.pa(ba.a.i9g,Fb.a.view,Object(D.a)(this,this.doj,"handleQueryTableBorderWidth_8"),96);this.ia.pa(ba.a.j9g,Fb.a.view,Object(D.a)(this,this.eoj,"handleQueryTableBorderWidth_9"),96);this.ia.pa(ba.a.X8g,Fb.a.view,Object(D.a)(this,this.Snj,"handleQueryTableBorderType_LeftBorder"),
96);this.ia.pa(ba.a.$8g,Fb.a.view,Object(D.a)(this,this.Vnj,"handleQueryTableBorderType_RightBorder"),96);this.ia.pa(ba.a.a9g,Fb.a.view,Object(D.a)(this,this.Wnj,"handleQueryTableBorderType_TopBorder"),96);this.ia.pa(ba.a.R8g,Fb.a.view,Object(D.a)(this,this.Mnj,"handleQueryTableBorderType_BottomBorder"),96);this.ia.pa(ba.a.T8g,Fb.a.view,Object(D.a)(this,this.Onj,"handleQueryTableBorderType_DiagonalUpBorder"),96);this.ia.pa(ba.a.S8g,Fb.a.view,Object(D.a)(this,this.Nnj,"handleQueryTableBorderType_DiagonalDownBorder"),
96);this.ia.pa(ba.a.V8g,Fb.a.view,Object(D.a)(this,this.Qnj,"handleQueryTableBorderType_InsideHorizontalBorder"),96);this.ia.pa(ba.a.W8g,Fb.a.view,Object(D.a)(this,this.Rnj,"handleQueryTableBorderType_InsideVerticalBorder"),96);this.ia.pa(ba.a.U8g,Fb.a.view,Object(D.a)(this,this.Pnj,"handleQueryTableBorderType_InsideBorder"),96);this.ia.pa(ba.a.Z8g,Fb.a.view,Object(D.a)(this,this.Unj,"handleQueryTableBorderType_OutsideBorder"),96);this.ia.pa(ba.a.Q8g,Fb.a.view,Object(D.a)(this,this.Lnj,"handleQueryTableBorderType_AllBorder"),
96);this.ia.pa(ba.a.Y8g,Fb.a.view,Object(D.a)(this,this.Tnj,"handleQueryTableBorderType_NoBorder"),96)}we(){}xpa(a){return a.lp()?ee.a("TableBordersComplexTableFixEnabled"):!0}N4(){var a=!1;this.ta.Ba&&(a=this.ra.jq(),a=!!a&&a.nd);return a}Vjj(){return this.N4()?32:8}gnj(a,b,c,f,l){if(!this.N4())return 16;if(1===c)return 32;if(!l)return 8;a=this.ta.Ba;if(!a)throw Error.argumentNull("ActiveSlide is null");c=this.Yb.yf.J1;b=Object.assign(new sk.a,{Id:"PptRibbon.TableDesign.Shading",MenuSectionList:[]});
Array.add(b.MenuSectionList,bl.f(a.Se,CE.a.themeColors,"Color.Menu.Controls","themeColor","ThemeCellShadingColorPicker","3704601382",1));Array.add(b.MenuSectionList,bl.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellShadingColorPicker","3704601382",!1));Array.add(b.MenuSectionList,bl.b("Remove Color","Color.Menu.Controls","2292419401",ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor","ShapeNoFill","per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));
c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!1)),Array.add(b.MenuSectionList,bl.c(c,"Recent Colors","Color.Menu.Controls","recentColor","CellShadingRecentColors","4078162917",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!0));ee.a("ColorPickerHighlighterFix")&&(c=this.Qz.k7f(this.ra.ny()),bl.h(b,c,a.Se));l.MenuItems=b;return 32}mmj(a,b,c,f,l){if(!this.N4())return ya.a.J(512500107,822,
10,"HandleMoreCellShadingColor: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ka(ba.a.renderColorPicker,1,l);a=this.pbj();b={};b.currentColor=a;b.handleCommand=ba.a.Kye;return this.ia.Ka(ba.a.renderColorPicker,2,b)}Ujj(a,b,c,f,l){if(1===c)return this.ia.Ka(ba.a.xva,c,l);if(!l)return ya.a.J(512500106,822,10,"HandleCellShadingCustomColor: actionData is null"),16;a=this.ia.Ka(ba.a.xva,c,l);32===a&&this.ia.Ka(ba.a.xza,c,l);return a}Tjj(a,b,c,f,l){if(!this.N4())return 16;if(1===
c)return 32;if(!l)return 8;b=b.node;l=Cf.Box4ColorHelper.s0(l);if(!l)return 8;c=this.Db.je(15);c.jc(b);c.$c=a;a=b.cellShading;Jx(a);a.solidFillField=l;b.cellShading=a;c.dispose();ya.a.J(573437397,822,15,String.format("HandleCellShadingColor: EntryPoint:{0} ",wN.a[this.ia.gq]));return 32}joj(a,b,c){if(!this.N4())return 16;if(1===c)return 32;b=b.node;c=this.Db.je(15);c.jc(b);c.$c=a;a=om.a.Bi(b,ub.a.cellShading,new VQ.a);Jx(a);a.noFillField=new Ux;b.cellShading=a;c.dispose();return 32}upj(){const a=
this.ra.Po();return a&&this.N4()&&this.Ga.yDb&&this.xpa(a)?32:8}Moj(a,b,c,f,l){a=this.ra.Po();if(!(a&&this.N4()&&this.xpa(a)&&this.Ga.yDb))return 16;if(1===c)return 32;if(!l)return 8;switch(l.SourceControlId){case "TableBorderWidth_1":this.SG=this.mz[1];break;case "TableBorderWidth_2":this.SG=this.mz[2];break;case "TableBorderWidth_3":this.SG=this.mz[3];break;case "TableBorderWidth_4":this.SG=this.mz[4];break;case "TableBorderWidth_5":this.SG=this.mz[5];break;case "TableBorderWidth_6":this.SG=this.mz[6];
break;case "TableBorderWidth_7":this.SG=this.mz[7];break;case "TableBorderWidth_8":this.SG=this.mz[8];break;case "TableBorderWidth_9":this.SG=this.mz[9]}this.FD.uF();return 32}hHa(a,b){return(a=Object(va.a)(Ph.a,a))?(this.SG===b?a.Kf(!0):a.Kf(!1),32):8}Xnj(a,b,c,f,l){return this.hHa(l,this.mz[1])}Ynj(a,b,c,f,l){return this.hHa(l,this.mz[2])}Znj(a,b,c,f,l){return this.hHa(l,this.mz[3])}$nj(a,b,c,f,l){return this.hHa(l,this.mz[4])}aoj(a,b,c,f,l){return this.hHa(l,this.mz[5])}boj(a,b,c,f,l){return this.hHa(l,
this.mz[6])}coj(a,b,c,f,l){return this.hHa(l,this.mz[7])}doj(a,b,c,f,l){return this.hHa(l,this.mz[8])}eoj(a,b,c,f,l){return this.hHa(l,this.mz[9])}spj(){const a=this.ra.Po();return a&&this.N4()&&this.Ga.wdb&&this.xpa(a)?32:8}Loj(a,b,c,f,l){a=this.ra.Po();if(!(a&&this.N4()&&this.xpa(a)&&this.Ga.wdb))return 16;if(1===c)return 32;if(!l)return 8;this.Ww=Cf.Box4ColorHelper.s0(l);this.FD.uF();return 32}fnj(a,b,c,f,l){a=this.ra.Po();if(!(a&&this.N4()&&this.xpa(a)))return 16;if(1===c)return 32;if(!l)return 8;
c=this.ta.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");a=this.Yb.yf.J1;b=Object.assign(new sk.a,{Id:"PptRibbon.TableDesign.CellBorderColors",MenuSectionList:[]});Array.add(b.MenuSectionList,bl.f(c.Se,"Theme Colors","Color.Menu.Controls","themeColor","CellBorderColorPicker","71763897",1));Array.add(b.MenuSectionList,bl.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellBorderColorPicker","71763897",!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",
!1)),Array.add(b.MenuSectionList,bl.c(a,"Recent Colors","Color.Menu.Controls","recentColor","CellBorderRecentColors","1124206375",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!0));l.MenuItems=b;return 32}Sjj(a,b,c,f,l){if(1===c)return this.ia.Ka(ba.a.Oid,c,l);if(!l)return ya.a.J(512500100,822,10,"HandleCellBorderRecentColor: actionData is null"),16;a=this.ia.Ka(ba.a.Oid,c,l);32===a&&this.ia.Ka(ba.a.xza,c,l);return a}lmj(a,b,c,f,l){a=this.ra.Po();
if(!(a&&this.N4()&&this.Ga.wdb&&this.xpa(a)))return ya.a.J(512500099,822,10,"HandleMoreCellBorderColors: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ka(ba.a.renderColorPicker,1,l);c=null;b.Kk&&(b=b.node)&&b.cellShading&&b.cellShading.solidFillField&&(c=Cf.Box4ColorHelper.Wqa(b.cellShading.solidFillField));b={};b.currentColor=c;b.handleCommand=ba.a.Oid;return this.ia.Ka(ba.a.renderColorPicker,2,b)}tpj(){const a=this.ra.Po();return a&&this.N4()&&this.Ga.K9&&this.xpa(a)?
32:8}Hoj(a,b,c,f,l){if(2===c)return this.DOc(a,b,c,f,l);const x=this.Xhg(a,b,c,f,l);a=this.Yhg(a,b,c,f,l);return 32===x||32===a?32:8}Xhg(a,b,c,f,l){if(2===c)return this.DOc(a,b,c,f,l);c=this.ra.Po();a=!!c&&this.N4()&&this.Ga.K9&&this.xpa(c);if(!a)return 8;if(this.ra.ku())return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.sc.UE(c));if(!b||!b.length)return 16;a=!1;c=b[0].rowIndex;for(const x of b)if(c!==x.rowIndex){a=!0;break}return a?32:8}Yhg(a,b,c,f,l){if(2===c)return this.DOc(a,b,c,f,l);
c=this.ra.Po();a=!!c&&this.N4()&&this.Ga.K9&&this.xpa(c);if(!a)return 8;if(this.ra.ku())return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.sc.UE(c));if(!b||!b.length)return 16;a=!1;c=b[0].li;for(const x of b)if(c!==x.li){a=!0;break}return a?32:8}DOc(a,b,c,f,l){if(this.ra.ku())return 16;const x=this.ra.Po();if(!x)return 16;if(1===c)return this.xpa(x)?32:8;if(!l)return ya.a.J(512500098,822,10,"HandleSelectTableBorderType: actionData is null"),16;let F=this.ra.ny();if(!F)return 16;F.length||
(F=this.lBa(this.sc.UE(x)));if(!F||!F.length)return ya.a.J(512500097,822,10,"HandleSelectTableBorderType: unable to get valid cellNodes"),16;b=this.SG;let R=je.a.$G(b),fa=this.Ww;const wa=l.SourceControlId;if(!wa||!fa)return ya.a.J(512500096,822,10,String.format("HandleSelectTableBorderType: Invalid Table Border params recorded.")),8;this.$E.Jb(wa)&&this.$E.ga(wa)&&(R=b=0,fa=eu.a.parse("000000").iJa());return ju.fNi(a,wa,b.toString(),this.iui(fa),wN.a[this.ia.gq],()=>{const Xa=this.Db.je(15);Xa.jc(x);
Xa.$c=a;switch(wa){case "TableBordersTopBorder":this.JQa(x,F,R,fa,!1,!1);break;case "TableBordersBottomBorder":this.EQa(x,F,R,fa,!1,!1);break;case "TableBordersLeftBorder":this.HQa(x,F,R,fa,!1,!1);break;case "TableBordersRightBorder":this.IQa(x,F,R,fa,!1,!1);break;case "TableBordersInsideHorizontalBorder":this.FQa(x,F,R,fa,!1,!1,!1);break;case "TableBordersInsideVerticalBorder":this.GQa(x,F,R,fa,!1,!1,!1);break;case "TableBordersInsideBorders":this.FQa(x,F,R,fa,!1,!1,!1);this.GQa(x,F,R,fa,!1,!1,!1);
break;case "TableBordersOutsideBorders":this.JQa(x,F,R,fa,!1,!1);this.EQa(x,F,R,fa,!1,!1);this.HQa(x,F,R,fa,!1,!1);this.IQa(x,F,R,fa,!1,!1);break;case "TableBordersNoBorder":R=0;fa=eu.a.parse("000000").iJa();this.JQa(x,F,R,fa,!1,!0);this.EQa(x,F,R,fa,!1,!0);this.HQa(x,F,R,fa,!1,!0);this.IQa(x,F,R,fa,!1,!0);this.FQa(x,F,R,fa,!1,!1,!1);this.GQa(x,F,R,fa,!1,!1,!1);this.Ga.bze&&(this.Fgg(F,R,fa),this.Egg(F,R,fa));break;case "TableBordersAllBorders":this.JQa(x,F,R,fa,!1,!1);this.EQa(x,F,R,fa,!1,!1);this.HQa(x,
F,R,fa,!1,!1);this.IQa(x,F,R,fa,!1,!1);this.FQa(x,F,R,fa,!1,!1,!1);this.GQa(x,F,R,fa,!1,!1,!1);break;case "TableBordersDiagonalUpBorder":this.Fgg(F,R,fa);break;case "TableBordersDiagonalDownBorder":this.Egg(F,R,fa);break;default:ya.a.J(512500067,822,10,String.format("HandleSelectTableBorderType: Invalid Table borderType : {0} with actionId : {1} ",wa,a))}Xa.dispose();return 32})}lBa(a){const b=[];for(const c of a)c.isGhostCell||b.push(c);return b}Snj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();
if(!b)return 16;b.length||(b=this.lBa(this.sc.UE(a)));if(!b||!b.length)return ya.a.J(512500066,822,10,"HandleQueryTableBorderType_LeftBorder: unable to get valid cellNodes"),16;l=Object(va.a)(Ph.a,l);c=je.a.$G(this.SG);return l?(this.HQa(a,b,c,this.Ww,!0,!1)?(this.$E.$("TableBordersLeftBorder",!0),l.Kf(!0)):(this.$E.$("TableBordersLeftBorder",!1),l.Kf(!1)),32):8}Vnj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.lBa(this.sc.UE(a)));if(!b||!b.length)return ya.a.J(512500065,
822,10,"HandleQueryTableBorderType_RightBorder: unable to get valid cellNodes"),16;l=Object(va.a)(Ph.a,l);c=je.a.$G(this.SG);return l?(this.IQa(a,b,c,this.Ww,!0,!1)?(this.$E.$("TableBordersRightBorder",!0),l.Kf(!0)):(this.$E.$("TableBordersRightBorder",!1),l.Kf(!1)),32):8}Wnj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.lBa(this.sc.UE(a)));if(!b||!b.length)return ya.a.J(512500064,822,10,"HandleQueryTableBorderType_TopBorder: unable to get valid cellNodes"),
16;l=Object(va.a)(Ph.a,l);c=je.a.$G(this.SG);return l?(this.JQa(a,b,c,this.Ww,!0,!1)?(this.$E.$("TableBordersTopBorder",!0),l.Kf(!0)):(this.$E.$("TableBordersTopBorder",!1),l.Kf(!1)),32):8}Mnj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.lBa(this.sc.UE(a)));if(!b||!b.length)return ya.a.J(512500063,822,10,"HandleQueryTableBorderType_BottomBorder: unable to get valid cellNodes"),16;l=Object(va.a)(Ph.a,l);c=je.a.$G(this.SG);return l?(this.EQa(a,b,c,this.Ww,
!0,!1)?(this.$E.$("TableBordersBottomBorder",!0),l.Kf(!0)):(this.$E.$("TableBordersBottomBorder",!1),l.Kf(!1)),32):8}Qnj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.sc.UE(a));if(!b||!b.length)return ya.a.J(512500062,822,10,"HandleQueryTableBorderType_InsideHorizontalBorder: unable to get valid cellNodes"),16;l=Object(va.a)(Ph.a,l);c=je.a.$G(this.SG);return l?(this.FQa(a,b,c,this.Ww,!0,!1,!1)?(this.$E.$("TableBordersInsideHorizontalBorder",!0),l.Kf(!0)):
(this.$E.$("TableBordersInsideHorizontalBorder",!1),l.Kf(!1)),32):8}Rnj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.sc.UE(a));if(!b||!b.length)return ya.a.J(512500061,822,10,"HandleQueryTableBorderType_InsideVerticalBorder: unable to get valid cellNodes"),16;l=Object(va.a)(Ph.a,l);c=je.a.$G(this.SG);return l?(this.GQa(a,b,c,this.Ww,!0,!1,!1)?(this.$E.$("TableBordersInsideVerticalBorder",!0),l.Kf(!0)):(this.$E.$("TableBordersInsideVerticalBorder",!1),
l.Kf(!1)),32):8}Onj(a,b,c,f,l){return this.Lhg(l,"TableBordersDiagonalUpBorder")}Nnj(a,b,c,f,l){return this.Lhg(l,"TableBordersDiagonalDownBorder")}Lhg(a,b){if(!this.Ga.bze)return 8;const c=this.ra.Po();if(!c||!a)return 16;var f=this.ra.ny();if(!f)return 16;f.length||(f=this.lBa(this.sc.UE(c)));if(!f||!f.length)return ya.a.J(512500060,822,10,String.format("HandleQueryTableBorderType: unable to get valid cellNodes, borderType : {0} ",b)),16;a=Object(va.a)(Ph.a,a);if(null===a)return 8;f=this.ICj(b,
f,je.a.$G(this.SG));this.$E.$(b,f);a.Kf(f);return 32}ICj(a,b,c){switch(a){case "TableBordersDiagonalUpBorder":return this.osg(b,c,this.Ww,!1);case "TableBordersDiagonalDownBorder":return this.nsg(b,c,this.Ww,!1);default:return ya.a.J(512500059,822,10,String.format("IsBorderApplied: Invalid Table borderType : {0} ",a)),!1}}Pnj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.sc.UE(a));if(!b||!b.length)return ya.a.J(512500058,822,10,"HandleQueryTableBorderType_InsideBorder: unable to get valid cellNodes"),
16;l=Object(va.a)(Ph.a,l);c=je.a.$G(this.SG);return l?(1<b.length&&this.GQa(a,b,c,this.Ww,!0,!1,!0)&&this.FQa(a,b,c,this.Ww,!0,!1,!0)?(this.$E.$("TableBordersInsideBorders",!0),l.Kf(!0)):(this.$E.$("TableBordersInsideBorders",!1),l.Kf(!1)),32):8}Unj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.lBa(this.sc.UE(a)));if(!b||!b.length)return ya.a.J(512500057,822,10,"HandleQueryTableBorderType_OutsideBorder: unable to get valid cellNodes"),16;l=Object(va.a)(Ph.a,
l);c=je.a.$G(this.SG);return l?(this.JQa(a,b,c,this.Ww,!0,!1)&&this.IQa(a,b,c,this.Ww,!0,!1)&&this.EQa(a,b,c,this.Ww,!0,!1)&&this.HQa(a,b,c,this.Ww,!0,!1)?(this.$E.$("TableBordersOutsideBorders",!0),l.Kf(!0)):(this.$E.$("TableBordersOutsideBorders",!1),l.Kf(!1)),32):8}Lnj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.lBa(this.sc.UE(a)));if(!b||!b.length)return ya.a.J(512500056,822,10,"HandleQueryTableBorderType_AllBorder: unable to get valid cellNodes"),
16;l=Object(va.a)(Ph.a,l);c=je.a.$G(this.SG);return l?(this.JQa(a,b,c,this.Ww,!0,!1)&&this.IQa(a,b,c,this.Ww,!0,!1)&&this.EQa(a,b,c,this.Ww,!0,!1)&&this.HQa(a,b,c,this.Ww,!0,!1)&&this.FQa(a,b,c,this.Ww,!0,!1,!0)&&this.GQa(a,b,c,this.Ww,!0,!1,!0)?(this.$E.$("TableBordersAllBorders",!0),l.Kf(!0)):(this.$E.$("TableBordersAllBorders",!1),l.Kf(!1)),32):8}Tnj(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.ny();if(!b)return 16;b.length||(b=this.lBa(this.sc.UE(a)));if(!b||!b.length)return ya.a.J(512500055,
822,10,"HandleQueryTableBorderType_NoBorder: unable to get valid cellNodes"),16;l=Object(va.a)(Ph.a,l);c=je.a.$G(this.SG);return l?(f=!0,this.Ga.bze&&(f=this.osg(b,c,this.Ww,!0)&&this.nsg(b,c,this.Ww,!0)),f&&this.JQa(a,b,c,this.Ww,!0,!0)&&this.IQa(a,b,c,this.Ww,!0,!0)&&this.EQa(a,b,c,this.Ww,!0,!0)&&this.HQa(a,b,c,this.Ww,!0,!0)&&this.FQa(a,b,c,this.Ww,!0,!0,!0)&&this.GQa(a,b,c,this.Ww,!0,!0,!0)?(this.$E.$("TableBordersNoBorder",!0),l.Kf(!0)):(this.$E.$("TableBordersNoBorder",!1),l.Kf(!1)),32):8}pCa(a,
b){if(!a)return!1;const c=Cf.Box4ColorHelper.Cwa(a),f=Cf.Box4ColorHelper.Cwa(b);a=Cf.Box4ColorHelper.Wqa(a);b=Cf.Box4ColorHelper.Wqa(b);return c.schemeClrField&&f.schemeClrField&&!a&&!b&&c.schemeClrField.valField===f.schemeClrField.valField?!0:a&&b?a.alpha===b.alpha&&a.zC===b.zC:!1}iui(a){a=Cf.Box4ColorHelper.Cwa(a);const b=this.ta.Ba;return(a=Cf.Box4ColorHelper.CL(a,b?b.Se:null))&&Cf.Box4ColorHelper.$ma(a)?Cf.Box4ColorHelper.$ma(a).jU():null}jqb(a,b,c,f){if(a=Object(va.a)(Ss,a.oc(this.Qb.Ma))){f=
Cf.Box4ColorHelper.Cwa(f);var l=this.ta.Ba;f=(f=Cf.Box4ColorHelper.CL(f,l?l.Se:null))?Cf.Box4ColorHelper.$ma(f):null;a.P0k(b,c,f)}}Gu(a,b,c,f){if(a)switch(b){case "Top":a.Owa=c;a.Mgb=f;this.jqb(a,"Top",c,f);break;case "Right":a.Nea=c;a.Mwa=f;this.jqb(a,"Right",c,f);break;case "Bottom":a.Mea=c;a.Lwa=f;this.jqb(a,"Bottom",c,f);break;case "Left":a.Nwa=c;a.Lgb=f;this.jqb(a,"Left",c,f);break;case "DiagonalUp":a.Ogb=c;a.Kgb=f;this.jqb(a,"DiagonalUp",c,f);break;case "DiagonalDown":a.Ngb=c,a.Jgb=f,this.jqb(a,
"DiagonalDown",c,f)}}JQa(a,b,c,f,l,x){const F=new ua.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,fa=-1;for(const wa of b)b=wa.li,R=Math.min(R,b),fa=Math.max(fa,b),F.Jb(b)?F.$(b,Math.min(F.ga(b),wa.rowIndex)):F.$(b,wa.rowIndex);if(l)return this.ROj(a,c,f,R,fa,F,x);this.Fjj(a,c,f,R,fa,F);return!0}Fjj(a,b,c,f,l,x){if(ee.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=a.ef(x.ga(f),f);this.Gu(R,"Top",b,c);let fa=f;const wa=f+R.colSpan;for(;fa<wa;){var F=a.ef(x.ga(f)-1,fa);F?F.isGhostCell?(F=
F.oy(),F.li<f?fa+=1:(this.Gu(F,"Bottom",b,c),fa+=F.colSpan)):(this.Gu(F,"Bottom",b,c),fa+=F.colSpan):fa+=1}f+=R.colSpan}else for(;f<=l;++f)this.Gu(a.ef(x.ga(f),f),"Top",b,c),this.Gu(a.ef(x.ga(f)-1,f),"Bottom",b,c)}ROj(a,b,c,f,l,x,F){for(;f<=l;){const R=a.ef(x.ga(f),f),fa=R.Mgb,wa=je.a.sL(R.Owa),Xa=je.a.sL(b);if(F){if(wa!==this.mz[0])return!1}else if(wa!==Xa||!this.pCa(fa,c))return!1;f+=R.colSpan}return!0}EQa(a,b,c,f,l,x){const F=new ua.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,fa=-1;for(const wa of b)b=
wa.li,R=Math.min(R,b),fa=Math.max(fa,b),F.Jb(b)?F.$(b,Math.max(F.ga(b),wa.rowIndex)):F.$(b,wa.rowIndex);if(l)return this.LCj(a,c,f,R,fa,F,x);this.ojj(a,c,f,R,fa,F);return!0}ojj(a,b,c,f,l,x){if(ee.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=a.ef(x.ga(f),f);this.Gu(R,"Bottom",b,c);let fa=f;const wa=f+R.colSpan;for(;fa<wa;){var F=a.ef(x.ga(f)+R.rowSpan,fa);F?F.isGhostCell?(F=F.oy(),F.li<f?fa+=1:(this.Gu(F,"Top",b,c),fa+=F.colSpan)):(this.Gu(F,"Top",b,c),fa+=F.colSpan):fa+=1}f+=R.colSpan}else for(;f<=
l;++f)this.Gu(a.ef(x.ga(f),f),"Bottom",b,c),this.Gu(a.ef(x.ga(f)+1,f),"Top",b,c)}LCj(a,b,c,f,l,x,F){for(;f<=l;){const R=a.ef(x.ga(f),f),fa=R.Lwa,wa=je.a.sL(R.Mea),Xa=je.a.sL(b);if(F){if(wa!==this.mz[0])return!1}else if(wa!==Xa||!this.pCa(fa,c))return!1;f+=R.colSpan}return!0}HQa(a,b,c,f,l,x){const F=new ua.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,fa=-1;for(const wa of b)b=wa.rowIndex,R=Math.min(R,b),fa=Math.max(fa,b),F.Jb(b)?F.$(b,Math.min(F.ga(b),wa.li)):F.$(b,wa.li);if(l)return this.fIj(a,c,f,
R,fa,F,x);this.vjj(a,c,f,R,fa,F);return!0}vjj(a,b,c,f,l,x){if(ee.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=a.ef(f,x.ga(f));this.Gu(R,"Left",b,c);let fa=f;const wa=f+R.rowSpan;for(;fa<wa;){var F=a.ef(fa,x.ga(f)-1);F?F.isGhostCell?(F=F.oy(),F.rowIndex<f?fa+=1:(this.Gu(F,"Right",b,c),fa+=F.rowSpan)):(this.Gu(F,"Right",b,c),fa+=F.rowSpan):fa+=1}f+=R.rowSpan}else for(;f<=l;++f)this.Gu(a.ef(f,x.ga(f)),"Left",b,c),this.Gu(a.ef(f,x.ga(f)-1),"Right",b,c)}fIj(a,b,c,f,l,x,F){for(;f<=l;){const R=
a.ef(f,x.ga(f)),fa=R.Lgb,wa=je.a.sL(R.Nwa),Xa=je.a.sL(b);if(F){if(wa!==this.mz[0])return!1}else if(wa!==Xa||!this.pCa(fa,c))return!1;f+=R.rowSpan}return!0}IQa(a,b,c,f,l,x){const F=new ua.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,fa=-1;for(const wa of b)b=wa.rowIndex,R=Math.min(R,b),fa=Math.max(fa,b),F.Jb(b)?F.$(b,Math.max(F.ga(b),wa.li)):F.$(b,wa.li);if(l)return this.aMj(a,c,f,R,fa,F,x);this.wjj(a,c,f,R,fa,F);return!0}wjj(a,b,c,f,l,x){if(ee.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=
a.ef(f,x.ga(f));this.Gu(R,"Right",b,c);let fa=f;const wa=f+R.rowSpan;for(;fa<wa;){var F=a.ef(fa,x.ga(f)+R.colSpan);F?F.isGhostCell?(F=F.oy(),F.rowIndex<f?fa+=1:(this.Gu(F,"Left",b,c),fa+=F.rowSpan)):(this.Gu(F,"Left",b,c),fa+=F.rowSpan):fa+=1}f+=R.rowSpan}else for(;f<=l;++f)this.Gu(a.ef(f,x.ga(f)),"Right",b,c),this.Gu(a.ef(f,x.ga(f)+1),"Left",b,c)}aMj(a,b,c,f,l,x,F){for(;f<=l;){const R=a.ef(f,x.ga(f)),fa=R.Mwa,wa=je.a.sL(R.Nea),Xa=je.a.sL(b);if(F){if(wa!==this.mz[0])return!1}else if(wa!==Xa||!this.pCa(fa,
c))return!1;f+=R.rowSpan}return!0}GQa(a,b,c,f,l,x,F){b=this.ra.Esb();if(!b)return!1;b.length||(b=this.sc.UE(a));if(!b||!b.length)return ya.a.J(512500054,822,10,"HandleSelectionInsideVerticalBorders: unable to get valid cellNodes"),!1;const R=new ua.ScriptSharpLegacyMap,fa=new ua.ScriptSharpLegacyMap;let wa=Number.MAX_VALUE,Xa=-1;for(const lb of b)b=lb.rowIndex,wa=Math.min(wa,b),Xa=Math.max(Xa,b),R.Jb(b)?R.$(b,Math.min(R.ga(b),lb.li)):R.$(b,lb.li),fa.Jb(b)?fa.$(b,Math.max(fa.ga(b),lb.li)):fa.$(b,lb.li);
if(l)return this.GHj(a,c,f,wa,Xa,R,fa,x,F);this.ujj(a,c,f,wa,Xa,R,fa);return!0}ujj(a,b,c,f,l,x,F){if(ee.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(x.Jb(f)&&F.Jb(f))for(var R=x.ga(f),fa=F.ga(f);R<fa;){const Xa=a.ef(f,R);if(!Xa.isGhostCell&&Xa.li+Xa.colSpan<=fa){this.Gu(Xa,"Right",b,c);let lb=f;const Lb=f+Xa.rowSpan;for(;lb<Lb;){var wa=a.ef(lb,R+Xa.colSpan);wa?wa.isGhostCell?(wa=wa.oy(),wa.rowIndex<f?lb+=1:(this.Gu(wa,"Left",b,c),lb+=wa.rowSpan)):(this.Gu(wa,"Left",b,c),lb+=wa.rowSpan):
lb+=1}}R+=Xa.colSpan}}else for(;f<=l;++f)for(R=x.ga(f),fa=F.ga(f);R<fa;++R)this.Gu(a.ef(f,R),"Right",b,c),this.Gu(a.ef(f,R+1),"Left",b,c)}GHj(a,b,c,f,l,x,F,R,fa){if(ee.a("TableBordersComplexTableFixEnabled")){for(var wa=!1;f<=l;f++)if(x.Jb(f)&&F.Jb(f))for(var Xa=x.ga(f),lb=F.ga(f);Xa<lb;){var Lb=a.ef(f,Xa);if(!Lb.isGhostCell&&Lb.li+Lb.colSpan<=lb){var kc=Lb.Mwa;let lc=je.a.sL(Lb.Nea),Ec=je.a.sL(b);wa=!0;if(R){if(lc!==this.mz[0])return!1}else if(lc!==Ec||!this.pCa(kc,c))return!1}Xa+=Lb.colSpan}return wa?
!0:fa}for(wa=f;wa<=l;++wa){lb=x.ga(wa);f=F.ga(wa);if(lb===f)return fa?!0:!1;for(;lb<f;++lb)if(Lb=a.ef(wa,lb),Xa=Lb.Mwa,Lb=je.a.sL(Lb.Nea),kc=je.a.sL(b),R){if(Lb!==this.mz[0])return!1}else if(Lb!==kc||!this.pCa(Xa,c))return!1}return!0}FQa(a,b,c,f,l,x,F){b=this.ra.Esb();if(!b)return!1;b.length||(b=this.sc.UE(a));if(!b||!b.length)return ya.a.J(512500053,822,10,"HandleSelectionInsideHorizontalBorders: unable to get valid cellNodes"),!1;const R=new ua.ScriptSharpLegacyMap,fa=new ua.ScriptSharpLegacyMap;
let wa=Number.MAX_VALUE,Xa=-1;for(const lb of b)b=lb.li,wa=Math.min(wa,b),Xa=Math.max(Xa,b),R.Jb(b)?R.$(b,Math.min(R.ga(b),lb.rowIndex)):R.$(b,lb.rowIndex),fa.Jb(b)?fa.$(b,Math.max(fa.ga(b),lb.rowIndex)):fa.$(b,lb.rowIndex);if(l)return this.FHj(a,c,f,wa,Xa,R,fa,x,F);this.tjj(a,c,f,wa,Xa,R,fa);return!0}tjj(a,b,c,f,l,x,F){if(ee.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(x.Jb(f)&&F.Jb(f))for(var R=x.ga(f),fa=F.ga(f);R<fa;){const Xa=a.ef(R,f);if(!Xa.isGhostCell&&Xa.rowIndex+Xa.rowSpan<=
fa){this.Gu(Xa,"Bottom",b,c);let lb=f;const Lb=f+Xa.colSpan;for(;lb<Lb;){var wa=a.ef(R+Xa.rowSpan,lb);wa?wa.isGhostCell?(wa=wa.oy(),wa.li<f?lb+=1:(this.Gu(wa,"Top",b,c),lb+=wa.colSpan)):(this.Gu(wa,"Top",b,c),lb+=wa.colSpan):lb+=1}}R+=Xa.rowSpan}}else for(;f<=l;++f)for(R=x.ga(f),fa=F.ga(f);R<fa;++R)this.Gu(a.ef(R,f),"Bottom",b,c),this.Gu(a.ef(R+1,f),"Top",b,c)}FHj(a,b,c,f,l,x,F,R,fa){if(ee.a("TableBordersComplexTableFixEnabled")){for(var wa=!1;f<=l;f++)if(x.Jb(f)&&F.Jb(f))for(var Xa=x.ga(f),lb=F.ga(f);Xa<
lb;){var Lb=a.ef(Xa,f);if(!Lb.isGhostCell&&Lb.rowIndex+Lb.rowSpan<=lb){var kc=Lb.Lwa;let lc=je.a.sL(Lb.Mea),Ec=je.a.sL(b);wa=!0;if(R){if(lc!==this.mz[0])return!1}else if(lc!==Ec||!this.pCa(kc,c))return!1}Xa+=Lb.rowSpan}return wa?!0:fa}for(wa=f;wa<=l;++wa){lb=x.ga(wa);f=F.ga(wa);if(lb===f)return fa?!0:!1;for(;lb<f;++lb)if(Lb=a.ef(lb,wa),Xa=Lb.Lwa,Lb=je.a.sL(Lb.Mea),kc=je.a.sL(b),R){if(Lb!==this.mz[0])return!1}else if(Lb!==kc||!this.pCa(Xa,c))return!1}return!0}Fgg(a,b,c){for(const f of a)this.Gu(f,
"DiagonalUp",b,c)}osg(a,b,c,f){for(const l of a)if(!this.rwg(je.a.sL(l.Ogb),je.a.sL(b),l.Kgb,c,f))return!1;return!0}Egg(a,b,c){for(const f of a)this.Gu(f,"DiagonalDown",b,c)}nsg(a,b,c,f){for(const l of a)if(!this.rwg(je.a.sL(l.Ngb),je.a.sL(b),l.Jgb,c,f))return!1;return!0}rwg(a,b,c,f,l){if(l){if(a!==this.mz[0])return!1}else if(a!==b||!this.pCa(c,f))return!1;return!0}wBe(a,b,c,f,l){if(!l)return 8;if(1===c)return 32;l[ai.a.On]=!1;a=this.VSa[a.toString()];if(!this.ra||!this.ra.Oa.kb||this.ra.L7())return 16;
b=0;({kva:b}=this.sc.Ckd(this.ra.Oa)).returnValue&&b===a&&(l[ai.a.On]=!0);return 32}zjc(a,b){a=a.queryResult;null!==a&&(a.Fea=parseFloat(b.toFixed(2)).toString())}pad(a,b,c,f,l){if(!l)return 16;l.Kf(this.D9b);return 32}Afd(a,b,c){if(1===c)return 32;2===c&&(this.D9b=!this.D9b);Gb.App.Fb.HF({SetLockAspectRatio:"CheckboxModel"});return 32}k9g(a,b,c,f,l){if(!l)return 16;b=this.ra.Po();if(!b)return 8;a=a===ba.a.gbd?this.sc.q1d(b):this.sc.s1d(b);this.zjc(l,je.a.mv(a));return 32}tmh(a,b,c,f,l){const x=this.ra.Po();
return a!==ba.a.jwa&&a!==ba.a.aYa||!x?16:1===c?32:sg.a(String.format("{0}::Entry point:{1}",ba.a.vz(a),this.ia.gq),a,()=>{if(!l)return ya.a.J(512500052,822,10,"TableActor::SetTableSize actionData == null"),8;var F=je.a.DV(l.Number);var R=a===ba.a.jwa?this.sc.q1d(x):this.sc.s1d(x);if(F<Fv.a.e5c||R<Fv.a.e5c)return 16;F/=R;R=this.Db.je(15);try{R.jc(x),R.$c=a,a===ba.a.jwa?(this.$r.jwa(x,F),this.D9b&&this.$r.aYa(x,F)):(this.$r.aYa(x,F),this.D9b&&this.$r.jwa(x,F)),this.$r.UWa(x)}finally{R&&R.dispose()}return 32})}$gc(a,
b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.aNc();if(!b)return 16;b.length||(b=this.sc.lia(a));if(!b.length)return 16;a=this.hVa.Q7f(b);this.zjc(l,je.a.mv(a));return 32}Lfb(a,b,c,f,l){const x=this.ra.Po();return x?1===c?32:sg.a(String.format("SetTableRowHeight::Entry point:{0}",this.ia.gq),a,()=>{if(null===l)return ya.a.J(512500051,822,10,"TableActor::SetTableRowHeight actionData == null"),16;let F=this.ra.aNc();if(!F)return ya.a.J(512500050,822,10,"TableActor::SetTableRowHeight, selected table row nodes == null"),
16;F.length||(F=this.sc.lia(x));if(!F.length)return 16;let R=Fv.a.aTg;a!==ba.a.Ihd&&(R=l.Number);const fa=this.Db.je(15);try{fa.jc(x),fa.$c=a,this.$r.smh(F,R)}finally{fa&&fa.dispose()}this.$r.UWa(x);return 32}):16}Zgc(a,b,c,f,l){a=this.ra.Po();if(!a)return 16;b=this.ra.Esb();if(!b)return 16;b.length||(b=this.Lsb(a));if(!b.length)return 16;a=this.KI.S7f(a,b);this.zjc(l,je.a.mv(a));return 32}$Xa(a,b,c,f,l){const x=this.ra.Po();return x?1===c?32:sg.a(String.format("SetTableColumnWidth::Entry point:{0}",
this.ia.gq),a,()=>{if(null===l)return ya.a.J(512500049,822,10,"TableActor::SetTableColumnWidth actionData == null"),16;var F=this.ra.Esb();if(!F)return ya.a.J(512500048,822,10,"TableActor::SetTableColumnWidth, selected column node == null"),16;F.length||(F=this.Lsb(x));if(!F.length)return 16;let R=Fv.a.$Sg;a!==ba.a.Hhd&&(R=l.Number);F=this.KI.KXd(F);const fa=this.Db.je(15);try{fa.jc(x),fa.$c=a,this.$r.rmh(x,F,R)}finally{fa&&fa.dispose()}this.$r.UWa(x);return 32}):16}Tgg(a,b,c,f,l){const x=this.ra.Po();
return x?1===c?ee.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:x.lp()?8:32:sg.a("HandleDistributeRows:Entry point:"+this.ia.gq,a,()=>{if(2===c){if(null===l)return 16;let fa=this.ra.aNc();if(!fa)return 16;var F=this.ra.ny();if(!F)return 16;fa.length&&1!==F.length||(fa=this.sc.lia(x));if(!fa)return 16;if(!fa.length)return ya.a.J(512500047,822,50,"HandleDistributeRows: unable to get valid tableRowNodes"),16;F=0;for(var R of fa)R&&(F+=this.hVa.l6a(R));R=this.c7i(fa,x);const wa=fa.length;F=F<
wa*R?R:F/wa;R=this.Db.je(15);try{R.jc(x),R.$c=a,this.$r.smh(fa,je.a.mv(F))}finally{R&&R.dispose()}ya.a.J(512500046,822,50,"HandleDistributeRows: Table Rows Distributed with height: {0}, from Entry Point: {1}",je.a.mv(F),this.ia.gq);this.$r.UWa(x)}return 32}):16}c7i(a,b){let c=je.a.DV(Fv.a.aTg);for(const l of a){a=this.sc.J6a(l);for(const x of a)if(x&&(a=x.mZb)&&(a=Ya.ParagraphReader.text(a))&&0<a.length){var f=x.rowIndex;const F=x.li;if(a=Object(va.a)(Ss,x.oc(this.Qb.Ma)))this.QW.b6g(b,this.Qb.Ma),
f=this.QW.e_b(b,a.kha,f,F),a=a.Fd.Cd.Ef(f,1),ee.a("DistributeRowsAndColumnsComplexTableFixEnabled")&&1<x.rowSpan&&(a/=x.rowSpan),c=Math.max(c,a)}}return c}Mkj(a,b,c,f,l){const x=this.ra.Po();return x?1===c?ee.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:x.lp()?8:32:sg.a("HandleDistributeColumns:Entry point:"+this.ia.gq,a,()=>{if(2===c){if(null===l)return 16;var F=this.ra.Esb();F.length||(F=this.Lsb(x));if(!F)return 16;var R=this.ra.ny();if(!R)return 16;F.length&&1!==R.length||(F=this.Lsb(x));
if(!F.length)return ya.a.J(512500045,822,50,"HandleDistributeColumns: unable to get valid tableColumnNodes"),16;R=0;F=this.KI.KXd(F);if(!F)return ya.a.J(512500044,822,50,"HandleDistributeColumns: table columnIndex array is null"),16;var fa=x.GXd;if(!fa)return ya.a.J(512500043,822,50,"HandleDistributeColumns: table columnWidths array is null"),16;for(let wa=0;wa<F.length;wa++)R+=fa[F[wa]];R/=F.length;if(je.a.mv(R)<Fv.a.$Sg)return 16;fa=this.Db.je(15);try{fa.jc(x),fa.$c=a,this.$r.rmh(x,F,je.a.mv(R))}finally{fa&&
fa.dispose()}ya.a.J(512500042,822,50,"HandleDistributeColumns: Table Columns Distributed with width: {0}, from Entry Point: {1}",je.a.mv(R),this.ia.gq);this.$r.UWa(x)}return 32}):16}f3d(a,b,c,f,l){if(!this.Ga.dae||this.ra.L7())return 16;if(1===c)return 32;if(!l)return 8;c=this.VSa[a.toString()];b=b.node;f=this.Db.je(15);f.jc(b);f.$c=a;a=b.cellShading;a.anchorField=c;b.cellShading=a;b.Wma=c;f.dispose();return 32}Wlj(a,b,c,f,l){b=this.ta.Ba;if(!b||this.Af.Zc(b))return 16;if(!this.gl.lI(b,1))return this.gl.kJ(b),
16;c=l.Rows;f=l.Columns;l=l.From;var x=b.Bb;x=b.K6(x.sid,x.cid,0,c,f,b.Qu());var F=b.j2(this.ra.ae());if(F){if(this.Af.Zc(F)||this.Ea.fI(F))return 16;this.xm.M0k(x,F.id);this.Af.zw(F,a)}F=this.Db.rd(15,void 0,()=>{this.ra.ly();this.ra.Ph();this.Fa.Ad()});try{F.jc(b),F.$c=a,b.rB(x)}finally{F&&F.dispose()}this.ra.selectShape(x,!0);ya.a.J(512500040,822,50,"Insert {0}x{1} table from {2}",f,c,l);this.Mx.pI=x;return 32}Xlj(){(new yN((a,b)=>{const c={};c.Rows=a;c.Columns=b;c.From="Placeholder";this.ia.Ka(ba.a.n$c,
2,c)})).ahd();return 32}Ylj(a,b,c,f,l){l.From="Ribbon";return this.ia.Ka(ba.a.n$c,c,l)}Ikj(a,b,c){b=this.ta.Ba;if(!b||this.ra.L7())return 16;const f=this.ra.jq();if(!f||!f.nd||this.Af.Zc(f))return 16;if(1===c)return 32;Mc.a.uO(!0,!0);c=this.Db.rd(15,void 0,()=>{this.ra.setSelection(null);this.Fa.Ad()});try{c.jc(b),c.$c=a,this.xm.UWf(f)}finally{c&&c.dispose()}this.Af.zw(b,a);return 32}Kkj(a,b,c,f,l){if(this.ra.ku())return 16;a=this.i0d(this.ra.Dj,!0,this.ra);return this.SBj(a)?16:32!==a.response?8:
a.lC&&a.lC.length===xd.TableReader.$j(a.No)?this.ia.processAction(ba.a.lDb,c):this.ia.ii(b,C.a.deleteRow,c,!1,f,l)}Jkj(a,b,c,f,l){if(this.ra.ku())return 16;a=this.i0d(this.ra.Dj,!1,this.ra);return this.RBj(a)?16:32!==a.response?8:a.lC&&a.lC.length===xd.TableReader.ui(a.No)?this.ia.processAction(ba.a.lDb,c):this.ia.ii(b,C.a.EAa,c,!1,f,l)}Koj(a,b,c,f,l){return 1===c?32:this.ia.ii(b,ba.a.jha,c,!1,f,l)}kmj(a,b,c){if(this.ra.ku()||this.ra.L7()||!this.Ga.QTc)return 16;b=this.ra.Oa;if(!b||!b.nl||1===b.length&&
1===b.ga(0).length)return 16;b=this.wAb.C0b(b);if(!b)return ya.a.J(36721626,822,50,"Unable to get cell selection info"),8;if(!b.KLj)return 16;if(1===c)return 32;Mc.a.Cb&&(Mc.a.Cb.Ij=!0,Mc.a.Cb.BE=new Date);ya.a.J(36721628,822,50,"Perform table merge cells");const f=b.tableNode;c=this.Db.je(15);c.jc(f);c.$c=a;a=this.MPg.merge(f,b.yob,b.PX);a=$q.TableNodeContext.create(a);a=nd.SelectionFactory.yWb(nd.SelectionFactory.eu(a));this.ra.ZD(a);c.dispose();ya.a.J(36721630,822,50,"Table merge cells succeeded");
return 32}jpj(a,b,c){if(this.ra.ku()||this.ra.L7()||!this.Ga.iae)return 16;var f=null;f=this.ra.Oa.nl?this.wAb.C0b(this.ra.Oa):this.wAb.Icj(b.view.Eb.Dj);if(!f)return 16;const l=f.tableNode.Ag(this.Qb.Ma);if(l&&!l.dIj)return ya.a.J(512500037,822,50,"Suspend split cells as table layout service is running"),16;const x=Object(va.a)(179,f.tableNode);if(this.sc.o7d(x))return 16;const F=f.yob;if(!({rows:b,cols:a}=this.Ppl(x,F)).returnValue)return 8;if(1===c)return 1<b||1<a?32:16;const R=f.PX,fa=new Date;
({rows:c,cols:f}=this.xZi(x,R,F,l));const wa=Mc.a.Cb;wa&&(wa.Wa("GetClientSplitLimit",(+new Date-+fa).toString()),wa.Ar=!1);(new zN((Xa,lb)=>{this.MPg.Ofl(x,F,Xa,lb,R,l,this.Qb.Cd,Object(D.a)(this,this.Nag,"getNewOutlineElementInfoFromCell"),()=>{})},Math.min(b,c),Math.min(a,f))).ahd();return 32}uoj(a,b,c,f,l){if(!l||!Object(Fa.a)(Array,l))return 8;if(1!==l.length)return ya.a.J(512500036,822,50,"Fallback table resize fail: reiszeShapeData length is {0}.",l.length),8;if(this.Af.Zc(l[0].g0))return 16;
b=l[0].g0;if(!(b&&b.isConnected&&b.isResizable&&b.nd)||b.fI)return ya.a.J(512500035,822,50,"Fallback table resize: try to resize shape {0} which is not resizeable",b.get_shapeId()),16;f=Object(va.a)(124,b.oc(this.Qb.Ma));if(!f)return ya.a.J(512500034,822,50,"Fallback table resize fail: shape {0} has no shapeviewelement",b.get_shapeId()),8;const x=this.sc.XM(b);if(!x)return ya.a.J(512500033,822,50,"Fallback table resize fail: shape {0} has no table node",b.get_shapeId()),8;const F=x.oc(this.Qb.Ma);
if(!F)return ya.a.J(512500032,822,50,"Fallback table resize fail: fallback table shape {0} has no tableviewelement and no rendered",b.get_shapeId()),8;if(!l[0].PXb)return f&&f.setOffsets(new Pd.a,!0),ya.a.J(512500003,822,50,"Fallback table resize fail: resizeShapeData no drag direction"),8;if(1===c)return 32;let R=c=1;try{f.zk.eih.epb.length||(this.o1c=new Pd.a);f.setOffsets(new Pd.a,!0);var fa=F.B0b();const wa=this.LDa.qn(fa.Vb-fa.Zb),Xa=this.LDa.qn(fa.Ub-fa.fc),lb=new ad.a(f.x+wa,f.y+Xa),Lb=new ad.a(f.tea(l[0].tTg.x),
f.tea(l[0].tTg.y)),kc=Zk.FKd(l[0].PXb,fa,Lb,!1,!1);c=wa?1+(kc.right-kc.left)/wa:1;R=Xa?1+(kc.bottom-kc.top)/Xa:1;F.vmh(c,R);const lc=F.B0b();let Ec=td.a.N_b(lc,fa);Ec.Ej(1/f.yd);this.o1c&&(Ec=Pd.a.add(Ec,this.o1c));f.setOffsets(Ec,!0);this.o1c=Ec;l[0].V_.Ej(f.yd);this.tOe(l[0].PXb,f,lc,lb,l[0].V_)}catch(wa){return ya.a.J(512500002,822,50,"Fallback table resize fail: ",wa.toString()),8}fa=this.Db.je(15);fa.jc(x);fa.$c=a;a=F.Fd.Cd;this.$r.cFe(x,c,R,F,a);if(ju.MCa(l[0].PXb)||ju.MCa(l[0].PXb,!0))l=a.Ef(f.x,
0),a=a.Ef(f.y,1),b.My=l,b.Ny=a;fa.dispose();return 32}Ppl(a,b){let c,f;c=f=1;try{return c=Math.max(1,Math.floor((35-this.sc.$j(a))/b.$N)+1),f=Math.max(1,Math.floor((35-this.sc.ui(a))/b.CQ)+1),{returnValue:!0,rows:c,cols:f}}catch(l){ya.a.J(512500001,822,10,"Failed to get server split limits, Exception: {0}",l.toString())}return{returnValue:!1,rows:c,cols:f}}xZi(a,b,c,f){a=this.yca.bBa(a,b,c);b=f.Jcg();f=f.D7f();let l=c=Number.MAX_VALUE;for(;a.moveNext();){const x=a.Ez;l=Math.min(l,b[x.Wf]-b[x.ge]);
c=Math.min(c,f[x.Jf]-f[x.Yd])}return{rows:Math.max(1,Math.floor(l/AN.a)),cols:Math.max(1,Math.floor(c/AN.a))}}Nag(a){const b=Hh.sbg(a,!1);b.style||(b.style=new nq.a);a=Object(va.a)(mb.GraphIterator,this.Mb.Kc(a));a.uv();if(a.uA(1)){if(Ib.ListReader.ak(a)){const f=this.Jz.Fw(a),l=uj.a.kP(f.listType,f.listStyle);0===l.listType&&(l.Yz=l.YV=f.Yz);f.propertySet.Sa(bb.a.Ni)&&l.propertySet.setValue(bb.a.Ni,f.propertySet.getValue(bb.a.Ni));f.propertySet.Sa(bb.a.font)&&l.propertySet.setValue(bb.a.font,f.propertySet.getValue(bb.a.font));
f.propertySet.Sa(ub.a.autonumberBulletType)&&l.propertySet.setValue(ub.a.autonumberBulletType,f.propertySet.getValue(ub.a.autonumberBulletType));b.style.vx(l.propertySet)}var c;(c=b.style).c4a.apply(c,[a.currentNode].concat(Vq.d2d()));if(c=a.uA(2)){let f;(f=b.style).c4a.apply(f,[c].concat(Vq.d2d()));a.uc()}}return b}Y$i(a,b){const c=new Pt;c.response=8;if(!a)return c;let f=null;var l=null,x=!1;const F=Rg.ContextSetEditor.instance.jA(a);a=[];for(var R=0;R<F.length;++R)if(F[R].Kk){var fa=Object(va.a)(5,
F[R].node);if(!fa||!fa.Sr())return c;fa=fa.pK();f||(f=fa.YKc());l?l!==fa&&(x=!0):l=fa}if(!f)return c;R=f.getContainingTable();if(!R)return c;if(x){b=new Ha.a;if(this.IIg){l=this.wAb.C0b(this.ra.Oa).yob;if(l.hPa())return c;for(x=l.ge;x<l.Wf;x++)b.add(x);ya.a.J(5125E5,822,50,"Insert {0} rows",b.count)}else if(b=this.p_i(F),1!==b.count)return c;l=R.Daj(b.ga(0));for(x=0;x<b.count;x++)Array.add(a,Pc.a.create(Object(va.a)(ag.a,l))),l=l.pGa}else{if(!b)for(b=l.rowSpan;0<--b;)f=f.pGa;Array.add(a,Pc.a.create(Object(va.a)(ag.a,
f)))}c.lC=a;c.jHb=Object(va.a)(ag.a,f);c.No=Object(va.a)(ag.a,R);c.Acb=a.length;if(this.Ga.Xu||!xd.TableReader.ju(c.No))c.response=32;return c}S$i(a,b){const c=new Pt;c.response=8;if(!a)return c;var f=null,l=null,x=Rg.ContextSetEditor.instance.jA(a);let F=!1;a=[];for(let fa=0;fa<x.length;++fa)if(x[fa].Kk){var R=Object(va.a)(5,x[fa].node);if(!R||!R.Sr())return c;R=R.pK();f||(f=R.Y7f());l?l!==R&&(F=!0):l=R}if(!l)return c;f=f.getContainingTable();if(!f)return c;if(F){b=new Ha.a;if(this.IIg){l=this.wAb.C0b(this.ra.Oa).yob;
if(l.hPa())return c;for(x=l.Yd;x<l.Jf;x++)b.add(x);ya.a.J(512499998,822,50,"Insert {0} columns",b.count)}else if(b=this.n_i(x),1!==b.count)return c;l=f.ef(0,b.ga(0));for(x=0;x<b.count;x++)Array.add(a,Pc.a.create(Object(va.a)(ag.a,l))),l=l.jZ()}else b&&(l=f.ef(0,l.li+l.colSpan-1)),Array.add(a,Pc.a.create(Object(va.a)(ag.a,l)));c.lC=a;c.jHb=Object(va.a)(ag.a,l);c.No=Object(va.a)(ag.a,f);c.Acb=a.length;if(this.Ga.Xu||!f.lp())c.response=32;return c}p_i(a){const b=new Ha.a,c=new ua.ScriptSharpLegacyMap;
let f=0;for(let F=0;F<a.length;++F)if(a[F].Kk){var l=Object(va.a)(5,a[F].node);if(l&&l.Sr()){f++;var x=l.pK();l=x.rowIndex;for(x=l+x.rowSpan;l<x;l++)if(c.Jb(l)){let R;c.$(R=l,c.ga(R)+1)}else c.add(l,1)}}for(let F of c.keys)c.ga(F)===f&&b.add(F);return b}n_i(a){const b=new Ha.a,c=new ua.ScriptSharpLegacyMap;let f=0;for(let F=0;F<a.length;++F)if(a[F].Kk){var l=Object(va.a)(5,a[F].node);if(l&&l.Sr()){f++;var x=l.pK();l=x.li;for(x=l+x.colSpan;l<x;l++)if(c.Jb(l)){let R;c.$(R=l,c.ga(R)+1)}else c.add(l,
1)}}for(let F of c.keys)c.ga(F)===f&&b.add(F);return b}U$i(a){return Nn.a(a)}W$i(a){const b=new Pt;b.response=8;if(!a)return b;if(a.nl){var c=a.AYa;a=a.Gha;if(!c||!a)return b;c=Object(va.a)(125,c.currentNode);a=Object(va.a)(125,a.currentNode);if(!c||!a)return b;var f=c.li;a=a.li;if(f>a){var l=f;f=a;a=l}}else{c=ld.a.Znb(a);c=Rg.ContextSetEditor.instance.jA(c);if(!c||1>c.length||!c[0].Kk)return b;c=Object(va.a)(5,c[0].node);if(!c||!c.Sr())return b;c=c.pK();a=f=c.li}l=this.sc.E0b(c);if(!l||14!==l.type||
0>f||0>a)return b;const x=[];let F=l.ef(0,f);if(!F)return b;for(;f<=a;)Array.add(x,Pc.a.create(Object(va.a)(ag.a,F))),F=F.jZ(),f++;b.lC=x;b.jHb=Object(va.a)(ag.a,c);b.No=Object(va.a)(ag.a,l);b.Acb=x.length;if(this.Ga.Xu||!l.lp())b.response=32;return b}$$i(a){const b=new Pt;b.response=8;if(!a)return b;if(a.nl){var c=a.AYa;a=a.Gha;if(!c||!a)return b;var f=ik.c(c);a=ik.c(a);c=Object(va.a)(Xl.TableCellNode,c.currentNode);if(f>a){var l=f;f=a;a=l}}else{a=ld.a.Znb(a);a=Rg.ContextSetEditor.instance.jA(a);
if(!a||1>a.length||!a[0].Kk)return b;a=Object(va.a)(5,a[0].node);if(!a||!a.Sr())return b;c=a.pK();a=f=c.rowIndex}if(!c)throw ya.a.J(512499997,822,10,"TypeCasting to ITableCellNode failed"),Error.argumentNull("TypeCasting to ITableCellNode failed");l=c.getContainingTable();if(!l||14!==l.type||0>f||0>a)return b;const x=[];let F=l.ef(f,0).YKc();for(;f<=a;)Array.add(x,Pc.a.create(Object(va.a)(ag.a,F))),F=F.pGa,f++;b.lC=x;b.jHb=Object(va.a)(ag.a,c);b.No=Object(va.a)(ag.a,l);b.Acb=x.length;if(this.Ga.Xu||
!xd.TableReader.ju(b.No))b.response=32;return b}Hij(a,b){if(a=Object(va.a)(Xl.TableCellNode,a.currentNode)){if(b)for(b=a.colSpan;0<b--;)a=a.jZ();else a=a.X5a();a&&(b=a.getContainingTable().firstRow,a=a.getContainingTable().ef(b.rowIndex,a.li),a=a.oy(),mb.GraphIterator.mb(Object(va.a)(ag.a,a)))}}i0d(a,b,c){const f=new Pt;f.response=8;if(!a||!c||!c.Oa)return f;const l=[],x=[];c=c.Oa;if(c.nl){if(c=this.wAb.C0b(c))if(a=c.yob,c=c.tableNode.firstRow,b)for(b=0;b<=a.gbe;b++){var F=c.rowIndex;F>=a.D3f&&F<=
a.gbe&&l.push(c);c=c.pGa}else for(b=c.v3f,c=0;c<=a.Zae;c++)F=b.li,F>=a.w3f&&F<=a.Zae&&x.push(b),b=b.jZ()}else for(a=Rg.ContextSetEditor.instance.jA(a),c=0;c<a.length;++c)if(a[c].Kk){F=Object(va.a)(5,a[c].node);if(!F||!F.Sr())return f;var R=F.pK();if(b)for(F=R.rowSpan,R=R.YKc();0<F--;)Array.contains(l,R)||l.push(R),R=R.pGa;else for(F=R.colSpan,R=R.Y7f();0<F--;)Array.contains(x,R)||x.push(R),R=R.jZ()}if(!l.length&&!x.length)return f;b=[];for(a=0;a<l.length;a++)Array.add(b,Pc.a.create(Object(va.a)(ag.a,
l[a])));for(a=0;a<x.length;a++)Array.add(b,Pc.a.create(Object(va.a)(ag.a,x[a])));f.lC=b;f.jHb=0<l.length?Object(va.a)(ag.a,l[0]):Object(va.a)(ag.a,x[0]);f.No=0<l.length?Object(va.a)(ag.a,l[0].getContainingTable()):Object(va.a)(ag.a,x[0].getContainingTable());if(this.Ga.Xu||!Object(va.a)(179,f.No).lp())f.response=32;return f}SBj(a){if(!a.lC)return!1;for(let c=0;c<a.lC.length;c++){var b=Object(va.a)(Pc.a,a.lC[c]);if(b&&(b=Object(va.a)(153,b.node))){b=this.sc.J6a(b);for(const f of b)if(f&&f.lub)return!0}}return!1}RBj(a){if(!a.lC)return!1;
var b=Object(va.a)(179,a.No);if(!b)return!1;var c=Object(va.a)(Pc.a,a.lC[0]);if(!c)return!1;c=Object(va.a)(125,c.node);if(!c)return!1;c=Object(va.a)(mb.GraphIterator,this.Mb.Kc(c));c.mc(14);b=this.sc.$j(b);a=a.lC.length;const f=new mb.GraphIterator;f.Nc(c);for(let l=0;l<b;l++){for(let x=0;x<a;x++){const F=Object(va.a)(125,c.currentNode);if(F&&F.lub)return!0;c.uf(1)}Dd.moveToNextRow(f);c.Nc(f)}return!1}Lsb(a){let b=null;a&&14===a.type&&(b=this.sc.o1d(a.firstRow));return b}tOe(a,b,c,f,l){var x=ju.MCa(a);
a=ju.MCa(a,!0);if(x||a)x=this.LDa.qn(c.Vb-c.Zb),c=this.LDa.qn(c.Ub-c.fc),f._x+=this.LDa.qn(l.right),f._y+=this.LDa.qn(l.bottom),b.setPosition(f.x-x,f.y-c,!0)}pbj(){var a=null;const b=this.ta.Ba;var c=this.ra.ny();if(ee.a("FixColorPickerSelectedColor")){if(!c||!c.length){if(c=this.ra.Po())a=c.ef(0,0),a=Cf.Box4ColorHelper.BBa(a.cellShading.solidFillField,b.Se);return a}(c=c[0])&&(a=c.cellShading&&c.cellShading.solidFillField?Cf.Box4ColorHelper.BBa(c.cellShading.solidFillField,b.Se):this.Qz.GKc(Object(va.a)(ag.a,
c)))}return a}static fNi(a,b,c,f,l,x){const F=Mc.a.hm("HandleSelectTableBorderType");F.Wa("CommandId",a.toString());F.Wa("BorderType",b);F.Wa("BorderWidth",c);F.Wa("BorderColor",f);F.Wa("CommandLocation",l);try{return x()}finally{F.finish(!0)}}static MCa(a,b=!1){return a.equals(Kd.a.qu)?!0:b?a.equals(Kd.a.north)||a.equals(Kd.a.ND):a.equals(Kd.a.west)||a.equals(Kd.a.fH)}}Object(e.a)(ju,"TableActor",null,[244]);class Gv{constructor(){this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=
0}}Object(e.a)(Gv,"TableCellMargin",null,[]);class Hv{constructor(a,b,c,f,l,x,F,R){this.YFa=null;this.z_c=0;this.NBl=je.a.Y9c(2);this.DUf=Object.assign(new Gv,{marginTop:.05,marginBottom:.05,marginLeft:.1,marginRight:.1});this.CUf=Object.assign(new Gv,{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0});this.BUf=Object.assign(new Gv,{marginTop:.05,marginBottom:.05,marginLeft:.05,marginRight:.05});this.NUf=Object.assign(new Gv,{marginTop:.15,marginBottom:.15,marginLeft:.15,marginRight:.15});this.Uzh=
Object.assign(new Gv,{marginTop:-1,marginBottom:-1,marginLeft:-1,marginRight:-1});if(a)if(b)if(c)if(f)if(l)if(x){if(!F)throw ya.a.J(512499990,822,50,"Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null");if(!R)throw ya.a.J(512499989,822,50,"Table Cell Margin Actor constructor argument:pageView cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:pageView cannot be null");
}else throw ya.a.J(512499991,822,50,"Table Cell Margin Actor constructor argument:tableReader cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:tableReader cannot be null");else throw ya.a.J(512499992,822,50,"Table Cell Margin Actor constructor argument:selectionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:selectionManager cannot be null");else throw ya.a.J(512499993,822,50,"Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null");else throw ya.a.J(512499994,822,50,"Table Cell Margin Actor constructor argument:transactionFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:transactionFactory cannot be null");else throw ya.a.J(512499995,822,50,"Table Cell Margin Actor constructor argument:applicationSettings cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:applicationSettings cannot be null");
else throw ya.a.J(512499996,822,50,"Table Cell Margin Actor constructor argument:actionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:actionManager cannot be null");this.ia=a;this.Ga=b;this.Db=c;this.ta=f;this.ra=l;this.sc=x;this.p_j=F.HOd(50,Object(D.a)(this,this.W2a,"applyPendingChangesToServerIfRequired"));this.Qb=R}ub(){this.ia.pa(ba.a.Luh,Fb.a.view,Object(D.a)(this,this.s1b,"handleTableCellMargins"),4);this.ia.pa(ba.a.Uid,Fb.a.tableCell,Object(D.a)(this,
this.s1b,"handleTableCellMargins"),4);this.ia.pa(ba.a.zBe,fc.a.application,Object(D.a)(this,this.zOc,"handleQueryTableCellDefaultMargins"),96);this.ia.pa(ba.a.Tid,Fb.a.tableCell,Object(D.a)(this,this.s1b,"handleTableCellMargins"),4);this.ia.pa(ba.a.yBe,fc.a.application,Object(D.a)(this,this.zOc,"handleQueryTableCellDefaultMargins"),96);this.ia.pa(ba.a.Rid,Fb.a.tableCell,Object(D.a)(this,this.s1b,"handleTableCellMargins"),4);this.ia.pa(ba.a.xBe,fc.a.application,Object(D.a)(this,this.zOc,"handleQueryTableCellDefaultMargins"),
96);this.ia.pa(ba.a.Wid,Fb.a.tableCell,Object(D.a)(this,this.s1b,"handleTableCellMargins"),4);this.ia.pa(ba.a.ABe,fc.a.application,Object(D.a)(this,this.zOc,"handleQueryTableCellDefaultMargins"),96);this.ia.xa(ba.a.Uid,Fb.a.view,xc.Wha);this.ia.xa(ba.a.Tid,Fb.a.view,xc.Wha);this.ia.xa(ba.a.Rid,Fb.a.view,xc.Wha);this.ia.xa(ba.a.Wid,Fb.a.view,xc.Wha);this.ia.pa(ba.a.xlc,Fb.a.view,Object(D.a)(this,this.GOc,"handleTableCellCustomMargins"),4);this.ia.pa(ba.a.Wgc,Fb.a.view,Object(D.a)(this,this.yOc,"handleQueryTableCellCustomMargins"),
96);this.ia.pa(ba.a.ylc,Fb.a.view,Object(D.a)(this,this.GOc,"handleTableCellCustomMargins"),4);this.ia.pa(ba.a.Xgc,Fb.a.view,Object(D.a)(this,this.yOc,"handleQueryTableCellCustomMargins"),96);this.ia.pa(ba.a.zlc,Fb.a.view,Object(D.a)(this,this.GOc,"handleTableCellCustomMargins"),4);this.ia.pa(ba.a.Ygc,Fb.a.view,Object(D.a)(this,this.yOc,"handleQueryTableCellCustomMargins"),96);this.ia.pa(ba.a.wlc,Fb.a.view,Object(D.a)(this,this.GOc,"handleTableCellCustomMargins"),4);this.ia.pa(ba.a.Vgc,Fb.a.view,
Object(D.a)(this,this.yOc,"handleQueryTableCellCustomMargins"),96)}we(){}s1b(a,b,c,f,l){return this.koh(a)?1===c?32:sg.a("HandleTableCellMargins:Entry point:"+this.ia.gq,a,()=>{if(!l)return ya.a.J(512499987,822,50,"HandleTableCellMargins: actionData cannot be null"),16;if(!b||!b.node)return ya.a.J(512499986,822,50,"HandleTableCellMargins: Either node context is null or unable to extract Table cell node from context"),16;const x=b.node,F=this.ZNi(a);if(!F)return ya.a.J(512499985,822,50,"HandleTableCellMargins: unable to get Table cell margins"),
16;const R=this.Db.je(15);R.jc(x);R.$c=a;this.xFf(x,F);R.dispose();ya.a.J(512499984,822,50,"HandleTableCellMargins: EntryPoint={1} ActionId={2}",this.ia.gq,a);return 32}):(ya.a.J(512499988,822,50,"HandleTableCellMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}zOc(a,b,c,f,l){if(!this.Ga.bIb)return 8;b=Object(va.a)(Ph.a,l);if(!b)return 16;f=this.ra.Po();if(!f)return ya.a.J(512499983,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid tableNode"),16;c=this.ra.ny();if(!c)return 16;
c.length||(c=this.sc.UE(f));if(!c||!c.length)return ya.a.J(512499982,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid cellNodes"),16;f=!1;switch(a){case ba.a.zBe:f=this.UKc(c,this.DUf);break;case ba.a.yBe:f=this.UKc(c,this.CUf);break;case ba.a.xBe:f=this.UKc(c,this.BUf);break;case ba.a.ABe:f=this.UKc(c,this.NUf)}b.Kf(f);return 32}UKc(a,b){for(const c of a)if(c&&!c.isGhostCell&&(je.a.mv(c.marginTop)!==b.marginTop||je.a.mv(c.marginBottom)!==b.marginBottom||je.a.mv(c.marginLeft)!==b.marginLeft||
je.a.mv(c.marginRight)!==b.marginRight))return!1;return!0}ZNi(a){let b=Ri.b(this.Uzh);switch(a){case ba.a.Uid:b=this.DUf;break;case ba.a.Tid:b=this.CUf;break;case ba.a.Rid:b=this.BUf;break;case ba.a.Wid:b=this.NUf}return b}xFf(a,b){0<=b.marginLeft&&(a.marginLeft=je.a.DV(b.marginLeft));0<=b.marginRight&&(a.marginRight=je.a.DV(b.marginRight));0<=b.marginTop&&(a.marginTop=je.a.DV(b.marginTop));0<=b.marginBottom&&(a.marginBottom=je.a.DV(b.marginBottom))}$6h(a,b){b=Math.max(je.a.DV(this.NBl+b.marginLeft+
b.marginRight),a);Md.a.ty(b,a)||(a={},a.Number=je.a.mv(b),this.ia.Ka(ba.a.$Xa,2,a))}koh(a){if(!this.ta.Ba)return!1;const b=this.ra.jq();return!!b&&b.nd&&(this.Ga.bIb&&Array.contains(Hv.rWk,a)||this.Ga.Sgb&&Array.contains(Hv.CWk,a))}yOc(a,b,c,f,l){if(!this.Ga.Sgb)return 8;b=this.ra.Po();if(!b)return ya.a.J(512499981,822,50,"HandleQueryTableCellCustomMargins: unable to get valid tableNode"),16;c=this.ra.ny();if(!c)return ya.a.J(512499980,822,50,"HandleQueryTableCellCustomMargins: unable to get selected table cells"),
16;c.length||(c=this.sc.UE(b));if(!c||!c.length)return ya.a.J(512499979,822,50,"HandleQueryTableCellCustomMargins: unable to get valid cellNodes"),16;b=this.zbj(c,a);this.zjc(l,je.a.mv(b));ya.a.J(512499978,822,50,"HandleQueryTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.gq,a);return 32}zbj(a,b){let c=-1,f=-1;for(const l of a)if(l&&!l.isGhostCell){switch(b){case ba.a.Wgc:c=l.marginLeft;break;case ba.a.Xgc:c=l.marginRight;break;case ba.a.Ygc:c=l.marginTop;break;case ba.a.Vgc:c=l.marginBottom}if(0<=
f&&f!==c)return-1;f=c}return c}zjc(a,b){a=a.queryResult;null!==a&&(a.Fea=parseFloat(b.toFixed(2)).toString())}GOc(a,b,c,f,l){return this.koh(a)?1===c?32:sg.a("HandleTableCellCustomMargins:Entry point:"+this.ia.gq,a,()=>{if(!l)return ya.a.J(512499976,822,50,"HandleTableCellCustomMargins: actionData cannot be null"),16;const x=this.ra.Po();if(!x)return ya.a.J(512499975,822,50,"HandleTableCellCustomMargins: unable to get valid tableNode"),16;let F=this.ra.ny();if(!F)return ya.a.J(512499974,822,50,"HandleTableCellCustomMargins: unable to get selected table cells"),
16;F.length||(F=this.sc.UE(x));this.Oik(a,F,l);ya.a.J(512499973,822,50,"HandleTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.gq,a);return 32}):(ya.a.J(512499977,822,50,"HandleTableCellCustomMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}Oik(a,b,c){this.z_c!==a&&(this.W2a(),this.z_c=a);this.YFa||(this.YFa=[]);sg.a("OnCustomMarginChange:Entry point:"+this.ia.gq,a,()=>{for(let l=0;l<b.length;l++){var f=b[l];if(!f||!f||f.isGhostCell)continue;const x=Object(va.a)(Ss,f.oc(this.Qb.Ma));
if(x){this.YFa[l]||(this.YFa[l]=new Vw.a(f,this.Dej(f)));f=this.YFa[l];switch(a){case ba.a.xlc:f.second.marginLeft=c.Number;break;case ba.a.ylc:f.second.marginRight=c.Number;break;case ba.a.zlc:f.second.marginTop=c.Number;break;case ba.a.wlc:f.second.marginBottom=c.Number}x.T0k(f.second,a)}}return 32});this.p_j.perform()}W2a(){this.Ga.Sgb&&this.YFa&&this.YFa.length&&(sg.a("ApplyPendingChangesToServerIfRequired:Entry point:"+this.ia.gq,this.z_c,()=>{const a=this.Db.je(15);try{a.$c=this.z_c;let b=null;
for(const c of this.YFa)b||(b=c.first.getContainingTable(),a.jc(b)),this.xFf(c.first,c.second),this.$6h(c.first.width,c.second);a.dispose()}finally{a&&a.dispose()}return 32}),this.YFa=null)}Dej(a){const b=Ri.b(this.Uzh);b.marginLeft=je.a.mv(a.marginLeft);b.marginRight=je.a.mv(a.marginRight);b.marginTop=je.a.mv(a.marginTop);b.marginBottom=je.a.mv(a.marginBottom);return b}}Hv.rWk=[ba.a.Luh,ba.a.Uid,ba.a.Tid,ba.a.Rid,ba.a.Wid];Hv.CWk=[ba.a.xlc,ba.a.ylc,ba.a.zlc,ba.a.wlc];Object(e.a)(Hv,"TableCellMarginActor",
null,[244]);class Gq{constructor(a,b,c,f,l,x,F,R){this.gm=this.Kac=null;this.KPg=0;this.cZc=!1;this.Ule=this.Spe=this.dQg=this.PCg=this.cQg=this.OCg=null;this.Qz=a;this.Dk=b;this.hje=c;this.oda=f;this.Zpe=l;this.i9j=x;this.d9j=F;this.gUa=R}bkl(a,b){const c=new Sys.StringBuilder('<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;">');this.M5d(a,b);try{c.append(String.format('<table class="TableStylePreview" style="background:{0}">',
this.Dk.Hnb(this.Dk.FYd(this.Kac),this.gm)));for(a=0;5>a;a++){c.append("<tr>");for(b=0;5>b;b++){const f=this.Spe.uXd(a,b,1,1),l=this.D9f(this.Ule,this.gm,a,b),x=this.Dk.Hnb(f.Sa(ub.a.cellShading)?f.Sh(ub.a.cellShading):xl.a.Opb,this.gm),F=new Sys.StringBuilder;for(let R=0;R<Gq.C6b.length;R++){const fa=Xp.jQa(Gq.AWc[R]),wa=f.sa(fa.k3a,xl.a.OFc),Xa=f.sa(fa.Pnb,xl.a.Mpb);F.append(Gq.C6b[R]);if(wa.zC===Eb.a.auto){const lb=this.Dk.pXd(.0277777777777778);F.append(String.format("inset {0}px transparent",
lb))}else F.append(this.Dk.DWd(Xa,.0277777777777778,wa));F.append(";")}c.append(String.format('<td style="color: {0}; background-color: {1}; {2}">',l,x,F));c.append("<div>&#x2014;</div>");c.append("</td>")}c.append("</tr>")}c.append("</table></div>")}finally{this.cZc&&this.Vfh()}return c.toString()}bZi(a,b){const c=[];this.M5d(a,b);try{for(a=0;5>a;a++)for(b=0;5>b;b++){const f={},l=this.Spe.uXd(a,b,1,1),x=this.D9f(this.Ule,this.gm,a,b);f.color=x;const F=this.Dk.Hnb(l.Sa(ub.a.cellShading)?l.Sh(ub.a.cellShading):
xl.a.Opb,this.gm);f["background-color"]=F;f.overflow="visible";for(let R=0;R<Gq.C6b.length;R++){let fa=null,wa=null,Xa=null;({nNa:fa,k3a:wa,Pnb:Xa}=Xp.jQa(Gq.AWc[R]));let lb;if(this.gUa){const Jc=Cf.Box4ColorHelper.s0({Color:"##T,0,0,0"}),Dc=om.a.Bi(l,wa,Jc),Wd=Cf.Box4ColorHelper.Cwa(Dc),xe=Cf.Box4ColorHelper.CL(Wd,this.gm);lb=xe?Cf.Box4ColorHelper.$ma(xe):null}else lb=l.sa(wa,xl.a.OFc);const Lb=l.sa(Xa,xl.a.Mpb),kc=Gq.C6b[R].substring(0,Gq.C6b[R].length-1),lc=l.sa(fa,xl.a.Npb),Ec=this.gUa&&ee.a("TableBordersLocalRenderingFix");
if(Ec&&!lc||!Ec&&lb.zC===Eb.a.auto){const Jc=this.Dk.pXd(.0277777777777778);f[kc]=String.format("inset {0}px transparent",Jc)}else f[kc]=this.Dk.DWd(Lb,.0277777777777778,lb)}c.push(f)}}finally{this.cZc&&this.Vfh()}return c}yNc(a,b){this.M5d(a,b);a={};a.background=this.Dk.Hnb(this.Dk.FYd(this.Kac),this.gm);return a}M5d(a,b){this.Kac=this.oda.x0b(a).uua;this.KPg=this.Qz.TZd(b);this.gm=this.hje.xdg(b).Se;this.cZc=this.prj(this.Kac);this.OCg=this.gm.PresetSchemeColorMapping.Background1;this.cQg=this.gm.PresetSchemeColorMapping.Text1;
this.PCg=this.gm.PresetSchemeColorMapping.Background2;this.dQg=this.gm.PresetSchemeColorMapping.Text2;this.cZc&&(this.gm.PresetSchemeColorMapping.Background1=this.gm.PresetSchemeColorMapping.Light1,this.gm.PresetSchemeColorMapping.Text1=this.gm.PresetSchemeColorMapping.Dark1,this.gm.PresetSchemeColorMapping.Background2=this.gm.PresetSchemeColorMapping.Light2,this.gm.PresetSchemeColorMapping.Text2=this.gm.PresetSchemeColorMapping.Dark2);a=this.Zpe(()=>5,()=>5,()=>this.KPg,()=>null,()=>this.gm,()=>
this.Kac);this.Spe=this.i9j(a);this.Ule=this.d9j(a)}Vfh(){this.gm.PresetSchemeColorMapping.Background1=this.OCg;this.gm.PresetSchemeColorMapping.Text1=this.cQg;this.gm.PresetSchemeColorMapping.Background2=this.PCg;this.gm.PresetSchemeColorMapping.Text2=this.dQg}prj(a){if(a.tblBgField&&a.tblBgField.fillField)return!1;if(!a.wholeTblField||!a.wholeTblField.tcStyleField)return!0;a=a.wholeTblField.tcStyleField.fillField;return!a||a.noFillField?!0:!1}D9f(a,b,c,f){let l="black";a&&(l=a.y8f(b,c,f,1,1).jU());
return l}}Gq.C6b=["border-top:","border-left:","border-bottom:","border-right:"];Gq.AWc=[7,5,0,6];Object(e.a)(Gq,"TableStylePreviewGenerator",null,[289]);class FE extends Vx{constructor(){super()}get Type(){return 6}}Object(e.a)(FE,"TableStyleGalleryButtonProps",Vx,[]);class GE{}GE.mfk=2147483647;Object(e.a)(GE,"TableStyleUtil",null,[]);class ep{constructor(a,b,c,f,l){this.jMd="Clear";this.h5a=null;this.cmb=a;this.w3e=c;this.x3e=f;this.eMh=l;this.UCd=b;this.$M=u.AFrameworkApplication.$M;this.Vl=u.AFrameworkApplication.Vl}vYb(){}w_h(a,
b){this.vYb();const c=this.VWd(),f=c.length;if(!(0>=f)){var l=GE.mfk,x=null;for(let wa=0;wa<f;wa++){var F=c[wa],R=this.eMh(F);l!==R&&(l=Object.assign(new Si.a,{Id:"msMoreTableStyles"+R,Title:this.Pej(R),ControlList:[]}),x=Object.assign(new uq.a,{Type:6,Id:"galleryMoreTableStyles"+R,ExternalGalleryId:"TableStylesGallery",Width:ep.Eth,ElementDimensions:"Size64by48",GalleryItems:[]}),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp&&this.h5a&&(x.ExternalId=this.h5a[R.toString()]),Array.add(l.ControlList,
x),Array.add(b.MenuSectionList,l),l=R);var fa=this.x3e(F);F=ep.EOe+wa;R=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp;fa=Object.assign(new FE,{Id:F,ExternalId:F,Command:"4171428777",QueryCommand:"2135594455",LabelText:fa?Ma.a.ie(fa):"",Alt:R?fa:null,VerticalCenterAlign:"true"});R&&(fa.TableCellStyles=this.meg(F,a),fa.TableStyles=this.yNc(F,a));x&&x.GalleryItems.push(fa)}}}u_h(a){const b=Object.assign(new Si.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),c=Object.assign(new Of.a,{Id:"fseaClearTableFormatting",Command:"3835123874",LabelText:Ma.a.ie(this.jMd),Alt:Ma.a.ie(this.jMd),Image16by16:this.Vl,Image16by16Class:kq.getImageClassWithCluster(this.$M,ep.dni),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});Array.add(b.ControlList,c);Array.add(a.MenuSectionList,b)}gxi(a,b){this.vYb();const c=a[ai.a.SourceControlId],f=this.djd(c,b);if(f){var l=this.cmb.Y0d(b);l=l?this.w3e(l):null;var x=this.x3e(f),F=this.w3e(f);a[fm.a.Alt]=x;a[fm.a.On]=
F===l;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp?(b=Object.assign(new FE,{Id:c,ExternalId:c,Command:"4171428777",QueryCommand:"2135594455",TableCellStyles:this.meg(c,b),TableStyles:this.yNc(c,b),Alt:x}),a[fm.a.GalleryButtonProps]=b):(b=this.UCd.bkl(f,b),a[fm.a.InnerHTML]=b)}else a[fm.a.InnerHTML]=null,a[fm.a.Alt]=null,a[fm.a.On]=!1,a[fm.a.GalleryButtonProps]=null}meg(a,b){this.vYb();return(a=this.djd(a,b))?this.UCd.bZi(a,b):null}yNc(a,b){this.vYb();return(a=this.djd(a,b))?this.UCd.yNc(a,
b):null}nyi(a,b){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.Mp?a.MenuItems=this.Gag(b):a.PopulationXML=ej.l(this.Gag(b))}Gag(a){const b=Object.assign(new sk.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.w_h(a,b);this.u_h(b);return b}djd(a,b){return a?a.startsWith(ep.EOe)?this.aej(parseInt(a.substr(ep.EOe.length))):this.dUk(parseInt(a.substr(ep.$jl.length)),b):null}}ep.EOe="buttonTableStyleMenu";ep.$jl="buttonTableStyleRibbon";ep.Eth=7;ep.dni="ClearTableStyle_16x16x32";Object(e.a)(ep,
"ATableStyleRibbonControl",null,[290]);class BN extends ep{constructor(a,b,c,f,l){super(a,l,Object(D.a)(f,f.Zdj,"getStyleIdFromStyleContainer"),Object(D.a)(f,f.$dj,"getStyleNameFromStyleContainer"),Object(D.a)(f,f.Tdj,"getStyleCatogeryFromStyleContainer"));this.Qz=a;this.oda=f;this.jMd=ResourceStrings.L_ClearTableStyle;this.$M=qf.a.Aec;this.Vl=c.Yj(qf.a.D9c);this.ewk()}Pej(a){switch(a){case 1:return ResourceStrings.L_Themed;case 2:return ResourceStrings.L_Light;case 3:return ResourceStrings.L_Medium;
case 4:return ResourceStrings.L_Dark;case 5:return ResourceStrings.L_Customize;default:return ResourceStrings.L_Customize}}dUk(a,b){let c=null;(b=this.Qz.F0b(b))&&(c=this.oda.peg(b.styleIdField));return c?this.oda.Qdj(c.ADg,c.MHg-c.MHg%ep.Eth+a):this.oda.Jsb(a)}VWd(){return this.oda.VWd()}aej(a){return this.oda.Jsb(a)}vYb(){this.oda.YZf()}ewk(){this.h5a={};this.h5a["1"]="TableStylesBestMatch";this.h5a["2"]="TableStylesLight";this.h5a["3"]="TableStylesMedium";this.h5a["4"]="TableStylesDark"}}Object(e.a)(BN,
"TableStyleRibbonControls",ep,[]);class CN{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc){this.uD=this.jVa=null;this.ia=a;this.Af=b;this.Ga=c;this.Fa=f;this.ra=l;this.hv=x;this.Xd=F;this.u6b=R;this.Qb=fa;this.Ea=wa;this.gf=Xa;this.$ca=Lb;this.sc=kc;this.mda=lc;this.vVa=Jc;this.Iz=lb;Ec.execute(Wd=>{this.jVa=Wd});this.Ga.eP&&Dc.execute(Wd=>{this.uD=Wd})}get qe(){return this.Xd.instance}get GE(){return this.u6b.value}ub(){this.ia.pa(ba.a.yHf,fc.a.application,Object(D.a)(this,this.Kjj,"handleBeginEditShapeTextByF2"),
4);this.ia.pa(ba.a.MTb,fc.a.application,Object(D.a)(this,this.Jjj,"handleBeginEditShapeText"),4);this.ia.pa(ba.a.kNa,Fb.a.view,Object(D.a)(this,this.Ljj,"handleBeginEditShapeTextForShapeMoniker"),5)}we(){const a=this.Fa.Bc(Nc.a.yg),b=this.Fa.Bc(xi.a.B1);a.bindAction(A.KeyInputManager.Na(w.a.koc,0),ba.a.yHf);a.bindAction(A.KeyInputManager.Na(w.a.aq,0),ba.a.MTb);b.bindAction(A.KeyInputManager.Na(w.a.koc,0),ba.a.kbi)}Jjj(a,b,c){if(this.mda&&this.mda.isVisible())return ya.a.J(40735957,820,50,"The slideless pane is shown, hide and replace it with new slide on default master by VK_Enter."),
this.mda.hide(2,!0),32;if(1===c&&this.ra.vRa())return 2;a=this.ra.jq();if(!a)return 16;b=Object(va.a)(4,a.m3i(ee.a("EnableRetrieveFirstIcon")));if(a.get_smartArtModelId())a=this.Ea.er(a);else{if(a.Qf&&b)return this.ia.Ka(ba.a.rYa,c,b);if(a.Mf){var f=this.Ea.py(a);if(0<f.length)return this.ia.Ka(ba.a.rYa,c,f[0])}else if(this.Ga.eP&&1===a.mediaType&&!a.mh&&this.uD)return(f=this.uD.nK(a))&&f.setFocusOnPlayer(),32}return this.ia.Ka(ba.a.kNa,c,new zn.a(a,!1))}Kjj(a,b,c){a=this.ra.jq();if(!a)return 16;
a.get_smartArtModelId()&&(a=this.Ea.er(a));return this.ia.Ka(ba.a.kNa,c,new zn.a(a,!1))}Ljj(a,b,c,f,l){if(!l||!Object(Fa.a)(zn.a,l))return ya.a.J(8956046,820,10,"Invalid ActionData"),8;a=l.shapeNode;if(!a||!(a.isEditable&&!a.Bda||a.Nq)||this.Af.Zc(a))return 16;if(1===c)return 32;a.nd&&(c=this.sc.XM(a),c=!!c&&c.lp(),ya.a.J(41007122,820,50,"Entering table edit mode, isComplexTable:{0}",c),this.ia.processAction(ba.a.T3a,2));if(a.Nq){if(this.GE&&this.qe)return l=this.GE.N1(a),this.qe.notifyAgave(l.id,
11),32;ya.a.J(18989144,820,10,"AppForOffice package should have already been loaded.");return 8}c=a.Ag(this.Qb.Ma);if(!c)return 16;this.jVa&&this.jVa.CUd(a,!0);this.vVa&&this.Ga.t_k&&this.vVa.ping();Mc.a.Cb&&(Mc.a.Cb.actionName="BeginEditShapeText",(a.Mf||a.mh)&&Qn(a));if(this.Iz&&a.Qf&&c.uK())Mc.a.hk(ri.a.Myc,"false"),this.gf.i$g(new Bx.a(a));else{this.Fa.Bf(Nc.a.yg,l.Y8k);this.hv.Pv();c.eMe();if(a.nd&&l.cDc&&(c=this.sc.XM(a))&&c.lp())return(a=this.$ca.gVd(l.cDc.clientPoint,c,null,null))?(c=a.oc(this.Qb.Ma),
this.Qb.m5(l.cDc.clientPoint,c,a,this.Qb,!1,!1,0),32):8;a.mh&&(c=this.Ea.Pr(a))&&(c=c.Ag(this.Qb.Ma))&&c.Ld&&c.Ld.$Fb(!0);this.Qb.aZk(a,l.cDc)}return 32}}Object(e.a)(CN,"TextEditorLaunchingActor",null,[244]);class HE{constructor(a,b,c,f,l,x,F,R){this.ia=a;this.Fa=b;this.Ea=c;this.gv=f;this.Af=l;this.ra=x;this.RTa=F;this.Vh=R}ub(){this.ia.xa(ba.a.Iji,fc.a.application,Object(D.a)(this,this.Wjj,"handleChangeCaseMenu"));this.ia.xa(ba.a.Oye,fc.a.application,Object(D.a)(this,this.snj,"handlePowerPointInsertHyperlink"));
this.ia.pa(ba.a.clearFormatting,fc.a.application,Object(D.a)(this,this.gkj,"handleClearFormatting"),4)}we(){this.Fa.Bc(Nc.a.sP).bindAction(A.KeyInputManager.Na(w.a.xO,2),ba.a.clearFormatting)}Wjj(){var a=this.ra.Oa.kb;return a&&(a=a.Ua)&&(a.contextId===Fb.a.Lf||a.contextId===Fb.a.textRange)?32:this.vDh(!0)?32:8}snj(a,b,c,f,l){return(a=this.ra.Oa.kb)&&this.ra.nGj()?8:!a||this.ra.gSa()&&!HE.J4b(a)?8:this.ia.Ka(ba.a.insertHyperlink,c,l)}gkj(a,b,c){if(!this.vDh(!1))return 16;a=this.ra.Oa.kb;if(!a)return 8;
2===c&&this.Wza(a);return 32}Wza(a){ya.a.J(593892321,820,50,"TextOperationsActor: Clear Formatting Triggered");var b=this.ra.ae();let c;if((c=this.zcj(b))&&c.length){if(1===c.length){b=a.Ua;if(!b){ya.a.J(594614167,820,50,"TextOperationsActor: ClearCharacterFormatting - Could not create GraphNodeContext");return}if(b.contextId===Fb.a.Lf){this.Q8h(b,c[0]);return}if(b.contextId===Fb.a.textRange||b.contextId===Fb.a.paragraph){this.S8h(a,c);return}}this.R8h(c)}else b.length?this.bEc(b)?ya.a.J(593892317,
820,50,"ClearFormatting on table(s)"):ya.a.J(593892315,820,50,"ClearFormatting attempted on non table and non text formattable shape"):ya.a.J(593892319,820,50,"ClearFormatting triggered when nothing selected")}zcj(a){a=this.Ea.mZ(a,!1);const b=[];let c=!0;for(const f of a)f.Mf&&(c=!1,1!==a.length&&this.O7k(f,a)?b.push.apply(b,this.Ybh(f,a,!1)):b.push.apply(b,this.Ybh(f,a,!0)));return c?a:b}O7k(a,b){for(const c of b)if(c&&!c.Mf&&(b=c.Pr(),!b||a!==b))return!1;return!0}Ybh(a,b,c=!1){const f=[];for(const l of b)if(l!==
a)f.push(l);else if(c){const x=this.Ea.mZ(this.ra.gO(b),!1);f.push.apply(f,x)}return f}R8h(a){this.gv.c5a(b=>{this.RHe(b,0,this.rcj(b))},a)}S8h(a,b){const c=a.Ua,f=this.z$f(c,b[0]);if(c.contextId===Fb.a.paragraph||-1!==f){var l=this.qfj(a);this.gv.c5a(x=>{this.RHe(x,f,l)},b)}}Q8h(a,b){const c=this.RTa.h0b(a);if(c){var f=c.Ua,l=this.z$f(a,b)+f.Qa;this.gv.c5a(x=>{this.RHe(x,l,f.Kb-f.Qa)},[b])}}RHe(a,b,c){a.ke(ub.a.clearFormatting,!0);a.ke(ub.a.yPe,b);a.ke(ub.a.xPe,c)}z$f(a,b){let c=0,f=!1;if(!this.Vh.Wd(a.node))return-1;
const l=a.node;this.Ea.WI(b,x=>{x===l?f=!0:f||(c+=this.Vh.textLength(x)+1)});return f?a.contextId===Fb.a.paragraph||a.contextId===Fb.a.Lf?c:c+a.Qa:-1}qfj(a){let b=0;for(let c=0;c<a.length;c++){const f=a.ga(c);f.contextId===Fb.a.textRange?b+=f.Kb-f.Qa:f.contextId===Fb.a.paragraph?b+=this.Vh.textLength(f.node)+1:f.contextId===Fb.a.endOfParagraph&&b++}return b}rcj(a){let b=0;if(a.PB)return 1;this.Ea.WI(a,c=>{b+=this.Vh.textLength(c)+1});return b}bEc(a){for(const b of a)if(b.nd)return!0;return!1}vDh(a){const b=
this.ra.ae();if(!b||1>b.length)return!1;const c=this.ra.Po();if(c&&!a&&1===b.length)return!1;a=this.Ea.mZ(b);return 1>a.length&&!c||this.Af.NB(a)||this.Af.NB([c])?!1:!0}static J4b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua;a=a.ga(1);return!(!fb.SelectionEditor.Pj(b)||!fb.SelectionEditor.Cl(a)||b.node!==a.node)}return!1}}Object(e.a)(HE,"TextOperationsActor",null,[244]);class IE{PQd(a,b,c){return 1===c?32:IE.kEi(b.node)}static kEi(a){const b=new mb.GraphIterator;b.set(a);b.uv();if(ph.b(b))return 2;
a=new We.GraphTransaction(7);a.Tx(b);b.Ii();a.dispose();return 32}}Object(e.a)(IE,"DeleteOutlineLevelContentStrategy",null,[]);class ml{constructor(){this.YJh=new IE}ub(a){const b=Object(D.a)(this.ZFc,this.ZFc.QQd,"deleteView"),c=Object(D.a)(this,this.PQd,"deleteOutlineLevelContent"),f=Object(D.a)(this.jVf,this.jVf.lEi,"deleteParagraphContent");a.xa(C.a.backspace,Fb.a.Lf,f);a.xa(C.a.backspace,Fb.a.textRange,f);a.xa(C.a.backspace,Fb.a.endOfParagraph,ce.ActionManager.Mu);a.xa(C.a.backspace,Fb.a.outline,
c);a.xa(C.a.backspace,Fb.a.view,b);a.$d(C.a.backspace,1124);a.xa(C.a.GAa,Fb.a.Lf,ce.ActionManager.Mu);a.xa(C.a.GAa,Fb.a.textRange,f);a.xa(C.a.GAa,Fb.a.endOfParagraph,ce.ActionManager.Mu);a.xa(C.a.GAa,Fb.a.outline,c);a.xa(C.a.GAa,Fb.a.view,b);a.pa(C.a.Cpb,Fb.a.view,b,1124);a.xa(C.a.eK,Fb.a.Lf,f);a.xa(C.a.eK,Fb.a.textRange,f);a.xa(C.a.eK,Fb.a.endOfParagraph,ce.ActionManager.Mu);a.xa(C.a.eK,Fb.a.outline,c);a.xa(C.a.eK,Fb.a.view,b);a.$d(C.a.eK,1124);a.pa(C.a.OWb,Fb.a.view,b,1124);a.pa(C.a.FAa,Fb.a.view,
ml.FAa,1028);a.xa(C.a.tOa,Fb.a.view,Object(D.a)(this.ZFc,this.ZFc.tOa,"deleteFromInputEvent"));a.xa(C.a.tOa,Fb.a.textRange,f);a.$d(C.a.tOa,1028)}PQd(a,b,c,f,l){return this.YJh.PQd(a,b,c,f,l)}static get Hl(){return sy.PageNavigator.instance}static get Jh(){return ml.xi||(ml.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get SI(){return ml.AH||(ml.AH=hb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get jEi(){return ml.x_a||(ml.x_a=hb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"))}static get WA(){return ml.ox||
(ml.ox=hb.a.instance.resolve("Box4.IOutlineEditor"))}static get pe(){return ml.Xc||(ml.Xc=hb.a.instance.pb("Box4.IFeatureHelper"))}static FAa(a,b,c,f,l){f=b.view;if(!f.Eb||!f.Eb.Oa.kb||fb.SelectionEditor.Jw(f.Eb.Oa.kb))return 8;if(1===c)return 32;c=f.Eb.Oa;const x=c.kb;var F=x.Ua;let R=!1;var fa=null,wa=!1;if(c.xG)if(ph.a(F))R=!0;else{if(F.contextId===Fb.a.outline&&1===c.length){for(a=mb.GraphIterator.mb(F.node);a.Ji();)a.Ii();ml.WA.IY(a,!0);Yb.OutlineElementNavigator.oi(a);a=nd.SelectionFactory.Jg(a.currentNode,
0);f.Eb.setSelection(a);return 32}var Xa=F.node;fa=null;if(Rt.c(F)){var lb=Xa.oc(f.Ma);lb&&(lb=lb.yDl)&&0<=lb.width&&0<=lb.height&&(fa=new Qw.a(Fd.a.Ef(lb.x,0),Fd.a.Ef(lb.y,1)));fa||(fa=oq.b(Xa))}else fa=oq.b(F.node);F=mb.GraphIterator.mb(F.node);F.uv();ml.Hl.KHa(F);Xa=ml.SI.tWb(F);oq.c(Xa,fa.x,fa.y);ml.WA.IY(F,!0);fa=nd.SelectionFactory.nj(Xa,!0)}else if(1===c.length){wa=c.last;F=ld.a.YNa(wa);if(ml.pe&&ml.pe.isFeatureEnabled(33)&&Rg.ContextSetEditor.instance.kMe(F).returnValue)return 2;wa=wa.Te;
wa=!ph.a(wa)&&!c.nl&&(fb.SelectionEditor.Cl(wa)||Ya.ParagraphReader.Xl(wa)||fb.SelectionEditor.JV(wa))}wa&&(wa=fb.SelectionEditor.yl(x,!1,!1,void 0,ml.jEi.AKe(null,1)),f.Eb.setSelection(wa),u.AFrameworkApplication.Ta.ii(b,C.a.SA,2,!1,null,l),fa=f.Eb.Oa.kb,f.Eb.setSelection(x));l||(l=new E.DictionaryPropertySet);l.setValue(be.a.bqb,!0);u.AFrameworkApplication.Ta.ii(b,C.a.eK,2,!0,null,l);if(fa&&fa.Ua.isValid)return f.Eb.setSelection(fa),32;c.xG&&(R||ro.instance.$vb(a,b.MD,f));fb.SelectionEditor.Jw(f.Eb.Oa.kb)||
u.AFrameworkApplication.Ta.ii(b,C.a.SA,2,!1,null,l);return 32}}ml.AH=null;ml.xi=null;ml.x_a=null;ml.ox=null;ml.Xc=null;Object(e.a)(ml,"ADeleteActor",null,[]);class cl{get Wi(){return Qg.a.instance}lEi(a,b,c,f,l){if(1===c)return 32;f=a===C.a.backspace||a===C.a.tOa;if(cl.Mq()&&cl.Mq().instance&&cl.Mq().instance.LV(b))return 4;c=b.node;var x=b.Qa;b=b.Kb;const F=Ya.ParagraphReader.text(c),R=F.length;let fa=!1;if(x===b){if(f&&!x||!f&&x===R)return 2;f?(H.a.instance.ga(14)&&({cp:x,returnValue:fa}=this.Wi.Gdk(c,
x)),fa||(x--,Ma.a.Mw(F,x)&&x--),a=C.a.Oza):(H.a.instance.ga(14)&&({cp:b,returnValue:fa}=this.Wi.Fdk(c,b)),fa||(b++,Ma.a.Mw(F,b)&&b++),a=C.a.sOa)}x=x===b?Pc.a.Uj(c,x):Pc.a.createTextRange(c,x,b);f=new We.GraphTransaction(15);f.$c=a;f.fd(c);c=Object(Fa.a)(Ds,l)&&l.GZb;if(cl.Nf.Zf&&cl.Nf.jy&&!c){c=cl.Nf.Knb();try{let wa;if(({type:wa}=null.hfg()).returnValue){const Xa=Object(va.a)(10,l);if(Xa&&Xa.sa(Cs.a.isg,!1)||1===wa)cl.Nf.V3g=wa}l=0;for(let Xa=null.length-1;0<=Xa;--Xa){let lb;const Lb=({Mxg:lb}=null.getContext(Xa)).returnValue;
lb?(cl.hyperlinkEditor.KBb(Lb,null),l+=0,cl.k5.iOd=b+l):this.kVf(Lb)}}finally{c&&c.dispose()}}else this.kVf(x);f.dispose();return 32}static get Nf(){return cl.Wc||(cl.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get k5(){return cl.Lo||(cl.Lo=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Emc(){return cl.QC||(cl.QC=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return cl.Xm||
(cl.Xm=hb.a.instance.resolve("Box4.IHyperlinkEditor"))}static Mq(){return cl.nm||(cl.nm=hb.a.instance.La("Box4.IExternalSelectionManager"))}}cl.Wc=null;cl.Lo=null;cl.QC=null;cl.Xm=null;cl.nm=null;Object(e.a)(cl,"ADeleteParagraphContentStrategy",null,[]);class Iv extends cl{constructor(){super()}kVf(a){Iv.characterPropertiesEditor.replaceTextRange(a,"")}static get characterPropertiesEditor(){return Iv.fhh||(Iv.fhh=hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}Iv.fhh=null;Object(e.a)(Iv,
"DeleteParagraphContentStrategy",cl,[]);var WQ=d(464);class DN{constructor(a,b,c,f){this.WTe=a;this.bJ=c;this.ld=f;this.actionId=b}}Object(e.a)(DN,"DeleteActionData",null,[]);class Ze{get Dni(){return Ze.WXe||(Ze.WXe=hb.a.instance.resolve("Box4.Clipboard.IClipboardOperationCutStrategy"))}qnl(a){return!fb.SelectionEditor.Pj(a)}Kbj(a,b,c){if(!a)return null;if(!c)return a;b=fb.SelectionEditor.rPa(a,!1,!b,!0,!0,!0);return nd.SelectionFactory.PM(a,b.Ua,!1)}QQd(a,b,c,f,l){if(1===c)return 32;var x=!1;a===
C.a.OWb&&(a=C.a.eK,x=!0);a===C.a.Cpb&&(a=C.a.backspace,x=!0);a===C.a.GAa&&(b=new eC.a(Gb.App.Fb.Ed.en));var F=b;if(!F.view.Hh)return 2;var R=F.view.Eb;jf.GrippersManager.instance.setVisibility(!1);F=a===C.a.eK;R=0<R.Oa.length?R.Oa.ga(0):null;x=this.Kbj(R,F,x);return this.sVf(a,b,c,f,l,x,F)}sVf(a,b,c,f,l,x,F){const R=b.view,fa=R.Eb;var wa=l,Xa=l;a===C.a.GAa&&(Xa=wa=null,x=new $a.Selection(l,!0));if(!x)return 32;const lb=new DN(b,a,f,Xa),Lb=this.G8k(wa,F,fa);wa=!1;if(({BRa:wa}=this.Ioh(a,Lb,fa)).returnValue)return a=
wa?C.a.EAa:C.a.deleteRow,u.AFrameworkApplication.Ta.ii(b,a,c,!1,f,l);let kc;F?N.a.mark(kc=5009):N.a.mark(kc=5011);c=new We.GraphTransaction(15);c.$c=a;c.fd(R.rg);wa=null;let lc=({IXk:wa}=this.H_i(a,l,fa,x)).returnValue;Xa=null;({vhd:Xa}=Rg.ContextSetEditor.instance.kMe(lc)).returnValue&&(lc=Xa);if(!lc)return c.dispose(),32;this.Uwh(lc);const Ec=this.iXi(x,F);let Jc=null;F?Jc=new ar(x):Ec&&(Jc=new ar(Ec));Xa=!1;if(fb.SelectionEditor.Kg(lc)){if(a===C.a.tOa)return 2;const Dc=Gh.tMc(R.rg,Lb);Ze.WR.wF(()=>
{this.cEi(b,f,l,lc,F,Jc,x,Dc,fa,Lb,lb,Ec)},"DeleteViewStrategy:DeleteAtInsertionPointContext")}else Ze.Nf.Zf&&Ze.Nf.jy?(this.pnl(a,R.rg,lc,F,x,fa,Lb,lb,Jc),Xa=!0):Xa=this.e4g(a,R.rg,lc,fa,Lb,lb,Jc,wa);Ze.sSi(fa);this.yfh(lc);c.dispose();N.a.mark(kc+1);return a===C.a.GAa?Xa?32:8:32}tOa(a,b,c,f,l){return b.view.Hh?this.sVf(a,b,c,f,null,l,!1):2}e4g(a,b,c,f,l,x,F,R){b=Gh.tMc(b,l);this.qnl(c)&&b.ana(c);a=Ze.Tc.Bp(a);a.properties.$("CountOfParagraphsDeleted",Ze.p4.gOd(c).toString());c=Ze.GGi(Ze.K8k,Object(D.a)(this,
this.J8k,"shouldDispatchNoSpecialize"),c,f,l,b,x,F,R);a.end();return c}pnl(a,b,c,f,l,x,F,R,fa){var wa=0,Xa=null;const lb=Rg.ContextSetEditor.instance.jA(c),Lb=lb[lb.length-1];if(Lb.contextId===Fb.a.paragraph||Lb.contextId===Fb.a.endOfParagraph){var kc=mb.GraphIterator.mb(Lb.node);kc.Ze();Yb.OutlineElementNavigator.Je(kc);Yb.OutlineElementNavigator.OI(kc,!0,!1)&&(Xa=Yb.OutlineElementNavigator.oi(kc))&&(wa=Ze.p4.textLength(Xa))}else wa=Ze.p4.textLength(Lb.node)-Lb.Kb;if((kc=Object(va.a)(10,R.ld))&&
kc.sa(Cs.a.isg,!1))this.d4g(a,b,c,x,F,R,fa,!1);else{kc=Ze.Nf.Knb();try{this.d4g(a,b,c,x,F,R,fa,!0)}finally{kc&&kc.dispose()}}if(f){if(c.Hw){a=lb.length-1;do l=lb[a],a--;while(!l.node.isConnected&&0<=a)}else l=c;if(!Ze.p4.Wd(l.node))return;switch(Lb.contextId){case Fb.a.paragraph:case Fb.a.endOfParagraph:wa=Xa&&Xa.isConnected?0:wa;break;case Fb.a.Lf:case Fb.a.textRange:break;default:wa=0}wa=nd.SelectionFactory.Jg(l.node,Ze.p4.textLength(l.node)-wa);l.C2a===wa.Ua.Qa&&(wa.Ua.TR=l.TR)}else{wa=l.Ua.node;
if(!Ze.p4.Wd(wa))return;Xa=l.Ua.contextId===Fb.a.paragraph?0:l.Ua.contextId===Fb.a.endOfParagraph?Ze.p4.textLength(wa):l.Ua.Qa;wa=nd.SelectionFactory.Jg(wa,Xa)}ld.a.instance.setSelection(wa)}d4g(a,b,c,f,l,x,F,R){this.zVi(f,c);!({type:fa}=null.hfg()).returnValue||R&&1!==fa||(Ze.Nf.V3g=fa);for(c=null.length-1;0<=c;--c){var fa=({Mxg:R}=null.getContext(c)).returnValue;R?Ze.hyperlinkEditor.KBb(fa,2):this.e4g(a,b,fa,f,l,x,F,null)}}zVi(a,b){if(Object(Fa.a)(WQ.a,b))for(a=li.Xqa(a.Oa,!0),b=0;b<a.length&&a.getContext(b).contextId!==
Fb.a.table;b++);}H_i(a,b,c,f){a===C.a.GAa?(c=Ea.a.cOa(b),a=um.SelectionReferenceFactory.instance.dqa()):(a=null,c=1===c.Oa.length?ld.a.YNa(f):c.Dj);return{returnValue:c,IXk:a}}xii(a){return!a.Kk||a.contextId!==Fb.a.paragraph||!Ze.p4.Wd(a.node)||Ze.Nf.Zf&&Ze.Nf.jy||H.a.instance.ga(14)&&Ze.Wi.SSc(a)?!1:!0}Uwh(a){if(a.Hw)for(let b=0;b<a.length;b++)this.Uwh(a.getContext(b));else this.xii(a)&&(a.node.cCc=!0)}yfh(a){if(a.Hw)for(let b=0;b<a.length;b++)this.yfh(a.getContext(b));else a.Kk&&(a=a.node)&&Ze.p4.Wd(a)&&
(a.cCc=!1)}cEi(a,b,c,f,l,x,F,R,fa,wa,Xa,lb){const Lb=new mb.GraphIterator,kc=f.node;Lb.set(kc);Lb.Ze();fb.SelectionEditor.OB(Lb.currentNode,f,l)?this.gEi(a,b,c,f,l,x,F,R,fa,Xa,lb,Lb,kc):Ze.hEi(f,l,x,F,R,fa,wa,Xa)}sOc(a,b,c,f){return!a&&Ib.ListReader.ak(b)?(f=Ze.ema(b,c),{returnValue:!0,response:f}):{returnValue:!1,response:f}}Hlj(a,b,c,f,l,x){return H.a.instance.ga(65)&&!a&&0<Rd.OutlineElementReader.Xrb(b)?(x=u.AFrameworkApplication.Ta.ii(c,C.a.Tbh,2,!1,f,l),{returnValue:!0,response:x}):{returnValue:!1,
response:x}}Upj(a,b,c,f,l,x){return H.a.instance.ga(54)&&!a&&0<Rd.OutlineElementReader.k6a(b)?(x=u.AFrameworkApplication.Ta.ii(c,C.a.GNk,2,!1,f,l),{returnValue:!0,response:x}):{returnValue:!1,response:x}}znj(a,b,c,f,l,x){return H.a.instance.ga(80)&&!a&&Ze.Tu.tob(b)?(x=u.AFrameworkApplication.Ta.ii(c,C.a.Ry,2,!1,f,l),{returnValue:!0,response:x}):{returnValue:!1,response:x}}jjj(a,b,c,f,l,x,F,R,fa,wa,Xa){const lb=new En.a;lb.Nc(b);if(Yb.OutlineElementNavigator.mGa(lb,!1,!a,!1)){Xa=!0;wa=32;const Lb=
new mb.GraphIterator;Lb.Nc(lb);Yb.OutlineElementNavigator.oi(lb);x&&f&&fb.SelectionEditor.JV(f.Ua)?(c.ana(l),Ze.Jh.nNk(b.currentNode)):lb.currentNode.IV?(H.a.instance.ga(68)&&c.ana(l),Yb.OutlineElementNavigator.Je(lb),lb.Ii()):H.a.instance.ga(66)&&a&&x?Ze.Wi.pvg(R)&&!({qwa:Xa}=this.b7g(a,R,lb.currentNode,f,Xa)).returnValue&&(c.ana(l),Ze.ao.ema(b),b.Ii()):xd.TableReader.Np(lb)?(c.ana(l),this.rVf&&({response:wa,returnValue:Xa}=this.rVf.xCl(a,Lb,b,lb,F,fa,wa))):Ze.p4.Wd(lb.currentNode)&&(({qwa:Xa}=this.b7g(a,
R,lb.currentNode,f,Xa)).returnValue||this.lVf&&this.lVf.dEi(a,c,l,b,R,lb));return{returnValue:!0,response:wa,qwa:Xa}}return{returnValue:!1,response:wa,qwa:Xa}}b7g(a,b,c,f,l){return Ze.Nf.Zf&&Ze.Nf.jy&&(a=(a?b:c).Ra.last,b=u.AFrameworkApplication.userName,!a.lo||a.lo.authorName!==b)?(f&&(ld.a.instance.setSelection(f),l=!1),{returnValue:!0,qwa:l}):{returnValue:!1,qwa:l}}wpj(a,b,c,f,l,x,F,R){return H.a.instance.ga(67)&&Rd.OutlineElementReader.dtg(b,a)?(De.isInTableCell(b)&&(Dd.returnToContainingCell(b),
De.isEmpty(b)&&c.ana(f),{G9k:a,returnValue:R}=Ze.mdk(b,F,a,l,x),a||(R=2)),{returnValue:!0,response:R}):{returnValue:!1,response:R}}Zlj(a,b,c,f,l,x,F,R){Rd.OutlineElementReader.dtg(b,a)||({response:F,qwa:R}=Ze.uHi(c,f,a,x,l,F,R));return{returnValue:!1,response:F,qwa:R}}gEi(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){let kc=!1,lc=2;const Ec=Ze.p4.isEmpty(lb),Jc=lb.currentNode;Yb.OutlineElementNavigator.Je(lb);({response:lc}=this.sOc(l,lb,wa,lc)).returnValue||({response:lc}=this.Hlj(l,lb,a,b,c,lc)).returnValue||
({response:lc}=this.Upj(l,lb,a,b,c,lc)).returnValue||({response:lc}=this.znj(l,lb,a,b,c,lc)).returnValue||({response:lc,qwa:kc}=this.jjj(l,lb,R,Xa,f,Ec,Jc,Lb,fa,lc,kc)).returnValue||({response:lc}=this.wpj(l,lb,R,f,fa,wa,Jc,lc)).returnValue||({response:lc,qwa:kc}=this.Zlj(l,lb,b,c,R,F,lc,kc));Ze.QUg(R,32===lc);kc&&Ze.IT(fa,x)}G8k(a,b,c){return a&&a.Sa(be.a.bqb)?this.Dni.eoh()||a.getValue(be.a.bqb)?!a.sa(be.a.bqb,!1):this.A8f(!1,c):this.A8f(b,c)}Ioh(){return{returnValue:!1,BRa:!1}}static get characterPropertiesEditor(){return Ze.Vg||
(Ze.Vg=hb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Rf(){return Ze.Og||(Ze.Og=hb.a.instance.resolve("Box4.List.IListReader"))}static get p4(){return Ze.Zq||(Ze.Zq=hb.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return Ze.Xm||(Ze.Xm=hb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get ao(){return Ze.Jo||(Ze.Jo=hb.a.instance.resolve("Box4.List.IListEditor"))}static get Jh(){return Ze.Zff||(Ze.Zff=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get iH(){return kk.a.instance}static get Tu(){return Yu.a.osb}static get Nf(){return Ze.Wc||
(Ze.Wc=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get k5(){return Ze.Lo||(Ze.Lo=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Emc(){return Ze.QC||(Ze.QC=hb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Tc(){return Sa.a.instance}static get Wi(){return Qg.a.instance}static get yt(){return Ze.JC||(Ze.JC=hb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get WR(){return nc.a.instance}static sSi(a){if(1===
a.Oa.length&&(a=a.Oa.ga(0),fb.SelectionEditor.Jw(a))){var b=a.Ua;a=b.node;b=b.Qa;var c=Ze.p4.text(a);b<c.length&&0<b&&" "===c.charAt(b-1)&&" "===c.charAt(b)&&Ze.characterPropertiesEditor.replaceTextRange(Pc.a.createTextRange(a,b-1,b),"\u00a0")}}static Qai(a,b){if(!b.hyperlink.Dub){const c=new We.GraphTransaction(15);try{c.fd(a.node),Ze.yt.hO(a,b)}finally{c&&c.dispose()}}}static ema(a,b){a=Ze.Rf.Fw(a).MSc?C.a.XQ:C.a.tO;return u.AFrameworkApplication.Ta.ii(b.WTe,a,2,!1,b.bJ,b.ld)}static uHi(a,b,c,f,
l,x,F){if(c=fb.SelectionEditor.rPa(f,!1,!c,!1,!1,!0)){f=nd.SelectionFactory.PM(f,c.Ua);x=32;for(c=0;c<f.length;++c){l.ana(f.ga(c));const R=u.AFrameworkApplication.Ta.ii(f.ga(c),C.a.eK,2,!0,a,b);2!==R&&(x=R)}32===x&&(F=!0)}return{response:x,qwa:F}}static GGi(a,b,c,f,l,x,F,R,fa){let wa=!1;a(c)?(wa=Ze.DRd(c,!0,f,l,x,F))&&Ze.wJa(R,f,fa):b(c)?(wa=Ze.DRd(c,!1,f,l,x,F))&&Ze.wJa(R,f,fa):(x.normalize(),Ze.wJa(R,f,fa));return wa}static wJa(a,b,c){c&&c.IT()||Ze.IT(b,a)}static DRd(a,b,c,f,l,x){f||Ui.OutlineReader.Xia(a)||
(c=Ze.Vql(c))&&l.I5k(c);a=32===u.AFrameworkApplication.Ta.ii(a,x.actionId,2,b,x.bJ,x.ld);Ze.QUg(l,a);return a}static QUg(a,b){b?a.normalize():a.cancel()}static IT(a,b){b&&(b=b.restore())&&a.setSelection(b)}static hEi(a,b,c,f,l,x,F,R){let fa;!b&&({f2b:fa}=Ze.yt.t8a(a)).returnValue?(c=new ar(f),Ze.Qai(a,fa),l.normalize(),Ze.IT(x,c)):Ze.DRd(a,!1,x,F,l,R)&&(b&&Ze.Nf.Zf&&Ze.Nf.jy?(b=Ze.k5.iOd)?(x.setSelection(nd.SelectionFactory.Jg(a.node,b)),Ze.k5.iOd=null):Ze.IT(x,c):Ze.IT(x,c))}static mdk(a,b,c,f,l){let x,
F=2;x=!0;if(De.isEmpty(a)){const R=Dd.getContainingTable(a),fa=xd.TableReader.$j(R),wa=xd.TableReader.ui(R);1===fa&&1===wa?(F=u.AFrameworkApplication.Ta.ii(Pc.a.create(R),C.a.R3a,2,!1,l.bJ,l.ld),f.setSelection(nd.SelectionFactory.Jg(b,0)),x=!1):1===fa?F=u.AFrameworkApplication.Ta.ii(l.WTe,C.a.EAa,2,!1,l.bJ,l.ld):(b=De.isEmptyIncludingTheRestOfTheRow(a),De.isFirstCellInRow(a)&&b?F=u.AFrameworkApplication.Ta.ii(l.WTe,C.a.deleteRow,2,!1,l.bJ,l.ld):!c&&b&&(F=32,a=fb.SelectionEditor.Qqa(f.Oa.kb,!1,!1,
!1,!0),f.setSelection(a),x=!1))}return{returnValue:F,G9k:x}}static K8k(a){return a.Hw||Ui.OutlineReader.Xia(a)||Ze.p4.Xl(a)}static Vql(a){return(a=li.Xqa(a.Oa,!0))&&1===a.length&&(a=a.getContext(0).node,xd.TableReader.O8a(a))?a:null}}Ze.Og=null;Ze.Vg=null;Ze.Zff=null;Ze.Zq=null;Ze.Xm=null;Ze.Jo=null;Ze.Wc=null;Ze.Lo=null;Ze.QC=null;Ze.WXe=null;Ze.JC=null;Object(e.a)(Ze,"ADeleteViewStrategy",null,[]);class ku{constructor(a,b){this.Mb=a;this.Vh=b}dEi(a,b,c,f,l,x){l=this.Mb.Kc(l);a&&!this.Vh.isEmpty(l)?
(Yb.OutlineElementNavigator.Je(x),b.Wwh(x.currentNode),ku.Jh.merge(f,x,!1,!1)):(Yb.OutlineElementNavigator.Je(x),b.ana(c),ku.Jh.merge(x,f,!1,!1))}static get Jh(){return ku.xi||(ku.xi=hb.a.instance.resolve("Box4.IOutlineElementEditor"))}}ku.xi=null;Object(e.a)(ku,"DeleteParagraphNodeStrategy",null,[866]);class EN extends Ze{constructor(a,b,c,f){super();this.C_j=new ku(c,f);this.la=a;this.QLg=b;this.Mb=c}get rVf(){throw Error.notImplemented();}get lVf(){return this.C_j}iXi(a,b){return fb.SelectionEditor.rPa(a,
!0,!b,!1,!1,!0)}J8k(a){return fb.SelectionEditor.Pj(a)}A8f(a,b){if(!this.la.eae||!this.la.Dvb||!this.la.fae||a)return!1;a=this.Nej(b);return 1===(a&1)&&2!==(a&2)}Nej(a){var b=a.Oa;if(!b.length)return 0;a=Object(va.a)(5,b.ga(0).Ua.node);if(!a||!a.Sr())return 0;a=(a=(a=a.pK())?a.Yeg():null)?a.getContainingTable():null;if(!a)return 0;const c=[];for(var f=0;f<b.length;++f){var l=b.ga(f);if(l){var x=li.DLc(l,!0),F=li.DLc(l,!1);if(x&&F){if(fb.SelectionEditor.lu(x)&&!fb.SelectionEditor.uub(x)||!Ya.ParagraphReader.z8d(x.node)||
x!==F&&fb.SelectionEditor.lu(F)&&!fb.SelectionEditor.uub(F)||!Ya.ParagraphReader.$Hj(F.node))return 0;if(l=Object(va.a)(Ea.a,Rg.ContextSetEditor.instance.MZb(Ea.a.cOa(l.toArray()),16,!1)))for(x=0;x<l.length;++x)F=Object(va.a)(Xl.TableCellNode,l.getContext(x).node),a.lp()&&F.isControllingCell?this.NAj(F,c):F.isGhostCell||Array.add(c,F)}}}if(!c.length)return 0;b=a.wX;f=a.F6;x=l=0;F=Array(b);const R=Array(f);for(var fa=0;fa<b;++fa)F[fa]=0;for(fa=0;fa<f;++fa)R[fa]=0;for(fa=0;fa<c.length;++fa){const wa=
c[fa].Yeg();++F[wa.rowIndex]===f&&++l;++R[wa.li]===b&&++x}if(0<l&&0<x){if(l===b&&x===f)return 3}else if(l||x){if(0<l){if(!a.lp())for(a=0;a<f;++a)if(R[a]!==l)return 0;return 1}if(0<x){if(!a.lp())for(a=0;a<b;++a)if(F[a]!==x)return 0;return 1}}return 0}NAj(a,b){De.foreachMergedCells(Object(va.a)(ag.a,a),c=>{Array.add(b,c)})}sOc(a,b,c,f){if(!a&&Ib.ListReader.ak(b)){var l=this.Mb.XPa();l.Nc(b);if((l=Object(va.a)(4,l.Ng(10)))&&l.Qf){if(this.QLg.tob(b))this.QLg.Idb(b,-1,0),f=32;else if(b.WE(1)){if(b.uf(1),
({response:f}=super.sOc(a,b,c,f)).returnValue)return{returnValue:!1,response:f}}else f=32;return{returnValue:!0,response:f}}return super.sOc(a,b,c,f)}return{returnValue:!1,response:f}}Ioh(a,b,c){if(!(b&&a===C.a.backspace&&c.Oa&&c.Oa.length&&c.Oa.nl))return{returnValue:!1,BRa:!1};b=c.Po();if(!b||!b.lp())return{returnValue:!1,BRa:!1};a=b.wX;b=b.F6;let f=a,l=0,x=b,F=0;c=Rg.ContextSetEditor.instance.jA(c.Dj);for(let wa=0;wa<c.length;wa++){if(!c[wa].Kk)return a=!1,{returnValue:!1,BRa:a};var R=Object(va.a)(5,
c[wa].node);if(!R||!R.Sr())return a=!1,{returnValue:!1,BRa:a};var fa=(R=R.pK())?R.oy():null;if(!fa)return a=!1,{returnValue:!1,BRa:a};R=fa.rowIndex;const Xa=fa.li,lb=fa.rowSpan;fa=fa.colSpan;f=Math.min(f,R);l=Math.max(l,R+lb-1);x=Math.min(x,Xa);F=Math.max(F,Xa+fa-1)}return l-f+1!==a&&F-x+1!==b?{returnValue:!1,BRa:!1}:{returnValue:!0,BRa:l-f+1===a?!0:!1}}}Object(e.a)(EN,"DeleteViewStrategy",Ze,[]);class FN extends ml{constructor(a,b,c,f){super();this.D_j=new EN(a,b,c,f);this.B_j=new Iv}get ZFc(){return this.D_j}get jVf(){return this.B_j}}
Object(e.a)(FN,"Box4DeleteActor",ml,[]);class GN{constructor(a,b,c,f,l){this.ia=a;this.A_j=new FN(b,c,f,l);pa.InteractiveViewManager.instance.editingView.iXb=!0}ub(){this.A_j.ub(this.ia)}we(){var a=C.a.backspace;const b=v.FocusManager.instance().Bc(I.AppFrame.nV);b.bindAction(A.KeyInputManager.Na(w.a.jH,0),a);b.bindAction(A.KeyInputManager.Na(w.a.jH,4),C.a.backspace);b.bindAction(A.KeyInputManager.Na(w.a.jH,4|A.KeyInputManager.Fe),G.a.ze);b.bindAction(A.KeyInputManager.Na(w.a.jH,A.KeyInputManager.Fe),
C.a.Cpb);b.bindAction(A.KeyInputManager.Na(w.a.kna,0),C.a.eK);b.bindAction(A.KeyInputManager.Na(w.a.kna,A.KeyInputManager.Fe),C.a.OWb);n.a.ek&&(b.bindAction(A.KeyInputManager.Na(w.a.jH,3),C.a.backspace),b.bindAction(A.KeyInputManager.Na(w.a.jH,7),C.a.backspace),b.bindAction(A.KeyInputManager.Na(w.a.jH,5),C.a.backspace),b.bindAction(A.KeyInputManager.Na(w.a.jH,1),C.a.Cpb))}}Object(e.a)(GN,"DeleteActor",null,[244]);class HN{constructor(a){this.CZj=a}ub(){this.CZj.ub()}we(){}}Object(e.a)(HN,"EnterActor",
null,[244]);class Zp{constructor(a,b,c){this.zu=a;this.ORb=b;this.nm=c}get rn(){return this.ORb.value}uMi(a,b,c,f,l){var x;if(!({Df:c,selected:x,CE:fa}=this.Moh(b,c,!1)).returnValue)return fa;N.a.mark(5013);var F=Zp.Pl.jA(x);for(var R=0;R<F.length;++R){if(!F[R].isValid)continue;let wa=F[R].iterator;wa.uv();if(Ui.OutlineReader.At(wa))return this.I_f(c,wa);if(ph.b(wa))return ro.instance.$vb(a,x,c),this.rn.Pv(),N.a.mark(5014),32}F=this.v2i(x);if(x.Hw||fb.SelectionEditor.Pj(x)||Ya.ParagraphReader.Xl(x)&&
!fb.SelectionEditor.JV(x)){if(Zp.pe&&Zp.pe.isFeatureEnabled(33)&&Rg.ContextSetEditor.instance.kMe(x).returnValue)return 8;var fa=this.J_f(b,c,a,f,l,F)}else if(fb.SelectionEditor.Cl(x))fa=this.H_f(b,c,a,f,l,F);else if(fb.SelectionEditor.Kg(x)){fa=new mb.GraphIterator;fa.set(x.node);fa.mc(10);if(this.oek()&&(R=Rb.HyperlinkReader.FB(x,!1),0<R.length)){if(!R[0].hyperlink)return Z.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",R[0].Qa,R[0].Kb),8;Gb.App.BZb(R[0].hyperlink.url);
return 32}De.isInTableCell(fa)&&!H.a.instance.ga(77)&&(Dd.returnToContainingCell(fa),H.a.instance.ga(30)&&De.isLastCellInTable(fa)&&!Ui.OutlineReader.OOc(fa)&&Ui.OutlineReader.OB(fa,x,!0)&&(yh.OutlineNavigator.v9(fa),Ib.ListReader.ak(fa)||(F=C.a.HCa),Dd.returnToCell(fa)),De.isFirstCellInRow(fa)&&(R=new mb.GraphIterator,R.Nc(fa),Dd.returnToContainingRow(R),H.a.instance.ga(30)&&ik.j(R)&&ik.e(R)&&1<xd.TableReader.$j(Dd.getContainingTable(R))?F=C.a.deleteRow:Ui.OutlineReader.OB(fa,x,!1)&&(ik.g(R)&&0>=
x.TR?(F=C.a.I2b,Dd.returnToContainingTable(fa),Yb.OutlineElementNavigator.Je(fa),l||(l=new E.DictionaryPropertySet),l.ke(be.a.targetObject,fa.currentNode.id)):H.a.instance.ga(30)&&(F=C.a.N7a))));fa=this.L_f(b,c,a,f,l,F)}else fb.SelectionEditor.JV(x)&&(fa=u.AFrameworkApplication.Ta.ii(b,C.a.SA,2,!1,f,l));N.a.mark(5014);return fa}Moh(a,b,c){let f,l;l=f=null;if(1===b)return{returnValue:!1,Df:f,selected:l,CE:32};if(!a.view.Hh)return{returnValue:!1,Df:f,selected:l,CE:2};f=a.view;l=f.Eb.Dj;return!l||H.a.instance.ga(14)&&
!Zp.Wi.Esg(l,c)?{returnValue:!1,Df:f,selected:l,CE:2}:this.nm&&this.nm.instance&&this.nm.instance.LV(l)?{returnValue:!1,Df:f,selected:l,CE:4}:{returnValue:!0,Df:f,selected:l,CE:2}}i8k(a,b,c,f,l){let x,F;if(!({Df:c,selected:x,CE:F}=this.Moh(b,c,!0)).returnValue)return F;const R=Zp.Pl.jA(x);for(let fa=0;fa<R.length;++fa){if(!R[fa].isValid)continue;const wa=R[fa].iterator;wa.uv();if(Ui.OutlineReader.At(wa))return this.I_f(c,wa)}x.Hw||fb.SelectionEditor.Pj(x)?F=this.J_f(b,c,a,f,l,C.a.G2b):fb.SelectionEditor.Cl(x)?
F=this.H_f(b,c,a,f,l,C.a.G2b):fb.SelectionEditor.Kg(x)?F=this.L_f(b,c,a,f,l,C.a.G2b):fb.SelectionEditor.JV(x)&&(F=u.AFrameworkApplication.Ta.ii(b,C.a.SA,2,!1,f,l));return F}I_f(a,b){a.Eb.setSelection(nd.SelectionFactory.nj(b.currentNode,!1));return 32}J_f(a,b,c,f,l,x){const F=new We.GraphTransaction(15);F.$c=c;F.fd(b.rg);b=new E.DictionaryPropertySet;b.setValue(be.a.bqb,!0);b=u.AFrameworkApplication.Ta.ii(a,C.a.eK,2,!0,f,b);32===b&&(b=u.AFrameworkApplication.Ta.ii(a,x,2,!1,f,l));F.dispose();return b}H_f(a,
b,c,f,l,x){const F=new We.GraphTransaction(15);F.$c=c;F.fd(b.rg);b.Eb.setSelection(fb.SelectionEditor.yl(b.Eb.Oa.ga(0),!1,!1));a=u.AFrameworkApplication.Ta.ii(a,x,2,!1,f,l);F.dispose();return a}L_f(a,b,c,f,l,x){const F=new We.GraphTransaction(15,c);F.$c=c;F.fd(b.rg);a=u.AFrameworkApplication.Ta.ii(a,x,2,!1,f,l);F.dispose();return a}static get Pl(){return Rg.ContextSetEditor.instance}static get Wi(){return Qg.a.instance}static get pe(){return Zp.Xc||(Zp.Xc=hb.a.instance.pb("Box4.IFeatureHelper"))}}
Zp.Xc=null;Object(e.a)(Zp,"AEnterViewStrategy",null,[823]);class Xs extends Zp{constructor(a,b,c){super(a,b,c)}v2i(a){let b=C.a.SA;if(a&&(a=Zp.Pl.jA(a))&&0<a.length){const c=new mb.GraphIterator;c.set(a[0].node);c.mc(10);(a=c.AZa())&&a.Sa(ub.a.zj)&&(a=a.getValue(ub.a.zj),0===a||2===a)&&(b=C.a.G2b)}return b}oek(){return Xs.YT?!1:!0}static get YT(){null==Xs.EH&&(Xs.EH=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Xs.EH}}Xs.EH=null;Object(e.a)(Xs,
"EnterViewStrategy",Zp,[]);class JE{constructor(a){this.V0j=a}rfd(a,b){this.V0j.AX(a,b)}}Object(e.a)(JE,"PPTFontNameFormattingStrategy",null,[802]);class IN{eoh(){return!1}}Object(e.a)(IN,"PptClipboardOperationCutStrategy",null,[270]);class JN{constructor(a,b){this.eL=a;this.ra=b}jKj(a){return 10===a.mi||16===a.mi||60===a.mi}wii(a){if(this.eL.v8a(a)&&this.eL.xub(a))return!1;let b=a=null;this.ra.Oa.kb&&(b=this.ra.Oa.kb.Ua,a=this.ra.Oa.kb.Te);return this.Eae(b)&&this.Eae(a)}Eae(a){if(a){if(a.contextId===
Fb.a.paragraph)return!0;if(a.contextId===Fb.a.endOfParagraph&&(a=a.node))return Ma.a.Va(a.characterData)}return!1}v9k(a,b){return this.AKe(a,b)}AKe(a,b){let c=null;this.ra.Oa.kb&&(c=this.ra.Oa.kb.Ua);return this.Eae(c)?!!a&&this.eL.xub(a)||1===b:!1}}Object(e.a)(JN,"PptDeleteOutlineElementNodeStrategy",null,[268]);class KN{constructor(a,b,c){this.vq=a;this.KI=b;this.nb=c}f0f(a){if(this.nb.Oa&&this.nb.Oa.nl){const f=this.vq.i7f(this.nb.Oa).returnValue;if(!f.hPa()&&a.Hw){a=new Ea.a;var b=this.nb.ny();
for(const l of b)if(b=Object(va.a)(Xl.TableCellNode,l)){var c=mb.GraphIterator.mb(b);if(c.Ze()){const x=ik.c(c);c=this.KI.QKc(Object(va.a)(125,c.currentNode));f.vOi(x,c)&&a.Dga(ld.a.YNa(nd.SelectionFactory.Xk(b)))}}}}return a}}Object(e.a)(KN,"PptDeleteTableSegmentStrategy",null,[271]);class LN{Rth(){return!1}Wug(a){return!!a&&!a.Sl.equals(Ga.a.nil)}}Object(e.a)(LN,"PptEopFormattingStrategy",null,[266]);class MN{constructor(a,b,c){this.w_c=!1;this.Ea=a;this.DN=b;this.ra=c}Syh(a,b){a&&b&&(b.beforeSpacing&&
(a.setValue(ub.a.lca,b.beforeSpacing.value),a.setValue(ub.a.mja,b.beforeSpacing.Pf)),b.afterSpacing&&(a.setValue(ub.a.kca,b.afterSpacing.value),a.setValue(ub.a.lja,b.afterSpacing.Pf)),b.lineSpacing&&(a.setValue(ub.a.Nw,b.lineSpacing.value),a.setValue(ub.a.ZV,b.lineSpacing.Pf)));return!0}boh(){return!1}Poh(){return!1}Znh(){return!this.w_c}Joh(a,b){return a===Fb.a.paragraph||a===Fb.a.endOfParagraph||b}$nh(a,b,c){this.ra.Oa&&this.ra.Oa.kb&&(c=!this.ra.Oa.kb.Paa);return a!==Fb.a.textRange&&(b===Fb.a.paragraph||
c)}BDf(a,b,c){this.w_c=!1;if(a.Sr()&&this.ra.Oa.kb){var f=this.ra.Oa.kb.Ua;this.ra.Oa&&this.ra.Oa.nl&&this.ra.Oa.ga(0)&&(f=this.ra.Oa.ga(0).Ua);if(f=tb.a.Bs(Ya.ParagraphReader.Wd(f.node)?f:nd.SelectionFactory.Xk(a).Ua))if(f=f.cache)!c.Sa(ub.a.latinFont)&&f.Sa(ub.a.latinFont)&&c.setValue(ub.a.latinFont,f.TM),!c.Sa(bb.a.fontColor)&&f.B2&&c.setValue(bb.a.fontColor,f.fontColor),!c.Sa(bb.a.fontSize)&&f.Cra&&c.setValue(bb.a.fontSize,f.fontSize),!c.Sa(bb.a.bold)&&f.OQa&&c.setValue(bb.a.bold,f.isBold)}if(b){if(f=
a.vP(this.DN)){b.GS||a.sa(ub.a.C7d,!1)||f.sa(ub.a.C7d,!1)||(this.w_c=!0);const l=b.spacing;l&&(!l.beforeSpacing||l.beforeSpacing.value||f.Sa(ub.a.lca)||(l.beforeSpacing=null),!l.afterSpacing||l.afterSpacing.value||f.Sa(ub.a.kca)||(l.afterSpacing=null),l.lineSpacing&&2===l.lineSpacing.Pf&&1===l.lineSpacing.value&&!f.Sa(ub.a.Nw)&&(l.lineSpacing=null))}this.w_c||(b.GS||(b.GS=uj.a.kP(16,0)),b.GS.d5f=!0)}if((f=a.ddg())&&!f.w9&&(c.Sa(bb.a.fontSize)&&(f=this.Ea.DBa(this.Ea.kn(a)),c.setValue(bb.a.fontSize,
c.getValue(bb.a.fontSize)*f)),b&&b.spacing&&b.spacing.lineSpacing&&2===b.spacing.lineSpacing.Pf)){let l;(l=b.spacing.lineSpacing).value=l.value-this.Ea.Jrb(this.Ea.kn(a))}c.sa(bb.a.Fs,!1)&&c.setValue(bb.a.Fs,!1);c.sa(bb.a.yZ,!1)&&c.setValue(bb.a.yZ,!1)}}Object(e.a)(MN,"PptFormatPainterStrategy",null,[269]);var KE=d(420);class gA{constructor(a,b,c,f,l,x,F){this.ia=a;this.Fa=f;this.ra=b;this.GD=c;this.ou=l;this.KA=x;this.LUa=!F.vg;this.cle=F.Pvg}ub(){this.ia.pa(G.a.Fwh,de.a.frame,Object(D.a)(this,this.Dyk,
"pptToggleRibbonUXHandler"),128);this.ia.xa(G.a.zeh,de.a.frame,ce.ActionManager.Fg);this.ia.xa(G.a.yeh,de.a.frame,ce.ActionManager.Fg)}we(){}Dyk(a,b){if(b.contextId!==de.a.frame)return 2;this.ra.Ph();this.Fa.Ad();this.ou.show(!0,a);this.cle?(ya.a.J(33859651,340,50,"User is switching to the Classic Ribbon from Single Line Ribbon"),u.AFrameworkApplication.Ta.processAction(G.a.zeh,2)):(ya.a.J(33859653,340,50,"User is switching to the Single Line Ribbon from Classic Ribbon"),u.AFrameworkApplication.Ta.processAction(G.a.yeh,
2));u.AFrameworkApplication.wu&&u.AFrameworkApplication.wu.Z6();this.KA.P7&&2===this.KA.fJ?gA.Nhh(this.ia,this.cle,KE.a.E$c):this.GD.f2(!1,this.LUa,()=>{gA.Nhh(this.ia,this.cle,KE.a.E$c)},null);return 32}static Nhh(a,b,c){Hi.a.JL(c,(!b).toString(),Hi.a.rL);a.processAction(ba.a.refresh,2)}}Object(e.a)(gA,"ToggleRibbonUXActor",null,[244]);class NN extends Sys.EventArgs{constructor(a,b,c){super();this.actionId=a;this.XRe=b;this.T8a=c}}Object(e.a)(NN,"UndoRedoEventArgs",Sys.EventArgs,[]);class ON{constructor(a,
b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){this.ia=a;this.Af=b;this.ra=c;this.Fa=f;this.hv=l;this.X2j=x;this.j6j=F;this.WMg=R;this.ED=fa;this.Jbb=wa;this.sI=Xa;this.v1j=lb;this.gf=kc}ub(){this.ia.pa(ba.a.Ddb,fc.a.application,Object(D.a)(this,this.nig,"handleUndoRedo"),4);this.ia.pa(ba.a.Cdb,fc.a.application,Object(D.a)(this,this.nig,"handleUndoRedo"),4)}we(){const a=this.Fa.Bc(Nc.a.gj);a.hBc(A.KeyInputManager.Na(w.a.eKb,A.KeyInputManager.Fe),ba.a.Ddb,()=>!0);a.bindAction(A.KeyInputManager.Na(w.a.jnd,A.KeyInputManager.Fe),
ba.a.Cdb)}nig(a,b,c,f,l){b=!0;a===ba.a.Cdb&&(b=!1);if(this.Af.Zc(this.WMg)||!this.r8k(b,l))return 16;if(!this.s8k())return this.hv.rma(),16;if(1===c)return 32;if(c=!this.hv.rEj(b))this.ra.hj(),this.sTk();f=this.hv.fLc(b);(l=this.sI.D4(f))&&Mc.a.hk("UndoRedoActionName",l);this.Jbb.v6c(!c);this.gf.GGk(new NN(a,f,b));(f=this.hv.bYd(b))&&f.U4!==Ga.a.nil&&Mc.a.hk("UndoRedoRevision",Mc.a.D6a(f.U4.toString()).toString());this.v1j.v6c(f,l,b);if(b?!this.hv.undo():!this.hv.redo())return Z.ULS.sendTraceTag(512499928,
801,10,"User perform {0} failed!!",a===ba.a.undo?"undo":"redo"),8;c&&this.Af.zw(this.WMg,a);return 32}r8k(a,b){a&&!this.hv.AV&&b&&Z.ULS.sendTraceTag(512499927,801,50,"User pressed ctrl+z, but no undo entry left. Is in box4? {0}",this.hv.n8a());return(a?this.hv.AV:this.hv.uia)&&!(this.Fa.ye&&this.Fa.ye.name===Nc.a.lHd)&&this.t8k()}s8k(){return this.X2j||!this.mHj()}mHj(){return!this.j6j.xBa&&!!this.ED.instance&&this.ED.instance.hLj()}t8k(){return!this.nHj()}nHj(){const a=this.ra.jq();return a?a.yx:
!1}sTk(){const a=this.Fa.ye;!a||a.name!==Nc.a.yg&&a.name!==Nc.a.Oua||this.Fa.Ad()}}Object(e.a)(ON,"UndoRedoActor",null,[244]);class PN{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue,Ef,dg,Mg,Bg,Lf,mh,Fg,ii,Li,wj,cj){this.rEa=this.Gta=this.Z1c=null;this.Qyb=0;this.hHg=this.eke=!1;this.GD=x;this.ia=a;this.Swb=b;this.Fa=c;this.fh=f;this.ra=l;this.Af=F;this.fe=R;this.Yb=fa;this.ta=wa;this.Sb=Xa;this.ubc=lb;this.$b=Lb;this.la=kc;this.ou=lc;this.Xa=Ec;this.KA=Jc;this.Ie=Dc;this.mua=
Wd;this.ZLg=xe;this.$u=Sd;this.yb=Pe;this.Uv=Ue;this.v_c=Ef;this.EIg=kc.Dtg;this.Qc=dg;this.P9a=Mg;this.zo=Bg;this.Dc=Lf;this.Pb=mh;this.Qb=Fg;this.QN=ii;this.Nb=Li;this.TG=wj;this.Wv=cj;this.Hki()}ub(){this.ia.pa(ba.a.had,fc.a.application,Object(D.a)(this,this.had,"queryEdit"),96);this.ia.pa(ba.a.ebd,fc.a.application,Object(D.a)(this,this.ebd,"querySorterView"),96);this.ia.pa(ba.a.Lgc,fc.a.application,Object(D.a)(this,this.Lgc,"querySlideInformation"),96);this.ia.xa(ba.a.U$g,fc.a.application,Object(D.a)(this,
this.Jil,"switchToReadingMode"));this.ia.xa(ba.a.dlc,fc.a.application,Object(D.a)(this,this.Tgl,"startSlideShowFromBegnning"));this.ia.xa(ba.a.Ffc,fc.a.application,Object(D.a)(this,this.Ffc,"present"));this.ia.xa(ba.a.CDb,fc.a.application,Object(D.a)(this,this.CDb,"presentDropDown"));this.ia.xa(ba.a.P9c,fc.a.application,Object(D.a)(this,this.P9c,"playFromBeginningTopBar"));this.ia.xa(ba.a.DYa,fc.a.application,Object(D.a)(this,this.DYa,"startSlideShowFromCurrentSlide"));this.ia.xa(ba.a.frb,fc.a.application,
Object(D.a)(this,this.frb,"forceClose"));this.ia.xa(ba.a.$la,fc.a.application,Object(D.a)(this,this.$la,"rehearsePresentation"));this.ia.xa(ba.a.gcd,fc.a.application,Object(D.a)(this,this.gcd,"rehearsePresentationTopBar"));this.la.pptEditorRehearsalSpeechClientEnabled&&(this.ia.xa(ba.a.DHc,fc.a.application,Object(D.a)(this,this.DHc,"enableSubtitlesKeyboardShortcut")),this.ia.xa(ba.a.CHc,fc.a.application,Object(D.a)(this,this.CHc,"enableLivePresenterKeyboardShortcut")));this.$_h();this.ia.xa(ba.a.fgb,
fc.a.application,Object(D.a)(this,this.fgb,"showEditTriPaneView"));this.$b.ka("PPTSorterViewEnabled")&&(this.eke=this.$b.ka("FeedbackPaneExperienceIsEnabled")&&this.$b.ka("HelpTabIsEnabled"),this.ia.xa(ba.a.nVb,fc.a.application,Object(D.a)(this,this.nVb,"closeEditTriPaneView")));this.la.hSc&&this.mua.rwj(u.AFrameworkApplication.buildVersion,this.Xa.Wj,u.AFrameworkApplication.userSessionId,this.Dc)}we(){if(this.$b.ka("SlideShowByShortcutEnabled")){const a=this.Fa.Bc(y.AFrame.gj);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.moc,
A.KeyInputManager.Fe|4),ba.a.DYa);y.AFrame.Sj(a,A.KeyInputManager.Na(w.a.moc,A.KeyInputManager.Fe),ba.a.dlc)}}$_h(){this.ia.xa(ba.a.Gfc,fc.a.application,Object(D.a)(this,this.Gfc,"presentLive"));this.ia.xa(ba.a.M$c,fc.a.application,Object(D.a)(this,this.M$c,"presentLiveTopBar"));this.ia.xa(ba.a.Bdb,fc.a.application,Object(D.a)(this,this.Bdb,"presentLiveSetAccessControlAnyone"));this.ia.xa(ba.a.L$c,fc.a.application,Object(D.a)(this,this.L$c,"presentLiveSetAccessControlOrganization"));this.ia.pa(ba.a.Agc,
fc.a.application,Object(D.a)(this,this.Agc,"queryPresentLiveAccessControlAnyone"),96);this.ia.pa(ba.a.Bgc,fc.a.application,Object(D.a)(this,this.Bgc,"queryPresentLiveAccessControlOrganization"),96);hb.a.instance.La("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(a=>{a.k2("L_PublicLivePresentations",!0).then(b=>{b||(ya.a.J(512499926,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),this.ia.eO(ba.a.Bdb,Fb.a.application,Object(D.a)(this,this.Bdb,
"presentLiveSetAccessControlAnyone")),Gb.App.Fb.qZa(ba.a.Bdb,Object(D.a)(new zp,(new zp).CBa,"getCommandById")));return null},b=>{ya.a.J(512499925,822,10,"Could not get publiclivepresentations policy {0}",b);return null})})}Lgc(a,b,c,f,l){a=(a=this.ta.Ba)?a.De+1:0;a=(b=this.Sb.Nj())?String.format(ResourceStrings.l_SlideMenuButtonLabel,a,b):ResourceStrings.l_Slide;l[Fq.a.Value]=a;l[Am.a.labelText]=a;return 32}had(a,b,c,f,l){this.Qb&&0!==this.Qb.Nu?l.Kf(!1):l.Kf(!0);return 32}ebd(a,b,c,f,l){(a=Object(va.a)(Ph.a,
l))&&(1!==this.Qb.Nu?a.Kf(!1):a.Kf(!0));return 32}fgb(a,b,c){try{if(1===c)return 32;2===c&&0!==this.Qb.Nu&&(ya.a.J(512499924,822,50,"ViewSwitchingActor: ShowEditTriPaneView."),this.Qb.Nu=0,this.Nb&&(this.Nb.slidePane.Kl(),this.la.bXa||this.Nb.thumbnailPane.Kl(),this.Nb.notesPane.Kl(),this.la.RWa&&this.TG&&this.TG.setVisibility(!0)),this.ia.processAction(ba.a.oFb,2),this.ia.processAction(ba.a.nDc,2),this.QN.I4("PptEditingStatusBar.Notes",!0),this.QN.I4("PptEditingStatusBar.ZoomScale",!0),this.QN.I4("PptEditingStatusBar.FitToWindow",
!0),this.eke?this.QN.I4("PptEditingStatusBar.GiveFeedbackPane",!0):this.QN.I4("PptEditingStatusBar.GiveFeedback",!0),this.Qc.RD(new Yp.a(2)),this.Qc.RD(new Yp.a(1)),this.fh.TJ(Nc.a.dE),this.fh.TJ(Nc.a.Oua),this.fh.TJ(Nc.a.yg),this.fh.TJ(Nc.a.sP))}catch(f){ya.a.J(512499923,822,10,"ViewSwitchingActor - Expcetion in ShowEditTriPaneView: {0}.",f)}return 32}nVb(a,b,c){try{if(1===c)return 32;2===c&&(this.Nb&&(this.Nb.slidePane.Ds(),this.Nb.thumbnailPane.Ds(),this.Nb.notesPane.Ds(),this.la.RWa&&this.TG&&
this.TG.setVisibility(!1)),this.QN.I4("PptEditingStatusBar.Notes",!1),this.QN.I4("PptEditingStatusBar.ZoomScale",!1),this.QN.I4("PptEditingStatusBar.FitToWindow",!1),this.eke?this.QN.I4("PptEditingStatusBar.GiveFeedbackPane",!1):this.QN.I4("PptEditingStatusBar.GiveFeedback",!1),this.Qc.RD(new Yp.a(2)),this.Qc.RD(new Yp.a(1)),this.fh.qo(Nc.a.dE),this.fh.qo(Nc.a.Oua),this.fh.qo(Nc.a.yg),this.fh.qo(Nc.a.sP),this.ra.Ph())}catch(f){ya.a.J(512499922,822,10,"ViewSwitchingActor - Exception in CloseEditTriPaneView: {0}.",
f)}return 32}Jil(a,b,c){if(this.Af.Zc(this.Yb.yf))return 16;if(1===c)return this.ta.Ba?32:16;b=(new Date).getTime();let f=cg.a.ej(window.document.URL,gg.a.Y2g,gg.a.readingView,!0);if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");c=this.ta.Ba.Bb;f=cg.a.ej(f,gg.a.sec,c?c.sid.toString():"",!0);f=this.Swb.instance&&this.Swb.instance.isVisible?cg.a.ej(f,gg.a.X2g,"1",!0):cg.a.removeParameter(f,gg.a.X2g,!0);this.Gki();f=cg.a.ej(f,u.AFrameworkApplication.j5c,b.toString(),!0);this.ra.Ph();this.Fa.Ad();
this.ou.show(!0,a);this.GD.f2(!1,!0,()=>{this.Gsh(f)},()=>{ya.a.J(512499921,818,10,"SwitchingToReadingMode: ForceSave triggered failed.");this.Gsh(f);return!0});return 32}Gsh(a){this.ubc.openWindow(1,a,!1)||this.ou.hide()}Ffc(a,b,c){return this.xgb(a,c,null)}CDb(a,b,c){return this.xgb(a,c,null)}P9c(a,b,c){return this.xgb(a,c,null)}Tgl(a,b,c){return this.xgb(a,c,null)}DYa(a,b,c){return this.xgb(a,c,this.ta.Ba?this.ta.Ba.Bb:null)}xgb(a,b,c,f=!1,l=!1){if(!this.la.hSc)return this.Bgl(a,b,c);if(this.Af.Zc(this.Yb.yf)||
!this.Sb.Nj()||this.la.preventDuplicateSlideShowLaunches&&this.mua.N4b()||this.la.allowDisablingSlideShowButtonDueToRehydration&&this.mua.d4d)return 16;if(1===b)return this.wvb()?32:8;this.la.usg&&!ee.a("DummyChangeGateForTest")&&ya.a.J(512499920,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.Wv.hasDeferredContent()&&ya.a.J(512499919,830,100,"StartSlideShow attemped with deferred content");this.Sgl(c,f,l);return 32}Sgl(a,b,c){this.Qyb=(new Date).getTime();this.ra.Ph();this.Fa.Bf(Nc.a.XC);
this.Qc.l$g();ya.a.J(512499918,830,50,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.mua.d4d);const f=a?a.sid:-1;a=(a=a?Object(va.a)(122,this.Sb.aCa(a.sid)):null)?a.De+1:-1;let l=!1;this.zo.instance?l=this.zo.instance.eZ?!0:!1:ya.a.J(512499917,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.mua.Phd(f,a,b,this.$b.Ha("361"),this.Xa.Wj,this.Xa.podSessionId,this.$b.Ha("387"),u.AFrameworkApplication.userSessionId,this.la.gLj,this.Qyb,l,this.Xa,c);this.mua.Jga(Object(D.a)(this,
this.Y6c,"onExitSlideshowHandler"));this.KA.Pdl()}gcd(a,b,c,f){return this.$la(a,b,c,f,{entryPoint:4})}$la(a,b,c,f,l){switch(c){case 2:if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");this.la.pptEditorRehearsalSpeechClientEnabled&&(b=0,l&&(b=l&&"entryPoint"in l?l.entryPoint:1),this.ia.Ka(ba.a.blc,2,b),this.Dc&&(this.Dc.fBa=!1),this.Pb&&this.Pb.instance&&(this.Pb.instance.fBa=!1));return this.mua.N4b()?(this.Dc&&(this.Dc.Gh=!1),32):this.xgb(a,c,this.ta.Ba.Bb,!0);case 1:if(0<this.Sb.Nj())if(this.la.pptEditorRehearsalSpeechClientEnabled){if(32===
this.ia.processAction(ba.a.vIa,1)&&32===this.ia.processAction(ba.a.blc,1)&&this.wvb())return 32;break}else return this.wvb()?this.ia.processAction(ba.a.vIa,1):8;else break;default:ya.a.J(512499916,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}DHc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Dc)return this.Dc.fBa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:ya.a.J(512499915,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}CHc(a,
b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Pb&&this.Pb.instance)return this.Pb.instance.fBa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:ya.a.J(512499914,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}M$c(a,b,c,f,l){return this.Gfc(a,b,c,f,l)}Gfc(a,b,c){if(this.hHg){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(f){ya.a.J(512499913,833,10,
"ViewSwitchingActor::PresentLive unhandled exception: {0}",f)}return 8}if(1===c)return this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&this.Pb.instance.k5a&&this.wvb()?0<this.Sb.Nj()?32:8:8;this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&(this.Pb.instance.eBa=!0);if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");return this.xgb(a,c,this.ta.Ba.Bb,!1,!0)}Bdb(a,b,c){if(1===c)return this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&this.Pb.instance.k5a&&this.wvb()?32:8;this.Pb.instance.Lq&&
0!==this.Pb.instance.accessControl?this.Pb.instance.showEndSessionDialog(()=>{this.Pb.instance.pYb(5);this.Pb.instance.accessControl=0;this.Qc.RD(new Yp.a(1))},()=>{}):(this.Pb.instance.accessControl=0,this.Qc.RD(new Yp.a(1)));return 32}L$c(a,b,c){if(1===c)return this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&this.Pb.instance.k5a&&this.Pb.instance.s1f&&this.wvb()?32:8;this.Pb.instance.Lq&&1!==this.Pb.instance.accessControl?this.Pb.instance.showEndSessionDialog(()=>{this.Pb.instance.pYb(5);this.Pb.instance.accessControl=
1;this.Qc.RD(new Yp.a(1))},()=>{}):(this.Pb.instance.accessControl=1,this.Qc.RD(new Yp.a(1)));return 32}Agc(a,b,c,f,l){try{const x=Object(va.a)(Ph.a,l);x&&this.Pb.instance&&x.Kf(0===this.Pb.instance.accessControl)}catch(x){ya.a.J(512499912,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",x)}return 32}Bgc(a,b,c,f,l){try{const x=Object(va.a)(Ph.a,l);x&&this.Pb.instance&&x.Kf(1===this.Pb.instance.accessControl)}catch(x){ya.a.J(512499911,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",
x)}return 32}Bgl(a,b,c){if(this.Af.Zc(this.Yb.yf))return 16;if(1===b)return this.Sb.Nj()?32:16;this.Qyb=(new Date).getTime();this.ra.Ph();this.Fa.Bf(Nc.a.XC);this.Qc.l$g();this.ou.show(!0,a);this.GD.f2(!1,!0,()=>{this.Mhh(c,this.Qyb)},()=>{ya.a.J(512499910,818,10,"StartSlideShowFrom: ForceSave triggered failed.");this.Mhh(c,this.Qyb);return!0});return 32}Y6c(a,b){a=((new Date).getTime()-this.Qyb).toString();ya.a.J(512499909,830,50,"ViewSwitchingActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",
a,this.Wv.hasDeferredContent(),this.Wv.r3d(b.slideId.toString()));this.Wv.hasDeferredContent()||this.Wv.r3d(b.slideId.toString())?this.Wv.npa("DeferredExitSlideshowDuration",a):this.Wv.npa("ExitSlideshowDuration",a);this.mua.fea(Object(D.a)(this,this.Y6c,"onExitSlideshowHandler"));(this.Gta=b)&&!this.Gta.BCj&&!this.Gta.tGj&&0<this.Gta.slideId&&0<=this.Gta.slideIndex&&this.dek(this.Gta.slideId,this.Gta.slideIndex);this.Fa.Ad();this.EIg?(this.rEa=Mc.a.hm("ExitSlideshow"),this.Af.blockContent(this.Yb.yf,
"ExitSlideshow"),this.ZLg.xk(Object(D.a)(this,this.MZg,"onPageManifestNodePropertyChanged")),this.rEa.Wa("UnlockPodsSessionStartTime",Mc.a.Ye(new Date)),this.unlockPodsSession(c=>{this.rEa&&(this.rEa.Wa("UnlockPodsSessionWithMerge",c.toString()),this.rEa.Wa("UnlockPodsSessionEndTime",Mc.a.Ye(new Date)));c?this.$u.WTi():this.kFe()})):this.kFe()}kFe(a=null){a&&(this.Z1c=null);this.Gta&&(this.EIg&&(this.ZLg.Tm(Object(D.a)(this,this.MZg,"onPageManifestNodePropertyChanged")),this.Af.vO(this.Yb.yf),this.rEa&&
(this.rEa.Wa("InboundPresentationEndTime",Mc.a.Ye(new Date)),this.rEa.finish(),this.rEa=null)),this.Gta=null,this.KA.YUk())}unlockPodsSession(a){const b=lh.a.create().toString();ya.a.J(512499907,830,50,"ViewSwitchingActor.UnlockPodsSession: Unlock Pods session, correlation={0}",b);const c=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",u.AFrameworkApplication.fa.appSettings["361"],this.Xa.podSessionId),f={WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;
f["X-CorrelationID"]=b;f["X-WacCluster"]=this.Xa.Wj;this.Djh(c,f,0,a)}Djh(a,b,c,f){this.Uv.vj(a,2,null,b,!1,2,l=>{this.Srl(l,c,f)},l=>{this.Rzh(l,a,b,c,f)},null,void 0,void 0,void 0,void 0,Ax.a("2"))}Srl(a,b,c){if(b)ya.a.J(512499905,830,50,"ViewSwitchingActor.UnlockPodsSession: Succeed with retry: {0}",b);else{b=!1;try{a.data.Zd&&0<a.data.Zd.length&&(b=JSON.parse(a.data.Zd).FMerged)}catch(f){ya.a.J(512499906,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",
a.toString())}c(b)}}Rzh(a,b,c,f,l){f||l(!1);3>f?this.Djh(b,c,f+1,l):ya.a.J(512499904,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.v_c.bia(a),f)}MZg(a,b){this.Z1c||b.property!==ub.a.v2b||(this.Z1c=new He.a(2,1,0,Object(D.a)(this,this.kFe,"resumeEditor"),90,"65"),this.yb.Gb(this.Z1c))}Mhh(a,b){this.ou.hide();let c=!0,f=!1,l=this.fe.slideShowUrl;l||(l=cg.a.ej(window.document.URL,gg.a.Y2g,gg.a.slideShowView,!0),f=!0);l=cg.a.removeParameter(l,gg.a.Dsk);
l=a?cg.a.ej(l,gg.a.sec,a.sid.toString(),!0):cg.a.removeParameter(l,gg.a.sec);0<b&&(l=cg.a.ej(l,u.AFrameworkApplication.j5c,b.toString(),!0));a=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);b=null;try{b=this.ubc.Lwe(4,l,"SlideShowWindow",a,f,!1)}catch(x){ya.a.J(512499875,818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",x),c=!1}b||(ya.a.J(512499874,818,10,"StartSlideshowFrom:: failed to open slide show window"),
c=!1);Mc.a.hk("Window Opened",c.toString());Mc.a.ykd()}frb(a,b,c){if(2!==c)return this.ia.processAction(G.a.close,c);a=this.ia.processAction(G.a.close,2);32!==a&&(ya.a.J(512499873,801,50,"Close action failed to execute. Response: {0}",a),window.location="about:blank");return 32}dek(a,b){ya.a.J(512499872,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideIndex={0}",b);(a=this.Sb.aCa(a))?this.Ie.wda(a.De):(ya.a.J(512499871,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",
b),a=this.Sb.Nj()-1,b=b>a?a:b,0>b||this.Ie.wda(b))}Gki(){this.P9a.instance&&this.P9a.instance.DRa&&(this.P9a.instance.wFc.DB?this.P9a.instance.endCommentSession(this.P9a.instance.wFc.DB.draftId,7):this.P9a.instance.endCommentSession("",7),this.P9a.instance.rBf())}wvb(){return"Legacy"==this.mua.u2()||this.mua.IFg}Hki(){this.la.powerPointLiveBroadcastEnabled&&hb.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(a=>{a.isFeatureEnabled("PowerPointLivePresentations",
!1).then(b=>{b||(ya.a.J(512499870,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),this.hHg=!0);return null})})}}Object(e.a)(PN,"ViewSwitchingActor",null,[244]);class QN{constructor(a,b){this.TDg=null;this.Xa=a;this.uVa=b;this.sIf();this.Xa.JCf(Object(D.a)(this,this.j8c,"onSessionInfoChanged"))}sIf(){const a=new Sys.StringBuilder;a.append(String.format("?{0}",this.Xa.presentationId.string));a.append(String.format("&{0}={1}",gg.a.M_k,this.Xa.lqb));a.append(String.format("&{0}={1}",
gg.a.Jla,"368"in u.AFrameworkApplication.fa.appSettings?void 0===this.Xa.sessionInfo||null===this.Xa.sessionInfo?"undefined":this.Xa.sessionInfo:this.Xa.sessionInfo));this.Xa.Wj&&a.append(String.format("&{0}={1}",gg.a.Z2g,this.Xa.Wj));this.Xa.podSessionId&&a.append(String.format("&{0}={1}",gg.a.H9,this.Xa.podSessionId));a.append(String.format("&{0}=",gg.a.Csk));this.TDg=a.toString()}j8c(){this.sIf()}resolve(a,b){return b&&b.length?b.startsWith("./"+a)?b:this.uVa+a+this.TDg+b:null}dispose(){this.Xa.YPk(Object(D.a)(this,
this.j8c,"onSessionInfoChanged"))}}Object(e.a)(QN,"ResourceViewElementResolver",null,[300,106]);var XQ=d(1005),YQ=d(932);class RN{constructor(a,b){this.dWc=this.c3=0;this.PJg=null;this.QJg=-1;this.RJg=null;this.Rsa=a;this.tc=b}get Y7d(){return 0<this.dWc}get Vyg(){return this.PJg}Ghk(a){this.dWc++;this.tc.Esh(a.CcpId,a.CcpCorrelation)}get $ae(){return this.RJg}set $ae(a){this.RJg=a}jWg(a,b){if(!a){const c=this.chj(b);c>this.QJg&&(this.QJg=c,this.PJg=b.CcpId)}0<this.dWc?this.dWc--:ya.a.J(20760084,
307,15,"ClipServiceManager - bad state");this.tc.GZf(b.CcpId,a,0)}zOd(a,b,c=!1,f=!1){a=Object.assign(new YQ.a,{XY:32,Fp:lh.a.create().toString(),version:this.c3++,location:this.Rsa.ccpInfo,jE:this.Rsa.Wj||Ap.a.MDh,dataType:a,objectCount:b,VCa:c,TCa:f,Qy:lh.a.create().toString()});ya.a.J(24945860,307,50,"CreateClipServiceObject: A ClipServiceObject was just created for Ccpid: {0}.",a);return a}chj(a){let b=null;a:{var c=a.PackageAccessKey;let l;l=null;if(c)try{const x=fe.a(c);if(x&&"I"in x&&"V"in x){l=
new Us(x.I,parseInt(x.V));var f={returnValue:!0,Qy:l};break a}}catch(x){}f={returnValue:!1,Qy:l}}if(({Qy:b}=f).returnValue&&b)return b.version;ya.a.J(21066257,307,15,"Fail to parse packageAccessKeyString for ccpid: {0}",a.CcpId);return-1}}Object(e.a)(RN,"ClipServiceManager",null,[288]);class SN{constructor(a,b,c,f,l,x,F,R,fa){this.ah=a;this.p8b=c;this.s3c=f;this.Tde=l;this.mu=x;this.tc=F;this.l_=R;this.ia=fa;this.fl=b;this.vca=this.ah.contentWindow.document.body;this.mu.addHandler(this.vca,qa.a.cut,
Object(D.a)(this,this.YWg,"onBrowserCut"));this.mu.addHandler(this.vca,qa.a.copy,Object(D.a)(this,this.XWg,"onBrowserCopy"))}get Jc(){return this.p8b.Jc}dispose(){this.ah&&this.ah.contentWindow&&(this.mu.removeHandler(this.vca,qa.a.cut,Object(D.a)(this,this.YWg,"onBrowserCut")),this.mu.removeHandler(this.vca,qa.a.copy,Object(D.a)(this,this.XWg,"onBrowserCopy")));this.ah=null}YWg(){if(al.bA&&!al.bA.hUd){var a=this.tc.oO(1,0,"OnBrowserCut");this.vqa(Object.assign(new Vs(!0,!0),{Rb:a}))}}XWg(){if(al.bA&&
!al.bA.hUd){var a=this.tc.oO(0,0,"OnBrowserCopy");this.vqa(Object.assign(new Vs(!0),{Rb:a}))}}QM(a){if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&(u.AFrameworkApplication.bO||u.AFrameworkApplication.XI)&&!u.AFrameworkApplication.SOa)return!1;for(let b=0;b<this.fl.length;b++)if(this.fl[b].QM(a))return!0;return!1}vqa(a){if(this.ia.QV)this.l_?(this.l_.show(5,-1),this.tc.Cg(!1,a.Rb,26)):ya.a.J(545047123,826,10,"m_offlineModalCallout is null");
else if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&(u.AFrameworkApplication.bO||u.AFrameworkApplication.XI)&&!u.AFrameworkApplication.SOa)this.tc.Cg(!1,a.Rb,32);else{var b=0,c=!1;for(var f=0;f<this.fl.length;f++)if(this.fl[f].QM(a)){c=!0;this.fl[f].vqa(a)||(b=21);break}switch(a.dataType){case 2:f=2;break;case 1:f=19;break;default:f=0}this.tc.aB(f,a.Rb);if(c){if(a.Trg&&(this.Tde.$eb(this.ah),!a.SOi)){if(!this.s3c){this.tc.Cg(!1,
a.Rb,1);return}this.s3c.copy(this.ah)||0!==b||(b=22)}this.tc.Cg(0===b,a.Rb,b)}else this.tc.Cg(!1,a.Rb,20)}}}Object(e.a)(SN,"CutCopyManager",null,[283,106]);var ZQ=d(885);class TN{constructor(a,b,c){this.PW=a;this.PW.xk(Object(D.a)(this,this.xh,"onPropertyChanged"));this.lL=b;this.lL.xk(Object(D.a)(this,this.xh,"onPropertyChanged"));this.rq=c}xh(a,b){this.rq.Hq&&0<this.rq.Hq.length&&(this.rq.Hq=Pa.a.pna(this.rq.Hq,c=>!(Ga.a.cP(c.id,b.node.id)||Object(Fa.a)(Cv.a,c))));this.rq.Hq&&!this.rq.Hq.length&&
(this.rq.Hq=null)}}Object(e.a)(TN,"GraphNodeChangeListener",null,[]);class UN{constructor(a,b){this.g7b=null;a&&b&&new TN(a,b,this)}get Hq(){return this.g7b}set Hq(a){const b=this.g7b&&0<this.g7b.length?this.g7b[0]:null,c=a?a[0]:null,f=!!b&&!!c&&b.id.equals(c.id)&&b.bEf;this.g7b=a;c&&(c.bEf=f,c.TNf=f&&b?b.TNf:ZQ.a.create().toString())}}Object(e.a)(UN,"InternalClipboard",null,[282]);class VN{constructor(a,b,c,f,l,x,F,R,fa,wa){this.XCg=a;this.kj=b;this.Zca=c;this.mFa=f;this.K8=l;this.Ea=x;this.Dke=
F;this.aJg=R;this.k3j=fa;this.c_c=wa}XHe(a,b,c){this.XCg.XHe(a,b,c);b=new hM.a;this.Dke&&c||(b.setValue(bb.a.bold,!1),b.setValue(bb.a.underline,!1),b.setValue(bb.a.qw,fd.Font.mU),b.setValue(bb.a.strikethrough,!1),b.setValue(bb.a.italic,!1),b.setValue(bb.a.Fs,!1),b.setValue(bb.a.yZ,!1));this.kj.iJe(a,b)}kIe(a,b,c){const f=b.cache;if(this.c_c){var l=this.W0i(b);Ma.a.Va(l)||c?f.propertySet.Sa(bb.a.font)&&(f.sa(ub.a.ARc,!1)||c)&&this.kj.AX(a,f.TM):this.kj.AX(a,l);f.Cra&&this.kj.yr(a,f.fontSize)}else this.XCg.kIe(a,
b,c);(!this.aJg||this.Dke&&c)&&f.B2&&(this.kj.im(a,bb.a.fontColor,f.fontColor),this.aJg&&(l=Re.SchemeColor.create(null,f.fontColor),this.kj.im(a,ub.a.schemeColor,l.toString())));this.Dke&&c&&(this.kj.hJ(a,f.isBold),this.kj.setItalic(a,f.isItalic),this.kj.EX(a,f.bF),this.kj.tfb(a,f.vZ),this.kj.e0(a,f.pD),this.kj.Ima(a,f.qw),this.kj.SXa(a,f.Fs),this.kj.yfb(a,f.yZ),this.kj.L4(a,f.cF),this.kj.GX(a,f.isSuperscript),this.kj.PXa(a,f.En));this.kj.SXa(a,!1);this.k4k(a,b)}AZd(a){return this.Zca.gQa(a)}xV(a){return this.Zca.xV(a)}sQa(a){return this.mFa.sQa(a)}m7(a){return this.K8.m7(a)}k4k(a,
b){b=b.sz;if(null!==b&&b.Sa(ub.a.oHa)){b=b.getValue(ub.a.oHa);var c=a.sz;null===c?this.kj.im(a,ub.a.oHa,b):c.setValue(ub.a.oHa,b)}}bph(a){return this.k3j&&a&&(a=a.paragraph)&&(a=this.Ea.kn(a))&&a.Qf?!0:!1}W0i(a){if(!this.c_c||!a)return null;let b="";var c=a.paragraph;if(!c)return null;var f=this.Ea.kn(c);if(!f)return null;a=f.sa(Bb.a.HZ,[]);c=c.sa(Bb.a.listLevel,Sg.a.vCa);a&&0<=c&&c<a.length&&(f=f.Ch)&&(a=f.re(a[c]))&&(a.Sa(ub.a.zQd)?b=a.getValue(ub.a.zQd):a.Sa(ub.a.wQd)?b=a.getValue(ub.a.wQd):a.Sa(ub.a.tQd)?
b=a.getValue(ub.a.tQd):a.Sa(ub.a.DQd)&&(b=a.getValue(ub.a.DQd)));return b}}Object(e.a)(VN,"PPTFormattingStewardBridge",null,[256]);class WN{constructor(a,b,c,f){this.rc=c;this.Qz=f}}Object(e.a)(WN,"PPTFormattingStewardHelper",null,[265]);class XN{constructor(a,b,c,f,l){this.L5j=[Bb.a.Il,Bb.a.Mn];this.la=a;this.Gwb=b;this.BGg=c;this.DN=f;this.Mb=l;this.b_c=a.jvg;this.ota=a.pptCopyPasteListMarkerEnabled;this.c9b=a.pptCopyPasteMarginAndIndentationEnabled}lRe(a){return this.Gwb.XJj(a)}Q2d(a,b){return this.Gwb.EMi(a,
b)}Gma(a,b,c,f=null,l=null){if(this.BGg.t9c)if(this.Gwb.wsg(c))a.setValue(be.a.Gsg,!0);else if(this.Gwb.Lk(c)){if(this.c9b&&a&&b){var x=this.Mb.Kc(a);x.mc(11);x.Ng(11);c=Ib.ListReader.ak(x);const F=this.DN.a1i(a,x);x=this.DN.X0i(a,x);c&&(f||(ya.a.J(41219841,826,50,"Default marginLeft for internal"),b[Bb.a.Il.id.toString()]=F),l||(ya.a.J(41219843,826,50,"Default textIndent for internal"),b[Bb.a.Mn.id.toString()]=x));f&&ya.a.J(41018240,826,50,"Customized marginLeft");l&&ya.a.J(41018242,826,50,"Customized textIndent")}this.BGg.Gma(a,
b)}if(this.la.qSc&&!Ya.ParagraphReader.MV(a))for(const F of this.L5j)void 0===a.Sh(F)&&a.ke(F,0)}dGb(a,b,c){if(this.b_c){var f=b.propertySet.Sa(bb.a.Ni)?b.propertySet.getValue(bb.a.Ni).length:1;if(a=this.DN.vP(a,b.propertySet.sa(Bb.a.listLevel,0)))if(this.ota&&(0<c.Wnb||c.ENa&&0<c.ENa.length)){f="";b.l7a&&!b.$ig&&(f=c.font);let l=null;c.ENa&&0<c.ENa.length&&(l=c.ENa,1===c.ENa.length&&ya.a.J(41219847,826,50,"Customized bullet."));let x=-1;0<c.Wnb&&(x=c.Wnb,ya.a.J(41219849,826,50,"Customized number list."));
this.DN.qEc(a,b.propertySet);l&&b.propertySet.setValue(bb.a.Ni,l);Ma.a.Va(f)||b.propertySet.setValue(bb.a.font,f);0<x&&b.propertySet.setValue(ub.a.autonumberBulletType,x)}else a.sa(bb.a.Ni,[]).length===f&&this.DN.qEc(a,b.propertySet)}}cSc(a){return this.Gwb.cSc(a)}get XSc(){return this.Gwb.XSc}c0(a,b){2===b.Pf?(a.setValue(ub.a.ZV,2),a.setValue(ub.a.Nw,b.value)):ya.a.J(36779851,826,50,"the un-support text spacing unit")}hIa(a,b){b.beforeSpacing.value&&(a.setValue(ub.a.lca,b.beforeSpacing.value),a.setValue(ub.a.mja,
4));b.afterSpacing.value&&(a.setValue(ub.a.kca,b.afterSpacing.value),a.setValue(ub.a.lja,4))}jmh(a,b){const c=(new Zu.a(b.Pf,b.value)).ZL;1===b.specialIndentType?a.setValue(Bb.a.Mn,c):2===b.specialIndentType?a.setValue(Bb.a.Mn,-c):0===b.specialIndentType&&a.setValue(Bb.a.Mn,0)}alh(a,b){b=(new Zu.a(b.Pf,b.value)).ZL;a.setValue(Bb.a.Il,b)}get eph(){return!0}}Object(e.a)(XN,"PPTPasteStewardBridge",null,[263]);class YN extends Xu{constructor(a,b){super(a,b)}iKc(){return["PasteSlide"]}}Object(e.a)(YN,
"PasteSlideReactFloatie",Xu,[]);class ZN{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd,Pe,Ue){this.Aig=!1;this.tQ=[];this.Z$b=[];this.hde=[];this.Ffe=0;this.yc=c;this.ra=f;this.Mbb=l;this.Kbb=x;this.Uka=F;this.gd=R;this.fne=Wd;this.od=a;this.w9j=b;this.Bk=Xa;this.A6j=fa;this.Yb=lb;this.Fa=Lb;this.rr=kc;this.q1j=lc;this.i1j=Ec;this.Xb=Jc;this.SNg=Dc;this.$b=xe;this.E6j=Sd;this.ah=Ue;this.Q9a=hb.a.instance.pb("Common.IReactContextualUILauncher");this.txb=hb.a.instance.pb("Common.IExternalUICommandDefinitionMapping")}B9(a){2===
a.behavior&&(a=a.actionId,a!==ba.a.y3a&&a!==ba.a.DNa&&a!==ba.a.oGa&&a!==ba.a.kla&&a!==ba.a.Mpa&&a!==ba.a.bS&&a!==ba.a.insertPicture&&a!==ba.a.oGa&&a!==ba.a.G5a&&a!==ba.a.mWd&&a!==ba.a.MJc&&a!==ba.a.insertPicture&&a!==ba.a.lWd&&a!==ba.a.P4g&&a!==ba.a.v9c||this.LM(new bc(!0)))}z9(){}b1h(){this.fne&&!this.Aig&&(this.ra.XJ(Object(D.a)(this,this.IGa,"onSelectionChange")),this.w9j.Bd(7).$F(Object(D.a)(this,this.UA,"onChildTopologyChanged")),this.od.Dza(Object(D.a)(this,this.F9,"onThumbnailDrawCompleted")),
yd.a.addHandler(this.Uka.jX,"scroll",Object(D.a)(this,this.yXa,"scrollHandler")),yd.a.addHandler(this.ah.contentWindow.document.body,qa.a.eg,Object(D.a)(this,this.onKeyDown,"onKeyDown")),this.gd.ob(qa.a.click,this.Uka.jX,Object(D.a)(this,this.bD,"clickHandler")),u.AFrameworkApplication.Aa.Lga(Object(D.a)(this,this.iea,"resizeHandler")),this.A6j.P2a(Object(D.a)(this,this.G_,"onSlidePresenceChanged")),this.Bk.PCf(Object(D.a)(this,this.kwe,"onSlidesIdReturned")),this.q1j.Ozc(Object(D.a)(this,this.f8c,
"onRevisionProcessedOnServerHandler")),this.i1j.y3h(Object(D.a)(this,this.Phk,"onBlockingHandler")),this.E6j.DCf(Object(D.a)(this,this.emk,"onOnlyKeyPressed")),this.Aig=!0)}emk(){if(cN.a.instance.keyCode===w.a.$ea){const c=document.getElementById("PasteSlideControl");if(c){var a=kb.a.Yh(c),b=this.SNg.ya.style.height;a.y+a.height+61+2<parseInt(b.substr(0,b.length-2))+Fz.a.ZRe?ya.a.J(512497815,826,10,"recoveryUIElement rendering to wrong place"):(a=c.getAttribute(Uc.a.wnb)||"",Uc.a.Bpa===a&&c.click())}else ya.a.J(512497816,
826,10,"recoveryUIElement is null")}}onKeyDown(a){a.keyCode===w.a.B0&&this.LM(new bc(!0))}Phk(a,b){1===b.block?this.LM(null):2===b.block&&this.LM(new bc(!0))}f8c(a,b){b&&(a=b.P9)&&a.ActionInformation.ActionId!==""+ba.a.y9c&&a.ActionInformation.ActionId!==""+ba.a.xec&&a.ActionInformation.ActionId!==""+ba.a.x9c&&this.rr.NUc&&this.rr.NUc<parseInt(a.ActionInformation.ActionTime)&&this.LM(new bc(!0))}G_(a,b){this.b3f(b.slideId.sid,this.tQ)&&(this.LM(new bc(!0)),this.rr.dgb=!1)}b3f(a,b){for(const c of b)if(c.sid===
a)return!0;return!1}kwe(a,b){if(b&&b.SVa){if(this.hde.length>=b.SVa.length&&!this.Q9a.yub&&(this.setSelection(b.SVa),this.tQ.length===b.SVa.length)){this.showFloatie({},new wk(1,u.AFrameworkApplication.isRtl));let c;(c=this.ra).L2a.apply(c,this.tQ)}this.rr.TGa.length||(this.rr.TGa=b.SVa,Array.clear(this.tQ),Array.clear(this.Z$b))}}IGa(a,b){if(this.rr.dgb){for(a=0;a<b.OD.length;a++)if(Object(va.a)(4,b.OD[a].context.node)){this.LM(new bc(!0));return}!this.Fa.ye||this.Fa.ye.name!==xi.a.B1&&this.Fa.ye.name!==
xi.a.sJf&&this.Fa.ye.name!==xi.a.pJf&&this.Fa.ye.name!==Nc.a.WD&&this.Fa.ye.name!==Nc.a.vK&&this.Fa.ye.name!==Nc.a.hZ||this.LM(new bc(!0))}}iea(){this.Q9a.yub&&this.LM(new bc(!1))}yXa(){this.W$g()}bD(){this.W$g();return!0}W$g(){if(this.rr.dgb){const a=new wk(1,u.AFrameworkApplication.isRtl);this.showFloatie(null,a)}}F9(a,b){a=this.rr.TGa;this.hde.push(b.Nd);if(!this.Q9a.yub&&this.rr.dgb&&a&&a.length>=this.Z$b.length&&b.succeeded)for(var c of a)if((b=this.yc.$k(new oe.a(c)))&&!this.b3f(b.sid,this.Z$b)&&
(this.Z$b.push(b),this.Ffe++,b=a.length,this.Ffe===b)){this.ra.pXb();this.setSelection(a);var f=void 0;(f=this.ra).L2a.apply(f,this.tQ);if(c=this.j3i())this.Yb.Ba=c;this.Ffe=0;c=!0;for(f=0;f<b;f++)(a=this.tQ[f].Ag(this.Mbb))&&a.BDb&&a.BDb.gia()&&0<a.BDb.gia().length&&(c=!1);c&&this.showFloatie({},new wk(1,u.AFrameworkApplication.isRtl));break}}j3i(){let a=this.tQ.length;if(!a&&(this.setSelection(this.rr.TGa),a=this.tQ.length,!a))return ya.a.J(512497814,826,50,"GetLastPastedSlideNode and selectedNode is empty"),
null;let b=this.tQ[0];for(let c=1;c<a;c++)b.slideIndex>this.tQ[c].slideIndex&&(b=this.tQ[c]);return b}setSelection(a){if(a&&a.length){Array.clear(this.tQ);for(const b of a)(a=this.yc.$k(new oe.a(b)))?this.tQ.push(a):ya.a.J(512497813,826,50,"Cannot find the slide")}}G5i(){let a=this.tQ.length;if(!a&&(this.setSelection(this.rr.TGa),a=this.tQ.length,!a))return ya.a.J(512497812,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;ya.a.J(512497811,826,50,String.format("Pasted slides count is: {0} ",
a));let b=this.tQ[0];for(let c=1;c<a;c++)b.slideIndex<this.tQ[c].slideIndex&&(b=this.tQ[c]);return b}showFloatie(a,b){b.location=this.FLc();if(b.location){const c=this.Xb.Zc(this.yc.An);if(!c||c&&a)ya.a.J(512497810,826,50,"ShowFloatie number"),this.$b.ka("ReactSlidePasteFloatieEnabled")&&(new YN(this.Q9a,this.txb)).Rph(b.location,b.Uu),Array.clear(this.hde)}}LM(a){this.Q9a.yub&&(this.Q9a.LM(),a&&(this.rr.dgb=!a.v2f,a.v2f&&this.rr.kdb&&(a=this.rr.kdb.Sy,null!=a&&ya.a.J(512497809,826,50,String.format("last user selcted keepSource:{0}",
a.toString()))),this.rr.dgb||(this.rr.NUc=0)))}Fpi(a){if(!this.rr.SWb)return!0;a=a.LL;if(a.length!==this.rr.SWb.length)return!0;let b=0;for(let c=0;c<a.length;c++)if(a[c]&&!a[c].equals(this.rr.SWb[c])||!a[c]&&this.rr.SWb[c])if(b++,b>this.Z$b.length)return!0;return!1}UA(a,b){this.Q9a.yub&&(a=Object(va.a)(404,b.node))&&this.Fpi(a)&&this.LM(null)}FLc(){var a=this.G5i();if(!a)return ya.a.J(512497808,826,50,null),null;a=a.Ag(this.Mbb);if(!a)return ya.a.J(512497807,826,50,null),null;a=kb.a.Yh(a.nIb);const b=
a.x+a.width-86;let c=a.y+a.height+61+2;const f=this.Kbb.ya.style.height;var l=this.SNg.ya.style.height;l=parseInt(l.substr(0,l.length-2))+Fz.a.ZRe;if(c>parseInt(f.substr(0,f.length-2))+l)c=c-a.height/2-2;else if(c<l)return this.LM(new bc(!1)),null;this.rr.position=new Sys.UI.Point(b,c);return this.rr.position}}Object(e.a)(ZN,"PasteFloatieHelper",null,[264,156]);class LE{constructor(){this.dgb=!1;this.NUc=0;this.kdb=null;this.zxe=0;this.Fab=[];this.position=this.SWb=null}get TGa(){return this.Fab}set TGa(a){a?
this.Fab=a:Array.clear(this.Fab)}}Object(e.a)(LE,"PasteFromFloatieArgs",null,[]);var $Q=d(1004);class $N{d3b(a){a=a.Xaa;return a===Nc.a.yg||a===Nc.a.dE}}Object(e.a)($N,"PasteHandlerUtil",null,[286]);class aO{constructor(a,b,c,f,l,x){this.SS=0;this.ia=a;this.w3=b;this.nFa=c;this.Pw=f;this.Uje=l;this.t2j=x}QM(a){if(!this.nFa.d3b(this.w3.value))return!1;if(this.Pw.vCj(a)){a=Array.isArray(a.tS)?a.tS:null;if(this.rqj(a)&&!this.Qqj(a))return!1;this.SS=1}else if(this.Uje&&(this.Pw.tCj(a)||this.Pw.sCj(a))){a=
this.Pw.$7d(a.rt);if(!this.t2j&&a)return Z.ULS.sendTraceTag(36558551,307,50,"Cross-dc shape pasting is not allowed since its BRS is off."),this.SS=0,!1;this.SS=2}else this.SS=0;return 0!==this.SS}paste(a){1===this.SS?this.ia.Ka(ba.a.u9c,2,a):2===this.SS&&this.ia.Ka(ba.a.B3g,2,a)}rqj(a){for(const b of a)if(!b.isConnected)return!0;return!1}Qqj(a){for(const b of a)if(a=b.shapeNode,!a.qk&&!a.nd)return!0;return!1}}Object(e.a)(aO,"ShapePasteHandler",null,[458]);class bO{constructor(a,b,c){this.SS=0;this.ia=
a;this.Pw=b;this.I8b=c}QM(a){this.Pw.lrg(a)?this.SS=1:this.I8b&&this.Pw.uCj(a)?this.SS=2:this.SS=this.Pw.xCj(a)?3:0;return 0!==this.SS}paste(a){a.Sy=null!=a.Sy?a.Sy:!0;ee.a("UseClipServiceForDestinationThemePaste")&&1===this.SS&&!a.Sy&&a.rt&&(this.SS=2);1===this.SS?this.ia.Ka(ba.a.v9c,2,a):2===this.SS?(a.rt?ya.a.J(512356509,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams keepsource value {0}",a.Sy):ya.a.J(512356508,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams is null"),
this.ia.Ka(ba.a.x9c,2,a)):3===this.SS&&this.ia.Ka(ba.a.D3g,2,a)}}Object(e.a)(bO,"SlidePasteHandler",null,[458]);class ME{constructor(a,b,c,f){this.CEg=[Xe.a.Jkg,Xe.a.dIb,Xe.a.bvh,Xe.a.Yid];this.ia=a;this.Fa=b;this.nFa=c;this.Pw=f}QM(a){if(!this.nFa.d3b(this.Fa)||ME.qKj(a)||this.Pw.IPj(a))return!1;a.QM=!this.Osi(a.Cm);return a.QM}Osi(a){for(let b=0;b<this.CEg.length;++b)if(0<a.getElementsByTagName(this.CEg[b]).length)return!0;return!1}paste(a){ya.a.J(17310408,826,50,"TextPasteHandler: Execute command to paste text as new shape.");
this.ia.Ka(ba.a.Dxe,2,a)}static qKj(a){if(!a||!a.Cm)return ya.a.J(17310404,826,15,"TextPasteHandler: User attempted to paste null content."),!0;a=Ca.b(a.Cm);return a&&a.length?!1:(ya.a.J(17310406,826,15,"TextPasteHandler: User attempted to paste empty content."),!0)}}Object(e.a)(ME,"TextPasteHandler",null,[458]);var aR=d(864),bR=d(933),cR=d(431),hA=d(662);class cO{constructor(a,b){this.rva=a;this.pastedContent=b}}Object(e.a)(cO,"PasteContext",null,[]);class dO{constructor(a){this.Cle=0;this.DAb=null;
this.K8j=a;this.Cbb=this.K8j.ZAb("UserAction","TimingLogger");this.reset()}start(){this.reset();this.Cbb.start()}FSb(a){if(a&&0<a.length){this.DAb||(this.DAb={});const b=this.Cbb.Dq;this.DAb[a]=b-this.Cle;this.Cle=b}}flush(a=null){let b="";a&&0<a.length&&(b=a+":");if(this.DAb){a=this.DAb;for(let c in a)b+=String.format(" {0}={1}ms,",c,a[c])}0<b.length&&ya.a.J(20570128,826,50,b);this.reset()}reset(){this.Cle=0;this.DAb=null}}Object(e.a)(dO,"TimingLogger",null,[]);class $p{constructor(){this.objectCount=
0;this.data=this.ccpid=null;this.contentType=this.dataSize=this.errorInCopying=0;this.packageSize=this.packageKey=this.isDataCompressed=null;this.skipUndo=!1;this.selectionSlide=null}static izi(a){if(!a)return null;a=a.getData($p.zfi);return $p.Olg($p.R$g(a))}static jzi(a){return a?$p.Olg($p.R$g(a.pptSlide)):null}static Olg(a){if(!a||0===a.contentType)return ya.a.J(541405764,826,15,"InitPicklingClipboardObject mimetype not supported"),null;a.dataSize=a.data?a.data.length/$p.ufi:Number.MAX_VALUE;a.skipUndo=
!1;ya.a.J(540932290,826,50,"InitPicklingClipboardObject successful ccpid: {0}, datasize: {1}, objectCount: {2}, errorCode: {3}",a.ccpid,a.dataSize,a.objectCount,a.errorInCopying);return a}static OPj(a){return!!a&&0<a.objectCount&&!!a.ccpid&&(!!a.data||!a.data&&!!a.errorInCopying)&&null!=a.isDataCompressed}static R$g(a){try{let b=null;if(!a)return null;b=JSON.parse(a);if($p.OPj(b))return b.contentType=1,b.errorInCopying=void 0===b.errorInCopying||null===b.errorInCopying?0:b.errorInCopying,b}catch(b){ya.a.J(541405765,
826,15,"ReadPicklingData exception occured in parsing")}return null}}$p.ufi=1048576;$p.zfi="ppt/slides";Object(e.a)($p,"PicklingClipboardObject",null,[]);var dR=d(663);class gh{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd,xe,Sd){this.Mke=!1;this.PMg=0;this.RUa=null;this.xac=!1;this.Ble=null;this.Fke=!1;this.w3=a;this.ah=b;this.rq=c;this.F9a=l;this.la=f;this.fl=x;this.mu=F;this.vca=this.ah.contentWindow.document.body;this.mu.addHandler(this.vca,qa.a.paste,Object(D.a)(this,this.$Wg,
"onBrowserPaste"));this.Kd=R;this.vo=fa;this.A8b=Lb;this.Wka=new dO(wa);this.wja=lb;this.n$b=null;this.L3j=f.AOj;this.mJg=this.vo.jN(7);this.Pw=Xa;this.NS=kc;this.kW=lc;this.Ea=Jc;this.rc=Ec;this.tc=Dc;this.l_=Wd;this.ia=xe;this.mme=f.pptEditingImageMaxSizeInBytes;this.SKg=Math.floor(f.pptEditingImageMaxSizeInBytes*gh.qHf);this.dIg=f.qrg;this.I8b=f.J7d;this.l2j=f.rDj;this.ROg=f.ALj&&this.vo.PV;this.ble=this.m_c=!1;this.Uje=f.I7d;this.rIg=f.ysg&&this.vo.$n;this.a8j=f.k4i&&this.vo.$f;this.GYj=f.pptCopyPasteRotateImageOnSafariFixIsEnabled&&
this.vo.osa;this.G2j=this.la.VFj;this.eQ=Sd}dispose(){this.ah&&this.mu.removeHandler(this.vca,qa.a.paste,Object(D.a)(this,this.$Wg,"onBrowserPaste"));this.Wka=this.ah=null}Otk(a){a===this.Ble.Rb&&this.ia.Ka(ba.a.wec,2,this.Ble)}$Wg(a){const b=this.tc.oO(2,0,"OnBrowserPaste");this.Wka.start();this.m_c=this.Fke=!1;if(al&&al.bA&&!al.bA.hUd){!this.vo.dF||this.vo.Hj||this.GYj?Xe.a.VCc(this.ah):this.F9a.$eb(this.ah);var c=this.kW.wba(a);c=this.Pw.YSc()?$p.izi(c):null;var f=new rE;f.aSd=a;f.s6g=b;null!=
this.RUa&&(this.tc.Rh(gh.AJf,"menu",b),this.tc.Rh(gh.yJf,this.RUa?gh.Dfi:gh.Bfi,b));this.xac&&(this.tc.Rh(gh.AJf,"menu",b),this.tc.Rh(gh.yJf,gh.Cfi,b));!this.xac&&c&&this.q3g(c,null,b,ba.a.w9c,f)?this.RUa=null:(this.p3g(a,b),this.RUa=null,this.xac=!1)}}p3g(a,b){const c=this.kW.wba(a),f=this.kW.Z0f(c);this.tc.hJe(f,b);if(!this.fpl(a,b)){var l=Object.assign(new Rm.a(!0),{Rb:b,Sy:this.RUa});this.a8j&&(ya.a.J(512356507,826,50,"OnBrowserPaste::Getting html data from Clipboard"),a=this.kW.OLc(c),b=this.kW.rWa(a),
a?(this.DMf(b)&&(this.rq.Hq[0].L3a=b.firstChild.className,l.tS=null),l.Cm=b):ya.a.J(512356506,826,15,"OnBrowserPaste::htmlString is empty"));this.Ble=l;Mc.a.Z9(()=>{this.Ote(void 0,l)},0,this.la.UJj?0:2)}}kki(a){let b=!1;al.bA.E3a(c=>{ya.a.J(512356505,826,50,"CheckAndEnablePasteAsOptions: isAccessible : {0}",c);null!=c&&c&&(b=this.rki(a))});return b}rki(a){const b=Date.now();let c=!1;al.bA.wba(this.ah,a,f=>{ya.a.J(512356504,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, time taken : "+
(Date.now()-b));if(f){if(!a)f.html&&f.html.length<=gh.rgi?-1!==f.html.indexOf(gh.Lgi)&&(c=!0):f.pptSlide&&f.pptSlide.length&&(c=!0);else if(f.img||f.isImageAvailable)c=!0;c&&(f=[],a?(f.push(appChrome.actions.updateControlEnabledDisabledState(gh.Fgi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(gh.Egi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(gh.Dgi,!1))):(f.push(appChrome.actions.updateControlEnabledDisabledState(gh.Vfi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(gh.Ngi,
!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(gh.Xfi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(gh.Pgi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(gh.Wfi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(gh.Ogi,!1))),appChrome.api.dispatch(f));ya.a.J(512356502,826,50,"CheckClipboardDataAndEnablePasteAsOptions: isCopiedDataCompatible={0}, time taken : {1}",c,Date.now()-b)}else ya.a.J(512356503,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, clipboardObject is null")});
return c}q3g(a,b,c,f,l){b||(b=Object.assign(new Rm.a(!0),{Rb:c,Sy:this.RUa}));b.VI=a;this.tc.Rh(gh.objectCount,a.objectCount.toString(),c);this.tc.Rh(gh.isDataCompressed,null==a.isDataCompressed?!1:a.isDataCompressed.toString(),c);this.tc.Rh(gh.Ggi,(b.VI.packageSize?null==b.VI.packageSize?0:b.VI.packageSize/gh.qHf:b.VI.dataSize).toString(),b.Rb);return 0!==b.VI.errorInCopying?(ya.a.J(541647952,826,15,"PastePicklingData invalid package ccpid: {0}, objectCount: {1}, error: {2}",b.VI.ccpid,b.VI.objectCount,
b.VI.errorInCopying),this.Pph(b.VI.errorInCopying,f,l,b),!0):this.Pw.vKj(b.VI.dataSize)?this.FRd(b):(ya.a.J(541647953,826,15,"PastePicklingData package size exceeds limit ccpid: {0}, size: {1}, objectCount: {2}",b.VI.ccpid,b.VI.dataSize,b.VI.objectCount),this.Pph(1,f,l,b),!0)}Pph(a,b,c,f){switch(a){case 1:this.tc.Cg(!1,f.Rb,27);this.eQ.twa(ResourceStrings.l_PasteAsImageErrorCalloutTitle,ResourceStrings.l_PasteAsImageErrorCalloutMessage,!0,ResourceStrings.l_PasteAsImageButtonTitle,!0,CommonUIStrings.l_DialogCancel,
b,0,c,null,!1,gh.zJf);break;default:this.tc.Cg(!1,f.Rb,28),this.eQ.twa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,gh.zJf)}}w9c(a,b){ya.a.J(512356499,826,50,"PasteSlideAsImage called");const c=this.tc.oO(2,0,"PasteSlideAsImage");this.tc.Rh("PasteSlideAsImage",b,c);this.Wka.start();this.m_c=this.Fke=!1;this.p3g(a,c)}sli(a){a=a.split("+");const b=this.rc.Sg(this.rq.Hq[0].Nd).Bb;return b.cid.toString()===a[0]&&b.sid.toString()===
a[1]}fpl(a,b){let c=!1,f=this.xac;const l=a.rawEvent;var x=this.kW.DXd(l,this.ah.contentWindow);if(x){let F=null;({o2b:F,wVg:x}=this.kW.Dkd(x,this.la.clipboardDataImageBlobNumberLimitaton,this.dIg?50*gh.NFh:this.SKg));this.Wka.FSb("GetBlob");0<x&&(ya.a.J(512356498,826,50,"Blob is too large"),l.clipboardData=null,this.hhd(b),c=!0);F&&1===F.length&&(Mc.a.Z9(()=>{this.Yhi(F,b,f)},0),this.ROg&&a.preventDefault(),c=!0)}else this.L3j&&this.mJg&&(this.n$b=this.wja.Lpl(a.rawEvent));c&&this.tc.aB(5,b);return c}Yhi(a,
b,c){if(c||a&&(this.kW.$ld(this.vca)||this.ROg)){const f=a[0],l=Mc.a.Cb;Mc.a.hk(ri.a.Rbi,f.size.toString());this.dIg&&f.size>=this.SKg?(this.ble&&ya.a.J(512356497,826,50,"Ctrl-v pressed while shrinking image"),this.A8b.eAg(f,x=>{Mc.a.LE(l,()=>{x&&this.udl(x,f.size,b)||(this.m_c=!0,this.Ote(b));this.ble=!1})}),this.ble=!0):(new aR.a).cyh(a,x=>{Mc.a.LE(l,()=>{this.G4i(x,b)})})}else this.Ote(b)}G4i(a,b){this.Wka.FSb("GetDataUrl");this.qql(a,b)||(ya.a.J(512356496,826,15,"Paste image data uri failed"),
this.paste(Object.assign(new Rm.a(!0),{Rb:b}),null,!1))}Ote(a="",b=null){this.paste(b||Object.assign(new Rm.a(!0),{Rb:a}),null,!1)}Ytk(a,b){if(al.bA){ya.a.J(512356495,826,50,"PasteManager::PastePicklingData called ccpCorrId: {0}",a.Rb);var c=Date.now();al.bA.wba(this.ah,a.kPa,f=>{a.kPa&&(f.html=null,f.pptSlide=null,f.text=null);this.iVj(f,c);if(f=$p.jzi(f)){var l=new sE;l.pastedContent=b;l.rva=a;this.q3g(f,a,a.Rb,ba.a.C3g,l)}else this.paste(a,b,!0)})}}iVj(a,b){if(a){var c=a.img?a.img.length:0,f=a.html?
a.html.length:0,l=a.text?a.text.length:0;a=a.pptSlide?a.pptSlide.length:0;ya.a.J(512356493,826,50,"LogClipboardObjectLength:: timeTaken: {0}, imgLength: {1}, htmlLength: {2}, textLength: {3}, pptSlideLength: {4}",Date.now()-b,c,f,l,a)}else ya.a.J(512356494,826,50,"clipboardObject is null")}paste(a,b,c){if(this.ia.QV)this.l_.show(5,-1),this.tc.Cg(!1,a.Rb,26);else if(a.eUd)this.R2d(a,b);else if(al.bA){var f=this.vo.yS&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix");this.la.iRc&&!f||this.rIg?
(a.VI=null,this.Pw.YSc()&&!c?this.Ytk(a,b):(ya.a.J(512356492,826,50,"Paste::m_isEdgeContextMenuPasteFixEnabled {0} or IsChromeClipboardAccessEnabled: {1} is enabled",this.rIg,this.la.iRc),this.OFe(a,b))):(this.RUa=a.Sy,this.xac=a.kPa,this.Pw.YSc()&&al.bA.zol(this.ah,a.Rb)?(this.tc.Rh(gh.guk,"true",a.Rb),this.tc.Cg(!0,a.Rb)):(this.RUa=null,({content:b}=al.bA.paste(this.ah,this.w3.value,a.Rb,!1)).returnValue?this.R2d(a,b):(al.bA.lba(!1),b=al.bA.Bx,null==b?(a=new wc.a(null,Object(D.a)(this,this.jPi,
"fWaitForAsyncAPIResult"),Object.assign(new xE,{ld:a.Rb})),a.xl("ClipboardPreProcessForAsyncAPI"),a.run()):null!=b&&b&&this.OFe(a,null))))}else this.tc.Cg(!1,a.Rb,1)}jPi(a,b){a=al.bA.Bx;if(null==a)return!0;b=b.ld.toString();a?this.OFe(Object.assign(new Rm.a(!1),{Rb:b}),null):this.tc.Cg(!1,b,29);return!1}OFe(a,b){this.PMg=Date.now();this.Mke=!1;al.bA.prepareForPaste(a.kPa,c=>{this.tc.Rh("isPasteFromAsyncApi",c.toString(),a.Rb);this.Mke=!0});b=new cO(a,b);(new wc.a(null,Object(D.a)(this,this.prepareForPaste,
"prepareForPaste"),b)).run()}Bxe(a,b){return a&&0<a.length?(a=Object.assign(new Rm.a(!0),{Rb:b,KPc:a,SYb:!0}),this.FRd(a),!0):!1}prepareForPaste(a,b){a=!0;let c=!1;if(this.Mke){let f;({content:f}=al.bA.paste(this.ah,this.w3.value,b.rva.Rb,b.rva.kPa)).returnValue&&f?this.R2d(b.rva,f):c=!0;a=!1}else Date.now()-this.PMg>this.la.MMf&&(ya.a.J(512356491,826,50,null),a=!1,c=!0,al.bA.reset());c&&this.tc.Cg(!1,b.rva.Rb,29);return a}get h9k(){return this.vo.xj&&this.la.ZCj}R2d(a,b){if(!a.Cm)if(ya.a.J(512356490,
826,50,"HandlePasteContent::pasteParams.PastedHtml is empty"),!b||a.T9d&&this.h9k)if(this.K9k()){b=Xe.a.CB();b.src=this.n$b;this.n$b=null;var c=Xe.a.Ee();c.appendChild(b);a.Cm=c}else this.DMf(this.vca)&&(ya.a.J(512356488,826,50,"HandlePasteContent::CheckWhetherFixClipboardId is true"),this.rq.Hq[0].L3a=this.vca.firstChild.className,a.tS=null),ya.a.J(512356487,826,50,"HandlePasteContent::Using m_body for PastedHTML."),a.Cm=this.vca;else ya.a.J(512356489,826,50,"HandlePasteContent::Paste not from IFrame Clipboard or !ShouldGetPastedContentFromClipboardTargetDOM"),
c=Xe.a.Ee(),bR.a.xfd(c,b,"PasteManager"),a.Cm=c;this.TJd(a);b=this.Pw.nFj(a.Cm.firstChild);c=this.Pw.qFj(a.Cm.firstChild);if(b||c)ya.a.J(512356486,826,50,"HandlePasteContent:pasteParams.PastedHtml is empty clipboard {0} / empty placeholder {1}",b,c),this.tc.Cg(!0,a.Rb);else if(this.rSi(a.Cm),b=a.Cm.innerHTML.startsWith("<img"),c=a.Cm.innerHTML.length,a.eUd&&b&&(this.Wka.FSb("ConvertDataUrlToDOMNode"),this.Wka.flush(String.format("Browser={0}, Length={1}, IsFromBlob={2}",this.vo.iy,c,this.Fke))),!c&&
this.m_c)this.hhd(a.Rb);else{var f=0,l=!1;({rMd:f,kUd:l}=this.dpl(a));1===f?(ya.a.J(512356485,843,15,"Failed to attach clipServiceObject due to deferred content, IsSlidePaste: {0}",l),this.tc.Cg(!1,a.Rb,25)):!a.tS&&!a.rt&&c>this.mme?(ee.a("PasteManagerOacr73010Fix")?(this.ah.contentWindow.document.body.innerText="",a.Cm.innerText=""):(this.ah.contentWindow.document.body.innerHTML=null,a.Cm.innerHTML=null),b?(ya.a.J(512356484,826,50,"Image too large"),this.hhd(a.Rb)):(ya.a.J(512356483,826,50,String.format("Paste content size is {0} which is too big.",
c)),this.tc.Cg(!1,a.Rb,7))):(a.rt?(ya.a.J(512356482,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams keepsource value {0}",a.Sy),this.tc.Rh(Ap.a.Fp,a.rt.Fp,a.Rb)):ya.a.J(512356481,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams ClipServiceObject is null"),this.FRd(a))}}TJd(a){a?a.Cm?a.Cm.firstChild?a.Cm.firstChild.getAttribute||ya.a.J(512356449,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild.getAttribute is null"):ya.a.J(512356450,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild is null"):
ya.a.J(512356451,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml is null"):ya.a.J(512356480,826,50,"BuildDiagnosticInfo:pasteParams is null")}DMf(a){if(!(this.l2j&&a.firstChild&&a.firstChild.tagName&&"A"===a.firstChild.tagName.toUpperCase()&&a.firstChild.getAttribute(Ap.a.type)&&a.firstChild.getAttribute(Ap.a.Tfb)&&this.rq.Hq))return!1;const b=a.firstChild.className;return a.firstChild.getAttribute(Ap.a.sessionId).toString()===this.rq.Hq[0].sessionId&&b.startsWith("CID")&&b!==this.rq.Hq[0].L3a&&
(Object(Fa.a)(hA.a,this.rq.Hq[0])&&"shape"===a.firstChild.getAttribute(Ap.a.type).toString()&&this.qli(a.firstChild.getAttribute(Ap.a.Tfb).toString())||Object(Fa.a)(Cv.a,this.rq.Hq[0])&&"slide"===a.firstChild.getAttribute(Ap.a.type).toString()&&this.sli(a.firstChild.getAttribute(Ap.a.slideId).toString()))}qli(a){a=a.split(",");let b=0;if(a.length!==this.rq.Hq.length)return!1;for(const c of a)for(const f of this.rq.Hq)if(c===this.Ea.Gsb(f.shapeNode).toString()){b++;break}return b===a.length}FRd(a){let b=
!1;for(let c=0;c<this.fl.length;c++)if(this.fl[c].QM(a)){b=!0;this.fl[c].paste(a);break}b||this.tc.Cg(!1,a.Rb,19);return b}udl(a,b,c){if(a){const f=new dR.a("ShrinkImage",!0);a=this.A8b.Nqh(a,b,this.mme);f.stop();if(a)return this.Wka.FSb("LoadAndShrinkImage"),this.Wka.flush(String.format("Browser={0}, Length={1}",this.vo.iy,a.length)),Mc.a.hk(ri.a.Auj,f.c$.toFixed(0)),Mc.a.hk(ri.a.zuj,f.gHc.toFixed(0)),Mc.a.hk(ri.a.Buj,a.length.toString()),this.Bxe(a,c)}return!1}rSi(a){this.G2j&&a&&(a=a.ownerDocument)&&
(a=a.getElementById(Ap.a.glg))&&a.parentNode&&a.parentNode.removeChild(a)}dpl(a){let b,c;b=0;c=!1;if(a&&a.Cm&&a.Cm.firstChild&&a.Cm.firstChild.getAttribute){var f=a.Cm.firstChild;const l=f.getAttribute(Ap.a.Fp),x=this.rq.Hq;if(x&&0<x.length&&x[0]&&Sys.UI.DomElement.containsCssClass(f,x[0].L3a)){let F=!1;(this.I8b&&Object(Fa.a)(Cv.a,x[0])||this.Uje&&Object(Fa.a)(hA.a,x[0]))&&this.JHj(x)&&(this.vDj(l)?F=!0:(a.Hwe=!1,ya.a.J(512356448,826,50,"Cannot use ClipService due to copy failure: ccpCorrId: {0}.",
a.Rb)),ya.a.J(512356447,826,50,"The copied graph nodes has been deleted, try to fall back to clip service; ccpCorrId: {0}, useClipService: {1}.",a.Rb,F));if(F)ya.a.J(512356446,826,50,"TryAttachClipboardObjects: Using clip service for ccpCorrId: {0} for in-session COPY/PASTE but actually use clip service to fulfill the request.",a.Rb),this.rq.Hq=null;else if(ya.a.J(512356445,826,50,"TryAttachClipboardObjects: Using internal objects for in-session COPY/PASTE for ccpCorrId: {0}.",a.Rb),a.tS=x,!ee.a("UseClipServiceForDestinationThemePaste"))return{returnValue:!0,
rMd:b,kUd:c}}else ya.a.J(512356444,826,50,"it is not an internal paste, use ClipService instead; ccpId: {0}, ccpCorrId: {1} .",l,a.Rb);f=this.Pw.$Ni(f,a.Rb);b=f.SNa;c=1===f.dataType;if(this.Pw.zPj(f)&&void 0!==f&&null!==f&&32===f.XY)return a.rt=f,ya.a.J(512356443,826,50,"This is IsValidClipServiceObject and copy action has succeeded, clipServiceObject.DataType {0}, pasteParams keepsource value {1} ",f.dataType,a.Sy),{returnValue:!0,rMd:b,kUd:c};ya.a.J(512356442,826,10,"Failed to use clip service, ClipServiceObject: [{0}].",
f?f.toString():"(null)")}ya.a.J(512356441,826,50,"TryAttachClipboardObjects::Failed to attach ClipboardObjects.");return{returnValue:!1,rMd:b,kUd:c}}qql(a,b){let c=!1;if(this.wja.axg(a))if(a.length>=this.mme)this.hhd(b),c=!0;else{if(a=this.wja.vpl(a))this.Wka.FSb("ExtractDataUri"),this.Wka.flush(String.format("Browser={0}, Length={1}, IsFromBlob=true",this.vo.iy,a.length));c=this.Bxe(a,b)}return c}JHj(a){for(const b of a)if(b.Rug)return!0;return!1}vDj(a){if(this.NS.Y7d)return ya.a.J(512356439,826,
50,"Cannot predict copy result due to incompletion"),!1;ya.a.J(512356440,826,50,"ccpId: {0}, LastCopyFailureCcpId: {1}.",a,this.NS.Vyg);return!!a&&a!==this.NS.Vyg}hhd(a){this.tc.Cg(!1,a,18);this.Kd.qG(60,null)}K9k(){let a=!1;if(this.n$b&&0<this.n$b.length&&this.mJg){const b=this.vca.getElementsByTagName(Xe.a.Qba);if(b){for(let c=0;c<b.length;c++){const f=b[c];if(f.src&&f.src.toLowerCase().startsWith("webkit-fake-url:")){a=!0;break}}ya.a.J(512356438,826,50,"Get image url in Safari "+(a?"Succeeded":
"Failed"))}}return a}}gh.NFh=1048576;gh.qHf=.75;gh.rgi=5E3;gh.guk="PasteViaTriggeringEvent";gh.objectCount="ObjectCount";gh.isDataCompressed="IsDataCompressed";gh.Ggi="PastedObjectDataSize";gh.yJf="ActionName";gh.AJf="CcpMethod";gh.Dfi="PasteKeepingSourceFormatting";gh.Bfi="PasteKeepingDestinationTheme";gh.Cfi="PasteAsImage";gh.Lgi='data-clipservice-type="slide"';gh.Vfi="ContextMenu.PasteKeepingDestinationTheme";gh.Ngi="ContextMenu.PasteKeepingSourceFormatting";gh.Xfi="PasteKeepingDestinationTheme";
gh.Pgi="PasteKeepingSourceFormatting";gh.Wfi="PasteKeepingDestinationThemeMLR";gh.Ogi="PasteKeepingSourceFormattingMLR";gh.zJf=20;gh.Fgi="PasteAsImageSLR";gh.Egi="PasteAsImageMLR";gh.Dgi="ContextMenu.PasteAsImage";Object(e.a)(gh,"PasteManager",null,[284,106]);class eO{constructor(a,b){this.jEg=a;this.Ga=b}Xgl(a,b,c,f,l){this.jEg.k0(this.Ga.Qli,a,b,c,this.Ga.Rli,this.Ga.Sli,this.Ga.Tli,f,l)}$ii(a){this.jEg.Zii(a)}}Object(e.a)(eO,"PastedDataUploader",null,[279]);class NE{static create(a){const b=new NE;
b.Hwg=Wq.b(a,c=>c.isEditable);return b}}Object(e.a)(NE,"ShapeCopyPasteParams",null,[]);class fO{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec,Jc,Dc,Wd){this.ra=a;this.ah=b;this.w3=c;this.rq=l;this.p8b=f;this.wja=x;this.Pw=F;this.NS=R;this.ia=fa;this.A1j=wa;this.B1j=Xa;this.gIg=lb;this.lIg=Lb;this.m2j=kc;this.$je=lc;this.obb=Ec;this.Ea=Jc;this.tc=Dc;this.Wv=Wd}QM(a){const b=this.ra.mg();let c=!1;b&&0<b.length&&this.w3.value.Xaa===Nc.a.yg&&(a.dataType=2,c=a.Zra?this.oOi(b):!this.ra.vRa());return c}oOi(a){let b=
!0;for(const c of a){if(c.OTc&&!c.isLocal)return!0;c.PB||(b=!1)}return b}vqa(a){u.AFrameworkApplication.Qj("Microsoft.Office.Server.Powerpoint.Web.IPPTEditorPasteShapesWithEmbeddedClipServiceSettings");const b=this.ra.mg();if(!b||!b.length)return this.rq.Hq=null,!1;var c;let f=({contentType:c}=this.wja.HKd(b)).returnValue;this.tc.aB(c,a.Rb);a.Zra?({Rfb:f,returnValue:c}=this.wHi(b,a.Rb,f),f="Cut:"+f):({Rfb:f,returnValue:c}=this.tHi(b,a.Rb,f),f="Copy:"+f);this.Wv.q3d(b,"DoCutCopy")&&(ya.a.J(525960395,
826,50,"ShapeCutCopyHandler: DoCutCopy HasDeferredContentOnShape: True"),a.Zra?this.Wv.npa("ShapeCutCopyHandlerHasDeferredContentIsCut","true"):this.Wv.npa("ShapeCutCopyHandlerHasDeferredContentIsCopy","true"));ya.a.J(23614726,307,50,f);return c}wHi(a,b,c){let f=!0,l=[];for(const x of a)x.OTc&&l.push(x),x.PB||(f=!1);l=f?a:l;b=({Rfb:c}=this.sEh(l,l,!0,!0,c,b,f)).returnValue;this.PQf(l);this.lIg&&this.TQf(a);return{returnValue:32===this.ia.Ka(ba.a.ZTf,2,b),Rfb:c}}tHi(a,b,c){if(this.gIg&&this.eEj(this.lcj(),
a))return{returnValue:!0,Rfb:c};const f=[];for(const l of a)l.OTc&&f.push(l);b=({Rfb:c}=this.sEh(a,f,this.gIg,!1,c,b)).returnValue;b.rt&&this.ia.Ka(ba.a.RQf,2,b);this.PQf(a);this.lIg&&this.TQf(a);return{returnValue:32===this.ia.processAction(ba.a.QQf,2),Rfb:c}}eEj(a,b){if(!this.NS.Y7d||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!a[c].id||!a[c].id.equals(b[c].id))return!1;return!0}V$k(a){if(!a.length)return!0;let b=0,c=0;for(let f=0;f<a.length;f++){const l=a[f];if(l.isLocal)return!0;
!l.qk||l.get_isSVGBlipFilled()||l.isGif||b++;l.nd&&c++}return this.m2j?c===a.length:b+c===a.length}$4i(a){const b=[];for(const c of a)c&&(a=new hA.a(c),a.sessionId=this.obb,b.push(a));return b}lcj(){const a=[];if(this.rq.Hq&&this.rq.Hq.length)for(const b of this.rq.Hq){const c=Object(va.a)(hA.a,b);if(c&&c.shapeNode)a.push(c.shapeNode);else return[]}return a}sEh(a,b,c,f,l,x,F=!1){let R=new Px(null,x,null);this.rq.Hq=this.$4i(a);!c||this.V$k(b)?(c&&(ya.a.J(23614724,307,50,"Clip service shapes cut/copy is throttled"),
this.tc.Rh(du.a.QNf,"true",x)),this.Pw.Omd(this.ah,this.rq.Hq,null,this.obb,this.hdg(a),null,x)):(this.wja.Prh(b),c=this.NS.zOd(2,b.length,f,F),c.Dcc=NE.create(b),this.$je&&this.Wv.q3d(a,f?"ShapeCutCopyHandler_DoCut":"ShapeCutCopyHandler_DoCopy")&&(c.SNa=1,c.XY=8),this.tc.Rh(du.a.Fp,c.Fp,x),l+=String.format(", CcpId={0}",c.Fp),this.Pw.Omd(this.ah,this.rq.Hq,c,this.obb,this.hdg(a),null,x),R=new Px(c,x,b));return{returnValue:R,Rfb:l}}hdg(a){const b=[];for(const c of a)Array.add(b,this.Ea.Gsb(c));return b}PQf(a){for(const b of a)if(b&&
b.qk&&(a=ae.c(b,this.p8b.Jc.Ma))&&!a.ll){a=a.iNa;if(!a)continue;a=a.getAttribute(Kk.a.NPc);if(!a)continue;const c=Xe.a.CB();c.src=a.toString();b.get_shapeRotation()||this.wja.z2k(c,b.Ex,b.sD);c.className+=this.rq.Hq[0].L3a;this.ah.contentWindow.document.body.appendChild(c)}}TQf(a){(a=this.B1j.$Vi(a,b=>!!b&&b.nd))&&0<a.length&&(a=this.A1j.aWi(a))&&this.ah.contentWindow.document.body.appendChild(a)}}Object(e.a)(fO,"ShapeCutCopyHandler",null,[727]);class Tr{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb){this.ah=
b;this.w3=c;this.rq=f;this.ta=l;this.ia=x;this.Pw=F;this.NS=R;this.o2j=fa;this.$je=wa;this.ra=a;this.obb=Xa;this.tc=lb;this.Wv=Lb}QM(a){var b=this.w3.value.Xaa;if(b=!!this.ta.Ba&&!!b&&b===xi.a.$C||b===Nc.a.yg&&!this.ra.ae().length)a.dataType=1;return b}vqa(a){this.tc.aB(19,a.Rb);return this.FCi(a)}get Eb(){return this.ra}FCi(a){var b=this.Eb.mf();if(!b||!b.length)return this.rq.Hq=null,Z.ULS.sendTraceTag(512497806,826,10,"Tried to copy slides but no slides were selected."),!1;var c=Tr.V7f(b,!0);if(!c.length)return a=
this.ydg(b).join(","),Z.ULS.sendTraceTag(512497805,826,10,"Tried to copy slides but all of them were disconnected: '{0}'.",a),!1;b.length!==c.length&&(b=Tr.V7f(b,!1),b=this.ydg(b).join(","),Z.ULS.sendTraceTag(512497804,826,15,"Tried to copy slides but some of them were disconnected: '{0}', ignore them and continue",b));var f=Tr.getSlides(this.rq),l=Tr.Oxi(this.obb,c);this.rq.Hq=Tr.rml(l);b=(b=c[0])?b.Bb:null;const x=this.Wv.qqj(c);this.o2j?this.WKe(f,l)?(ya.a.J(512497801,307,50,"Clip service slide copy is throttled for ccopCorrId: {0}",
a.Rb),this.tc.Rh(du.a.QNf,"true",a.Rb)):(f=this.NS.zOd(1,c.length,a.Zra),c=new Uz(f,a.Rb,c),this.tc.Rh(du.a.Fp,f.Fp,a.Rb),l=8,x?this.$je&&(f.SNa=1,f.XY=8):a.Zra||(l=this.ia.Ka(ba.a.SQf,2,c),f.XY=l),this.Pw.Omd(this.ah,this.rq.Hq,f,this.obb,null,b,a.Rb),!x&&a.Zra&&(l=this.ia.Ka(ba.a.$Tf,2,c)),ya.a.J(512497802,307,32!==l?10:50,"Clip service slide isCut: {0} status: {1} for ccpid: {2}",a.Zra,f.XY,f.Fp),a.Zra?this.Wv.npa("DeferredSlideCutStatus",f.XY.toString()):this.Wv.npa("DeferredSlideCopyStatus",
f.XY.toString())):(this.Pw.Omd(this.ah,this.rq.Hq,null,this.obb,null,b,a.Rb),ya.a.J(576745568,307,15,"Clip service has been disabled. CcpCorId: {0}",a.Rb));return!0}ydg(a){return vj.c(a,b=>b?b.Bb.toString():null)}WKe(a,b){if(!b||!b.length||Tr.R9h(b))return!0;if(this.NS.Y7d){if(!a||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!Tr.h$h(a[c],b[c]))return!1;return!0}return!1}static V7f(a,b){const c=new Ha.a;for(const f of a)f.isConnected===b&&c.add(f);return c.toArray()}static getSlides(a){const b=
[];if(!a||!a.Hq||!a.Hq.length)return b;for(let c=0;c<a.Hq.length;c++)b.push(Object(va.a)(Cv.a,a.Hq[c]));return b}static h$h(a,b){return!a&&!b||!!a&&!a.Nd&&!!b&&!b.Nd||!!a&&!!a.Nd&&!!b&&!!b.Nd&&(!a.Nd.id&&!b.Nd.id||!!a.Nd.id&&!!b.Nd.id&&a.Nd.id.equals(b.Nd.id))}static R9h(a){for(let b=0;b<a.length;b++)if(a[b]&&a[b].Nd&&!oe.a.xz(a[b].Nd.Bb))return!1;return!0}static rml(a){const b=[];for(const c of a)b.push(c);return b}static Oxi(a,b){const c=[];for(const f of b)c.push(Object.assign(new Cv.a(f),{sessionId:a}));
return c}}Object(e.a)(Tr,"SlideCopyHandler",null,[727]);class gO{constructor(a,b,c,f){this.Sja=this.Whe=!1;this.pRb=null;this.F9a=a;this.T8j=b;this.o7b=c;this.tc=f}get RL(){this.pRb||(this.pRb=this.T8j.create());return this.pRb}get hUd(){return this.Sja}lba(a){this.RL.lba(a)}E3a(a){this.RL.E3a(a)}get E4(){return this.RL.E4}get Bx(){return this.RL.Bx}prepareForPaste(a,b){this.Sja=!0;this.RL.prepareForPaste(b,a,this.o7b.aAa.contentWindow.document)}wba(a,b,c){this.Sja=!0;this.RL.wba(a,b,c);this.Sja=
!1}reset(){this.Sja=!1}zol(a,b){if(!this.XIa(a,b))return!1;try{const c=a.contentWindow.document;let f=c.body;Ba.a.$t(f);this.RL.a5a(c,f);return!0}catch(c){ya.a.J(512497800,826,10,"TriggerPasteRequest: We failed to generate the system clipboard event, even though we thought we had access!")}return!1}paste(a,b,c){let f;f="";b.Bf(Nc.a.yg);if(!this.XIa(a,c)&&(null==this.Bx||null!=this.Bx&&!this.Bx))return{returnValue:!1,content:f};b=a.contentWindow.document;let l=b.body;this.Sja=!0;Ba.a.$t(l);let x=!1;
try{this.F9a.$eb(a),l=this.RL.a5a(b,l),f=l.innerHTML,x=!0}catch(F){this.j1b(c)}this.Sja=!1;return{returnValue:x,content:f}}copy(a){a.contentWindow.focus();this.Sja=!0;let b;try{this.RL.hIc(a.contentWindow.document),b=!0}catch(c){b=!1}this.Sja=!1;return b?!0:!1}XIa(a,b){if(this.Whe)return!0;this.Sja=!0;let c=!1;try{c=this.RL.XIa(a.contentWindow.document.body,()=>{Ba.a.$t(a.contentWindow.document.body)},()=>{this.F9a.$eb(a)})}catch(f){}this.Sja=!1;c?this.Whe=!0:n.a.xj||null==this.Bx||this.Bx||this.j1b(b);
return c}j1b(a){this.Whe=!1;wq.instance.tpb(null,null);this.tc.Cg(!1,a,29)}}Object(e.a)(gO,"SystemClipboard",null,[281]);class hO{constructor(a,b,c,f,l,x,F,R){this.vke=!0;this.xGg=!1;l.pptOfflineModeEnabled&&a.Czc(Object(D.a)(this,this.hCb,"onNetworkHealthStateChanged"));this.Ls=b;this.ia=c;this.l_=f;this.la=l;this.QN=x;this.VK=F;this.ta=R;this.VF=0;this.P$a=!1;this.PWc=0;this.kKg=new Date}get status(){return this.VF}hCb(a,b){this.vke=b.FSc;this.xGg||this.Nkh(this.vke,"NetworkHealthStateChanged")}H4f(a){this.xGg=
!a;this.vke&&this.Nkh(a,"PodSeamlessFailoverManager")}Nkh(a,b){a&&this.P$a&&(this.l_.rkc=!1,this.VF=1,this.QN.uF());const c=!a,f=this.PWc+1;Nm.a.instance.Gb(new He.a(2,1,c?this.la.switchToOfflineDelayInMs:this.la.switchToOnlineDelayInMs,()=>{this.Bfb(c,f)},90,"107"));this.PWc++;Z.ULS.sendTraceTag(41272025,813,50,Ri.c({["Current state"]:this.P$a.toString(),["Received signal"]:a.toString(),["Change id"]:f.toString(),["State change source"]:b}))}Bfb(a,b){this.PWc===b&&this.P$a!==a&&(this.l_.rkc=a,a&&
3!==this.ia.mode||((this.P$a=a)?(this.VF=2,this.QN.uF(),this.VK.KV(this.ta.presentation)&&this.l_.show(0,-1)):(this.VF=0,this.l_.dismiss(),this.QN.uF()),this.Ls.Bfb(a),Z.ULS.sendTraceTag(41272026,813,50,"PPTO switches to {0}. The change id is {1} and the last state switching time is {2}",a?"Offline":"Online",this.PWc,Mc.a.Ye(this.kKg)),this.kKg=new Date))}}Object(e.a)(hO,"PPTOfflineManager",null,[302]);class iO{Ikc(a,b,c){qE.a(a,b,c)}}Object(e.a)(iO,"WarningDialogProxy",null,[276]);var eR=d(275);
class Xx extends Vh.a{constructor(a,b,c,f,l,x,F,R,fa){super();this.kYc=!1;this.O6b=null;this.eab=0;this.W_c=this.m9b=this.T_c=this.Q_c=this.k2c=this.$_c=this.MXc=this.$3c=this.nUa=this.Ole=this.eme=this.u_=this.v3=null;this.Oka=a;this.E9b=b;this.AI=c;this.B4j=f;this.zYj=l;this.v0j=fa;this.Fa=x;this.TOg=R;this.yc=F}dispose(){this.Ole=this.eme=this.u_=this.v3=null;super.dispose()}Mph(a){this.gAh();this.pj(a,Object(D.a)(this,this.uKi,"endDialogHandler"),{["MasterId"]:0,["LayoutId"]:0})}Oih(a){if(a)for(let b=
0;b<this.nUa.length;b++){const c=document.getElementById(this.nUa[b]);if(parseInt(c.getAttribute("LayoutId"))===a){this.rFb(c);break}}}$w(){super.$w();Xe.a.Ee().appendChild(this.Qxi());const a=document.getElementById(this.hi("WACDialogPanel"));a&&a.removeAttribute(Uc.a.zpa)}DF(){super.DF();var a=document.getElementById(this.hi("WACDialogPanel"));a.style.width=Xe.a.Lc(532);a=parseInt(Vg.a.Ru(a).top);this.v3.style.height=Xe.a.Lc(Math.min(Math.max(0,Ej.a.Hla-a-100),398));this.jg=this.v3.parentNode.innerHTML}A6(){super.A6();
this.eme=document.getElementById("MasterId");this.Ole=document.getElementById("LayoutId");this.m9b=Object(D.a)(this,this.Z8a,"keyPressHandler");u.AFrameworkApplication.Aa.FF.acd(qa.a.eg,window.document,this.m9b,null);this.Q_c=Object(D.a)(this,this.YRj,"layoutClickHandler");this.T_c=Object(D.a)(this,this.ZRj,"layoutDoubleClickHandler");this.W_c=Object(D.a)(this,this.aSj,"layoutOnFocus");for(let a=0;a<this.nUa.length;a++){const b=document.getElementById(this.nUa[a]);this.Vm.ob(qa.a.click,b,this.Q_c);
this.Vm.ob(qa.a.doubleClick,b,this.T_c);yd.a.addHandler(b.firstChild,"focus",this.W_c)}}pqa(){super.pqa();this.m9b&&u.AFrameworkApplication.Aa.FF.cSe(qa.a.eg,window.document,this.m9b);this.m9b=null;for(let a=0;a<this.nUa.length;a++){const b=document.getElementById(this.nUa[a]);this.Vm.xb(qa.a.click,b,this.Q_c);this.Vm.xb(qa.a.doubleClick,b,this.T_c);yd.a.removeHandler(b.firstChild,"focus",this.W_c)}this.W_c=this.T_c=this.Q_c=null}Qxi(){if(this.v3)return this.v3;this.v3=Xe.a.Ee();this.v3.id="LayoutPickerDiv";
this.v3.className="LayoutPicker";this.eab=0;this.nUa=[];var a=this.E9b.length;if(!a||1===a&&!this.E9b[0].InContent)return ya.a.J(546137666,822,10,"Legacy LayoutDialog:: Master not loaded."),this.v3;var b=0;let c=!1;for(var f=0;f<a;f++)this.E9b[f].Id===this.B4j&&(b=f,c=!0);c&&this.tAf(this.E9b[b],1!==a);for(f=0;f<a;f++)c&&f===b||this.tAf(this.E9b[f],1!==a);a=Xe.a.YRf();a.id="MasterId";a.type="hidden";b=Xe.a.YRf();b.id="LayoutId";b.type="hidden";this.v3.appendChild(a);this.v3.appendChild(b);return this.v3}tAf(a,
b){a.InContent&&this.AI.Jb(a.Id)&&(b&&this.v3.appendChild(this.iyi(a)),this.v3.appendChild(this.dwi(a)))}iyi(a){const b=Xe.a.Ee();b.className="MasterSlideTitleBar";b.innerText=a.Name;return b}dwi(a){const b=a.Id;a=a.ContentMasters;if(!this.AI.Jb(b))return null;const c=this.AI.ga(b),f=Xe.a.Ee();f.className="LayoutTableContainer";var l=Xe.a.fTf();const x=Xe.a.ZAi();let F=null;f.appendChild(l);l.appendChild(x);l=this.Oka.width;let R=this.Oka.height,fa;l||(l=1);R||(R=1);fa=R/l*145;let wa=0;const Xa=a.length;
for(var lb=0;lb<Xa;lb++)!this.TOg&&this.yc.$7a(a[lb])||wa++;lb=1;for(let Jc=0;Jc<Xa;Jc++){var Lb=a[Jc];if(!this.TOg&&this.yc.$7a(Lb))continue;1===lb%3&&(F=Xe.a.uPd(),x.appendChild(F));var kc=Lb.Id.toString();const Dc=Lb.Name,Wd=Xe.a.hFc();Wd.id="Layout"+this.eab;Wd.setAttribute("LayoutIndex",this.eab);Wd.setAttribute("MasterId",b);Wd.setAttribute("LayoutId",kc);Wd.setAttribute(Uc.a.We,Uc.a.wM);Array.add(this.nUa,Wd.id);var lc=null;if(kc=!!c.LayoutIcons&&c.LayoutIcons.length>Jc&&!!c.LayoutIcons[Jc].Icon){lc=
-1;for(var Ec=0;Ec<c.LayoutIcons.length;Ec++)if(c.LayoutIcons[Ec].LayoutId===Lb.Id){lc=Ec;break}-1===lc&&(lc=Jc);lc=c.LayoutIcons[lc].Icon;Ec=new eR.a(lc.Clip.Bounds.Left,lc.Clip.Bounds.Top,145,fa);Lb=Xe.a.CB();Lb.src=hb.a.instance.resolve("PPTe.IResourceViewElementResolver").resolve(gg.a.kqb,lc.ImgId);Lb.title=Dc;Lb.style.clip=this.sJk(Ec);Lb.style.left=Xe.a.Lc(-Ec.IZa);Lb.style.overflow=Ve.a.Us;Lb.style.position=Ve.a.Jwa;Lb.style.top=Xe.a.Lc(-Ec.JZa);Lb.style.zIndex="0";l<R&&(Lb.style.height=Xe.a.Lc(fa));
Lb.setAttribute(Uc.a.We,Uc.a.cNa);lc=document.createElement("span");lc.style.width=Xe.a.Lc(145);lc.style.height=Xe.a.Lc(fa);lc.setAttribute("Unselectable","on");lc.style.zIndex="0";lc.style.overflow=Ve.a.Us;lc.style.display=Ve.a.Phl;lc.style.position=Ve.a.llc;lc.appendChild(Lb);lc.setAttribute(Uc.a.YJ,Uc.a.vB)}Lb=Xe.a.Ee();Lb.id="title_Layout"+this.eab;Lb.className="LayoutTitle LayoutTitleHighContrast";Lb.innerText=Dc;Ec=Xe.a.Saa();Ec.setAttribute("tabindex","0");Ec.setAttribute("onclick","return false;");
Ec.setAttribute("unselectable","on");Ec.setAttribute(Uc.a.vs,Dc);Ec.setAttribute(Uc.a.We,Uc.a.cNa);Ec.setAttribute(Uc.a.CId,lb);Ec.setAttribute(Uc.a.DId,wa);kc&&Ec.appendChild(lc);Ec.appendChild(Lb);F.appendChild(Wd);Wd.appendChild(Ec);this.eab++;lb++}Xa%3&&(this.eab+=3-Xa%3);return f}sJk(a){let b;b="rect( "+(Xe.a.Lc(a.JZa)+", ");b+=Xe.a.Lc(a.jGh)+", ";b+=Xe.a.Lc(a.kGh)+", ";return b+=Xe.a.Lc(a.IZa)+")"}uKi(a,b){this.kYc&&(Mc.a.Pob(this.O6b),this.kYc=!1,this.O6b=null);1===a&&this.zYj(b.MasterId,b.LayoutId)}aSj(a){a=
a.target.parentNode;this.u_&&a.id===this.u_.id||this.rFb(a)}Z8a(a){a=a.lc;var b=this.H7i(a);if(b===w.a.dKb)return!0;if(b===w.a.aq)return(a=this.Fa.Zk())&&"WACDialogCancelButton"!==a.qj.YY.id?(this.hoa(1),this.hide(),!0):!1;a.preventDefault();if(!this.u_)return a=document.getElementById("Layout0"),this.rFb(a),!0;a=parseInt(this.u_.getAttribute("LayoutIndex"));b=this.J5i(b);for(let c=0;c<b.length;c++){const f=document.getElementById("Layout"+(a+b[c]));if(f){this.rFb(f);break}}return!0}H7i(a){let b=
w.a.dKb;switch(a.keyCode){case w.a.C0:b=w.a.C0;break;case w.a.A0:b=w.a.A0;break;case w.a.YQ:b=w.a.YQ;break;case w.a.wO:b=w.a.wO;break;case w.a.aq:b=w.a.aq}this.v0j&&(b===w.a.wO?b=w.a.YQ:b===w.a.YQ&&(b=w.a.wO));return b}J5i(a){let b=[0];switch(a){case w.a.C0:if(!this.$3c)for(this.$3c=Array(3),a=0;3>a;a++)this.$3c[a]=-3-a;b=this.$3c;break;case w.a.YQ:if(!this.$_c)for(this.$_c=Array(3),a=0;3>a;a++)this.$_c[a]=-1-a;b=this.$_c;break;case w.a.wO:if(!this.k2c)for(this.k2c=Array(3),a=0;3>a;a++)this.k2c[a]=
a+1;b=this.k2c;break;case w.a.A0:if(!this.MXc)for(this.MXc=Array(3),a=0;3>a;a++)this.MXc[a]=3-a;b=this.MXc}return b}YRj(a){this.rFb(a.wB);return!0}ZRj(a){a=a.wB;a!==this.u_&&this.rFb(a);this.hoa(1);this.hide();return!0}rFb(a){this.gAh();this.u_=a;const b=this.Fa.Zk();b?b.qj.fE(a.firstChild):ya.a.J(8959683,807,10,"LayoutDialog::SelectElement cannot find current FocusRegion");Sys.UI.DomElement.addCssClass(this.u_,"Selected");this.Etl();this.kYc=!0;this.O6b||(this.O6b=Mc.a.Z9(Object(D.a)(this,this.SYk,
"selectElement_Finish"),0))}SYk(){this.u_&&this.pYk(this.u_);this.kYc=!1;this.O6b=null}gAh(){this.u_&&(Sys.UI.DomElement.removeCssClass(this.u_,"Selected"),this.u_=null)}pYk(a){const b=document.getElementById("LayoutPickerDiv");if(b){var c=b.scrollTop,f=b.offsetHeight,l=Xe.a.QVg(b,a)._y,x=a.offsetHeight;l<c?3>a.getAttribute("LayoutIndex")?b.scrollTop=0:b.scrollTop=l:(a=f+c,l=x+l,l>a&&(b.scrollTop=c+(l-a)))}}Etl(){this.eme.value=this.u_.getAttribute("MasterId");this.Ole.value=this.u_.getAttribute("LayoutId")}}
Object(e.a)(Xx,"LayoutPicker",Vh.a,[]);class jO extends Xx{constructor(a,b,c,f,l,x,F,R,fa){super(a,b,c,f,l,x,F,R,fa)}dispose(){super.dispose()}khd(a){this.Mph(ResourceStrings.l_NewSlideTitle);this.Oih(a)}$w(){this.Re(1,ResourceStrings.l_AddSlide);super.$w()}}Object(e.a)(jO,"AddSlideDialog",Xx,[745]);class kO extends Xx{constructor(a,b,c,f,l,x,F,R,fa){super(a,b,c,f,l,x,F,R,fa)}dispose(){super.dispose()}khd(a){this.Mph(ResourceStrings.L_SlideLayoutDialog);this.Oih(a)}$w(){this.Re(1,ResourceStrings.L_ChangeLayout);
super.$w()}}Object(e.a)(kO,"ChangeLayoutDialog",Xx,[745]);class lO{constructor(a,b){this.Fa=a;this.yc=b}BOd(a,b,c,f,l,x,F,R){switch(a){case 1:return new jO(b,c,f,l,x,this.Fa,this.yc,F,R);case 0:return new kO(b,c,f,l,x,this.Fa,this.yc,F,R);default:return null}}}Object(e.a)(lO,"DialogFactory",null,[728]);class mO{constructor(a,b,c,f,l){this.Rka=null;this.ia=a;this.kL=b;this.jv=c;this.vN=f;this.vp=l;this.kL.t6(Object(D.a)(this,this.wdc,"onShapeDisconneted"));this.jv.hDf(Object(D.a)(this,this.Bdc,"onSlideBackgroundClicked"));
this.jv.n5h(Object(D.a)(this,this.Z_g,"onShapeViewElementBackgroundClicked"))}p4g(a){if(!a)throw Error.argumentNull("template");this.Rka=a;ya.a.J(18368227,822,50,"FormatPainter::PickupFormat Template shape {0}",a.get_shapeId());this.vN.AZ=!0}W8h(a){if(!a)throw Error.argumentNull("target");let b=!1;!this.Rka||a.id.equals(this.Rka.id)?b=!0:a.get_isSVGBlipFilled()&&(this.Rka.wy||!this.Rka.nsa&&!this.Rka.get_isSVGBlipFilled())&&(b=!0);b?this.wNa():(ya.a.J(18368260,822,50,"FormatPainter::ApplyFormat Template shape {0} Target shape {1}",
this.Rka.get_shapeId(),a.get_shapeId()),this.ia.Ka(ba.a.pWd,2,new fA(this.Rka,a)))}wNa(){this.isActive&&(ya.a.J(18368262,822,50,"FormatPainter::CancelFormat"),this.Rka=null,this.vN.AZ=!1)}dispose(){this.kL.yHa(Object(D.a)(this,this.wdc,"onShapeDisconneted"));this.jv.Adh(Object(D.a)(this,this.Bdc,"onSlideBackgroundClicked"));this.jv.wQk(Object(D.a)(this,this.Z_g,"onShapeViewElementBackgroundClicked"))}wdc(a,b){b.node===this.Rka&&this.wNa()}Bdc(){const a=this.isActive;this.wNa();this.vp&&a&&this.ia.processAction(C.a.Tha,
2)}Z_g(a,b){this.isActive&&this.W8h(b.jx.shapeNode)}get isActive(){return this.vN.AZ}get Okl(){return this.Rka}}Object(e.a)(mO,"FormatPainter",null,[299,106]);var fR=d(1108),iA;(function(a){a[a.unsaved=0]="unsaved";a[a.rightClickThumbnailPanel=1]="rightClickThumbnailPanel";a[a.rightClickCanvas=2]="rightClickCanvas";a[a.clickObjectOnCanvas=3]="clickObjectOnCanvas";a[a.tokenRefresh=4]="tokenRefresh";a[a.clipServiceCopy=5]="clipServiceCopy"})(iA||(iA={}));Object(e.b)("OfflineModalCalloutTrigger",iA);
class nO{constructor(a){this.eo=null;this.rkc=!1;this.Nb=a;a=document.createElementNS(Kk.a.jOe,"polyline");a.setAttribute(Kk.a.E4g,"1,1 15,14 30,1");a.setAttribute(Kk.a.fid,"rgb(234,234,234)");a.setAttribute(Kk.a.zNe,"2");a.setAttribute(Kk.a.VUd,"white");a.setAttribute(Kk.a.yNe,"bevel");this.Lde=new Zn.a;this.Lde.yh(32,16);this.Lde.ya.appendChild(a);this.J6b=document.createElement("p");this.J6b.innerText=CommonUIStrings.l_ModalCalloutContentWhenDisconnected;this.J6b.style.width="258px";this.J6b.style.color=
"black";this.J6b.style.fontSize="14px"}dismiss(){this.eo&&(this.eo.dismiss(),this.eo=null)}show(a,b){Z.ULS.sendTraceTag(512497097,813,50,"OfflineModalCallout.Show is triggered by {0}",iA[a]);if(this.rkc){if(this.eo){if(this.eo.AK)return;this.eo.dispose()}let c=null;c=document.querySelector("[data-unique-id='GetOfflineStatus']");ee.a("OfflineModalCalloutCrashFix")&&!c?Z.ULS.sendTraceTag(512497096,813,10,"[Offline Modal Callout] Call out not shown as top element is null"):(a=kb.a.Yh(c),this.eo=fR.a.UOd(a,
c,this.Nb.Xhd,2),this.eo.MY=4,0<b&&(this.eo.NPe=b),this.eo.hr=!0,this.eo.content=this.J6b,this.eo.zMd=()=>{Z.ULS.sendTraceTag(512497095,813,50,"The user clicks the button to close the callout.");this.eo&&(this.eo.dispose(),this.eo=null)},this.eo.m8c=()=>{if(this.eo&&this.eo.content){this.eo.content.parentNode.style.width="258px";this.eo.RI.style.borderColor="rgb(234,234,234)";for(var f=this.eo.Inb;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(this.Lde.ya);this.eo.$Ie()}else Z.ULS.sendTraceTag(512497094,
813,50,"callout content is empty in OnShowCallback")},this.eo.show(),Z.ULS.sendTraceTag(512497093,813,50,"Display the callout control"))}}}Object(e.a)(nO,"OfflineModalCallout",null,[301]);var oO=d(295),jA=d(203);class pO{constructor(a,b,c){this.ei=this.wN=this.Ab=null;this.Ib=!0;this.ua=a;this.s$a=b;this.Lme=a.Oqb?a.qca:null;this.IEa=c}dispose(){this.IEa&&this.wN&&($removeHandler(this.wN.ya,"error",Object(D.a)(this,this.PYg,"onImageLoadError")),this.wN.dispose(),this.wN=null);this.Ab&&this.Ab.iq();
this.wN=this.ei=this.Ab=null;this.Lme&&(this.s$a.revokeObjectURL(this.Lme),this.Lme=null)}$m(a){this.Ab=new PD.a;this.Ab.Cma(Ii.a.LNe);a.appendChild(this.Ab.viewport);this.wN=new oO.a;this.wN.Qk(0);this.Ab.appendChild(this.wN);this.wN.iw(this.ua.qca);$addHandler(this.wN.ya,"error",Object(D.a)(this,this.PYg,"onImageLoadError"));a=this.ua.Fq;const b=td.a.wwh(a);this.wN.setPosition(a.Zb,a.fc);this.wN.yh(b.width,b.height);this.wN.Qd(!0);this.ei=new Rl.a;this.ei.Qk(1);this.ei.setVisibility(!1);this.ei.ya.setAttribute("class",
"ShapeMoveHandle");this.ei.Qd(!0);this.ei.Qt(a.points);this.ei.FX("cursor: move");this.Ab.appendChild(this.ei);this.Ab.jm()}PYg(){ya.a.J(34182307,826,15,"Locally rendered a broken image, IsPastingPicture={0}",this.ua.z8a)}setPosition(a,b){this.Ab.setPosition(a,b)}XD(){}Ej(a){this.Ab.Ej(a)}Uq(a){this.Ab.YD(a,jA.a.Gaa)}pv(a){this.Ab.YD(a,jA.a.hob)}setZIndex(a){this.Ab.uC(a)}nz(){}XE(){return null}QD(){return[]}draw(){}AF(){}kq(){return this.Ib?this.Ab.kq():null}get visible(){return this.Ib}set visible(a){this.Ib=
a;this.Ab.Qd(this.Ib)}get zq(){return this.ei}get oe(){return this.Ab}IP(a){return a.Fc===this.zq.ya}Ux(){}setSelection(){}}Object(e.a)(pO,"LocalImageView",null,[744,387,388,106]);class qO{constructor(a,b){this.s$a=a;this.N1j=b}create(a){return new pO(a,this.s$a,this.N1j)}}Object(e.a)(qO,"Factory",null,[294]);class rO{constructor(a){this.Ib=!0;this.bTa=this.LTa=this.Ab=null;this.Pd=a}dispose(){this.Ab&&this.Ab.iq();this.LTa=this.bTa=this.Ab=null;this.Ib=!1}$m(a){this.Ab=new PD.a;this.Ab.Cma(Ii.a.LNe);
a.appendChild(this.Ab.viewport);this.bTa=new Rl.a;this.Ab.appendChild(this.bTa);this.bTa.BF(Kk.a.none);a=this.Pd.shapeNode.Fq;this.bTa.qv(qf.a.f0);this.bTa.zr(qf.a.$D);this.bTa.Hma("2,2");this.bTa.Qt(a.points);this.LTa=new oO.a;this.LTa.Qk(0);this.Ab.appendChild(this.LTa);this.LTa.iw(sp.a.cK(qf.a.Sla));a=td.a.wwh(a);const b=qf.a.LDb,c=qf.a.U$c;this.LTa.setPosition(a.width/2-b/2,a.height/2-c/2);this.LTa.yh(b,c);this.LTa.Qd(!0);this.Ab.jm()}setPosition(a,b){this.Ab.setPosition(a,b)}XD(){}Ej(){}Uq(a){this.Ab.YD(a,
jA.a.Gaa)}pv(a){this.Ab.YD(a,jA.a.hob)}setZIndex(a){this.Ab.uC(a)}nz(){}XE(){return null}QD(){return[]}draw(){}AF(){}kq(){return this.Ib?this.Ab.kq():null}get visible(){return this.Ib}set visible(a){this.Ib=a;this.Ab.Qd(this.Ib)}get oe(){return this.Ab}IP(){return!1}Ux(){}setSelection(){}}Object(e.a)(rO,"ShapeProgressIndicatorView",null,[743,387,388,106]);class sO{create(a){return new rO(a)}}Object(e.a)(sO,"Factory",null,[295]);var Bp=d(324);class OE{constructor(){this.ry=null;this.Opa=this.AM=this.Ppa=
0;this.startTime=this.T$c=this.Ew=this.cH=this.wA=this.VYb=null}vcc(){return this.AM<this.ry.OP?Object.assign(new OE,{ry:this.ry,Ppa:this.AM,AM:this.AM+Math.min(this.Opa,this.ry.OP-this.AM),Opa:this.Opa,VYb:this.VYb,wA:this.wA,cH:this.cH,Ew:this.Ew,T$c:this.T$c}):null}}Object(e.a)(OE,"ChunkUploadingContext",null,[]);class fp{constructor(a,b=null){this.pxb=a;this.zd=b}get error(){return this.pxb}get telemetry(){return this.zd}}Object(e.a)(fp,"ServiceRequestFailedEventArgs",null,[]);class Jv{constructor(a,
b,c,f){this.rf=this.pL=this.VG=null;this.k9b=b;this.N6b=c;this.Nab=f;this.yb=a}get T7(){return!!this.VG}k0(a,b,c,f,l,x,F,R=null,fa=null){this.T7?F(new fp(Object.assign(new Bp.a,{Code:59}))):(fa&&fa.register(Object(D.a)(this,this.abort,"abort")),0<l&&(this.pL=Object.assign(new He.a(2,1,l,Object(D.a)(this,this.vL,"onTimeout"),90,"85"),{customData:F}),this.yb.Gb(this.pL)),(this.VG=Object.assign(new OE,{ry:a,VYb:c,Ppa:0,AM:0,Opa:b,wA:f,cH:x,Ew:F,T$c:R,startTime:new Date}).vcc())?this.zJb(this.VG):F(new fp(Object.assign(new Bp.a,
{Code:92}))))}zJb(a){this.k9b();if(this.N6b()||!this.T7)this.reset();else{this.zva();var b=a.ry,c=a.wA,f=a.Ppa,l=a.AM,x=a.Opa,F=!f&&l===b.OP,R=new FormData;R.append("Type","2");R.append("FileName",a.ry.fileName);c&&R.append("ImageToken",c);R.append("Content-Range","bytes "+f+"-"+(l-1)+"/"+b.OP);ya.a.J(34420808,818,50,"ChunkedPictureUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, chunkSize:{2}, fileSize:{3}",f,l,x,b.OP);this.rf.onreadystatechange=()=>{this.rf&&4===this.rf.readyState&&
this.xue(a,this.rf.status)};b=F?a.VYb:a.VYb.slice(f,l);R.append("chunk",b);this.rf.send(R)}}xue(a,b){let c=Object.assign(new Bp.a,{Code:94});if(200===b){this.Nab.enc(this.rf.getResponseHeader(Jv.bLd));b=a.T$c;let f=null;try{f=Sys.Serialization.JavaScriptSerializer.deserialize(this.rf.responseText)}catch(l){ya.a.J(34420810,818,10,"ChunkedPictureUploader::UploadChunk - failed to deserialize response {0}",l)}if(f&&!f.Error&&f.Result){const l=f.Result;a.wA=l.ItemId;const x=a.vcc();a.Ppa===l.XOffset&&
l.ItemId?x?(b&&b.Qmk(100*a.AM/a.ry.OP,!1),c=null,this.zJb(x)):(b&&b.Qmk(100,!0),c=null,ya.a.J(34420812,818,50,"ChunkedPictureUploader::UploadChunk - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.cH(new Qk.a(f.Result))):c.Code=152}else f&&f.Error&&(c=f.Error)}else ya.a.J(34869445,818,10,"ChunkedPictureUploader::UploadChunk - upload failed, status:{0}, imageToken:{1}",b,a.wA||"");c&&(this.reset(),a.Ew(new fp(c)))}zva(){this.rf=new XMLHttpRequest;this.rf.open("POST",this.Nab.R6a(),
!0);u.AFrameworkApplication.accessToken&&(this.rf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.rf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.o6.toString()));u.AFrameworkApplication.canary&&this.rf.setRequestHeader(Jv.Nii,u.AFrameworkApplication.canary)}vL(a){ya.a.J(34420816,818,15,"ChunkedPictureUploader::OnTimeout - upload timeout");this.pL=null;this.abort();(a=a.customData)&&a(new fp(Object.assign(new Bp.a,{Code:299})))}abort(){if(this.T7){ya.a.J(34420818,
818,15,"ChunkedPictureUploader::Aborting upload");const a=this.rf;this.reset();a&&a.abort()}}reset(){this.pL&&(this.yb.Qg(this.pL),this.pL=null);this.VG=this.rf=null}}Jv.Nii="X-Key";Jv.bLd="X-NewKey";Object(e.a)(Jv,"ChunkedPictureUploader",null,[275]);class tO{constructor(a,b,c,f){this.yb=a;this.F0j=b;this.A8b=c;this.lme=f.pptEditingImageMaxSizeInBytes;this.XKg=Math.floor(.75*this.lme);this.G4j=52428800;this.tJg=f.qrg&&f.B7d;this.cIg=f.B7d;this.H2j=f.WFj;this.$Ig=f.Kvg}get Gbc(){return this.tJg?this.G4j:
this.XKg}get nkc(){return this.cIg}get Igd(){return this.H2j}WVb(a,b){if(b)if(a&&1===a.length){const c=a[0];c.size<this.XKg?this.convertToBase64AndCallback(a,b):this.tJg?this.shrinkToBase64AndCallback(c,b):b(null)}else b(null)}convertToBase64AndCallback(a,b){const c=this.F0j.create();this.cIg?c.Mpl(a,f=>{let l=f&&0<f.length?f[0]:null;l&&l.length>=this.lme&&(l=null);this.$Ig?b(l):this.yb.Gb(new He.a(2,1,0,()=>{b(l)},90,"83"))}):c.cyh(a,b)}shrinkToBase64AndCallback(a,b){this.A8b.eAg(a,c=>{const f=this.A8b.Nqh(c,
a.size,this.lme);this.$Ig?b(f):this.yb.Gb(new He.a(2,1,0,()=>{b(f)},90,"84"))})}}Object(e.a)(tO,"PPTProcessImageStrategy",null,[420]);var gR=d(1086);class kA{static get jg(){return Vh.a.EB(kA.Zn,ResourceStrings.l_ImageUploadMessage,ResourceStrings.l_NoImageSpecifiedErrorMessage)}}kA.Zn="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(e.a)(kA,"InsertImageDialogHtml",null,[]);class uO extends Vh.a{constructor(a){super();this.rl=null;this.Ev=[];this.Lz=a;this.bwf=!1;this.E8b=u.AFrameworkApplication.fa.ka("InsertLocalPictureMultiSelectionEnabled")}Vbl(a){this.jg=kA.jg;this.Re(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertPicture,Object(D.a)(this,this.kzj,"insertImageDialogHandler"));if(this.rl=document.getElementById("fileInput"))this.rl.setAttribute("accept","image/*"),this.E8b&&a&&this.rl.setAttribute("multiple",
"multiple");a=[];this.rl&&(yd.a.addHandler(this.rl,qa.a.eg,Object(D.a)(this,this.onKeyDown,"onKeyDown")),a.push(this.rl));var b=this.BKc(1);b&&a.push(b);(b=this.BKc(0))&&a.push(b);this.Ev=a;this.Zul()}validate(){const a=this.Lz.omd(this.rl.value);if(0!==a){const b=document.getElementById("errorText");b.innerText=this.Lz.C2i(a);b.style.display="inline-block";return!1}return!0}dispose(){this.rl&&yd.a.removeHandler(this.rl,qa.a.eg,Object(D.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}kzj(a){1===
a&&this.Lz.Dmk(this.rl);this.rl=null}Zul(){if(0<this.Ev.length){const a=new gR.a(this.Ev),b=v.FocusManager.instance().Zk();b&&(this.Ev[0].focus(),b.qj=a,b.cW=!0)}}onKeyDown(a){4!==v.FocusManager.instance().f7g(a)&&a.preventDefault()}}Object(e.a)(uO,"InsertImageDialog",Vh.a,[]);class PE{constructor(){this.IPc=this.file=this.fileName=null;this.D1f=!1;this.QBb=null;this.OP=this.imageHeight=this.imageWidth=0;this.fUd=!1}}Object(e.a)(PE,"ImageType",null,[]);class vO{constructor(a,b,c,f,l,x,F,R,fa,wa){this.AJb=
0;this.FXc=this.u$b=this.zKg=this.Yfb=!1;this.TK=[];this.PTa="image/*";this.ia=a;this.Cab=b?b.ya:null;this.bGa=null;this.Kd=c;this.Dne=f;this.Lqe=l;this.g1c=R.pptEditingUploadedImageMaxSizeInBytes;this.s$a=x;this.MZj=F;this.sne=R.pptEditingUploadLargeImageMaxSizeInBytes;this.W5j=R.pptEditingUploadLargeImageChunkSizeInBytes;this.X5j=1E3*R.pptEditingUploadLargeImageTimeoutInSeconds;if(this.Tbb=R.jvk)this.PTa=this.Tbb.join(",");this.E8b=R.qzj;this.Nab=fa;this.Ce=wa;this.zEg=R.fGi}get uVc(){return this.zKg}set uVc(a){this.zKg=
a;this.u$b=0<this.sne&&this.s$a.tJj&&a}get ivk(){return this.u$b}Dmk(a){this.nAf(a);this.Cab&&this.Lqe.APd(this.Cab,a,Object(D.a)(this,this.Awe,"onUploadFrameInitialized"),Object(D.a)(this,this.M_d,"getPictureUploadEndPoint"),this.PTa,!1,!1)}dLf(){return!(void 0===window.self.FormData||null===window.self.FormData)}z7g(a){if(this.Cab){if(this.zEg){if(this.dLf()){this.Lqe.APd(this.Cab,null,Object(D.a)(this,this.Awe,"onUploadFrameInitialized"),Object(D.a)(this,this.M_d,"getPictureUploadEndPoint"),this.PTa,
a&&this.E8b,!0);this.FXc=!1;return}ya.a.J(558445203,822,10,"Browser does not support directly opening file dialog. Falling back to the old method")}n.a.xj||n.a.kvb||n.a.mub&&72>n.a.NCc?(this.Lqe.APd(this.Cab,null,Object(D.a)(this,this.Awe,"onUploadFrameInitialized"),Object(D.a)(this,this.M_d,"getPictureUploadEndPoint"),this.PTa,!1,!1),this.FXc=!1):((new uO(this)).Vbl(a),this.FXc=!0)}else ya.a.J(18643099,822,15,"PictureUploader initialize failed.")}zIi(a){this.Xld&&(Array.addRange(this.TK,a),this.BCh())}get Xld(){return 1>
this.TK.length}BCh(){if(!this.Xld){const a=new PE,b=this.TK[0];b?(a.fileName=this.bUd(b.name),a.fUd=!0,this.P$g(a)):(ya.a.J(40993185,822,15,"PictureUploader.UploadNextImage File is null. Count of files: {0}.",this.TK.length.toString()),Array.clear(this.TK))}}M_d(){return this.Nab.R6a()}Awe(a){this.bGa=a;if(!this.FXc){if(this.zEg&&this.dLf()){a.PRd(Object(D.a)(this,this.Slk,"onMultipleFileChosen"));return}if(n.a.dF){a.PRd(Object(D.a)(this,this.yok,"onSingleFileChosen"));return}a=a.PRd(null);if(!a)return;
this.TK.push(a.files[0])}this.aHd()}nAf(a){if(a)if(this.E8b)for(const b of a.files)this.TK.push(b);else this.TK.push(a.files[0])}Slk(a){this.nAf(a);this.aHd()}KHi(a){a=this.omd(a.fileName);return 0!==a?(this.bGa&&this.bGa.VFc(),2!==a&&3!==a||this.Ts(90,a),!1):!0}$Yb(a){let b=!0;this.uVc&&a.IPc&&!this.yyl(a)&&(this.bGa&&(this.bGa.g5b=!1),b=!1);!a.QBb||!this.Yfb&&b||(this.s$a.revokeObjectURL(a.QBb),a.QBb=null);if(b){switch(this.AJb){case 0:this.ia.Ka(ba.a.ZIc,2,a);break;case 1:this.ia.Ka(ba.a.MJc,2,
a)}this.BCh()}else Array.clear(this.TK)}bUd(a){if(a){let b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);return a.substr(b+1)}return null}yyl(a){if(a.OP>this.g1c){if(this.u$b&&a.OP<this.sne)return ya.a.J(34420823,822,50,"Upload large image: {0}",a.OP),a.fUd=!0;ya.a.J(20828424,822,50,"Image size is: {0} MB, bigger than {1} MB ",a.OP/1024/1024,this.g1c/1024/1024);this.Ts(87,4);return!1}return!0}aOi(a){if(!a)return null;const b=a.lastIndexOf(".");return-1===b?null:a.substr(b+
1)}Uhd(a,b,c,f=null){if(a.fUd||this.E8b&&1<this.TK.length){const l=this.bGa,x=this.TK[0];Array.remove(this.TK,x);const F=Mc.a.Cb;F&&F.Wa("FChuckedPictureUpload","True");this.MZj().k0(a,this.W5j,x,f,this.X5j,R=>{l&&(l.g5b=!1,l.dispose());b(R)},R=>{l&&(l.g5b=!1,l.dispose());Array.clear(this.TK);c(R)})}else this.bGa&&(a=this.P9i(f),this.bGa.Vhl(b,c,a)),Array.clear(this.TK)}P9i(a){const b=new Ic.a;b.$("PresentationId",this.Ce.presentationId.string);b.$(gg.a.Jla,this.Ce.sessionInfo);b.$("Canary",u.AFrameworkApplication.canary);
b.$("access_token",u.AFrameworkApplication.accessToken);b.$("Type",this.AJb.toString());a&&b.$("ImageToken",a);return b}yok(a){a&&(Array.add(this.TK,a.files[0]),this.aHd())}aHd(){if(this.Xld||!this.TK[0])Array.clear(this.TK);else{var a=new PE;a.fileName=this.bUd(this.TK[0].name);this.bGa.g5b=!0;this.P$g(a)}}P$g(a){this.KHi(a)?this.uVc?this.FHk(a):this.$Yb(a):Array.clear(this.TK)}omd(a,b=!1){if(a&&a.length){if(1===this.AJb&&this.aOj(a))return ya.a.J(39154959,822,50,"Try to set background picture using svg file but not supported."),
3;if(this.sjg(a))return 0;this.aOi(a)?ya.a.J(20471823,822,50,"Insert local picture with invalid extension forCopyPaste: {0}",b):ya.a.J(20471825,822,50,"Insert local picture with empty extension, forCopyPaste: {0}",b);return 1===this.AJb?3:2}return 1}aOj(a){return!!a&&0<a.length&&Ma.a.sg(a).endsWith(".svg")}C2i(a){switch(a){case 1:return ResourceStrings.l_NoImageSpecifiedErrorMessage;case 2:return this.hxg()?ResourceStrings.l_InvalidImageErrorWithSvgSupportedMessage:ResourceStrings.l_InvalidImageErrorMessage;
case 3:return ResourceStrings.l_InvalidImageErrorMessage;default:return""}}hxg(){return this.sjg(".svg")}sjg(a){a=Ma.a.sg(a);for(let b=0;b<this.Tbb.length;++b)if(this.Tbb[b]&&0<this.Tbb[b].length&&a.endsWith(this.Tbb[b].trim().toLowerCase()))return!0;return!1}Ts(a,b){if(87===a){const c=this.u$b?this.sne:this.g1c;this.Kd.qG(a,f=>{f.xB=1;f.ePa=[(c/1024/1024).toString()];return!1})}else{const c=this.B2i(b);this.Kd.qG(a,f=>{f.xB=1;f.message=c;return!1})}}B2i(a){return 2===a&&this.hxg()?String.format(ResourceStrings.imageFileNotListedInPptPictureUploadSupportedExtensions,
this.Tbb.join(", ")):ResourceStrings.invalidImageFileError}FHk(a){let b=this.TK[0];if(b){a.OP=b.size;a.file=b;if(b.size>this.g1c&&this.u$b)try{b=b.slice(0,6),a.D1f=!0}catch(c){ya.a.J(34420828,822,50,"File.slice throw exception"),this.Yfb=!0,this.$Yb(a)}this.Dne.EHk(b,c=>{this.kYi(c,a)})}}kYi(a,b){try{let c=a.target.result;b.IPc=c;b.D1f&&(c=this.s$a.createObjectURL(b.file),b.QBb=c);let f=new Image;f.onload=()=>{b.imageWidth=f.width;b.imageHeight=f.height;this.KBj(b.IPc)&&(this.Yfb=!0,ya.a.J(22880261,
822,50,"Fallback for gif"));f.onload=f.onerror=null;f.src="";f=null;this.$Yb(b)};f.onerror=()=>{ya.a.J(20828428,822,50,"Read image failed");this.Yfb=!0;this.$Yb(b)};f.src=c}catch(c){ya.a.J(20828430,822,50,"GetBase64Image throw exception"),this.Yfb=!0,this.$Yb(b)}}KBj(a){return 0<a.indexOf("base64,R0lGODlh")||0<a.indexOf("base64,R0lGODdh")}}Object(e.a)(vO,"PictureUploader",null,[274]);class wO{constructor(a){this.Ce=a}R6a(){let a="pptPictureUpload.ashx";if(Gb.App.webServiceBase)a=Gb.App.webServiceBase+
a;else if(n.a.$f||n.a.xsa)a=cg.a.wBa(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.pQa(),this.Ce.presentationId.string,u.AFrameworkApplication.a_b());this.Ce.podSessionId&&(a+=String.format("&{0}={1}",gg.a.H9,this.Ce.podSessionId));this.Ce.Wj&&(a+=String.format("&waccluster={0}",this.Ce.Wj));return a}enc(a){if(a){var b=a.split(",");if(4===b.length){const c=b[0].trim()+","+b[1].trim();b=b[2].trim()+","+b[3].trim();a=c===b?c:a}u.AFrameworkApplication.canary=a;u.AFrameworkApplication.T5b&&
ya.a.J(37818512,818,50,"PictureUploaderHelper::UpdateCanary - New canary in response: {0}",a)}}}Object(e.a)(wO,"PictureUploaderHelper",null,[273]);class lA{constructor(a,b,c,f,l,x,F,R,fa,wa){this.g5b=!1;this.YS=null;this.$ja=!1;this.rf=this.GW=this.xUa=this.c8b=this.kbc=this.rl=this.Sw=this.uie=null;this.vf=a;this.U1j=f;this.Ce=c;this.Nja=l;this.hke=x;b&&(this.rl=b.cloneNode(!0));this.g1j=F;this.PTa=R;this.d5j=fa;(this.e$a=wa)?this.k_f():this.lvi()}lvi(){this.YS=document.createElement("iframe");this.YS.style.visibility=
Ii.a.hidden;this.YS.id=lA.Zgi;this.YS.className="ObjectInDialog";this.vf.appendChild(this.YS);this.kbc=Object(D.a)(this,this.f1g,"onUploadFrameLoad");yd.a.addHandler(this.YS,"load",this.kbc);n.a.dF&&this.f1g(null)}PRd(a){u.AFrameworkApplication.Aa.zdb();if(!this.rl)return null;this.e$a?yd.a.addHandler(this.rl,"change",()=>{this.hQi(a)}):n.a.dF&&(this.uie=a,this.c8b=Object(D.a)(this,this.MIc,"fileInputChange"),yd.a.addHandler(this.rl,"change",this.c8b));try{this.rl.click()}catch(b){const c=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
b.message,b.stack);ya.a.J(19505501,818,10,c);return null}return this.rl}hQi(a){a&&a(this.rl)}MIc(){this.uie&&this.uie(this.rl)}Vhl(a,b,c){a||ya.a.J(590210183,818,10,"UploadFrame::SubmitForm - The responseHandler value is null.");b||ya.a.J(590210181,818,10,"UploadFrame::SubmitForm - The errorHandler value is null.");this.xUa=a;this.GW=b;if(c.Jb("ImageToken")||c.Jb("AudioToken"))a=this.Sw.action,a+=String.format("&{0}={1}",gg.a.tsk,1),this.Ce.podSessionId&&(a+=String.format("&{0}={1}","NoAuth","1")),
this.Sw.action=a;for(let f of c.keys)this.F_h(f,c.ga(f));this.e$a?this.Whl():this.Sw.submit()}Whl(){try{ya.a.J(558445200,818,50,"SubmitFormWithRequest is preparing to send an upload request");const a=new (Type.parse("FormData"))(this.Sw);this.YZk(a)}catch(a){ya.a.J(558445201,818,10,"SubmitFormWithRequest failed to send the request with exception "+a.message),this.unc("SubmitFormWithRequest failed to send the request with exception "+a.message),this.VFc()}}YZk(a){if(a){const b=this.Sw.action;this.rf=
new XMLHttpRequest;this.rf.open("POST",b);this.rf.onreadystatechange=Object(D.a)(this,this.Epk,"onUploadResponseReceived");this.rf.send(a)}}Epk(){4===this.rf.readyState&&(this.rf.status===Np.a.Yy?this.unc(this.rf.responseText):(ya.a.J(558445202,818,10,"Upload request failed with status: {0} [isResponseNull: {1}]",this.rf.status,this.rf.responseText?!1:!0),this.unc("Upload request failed")),this.VFc())}dispose(){this.Nja(this);this.e$a&&this.vf?this.vf.removeChild(this.Sw):this.vf&&this.YS&&(this.vf.contains(this.YS)&&
this.vf.removeChild(this.YS),this.kbc&&yd.a.removeHandler(this.YS,"load",this.kbc),this.kbc=null);this.c8b&&(yd.a.removeHandler(this.rl,"change",this.c8b),this.c8b=null);this.YS=this.rl=this.Sw=this.vf=null}F_h(a,b){const c=this.Kxi();c.type="hidden";c.id=a;c.name=a;c.value=b;this.Sw.appendChild(c)}Kxi(){return this.e$a?document.createElement("input"):this.YS.contentWindow.document.createElement("input")}f1g(a){try{if(!this.YS.contentWindow.document.body)return}catch(b){ya.a.J(8958480,818,10,"UploadFrame::OnUploadFrameLoaded - Javascript exception thrown while accessing the document body: {0}",
b.toString());this.unc("0;Javascript exception thrown accessing the document body.");this.dispose();return}this.$ja?this.xUa?(this.unc(this.xgj(this.YS.contentWindow.document.body)),this.VFc()):ya.a.J(35984990,818,10,"UploadFrame::OnUploadFrameLoaded - Triggered by {0}",a?"load event":"explicit call"):this.k_f()}k_f(){if(!this.$ja){const a=this.g1j();this.e$a?(this.Sw=document.createElement("form"),this.vf.appendChild(this.Sw)):(this.Sw=this.YS.contentWindow.document.createElement("form"),this.YS.contentWindow.document.body.appendChild(this.Sw));
this.Uwi();this.Sw.id="formId";this.Sw.method="post";this.Sw.encoding="multipart/form-data";this.Sw.action=a;this.Sw.appendChild(this.rl);this.$ja=!0;this.U1j(this)}}Uwi(){this.rl||(this.e$a?(this.rl=document.createElement("input"),this.rl.style.opacity="0",this.d5j&&(this.rl.multiple="multiple")):this.rl=this.YS.contentWindow.document.createElement("input"),this.rl.type="file",this.rl.accept=this.PTa,this.rl.id="fileInputId",this.rl.name="fileInputId")}delayedDispose(){this.dispose()}VFc(){const a=
new He.a(2,1,0,Object(D.a)(this,this.delayedDispose,"delayedDispose"),90,"82");u.AFrameworkApplication.ue.Gb(a)}unc(a){let b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a)}catch(c){ya.a.J(8958484,818,10,"UploadFrame::UploadResponseReceived - Exception when deserializing response. Response: {0}",a)}b&&!b.Error?this.xUa?this.xUa(new Qk.a(b.Result)):ya.a.J(8958482,818,10,"UploadFrame::SubmitInsertPictureForm - The m_onFinished value is null."):(a=b&&b.Error?b.Error:Object.assign(new Bp.a,
{Code:94}),this.GW?this.GW(new fp(a)):ya.a.J(8958486,818,10,"UploadFrame::SubmitForm - The m_onError value is null."))}L8k(){return this.$ja&&!this.g5b}xgj(a){let b=null;this.hke?(this.SNk(a,c=>3!==c.nodeType||!!c.nodeValue&&!c.nodeValue.trim().length),a.firstChild&&3===a.firstChild.nodeType&&(b=a.firstChild.nodeValue)):b=n.a.xj?a.innerText:a.innerHTML;return b||"No response got from server"}SNk(a,b){for(;a.firstChild&&b(a.firstChild);)a.removeChild(a.firstChild)}}lA.Zgi="ppt_uploadframe";Object(e.a)(lA,
"UploadFrame",null,[428,429,430]);class xO{constructor(a,b){this.Dxb=[];this.Ce=a;this.hke=b}APd(a,b,c,f,l,x,F){if(0<this.Dxb.length)for(let R=this.Dxb.length-1;0<=R;R--)this.Dxb[R].L8k()&&this.Dxb[R].dispose();a=new lA(a,b,this.Ce,c,Object(D.a)(this,this.bHi,"disposeHandler"),this.hke,f,l,x,F);Array.add(this.Dxb,a)}bHi(a){Array.remove(this.Dxb,a)}}Object(e.a)(xO,"UploadFrameFactory",null,[272]);class yO extends xq{constructor(a,b,c,f,l){super(a,b);this.rc=c;this.ra=f;this.L8b=l}Ss(a){var b="";if(this.L8b){const c=
Re.SchemeColor.parse(a);c&&(c.color&&!c.Bra&&(b=Object(va.a)(122,this.rc.Sg(this.ra.Oa.kb.Ua.node)),(b=c.resolve(b?b.Se:null))?c.fP=Ol.g(b.rXa):ya.a.J(38061255,826,15,"PptInsertionPointFormatting: SetFontColor: Couldn't resolve font color: {0}",Ol.c(a))),b=c.toString());ya.a.J(41267233,826,50,"PptInsertionPointFormatting: SetFontColor: set SchemeColor to: {0}",Ol.c(b));this.Hk.setValue(ub.a.schemeColor,b);c&&c.Bra&&(a=Ol.i(c.fP))}Ma.a.Va(a)||super.Ss(a)}}Object(e.a)(yO,"PptInsertionPointFormatting",
xq,[]);class QE{constructor(){this.Opa=this.AM=this.Ppa=0;this.packageKey=this.Wy=this.ina=null;this.$Eb=this.CVa=this.v1=0;this.startTime=this.Ew=this.cH=null}vcc(){return this.AM<this.ina.length?Object.assign(new QE,{Ppa:this.AM,AM:this.AM+Math.min(this.Opa,this.ina.length-this.AM),Opa:this.Opa,ina:this.ina,Wy:this.Wy,packageKey:this.packageKey,cH:this.cH,Ew:this.Ew,v1:0,CVa:this.CVa,$Eb:this.$Eb,startTime:new Date}):null}}Object(e.a)(QE,"ChunkContext",null,[]);class zO{constructor(a,b,c,f,l){this.rf=
this.pL=this.VG=null;this.k9b=b;this.N6b=c;this.yb=a;this.Ce=f;this.Vw=l}get T7(){return!!this.VG}k0(a,b,c,f,l,x,F,R,fa){this.T7?(ya.a.J(512496902,818,15,"ChunkedDataUploader::StartUpload - already uploading with uploadId: {0}, not starting new upload for uploadId: {1}",this.VG.Wy,f),fa&&fa(new fp(Object.assign(new Bp.a,{Code:59})))):(0<l&&(this.pL=Object.assign(new He.a(2,1,l,Object(D.a)(this,this.vL,"onTimeout"),90,"85"),{customData:fa}),this.yb.Gb(this.pL)),(this.VG=Object.assign(new QE,{Ppa:0,
AM:0,Opa:a,ina:b,packageKey:c,Wy:f,cH:R,Ew:fa,v1:0,CVa:x,$Eb:F,startTime:new Date}).vcc())?this.zJb(this.VG):(ya.a.J(512496901,818,10,"ChunkedDataUploader::StartUpload - m_uploadingContext is null for uploadId: {0}",f),fa&&fa(new fp(Object.assign(new Bp.a,{Code:437})))))}Zii(a){this.T7&&(ya.a.J(512496900,818,50,"ChunkedDataUploader::CancelUpload - cancelling upload for uploadId: {0}",this.VG.Wy),this.VG.Wy===a&&this.abort())}zJb(a){this.k9b();if(this.N6b()||!this.T7)ya.a.J(512496899,818,15,"ChunkedDataUploader::UploadChunk - session expired or not uploading for uploadId: {0}",
a.Wy),this.reset();else{var b=this.zva(a);this.rf.onreadystatechange=()=>{this.rf&&4===this.rf.readyState&&this.xue(a,this.rf.status)};this.rf.send(b)}}xue(a,b){let c=Object.assign(new Bp.a,{Code:94});if(200===b){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(this.rf.responseText)}catch(f){ya.a.J(512496898,818,10,"ChunkedDataUploader::OnChunkUploadComplete - failed to deserialize response {0}, uploadId: {1}",f,a.Wy)}if(b&&!b.Error&&b.Result){const f=a.vcc();f?(this.Vw.Dhb(100*a.AM/
a.ina.length),this.zJb(f)):(ya.a.J(512496897,818,50,"ChunkedDataUploader::OnChunkUploadComplete - upload completed, duration:{0}, uploadId: {1}",+new Date-+a.startTime,a.Wy),this.Vw.Dhb(100),this.reset(),a.cH&&a.cH(new Qk.a(b.Result)))}b&&(c=b.Error)}else ya.a.J(512496896,818,10,"ChunkedDataUploader::OnChunkUploadComplete - upload failed, status:{0}, uploadId:{1}",b,a.Wy);c&&(a.v1<a.CVa?(ya.a.J(512496867,818,15,"ChunkedDataUploader::OnChunkUploadComplete - Retrying a chunk to upload again - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",
a.Ppa,a.AM,a.Wy),window.setTimeout(()=>{a.v1++;this.zJb(a)},a.$Eb)):(ya.a.J(512496866,818,10,"ChunkedDataUploader::OnChunkUploadComplete - Retry count exceeded - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.Ppa,a.AM,a.Wy),this.reset(),a.Ew&&a.Ew(new fp(c))))}zva(a){this.rf=new XMLHttpRequest;this.rf.open("POST",this.R6a(),!0);u.AFrameworkApplication.accessToken&&(this.rf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.rf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.o6.toString()));
const b=a.packageKey,c=a.Ppa,f=a.AM,l=!c&&f===a.ina.length,x=new FormData;x.append("FileName",a.Wy);b&&x.append("PackageKey",b);x.append("Content-Range","bytes "+c+"-"+(f-1)+"/"+a.ina.length);ya.a.J(512496865,818,50,"ChunkedDataUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, uploadLength: {2}, uploadId:{3}",c,f,a.ina.length,a.Wy);a=l?a.ina:a.ina.slice(c,f);x.append("ChunkData",a);return x}R6a(){let a="PastedDataUpload.ashx";if(Gb.App.webServiceBase)a=Gb.App.webServiceBase+a;else if(n.a.$f||
n.a.xsa)a=cg.a.wBa(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.pQa(),this.Ce.presentationId.string,u.AFrameworkApplication.a_b());this.Ce.podSessionId&&(a+=String.format("&{0}={1}",gg.a.H9,this.Ce.podSessionId));this.Ce.Wj&&(a+=String.format("&waccluster={0}",this.Ce.Wj));return a}vL(a){ya.a.J(512496864,818,15,"ChunkedDataUploader::OnTimeout - upload timeout for uploadId: {0}",this.VG.Wy);this.pL=null;this.abort();(a=a.customData)&&a(new fp(Object.assign(new Bp.a,{Code:299})))}abort(){if(this.T7){ya.a.J(512496863,
818,15,"ChunkedDataUploader::Aborting upload for uploadId: {0}",this.VG.Wy);const a=this.rf;this.reset();a&&a.abort()}}reset(){this.pL&&(this.yb.Qg(this.pL),this.pL=null);this.VG=this.rf=null}}Object(e.a)(zO,"ChunkedDataUploader",null,[278]);class AO{constructor(){this.p0j=new le.a(Object(D.a)(this,this.RCj,"isBrowerSupportObjectUrl"))}get tJj(){return this.p0j.value}RCj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}createObjectURL(a){return URL.createObjectURL(a)}revokeObjectURL(a){URL.revokeObjectURL(a)}get URL(){return window.URL||
window.webkitURL}}Object(e.a)(AO,"PPTFileApiHelper",null,[297]);class BO{WCj(){return window.FileReader?!0:!1}EHk(a,b){const c=new FileReader;c.onload=b;c.readAsDataURL(a)}readAsArrayBuffer(a,b){const c=new FileReader;c.onload=b;c.readAsArrayBuffer(a)}bUd(a){var b=null;if(a){b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);b=a.substr(b+1)}return b}}Object(e.a)(BO,"PPTFileReaderHelper",null,[292]);var hR=d(936);class CO{constructor(a,b,c,f){this.rf=this.pL=this.VG=null;
if(!a)throw Error.argumentNull("taskManager");if(!b)throw Error.argumentNull("sessionInfo");if(!c)throw Error.argumentNull("keepSessionAlive");if(!f)throw Error.argumentNull("checkSessionExpired");this.yb=a;this.Ce=b;this.k9b=c;this.N6b=f}get T7(){return!!this.VG}k0(a,b,c,f,l,x,F,R,fa){this.T7?(a=new Bp.a,a.Code=59,fa(new fp(a))):(0<l&&(this.pL=new He.a(2,1,l,this.vL.bind(this),90,"118"),{customData:fa},this.yb.Gb(this.pL)),this.VG={qQi:a,fileSize:b,file:c,Ire:f,startTime:new Date,$Eb:x,v1:0,CVa:F,
cH:R,Ew:fa},this.ACh(this.VG))}ACh(a){this.k9b();if(this.N6b()||!this.T7)this.reset();else{this.zva();var b=a.qQi,c=a.file,f=a.Ire,l=new FormData;l.append("MediaToken",f);l.append("MediaType",b);l.append("encoding","multipart/form-data");this.rf.upload.addEventListener("progress",function(x){console.log("Upload completed: {0}",x.loaded/x.total*100)});this.rf.onreadystatechange=()=>{this.rf&&4===this.rf.readyState&&this.xCb(a,this.rf.status)};l.append("fileInputId",c,c.name);this.rf.send(l)}}xCb(a,
b){if(200===b){let c;try{c=Sys.Serialization.JavaScriptSerializer.deserialize(this.rf.responseText)}catch(f){ya.a.J(509744802,818,10,"MediaUploader::OnUploadComplete - failed to deserialize response {0}",f)}c&&!c.Error&&c.Result?(ya.a.J(509744801,818,50,"MediaUploader::OnUploadComplete - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.cH(new Qk.a(this.rf))):c&&!c.Error&&this.gVk(a,c.Error)}else ya.a.J(509744800,818,10,"MediaUploader::OnUploadComplete - upload failed, status:{0}",
b)}gVk(a,b){a.v1<a.CVa?(ya.a.J(509743379,818,15,"MediaUploader::OnUploadComplete - Retry upload - mediaToken:{0}",a.Ire),window.setTimeout(()=>{a.v1++;this.ACh(a)},a.$Eb)):(ya.a.J(509743378,818,10,"MediaUploader::OnUploadComplete - Retry count exceeded - mediaToken:{0}",a.Ire),this.reset(),b||(b=new Bp.a,{Code:444}),a.Ew(new fp(b)))}zva(){this.rf=new XMLHttpRequest;this.rf.open("POST",this.R6a(),!0);u.AFrameworkApplication.accessToken&&(this.rf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),
this.rf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.o6.toString()));u.AFrameworkApplication.canary&&this.rf.setRequestHeader("X-Key",u.AFrameworkApplication.canary)}R6a(){let a="MediaUpload.ashx";if(Gb.App.webServiceBase)a=Gb.App.webServiceBase+a;else if(n.a.$f||n.a.xsa)a=cg.a.wBa(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.pQa(),this.Ce.presentationId.string,u.AFrameworkApplication.a_b());this.Ce.podSessionId&&(a+=String.format("&{0}={1}",gg.a.H9,this.Ce.podSessionId));
this.Ce.Wj&&(a+=String.format("&waccluster={0}",this.Ce.Wj));return a}vL(a){ya.a.J(509744797,818,15,"MediaUploader::OnTimeout - upload timeout");this.pL=null;this.abort();if(a=a.customData){const b=new Bp.a;b.Code=299;a(new fp(b))}}abort(){if(this.T7){ya.a.J(509744796,818,15,"MediaUploader::Aborting upload");const a=this.rf;this.reset();a&&a.abort()}}reset(){this.pL&&(this.yb.Qg(this.pL),this.pL=null);this.VG=this.rf=null}}Object(e.a)(CO,"MediaUploader",null,[280]);class DO{constructor(){this.mFg=
this.t2c=this.Dje=this.Eje=this.qpe=this.OG=this.Mja=this.K=null}get name(){return"PowerPointWebEditor.Actor"}Wb(a){this.K=a;const b=a.resolve("PowerPointWebEditor.IApplicationContext");a.resolve("PowerPointWebEditor.IApplicationSettings").UGj?a.register(256,"Box4.Actors.IFormattingStewardBridge").ma().na(()=>new VN(new oE(a.resolve("Box4.IFormattingEditor")),a.resolve("Box4.IFormattingEditor"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPPTParagraphReader"),
a.resolve("Box4.IParagraphIndentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").Xub,a.resolve("PowerPointWebEditor.IApplicationSettings").Lvg,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteTextWithHighlight,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled)):a.register(256,"Box4.Actors.IFormattingStewardBridge").ma().na(()=>new oE(a.resolve("Box4.IFormattingEditor")));a.register(257,
"PowerPointWebEditor.IGraphTransactionHelper").ma().na(()=>new GM(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.La("PowerPointWeb.Comments.ICommentFrame")));a.register(258,"PowerPointWebEditor.IInsertOnlineVideoDialogHelper").ma().na(()=>new TM(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager")));a.register(259,"Box4.IInsertionPointFormatting").ma().na(()=>
new yO(a.pb("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").fTc));a.register(260,"Box4.IClipboardCommands").ma().na(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").remapShapeEditCommandEnabled?new lE(u.AFrameworkApplication.Ta,ba.a.i5g,ba.a.Jye,ba.a.j$c,ba.a.q5g):new lE(u.AFrameworkApplication.Ta,C.a.XTb,
C.a.mBc,C.a.Jpa,C.a.r9c));a.register(261,"HtmlImport.IHtmlNormalizerSettings").ma().na(()=>new lC(!1,a.resolve("Common.IAppSettingsManager").ka("SplitHyperlinkFixWithEnterIsEnabled")));a.register(262,"HtmlImport.IHtmlTranslatorSettings").ma().na(()=>{const c=a.resolve("PowerPointWebEditor.IApplicationSettings");return new $B(c.hvg&&a.resolve("Common.IAppSettingsManager").ka("ListMarkerIsEnabled"),void 0,void 0,void 0,!0,c.Utk,!1,c.pptCopyPasteTextWithHighlight,!1,c.pptCopyPasteFontFamilyEnabled,void 0,
c.pptCopyPasteMarginAndIndentationEnabled,a.resolve("Common.IAppSettingsManager").ka("CopyAndPasteTextFromWordWin32FixIsEnabled"),c.pptCopyPasteFontFamilyEnabled,a.resolve("Common.IAppSettingsManager").ka("SupportCloudFontInExternalPasteIsEnabled"),void 0,void 0,f=>f.tRc&&c.O9d,()=>c.a$d)});a.register(263,"Box4.Actors.IBox4PasteStewardBridge").ma().na(()=>new XN(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),
a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("Box4.Graph.IGraphIteratorFactory")));a.register(kE.a,"Common.PressOnlyKeyEvent").ma().na(()=>kE.a.instance());a.register(LE,"PowerPointWebEditor.PasteFromFloatieArgs").ma().na(()=>new LE);a.register(264,"PowerPointWebEditor.IPasteFloatieHelper").ma().na(()=>new ZN(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,a.resolve("PowerPointWebEditor.IThumbnailPane"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("Common.IClickInputManager"),a.resolve("PowerpointPresence.IPresenceEventSource"),a.resolve("PowerPointWebEditor.IDialogManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IRibbonPane"),a.resolve("PowerPointWebEditor.IApplicationSettings").Rvg,a.resolve("Common.IAppSettingsManager"),a.resolve("Common.PressOnlyKeyEvent"),a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IDesignModeManager").aAa));a.register(mE,
"Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy").as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ma().na(()=>new mE);a.register(171,"Box4.IContextSetEditor").ma().na(()=>Rg.ContextSetEditor.instance);a.register(265,"PowerPointWebEditor.IPPTFormattingStewardHelper").ma().na(()=>new WN(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader")));
a.register(Xs,"PowerPointWebEditor.EnterViewStrategy").as("Box4.Actors.IEnterViewStrategy").ma().na(()=>new Xs(a.pb("Box4.IAutoCorrectScheduler"),a.Be("Box4.IUndoManager"),a.La("Box4.IExternalSelectionManager")));a.register(JE,"PowerPointWebEditor.PPTFontNameFormattingStrategy").as("Box4.Actors.IFontNameFormattingStrategy").ma().na(()=>new JE(a.resolve("PowerPointWebEditor.IFormattingHelper")));a.register(266,"Box4.Actors.IEopFormattingStrategy").ma().na(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").h9a?
Object(va.a)(266,new LN):Object(va.a)(266,new gM));a.register(267,"Box4.ISelectAllHandlers").ma().na(()=>new Sr(Pw.PageReader.instance,a.Be("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),!1,!0));a.register(268,"Box4.Actors.IDeleteOutlineElementNodeStrategy").ma().na(()=>new JN(a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.ISelectionManager")));a.register(269,"Box4.IFormatPainterStrategy").ma().na(()=>new MN(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptListEditor"),
a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(270,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().na(()=>new IN);a.register(271,"Box4.Actors.IDeleteTableSegmentStrategy").ma().na(()=>new KN(a.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(272,"PowerPointWebEditor.IUploadFrameFactory").ma().na(()=>new xO(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.IApplicationSettings").XFj));a.register(273,"PowerPointWebEditor.IPictureUploaderHelper").ma().na(()=>new wO(a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(274,"PowerPointWebEditor.IPictureUploader").ma().na(()=>new vO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ISlidePane"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IUploadFrameFactory"),
a.resolve("PowerPointWebEditor.IFileApiHelper"),()=>a.resolve("PowerPointWebEditor.IChunkedPictureUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper"),a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(275,"PowerPointWebEditor.IChunkedPictureUploader").na(()=>new Jv(a.resolve("Common.ITaskManager"),()=>{Mc.a.W8a()},Object(D.a)(Ql.a.instance,Ql.a.instance.B3a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper")));
a.register(276,"PowerPointWebEditor.IWarningDialog").ma().na(()=>new iO);a.register(277,"PowerPointWebEditor.ICalloutNotificationAdapter").ma().na(()=>new XQ.a(a.resolve("Common.App.CalloutNotification.ICalloutNotification"),a.resolve("PowerPointWebEditor.IRibbonPane").ya));a.register(278,"PowerPointWebEditor.IDataUploader").na(()=>new zO(a.resolve("Common.ITaskManager"),()=>{Mc.a.W8a()},Object(D.a)(Ql.a.instance,Ql.a.instance.B3a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(279,"PowerPointWebEditor.IPastedDataUploader").ma().na(()=>new eO(a.resolve("PowerPointWebEditor.IDataUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(280,"PowerPointWebEditor.IMediaUploader").na(()=>new CO(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>{Mc.a.W8a()},Ql.a.instance.B3a.bind(Ql.a.instance)));
a.register(281,"PowerPointWebEditor.ISystemClipboard").ma().na(()=>new gO(a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory"),a.resolve("PowerPointWebEditor.IDesignModeManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(282,"PowerPointWebEditor.IInternalClipboard").ma().na(()=>new UN(a.resolve("PowerPointWebEditor.IApplicationSettings").jtg?a.resolve("Box4.Graph.IGraphInstance").Bd(10):
null,a.resolve("PowerPointWebEditor.IApplicationSettings").jtg?a.resolve("Box4.Graph.IGraphInstance").Bd(8):null));a.register(283,"PowerPointWebEditor.ICutCopyManager").ma().na(()=>new SN(a.resolve("PowerPointWebEditor.IDesignModeManager").aAa,[new fO(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").aAa,a.Be("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),
a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportProcessor"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").xDj,a.resolve("PowerPointWebEditor.IApplicationSettings").lEj,a.resolve("PowerPointWebEditor.IApplicationSettings").wDj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),
u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager")),new Tr(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").aAa,a.Be("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").yDj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))],a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager"),
a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended")));a.register(284,"PowerPointWebEditor.IPasteManager").ma().na(()=>new gh(a.Be("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").aAa,a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPoint.IBrowserHelperManager"),
[new aO(a.resolve("Common.IActionManagerExtended"),a.Be("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").I7d,a.resolve("PowerPointWebEditor.IApplicationSettings").Mvg),new bO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").J7d),new $Q.a(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IWarningDialog"),a.resolve("Common.IBrowserUtils"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IApplicationSettings").mKj,a.resolve("PowerPointWebEditor.IApplicationSettings").PLj,a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPictureUploader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")),
new Qx(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil")),new Wz(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),u.AFrameworkApplication.ZP),new ME(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"))],
a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Common.IBrowserUtils"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),
a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));a.register(285,"PowerPointWebEditor.ICopyPasteUtility").ma().na(()=>new Eq.a(a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(286,"PowerPointWebEditor.IPasteHandlerUtil").ma().na(()=>new $N);a.register(287,"PowerPointWebEditor.IClipboardHelper").ma().na(()=>new pE.ClipboardHelper(a.resolve("PowerPointWebEditor.IInternalClipboard"),b.kQa().Wj||Ap.a.MDh,a.resolve("Common.IAppSettingsManager").Ha("RedisCacheServiceEnabledDatacenters"),
a.resolve("Common.IAppSettingsManager").Ec("ClipServiceItemExpireTimeInMinutes",60),a.resolve("Common.IAppSettingsManager").ka("PptEditingSlideCopyAsImageUrlEnabled"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(288,"PowerPointWebEditor.IClipServiceManager").ma().na(()=>new RN(b.kQa(),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(289,"Box4.TableEditors.ITableStylePreviewGenerator").ma().na(()=>new Gq(a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),
a.resolve("PowerPointWebEditor.DataModel.IHierarchyHelper"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),Nz.hTf,c=>new OD(c,a.resolve("PowerPointWebEditor.ITableStyleResolver")),c=>new MD(c),a.resolve("PowerPointWebEditor.IApplicationSettings").K9));a.register(290,"Box4.TableEditors.ITableStyleRibbonControls").ma().na(()=>new BN(a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),
a.resolve("Box4.TableEditors.ITableStylePreviewGenerator")));a.register(291,"Common.App.ImageProcessor.IImageProcessor").ma().na(()=>new fM(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));a.register(292,"PowerPointWebEditor.IPPTFileReaderHelper").ma().na(()=>new BO);a.register(293,"Box4.Actors.IFormattingViewOperationFinishedStageProcessor").ma().na(()=>new Zz(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IPageView"),a.resolve("PowerPointWebEditor.IShapeReader")));
a.register(294,"PowerPointWebEditor.ILocalImageViewFactory").ma().na(()=>new qO(a.resolve("PowerPointWebEditor.IFileApiHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Bub));a.register(295,"PowerPointWebEditor.IShapeProgressIndicatorViewFactory").ma().na(()=>new sO);a.register(296,"PPTe.IColorPickerBuilderFactory").ma().na(()=>new NQ.a);a.register(297,"PowerPointWebEditor.IFileApiHelper").ma().na(()=>new AO);a.register(298,"PowerPointWebEditor.IInsertImageHelper").ma().na(()=>new RM(a.resolve("PowerPointWebEditor.IPPTUnitConversion"),
a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(nE,"Box4.Actors.FormatPainter").as("Box4.IFormatPainter").ma().na(()=>new nE(a.resolve("Box4.Styles.IStyleEditor"),a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),Qg.a.instance,a.pb("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TextFormattingHelper")));a.register(299,"PowerPointWebEditor.IFormatPainter").ma().na(()=>new mO(a.resolve("Common.IActionManagerExtended"),a.resolve("Box4.Graph.IGraphInstance").Bd(10),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(300,
"PPTe.IResourceViewElementResolver").ma().na(()=>new QN(b.kQa(),Gb.App.webServiceBase));a.register(301,"PowerPointWebEditor.IOfflineModalCallout").ma().na(()=>new nO(a.resolve("Box4.IAppFrame")));a.register(302,"PowerPointWebEditor.IPPTOfflineManager").ma().na(()=>new hO(a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));a.register(303,"PowerPointWebEditor.IClipboardTelemetry").ma().na(()=>new du.a(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.Graph.IGraphInstance").Bd(8),
a.resolve("Box4.Graph.IGraphInstance").Bd(10),a.resolve("Box4.Graph.IGraphInstance").Bd(12),a.resolve("Box4.Graph.IGraphInstance").Bd(60),a.resolve("Box4.Graph.IGraphInstance").Bd(7),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")))}init(){const a=this.K;var b=a.resolve("Common.AFrameworkApplication");const c=b.KR;var f=b.$q;const l=c.kd;var x=a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),
F=f.ndb;const R=a.resolve("Common.IActionManagerExtended"),fa=a.resolve("PowerPointWebEditor.IFrameContext"),wa=a.resolve("PowerPointWebEditor.IFocusManager"),Xa=a.resolve("PowerPointWebEditor.IFormatPainter"),lb=a.resolve("PowerPointWebEditor.CoauthManager"),Lb=a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),kc=hb.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),lc=hb.a.instance.resolve("PowerPointWebEditor.IDialogManager"),Ec=hb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),
Jc=hb.a.instance.resolve("Box4.ISelectionManager"),Dc=hb.a.instance.La("Box4.IExternalSelectionManager"),Wd=hb.a.instance.resolve("PowerPoint.IPathManager");var xe=hb.a.instance.resolve("PowerPointWebEditor.IInternalClipboard");const Sd=f.Ed,Pe=hb.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager");b=hb.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI");const Ue=hb.a.instance.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Ef=hb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
dg=hb.a.instance.resolve("PowerPointWebEditor.INotesView"),Mg=hb.a.instance.resolve("Box4.IFormatPainter"),Bg=a.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),Lf=a.resolve("Common.Transaction.ITransactionFactory"),mh=a.resolve("PowerPointWebEditor.IPresentationReader"),Fg=a.resolve("PowerPointWebEditor.IShapeReader"),ii=a.resolve("PowerPointWebEditor.Graph.ITableReader"),Li=a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),wj=a.resolve("PowerPointWebEditor.Graph.ITableRowReader");
var cj=a.resolve("PowerPointWebEditor.ITableEditor");const dj=hb.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),yi=hb.a.instance.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Hk=a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),xj=a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),uk=a.resolve("PowerPointWebEditor.Graph.IGraphNodeContextHelper"),Gl=hb.a.instance.resolve("Box4.List.IListReader"),gl=a.resolve("Box4.Graph.IGraphIteratorFactory"),Hl=a.resolve("PPTe.IColorPickerBuilderFactory"),
Yj=a.resolve("PowerPointWebEditor.View.IPPTPageView");this.Mja=hb.a.instance.resolve("PowerPointWebEditor.ICutCopyManager");this.OG=hb.a.instance.resolve("PowerPointWebEditor.IPasteManager");const Oj=hb.a.instance.resolve("PowerPointWebEditor.IPresentationResourcesManager"),Zj=hb.a.instance.resolve("PPTe.IResourceViewElementResolver");hb.a.instance.resolve("PowerPointWebEditor.ILocalImageViewFactory");hb.a.instance.resolve("PowerPointWebEditor.IShapeProgressIndicatorViewFactory");const Wk=hb.a.instance.resolve("PowerPointWebEditor.IGraphHotColdManager"),
Hj=hb.a.instance.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),nh=a.resolve("Common.Utils.IHighContrastDetector"),hl=hb.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),Wl=a.resolve("PowerPointWebEditor.IRibbonUser"),xm=a.resolve("Box4.CloudFontService"),Ik=a.resolve("Box4.CustomFontService");this.qpe=new nj(R,kc,wa,fa.LCID,Ec,Lf,yi,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),mh,new lO(hb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),hb.a.instance.resolve("PowerPointWebEditor.IPresentationReader")),
Oj,l,Zj);this.Eje=new Jj(yi,R,wa,Ec,kc,Yj,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Box4.Graph.IGraphInstance").Bd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Pe,dj,Hj,a.resolve("PowerPointWebEditor.IApplicationSettings").CHj,a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),
a.La("PowerPointWebEditor.IInsertShapeOverlayViewElement"),a.resolve("PowerPointWebEditor.IApplicationSettings").Qtb,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings").s6d,a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Box4.Graph.IGraphInstance").Bd(10));this.Dje=new aA(yi,R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),kc,Yj,a.resolve("Box4.Graph.IGraphInstance").Bd(7),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,Pe,dj,Hj,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInkDryStore"));xe=new wM(R,wa,a.resolve("PowerPointWebEditor.IPptSelectionManager"),Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Lf,a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),xe,kc,this.Mja,this.OG,a.resolve("PowerPointWebEditor.IDesignModeManager").aAa,
a.resolve("PowerPointWebEditor.ICopyPasteUtility"),mh,dj,Yj,a.resolve("PowerPointWebEditor.IWarningDialog"),(ki,Rf,zd,ne,yf,Zd,vg,$h,zi)=>new ZM(ki,Rf,zd,ne,yf,Zd,vg,$h,zi),Hj,a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPointWebEditor.IInsertImageHelper"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"));
const vk=new gi(R,wa,Lf,F,Xa,kc,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IBox4ColorHelper"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),a.resolve("PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor"),a.resolve("PowerPointWebEditor.IJSanityHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),Mg,Bg,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),nh,a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("Box4.IPageView").Ma),ji=new YM(R,kc,fa,Lf,Ec,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"));F=new IM(R,Lf,Ec,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),fa,a.resolve("PowerPointWebEditor.IApplicationSettings"));x=[new nM(R,l,x,Ec,Lf,kc),xe,new Rx(R,l,u.AFrameworkApplication.fa.ka("UseToastForDeferredBlobsEnabled"),a.resolve("PowerPointWebEditor.IClipServiceManager"),wa,kc,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Lf,Hk,Sd,a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),Yj,Hj,a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.ICcpEventNotifier"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Wk,a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPasteFloatieHelper"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),this.OG,a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
a.resolve("PowerPointWebEditor.IPastedDataUploader"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new zM(R,hb.a.instance.resolve("PowerPointWebEditor.IDesignModeManager"),lc,a.Be("PowerPointWebEditor.IContextMenuUser"),Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),wa,a.resolve("PowerPointWebEditor.IOfflineModalCallout"),l.pptContextMenuOnSelectionFixIsEnabled),new AM(R,
Ec,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.View.IAccCheckPane"),l.powerPointGraphicToolTabIsEnabled,l.K5g,l.wDb),new GN(R,l,Yu.a.osb,gl,a.resolve("Box4.IParagraphReader")),new HN(bu.instance),this.Eje,this.Dje,F,new Tx(R,kc,wa,fa.notesPane,dg,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),fa,a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),f,hb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView")),
new XM(R,a.resolve("PowerPointWebEditor.IPPTOfflineManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser")),ji,new eN(R,fa,Wl,wa,a.resolve("PowerPointWebEditor.ICUIManager"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("Common.IRibbonExternal"),a.resolve("Common.IAppSettingsManager").ka("AltForKeytipEnabled")),new hN(R,kc,wa,lc,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
Xa,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IAriaManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),l.yz,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IShapeReader"),l.podsNewThumbnailVisibleRangeFetchExperience,a.resolve("PowerPointWebEditor.IVideoManagerStore"),l.eP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),l.w3a),vk,new lN(R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
kc,Lf,wa,Oj,Zj,Ec,Fg,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointGraphicToolTabIsEnabled,a.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),new Dv(yi,R,wa,kc,a.resolve("PowerPointWebEditor.IFontUtilsManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),Fg,!!xm&&xm.isEnabled,!!Ik&&Ik.isEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,
a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),new mN(yi,R,wa,kc,Ec,Fg,a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("Box4.Graph.IGraphIteratorFactory"),Lf,l.b$d,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("Box4.List.IListReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),this.qpe,new nN(R,kc,Lf,yi,wa,Ec,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
mh,l,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")),new pN(R,lc,wa,kc,yi,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),mh,Ue,(ki,Rf)=>new hR.a(ki,Rf),a.resolve("PowerPointWebEditor.IPptSelectionManager"),l.yz,l.c$d),new sN(R,kc,Ec,Lf,wa,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Pe,mh,dj,Yj,Hj,a.resolve("PowerPointWebEditor.IShapeReader")),
new uN(()=>Ef,new vN(Jc,Yu.a.osb,a.resolve("Box4.IContextSetEditor")),Dc,l),new CN(R,kc,l,wa,Ec,Ef,a.La("PowerPointWebEditor.IAppForOfficeManager"),a.Be("PowerPointWebEditor.IAppforOfficeClassFactory"),Yj,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.ISlidelessPane"),a.La("PowerPointWebEditor.ITextLayoutManager"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.La("PowerPointWebEditor.IAudioManagerStore")),new gA(R,Ec,xj,wa,b,Lb,hb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings")),new PN(R,a.La("PowerPointWebEditor.ICommentsPane"),wa,a.resolve("Common.IF6Manager"),Ec,xj,kc,Wd,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),mh,a.resolve("PowerPointWebEditor.IWindowUtils"),
u.AFrameworkApplication.fa,l,b,c.kQa(),Lb,Ue,hb.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),hb.a.instance.resolve("Box4.Graph.IGraphInstance").Bd(7),hb.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),hb.a.instance.resolve("Common.ITaskManager"),u.AFrameworkApplication.He,hb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),hb.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),a.La("PowerPointWeb.Comments.ICommentFrame"),a.La("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
hl,hb.a.instance.La("PowerPointLive.ILivePresenter"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IStatusBarUser"),f,a.resolve("PowerPointWebEditor.ITaskPaneManager"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))];cj=new ju(R,gl,kc,wa,Gl,Fg,ii,wj,Li,dj,cj,l,Lf,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ec,Hj,a.resolve("PowerPointWebEditor.ITableSelectionAdapter"),a.resolve("PowerPointWebEditor.ITableMergeSplitEditor"),a.resolve("PowerPointWebEditor.ICellIteratorFactory"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableMetrics"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptIsInsertMultiRowColumnEnabled,Wl,a.resolve("Box4.Styles.ITableStyleReader"));x.push(new gu(R,Ec,wa,Gl,a.resolve("Box4.ILineSpacingHelper"),Lf,uk,gl,Gb.App.aJa.JEc(12),Gb.App.aJa.JEc(10),Fg,a.resolve("Box4.IContextSetEditor"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),
l.b$d,l.isPromoteDemoteOnParagraphEnabled,Hl,l.fTc,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,a.resolve("PowerPointWebEditor.ITableEditor"),Mg,f,Sd,a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Box4.IInsertionPointFormatting"),Bg,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IApplicationSettings").Peb));x.push(cj);
f=new HE(R,wa,Fg,yi,kc,Ec,a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IParagraphReader"));x.push(f);l.RRk&&x.push(new bN(R,wa,a.resolve("PowerPointWebEditor.IPresentationReader")));l.Iyk&&x.push(new xM(R,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),l));(l.bIb||l.Sgb)&&x.push(new Hv(R,l,Lf,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ec,ii,a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView")));l.XYh&&x.push(new lM(Ec,
u.AFrameworkApplication.fa,l,Object(D.a)(Gz.App.B2a,Gz.App.B2a.K4f,"forceUpdateRibbonControls")));for(const ki of x)ki.ub(),ki.we();hb.a.instance.La("PowerPointWebEditor.ISorterViewActorMain").execute(ki=>{ki.ub()});a.resolve("PowerPointWebEditor.IPPTProcessImageStrategy").Ibi(new tO(a.resolve("Common.ITaskManager"),a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IApplicationSettings")));const ng=this;u.AFrameworkApplication.fa.ff(()=>
{const ki=Ry.a(a),Rf=[new ON(R,kc,Ec,wa,Ef,l.QIj,lb,Sd.yf,a.La("PowerpointPresence.IPresenceManager"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.IActionNameResolver"),a.resolve("PowerPointWebEditor.IGroupUngroupUndoRedoActionController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"))],zd=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");l.dja&&zd&&Rf.push(new Wx(R,a.resolve("PowerPointWebEditor.IPresentationReader"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),hl));ng.t2c=new fN(R,yi,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").Bd(7),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"));Rf.push(ng.t2c);Rf.push(new jN(R,Ec,Yj,a.resolve("PowerPointWebEditor.IApplicationSettings").qia));Rf.push(new iN(ki,Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.ISelectionPane"),
vk,ji,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),fa,Fg,a.resolve("Box4.IPageView").Ma,a.resolve("Common.Transaction.ITransactionFactory")));Rf.push(new CM(ki,Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,wa,a.resolve("PowerPointWebEditor.View.IFormatShapePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),Fg,l.iUi,l.F7k,l.qia,a.resolve("PowerPointWebEditor.IImageViewManager")));Rf.push(new EM(Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,wa,a.resolve("PowerPointWebEditor.View.IFormatTablePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("Common.IDynamicScriptLoaderProvider").yv,ii,wj,Li));l.ivg?Rf.push(new PM(ki,Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),Lf,l.Zye)):Rf.push(new MM(ki,Ec,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),Lf,l.Zye));Rf.push(new yM(ki,R,wa,Sd));l.powerPointSmartLookupIsEnabled&&Rf.push(new QM(yi,R,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),kc));l.Fyk&&Rf.push(new qM(a.resolve("Common.IDynamicScriptLoaderProvider").yv,R,a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext")));Rf.push(new oM(R,Ec,wa,Lf,a.La("PowerPointWebEditor.IAudioManagerStore"),
l.eP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));Rf.push(new kM(R,Ec,Lf,Sd,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),l.zYh,l.vzl,()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")));
l.Lyk&&Rf.push(new WM(a.resolve("Common.IDynamicScriptLoaderProvider").yv,l.Jyk,l.Kyk,R,kc,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ec,Hj));l.pptoCaptionDiscoverabilityPaneEnabled&&Rf.push(new Av(a.resolve("Common.IDynamicScriptLoaderProvider").yv,R,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.ISubtitleContext"),
a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),a.resolve("PowerPointWebEditor.ISlideshowFrame"),l.Gyk));ng.mFg=new BM(R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Lf,a.resolve("Box4.Graph.IGraphInstance").Bd(82));Rf.push(ng.mFg);for(const ne of Rf)ne.ub(),ne.we();hl.OYb=zd});(new aN(c.mK(),c.eZd(),b,xj,Ec,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IActionNameResolver"))).ub();
u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.gb.J$d&&IQ()}dispose(){this.Mja.dispose();this.OG.dispose();this.qpe.dispose();this.Eje.dispose();this.Dje.dispose();this.t2c&&this.t2c.dispose();const a=this.K.La("PowerPointWebEditor.IDesignerManager").instance;a&&a.dispose()}}Object(e.a)(DO,"ActorPackage",null,[2,3]);class EO{constructor(a,b,c,f,l,x,F,R,fa,wa){this.PG=!1;this.Yb=a;this.ta=b;this.Lg=c;this.GG=f;this.Sb=l;this.$u=x;this.yb=F;this.Cta=R;this.bPg=fa;this.Mc=wa;this.Mne=[0,1,2,
3];this.P3=new Me.a;for(const Xa of this.Mne)this.P3.$(Xa,[]);this.P3.$(4,[]);this.Lg.WJ(Object(D.a)(this,this.iC,"onActiveSlideChanged"));this.Cta.xk(Object(D.a)(this,this.y7c,"onMainMastersLoaded"));this.bPg.Kga(Object(D.a)(this,this.jwe,"onSlideLoaded"));this.bPg.xk(Object(D.a)(this,this.Ela,"onSlidePropertyChanged"));this.Mc.tB(Object(D.a)(this,this.uL,"onSessionClosed"));this.Mc.O2a(Object(D.a)(this,this.Kda,"onSessionRehydrating"));this.Mc.uB(Object(D.a)(this,this.jo,"onSessionRehydrated"));
this.OMg=new Dx(Object(D.a)(this,this.dzk,"prefetchSlideMasterNode"),250,15E3,8E3,500,"slide master node",this.yb,3);this.NMg=new Dx(Object(D.a)(this,this.czk,"prefetchSlideMasterImage"),250,6E4,8E3,500,"slide master image",this.yb,3);this.iC(null,null)}iC(){this.cTd()}cTd(){const a=this.ta.Ba;a&&8===a.type&&a.Sa(ub.a.uj)&&a.Sa(ub.a.Xn)&&this.xql(a.uj,a.Xn)}dzk(){if(!this.PG){var a=this.P3.ga(0),b=this.P3.ga(1);if(0<a.length){const c=a.length-1,f=a[c];this.wNj(f.first,f.second)&&(Array.removeAt(a,
c),Array.add(b,f),this.OMg.ljd(),this.$u.bzk(f.first,f.second))}}}czk(){if(!this.PG){this.pkd(1,2,c=>!!this.Sb.$qb(c.first,c.second));var a=this.P3.ga(2);if(0<a.length){const c=a[0];var b=this.Sb.$qb(c.first,c.second);b&&this.JKe(b)?(b=b.ztb(new er.a(b.Yp,b.Ek)),this.NMg.ljd(),Array.removeAt(a,0),Array.add(this.P3.ga(3),c),this.GG.Wqb(b,!0,()=>{this.pkd(3,4,f=>!this.JKe(this.Sb.$qb(f.first,f.second)));this.NMg.ijd()})):(Array.removeAt(a,0),Array.add(this.P3.ga(4),c))}this.pkd(3,4,c=>!this.JKe(this.Sb.$qb(c.first,
c.second)))}}vNf(){for(const a of this.Mne)Array.clear(this.P3.ga(a));Array.clear(this.P3.ga(4))}jwe(a,b){(a=Object(va.a)(123,b.node))&&a.mD&&this.Scc(a)}Ela(a,b){a=b.property;b.node&&a===ub.a.Xn&&b.node===this.ta.Ba&&this.cTd()}Scc(a){if(this.tNj(a)&&a){const b=a.uj,c=a.Xn;b&&c&&(this.pkd(1,2,f=>f.first===b&&f.second===c),this.OMg.ijd())}}y7c(a,b){a=b.property;if(a===ub.a.VAb||a===ub.a.sX)this.vNf(),this.cTd()}uL(){this.PG=!0}Kda(){this.vNf()}jo(){this.PG=!1}xql(a,b){this.uNj(a,b)||this.vNj(a,b)||
Array.add(this.P3.ga(0),new Vw.a(a,b))}vNj(a,b){for(const c of this.Mne)for(const f of this.P3.ga(c))if(f.first===a&&f.second===b)return!0;return!1}uNj(a,b){for(const c of this.P3.ga(4))if(c.first===a&&c.second===b)return!0;return!1}pkd(a,b,c){a=this.P3.ga(a);b=this.P3.ga(b);for(let f=a.length-1;0<=f;--f)if(c(a[f])){const l=a[f];Array.removeAt(a,f);Array.add(b,l)}}JKe(a){if(!a)return!1;a=a.ztb(new er.a(a.Yp,a.Ek));if(null===a)return!1;for(const b of a)if(!this.GG.JPc.tdd(b).data)return!0;return!1}tNj(a){const b=
this.Yb.yf.sa(ub.a.krh,null);if(!b)return!1;for(let c=0;c<b.length;++c)if(b[c].equals(a.id))return!0;return!1}wNj(a,b){var c=this.Sb.TH();if(!c)return!1;for(let f=0;f<c.length;++f)if(c[f].Id===a){a=c[f].ContentMasters;if(!a)break;for(c=0;c<a.length;++c)if(a[c].Id===b)return!0;break}return!1}}Object(e.a)(EO,"SlideMasterPrefetchManager",null,[219]);var iR=d(939);class FO{constructor(a,b,c,f,l,x,F){this.Ib=!1;this.nW=null;if(!b)throw Error.argumentNull("appFrame");if(!f)throw Error.argumentNull("viewElementEventSource");
if(!x)throw Error.argumentNull("taskManager");if(!l)throw Error.argumentNull("viewElementEventHandlers");this.yb=x;this.mr=a;this.Nb=b;this.Gt=c;this.Ox=f;this.od=l;this.hIg=F;this.c7j=new He.a(0,1,0,Object(D.a)(this,this.eRk,"renderCommentShimmerHandler"),90,"115")}get isVisible(){return this.Ib}Qcl(){if(!this.Ib&&this.mr&&this.mr.ya){this.nW=this.vdi();this.hIg||this.mr.ya.appendChild(this.nW);this.mr.setVisibility(!0);this.hIg&&this.od.tCf(Object(D.a)(this,this.H6c,"onCommentContainersChanged"));
var a=new iR.a(!0);this.Ox.w9g(a);this.Nb.ycb(1);this.Ib=!0}}H6c(){this.Nb.Hzc(Object(D.a)(this,this.Ndh,"renderCommentShimmerOnSlideResize"));this.od.tPk(Object(D.a)(this,this.H6c,"onCommentContainersChanged"))}Ndh(){this.yb.Gb(this.c7j);this.Nb.Acd(Object(D.a)(this,this.Ndh,"renderCommentShimmerOnSlideResize"))}eRk(){!this.nW||this.i1f()?ya.a.J(522724993,805,10,"Either CommentShimmerView is null or the Element is already added to DOM"):this.mr.ya.appendChild(this.nW)}Vjg(){if(this.Ib&&this.mr&&
this.mr.ya&&this.i1f()){this.mr.ya.removeChild(this.nW);this.nW=null;this.Ib=!1;var a={};a.commentShimmerHideTime=(new Date).getTime();ya.a.J(523352018,809,50,xa.a.toJSON(a))}}mPi(){this.Ib&&this.mr&&this.mr.ya&&(this.nW.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(Object(D.a)(this,this.Vjg,"hideShimmerUX"),600))}vdi(){const a=document.createElement("div");a.className="CommentShimmerFrameStyles";for(let b=0;2>b;b++)a.appendChild(this.wdi());return a}wdi(){const a=document.createElement("div");
a.className=this.Gt?"CommentShimmerContainerRtlStyles":"CommentShimmerContainerStyles";a.id="CommentShimmerContainer";const b=document.createElement("div");b.className="CommentShimmerPersonaStyles";const c=document.createElement("div");c.className="CommentShimmerHeaderStyles";const f=document.createElement("div");f.className="CommentShimmerBodyDiv1Styles";const l=document.createElement("div");l.className="CommentShimmerBodyDiv2Styles";const x=document.createElement("div");x.className="CommentShimmerActionStyles";
a.appendChild(b);a.appendChild(c);a.appendChild(f);a.appendChild(l);a.appendChild(x);return a}i1f(){return!!document.getElementById("CommentShimmerContainer")}}Object(e.a)(FO,"CommentShimmerView",null,[220]);class RE{constructor(a,b){this.Nb=a;this.Aua=b;this.Aua.XCf(Object(D.a)(this,this.bih,"scaleOnUIChanged"))}dispose(){this.Aua.rdh(Object(D.a)(this,this.bih,"scaleOnUIChanged"))}B9(){}z9(a){2===a.behavior&&(a=a.actionId,a!==ba.a.Pla&&a!==ba.a.Ola&&a!==ba.a.Nla&&a!==ba.a.Ila||this.updateCommandUI())}bih(){this.updateCommandUI()}updateCommandUI(){this.Nb.updateCommandUI()}}
Object(e.a)(RE,"UpdateCommandUIActionListener",null,[156,106]);class SE{constructor(){this.correlationId=this.sessionId=this.Lzd=null;this.actionId=0;this.ld=null}get Ff(){return this.Lzd?this.Lzd:""}set Ff(a){this.Lzd=a}}Object(e.a)(SE,"AssistanceSearchVariableUrlParameterSet",null,[]);class kr{constructor(){this.MO=!1;this.LO=!0;this.etf=this.wKb=null}get isInitialized(){return this.MO}initialize(a,b){const c=!!a&&!!b;c&&(this.wKb=a,this.etf=b);this.MO=c;u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)||hb.a.instance.La("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(f=>{f.k2("Enabled").then(l=>{this.LO=l;return null},()=>null)})}ub(a){a||(a=u.AFrameworkApplication.Ta);u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.LO=u.AFrameworkApplication.aE,hb.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFeatureEnabled("mso_sendASmile",
!0).then(c=>{this.LO=u.AFrameworkApplication.aE&&c;(c=u.AFrameworkApplication.Aa)&&c.updateCommandUI();return null},()=>null)}));a.xa(G.a.ued,de.a.frame,Object(D.a)(this,this.Ocl,"showSearchResults"))}Ocl(a,b,c,f,l){if(1===c)return u.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.LO=!1),l&&"SourceControlId"in l&&(l=l.SourceControlId,("GiveFeedback"===l||"btnFeedback"===l||"btnFeedbackPane"===l||"PptEditingStatusBar.GiveFeedbackPane"===l||"GiveFeedbackPane"===l)&&!this.LO)?8:
nz.SessionStatusManager.instance.tia?8:32;Z.ULS.sendTraceTag(4761738,1302,50,"");N.a.mark(4771);if(this.isInitialized){a=l.CommandValueId;b=l.SourceControlId;l=Object.assign(new SE,{actionId:G.a.ued,ld:l});if(void 0!==a&&null!==a)l=kr.zgj(a);else if(void 0!==b&&null!==b)switch(b){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":l.actionId=G.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":l.actionId=
G.a.vNd;break;case "btnShowTraining":case "Training":l.actionId=G.a.Ywh;break;case "btnWhatsNew":case "WhatsNew":l.actionId=G.a.YDh}this.wKb.Ual(this.etf,l);N.a.mark(4772);return 32}N.a.mark(4772);return 8}dispose(){this.wKb&&(this.wKb.dispose(),this.wKb=null)}static get instance(){kr.Ja||(kr.Ja=new kr);return kr.Ja}static zgj(a){const b=new SE,c=a.indexOf("|");b.sessionId=a.substring(0,c);const f=a.indexOf("|",c+1);b.correlationId=a.substring(c+1,f);b.Ff=a.substr(f+1);return b}}kr.Ja=null;Object(e.a)(kr,
"AssistanceActor",null,[106]);class TE{constructor(){this.fWe=this.jb=this.wib=null;this.Iyd=!1}Ual(a,b){if(b.actionId!==G.a.giveFeedback||u.AFrameworkApplication.aE)if(this.Iyd&&!u.AFrameworkApplication.KAa)this.wib||(this.wib=this.fWe()),this.wib.Kl(a,b);else if(b.actionId===G.a.giveFeedback)this.Fal();else{a=a.MNc(b);b=null;try{Ma.a.J7(a)&&(b=kb.a.Um(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(c){throw Z.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+c.message),c;}b?Z.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a):Z.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else Z.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.wib&&(this.wib.dispose(),this.wib=null)}anh(a,b,c){c&&il.b(a)?this.Iyd=!1:(this.fWe=a,this.Iyd=c);this.jb=b}Fal(){u.AFrameworkApplication.Ta.processAction(G.a.giveFeedback,2)}static createInstance(a,b,c=null){const f=new TE;null==c?f.anh(a,b,u.AFrameworkApplication.CGf||b.ka("HelpTabIsEnabled")):f.anh(a,b,c);return f}}Object(e.a)(TE,"AssistanceDisplayManager",null,[408,106]);
class Kv{constructor(a,b,c,f,l){this.SF=a;this.zQh=b;this.Ntc=c;this.kHh=f;this.APh=l}get lcid(){return this.SF}get namespace(){return this.zQh}get hGa(){return this.Ntc}get O9h(){return this.kHh}get locale(){return this.APh}static hgj(a){const b=a.indexOf(".");return 0<=b&&b<a.length&&(a=parseInt(a.substring(0,b)),!isNaN(a))?a:Kv.J$h}static createInstance(a){return new Kv(u.AFrameworkApplication.lcid,a,Kv.hgj(u.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
sa.a.le(u.AFrameworkApplication.lcid).name)}}Kv.J$h=16;Object(e.a)(Kv,"AssistanceSearchUrlParameterSet",null,[]);class UE{constructor(a,b){a=new Lj.QueryStringBuilder(a);a.Hi("clid",b.lcid.toString());a.Hi("p1",b.namespace);a.Hi("ver",b.hGa.toString());a.Hi("apps",b.O9h);a.Hi("lc",b.locale);this._url=a.toString()}MNc(a){const b=new Lj.QueryStringBuilder(this._url);b.Hi("src","TellMe");b.Hi("query",a.Ff);b.Hi("sessionid",a.sessionId);b.Hi("correlationid",a.correlationId);return b.toString()}static createInstance(a){return new UE(u.AFrameworkApplication.DGf,
a)}}Object(e.a)(UE,"AssistanceSearchUrlProvider",null,[409]);class VE{Wb(){}init(){u.AFrameworkApplication.Anb&&!u.AFrameworkApplication.SHb&&kr.instance.ub(u.AFrameworkApplication.Ta)}dispose(){kr.instance.dispose()}Ulg(a){kr.instance.initialize(TE.createInstance(a,u.AFrameworkApplication.fa),UE.createInstance(Kv.createInstance("PPWAEndUser")))}}Object(e.a)(VE,"AssistancePackage",null,[2,3]);var jR=d(986);class GO{constructor(a,b,c,f,l,x){this.ia=a;this.Xd=b;this.r_j=c;this.q_j=f;this.sie=l;this.A9a=
x}Kl(a,b){if(b&&this.ia){a={};let c;switch(b.actionId){case G.a.vNd:a.query="contactsupport";c=ResourceStrings.L_ContactSupport;break;case G.a.giveFeedback:a.feedback=this.usi(b);a.query="givefeedback";c=ResourceStrings.L_GiveFeedback;break;case G.a.Ywh:a.query="showtraining";c=ResourceStrings.L_Training;break;case G.a.YDh:a.query="whatsnew";c=ResourceStrings.L_WhatsNew;break;default:a.query=b.Ff,c=ResourceStrings.L_Help}const f={};f.fU=c;f.assetId="FA000000012";this.A9a.D9d&&b.actionId===G.a.giveFeedback&&
(f.sourceLocationOverrideResourceId="Help.GiveFeedback.Url");f.nonPersistedSettings=a;b.actionId==G.a.vNd&&(f.sourceLocationOverrideResourceId="Help.ContactSupport.Url");this.ia.Ka(ba.a.sIa,2,f)}}Ds(){const a=this.ybg();a&&this.ia&&this.ia.Ka(ba.a.iDc,2,a)}dispose(){}ybg(){if(this.Xd.instance){const a=this.Xd.instance.fZ("FA000000012");if(a)return a.instanceId}return null}usi(a){this.A9a.D9d||(this.sie?this.sie.cOb?this.ILf():this.q_j.fSd(Object(D.a)(this,this.GPi,"feedbackDownloaded")):ya.a.J(512324302,
1302,15,"feedbackFormManager is undefined"));a=a.ld?a.ld:{};u.AFrameworkApplication.fa.TAf(a);a=this.r_j.getContext(a);let b={};"telemetryGroup"in a&&(b=a.telemetryGroup);b.processSessionId=a.sessionId;b.officeBuild=a.build;a.telemetryGroup=b;if(void 0===a.feedbackType||null===a.feedbackType)a.feedbackType=-1;"disableIncludeScreenshot"in a||(a.disableIncludeScreenshot=!1);"screenshot"in a||(a.screenshot=!0);a.disableScreenshotPreview=!1;a.includeScreenshotSelectedDefault=!0;return a}ILf(){if(jR.a.LVg())ya.a.J(512324300,
1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(D.a)(this,this.f5g,"postScreenshotData"));return}catch(a){ya.a.J(512324299,1302,15,"Failed to use createScreenshot. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(D.a)(this,this.f5g,"postScreenshotData"))}catch(a){ya.a.J(512324298,1302,15,"Failed to use html2canvas. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}}}GPi(a){a&&
(this.sie.Byg(a),this.ILf())}f5g(a){a=a.toDataURL("image/jpeg");const b=this.ybg(),c={};c.screenshot=a;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(b,"onScreenshot",c,null)}}Object(e.a)(GO,"AgaveAssistancePane",null,[372,106]);class HO extends VE{constructor(){super();this.ZVe=this.L1e=this.YYe=this.ZYe=this.Da=null;this.Load=this.load}get name(){return"PowerPointEditor.Assistance"}Wb(a){this.Da=a}load(){this.init()}init(){super.init();!u.AFrameworkApplication.Anb&&u.AFrameworkApplication.SHb?
ya.a.J(512258326,1302,50,"Not initializing the PowerPoint Assistance package because the feature is disabled."):(ya.a.J(512258325,1302,50,"Initializing the PowerPoint Assistance package (the feature is enabled)."),u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(this.ZYe=this.Da.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.YYe=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),this.L1e=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),
this.ZVe=this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Ulg(()=>new GO(this.Da.resolve("Common.IActionManagerExtended"),this.Da.La("PowerPointWebEditor.IAppForOfficeManager"),this.ZYe,this.YYe,this.L1e,this.ZVe))):this.Ulg(null))}}Object(e.a)(HO,"PowerPointAssistancePackage",VE,[304]);class WE{WRi(a,b,c){return a?this.YQi(b,c):this.XRi(b,c)}W2f(a,b,c){return a?this.zRi(b,c):this.rRi(b,c)}pRi(a){var b=a.qf?a.gg.Te:a.gg.Ua;const c=new mb.GraphIterator;a.Xp?c.Nc(a.Xp):c.set(b.node);
c.mc(14);a=new mb.GraphIterator;a.Nc(c);a.mc(14);b=De.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!De.isLastCellInRow(a)){do if((f=Dd.moveToNextColumn(a))&&De.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!De.isLastCellInRow(a))}if(!l&&!De.isLastCellInColumn(c)){do if((f=Dd.moveToNextRow(c))&&De.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!De.isLastCellInColumn(c))}return l?f:null}xRi(a){var b=a.qf?a.gg.Te:a.gg.Ua;const c=new mb.GraphIterator;a.Xp?c.Nc(a.Xp):
c.set(b.node);c.mc(14);a=new mb.GraphIterator;a.Nc(c);a.mc(14);b=De.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!De.isFirstCellInRow(a)){do if((f=Dd.moveToPreviousColumn(a))&&De.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!De.isFirstCellInRow(a))}if(!l&&!De.isFirstCellInColumn(c)){do if((f=Dd.moveToPreviousRow(c))&&De.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!De.isFirstCellInColumn(c))}return l?f:null}eJc(a,b){var c=a.qf?a.gg.Te:a.gg.Ua;const f=new mb.GraphIterator;
a.Xp?f.Nc(a.Xp):f.set(c.node);f.mc(14);a=De.findControllingCellFromNode(c.node);c=null;if(b){do{if(De.isFirstCellInColumn(f))break;c=Dd.moveToPreviousRow(f)}while(c&&De.findControllingCellFromNode(c)===a)}else{do{if(De.isLastCellInColumn(f))break;c=Dd.moveToNextRow(f)}while(c&&De.findControllingCellFromNode(c)===a)}return c}V2f(a,b){if(!ik.l(a))return null;a=mb.GraphIterator.mb(a.currentNode);a.mc(14);let c;const f=xd.TableReader.ju(a.origin);do c=b?Dd.moveToPreviousRow(a):Dd.moveToNextRow(a);while(f&&
c&&ik.h(a));return c}NVa(a,b,c,f,l){let x=null;Yb.OutlineElementNavigator.Je(a);const F=Rd.OutlineElementReader.isRtl(a.currentNode);if(c)if(Dd.returnToCell(a),b=De.isLastCellInRow(a),c=De.isFirstCellInRow(a),l||!F&&c||F&&f&&b)Dd.returnToContainingRow(a),(f=this.V2f(a,!0))?x=nd.SelectionFactory.nj(f,!b):l&&(Yb.OutlineElementNavigator.Je(a),l=new En.a,l.Nc(a),(a=Yb.OutlineElementNavigator.Iua(l,!1,!1))&&(x=nd.SelectionFactory.nj(a,!1)));else{do F?Dd.moveToNextColumn(a):Dd.moveToPreviousColumn(a);while(De.isGhostCell(a)&&
!De.isFirstCellInColumn(a));De.isGhostCell(a)||(x=nd.SelectionFactory.nj(a.currentNode,!F))}else Rd.OutlineElementReader.OB(a,b,F)||fb.SelectionEditor.Kg(b)||Dd.returnToCell(a),x=nd.SelectionFactory.nj(a.currentNode,!F);return x}MVa(a,b,c,f,l){let x=null;Yb.OutlineElementNavigator.Je(a);const F=Rd.OutlineElementReader.isRtl(a.currentNode);if(c)if(Dd.returnToCell(a),c=De.isLastCellInRow(a),b=De.isFirstCellInRow(a),l||!F&&f&&c||F&&!f&&b)Dd.returnToContainingRow(a),(f=this.V2f(a,!1))?x=nd.SelectionFactory.nj(f,
b):(Yb.OutlineElementNavigator.Je(a),f=new En.a,f.Nc(a),(a=Yb.OutlineElementNavigator.OI(f,!1,!1))&&(x=nd.SelectionFactory.nj(a,!0)));else{do F?Dd.moveToPreviousColumn(a):Dd.moveToNextColumn(a);while(De.isGhostCell(a)&&!De.isLastCellInRow(a));De.isGhostCell(a)||(x=nd.SelectionFactory.nj(a.currentNode,F))}else Rd.OutlineElementReader.OB(a,b,!F)||fb.SelectionEditor.Kg(b)||Dd.returnToCell(a),x=nd.SelectionFactory.nj(a.currentNode,F);return x}}Object(e.a)(WE,"ATableCellSelectionStrategy",null,[1107]);
class XE extends WE{constructor(){super()}rRi(a,b){var c=a.kb;let f=null;if(a.nl){let l=null;if(b){if(c.Xp=a.Gha,a=Object(va.a)(Xl.TableCellNode,this.pRi(c)))a.isGhostCell&&(l=a,a=a.oy()),f=c.dG.isValid&&c.dG.node&&a===c.dG.node?nd.SelectionFactory.nj(c.dG.node,!c.qf):nd.SelectionFactory.eu($q.TableNodeContext.create(Object(va.a)(ag.a,a)),c.qf)}else if(c=a.ga(Math.max(0,Math.min(a.vha,a.Pwa))),c=Object(va.a)(Xl.TableCellNode,c.gg.Te.node),c.isControllingCell&&(c=c.rZd(2)),a=c.jZ(),b=c.YKc().pGa,!a&&
b&&(c=b.v3f),a=c)a.isGhostCell&&(l=a,a=a.oy()),f=fb.SelectionEditor.yl(nd.SelectionFactory.Xk(Object(va.a)(ag.a,a)),!0,!1);f&&l&&(f.Xp=mb.GraphIterator.mb(l))}return f}zRi(a,b){let c=a.kb,f=null;a.nl&&(b?(c.Xp=a.Gha,a=Object(va.a)(Xl.TableCellNode,this.xRi(c)),b=null,a&&(a.isGhostCell&&(b=a,a=a.oy()),(f=c.dG&&c.dG.isValid&&a===Object(va.a)(125,c.dG.node)?nd.SelectionFactory.nj(c.dG.node,!c.qf):nd.SelectionFactory.eu($q.TableNodeContext.create(Object(va.a)(ag.a,a)),c.qf))&&b&&(f.Xp=mb.GraphIterator.mb(Object(va.a)(ag.a,
b))))):(a.vha>a.Pwa?(c=a.a5,c.Xp=c.qf?a.AYa:null):c.Xp=c.qf?null:a.Gha,f=fb.SelectionEditor.yl(nd.SelectionFactory.Xk(c.gg.Ua.node),!0,!1),f.Xp=c.Xp));return f}XRi(a,b){let c=a.kb;var f=null;if(a.nl){const l=a.vha>a.Pwa;let x=null;if(b){if(c.Xp=a.Gha,a=Object(va.a)(Xl.TableCellNode,this.eJc(c,!0)))a.isGhostCell&&(x=a,a=a.oy()),f=l&&c.dG&&c.dG.isValid&&a===c.dG.node?nd.SelectionFactory.nj(c.dG.node,!c.qf):nd.SelectionFactory.eu($q.TableNodeContext.create(Object(va.a)(ag.a,a)),c.qf)}else l?(c=a.a5,
c.qf&&(c=c.brb(),c.Xp=a.AYa)):c.qf?c=c.brb():c.Xp=a.Gha,f=Object(va.a)(Xl.TableCellNode,this.eJc(c,!0)),f?f.isGhostCell&&(x=f,f=f.oy()):(f=Object(va.a)(Xl.TableCellNode,c.gg.Ua.node),x=c.Xp?Object(va.a)(Xl.TableCellNode,c.Xp.currentNode):null),f=nd.SelectionFactory.nj(Object(va.a)(ag.a,f),!0);f&&x&&(f.Xp=mb.GraphIterator.mb(Object(va.a)(ag.a,x)))}return f}YQi(a,b){let c=a.kb;var f=null;if(a.nl){const l=a.vha<a.Pwa;let x=null;if(b){if(c.Xp=a.Gha,a=Object(va.a)(Xl.TableCellNode,this.eJc(c,!1)))a.isGhostCell&&
(x=a,a=a.oy()),f=l&&c.dG&&c.dG.isValid&&a===Object(va.a)(125,c.dG.node)?nd.SelectionFactory.nj(c.dG.node,!c.qf):nd.SelectionFactory.eu($q.TableNodeContext.create(Object(va.a)(ag.a,a)),c.qf)}else l?(c=a.a5,c.qf&&(c=c.brb(),c.Xp=a.AYa)):c.qf?c=c.brb():c.Xp=a.Gha,f=Object(va.a)(Xl.TableCellNode,this.eJc(c,!1)),f?f&&f.isGhostCell&&(x=f,f=f.oy()):(f=Object(va.a)(Xl.TableCellNode,c.gg.Ua.node),x=c.Xp?Object(va.a)(Xl.TableCellNode,c.Xp.currentNode):null),f=nd.SelectionFactory.nj(Object(va.a)(ag.a,f),!0);
f&&x&&(f.Xp=mb.GraphIterator.mb(Object(va.a)(ag.a,x)))}return f}}Object(e.a)(XE,"TableCellSelectionStrategy",WE,[]);class IO extends Zy{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec){super(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc);this.gUh=l;this.mNh=c;this.zpc=Ec}$Vb(a,b){var c=Object(va.a)(dp,b);c&&c.EWa&&this.Kki(this.mNh.CPe)&&(c=c.EWa.sa(wm.a.Rb,""),this.zpc.Cbc(c),this.zpc.aB(6,c));return super.$Vb(a,b)}Kki(a){const b=new kC;for(b.enqueue(a);0<b.count;){a=b.dequeue();if(14===a.type)return!0;
a=mb.GraphIterator.mb(a);let c=a.Ji();for(;c;)b.enqueue(c),c=a.jp()}return!1}XFc(a,b){var c=Object(va.a)(dp,b);if(c&&c.EWa){c=c.EWa.sa(wm.a.Rb,"");const f=Object(va.a)(5,this.gUh.Oa.kb.Te.node);f&&(f.Rb=c)}return super.XFc(a,b)}}Object(e.a)(IO,"PPTClipboardOperationCutCopy",Zy,[]);class JO{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec){this.Ca=a;this.hd=b;this.Jr=c;this.xY=x;this.Pc=l;this.xi=f;this.Zq=F;this.$e=R;this.dga=fa;this.FJ=wa;this.ega=Xa;this.llb=lb;this.E1a=Lb;this.jb=kc;this.ik=
lc;this.zpc=Ec}create(){return new IO(this.Ca,this.hd,this.Jr,this.xi,this.Pc,this.xY,this.Zq,this.$e,this.dga,this.FJ,this.ega,this.llb,this.E1a,this.jb,this.ik,this.zpc)}}Object(e.a)(JO,"Factory",null,[251]);class KO{constructor(){}get L9c(){return!1}Nnb(){}get lSg(){return!1}set lSg(a){}get Jbk(){return!1}yla(){}gWa(){}get vVg(){return-1}get lGc(){return null}}Object(e.a)(KO,"NoImageSteward",null,[1106]);class YE{constructor(a){this.f9b=a}create(a,b){return this.f9b||1!==a?new KO(b):null}}Object(e.a)(YE,
"PPTImageStewardFactory",null,[1069]);class Hq extends Nr{constructor(a,b,c,f,l,x,F){super(a,b,c);this.ia=f;this.Pw=l;this.tc=F;this.e3j=x.Ptk;this.I8b=x.J7d;this.n2j=x.I7d;this.f9b=x.Xub;this.f3j=x.QKj}d9d(a,b,c){const f=Hq.c7f(c);a=(!H.a.instance.ga(82)||this.VJj(a,b,f))&&super.d9d(a,b,c);3===c.TNa?this.tc.iw(2,f):2===c.TNa&&this.tc.iw(3,f);a&&(this.tc.Cbc(f),this.BAh(b,f));return a}rKe(a,b,c){const f=Hq.c7f(c);a.setAttribute(du.a.PLf,f);let l=!1;const x=Hq.TJj(a);if(x)ya.a.J(17310354,826,50,null),
l=!0;else if(this.f3j&&1===a.getElementsByTagName("Table").length&&!b.iterator.mc(60))this.tc.aB(6,f),l=!0;else{const F=Ca.b(a);F&&F.length||!Hq.w_b(a)||(ya.a.J(17310356,826,50,null),l=!0)}l&&!Hq.nhh&&(u.AFrameworkApplication.mN("Microsoft.Office.Server.Powerpoint.Web.IPasteContentFromPandoraSettings"),Hq.nhh=!0);if(!this.e3j)return!0;l&&(this.f9b&&this.tvg(c)?ya.a.J(36779848,826,50,"Paste text only action."):(ya.a.J(17310358,826,50,null),this.kNi(a.cloneNode(!0),x)));if(a=!l&&super.rKe(a,b,c))this.tc.Cbc(f),
this.tc.aB(1,f),this.BAh(b,f);return a}kNi(a,b){b&&a.firstChild&&a.firstChild.className&&(a.className=a.firstChild.className,(this.I8b||this.n2j)&&this.Pw.Fni(a.firstChild,a));Mc.a.Z9(()=>{this.ia.Ka(ba.a.o3g,2,a)},100)}VJj(a,b,c){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ComplexTableCellPasteWithFormattingIsEnabled")){a=Hq.Rej(a);if(1!==a.count)return!1;this.tc.aB(6,c);a=a.ga(0);return!u.AFrameworkApplication.fa.ka("ComplexTableCellPasteFromComplexTableIsEnabled")&&this.lqj(a)?
!1:Hq.nKj(b)}c=Object(va.a)(5,b.iterator.currentNode);let f=null;c&&(f=(c=c.pK())?c.getContainingTable():null);return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTInternalPasteTableInTableIsEnabled")&&b.Kk&&b.node.Sa(ub.a.cellId)&&1===a.getElementsByTagName("Table").length&&!!f&&!f.lp()}lqj(a){a=a.getElementsByTagName("Table");if(1===a.length){a=a[0].getElementsByTagName("td");for(let c=0;c<a.length;c++){var b=a[c];if(!b)continue;const f=b.attributes.getNamedItem("rowspan");if(!f||
!f.specified||"1"!==f.value)return!0;b=b.attributes.getNamedItem("colspan");if(!b||!b.specified||"1"!==b.value)return!0}}return!1}BAh(a,b){if(Object(va.a)(5,a.node)&&a.iterator)if(a.iterator.mc(10)){if(a=Object(va.a)(4,a.iterator.rw(10)))a.Rb=b}else a.iterator.mc(60)&&(a=Object(va.a)(375,a.iterator.rw(60)))&&(a.Rb=b)}static Rej(a){a=a.getElementsByTagName("Table");if(1===a.length){var b;return b=new Ha.a,b.add(a[0]),b}b=new Ha.a;if(2===a.length){for(let c=0;c<a.length;c++){if(0<a[c].getElementsByTagName("Table").length){if(0<=
a[c].className.indexOf("Selected_Table"))continue;b.clear();break}b.add(a[c])}1<b.count&&b.clear()}return b}static nKj(a){return a.Kk&&a.node.Sa(ub.a.cellId)&&a.iterator.mc(14)?!0:!1}static w_b(a){a=a.getElementsByTagName(Xe.a.Qba);if(!a.length)return null;a=a[0];return a.src?a:null}static TJj(a){return!!a.firstChild&&!!a.firstChild.className&&cR.a.Cqg(a.firstChild.className)}static c7f(a){let b="";a&&a.EWa&&(b=a.EWa.sa(wm.a.Rb,""));return b}}Hq.nhh=!1;Object(e.a)(Hq,"PPTPasteCoordinator",Nr,[]);
class LO{constructor(){}Nnb(){}get $aa(){return!1}gX(){}dX(){}fX(){}eX(){}cX(){}bX(){}}Object(e.a)(LO,"TextOnlyTableSteward",null,[401,402]);class ZE{constructor(a){this.f9b=a}create(a,b){return this.f9b||1!==a?new LO(b):null}}Object(e.a)(ZE,"PPTTableStewardFactory",null,[374]);class $E{constructor(a,b,c){this.a1j=a;this.d4j=b;this.la=c}UCe(){this.a1j.execute(a=>{this.la.R9d&&a.dDe(this.d4j.value)})}}Object(e.a)($E,"AccessibilityActor",null,[]);class lu{get key(){return"LIST"}get G6(){return Box4Intl.Box4Strings.l_ListContentTitle}eRe(a){let b;
b=null;const c=lu.Rf.Fw(a);if(!c)return{returnValue:!1,gpb:b};a=this.a6i(a,c);b=Object.assign(new Vy,{K_:this.key,contentId:a.listId,iP:a});return{returnValue:!0,gpb:b}}bLc(a,b){a=a.iP;const c=this.f5i(a.GS),f=new Hf.a;b?(b=b.iP,b.level!==a.level?(f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c)):b.id.equals(a.id)&&b.GS.listType===a.GS.listType||f.add(c)):(f.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
a.level)),f.add(c));return f.toArray().join(" ")}f5i(a){let b="";const c=a.listStyle;if(0===a.listType)b=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,a.YV);else if(1===a.listType)switch(c){case 1:b=this.ZIf;break;case 2:b=this.gfi;break;case 3:b=this.hfi;break;default:b=this.ZIf}return b}static get Rf(){return lu.Og||(lu.Og=hb.a.instance.resolve("Box4.List.IListReader"))}}lu.Og=null;Object(e.a)(lu,"ListDetailsProvider",null,[396,397]);class MO{constructor(){this.GS=this.listId=
this.id=null;this.level=0}}Object(e.a)(MO,"ListItemInfo",null,[]);class aF extends lu{constructor(a){super();this.KG=a}get ZIf(){return ResourceStrings.l_BulletStyle1}get gfi(){return ResourceStrings.l_BulletStyle1}get hfi(){return ResourceStrings.l_BulletStyle1}a6i(a,b){const c=this.KG.Bba(a),f=this.KG.Z5i(a);return Object.assign(new MO,{id:a.currentNode.id,listId:new Ga.a(lh.a.nil,f),GS:b,level:c+1})}}Object(e.a)(aF,"ListDetailsProvider",lu,[]);class NO{constructor(){this.uI=this.K=null}dispose(){}Wb(a){this.K=
a;this.uI=this.K.resolve("Common.AFrameworkApplication");a.register(YE,"PowerPointWebEditor.PPTImageStewardFactory").as("Box4.Actors.IBox4ImageStewardFactory").ma().na(()=>new YE(a.resolve("PowerPointWebEditor.IApplicationSettings").Xub));a.register(ZE,"PowerPointWebEditor.PPTTableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().na(()=>new ZE(a.resolve("PowerPointWebEditor.IApplicationSettings").Xub));a.register(Nr,"Box4.Actors.PasteCoordinator").ma().na(()=>new Hq(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(251,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().na(()=>new JO(u.AFrameworkApplication.Ta,Sa.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),
ld.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),mg.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(aF,"PowerPointWebEditor.ListDetailsProvider").na(()=>
new aF(a.resolve("PowerPointWebEditor.IPptListCore")));a.register($E,"PowerPointWebEditor.AccessibilityActor").ma().na(()=>new $E(a.La("Box4.Accessibility.IAccessibilityContextManager"),a.Be("PowerPointWebEditor.ListDetailsProvider"),this.uI.KR.kd));a.register(XE,"PowerPointWebEditor.TableCellSelectionStrategy").as("Box4.ITableCellSelectionStrategy").ma().na(()=>new XE)}init(){const a=Gb.App.YC.VR;Nx.fxj(this.uI.$q,this.K.resolve("Common.IReactContextualUILauncher"),a,this.K.resolve("Common.IExternalUICommandDefinitionMapping"));
this.K.resolve("PowerPointWebEditor.AccessibilityActor").UCe()}get name(){return"PowerPointWebEditor.Box4DelayedLoadedPackage"}}Object(e.a)(NO,"Box4DelayedLoadedPackage",null,[2,3]);class OO{constructor(a,b,c,f,l,x,F,R){this.U9a=this.Vsa=null;this.aWc=0;this.XVc=new Me.a(0);this.j$a=this.Tfe=this.J7b=null;this.YVc=!1;this.hFg=[qa.a.contextMenu,qa.a.exa,qa.a.SL,qa.a.mouseDown,qa.a.pointerDown,qa.a.qNa,qa.a.tcb,qa.a.paste];this.yQg=[qa.a.eg,qa.a.ol,qa.a.Cx,qa.a.click,qa.a.doubleClick,qa.a.GQ,qa.a.NJd,
qa.a.WW,qa.a.B5c];this.sI=a;this.Xce=c||[];this.PYj=f||[];this.XZj=l||[];this.QOg=x;this.Mc=b;this.Mc.p2h(Object(D.a)(this,this.xWg,"onAppClosing"));this.Mc.tB(Object(D.a)(this,this.VA,"onSessionEnd"));this.b6j=F;R&&(bd.EventHandlerManager.instance.ZCe(this.hFg,Object(D.a)(this,this.Hhk,"onBeforeEventActionContextCreated")),bd.EventHandlerManager.instance.ibh(this.hFg,Object(D.a)(this,this.Vgk,"onAfterEventActionContextCreated")),bd.EventHandlerManager.instance.ZCe(this.yQg,Object(D.a)(this,this.Ihk,
"onBeforeEventTriggered")),bd.EventHandlerManager.instance.ibh(this.yQg,Object(D.a)(this,this.Wgk,"onAfterEventTriggered")));this.wke=!1}B9(a){if(2===a.behavior){var b=a.actionId;if(this.Lma(b)){var c=this.getCommandName(b);ya.a.J(18956760,817,50,"ActionContextListener::OnBeforeAction "+this.ukg(a,c,"",!1)+"; Current Event: "+(this.j$a||"")+"; Current ActionContext: "+(Mc.a.Cb?Mc.a.Cb.toString():""));if(!this.aWc)if(this.YVc=!0,this.B8k(a)){this.Vsa=Mc.a.Qkd(c);this.wke=!0;a=a.telemetryData;c=this.J7b;
let f=this.Tfe;null===c&&a&&a[ri.a.dBa]&&(c=a[ri.a.dBa],f=Mc.a.UIb(c));null!==f&&(this.Vsa.Wa(ri.a.A2a,f.toFixed(2)),null!==c&&this.Vsa.Wa(ri.a.dBa,c.toFixed(2)));a&&xa.a.forEach(a,(l,x)=>{this.Vsa.ixa(l,(null===x||void 0===x?void 0:x.toString())||"")},null);c=!1;Array.contains(sm.iZk,b)?c=!0:this.Vsa.Ar=!0;c=c||this.Ij(b,a);this.Vsa.Ij=c}else this.Vsa=Mc.a.Cb}this.aWc++}}z9(a){if(2===a.behavior){var b=a.actionId;if(this.Lma(b)){var c=Mc.a.Cb;const f=c?c.mJ(ri.a.Nzf).toString():"";ya.a.J(18956762,
817,50,"ActionContextListener::OnAfterAction "+this.ukg(a,this.getCommandName(b),f,!0)+";Result:"+a.response.toString()+";Current Event:"+(this.j$a||"")+";Current ActionContext:"+(c?c.toString():"")+";RevisionId: "+(c?c.mJ(ri.a.uX).toString():""))}this.R$k(b)&&(c=this.XVc.xMc(b,0),this.XVc.add(b,c+1));this.aWc--;0<this.aWc||!Mc.a.Cb||!this.Vsa||(Mc.a.hk(ri.a.MYh,a.response.toString()),Mc.a.Cb!==this.Vsa||this.U9a||this.rWg(),this.Vsa=null)}}rWg(){const a=Mc.a.Cb;if(a){var b=new Date;a.Ij&&!a.TGb&&
null===a.BE&&(a.BE=b);a.ixa(ri.a.GYh,(+b-+a.TC).toString());a.Ar?0<a.mJ(ri.a.uX).length&&Mc.a.dea(a):Mc.a.ykd();this.wke&&(Mc.a.Cb=null,this.wke=!1)}}Lma(a){if(!this.QOg)return!1;if(Array.contains(this.Xce,a))return!0;a=u.AFrameworkApplication.Ta.iS(a);return!!a&&!(a.flags[32]||a.flags[64])}Ij(a,b){return Array.contains(this.PYj,a)?b&&ri.a.Myc in b?b[ri.a.Myc]:!0:!1}R$k(a){return this.QOg&&Array.contains(this.XZj,a)}B8k(a){return this.b6j?!Mc.a.Cb:!Mc.a.Cb&&a.Vi}ukg(a,b,c,f){if(null===a)return"null";
b="ActionName="+b+", IsTableShapeSelected="+c+", ActionId="+a.actionId+", BeginMode="+a.eBc+", InvocationMethod="+a.vS+", CommandLocation="+a.gq+", CommandTabName="+a.Tpa;return f?"Response="+a.response+", "+b:b}getCommandName(a){const b=this.sI?this.sI.D4(a):null;return b?b:a.toString()}xWg(){if(!(1>this.XVc.count)){var a={};this.XVc.forEach((b,c)=>{b=this.getCommandName(b);a[b]=c;return!0});ya.a.J(512491875,817,15,"ActionContextListener::OnAppClosed {0}",fe.c(a));this.Mc.HOk(Object(D.a)(this,this.xWg,
"onAppClosing"))}}VA(){Mc.a.bmi()}Hhk(a){this.j$a=a.type;this.U9a=Mc.a.Qkd(this.j$a);this.U9a.Ij=!0;this.YVc=!1;a=Mc.a.Bkd(a);null!==a&&Mc.a.Zol(a)&&this.U9a.Wa(ri.a.dBa,a.toFixed(2))}Vgk(){this.U9a&&Mc.a.Cb===this.U9a&&this.YVc&&this.rWg();Mc.a.Cb=null;this.YVc=!1;this.U9a=this.j$a=null}Ihk(a){this.j$a=a.type;this.J7b=Mc.a.Bkd(a);null!==this.J7b&&(this.Tfe=Mc.a.UIb(this.J7b))}Wgk(){this.j$a=this.Tfe=this.J7b=null}}Object(e.a)(OO,"ActionContextListener",null,[156]);var kR=d(364),lR=d(424);class bF{constructor(){this.K=
null;this.FEg=[];this.Bk=null;this.Ita="";this.HW=[new NO,new DO];this.B8=!!window.performance&&!!window.performance.now}get name(){return"PowerPointWebEditor.EditingPackage"}Wb(a){this.Ita=String.format("EditingPackage ConfigureStart:{0}",(new Date).getTime());og.a.instance.ic("EditingPackageConfigureStart",Date.now());this.K=a;this.ub();for(const b of this.HW)b.Wb(a);this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ctg&&this.K.register(219,"PowerPointWebEditor.ISlideMasterPrefetchManager").ma().na(()=>
new EO(this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(7),this.K.resolve("Box4.Graph.IGraphInstance").Bd(8),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler")));this.K.register(RE,"PowerPointWebEditor.UpdateCommandUIActionListener").ma().na(()=>new RE(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers")))}Pkj(a,b,c){return 1===c?32:2===c?(this.Axj(),ya.a.J(512497352,822,50,"Draw tab was clicked."),this.K.resolve("Common.IActionManagerExtended").processAction(ba.a.omg,2),32):8}Xwj(){const a=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");
a.yq();this.K.resolve("Box4.IGeneralCuiUser");a.updateCommandUI()}gmg(a){const b=this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader");b.rTf=!0;b.Zth=a;b.kAg()}jTj(a,b){ya.a.J(512497351,835,50,"Init GC2 started");const c=new Date,f=this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.IGraphicalContentComponentsDependencyLoader");f.MTj().continueWith(l=>{var x=new Date;ya.a.J(512497350,813,50,"gc2 dependency loader loadJS starts: {0}, ends: {1}, durationMS: {2}",Mc.a.Ye(c),
Mc.a.Ye(x),+x-+c);if(6===l.status){l=IJ.a({});const F=(x=$C())&&l&&(b||a);ya.a.J(512497349,835,50,"{0}",{["message"]:"InitializeGraphicalContentComponents",["gc2ShapeBuilderImageRenderingEnabled"]:a,["gc2PreloadShadersEnabled"]:b,["isBrowserShapeBuilderCompatible"]:l,["browserSupportsWebGL"]:x,["shouldUseShapeBuilder"]:F});l=F?document.createElement("canvas"):null;f.txj(l,this.K.resolve("Gc2.IGlyphStore"))}}).continueWith(l=>{6!==l.status&&ya.a.J(512497348,835,10,"Exception: {0}",l.Ui)})}Dyj(){this.K.resolve("PowerPointWebEditor.Video.IVideoDependencyLoader").nAg()}Axj(){this.K.resolve("PowerPointWebEditor.Ink.IInkDependencyLoader").gwb().continueWith(()=>
{this.K.resolve("PowerPointWebEditor.WetInkView")})}ub(){this.K.resolve("Common.IActionManagerExtended").xa(ba.a.Eeh,de.a.frame,Object(D.a)(this,this.Pkj,"handleDrawTabClicked"))}init(){const a=!this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation;this.Ita=String.format("{0}, InitStart:{1}, OpenEarlyNotBack:{2}",this.Ita,(new Date).getTime(),a);og.a.instance.ic("EditingPackageInitStart",Date.now());a?(this.Bk=this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.Bk.TCf(Object(D.a)(this,this.Jlg,"initEditingPackage"))):this.Klg()}Jlg(){this.Bk.mdh(Object(D.a)(this,this.Jlg,"initEditingPackage"));this.Klg()}Klg(){const a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");this.Ita=String.format("{0}, IsBootComplete:{1}, OnBootCompleteTime:{2}",this.Ita,a.Iia,(new Date).getTime());a.LCa(()=>{this.Ivj(a)});a.xqg(()=>{this.jsi()})}Ivj(a){this.Ita=String.format("{0}, InitStartInternal:{1}",this.Ita,(new Date).getTime());og.a.instance.ic("EditingPackageInitStartInternal",
Date.now());var b=this.K.resolve("Common.AFrameworkApplication");const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),f=new HO;f.Wb(this.K);f.load(b);for(const x of this.HW)x.init();c.pptSkipFidelityImageFetchDuringBootIfRemoveFidelityEnabled&&(hb.a.instance.resolve("PowerPointWebEditor.IImageViewManager").vgb(),c.RRa&&b.$q.Wjg());this.Xwj();this.K.resolve("Common.IActionManagerExtended").Zla(new OO(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
sm.xAg,sm.DUj,c.Yoi,c.cKj,c.podsEnableAyncActionContext,c.actionContextEnableEventCallbacks));if(c.fBb){let x=null;(b=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(b=ae.e(b,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma))?x=b.Oaa:ya.a.J(512497347,809,10,"slideViewElement is null."):ya.a.J(512497346,809,15,"activeSlide is null. SlideCount: "+this.K.resolve("PowerPointWebEditor.IPresentationReader").Nj());this.K.register(220,"PowerPointWebEditor.ICommentShimmerView").ma().na(()=>
new FO(x,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Common.ITaskManager"),c.tpi))}this.K.resolve("Common.IActionManagerExtended").Zla(this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener"));a.Tra||(tj.a.instance.oCe((new Date).getTime()),c.podsRibbonEarlyRendererExposureControl&&
c.fBb&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(()=>{PowerPointWebEditor.MinimalBoot.SetRealRibbon("OnContentEditable")}),kR.a.lIk(),this.K.resolve("PowerPointWebEditor.ISessionState").w4("AppInteractive"),this.B8&&og.a.instance.ic("ContentEditablePerfMark",window.performance.now()),this.K.resolve("PowerPointWebEditor.IPPTRumTracker").Pua("canvas","slide"),c.podTransmitMetricsBeaconOnBoot&&(Gz.App.EFb(null,Wh.a.contentEditable),this.dVj()),
pd.a.get_instance().gJ(4),a.Tra=!0);c.fBb&&((a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(a=a.PE(),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader").sig(a)&&(this.K.resolve("PowerPointWebEditor.ICommentShimmerView").Qcl(),ya.a.J(512497345,809,50,"CommentLandingSlide: true"))):ya.a.J(512497344,809,10,"activeSlide is null"));og.a.instance.ic(lR.a.VTd,(new Date).getTime());c.anc?this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Iha("pptedit.extcommon",
null,()=>d.e(6).then(d.bind(null,1205))):(a=xz.a.create("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,1205))),Xi.a.wx(a));this.Dyj();(a=this.K.resolve("Common.Utils.IHighContrastDetector"))&&a.isInHighContrastMode&&ya.a.J(512497315,809,50,"HighContrastMode enabled");!c.w7d||a&&a.isInHighContrastMode?c.O5d&&c.w7d&&this.gmg(!1):this.gmg(!0);c.lOc&&(this.FEg.push(this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.Gc2WebSocketFrontDoorResponseHandler")),this.jTj(c.dKc,c.rVi));u.AFrameworkApplication.wu||
(u.AFrameworkApplication.wu=ya.a.qWb());c.Ctg&&this.K.resolve("PowerPointWebEditor.ISlideMasterPrefetchManager");const l=this.K.pb("Common.IFrameTimingMeter");l&&(ya.a.J(512497314,809,50,"Frame timing meter start:{0}",window.performance.now()),l.start(this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterReportingIntervalInSeconds),this.K.resolve("Common.ITaskManager").Gb(new He.a(3,1,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterRunningTimeInMiliseconds,
()=>{l.stop()},90,"93")));this.Ita=String.format("{0}, InitDone:{1}",this.Ita,(new Date).getTime());og.a.instance.ic("EditingPackageInitDone",Date.now());ya.a.J(512497313,809,50,this.Ita)}jsi(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");ya.a.J(39370892,809,50,"Connect RTC by default: BrowserToServerRtc:{0}",a.podsTriggerServerRtcConnectionFromBrowserIsEnabled);const b=Date.now(),c=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter");c.xBh("{"+u.AFrameworkApplication.userSessionId+
"}");const f=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").$1i();f&&(c.fnc(0<f.length?2:1),c.RAh(f),this.K.resolve("PowerpointPresence.IPresencePerfLogger").EVj(Date.now(),f.length));this.K.resolve("PowerPointWebEditor.PresenceLoader").t_f();this.K.resolve("PowerPointWebEditor.CoauthNotificationManager");this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").lmg();ya.a.J(512497312,828,50,"PresenceCallback took {0}ms",Date.now()-b);a.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&
u.AFrameworkApplication.fa.ff(Object(D.a)(this.K.resolve("PowerPointWebEditor.CoauthNotificationManager"),this.K.resolve("PowerPointWebEditor.CoauthNotificationManager").Ish,"startServerRtcConnection"))}dVj(){if(og.a.instance.o7a)ya.a.J(512497311,813,15,"LogBootMetrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};for(var b of[Wh.a.rBa,Wh.a.Z4f,Wh.a.a5f,Wh.a.TJc,Wh.a.$4f,Wh.a.inb,Wh.a.pAc,Wh.a.dba,Wh.a.jP,Wh.a.contentEditable,Wh.a.Dnc,"UserClickTime",
"DocPageNavigationStart","DocPageFetchStart","DocPageResponseStart","DocPageResponseEnd","BootJsStartTime","BootJsEndTime",Wh.a.idd,"BootSegments","BootOperations","EditingPackageInitStartInternal","FirstExtJsExecTime","PageViewValidationStart","PageViewValidationDuration","AllViewsValidationDuration","ViewValidationYieldTime","ViewValidationYieldCount","ThumbnailNavigationPaneViewValidationStart","ThumbnailNavigationPaneViewValidationDuration","TMYielded","MicrosoftAjaxLoadStartTime","HermesIntlLoadStartTime",
"EditCoreJsExecStartTime","EditCoreJsLoadStartTime","EditCoreJsLoadEndTime","EditingPackageConfigureStart","EditingPackageInitStart","EditExtSliceTaskRegTime",Wh.a.nZb,Wh.a.oZb,"MBootFirstImgReqStart","MBootFirstImgReqEnd","MBootFirstImgDrawEnd","MBootRetryCount","MBootCacheHit","NPLT","SplashScreenShown","LogoScreenHideTime","SplashScreenHideSource","SplashScreenTextShownTime","OpenEarlyRequestServerReceived","OpenEarlyRequestServerEnd","OpenEarlyImagesRequestStartTime","OpenEarlyImagesRequestEndTime",
"OpenEarlyImagesRequestImagesCount","OpenEarlyClientRequestSentTime","OpenEarlyClientResponseReceivedTime","TimeDiffToOpenEarly","OpenEarlyCacheDisposed","DocModelManagerLoadAsyncStart","DocModelManagerLoadDocModelEnd","DocModelManagerGetObjectsStart","DocModelManagerGetObjectsEnd","DocModelManagerOnDocModelChanged","DocModelManagerGetHeadersEnd","FluidNewContainerStart","FluidNewContainerAfterCreateDocModel","FluidNewContainerBeforeAttach","FluidNewContainerAfterAttach","FluidNewContainerEnd","ParseOpenEarlyServerResponseStart",
"ParseOpenEarlyServerResponseEnd","AppBootCompleted","FirstDrawStarted","EditingPackageRegisterTime","PackageConfigurerAndInitiatorStartTime","CalculateVisibleThumbRangeWaitTime","CalculateVisibleThumbRangeStartTime"])og.a.instance.Wn(b)&&(a[b]=og.a.instance.Rg(b));u.AFrameworkApplication.fa.Ha("PodSID")&&(a.PodSessionID=u.AFrameworkApplication.fa.Ha("PodSID"));(b=window.self.RealRibbonDisplayTime)&&(a.RealRibbonDisplayTime=b);(b=window.self.RealRibbonDisplaySource)&&(a.RealRibbonDisplaySource=b);
(b=window.self.ThumbnailShimmerHideTime)?a.ThumbnailShimmerHideTime=b:og.a.instance.Wn("ThumbnailShimmerHideTime")&&(a.ThumbnailShimmerHideTime=og.a.instance.Rg("ThumbnailShimmerHideTime"));ya.a.J(39184516,809,50,"Perf metrics: "+xa.a.toJSON(a));b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");b.xIj&&this.YWj(a,b)}}YWj(a,b){if(a[Wh.a.jP])if(a[Wh.a.contentEditable])if(a.UserClickTime||a.DocPageFetchStart){if(a[Wh.a.contentEditable]-a[Wh.a.jP]>b.Lai){var c=new Map;c.set("ContentEditable",
a[Wh.a.contentEditable].toString());c.set("ContentViewable",a[Wh.a.jP].toString());Se.Health.instance.recordQosError("InteractiveOpenSlowError",["InteractiveOpenSlow"],!1,!0,!1,!1,Object.assign(new Fk.a,{extendedProperties:c}))}c=b.IMi;b=a.UserClickTime?a.UserClickTime:a.DocPageFetchStart;a[Wh.a.jP]-b>c&&(c=new Map,c.set("TimingOrigin",b.toString()),c.set("ContentViewable",a[Wh.a.jP].toString()),Se.Health.instance.recordQosError("PerceivedOpenSlowError",["PerceivedOpenSlow"],!1,!0,!1,!1,Object.assign(new Fk.a,
{extendedProperties:c})))}else ya.a.J(512497308,809,15,"Both UserClickTime and DocPageFetchStart are null");else ya.a.J(512497309,809,15,"ContentEditable is null");else ya.a.J(512497310,809,15,"ContentViewable is null")}dispose(){for(const a of this.HW)a.dispose();for(const a of this.FEg)a.dispose();this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener").dispose()}static main(){const a=(new Date).getTime();ya.a.J(38876352,809,50,"EditingPackage::Register time:{0}",a);og.a.instance.ic("EditingPackageRegisterTime",
a);m.a.instance.Ac(new bF)}}Object(e.a)(bF,"EditingPackage",null,[2,3]);var mR=d(568);class cF{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc,lc,Ec){this.fka=this.D8=!1;this.jL={};this.l3=this.yI=null;this.gva=()=>{this.D8&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!f)throw Error.argumentNull("viewPanelContainer");if(!l)throw Error.argumentNull("selectionManager");if(!x)throw Error.argumentNull("shapeReader");
if(!F)throw Error.argumentNull("pageView");if(!R)throw Error.argumentNull("actionManager");if(!fa)throw Error.argumentNull("slideDimensionsHelper");if(!wa)throw Error.argumentNull("presentationReader");if(!Xa)throw Error.argumentNull("transactionFactory");if(!lb)throw Error.argumentNull("pptPageView");if(!Lb)throw Error.argumentNull("applicationSettings");if(!kc)throw Error.argumentNull("viewElementEventHandlers");if(!lc)throw Error.argumentNull("viewCoreEventHandlers");this.Nb=a;this.Hc=b;this.ve=
c;this.cGa=f;this.ra=l;this.Ea=x;this.Qb=F;this.ia=R;this.Gt=Ec;this.Pz=fa;this.yc=wa;this.Db=Xa;this.Ene=lb;this.Doe=Lb.Rgh;this.Foe=Lb.Qgh;this.od=kc;this.NI=lc}get sbc(){return document.getElementById(I.AppFrame.GDh)}dispose(){this.D8=!1;this.Nb.Och(Object(D.a)(this,this.renderRuler,"renderRuler"));yd.a.removeHandler(this.sbc,qa.a.scroll,Object(D.a)(this,this.Ehb,"updateRulerLocation"));this.od.XDe(Object(D.a)(this,this.Occ,"onCloseTextEditView"));this.od.Fcd(Object(D.a)(this,this.mdc,"onOpenTextEditView"));
this.NI.vcd(this.gva);this.yI&&this.l3?(Ba.a.vHa(this.yI,"ShowWACHorizontalRulerContainer"),Ba.a.OH(this.yI,"HideWACHorizontalRulerContainer"),yj.UISurfaces.WMc().then(a=>{a.dispose(this.l3);return null}),this.yI.removeChild(this.l3),this.cGa.removeChild(this.yI),this.l3=this.yI=null):ya.a.J(512496006,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.yI&&this.l3){Ba.a.vHa(this.yI,"HideWACHorizontalRulerContainer");Ba.a.OH(this.yI,"ShowWACHorizontalRulerContainer");
var b=this.Hc.Jc;if(b&&b.Nd){var c=b.Nd;c=new er.a(c.Yp,c.Ek);b=this.Pz.o0b(c,b.Oaa?b.Oaa.ya.style.visibility===Ii.a.visible:!1).width;c=this.ve.Yh(this.Hc.Jc.rC).width;1===this.Ene.Nu||0>=b||0>=c?ya.a.J(512496003,824,50,"Ruler should not be rendered"):(this.jL.rulerCanvasProps=this.Tvk(Fd.a.Uda(b,0)),c=Object(D.a)(this,this.Nkk,"onIndentChange"),this.jL.onIndentChange=c,this.jL.indents=this.jL.rulerCanvasProps.textEditableArea?this.Bwk():null,this.jL.rtl=this.fka?!this.Gt:this.Gt,this.jL.inverted=
this.fka?!this.Gt:this.Gt,this.l3.style.width=this.ve.Lc(b),this.Ehb(null),yj.UISurfaces.WMc().then(f=>{f.renderRuler(this.l3,this.jL);return null}),b=window.performance.now(),ya.a.J(512496002,824,15,"HorizontalRenderRulerDuration:{0}",(b-a).toString()))}else ya.a.J(512496004,824,50,"Unable to get slideViewElement")}else ya.a.J(512496005,824,50,"Ruler container div / Ruler div null")}Tvk(a){const b={},c=je.a.mv(this.yc.An.getValue(ub.a.slideWidth));var f=a/2;let l=0,x=Fd.a.nJ(a,0);b.zeroScale=Fd.a.nJ(f,
0);this.fka=!1;b.textEditableArea=!1;if(this.ra.D7()&&!this.ra.gSa()){f=this.ra.lZ();var F=f.oc(this.Qb.Ma),R=F.rotation;R>this.Doe&&R<this.Foe&&(this.fka=!0);const fa=F.htmlElement.querySelector(".ShapeViewContent"),wa=this.Ea.eMc(f,this.Qb.Cd);R=0;f.mh&&(R=f.Pr().oc(this.Qb.Ma).htmlElement.offsetLeft);R+=F.htmlElement.offsetLeft+fa.parentNode.offsetLeft+(wa?wa.e:0);F=R+fa.offsetWidth;f=(this.fka?!this.Gt:this.Gt)?F:R;R>=l&&R<=x&&F>=l&&F<=x&&(l=R,x=F,b.zeroScale=f,b.textEditableArea=!0)}R=je.a.Mra(c)/
a;a=R*Fd.a.Uda(x-l,0);R*=Fd.a.Uda(l,0);b.leftMargin=l;b.rightMargin=x;b.precision=.0625;b.scale=c;b.rulerType="Horizontal";b.rightBoundary=je.a.qJa(a);b.leftBoundary=je.a.qJa(R);return b}mdc(){this.D8&&this.renderRuler()}Occ(){this.D8&&this.renderRuler()}Bwk(){var a={};if(32!==this.ia.Ka(C.a.VDb,2,a))return ya.a.J(512496001,824,10,"Unable to read paragraph indentation for Ruler"),null;const b={type:"FirstLineIndent"},c={type:"HangingIndent"},f={type:"LeftIndent"};a=a.xA;if(!a)return ya.a.J(512496E3,
824,10,"indentInfo is null"),null;b.value=1===a.specialIndentType?je.a.qJa(a.tHb+a.aN):2===a.specialIndentType?je.a.qJa(a.aN-a.tHb):je.a.qJa(a.aN);c.value=je.a.qJa(a.aN);f.value=je.a.qJa(a.aN);return[b,c,f]}Nkk(a,b){const c=new mR.a;c.Pf=1;c.value=je.a.Mra(b);this.gvj(a,c)}gvj(a,b){var c=this.ra.lZ();if(a&&b&&c){var f=window.performance.now(),l=this.Db.je(15);l.jc(c);c=8;switch(a){case "FirstLineIndent":c=this.ia.Ka(ba.a.rGb,2,b);l.$c=ba.a.rGb;break;case "HangingIndent":c=this.ia.Ka(ba.a.tGb,2,b);
l.$c=ba.a.tGb;break;case "LeftIndent":c=this.ia.Ka(ba.a.zia,2,b);l.$c=ba.a.zia;break;default:ya.a.J(512495970,824,10,"IndentChangeHandler called with invalid type")}l.dispose();b=window.performance.now();ya.a.J(512495969,824,15,"Indent type:{0} indentChangeDuration: {1}",a,(b-f).toString());32!==c&&ya.a.J(512495968,824,10,"Indent operation: {0} failed",c)}else ya.a.J(512495971,824,10,"IndentChangeHandler called with invalid params")}$I(){this.OFd();this.D8=!0;this.Nb.sCf(Object(D.a)(this,this.renderRuler,
"renderRuler"));yd.a.addHandler(this.sbc,qa.a.scroll,Object(D.a)(this,this.Ehb,"updateRulerLocation"));this.od.Qzc(Object(D.a)(this,this.Occ,"onCloseTextEditView"));this.od.RSb(Object(D.a)(this,this.mdc,"onOpenTextEditView"));this.NI.zzc(this.gva)}Ehb(){if(this.D8){var a=this.Hc.Jc;a&&a.rC&&window.requestAnimationFrame(()=>{const b=kb.a.e6a(a.rC),c=kb.a.e6a(this.cGa);this.l3.style.marginLeft=this.ve.Lc(b.x-c.x+1)})}else ya.a.J(512495967,824,10,"UpdateRulerLocation called with cookie value false")}oLi(){if(this.yI)return this.yI;
this.yI=document.createElement("div");this.yI.id="WACHorizontalRulerContainer";this.yI.className="WACHorizontalRulerContainer";this.yI.setAttribute(Uc.a.vs,"ruler");this.yI.setAttribute(Uc.a.We,Uc.a.Kza);Sys.UI.DomElement.addCssClass(this.yI,"HideWACHorizontalRulerContainer");return this.yI}pLi(){if(this.l3)return this.l3;this.l3=document.createElement("div");this.l3.className="WACHorizontalRuler";this.l3.id="WACHorizontalRuler";return this.l3}OFd(){this.yI=this.oLi();this.yI.appendChild(this.pLi());
this.cGa.insertBefore(this.yI,this.cGa.firstChild)}}Object(e.a)(cF,"HorizontalRuler",null,[241]);class dF{constructor(a,b,c,f,l){this.BEj=!0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeAppFrame");if(!c)throw Error.argumentNull("rulerFactory");if(!f)throw Error.argumentNull("horizontalRuler");if(!l)throw Error.argumentNull("verticalRuler");this.ia=a;this.Nb=b;this.bOg=c;this.jZc=f;this.e4c=l}ub(){this.ia.pa(ba.a.ALe,Fb.a.application,Object(D.a)(this,this.ALe,
"showHideRuler"),4);this.ia.pa(ba.a.gBe,Fb.a.application,Object(D.a)(this,this.gBe,"queryRulerToggle"),96)}gwj(){this.qTc()&&(ya.a.J(523351431,824,15,"Ruler init is called"),this.bOg.fmg())}ALe(a,b,c){return this.qTc()?this.hsj(c):this.Ncl(c)}WBh(){this.Nb.HF({ShowHideRuler:"ToggleButtonModel"})}Ncl(a){if(1===a)return 32;ya.a.J(523351432,824,15,"ShowRuler called");this.bOg.fmg();this.Xlh(!0);this.Nb.yq();this.WBh();return 32}hsj(a){if(1===a)return 32;ya.a.J(523351433,824,15,"HideRuler called");this.hHi();
this.Xlh(!1);this.Nb.yq();this.WBh();return 32}hHi(){this.qTc()&&(this.jZc.dispose(),this.e4c.dispose(),this.Nb.yq())}gBe(a,b,c,f,l){if(1===c)return 32;l&&(l[ai.a.On]=this.qTc());return 32}qTc(){return Hi.a.yBa(KE.a.G5g,this.BEj)}Xlh(a){Hi.a.JL(u.AFrameworkApplication.fa.Ha("IsRulerOnCookieName"),a.toString(),Hi.a.rL)}}Object(e.a)(dF,"RulerActor",null,[]);class PO{constructor(a,b,c){if(!a)throw Error.argumentNull("horizontalRuler");if(!b)throw Error.argumentNull("verticalRuler");if(!c)throw Error.argumentNull("appFrame");
this.jZc=a;this.e4c=b;this.Nb=c}fmg(){this.jZc.$I();this.e4c.$I();this.Nb.yq();this.jZc.renderRuler();this.e4c.renderRuler()}}Object(e.a)(PO,"RulerFactory",null,[214]);class Iq{constructor(a,b,c,f,l,x,F,R,fa,wa,Xa,lb,Lb,kc){this.lKd="HideWACVerticalRulerContainer";this.cKf="ShowWACVerticalRulerContainer";this.fka=this.D8=!1;this.Y3=this.MI=null;this.gva=()=>{this.D8&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");
if(!l)throw Error.argumentNull("selectionManager");if(!x)throw Error.argumentNull("shapeReader");if(!F)throw Error.argumentNull("pageView");if(!R)throw Error.argumentNull("slideDimensionsHelper");if(!fa)throw Error.argumentNull("presentationReader");if(!wa)throw Error.argumentNull("pptPageView");if(!Xa)throw Error.argumentNull("applicationSettings");if(!lb)throw Error.argumentNull("viewElementEventHandlers");if(!Lb)throw Error.argumentNull("viewCoreEventHandlers");this.Nb=a;this.Hc=b;this.ve=c;this.cGa=
f;this.ra=l;this.Qb=F;this.yc=fa;this.Gt=kc;this.Pz=R;this.Ene=wa;this.Doe=Xa.Rgh;this.Foe=Xa.Qgh;this.od=lb;this.NI=Lb}get sbc(){return document.getElementById(I.AppFrame.GDh)}dispose(){this.D8=!1;yd.a.removeHandler(this.sbc,qa.a.scroll,Object(D.a)(this,this.Ehb,"updateRulerLocation"));this.Nb.Och(Object(D.a)(this,this.renderRuler,"renderRuler"));this.od.XDe(Object(D.a)(this,this.Occ,"onCloseTextEditView"));this.od.Fcd(Object(D.a)(this,this.mdc,"onOpenTextEditView"));this.NI.vcd(this.gva);this.MI&&
this.Y3?(Ba.a.vHa(this.MI,this.cKf),Ba.a.OH(this.MI,this.lKd),yj.UISurfaces.WMc().then(a=>{a.dispose(this.Y3);return null}),this.MI.removeChild(this.Y3),this.cGa.removeChild(this.MI),this.Y3=this.MI=null):ya.a.J(512495966,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.MI&&this.Y3){Ba.a.vHa(this.MI,this.lKd);Ba.a.OH(this.MI,this.cKf);var b=this.Hc.Jc;if(b&&b.Nd){var c=b.Nd;c=new er.a(c.Yp,c.Ek);b=this.Pz.o0b(c,b.Oaa?b.Oaa.ya.style.visibility===
Ii.a.visible:!1).height;c=this.ve.Yh(this.Hc.Jc.rC).height;if(1===this.Ene.Nu||0>=b||0>=c)ya.a.J(512495963,824,50,"Ruler should not be rendered");else{var f={};f.rulerCanvasProps=this.Dwk(Fd.a.Uda(b,1));f.rtl=this.fka?!this.Gt:this.Gt;f.inverted=this.fka?!this.Gt:this.Gt;this.Y3.style.height=this.ve.Lc(b);this.Ehb(null);yj.UISurfaces.WMc().then(l=>{l.renderRuler(this.Y3,f);return null});b=window.performance.now();ya.a.J(512495962,824,15,"VerticalRenderRulerDuration:{0}",(b-a).toString())}}else ya.a.J(512495964,
824,50,"Unable to get slideViewElement")}else ya.a.J(512495965,824,50,"Ruler container div / Ruler div null")}Dwk(a){const b={},c=je.a.mv(this.yc.An.getValue(ub.a.slideHeight));var f=a/2;let l=0;a=Fd.a.nJ(a,0);b.zeroScale=Fd.a.nJ(f,0);this.fka=!1;b.textEditableArea=!1;if(this.ra.D7()&&!this.ra.gSa()){f=this.ra.lZ();var x=f.oc(this.Qb.Ma);const R=x.htmlElement.querySelector(".ShapeViewContent");var F=x.rotation;F>this.Doe&&F<this.Foe&&(this.fka=!0);F=0;f.mh&&(F=f.Pr().oc(this.Qb.Ma).htmlElement.offsetTop);
F+=x.htmlElement.offsetTop+R.parentNode.offsetTop+R.offsetTop;x=F+R.offsetHeight;f=(this.fka?!this.Gt:this.Gt)?x:F;F>=l&&F<=a&&x>=l&&x<=a&&(l=F,a=x,b.zeroScale=f,b.textEditableArea=!0)}b.precision=.0625;b.topMargin=l;b.bottomMargin=a;b.rulerType="Vertical";b.scale=c;return b}$I(){this.OFd();this.D8=!0;yd.a.addHandler(this.sbc,qa.a.scroll,Object(D.a)(this,this.Ehb,"updateRulerLocation"));this.Nb.sCf(Object(D.a)(this,this.renderRuler,"renderRuler"));this.od.Qzc(Object(D.a)(this,this.Occ,"onCloseTextEditView"));
this.od.RSb(Object(D.a)(this,this.mdc,"onOpenTextEditView"));this.NI.zzc(this.gva)}Ehb(){if(this.D8){var a=this.Hc.Jc;a&&a.rC&&window.requestAnimationFrame(()=>{const b=kb.a.e6a(a.rC),c=kb.a.e6a(this.cGa);this.Y3.style.marginTop=this.ve.Lc(b.y-c.y+1)})}else ya.a.J(512495961,824,10,"UpdateRulerLocation called with cookie value false")}mdc(){this.D8&&this.renderRuler()}Occ(){this.D8&&this.renderRuler()}OFd(){this.MI=this.mMi();this.MI.appendChild(this.nMi());this.cGa.insertBefore(this.MI,this.cGa.firstChild)}mMi(){if(this.MI)return this.MI;
this.MI=document.createElement("div");this.MI.id=Iq.bhi;this.MI.className=Iq.ahi;this.MI.setAttribute(Uc.a.vs,"ruler");this.MI.setAttribute(Uc.a.We,Uc.a.Kza);Sys.UI.DomElement.addCssClass(this.MI,this.lKd);return this.MI}nMi(){if(this.Y3)return this.Y3;this.Y3=document.createElement("div");this.Y3.className=Iq.$gi;this.Y3.id=Iq.chi;return this.Y3}}Iq.bhi="WACVerticalRulerContainer";Iq.ahi="WACVerticalRulerContainer";Iq.chi="WACVerticalRuler";Iq.$gi="WACVerticalRuler";Object(e.a)(Iq,"VerticalRuler",
null,[241]);class eF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Ruler"}Wb(a){this.K=a}init(){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Peb){var a=this.K.resolve("PowerPointWebEditor.AppFrame");this.K.register(cF,"PowerPointWebEditor.Ruler.HorizontalRuler").ma().na(()=>new cF(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.Tnc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
u.AFrameworkApplication.isRtl));this.K.register(Iq,"PowerPointWebEditor.Ruler.VerticalRuler").ma().na(()=>new Iq(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.Tnc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),u.AFrameworkApplication.isRtl));this.K.register(214,"PowerPointWebEditor.Ruler.IRulerFactory").ma().na(()=>new PO(this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler"),a));this.K.register(dF,
"PowerPointWebEditor.Ruler.RulerActor").ma().na(()=>new dF(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Ruler.IRulerFactory"),this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler")));this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").ub();pd.a.get_instance().Xj(8,()=>{this.oue()})}}oue(){this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").gwj()}dispose(){}static main(){m.a.instance.Ac(new eF)}}
Object(e.a)(eF,"PPTWebEditorRulerPackage",null,[2,3]);class mA{static get UBl(){return mA.VBl}}mA.VBl="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(e.a)(mA,"ZoomDialogHtml",null,[]);class Yx extends Vh.a{constructor(a,b,c,f,l=!1){super(!1,!1,l);this.iSb=this.hSb=this.Da=this.Boc=null;this.PBl=
"ZoomDialogBoxGroup";this.EMa=a;this.Cyc=b;this.yzf=c;this.Hd=f;this.jg=this.Ddi();this.vd=1;this.kg="ZoomDialog"}get MBe(){return"ListRadioBox"}get fhc(){return"radiobox"}get p9g(){return"WACZoomDialogRadioRow"}get LBe(){return"WACZoomDialogRadioRow-highlight"}get so(){return this.Hd}get p6(){return this.Boc}Mqh(a,b){if(this.SJ)this.tdl(a,b);else{const c={};for(let f=0;f<this.EMa.length;f++)c[this.fhc+f]=this.Cyc[f]===b?!0:!1;this.pj(a,Object(D.a)(this,this.RBl,"zoomDialogHandler"),c);this.mCe();
this.WCe()}}tdl(a,b){var c=Array(this.EMa.length);let f="";for(let l=0;l<this.EMa.length;l++){const x=l.toString();c[l]={["key"]:x,["text"]:this.EMa[l]};b===this.Cyc[l]&&(f=x)}b={};b.dialogChoiceGroupProps={["id"]:this.PBl,["defaultSelectedKey"]:f,["options"]:c};c={["id"]:"OptionsDialog",["bodyControls"]:b};this.pj(a,Object(D.a)(this,this.WBl,"zoomDialogReactHandler"),c)}VYk(){this.Boc=document.getElementsByName(this.MBe)[0];this.yJc(this.p6)}A6(){this.Da||(this.Da=document.getElementById("WACDialogText"));
this.Da&&(this.hSb||(this.hSb=Object(D.a)(this,this.QBl,"zoomDialogClickHandler"),this.Vm.ob(qa.a.click,this.Da,this.hSb)),this.iSb||(this.iSb=Object(D.a)(this,this.SBl,"zoomDialogKeyDownHandler"),this.Ig.ob(qa.a.eg,this.Da,this.iSb)));super.A6();this.pc&&this.Ig.ob(qa.a.ol,this.pc,Object(D.a)(this,this.KM,"dialogDefaultEnterKeyHandler"))}mCe(){this.so.Zk().scope.$o(v.FocusManager.instance().Poa);this.so.Zk().scope.$o(v.FocusManager.instance().Qoa);this.so.Zk().scope.bindAction(v.FocusManager.instance().Poa,
G.a.boc);this.so.Zk().scope.bindAction(v.FocusManager.instance().Qoa,G.a.aoc)}WCe(){const a=document.getElementsByName(this.MBe);for(let b=0;b<a.length;b++){const c=a[b];yd.a.addHandler(c,qa.a.focus,Object(D.a)(this,this.jbd,"radioButtonFocusHandler"));c.checked&&(this.Boc=c)}}RBl(a,b){if(1===a)for(a=0;a<this.EMa.length;a++)if(b[this.fhc+a]){this.yzf(this.Cyc[a]);break}}jbd(a){this.yJc(a.target)}QBl(a){a=a.Fc;if(!a||!a.parentNode||"label"!==a.tagName.toLowerCase()&&!a.className.startsWith(this.p9g))return!1;
a=this.v$f(a);a=document.getElementById(this.fhc+a);this.yJc(a);return!0}WBl(a,b){1===a&&(a=Number.parseInvariant(b.selectedOption.toString()),this.yzf(this.Cyc[a]))}SBl(a){a=a.lc.keyCode;if(a!==Sys.UI.Key.down&&a!==Sys.UI.Key.right&&a!==Sys.UI.Key.up&&a!==Sys.UI.Key.left)return!1;let b=this.v$f(this.p6);const c=this.EMa.length-1;if(a===Sys.UI.Key.down||a===Sys.UI.Key.right)b=b<c?b+1:0;else if(a===Sys.UI.Key.up||a===Sys.UI.Key.left)b=0<b?b-1:c;a=document.getElementById(this.fhc+b);this.yJc(a);return!0}KM(a){return a.eventName===
qa.a.ol&&a.lc.keyCode===Sys.UI.Key.enter?(super.KM(a),!0):!1}yJc(a){a&&(a.checked=!0,this.so.ye&&this.so.ye.name===this.lK||this.so.Bf(this.lK),this.so.Zk().qj.fE(a),a.focus(),this.p6&&Sys.UI.DomElement.removeCssClass(this.p6.parentNode,this.LBe),Sys.UI.DomElement.addCssClass(a.parentNode,this.LBe),this.Boc=a)}v$f(a){return Number.parseInvariant(Ma.a.substr(a.id,a.id.length-1,1))}DF(){super.DF();const a=document.getElementById(this.hi("WACDialogPanel"));a.style.minWidth=String.format("{0}px",200);
a.style.width=String.format("{0}px",200)}Ddi(){let a="";for(let b=0;b<this.EMa.length;b++)a+=Vh.a.EB(Yx.TBl,b.toString(),this.EMa[b],this.MBe);return a}dispose(){this.Da&&(this.Vm&&this.hSb&&this.Vm.xb(qa.a.click,this.Da,this.hSb),this.Ig&&this.iSb&&this.Ig.xb(qa.a.eg,this.Da,this.iSb));this.Vm&&this.pc&&this.Ig.xb(qa.a.ol,this.pc,Object(D.a)(this,this.KM,"dialogDefaultEnterKeyHandler"));super.dispose()}}Yx.TBl=mA.UBl;Object(e.a)(Yx,"ZoomDialog",Vh.a,[312]);class fF{constructor(){this.tf=null}create(a,
b,c,f){return this.tf=new Yx(a,b,c,f)}}Object(e.a)(fF,"ZoomDialogFactory",null,[310]);class gF{constructor(){this.Da=null}get name(){return"Common.App.Zoom"}init(){}dispose(){}Wb(a){this.Da=a;this.Da.register(fF,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").na(()=>new fF).ma()}static main(){m.a.instance.Ac(new gF)}}Object(e.a)(gF,"ZoomPackage",null,[2,3]);class QO{constructor(a,b,c,f,l,x,F,R){this.K$j=[ResourceStrings.L_ZoomDialogFit,"400%","200%","150%","100%","66%",
"50%","33%"];this.v4c="fittowindow 4 2 1.5 1 0.66 0.5 0.33".split(" ");this.tf=null;this.ia=a;this.Fa=b;this.yc=l;this.Yi=c;this.Nb=f;this.tm=x;this.V3j=F;this.FCg=R}ub(){this.ia.pa(ba.a.n9g,fc.a.application,Object(D.a)(this,this.JDk,"queryZoom"),96);this.ia.xa(ba.a.Iqk,fc.a.application,Object(D.a)(this,this.Wpj,"handleZoomConfig"));this.ia.xa(ba.a.yUe,fc.a.application,Object(D.a)(this,this.Xpj,"handleZoomToFit"));this.ia.xa(G.a.boc,de.a.frame,Object(D.a)(this,this.HEh,"zoomDialogTabFocusHandler"));
this.ia.xa(G.a.aoc,de.a.frame,Object(D.a)(this,this.HEh,"zoomDialogTabFocusHandler"));u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&(this.ia.xa(G.a.bXb,de.a.frame,Object(D.a)(this,this.bXb,"decreaseZoom")),this.ia.xa(G.a.w2b,de.a.frame,Object(D.a)(this,this.w2b,"increaseZoom")),this.ia.xa(G.a.YBl,de.a.frame,Object(D.a)(this,this.Tpk,"onZoomToPercentage")),this.ia.pa(G.a.KDk,de.a.frame,Object(D.a)(this,this.Umk,"onQueryZoomPercentage"),96),ee.a("ZoomShortCutsEnabled")&&(this.ia.xa(C.a.xTf,
de.a.frame,ce.ActionManager.Fg),this.ia.xa(C.a.wTf,de.a.frame,ce.ActionManager.Fg)))}we(){if(u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&ee.a("ZoomShortCutsEnabled")){const a=this.Fa.Bc(Nc.a.gj);a.bindAction(A.KeyInputManager.Na(w.a.imd,A.KeyInputManager.Fe),G.a.w2b);a.bindAction(A.KeyInputManager.Na(w.a.lmd,A.KeyInputManager.Fe),G.a.w2b);a.bindAction(A.KeyInputManager.Na(w.a.jmd,A.KeyInputManager.Fe),G.a.bXb);a.bindAction(A.KeyInputManager.Na(w.a.Inc,A.KeyInputManager.Fe),G.a.bXb);this.FCg&&
ja.a.instance.ob(qa.a.jBb,this.FCg,Object(D.a)(this,this.g7h,"adjustZoomOnMouseWheel"))}}g7h(a){return a?a.UY?(0<a.ZDh?this.yJa(this.HUg):0>a.ZDh&&this.yJa(this.IUg),!0):!1:!1}get n4a(){return Math.round(100*this.Yi.MT)}get IUg(){return Math.floor(this.n4a/10)/10+.1}get HUg(){return Math.ceil(this.n4a/10)/10-.1}JDk(a,b,c,f,l){if(!l||ee.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.n4a)||0==this.n4a))return 8;l[eE.a.LabelText]=Math.round(100*this.Yi.MT)+"%";this.tm&&(this.tm.Qua(this.tm.EYa,this.tm.IEh),
this.tm.Pua(this.tm.EYa,this.tm.IEh));return 32}Wpj(a,b,c,f,l){if(1===c)return this.yc.Nj()?32:8;if(!l)return 8;this.tf=new Yx(this.K$j,this.v4c,Object(D.a)(this,this.Smd,"zoomSettingAction"),v.FocusManager.instance(),this.V3j);this.tf.Mqh(CommonUIStrings.l_ZoomDialogTitle,this.Yi.Qia?this.v4c[0]:this.Yi.MT.toString());return 32}Smd(a){if(a!==this.v4c[0]){const b=parseFloat(a);if(isNaN(b)){ya.a.J(512288459,827,10,"Invalid Zoom Value: {0}",a);return}this.Yi.Qia=!1;this.Yi.MT=b;this.Yi.Thb=2}else this.Yi.Qia=
!0;this.Nb.yq();ya.a.J(512288458,827,50,"Succeeded to Zoom: {0}",a)}Xpj(a,b,c,f,l){if(1===c)return this.yc.Nj()?32:8;if(!l)return 8;this.Smd(this.v4c[0]);return 32}HEh(a){if(!this.tf)return 8;var b=this.tf.so.Zk().qj.YY;if(b===this.tf.wv&&a===G.a.boc||b===this.tf.DC&&a===G.a.aoc)this.tf.p6||this.tf.VYk(),this.tf.so.Zk().qj.fE(this.tf.p6);else if(b.id.startsWith(this.tf.fhc)||b.className.startsWith(this.tf.p9g))b=null,a===G.a.boc?b=this.tf.DC:a===G.a.aoc&&(b=this.tf.wv),this.tf.so.Zk().qj.fE(b),Sys.UI.DomElement.removeCssClass(this.tf.p6.parentNode,
this.tf.LBe);else if(a===G.a.boc)this.tf.so.Zk().mBb();else if(a===G.a.aoc)this.tf.so.Zk().kBb();else return 16;return 32}w2b(a,b,c){if(1===c)return 32;this.yJa(this.IUg);ya.a.J(512288456,827,50,"Increase Zoom triggered via ZoomIn");return 32}bXb(a,b,c){if(1===c)return 32;this.yJa(this.HUg);ya.a.J(512288455,827,50,"Decrease Zoom triggered via ZoomOut");return 32}Tpk(a,b,c,f,l){if(1===c)return 32;a=l.value/100;this.yJa(a);ya.a.J(512288454,827,50,"Zoom changed via zoom slider: {0}",a);f&&(f.pP=Math.floor(100*
a));return 32}Umk(a,b,c,f,l){if(ee.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.n4a)||0==this.n4a))return 8;l.MinValue=10;l.MaxValue=400;l.value=this.n4a;return 32}yJa(a){.1>a?a=.1:4<a&&(a=4);this.Yi.Qia=!1;this.Yi.MT=a;this.Yi.Thb=2;this.Nb.yq()}}Object(e.a)(QO,"ZoomActor",null,[244]);class hF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Zoom"}Wb(a){this.K=a}init(){var a=this.K.resolve("PowerPointWebEditor.IApplicationSettings").L$g;const b=this.K.resolve("PowerPointWebEditor.AppFrame"),
c=this.K.resolve("Common.IActionManagerExtended"),f=this.K.resolve("PowerPointWebEditor.IFocusManager");a=new QO(c,f,this.K.resolve("PowerPointWebEditor.IZoomContext"),b,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a,b.AHd);a.ub();a.we()}dispose(){}static main(){m.a.instance.Ac(new hF)}}Object(e.a)(hF,"PPTWebEditorZoomPackage",null,[2,3]);Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");
Type.registerNamespace("B4Im");Type.registerNamespace("B4LE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4Proofing");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TM");Type.registerNamespace("B4TaE");Type.registerNamespace("B4TaVE");Type.registerNamespace("B4UI");Type.registerNamespace("B4UndoRedo");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.ContentEditable");
Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.ParagraphRenderElements");Type.registerNamespace("Box4.Shortcuts");Type.registerNamespace("Box4.WordPrediction");Type.registerNamespace("Box4.WordPrediction.Telemetry");Type.registerNamespace("ColorPickerManager");Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointLive");
Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Aria");Type.registerNamespace("PowerPointWebEditor.Assistance");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.AutoFit");Type.registerNamespace("PowerPointWebEditor.CoreExt");Type.registerNamespace("PowerPointWebEditor.DragDrop");Type.registerNamespace("PowerPointWebEditor.DynamicScriptLoader");Type.registerNamespace("PowerPointWebEditor.ErrorHandling");
Type.registerNamespace("PowerPointWebEditor.EventTiming");Type.registerNamespace("PowerPointWebEditor.Fonts");Type.registerNamespace("PowerPointWebEditor.GraphEditor");Type.registerNamespace("PowerPointWebEditor.GraphMerge");Type.registerNamespace("PowerPointWebEditor.HtmlExport");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.ModernFontPicker");Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Paragraph");
Type.registerNamespace("PowerPointWebEditor.PodsPops");Type.registerNamespace("PowerPointWebEditor.PowerPointFeedback");Type.registerNamespace("PowerPointWebEditor.PresenterView");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.Proofing.CloudAL");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.Ribbon");Type.registerNamespace("PowerPointWebEditor.Ruler");Type.registerNamespace("PowerPointWebEditor.ShapeEdit");
Type.registerNamespace("PowerPointWebEditor.ShapeManipulation");Type.registerNamespace("PowerPointWebEditor.SlideShow");Type.registerNamespace("PowerPointWebEditor.SmartArt");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.Storage");Type.registerNamespace("PowerPointWebEditor.Table");Type.registerNamespace("PowerPointWebEditor.TableStyleEditor");Type.registerNamespace("PowerPointWebEditor.Telemetry");Type.registerNamespace("PowerPointWebEditor.TextEditing");
Type.registerNamespace("PowerPointWebEditor.TextFormatting");Type.registerNamespace("PowerPointWebEditor.UI");Type.registerNamespace("PowerPointWebEditor.UndoRedo");Type.registerNamespace("PowerPointWebEditor.UnifiedApp");Type.registerNamespace("PowerPointWebEditor.ViewEventHandler");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("TableCellMargin");Type.registerNamespace("PowerPointWebEditor.Zoom");window.g_hermesExtJS=
Date.now();M.main();ea.main();Qd.main();Ge.main();yk.main();rn.main();m.a.instance.Ac(new Sj);Wa.main();Ll.main();Io.main();wn.main();Jo.main();bn.main();xo.main();Ek.main();kp.main();hi.main();mr.main();Uk.main();Type.registerNamespace("Common.App.AccountSwitching");Bo.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("CommonUI");Type.registerNamespace("Common.App.HostNotification");Lp.main();Type.registerNamespace("Common");
pu.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");ru.main();Type.registerNamespace("Common.App.ImageProcessor");Type.registerNamespace("Common.App.NewAndOpen.Core");m.a.instance.Ac(new Tv);Type.registerNamespace("Common");Type.registerNamespace("Common.App.People");Vv.main();Gu.main();ww.main();Type.registerNamespace("Common.App.People");Kw.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");window.MSOJS=Rp;hj.main();Type.registerNamespace("Common");
m.a.instance.Ac(new Ym);Type.registerNamespace("CAUI");xr.main();Type.registerNamespace("Common.App.SaveStatus");m.a.instance.Ac(new jF);Type.registerNamespace("Fdbk");Type.registerNamespace("Common.App.CustomerFeedback");d(1096).CustomerFeedbackPackage.main();Type.registerNamespace("Common.App.Zoom");gF.main();window.PPTUserInitiatedSurveysDictionary_FromAppPackage={PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,
promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},TellMeSurvey:{campaignId:"e55e81b0-5645-4111-b08e-18d7cdaf2bef",commentQuestion:"Please tell us more. Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"How satisfied are you with using Microsoft Search in PowerPoint?",ratingValuesAscending:["Very dissatisfied","Dissatisfied ","Neutral","Satisfied","Very satisfied"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We'd love your feedback on Microsoft Search in PowerPoint"}};sA.main();Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");
Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.React");tA.main();AA.main();CA.main();DA.main();EA.main();FA.main();KA.main();LA.main();TA.main();window.PowerPointEditingJewelRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"PptJewel",DefaultSelection:"PptJewel.Open",TextDirection:"STR@L_TextDirection",LabelText:"STR@L_JewelText",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",
attrs:{Id:"PptJewel.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptJewel.PrimaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.PrimaryMenu.Controls"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@prt2@CloseFileMenuPowerPoint_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Info",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Info.Menu"},
children:[{name:"MenuSection",attrs:{DisplayMode:"MenuFileName",Title:"STR@L_Info",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblBreadcrumbDocName",QueryCommand:"0xE55B9734",LabelText:""}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Info.OpenInClient",LabelText:"STR@L_OpenInPowerPoint",Description:"STR@L_OpenInPowerPointDescription",
Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInPowerPointKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.VersionHistory",LabelText:"STR@L_FileHistory",Description:"STR@L_FileHistoryDescription",Image48by48:"IMGMAP@prt2@History_48x48x32",Command:"0x1BD57F1B",Keytip:"STR@l_FileVersionKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.FileVersion",LabelText:"STR@L_FileVersion",Description:"STR@L_FileVersionDescription",Image48by48:"IMGMAP@prt2@Versions_48x48x32",
Command:"0xFF30AFCC",Keytip:"STR@l_FileVersionKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.New",LabelText:"STR@L_New",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0x7BA0BBA5",Keytip:"STR@l_NewKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelNew"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingNew",DisplayMode:"MenuLoading",Title:"STR@L_New"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblNewButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Open",LabelText:"STR@L_Open",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0xA6D756C7",Keytip:"STR@l_OpenKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelOpen"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingMru",DisplayMode:"MenuLoading",Title:"STR@L_Open"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblMruButtonsLoading"}}]}]}]}]},
{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Rename",LabelText:"STR@L_RenameButtonTitle",Command:"0x2F9A3D80",Keytip:"STR@l_RenameButtonTitleKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Rename.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_RenameButtonTitle"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Rename.RenameDialog",LabelText:"STR@L_RenameButtonTitle",Description:"STR@L_RenameButtonDescription",Image48by48:"IMGMAP@prt2@RenameColumn_48x48x32",
Command:"0x8E08F41F",Keytip:"STR@l_RenameButtonTitleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.SaveACopy",LabelText:"STR@L_SaveACopy",Command:"0x2F9A3D80",Keytip:"STR@l_SaveAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.SaveACopy.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_SaveACopy"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveACopy",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveAsButtonDescription",
Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0x72B6A68C",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveAsToHost",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xB8A8271F",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveToSharePoint",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xBAA2DFAC",Keytip:"STR@l_SaveAsKeytip"}}]}]},
{name:"MenuSection",attrs:{Id:"SaveAsInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuSaveButton"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.SaveACopy.WheresTheSaveButton",LabelText:"STR@L_WheresTheSaveButton",Description:"STR@L_WheresTheSaveButtonDescription"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Print",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Print.Menu"},
children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Print.PrintToPdf",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@prt2@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintFullSlide",LabelText:"STR@L_PrintFullSlide",Description:"STR@L_PrintFullSlideDescription",Image48by48:"IMGMAP@prt2@HandoutsLandscapeSlides_48x48x32",
Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintNotes",LabelText:"STR@L_PrintNotes",Description:"STR@L_PrintNotesDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitNotesLandscapePaper_48x48x32",Command:"0x108EE012",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintHandouts",LabelText:"STR@L_PrintHandouts",Description:"STR@L_PrintHandoutsDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitOnPortrait3_48x48x32",
Command:"0x866D929F",Keytip:"STR@l_PrintToPdfKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Share",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Share.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Share.ShareWithPeople",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",
Image48by48:"IMGMAP@prt2@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.Embed",LabelText:"STR@L_Embed",Description:"STR@L_EmbedDescription",Image48by48:"IMGMAP@prt2@EmbedDocument15_48x48x32",Command:"0x3A7B8B90",Keytip:"STR@l_EmbedKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.ReplyWithChanges",LabelText:"STR@L_ReplyWithChanges",Description:"STR@L_ReplyWithChangesDescription",Image48by48:"IMGMAP@prt2@SendAsLink_48x48x32",
Command:"0x4759B1F9",Keytip:"STR@l_ReplyWithChangesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.DownloadAs",LabelText:"STR@L_DownloadAs",Command:"0x2F9A3D80",Keytip:"STR@l_DownloadAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.DownloadAs.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DownloadAs"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopy",LabelText:"STR@L_DownloadCopy",Description:"STR@L_DownloadCopyDescription",
Image48by48:"IMGMAP@prt2@SaveAsPowerPointPptx_48x48x32",Command:"0xD3EF8F78",Keytip:"STR@l_DownloadCopyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsPdf",LabelText:"STR@L_DownloadAsPdf",Description:"STR@L_DownloadCopyAsPdfDescription",Image48by48:"IMGMAP@prt2@PDF_file_48x48x32",Command:"0x91656D12",Keytip:"STR@l_DownloadAsPDFKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsOdp",LabelText:"STR@L_DownloadAsOdp",Description:"STR@L_DownloadCopyAsOdpDescription",
Image48by48:"IMGMAP@prt2@SaveAsPowerPointOdp_48x48x32",Command:"0x4A7CCC65",Keytip:"STR@l_DownloadAsOdpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadAsImages",LabelText:"STR@L_DownloadAsImages",Description:"STR@L_DownloadAsImagesDescription",Image48by48:"IMGMAP@prt2@Downloadasimage_48x48x32",Command:"0x47057070",Keytip:"STR@l_DownloadAsImagesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.About",LabelText:"STR@L_AboutOffice",Command:"0x2F9A3D80",Keytip:"STR@l_AboutOfficeKeytip"},
children:[{name:"Menu",attrs:{Id:"PptJewel.About.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_AboutOffice"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.About.TermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.Privacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",
Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TrustCenter",LabelText:"STR@L_TrustCenter",Description:"STR@L_TrustCenterDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.ThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",
Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.About.DiagnosticsSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.About.Diagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.SessionId",LabelText:"STR@L_DiagnosticsSessionId",
QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.Build",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Help",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Help.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Help.Help",LabelText:"STR@L_Help",Description:"STR@L_HelpDescription",Image48by48:"IMGMAP@prt2@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.GiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@prt2@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.ReportAbuse",
LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@prt2@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.SecondaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.SecondaryMenu.Controls"},children:[{name:"Button",attrs:{Id:"PptJewel.Close",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]};zB.main();Type.registerNamespace("Common.App.Insights");
m.a.instance.Ac(new UG);Type.registerNamespace("Common.App.Activities");DB.main();Type.registerNamespace("Common.App.ActivityAggregator");IB.main();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Yq;Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("Common.App.BrowserInfoLogger");JB.main();Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("CADWLTR");KB.main();Type.registerNamespace("Common.App.EventsCacheManager");
LB.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.FloatPane");OB.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");RB.main();uC.main();yC.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("CNT");AC.main();Type.registerNamespace("Common.App.VisibilityManagement");
CC.main();Type.registerNamespace("Common.ModernFontPicker");DC.main();EC.main();JC.main();PC.main();SC.main();aD.main();cD.main();iD.main();Bz.main();DD.main();FD.main();HD.main();VD.main();WD.main();XD.main();YD.main();$D.main();iE.main();jE.main();bF.main();eF.main();hF.main()},123:function(J,V,d){d.d(V,"a",function(){return h});d.d(V,"b",function(){return e});const h=m=>null===m||"undefined"===typeof m||!m.length,e=m=>null===m||"undefined"===typeof m},152:function(J,V,d){d.d(V,"a",function(){return e});
d.d(V,"b",function(){return m});var h=d(41);const e=(n,v,A)=>{n=h.a.hm(n);n.Wa("CommandId",v.toString());try{return A()}finally{n.finish(!0)}},m=(n,v,A,w)=>e(n+v,A,w)},226:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.bAc="AfterValidate";h.autoCorrect="AutoCorrect";h.hbi="BeforeValidate";h.DCi="CutAction";h.nJi="EditingElementContainerDisconnectingFromView";h.endEditing="EndEditing";h.cSi="FinishingSelectionValidation";h.Fuj="ImeTypingEnd";h.Huj="ImeTypingStart";h.eBj="IpMode";
h.Cx="KeyPress";h.eg="KeyDown";h.nfk="NotFinishingSelectionValidation";h.Ark="OvertypeEnd";h.Crk="OvertypeStart";h.Frk="PaddingChanged";h.K2g="ParagraphContentUpdated";h.Ktk="PasteAction";h.m3k="SetMode";h.typingProcess="TypingProcess";h.Bni="ClipboardModeBegin";h.Cni="ClipboardModeEnd";Object(J.a)(h,"EditEventKeys",null,[])},241:function(J,V,d){d.d(V,"a",function(){return m});var h=d(25),e=d(13);const m=n=>h.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk:Object(e.a)(n.resolve("Common.IDynamicScriptLoaderProvider").yv,
n.resolve("Common.IDynamicScriptLoaderProvider").yv.loadScript,"loadScript")},245:function(J,V,d){d.r(V);J=d(0);var h=d(375),e=d(55),m=d(25),n=d(45),v=d(571),A=d(1166),w=d(17);d(1158);var y=d(974),u=d(27),E=d(75),G=d(121),I=d(31),H=d(39),K=d(34),C=d(74),Y=d(51),M=d(70),P=d(56),T=d(86);d(405);var L=d(49),aa=d(407);class Q{constructor(D,pa,Z,oa,Ba){this.Lyd=D;this.IWh=Z;this.HWh=pa;this.JLh=oa;this.VQh=Ba}rXk(D,pa){pa.sXk(D,this.Lyd,this.HWh,this.IWh,this.JLh,this.VQh)}}Object(J.a)(Q,"MathPropertyObject",
null,[]);var ea=d(30),ia=d(112);d.d(V,"Box4PasteSteward",function(){return ja});class ja extends y.a{constructor(D,pa,Z,oa,Ba,Ma,za,ka=null,qa=null){super(D,za,ka,qa);this.Tn=this.b1=null;this.Vna=!1;this.b0a=null;this.Wjb=-1;this.T0a=0;this.WCd=new w.a;ia.a(4223754,307,P.OutlineElementReader.Tg(D));this.f0a=pa;this.f0a.Nnb(this);this.yE=Z;this.yE.Nnb(this);this.Jtd=oa;this.Jo=Ba;this.KPh=Ma;this.Xyd=C.ListReader.ak(this.wb);ja.Pxj();ja.Dxj();ja.tyj()}get z7(){return this.b1||(this.b1=e.a.instance.pb("Box4.IInternalLinkManager"))}get hOa(){return this.Tn}get $3a(){return this.Xyd&&
!this.yE.$aa}get p4a(){return 0<this.T0a}get Tu(){return this.Jtd}get ao(){return this.Jo}get MVc(){return this.KPh}get vci(){return!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.ka("Box4EnsurePasteFormatOnTextIsEnabled")}reset(){super.reset();this.Tn=this.hYd(!1)}zHd(D){ia.a(4223762,307,P.OutlineElementReader.Tg(this.wb)||M.OutlineReader.At(this.wb));this.nBb(!1);var pa=new ea.GraphIterator;pa.Nc(this.wb);D=y.a.Jh.Vaa(this.wb,this.aQa(D));this.EAc(pa,!1);ia.a(4223763,307,D===this.wb.currentNode);
ia.a(4223764,307,I.ParagraphReader.Wd(D));-1!==this.Tn.rD&&ja.paragraphEditor.IL(D,this.Tn.rD);if(ja.paragraphEditor.Tu&&!this.cY.eph){if(this.Tn.textIndent){let Ba;({Pf:oa,returnValue:Ba}=ja.j9c(this.Tn.textIndent));var Z=!1;if(Ba||!C.ListReader.i5a){0>Ba&&(Z=!0,Ba*=-1);var oa=ja.WNd(Ba,oa);Z||ja.paragraphEditor.Tu.wfb(D,oa)}}!this.Tn.marginLeft||ja.KK.kTc||C.ListReader.ak(pa)||({Pf:pa,returnValue:Z}=ja.j9c(this.Tn.marginLeft),pa=ja.WNd(Z,pa),ja.paragraphEditor.Tu.wfd(D,1,pa))}(ja.Nf.Zf&&ja.Nf.jy||
K.a.instance.ga(45)&&u.App.YC.FIb)&&D.setValue(H.a.Y3b,!0);this.Tn.lineSpacing&&ja.paragraphEditor.c0(D,this.Tn.lineSpacing);this.Tn.paragraph=D;this.Vna=!0}EAc(D,pa){ia.a(8128518,307,!pa);this.zL&&!K.a.instance.ga(76)&&(0<this.zL&&this.Tu.gGc(D,this.zL),0>this.zL&&this.Tu.Idb(D,this.zL,0));K.a.instance.ga(29)&&(this.wb.Nc(D),Y.OutlineElementNavigator.oi(this.wb));!this.$3a||2===u.App.mode&&this.MVc.Ufc?D&&this.ao.uIe(D,this.p4a):this.ao.Flh(D);this.zL=0}jkd(D){this.WCd.add(D)}gMd(){this.zL=0}I_(D,
pa=null){ia.a(4223772,307,I.ParagraphReader.Lk(this.wb));const Z=this.wb.currentNode;this.Tn.YQe(Z);if(!this.cY.lRe(pa)){m.AFrameworkApplication.Qj("Microsoft.Office.Web.Common.Flighting.IBox4EnsurePasteFormatOnTextSettings");var oa=Z.Ra.last,Ba=L.a.XNa(Z),Ma=!1;this.Vna&&(oa.formatting=this.Tn.J5a.Sd(oa),K.a.instance.ga(57)&&Z.yu(),this.Vna=!1,Ma=!0);D=this.cY.Q2d(D,pa);this.cY.Gma(this.wb.currentNode,this.Tn.Qda,pa);this.characterPropertiesEditor.replaceTextRange(Ba,D);this.vci&&Ma&&(D=Z.xqb(Ba.Qa),
D.formatting=this.Tn.J5a.Sd(D));K.a.instance.ga(2)}}zla(D){this.cY.XSc&&this.cY.cSc(D)?(this.Tz(),this.Uz(D)):(ia.a(4223773,307,I.ParagraphReader.Lk(this.wb)),D=L.a.XNa(this.wb.currentNode),this.characterPropertiesEditor.lQc(D,pa=>new aa.a(pa,aa.a.QFc),E.AParagraphNode.cZ))}kWa(){}yla(D){this.f0a.yla(D)}xla(D){this.Tn=D;this.Vna=!0}Tua(D){ia.a(4223774,307,I.ParagraphReader.Lk(this.wb));ia.a(4223775,307,!this.b0a);ia.a(4223776,307,0>this.Wjb);this.b0a=D;this.Wjb=I.ParagraphReader.textLength(this.wb.currentNode)}Sua(){ia.a(4223777,
307,I.ParagraphReader.Lk(this.wb));ia.a(4223778,307,!!this.b0a);ia.a(4223779,307,0<=this.Wjb);let D=L.a.createTextRange(this.wb.currentNode,this.Wjb,I.ParagraphReader.textLength(this.wb.currentNode)),pa="",Z="";this.z7&&({zbh:pa,KUi:Z}=this.z7.Mxh(G.HyperlinkReader.YBa(this.b0a),!0)).returnValue&&(this.b0a=pa,Z&&(this.characterPropertiesEditor.replaceTextRange(D,Z),D=L.a.createTextRange(this.wb.currentNode,this.Wjb,I.ParagraphReader.textLength(this.wb.currentNode))));ja.hyperlinkEditor.qha(D,this.b0a,
!1);this.Vna=!0;this.b0a=null;this.Wjb=-1}Uz(D){this.zHd(D);this.Tn.wkd(this.wb.currentNode);D&&"P"===D.xT.b2b&&ja.paragraphEditor.hIa(this.wb.currentNode,this.Tn.a9c);this.cY.Gma(this.wb.currentNode,this.Tn.Qda,D,this.Tn.marginLeft,this.Tn.textIndent)}Tz(){ia.a(4223808,307,I.ParagraphReader.Lk(this.wb));ja.hyperlinkEditor.sLi(this.wb.currentNode);Y.OutlineElementNavigator.Je(this.wb)}fWa(){}eWa(){}Yua(){}HGa(){}Cla(){ia.a(4223809,307,P.OutlineElementReader.Tg(this.wb)||M.OutlineReader.At(this.wb));
let D=!1;this.p4a||(D=this.$3a||!0);D||(this.zL+=1);this.T0a++}Ala(){this.T0a--;let D=!1;this.p4a||(D=this.$3a||!0);D||--this.zL}Xua(D){ia.a(4223810,307,P.OutlineElementReader.Tg(this.wb)||M.OutlineReader.At(this.wb));ia.a(4223811,307,0!==D.listStyleType);this.ao.dGb(this.TSj(D))}Bla(){ia.a(4223813,307,P.OutlineElementReader.Tg(this.wb));m.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(ja.KK.kTc&&C.ListReader.ak(this.wb)){const D=
I.ParagraphReader.Yrb(this.wb.currentNode),pa=this.MVc.gag(this.wb);this.ao.zfd(pa,D,null)}}gWa(D){this.f0a.gWa(D)}gX(D){this.yE.gX(D)}dX(){this.yE.dX()}fX(D){this.yE.fX(D)}eX(){this.yE.eX()}cX(D){this.yE.cX(D)}bX(){this.yE.bX()}static get paragraphEditor(){return ja.xw||(ja.xw=e.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return ja.Xm||(ja.Xm=e.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Nf(){return ja.Wc||(ja.Wc=e.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get LHb(){return ja.Svf}static get KK(){return ja.GJ||
(ja.GJ=e.a.instance.pb("Box4.List.ListSettings"))}static Pxj(){const D=K.a.instance.ga(61);ja.OGa[1]=D?T.StyleReader.Gmd:T.StyleReader.BHb;ja.OGa[2]=D?T.StyleReader.Hmd:T.StyleReader.CHb;ja.OGa[3]=D?T.StyleReader.Imd:T.StyleReader.DHb;ja.OGa[4]=D?T.StyleReader.Jmd:T.StyleReader.EHb;ja.OGa[5]=D?T.StyleReader.Kmd:T.StyleReader.FHb;ja.OGa[6]=D?T.StyleReader.Lmd:T.StyleReader.GHb;ja.OGa[7]=D?null:T.StyleReader.ilc}static Dxj(){ja.oca.unspecified=0;ja.oca.defaultUnordered=1;ja.oca.defaultOrdered=1;ja.oca.none=
0;ja.oca.disc=1;ja.oca.circle=2;ja.oca.square=3;ja.oca.decimal=1;ja.oca.lowerAlpha=2;ja.oca.lowerRoman=3;ja.oca.upperAlpha=4;ja.oca.upperRoman=5}static tyj(){ja.Svf=T.StyleReader.Ksb()}static b4a(D){return n.a.substring(D,4,6)+n.a.substring(D,2,4)+n.a.substring(D,0,2)}static j9c(D){let pa,Z;pa=0;const oa=D.length;Z=parseFloat(n.a.substring(D,0,oa-2));D=n.a.substr(D,oa-2,2);switch(D){case "in":pa=3;break;case "px":pa=7;break;case "cm":pa=1;break;case "pt":pa=5;break;default:h.ULS.sendTraceTag(8208450,
307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",D),Z=0}return{returnValue:Z,Pf:pa}}static WNd(D,pa){let Z=0;switch(pa){case 3:Z=v.a.Mra(D);break;case 7:Z=A.a.Uda(D,0);break;case 1:Z=v.a.pLd(D);break;case 5:Z=v.a.Mra(v.a.Y9c(D));break;default:h.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",D,pa)}return Z}}ja.xw=null;ja.Xm=null;ja.Wc=null;ja.OGa=Array(8);ja.oca={};ja.Svf=
null;ja.GJ=null;Object(J.a)(ja,"Box4PasteSteward",y.a,[])},259:function(J,V,d){d.d(V,"a",function(){return n});J=d(0);var h=d(375),e=d(25),m=d(33);class n{static U6(){if(0>n.wAc){n.wAc=0;try{const v=e.AFrameworkApplication.fa.Ha("OAuthManagerServiceSettings");void 0!==v&&null!==v&&""!==v&&(n.appSettings=m.b(v),n.wAc=n.appSettings._Version);h.ULS.sendTraceTag(572298006,3E3,100,"AppSettings: {0}",v)}catch(v){h.ULS.sendTraceTag(572298007,3E3,15,"AppSettings failed to load: {0}",v.message)}}}static NHc(){if(0>
n.I4a){e.AFrameworkApplication.fa.Zba&&(n.I4a=0);try{const v=e.AFrameworkApplication.fa.Ha("OAuthManagerDocumentSettings");void 0!==v&&null!==v&&""!==v&&(n.LXb=m.b(v),n.I4a=n.LXb._Version);h.ULS.sendTraceTag(572298008,3E3,100,"DocSettings: {0}",v)}catch(v){h.ULS.sendTraceTag(572298009,3E3,15,"DocSettings failed to load: {0}",v.message)}}}static get clientVersion(){return 7}static get appVersion(){n.U6();return n.wAc}static get SHi(){n.NHc();return n.I4a}static get rHd(){n.U6();return n.appSettings.AppMapping}static get authority(){n.U6();
return n.appSettings.Authority}static get enableConsoleLogging(){n.U6();return n.appSettings.EnableConsoleLogging}static get Rui(){n.U6();return 7<=n.appVersion?n.appSettings.CorePFTData:{["IsEnabled"]:!0,["Application"]:"e03a13ee-9730-4cae-8525-47559c8cf18a",["Endpoint"]:""}}static get u7a(){n.U6();if(4<=n.appVersion){if(!n.z4e&&n.appSettings.HostPageSupportsAuth&&(e.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||e.AFrameworkApplication.fa.ka("IsO365CommercialHost")))try{const v=e.AFrameworkApplication.Lla.toLowerCase(),
A=n.appSettings.GetAuthTokenFromParentOriginList;if(void 0!==A&&null!==A)for(const w of A)if((new RegExp("^"+w+"/?$")).test(v)){n.y4e=!0;break}}catch(v){h.ULS.sendTraceTag(570729249,3E3,15,"Failed to validate origin: {0}",v.message)}n.z4e=!0;return n.y4e}return e.AFrameworkApplication.fa.ka("UiHostSupportsAuthToken")}static get isEnabled(){n.U6();return n.appSettings.IsEnabled}static get cdk(){n.U6();return n.appSettings.MockTokenForAutomation}static get qAe(){n.U6();return n.appSettings.PromiseTimeoutInMs}static get Y7k(){n.U6();
return n.appSettings.SharedAuthFilePath}static get Z7k(){n.U6();return n.appSettings.SharedAuthOrigin}static get ovh(){n.U6();return n.appSettings.TeamsSDXEnabledSSOList}static get Zzl(){n.U6();return n.appSettings.WacFrameTeamsElectronSSO}static get ngk(){n.NHc();return 3<=n.I4a?n.LXb.OAuthLoginHint:null}static get Dce(){n.NHc();return 4<=n.I4a?n.LXb.LokiAlternateAuthToken:null}static get LVc(){n.NHc();return 4<=n.I4a?n.LXb.LokiAlternateAuthTokenTTL:-1}}n.wAc=-1;n.appSettings=null;n.I4a=-1;n.LXb=
null;n.y4e=!1;n.z4e=!1;Object(J.a)(n,"OAuthManagerSettings",null,[])},262:function(J,V,d){d.r(V);J=d(0);d(375);var h=d(902);d(903);var e=d(25),m=d(95),n=d(55),v=d(35);class A{}Object(J.a)(A,"RibbonUpsellButtonCreator",null,[]);class w extends Sys.EventArgs{constructor(aa){super();this.CAl=aa}}Object(J.a)(w,"TopRowCreatedEventArgs",Sys.EventArgs,[]);d(376);var y=d(355);d(169);var u=d(132);d(72);var E=d(218),G=d(159),I=d(65);class H{constructor(aa,Q){this.cluster=aa;this.pFc=Q}}Object(J.a)(H,"ImageInfo",
null,[]);class K{constructor(aa,Q,ea,ia,ja,D,pa,Z,oa,Ba,Ma,za,ka,qa,Ja=null,xa=null){this.id=aa;this.Fyc=Q;this.Jyc=ea;this.Iyc=ia;this.Hyc=ja;this.Gyc=D;this.Lyc=pa;this.WEd=Z;this.kHb=new H(oa,Ba);this.xhd=new H(Ma,za);this.D5c=new H(ka,qa);Ja&&xa&&new H(Ja,xa)}}Object(J.a)(K,"PeoplesWellBaseSettings",null,[]);class C{constructor(){this.aIf=null}}Object(J.a)(C,"BreadcrumbControls",null,[]);class Y{constructor(aa){this.id=aa}}new Y("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32",
"WACSkypeDocChatUnread_16x16x32");Object(J.a)(Y,"ChatButtonSettings",null,[]);class M{constructor(){this.id=this.image=this.label=this.command=null}}Object(J.a)(M,"SkypeButtonInfo",null,[]);class P{constructor(){this.FTe=this.pwh=this.IJd=null}}Object(J.a)(P,"TopRowControls",null,[]);var T=d(196);d(45);d.d(V,"CuiHelper",function(){return L});class L{constructor(aa,Q,ea=null,ia,ja=null){this.Mfa=aa;this.nNh=T.a.Cck(Q,ja);this.nNh.push(CommonUIStrings);h.b();L.Ca=void 0===ea||null===ea?e.AFrameworkApplication.Ta:
ea}static get Frj(){return L.Yna||(L.Yna=n.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static y9i(aa,Q,ea){return new K(L.Oxe,v.a.loi,v.a.IMd,v.a.ooi,v.a.noi,v.a.moi,v.a.poi,v.a.P3a,aa,"per_SingleCollabUserGlyph_16x16x32",Q,"per_SingleCollabUserGlyph_32x32x32",ea,"per_MoreUsersGlyph_16x16x32",null,null)}static kHi(aa){aa.IJd&&(L.jHi(aa.IJd),aa.IJd=null);aa.pwh&&(L.iHi(),aa.pwh=null);aa.FTe&&(L.lHi(aa.FTe),aa.FTe=null);L.Frj.lFk();let Q;({N1b:Q}=y.a.RIb(!1)).returnValue&&m.a.Xza(Q)}static z2b(){e.AFrameworkApplication.Ta.processAction(v.a.z2b,
2)}static iHi(){e.AFrameworkApplication.ZGc&&G.EventHandlerManager.instance.gld(e.AFrameworkApplication.ZGc)}static addButton(aa,Q,ea,ia,ja,D,pa,Z){Q=u.a(aa,Q,ea,ia,null,null,null,D,null,null,void 0,void 0,ja);(aa=Z.hostControl(aa,Q,D))&&pa.appendChild(aa);return aa}static DEc(aa,Q,ea){let ia;ia=document.createElement("span");ia.className="BreadcrumbItem";ia.id=Q;ia.innerText=ea;ia.setAttribute("dir","auto");aa.appendChild(ia);return ia}static jHi(aa){aa.aIf&&G.EventHandlerManager.instance.Zrl(aa.aIf)}static lHi(aa){E.a.instance.$zh(I.a.click,
aa,L.uok,!0)}static uok(){e.AFrameworkApplication.CTe?(e.AFrameworkApplication.Aa.Jkc(e.AFrameworkApplication.Aa.gb.sdg()),e.AFrameworkApplication.CTe=!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static $Tc(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.gb.$Tc}}L.Yna=null;L.Q7k="ShareServerWhite_20x20x32";L.aUd="ExternalHeaderFullTopBars";L.Krj="HeaderTopBars";L.JJd="BreadcrumbBrand";L.KJd="BreadcrumbFolder";L.LJd="BreadcrumbTitle";L.r4f="FolderSeparator";L.hPe=
"sbTellMe";L.oMe="TellMe-SearchBox";L.x1g="btnOpenInClient";L.ZJe="btnFileSharing";L.Sdl="BasicChat";L.Vcd="btnReplyWithChanges";L.a2f="jbtnGiveFeedback";L.Oxe="PeoplesWellControl";L.yYf="EditableBreadcrumbItem";L.Ca=null;L.ZRe=50;L.Drj=null;Object(J.a)(L,"CuiHelper",null,[542])},296:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.alt="Alt";h.iconColor="IconColor";h.wtb="Image16by16Class";h.Wtj="Image30by30Class";h.tCa="Image32by32Class";h.J4d="Image48by48Class";h.labelText="LabelText";
h.lRj="LabelTextUserGeneratedPlaceholderReplacements";h.visible="Visible";h.XT="SourceControlId";h.customTooltip="CustomTooltip";h.Icon="Icon";h.IconSet="IconSet";h.Eah="ReduxActions";Object(J.a)(h,"SharedControlCommandProperties",null,[])},298:function(J,V,d){J=d(0);var h=d(55),e=d(376),m=d(583),n=d(126),v=d(375),A=d(95),w=d(641),y=d(388),u=d(45),E=d(193),G=d(54),I=d(1071),H=d(25),K=d(162);class C{constructor(ka,qa){this.cp=ka;this.distance=qa}}Object(J.a)(C,"CpDistanceResult",null,[]);class Y{constructor(){this.nCa=
0;this.Hs=null;this.Hpb=this.Ipb=this.kOa=this.yAa=0;this.Ulc=this.FDa=this.DIa=null;this.Uvb=this.pba=this.M4c=0;this.hUe=this.nRd=!1;this.UWb=this.oBa=this.sha=this.R1=this.Kfc=0;this.JEh=this.H3f=this.Ukc=this.qHb=!1;this.result=null;this.jWb=this.jOd=this.d4a=this.I6=this.Raa=0;this.Pia=this.yEc=!1;this.jO=null}}Object(J.a)(Y,"CpFromPointState",null,[]);class M{constructor(ka,qa,Ja,xa,Ga,na,sa,Ha=null,cb=0,Za=null){this.oAa=this.cp=this.Qa=0;this.iWb=-1;this.deltaX=this.bRf=Number.MAX_VALUE;this.WVa=
0;this.BSa=-Number.MAX_VALUE;this.zSa=-Number.MAX_VALUE;this.xUd=this.GYb=this.Mnb=this.Gue=!1;this.element=ka;this.point=Ja;this.g9a=xa;this.RCe=Ga;this.QCe=na;this.Tpg=sa;this.bha=Ha;this.s3a=cb;this.originalText=qa;this.KGa=this.originalText.length;this.Kb=this.KGa-1;this.P3b=4===this.g9a||3===this.g9a;this.jO=Za}}Object(J.a)(M,"CpFromPointElementState",null,[]);var P=d(42);class T{constructor(ka,qa,Ja){this.CpBegin=ka;this.CpEnd=qa;this.IsEop=Ja}}Object(J.a)(T,"CpFromPointResult",null,[]);class L{constructor(ka,
qa,Ja){this.LineBounds=ka;this.ClientRects=qa;this.IsRangeMultipleLines=Ja}}Object(J.a)(L,"LineCoordinateResult",null,[]);class aa{constructor(ka,qa,Ja,xa,Ga,na){this.Eib={};this.ANb=!0;this.Wyg=this.Auc=this.$wc=this.Qlb=this.R1a=null;this.hd=ka;this.qY=qa;this.gtc=Ja?Ja.ka("TextFidelityLayoutFixesEnabled"):!1;this.TNh=Ja?Ja.ka("HyperlinkFirstCharacterSelectionFixIsEnabled"):!1;this.ENh=Ja?Ja.ka("CharacterBeforeEOPSelectionFixIsEnabled"):!1;(this.tLa=xa)||v.ULS.sendTraceTag(21051272,324,10,"_measureBoundsUsingSpansStrategy is null");
this.UO=Ga;this.GWh=na}Vba(){this.ANb=!1}e4a(ka,qa,Ja,xa=null){this.Wyg=[];var Ga=ka.e5;if(!ka.textLength)return this.$kj(ka,qa,Ja,xa);xa=Object.assign(new Y,{DIa:Array(Ga.length),FDa:Array(Ga.length),Ulc:Array(Ga.length),nRd:!0,Hs:Ga,jO:xa});for(var na=0;na<=Ga.length;na++){xa.yAa=0;xa.kOa=0;xa.Ipb=0;xa.Hpb=0;xa.nCa=0;xa.qHb=!1;xa.Ukc=!1;if(na<Ga.length){if(!this.mRi(ka,xa,na))continue}else{xa.Uvb=na-1;break}if(this.ORi(qa,xa,na))break}if(xa.hUe&&xa.Kfc<qa.y&&qa.y<xa.R1)return this.yYk(ka,qa,Ja,
xa);xa.result=null;xa.Raa=-1;xa.I6=xa.oBa;xa.d4a=Number.MAX_VALUE;xa.jOd=0;xa.jWb=0;xa.yEc=!1;xa.Pia=!1;for(Ga=xa.pba;Ga<=xa.Uvb;Ga++)if(na=this.MRi(ka,qa,Ja,Ga,xa))return na;return this.Mjj(ka,qa,Ja,xa)}$kj(ka,qa,Ja,xa){const Ga=ka.isRtl;if(!Ja)return new T(0,0,!1);ka=this.pNa(ka,xa);return!Ga&&qa.x>ka.x+ka.width/2||Ga&&qa.x<ka.x+ka.width/2?new T(-1,-1,!0):new T(0,0,!0)}mRi(ka,qa,Ja){if(this.ili(qa.Hs[Ja].htmlElement)||qa.Hs[Ja].jub)return!1;var xa=this.GJd(qa.Hs[Ja],qa.jO);qa.DIa[Ja]=xa;var Ga=
xa.y;let na=xa.y+xa.height;qa.Hs[Ja].Dsg||qa.Hs[Ja].Pia||qa.Hs[Ja].I2&&!qa.Hs[Ja].KRa?({PTf:Ga,OTf:na}=this.ADf(qa.Hs[Ja].htmlElement,Ga,na),qa.yAa=qa.Ipb=Ga,qa.kOa=qa.Hpb=na,qa.FDa[Ja]=na-Ga,qa.Ulc[Ja]=qa.FDa[Ja]):(this.jal(ka,Ja)?(xa=this.qt(ka,qa.UWb,void 0,void 0,void 0,qa.jO),Ga=this.A_b(qa.Hs[Ja].htmlElement),ka=1<Ga?this.qt(ka,qa.UWb+Ga-1,void 0,void 0,void 0,qa.jO):xa,qa.yAa=Ga=xa.y,qa.kOa=xa.y+xa.height,qa.Ipb=ka.y,qa.Hpb=ka.y+ka.height,qa.FDa[Ja]=xa.height,qa.Ulc[Ja]=xa.height):(ka=this.GWh.hfj(qa.Hs[Ja].htmlElement),
qa.nCa=this.tLa.qdj(qa.Hs[Ja].htmlElement,ka),{PTf:Ga,OTf:na}=this.ADf(qa.Hs[Ja].htmlElement,Ga,na),qa.JEh=1<Math.abs(xa.width-this.m4i(qa.Hs[Ja].htmlElement))||1<Math.abs(xa.height-this.l4i(qa.Hs[Ja].htmlElement)),qa.JEh&&this.qY.instance&&(ka=Math.round(ka*this.qY.instance.S1),qa.nCa=Math.round(qa.nCa*this.qY.instance.S1)),qa.yAa=Ga-qa.nCa,qa.kOa=Ga+ka+qa.nCa,qa.Ipb=na-ka-qa.nCa,qa.Hpb=na+qa.nCa,qa.FDa[Ja]=ka+2*qa.nCa,qa.Ulc[Ja]=ka),qa.M4c=Math.max(qa.M4c,qa.FDa[Ja]));qa.H3f||(qa.R1=qa.yAa,qa.sha=
qa.kOa,qa.H3f=!0);qa.Ukc=qa.Ipb>(qa.yAa+qa.kOa)/2;Ja=aa.$qa(qa.M4c);this.gtc&&(Ja=this.XGd(qa,Ja));qa.qHb=this.OCj(qa.R1,qa.sha,Ga,Ja);return!0}OCj(ka,qa,Ja,xa){return ka===qa?Ja>qa:Ja>=qa-xa}XGd(ka,qa){return qa=this.tLa.XGd(!!ka.jO&&ka.jO.ivb,ka.yAa,ka.kOa,qa)}ORi(ka,qa,Ja){if(qa.qHb||qa.Ukc){qa.qHb?qa.Uvb=Ja-1:(qa.R1=Math.min(qa.R1,qa.yAa),qa.sha=Math.max(qa.sha,qa.kOa),qa.Uvb=Ja);Array.add(this.Wyg,qa.sha);if(ka.y<=qa.sha)return!0;qa.Kfc=qa.sha;qa.R1=qa.Ipb;qa.sha=qa.Hpb;qa.pba=Ja;qa.oBa=qa.UWb;
qa.nRd=qa.qHb;qa.hUe=qa.Ukc;qa.M4c=qa.Hs[Ja].Pia||qa.Hs[Ja].I2&&!qa.Hs[Ja].KRa?0:qa.FDa[Ja]}else qa.R1=Math.min(qa.R1,qa.yAa),qa.sha=Math.max(qa.sha,qa.Hpb);ka.y>qa.Kfc&&ka.y<qa.R1&&!qa.Hs[qa.pba].Pia&&!qa.Hs[qa.pba].I2&&qa.R1-qa.Kfc<qa.Ulc[qa.pba]/2&&(qa.R1=ka.y);qa.UWb+=this.tCi(qa.Hs[Ja]);return!1}yYk(ka,qa,Ja,xa){if(xa.Hs[xa.pba].I2)return Ja?new T(xa.oBa,xa.oBa,!1):new T(xa.oBa,xa.oBa+1,!1);if(Ja=this.aRf(xa.Hs[xa.pba].htmlElement,xa.DIa[xa.pba],qa,xa.nRd?4:3,xa.Kfc,xa.R1,xa.FDa[xa.pba],ka.isRtl,
ka.bha,xa.oBa,xa.jO))return Ja=xa.oBa+Ja.cp,Ja=this.wDf(ka,qa,Ja,xa.pba,xa.oBa,void 0,void 0,xa.jO),new T(Ja,Ja,!1);this.hd.Tb(w.a.Qek,{["Reason"]:m.a.P1f});return null}MRi(ka,qa,Ja,xa,Ga){if(Ga.Hs[xa].jub)return null;const na=Ga.Hs[xa].I2,sa=Ga.Hs[xa].Pia;let Ha=!1;if(na){if(Ga.DIa[xa].y>=Ga.R1&&(Ga.Hs[xa].KRa||Ga.Hs[xa].PSc)){var cb=Ga.DIa[xa];const Za=cb.x+cb.width/2,va=Math.abs(qa.x-Za);if(va<Ga.d4a||!cb.width&&va===Ga.d4a)Ga.yEc=!0,Ga.d4a=va,Ga.Pia=!1,Ga.Raa=!Ja||!ka.isRtl&&qa.x<Za||ka.isRtl&&
qa.x>Za?Ga.I6:Ga.I6+1}if(!Ga.Hs[xa].KRa&&!Ga.Hs[xa].PSc){cb=Ga.DIa[xa];if(!Ja&&qa.x>cb.x&&qa.x<cb.x+cb.width&&!Ga.Hs[xa].dHj)return new T(Ga.I6,Ga.I6+1,!1);Ga.result=qa.x<cb.x+cb.width/2?new C(ka.isRtl?1:0,Math.max(cb.x-qa.x,0)):new C(ka.isRtl?0:1,Math.max(qa.x-cb.x-cb.width,0))}}else sa?(ka=this.pNa(ka,Ga.jO),Ha=1>ka.width,Ga.result=new C(-1,y.a.JGc(qa,ka))):Ga.result=this.aRf(Ga.Hs[xa].htmlElement,Ga.DIa[xa],qa,xa===Ga.pba&&Ga.hUe?1:xa===Ga.Uvb&&!Ga.qHb&&Ga.Ukc?0:2,Ga.R1,Ga.sha,Ga.FDa[xa],ka.isRtl,
ka.bha,Ga.I6,Ga.jO);Ga.result&&(Ga.result.distance<Ga.d4a||Ha&&Ga.result.distance<=Ga.d4a+1)&&(Ga.Raa=Ga.result.cp+Ga.I6,Ga.Pia=sa,Ga.d4a=Ga.result.distance,Ga.jOd=Ga.I6,Ga.jWb=xa,Ga.yEc=na);Ga.I6=na?Ga.I6+1:Ga.I6+this.A_b(Ga.Hs[xa].htmlElement);return null}Mjj(ka,qa,Ja,xa){if(-1===xa.Raa)return this.hd.Tb(w.a.kAj,{["Reason"]:m.a.K1f}),null;const Ga=ka.textLength;if(xa.Pia){if(Ja)return Ja=xa.DIa[xa.DIa.length-1],!ka.isRtl&&qa.x<Ja.x+Ja.width/2||ka.isRtl&&qa.x>Ja.x+Ja.width/2?new T(Ga,Ga,!1):new T(-1,
-1,!0);xa.Raa=Ga}xa.Raa>Ga&&(xa.Raa=Ga);!xa.yEc&&xa.Raa<Ga&&(xa.Raa=this.wDf(ka,qa,xa.Raa,xa.jWb,xa.jOd,xa.jWb===xa.pba,xa.jWb===xa.Uvb,xa.jO));return new T(xa.Raa,xa.Raa,!1)}wDf(ka,qa,Ja,xa,Ga,na=!1,sa=!1,Ha=null){const cb=ka.isRtl,Za=ka.characterData,va=ka.textLength;Ja=u.a.Mw(Za,Ja)?Ja-1:Ja;const Fa=u.a.XGj(Za,Ja)?Ja+2:Ja+1,Ca=this.qt(ka,Ja,void 0,void 0,void 0,Ha);qa=qa.x>Ca.x+Ca.width/2;if(Ja-Ga===this.A_b(ka.e5[xa].htmlElement)&&ka.e5.length>xa+1&&ka.e5[xa+1].I2)return Ja;if(ka.e5[xa].VDj)return++Ja;
if(ka.e5[xa].UDj)return Ja;let La=null,nb=!1;0<Ja&&(La=this.qt(ka,u.a.Mw(Za,Ja-1)?Ja-2:Ja-1,void 0,void 0,void 0,Ha),0<Ja-Ga?nb=La.y+La.height/2>Ca.y:na||ka.e5[xa-1].I2||(nb=!0));na=null;let Nb=!1;if(this.ENh?Fa<=va:Fa<va)na=this.qt(ka,Fa,void 0,void 0,void 0,Ha),Fa-Ga<this.A_b(ka.e5[xa].htmlElement)?Nb=na.y+na.height/2<Ca.y+Ca.height:sa||ka.e5[xa+1].KRa||ka.e5[xa+1].PSc||(Nb=!0);nb&&Nb?La.x<=Ca.x&&na.x>=Ca.x?qa&&(Ja=Fa):La.x>=Ca.x&&na.x<=Ca.x?qa||(Ja=Fa):La.x<na.x?qa||(Ja=Fa):na.x<La.x&&qa&&(Ja=
Fa):nb||(Nb?na.x>=Ca.x&&qa?Ja=Fa:na.x<=Ca.x&&!qa&&(Ja=Fa):!u.a.yy(Za.charCodeAt(Ja))&&(!cb&&qa||cb&&!qa)&&(Ja=Fa));return Ja}j4i(ka){return A.a.Su(ka)}l4i(ka){return ka.offsetHeight}m4i(ka){return ka.offsetWidth}ili(ka){return!ka.parentNode}A_b(ka){return A.a.f6a(ka)}jal(ka,qa){qa=ka.e5[qa];if(qa.I2)return!1;ka=ka.htmlElement;Sys.UI.DomElement.containsCssClass(ka,"Paragraph")||(ka=ka.firstChild);return""!==ka.style.lineHeight&&ka.style.lineHeight!==qa.htmlElement.style.lineHeight}tCi(ka){return ka.I2?
1:A.a.f6a(ka.htmlElement)}ADf(ka,qa,Ja){Ja=new Sys.UI.Bounds(0,qa,0,Ja-qa);this.B6h(ka,[Ja]);qa=Ja.y;Ja=Ja.y+Ja.height;return{PTf:qa,OTf:Ja}}B6h(ka,qa){if(ka=E.a.Ru(ka)){var Ja=ka.borderTopWidth,xa=Ja.indexOf("px");if(-1<xa)for(Ja=parseInt(Ja.substr(0,xa)),xa=0;xa<qa.length;xa++)qa[xa].y+=Ja,qa[xa].height-=Ja;ka=ka.borderBottomWidth;Ja=ka.indexOf("px");if(-1<Ja)for(ka=parseInt(ka.substr(0,Ja)),Ja=0;Ja<qa.length;Ja++)qa[Ja].height-=ka}}aRf(ka,qa,Ja,xa,Ga,na,sa,Ha,cb,Za,va=null){if(this.QFj(ka))return this.hd.Tb(w.a.hSi,
{["Reason"]:m.a.O1f}),new C(0,y.a.JGc(Ja,qa));if(this.PFj(ka))return this.hd.Tb(w.a.jJc,{["Reason"]:m.a.jJc}),null;ka=this.mwi(ka,Ja,xa,Ga,na,sa,cb,Za,va);if(1>=ka.KGa)return new C(0,y.a.JGc(ka.point,qa));this.OUk(ka);do{if(ka.Qa>ka.Kb)return this.WEb(),this.hd.Tb(w.a.Pek,{["Reason"]:m.a.JUg}),null;this.Mdk(ka)}while(!ka.Gue);for(ka.oAa=!Ha&&ka.WVa<ka.point.x||Ha&&ka.WVa>ka.point.x?ka.Kb:ka.Qa;!ka.Mnb&&!this.Cbi(ka););if(ka.xUd)for(ka.cp=ka.Qa;ka.cp<=ka.Kb&&!this.LSj(ka);ka.cp++);return this.dmi(ka)}mwi(ka,
qa,Ja,xa,Ga,na,sa,Ha,cb=null){return new M(ka,this.j4i(ka),qa,Ja,xa,Ga,na,sa,Ha,cb)}QFj(ka){return!ka.firstChild}PFj(ka){return 3!==ka.firstChild.nodeType}OUk(ka){let qa;if(0===ka.g9a){ka.BSa=ka.RCe;ka.zSa=ka.QCe;for(var Ja=40;Ja<ka.KGa;Ja+=40)if(qa=this.oNa(ka.element,ka.originalText,Ja,ka.bha,ka.s3a,void 0,void 0,ka.jO),qa.height&&qa.y+qa.height/2>ka.zSa){ka.Kb=Ja;break}}else if(1===ka.g9a)for(ka.Kb=ka.KGa-1,ka.BSa=ka.RCe,ka.zSa=ka.QCe,Ja=ka.KGa-40;0<=Ja;Ja-=40){if(qa=this.oNa(ka.element,ka.originalText,
Ja,ka.bha,ka.s3a,void 0,void 0,ka.jO),qa.height&&qa.y+qa.height/2<ka.BSa){ka.Qa=Ja;break}}else if(2===ka.g9a)ka.Kb=ka.KGa-1,ka.BSa=ka.RCe,ka.zSa=ka.QCe;else if(3===ka.g9a||4===ka.g9a)for(Ja=0;Ja<ka.KGa+40;Ja+=40){const xa=Ja<ka.KGa?Ja:ka.KGa-1;qa=this.oNa(ka.element,ka.originalText,xa,ka.bha,ka.s3a,void 0,void 0,ka.jO);if(qa.height&&(qa.y+qa.height<ka.point.y&&(ka.Qa=xa),qa.y>ka.point.y)){ka.Kb=xa;break}}}Mdk(ka){const qa=Math.floor((ka.Qa+ka.Kb)/2);ka.cp=qa;let Ja=this.oNa(ka.element,ka.originalText,
ka.cp,ka.bha,ka.s3a,void 0,void 0,ka.jO);for(;ka.cp<ka.Kb&&!Ja.height;)ka.cp++,Ja=this.oNa(ka.element,ka.originalText,ka.cp,ka.bha,ka.s3a,void 0,void 0,ka.jO);ka.cp!==ka.Kb||Ja.height?!ka.P3b&&Ja.y+Ja.height/2<ka.BSa||ka.P3b&&Ja.y+ka.Tpg<ka.point.y?ka.Qa=ka.cp+1:!ka.P3b&&Ja.y+Ja.height/2>ka.zSa||ka.P3b&&Ja.y>ka.point.y?ka.Kb=ka.cp-1:Ja.x<=ka.point.x&&Ja.x+Ja.width>=ka.point.x?(ka.Mnb=!0,ka.GYb=!0,ka.Gue=!0):(ka.Gue=!0,ka.WVa=Ja.x+Ja.width/2,ka.iWb=ka.cp,ka.deltaX=Math.abs(ka.WVa-ka.point.x),ka.P3b&&
(ka.BSa=Ja.y,ka.zSa=Ja.y+ka.Tpg)):ka.Kb=qa-1}Cbi(ka){var qa=Math.abs(ka.oAa-ka.cp);if(qa<ka.bRf)ka.bRf=qa;else return ka.Mnb=!0,ka.xUd=!0;qa=Math.floor((ka.cp+ka.oAa)/2);qa===ka.cp&&(qa=ka.oAa);var Ja=this.oNa(ka.element,ka.originalText,qa,ka.bha,ka.s3a,void 0,void 0,ka.jO);if(0<Ja.height&&Ja.y+Ja.height/2<=ka.BSa||Ja.y+Ja.height/2>=ka.zSa)ka.oAa=ka.cp<ka.oAa?qa-1:qa+1;else if(Ja.x<=ka.point.x&&Ja.x+Ja.width>=ka.point.x)ka.cp=qa,ka.GYb=!0,ka.Mnb=!0;else{Ja=Ja.x+Ja.width/2;const xa=Math.abs(ka.WVa-
Ja),Ga=Math.abs(ka.WVa-ka.point.x),na=Math.abs(Ja-ka.point.x);na<ka.deltaX&&(ka.iWb=qa,ka.deltaX=na);xa+na===Ga?(ka.cp=qa,ka.WVa=Ja):Ga+na===xa?(ka.oAa=ka.cp<ka.oAa?ka.cp+1:ka.cp-1,ka.cp=qa,ka.WVa=Ja):xa+Ga===na&&(ka.Mnb=!0,ka.xUd=!0)}ka.oAa===ka.cp&&(ka.Mnb=!0);return!1}LSj(ka){var qa=this.oNa(ka.element,ka.originalText,ka.cp,ka.bha,ka.s3a,void 0,void 0,ka.jO);if(0<qa.height&&qa.y+qa.height/2<=ka.BSa||qa.y+qa.height/2>=ka.zSa)return!1;if(qa.x<=ka.point.x&&qa.x+qa.width>=ka.point.x)return ka.GYb=
!0;qa=Math.abs(qa.x+qa.width/2-ka.point.x);qa<ka.deltaX&&(ka.iWb=ka.cp,ka.deltaX=qa);return!1}dmi(ka){if(!ka.GYb&&-1===ka.iWb)return this.WEb(),this.hd.Tb(w.a.Rek,{["Reason"]:m.a.L1f}),null;ka.GYb?ka.deltaX=0:ka.cp=ka.iWb;u.a.Mw(ka.originalText,ka.cp)&&ka.cp--;this.WEb();return new C(ka.cp,ka.deltaX)}qt(ka,qa,Ja=!1,xa=!1,Ga=!1,na=null){let sa;ka||v.ULS.sendTraceTag(6870734,315,50,"paragraphElement is null");let Ha=({i:Ca,Hs:sa,I6:Ga,tek:qa}=this.Jdg(ka,qa,Ga)).returnValue,cb="";cb=ka.bha;ka=A.a.Su(Ha.htmlElement);
let Za=ka.length,va,Fa=!1;if(!Za)if(va=Sys.UI.DomElement.getBounds(Ha.htmlElement),Fa=!0,!va.height&&Ca<sa.length-1)Ca++,Ha=sa[Ca],ka=K.b(Ha.htmlElement),Za=ka.length;else if(!Ha.htmlElement.firstChild||Ha.Dsg)return this.UO.Sea(va,na,()=>Ha.htmlElement.offsetWidth/Ha.htmlElement.offsetHeight);var Ca=!1;!Fa&&qa>=Za&&(qa=Za-1,Ca=!0);if(va=Ha.I2||!Ha.htmlElement.firstChild||Ha.Org?this.GJd(Ha,na):this.oNa(Ha.htmlElement,ka,qa,cb,Ga,Ja,xa,na))Fa?va.width=1:Ca&&(va.x+=va.width,va.width=1);this.WEb();
return va}bCa(ka,qa,Ja=!1,xa=!0){return this.Jdg(ka,qa,Ja,xa).returnValue}D4b(ka,qa){return qa.y>ka.y+ka.height-aa.$qa(ka.height)}Jdg(ka,qa,Ja=!1,xa=!0){let Ga,na,sa=ka;Ga=ka.e5;for(ka=na=0;ka<Ga.length;ka++){if(Ga[ka].jub)continue;let Ha;if(Ga[ka].I2){if(!qa){Ja||this.eIj(Ga,ka)?sa=Ga[ka]:(sa=Ga[ka-1],qa=Ha=A.a.f6a(sa.htmlElement),na-=Ha);break}qa--;na++;continue}Ha=A.a.f6a(Ga[ka].htmlElement);let cb=!1;if(this.TNh){const Za=Ga[ka].htmlElement,va=Za.nextSibling;va&&(cb=Sys.UI.DomElement.containsCssClass(Za,
"EmptyTextRun")&&Sys.UI.DomElement.containsCssClass(va,"Hyperlink"))}if(qa<Ha||!qa&&xa&&!cb||ka>=Ga.length-1){sa=Ga[ka];break}else qa-=Ha,na+=Ha}return{returnValue:sa,i:ka,Hs:Ga,I6:na,tek:qa}}eIj(ka,qa){if(!qa)return!0;const Ja=this.Rnb(ka[qa-1].htmlElement);ka=this.Rnb(ka[qa].htmlElement);return this.D4b(Ja,ka)}oNa(ka,qa,Ja,xa,Ga,na=!1,sa=!1,Ha=null){let cb=Ja+1;Ja||qa.length?u.a.Mw(qa,Ja)?Ja--:u.a.Mw(qa,cb)&&cb++:cb=0;if(""!==xa)if(xa=Ga+Ja+"-"+xa,this.ANb){if(Ga=this.Eib[xa],void 0!==Ga&&null!==
Ga)return xa=this.UO.Sea(Ga,Ha,()=>this.UO.o7f(ka,Ja)),xa=this.tLa.YGd(Ha,ka,xa)}else this.Eib={},this.ANb=!0;Ga=this.wnc(ka,Ja,cb);na=na&&(G.a.xj||G.a.$n);if(!Ga&&!sa||na)qa=this.Wbk(ka,qa,Ja,cb),Ga||(Ga=qa),na&&Ga&&(Ga.y=qa.y,Ga.height=qa.height);""!==xa&&Ga&&(this.Eib[xa]=new Sys.UI.Bounds(Ga.x,Ga.y,Ga.width,Ga.height));xa=this.UO.Sea(Ga,Ha,()=>this.UO.o7f(ka,Ja));return xa=this.tLa.YGd(Ha,ka,xa)}wnc(ka,qa,Ja){let xa=null;if(this.A_b(ka)<Ja)return null;G.a.dU&&(xa=this.Vbk(ka,qa,Ja));!xa&&G.a.xj&&
(xa=this.Xbk(ka,qa,Ja));return xa}THf(ka,qa=null){return this.Rnb(ka.htmlElement.firstChild,qa)}GJd(ka,qa=null){return ka.KRa?this.THf(ka,qa):this.Rnb(ka.htmlElement,qa)}Rnb(ka,qa=null){var Ja=Sys.UI.DomElement.getBounds(ka);Ja=this.UO.Sea(Ja,qa,()=>ka.offsetWidth/ka.offsetHeight);return Ja=this.tLa.YGd(qa,ka,Ja)}OY(ka,qa,Ja,xa,Ga,na){return ka!==qa.characterData.length||Ja?this.uci(ka,qa,Ja,xa,Ga,na):this.tci(qa)}tci(ka){const qa=this.pNa(ka);return this.p9f(qa,!ka.isRtl)}uci(ka,qa,Ja,xa,Ga,na){var sa=
qa.textLength;if(G.a.AS&&Ja&&0<ka&&ka<sa){var Ha=this.bCa(qa,ka-1,!0),cb=this.bCa(qa,ka,!0);Ha===cb&&(Ja=!1)}var Za=Ja?ka-1:ka;u.a.Mw(qa.characterData,Za)&&--Za;var va=!0;cb=this.bCa(qa,Za,!0,!1);if(cb.I2)if(cb.KRa){if(Ja)return this.OY(ka,qa,!1,xa,!1,na);Ha=this.THf(cb)}else if(cb.PSc){if(Ja)return this.OY(ka,qa,!1,xa,!1,na);if(ka)return this.OY(ka,qa,!0,xa,!1,na);Ha=this.GJd(cb)}else Ha=this.Rnb(cb.htmlElement),cb.vHj&&(va=!1);else{cb=Za;do{Ha=this.qt(qa,cb,Ga,na);if(!Ha)return null;cb+=1}while(!Ha.height&&
cb<=sa)}cb=sa=qa.isRtl;if(va){va=this.Xzc(qa,Za,-1,Ga,na);Ga=this.Xzc(qa,Za,1,Ga,na);na=new Sys.UI.Point(Ha.x+Ha.width/2,Ha.y+Ha.height/2);Za=Ha.y;var Fa=Ha.y+Ha.height;Za=!va||va.y+va.height<=Za;Fa=!Ga||Ga.y>=Fa;let Ca=!1;Za||Fa?Za||u.a.yy(qa.characterData.charCodeAt(ka))?Fa||(Ga.x>=na.x?cb=!1:Ga.x<=na.x&&(cb=!0),Ca=cb!==sa):(va.x<=na.x?cb=!1:va.x>=na.x&&(cb=!0),Ca=cb!==sa):va.x<=na.x&&na.x<=Ga.x?cb=!1:Ga.x<=na.x&&na.x<=va.x?cb=!0:va.x<Ga.x?(cb=!0,Ca=Ja?na.x<va.x:va.x<na.x):Ga.x<va.x&&(cb=!1,Ca=
Ja?va.x<na.x:na.x<va.x);if(Ca&&G.a.dF){if(Ja&&!xa)return this.OY(ka,qa,!1,!1);ka||(Ha=this.C1i(qa,sa))}}return this.p9f(Ha,cb===Ja)}Xzc(ka,qa,Ja,xa,Ga){if(0>Ja&&0>=qa||0<Ja&&qa>=ka.characterData.length-1)return null;const na=qa+Ja;return u.a.Mw(ka.characterData,na)?this.Xzc(ka,na,Ja,xa,Ga):this.bCa(ka,qa,!0,!1).KRa?null:(qa=this.qt(ka,na,xa,Ga))?qa.height&&qa.width?qa:this.Xzc(ka,na,Ja,xa,Ga):null}C1i(ka,qa){let Ja=null;for(var xa=0;xa<ka.e5.length;xa++){const Ga=ka.e5[xa];if(!Ga.jub){Ja=Ga.htmlElement;
break}}for(xa=Ja.childNodes[0];xa&&1===xa.nodeType;)Ja=xa,xa=Ja.childNodes[0];xa=A.a.Su(Ja);A.a.ix(Ja,(qa?"\u202e":"\u202d")+xa);this.Vba();ka=this.qt(ka,0);A.a.ix(Ja,xa);this.Vba();return ka}p9f(ka,qa){return new Sys.UI.Bounds(qa?ka.x:ka.x+ka.width,ka.y,0,ka.height)}pNa(ka,qa=null){return this.Rnb(ka.M_f.htmlElement,qa)}Vbk(ka,qa,Ja){this.WEb();try{const xa=ka.firstChild,Ga=xa.ownerDocument.createRange();Ga.setStart(xa,qa);Ga.setEnd(xa,Ja);const na=this.t8i(Ga,(sa,Ha)=>(0<sa||qa===Ja)&&0<Ha);if(!na||
!na.length)return null;this.vDf(xa,na[0]);Ga.detach();return na[0]}catch(xa){return null}}t8i(ka,qa){this.WEb();try{let Ja;Ja=ka.getClientRects();ka=[];for(let xa=0;xa<Ja.length;xa++){const Ga=Ja[xa];if(Ga){const na=Math.floor(Ga.width/1),sa=Math.floor(Ga.height/1);if(qa(na,sa)){const Ha=new Sys.UI.Bounds(Math.floor(Ga.left/1),Math.floor(Ga.top/1),na,sa);Array.add(ka,Ha)}}}return ka}catch(Ja){return null}}Xbk(ka,qa,Ja){if(!G.a.RHb)return null;let xa=null;try{xa=ka.ownerDocument.body.createTextRange(),
xa.moveToElementText(ka)}catch(Ga){return null}if(xa.collapse&&xa.move&&xa.moveEnd)xa.collapse(),xa.move("character",qa),xa.moveEnd("character",Ja-qa);else return null;qa=new Sys.UI.Bounds(xa.boundingLeft,xa.boundingTop,xa.boundingWidth,xa.boundingHeight);if(!(qa.x||qa.y||qa.width||qa.height))return null;this.vDf(ka,qa);ka=window.screen.deviceXDPI/window.screen.logicalXDPI;1!==ka&&(qa.x=Math.round(qa.x/ka),qa.y=Math.round(qa.y/ka),qa.width=Math.round(qa.width/ka),qa.height=Math.round(qa.height/ka));
return qa}Wbk(ka,qa,Ja,xa){this.R1a&&this.R1a.ownerDocument===ka.ownerDocument||(this.R1a=ka.ownerDocument.createElement("SPAN"),this.Qlb=ka.ownerDocument.createElement("SPAN"),this.$wc=ka.ownerDocument.createElement("SPAN"));ka.firstChild!==this.R1a&&(this.Auc=new I.a(ka),A.a.$t(ka),this.tLa&&this.tLa.Gmi(this.R1a,this.Qlb,this.$wc),ka.appendChild(this.R1a),ka.appendChild(this.Qlb),ka.appendChild(this.$wc));A.a.ix(this.R1a,u.a.substring(qa,0,Ja));A.a.ix(this.Qlb,u.a.substring(qa,Ja,xa));A.a.ix(this.$wc,
u.a.substring(qa,xa,qa.length));H.AFrameworkApplication.fa.ka("ChromiumSpanIssueFixIsEnabled")&&G.a.Hj&&G.a.pDj&&" "===u.a.substring(qa,Ja,xa)&&Sys.UI.DomElement.addCssClass(this.Qlb,"WhiteSpaceSpanElement");return Sys.UI.DomElement.getBounds(this.Qlb)}vDf(ka,qa){this.w6h(ka,[qa])}w6h(ka,qa){try{if(void 0!==ka.ownerDocument.parentWindow){var Ja=ka.ownerDocument.parentWindow.frameElement;if(Ja&&("0"===Ja.frameBorder||"no"===Ja.frameBorder))for(ka=0;ka<qa.length;ka++)qa[ka].x+=2,qa[ka].y+=2}}catch(xa){}}WEb(){this.Auc&&
this.Auc.restore();this.Auc=null}Snb(ka,qa){if(""!==qa){let Ja;if(this.ANb){if(Ja=this.Eib["VE-"+qa])return ka=new Sys.UI.Bounds(Ja.x,Ja.y,Ja.width,Ja.height)}else this.Eib={},this.ANb=!0;Ja=Sys.UI.DomElement.getBounds(ka);this.Eib["VE-"+qa]=Ja;return ka=new Sys.UI.Bounds(Ja.x,Ja.y,Ja.width,Ja.height)}return Sys.UI.DomElement.getBounds(ka)}static get instance(){return aa.Ja||(aa.Ja=new aa(e.a.instance,h.a.instance.La("Common.IZoomManager"),H.AFrameworkApplication.fa,h.a.instance.resolve("Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy"),
h.a.instance.resolve("Box4.IRotatingCoordinateConverter"),h.a.instance.resolve("Box4.TextMetricsApi.ITextMetricsHelper")))}static $qa(ka){return P.SelectionEditor.$qa(ka)}}aa.Ja=null;Object(J.a)(aa,"TextMetrics",null,[]);var Q=d(96);class ea{get KRa(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.F5b)}get I2(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.yM)}get PSc(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.Hrk)}get vHj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
Q.a.Nyj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.Myj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.Kyj)}get Dsg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.KSd)}get Org(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.aQf)}}Object(J.a)(ea,"ATextMetricsElement",null,[411]);var ia=d(31),ja=d(148);class D extends ea{constructor(ka){super();this.JO=ka}get htmlElement(){return this.JO}get Pia(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
Q.a.OM)}get jub(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ja.a.YU)}get dHj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.gBj)}get VDj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.Tbi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.Pyj)}get UDj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.Sbi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,Q.a.Oyj)}}Object(J.a)(D,"TextMetricsLeafElement",ea,[449,411]);var pa=
d(51),Z=d(56);class oa extends ea{constructor(ka){super();this.Wkb=ka;this.Fi=this.Wkb.$a;this.uRb=Array(ka.Is.length);for(ka=0;ka<this.Wkb.Is.length;ka++){const qa=new D(this.Wkb.Is[ka]);this.uRb[ka]=qa}}get e5(){return this.uRb}get paragraphId(){return this.Fi.id.toString()}get htmlElement(){return this.Wkb.htmlElement}get bha(){return this.Wkb.Oc.Hh?this.Wkb.$a.id.toString():""}get textLength(){return ia.ParagraphReader.textLength(this.Fi)}get isRtl(){return Z.OutlineElementReader.Yl(pa.OutlineElementNavigator.rA(this.Fi))}get Mr(){return ia.ParagraphReader.Wd(this.Fi)&&
!this.Fi.IV}get characterData(){return this.Fi.characterData}get M_f(){return this.uRb.length?this.uRb[this.uRb.length-1]:null}static i4a(ka){return new oa(ka)}}Object(J.a)(oa,"TextMetricsParagraphElement",ea,[410,411]);var Ba=d(49),Ma=d(32);d.d(V,"a",function(){return za});class za{static get hWb(){return za.dA||(za.dA=h.a.instance.pb("Box4.CharacterPointConverter"))}static get Tc(){return e.a.instance}static qt(ka,qa,Ja=!1,xa=!1,Ga=!1,na=null){ka=oa.i4a(ka);return aa.instance.qt(ka,qa,Ja,xa,Ga,
na)}static wnc(ka,qa,Ja){return aa.instance.wnc(ka,qa,Ja)}static Snb(ka,qa){return aa.instance.Snb(ka,qa)}static OY(ka,qa,Ja,xa,Ga=!1,na=!1){qa=oa.i4a(qa);return aa.instance.OY(ka,qa,Ja,xa,Ga,na)}static pNa(ka,qa=null){ka=oa.i4a(ka);return aa.instance.pNa(ka,qa)}static Vba(){aa.instance.Vba()}static e4a(ka,qa,Ja,xa=null){let Ga=null,na=null;try{const sa=oa.i4a(ka);let Ha=null;Ga=za.Tc.Bp(Ma.a.jZi);(Ha=aa.instance.e4a(sa,qa,Ja,xa))&&(na=za.hWb?za.hWb.tCl(Ha,ka.$a):Ba.a.VNa(Ha.CpBegin,Ha.CpEnd,Ha.IsEop,
ka.$a))}catch(sa){za.Tc.Tb(n.a.DBl,{["Reason"]:m.a.PMi,["ExceptionMessage"]:sa.message,["ExceptionCallstack"]:sa.stack}),na=null}Ga&&Ga.end();return na}static bCa(ka,qa,Ja=!1,xa=!0){ka=oa.i4a(ka);return aa.instance.bCa(ka,qa,Ja,xa).htmlElement}static D4b(ka,qa){return aa.instance.D4b(ka,qa)}}za.dA=null;Object(J.a)(za,"TextMetricsAdapter",null,[])},304:function(J,V,d){J=d(0);var h=d(375),e=d(25),m=d(1185);const n=(A,w)=>{const y={};let u=null;switch(A){case 0:u="HtmlProcessor";var E=w.a;null!=E&&(y.SessionID=
E);var G=w.b.toString();null!=G&&(y.Elements=G);var I=w.c.toString();null!=I&&(y.PrunedElements=I);var H=w.d.toString();null!=H&&(y.TransparentElements=H);var K=w.e.toString();null!=K&&(y.VoidElements=K);var C=w.f.toString();null!=C&&(y.UnknownElements=C);break;case 1:u="WordConverter";var Y=w.a;null!=Y&&(y.SessionID=Y);var M=w.b.toString();null!=M&&(y.BulletsConverted=M);var P=w.c.toString();null!=P&&(y.NumberedConverted=P);break;case 2:u="FormattingSteward";var T=w.a;null!=T&&(y.SourceApp=T);var L=
w.b;null!=L&&(y.Browser=L);var aa=w.c;null!=aa&&(y.OperationId=aa);var Q=w.d.toString();null!=Q&&(y.Lang=Q);var ea=w.e.toString();null!=ea&&(y.TextDir=ea);var ia=w.f.toString();null!=ia&&(y.Bold=ia);var ja=w.g.toString();null!=ja&&(y.Math=ja);var D=w.h.toString();null!=D&&(y.Italics=D);var pa=w.i.toString();null!=pa&&(y.Underline=pa);var Z=w.j.toString();null!=Z&&(y.Strikethrough=Z);var oa=w.k.toString();null!=oa&&(y.Subscript=oa);var Ba=w.l.toString();null!=Ba&&(y.Superscript=Ba);var Ma=w.m.toString();
null!=Ma&&(y.Fontsize=Ma);var za=w.n.toString();null!=za&&(y.Fontface=za);var ka=w.o.toString();null!=ka&&(y.GrowFontsize=ka);var qa=w.p.toString();null!=qa&&(y.ShrinkFontsize=qa);var Ja=w.q.toString();null!=Ja&&(y.FontColor=Ja);var xa=w.r.toString();null!=xa&&(y.FontHighlight=xa);var Ga=w.s.toString();null!=Ga&&(y.ParagraphStyle=Ga);var na=w.t.toString();null!=na&&(y.TextAlign=na);var sa=w.u.toString();null!=sa&&(y.TextIndent=sa);var Ha=w.v.toString();null!=Ha&&(y.MarginLeft=Ha);var cb=w.w.toString();
null!=cb&&(y.ParagraphSpaceBefore=cb);var Za=w.x.toString();null!=Za&&(y.ParagraphSpaceAfter=Za);var va=w.y.toString();null!=va&&(y.LineSpace=va);var Fa=w.z.toString();null!=Fa&&(y.CellShadingColor=Fa);break;case 3:u="SemanticEvents";var Ca=w.a;null!=Ca&&(y.SessionID=Ca);var La=w.b.toString();null!=La&&(y.Text=La);var nb=w.c.toString();null!=nb&&(y.LineBreak=nb);var Nb=w.d.toString();null!=Nb&&(y.Image=Nb);var Rb=w.e.toString();null!=Rb&&(y.File=Rb);var Ya=w.f.toString();null!=Ya&&(y.FormattingChange=
Ya);var Qb=w.g.toString();null!=Qb&&(y.Anchor=Qb);var bb=w.h.toString();null!=bb&&(y.Paragraph=bb);var Bb=w.i.toString();null!=Bb&&(y.Math=Bb);var Eb=w.j.toString();null!=Eb&&(y.List=Eb);var tb=w.k.toString();null!=tb&&(y.ListItem=tb);var Yb=w.l.toString();null!=Yb&&(y.RenderAugmentation=Yb);var Tc=w.m.toString();null!=Tc&&(y.Span=Tc);break;case 4:u="SemanticTableEvents";var ib=w.a;null!=ib&&(y.SessionID=ib);var Zb=w.b.toString();null!=Zb&&(y.Tables=Zb);var Cc=w.c.toString();null!=Cc&&(y.TableRow=
Cc);var ob=w.d.toString();null!=ob&&(y.TableCell=ob);var cc=w.e.toString();null!=cc&&(y.TablePart=cc);break;case 5:u="HtmlEvents";var sb=w.a;null!=sb&&(y.OperationId=sb);var mb=w.b;null!=mb&&(y.SourceApp=mb);var Pb=w.c;null!=Pb&&(y.Browser=Pb);var dc=null==w.d?null:w.d.toString();null!=dc&&(y.Text=dc);var mc=null==w.e?null:w.e.toString();null!=mc&&(y.A=mc);var Mb=null==w.f?null:w.f.toString();null!=Mb&&(y.Abbr=Mb);var Kc=null==w.g?null:w.g.toString();null!=Kc&&(y.Acronym=Kc);var gc=null==w.h?null:
w.h.toString();null!=gc&&(y.Address=gc);var rb=null==w.i?null:w.i.toString();null!=rb&&(y.Applet=rb);var Ua=null==w.j?null:w.j.toString();null!=Ua&&(y.Area=Ua);var pb=null==w.k?null:w.k.toString();null!=pb&&(y.B=pb);var Ub=null==w.l?null:w.l.toString();null!=Ub&&(y.Base=Ub);var Bc=null==w.m?null:w.m.toString();null!=Bc&&(y.Basefont=Bc);var Gc=null==w.n?null:w.n.toString();null!=Gc&&(y.Bdo=Gc);var qd=null==w.o?null:w.o.toString();null!=qd&&(y.Big=qd);var Td=null==w.p?null:w.p.toString();null!=Td&&
(y.Blockquote=Td);var Vd=null==w.q?null:w.q.toString();null!=Vd&&(y.Body=Vd);var Be=null==w.r?null:w.r.toString();null!=Be&&(y.Br=Be);var Id=null==w.s?null:w.s.toString();null!=Id&&(y.Button=Id);var gb=null==w.t?null:w.t.toString();null!=gb&&(y.Caption=gb);var Xb=null==w.u?null:w.u.toString();null!=Xb&&(y.Center=Xb);var Ic=null==w.v?null:w.v.toString();null!=Ic&&(y.Cite=Ic);var Wc=null==w.w?null:w.w.toString();null!=Wc&&(y.Code=Wc);var Ib=null==w.x?null:w.x.toString();null!=Ib&&(y.Col=Ib);var ec=
null==w.y?null:w.y.toString();null!=ec&&(y.Colgroup=ec);var Jb=null==w.z?null:w.z.toString();null!=Jb&&(y.Dd=Jb);var hb=null==w.ba?null:w.ba.toString();null!=hb&&(y.Del=hb);var Rc=null==w.bb?null:w.bb.toString();null!=Rc&&(y.Dfn=Rc);var gd=null==w.bc?null:w.bc.toString();null!=gd&&(y.Dir=gd);var hd=null==w.bd?null:w.bd.toString();null!=hd&&(y.Div=hd);var Hd=null==w.be?null:w.be.toString();null!=Hd&&(y.Dl=Hd);var Xd=null==w.bf?null:w.bf.toString();null!=Xd&&(y.Dt=Xd);var id=null==w.bg?null:w.bg.toString();
null!=id&&(y.Em=id);var fd=null==w.bh?null:w.bh.toString();null!=fd&&(y.Fieldset=fd);var Vf=null==w.bi?null:w.bi.toString();null!=Vf&&(y.Font=Vf);var Qd=null==w.bj?null:w.bj.toString();null!=Qd&&(y.Form=Qd);var Zf=null==w.bk?null:w.bk.toString();null!=Zf&&(y.Frame=Zf);var Ge=null==w.bl?null:w.bl.toString();null!=Ge&&(y.Frameset=Ge);var le=null==w.bm?null:w.bm.toString();null!=le&&(y.H=le);var Sa=null==w.bn?null:w.bn.toString();null!=Sa&&(y.Head=Sa);var Cb=null==w.bo?null:w.bo.toString();null!=Cb&&
(y.Hr=Cb);var rc=null==w.bp?null:w.bp.toString();null!=rc&&(y.Html=rc);var bd=null==w.bq?null:w.bq.toString();null!=bd&&(y.I=bd);var pd=null==w.br?null:w.br.toString();null!=pd&&(y.Iframe=pd);var Oa=null==w.bs?null:w.bs.toString();null!=Oa&&(y.Img=Oa);var jb=null==w.bt?null:w.bt.toString();null!=jb&&(y.Input=jb);var nc=null==w.bu?null:w.bu.toString();null!=nc&&(y.Ins=nc);var kb=null==w.bv?null:w.bv.toString();null!=kb&&(y.Isindex=kb);var Gb=null==w.bw?null:w.bw.toString();null!=Gb&&(y.Kbd=Gb);var tc=
null==w.bx?null:w.bx.toString();null!=tc&&(y.Label=tc);var dd=null==w.by?null:w.by.toString();null!=dd&&(y.Legend=dd);var $c=null==w.bz?null:w.bz.toString();null!=$c&&(y.Li=$c);var Pc=null==w.ca?null:w.ca.toString();null!=Pc&&(y.Link=Pc);var Ad=null==w.cb?null:w.cb.toString();null!=Ad&&(y.Map=Ad);var Ee=null==w.cc?null:w.cc.toString();null!=Ee&&(y.Math=Ee);var Ce=null==w.cd?null:w.cd.toString();null!=Ce&&(y.Menu=Ce);var Fb=null==w.ce?null:w.ce.toString();null!=Fb&&(y.Meta=Fb);var $e=null==w.cf?null:
w.cf.toString();null!=$e&&(y.Noframes=$e);var bg=null==w.cg?null:w.cg.toString();null!=bg&&(y.Noscript=bg);var Ye=null==w.ch?null:w.ch.toString();null!=Ye&&(y.Object=Ye);var Ae=null==w.ci?null:w.ci.toString();null!=Ae&&(y.Ol=Ae);var si=null==w.cj?null:w.cj.toString();null!=si&&(y.Optgroup=si);var Jf=null==w.ck?null:w.ck.toString();null!=Jf&&(y.Option=Jf);var tg=null==w.cl?null:w.cl.toString();null!=tg&&(y.P=tg);var Dg=null==w.cm?null:w.cm.toString();null!=Dg&&(y.Param=Dg);var Vg=null==w.cn?null:w.cn.toString();
null!=Vg&&(y.Pre=Vg);var Ih=null==w.co?null:w.co.toString();null!=Ih&&(y.Q=Ih);var hf=null==w.cp?null:w.cp.toString();null!=hf&&(y.S=hf);var ld=null==w.cq?null:w.cq.toString();null!=ld&&(y.Samp=ld);var ph=null==w.cr?null:w.cr.toString();null!=ph&&(y.Script=ph);var Kf=null==w.cs?null:w.cs.toString();null!=Kf&&(y.Select=Kf);var Ud=null==w.ct?null:w.ct.toString();null!=Ud&&(y.Small=Ud);var He=null==w.cu?null:w.cu.toString();null!=He&&(y.Span=He);var Bh=null==w.cv?null:w.cv.toString();null!=Bh&&(y.Strike=
Bh);var eg=null==w.cw?null:w.cw.toString();null!=eg&&(y.Strong=eg);var jd=null==w.cx?null:w.cx.toString();null!=jd&&(y.Style=jd);var Jh=null==w.cy?null:w.cy.toString();null!=Jh&&(y.Sub=Jh);var kf=null==w.cz?null:w.cz.toString();null!=kf&&(y.Sup=kf);var Ji=null==w.da?null:w.da.toString();null!=Ji&&(y.Tables=Ji);var hh=null==w.db?null:w.db.toString();null!=hh&&(y.Tbody=hh);var Wb=null==w.dc?null:w.dc.toString();null!=Wb&&(y.Td=Wb);var Uc=null==w.dd?null:w.dd.toString();null!=Uc&&(y.Textarea=Uc);var Sc=
null==w.de?null:w.de.toString();null!=Sc&&(y.Tfoot=Sc);var Od=null==w.df?null:w.df.toString();null!=Od&&(y.Th=Od);var ug=null==w.dg?null:w.dg.toString();null!=ug&&(y.Thead=ug);var te=null==w.dh?null:w.dh.toString();null!=te&&(y.Title=te);var mf=null==w.di?null:w.di.toString();null!=mf&&(y.Tr=mf);var Yf=null==w.dj?null:w.dj.toString();null!=Yf&&(y.Tt=Yf);var Jd=null==w.dk?null:w.dk.toString();null!=Jd&&(y.U=Jd);var ce=null==w.dl?null:w.dl.toString();null!=ce&&(y.Ul=ce);var fe=null==w.dm?null:w.dm.toString();
null!=fe&&(y.Var=fe);var Gg=null==w.dn?null:w.dn.toString();null!=Gg&&(y.Unknown=Gg);break;case 6:u="List";var Me=w.a;null!=Me&&(y.SessionID=Me);var se=w.b.toString();null!=se&&(y.MaxListLevel=se)}y.Table=u;return Sys.Serialization.JavaScriptSerializer.serialize(y)};d.d(V,"a",function(){return v});class v{static get M7(){null==v.u0a&&(v.u0a=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("UsageEditorLoggingIsDisabled"));return v.u0a}static get uug(){null==v.Lud&&(v.Lud=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("WordUsageEditorLoggingIsEnabled"));return v.Lud}static aQ(A){h.ULS.sendTraceTag(5822145,307,50,A)}static j$f(A){const w={};w.a=A;w.b=0;w.c=0;w.d=0;w.e=0;w.f=0;return w}static nWj(A){v.M7||v.aQ(n(0,A))}static Y1d(A){const w={};w.a=A;w.b=0;w.c=0;return w}static kYj(A){v.M7||v.aQ(n(1,A))}static i$f(A,w){const y={};y.c=m.a[A];y.a=w;return y}static mWj(A,w){v.uug&&A&&(A.b=w,v.aQ(n(5,A)))}static $cg(A){const w={};w.a=A;w.b=0;w.c=0;w.d=0;w.e=0;w.f=0;w.g=0;w.h=0;w.i=0;w.j=0;
w.k=0;w.l=0;w.m=0;return w}static yXj(A){v.M7||v.aQ(n(3,A))}static adg(A){const w={};w.a=A;w.b=0;w.c=0;w.d=0;w.e=0;return w}static zXj(A){v.M7||v.aQ(n(4,A))}static UYd(A,w){const y={};y.b=m.a[A];y.c=w;y.d=0;y.e=0;y.f=0;y.g=0;y.h=0;y.i=0;y.j=0;y.k=0;y.l=0;y.m=0;y.n=0;y.o=0;y.p=0;y.q=0;y.r=0;y.s=0;y.t=0;y.w=0;y.x=0;y.y=0;y.z=0;y.u=0;y.v=0;return y}static bWj(A,w){v.uug&&A&&(A.a=w,v.aQ(n(2,A)))}static o6i(A){const w={};w.a=A;w.b=-1;return w}static GWj(A){!v.M7&&A&&0<=A.b&&v.aQ(n(6,A))}}v.u0a=null;v.Lud=
null;Object(J.a)(v,"UsageEditor",null,[])},321:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.z$=1E5;Object(J.a)(h,"ViewConstants",null,[])},322:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ge=this.Wf=this.Yd=this.Jf=0}DOi(e){return e.ge<this.Wf&&this.ge<e.Wf&&e.Yd<this.Jf&&this.Yd<e.Jf}Lqb(e){return e.ge>=this.ge&&e.Wf<=this.Wf&&e.Yd>=this.Yd&&e.Jf<=this.Jf}vOi(e,m){return e>=this.D3f&&e<=this.gbe&&m>=this.w3f&&m<=this.Zae}hPa(){return 0>=this.$N||
0>=this.CQ}equals(e){return e.ge===this.ge&&e.Wf===this.Wf&&e.Yd===this.Yd&&e.Jf===this.Jf}clone(){return Object.assign(new h,{ge:this.ge,Wf:this.Wf,Yd:this.Yd,Jf:this.Jf})}toString(){return String.format("CellRange, rowFirst:{0}, rowLim:{1}, colFirst:{2}, colLim:{3}",this.ge,this.Wf,this.Yd,this.Jf)}get $N(){return this.Wf-this.ge}get CQ(){return this.Jf-this.Yd}get gbe(){return this.Wf-1}get Zae(){return this.Jf-1}get D3f(){return this.ge}get w3f(){return this.Yd}}Object(J.a)(h,"CellRange",null,
[])},323:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.XY="data-copystatus";h.SNa="data-copyfailedreason";h.Fp="data-clipservice-ccpid";h.version="data-clipservice-version";h.location="data-clipservice-location";h.jE="data-clipservice-dc";h.type="data-clipservice-type";h.Gte="data-clipservice-param";h.count="data-clipservice-count";h.VCa="data-clipservice-cut";h.TCa="data-clipservice-isEmptyPlaceholder";h.client="data-clipservice-client";h.xni="data-clipboardasbytes-url";h.MDh=
"wacserver";h.sessionId="data-SessionId";h.Tfb="data-ShapeIds";h.slideId="data-SlideId";h.timeStamp="data-TimeStamp";h.Iuj="data-willexpire";h.glg="ClipboardAsImage";h.Qy="data-pkey";Object(J.a)(h,"ClipServiceConstants",null,[])},324:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Code=0;this.Message=this.ExtraErrorParam=null;this.RecommendedActions=0;this.Title=null;this.Type=0}}Object(J.a)(h,"ServiceError",null,[])},338:function(J,V,d){J=d(0);var h=d(375),e=d(267),
m=d(648),n=d(27),v=d(512);class A{}Object(J.a)(A,"ProofingFeedbackLoopRequestObject",null,[]);var w=d(513),y=d(32),u=d(511);d.d(V,"a",function(){return E});class E extends m.a{constructor(G,I,H,K,C=null){super(I);this.I$=G;this.qOh=H;this.zSh=K;this.V4e=!1;this.jb=C;this.errorType=1===(this.I$.CritiqueActions&1)?0:1}get proofingType(){return v.b(this.I$)}get traceId(){return this.I$.TraceId}get typeId(){return this.I$.TypeId}get GM(){return this.I$}get suggestions(){const G=[];if(this.I$.Suggestions)for(const I of this.I$.Suggestions)G.push(I.Text);
return G}get metadata(){const G=[];if(this.I$.Metadata&&0<this.I$.Metadata.length)for(const I of this.I$.Metadata)I.Name&&I.Value&&G.push(I);return G}kJa(G,I=0){this.oqf.track(()=>Object.assign(new w.a,{E:2,T:this.proofingType,A:G,I,G:this.typeId}));if(this.qOh){var H=e.a.le(this.lcid);let K="";H?K=H.name:h.ULS.sendTraceTag(36316369,375,50,"Lcid results in null CultureInfo: [LCID: {0}]",this.lcid);H=null;h.ULS.sendTraceTag(39416218,375,50,"Sending proofing context with feedback loop API");H=Object.assign(new A,
{AppId:u.a[n.App.mode]+"_online",TraceId:this.traceId,LanguageId:K,CritiqueTypeId:this.typeId,EventId:this.wak(G),FlaggedText:this.token,SuggestionText:this.pej(G),PreContextBegin:this.L9,PostContextEnd:this.bHa,OriginalText:this.originalText,Suggestions:this.suggestions,CritiquePriority:this.I$.Priority,Metadata:this.I$.Metadata});14!==H.EventId&&this.zSh.FZk(H)}}wak(G){switch(G){case y.a.Kra:return 0;case y.a.F4d:return 1;case y.a.uOa:return 3;case y.a.Rwa:return 4;case y.a.Swa:return 5;case y.a.Twa:return 6;
case y.a.FXb:return 13;default:return 14}}pej(G){switch(G){case y.a.Rwa:return this.suggestions[0];case y.a.Swa:return this.suggestions[1];case y.a.Twa:return this.suggestions[2];case y.a.SIa:return this.suggestions[3];case y.a.TIa:return this.suggestions[4];default:return""}}get sCa(){return this.V4e}set sCa(G){this.V4e=G}}Object(J.a)(E,"EditorServiceErrorDetails",m.a,[384,385])},339:function(J,V,d){var h=d(288),e=d(773),m=d(1187),n=d(45),v=d(220),A=d(25);J=d(0);class w{constructor(){this.g=this.b=
0;this.hex=null;this.r=0}}Object(J.a)(w,"RecentColor",null,[]);var y=d(236),u=d(256),E=d(223),G=d(261),I=d(1006),H=d(528),K=d(26);d.d(V,"f",function(){return C});d.d(V,"e",function(){return Y});d.d(V,"d",function(){return M});d.d(V,"c",function(){return P});d.d(V,"g",function(){return T});d.d(V,"b",function(){return L});d.d(V,"a",function(){return aa});d.d(V,"h",function(){return Q});const C=(ia,ja,D,pa,Z,oa,Ba)=>Y(ia,ja,D,pa,Z,oa,Ba,!1),Y=(ia,ja,D,pa,Z,oa,Ba,Ma)=>{ja=Object.assign(new h.a,{Id:ja,
ControlsId:D,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});pa=Object.assign(new e.a,{Id:pa,ExternalId:Z,McuExternalId:String.format("{0}MCU",Z),McuLayout:!0,Command:oa,Width:10});if(ia)if(Z=[],1===Ba||2===Ba){Ma=(new I.a).XZi(ia);({themeColors:ia,Tvh:Ba}=ea(Ma,ia));for(var za=0;6>za;za++)for(var ka=0;ka<ia.length;ka++){oa=Z;D=oa.push;var qa=void 0,Ja=void 0;qa=Ma;var xa=ia[ka][za];Ja=ia[ka][0];var Ga=Ba[ka],na=za,sa=ka;xa=n.a.Gv(xa.r,2)+n.a.Gv(xa.g,2)+n.a.Gv(xa.b,2);({xDc:qa,CIb:Ja}=qa.JXd(Ja,
xa,Ga,na,sa));xa=Object.assign(new m.a,{Color:"#"+qa,DisplayColor:"#"+xa,Alt:Ja});D.call(oa,xa)}}else for(Ma=(new I.a).H7f(ia,Ma),{themeColors:ia,Tvh:Ba}=ea(Ma,ia),za=0;6>za;za++)for(ka=0;ka<ia.length;ka++)oa=Z,D=oa.push,qa=Ma,xa=ia[ka][za],Ja=ia[ka][0],Ga=Ba[ka],na=za,sa=ka,xa=n.a.Gv(xa.r,2)+n.a.Gv(xa.g,2)+n.a.Gv(xa.b,2),{xDc:Ja,CIb:qa}=qa.JXd(Ja,xa,Ga,na,sa),{pVk:Ja,dYk:qa,CIb:xa}={pVk:xa,dYk:Ja,CIb:qa},xa=Object.assign(new m.a,{Color:qa,DisplayColor:"#"+Ja,Alt:xa}),D.call(oa,xa);else Z=null;pa.Colors=
Z;Array.add(ja.ControlList,pa);return ja},M=(ia,ja,D,pa,Z,oa)=>{ia=Object.assign(new h.a,{Id:ia,ControlsId:ja,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});D=Object.assign(new e.a,{Id:D,ExternalId:pa,Command:Z,Width:10,Colors:[]});oa?(D.Colors.push(Object.assign(new m.a,{Color:"0000C0",Alt:n.a.ie(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),D.Colors.push(Object.assign(new m.a,{Color:"0000FF",Alt:n.a.ie(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),D.Colors.push(Object.assign(new m.a,
{Color:"00C0FF",Alt:n.a.ie(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),D.Colors.push(Object.assign(new m.a,{Color:"00FFFF",Alt:n.a.ie(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),D.Colors.push(Object.assign(new m.a,{Color:"50D092",Alt:n.a.ie(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),D.Colors.push(Object.assign(new m.a,{Color:"50B000",Alt:n.a.ie(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),D.Colors.push(Object.assign(new m.a,
{Color:"F0B000",Alt:n.a.ie(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),D.Colors.push(Object.assign(new m.a,{Color:"C07000",Alt:n.a.ie(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),D.Colors.push(Object.assign(new m.a,{Color:"602000",Alt:n.a.ie(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),D.Colors.push(Object.assign(new m.a,{Color:"A03070",Alt:n.a.ie(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):(D.Colors.push(Object.assign(new m.a,
{Color:"#C00000",Alt:n.a.ie(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),D.Colors.push(Object.assign(new m.a,{Color:"#FF0000",Alt:n.a.ie(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),D.Colors.push(Object.assign(new m.a,{Color:"#FFC000",Alt:n.a.ie(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),D.Colors.push(Object.assign(new m.a,{Color:"#FFFF00",Alt:n.a.ie(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),D.Colors.push(Object.assign(new m.a,{Color:"#92D050",
Alt:n.a.ie(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),D.Colors.push(Object.assign(new m.a,{Color:"#00B050",Alt:n.a.ie(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),D.Colors.push(Object.assign(new m.a,{Color:"#00B0F0",Alt:n.a.ie(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),D.Colors.push(Object.assign(new m.a,{Color:"#0070C0",Alt:n.a.ie(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),D.Colors.push(Object.assign(new m.a,{Color:"#002060",
Alt:n.a.ie(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),D.Colors.push(Object.assign(new m.a,{Color:"#7030A0",Alt:n.a.ie(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(ia.ControlList,D);return ia},P=(ia,ja,D,pa,Z,oa,Ba)=>{ja=Object.assign(new h.a,{Id:ja,ControlsId:D,Title:ResourceStrings.L_RecentColors,ControlList:[]});pa=Object.assign(new e.a,{Id:pa,ExternalId:Z,Command:oa,Width:10,Colors:[]});if(Ba)for(Ba=0;ia&&Ba<ia.length&&ia[Ba];Ba++)Z=ia[Ba],pa.Colors.push(Object.assign(new m.a,
{Color:Z.hex,Alt:n.a.ie(Z.hex),DisplayColor:Z.hex}));else for(Ba=0;ia&&Ba<ia.length&&ia[Ba];Ba++)Z=ia[Ba],pa.Colors.push(Object.assign(new m.a,{Color:"#"+Z.hex,Alt:n.a.ie("#"+Z.hex),DisplayColor:"#"+Z.hex}));Array.add(ja.ControlList,pa);return ja},T=(ia,ja)=>{if(!ja)return ia;var D=new w;D.hex=ja;const pa=[];let Z=0;pa[Z++]=D;for(D=0;ia&&D<ia.length&&10>D&&10>Z&&ia[D];D++)ia[D].hex!==ja&&(pa[Z++]=ia[D]);return pa},L=(ia,ja,D,pa,Z,oa,Ba,Ma)=>{ia=Object.assign(new h.a,{Id:ia,ControlsId:ja,DisplayMode:"Menu16",
ControlList:[]});D=Object.assign(new v.a,{Command:D,LabelText:pa,Image16by16:A.AFrameworkApplication.Vl,Image16by16Class:Ba,Id:Z,ExternalId:oa,KeyTip:Ma});Array.add(ia.ControlList,D);return ia},aa=(ia,ja,D,pa,Z,oa,Ba,Ma)=>{ia=Object.assign(new h.a,{Id:ia,ControlsId:ja,DisplayMode:"Menu16",ControlList:[]});D=Object.assign(new v.a,{Command:D,LabelText:pa,Image16by16:A.AFrameworkApplication.Vl,Image16by16Class:Ba,Id:Z,ExternalId:oa,KeyTip:Ma});Array.add(ia.ControlList,D);return ia},Q=(ia,ja,D)=>{for(let qa=
0;qa<ia.MenuSectionList.length;qa++){var pa=ia.MenuSectionList[qa],Z=pa.ControlList;if(Z&&0<Z.length&&(Z=Z[0]))if(ja)if(pa.Id===H.a.themeColors&&D){var oa=E.i(ja.zC)||"";pa=D;var Ba=Z.Colors,Ma="#";if(Ba&&Ba.length)if(n.a.Va(oa))K.a.J(523531867,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");else for(var za=0;za<Ba.length;za++){var ka=Ba[za].Color;if(!n.a.Va(ka)&&(ka=(ka=u.a.parse(Ba[za].Color))?ka.rmc():G.SchemeColor.parse(Ba[za].Color),pa&&ka&&ka.JCe(pa)&&ka.Bra&&(ka=E.i(ka.fP),
ka.toLowerCase()===oa.toLowerCase()))){Ma=Ba[za].Color;break}}pa=Ma;Z.SelectedColorId=pa}else{Ba=E.i(E.g(ja.zC))||"";pa=Z.Colors;oa="#";if(pa&&pa.length)if(n.a.Va(Ba))K.a.J(523531868,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(Ma=0;Ma<pa.length;Ma++)if(za=pa[Ma].DisplayColor,!n.a.Va(za)&&za.replace("#","").toLowerCase()===Ba.toLowerCase()){oa=pa[Ma].Color;break}pa=oa;Z.SelectedColorId=pa}else Z.SelectedColorId="#"}},ea=(ia,ja)=>{let D;D=Array(10);D[0]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Background1));
D[1]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Text1));D[2]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Background2));D[3]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Text2));D[4]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent1));D[5]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent2));D[6]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent3));D[7]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent4));D[8]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent5));D[9]=ia.oK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent6));
ia=Array(10);ia[0]=ResourceStrings.l_ThemeLabel1;ia[1]=ResourceStrings.l_ThemeLabel2;ia[2]=ResourceStrings.l_ThemeLabel3;ia[3]=ResourceStrings.l_ThemeLabel4;ia[4]=ResourceStrings.l_ThemeLabel5;ia[5]=ResourceStrings.l_ThemeLabel6;ia[6]=ResourceStrings.l_ThemeLabel7;ia[7]=ResourceStrings.l_ThemeLabel8;ia[8]=ResourceStrings.l_ThemeLabel9;ia[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:D,Tvh:ia}}},367:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.uPf="CU";h.$pi="CS";h.Xpi=
"CE";h.Rae="KP";h.fll="TI";h.zWj="L";Object(J.a)(h,"CharacterBlockTrackerKeys",null,[])},368:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(33);class e{constructor(m,n){this.Flight=this.BaseDocQuerySignature=null;this.BaseDocQuerySignature=m;this.Flight=n}serialize(){return h.c([this.Ik(),this])}}Object(J.a)(e,"ACommonHandlerRequest",null,[])},369:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.Cm=null;this.QM=!1;this.T9d=!0;this.rt=this.tS=null;
this.SYb=!1;this.KPc=null;this.Hwe=!0;this.Sy=this.VI=this.Rb=null;this.kPa=!1;this.eUd=e}}Object(J.a)(h,"PasteParams",null,[])},374:function(J,V,d){J=d(0);var h=d(54),e=d(25),m=d(45),n=d(113),v=d(1185),A=d(13),w=d(1158),y;(function(ia){ia[ia.none=0]="none";ia[ia.noSystemClipboardAccess=1]="noSystemClipboardAccess";ia[ia.cutCopyDisallowed=2]="cutCopyDisallowed";ia[ia.pasteDisallowed=3]="pasteDisallowed";ia[ia.invalidPasteContext=4]="invalidPasteContext";ia[ia.invalidCcpOperation=5]="invalidCcpOperation";
ia[ia.multiSlideCcpDisallowed=6]="multiSlideCcpDisallowed";ia[ia.pastedHtmlLengthExceeded=7]="pastedHtmlLengthExceeded";ia[ia.tooManyShapesAfterPaste=8]="tooManyShapesAfterPaste";ia[ia.noShapesPasted=9]="noShapesPasted";ia[ia.invalidImagePasteArgs=10]="invalidImagePasteArgs";ia[ia.invalidClipboardData=11]="invalidClipboardData";ia[ia.invalidCopiedShapes=12]="invalidCopiedShapes";ia[ia.invalidCopiedSlides=13]="invalidCopiedSlides";ia[ia.invalidHtmlContent=14]="invalidHtmlContent";ia[ia.textEditFailed=
15]="textEditFailed";ia[ia.clipServiceDataInvalid=16]="clipServiceDataInvalid";ia[ia.crossDCPasteDisallowed=17]="crossDCPasteDisallowed";ia[ia.imageTooLarge=18]="imageTooLarge";ia[ia.noAvailablePasteHandler=19]="noAvailablePasteHandler";ia[ia.noAvailableCutCopyHandler=20]="noAvailableCutCopyHandler";ia[ia.cutCopyHandlerFailed=21]="cutCopyHandlerFailed";ia[ia.systemClipboardCopyFailed=22]="systemClipboardCopyFailed";ia[ia.copyObjectEmpty=23]="copyObjectEmpty";ia[ia.tableInvalid=24]="tableInvalid";
ia[ia.copyObjectHasDeferredContent=25]="copyObjectHasDeferredContent";ia[ia.userOffline=26]="userOffline";ia[ia.picklingPasteFailedDueToMaxSizeLimit=27]="picklingPasteFailedDueToMaxSizeLimit";ia[ia.picklingInvalidCopyData=28]="picklingInvalidCopyData";ia[ia.systemClipboardAccessFailure=29]="systemClipboardAccessFailure";ia[ia.chunkUploaderFailure=30]="chunkUploaderFailure";ia[ia.pasteCancelledByUser=31]="pasteCancelledByUser";ia[ia.cutCopyIRMRestricted=32]="cutCopyIRMRestricted"})(y||(y={}));Object(J.b)("CcpFailure",
y);var u=d(915),E=d(110),G=d(26),I=d(323),H;(function(ia){ia[ia.none=0]="none";ia[ia.text=1]="text";ia[ia.shape=2]="shape";ia[ia.textbox=3]="textbox";ia[ia.normalShape=4]="normalShape";ia[ia.image=5]="image";ia[ia.table=6]="table";ia[ia.chart=7]="chart";ia[ia.video=8]="video";ia[ia.list=9]="list";ia[ia.ink=10]="ink";ia[ia.addin=11]="addin";ia[ia.smartArt=12]="smartArt";ia[ia.group=13]="group";ia[ia.placeholder=14]="placeholder";ia[ia.line=15]="line";ia[ia.activeX=16]="activeX";ia[ia.oleObject=17]=
"oleObject";ia[ia.media=18]="media";ia[ia.slide=19]="slide";ia[ia.mixed=20]="mixed"})(H||(H={}));Object(J.b)("ClipboardContentType",H);var K;(function(ia){ia[ia.keyboard=0]="keyboard";ia[ia.menu=1]="menu";ia[ia.floatie=2]="floatie";ia[ia.ribbon=3]="ribbon"})(K||(K={}));Object(J.b)("ClipboardMethod",K);var C;(function(ia){ia[ia.copy=0]="copy";ia[ia.cut=1]="cut";ia[ia.paste=2]="paste"})(C||(C={}));Object(J.b)("ClipboardOperation",C);var Y;(function(ia){ia[ia.other=0]="other";ia[ia.pptOnline=1]="pptOnline";
ia[ia.pptOnlineSameSession=2]="pptOnlineSameSession";ia[ia.pptOnlineCrossSession=3]="pptOnlineCrossSession";ia[ia.wordOnline=4]="wordOnline";ia[ia.xlOnline=5]="xlOnline";ia[ia.oneNoteOnline=6]="oneNoteOnline";ia[ia.pptWin32=7]="pptWin32";ia[ia.wordWin32=8]="wordWin32";ia[ia.xlWin32=9]="xlWin32";ia[ia.oneNoteWin32=10]="oneNoteWin32";ia[ia.googleDocs=11]="googleDocs";ia[ia.pptDesktop=12]="pptDesktop";ia[ia.pptDesktopWithDataUpload=13]="pptDesktopWithDataUpload"})(Y||(Y={}));Object(J.b)("ClipboardSource",
Y);class M{constructor(){this.data={};this.XHf=!1;this.zgb=null}}Object(J.a)(M,"TelemetryEntry",null,[]);var P=d(1004),T=d(369),L=d(41),aa=d(28),Q=d(66);d.d(V,"a",function(){return ea});class ea{constructor(ia,ja,D,pa,Z,oa,Ba,Ma,za,ka,qa,Ja){this.YCg=h.a.iy;this.TNg=this.kHg=this.yXc="";this.vQ=ia;this.kW=ja;this.fv=new Q.a;this.m9=new Q.a;pa.Ozc(Object(A.a)(this,this.bwe,"onRevisionProcessedOnServer"));Z.ppa(Object(A.a)(this,this.Cnl,"trackSlideCcpRevision"));oa.ppa(Object(A.a)(this,this.Bnl,"trackShapeCcpRevision"));
Ba.ppa(Object(A.a)(this,this.ynl,"trackParagraphCcpRevision"));Ma.ppa(Object(A.a)(this,this.xnl,"trackNotesCcpRevision"));za&&za.ppa(Object(A.a)(this,this.znl,"trackPresentationCcpRevision"));this.eQ=qa;this.ia=ka;this.WBg=D.Chd;this.Vw=Ja;if(ia=e.AFrameworkApplication.Yc)this.kHg=Object(w.a)(String,ia.Host)||"",this.TNg=Object(w.a)(String,ia.Ring)||"",this.yXc=Object(w.a)(String,ia.WACDatacenter)||""}Hvb(ia){return this.fv.Jb(ia)}aB(ia,ja){m.a.Va(ja)||(this.Hvb(ja)?ea.contentType in this.fv.ga(ja).data&&
!this.XDj(ja,ia)||this.UU(ea.contentType,H[ia],ja):G.a.J(50393377,826,15,"attempted to update clipboard telemetry before tracking started "+ja))}M6a(ia,ja){if(!this.fv.Jb(ia))return null;let D=null;if(this.fv.ga(ia)&&!(ja in this.fv.ga(ia).data))switch(ja){case ea.contentType:D="none";break;case ea.source:D="other"}return D?D:this.fv.ga(ia).data[ja].toString()}Z7f(ia){return this.M6a(ia,ea.contentType)}z7f(ia){return this.M6a(ia,ea.source)}CZi(ia){return this.M6a(ia,ea.operation)}y4b(ia){return"xlOnline"===
this.z7f(ia)&&"chart"===this.Z7f(ia)}LTc(ia){return"slide"===this.Z7f(ia)&&"paste"===this.CZi(ia)}Wsk(ia){const ja=H;for(let pa in ja){var D=ja[pa];if(pa.toLowerCase()===ia.toLowerCase())return D}return 0}Xsk(ia){const ja=Y;for(let pa in ja){var D=ja[pa];if(pa.toLowerCase()===ia.toLowerCase())return D}return 0}XDj(ia,ja){ia=this.Wsk(this.fv.ga(ia).data[ea.contentType].toString());return ja>ia}iw(ia,ja){m.a.Va(ja)||(this.Hvb(ja)?ea.source in this.fv.ga(ja).data&&!this.ENj(ja,ia)||this.UU(ea.source,
Y[ia],ja):G.a.J(50393379,826,15,"attempted to update clipboard telemetry before tracking started "+ja))}ENj(ia,ja){ia=this.Xsk(this.fv.ga(ia).data[ea.source].toString());return ja>ia}Rh(ia,ja,D){m.a.Va(D)||this.UU(ia,ja,D)}oO(ia,ja,D){const pa=L.a.Cb&&!m.a.Va(L.a.Cb.actionName)?L.a.Cb.actionName:D,Z=n.a.create().toString();this.fv.$(Z,Object.assign(new M,{zgb:this.vQ.wi("UserAction","ClipboardTelemetry")}));this.UU(ea.QLf,Z,Z);this.UU(ea.actionName,pa,Z);this.UU("ActualActionName",D,Z);this.UU("CcpOperation",
C[ia],Z);this.UU("CcpMethod",K[ja],Z);this.UU("CcpBrowser",this.YCg,Z);this.UU("CcpHost",this.kHg,Z);this.UU("CcpDatacenter",this.yXc,Z);this.UU("CcpRing",this.TNg,Z);G.a.J(51179864,826,50,"start telemetry tracking. browser: {0}; CcpCorrelation: {1}; method: {2}; operation: {3}; actionName: {4}",this.YCg,Z,K[ja],C[ia],pa);return Z}Cg(ia,ja,D=0){if(m.a.Va(ja))G.a.J(51478666,826,15,"attempted to end telemetry tracking for empty correlation");else if(m.a.Va(ja)||!this.Hvb(ja))G.a.J(51478669,826,15,"attempted to end telemetry tracking for invalid correlation id: {0}",
ja);else{var pa=this.fv.ga(ja);this.UU("CcpTotalMs",pa.zgb.Dq.toString(),ja);this.UU(ea.RLf,ia.toString(),ja);0!==D&&(this.UU("CcpFailureReason",y[D],ja),this.y4b(ja)?16===D?this.eQ.twa(ResourceStrings.l_CopyErrorCalloutTitle,ResourceStrings.l_CopyErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,ea.qob):(ia=Object.assign(new T.a(!0),{Rb:ja}),this.eQ.twa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,
!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,aa.a.NQf,aa.a.cOd,null,ia,!0,ea.qob)):25===D&&(G.a.J(523298057,826,15,"Attempted to paste deferred content/slide on another deck with correlation: {0}",ja),this.eQ.twa(ResourceStrings.l_DeferredContentPasteDialogTitle,ResourceStrings.l_DeferredContentPasteDialogMessage,!1,null,!1,null,0,0,null,null,!1,ea.qob)));G.a.J(50733397,826,50,E.c(pa.data));this.y4b(ja)||this.LTc(ja)||this.fv.remove(ja)}}Q5k(ia,ja){m.a.Va(ja)||(this.iw(0,ja),this.umh(ia,ja,
0))}umh(ia,ja,D){if(ia){if(D>=P.a.BBc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",P.a.BBc));if(1===ia.nodeType){for(var pa=ia.firstChild;pa;)this.umh(pa,ja,D+1),pa=pa.nextSibling;this.hJe(ia,ja)}}}hJe(ia,ja){const {ClipboardHelper:D}=d(696);if(!m.a.Va(ja))if(!this.Hvb(ja))G.a.J(50393415,826,15,"attempted to update clipboard telemetry before tracking started "+ja);else if(ia)if("head"===ia.tagName.toLowerCase()){var pa=this.kW.$0f(ia);m.a.Va(pa)||this.y5k(pa,ja)}else{pa=
0;var Z=ia.getAttribute(I.a.sessionId);Z?pa=D.swg(Z.toString())?2:3:ia.getAttribute(u.a.cUf)?pa=5:ia.getAttribute(u.a.dUf)||ia.getAttribute(u.a.hUf)?pa=1:ia.id&&ia.id.startsWith&&ia.id.startsWith(u.a.ggg)&&(pa=11);if(ia.className&&ia.className.split)for(const oa of ia.className.split(" "))if(oa.startsWith(h.a.WTb)&&oa.length===h.a.WTb.length+1&&(ia=parseInt(m.a.substring(oa,oa.length-1,oa.length)),isNaN(ia)||this.UU("CcpSourceBrowser",v.a[ia],ja)),0===pa)if(oa.startsWith(u.a.p5g))pa=1;else if(oa.startsWith(u.a.m1g))pa=
6;else if(oa.startsWith(u.a.iEh))pa=4;else if(oa===u.a.aUg||oa===u.a.bUg)pa=8,this.aB(9,ja);0!==pa&&this.iw(pa,ja)}}y5k(ia,ja){switch(ia){case "PowerPoint.Slide":this.iw(7,ja);break;case "Word.Document":this.iw(8,ja);break;case "Excel.Sheet":this.iw(9,ja);break;case "OneNote.File":this.iw(10,ja)}}UU(ia,ja,D){this.fv.Jb(D)&&(this.fv.ga(D).data[ia]=ja)}bwe(ia,ja){ja.P9&&!m.a.Va(ja.P9.Id)&&this.m9.Jb(ja.P9.Id)&&this.GZf(ja.P9.Id,!ja.P9.Error,ja.P9.Error?ja.P9.Error.Code:0)}Cnl(ia,ja){this.Dmc(D=>{let pa=
null;if(D=Object(w.a)(123,D.node))pa=D.Rb,D.Rb=null;return pa},ja)}Bnl(ia,ja){this.Dmc(D=>{let pa=null;if(D=Object(w.a)(4,D.node))pa=D.Rb,D.Rb=null;return pa},ja)}ynl(ia,ja){this.Dmc(D=>{let pa=null;if(D=Object(w.a)(5,D.node))pa=D.Rb,D.Rb=null;return pa},ja)}xnl(ia,ja){this.Dmc(D=>{let pa=null;if(D=Object(w.a)(375,D.node))pa=D.Rb,D.Rb=null;return pa},ja)}znl(ia,ja){this.Dmc(D=>{let pa=null;if(D=Object(w.a)(404,D.node))pa=D.Rb,D.Rb=null;return pa},ja)}Dmc(ia,ja){ja.revisionId&&ja.node&&(ia=ia(ja),
m.a.Va(ia)||this.Esh(ja.revisionId.toString(),ia))}Esh(ia,ja){m.a.Va(ia)||m.a.Va(ja)||this.m9.$(ia,ja)}GZf(ia,ja,D){if(!m.a.Va(ia)&&this.m9.Jb(ia)){this.WBg&&"pptDesktopWithDataUpload"===this.z7f(this.m9.ga(ia))&&this.Vw.FZf();var pa={};pa[ea.QLf]=this.m9.ga(ia);pa[ea.RLf]=ja;pa[ea.zni]=D;this.y4b(this.m9.ga(ia))?(pa[ea.source]="xlOnline",pa[ea.contentType]="chart",0!==D&&(ja=Object.assign(new T.a(!0),{Rb:this.m9.ga(ia)}),this.eQ.twa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,
!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,aa.a.NQf,aa.a.cOd,null,ja,!0,ea.qob))):433===D?(this.LTc(this.m9.ga(ia))&&this.ia.processAction(aa.a.JM,2),this.eQ.twa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteLargeDataErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,ea.qob)):434===D&&(this.LTc(this.m9.ga(ia))&&(this.WBg?this.ia.processAction(aa.a.MQd,2):this.ia.processAction(aa.a.JM,2)),this.eQ.twa(ResourceStrings.l_SomethingWentWrongCalloutTitle,
ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,ea.qob));G.a.J(50733400,826,50,E.c(pa));(this.y4b(this.m9.ga(ia))||this.LTc(this.m9.ga(ia)))&&this.fv.remove(this.m9.ga(ia));this.m9.remove(ia)}}PCj(ia){return!m.a.Va(ia)&&this.fv.Jb(ia)?this.fv.ga(ia).XHf:!1}Cbc(ia){m.a.Va(ia)||(this.Hvb(ia)?this.fv.ga(ia).XHf=!0:G.a.J(595206346,826,15,"attempted to update clipboard telemetry before tracking started "+ia))}}ea.source="CcpSource";ea.contentType="CcpContentType";ea.operation=
"CcpOperation";ea.RLf="CcpSuccess";ea.actionName="ActionName";ea.qob=20;ea.QLf="CcpCorrelation";ea.Aui="CcpCopyIframeContent";ea.QNf="ClipServiceThrottled";ea.PLf="data-corr-id";ea.Fp="CcpId";ea.zni="ClipServiceFailureReason";Object(J.a)(ea,"ClipboardTelemetry",null,[303])},425:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.body=this.contextId=this.revId=this.source=this.id=null}}Object(J.a)(h,"Item",null,[])},426:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{}h.open="open";h.refresh="refresh";h.eGe="saveAs";h.translate="translate";h.modeSwitch="modeSwitch";h.xyi="createNew";h.convert="convert";Object(J.a)(h,"ReasonList",null,[])},427:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.func=this.outputSchema=this.inputSchema=this.name=null}}Object(J.a)(h,"Lambda",null,[848])},428:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Nkc="SlideTextTile";h.YJe="ShapeTextTile";Object(J.a)(h,"AugmentationSchemas",
null,[])},429:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d(25);class h{static ub(){}static O_(e,m,n,v,A){return 1===n?32:h.pCk(e,A)?32:8}static rG(e,m,n,v,A){return 1===n?32:h.Lfk(e,A)?32:8}static Lfk(e,m){const n=h.oJh[e.toString()];if(void 0===n||null===n)return!1;n(e,m);return!0}static pCk(e,m){const n=h.qJh[e.toString()];if(void 0===n||null===n)return!1;n(e,m);return!0}}h.oJh={};h.qJh={};Object(J.a)(h,"DialogCuiControlActor",null,[])},430:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{constructor(){this.description=this.title=this.iP=this.K_=null}}Object(J.a)(h,"CpContentDetails",null,[438])},431:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(113);class e{constructor(){this.bEf=!1;this.sessionId=this.TNf=null;this.L3a=e.qWi()}static qWi(){return"CID"+h.a.create().toString()}static Cqg(m){return m&&m.length?m.startsWith("CID")&&h.a.isValid(m.substring(3,m.length))?!0:!1:!1}}Object(J.a)(e,"InternalClipboardObject",null,[])},432:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);d=d(431);class h extends d.a{constructor(e){super();this.Nd=e}get Rug(){return!this.Nd||!this.Nd.isConnected}get id(){return this.Nd.id}get isConnected(){return this.Nd.isConnected}}Object(J.a)(h,"InternalClipboardSlide",d.a,[])},433:function(J,V,d){d.d(V,"a",function(){return e});var h=d(103);const e=(m,n,v)=>{const A=new h.StandardDialog;A.vd=0;A.mO(m,n,v);return A}},447:function(J,V,d){J=d(0);var h=d(375),e=d(13),m=d(25),n=d(176),v=d(72),A=d(65),w=d(168),y=d(100),
u=d(167);d(73);class E{constructor(){this.secondActionButtonProps=this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(J.a)(E,"MessageBarProps",null,[]);class G{constructor(T,L){this.onExecute=this.label=this.type=null;this.label=T;this.type="AppButtonProps";this.onExecute=L}}Object(J.a)(G,"AppButtonProps",null,[]);var I=d(138),H=d(765),
K=d(131),C=d(213),Y=d(113),M=d(35);d.d(V,"a",function(){return P});class P{constructor(T,L,aa){this._message=this.lB=null;this.Pud=this.Qib=!1;this.Dod=0;this.Lfa="";this.qR=0;this.lE=this.bR=this.Gna=this.P5=this.H0a=this.HKb=this.GKb=this.FKb=this.EKb=this.pM=this.y5=this.Woa=this.UKa=null;this.Iib=this.Hib=!1;this.PWe=this.Wod="";this.Uod=!1;this.QWe=this.$od="";this.Yod=!1;this.Zod=this.Vod=null;this.vOb=!1;this.tcf=this.Akb="";this.G0a=null;this.DNb=this.X5e=!1;this.iAa=this.I1=this.Pba=this.JO=
this.businessBar=null;this.errorCode=0;this.fEf=this.visible=!1;this.title=T;this.message=L;this.Y2b=aa;this.id=0;this.image=1;this.x9d=!0;this.pHf=5}get htmlElement(){return this.JO}get x9d(){return this.Pud}set x9d(T){this.Pud=T}get pHf(){return this.Dod}set pHf(T){this.Dod=T}get title(){return this.lB}set title(T){this.lB!==T&&(this.lB=T,this.Woa&&(this.Woa.innerText=this.lB))}get message(){return this._message}set message(T){this._message!==T&&(this._message=T,this.y5&&(this.y5.innerText=this._message))}get image(){return this.qR}set image(T){this.qR=
T;4!==this.qR&&(this.Pba="")}get uCa(){return this.Lfa}set uCa(T){this.Lfa=T}get closeable(){return this.Qib}set closeable(T){this.Qib!==T&&(this.Qib=T,this.Gna&&(this.Gna.style.display=this.Qib?"table-cell":"none"))}get jhc(){return m.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled")}get xyl(){return m.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")}addButton(T,L,aa,Q=!1){this.Wod=T;this.Vod=L;this.Hib=!0;this.PWe=aa;this.Uod=Q}PFd(T,L){this.$od=T;this.Zod=L;this.Iib=!0;this.QWe="";this.Yod=
!1}dBf(T,L){this.Akb=T;this.G0a=L;this.vOb=!0}zzi(){var T=C.a.yBa(m.AFrameworkApplication.fa.Ha("VNextStyleOptOutCookieName"),!1);T=this.xyl&&!T;this.JO=document.createElement("div");this.htmlElement.className=String.format("{0} {1} {2}",P.OWe,P.VSh,T?P.RXh:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.iAa&&null!==this.iAa&&(this.htmlElement.id=this.iAa);T=()=>{I.UISurfaces.Y6i().then(L=>{this.businessBar.i$d||(L.initializeMessageBarInStore(),this.businessBar.i$d=!0);const aa=
Object.assign(new E,{message:this._message,messageTitle:this.lB,isMultiline:this.Pud,messageBarType:this.Dod});if(this.Qib){aa.closeable=!0;var Q=this._message+". "+CommonUIStrings.l_DialogClose;this.lB&&(Q=this.lB+". "+Q);aa.dismissButtonAriaLabel=Q;aa.onDismiss=()=>{this.BMd(this)}}4===this.qR&&(aa.messageBarIconProps={["iconName"]:this.Pba});this.vOb&&(aa.linkProps={["type"]:"AppLinkProps",["text"]:this.Akb,["handler"]:{["href"]:this.tcf,["target"]:"_blank"}},this.G0a&&(Q=Object(e.a)(this,this.Clk,
"onMessageBarLinkClicked"),aa.linkProps.handler=Q));this.Hib&&(aa.firstActionButtonProps=new G(this.Wod,()=>{this.lfi(this)}));this.Iib&&(aa.secondActionButtonProps=new G(this.$od,()=>{this.nfi(this)}));L.createNewMessageBarWithCallback?L.createNewMessageBarWithCallback(this.htmlElement,aa,()=>{m.AFrameworkApplication.Aa.yq()}):L.createNewMessageBar(this.htmlElement,aa);return null}).catch(()=>{h.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");return null})};n.a.get_instance().isCompleted(7)?
T():n.a.get_instance().Xj(7,T);this.Y2b&&(m.AFrameworkApplication.Aa.Xx.ob(A.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),m.AFrameworkApplication.Aa.FF.GT(A.a.ol,this.htmlElement,Object(e.a)(this,this.mue,"onBodyKeyUp"),this),this.X5e&&!this.DNb&&(m.AFrameworkApplication.Aa.g$.ob(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.DNb=!0));return this.htmlElement}createElement(){m.AFrameworkApplication.mN("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");
if(this.jhc)return this.zzi();this.JO=document.createElement("div");this.htmlElement.className=P.OWe;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.iAa&&null!==this.iAa&&(this.htmlElement.id=this.iAa);this.UKa=null;if(0!==this.qR){this.UKa=document.createElement("span");this.UKa.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.UKa);var T=null;let L=null;switch(this.qR){case 2:T=P.WKh;L=CommonUIStrings.l_DialogError;break;case 1:T=P.bYh;L=CommonUIStrings.l_DialogWarning;
break;case 3:T=P.cNh;L=CommonUIStrings.l_DialogInfo;break;case 4:T=this.Pba,L=this.Lfa}this.UKa.title=L;this.UKa.setAttribute(K.a.We,K.a.pGf);this.UKa.appendChild(v.createClusteredImage(24,24,T,P.TMh,!0,""))}T=Y.a.create().toString();this.pM=document.createElement("div");this.pM.id="BBTitleAndBody"+T;this.pM.className=P.gIh;this.pM.tabIndex=0;this.lB&&(this.Woa=document.createElement("p"),this.Woa.innerText=this.lB,this.Woa.className=P.hIh+" UIFontBold",this.Woa.id="BBTitle"+T,this.Woa.setAttribute("UNSELECTABLE",
"on"),this.pM.setAttribute(K.a.y6,this.Woa.id),this.pM.appendChild(this.Woa));this.y5=document.createElement("p");this.y5.className=P.bIh;this.y5.innerText=this._message;this.y5.id="BBBody"+T;this.y5.setAttribute("UNSELECTABLE","on");this.y5.style.width="100%";this.pM.setAttribute(K.a.zpa,this.y5.id);this.Hib&&this.sAf(this.y5,this.PWe);this.Iib&&this.sAf(this.y5,this.QWe);this.pM.appendChild(this.y5);T=document.createElement("div");T.setAttribute(K.a.We,K.a.MAc);T.appendChild(this.pM);this.htmlElement.appendChild(T);
this.Hib&&(this.FKb=document.createElement("span"),this.EKb=document.createElement("button"),this.sRf(this.FKb,this.EKb,this.Wod,Object(e.a)(this,this.hJf,"buttonOneClickHandler")));this.Iib&&(this.HKb=document.createElement("span"),this.GKb=document.createElement("button"),this.sRf(this.HKb,this.GKb,this.$od,Object(e.a)(this,this.iJf,"buttonTwoClickHandler")));this.vOb&&(this.H0a=document.createElement("span"),this.H0a.className=P.fIh,this.P5=document.createElement("a"),this.P5.className=H.a.eIh,
this.P5.innerText=this.Akb,this.G0a?(this.P5.tabIndex=0,m.AFrameworkApplication.Aa.Xx.GT(A.a.click,this.P5,Object(e.a)(this,this.Kzg,"linkClickHandler"),this),m.AFrameworkApplication.Aa.FF.GT(A.a.ol,this.P5,Object(e.a)(this,this.gZg,"onLinkKeyUp"),this)):(this.P5.href=this.tcf,this.P5.target="_blank"),this.H0a.appendChild(this.P5),this.htmlElement.appendChild(this.H0a));m.AFrameworkApplication.Aa.Xx.ob(A.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick"));m.AFrameworkApplication.Aa.FF.GT(A.a.ol,
this.pM,Object(e.a)(this,this.mue,"onBodyKeyUp"),this);this.X5e&&!this.DNb&&(m.AFrameworkApplication.Aa.g$.ob(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.DNb=!0);this.Qib&&(this.Gna=document.createElement("span"),this.Gna.className=P.KIh,this.bR=document.createElement("a"),this.bR.className=P.LIh,this.bR.tabIndex=0,this.bR.title=CommonUIStrings.l_DialogClose,this.bR.setAttribute(K.a.We,K.a.Xt),this.lE=v.createClusteredImage(16,16,P.MIh,"",!0,""),this.bR.appendChild(this.lE),
this.Gna.style.display="table-cell",this.Gna.appendChild(this.bR),this.htmlElement.appendChild(this.Gna),m.AFrameworkApplication.Aa.Xx.GT(A.a.click,this.bR,Object(e.a)(this,this.jXg,"onCloseClick"),this),m.AFrameworkApplication.Aa.FF.GT(A.a.ol,this.bR,Object(e.a)(this,this.kXg,"onCloseKeyUp"),this));return this.htmlElement}kbl(){this.pM&&this.pM.setAttribute(K.a.YJ,K.a.Bpa)}sAf(T,L){if(L&&""!==L){var aa=document.createElement("span");aa.className=P.ZTh;aa.innerText=L;T.appendChild(aa)}}sRf(T,L,aa,
Q){T.className=P.dIh;L.setAttribute("type","button");L.className=P.cIh;L.innerText=aa;T.appendChild(L);this.htmlElement.appendChild(T);m.AFrameworkApplication.Aa.Xx.GT(A.a.click,L,Q,this)}Hfh(){this.jhc||(this.pM.style.whiteSpace="nowrap",this.closeable?this.Gna.style.width="auto":this.vOb?this.H0a.style.width="auto":this.Iib?this.HKb.style.width="auto":this.Hib?this.FKb.style.width="auto":this.pM.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this.pM.style.whiteSpace=
"normal":this.closeable?this.Gna.style.width="100%":this.vOb?this.H0a.style.width="100%":this.Iib?this.HKb.style.width="100%":this.Hib?this.FKb.style.width="100%":this.pM.style.width="100%")}RRe(T,L){if(u.a.RBb()){var aa={};aa.WacSessionId=m.AFrameworkApplication.userSessionId;aa.ActionName="BusinessBar"+T;aa.InputMethod=L;h.ULS.sendTraceTag(35489761,207,50,JSON.stringify(aa))}}aW(T,L,aa,Q){this.RRe(T,aa);u.a.pSa()&&y.c(L,!0,y.e,Q,10)}hJf(T){this.Vod(T.yC);this.aW("ButtonOne",M.a.bJf,"Mouse",2);this.Uod&&
(this.aW("Close",M.a.aob,"Mouse_ButtonOne",2),this.close(T));return!0}lfi(T){this.Vod(T);this.aW("ButtonOne",M.a.bJf,"Mouse",2);this.Uod&&(this.aW("Close",M.a.aob,"Mouse_ButtonOne",2),this.BMd(T))}iJf(T){this.Zod(T.yC);this.aW("ButtonTwo",M.a.cJf,"Mouse",2);this.Yod&&(this.aW("Close",M.a.aob,"Mouse_ButtonTwo",2),this.close(T));return!0}nfi(T){this.Zod(T);this.aW("ButtonTwo",M.a.cJf,"Mouse",2);this.Yod&&(this.aW("Close",M.a.aob,"Mouse_ButtonTwo",2),this.BMd(T))}Kzg(T){this.G0a(T.yC);this.aW("Link",
M.a.fJf,"Mouse",2);return!0}Clk(){this.G0a(null)}gZg(T){return T.lc.keyCode!==w.a.aq||T.lc.altKey?!1:(this.G0a(T.yC),this.aW("Link",M.a.fJf,"Keyboard",1),!0)}mue(T){return T.lc.keyCode===w.a.aq&&!T.lc.altKey&&this.Y2b?(this.Y2b(T.yC,T),this.aW("Invoke",M.a.eJf,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(m.AFrameworkApplication.Aa.Xx.xb(A.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),this.DNb&&m.AFrameworkApplication.Aa.g$.xb(this.htmlElement,Object(e.a)(this,this.onClick,
"onClick")));this.bR&&(m.AFrameworkApplication.Aa.Xx.xb(A.a.click,this.bR,Object(e.a)(this,this.jXg,"onCloseClick")),m.AFrameworkApplication.Aa.FF.xb(A.a.ol,this.bR,Object(e.a)(this,this.kXg,"onCloseKeyUp")));this.EKb&&m.AFrameworkApplication.Aa.Xx.xb(A.a.click,this.EKb,Object(e.a)(this,this.hJf,"buttonOneClickHandler"));this.GKb&&m.AFrameworkApplication.Aa.Xx.xb(A.a.click,this.GKb,Object(e.a)(this,this.iJf,"buttonTwoClickHandler"));this.P5&&this.G0a&&(m.AFrameworkApplication.Aa.Xx.xb(A.a.click,this.P5,
Object(e.a)(this,this.Kzg,"linkClickHandler")),m.AFrameworkApplication.Aa.FF.xb(A.a.ol,this.P5,Object(e.a)(this,this.gZg,"onLinkKeyUp")));this.pM&&m.AFrameworkApplication.Aa.FF.xb(A.a.ol,this.pM,Object(e.a)(this,this.mue,"onBodyKeyUp"));this.businessBar=this.bR=this.Gna=this.lE=this.H0a=this.P5=this.HKb=this.GKb=this.FKb=this.EKb=this.pM=this.y5=this.JO=this.Woa=this.UKa=this.Lfa=null}onClick(T){this.aW("Invoke",M.a.eJf,"Mouse",2);return!!this.Y2b&&this.Y2b(this,T)}jXg(T){this.aW("Close",M.a.aob,
"Mouse",2);this.close(T);return!0}kXg(T){return T.lc.keyCode!==w.a.aq||T.lc.altKey?!1:(this.aW("Close",M.a.aob,"Keyboard",1),this.close(T),!0)}close(T){const L=T.yC;this.businessBar.removeEntry(L);this.qqg(L,T.Vf)}qqg(T,L){if(T.I1){const aa=m.AFrameworkApplication.Ta;aa.gq=10;aa.vS=L;T.I1(T);aa.gq=0;aa.vS=0}}BMd(T){T&&this.businessBar&&(this.businessBar.removeEntry(T),this.qqg(T,0))}}P.OWe="WACBusinessBarEntry";P.hIh="WACBusinessBarTitle";P.bIh="WACBusinessBarBody";P.gIh="WACBusinessBarTitleBodyHolder";
P.dIh="WACBusinessBarButtonHolder";P.cIh="WACBusinessBarButton";P.fIh="WACBusinessBarLinkHolder";P.LIh="WACBusinessBarClose";P.KIh="WACBusinessBarCloseHolder";P.MIh="BusinessBarClose_16x16x32";P.TMh="WACBusinessBarImage";P.ZTh="WACScreenReaderOnly";P.WKh="CancelRequest_24x24x32";P.bYh="Risks_24x24x32";P.cNh="Info_24x24x32";P.VSh="ReactBusinessBarEntry";P.RXh="VNextBusinessBarEntry";Object(J.a)(P,"BusinessBarEntry",null,[546,106])},453:function(J,V,d){J=d(0);var h=d(45),e=d(196),m=d(1166),n=d(1158),
v=d(59);class A{constructor(){this.shapeType=this.zre=this.uSg=this.SVg=this.RVg=0;this.Pq=this.Np=this.Lp=this.qk=!1;this.ZAc=null}}Object(J.a)(A,"ShapeProperties",null,[]);var w=d(26),y=d(41),u=d(106),E=d(208);d.d(V,"a",function(){return G});class G{constructor(I,H,K,C,Y,M,P,T,L){this.gv=I;this.xm=H;this.Ea=P;this.f8j=M.M$k;this.O6j=this.xzi();this.Vp=K;this.VK=C;this.Le=Y.Ma;this.BW=M.qsa;this.P3j=M.hxa;this.Sb=L}A3g(I,H,K,C,Y,M=null){if(H){var P=this.Ea.h6a(K);P&&(Array.remove(K,P),Array.add(K,
this.Ea.er(P)));this.Prh(K);var T=K.length;P=Array(T);C=this.Sag(H,C);for(var L=0;L<T;L++){var aa=K[L],Q=this.Z7i(aa,C);P[L]=Object.assign(new A,{RVg:Q.x,SVg:Q.y,uSg:aa.Ex,zre:aa.sD,shapeType:aa.shapeType,qk:aa.qk,Lp:aa.Lp||2===aa.mediaType||1===aa.mediaType,Np:aa.nd,Pq:aa.Pq,ZAc:""});P[L].qk&&(Q=Object(n.a)(124,aa.oc(this.Le)),P[L].ZAc=Q?Q.MMe:"",w.a.J(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",aa.A3d,this.VK.KV(aa),0<P[L].ZAc.length))}L=H.Bb;aa=H.Qu();Q=[];C=!0;var ea=I.uj===
H.uj,ia=I.Xn===H.Xn,ja=!1;I!==H&&(ea?(ja=I.r7a||H.r7a,ia||(ja=I.j7a||H.j7a||ja),C=!ja):C=!1,C&&this.BW&&(I.Yp!==H.Yp||I.Ek!==H.Ek)&&(C=!1));for(var D=0;D<T;D++)this.L$k(K[D])||(Q.push(K[D]),C&&(C=this.Q8k(K[D],ia)));K=Q;w.a.J(512500631,826,50,"{0}",{["LocalRenderEnabled"]:C,["SameSlide"]:I===H,["SameMaster"]:ea,["SameLayout"]:ia,["ThemeOverrides"]:ja});T=[];D=ja=ia=ea=Q=!1;for(let pa=0;pa<K.length;pa++){const Z=P[pa];let oa=this.xm.Jwi(L.cid,L.sid,Z.RVg,Z.SVg,Z.uSg,1>Z.zre?1:Z.zre,aa+K[pa].get_zIndex(),
I.id,K[pa],Z.shapeType,Z.qk,Z.ZAc,C);h.a.Va(M)||(oa.Rb=M);T.push(oa);Q=Q||Z.qk;ea=ea||Z.Lp;ia=ia||Z.Np;ja=ja||Z.Pq;D=D||this.P3j&&G.FKj(oa)}Y=G.ofh(Q,ea,ia,ja,D,Y);if(0<T.length&&(I=C?K:null,this.gv.Z1(T,H,Y,I),C&&y.a.Cb)){if(I){H="";for(const pa of I)H+=this.Ea.$_b(pa)+",";y.a.Cb.Wa(u.a.vui,H);y.a.Cb.Wa(u.a.w7k,I.length.toString())}y.a.Cb.Ij=!0;y.a.Cb.TGb=!0}}}NBi(I,H,K,C,Y,M){var P=this.Sag(I,K);K=[];const T=H.Dcc,L=!!T&&!e.a.Va(T.Hwg);M=this.Y7i(M,P);for(P=0;P<H.objectCount;P++){const aa=this.xm.Uvi(I.cid,
I.sid,M.x,M.y,Y);aa.isEditable=L&&T.Hwg[P];K.push(aa)}0<K.length&&this.gv.Z1(K,I,C)}Y7i(I,H){const K=H*G.D6;H*=G.D6;let C=new v.a(K,H);I&&(C=this.Sb.tra(I.clientWidth,I.clientHeight))&&(C.x+=K,C.y+=H);return C}L$k(I){return I.PB&&this.f8j||!I.Vrg}Q8k(I,H){return I.A3d||this.VK.KV(I)||I.al&&I.hasText&&!H&&10!==I.zj&&12!==I.zj||I.Nq?!1:!0}Prh(I){I.sort((H,K)=>H.get_zIndex()-K.get_zIndex())}sLj(I){return I?this.O6j.contains(I):!1}Sag(I,H){if(!I)return 0;if(!H)return G.Yfi;let K,C;return H.$(K=I.Bb,(C=
H.ga(K))+1),C}Z7i(I,H){var K=this.Vp.presentation;if(!K)throw Error.argumentNull("Presentation is null");let C=I.My,Y=I.Ny;I=K.Zcj(K.KB(I.slideId));K=Math.round(G.D6/I)*I;I=m.a.Ef(K,0);for(K=m.a.Ef(K,1);0<H;)C+=I,Y+=K,H--;return new v.a(C,Y)}Lpl(I){try{if(I&&I.clipboardData){const H=I.clipboardData.types;for(let K=0;K<H.length;K++){const C=I.clipboardData.getData(H[K]);if(this.cDj(C))return C}}}catch(H){}return null}cDj(I){return!!I&&0<I.length&&this.uPj(I)}uPj(I){I=I.trim().toLowerCase();return I.startsWith("http:")||
I.startsWith("https:")}z2k(I,H,K){I&&(I.setAttribute(G.IJf,H.toString()),I.setAttribute(G.HJf,K.toString()),I.setAttribute(G.JJf,"true"))}xzi(){const I=new E.a;I.add("param");I.add("map");I.add("area");I.add("script");I.add("noscript");I.add("col");I.add("colgroup");I.add("caption");I.add("head");I.add("title");I.add("link");I.add("meta");I.add("style");I.add("base");I.add("input");I.add("textarea");I.add("select");I.add("option");I.add("optgroup");I.add("button");I.add("hr");return I}F4i(I){return this.Ayh(I,
G.IJf)}x4i(I){return this.Ayh(I,G.HJf)}iHj(I){return I?"true"===I.getAttribute(G.JJf):!1}vpl(I){if(this.axg(I)){const H=I.indexOf('"')+1,K=I.lastIndexOf('"');if(1<H&&K>H&&(I=I.slice(H,K),I.startsWith(G.dgi)))return I}return null}axg(I){return!!I&&I.length>G.Cgi&&I.startsWith(G.egi)}Ayh(I,H){let K=0;this.iHj(I)&&(K=parseFloat(I.getAttribute(H)));return isNaN(K)?0:K}GKd(I){return this.HKd(I).returnValue}HKd(I){let H;H=2;let K=0,C=0,Y=0,M=0,P=0,T=0,L=0,aa=0,Q=0,ea=0,ia=0,ja=0,D=0,pa=0,Z=0,oa=0,Ba=0;
for(const Ma of I)Ma.nd?(H=2===H?6:20,K++):Ma.Qf?(H=2===H?12:20,C++):Ma.Pq?(H=2===H?7:20,Y++):Ma.Mf?(H=2===H?13:20,M++):22===Ma.e1b?(H=2===H?10:20,P++):Ma.qk?(H=2===H?5:20,T++):Ma.wy?(H=2===H?3:20,L++):Ma.T2?(H=2===H?14:20,Ma.PB&&Q++,aa++):Ma.al?(H=2===H?14:20,Ma.PB&&ia++,ea++):Ma.uy?(H=2===H?15:20,ja++):Ma.HV?(H=2===H?16:20,D++):Ma.Lp?(H=2===H?18:20,pa++):Ma.Nq?(H=2===H?11:20,Z++):Ma.dca?(H=2===H?17:20,oa++):(H=2===H?4:20,Ba++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",
I.length,K,C,Y,M,P,T,L,aa,Q,ea,ia,ja,D,pa,Z,oa,Ba),contentType:H}}static dZk(I){for(const H of I)if(!H.Vrg||H.isLocal)return!1;return!0}static FKj(I){return I&&4===I.LR?(!I.fill||!!I.fill.noFillField)&&(!I.lineStyle||!!I.lineStyle.noFillField):!1}static ofh(I,H,K,C,Y,M){return I||H||K||C||Y?M:0}}G.JJf="data-from-ppt-online";G.IJf="data-image-width-mu";G.HJf="data-image-height-mu";G.dgi="data:image/";G.egi="<img src=";G.Cgi=14;G.Yfi=1;G.D6=15;Object(J.a)(G,"CopyPasteUtility",null,[285])},454:function(J,
V,d){J=d(0);var h=d(510),e=d(127);class m extends h.a{constructor(){super();this.nextId=this.prevId=null;this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.kl()})}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static kl(){return["AugLoop_Core_Operation"]}}Object(J.a)(m,"OperationWithSiblingContext",h.a,[]);d.d(V,"a",function(){return n});class n extends m{constructor(){super();this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.kl()})}static getTypeName(){return"AugLoop_Core_AddOperation"}static kl(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}}Object(J.a)(n,"AddOperation",m,[])},508:function(J,V,d){d.d(V,"a",function(){return n});J=d(0);var h=d(62),e=d(509),m=d(888);class n{uVb(v,A){if(1===v.nodeType&&A){var w=this.tV(A);v=this.e3f(v,w);this.Soi(w,v,A)}}e3f(v,A){const {CombineHelper:w}=d(1109),y=[];let u=null;for(let G=0;G<v.childNodes.length;G++){var E=v.childNodes[G];3===E.nodeType?(u||(u=new w(v,G,A)),u.G1h(G)):(u&&(u.end(y,G-1),u=null),E=this.e3f(E,A),Array.addRange(y,E))}u&&u.end(y,v.childNodes.length-1);
return y}Soi(v,A,w){v=v.clone();let y=!1;for(let u=A.length-1;0<=u;u--){const E=A[u].Roi();y=v.merge(E)||y}y&&this.setSelection(v,w)}setSelection(v,A){A=h.a.GBa(A);A.setStart(v.start.element,v.start.offset);A.setEnd(v.end.element,v.end.offset)}tV(v){return(v=h.a.GBa(v))?Object.assign(new m.a,{start:Object.assign(new e.a,{element:v.startContainer,offset:v.startOffset}),end:Object.assign(new e.a,{element:v.endContainer,offset:v.endOffset})}):new m.a}}n.unused=-1;Object(J.a)(n,"TextNodeCombiner",null,
[1410])},509:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.element=null;this.offset=0}clone(){return Object.assign(new h,{element:this.element,offset:this.offset})}merge(e){if(!e.element||this.element===e.element&&this.offset===e.offset)return!1;this.element=e.element;this.offset=e.offset;return!0}}Object(J.a)(h,"SelectionSide",null,[])},510:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(254);var h=d(127);class e extends V.a{constructor(){super();this.items=
this.parentRevId=this.parentPath=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.kl()})}static getTypeName(){return"AugLoop_Core_Operation"}static kl(){return[]}}Object(J.a)(e,"Operation",V.a,[])},511:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.none=0]="none";e[e.oneNote=1]="oneNote";e[e.word=2]="word";e[e.wordViewer=3]="wordViewer";e[e.powerPoint=4]="powerPoint"})(h||(h={}));Object(J.b)("AppMode",h)},512:function(J,V,d){d.d(V,"a",function(){return e});
d.d(V,"b",function(){return m});d.d(V,"c",function(){return n});const h=v=>{switch(v){case 1:return 5;case 2:return 4;case 3:return 3;case 5:return 2;case 4:return 1;default:return 0}},e=v=>h(n(v.Priority,v.Tag)),m=v=>n(v.Priority,v.Tag),n=(v,A)=>{switch(v){case 0:return 1;case 1:return 2;case 2:return A&1?5:3;case 3:return 4;default:return 0}}},513:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.C=this.T=this.E=0;this.F=null;this.I=this.A=0;this.G=null}}Object(J.a)(h,
"ProofingTraceMetrics",null,[])},514:function(J,V,d){d.d(V,"a",function(){return m});d.d(V,"b",function(){return n});d.d(V,"c",function(){return v});var h=d(25),e=d(515);const m=()=>{const A=h.AFrameworkApplication.Aa.gb.Am;return(3===A||1===A||2===A||4===A)&&h.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled")},n=(A,w,y,u=!1)=>{w=1===w;1===A&&(w=2===h.AFrameworkApplication.Aa.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",e.a[A],w?"Editor":"Viewer",u?"Dime":"Unknown",y?y:"dimedefault")},
v=A=>{switch(A){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},515:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.excel=1]="excel";e[e.powerPoint=2]="powerPoint";e[e.word=3]="word";e[e.oneNote=4]="oneNote";e[e.visio=5]="visio"})(h||(h={}));Object(J.b)("OfficeAppType",h)},516:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);
class h{}h.UGf="AugEditorServiceTileCheckRequest";h.VGf="AugEditorServiceTileCheckResponse";h.BJi="EditorServiceTileCheckRequest";h.hOf="Proofing.ProofingRequest";h.DMd="Proofing.ProofingResponse";Object(J.a)(h,"ProofingAugmentationSchemaNames",null,[])},517:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.slideId=null;this.h6g=this.Mkc=0}}Object(J.a)(h,"SlidePresenceInfo",null,[])},518:function(J,V,d){d.d(V,"a",function(){return n});J=d(0);var h=d(375),e=d(1021),
m=d(33);class n{execute(v,A,w=null){h.ULS.sendTraceTag(572846934,380,50,"reqType:{0}",v.Ik());const y=new e.a,u=this.X6(v,A,w);u.continueWith(()=>{if(u.Wl)y.GF(u.Ui);else if(u.Dn)y.t0();else{const E=u.result;if(E&&!E.succeeded&&E.Ri&&E.Ri.data&&5===u.result.Ri.data.status){const G=this.X6(v,A,w);G.continueWith(()=>{G.Wl?y.GF(G.Ui):G.Dn?y.t0():y.TL(G.result)})}else y.TL(E)}});return y.task}X6(v,A,w){w=this.Qbj(w);return A(w,{"Content-Type":"application/json; charset=utf-8"},v.serialize())}Qbj(v){return v?
String.format("{0}/{1}",v,"people.ashx"):"people.ashx"}static z4a(v){if(!v)return h.ULS.sendTraceTag(572846935,380,10,"ResponseBodyTask from PeopleHandler is null"),null;try{return m.a(v)}catch(A){h.ULS.sendTraceTag(572846936,380,10,"Could not parse the response. Message: {0}",A.message)}return null}}Object(J.a)(n,"CommonHandlerRequestManager",null,[])},519:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(375);class e{equals(m,n){if(!m||!n)return!m&&!n;if(m.UserId!==n.UserId){if(!e.GXf(m.Provider)||
!e.GXf(n.Provider))return!1;const A=m.UserId.startsWith(e.tSb);var v=n.UserId.startsWith(e.tSb);if(A&&v){if(m.Provider!==n.Provider)return h.ULS.sendTraceTag(593368202,327,10,"Provider mismatch when both IDs are in AD format. Providers: {0} , {1}",m.Provider,n.Provider),!1;v=e.X0f(m.UserId);n=e.X0f(n.UserId);return!!v&&v===n}m=m.Email&&""!==m.Email?m.Email:A?e.j5a(m.UserId):m.UserId;n=n.Email&&""!==n.Email?n.Email:v?e.j5a(n.UserId):n.UserId;return!!m&&m===n}return m.Provider!==n.Provider?!1:m.Provider&&
""!==m.Provider||m.UserId&&""!==m.UserId?!0:m.DisplayName===n.DisplayName}r2(){return 0}static GXf(m){return"O365"===m||"AD"===m}static j5a(m){if(!m.startsWith(e.tSb))return null;m=m.substr(e.tSb.length);const n=m.lastIndexOf("::");return-1===n?null:m.substr(0,n)}static X0f(m){if(!m.startsWith(e.tSb))return null;var n=m.lastIndexOf("::");if(-1===n)return null;n+=2;return n>=m.length?null:m.substr(n)}}e.tSb="S::";Object(J.a)(e,"CommentTaskPersonIdentityComparer",null,[140])},520:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h{constructor(e){this.MessageId=e;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(J.a)(h,"CrossDocumentMessage",null,[])},521:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(J.a)(h,"OtelTelemetryEvent",null,[])},522:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.previewControlIds=this.legacyControlId=this.populationProps=this.menuItemId=
this.commandRevertId=this.commandPreviewId=this.queryCommandId=this.commandId=this.externalUxCommand=null;this.externalUxCommand=e;this.commandId=m}}Object(J.a)(h,"CommandMetadata",null,[])},523:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(296);class h{}h.CommandValueId="CommandValueId";h.Description="Description";h.Image16by16Class=d.a.wtb;h.Image30by30Class=d.a.Wtj;h.Image32by32Class=d.a.tCa;h.Image48by48Class=d.a.J4d;h.On="On";h.LabelText=d.a.labelText;h.Visible=d.a.visible;h.SourceControlId=
"SourceControlId";h.DisplayMode="DisplayMode";h.Alt=d.a.alt;Object(J.a)(h,"ToggleButtonCommandProperties",null,[])},524:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Uu="InputMethod";h.xea="ShouldCanvasTakeFocus";h.szh="UILocation";Object(J.a)(h,"ReactRibbonConstants",null,[])},525:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{static get instance(){const {NewCustomEventFactory:e}=d(1082),{IECustomEventFactory:m}=d(1083);h.Ja||(h.Ja="function"===typeof window.CustomEvent?
new e:new m);return h.Ja}}h.Ja=null;Object(J.a)(h,"CustomEventFactory",null,[])},526:function(J,V,d){d.d(V,"a",function(){return e});d.d(V,"b",function(){return n});var h=d(8);d(1021);const e=A=>m(A),m=A=>new Promise((w,y)=>{A.continueWith(u=>{u.Wl?y(u.Ui.message):u.Dn?y(h.a.FEc()):w(null)})}),n=A=>v(A),v=A=>new Promise((w,y)=>{A.continueWith(()=>{A.Wl?y(A.Ui.message):A.Dn?y(h.a.FEc()):w(A.result)})})},527:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Tgb=this.Oba=
this.TX=null;this.ZSc=this.okc=!1;this.Cxe=0;this.Rb=null;this.reset()}reset(){this.Oba=[];this.TX=null;this.Tgb=[];this.ZSc=this.okc=!1;this.Cxe=0;this.Rb=null}}Object(J.a)(h,"HtmlPasteContext",null,[])},528:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.themeColors="Theme Colors";Object(J.a)(h,"ReactColorConstants",null,[])},539:function(J,V,d){J=d(0);var h=d(375),e=d(343),m=d(55),n=d(65),v=d(168),A=d(89),w=d(25);d(13);var y=d(33),u=d(48),E=d(98);class G{constructor(){this.ydb=
this.t4=null;this.Jwh=0}}Object(J.a)(G,"CandidateManager",null,[]);var I=d(644),H=d(642),K=d(643);class C{constructor(){this.keyCode=0;this.TAl=this.SAl=null}}Object(J.a)(C,"PredictionKeptState",null,[]);class Y{constructor(){this.values={}}ulg(Ga,na,sa){Ga=this.Rdg(Ga);Ga[na]=na in Ga?Ga[na]+sa:sa}add(Ga,na,sa){this.Rdg(Ga)[na]=sa}ga(Ga){return this.values[Ga]}$(Ga,na){return this.values[Ga]=na}OPf(Ga){return Ga in this.values?!0:!1}Rdg(Ga){let na;Ga in this.values?na=this.values[Ga]:(na={},this.values[Ga]=
na);return na}}Object(J.a)(Y,"PredictionState",null,[]);class M{constructor(){this.WordPredIsEnabled=!0;this.PredictionSeenCount=0;this.PredictionAccepted=!1}}Object(J.a)(M,"TypeAheadRoamingSettings",null,[]);var P=d(196),T=d(1158),L=d(17),aa=d(892),Q=d(645);d(894);var ea=d(893);class ia{constructor(Ga){this.Toc=null;this.FC=Ga;Ga=m.a.instance.resolve("Common.IDynamicScriptLoaderProvider").yv;const na=m.a.instance.resolve("Common.ISharedDependencyLoader");this.initialize(Ga,na)}initialize(Ga,na){const sa=
new Q.a;return Ga?na?this.Toc?this.Toc:w.AFrameworkApplication.Aa.gb.Qsg?this.Toc=new Promise((Ha,cb)=>{const Za=w.AFrameworkApplication.Fk("al",2);na.hwb(Za).continueWith(va=>{va.Wl?(this.lZg(),cb(va.Ui.message)):(this.Wlg(sa),Ha({}))})}):this.Toc=Ga.loadScript("al").then(()=>{this.Wlg(sa)}).catch(Ha=>{this.lZg();return Promise.reject(Ha)}):Promise.reject("SharedDependencyLoader is null"):Promise.reject("DynamicScriptLoader is null")}Wlg(Ga){ia.WR.wF(()=>{h.ULS.sendTraceTag(595091613,3010,50,"AugLoop TextPrediction Load success");
const na=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();let sa=w.AFrameworkApplication.fa.Ha("OfficeApplicationName")||"";sa=sa.replace("Web","");Ga.appName=Ga.appName||sa;Ga.serviceUrl=Ga.serviceUrl||w.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl");Ga.appVersion=Ga.appVersion||w.AFrameworkApplication.fa.Ha("BuildVersion")||"";Ga.releaseAudienceGroup=Ga.releaseAudienceGroup||(w.AFrameworkApplication.Yc?Object(T.a)(String,w.AFrameworkApplication.Yc.AudienceGroup)||"":"");Ga.sessionId=
Ga.sessionId||w.AFrameworkApplication.fa.Ha("SessionId")||"";Ga.uiLanguage=Ga.uiLanguage||w.AFrameworkApplication.uiCulture;Ga.flights=this.$Xi();Ga.initSession=Ga.initSession||!0;na.initialize(Ga);na.activateAnnotation(Object.assign(new aa.a,{annotationType:ea.a.getTypeName(),handler:this.FC}))},"WordPredictionAL:Initialize")}lZg(){h.ULS.sendTraceTag(595091612,3010,50,"AugLoop TextPrediction Load Fail")}$Xi(){var Ga=w.AFrameworkApplication.fa.Ha("FlightId"),na=w.AFrameworkApplication.fa.HB("AugLoopFlightKeywordList");
Ga=this.CQi(Ga,na);na="";0<Ga.length&&(na=P.a.join(Ga,";"),h.ULS.sendTraceTag.apply(null,[595091610,3010,50,"FlightCount: [{0}], flightIds: [{1}]",Ga.length].concat(Ga)));return na}CQi(Ga,na){const sa=new L.a;if(Ga&&""!==Ga&&na&&0<na.length){for(let Ha=0;Ha<na.length;Ha++)na[Ha]=na[Ha].toLowerCase();Ga=Ga.toLowerCase().split(";");for(const Ha of Ga)P.a.any(na,cb=>-1<Ha.indexOf(cb))&&sa.add(Ha)}return sa.toArray()}static get WR(){return e.a.instance}}Object(J.a)(ia,"WordPredictionAugLoopHandler",null,
[1116]);var ja=d(141),D=d(178),pa=d(139);class Z{constructor(Ga,na,sa,Ha){this.$Wb=null;this.vSg=Ga;this.J_k=sa;this.aji=Ha;this.w_k=na;this.JFc=Array(Ga);this.sfh();this.Dfh()}bvj(Ga,na,sa){Ga>this.vSg-1||this.tlg(this.JFc[Ga],na,sa)}E7a(Ga,na){this.tlg(this.$Wb,Ga,na)}rFd(Ga,na){this.$Wb[Ga]=na}flush(){Z.WR.wF(()=>{for(let Ga=0;Ga<this.JFc.length;Ga++){const na=this.VWi(Ga);na&&(na.dataFields.push(Object.assign(new pa.a,{name:H.a.yO,int64:Ga})),ja.a.sendActivityEvent(na))}this.sfh()},"WPT:F")}rTi(){Z.WR.wF(()=>
{const Ga=this.UWi();Ga&&ja.a.sendActivityEvent(Ga);this.Dfh()},"WPT:FSD")}mTi(Ga){Z.WR.wF(()=>{const na=this.TWi(Ga);na&&ja.a.sendActivityEvent(na)},"WPT:FCD")}UWi(){const Ga=this.g_d(this.J_k);for(var na=0;na<K.a.EPa.length;na++)this.sFd(K.a.EPa[na],this.$Wb,Ga.dataFields);for(na=0;na<K.a.TZb.length;na++)this.ISb(K.a.TZb[na],this.$Wb,Ga.dataFields);return Ga.dataFields.length?Ga:null}VWi(Ga){const na=this.g_d(this.w_k);for(let sa=0;sa<H.a.EPa.length;sa++)this.sFd(H.a.EPa[sa],this.JFc[Ga],na.dataFields);
return na.dataFields.length?na:null}TWi(Ga){const na=this.g_d(this.aji);for(var sa=0;sa<I.a.EPa.length;sa++)this.sFd(I.a.EPa[sa],Ga,na.dataFields);for(sa=0;sa<I.a.TZb.length;sa++)this.ISb(I.a.TZb[sa],Ga,na.dataFields);return na.dataFields.length?na:null}tlg(Ga,na,sa){Ga[na]=na in Ga?Ga[na]+sa:sa}g_d(Ga){const na=new D.a;na.name=Ga;na.dataFields=[];return na}sFd(Ga,na,sa){Ga in na&&Array.add(sa,Object.assign(new pa.a,{name:Ga,int64:na[Ga]}))}ISb(Ga,na,sa){Ga in na&&Array.add(sa,Object.assign(new pa.a,
{name:Ga,string:na[Ga]}))}sfh(){for(let Ga=0;Ga<this.vSg;Ga++)this.JFc[Ga]={}}Dfh(){this.$Wb={}}static get WR(){return e.a.instance}}Object(J.a)(Z,"WordPredictionTelemetryHandler",null,[1115]);var oa=d(61),Ba=d(31),Ma=d(373),za=d(298),ka=d(92);d(226);var qa=d(49),Ja=d(32);d(454);d(425);d(1008);d.d(V,"a",function(){return xa});class xa{static get WR(){return e.a.instance}static get aD(){xa.opc||(xa.opc=new G);return xa.opc}static set aD(Ga){xa.opc=Ga}static get gTc(){return xa.qzf}static set gTc(Ga){xa.qzf=
Ga}static get jEh(){xa.DEd||(xa.DEd=xa.qzi());return xa.DEd}static get settings(){xa.Kwc||(xa.Kwc=Object.assign(new M,{WordPredIsEnabled:!0,PredictionSeenCount:0,PredictionAccepted:!1}));return xa.Kwc}static set settings(Ga){xa.Kwc=Ga}static get zWa(){xa.qzd||(xa.qzd=new Y);return xa.qzd}static get Gkl(){return xa.IDi}static get b5(){xa.FEd||(xa.FEd=new Z(xa.Gkl,"Office.Word.Online.WordPredictionTelemetryData","Office.Word.Online.WordPredictionTelemetryDataPerSession","Office.Word.Online.WordPredictionTelemetryDataPerCandidate"));
return xa.FEd}static get vCi(){return xa.x2a?xa.x2a.instance?xa.x2a.instance.S1:1:(xa.x2a=m.a.instance.La("Common.IZoomManager"),xa.x2a&&xa.x2a.instance?xa.x2a.instance.S1:1)}static get characterPropertiesEditor(){xa.upd||(xa.upd=m.a.instance.resolve("Box4.ICharacterPropertiesEditor"));return xa.upd}static get X$c(){xa.Czd||m.a.instance.La("Box4.Proofing.IProofingSentenceSeparator").execute(Ga=>{Ga&&(xa.Czd=Ga)});return xa.Czd}static get UAl(){xa.EEd||(xa.EEd=m.a.instance.resolve("Box4.WordPrediction.IWordPredictionSettingsInfo"));
return xa.EEd}static GXk(){window.setTimeout(()=>{const Ga={};Ga.WordPredIsEnabled=xa.settings.WordPredIsEnabled;Ga.PredictionSeenCount=xa.settings.PredictionSeenCount;Ga.PredictionAccepted=xa.settings.PredictionAccepted;xa.UAl.NDl(y.c(Ga))},xa.uUf)}static M2d(Ga,na){if(!Ga||!na||Ga.eventName!==n.a.jNa)return!1;const sa=Ga.lc.keyCode;if(xa.urg(na)){xa.UKk();na=na.node;if((sa===v.a.wO||sa===v.a.Bq)&&xa.XRa)return A.a.an(Ga.lc),xa.Ezj(na),xa.Evl(sa),h.ULS.sendTraceTag(578307398,820,50,"Prediction Text Accepted"),
!0;if(sa===v.a.xO)xa.gTc&&(xa.gTc=!1);else if(sa===v.a.B0&&xa.XRa)xa.gTc=!0,h.ULS.sendTraceTag(578307397,820,50,"Prediction Text Rejected"),xa.cRa();else if(sa===v.a.eKb&&Ga.lc.ctrlKey&&xa.pzd)return h.ULS.sendTraceTag(578307396,820,50,"Prediction Undid"),xa.Bfh(),!1}if(sa===v.a.IJb&&Ga.lc.shiftKey||sa===v.a.$ea&&Ga.lc.ctrlKey||sa===v.a.BZa&&Ga.lc.altKey)return!1;na=xa.aD.t4;const Ha=sa===v.a.YX||sa===v.a.s5||sa===v.a.afa||sa===v.a.t$;if(Ha||Ha&&(Ga.lc.ctrlKey||Ga.lc.shiftKey)||sa!==v.a.$ea&&Ga.lc.ctrlKey||
sa!==v.a.BZa&&Ga.lc.altKey||sa===v.a.jH||xa.XRa&&na&&0<na.p7.length&&!na.p7.toLowerCase().startsWith(String.fromCharCode(sa).toLowerCase()))xa.cRa(),xa.aD.t4=null,h.ULS.sendTraceTag(578307395,820,50,"Prediction hidden due to user typing a character that did not match prediction");xa.Bfh();return!1}static Foj(){5>xa.settings.PredictionSeenCount&&(xa.settings.PredictionSeenCount+=1)}static cRa(){Ma.a.cRa();xa.XRa=!1}static Ezj(Ga){xa.WR.wF(()=>{var na=document.getElementById("inlinePredictedWord");
if(na){var sa=na.innerText;if(sa&&0<sa.length&&(Ga=Ga?Ga:xa.X8i())){var Ha=new u.GraphTransaction(7);Ha.fd(Ga);var cb=Ga.Ra.last,Za=qa.a.XNa(Ga),va=ka.a.Bs(Za);cb.formatting=va.Sd(cb);xa.characterPropertiesEditor.replaceTextRange(Za,sa,!0,!0,Ja.a.typing);Ha.dispose();sa=E.InteractiveViewManager.instance.Ld;Ha=Ga.Ag(sa.Ma);Ha=za.a.qt(Ha,Ba.ParagraphReader.textLength(Ga));cb=new Sys.UI.Point(Ha.x,Ha.y);cb.y+=Ha.height;sa.m5(cb,null,null,sa,!1);xa.XRa=!1;na.innerText="";(na=document.getElementById("inlinePlaceholderTab"))&&
xa.iig()&&(na.className="hidePanel")}}},"WPT:IIG")}static n3k(Ga){xa.Qtf=Ga;xa.b5.rFd(K.a.modelId,Ga.modelId);xa.b5.rFd(K.a.modelVersion,Ga.modelVersion);xa.b5.rFd(K.a.configId,Ga.configId)}static n7i(){return xa.Qtf}static NHd(Ga,na){const sa=xa.jEh;var Ha=document.getElementById("inlinePredictedWord");Ha&&(Ha.innerText=na,(na=document.getElementById("WACViewPanel_EditingElement_WrappingDiv").getElementsByClassName("TextRun"))&&0<na.length&&(na=na[na.length-1],Ha.style.fontSize=na.style.fontSize,
Ha.style.fontFamily=na.style.fontFamily,Ha.style.color=na.style.color,Ha.style.whiteSpace="pre",Ha=Ha.parentNode,Ga="suggestion: "+Ga,na=document.getElementById("inlinePlaceholderTab"),na.className="hidePanel",na&&xa.iig()&&(na.className="inlinePlaceholderTab",Ga+=". Tab to accept"),Ha.parentNode.setAttribute("aria-label",Ga)),sa&&(sa.className="textareaCaretTracker"),xa.a4k()&&(xa.XRa=!0,h.ULS.sendTraceTag(578307393,820,50,"Ghost Text Visible")))}static urg(Ga){Ga||(Ga=xa.D_i());if(Ga){const na=
Ga.node;try{return Ba.ParagraphReader.textLength(na)<=Ga.Qa}catch(sa){}}return!1}static aVj(Ga){Ga=xa.zWa.ga(Ga);Ga=Ga[K.a.qHd]-Ga[K.a.Kkc];300<Ga?(xa.b5.E7a(K.a.bVf,Ga),xa.b5.E7a(K.a.aVf,1)):(xa.b5.E7a(K.a.WGf,Ga),xa.b5.E7a(K.a.kEf,1))}static IVd(Ga){xa.ktg("TextPredictionTelemetryIsEnabled")&&xa.b5.mTi(Ga)}static IAg(Ga,na){Ga=xa.zWa.ga(Ga);const sa=Ga[K.a.Kkc];na?xa.b5.E7a(K.a.Uqh,Ga[K.a.lEf]-sa):xa.b5.E7a(K.a.Sqh,Ga[K.a.jEf]-sa)}static U5b(Ga){xa.b5.E7a(Ga,1)}static zsa(Ga,na,sa){xa.b5.bvj(Ga,
na,sa)}static gdd(){xa.aD.t4=null;xa.aD.ydb=null}static Yyk(){xa.qhb("TextPredictionsSeen","TextPredictionsSeenIsEnabled");xa.Foj();xa.bBj()}static qhb(Ga,na){xa.ktg(na)&&window.setTimeout(()=>{const sa=m.a.instance.La("Common.ISystemInitiatedFeedback");sa&&sa.execute(Ha=>{Ha.logActivity(Ga,na)})},xa.uUf)}static ktg(Ga){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka(Ga)}static qzi(){var Ga=document.body;const na=document.createElement("div");if(Ga){Ga.appendChild(na);na.setAttribute("id",
"textareaCaretTracker");na.className="hidePanel";na.setAttribute("role","alert");Ga=document.createElement("button");const sa=document.createElement("span");Ga.setAttribute("disabled",!0);Ga.setAttribute("aria-disabled",!0);Ga.setAttribute("aria-hidden",!0);sa.setAttribute("aria-disabled",!0);sa.setAttribute("aria-hidden",!0);sa.setAttribute("id","inlinePredictedWord");sa.className="inlinePredictedWord";Ga.className="inlinePredictedWordButton";Ga.appendChild(sa);na.appendChild(Ga);na.appendChild(xa.YAi());
(Ga=document.getElementById("WACViewPanel"))&&$addHandler(Ga,"scroll",xa.Nmj)}return na}static a4k(){const Ga=xa.jEh;var na=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");na=(na=na?na.getElementsByClassName("EOP")[0]:null)?na.getBoundingClientRect():null;return Ga&&na?(Ga.style.cssText="transform: scale("+xa.vCi+"); transform-origin: 0% 0%",Ga.style.top=na.top+"px",Ga.style.left=na.left+"px",!0):!1}static iig(){return!xa.settings.PredictionAccepted}static bBj(){5!==xa.settings.PredictionSeenCount||
xa.settings.PredictionAccepted||(xa.qhb("PredictionNotAccepted","PredictionNotAcceptedIsEnabled"),xa.GXk())}static YAi(){const Ga=document.createElement("button");Ga.setAttribute("aria-hidden",!0);Ga.className="hidePanel";Ga.id="inlinePlaceholderTab";Ga.disabled=!0;Ga.innerText="Tab";return Ga}static Nmj(){xa.cRa()}static X8i(){const Ga=oa.a.instance.Oa.kb;return Ga&&Ga.Te?Ga.Te.node:null}static UKk(){xa.$Cd||(xa.$Cd=window.setTimeout(xa.olj,6E4*xa.HDi))}static olj(){xa.b5.flush();xa.b5.rTi();xa.$Cd=
0}static R$f(Ga){return Ga&&0<Ga.length&&(Ga=Ga.split(" "),0<Ga.length)?Ga[Ga.length-1].length:-1}static Evl(Ga){const na=xa.aD.t4,sa=xa.aD.ydb;na&&(xa.pzd=Object.assign(new C,{keyCode:Ga,SAl:na,TAl:sa}))}static D_i(){const Ga=oa.a.instance.Oa.kb;return Ga&&Ga.Te?Ga.Te:null}static Bfh(){xa.pzd=null}}xa.IDi=30;xa.HDi=5;xa.uUf=5E3;xa.DEd=null;xa.Czd=null;xa.upd=null;xa.x2a=null;xa.qzf=!1;xa.$Cd=0;xa.FEd=null;xa.qzd=null;xa.pzd=null;xa.EEd=null;xa.Kwc=null;xa.Qtf=null;xa.opc=null;xa.XRa=!1;Object(J.a)(xa,
"WordPredictionHandler",null,[])},641:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Pek="NoCharacterPositionOnLine";h.Rek="NoCharacterPositionOnSpan";h.Qek="NoCharacterPositionOnMultilineSpan";h.IXb="DoNothingResult";h.Mha="FailedProcessingStep";h.m5a="FailedResult";h.jJc="FirstChildNotText";h.hSi="FirstChildNull";h.kAj="InvalidCharacterPositionResult";h.ph="NoExecute";h.Eo="NoApply";h.v0="UnexpectedState";Object(J.a)(h,"ActivityEventName",null,[])},642:function(J,V,d){d.d(V,"a",
function(){return h});J=d(0);class h{}h.yO="WordIndex";h.beh="RenderedCandidateCount";h.TUg="NotRenderedCandidateCount";h.CLf="CandidateListCount";h.BTf="CumulativeIndexOfSeen";h.fCi="CumulativeIndexOfRejected";h.eCi="CumulativeIndexOfKept";h.ATf="CumulativeIndexOfCorrect";h.dCi="CumulativeIndexOfAcceptedCandidate";h.Eih="SeenCount";h.JMk="RejectedCount";h.SQj="KeptCount";h.kzh="TypedThroughCount";h.gCi="CumulativeScoreOfKept";h.hCi="CumulativeScoreOfRejected";h.DTf="CumulativeScoreOfTypeThrough";
h.ceh="RenderedCharSum";h.RQj="KeptCharSum";h.QQj="KeptCandidateTokenSum";h.Drl="UndoOfKeptCount";h.Grl="UndoneKeptCharCount";h.lzh="TypedThroughLastMatchingCharCount";h.language="Language";h.EPa=[h.beh,h.TUg,h.CLf,h.BTf,h.fCi,h.eCi,h.ATf,h.dCi,h.Eih,h.JMk,h.SQj,h.kzh,h.gCi,h.hCi,h.DTf,h.ceh,h.RQj,h.QQj,h.Drl,h.Grl,h.lzh,h.language];Object(J.a)(h,"DataFieldsPerSentence",null,[])},643:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.modelId="ModelId";h.configId="ConfigId";h.modelVersion=
"ModelVersion";h.Wyk="PredictionAcceptedByTab";h.Vyk="PredictionAcceptedByRightArrow";h.WGf="AugLoopResponseTime";h.Uqh="SignalRenderedTime";h.Sqh="SignalNotRenderedTime";h.bVf="DelayedResponseTime";h.ydl="SignalGeneratedCount";h.kEf="AnnotationReceivedCount";h.S5g="PredictionRenderedCount";h.R5g="PredictionNotRenderedCount";h.JSd="EmptyPredictionResponseCount";h.drh="SkippedPredictionResponseCount";h.aVf="DelayedResponseCount";h.afk="NonEnglishSkipCount";h.Kkc="SignalGenerationTime";h.qHd="AnnotationReceivedTime";
h.lEf="AnnotationRenderedTime";h.jEf="AnnotationNotRenderedTime";h.EPa=[h.Vyk,h.Wyk,h.WGf,h.Uqh,h.Sqh,h.bVf,h.ydl,h.kEf,h.S5g,h.R5g,h.JSd,h.drh,h.aVf,h.afk];h.TZb=[h.modelId,h.configId,h.modelVersion];Object(J.a)(h,"DataFieldsPerSession",null,[])},644:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.language="Language";h.DLd="CharIndex";h.ECc="CharIndexRendered";h.Myg="KeptCharCount";h.modelId="ModelId";h.Q5g="PredictionLength";h.T5g="PredictionTokenCount";h.score="Score";h.status=
"Status";h.NRe="TypedThroughCharCount";h.yO="WordIndex";h.modelVersion="ModelVersion";h.mwh="TimeTakenAugloop";h.Mjd="TimeToRender";h.configId="ConfigId";h.EPa=[h.DLd,h.ECc,h.Myg,h.Q5g,h.T5g,h.score,h.status,h.NRe,h.yO,h.mwh,h.Mjd];h.TZb=[h.language,h.modelId,h.configId,h.modelVersion];Object(J.a)(h,"DataFieldsPerCandidate",null,[])},645:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.syncDeltaTimeout=this.disableSyncDeltaSending=this.isDeltaGeneratorEnabled=this.powerpoint=
this.downloadPolymerBaseUrl=this.inferenceServiceVersion=this.downloadBaseUrl=this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseCustomAudience=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}}Object(J.a)(h,"InitializeParameters",null,[])},646:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.EEa=
!0;this.BWc=this.j2c=this.P3c=this.Z_c=null;this.vja=e}copy(){return new h(this.vja.copy())}move(e,m){this.EEa=!0;this.vja.move(e,m)}setOffsets(e){this.EEa=!0;this.vja.setOffsets(e)}Uf(){return this.vja.Uf()}get Zb(){this.jld();return this.Z_c}get fc(){this.jld();return this.P3c}get Vb(){this.jld();return this.j2c}get Ub(){this.jld();return this.BWc}jld(){if(this.EEa){var e=this.vja.points;this.Z_c=this.j2c=e[0].x;this.P3c=this.BWc=e[0].y;for(const m of e)this.Z_c=Math.min(this.Z_c,m.x),this.P3c=
Math.min(this.P3c,m.y),this.j2c=Math.max(this.j2c,m.x),this.BWc=Math.max(this.BWc,m.y);this.EEa=!1}}}Object(J.a)(h,"Boundary",null,[])},647:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.fJ=e}}Object(J.a)(h,"SessionEndedEventArgs",Sys.EventArgs,[])},648:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(55);class e{constructor(m){this.pAg=this.errorType=0;this.originalText=this.token=null;this.bHa=this.L9=this.lcid=0;this.RDh=
!1;this.oqf=m}W8d(){const m=this.token?this.token:null;return 0!==this.errorType&&e.Qtj.contains(m,this.lcid)}static get Qtj(){return e.TKa||(e.TKa=h.a.instance.resolve("Box4.Proofing.IIgnoreAllKeywords"))}}e.TKa=null;Object(J.a)(e,"ProofingErrorDetails",null,[385])},649:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.Load=0]="Load";e[e.Edit=1]="Edit"})(h||(h={}));Object(J.b)("UserAction",h)},650:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);V=d(105);class h extends V.a{constructor(){super();
this.Input=null;this.Lcid=0;this.UserActionType=this.PostContextText=this.PreContextText=null;this.ApplicationMode=0}Ik(){return 4}static TUi(e,m){const n=new h;h.vye(n,e,m);n.UserActionType=e.paragraphNode.KNb?"Edit":"Load";return n}static vye(e,m,n){e.Lcid=m.range.lcid;e.Input=m.Gla.substring(m.range.begin,m.range.end);e.ApplicationMode=n;0<=m.range.L9&&(e.PreContextText=m.Gla.substring(m.range.L9,m.range.begin));0<=m.range.bHa&&(e.PostContextText=m.Gla.substring(m.range.end,m.range.bHa))}static Nbj(e,
m,n,v,A,w,y,u){const {SpellingRequestObjectUpdatedV2:E}=d(1072),{SpellingRequestObjectUpdated:G}=d(1073);return u?E.zWd(m,n):e?G.zWd(m,n,v,A,w,y):h.TUi(m,n)}}Object(J.a)(h,"SpellingRequestObject",V.a,[])},651:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(78);class e{static Lmb(m,n,v="GenericCommentsTask"){v=new h.a(2,1,0,()=>{n()},92,v);m.Gb(v)}static du(m){return Error.create("SDXHostAPI Error : "+m,{["SDXHostAPIErrorCode"]:m})}}Object(J.a)(e,"OfficeSharedCommentsUtils",null,[])},
652:function(J,V,d){d.d(V,"a",function(){return n});J=d(0);var h=d(375);V=d(710);var e=d(998),m=d(900);class n extends V.a{constructor(v,A,w=null){super(v,A,w||e.a.instance,n.Uwj)}static Uwj(){m.a.sendTraceTag=n.q_k;m.a.debugAssertTag=n.QCi}static q_k(v,A,w,...y){h.ULS.sendTraceTag.apply(null,[v,204,n.MBi(A),w].concat(y))}static QCi(){}static MBi(v){switch(v){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}n.xze="wdPreviousSession";n.MTf=
"wdUserSession";Object(J.a)(n,"CommonCrossDocumentMessenger",V.a,[])},653:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(375),e=d(25);class m{static M1d(n,v){let A=null;if(n&&0<n.length&&v&&0<v.length){const w=window[v];w?w&&n in w?A=w[n]:h.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+n+" from dictionary "+v):h.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+v)}return A}static G8d(){const n=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",
!1);n?h.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):h.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version");return n}}Object(J.a)(m,"CommonUtils",null,[])},654:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.type=null;this.type=e}}Object(J.a)(h,"CustomContentProps",null,[])},655:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(296);class h{}h.LabelText=d.a.labelText;h.LabelTextUserGeneratedPlaceholderReplacements=d.a.lRj;
h.Visible=d.a.visible;h.ImageIsVisible="ImageIsVisible";h.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";h.Image16by16Class=d.a.wtb;h.Image32by32Class=d.a.tCa;h.Image48by48Class=d.a.J4d;h.ImageBackColor="ImageBackColor";h.On="On";h.SourceControlId="SourceControlId";Object(J.a)(h,"FlyoutAnchorCommandProperties",null,[])},656:function(J,V,d){d.d(V,"a",function(){return w});J=d(0);var h=d(262),e=d(25),m=d(355),n=d(193),v=d(95),A=d(62);class w{static xXa(y){let u,E;({anl:u,bnl:E}=w.WQi());
w.LXk(u,E,y)}static WQi(){({N1b:u}=m.a.RIb(!e.AFrameworkApplication.LP));var y=$get(h.CuiHelper.Krj);if(u)var u=document.getElementById(h.CuiHelper.aUd);else u=y.childNodes[0],y=y.childNodes[1];return{anl:u,bnl:y}}static LXk(y,u,E){if(y&&u&&0<u.clientHeight){const G=-1!==u.parentNode.parentNode.className.indexOf("cui-ribbon");w.aih(y,u,E,G)}}static aih(y,u,E,G){let I=null,H=null,K=null,C=null,Y=null,M=null,P=null,T=null,L=null,aa=null,Q=null,ea=null,ia=null,ja=null,D=null,pa=null,Z=null,oa=null,Ba=
null,Ma=null;({ZYf:I,YYf:H,$Yf:K,R4a:C,S4a:Y,NOa:M,eS:P,Ou:T,OOa:L,tP:aa,POa:Q,aZf:Ma}=w.I2f(y,I,H,K,C,Y,M,P,T,L,aa,Q,Ma));({gYb:ea,hG:ia,XYf:ja,VYf:D,T4a:pa,pqb:Z,qqb:oa,WYf:Ba}=w.g3f(u,ea,ia,ja,D,pa,Z,oa,Ba));y=[I,H,K,C,Y,M,P,T,L,aa,Q,ja,D,pa,Z,oa,Ba,Ma];for(var za of y)w.hbl(za);za=[I,H,K,Y,P,T,aa,Q,D,Z,oa,Ba];for(const ka of za)w.jSe(ka);w.Afh(H);w.Mkh(ia,0);w.PLi(I,H,K,C,Y,M,P,T,L,aa,Q,ea,ia,ja,D,pa,Z,oa,Ba,Ma,G,E);w.z6h(M,P)}static OXk(y,u){w.aih(y,null,u,!1)}static z6h(y,u){y&&u&&(y.style.marginTop=
(u.offsetHeight-y.offsetHeight)/2+"px")}static I2f(y,u,E,G,I,H,K,C,Y,M,P,T,L){for(let aa=0;y&&aa<y.childNodes.length;aa++){const Q=y.childNodes[aa],ea=v.a.Yha(Q),ia=!!Q.id;-1!==ea.indexOf("cui-QATRowLeft")?u=Q:-1!==ea.indexOf("cui-QATRowCenter")?E=Q:-1!==ea.indexOf("cui-QATRowRight")?G=Q:-1!==ea.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?I=Q:Q.id===h.CuiHelper.JJd?H=Q:Q.id===h.CuiHelper.r4f?K=Q:Q.id===h.CuiHelper.KJd?C=Q:Q.id===h.CuiHelper.LJd?Y=Q:ia&&w.gFj(Q)?M=Q:-1!==ea.indexOf("UsernameNameContainer")?
P=Q:-1!==ea.indexOf("UsernameNameItem")?T=Q:-1!==ea.indexOf("FreemiumUpsellButton")&&(L=Q);({ZYf:u,YYf:E,$Yf:G,R4a:I,S4a:H,NOa:K,eS:C,Ou:Y,OOa:M,tP:P,POa:T,aZf:L}=w.I2f(Q,u,E,G,I,H,K,C,Y,M,P,T,L))}return{ZYf:u,YYf:E,$Yf:G,R4a:I,S4a:H,NOa:K,eS:C,Ou:Y,OOa:M,tP:P,POa:T,aZf:L}}static g3f(y,u,E,G,I,H,K,C,Y){for(let M=0;y&&M<y.childNodes.length;M++){const P=y.childNodes[M],T=v.a.Yha(P),L=!!P.id;-1!==T.indexOf("cui-jewel-container")?u=P:-1!==T.indexOf("cui-tts")?E=P:-1!==T.indexOf("cui-TabRowInline")?I=
P:-1!==T.indexOf("cui-TabRowRight")?Y=P:-1!==T.indexOf("cui-separator")?G=P:L&&P.id.startsWith(h.CuiHelper.x1g)&&!H?H=P:L&&P.id.startsWith(h.CuiHelper.a2f)?K=P:L&&P.id.startsWith(h.CuiHelper.Oxe)&&(C=P);({gYb:u,hG:E,XYf:G,VYf:I,T4a:H,pqb:K,qqb:C,WYf:Y}=w.g3f(P,u,E,G,I,H,K,C,Y))}return{gYb:u,hG:E,XYf:G,VYf:I,T4a:H,pqb:K,qqb:C,WYf:Y}}static KXk(y,u,E,G,I,H,K,C,Y){w.HQ(y,u,Y)&&(w.ZOc(u),w.HQ(y,u,Y)&&w.ZOc(u));w.HQ(u,G,Y)&&(w.wK(E),w.wK(I),w.HQ(u,G,Y)&&(w.ZOc(u),w.HQ(u,G,Y)&&(w.ZOc(u),w.HQ(u,G,Y)&&w.wK(G))));
w.HQ(G,C,Y)&&(w.wK(E),w.wK(I));y=[H,K,C];w.Ijg(G,C,y,Y);w.Ijg(u,C,y,Y)}static Ijg(y,u,E,G){let I=0;for(;I<E.length&&w.HQ(y,u,G);)w.wK(E[I]),I++}static fbj(y){if(!y)return 0;if(void 0===y._scaleStep||null===y._scaleStep){let u=0;-1!==y.className.indexOf("cui-tts-scale1")?u=1:-1!==y.className.indexOf("cui-tts-scale2")&&(u=2);y._scaleStep=u}return parseInt(y._scaleStep)}static ZOc(y){let u=w.fbj(y);2>u&&w.Mkh(y,++u)}static Mkh(y,u){y&&(y.className=w.tVk[u],y._scaleStep=u)}static HQ(y,u,E){return y&&
u?A.a.Bzg(A.a.Yh(y),A.a.Yh(u),E):!1}static FCb(y,u,E){let G=0;y&&u&&(G=A.a.wbe(A.a.Yh(y),A.a.Yh(u),E));return G}static RNd(y){for(let u=0;y&&u<y.childNodes.length;u++)if(-1!==y.childNodes[u].className.indexOf("cui-cg"))return!0;return!1}static IYd(y){let u=null;for(let E=y.childNodes.length-1;y&&0<=E;E--){const G=y.childNodes[E];if(-1===G.className.indexOf("cui-cg"))break;u=G}return u}static PIb(y,u,E){if(y&&!w.En(y)){var G=n.a.Ru(y);G=v.a.yL(G.paddingLeft)+v.a.yL(G.paddingRight);E=y.offsetWidth-
E-G;let I=0;for(;u&&u!==y;)(G=n.a.Ru(u))&&(I+=v.a.yL(G.paddingLeft)+v.a.yL(G.paddingRight)),u=u.parentNode;E=Math.max(E,75+I);y.style.width=E+"px"}}static LSk(y,u,E){if(y&&u){let G=0,I=0;({left:G,top:I}=A.a.Z8f(u,G,I));w.Adk(y,E?G-y.offsetWidth:G+u.offsetWidth)}}static PLi(y,u,E,G,I,H,K,C,Y,M,P,T,L,aa,Q,ea,ia,ja,D,pa,Z,oa){Z&&w.KXk(T,L,aa,Q,ea,ia,ja,D,oa);w.RNd(L)?w.TXk(L,y,u,E,G,I,H,K,C,Y,M,P,pa,oa):w.SXk(y,u,E,G,I,H,K,C,Y,M,P,pa,oa)}static SXk(y,u,E,G,I,H,K,C,Y,M,P,T,L){const aa=!!I,Q=!!K,ea=!!C;
let ia=0;if((Q||ea)&&0<(ia=w.FCb(y,u,L))){let ja=Q;ea&&(!Q||C.offsetWidth>K.offsetWidth)&&(ja=!1);w.PIb(ja?K:C,ja?K:C,ja?ia:2*ia);Q&&ea&&0<(ia=w.FCb(y,u,L))&&w.PIb(ja?K:C,ja?K:C,ja?ia:2*ia)}if(Q&&w.HQ(K,u,L)||aa&&w.HQ(I,u,L))w.wK(G),w.wK(I),w.wK(H),w.wK(K),ea&&(w.jSe(u),w.jSe(C));w.Dbh(u,E,C,Y,M,P,T,L);ea&&w.GLf(C,y,E,L)}static TXk(y,u,E,G,I,H,K,C,Y,M,P,T,L,aa){const Q=!!C,ea=!!Y,ia=!!M,ja=!!L,D=w.IYd(y);0<(u=w.FCb(u,D,aa))&&(Q&&w.PIb(C,C,u),!Q||w.HQ(C,D,aa))&&(w.wK(I),w.wK(H),w.wK(K),w.wK(C));w.HQ(y,
E,aa)&&w.LSk(E,y,aa);w.Dbh(E,G,Y,M,P,T,L,aa);0<(u=w.FCb(y,G,aa))&&(w.PIb(P,T,u),ja&&w.HQ(y,G,aa)&&w.wK(L),ia&&w.HQ(y,G,aa)&&w.wK(M));ea&&!w.En(E)&&w.GLf(Y,y,G,aa)}static Dbh(y,u,E,G,I,H,K,C){const Y=!!E,M=!!G,P=!!I,T=!!K;let L=0;if((Y||P)&&0<(L=w.FCb(y,u,C))){const aa=!!y&&"absolute"!==y.style.position;let Q=Y;P&&(!Y||I.offsetWidth>E.offsetWidth)&&(Q=!1);w.PIb(Q?E:I,Q?E:H,Q&&aa?2*L:L);Y&&P?(0<(L=w.FCb(y,I,C))&&(Q=!Q,w.PIb(Q?E:I,Q?E:H,Q&&aa?2*L:L)),w.HQ(y,I,C)&&w.wK(y)):Y&&w.HQ(y,u,C)&&w.wK(y)}T&&
w.HQ(y,u,C)&&w.wK(K);M&&w.HQ(y,u,C)&&w.wK(G)}static En(y){if(!y)return!0;y=y._isHidden;return!(void 0===y||null===y||"0"===y)}static wK(y){y&&!w.En(y)&&(y.style.display="none",y._isHidden="1")}static hbl(y){y&&w.En(y)&&(y.style.display="",y._isHidden="0")}static jSe(y){y&&(y.style.width="auto",y.style.maxWidth="none")}static Adk(y,u){y&&(y.style.position="absolute",y.style.left=u+"px")}static Afh(y){y&&(y.style.position="static",y.style.left="auto")}static GLf(y,u,E,G){if(y&&y.parentNode&&y.parentNode.parentNode){var I=
w.Ouk(y);"auto"!==y.parentNode.style.width&&(y.style.width=y.parentNode.offsetWidth-I+"px");var H=G?E:u;u=G?u:E;E=A.a.Yh(y.parentNode.parentNode);H=H?A.a.Yh(H):new Sys.UI.Bounds(E.x,0,0,0);u=u?A.a.e6a(u):new Sys.UI.Point(E.x+E.width,0);"absolute"===y.parentNode.style.position?I=u.x-(H.x+H.width)-I-1:(E=A.a.Yh(y.nextSibling?y.parentNode:y),E=E.x+E.width/2,I=2*Math.min(E-(H.x+H.width),u.x-E)-I-1);y.style.maxWidth=I+"px"}}static Ouk(y){var u=n.a.Ru(y);u=u?v.a.yL(u.paddingLeft)+v.a.yL(u.paddingRight):
0;var E=n.a.Ru(y.parentNode);E=E?v.a.yL(E.paddingLeft)+v.a.yL(E.paddingRight):0;let G=0;for(;y.nextSibling;)y=y.nextSibling,G+=y.offsetWidth;return u+E+G}static gFj(y){return!!y.id&&(y.id.startsWith(h.CuiHelper.ZJe)||y.id.startsWith(h.CuiHelper.Vcd))}}w.tVk=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(J.a)(w,"RibbonTabScalingActor",null,[])},657:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(375),e=d(13),m=d(25),n=d(141),v=d(55),A=d(178),w=d(139);class y{constructor(){this.jMa=
null;this.zuf=!1}ARe(){try{this.jMa||(this.jMa=v.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.zuf=!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",!1))}catch(u){h.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+u)}}y6i(){this.ARe();return this.jMa?this.jMa.getToken("Search",m.AFrameworkApplication.Ece,!1):null}beg(){if("Dev Box"===m.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&
void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(u=>{window.setTimeout(()=>{u(window.TellMeSubstrateTokenOverride)},750)});this.ARe();return this.jMa?this.jMa.getToken("Search",m.AFrameworkApplication.QNe,!0):null}Yej(){this.ARe();return this.jMa?this.jMa.getToken("Search",this.Vej(),this.zuf):null}Vej(){return m.AFrameworkApplication.fa.Ha("TellMeServiceAuthEndpointForSearch")}z6i(){return Object(e.a)(this,this.y6i,"getLokiTokenPromise")}gej(){return Object(e.a)(this,
this.beg,"getSubstrateTokenPromise")}QGb(){return!!m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.gb.QGb}Mfj(){const u={};this.QGb()&&(u.Loki=this.z6i(),u.Substrate=this.gej());return u}b6b(u){n.a.THa(Object.assign(new A.a,{name:"Events",dataFields:[Object.assign(new w.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new w.a,{name:"Status",bool:u})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}gUj(){return m.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>
{this.b6b(!1);return!1}).then(()=>{this.b6b(!0);return!0}):new Promise((u,E)=>{const G=v.a.instance.resolve("Common.IDynamicScriptLoaderProvider").yv;G?G.loadScript("tellme-strings").then(()=>{this.b6b(!0);u(!0)}).catch(()=>{this.b6b(!1);E(!1)}):(this.b6b(!1),E(!1))})}static AMj(){return!!m.AFrameworkApplication.Aa&&(m.AFrameworkApplication.Aa.gb.X4b||m.AFrameworkApplication.Aa.gb.svb)}static uTc(){return!!m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.gb.svb}}Object(J.a)(y,"ReactSharedHeaderSearchUtils",
null,[])},658:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(375),e=d(45),m=d(914),n=d(27),v=d(42),A=d(75),w=d(31);class y{constructor(u=2E3){this.sLa=u}sEj(){const u=y.tV();return this.EPj(u)}EPj(u){return 0<this.bNc(u).mentionLength}getSelectedText(){const u=y.tV();return this.bNc(u)}bNc(u){return this.Bbj(u)}Bbj(u){var E=null;u&&u.Paa&&v.SelectionEditor.Kg(u.Ua)&&v.SelectionEditor.pvb(u.Ua)&&(h.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),
E=v.SelectionEditor.bPa(u.Ua,!1));E&&(u=E);if(!u)return Object.assign(new m.a,{neighborhood:"",mentionStart:0,mentionLength:0});const G=new Sys.StringBuilder;let I=E=0;const H=[],K=u.length;for(let Y=0;Y<K;Y++){const M=u.ga(Y);if(!w.ParagraphReader.Wd(M.node)||Array.contains(H,M.node.tJa))continue;H.push(M.node.tJa);let P=w.ParagraphReader.text(M.node),T=0;var C=w.ParagraphReader.pra(M.node,!0,!0,!0);let L=w.ParagraphReader.pra(M.node,!1,!0,!0),aa=0;for(;P.length<this.sLa&&(C||L);){if(!(aa%2)&&C){const Q=
w.ParagraphReader.text(C);P=Q+" "+P;T+=Q.length+1;C=w.ParagraphReader.pra(C,!0,!0,!0)}1===aa%2&&L&&(P=P+" "+w.ParagraphReader.text(L),L=w.ParagraphReader.pra(L,!1,!0,!0));aa++}C=Y===K-1;Y||-1===M.Qa||(E=M.Qa);I+=C&&-1!==M.Kb?M.Kb:P.length;G.append(P);E+=T;I+=T;C||(G.append(" "),I++)}for(u=A.AParagraphNode.scd(G.toString()," ");E<I&&e.a.yy(u.charCodeAt(E));)E++;for(;I>E&&e.a.yy(u.charCodeAt(I-1));)I--;return this.X6h(u,E,I)}X6h(u,E,G){if(u.length>this.sLa){var I=G-E;if(I>this.sLa)u=u.substr(E,this.sLa),
G=this.sLa,E=0;else{I=Math.max(E-Math.floor((this.sLa-I)/2),0);let H;H=Math.min(I+this.sLa,u.length);I=Math.max(H-this.sLa,0);E-=I;G-=I;u=u.substring(I,H)}}return Object.assign(new m.a,{neighborhood:u,mentionStart:E,mentionLength:G-E})}static tV(){var u=n.App.Fb.Ed.en;if(!u)return h.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;u=u.Eb;return u&&u.Oa&&u.Oa.length?u.Oa.kb:(h.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(J.a)(y,"Box4InsightsSelection",
null,[380,381])},659:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.style=this.formatting=null;this.languageId=0}}Object(J.a)(h,"NewOutlineElementInfo",null,[])},660:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.a6c="Listening";h.MBb="Warning";h.TVa="Error";Object(J.a)(h,"VoiceNotificationResourceStrings",null,[])},661:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.CoachButton="coachButton";h.MicButton="micButton";h.PrevButton=
"prevButton";h.NextButton="nextButton";h.GridButton="gridButton";h.InkButton="inkButton";h.SubtitlesButton="subButton";h.LiveButton="liveButton";h.MoreButton="moreButton";h.ExitButton="exitButton";Object(J.a)(h,"SlideshowToolbarButtonIDs",null,[])},662:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(431);class h extends d.a{constructor(e){super();this.shapeNode=e}get Rug(){return!this.shapeNode||!this.shapeNode.isConnected}get id(){return this.shapeNode.id}get isConnected(){return this.shapeNode.isConnected}}
Object(J.a)(h,"InternalClipboardShape",d.a,[])},663:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(41);class e{constructor(m,n){this.Abb=!1;this.krd=this.wvf=-1;this.ww=m;n&&this.start()}start(){this.Abb=!0;this.krd=-1;const m=h.a.VX();m&&(this.wvf=m)}stop(){this.Abb=!1;const m=h.a.VX();m&&0<this.c$&&m>=this.c$&&(this.krd=m-this.c$)}get operation(){return this.ww}get gHc(){return this.krd}get c$(){return this.wvf}}Object(J.a)(e,"PPTStopwatch",null,[])},664:function(J,V,d){d.d(V,"a",
function(){return e});d.d(V,"b",function(){return m});var h=d(45);const e=n=>{n=btoa(n);n=n.replace(RegExp("\\+","g"),"-");n=n.replace(RegExp("\\/","g"),"_");return n=n.replace(RegExp("\\=+$","g"),"")},m=n=>{if(h.a.Va(n))return null;const v=RegExp("%([0-9A-F]{2})","g");n=encodeURIComponent(n);let A="",w=0,y;for(;y=v.exec(n);){const u=v.lastIndex-3;u>w&&(A+=n.substring(w,u));A+=h.a.fromCharCode(parseInt(String("0x"+y[1])));w=v.lastIndex}w<n.length&&(A+=n.substring(w,n.length));return btoa(A)}},665:function(J,
V,d){d.d(V,"a",function(){return w});J=d(0);var h=d(25),e=d(179),m=d(89),n=d(13);V=d(17);var v=d(26),A=d(67);class w{constructor(y,u,E,G,I,H,K,C,Y,M,P,T,L){this.X3=this.rl=this.Sw=null;this.WKf=!0;this.PTa=y;this.l$j=u;this.d1j=E;this.d8b=G;this.F3=I;this.Xb=H;this.Kd=K;this.hg=C;this.$9j=Y;this.lab=M;this.N4j=P;this.M4j=T;this.L4j=L}openDialog(){this.cxi();h.AFrameworkApplication.Aa.zdb();try{this.rl.click()}catch(y){const u=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
y.message,y.stack);v.a.J(509727820,818,10,u);throw y;}}submit(){const y=this.rl.files[0];this.X3=this.d1j();if(this.$9j)this.nxl(y);else{this.X3.kue&&this.X3.kue(this.F3,this.Xb,this.Kd,this.hg);const u=new FormData;for(let G of this.X3.UGd)u.append(G.key,G.value);u.append("fileInputId",y,y.name);const E=new XMLHttpRequest;E.onreadystatechange=()=>{this.xCb(E)};E.open("POST",this.X3.$4g);E.send(u)}}xCb(y){if(4===y.readyState){const u=y.status;if(!u||u>=e.a.Yy&&u<e.a.Vai){if(this.X3.onSuccess)this.X3.onSuccess(y.responseText,
this.F3,this.Xb,this.Kd,this.hg,this.rl)}else this.X3.Oy&&this.X3.Oy(y.responseText,this.F3,this.Xb,this.Kd,this.hg);this.dispose()}}nxl(y){this.lab().k0(this.d8b,y.size,y,this.X3.UGd.ga("MediaToken"),this.N4j,this.M4j,this.L4j,u=>{if(this.X3.onSuccess)this.X3.onSuccess(u.result,this.F3,this.Xb,this.Kd,this.hg,this.rl)},u=>{this.X3.Oy&&this.X3.Oy(u.error.Code.toString(),this.F3,this.Xb,this.Kd,this.hg)})}dispose(){this.Sw&&(m.a.removeHandler(this.rl,"change",Object(n.a)(this,this.MIc,"fileInputChange")),
document.body.removeChild(this.Sw),this.rl=this.Sw=null,w.qTe.remove(this))}cxi(){this.Sw||(this.Sw=document.createElement("form"),this.Sw.id="uploadFormId",this.Sw.style.visibility=A.a.hidden,this.Sw.method="post",this.Sw.encoding="multipart/form-data",this.Sw.action="",this.rl=document.createElement("input"),this.rl.style.visibility=A.a.hidden,this.rl.type="file",this.rl.id="uploadFileInputId",this.rl.name="uploadFileInputId",this.rl.accept=this.PTa,this.Sw.appendChild(this.rl),document.body.appendChild(this.Sw),
m.a.addHandler(this.rl,"change",Object(n.a)(this,this.MIc,"fileInputChange")))}MIc(){this.rl.value&&this.rl.value.length?(this.WKf=!1,this.l$j(this.rl,this.Kd,this.hg,this.d8b).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static fMe(y,u,E,G,I,H,K,C,Y,M,P,T,L){for(let aa of w.qTe)aa.WKf&&aa.dispose();y=new w(y,u,E,G,I,H,K,C,Y,M,P,T,L);w.qTe.add(y);y.openDialog()}}w.qTe=new V.a;Object(J.a)(w,"UploadFileDialog",null,[])},685:function(J,V,d){d.r(V);J=d(0);var h=d(375),e=d(186),
m=d(910),n=d(1056),v=d(25),A=d(1055),w=d(13),y=d(1157),u=d(1158),E=d(27),G=d(458);class I extends G.a{constructor(za,ka,qa,Ja,xa,Ga){super();this.init(za);this.xl("DummyClipboardOperation");this.wCa(v.AFrameworkApplication.Ta,ka,Ja,xa,Ga);this.Bu=qa;this.fp=8;this.BX()}run(){this.YKa=!0;this.sfb(this.Bu);this.Rla();this.fp=32}}Object(J.a)(I,"DummyClipboardOperation",G.a,[]);var H=d(95),K=d(126),C=d(115),Y=d(57);class M{constructor(za,ka,qa){h.ULS.shipAssertTag(6305502,307,!!za);this.properties=za;
this.hd=ka;this.Loa=qa}get Tc(){return this.hd}Fbg(){return this.properties.sa(Y.a.zT,"")}X5g(){return!0}ayh(){let za,ka=!1;za=null;const qa=this.Fbg();if(this.Loa||""!==qa)try{({K4a:za,returnValue:ka}=this.uRe(qa))}catch(Ja){h.ULS.shipAssertTag(4203138,307,!1),this.Tc.Tb(K.a.Mha,{["Reason"]:C.a.hIf}),H.a.Xza(za)}else h.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Tc.Tb(K.a.v0,{["Reason"]:C.a.RTd});return{returnValue:ka,eEc:za}}}Object(J.a)(M,"AStringInputImportStrategy",null,[1184]);
class P extends M{constructor(za,ka,qa,Ja,xa){super(za,ka,xa);this.ik=qa;this.GBd=Ja}uRe(za){const {ClipboardActor:ka}=d(685);let qa;if(this.Loa&&!za)return h.ULS.sendTraceTag(541172643,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,K4a:null};qa=null;if(this.Loa)return qa=this.ik.rWa(za),{returnValue:!0,K4a:qa};if(this.GBd){const Ja=this.properties.sa(Y.a.Gxe,"");Ja&&(qa=this.ik.rWa(Ja))}qa||(h.ULS.sendTraceTag(520931392,307,15,"HtmlStringImportStrategy:: use of innerHtml because domContainer is null"),
qa=ka.y3g,qa.innerHTML=za);return{returnValue:!0,K4a:qa}}}Object(J.a)(P,"HtmlStringImportStrategy",M,[]);var T=d(45);class L extends M{constructor(za,ka,qa){super(za,ka,qa)}uRe(za){let ka;if(this.Loa&&!za)return h.ULS.sendTraceTag(541172642,307,10,"No htmlDomContent"),{returnValue:!1,K4a:null};ka=document.createElement("div");za=za.split(RegExp("\r\n|\r|\n"));for(var qa=0;qa<za.length-1;qa++){const Ja=document.createElement("p");Ja.innerText=this.Cbe(za[qa]);ka.appendChild(Ja)}qa=document.createElement("span");
qa.innerText=T.a.RSd(za[za.length-1]);ka.appendChild(qa);return{returnValue:!0,K4a:ka}}Cbe(za){return T.a.RSd(za.length?za:" ")}}Object(J.a)(L,"MultiLineTextImportStrategy",M,[]);class aa extends L{constructor(za,ka,qa){super(za,ka,qa)}Fbg(){return this.properties.sa(Y.a.mdb,"")}Cbe(za){za=super.Cbe(za);return za.length&&" "!==za?za:"\u00a0"}}Object(J.a)(aa,"MultiLinePlainTextImportStrategy",L,[]);class Q extends M{constructor(za,ka,qa){super(za,ka,qa)}uRe(za){var {ClipboardActor:ka}=d(685);if(this.Loa&&
!za)return h.ULS.sendTraceTag(541172641,307,10,"No htmlDomContent"),{returnValue:!1,K4a:null};ka=ka.y3g;ka.innerText=za;return{returnValue:!0,K4a:ka}}}Object(J.a)(Q,"PlainTextImportStrategy",M,[]);var ea=d(376);class ia{constructor(za){this.ag=this.d$d=!1;this.xY=za}X5g(){this.d$d||(this.d$d=!0,this.ag=!1,this.xY.prepareForPaste(()=>{this.ag=!0}));return this.ag}ayh(){let za;this.d$d=!1;za=this.xY.paste();return za?za.hasChildNodes()?{returnValue:!0,eEc:za}:(h.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),
ia.Tc.Tb(K.a.v0,{["Reason"]:C.a.RTd}),{returnValue:!1,eEc:za}):(h.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),ia.Tc.Tb(K.a.m5a,{["Reason"]:C.a.wOe}),{returnValue:!1,eEc:za})}static get Tc(){return ea.a.instance}}Object(J.a)(ia,"SystemClipboardImportStrategy",null,[1184]);var ja=d(61),D=d(34),pa=d(49),Z=d(38),oa=d(32),Ba=d(255);d.d(V,"ClipboardActor",function(){return Ma});class Ma{constructor(za,ka,qa,Ja,xa,Ga,na,sa){this.SWe=null;this.nOb=0;this.IIh=za;this.xY=ka;this.hd=qa;this.ik=
Ja;this.Pc=xa;this.Ca=Ga;this.rs=na;this.maf=!!sa&&sa.ka("SupportImageDragDropExternalIsEnabled");this.UBd=!!sa&&sa.ka("ShowKeepSourceFormattingOnPasteFloatieIsEnabled");this.iM=new Ba.a;this.iM.$(oa.a.paste,257);this.iM.$(oa.a.tva,8449);this.iM.$(oa.a.Jpa,1);this.iM.$(oa.a.Ypg,513);this.iM.$(oa.a.reformatPastedContent,4097);this.iM.$(oa.a.Rbd,12289);this.iM.$(oa.a.r9c,7);this.iM.$(oa.a.q9c,1);this.iM.$(oa.a.s3g,8193);this.iM.$(oa.a.copy,272);this.iM.$(oa.a.mBc,16);this.iM.$(oa.a.cut,304);this.iM.$(oa.a.XTb,
48);this.iM.$(oa.a.u5c,64);this.iM.$(oa.a.v5c,64);this.iM.$(oa.a.showPlaceholderGlossary,65536);this.maf&&this.iM.$(oa.a.VXf,1)}get SNf(){return this.IIh.value}get bA(){return this.xY}ub(){this.Ca.pa(oa.a.TCk,Z.a.application,Object(w.a)(this,this.yad,"queryPasteOptions"),97);this.Ca.pa(oa.a.VCk,Z.a.application,Object(w.a)(this,this.yad,"queryPasteOptions"),97);this.UBd?this.Ca.pa(oa.a.q8g,Z.a.application,Object(w.a)(this,this.eBe,"queryReformatPasteOptions"),97):this.Ca.pa(oa.a.r8g,Z.a.application,
Object(w.a)(this,this.eBe,"queryReformatPasteOptions"),97);this.Ca.pa(oa.a.s8g,Z.a.application,Object(w.a)(this,this.eBe,"queryReformatPasteOptions"),97);this.Ca.SU(oa.a.XTb,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"),1028);this.Ca.SU(oa.a.cut,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"),1028);this.Ca.tza(oa.a.mBc,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"));this.Ca.tza(oa.a.copy,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"));this.maf&&this.Ca.SU(oa.a.VXf,Z.a.view,
Object(w.a)(this,this.IIi,"dropBrowserContent"),1028);this.Ca.SU(oa.a.Jpa,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"),1028);this.Ca.SU(oa.a.paste,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"),1028);this.Ca.SU(oa.a.tva,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"),1028);this.Ca.SU(oa.a.s3g,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"),1028);this.Ca.SU(oa.a.q9c,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"),1028);this.Ca.SU(oa.a.r9c,Z.a.view,Object(w.a)(this,this.fV,
"clipboardAction"),1028);this.Ca.SU(oa.a.reformatPastedContent,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"),1028);this.Ca.SU(oa.a.Rbd,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"),1028);this.Ca.xa(oa.a.bdd,Z.a.view,e.ActionManager.Fg);this.Ca.xa(oa.a.quk,Z.a.view,e.ActionManager.Fg);this.Ca.xa(oa.a.K3g,Z.a.view,e.ActionManager.Fg);this.Ca.xa(oa.a.L3g,Z.a.view,e.ActionManager.Fg);this.Ca.xa(oa.a.M3g,Z.a.view,e.ActionManager.Fg);this.Ca.xa(oa.a.J3g,Z.a.view,e.ActionManager.Fg);this.Ca.tza(oa.a.u5c,
Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"));this.Ca.tza(oa.a.v5c,Z.a.view,Object(w.a)(this,this.v5c,"moveSelectedContentWithinCurrentParagraph"));this.Ca.tza(oa.a.Ypg,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"));this.Ca.tza(oa.a.showPlaceholderGlossary,Z.a.view,Object(w.a)(this,this.fV,"clipboardAction"));this.Ca.xa(oa.a.yTf,Z.a.view,e.ActionManager.Fg);this.Ca.xa(oa.a.YTf,Z.a.view,e.ActionManager.Fg)}yad(za,ka,qa,Ja,xa){if(1===qa)return 32;xa[m.a.On]=!1;return 32}IIi(za,ka,qa,
Ja,xa,Ga){h.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var na=Ga.DataTransfer;Ga=na.getData("text/html");na=na.getData("text/plain");let sa=!1;const Ha=new n.DictionaryPropertySet;0<Ga.length?(h.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Ha.setValue(Y.a.zT,Ga),sa=!0):0<na.length&&(h.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Ha.setValue(Y.a.mdb,na),sa=!0);if(sa){const cb=this.iM.ga(ka);return this.SNf.create(za,
ka,cb,new y.a(()=>this.UVf(cb,Ha)),qa,Ja,xa,Ha)}return null}eBe(za,ka,qa,Ja,xa){if(ka=Object(u.a)(Object,xa))v.AFrameworkApplication.Qj("Microsoft.Office.Web.SessionSettings.IWacWordShowKeepSourceFormattingOnPasteFloatieSettings"),!this.UBd&&za===oa.a.r8g||this.UBd&&za===oa.a.q8g?(za=this.nOb!==oa.a.reformatPastedContent&&this.nOb!==oa.a.Rbd,ka[m.a.On]=this.nOb===oa.a.reformatPastedContent||za):za===oa.a.s8g&&(ka[m.a.On]=this.nOb===oa.a.Rbd);return 32}fV(za,ka,qa,Ja,xa,Ga){if(v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",
!1)){if((v.AFrameworkApplication.bO||v.AFrameworkApplication.XI)&&!v.AFrameworkApplication.SOa||D.a.instance.ga(83))return new I(za,ka,qa,Ja,xa,Ga)}else if(v.AFrameworkApplication.bO||D.a.instance.ga(83))return new I(za,ka,qa,Ja,xa,Ga);const na=this.iM.ga(ka);1!==Ja&&na&1&&(this.nOb=ka);1!==Ja&&Ga&&na&1&&(this.SWe=Ga);1!==Ja&&!Ga&&na&4096&&(Ga=this.SWe);return this.SNf.create(za,ka,na,new y.a(()=>this.UVf(na,Ga)),qa,Ja,xa,Ga)}v5c(za,ka,qa,Ja,xa,Ga){Ga=pa.a.Uj(ja.a.instance.Oa.kb.Ua.node,Ga);return this.fV(za,
ka,qa,Ja,xa,Ga)}UVf(za,ka){return za&256?new ia(this.bA):za&2?za&4096?new P(ka,this.hd,this.ik,E.App.instance.I3b,E.App.instance.OGb):new Q(ka,this.hd,E.App.instance.OGb):ka.Sa(Y.a.mdb)?new aa(ka,this.hd,E.App.instance.OGb):new P(ka,this.hd,this.ik,E.App.instance.I3b,E.App.instance.OGb)}static get y3g(){return A.a.F6a("Box4PasteScratchPad")}}Object(J.a)(Ma,"ClipboardActor",null,[])},693:function(J,V,d){J=d(0);var h=d(17),e=d(13),m=d(385),n=d(386);class v{constructor(G,I,H,K=0,C=0,Y=null){this.commandId=
G;this.controlId=I;this.timeStamp=H;this.commandSurface=m.a[K];this.Uu=n.a[C];this.contentType=Y}}Object(J.a)(v,"CommandActionInfo",null,[]);class A{constructor(){this.zGh=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}TPj(G){return!this.zGh.exec(G)}}Object(J.a)(A,"EventsCacheLoggingUtils",null,[]);var w=d(25),y=d(1079),u=d(738);d.d(V,"a",function(){return E});class E{constructor(){this.Zcf=null;this.Pwd=20;this.lrc=this.Sib=this.oLb=null}init(){this.Zcf=
new A;this.oLb=new h.a;this.Sib=new h.a;this.lrc=new h.a;this.Pwd=w.AFrameworkApplication.fa.Ec("MaxCommandClickedEventQueueSize",20);y.a.C3h(Object(e.a)(this,this.Voi,"commandClickEventRaised"));u.a.instance.mCf(Object(e.a)(this,this.bIk,"recordActionEvent"))}SQe(G){G.count>this.Pwd&&G.removeAt(this.Pwd)}Voi(G,I){this.oLb.insert(0,new v(I.commandId,I.controlId,I.time,I.commandSurface,I.Uu,I.contentType));this.SQe(this.oLb)}bIk(G,I){this.Sib.insert(0,new v(I.actionName,"",I.timeStamp,I.commandSurface,
I.Uu,I.contentType));this.SQe(this.Sib);this.Zcf.TPj(I.actionName)&&(this.lrc.insert(0,new v(I.actionName,"",I.timeStamp,I.commandSurface,I.Uu,I.contentType)),this.SQe(this.lrc))}static get instance(){return E.Ja||(E.Ja=new E)}}E.Ja=null;Object(J.a)(E,"CommandClickEventsCache",null,[])},695:function(J,V,d){function h(za,ka,qa,Ja){function xa(Ga){return Ga instanceof qa?Ga:new qa(function(na){na(Ga)})}return new (qa||(qa=Promise))(function(Ga,na){function sa(Za){try{cb(Ja.next(Za))}catch(va){na(va)}}
function Ha(Za){try{cb(Ja["throw"](Za))}catch(va){na(va)}}function cb(Za){Za.done?Ga(Za.value):xa(Za.value).then(sa,Ha)}cb((Ja=Ja.apply(za,ka||[])).next())})}d.r(V);J=d(0);var e=d(384),m=d(77),n=d(141),v=d(89),A=d(65),w=d(283),y=d(25),u=d(45),E=d(267),G=d(54),I=d(94),H=d(26),K=d(40),C=d(84),Y=d(926),M=d(918),P=d(916),T=d(919),L=d(920),aa=d(923),Q=d(924),ea=d(921),ia=d(917),ja=d(925),D=d(922),pa=d(55);class Z{createAuthProviderAsync(za){pa.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").D3a();
return new Promise(ka=>{pa.a.instance.La("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(qa=>{qa=qa.Fvi(za);ka(qa)})})}}Object(J.a)(Z,"SlideShowAppForOfficeAuthFactory",null,[]);var oa=d(972),Ba=d(71);d.d(V,"SlideShowCoreFrame",function(){return Ma});class Ma{constructor(za,ka,qa,Ja,xa,Ga,na,sa,Ha,cb,Za,va,Fa,Ca){this.Qm=this.K$b=this.h1c=null;this.Rca=new e.a;this.va=new m.a;this.Yqe="";this.vD=null;this.m4c="";this.Bpe=this.WHg=this.Dac=this.jQ=this.c9=this.b9=this.hta=this.K=null;this.Fac=
!0;this.mUa=Date.now();this.kUa=Date.now();this.w$a=this.tPg=0;this.lyb=!1;this.ujk=()=>{H.a.J(512309270,830,50,"SlideShowSwitcher::OnEditHappened");this.kUa=Date.now()};this.klk=()=>{H.a.J(512309269,830,50,"SlideShowSwitcher::OnLastMergeEditUTCChangedHandler");this.kUa=Date.now()};this.Ymk=()=>{H.a.J(512309268,830,50,"SlideShowSwitcher::OnRealTimeEditHandler");this.kUa=Date.now()};this.vf=za;this.la=ka;this.Dc=qa;this.kxb=Ja;this.vl=xa;this.Pb=Ga;this.rN=sa;this.Et=na;this.Nqe=Ha;this.fe=cb;this.REg=
Za;this.Ci=va;this.JN=Fa;this.Uv=Ca;this.o9j=n.a.getInstance();this.REg&&this.REg.execute(La=>{La.Ezc(this.ujk)});this.Ci&&(this.Ci.d3h(this.klk),this.Ci.W4h(this.Ymk));try{const La=this.O3=JSON.parse(this.la.Ha("Settings"))||{};La.slideshowcore||(La.slideshowcore={});La.slideshowcore&&La.slideshowcore.forceSvg&&"true"===La.slideshowcore.forceSvg.toString().toLowerCase()?this.Nqe=!0:this.Nqe&&(La.slideshowcore.forceSvg="True")}catch(La){H.a.J(512495906,830,15,"Exception in parsing settings:{0}",La),
this.O3={}}}preloadShaders(){this.IJe();this.igd();SlideShowCore.SlideShowCore.preloadShaders()}init(za,ka,qa,Ja){this.Yqe=qa;this.JN=Ja;this.m4c=ka;this.vD||(this.hta=document.getElementById("HiddenFocusTrapAnchor"),this.vD=document.createElement("div"),this.vD.id="SlideShowBackground",this.vD.className="SlideShowBackground",this.vD.style.visibility=Ba.a.Us,this.vD.tabIndex=-1,this.K=document.createElement("div"),this.K.id="SlideShowContainer",this.K.className="SlideShowContainer",this.K.tabIndex=
-1,this.K.style.width=window.screen.width+"px",this.K.style.height=window.screen.height+"px",v.a.addHandler(this.vD,A.a.Gua,xa=>{this.Plk(xa)}),w.a.instance.ob(this.vD,xa=>this.Hcb(xa)),this.vD.appendChild(this.K),K.a("PresenterCoachTabFix")&&this.hta?this.vf.insertBefore(this.vD,this.hta):this.vf.appendChild(this.vD),za=this.la.Ha("pptSlideShowCoreCssUrl"),ka=document.createElement("link"),ka.setAttribute("rel","stylesheet"),ka.setAttribute("type","text/css"),ka.setAttribute("href",za),this.K.appendChild(ka),
oa.a.instance.init(this.la,this.vD,this.Dc,this,this.vl,this.Pb,this.rN),this.b9=document.getElementById("slideshowBeginningFocusTrap"),this.c9=document.getElementById("slideshowEndFocusTrap"),this.b9||this.c9||(this.b9=document.createElement("div"),this.b9.id="slideshowBeginningFocusTrap",this.b9.className="FocusTrap",this.b9.tabIndex=0,v.a.addHandler(this.b9,A.a.focus,xa=>{this.Cdc(xa)}),this.c9=document.createElement("div"),this.c9.id="slideshowEndFocusTrap",this.c9.className="FocusTrap",this.c9.tabIndex=
0,v.a.addHandler(this.c9,A.a.focus,xa=>{this.Cdc(xa)}),K.a("PresenterCoachTabFix")&&this.hta?(this.vf.insertBefore(this.b9,this.vf.firstChild),this.vf.insertBefore(this.c9,this.hta.nextSibling)):(za=document.getElementById("slideshow-toolbar"),this.vf.insertBefore(this.b9,this.vD),this.vf.insertBefore(this.c9,za))),this.Fdg(1))}Fdg(za){const ka=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.JN),qa={"Content-Type":"application/json; charset=utf-8",
WaitForSessionTimeoutMs:"0"};qa["X-UserSessionId"]=y.AFrameworkApplication.userSessionId;const Ja=new Date;this.Uv.vj(ka,1,"",qa,!1,0,xa=>{this.ive(xa,Ja)},xa=>{this.hve(xa,za)},null,null)}ive(za,ka){H.a.J(512309283,830,50,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+ka);za=JSON.parse(za.data.Zd);this.jQ=za.downloadUrl;u.a.Va(this.jQ)?H.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",za):(this.mUa=
Date.now(),this.qwj())}mcg(){const za={};za.settings=this.O3;za.retryCount=this.la.Ec("GetItemsRetryCount",3);za.retryOnCategories=this.la.Ha("GetItemsRetryCategories").split(";");const ka={};ka.Slide=ResourceStrings.l_Slide;ka.AnimNum=ResourceStrings.l_AccSsAnimNum;ka.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;ka.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;ka.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;ka.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;
za.localizedStrings=ka;return za}qwj(){this.IJe();this.igd();this.h1c=new PodsProxy.PodsProxy(this.la.s6a?this.la.aMc:this.la.podsWebServiceBase,{DownloadUrl:this.jQ,DocID:y.AFrameworkApplication.Zg,CustomFontCatalogUrl:this.la.Ha("CustomFontCatalogURL")},this.la.YGa?u.a.uV(this.la.YGa).toLowerCase():"",this.Rca,this.Lbg(),this.Mbg());this.K$b=new SlideShowCore.DefaultResourceProviders(this.h1c,this.Rca,this.mcg());const za={};za.initTime=Ma.Q_b();za.uiHost="Unified App";za.serverUrl=u.a.Me(this.la.podsWebServiceBase);
za.userSessionId=this.Yqe;za.jsScriptsBasePath=this.la.Ha("StaticContentHost")+"pptscripts/ssapp/";za.fileHost=this.la.Ha("FileHost");za.isRtl=y.AFrameworkApplication.isRtl;za.applicationLcid=y.AFrameworkApplication.lcid;za.applicationLocaleName=y.AFrameworkApplication.uiCulture;za.areThirdPartyAddInsAllowed=y.AFrameworkApplication.ypa;za.theWsaClient=y.AFrameworkApplication.Zi;za.appForOfficeContextActivationParameters=Y.a.Tdg(this.fe);za.hubbleVideoEndpoint=this.la.insertOnlineVideoEndpoint;za.acceptLanguage=
E.a.le(y.AFrameworkApplication.lcid).name;this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.ModernSlideShowAddInSSO",!1)&&(za.appForOfficeAuthFactory=new Z);const ka={};ka.settings=this.O3;ka.transitionResourceCDNPath=this.la.XTf;ka.transitionDisabledList=this.la.mJa;ka.clickTargetEnabled=!0;ka.mediaEnabled=!0;ka.gifEnabled=!0;ka.convertGifToVideo=!0;ka.crossSlideAudioEnabled=!0;ka.editAudioEnabled=this.la.ka("PPTOAudioPlaybackOptionsEnabled");ka.flipgridVideoEnabled=this.la.ka("PptModernSlideShowFlipgridVideoEnabled");
ka.useNewYoutubePlayer=!0;ka.useNewVimeoPlayer=!0;ka.useOnlineVideoPlayer=!0;ka.tedVideoEnabled=this.la.ka("PptModernSlideShowTEDVideoEnabled");ka.isStream2Enabled=this.la.ka("IsStream2VideoEnabled");ka.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;ka.enableSVGAsWebGLTexture=!G.a.$f&&this.la.ka("SlideShowShapeBuilderSVGEnabled");ka.maxSvgTextureSize=this.la.Ec("ShapeBuilderMaxSvgTextureSize",2048);ka.enableSlideSizeAdjust=this.la.ka("EnableSlideSizeAdjust");ka.slideSizeMax={["x"]:this.la.Ec("SlideShowMaxWidth",
1504),["y"]:this.la.Ec("SlideShowMaxHeight",849)};ka.slideSizeMin={["x"]:this.la.Ec("SlideShowMinWidth",348),["y"]:this.la.Ec("SlideShowMinHeight",261)};ka.slideSizeDefault={["x"]:this.la.Ec("SlideShowDefaultWidth",1504),["y"]:this.la.Ec("SlideShowDefaultHeight",849)};ka.streamVideoUseThinEmbed=this.la.ka("StreamVideoUseThinEmbed");ka.slideMetadataEnabled=this.la.ka("PptModernSlideShowSlideMetadataEnabled");ka.disabledChangeGates=this.la.Ha("PPTDisabledChangeGates");ka.combineBootRequest=!0;ka.localVideoTelemetryEnabled=
this.la.ka("IsGFXVideoLocalTelemetryEnabled");ka.imageSettings={["imageAppendOption"]:"all"};const qa={["slideShowCoreSettings"]:ka,["appSettings"]:za};this.Qm=new SlideShowCore.SlideShowCore(this.K,this.K$b,this.Rca,qa);new SlideShowCore.PrefetchAddon(this.Qm,this.Rca,{["forwardPrefechCount"]:this.la.Ec("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.la.Ec("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.la.Ec("PptModernSlideShowForwardPrerenderCount",
2),["backwardPrerenderCount"]:this.la.Ec("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.Qm,this.Rca);this.tPg=Date.now();this.Bpe=this.Qm.init();this.Bpe.then(()=>{this.Fac=!1;this.WHg=new SlideShowCore.InputsAddon(this.Qm,this.K,y.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Qm,qa,this.Rca);new SlideShowCore.TransitionLoggerAddon(this.Qm,qa,this.Rca);new SlideShowCore.PerfCheckerAddon(this.Qm,qa,this.Rca);this.Dac=new SlideShowCore.SlideShowInkAddon(this.Qm,
this.Rca,this.K,()=>this.kxb.loadScript("slideshowink"),{["telemetryLogger"]:this.o9j});this.WHg.events.on("keydown",Ja=>{this.FGa(Ja)})});this.Qm.events.on("slideLocationChanged",()=>{this.Y7c()});this.Qm.events.on("animationStateChanged",()=>{this.Y7c()});this.Qm.events.on("slideDimensionsChanged",()=>{this.getCurrentSlideDimensions()});this.Qm.events.on("exitFromEndOfShow",()=>{this.Xue(!0)});this.Qm.events.on("blankSlideStateChanged",Ja=>{this.Ohk(Ja)});this.Qm.events.on("slideshowError",Ja=>
{this.X6c(Ja)})}Mbg(){const za={};za.timeout=this.la.Ec("PptModernSlideShowGetItemsTimeoutMs",3E4);za.throwHttpErrors=!1;za.enableServerSpecificErrorCode=K.a("SSCore.EnableServerSpecificErrorCode");return za}igd(){try{const za=this.O3;if(za.slideshowcore){const ka={};ka.settings=za;ka.logger=this.Rca;ka.disabledChangeGates=this.la.Ha("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(ka)}}catch(za){H.a.J(509703488,830,15,"Exception in passing settings to slideshowcore:{0}",
za)}}IJe(){try{const za=this.O3;if(za.podsproxy){const ka={};ka.settings=za;window.PodsProxy.setupGlobals_PodsProxy(ka)}}catch(za){H.a.J(512309267,830,15,"Exception in passing settings to podsproxy:{0}",za)}}iCh(za,ka){return h(this,void 0,void 0,function*(){this.IJe();this.igd();this.h1c=new PodsProxy.PodsProxy(this.la.s6a?this.la.aMc:this.la.podsWebServiceBase,{DownloadUrl:this.jQ,DocID:y.AFrameworkApplication.Zg,CustomFontCatalogUrl:this.la.Ha("CustomFontCatalogURL")},this.la.YGa?u.a.uV(this.la.YGa).toLowerCase():
"",this.Rca,this.Lbg(),this.Mbg());const qa=this.K$b;this.K$b=new SlideShowCore.DefaultResourceProviders(this.h1c,this.Rca,this.mcg());yield this.Qm.updateResourceProviders(this.K$b,{shouldRerenderSlide:!0});qa&&qa.dispose();H.a.J(593827098,830,50,"Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",za,ka,Date.now(),this.yvb())})}hve(za,ka){za=za.data?za.data.af:-1;0<ka--?(H.a.J(512309281,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
za),this.Fdg(ka)):H.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",za)}Phd(za,ka,qa,Ja,xa,Ga,na,sa,Ha){h(this,void 0,void 0,function*(){if(this.Qm&&!u.a.Va(this.jQ)){const cb={};this.kUa>this.mUa||this.Fac?(this.O3.slideshowcore.vetoBootDurationMs=this.la.Ec("PptModernSlideShowEditVetoBootDurationMs",8E3),cb.BootScenario=this.kUa>this.mUa?"AfterEdit":"Init",H.a.J(509703459,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",
this.la.Ec("PptModernSlideShowEditVetoBootDurationMs",8E3),this.kUa,this.mUa,this.Fac)):(this.O3.slideshowcore.vetoBootDurationMs=this.la.Ec("PptModernSlideShowCachedVetoBootDurationMs",2E3),cb.BootScenario="Relaunch",H.a.J(509703458,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.Ec("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.kUa,this.mUa,this.Fac));this.igd();this.kUa>this.mUa&&(yield this.jCh(1));
cb.startFromTime=Ha-window.performance.timing.navigationStart;cb.SSCoreFrameStartTime=Ma.Q_b();oa.a.instance.wOk();this.K.style.top="0";this.b9&&this.c9&&(this.b9.tabIndex=0,this.c9.tabIndex=0);const Za={["slideId"]:{["sid"]:za,["cid"]:0}};Za.slideIndex=ka-1;this.Et.C3b&&!this.Et.I7?this.Jki(Za,cb):this.q3f(Za,cb)}else H.a.J(512495901,830,15,"Failed to get download Url")})}prev(){this.Qm&&this.Qm.prevStep("0_anim").then(()=>{})}next(){this.Qm&&this.Qm.nextStep("0_anim",3).then(()=>{})}show(){this.wmc(!0)}yvb(){return this.vD&&
this.vD.style.visibility===Ba.a.Uy?!0:!1}u2(){return"Modern"}wmc(za){oa.a.instance.setVisibility(za&&this.Dc.Gh);za?(this.vD.style.visibility=Ba.a.Uy,$addHandler(window,"visibilitychange",ka=>{this.mWa(ka)})):(this.vD.style.visibility=Ba.a.Us,$removeHandler(window,"visibilitychange",ka=>{this.mWa(ka)}))}exit(){this.Xue(!1)}bKc(){this.Xue(!1)}transcribe(za,ka,qa,Ja,xa,Ga,na){const sa=!!this.Pb&&!!this.Pb.instance&&(this.Pb.instance.jPa||this.Pb.instance.Lq);(this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&
this.Pb.instance.eBa||sa)&&!this.Pb.instance.Qqb()?H.a.J(512495900,830,50,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(oa.a.instance.transcribe(za,ka,qa,Ja,xa,Ga,na),this.Dc.Gh&&this.Qm.recordSessionStats({["metadata"]:"subtitles"}),this.TRd())}q3f(za,ka){this.Qm.clearNavigationState();const qa={navigationType:"init"};qa.startFromTime=ka.startFromTime;ka.waitedForInit=this.Fac;ka.startInitTime=this.tPg;ka.beforeInitPromise=Ma.Q_b();this.Bpe.then(()=>{ka.afterInitPromise=
Ma.Q_b();qa.bootMetrics=ka;if(0>za.slideIndex)this.Qm.gotoFirstSlide(!0,qa).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)});else{const Ja={};Ja.actionContext=qa;Ja.fSkipTransition=!0;this.Qm.gotoSlide(za,Ja).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}})}Jki(za,ka){const qa=this.la.Ec("PptModernSlideShowCheckFullscreenCounter",10);let Ja=qa;this.w$a=
window.setInterval(()=>{Ja--;H.a.J(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",Ja);if(this.Et.I7||0>=Ja){window.clearInterval(this.w$a);this.w$a=0;const xa=20*(qa-Ja);ka.checkFullscreenMs=xa;H.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms.",xa);this.q3f(za,ka)}},20)}TRd(){let za=0,ka=100;this.Dc.Gh&&oa.a.instance.isVisible()&&("AboveSlide"===this.Dc.tv?(za=15,ka=85):"BelowSlide"===this.Dc.tv&&(ka=85));const qa=document.getElementById("LiveURLBarLayerHost");
this.lyb&&qa?(this.K.style.top=String.format("calc({0}% + {1})",za.toString(),"26px"),this.K.style.height=String.format("calc({0}% - {1})",ka.toString(),"26px")):(this.K.style.top=za.toString()+"%",this.K.style.height=ka.toString()+"%")}setMicrophoneState(za){oa.a.instance.setMicrophoneState(za)}xIb(za,ka=""){this.lyb=za;oa.a.instance.Ewh(za,ka);this.TRd()}toggleTranscriberUIVisibility(za){oa.a.instance.setVisibility(za);oa.a.instance.Yzc();this.TRd()}bQe(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}restoreFocus(){this.vD.style.visibility===Ba.a.Us||this.o8d()||this.K.focus()}pausePresentation(){}getCurrentPosition(){if(this.Qm){const za=this.Qm.getSlideLocation();za?this.va.raiseEvent("OnGetCurrentPosition",new T.a({["SlideId"]:za.slideId.sid,["SlideIndex"]:za.slideIndex})):H.a.J(512495897,830,15,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}getCurrentPositionWithTimeLines(){if(this.Qm){const za=this.Qm.getSlideLocation();if(za){const ka=this.Qm.getAnimationState(!0),
qa=ka.timelineStates,Ja=[];for(let xa=0;xa<qa.length;xa+=1)Ja.push({["TimeLineId"]:qa[xa].timelineId,["Step"]:qa[xa].step,["LastClickTime"]:qa[xa].lastClickTime,["StartTimeOffset"]:ka.startTimeOffset});this.va.raiseEvent("OnGetCurrentPosition",new T.a({["SlideId"]:za.slideId.sid,["SlideIndex"]:za.slideIndex,["TimeLineMappings"]:Ja}))}else H.a.J(512495896,830,15,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}getCurrentSlideDimensions(){if(this.Qm&&this.vD.style.visibility!==
Ba.a.Us){const za=document.getElementById(this.Nqe?"svg-canvas":"webgl-canvas");za&&this.va.raiseEvent("OnGetCurrentSlideDimensions",new L.a({["SlideHeight"]:za.offsetHeight,["SlideWidth"]:za.offsetWidth,["SlideLeftBound"]:za.offsetLeft,["SlideBottomBound"]:za.offsetTop+za.offsetHeight}))}}xQa(za){this.Qm&&this.Qm.gotoSlide({["slideIndex"]:za},{actionContext:{navigationType:"goto"},fSkipTransition:!1}).then(()=>{})}dgg(za,ka){if(this.Qm){const qa={},Ja=[];let xa=0;for(let Ga=0;Ga<ka.length;Ga+=1){const na=
{};na.timelineId=ka[Ga].TimeLineId;na.step=ka[Ga].Step;na.lastClickTime=ka[Ga].LastClickTime;xa=ka[Ga].StartTimeOffset;Ja.push(na)}qa.timelineStates=Ja;qa.startTimeOffset=xa;ka={actionContext:{navigationType:"goto"}};ka.animationState=qa;ka.fSkipTransition=!1;this.Qm.gotoSlide({["slideIndex"]:za},ka).then(()=>{})}}jCh(za){return h(this,void 0,void 0,function*(){H.a.J(512309260,830,50,"updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.JN);const ka=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.la.podsWebServiceBase,this.JN),qa={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};qa["X-UserSessionId"]=y.AFrameworkApplication.userSessionId;const Ja=new Date;return new Promise((xa,Ga)=>{this.Uv.vj(ka,1,"",qa,!1,0,na=>h(this,void 0,void 0,function*(){yield this.ykk(na,Ja);xa()}),na=>h(this,void 0,void 0,function*(){yield this.wkk(na,za);Ga()}),null,null)})})}ykk(za,ka){return h(this,void 0,void 0,function*(){const qa=new Date;H.a.J(512309279,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",
+qa-+ka);const Ja=JSON.parse(za.data.Zd);this.jQ=Ja.downloadUrl;u.a.Va(this.jQ)?H.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",Ja):(this.mUa=Date.now(),yield this.iCh(ka,qa))})}wkk(za,ka){return h(this,void 0,void 0,function*(){const qa=za.data?za.data.af:-1;0<ka--?(H.a.J(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
qa),yield this.jCh(ka)):H.a.J(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",qa)})}refreshPodSession(za,ka,qa=1){H.a.J(512309259,830,50,"RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.JN,za);this.JN=za;this.m4c=ka;za=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.JN);ka={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};ka["X-UserSessionId"]=
y.AFrameworkApplication.userSessionId;const Ja=new Date;this.Uv.vj(za,1,"",ka,!1,0,xa=>h(this,void 0,void 0,function*(){yield this.zkk(xa,Ja)}),xa=>h(this,void 0,void 0,function*(){yield this.xkk(xa,qa)}),null,null)}zkk(za,ka){return h(this,void 0,void 0,function*(){var qa=new Date;H.a.J(512309275,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",+qa-+ka);const Ja=JSON.parse(za.data.Zd);this.jQ=Ja.downloadUrl;u.a.Va(this.jQ)?(H.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",
Ja),this.yvb()&&(qa=C.a.Mh(413),y.AFrameworkApplication.Xo(qa),I.Health.instance.recordQosError(C.a.Qaa(qa),["SlideShowACE"],!1,!0,!0,!0,null),this.Qm&&this.Qm.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.mUa=Date.now(),yield this.iCh(ka,qa))})}xkk(za,ka){za=za.data?za.data.af:-1;0<ka--?(H.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
za),this.refreshPodSession(this.JN,this.m4c,ka)):(H.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",za),this.yvb()&&this.exit())}setVisibility(za){this.wmc(za)}zea(za){this.vD.style.cursor=za?"default":"none";oa.a.instance.zea(za)}setOsfLocalStorage(){}Iye(za){if(this.Dac)this.Dac.onInkManagerActivity(za)}FGa(za){this.rHe(za)}rHe(za){this.va.raiseEvent("OnSpecialKey",new ia.a({["Key"]:za.keyCode,["ShiftKey"]:za.shiftKey}))}zjh(){}Cdc(){this.vD&&
this.restoreFocus()}Lbg(){const za=new Map;za.set("X-UserSessionId",this.Yqe);za.set("X-WacNoAuth","1");za.set("X-WacCluster",this.m4c);za.set("Client","Unified App");this.la.g5i&&za.set("UseDocCache","True");return za}Xue(za=!1){this.w$a&&(H.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.w$a),window.clearInterval(this.w$a),this.w$a=0);this.Dac&&this.Dac.resetInkCanvas();this.b9&&this.c9&&(this.b9.tabIndex=-1,this.c9.tabIndex=-1);
if(this.Qm){const ka=this.Qm.getSlideLocation();this.Qm.endSession(Ma.Q_b());ka?this.va.raiseEvent("OnExit",new P.a({["SlideId"]:ka.slideId.sid,["IsBeforeReady"]:!1,["SlideIndex"]:ka.slideIndex,["IsFromEndOfSlideshow"]:za})):H.a.J(512495889,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")}this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";this.wmc(!1);oa.a.instance.rNe()}Y7c(){if(this.Qm&&this.vD.style.visibility!==Ba.a.Us){const za=
this.Qm.getSlideLocation();if(za){const ka=this.Qm.getAnimationState(!0),qa=ka.timelineStates,Ja=[];for(let xa=0;xa<qa.length;xa+=1)Ja.push({["TimeLineId"]:qa[xa].timelineId,["Step"]:qa[xa].step,["LastClickTime"]:qa[xa].lastClickTime,["StartTimeOffset"]:ka.startTimeOffset});this.va.raiseEvent("OnPositionChangeEventId",new Q.a({["SlideId"]:za.slideId.sid,["SlideIndex"]:za.slideIndex,["TimeLineMappings"]:Ja}))}else H.a.J(512495888,830,50,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}Ohk(za){if(this.Qm&&
this.vD.style.visibility!==Ba.a.Us)switch(za){case "Hidden":this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;case "EndOfShow":this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty);break;default:H.a.J(512495887,830,50,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",za)}}X6c(za){if(this.Qm){H.a.J(512495886,830,15,"SlideshowCoreFrame.OnErrorHandler {0}",za);let ka;za.startsWith("Server")&&(za="GetItemsRequestFailed");switch(za){case "GetItemsFailedDownloadFile":H.a.J(512495885,
830,50,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.JN);this.va.raiseEvent("OnPodSessionExpired",new aa.a({["Code"]:5341407,["Reason"]:"Failed To Download File",["PodSessionId"]:this.JN}));return;case "LoadFailed":ka=407;break;case "GetItemsFailedInvalidResponse":ka=408;break;case "GetItemsRequestFailed":ka=409;break;case "GetItemsTimeout":ka=411;break;case "EnsureSlideFailed":ka=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":ka=
414;break;default:ka=359}0!==ka&&(this.yvb()?(za=C.a.Mh(ka),y.AFrameworkApplication.Xo(za),I.Health.instance.recordQosError(C.a.Qaa(za),["SlideShowACE"],!1,!0,!0,!0,null),this.Qm.recordSessionStats({["errorName"]:C.a.Qaa(za)})):H.a.J(512495884,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",za))}}E8c(za){H.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.Qm&&this.vD.style.visibility!==Ba.a.Us&&this.va.raiseEvent("OnTranscriberStartedEventId",
new ja.a({["TranscriberSessionId"]:za}));this.Dc.Sqb=!0}mWa(){H.a.J(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.va.raiseEvent("OnVisibilityChangeEventId",new D.a(!1))}o8d(){return!!this.Pb&&!!this.Pb.instance&&this.Pb.instance.n1f}Izc(za){this.va.addHandler("OnSlideshowReady",za)}Bcd(za){this.va.removeHandler("OnSlideshowReady",za)}nGd(za){this.va.addHandler("OnBrowserEvent",za)}KDe(za){this.va.removeHandler("OnBrowserEvent",za)}BCf(za){this.va.addHandler("OnFullscreenClick",
za)}Xch(za){this.va.removeHandler("OnFullscreenClick",za)}pGd(za){this.va.addHandler("OnSlideshowContextMenu",za)}MDe(za){this.va.removeHandler("OnSlideshowContextMenu",za)}Jga(za){this.va.addHandler("OnExit",za)}fea(za){this.va.removeHandler("OnExit",za)}yCf(za){this.va.addHandler("OnSlideshowError",za)}Uch(za){this.va.removeHandler("OnSlideshowError",za)}Fzc(za){this.va.addHandler("OnGetCurrentSlideDimensions",za)}zcd(za){this.va.removeHandler("OnGetCurrentSlideDimensions",za)}PSb(za){this.va.addHandler("OnGetCurrentPosition",
za)}oeb(za){this.va.removeHandler("OnGetCurrentPosition",za)}Jzc(za){this.va.addHandler("OnSpecialKey",za)}Ccd(za){this.va.removeHandler("OnSpecialKey",za)}OCf(za){this.va.addHandler("OnVisibilityChangeEventId",za)}TDe(za){this.va.removeHandler("OnVisibilityChangeEventId",za)}tGd(za){this.va.addHandler("OnPodSessionExpired",za)}QDe(za){this.va.removeHandler("OnPodSessionExpired",za)}FCf(za){this.va.addHandler("OnLogEndOfTranscriptionSession",za)}Zch(za){this.va.removeHandler("OnLogEndOfTranscriptionSession",
za)}PMa(za){this.va.addHandler("OnPositionChangeEventId",za)}peb(za){this.va.removeHandler("OnPositionChangeEventId",za)}ECf(za){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",za)}Ych(za){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",za)}qGd(za){this.va.addHandler("OnEnterEndOfShowEventId",za)}NDe(za){this.va.removeHandler("OnEnterEndOfShowEventId",za)}sGd(za){this.va.addHandler("OnLeaveEndOfShowEventId",za)}PDe(za){this.va.removeHandler("OnLeaveEndOfShowEventId",za)}MCf(za){this.va.addHandler("OnSubtitleUpdatedEventId",
za)}fdh(za){this.va.removeHandler("OnSubtitleUpdatedEventId",za)}NCf(za){this.va.addHandler("OnTranscriberStartedEventId",za)}gdh(za){this.va.removeHandler("OnTranscriberStartedEventId",za)}VCf(za){this.va.addHandler("RecordQosErrorEventId",za)}odh(za){this.va.addHandler("RecordQosErrorEventId",za)}Plk(za){this.va.raiseEvent("OnBrowserEvent",new M.a({["ClientX"]:za.clientX,["ClientY"]:za.clientY}))}Hcb(za){this.va.raiseEvent("OnSlideshowContextMenu",new ea.a({["ClientX"]:za.clientPoint.x,["ClientY"]:za.clientPoint.y}));
return!0}static Q_b(){return Math.round(window.performance.now())}}Object(J.a)(Ma,"SlideShowCoreFrame",null,[924])},696:function(J,V,d){d.r(V);J=d(0);var h=d(701),e=d(25),m=d(45),n=d(54),v=d(113),A=d(1159),w=d(1160),y=d(22),u=d(323);const E=(L,aa)=>{if(L){L=L.trim().toLowerCase();if("true"===L)return!0;if("false"===L)return!1}return aa};var G=d(712),I=d(26),H=d(932),K;(function(L){L[L.none=0]="none";L[L.internal=1]="internal";L[L.clipService=2]="clipService"})(K||(K={}));Object(J.b)("ClipboardIframeContent",
K);var C=d(374),Y=d(662),M=d(432),P=d(47);d.d(V,"ClipboardHelper",function(){return T});class T{constructor(L,aa,Q,ea,ia,ja){this.OZj=[u.a.XY,u.a.Fp,u.a.location,u.a.jE,u.a.type,u.a.Gte,u.a.count,u.a.VCa,u.a.TCa,u.a.Tfb,u.a.slideId,u.a.sessionId,u.a.timeStamp,u.a.Qy];this.boe=new h.a;this.rne=new A.a(w.a.Qr());this.rq=L;this.dEg=aa;this.tc=ja;if(Q&&0<Q.length){L=Q.split(";");for(const D of L)L=this.Wag(D),0<L.length&&this.boe.add(L)}this.PZj=ea;this.G3j=ia;if(this.YSc()){ea=e.AFrameworkApplication.fa.Ha("PicklingAPIMaxPackageSizeInMB").split(";");
for(const D of ea)ea=D.split(":"),2===ea.length&&0<ea[0].length&&0<ea[1].length&&this.rne.add(ea[0],parseInt(ea[1]))}}Omd(L,aa,Q,ea,ia,ja,D){if(L.contentWindow&&L.contentWindow.document&&L.contentWindow.document.body){P.a.VCc(L);const Z=P.a.Saa();var pa=document.createTextNode(P.a.ete);Z.appendChild(pa);pa=null;let oa=0;if(!aa)I.a.J(512329178,826,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: internalClipboardObjects is empty for ccpCorrId: {0}",D),Sys.UI.DomElement.addCssClass(Z,P.a.HSd);
else if(aa.length&&aa[0]&&aa[0].L3a&&(Sys.UI.DomElement.addCssClass(Z,this.rq.Hq[0].L3a),oa=1,Q)){m.a.Va(Q.jE)&&I.a.J(512329177,307,10,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: DC was empty for the given ccpid: {0}",Q.Fp);oa=2;aa=G.a(Q.dataType);Z.setAttribute(u.a.XY,Q.XY);Z.setAttribute(u.a.SNa,Q.SNa);Z.setAttribute(u.a.Fp,Q.Fp);Z.setAttribute(u.a.version,Q.version);Z.setAttribute(u.a.location,Q.location);Z.setAttribute(u.a.jE,Q.jE);Z.setAttribute(u.a.type,aa);Z.setAttribute(u.a.count,
Q.objectCount.toString());Z.setAttribute(u.a.VCa,Q.VCa);Z.setAttribute(u.a.TCa,Q.TCa);Z.setAttribute(u.a.Qy,Q.Qy);const Ba=(new Date).toUTCString();I.a.J(512329176,307,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: A {0} cut/copy:{1} was performed at UTC Time: {2}",aa,Q.VCa,Ba);Z.setAttribute(u.a.timeStamp,Ba);if(1===Q.dataType||2===Q.dataType)aa=String.format("{0}GetClipboardBytes.ashx",e.AFrameworkApplication.fa.Ha("361"))+"?Id="+m.a.Me(Q.Fp)+"&DC="+m.a.Me(Q.jE)+"&pkey="+m.a.Me(Q.Qy)+
"&wdwaccluster="+m.a.Me(Q.jE)+"&DataType="+aa,Z.setAttribute(u.a.xni,aa);Q.Dcc&&Z.setAttribute(u.a.Gte,this.B_k(Q.Dcc));1===Q.dataType&&this.G3j&&(pa=P.a.CB(),pa.id=u.a.glg,pa.setAttribute(u.a.Iuj,"true"),Q=String.format("{0}GetClipboardImage.ashx",e.AFrameworkApplication.fa.Ha("361"))+"?Id="+m.a.Me(Q.Fp)+"&DC="+m.a.Me(Q.jE)+"&pkey="+m.a.Me(Q.Qy)+"&wdwaccluster="+m.a.Me(Q.jE),pa.src=Q)}Z.setAttribute(u.a.sessionId,ea);Z.setAttribute(u.a.Tfb,ia?ia.join(","):"");ja?Z.setAttribute(u.a.slideId,ja.cid.toString()+
"+"+ja.sid.toString()):Z.setAttribute(u.a.slideId,"");L.contentWindow.document.body.appendChild(Z);pa&&L.contentWindow.document.body.appendChild(pa);this.tc.Rh(C.a.Aui,K[oa],D)}}vKj(L){var aa="";n.a.Hj?aa="Chromium":n.a.$f?aa="Firefox":n.a.C4b&&(aa="Safari");aa=this.rne.Jb(aa)?this.rne.ga(aa):0;(aa=Math.ceil(L)<=aa)||I.a.J(512329175,307,15,"Package size exceeds for pickling paste browser:{0}, size:{1}",n.a.iy,L);return aa}nFj(L){return L&&Sys.UI.DomElement.containsCssClass(L,P.a.HSd)?!0:!1}qFj(L){return!!L&&
!!L.getAttribute&&E(L.getAttribute(u.a.TCa),!1)}IPj(L){return!!L&&!!L.Cm&&!!L.Cm.firstChild&&!!L.Cm.firstChild.className&&this.JPj(L.Cm.firstChild.className)}JPj(L){return!!L&&L.startsWith("CID")&&v.a.isValid(L.substring(3,L.length))}zPj(L){return!!L&&!!L.Fp&&!!L.jE&&0!==L.dataType&&0<L.objectCount&&!!L.Qy}L9k(L){if(!this.DBj(L))return I.a.J(512329174,307,50,"DC '{0}' is not allowed",L.jE),!1;if(L.Gqa&&"TimeStamp"in L.Gqa){var aa=new Date(Date.parse(L.Gqa.TimeStamp));L=60*this.PZj-5;aa=T.rKf(aa);
if(aa>=L)return I.a.J(512329173,307,50,"The data copied expired: expireTime: '{0}', elapsedTime: '{1}'.",L,aa),!1}return!0}Wag(L){return L?L.trim().toUpperCase():""}DBj(L){return!this.$7d(L)||this.boe.contains(this.Wag(L.jE))||this.boe.contains("ALL")}krg(L){return!!L&&!!L.tS&&!!L.tS.length&&!!L.tS[0]}lrg(L){return this.krg(L)&&Object(y.a)(M.a,L.tS[0])}vCj(L){return this.krg(L)&&Object(y.a)(Y.a,L.tS[0])}x7d(L){return!!L&&!!L.rt&&this.L9k(L.rt)}uCj(L){return this.x7d(L)&&1===L.rt.dataType}tCj(L){return this.x7d(L)&&
2===L.rt.dataType}sCj(L){return this.x7d(L)&&3===L.rt.dataType}wCj(L){return!!L&&!!L.VI}xCj(L){return this.wCj(L)&&1===L.VI.contentType}YSc(){return!(n.a.Kw||n.a.C4b)&&e.AFrameworkApplication.fa.ka("PicklingAPISlidePasteEnabled")}Fni(L,aa){if(L&&aa&&L.getAttribute)for(const Q of this.OZj){const ea=L.getAttribute(Q);ea&&aa.setAttribute(Q,ea)}}$7d(L){if(L.jE!==this.dEg)return I.a.J(512329172,307,50,String.format("IsCrossDCPaste: It's a cross-dc paste '{0}': from '{1}' to '{2}', {3}.",G.a(L.dataType),
L.jE,this.dEg,L.Fp)),!0;I.a.J(512329171,307,50,String.format("IsCrossDCPaste: It's a paste '{0}' in '{1}', {2}.",G.a(L.dataType),L.jE,L.Fp));return!1}$Ni(L,aa){var Q=L.getAttribute(u.a.Fp),ea=parseInt(L.getAttribute(u.a.version)),ia=L.getAttribute(u.a.Qy),ja=parseInt(L.getAttribute(u.a.XY)),D=parseInt(L.getAttribute(u.a.SNa)),pa=L.getAttribute(u.a.type);pa=pa?G.b(pa):2;var Z=Object,oa=Z.assign,Ba=new H.a;ja=isNaN(ja)?32:ja;D=isNaN(D)?0:D;ea=isNaN(ea)?0:ea;var Ma=L.getAttribute(u.a.location),za=L.getAttribute(u.a.jE),
ka=L.getAttribute(u.a.count);ka=parseInt(ka);Q=oa.call(Z,Ba,{XY:ja,SNa:D,Fp:Q,version:ea,location:Ma,jE:za,dataType:pa,objectCount:isNaN(ka)?-1:ka,VCa:E(L.getAttribute(u.a.VCa),!1),TCa:E(L.getAttribute(u.a.TCa),!1),Qy:ia});ia=T.gOi(L);pa=T.kOi(L);Q.Gqa={["SessionId"]:ia,["TimeStamp"]:pa?pa.toUTCString():""};aa=T.TJd(Q,pa,this.tc,aa);I.a.J(512329170,307,50,"ExtractClipboardObjectFromClipboard: {0}",aa);if(L=L.getAttribute(u.a.Gte))Q.Dcc=this.IEi(L);return Q}B_k(L){return JSON.stringify(L)}IEi(L){try{return JSON.parse(L)}catch(aa){return I.a.J(512329169,
826,15,"{0} when parse json string: {1}",aa.toString(),L),null}}static Drg(L){return L&&L.Gqa&&"SessionId"in L.Gqa?T.swg(L.Gqa.SessionId.toString()):!1}static swg(L){return m.a.Va(L)||m.a.Va(e.AFrameworkApplication.userSessionId)?!1:e.AFrameworkApplication.userSessionId.toLowerCase()===L.toLowerCase()}static TJd(L,aa,Q,ea){const ia=G.a(L.dataType);L=String.format("A {0} ClipServiceObject was just created: '{1}'",ia,L);aa&&(aa=T.rKf(aa),L+=String.format(", time elapsed between COPY and PASTE: {0} seconds.",
aa),Q.Rh("CopyPasteElapsedSec",aa.toString(),ea));return L}static gOi(L){L=L.getAttribute(u.a.sessionId);return void 0===L||null===L?"":L}static kOi(L){L=L.getAttribute(u.a.timeStamp);return void 0===L||null===L?null:new Date(Date.parse(L))}static rKf(L){var aa=new Date;if(!L)throw Error.argumentNull("fromTime");if(!aa)throw Error.argumentNull("toTime");return(aa.getTime()-L.getTime())/1E3}}Object(J.a)(T,"ClipboardHelper",null,[287])},710:function(J,V,d){J=d(0);var h=d(13),e=d(25),m=d(80),n=d(54),
v=d(113);class A{constructor(I,H){this.message=I;this.Ti=H}}Object(J.a)(A,"CrossDocumentEventArgs",null,[]);var w=d(520),y=d(170),u=d(562),E=d(900);d.d(V,"a",function(){return G});class G{constructor(I,H,K,C){this._name="";this.PJa={};this.Jdf=null;this.aQb=[];this.MMb=[];this.NMb=[];this.mPb=[];this.mwf=I;this.lwf=H;this.U5={};this.N$={};this.WOb=K;G._id++;C&&C();this.OF=this.enable()}get UIa(){return this.lwf}get gvh(){return this.mwf}enable(){if(!u.a())return E.a.sendTraceTag(5018251,2,"Not supported for current browser."),
!1;this.fAj();E.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.OF}fAj(){E.a.debugAssertTag(5018253,!!this.WOb,null);this.Jdf=Object(h.a)(this,this.Gck,"messageListener");this.WOb.V$h(this.Jdf)}disable(){this.OF=!1;this.aQb=[];this.MMb=[];this.NMb=[];this.mPb=[];this.mwf=null;this.lwf="";this.WOb.dFi();this.U5={};this.N$={}}dispose(){this.disable()}s9d(I){return!!this.aQb&&Array.contains(this.aQb,I)||this.Cug(I)}Cug(I){return!!this.MMb&&Array.contains(this.MMb,I)}Vt(I){E.a.debugAssertTag(5018259,
!!this.aQb,null);Array.add(this.aQb,I);E.a.sendTraceTag(5018260,2,"Allow receiving : {0}",I)}cAf(I){E.a.debugAssertTag(5018261,!!this.MMb,null);Array.add(this.MMb,I);E.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",I)}EIj(I){return!!this.NMb&&Array.contains(this.NMb,I)}dAf(I){E.a.debugAssertTag(5018263,!!this.NMb,null);Array.add(this.NMb,I);E.a.sendTraceTag(5018264,2,"Allow free sending: {0}",I)}d4b(I){I=m.a.lS(I);return!!I&&!!this.mPb&&Array.contains(this.mPb,I)}Tyc(I){E.a.debugAssertTag(5018265,
!!this.mPb,null);if(I===G.fTb)return E.a.debugAssertTag(5018266,!1,null),!1;const H=m.a.lS(I);if(!H)return E.a.sendTraceTag(5018267,4,"Get origin fail:{0}",I),!1;Array.add(this.mPb,H);E.a.sendTraceTag(5018268,2,"Add origin:{0}",H);return!0}send(I,H=null){let K=this.UIa;if(H){H=m.a.lS(H);if(!H)return!1;K=H}return this.ffb(I,this.gvh,K)}sendMessage(I,H,K=""){K=K&&""!==K?K:v.a.create().toString();return this.send(this.Zwe(I,H,K,e.AFrameworkApplication.userSessionId))}postMessage(I){const H=v.a.create().toString();
if(!e.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!I.shouldRetry)return this.send(this.Zwe(I.messageId,I.values,H,I.userSessionId));if(!this.U5[I.Dyc]){this.Vt(I.Dyc);const K=Object(h.a)(this,this.ackMessageHandler,"ackMessageHandler");this.ZA(I.Dyc,K)}this.PJa[H]="";return this.d5g(I,H,1)}d5g(I,H,K){if(""!==H&&H in this.PJa&&"ACK_RECEIVED"===this.PJa[H])return delete this.PJa[H],!0;if(K>I.Fua)return E.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',
I.Dyc,H),delete this.PJa[H],!1;E.a.sendTraceTag(40716251,1<K?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',I.Fua-K,I.messageId,H);K++;window.setTimeout(()=>{this.d5g(I,H,K)},I.CYh);I.values[y.a.BYh]=!0;return this.send(this.Zwe(I.messageId,I.values,H,I.userSessionId))}ackMessageHandler(I){I=I.CorrelationId;""!==I&&I in this.PJa&&(E.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.PJa[I],I),this.PJa[I]="ACK_RECEIVED")}Zwe(I,
H,K,C){I=new w.a(I);I.CorrelationId=K;H&&(I.Values=H);I.Values.wdUserSession=C;return I}ffb(I,H,K){E.a.debugAssertTag(5018269,!!I,null);if(!this.OF)return!1;E.a.debugAssertTag(5018270,!!H,null);E.a.debugAssertTag(5018271,!!K,null);if(!H||!K)return E.a.debugAssertTag(5018272,!1,null),!1;if(K===G.fTb&&!this.EIj(I.MessageId))return E.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:I.MessageId}),!1;I.SendTime=(new Date).getTime();let C="";try{C=Sys.Serialization.JavaScriptSerializer.serialize(I)}catch(Y){return E.a.sendTraceTag(5018274,
4,"JSON Ser failed {0}",{["Exception"]:Y.message}),!1}H=G.sendMessage(H,C,K);E.a.sendTraceTag(5018275,2,"Send {0}. {1}",H?"succeeded":"failed",{["id"]:I.MessageId,["origin"]:K});return H}ZA(I,H){E.a.debugAssertTag(5018304,!!H,null);E.a.debugAssertTag(5018305,!!this.U5&&!!this.N$,null);this.OF&&(this.s9d(I)?this.U5[I]!==H&&(E.a.debugAssertTag(5018307,!this.U5[I]&&!this.N$[I],null),this.U5[I]=H,delete this.N$[I]):E.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:I}))}WWa(I,H){E.a.debugAssertTag(40420062,
!!H,null);E.a.debugAssertTag(40420063,!!this.N$&&!!this.U5,null);this.OF&&(this.s9d(I)?this.N$[I]!==H&&(E.a.debugAssertTag(40420065,!this.U5[I]&&!this.N$[I],null),this.N$[I]=H,delete this.U5[I]):E.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:I}))}$rl(I){this.OF&&(this.U5[I]&&delete this.U5[I],this.N$[I]&&delete this.N$[I])}Gck(I){const H=this.Z6i(I);if(!H)return!1;if(this.U5[H.MessageId])return this.WOb.QQc(this.U5[H.MessageId],H),!0;if(this.N$[H.MessageId]){let K=this.N$[H.MessageId];
I=new A(H,I);this.WOb.OAj(K,I);return!0}return!1}Z6i(I){const H=new Date;this.kXj(I);if(!I.origin||!I.source||void 0===I.data||null===I.data)return E.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const K=this.HQj(I.data);if(!K)return null;if(!this.d4b(I.origin)){if(!this.Cug(K.MessageId))return E.a.sendTraceTag(5018309,1,"{0}",{["id"]:K.MessageId}),null;if(!n.a.r8a&&I.source!==this.gvh)return E.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),
null}E.a.debugAssertTag(5018311,!!K.Values,null);K.Values.m_Source=I.source;K.Values.m_Origin=I.origin;K.Values.m_ReceivedTime=H.getTime();return K}HQj(I){if(!I)return null;let H=null;try{H=Sys.Serialization.JavaScriptSerializer.deserialize(I,!0)}catch(Y){return 2>G.wZe&&(E.a.sendTraceTag(5018312,2,"Deser failed"),G.wZe++),null}if(!H)return E.a.debugAssertTag(5018313,!1,null),null;for(I=0;I<G.oFc.length;I++)if(!H[G.oFc[I]])return"MessageId"!==G.oFc[I]&&E.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",
G.oFc[I]),null;if(H.Values)try{H.Values}catch(Y){return E.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",Y.message),null}else E.a.sendTraceTag(41502556,2,"No values in message");I=H.MessageId;if(!this.s9d(I))return E.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:I}),null;const K=H.SendTime,C=(new Date).getTime()-K;if(0>K)return E.a.sendTraceTag(520435660,2,"{0}",{["t"]:K,["id"]:I}),null;if(6E4<C)return E.a.sendTraceTag(520435659,2,"{0}",{["t"]:K,["delta"]:C,["id"]:I}),null;-300>C&&E.a.sendTraceTag(520435658,
2,"{0}",{["t"]:K,["delta"]:C,["id"]:I});I=new w.a;I.MessageId=H.MessageId;I.SendTime=H.SendTime;I.CorrelationId=H.CorrelationId;H.Values&&(I.Values=H.Values);E.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",I.MessageId,I.SendTime,I.CorrelationId);return I}kXj(I){E.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:I.origin,["data"]:I.data,["source"]:I.source}))}static sendMessage(I,H,K){if(!u.a())return E.a.debugAssertTag(5018319,!1,
null),!1;try{return I.postMessage(H,K),!0}catch(C){E.a.sendTraceTag(5018320,4,"{0}",{["exception"]:C.message})}return!1}}G.oFc=["MessageId","SendTime"];G.fTb="*";G._id=0;G.wZe=0;Object(J.a)(G,"CrossDocumentMessenger",null,[106,726])},712:function(J,V,d){J=d(0);class h{}h.slideType="slide";h.shapeType="shape";h.Iob="chart";Object(J.a)(h,"ClipserviceDataConstants",null,[]);d.d(V,"b",function(){return e});d.d(V,"a",function(){return m});const e=n=>n===h.slideType?1:n===h.shapeType?2:n===h.Iob?3:0,m=
n=>1===n?h.slideType:2===n?h.shapeType:""},713:function(J,V,d){J=d(0);var h=d(17),e=d(45),m=d(826),n=d(236),v=d(256),A=d(223),w=d(485);class y{constructor(E,G){this.rXa=E;this.description=G}}Object(J.a)(y,"ColorEntry",null,[]);d.d(V,"a",function(){return u});class u{constructor(E){this.Bee={};this.Lpe=null;this.gm=E}get lgl(){if(!this.Lpe){const E=new Sys.StringBuilder;for(let G of this.standardColors)E.append(String.format(u.sKd,this.vwh(G.rXa),this.UPe(G.rXa),G.description));this.Lpe=E.toString()}return this.Lpe}get standardColors(){let E;
return E=new h.a,E.add(new y(12582912,ResourceStrings.L_FontColorDarkRed)),E.add(new y(16711680,ResourceStrings.L_FontColorRed)),E.add(new y(16760832,ResourceStrings.L_FontColorOrange)),E.add(new y(16776960,ResourceStrings.L_FontColorYellow)),E.add(new y(9621584,ResourceStrings.L_FontColorLightGreen)),E.add(new y(45136,ResourceStrings.L_FontColorDarkGreen)),E.add(new y(45296,ResourceStrings.L_FontColorLightBlue)),E.add(new y(28864,ResourceStrings.L_FontColorBlue)),E.add(new y(8288,ResourceStrings.L_FontColorDarkBlue)),
E.add(new y(7352480,ResourceStrings.L_FontColorPurple)),E}vwh(E){return String.format("#{0}",A.i(E))}UPe(E){return A.i(E)}rmc(E){return Object.assign(new v.a,{ThemeColor:E.ThemeColor,ColorLuminance:E.ColorLuminance,FTintColor:E.FTintColor}).toString()}$1d(E,G,I){const H=new Sys.StringBuilder;H.append(this.RJd("ThemeColors",ResourceStrings.L_ThemeFontColor,!0,E));this.J1h(H);H.append(this.QJd());H.append(this.RJd("StandardColors",ResourceStrings.L_StandardFontColor,!1,E));H.append(this.lgl);H.append(this.QJd());
G&&0<G.length&&(H.append(this.RJd("RecentColors",ResourceStrings.L_RecentColors,!1,I)),H.append(this.O$i(G)),H.append(this.QJd()));return H.toString()}O$i(E){const G=new Sys.StringBuilder;for(let I=0;I<E.length;I++){const H=E[I];G.append(String.format(u.sKd,"#"+H.hex,H.hex,"#"+H.hex))}return G.toString()}RJd(E,G,I,H){return String.format(u.Ofi,E,G,"ColorPicker",I?'McuLayout = "true" ':"",H)}QJd(){return u.Nfi}J1h(E){const G=Array(10);G[0]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Background1));
G[1]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Text1));G[2]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Background2));G[3]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Text2));G[4]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Accent1));G[5]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Accent2));G[6]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Accent3));G[7]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Accent4));G[8]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Accent5));
G[9]=this.oK(n.Color.Oi(this.gm.PresetSchemeColorMapping.Accent6));const I=Array(10);I[0]=ResourceStrings.l_ThemeLabel1;I[1]=ResourceStrings.l_ThemeLabel2;I[2]=ResourceStrings.l_ThemeLabel3;I[3]=ResourceStrings.l_ThemeLabel4;I[4]=ResourceStrings.l_ThemeLabel5;I[5]=ResourceStrings.l_ThemeLabel6;I[6]=ResourceStrings.l_ThemeLabel7;I[7]=ResourceStrings.l_ThemeLabel8;I[8]=ResourceStrings.l_ThemeLabel9;I[9]=ResourceStrings.l_ThemeLabel10;for(let H=0;5>=H;H++)for(let K=0;K<G.length;K++)E.append(this.nWi(G[K][H],
G[K][0],I[K],H,K))}oK(E){const G=e.a.Gv(E.r,2)+e.a.Gv(E.g,2)+e.a.Gv(E.b,2);if(this.Bee[G])return this.Bee[G];const I=w.a.yPa(E),H=[];Array.add(H,E);if(E.mUd())for(var K=0;K<m.a.$Dh.length;++K)E=w.a.LZb(I),E.darken(m.a.$Dh[K]/100),Array.add(H,E.vra());else if(E.EOi())for(K=0;K<m.a.GHf.length;++K)E=w.a.LZb(I),E.lighten(m.a.GHf[K]/100),Array.add(H,E.vra());else if(I.lum<u.yfi)for(K=0;K<m.a.IBg.length;++K)E=w.a.LZb(I),E.lighten(m.a.IBg[K]/100),Array.add(H,E.vra());else if(I.lum>u.xfi)for(K=0;K<m.a.HBg.length;++K)E=
w.a.LZb(I),E.darken(m.a.HBg[K]/100),Array.add(H,E.vra());else for(K=0;K<m.a.zDc.length+m.a.zOf.length;++K)E=w.a.LZb(I),K<m.a.zDc.length?E.lighten(m.a.zDc[K]/100):E.darken(m.a.zOf[K-m.a.zDc.length]/100),Array.add(H,E.vra());return this.Bee[G]=H}nWi(E,G,I,H,K){E=this.UPe(E.rXa);({xDc:G,CIb:I}=this.JXd(G,E,I,H,K));return String.format(u.sKd,G,E,I)}JXd(E,G,I,H,K){var C;var Y=C=null;if(0>H)return{xDc:C,CIb:Y};G=Object.assign(new v.a,{RGBColor:G,ThemeColor:K,ColorLuminance:0,FTintColor:!1});H?(K=w.a.yPa(E),
Y=H-1,K.lum?1===K.lum?(H=!1,Y=[242,217,191,166,127][Y]):.8<K.lum?(H=!1,Y=[229,191,127,64,25][Y]):.2>K.lum?(H=!0,Y=[25,64,127,191,229][Y]):(K=[51,102,153],C=[191,127],Y=(H=Y<K.length)?K[Y]:C[Y-K.length]):(H=!0,Y=[127,166,191,217,242][Y]),Y=255-Y,Y=Math.round(100*Y/255),G.ColorLuminance=100-Y,G.FTintColor=H,Y=String.format(H?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,E.toString(),I,Y)):Y=String.format(ResourceStrings.l_ColorPickerTooltipBase,E.toString(),I);C=
this.rmc(G);return{xDc:C,CIb:Y}}}u.Ofi='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';u.Nfi="</Colors></ColorPicker></Controls></MenuSection>";u.sKd='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';u.yfi=.2;u.xfi=.8;Object(J.a)(u,"ColorPickerBuilder",null,[])},714:function(J,V,d){var h=d(113),e=d(54),m=d(80),n=d(25),v=d(33),A=d(85),w=d(27),y=d(324),u=d(26),E=d(938);J=d(0);class G{constructor(){this.Oy=this.onSuccess=
this.kue=this.UGd=this.$4g=null}}Object(J.a)(G,"UploadFileDialogData",null,[]);var I=d(66);d.d(V,"a",function(){return H});d.d(V,"b",function(){return K});const H=(P,T,L,aa)=>{const Q=String.format("{0}{1}",L,h.a.create().toString());return Object.assign(new G,{UGd:M(Q,aa),$4g:Y(L,aa),kue:(ea,ia)=>{ia.blockContent(ea,"Insert Media")},onSuccess:(ea,ia,ja,D,pa,Z)=>{T(P,Q,ia,ja,pa,Z)},Oy:(ea,ia,ja,D,pa)=>{ja.QP(ia)&&u.a.J(509727823,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+ia.Wpa);ja.vO(ia);ia=null;try{const Z=v.a(ea);ia=Z?Z.Error:null}catch(Z){u.a.J(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",ea)}ia||(ia=Object.assign(new y.a,{Code:444}));pa&&(pa.finish(),pa=null);u.a.J(509727821,822,10,"Upload media failed");C(D,pa,ia.Code,null)}})},K=(P,T,L,aa)=>new Promise((Q,ea)=>{const ia=new E.a(aa);u.a.J(509727828,822,50,"Media File details: Number of media files: {0}, media file extension: {1}, media file size: {2}",
P&&P.value?P.files.length:0,E.a.zYd(P),E.a.o9f(P));L&&L.Wa("MediaFileValidationStarts",String.format("Number of media files: {0}, media file extension: {1}, media file size: {2}",P&&P.value?P.files.length:0,E.a.zYd(P),E.a.o9f(P)));if(P&&P.value&&P.value.length)if(ia.Nyl(P.value)){var ja=P.files[0];ia.Oyl(ja.size)?ia.Pki(ja).then(D=>{D?(L&&L.Wa("MediaFileValidationPassedOnUI","true"),Q(!0)):(C(T,L,443,[ia.pVa.join(", ")]),ea(443))},()=>{u.a.J(509727825,822,10,"Invalid media file");C(T,L,443,[ia.pVa.join(", ")]);
ea(443)}):(u.a.J(509727826,822,10,"Media::Insert:Invalid media file size:{0}",ja.size),C(T,L,442,["16"]),ea(442))}else u.a.J(509727827,822,10,"Media::Insert:Invalid media file type:{0}",E.a.zYd(P)),C(T,L,441,[ia.pVa.join(", ")]),ea(441);else C(T,L,440,null),ea(440)}),C=(P,T,L,aa)=>{T&&T.finish();P.qG(L,Q=>{Q.xB=1;Q.ePa=aa;return!1})},Y=(P,T)=>{let L="MediaUpload.ashx";if(w.App.webServiceBase)L=w.App.webServiceBase+L;else if(e.a.$f||e.a.xsa)L=m.a.wBa(L);let aa="";switch(P){case "audio":aa="audio";
break;case "captions":aa="captions";break;default:u.a.J(509727824,822,10,"Media::GetMediaUploadEndpoint: file type not supported")}L+=String.format("?MediaType={0}&{1}&{2}&{3}",aa,n.AFrameworkApplication.pQa(),T.presentationId.string,n.AFrameworkApplication.a_b());T.podSessionId&&(L+=String.format("&{0}={1}",A.a.H9,T.podSessionId));T.Wj&&(L+=String.format("&waccluster={0}",T.Wj));return L},M=(P,T)=>{const L=new I.a;L.$("PresentationId",T.presentationId.string);L.$(A.a.Jla,T.sessionInfo);L.$("Canary",
n.AFrameworkApplication.canary);L.$("access_token",n.AFrameworkApplication.accessToken);L.$("MediaToken",P);return L}},887:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.bte="TraceIdNoBar";h.fVc="TraceIdLeftBar";h.Idd="TraceIdRightBar";h.kBc="TraceIdBothBar";Object(J.a)(h,"ConsistencyCheckTraceIdType",null,[])},888:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(509);class e{constructor(){this.start=new h.a;this.end=new h.a}clone(){return Object.assign(new e,{start:this.start.clone(),
end:this.end.clone()})}merge(m){let n=!1;m.start&&(n=this.start.merge(m.start));m.end&&(n=this.end.merge(m.end)||n);return n}}Object(J.a)(e,"TextNodeSelection",null,[])},889:function(J,V,d){d.d(V,"a",function(){return 19})},890:function(J,V,d){d.r(V);d.d(V,"WordPredictionAugLoopResponseManager",function(){return u});J=d(0);V=d(17);var h=d(343),e=d(891),m=d(644),n=d(642),v=d(643),A=d(539),w=d(61),y=d(31);class u{p1b(E){u.WR.wF(()=>{this.O8k(E)||(this.yQe(E),this.Jwl(),this.o9h())},"WPT:PR")}o9h(){const E=
A.a.aD.t4,G=A.a.aD.ydb;if(E){var I=w.a.instance.Oa.kb;if(I&&I.Te&&A.a.urg(I.Te)){I=I.Te.node;var H=y.ParagraphReader.text(I);H=H.substring(E.Ted,H.length);I=this.ZYd(I,E,H);"string"===typeof I?I.length?(E.p7=I,E.iHb+=1,A.a.NHd(E.text,I),this.Pvl(),E.mxe=H,this.Ovl(E)):G&&0===G[m.a.status]?(this.yBh(),A.a.gdd()):this.$wl():(this.yBh(),A.a.gdd())}}}Ovl(E){u.lnd.count>=u.$Ph&&u.lnd.removeAt(0);u.lnd.add(this.Eni(E))}Eni(E){return Object.assign(new e.a,{id:E.id,ywa:E.ywa,Zw:E.Zw,Ted:E.Ted,text:E.text,
p7:E.p7,NUb:E.NUb,z3a:E.z3a,score:E.score,iQe:E.iQe,hQe:E.hQe,yO:E.yO,iHb:E.iHb,mxe:E.mxe})}O8k(E){if(E&&E.parentPath&&7===E.parentPath.length){const G=E.parentPath[6];A.a.zWa.add(G,v.a.qHd,(new Date).getTime());A.a.aVj(G)}else return A.a.U5b(v.a.JSd),!0;return A.a.XRa?(E=this.cfg(E),E=this.Y5g(E[0]),E[m.a.status]=5,A.a.IVd(E),A.a.U5b(v.a.drh),!0):!1}yQe(E){(E=this.cfg(E))&&E.length?(A.a.aD.t4=E[0],A.a.aD.Jwh=E.length,A.a.aD.ydb=this.Y5g(E[0])):(A.a.gdd(),A.a.U5b(v.a.JSd))}cfg(E){if(!E||!E.items||
!E.parentPath||7!==E.parentPath.length)return null;var G=E.items[0];let I;try{I=G.body}catch(M){return null}G=E.parentPath[2];const H=parseInt(E.parentPath[3]),K=parseInt(E.parentPath[4]),C=E.parentPath[5];E=E.parentPath[6];if(!I.predictions.length)return null;A.a.n3k(I.modelInfo);const Y=Array(I.predictions.length);for(let M=0;M<I.predictions.length;M++){const P=I.predictions[M];if(P.text){const T=P.characterRange,L=P.tokenRange;Y[M]=Object.assign(new e.a,{id:C,ywa:E,Zw:G,Ted:H,text:P.text,p7:P.text.substr(T.start),
NUb:T.start,z3a:T.length,score:P.score,iQe:L.start,hQe:L.length,yO:K,iHb:0})}}return Y}Y5g(E){const G={};G[m.a.language]="en-US";const I=A.a.n7i();G[m.a.modelId]=I.modelId;G[m.a.modelVersion]=I.modelVersion;G[m.a.configId]=I.configId;G[m.a.DLd]=E.z3a;G[m.a.ECc]=E.z3a;G[m.a.Myg]=E.p7.length;G[m.a.Q5g]=E.text.length;G[m.a.T5g]=E.text.split(" ").length;G[m.a.score]=E.score;G[m.a.status]=0;G[m.a.NRe]=E.p7.length;G[m.a.yO]=E.yO;E=A.a.zWa.ga(E.ywa);G[m.a.mwh]=E[v.a.qHd]-E[v.a.Kkc];G[m.a.Mjd]=0;return G}Jwl(){const E=
A.a.aD.t4;E&&(A.a.zsa(E.yO,n.a.CLf,A.a.aD.Jwh),A.a.zsa(E.yO,n.a.ATf,E.z3a))}Pvl(){const E=A.a.aD.t4,G=A.a.aD.ydb;if(E&&1===E.iHb){const I=(new Date).getTime();A.a.zWa.ulg(E.ywa,v.a.lEf,I);A.a.IAg(E.ywa,!0);A.a.U5b(v.a.S5g);const H=A.a.zWa.ga(E.ywa)[v.a.Kkc];G[m.a.Mjd]=I-H;G[m.a.status]=1;G[m.a.ECc]=E.text.length-E.p7.length;A.a.zsa(E.yO,n.a.Eih,1);A.a.zsa(E.yO,n.a.beh,1);A.a.zsa(E.yO,n.a.ceh,E.p7.length);A.a.zsa(E.yO,n.a.BTf,E.text.length-E.p7.length);A.a.Yyk()}}$wl(){const E=A.a.aD.t4,G=A.a.aD.ydb;
E&&(G[m.a.status]=3,G[m.a.ECc]=0,G[m.a.NRe]=E.text.length-G[m.a.DLd],A.a.IVd(G),A.a.zsa(E.yO,n.a.kzh,1),A.a.zsa(E.yO,n.a.DTf,E.score),A.a.zsa(E.yO,n.a.lzh,E.text.length-E.z3a),A.a.gdd())}yBh(){const E=A.a.aD.t4,G=A.a.aD.ydb;if(E){if(0===G[m.a.status]){const I=(new Date).getTime();A.a.zWa.ulg(E.ywa,v.a.jEf,I);A.a.IAg(E.ywa,!1);A.a.U5b(v.a.R5g);const H=A.a.zWa.ga(E.ywa)[v.a.Kkc];G[m.a.Mjd]=I-H;A.a.zsa(E.yO,n.a.TUg,1);G[m.a.status]=6}A.a.IVd(G)}}ZYd(E,G,I){let H=null;G.Zw===E.id.toString()&&I&&G.NUb<
I.length&&(E=I.substring(0,G.NUb)+G.text,E=E.replace(RegExp("\\u00a0","g")," "),I=I.replace(RegExp("\\u00a0","g")," "),0<E.length&&0<I.length&&(E.indexOf(I)||(H=E.substring(I.length,E.length))));return H}static get WR(){return h.a.instance}}u.$Ph=4;u.lnd=new V.a;Object(J.a)(u,"WordPredictionAugLoopResponseManager",null,[])},891:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Zw=this.ywa=this.id=null;this.yO=this.Ted=0;this.p7=this.text=null;this.iHb=this.hQe=this.iQe=
this.score=this.z3a=this.NUb=0;this.mxe=null}}Object(J.a)(h,"Candidate",null,[])},892:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.stateUpdateHandler=this.handler=this.config=this.annotationType=null}}Object(J.a)(h,"ActivateAnnotationParameters",null,[])},893:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(597);var h=d(127);class e extends V.a{constructor(){super();this.tokenRange=this.predictions=this.modelInfo=this.characterRange=null;this.H_=Object.assign(new h.a,
{T_:e.getTypeName(),B_:e.kl()})}static getTypeName(){return"AugLoop_Text_TextPredictionAnnotation"}static kl(){return["AugLoop_Core_Annotation"]}}Object(J.a)(e,"TextPredictionAnnotation",V.a,[])},894:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.operation=null}}Object(J.a)(h,"SubmitOperationParameters",null,[])},895:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(254);var h=d(127);class e extends V.a{constructor(){super();this.timestamp=this.targetObject=
null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.kl()})}static getTypeName(){return"AugLoop_Signals_Signal"}static kl(){return[]}}Object(J.a)(e,"Signal",V.a,[])},896:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m,n){super();this.actionId=e;this.Lub=m;this.revisionId=n}}Object(J.a)(h,"UndoRedoMarkedUndoEventArgs",Sys.EventArgs,[])},897:function(J,V,d){d.d(V,"c",function(){return v});d.d(V,"b",function(){return A});d.d(V,"a",function(){return w});
var h=d(17),e=d(375),m=d(25),n=d(33);const v=y=>{if(!y)return null;let u;try{u=n.b(y)}catch(E){u=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",E)}return u},A=(y,u)=>{let E=[];if(y.breadcrumbs&&0<y.breadcrumbs.length)E=y.breadcrumbs;else{const G=y.service_info;G&&G.friendly_service_name&&Array.add(E,G.friendly_service_name);y.display_path&&Array.addRange(E,y.display_path)}return E.join(u?" \u00ab ":" \u200f\u00bb ")},w=(y,u=!1)=>{if(!y)return[];
if(!y.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!y.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];y=y.documents.items;const E=new h.a;for(let I=0;I<y.length;I++){const H=y[I];var G=H.web_url;if(!G){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!H.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}G=String.format("{0}?web=1",H.url)}const K={};K.DocumentUrl=G;K.MruId=H.mru_id;{G=H;let C=G.title;
C?(G.extension&&(C=String.format("{0}.{1}",C,G.extension)),G=C):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),G="")}K.FileName=G;K.IsPinned=H.is_pinned;K.Path=A(H,m.AFrameworkApplication.isRtl);u&&(K.App=H.app,K.TimeStamp=H.time_stamp);E.add(K)}return E.toArray()}},898:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(375),e=d(985),m=d(1158),n=d(13),v=d(17),A=d(36),w=d(40);class y{constructor(u,E,G,I,H,K,C,Y,M){this.FQ=new e.a;this.UMg=u;this.Sb=E;this.MK=H;this.Ea=G;this.Xd=
K;this.u6b=C;this.Gl=I;this.Vh=Y;this.la=M;this.dwj()}get qe(){return this.Xd.instance}get GE(){return this.u6b.value}dwj(){this.FQ.$(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.FQ.$(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.FQ.$(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.FQ.$(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.FQ.$(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);
this.FQ.$(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.FQ.$(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.FQ.$(11,[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.FQ.$(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.FQ.$(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.FQ.$(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.FQ.$(6,[ResourceStrings.l_PhTypeFooter,
ResourceStrings.l_ClickToAddFooter]);this.FQ.$(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber])}fdg(u,E){u&&(this.Fba(u,E),u.nsa?E.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.N_d(u,null,E));return null}ncj(u){if(!this.UMg.instance||!u)return null;u=this.UMg.instance.kdg(u);if(!u||!u.length)return null;const E=u.length;return 1===E?String.format(ResourceStrings.l_ShapePresenceForOneUser,u[0].userName):2===E?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,
u[0].userName,u[1].userName):3===E?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,u[0].userName,u[1].userName,u[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,E)}y1d(u){let E="";u&&u.NV&&u.image.title&&0<u.image.title.length&&(E=u.image.title);u&&(E=String.format(ResourceStrings.l_ThumbnailInfoNew,u.slideIndex+1,this.Sb.Nj(),E),u=this.Efj(u),0<u.length&&(E+=u));return E}Efj(u){const E=new Sys.StringBuilder;u.isSelected&&E.append(ResourceStrings.L_SlideIsSelected);
u.En&&E.append(ResourceStrings.l_SlideIsHidden);const G=Object(m.a)(123,u.Nd);if(G){var I=G.dQa();I&&!this.Gl.B9d(I)&&E.append(ResourceStrings.l_SlideHasNotes);(I=G.PE())&&this.MK.instance&&this.MK.instance.Gig(I)&&(I=this.MK.instance.OXd(I),E.append(1===I?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,I)))}u.A2&&E.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(u.BDb&&(u=u.BDb.gia())&&0<u.length)if(1===u.length)E.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,
u[0].userName));else{I="";for(const H of u)I+=H.userName+",";E.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,I))}G&&G.isUnread&&E.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return E.toString()}w6a(u,E){return String.format(ResourceStrings.l_MultipleSlidesSelected,u,E)}p1i(u,E){return String.format(ResourceStrings.l_DesignerSuggestionSelected,u+1,E)}Ocj(){return ResourceStrings.l_SlidePanel}E7i(){return ResourceStrings.l_MultipleShapes}CLk(u){u&&(this.la.w3a&&
u.x4(Object(n.a)(this,this.VYi,"getCameoAccMessage")),u.x4(Object(n.a)(this,this.Aej,"getTableAccMessage")),u.x4(Object(n.a)(this,this.u4i,"getImageAccMessage")),u.x4(Object(n.a)(this,this.O6i,"getMediaAccMessage")),u.x4(Object(n.a)(this,this.kZi,"getChartAccMessage")),this.Hgd?(u.x4(Object(n.a)(this,this.Cdg,"getSmartArtAccMessage")),u.x4(Object(n.a)(this,this.N_d,"getPlaceHolderAccMessage"))):(u.x4(Object(n.a)(this,this.N_d,"getPlaceHolderAccMessage")),u.x4(Object(n.a)(this,this.Cdg,"getSmartArtAccMessage"))),
u.x4(Object(n.a)(this,this.sfj,"getTextboxAccMessage")),u.x4(Object(n.a)(this,this.bcj,"getShapeGroupAccMessage")),u.x4(Object(n.a)(this,this.Zbj,"getShapeAccMessage")),u.x4(Object(n.a)(this,this.cXi,"getAddinAccMessage")),u.x4(Object(n.a)(this,this.HWi,"get3DAccMessage")))}N_d(u,E,G,I=null){if(u&&G&&u.al&&(this.DNc(u,G),E=u.get_altTitle(),this.FQ.Jb(u.zj))){I&&I(String.format("{0} {1}",this.FQ.ga(u.zj)[0],ResourceStrings.l_Placeholder));if(u.BS||!G.count){G=this.FQ.ga(u.zj)[0];I="";if(!this.Hgd||
u.BS)I=this.FQ.ga(u.zj)[1];return String.format(u.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,G,E,I,u.get_alt())}u=String.format(u.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,this.FQ.ga(u.zj)[0],E,u.get_alt());G.insert(0,document.createTextNode(u))}return null}sfj(u,E,G,I=null){if(u&&G&&u.wy)if(this.DNc(u,G),I&&I(ResourceStrings.L_TextBox),0<G.count)u=String.format(u.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:
ResourceStrings.l_AccMessageTextboxHasText,u.get_altTitle(),u.get_alt()),G.insert(0,document.createTextNode(u));else return String.format(u.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,u.get_altTitle(),u.get_alt());return null}Cdg(u,E,G,I=null){if(u&&G&&u.Qf)if(this.DNc(u,G),I&&I(ResourceStrings.L_SmartArt),0<G.count)u=String.format(u.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,this.Edg(u)||
"",u.get_altTitle(),u.get_alt()),G.insert(0,document.createTextNode(u));else return String.format(u.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.Edg(u)||"",u.get_altTitle(),u.get_alt());return null}Fba(u,E){u&&E&&this.Ea.WI(u,G=>{G.Sa(A.a.Zp)&&this.O$f(G,E)})}DNc(u,E){if(u&&E){const G=this.Hgd?new v.a:E;let I=!1;this.Ea.WI(u,H=>{const K=this.Vh.MV(H),C=this.Vh.fdb(H);K&&G.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,
C)));I=this.O$f(H,G)||I});this.Hgd&&I&&E.addRange(G);E.count||(u=u.kPe)&&E.add(document.createTextNode(u))}}get Hgd(){return w.a("AriaMessageHelper.FixAccMessageForEmptyList")}O$f(u,E){let G;const I=u.sa(A.a.Ylc,null),H=u.sa(A.a.Zp,"");if(H&&E){if(I){let K=0,C=null,Y;for(let M=0;M<I.length+1;M++)Y=this.Ea.bMc(u,M),C&&C!==Y&&(G=document.createElement("span"),G.setAttribute("lang",C),G.innerText=H.substring(K,I[M-1]),K=I[M-1],E.add(G)),C=Y;G=document.createElement("span");C&&G.setAttribute("lang",C);
G.innerText=H.substring(K,H.length)}else G=document.createElement("span"),(u=this.Ea.bMc(u,0))&&G.setAttribute("lang",u),G.innerText=H;E.add(G)}return!!H&&0<H.length}Aej(u,E,G,I=null){return u&&u.nd?(I&&I(ResourceStrings.L_Table),String.format(u.get_alt()?ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,u.get_altTitle(),u.get_alt())):null}u4i(u,E,G,I=null){return u&&u.qk?(I&&I(ResourceStrings.l_Image),String.format(u.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,
u.get_altTitle(),u.get_alt())):null}VYi(u,E,G,I=null){if(!u||!u.cDa)return null;I&&I(ResourceStrings.l_Cameo);return u.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,u.get_altTitle(),u.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,u.get_altTitle(),ResourceStrings.l_CameoLearnMoreMessage)}O6i(u,E,G,I=null){if(u){if(0===u.mediaType)return null;if(1===u.mediaType)return I&&I(ResourceStrings.l_Audio),this.la.eP?String.format(ResourceStrings.l_AccMessageCanvasAudio,
u.shapeName):String.format(u.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,u.get_altTitle(),u.get_alt());if(2===u.mediaType)return I&&I(ResourceStrings.l_Video),String.format(u.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,u.get_altTitle(),u.get_alt())}return null}kZi(u,E,G,I=null){return u&&u.Pq?(I&&I(ResourceStrings.l_Chart),String.format(u.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.lZi(u)||
"",u.get_altTitle(),u.get_alt())):null}bcj(u,E,G,I=null){return u&&u.Mf?(I&&I(ResourceStrings.L_GroupObjects),w.a("GroupShapeAltTitleFixEnabled")?String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,u.py().length,u.get_alt()):String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,u.get_altTitle(),u.get_alt())):null}Zbj(u,E,G,I=null){if(u&&G&&u.nsa&&!u.wy)if(this.DNc(u,G),E=this.Ea.mdg(u),u.RCa&&
(E=ResourceStrings.l_DecorativeLabel),I&&I(E||ResourceStrings.l_TextShape),0<G.count)u=String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,E||ResourceStrings.l_TextShape,u.get_altTitle(),u.get_alt()),G.insert(0,document.createTextNode(u));else return String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,E||ResourceStrings.l_TextShape,u.get_altTitle(),u.get_alt());return null}cXi(u,E,G,
I=null){return u&&u.Nq&&this.qe&&this.GE?(u=this.GE.N1(u),u=this.qe.xrb(u.id),I&&I(u?u.Oga:null),u?u.Oga:null):null}HWi(u,E,G,I=null){return u&&u.A7?(I&&I(ResourceStrings.l_3DModel),String.format(u.get_alt()?ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,u.get_altTitle(),u.get_alt())):null}Edg(u){return u.smartArtInfo?y.B0d(u.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(h.ULS.sendTraceTag(588375196,815,10,"SmartArt {0}#{1} has no SmartArtInfo",u.slideId?u.slideId.toString():"",
u.get_shapeId()),null)}lZi(u){return y.B0d(u.Iob,0,102,"L_ChartType")}ocj(u,E){return(u=this.Ea.UMc(u))&&E?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,E,u):null}static rfj(u){return y.B0d(u,1,177,"L_SAType")}static B0d(u,E,G,I){return u>=E&&u<=G&&(u=ResourceStrings[I+u])?u:null}}Object(J.a)(y,"AriaMessageHelper",null,[882])},899:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m=null,n=null,v=null,A=!1,w=null){this.DisplayName=this.ClientId=this.Provider=
this.UserId=null;this.IsAnonymous=!1;this.Email=null;this.UserId=e;this.Provider=m;this.DisplayName=n;this.Email=v;this.IsAnonymous=A;this.ClientId=w}}Object(J.a)(h,"Person",null,[])},900:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{static r_k(){}static RCi(){}}h.sendTraceTag=h.r_k;h.debugAssertTag=h.RCi;Object(J.a)(h,"BULS",null,[])},901:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(977),e=d(25),m=d(163),n=d(55);class v{constructor(A,w,y,u,E,G){this.daa=A;this.eaa=
w;this.std=y;this.BO=u;this.Aqc=E;this.uib=G}get Wph(){return!this.eaa&&!this.std}get KVg(){return 2===this.uib?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get R_f(){return CommonUIStrings.l_OICErrorMessageNoOffice}get wkg(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get $Qa(){return CommonUIStrings.l_OICErrorHelpLink}get Ajg(){return"OICFailure"}get icon(){return 3}get Lzf(){return 2===this.uib?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:
CommonUIStrings.l_OICErrorC2RInstallButton}get xOa(){return CommonUIStrings.l_DefaultDialogTitle}jHk(A){this.VVg(A)}wSj(A){this.VVg(A)}VVg(A){let w=10;1===A?(n.a.instance.resolve("Common.IOfficeTrialExperience").pbe(this.uib),w=3):2===A&&((!this.std||this.std(this.BO))&&this.eaa&&h.a.instance.Lyi(this.eaa,this.daa,this.BO),w=5);(0===A||1===A)&&this.daa&&this.daa(this.BO);e.AFrameworkApplication.zeb(m.a.B1g,this.Aqc,w);this.dispose()}dispose(){this.BO=this.eaa=this.daa=null}}Object(J.a)(v,"AOICErrorDialogWithTrial",
null,[106])},902:function(J,V,d){d.d(V,"b",function(){return n});d.d(V,"g",function(){return v});d.d(V,"d",function(){return A});d.d(V,"f",function(){return y});d.d(V,"e",function(){return u});d.d(V,"c",function(){return E});d.d(V,"a",function(){return G});var h=d(25);d(699);var e=d(1076),m=d(514);d(463);const n=()=>h.AFrameworkApplication.isEmbedded,v=()=>{const I=h.AFrameworkApplication.Aa.gb.iN;return!n()&&!h.AFrameworkApplication.hideHeader&&m.a()&&(I||1===h.AFrameworkApplication.IUi)},A=()=>
h.AFrameworkApplication.fa.ka("DiscoverPremiumButtonEnabled"),w=()=>h.AFrameworkApplication.Zoh&&!n()&&!h.AFrameworkApplication.hideHeader,y=()=>w()&&"officecomhwa"!==(h.AFrameworkApplication.fa.Ha(h.AFrameworkApplication.oJ)||"").toLowerCase()&&!h.AFrameworkApplication.Ejg,u=()=>!h.AFrameworkApplication.X3d&&w(),E=()=>!n()&&!h.AFrameworkApplication.hideHeader&&h.AFrameworkApplication.fa.ka("BasicChatIsEnabled"),G=()=>{if(h.AFrameworkApplication.Xjg)return null;var I=!!h.AFrameworkApplication.Aa&&
h.AFrameworkApplication.Aa.gb.iN;if((h.AFrameworkApplication.o$d&&h.AFrameworkApplication.cXa||h.AFrameworkApplication.znc)&&I)return Object.assign(new e.a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:d(262).CuiHelper.Vcd});if(h.AFrameworkApplication.workflowEnabled){I="";switch(h.AFrameworkApplication.$nc){case "Assign":I=CommonUIStrings.l_Assign;break;case "Submit":I=CommonUIStrings.l_Submit}if(""!==I)return Object.assign(new e.a,{command:"2988588587",label:I,id:"btnWorkflow"})}return null}},
903:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"RibbonPeripheralSection",null,[])},904:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.isForAlertableKpi=this.extendedProperties=null}}Object(J.a)(h,"IKpiUsageOptionalProperties",null,[])},905:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.kpiName=null;this.kpiType=0;this.blockFutureEmissionDurationInMs=this.optionalProperties=null}}Object(J.a)(h,
"KpiUsageParams",null,[])},906:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.vetoPillar=this.crewAlias=this.featureName=this.topLevelKpiName=null}}Object(J.a)(h,"FeatureUsageAndHealthConfig",null,[])},907:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=
this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}Object(J.a)(h,"CalloutParameters",null,[])},908:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"ICalloutProps",null,[])},909:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.IsFreeForm="IsFreeForm";h.Value="Value";h.Key="Key";h.FontStyle="FontStyle";Object(J.a)(h,"ComboBoxCommandProperties",null,[])},910:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{}h.Alt="Alt";h.CommandValueId="CommandValueId";h.InnerHTML="InnerHTML";h.On="On";h.IsRtl="IsRtl";h.GalleryButtonProps="GalleryButtonProps";h.Text="Text";h.HighlightOn="HighlightOn";Object(J.a)(h,"GalleryButtonCommandProperties",null,[])},911:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"PersonaInfo",null,[])},912:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"PersonaIdentifiers",null,[])},913:function(J,V,d){d.d(V,"a",
function(){return h});J=d(0);class h{constructor(e){this.Wm=e}PWd(e){const m=[];if(e)for(let A in e){var n=A,v=e[A];const w=this.Wm.uYd(n);if(w)for(let y of w)m.push(appChrome.actions.updateControlHiddenState(y,v));else if(n=this.Wm.T3i(n))for(const y of n)if(y.externalUxCommandIds)for(const u of y.externalUxCommandIds)m.push(appChrome.actions.updateControlHiddenState(u,v));else m.push(appChrome.actions.updateGroupHiddenState(y.externalUxGroupId,v))}return m}SWi(e){const m=[];if(e)for(let n in e){if(!e[n])continue;
const v=n;v&&m.push(appChrome.actions.deactivateRibbonTab(v))}return m}}Object(J.a)(h,"ReactRibbonTrimmingHelper",null,[])},914:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(J.a)(h,"InsightsParameters",null,[])},915:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.cUf="data-ccp-timestamp";h.dUf="data-clipservice-ccpid";h.hUf="data-shapeids";h.ggg="docs-internal-guid-";h.m1g="SCXO";
h.p5g="SCXP";h.iEh="SCXW";h.aUg="MsoListParagraphCxSpFirst";h.bUg="MsoListParagraphCxSpLast";Object(J.a)(h,"HtmlContentMetadataConstants",null,[])},916:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.BCj=e.IsBeforeReady;this.tGj=e.IsFromEndOfSlideshow;this.summary=e.Summary}}Object(J.a)(h,"OnExitSlideshowEventArgs",Sys.EventArgs,[])},917:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.key=e.Key;this.shiftKey=e.ShiftKey}}Object(J.a)(h,"OnSpecialKeyEventArgs",Sys.EventArgs,[])},918:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(J.a)(h,"OnBrowserEventArgs",Sys.EventArgs,[])},919:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;
this.slideIndex=e.SlideIndex;this.pmc=e.TimeLineMappings}}Object(J.a)(h,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[])},920:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideHeight=e.SlideHeight;this.slideWidth=e.SlideWidth;this.jrh=e.SlideLeftBound;this.grh=e.SlideBottomBound}}Object(J.a)(h,"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[])},921:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(J.a)(h,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[])},922:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.isVisible=e.IsVisible}}Object(J.a)(h,"OnVisibilityChangeEventArgs",Sys.EventArgs,[])},923:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.code=e.Code;this.reason=e.Reason;this.podSessionId=e.PodSessionId}}
Object(J.a)(h,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[])},924:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.pmc=e.TimeLineMappings}}Object(J.a)(h,"OnPositionChangedEventArgs",Sys.EventArgs,[])},925:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(1158);class e extends Sys.EventArgs{constructor(m){super();this.Zwh=null;this.Zwh="string"===typeof m?Object(h.a)(String,
m):m.TranscriberSessionId}}Object(J.a)(e,"OnTranscriberStartedEventArgs",Sys.EventArgs,[])},926:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(375),e=d(267),m=d(25),n=d(169),v=d(54),A=d(45),w=d(259);class y{static Tdg(u){const E={};E.appSettings=y.yvi();E.singleSignOnSettings=y.tdg();E.appVersion="16";E.appUILocale=e.a.le(m.AFrameworkApplication.lcid).krb;E.dataLocale=e.a.le(m.AFrameworkApplication.lcid).krb;E.osfOmexBaseUrl=m.AFrameworkApplication.fa.Ha("50");E.firstPartyManifestCDNUrl=
m.AFrameworkApplication.fa.Ha("565");E.sdxCdnUrl=m.AFrameworkApplication.fa.Ha("649");E.sdxDmsUrl=m.AFrameworkApplication.fa.Ha("650");E.sdxAssetsToPrefetchMapping=m.AFrameworkApplication.fa.Ha("974");E.docUrl=u?u.documentUrl:"";E.pageBaseUrl=n.a.pO;E.lcid=m.AFrameworkApplication.lcid.toString();E.allowExternalMarketplace=m.AFrameworkApplication.fa.ka("51");E.localizedScriptsUrl=n.a.pO+m.AFrameworkApplication.fa.Ha("52");u=u?u.Skg:"";E.localizedImagesUrl=n.a.pO+u;E.localizedStylesUrl=n.a.pO+u;E.localizedResourcesUrl=
n.a.tYh(u);E.enableAddinCommands=m.AFrameworkApplication.fa.ka("203");E.enableMyApps=m.AFrameworkApplication.fa.ka("186");E.enableMyOrg=m.AFrameworkApplication.fa.ka("187");E.enableUploadFileDevCatalog=m.AFrameworkApplication.fa.ka("203")&&!m.AFrameworkApplication.fa.ka("847");E.enableDevCatalog=m.AFrameworkApplication.fa.ka("221");E.devCatalogUrl=m.AFrameworkApplication.fa.Ha("220");E.enablePrivateCatalog=m.AFrameworkApplication.fa.ka("305");E.showSignOutFromPrivateCatalogMessage=m.AFrameworkApplication.fa.ka("307");
E.enableBlackForestRedirect=m.AFrameworkApplication.fa.ka("348");E.enableSingleSignOnForAddin=m.AFrameworkApplication.fa.ka("342")&&m.AFrameworkApplication.bCj;E.enableTaskpaneUpgradeToAppCommand=m.AFrameworkApplication.fa.ka("381");E.hideAppsExtensionUrl=m.AFrameworkApplication.hideAppsExtensionUrl;E.enableAnonymousUseLegacyCatalogService=m.AFrameworkApplication.fa.ka("549");E.enableInsertDialogAccessibilityFix=m.AFrameworkApplication.fa.ka("584");E.enableFirstPartySDXErrorMessages=m.AFrameworkApplication.fa.ka("677");
E.disableAppsForOfficeThirdParty=m.AFrameworkApplication.fa.ka("569");E.wacSessionId=m.AFrameworkApplication.userSessionId;E.disableLogging=!m.AFrameworkApplication.fa.ka("AriaLoggingIsEnabled");E.loggableUserId=m.AFrameworkApplication.fa.Ha("LoggableUserId");E.sessionStartInfoJson=m.AFrameworkApplication.fa.Ha("SessionStartInfoJson");E.wopiHostOriginFromPostMessage=m.AFrameworkApplication.wopiHostOriginFromPostMessage;E.wopiHostOriginFromWacPropBag=m.AFrameworkApplication.fa.Ha("PostMessageOrigin");
E.wacIsEmbedded=m.AFrameworkApplication.fa.ka("IsEmbedded");E.accessibilityAllowFocusAddinTaskpane=m.AFrameworkApplication.fa.ka("1055");E.disableMicrophonePermission=v.a.jN(1)&&m.AFrameworkApplication.fa.ka("TranscriberSafariEnabled")&&m.AFrameworkApplication.fa.ka("RehearsalSafariEnabled");E.isHostFrameTrustCheckEnabledForAddIns=m.AFrameworkApplication.fa.ka("1100");E.isHostFrameTrusted=m.AFrameworkApplication.isHostFrameTrusted;E.hostAllowedSdxEmbedding=m.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");
E.hostAllowedOfficeStore=m.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");E.hostInstallAddIns=m.AFrameworkApplication.fa.Ha("HostInstallAddIns");E.hostInstallAddInsIsEnabled=m.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");E.approvedAddIns=m.AFrameworkApplication.fa.Ha("ApprovedAddIns");E.isUpnCheckEnabled=m.AFrameworkApplication.fa.ka("1132");E.wacUpn=m.AFrameworkApplication.fa.Ha("UserPrincipalName");E.isReactRibbonEnabled=!0;E.enableSetFocusOnTaskpaneOnUserAction=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",
!1);E.enableMyOrg&&E.docUrl&&(u=E.docUrl.split("/"),E.spBaseUrl=2<u.length?u[0]+"//"+u[2]:null,E.spBaseUrl||h.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",E.docUrl)));E.userNameHashCode=A.a.zM(m.AFrameworkApplication.userName);E.envCode=m.AFrameworkApplication.fa.Ec("312",0).toString();return E}static yvi(){const u={};u.AddinRibbonIdAllowUnknown=m.AFrameworkApplication.fa.ka("AddinRibbonIdAllowUnknown");u.AddinRibbonNativeGroupControlIsEnabled=!0;u.AddinRibbonTabAutoFocusIsEnabled=
!0;u.AddinRibbonTabPositionIsEnabled=!0;u.AgaveAddinUploadEnabled=m.AFrameworkApplication.fa.ka("AgaveAddinUploadEnabled");u.DevConsoleEnabled=m.AFrameworkApplication.fa.ka("AddinDevConsoleLog");u.ManifestParserDevConsoleEnabled=!0;u.flightingTreatmentVariables=m.AFrameworkApplication.fa.qJc;return u}static tdg(){try{const u={};v.a.xDa&&w.a.u7a&&(u.UiHostSupportsAuthTokenAddinList=y.lJc);u.UiHostSupportsAuthToken=w.a.u7a;return u}catch(u){h.ULS.sendTraceTag(512263001,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",
u.message)}return null}}y.lJc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");Object(J.a)(y,"AppForOfficeHelper",null,[])},927:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.yUg=e}}Object(J.a)(h,"CoauthorStatusChangedEventArgs",Sys.EventArgs,[])},928:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,
m,n){this.oVa={};this.nMg=e;this.Nke=m;this.N8b=n}fCa(e,m,n,v){m=h.GUf;if(this.Nke)if(this.N8b){const A=e.UserId?e.UserId.toLowerCase():null;n=n?n.toLowerCase():null;m=A&&A in this.oVa?this.oVa[A]:n&&n in this.oVa?this.oVa[n]:this.nMg.fCa(e,v);!A||A in this.oVa||(this.oVa[A]=m);!n||n in this.oVa||(this.oVa[n]=m)}else m=this.nMg.fCa(e,v);return m}}h.GUf="#C0C0C0";Object(J.a)(h,"PresenceColorProvider",null,[355])},929:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.fJ=e}}Object(J.a)(h,"BeforeSessionEndEventArgs",Sys.EventArgs,[])},930:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(1107),e=d(25),m=d(33),n=d(80);class v{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}HFb(){return m.c([this.Ik(),this])}execute(A,w,y){let u="RoamingAppsHandler.ashx";h.a.instance.zFe&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(u=n.a.ej(u,"wdEnableRoaming","1"));e.AFrameworkApplication.He.vj(u,2,this.HFb(),{"Content-Type":"application/json; charset=utf-8"},
!1,this.wsb(),A,w,y,void 0,void 0,void 0,void 0,"6")}}Object(J.a)(v,"ARoamingAppsRequest",null,[])},931:function(J,V,d){d.d(V,"a",function(){return 2});d.d(V,"c",function(){return h});d.d(V,"b",function(){return e});const h=(m,n,v=2)=>{let A;if(0>n||n>m[m.length-1])throw Error.argumentOutOfRange("y");A=!0;let w=0,y;const u=m.length-1;for(y=0;y<u;y++){const E=w;w=m[y+1];if(n<w){w-n<v&&y<u-1?y++:n-E>=v&&(A=!1);break}}return{returnValue:y<u?y:-1,H9d:A}},e=(m,n,v=2)=>{let A;if(0>n||n>m[m.length-1])throw Error.argumentOutOfRange("x");
A=!0;let w=0,y;const u=m.length-1;for(y=0;y<u;y++){const E=w;w=m[y+1];if(n<w){w-n<v&&y<u-1?y++:n-E>=v&&(A=!1);break}}return{returnValue:y<u?y:-1,H9d:A}}},932:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.SNa=this.XY=0;this.skipUndo=!1;this.Fp=this.selectionSlide=null;this.version=0;this.jE=this.location=null;this.dataType=0;this.Dcc=null;this.objectCount=0;this.TCa=this.VCa=!1;this.Qy=this.Gqa=this.nodes=null}toString(){const e=JSON.stringify(this.Gqa);return String.format("CcpId:{0}, version:{1}, DC:{2}, DataType:{3}, ObjectCount:{4}, Cut?:{5}, IsEPH?:{6}, ExtraData:[{7}], CopyStatus: {8}.",
this.Fp,this.version,this.jE,this.dataType,this.objectCount,this.VCa,this.TCa,e,this.XY)}}Object(J.a)(h,"ClipServiceObject",null,[])},933:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(375),e=d(95);class m{static xfd(n,v,A){if(n&&A&&(e.a.Xza(n),v&&""!==v))try{const w=m.tKh.parseFromString(v,"text/html");if(w&&w.body){const y=w.body.childNodes;for(v=0;v<y.length;v+=1)n.appendChild(y[v].cloneNode(!0))}}catch(w){h.ULS.sendTraceTag(523106530,324,10,"In class: {0}, unable to parse HTML, {1}",
A,w.message)}}}m.tKh=new DOMParser;Object(J.a)(m,"DOMParserHelper",null,[])},934:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(13),e=d(72),m=d(65),n=d(131);class v extends Sys.UI.Control{constructor(A,w,y,u){super(document.createElement("div"));this.D5=this.B5=this.lE=this.o_a=this.oR=this.ZJa=this.JLa=null;this.XMb=this.LKa=!1;this.content=this.lB=null;this.w$=0;this.tHf=null;this.MY=0;this.m8c=null;this.kwf=A;this.Xkb=w;this.OO=y;this.zMd=u;this.Xh=w.ownerDocument;this.K1b=this.hr=
this.FNb=!1}get RI(){this.JLa||(this.JLa=this.Xh.createElement("div"),this.JLa.id=this.hi("WACCalloutOuter"),this.JLa.className="WACCalloutOuter",this.JLa.setAttribute(n.a.We,n.a.zId),this.JLa.style.width=this.w$+"px");return this.JLa}get Inb(){if(!this.ZJa){this.ZJa=this.Xh.createElement("div");this.ZJa.id=this.hi("WACCalloutBeakContainer");this.ZJa.className="WACCalloutBeakContainer";var A="CalloutBeakTopFilled_32x16x32";if(5===this.MY||6===this.MY||4===this.MY)A="CalloutBeakBottomFilled_32x16x32";
A=e.createClusteredImage(32,16,A,"WACCalloutBeak",!0,"");this.ZJa.appendChild(A)}return this.ZJa}set Inb(A){this.ZJa=A}get AK(){return this.FNb}get title(){return this.lB}set title(A){this.lB!==A&&(this.lB=A,this.B5&&(this.B5.innerText=this.lB))}get hr(){return this.LKa}set hr(A){this.LKa!==A&&(this.LKa=A,this.oR&&(this.oR.contains(this.lE)&&!this.LKa?this.oR.removeChild(this.lE):!this.oR.contains(this.lE)&&this.LKa&&this.oAf()))}get K1b(){return this.XMb}set K1b(A){this.XMb!==A&&(this.XMb=A,this.oR&&
(this.oR.contains(this.B5)&&!this.XMb?this.oR.removeChild(this.B5):!this.oR.contains(this.B5)&&this.XMb&&this.PBf()))}show(){this.FNb||(this.Hwi(),this.T$h(),this.Xkb.appendChild(this.RI),this.RI.style.display="Block",this.$Ie(),this.FNb=!0,this.m8c&&this.m8c())}dismiss(){this.FNb&&(this.bFi(),this.Xkb.removeChild(this.RI),this.FNb=!1,this.zMd&&this.zMd())}dispose(){this.dismiss();this.B5=this.lE=this.o_a=this.ZJa=this.oR=this.JLa=null;Sys.Component.prototype.dispose.call(this)}hi(A){return this.get_element().id+
A}Hwi(){this.oR=this.Xh.createElement("div");this.oR.id=this.hi("WACCalloutHeader");this.oR.className="WACCalloutHeader";this.hr&&this.oAf();this.K1b&&this.PBf();this.o_a=this.Xh.createElement("div");this.o_a.id=this.hi("WACCalloutContent");this.o_a.className="WACCalloutContent";this.o_a.style.width=190<this.w$?this.w$-26+"px":"164px";this.o_a.appendChild(this.content);this.RI.appendChild(this.Inb);this.RI.appendChild(this.oR);this.RI.appendChild(this.o_a)}oAf(){this.lE=this.Xh.createElement("a");
this.lE.className="WACCalloutCloseAnchor";this.lE.id=this.hi("WACCalloutCloseAnchor");this.lE.href="#";this.oR.appendChild(this.lE);const A=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.lE.appendChild(A)}PBf(){this.B5=this.Xh.createElement("div");this.B5.className="WACCalloutTitle UIFontBold";this.B5.style.width=190<this.w$?this.w$-30+"px":"160px";this.B5.id=this.hi("WACCalloutTitle");this.B5.innerText=this.title;this.oR.contains(this.lE)?
this.oR.insertBefore(this.B5,this.lE):this.oR.appendChild(this.B5)}$Ie(){var A=this.kwf;let w;if(1===this.MY){var y=this.tHf.y+16;w=-16}else 2===this.MY||3===this.MY||0===this.MY?(y=A.y+A.height+15,w=-15):(y=A.y-this.RI.clientHeight-15-2,w=this.RI.clientHeight-1);this.RI.style.top=y+"px";this.Inb.style.top=w+"px";1===this.MY?(A=this.tHf.x-16,this.RI.style.left="50%",this.RI.style.marginLeft=-this.w$/2+"px",y=Sys.UI.DomElement.getBounds(this.RI),this.Inb.style.left=A-y.x+"px"):(y=A.x+this.kwf.width/
2,2===this.MY||5===this.MY?(A=20,y-=36):0===this.MY||4===this.MY?(A=this.w$/2-16,y-=this.w$/2):(A=this.w$-20-32,y=y-this.w$+36),this.RI.style.left=y+"px",this.Inb.style.left=A+"px")}T$h(){this.hr&&!this.D5&&(this.D5=Object(h.a)(this,this.I1,"closeHandler"),this.OO.ob(m.a.click,this.lE,this.D5,null))}bFi(){this.hr&&this.D5&&(this.OO.xb(m.a.click,this.lE,this.D5),this.D5=null)}I1(){this.dismiss();return!0}}Object(J.a)(v,"Callout",Sys.UI.Control,[831])},935:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{constructor(e){this.e8j=e}get rkc(){return this.e8j}}Object(J.a)(h,"ShowHideNotesData",null,[])},936:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(873);class h extends d.a{constructor(e,m){super(m);this.cLg=e;this.Z$a=0}w1f(){const e=(new Date).getTime(),m=e-this.Z$a;if(0<this.Z$a&&0>=this.cLg-m)return this.Z$a=0,this.hLd(),!0;this.Z$a=e;this.hLd();this.setTimeout(this.cLg);return!1}}Object(J.a)(h,"FunctionDelayer",d.a,[])},937:function(J,V,d){d.d(V,"b",function(){return e});
d.d(V,"a",function(){return m});d.d(V,"c",function(){return n});var h=d(45);d(388);d(27);d(57);const e=(v,A)=>{const w=[];if(v.length!==A.length)return w;for(let y=0;y<v.length;y++){const u={};u.key=A[y];u.text=v[y];u.type="AppComboBoxItem";w[y]=u}return w},m=(v,A,w,y,u)=>({["unitType"]:v,["unitPlaceholder"]:h.a.nye(A),["minValue"]:w,["maxValue"]:y,["step"]:u}),n=v=>"1.00"===v?1:"1.50"===v?1.5:"2.00"===v?2:0},938:function(J,V,d){d.d(V,"a",function(){return n});J=d(0);var h=d(45),e=d(89),m=d(26);class n{constructor(v){this.pVa=
null;this.o0c=0;this.d8b=v;switch(this.d8b){case "audio":this.pVa=n.i$j;this.o0c=n.rZj;break;case "captions":this.pVa=n.j$j;this.o0c=n.IZj;break;case "video":this.pVa=n.k$j;this.o0c=n.r$j;break;default:m.a.J(509727835,822,10,"Invalid file type")}}static set zyl(v){n.k$j=v}static set uzl(v){n.r$j=v}Pki(v){switch(this.d8b){case "audio":return n.Nki(v);case "captions":return n.Oki(v);case "video":return n.Qki(v);default:return m.a.J(509727834,822,10,"Invalid file type"),new Promise(A=>{A(!1)})}}Nyl(v){v=
h.a.sg(v);for(let A=0;A<this.pVa.length;++A){const w=this.pVa[A];if(w&&0<w.length&&v.endsWith(w))return!0}return!1}Oyl(v){return v<=1048576*this.o0c}static Nki(v){return new Promise((A,w)=>{if(v&&v.size){var y=document.createElement("video"),u=URL.createObjectURL(v);y.setAttribute("src",u);e.a.addHandler(y,"loadedmetadata",()=>{URL.revokeObjectURL(u);const E=y.videoHeight,G=y.videoWidth;0<y.duration&&!E&&!G?A(!0):(m.a.J(509727832,822,10,"Invalid audio File"),A(!1))});e.a.addHandler(y,"error",()=>
{URL.revokeObjectURL(u);m.a.J(509727831,822,10,"Invalid audio File");w(ResourceStrings.L_InvalidAudioFileError)})}else m.a.J(509727833,822,10,"Empty media File"),A(!1)})}static Oki(v){return new Promise((A,w)=>{if(v&&v.size){var y=URL.createObjectURL(v),u=document.createElement("video"),E=document.createElement("track");u.appendChild(E);e.a.addHandler(E,"load",()=>{URL.revokeObjectURL(y);A(!0)});e.a.addHandler(E,"error",()=>{URL.revokeObjectURL(y);m.a.J(509727829,822,10,"Invalid captions File");w(ResourceStrings.l_InvalidCaptionsFileError)});
E.setAttribute("src",y);E.setAttribute("default","true")}else m.a.J(509727830,822,10,"Empty captions File"),A(!1)})}static Qki(v){return new Promise((A,w)=>{if(v&&v.size){var y=document.createElement("video"),u=URL.createObjectURL(v);y.setAttribute("src",u);e.a.addHandler(y,"loadedmetadata",()=>{URL.revokeObjectURL(u);const E=y.videoHeight,G=y.videoWidth;0<y.duration&&0<E&&0<G?A(!0):(m.a.J(509727837,822,10,"Invalid video File"),A(!1))});e.a.addHandler(y,"error",()=>{URL.revokeObjectURL(u);m.a.J(509727836,
822,10,"Invalid video File");w(ResourceStrings.L_InvalidVideoFileError)})}else m.a.J(509727838,822,10,"Empty media File"),A(!1)})}static o9f(v){return v&&v.value?v.files[0].size.toString():"Invalid number of files"}static zYd(v){if(!v||!v.value)return"Input file name is null";const A=v.value.lastIndexOf(".");return-1===A?"":v.value.substring(A+1,A+5)}}n.rZj=16;n.IZj=16;n.j$j=[".vtt"];n.i$j=[".mp3",".wav",".m4a",".aac",".oga"];Object(J.a)(n,"MediaValidationHelper",null,[])},939:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.g1f=e}}Object(J.a)(h,"CommentContainersChangedEventArgs",Sys.EventArgs,[])},970:function(J,V,d){d.r(V);J=d(0);var h=d(77),e=d(45),m=d(89),n=d(65),v=d(25),A=d(1157),w=d(13),y=d(17),u=d(85),E=d(337),G=d(26),I=d(40);class H{constructor(La){this.ApiType=0;this.ApiType=La}}Object(J.a)(H,"SlideshowApiMessage",null,[]);class K extends H{constructor(){super(14);this.TopValue="0%";this.HeightValue="100%"}}Object(J.a)(K,
"DockSlideshowViewMessage",H,[]);class C extends H{constructor(){super(6);this.AnimStep=this.SlideIndex=0}}Object(J.a)(C,"GoToSlideApiMessage",H,[]);class Y extends H{constructor(){super(16);this.SlideIndex=0;this.TimeLineMappings=null}}Object(J.a)(Y,"GoToSlideWithTimeLinesApiMessage",H,[]);class M extends H{constructor(){super(19);this.Color=this.Item=null}}Object(J.a)(M,"InkManagerMessage",H,[]);class P{constructor(La){this.kF=La.origin;this.nPg=La.source;this.Ysa=La.data}}Object(J.a)(P,"MessageEvent",
null,[]);var T=d(918),L=d(916),aa=d(919),Q=d(920);class ea extends Sys.EventArgs{constructor(La){super();this.Q4b=La.IsStartTranscription;this.tv=La.SubtitlesPosition}}Object(J.a)(ea,"OnLiveSubtitlesDockedViewEventArgs",Sys.EventArgs,[]);class ia extends Sys.EventArgs{constructor(La){super();this.hx=La.SessionTelemetry}}Object(J.a)(ia,"OnLogEndOfTranscriptionSessionEventArgs",Sys.EventArgs,[]);var ja=d(923),D=d(924),pa=d(921);class Z extends Sys.EventArgs{constructor(La,nb){super();this.VBj=La;this.category=
nb.Category;this.code=nb.Code;this.message=nb.Message;this.my=nb.ExtraInfo;this.correlationId=nb.CorrelationId;this.sessionId=nb.SessionId}}Object(J.a)(Z,"OnSlideshowErrorEventArgs",Sys.EventArgs,[]);var oa=d(917);class Ba extends Sys.EventArgs{constructor(La){super();this.isFinal=La.IsFinal;this.$wh=La.Transcripts}}Object(J.a)(Ba,"OnSubtitleUpdatedEventArgs",Sys.EventArgs,[]);var Ma=d(925),za=d(922);class ka extends Sys.EventArgs{constructor(La){super();this.errorName=La.ErrorName;this.vetoName=
La.VetoName;this.isIntentional=La.IsIntentional;this.isInternal=La.IsInternal;this.alertOnPillar=La.AlertOnPillar;this.isSessionEndingError=La.IsSessionEndingError;this.durationMs=La.DurationMs}}Object(J.a)(ka,"RecordQosErrorEventArgs",Sys.EventArgs,[]);class qa extends H{constructor(){super(11);this.StartSlideShowTime=0}}Object(J.a)(qa,"RecordStartedSlideShowTimestampApiMessage",H,[]);class Ja extends H{constructor(){super(7);this.WacCluster=this.PodSessionId=null}}Object(J.a)(Ja,"RefreshPodSessionApiMessage",
H,[]);class xa extends H{constructor(){super(21);this.IsMute=!1}}Object(J.a)(xa,"SetMicrophoneStateMessage",H,[]);class Ga extends H{constructor(){super(12);this.OsfLocalStorageData=null}}Object(J.a)(Ga,"SetOsfLocalStorageApiMessage",H,[]);class na{constructor(){this.Q4b=this.oug=!1;this.tv=null}}Object(J.a)(na,"SlideShowViewDockingState",null,[]);var sa=d(972);class Ha extends H{constructor(){super(0);this.SlideIndex=this.SlideId=0;this.WacCluster=this.Endpoint=this.PodSessionId=this.WacUserSessionId=
this.UserId=null;this.FPrerenderSS=!1;this.PrerenderCid=null;this.SlideShowClickTime=0;this.EndSlideShowText=null;this.FSupportSVGInWebGL="0";this.HostSupportsSessionRefreshEnabled=!1;this.RenderShapeBuilder="0";this.CustomTransitionResourceUrl=this.DisabledTransitionsList=this.VetoAppSettingsStr=this.FileHost=null;this.StreamVideoUseThinEmbed=!1;this.DisabledChangeGates=null;this.AllowExternalMarketplace=this.AreThirdPartyAddInsAllowed=!1}}Object(J.a)(Ha,"StartSlideShowApiMessage",H,[]);class cb extends H{constructor(){super(13);
this.IsToggleOn=!1;this.PragueSessionInfo=""}}Object(J.a)(cb,"ToggleTranscriberLiveBroadcastModeMessage",H,[]);class Za extends H{constructor(){super(18);this.HideUI=!1}}Object(J.a)(Za,"ToggleTranscriberUIVisibilityMessage",H,[]);class va extends H{constructor(){super(8);this.SubtitlesResourceStr=this.SubtitlesContextStr=this.SubtitlesAppSettingsStr=null;this.MicrophoneDeviceId=this.LiveBroadcastContextStr=this.RehearsalContextStr=""}}Object(J.a)(va,"TranscribeApiMessage",H,[]);var Fa=d(71);d.d(V,
"SlideshowFrame",function(){return Ca});class Ca{constructor(La,nb,Nb,Rb,Ya,Qb,bb,Bb){this.eb=this.pUa=this.oUa=this.hta=null;this.va=new h.a;this.pEa=null;this.Kpe=this.rPg=!1;this.vf=nb;this.la=Nb;this.Dc=Rb;this.Pb=Ya;this.rN=Qb;this.vl=bb;this.kxb=Bb;this.c4j=new A.a(Object(w.a)(La,La.Yci,"browserSupportsRenderingSVGInWebGL"))}init(La,nb,Nb){if(!this.eb){this.hta=document.getElementById("HiddenFocusTrapAnchor");this.eb=document.createElement("iframe");this.eb.id="SlideShowHostFrame";this.eb.className=
"SlideShowHostFrame";this.eb.style.display=Fa.a.Sf;this.eb.setAttribute("allow","microphone; autoplay");this.pEa=new na;Nb=this.la.isHermesSlideShowPreloadEnabled?String.format("EndSlideShowText={0}&UserSessionId={1}&WacCluster={2}",e.a.Me(ResourceStrings.l_EndOfSlideShowMessage),e.a.Me(Nb),e.a.Me(nb)):"";Nb+=String.format(Nb?"&HostSupportsSessionRefreshEnabled={0}":"HostSupportsSessionRefreshEnabled={0}",e.a.Me(this.la.hostSupportsSessionRefreshEnabled.toString()));Nb+=String.format(Nb?"&InkingEnabled={0}":
"InkingEnabled={0}",e.a.Me(this.la.isInkingInSlideShowEnabled.toString()));Nb+=String.format(Nb?"&VideoThruTransparentCanvas={0}":"VideoThruTransparentCanvas={0}",e.a.Me(this.la.YPj.toString()));Nb+=String.format(Nb?"&IsFlipgridVideoEnabled={0}":"IsFlipgridVideoEnabled={0}",e.a.Me(this.la.g8a.toString()));Nb+=String.format(Nb?"&IsTEDVideoEnabled={0}":"IsTEDVideoEnabled={0}",e.a.Me(this.la.Bvb.toString()));Nb+=String.format(Nb?"&IsAllowExternalMarketplace={0}":"IsAllowExternalMarketplace={0}",e.a.Me(this.la.Pqg.toString()));
Nb+=String.format(Nb?"&IsNewSlideShowToolbarEnabled={0}":"IsNewSlideShowToolbarEnabled={0}",e.a.Me(this.la.Z3b.toString()));Nb+=String.format("&ImageCachingEnabled={0}",e.a.Me(this.la.pel.toString()));Nb+=String.format("&PodSlideshowEnableTabLoopFix={0}",e.a.Me(this.la.xvk.toString()));Nb+=String.format("&PodsLoadSlideShowFrameFromCdn={0}",e.a.Me(this.la.podsLoadSlideShowFrameFromCdn.toString()));Nb+=String.format("&PodsBase={0}",e.a.Me(this.la.podsWebServiceBase));var Rb=this.la.Vda;this.la.cSa&&
(Rb=new E.a(Rb),Rb.Cnc=this.la.cSa,Rb.Ujc=this.la.hnh,Rb.Tjc=this.la.gnh,Rb=Rb.toString());var Ya=this.la.podsLoadSlideShowFrameFromCdn&&!e.a.Va(this.la.podsBaseSlideShowFramePath);this.eb.src=Ya?this.la.podsBaseSlideShowFramePath:"./SlideShowFrame.html";this.eb.src=String.format(this.eb.src+"?Version={0}&WacCluster={1}&BootJS={2}&{3}={4}",La,e.a.Me(nb),e.a.Me(this.la.pptEditorSlideShowWrsEndpoint),u.a.tec,Rb);G.a.J(512495881,830,50,String.format("LoadFromCdn {0}, IsTranscriberEnabled {1}",Ya,this.la.dja));
if(this.la.dja||this.la.a5b)this.eb.src=String.format(this.eb.src+"&TranscriberJS={0}&ClientAudioMessageJS={1}&SpeechResultMessageJS={2}&TranscriberURI={3}",e.a.Me(this.la.pptEditorTranscriberJsUri),e.a.Me(this.la.pptEditorTransciberClientAudioMessageJsUri),e.a.Me(this.la.pptEditorTransciberSpeechResultMessageJsUri),e.a.Me(this.la.pptEditorSpeechHandlerBaseUri)),this.eb.src=String.format(this.eb.src+"&SpeechResponseMessageJS={0}",e.a.Me(this.la.pptEditorTranscriberSpeechResponseMessageJsUri)),e.a.sg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js")&&
(this.eb.src=String.format(this.eb.src+"&QualityStatusMessageJS={0}",e.a.Me(this.la.pptEditorTranscriberQualityStatusMessageJsUri))),this.la.a5b&&e.a.sg(this.la.pptEditorTranscriberRehearsalResultMessageJsUri).endsWith("rehearsalresultmessage.js")&&(this.eb.src=String.format(this.eb.src+"&RehearsalResultMessageJS={0}",e.a.Me(this.la.pptEditorTranscriberRehearsalResultMessageJsUri))),this.la.pptEditorTranscriberLiveAgentEnabled&&e.a.sg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js")&&
(this.eb.src=String.format(this.eb.src+"&AgentCommandMessageJS={0}",e.a.Me(this.la.pptEditorTranscriberAgentCommandMessageJsUri)));this.la.powerPointLiveBroadcastEnabled&&(this.eb.src+="&wdLiveBroadcast=true");this.eb.src=String.format(this.eb.src+"#{0}",Nb);I.a("PresenterCoachTabFix")&&this.hta?this.vf.insertBefore(this.eb,this.hta):this.vf.appendChild(this.eb);m.a.addHandler(window,n.a.message,Object(w.a)(this,this.Gok,"onSlideshowMessage"));this.Dc.Mqb&&this.la.A$c&&this.bUj();I.a("PresenterCoachTabFix")&&
(this.oUa=document.getElementById("legacySlideshowBeginningFocusTrap"),this.pUa=document.getElementById("legacySlideshowEndFocusTrap"),this.oUa||this.pUa||(this.oUa=document.createElement("div"),this.oUa.id="legacySlideshowBeginningFocusTrap",this.oUa.className="FocusTrap",this.oUa.tabIndex=0,m.a.addHandler(this.oUa,n.a.focus,Object(w.a)(this,this.Cdc,"onSlideShowContainerDivFocusHandler")),this.pUa=document.createElement("div"),this.pUa.id="legacySlideshowEndFocusTrap",this.pUa.className="FocusTrap",
this.pUa.tabIndex=0,m.a.addHandler(this.pUa,n.a.focus,Object(w.a)(this,this.Cdc,"onSlideShowContainerDivFocusHandler")),this.vf.insertBefore(this.oUa,this.vf.firstChild),this.vf.insertBefore(this.pUa,this.hta.nextSibling)))}}l5a(){return this.la.A$c&&this.Kpe}Mok(){G.a.J(512495880,830,50,"SlideShowFrame::OnSpeechClientScriptLoaded Speech client script has been loaded successfully");this.rPg=!0;return null}bUj(){const La=new y.a;La.add(this.kxb.loadScript("PPTSpeechClient"));Promise.all(La.toArray()).then(()=>
this.Mok()).catch(nb=>{G.a.J(512495879,830,10,"SlideShowFrame::LoadSpeechClientResources Failed to load the resources for SlideShowCore: {0}",nb)})}Phd(La,nb,Nb,Rb,Ya,Qb,bb,Bb,Eb){this.pEa=new na;bb&&G.a.J(512495878,830,50,String.format("Will trigger slideshow bundle rendering, correlation = {0}",Bb));this.vF(Object.assign(new Ha,{WacCluster:Nb,PodSessionId:Rb,UserId:Ya,WacUserSessionId:Qb,SlideId:La,SlideIndex:nb,FPrerenderSS:bb,PrerenderCid:Bb,SlideShowClickTime:Eb,EndSlideShowText:ResourceStrings.l_EndOfSlideShowMessage,
FSupportSVGInWebGL:this.c4j.value?"1":"0",RenderShapeBuilder:this.la.cSa?"1":"0",FileHost:v.AFrameworkApplication.fa.Ha("FileHost"),VetoAppSettingsStr:this.ghj(),DisabledTransitionsList:this.la.mJa,CustomTransitionResourceUrl:this.la.XTf,StreamVideoUseThinEmbed:v.AFrameworkApplication.fa.ka("StreamVideoUseThinEmbed"),DisabledChangeGates:v.AFrameworkApplication.fa.Ha("PPTDisabledChangeGates"),AreThirdPartyAddInsAllowed:v.AFrameworkApplication.ypa,AllowExternalMarketplace:v.AFrameworkApplication.fa.ka("51")}))}prev(){this.vF(new H(2))}next(){this.vF(new H(1))}transcribe(La,
nb,Nb,Rb,Ya,Qb,bb){var Bb=!!this.Pb&&!!this.Pb.instance&&(this.Pb.instance.jPa||this.Pb.instance.Lq);(this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&this.Pb.instance.eBa||Bb)&&!this.Pb.instance.Qqb()?G.a.J(512495877,830,50,"LivePresenter prevented transcriber from starting"):this.l5a()?(sa.a.instance.transcribe(La,nb,Nb,Rb,Ya,Qb,bb),this.TGc(this.Dc.Gh&&5!==Ya,this.Dc.tv)):(Bb={},Bb.TranslationLanguages=this.la.powerPointLiveBroadcastEnabled?this.la.liveBroadcastTranslationLanguagesOverride:"",Bb.BroadcastSubtitlesFromSpeechFrontDoorForLive=
this.la.powerPointLiveBroadcastEnabled?!0:!1,this.vF(Object.assign(new va,{SubtitlesAppSettingsStr:this.iej(La,Nb,nb,Rb,Ya,Qb),SubtitlesContextStr:this.Dc.bil,SubtitlesResourceStr:this.jej(),RehearsalContextStr:bb?bb.BMk:"",LiveBroadcastContextStr:JSON.stringify(Bb),MicrophoneDeviceId:this.rN.microphoneDeviceId})))}setMicrophoneState(La){this.l5a()?sa.a.instance.setMicrophoneState(La):(this.vF(Object.assign(new xa,{IsMute:La})),this.Pb&&this.Pb.instance&&(La?this.Pb.instance.glh():this.Pb.instance.hlh()))}xIb(La,
nb=""){this.pEa.oug=La;G.a.J(512495876,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");this.l5a()?(sa.a.instance.Ewh(La,nb),this.TGc(this.Dc.Gh,this.Dc.tv)):this.vF(Object.assign(new cb,{IsToggleOn:La,PragueSessionInfo:nb}));this.JXg()}toggleTranscriberUIVisibility(La){G.a.J(512495875,830,50,"Toggling Transcriber UI visibilitye ... On: {showUI}");this.l5a()?(La=La?La?!1:!0:!sa.a.instance.isVisible(),sa.a.instance.setVisibility(La),sa.a.instance.Yzc(),this.TGc(this.Dc.Gh,this.Dc.tv)):
this.vF(Object.assign(new Za,{HideUI:La}))}TGc(La,nb){this.pEa.Q4b=La;this.pEa.tv=nb;this.JXg()}setOsfLocalStorage(){const La={};let nb=!1;try{const Nb=RegExp("^osfCacheVersion|_?_OSF_.+$");for(let Rb=0;Rb<localStorage.length;++Rb){const Ya=localStorage.key(Rb);if(Nb.test(Ya)){const Qb=localStorage.getItem(Ya);La[Ya]=Qb;nb=!0}}}catch(Nb){G.a.J(512495874,830,50,"SlideShowFrame::Exception while retrieving OSF Local Storage data: {0}",Nb.toString())}nb&&this.vF(Object.assign(new Ga,{OsfLocalStorageData:La}))}show(){G.a.J(512495873,
830,50,"SlideShowFrame::Show Making frame visible.");if(this.eb){this.eb.style.display=Fa.a.Rk;var La=(new Date).getTime();G.a.J(512495843,830,50,"SlideShowFrame::Show Sending startedSlideShowTimestamp: {0} to SlideShowFrame.html",La);this.vF(Object.assign(new qa,{StartSlideShowTime:La}))}else G.a.J(512495872,830,15,"SlideShowFrame::Show Making frame visible, but m_frame is null.")}yvb(){return this.eb&&this.eb.style.display!==Fa.a.Sf?!0:!1}u2(){return"Legacy"}wmc(La){this.eb.style.display=La?Fa.a.Rk:
Fa.a.Sf;this.l5a()&&sa.a.instance.setVisibility(La&&this.Dc.Gh)}bKc(){G.a.J(512495842,830,50,"SlideShowFrame: Exiting with post message");this.vF(new H(3))}exit(){this.eb.style.display===Fa.a.Sf?this.va.raiseEvent("OnExit",new L.a({SlideId:0,IsBeforeReady:!0})):(G.a.J(512495841,830,50,"SlideShowFrame: Making frame invisible"),this.eb.style.display=Fa.a.Sf,this.vF(new H(3)));this.l5a()&&sa.a.instance.rNe()}restoreFocus(){this.eb.style.display===Fa.a.Sf||this.o8d()||(this.eb.focus(),this.vF(new H(4)))}pausePresentation(){this.vF(new H(15))}bQe(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}getCurrentPosition(){this.vF(new H(5))}getCurrentPositionWithTimeLines(){this.vF(new H(17))}getCurrentSlideDimensions(){this.vF(new H(20))}xQa(La){this.vF(Object.assign(new C,{SlideIndex:La,AnimStep:0}))}Iye(La){this.vF(Object.assign(new M,{Item:La.item,Color:La.color}))}rHe(La){this.va.raiseEvent("OnSpecialKey",new oa.a({["Key"]:La.keyCode,["ShiftKey"]:La.shiftKey}))}zjh(){this.vF(new H(22))}dgg(La,nb){this.vF(Object.assign(new Y,{SlideIndex:La,TimeLineMappings:nb}))}refreshPodSession(La,
nb){this.vF(Object.assign(new Ja,{PodSessionId:La,WacCluster:nb}))}setVisibility(La){this.eb.style.visibility=La?Fa.a.Uy:Fa.a.Us}zea(La){this.vF(new H(La?9:10));this.l5a()&&sa.a.instance.zea(La)}Izc(La){this.va.addHandler("OnSlideshowReady",La)}Bcd(La){this.va.removeHandler("OnSlideshowReady",La)}nGd(La){this.va.addHandler("OnBrowserEvent",La)}KDe(La){this.va.removeHandler("OnBrowserEvent",La)}BCf(La){this.va.addHandler("OnFullscreenClick",La)}Xch(La){this.va.removeHandler("OnFullscreenClick",La)}pGd(La){this.va.addHandler("OnSlideshowContextMenu",
La)}MDe(La){this.va.removeHandler("OnSlideshowContextMenu",La)}tGd(La){this.va.addHandler("OnPodSessionExpired",La)}QDe(La){this.va.removeHandler("OnPodSessionExpired",La)}PMa(La){this.va.addHandler("OnPositionChangeEventId",La)}peb(La){this.va.removeHandler("OnPositionChangeEventId",La)}Jga(La){this.va.addHandler("OnExit",La)}fea(La){this.va.removeHandler("OnExit",La)}yCf(La){this.va.addHandler("OnSlideshowError",La)}Uch(La){this.va.removeHandler("OnSlideshowError",La)}PSb(La){this.va.addHandler("OnGetCurrentPosition",
La)}oeb(La){this.va.removeHandler("OnGetCurrentPosition",La)}Fzc(La){this.va.addHandler("OnGetCurrentSlideDimensions",La)}zcd(La){this.va.removeHandler("OnGetCurrentSlideDimensions",La)}Jzc(La){this.va.addHandler("OnSpecialKey",La)}Ccd(La){this.va.removeHandler("OnSpecialKey",La)}OCf(La){this.va.addHandler("OnVisibilityChangeEventId",La)}TDe(La){this.va.removeHandler("OnVisibilityChangeEventId",La)}FCf(La){this.va.addHandler("OnLogEndOfTranscriptionSession",La)}Zch(La){this.va.removeHandler("OnLogEndOfTranscriptionSession",
La)}ECf(La){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",La)}Ych(La){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",La)}qGd(La){this.va.addHandler("OnEnterEndOfShowEventId",La)}NDe(La){this.va.removeHandler("OnEnterEndOfShowEventId",La)}sGd(La){this.va.addHandler("OnLeaveEndOfShowEventId",La)}PDe(La){this.va.removeHandler("OnLeaveEndOfShowEventId",La)}MCf(La){this.va.addHandler("OnSubtitleUpdatedEventId",La)}fdh(La){this.va.removeHandler("OnSubtitleUpdatedEventId",La)}NCf(La){this.va.addHandler("OnTranscriberStartedEventId",
La)}gdh(La){this.va.removeHandler("OnTranscriberStartedEventId",La)}VCf(La){this.va.addHandler("RecordQosErrorEventId",La)}odh(La){this.va.removeHandler("RecordQosErrorEventId",La)}Gok(La){La=new P(La.rawEvent);if(this.PPj(La)){var nb=this.ZUk(La.Ysa),Nb=nb.EventType;28===Nb&&G.a.J(512495840,830,50,"SlideshowFrame.OnSlideshowMessage: Receive message event: {0}",La.Ysa);switch(Nb){case 23:this.Y6c(nb);break;case 18:this.Gcb(nb);break;case 6:this.Mmk();break;case 11:this.q0g(!1,nb);break;case 13:this.q0g(!0,
nb);break;case 2:this.Gda(nb);break;case 7:this.Vua(nb);break;case 12:this.fva(nb);break;case 24:this.Fok(nb);break;case 26:this.mWa(nb);break;case 27:this.W7c(nb);break;case 29:this.x7c(nb);break;case 5:this.Y7c(nb);break;case 30:this.Sok(nb);break;case 32:this.E8c(nb);break;case 31:this.w7c(nb);break;case 19:this.V6c(nb);break;case 20:this.t7c(nb);break;case 33:this.Qbd(nb)}}}PPj(La){try{if(La.nPg!==this.eb.contentWindow)return G.a.J(512495839,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Invalid message source or origin: {0}",
La.nPg.location.href),!1}catch(nb){return G.a.J(512495838,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Exception at checking event source/origin: {0}",nb.toString()),!1}return!0}ZUk(La){try{return Sys.Serialization.JavaScriptSerializer.deserialize(La)}catch(nb){let Nb=nb.toString();I.a("DisableLogPostMsgData")&&(La="<redacted>");I.a("DisableLogPostMsgEx")&&(Nb="<redacted>");G.a.J(512495837,830,15,"SlideshowFrame.RetrieveMsgEventData: Exception at deserializing event data: {0}.  Exception: {1}",
La,Nb)}return{}}Mmk(){if(this.la.A$c&&this.rPg&&!this.Kpe)try{const La=(new Date).getTime();sa.a.instance.init(this.la,this.eb.contentDocument.body,this.Dc,this,this.vl,this.Pb,this.rN);this.Kpe=!0;G.a.J(512495836,833,50,"SlideshowFrame.OnPresentationOpenedHandler: SpeechClient initialized successfully! TimeUsed: {0} ms",(new Date).getTime()-La)}catch(La){G.a.J(512495835,830,10,"SlideshowFrame.OnPresentationOpenedHandler: Exception thrown: {0}.",La.toString())}G.a.J(512495834,830,50,"SlideshowFrame.OnPresentationOpenedHandler");
this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)}Gcb(La){this.va.raiseEvent("OnBrowserEvent",new T.a(La))}Y6c(La){G.a.J(512495833,830,50,"SlideshowFrame.OnExitSlideshowHandler");G.a.J(512495832,830,50,"SlideShowFrame: Making frame invisible");this.eb.style.display=Fa.a.Sf;this.va.raiseEvent("OnExit",new L.a(La))}Gda(La){G.a.J(512495831,830,50,"SlideshowFrame.OnGetCurrentPositionHandler");this.va.raiseEvent("OnGetCurrentPosition",new aa.a(La))}Vua(La){G.a.J(512495830,830,50,"SlideshowFrame.OnGetCurrentSlideDimensionsHandler");
this.va.raiseEvent("OnGetCurrentSlideDimensions",new Q.a(La))}q0g(La,nb){this.va.raiseEvent("OnSlideshowError",new Z(La,nb))}fva(La){La=new oa.a(La);G.a.J(512495829,830,50,"SlideshowFrame.OnSpecialKeyHandler: Key={0}",La.key);this.va.raiseEvent("OnSpecialKey",La)}Fok(La){G.a.J(512495828,830,50,"SlideshowFrame.OnSlideshowContextMenuHandler");this.va.raiseEvent("OnSlideshowContextMenu",new pa.a(La))}mWa(La){G.a.J(512495827,830,50,"SlideshowFrame.OnVisibilityChangeHandler");this.va.raiseEvent("OnVisibilityChangeEventId",
new za.a(La))}W7c(La){G.a.J(512495826,830,50,"SlideshowFrame.OnPodSessionExpiredHandler");this.va.raiseEvent("OnPodSessionExpired",new ja.a(La))}x7c(La){G.a.J(512495825,830,50,"SlideshowFrame.OnLogEndOfTranscriptionSessionHandler");this.va.raiseEvent("OnLogEndOfTranscriptionSession",new ia(La));this.Dc.Sqb=!1}Y7c(La){G.a.J(512495824,830,50,"SlideshowFrame.OnPositionChangedHandler");this.va.raiseEvent("OnPositionChangeEventId",new D.a(La))}Sok(La){G.a.J(512495823,830,50,"SlideshowFrame.OnSubtitleUpdatedHandler");
this.va.raiseEvent("OnSubtitleUpdatedEventId",new Ba(La))}E8c(La){G.a.J(512495822,830,50,"SlideshowFrame.OnTranscriberStartedHandler");this.va.raiseEvent("OnTranscriberStartedEventId",new Ma.a(La));this.Dc.Sqb=!0}Cdc(){this.restoreFocus()}w7c(La){G.a.J(512495821,830,50,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler");try{const nb=new ea(La);this.TGc(nb.Q4b,nb.tv);this.va.raiseEvent("OnLiveSubtitlesDockedViewEventId",nb)}catch(nb){G.a.J(512495820,830,15,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler threw exception: {0}.",
nb.toString())}}V6c(){G.a.J(512495819,830,50,"SlideshowFrame.OnEnterEndOfShowHandler");this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty)}t7c(){G.a.J(512495818,830,50,"SlideshowFrame.OnLeaveEndOfShowHandler");this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty)}Qbd(La){G.a.J(512495817,830,50,"SlideshowFrame.RecordQosErrorHandler");this.va.raiseEvent("RecordQosErrorEventId",new ka(La))}vF(La){this.eb&&this.eb.contentWindow&&this.eb.contentWindow.postMessage(Sys.Serialization.JavaScriptSerializer.serialize(La),
"*")}JXg(){var La=0,nb=100;this.pEa.Q4b&&("BelowSlide"===this.pEa.tv?(La=0,nb=85):"AboveSlide"===this.pEa.tv&&(La=15,nb=85));La=La.toString()+"%";nb=nb.toString()+"%";this.pEa.oug&&(La=String.format("calc({0} + {1})",La,"26px"),nb=String.format("calc({0} - {1})",nb,"26px"));this.vF(Object.assign(new K,{TopValue:La,HeightValue:nb}))}ghj(){const La={};La.AnimTranstionMinDurationMs=v.AFrameworkApplication.fa.Ec("PodSlideShowVetoAnimTranstionMinDurationMs",1E3);La.AnimTranstionWorstFrameIndex=v.AFrameworkApplication.fa.Ec("PodSlideShowVetoAnimTranstionWorstFrameIndex",
3);La.AnimTranstionMaxFrameDurationMs=v.AFrameworkApplication.fa.Ec("PodSlideShowVetoAnimTranstionMaxFrameDurationMs",300);La.AnimTranstionMinFPS=v.AFrameworkApplication.fa.Ec("PodSlideShowVetoAnimTranstionMinFPS",24);La.NavDurationMs=v.AFrameworkApplication.fa.Ec("PodSlideShowVetoNavDurationMs",1250);La.SlideShowEUPLThresholdInMs=v.AFrameworkApplication.fa.Ec("SlideShowEUPLThresholdInMs",6E3);La.SlideShowNavigationThresholdInMs=v.AFrameworkApplication.fa.Ec("SlideShowNavigationThresholdInMs",1250);
return JSON.stringify(La)}iej(La,nb,Nb,Rb,Ya,Qb){const bb=this.la.ayk&&e.a.sg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js"),Bb={};Bb.WacUserSessionId=La;Bb.WacUserDatacenterCluster=nb;Bb.PodSessionId=Nb;Bb.DocId=Rb;Bb.EntryPoint=Ya;Bb.StartTime=Qb;Bb.PodsWebServiceBase=this.la.podsWebServiceBase;Bb.TranscriberLoggingIntervalInMS=this.la.Hnl;Bb.TranscribeRealTimeFactorLowerThreshold=this.la.Dnl;Bb.TranscribeRealTimeFactorUpperThreshold=this.la.Enl;Bb.IsTranscriberLogEachTranscriptMessage=
this.la.XOj;Bb.IsTranscriberContentLoggingEnabled=this.la.UOj;Bb.FUseEndpointInWebapp=this.la.$Oj;Bb.CustomEndpointRequestTimeoutInMs=this.la.pptEditorTransriberCustomEndpointRequestTimeoutInMs;Bb.RTLLanguages=this.la.pptEditorTranscribeRTLTranslationLanguages;Bb.HeartbeatInterval=5E3;Bb.RoundtripLatencyThreshold=1E6;Bb.AudioSendingCountIntervalMS=this.la.pptEditorTranscribeAudioSendingCountIntervalMS;Bb.FragmentLatencyWarnThreshold=1E6;Bb.FragmentLatencyErrorThreshold=1E6;Bb.MessageType=this.la.pptEditorTransciberMessageType;
Bb.MaxAllowedFragmentLatencyMS=this.la.Avk;Bb.DynamicBufferEnabled=this.la.VOj;Bb.DefaultBufferSize=this.la.Gnl;Bb.MaxAllowedFinalFragmentLatencyMS=this.la.zvk;Bb.FSupportSpeechResponseMessage=bb;Bb.IsLiveAgent=this.la.pptEditorTranscriberLiveAgentEnabled&&bb&&e.a.sg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js");Bb.ShouldCreateCustomEndpointWithSession=this.la.pptEditorTranscriberCustomEndpointWithSession;Bb.TranscriberShowListeningDetectionTextInMS=this.la.$xk;
Bb.PodTranscriberAudioContextSampleRate=this.la.yvk;Bb.RehearsalGrammarIsEnabled=this.la.Vye;Bb.PodRehearsalMonotoneEnabled=this.la.pye;return JSON.stringify(Bb)}jej(){const La={};La.Detection_AudioQualityIssue=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;La.Detection_HighBackgroundNoise=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;La.Detection_HighJitter=ResourceStrings.L_SubtitleDetection_HighJitter;La.Detection_HighLatency=ResourceStrings.L_SubtitleDetection_HighLatency;La.Detection_Listening=
ResourceStrings.L_SubtitleDetection_Listening;La.Detection_MicReady=ResourceStrings.L_SubtitleDetection_MicReady;La.Detection_NetworkQualityIssue=ResourceStrings.L_SubtitleDetection_NetworkQualityIssue;La.Detection_NoMicrophone=ResourceStrings.L_SubtitleDetection_NoMicrophone;La.Detection_SoundReminder=ResourceStrings.L_SubtitleDetection_SoundReminder;La.Detection_SpeakingTooLoud=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;La.Detection_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;
La.DetectionText_AudioQualityIssue=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;La.DetectionText_HighBackgroundNoise=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;La.DetectionText_HighJitter=ResourceStrings.L_SubtitleDetectionText_HighJitter;La.DetectionText_HighLatency=ResourceStrings.L_SubtitleDetectionText_HighLatency;La.DetectionText_NetworkQualityIssue=ResourceStrings.L_SubtitleDetectionText_NetworkQualityIssue;La.DetectionText_SpeakingTooLoud=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
La.DetectionText_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetectionText_SpeakingTooQuiet;La.Accessibility_Content=ResourceStrings.L_SubtitleAccessibilityContent;La.Accessibility_Window=ResourceStrings.L_SubtitleAccessibilityWindow;La.InitialMessage=ResourceStrings.L_SubtitleInitMessage;La.GenericErrorMessage=ResourceStrings.L_SubtitleGenericErrorMessage;La.RetryErrorMessage=ResourceStrings.L_SubtitleRetryErrorMessage;La.ErrorAudioDevice=ResourceStrings.L_SubtitleAudioDeviceErrorMessage;La.GenericRetryErrorMessage=
ResourceStrings.L_SpeechGenericRetryErrorMessage;La.GenericNetworkErrorMessage=ResourceStrings.L_SpeechGenericNetworkErrorMessage;return JSON.stringify(La)}o8d(){return!!this.Pb&&!!this.Pb.instance&&this.Pb.instance.n1f}}Object(J.a)(Ca,"SlideshowFrame",null,[924])},972:function(J,V,d){J=d(0);var h=d(283),e=d(25),m=d(45),n=d(13),v=d(22),A=d(1158),w=d(33),y=d(26);class u{}u.speechMode="Subtitles";u.QTf=[u.speechMode];u.sourceLanguage=null;u.targetLanguages=null;u.speechFDBase=null;u.podSessionId=null;
u.NDh=null;u.docId=null;u.webServiceBase=null;u.userSessionId=e.AFrameworkApplication.userSessionId;Object(J.a)(u,"PPTSpeechClientConfig",null,[]);var E=d(77);class G{constructor(){this.va=new E.a}onFinalRecognitionText(ea){this.va.raiseEvent("OnFinalRecognitionText",ea)}onPartialRecognitionText(ea){this.va.raiseEvent("OnPartialRecognitionText",ea)}onError(ea){this.va.raiseEvent("OnError",ea)}onSpeechRecognitionStarted(ea){this.va.raiseEvent("OnSpeechRecognitionStarted",ea)}onEventUpdate(ea){this.va.raiseEvent("OnEventUpdate",
ea)}O2h(ea){this.va.addHandler("OnFinalRecognitionText",ea)}VOk(ea){this.va.removeHandler("OnFinalRecognitionText",ea)}M4h(ea){this.va.addHandler("OnPartialRecognitionText",ea)}iQk(ea){this.va.removeHandler("OnPartialRecognitionText",ea)}I2h(ea){this.va.addHandler("OnError",ea)}QOk(ea){this.va.removeHandler("OnError",ea)}J5h(ea){this.va.addHandler("OnSpeechRecognitionStarted",ea)}MQk(ea){this.va.removeHandler("OnSpeechRecognitionStarted",ea)}K2h(ea){this.va.addHandler("OnEventUpdate",ea)}SOk(ea){this.va.removeHandler("OnEventUpdate",
ea)}}Object(J.a)(G,"PPTSpeechClientObserverController",null,[]);var I=d(375),H=d(384);class K{constructor(){this.accessToken=null}}Object(J.a)(K,"IAuthenticationProvider",null,[]);class C{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(J.a)(C,"IDocumentDownloadConfig",null,[]);class Y{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;
this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(J.a)(Y,"ISpeechConfig",null,[]);class M{constructor(ea){this.R3=ea}onFinalText(){}onFragmentText(){}onFinalRecognitionText(ea,ia){this.R3.onFinalRecognitionText(ea,ia)}onPartialRecognitionText(ea,ia){this.R3.onPartialRecognitionText(ea,ia)}onError(ea){if("ErrorNone"!==ea)switch(ea){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.R3.onError("AccessDenied");
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.R3.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.R3.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.R3.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.R3.onError("UnknownError");
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.R3.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.R3.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.R3.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.R3.onError("NotReadableError");break;default:this.R3.onError("CustomError-"+ea)}}onSpeechRecognitionStarted(ea){I.ULS.sendTraceTag(594355729,
830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",ea);this.R3.onSpeechRecognitionStarted(ea)}onEventUpdate(ea){this.R3.onEventUpdate(ea)}}Object(J.a)(M,"PPTSpeechClientObserver",null,[988]);class P{constructor(ea){this.e9=null;this.SFa=0;this.microphoneDeviceId="";this.H8j=new M(ea)}GNj(){return 2===this.SFa}nyj(){const ea=this.AOd(),ia=Object.assign(new K,{accessToken:""});this.e9&&0!==this.SFa&&(this.e9.stopSpeechRecognition(),this.SFa=0);this.e9=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(ea,
this.H8j,ia,null,new H.a);return this.e9?!0:(I.ULS.sendTraceTag(594355727,830,10,"Speech client was not successfully created"),!1)}Ksh(){this.e9&&(0===this.SFa?(this.e9.startSpeechRecognition(),this.SFa=2):1===this.SFa&&(this.e9.resumeSpeechRecognition(),this.SFa=2))}shl(){this.e9&&(this.e9.stopSpeechRecognition(),this.SFa=0)}wuk(){this.e9&&(this.e9.pauseSpeechRecognition(),this.SFa=1)}setCustomSetting(ea,ia){this.e9&&this.e9.setCustomSetting(ea,ia)}AOd(){return Object.assign(new Y,{speechMode:u.speechMode,
sourceLanguage:u.sourceLanguage,targetLanguages:u.targetLanguages,speechFDBase:u.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new C,{docId:u.docId,podsSessionId:u.podSessionId,userDataCenterClusterId:u.NDh,webServiceBase:u.webServiceBase}),userSessionId:u.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(J.a)(P,"PPTSpeechClientProxy",null,[]);var T;(function(ea){ea[ea.none=0]="none";ea[ea.singleLineRibbon=1]="singleLineRibbon";
ea[ea.multipleLineRibbon=2]="multipleLineRibbon";ea[ea.slideShowToolbar=3]="slideShowToolbar";ea[ea.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";ea[ea.liveBroadcast=5]="liveBroadcast"})(T||(T={}));Object(J.b)("TranscriptionEntryPoint",T);var L=d(660),aa=d(71);d.d(V,"a",function(){return Q});class Q{constructor(){this.vf=this.g9=this.bC=this.Ebb=this.sr=this.eb=this.la=this.Pb=this.Dc=null;this.lyb=!1;this.vl=null;this.Nbb=this.abc=0;this.RIg=!1;this.WFa=this.VFa="";this.vYc=!1;this.Tpe=
"";this.dfe=0;this.Jxb=this.i9=this.MAb="";this.rN=null;this.qua={};this.uka=new G;this.Q8=new P(this.uka);Q.ryj()}init(ea,ia,ja,D,pa,Z,oa){y.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.vf=ia;this.la=ea;this.Dc=ja;this.eb=D;this.vl=pa;this.Pb=Z;this.rN=oa;this.sr=document.createElement("div");this.sr.id="SubtitleContainer";this.sr.className="SubtitleContainer";this.sr.style.display=aa.a.Sf;this.sr.style.visibility=aa.a.Us;this.Ebb=document.createElement("div");this.Ebb.id="SubtitleResultDiv";
this.Ebb.className="SubtitleResultDiv";this.Dc.yOi&&(this.Ebb.style.direction="rtl");this.bC=document.createElement("span");this.bC.id="SubtitleResultSpan";this.bC.className="SubtitleResultSpan";this.bC.setAttribute("aria-hidden","true");this.g9=document.createElement("span");this.g9.id="SubtitleAccessibilitySpan";this.g9.className="SubtitleAccessibilitySpan";this.g9.innerText="";this.g9.setAttribute("lang",this.Dc.gxa);this.g9.setAttribute("aria-live","assertive");this.g9.setAttribute("aria-label",
ResourceStrings.L_SubtitleAccessibilityWindow);this.g9.setAttribute("aria-atomic","true");this.Ebb.appendChild(this.bC);this.Ebb.appendChild(this.g9);this.sr.appendChild(this.Ebb);this.vf.appendChild(this.sr);h.a.instance.ob(this.bC,()=>!1);e.AFrameworkApplication.fa.Zba?this.Bm():e.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){this.MAb=this.getUserId();this.i9=e.AFrameworkApplication.fa.Ha("TenantId");this.Jxb=this.la.hostAuthType||e.AFrameworkApplication.fa.Ha("HostAuthType")||
"Unknown"}getUserId(){let ea=e.AFrameworkApplication.fa.Ha("PptEditingUserId");m.a.Va(ea)&&(ea=e.AFrameworkApplication.fa.Ha("LoggableUserId"),y.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",m.a.Va(ea)));return ea}wOk(){this.sr.style.display=aa.a.Sf;this.sr.style.visibility=aa.a.Us}transcribe(ea,ia,ja,D,pa,Z){this.xvb()&&(this.vl.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,L.a.a6c),this.abc=window.setTimeout(Object(n.a)(this,this.e4d,
"hideSoundReminderNotification"),3E3));this.pvl(ia,ja,D,this.Dc);this.Q8&&(this.Q8.microphoneDeviceId=this.rN.microphoneDeviceId);this.Dc.Gh&&this.Q8.nyj()?(this.qua.StartTime=Z,this.qua.LastError="ErrorNone",this.qua.EntryPoint=T[pa],this.uka.O2h(Object(n.a)(this,this.qYg,"onFinalRecognitionTextHandler")),this.uka.M4h(Object(n.a)(this,this.TZg,"onPartialRecognitionTextHandler")),this.uka.I2h(Object(n.a)(this,this.y0g,"onSpeechProxyErrorHandler")),this.uka.K2h(Object(n.a)(this,this.z0g,"onSpeechProxyEventUpdateHandler")),
this.uka.J5h(Object(n.a)(this,this.A0g,"onSpeechRecognitionStartedHandler")),this.Q8.Ksh(),this.Q8.setCustomSetting("clientMetadata",JSON.stringify(this.w8f())),this.bC.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.bC.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==pa),this.Yzc(),this.eb.Fzc(Object(n.a)(this,this.Vua,"onGetCurrentSlideDimensionsHandler")),this.eb.PMa(Object(n.a)(this,this.n8c,"onSlideChangedHandler"))):this.rNe()}w8f(ea=""){const ia=w.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
ja={};ja.userID=this.MAb;ja.tenantId=this.i9;ja.identityProvider=this.Jxb;ja.audienceChannel="";ja.audienceGroup=ia.Ring||"Unknown";ja.buildVersion=e.AFrameworkApplication.buildVersion||"Unknown";ja.locale=this.la.ZGa||"Unknown";ja.wacHost=ia.Host||"Unknown";ja.wacDatacenter=ia.WACDatacenter||"Unknown";ja.livePragueSessionInfo=ea;return ja}rNe(){this.sr.style.display=aa.a.Sf;this.sr.style.visibility=aa.a.Us;this.Q8.shl();this.uka.VOk(Object(n.a)(this,this.qYg,"onFinalRecognitionTextHandler"));this.uka.iQk(Object(n.a)(this,
this.TZg,"onPartialRecognitionTextHandler"));this.uka.QOk(Object(n.a)(this,this.y0g,"onSpeechProxyErrorHandler"));this.uka.SOk(Object(n.a)(this,this.z0g,"onSpeechProxyEventUpdateHandler"));this.uka.MQk(Object(n.a)(this,this.A0g,"onSpeechRecognitionStartedHandler"));this.eb.zcd(Object(n.a)(this,this.Vua,"onGetCurrentSlideDimensionsHandler"));this.eb.peb(Object(n.a)(this,this.n8c,"onSlideChangedHandler"));this.xvb()&&this.vl.instance.hide();this.qua.EndTime=Date.now();y.a.J(512495705,817,15,JSON.stringify(this.qua,
Q.zrl));this.qua={};this.Dc.Sqb=!1}Yzc(){let ea=3;this.qua.LastPosition=this.Dc.tv;"AboveSlide"===this.Dc.tv&&this.sr.style.visibility===aa.a.Uy?(this.sr.style.display=aa.a.Iwa,this.sr.style.backgroundColor="black",this.sr.style.bottom="auto"):"BelowSlide"===this.Dc.tv&&this.sr.style.visibility===aa.a.Uy?(this.sr.style.display=aa.a.Iwa,this.sr.style.backgroundColor="black",this.sr.style.bottom="3%",ea=-1):"TopOverlay"===this.Dc.tv?(this.sr.style.display=aa.a.Iwa,this.sr.style.backgroundColor="transparent",
this.sr.style.bottom="auto",ea=5):"BottomOverlay"===this.Dc.tv&&(this.sr.style.display=aa.a.Iwa,this.sr.style.backgroundColor="transparent",this.sr.style.bottom="5%",ea=-1);this.lyb&&document.getElementById("LiveURLBarLayerHost")?this.sr.style.top=-1<ea?String.format("calc({0}% + {1})",ea.toString(),"26px"):"auto":(this.sr.style.top=-1<ea?ea.toString()+"%":"auto",this.JDf())}isVisible(){return this.sr.style.visibility===aa.a.Uy}Ewh(ea,ia=""){u.QTf=ea?["Live","Subtitles"]:["Subtitles"];this.lyb=ea;
this.setVisibility(this.sr.style.visibility===aa.a.Uy);this.Yzc();this.Q8.setCustomSetting("clientMetadata",JSON.stringify(this.w8f(ia)));this.Q8.setCustomSetting("slideIndex",this.dfe);this.Q8.setCustomSetting("currentSpeechModes",JSON.stringify(u.QTf))}zea(ea){this.sr.style.cursor=ea?"default":"none"}JDf(){this.bC.style.fontSize=Math.floor(this.sr.clientHeight/2/1.5).toString()+"px";this.Tpe=Math.floor(this.sr.clientHeight/12-2)+"px";this.bC.style.display="inline"}setVisibility(ea){this.sr?(null===
ea&&(ea=this.sr.style.visibility===aa.a.Us),this.sr.style.visibility=ea?aa.a.Uy:aa.a.Us):y.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}Vua(){this.JDf()}n8c(ea,ia){this.dfe=ia.slideIndex;this.Q8.GNj()&&this.lyb&&(this.Q8.setCustomSetting("currentSlideIndex",this.dfe),y.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}setMicrophoneState(ea){ea?(this.Q8.wuk(),this.mic(),this.vYc=!0,this.Pb&&this.Pb.instance&&
this.Pb.instance.glh()):(this.Q8.Ksh(),this.Pb&&this.Pb.instance&&this.Pb.instance.hlh())}e4d(){this.xvb()&&(window.clearTimeout(this.abc),this.vl.instance.hide())}pvl(ea,ia,ja,D){u.sourceLanguage=D.Qma;u.targetLanguages=D.ohb;u.podSessionId=ea;u.NDh=ia;u.docId=ja;u.webServiceBase=this.la.podsWebServiceBase;u.speechFDBase=e.AFrameworkApplication.fa.Ha("715");ea=!!this.Pb&&!!this.Pb.instance&&(this.Pb.instance.jPa||this.Pb.instance.Lq);u.speechMode=this.Pb&&this.Pb.instance&&this.Pb.instance.ar&&this.Pb.instance.eBa||
ea?"Live":"Subtitles"}hXf(ea,ia){this.RIg||(this.bC.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.Nbb),this.bC.innerText=this.egj(ea,ia),this.bC.scrollTop=this.bC.scrollHeight,this.Nbb=window.setTimeout(Object(n.a)(this,this.mic,"resetSubtitlesToEmpty"),1E4),ia&&(this.g9.innerText=ea,this.g9.focus()),this.bC.style.padding=m.a.Va(ea)?"0px":this.Tpe)}Lu(ea){this.RIg||(this.bC.style.color="rgba( 255, 255, 0, 1 )",m.a.Va(ea)&&(ea=ResourceStrings.L_SubtitleGenericErrorMessage),window.clearTimeout(this.Nbb),
this.bC.innerText="["+ea+"]",this.bC.scrollTop=this.bC.scrollHeight,this.Nbb=window.setTimeout(Object(n.a)(this,this.mic,"resetSubtitlesToEmpty"),1E4),this.bC.style.padding=this.Tpe,this.g9.innerText="",this.g9.focus())}ipj(ea){if(null!==ea)switch(ea){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.Lu(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.qua.LastError="MicrophoneError";break;case "FailedToConnect":this.Lu(ResourceStrings.L_SubtitleRetryErrorMessage);
this.qua.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.Lu(ResourceStrings.L_SubtitleGenericErrorMessage);this.qua.LastError="FailedToCreateSpeechSession";break;default:y.a.J(512495703,830,15,"HandleSpeechProxyError {0}",ea)}}qYg(ea,ia){this.sr.style.visibility!==aa.a.Us&&this.hXf(ia[this.Dc.ohb],!0)}TZg(ea,ia){this.sr.style.visibility!==aa.a.Us&&this.hXf(ia[this.Dc.ohb],!1)}y0g(ea,ia){y.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",ia);(ea=ia.toString())&&
(-1<ea.indexOf("NotAllowedError")||-1<ea.indexOf("NotFoundError")||-1<ea.indexOf("NotReadableError")||-1<ea.indexOf("MicrophoneError"))&&this.xvb()&&this.vl.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,L.a.TVa);this.ipj(ea)}A0g(ea,ia){({SlideShowCoreFrame:ea}=d(695));const {SlideshowFrame:ja}=d(970);y.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",ia.toString());Object(v.a)(ea,this.eb)?Object(A.a)(ea,this.eb).E8c(ia.toString()):Object(v.a)(ja,this.eb)&&this.la.A$c&&
Object(A.a)(ja,this.eb).E8c(ia.toString());this.mic();this.xvb()&&this.vl.instance.hide()}z0g(ea,ia){if(this.xvb())switch(ea=ia.eventName,ea){case "MediaEvent":"AudioDeviceConnected"===ia.mediaStatus&&this.vl.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,L.a.a6c);break;case "ConnectionRetry":this.vl.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,L.a.TVa);this.Lu(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const ja=ia.shortCode;ea=ia.longCode;
const D=ia.shortString,pa=ia.longString;switch(ia.severity){case 0:this.vl.instance.hide();break;case 1:(ia=0<ja?Q.pX[ja]:D)&&this.vl.instance.show(ia,L.a.MBb);break;case 2:(ia=0<ja?Q.pX[ja]:D)&&this.vl.instance.show(ia,L.a.TVa),ia=null===ea?pa:Q.pX[ea],m.a.Va(ia)||(window.clearTimeout(this.Nbb),this.Lu(ia),this.Nbb=window.setTimeout(Object(n.a)(this,this.mic,"resetSubtitlesToEmpty"),3E4))}break;default:y.a.J(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",ea)}}xvb(){return this.la.pptEditorVoiceUXEnabled&&
!!this.vl&&!!this.vl.instance}mic(){this.bC.style.color="rgba( 255, 255, 255, 1 )";this.bC.innerText="";this.bC.scrollTop=this.bC.scrollHeight;this.WFa=this.VFa="";this.vYc=!1;this.Nbb=0;this.bC.style.padding="0px"}egj(ea,ia){this.vYc?this.H8h(ea):this.SRk(ea);this.vYc=ia;return m.a.Va(this.VFa)||m.a.Va(this.WFa)?m.a.Va(this.VFa)?this.WFa:this.VFa:this.VFa+"\n"+this.WFa}H8h(ea){this.VFa=m.a.Va(this.WFa)?this.VFa:this.WFa;this.WFa=ea}SRk(ea){m.a.Va(this.VFa)||m.a.Va(this.WFa)?this.VFa=ea:this.WFa=
ea}static get instance(){return Q.qp}static ryj(){Q.pX[1]=ResourceStrings.L_SubtitleDetection_Listening;Q.pX[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;Q.pX[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;Q.pX[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;Q.pX[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static zrl(ea,ia){return"undefined"===typeof ia?null:ia}}Q.pX=Array(20);Q.qp=new Q;Object(J.a)(Q,"SlideshowSubtitles",null,[950])},974:function(J,
V,d){J=d(0);var h=d(25),e=d(54),m=d(55),n=d(267),v=d(304);class A{constructor(Za,va=null){this.KQh=Za;this.CR=va||v.a.UYd(e.a.l3a,"")}get pu(){return this.KQh}get Hb(){return this.CR}rIe(Za){this.Hb.d++;return this.pu.rIe(Za)}yGb(Za){this.Hb.e++;return this.pu.yGb(Za)}hJ(Za){this.Hb.f++;return this.pu.hJ(Za)}QXa(Za){this.Hb.h++;return this.pu.QXa(Za)}e0(Za){this.Hb.i++;return this.pu.e0(Za)}EX(Za){this.Hb.j++;return this.pu.EX(Za)}L4(Za){this.Hb.k++;return this.pu.L4(Za)}GX(Za){this.Hb.l++;return this.pu.GX(Za)}sfd(Za){this.Hb.m++;
return this.pu.sfd(Za)}aIa(Za,va=!1){this.Hb.n++;return this.pu.aIa(Za,va)}w2d(){this.Hb.o++;return this.pu.w2d()}lMe(){this.Hb.p++;return this.pu.lMe()}OFb(Za){this.Hb.m++;return this.pu.OFb(Za)}Ss(Za){this.Hb.q++;return this.pu.Ss(Za)}Ema(Za){this.Hb.r++;return this.pu.Ema(Za)}fGb(Za){this.Hb.g++;return this.pu.fGb(Za)}Yfd(Za){return this.pu.Yfd(Za)}WXa(Za){this.Hb.s++;return this.pu.WXa(Za)}Ffd(Za){this.Hb.s++;return this.pu.Ffd(Za)}vea(Za){this.Hb.s++;return this.pu.vea(Za)}VXa(Za){this.Hb.s++;
return this.pu.VXa(Za)}Mfb(Za){this.Hb.t++;return this.pu.Mfb(Za)}Zfd(Za){this.Hb.u++;return this.pu.Zfd(Za)}vjc(Za){this.Hb.v++;return this.pu.vjc(Za)}Gma(Za){return this.pu.Gma(Za)}efd(Za){this.Hb.z++;return this.pu.efd(Za)}SEe(){return this.pu.SEe()}hIa(Za,va){this.Hb.w++;this.Hb.x++;return this.pu.hIa(Za,va)}c0(Za){this.Hb.y++;return this.pu.c0(Za)}clearFormatting(){return this.pu.clearFormatting()}clone(){return new A(this.pu.clone(),this.Hb)}}Object(J.a)(A,"FormattingStewardUsageCollector",
null,[1257]);class w extends A{constructor(Za,va=null){super(Za,va)}get i4(){return this.pu}get rD(){return this.i4.rD}set rD(Za){this.i4.rD=Za}get textIndent(){return this.i4.textIndent}get marginLeft(){return this.i4.marginLeft}get a9c(){return this.i4.a9c}get lineSpacing(){return this.i4.lineSpacing}get Eea(){return this.i4.Eea}get gVc(){return this.i4.gVc}get Qda(){return this.i4.Qda}get paragraph(){return this.i4.paragraph}set paragraph(Za){this.i4.paragraph=Za}get J5a(){return this.i4.J5a}wkd(Za){return this.i4.wkd(Za)}YQe(Za){return this.i4.YQe(Za)}clone(){const Za=
this.pu.clone();return new w(Za,this.Hb)}}Object(J.a)(w,"FormattingStewardUsageCollector",A,[1256,1257]);var y=d(31),u=d(74),E=d(188),G=d(659),I=d(51),H=d(144),K=d(70),C=d(56),Y=d(342),M=d(1056),P=d(330),T=d(45),L=d(1166),aa=d(1161),Q=d(1160),ea=d(109),ia=d(36),ja=d(79),D=d(39),pa=d(34),Z=d(86),oa=d(299);class Ba{}Ba.yellow="FFFF00";Ba.lime="00FF00";Ba.aqua="00FFFF";Ba.fuchsia="FF00FF";Ba.blue="0000FF";Ba.red="FF0000";Ba.navy="000080";Ba.teal="008080";Ba.green="008000";Ba.purple="800080";Ba.maroon=
"800000";Ba.olive="808000";Ba.gray="808080";Ba.Hel="C0C0C0";Ba.black="000000";Object(J.a)(Ba,"FontHighlightColorEnum",null,[]);var Ma=d(333),za=d(49),ka=d(865),qa=d(363),Ja=d(112);class xa{constructor(Za,va,Fa,Ca,La,nb,Nb,Rb,Ya=null,Qb=!1){this.xv=this.Yuc=null;this.APb=0;this.BXe=this.zPb=null;this.f1=0;this.MLa=this.sxc=this.Btc=this.axc=this.F0a=this.gga=this.Otc=this.Exc=null;this.FUf=.25*ea.Font.MH;this.paragraph=Za;this.Gf=va;this.QJ=Fa;this.IO=Ca;this.Efa=La;this.CU=nb;this.mY=Nb;this.P_a=
Rb;Ya?(Ja.a(4223818,307,!!Ya.xv),this.xv=Ya.xv.hDc(this.paragraph),this.APb=Ya.APb,this.zPb=Ya.zPb,Ya.gga&&(this.gga=new ka.a,this.gga.afterSpacing.value=Ya.gga.afterSpacing.value,this.gga.beforeSpacing.value=Ya.gga.beforeSpacing.value),Ya.F0a&&(this.F0a=Ya.F0a.clone()),this.f1=Ya.f1,this.sxc=Ya.sxc.clone(),this.Exc=Ya.Exc,this.Otc=Ya.Otc,this.axc=Ya.axc,this.Btc=Ya.Btc,Ya.Qda&&(this.MLa=Ya.Qda)):(this.xv=new oa.a(this.paragraph,0),this.xv.formatting=new Ma.a(this.xv,Y.a.nil),va=za.a.XNa(Za),va=this.IO.Bs(va),
this.r1k(va),xa.mal(Za)?(this.Efa.kIe(this.xv.formatting,va,Qb),this.f1=Za.Sa(ia.a.pl)?Za.getValue(ia.a.pl):0):this.f1=-1,this.APb=0,this.zPb=null,this.gga=this.c1i(),this.P_a&&(this.gga=this.Efa.xV(Za),this.F0a=this.Efa.AZd(Za),this.axc=this.Efa.sQa(Za),this.Btc=this.Efa.m7(Za)),this.sxc=new M.DictionaryPropertySet,this.Efa.XHe(this.xv.formatting,Za,Qb))}get paragraph(){return this.Yuc}set paragraph(Za){Ja.a(4223816,307,!!Za&&y.ParagraphReader.Wd(Za));this.Yuc=Za}get J5a(){return this.xv.formatting}get lec(){return this.APb}get N2g(){return this.zPb}get D1(){return this.BXe}get rD(){return this.f1}set rD(Za){Ja.a(4223817,
307,1===Za||2===Za||3===Za||pa.a.instance.ga(54)&&6===Za);this.f1=Za}get textIndent(){return this.Exc}get marginLeft(){return this.Otc}get a9c(){return this.gga}get lineSpacing(){return this.F0a}get Eea(){return this.axc}get gVc(){return this.Btc}get Qda(){return this.MLa}r1k(Za){const va=this.IO.language(Za);va&&this.Gf.tjc(this.xv.formatting,va,0,Za.cache.URa,!1)}c1i(){if(pa.a.instance.ga(54))return null;const Za=new ka.a;Za.afterSpacing.value=this.FUf;Za.beforeSpacing.value=this.FUf;return Za}rIe(Za){(Za=
n.a.le(Za))&&this.Gf.RXa(this.xv.formatting,Za.LCID);return!0}yGb(){return!1}hJ(Za){this.Gf.hJ(this.xv.formatting,Za);return!0}QXa(Za){this.Gf.setItalic(this.xv.formatting,Za);return!0}e0(Za){this.Gf.e0(this.xv.formatting,Za);return!0}EX(Za){this.Gf.EX(this.xv.formatting,Za);return!0}L4(Za){this.Gf.L4(this.xv.formatting,Za);return!0}GX(Za){this.Gf.GX(this.xv.formatting,Za);return!0}sfd(Za){if(0>=Za)return!1;this.Gf.yr(this.xv.formatting,Za);return!0}aIa(Za,va){if(!Za||""===Za)return!1;if(({fontInfo:Fa}=
P.FontUtils.Sql(Za)).returnValue)return this.Gf.AX(this.xv.formatting,Fa.fontName),!0;var Fa=!1;const Ca=P.FontUtils.rF(Za);va&&this.NTc(Ca,this.CU)&&(this.CU.createFontUrl(Za),Fa=!0);this.NTc(Ca,this.mY)&&(Fa=!0);Fa&&this.Gf.AX(this.xv.formatting,Ca);return Fa}NTc(Za,va){return!!va&&va.isEnabled&&va.NTc(Za)}w2d(){this.Gf.oOc(this.xv.formatting);return!0}lMe(){this.Gf.uhd(this.xv.formatting);return!0}OFb(Za){if(0>=Za)return!1;this.Gf.OFb(this.xv.formatting,Za);return!0}Ss(Za){var {Box4PasteSteward:va}=
d(245);if(!this.Gf.vwg(Za)){if(null===Za||""===Za)return!1;Za=va.b4a(Za)}va=null;this.Qda&&this.Qda.hasOwnProperty(D.a.listLevel.id.toString())&&(va=this.Qda[D.a.listLevel.id.toString()]);this.Gf.Ss(this.xv.formatting,Za,va);return!0}Ema(Za){const {Box4PasteSteward:va}=d(245);if(!Za||""===Za||pa.a.instance.ga(49)&&!xa.iij().contains(Za)||this.Efa.bph(this.xv.formatting))return!1;this.Gf.Ema(this.xv.formatting,va.b4a(Za));return!0}fGb(Za){this.Gf.fGb(this.xv.formatting,Za);return!0}Yfd(Za){let va=
0;switch(T.a.sg(Za)){case "small-caps":va=1;break;case "uppercase":va=2}this.Gf.im(this.xv.formatting,ja.a.capitalization,va);return!0}efd(Za){const {Box4PasteSteward:va}=d(245);if(!Za||""===Za)return!1;this.sxc.setValue(ia.a.sCc,parseInt(va.b4a(Za),16));return!0}VXa(Za){return 0>=Za?!1:this.Ffd(Z.StyleReader.Ydj(Za))}WXa(Za){this.clearFormatting();this.APb=Za;return!0}Ffd(Za){const {Box4PasteSteward:va}=d(245);return Za&&0<Za.length&&va.LHb&&va.LHb.oG(Za)?(this.zPb=Za,!0):!1}vea(Za){const {Box4PasteSteward:va}=
d(245);return Za&&0<Za.length&&va.LHb&&va.LHb.oG(Za)?(this.BXe=Za,!0):!1}YQe(Za){if(this.D1){Za=d(245).Box4PasteSteward.LHb||Z.StyleReader.tK(Za);if(!Za)return Ja.a(41968715,307,!1),!1;(Za=Za.oG(this.D1))&&this.Gf.vea(this.xv.formatting,Za);return!0}return!1}hIa(Za,va){if(pa.a.instance.ga(54))return!1;Ja.a(5297416,307,0<=Za&&0<=va);0<=Za&&(this.gga.beforeSpacing.value=Za);0<=va&&(this.gga.afterSpacing.value=va);return 0<=Za||0<=va}c0(Za){if(!pa.a.instance.ga(54)||!Za)return!1;const va=parseFloat(T.a.substring(Za,
0,T.a.sg(Za).indexOf("px")));if(!isNaN(va))return this.F0a=new qa.a(3,L.a.Uda(va,1)),!0;Za=parseFloat(T.a.substring(Za,0,T.a.sg(Za).indexOf("%")));return isNaN(Za)?!1:(this.F0a=new qa.a(2,Za/100),!0)}Mfb(Za){let va=0;if(!Za||""===Za)return!1;switch(Za){case "left":va=1;break;case "center":va=2;break;case "right":va=3;break;case "justify":pa.a.instance.ga(54)&&(va=6)}if(0===va)return!1;this.rD=va;return!0}Zfd(Za){this.Exc=Za;return!0}vjc(Za){this.Otc=Za;return!0}Gma(Za){this.MLa=JSON.parse(Za);return this.Qda?
!0:!1}clearFormatting(){this.xv.formatting=new Ma.a(this.xv,Y.a.nil);return!0}SEe(){this.f1=0;return!0}wkd(Za){var {Box4PasteSteward:va}=d(245);if(!pa.a.instance.ga(71))return!1;if(0<this.lec&&va.OGa[this.lec]){Ja.a(4223819,307,1<=this.lec);Ja.a(4223820,307,7>=this.lec);va=Z.StyleReader.tK(Za);if(!va)return Ja.a(4223821,307,!1),!1;va=va.oG(d(245).Box4PasteSteward.OGa[this.lec]);this.QJ.Y9(va,Za,!1);return!0}if(this.N2g){va=d(245).Box4PasteSteward.LHb||Z.StyleReader.tK(Za);if(!va)return Ja.a(41968716,
307,!1),!1;this.QJ.Y9(va.oG(this.N2g),Za,!1);return!0}return!1}clone(){return new xa(this.paragraph,this.Gf,this.QJ,this.IO,this.Efa,this.CU,this.mY,this.P_a,this)}static iij(){xa.$O||(xa.$O=new aa.a(Q.a.Qr()),xa.$O.add(Ba.yellow),xa.$O.add(Ba.lime),xa.$O.add(Ba.aqua),xa.$O.add(Ba.fuchsia),xa.$O.add(Ba.blue),xa.$O.add(Ba.red),xa.$O.add(Ba.navy),xa.$O.add(Ba.teal),xa.$O.add(Ba.green),xa.$O.add(Ba.purple),xa.$O.add(Ba.maroon),xa.$O.add(Ba.olive),xa.$O.add(Ba.gray),xa.$O.add(Ba.Hel),xa.$O.add(Ba.black));
return xa.$O}static mal(Za){if(!pa.a.instance.ga(71))return!0;Za=Z.StyleReader.BP(Z.StyleReader.kD(Za));return Za===Z.StyleReader.kEh||Za===Z.StyleReader.HJa||Za===Z.StyleReader.nEh||Za===Z.StyleReader.Uma}}xa.$O=null;Object(J.a)(xa,"FormattingSteward",null,[1256,1257]);class Ga{lRe(){return!1}Q2d(Za){return Za}Gma(){}dGb(){}cSc(){return!1}get XSc(){return!1}c0(){}hIa(){}jmh(){}alh(){}get eph(){return!1}}Object(J.a)(Ga,"NoOpPasteStewardBridge",null,[263]);var na=d(17);class sa{constructor(Za,va){this.ufk=
Za;this.vfk=va||"Normal"}}Object(J.a)(sa,"NoteTagInfoBox4",null,[]);const Ha=Za=>{const va=new na.a;for(let Fa of Za)Za=new sa(Fa.ufk,Fa.vfk),va.add(Za);return va};d.d(V,"a",function(){return cb});class cb{constructor(Za,va,Fa=null,Ca=null){this.mY=this.CU=null;this.ATi=h.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.Agf=0;this.wb=Za;this.SF=va;this.cY=Ca||new Ga;this.CR=Fa||v.a.UYd(e.a.l3a,"")}get Hb(){return this.CR}get characterPropertiesEditor(){return cb.Vg||(cb.Vg=
m.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.CU||(this.CU=m.a.instance.pb("Box4.IFontService"))}get AAa(){return this.mY||(this.mY=m.a.instance.pb("Box4.CustomFontService"))}reset(){}get eXb(){return this.hYd(!1)}hYd(Za){Ja.a(4223770,307,C.OutlineElementReader.Tg(this.wb));const va=I.OutlineElementNavigator.oi(this.wb);I.OutlineElementNavigator.Je(this.wb);Ja.a(4223771,307,!!va&&y.ParagraphReader.Wd(va));Za=new xa(va,cb.$g,cb.qO,cb.qUi,cb.rUi,this.fontService,
this.AAa,this.ATi,void 0,Za);return new w(Za,this.Hb)}I_(){}zla(){}kWa(){}yla(){}xla(){}Tua(){}Sua(){}Uz(){}Tz(){}fWa(){}eWa(){}Yua(){}HGa(){}Cla(){}Ala(){}Xua(){}Bla(){}gWa(){}nBb(Za){C.OutlineElementReader.Tg(this.wb)?(cb.Jh.L2b(this.wb,!0),I.OutlineElementNavigator.OI(this.wb,!1,!1)):K.OutlineReader.At(this.wb)?H.OutlineNavigator.v9(this.wb)?Za?(this.wb.Ii(),cb.WA.IY(this.wb,!1)):cb.Jh.Hhc(this.wb):cb.WA.IY(this.wb,!1):Ja.a(8128524,307,!1,"Unexpected node type {0} encountered",this.wb.mi)}aQa(Za){let va=
null;if(Za&&Za.xT&&Za.cultureName)try{va=Object.assign(new G.a,{languageId:n.a.le(Za.cultureName).LCID})}catch(Fa){Ja.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Za.cultureName,Fa)}va||null==this.SF||(va=Object.assign(new G.a,{languageId:this.SF}));return va}get zL(){return this.Agf}set zL(Za){this.Agf=Za}EAc(){}jkd(){}gMd(){}get $3a(){return!1}get p4a(){return!1}TSj(Za){let va=1;if(Za.lug){var Fa=0;switch(Za.listStyleType){case 1:va=0;break;case 7:va=1;break;case 8:va=2;break;case 9:va=
3;break;case 10:va=4;break;case 11:va=5}}else switch(Fa=1,Za.listStyleType){case 1:va=0;break;case 3:va=1;break;case 4:va=2;break;case 5:va=3}let Ca;Fa=(Ca=u.ListReader.i5a)?E.a.kP(Fa,va,Ha(Za.o4),Za.listId,Za.listLevel,Za.levelText,Za.font):E.a.kP(Fa,va,Ha(Za.o4));Za.lug&&!Za.qCj&&(Fa.Yz=Ca&&0<Za.listId&&0<=Za.listLevel&&!Za.YCb?Za.Igl:Za.oCi);this.cY.dGb(this.wb,Fa,Za);return Fa}gX(){}dX(){}fX(){}eX(){}cX(){}bX(){}static get Jh(){return cb.xi||(cb.xi=m.a.instance.resolve("Box4.IOutlineElementEditor"))}static get WA(){return cb.ox||
(cb.ox=m.a.instance.resolve("Box4.IOutlineEditor"))}static get $g(){return cb.Gf||(cb.Gf=m.a.instance.resolve("Box4.IFormattingEditor"))}static get qO(){return cb.QJ||(cb.QJ=m.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get qUi(){return cb.IO||(cb.IO=m.a.instance.resolve("Box4.IFormattingReader"))}static get rUi(){return cb.Efa||(cb.Efa=m.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}cb.xi=null;cb.ox=null;cb.Vg=null;cb.Gf=null;cb.QJ=null;cb.IO=null;cb.Efa=null;Object(J.a)(cb,
"Box4PasteStewardBase",null,[1189,1190,402])},976:function(J,V,d){d.r(V);J=d(0);var h=d(701),e=d(991),m=d(980),n=d(196),v=d(13),A=d(36),w=d(70),y=d(30),u=d(37),E=d(26),G=d(41);class I{constructor(Q,ea){this.ge=Q;this.Wf=ea}}Object(J.a)(I,"RowSpan",null,[]);class H{constructor(Q){this.QA=Q;this.RFa=[]}TFd(Q,ea){Array.add(this.RFa,new I(Q,ea))}QVk(Q){for(let ea=0;ea<this.RFa.length;ea++){const ia=this.RFa[ea];Q<=ia.ge&&ia.ge++;Q<=ia.Wf&&ia.Wf++}}get x(){return this.QA}get Hgh(){return this.RFa}static Pae(Q,
ea){return Q.QA===ea}static gNd(Q,ea){Q=Q.QA-ea.QA;return 0<Q?1:0>Q?-1:0}}Object(J.a)(H,"ColSplit",null,[]);const K=(Q,ea,ia)=>{let ja;ja=-1;for(let D=0;D<Q.length;++D)if(ia(Q.ga(D),ea))return ja=D,{returnValue:!0,utb:ja};return{returnValue:!1,utb:ja}};class C{constructor(Q,ea){this.Yd=Q;this.Jf=ea}}Object(J.a)(C,"ColSpan",null,[]);class Y{constructor(Q){this.RA=Q;this.RFa=[]}TFd(Q,ea){Array.add(this.RFa,new C(Q,ea))}qoi(Q){for(let ea=0;ea<this.RFa.length;ea++){const ia=this.RFa[ea];Q<=ia.Yd&&ia.Yd++;
Q<=ia.Jf&&ia.Jf++}}get uOf(){return this.RFa}get y(){return this.RA}static Pae(Q,ea){return Q.RA===ea}static gNd(Q,ea){Q=Q.RA-ea.RA;return 0<Q?1:0>Q?-1:0}}Object(J.a)(Y,"RowSplit",null,[]);var M=d(931),P=d(27);class T{constructor(Q,ea,ia,ja,D,pa,Z,oa,Ba,Ma,za,ka,qa,Ja,xa){this.IRa=!1;this.Ui=this.pCc=this.wPg=this.j3c=null;this.izh=Q;this.Uc=ea;this.ish=ia;this.vYa=ja;this.zmd=D;this.tableNode=pa;this.Cd=Z;this.PX=oa;this.aQa=Ba;this.RVk=Ma;this.roi=za;this.Tdd=ka;this.sDc=qa;this.rows=Ja;this.cols=
xa;this.wYa=0;this.S4b=!1}i3a(Q){this.j3c=new Date;this.wPg=Q}U4a(){this.j3c>P.App.Im&&this.Uc&&this.Uc.Wa(this.wPg,(+new Date-+this.j3c).toString());this.j3c=P.App.Im}finish(){const {TableMergeSplitEditor:Q}=d(976);this.Uc&&(this.Ui&&(this.S4b=!1,this.Uc.Wa(Q.BCl,this.Ui.message)),this.Uc.Wa("SplitCellsSucceeded",this.S4b.toString()),this.Uc.finish(),this.Uc=null);if(this.Ui)throw this.Ui;this.ish&&this.ish(this.S4b,this.vYa)}}Object(J.a)(T,"SplitCellsArguments",null,[]);var L=d(322);d.d(V,"TableMergeSplitEditor",
function(){return aa});class aa{constructor(Q,ea,ia,ja,D,pa,Z,oa,Ba,Ma,za,ka,qa,Ja,xa){this.Mb=Q;this.RW=ea;this.Qz=ia;this.U3=ja;this.t3c=D;this.WK=pa;this.n1c=Z;this.vq=Ba;this.yca=Ma;this.c$b=za;this.Dk=ka;this.Db=qa;this.ra=Ja;this.y2c=xa}merge(Q,ea,ia){const ja=Q.ef(ea.ge,ea.Yd),D=this.Mb.Kc(ja);let pa=D.uA(1);const Z=[u.a.rowId,u.a.cellId];pa&&D.uc();let oa=!0;for(let Ma=ea.ge;Ma<ea.Wf;++Ma){let za=Q.ef(Ma,ea.Yd);for(let ka=ea.Yd+(Ma===ea.ge?1:0);ka<ea.Jf;++ka)if(ka!==ea.Yd&&(za=Q.ef(Ma,ka)),
!za||!za.isGhostCell){za.Nn(u.a.rowSpan,u.a.colSpan);za.isGhostCell=!0;var Ba=y.GraphIterator.mb(za);w.OutlineReader.isEmpty(Ba)?this.Lbh(Ba):(oa&&w.OutlineReader.isEmpty(D)&&(oa=!1,pa=null,this.Lbh(D)),this.WK.TTi(za,qa=>{this.WK.vx(D.currentNode,qa,Z);return!0},qa=>11===qa.type||22===qa.type||12===qa.type),Ba=this.Mb.$Yd(Ba),Ba.zb(1),this.WK.ydk(D,pa,Ba.role,Ba.role,Ba),Ba.Ssb(1),pa=Ba.currentNode)}}this.U3.ltl(ia,ja,ea);ja.rowSpan=ea.$N;ja.colSpan=ea.CQ;Q.setValue(u.a.complexTable,!0);this.n1c.DDe(Q);
Q.Uba(511);this.Qz.R2b(Q);return ja}Ofl(Q,ea,ia,ja,D,pa,Z,oa,Ba){if(1>=ia&&1>=ja)Ba&&Ba(!0,ea);else{var Ma=new Date,za=G.a.hm("SplitCells",1);za.Ij=!0;var ka=new h.a,qa=new e.a,Ja=new e.a,xa=this.yca.bBa(Q,D,ea);ea=this.vq.oIc(D,ea);var Ga=pa.Jcg();for(pa=pa.D7f();xa.moveNext();){ka.add(xa.d_b().id.toString());const cb=xa.Ez;for(var na=1;na<ia;na++){var sa=Ga[cb.ge];sa+=(Ga[cb.Wf]-sa)*na/ia;var Ha=void 0;({utb:Ha}=K(qa,sa,Y.Pae)).returnValue||(Ha=qa.length,qa.add(new Y(sa)));qa.ga(Ha).TFd(cb.Yd,cb.Jf)}for(na=
1;na<ja;na++)sa=pa[cb.Yd],sa+=(pa[cb.Jf]-sa)*na/ja,({utb:Ha}=K(Ja,sa,H.Pae)).returnValue||(Ha=Ja.length,Ja.add(new H(sa))),Ja.ga(Ha).TFd(cb.ge,cb.Wf)}qa=qa.toArray();Ja=Ja.toArray();qa.sort((cb,Za)=>Y.gNd(Za,cb));Ja.sort((cb,Za)=>H.gNd(Za,cb));za.Wa("Prep",(+new Date-+Ma).toString());Ma=this.Db.je(15);Ma.jc(Q);Q=new T(Ma,za,Ba,ea,ka,Q,Z,D,oa,Ga,pa,qa,Ja,ia,ja);Q=new m.a(null,Object(v.a)(this,this.Wfl,"splitRowSeams"),Q);Q.Vi=!1;Q.xl("SplitTableCells");Q.run()}}Wfl(Q,ea){try{for(ea.i3a("SplitRowSeams");ea.wYa<
ea.Tdd.length;){const ia=({IRa:ea.IRa}=this.svi(ea.tableNode,ea.Cd,ea.PX,ea.aQa,ea.RVk,ea.Tdd[ea.wYa])).returnValue;ea.wYa++;if(ea.IRa){let ja;(ja=ea.vYa).Wf=ja.Wf+1;for(let D=0;D<ea.sDc.length;D++)ea.sDc[D].QVk(ia)}if(Q.Zma)return!0}ea.U4a();ea.wYa=0;Q.Wg(Object(v.a)(this,this.Sfl,"splitColSeams"))}catch(ia){ea.Ui=ia,Q.Wg(Object(v.a)(this,this.Vgb,"tearDownSplit"))}return!0}Sfl(Q,ea){try{for(ea.i3a("SplitColSeams");ea.wYa<ea.sDc.length;){const ia=({IRa:ea.IRa}=this.rvi(ea.tableNode,ea.Cd,ea.PX,ea.aQa,
ea.roi,ea.sDc[ea.wYa])).returnValue;ea.wYa++;if(ea.IRa){let ja;(ja=ea.vYa).Jf=ja.Jf+1;for(let D=0;D<ea.Tdd.length;++D)ea.Tdd[D].qoi(ia)}if(Q.Zma)return!0}ea.U4a();ea.wYa=0;Q.Wg(Object(v.a)(this,this.pJb,"updateIsComplexTableProperty"))}catch(ia){ea.Ui=ia,Q.Wg(Object(v.a)(this,this.Vgb,"tearDownSplit"))}return!0}pJb(Q,ea){try{ea.i3a("UpdateComplex"),this.n1c.pSe(this.Mb.Kc(ea.tableNode)),ea.U4a(),ea.pCc=this.yca.bBa(ea.tableNode,ea.PX,ea.vYa),Q.Wg(Object(v.a)(this,this.CSi,"fixSplitCells"))}catch(ia){ea.Ui=
ia,Q.Wg(Object(v.a)(this,this.Vgb,"tearDownSplit"))}return!0}CSi(Q,ea){try{for(ea.i3a("FixInsideBorders");ea.pCc.moveNext();)if(ea.zmd.contains(ea.pCc.d_b().id.toString())&&this.BSi(ea.tableNode,ea.PX,ea.pCc,ea.rows,ea.cols),Q.Zma)return!0;ea.U4a();Q.Wg(Object(v.a)(this,this.MLi,"ensureMinRowHeightColumnWidth"))}catch(ia){ea.Ui=ia,Q.Wg(Object(v.a)(this,this.Vgb,"tearDownSplit"))}return!0}MLi(Q,ea){try{ea.i3a("EnsureMinHeightWidth"),1<ea.rows&&this.NLi(ea.tableNode,ea.vYa),1<ea.cols&&this.LLi(ea.tableNode,
ea.vYa),ea.U4a(),Q.Wg(Object(v.a)(this,this.setSelection,"setSelection"))}catch(ia){ea.Ui=ia,Q.Wg(Object(v.a)(this,this.Vgb,"tearDownSplit"))}return!0}setSelection(Q,ea){try{ea.i3a("SetSelection");ea.S4b=!ea.vYa.hPa();if(ea.S4b){const ia=this.y2c.$Ai(ea.tableNode,ea.PX,ea.vYa);ia&&this.ra.ZD(ia)}ea.U4a();ea.i3a("Render");Q.Vi||ea.izh.olh(Q);ea.izh.dispose();Q.Wg(Object(v.a)(this,this.Vgb,"tearDownSplit"))}catch(ia){ea.Ui=ia,Q.Wg(Object(v.a)(this,this.Vgb,"tearDownSplit"))}return!0}Vgb(Q,ea){ea.U4a();
ea.finish();return!1}svi(Q,ea,ia,ja,D,pa){var Z;let oa=({H9d:Z}=M.c(D,pa.y)).returnValue;if(Z=!Z){oa++;var Ba=D[oa-1],Ma=D[oa],za=this.Mb.Kc(Q);this.kcc(za,oa-1);var ka=za.currentNode;za=this.n1c.b6d(za);Ba=pa.y-Ba;ka.setValue(u.a.Rt,ea.Ef(Ba,1));Ba=Ma-pa.y;za.setValue(u.a.Rt,ea.Ef(Ba,1));Array.insert(D,oa,pa.y);ia.rRa(3)}for(ea=0;ea<pa.uOf.length;++ea){D=pa.uOf[ea];Ma=[];for(ka=D.Yd;ka<=D.Jf;++ka)({kja:Ba}=this.t3c.Vxh(Q,ia,ka,oa)),Ma[Ma.length]=Ba;ka=new L.a;ka.Yd=D.Yd;ka.Jf=D.Jf;ka.ge=oa-1;ka.Wf=
oa+1;for(ka=this.yca.bBa(Q,ia,ka);ka.moveNext();)Ba=ka.Ez,za=ka.d_b(),this.JQf(oa,Ba.Yd,za),this.ykh(oa,Ba.Yd,za,ja);for(ka=D.Yd;ka<D.Jf;++ka){Ba=Q.ef(oa-1,ka);za=Q.ef(oa,ka);var qa=this.vq.QH(ia,oa-1,ka);qa.Yd===ka&&(Ba=Q.ef(qa.ge,qa.Yd),qa=oa-qa.ge,za.rowSpan=Ba.rowSpan-qa,Ba.rowSpan=qa,za.colSpan=Ba.colSpan);za.isGhostCell=Ba.isGhostCell}ia.rRa(1);this.U3.CVd(Q,ia,oa,D.Yd,D.Jf,!0);for(let Ja=D.Yd,xa=0;Ja<=D.Jf;++Ja,++xa)Ma[xa]&&this.U3.sJe(Q,ia,Ja,oa,oa+1,Ma[xa])}return{returnValue:oa,IRa:Z}}rvi(Q,
ea,ia,ja,D,pa){var Z;let oa=({H9d:Z}=M.b(D,pa.x)).returnValue;if(Z=!Z){oa++;var Ba=D[oa-1],Ma=D[oa],za=this.Mb.Kc(Q);this.RW.GTg(za);za.Jp(oa-1,1);this.n1c.a6d(za);if(za=Q.sa(A.a.uu,null))za=n.a.clone(za),za[oa-1]=ea.Ef(pa.x-Ba,0),za[oa]=ea.Ef(Ma-pa.x,0),Q.setValue(A.a.uu,za);Array.insert(D,oa,pa.x);ia.rRa(3)}for(ea=0;ea<pa.Hgh.length;++ea){D=pa.Hgh[ea];Ba=[];for(Ma=D.ge;Ma<=D.Wf;++Ma)({kja:za}=this.t3c.Rxh(Q,ia,Ma,oa)),Ba[Ba.length]=za;Ma=new L.a;Ma.ge=D.ge;Ma.Wf=D.Wf;Ma.Yd=oa-1;Ma.Jf=oa+1;for(Ma=
this.yca.bBa(Q,ia,Ma);Ma.moveNext();){za=Ma.Ez;var ka=Ma.d_b();this.JQf(za.ge,oa,ka);this.ykh(za.ge,oa,ka,ja)}for(Ma=D.ge;Ma<D.Wf;++Ma){za=Q.ef(Ma,oa-1);ka=Q.ef(Ma,oa);var qa=this.vq.QH(ia,Ma,oa-1);qa.ge===Ma&&(za=Q.ef(qa.ge,qa.Yd),qa=oa-qa.Yd,ka.colSpan=za.colSpan-qa,za.colSpan=qa,ka.rowSpan=za.rowSpan);ka.isGhostCell=za.isGhostCell}ia.rRa(1);this.U3.DVd(Q,ia,oa,D.ge,D.Wf,!0);for(let Ja=D.ge,xa=0;Ja<=D.Wf;++Ja,++xa)Ba[xa]&&this.U3.nIe(Q,ia,Ja,oa,oa+1,Ba[xa])}return{returnValue:oa,IRa:Z}}BSi(Q,ea,
ia,ja,D){var pa=this.yca.bBa(Q,ea,ia.DD);pa.moveTo(ia.LN,ia.LK);ia=pa.Ez;for(let Z=1;Z<ja;++Z)pa.Idk(),ia.Wf=pa.Ez.Wf,ia.Jf=pa.Ez.Jf;for(ja=1;ja<D;++ja)pa.moveNext(),ia.Wf=pa.Ez.Wf,ia.Jf=pa.Ez.Jf;for(D=this.yca.bBa(Q,ea,ia);D.moveNext();){pa=D.Ez;let Z;pa.Wf<ia.Wf&&({kja:Z}=this.t3c.Rxh(Q,ea,ia.Wf,pa.Yd)).returnValue&&this.U3.nIe(Q,ea,pa.Wf,pa.Yd,pa.Jf,Z);pa.Jf<ia.Jf&&({kja:Z}=this.t3c.Vxh(Q,ea,ia.Jf,pa.ge)).returnValue&&this.U3.sJe(Q,ea,pa.Jf,pa.ge,pa.Wf,Z)}}NLi(Q,ea){Q=this.Mb.Kc(Q);this.kcc(Q,
ea.ge);for(let ia=ea.ge;ia<ea.Wf;++ia){const ja=Q.currentNode.sa(u.a.Rt,0);ja&&ja<this.Dk.XBc(Q.currentNode)&&Q.currentNode.setValue(u.a.Rt,0);Q.uf(1)}}LLi(Q,ea){let ia=Q.sa(A.a.uu,null),ja=!1;if(ia){ia=n.a.clone(ia);for(let D=ea.Yd;D<ea.Jf;++D){const pa=this.Dk.job(Q,D);ia[D]&&ia[D]<pa&&(ia[D]=pa,ja=!0)}}ja&&Q.setValue(A.a.uu,ia)}JQf(Q,ea,ia){const ja=ia.getContainingTable();ja||E.a.J(512495627,822,10,"Not able to access TableNode from Table Cell Node");ja.ef(Q,ea).cellShading=ia.cellShading}ykh(Q,
ea,ia,ja){const D=ia.getContainingTable();D||E.a.J(512495625,822,10,"Not able to access TableNode from Table Cell Node");Q=y.GraphIterator.mb(D.ef(Q,ea));this.c$b.IY(Q,!0,ja(ia))}kcc(Q,ea){for(this.RW.GTg(Q);0<ea--;)this.RW.Odk(Q)}Lbh(Q){Q=this.Mb.$Yd(Q);let ea=Q.zb(1);for(;ea;)ea=Q.yOa(1)}}Object(J.a)(aa,"TableMergeSplitEditor",null,[320])},977:function(J,V,d){J=d(0);var h=d(13),e=d(375),m=d(25),n=d(163),v=d(191),A=d(55);class w{constructor(M,P,T,L){this.Mwd=null;this.Aqc=L;this.daa=M;this.eaa=P;
this.BO=T;this.ouf=this.rRg.I9k;M=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.MPh=M[0];this.LPh=M[1]}get rRg(){return this.Mwd||(this.Mwd=A.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get $Qa(){return CommonUIStrings.l_OICErrorHelpLink}get lkc(){return this.ouf}get tRg(){return this.MPh}get sRg(){return this.LPh}get qRg(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.ouf?
3:2}get DYb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get aEc(){return!!this.eaa}get EYb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get xOa(){return CommonUIStrings.l_DefaultDialogTitle}hCe(M){this.Icc(M)}ybe(M){this.Icc(M)}Icc(M){let P=10;this.eaa&&1===M&&(this.eaa(this.BO),P=1);this.daa&&this.daa(this.BO);this.Xo(P)}Ecb(){v.Redirect.showHelp("OICFailure");this.Xo(2)}Jte(){this.rRg.uzg();this.Xo(4)}Xo(M){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.Aqc,M);m.AFrameworkApplication.zeb(n.a.z1g,this.Aqc,M)}dispose(){this.BO=this.daa=this.eaa=null}}Object(J.a)(w,"AOICErrorDialog",null,[106]);var y=d(89),u=d(103);class E extends w{constructor(M,P,T,L){super(M,P,T,L);this.pLa=this.fz=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=this.errorMessage;M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));this.fz=document.createElement("a");this.fz.href="#";this.fz.innerText=this.$Qa;M.appendChild(this.fz);
y.a.addHandler(this.fz,"click",Object(h.a)(this,this.Ecb,"oicErrorHelpLinkHandler"));P=new u.StandardDialog;P.kg=this.id;this.lkc?(T=document.createElement("span"),L=document.createElement("span"),T.innerText=this.tRg,L.innerText=this.sRg,this.pLa=document.createElement("a"),this.pLa.href="#",this.pLa.innerText=this.qRg,M.appendChild(document.createElement("br")),M.appendChild(T),M.appendChild(this.pLa),M.appendChild(L),y.a.addHandler(this.pLa,"click",Object(h.a)(this,this.Jte,"oicErrorMacOfferLinkHandler"))):
this.aEc&&(M.appendChild(document.createElement("br")),M.appendChild(document.createElement("br")),T=document.createElement("span"),T.innerText=this.DYb,M.appendChild(T));this.aEc?(P.vd=1,P.Re(1,this.EYb)):P.vd=0;P.Yw(this.xOa,null,this.icon,Object(h.a)(this,this.ybe,"legacyOICErrorDialogHandler"),M);P.J4("errorMessageText")}dispose(){this.fz&&(y.a.removeHandler(this.fz,"click",Object(h.a)(this,this.Ecb,"oicErrorHelpLinkHandler")),this.fz=null);this.pLa&&(y.a.removeHandler(this.pLa,"click",Object(h.a)(this,
this.Jte,"oicErrorMacOfferLinkHandler")),this.pLa=null);super.dispose()}}Object(J.a)(E,"OICErrorDialog",w,[]);class G{constructor(M,P,T){this.daa=P;this.eaa=M;this.BO=T}get id(){return"OICErrorDialogWithDownload"}get S_f(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get $Qa(){return CommonUIStrings.l_OICErrorHelpLink}get DYb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get EYb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get xOa(){return CommonUIStrings.l_DefaultDialogTitle}hCe(M){this.Icc(M)}ybe(M){this.Icc(M)}Icc(M){let P=
10;1===M&&(this.eaa(this.BO),P=1);this.daa&&this.daa(this.BO);this.Xo(P)}Ecb(){v.Redirect.showHelp("OICFailure");this.Xo(2)}Xo(M){m.AFrameworkApplication.zeb(n.a.A1g,3,M)}dispose(){this.BO=this.eaa=this.daa=null}}Object(J.a)(G,"AOICErrorDialogWithDownload",null,[106]);class I extends G{constructor(M,P,T){super(M,P,T);this.fz=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=this.S_f;M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));this.fz=
document.createElement("a");this.fz.href="#";this.fz.innerText=this.$Qa;M.appendChild(this.fz);y.a.addHandler(this.fz,"click",Object(h.a)(this,this.Ecb,"oicErrorHelpLinkHandler"));M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));P=document.createElement("span");P.innerText=this.DYb;M.appendChild(P);P=new u.StandardDialog;P.kg=this.id;P.vd=1;P.Re(1,this.EYb);P.Yw(this.xOa,null,this.icon,Object(h.a)(this,this.ybe,"legacyOICErrorDialogHandler"),M);P.J4("errorMessageText")}dispose(){this.fz&&
(y.a.removeHandler(this.fz,"click",Object(h.a)(this,this.Ecb,"oicErrorHelpLinkHandler")),this.fz=null);super.dispose()}}Object(J.a)(I,"OICErrorDialogWithDownload",G,[]);var H=d(82);class K extends w{constructor(M,P,T,L){super(M,P,T,L);P={["errorMessage"]:this.errorMessage};P.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.$Qa,["onExecute"]:aa=>{this.Ecb(aa)}};this.lkc?(P.macOfficePreLinkText=this.tRg,P.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.qRg,
["onExecute"]:aa=>{this.Jte(aa)}},P.macOfficePostText=this.sRg):this.aEc&&(P.errorFileDownloadOffer=this.DYb);M=new H.a(!1,!1,!0);this.aEc?(M.vd=1,M.Re(1,this.EYb)):M.vd=0;M.kg=this.id;P={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:P};M.pj(this.xOa,Object(h.a)(this,this.hCe,"reactOICErrorDialogHandler"),P)}}Object(J.a)(K,"ReactOICErrorDialog",w,[]);class C extends G{constructor(M,P,T){super(M,P,T);P={["errorMessage"]:this.S_f,["errorFileDownloadOffer"]:this.DYb};P.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.$Qa,["onExecute"]:L=>{this.Ecb(L)}};M=new H.a(!1,!1,!0);M.vd=1;M.Re(1,this.EYb);M.kg=this.id;P={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:P};M.pj(this.xOa,Object(h.a)(this,this.hCe,"reactOICErrorDialogHandler"),P)}}Object(J.a)(C,"ReactOICErrorDialogWithDownload",G,[]);d.d(V,"a",function(){return Y});class Y{constructor(){this.boa=!!m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.gb.QB}Kyi(M,P,T){this.boa?new K(M,P,null,T):new E(M,P,null,T)}Lyi(M,
P,T){this.boa?new C(M,P,T):new I(M,P,T)}Myi(M,P,T,L,aa){const {ReactOICErrorDialogWithTrial:Q}=d(1074),{OICErrorDialogWithTrial:ea}=d(1075);this.boa?new Q(M,P,T,null,L,aa):new ea(M,P,T,null,L,aa)}static get instance(){return Y.Ja||(Y.Ja=new Y)}}Y.Ja=null;Object(J.a)(Y,"OICErrorDialogFactory",null,[1436])},981:function(J,V,d){J=d(0);var h=d(375),e=d(94),m=d(62),n=d(87);class v{constructor(){this.hasImpliedUsage=this.additionalValues=this.isInternal=this.isIntentional=null}}Object(J.a)(v,"IKpiFailureOptionalProperties",
null,[]);class A{constructor(){this.hasImpliedUsage=this.additionalValues=null}}Object(J.a)(A,"IKpiSuccessOptionalProperties",null,[]);var w=d(904);class y{constructor(){this.blockFutureEmissionDurationInMs=this.optionalVeto=this.optionalProperties=this.errorName=this.kpiName=null}}Object(J.a)(y,"KpiFailureParams",null,[]);class u{constructor(){this.blockFutureEmissionDurationInMs=this.optionalProperties=this.kpiName=null}}Object(J.a)(u,"KpiSuccessParams",null,[]);var E=d(905);d.d(V,"a",function(){return G});
class G{static getInstance(I){try{return healthSmall.HealthFactoryGlobal.getExtendedHealthInstance(e.Health.instance,I)}catch(H){return h.ULS.DFb(521457890,383,10,H,"Failed to initialize extendedHealth"),null}}static KIk(I,H){const K=G.getInstance(I);K&&K.logKpiUsage(G.v5i());const C=m.a.oj();try{const Y=H();Y.then(M=>{const P=G.u5i(m.a.oj()-C);K&&K.logKpiSuccess(P);return M}).catch(M=>{M=G.M$f(M?M.toString():"UnknownError",m.a.oj()-C);K&&K.logKpiFailure(M)});return Y}catch(Y){throw I=G.M$f(Y.message,
m.a.oj()-C),K&&K.logKpiFailure(I),Y;}}static v5i(){const I=Object.assign(new w.a,{extendedProperties:G.sYd()});return Object.assign(new E.a,{kpiName:"InitFloodgate",kpiType:0,optionalProperties:I,blockFutureEmissionDurationInMs:3E5})}static u5i(I=null){I=Object.assign(new A,{additionalValues:Object.assign(new n.a,{extendedProperties:G.sYd(),durationMs:I})});return Object.assign(new u,{kpiName:"InitFloodgate",optionalProperties:I,blockFutureEmissionDurationInMs:3E5})}static M$f(I,H=null){H=Object.assign(new v,
{additionalValues:Object.assign(new n.a,{extendedProperties:G.sYd(),durationMs:H})});return Object.assign(new y,{kpiName:"InitFloodgate",errorName:I,optionalProperties:H,optionalVeto:null,blockFutureEmissionDurationInMs:3E5})}static sYd(){const I=new Map;I.has("SkipAria")||I.set("SkipAria","True");return I}}Object(J.a)(G,"ExtendedHealth",null,[])},986:function(J,V,d){J=d(0);var h=d(375),e=d(1158),m=d(1159),n=d(1160),v=d(119),A=d(25),w=d(981),y=d(195),u=d(268),E=d(93),G=d(247),I=d(301),H=d(33),K=d(54),
C=d(45);class Y{constructor(){this.cvFlights=this.uiHost=this.productName=null;this.isCVSurveyEnabled=!1}}Object(J.a)(Y,"CustomerVoiceSurveyParams",null,[]);var M=d(141),P=d(521);class T{sendTelemetryEvent(Q){const ea=new P.a;ea.otelEvent=Q;M.a.sendOtelEvent(ea)}}Object(J.a)(T,"OtelTelemetrySink",null,[1330]);var L=d(906);d.d(V,"a",function(){return aa});class aa{static init(Q,ea,ia,ja,D){D.onDismiss=Q;D.onError=ea;Q=null;OfficeBrowserFeedback.initOptions?("screenshot"in D&&(OfficeBrowserFeedback.initOptions.screenshot=
D.screenshot),"showEmailAddress"in D&&(OfficeBrowserFeedback.initOptions.showEmailAddress=D.showEmailAddress),"feedbackForumUrl"in D&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=D.feedbackForumUrl),Q=D):OfficeBrowserFeedback.initOptions=D;OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=aa.ASf());OfficeBrowserFeedback.multiFeedback(Q).then(()=>{h.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")}).catch(pa=>h.ULS.sendTraceTag(36300303,
356,10,"BFCOCV Error:"+pa.toString()))}static y5d(Q,ea,ia,ja){h.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback");if(aa.akb===aa.initialized)return Promise.resolve(1);if(aa.akb===aa.jmg)return aa.kmg||(aa.kmg=!0,h.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(aa.akb!==aa.error){aa.akb=aa.jmg;h.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check");if(aa.hwj(Q,ea,ia,ja))return aa.Nvj();aa.akb=aa.error;Promise.reject(aa.GVg)}return Promise.reject(0)}static Nvj(){try{return w.a.KIk(aa.t5i(),
()=>OfficeBrowserFeedback.floodgate.initialize().then(()=>aa.bNe())).catch(Q=>{h.ULS.sendTraceTag(36546402,356,10,"BFCOCV Floodgate initialize error:"+Q.toString())})}catch(Q){return h.ULS.sendTraceTag(590975881,356,15,"BFCOCV Floodgate initialize error:"+Q.toString()),Promise.reject(aa.tgk)}}static t5i(){return Object.assign(new L.a,{featureName:"Floodgate",crewAlias:"floodgatecrew",vetoPillar:"OfficeBrowserFeedback"})}static bNe(){return OfficeBrowserFeedback.floodgate.start().then(()=>{aa.fTi()}).catch(Q=>
{h.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+Q.toString())})}static fTi(){aa.akb=aa.initialized;h.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate");try{const Q=A.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const ea of Q.split("|"))ea&&aa.logActivity(ea,null)}catch(Q){h.ULS.sendTraceTag(539015366,356,50,"Error triggering test activity")}}static usa(){let Q=!1;const ea=A.AFrameworkApplication.fa;ea&&(Q=
"teams"===(ea.Ha(A.AFrameworkApplication.oJ)||"").toLowerCase());return K.a.xDa||Q}static LVg(){return"undefined"==typeof OfficeBrowserFeedback}static hwj(Q,ea,ia,ja){let D=!0;try{if(aa.LVg())return h.ULS.sendTraceTag(39900617,356,15,aa.GVg),!1;OfficeBrowserFeedback.initOptions||(ia.onDismiss=ja,ia.onError=ea,ia=aa.t8h(ia),OfficeBrowserFeedback.initOptions=ia);OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=aa.ASf());ea={};ja={};ja.onSurveyActivated=
aa.Wok;ja.onTeachingCampaignRender=ia.onTeachingCampaignRender;ea.onSurveyActivatedCallback=ja;ea.onDismiss=Q;ea.autoDismiss=ia.FloodgateUIAutoDismissTimeEnum;ea.telemetryGroup=ia.telemetryGroup;ea.uIStringGetter=ia.uIStringGetter;ea.authTokenCallback=ia.authTokenCallback;ea.augLoopCallback=ia.augLoopCallback;ea.campaignFlights="";ea.governanceServiceEnabled=ia.governanceServiceEnabled;ea.governanceServiceConfig=ia.governanceServiceConfig;ea.personalizerEnabled=ia.personalizerEnabled;ea.messagingServiceSettings=
ia.messagingServiceSettings;ea.isPriorityEnabled=ia.isPriorityEnabled;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&("surveyEnabled"in ia&&(ea.surveyEnabled=ia.surveyEnabled),"showEmailAddress"in ia&&(ea.showEmailAddress=ia.showEmailAddress));ea.isEudbUxEnabled=!1;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",!1)&&(ea.isEudbUxEnabled=!0);const Z=aa.x0i(ia),oa=aa.B9f(Z);let Ba=aa.R0i(ia);
for(let Ma in oa){Q=Ma;var pa=oa[Ma];-1!==Q.toLowerCase().indexOf("flight")?ea.campaignFlights+=pa+";":Ba=Ba+Q+"="+pa+"&"}h.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+ea.campaignFlights+" campaignQueryParameters: "+Ba);ea.campaignQueryParameters=Ba;ea.customerVoiceSurveyParams=aa.J0i(ia.Application.toString(),aa.usa()?aa.vkl:"");OfficeBrowserFeedback.floodgate.initOptions=ea}catch(Z){D=!1,h.ULS.sendTraceTag(39900618,356,15,Z.toString())}return D}static t8h(Q){try{const ea=Q.applicationGroup?
Q.applicationGroup:{},ia=ea.appData,ja=ia?H.a(H.a('"'+ia+'"')):{};ja.fgUIAutoDismiss=Q.FloodgateUIAutoDismissTimeEnum;ea.appData=H.c(ja);Q.applicationGroup=ea}catch(ea){h.ULS.sendTraceTag(588842831,356,10,"Failed to parse applicationGroup.appData",ea.toString())}return Q}static x0i(Q){Q=Array.isArray(Q.Flights)?Q.Flights:null;Q||(Q=(Q=A.AFrameworkApplication.fa.Ha("FlightId"))?Q.toString().split(";"):null);if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",
!0)){const ea=A.AFrameworkApplication.fa.qJc;if(ea)for(let ia in ea){const ja={key:ia,value:ea[ia]};-1!==(ja&&ja.key?ja.key.toLowerCase():"").indexOf("floodgateflight")&&"unset"!==(ja&&ja.value?ja.value.toString().toLowerCase():"")&&Q.push(ja.key)}}return Q}static B9f(Q){const ea={SelfTriggerActivity:""};if(!Q||!Q.length)return ea;try{for(let D=0;D<Q.length;D++){let pa=Q[D]?Q[D].toLowerCase():"";if(-1===pa.indexOf("floodgateflight"))continue;const Z=pa.lastIndexOf(".");-1!==Z&&(pa=pa.substring(Z+
1,pa.length));if(-1!==("AppFlights"in ea?ea.AppFlights:"").indexOf(pa))continue;ea.AppFlights="AppFlights"in ea?ea.AppFlights+(";"+pa):pa;const oa=C.a.replaceAll(pa,"-",""),Ba=A.AFrameworkApplication.fa.Ha(oa);if(Ba)try{const Ma=H.a(Ba);Ma&&Ma.SelfTriggerActivity||(ea.SelfTriggerActivity+=";"+oa);if(Ma)for(let za in Ma){var ia=za,ja=Ma[za];ia in ea?ea[ia]!==ja&&(ea[ia]=ea[ia]+";"+ja):ea[ia]=ja}}catch(Ma){h.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+oa+" json data",Ma.toString())}else ea.SelfTriggerActivity+=
";"+oa}}catch(D){h.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",D.toString())}return ea}static R0i(Q){let ea="";const ia={["OFC_Audience"]:"AudienceGroup",["Datacenter"]:"WACDatacenter",["TenantId"]:"TenantId"};for(let pa in ia){var ja=pa,D=ia[pa];let Z=Q[Object(e.a)(String,D)];Z||(Z=A.AFrameworkApplication.fa.Ha(Object(e.a)(String,D)));Z&&(ea+=ja+"="+encodeURIComponent(Z)+"&")}return ea}static p1k(Q){aa.eQd=Q}static Wok(Q,ea,ia){if(Q)try{const D=
ea?ea.getCampaignId():"",pa=ea?ea.getLauncherType():"",Z=ia?ia.contextInfo:null;var ja=ea?ea.getSurveyInfo():null;const oa=ja?ja.getPreferredLaunchType():null,Ba=ja?ja.getMetadata():null,Ma=Ba?Ba.getContentMetadata():null,za=Ma?Ma.customSurveyName:null,ka=Ma?Ma.telemetryEventName:null;aa.bDj(D)?h.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+D):(ja={},ja.campaignId=D,ja.surveyName=za,ja.launcherType=pa,ja.contextInfoLength=Z?Z.length.toString():"-1",ja.preferredLaunchType=
oa,ja.telemetryEventName=ka,h.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(ja)),pa&&"coachingux"===pa.toLowerCase()&&oa&&"default"!==oa.toLowerCase()&&aa.hig(Ma,ea,ia)?h.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(ja)):(Q.launch(ia),aa.bnh()))}catch(D){h.ULS.sendTraceTag(555071514,356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(D?D.toString():""))}else h.ULS.sendTraceTag(36706400,
356,10,"BFCOCV.onSurveyActivated given a null launcher")}static xpj(Q){Q=Q?Q.surfaceContext:null;if(!Q||!Q.surveyForm)return h.ULS.sendTraceTag(555071516,356,10,"Missing activation arguments"),!1;try{const ea=Q.surveyForm.getSurveyInfo(),ia=ea?ea.getMetadata():null,ja=ia?ia.getContentMetadata():null;return aa.hig(ja,Q.surveyForm,Q.surveyParams)}catch(ea){h.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(ea?ea.toString():""))}return!1}static hig(Q,ea,ia){if(!Q||!Q.customSurveyName||
!ea)return h.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(Q?Q.customSurveyName:null)),!1;const ja=ea.getCampaignId();if(Q.telemetryEventName){var D={["action"]:"Opened",["id"]:ja,["success"]:"true",["triggerType"]:"custom",["customSurveyName"]:Q.customSurveyName,["telemetryEventName"]:Q.telemetryEventName};aa.eQd?aa.eQd(Q.telemetryEventName,D):(A.AFrameworkApplication.Qj(Q.telemetryEventName),A.AFrameworkApplication.Z5b(Q.telemetryEventName),h.ULS.sendTraceTag(512505554,356,
50,"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(D)))}D=aa.Qzf.Jb(Q.customSurveyName)?aa.Qzf.ga(Q.customSurveyName):null;if(!D)return h.ULS.sendTraceTag(555071519,356,50,"Activation callback not found - "+Q.customSurveyName+", "+ja),!1;(Q=D(ea,ia))&&Q.then(pa=>{h.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(pa))}).catch(pa=>{h.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(pa?pa.toString():""))});return!0}static bDj(Q){try{return-1!==
A.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((Q||"").toLowerCase())}catch(ea){h.ULS.sendTraceTag(539015368,356,10,"Error checking if campaign is disabled - "+Q)}return!1}static logActivity(Q,ea=null){if(aa.NLd(Q,"LogActivity")){var ia=aa.MYd();ia&&(h.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+Q),ia.logActivity(Q,1,ea))}}static hHb(Q){Q?(h.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),
OfficeBrowserFeedback.floodgate.showCustomSurvey(Q),aa.bnh()):h.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static bnh(){aa.kpa(aa.Z3f)}static lxj(Q,ea,ia){var ja=[3,2,5,1];const D=E.FocusManager.instance(),pa=D.Bc(Q);pa.parent=v.AFrame.gj;pa.IK=!0;u.a.instance.p1(Q,!0);ea&&pa.xaa(ea);if(ia){G.a.instance.q6(Q,ia,!1,!0);I.a.instance.q6(Q,ia,!1,!0);Q=new y.DOMFocusListing(()=>ia);for(ea=0;ea<ja.length;++ea)Q.mo(ja[ea]);D.aha(()=>ia,pa,Q).cW=!0}}static kpa(Q){const ea=document.getElementById(Q);
ea?aa.lxj(Q,aa.Sjk,ea):h.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+Q)}static Sjk(Q,ea){h.ULS.sendTraceTag(37107265,356,100,"BFCOCV.OnFocusAction. PrevScopeName "+(Q?Q.name:"")+" NextScopeName "+(ea?ea.name:""));ea&&(Q=E.FocusManager.instance().zP(ea.name))&&Q.q5c()}static S5b(Q){if(aa.NLd(Q,"LogActivityStart")){var ea=aa.MYd();ea&&(h.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+Q),ea.logActivityStartTime(Q))}}static uAg(Q){if(aa.NLd(Q,"LogActivityEnd")){var ea=
aa.MYd();ea&&(h.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+Q),ea.logActivityStopTime(Q,new Date))}}static gTi(){OfficeBrowserFeedback.floodgate.start()}static hTi(){OfficeBrowserFeedback.floodgate.stop()}static NLd(Q,ea){Q||h.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+ea);return!!Q}static MYd(){let Q=null;const ea=OfficeBrowserFeedback.floodgate.getEngine();ea?(Q=ea.getActivityListener())||h.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):
aa.qVg||(aa.qVg=!0,h.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null"));return Q}static ASf(){return new T}static J0i(Q,ea){return Object.assign(new Y,{productName:Q,uiHost:ea,cvFlights:"",isCVSurveyEnabled:!0})}}aa.Z3f="obf-ToastContainer";aa.notInitialized=0;aa.jmg=1;aa.initialized=2;aa.error=-1;aa.akb=aa.notInitialized;aa.qVg=!1;aa.kmg=!1;aa.GVg="OFB still undefined";aa.tgk="OFB Floodgate is undefined or does not contain initialize function";aa.vkl="Teams";aa.Qzf=new m.a(n.a.Qr());
aa.eQd=null;Object(J.a)(aa,"BrowserFeedbackControlOCV",null,[])},989:function(J,V,d){J=d(0);var h=d(340),e=d(654);class m extends e.a{constructor(E,G=null,I=null){super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=G;this.messageText=E;this.isDeferred=I}}Object(J.a)(m,"DeferredContentProps",e.a,[]);var n=d(26),v=d(907),A=d(908);const w=(E,G)=>Object.assign(new v.a,{target:".EditingRibbonPanel",content:E,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new A.a,
{directionalHint:6,gapSpace:4,isBeakVisible:!1,preventDismissOnScroll:!0,onDismiss:G,preventDismissOnResize:!0})});var y=d(46);d.d(V,"a",function(){return u});class u{constructor(){this.QS=new m(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}LGi(E,G,I,H){H=Object.assign(new h.a,{onShow:()=>{I.TJ(y.a.Wfb)}});G=E.callout(G);return H=E.addNotification(G,H)}hNk(E,G){E.removeNotification(G);n.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");
return G}azi(E){return w(this.QS,()=>{E.qo(y.a.Wfb)})}}Object(J.a)(u,"DownloadACopyDeferred",null,[966])},998:function(J,V,d){J=d(0);var h=d(13),e=d(1157),m=d(25),n=d(65),v=d(78);class A{constructor(y,u,E,G=null){this.origin=y;this.data=u;this.source=E;this.lc=G}}Object(J.a)(A,"MessageEventArgs",null,[]);d.d(V,"a",function(){return w});class w{constructor(y,u){this.AEd=null;this.gYh=y;this.Rd=u;this.auc=null}get chb(){return this.gYh.value}get taskManager(){return this.Rd.value}V$h(y){this.auc=y;
this.AEd=Object(h.a)(this,this.$wk,"postMessageEventHandler");this.chb.addHandler(n.a.message,this.AEd,null)}dFi(){this.auc=null;this.chb.removeHandler(n.a.message,this.AEd)}QQc(y,u){const E=new v.a(0,1,1,()=>{y(u)},7);this.taskManager.Gb(E)}OAj(y,u){const E=new v.a(0,1,1,()=>{y(u)},7);this.taskManager.Gb(E)}$wk(y){return this.auc?this.auc(new A(y.origin,y.data,y.source,y.lc)):!1}static get instance(){return w.T5a()}static T5a(){return new w(new e.a(()=>m.AFrameworkApplication.chb),new e.a(()=>m.AFrameworkApplication.ue))}}
Object(J.a)(w,"MessageEventHandler",null,[725])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.ext.js.map