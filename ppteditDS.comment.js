'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1199:function(J,V,d){d.r(V);var h=d(0),e=d(25),m=d(375),n=d(17),v=d(22);class A{}A.beginDraftingAsync="OSC:BDA";A.oTi="OSC:FEQ";A.selectComment="OSC:SC";Object(h.a)(A,"CommentTaskNames",null,[]);class w{constructor(W){this.xEa=W;this.g0j=[]}get handler(){return this.xEa}get V6(){return this.g0j}}Object(h.a)(w,"RegisteredListener",null,[]);class y{constructor(W,ta){this.type=0;this.payload=null;this.type=W;this.payload=
ta}}Object(h.a)(y,"OfficeSharedCommentsEvent",null,[1487]);class u{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(h.a)(u,"ViewContainerEvent",null,[1487]);var E=d(651);class G{constructor(W){this.Gie=!1;this.EW=new n.a;this.yb=W}hLk(W){W=new w(W);this.EW.add(W)}Yzh(W){for(let ta=0;ta<this.EW.count;++ta)if(this.EW.ga(ta).handler===W){this.EW.removeAt(ta);break}}xma(W=!1){const ta=()=>{if(e.AFrameworkApplication.Xg)m.ULS.sendTraceTag(40420181,201,
50,"Skipped processing comment pane events since app is shutting down.");else for(let $a=0;$a<this.EW.count;++$a){const fb=this.EW.ga($a);for(;0<fb.V6.length;){var da=Array.dequeue(fb.V6);if(Object(v.a)(u,da)){var Ea=fb.handler;Ea(da)}else Object(v.a)(y,da)&&(Ea=fb.handler,Ea(da.type,da.payload))}}};W?ta():this.Gie||(this.Gie=!0,E.a.Lmb(this.yb,()=>{ta();this.Gie=!1},A.oTi))}}Object(h.a)(G,"GenericEventHost",null,[]);class I extends G{constructor(W){super(W)}xMk(W){this.hLk(W)}usl(W){this.Yzh(W)}Hmh(W){W=
this.cwi(W);for(let ta=0;ta<this.EW.count;++ta)Array.enqueue(this.EW.ga(ta).V6,W);this.xma(!0)}cwi(W){const ta=new u;ta.eventType=3;ta.viewContainerVisibilityState=W;return ta}zTi(){const W=this.BBi();for(let ta=0;ta<this.EW.count;++ta)Array.enqueue(this.EW.ga(ta).V6,W);this.xma(!0)}BBi(){const W=new u;W.eventType=2;return W}}Object(h.a)(I,"ViewContainerEventHost",G,[1464]);class H{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=
this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(h.a)(H,"BasicEventPayload",null,[1523]);class K{constructor(W){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=W}}Object(h.a)(K,"CommentContextDetails",null,[]);class C{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(h.a)(C,"ContextChangeWithSelectedThreadIndex",null,[1523]);class Y{constructor(){this.tasks=this.comments=null}}Object(h.a)(Y,"LoadCommentsNoVirtualization",null,[1523]);class M extends G{constructor(W){super(W);this.NTh=0}ALk(W,ta,da,Ea,$a,fb,qc=0){W=new w(W);fb&&Array.enqueue(W.V6,this.Mvi(fb,this.NTh));fb=ta?ta.length:0;Array.enqueue(W.V6,this.uRf(fb,
da,Ea,qc,null));fb&&Array.enqueue(W.V6,this.hSf(ta,$a));this.EW.add(W);this.xma()}bAh(W){this.Yzh(W)}hHe(W,ta,da,Ea=0,$a=null){this.mRa(this.uRf(W,ta,da,Ea,$a));this.xma()}CZk(W,ta,da,Ea,$a=null){this.mRa(this.gwi(W,ta,da,Ea,$a));this.xma()}ljh(W,ta,da){this.mRa(this.jwi(W,ta,da));this.xma()}mHe(W,ta){this.mRa(this.hSf(W,ta));this.xma()}selectComment(W){this.mRa(this.QSf(W,6));this.xma()}highlightComment(W){this.mRa(this.QSf(W,7));this.xma()}pZa(W,ta){this.mRa(this.Dyi(W,ta));this.xma()}Lwk(W,ta){this.mRa(this.IAi(W,
ta));this.xma()}Mvi(W,ta=0){const da=new H;da.modelCapabilityFlags=W;da.richTextCapabilityFlags=ta;return new y(12,da)}uRf(W,ta,da,Ea,$a=null){const fb=new H;fb.numberOfComments=W;fb.numberOfThreads=ta;fb.contextDetails=Object.assign(new K(da),{nextPopulatedContextDetails:Ea});fb.contextDrafts=$a;fb.rehydrationDrafts=null;return new y(0,fb)}gwi(W,ta,da,Ea,$a=null){const fb=new C;fb.numberOfComments=W;fb.numberOfThreads=ta;fb.selectedThreadIndex=da;fb.contextDetails=Object.assign(new K(Ea),{nextPopulatedContextDetails:0});
fb.contextDrafts=$a;fb.rehydrationDrafts=null;return new y(0,fb)}jwi(W,ta,da){const Ea=new H;Ea.comments=W;Ea.numberOfThreads=ta;Ea.tasks=da;return new y(2,Ea)}hSf(W,ta){const da=new Y;da.comments=W;da.tasks=ta;return new y(1,da)}QSf(W,ta){const da=new H;da.commentId="";W&&(da.commentId=W);return new y(ta,da)}Dyi(W,ta){const da=new H;da.changes=[];da.contextDetails=Object.assign(new K(ta),{nextPopulatedContextDetails:W});return new y(10,da)}IAi(W,ta){const da=new H;da.commentId=W;da.smartReplies=
ta;return new y(15,da)}mRa(W){for(let ta=0;ta<this.EW.count;++ta)Array.enqueue(this.EW.ga(ta).V6,W)}}Object(h.a)(M,"OfficeSharedCommentsEventHost",G,[1511]);var P=d(1157);class T{constructor(){this.Vtf=this.Qvf=!1;this.WWh=[]}get IIb(){return this.WWh}get Egb(){return this.Qvf}set Egb(W){this.Qvf=W;for(const ta of this.IIb)ta.Egb=W}get zfb(){return this.Vtf}set zfb(W){this.Vtf=W;for(const ta of this.IIb)ta.zfb=W}lJa(W){for(const ta of this.IIb)W=ta.lJa(W);return W}}Object(h.a)(T,"AggregateCommentTaskPersonTransformer",
null,[1546]);var L=d(113);class aa{constructor(W,ta,da,Ea,$a=!1){this.priority=this.completion=-1;this.type=W;this.user=ta;this.time=da;this.recordId=Ea;this.isLossy=$a}}Object(h.a)(aa,"HistoryRecord",null,[]);class Q{constructor(W,ta){this.fPh=new P.a(()=>ta.lJa(W.value))}N0i(){return new Date}pAa(W,ta,da){if(0===W)throw m.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");
const Ea=L.a.create().toString();da=new aa(W,this.fPh.value,da,Ea,!1);da.commentId=ta;m.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",W);return da}}Object(h.a)(Q,"HistoryRecordFactory",null,[1547]);class ea{constructor(){this.endDate=this.startDate=null}}Object(h.a)(ea,"CommentTaskSchedule",null,[]);class ia{constructor(W,ta,da,Ea,$a,fb){this.isLossy=W;this.title=ta;this.assignees=da;this.schedule=Ea;this.completion=$a;this.priority=fb}}Object(h.a)(ia,"CommentTaskState",
null,[]);class ja{constructor(){this.commentId=null}}Object(h.a)(ja,"HistoryItem",null,[]);class D{constructor(W,ta,da,Ea,$a,fb,qc){this.hud=!1;if(1!==ta.type)throw Error.argument("createRecord");this.ELb=da;this.BLb=Ea;this.CLb=$a;this.Eef=1;this.gsc=W;this.xQh=fb;this._state=new ia(!1,this.ELb,qc,new ea,this.CLb,this.BLb);this._history=[];this.sSf(ta)}Apb(W,ta){if(1!==W.type)throw Error.argument("createRecordTemplate");const da=D.xej(W,this.Eef);this.Eef++;return Object.assign(new aa(ta,W.user,
W.time,da),{commentId:W.commentId})}get Yyg(){return this.history[this.history.length-1]}get Kig(){return this.state.completion===this.CLb}get Jig(){return this.state.priority===this.BLb}get Lig(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Mig(){return this.state.title===this.ELb}sSf(W){W=Object.assign(new ja,{commentId:W.commentId,records:[W]});this.history.push(W)}u6f(W){let ta=
-1;for(let da=0;da<this.state.assignees.length;da++)if(this.gsc.equals(this.state.assignees[da],W)){ta=da;break}return ta}m8k(W){const ta=this.Yyg,da=ta.records[ta.records.length-1];return this.gsc.equals(da.user,W.user)&&ta.commentId===W.commentId&&da.time.getTime()===W.time.getTime()?!0:!1}exl(W){switch(W.type){case 2:-1===this.u6f(W.assignee)&&this.state.assignees.push(W.assignee);break;case 3:const ta=this.u6f(W.assignee);0<=ta&&this.state.assignees.splice(ta,1);break;case 4:Array.clear(this.state.assignees);
break;case 5:this.state.schedule=W.schedule;break;case 6:this.state.completion=W.completion;break;case 9:this.state.title=W.title;break;case 10:this.state.priority=W.priority;break;case 0:this.state.isLossy=!0;break;case 1:m.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.hud=!0;break;case 8:this.hud=!1;break;case -1:m.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}W.isLossy&&(this.state.isLossy=
!0);this.m8k(W)?this.Yyg.records.push(W):this.sSf(W)}get isDeleted(){return this.hud}get state(){return this._state}get history(){return this._history}f4i(W){if(!W)return this.history;const ta=Array.clone(this.history),da=ta[0],Ea=da.records.shift();if(!this.xQh){var $a=this.Apb(Ea,4);da.records.unshift($a)}!W.Kig&&this.Kig&&($a=this.Apb(Ea,6),$a.completion=this.CLb,da.records.unshift($a));!W.Jig&&this.Jig&&($a=this.Apb(Ea,10),$a.priority=this.BLb,da.records.unshift($a));!W.Lig&&this.Lig&&($a=this.Apb(Ea,
5),$a.schedule=new ea,da.records.unshift($a));!W.Mig&&this.Mig&&($a=this.Apb(Ea,9),$a.title=this.ELb,da.records.unshift($a));W.isDeleted&&(W=this.Apb(Ea,8),da.records.unshift(W));return ta}static xej(W,ta){return"Synthesized-"+W.recordId+"-"+ta}}Object(h.a)(D,"CommentTaskStateBuilder",null,[]);var pa=d(701);class Z{constructor(W,ta,da,Ea){this.id=W;this.commentId=ta;this.currentState=da;this.history=Ea}}Object(h.a)(Z,"CommentTaskItem",null,[]);class oa{constructor(W,ta="",da="",Ea=""){this.IsCurrentUser=
!1;this.UserId=W;this.Provider=ta;this.DisplayName=da;this.Email=Ea}}Object(h.a)(oa,"CommentTaskPerson",null,[1539]);const Ba=W=>{const ta=new oa(W.UserId,W.Provider,W.DisplayName,W.Email);ta.IsCurrentUser=W.IsCurrentUser;return ta};var Ma=d(985);d(281);class za{constructor(W){this.extensions=W}}Object(h.a)(za,"ExtensionList",null,[]);class ka{static clone(W){W=ka.Lni(W.extensions);return new za(W)}static XNf(W){return W?ka.clone(W):null}static isEmpty(W){return!W.extensions||!W.extensions.count}static Va(W){return!W||
ka.isEmpty(W)}static Lni(W){if(!W)return null;const ta=new Ma.a;W.forEach((da,Ea)=>{ta.add(da,Ea);return!0});return ta}}Object(h.a)(ka,"ExtensionListExtensions",null,[]);class qa{static clone(W){var ta=Ba(W.user);ta=new aa(W.type,ta,W.time,W.recordId,W.isLossy);ta.commentId=W.commentId;ta.anchorExtensionList=ka.XNf(W.anchorExtensionList);ta.recordExtensionList=ka.XNf(W.recordExtensionList);W.assignee&&(ta.assignee=Ba(W.assignee));if(W.schedule){var da=W.schedule;const Ea=new ea;Ea.startDate=da.startDate;
Ea.endDate=da.endDate;ta.schedule=Ea}ta.completion=W.completion;ta.title=W.title;ta.priority=W.priority;ta.undoId=W.undoId;return ta}}Object(h.a)(qa,"HistoryRecordExtensions",null,[]);class Ja{constructor(W,ta,da,Ea,$a,fb,qc,Hc=!1){this.gsc=W;this.kvc=ta;this.Aoa=da;this.jJh=Ea;this.ELb=$a;this.BLb=fb;this.CLb=qc;this.Ssc=Hc}fBi(W,ta,da,Ea=null){if(!W)throw m.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!ta)throw m.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),
Error.argumentNull("parentCommentId");if(!da||!da.length)throw m.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==da[0].type)throw m.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var $a=[],fb=null,qc=this.ABk(da);for(var Hc of da)if(!qc.contains(Hc.recordId))if(da=this.dfg(Hc.commentId,Ea),da=this.BWi(Hc,da),1===da.type){let Ac=[];this.Ssc&&fb&&fb.state&&(Ac=
fb.state.assignees);fb=new D(this.gsc,da,this.ELb,this.BLb,this.CLb,this.Ssc,Ac);$a.push(fb)}else if(fb)fb.exl(da);else throw m.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");qc=null;Hc=[];if(fb){fb.isDeleted||(qc=fb.state);fb=null;for(var kd of $a)$a=kd.f4i(fb),Array.addRange(Hc,$a),fb=kd}kd=this.dfg(ta,
Ea);qc&&(qc.completion=this.dqi(ta,Ea,qc.completion));return new Z(W,kd,qc,Hc)}YVi(W,ta,da,Ea=null){if(!ta)throw m.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(da&&!W)throw m.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const $a=[],fb=this.Aoa.N0i();if(da){var qc=this.Aoa.pAa(1,W,fb);$a.push(qc)}qc=null;if(ta.assigneeUpdate){if(!ta.assigneeUpdate.assigneesToAdd||!ta.assigneeUpdate.assigneesToRemove)throw m.ULS.sendTraceTag(536999254,
327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Hc=0;Hc<ta.assigneeUpdate.assigneesToAdd.length;Hc++){var kd=this.tSf(2,ta.assigneeUpdate.assigneesToAdd[Hc],W,fb);kd&&$a.push(kd)}for(Hc=0;Hc<ta.assigneeUpdate.assigneesToRemove.length;Hc++)(kd=this.tSf(3,ta.assigneeUpdate.assigneesToRemove[Hc],W,fb))&&$a.push(kd)}else ta.assignee&&(da||(qc=this.Aoa.pAa(4,W,fb),$a.push(qc)),Hc=this.Aoa.pAa(2,W,fb),qc=this.kvc.lJa(ta.assignee),Hc.assignee=qc,$a.push(Hc));
ta.title?(Ea=this.Aoa.pAa(9,W,fb),Ea.title=ta.title,$a.push(Ea)):da&&Ea&&(Hc=this.Aoa.pAa(9,W,fb),Hc.title=this.jJh.kgj(Ea,qc),$a.push(Hc));if(ta.schedule){if(ta.schedule.startDate>ta.schedule.endDate)throw m.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");Ea=this.Aoa.pAa(5,W,fb);Ea.schedule=ta.schedule;$a.push(Ea)}if(void 0!==ta.completion&&null!==ta.completion){Ea=ta.completion;if(0>Ea||100<Ea)throw m.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),
Error.argumentOutOfRange("completion");da||m.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",Ea);da=this.Aoa.pAa(6,W,fb);da.completion=Ea;$a.push(da)}if(void 0!==ta.priority&&null!==ta.priority){ta=ta.priority;if(0>ta||10<ta)throw m.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");W=this.Aoa.pAa(10,W,fb);W.priority=ta;$a.push(W)}return $a}tSf(W,ta,da,Ea){if(2!==W&&3!==W)return m.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),
null;W=this.Aoa.pAa(W,da,Ea);W.assignee=this.kvc.lJa(ta);return W}ABk(W){const ta=new pa.a,da=new pa.a;for(let Ea=W.length-1;0<=Ea;Ea--){const $a=W[Ea],fb=da.contains($a.recordId);fb||-1!==$a.type||(da.contains($a.undoId)?m.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):da.add($a.undoId));if(fb||-1===$a.type)ta.contains($a.recordId)?m.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):
ta.add($a.recordId)}return ta}BWi(W,ta){const da=qa.clone(W);da.commentId=ta;da.user=this.kvc.lJa(W.user);da.assignee=this.kvc.lJa(W.assignee);return da}dqi(W,ta,da){let Ea=da;W&&ta&&(({value:ta}=ta.Of(W)).returnValue?(Ea=ta.ResolveState?100:100===da?0:da,Ea!==da&&m.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",W)):m.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",W));
return Ea}dfg(W,ta){let da=W;W&&ta&&(({value:ta}=ta.Of(W)).returnValue?da=ta.CommentId:(m.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",W),da=W));return da}}Object(h.a)(Ja,"CommentTaskTranslatorImpl",null,[454]);class xa{constructor(){this.A_a={};this.A_a.ops=[]}Azj(W){const ta=this.A_a.ops;if(ta.length){var da=ta.length-1;const Ea=ta[da];if(!Ea.attributes){Ea.insert+=W;ta[da]=Ea;this.A_a.ops=ta;return}}da={};da.insert=W;Array.add(ta,
da)}Vyj(W,ta,da){var Ea={};Ea.fullName=ta.fullName;Ea.email=ta.email;Ea.resolveState=ta.resolveState;ta={};ta.atmention=Ea;W=this.ZOd(W,ta);da&&(Ea={},Ea.contentId=da.contentId,da={},da.atmention=Ea,W.optional=da);Array.add(this.A_a.ops,W)}insertImage(W,ta){W=this.ZOd(W,{});const da={};da.base64=ta.base64;ta={};ta.image=da;W.optional=ta;Array.add(this.A_a.ops,W)}insertHyperLink(W,ta){const da={};da.link=ta.link;this.D4k(da,ta);Array.add(this.A_a.ops,this.ZOd(W,da))}n1i(){return Sys.Serialization.JavaScriptSerializer.serialize(this.A_a)}ZOd(W,
ta){const da={};da.insert=W;da.attributes=ta;return da}D4k(W,ta){this.nfb(ta.weight>=xa.Pck,W,"weight",ta.weight);this.nfb(ta.italic,W,"italic",!0);this.nfb(ta.underline,W,"underline",!0);this.nfb(ta.strikethrough,W,"strikethrough",!0);this.nfb(!!ta.highlight,W,"highlight",ta.highlight);this.nfb(!!ta.color,W,"color",ta.color);this.nfb(!!ta.paragraph,W,"paragraph",ta.paragraph)}nfb(W,ta,da,Ea){W&&(ta[da]=Ea)}static E8f(W){return Sys.Serialization.JavaScriptSerializer.deserialize(W,!0)}}xa.Pck=700;
Object(h.a)(xa,"DeltaFormatCreator",null,[1504]);var Ga=d(519),na=d(1105);class sa{constructor(){this.ellipsis=CommonUIStrings.l_Ellipsis}kgj(W,ta){if(!W)throw m.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var da=xa.E8f(W)}catch(kd){throw m.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var Ea=W=0,$a=0;const fb=RegExp("\\s+","g"),qc=new Sys.StringBuilder;
for(var Hc of da.ops)Hc.attributes&&Hc.attributes.atmention&&Hc.attributes.atmention.email&&ta&&(da=Hc.attributes.atmention.email,0<da.length&&(da===ta.UserId||da===ta.Email||da===Ga.a.j5a(ta.UserId))&&(Ea=W,$a=Ea+Hc.insert.length)),da=Hc.insert.replace(fb," "),W+=da.length,qc.append(da);!$a&&ta&&m.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",ta.Provider);ta=qc.toString().trimEnd();W=ta.length;255<W?(Hc=(255-($a-Ea))/2,0>Ea-Hc?(W=na.a.instance.kXd(ta,255-this.ellipsis.length),
$a=ta.substring(0,W)+this.ellipsis,W="Trimmed End"):$a+Hc>W?(Ea=na.a.instance.HLc(ta,W-255+this.ellipsis.length),$a=this.ellipsis+ta.substring(Ea,W),W="Trimmed Start"):(Ea=na.a.instance.HLc(ta,Ea-Hc+this.ellipsis.length),W=na.a.instance.kXd(ta,$a+Hc-this.ellipsis.length),$a=this.ellipsis+ta.substring(Ea,W)+this.ellipsis,W="Trimmed Both")):(W="No Trim",$a=ta);m.ULS.sendTraceTag(592998804,327,50,W);return $a}}Object(h.a)(sa,"ContentExtractor",null,[]);class Ha{constructor(W,ta){this.PMh=W;this.gPh=
ta;this.zfb=this.Egb=!1}lJa(W){if(!W)return null;if(void 0===W.UserId||null===W.UserId)throw m.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(W.IsCurrentUser||!this.PMh.equals(this.gPh.value,W))return W;W=Ba(W);W.IsCurrentUser=!0;return W}}Object(h.a)(Ha,"EnsureIsCurrentUserSetTransformer",null,[1546]);class cb{constructor(){this.zfb=this.Egb=!1}lJa(W){if(!W)return null;if(void 0===W.UserId||null===W.UserId)return W;if(!W.Email||""===W.Email){let ta;
if(ta=Ga.a.j5a(W.UserId))return W=Ba(W),W.Email=ta,W}return W}}Object(h.a)(cb,"RestoreEmailTransformer",null,[1546]);class Za{constructor(){this.zfb=this.Egb=!1}lJa(W){if(!W)return null;if(void 0!==W.UserId&&null!==W.UserId)return W;switch(this.Egb?this.zfb?2:1:0){case 0:if(void 0===W.UserId||null===W.UserId)throw m.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");W=Ba(W);break;case 1:if(void 0===W.Id||null===W.Id)throw m.ULS.sendTraceTag(593368214,327,
10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===W.Email||null===W.Email)throw m.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var ta=Za.l3g(W.Id,W.Email,null);if(!ta||""===ta)throw m.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var da=e.AFrameworkApplication.fa.Ha("HostAuthType")||"";if("aad"!==da.toLowerCase()||ta.startsWith("S::")){if("msa"===da.toLowerCase())throw m.ULS.sendTraceTag(593368210,
327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");m.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",da)}else throw m.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");W=new oa(ta,"AD",W.DisplayName,W.Email);break;case 2:if(void 0===W.UserPrincipalName||null===W.UserPrincipalName)throw m.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");
if(void 0!==W.SuggestionSubtype&&null!==W.SuggestionSubtype)if("OrganizationUser"===W.SuggestionSubtype)ta="AD";else throw m.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",W.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw m.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");da=Za.l3g(W.Id,W.UserPrincipalName,W.AadObjectId);if(!da||""===da)throw m.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),
Error.argument("UserId");if("AD"===ta&&!da.startsWith("S::"))throw m.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");W=new oa(da,ta,W.Name,W.UserPrincipalName);break;default:throw m.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return W}static l3g(W,ta,da){if(!ta||""===ta)return m.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),W;if(da&&""!==da)return"S::"+ta+"::"+da;if(!W||""===W)return m.ULS.sendTraceTag(593368217,
327,50,"Missing ID"),W;if(W.startsWith("S::"))return W;if(-1!==W.indexOf("@")){da=W.split("@");if(L.a.isValid(da[0]))return"S::"+ta+"::"+da[0];m.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return W}}Object(h.a)(Za,"UserIdCanonicalizationTransformer",null,[1546]);class va{constructor(W,ta,da=!1,Ea=!1){this.QKh=W;this.mXe=ta;this.zPh=da;this.Ssc=Ea}awi(){const W=new Ga.a;var ta=new P.a(va.C0i);const da=new T;this.mXe&&(da.IIb.push(new Za),da.IIb.push(new cb));this.QKh&&
da.IIb.push(new Ha(W,ta));da.Egb=this.mXe;da.zfb=this.zPh;ta=new Q(ta,da);const Ea=new sa;return new Ja(W,da,ta,Ea,va.LDi,va.xDi,va.yDi,this.Ssc)}static C0i(){const W=new oa(e.AFrameworkApplication.fa.Ha("PresenceUserId")||"",e.AFrameworkApplication.fa.Ha("PresenceProvider")||"",e.AFrameworkApplication.userName||"");W.IsCurrentUser=!0;return W}}va.LDi="";va.xDi=5;va.yDi=0;Object(h.a)(va,"CommentTaskTranslatorFactory",null,[1540]);class Fa{constructor(){this.CBd=this.tVe=!1;this.Mlb=this.Xs=this.o5e=
this.Gcf=this.Iyf=this.Cgf=this.owf=this.rYe=this.yv=this.PQb=null}initialize(W,ta,da,Ea=null,$a=null,fb=null,qc=null,Hc=null,kd=null,Ac=null){this.yv=W;this.rYe=ta;this.owf=da;this.Cgf=Ea;this.Iyf=$a;this.Gcf=fb;this.o5e=qc;this.Xs=Hc;this.tVe=!0;this.Mlb=kd;this.PQb=Ac}O2b(W=null,ta=null){if(!this.tVe)return m.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((da,Ea)=>{Ea(E.a.du(-2130915313))});if(this.CBd)return m.ULS.sendTraceTag(41424204,
201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.PQb||(e.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?this.PQb=appResourceLoader.loadChunk("sharedComments"):this.PQb=this.yv.loadScript("sharedComments"));return this.PQb.then(()=>{W&&W();this.CBd||(this.Mlb&&this.Mlb.execute(da=>{da.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),ta&&ta(),sharedComments.instantiate(this.rYe,
this.owf,this.Cgf,this.Iyf,this.Gcf,this.o5e,this.Xs));this.CBd=!0})}}Object(h.a)(Fa,"CommentActivationManager",null,[1541]);var Ca=d(13);class La{constructor(){this.actionBehavior=this.actionType=0}}Object(h.a)(La,"CommentUIActionPayload",null,[]);var nb=d(255);class Nb{constructor(W,ta){this.Ca=W;this.NZa=ta;this.Bnd=new nb.a;for(let da of this.NZa)this.Bnd.$(da.value.canvasActionId,da.key),W=da.value,W.delayActionsUntilRegistration||this.xa(W)}xa(W){W.withFlags?this.Ca.pa(W.canvasActionId,W.canvasContextId,
Object(Ca.a)(this,this.oSb,"actionHandler"),97):this.Ca.xa(W.canvasActionId,W.canvasContextId,Object(Ca.a)(this,this.oSb,"actionHandler"))}Hva(W,ta){this.NZa.Jb(W)&&(this.NZa.ga(W).delayActionsUntilRegistration&&this.xa(this.NZa.ga(W)),this.NZa.ga(W).registeredCallback=ta)}oSb(W,ta,da,Ea,$a){if(this.Bnd.Jb(W)){var fb=this.Bnd.ga(W);if(!this.NZa.Jb(fb))return 8;const qc=this.NZa.ga(fb);if(qc.preCallback){const Hc=qc.preCallback(W,ta,da,Ea,$a);if(2!==Hc)return Hc}if(!qc.registeredCallback)return 1===
da?8:2;fb=Object.assign(new La,{actionType:fb});1===da&&(fb.actionBehavior=1);fb=qc.registeredCallback(fb);return qc.postCallback?qc.postCallback(fb,W,ta,da,Ea,$a):fb?32:8}return 2}}Object(h.a)(Nb,"OfficeSharedCommentsActionHost",null,[1513]);var Rb=d(336),Ya=d(35),Qb=d(186);class bb{}Object(h.a)(bb,"CommentActivityData",null,[]);var Bb=d(141),Eb=d(69);class tb{constructor(W,ta,da,Ea,$a,fb,qc,Hc,kd,Ac=null,Lc=null){this.$zf={["CancelCommentCreateThreadAction"]:Ya.a.Dnh,["CommitComment"]:Ya.a.Enh,
["CommitDraftAction"]:Ya.a.Fnh,["CommitDraftCreateAction"]:Ya.a.aKe,["CommitDraftEditAction"]:Ya.a.cKe,["CommitDraftReplyAction"]:Ya.a.$Je,["CreateReplyAction"]:Ya.a.$Je,["CreateReplyWithMentions"]:Ya.a.Gnh,["CreateReplyWithTaskAssigned"]:Ya.a.Hnh,["CreateThreadAction"]:Ya.a.aKe,["CreateThreadWithMentions"]:Ya.a.Inh,["CreateThreadWithTaskAssigned"]:Ya.a.Jnh,["DeletePostAction"]:Ya.a.Knh,["DeleteThreadAction"]:Ya.a.Lnh,["DeleteThreadWithTask"]:Ya.a.Mnh,["DiscardDraftAsync"]:Ya.a.Nnh,["PresentLinkToCommentAction"]:Ya.a.Onh,
["ResolveThreadAction"]:Ya.a.Snh,["ResolveThreadWithTask"]:Ya.a.Tnh,["ReopenThreadAction"]:Ya.a.Pnh,["ReopenThreadWithTask"]:Ya.a.Qnh,["RequestInitCommentSession"]:Ya.a.Rnh,["SelectCommentAction"]:Ya.a.Unh,["UpdateCommentBodyAction"]:Ya.a.cKe};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=W;this.appVersion=ta;this.releaseAudience=da;this.releaseChannel=Ea;this.sessionId=
$a;this.ring=fb;this.dataCenter=qc;this.disableUpload=Hc;this.sovereignEnvironmentName=Lc;this.Ca=kd;this.Egf=Ac;this.xyj()}xyj(){this.Ca.xa(Ya.a.Dnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Enh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Fnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.$Je,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Gnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Hnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.aKe,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Inh,
Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Jnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Knh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Lnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Mnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Nnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Onh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Snh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Tnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Pnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Qnh,
Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Rnh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.Unh,Eb.a.frame,Qb.ActionManager.Fg);this.Ca.xa(Ya.a.cKe,Eb.a.frame,Qb.ActionManager.Fg)}sendULSTrace(W,ta,da,Ea){m.ULS.sendTraceTag(W,ta,da,Ea)}recordActivity(W){this.$zf[W]&&this.Ca.processAction(this.$zf[W],2)}sendOtelEvent(W){Bb.a.sendOtelEvent(W)}recordPerfData(W,ta){this.Egf&&(W=Object.assign(new bb,{durationMs:ta,name:W}),this.Egf.Ula(W))}}Object(h.a)(tb,"OfficeSharedCommentsTelemetry",null,[]);
var Yb=d(267);class Tc{constructor(W,ta,da,Ea){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=W;this.appLocale=ta;this.uiCulture=da;this.dataCulture=Ea}}Object(h.a)(Tc,"LocalizationDetails",null,[]);var ib=d(285),Zb=d(65),Cc=d(89);class ob{constructor(W,ta){this.XXh=W;this.q1e=ta}getViewContainer(){return this.XXh}registerForViewContainerEvents(W){this.q1e.xMk(W)}unregisterForViewContainerEvents(W){this.q1e.usl(W)}}Object(h.a)(ob,"ViewContainerProvider",
null,[1463]);var cc=d(68),sb=d(1158),mb=d(33),Pb=d(27),dc=d(244),mc=d(206),Mb=d(26),Kc=d(241),gc=d(623);class rb{static A$f(W){return W===rb.create?0:W===rb.reply?1:W===rb.edit?2:W===rb.metadata?3:null}}rb.create="CREATE";rb.reply="REPLY";rb.edit="EDIT";rb.metadata="METADATA";Object(h.a)(rb,"CommentSessionType",null,[]);class Ua{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(h.a)(Ua,"InitCommentSessionResult",
null,[]);class pb extends Ua{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(h.a)(pb,"BeginDraftingHostResult",Ua,[]);class Ub{constructor(W,ta="",da="",Ea="",$a=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=W;this.Provider=ta;this.DisplayName=da;this.Email=Ea;this.IsCurrentUser=$a}}Object(h.a)(Ub,"OfficeSharedCommentUser",null,[]);var Bc=d(45),Gc=d(55),qd=d(246),Td=d(40);class Vd{constructor(W,ta,da){this.xp=W;this.Q_j=ta;
this.$Zj=da;this.lFg=null;this.nJg=!1}get NNa(){return this.xp}get DB(){return this.Q_j}get commentId(){return this.$Zj}get Y6(){return this.lFg}set Y6(W){this.lFg=W}get vTc(){return this.nJg}set vTc(W){this.nJg=W}}Object(h.a)(Vd,"ActiveCommentSession",null,[]);var Be=d(664);class Id{static get Gbk(){return 50}static GXi(W){return Id.l_i(W)}static D9i(W){if(""===W)return"";let ta=0,da="";try{const Ea=xa.E8f(W);for(const $a of Ea.ops)if(Id.Ura($a))ta||(da+=Id.f3i($a.attributes.atmention.fullName)),
ta+=1;else{const fb=$a.insert?$a.insert:"";" "!==fb&&0<fb.length&&(ta=0,da+=fb)}}catch(Ea){m.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return da}static l_i(W){W=Id.D9i(W);return 0<W.length&&W.split(" ").length<=Id.Gbk?W:null}static f3i(W){let ta="";W&&(W=W.split(" "),0<W.length&&(ta=W[0]));return ta}static Ura(W){return!!W.attributes&&!!W.attributes.atmention}}Object(h.a)(Id,"BaseCommentSmartReplyHelpers",null,[]);
class gb{constructor(W){this.Iee=W}Fyl(W,ta,da,Ea){-1===da||ta||(ta=Ea[da],da=ta.author?ta.author.IsCurrentUser:!1,ta&&ta.commentBody&&!da&&(ta=Id.GXi(ta.commentBody))&&this.Iee.invoke(W,ta))}}Object(h.a)(gb,"CommentSmartReplyHelpers",null,[]);class Xb{constructor(W,ta,da,Ea,$a,fb,qc,Hc,kd,Ac,Lc,yc,Oc,od,di,ij){this.F0c=!1;this.eb=W;this.rUa=ta;this.Ufe=da;this.OYj=Ea;this.yb=$a;this.$b=fb;this.S3c=qc;this.f_j=Hc;this.Hta=kd;this.Iee=Lc;this.l0j=yc;this.cta=Oc;this.e6j=od;this.YZj=di;this.ia=ij}beginDraftingAsync(W){if(!W)return new Promise((da,
Ea)=>{Ea(E.a.du(-2130915327))});const ta=rb.A$f(W.sessionType);return void 0===ta||null===ta?new Promise((da,Ea)=>{Ea(E.a.du(-2130915317))}):2===ta&&W.commentId===Xb.ABb?new Promise((da,Ea)=>{Ea(E.a.du(-2130915324))}):new Promise((da,Ea)=>{E.a.Lmb(this.yb,()=>{var $a=this.eb.o_d(),fb=null;let qc=-1;Mb.a.J(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",ta);try{switch(ta){case 0:if(this.e6j)try{qc=this.eb.u$f(!0)}catch(Lc){Mb.a.J(512496832,801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",
Lc),qc=$a.length}else qc=$a.length;fb=new Vd(ta,W,"");this.F0c=!0;break;case 1:if(!W.threadId||!W.threadId.length)throw E.a.du(-2130915324);qc=Xb.K4i($a,W.threadId);if(-1===qc)throw E.a.du(-2130915323);if(this.$b.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var Hc=W.threadId;(new gb(this.Iee)).Fyl(Hc,Xb.kqj($a,Hc),Xb.mZd($a,Hc),$a)}fb=new Vd(ta,W,W.threadId);break;case 2:if(!W.commentId||!W.commentId.length)throw E.a.du(-2130915324);qc=Xb.mZd($a,W.commentId);
if(-1===qc)throw E.a.du(-2130915323);fb=new Vd(ta,W,W.commentId);break;case 3:qc=Xb.mZd($a,W.threadId);fb=new Vd(ta,W,W.threadId);break;default:throw E.a.du(-2130915322);}if(!fb)throw E.a.du(-2130915322);var kd=this.eb.Cvj(fb);if(kd)throw kd;}catch(Lc){Ea(Lc);return}$a=new pb;fb=this.$b.Ha("UserName");kd=this.$b.Ha("387");Hc=this.$b.Ha("388");const Ac=Td.a("PPTPlumbEmailThroughCG")?Ga.a.j5a(kd||""):"";kd=new Ub(kd,Hc,fb,Ac,!0);$a.author=kd;$a.insertIndex=qc;$a.authorName=fb;$a.authorIdentity=new String;
da($a)})})}commit(W,ta,da){if(!this.eb.wFc)throw Mb.a.J(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.eb.spi),E.a.du(-2130915320);var Ea=this.eb.wFc.DB;if(!Ea)throw Mb.a.J(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),E.a.du(-2130915320);const $a=rb.A$f(Ea.sessionType);if(void 0===$a||null===$a)throw E.a.du(-2130915317);if(W!==Ea.draftId)throw E.a.du(-2130915327);const fb=this.cta?qd.e(L.a.create().toString()):
"";this.eb.HWf();switch($a){case 0:return Mb.a.J(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",fb),Ea={},this.eb.PRk(fb),Ea.commentId=fb,this.F0c=!1,this.eb.zUg=fb,Xb.Axh(da),Xb.zxh(),this.createComment(ta,Ea,da);case 1:return Mb.a.J(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",Ea.threadId,fb),W={},W.parentId=Ea.threadId,W.commentId=fb,Xb.Axh(da),Xb.zxh(),this.createComment(ta,W,da);case 2:return Mb.a.J(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",Ea.commentId),
da={},da.commentBody=ta,this.vtl(Ea.commentId,da),W;case 3:return Mb.a.J(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",Ea.threadId),this.wtl(Ea.threadId,da),Ea.threadId;default:throw E.a.du(-2130915322);}}endCommentSession(W){Mb.a.J(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",W);this.eb.endCommentSession(W,this.F0c?9:1);this.F0c=!1}createComment(W,ta,da){const Ea=this.S3c.tkd(W,new Date);let $a="";this.cta&&($a=Bc.a.Va(ta.commentId)?L.a.create().toString():ta.commentId);
let fb=null;void 0!==da&&null!==da&&(fb=this.S3c.aol($a,da.Task,W));W=this.eb.Fed;if(da=ta.parentId?null:this.eb.bfj())W=this.eb.hZk;this.rUa.PZh($a,Ea.plainText,ta.parentId,W,this.eb.anchorNode,Ea.uUg,fb,da);return Bc.a.Va($a)?Xb.ABb:$a}deleteComment(W){if(W===Xb.ABb)throw E.a.du(-2130915327);Mb.a.J(512496796,805,50,"CommentAPI::DeleteComment - {0}",W);this.rUa.deleteComment(W)}selectComment(W){W!==Xb.ABb&&this.eb.pea(W,0,!1)}highlightComment(W){W!==Xb.ABb&&this.eb.RYh(W)}EAh(W,ta,da){const Ea=Array.clone(this.eb.o_d());
var $a=null;for(var fb of Ea)if(fb.commentId===W){$a=fb;break}if(!$a)throw Mb.a.J(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),E.a.du(-2130915323);(fb=e.AFrameworkApplication.userName)&&0<fb.length&&fb!==$a.author.DisplayName&&Mb.a.J(512496794,805,50,"Author of comment being edited is not the current user (isAnonymous={0})",e.AFrameworkApplication.Jhb||e.AFrameworkApplication.ZP);fb=new Date;$a=this.S3c.tkd($a.commentBody,null).plainText;ta=this.S3c.tkd(ta.commentBody,
fb);this.rUa.ZIi(ta.plainText,W,ta.uUg);da||$a!==ta.plainText||this.Ufe.ljh(Ea,this.eb.AVg,Array.clone(this.eb.gbg()))}vtl(W,ta){if(W===Xb.ABb)throw E.a.du(-2130915327);ta.commentBody&&(this.$b.ka("896")?this.EAh(W,ta,!0):E.a.Lmb(this.yb,()=>{this.EAh(W,ta,!1)}))}wtl(W,ta){if(void 0===ta.Resolve||null===ta.Resolve)throw E.a.du(-2130915327);const da=ta.Resolve.isResolved;let Ea=da?100:0;void 0!==ta.Task&&null!==ta.Task&&(Ea=ta.Task.completion);this.rUa.FAh(W,da?1:0,Ea);da&&this.eb.a1k()}setThreadResolvedState(W,
ta){this.rUa.FAh(W,ta?1:0,ta?100:0);ta&&this.eb.MVf(W)}selectFirstThreadInNextCommentContext(){this.eb.TYk()}selectLastThreadInPreviousCommentContext(){this.eb.WYk()}presentLinkToComment(W){if(W=this.rUa.Tcj(W)){W=JSON.stringify({["sId"]:W.sid,["cId"]:W.cid});var ta={};ta.nav=Be.a(W);ta.mode="copy";Mb.a.J(512496792,805,50,"PresentLinkToComment: nav:{0}",W);this.ia.Ka(Ya.a.kBa,2,ta)}else Mb.a.J(512496793,805,50,"PresentLinkToComment failed")}registerForCommentEvents(W){this.YZj.l7i().then(ta=>{this.Ufe.ALk(W,
this.eb.o_d(),this.eb.AVg,this.eb.isReadOnly,this.eb.gbg(),ta,this.f_j.OUc)})}unregisterForCommentEvents(W){this.Ufe.bAh(W)}registerForAction(W,ta){this.OYj.Hva(W,ta);this.eb.QJk()}unregisterForAction(){}loadThreads(){Mb.a.J(512496791,805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(W=>{e.AFrameworkApplication.fa.ff(()=>{this.Hta?this.Hta.atMentionsEnabledAsync().then(ta=>{W(ta);return null}):W(!1)})})}resolveSupported(){return this.l0j}static K4i(W,ta){let da=
!1;for(let Ea=0;Ea<W.length;Ea++){if(da&&W[Ea].commentId!==ta&&W[Ea].parentId!==ta)return Ea;W[Ea].commentId===ta&&(da=!0)}return da?W.length:-1}static kqj(W,ta){let da=!1;for(let Ea=0;Ea<W.length;Ea++)if(W[Ea].commentId===ta&&(da=!0),da&&W[Ea].parentId===ta)return!0;return!1}static mZd(W,ta){for(let da=0;da<W.length;da++)if(W[da].commentId===ta)return da;return-1}static zxh(){if(Td.a("CommentsFpsIsEnabled"))try{const W=Gc.a.instance.La("Common.ISystemInitiatedFeedback");W&&W.execute(ta=>{ta.logActivity("PPTWebCommitNewCommentActivity",
"CommentsFpsIsEnabledBRS")})}catch(W){Mb.a.J(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",W)}}static Axh(W){if(Td.a("CommentsTasksFpsIsEnabled")&&W&&W.Task)try{const ta=Gc.a.instance.La("Common.ISystemInitiatedFeedback");ta&&ta.execute(da=>{da.logActivity("PPTWebCommitTaskActivity","CommentsTasksFpsIsEnabledBRS")})}catch(ta){Mb.a.J(512496789,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",ta)}}}Xb.ABb="temp-id";
Object(h.a)(Xb,"CommentAPI",null,[487,488]);var Ic=d(196),Wc=d(342),Ib=d(669);class ec{constructor(W,ta,da){this.kec=W;this.commentId=ta;this.state=da}}Object(h.a)(ec,"CommentTextAnchorToHighlight",null,[]);var Jb=d(54),hb=d(75),Rc=d(31),gd=d(91),hd=d(92),Hd=d(49);class Xd{constructor(){this.xrd=this.nCd=this.NLa=null;this.Iig=!1;this.tjd=this.ujd=this.endPos=this.startPos=0}get paragraphs(){return this.NLa}get ZT(){return this.nCd}set ZT(W){this.nCd=W;this.NLa=[];this.NLa.push(this.nCd)}get X1(){return this.xrd}set X1(W){this.xrd=
W;this.NLa&&this.P4b&&this.NLa.push(this.xrd)}$Oi(){for(const W of this.NLa){const ta=Object(sb.a)(5,W);if(ta&&-1!==ta.Wrb().indexOf("\ufffc"))return!0}return!1}Cxg(W){const ta=(this.tjd&4294967295)>>>0;W.TextBodyLength!==this.ujd||ta===W.TextBodyHash||Xd.vhh.contains(this.tjd)||(Xd.vhh.add(this.tjd),Mb.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.$Oi()));return W.TextBodyLength===this.ujd}get D$g(){let W=0;if(this.isValid)if(this.P4b){W+=
Rc.ParagraphReader.textLength(this.ZT)-this.startPos;W+=this.endPos;for(let ta=1;ta<this.paragraphs.length-1;ta++){const da=this.paragraphs[ta];da&&(W+=Rc.ParagraphReader.textLength(da)+1)}}else W=this.endPos-this.startPos;return W}get ZIa(){if(!this.isValid)return gd.a.auto;var W=Hd.a.Uj(this.ZT,this.startPos+1);if(!W)return gd.a.auto;W=hd.a.Bs(W);return W?(W=W.cache)&&W.B2?W.fontColor:gd.a.auto:gd.a.auto}get isValid(){return!!this.ZT&&!!this.X1&&!!this.paragraphs}get P4b(){return!this.ZT.equals(this.X1)}x0h(W){this.NLa&&
W&&this.NLa.push(W)}BAj(){if(this.isValid&&(this.ZT.Vu(16,!0),this.P4b))for(let W=1;W<this.paragraphs.length;W++){const ta=this.paragraphs[W];ta&&ta.Vu(16,!0)}}bEj(W,ta){if(!this.isValid)return!1;const da=Object(sb.a)(hb.AParagraphNode,W.node),Ea=Object(sb.a)(hb.AParagraphNode,ta.node);return!(da&&Ea&&Array.contains(this.paragraphs,da)&&Array.contains(this.paragraphs,Ea))||da.equals(this.ZT)&&(0>W.Qa||W.Qa<this.startPos)||Ea.equals(this.X1)&&(0>ta.Kb||ta.Kb>this.endPos)?!1:!0}V8f(W){let ta=3;W&&(!this.P4b&&
this.ZT.equals(W)?ta=2:this.ZT.equals(W)?ta=0:this.X1.equals(W)&&(ta=1));return ta}}Xd.vhh=new pa.a;Object(h.a)(Xd,"TextAnchorParagraphInfo",null,[]);class id{static Rqb(W,ta){return W||ta?W&&ta?W.commentId===ta.commentId:!1:!0}static uIc(W){return!!W.Children&&0<W.Children.length}static Y8i(W,ta){W=W.Wrb()+"\r";for(let da=0;da<W.length;da++){let Ea=W.charCodeAt(da);160===Ea&&(Ea=32);ta=(ta<<5>>>0)+ta+Ea}return ta}static RM(W){return!!W&&!!W.textAnchoringInfo&&W.textAnchoringInfo.EndPos>W.textAnchoringInfo.StartPos&&
0<W.textAnchoringInfo.TextBodyLength}static H0b(W,ta){if(!id.RM(W))return null;if(!ta||1>ta.jD().length)return Mb.a.J(574179520,805,ta?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!ta),null;let da=null,Ea=null,$a=null;W.textAnchoringInfo.AnchoringShape&&(W.textAnchoringInfo.AnchoringShape.TableCell?(da=L.a.Yf(W.textAnchoringInfo.AnchoringShape.TableCell.RowId),Ea=L.a.Yf(W.textAnchoringInfo.AnchoringShape.TableCell.ColId)):
W.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&($a=W.textAnchoringInfo.AnchoringShape.SmartArtNodeId,$a.startsWith("{")||($a="{"+$a),$a.endsWith("}")||($a+="}")));let fb=W.textAnchoringInfo.StartPos;W=W.textAnchoringInfo.EndPos;let qc=0,Hc=0;const kd=new Xd;ta=ta.jD();for(let Lc=0;Lc<ta.length;Lc++){const yc=ta[Lc],Oc=Rc.ParagraphReader.textLength(Object(sb.a)(hb.AParagraphNode,yc));if(da&&Ea){var Ac=yc.pK();if(!Ac||!da.equals(Ac.rowId)||!Ea.equals(Ac.cellId))continue}else if($a&&(!yc.get_smartArtModelId()||
$a!==yc.get_smartArtModelId()))continue;if(!kd.isValid&&(Oc>fb||kd.ZT)){if(!kd.ZT&&(kd.ZT=Object(sb.a)(hb.AParagraphNode,yc),kd.startPos=fb,!kd.ZT))return null;Ac=Lc===ta.length-1||!!$a&&id.aJj($a,ta[Lc+1])||!!da&&!!Ea&&id.$Ij(da,Ea,ta[Lc+1]);Ac=Oc<W&&0<Oc&&Ac;if((Oc>=W||Ac)&&!kd.X1){if(Ac&&(W=Oc),kd.X1=Object(sb.a)(hb.AParagraphNode,yc),kd.endPos=W,!kd.X1)return null}else yc.equals(kd.ZT)||kd.x0h(Object(sb.a)(hb.AParagraphNode,yc))}qc+=Oc+1;Hc=id.Y8i(yc,Hc);kd.ZT||(fb-=Oc+1);W-=Oc+1}kd.ujd=qc;kd.tjd=
Hc;return kd}static aJj(W,ta){return ta.get_smartArtModelId()&&ta.get_smartArtModelId()===W?!1:!0}static $Ij(W,ta,da){return(da=da.pK())&&W.equals(da.rowId)&&ta.equals(da.cellId)?!1:!0}static afj(W,ta,da,Ea){da=Ea=-1;if(!W)return Mb.a.J(554574735,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,FIa:da,ZAa:Ea};let $a=Object(sb.a)(5,ta.Ua.node);const fb=Object(sb.a)(5,ta.Te.node);if(!$a||!fb)return Mb.a.J(554574736,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",
!$a,!fb),{returnValue:null,FIa:da,ZAa:Ea};const qc=ta.Ua.C2a,Hc=ta.Te.sSb;var kd=Rc.ParagraphReader.textLength(ta.Ua.node);ta=Rc.ParagraphReader.textLength(ta.Te.node);if(0>qc||0>=Hc||qc===Hc&&$a===fb||qc>kd||Hc>ta)return Mb.a.J(554574737,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",qc,Hc,kd,ta),{returnValue:null,FIa:da,ZAa:Ea};W=W.jD();if(!W)return Mb.a.J(554574738,805,
15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,FIa:da,ZAa:Ea};kd=0;for(const Ac of W){if(fb.get_smartArtModelId()){if(Ac.get_smartArtModelId()!==fb.get_smartArtModelId())continue;$a.get_smartArtModelId()!==fb.get_smartArtModelId()&&($a=Ac)}if(fb.Sr()){if(Ac.pK()!==fb.pK())continue;$a.pK()!==fb.pK()&&($a=Ac)}$a===Ac&&(da=qc+kd);fb===Ac&&(Ea=Hc+kd);if(0<=da&&0<=Ea)return{returnValue:$a,FIa:da,ZAa:Ea};kd+=Ac.Wrb().length+1}0<=
da&&-1===Ea&&($a.get_smartArtModelId()||$a.Sr())&&(Ea=kd-1);return{returnValue:$a,FIa:da,ZAa:Ea}}static get oBc(){return Jb.a.$f||Jb.a.JRa}static get zIc(){return!Jb.a.Ki}}Object(h.a)(id,"CommentUtilities",null,[]);class fd extends Sys.EventArgs{constructor(W){super();this.B7k=W}}Object(h.a)(fd,"CommentsVisibilityOnSmartArtChangeEventArgs",Sys.EventArgs,[]);class Vf{constructor(W,ta,da,Ea,$a,fb,qc,Hc,kd,Ac,Lc){this.JOg=[];this.F4c=null;this.Ggd=!1;if(!Ac)throw Error.argumentNull("appSettingsManager");
if(!Lc)throw Error.argumentNull("viewElementEventNotifier");this.Hc=ta;this.mpe=this.Bac=!1;this.bXc=W;this.M7j=da;this.nTa=this.oTa=null;this.el=Ea;this.ra=$a;this.ZSa=fb;this.aEa=qc;this.Jca=Hc;this.a_j=kd;this.$b=Ac;this.a4=Lc;this.Jca.XCe(this.a_j)}get xs(){return this.$b.ka("CommentTextAnchoringUIEnabled")}get IM(){return this.oTa&&this.oTa.isConnected?this.oTa:null}get nrh(){return this.Bac}Djc(W,ta,da=!1,Ea=!1){const $a=this.M7j.xP(W);if($a)switch(ta){case 0:$a.display(this.xs&&da,Ea);this.oTa=
W;break;case 1:$a.activate();this.nTa=W;break;case 2:$a.dismiss();this.oTa=null;break;case 3:this.xs&&this.IM&&this.IM===W&&this.m4a&&this.yIc(this.m4a,W)?$a.display(id.RM(this.m4a),Ea):$a.dismiss();this.nTa=null;break;case 4:$a.OGi(this.xs&&da),this.oTa=W}}Ufd(W){if(this.Hc&&this.Hc.Jc)switch(W){case 0:this.Hc.Jc.highlight();this.Bac=!0;break;case 2:this.Hc.Jc.Mzh();this.Bac=!1;break;case 1:this.Hc.Jc.highlight();this.mpe=!0;break;case 3:this.Hc.Jc.Mzh(),this.mpe=!1}}hGc(){this.bXc&&(this.Bac?this.Ufd(2):
this.IM&&this.Djc(this.IM,2),this.Vpb(null))}yIc(W,ta){if(!this.xs||!id.RM(W))return!0;W=this.el.uz();return Ic.a.any(W,da=>!id.RM(da)&&da.anchorShape===ta.get_shapeId())}LGe(W,ta,da,Ea=!1,$a=!1){if(this.bXc&&W&&(!Ea||Vf.fqb(this.el.uz(),W))){Ea=this.c7(W);if(this.xs||this.IM!==Ea||!Ea){var fb=(!this.xs||this.IM!==Ea)&&!!this.IM;fb&&this.ra.R6(this.IM);this.hGc();if(Ea){const qc=this.xs&&id.RM(W);this.nTa===Ea?this.yIc(W,Ea)?this.Djc(Ea,4,qc,this.xs&&qc&&fb):this.oTa=Ea:this.yIc(W,Ea)?this.Djc(Ea,
0,qc,da&&(!this.xs||fb)):this.oTa=Ea;ta=!!ta&&ta===W.commentId;(qc||ta)&&$a||this.AZk(Ea,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,W.authorName,W.dt.toDateString(),W.dt.toLocaleTimeString()))}else this.Ufd(0),this.Hc&&this.Hc.Jc&&this.Hc.Jc.Nd&&this.Led(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,(this.Hc.Jc.Nd.De+1).toString(),this.Hc.Jc.Nd.title));!$a&&fb&&this.ra.selectShape(this.IM,!0,!1)}this.Vpb(null)}}QYh(W){if(this.bXc){var ta=this.c7(W);if(ta){if(this.xs||
this.IM!==ta)(this.xs?!id.RM(W):this.yIc(W,ta))?this.Djc(ta,1):this.nTa=ta}else this.Ufd(1);this.Vpb(W)}}KFc(){this.nTa&&(this.xs||this.nTa!==this.IM)&&this.Djc(this.nTa,3);this.mpe&&!this.Bac&&this.Ufd(3);this.Vpb(null)}c7(W){if(!W)return null;try{return this.aEa.pKc(W)}catch(ta){return Mb.a.J(512496788,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",ta),null}}Vpb(W){const ta=[];var da=this.nTa;W&&!da&&(da=this.IM);const Ea=this.IM?this.IM:this.ra.jq();Ea||W&&da||
this.xxh(ta);let $a=null;const fb=[];var qc=!1;if(id.RM(W)&&da&&0<da.jD().length&&(!this.m4a||W.commentId!==this.m4a.commentId)){var Hc=id.H0b(W,da);Hc&&Hc.isValid&&(qc=Wc.a.Yf("{"+W.commentId+"}{1}"),ta.push(new ec(Hc,qc,1)),qc=!0,da=this.aEa.Jk(da))&&(fb.push(da),(da=da.shapeNode)&&da.Qf&&($a=da))}if(this.Ggd||Ea&&0<Ea.jD().length)if(da=this.el.uz())for(var kd of da){if(!id.RM(kd)||!this.Ggd&&kd.anchorShape!==Ea.get_shapeId()||qc&&kd.commentId===W.commentId)continue;Hc=this.Ggd?this.c7(kd):Ea;if(!Hc)continue;
let Ac=id.H0b(kd,Hc);if(!Ac||!Ac.isValid)continue;let Lc=5;(da=!!this.m4a&&kd.commentId===this.m4a.commentId)&&(Lc=0);const yc=Wc.a.Yf("{"+kd.commentId+"}{1}");ta.push(new ec(Ac,yc,Lc));if(Hc=this.aEa.Jk(Hc))fb.push(Hc),Hc=Hc.shapeNode,!$a&&Hc&&da&&Hc.Qf&&($a=Hc)}for(const Ac of this.JOg)!Ac||Array.contains(fb,Ac)||Ac.shapeNode&&Ac.shapeNode.Qf||(Ac.x8d=!1,Ac.Kp||!Ac.Fn||Ac.Ax||Ac.UHb());W=null;for(const Ac of fb)(kd=Ac.shapeNode)&&kd.Qf?(W||(W=kd),$a||Ea!==kd||($a=kd)):(Ac.x8d=!0,Ac.Fn||(Mb.a.J(512496787,
805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),Ac.Hid()));$a||this.ra.GK()||!W||($a=W);this.JOg=fb;this.a4.mEk(new fd($a));this.xxh(ta)}xxh(W){W=Object.assign(new Ib.a,{action:0,type:0,Nba:W,Fdb:this.Jca.c9a?this.Jca.c9a.Nba:null});this.Jca.kfd(W)}Led(W){this.ZSa.cea(W)}AZk(W,ta){this.ZSa.T$g(W,ta)}SHe(W){this.bXc=W}get m4a(){return this.F4c&&this.F4c.zFb?this.F4c.zFb.comment:null}static fqb(W,ta){if(W)for(const da of W)if(ta.commentId===
da.commentId)return!0;return!1}}Object(h.a)(Vf,"CommentAnchoringHighlightsHelper",null,[]);var Qd=d(41);class Zf{constructor(W,ta,da,Ea,$a,fb,qc){this.yc=W;this.ta=ta;this.DYc=da;this.sN=Ea;this.U7j=$a;this.Nb=fb;this.yb=qc;this.Ebf=0}pZa(W,ta){if(W||1!==this.OUc)if(2>this.yc.Nj())this.WYh?this.CIe(5):this.CIe(1);else{const da=Qd.a.hm("UpdateNextPopulatedContextDetails",2);this.DYc.iVd((Ea,$a,fb)=>{this.Kjk(Ea,$a,fb,da,ta)},da)}}get OUc(){return this.Ebf}Kjk(W,ta,da,Ea,$a){let fb=1;if(this.ta.Ba){const qc=
this.ta.Ba.De;let Hc=!1,kd=!1,Ac=!1;ta&&W&&(W=W.De,W<qc?Hc=!0:W===qc?kd=!0:(Ac=!0,da||(Hc=!0)));0<=$a&&($a<qc?Hc=!0:$a===qc?kd=!0:Ac=!0);Ac?fb=Hc||kd?3:2:Hc?fb=4:kd&&(fb=5)}this.CIe(fb);Ea.finish();E.a.Lmb(this.yb,()=>{this.Nb.updateCommandUI()})}CIe(W){this.Ebf=W;this.U7j.pZa(W,1===this.Nb.mode)}get WYh(){return!!this.ta.Ba&&this.sN.cIi(this.ta.Ba)}}Object(h.a)(Zf,"CommentContextDetailsUpdateHelper",null,[456]);var Ge=d(37);class le{b1k(W){if(null===W)throw Error.argumentNull("comment");W.setValue(Ge.a.commentId,
"")}Y0k(W,ta){if(null===W)throw Error.argumentNull("comment");W.setValue(Ge.a.nMd,ta)}$0k(W){if(null===W)throw Error.argumentNull("comment");if(W=Object(sb.a)(483,W))W.Yob=ResourceStrings.anonymousCommentAuthor}ujc(W){if(null===W)throw Error.argumentNull("comment");W.setValue(Ge.a.zVb,!0)}mkh(W,ta,da,Ea){if(null===W)throw Error.argumentNull("comment");if(W=Object(sb.a)(483,W))W.authorName=ta,W.UAc=da,W.OId=Ea}c1k(W,ta){if(null===W)throw Error.argumentNull("comment");W.setValue(Ge.a.AVb,ta)}}Object(h.a)(le,
"CommentEditor",null,[486]);var Sa=d(30),Cb=d(81),rc=d(59);class bd{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=null;this.isUnread=!1;this.providerId=this.pos=null;this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(h.a)(bd,"Comment",null,[]);var pd=d(293),Oa=d(877),jb=d(446),nc=d(28);class kb{constructor(W,ta,da,Ea,$a,fb,qc,Hc,kd,Ac,Lc,yc,Oc,od){this.sca=null;this.Owb=Ea;this.Db=$a;this.ta=fb;this.MK=qc;
this.Dja=Hc;this.$b=kd;this.Mb=Ac;this.ra=Lc;this.wD=yc;this.gfe=Oc;this.rc=od;this.vQ=W;this.ZZj=da;this.k0j=0===ta;this.lAh();this.dce()}dispose(){}get userName(){return this.$b.appSettings.UserName}get userId(){return this.$b.appSettings["387"]}get providerId(){return this.$b.appSettings["388"]}get isTasksHistoryEnabled(){return this.$b.ka("TasksHistoryEnabled")}get sug(){return Td.a("Comments.LogTasksTelemetry")}get hBa(){return this.$b.ka("SlideResizePerfImprovementEnabled")}addComment(W,ta,
da){this.pAf("",W,ta,da,null,null,null,null)}PZh(W,ta,da,Ea,$a,fb,qc,Hc){this.pAf(W,ta,da,Ea,$a,fb,qc,Hc)}pAf(W,ta,da,Ea,$a,fb,qc,Hc){const kd=this.vQ.wi("UserAction","AddComment");e.AFrameworkApplication.fa.Zba?this.rAf(W,ta,da,Ea,$a,fb,qc,Hc,kd):this.$b.ff(()=>{this.rAf(W,ta,da,Ea,$a,fb,qc,Hc,kd)})}rAf(W,ta,da,Ea,$a,fb,qc,Hc,kd){this.ZZj.sWb().then(Ac=>{kb.khh&&(Mb.a.J(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.k0j,Ac),this.wD.tVj(Ac),kb.khh=
!1);this.OZh(W,ta,da,Ea,$a,fb,qc,Hc);kd&&kd.stop();return Ac}).catch(Ac=>{Mb.a.J(512262930,805,10,JSON.stringify(Ac));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}OZh(W,ta,da,Ea,$a,fb,qc,Hc){if(this.m3b()){var kd=!1,Ac=0,Lc=0;Ea&&(kd=!0,Ac=Ea.x,Lc=Ea.y);Ea=this.Db.je(15);try{var yc=this.sca;Ea.jc(yc);const Oc=Sa.GraphIterator.mb(yc),od=Object(sb.a)(Cb.a,this.Owb.createInstance(1074135127));this.Dja.ujc(od);this.Dja.b1k(od);this.Dja.Y0k(od,W);yc=null;const di=
Object(sb.a)(483,od);if(di){if(di.$ob=kd)di.Upa=Object.assign(new Oa.a,{X:Ac,Y:Lc});di.nwh=this.gfe.Kfj();di.QAc=fb;if(yc=Object(sb.a)(4,$a))di.FDc=yc.get_shapeId();da&&(di.pva=da);qc&&(di.taskInfo=qc);Hc&&(di.textAnchoringInfo=Hc);di.gAa=ta}let ij=this.userId;$a=!ij;const rh=!this.providerId,Qg=!this.userName;($a||rh)&&Mb.a.J(512262928,805,$a&&!rh?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",$a,rh,Qg);Td.a("Comments.UseNameInPlaceOfUserId")&&$a&&!rh&&(ij=Qg?ResourceStrings.anonymousCommentAuthor:
this.userName);this.Dja.mkh(od,this.userName,ij,this.providerId);Qg&&this.Dja.$0k(od);Oc.hl(od,1);Mb.a.J(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",W,!!qc,!!Hc,!!yc)}finally{Ea&&Ea.dispose()}this.MUj(W,da,ta,Hc,qc)}else Mb.a.J(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}MUj(W,ta,da,Ea,$a){this.sug?ta?(ta=this.NBa(ta))?(ta=this.gra(ta))?
this.wD.NUj(W,da.length-1,!!Ea,ta.taskInfo,$a):Mb.a.J(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):Mb.a.J(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.wD.OUj(W,da.length-1,!!Ea,!!$a):this.wD.ace(W,da.length-1,!!Ea,!!$a)}deleteComment(W){this.wD.EXj();if(this.m3b()){var ta=this.Db.rd(15);try{ta.jc(this.sca),this.KQd(W,this.sca),ta.$c=nc.a.deleteComment}finally{ta&&ta.dispose()}}else Mb.a.J(512262924,
805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}KQd(W,ta){Td.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.ra.D7()&&(Mb.a.J(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.ra.Ph());const da=this.i_i(W,ta);if(da&&0<da.count){this.Dja.ujc(ta);for(let Ea of da)ta=Sa.GraphIterator.mb(Ea),ta.mc(39),ta.Ii();Mb.a.J(512262922,805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",W)}else Mb.a.J(512262921,
805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",W);this.wD.hJk()}x4a(){const W=Date.now();this.wD.xVj();const ta=this.uz();if(ta){var da=this.Db.rd(15);try{da.jc(this.ta.Ba);for(const Ea of ta)this.KQd(Ea.commentId,this.sca);da.$c=nc.a.x4a}finally{da&&da.dispose()}Mb.a.J(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-W)}else Mb.a.J(512262920,805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}jXb(W){const ta=
Date.now();W?this.wD.yVj():this.wD.wVj();const da=this.ta.presentation;if(da){var Ea=da.slides;if(Ea){var $a=this.Db.rd(15);try{$a.jc(da);for(const fb of Ea){const qc=Object(sb.a)(123,fb);if(!qc||!qc.PE()){Mb.a.J(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",qc);continue}const Hc=Sa.GraphIterator.mb(qc).zb(16);for(const kd of this.hra(qc.PE()))(W?1===kd.status:1)&&this.KQd(kd.commentId,Hc)}$a.$c=W?nc.a.lXb:nc.a.kXb}finally{$a&&$a.dispose()}Mb.a.J(512262917,
805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-ta,W)}}}editComment(W,ta){this.qYf(W,ta,null)}ZIi(W,ta,da){this.qYf(W,ta,da)}qYf(W,ta,da){if(this.m3b()){var Ea=this.NBa(ta);if(Ea){const $a=this.Db.je(15);try{$a.jc(Ea);this.Dja.ujc(Ea);const fb=Object(sb.a)(483,Ea);fb&&(fb.gAa=W,fb.QAc=da)}finally{$a&&$a.dispose()}Mb.a.J(512262915,805,50,"CommentManager::EditCommentInternal - Edited comment {0}",ta)}else Mb.a.J(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",
ta);this.wD.CVj()}else Mb.a.J(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}lBb(W,ta){if(this.m3b()){var da=this.NBa(W);if(da){if(null===ta)throw Error.argumentNull("pos");const Ea=this.Db.je(15);try{Ea.jc(da),this.Dja.ujc(da),Object(sb.a)(483,da).Upa=Object.assign(new Oa.a,{X:ta.x,Y:ta.y})}finally{Ea&&Ea.dispose()}Mb.a.J(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",W)}else Mb.a.J(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",
W);this.wD.OWj(W)}else Mb.a.J(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}FAh(W,ta,da){if(this.m3b()){var Ea=this.NBa(W);if(Ea){const $a=this.Db.je(15);try{$a.jc(Ea),this.Dja.ujc(Ea),this.Dja.c1k(Ea,ta),Object(sb.a)(483,Ea).Ugb=da,this.isTasksHistoryEnabled&&this.Dja.mkh(Ea,this.userName,this.userId,this.providerId)}finally{$a&&$a.dispose()}if(this.sug){da=this.gra(Ea);if(!da){Mb.a.J(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");
return}1===ta?this.wD.nXj(!!da.taskInfo):0===ta&&this.wD.dYj(!!da.taskInfo)}else 1===ta&&this.wD.oXj();Mb.a.J(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",W,ta)}else Mb.a.J(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",W)}else Mb.a.J(512262882,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}uz(){return this.hra(this.sca)}hra(W){const ta=[];if(!W||39!==W.type)return ta;W=Sa.GraphIterator.mb(W);
for(var da=W.Ji();da;){if(40===da.type){const Ea=Object(sb.a)(483,da).pva;da=this.gra(da);if(Ea)for(const $a of ta)$a.commentId===Ea&&($a.Children||($a.Children=[]),$a.Children.push(da));else ta.push(da)}da=W.jp()}return ta}lAh(){const W=this.ta.Ba;this.sca=W?Sa.GraphIterator.mb(W).zb(16):null}K3i(){if(!this.sca)return!1;const W=Sa.GraphIterator.mb(this.sca);if(this.MK.N7f(this.sca))return!0;let ta=W.Ji();for(;ta;){if(this.MK.N7f(ta))return!0;ta=W.jp()}return!1}aRi(W,ta){return this.E2f(W,ta,!1)}lRi(W,
ta){return this.E2f(W,ta,!0)}E2f(W,ta,da){if(!W)return null;if(W=W.PE()){W=this.Mb.Kc(W);let Ea=da?W.Z0b():W.Ji();for(;Ea;){if(!(this.MK.pTc(Ea)||ta&&0!==this.MK.NXd(Ea)))return this.gra(Ea);Ea=da?W.mCa():W.jp()}}return null}cIi(W){return W?(W=W.PE())?!!this.Mb.Kc(W).Ji():!1:!1}OXd(W){if(!W)return 0;var ta=W.PE();W=0;if(ta){ta=this.Mb.Kc(ta);let da=ta.Ji();for(;da;)this.MK.pTc(da)||W++,da=ta.jp()}return W}m3b(){return!!this.sca&&this.sca.isConnected}i_i(W,ta){ta=Sa.GraphIterator.mb(ta);var da=ta.Ji();
const Ea=new n.a;for(;da;){const $a=this.MK.MXd(da),fb=Object(sb.a)(483,da).pva;W!==$a&&W!==fb||Ea.add(da);da=ta.jp()}return Ea}NBa(W){const ta=Sa.GraphIterator.mb(this.sca);let da=ta.Ji();for(;da;){const Ea=this.MK.MXd(da);if(W===Ea)return da;da=ta.jp()}return null}h0d(W){W=this.NBa(W);if(!W)return null;const ta=Object(sb.a)(483,W).pva;return Bc.a.Va(ta)?W:this.NBa(ta)}gra(W){if(W){const ta=this.MK.MXd(W),da=new bd,Ea=Object(sb.a)(483,W);if(Ea){da.dt=Ea.nFc;da.anchorShape=Ea.FDc;const $a=Ea.Upa;
da.pos=Object.assign(new pd.a,{X:$a.X,Y:$a.Y});da.text=Ea.gAa;da.authorName=Ea.authorName;da.userId=Ea.UAc;da.providerId=Ea.OId}da.status=this.MK.NXd(W);da.commentId=ta;da.taskInfo=Object(sb.a)(483,Ea).taskInfo;da.textAnchoringInfo=Object(sb.a)(483,Ea).textAnchoringInfo;return da}return null}$5a(W){if(!W)return[];const ta=this.hra(W.PE());if(!ta||this.hBa&&!ta.length){if(!ta)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return ta}ta.sort((da,Ea)=>{var $a=
this.rc.E0d(W,da.anchorShape);$a=$a?$a.vC:new rc.a(0,0);var fb=this.rc.E0d(W,Ea.anchorShape);fb=fb?fb.vC:new rc.a(0,0);$a.y+=da.pos.Y;fb.y+=Ea.pos.Y;$a.x+=da.pos.X;fb.x+=Ea.pos.X;let qc=$a.y-fb.y;qc||(qc=$a.x-fb.x)||(qc=+da.dt-+Ea.dt);return qc});return ta}Tcj(W){var ta=this.ta.presentation;if(!ta)return null;ta=ta.slides;if(!ta)return null;for(const da of ta)if(ta=Object(sb.a)(jb.a,da))for(const Ea of this.hra(ta.PE())){if(W===Ea.commentId)return da;if(Ea.Children)for(const $a of Ea.Children)if(W===
$a.commentId)return da}return null}dce(){let W=0,ta=0;var da=this.ta.presentation;if(da){var Ea=da.slides;if(Ea){da=new n.a;for(const $a of Ea)if((Ea=Object(sb.a)(jb.a,$a))&&Ea.PE())for(const fb of this.hra(Ea.PE()))id.RM(fb)?ta+=1:fb.textAnchoringInfo&&da.add(fb.commentId),W+=1;this.wD.dce(W,ta,da)}}}}kb.khh=!0;Object(h.a)(kb,"CommentManager",null,[484,485,106]);var Gb=d(130);class tc{constructor(W,ta,da,Ea){this.sN=W;this.Hc=ta;this.Qb=da;this.sc=Ea}ccj(W){if(null===W)throw Error.argumentNull("comment");
if(W=this.pKc(W))if(W=this.Jk(W))return W.ya.ya;return null}EXi(W){if(null===W)throw Error.argumentNull("comment");if(W=this.pKc(W)){if(W.nd){var ta=this.sc.XM(W);if(!ta)return Mb.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",W.get_shapeId()),null;ta=ta.oc(this.Qb.Ma);return ta&&ta.htmlElement?Gb.a.tba(new Sys.UI.Bounds(ta.htmlElement.clientLeft,ta.htmlElement.clientTop,ta.htmlElement.clientWidth,ta.htmlElement.clientHeight)):(Mb.a.J(595133521,805,
10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",W.get_shapeId()),null)}if(W=this.Jk(W))return W=W.ya.ya,Gb.a.tba(new Sys.UI.Bounds(W.clientLeft,W.clientTop,W.clientWidth,W.clientHeight))}return null}pKc(W){if(null===W)throw Error.argumentNull("comment");if(!W.anchorShape)return null;W=this.sN.h0d(W.commentId);W=this.sN.gra(W);if(!W)return null;const ta=this.Hc.Jc?this.Hc.Jc.Nd:null;return ta?ta.JB(W.anchorShape):(Mb.a.J(557090388,805,50,"ActiveSlide is null"),null)}FXi(W){if(null===
W)throw Error.argumentNull("comment");if(!W.anchorShape)return 0;if(W=this.pKc(W))if(W=this.Jk(W))return W.rotation;return 0}Jk(W){if(null===W)throw Error.argumentNull("shapeNode");return Object(sb.a)(124,W.oc(this.Qb.Ma))}}Object(h.a)(tc,"CommentMarkerAnchorHelper",null,[450]);var dd=d(571),$c=d(117);class Pc{constructor(W,ta,da){this.l8=W;this.Hc=ta;this.Gee=da}bIi(W){const ta=Object(sb.a)(483,this.Gee.NBa(W.commentId));if(!ta)throw m.ULS.sendTraceTag(595203538,805,10,"There is no graph node for comment {0}",
W.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");return!!ta.Upa}haj(W,ta){if(!W)throw Error.argumentNull("commentMarkerViewElement");if(!ta)throw Error.argumentNull("comment");if(!this.Gee.NBa(ta.commentId))return m.ULS.sendTraceTag(595141910,805,10,"GetRenderingPosition: There is no graph node for comment {0}",ta.commentId),new rc.a(0,Number.MIN_VALUE);const da=W.Fq;W=W.h9c;if(!this.bIi(ta)||!ta.pos.X&&!ta.pos.Y){if(da)return ta=new rc.a(da.Vb-da.Zb-Pc.eed.width-Pc.ghh.width,Pc.ghh.height),
Pc.Whg(ta,da,W),ta;if(this.Hc.Jc&&this.Hc.Jc.rC)return new rc.a(this.Hc.Jc.rC.clientWidth-Pc.eed.width,0);m.ULS.sendTraceTag(595203537,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new rc.a(0,0)}ta=new rc.a(this.l8.Ge(ta.pos.X,0),this.l8.Ge(ta.pos.Y,1));ta=new rc.a(ta._x-Pc.vXa._x,ta._y-Pc.vXa._y);da&&(ta._x=Math.max(0,ta._x),ta._y=Math.max(0,ta._y),ta._x=Math.min(ta._x,da.Vb-da.Zb-Pc.eed.width),ta._y=Math.min(ta._y,
da.Ub-da.fc-Pc.eed.height),Pc.Whg(ta,da,W));return ta}xtl(W,ta){var da=new rc.a(W.element.offsetLeft,W.element.offsetTop);da=new rc.a(da._x+Pc.vXa._x,da._y+Pc.vXa._y);const Ea=W.Fq;Ea&&W.h9c%360&&Pc.IFf(da,0-W.h9c,Ea.Uf());ta.pos.X=this.l8.Ef(da._x,0);ta.pos.Y=this.l8.Ef(da._y,1);this.Gee.lBb(ta.commentId,new rc.a(ta.pos.X,ta.pos.Y))}static Whg(W,ta,da){if(ta&&da%360){var Ea=new rc.a(W._x+Pc.vXa._x,W._y+Pc.vXa._y);Pc.IFf(Ea,da,ta.Uf());W.update(Ea._x-Pc.vXa._x,Ea._y-Pc.vXa._y)}}static IFf(W,ta,da){W.qL(0-
da._x,0-da._y);ta=dd.a.FQd(ta);W.update(W._x*Math.cos(ta)-W._y*Math.sin(ta)+da._x,W._x*Math.sin(ta)+W._y*Math.cos(ta)+da._y)}}Pc.eed=new $c.a(20,20);Pc.ghh=new $c.a(4,4);Pc.vXa=new rc.a(4,20);Object(h.a)(Pc,"CommentMarkerPositionHelper",null,[451]);var Ad=d(131),Ee=d(72),Ce=d(47);class Fb{constructor(W,ta){this.UFa=this.kFa=this.Vme=null;this.T6b=W;this.wq=ta}Wu(){return!0}su(W){if(!W)return!1;this.UFa=this.T6b.element.style;this.Vme=new rc.a(W.clientPoint.x,W.clientPoint.y);this.kFa=new rc.a(parseInt(this.UFa.left),
parseInt(this.UFa.top));this.aw(W);return!0}aw(W){if(!W)return!1;W=this.Iag(new rc.a(W.clientPoint.x,W.clientPoint.y),this.Vme);this.UFa.left=Ce.a.Lc(this.kFa._x+W._x);this.UFa.top=Ce.a.Lc(this.kFa._y+W._y);return!0}Ln(W){if(W){W=this.Iag(new rc.a(W.clientPoint.x,W.clientPoint.y),this.Vme);var ta=this.kFa._x+W._x,da=this.kFa._y+W._y,Ea=this.T6b.Fq;Ea&&(ta=Math.max(Ea.Zb,ta),ta=Math.min(Ea.Vb-this.T6b.element.clientWidth,ta),da=Math.max(Ea.fc,da),da=Math.min(Ea.Ub-this.T6b.element.clientHeight,da),
W._x=ta-this.kFa._x,W._y=da-this.kFa._y);this.UFa.left=Ce.a.Lc(ta);this.UFa.top=Ce.a.Lc(da);this.T6b.zTg(W)}}Nt(){this.UFa.left=Ce.a.Lc(this.kFa._x);this.UFa.top=Ce.a.Lc(this.kFa._y)}Iag(W,ta){W=rc.a.bU(W,ta);return new rc.a(this.wq.qn(W.x),this.wq.qn(W.y))}}Object(h.a)(Fb,"CommentMarkerDragAdapter",null,[239]);class $e{constructor(W,ta,da,Ea,$a,fb,qc,Hc){this.n8=null;this.wTa=this.xTa=!1;if(!ta)throw Error.argumentNull("parentElement");this.uxb=Hc;this.e8=W;this.Wp=da;this.Qja=Ea;this.TB=$a;this.tYc=
qc;this.em=document.createElement("div");this.em.className=id.uIc(W)?this.TB.VRg:this.TB.URg;this.em.title=ResourceStrings.L_CommentMarkerTooltip;this.em.style.display=this.tYc||this.uxb?"none":"block";this.em.setAttribute("data-pptcommentid",String.format("{0}",W.commentId));this.Hz=document.createElement("img");this.Hz.alt=ResourceStrings.L_CommentMarkerTooltip;this.Hz.src=da.frame.Yj(da.frame.UR+".png");this.Hz.setAttribute(Ad.a.We,Ad.a.Xt);this.em.appendChild(this.Hz);this.kZa();this.frame.gd.ob(Zb.a.click,
this.em,Object(Ca.a)(this,this.bD,"clickHandler"));id.zIc&&(Cc.a.addHandler(this.em,Zb.a.Ns,Object(Ca.a)(this,this.Hua,"mouseOverHandler")),Cc.a.addHandler(this.em,Zb.a.Zv,Object(Ca.a)(this,this.Zbc,"mouseOutHandler")));id.oBc&&Cc.a.addHandler(this.Hz,Zb.a.mouseDown,Object(Ca.a)(this,this.Jfc,"preventNativeDragMouseDownHandler"));ta.appendChild(this.em);fb||this.DOd()}dispose(){this.Hz&&(id.oBc&&Cc.a.removeHandler(this.Hz,Zb.a.mouseDown,Object(Ca.a)(this,this.Jfc,"preventNativeDragMouseDownHandler")),
this.frame.gd.xb(Zb.a.click,this.em,Object(Ca.a)(this,this.bD,"clickHandler")),this.Hz.parentNode&&this.Hz.parentNode.removeChild(this.Hz),this.Hz=null);this.em&&(id.zIc&&(Cc.a.removeHandler(this.em,Zb.a.Ns,Object(Ca.a)(this,this.Hua,"mouseOverHandler")),Cc.a.removeHandler(this.em,Zb.a.Zv,Object(Ca.a)(this,this.Zbc,"mouseOutHandler"))),this.Qja&&(this.Qja.dLd(),this.Qja.hE(this.em,this.n8)),this.em.parentNode&&this.em.parentNode.removeChild(this.em));this.Wp=this.e8=null}get comment(){return this.e8}get element(){return this.em}get frame(){return this.Wp.frame}DOd(){this.Qja&&
(this.n8=new Fb(this,Gc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Qja.ZI(this.em,this.n8))}updatePosition(W){this.em.style.left=Ce.a.Lc(W._x-(this.Wp.isRightToLeft?this.TB.wre:0));this.em.style.top=Ce.a.Lc(W._y)}zTg(W){this.Wp.lBb(this.e8,W)}select(W){this.xTa=W;this.kZa()}activate(W){this.wTa=W;this.kZa()}Xph(){}setVisibility(W){this.em.style.display=W&&!this.uxb?"block":"none"}kZa(){this.uxb||(this.Hz.className=id.uIc(this.e8)?this.xTa?Ee.getImageClassWithCluster(this.frame.UR,
this.TB.YRg):this.wTa?Ee.getImageClassWithCluster(this.frame.UR,this.TB.WRg):Ee.getImageClassWithCluster(this.frame.UR,this.TB.XRg):this.xTa?Ee.getImageClassWithCluster(this.frame.UR,this.TB.TRg):this.wTa?Ee.getImageClassWithCluster(this.frame.UR,this.TB.vre):Ee.getImageClassWithCluster(this.frame.UR,this.TB.Dbc))}get Fq(){return null}get h9c(){return 0}bD(W){if(W.Sz!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.e8,null,!1,!0,W.Vf,1,!1);W=W.lc;W.preventDefault();W.stopPropagation();
return!0}Hua(){this.frame.ymb(this.e8,1)}Zbc(){this.frame.ymb(null,1)}Jfc(W){W.preventDefault()}}Object(h.a)($e,"LegacyCommentMarkerViewElement",null,[503]);var bg=d(95),Ye=d(628);class Ae{constructor(W,ta,da,Ea,$a,fb,qc,Hc,kd){this.n8=null;this.GFg=this.wTa=this.xTa=!1;if(!ta)throw Error.argumentNull("parentElement");this.e8=W;this.Wp=da;this.Qja=Ea;this.TB=$a;this.aEa=fb;this.$Wc=qc;this.tYc=kd;this.em=document.createElement("div");this.em.className=id.uIc(W)?this.TB.VRg:this.TB.URg;Sys.UI.DomElement.addCssClass(this.em,
"CommentMarker");this.em.title=ResourceStrings.L_CommentMarkerTooltip;this.em.style.display="none";this.em.setAttribute("data-pptcommentid",String.format("{0}",W.commentId));this.Hz=document.createElement("img");this.Hz.alt=ResourceStrings.L_CommentMarkerTooltip;this.Hz.src=da.frame.Yj(da.frame.UR+".png");this.Hz.setAttribute(Ad.a.We,Ad.a.Xt);this.em.appendChild(this.Hz);this.kZa();this.frame.gd.ob(Zb.a.click,this.em,Object(Ca.a)(this,this.bD,"clickHandler"));id.zIc&&(Cc.a.addHandler(this.em,Zb.a.Ns,
Object(Ca.a)(this,this.Hua,"mouseOverHandler")),Cc.a.addHandler(this.em,Zb.a.Zv,Object(Ca.a)(this,this.Zbc,"mouseOutHandler")));id.oBc&&Cc.a.addHandler(this.Hz,Zb.a.mouseDown,Object(Ca.a)(this,this.Jfc,"preventNativeDragMouseDownHandler"));ta.appendChild(this.em);Hc||this.DOd()}dispose(){this.Hz&&(id.oBc&&Cc.a.removeHandler(this.Hz,Zb.a.mouseDown,Object(Ca.a)(this,this.Jfc,"preventNativeDragMouseDownHandler")),this.frame.gd.xb(Zb.a.click,this.em,Object(Ca.a)(this,this.bD,"clickHandler")),this.Hz.parentNode&&
this.Hz.parentNode.removeChild(this.Hz),this.Hz=null);this.em&&(id.zIc&&(Cc.a.removeHandler(this.em,Zb.a.Ns,Object(Ca.a)(this,this.Hua,"mouseOverHandler")),Cc.a.removeHandler(this.em,Zb.a.Zv,Object(Ca.a)(this,this.Zbc,"mouseOutHandler"))),this.Qja&&(this.Qja.dLd(),this.Qja.hE(this.em,this.n8)),this.em.parentNode&&this.em.parentNode.removeChild(this.em));this.Wp=this.e8=null}get comment(){return this.e8}get element(){return this.em}get frame(){return this.Wp.frame}DOd(){this.Qja&&(this.n8=new Fb(this,
Gc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Qja.ZI(this.em,this.n8))}updatePosition(){const W=this.$Wc.haj(this,this.comment);this.em.style.left=W._x+"px";this.em.style.top=W._y+"px"}zTg(){this.$Wc.xtl(this,this.comment)}select(W){this.xTa=W;this.kZa();this.onVisibilityChange()}activate(W){this.wTa=W;this.kZa();this.onVisibilityChange()}Xph(W){this.GFg=W;this.kZa();this.onVisibilityChange()}setVisibility(W){this.tYc=!W;this.onVisibilityChange()}onVisibilityChange(){!this.tYc&&
(this.xTa||this.wTa||this.GFg)?(this.updatePosition(this.frame.kAa(this.comment.pos.X,this.comment.pos.Y)),this.em.style.display="block",bg.a.OH(this.em,Ye.a.LDc)):(this.em.style.display="none",bg.a.vHa(this.em,Ye.a.LDc))}get Fq(){return this.aEa.EXi(this.e8)}get h9c(){return this.aEa.FXi(this.e8)}kZa(){this.Hz.className=id.uIc(this.e8)?this.xTa?Ee.getImageClassWithCluster(this.frame.UR,this.TB.YRg):this.wTa?Ee.getImageClassWithCluster(this.frame.UR,this.TB.WRg):Ee.getImageClassWithCluster(this.frame.UR,
this.TB.XRg):this.xTa?Ee.getImageClassWithCluster(this.frame.UR,this.TB.TRg):this.wTa?Ee.getImageClassWithCluster(this.frame.UR,this.TB.vre):Ee.getImageClassWithCluster(this.frame.UR,this.TB.Dbc)}bD(W){if(W.Sz!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.e8,null,!1,!0,W.Vf,1,!1);W=W.lc;W.preventDefault();W.stopPropagation();return!0}Hua(){this.Hz.className=Ee.getImageClassWithCluster(this.frame.UR,this.TB.vre)}Zbc(){this.Hz.className=Ee.getImageClassWithCluster(this.frame.UR,
this.TB.Dbc)}Jfc(W){W.preventDefault()}}Object(h.a)(Ae,"ModernCommentMarkerViewElement",null,[503]);class si{constructor(W,ta,da,Ea,$a,fb){this.aEa=W;this.$Wc=ta;this.TB=da;this.V7b=$a;this.uxb=fb;Ea.sWb().then(qc=>{qc||this.qJe(!1)})}dispose(){this.TB=null}create(W,ta,da,Ea,$a,fb){if(this.V7b){const qc=this.aEa.ccj(W);return new Ae(W,qc||ta,da,Ea,this.TB,this.aEa,this.$Wc,$a,fb)}return new $e(W,ta,da,Ea,this.TB,$a,fb,this.uxb)}qJe(W){this.uxb=this.V7b=W;this.TB.qJe(W)}}Object(h.a)(si,"CommentMarkerViewElementFactory",
null,[452,106]);var Jf=d(77);class tg extends Jf.a{constructor(){super()}L5h(W){this.addHandler(tg.Psh,W)}fVg(){this.raiseEvent(tg.Psh)}}tg.Psh="S";Object(h.a)(tg,"ATransactionCompletedProcessor",Jf.a,[502]);var Dg=d(36);class Vg extends tg{constructor(W,ta,da){super();this.V9j=W;this.TYc=ta;this.uW=da}get index(){return 0}run(){this.V9j()}ePf(W,ta){ta.property!==Ge.a.Upa&&ta.property!==Ge.a.gAa&&ta.property!==Ge.a.commentId&&ta.property!==Ge.a.zVb&&ta.property!==Ge.a.AVb&&ta.property!==Ge.a.Slc&&
ta.property!==Ge.a.Rlc||this.fVg()}POf(W,ta){ta.property!==Dg.a.pA&&ta.property!==Ge.a.zVb||this.fVg()}qsj(){this.TYc.Bd(39).xk(Object(Ca.a)(this,this.POf,"commentContentPropertyChanged"));this.TYc.Bd(40).xk(Object(Ca.a)(this,this.ePf,"commentPropertyChanged"));this.uW.B0k(this)}rrl(){this.TYc.Bd(40).Tm(Object(Ca.a)(this,this.ePf,"commentPropertyChanged"));this.TYc.Bd(39).Tm(Object(Ca.a)(this,this.POf,"commentContentPropertyChanged"))}}Object(h.a)(Vg,"CommentPropertyTracker",tg,[]);var Ih=d(895),
hf=d(127);class ld extends Ih.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new hf.a,{T_:ld.getTypeName(),B_:ld.kl()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static kl(){return["AugLoop_Signals_Signal"]}}Object(h.a)(ld,"CommentSmartReplySignal",Ih.a,[]);var ph=d(597);class Kf extends ph.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new hf.a,
{T_:Kf.getTypeName(),B_:Kf.kl()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static kl(){return["AugLoop_Core_Annotation"]}}Object(h.a)(Kf,"SmartReply",ph.a,[]);var Ud=d(454),He=d(425);class Bh{constructor(W,ta){this.UIh=W;this.kWe=ta}initialize(){this.kWe.execute(W=>{const ta=Kf.getTypeName();W.xmb(ta);W.whc(ta,Object(Ca.a)(this,this.zQa,"handleAnnotationEvent"))})}invoke(W,ta){const da=Object.assign(new Ud.a,{parentPath:["Signal",ld.getTypeName()],items:[Object.assign(new He.a,{body:Object.assign(new ld,
{commentId:W,comment:ta})})]});this.kWe.execute(Ea=>{Ea.submitOperation(da)})}zQa(W){if(W){var ta=new n.a;if(W&&W.CommentId&&W.ResultSets&&0<W.ResultSets.length&&W.ResultSets[0].Documents&&0<W.ResultSets[0].Documents.length){for(const da of W.ResultSets[0].Documents)ta.add(da.Caption);0<ta.count&&this.UIh.Lwk(W.CommentId,ta.toArray())}else Mb.a.J(557593412,327,10,"Invalid response from SmartReplies request")}else Mb.a.J(557593411,327,50,"Smart reply invocation returned null annotations.")}}Object(h.a)(Bh,
"CommentSmartReplyProvider",null,[]);var eg=d(305),jd=d(282),Jh=d(278),kf=d(96),Ji=d(178),hh=d(139),Wb=d(63),Uc=d(424);class Sc{constructor(W,ta,da,Ea,$a){this.Jee=this.pfe=this.Nfe=this.kWc=0;this.RDg=new n.a;this.gqe=this.$Dg=this.Lee=this.W$b=this.wme=0;this.aoe=new n.a;this.dde=this.cde=this.ede=this.bde=0;this.qCg=new n.a;this.D2c=new n.a;this.nfe=this.lfe=this.mfe=this.ofe=this.Hje=this.Gje=this.Ije=this.Jje=0;this.nWc=this.Eie=this.cXc=Pb.App.Im;this.jUa=null;this.bqe=this.cqe=this.E3c=this.Z3c=
this.U1c=this.ade=0;if(!W)throw Error.argumentNull("coreEventHandler");if(!ta)throw Error.argumentNull("appSettingsManager");this.Mc=W;this.$b=ta;this.ta=da;this.MK=Ea;this.Eee=$a;this.Mc.uB(Object(Ca.a)(this,this.jo,"onSessionRehydrated"));this.Mc.tB(Object(Ca.a)(this,this.VA,"onSessionEnd"))}get YMd(){return this.$b.ka("CommentTextAnchoringCreateNewEnabled")}get tkl(){return this.$b.ka("TasksForCommentsEnabled")}ace(W,ta,da,Ea){this.kWc+=1;this.Jee+=ta;da&&(this.bde+=1,this.aoe.add(W));Ea&&(this.ade+=
1)}OUj(W,ta,da,Ea){this.E3c=Ea?this.E3c+1:this.E3c;this.ace(W,ta,da,Ea)}NUj(W,ta,da,Ea,$a){($a=!!$a)&&Ea?this.cqe+=1:$a&&(this.bqe+=1);this.ace(W,ta,da,$a)}QXj(){this.ede+=1}NXj(){this.cde+=1}OXj(){this.dde+=1}PXj(W,ta,da,Ea){this.bug(W.commentId)||(da&&!this.BOj(ta,da.jD(),Ea)?this.rBg(W,da,!0):this.rBg(W,da,!1))}hJk(){this.pfe+=1}EXj(){this.ofe+=1}xVj(){this.mfe+=1}wVj(){this.lfe+=1}yVj(){this.nfe+=1}CVj(){this.Nfe+=1}OWj(W){this.RDg.contains(W)||(this.wme+=1,this.RDg.add(W))}nXj(W){this.U1c=W?
this.U1c+1:this.U1c;this.W$b+=1}dYj(W){this.Z3c=W?this.Z3c+1:this.Z3c}oXj(){this.W$b+=1}dce(W,ta,da){this.Lee=W;this.gqe=ta;this.qCg=da;this.bBg()}tVj(W){this.$Dg=W?1:2}sik(W){this.cXc===Pb.App.Im&&(this.cXc=new Date,this.KDa("OnCollabCornerCommentsEnabled",this.cXc,W),this.gHe("CollabCornerCommentsEnabled",this.cXc))}Ojk(W){this.Eie===Pb.App.Im&&(this.Eie=new Date,this.KDa("OnFloatingCommentsRendered",this.Eie,W))}rhk(W){this.nWc===Pb.App.Im&&(this.nWc=new Date,this.KDa("OnAllFloatingContainersVisible",
this.nWc,W),this.gHe("AllFloatingContainersVisible",this.nWc))}Qik(W){const ta=new Date;this.KDa("OnDeepLinkedCommentSelected",ta,W);this.gHe("DeepLinkedCommentSelected",ta)}bug(W){return this.qCg.contains(W)||this.D2c.contains(W)}BOj(W,ta,da){let Ea=0;for(const fb of ta)if(ta=Object(sb.a)(477,fb.oc(da))){ta=ta.htmlElement.getElementsByClassName(kf.a.MWb);for(let qc=0;qc<ta.length;qc++){var $a=ta[qc];const Hc=eg.a.re($a,kf.a.WMd);Hc&&(Ea+=Ic.a.contains(Hc,W)?1:0);($a=eg.a.re($a,kf.a.SMd))&&(Ea+=Ic.a.contains($a,
W)?1:0);if(2===Ea)return!0}}return!1}rBg(W,ta,da){if(W&&W.textAnchoringInfo&&!this.bug(W.commentId))if(W.textAnchoringInfo.EndPos<=W.textAnchoringInfo.StartPos){if(ta){if(da){this.Hje+=1;this.D2c.add(W.commentId);return}this.Ije+=1}else this.Jje+=1;this.D2c.add(W.commentId)}else 0>=W.textAnchoringInfo.TextBodyLength&&(this.aoe.contains(W.commentId)?this.aoe.remove(W.commentId):(this.Gje+=1,this.D2c.add(W.commentId)))}KDa(W,ta,da){const Ea={};Ea.Event=W;Ea.Time=ta.getTime();Ea.SlideId=da.toString();
Ea.LandingSlide=this.x5i();Ea.SessionDimensions=this.v0d();Ea.PerfMetrics=this.TXi();Ea.CommentPerfMetrics=this.k_i();Ea.CommentFileType=this.Eee;Ea.CommentDeepLinkedOpen=!!this.$b.Ha("CurrentCommentId");Ea.StandaloneCommentJsEnabled=!0;Ea.LoadSharedCommentsEarly=!0;Ea.FetchFullAppSettingsOnBoot=this.$b.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FetchFullAppSettingsOnBoot",!1);Ea.PrefetchCommentCloudPolicy=!0;Mb.a.J(509703831,805,15,mb.c(Ea))}bBg(){Mb.a.J(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",
this.Lee,this.Eee);Mb.a.J(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.gqe);Mb.a.J(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",this.YMd,this.tkl)}log(){Mb.a.J(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",this.kWc,this.Nfe,this.pfe,this.Jee/this.kWc,this.wme,this.W$b,this.Lee,this.Eee,this.$Dg);Mb.a.J(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",
this.gqe,this.bde,this.ede,this.cde,this.dde,this.Ije,this.Gje,this.Jje,this.Hje);Mb.a.J(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.ofe,this.mfe,this.lfe,this.nfe);this.LXj()}LXj(){Mb.a.J(509703824,845,15,"Task(s) - Added:{0}",this.ade);const W={};W.ResolvedTasksCount=this.U1c;W.UnresolvedTasksCount=this.Z3c;W.TasksCreatedNewThreadCount=this.E3c;W.TasksReassignedInReplyCount=this.cqe;W.TasksCreatedInReplyCount=this.bqe;Mb.a.J(509703823,845,
15,mb.c(W))}jo(){this.bBg()}VA(){this.log()}x5i(){if(this.jUa)return this.jUa;this.jUa={};var W=parseInt(this.$b.Ha("CurrentSlideId"));W=W!==Wb.a.empty.sid?Wb.a.bE(W,0):this.ta.presentation.Isb(0);if(!W)return this.jUa;this.jUa.SlideId=W.toString();if(W=this.ta.presentation.M0d(W.sid))W=Object(sb.a)(123,W).PE(),this.jUa.HasComments=this.MK.Gig(W),this.jUa.HasActiveComments=this.MK.sig(W);return this.jUa}v0d(){const W={};W.Ring=e.AFrameworkApplication.Yc.Ring;W.Host=e.AFrameworkApplication.Yc.Host;
W.UiHost=e.AFrameworkApplication.Yc.UiHost;W.SessionOrigin=e.AFrameworkApplication.Yc.SessionOrigin;W.ApplicationMode=e.AFrameworkApplication.Yc.ApplicationMode;W.Browser=e.AFrameworkApplication.Yc.Browser;W.Os=e.AFrameworkApplication.Yc.Os;return W}TXi(){const W={};W[jd.a.HJb]=Rb.a.instance.Rg(jd.a.HJb);W.DocPageNavigationStart=Rb.a.instance.Rg("DocPageNavigationStart");W[jd.a.JZb]=Rb.a.instance.Rg(jd.a.JZb);W[Uc.a.LEe]=Rb.a.instance.Rg(Uc.a.LEe);W[Uc.a.KEe]=Rb.a.instance.Rg(Uc.a.KEe);W[Uc.a.bfh]=
Rb.a.instance.Rg(Uc.a.bfh);W[Uc.a.VTd]=Rb.a.instance.Rg(Uc.a.VTd);W[Uc.a.WTd]=Rb.a.instance.Rg(Uc.a.WTd);W[Uc.a.UTd]=Rb.a.instance.Rg(Uc.a.UTd);W[Uc.a.VLd]=Rb.a.instance.Rg(Uc.a.VLd);W[jd.a.ymd]=0<Jh.a.instance.wah();return W}k_i(){const W={};W[gc.a.VMd]=Rb.a.instance.Rg(gc.a.VMd);W[gc.a.$Md]=Rb.a.instance.Rg(gc.a.$Md);W[gc.a.y2b]=Rb.a.instance.Rg(gc.a.y2b);W[gc.a.w5d]=Rb.a.instance.Rg(gc.a.w5d);W[gc.a.bKe]=Rb.a.instance.Rg(gc.a.bKe);W[gc.a.O2b]=Rb.a.instance.Rg(gc.a.O2b);W[gc.a.x5d]=Rb.a.instance.Rg(gc.a.x5d);
W[gc.a.Mbe]=Rb.a.instance.Rg(gc.a.Mbe);W[gc.a.FVd]=Rb.a.instance.Rg(gc.a.FVd);W[gc.a.GVd]=Rb.a.instance.Rg(gc.a.GVd);W[gc.a.xgd]=Rb.a.instance.Rg(gc.a.xgd);W[gc.a.WOd]=Rb.a.instance.Rg(gc.a.WOd);W[gc.a.VOd]=Rb.a.instance.Rg(gc.a.VOd);return W}Vbj(){const W=Rb.a.instance.Rg("DocPageNavigationStart");if(!Rb.a.instance.Rg(jd.a.HJb))return W;const ta=Rb.a.instance.Rg(jd.a.HJb);return 6E4>W-ta?ta:W}gHe(W,ta){const da=[];Array.add(da,Object.assign(new hh.a,{name:"EventName",string:W}));Bb.a.sendActivityEvent(Object.assign(new Ji.a,
{name:"CommentsBootEvents",durationMs:ta.getTime()-this.Vbj(),dataFields:da}))}}Object(h.a)(Sc,"CommentTelemetryManager",null,[482]);var Od=d(666),ug=d(667),te=d(668);class mf extends Od.a{constructor(W,ta){super();this.r2j=W;this.vi=ta;this.ije=[new ug.a(kf.a.SOf,null),new ug.a(kf.a.TOf,null),new ug.a(kf.a.UOf,null),new ug.a(kf.a.XOf,null),new ug.a(kf.a.aPf,null),new ug.a(kf.a.bPf,null),new ug.a(kf.a.$Of,null),new ug.a(kf.a.VOf,null),new ug.a(kf.a.WOf,null),new ug.a(kf.a.YOf,null),new ug.a(kf.a.ZOf,
null)]}get isInHighContrastMode(){return!!this.vi&&this.vi.isInHighContrastMode}get ntb(){return this.r2j}get j4d(){return this.ije}odc(W,ta){var da=this.qZ.rha;if(da&&0===da.type&&(da=this.qZ.rha.Nba,da=Object(v.a)(Array,da)?da:null)){var Ea=null,$a=null,fb=new Ma.a;for(const qc of da)qc.kec.isValid&&Array.contains(qc.kec.paragraphs,W)&&(0===qc.state?Ea=qc.commentId:1===qc.state&&($a=qc.commentId),fb.$(qc.commentId,qc.kec));this.a9h(ta.querySelectorAll("*"),fb,W,Ea,$a)}}T2b(W,ta){W=Object(v.a)(Array,
W)?Array.isArray(W)?W:null:null;if(!W||0<W.length&&!Object(sb.a)(ec,W[0]))return ta;for(const da of W)if(da.kec.isValid)for(const Ea of da.kec.paragraphs)Ea&&(te.b(Ea),ta.add(Ea));return ta}WOi(W,ta){W=W.ZIa;const da=ta?mf.s_j:mf.t_j;ta=gd.a.E7f(W,ta?mf.h4j:mf.i4j);W=gd.a.E7f(W,da);return ta<W}a9h(W,ta,da,Ea,$a){const fb=new pa.a,qc=new pa.a;for(let Ac=0;Ac<W.length;Ac++){const Lc=W[Ac];this.lcd(Lc);if(!Lc.parentNode)continue;var Hc=eg.a.re(Lc,kf.a.WMd),kd=eg.a.re(Lc,kf.a.SMd);const yc=[!1,!1,!1];
if(Hc)for(const Oc of Hc)if(ta.Jb(Oc)){Hc=ta.ga(Oc).V8f(da);if(ta.ga(Oc).Iig||(2===Hc||0===Hc)&&!this.isInHighContrastMode&&this.WOi(ta.ga(Oc),Oc===$a))ta.ga(Oc).Iig=!0,fb.add(Oc);qc.add(Oc);this.ZVf(ta,da,Oc,Ea,$a,yc,!0)}if(kd)for(const Oc of kd)qc.contains(Oc)&&(qc.remove(Oc),fb.remove(Oc),this.ZVf(ta,da,Oc,Ea,$a,yc,!1));if(0!==te.a(Lc)){kd=(Hc=0<fb.count)&&!!$a&&fb.contains($a);const Oc=!!Ea&&qc.contains(Ea),od=!!$a&&qc.contains($a);0<qc.count&&!this.isInHighContrastMode&&0<=Lc.parentNode.className.indexOf(kf.a.$Ia)&&
(bg.a.OH(Lc.parentNode,kf.a.SOf),od?bg.a.OH(Lc.parentNode,kd?kf.a.WOf:kf.a.VOf):Oc?(bg.a.OH(Lc.parentNode,kf.a.TOf),Hc=Lc.parentNode.className.match(new RegExp("\\b"+kf.a.$jg+"\\b")),(!Hc||1>Hc.length)&&bg.a.OH(Lc.parentNode,kf.a.UOf)):bg.a.OH(Lc.parentNode,Hc?kf.a.bPf:kf.a.aPf));yc[1]?bg.a.OH(Lc,kd?kf.a.ZOf:kf.a.YOf):yc[0]?bg.a.OH(Lc,kf.a.XOf):yc[2]&&bg.a.OH(Lc,kf.a.$Of)}}}ZVf(W,ta,da,Ea,$a,fb,qc){W=W.ga(da).V8f(ta);if(2===W||(qc?0===W:1===W))Ea&&Ea.equals(da)&&(fb[0]=!0),$a&&$a.equals(da)&&(fb[1]=
!0),fb[2]=!0}}mf.i4j="#F5E7F6";mf.t_j="#503355";mf.h4j="#F2E1F4";mf.s_j="#4C3050";Object(h.a)(mf,"CommentTextAnchorHighlightActor",Od.a,[]);class Yf{constructor(W){let ta;this.VPh=20;ta=W?W="SharedCommentBubble":W="SharedCommentBubbleSelected";this.QPh=this.wPa("SharedCommentBubble");this.PPh=this.wPa("SharedCommentBubbleHover");this.ldf=this.wPa(W);this.UPh=this.wPa("SharedCommentBubble");this.TPh=this.wPa("SharedCommentBubbleHover");this.mdf=this.wPa(ta);this.RPh="ModernCommentMarkerElementSingle cui-img-cont-float";
this.SPh="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get URg(){return this.RPh}get VRg(){return this.SPh}get wre(){return this.VPh}get Dbc(){return this.QPh}get vre(){return this.PPh}get TRg(){return this.ldf}get XRg(){return this.UPh}get WRg(){return this.TPh}get YRg(){return this.mdf}qJe(W){const ta=W?this.Dbc:"SharedCommentBubbleSelected";W=W?this.Dbc:ta;this.ldf=this.wPa(ta);this.mdf=this.wPa(W)}wPa(W){return String.format("{0}_{1}x{2}x32",W,this.wre,this.wre)}}Object(h.a)(Yf,"CommentViewHelper",
null,[]);class Jd{constructor(W,ta,da,Ea,$a,fb){this.Mc=W;this.ta=ta;this.yb=da;this.RMg=Ea;this.eb=fb;this.RMg.$F(Object(Ca.a)(this,this.p8c,"onSlideOrderChanged"));this.Mc.z2h(Object(Ca.a)(this,this.pXg,"onCommentsChanged"))}dispose(){this.Mc.MOk(Object(Ca.a)(this,this.pXg,"onCommentsChanged"));this.RMg.iO(Object(Ca.a)(this,this.p8c,"onSlideOrderChanged"))}pXg(){const W=this.ta.Ba;E.a.Lmb(this.yb,()=>{this.bxk(W)})}p8c(W,ta){if(2===ta.PY){const da=this.ta.Ba;E.a.Lmb(this.yb,()=>{this.e5g(da)})}}e5g(W){this.ta.Ba===
W&&W&&this.eb.pZa(!0)}bxk(W){this.e5g(W)}}Object(h.a)(Jd,"CommentsChangeListener",null,[106]);var ce=d(138),fe=d(275),Gg=d(168);class Me{static qAa(W,ta,da,Ea,$a,fb,qc){const Hc=Ce.a.CB();Hc.alt=fb;Hc.className=Ee.getImageClassWithCluster(ta,$a);Hc.setAttribute(Ad.a.We,Ad.a.Xt);Hc.src=W.Yj(ta+".png");Hc.setAttribute("Unselectable","on");W=Ce.a.zn();W.className=da+" cui-img-cont-float";W.setAttribute(Ad.a.We,Ad.a.Xt);W.appendChild(Hc);da=Ce.a.zn();da.className=Ea;da.setAttribute("Unselectable","on");
da.setAttribute(Ad.a.We,Ad.a.Xt);da.appendChild(W);Ea=Ce.a.Saa();Ea.className=Me.mWk+" cui-ctl";Ea.title=fb;Ea.setAttribute(Ad.a.We,Ad.a.Xt);Ea.setAttribute(Ad.a.vs,fb);Ea.appendChild(da);qc&&(fb=Ce.a.zn(),fb.className="cui-ctl-mediumlabel",fb.setAttribute("Unselectable","on"),fb.setAttribute(Ad.a.We,Ad.a.Xt),fb.innerText=qc,Ea.appendChild(fb));return Ea}static rAa(W,ta){return Me.qAa(W,W.UR,"cui-img-16by16","cui-ctl-iconContainer",ta,CommonUIStrings.l_DialogClose,null)}}Me.kWk="CommentPaneLTR";Me.lWk=
"CommentPaneRTL";Me.mWk="CommentPaneWithBorderButton";Me.AWk=300;Object(h.a)(Me,"CommentPaneHelper",null,[]);var se=d(46);class Pf{constructor(W,ta,da,Ea,$a){this.v8b=this.DFa=null;new fe.a(0,0,0,0);this.VTa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.SDg=null;this.Foh=!1;this.JG=$a;this.xI=W;this.Nb=ta;this.JG||(this.DFa=document.createElement("div"),this.DFa.className="CommentPanel",this.DFa.style.position="absolute");this.Ib=!1;this.BW=
da;this.VPg=Ea}dispose(){}layout(W,ta){if(this.VTa)return W;if(null===W)throw Error.argumentNull("availableArea");const da=ta?W.wC(this.width):W.xC(this.width);this.isVisible&&(ta?da.wC(1):da.xC(1));this.JG||Ce.a.zX(this.DFa,da);return W}w4d(W){this.v8b=W}d1k(W){this.SDg=W}Yo(W,ta){this.Ib=W;this.VTa?this.JG?this.KL(this.Ib):this.VPg.KL(this,this.Ib,ResourceStrings.L_Comments,se.a.Gp):(this.Nb.ycb(this.BW&&ta?1:2),this.xI.updateCommandUI())}KL(W){ce.UISurfaces.Cs().then(ta=>{W?ta.showTaskPane(se.a.Gp,
this.SDg):ta.hideTaskPane(se.a.Gp,2);return null}).catch(ta=>{Mb.a.J(572339907,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",ta.toString(),W.toString())})}ZGe(){ce.UISurfaces.Cs().then(W=>{W.setSelectedTaskPane(se.a.Gp);return null}).catch(W=>{Mb.a.J(572339909,833,10,"CommentsPane::SelectPane exception: {0}",W.toString())})}PYk(){try{this.JG?this.ZGe():this.VPg.ZGe(se.a.Gp)}catch(W){Mb.a.J(592591050,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",
W)}}ycb(W){this.Nb.ycb(this.BW&&W?1:2)}get isVisible(){return this.Ib}get ya(){return this.DFa}get order(){return 18}get width(){return this.isVisible?Me.AWk+1:0}}Object(h.a)(Pf,"CommentsPane",null,[457,481,106,476]);class yg{constructor(){this.hXa=this.GIa=0;this.Uc=this.JXa=this.gha=null}}Object(h.a)(yg,"FindCommentContext",null,[]);var qe;(function(W){W[W.findNextComment=0]="findNextComment";W[W.findPreviousComment=1]="findPreviousComment";W[W.findNextActiveComment=2]="findNextActiveComment";W[W.findPreviousActiveComment=
3]="findPreviousActiveComment"})(qe||(qe={}));Object(h.b)("FindCommentRequestType",qe);class yd{constructor(W,ta,da,Ea,$a,fb){this.yc=W;this.ta=ta;this.xie=da;this.sN=Ea;this.zIg=$a;this.ud=new yg;this.Y0j=fb}get fAa(){return this.Y0j.value}dispose(){this.xie.dispose();this.ud=this.xie=null}hVd(W,ta,da){this.dVd(0,!1,W,ta,da)}oVd(W,ta,da){this.dVd(1,!1,W,ta,da)}iVd(W,ta){this.dVd(0,!0,W,ta,!1)}dVd(W,ta,da,Ea,$a){var fb=this.ta.presentation;if(!fb)throw Error.argumentNull("Presentation is null");Ea||
(Ea=Qd.a.hm("FindComment",0),Ea.Wa("FindCommentRequestType",qe[W]));Ea.Wa(yd.mKd,"true");if(this.zIg&&this.ta.Ba){if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");const qc=this.ta.Ba.De;fb=fb.slides||[];this.ud.gha=da;this.ud.hXa=yd.W2i(W,$a);this.ud.Uc=Ea;ta?this.eVd(fb[qc>=fb.length-1?0:qc+1]):1===W?this.T2f(fb,qc-1,$a):this.Q2f(fb,qc+1,$a)}else Ea.Wa(yd.hgi,this.zIg.toString()),da(null,null,!1,!1)}Q2f(W,ta,da){this.ud.JXa=null;this.ud.GIa=ta;for(let Ea=ta;Ea<W.length;Ea++)if(W[Ea]&&
this.Rwg(W[Ea])){const $a=this.a3i(W[Ea],da);if($a){this.ud.gha(W[Ea],$a,!1,!1);return}}else{this.eVd(W[Ea]);return}0<ta?this.oRi(da):this.notFound()}T2f(W,ta,da){this.ud.JXa=null;this.ud.GIa=ta;for(let Ea=ta;-1<Ea;Ea--)if(W[Ea]&&this.Rwg(W[Ea])){const $a=this.D5i(W[Ea],da);if($a){this.ud.gha(W[Ea],$a,!1,!1);return}}else{this.eVd(W[Ea]);return}ta<W.length-1?this.wRi(da):this.notFound()}eVd(W){this.ud.Uc.Km(yd.Mgi,new Date);W&&this.xie.find(W.Bb,this.ud.hXa,Object(Ca.a)(this,this.Xnk,"onServerFindSucceeded"),
Object(Ca.a)(this,this.Wnk,"onServerFindFailed"))}Xnk(W){this.ud.Uc.dB(yd.mKd,"false");this.ud.Uc.Km(yd.bKf,new Date);this.ud.Uc.Wa(yd.KJf,"true");W?(this.ud.JXa=W,-1===this.p0b(this.ud.JXa.TargetSlideId)?this.notFound():this.ud.gha(this.vml(this.ud.JXa.TargetSlideId),this.ud.JXa.TargetComment,this.ud.JXa.IsFirstComment,this.ud.JXa.IsLastComment)):this.notFound()}Wnk(){this.ud.Uc.dB(yd.mKd,"false");this.ud.Uc.Km(yd.bKf,new Date);this.ud.Uc.Wa(yd.KJf,"false");Mb.a.J(512496786,805,50,"OnServerFindFailed");
this.notFound()}oRi(W){var ta=this.ta.presentation;if(!ta)throw Error.argumentNull("Presentation is null");ta=ta.slides||[];Ic.a.Va(ta)?this.notFound():this.Q2f(ta,0,W)}wRi(W){var ta=this.ta.presentation;if(!ta)throw Error.argumentNull("Presentation is null");ta=ta.slides||[];Ic.a.Va(ta)?this.notFound():this.T2f(ta,ta.length-1,W)}a3i(W,ta){W=this.yc.$k(W.Bb);if(this.fAa){const da=(W=this.sN.$5a(W))?W.length:0;for(let Ea=0;Ea<da;Ea++){const $a=W[Ea];if(yd.$xg($a,ta))return $a}return null}return this.sN.aRi(W,
ta)}D5i(W,ta){W=this.yc.$k(W.Bb);if(this.fAa){var da=(W=this.sN.$5a(W))?W.length:0;for(--da;0<=da;da--){const Ea=W[da];if(yd.$xg(Ea,ta))return Ea}return null}return this.sN.lRi(W,ta)}Rwg(W){return W.mD}p0b(W){var ta=this.ta.presentation;if(!ta)throw Error.argumentNull("Presentation is null");if(W){ta=ta.slides||[];W=new Wb.a(W);for(let da=0;da<ta.length;da++)if(ta[da]&&Wb.a.fNd(ta[da].Bb,W))return da}return-1}vml(W){return W?this.yc.xra(new Wb.a(W)):null}notFound(){this.ud.gha&&this.ud.gha(null,null,
!1,!1)}static W2i(W,ta){if(ta)switch(W){case 0:return 2;case 1:return 3}return W}static $xg(W,ta){return!ta||0===W.status}}yd.mKd="IsCompletedSearchInClient";yd.Mgi="ServerSearchStartTime";yd.bKf="ServerSearchEndTime";yd.KJf="IsServerSearchSucceeded";yd.hgi="IsBRSOn";Object(h.a)(yd,"FindCommentLogic",null,[455,106]);var zf=d(78);class xd{constructor(){this.type=0;this.gha=this.Uc=null;this.$Ed=!1}}Object(h.a)(xd,"Entry",null,[]);class fg{constructor(W,ta){this.hYc=null;this.qp=W;this.yb=ta;this.zka=
[];this.pme=0}dispose(){this.qp.dispose();this.zka=this.qp=null;Mb.a.J(25985481,805,50,"MaxQueuedEntryNum: {0}",this.pme)}hVd(W,ta,da){this.enqueue(1,W,ta,da)}oVd(W,ta,da){this.enqueue(0,W,ta,da)}iVd(W,ta){this.enqueue(2,W,ta,!1)}enqueue(W,ta,da,Ea){da.Wa("AlreadyQueuedEntryCount",this.zka.length.toString());W=Object.assign(new xd,{type:W,gha:($a,fb,qc,Hc)=>{ta($a,fb,qc,Hc);this.hYc=null;this.R3g()},Uc:da,$Ed:Ea});Array.enqueue(this.zka,W);this.pme=Math.max(this.pme,this.zka.length);this.R3g()}R3g(){0<
this.zka.length&&!this.hYc&&(this.hYc=new zf.a(2,1,0,Object(Ca.a)(this,this.cBk,"processOneEntry"),90,"49"),this.yb.Gb(this.hYc))}cBk(){const W=Array.dequeue(this.zka);1===W.type?this.qp.hVd(W.gha,W.Uc,W.$Ed):0===W.type?this.qp.oVd(W.gha,W.Uc,W.$Ed):this.qp.iVd(W.gha,W.Uc)}}Object(h.a)(fg,"FindCommentLogicDecorator",null,[455,106]);var Ki=d(377),jg=d(105);class Ch extends jg.a{constructor(W,ta){super();this.StartSlideId=null;this.RequestType=0;this.FFindModernComments=!1;if(null===W)throw Error.argumentNull("slideId");
this.RequestType=ta;this.StartSlideId=W.toString();this.FFindModernComments=!0}Ik(){return 88}}Object(h.a)(Ch,"FindCommentRequest",jg.a,[]);class ih extends Ki.a{constructor(W){super();this.aVa=null;this.xNg=0;this.XFa=this.tEa=null;this.enabled=2;this.Xyb=0;this.Fl=!1;this.vm=W;this.vm.register(this)}dispose(){this.Fl||(1===this._state&&this.vm.unregister(this),this.Fl=!0,this.Xyb=0)}find(W,ta,da,Ea){0<this.Xyb&&null!==da&&(Mb.a.J(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",
this.Xyb),da(null));this.aVa=W;this.xNg=ta;this.OE(da,Ea,null)}sia(){return 0<this.Xyb&&!this.Fl}JP(){return!1}QQa(){return this.iwg||this.sia()}MEb(){if(1===this._state)this.Md.bH=new Ch(this.aVa,this.xNg),this.Md.status=1,this._state=3;else if(3===this._state&&this.iwg)if(Mb.a.J(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",this.Md.Zcd,this.Md.zt,this.Md.Iu),2===this.Md.statusCode&&this.Md.vr&&1===this.Md.vr.length){const W=this.Md.vr[0];0!==W.StatusCode?
this.XG(W):this.F_(W)}else this.XG()}OE(W,ta){this.Xyb++;this.XFa=W;this.tEa=ta;this.vm.T9()}forceOutbound(){}XG(W=null){Mb.a.J(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.Md.qy,this.Md.statusCode,W?W.StatusCode:-1);this.RYg(W,!1)}F_(W){this.RYg(W,!0)}get iwg(){return!!this.Md&&2===this.Md.status}RYg(W,ta){this.Xyb--;this._state=1;if(ta){ta=null;try{ta=Sys.Serialization.JavaScriptSerializer.deserialize(W.FindCommentResult)}catch(da){Mb.a.J(523249095,
805,10,"Cannot parse find comment result: {0}",da)}this.XFa(ta)}else this.tEa(null,-1)}}Object(h.a)(ih,"FindCommentReplicator",Ki.a,[106]);class qh{constructor(){this.Xs=null;this.Roc=this.Rpf=this.hWe=this.Axc=this.Oyf=this.Cef=this.Qrf=!1}Bcj(){this.Xs||(m.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.emh());return this.Xs}l7i(){return new Promise((W,ta)=>{this.Roc?W(this.Cag()):this.$jh().then(()=>{W(this.Cag())}).catch(da=>
{ta(da)})})}Cag(){this.Roc||m.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let W;W=33;this.hWe&&(W|=2);this.Qrf&&(W|=8);this.Oyf&&(W|=16);this.Cef&&(W|=4);this.Axc&&(W|=64);this.Rpf&&(W|=128);return W}}Object(h.a)(qh,"OfficeSharedCommentsAppCapabilities",null,[1512]);class Md extends qh{constructor(W,ta,da,Ea,$a,fb){super();this.$b=W;this.Ga=ta;this.mMg=da;this.Z4j=fb;this.H5k(Ea,$a);this.emh();
this.$jh()}H5k(W,ta){this.Axc=this.$b.ka("TasksForCommentsEnabled")&&!W;this.Oyf=!1;this.Qrf=ta;this.Rpf=this.Cef=!0}emh(){this.Xs={};const W=this.Axc&&e.AFrameworkApplication.fa.ka("TasksCreationFromReplyEnabled");this.Xs.CommentsFluentUI="true";this.Xs.CommentsFluentUIV2="true";this.Xs.CommentTasks=this.Axc.toString();Td.a("DeprecateIE.SharedCommentAppCapabilities")?this.Xs.DisabledChangeGates=this.$b.Ha("DisabledChangeGatesInSharedComments"):this.Xs.DisabledChangeGates=Jb.a.xj?"WebThemeIntegrationHighContrastFixes,":
""+this.$b.Ha("DisabledChangeGatesInSharedComments");this.Xs.DiscreteHostedComments="true";this.Xs.NewCommentButton="true";this.Xs.PersonaColor="true";this.Xs.LivePersonaPicker="true";this.Xs.AtMentionFloodgateSurvey=e.AFrameworkApplication.fa.ka("AtMentionUserFloodGateCampaignIsEnabled").toString();this.Xs.CommentTasksFromReply=W.toString();this.Xs.LogDraftCommentIdPair=this.Z4j.toString();this.Xs.HyperlinksInComments="true";this.Xs.SmartReplies=this.$b.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",
!1).toString();this.Xs.NewModelState="true";this.Xs.TaskPaneWithNewInfrastructure=this.Ga.aNd.toString();this.Xs.NewSelectionInteractions="true";this.Xs.ExtendedDrafting="true";this.Xs.LinkToComment="true";this.Xs.PersonaIconImageForWeb="true";this.Xs.NoDiscardOnFocusLoss="true";this.Xs.WebThemeIntegration="true";this.Xs.TaskHistoryRecordIDs=this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1).toString()}$jh(){return new Promise((W,ta)=>{this.mMg?this.mMg.atMentionsEnabledAsync().then(da=>
{this.hWe=da;this.Roc=!0;W(this.Roc)}):(m.ULS.sendTraceTag(528307426,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),ta(E.a.du(-2130915320)))})}}Object(h.a)(Md,"PPTSharedCommentAppCapabilities",qh,[]);class Ed{constructor(W){this.wg=W}display(W,ta){this.wg.lSe(W?0:2,ta);this.wg.setVisibility()}dismiss(){this.wg.rmi();this.wg.setVisibility()}activate(){this.wg.lSe(1);this.wg.setVisibility()}OGi(W){this.wg.lSe(W?
0:2)}$m(W){this.wg.$m(W)}XD(W){this.wg.XD(W)}kq(){return this.wg.kq()}IP(W){return this.wg.kub(W)}Ux(W){this.wg.Ux(W)}dispose(){this.wg.dispose()}nz(){this.wg.nz()}XE(W){return this.wg.XE(W)}QD(W){return this.wg.QD(W)}draw(W,ta){this.wg.draw(W,ta)}get visible(){return this.wg.visible}set visible(W){this.wg.visible=W}setPosition(W,ta){this.wg.setPosition(W,ta)}Ej(W){this.wg.Ej(W)}Uq(W){this.wg.Uq(W)}pv(W){this.wg.pv(W)}setZIndex(W){this.wg.setZIndex(W)}AF(W,ta){this.wg.AF(W,ta)}setSelection(){}}Object(h.a)(Ed,
"ShapeCommentsAnchoredSelectionView",null,[480,387,388,106]);class Bd{constructor(W,ta){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=W;this.canvasContextId=ta}}Object(h.a)(Bd,"CommentUIAction",null,[]);var Xh=d(62),$f=d(634),Vi=d(119),ci=d(177),Bi=d(1080),bh=d(523);class Wg{constructor(){this.draftId=null;this.insertIndex=0;this.anchorHintText=null}}Object(h.a)(Wg,
"CurrentContextDraft",null,[]);class jf{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(h.a)(jf,"IContentAnchorPosition",null,[]);class kg{constructor(){this.y=this.x=this.height=this.width=0}}Object(h.a)(kg,"IViewportInfo",null,[]);class vh{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=this.paneOpenedCallback=this.paneClosedCallback=
null}}Object(h.a)(vh,"FloatingContainerManagerCreationParams",null,[]);var nd=d(137),Oe=d(50),ti=d(803),Kh=d(404),Rd=d(373),Bj=d(880),ui;(function(W){W[W.line=0]="line";W[W.lineInv=1]="lineInv";W[W.triangle=2]="triangle";W[W.rtTriangle=3]="rtTriangle";W[W.rect=4]="rect";W[W.diamond=5]="diamond";W[W.parallelogram=6]="parallelogram";W[W.trapezoid=7]="trapezoid";W[W.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";W[W.pentagon=9]="pentagon";W[W.hexagon=10]="hexagon";W[W.heptagon=11]="heptagon";W[W.octagon=
12]="octagon";W[W.decagon=13]="decagon";W[W.dodecagon=14]="dodecagon";W[W.star4=15]="star4";W[W.star5=16]="star5";W[W.star6=17]="star6";W[W.star7=18]="star7";W[W.star8=19]="star8";W[W.star10=20]="star10";W[W.star12=21]="star12";W[W.star16=22]="star16";W[W.star24=23]="star24";W[W.star32=24]="star32";W[W.roundRect=25]="roundRect";W[W.round1Rect=26]="round1Rect";W[W.round2SameRect=27]="round2SameRect";W[W.round2DiagRect=28]="round2DiagRect";W[W.snipRoundRect=29]="snipRoundRect";W[W.snip1Rect=30]="snip1Rect";
W[W.snip2SameRect=31]="snip2SameRect";W[W.snip2DiagRect=32]="snip2DiagRect";W[W.plaque=33]="plaque";W[W.ellipse=34]="ellipse";W[W.teardrop=35]="teardrop";W[W.homePlate=36]="homePlate";W[W.chevron=37]="chevron";W[W.pieWedge=38]="pieWedge";W[W.pie=39]="pie";W[W.blockArc=40]="blockArc";W[W.donut=41]="donut";W[W.noSmoking=42]="noSmoking";W[W.rightArrow=43]="rightArrow";W[W.leftArrow=44]="leftArrow";W[W.upArrow=45]="upArrow";W[W.downArrow=46]="downArrow";W[W.stripedRightArrow=47]="stripedRightArrow";W[W.notchedRightArrow=
48]="notchedRightArrow";W[W.bentUpArrow=49]="bentUpArrow";W[W.leftRightArrow=50]="leftRightArrow";W[W.upDownArrow=51]="upDownArrow";W[W.leftUpArrow=52]="leftUpArrow";W[W.leftRightUpArrow=53]="leftRightUpArrow";W[W.quadArrow=54]="quadArrow";W[W.leftArrowCallout=55]="leftArrowCallout";W[W.rightArrowCallout=56]="rightArrowCallout";W[W.upArrowCallout=57]="upArrowCallout";W[W.downArrowCallout=58]="downArrowCallout";W[W.leftRightArrowCallout=59]="leftRightArrowCallout";W[W.upDownArrowCallout=60]="upDownArrowCallout";
W[W.quadArrowCallout=61]="quadArrowCallout";W[W.bentArrow=62]="bentArrow";W[W.uturnArrow=63]="uturnArrow";W[W.circularArrow=64]="circularArrow";W[W.leftCircularArrow=65]="leftCircularArrow";W[W.leftRightCircularArrow=66]="leftRightCircularArrow";W[W.curvedRightArrow=67]="curvedRightArrow";W[W.curvedLeftArrow=68]="curvedLeftArrow";W[W.curvedUpArrow=69]="curvedUpArrow";W[W.curvedDownArrow=70]="curvedDownArrow";W[W.swooshArrow=71]="swooshArrow";W[W.cube=72]="cube";W[W.can=73]="can";W[W.lightningBolt=
74]="lightningBolt";W[W.heart=75]="heart";W[W.sun=76]="sun";W[W.moon=77]="moon";W[W.smileyFace=78]="smileyFace";W[W.irregularSeal1=79]="irregularSeal1";W[W.irregularSeal2=80]="irregularSeal2";W[W.foldedCorner=81]="foldedCorner";W[W.bevel=82]="bevel";W[W.frame=83]="frame";W[W.halfFrame=84]="halfFrame";W[W.corner=85]="corner";W[W.diagStripe=86]="diagStripe";W[W.chord=87]="chord";W[W.arc=88]="arc";W[W.leftBracket=89]="leftBracket";W[W.rightBracket=90]="rightBracket";W[W.leftBrace=91]="leftBrace";W[W.rightBrace=
92]="rightBrace";W[W.bracketPair=93]="bracketPair";W[W.bracePair=94]="bracePair";W[W.straightConnector1=95]="straightConnector1";W[W.bentConnector2=96]="bentConnector2";W[W.bentConnector3=97]="bentConnector3";W[W.bentConnector4=98]="bentConnector4";W[W.bentConnector5=99]="bentConnector5";W[W.curvedConnector2=100]="curvedConnector2";W[W.curvedConnector3=101]="curvedConnector3";W[W.curvedConnector4=102]="curvedConnector4";W[W.curvedConnector5=103]="curvedConnector5";W[W.callout1=104]="callout1";W[W.callout2=
105]="callout2";W[W.callout3=106]="callout3";W[W.accentCallout1=107]="accentCallout1";W[W.accentCallout2=108]="accentCallout2";W[W.accentCallout3=109]="accentCallout3";W[W.borderCallout1=110]="borderCallout1";W[W.borderCallout2=111]="borderCallout2";W[W.borderCallout3=112]="borderCallout3";W[W.accentBorderCallout1=113]="accentBorderCallout1";W[W.accentBorderCallout2=114]="accentBorderCallout2";W[W.accentBorderCallout3=115]="accentBorderCallout3";W[W.wedgeRectCallout=116]="wedgeRectCallout";W[W.wedgeRoundRectCallout=
117]="wedgeRoundRectCallout";W[W.wedgeEllipseCallout=118]="wedgeEllipseCallout";W[W.cloudCallout=119]="cloudCallout";W[W.cloud=120]="cloud";W[W.ribbon=121]="ribbon";W[W.ribbon2=122]="ribbon2";W[W.ellipseRibbon=123]="ellipseRibbon";W[W.ellipseRibbon2=124]="ellipseRibbon2";W[W.leftRightRibbon=125]="leftRightRibbon";W[W.verticalScroll=126]="verticalScroll";W[W.horizontalScroll=127]="horizontalScroll";W[W.wave=128]="wave";W[W.doubleWave=129]="doubleWave";W[W.plus=130]="plus";W[W.flowChartProcess=131]=
"flowChartProcess";W[W.flowChartDecision=132]="flowChartDecision";W[W.flowChartInputOutput=133]="flowChartInputOutput";W[W.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";W[W.flowChartInternalStorage=135]="flowChartInternalStorage";W[W.flowChartDocument=136]="flowChartDocument";W[W.flowChartMultidocument=137]="flowChartMultidocument";W[W.flowChartTerminator=138]="flowChartTerminator";W[W.flowChartPreparation=139]="flowChartPreparation";W[W.flowChartManualInput=140]="flowChartManualInput";
W[W.flowChartManualOperation=141]="flowChartManualOperation";W[W.flowChartConnector=142]="flowChartConnector";W[W.flowChartPunchedCard=143]="flowChartPunchedCard";W[W.flowChartPunchedTape=144]="flowChartPunchedTape";W[W.flowChartSummingJunction=145]="flowChartSummingJunction";W[W.flowChartOr=146]="flowChartOr";W[W.flowChartCollate=147]="flowChartCollate";W[W.flowChartSort=148]="flowChartSort";W[W.flowChartExtract=149]="flowChartExtract";W[W.flowChartMerge=150]="flowChartMerge";W[W.flowChartOfflineStorage=
151]="flowChartOfflineStorage";W[W.flowChartOnlineStorage=152]="flowChartOnlineStorage";W[W.flowChartMagneticTape=153]="flowChartMagneticTape";W[W.flowChartMagneticDisk=154]="flowChartMagneticDisk";W[W.flowChartMagneticDrum=155]="flowChartMagneticDrum";W[W.flowChartDisplay=156]="flowChartDisplay";W[W.flowChartDelay=157]="flowChartDelay";W[W.flowChartAlternateProcess=158]="flowChartAlternateProcess";W[W.flowChartOffpageConnector=159]="flowChartOffpageConnector";W[W.actionButtonBlank=160]="actionButtonBlank";
W[W.actionButtonHome=161]="actionButtonHome";W[W.actionButtonHelp=162]="actionButtonHelp";W[W.actionButtonInformation=163]="actionButtonInformation";W[W.actionButtonForwardNext=164]="actionButtonForwardNext";W[W.actionButtonBackPrevious=165]="actionButtonBackPrevious";W[W.actionButtonEnd=166]="actionButtonEnd";W[W.actionButtonBeginning=167]="actionButtonBeginning";W[W.actionButtonReturn=168]="actionButtonReturn";W[W.actionButtonDocument=169]="actionButtonDocument";W[W.actionButtonSound=170]="actionButtonSound";
W[W.actionButtonMovie=171]="actionButtonMovie";W[W.gear6=172]="gear6";W[W.gear9=173]="gear9";W[W.funnel=174]="funnel";W[W.mathPlus=175]="mathPlus";W[W.mathMinus=176]="mathMinus";W[W.mathMultiply=177]="mathMultiply";W[W.mathDivide=178]="mathDivide";W[W.mathEqual=179]="mathEqual";W[W.mathNotEqual=180]="mathNotEqual";W[W.cornerTabs=181]="cornerTabs";W[W.squareTabs=182]="squareTabs";W[W.plaqueTabs=183]="plaqueTabs";W[W.chartX=184]="chartX";W[W.chartStar=185]="chartStar";W[W.chartPlus=186]="chartPlus"})(ui||
(ui={}));Object(h.b)("ST_ShapeType",ui);var Na=d(151);class qb{constructor(){this.RowId=this.ColId=null}}Object(h.a)(qb,"TableCellInfo",null,[]);var wb=d(879),jc=d(52),Qc=d(182),Cd=d(122),Ld=d(166),ie=d(1077),Qe=d(907),df=d(908),tf=d(340),jh=d(103);class Dh{constructor(W,ta){this.Wta=this.axb=null;this.zJg=!1;this.Zoe=W;this.fh=ta}get JNj(){return this.zJg}tEb(W,ta){ta&&W.removeNotification(ta);return ta}lNk(W){this.axb=this.tEb(W,this.axb);this.tEb(W,this.Wta);this.Wta=this.axb=null}Lcl(W,ta,da){W?
this.Zoe.fm.isVisible&&1===W.EL.length&&ta.Ba&&Wb.a.Cea(W.v5a.Bb,ta.Ba.Bb)||ce.UISurfaces.VM().then(Ea=>{this.Wta=this.tEb(Ea,this.Wta);this.Wta=null;var $a=Object.assign(new ie.a,{label:W.FDb,onExecute:()=>{W.primaryButtonAction(this.Zoe,ta);ta.Ba.De!==W.v5a.De&&da.wda(W.v5a.De);this.tEb(Ea,this.Wta);this.Wta=null}}),fb=Object.assign(new ie.a,{label:W.ved,onExecute:()=>{this.zJg=!0;this.tEb(Ea,this.Wta);this.Wta=null}});fb=Object.assign(new Qe.a,{target:".EditingRibbonPanel",title:W.title,content:W.content,
primaryButtonProps:$a,secondaryButtonProps:fb,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new df.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.fh.qo(se.a.Wfb)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});$a=Object.assign(new tf.a,{onShow:()=>{this.fh.TJ(se.a.Wfb)}});fb=Ea.callout(fb);this.Wta=Ea.addNotification(fb,$a)}):Mb.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}Iph(W,
ta){const da=new jh.StandardDialog;da.vd=4;da.Yw(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,ta?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,Ea=>{1===Ea?(W.jXb(ta),this.Zoe.pUd(ta)?this.Jph():this.Hph(ta?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:ResourceStrings.l_DeleteAllCommentsInPresentationCallout),Mb.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",
ta)):Mb.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",ta)})}Jph(){const W=new jh.StandardDialog;W.vd=0;W.Yw(ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,null)}Hph(W){const ta=()=>{this.fh.TJ(se.a.Wfb)},da=()=>{this.fh.qo(se.a.Wfb)};ce.UISurfaces.VM().then(Ea=>{this.tEb(Ea,this.axb);this.axb=null;var $a=Object.assign(new Qe.a,{target:".EditingRibbonPanel",title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,
content:W,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new df.a,{directionalHint:6,isBeakVisible:!1,onDismiss:da,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const fb=Object.assign(new tf.a,{onShow:ta});$a=Ea.callout($a);this.axb=Ea.addNotification($a,fb)})}}Object(h.a)(Dh,"CommentCalloutDialogManager",null,[]);var ch=d(936);class Hg{constructor(W){this.rUa=W;this.zka=[];this.kfe=new ch.a(1E3,Object(Ca.a)(this,this.perform,"perform"))}Zwk(W){Array.contains(this.zka,
W)||Array.add(this.zka,W);this.kfe.perform()}perform(){const W=this.zka;this.zka=[];for(let ta=0;ta<W.length;ta++){const da=W[ta];this.rUa.lBb(da.commentId,new rc.a(da.pos.X,da.pos.Y))}}}Object(h.a)(Hg,"CommentKeyboardMoveController",null,[]);class wh{constructor(W,ta,da,Ea,$a){this.NDa=this.Zta=null;this.Tca=[];if(!W)throw Error.argumentNull("parentElement");if(!ta)throw Error.argumentNull("frame");this.Myb=da;this.Wh=W;this.eb=ta;this.OFg=Ea;this.YFg=$a}dispose(){this.kDe();this.eb=this.Wh=null}kDe(){this.NDa=
this.Zta=null;if(this.Tca&&0<this.Tca.length){for(const W of this.Tca)W&&W.dispose();Array.clear(this.Tca)}}dZ(W){if(!this.hBa)return!0;if(!W||!W.length)return!1;W=Ld.e(W,ta=>0===ta.status);return!!W&&0<W.length}Ubd(W){this.kDe();if(W&&this.Wh){var ta=this.eb.isReadOnly?null:this.eb.Bt;for(const da of W)this.Tca.push(this.Myb.create(da,this.Wh,this,ta,this.eb.isReadOnly,this.xs&&id.RM(da)||!this.YFg));this.dZ(W)&&this.PSe()}}selectComment(W,ta){if(!(!W&&!this.Zta||this.Zta&&id.Rqb(W,this.Zta.comment))&&
(this.Zta&&this.Zta.select(!1),this.Zta=null,W))for(const da of this.Tca){if(id.Rqb(da.comment,W)){this.Zta=da;da.select(!0);break}if(ta&&da.comment.Children)for(const Ea of da.comment.Children)if(id.Rqb(Ea,W)){this.Zta=da;da.select(!0);return}}}ymb(W,ta){if(!(!W&&!this.NDa||this.NDa&&id.Rqb(W,this.NDa.comment))&&(this.NDa&&this.NDa.activate(!1),this.NDa=null,W))for(const da of this.Tca){if(id.Rqb(da.comment,W)){this.NDa=da;da.activate(!0);break}if(ta&&da.comment.Children)for(const Ea of da.comment.Children)if(id.Rqb(Ea,
W)){this.NDa=da;da.activate(!0);return}}}Yph(W){for(const ta of this.Tca)ta.Xph(W)}PSe(){for(const W of this.Tca)W.updatePosition(this.eb.kAa(W.comment.pos.X,W.comment.pos.Y))}lBb(W,ta){ta=this.eb.IQf(ta._x,ta._y);W.pos.X+=ta._x;W.pos.Y+=ta._y;ta=new rc.a(W.pos.X,W.pos.Y);this.eb.selectComment(W,null,!0,!1,0,1,!1);this.eb.manager.lBb(W.commentId,ta)}avl(W){for(const ta of this.Tca)if(ta.comment===W){ta.updatePosition(this.eb.kAa(ta.comment.pos.X,ta.comment.pos.Y));break}}cvl(W){for(const ta of W)for(const da of this.Tca)da.comment.commentId===
ta.commentId&&da.updatePosition(this.eb.kAa(da.comment.pos.X,da.comment.pos.Y))}setVisibility(W){this.YFg=W;for(const ta of this.Tca)ta.setVisibility(!(this.xs&&id.RM(ta.comment))&&W)}get frame(){return this.eb}get isRightToLeft(){return this.OFg}set isRightToLeft(W){this.OFg=W}get parentElement(){return this.Wh}set parentElement(W){this.Wh=W}get zFb(){return this.Zta}get xs(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("CommentTextAnchoringUIEnabled")}get hBa(){return!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("SlideResizePerfImprovementEnabled")}}Object(h.a)(wh,"CommentMarkerView",null,[]);class Yh{constructor(){this.comment=this.slide=null;this.direction=0;this.KGe=null}}Object(h.a)(Yh,"CommentSelectContext",null,[]);var Ni;(function(W){W[W.previous=0]="previous";W[W.next=1]="next"})(Ni||(Ni={}));Object(h.b)("CommentSelectDirection",Ni);class vi{constructor(W,ta){if(!W||1>W.length)throw Error.argument("ISlideNode[] slides");if(!ta)throw Error.argumentNull("ICommentGraphManager graphManager");
this.A8j=W;this.el=ta;this.toe=[];this.init()}get TGa(){return this.A8j}get EL(){return this.toe}get v5a(){return this.EL[this.EL.length-1]}get FDb(){return 1<this.EL.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get ved(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.kel()}init(){for(const W of this.TGa)for(const ta of this.el.hra(W.PE()))if(1===
ta.status){this.toe.push(W);break}if(1>this.toe.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}kel(){switch(this.EL.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.EL[1].De+1,this.EL[0].De+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.EL[2].De+1,this.EL[1].De+1,this.EL[0].De+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,
this.EL[3].De+1,this.EL[2].De+1,this.EL[1].De+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.EL[this.EL.length-1].De+1,this.EL[this.EL.length-2].De+1,this.EL[this.EL.length-3].De+1,this.EL.length-3)}}k3i(){for(const W of this.el.$5a(this.v5a))if(1===W.status)return W;return null}primaryButtonAction(W,ta){if(!ta.presentation||!ta.presentation.slides)return Mb.a.J(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",
ta.presentation?"Presentation.Slides":"Presentation"),null;const da=this.k3i();if(!da)return null;W.fm.isVisible||W.Xgd();if(ta.Ba&&Wb.a.Cea(ta.Ba.Bb,this.v5a.Bb))W.pea(da.commentId,1,!0);else for(const Ea of ta.presentation.slides)if(Wb.a.Cea(Ea.Bb,this.v5a.Bb))return Object.assign(new Yh,{slide:this.v5a,comment:da,direction:1,KGe:Qd.a.hm("SelectResolvedCommentCrossSlide",1)});return null}}Object(h.a)(vi,"ResolvedCommentsCalloutParams",null,[]);class Eh{constructor(){this.type="SharedCommentsTaskPaneProps";
this.focusCallback=null}}Object(h.a)(Eh,"SharedCommentsTaskPaneProps",null,[]);var xh=d(939),fj=d(423),Wi=d(161);class yh{constructor(W,ta,da,Ea,$a,fb,qc,Hc,kd,Ac,Lc,yc,Oc,od,di,ij,rh,Qg,be,Oi,Pi,wk,xk,Yl,Af,Ff,pj,dl,Zl,Cj,Sm,im,Tm,jm,jk,de,Kj,qg,el,Cm,qj,ck,Lk,Rg,mg,Dj,kk,qn,yk,rn,nl,lk,Xi,Al,Yi){this.Roe=this.Pm=null;this.o$a=!0;this.yo=this.Zge=this.Y7b=this.Hge=this.q$a=!1;this.rab=0;this.u2c=this.Rzb=!1;this.bEa=this.H1c=this.Uh=this.XSa=this.sbb=this.Y8=this.sCg=null;this.RFg=this.ZTa=!1;this.nr=
null;this.epe=this.sge=!1;this.CNg=null;this.CJf=[se.a.pC,se.a.Gp,se.a.L1,se.a.hpi];this.Zhb=2147483647;this.nwb=0;this.jKg=-1;this.PDg=0;this.M9b=null;this.x1c=this.Cee=!1;if(!de)throw Error.argumentNull("appSettingsManager");if(!wk)throw Error.argumentNull("commentEventHost");if(!ta)throw Error.argumentNull("commentTelemetryManager");this.JG=nl;this.ia=da;this.Nb=Ea;this.fm=$a;this.Bt=fb;this.gd=qc;this.Fa=Hc;this.fh=kd;this.fe=Ac;this.ra=Lc;this.Hc=Oc;this.Ox=od;this.jv=di;this.el=W;this.wD=ta;
this.X3j=new Hg(W);this.KW=ij;this.ta=rh;this.F3c=Qg.Bd(40);this.$Lg=Td.a("PreventCommentDraftDeletionOnPageContentChange")?Qg.Bd(7):Qg.Bd(8);this.hzb=yc;this.Sca=Oc.Jc?Oc.Jc.UMd:null;this.qta=Af;this.yb=Oi;this.QZ=wk;this.Wbb=xk;this.aLg=Pi;this.o2c=Yl;this.Dee=Ff;this.DYc=pj;this.Ie=Cj;this.W0c=dl;this.xq=Zl;this.jXc=Sm;this.hv=im;this.Myb=Tm;this.vQ=jm;this.In=jk;this.$b=de;this.Ur=qg;this.tFg=el;this.Y2=new n.a;this.Kd=Cm;this.Xa=qj;this.pbb=Lk;this.cta=ck;this.Qc=Rg;this.Ea=kk;this.D7j=qn;this.iW=
yk;this.b8b=rn;this.Ga=Xi;this.tm=Al;this.nW=Yi;this.V7b=Dj;this.SEa=!1;this.ia.Zla(this);this.O9a=new Dh(this,this.fh);if(!Kj)throw Error.argumentNull("InteractiveViewManagerFuture");this.XHg=Kj;this.SYj=this.hvi();this.JG&&this.fm.d1k(this.T8i());this.Mb=lk;mg.sWb().then(mk=>{mk||this.SHe(!1)})}get sIc(){return this.tFg}get sUd(){return this.$b.ka("195")}get p1f(){return this.cta}get dXb(){return this.$b.Ha("CurrentCommentId")}get pQd(){return this.$b.Ha("CurrentSlideId")}get BVb(){return this.$b.ka("PptReactTabbedTaskPanesM2IsEnabled")}get Ayk(){return this.$b.ka("PPTSafeLinksIsEnabledForModernComments")}get xs(){return this.$b.ka("CommentTextAnchoringUIEnabled")}get upi(){return this.$b.ka("CommentTextAnchoringReadWriteEnabled")}get YMd(){return this.$b.ka("CommentTextAnchoringCreateNewEnabled")}get jxe(){return!!e.AFrameworkApplication.Aa&&
!!e.AFrameworkApplication.Aa.gb&&e.AFrameworkApplication.Aa.gb.Evb}get dZf(){return this.$b.ka("EnableDeleteAllComments")}get hBa(){return this.$b.ka("SlideResizePerfImprovementEnabled")}get tqb(){return this.$b.ka("EnableCompactingDHCs")}get f1f(){return Td.a("CanvasToCommentFocusFix")}initialize(){this.yo=1===this.Nb.mode;this.JG||(this.qta?Sys.UI.DomElement.addCssClass(this.hzb,Me.lWk):Sys.UI.DomElement.addCssClass(this.hzb,Me.kWk));const W=this.Fa.Bc(se.a.Gp);W.IK=!0;W.wZa=!0;W.xaa(da=>{const Ea=
!Td.a("FixAltF12KeboardingInCommentPane")||!da||da.name!==se.a.rO;this.Xcc(!0,!da||da.name!==se.a.pC&&Ea,!0)});W.uza((da,Ea)=>{da=(Ea.name===se.a.dO||Ea.name===se.a.mea)&&da.name===se.a.Gp;this.Xcc(!1,!1,Ea.name===se.a.Gp||Ea.name===se.a.yg||Ea.name===se.a.pC||Ea.name===se.a.L1||this.BVb&&Ea.name===se.a.rO||da)});const ta=this.Fa.Bc(se.a.pC);ta.xaa((da,Ea)=>{this.Wmk(da,Ea)});ta.uza(()=>{this.Vmk()});this.JG||this.gd.qEb(Zb.a.click,this.hzb,Object(Ca.a)(this,this.$Bb,"onCommentPaneParentDivClick"),
null,W.wZa);this.ub();this.Ox.lGd(Object(Ca.a)(this,this.BGa,"onBeforeSlideSwitched"));this.Ox.GY(Object(Ca.a)(this,this.oSe,"updateCommentsWhenNavigateSlide"));this.jv.NMa(Object(Ca.a)(this,this.Xzf,"activeSlideDOMDisplayed"));this.xq.J4h(Object(Ca.a)(this,this.PZg,"onPageViewZoomChanged"));this.Ur.dDf(Object(Ca.a)(this,this.onShapeSelected,"onShapeSelected"));this.Ur.l5h(Object(Ca.a)(this,this.L_g,"onShapeDeselected"));this.Ox.RSb(Object(Ca.a)(this,this.W_g,"onShapeTextSelected"));this.Ox.hDf(Object(Ca.a)(this,
this.Bdc,"onSlideBackgroundClicked"));this.V7b&&(this.Ox.SSb(Object(Ca.a)(this,this.Bok,"onSlideSizeUpdated")),this.Ox.s5h(Object(Ca.a)(this,this.U_g,"onShapeRotatedOrBoundsUpdated")),this.Ox.o5h(Object(Ca.a)(this,this.U_g,"onShapeRotatedOrBoundsUpdated")));this.F3c.xk(Object(Ca.a)(this,this.P0g,"onTextAnchorPropertyChanged"));this.$Lg.$F(Object(Ca.a)(this,this.UA,"onChildTopologyChanged"));this.F3c.Bza(Object(Ca.a)(this,this.SWg,"onBeforeTextAnchorDisconnect"));this.pbb.xk(Object(Ca.a)(this,this.ydc,
"onShapePropertyChange"));this.pbb.G4h(Object(Ca.a)(this,this.P_g,"onShapeInvalidation"));this.Qc.L2h(Object(Ca.a)(this,this.aYg,"onF6FocusDocument"));this.jXc.DGd(Object(Ca.a)(this,this.i8c,"onSessionExpired"));this.jXc.tB(Object(Ca.a)(this,this.Tcb,"onSessionEnded"));this.Hc.Jc&&this.Hc.Jc.UMd&&(this.BGa(this,null),this.oSe(this,null));this.Nb.vM(Object(Ca.a)(this,this.zWg,"onAppModeSwitched"));this.Nb.N2a(Object(Ca.a)(this,this.aX,"onSetOffline"));this.jv.QSb(Object(Ca.a)(this,this.l8c,"onShapeViewElementAddedOrRemoved"));
this.jv.fDf(Object(Ca.a)(this,this.l8c,"onShapeViewElementAddedOrRemoved"));this.ra.XJ(Object(Ca.a)(this,this.YG,"onSelectionChanged"))}l8c(W,ta){this.Pm&&(W=ta.jx)&&W.shapeNode&&this.XMj(W.shapeNode.slideId)&&this.Pm.Ubd(this.el.uz())}XMj(W){return!!this.ta&&!!this.ta.Mj&&this.ta.Mj.equals(W)}SHe(W){this.cta=this.tFg=W;this.In.SHe(W)}Bok(){this.Pm&&this.Pm.PSe()}U_g(W,ta){if(this.Pm){const da=ta.jx.shapeNode;if(da){if((W=this.el.uz())&&W.length){ta=[];for(const Ea of W)Ea.anchorShape===da.get_shapeId()&&
ta.push(Ea);this.Pm.cvl(ta)}}else Mb.a.J(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}Aul(){try{if(this.BVb&&this.fm){const W=Object(sb.a)(476,this.fm);W&&(W.Foh=!!this.Uh)}}catch(W){Mb.a.J(512496784,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",W)}}k1f(){return this.Uh&&this.Uh.Y6&&this.ta.Ba?!Wb.a.Cea(this.Uh.Y6,this.ta.Ba.Bb):!1}Kqb(){return this.Uh&&this.ta.Ba?!this.Uh.Y6||Wb.a.Cea(this.Uh.Y6,this.ta.Ba.Bb):
!1}Qdh(){if(this.nr&&this.nr.isIntegratedExtensionEnabled()){const W=this.el.uz(),ta=!this.hBa||!this.SEa;W&&0<W.length&&(this.LQ(!0,!0,ta),this.Lcd());this.Kqb()&&this.Pdh(this.Uh)}}tmk(){if(this.nr){this.Aul();this.Qdh();const W=this.wFb;W&&0!==W.status&&this.uJa(1)}}umk(){this.rXb();const W=!this.hBa||!(this.dZ()&&this.SEa);this.LQ(!1,!1,W)}Gmk(W){this.nwb!==W&&(this.nwb=W,this.Hc&&this.Hc.Jc&&this.Hc.Jc.BBh(2,!1,this.nwb))}Llg(){const W=Object.assign(new vh,{paneClosedCallback:Object(Ca.a)(this,
this.tmk,"onPaneClosedCallback"),paneOpenedCallback:Object(Ca.a)(this,this.umk,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(Ca.a)(this,this.Gmk,"onPositionUpdatedScrollHeightCallback")});W.allContainersVisibleCallback=Object(Ca.a)(this,this.qhk,"onAllContainersVisible");this.nr=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(W)}eyj(){this.Ayk&&this.D7j.execute(W=>{const ta=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();ta?
ta.registerSafelinksNavigator(Object(Ca.a)(W,W.Jkd,"tryNavigate")):Mb.a.J(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}Mvj(){this.Llg();this.LQ(!0,!1,!0);this.sge=!0;const W=this.k_b();Cc.a.$bd(W,[Zb.a.contextMenu]);if(this.nr){this.nr.setDhcContainerPanel(W,this.qta);var ta=Object.assign(new kg,{width:parseFloat(W.style.width),height:this.Zhb,x:0,y:0});this.nr.updateViewport(ta);this.nr.setCompactContainers(this.tqb)}this.Lcd();
this.wD.Ojk(this.ta.Mj);ta=this.Fa.Bc(se.a.L1);ta.IK=!0;ta.wZa=!0;ta.xaa(da=>{this.Xcc(!0,!da||da.name!==se.a.pC,!0)});ta.uza((da,Ea)=>{da=(Ea.name===se.a.dO||Ea.name===se.a.mea)&&da.name===se.a.L1;this.Xcc(!1,!1,Ea.name===se.a.Gp||Ea.name===se.a.yg||Ea.name===se.a.pC||Ea.name===se.a.L1||this.BVb&&Ea.name===se.a.rO||da)});this.Fa.cQc(se.a.L1,se.a.gj,W);this.ebh();this.ia.xa(nc.a.wwa,Eb.a.frame,Object(Ca.a)(this,this.wwa,"showHideComments"))}Lcd(){const W=this.el.uz();this.Mdh(W)}ebh(){if(this.nr){const W=
this.k_b();if(W){const ta=this.Fa.Bc(se.a.L1);this.gd.qEb(Zb.a.click,W,Object(Ca.a)(this,this.$Bb,"onCommentPaneParentDivClick"),null,ta.wZa)}}}aAh(){if(this.nr){const W=this.k_b();W&&this.gd.xb(Zb.a.click,W,Object(Ca.a)(this,this.$Bb,"onCommentPaneParentDivClick"))}}k_b(){const W=this.Hc&&this.Hc.Jc?this.Hc.Jc.Oaa:null;return W?W.ya:null}Mdh(W){if(this.Hc.Jc&&this.sge){if(!this.nr)try{this.Llg(),Mb.a.J(512496782,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",
!!this.nr)}catch(Ea){Mb.a.J(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",Ea);return}var ta=Date.now();if((W=this.NVf(W))&&W.length){var da=this.k_b();da.setAttribute(Ad.a.We,"group");if(da){this.Y2=this.z_i(W);Mb.a.J(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",this.Y2.count);if(!this.Y2.count&&!this.DRa){this.LQ(!1,!1,!0);Mb.a.J(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",
Date.now()-ta);return}this.nr.setDhcContainerPanel(da,this.qta);this.nr.attachContainers(this.Y2.toArray());this.LQ(!0,!1,!0)}Mb.a.J(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",Date.now()-ta)}}}NVf(W){if(!W||!W.length)return W;const ta=new n.a;for(const da of W)0!==da.status?this.MVf(da.commentId):ta.add(da);return ta.toArray()}cwl(){this.Cee=!1;if(!this.In.nrh&&!this.In.IM&&this.Hc.Jc){var W=this.el.$5a(this.Hc.Jc.Nd);for(const ta of W)if(0===ta.status){this.selectComment(ta,
null,!0,!0,0,0,!1);break}}}Vcj(){if(!this.Hc||!this.Hc.Jc||!this.Hc.Jc.Nd)return this.Zhb;var W=this.Hc.Jc.Nd;if(isNaN(W.Ek))return this.Zhb;W=W.Ek;return 0>W?this.Zhb:W}j6f(W){var ta=this.In.c7(W);W=W.pos.Y;ta&&(W+=ta.vC.y,ta.mh&&(ta=this.Ea.Pr(ta),W+=ta&&ta.vC?ta.vC.y:0));return this.kAa(0,W).y}sSe(){if(this.nr){const W=this.Vcj();W!==this.jKg&&(this.jKg=W,this.nr.setSlideHeight(W))}}Pdh(W){if(W&&0===W.NNa){var ta=0;if(this.tqb)ta=-this.Zhb,this.sSe();else{const da=this.ra.jq();da&&(ta=this.kAa(0,
da.vC.y).y)}ta=Object.assign(new jf,{contentId:W.DB.draftId,containerContentType:0,anchorTop:ta,anchorLeft:0});this.LQ(!0,!0,!0);this.nr.setDhcContainerPanel(this.k_b(),this.qta);this.nr.updateDrafting(ta,!0);this.nr.selectContainer(W.DB.draftId,!0)}}PRk(W){if(this.Y2){var ta=0,da="";if(this.tqb){var Ea=this.ra.jq();Ea&&(ta=this.kAa(0,Ea.vC.y).y);if(Ea=this.el.uz())for(const $a of Ea)Bc.a.Va($a.commentId)||this.j6f($a)!==ta||(da=$a.commentId)}ta=Object.assign(new jf,{contentId:W,containerContentType:0,
anchorTop:ta,anchorLeft:0});this.tqb?this.nr.updateDraftingAndPosition(ta,!1,da):this.nr.updateDrafting(ta,!1);this.nr.selectContainer(W,!0)}}MVf(W){if(this.nr&&this.Y2){for(let ta of this.Y2)yh.$Rg(ta,W)&&(this.nr.detachContainers([ta]),this.Y2.remove(ta));this.dZ()||this.DRa||this.LQ(!1,!1,!0)}}a1k(){this.Cee=!0}LHc(){this.BVb&&this.fm&&this.fm.isVisible&&this.fm.PYk()}xOi(){var W=this.ta.presentation;if(!W)return!1;W=W.slides;if(!W)return!1;for(const ta of W)if(W=Object(sb.a)(jb.a,ta))for(const da of this.el.hra(W.PE()))if(id.RM(da))return!0;
return!1}N0d(W){var ta=this.ta.presentation;if(!ta)return null;ta=ta.slides;if(!ta)return null;for(const da of ta)if(ta=Object(sb.a)(jb.a,da),Wb.a.Cea(ta.Bb,W))return ta;return null}pOi(){return this.YMd||this.upi&&this.xOi()}leg(){const W=this.ra.Oa.kb,ta=this.ra.Oa.a5;if(!W||!ta)return null;var da=Object(sb.a)(5,W.Ua.node),Ea=Object(sb.a)(5,ta.Ua.node);if(!da||!Ea)return null;da=Object(sb.a)(Qc.TableCellNode,da.pK());Ea=Object(sb.a)(Qc.TableCellNode,Ea.pK());return da&&Ea?da.rowIndex>Ea.rowIndex?
W:ta:null}bfj(){if(!this.pOi()||!this.ra.D7())return null;Mb.a.J(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");var W=0,ta=0;if(this.ra.Oa.nl){var da=this.leg();if(!da)return Mb.a.J(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var Ea=da}else Ea=this.ra.Oa.kb;if(!Ea)return Mb.a.J(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),
null;const $a=({FIa:W,ZAa:ta}=id.afj(this.ra.lZ(),Ea,W,ta)).returnValue;if(!$a||0>W||0>ta||0>=ta-W)return Mb.a.J(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",!$a,ta,W),null;da=new wb.a;da.StartPos=W;da.EndPos=ta;if(this.ra.gSa()&&$a.get_smartArtModelId()){Mb.a.J(512496773,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");da.AnchoringShape=new Bj.a;
W=L.a.Yf($a.get_smartArtModelId()).toString();if(!W||!L.a.isValid(W))return Mb.a.J(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!W),null;da.AnchoringShape.SmartArtNodeId=W;this.wD.NXj()}else if($a.Sr()){Mb.a.J(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");ta=Object(sb.a)(Qc.TableCellNode,$a.pK());if(!ta)return Mb.a.J(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),
null;W=ta.rowId.toString();ta=ta.cellId.toString();if(!(W&&ta&&L.a.isValid(W)&&L.a.isValid(ta)))return Mb.a.J(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",!W,!ta),null;da.AnchoringShape=new Bj.a;da.AnchoringShape.TableCell=new qb;da.AnchoringShape.TableCell.RowId=W;da.AnchoringShape.TableCell.ColId=ta;this.wD.OXj()}W=Object(sb.a)(5,Ea.Ua.node);Ea=Object(sb.a)(5,Ea.Te.node);W!==Ea&&this.wD.QXj();Mb.a.J(512496768,805,
50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return da}aFi(W){if(this.nr&&W){for(const ta of this.Y2.toArray()){let da=!1;for(const Ea of W)if(yh.$Rg(ta,Ea.commentId)){da=!0;break}da||(this.nr.detachContainers([ta]),this.Y2.remove(ta),Mb.a.J(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",ta.contentId))}this.dZ()||this.DRa||this.LQ(!1,!1,!0)}}rXb(){if(this.nr){for(const W of this.Y2.toArray())this.nr.detachContainers([W]);this.Y2.clear()}this.dZ()||
this.DRa||(this.hBa&&!this.SEa?this.LQ(!1,!1,!1):this.LQ(!1,!1,!0))}IMe(W){if(!W)return null;W.sort((ta,da)=>{var Ea=this.In.c7(ta);Ea=Ea?Ea.vC:new rc.a(0,0);var $a=this.In.c7(da);$a=$a?$a.vC:new rc.a(0,0);Ea.y+=ta.pos.Y;$a.y+=da.pos.Y;Ea.x+=ta.pos.X;$a.x+=da.pos.X;let fb=Ea.y-$a.y;fb||(fb=Ea.x-$a.x)||(fb=+ta.dt-+da.dt);return fb});return W}z_i(W){const ta=new n.a;if(W){this.tqb&&this.sSe();for(const da of W)Bc.a.Va(da.commentId)||(W=this.j6f(da),W=Object.assign(new jf,{contentId:da.commentId,containerContentType:0,
anchorTop:W,anchorLeft:0}),ta.add(W))}return ta}aX(W){this.ZYg(W)}Jbh(W,ta){for(let da=0;da<W.Ra.length;da++){const Ea=W.Ra.ga(da);if(!Ea.tg)continue;const $a=[];for(let fb=0;fb<Ea.tg.length;fb++){const qc=Ea.tg.ga(fb);qc.KH.equals(ta)&&$a.push(qc)}if(!(1>$a.length))try{W.Vma=!0;for(const fb of $a)Ea.tg.remove(fb)}catch(fb){Mb.a.J(512496738,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",fb.toString())}finally{W.Vma=!1}}}qAf(W,ta,da){W.tg||
(W.tg=new Kh.a(W));const Ea=W.tg.xe.paragraph;ta=new ti.a(W.tg.xe,null,ta,da);W.tg.add(ta);Ea.yu()}HEc(W){return Wc.a.Yf("{"+W+"}{1}")}zSb(W,ta,da,Ea){let $a=null;for(let fb=0;fb<W.Ra.length;fb++){let qc=W.Ra.ga(fb);if(qc.cp>=da){try{W.Vma=!0;if(qc.cp>da||!qc.formatting)this.iW.Gea(W,fb,da,$a),qc=W.Ra.ga(fb);this.qAf(qc,ta,Ea)}catch(Hc){Mb.a.J(512496737,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Hc.toString())}finally{W.Vma=!1}return}qc.formatting&&
($a=qc.formatting)}if(Rc.ParagraphReader.textLength(W)>=da)try{W.Vma=!0;this.iW.Gea(W,W.Ra.length,da,$a);const fb=W.Ra.ga(W.Ra.length-1);this.qAf(fb,ta,Ea)}catch(fb){Mb.a.J(512496736,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",fb.toString())}finally{W.Vma=!1}}XXb(){if(this.xs){var W=this.el.uz();if(W){var ta=Date.now(),da=!1,Ea=new Ma.a;for(var $a of W){var fb=id.H0b($a,this.In.c7($a));Ea.$($a.commentId,fb)}for(var qc of W)if(qc.textAnchoringInfo&&
($a=this.In.c7(qc))&&(fb=Ea.ga(qc.commentId),!fb||!fb.isValid||fb.Cxg(qc.textAnchoringInfo)))for(var Hc of $a.jD())this.Jbh(Object(sb.a)(hb.AParagraphNode,Hc),this.HEc(qc.commentId));for(const kd of W)if((W=Ea.ga(kd.commentId))&&W.isValid&&W.Cxg(kd.textAnchoringInfo)&&(this.fm.isVisible||0===kd.status)){da=this.HEc(kd.commentId);this.zSb(W.ZT,da,W.startPos,!0);if(W.P4b)for(qc=1;qc<W.paragraphs.length;qc++){if(Hc=W.paragraphs[qc])this.zSb(Hc,da,0,!0),W.X1.equals(Hc)?this.zSb(W.X1,da,W.endPos,!1):this.zSb(Hc,
da,Rc.ParagraphReader.textLength(Hc),!1)}else this.zSb(W.X1,da,W.endPos,!1);W.BAj();da=!0}da&&Mb.a.J(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",Date.now()-ta)}}}P0g(W,ta){W=this.el.gra(ta.node);if(this.xs&&W&&(ta.property===Ge.a.Slc||ta.property===Ge.a.Rlc||ta.property===Ge.a.rjd||ta.property===Ge.a.sjd)){const da=id.RM(W);da&&this.XXb();!W.textAnchoringInfo||da||ta.property!==Ge.a.sjd&&ta.property!==Ge.a.rjd||this.wD.PXj(W,this.HEc(W.commentId),this.In.c7(W),
this.Hc.Jc.Ma)}}zZf(){this.Uh&&this.Y8&&(this.QZ.hHe(this.Y8.length,this.rab,this.yo,this.Dee.OUc),this.QZ.mHe(Array.clone(this.Y8),Array.clone(this.sbb)),this.lMf(2))}ANj(W,ta){ta=this.Mb.Kc(ta);for(var da=ta.zb(2);da;da=ta.uf(2))if((da=Object(sb.a)(122,da))&&Wb.a.Cea(da.Bb,W))return!0;return!1}UA(W,ta){ta&&(W=Object(sb.a)(404,ta.node),ta=ta.PY,W&&2===ta&&((ta=this.KW.yf)&&ta.slides&&0>=ta.slides.length&&this.fm.isVisible&&this.vhc(!1,!1),this.Uh&&(ta=this.Uh.Y6,!ta&&this.ta.Ba&&(ta=this.ta.Ba.Bb),
this.ANj(ta,W)||this.zZf())))}SWg(W,ta){W=this.el.gra(ta.node);if(this.xs&&W&&id.RM(W)&&(ta=this.In.c7(W)))for(const da of ta.jD())this.Jbh(Object(sb.a)(hb.AParagraphNode,da),this.HEc(W.commentId))}P_g(W,ta){W=Object(sb.a)(4,ta.node);this.xs&&W&&0<W.jD().length&&(ta.fqg&192||ta.fqg&4)&&this.XXb()}ydc(W,ta){W=ta.property;ta=ta.node;if(W===Dg.a.My||W===Dg.a.Ny)if(W=this.el.uz()){for(const da of W)da.pos.Y=ta.vC.y,da.pos.X=ta.vC.x;this.Lcd()}}i8c(){Mb.a.J(512496734,805,this.f7a?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",
this.f7a)}Tcb(W,ta){Mb.a.J(512496733,805,this.f7a?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",fj.a[ta.fJ],this.f7a)}dispose(){this.Pm&&(this.Pm.dispose(),this.Pm=null);this.Myb&&(this.Myb.dispose(),this.Myb=null);this.Ox.Nch(Object(Ca.a)(this,this.BGa,"onBeforeSlideSwitched"));this.Ox.Nva(Object(Ca.a)(this,this.oSe,"updateCommentsWhenNavigateSlide"));this.Ox.DEb(Object(Ca.a)(this,this.Xzf,"activeSlideDOMDisplayed"));this.xq.hQk(Object(Ca.a)(this,this.PZg,
"onPageViewZoomChanged"));this.Ur.xdh(Object(Ca.a)(this,this.onShapeSelected,"onShapeSelected"));this.Ur.uQk(Object(Ca.a)(this,this.L_g,"onShapeDeselected"));this.Ox.Fcd(Object(Ca.a)(this,this.W_g,"onShapeTextSelected"));this.Ox.Adh(Object(Ca.a)(this,this.Bdc,"onSlideBackgroundClicked"));this.pbb.Tm(Object(Ca.a)(this,this.ydc,"onShapePropertyChange"));this.pbb.eQk(Object(Ca.a)(this,this.P_g,"onShapeInvalidation"));this.Qc.TOk(Object(Ca.a)(this,this.aYg,"onF6FocusDocument"));this.F3c.Tm(Object(Ca.a)(this,
this.P0g,"onTextAnchorPropertyChanged"));this.$Lg.iO(Object(Ca.a)(this,this.UA,"onChildTopologyChanged"));this.F3c.xHa(Object(Ca.a)(this,this.SWg,"onBeforeTextAnchorDisconnect"));this.Nb.rX(Object(Ca.a)(this,this.zWg,"onAppModeSwitched"));this.jXc.udh(Object(Ca.a)(this,this.i8c,"onSessionExpired"));this.jXc.gea(Object(Ca.a)(this,this.Tcb,"onSessionEnded"));this.Nb.FEb(Object(Ca.a)(this,this.aX,"onSetOffline"));this.JG||this.gd.xb(Zb.a.click,this.hzb,Object(Ca.a)(this,this.$Bb,"onCommentPaneParentDivClick"));
this.aAh();this.Sca=this.hzb=null;this.jv.Ecd(Object(Ca.a)(this,this.l8c,"onShapeViewElementAddedOrRemoved"));this.jv.zQk(Object(Ca.a)(this,this.l8c,"onShapeViewElementAddedOrRemoved"));this.ra.zHa(Object(Ca.a)(this,this.YG,"onSelectionChanged"))}get isReadOnly(){return this.yo}get DRa(){return!!this.Uh}get hasFocus(){return this.Hge}hvi(){const W=new Wi.a;var ta=new Bd(nc.a.Jtb,jc.a.application);ta.preCallback=Object(Ca.a)(this,this.OCc,"claimFocus");ta.postCallback=Object(Ca.a)(this,this.GWf,"disableOnEmptyDeckAndReadOnly");
W.$(0,ta);ta=new Bd(nc.a.deleteComment,jc.a.application);ta.preCallback=Object(Ca.a)(this,this.OCc,"claimFocus");ta.postCallback=Object(Ca.a)(this,this.GWf,"disableOnEmptyDeckAndReadOnly");W.$(3,ta);ta=new Bd(nc.a.t6g,jc.a.application);ta.preCallback=Object(Ca.a)(this,this.OCc,"claimFocus");ta.postCallback=Object(Ca.a)(this,this.X4g,"postCommentAction");W.$(2,ta);ta=new Bd(nc.a.AUg,jc.a.application);ta.preCallback=Object(Ca.a)(this,this.OCc,"claimFocus");ta.postCallback=Object(Ca.a)(this,this.X4g,
"postCommentAction");W.$(1,ta);ta=new Bd(Ya.a.umc,jc.a.application);ta.preCallback=Object(Ca.a)(this,this.Gbl,"showHideActionPreCallback");ta.postCallback=Object(Ca.a)(this,this.Fbl,"showHideActionPostCallback");ta.delayActionsUntilRegistration=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Td.a("DelayCommentsShowHideAction");W.$(6,ta);return W}Gbl(W,ta,da,Ea,$a){if(1===da)return!this.ta.Ba||this.CRa?8:2;Mb.a.J(36983504,805,50,"New Comment Pane opened.");this.fm.ycb(!!$a&&
$a.AutoShowHide);return 2}Fbl(W,ta,da,Ea,$a,fb){if(1===Ea)return W&&this.wD.sik(this.ta.Mj),W?32:8;this.EDf(this.fm.isVisible,!!fb&&fb.AutoShowHide);return W?32:8}OCc(W,ta,da,Ea,$a){if(1===da&&this.ra.vRa())return 8;1!==da&&((this.Y7b=!!$a&&$a.ShouldCanvasTakeFocus)||this.Aqa(),this.ra.ly(),this.Zge=!0);return 2}X4g(W,ta,da,Ea){if(1===Ea&&(this.ZTa||!this.Y8))return 8;this.Y7b=!1;return W?32:8}GWf(W,ta,da,Ea){return(1!==Ea||!this.yo&&this.Y8)&&this.Hc.Jc?W?32:8:8}kAa(W,ta){return new rc.a(this.W0c.Ge(W,
0),this.W0c.Ge(ta,1))}IQf(W,ta){return new rc.a(this.W0c.Ef(W,0),this.W0c.Ef(ta,1))}Irb(W){W=this.el.NBa(W);return this.el.gra(W)}pea(W,ta,da){!this.k1f()||W!==this.Uh.DB.draftId&&W!==this.Uh.commentId?this.Kqb()&&W===this.Uh.DB.draftId?(this.QZ.selectComment(W),this.nr&&this.nr.selectContainer(W,!0),this.f1f&&!this.hasFocus&&1!==ta&&this.Aqa()):this.selectComment(this.Irb(W),null,!0,!0,0,ta,da):(W=this.N0d(this.Uh.Y6),W)?1!==ta&&(this.Uh.vTc=!0,this.Ie.wda(W.De)):(Mb.a.J(512496732,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),
this.endCommentSession(this.Uh.DB.draftId,0))}selectComment(W,ta,da,Ea,$a,fb,qc){this.ra.ly();ta=this.wFb?this.wFb.commentId:null;qc||this.LHc();0!==fb?W?this.QZ.selectComment(W.commentId):this.QZ.selectComment(null):0===fb&&(fb=this.In.c7(W))&&fb.LR&&this.In.Led(ui[fb.LR]);this.Pm&&this.Pm.selectComment(W,!0);!this.fm.isVisible&&this.nr&&W&&W!==this.XSa&&(fb=this.el.h0d(W.commentId))&&(fb=this.el.gra(fb),this.nr.selectContainer(fb.commentId,!this.Y7b&&!qc&&!this.Zge),this.Zge=!1,this.Hc&&this.Hc.Jc&&
this.Hc.Jc.Eld(5,!1,this.nwb));qc||this.Y7b||this.Aqa();!this.In||!this.fm.isVisible&&this.fm.isVisible||(this.In.LGe(W,ta,!0,!1,qc),id.RM(W)&&!qc&&this.XXb());this.Nb.updateCommandUI()}get wFb(){return this.Pm&&this.Pm.zFb?this.Pm.zFb.comment:null}TYk(){if(!this.ZTa){const W=Qd.a.hm("SelectNextCommentCrossSlide",1),ta=!this.fm.isVisible;this.ZTa=!0;this.DYc.hVd((da,Ea)=>{this.rYg(da,Ea,1,W)},W,ta)}}WYk(){if(!this.ZTa){const W=Qd.a.hm("SelectPreviousCommentCrossSlide",1),ta=!this.fm.isVisible;this.ZTa=
!0;this.DYc.oVd((da,Ea)=>{this.rYg(da,Ea,0,W)},W,ta)}}rYg(W,ta,da,Ea){Ea.Km("FindCommentEndTime",new Date);this.yb.Gb(new zf.a(2,1,100,()=>{this.ZTa&&(this.ZTa=!1,this.F9k(W,ta,da)?this.pea(this.Uh.commentId||this.Uh.DB.draftId,0,!1):ta&&W&&this.Hc.Jc.Nd?W.Bb.equals(this.Hc.Jc.Nd.Bb)?(this.selectComment(ta,null,!0,!0,2,1,!1),Ea.Wa("CircularSelectCommentInSingleSlide",Ni[da]),Ea.finish()):(this.bEa=Object.assign(new Yh,{slide:W,comment:ta,direction:da,KGe:Ea}),this.Ie.wda(W.De)):(this.Nb.updateCommandUI(),
Ea.Wa("NoCommentFound",Ni[da]),Ea.finish()))},90,"47"))}y$f(){let W=-1;if(!this.Uh)return W;if(this.Uh.Y6){const ta=this.N0d(this.Uh.Y6);ta&&(W=ta.De)}else this.Hc.Jc&&this.Hc.Jc.Nd&&(W=this.Hc.Jc.Nd.De);return W}F9k(W,ta,da){if(!this.Uh||this.Uh.DB.sessionType!==rb.create)return!1;const Ea=this.y$f();if(0>Ea)return!1;if(!ta||!W)return!0;ta=this.Hc.Jc.Nd.De;if(1===da)return da=Ea<=ta&&ta<W.De,ta=W.De<=ta&&ta<Ea,Ea<=W.De&&!da||ta;da=Ea>=ta&&ta>W.De;ta=W.De>=ta&&ta>Ea;return Ea>W.De&&!da||ta}uJa(W){0!==
W&&this.QZ.selectComment(null);this.Pm&&this.Pm.selectComment(null,!1);if(this.nr&&(this.nr.deselectContainer(),this.Hc&&this.Hc.Jc)){let ta=5;const da=this.ra.jq();da&&da.Qf&&(ta=2);this.Hc.Jc.Eld(ta,!1,this.nwb)}this.In&&0!==W&&(this.In.hGc(),this.In.KFc());this.Nb.updateCommandUI()}RYh(W){this.ymb(this.Irb(W),0)}ymb(W,ta){this.XSa!==W&&(this.In&&(W?this.In.QYh(W):this.In.KFc()),this.XSa=W,0!==ta&&(this.XSa?this.QZ.highlightComment(this.XSa.commentId):this.QZ.highlightComment(null)),this.Pm&&this.Pm.ymb(this.XSa,
!0))}RYk(){if(this.dXb){var W=this.Irb(this.dXb),ta=this.Hc.Jc.Nd.sid,da=ta===parseInt(this.pQd);W?(1!==W.status&&2!==W.status||this.Xgd(),this.selectComment(W,null,!0,!0,0,1,!1),this.wD.Qik(this.ta.Mj),Mb.a.J(512496730,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",this.dXb,this.pQd)):(da&&this.Kd.Rr(Object.assign(new Na.a,{Code:389,Source:4}),this.Xa.podSessionId),Mb.a.J(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",
this.dXb,this.pQd,parseInt(ta)))}}get manager(){return this.el}get UR(){return"per"}get ZRg(){return this.Sca}set ZRg(W){this.Sca=W;this.Pm&&(this.Pm.parentElement=W)}get zUg(){return this.M9b}set zUg(W){this.M9b=W}Ubd(W){this.thc(W,void 0,!0)}ZW(W,ta){ta=!Td.a("FixAltF12KeboardingInCommentPane")||ta;this.Xcc(W,ta,!0)}PCe(){!this.JG&&this.fm&&(this.hzb.style.display=this.fm.isVisible?"flex":"none");this.Pm&&(this.Pm.setVisibility(this.o$a),this.Pm.Yph(this.q$a),this.In.Vpb(this.XSa))}vhc(W,ta){this.Ryh(W,
ta);this.PCe();this.EDf(W,ta)}PZg(){this.Pm&&!this.V7b&&this.Pm.PSe();this.Lcd();this.tqb&&this.sSe()}a6g(){this.ZTa=!1;this.SZf();this.Pm&&this.Pm.kDe();this.Rzb=!1;this.aAh()}SZf(){this.el.lAh()}BGa(){this.SEa=this.dZ()||this.Kqb();this.In&&this.SEa&&(this.In.hGc(),this.In.KFc());this.sUd&&(this.a6g(),this.kHf())}g$k(){return this.Uh&&this.Uh.Y6&&this.ta.Ba?this.Uh.vTc&&Wb.a.Cea(this.Uh.Y6,this.ta.Ba.Bb):!1}oSe(){this.sUd||this.a6g();this.ta.Ba||this.BGa(this,null);this.SZf();this.Hc.Jc&&(this.ZRg=
this.Hc.Jc.UMd);const W=this.Hc&&this.Hc.Jc?this.el.$5a(this.Hc.Jc.Nd):this.el.uz(),ta=this.L4i(W),da=this.dZ()||this.Kqb();this.x1c||da||(this.tm.y9(this.tm.iLd,this.tm.XMd),this.x1c=!0);this.fm.isVisible||(da?(this.rXb(),this.Qdh()):this.dZ()?(this.rXb(),this.LQ(!0,!1,!0)):this.hBa&&!this.SEa?this.LQ(!1,!1,!1):this.LQ(!1,!1,!0),this.ebh());this.thc(W,e.AFrameworkApplication.isRtl,!1,ta);this.g$k()?(this.pea(this.Uh.commentId||this.Uh.DB.draftId,0,!1),this.Uh.vTc=!1):-1<ta&&this.pea(W[ta].commentId,
0,!1);this.bEa&&(this.bEa.KGe.finish(),this.bEa=null);this.pZa(!1);-1!==ta&&this.Pm&&(this.Pm.ymb(null,!1),this.Pm.selectComment(W[ta],!1));this.sUd||this.kHf()}Xzf(){if(this.epe){try{this.O9a.Lcl(this.CNg,this.ta,this.Ie)}catch(W){Mb.a.J(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",W)}this.epe=!1}}pZa(W){const ta=this.y$f();this.Dee.pZa(W,ta)}Ttl(W){this.Uh&&!this.Uh.Y6&&(this.Uh.Y6=W)}onShapeSelected(W,ta){this.sIc&&(W=ta.shapeNode,
this.WJe(W),this.xs&&W&&0<W.jD().length&&this.XXb())}W_g(W,ta){this.sIc&&(this.WJe(ta.jx.shapeNode),this.xs&&this.XXb())}YG(W,ta){this.f1f&&this.f7a&&this.uJa(1);if(this.xs&&ta&&ta.Ok&&this.ra.D7()&&(W=this.el.uz())){ta=!1;for(var da of W)if(id.RM(da)){ta=!0;break}ta&&((da=this.ra.lZ())?this.WJe(da):Mb.a.J(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}WJe(W){W.get_shapeId()&&(this.In&&W!==this.In.IM&&this.uJa(1),this.Jih(W.get_shapeId(),
!0))}Jih(W,ta){var da=this.el.uz();if(da){var Ea=null,$a=null,fb=0,qc=null;for(const Hc of da)if((this.fm.isVisible||0===Hc.status)&&Hc.anchorShape===W)if(this.xs&&this.ra.D7()&&id.RM(Hc)){da=this.ra.Oa.kb.Ua;const kd=this.ra.Oa.kb.Te,Ac=id.H0b(Hc,this.In.c7(Hc));Ac&&Ac.isValid?(this.wFb&&this.wFb.commentId===Hc.commentId||Ac.ujd===Hc.textAnchoringInfo.TextBodyLength)&&Ac.bEj(da,kd)&&($a?(da=Ac.D$g,da<fb&&($a=Hc,fb=da)):($a=Hc,fb=Ac.D$g)):(Ea=Hc,Mb.a.J(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else if(!$a&&
!qc)if(this.xs)id.RM(Hc)||(qc=Hc);else{qc=Hc;break}$a?this.pea($a.commentId,1,ta):qc?this.pea(qc.commentId,1,ta):this.xs&&this.ra.D7()&&!Ea?this.In&&this.uJa(1):Ea&&this.pea(Ea.commentId,1,ta)}}L_g(){if(this.sIc){var W=this.aYd();this.In.Led(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,W.toString()));this.uJa(1)}}aYd(){const W=this.el.uz();let ta=[];W&&(ta=Ld.e(W,da=>0===da.status));return ta.length}Bdc(){this.sIc&&this.uJa(1)}aYg(W,ta){ta.EBb===se.a.yg&&this.In.Led(ResourceStrings.l_SlidePanel+
", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.aYd().toString()));ta.Ifc===se.a.yg&&this.uJa(1)}L4i(W){let ta=-1;if(this.bEa&&this.Hc.Jc)if(this.bEa.slide!==this.Hc.Jc.Nd)Mb.a.J(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");else if(W&&0<W.length){if(this.fm.isVisible)ta=1===this.bEa.direction?0:W.length-1;else if(1===this.bEa.direction)for(var da=0;da<W.length;da++){if(0===W[da].status){ta=da;break}}else for(da=
W.length-1;0<=da;da--)if(0===W[da].status){ta=da;break}0<=ta&&ta<W.length&&(W=W[ta],da=this.bEa.comment,da.dt===W.dt&&da.commentId===W.commentId&&da.authorName===W.authorName||Mb.a.J(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return ta}oXg(){this.el.K3i()?this.Uh&&(0===this.Uh.NNa||1===this.Uh.NNa?(this.p1f&&this.thc(this.el.uz(),e.AFrameworkApplication.isRtl,!0),0===this.Uh.NNa&&(this.u2c=!0)):this.Uh&&2===this.Uh.NNa&&this.p1f&&this.thc(this.el.uz(),
e.AFrameworkApplication.isRtl,!0)):this.thc(this.el.uz(),e.AFrameworkApplication.isRtl,!0)}get Fed(){const W=this.ra.jq();if(W){const ta=W.vC;this.Roe=new rc.a(e.AFrameworkApplication.isRtl?ta.x:ta.x+W.Ex,ta.y)}else this.Roe=null;return this.Roe}get hZk(){if(!this.ra.D7())return null;var W=Object(sb.a)(5,this.ra.Oa.kb.Te.node);if(!W)return null;const ta=Object(sb.a)(477,W.oc(this.Hc.Jc.Ma));if(!ta)return null;var da=null,Ea=ta.htmlElement.getElementsByClassName("Selected");if(0<Ea.length)da=Ea[Ea.length-
1];else if(this.ra.Oa.nl){if(Ea=this.leg())if(Ea=Object(sb.a)(5,Ea.Te.node))if(Ea!==W){if(W=Object(sb.a)(477,Ea.oc(this.Hc.Jc.Ma)))da=W.htmlElement}else da=ta.htmlElement}else return null;W=this.ra.jq();if(!W||!da)return null;W=Object(sb.a)(124,W.oc(this.Hc.Jc.Ma));if(!W)return null;da=Xh.a.Yh(da);W=Xh.a.Yh(W.zq);if(0>=da.width+da.height&&0>=W.width+W.height)return null;W=rc.a.bU(new rc.a(da.x,da.y),new rc.a(W.x,W.y));return this.IQf(W.x+da.width-5,W.y+10)}get anchorNode(){const W=this.ra.jq();return this.sCg=
W?W:this.Hc.Jc.Nd}Ryh(W,ta){this.fm&&(ta||this.nkh(),this.Wbb.Hmh(W?3:1),!this.CRa&&W&&Td.a("CommentShimmerBugFix")&&this.nW&&this.nW.isVisible&&(this.nW.Vjg(),this.Nb.ycb(1)),this.LQ(!W,!1,!0),this.fm.Yo(!this.CRa&&W,ta),this.fm.isVisible&&(this.o$a=!0))}LQ(W,ta,da){const Ea=this.dZ();da&&(!Ea&&!this.SEa||Ea&&this.SEa)&&Mb.a.J(512496724,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");!this.dZ()&&!this.DRa&&
W&&!ta||this.fm.isVisible&&W&&!ta||this.dZ()&&this.nW&&this.nW.isVisible&&!W&&!ta||!this.Hc.Jc||!(ta=this.Hc.Jc.Oaa)||(ta.setVisibility(W),W=new xh.a(W),this.Ox.w9g(W),da?this.Nb.ycb(1):Mb.a.J(512496723,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),this.Hc.Jc.Eld(5,!1,this.nwb))}Qql(W){this.fm&&(this.o$a=!this.CRa&&W,this.o$a||(this.Wbb.Hmh(1),this.fm.Yo(!1,!1),this.Fa.Gj(se.a.Gp,!1)))}T8i(){const W=new Eh;this.jxe&&
(W.focusCallback=Object(Ca.a)(this,this.xJc,"focusFirstPaneElement"));return Object.assign(new $f.a,{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.jxe?300:320),contentProps:W,location:2,onOpen:ta=>{Cc.a.$bd(ta,[Zb.a.contextMenu]);const da=this.Fa.Bc(se.a.Gp);this.gd.qEb(Zb.a.click,ta,Object(Ca.a)(this,this.$Bb,"onCommentPaneParentDivClick"),null,da.wZa)},onClose:ta=>{this.vhc(!1,!1);this.gd.xb(Zb.a.click,ta,Object(Ca.a)(this,this.$Bb,"onCommentPaneParentDivClick"))},isModernPane:!0})}kHf(){if(!this.RFg){var W=
this.el.uz();W=!!W&&0<W.length;Mb.a.J(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",W);W?this.dZ()&&this.LQ(!0,!1,!0):(this.rXb(),this.hBa&&!this.SEa?this.LQ(!1,!1,!1):this.LQ(!1,!1,!0))}}Xgd(){this.fm.isVisible||this.ia.processAction(nc.a.wwa,2);this.LHc()}Trj(){this.fm.isVisible&&this.ia.processAction(nc.a.wwa,2)}Yj(W){return this.fe.Yj(W)}get CRa(){const W=this.KW.yf;return W?W.i7a:!0}rBf(){this.H1c||(this.H1c=new zf.a(0,1,0,Object(Ca.a)(this,this.HJk,"refreshCommentsTask"),
90,"48"),this.yb.Gb(this.H1c))}zWg(W){this.ZYg(1===W.mode)}ZYg(W){this.yo=W;this.rBf();Td.a("PreventCommentPaneCloseOnReadOnlyChanged")?this.zZf():this.fm.isVisible&&this.yo&&this.Trj()}o_d(){return this.Y8?this.Y8:[]}gbg(){return this.sbb?this.sbb:[]}get AVg(){return this.rab}get wFc(){return this.Uh}u$f(W){const ta=this.Hc&&this.Hc.Jc?this.el.$5a(this.Hc.Jc.Nd):this.IMe(this.el.uz());if(!ta||!ta.length)return 0;let da=null;this.Fed&&(da=this.kAa(this.Fed.x,this.Fed.y));let Ea=-1,$a=0;for(let kd=
0;kd<ta.length;kd++){var fb=this.In.c7(ta[kd]);if(!da&&fb)break;if(fb&&da){var qc=fb.vC.x,Hc=fb.vC.y;qc+=ta[kd].pos.X;Hc+=ta[kd].pos.Y;fb.mh&&(fb=this.Ea.Pr(fb),qc+=fb&&fb.vC?fb.vC.x:0,Hc+=fb&&fb.vC?fb.vC.y:0);Hc=this.kAa(qc,Hc);qc=Hc.y;Hc=Hc.x;if(da.y<qc)break;if(da.y>qc||da.y===qc&&da.x>=Hc)Ea=kd,ta[kd].Children&&W&&($a+=ta[kd].Children.length)}else fb||(Ea=kd,ta[kd].Children&&W&&($a+=ta[kd].Children.length))}return Ea+$a+1}Cvj(W){if(!this.sge)throw Mb.a.J(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),
E.a.du(-2130915320);if(this.Uh)return Mb.a.J(512496720,805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),E.a.du(-2130915319);if(null===W)throw Error.argumentNull("session");if(!W.commentId.length&&0!==W.NNa)return E.a.du(-2130915327);this.Uh=W;this.pZa(!0);0===W.NNa&&(this.uJa(0),this.fm.isVisible||this.Pdh(W));if(this.fm.isVisible||!this.fm.isVisible)this.Aqa(),this.iKi();let ta="";W.DB&&(ta=W.DB.draftId);Mb.a.J(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",
ta);return null}endCommentSession(W,ta){if(this.Uh){if(this.Uh.DB&&this.Uh.DB.draftId!==W)throw Mb.a.J(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",W,this.Uh.DB.draftId),E.a.du(-2130915327);this.PDg=ta}9!==ta||this.fm.isVisible||this.Fa.qC(se.a.yg);this.Uh=null;this.Nb.updateCommandUI();if(this.nr&&!this.fm.isVisible){const da=[Object.assign(new jf,{contentId:W,containerContentType:0,anchorTop:0,anchorLeft:0})];this.nr.detachContainers(da);
this.dZ()||this.LQ(!1,!1,!0)}this.o2c.nwg&&this.HWf();Mb.a.J(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",W,ta)}get spi(){return this.PDg}K4(){this.Aqa()}VVf(W){if(this.Ga.ka("CommentCopyPasteEnabled")&&!this.O9a.JNj)for(const ta of W)for(const da of this.el.hra(ta.PE()))if(1===da.status){this.CNg=new vi(W,this.el);this.epe=!0;return}}ub(){this.xs&&1!==this.b8b.iha&&(this.ia.xa(nc.a.chd,jc.a.application,Object(Ca.a)(this,this.wwa,"showHideComments")),
this.ia.pa(nc.a.C8g,jc.a.application,Object(Ca.a)(this,this.jHa,"queryShowHideComments"),97));this.dZf&&(this.ia.xa(nc.a.x4a,jc.a.application,Object(Ca.a)(this,this.jXb,"deleteAllComments")),this.ia.xa(nc.a.kXb,jc.a.application,Object(Ca.a)(this,this.jXb,"deleteAllComments")),this.ia.xa(nc.a.lXb,jc.a.application,Object(Ca.a)(this,this.jXb,"deleteAllComments")));this.ia.xa(nc.a.ehd,jc.a.application,Object(Ca.a)(this,this.wwa,"showHideComments"));this.ia.pa(Ya.a.m9g,Eb.a.frame,Object(Ca.a)(this,this.jHa,
"queryShowHideComments"),97);this.ia.pa(nc.a.jHa,jc.a.application,Object(Ca.a)(this,this.jHa,"queryShowHideComments"),97);this.ia.pa(nc.a.E8g,jc.a.application,Object(Ca.a)(this,this.jHa,"queryShowHideComments"),97);this.ia.pa(nc.a.F8g,jc.a.application,Object(Ca.a)(this,this.jHa,"queryShowHideComments"),97);this.ia.xa(nc.a.mse,jc.a.application,Object(Ca.a)(this,this.d6c,"nudgeCommentMarker"));this.ia.xa(nc.a.nse,jc.a.application,Object(Ca.a)(this,this.d6c,"nudgeCommentMarker"));this.ia.xa(nc.a.ose,
jc.a.application,Object(Ca.a)(this,this.d6c,"nudgeCommentMarker"));this.ia.xa(nc.a.pse,jc.a.application,Object(Ca.a)(this,this.d6c,"nudgeCommentMarker"));this.ia.xa(nc.a.vIb,jc.a.application,Object(Ca.a)(this,this.vIb,"toggleCommentAnchoringFocus"));this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)&&(this.ia.xa(Ya.a.fqb,jc.a.application,Object(Ca.a)(this,this.fqb,"doesCommentExist")),this.ia.xa(Ya.a.wVb,jc.a.application,Object(Ca.a)(this,this.wVb,"commentActivitySelected")));
this.we()}we(){var W=this.Fa.Bc(Vi.AFrame.gj),ta=this.Fa.Bc(se.a.pC);const da=this.Fa.Bc(se.a.WT);W.bindAction(ci.KeyInputManager.Na(Gg.a.MJa,1),nc.a.vIb);ta.bindAction(ci.KeyInputManager.Na(Gg.a.MJa,1),nc.a.vIb);da.bindAction(ci.KeyInputManager.Na(Gg.a.MJa,1),nc.a.vIb);W=this.Fa.Bc(se.a.Gp);ta=[W,this.Fa.Bc(Cd.a.$C),this.Fa.Bc(Cd.a.B1),this.Fa.Bc(se.a.yg),this.Fa.Bc(se.a.sP)];for(const Ea of ta)Ea.bindAction(ci.KeyInputManager.Na(Gg.a.ffa,ci.KeyInputManager.Fe|(Jb.a.ek?4:1)),nc.a.Jtb);W.bindAction(ci.KeyInputManager.Na(Gg.a.xxa,
1),nc.a.Jtb)}thc(W,ta,da,Ea=-1){this.qta=ta;!this.Pm&&this.Sca&&(this.Pm=new wh(this.Sca,this,this.Myb,this.qta,this.o$a),this.In.F4c=this.Pm);if(W){yh.nVj(W);ta=null;this.xs&&this.ra.D7()&&(ta=this.ra.Oa);var $a=0<W.length?W[W.length-1]:null;if(this.Pm){var fb=this.Pm.zFb?this.Pm.zFb.comment:null;const qc=fb?fb.commentId:null;this.Pm.isRightToLeft=this.qta;this.Pm.Ubd(W);this.In&&(this.dZ()||this.Kqb())&&(this.In.hGc(),this.In.KFc());this.Pm.selectComment(null,!1);if(this.Uh)fb=this.Irb(this.Uh.commentId),
this.In&&this.In.LGe(fb,qc,!1),this.Pm.selectComment(fb,!0);else if(da&&fb){const Hc=this.Irb(fb.commentId);this.In&&(this.fm.isVisible||!Hc||1!==Hc.status&&2!==Hc.status)&&(this.Pm.selectComment(fb,!1),this.In.LGe(fb,qc,!1,!0))}else this.u2c&&$a&&(this.pea($a.commentId,1,!1),this.Pm.selectComment($a,!1));this.Pm.Yph(this.q$a);this.q$a&&this.In.Vpb(this.XSa)}this.rab=W.length;W=this.IMe(W);this.Y8=this.aLg.Wnl(W,this.yo);this.sbb=this.aLg.Vnl(W);da?(this.pZa(!0),this.QZ.ljh(Array.clone(this.Y8),this.rab,
Array.clone(this.sbb)),this.u2c&&$a&&this.QZ.selectComment($a.commentId)):(da=[],this.Kqb()&&(da=this.u$f(!1),da=[Object.assign(new Wg,{draftId:this.Uh.DB.draftId,insertIndex:0>Ea?0:da})]),0>Ea?this.QZ.hHe(this.Y8.length,this.rab,this.yo,this.Dee.OUc,da):this.QZ.CZk(this.Y8.length,this.rab,Ea,this.yo,da),this.QZ.mHe(Array.clone(this.Y8),Array.clone(this.sbb)));if(this.M9b){if(Ea=this.Irb(this.M9b))this.selectComment(Ea,null,!0,!0,0,1,!1),this.M9b=null}else ta&&this.ra.ZD(ta);W=this.NVf(W);this.Y2&&
W&&this.Y2.count>W.length&&this.aFi(W);this.Mdh(W);this.Cee&&this.cwl();this.u2c=!1}else this.QZ.hHe(0,0,this.yo,1),this.QZ.mHe([],[]),this.rab=0,this.Pm&&(this.Pm.isRightToLeft=this.qta,this.Pm.Ubd(null)),this.sbb=this.Y8=null,this.Ryh(!1,!1),this.rXb()}Aqa(){this.BVb&&this.LHc();this.hasFocus?this.Uh&&this.o2c.nwg&&!this.k1f()&&this.Fa.qC(se.a.pC):this.Fa.qC(this.fm.isVisible?se.a.Gp:se.a.L1)}HJk(){this.H1c=null;this.oXg()}$Bb(){this.Aqa();this.ra.ly();return!1}lMf(W){if(this.Uh){if(!this.Uh.DB)throw Mb.a.J(512496716,
805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",W),E.a.du(-2130915320);this.endCommentSession(this.Uh.DB.draftId,W)}else Mb.a.J(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",W),this.endCommentSession("",W)}iKi(){this.Rzb=this.Fa.ye.name===(this.fm.isVisible?se.a.Gp:se.a.L1);this.o2c.zDf(!0)}HWf(){this.o2c.zDf(!1);this.Rzb&&(this.Fa.qC(this.fm.isVisible?se.a.Gp:se.a.L1),this.Rzb=
!1)}Wmk(W,ta){if(W&&W.name!==se.a.Gp&&W.name!==se.a.L1&&ta.name===se.a.pC)if(this.fm.isVisible)this.xJc();else if(this.Uh){W="";switch(this.Uh.NNa){case 0:W=this.Uh.DB?this.Uh.DB.draftId:"";break;case 1:case 2:if(ta=this.el.h0d(this.Uh.commentId))W=this.el.gra(ta).commentId}this.nr.selectContainer(W,!0)}this.Rzb=!0}Vmk(){this.Rzb=!1}xJc(){this.fm.isVisible&&this.Wbb.zTi()}Xcc(W,ta,da){this.Hge=W;this.Nb.updateCommandUI();(Td.a("FixAltF12KeboardingInCommentPane")||!this.JG)&&this.Hge&&ta&&this.xJc();
W||da||this.uJa(1)}pUd(W){var ta=this.ta.presentation;if(!ta)return!1;ta=ta.slides;if(!ta)return!1;for(const da of ta)if(ta=Object(sb.a)(jb.a,da))if(ta=this.el.hra(ta.PE()),W)for(const Ea of ta){if(1===Ea.status)return!0}else{if(ta&&0<ta.length)return!0}else Mb.a.J(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}bEi(){this.el.x4a();const W=this.el.uz();W&&W.length?this.O9a.Jph():this.O9a.Hph(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}d6c(W,ta,
da){if(1===da)return 32;if(null!==this.Yih){ta=this.Yih;switch(W){case nc.a.mse:ta.pos.Y+=20;break;case nc.a.nse:ta.pos.X-=20;break;case nc.a.ose:ta.pos.X+=20;break;case nc.a.pse:ta.pos.Y-=20}this.Pm.avl(ta);this.X3j.Zwk(ta)}return 32}jXb(W,ta,da){return!this.dZf||this.yo||this.Uh&&this.Uh.DB?8:1===da?this.j1i(W):this.$Di(W)}j1i(W){switch(W){case nc.a.x4a:return this.el.uz()&&this.el.uz().length?32:8;case nc.a.kXb:return this.pUd(!1)?32:8;case nc.a.lXb:return 1!==this.b8b.iha&&this.pUd(!0)?32:8;default:return Mb.a.J(512496712,
805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",W),2}}$Di(W){switch(W){case nc.a.x4a:this.bEi();break;case nc.a.kXb:this.O9a.Iph(this.el,!1);break;case nc.a.lXb:this.O9a.Iph(this.el,!0);break;default:return Mb.a.J(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",W),2}return 32}wwa(W,ta,da,Ea,$a){if(1===da)return!this.ta.Ba||this.CRa?8:32;ta=!this.fm.isVisible;da=this.vQ.wi("UserAction",String.format("ShowHideComments: {0}",
ta?"ShowPane":"HidePane"));Mb.a.J(36983504,805,50,"New Comment Pane opened.");W===nc.a.ehd?(this.Qql(!this.o$a),this.PCe()):this.xs&&W===nc.a.chd?(this.q$a=!this.q$a,this.In.Ggd=this.q$a,this.PCe()):this.vhc(ta,!!$a&&$a.AutoShowHide);da&&da.stop();return 32}VKi(){this.fm.isVisible&&this.pea(this.Uh.DB.draftId,1,!1)}vIb(){var W=this.Fa.ye.name;if(this.Uh&&this.Uh.DB)return W===se.a.yg?(this.Aqa(),Td.a("FixAltF12KeboardingInCommentPane")||Td.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.VKi()):
this.Fa.Bf(se.a.yg),32;if(this.In.nrh||this.In.IM){if(W===se.a.yg||this.xs&&W===se.a.WT){var ta=this.In.IM;this.fm.isVisible||(W=0,ta&&(W=ta.get_shapeId()),this.Jih(W,!1));this.Aqa();return 32}if(Ic.a.contains(this.CJf,W)){ta=this.wFb;if(this.xs&&ta&&id.RM(ta)){if(W=id.H0b(ta,this.In.IM),W.isValid){const da=[];for(let $a=0;$a<W.paragraphs.length;$a++){const fb=W.paragraphs[$a];fb&&da.push(Oe.SelectionFactory.P1(fb,W.ZT.equals(fb)?W.startPos:0,W.X1.equals(fb)?W.endPos:Rc.ParagraphReader.textLength(fb)))}const Ea=
new nd.SelectionCollection(da,0);ta.textAnchoringInfo.AnchoringShape&&ta.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Fa.Bf(se.a.WT),this.XHg.execute($a=>{($a=Object(sb.a)(347,$a.Ld))&&this.XHg.instance.Gmh(Object(sb.a)(Rd.a,$a),Ea)})):(this.Fa.Bf(se.a.yg),this.ra.ZD(Ea))}}else this.Fa.Bf(se.a.yg);return 32}}else{if(Ic.a.contains(this.CJf,W))this.Fa.Bf(se.a.yg);else{W=null;W=this.Hc&&this.Hc.Jc?this.el.$5a(this.Hc.Jc.Nd):this.IMe(this.el.uz());if(!Ic.a.Va(W))for(ta of W)if(this.fm.isVisible||
0===ta.status){this.pea(ta.commentId,1,!1);break}this.Aqa()}return 32}return 8}EDf(W,ta){W&&!ta?this.JG&&this.jxe?this.LHc():(this.Fa.Gj(se.a.Gp,!0),this.Aqa(),this.xJc()):ta?W&&this.Fa.v7(se.a.Gp,se.a.gj,this.fm,!1):0<this.aYd()||this.Uh&&this.Uh.DB?this.Fa.Gj(se.a.L1,!0):this.Fa.Gj(se.a.Gp,!1);ta||this.nkh()}qhk(){this.x1c||(this.tm.Qua(this.tm.iLd,this.tm.XMd),this.tm.Pua(this.tm.iLd,this.tm.XMd),this.x1c=!0,this.wD.rhk(this.ta.Mj));this.nW&&this.nW.mPi()}nkh(){const W=this.el.uz();W&&0<W.length&&
(this.RFg=!0)}dZ(){var W=this.el.uz();if(!W||!W.length)return!1;W=Ld.e(W,ta=>0===ta.status);return!!W&&0<W.length}jHa(W,ta,da,Ea,$a){W===nc.a.jHa?$a[Bi.a.On]=this.fm.isVisible:W===nc.a.E8g||W===Ya.a.m9g?$a[bh.a.On]=this.fm.isVisible:W===nc.a.F8g?$a[bh.a.On]=this.o$a:this.xs&&W===nc.a.C8g&&($a[bh.a.On]=this.q$a);return!this.ta.Ba||this.CRa?16:32}fqb(W,ta,da,Ea,$a){return 2!==da?32:(W=this.b1f($a))&&this.findComment(W)?32:8}wVb(W,ta,da,Ea,$a){return 2!==da?32:(W=this.b1f($a))&&this.gek(W)?32:8}b1f(W){if(!W)return null;
W=W.NavigationId;if(!W)return null;try{return JSON.parse(W)}catch(ta){return Mb.a.J(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",ta),null}}gek(W){if(W.sId!==this.Hc.Jc.Nd.sid){var ta=Wb.a.bE(W.sId,W.cId);ta=this.N0d(ta);if(!ta)return!1;this.Ie.wda(ta.De)}ta=this.findComment(W);if(!ta)return!1;1!==ta.status&&2!==ta.status||this.Xgd();this.pea(W.commentId,1,!1);return!0}findComment(W){var ta=this.ta.presentation;if(!ta)return null;ta=ta.slides;if(!ta)return null;for(const da of ta)if((ta=
Object(sb.a)(jb.a,da))&&ta.sid===W.sId){ta=this.el.hra(ta.PE());for(const Ea of ta){if(Ea.commentId===W.commentId)return Ea;if(Ea.Children&&Ea.Children.length)for(const $a of Ea.Children)if($a.commentId===W.commentId)return $a}}return null}isCollapsed(){return!1}get Yih(){return null}clearSelection(){}QJk(){this.Nb.updateCommandUI()}get f7a(){return!!this.Uh}pmi(){this.Uh&&this.lMf(8)}B9(W){2===W.behavior&&W.actionId===nc.a.Ddb&&(W=this.hv.fLc(!0),W!==nc.a.v9c&&W!==nc.a.bS&&W!==nc.a.x4a&&W!==nc.a.kXb&&
W!==nc.a.lXb||ce.UISurfaces.VM().then(ta=>{this.O9a.lNk(ta)}))}z9(){}static $Rg(W,ta){return W.contentId===ta}static nVj(W){let ta="";if(W){for(const da of W)if(ta+=da.commentId+";",da.Children)for(const Ea of da.Children)ta+=Ea.commentId+";";Mb.a.J(512496659,805,15,"LogCommentIds() - {0}",ta)}}}Object(h.a)(yh,"SharedCommentFrame",null,[478,106,479,156]);class Rj{constructor(W,ta,da,Ea,$a,fb,qc=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=
null;this.commentId=W;this.parentId=ta;this.commentBody=da;this.author=Ea;this.date=$a;this.commentFlags=fb;this.usersByReactionType=qc}}Object(h.a)(Rj,"OfficeSharedCommentModel",null,[]);class Ci{constructor(W,ta){this.CommentId=W;this.ResolveState=ta}}Object(h.a)(Ci,"CommentProperties",null,[]);class bk{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(h.a)(bk,"AtMentionAttributes",null,[]);class zg{constructor(){this.contentId=""}}Object(h.a)(zg,"AtMentionOptionalAttributes",
null,[]);class xf{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(h.a)(xf,"DeltaAttributes",null,[]);var Qh;(function(W){W[W.Undo=-1]="Undo";W[W.Unknown=0]="Unknown";W[W.Create=1]="Create";W[W.Assign=2]="Assign";W[W.Unassign=3]="Unassign";W[W.UnassignAll=4]="UnassignAll";W[W.Schedule=5]="Schedule";W[W.Progress=6]="Progress";W[W.Delete=7]="Delete";W[W.Restore=
8]="Restore";W[W.SetTitle=9]="SetTitle";W[W.Priority=10]="Priority"})(Qh||(Qh={}));Object(h.b)("HistoryRecordType",Qh);class Lh{constructor(){this.Id=this.FullName=this.Email=this.DispName=null}}Object(h.a)(Lh,"CommentAtMention",null,[]);var oj=d(878);class gj{constructor(){this.UserId=this.ProviderId=this.FullName=this.Email=this.DisplayName=null}}Object(h.a)(gj,"UserInfo",null,[]);class Di{constructor(W,ta){this.plainText=W;this.uUg=ta}}Object(h.a)(Di,"TextTranslationResult",null,[]);var dh=d(66);
class Ig{constructor(W,ta,da){this.qUk="[";this.O$h=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.PSj=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");this.P$h=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.zBg=!1;this.$b=W;this.$oe=ta;this.jle=da}get userId(){return this.$b.appSettings["387"]}get providerId(){return this.$b.appSettings["388"]}Acj(W,ta){let da=0;if(1===W.status||2===W.status)da|=8;ta&&(da|=1);this.$9k(W)&&(da|=16);return da}isCurrentUser(W){return Bc.a.Va(W.userId)?
!1:"Author"===W.userId||this.userId===W.userId&&this.providerId===W.providerId?!0:!1}$9k(W){return""===W.userId||"Author"===W.userId||!this.czl(W.userId)||this.userId===W.userId&&this.providerId===W.providerId?!1:!0}czl(W){return 3===W.split("::").length}dxh(W,ta,da){if(null===W)throw Error.argumentNull("comment");const Ea=this.Ynl(W.text);var $a=W.authorName;const fb=Td.a("PPTPlumbEmailThroughCG")?Ga.a.j5a(W.userId||""):"",qc=W.dt;da=this.Acj(W,da);$a=new Ub(W.userId,W.providerId,$a,fb,this.isCurrentUser(W));
return new Rj(W.commentId,ta,Ea,$a,qc,da)}Wnl(W,ta){if(null===W)throw Error.argumentNull("comments");const da=new n.a;for(const Ea of W)if(da.add(this.dxh(Ea,"",ta)),Ea.Children&&0<Ea.Children.length)for(const $a of Ea.Children)da.add(this.dxh($a,Ea.commentId,ta));return da.toArray()}bol(W,ta,da,Ea){const $a=Object.assign(new oj.a,{Asignees:[]});W=this.$oe.YVi(W,ta,!ta.taskId,da);for(const fb of W)2===fb.type?fb.assignee?(W=Object.assign(new gj,{DisplayName:fb.assignee.DisplayName,FullName:fb.assignee.DisplayName,
UserId:fb.assignee.UserId,ProviderId:fb.assignee.Provider,Email:fb.assignee.Email}),$a.Asignees.push(W)):Mb.a.J(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===fb.type&&($a.Title=fb.title);if(!$a.Asignees)return Mb.a.J(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),null;$a.Title||(Mb.a.J(512496656,845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),
$a.Title=Ea);return $a}$nl(W,ta){const da=new oj.a;if(W.assignee){const Ea=new gj,$a=W.assignee;Ea.DisplayName=$a.Name;Ea.FullName=$a.Name;Ea.UserId=$a.UserPrincipalName;Ea.ProviderId="O365";Ea.Email=$a.UserPrincipalName;da.Asignees=[Ea]}da.Title=W.title?W.title:ta;return da}aol(W,ta,da){if(!ta)return null;try{const Ea=this.tkd(da,new Date).plainText,$a=this.jle?this.bol(W,ta,da,Ea):this.$nl(ta,Ea);if(!$a)return null;$a.CompletionPercentage=ta.completion?ta.completion:0;return $a}catch(Ea){Mb.a.J(512496655,
845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",Ea)}return null}Vnl(W){if(null===W)throw Error.argumentNull("comments");const ta=new n.a;for(const da of W)da.taskInfo&&da.taskInfo.Asignees&&0<da.taskInfo.Asignees.length&&(W=this.Unl(da))&&ta.add(W);return ta.toArray()}Unl(W){if(this.jle&&this.$oe&&0<W.taskInfo.TaskHistoryRecords.length)try{var ta=Ig.Sti(W.taskInfo.TaskHistoryRecords),da=new dh.a;da.add(W.commentId,new Ci(W.commentId,100===W.taskInfo.CompletionPercentage));var Ea=
this.$oe.fBi(W.commentId,W.commentId,ta,da);Ig.ski(W,Ea,this.jle);return Ea}catch($a){return Mb.a.J(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",$a.message),null}else return ta=new ea,ta.startDate=W.taskInfo.StartDate,ta.endDate=W.taskInfo.DueDate,da=new oa(W.taskInfo.Asignees[0].UserId),da.DisplayName=W.taskInfo.Asignees[0].DisplayName,da.Provider=W.taskInfo.Asignees[0].ProviderId,da.Email=W.taskInfo.Asignees[0].Email,Ea=Array(1),Ea[0]=da,ta=new ia(!1,W.taskInfo.Title,
Ea,ta,W.taskInfo.CompletionPercentage,0),new Z(W.commentId,W.commentId,ta,[])}Ynl(W){if(null===W)throw Error.argumentNull("nativeText");const ta=new xa;W=W.split(this.P$h);for(const Ea of W){var da=this.O$h.exec(Ea);da&&3===da.length?(W=new bk,da[0].substring(0,1)===this.qUk?(W.fullName=da[2],W.resolveState=1):(W.fullName=da[1],W.resolveState=0),W.email="UnknownEmail",da=new zg,da.contentId="Pre-existing Mention",ta.Vyj("@"+W.fullName,W,da),this.zBg||(this.zBg=!0,Mb.a.J(512496653,845,15,"Rendering mention when AtMentions are disabled."))):
(W=this.PSj.exec(Ea))&&1===W.length?(W=W[0],ta.insertHyperLink(W,Object.assign(new xf,{link:W}))):ta.Azj(Ea)}return ta.n1i()}tkd(W,ta){var da=Sys.Serialization.JavaScriptSerializer.deserialize(W);W=[];ta||(ta=new Date);const Ea=new Sys.StringBuilder;for(const $a of da.ops)if($a.attributes){if($a.attributes.atmention){const fb=1<$a.insert.length?$a.insert.substring(1,$a.insert.length):"";if($a.optional&&$a.optional.atmention)da=Ig.F$f(fb,1===$a.attributes.atmention.resolveState);else{da=Ig.F$f(fb,
1===$a.attributes.atmention.resolveState);const qc=Ig.N7i(ta,1===$a.attributes.atmention.resolveState);Array.add(W,Object.assign(new Lh,{FullName:$a.attributes.atmention.fullName,DispName:fb,Id:qc,Email:$a.attributes.atmention.email}));ta=new Date(ta.getTime()+1)}}else $a.attributes.link||Mb.a.J(512496652,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),da=$a.insert;Ea.append(da)}else Ea.append($a.insert);return new Di(Ea.toString(),W)}static qui(W){switch(W){case 0:return 0;
case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static nui(W){var ta=null;W.User&&(ta=new oa(W.User.UserId,W.User.ProviderId,W.User.DisplayName));ta=new aa(Ig.qui(W.HistoryRecordType),ta,W.DtTime,W.RecordId);ta.commentId=W.CommentId;W.Assignee&&(ta.assignee=new oa(W.Assignee.UserId,W.Assignee.ProviderId,W.Assignee.DisplayName));W.StartDate&&W.DueDate?(ta.schedule=new ea,ta.schedule.startDate=
W.StartDate?W.StartDate:null,ta.schedule.endDate=W.DueDate?W.DueDate:null):W.StartDate&&!W.DueDate?Mb.a.J(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):!W.StartDate&&W.DueDate&&Mb.a.J(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var da=W.Priority;0<da?ta.priority=da:Mb.a.J(512496649,845,10,"Priority is negative");da=W.CompletionPercentage;0<=da?ta.completion=da:Mb.a.J(512496648,845,10,
"Percent complete is negative");ta.title=W.Title;ta.undoId=W.UndoId;return ta}static Sti(W){const ta=W.length,da=Array(ta);for(let Ea=0;Ea<ta;++Ea)da[Ea]=Ig.nui(W[Ea]);return da}static ski(W,ta,da){const Ea=ta.currentState,$a=W.taskInfo;let fb=!1;const qc=Td.a("SetTaskFromTaskStateInsteadOfHistory");$a.StartDate.toString()!==Ea.schedule.startDate.toString()&&(qc&&(Ea.schedule.startDate=$a.StartDate),fb=!0,Mb.a.J(512496647,845,10,"Start Date does not match."));$a.DueDate.toString()!==Ea.schedule.endDate.toString()&&
(qc&&(Ea.schedule.endDate=$a.DueDate),fb=!0,Mb.a.J(512496646,845,10,"End Date does not match."));$a.CompletionPercentage!==Ea.completion&&(qc&&(Ea.completion=$a.CompletionPercentage),fb=!0,Mb.a.J(512496645,845,10,"Completion percentage does not match."));$a.Title!==Ea.title&&(qc&&(Ea.title=$a.Title),fb=!0,Mb.a.J(512496644,845,10,"Title does not match."));$a.Asignees[0].UserId!==Ea.assignees[0].UserId&&(qc&&(Ea.assignees[0].UserId=$a.Asignees[0].UserId),fb=!0,Mb.a.J(512496643,845,10,"Assigned to user id does not match."));
$a.Asignees[0].DisplayName!==Ea.assignees[0].DisplayName&&(qc&&(Ea.assignees[0].DisplayName=$a.Asignees[0].DisplayName),fb=!0,Mb.a.J(512496642,845,10,"Assigned to display name does not match."));$a.Asignees[0].ProviderId!==Ea.assignees[0].Provider&&(qc&&(Ea.assignees[0].Provider=$a.Asignees[0].ProviderId),fb=!0,Mb.a.J(512496641,845,10,"Assigned to provider id does not match."));$a.Asignees[0].Email!==Ea.assignees[0].Email&&(qc&&(Ea.assignees[0].Email=$a.Asignees[0].Email),da||(fb=!0,Mb.a.J(512496640,
845,10,"Assigned to email does not match.")));fb&&da&&Ig.KXj(W,ta)}static KXj(W,ta){const da=new n.a;for(const Ea of ta.history)for(const $a of Ea.records)da.add(Qh[$a.type]);if(da.count!==W.taskInfo.TaskHistoryRecords.length){ta=new n.a;for(const Ea of W.taskInfo.TaskHistoryRecords)ta.add(Qh[Ea.HistoryRecordType]);Mb.a.J(512496611,845,10,"LogTaskHistoryDetailsForMismatch")}}static N7i(W,ta){W=W._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return ta?W+"_Z":W}static F$f(W,
ta){return ta?"[@"+W+"]":"<@"+W+">"}}Object(h.a)(Ig,"SharedCommentModelTranslator",null,[473]);class ua{constructor(W,ta,da){this.VTa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled")&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesF6LoopFixesIsEnabled");this.K$e=!1;this.Fa=W;this.fh=ta;this.Swb=da}zDf(W){W?(this.VTa&&this.Swb&&this.Swb.isVisible||this.fh.TJ(se.a.pC),this.fh.qo(se.a.Gp),this.Fa.qC(se.a.pC)):(this.fh.qo(se.a.pC),this.Swb.isVisible&&
!this.VTa&&this.fh.TJ(se.a.Gp));this.K$e=W}get nwg(){return this.K$e}}Object(h.a)(ua,"SharedCommentsRTEFocusActionHelper",null,[453]);class Pa{constructor(W,ta,da,Ea){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=W;this.body=ta;this.confirmButton=da;this.cancelButton=Ea}}Object(h.a)(Pa,"ViewContainerModalDialogStrings",null,[]);class eb{constructor(W,ta,da){this.containerType="full-pane";this.identifier=null;this.eb=W;this.Fa=ta;this.identifier=da}closeView(){this.eb.vhc(!1,
!1)}openView(){this.eb.vhc(!0,!1)}invokeModalConfirmationDialog(W,ta,da){const Ea=new jh.StandardDialog;da&&da.title&&da.body&&da.confirmButton&&da.cancelButton||(Mb.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),da=new Pa("","","",""));Ea.vd=1;Ea.Re(1,da.confirmButton);Ea.Re(0,da.cancelButton);Ea.E4a=this.Fa.ye.name;Ea.zcc=!0;Ea.Yw(da.title,da.body,1,$a=>{1===$a?(W(),Ea.E4a=null):ta()})}}Object(h.a)(eb,"ViewContainerAPI",null,[470,471]);class Kb extends Sys.EventArgs{constructor(){super()}}
Object(h.a)(Kb,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var bc=d(276);class oc{constructor(){this.CKg=this.YPg=this.Wbb=this.UQg=this.Hta=this.ZWc=this.DFa=this.aXc=this.gQ=this.K=null;this.m$a=this.cta=this.vxb=!1;this.vQ=this.Kee=null;this.bMg="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.sN=null;this.VTa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.JG=!1}Wb(W){this.K=W;this.JG=this.K.resolve("PowerPointWebEditor.IApplicationSettings").aNd;
this.vQ=this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.Wbb=new I(e.AFrameworkApplication.ue,"CommentPane");W.register(le,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").ma().na(()=>new le);const ta=this.K.resolve("PowerPointWebEditor.IFileInfo").iha,da=2===ta||3===ta;this.vxb=da;this.m$a=1===ta;W.register(Sc,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").ma().na(()=>new Sc(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),ta));W.register(kb,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").ma().na(()=>new kb(this.vQ,ta,this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.K.resolve("PowerPointWebEditor.IClassFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.K.resolve("PowerPointWebEditor.ICommentEditor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("PowerPointWebEditor.ISlideReader")));const Ea=this.vxb||!this.m$a;this.sN=this.K.resolve("PowerPointWeb.Comments.ICommentGraphManager");
Ea&&W.register(336,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").ma().na(()=>new bc.a((Ac,Lc)=>{let yc=null;const Oc=Object(sb.a)(124,Ac.oc(W.resolve("Box4.IPageView").Ma));Oc&&!Oc.ll&&(Ac=W.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").pPd(W.resolve("PowerPointWebEditor.IPptSelectionManager"),null,Ac,Lc,Oc.PT),yc=new Ed(Ac),yc.$m(Oc.PT),Oc.zza(yc,5),yc.visible=Oc.KP||Oc.Fn);return yc}));this.K.register(450,
"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").ma().na(()=>new tc(this.sN,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),W.resolve("PowerPointWebEditor.Graph.ITableReader")));this.K.register(451,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").ma().na(()=>new Pc(this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Cd,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.sN));const $a=this.vxb||!this.m$a;
this.K.register(452,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").ma().na(()=>new si(this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),new Yf($a),this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),$a,$a));const fb=this.K.resolve("Common.IAppSettingsManager").ka("CommentTextAnchoringUIEnabled")&&!this.m$a;this.K.register(mf,"PowerPointWebEditor.CommentTextAnchorHighlightActor").ma().na(()=>new mf(fb,
this.K.resolve("Common.Utils.IHighContrastDetector")));const qc=new Vf(Ea,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Ea?this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):null,this.sN,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAriaManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("Box4.Highlight.IHighlightManager"),
this.K.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));W.register(453,"PowerPointWebEditor.IRTEFocusActionHelper").ma().na(()=>new ua(W.resolve("Common.IFocusManager"),W.resolve("Common.IF6Manager"),W.resolve("PowerPointWebEditor.ICommentsPane")));this.K.register(M,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").ma().na(()=>
new M(this.K.resolve("Common.ITaskManager")));const Hc=this.K.resolve("Common.IAppSettingsManager").ka("TasksHistoryEnabled");Hc&&this.K.register(454,"Common.Comments.ICommentTaskTranslator").ma().na(()=>(new va(!0,Hc,!0)).awi());this.K.register(Ig,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").ma().na(()=>new Ig(this.K.resolve("Common.IAppSettingsManager"),Hc?this.K.resolve("Common.Comments.ICommentTaskTranslator"):null,Hc));this.K.register(Fa,
"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").ma().na(()=>new Fa);this.cta=this.K.resolve("Common.IAppSettingsManager").ka("896")&&(da||!this.m$a);this.K.register(yh,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").ma().na(()=>new yh(this.sN,this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
this.K.resolve("PowerPointWebEditor.ICommentsPane"),this.K.resolve("Common.DragInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.ICommentsPane").ya,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Wbb,this.K.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),
e.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Cd,this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),
this.vQ,qc,this.K.resolve("Common.IAppSettingsManager"),this.K.La("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),Ea,W.resolve("PowerPointWebEditor.IErrorHandler"),W.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.cta,W.resolve("Box4.Graph.IGraphInstance").Bd(10),W.resolve("PowerPointWebEditor.View.IViewEventSource"),W.resolve("PowerPointWebEditor.ICommentCloudPolicy"),$a,W.resolve("PowerPointWebEditor.IShapeReader"),W.La("Common.App.SafeLinks.ISafeLinksManager"),
W.resolve("Box4.ICharacterPropertiesEditor"),W.resolve("PowerPointWebEditor.IFileInfo"),this.JG,W.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").fBb?this.K.resolve("PowerPointWebEditor.ICommentShimmerView"):null));this.K.register(Nb,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").ma().na(()=>
new Nb(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").SYj));this.K.register(eb,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").ma().na(()=>new eb(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.bMg));const kd=new yd(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
new ih(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.sN,this.K.resolve("Common.IAppSettingsManager").ka("459"),this.K.Be("PowerPointWeb.Comments.ICommentFrame"));this.K.register(455,"PowerPointWebEditor.IFindCommentLogic").ma().na(()=>new fg(kd,this.K.resolve("Common.ITaskManager")));this.K.register(Jd,"PowerPointWebEditor.CommentsChangeListener").ma().na(()=>new Jd(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(7),this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame")));this.K.register(456,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").ma().na(()=>new Zf(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.sN,
this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.ITaskManager")));this.K.register(Vg,"PowerPointWebEditor.CommentPropertyTracker").ma().na(()=>new Vg(Object(Ca.a)(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").oXg,"onCommentPropertiesUpdated"),Pb.App.sO.gU,dc.GraphTransactionManager.instance));this.K.register(457,"PowerPointWebEditor.ICommentsPane").ma().na(()=>
new Pf(this.K.resolve("PowerPointWebEditor.IFrameContext"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").qsa,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.JG));this.K.register(Bh,"PowerPointWebEditor.CommentSmartReplyProvider").ma().na(()=>new Bh(this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.La("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){Rb.a.instance.ic(gc.a.$Md,
(new Date).getTime());const W=this.vQ.wi("UserAction","InitCommentsPackage"),ta={};this.JG||(this.DFa=this.K.resolve("PowerPointWebEditor.ICommentsPane").ya);this.gQ=this.K.resolve("PowerPointWeb.Comments.ICommentFrame");this.gQ.initialize();var da=W.Dq;ta.CommentFrameInitMS=da;this.K.resolve("PowerPointWebEditor.ICommentSessionManager");this.aXc=this.K.resolve("PowerPointWebEditor.CommentPropertyTracker");this.aXc.qsj();const Ea=W.Dq;ta.CommentPropertyTrackerInitMS=Ea-da;this.Kee=this.K.resolve("PowerPointWebEditor.CommentsChangeListener");
this.UQg=this.K.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var $a=mb.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());da=$a.Ring||"Unknown";$a=$a.WACDatacenter||"Unknown";const fb=this.K.resolve("PowerPointWebEditor.IApplicationSettings").cCj;var qc=e.AFrameworkApplication.fa.Ha("LokiComplianceEnvironment");qc=qc&&""!==qc?qc:e.AFrameworkApplication.fa.Ha("SovereignEnvironmentName");this.YPg=new tb("PowerPoint",e.AFrameworkApplication.buildVersion,null,null,e.AFrameworkApplication.userSessionId,
da,$a,!fb,this.K.resolve("Common.IActionManagerExtended"),null,qc);da=Yb.a.le(e.AFrameworkApplication.lcid);this.CKg=new Tc(e.AFrameworkApplication.isRtl,da?da.name:Sys.CultureInfo.CurrentCulture.name,e.AFrameworkApplication.uiCulture,e.AFrameworkApplication.dataCulture);this.JG||(this.DFa.id=this.bMg);this.y2b();e.AFrameworkApplication.fa.ff(Object(Ca.a)(this,this.Bm,"onFullAppSettingsReady"));(da=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&da.lEk(new Kb);da=W.Dq;
ta.CommentReactPaneInitMS=da-Ea;this.Dvj();ta.CommentPaneInitMS=W.Dq-da;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)&&this.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();W.stop();Mb.a.J(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",ta,this.K.resolve("Common.IAppSettingsManager").ka("896"))}Dvj(){const W=this.K.resolve("PowerPointWebEditor.ICommentsPane"),
ta=this.K.resolve("PowerPointWebEditor.IPaneManager");this.JG||(!this.VTa||this.VTa&&!document.getElementsByClassName("CommentPanel").length)&&ta.uM(W);ta.Zvb(2);this.K.resolve("PowerPointWebEditor.IFocusManager").v7(se.a.Gp,se.a.gj,W,!W.isVisible)}y2b(){Rb.a.instance.ic(gc.a.y2b,(new Date).getTime());const W=this;this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy").sWb().then(ta=>{Rb.a.instance.ic(gc.a.w5d,(new Date).getTime());ib.a.vu(W.K.La("Common.App.People.IExternalPeopleAPI")).continueWith(da=>
{W.Hta=da.result;W.Hta||Mb.a.J(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");W.K.resolve("PowerPointWebEditor.IApplicationSettings").vg&&(da=W.K.resolve("Common.IAppSettingsManager").Ha("368"),W.Hta.zrk(da+"p"));da=[Zb.a.contextMenu];W.JG||Cc.a.$bd(W.DFa,da);const Ea=ta&&(W.vxb||!W.m$a),$a=W.K.resolve("Common.IAppSettingsManager").ka("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");W.K.register(Md,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").ma().na(()=>
new Md(W.K.resolve("Common.IAppSettingsManager"),W.K.resolve("PowerPointWebEditor.IApplicationSettings"),W.Hta,W.m$a,Ea,W.cta));W.K.register(Xb,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").ma().na(()=>new Xb(W.K.resolve("PowerPointWeb.Comments.ICommentFrame"),W.sN,W.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),W.K.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),W.K.resolve("Common.ITaskManager"),W.K.resolve("Common.IAppSettingsManager"),
W.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),W.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),W.Hta,W.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),W.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),Ea,W.cta,$a,W.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),W.K.resolve("Common.IActionManagerExtended"),W.K.resolve("PowerPointWebEditor.IApplicationSettings")));W.ZWc=W.K.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},
11).continueWith(()=>{W.ZWc&&W.ZWc.checkAtMentionCapability().then(da=>{da&&((da=W.K.La("Common.ISystemInitiatedFeedback"))?da.execute(Ea=>{Ea.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):Mb.a.J(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});W.Bvj()})})}Bvj(){Rb.a.instance.ic(gc.a.bKe,(new Date).getTime());const W=this.K.resolve("Common.IDynamicScriptLoaderProvider").yv,ta=this.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),
da=this.K.resolve("Common.Comments.ICommentActivationManager");Rb.a.instance.ic("CommentActivationManagerInitStart",(new Date).getTime());da.initialize(W,this.ZWc,this.YPg,this.Hta,new ob(this.UQg,this.Wbb),this.CKg,null,ta.Bcj());Rb.a.instance.ic(gc.a.O2b,(new Date).getTime());da.O2b().then(()=>{Rb.a.instance.ic(gc.a.x5d,(new Date).getTime());this.gQ.eyj();Rb.a.instance.ic(gc.a.Mbe,(new Date).getTime());Kc.a(this.K)("floatingContainerManager").then(()=>{Rb.a.instance.ic(gc.a.FVd,(new Date).getTime());
this.gQ.Mvj();Rb.a.instance.ic(gc.a.GVd,(new Date).getTime());if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").X9h){const Ea=this.sN.uz();Ea&&0<Ea.length?(this.gQ.RYk(),Rb.a.instance.ic(gc.a.xgd,(new Date).getTime()),mc.App.EFb(null,gc.a.xgd)):Mb.a.J(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(Ea=>{Mb.a.J(512262874,801,10,"Failed to load the resources for the floating container UI + "+Ea.toString())})})}Bm(){this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").updateCommandUI()}dispose(){this.aXc&&
this.aXc.rrl();this.gQ&&this.gQ.dispose();this.Kee&&this.Kee.dispose();this.Hta=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){Rb.a.instance.ic(gc.a.VMd,(new Date).getTime());cc.a.instance.Ac(new oc)}}Object(h.a)(oc,"CommentsPackage",null,[2,3]);Type.registerNamespace("Common.App.SharedComments");Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("RichContentEditAPI");oc.main()},276:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(985);class e{constructor(m){this.Nk=new h.a;this.sVa=m}xP(m){const n=m.id;let v=null;this.Nk.Jb(n)?v=this.Nk.ga(n):(this.sVa&&(v=this.sVa(m,()=>{this.Jhc(n)})),v&&this.Nk.$(n,v));return v}VE(m){m=m.id;return this.Nk.Jb(m)?this.Nk.ga(m):null}Jhc(m){this.Nk.remove(m)}}Object(J.a)(e,"ShapeComponentViewManager",null,[336])},666:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);
var h=d(17),e=d(95),m=d(27),n=d(48);d(96);class v{constructor(){this.qZ=null}get ntb(){return!1}pxh(A,w){let y=new h.a;const u=new n.GraphTransaction(3);try{u.fd(m.App.Fb.Ed.en.rg),this.h5b(w)&&(y=this.T2b(w,y)),w!==A&&this.h5b(A)&&(y=this.T2b(A,y))}finally{u&&u.dispose()}return y.toArray()}h5b(A){return!!A}lcd(A){let w=!1;for(const y of this.j4d)w||!Sys.UI.DomElement.containsCssClass(A,y.className)&&!Sys.UI.DomElement.containsCssClass(A,y.f1b)||(w=!0),e.a.vHa(A,y.className),e.a.vHa(A,y.f1b)}}Object(J.a)(v,
"AHighlightActor",null,[504])},667:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.className=e;this.f1b=m}}Object(J.a)(h,"HighlightCssClassPair",null,[])},668:function(J,V,d){d.d(V,"b",function(){return n});d.d(V,"a",function(){return v});var h=d(95);d(27);var e=d(48);d(31);d(90);var m=d(96);const n=A=>{const w=new e.GraphTransaction(3);try{w.fd(A),A.Vu(32,!0)}finally{w&&w.dispose()}},v=A=>{if(A){A=h.a.Yha(A);if(-1===A.indexOf(m.a.L6)&&-1!==A.indexOf(m.a.yM)&&
-1===A.indexOf(m.a.NWb))return 2;if(-1===A.indexOf(m.a.L6)&&(-1!==A.indexOf(m.a.MWb)||-1!==A.indexOf(m.a.OM)||-1!==A.indexOf(m.a.NWb)||-1!==A.indexOf(m.a.JDc)||-1!==A.indexOf(m.a.tFc)||-1!==A.indexOf(m.a.rFc)||-1!==A.indexOf(m.a.qFc)||-1!==A.indexOf(m.a.OPd)||-1!==A.indexOf(m.a.JPd)||-1!==A.indexOf(m.a.LPd)||-1!==A.indexOf(m.a.sFc)||-1!==A.indexOf(m.a.IPd)))return 1;if(-1!==A.indexOf("WACImageContainer"))return 3}return 0}},669:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.type=
this.action=0;this.Fdb=this.Nba=null}}Object(J.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.comment.js.map