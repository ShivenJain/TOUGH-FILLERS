'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1099:function(J,V,d){J=d(0);var h=d(375),e=d(13),m=d(227),n=d(228);class v{static cYd(Z,oa,Ba){return v.dYd(Z,oa,Ba,!0)}static dYd(Z,oa,Ba,Ma){const za=document.createElementNS(v.Shb,"svg");za.setAttribute("viewBox",String.format(v.jQd,v.Snc,v.Rnc));za.appendChild(v.f1d(Z,oa,Ba,Ma));return za}static f1d(Z,oa,Ba,Ma){const za=v.Snc/Z,ka=oa/2*za,qa=v.Rnc/2;let Ja=0;Ma&&(Ja=(Z-3*oa-4*Ba)*za/2);Z=document.createElementNS(v.Shb,
"g");Sys.UI.DomElement.addCssClass(Z,v.iQd);for(Ma=1;3>=Ma;Ma++)Z.appendChild(v.AXd(Ma,ka,Ja+(Ma*(oa+Ba)-oa/2)*za,qa));return Z}static AXd(Z,oa,Ba,Ma){const za=document.createElementNS(v.Shb,"circle");Sys.UI.DomElement.addCssClass(za,String.format("{0}-{1}",v.WLd,Z));za.setAttribute("cx",String.format("{0}",Ba));za.setAttribute("cy",String.format("{0}",Ma));za.setAttribute("r",String.format("{0}",oa));return za}}v.Shb="http://www.w3.org/2000/svg";v.iQd="prDancingDots";v.WLd="prAnimateCircle";v.jQd=
"0 0 {0} {1}";v.Rnc=40;v.Snc=120;Object(J.a)(v,"ModernPresenceTooltipDancingDots",null,[]);var A=d(25),w=d(169),y=d(72),u=d(65),E=d(131),G=d(193),I=d(95),H=d(45),K=d(2);class C extends m.a{constructor(Z,oa){super(Z);this.VRb=this.kR=this.i_a=this.kM=this.fM=this.Ko=this.tn=null;this.BH=oa.get(8,!1);this.hR=oa.get(6,0);this.hEd=oa.get(15,!1);this.Gc=oa;this.pMb=0;this.element=Z;this.element.className=C.z5a;this.ps=document.createElement("span");this.element.appendChild(this.ps);this.prd=v.cYd(oa.get(6,
0),4,2);this.$I(oa);this._state=5}VU(Z){this.addHandler(n.a.Qo,Z)}S_(Z){this.removeHandler(n.a.Qo,Z)}get user(){return this.VRb}get state(){return this._state}dispose(){this.element&&(this.tn.xb(u.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.tn.xb(u.a.doubleClick,this.element,Object(e.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),this.Ko.xb(u.a.pointerDown,this.element,Object(e.a)(this,this.Zua,"onPointerDown")),this.Ko.xb(u.a.pointerOut,this.element,Object(e.a)(this,
this.Py,"onPointerOut")),this.Ko.xb(u.a.pointerOver,this.element,Object(e.a)(this,this.jC,"onPointerOver")),this.fM.xb(this.element,Object(e.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}$I(Z){this.tn=Z.get(10);this.tn.ob(u.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.tn.ob(u.a.doubleClick,this.element,Object(e.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior"));this.Ko=Z.get(9);this.Ko.ob(u.a.pointerOver,this.element,Object(e.a)(this,
this.jC,"onPointerOver"));this.Ko.ob(u.a.pointerOut,this.element,Object(e.a)(this,this.Py,"onPointerOut"));this.Ko.ob(u.a.pointerDown,this.element,Object(e.a)(this,this.Zua,"onPointerDown"));this.fM=Z.get(13);this.fM.ob(this.element,Object(e.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior"))}hide(Z=null,oa=0,Ba=0){this.hEd&&Z?this.CLe(Z,oa,Ba):(3===this.state&&this.Lhc(),this.visible=!1,this._state=5)}CLe(Z,oa,Ba=0){this.show(Z,oa,15,4,void 0,Ba)}xkc(Z,oa,Ba,Ma=!1,za=!1,ka=!1,qa=0){this.show(Z,
oa,Ba+20,Ma?2:za?1:0,ka,qa)}kLe(Z,oa,Ba,Ma=!1,za=0){this.show(Z,oa,Ba+20,3,Ma,za)}show(Z,oa,Ba,Ma=3,za=!1,ka=0){!Z||Ma===this.state&&this.G3d(oa,Ba)||(this.mFd(Ma,za,ka),this.lz(Z,Ma,ka),this._state=Ma,4===ka||0===ka&&!this.BH?this.element.style.left=oa+"px":this.element.style.right=oa+"px",this.element.style.top=Ba+"px",this.visible=!0)}lz(Z,oa,Ba){this.VRb=Z;I.a.$t(this.ps);G.a.DNf(this.ps);this.ps.id="fly_"+Z.clientId;this.ps.style.backgroundColor=Z.color;4!==oa?(this.ps.style.height=this.hR+"px",
this.ps.style.lineHeight=this.hR+"px",G.a.FX(this.ps,"border-radius",this.hR+"px")):4===Ba||0===Ba&&!this.BH?this.ps.style.left="0px":this.ps.style.right="0px";2!==oa&&(4===oa?I.a.ix(this.ps,""):1===oa?this.ps.appendChild(this.prd):(this.ps.setAttribute("dir","auto"),Ba=H.a.pZd(Z.userName,!1),(!Z.isAnonymous||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&Ba||0!==oa?(Z=Z.userName,0===oa&&(Z=Ba,G.a.FX(this.ps,"text-align","center")),
I.a.ix(this.ps,Z)):(this.kM||(this.kM=this.qOd()),this.ps.appendChild(this.kM),G.a.FX(this.ps,"text-align","start"))))}onClick(Z){if(0===this.state)return this.raiseEvent(n.a.Qo,new n.a(1,Z)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}Py(Z){3===this.state&&this.raiseEvent(n.a.Qo,new n.a(3,Z));return!1}jC(Z){3!==Z.Vf&&this.raiseEvent(n.a.Qo,new n.a(2,Z));return!1}Zua(Z){if(3!==Z.Vf)return!0;this.raiseEvent(n.a.Qo,new n.a(4,Z));return!1}qOd(){const Z=
document.createElement("img");Z.src=w.a.cK("doughperson_white_glyph.svg");Z.setAttribute("Unselectable","on");E.a.lO(Z,E.a.We,E.a.wM);return y.createClusteredImageFromClusterWithImageClass(this.hR,this.hR,null,null,C.OVd,"",!1,"",this.element.ownerDocument,Z)}mFd(Z,oa=!1,Ba=0){if(!this.Mia(this.state)||!this.Mia(Z))switch(Sys.UI.DomElement.removeCssClass(this.element,this.i_a),this.state){case 4:3===Z?this.sM(C.A5a,C.zZb):this.Mia(Z)&&this.sM(C.y5a,C.zZb);break;case 3:4===Z?this.sM(C.C5a,C.yZb):this.Mia(Z)&&
(oa&&this.Lhc(),this.sM(C.y5a,C.yZb,oa?C.NVd:""));break;case 0:case 1:case 2:4===Z?this.sM(C.C5a,C.B5a):3===Z&&(oa&&this.yFd(),this.sM(C.A5a,C.B5a,oa?C.AZb:"",3===Ba?C.QVd:C.PVd));break;default:4===Z?this.sM(C.C5a):3===Z?this.sM(C.A5a):this.Mia(Z)&&this.sM(C.y5a)}}sM(...Z){this.i_a=Z.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.i_a)}yFd(){this.pMb=window.setTimeout(()=>{this.element&&(this.kR=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.kR),this.element.style.zIndex=
"2",this.kR.style.zIndex="1")},300)}Lhc(){window.clearTimeout(this.pMb);this.kR&&(Sys.UI.DomElement.removeCssClass(this.kR,C.B5a+" "+C.AZb),Sys.UI.DomElement.addCssClass(this.kR,C.MVd),K.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.kR.parentNode&&this.element.parentNode.removeChild(this.kR)}),G.a.AEb(this.element,"z-index"))}Mia(Z){return 0===Z||1===Z||2===Z}G3d(Z,oa){const Ba=G.a.ZG(this.element.style.top);return G.a.ZG(this.element.style.left)===Z&&Ba===oa}Ceb(Z){3===
Z&&G.a.gP(this.element,"left")?(Z=G.a.ZG(this.element.style.left),G.a.AEb(this.element,"left"),this.element.style.right=-1*Z+"px"):4===Z&&G.a.gP(this.element,"right")&&(Z=G.a.ZG(this.element.style.right),G.a.AEb(this.element,"right"),this.element.style.left=-1*Z+"px")}}C.z5a="prModernFlyout UIFont";C.C5a="flyoutIdle";C.A5a="flyoutExpanded";C.y5a="flyoutCollapsed";C.zZb="flyoutFromIdle";C.yZb="flyoutFromExpanded";C.B5a="flyoutFromCollapsed";C.AZb="flyoutStacked";C.NVd="flyoutFromStacked";C.MVd="flyoutFadeOut";
C.OVd="cui-img-cont-float cui-img-20by20";C.PVd="flyoutLtrDir";C.QVd="flyoutRtlDir";Object(J.a)(C,"ModernPresenceTooltipFlyoutControl",m.a,[]);class Y{constructor(Z,oa,Ba=2,Ma=4){this.offsetTop=Z;this.offsetLeft=oa;this.Mnc=Ba;this.V1b=Ma}}Object(J.a)(Y,"FlyoutsPositioningInfo",null,[]);var M=d(62);class P{constructor(Z=!1,oa=!1){this.Qi=Z;this.O_a=oa}yZd(Z,oa,Ba,Ma,za,ka,qa){const Ja=qa.y,xa=qa.height;var Ga=this.sXd(ka);const na=Ga+oa;za=Z*Ba+(Z-1)*za;Ba=null;1===Z||this.TKd(Ga,za,Ja,xa)?Z=new Y(0,
0,2):(Z=this.AVd(na,za,Ja,xa),Z.offsetTop-=Ga);this.O_a?Ba=new Y(0,0,void 0,this.Qi?4:3):(ka=this.rXd(ka,qa),Ga=Math.max(0,qa.x),qa=qa.width,oa=ka+oa,this.UKd(ka,Ma,Ga,qa)?Ba=new Y(0,0,void 0,this.Qi?3:4):this.VKd(oa,Ma,Ga)&&(Ba=new Y(0,0,void 0,this.Qi?4:3)),Ba||(Ba=this.zVd(ka,oa,Ga,qa)));return new Y(Z.offsetTop,Ba.offsetLeft,Z.Mnc,Ba.V1b)}sXd(Z){return M.a.zKc(Z)}rXd(Z,oa){return this.Qi?oa.width-M.a.L6f(Z):M.a.yKc(Z)}TKd(Z,oa,Ba,Ma){return Z+oa<=Ba+Ma}AVd(Z,oa,Ba,Ma){let za=1,ka=Math.max(Ba,
Z-oa);oa>Z-Ba&&(za=2,ka=oa<Ma?Ma-oa:Ba);return new Y(ka,0,za)}UKd(Z,oa,Ba,Ma){return Z+oa<=Ba+Ma}VKd(Z,oa,Ba){return oa<=Z-Ba}zVd(Z,oa,Ba,Ma){Ma-oa>=Z-Ba?Z=4:(oa=Z,Z=3);return new Y(0,oa,void 0,Z)}}Object(J.a)(P,"ModernPresenceTooltipPositioner",null,[]);class T{constructor(Z,oa,Ba,Ma,za,ka,qa){this.zv=Z;this._parent=oa;this.aLb=Ba;this.Npd=Ma;this.utd=za;this.l6=ka;this.BH=qa;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(Z,
oa){if(3!==Z)if(5!==Z&&this.zv&&this.zv.length){if(4===Z){var Ba=this.utd;var Ma=(this.l6-Ba)/2;this.element.style.height=this.l6+"px";this.element.style.width=this.l6+"px";Z=G.a.ZG(this.zv[0].element.style.top);oa=G.a.ZG(this.BH?this.zv[0].element.style.right:this.zv[0].element.style.left)}else Ba=this.aLb,Ma=(this.l6-Ba)/2,this.element.style.height=this.l6+"px",this.element.style.width=this.HXd()+2*Ma+"px",Z=G.a.ZG(this.zv[this.zv.length-1].element.style.top),oa=this.IKd(this.zv[this.zv.length-
1].element,Ba,oa);G.a.FX(this.element,"border-radius",this.l6+"px");this.element.style.top=Z-Ma-Ba+"px";this.BH?this.element.style.right=oa-Ma+"px":this.element.style.left=oa-Ma+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}IKd(Z,oa,Ba){return this.BH&&!Ba?G.a.ZG(Z.style.right):this.BH||Ba?this.BH&&Ba?-G.a.ZG(Z.style.left)-oa:-G.a.ZG(Z.style.right)-oa:G.a.ZG(Z.style.left)}HXd(){return this.zv&&
this.zv.length?this.aLb+Math.min(this.zv.length-1,2)*this.Npd:0}}Object(J.a)(T,"ModernPresenceTooltipTarget",null,[]);var L=d(73),aa=d(114),Q=d(196);class ea extends m.a{constructor(Z,oa,Ba){super(Z);this.f6=this.uH=this.qNb=this.pY=!1;this.xf=[];this.iya={};this.Gc=Ba;this.Qi=Ba.get(8,!1);this.bNb=Ba.get(15,!1);this.xqd=Ba.get(12,0);this.QR=Ba.get(6,0);this.Q1a=oa;this.XRb=Ba.get(16);this.O_a=Ba.get(17,!1);this.wtd=Ba.get(19,!1);this.rzd=Ba.get(20,!1);this.oya=0;this.kzd=new P(this.Qi,this.O_a);
this.gfa=this.q_b();this.i1a=!1;this.cM=[];this.Kfa=[];this.element.id=ea.P5a();this.element.className=m.a.ypb("prControl",this.Qi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Qi;this.rfb(oa);this.rE=this.createElement("div");this.rE.className="prFlyoutContainer";this.element.appendChild(this.rE);this.zv=[];this.pR=new T(this.zs,this.element,this.QR,4,6,32,this.Qi);this.Ko=Ba.get(9);this.Ko.ob(u.a.pointerDown,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));this.Ko.ob(u.a.pointerOver,
this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));this.Ko.ob(u.a.pointerOut,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"))}get Adb(){return Q.a.clone(this.xf)}get zs(){return this.zv}get defaultZIndex(){return this.xqd}get SM(){return this.zs?this.zs.length:0}get kU(){return 0<this.SM?this.zs[0].state:5}get e8a(){return 3===this.kU&&!this.pY}VU(Z){this.addHandler(n.a.Qo,Z)}S_(Z){this.removeHandler(n.a.Qo,Z)}dispose(){if(this.e8a)this.i1a=!0;else{if(this.zs)for(const Z of this.zs)Z.S_(Object(e.a)(this,
this.sF,"onInteractivityChanged")),aa.a.ex(Z);this.zv=null;this.Ko.xb(u.a.pointerDown,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));this.Ko.xb(u.a.pointerOver,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));this.Ko.xb(u.a.pointerOut,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));super.dispose()}}Bea(){this.TY();this.visible=!0}igb(){this.visible=!0;this.LYb();this.pY=!0}swa(){this.igb()}hide(){this.Mhc();this.ZM();this.pR.update(this.kU,this.f6)}lz(Z){const oa=this.kU,
Ba=this.pY;Z.clientId||(Z.clientId=(ea.Pfa++).toString());if(Z.clientId in this.iya){var Ma=this.gS(Z.clientId);if(0<=Ma){Ma=this.xf[Ma];if(Ma.color===Z.color&&Ma.userName===Z.userName)return;this.BL(Z.clientId)}}this.hide();Ma=new C(this.createElement("div"),this.Gc);Ma.VU(Object(e.a)(this,this.sF,"onInteractivityChanged"));this.rE.insertBefore(Ma.element,this.rE.firstChild);this.iya[Z.clientId]=Ma;Array.add(this.xf,Z);Array.add(this.zs,Ma);this.rnc(oa,Ba);this.visible=!0}BL(Z){if(this.e8a)Array.add(this.Kfa,
Z);else{var oa=this.kU,Ba=this.pY;this.hide();this.hma(Z);this.rnc(oa,Ba)}}rcb(Z){const oa=this.gS(Z);if(!(0>=oa)){var Ba=this.xf[oa];Z=this.iya[Z];Array.removeAt(this.xf,oa);Array.insert(this.xf,0,Ba);Array.removeAt(this.zs,oa);Array.insert(this.zs,0,Z);this.rE.removeChild(Z.element);this.rE.appendChild(Z.element);this.TY()}}rnc(Z,oa){0>=this.xf.length?this.hide():3===Z&&oa?this.igb():this.Bea()}Nfb(Z,oa){oa?this.fFd(Z):this.Fhc(Z)}FYb(Z){if(this.e8a&&this.wtd)return!1;Z=ea.A6a(Z);if(this.rE!==Z&&
I.a.$ra(this.rE,Z))return!0;for(const oa of this.zs)if(I.a.$ra(oa.element,Z))return!0;return!1}position(Z,oa){this.element.style.top=oa+"px";this.element.style.left=Z+"px"}TY(Z=!1){if(!Z||this.uH){this.qNb&&this.Cjc(!0);var oa=Math.min(3,this.SM)-1;Z=0;var Ba=1,Ma=0;this.f6&&(Z=this.gfa,Ba=-1,Ma=-this.QR);for(let za=this.SM-1;za>oa;za--)this.zs[za].xkc(this.xf[za],-4*oa*Ba+Ma,0,!0,!1,!0,Z);for(;0<=oa;oa--)this.zs[oa].xkc(this.xf[oa],-4*oa*Ba+Ma,0,0<oa,Array.contains(this.cM,this.xf[oa].clientId),
oa!==this.oya,Z);this.oya=0;this.pR.update(0,this.f6);this.zIndex=this.defaultZIndex;this.pY=!1;this.Mhc(0);this.i1a&&this.dispose()}}LYb(){this.qNb&&this.Cjc(!1);this.zIndex=this.defaultZIndex+1;let Z,oa,Ba;({offsetX:oa,offsetY:Z,U1b:Ba}=this.tIe());for(let Ma=0;Ma<this.SM;Ma++)this.zs[Ma].kLe(this.xf[Ma],oa,Z+(this.QR+2)*Ma,Ma!==this.oya,Ba)}ZM(){let Z=0,oa=0;this.f6&&(Z=this.gfa,oa=-6);for(let Ba=0;Ba<this.SM;Ba++)this.zs[Ba].hide(this.xf[Ba],oa,Z);this.zIndex=this.defaultZIndex;this.visible=this.pY=
!1;this.i1a&&this.dispose()}Q3a(Z=0){Z?(this.uH=!0,K.Task.delay(Z).continueWith(()=>{this.bNb?this.g4d():this.TY(!0);this.uH=!1})):this.bNb?this.hide():this.TY()}g4d(){this.uH&&this.hide()}uJd(){if(A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.gb.Q7&&L.c()){const Z=appChrome.selectors.getShyState();return Z.isActive&&0!==Z.state}return!1}sF(Z,oa){Z=this.kU;this.uJd()||2!==oa.type&&(4!==oa.type||3===Z)?4===oa.type&&3===Z?(this.uH&&(this.uH=!1),this.Q3a()):3!==oa.type||3!==Z||this.pY||(1<this.SM?
(this.uH=!0,K.Task.delay(250).continueWith(()=>{this.TY(!0);this.uH=!1})):this.Q3a()):(this.uH&&(this.uH=!1),3!==Z&&(this.LYb(),3===oa.Ti.Vf&&this.Q3a(2E3)));this.raiseEvent(n.a.Qo,oa)}D9(Z){3===Z.Vf?this.sF(this,new n.a(4,Z)):Z.eventName===u.a.pointerOver?this.sF(this,new n.a(2,Z)):Z.eventName===u.a.pointerOut&&this.sF(this,new n.a(3,Z));return!1}rfb(Z){this.element.style.width=Z+"px";this.element.style.height=this.QR+"px"}hma(Z){this.Fhc(Z);Z=this.gS(Z);if(!(0>Z)){var oa=this.xf[Z];Array.removeAt(this.xf,
Z);delete this.iya[oa.clientId];oa=this.zs[Z];this.rE.removeChild(oa.element);this.Gc.get(18,!1)&&oa.S_(Object(e.a)(this,this.sF,"onInteractivityChanged"));Array.removeAt(this.zs,Z);oa.dispose()}}Mhc(Z=5){if(this.Kfa.length){this.visible&&this.ZM();for(let oa=0;oa<this.Kfa.length;oa++)this.hma(this.Kfa[oa]);Array.clear(this.Kfa);0>=this.xf.length||5===Z?this.hide():0===Z&&this.Bea()}}gS(Z){for(let oa=0;oa<this.xf.length;oa++)if(this.xf[oa].clientId===Z)return oa;return-1}fFd(Z){if(-1===this.gS(Z))h.ULS.sendTraceTag(41706451,
302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.cM,Z)){if(this.xf[0].clientId===Z)return;Array.remove(this.cM,Z)}Array.add(this.cM,Z);this.rcb(Z);1!==this.kU&&this.TY()}}Fhc(Z){-1===this.gS(Z)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.cM,Z)&&(Array.remove(this.cM,Z),this.xf[0].clientId===Z&&0<this.cM.length&&this.rcb(this.cM[this.cM.length-1]),this.xf[0].clientId===Z&&1===this.kU&&
this.TY())}Cjc(Z){Z?Sys.UI.DomElement.addCssClass(this.rE,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.rE,"prBackgroundSelection")}tIe(){let Z,oa;oa=Z=0;var Ba=this.gfa;if(this.XRb){const Ma=this.XRb(this);if(!Ma)return{offsetX:Z,offsetY:oa,U1b:Ba};const za=4===this.kU;Ba=this.kzd.yZd(this.SM,za?6:this.QR,this.QR,150,2,this.element,Ma);oa=Ba.offsetTop;this.oya=this.oZd(Ba.Mnc,Ba.offsetTop);Ba=Ba.V1b;Ba!==this.gfa&&(this.Ceb(Ba),this.element.dir=3===Ba?"rtl":"ltr",this.gfa=Ba);Ba!==
this.q_b()?(Z=this.rzd?-2:za?-6:-this.QR,this.f6=!0):this.f6=!1}return{offsetX:Z,offsetY:oa,U1b:Ba}}oZd(Z,oa){if(1===Z)return this.SM-1;Z=Math.abs(oa);return 0<Z?Z/(this.QR+2):0}Ceb(Z){for(let oa=0;oa<this.SM;oa++)this.zs[oa].Ceb(Z)}q_b(){return this.Qi?3:4}static P5a(){return String.format("{0}-{1}","presencetooltip",ea.Pfa++)}static A6a(Z){return Z.lc.rawEvent.relatedTarget}}ea.Pfa=0;Object(J.a)(ea,"ModernPresenceTooltipControl",m.a,[494,106]);var ia=d(218),ja=d(283),D=d(264);d.d(V,"a",function(){return pa});
class pa{constructor(Z){this.Gc=Z;this.Gc.WC(10,ia.a.instance);this.Gc.WC(9,D.a.instance);this.Gc.WC(6,20);this.Gc.WC(13,ja.a.instance);this.Gc.WC(17,!1)}NEc(Z,oa){this.Gc.WC(15,!1);return new ea(Z,oa,this.Gc)}spb(Z){this.Gc.WC(15,!1);return new ea(Z,20,this.Gc)}}Object(J.a)(pa,"ModernPresenceTooltipFactory",null,[493])},1205:function(J,V,d){d.r(V);J=d(0);var h=d(336),e=d(68),m=d(424),n=d(1158),v=d(72);class A{constructor(Ha){this.fe=Ha}IOd(Ha,cb,Za,va,Fa,Ca){const La=this.fe.Yj(Za+".png");Za=v.getImageClassWithCluster(Za,
va);return v.createClusteredImageFromClusterWithImageClass(Ha,cb,Za,La,32===Ha&&32===cb?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,Fa,null,Ca)}}Object(J.a)(A,"ShapeGlyphImageFactory",null,[339]);var w=d(25),y=d(434),u=d(67);class E{constructor(Ha,cb){this.HYc=this.YZ=null;this.ife=this.xKg=0;this.ve=Ha;this.Hc=cb}dispose(){this.clear();this.YZ.parentNode.removeChild(this.YZ)}add(Ha,cb){this.eIe(!1);Ha=this.Y_h(Ha,cb);this.dGj()||this.yNj(Ha)?this.dIe(-1*(Math.ceil(Ha.offsetWidth)+
2)):this.dIe(this.ife);this.eIe(!0)}clear(){this.ve.$t(this.HYc);this.eIe(!1);this.dIe(0)}$ga(Ha,cb,Za){this.xKg=Za;this.ife=cb;this.YZ=this.ve.Ee();this.YZ.className="prFlyout UISmallFont";Ha.appendChild(this.YZ);this.HYc=this.ve.FWb();this.YZ.appendChild(this.HYc)}Y_h(Ha,cb){const Za=this.ve.dSf();Za.style.backgroundColor=Ha;Za.style.lineHeight=this.ve.Lc(this.xKg);this.ve.ix(Za,cb);this.HYc.appendChild(Za);return Za}yNj(Ha){Ha=this.ve.Yh(Ha);const cb=this.ve.Yh(this.Hc.Jc.rC);return Ha.x+Ha.width+
this.ife>cb.x+cb.width}dGj(){return 0>this.ve.jn(this.YZ.style.left)}eIe(Ha){this.YZ.style.visibility=Ha?u.a.visible:u.a.hidden}dIe(Ha){this.YZ.style.left=this.ve.Lc(Ha)}}Object(J.a)(E,"ShapePawnFlyout",null,[647]);var G=d(674),I=d(999),H=d(1099),K=d(13),C=d(321),Y=d(26),M=d(47),P=d(111);class T{constructor(Ha,cb,Za,va,Fa){this.nUb=1;this.F$b=[];this.T9a=null;this.e7b=this.wzb=!1;this.KUa=this.Wh=this.It=null;(this.Ix=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))?(this.Wh=Ha,
this.KUa=Fa,this.rzi()):this.Sq=Object(n.a)(y.a,va.oPd(Ha,cb,Za,Object(K.a)(this,this.jC,"onPointerOver"),Object(K.a)(this,this.Py,"onPointerOut"),Fa))}gia(){if(this.Ix)return this.Z9i();const Ha=Array.clone(this.Yda);if(this.kV){let cb=!1;for(const Za of this.Yda)if(Za.clientId===this.kV.clientId){cb=!0;break}cb||Array.add(Ha,this.kV)}return Ha}dispose(){this.Ix?this.ZGi():(this.F$b=this.T9a=null,this.Sq.dispose())}lz(Ha){if(this.Ix)this.Z1h(Ha);else if(Ha){for(const cb of this.Yda)if(cb.clientId===
Ha.clientId)return;Array.add(this.Yda,Ha);this.refresh()}}BL(Ha){if(this.Ix)this.zOk(Ha);else if(Ha)for(const cb of this.Yda)if(cb.clientId===Ha.clientId){Array.remove(this.Yda,cb);this.refresh();break}}clear(){this.Ix?this.umi():(this.F$b=[],this.Sq.clear())}get kV(){return this.T9a}set kV(Ha){this.T9a!==Ha&&(this.T9a=Ha,this.T9a||(this.e7b=!1),this.Ix||this.refresh())}jLe(){this.Ix||(this.kV?(this.e7b=!0,this.kEb()):Y.a.J(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))}QLe(){this.Ix?
this.ycl():(this.wzb=!0,this.T9a&&(this.e7b=!0),this.kEb())}Z3d(){this.Ix?this.fsj():(this.wzb=!1,this.kEb())}setZIndex(Ha){this.Ix?this.N6k(Ha):this.Sq.setZIndex(Ha)}get Rda(){return this.kV?this.kV.color:this.Yda&&this.Yda.length?this.Yda[this.Yda.length-1].color:P.a.none}JOc(){return!!this.T9a||0<this.F$b.length}get Yda(){return this.Ix?this.It.Adb:this.F$b}Xrj(){this.Sq.XEb();this.Sq.Qob()}Py(){this.JOc()&&(this.wzb=!1,this.kEb());return!0}jC(){this.JOc()&&(this.wzb=!0,this.kEb());return!0}rul(){this.JOc()?
this.Sq.tfd(1<this.F$b.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",this.Rda):this.Sq.Qpa()}refresh(){this.rul();this.kEb()}kEb(){this.Xrj();if(this.wzb)if(this.kV){this.Sq.H2a(this.kV.color,String.format(ResourceStrings.l_TypingHint,this.kV.userName));for(const Ha of this.Yda)this.kV.clientId!==Ha.clientId&&this.Sq.H2a(Ha.color,Ha.userName)}else for(const Ha of this.Yda)this.Sq.H2a(Ha.color,Ha.userName);else this.e7b&&(this.kV?this.Sq.H2a(this.kV.color,String.format(ResourceStrings.l_TypingHint,
this.kV.userName)):Y.a.J(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));(this.wzb||this.e7b)&&this.Sq.Kbc()}Nfb(Ha,cb){this.It&&this.It.Nfb(Ha,cb)}ZGi(){this.It&&this.It.dispose()}rze(){return M.a.Yh(document.body)}Z1h(Ha){Ha?this.It?(Y.a.J(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",Ha.clientId),this.It.lz(Ha)):Y.a.J(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):
Y.a.J(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser")}zOk(Ha){Ha?this.It?(Y.a.J(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",Ha.clientId),this.It.BL(Ha.clientId)):Y.a.J(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):Y.a.J(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser")}umi(){if(this.It){Y.a.J(42472543,814,
50,"ShapePresencePawn:Clear at PresencePawn ");var Ha=this.gia();if(Ha)for(const cb of Ha)this.BL(cb);else Y.a.J(42472545,814,50,"ShapePresencePawn:Clear - Pawn has no users")}else Y.a.J(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}Z9i(){return this.It?this.It.Adb:null}ycl(){this.It&&(this.It.Bea(),this.It.swa())}fsj(){this.It&&this.It.Bea()}N6k(Ha){this.Wh.style.zIndex=String(Ha)}Qfj(Ha){const cb=new I.a;cb.add(0,v.getImageClassWithCluster(w.AFrameworkApplication.$M,
"MoreUsersGlyph_16x16x32"));cb.add(5,w.AFrameworkApplication.Vl);cb.add(1,v.getImageClassWithCluster(w.AFrameworkApplication.$M,"DoughboyWhiteGlyph_20x20x32"));cb.add(4,w.AFrameworkApplication.Vl);cb.add(6,20);cb.add(8,w.AFrameworkApplication.isRtl);cb.add(12,Ha);cb.add(11,!1);cb.add(16,Object(K.a)(this,this.rze,"presenceViewportBoundsCallback"));return new H.a(cb)}rzi(){this.It=this.Qfj(this.vag()).spb(this.Wh);Sys.UI.DomElement.addCssClass(this.It.element,"ShapePawnContainer")}ini(){const Ha=this.gia();
if(Ha)for(const cb of Ha)this.Nfb(cb.clientId,!1)}vag(){return this.nUb+C.a.z$+C.a.z$}Kbc(){this.KUa.ya.style.zIndex=String(this.vag())}}Object(J.a)(T,"ShapePresencePawn",null,[434,435,106,337]);var L=d(670);class aa{constructor(Ha,cb,Za,va,Fa){this.Vo=Ha;this.gd=cb;this.ve=Za;this.IFa=va;this.Hc=Fa;this.f_=w.AFrameworkApplication.fa.ka("1166")}iAi(Ha,cb,Za,va){this.f_?this.ve.addCssClass(Ha,"ShapeModernCatchupPawnContainer"):this.ve.addCssClass(Ha,"ShapePawnContainer");return new L.a(Ha,cb,"pegal",
this,Za,va)}gAi(Ha,cb,Za){this.ve.addCssClass(Ha,"ShapePawnContainer");return new T(Ha,cb,"per",this,Za)}oPd(Ha,cb,Za,va,Fa,Ca){return new y.a(Ha,cb,Za,va,Fa,null,this,this.IFa,this.ve,this.Vo,this.gd,Ca)}VSf(){return new E(this.ve,this.Hc)}WSf(){return new G.a(this.ve)}}Object(J.a)(aa,"ShapePawnFactory",null,[338]);var Q=d(54),ea=d(571),ia=d(130),ja=d(164),D=d(59),pa=d(60),Z=d(628),oa=d(140),Ba=d(173),Ma=d(190),za=d(183);class ka{constructor(Ha,cb,Za,va,Fa,Ca=16){this.eIg=!1;this.Sm=null;this.f_=
!1;this.xbc=this.RA=this.QA=0;this.yd=1;this.W7b=!1;this.Ib=this.D6b=!0;this.IG=!1;this.bT=!0;this.Wfe=!1;this.ZS=Ca;this.JFa=new oa.a;this.NZ=new Ma.a;this.Ow=new Ba.a;this.iF=new Ba.a;this.FG=new Ba.a;this.D3=new oa.a;this.HD=new za.a;this.Mt=new za.a;this.nb=Ha;this.Sq=cb?cb(this.D3.ya,this.ZS,Fa):null;this.ua=Za;this.Nja=va}dispose(){this.Nja();this.JFa&&(this.JFa.ya.parentNode&&this.JFa.iq(),this.NZ&&this.NZ.viewport&&this.NZ.viewport.iq(),this.Ow&&this.Ow.iq(),this.iF&&this.iF.iq(),this.FG&&
this.iF.iq());this.Sq&&this.Sq.dispose();this.D3=this.FG=this.iF=this.Ow=this.NZ=this.JFa=null;this.Ib=!1}get nnh(){return this.Sq}get shape(){return this.ua}get S7a(){return this.eIg}set S7a(Ha){this.ZS=Ha?20:16;this.eIg=Ha}get Dug(){return this.f_}set Dug(Ha){this.ZS=16;this.f_=Ha}$m(Ha){this.JFa.appendChild(this.NZ.viewport);this.JFa.appendChild(this.D3);this.Ow.BF(P.a.none);this.f_?this.Ow.zr(pa.a.RJe):this.Ow.zr(pa.a.UJe);this.iF.BF(P.a.none);this.iF.zr(Z.a.IDc);this.FG.BF(P.a.none);this.FG.zr(Z.a.TMd);
this.NZ.appendChild(this.FG);this.NZ.appendChild(this.iF);this.NZ.appendChild(this.Ow);this.setVisibility();this.dYf();Ha.appendChild(this.JFa)}XD(){}kq(){return this.NZ.kq()}kub(){return!1}Ux(){}setVisibility(){const Ha=this.Ib&&(!this.IG||!this.bT);this.D3.Qd(Ha);this.Ow.Qd(Ha);this.iF.Qd(Ha);this.FG.Qd(Ha);this.JFa.Qd(this.Ib)}nz(){}XE(){return null}QD(){return[]}dYf(){this.Sm=this.ua.Fq.copy();this.Ow.zr(this.Wfe?Z.a.cPf:this.f_?pa.a.RJe:pa.a.UJe);this.iF.zr(Z.a.IDc);this.FG.zr(Z.a.TMd);this.Ws();
this.setVisibility()}draw(){this.visible=!0;this.dYf()}get visible(){return this.Ib}set visible(Ha){this.Ib!==Ha&&(this.Ib=Ha,this.setVisibility(),this.Ws())}get Qnb(){return this.D6b}set Qnb(Ha){this.D6b=Ha;this.Ow.Qd(this.Ib&&this.D6b);this.iF.Qd(this.Ib&&this.D6b);this.FG.Qd(this.Ib&&this.D6b)}setPosition(Ha,cb){this.QA=Ha;this.RA=cb;this.Ws()}Ej(Ha){this.yd=Ha;this.Ws()}Uq(Ha){this.HD=Ha;this.Ws()}pv(Ha){this.Mt=Ha;this.Ws()}setZIndex(Ha){this.xbc=Ha;this.JFa.uC(this.xbc);this.NZ.uC(this.xbc);
this.D3.uC(this.xbc);this.Sq&&this.Sq.setZIndex(this.xbc)}AF(Ha,cb){this.IG=Ha;this.bT=cb;this.setVisibility()}fJb(Ha=null){this.Sq&&this.Ow.qv(Ha||this.Sq.Rda);this.Ow&&(this.Ow.Hma(""),this.Ow.BF(P.a.none),this.f_?this.Ow.zr(pa.a.RJe):this.Ow.zr(pa.a.UJe),this.Ow.FX(""))}rmi(){this.Ow&&this.iF&&this.FG&&(this.Wfe=!1,this.Ow.FX(""),this.iF.FX(""),this.Ow.qv(P.a.none),this.Ow.iwa(0),this.iF.qv(P.a.none),this.iF.iwa(0),this.FG.qv(P.a.none),this.FG.iwa(0))}lSe(Ha,cb=!1){if(this.Ow&&this.iF&&this.FG){this.Wfe=
!0;var Za=0===Ha;this.Ow.zr(Z.a.cPf);this.iF.zr(2===Ha?Z.a.opi:Z.a.IDc);this.FG.zr(Z.a.TMd);this.Ow.qv(Za?P.a.none:Z.a.mpi);this.iF.qv(Za?P.a.none:Z.a.ipi);switch(Ha){case 2:this.FG.qv(Z.a.lpi);break;case 1:this.FG.qv(Z.a.jpi);break;default:this.FG.qv(Z.a.kpi)}1===Ha?this.H1f():cb?this.H1f():(this.Ow.iwa(1),this.iF.iwa(1),this.FG.iwa(1))}}H1f(){this.I1f(0)}I1f(Ha){this.Ow&&this.iF&&this.FG&&!(1<Ha)&&(Ha+=.05,this.Ow.iwa(Ha),this.iF.iwa(Ha),this.FG.iwa(Ha),window.setTimeout(()=>{this.I1f(Ha)},10))}Ws(){if(this.Sm){var Ha=
this.Sm.copy();this.HD.il(Ha);this.Mt.il(Ha);Ha.move(this.QA,this.RA);Ha.scale(this.yd,this.yd);this.dtl(Ha);this.yvl(Ha)}}dtl(Ha){if(this.Ow&&this.iF&&this.FG&&Ha){var cb=this.sKf(Z.a.npi,Ha),Za=this.sKf(Z.a.IDc,cb);this.FG.Qt(Za.points);this.NZ.jm();this.FG.Qd(this.Ib&&(!this.IG||!this.bT));this.iF.Qt(cb.points);this.NZ.jm();this.iF.Qd(this.Ib&&(!this.IG||!this.bT));this.Ow.Qt(Ha.points);this.NZ.jm();this.Ow.Qd(this.Ib&&(!this.IG||!this.bT));Q.a.s8a&&this.ua&&this.ua.nd&&this.nb.Tqg()&&this.NZ.viewport.yh(this.NZ.viewport.width,
0)}}bcc(){if(this.S7a){var Ha=this.D3.x,cb=this.D3.y;this.nb.WV(this.ua)&&!this.W7b&&(this.D3.setPosition(Ha,cb-18),this.W7b=!0)}}xse(){if(this.S7a){var Ha=this.D3.x,cb=this.D3.y;this.W7b&&!this.nb.WV(this.ua)&&(this.D3.setPosition(Ha,cb+18),this.W7b=!1)}}sKf(Ha,cb){var Za=cb.Zj(ja.a.ND),va=cb.Zj(ja.a.qu);Za=ea.a.cO(D.a.bG(va,Za));new D.a(0,0);let Fa;new D.a(0,0);let Ca;new D.a(0,0);new D.a(0,0);cb.rotate(-Za);const La=cb.points;va=new D.a(La[0]._x+Ha,La[0]._y+Ha);Fa=new D.a(La[1]._x-Ha,La[1]._y+
Ha);Ca=new D.a(La[2]._x-Ha,La[2]._y-Ha);Ha=new D.a(La[3]._x+Ha,La[3]._y-Ha);Ha=new ia.a(va,Fa,Ca,Ha);Ha.rotate(Za);cb.rotate(Za);return Ha}yvl(Ha){if(Ha){var cb=Ha.Zj(ja.a.ND),Za=Ha.Zj(ja.a.qu),va=ea.a.cO(D.a.bG(Za,cb));cb=Ha.Zj(ja.a.ND);Za=Ha.Zj(ja.a.qu);90<=va&&(cb=Ha.Zj(ja.a.qu),Za=Ha.Zj(ja.a.fH));180<=va&&(cb=Ha.Zj(ja.a.fH),Za=Ha.Zj(ja.a.cE));270<=va&&(cb=Ha.Zj(ja.a.cE),Za=Ha.Zj(ja.a.ND));va=D.a.bG(Za,cb);var Fa=this.w9i(va);Ha=Math.cos(va)*Fa;va=Math.sin(va)*Fa;Fa=this.S7a?this.ZS/2-1:this.f_?
this.ZS/2:this.ZS;this.f_?this.D3.setPosition(Za.x-Fa,Za.y-Fa):this.D3.setPosition(cb.x-Ha,cb.y-va-Fa);this.D3.Qd(this.Ib&&(!this.IG||!this.bT));this.S7a&&(this.W7b=!1,this.bcc())}}w9i(Ha){return(this.S7a?10:15)-ea.a.cO(Ha)/6}}Object(J.a)(ka,"ShapePawnView",null,[433]);class qa{pPd(Ha,cb,Za,va,Fa){return new ka(Ha,cb,Za,va,Fa,16)}}Object(J.a)(qa,"ShapePawnViewFactory",null,[340]);class Ja extends Sys.EventArgs{constructor(Ha){super();this.shape=Ha}}Object(J.a)(Ja,"ShapeViewElementPresenceStateChangedEventArgs",
Sys.EventArgs,[]);class xa{constructor(Ha,cb){this.wg=Ha;this.ua=this.wg.shape;this.ua.Lv=!1;this.iDg=new Ja(this.ua);this.Ao=Object(n.a)(T,this.wg.nnh);this.WQg=cb;(this.qFg=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.wg&&(this.wg.S7a=!0)}$m(Ha){this.wg.$m(Ha)}XD(Ha){this.wg.XD(Ha)}kq(){return this.wg.kq()}IP(Ha){return this.wg.kub(Ha)}Ux(Ha){this.wg.Ux(Ha)}bcc(){this.wg.bcc()}xse(){this.wg.xse()}dispose(){this.wg.dispose()}nz(){this.wg.nz()}XE(Ha){return this.wg.XE(Ha)}QD(Ha){return this.wg.QD(Ha)}draw(Ha,
cb){this.wg.draw(Ha,cb)}get visible(){return this.wg.visible}set visible(Ha){this.wg.visible=Ha}setPosition(Ha,cb){this.wg.setPosition(Ha,cb)}Ej(Ha){this.wg.Ej(Ha)}Uq(Ha){this.wg.Uq(Ha)}pv(Ha){this.wg.pv(Ha)}setZIndex(Ha){this.wg.setZIndex(Ha)}AF(Ha,cb){this.wg.AF(Ha,cb)}setSelection(){}wza(Ha){Ha&&(this.LTb(),this.Ao.lz(Ha),this.wg.fJb(),this.wg.setVisibility(),Y.a.J(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",Ha.clientId,this.Ao.Rda,
this.ua?this.ua.jr:"null_moniker"))}neb(Ha){if(Ha&&this.Ao){this.Ao.BL(Ha);this.wg.fJb();var cb=this.Ao.gia();cb&&cb.length?Y.a.J(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",Ha.clientId,this.Ao.Rda,this.ua?this.ua.jr:""):Y.a.J(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",Ha.clientId,this.ua?this.ua.jr:"null_moniker");this.wg.setVisibility();
this.anb()}}wNf(){this.Ao.clear();this.wg.fJb();this.anb()}jLe(){this.Ao.jLe()}Aal(){this.Ao.QLe()}pZ(){this.Ao.Z3d()}Kld(Ha){Ha&&this.LTb();this.Ao&&(this.Ao.kV=Ha);this.wg.fJb();this.qFg&&this.Ao&&(this.Ao.kV?this.Ao.Nfb(Ha.clientId,!0):this.Ao.ini());Ha||this.anb()}get BDb(){return this.Ao}get D3d(){return this.Ao.JOc()}get Qnb(){return this.wg.Qnb}set Qnb(Ha){this.wg.Qnb=Ha}LTb(){this.ua.Lv||this.D3d||(this.ua.Lv=!0,this.WQg.g$g(this.iDg))}anb(){this.ua.Lv&&!this.D3d&&(this.ua.Lv=!1,this.WQg.g$g(this.iDg))}}
Object(J.a)(xa,"ShapePresenceView",null,[386,387,388,106]);var Ga=d(276);class na{get name(){return"PowerPointWebEditor.ShapePresence"}Wb(Ha){Ha.register(336,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>").ma().na(()=>new Ga.a((cb,Za)=>{let va=null;const Fa=Object(n.a)(124,cb.oc(Ha.resolve("Box4.IPageView").Ma));Fa&&!Fa.ll&&(cb=Ha.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").pPd(Ha.resolve("PowerPointWebEditor.IPptSelectionManager"),
(Ca,La,nb)=>Object(n.a)(337,Ha.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").gAi(Ca,La,nb)),cb,Za,Fa.PT),va=new xa(cb,Ha.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier")),va.$m(Fa.PT),Fa.zza(va,1),va.visible=Fa.KP||Fa.Fn);return va}));Ha.register(338,"PowerPointWebEditor.ShapePresence.IShapePawnFactory").ma().na(()=>new aa(Ha.resolve("Common.IPointerInputManager"),Ha.resolve("Common.IClickInputManager"),Ha.resolve("PowerPoint.IBrowserHelperManager"),Ha.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),
Ha.resolve("PowerPointWebEditor.IActiveSlideViewManager")));Ha.register(339,"PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory").ma().na(()=>new A(Ha.resolve("PowerPoint.IPathManager")));Ha.register(340,"PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").ma().na(()=>new qa)}init(){}dispose(){}static main(){e.a.instance.Ac(new na)}}Object(J.a)(na,"PPTWebEditorShapePresencePackage",null,[2,3]);class sa{constructor(){this.K=null;this.HW=[new na]}get name(){return"PowerPointWebEditor.ExtCommonPackage"}Wb(Ha){this.K=
Ha;for(const cb of this.HW)cb.Wb(Ha)}init(){for(const Ha of this.HW)Ha.init();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Tsg=!0;h.a.instance.ic(m.a.UTd,(new Date).getTime())}dispose(){}static main(){h.a.instance.ic(m.a.WTd,(new Date).getTime());e.a.instance.Ac(new sa)}}Object(J.a)(sa,"PptExtCommonPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.ShapePresence");Type.registerNamespace("Common.App.CollabControls");sa.main();
na.main()},227:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(77);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=
String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}lx(){return!0}static ypb(e,m){return e+(m?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[106,492])},228:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.type=e;this.Ti=m}}h.Qo="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",
Sys.EventArgs,[])},276:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(985);class e{constructor(m){this.Nk=new h.a;this.sVa=m}xP(m){const n=m.id;let v=null;this.Nk.Jb(n)?v=this.Nk.ga(n):(this.sVa&&(v=this.sVa(m,()=>{this.Jhc(n)})),v&&this.Nk.$(n,v));return v}VE(m){m=m.id;return this.Nk.Jb(m)?this.Nk.ga(m):null}Jhc(m){this.Nk.remove(m)}}Object(J.a)(e,"ShapeComponentViewManager",null,[336])},434:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(65),e=d(13),m=d(321),n=d(111);
class v{constructor(A,w,y,u,E,G,I,H,K,C,Y,M){this.nUb=1;this.ZS=w;this.Wh=A;this.see=y;this.ve=K;this.Vo=C;this.gd=Y;this.IFa=H;this.iFa=E;this.jFa=u;this.FN=G;this.ve.addCssClass(this.Wh,"prControl");this.Wh.style.width=this.ve.Lc(w);this.pr=I.WSf();this.wEa=I.VSf();this.pr.$ga(A);this.wEa.$ga(A,w,w);this.KUa=M;this.Xla()}dispose(){this.Zmc();this.clear();this.pr.dispose();this.wEa.dispose();this.ve.removeCssClass(this.Wh,"prControl")}get Rda(){return n.a.none}clear(){this.Qpa();this.Qob();this.XEb()}setZIndex(A){this.Wh.style.zIndex=
String(A)}Kbc(){this.KUa.ya.style.zIndex=String(this.nUb+m.a.z$)}XEb(){this.KUa.ya.style.zIndex="0"}tfd(A,w,y=null){A=this.IFa.IOd(this.ZS,this.ZS,this.see,A,"",y);this.pr.cIa(A,w)}H2a(A,w){this.wEa.add(A,w)}Qob(){this.wEa.clear()}Qpa(){this.pr.clear()}onClick(){return!0}Xla(){this.jFa&&this.Vo.ob(h.a.pointerOver,this.Wh,this.jFa);this.iFa&&this.Vo.ob(h.a.pointerOut,this.Wh,this.iFa);this.FN?this.gd.ob(h.a.click,this.Wh,this.FN):this.gd.ob(h.a.click,this.Wh,Object(e.a)(this,this.onClick,"onClick"));
this.gd.ob(h.a.doubleClick,this.Wh,Object(e.a)(this,this.onClick,"onClick"))}Zmc(){this.jFa&&this.Vo.xb(h.a.pointerOver,this.Wh,this.jFa);this.iFa&&this.Vo.xb(h.a.pointerOut,this.Wh,this.iFa);this.FN?this.gd.xb(h.a.click,this.Wh,this.FN):this.gd.xb(h.a.click,this.Wh,Object(e.a)(this,this.onClick,"onClick"));this.gd.xb(h.a.doubleClick,this.Wh,Object(e.a)(this,this.onClick,"onClick"))}}Object(J.a)(v,"ShapePawn",null,[337])},670:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(1158),e=
d(13),m=d(100),n=d(35),v=d(26),A=d(434),w=d(111);class y{constructor(u,E,G,I,H,K){this.h1a=this.oEa=null;this.Sq=Object(h.a)(A.a,I.oPd(u,E,G,Object(e.a)(this,this.jC,"onPointerOver"),Object(e.a)(this,this.Py,"onPointerOut"),H));this.pFa=0;this.Mc=K;this.Mc.tB(Object(e.a)(this,this.VA,"onSessionEnd"));this.clear()}dispose(){this.Sq.dispose();this.oEa=null}get Rda(){return this.h1a}setZIndex(u){this.Sq.setZIndex(u)}zBf(u,E,G){this.h1a=u;this.oEa=E;this.Sq.tfd("UnreadNotification_16x16x32",this.Rda,
G)}clear(){this.Sq.clear();this.h1a=w.a.none}vwa(){this.pZ();this.Sq.H2a(this.Rda,this.BXb);this.Sq.Kbc()}pZ(){this.Sq.Qob();this.Sq.XEb()}VA(){v.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.pFa);0<this.pFa&&m.c(n.a.lLd)}get BXb(){return this.oEa?this.oEa():""}jC(){this.vwa();v.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.pFa+=1;return!0}Py(){this.pZ();return!0}}Object(J.a)(y,"ShapeRevisionTrackingPawn",null,[337])},674:function(J,V,d){d.d(V,"a",
function(){return e});J=d(0);var h=d(67);class e{constructor(m){this.r8=this.Uja=null;this.ve=m}dispose(){this.clear();this.Uja.parentNode.removeChild(this.Uja)}$ga(m){this.Uja=this.mWb(m,"prContainerHr");this.r8=this.mWb(this.Uja,"prGlyph")}clear(){this.dma()}cIa(m,n){m&&(this.dma(),this.r8.appendChild(m),this.r8.style.backgroundColor=n,this.Uja.style.visibility=h.a.visible)}mWb(m,n){const v=this.ve.Ee();this.ve.addCssClass(v,n);m.appendChild(v);return v}dma(){this.r8.firstChild&&this.r8.removeChild(this.r8.firstChild)}}
Object(J.a)(e,"ShapePawnGlyph",null,[])},999:function(J,V,d){J=d(0);var h;(function(m){m[m.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";m[m.peopleImageClassName=1]="peopleImageClassName";m[m.peopleImageClusterPath=4]="peopleImageClusterPath";m[m.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";m[m.imageDimension=6]="imageDimension";m[m.rtl=8]="rtl";m[m.pointerInputManager=9]="pointerInputManager";m[m.clickInputManager=10]="clickInputManager";m[m.vertical=
11]="vertical";m[m.zIndex=12]="zIndex";m[m.contextMenuInputManager=13]="contextMenuInputManager";m[m.imageDomElement=14]="imageDomElement";m[m.useIdleTooltip=15]="useIdleTooltip";m[m.viewportBoundsCallback=16]="viewportBoundsCallback";m[m.flipHorizontalDirection=17]="flipHorizontalDirection";m[m.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";m[m.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";m[m.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||(h={}));Object(J.b)("PresenceTooltipSettingKeys",
h);d.d(V,"a",function(){return e});class e{constructor(){this.ay={}}get(m,n=null){m=h[m];return"number"===typeof n?(n=this.ay[m])?Number.parseInvariant(n.toString()):0:this.ay[m]}add(m,n){this.ay[h[m]]=n}WC(m,n){h[m]in this.ay||(this.ay[h[m]]=n)}remove(m){delete this.ay[h[m]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.extcommon.js.map