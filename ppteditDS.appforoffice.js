'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1197:function(J,V,d){d.r(V);var h=d(0),e=d(17),m=d(375),n=d(288);class v{constructor(){this.jIh=new e.a}get SBc(){return this.jIh}z8i(O){m.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",O);const ca=new e.a;for(let Ta of this.SBc)for(let xb of Ta.Fcc)xb.id===O&&ca.add(xb);return ca}ydi(){var O=this.z8i("ContextMenuText");if(O&&0<O.count){const ca=Object.assign(new n.a,{ControlList:[]});for(let Ta of O)O=
Ta.qmc(),0<O.length&&Array.addRange(ca.ControlList,O);return ca}return null}uAf(O){this.SBc.add(O)}oNk(O){for(let ca of this.SBc)if(ca.PDf===O.PDf){this.SBc.remove(ca);break}}static hGi(O,ca,Ta=null){O=v.F_i(O);0<O.length&&(v.ofd(O,!1),Ta&&Ta(ca,O))}static F_i(O){const ca=[];if(O&&O.Fcc&&0<O.Fcc.count)for(let Ta of O.Fcc)if(Ta.controls&&0<Ta.controls.count)for(let xb of Ta.controls)if(xb.menuItems&&0<xb.menuItems.count)for(let Tb of xb.menuItems)Array.add(ca,Tb.id);return ca}static ofd(O,ca){if(O.length){var Ta=
[];for(const xb of O)Ta.push(appChrome.actions.updateControlEnabledDisabledState(xb,ca));appChrome.api.dispatch(Ta)}}}Object(h.a)(v,"ContextMenuExtensibilityCache",null,[1032,1033]);var A=d(25),w=d(417),y=d(103),u=d(68),E=d(13);class G{constructor(O,ca,Ta){this._id=O;this.LGh=ca;this.RIh=Ta;this.wqg=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get MGd(){return this.LGh}get Xoi(){return this.RIh}execute(O,ca,Ta){Ta=Ta||{};Ta.commandMode=this.wqg;ca.invokeAppCommand(this.MGd,this.Xoi,
Ta,(xb,Tb)=>{O.xZg(this.id,this.MGd,xb,Tb)})}}Object(h.a)(G,"AddinNativeActionBase",null,[761]);class I extends G{constructor(O,ca){super(1,O,ca);this.wqg=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(h.a)(I,"AddinTakeSnapshotAction",G,[]);class H{eRf(O,ca){let Ta=null;switch(O){case 1:Ta=new I(ca,this.RWd().getNativeActionName(O));break;case 2:Ta=new G(2,ca,this.RWd().getNativeActionName(O));break;case 3:Ta=new G(3,ca,this.RWd().getNativeActionName(O))}return Ta}RWd(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}
Object(h.a)(H,"AddinNativeActionManager",null,[739]);class K{invokeAppCommand(O,ca,Ta,xb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(O,ca,Ta,xb)}static getInstance(){K.Ja||(K.Ja=new K);return K.Ja}}K.Ja=null;Object(h.a)(K,"OSFAddinCommandsRuntimeManager",null,[738]);var C=d(77);class Y{constructor(){this.oYf=this.displayName=this.SVb=this.dJ=this.wL=null;this.isUpgraded=!1}qwg(O,ca){return this.wL.getStoreType().toLowerCase()===O.toLowerCase()&&this.wL.getSolutionId().toLowerCase()===
ca.toLowerCase()}}Object(h.a)(Y,"AddinCommandsResourceItem",null,[]);class M{constructor(){this.Tnd=null;this.Psd=0;this.qud=!1;this.Pa=new C.a;this.kNh=new e.a}k2h(O){this.Pa.addHandler("AddinCommandsLoadingMessageChanged",O)}get VSb(){return this.Tnd}CGb(O){O!==this.Tnd&&(this.Tnd=O,this.Pa.raiseEvent("AddinCommandsLoadingMessageChanged"))}C0k(){this.Psd++;this.VSb||this.CGb(CommonUIStrings.l_LoadingAddInsTitle)}bIe(){this.Psd--;this.Sbe()&&(this.qud?this.VSb!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&
this.CGb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.CGb(null))}Q1k(){this.qud=!0;this.CGb(CommonUIStrings.l_ErrorLoadingAddInsTitle)}RMf(){this.qud=!1;this.Sbe()?this.CGb(null):this.CGb(CommonUIStrings.l_LoadingAddInsTitle)}Sbe(){return 0>=this.Psd}get Ttb(){return this.kNh}t5a(O,ca,Ta=0){for(let xb of this.Ttb)if(xb.qwg(O,ca)&&(!xb.dJ||xb.dJ.DWi===Ta))return xb;return null}fBf(O,ca,Ta,xb){const Tb=new Y;Tb.wL=O;Tb.dJ=ca;Tb.SVb=Ta;Tb.displayName=xb;this.Ttb.add(Tb)}k0h(O,ca,Ta,xb){const Tb=new Y;
Tb.wL=O;Tb.dJ=ca;Tb.SVb=null;Tb.oYf=Ta;Tb.displayName=xb;this.Ttb.add(Tb)}WMk(O,ca){let Ta=0;for(let xb of this.Ttb)xb.wL.getStoreType()===O&&xb.wL.getSolutionId()===ca?this.Ttb.removeAt(Ta):Ta++}static getInstance(){M.Ja||(M.Ja=new M);return M.Ja}}M.Ja=null;Object(h.a)(M,"AddinCommandsResourceManager",null,[]);var P=d(229),T=d(530),L=d(167),aa=d(141);class Q extends Sys.EventArgs{constructor(){super();this.dJ=this.hu=null}}Object(h.a)(Q,"InsertionParamEventArgs",Sys.EventArgs,[]);class ea{constructor(O,
ca,Ta,xb,Tb,wc){this.Dx=O;this.hu=ca;this.R9=Ta;this.displayName=Tb;this.Uyg=wc}}Object(h.a)(ea,"PostLaunchAddinCommandsParameters",null,[]);var ia=d(33),ja=d(45),D=d(1158);class pa{constructor(O,ca,Ta,xb=null){this.Cic=A.AFrameworkApplication.fa.Ha("RoamingServiceHandlerWebServiceBase");this.appName=O;this.TMb=ca;this.QMb=Ta;this.PPb=xb}jIc(O){this.eNi(O)}eNi(O){const ca=new Sys.StringBuilder(this.Cic);ca.append("RoamingServiceHandler.ashx?action=");ca.append("getAddinTeachingCalloutSettings");ca.append("&");
ca.append(this.R_d(O));ca.append("&");ca.append(A.AFrameworkApplication.Zg);A.AFrameworkApplication.He.vj(ca.toString(),1,null,null,!0,2,Object(E.a)(this,this.WBa,"getRequestSuccessCallback"),Object(E.a)(this,this.hia,"getRequestFailureCallback"),null)}Fqb(O){this.lNi(O)}lNi(O){var ca=new Sys.StringBuilder(this.Cic);ca.append("RoamingServiceHandler.ashx?action=");ca.append("saveAddinTeachingCalloutSettings");ca.append("&");ca.append(A.AFrameworkApplication.Zg);ca=ca.toString();O=ia.c(O);A.AFrameworkApplication.He.vj(ca,
2,O,null,!0,4,null,Object(E.a)(this,this.J9,"postRequestFailureCallback"),null)}WBa(O){let ca=!1,Ta=null;try{if(0<O.data.Zd.length){const xb=Object(D.a)(Object,ia.a(O.data.Zd)),Tb=xb?xb[this.appName]:null;Tb&&(Ta=Object(D.a)(Object,ia.a(Tb.toString())))}ca=!0}catch(xb){this.hia(null)}ca&&this.TMb&&this.TMb(Ta)}hia(O){this.QMb&&this.QMb(O?O.data:null)}J9(O){this.PPb&&this.PPb(O?O.data:null)}R_d(O){const ca=new Sys.StringBuilder("requestedsettings=");for(let Ta=0;Ta<O.count;Ta++)ca.append(O.ga(Ta)),
Ta<O.count-1&&ca.append(";");return ca.toString()}}Object(h.a)(pa,"AddinTeachingUIRoamingRequestHandler",null,[]);var Z=d(194);class oa{constructor(O,ca,Ta){this.Bic=!1;this.D$=null;this.Pa=O;this.xNb=ca;this.pKb=Ta}xFd(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(E.a)(this,this.yve,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(E.a)(this,this.Pue,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",
Object(E.a)(this,this.Cue,"onCloseButtonClickedEventHandler"),!0),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(E.a)(this,this.Ncc,"onCampaignLaunchedHandler"),!0)):m.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}yve(){const O={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:oa.yV(this.xNb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};this.pKb&&this.pKb.tabs&&!this.pKb.tabs[0].isOfficeTab&&(O["SDX.FeatureFlags"]="NonOfficeTab");aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:L.a.dD(O)}));A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa();this.pKb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.pKb,()=>{const ca=new Q;ca.hu=this.xNb;this.Pa.raiseEvent(P.a.mbe,
ca)}):m.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}Cue(){const O={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:oa.yV(this.xNb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:L.a.dD(O)}));A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.jGa()}Pue(){const O={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:oa.yV(this.xNb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:L.a.dD(O)}));A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa()}Ncc(O){if(O&&(O=O.detail)&&O.id&&this.D7d(O.id)){const Ta=(O.action||
"").toLowerCase();if(O.success&&"opened"===Ta){var ca={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:oa.yV(this.xNb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:L.a.dD(ca)}));m.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.jGa();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(E.a)(this,this.Ncc,"onCampaignLaunchedHandler"),!0)}else try{ca=JSON.stringify(O),m.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+ca)}catch(xb){ca="id : "+O.id+" telemetryEventName: "+O.telemetryEventName,m.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+ca+" Error: "+(xb?xb.toString():""))}}}D7d(O){O=ja.a.sg(O);return-1!==O.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==O.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==O.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==O.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==O.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==O.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}wma(O){const ca=A.AFrameworkApplication.fa.Ha("WebAppShortName");if(ca){const Ta={},xb={};xb.LastTeachingUIShowTime=(new Date).toUTCString();xb.AddinHasShown=O;Ta[ca]=ia.c(xb);this.D$=new pa(ca,null,null,Object(E.a)(this,this.J9,"postRequestFailureCallback")),this.D$.Fqb(Ta),m.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else m.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}jGa(){if(!this.Bic){const O=window.g_roamingAddinList;O&&(this.wma(O),this.Bic=!0)}}J9(O){m.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.af:-1)}static yV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}}Object(h.a)(oa,"PrivateCatalogTeachingCalloutHandler",null,[]);var Ba=d(14),Ma=d(15),za=d(961);class ka{constructor(){this.addinId=
null;this.targetType=0;this.solutionId=null}}Object(h.a)(ka,"AddinAbstract",null,[]);class qa extends Sys.EventArgs{constructor(O){super();this.solutionId=O.solutionId;this.assetId=O.assetId;this.storeType=O.storeType;this.storeId=O.storeId;this.assetStoreId=O.assetStoreId;this.targetType=O.targetType;this.width=O.width;this.height=O.height;this.displayName=O.displayName;this.version=O.version}}Object(h.a)(qa,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Ja=d(123);class xa{constructor(O){this.Ymb=
this.hu=null;this.Bic=!1;this.jKa=this.Goc=this.nHa=this.yn=this.D$=this.X_=null;this.hp=O}get appName(){return A.AFrameworkApplication.fa.Ha("WebAppShortName")}get rDf(){this.D$||(this.D$=new pa(this.appName,Object(E.a)(this,this.WBa,"getRequestSuccessCallback"),Object(E.a)(this,this.hia,"getRequestFailureCallback"),Object(E.a)(this,this.J9,"postRequestFailureCallback")));return this.D$}get TMa(){this.Goc||(this.Goc=new e.a);return this.Goc}set TMa(O){this.Goc=O}get Y3a(){this.jKa||(this.jKa=new e.a);
return this.jKa}set Y3a(O){this.jKa=O}xFd(O,ca){window.addEventListener?(this.hu=O,this.Ymb=ca,window.addEventListener("LaunchAddinTaskpane",Object(E.a)(this,this.yve,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(E.a)(this,this.Pue,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(E.a)(this,this.Cue,"onCloseButtonClickedEventHandler"),!0),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&window.addEventListener("FGWebSurfaceEvent",Object(E.a)(this,this.Ncc,"onCampaignLaunchedHandler"),!0)):m.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}Iol(O,ca,Ta,xb){this.yn=O;this.TMa=ca;this.Y3a=Ta;this.nHa=xb;m.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",ca?ca.count.toString():"null",Ta?Ta.count.toString():"null");0<this.TMa.count||0<this.Y3a.count?(O=new e.a,
O.add(this.appName),this.rDf.jIc(O)):this.nHa(new e.a,null)}yve(){const O=new Ba.ScriptSharpLegacyMap;this.Ymb&&this.Ymb.tabs&&!this.Ymb.tabs[0].isOfficeTab&&O.$("SDX.FeatureFlags","NonOfficeTab");this.JDa(xa.yV(this.hu),"ClickOnLaunch",O);A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa();this.Ymb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Ymb,()=>{const ca=new Q;ca.hu=this.hu;this.hp.raiseEvent(P.a.mbe,ca)}):m.ULS.sendTraceTag(525112602,
220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}Cue(){this.JDa(xa.yV(this.hu),"ClickOnClose");A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa()}Pue(){this.JDa(xa.yV(this.hu),"ClickOnDismiss");A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.jGa()}Ncc(O){if(O&&(O=O.detail)&&O.id&&this.D7d(O.id)){const ca=(O.action||"").toLowerCase();if(O.success&&
"opened"===ca)this.JDa(xa.yV(this.hu),"CampaignLaunched"),m.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.jGa(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(E.a)(this,this.Ncc,"onCampaignLaunchedHandler"),!0);else{let Ta;try{Ta=JSON.stringify(O),m.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ta)}catch(xb){Ta="id : "+O.id+" telemetryEventName: "+O.telemetryEventName,m.ULS.sendTraceTag(523321996,
220,50,"Error serializing campaign event. "+Ta+" Error: "+(xb?xb.toString():""))}}}}D7d(O){O=ja.a.sg(O);return-1!==O.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==O.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==O.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==O.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==O.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==O.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}wma(O){if(this.appName){const ca={},Ta={};Ta.LastTeachingUIShowTime=
(new Date).toUTCString();Ta.AddinHasShown=O;ca[this.appName]=ia.c(Ta);this.rDf.Fqb(ca);m.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else m.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}jGa(){if(!this.Bic){const O=window.g_roamingAddinList;O&&(this.wma(O),this.Bic=!0)}}WBa(O){O?this.RKe(O)?(m.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.X_="AddinHasShown"in
O&&O.AddinHasShown?O.AddinHasShown.toString():null,this.FVb()):(m.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.nHa(this.TMa,null)):(m.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.X_=null,this.FVb())}hia(O){m.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",O?O.af:-1);this.nHa(this.TMa,null)}J9(O){m.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",O?
O.af:-1)}FVb(){const O=this.gRd();0===O.targetType?(O.solutionId?this.HAe(O):this.JDa(null,"NoSolutionId"),this.VBh(O),this.nHa(this.TMa,null)):this.nHa(this.TMa,O);m.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",O.addinId)}HAe(O){const ca=new za.a;ca.callbackFunc=Ta=>{if(Ta.errorCode){if(this.JDa(O.solutionId,"FailToGetAppDetails"),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var xb=window.g_roamingAddinList;xb&&this.wma(xb)}}else if(Ta.value)for(xb of Ta.value)if(Ta=
xb[1],Ta===O.solutionId){const Tb={};Tb.solutionId=Ta;Tb.assetId=xb[5];Tb.storeType=xb[12];Tb.storeId=xb[11];Tb.assetStoreId=xb[6];Tb.targetType=xb[3];Tb.width=xb[7];Tb.height=xb[8];Tb.displayName=xb[0];Tb.version=xb[4];m.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",O.solutionId);xb=new qa(Tb);this.hp.raiseEvent(P.a.dLe,xb);break}};ca.storeType=OSF.StoreTypeEnum.PrivateCatalog;ca.fromInsertDialog=!1;ca.refresh=!1;this.yn.queryEntitlementDetails(ca)}RKe(O){if("LastTeachingUIShowTime"in
O){if(O=+new Date-+new Date(O.LastTeachingUIShowTime.toString()),O<A.AFrameworkApplication.fa.wP("AddinShowTeachingUIIntervalInMS",864E5))return m.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",O),!1}else m.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}gRd(){let O=new Ma.a(new ka,0),ca=new Ma.a(new ka,0),Ta=0,xb=0,Tb=0;var wc=new e.a;for(var sd of this.TMa)wc.add(sd);for(let $b of this.Y3a)wc.add($b);for(let $b of wc)if(!("excatalog"!==
$b.storeType||Ja.b($b.installTimeInMS)||!$b.installTimeInMS||$b.installTimeInMS<=A.AFrameworkApplication.fa.wP("DateTimeInMSForNewAddin",16409952E5))){wc=xa.RZb($b);if(this.X_&&(sd=this.X_.split(","),0<sd.length&&Array.contains(sd,wc))){Tb++;m.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}wc.startsWith("private_")?(O=xa.V$f($b,O),xb++):(ca=xa.V$f($b,ca),Ta++)}m.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
xb,Ta,Tb);return 0<ca.value?ca.key:0<O.value?O.key:Object.assign(new ka,{addinId:null,targetType:-1,solutionId:null})}JDa(O,ca,Ta=null){O={["AppTeachingUICalloutAction"]:ca,["SDX.Id"]:O,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Ta)for(let xb of Ta.keys)O[xb]=Ta.ga(xb);aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:L.a.dD(O)}))}VBh(O){O&&(O=this.X_?this.X_+","+O.addinId:O.addinId,A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=O:this.wma(O))}static yV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static V$f(O,ca){return ca.value<O.installTimeInMS?new Ma.a(Object.assign(new ka,{addinId:xa.RZb(O),targetType:O.targetType,solutionId:O.solutionId}),O.installTimeInMS):ca}static RZb(O){return Telemetry.PrivacyRules.IsPrivateAddin(O.storeType,O.assetId,null,null,O.storeId)?"private_"+O.installTimeInMS:O.solutionId}}Object(h.a)(xa,"PrivateCatalogTeachingCalloutHandler2",
null,[]);class Ga{constructor(O){this.zbf=null;this.q5e=O}get uSa(){return this.zbf}Gmb(O,ca=null){this.q5e.Gmb(O,ca);this.zbf=O}yDe(O){this.q5e.yDe(O)}}Object(h.a)(Ga,"RibbonExtensibilityManagerWithChangeDetection",null,[1057]);var na=d(80);const sa=()=>{const O=na.a.rsb(window.location.href.toLowerCase(),"wdomexsrctype");return!!O&&"4"===O},Ha=()=>na.a.rsb(window.location.href.toLowerCase(),"wdtpl"),cb=()=>{const O=na.a.rsb(window.location.href.toLowerCase(),"wdomexsrctype");return!!O&&"1"===O},
Za=O=>{let ca=null;switch(O){case 0:ca="omex";break;case 1:ca="spcatalog";break;case 2:ca="spapp";break;case 3:ca="filesystem";break;case 4:ca="exchange";break;case 6:ca="registry";break;case 7:ca="inmemory";break;case 8:ca="uploadfiledevcatalog";break;case 9:ca="hardcodedpreinstall";break;case 10:ca="excatalog";break;case 16:ca="wopicatalog"}return ca},va=O=>{let ca=-1;switch(O.toLowerCase()){case "omex":ca=0;break;case "spcatalog":ca=1;break;case "spapp":ca=2;break;case "filesystem":ca=3;break;
case "exchange":ca=4;break;case "registry":ca=6;break;case "inmemory":ca=7;break;case "uploadfiledevcatalog":ca=8;break;case "hardcodedpreinstall":ca=9;break;case "excatalog":ca=10;break;case "wopicatalog":ca=16}return ca};class Fa{constructor(){this.title=this.id=this.tabs=null}}Object(h.a)(Fa,"AddInDataTransferObject",null,[]);class Ca{constructor(O,ca,Ta){this.Doc=O;this.HGh=ca;this.IGh=Ta}get EE(){return this.Doc}get O_h(){return this.HGh}get P_h(){return this.IGh}static srb(O){return(O=O.G9)?
Object.assign(new Fa,{tabs:O.EE.toArray(),id:O.O_h,title:O.P_h}):null}}Object(h.a)(Ca,"OneLineRibbonExtensibility",null,[]);class La{Gmb(O,ca=null){if(O=Ca.srb(O)){appChrome.addInApi.dispatchActionsToInstallAddIn(O,ca);for(const Ta of O.tabs)if(Ta.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(O,()=>{});break}}}yDe(O){(O=Ca.srb(O))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(O)}static nGi(O,ca,Ta=null){O=La.saj(O);0<O.length&&(La.ofd(O,!1),Ta&&Ta(ca,O))}static saj(O){const ca=
[];if(O&&(O=O.G9,O.EE&&0<O.EE.count))for(let Ta of O.EE)if(Ta.groups&&0<Ta.groups.length)for(const xb of Ta.groups)if(xb.controls&&0<xb.controls.length)for(const Tb of xb.controls)Array.add(ca,Tb.id);return ca}static ofd(O){if(O.length){var ca=[];for(const Ta of O)ca.push(appChrome.actions.updateControlEnabledDisabledState(Ta,!0));appChrome.api.dispatch(ca)}}}Object(h.a)(La,"OneLineRibbonExtensibilityManager",null,[1057]);class nb{constructor(){this.Ver=1}}Object(h.a)(nb,"CacheItem",null,[]);class Nb{constructor(){}}
Object(h.a)(Nb,"AppsDataCacheManager",null,[1055]);class Rb{constructor(){new Nb(w.a.instance)}Wjh(O,ca){O=P.a.A9f()+O;w.a.instance.setItem(O,ca.toString())}$bg(){var O=P.a.ccg();m.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",O);O=w.a.instance.getItem(O);return ia.a(O)}Clh(O){const ca=P.a.ccg();m.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ca);w.a.instance.setItem(ca,ia.c(O))}qug(){return!!w.a.instance.localStorage}static get instance(){Rb.Ja||(Rb.Ja=new Rb);return Rb.Ja}}Rb.Ja=
null;Object(h.a)(Rb,"AddInCommandsCacheManager",null,[1020]);var Ya=d(681),Qb=d(66);class bb{static g$f(O){const ca=new e.a;if(bb.iPf)for(var Ta of bb.iPf)ca.add(Ta);Ta=null;switch(O){case "Workbook":Ta=bb.rBl;break;case "Document":Ta=bb.UHi;break;case "Presentation":Ta=bb.Izk}if(Ta)for(const xb of Ta)ca.add(xb);return ca}}bb.iPf=["PrimaryCommandSurface","ContextMenu"];bb.rBl=null;bb.UHi=null;bb.Izk=null;Object(h.a)(bb,"ExtensionPointType",null,[]);class Bb{constructor(O){this.fff=null;if(Ja.b(O))throw m.ULS.sendTraceTag(9175315,
220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.TGh=O}get Fcc(){return this.fff||(this.fff=new e.a)}get PDf(){return this.TGh}}Object(h.a)(Bb,"ContextMenuExtensibility",null,[1031]);class Eb{constructor(O,ca=null,Ta=0){if(Ja.b(O))throw m.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.kRh=
O;this.HVh=ca;this.RLh=Ta}get G9(){return this.kRh}get startedNode(){return this.HVh}get DWi(){return this.RLh}}Object(h.a)(Eb,"RibbonExtensibility",null,[1097]);class tb{constructor(O){this.SKh=O.entitlement}get entitlement(){return this.SKh}createActionContext(O,ca){O={};O.ownerAddinInfo=this.entitlement;O.action=ca;return O}}Object(h.a)(tb,"AddInCommandsContextProvider",null,[]);class Yb{constructor(O,ca,Ta){this.AVe=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=
this.commandSurface=null;this.ribbonBuilder=O;this.eventBuilder=ca;this.contextMenuBuilder=Ta}get nDf(){return this.AVe}iwi(O){return new tb(O)}createActionBuilder(O,ca){return OfficeExt.DefaultControlActionBinder.createActionBuilder(O,ca.entitlement,ca.manifest)}startApplyAddin(O){this.AVe=O;const ca=this.iwi(O);this.actionBuilder=this.createActionBuilder(ca,O)}endApplyAddin(){}HWd(O,ca,Ta=0){return this.ribbonBuilder.EE&&0<this.ribbonBuilder.EE.count?new Eb(this.oWi(O,ca),this.nDf.startedNode,Ta):
null}E5f(){var O=null;if(this.contextMenuBuilder.U4c&&0<this.contextMenuBuilder.U4c.count){O||(O=this.nDf.entitlement.solutionId);O=new Bb(O);for(let ca of this.contextMenuBuilder.U4c)O.Fcc.add(ca);return O}return null}oWi(O,ca){return this.ribbonBuilder.EE&&0<this.ribbonBuilder.EE.count?new Ca(this.ribbonBuilder.EE,O,ca):null}}Object(h.a)(Yb,"AddinCommandsBuilder",null,[]);class Tc{constructor(O,ca,Ta,xb,Tb,wc,sd){this.Agb=new Qb.a;this.Dx=O;this.yn=ca;this.JR=Ta;this.yic=xb;this.LNd=Tb;this.JHa=
wc;this.Vmb=sd;this.d$=A.AFrameworkApplication.Aa.hU}$Uc(O,ca,Ta,xb,Tb,wc,sd){const $b=(ge,we,oe,Fe)=>{Tb(ge,we,oe,Fe);ge=Ya.a[this.Dx]+we.assetId;({value:we}=this.Agb.Of(ge)).returnValue&&(we.stop(),this.Agb.remove(ge))};if(0!==this.Dx&&O){m.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",O.count);4===this.Dx&&(m.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",xb)),this.qmi(O,xb),wc());for(let ge of O)if(O=ge,m.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",
this.JR.rS,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId))),this.wDh(O))if(sd&&O.requireConsent)sd(O,we=>{try{if(this.d$){const Fe=Ya.a[this.Dx]+we.solutionId,Gf=this.d$.wi("ComponentAttach",Fe);this.Agb.$(Fe,Gf)}const oe=this.JHa.t5a(we.storeType,we.solutionId);6!==this.Dx&&(oe&&(this.SCc(oe),oe.wL.purge(!1)),this.yn.insertOsfControl(this.Efc(we,ca,Ta,$b)),oe&&this.yn.ownerAddinControlRecreated(we.solutionId,we.storeType))}catch(oe){m.ULS.sendTraceTag(572839882,
220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.JR.rS,Telemetry.PrivacyRules.GetPrivacyCompliantId(we.solutionId,we.ownerAddinStoreType||we.storeType,we.assetId,null,null,we.storeId),we.version,we.storeType,we.storeId,oe.message)),$b(!1,we,null,null)}});else try{if(this.d$){const oe=Ya.a[this.Dx]+O.solutionId,Fe=this.d$.wi("ComponentAttach",oe);this.Agb.$(oe,Fe)}const we=this.JHa.t5a(O.storeType,O.solutionId);
6!==this.Dx&&(we&&(this.SCc(we),we.wL.purge(!1)),this.yn.insertOsfControl(this.Efc(O,ca,Ta,$b)),we&&this.yn.ownerAddinControlRecreated(O.solutionId,O.storeType))}catch(we){m.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.JR.rS,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,
we.message)),$b(!1,O,null,null)}else $b(!1,O,null,null)}}HRj(O,ca,Ta,xb,Tb,wc){const sd=($b,ge,we,oe)=>{wc($b,ge,we,oe);$b=Ya.a[this.Dx]+ge.solutionId;({value:ge}=this.Agb.Of($b)).returnValue&&(ge.stop(),this.Agb.remove($b))};if(6===this.Dx&&O)if(m.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.JR.rS,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId))),this.wDh(O))try{if(this.d$){const ge=
Ya.a[this.Dx]+O.solutionId,we=this.d$.wi("ComponentAttach",ge);this.Agb.$(ge,we)}const $b=this.JHa.t5a(O.storeType,O.solutionId);$b||sd(!1,O,null,null);A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.gb.TUf?this.U5f(O,ca,xb,Tb,Ta,ge=>{sd(ge,O,Ta,$b.displayName)}):(this.U5f(O,ca,xb,Tb,Ta),sd(!0,O,Ta,$b.displayName))}catch($b){m.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.JR.rS,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,$b.message)),sd(!1,O,null,null)}else sd(!1,O,null,null)}Rgk(O,ca,Ta,xb,Tb,wc){if(wc)if(wc._isAddinCommandsManifest(this.JR.rS))try{A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.gb.TUf?this.T5f(O,ca,Ta,Tb,wc,sd=>{xb(sd,O,wc,wc.getDefaultDisplayName())}):(this.T5f(O,ca,Ta,Tb,wc),xb(!0,O,wc,wc.getDefaultDisplayName()))}catch(sd){m.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.JR.rS,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,sd.message)),xb(!1,O,wc,wc.getDefaultDisplayName())}else m.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.JR.rS,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId)),xb(!1,O,null,null);else m.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.JR.rS,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId)),
xb(!1,O,null,null)}Efc(O,ca,Ta,xb){const Tb={},wc=document.createElement("div");wc.setAttribute("visible","false");Tb.div=wc;Tb.id=O.solutionId;Tb.solutionId=O.solutionId;Tb.version=O.version;Tb.storeType=O.storeType;Tb.storeId=O.storeId;Tb.assetId=O.assetId;Tb.assetStoreId=O.assetStoreId;Tb.isvirtualOsfControl=!0;Tb.virtualOsfControlActivationCallback=(sd,$b)=>{const ge=this.JHa.t5a(O.storeType,O.solutionId);ge&&(ge.isUpgraded&&(O.isUpgraded=!0),this.SCc(ge));this.Rgk(O,ca,Ta,xb,sd,$b)};Tb.reason=
3===this.Dx?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Tb}T5f(O,ca,Ta,xb,Tb,wc=null){const sd={};sd.solutionId=xb.getSolutionId();sd.version=xb.getVersion();sd.storeType=xb.getStoreType();sd.storeId=xb.getStoreId();sd.assetId=xb.getAssetId();sd.assetStoreId=xb.getAssetStoreId();sd.targetType=xb.getOsfControlType();let $b=null,ge=null;if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))$b=(new OfficeExt.Parser.AddinCommandsManifestParser(this.JR.rS,this.JR.formFactor)).parseExtensions(sd,Tb,this.Vmb),ge=bb.g$f(this.JR.rS);else try{$b=(new OfficeExt.Parser.AddinCommandsManifestParser(this.JR.rS,this.JR.formFactor)).parseExtensions(sd,Tb,this.Vmb),ge=bb.g$f(this.JR.rS)}catch(oe){throw m.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+oe.message),oe;}if(ge&&0<ge.count){if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var we=ca(O);ca=Ta(O);Ta=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");we=new Yb(we,null,ca);for(let oe of ge)we.commandSurface=oe,$b.apply(we,this.Vmb,Ta)}else try{let oe=ca(O),Fe=Ta(O),Gf=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");we=new Yb(oe,null,Fe);for(let Rh of ge)we.commandSurface=Rh,$b.apply(we,this.Vmb,Gf)}catch(oe){throw m.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
oe.message),oe;}if(OSF.OUtil.checkFlight(14))try{let oe=we.HWd(O.solutionId,Tb.getDefaultDisplayName()),Fe=we.E5f();oe&&this.yic.Gmb(oe,wc);Fe&&this.LNd.uAf(Fe);this.JHa.fBf(xb,oe,Fe,Tb.getDefaultDisplayName());m.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Tb.getDefaultDisplayName())}catch(oe){throw OfficeExt.DevConsole.log(oe),m.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+oe.message),oe;}else try{let oe=we.HWd(O.solutionId,Tb.getDefaultDisplayName()),
Fe=we.E5f();oe&&this.yic.Gmb(oe);Fe&&this.LNd.uAf(Fe);this.JHa.fBf(xb,oe,Fe,Tb.getDefaultDisplayName());m.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Tb.getDefaultDisplayName())}catch(oe){throw m.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+oe.message),oe;}}}U5f(O,ca,Ta,xb,Tb,wc=null){const sd={};sd.solutionId=O.solutionId;sd.version=O.version;sd.storeType=O.storeType;sd.storeId=O.storeId;sd.assetId=O.assetId;sd.assetStoreId=O.assetStoreId;sd.targetType=
O.targetType;const $b=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.JR.rS,this.JR.formFactor);try{const ge=ca.getManifest(),we=$b.parse(sd,ge,Tb,this.Vmb,ca.getSharedRuntimeId(),ca),oe=Ta(O),Fe=xb(O),Gf=new Yb(oe,null,Fe);Gf.commandSurface="PrimaryCommandSurface";we.apply(Gf,this.Vmb,!0);if(Gf.ribbonBuilder.EE&&0<Gf.ribbonBuilder.EE.count){const Rh=Gf.HWd(O.solutionId,ca.getManifest().getDefaultDisplayName(),1);A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.yic.Gmb(Rh,wc):Rh&&this.yic.Gmb(Rh,wc);this.JHa.k0h(ca,Rh,Tb,ca.getManifest().getDefaultDisplayName());m.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ca.getManifest().getDefaultDisplayName())}}catch(ge){m.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ca.getManifest().getDefaultDisplayName(),ge.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(ge)}}SCc(O){O.dJ&&this.yic.yDe(O.dJ);O.SVb&&this.LNd.oNk(O.SVb);
this.JHa.WMk(O.wL.getStoreType(),O.wL.getSolutionId())}qmi(O,ca){ca=Za(ca);for(let Ta of this.JHa.Ttb){if(Ta.wL.getStoreType()!==ca)continue;let xb=!0;for(let Tb of O){const wc=Tb;if(wc&&Ta.qwg(wc.storeType,wc.solutionId)){xb=!1;break}}xb&&(this.SCc(Ta),Ta.wL.purge(!1))}}wDh(O){return!!O&&!!O.solutionId&&!!O.version&&!!O.storeType&&!!O.storeId}}Object(h.a)(Tc,"AddInCommandsIntegration",null,[]);var ib=d(1108),Zb=d(163),Cc=d(907),ob=d(567),cc=d(340),sb=d(908),mb=d(138),Pb=d(95),dc=d(62),mc=d(55);class Mb{static get z6(){return Mb.KF||
(Mb.KF=mc.a.instance.pb("Common.Utils.IAriaNotifier"))}static iRf(O,ca,Ta,xb){Mb.GU&&Mb.GU.AK&&Mb.GU.dismiss();Mb.GU=ib.a.UOd(ca,O,O,3);Mb.GU.content=Ta;Ja.a(xb)||(Mb.GU.title=xb,Mb.GU.K1b=!0);O=new Sys.UI.Bounds(0,0,Pb.a.SNc(),Pb.a.RNc());Mb.GU.MY=Mb.vXd(O,ca,Mb.GU.w$,1);Mb.GU.show();Mb.z6&&Mb.z6.sendNotification(Ta.innerText,!0)}static nOd(O,ca,Ta,xb=null){mb.UISurfaces.VM().then(Tb=>{let wc=null;Mb.YPb&&(Tb.removeNotification(Mb.YPb),Mb.YPb=null);const sd=Tb.callout(Object.assign(new Cc.a,{target:O,
title:ca,content:Ta,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new sb.a,{onDismiss:()=>{Tb.removeNotification(wc)},directionalHint:null!=xb?xb:null})})),$b=Object.assign(new cc.a,{expirationOptions:Object.assign(new ob.a,{displayTimeoutSeconds:7,onExpire:()=>{Tb.removeNotification(Mb.YPb)}})});wc=Mb.YPb=Tb.addNotification(sd,$b);return null},Tb=>{m.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Tb);return null})}static bLe(O){Mb.GU&&
Mb.GU.AK&&Mb.GU.dismiss();const ca=new y.StandardDialog;ca.oYa=!1;ca.vd=0;ca.Vx(Zb.a.CRj,CommonUIStrings.l_DialogError,Ja.a(O)?Mb.I8f():O,null)}static yal(O){Mb.GU&&Mb.GU.AK&&Mb.GU.dismiss();m.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",O.errorCode));const ca=Ja.a(O.description)?Mb.I8f():O.description,Ta=new y.StandardDialog;let xb=null;O.iUb?(Ta.vd=1,Ta.Re(1,O.buttonText),Ta.fwa(1)):Ta.vd=0;xb=Tb=>{1===Tb?O.iUb():O.yXb&&O.yXb()};Ta.oYa=!1;0===O.p5d?
Ta.Vx(O.errorCode,O.title?O.title:CommonUIStrings.l_DialogError,ca,xb):1===O.p5d?Ta.mO(O.title?O.title:CommonUIStrings.l_DialogWarning,ca,xb):Ta.jgb(O.title?O.title:CommonUIStrings.l_DialogInfo,ca,xb)}static vXd(O,ca,Ta,xb){let Tb=0===xb?0:4;const wc=O.x+O.width-ca.x-ca.width;ca.x-O.x+ca.width/2<=Ta/2?Tb=0===xb?2:5:wc+ca.width/2<=Ta/2&&(Tb=0===xb?3:6);return Tb}static Jal(O,ca,Ta,xb=!1){(ca=Ca.srb(ca))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ca,
Tb=>{Tb&&(xb||Mb.nOd(Tb,Ta,O,5))})}static Kal(O,ca,Ta=!1){Mb.Jal(ca.startedNode?ca.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,O),ca,ca.startedNode?ca.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,O),Ta)}static Ial(O,ca,Ta,xb){if(Mb.QCh)O=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ta,xb,CommonUIStrings.l_InsertionDialogRefresh)),Mb.nOd(ca,O,CommonUIStrings.l_ErrorLoadingAddInsTitle,
1);else{ca=dc.a.Yh(ca);var Tb=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),wc=document.createElement("span");wc.innerText=Tb[0];var sd=document.createElement("span");sd.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ta,xb,CommonUIStrings.l_InsertionDialogRefresh);sd.className="UIFontBold";Ta=document.createElement("span");Ta.innerText=Tb[1];xb=document.createElement("div");Sys.UI.DomElement.addCssClass(xb,"ModalCalloutControl");xb.appendChild(wc);
xb.appendChild(sd);xb.appendChild(Ta);Mb.iRf(O,ca,xb,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static fcl(O,ca){var Ta=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,xb=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;Mb.QCh?Mb.nOd(ca,Ta,xb):(ca=dc.a.Yh(ca),Mb.iRf(O,ca,Mb.Xei(xb),Ta))}static Xei(O){const ca=document.createElement("div");Sys.UI.DomElement.addCssClass(ca,"ModalCalloutControl");ca.innerText=O;return ca}static I8f(){return CommonUIStrings.l_InternalError+" "+
CommonUIStrings.l_InternalError_Directive}static get QCh(){return A.AFrameworkApplication.Aa.gb.uo&&A.AFrameworkApplication.Aa.gb.ZRa}}Mb.GU=null;Mb.YPb=null;Mb.KF=null;Object(h.a)(Mb,"AddInCommandsNotificationFactory",null,[]);class Kc{constructor(O,ca,Ta,xb,Tb,wc,sd,$b=null){this.Pa=new C.a;this.Und=O;this.lJh=ca;this.eR=Ta;this.Jxf=xb;this.rlb=Tb;this.JGh=wc;this.Hoc=sd;this.bRh=$b;this.LNh=A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.Xtd=
A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}j2h(O){this.Pa.addHandler(P.a.lDf,O)}e3h(O){this.Pa.addHandler(P.a.mbe,O)}w5h(O){this.Pa.addHandler(P.a.Dph,O)}v2h(O){this.Pa.addHandler(P.a.dJd,O)}RRj(O,ca,Ta){const xb=Ta[P.a.Uzc],Tb=void 0===Ta[P.a.u6]?0:Ta[P.a.u6];if(xb&&0!==Tb)if(0>=xb.count&&4!==Tb)this.c5g(new ea(Tb,null,null,ca,null,!0));else{var wc=xb.count,sd=new Ga(new La),$b=void 0===Ta[P.a.rpa]?-1:Ta[P.a.rpa],ge=new Tc(Tb,this.eR,this.Und,
sd,this.lJh,this.rlb,this.Hoc),we=Sh=>this.Jxf.tei(Sh.solutionId,this.Hoc,this.Und,O),oe=Sh=>this.Jxf.xdi(Sh.solutionId),Fe=(Sh,Wa,Lg)=>{wc--;Lg=new ea(Tb,Wa,sd,ca,Lg,0>=wc);if(Sh&&Wa)this.c5g(Lg);else{if(3===Tb||Wa&&Wa.isUpgraded)Sh="",Wa&&(Sh=Telemetry.PrivacyRules.GetPrivacyCompliantId(Wa.solutionId,Wa.ownerAddinStoreType||Wa.storeType,Wa.assetId,null,null,Wa.storeId)),Wa={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:Sh},aa.a.sendTelemetryEvent(Object.assign(new Z.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:L.a.dD(Wa)}));this.b5g(Lg)}wc||A.AFrameworkApplication.Aa.updateCommandUI()},Gf=(Sh,Wa,Lg,gg)=>{Fe(Sh,Wa,gg)},Rh=()=>{this.ste();0>=xb.count&&4===Tb&&this.rlb.bIe()};6===Tb?($b=Ta[P.a.UIi],Ta=Ta[P.a.VIi],ge.HRj(xb.ga(0),$b,Ta,we,oe,(Sh,Wa,Lg,gg)=>{Fe(Sh,Wa,gg)})):ge.$Uc(xb,we,oe,$b,Gf,Rh,this.bRh)}else aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:L.a.dD({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),m.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.Und.rS)),this.b5g(new ea(Tb,null,null,ca,null,!0))}b5g(O){this.ste(O);this.sqh(!1,O)}c5g(O){const ca=O.hu;let Ta=null;null!==ca&&(Ta=ca.storeType,Ta=Ta.toLowerCase());if(O&&"omex"===Ta&&(3===O.Dx||ca.isUpgraded)){var xb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,
ca.ownerAddinStoreType||ca.storeType,ca.assetId,null,null,ca.storeId)};aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:L.a.dD(xb)}))}this.ste(O);xb=this.Xtd&&cb()&&"omex"===Ta&&!!O.R9&&!!ca.solutionId&&2===O.Dx&&ca.solutionId.toLowerCase()===Ha().toLowerCase();if("omex"===Ta&&O.R9&&(3===O.Dx&&"hardcodedpreinstall"!==Ta||ca.isUpgraded)||xb)xb=new Q,xb.hu=ca,xb.dJ=O.R9.uSa,this.Pa.raiseEvent(P.a.dJd,xb);if(this.LNh){xb=sa();const Tb=Ha();xb&&ca&&
"excatalog"===ca.storeType&&O.R9&&5===O.Dx&&Tb&&(ca.storeId&&ca.storeId.toLowerCase()===Tb.toLowerCase()||ca.assetId&&ca.assetId.toLowerCase()===Tb.toLowerCase())&&(xb=new Q,xb.hu=ca,xb.dJ=O.R9.uSa,this.Pa.raiseEvent(P.a.dJd,xb),m.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}ca&&(Rb.instance.Wjh(va(Ta),!0),"uploadfiledevcatalog"===Ta&&(xb=this.JGh.createAddinDataProvider(Ta,this.eR))&&xb.localCacheAddinCommands(this.eR.jva,ca.solutionId,ca.version,ca.storeId),
T.a.XIb(P.a.USb,"true",va(Ta)));this.sqh(!0,O)}sqh(O,ca){O?A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ca.R9&&5===ca.Dx&&ca.R9.uSa&&void 0!==ca.hu.showCallout&&null!==ca.hu.showCallout&&ca.hu.showCallout?(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new xa(this.Pa)).xFd(ca.hu,Ca.srb(ca.R9.uSa)):(new oa(this.Pa,ca.hu,Ca.srb(ca.R9.uSa))).xFd(),O=new Q,
O.dJ=ca.R9.uSa,O.hu=ca.hu,this.Pa.raiseEvent(P.a.Dph,O)):3!==ca.Dx?ca.Uyg&&this.rlb.bIe():ca.R9&&ca.R9.uSa&&"hardcodedpreinstall"!==ca.hu.storeType&&Mb.Kal(ca.displayName,ca.R9.uSa,ca.hu.isAutoLaunched):3===ca.Dx?ca.hu&&"uploadfiledevcatalog"===ca.hu.storeType.toLowerCase()?(ca=this.Hoc.A2i(ca.hu.solutionId),Mb.bLe(ca?ca:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.rlb.Q1k():ca.Uyg&&this.rlb.bIe()}ste(O=null){var ca=O?O.hu:null;const Ta=new Q;if(Ta.hu=ca){var xb=
this.rlb.t5a(ca.storeType,ca.solutionId,6===O.Dx?1:0);if(xb&&xb.dJ){Ta.dJ=xb.dJ;var Tb=this.Xtd?Ha():null;Tb=this.Xtd&&cb()&&!!ca.solutionId&&!!Tb&&ca.solutionId.toLowerCase()===Tb.toLowerCase()&&2===O.Dx;if(3===O.Dx&&"hardcodedpreinstall"!==ca.storeType||Tb)O="",xb.dJ.G9&&xb.dJ.G9.EE&&(xb=xb.dJ.G9.EE.ga(0))&&(O=xb.id),ca={["SDX_CommandPlacement"]:O,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.ownerAddinStoreType||
ca.storeType,ca.assetId,null,null,ca.storeId)},aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:L.a.dD(ca)}))}}this.Pa.raiseEvent(P.a.lDf,Ta)}}Object(h.a)(Kc,"LaunchAddinCommandsHandler",null,[1024]);class gc{constructor(O){this.vRh=O}get jva(){return this.vRh}insertOsfControl(O){return this.jva.insertOsfControl(O)}getManifestInvaildErrorString(){return this.jva.getManifestInvaildErrorString()}isAddinCommandsAsync(O,ca){this.jva.isAddinCommandsAsync(O,
ca)}isAddinCommandsExAsync(O,ca){this.jva.isAddinCommandsExAsync(O,ca)}ownerAddinControlRecreated(O,ca){this.jva.ownerAddinControlRecreated(O,ca)}queryEntitlementDetails(O){this.jva.queryEntitlementDetails(O)}}Object(h.a)(gc,"ContextActivationMgrWrapper",null,[1028]);class rb{}rb.Whb="Alt";rb.Xhb="Command";rb.id="Id";rb.FZa="Image16by16";rb.Yhb="LabelText";rb.button="Button";rb.LVd="FlyoutAnchor";Object(h.a)(rb,"AddinDataNodeConstants",null,[]);var Ua=d(220),pb=d(394),Ub=d(346),Bc=d(73);class Gc{constructor(O,
ca){this.Ztc=this.IYe=null;if(Ja.b(O)||Ja.b(ca))throw m.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.cqd=ca;this._id=O;this.DM[rb.id]=this._id}get id(){return this._id||""}get DM(){return this.IYe||(this.IYe={})}get controlType(){return this.cqd||""}get menuItems(){return this.Ztc||(this.Ztc=new e.a)}qmc(){let O=null;this.cqd===rb.LVd?O=Object.assign(new pb.a,{Menu:this.$bk()}):
this.cqd===rb.button&&(O=Object.assign(new Ua.a,{}));O&&(this.DM[rb.id]&&(O.ExternalId=this.DM[rb.id]),this.DM[rb.Xhb]&&(O.Command=this.DM[rb.Xhb].toString()),this.DM[rb.Yhb]&&(O.LabelText=this.DM[rb.Yhb]),this.DM[rb.Whb]&&(O.Alt=this.DM[rb.Whb]),this.DM[rb.FZa]&&(Bc.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.DM[rb.FZa]),O.ExternalImageId=this._id));return O}$bk(){const O=Object.assign(new Ub.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.Ztc){const ca=
Object.assign(new n.a,{ControlList:[]});for(let Ta of this.Ztc)Array.add(ca.ControlList,Ta.qmc());Array.add(O.MenuSectionList,ca)}return O}}Object(h.a)(Gc,"ControlDefinition",null,[1027]);class qd{constructor(O){this.Z$=null;if(Ja.b(O))throw m.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=O;this.Mbc[rb.id]=this._id}get Mbc(){return this.Z$||(this.Z$={})}get id(){return this._id||
""}qmc(){const O=Object.assign(new Ua.a,{});this.Z$[rb.id]&&(O.ExternalId=this.Z$[rb.id]);this.Z$[rb.Xhb]&&(O.Command=this.Z$[rb.Xhb].toString());this.Z$[rb.Yhb]&&(O.LabelText=this.Z$[rb.Yhb]);this.Z$[rb.Whb]&&(O.Alt=this.Z$[rb.Whb]);this.Z$[rb.FZa]&&(Bc.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.Z$[rb.FZa]),O.ExternalImageId=this._id);return O}}Object(h.a)(qd,"MenuItemDefinition",null,[1064]);class Td{constructor(O){this.Zpc=null;if(Ja.b(O))throw m.ULS.sendTraceTag(9175314,
220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=O}get id(){return this._id}get controls(){return this.Zpc||(this.Zpc=new e.a)}qmc(){const O=[];if(this.Zpc)for(let ca of this.Zpc){const Ta=ca.qmc();Ta&&O.push(Ta)}return O}}Object(h.a)(Td,"OfficeMenuDefinition",null,[1023]);var Vd=d(35);class Be{constructor(O,ca,Ta){this.vU=this.jjb=null;this.yxd=O;this.Rib=ca;this.fib=Ta;this.kQh=new e.a}get E5c(){return this.yxd}get vVb(){return this.Rib}get TEd(){return this.fib}addButton(O){m.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",O.actionType);this.vU=new Gc(this.rNa(O.id),rb.button);this.vU.DM[rb.Yhb]=O.label;this.vU.DM[rb.Whb]=O.label;this.vU.DM[rb.FZa]=O.icon["16"];this.QTb(this.vU.DM[rb.id],O.action);this.F2a(this.vU.DM);this.jjb.controls.add(this.vU);this.vU=null}startBuildMenu(O){if(Ja.b(this.jjb))this.jjb=new Td(O.id);else{const ca=this.rNa(O.id);this.vU=new Gc(ca,rb.LVd);this.Xnb(this.vU.DM,O);this.vU.DM[rb.FZa]=O.icon["16"];this.vU.DM[rb.Xhb]=Vd.a.gnb}}addMenuItem(O){m.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",O.actionType);const ca=new qd(this.rNa(O.id));this.Xnb(ca.Mbc,O);O.icon&&(ca.Mbc[rb.FZa]=O.icon["16"]);this.QTb(ca.Mbc[rb.id],O.action);this.F2a(ca.Mbc);this.vU.menuItems.add(ca)}endBuildMenu(){Ja.b(this.vU)?(this.U4c.add(this.jjb),this.jjb=null):(this.jjb.controls.add(this.vU),this.vU=null)}get U4c(){return this.kQh}QTb(O,ca){this.TEd.bindAction(O,ca)}F2a(O){this.vVb.F2a(O)}rNa(O){return this.E5c.FBa(O)}Xnb(O,ca){O[rb.Yhb]=ca.label;O[rb.Whb]=ca.label}}
Object(h.a)(Be,"ContextMenuExtensibilityCreator",null,[1054,1050]);class Id{constructor(O){this.$Ob=O}get mcc(){return this.$Ob}FBa(O){return this.mcc+O}}Object(h.a)(Id,"DefaultContextMenuNamingProvider",null,[1053]);class gb{constructor(O,ca,Ta,xb){this.$Ob=O;A.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&Ta.X6i();this.jvf=ca;this.UUh=xb}get mcc(){return this.$Ob}get solutionId(){return this.jvf}get GKe(){return this.UUh}FBa(O){O=this.mcc+this.solutionId+O;return this.GKe?(O in
gb.Vzc||(gb.Vzc[O]="AddinControl"+gb.l6h++),gb.Vzc[O]):O}bUf(O){if(this.GKe){const Ta=gb.Vzc;for(let xb in Ta){var ca=xb;if(O===Ta[xb])return ca.substr(this.mcc.length+this.solutionId.length)}}return O}yej(O){O=this.mcc+this.solutionId+O;return this.GKe?(O in gb.SGd||(gb.SGd[O]="AddinTab"+gb.q6h++),gb.SGd[O]):O}}gb.Vzc={};gb.SGd={};gb.q6h=0;gb.l6h=0;Object(h.a)(gb,"DefaultRibbonNamingProvider",null,[1026]);class Xb{bindAction(O,ca){OfficeExt.DefaultControlActionBinder.bindAction(O,ca)}}Object(h.a)(Xb,
"DefaultUIControlActionBinder",null,[1052]);class Ic{constructor(O){this.QIh=O}get command(){return this.QIh}F2a(O){O[rb.Xhb]=this.command}}Object(h.a)(Ic,"DefaultUIControlCommandBinder",null,[1051]);var Wc=d(522);class Ib{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(h.a)(Ib,"AddInControl",null,[]);class ec{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}
Object(h.a)(ec,"AddInGroup",null,[]);class Jb{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(h.a)(Jb,"AddInMenuItem",null,[]);class hb{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(h.a)(hb,"AddInTab",null,[]);class Rc{constructor(O,ca,Ta,xb,Tb,wc){this.Doc=new e.a;this.vLb=this.Oxa=this.kjb=null;this.yxd=O;this.fib=
ca;this.Rib=Ta;this.jvf=xb;this.Hoc=Tb;this.x1e=wc}get E5c(){return this.yxd}get EE(){return this.Doc}get TEd(){return this.fib}get vVb(){return this.Rib}startBuildTab(O){const ca=O.isOfficeTab?O.id:this.E5c.yej(O.id),Ta=O.isOfficeTab?null:O.label;this.kjb=Object.assign(new hb,{id:ca,title:Ta,isOfficeTab:O.isOfficeTab,visible:O.visible,groups:[],tabType:O.tabType,insertBefore:O.insertBefore,insertAfter:O.insertAfter,autoFocus:O.autoFocus})}startBuildGroup(O){const ca=this.rNa(O.id);this.Oxa=Object.assign(new ec,
{id:ca,mlrId:O.mlrId,title:O.label,controls:[],groupType:0})}addNativeGroup(O){this.Oxa=Object.assign(new ec,{id:O.id,mlrId:O.mlrId,title:O.label,controls:[],groupType:1});this.kjb.groups.push(this.Oxa)}addButton(O){const ca=this.rNa(O.id);ca&&(this.QTb(ca,O.action),m.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",O.actionType),O=Object.assign(new Ib,{id:ca,title:O.label,iconLocation:this.gZd(O),enabled:O.enabled,controlType:0,attributes:this.Xnb()}),this.x1e.bAf(new Wc.a(ca,
this.vVb.command.toString())),this.Oxa.controls.push(O))}addNativeControl(O){O.id&&(m.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",O.actionType),O=Object.assign(new Ib,{id:O.id,title:"",iconLocation:"",enabled:O.enabled,controlType:2,attributes:this.Xnb()}),this.Oxa.controls.push(O))}startBuildMenu(O){const ca=this.rNa(O.id);ca&&(this.vLb=Object.assign(new Ib,{id:ca,title:O.label,iconLocation:this.gZd(O),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(O){const ca=
this.rNa(O.id);ca&&(this.QTb(ca,O.action),m.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",O.actionType),O=Object.assign(new Jb,{id:ca,title:O.label,iconLocation:this.gZd(O),enabled:O.enabled,attributes:this.Xnb()}),this.x1e.bAf(new Wc.a(ca,this.vVb.command.toString())),this.vLb.menuItems.push(O))}endBuildMenu(){Ja.b(this.vLb.id)||this.Oxa.controls.push(this.vLb);this.vLb=null}endBuildGroup(){Ja.b(this.Oxa.id)||this.kjb.groups.push(this.Oxa);this.Oxa=null}endBuildTab(){Ja.b(this.kjb.id)||
this.Doc.add(this.kjb);this.kjb=null}Xnb(){const O={};this.F2a(O);return O}gZd(O){return O.icon["80"]?O.icon["80"]:O.icon["32"]}F2a(O){this.vVb.F2a(O)}rNa(O){return this.E5c.FBa(O)}QTb(O,ca){this.TEd.bindAction(O,ca)}}Object(h.a)(Rc,"OneLineRibbonExtensibilityCreator",null,[1049,1050]);class gd{constructor(O,ca){this.$Ob=O;this.fib=new Xb;this.Rib=new Ic(ca)}xdi(O){O=new Id(O);return new Be(O,this.Rib,this.fib)}tei(O,ca,Ta,xb){Ta=new gb(this.$Ob,O,Ta,!0);return new Rc(Ta,this.fib,this.Rib,O,ca,xb)}}
Object(h.a)(gd,"UIExtensibilityFactory",null,[1021]);class hd{createAddinDataProvider(O,ca){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(O,ca.jva)}static get instance(){hd.Ja||(hd.Ja=new hd);return hd.Ja}}hd.Ja=null;Object(h.a)(hd,"OSFAddinDataProviderFactory",null,[1022]);class Hd{constructor(){this.Wmb=null}setErrorMessageForAddin(O,ca){this.Wmb||(this.Wmb={});this.Wmb[O]=ca}A2i(O){return this.Wmb&&O in this.Wmb?this.Wmb[O]:null}}Object(h.a)(Hd,"AddinCommandsErrorManager",null,
[]);class Xd{constructor(){this.p5d=0;this.iUb=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Yjg=!1;this.Ntj=this.yXb=null}}Object(h.a)(Xd,"AddInCommandsNotificationParameters",null,[]);class id{constructor(){this.sWe=this.ynd=null}get UEd(){return this.ynd||(this.ynd=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set UEd(O){this.ynd=O}get Iai(){return this.sWe||(this.sWe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(O,
ca){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(O,ca)}getTaskPaneControlIdFromAssetIdRuntimeId(O,ca){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(O,ca)}i1b(O,ca,Ta,xb,Tb){m.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",O);if((O=ca.t5a(Tb.ownerAddinInfo.storeType,Tb.ownerAddinInfo.solutionId))&&O.wL&&!O.wL.getIsUpgrading())if(ca=null,0<O.wL.getNotificationParams().length&&(ca=this.FIf(O.wL.getNotificationParams()[0]))&&
2147758681===ca.errorCode&&(O.isUpgraded=!0),2!==O.wL.getStatus()&&(1!==O.wL.getStatus()||ca&&2147758681===ca.errorCode))ca&&this.Aph(O,ca,null);else try{Ta.setOwnerAddinEToken(O.wL.getEToken()),Tb.action(Ta,xb.jva)}catch(wc){m.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?wc.stack:wc.message)),Mb.bLe(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}Aph(O,
ca,Ta=null){const xb=O.wL;if(1===xb.getNotificationParams().length||ca.Yjg){const Tb=ca.iUb,wc=ca.yXb;ca.iUb=()=>{xb.removeFirstNotification();if(0<xb.getNotificationParams().length){const sd=this.FIf(xb.getNotificationParams()[0]);this.Aph(O,sd)}2147758681===ca.errorCode&&(La.nGi(O.dJ,xb,Object(E.a)(this,this.Plg,"initUpgradeStateDetectTask")),v.hGi(O.SVb,xb,Object(E.a)(this,this.Plg,"initUpgradeStateDetectTask")));Tb&&Tb()};ca.yXb=()=>{wc&&wc();Ta&&Ta()};Mb.yal(ca)}}Plg(O,ca){let Ta=null;Ta=()=>
{O.getIsUpgrading()?window.setTimeout(Ta,1E3):O.getUpgradingFailed()?La.ofd(ca,!0):A.AFrameworkApplication.Aa.updateCommandUI()};window.setTimeout(Ta,1E3)}FIf(O){const ca=new Xd;ca.p5d=O.infoType;ca.id=O.id;ca.title=O.title;ca.description=O.description;ca.buttonText=O.buttonTxt;ca.iUb=O.buttonCallback;ca.Yjg=O.highPriority;ca.yXb=O.dismissCallback;ca.errorCode=O.errorCode;ca.Ntj=O.iframeNotificationUrl;return ca}}Object(h.a)(id,"AddinCommandsActionHandler",null,[1030]);class fd{constructor(){this.labelText=
null;this.visible=!1}}Object(h.a)(fd,"AddinStatusCommandValues",null,[]);class Vf{static NCk(O){const ca=new fd;ca.labelText=O.VSb;ca.visible=ca.labelText?!0:!1;return ca}static ILe(){const O=document.getElementById(void 0);O?Vf.nqh(void 0,void 0,O,void 0,void 0):m.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static nqh(O,ca,Ta,xb,Tb){Ta?O.VSb===CommonUIStrings.l_ErrorLoadingAddInsTitle?Mb.Ial(ca,Ta,xb,Tb):O.VSb===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
Mb.fcl(ca,Ta):m.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(h.a)(Vf,"AddinCommandsStatusHandler",null,[]);class Qd{constructor(){this.Dx=this.L_=0;this.JGd=null;this.S$c=this.gkd=0;this.jKa=this.nsd=this.Snd=this.cEc=this.tBa=this.qpa=null}get IGd(){this.Snd||(this.Snd=new e.a);return this.Snd}get AWd(){this.nsd||(this.nsd=new e.a);return this.nsd}get Y3a(){this.jKa||(this.jKa=new e.a);return this.jKa}}Object(h.a)(Qd,"AddinCommandsListLoaderContext",
null,[]);const Zf=O=>{const ca={};ca.solutionId=O.solutionId;ca.version=O.version;ca.storeType=O.storeType;ca.storeId=O.storeId;ca.assetId=O.assetId;ca.assetStoreId=O.assetStoreId;ca.targetType=O.targetType;ca.requireConsent=O.requireConsent||!1;ca.isAddinCommands=!0;ca.addinCommandsActionType=0;return ca};class Ge{constructor(O,ca){this.entitlement=O;this.metadata=ca}swh(){const O=Zf(this.entitlement);O.targetType=this.targetType;return O}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(h.a)(Ge,"AddinEntitlementEx",null,[]);var le=d(21);class Sa{constructor(O){this.og=null;this.O$=O}get_current(){if(!this.og)throw Error.argumentOutOfRange();return this.og.data}moveNext(){if(!this.og)return this.og=this.O$,!!this.O$;if(!this.og.next)return!1;
this.og=this.og.next;return!0}reset(){this.og=this.O$}}Object(h.a)(Sa,"ListEnumerator",null,[0]);class Cb{constructor(O,ca,Ta){this.next=Ta;this.previous=ca;this.data=O}}Object(h.a)(Cb,"ListNode",null,[]);class rc{constructor(){this.X1a=this.Ifa=null;this.Gk=0}add(O){this.Ifa?this.X1a=this.X1a.next=new Cb(O,this.X1a,null):this.Ifa=this.X1a=new Cb(O,null,null);this.Gk=this.count+1}insert(O,ca){if(O>this.count||0>O)throw Error.argumentOutOfRange("pos");if(O===this.count)this.add(ca);else{for(var Ta=
this.Ifa;0!==O--;)Ta=Ta.next;O=new Cb(ca,Ta.previous,Ta);O.previous?O.previous.next=O:this.Ifa=O;O.next?O.next.previous=O:this.X1a=O;this.Gk=this.count+1}}remove(O){let ca=this.Ifa;for(;ca&&ca.data!==O;)ca=ca.next;if(!ca)return!1;ca.previous?ca.previous.next=ca.next:this.Ifa=ca.next;ca.next?ca.next.previous=ca.previous:this.X1a=ca.previous;this.Gk=this.count-1;return!0}clear(){let O=this.Ifa,ca;for(this.X1a=this.Ifa=null;O;)ca=O.next,O.previous=null,O.next=null,O=ca;this.Gk=0}indexOf(O){let ca=this.Ifa,
Ta=0;for(;ca&&ca.data!==O;)ca=ca.next,Ta++;return ca?Ta:-1}ga(O){return this.at(O).data}get count(){return this.Gk}getEnumerator(){return new Sa(this.Ifa)}[Symbol.iterator](){return Object(le.a)(this.getEnumerator())}toArray(){const O=Array(this.count);let ca=0;for(let Ta of this)O[ca]=Ta,ca++;return O}at(O){let ca=this.Ifa,Ta=0;for(;Ta!==O;){if(!ca)throw Error.argumentOutOfRange("pos");ca=ca.next;Ta++}return ca}}Object(h.a)(rc,"List",null,[1]);class bd extends Sys.EventArgs{constructor(O){super();
this.properties=O}}Object(h.a)(bd,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class pd{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(h.a)(pd,"MiniAddinInfo",null,[]);class Oa{constructor(O,ca,Ta){this.hp=new C.a;this.context=new Qd;this.ZCd=this.HMe=this.Q2a=this.X_=this.D$=null;this.contextActivationMgr=O;this.m6h=ca;this.R2a=Ta;this.appName=A.AFrameworkApplication.fa.Ha("WebAppShortName")}get nvh(){this.ZCd||(this.ZCd=new xa(this.hp));return this.ZCd}i2h(O){this.hp.addHandler(P.a.TSb,
O)}y5h(O){this.hp.addHandler(P.a.dLe,O)}Eql(O){null!==O&&(this.context.L_=O[P.a.rpa],this.context.Dx=O[P.a.u6],this.context.gkd=this.context.S$c=0,O=P.a.Xmb in O?O[P.a.Xmb]:0,-1!==this.context.L_&&0!==this.context.Dx&&(this.context.qpa=new rc,this.context.tBa=new rc,this.context.cEc=new rc,this.context.JGd=this.m6h.createAddinDataProvider(Za(this.context.L_),this.contextActivationMgr),this.context.JGd?this.context.JGd.getEntitlementsAsync(this.contextActivationMgr.jva,!0,O,ca=>{this.slk(ca)}):m.ULS.sendTraceTag(17638145,
220,10,"Create AddinDataProvider fails for {0}",this.context.L_)))}slk(O){if(O&&0<O.length){this.context.gkd=O.length;const Ta=A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Ha():null;for(let xb=0;xb<O.length;xb++){const Tb=O[xb];if(A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&cb()&&Tb&&Tb.storeType&&"omex"===Tb.storeType.toLowerCase()&&Tb.assetId&&Ta&&Tb.assetId.toLowerCase()===Ta.toLowerCase()){var ca=
{["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:Oa.yV(Tb)};aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:L.a.dD(ca)}))}!Tb||1!==Tb.targetType&&-1!==Tb.targetType?this.n6c():(ca={},A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(ca.solutionId=Tb.solutionId,ca.version=Tb.version):(ca.marketplaceId=Tb.solutionId,ca.marketplaceVersion=Tb.version),ca.storeType=
Tb.storeType,ca.storeId=Tb.storeId,ca.targetData=Tb,Oa.Llc?this.contextActivationMgr.isAddinCommandsExAsync(ca,Object(E.a)(this,this.alk,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(ca,(wc,sd,$b)=>{wc?(sd&&this.context.qpa.add($b.targetData),10===this.context.L_&&(wc=$b.targetData,sd=wc.targetType,Ja.b($b.targetTypeForExp)||(sd=$b.targetTypeForExp,wc.targetType=sd),this.context.tBa.add(wc),0===sd&&this.context.cEc.add(wc))):($b=$b.targetData,m.ULS.sendTraceTag(542978528,
220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId($b.solutionId,$b.storeType,$b.assetId,null,null,$b.storeId),$b.storeType));this.n6c()}))}}else this.n6c()}n6c(){var O;(O=this.context).S$c=O.S$c+1;this.context.S$c>=this.context.gkd&&(this.R2a.Wjh(this.context.L_,!1),0<this.context.gkd&&10===this.context.L_&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(O=!1,A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&
sa()&&(O=this.FVj()),this.WUj(),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!O?Oa.Llc?this.nvh.Iol(this.contextActivationMgr,this.context.IGd,this.context.Y3a,(ca,Ta)=>{const xb=new e.a;for(let Tb of ca)ca=Tb.swh(),Ta&&Ta.solutionId===Tb.solutionId&&(ca.showCallout=!0,this.nvh.VBh(Ta)),xb.add(ca);this.nHa(xb)}):this.gXi(this.context.qpa):this.czc(this.context.qpa)):this.czc(this.context.qpa))}czc(O){if(Oa.Llc)this.nHa(this.Upi(this.context.IGd));
else{var ca=new e.a;if(O)for(let Ta of this.context.qpa)ca.add(Zf(Ta));this.context.qpa&&1>this.context.qpa.count&&T.a.XIb(P.a.USb,"false",this.context.L_);O={["ack2"]:ca};O[P.a.rpa]=this.context.L_;O[P.a.u6]=this.context.Dx;this.hp.raiseEvent(P.a.TSb,new bd(O),this)}}Upi(O){const ca=new e.a;if(O)for(let Ta of O)ca.add(Ta.swh());return ca}nHa(O){O&&O.count||T.a.XIb(P.a.USb,"false",this.context.L_);O={["ack2"]:O};O[P.a.rpa]=this.context.L_;O[P.a.u6]=this.context.Dx;this.hp.raiseEvent(P.a.TSb,new bd(O),
this)}wma(O){if(this.appName){const ca={},Ta={};Ta.LastTeachingUIShowTime=(new Date).toUTCString();Ta.AddinHasShown=O;ca[this.appName]=ia.c(Ta);this.D$&&(this.D$.Fqb(ca),m.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else m.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}gXi(O){(this.Q2a=O)?(O=new e.a,O.add(this.appName),this.D$=new pa(this.appName,Object(E.a)(this,
this.WBa,"getRequestSuccessCallback"),Object(E.a)(this,this.hia,"getRequestFailureCallback"),Object(E.a)(this,this.J9,"postRequestFailureCallback")),this.D$.jIc(O)):(O={["ack2"]:new e.a},O[P.a.rpa]=this.context.L_,O[P.a.u6]=this.context.Dx,this.hp.raiseEvent(P.a.TSb,new bd(O),this))}WBa(O){O?this.RKe(O)?(m.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.X_="AddinHasShown"in O&&O.AddinHasShown?O.AddinHasShown.toString():null,this.FVb()):(m.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),
this.czc(this.Q2a)):(m.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.X_=null,this.FVb())}hia(O){m.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",O?O.af:-1);this.czc(this.Q2a)}J9(O){m.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.af:-1)}FVb(){const O=this.gRd();if(0===O.targetType){O.solutionId?(this.HMe=O.solutionId,this.HAe()):this.JDa("NoSolutionId");if(O.addinId){const ca=
this.X_?this.X_+","+O.addinId:O.addinId;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=ca:this.wma(ca)}this.XAf(null)}else this.XAf(O.addinId);m.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",O.addinId)}HAe(){const O=new za.a;O.callbackFunc=ca=>{if(ca.errorCode){if(this.JDa("FailToGetAppDetails"),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)){var Ta=window.g_roamingAddinList;Ta&&this.wma(Ta)}}else if(ca.value)for(Ta of ca.value)if(ca=Ta[1],ca===this.HMe){const xb={};xb.solutionId=ca;xb.assetId=Ta[5];xb.storeType=Ta[12];xb.storeId=Ta[11];xb.assetStoreId=Ta[6];xb.targetType=Ta[3];xb.width=Ta[7];xb.height=Ta[8];xb.displayName=Ta[0];xb.version=Ta[4];Ta=new qa(xb);this.hp.raiseEvent(P.a.dLe,Ta);break}};O.storeType=OSF.StoreTypeEnum.PrivateCatalog;O.fromInsertDialog=!1;O.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(O)}RKe(O){if("LastTeachingUIShowTime"in
O){if(O=+new Date-+new Date(O.LastTeachingUIShowTime.toString()),O<A.AFrameworkApplication.fa.wP("AddinShowTeachingUIIntervalInMS",864E5))return m.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",O),!1}else m.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}gRd(){let O=new Ma.a(new pd,0),ca=new Ma.a(new pd,0),Ta=0,xb=0,Tb=0;var wc=new rc;if(0<this.context.qpa.count)for(var sd of this.context.qpa)wc.add(sd);if(0<this.context.cEc.count)for(let $b of this.context.cEc)wc.add($b);
for(let $b of wc)if(!("excatalog"!==$b.storeType||Ja.b($b.installTimeInMS)||!$b.installTimeInMS||$b.installTimeInMS<=A.AFrameworkApplication.fa.wP("DateTimeInMSForNewAddin",16409952E5))){wc=Oa.RZb($b);if(this.X_&&(sd=this.X_.split(","),0<sd.length&&Array.contains(sd,wc))){Tb++;m.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}wc.startsWith("private_")?(O.value<$b.installTimeInMS&&(O=new Ma.a(Object.assign(new pd,{addinId:wc,targetType:$b.targetType,solutionId:$b.solutionId}),
$b.installTimeInMS)),xb++):(ca.value<$b.installTimeInMS&&(ca=new Ma.a(Object.assign(new pd,{addinId:wc,targetType:$b.targetType,solutionId:$b.solutionId}),$b.installTimeInMS)),Ta++)}m.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",xb,Ta,Tb);return 0<ca.value?ca.key:0<O.value?O.key:Object.assign(new pd,{addinId:null,targetType:-1,solutionId:null})}XAf(O){const ca=new e.a;for(let xb of this.Q2a){const Tb=Zf(xb);if(O){var Ta=
Oa.RZb(xb);O===Ta&&(Tb.showCallout=!0,Ta=this.X_?this.X_+","+O:O,A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Ta:this.wma(Ta))}ca.add(Tb)}this.Q2a&&1>this.Q2a.count&&T.a.XIb(P.a.USb,"false",this.context.L_);O={["ack2"]:ca};O[P.a.rpa]=this.context.L_;O[P.a.u6]=this.context.Dx;this.hp.raiseEvent(P.a.TSb,new bd(O),this)}FVj(){if(Oa.Llc)return this.GVj(this.context.AWd);var O=!1;if(this.context.tBa&&1>this.context.tBa.count)return O;
const ca=Ha();if(!ca)return O;for(let Ta of this.context.tBa)if(Ta.storeId&&Ta.storeId.toLowerCase()===ca.toLowerCase()||Ta.assetId&&Ta.assetId.toLowerCase()===ca.toLowerCase())O={["SDX_Id"]:Oa.yV(Ta),["SDX_TargetType"]:Ja.b(Ta.targetType)?"":Ta.targetType.toString()},aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:L.a.dD(O)})),O=!0;return O}WUj(){if(Oa.Llc)this.XUj(this.context.AWd);else if(!(this.context.tBa&&1>this.context.tBa.count))if(this.R2a.qug()){var O=
this.R2a.$bg();O?(O=this.i8f(this.context.tBa,O),m.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(O=this.i8f(this.context.tBa,null),m.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.R2a.Clh(O)}else m.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}i8f(O,ca){const Ta={};let xb=!1;for(let Tb of O)if(O=Oa.yV(Tb))!ca||O in ca||(this.KSa(Tb,O),m.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===O.toLowerCase()?
xb||(xb=!0,Ta[O]=null):Ta[O]=null;return Ta}KSa(O,ca){var Ta=O.installTimeInMS?(new Date(O.installTimeInMS)).toISOString():"";Ta={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ja.b(O.targetType)?"":O.targetType.toString(),["SDX.AdminDeploymentTime"]:Ta};aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:L.a.dD(Ta)}));1===O.targetType&&(O={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},
aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:L.a.dD(O)})))}GVj(O){let ca=!1;if(O&&1>O.count)return ca;const Ta=Ha();if(!Ta)return ca;for(let xb of O)if(xb.storeId&&xb.storeId.toLowerCase()===Ta.toLowerCase()||xb.assetId&&xb.assetId.toLowerCase()===Ta.toLowerCase())O={["SDX_Id"]:Oa.bcg(xb),["SDX_TargetType"]:Ja.b(xb.targetType)?"":xb.targetType.toString()},aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.EmailAlertNotification",
dataFields:L.a.dD(O)})),ca=!0;return ca}XUj(O){if(!(O&&1>O.count))if(this.R2a.qug()){var ca=this.R2a.$bg();ca?(O=this.j8f(O,ca),m.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(O=this.j8f(O,null),m.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.R2a.Clh(O)}else m.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}j8f(O,ca){const Ta={};let xb=!1;for(let Tb of O)if(O=Oa.bcg(Tb))!ca||O in ca||(this.MXj(Tb,O),m.ULS.sendTraceTag(527523849,306,50,
"New addin detected,log to AppInstall")),"private"===O.toLowerCase()?xb||(xb=!0,Ta[O]=null):Ta[O]=null;return Ta}MXj(O,ca){var Ta=O.installTimeInMS?(new Date(O.installTimeInMS)).toISOString():"";Ta={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ja.b(O.targetType)?"":O.targetType.toString(),["SDX.AdminDeploymentTime"]:Ta};aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:L.a.dD(Ta)}));1===O.targetType&&(O={["SDX.Id"]:ca,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:L.a.dD(O)})))}alk(O,ca,Ta,xb){O?(-1===xb.targetType&&(xb.targetType=Ta.targetTypeForExp),O=new Ge(Ta.targetData,xb),ca&&this.context.IGd.add(O),10===this.context.L_&&(this.context.AWd.add(O),0===O.targetType&&this.context.Y3a.add(O))):(ca=Ta.targetData,m.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.storeType,ca.assetId,null,null,ca.storeId),ca.storeType));this.n6c()}JDa(O){O={["AppTeachingUICalloutAction"]:O,["SDX.Id"]:this.HMe,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:L.a.dD(O)}))}static get Llc(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static yV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static bcg(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static RZb(O){return Telemetry.PrivacyRules.IsPrivateAddin(O.storeType,O.assetId,null,null,O.storeId)?"private_"+O.installTimeInMS:O.solutionId}}Object(h.a)(Oa,"AddInCommandsListLoader",null,[]);var jb=d(1088),nc=d(176),kb=d(1191),Gb=d(27),tc=d(60);class dd{constructor(O,
ca,Ta){this.u9a=this.ODa=this.Pca=this.fbb=null;this.ioe=this.J1c=-1;this.BG=null;this.UNg=!1;this.fCg=O;this.$b=ca;this.iCg=this.$b.Ec("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);this.WYj=this.$b.Ec("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.qWc=this.$b.Ha("WebAppShortName");this.Qc=Ta;ja.a.Va(this.qWc)&&(this.qWc="PowerPoint")}yV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}nMk(O){this.BG=O;this.Qc.Rmb(Object(E.a)(this,
this.VYg,"onInsertTabSwitched_ContentAddin"));window.addEventListener("LaunchContentAddin",Object(E.a)(this,this.ppk,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",Object(E.a)(this,this.kjk,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(E.a)(this,this.jik,"onCloseButtonClicked_ContentAddin"),!0)}llk(){this.Pca&&this.u9a&&(this.fCg.i1b({["SourceControlId"]:this.u9a}),m.ULS.sendTraceTag(512499854,220,50,"Launch addin command has been triggered"))}Oal(O,
ca){ca?(this.Pca=ca.hu,(this.fbb=ca.dJ)&&this.fbb.G9&&this.fbb.G9.EE&&(this.ODa=this.fbb.G9.EE.ga(0)),this.ODa?this.ODa.isOfficeTab?(O=this.Pca.solutionId,ca=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),O in ca?this.u9a=ca[O]:(m.ULS.sendTraceTag(512499852,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",this.yV(this.Pca)),this.u9a=this.dXi(this.fbb)),this.u9a?0<this.ODa.id.indexOf(tc.a.I$g)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ca.srb(this.fbb),
()=>{this.Eqh(this.PMc(this.u9a))}):this.Qc.Rmb(Object(E.a)(this,this.H0g,"onTabSwitched")):(this.LSa("NoEnabledButtonFound",this.Pca),m.ULS.sendTraceTag(512499851,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.iGa())):this.Gqh(this.PMc(this.ODa.id),0):(this.LSa("NoTabFound",this.Pca),m.ULS.sendTraceTag(512499853,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.iGa())):this.iGa()}H0g(O,ca){!this.ODa||void 0===this.ODa.id||null===this.ODa.id||
0>ja.a.sg(this.ODa.id).indexOf(ja.a.sg(ca.jla))||(this.Qc.Rhc(Object(E.a)(this,this.H0g,"onTabSwitched")),this.PLd(ca.XVg,ca.jla,this.iCg,!1))}VYg(O,ca){"Insert"===ca.jla&&(this.Qc.Rhc(Object(E.a)(this,this.VYg,"onInsertTabSwitched_ContentAddin")),this.PLd(ca.XVg,ca.jla,this.iCg,!0))}PLd(O,ca,Ta,xb){if(0>Ta)this.LSa("TabSwitchTimeOut",this.Pca);else{var Tb=document.querySelector("button"+this.PMc(ca));Tb.hasAttribute("aria-selected")&&"false"!==Tb.getAttribute("aria-selected")?(0<this.ioe&&window.clearTimeout(this.ioe),
xb?this.edl():this.Eqh(this.PMc(this.u9a))):this.ioe=window.setTimeout(()=>{this.PLd(O,ca,Ta-1,xb)},1E3)}}PMc(O){return"[id="+O+"]"}edl(){let O=document.querySelector("button[data-unique-id = 'Ribbon-InsertAddIns']");var ca=O?window.getComputedStyle(O,null):null;if(!O||ca&&"none"===ca.display)if(O=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))m.ULS.sendTraceTag(512499849,220,15,"Callout show on Overflow button");else{this.mwb("NoAnchor",this.BG);m.ULS.sendTraceTag(512499850,
220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}else m.ULS.sendTraceTag(512499848,220,15,"Callout show on OfficeAddin Button");(ca=mc.a.instance.La("Common.ISystemInitiatedFeedback"))&&O?(ca.execute(Ta=>{Ta.logActivity("ShowTeachingUIForContentAddin",null)}),this.mwb("Show",this.BG),m.ULS.sendTraceTag(512499846,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):(this.mwb("NoSifFutureObject",this.BG),m.ULS.sendTraceTag(512499847,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}ppk(){this.mwb("ClickOnLaunch",
this.BG);this.iGa();const O={};O.solutionId=this.BG.solutionId;O.assetId=this.BG.assetId;O.assetStoreId=this.BG.assetStoreId;O.height=this.BG.height?this.BG.height:600;O.storeId=this.BG.storeId;O.targetType=this.BG.targetType;O.width=this.BG.width?this.BG.width:600;O.displayName=this.BG.displayName;O.version=this.BG.version;O.storeType=this.BG.storeType;O.isAddinCommands=!1;this.fCg.qe.Yvb("0",3,O)}jik(){this.mwb("ClickOnClose",this.BG);this.iGa()}kjk(){this.mwb("ClickOnDismiss",this.BG);this.iGa()}Gqh(O,
ca){if(ca>this.WYj)window.clearTimeout(this.J1c),this.Fqh("[data-unique-id='pivotOverflowButton']"),m.ULS.sendTraceTag(512499845,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var Ta=document.querySelector("button"+O);!Ta||Ta.hasAttribute("tabIndex")&&"-1"===Ta.getAttribute("tabIndex")?this.J1c=window.setTimeout(()=>{this.Gqh(O,ca+1)},1E3):(0<this.J1c&&window.clearTimeout(this.J1c),this.Fqh(O))}}Eqh(O){let ca=document.querySelector("button[data-unique-id='RightPaddle']");
if(ca)this.LSa("RightPaddlePresent",this.Pca);else if(O=(ca=document.querySelector("button"+O))?window.getComputedStyle(ca,null):null,!ca||O&&"none"===O.display)if(ca=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ca){this.LSa("NoAnchor",this.Pca);m.ULS.sendTraceTag(512499844,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.iGa();return}this.rxh(ca,"ShowTeachingUIForAddinButton")}Fqh(O){let ca=document.querySelector("button"+O);if(!ca&&("[data-unique-id='pivotOverflowButton']"!==
O&&(ca=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!ca)){this.LSa("NoAnchor",this.Pca);m.ULS.sendTraceTag(512499843,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.iGa();return}this.rxh(ca,"ShowTeachingUIForAddinTab")}rxh(O,ca){O.setAttribute("lpp-id","latestAddin");const Ta=mc.a.instance.La("Common.ISystemInitiatedFeedback");Ta&&O?(this.LSa("Show",this.Pca),Ta.execute(xb=>{xb.logActivity(ca,null)}),m.ULS.sendTraceTag(512499841,220,50,"TriggerLPPActivity triggered an LPP activity")):
(this.LSa("NoSifFutureObject",this.Pca),m.ULS.sendTraceTag(512499842,220,15,"TriggerLPPActivity failed to get a sifFuture"),this.iGa())}dXi(O){if(!O||!O.G9||!O.G9.EE)return null;for(let ca of O.G9.EE)if(ca)for(const Ta of ca.groups)if(Ta)for(const xb of Ta.controls){if(xb&&xb.attributes&&0===xb.controlType&&xb.enabled)return xb.id;if(xb.menuItems)for(const Tb of xb.menuItems)if(Tb.attributes&&Tb.enabled)return xb.id}return null}LSa(O,ca){dd.KSa(O,this.yV(ca))}mwb(O,ca){ca=Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,
ca.storeType,ca.assetId,null,null,ca.storeId);dd.KSa(O,ca)}wma(O){const ca={};ca[this.qWc]=ia.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:O});(new pa(this.qWc,null,null,Object(E.a)(this,this.J9,"postRequestFailureCallback"))).Fqb(ca);m.ULS.sendTraceTag(512499840,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}J9(O){m.ULS.sendTraceTag(512499811,306,15,"failed to POST data to Roaming Settings Service with status: {0}",
O?O.af:-1)}iGa(){if(this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.UNg){const O=window.g_roamingAddinList;O&&(this.wma(O),this.UNg=!0)}}static KSa(O,ca){O={["AppTeachingUICalloutAction"]:O,["SDX.Id"]:ca,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};aa.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:L.a.dD(O)}))}}Object(h.a)(dd,"AddinTeachingCalloutHandler",
null,[]);class $c{}Object(h.a)($c,"AddinCommandsHost",null,[]);var Pc=d(82),Ad=d(131);class Ee extends Pc.a{constructor(){super(void 0,void 0,void 0,!0);this.KLb="AddinCommandsUILessDialog";this.zDd="WACDialogTitleText";this.Wib="0";this.B_a=380;this.NLb=190;this.kg=this.KLb;this.vd=5;this.eJh=String.format("{0}px",this.B_a);this.Vib=String.format("{0}px",this.NLb);this.m3d=this.hr=!1;this.$w()}$w(){super.$w();this.Zy.style.width=this.eJh;this.Zy.style.height=this.Vib;this.Zy.style.padding=this.Wib}gwa(O){this.DF();
document.getElementById(this.hi(this.zDd)).innerText=O}DF(){super.DF();this.pc.style.width=String.format("{0}px",this.B_a);this.pc.style.height=String.format("{0}px",this.NLb);this.pc.removeAttribute(Ad.a.We);this.pc.removeAttribute(Ad.a.y6)}hide(){this.a4d()}get C4a(){return this.Zy}initializeAndShowWithTitle(){this.pj(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(h.a)(Ee,"AddinCommandsUILessDialog",Pc.a,[1029]);var Ce=d(39),Fb=d(165),$e=d(37),bg=d(326),Ye=d(40);class Ae extends $c{constructor(O,
ca,Ta,xb){super();this.tE=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.gb&&A.AFrameworkApplication.Aa.gb.UV;this.J8=O;this.Xd=ca;this.h2j=Ta;this.Pbb=xb}setOwnerAddinEToken(O){this.J8.eToken=O}showTaskpane(O,ca,Ta){m.ULS.sendTraceTag(17687394,220,50,String.format("ShowTaskpane action called."));this.zmg(O,ca,Ta,!0)||m.ULS.sendTraceTag(17687395,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(O,ca,Ta){m.ULS.sendTraceTag(17687424,220,50,String.format("UILess action called."));
this.zmg(O,ca,Ta,!1,this.h2j)||m.ULS.sendTraceTag(17687425,806,10,String.format("UILess : instance id is null."))}disposeHost(){}zmg(O,ca,Ta,xb,Tb=!1){var wc=this.Xd.fZ(O.solutionId);wc||(wc=this.Xd.JRi(O,ca,this.J8.solutionId,Tb));if(wc&&this.Xd.bsa(wc.instanceId))return this.Xd.teb(wc.instanceId),Ta(wc.instanceId,0),Tb||this.Xd.NFb(wc.instanceId,xb),!0;let sd=null;if(!wc)if(wc=this.Xd.jdi(O,ca,xb,this.J8.solutionId,Tb),wc.setValue($e.a.ownerAddinStoreType,this.J8.storeType),sd=wc.sa(Fb.a.sharedRuntimeId,
null),this.lBg(!!sd,!0),Tb&&(Tb=Tb&&!sd),ca=Tb?new Ee:null,Tb?this.Xd.egb(wc,ca.C4a):(Ye.a("SharedRuntimeHiddenTaskpaneFix")&&wc.setValue(Ce.a.kTb,xb||!!sd),this.Xd.Jdh(wc)),wc=this.Xd.fZ(O.solutionId))if(Tb&&this.Pbb.$(wc.instanceId,ca),O=this.Xd.mBa(this.J8.solutionId)){if(O=new bg.a(O),this.Xd.sAh(O.id,wc.instanceId),sd&&!this.Xd.gZb(O.Wla)&&(O=this.Xd.bXd(O.Wla)))O.Hu||O.hZh(sd),this.Xd.lzc(this.J8.solutionId,O)}else{O=this.Xd.idi(this.J8,sd);if(!O)return Ta(null,5001),!1;this.Xd.lzc(this.J8.solutionId,
O);this.QUj(!!sd)}else return Ta(null,5001),!1;Ta(wc.instanceId,0);this.tE&&(Ta=this.Xd.bsa(wc.instanceId),this.Xd.NFb(wc.instanceId,Ta?xb:!0));this.lBg(!!sd,!1);return!0}lBg(O,ca){O&&window.performance&&window.performance.memory&&m.ULS.sendTraceTag(562701315,802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",ca,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}QUj(O){m.ULS.sendTraceTag(539276249,
802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.J8.solutionId,this.J8.storeType,this.J8.assetId,null,null,this.J8.storeId),this.J8.storeType,O)}}Object(h.a)(Ae,"WACPowerPointAddInCommandsHost",$c,[]);var si=d(205);class Jf{constructor(O,ca,Ta,xb,Tb,wc,sd,$b,ge,we,oe){this.BG=this.WPg=null;if(!O)throw Error.argumentNull("app");this.Gsa=new M;this.WDg=Ta;this.Nb=O.$q;this.gf=sd;this.Xd=ca;this.qja=wc;this.Xd.Z3h(Object(E.a)(this,
this.Rmi,"clearLoadingAddinMessage"));this.Gsa.k2h(Object(E.a)(this,this.ijj,"handleAddinCommandsLoadingMessageChanged"));this.Ga=xb;this.$b=Tb;jb.a.X1b=jb.a.w5g;this.Pbb=new Qb.a;this.txb=ge;this.ql=we;this.v_j=new e.a;this.fxb=new e.a;this.Qc=oe}get qe(){return this.Xd}$Uc(O){m.ULS.sendTraceTag(512499869,220,50,"LaunchOperationType {0}.",O[P.a.u6]);if(this.Ga.M9d||!this.Ga.ypa){var ca=O[P.a.Uzc];if(ca&&0<ca.count){const xb=ca.count;for(let Tb=xb-1;0<=Tb;Tb--){const wc=ca.ga(Tb);OSF.OsfControl.isFirstPartyStoreString(wc.storeType)||
ca.remove(ca.ga(Tb))}ca.count<xb&&(this.Ga.M9d&&!this.ql.Yba(22)&&this.ql.OAa(22),this.Ga.ypa||this.ql.Yba(36)||this.ql.OAa(36));if(!ca.count)return}}let Ta=null;Ta=A.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?new Kc(this.qja,this.WDg,new gc(this.Xd.yn),new gd("",Vd.a.I2a),this.Gsa,hd.instance,new Hd,(xb,Tb)=>{const wc={};wc.solutionId=xb.solutionId;wc.version=xb.version;wc.storeType=xb.storeType;wc.storeId=xb.storeId;wc.assetId=xb.assetId;wc.assetStoreId=xb.assetStoreId;this.Xd.ldl(wc,
()=>{Tb(xb)})}):new Kc(this.qja,this.WDg,new gc(this.Xd.yn),new gd("",Vd.a.I2a),this.Gsa,hd.instance,new Hd);Ta.v2h(Object(E.a)(this,this.Bhk,"onAutoLaunchAddin"));Ta.j2h(Object(E.a)(this,this.mlk,"onLaunchAddinCommandsCompleted"));this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&(ca=new dd(this,this.$b,this.Qc),Ta.e3h(Object(E.a)(ca,ca.llk,"onLaunchAddinButtonClicked")),Ta.w5h(Object(E.a)(ca,ca.Oal,"showCalloutOnAddin")));try{nc.a.get_instance().Xj(5,
null).continueWith(()=>{Ta.RRj(this.txb,Gb.App.Fb.kG(),O)},11)}catch(xb){m.ULS.sendTraceTag(512499868,220,10,String.format("LaunchAddinCommands error message : {0}.",xb.message))}}gjj(O){O=O[this.qja.QNa];O=(new id).UEd(O);return A.AFrameworkApplication.ypa||OSF.OsfControl.isFirstPartyStoreString(O.ownerAddinInfo.storeType)}i1b(O){const ca=new id;this.x2d(ca,O[this.qja.QNa])}x2d(O,ca){const Ta=O.UEd(ca),xb=new Ae(Ta.ownerAddinInfo,this.Xd,this.Ga.Hia,this.Pbb);O.i1b(ca,this.Gsa,xb,new gc(this.Xd.yn),
Ta)}R7g(O){const ca=Vf.NCk(this.Gsa);O[kb.a.LabelText]=ca.labelText;O[kb.a.Visible]=ca.visible}zal(){this.ILe()}YGb(O){O&&P.a.LGd in O&&O[P.a.LGd]&&Mb.bLe(O[P.a.LGd].toString())}DJk(){if(this.Gsa.Sbe()){this.Gsa.RMf();const O=this.gXd();if(O&&0<O.count)for(let ca of O)this.ZEb({["ack1"]:ca,["ack0"]:4,["ak0"]:(new Date).getTime()})}}ijj(){this.gf.RD(new si.a(2));this.ILe()}ZEb(O){m.ULS.sendTraceTag(512499867,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",
O[P.a.u6],O[P.a.rpa]);this.Gsa.C0k();window.setTimeout(()=>{const ca=new Oa(new gc(this.Xd.yn),hd.instance,Rb.instance);ca.i2h((Ta,xb)=>{this.$Uc(xb.properties)});ca.y5h((Ta,xb)=>{this.BG=xb;this.WPg=new dd(this,this.$b,this.Qc);this.WPg.nMk(this.BG)});ca.Eql(O)},0)}Rmi(){this.Gsa.RMf()}Dai(O){var ca=this.Xd.fZ(O);if(ca&&ca.Hu&&ca.Hu.uma&&!(0>=ca.Hu.state)){var Ta=new id,xb;if(xb=this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Ta.getTaskPaneControlIdFromSolutionIdRuntimeId(O,
ca.Hu.uma):Ta.getTaskPaneControlIdFromAssetIdRuntimeId(O,ca.Hu.uma))this.Xd.lzc(O,ca),this.x2d(Ta,xb),this.Xd.ZNf(O),(ca=this.Xd.fZ(O+xb))?this.Xd.setInitialDisplayMode(ca.instanceId,1):m.ULS.sendTraceTag(512499866,802,10,"Failed to find auto-loaded shared runtime pane for "+O)}}Hai(O){if(O&&O.solutionId){var ca=new id,Ta=ca.Iai;if(Ta=O.solutionId in Ta?Ta[O.solutionId]:null){let xb=this.Xd.fZ(O.solutionId);if(!xb){xb=this.Xd.bXd(O.solutionId);if(!xb){m.ULS.sendTraceTag(512499864,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)));return}this.Xd.lzc(O.solutionId,xb)}O=xb.settings;(O=P.a.kDf in O?O[P.a.kDf]:null)&&"true"===O.toLowerCase()&&this.x2d(ca,Ta)}}else m.ULS.sendTraceTag(512499865,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}H8k(O){if(void 0===O||null===O||void 0===O[this.qja.QNa]||null===O[this.qja.QNa])return!1;O=O[this.qja.QNa];return ja.a.Va(O)?!1:this.fxb.contains(O)}B4k(O){O=O.G9;
if(!O)m.ULS.sendTraceTag(512499863,220,15,"Ribbon Extensibility for React ribbons should not be null.");else if(O.EE)for(let ca of O.EE)if(ca.groups)for(const Ta of ca.groups)if(Ta.controls)for(const xb of Ta.controls)if(this.oOe(xb.id,xb.enabled),1===xb.controlType&&xb.menuItems)for(const Tb of xb.menuItems)this.oOe(Tb.id,Tb.enabled)}oOe(O,ca){if(O&&O.length){var Ta=this.fxb.contains(O);Ta&&ca&&this.fxb.remove(O);Ta||ca||this.fxb.add(O)}}Dtl(O){let ca=null,Ta=null,xb=!0;void 0!==O[P.a.uSd]&&null!==
O[P.a.uSd]&&void 0!==O[this.qja.QNa]&&null!==O[this.qja.QNa]&&void 0!==O[P.a.sSd]&&null!==O[P.a.sSd]&&(ca=O[P.a.uSd],Ta=O[this.qja.QNa],xb=O[P.a.sSd]);ja.a.Va(ca)||ja.a.Va(Ta)||(O=(new gb("",ca,this.qja,!0)).FBa(Ta),this.oOe(O,xb),this.Nb.updateCommandUI())}IYb(O){if(void 0!==O&&null!==O&&void 0!==O[P.a.tSd]&&null!==O[P.a.tSd])switch(O[P.a.tSd]){case 1:this.Dtl(O);break;case 4:this.fxb.clear(),this.fxb.addRange(this.v_j)}}Bhk(O,ca){if(ca)if(ca)if(O=ca.hu,ca=ca.dJ,this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CheckIsDeepLinkTemplateFile",
!1)&&(cb()||sa())&&!this.Xd.bXd(O.solutionId))m.ULS.sendTraceTag(512259016,220,15,String.format("AppForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)));else{var Ta=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(ca=O.solutionId in Ta?Ta[O.solutionId]:this.N_i(ca))?(this.i1b({["SourceControlId"]:ca}),O.isAutoLaunched=!0):m.ULS.sendTraceTag(512499860,220,15,"addinCommandControlId is null")}else m.ULS.sendTraceTag(512499861,
220,15,"agaveParams is null");else m.ULS.sendTraceTag(512499862,220,15,"No args for OnAutoLaunchAddin event")}N_i(O){if(!O)return m.ULS.sendTraceTag(512499859,220,10,"Failed to get button id for addin"),null;O=O.G9;if(!O||!O.EE||!O.EE.count)return m.ULS.sendTraceTag(512499858,220,15,"It has 0 or multiple tabs"),null;O=O.EE.ga(0);if(!O.groups||1!==O.groups.length)return m.ULS.sendTraceTag(512499857,220,15,"It has 0 or multiple groups"),null;O=O.groups[0];if(!O.controls||1!==O.controls.length)return m.ULS.sendTraceTag(512499856,
220,15,"It has 0 or multiple buttons"),null;O=O.controls[0];return O.attributes&&0===O.controlType&&O.enabled?O.id:null}mlk(O,ca){let Ta=null;ca&&(Ta=ca);Ta&&Ta.dJ&&this.B4k(Ta.dJ);Ta?(Ta.hu&&this.Dai(Ta.hu.solutionId),this.Ga.tBj&&window.setTimeout(()=>{Ta.hu&&this.Hai(Ta.hu)},0)):m.ULS.sendTraceTag(512499855,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}gXd(){const O=new e.a;this.Ga.Rra&&(this.Ga.Pqg&&O.add(0),this.$b.ka("187")&&O.add(1),this.$b.ka("305")&&O.add(10),
O.add(8));return O}ILe(){const O=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");Vf.nqh(this.Gsa,this.Nb.kG(),O,ResourceStrings.L_Insert,CommonUIStrings.L_ButtonOfficeAddins)}Ekc(O){O&&this.Pbb.Jb(O)&&this.Pbb.ga(O).initializeAndShowWithTitle()}T1b(O){O&&this.Pbb.Jb(O)&&this.Pbb.ga(O).hide()}}Object(h.a)(Jf,"AddinCommandsManager",null,[1007]);class tg{constructor(){this.FPg={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",
["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",["tabview"]:"PptRibbon.View"};this.$Kg={["tabslideshow"]:["PptRibbon.SlideShow",ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};
this.q0c=null}get QNa(){return"SourceControlId"}get rS(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}X6i(){if(!this.q0c){this.q0c={};for(const O of Object.keys(this.FPg))this.q0c[O]=this.FPg[O];for(const O of Object.keys(this.$Kg))this.q0c[O]=this.$Kg[O][0]}}}Object(h.a)(tg,"AddinCommandsStringProvider",null,[1006]);class Dg{constructor(O){this.tti=O}PVi(){return this.tti.ydi()}}Object(h.a)(Dg,"ContextMenuExtensibilityHandler",null,[1005]);var Vg=d(78);class Ih{constructor(O,ca,
Ta,xb){this.Ele=null;this.Xd=O;this.TPg=ca;this.ra=Ta;this.Lg=xb}get v5b(){return this.Ele}set v5b(O){this.Ele=O}register(){this.ra.XJ(Object(E.a)(this,this.Jed,"selectionChangeEventHandler"));Ye.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Lg.Smb(Object(E.a)(this,this.Jed,"selectionChangeEventHandler"))}dispose(){this.ra.zHa(Object(E.a)(this,this.Jed,"selectionChangeEventHandler"));Ye.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Lg.Gcd(Object(E.a)(this,this.Jed,"selectionChangeEventHandler"))}Jed(){try{this.v5b&&
this.TPg.Qg(this.v5b),this.Ele=new Vg.a(4,1,0,()=>{this.v5b=null;this.nol()},90,"50"),this.TPg.Gb(this.v5b)}catch(O){m.ULS.sendTraceTag(18442309,802,10,O.toString())}}nol(){try{this.Xd.y9g(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),null);const ca=this.ra.Ip();if(ca){var O=ca.om();if(O)for(const Ta of O)if(Ta.Nq){const xb=new bg.a(Ta);this.Xd.OWa(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),xb.id,null)}}}catch(ca){m.ULS.sendTraceTag(18442310,802,10,ca.toString())}}}
Object(h.a)(Ih,"AppForOfficeApiSelectionChangeEventListener",null,[997,106]);var hf=d(538),ld=d(968),ph=d(706);class Kf{}Kf.generalException="generalException";Kf.invalidArgument="invalidArgument";Kf.notAllowed="notAllowed";Kf.apiNotAvailable="apiNotAvailable";Kf.unresolvedPendingRequest="unresolvedPendingRequest";Kf.timeout="timeout";Kf.adalTimeout="adalTimeout";Kf.userNotSignedIn="userNotSignedIn";Kf.userAborted="userAborted";Kf.silentSignInFailed="silentSignInFailed";Kf.invalidResourceUrl="invalidResourceUrl";
Kf.invalidGrant="invalidGrant";Kf.connectionLost="connectionLost";Kf.clientError="clientError";Kf.serverError="serverError";Object(h.a)(Kf,"WopiHostErrorCodes",null,[]);var Ud=d(259);class He{}Object(h.a)(He,"OAuthCallerMetadata",null,[]);var Bh=d(54);class eg{constructor(O){this.dL=O;this.MKh=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}EYh(O,ca,Ta,xb,Tb,wc){if(!this.dL)return xb=new ld.a,xb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(xb);const sd=new He;sd.AddinName=Tb;sd.AddinTrustId=wc;let $b=-1;wc=null;if(xb&&this.Ztg())wc=this.dL.gyh(P.a.Ejd,O,xb,eg.ecg(Tb),sd);else{const ge=Date.now();wc=this.dL.q0(P.a.Ejd,O,sd).then(we=>{$b=Date.now()-ge;const oe=(ca||Ta)&&"login_required"===we.ErrorCode;return(ca&&("interaction_required"===we.ErrorCode||"consent_required"===we.ErrorCode||"invalid_grant"===we.ErrorCode)||oe)&&this.Ztg()?this.dL.gyh(P.a.Ejd,O,null,eg.ecg(Tb),sd):Promise.resolve(we)})}return wc.then(ge=>{const we=
new ld.a;ge.IsSuccess?(we.token=ge.Token,ge.Telemetry&&(we.khb=ge.Telemetry.fromCache,we.expiresOn=ge.Telemetry.expiresOn)):(we.errorCode=this.xak(ge),we.TOe=this.Nsk(ge));return we}).catch(()=>{const ge=new ld.a;ge.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(ge)}).then(ge=>{ge.Mza="OauthManager";0<=$b&&(ge.N0b=$b);return ge})}sFj(O){const ca=(A.AFrameworkApplication.fa.Ha(A.AFrameworkApplication.oJ)||"").toLowerCase();return(Bh.a.xDa||"teams"===ca&&Ud.a.u7a)&&
!eg.NEj(O)||!this.dL||!this.dL.mCj()?!1:!0}Ztg(){return this.MKh||1!==ph.a.wKc()}xak(O){switch(O.ErrorCode){case "UserCancelled":case "interaction_required":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:O=O.ErrorCode===Kf.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:O.ErrorCode===Kf.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:O.ErrorCode===Kf.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:O.ErrorCode===Kf.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:O.ErrorCode===Kf.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return O}Nsk(O){let ca="";(O=RegExp("AADSTS(\\d+)").exec(O.ErrorMessage))&&1<O.length&&(ca=O[1]);return ca}static ecg(O){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,O)}static NEj(O){if(!O)return!1;O=O.toLowerCase();for(const ca of hf.AppsForOfficeSingleSignOnManager.lJc)if(ca===
O)return!0;return!1}}Object(h.a)(eg,"AppsforOfficeTokenFromOauthManager",null,[1095]);class jd{constructor(O){this.K9j=O}static nRe(){if(A.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var O=null;try{O=mc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ca){m.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ca)}O=new eg(O);jd.Ja=new jd(O)}}static getInstance(){jd.j5e||(jd.nRe(),jd.j5e=!0);return jd.Ja}}jd.Ja=null;jd.j5e=!1;Object(h.a)(jd,"AppsForOfficeOauthManagerFactory",
null,[1061]);class Jh{constructor(O){const ca=jd.getInstance();this.Kuf=new hf.AppsForOfficeSingleSignOnManager(O,ca)}getAccessTokenAsync(O,ca){return new Promise(Ta=>{const xb=A.AFrameworkApplication.fa.ka("342");this.Kuf.getAccessToken(O,xb,ca,(Tb,wc)=>{const sd={};sd.errorCode=Tb;sd.accessToken=wc?wc.accessToken:"";Ta(sd)})})}removeCallbackForAddin(O){this.Kuf.removeCallbackForAddin(O)}}Object(h.a)(Jh,"AppForOfficeAuthProvider",null,[1018]);class kf{Fvi(O){return new Jh(O)}}Object(h.a)(kf,"AppForOfficeAuthFactory",
null,[975]);var Ji=d(225),hh=d(63),Wb=d(47),Uc=d(613);class Sc{constructor(O,ca,Ta,xb,Tb,wc,sd){this.zpe=this.ype=this.Zme=this.Yme=0;this.TLg=.5;this.xyb=null;this.Qie=0;this.kZj={};this.e$b=document.createElement("div");this.e$b.className="OsfAddinOverlay";ca.appendChild(this.e$b);Ta.u2k(this.e$b);this.L$j=O;this.NI=sd;this.NI.zzc(Object(E.a)(this,this.yCb,"onZoomed"));this.ta=xb;this.Hc=Tb;this.xq=wc;this.xq.GY(Object(E.a)(this,this.cDe,"registerSlideViewElementEvents"))}dispose(){this.NI.vcd(Object(E.a)(this,
this.yCb,"onZoomed"));this.xq.Nva(Object(E.a)(this,this.cDe,"registerSlideViewElementEvents"))}initialize(){if(this.ta.Ba){this.cDe(null,null);const O=this.Hc.Jc;O&&(this.Yme=parseFloat(O.yT.style.left),this.Zme=parseFloat(O.yT.style.top),this.ype=parseFloat(O.oe.ya.style.left),this.zpe=parseFloat(O.oe.ya.style.top))}this.TSe();this.yCb(null,new Uc.a(this.L$j.zoom))}cDe(O,ca){(O=this.Hc.Jc)&&O!==this.xyb&&(O.G5h(Object(E.a)(this,this.DBh,"updateOffsetFromSlideView")),O.H4h(Object(E.a)(this,this.CBh,
"updateOffsetFromPageContentContainer")),this.xyb&&(this.xyb.JQk(Object(E.a)(this,this.DBh,"updateOffsetFromSlideView")),this.xyb.gQk(Object(E.a)(this,this.CBh,"updateOffsetFromPageContentContainer")),this.mOe(this.xyb,!1)),ca&&ca.JTc&&1!==this.Qie&&this.mOe(O,!0),this.xyb=O)}mOe(O,ca){if(O&&(O=O.Nd)&&O.isConnected){var Ta=O.om();if(Ta&&Ta.length)for(const wc of Ta)if(wc.Nq){Ta=wc.sa($e.a.HY,null);var xb=O.getValue($e.a.sid),Tb=O.getValue($e.a.cid);xb=hh.a.bE(xb,Tb).toString();Tb=wc.get_shapeId().toString();
Ta=Ta+Tb+xb;Ye.a("Microsoft.Office.SharedOnline.FixBug6808089")?(xb=wc.Ag(0),(null===xb||void 0===xb?0:xb.ya)?this.XHa(Ta,ca,xb.ya.ee):this.XHa(Ta,ca,null)):this.XHa(Ta,ca,null)}}}Y4(O){this.Qie=O;const ca=this.Hc.Jc;ca?(m.ULS.sendTraceTag(512369926,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",ca.Nd.sid,ca.Nd.cid),this.mOe(ca,2===O)):m.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}CBh(O,
ca){this.Yme=ca.x;this.Zme=ca.y;this.TSe()}DBh(O,ca){this.ype=ca.x;this.zpe=ca.y;this.TSe()}TSe(){this.e$b.style.left=Wb.a.Lc(this.Yme+this.ype+Ji.a.R4-this.TLg);this.e$b.style.top=Wb.a.Lc(this.Zme+this.zpe+Ji.a.R4-this.TLg)}XBj(O){return O in this.vpa}cXk(O,ca){this.vpa[O]=ca}XHa(O,ca,Ta){1===this.Qie&&ca||O in this.vpa&&this.vpa[O].XHa(ca,Ta)}Gbh(O){O in this.vpa&&(this.vpa[O].dispose(),delete this.vpa[O])}OHe(O,ca){O in this.vpa&&this.vpa[O].OHe(ca)}yCb(){}get vpa(){return this.kZj}}Object(h.a)(Sc,
"AppForOfficeContentAppsContainer",null,[1004,106]);var Od=d(388);class ug extends y.StandardDialog{constructor(O,ca){super();this.vIh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.cLh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.dLh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.aKh=O;this.JLb=ca}showDialog(O,ca){const Ta=new Pc.a(void 0,void 0,!1);Ta.vd=0;Ta.kg=Od.a.Gbd(Number.MAX_VALUE).toString();Ta.jg=String.format("<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
ca,this.dLh,this.cLh,this.vIh);Ta.pj(O,Object(E.a)(this,this.eik,"onCheckboxExecute$4"),{optInCheckbox:!1})}eik(O,ca){1===O&&ca.optInCheckbox&&(w.a.instance.getItem("optedIntoAddinDeveloperMode")?w.a.instance.removeItem("optedIntoAddinDeveloperMode"):(w.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Ikc()))}Ikc(){const O=new y.StandardDialog;O.vd=4;const ca=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,
this.aKh)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;O.mO(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,ca,this.JLb)}}Object(h.a)(ug,"AppForOfficeDeveloperModeOptInDialog",y.StandardDialog,[]);const te=O=>{const ca=[];if(!O)return ca;ca[OSF.DDA.Marshaling.ThemingKeys.Accent1]=mf(O.Accent1);ca[OSF.DDA.Marshaling.ThemingKeys.Accent2]=mf(O.Accent2);ca[OSF.DDA.Marshaling.ThemingKeys.Accent3]=mf(O.Accent3);ca[OSF.DDA.Marshaling.ThemingKeys.Accent4]=mf(O.Accent4);ca[OSF.DDA.Marshaling.ThemingKeys.Accent5]=
mf(O.Accent5);ca[OSF.DDA.Marshaling.ThemingKeys.Accent6]=mf(O.Accent6);ca[OSF.DDA.Marshaling.ThemingKeys.Background1]=mf(O.OsfColorScheme?O.OsfColorScheme.Background1:null);ca[OSF.DDA.Marshaling.ThemingKeys.Background2]=mf(O.OsfColorScheme?O.OsfColorScheme.Background2:null);ca[OSF.DDA.Marshaling.ThemingKeys.Text1]=mf(O.OsfColorScheme?O.OsfColorScheme.Text1:null);ca[OSF.DDA.Marshaling.ThemingKeys.Text2]=mf(O.OsfColorScheme?O.OsfColorScheme.Text2:null);ca[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=mf(O.Hyperlink);
ca[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=mf(O.FollowedHyperlink);const Ta=O.OsfFontScheme;Ta&&(ca[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=Ta.HdEaFt,ca[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=Ta.HdLtnFt,ca[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=Ta.HdLclFt,ca[OSF.DDA.Marshaling.ThemingKeys.HdScript]=Ta.HdSptFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=Ta.BdEaFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=Ta.BdLtnFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=Ta.BdLclFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdScript]=
Ta.BdSptFt);ca[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=mf(O.Background);return ca},mf=O=>{if(!O)return null;let ca;ca=O.b;ca+=O.g<<8;return ca+=O.r<<16};class Yf{constructor(O,ca,Ta){this.YLg=O;this.JS=ca;this.y0j=Ta}register(){this.YLg.xk(Object(E.a)(this,this.Uvh,"themeChangedCallback"))}dispose(){this.YLg.Tm(Object(E.a)(this,this.Uvh,"themeChangedCallback"))}Uvh(O,ca){if(ca.node.Sa($e.a.Se)&&(ca.property===$e.a.Se||ca.property===$e.a.u$)){O=ca.node;try{var Ta=te(O?O.Se:null)}catch(xb){return}if(O){O=
O.om();for(const xb of O)xb.Nq&&(O=this.y0j.N1(xb),this.JS.OWa(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),O.id,Ta))}this.JS.y9g(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),Ta)}}}Object(h.a)(Yf,"AppForOfficeDocumentThemeListener",null,[997,106]);var Jd=d(243);class ce extends Pc.a{constructor(O,ca,Ta){super();this.Xoa=null;this.zDd="WACDialogTitleText";this.Wib="0";this.Mpc="15px";this.dJh="0px";this.Vib="calc(100% - 30px)";this.cJh="100%";this.erf=0;this.Pa=
new C.a;this.NGh=new H;this.vd=5;this.kg=this.KLb=Ta;this.Rqd=O;this.p_e=ca;this.trd=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}J3h(O){this.Pa.addHandler("OnDialogClosedEventKey",O)}h3k(){this.hoa=null}$w(){super.$w();this.Zy.style.width="100%";this.Zy.style.height=this.UOc?this.Vib:this.cJh;this.Zy.style.marginTop=this.UOc?this.Mpc:this.dJh;this.Zy.style.padding=this.Wib}DF(){super.DF();this.pc.style.width=String.format("{0}px",this.Rqd*
window.innerWidth/100);this.pc.style.height=String.format("{0}px",this.p_e*window.innerHeight/100);this.pc.style.minWidth="0px";this.trd&&A.AFrameworkApplication.isRtl&&100===this.Rqd&&(this.pc.style.right="0px",this.pc.style.marginRight="0px");this.Xoa=document.getElementById(this.hi(this.zDd));this.Xoa.style.position="absolute";this.Xoa.style.whiteSpace="nowrap";this.Xoa.style.textOverflow="ellipsis";A.AFrameworkApplication.isRtl?(this.Xoa.style.right="14px",this.Xoa.style.left="44px"):(this.Xoa.style.right=
"44px",this.Xoa.style.left="14px")}gwa(O){super.gwa(O);this.Xoa&&this.Xoa.setAttribute("title",O)}get C4a(){return this.Zy}PEe(){this.pc.style.width=String.format("{0}px",this.Rqd*window.innerWidth/100);this.pc.style.height=String.format("{0}px",this.p_e*window.innerHeight/100);this.pc.style.overflowY="hidden";this.pc.style.overflowX="hidden";this.pc.style.marginTop="";this.pc.style.top="";Bh.a.r8a&&A.AFrameworkApplication.isRtl?(this.pc.style.right="",this.pc.style.marginRight=""):(this.pc.style.left=
"",this.pc.style.marginLeft="")}hide(){this.NGh.eRf(3,this.KLb).execute(this,K.getInstance(),{});this.erf=window.setTimeout(()=>{this.Pa.raiseEvent("OnDialogClosedEventKey",this.KLb);Jd.a.prototype.hide.call(this)},500)}xZg(O){3===O&&(window.clearTimeout(this.erf),this.Pa.raiseEvent("OnDialogClosedEventKey",this.KLb),super.hide())}}Object(h.a)(ce,"AppsForOfficeDialog",Pc.a,[710,711]);class fe{constructor(){this.dialog=this.kg=null}}Object(h.a)(fe,"DialogInfo",null,[]);class Gg{}Gg.url="url";Gg.height=
"height";Gg.width="width";Gg.HRd="displayInIframe";Gg.oPc="hideTitle";Object(h.a)(Gg,"DialogSettings",null,[]);class Me{constructor(){this.height=this.width=0;this.kg=this.controlId=this.pageUrl=null;this.oPc=this.HRd=!1}}Object(h.a)(Me,"DisplayDialogParams",null,[]);class se extends Sys.EventArgs{constructor(O,ca,Ta=null,xb="",Tb=""){super();this.controlId=O;this.messageType=ca;this.messageContent=Ta;this.Rre=xb;this.UIa=Tb}}Object(h.a)(se,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class Pf extends Sys.EventArgs{constructor(O,
ca,Ta=null,xb="",Tb=""){super();this.controlId=O;this.messageType=ca;this.messageContent=Ta;this.Rre=xb;this.UIa=Tb}}Object(h.a)(Pf,"OnMessageParentEventArgs",Sys.EventArgs,[]);var yg=d(113);class qe{constructor(O){this.Pa=new C.a;this.eR=O}d4h(O){this.Pa.addHandler("OnMessageParentEventKey",O)}$ch(O){this.Pa.removeHandler("OnMessageParentEventKey",O)}c4h(O){this.Pa.addHandler("OnMessageDialogEventKey",O)}LPk(O){this.Pa.removeHandler("OnMessageDialogEventKey",O)}showDialog(O,ca,Ta,xb){if(qe.vna.Jb(ca))m.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const Fe=ia.b(O),Gf=Fe[Gg.url];if(this.eR.getOsfControl(ca).checkAppDomains(Gf)){var Tb=new Me;Tb.width=Fe[Gg.width];Tb.height=Fe[Gg.height];Tb.pageUrl=Gf;Tb.HRd=Fe[Gg.HRd];Tb.oPc=Fe[Gg.oPc];Tb.controlId=ca;Tb.kg=yg.a.create().toString();var wc=new fe;wc.kg=Tb.kg;var sd=this.eR.getOsfControl(Tb.controlId).getManifest().getDefaultDisplayName(),$b=this.eR.getOsfControl(Tb.controlId).getStoreType().toLowerCase();
O=null;var ge=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",!1);O=(4===A.AFrameworkApplication.Aa.gb.Am&&"hardcodedpreinstall"===$b||ge&&"sdxcatalog"===$b)&&Tb.oPc?this.createAndShowAppsForOfficeDialog(Tb.width,Tb.height,Tb.kg,!0,sd):this.createAndShowAppsForOfficeDialog(Tb.width,Tb.height,Tb.kg,!1,sd);var we=this.eR.getOsfControl(Tb.controlId),oe=we.getManifest();ge={};ge.id=Tb.kg;ge.solutionId=we.getSolutionId();ge.version=we.getVersion();
ge.storeType=$b;ge.storeId=we.getStoreId();ge.assetId=we.getAssetId();ge.assetStoreId=we.getAssetStoreId();ge.ownerAddinSolutionId=we.getOwnerAddinSolutionId();ge.ownerAddinStoreType=we.getOwnerAddinStoreType();ge.appDomains=oe.getAppDomains();ge.dialogUrl=Gf;ge.osfControlType=1;ge.agaveName=sd;ge.div=O.C4a;m.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ge.solutionId,ge.ownerAddinStoreType||ge.storeType,ge.assetId,null,
null,ge.storeId),ja.a.zM(Tb.pageUrl));this.eR.insertDialogControl(ge);O.J3h(Object(E.a)(this,this.Xik,"onDialogClosed"));wc.dialog=O;qe.vna.$(Tb.controlId,wc);xb&&xb(ge);Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else m.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Fe){m.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Fe.message),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Hck(O,
ca,Ta,xb){A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===xb&&(xb=Ta);try{const Tb=this.FBa(O);Tb&&this.Pa.raiseEvent("OnMessageParentEventKey",new Pf(Tb,OSF.DialogMessageType.DialogMessageReceived,ca,Ta,xb))}catch(Tb){return m.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Tb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Tni(O,
ca){if(qe.vna.Jb(O))try{const Ta=qe.vna.ga(O);Ta.dialog&&Ta.dialog.hide();this.eR.purgeDialogControl(Ta.kg);qe.vna.remove(O);ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ta){m.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Ta.message),ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else m.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}OZk(O,
ca,Ta,xb){A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===xb&&(xb=Ta);if(qe.vna.Jb(O)&&(O=qe.vna.ga(O),O.dialog))try{this.Pa.raiseEvent("OnMessageDialogEventKey",new se(O.kg,OSF.DialogMessageType.DialogParentMessageReceived,ca,Ta,xb))}catch(Tb){m.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Tb.message)}}FBa(O){let ca=null;for(let Ta of qe.vna)if(Ta.value.kg===O){ca=Ta.key;
break}return ca}Xik(O,ca){if(O=this.FBa(ca))this.eR.purgeDialogControl(ca),qe.vna.remove(O),this.Pa.raiseEvent("OnMessageParentEventKey",new Pf(O,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(O,ca,Ta,xb,Tb){O=new ce(O,ca,Ta);Tb=xb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Tb);xb&&(O.UOc=!1,O.hr=!1);O.pj(Tb,null,null);O.h3k();return O}static Ffg(){return qe.vna}static getInstance(O){qe.Ja||(qe.Ja=new qe(O));return qe.Ja}}qe.Ja=null;qe.vna=
new Qb.a;Object(h.a)(qe,"AppsForOfficeDialogManager",null,[687]);var yd=d(701),zf=d(65),xd=d(119),fg=d(93),Ki=d(168),jg=d(122);class Ch extends Sys.EventArgs{constructor(O){super();this.Oga=O}}Object(h.a)(Ch,"AppForOfficeFocusOnAddinPaneEventArgs",Sys.EventArgs,[]);var ih=d(46);class qh{constructor(O,ca,Ta,xb,Tb,wc){this.cQ=[];this.Xqe=new yd.a;this.tE=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.gb&&A.AFrameworkApplication.Aa.gb.UV;this.JW=O;this.X1j=this.JW.firstChild;this.Fa=ca;this.mu=
Ta;this.nb=xb;this.Xd=Tb;this.gf=wc}get r1(){return this.cQ}get qe(){return this.Xd.value}k3d(){return 0<this.Bcc}uM(O){if(O){this.r1.push(O);var ca=O.ya;ca&&!this.tE&&this.JW.insertBefore(ca,this.X1j);1===this.Bcc&&this.Fa.Gj(jg.a.gKd,!0);O.isVisible&&this.mu.addHandler(O.ya,zf.a.eg,Object(E.a)(this,this.dig,"handleShortCutsOnAddinPane"))}}hch(O){O&&(Array.remove(this.cQ,O),O=O.ya,this.mu.removeHandler(O,zf.a.eg,Object(E.a)(this,this.dig,"handleShortCutsOnAddinPane")),O&&!this.tE&&this.JW.removeChild(O),
this.Bcc||this.Fa.Gj(jg.a.gKd,!1))}Y4(O){if(1===O||2===O){if(1===O){this.Xqe=new yd.a;for(const ca of this.r1)ca.isVisible&&this.Xqe.add(ca.id.toLowerCase())}O=2===O;for(const ca of this.r1)this.Xqe.contains(ca.id.toLowerCase())&&(ca.Yo(O),(O&&1===this.Bcc||!O&&!this.Bcc)&&this.Fa.Gj(jg.a.gKd,O))}}dmj(O,ca){for(const Ta of this.cQ)O=Ta.layout(O,ca)}ZW(O,ca){if(O){O=null;if(ca===ih.a.yg)for(ca=this.cQ.length-1;0<=ca;ca--){if(this.cQ[ca].isVisible){O=this.cQ[ca];break}}else if(ca===jg.a.pJf||ca===jg.a.vfi||
ca===xd.AFrame.BY||ca===xd.AFrame.pJc||ca===jg.a.B1||ca===jg.a.Afi||ca===ih.a.WD||ca===ih.a.vK||ca===ih.a.hZ)for(ca=0;ca<this.cQ.length;ca++)if(this.cQ[ca].isVisible){O=this.cQ[ca];break}this.SVd(O)}}SVd(O){if(O){var ca=this.qe.qVd(O.id);ca&&this.gf.aEk(new Ch(ca.Oga));this.qe.notifyAgave(O.id,11)}else m.ULS.sendTraceTag(19014042,806,10,"Focus could not be put on the null addin pane!")}yTi(O,ca){var Ta;for(Ta=0;Ta<this.cQ.length&&this.cQ[Ta].id!==O;Ta++);if(Ta===this.cQ.length)m.ULS.sendTraceTag(19014043,
806,10,String.format("Failed to find the taskpane with instance id: {0}",O)),this.MQe(ca);else{O=null;if(5===ca)for(--Ta;0<=Ta;Ta--){if(this.cQ[Ta].isVisible){O=this.cQ[Ta];break}}else if(6===ca)for(Ta+=1;Ta<this.cQ.length;Ta++)if(this.cQ[Ta].isVisible){O=this.cQ[Ta];break}O?this.SVd(O):this.MQe(ca)}}k4f(O){for(const ca of this.cQ)if(ca.id===O){fg.FocusManager.Dr(ca.$ni);return}m.ULS.sendTraceTag(19014044,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",
O))}Zpl(O){for(let ca of qe.Ffg())if(ca.value.kg.toLowerCase()===O.toLowerCase())return ca.value.dialog.hide(),ca.key;return null}MQe(O){5===O?this.Fa.c7a(!1):6===O&&this.Fa.c7a(!0)}G0f(){const O=this.nb.ae();O&&1===O.length&&(this.nb.selectShape(O[0],!0),this.Fa.Ad())}get Bcc(){let O=0;for(const ca of this.r1)ca.isVisible&&O++;return O}dig(O){if(O.keyCode===Ki.a.H0&&O.ctrlKey)for(var ca=0;ca<this.r1.length;ca++){var Ta=this.r1[ca];if(Ta.isVisible&&Ta.ya.contains(O.target)){Ta=null;if(O.shiftKey)for(ca+=
1;ca<this.r1.length;ca++){if(this.r1[ca].isVisible){Ta=this.r1[ca];break}}else for(--ca;0<=ca;ca--)if(this.r1[ca].isVisible){Ta=this.r1[ca];break}Ta&&(this.SVd(Ta),O.preventDefault(),O.stopPropagation());break}}}Bf(O){this.Fa.Bf(O)}}Object(h.a)(qh,"AppForOfficeFocusManager",null,[1003]);var Md=d(926);class Ed{fwi(O,ca,Ta){O=Md.a.Tdg(O.ndb);O.appName=OSF.AppName.PowerpointWebApp;O.clientMode=1;O.formFactor="DefaultSettings";O.hostControl=ca;ca=mc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");
O.allowExternalMarketplace=O.allowExternalMarketplace&&ca.TVb;Ta.register(O);Ta=new OSF.ContextActivationManager(O);Ta.setWSA(A.AFrameworkApplication.Zi);return Ta}}Object(h.a)(Ed,"AppForOfficeImportedClassFactory",null,[1001]);class Bd{constructor(O){this.zCg=O}SCe(){for(const O of this.zCg)O.register()}dispose(){for(const O of this.zCg)O.dispose()}}Object(h.a)(Bd,"AppForOfficeListenerManager",null,[1002,106]);var Xh=d(196),$f=d(342);class Vi extends Pc.a{constructor(){super();this.Vib="calc(100% - 46px)";
this.Mpc="15px";this.Wib="0";this.kKh="WACDialogPanel";this.B_a=695;this.lKh=462;this.NLb="80%";this.SHh=350;this.EWe="100%";this.vd=5;this.kg="AppsForOfficeInsertionDialog";this.trd=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}$w(){super.$w();this.Zy.style.width=this.EWe;this.Zy.style.height=this.Vib;this.Zy.style.marginTop=this.Mpc;this.Zy.style.padding=this.Wib}Tla(){this.Zy.style.width=this.EWe;this.Zy.style.height=this.Vib;this.Zy.style.marginTop=
this.Mpc;this.Zy.style.padding=this.Wib;this.B_a>Jd.a.Nda?(this.pc.style.width=String.format("{0}px",Jd.a.Nda),this.pc.style.overflowX="scroll",A.AFrameworkApplication.isRtl?this.pc.style.right="0":this.pc.style.left="0"):(this.pc.style.width=String.format("{0}px",this.B_a),this.pc.style.overflowX="hidden");this.pc.offsetHeight>Jd.a.Hla||this.lKh+50>Jd.a.Hla?(this.pc.style.height=String.format("{0}px",Jd.a.Hla),this.pc.style.overflowY="scroll",this.pc.style.top="0",A.AFrameworkApplication.isRtl?this.pc.style.right=
"0":this.pc.style.left="0",this.trd||(this.pc.style.marginTop="-48px"),this.Zy.style.minHeight=String.format("{0}px",this.SHh)):(this.pc.style.overflowY="hidden",this.pc.style.top="10%",this.pc.style.height=this.NLb);this.EUb()}EUb(){if(this.pc){var O=this.pc.style.zIndex;this.pc.style.zIndex="-9999";if(this.B_a>Jd.a.Nda)A.AFrameworkApplication.isRtl?this.pc.style.marginRight="0":this.pc.style.marginLeft="0";else{const ca=String.format("{0}px",Math.floor(-this.pc.offsetWidth/2));A.AFrameworkApplication.isRtl?
this.pc.style.marginRight=ca:this.pc.style.marginLeft=ca;A.AFrameworkApplication.isRtl?this.pc.style.right="50%":this.pc.style.left="50%"}this.pc.style.zIndex=String(O)}else m.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}DF(){super.DF();const O=document.getElementById(this.hi(this.kKh));O.style.width=String.format("{0}px",this.B_a);O.style.height=this.NLb}get C4a(){return this.Zy}}Object(h.a)(Vi,"AppsForOfficeInsertionDialog",Pc.a,[682]);var ci=d(1160),Bi=d(179);class bh{constructor(O,
ca,Ta){this.vtb=O;this.onSuccess=ca;this.onError=Ta;$addHandler(window,"message",Object(E.a)(this,this.p1b,"handleResponse"))}p1b(O){try{if(O&&O.rawEvent&&O.rawEvent.origin&&this.vtb&&this.vtb.id){var ca=this.d3g(O.rawEvent.origin);const Ta=this.d3g(document.domain);if(ci.a.Qr().equals(Ta,ca))if(O.rawEvent.source&&O.rawEvent.source.frameElement&&O.rawEvent.source.frameElement.id&&ci.a.Qr().equals(O.rawEvent.source.frameElement.id,this.vtb.id)){ca=null;try{ca=JSON.parse(O.rawEvent.data)}catch(xb){m.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",xb.message)}ca?(ca.statusCode!==Bi.a.Yy||void 0!==ca.error&&ca.error?(m.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ca.statusCode,ca.error),this.onError()):(m.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ca.authorizationCode?ca.authorizationCode:
ca.signInUrl)),$removeHandler(window,"message",Object(E.a)(this,this.p1b,"handleResponse")),this.vtb?document.body.contains(this.vtb)?document.body.removeChild(this.vtb):m.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):m.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):m.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else m.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else m.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else m.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Ta){m.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Ta.message)}}d3g(O){let ca="";try{O&&(ca=-1<O.indexOf("//")?O.split("/")[2]:O.split("/")[0])&&(ca=ca.split(":")[0],ca=ca.split("?")[0])}catch(Ta){m.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Ta.message)}return ca}static iA(O,ca,Ta){new bh(O,ca,Ta)}}Object(h.a)(bh,"ResponseHandler",null,[]);var Wg=d(216);class jf{constructor(O){this.bpa=O}tryAuthenticate(O,ca){this.H9c(jf.QMh,()=>{O()},ca)}tryAuthorize(O,ca){this.H9c(jf.CHh,O,ca)}getSignInUrl(O,ca){this.H9c(jf.Iuf,O,ca)}signOut(O,ca){this.H9c(jf.lVh,O,ca)}H9c(O,ca,Ta){var xb=new Wg.QueryStringBuilder("AuthenticationProxyHandler.aspx");xb.Hi("responseType",O);A.AFrameworkApplication.HMa(xb);
xb=String.format("{0}{1}&{2}",this.bpa,xb.toString(),A.AFrameworkApplication.Zg);const Tb=document.createElement("iframe");Tb.setAttribute("id","privateCatalogIframe");Tb.setAttribute("name","privateCatalogIframe");Tb.setAttribute("style","display: none");ci.a.Qr().equals(O,jf.Iuf)||Tb.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");bh.iA(Tb,ca,Ta);Tb.setAttribute("src",xb);document.body.appendChild(Tb)}}jf.CHh="authcode";jf.QMh="identitytoken";
jf.Iuf="signinurl";jf.lVh="signout";Object(h.a)(jf,"AuthenticationProxy",null,[]);class kg{}kg.getUserId="getUserId";kg.getLastStoreUpdate="laststoreupdate";kg.getEntitlement="getEntitlements";kg.getEToken="getEToken";kg.getManifest="getManifest";kg.getAppState="getAppState";kg.getKilledApps="getRemovedAddins";kg.getAppDetails="getAppDetails";kg.removeApps="removeAddin";kg.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";kg.getPrivateCatalogAddIns="getAddIns";kg.getPrivateCatalogManifests=
"getAppManifests";kg.isStoreDisabled="isStoreDisabled";Object(h.a)(kg,"S2SWebRequestActions",null,[]);var vh=d(515);class nd{getUserId(O,ca){const Ta=new e.a;Ta.add(new Ma.a("corr",O));this.gx(kg.getUserId,Ta,1,ca)}getLastStoreUpdate(O,ca,Ta){const xb=new e.a;xb.add(new Ma.a("lc",O));xb.add(new Ma.a("corr",ca));this.gx(kg.getLastStoreUpdate,xb,1,Ta)}getEntitlement(O,ca,Ta,xb){O=new e.a;O.add(new Ma.a("av",ca));O.add(new Ma.a("corr",Ta));this.gx(kg.getEntitlement,O,1,xb)}getEToken(O,ca,Ta,xb,Tb,wc){const sd=
new e.a;sd.add(new Ma.a("cmu",O));sd.add(new Ma.a("cmf",ca));sd.add(new Ma.a("assetid",Ta));sd.add(new Ma.a("expver",xb));sd.add(new Ma.a("corr",Tb));this.gx(kg.getEToken,sd,1,wc)}getManifest(O,ca,Ta,xb){const Tb=new e.a;Tb.add(new Ma.a("cmu",O));Tb.add(new Ma.a("assetid",ca));Tb.add(new Ma.a("corr",Ta));this.gx(kg.getManifest,Tb,1,xb)}getAppState(O,ca,Ta){const xb=new e.a;xb.add(new Ma.a("ma",O));xb.add(new Ma.a("corr",ca));this.gx(kg.getAppState,xb,1,Ta)}getKilledApps(O,ca){const Ta=new e.a;Ta.add(new Ma.a("corr",
O));this.gx(kg.getKilledApps,Ta,1,ca)}getAppDetails(O,ca,Ta,xb){const Tb=new e.a;Tb.add(new Ma.a("cmo",O));Tb.add(new Ma.a("corr",Ta));this.sendWithBody(kg.getAppDetails,Tb,ca,2,xb,!1)}removeApps(O,ca,Ta){const xb=new e.a;xb.add(new Ma.a("corr",ca));this.sendWithBody(kg.removeApps,xb,O,2,Ta,!1)}getLastPrivateCatalogUpdate(O,ca,Ta,xb,Tb,wc){const sd=new e.a;sd.add(new Ma.a("catalog","privatecatalog"));sd.add(new Ma.a("clientCode",O));sd.add(new Ma.a("clientVersion",ca));sd.add(new Ma.a("corr",Tb));
O=String.format("authorizationCode={0}&refreshToken={1}",Ta?ja.a.Me(Ta):"",xb?ja.a.Me(xb):"");this.sendWithBody(kg.getLastPrivateCatalogUpdate,sd,O,2,wc,!0)}getPrivateCatalogAddIns(O,ca,Ta,xb,Tb,wc){const sd=new e.a;sd.add(new Ma.a("catalog","privatecatalog"));sd.add(new Ma.a("clientCode",O));sd.add(new Ma.a("clientVersion",ca));sd.add(new Ma.a("corr",Tb));O=String.format("authorizationCode={0}&refreshToken={1}",Ta?ja.a.Me(Ta):"",xb?ja.a.Me(xb):"");this.sendWithBody(kg.getPrivateCatalogAddIns,sd,
O,2,wc,!0)}getPrivateCatalogManifests(O,ca,Ta,xb,Tb){const wc=new e.a;wc.add(new Ma.a("catalog","privatecatalog"));wc.add(new Ma.a("corr",xb));O=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",ja.a.Me(O),ca?ja.a.Me(ca):"",Ta?ja.a.Me(Ta):"");this.sendWithBody(kg.getPrivateCatalogManifests,wc,O,2,Tb,!0)}isStoreDisabled(O,ca){const Ta=new e.a;Ta.add(new Ma.a("corr",O));this.gx(kg.isStoreDisabled,Ta,2,ca)}gx(O,ca,Ta,xb){this.sendWithBody(O,ca,null,Ta,xb,!1)}sendWithBody(O,ca,Ta,
xb,Tb,wc){const sd=new Wg.QueryStringBuilder("AddinServiceHandler.ashx");sd.Hi("action",O);sd.Hi("app",vh.a[A.AFrameworkApplication.Aa.gb.Am]);for(let $b of ca)sd.Hi($b.key,$b.value);ca=String.format("{0}{1}&{2}",A.AFrameworkApplication.Aa.gb.yda,sd.toString(),A.AFrameworkApplication.Zg);A.AFrameworkApplication.He.vj(ca,xb,Ta,null,!1,2,$b=>{let ge=null,we=null;$b&&$b.data&&($b.data.mj["X-BlockedForMinor"]&&"1"===$b.data.mj["X-BlockedForMinor"].toString()&&($b.data.af=451),ge=$b.data.Zd,we=$b.data.mj);
Tb($b.data.af,ge,we)},$b=>{var ge=null;let we=null;wc&&$b&&$b.data&&$b.data.Zd&&(ge=$b.data.Zd,we=$b.data.mj);Tb($b.data.af,ge,we);if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){ge={message:"AddinServiceHandler request failed"};ge.code=$b.data.af;ge.action=O;if($b.data.request||$b.data.request.get_headers())ge["X-UserSessionId"]=$b.data.request.get_headers()["X-UserSessionId"];408===$b.data.af||503===$b.data.af?m.ULS.sendTraceTag(538784582,
220,10,JSON.stringify(ge)):m.ULS.sendTraceTag(18392345,220,50,JSON.stringify(ge))}else m.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",$b.data.af)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+O,void 0,void 0,void 0,["X-UserKey"])}}Object(h.a)(nd,"S2SWebRequestManager",null,[]);var Oe=d(246),ti=d(30),Kh=d(81);class Rd{constructor(O,ca){this.state=O;this.uma=ca}}Object(h.a)(Rd,"BackgroundAppData",null,[1019]);class Bj{constructor(O,ca,Ta,xb,Tb,wc,sd){this.Oga=null;
this.gHh=O;this.qWh=xb;this.Qtd=ca;this.Zya=Ta;this.settings=Tb;this.v5=wc;this.Hu=sd}get Zm(){return this.gHh}get taskpane(){return this.qWh}get instanceId(){return this.Qtd}get shape(){return this.Zya}get hy(){return this.v5}hZh(O){this.Hu=new Rd(0,O)}}Object(h.a)(Bj,"AppForOffice",null,[999]);var ui=d(29);class Na{}Na.c_Error="Error";Object(h.a)(Na,"ApiResponseKeyStrings",null,[]);class qb{constructor(O,ca,Ta,xb,Tb){this.EventDispId=O;this.ControlId=ca;this.TargetId=Ta;this.Handler=xb;this.Callback=
Tb}}Object(h.a)(qb,"EventRegistrationParams",null,[]);var wb=d(26);class jc{constructor(O,ca){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.yb=A.AFrameworkApplication.ue;this.sme=O;this.gFg=ca}InvokeDdaMethod(O,ca,Ta){const xb=O.DdaMethod.DispatchId,Tb=this.sme.MXi(xb);Tb?(Tb.parameters=O,Tb.callback=ca,Tb.t6h=Ta,Tb.controlId=O.DdaMethod.ControlId,this.yb.Gb(new Vg.a(2,1,0,Object(E.a)(Tb,Tb.go,"go"),90,"51"))):(O="API Call for method ID "+xb+
" does not exist:"+ui.Debug.xt(),wb.a.J(8958091,802,10,O),this.LKd(ca))}RegisterDdaEventAsync(O,ca,Ta,xb,Tb){const wc=new Vg.a(2,1,0,Object(E.a)(this,this.OKk,"registerEventTaskProcess"),90,"52");wc.customData=new qb(O,ca,Ta,xb,Tb);this.yb.Gb(wc)}UnregisterDdaEventAsync(O,ca,Ta,xb,Tb){const wc=new Vg.a(2,1,0,Object(E.a)(this,this.esl,"unregisterEventTaskProcess"),90,"53");wc.customData=new qb(O,ca,Ta,xb,Tb);this.yb.Gb(wc)}OKk(O){O=O.customData;var ca=this.gFg.ZWd(O.EventDispId);ca?ca.addHandler(O.ControlId,
O.Handler,O.Callback,O.TargetId):(ca="Event for dispatch ID "+O.EventDispId+" does not exist:"+ui.Debug.xt(),wb.a.J(8958093,802,10,ca),this.LKd(O.Callback))}esl(O){O=O.customData;var ca=this.gFg.ZWd(O.EventDispId);ca?ca.removeHandler(O.ControlId,O.Handler,O.Callback,O.TargetId):(ca="Event for dispatch ID "+O.EventDispId+" does not exist:"+ui.Debug.xt(),wb.a.J(8958095,802,10,ca),this.LKd(O.Callback))}LKd(O){if(O){var ca={};ca[Na.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;O(ca)}}}
Object(h.a)(jc,"AppForOfficeApiAdapter",null,[1039]);class Qc{constructor(O,ca,Ta,xb){this.menuItemId=O;this.XT=ca;this.Dhl=Ta;this.pQi=xb}}Object(h.a)(Qc,"NewDocumentParameters",null,[]);var Cd=d(571),Ld=d(128),ie=d(137),Qe=d(42),df=d(50),tf=d(75),jh=d(31),Dh=d(36),ch=d(49),Hg=d(38),wh=d(32),Yh=d(59);class Ni{constructor(O,ca,Ta){this.mbb=[];this.nYc=this.wxb=!1;this.ua=O;this.fF=ca;this.Fy=Ta}build(){const O=this.ua.jD();if(!O)return this.mbb;for(const ca of O)if(this.eBk(ca),this.nYc)break;return this.mbb}eBk(O){const ca=
jh.ParagraphReader.textLength(O);this.fBk(O,ca);this.nYc||this.KAk(O)}fBk(O,ca){this.wxb||(this.fF>=ca?this.fF-=ca:(this.wxb=!0,this.Fy||this.mbb.push(ch.a.Uj(Object(D.a)(Kh.a,O),this.fF))));this.wxb&&(this.Fy>ca-this.fF?0<ca&&(this.mbb.push(ch.a.createTextRange(Object(D.a)(Kh.a,O),this.fF,ca)),this.Fy-=ca-this.fF,this.fF=0):0<this.Fy&&(this.mbb.push(ch.a.createTextRange(Object(D.a)(Kh.a,O),this.fF,this.fF+this.Fy)),this.Fy=0));0>=this.Fy&&(this.nYc=!0)}KAk(O){this.wxb||(0<this.fF?--this.fF:(this.wxb=
!0,this.Fy||this.mbb.push(ch.a.XNa(Object(D.a)(Kh.a,O)))));this.wxb&&0<this.Fy&&(this.mbb.push(ch.a.Taa(Object(D.a)(Kh.a,O))),--this.Fy);0>=this.Fy&&(this.nYc=!0)}}Object(h.a)(Ni,"TextSelectionBuilder",null,[]);var vi=d(962),Eh=d(28);class xh{constructor(O,ca,Ta,xb,Tb,wc,sd,$b,ge,we,oe,Fe,Gf,Rh,Sh,Wa,Lg,gg,ub,nk,Tj,Fj,so){this.Ga=O;this.$b=ca;this.xI=Ta;this.c$b=xb;this.ra=Tb;this.iW=wc;this.X_c=sd;this.Db=$b;this.ia=ge;this.ta=oe;this.Yb=we;this.Sb=Fe;this.rc=Gf;this.gZj=Rh;this.nb=Sh;this.Qb=Wa;
this.xm=Lg;this.Ea=gg;this.Mb=ub;this.Aab=nk;this.Vh=Tj;this.Mx=Fj;this.h5j=so}Abj(){let O;O="";if(this.nb.uG()){if(1<this.nb.Ged())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Yic:O};const ca=this.nb.jq();if(this.WNj(ca)){const Ta=[];this.Ea.WI(ca,xb=>{xb&&Ta.push(xb.characterData)});O=Ta.join(xh.dKf);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Yic:O}}}else if(this.nb.lD())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,
Yic:O}}wbj(){let O;O="";return{returnValue:({yMe:O}=this.getSelectedSlides()).returnValue,fZk:O}}Qrb(){return this.xI.ndb.documentUrl}yij(O){if(!O)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;var ca=this.Sb.Nj();if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");const Ta=this.ta.Ba.De;switch(O){case "previous":O=Ta-1;break;case "next":O=Ta+1;break;case "first":O=0;break;case "last":O=ca-1;break;default:if(O=parseInt(O),isNaN(O))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>
O||O>ca-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;ca=this.Sb.XH(O);if(!ca)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.Yb.Ba=ca;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}zij(O){if(!O)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;O=parseInt(O);if(isNaN(O))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;O=this.M0d(O);if(!O)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.Yb.Ba=O;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}U4k(O){var ca=
this.nb.ae();if(!ca.length){if(ca=Object(D.a)(123,this.nb.Ip()||this.ta.Ba)){var Ta=ca.Bb;O=this.xm.dPd(Ta.cid,Ta.sid,ca.Qu()+1,O,"");Ta=this.Db.rd(7);Ta.jc(ca);ca.rB(O);this.nb.selectShape(O,!0);Ta.dispose();this.Mx.pI=O;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===ca.length){if(this.nb.uG())return this.V5k(O);if(this.nb.lD())return this.W5k(O)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}P4k(O,ca,Ta,xb,Tb,wc,sd){if(this.wIc(Tb,0,xh.$hb)||this.wIc(wc,
0,xh.$hb)||this.wIc(Ta,-xh.$hb,xh.$hb)||this.wIc(xb,-xh.$hb,xh.$hb)||0!==sd&&1!==sd)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(O.length>this.Ga.pptEditorAppsForOfficeImageMaxSizeInBytes)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var $b=this.nb.ae().length;if(ca||Tb||wc||!$b){$b=this.ta.Ba;if(!$b)throw Error.argumentNull("ActiveSlide is null");const ge=$b.Bb,we=$b.Qu();let oe=!0,Fe=new Yh.a(0,0);ca?Fe=new Yh.a(Ta,xb):!this.Ga.pxk||Tb&&wc?Fe=this.Sb.tra(Tb,wc):
oe=!1;ca=this.xm.fqa(!1,ge.cid,ge.sid,0,Cd.a.$G(Fe.x),Cd.a.$G(Fe.y),Cd.a.$G(Tb),Cd.a.$G(wc),we+1,!0);oe||(ca.Nn(Dh.a.My),ca.Nn(Dh.a.Ny));ca.qk=!0;ca.nhd=!0;ca.ry=sd;ca.xia=0===sd?this.yRf(O):O;ca.fub=!0;O=this.Db.rd(7);try{O.jc($b),$b.rB(ca),this.nb.selectShape(ca,!0)}finally{O&&O.dispose()}this.Mx.pI=ca;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===$b&&($b=this.nb.jq())&&$b.fCc){ca=this.ta.Ba;if(!ca)throw Error.argumentNull("ActiveSlide is null");Ta=this.H6a(ca,$b);Ta.qk=!0;Ta.ry=
sd;Ta.xia=0===sd?this.yRf(O):O;Ta.fub=!0;O=this.Db.rd(7);try{O.jc(ca),ca.HT([$b]),ca.rB(Ta),this.nb.selectShape(Ta,!0)}finally{O&&O.dispose()}this.Mx.pI=Ta;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}wb.a.J(512263113,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Hia(){return this.Ga.Hia}aCj(){return this.$b.ka("342")}O1i(O){if(!O)return null;O=this.gZj.N1(O);O=0===O.hy?O.node:this.ta.Ba;if(!O)return null;O=Object(D.a)(122,
this.rc.Sg(O));return te(O.Se)}lGe(O,ca){if(O&&ca)if(Ye.a("UseUndoTransactionForSaveSettingToApp")){var Ta=this.Db.rd(15,void 0,void 0,void 0,!0);try{Ta.jc(O),Ta.$c=Eh.a.Amg,vi.a.rAh(this.X_c.value,O,ca)}finally{Ta&&Ta.dispose()}}else{Ta=this.Db.rd(4);try{Ta.jc(O),vi.a.rAh(this.X_c.value,O,ca),this.Yb.zi.oea()}finally{Ta&&Ta.dispose()}}}h4a(O,ca,Ta){const xb=new y.StandardDialog;xb.vd=4;xb.Yw(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Tb=>{2===Tb||
0===Tb?Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):(Tb=new Qc("blank","agave",O?xh.yek:xh.zek,O),this.h5j.create(ca,Ta,Tb).h4a())})}mf(){return this.nb.mf()}ae(){return this.nb.ae()}Ebj(){var O=this.nb.ae();if(!(O.length&&this.nb.lD()&&this.ra.value&&this.ra.value.Oa.length))return[];const ca=this.ra.value.Oa.ga(0);return(O=xh.E$i(O[0],ca))&&2===O.length?O:[]}Iql(O){if(!O)return!1;this.nb.pXb();if(!O.length)return!0;O[0]!==this.ta.Ba&&(this.Yb.Ba=O[0]);for(const ca of O)ca&&this.nb.L2a(ca);
return!0}Hql(O){if(!O)return!1;if(!O.length)return this.nb.Ph(),!0;this.nb.DXa(O,!0);return!0}Jql(O,ca,Ta){if(!xh.gxg(O))return!1;if(0>ca)return!0;O=(new Ni(O,ca,Ta)).build();O=[new Ld.Selection(O,!0)];O=new ie.SelectionCollection(O,0);this.nb.ZD(O);return!0}getSelectedSlides(){let O;O="";var ca=null;if(!ca||!ca.length){var Ta=this.nb.Ip()||this.ta.Ba;ca||(ca=[]);Ta&&ca.push(Ta)}if(!ca.length)return wb.a.J(512263111,802,10,"Unexpected error: cannot get current slide."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
yMe:O};Ta=[];for(const xb of ca){ca=xb.De+1;if(!ca)return wb.a.J(512263110,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,yMe:O};Array.add(Ta,[xb.sid.toString(),xb.title||"",ca.toString()])}O=ia.c(Ta);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,yMe:O}}getSelectedTextRange(){var O=[];for(let ca=0;ca<this.ra.value.Oa.length;ca++){const Ta=this.ra.value.Oa.ga(ca);Array.add(O,this.bNc(Ta))}O=O.join(xh.dKf);if(O===tf.AParagraphNode.cZ)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,
Yic:O};O=tf.AParagraphNode.scd(O);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Yic:O}}WNj(O){if(!O)return!1;let ca=O.nsa||O.wy||O.Qf||O.nd;if(!ca&&O.al)switch(O.zj){case 0:case 2:case 1:case 3:case 10:case 8:ca=!0}return ca}XNj(O){if(!O)return!1;let ca=O.nsa||O.wy;if(!ca&&O.al)switch(O.zj){case 0:case 2:case 1:case 3:case 8:ca=!0}return ca}bNc(O){let ca="";if(O)for(let Ta=0;Ta<O.length;Ta++){const xb=O.ga(Ta),Tb=xb.Qa,wc=xb.Kb-Tb;let sd="";jh.ParagraphReader.Wd(xb.node)&&(sd=
xb.node.characterData);switch(xb.contextId){case Hg.a.paragraph:ca+=sd+"\r";break;case Hg.a.textRange:0<wc&&(ca+=sd.substr(Tb,wc));break;case Hg.a.endOfParagraph:ca+="\r"}}return ca}M0d(O){var ca=this.ta.presentation;if(!ca)throw Error.argumentNull("Presentation is null");ca=ca.slides||[];for(let Ta=0;Ta<ca.length;Ta++)if(ca[Ta].Bb.sid===O)return Object(D.a)(123,ca[Ta]);return null}W5k(O){if(!this.ra.value||!this.iW.value||!this.c$b.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
if(1===this.ra.value.Oa.length){if(!Qe.SelectionEditor.Jw(this.ra.value.Oa.kb)&&32!==this.ia.processAction(wh.a.FAa,2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var ca=this.ra.value.Oa.kb.Ua;const Ta=ca.node,xb=ca.Qa;ca=ca.Kb;const Tb=this.Db.rd(7);try{Tb.jc(Ta);let wc=null;wc=xb===ca?ch.a.Uj(Ta,xb):ch.a.createTextRange(Ta,xb,ca);this.iW.value.replaceTextRange(wc,O)}finally{Tb.dispose()}ca=xb+O.length;this.ra.value.setSelection(df.SelectionFactory.P1(Ta,xb,ca));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}wb.a.J(512263107,
802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}V5k(O){if(!this.ra.value||!this.iW.value||!this.c$b.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const ca=this.nb.jq();if(!ca)return O="Fail to get shape while setting selected shape's text: shape returned as null: "+ui.Debug.xt(),wb.a.J(512263106,802,10,O),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.XNj(ca)){const Ta=
this.Mb.Kc(ca),xb=this.Db.rd(7);try{xb.jc(Ta);ca.deleteParagraph();this.c$b.value.IY(Ta,!0);this.Aab.oi(Ta);const Tb=Ta.currentNode,wc=this.Vh.textLength(Tb),sd=ch.a.createTextRange(Tb,0,wc);this.iW.value.replaceTextRange(sd,O)}finally{xb.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}wb.a.J(512263105,802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}wIc(O,ca,Ta){return O<ca||Ta<O}yRf(O){return"data:image/png;base64,"+
O}H6a(O,ca){if(!O)return null;var Ta=O.Bb;O=O.Qu();let xb;const Tb=tc.a.VW,wc=tc.a.e4;xb=ca?ca.msb(tc.a.VW,tc.a.e4):this.Sb.tra(tc.a.VW,tc.a.e4);Ta=this.xm.fqa(!0,Ta.cid,Ta.sid,0,xb.x,xb.y,Tb,wc,O+1,!0);ca&&(Ta.Iaa=ca.id);return Ta}static gxg(O){if(!O)return!1;let ca=O.nsa||O.wy;if(!ca&&O.al)switch(O.zj){case 0:case 2:case 1:case 3:case 5:case 6:case 8:ca=!0}return ca}static nfj(O,ca){O=O.jD();if(!O||!ca)return 0;let Ta=0;for(const xb of O){if(xb===ca)break;Ta+=jh.ParagraphReader.textLength(Object(D.a)(Kh.a,
xb))+1}return Ta}static E$i(O,ca){if(!xh.gxg(O)||!ca)return[];var Ta=-1;let xb=0;for(let Tb of ca){ca=jh.ParagraphReader.Wd(Tb.node)?jh.ParagraphReader.textLength(Tb.node):0;if(-1===Ta)switch(Ta=jh.ParagraphReader.Wd(Tb.node)?xh.nfj(O,Object(D.a)(5,Tb.node)):0,Tb.contextId){case Hg.a.paragraph:break;case Hg.a.textRange:case Hg.a.Lf:Ta+=Tb.Qa;break;case Hg.a.endOfParagraph:Ta+=ca;break;default:return[]}switch(Tb.contextId){case Hg.a.paragraph:xb+=ca+1;break;case Hg.a.textRange:xb+=Math.max(0,Tb.Kb-
Tb.Qa);break;case Hg.a.endOfParagraph:xb+=1}}return[Ta,xb]}}xh.dKf=" ";xh.$hb=169056;xh.zek="streamEmpty";xh.yek="streamBase64";Object(h.a)(xh,"AppForOfficeApiFacadeEditorImpl",null,[1038]);class fj{Ghg(O,ca,Ta){if(Ta.mBa(O))m.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");else if(O=Ta.gZb(O)){const xb={};xb.solutionId=O.Zm.id;xb.version=O.Zm.version;xb.storeType=O.Zm.storeType;xb.storeId=O.Zm.store;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",
!1)?(xb.assetId=null,xb.assetStoreId=null):(xb.assetId=O.Zm.id,xb.assetStoreId=O.Zm.storeType);xb.targetType=1;xb.isAddinCommands=!0;xb.addinCommandsActionType=1;xb.sharedRuntimeId=O.Hu?O.Hu.uma:null;xb.backgroundState=O.Hu?O.Hu.state:-1;O.settings=ca;Ta.BHd.mK().Ka(Eh.a.kQc,2,xb);return!0}return!1}YBj(O,ca){if(!O&&!ca)return!0;if(!O||!ca||Object.keys(O).length!==Object.keys(ca).length)return!1;for(let Tb in O){var Ta=Tb,xb=O[Tb];if(!(Ta in ca)||ca[Ta]!==xb)return!1}return!0}}Object(h.a)(fj,"AppForOfficeAppSettingProxy",
null,[]);class Wi{constructor(O,ca,Ta,xb){this._id=O;this.smb=ca;this.k6=Ta;this.Fvf=xb}get id(){return this._id}get version(){return this.smb}get store(){return this.k6}get storeType(){return this.Fvf}}Object(h.a)(Wi,"AppForOfficeReference",null,[1036]);class yh{constructor(O,ca){this._id=O;this.xVh=ca}get id(){return this._id}get slideId(){return this.xVh}}Object(h.a)(yh,"AppForOfficeShape",null,[1035]);class Rj{constructor(O,ca,Ta,xb,Tb,wc=null,sd=!1){this.nKh=O;this.$Xh=ca;this.w2a=Ta;this.UTh=
xb;this.Fyd=Tb;this.isForUILessAction=sd;this.BRh=wc}get BXf(){return this.nKh}get visibility(){return this.$Xh}get width(){return this.w2a}get row(){return this.UTh}get ownerAddinSolutionId(){return this.Fyd}get ownerAddinStoreType(){return this.BRh}}Object(h.a)(Rj,"AppForOfficeTaskpane",null,[1034]);class Ci{constructor(O,ca,Ta,xb=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=O;this.controlId=ca;this.ddaBinding=Ta;this.ArrayData=xb}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}
Object(h.a)(Ci,"DdaEventArgs",null,[]);class bk{constructor(O,ca){this.qxb=null;this.Xd=O;this.ia=ca}ZWd(O){this.qxb||this.dwk();if(!O||!this.qxb[O])return null;O=this.qxb[O];O.qe=this.Xd;O.Ym=this.ia;return O}lNf(O){const ca=this.qxb;for(let Ta in ca)ca[Ta].removeHandler(O)}set(O,ca){this.qxb[O]=ca}}Object(h.a)(bk,"ApiEventStore",null,[]);class zg{constructor(){this.ho=this.ia=this.Xd=null;this.fl={}}get handlers(){return this.fl}get Ym(){return this.ia}set Ym(O){this.ia=O}get qe(){return this.Xd}set qe(O){this.Xd=
O}raiseEvent(O,ca=null){O=this.ura(O);if(ca){var Ta=this.fl[ca];Ta&&Ta(O)}else for(Ta in ca=this.fl,ca){const xb=ca[Ta];xb&&xb(O)}}addHandler(O,ca,Ta=null){this.fl[O]=ca;this.v3a(Ta)}removeHandler(O,ca,Ta=null){delete this.fl[O];this.v3a(Ta)}get result(){return this.ho}v3a(O){this.kA(O,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}kA(O,ca){O&&(this.ho={},this.ho[Na.c_Error]=ca,O(this.ho))}}Object(h.a)(zg,"ApiEvent",null,[1062]);class xf extends zg{constructor(){super()}ura(O){return O}static get instance(){xf.qp||
(xf.qp=new xf);return xf.qp}}xf.qp=null;Object(h.a)(xf,"ActivationStatusChangedEvent",zg,[]);class Qh extends zg{constructor(){super()}ura(){return"view"}static get instance(){Qh.qp||(Qh.qp=new Qh);return Qh.qp}}Qh.qp=null;Object(h.a)(Qh,"ActiveViewChangedEvent",zg,[]);var Lh=d(101);class oj extends zg{constructor(){super();this.tde=null}ura(){return null}get rqa(){!this.tde&&this.qe&&(this.tde=qe.getInstance(this.qe.yn));return this.tde}addHandler(O,ca,Ta=null,xb=null){this.qe?this.qe.Wt.Hia()?O in
this.handlers?this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(m.ULS.sendTraceTag(20247126,802,50,"AddHandler was called."),this.showDialog(O,xb,Tb=>{Tb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Lh.a.count(this.handlers)||this.rqa.d4h(Object(E.a)(this,this.Bve,"onMessageParentEvent")),this.handlers[O]=ca,this.qe.yn?({value:Tb}=qe.Ffg().Of(O),Tb?(this.qe.yn.setActivationCompletedStatus(Tb.kg,!0),this.qe.OWa(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),
Tb.kg,!0)):m.ULS.sendTraceTag(24463263,806,15,"Show dialog successed but get dialogInfo failed")):m.ULS.sendTraceTag(24463264,806,15,"Show dialog successed but ContextActivationManager is null"),this.v3a(Ta)):(m.ULS.sendTraceTag(20247127,806,10,"Show dialog failed. Error code: {0}",Tb.toString()),this.kA(Ta,Tb))})):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(O,ca,Ta=null){this.qe?this.qe.Wt.Hia()?
O in this.handlers?(m.ULS.sendTraceTag(20247128,802,50,"RemoveHandler was called."),this.rqa.Tni(O,xb=>{delete this.handlers[O];Lh.a.count(this.handlers)||this.rqa.$ch(Object(E.a)(this,this.Bve,"onMessageParentEvent"));xb!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&m.ULS.sendTraceTag(20247129,806,10,"Close dialog failed. Error code: {0}",xb.toString());this.kA(Ta,xb)})):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(O,ca,Ta){try{this.rqa.showDialog(ca,O,Ta,null)}catch(xb){m.ULS.sendTraceTag(19535264,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",xb.message),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Bve(O,ca){if(ca.controlId in this.fl){O={};O[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=ca.messageType;O[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=
ca.messageContent;O[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=ca.Rre;O[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=ca.UIa;const Ta=this.fl[ca.controlId];Ta&&Ta(O);ca.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.fl[ca.controlId],Lh.a.count(this.fl)||this.rqa.$ch(Object(E.a)(this,this.Bve,"onMessageParentEvent")))}}static get instance(){oj.qp||(oj.qp=new oj);return oj.qp}}oj.qp=null;Object(h.a)(oj,"DialogMessageReceivedEvent",
zg,[]);class gj extends zg{constructor(){super()}ura(){return null}addHandler(O,ca,Ta=null){this.qe?this.qe.Wt.Hia()?(ca=this.qe.xrb(O))&&ca.taskpane&&ca.taskpane.isForUILessAction?(this.Ym.Ka(Vd.a.Ekc,2,O),this.v3a(Ta)):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(O,ca,Ta=null){this.qe?this.qe.Wt.Hia()?(ca=this.qe.xrb(O))&&ca.taskpane?
ca.taskpane.isForUILessAction?(this.Ym.Ka(Vd.a.T1b,2,O),this.v3a(Ta)):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(h.a)(gj,"DialogNotificationShownInAddinEvent",zg,[]);class Di extends zg{constructor(){super();this.yn=this.lId=null}ura(){return null}get rqa(){this.lId||
(this.lId=qe.getInstance(this.contextActivationMgr));return this.lId}get contextActivationMgr(){!this.yn&&this.qe&&(this.yn=this.qe.yn);return this.yn}addHandler(O,ca,Ta=null){this.qe&&!this.qe.Wt.Hia()?this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):O in this.fl?this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(Lh.a.count(this.fl)||this.rqa.c4h(Object(E.a)(this,this.sZg,"onMessageDialogEvent")),this.fl[O]=ca,this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(O,
ca,Ta=null){this.qe&&!this.qe.Wt.Hia()?this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):O in this.fl?(delete this.fl[O],Lh.a.count(this.fl)||this.rqa.LPk(Object(E.a)(this,this.sZg,"onMessageDialogEvent")),this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}sZg(O,ca){ca.controlId in this.fl&&(O={},O[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=ca.messageType,O[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=
ca.messageContent,O[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=ca.Rre,O[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=ca.UIa,(ca=this.fl[ca.controlId])&&ca(O))}static get instance(){Di.qp||(Di.qp=new Di);return Di.qp}}Di.qp=null;Object(h.a)(Di,"DialogParentMessageReceivedEvent",zg,[]);class dh extends zg{constructor(){super()}ura(){return{}}static get instance(){dh.qp||(dh.qp=new dh);return dh.qp}}dh.qp=null;Object(h.a)(dh,"DocumentSelectionChangedEvent",
zg,[]);class Ig extends zg{constructor(){super()}ura(){return null}raiseEvent(O,ca){try{const Ta=this.fl[ca];Ta&&(ca={},ca[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=O,Ta(ca))}catch(Ta){wb.a.J(17687447,802,10,"DocumentThemeChanged Event failed, message: "+Ta.message)}}static get instance(){Ig.qp||(Ig.qp=new Ig);return Ig.qp}}Ig.qp=null;Object(h.a)(Ig,"DocumentThemeChangedEvent",zg,[]);class ua extends zg{constructor(){super()}ura(){return null}addHandler(O,ca,Ta=null){this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(O,
ca,Ta=null){this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get instance(){ua.qp||(ua.qp=new ua);return ua.qp}}ua.qp=null;Object(h.a)(ua,"OfficeThemeChangedEvent",zg,[]);class Pa{constructor(){}}Object(h.a)(Pa,"RichApiEventManagerHost",null,[1063]);class eb extends zg{constructor(){super();this.DAd=null}ura(O){return O}addHandler(O,ca,Ta=null,xb=null){this.qe&&Ja.a(xb)?(this.DAd||(this.DAd=new Pa(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.DAd)),
this.fl[O]=ca,this.v3a(Ta)):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(O,ca,Ta=null,xb=null){this.qe&&Ja.a(xb)&&O in this.fl?(delete this.fl[O],this.v3a(Ta)):this.kA(Ta,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){return eb.Ja||(eb.Ja=new eb)}}eb.Ja=null;Object(h.a)(eb,"RichApiMessageEvent",zg,[]);class Kb extends zg{constructor(){super()}ura(O){return O}static get instance(){Kb.qp||(Kb.qp=new Kb);return Kb.qp}}Kb.qp=null;Object(h.a)(Kb,
"SettingsChangedEvent",zg,[]);class bc extends bk{constructor(O,ca){super(O,ca)}dwk(){this.qxb={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,Kb.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,Qh.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,xf.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,Ig.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,ua.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,
dh.instance);this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,oj.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Di.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new gj);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,eb.instance)}}Object(h.a)(bc,"EditorEventStore",bk,[]);class oc{constructor(O){this.H9b=null;this.Xd=O}MXi(O){this.H9b||this.vwk();if(!O||!this.H9b[O])return null;if(O=this.H9b[O]())O.qe=this.Xd;return O}set(O,
ca){this.H9b[O]=ca}}Object(h.a)(oc,"ApiMethodFactory",null,[]);class W{constructor(O,ca,Ta,xb){this.instanceId=O.toLowerCase();this.fileSize=ca;this.LUd=xb;this.xrh=Ta}}Object(h.a)(W,"DocumentCopy",null,[]);var ta=d(378),da=d(274);class Ea extends ta.a{constructor(O,ca,Ta,xb,Tb,wc,sd){super();this.HA=O.string;this.HG=ca;this.Tja=Ta;this.jda=Tb;this.n8j=xb;this.h6b=wc;this.QSa=sd;this.cWa=Object(E.a)(this,this.dkk,"onGetDocumentCopyChunkFinished");this.onError=Object(E.a)(this,this.ckk,"onGetDocumentCopyChunkError")}start(){this.Lgd=
!1;da.a.Q8f(this.HA,this.HG,this.Tja,this.n8j,this.jda,Object(E.a)(this,this.Kba,"handleWebserviceResponse"),Object(E.a)(this,this.Jba,"handleWebserviceError"))}dkk(O){if(O.lPa){const ca={};O=O.result;ca.value=O.FileData;ca.errorCode=O.ErrorCode;this.h6b(this.HG,ca)}else this.handleError(O)}ckk(O){this.handleError(O)}handleError(O){this.QSa&&(O=O.error,this.QSa(this.HG,!!O&&2===O.type))}}Object(h.a)(Ea,"GetDocumentCopyChunkTask",ta.a,[]);class $a extends ta.a{constructor(O,ca,Ta,xb,Tb,wc){super();
this.HA=O.string;this.HG=ca;this.Tja=Ta;this.jda=xb;this.h6b=Tb;this.QSa=wc;this.cWa=Object(E.a)(this,this.fkk,"onGetDocumentCopyFinished");this.onError=Object(E.a)(this,this.ekk,"onGetDocumentCopyError")}start(){this.Lgd=!1;da.a.L1i(this.HA,this.HG,this.Tja,Object(E.a)(this,this.Kba,"handleWebserviceResponse"),Object(E.a)(this,this.Jba,"handleWebserviceError"))}fkk(O){if(O.lPa){const ca={};O=O.result;ca.fileSize=O.FileSize;ca.errorCode=O.ErrorCode;ca.format=this.Tja;ca.sliceSize=this.jda;this.h6b(this.HG,
ca)}else this.handleError(O)}ekk(O){this.handleError(O)}handleError(O){this.QSa&&(O=O.error,this.QSa(this.HG,!!O&&2===O.type))}}Object(h.a)($a,"GetDocumentCopyTask",ta.a,[]);class fb extends ta.a{constructor(O,ca,Ta,xb,Tb,wc,sd){super();this.HA=O.string;this.HG=ca;this.Tja=Ta;this.x3j=xb;this.w3j=Tb;this.h6b=wc;this.QSa=sd;this.cWa=Object(E.a)(this,this.jnk,"onReleaseDocumentCopyFinished");this.onError=Object(E.a)(this,this.hnk,"onReleaseDocumentCopyError")}start(){this.Lgd=!1;da.a.Dhc(this.HA,this.HG,
this.Tja,this.x3j,this.w3j,Object(E.a)(this,this.Kba,"handleWebserviceResponse"),Object(E.a)(this,this.Jba,"handleWebserviceError"))}jnk(O){if(O.lPa){const ca={};ca.errorCode=O.result.ErrorCode;this.h6b(this.HG,ca)}else this.handleError(O)}hnk(O){this.handleError(O)}handleError(O){this.QSa&&(O=O.error,this.QSa(this.HG,!!O&&2===O.type))}}Object(h.a)(fb,"ReleaseGetDocumentCopyTask",ta.a,[]);class qc{constructor(){this.C3c=null}start(){this.C3c.start()}static kxi(O,ca,Ta,xb,Tb,wc){const sd=new qc;sd.C3c=
new $a(O,ca,Ta,xb,Tb,wc);return sd}static jxi(O,ca,Ta,xb,Tb,wc,sd){const $b=new qc;$b.C3c=new Ea(O,ca,Ta,xb,Tb,wc,sd);return $b}static ISf(O,ca,Ta,xb,Tb,wc,sd){const $b=new qc;$b.C3c=new fb(O,ca,Ta,xb,Tb,wc,sd);return $b}}Object(h.a)(qc,"AppForOfficeTask",null,[]);class Hc{constructor(){this.bfe=1;this.O1e=new Qb.a}get jBa(){return this.O1e}ehi(O,ca,Ta,xb){const Tb=this.Qag();O=new W(O,ca,Ta,xb);this.jBa.$(Tb.toString(),O);return Tb}qsg(O,ca){for(let Ta of this.jBa){const xb=Ta.value;if(xb.instanceId===
O.toLowerCase()&&xb.LUd===ca)return!0}return!1}V6f(O){return this.jBa.ga(O.toString())}fNk(O){this.jBa.remove(O.toString())}Dhc(O,ca,Ta,xb){(xb&&this.gNk(ca)||Ta&&this.YMk())&&qc.ISf(O,ca,4,Ta,xb,()=>{},()=>{}).start()}YMk(){let O=!1;0<this.jBa.count&&(this.O1e=new Qb.a,O=!0);return O}gNk(O){if(!O)return!1;const ca=[];for(let Ta of this.jBa)Ta.value.instanceId===O.toLowerCase()&&ca.push(Ta.key);for(O=0;O<ca.length;O++)this.jBa.remove(ca[O]);return 0<ca.length}Qag(){return this.bfe++}}Object(h.a)(Hc,
"GetDocumentCopyHelper",null,[989]);class kd{constructor(O,ca){this.jGg=ca.length;this.jda=O;this.m8j=Math.ceil(this.jGg/O);this.jui(ca)}jui(O){for(let ca=0;ca<this.m8j;ca++){const Ta=ca*this.jda;O.slice(Ta,Math.min(Ta+this.jda,this.jGg))}}}Object(h.a)(kd,"DocumentCopyCache",null,[]);class Ac{constructor(){this.ine=this.Jne=null;this.jne=this.Kne=0}add(O,ca,Ta,xb){4===ca?(this.Kne=O,this.Jne=new kd(Ta,xb)):3===ca&&(this.jne=O,this.ine=new kd(Ta,xb))}remove(O){this.Kne===O?(this.Kne=0,this.Jne=null):
this.jne===O&&(this.jne=0,this.ine=null)}contains(O){return 4===O&&!!this.Jne||3===O&&!!this.ine}}Object(h.a)(Ac,"PerAppCache",null,[]);class Lc{get cache(){return Lc.Zh}get MUd(){return Lc.C0j}qsg(O,ca){return O in this.cache&&this.cache[O].contains(ca)}Q8f(){}Dhc(O){if(O.toString()in this.MUd){const ca=this.MUd[O.toString()];delete this.MUd[O.toString()];this.cache[ca].remove(O)}}Qag(){return Lc.bfe++}}Lc.Zh={};Lc.C0j={};Lc.bfe=1;Object(h.a)(Lc,"GetFileApiProxy",null,[1094]);class yc{constructor(O,
ca,Ta){this.oh=0;this.controlId=this.hya=this.GD=this.Awb=this.Xd=this.ho=null;this.parameters=O;this.callback=ca;this.t6h=Ta;new Lc;this.y9a=new fj;this.DTa=new Hc}get nAc(){this.y9a||(this.y9a=new fj);return this.y9a}get xba(){return this.DTa}get bXk(){this.GD||(this.GD=mc.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));return this.GD}get Hsj(){return this.hya||(this.hya=mc.a.instance.La("Postmessage.IHostPostmessenger"))}get errorCode(){return this.oh}set errorCode(O){this.oh=
O}get result(){return this.ho}set result(O){this.ho=O}get Wt(){return this.Awb}get qe(){return this.Xd}set qe(O){(this.Xd=O)?(this.Awb=this.Xd.Wt,this.DTa=this.Xd.xba):this.DTa=this.Awb=null}go(){this.ho={};try{this.Jq()}catch(O){this.VUj(O)}this.dH()}VUj(O){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;wb.a.J(18396573,802,10,"Error when executing API: {0}",O.toString())}dH(){this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&wb.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",
this.oh);this.ho[Na.c_Error]=this.oh;this.callback(this.ho)}aXd(){return this.controlId?this.qe?this.qe.tZ.sV(this.controlId):null:null}SXi(){if(!this.controlId)return null;let O=null;this.qe&&(O=this.qe.tZ.sV(this.controlId));return O?0===O.hy?this.qe.D2f(O.shape.slideId,O.shape.id):1===O.hy?this.qe.mBa(O.Zm.id):null:null}t1d(O){return O?this.qe?this.qe.t1d(O):null:null}}Object(h.a)(yc,"ApiMethod",null,[]);class Oc extends yc{constructor(){super()}Jq(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[P.a.i6h][P.a.h6h],
this.parameters);this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}Object(h.a)(Oc,"AppCommandInvocationCompletedMethod",yc,[]);class od extends yc{constructor(){super()}go(){this.ho={};this.Jq()}Jq(){if(this.Wt)try{const O=this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();O&&O.length>this.qe.BHd.kd.pptEditorAppsForOfficeCreateDocumentApiMaxAllowedBase64?(m.ULS.sendTraceTag(587747342,802,15,"Too large base64 stream size:{0}",
O.length),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.dH()):this.Wt.h4a(O,Object(E.a)(this,this.Gwi,"createDocumentSuccessCallback"),Object(E.a)(this,this.Fwi,"createDocumentFailCallback"))}catch(O){wb.a.J(35156300,802,10,"Exception thrown at CreateDocumentMethod: "+O.toString()),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.dH()}else this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.dH()}Gwi(O){const ca=new y.StandardDialog;ca.vd=4;ca.Yw(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_OpenWindowConsentMessage,1,Ta=>{1===Ta&&window.open(O);this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.dH()})}Fwi(O){this.oh=O?O:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.dH()}get description(){return"Create a new ppt document in the user's default folder."}}Object(h.a)(od,"CreateDocumentMethod",yc,[]);var di=d(94),ij=d(87);class rh{static dIk(O){const ca=new Map;ca.set("ApiId",O.toString());di.Health.instance.recordKpiUsage(rh.qhh,1,rh.mhh,ca)}static cIk(O,
ca,Ta){const xb=new Map;xb.set("ApiId",O.toString());O=Object.assign(new ij.a,{extendedProperties:xb,durationMs:rh.W8f(ca,Ta)});di.Health.instance.recordKpiSuccess(rh.qhh,O)}static qah(O){const ca=new Map;ca.set("fWacPartition",O.toString());di.Health.instance.recordKpiUsage(rh.rhh,1,rh.mhh,ca)}static FCe(O,ca){O=Object.assign(new ij.a,{durationMs:rh.W8f(O,ca)});di.Health.instance.recordKpiSuccess(rh.rhh,O)}static W8f(O,ca){let Ta=null;O&&ca&&(Ta=ca-O);return Ta}}rh.qhh="PptApiCall";rh.rhh="PptApiRequest";
rh.mhh="pptom";Object(h.a)(rh,"PptWacApiTelemetry",null,[]);class Qg{constructor(){this.ver=0;this.exec=this.sel=null}}Object(h.a)(Qg,"ApiRequest",null,[]);class be{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(h.a)(be,"SelectionData",null,[]);const Oi=(O,ca)=>{var Ta=Object,xb=Ta.assign,Tb=new Qg,wc=Object,sd=wc.assign,$b=new be,ge=O.Wt.mf();const we=[];if(ge){we.length=ge.length;for(var oe=0;oe<ge.length;oe++)we[oe]=ge[oe].Bb.toString()}ge=O.Wt.ae();oe=[];if(ge){oe.length=ge.length;
for(let Fe=0;Fe<ge.length;Fe++)oe[Fe]=ge[Fe].get_shapeId().toString()}O=xb.call(Ta,Tb,{ver:1,exec:ca,sel:sd.call(wc,$b,{sldLst:we,shpLst:oe,txRn:O.Wt.Ebj()})});return Sys.Serialization.JavaScriptSerializer.serialize(O)},Pi=O=>{let ca,Ta;ca=O.addType("Microsoft.Office.PowerPoint.Application","{549654b5-691c-491b-bed1-3eccfa85e525}","{64189aae-7617-40e1-ba92-365392bd2387}",3,0);Ta=ca.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);Ta.addParameter("address","String",1,null,0);Ta.addParameter("displayName",
"String",1,null,0);Ta=ca.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",1,0,"InsertSlideFromContent",4);Ta.addParameter("slideContent","String",1,null,0);ca=O.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}","",3,0);ca.addProperty("SlideMasters",3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);ca.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);ca.addProperty("Tags",
4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ca.addProperty("Title",1,"String",1,!0,null,0);ca.addMethod("GetSelectedShapes",5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",0);ca.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);ca.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRange",0);ca.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",
3,0,"SelectedTextRangeOrNullObject",0);Ta=ca.addMethod("InsertSlidesFromBase64",1003,"Void",0,0,"InsertSlidesFromBase64",0);Ta.addParameter("base64File","String",1,null,0);Ta.addParameter("options","Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);Ta=ca.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",0);Ta.addParameter("slideIds","String[]",1,null,0);Ta=ca.addMethod("_RegisterEvent",1001,"Void",0,1,"_RegisterEvent",0);Ta.addParameter("referenceId","String",1,null,0);Ta.addParameter("eventType",
"Int32",1,null,0);Ta=ca.addMethod("_UnregisterEvent",1002,"Void",0,1,"_UnregisterEvent",0);Ta.addParameter("referenceId","String",1,null,0);Ta.addParameter("eventType","Int32",1,null,0);ca=O.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",2,0);ca.addProperty("LayoutId",1,"String",1,!1,null,0);ca.addProperty("SlideMasterId",2,"String",1,!1,null,0);ca=O.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}",
"",3,0);ca.addProperty("Visible",2,"Boolean",1,!1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=O.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");ca.addEnumField("Straight",0);ca.addEnumField("Elbow",1);ca.addEnumField("Curve",2);ca=O.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");ca.addEnumField("LineInverse",0);ca.addEnumField("Triangle",1);ca.addEnumField("RightTriangle",2);ca.addEnumField("Rectangle",3);ca.addEnumField("Diamond",4);ca.addEnumField("Parallelogram",
5);ca.addEnumField("Trapezoid",6);ca.addEnumField("NonIsoscelesTrapezoid",7);ca.addEnumField("Pentagon",8);ca.addEnumField("Hexagon",9);ca.addEnumField("Heptagon",10);ca.addEnumField("Octagon",11);ca.addEnumField("Decagon",12);ca.addEnumField("Dodecagon",13);ca.addEnumField("Star4",14);ca.addEnumField("Star5",15);ca.addEnumField("Star6",16);ca.addEnumField("Star7",17);ca.addEnumField("Star8",18);ca.addEnumField("Star10",19);ca.addEnumField("Star12",20);ca.addEnumField("Star16",21);ca.addEnumField("Star24",
22);ca.addEnumField("Star32",23);ca.addEnumField("RoundRectangle",24);ca.addEnumField("Round1Rectangle",25);ca.addEnumField("Round2SameRectangle",26);ca.addEnumField("Round2DiagonalRectangle",27);ca.addEnumField("SnipRoundRectangle",28);ca.addEnumField("Snip1Rectangle",29);ca.addEnumField("Snip2SameRectangle",30);ca.addEnumField("Snip2DiagonalRectangle",31);ca.addEnumField("Plaque",32);ca.addEnumField("Ellipse",33);ca.addEnumField("Teardrop",34);ca.addEnumField("HomePlate",35);ca.addEnumField("Chevron",
36);ca.addEnumField("PieWedge",37);ca.addEnumField("Pie",38);ca.addEnumField("BlockArc",39);ca.addEnumField("Donut",40);ca.addEnumField("NoSmoking",41);ca.addEnumField("RightArrow",42);ca.addEnumField("LeftArrow",43);ca.addEnumField("UpArrow",44);ca.addEnumField("DownArrow",45);ca.addEnumField("StripedRightArrow",46);ca.addEnumField("NotchedRightArrow",47);ca.addEnumField("BentUpArrow",48);ca.addEnumField("LeftRightArrow",49);ca.addEnumField("UpDownArrow",50);ca.addEnumField("LeftUpArrow",51);ca.addEnumField("LeftRightUpArrow",
52);ca.addEnumField("QuadArrow",53);ca.addEnumField("LeftArrowCallout",54);ca.addEnumField("RightArrowCallout",55);ca.addEnumField("UpArrowCallout",56);ca.addEnumField("DownArrowCallout",57);ca.addEnumField("LeftRightArrowCallout",58);ca.addEnumField("UpDownArrowCallout",59);ca.addEnumField("QuadArrowCallout",60);ca.addEnumField("BentArrow",61);ca.addEnumField("UturnArrow",62);ca.addEnumField("CircularArrow",63);ca.addEnumField("LeftCircularArrow",64);ca.addEnumField("LeftRightCircularArrow",65);
ca.addEnumField("CurvedRightArrow",66);ca.addEnumField("CurvedLeftArrow",67);ca.addEnumField("CurvedUpArrow",68);ca.addEnumField("CurvedDownArrow",69);ca.addEnumField("SwooshArrow",70);ca.addEnumField("Cube",71);ca.addEnumField("Can",72);ca.addEnumField("LightningBolt",73);ca.addEnumField("Heart",74);ca.addEnumField("Sun",75);ca.addEnumField("Moon",76);ca.addEnumField("SmileyFace",77);ca.addEnumField("IrregularSeal1",78);ca.addEnumField("IrregularSeal2",79);ca.addEnumField("FoldedCorner",80);ca.addEnumField("Bevel",
81);ca.addEnumField("Frame",82);ca.addEnumField("HalfFrame",83);ca.addEnumField("Corner",84);ca.addEnumField("DiagonalStripe",85);ca.addEnumField("Chord",86);ca.addEnumField("Arc",87);ca.addEnumField("LeftBracket",88);ca.addEnumField("RightBracket",89);ca.addEnumField("LeftBrace",90);ca.addEnumField("RightBrace",91);ca.addEnumField("BracketPair",92);ca.addEnumField("BracePair",93);ca.addEnumField("Callout1",94);ca.addEnumField("Callout2",95);ca.addEnumField("Callout3",96);ca.addEnumField("AccentCallout1",
97);ca.addEnumField("AccentCallout2",98);ca.addEnumField("AccentCallout3",99);ca.addEnumField("BorderCallout1",100);ca.addEnumField("BorderCallout2",101);ca.addEnumField("BorderCallout3",102);ca.addEnumField("AccentBorderCallout1",103);ca.addEnumField("AccentBorderCallout2",104);ca.addEnumField("AccentBorderCallout3",105);ca.addEnumField("WedgeRectCallout",106);ca.addEnumField("WedgeRRectCallout",107);ca.addEnumField("WedgeEllipseCallout",108);ca.addEnumField("CloudCallout",109);ca.addEnumField("Cloud",
110);ca.addEnumField("Ribbon",111);ca.addEnumField("Ribbon2",112);ca.addEnumField("EllipseRibbon",113);ca.addEnumField("EllipseRibbon2",114);ca.addEnumField("LeftRightRibbon",115);ca.addEnumField("VerticalScroll",116);ca.addEnumField("HorizontalScroll",117);ca.addEnumField("Wave",118);ca.addEnumField("DoubleWave",119);ca.addEnumField("Plus",120);ca.addEnumField("FlowChartProcess",121);ca.addEnumField("FlowChartDecision",122);ca.addEnumField("FlowChartInputOutput",123);ca.addEnumField("FlowChartPredefinedProcess",
124);ca.addEnumField("FlowChartInternalStorage",125);ca.addEnumField("FlowChartDocument",126);ca.addEnumField("FlowChartMultidocument",127);ca.addEnumField("FlowChartTerminator",128);ca.addEnumField("FlowChartPreparation",129);ca.addEnumField("FlowChartManualInput",130);ca.addEnumField("FlowChartManualOperation",131);ca.addEnumField("FlowChartConnector",132);ca.addEnumField("FlowChartPunchedCard",133);ca.addEnumField("FlowChartPunchedTape",134);ca.addEnumField("FlowChartSummingJunction",135);ca.addEnumField("FlowChartOr",
136);ca.addEnumField("FlowChartCollate",137);ca.addEnumField("FlowChartSort",138);ca.addEnumField("FlowChartExtract",139);ca.addEnumField("FlowChartMerge",140);ca.addEnumField("FlowChartOfflineStorage",141);ca.addEnumField("FlowChartOnlineStorage",142);ca.addEnumField("FlowChartMagneticTape",143);ca.addEnumField("FlowChartMagneticDisk",144);ca.addEnumField("FlowChartMagneticDrum",145);ca.addEnumField("FlowChartDisplay",146);ca.addEnumField("FlowChartDelay",147);ca.addEnumField("FlowChartAlternateProcess",
148);ca.addEnumField("FlowChartOffpageConnector",149);ca.addEnumField("ActionButtonBlank",150);ca.addEnumField("ActionButtonHome",151);ca.addEnumField("ActionButtonHelp",152);ca.addEnumField("ActionButtonInformation",153);ca.addEnumField("ActionButtonForwardNext",154);ca.addEnumField("ActionButtonBackPrevious",155);ca.addEnumField("ActionButtonEnd",156);ca.addEnumField("ActionButtonBeginning",157);ca.addEnumField("ActionButtonReturn",158);ca.addEnumField("ActionButtonDocument",159);ca.addEnumField("ActionButtonSound",
160);ca.addEnumField("ActionButtonMovie",161);ca.addEnumField("Gear6",162);ca.addEnumField("Gear9",163);ca.addEnumField("Funnel",164);ca.addEnumField("MathPlus",165);ca.addEnumField("MathMinus",166);ca.addEnumField("MathMultiply",167);ca.addEnumField("MathDivide",168);ca.addEnumField("MathEqual",169);ca.addEnumField("MathNotEqual",170);ca.addEnumField("CornerTabs",171);ca.addEnumField("SquareTabs",172);ca.addEnumField("PlaqueTabs",173);ca.addEnumField("ChartX",174);ca.addEnumField("ChartStar",175);
ca.addEnumField("ChartPlus",176);ca=O.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");ca.addEnumField("KeepSourceFormatting",0);ca.addEnumField("UseDestinationTheme",1);ca=O.addType("Microsoft.Office.PowerPoint.InsertSlideOptions","{9ca3e504-5701-467b-9596-15521056bac3}","{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",2,0);ca.addProperty("Formatting",1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);ca.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);ca.addProperty("TargetSlideId",
5,"String",1,!1,null,0);ca=O.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");ca.addEnumField("Left",0);ca.addEnumField("Center",1);ca.addEnumField("Right",2);ca.addEnumField("Justify",3);ca.addEnumField("JustifyLow",4);ca.addEnumField("Distributed",5);ca.addEnumField("ThaiDistributed",6);ca=O.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}","",3,0);ca.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,
null,0);ca.addProperty("HorizontalAlignment",2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,null,0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}","{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",2,0);ca.addProperty("Height",1,"Double",1,!1,null,0);ca.addProperty("Left",2,"Double",1,!1,null,0);ca.addProperty("Top",3,"Double",1,!1,null,0);ca.addProperty("Width",4,"Double",1,!1,null,
0);ca=O.addType("Microsoft.Office.PowerPoint.ShapeCollection","{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);Ta=ca.addMethod("AddGeometricShape",6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);Ta.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",1,null,0);Ta.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ta=ca.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);Ta.addParameter("connectorType",
"Microsoft.Office.PowerPoint.ConnectorType",1,null,0);Ta.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ta=ca.addMethod("AddTextBox",8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);Ta.addParameter("text","String",1,null,0);Ta.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ta=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Ta.addParameter("key","String",1,null,0);
Ta=ca.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Ta.addParameter("index","Int32",1,null,0);Ta=ca.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Ta.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);ca=O.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);ca.addProperty("Id",
1,"String",1,!0,null,0);ca.addProperty("Name",3,"String",1,!0,null,0);ca.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ta=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideLayout",3,0);Ta.addParameter("key","String",1,null,0);Ta=ca.addMethod("GetItemAt",
3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);Ta.addParameter("index","Int32",1,null,0);Ta=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ItemOrNullObject",0);Ta.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);ca=O.addType("Microsoft.Office.PowerPoint.SlideMaster","{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);ca.addProperty("Id",1,"String",
1,!0,null,0);ca.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,!0,null,0);ca.addProperty("Name",4,"String",1,!0,null,0);ca.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}","",3,0);ca.addProperty("Key",2,"String",1,!0,null,0);ca.addProperty("Value",3,"String",1,!1,null,0);ca.addMethod("_OnAccess",
1,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}","",3,0);Ta=ca.addMethod("Add",1,"Void",0,0,"Add",0);Ta.addParameter("key","String",1,null,0);Ta.addParameter("value","String",1,null,0);Ta=ca.addMethod("Delete",2,"Void",0,0,"Delete",0);Ta.addParameter("key","String",1,null,0);ca.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ta=ca.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",3,0);Ta.addParameter("key","String",1,null,
0);Ta=ca.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);Ta.addParameter("index","Int32",1,null,0);Ta=ca.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);Ta.addParameter("key","String",1,null,0);ca.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);ca=O.addType("Microsoft.Office.PowerPoint.Slide","{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}","",3,0);ca.addProperty("Id",1,"String",
1,!0,null,0);ca.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);ca.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ca.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",3,!0,null,0);ca.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ca.addMethod("Delete",3,"Void",0,0,"Delete",0);Ta=ca.addMethod("SetSelectedShapes",8,"Void",0,0,"SetSelectedShapes",0);Ta.addParameter("shapeIds","String[]",
1,null,0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=O.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");ca.addEnumField("NoFill",0);ca.addEnumField("Solid",1);ca.addEnumField("Gradient",2);ca.addEnumField("Pattern",3);ca.addEnumField("PictureAndTexture",4);ca.addEnumField("SlideBackground",5);ca=O.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);ca.addProperty("ForegroundColor",2,"String",1,!1,null,0);ca.addProperty("Transparency",
5,"Double",1,!1,null,0);ca.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);ca.addMethod("Clear",1,"Void",0,0,"Clear",0);Ta=ca.addMethod("SetSolidColor",4,"Void",0,0,"SetSolidColor",0);Ta.addParameter("color","String",1,null,0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=O.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");ca.addEnumField("Single",0);ca.addEnumField("ThickBetweenThin",1);ca.addEnumField("ThickThin",2);ca.addEnumField("ThinThick",3);
ca.addEnumField("ThinThin",4);ca=O.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");ca.addEnumField("Dash",0);ca.addEnumField("DashDot",1);ca.addEnumField("DashDotDot",2);ca.addEnumField("LongDash",3);ca.addEnumField("LongDashDot",4);ca.addEnumField("RoundDot",5);ca.addEnumField("Solid",6);ca.addEnumField("SquareDot",7);ca.addEnumField("LongDashDotDot",8);ca.addEnumField("SystemDash",9);ca.addEnumField("SystemDot",10);ca.addEnumField("SystemDashDot",11);ca=O.addType("Microsoft.Office.PowerPoint.ShapeLineFormat",
"{f275eab8-4363-41e8-b11a-e41e3c725f21}","",3,0);ca.addProperty("Color",1,"String",1,!1,null,0);ca.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",1,!1,null,0);ca.addProperty("Style",4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);ca.addProperty("Transparency",5,"Double",1,!1,null,0);ca.addProperty("Visible",6,"Boolean",1,!1,null,0);ca.addProperty("Weight",7,"Double",1,!1,null,0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=O.addEnumType("Microsoft.Office.PowerPoint.ShapeType");
ca.addEnumField("Unsupported",0);ca.addEnumField("Image",1);ca.addEnumField("GeometricShape",2);ca.addEnumField("Group",3);ca.addEnumField("Line",4);ca=O.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");ca.addEnumField("AutoSizeNone",0);ca.addEnumField("AutoSizeTextToFitShape",1);ca.addEnumField("AutoSizeShapeToFitText",2);ca.addEnumField("AutoSizeMixed",3);ca=O.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");ca.addEnumField("Top",0);ca.addEnumField("Middle",1);ca.addEnumField("Bottom",
2);ca.addEnumField("TopCentered",3);ca.addEnumField("MiddleCentered",4);ca.addEnumField("BottomCentered",5);ca=O.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");ca.addEnumField("None",0);ca.addEnumField("Single",1);ca.addEnumField("Double",2);ca.addEnumField("Heavy",3);ca.addEnumField("Dotted",4);ca.addEnumField("DottedHeavy",5);ca.addEnumField("Dash",6);ca.addEnumField("DashHeavy",7);ca.addEnumField("DashLong",8);ca.addEnumField("DashLongHeavy",9);ca.addEnumField("DotDash",10);
ca.addEnumField("DotDashHeavy",11);ca.addEnumField("DotDotDash",12);ca.addEnumField("DotDotDashHeavy",13);ca.addEnumField("Wavy",14);ca.addEnumField("WavyHeavy",15);ca.addEnumField("WavyDouble",16);ca=O.addType("Microsoft.Office.PowerPoint.ShapeFont","{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);ca.addProperty("Bold",1,"Boolean",1,!1,null,0);ca.addProperty("Color",2,"String",1,!1,null,0);ca.addProperty("Italic",3,"Boolean",1,!1,null,0);ca.addProperty("Name",5,"String",1,!1,null,0);ca.addProperty("Size",
6,"Double",1,!1,null,0);ca.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",1,!1,null,0);ca.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}","",3,0);ca.addProperty("Font",1,"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);ca.addProperty("Length",7,"Int32",1,!1,null,0);ca.addProperty("ParagraphFormat",4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);ca.addProperty("Start",
9,"Int32",1,!1,null,0);ca.addProperty("Text",5,"String",1,!1,null,0);ca.addMethod("GetParentTextFrame",10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);Ta=ca.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",0);Ta.addParameter("start","Int32",1,null,0);Ta.addParameter("length","Int32",1,null,0);ca.addMethod("SetSelected",8,"Void",0,0,"SetSelected",0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.Office.PowerPoint.TextFrame",
"{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);ca.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",1,!1,null,0);ca.addProperty("BottomMargin",2,"Double",1,!1,null,0);ca.addProperty("HasText",4,"Boolean",1,!0,null,0);ca.addProperty("LeftMargin",6,"Double",1,!1,null,0);ca.addProperty("RightMargin",7,"Double",1,!1,null,0);ca.addProperty("TextRange",8,"Microsoft.Office.PowerPoint.TextRange",3,!0,null,0);ca.addProperty("TopMargin",9,"Double",1,!1,null,0);ca.addProperty("VerticalAlignment",
10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);ca.addProperty("WordWrap",11,"Boolean",1,!1,null,0);ca.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);ca.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.Office.PowerPoint.Shape","{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}","",3,0);ca.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);ca.addProperty("Height",
5,"Double",1,!1,null,0);ca.addProperty("Id",1,"String",1,!0,null,0);ca.addProperty("Left",6,"Double",1,!1,null,0);ca.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);ca.addProperty("Name",7,"String",1,!1,null,0);ca.addProperty("Tags",3,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ca.addProperty("TextFrame",13,"Microsoft.Office.PowerPoint.TextFrame",3,!0,null,0);ca.addProperty("Top",8,"Double",1,!1,null,0);ca.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",
1,!0,null,0);ca.addProperty("Width",10,"Double",1,!1,null,0);ca.addMethod("Delete",4,"Void",0,0,"Delete",0);ca.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);ca.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayout",0);ca.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayoutOrNullObject",0);ca.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",
3,0,"ParentSlideMaster",0);ca.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMasterOrNullObject",0);ca.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection","{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ta=ca.addIndexerMethod(2,
"Microsoft.Office.PowerPoint.Shape",3,0);Ta.addParameter("key","String",1,null,0);Ta=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Ta.addParameter("index","Int32",1,null,0);Ta=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Ta.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);ca=O.addType("Microsoft.Office.PowerPoint.SlideCollection",
"{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);Ta=ca.addMethod("Add",6,"Void",0,0,"Add",0);Ta.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",2,null,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ta=ca.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",3,0);Ta.addParameter("key","String",1,null,0);Ta=ca.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Ta.addParameter("index","Int32",1,null,0);Ta=ca.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",
3,0,"ItemOrNullObject",0);Ta.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);ca=O.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ta=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",3,0);Ta.addParameter("key","String",1,null,0);Ta=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",
3,1,"ItemAt",0);Ta.addParameter("index","Int32",1,null,0);Ta=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Ta.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);ca=O.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ta=ca.addIndexerMethod(2,
"Microsoft.Office.PowerPoint.SlideMaster",3,0);Ta.addParameter("key","String",1,null,0);Ta=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",3,1,"ItemAt",0);Ta.addParameter("index","Int32",1,null,0);Ta=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",0);Ta.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",!0);ca=O.addType("Microsoft.AppRuntime.AppRuntimeService",
"{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ca.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Ta=ca.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ta.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ca=O.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ca.addEnumField("Inactive",0);ca.addEnumField("Background",1);ca.addEnumField("Visible",2);ca=O.addEnumType("Microsoft.AppRuntime.Visibility");
ca.addEnumField("Hidden",1);ca.addEnumField("Visible",2);ca=O.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);ca.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);Ta=ca.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);Ta.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ca=O.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");
ca.addEnumField("Unknown",0);ca.addEnumField("Basic",1);ca.addEnumField("Premium",2);ca=O.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Ta=ca.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Ta.addParameter("feature","String",1,null,0);Ta.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ta=ca.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",
3,1,"LicenseFeature",0);Ta.addParameter("feature","String",1,null,0);Ta=ca.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);Ta.addParameter("resource","String",1,null,0);Ta.addParameter("policy","String",1,null,0);Ta.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);Ta=ca.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ta.addParameter("feature","String",1,null,0);Ta.addParameter("fallbackValue","Boolean",1,null,0);ca.addMethod("IsFreemiumUpsellEnabled",
3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ta=ca.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Ta.addParameter("experienceId","String",1,null,0);Ta=ca.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Ta.addParameter("feature","String",1,null,0);ca=O.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);ca.addProperty("Id",5,"String",1,!0,null,0);ca.addMethod("_RegisterStateChange",6,"Void",
0,1,"_RegisterStateChange",0);ca.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ca=O.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0);ca.addProperty("Scopes",1,"String",1,!1,null,0);ca=O.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ca.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",
3,!0,null,0);Ta=ca.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Ta.addParameter("jsonCreate","String",1,null,0);Ta=ca.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ta.addParameter("jsonUpdate","String",1,null,0);Ta=ca.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ta.addParameter("id","String",1,null,0);Ta=ca.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ta.addParameter("id","String",1,null,
0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ca.addProperty("Id",2,"String",1,!0,null,0);Ta=ca.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Ta.addParameter("visibility","Boolean",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ca.addProperty("Enabled",3,"Boolean",
1,!1,null,0);ca.addProperty("Id",2,"String",1,!0,null,0);ca.addProperty("Label",4,"String",1,!0,null,0);Ta=ca.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Ta.addParameter("enabled","Boolean",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=O.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ca.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ta=ca.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ta.addParameter("key",
"String",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0)};var wk=d(41);class xk{constructor(O,ca){this.$$b=O;this.G$b=ca}KRf(O){return[200,null,O]}pNi(O,ca,Ta,xb,Tb,wc){const sd=wk.a.VX(),$b=this.$$b.create(ca,Ta,xb);xb.Vzf=$b;const ge=this.G$b.create(wc);ge.context.appId=ca;ge.context.controlId=Ta;const we=()=>{rh.qah(!0);$b.vze=!1;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest($b,Pi,ge,O).then(Fe=>{if(!Fe)return m.ULS.sendTraceTag(587745500,
802,10,"ExecuteRichApiRequest failed."),Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),null;rh.FCe(sd,wk.a.VX());Tb(Fe,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},Fe=>{m.ULS.sendTraceTag(587745499,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",ca,Fe);Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},oe=()=>{rh.qah(!1);let Fe=O[4];Ye.a("ExtensibilityUseSerializedPayloads")&&(Fe=Oi(xb,Fe));OfficeExtension.WacRuntime.Utility.createPromise(Gf=>
{const Rh={};Rh.promiseToResolve=Gf;Rh.requestBody=Fe;A.AFrameworkApplication.Ta.Ka(Eh.a.LTd,2,Rh)}).then(Gf=>{Ye.a("ExtensibilityResetResponse")&&A.AFrameworkApplication.Ta.Ka(Eh.a.LTd,2,{promiseToResolve:null,requestBody:""});if(Ye.a("ExtensibilityUseSerializedPayloads")){a:if((Gf=Sys.Serialization.JavaScriptSerializer.deserialize(Gf.toString()))&&Gf.sel&&Gf.sel.sldLst){var Rh=wc.presentation,Sh=Gf.sel.sldLst,Wa=[];if(Sh)for(Lg of Sh)({slideId:Sh}=hh.a.eyh(Lg)).returnValue&&(Sh=Object(D.a)(123,
Rh.KB(Sh)))&&Wa.push(Sh);var Lg=Wa;if(Lg.length&&!xb.Wt.Iql(Lg))Gf=null;else{Lg=1===Lg.length?Lg[0]:null;Rh=null;if(Lg&&Gf.sel.shpLst){Wa=Gf.sel.shpLst;Rh=[];if(Wa)for(gg of Wa)(Wa=Lg.oS(parseInt(gg)))&&Rh.push(Wa);var gg=Rh;if(gg.length&&!xb.Wt.Hql(gg)){Gf=null;break a}Rh=1===gg.length?gg[0]:null}Gf=Rh&&Gf.sel.txRn&&(Gf.sel.txRn.length&&2!==Gf.sel.txRn.length||2===Gf.sel.txRn.length&&0<=Gf.sel.txRn[0]&&!xb.Wt.Jql(Rh,Gf.sel.txRn[0],Gf.sel.txRn[1]))?null:Gf.rst}}else Gf=null;Gf?(rh.FCe(sd,wk.a.VX()),
Tb(this.KRf(Gf),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else rh.FCe(sd,wk.a.VX()),Tb(this.KRf(Gf),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})};O?($b.vze=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest($b,Pi,ge,O).then(Fe=>{Fe&&$b.yFg?we():oe();return null},()=>{oe();return null})):we()}}Object(h.a)(xk,"RichApiRequest",
null,[]);class Yl extends yc{constructor(O,ca,Ta){super();this.$$b=O;this.G$b=ca;this.ta=Ta}go(){this.ho={};this.Jq()}Jq(){const O=this.parameters.ArrayData;if(O){var ca=null,Ta=this.aXd();Ye.a("SetOwnerAddinAssetIdForSharedRuntimeAPIsInPptWac")?Ta&&Ta.taskpane&&(ca=Ta.taskpane.ownerAddinSolutionId):Ta&&(ca=Ta.Zm.id);try{(new xk(this.$$b,this.G$b)).pNi(O,ca,this.controlId,this.qe,Object(E.a)(this,this.qNi,"executeRichApiRequestCallback"),this.ta)}catch(xb){wb.a.J(36804577,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+
xb.toString()),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.dH()}}else this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.dH()}qNi(O,ca){this.errorCode=ca;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.ho.Data=O);this.dH()}get description(){return"Run ExecuteRichApi Invocation Completed."}}Object(h.a)(Yl,"ExecuteRichApiRequestMethod",yc,[]);class Af extends yc{constructor(){super()}go(){this.ho={};this.Jq()}Jq(){const O=this.Awb.aCj();m.ULS.sendTraceTag(587747344,
802,50,"GetAccessToken was called!");const ca=(Ta,xb)=>{Ta===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(xb=xb.accessToken,this.ho[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=xb):(xb=this.qe.tZ.sV(this.controlId),m.ULS.sendTraceTag(587747343,802,10,"{0}",{["errorCode"]:Ta.toString(),["appId"]:xb.Zm.id,["storeType"]:xb.Zm.storeType}));this.oh=Ta;this.dH()};this.Hsj.execute(Ta=>{const xb=this.qe.yn,Tb=jd.getInstance();hf.AppsForOfficeSingleSignOnManager.getInstance(xb,Ta,
Tb).getAccessToken(this.controlId,O,this.parameters,ca)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(h.a)(Af,"GetAccessTokenMethod",yc,[]);class Ff extends yc{constructor(){super()}Jq(){let O=null;this.Wt&&(O=Microsoft.Office.WebExtension.ActiveView.Edit);O?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=O,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}
Object(h.a)(Ff,"GetActiveViewMethod",yc,[]);var pj=d(1095);class dl extends yc{constructor(){super()}go(){this.ho={};this.Jq()}Jq(){var O=this.Xd.yn.getOsfControl(this.controlId);if(!A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||O.isFirstParty()){O=O.getManifest();var ca=O.getMarketplaceID(),Ta=O.getWebApplicationId(),xb=O.getWebApplicationMsaId();mc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(ca).then(Tb=>{this.errorCode=
0;const wc={};wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Tb.upn;wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Tb.userId;wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Ta;wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=xb?xb:Ta;wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Tb.authority;wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=pj.a.bYi(Tb.authorityType);wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Tb.isAnonymous;wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Tb.tenantId;wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Tb.supportsAuthToken;this.ho[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=wc;this.dH()},Tb=>{this.oh=1;this.ho[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Tb;this.dH()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(h.a)(dl,"GetAuthContextMethod",yc,[]);class Zl extends yc{constructor(){super()}go(){this.ho=
{};this.Jq();this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.dH()}Jq(){var O=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const ca=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];O=this.xba.V6f(O);!O||ca*O.xrh>=O.fileSize?this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:(qc.jxi(this.qe.presentationId,this.controlId,O.LUd,ca,O.xrh,Object(E.a)(this,this.ZWb,"customizedOnFinished"),Object(E.a)(this,this.YWb,"customizedOnError")).start(),
this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}ZWb(O,ca){O?0===ca.errorCode?(O=ca.value,this.ho[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=O,this.ho[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=O.length,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.dH()}YWb(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
this.dH()}get description(){return"Returns the specified slice."}}Object(h.a)(Zl,"GetDocumentCopyChunkMethod",yc,[]);class Cj extends yc{constructor(){super();this.jda=this.Tja=0}go(){this.ho={};this.Jq();this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.dH()}Jq(){try{const O=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];this.jda=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];if(1>this.jda||4194304<this.jda)wb.a.J(17310339,802,
50,"GetDocumentCopyMethod: Invalid slice size: "+this.jda),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(O){case 1:this.Tja=4;break;case 2:this.Tja=3;break;default:wb.a.J(17310341,802,50,"GetDocumentCopyMethod: Unsupported file type: "+O);this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.xba.qsg(this.controlId,this.Tja)?this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.xba.jBa.count>=this.qe.BHd.kd.pptEditorAppForOfficeMaxDocumentReaders?
this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.bXk.f2(!1,!0,()=>{this.mXk()},Object(E.a)(this,this.Xva,"saveFailureCallback")),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(O){wb.a.J(17310343,802,10,"Exception thrown at GetDocumentCopyMethod: "+O.toString()),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}mXk(){qc.kxi(this.qe.presentationId,this.controlId,this.Tja,this.jda,Object(E.a)(this,this.ZWb,"customizedOnFinished"),Object(E.a)(this,
this.YWb,"customizedOnError")).start()}Xva(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.dH();return!1}ZWb(O,ca){if(O&&O.length){O=ca.format;var Ta=ca.sliceSize,xb=ca.errorCode;0===xb?(ca=ca.fileSize,this.ho[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=ca,ca=this.xba.ehi(this.controlId,ca,Ta,O),this.ho[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=ca,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=174===xb?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:
175===xb?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.dH()}YWb(O,ca){this.oh=ca?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.dH()}get description(){return"Returns the entire document file in slices."}}Object(h.a)(Cj,"GetDocumentCopyMethod",yc,[]);class Sm extends yc{constructor(){super()}Jq(){this.oh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const O=this.SXi(),ca=this.Wt.O1i(O);ca&&(this.ho[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=ca,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(O){wb.a.J(17687510,802,10,"Exception thrown at GetDocumentThemeMethod: "+O)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}Object(h.a)(Sm,"GetDocumentThemeMethod",yc,[]);class im extends yc{constructor(){super()}Jq(){this.oh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let O=null;if(this.Wt&&void 0!==(O=this.Wt.Qrb())&&null!==(O=this.Wt.Qrb())){var ca={};ca[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=O;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=ca;this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}Object(h.a)(im,"GetFilePropertiesMethod",yc,[]);class Tm extends yc{constructor(){super()}Jq(){this.oh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(h.a)(Tm,"GetOfficeThemeMethod",yc,[]);class jm extends yc{constructor(){super()}Jq(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Wt)try{var O=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();O===Microsoft.Office.WebExtension.CoercionType.SlideRange?(O=null,this.oh=({fZk:O}=this.Wt.wbj()).returnValue,this.ho[OSF.DDA.WAC.UniqueArguments.Data]=
O):O===Microsoft.Office.WebExtension.CoercionType.Text?(O=null,this.oh=({Yic:O}=this.Wt.Abj()).returnValue,this.ho[OSF.DDA.WAC.UniqueArguments.Data]=O):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(ca){wb.a.J(8958164,802,10,"Exception thrown at GetSelectedDataMethod: "+ca.toString())}}get description(){return"Get data contained in the current selection of the document."}}Object(h.a)(jm,"GetSelectedDataMethod",yc,[]);class jk extends yc{constructor(){super()}Jq(){var O=
this.aXd();if(O){const ca={};ca.Settings=this.rWd(O.settings);this.ho[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=ca;this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else O="AppForOffice instance could not be found for ID "+this.controlId+ui.Debug.xt(),wb.a.J(8958160,802,10,O),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}rWd(O){const ca={};let Ta=0;for(let xb in O)ca[Ta.toString()]=[xb,O[xb]],Ta++;return ca}}
Object(h.a)(jk,"LoadSettingsMethod",yc,[]);class de extends yc{constructor(){super()}Jq(){m.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.Awb.Hia()?(this.oh=oj.instance.rqa.Hck(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[P.a.NGd],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&m.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",
this.oh.toString())):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(h.a)(de,"MessageParentMethod",yc,[]);class Kj extends yc{constructor(){super()}Jq(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Wt)try{const O=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],ca=O[OSF.DDA.Marshaling.NavigationKeys.GoToType],Ta=O[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.oh=ca===
OSF.DDA.Marshaling.GoToType.Index?this.Wt.yij(Ta):ca===OSF.DDA.Marshaling.GoToType.Slide?this.Wt.zij(Ta):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(O){wb.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+O.toString())}}get description(){return"Go to the slide specified by user."}}Object(h.a)(Kj,"NavigateToMethod",yc,[]);class qg extends yc{constructor(){super();this.vie=0}go(){this.ho={};this.Jq();this.oh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.dH()}Jq(){this.vie=
this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const O=this.xba.V6f(this.vie);O?(qc.ISf(this.qe.presentationId,this.controlId,O.LUd,!1,!1,Object(E.a)(this,this.ZWb,"customizedOnFinished"),Object(E.a)(this,this.YWb,"customizedOnError")).start(),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}ZWb(O,ca){O?0===ca.errorCode?(this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.xba.fNk(this.vie)):
this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.dH()}YWb(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.dH()}get description(){return"Closes the document file."}}Object(h.a)(qg,"ReleaseDocumentCopyMethod",yc,[]);class el extends yc{constructor(){super();this.HFa=null}Jq(){var O=this.aXd();if(O){var ca=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];this.HFa=this.rWd(Array.isArray(ca[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?
ca[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);ca=null;O.taskpane&&(ca=O.taskpane.ownerAddinSolutionId);var Ta;if(O.taskpane&&ca)if(Ta=this.qe.mBa(ca)){this.Wt.lGe(Ta,this.HFa);if(Ta=this.qe.tZ.$Wd(ca))Ta.settings=this.HFa;O.settings=this.HFa;this.qe.kTe(ca,this.HFa);this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.nAc.Ghg(ca,this.HFa,this.Xd)?(O.settings=this.HFa,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
else(Ta=0===O.hy?this.qe.D2f(O.shape.slideId,O.shape.id):this.qe.mBa(O.Zm.id))?(this.Wt.lGe(Ta,this.HFa),O.settings=this.HFa,this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else O="AppForOffice instance could not be found for ID "+this.controlId+ui.Debug.xt(),wb.a.J(9052994,802,10,O),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}rWd(O){const ca={};if(O)for(let Ta=
0;Ta<O.length;Ta++){const xb=Array.isArray(O[Ta])?O[Ta]:null;xb&&1<xb.length&&(ca[xb[0]]=xb[1])}return ca}}Object(h.a)(el,"SaveSettingsMethod",yc,[]);class Cm extends yc{constructor(){super()}Jq(){this.Awb.Hia()?(oj.instance.rqa.OZk(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[P.a.NGd],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}
Object(h.a)(Cm,"SendMessageMethod",yc,[]);class qj extends yc{constructor(){super()}Jq(){this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Wt)try{const ca=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var O=ca.CoerceType.toString();const Ta=ca[OSF.DDA.WAC.UniqueArguments.Data];if(O===Microsoft.Office.WebExtension.CoercionType.Text)this.oh=this.Wt.U4k(Ta);else{let xb;if(O===Microsoft.Office.WebExtension.CoercionType.Image)xb=0;else if(O===Microsoft.Office.WebExtension.CoercionType.XmlSvg)xb=
1;else{this.oh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}O=!1;let Tb=0,wc=0,sd=0,$b=0;({$qj:O,x:Tb,y:wc,width:sd,height:$b}=this.hOi(ca,O,Tb,wc,sd,$b));this.oh=this.Wt.P4k(Ta,O,Tb,wc,sd,$b,xb)}}catch(ca){wb.a.J(17310337,802,10,"Exception thrown at SetSelectedDataMethod: "+ca)}}hOi(O,ca,Ta,xb,Tb,wc){const sd=O[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],$b=O[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==sd&&null!==sd&&"number"===typeof sd&&void 0!==$b&&null!==$b&&"number"===
typeof $b&&(ca=!0,Ta=sd,xb=$b);O[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&(Tb=O[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);O[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(wc=O[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{$qj:ca,x:Ta,y:xb,width:Tb,height:wc}}get description(){return"Writes data to the current selection in the document."}}Object(h.a)(qj,"SetSelectedDataMethod",yc,[]);class ck extends oc{constructor(O){super(O)}vwk(){this.H9b={};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,
()=>new jk);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new el);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new Ff);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new Kj);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new jm);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new im);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new Sm);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new Tm);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,
()=>new qj);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new Cj);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new Zl);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new qg);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new Oc);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new de);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>new Cm);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,
()=>new Af);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new dl);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new od);this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new Yl(this.Xd.yVk,this.Xd.Jzk,this.Xd.s2d))}}Object(h.a)(ck,"EditorMethodFactory",oc,[]);class Lk extends Sys.EventArgs{constructor(O){super();this.Qtd=O}get instanceId(){return this.Qtd}}Object(h.a)(Lk,"FirstPartyAddInHidingEventArgs",Sys.EventArgs,[]);class Rg{constructor(){this.STa=
{};this.Fje={};this.G1c={};this.wZc={}}fAf(O,ca){ca&&O&&(this.STa[O]=ca,this.wZc[O]=!1)}RZh(O,ca){O&&ca&&(this.G1c[O]=ca)}bNk(O){if(O){var ca=this.STa[O];ca&&(delete this.G1c[ca.Zm.id],delete this.STa[O],delete this.Fje[O],delete this.wZc[O])}}sV(O){return O?this.STa[O]:null}d5i(O){return O?this.wZc[O]:!1}mdj(O){return O?this.Fje[O]:null}kBh(O,ca){O&&(this.wZc[O]=ca)}qwl(O,ca){O&&(this.Fje[O]=ca)}$Wd(O){if(!O)return null;const ca=this.STa;for(let Ta in ca){const xb=ca[Ta];if(xb&&xb.Zm.id.toLowerCase()===
O.toLowerCase())return xb}return null}OXi(O,ca,Ta){if(!O||!ca||!Ta)return null;const xb=this.STa;for(let Tb in xb){const wc=xb[Tb];if(wc&&wc.taskpane&&wc.taskpane.ownerAddinSolutionId&&wc.taskpane.ownerAddinSolutionId.toLowerCase()===O.toLowerCase()){const sd=Ta.getOsfControl(wc.instanceId);if(sd&&sd.getSharedRuntimeId()===ca)return wc}}return null}bWd(O){Lh.a.forEach(this.STa,(ca,Ta)=>{ca=Object(D.a)(999,Ta);1===ca.hy&&O(ca)},null)}BQi(O){const ca=this.STa;for(let Ta in ca){const xb=Object(D.a)(999,
ca[Ta]);if(xb&&O(xb))return xb}return null}C2f(O){return O in this.G1c?this.G1c[O]:null}}Object(h.a)(Rg,"OsfAppInstacneCache",null,[]);class mg{constructor(O,ca,Ta,xb,Tb,wc,sd,$b,ge,we,oe,Fe,Gf,Rh,Sh,Wa,Lg,gg,ub,nk,Tj,Fj,so,tn,Ll){this.oyb=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.gb&&A.AFrameworkApplication.Aa.gb.UV;this.TVb=!1;this.Bwb=this.zEa=this.kde=this.Vzf=null;this.va=new C.a;this.pIg=!1;this.Op=O;this.xI=ca;this.sme=new ck(this);this.pWc=new bc(this,nk);this.DTa=Tj;this.kTa=
xb;this.jDg={};this.jF=new Rg;this.hZj=Ta;this.Owb=Tb.value;this.Cz=sd;this.Mb=wc;this.KW=$b;this.Nb=ge;this.XYj=Lg;this.A9a=we;this.$b=oe;this.ni=Fe;this.ta=Gf;this.Ea=Rh;this.rc=Sh;this.yc=Wa;this.u6b=ub;this.y9a=new fj;this.UYj=gg;this.ql=Fj;this.$$b=so;this.G$b=tn;this.q5j=Ll}initialize(){this.Y4(this.Nb.mode);this.Nb.vM(Object(E.a)(this,this.shg,"handleModeSwitch"))}dispose(){this.Nb.rX(Object(E.a)(this,this.shg,"handleModeSwitch"))}get nAc(){this.y9a||(this.y9a=new fj);return this.y9a}get yn(){if(!mg.Isa){this.Op&&
(this.Op.kd.$Bj&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new nd),this.$b.ka("305")&&OfficeExt.PrivateCatalogService.initRequestHandler(new nd,new jf(this.Op.kd.vg?A.AFrameworkApplication.fa.appSettings.AuthProxyHandlerWebServiceBase:A.AFrameworkApplication.fa.appSettings.WebServiceBase),this.$b.ka("306")),OfficeExt.MosRequestHandler.init(new nd),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new nd));const O=new jc(this.sme,
this.pWc);this.Bwb=this.GE.uvi(this.jF);mg.Isa=this.hZj.fwi(this.xI,O,this.Bwb);mg.Isa.setOAuthManager(this.q5j);mg.Isa&&"undefined"!==typeof mg.Isa.hostCheckReadyHandler&&A.AFrameworkApplication.a3h(Object(E.a)(mg.Isa,mg.Isa.hostCheckReadyHandler,"hostCheckReadyHandler"))}return mg.Isa}IAh(O){(O=this.yn.getOsfControl(O))&&this.Bwb&&this.Bwb.tXg(O)}Yvb(O,ca,Ta){this.Bwb?this.Bwb.DRj(O,ca,Ta):m.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}egb(O,ca,Ta=null){const xb=this.GE.N1(O);
if(this.$b.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.mpb(xb.storeType)))this.ql.Yba(22)||this.ql.OAa(22);else if(0===xb.hy)this.kTa.XBj(xb.id)?(Ta=this.kTa.vpa[xb.id],Ye.a("Microsoft.Office.SharedOnline.FixBug6808089")?this.kTa.XHa(xb.id,this.vKe(O),ca):(Ta.NHe(ca),this.kTa.XHa(xb.id,this.vKe(O),null))):(O=this.cLe(O,ca),O.NHe(ca),this.kTa.cXk(xb.id,O));else if(1===xb.hy){const Tb=xb.node.sa($e.a.HY,null);this.bsa(xb.id)?xb.Lqg||this.NFb(Tb,!0):this.cLe(O,ca,Ta);this.Op.kd.Rra&&!xb.ownerAddinSolutionId&&
(ca=this.t1d(xb.Wla),this.kTe(xb.Wla,ca.settings))}}launchInsertDialog(){this.va.raiseEvent("OnInsertionDialogOpened");this.zEa=new Vi;this.zEa.pj("",null,null);this.yn.launchInsertDialog(this.zEa.C4a)}LRj(O){this.va.raiseEvent("OnInsertionDialogOpened");this.zEa=new Vi;this.zEa.pj("",null,null);if(O){const ca={navigationMode:0};ca.assetId=O;this.yn.launchInsertDialog(this.zEa.C4a,"{98143890-AC66-440E-A448-ED8771A02D52}",ca)}else this.yn.launchInsertDialog(this.zEa.C4a)}Njg(){this.zEa&&this.zEa.hide()}teb(O){const ca=
this.d3f(O);ca?this.Jdh(ca):m.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",O))}Jdh(O){const ca=this.GE.N1(O);if(this.$b.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.mpb(ca.storeType)))this.ql.Yba(22)||this.ql.OAa(22);else{var Ta=(xb,Tb)=>{const wc=this.GE.N1(xb),sd=this.GE.zEc(A.AFrameworkApplication.isRtl,wc.id,wc.width,wc.visibility);Tb.uM(sd);this.oyb||sd.Yo(wc.visibility);let $b=Tb=null;this.Op.kd.Rra&&this.Op.kd.uOj&&($b=this.Ibd(O),
Tb=()=>{this.bK(sd,!0,!1);this.LIb($b)});this.egb(xb,sd.mAc,Tb);this.oyb&&($b&&(xb=this.fZ($b.Zm.id).Oga,sd.e6k(xb)),sd.Yo(wc.visibility))};if(this.Op.kd.Rra){const xb=this.GE.N1(O),Tb={};this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?(Tb.solutionId=xb.Wla,Tb.version=xb.version):(Tb.marketplaceId=xb.Wla,Tb.marketplaceVersion=xb.version);Tb.storeType=this.mpb(xb.storeType);Tb.storeId=xb.store;Tb.targetData=O;this.yn.isAddinCommandsAsync(Tb,(wc,sd)=>{const $b=
this.Ibd(O);var ge=O.sa(Fb.a.isForUILessAction,!1);const we=O.sa(Fb.a.sharedRuntimeId,null),oe=xb.ownerAddinSolutionId,Fe=!!$b.Hu&&0<$b.Hu.state&&!!$b.Hu.uma;if(!sd&&xb.visibility||sd&&oe&&!Fe||ge&&!ja.a.Va(we))Ta(O,this.Cz),this.tZ.kBh(xb.id,sd);else if(sd){if(ge=this.gZb(xb.Wla))$b.settings=ge.settings,this.Wt.lGe(O,$b.settings);this.tZ.fAf($b.instanceId,$b);this.tZ.kBh($b.instanceId,sd);this.kTe($b.Zm.id,$b.settings);if(xb.visibility&&this.A9a.installVisibleAddinCommandsEnabled||Fe){if("omex"!==
Tb.storeType.toLowerCase()&&!Fe)return;let Gf=!1;this.IAe(Rh=>{if(!Rh[P.a.n6h]){if(Rh[P.a.mDf])for(const Sh of Rh[P.a.mDf])if(Gf=Oe.e(Sh[1])===Oe.e(xb.Wla))break;Gf||this.Nyc($b)}})}}wc||wb.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",xb.Wla,this.mpb(xb.storeType))})}else Ta(O,this.Cz)}}OZb(O){return O&&O.assetId?O.sourceLocationOverrideResourceId?String.format("{0}.{1}",O.assetId,O.sourceLocationOverrideResourceId):O.assetId:null}kRk(O){const ca=this.Jdi(O),Ta=this.GE.N1(ca);
if(A.AFrameworkApplication.x$d(Ta.Wla)){const xb=this.GE.zEc(A.AFrameworkApplication.isRtl,Ta.id,Ta.width,Ta.visibility,O);this.Cz.uM(xb);xb.Yo(Ta.visibility);this.cLe(ca,xb.mAc,null,O)}}IAe(O){const ca={};ca.callback=O;A.AFrameworkApplication.Ta.Ka(Vd.a.GWa,2,ca)}Nyc(O){const ca=this.GE.zEc(A.AFrameworkApplication.isRtl,O.instanceId,O.taskpane.width,O.taskpane.visibility);this.Cz.uM(ca);ca.Yo(O.taskpane.visibility);const Ta=ca.mAc;Object(D.a)(998,this.GE.rOd(this.Op.kd,O,Ta,A.AFrameworkApplication.isRtl,
this)).Nyc(this.yn,Ta,()=>{this.LIb(O);this.bK(ca,!1,!!O.Hu&&!!O.Hu.uma);w.a.instance.setItem(P.a.KGd,"true")})}bK(O,ca,Ta){O.Yo(!1);Ta||(mg.Isa.purgeOsfControl(O.id,!1),ca?this.Op.mK().Ka(Eh.a.fPc,2,O.id):this.pWc.lNf(O.id),O.dispose())}LIb(O){var ca={};ca.solutionId=O.Zm.id;ca.version=O.Zm.version;ca.storeType=O.Zm.storeType;ca.storeId=O.Zm.store;this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?(ca.assetId=null,ca.assetStoreId=null):(ca.assetId=O.Zm.id,ca.assetStoreId=
O.Zm.storeType);ca.sharedRuntimeId=O.Hu?O.Hu.uma:null;ca.backgroundState=O.Hu?O.Hu.state:-1;O=new e.a;O.add(ca);ca={};ca[P.a.Uzc]=O;ca[P.a.u6]=3;this.Op.mK().Ka(Vd.a.ZUc,2,ca)}tKc(){const O=this.KW.yf;var ca=null;O&&(ca=new ti.GraphIterator,ca.set(O),ca=ca.zb(18));return ca}fZ(O){return O?(O=this.jF.$Wd(O))&&O.taskpane?O:null:null}JRi(O,ca,Ta,xb){if(!O||!ca||!Ta)return null;O=this.getSharedRuntimeId(ca,xb,O.solutionId,Ta);return(Ta=this.jF.OXi(Ta,O,this.yn))&&Ta.taskpane?Ta:null}qVd(O){return O?(O=
this.jF.sV(O))&&O.taskpane?O:null:null}mBa(O){if(!O)return null;var ca=this.tKc();if(ca&&(ca=this.Mb.Kc(ca))&&ca.zb(19)){do{const Ta=ca.currentNode;if(this.yTb(Ta.sa(Ce.a.jnb,null),O))return Ta}while(ca.wj(19))}return null}d3f(O){if(!O)return null;var ca=this.tKc();if(ca&&(ca=this.Mb.Kc(ca))&&ca.zb(19)){do{const Ta=ca.currentNode;if(this.yTb(Ta.sa($e.a.HY,null),O))return Ta}while(ca.wj(19))}return null}D2f(O,ca){return(O=this.yc.$k(O))?O.oS(ca):null}uBj(O){return O?this.jF.d5i(O):!1}jdi(O,ca,Ta,xb,
Tb){if(!O||!O)return null;let wc;if(!(O.solutionId&&O.version&&O.storeId&&O.storeType))return m.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;wc=Object(D.a)(Kh.a,this.Owb.createInstance(1074135137));wc.setValue(Ce.a.jnb,O.solutionId);wc.setValue(Ce.a.vAc,O.version);wc.setValue(Ce.a.uAc,O.storeId);wc.setValue($e.a.hTb,this.kEc(O.storeType));wc.setValue(Ce.a.qAc,!1);wc.setValue($e.a.HY,yg.a.create().toString());wc.setValue(Ce.a.xHd,"right");wc.setValue(Ce.a.kTb,Ta);Tb&&wc.setValue(Fb.a.isForUILessAction,
Tb);xb&&(wc.setValue($e.a.h2g,xb),(O=this.getSharedRuntimeId(ca,Tb,O.solutionId,xb))&&wc.setValue(Fb.a.sharedRuntimeId,O));return wc}bXd(O){O=this.mBa(O);return this.Ibd(O)}idi(O,ca){if(!(O&&O&&O.solutionId&&O.version&&O.storeId&&O.storeType))return null;O=new Wi(O.solutionId,O.version,O.storeId,O.storeType);ca=ca?new Rd(0,ca):null;return new Bj(O,null,null,null,{},1,ca)}MRd(O){hf.AppsForOfficeSingleSignOnManager.lki(O);const ca=this.jF.sV(O);ca&&(mg.Isa.purgeOsfControl(ca.instanceId,!1),this.pWc.lNf(ca.instanceId),
this.jF.bNk(ca.instanceId),this.kTa.Gbh(ca.instanceId),this.DTa.Dhc(this.presentationId,O,!1,!0))}notifyAgave(O,ca){this.yn.notifyAgave(O,ca)}hKk(O){!this.pIg&&O.yk&&(O=O.yk,O.Bd(47).t6(Object(E.a)(this,this.pEf,"appDisposeHandler")),O.Bd(10).t6(Object(E.a)(this,this.pEf,"appDisposeHandler")),this.pIg=!0)}pEf(O,ca){O=ca.node;ca=1074135137===O.Oe;if(O.sa($e.a.Nq,!1)||ca)O=this.GE.N1(O),this.MRd(O.id)}Jdi(O){const ca=Object(D.a)(9,this.Owb.createInstance(1074135137));ca.setValue(Ce.a.vAc,"1.0.0.0");
ca.setValue(Ce.a.uAc,"en-US");ca.setValue($e.a.HY,yg.a.create().toString());ca.setValue(Ce.a.kTb,!0);this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?(ca.setValue($e.a.jAc,null),ca.setValue($e.a.kAc,null)):ca.setValue($e.a.jAc,O.assetId);ca.setValue(Ce.a.jnb,this.OZb(O));O.Anc?(ca.setValue(Ce.a.iTb,"sdxcatalog"),this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)||ca.setValue($e.a.kAc,"sdxcatalog"),ca.setValue($e.a.hTb,this.kEc("sdxcatalog"))):
(ca.setValue(Ce.a.iTb,"firstparty"),this.$b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)||ca.setValue($e.a.kAc,"firstparty"),ca.setValue($e.a.hTb,this.kEc("firstparty")));ca.setValue($e.a.isAddinCommands,!1);ca.setValue(Ce.a.qAc,!1);ca.setValue(Ce.a.xHd,"right");return ca}Ibd(O,ca=null){if(!O)return null;O=this.GE.N1(O);const Ta=this.mpb(O.storeType),xb=new Wi(O.Wla,O.version,O.store,Ta);let Tb=null,wc=null;if(0===O.hy)Tb=new yh(O.shapeId,O.slideId);else if(1===
O.hy)wc=new Rj(O.BXf,O.visibility,O.width,O.row,O.ownerAddinSolutionId,O.ownerAddinStoreType,O.Lqg);else return null;let sd={};ca&&OSF.OsfControl.isFirstPartyStoreString(Ta)?sd=OSF.OUtil.serializeSettings(ca.nonPersistedSettings):O.ownerAddinSolutionId||(sd=O.settings);ca=O.d3a?new Rd(O.Gnb,O.d3a):null;return new Bj(xb,O.id,Tb,wc,sd,O.hy,ca)}Kah(O,ca=null){if(this.$b.ka("883")){var Ta=this.yn.getOsfControl(O);if(Ta&&ca){ca.nonPersistedSettings&&Ta.setSettings(OSF.OUtil.serializeSettings(ca.nonPersistedSettings));
if(ca.fU){const xb=Object(D.a)(999,this.qVd(O));xb&&(xb.Oga=ca.fU,this.oyb&&this.NFb(O,!0))}Ta.refresh();this.IAh(O)}}}cLe(O,ca,Ta=null,xb=null){const Tb=this.Ibd(O,xb);if(!Tb||OSF.OsfControl.isFirstPartyStoreString(Tb.Zm.storeType)&&!A.AFrameworkApplication.x$d(Tb.Zm.id))return null;var wc=this.GE.N1(O);if(this.$b.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.mpb(wc.storeType)))return this.ql.Yba(22)||this.ql.OAa(22),null;xb&&xb.fU&&(Tb.Oga=xb.fU);wc=Object(D.a)(998,this.GE.rOd(this.Op.kd,
Tb,ca,A.AFrameworkApplication.isRtl,this));this.jF.fAf(Tb.instanceId,Tb);this.jF.RZh(Tb.Zm.id,ca);xb&&xb.cva&&xb.cva();this.Op.kd.Rra&&Tb.taskpane&&Tb.taskpane.ownerAddinSolutionId&&(ca=this.jF.$Wd(Tb.taskpane.ownerAddinSolutionId))&&this.sAh(ca.instanceId,Tb.instanceId);wc.Dal(this.yn,this.vKe(O),Ta,xb,this.A9a.powerPointDragInsertImageIsEnabled);Tb.taskpane&&Tb.taskpane.ownerAddinSolutionId||this.hKk(O);return wc}cvh(O){if(this.A9a.lPj){const Ta=this.tZ.sV(O);if(Ta&&0===Ta.hy&&Ta.shape){var ca=
this.tZ.mdj(O);const xb=new Date;!ca||xb.getTime()-ca.getTime()>=this.A9a.pptEditorAppForOfficeSnapshotIntervalTime?(m.ULS.sendTraceTag(512508173,806,50,"Start to generate addin [{0}] {1} snapshot",Ta.Zm.id,O),(ca=this.XYj.eRf(1,O))?(this.tZ.qwl(O,xb),ca.execute(this,this.UYj,null)):m.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",Ta?Ta.Zm.id:"AppNotExist",O)):m.ULS.sendTraceTag(512508171,806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",
Ta?Ta.Zm.id:"AppNotExist",O)}}}xZg(O,ca,Ta,xb){1===O&&this.Zok(ca,Ta,xb)}Zok(O,ca,Ta){let xb=null;Ta&&Ta.result&&(Ta=Ta.result,xb=Ta.substr(Ta.indexOf("base64,")+7));const Tb=this.tZ.sV(O);ca===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&xb&&0<xb.length&&Tb?0===Tb.hy&&Tb.shape&&Tb.Zm&&this.ni.HAh(Tb.shape.slideId.toString(),Tb.shape.id,xb,()=>{m.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",Tb.Zm.id,O,xb.length)},()=>{m.ULS.sendTraceTag(512508169,806,
10,"Update addin [{0}] {1} snapshot failed",Tb.Zm.id,O);return!1}):m.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",Tb?Tb.Zm.id:"AppNotExist",O,xb?xb.length:0)}gZb(O){return O?this.jDg[O]:null}lzc(O,ca){O&&ca&&(this.jDg[O]=ca)}get Wt(){this.kde||(this.kde=new xh(this.Op.kd,mc.a.instance.resolve("Common.IAppSettingsManager"),this.xI,mc.a.instance.Be("Box4.IOutlineEditor"),mc.a.instance.Be("Box4.ISelectionManager"),mc.a.instance.Be("Box4.ICharacterPropertiesEditor"),
mc.a.instance.Be("PowerPointWebEditor.IClassFactory"),mc.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.Op.mK(),mc.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),mc.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),mc.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),mc.a.instance.resolve("PowerPointWebEditor.ISlideReader"),mc.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),mc.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),
mc.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),mc.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),mc.a.instance.resolve("PowerPointWebEditor.IShapeReader"),mc.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),mc.a.instance.resolve("Box4.IOutlineElementNavigator"),mc.a.instance.resolve("Box4.IParagraphReader"),mc.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),mc.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));return this.kde}get xba(){return this.DTa}OWa(O,
ca,Ta){this.pWc.ZWd(O).raiseEvent(Ta,ca)}y9g(O,ca){this.jF.bWd(Ta=>{this.OWa(O,Ta.instanceId,ca)})}sAh(O,ca){if(O&&ca){O=this.tZ.sV(O);var Ta=this.tZ.sV(ca);O&&Ta&&(Ta.settings=O.settings,this.CZg(ca,O.settings))}}kTe(O,ca){O&&ca&&this.tZ.bWd(Ta=>{this.yTb(Ta.taskpane.ownerAddinSolutionId,O)&&!this.nAc.YBj(Ta.settings,ca)&&(Ta.settings=ca,this.CZg(Ta.instanceId,ca))})}shg(O){this.Y4(O.mode)}Y4(O){if(1!==O&&2!==O)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",
O));m.ULS.sendTraceTag(512508167,806,50,"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===O?"Show":"Edit");this.kTa.Y4(O);this.Cz.Y4(O)}CZg(O,ca){const Ta=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.OWa(Ta,O,ca)}mpb(O){switch(O){case 0:O="spcatalog";break;case 1:O="filesystem";break;case 2:O="omex";break;case 3:O="spapp";break;case 4:O="registry";break;case 5:O="inmemory";break;case 6:O="uploadfiledevcatalog";break;case 7:O="excatalog";
break;case 8:O="firstparty";break;case 9:O="sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",O));}return O}kEc(O){if(!O)throw Error.create("Store Type should not be null.");mg.G4||mg.twj();if(O in mg.G4)return mg.G4[O];throw Error.create(String.format("[{0}] is not the valid store type.",O));}t1d(O){return O?this.jF.BQi(ca=>this.yTb(ca.Zm.id,O)):null}get BHd(){return this.Op}Z3h(O){this.va.addHandler("OnInsertionDialogOpened",O)}rGd(O){this.va.addHandler("OnFirstPartyAddInHidden",
O)}CPk(O){this.va.removeHandler("OnFirstPartyAddInHidden",O)}FEk(O){this.va.raiseEvent("OnFirstPartyAddInHidden",new Lk(O))}vMd(O){const ca=Xh.a.pna(this.Cz.r1,Ta=>Ta.id===O);if(1!==ca.length)return!1;this.bK(ca[0],!0,this.bsa(O));return!0}NFb(O,ca){const Ta=Xh.a.pna(this.Cz.r1,xb=>xb.id===O);1!==Ta.length?wb.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",Ta.length):Ta[0].Yo(ca)}$Wi(O){const ca=Xh.a.pna(this.Cz.r1,Ta=>Ta.id===O);return 1!==ca.length?(wb.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",
ca.length),!1):ca[0].isVisible}Nql(O,ca){const Ta=this.gZb(O);Ta&&Ta.Hu&&Ta.Hu.uma&&(Ta.Hu.state=ca?1:0,(this.mBa(O)||this.nAc.Ghg(O,Ta.settings,this))&&this.Op.mK().Ka(Eh.a.wAh,2,Ta))}aXi(O){return(O=this.gZb(O))&&O.Hu?1===O.Hu.state:!1}ZNf(O){this.tZ.bWd(ca=>{this.yTb(ca.taskpane.ownerAddinSolutionId,O)&&this.vMd(ca.instanceId)})}xrb(O){return this.jF.sV(O)}bsa(O){if(!O||4===this.yn.getOsfControlStatus(O))return!1;O=this.yn.getOsfControl(O);return!!O&&!!O.getSharedRuntimeId()}setInitialDisplayMode(O,
ca){(O=this.yn.getOsfControl(O))&&O.setInitialDisplayMode(ca)}getSharedRuntimeId(O,ca,Ta,xb){if(!O)return null;const Tb=new tg;if(!Tb)return null;if(ca)return O.getSharedRuntimeId(Tb.rS,ca,null);Ta=(new gb("",xb,Tb,!0)).bUf(Ta.substr(xb.length));return O.getSharedRuntimeId(Tb.rS,ca,Ta)}dSi(O,ca){const Ta={};Ta.visibility=ca?"Visible":"Hidden";ca=JSON.stringify(Ta);this.s3f(O,65539,"",ca)}fSi(O,ca,Ta){this.s3f(O,1,ca,Ta)}ldl(O,ca){O=new Wi(O.solutionId,O.version,O.storeId,O.storeType);var Ta=new Rj("right",
!0,350,0,null,null,!1);O=new Bj(O,$f.a.create().toString(),null,Ta,{},1,null);const xb=this.GE.zEc(A.AFrameworkApplication.isRtl,O.instanceId,O.taskpane.width,O.taskpane.visibility);this.Cz.uM(xb);xb.Yo(O.taskpane.visibility);Ta=xb.mAc;Object(D.a)(998,this.GE.rOd(this.Op.kd,O,Ta,A.AFrameworkApplication.isRtl,this)).Nyc(this.yn,Ta,()=>{this.bK(xb,!1,!1);ca()})}s3f(O,ca,Ta,xb){var Tb=Array(6);Tb[0]=65536;Tb[1]=ca;Tb[2]=Ta;Tb[3]=xb;Tb[4]=-1;Tb[5]=!1;ca=Array(1);ca[0]=Tb;Tb=new Ci(OSF.DDA.EventDispId.dispidRichApiMessageEvent,
O,null,ca);this.OWa(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),O,Tb)}yTb(O,ca){return O&&ca?O.toLowerCase()===ca.toLowerCase():!1}vKe(O){return!this.Nb||1!==this.Nb.mode||O&&"FA000000012"===O.sa($e.a.jAc,null)?1===this.GE.N1(O).hy?!0:this.Ea.uDa(O)?this.ta.Ba===this.rc.Sg(O):!1:!1}get presentationId(){return this.Op.kQa().presentationId}get YPf(){return this.kTa}get tZ(){return this.jF}get GE(){return this.u6b.value}get yVk(){return this.$$b}get Jzk(){return this.G$b}get s2d(){return this.ta}static twj(){mg.G4=
{};mg.G4.inmemory=5;mg.G4.uploadfiledevcatalog=6;mg.G4.spcatalog=0;mg.G4.omex=2;mg.G4.registry=4;mg.G4.spapp=3;mg.G4.filesystem=1;mg.G4.excatalog=7;mg.G4.firstparty=8;mg.G4.sdxcatalog=9}}mg.G4=null;mg.Isa=null;Object(h.a)(mg,"AppForOfficeManager",null,[1E3,106,711]);class Dj{constructor(O,ca,Ta){this.JS=O;this.RGg=ca;this.Mb=Ta}register(){this.RGg.xk(Object(E.a)(this,this.yEf,"appSettingChangedEventHandler"))}dispose(){this.RGg.Tm(Object(E.a)(this,this.yEf,"appSettingChangedEventHandler"))}yEf(O,
ca){O=ca.node;ca=ca.property;try{if(1074135139===O.Oe&&ca===Ce.a.tAc){ca=null;var Ta=this.Mb.Kc(O);Ta.mc(47)||Ta.mc(10);Ta.uc();this.T7d(Ta.currentNode)&&(ca=new bg.a(Ta.currentNode));var xb=ca.settings;Ye.a("RefreshAppSettingsValue")&&(this.JS.xrb(ca.id).settings=xb);this.JS.OWa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),ca.id,xb)}}catch(Tb){m.ULS.sendTraceTag(18442307,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",Tb)}}T7d(O){if(!O)return!1;const ca=Object(D.a)(4,
O);return 1074135137===O.Oe||!!ca&&ca.Nq}}Object(h.a)(Dj,"AppForOfficeSettingChangedEventListener",null,[997,106]);class kk{constructor(O,ca,Ta){this.JS=O;this.BCg=ca;this.Mb=Ta}register(){for(const O of this.BCg)O.$F(Object(E.a)(this,this.zEf,"appSettingCreatedEventHandler"))}dispose(){for(const O of this.BCg)O.iO(Object(E.a)(this,this.zEf,"appSettingCreatedEventHandler"))}zEf(O,ca){O=ca.node;try{if(this.T7d(O)&&21===ca.PY){this.Mb.Kc(O).Z0b()||m.ULS.sendTraceTag(20821900,802,15,"Got OnChildTopologyChanged event but no child found.");
const Ta=new bg.a(O),xb=Ta.settings;this.JS.OWa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),Ta.id,xb)}}catch(Ta){m.ULS.sendTraceTag(20821901,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",Ta)}}T7d(O){if(!O)return!1;const ca=Object(D.a)(4,O);return 1074135137===O.Oe||!!ca&&ca.Nq}}Object(h.a)(kk,"AppForOfficeSettingCreatedEventListener",null,[997,106]);class qn{constructor(O,ca){this.ia=O;this.Tw=ca}register(){this.Tw.xk(Object(E.a)(this,this.mvh,"taskpaneAppCreatedEventHandler"))}dispose(){this.Tw.Tm(Object(E.a)(this,
this.mvh,"taskpaneAppCreatedEventHandler"))}mvh(O,ca){if(O=ca.node)O=new bg.a(O),ca.property.id===$e.a.HY.id&&1===O.hy&&(ca=ca.node.sa($e.a.HY,null))&&this.ia.Ka(Eh.a.teb,2,ca)}}Object(h.a)(qn,"AppForOfficeTaskpaneAppCreatedEventListener",null,[997,106]);var yk=d(634),rn=d(521),nl=d(875);class lk{constructor(O,ca,Ta,xb,Tb){this.oyb=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.gb&&A.AFrameworkApplication.Aa.gb.UV;this.JS=O;this.Op=ca;this.Nb=Ta;this.jF=xb;this.Cz=Tb}register(O){O.controlStatusChanged=
Object(E.a)(this,this.tXg,"onControlStatusChanged");O.notifyHost=Object(E.a)(this,this.DZg,"onOsfNotifyHost")}tXg(O){let ca=this.jF.C2f(O.getSolutionId());const Ta=this.jF.sV(O.getID());Ta&&Ta.Zm&&O.isFirstParty()&&(ca=this.jF.C2f(Ta.Zm.id));if(ca&&Ta&&ca.previousSibling){var xb=O.getSolutionId(),Tb=O.getVersion(),wc=null,sd=null;sd=O.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(xb,""):OSF.OsfManifestManager.getCachedManifest(xb,Tb);O.isFirstParty()&&Ta.Oga?wc=Ta.Oga:sd&&(wc=sd.getDefaultDisplayName(),
Ta.Oga=wc);if(0!==Ta.hy){if(Ye.a("TaskpaneIconUrlPassing")&&this.oyb){Tb=null;sd&&(Tb=sd.getDefaultIconUrl());sd=null;Ye.a("UpdateTaskpaneWithInstanceId")&&(sd=Object.assign(new nl.a,{getContent:()=>ca,type:"LegacyTaskPaneProps"}));const $b=Object.assign(new yk.a,{title:wc,hideHeader:Ye.a("UpdateTaskpaneWithInstanceId"),iconUrl:Tb,width:320,location:2,contentProps:sd,onOpen:()=>{},onClose:()=>{},isModernPane:!0});mb.UISurfaces.Cs().then(ge=>{if(Ye.a("UpdateTaskpaneWithInstanceId")){const we=O.getID();
ge.updateTaskPane(we,$b)}else ge.updateTaskPane(xb,$b);return null}).catch(()=>{wb.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",xb)})}ca.previousSibling&&(ca.previousSibling.innerText===wc||!O.isFirstParty()&&""!==ca.previousSibling.innerText)||!wc||!Ta.taskpane||Ta.taskpane.isForUILessAction||(ca.previousSibling.innerText=wc,this.Nb.BQa())}}}DRj(O,ca,Ta){this.DZg(O,ca,Ta)}DZg(O,ca,Ta){3===ca?(this.JS.Njg(),this.Cz.Bf(ih.a.dE),Ta?this.Op.mK().Ka(Eh.a.kQc,2,Ta):m.ULS.sendTraceTag(512360769,
806,10,"InsertAgave: should have valid insert agave parameters")):36===ca?Ta?this.Op.mK().Ka(Eh.a.kQc,2,Ta):m.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):37===ca?Ta&&(O=Object(D.a)(Object,Ta),O={["ak1"]:this.JS.yn.getDevManifestInvalidUrlErrorString(O.manifestUrl)},this.Op.mK().Ka(Vd.a.YGb,2,O)):2===ca?this.JS.Njg():9===ca?this.Op.kd.Rra&&this.Op.kd.Iqg&&this.Op.mK().Ka(Vd.a.HCe,2,Ta):5===ca||6===ca?(Ta=this.jF.sV(O))?0===Ta.hy?this.Cz.MQe(ca):
this.Cz.yTi(O,ca):m.ULS.sendTraceTag(512360738,806,10,String.format("Failed to find the cached app with instance Id: {0}",O)):13===ca||14===ca?(Ta=this.jF.sV(O))?0===Ta.hy||Ta.taskpane&&Ta.taskpane.isForUILessAction?this.JS.notifyAgave(O,13===ca?11:12):(Bh.a.$f&&document.activeElement.blur(),this.oyb&&13===ca?fg.FocusManager.instance().UIe(ih.a.rO):this.Cz.k4f(O)):m.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",O)):16===ca?(ca=this.jF.sV(O))?
0===ca.hy&&this.Cz.G0f():m.ULS.sendTraceTag(512360736,806,10,String.format("Failed to find the cached app with instance Id: {0}",O)):17===ca||18===ca?(ca=this.jF.sV(O))?0===ca.hy?this.Cz.G0f():(Bh.a.$f&&document.activeElement.blur(),this.Cz.k4f(O)):m.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",O)):1===ca||10===ca?(ca=this.jF.sV(O))?0===ca.hy&&this.JS.cvh(O):m.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",
O)):8===ca?(O={["ak1"]:this.JS.yn.getManifestInvaildErrorString()},this.Op.mK().Ka(Vd.a.YGb,2,O)):15===ca?(O=this.Cz.Zpl(O))&&(ca=this.JS.xrb(O))&&ca.taskpane&&!ca.taskpane.isForUILessAction&&this.JS.notifyAgave(O,11):23===ca?aa.a.sendOtelEvent(Object.assign(new rn.a,{otelEvent:Ta})):38===ca?aa.a.sendOtelCustomerContent(Object.assign(new rn.a,{otelEvent:Ta})):32===ca?(O=Object(D.a)(Object,Ta).solutionId,this.JS.ZNf(O)):34===ca&&(O=Object(D.a)(Object,Ta),ca=O.controlId,Ta=new gb("",O.ownerAddinSolutionId,
new tg,!0),O.originalControlId=Ta?Ta.bUf(ca):ca)}}Object(h.a)(lk,"AppForOfficeAppEventHandler",null,[1017]);var Xi=d(247),Al=d(1176);class Yi{static E0h(O){var ca=O.getAttribute("style");ca=ca?ca.toString():"";0>ca.indexOf("pointer-events: auto")&&O.className!==Yi.hFb&&(Ye.a("Microsoft.Office.SharedOnline.FixBug6808089")?O.style.pointerEvents="auto":O.setAttribute("style",ca+" pointer-events: auto"))}static pBf(O){var ca=O.getAttribute("style");ca=ca?ca.toString():"";0>ca.indexOf("pointer-events: none")&&
O.className===Yi.hFb&&(Ye.a("Microsoft.Office.SharedOnline.FixBug6808089")?O.style.pointerEvents="none":O.setAttribute("style",ca+" pointer-events: none"))}static iOk(O){var ca=O.getAttribute("style");ca=ca?ca.toString():"";0<=ca.indexOf("pointer-events: none")&&O.className===Yi.hFb&&(Ye.a("Microsoft.Office.SharedOnline.FixBug6808089")?O.style.pointerEvents="":(ca=ca.replace("pointer-events: none",""),O.setAttribute("style",ca)))}}Yi.jWk="AppForOfficeContainer EditAppForOfficeContainer";Yi.hFb="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";
Yi.UFe="";Object(h.a)(Yi,"AppForOfficeViewHelper",null,[]);var mk=d(960),km=d(140);class zk{constructor(O,ca,Ta,xb,Tb){this.Dz=this.hCg=null;this.tzb=!1;this.BA=ca;this.Wh=Ta;ca&&ca.taskpane&&ca.taskpane.isForUILessAction?(this.Dz=null,this.hCg=Ta):(this.Dz=new km.a,this.Dz.ee.className=Yi.hFb,this.Dz.ee.id="AppForOffice_"+this.BA.instanceId,this.Dz.ee.style.width="100%",this.Dz.ee.style.height="100%",this.Dz.ee.style.position="relative",this.Dz.ee.style.left="0",this.Dz.ee.style.top="0",Ta.appendChild(this.Dz.ee));
this.Xd=Tb}dispose(){this.cNk();this.BA=null}cNk(){this.Dz&&this.Dz.iq()}NHe(O){O&&this.Dz&&O!==this.Wh&&(this.Wh=O,O.appendChild(this.Dz.ee),this.tzb&&this.Sba())}Xza(O){O&&(O.ee.innerHTML="")}Dal(O,ca,Ta=null,xb=null,Tb=!1){this.OYh(O,ca,Ta,xb,Tb)}Nyc(O,ca,Ta){ca=this.Efc(ca);O.insertBlankControlWithErrorUX(ca,()=>{Ta()})}OYh(O,ca,Ta=null,xb=null,Tb=!1){this.tzb=Tb;this.Xza(this.Dz);this.BA&&O&&(this.XHa(ca,null),ca=this.Efc(this.Dz?this.Dz.ee:this.hCg,xb,O),ca.virtualOsfControlActivationCallback=
Ta,O.insertOsfControl(ca),O.setActivationCompletedStatus(this.BA.instanceId,!0),Tb&&this.Sba())}Sba(){if(this.Dz){var O=this.Dz.ya;if(O){var ca=O.parentNode;ca&&"OsfAddinOverlay"!==ca.className&&(Xi.a.instance.ob(zf.a.ela,ca,Object(E.a)(this,this.kch,"removePointerEventsStyleHandler")),Al.a.instance.ob(zf.a.drop,ca,Object(E.a)(this,this.kch,"removePointerEventsStyleHandler")),Xi.a.instance.ob(zf.a.fla,ca,Object(E.a)(this,this.F0h,"addPointerEventsStyleHandler")),Yi.pBf(O))}}}kch(O){O=O.lc.target;
for(let ca=0;ca<O.childNodes.length;++ca)Yi.iOk(O.childNodes[ca]);return!0}F0h(O){O=O.lc.target;for(let ca=0;ca<O.childNodes.length;++ca)Yi.pBf(O.childNodes[ca]);return!0}XHa(O,ca){this.Dz&&(O?(null!=ca&&this.NHe(ca),this.Dz.ee.className=""===Yi.UFe?Yi.jWk:Yi.UFe,Yi.E0h(this.Dz.ya)):(this.Dz.ee.className!==Yi.hFb&&(Yi.UFe=this.Dz.ee.className),this.Dz.ee.className=Yi.hFb))}OHe(O){this.Dz&&(this.Dz.ee.style.zIndex=String(O))}Efc(O,ca=null,Ta=null){const xb={};xb.div=O;xb.id=this.BA.instanceId;O=this.BA.Zm.id;
const Tb=this.BA.taskpane?this.BA.taskpane.ownerAddinSolutionId:null;if(Ta&&Tb){const wc=this.BA.taskpane.isForUILessAction;this.BA.Hu?xb.sharedRuntimeId=this.BA.Hu.uma:(Ta=Ta.getOsfControl(Tb).getManifest(),xb.sharedRuntimeId=this.Xd.getSharedRuntimeId(Ta,wc,O,Tb));xb.initialDisplayMode=wc?1:2}xb.hostInfoFlags=0;xb.sharedRuntimeId?(xb.hostInfoFlags|=1,xb.solutionId=Tb):ca?(xb.solutionId=ca.assetId,xb.sourceLocationOverrideResourceId=ca.sourceLocationOverrideResourceId,xb.featureGates=A.AFrameworkApplication.fa.p3i(ca.assetId)):
xb.solutionId=O;xb.version=this.BA.Zm.version;xb.storeId=this.BA.Zm.store;xb.storeType=this.BA.Zm.storeType;xb.assetId=null;xb.assetStoreId=null;xb.settings=this.BA.settings;xb.reason=mk.a.contains(this.BA.Zm.id,this.BA.hy,this.BA.Zm.store,this.BA.Zm.storeType,this.BA.Zm.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.BA.hy?xb.osfControlType=0:1===this.BA.hy&&(xb.osfControlType=1);A.AFrameworkApplication.ypa||
OSF.OsfControl.isFirstPartyStoreString(xb.storeType)||(m.ULS.sendTraceTag(512369924,802,50,(0===this.BA.hy?"Content":"Taskpane")+" web add-in disabled by doc IRM"),xb.hostInfoFlags|=4);this.BA.taskpane?(xb.isForUILessAction=this.BA.taskpane.isForUILessAction,xb.ownerAddinSolutionId=Tb,xb.ownerAddinStoreType=this.BA.taskpane.ownerAddinStoreType):xb.isForUILessAction=!1;return xb}}Object(h.a)(zk,"AppForOfficeView",null,[998]);var ya=d(275),sn=d(72);class Sj{constructor(O,ca,Ta,xb,Tb,wc,sd,$b,ge,we,
oe,Fe,Gf,Rh,Sh){new ya.a(0,0,0,0);this.z9a=this.pN=this.fo=null;this.tQg=ResourceStrings.l_AddinPane;this.tE=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.gb&&A.AFrameworkApplication.Aa.gb.UV;this.vb=Wb.a.Ee();this.Nb=wc;this.gd=$b;this.Cz=sd;this.fe=ge;this.Gt=O;this.HG=ca;this.Op=Ta;this.YYj=xb;this.Ib=Tb;this.mu=we;this.Xd=oe;this.Mc=Fe;this.hc=Gf;this.TG=Rh;this.eta=Sh;this.initialize()}dispose(){this.gd&&this.fo&&(this.gd.xb(zf.a.click,this.fo,Object(E.a)(this,this.dAa,"closePaneButtonClickHandler")),
this.mu.removeHandler(this.fo,zf.a.eg,Object(E.a)(this,this.eig,"handleShortCutsOnCloseButton")),this.fo=null);this.Mc.GEb(Object(E.a)(this,this.Vz,"onUnifiedAppStateChanged"));this.Nb.FEb(Object(E.a)(this,this.aX,"onSetOffline"));this.Cz.hch(this)}initialize(){const O="label_"+this.HG;this.vb.className=this.Gt?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";this.vb.style.position="absolute";this.vb.style.display="none";this.vb.setAttribute(Ad.a.We,Ad.a.Kza);this.vb.setAttribute(Ad.a.y6,O);this.fo=
this.rAa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.fo,"AddinPaneCloseButton");this.gd.ob(zf.a.click,this.fo,Object(E.a)(this,this.dAa,"closePaneButtonClickHandler"));this.mu.addHandler(this.fo,zf.a.eg,Object(E.a)(this,this.eig,"handleShortCutsOnCloseButton"));this.vb.appendChild(this.fo);this.z9a=Wb.a.Ee();this.z9a.className="PaneLabel";this.z9a.id=O;this.z9a.setAttribute(Ad.a.We,Ad.a.oGf);this.z9a.setAttribute(Ad.a.zTb,"1");this.vb.appendChild(this.z9a);this.pN=Wb.a.Ee();
this.pN.className=this.Op.kd.RWa?"AddinPanePanelResize":"AddinPanePanel";this.vb.appendChild(this.pN);this.Mc.Mga(Object(E.a)(this,this.Vz,"onUnifiedAppStateChanged"));this.Nb.N2a(Object(E.a)(this,this.aX,"onSetOffline"))}Vz(O,ca){ca.a8a&&!this.hc.ln&&this.isVisible&&this.Djg()}aX(O){O&&this.isVisible&&this.Djg()}Djg(){this.Yo(!1);this.Op.mK().Ka(Eh.a.fPc,2,this.HG);this.Oae()||this.dispose()}layout(O,ca){const Ta=ca?O.wC(this.width):O.xC(this.width);this.isVisible&&(ca?Ta.wC(1):Ta.xC(1),this.pN.style.height=
(O.height-this.fo.clientHeight-this.z9a.clientHeight).toString()+"px",this.pN.style.width="100%");Wb.a.zX(this.vb,Ta);return O}e6k(O){this.tQg=O}Yo(O){const ca=this.Ib!==O;if(this.Ib=O)this.vb.style.display="block";const Ta=this.Oae();this.TG.M2k(this.HG,Ta);this.tE?this.TG.KL(this,this.Ib,this.eta?this.eta.fU:this.tQg,this.HG):this.Nb.BQa();Ta&&(this.fo.style.visibility=O?"visible":"hidden",ca&&this.Xd.dSi(this.HG,O))}Oae(){return this.Xd.bsa(this.HG)}dAa(){this.Yo(!1);this.Op.mK().Ka(Eh.a.fPc,2,
this.HG);this.Oae()||this.dispose();return!0}qAa(O,ca,Ta,xb,Tb,wc){const sd=Wb.a.CB();sd.alt=Tb;sd.className=sn.getImageClassWithCluster(O,xb);sd.src=this.fe.Yj(O+".png");sd.setAttribute("Unselectable","on");O=Wb.a.zn();O.className=ca+" cui-img-cont-float";O.appendChild(sd);ca=Wb.a.zn();ca.className=Ta;ca.setAttribute("Unselectable","on");ca.appendChild(O);Ta=Wb.a.Saa();Ta.className="CommentPaneNoBorderButton cui-ctl";Ta.title=Tb;Ta.setAttribute(Ad.a.We,Ad.a.Xt);Ta.tabIndex=0;Ta.appendChild(ca);wc&&
(Tb=Wb.a.zn(),Tb.className="cui-ctl-mediumlabel",Tb.setAttribute("Unselectable","on"),Tb.innerText=wc,Ta.appendChild(Tb));return Ta}rAa(O,ca){return this.qAa(O,"cui-img-16by16","cui-ctl-iconContainer",ca,CommonUIStrings.l_DialogClose,null)}eig(O){O.keyCode===Ki.a.aq||O.keyCode===Ki.a.xO?(this.dAa(null),O.preventDefault(),O.stopPropagation()):O.keyCode===Ki.a.Bq&&(O.shiftKey?this.Xd.notifyAgave(this.HG,12):this.Xd.notifyAgave(this.HG,11),O.preventDefault(),O.stopPropagation())}get isVisible(){return this.Ib}get ya(){return this.vb}get order(){return 6}get width(){return this.isVisible?
this.YYj:0}get mAc(){return this.pN}get $ni(){return this.fo}get id(){return this.HG}}Object(h.a)(Sj,"AddInPane",null,[1016,481,106]);class Jl{constructor(O,ca,Ta,xb,Tb,wc,sd,$b,ge,we){this.Op=O;this.Nb=ca;this.Cz=Ta;this.gd=xb;this.fe=Tb;this.c_=wc;this.Xd=sd;this.Mc=$b;this.hc=ge;this.TG=we}zEc(O,ca,Ta,xb,Tb){return new Sj(O,ca,this.Op,Ta,xb,this.Nb,this.Cz,this.gd,this.fe,this.c_,this.Xd,this.Mc,this.hc,this.TG,Tb)}N1(O){return new bg.a(O)}uvi(O){return new lk(this.Xd,this.Op,this.Nb,O,this.Cz)}rOd(O,
ca,Ta,xb,Tb){return new zk(O,ca,Ta,xb,Tb)}}Object(h.a)(Jl,"AppforOfficeClassFactory",null,[996]);class Se{constructor(O){this.TFg=this.mQ=!1;this.ym=wk.a.VX();this.wCg=O;rh.dIk(this.wCg)}rv(){this.TFg=!0}dispose(){if(this.TFg&&!this.mQ){var O=wk.a.VX();rh.cIk(this.wCg,this.ym,O);this.mQ=!0}}}Object(h.a)(Se,"ApiCallLogger",null,[106]);class Te{get formatting(){return 0}set formatting(O){}get sourceSlideIds(){return null}set sourceSlideIds(O){}get targetSlideId(){return null}set targetSlideId(O){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(O){switch(O){case 1:return this.formatting;
case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,ca){switch(O){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"Array<string>");
return;case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}
Object(h.a)(Te,"InsertSlideOptions",null,[]);class fc{constructor(){this.controlId=this.appId=null}}Object(h.a)(fc,"RequestContext",null,[]);class lm{constructor(){this.Xuf=this.jcf=null}get layoutId(){return this.jcf}set layoutId(O){this.jcf=O}get slideMasterId(){return this.Xuf}set slideMasterId(O){this.Xuf=O}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(O){switch(O){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,ca){switch(O){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}Object(h.a)(lm,"AddSlideOptions",null,[]);class Mc{constructor(O,ca,Ta){this.v6b=O;this.f8=ca;this.Xd=Ta}getAppRuntimeStartState(){if(!this.Xd.bsa(this.f8))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");return this.Xd.aXi(this.v6b)?1:0}setAppRuntimeStartState(O){if(!this.Xd.bsa(this.f8)||0!==O&&1!==O)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");
this.Xd.Nql(this.v6b,1===O)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,
ca){switch(O){case 2:return this.UXi();case 1:return this.p0k(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}UXi(){return this.getAppRuntimeStartState()}p0k(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");this.setAppRuntimeStartState(O);return null}}Object(h.a)(Mc,"AppRuntimePersistenceService",null,[]);class uf{constructor(O,
ca){this.f8=O;this.Xd=ca}getAppRuntimeState(){if(!this.Xd.bsa(this.f8))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Xd.$Wi(this.f8)?2:1}setAppRuntimeState(O){if(!this.Xd.bsa(this.f8)||2!==O&&1!==O)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");this.Xd.NFb(this.f8,2===O)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 2:return this.VXi();case 1:return this.q0k(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,
ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}VXi(){return this.getAppRuntimeState()}q0k(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");this.setAppRuntimeState(O);return null}}Object(h.a)(uf,"AppRuntimeService",null,[]);class mm{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 1001:return this.izj(ca);case 1002:return this.Gzj(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}izj(O){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"string");this.insertHyperLink(ca,O);return null}Gzj(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.insertSlideFromContent(O)}}Object(h.a)(mm,"Application",null,[]);class Nf{constructor(O,
ca){this.OF=!1;this._id=O;this.Fyd=ca}get enabled(){return this.OF}set enabled(O){this.OF=O;A.AFrameworkApplication.Ta.Ka(Vd.a.IYb,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.Fyd,["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(O){switch(O){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,ca){switch(O){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 5:return this.H1k(ca);
case 1:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}H1k(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"boolean");this.setEnabled(O);return null}kH(){this._OnAccess();return null}}Object(h.a)(Nf,"RibbonButton",null,[]);class Yg{constructor(){}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(O){switch(O){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 3:return this.E6k(ca);case 1:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,
ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}E6k(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"boolean");this.setVisibility(O);return null}kH(){this._OnAccess();return null}}Object(h.a)(Yg,"RibbonTab",null,[]);class Mk{constructor(O,ca){this.VJa=this.eR=this.Ruc=null;this.Spc=O;this.TZa=ca;ja.a.Va(this.Spc)||(this.VJa=ca.xrb(O),this.Ruc=(this.eR=this.TZa?this.TZa.yn:null)?this.eR.getOsfControl(this.Spc):null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(O){let ca=
null;if(!this.vsg())return this.lRf();if(!ja.a.Va(O)&&this.VJa&&this.VJa.taskpane){if(!this.yMf(O))return this.wRf(O);ca=new Nf(O,this.VJa.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)}getTab(O){let ca=null;if(!this.vsg())return this.lRf();if(!ja.a.Va(O)&&this.VJa&&this.VJa.taskpane){if(!this.yMf(O))return this.wRf(O);ca=new Yg(O)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(O){switch(O){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 1:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){switch(O){case 7:return this.nNi(ca);
case 6:return this.oNi(ca);case 3:return this.NYi(ca);case 5:return this.zej(ca)}O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}nNi(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.executeRequestCreate(O)}oNi(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.executeRequestUpdate(O)}NYi(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getButton(O)}zej(O){O=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getTab(O)}kH(){this._OnAccess();return null}wRf(O){return this.IRf("ControlIdNotFound",ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+O)}lRf(){return this.IRf("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}vsg(){const O=!ja.a.Va(this.Ruc.getSharedRuntimeId());wb.a.J(512497821,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",O));return O}yMf(O){if(this.Ruc){var ca=
this.Ruc.getManifest();if(ca&&(ca=ca.getRibbonExtensionControlMap()))return O in ca||this.wki(O)}return!1}wki(O){var ca=this.ARi();if(ca){ca=ca.oYf;for(const Ta of ca.tabs){if(Ta.id===O)return!0;for(const xb of Ta.groups)for(const Tb of xb.controls){if(Tb.id===O)return!0;if("Menu"===Tb.type){ca=Tb;for(const wc of ca.items)if(wc.id===O)return!0}}}}return!1}ARi(){return M.getInstance().t5a(this.VJa.taskpane.ownerAddinStoreType,this.VJa.taskpane.ownerAddinSolutionId,1)}IRf(O,ca){return OfficeExtension.WacRuntime.Utility.createPromise((Ta,
xb)=>{xb(OfficeExtension.WacRuntime.Utility.createRichApiException(O,ca))})}}Object(h.a)(Mk,"DynamicRibbon",null,[]);class Fn{constructor(O,ca,Ta,xb){this.ZWe="";this.frc=0;this.JF=O;this._id=ca;this.rPb=Ta;this.TZa=xb}get id(){return this._id}_RegisterStateChange(){this.frc||this.JF.execute(O=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.rPb,this._id,1);this.ZWe=O.deb(this._id,ca=>{this.TZa.fSi(this.rPb,this._id,JSON.stringify(ca))})});this.frc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.frc--;
this.frc||this.JF.execute(O=>{O.uEb(this._id,this.ZWe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(O){switch(O){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){switch(O){case 6:return this.nGh();case 7:return this.rGh()}O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}nGh(){return this._RegisterStateChange()}rGh(){return this._UnregisterStateChange()}}Object(h.a)(Fn,"LicenseFeature",
null,[]);class ba{get scopes(){return null}set scopes(O){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(O){switch(O){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,ca){switch(O){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}Object(h.a)(ba,"MsaDeviceTicketOptions",null,[]);class Bl{constructor(O,ca){this.JF=
mc.a.instance.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.rPb=O;this.TZa=ca}getFeatureTier(O,ca){return OfficeExtension.WacRuntime.Utility.createPromise(Ta=>{const xb=1===ca?1:2===ca?2:0;this.JF.execute(Tb=>{Tb.getFeatureTier(O,xb).then(wc=>{Ta(this.R5i(wc))},()=>{Ta(ca)})})})}getLicenseFeature(O){O=new Fn(this.JF,O,this.rPb,this.TZa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}getMsaDeviceTicket(){return null}isFeatureEnabled(O,ca){return OfficeExtension.WacRuntime.Utility.createPromise(Ta=>
{this.JF.execute(xb=>{xb.isFeatureEnabled(O,ca).then(Tb=>{Ta(Tb)},()=>{Ta(ca)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(O=>{this.JF.execute(ca=>{ca=ca.isFreemiumUpsellEnabled();O(ca)})})}launchUpsellExperience(O){if(this.TZa.yn.getOsfControl(this.rPb).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.JF.execute(ca=>{ca.launchUpsellExperience(O)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied",
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,
ca){switch(O){case 7:return this.D7i(ca);case 6:return this.pGh(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){switch(O){case 2:return this.P2i(ca);case 5:return this.Q5i(ca);case 1:return this.HFj(ca);case 3:return this.sGj();case 4:return this.TRj(ca)}O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}P2i(O){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,
1,"int");return this.getFeatureTier(ca,O)}Q5i(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getLicenseFeature(O)}D7i(O){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string"),Ta=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,2,ba);return this.getMsaDeviceTicket(ca,Ta,O)}HFj(O){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,
0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"boolean");return this.isFeatureEnabled(ca,O)}sGj(){return this.isFreemiumUpsellEnabled()}TRj(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.launchUpsellExperience(O)}pGh(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");this._TestFireStateChangedEvent(O);return null}R5i(O){switch(O){case 1:return 1;case 2:return 2;default:return 0}}}Object(h.a)(Bl,"License",
null,[]);class Kg{get height(){return 0}set height(O){}get left(){return 0}set left(O){}get top(){return 0}set top(O){}get width(){return 0}set width(O){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(O){switch(O){case 1:return this.height;case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,
ca){switch(O){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 3:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,
ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}Object(h.a)(Kg,"ShapeAddOptions",null,[]);class Bf{constructor(O,ca,Ta){this.vze=!1;this.yFg=!0;this.v6b=O;this.f8=ca;this.Xd=Ta}hostName(){return"PowerPointOnline"}appId(){return this.v6b}controlId(){return this.f8}createInstance(O){switch(O){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new lm;
case "Microsoft.Office.PowerPoint.Application":return new mm;case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new Te;case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new Kg;case "Microsoft.AppRuntime.AppRuntimeService":return new uf(this.f8,this.Xd);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new Mc(this.v6b,this.f8,this.Xd);case "Microsoft.Office.Licensing.License":return new Bl(this.f8,this.Xd);case "Microsoft.DynamicRibbon.DynamicRibbon":return new Mk(this.f8,
this.Xd)}m.ULS.sendTraceTag(588375570,802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",O);return null}static Kq(O){const ca=mc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").Vzf;O||(ca.yFg=!1);return!ca.vze}}Object(h.a)(Bf,"RichApiHost",null,[1010]);class Ej{constructor(O,ca,Ta){this.und=this.Lh=-1;this.kB=Ta;0<=O&&(this.Lh+=O,this.und=0<ca?O+ca<this.kB.getCount()?O+ca:this.kB.getCount():this.kB.getCount())}get_current(){return-1<
this.Lh&&this.Lh<this.und?this.kB.getItemAt(this.Lh):null}moveNext(){const O=this.mql();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}mql(){return this.Lh+1<this.und?(this.Lh++,!0):!1}}Object(h.a)(Ej,"ElementEnumerator",null,[1056]);class rj{constructor(O,ca){this.Zya=O;this.yR=ca}get fill(){Bf.Kq(!1);return null}get height(){Bf.Kq(!1);return 0}set height(O){Bf.Kq(!1)}get id(){const O=new Se(28);try{wb.a.J(572643292,802,50,"PptApi Call - Shape.GetId");if(!this.Zya)return wb.a.J(577525073,
802,10,"Shape is null."),"";const ca=this.Zya.get_shapeId().toString();O.rv();return ca}finally{O&&O.dispose()}}get left(){Bf.Kq(!1);return 0}set left(O){Bf.Kq(!1)}get lineFormat(){Bf.Kq(!1);return null}get name(){Bf.Kq(!1);return null}set name(O){Bf.Kq(!1)}get tags(){Bf.Kq(!1);return null}get textFrame(){Bf.Kq(!1);return null}get top(){Bf.Kq(!1);return 0}set top(O){Bf.Kq(!1)}get type(){Bf.Kq(!1);return 0}get width(){Bf.Kq(!1);return 0}set width(O){Bf.Kq(!1)}deleteObject(){if(Bf.Kq(!0)){var O=new Se(45);
try{wb.a.J(572527067,802,50,"PptApi Call - Shape.Delete");const ca=Object(D.a)(123,this.yR);ca&&(ca.mEi(Object(D.a)(4,this.Zya)),O.rv())}finally{O&&O.dispose()}}}getParentSlide(){Bf.Kq(!1);return null}getParentSlideLayout(){Bf.Kq(!1);return null}getParentSlideLayoutOrNullObject(){Bf.Kq(!1);return null}getParentSlideMaster(){Bf.Kq(!1);return null}getParentSlideMasterOrNullObject(){Bf.Kq(!1);return null}getParentSlideOrNullObject(){Bf.Kq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(O){switch(O){case 11:return this.fill;
case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,ca){switch(O){case 5:this.height=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 4:return this.OQd();case 15:return this.i9i();case 16:return this.j9i();case 18:return this.k9i();case 17:return this.l9i();case 19:return this.m9i();case 20:return this.n9i();case 2:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}OQd(){this.deleteObject();
return null}i9i(){return this.getParentSlide()}j9i(){return this.getParentSlideLayout()}k9i(){return this.getParentSlideLayoutOrNullObject()}l9i(){return this.getParentSlideMaster()}m9i(){return this.getParentSlideMasterOrNullObject()}n9i(){return this.getParentSlideOrNullObject()}kH(){this._OnAccess();return null}}Object(h.a)(rj,"Shape",null,[]);class dk{constructor(O){this.jNb=this.Elb=null;this.yR=O;if(O=Object(D.a)(123,this.yR))this.Elb=O.rQa();this.owk()}owk(){this.jNb=new Ba.ScriptSharpLegacyMap;
if(this.Elb)for(const O of this.Elb){const ca=new rj(O,this.yR);this.jNb.add(ca.id,ca)}}addGeometricShape(){Bf.Kq(!1);return null}addLine(){Bf.Kq(!1);return null}addTextBox(){Bf.Kq(!1);return null}getCount(){const O=new Se(29);try{wb.a.J(572643288,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.Elb)return wb.a.J(577525071,802,50,"In Shape.GetCount(), _shapes is null"),0;O.rv();return this.Elb.length}finally{O&&O.dispose()}}getItem(O){const ca=new Se(31);try{wb.a.J(572643289,802,50,"PptApi Call - ShapeCollection.GetItem");
try{const Ta=this.jNb.ga(O);ca.rv();return Ta}catch(Ta){throw wb.a.J(577525069,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",Ta.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(O){const ca=new Se(30);try{wb.a.J(572643290,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const Ta=this.Elb[O].get_shapeId().toString(),xb=this.jNb.ga(Ta);
ca.rv();return xb}catch(Ta){throw wb.a.J(577525067,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",Ta.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{ca&&ca.dispose()}}getItemOrNullObject(O){const ca=new Se(32);try{wb.a.J(572643291,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");let Ta;({value:Ta}=this.jNb.Of(O));ca.rv();return Ta}finally{ca&&
ca.dispose()}}_OnAccess(){}getAsyncEnumerator(O,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ej(O,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 6:return this.x_h(ca);case 7:return this.X_h(ca);case 8:return this.F1h(ca);case 1:return this.b6a();case 2:return this.q6a(ca);case 5:return this.p6a(ca);case 3:return this.r6a(ca);case 4:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}x_h(O){const ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,Kg);return this.addGeometricShape(ca,O)}X_h(O){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,Kg);return this.addLine(ca,O)}F1h(O){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,
1,Kg);return this.addTextBox(ca,O)}b6a(){return this.getCount()}q6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getItem(O)}p6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");return this.getItemAt(O)}r6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getItemOrNullObject(O)}kH(){this._OnAccess();return null}}Object(h.a)(dk,"ShapeCollection",null,[1025]);class Qi{constructor(O){this.Zwc=
O}get id(){const O=new Se(15);try{wb.a.J(572643276,802,50,"PptApi Call - SlideLayout.GetId");if(!this.Zwc)return wb.a.J(576581654,802,10,"SlideLayout is null."),"";const ca=this.Zwc.Id.toString();O.rv();return ca}finally{O&&O.dispose()}}get name(){const O=new Se(16);try{wb.a.J(572643277,802,50,"PptApi Call - SlideLayout.GetName");if(!this.Zwc)return wb.a.J(576581655,802,10,"SlideLayout is null."),"";const ca=this.Zwc.Name;O.rv();return ca}finally{O&&O.dispose()}}get shapes(){Bf.Kq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(O){switch(O){case 1:return this.id;
case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 2:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}kH(){this._OnAccess();return null}}Object(h.a)(Qi,"SlideLayout",null,[]);class sj{constructor(O){this.kNb=null;this.bRb=O;this.pwk()}pwk(){this.kNb=new Ba.ScriptSharpLegacyMap;if(this.bRb)for(const O of this.bRb){const ca=new Qi(O);this.kNb.add(ca.id,ca)}}getCount(){const O=new Se(17);try{wb.a.J(572643272,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.bRb)return wb.a.J(576581651,
802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),0;O.rv();return this.bRb.length}finally{O&&O.dispose()}}getItem(O){const ca=new Se(19);try{wb.a.J(572643273,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const Ta=this.kNb.ga(O);ca.rv();return Ta}catch(Ta){throw wb.a.J(576581652,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",Ta.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(O){const ca=new Se(18);try{wb.a.J(572643274,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");try{const Ta=this.kNb.ga(this.bRb[O].Id.toString());ca.rv();return Ta}catch(Ta){throw wb.a.J(576581653,802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",Ta.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{ca&&ca.dispose()}}getItemOrNullObject(O){const ca=new Se(20);try{wb.a.J(572643275,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");let Ta;({value:Ta}=this.kNb.Of(O));ca.rv();return Ta}finally{ca&&ca.dispose()}}_OnAccess(){}getAsyncEnumerator(O,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ej(O,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 1:return this.b6a();case 2:return this.q6a(ca);case 3:return this.p6a(ca);case 4:return this.r6a(ca);case 5:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}b6a(){return this.getCount()}q6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getItem(O)}p6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");return this.getItemAt(O)}r6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getItemOrNullObject(O)}kH(){this._OnAccess();return null}}
Object(h.a)(sj,"SlideLayoutCollection",null,[1025]);class Nk{constructor(O){this.Olb=O}get id(){const O=new Se(21);try{wb.a.J(572643269,802,50,"PptApi Call - SlideMaster.GetId");if(!this.Olb)return wb.a.J(576581648,802,10,"SlideMaster is null."),"";const ca=this.Olb.Id.toString();O.rv();return ca}finally{O&&O.dispose()}}get layouts(){const O=new Se(23);try{wb.a.J(572643270,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.Olb)return wb.a.J(576581649,802,10,"SlideMaster is null."),null;const ca=
new sj(this.Olb.ContentMasters);O.rv();return ca}finally{O&&O.dispose()}}get name(){const O=new Se(22);try{wb.a.J(572643271,802,50,"PptApi Call - SlideMaster.GetName");if(!this.Olb)return wb.a.J(576581650,802,10,"SlideMaster is null."),"";const ca=this.Olb.Name;O.rv();return ca}finally{O&&O.dispose()}}get shapes(){Bf.Kq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(O){switch(O){case 1:return this.id;case 3:return this.layouts;case 4:return this.name;
case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 2:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}kH(){this._OnAccess();return null}}Object(h.a)(Nk,"SlideMaster",null,[]);class Dm{constructor(O,ca){this.yR=O;this.Eya=ca}get id(){const O=new Se(5);try{wb.a.J(572643283,802,50,"PptApi Call - Slide.GetId");if(!this.yR)return wb.a.J(587747398,802,10,"Slide is null."),"";const ca=this.yR.Bb.toString();O.rv();return ca}finally{O&&O.dispose()}}get layout(){const O=new Se(9);try{wb.a.J(572643284,
802,50,"PptApi Call - Slide.GetLayout");const ca=this.Eya.r9;for(let Ta=0;Ta<ca.length;Ta++){const xb=ca[Ta].ContentMasters;for(let Tb=0;Tb<xb.length;Tb++)if(this.yR.Xn===xb[Tb].Id){const wc=new Qi(xb[Tb]);O.rv();return wc}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a Layout.");}finally{O&&O.dispose()}}get shapes(){const O=new Se(6);try{wb.a.J(572643285,802,50,"PptApi Call - Slide.GetShapes");
const ca=new dk(this.yR);O.rv();return ca}finally{O&&O.dispose()}}get slideMaster(){const O=new Se(8);try{wb.a.J(572643286,802,50,"PptApi Call - Slide.GetSlideMaster");const ca=this.Eya.r9;for(let Ta=0;Ta<ca.length;Ta++)if(this.yR.uj===ca[Ta].Id){const xb=new Nk(ca[Ta]);O.rv();return xb}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a SlideMaster.");}finally{O&&O.dispose()}}get tags(){Bf.Kq(!1);return null}deleteObject(){if(Bf.Kq(!0)){var O=
new Se(7);try{wb.a.J(572643287,802,50,"PptApi Call - Slide.Delete"),this.Eya.JM(this.yR),O.rv()}finally{O&&O.dispose()}}}setSelectedShapes(){Bf.Kq(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(O){switch(O){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 3:return this.OQd();case 8:return this.S4k(ca);case 2:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,
ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}OQd(){this.deleteObject();return null}S4k(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"Array<string>");this.setSelectedShapes(O);return null}kH(){this._OnAccess();return null}}Object(h.a)(Dm,"Slide",null,[]);class Kl{constructor(O){this.lNb=null;this.Eya=O;this.Plb=this.Eya.slides;this.qwk()}qwk(){this.lNb=new Ba.ScriptSharpLegacyMap;if(this.Plb)for(const O of this.Plb){const ca=new Dm(O,this.Eya);this.lNb.add(ca.id,
ca)}}Y0i(){return 0<this.getCount()?this.Plb[this.getCount()-1]:null}d1i(O){return O?O.uj:this.Eya.r9[0].Id}$0i(O){const ca=this.Eya.r9;for(let Ta=0;Ta<ca.length;Ta++)if(O===ca[Ta].Id)return ca[Ta].ContentMasters[0].Id;return 0}add(O){if(Bf.Kq(!0)){var ca=new Se(10);try{wb.a.J(572643278,802,50,"PptApi Call - SlideCollection.Add");const Ta=this.Y0i();let xb=0;xb=O&&O.slideMasterId?parseInt(O.slideMasterId):this.d1i(Ta);let Tb=0;Tb=O&&O.layoutId?parseInt(O.layoutId):this.$0i(xb);this.Eya.kzc(Ta,null,
xb,Tb);ca.rv()}finally{ca&&ca.dispose()}}}getCount(){const O=new Se(11);try{wb.a.J(572643279,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.Plb)return wb.a.J(587747396,802,50,"In Slides.GetCount(), _slides is null"),0;O.rv();return this.Plb.length}finally{O&&O.dispose()}}getItem(O){const ca=new Se(13);try{wb.a.J(572643280,802,50,"PptApi Call - SlideCollection.GetItem");try{const Ta=this.lNb.ga(O);ca.rv();return Ta}catch(Ta){throw wb.a.J(587747394,802,15,String.format("In Slide.GetItem(id), Exception: {0} ",
Ta.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(O){const ca=new Se(12);try{wb.a.J(572643281,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const Ta=this.lNb.ga(this.Plb[O].Bb.toString());ca.rv();return Ta}catch(Ta){throw wb.a.J(587747392,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",Ta.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItemAt(index)");}}finally{ca&&ca.dispose()}}getItemOrNullObject(O){const ca=new Se(14);try{wb.a.J(572643282,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");let Ta;({value:Ta}=this.lNb.Of(O));ca.rv();return Ta}finally{ca&&ca.dispose()}}_OnAccess(){}getAsyncEnumerator(O,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ej(O,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 6:return this.V_h(ca);case 1:return this.b6a();case 5:return this.q6a(ca);case 2:return this.p6a(ca);case 3:return this.r6a(ca);
case 4:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}V_h(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,lm);this.add(O);return null}b6a(){return this.getCount()}q6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getItem(O)}p6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,
0,"int");return this.getItemAt(O)}r6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getItemOrNullObject(O)}kH(){this._OnAccess();return null}}Object(h.a)(Kl,"SlideCollection",null,[1025]);class tj{constructor(O){this.mNb=null;this.cRb=O;this.rwk()}rwk(){this.mNb=new Ba.ScriptSharpLegacyMap;if(this.cRb)for(const O of this.cRb){const ca=new Nk(O);this.mNb.add(ca.id,ca)}}getCount(){const O=new Se(24);try{wb.a.J(572643265,802,50,"PptApi Call - SlideMasterCollection.GetCount");
if(!this.cRb)return wb.a.J(576581645,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;O.rv();return this.cRb.length}finally{O&&O.dispose()}}getItem(O){const ca=new Se(26);try{wb.a.J(572643266,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const Ta=this.mNb.ga(O);ca.rv();return Ta}catch(Ta){throw wb.a.J(576581646,802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",Ta.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(O){const ca=new Se(25);try{wb.a.J(572643267,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const Ta=this.mNb.ga(this.cRb[O].Id.toString());ca.rv();return Ta}catch(Ta){throw wb.a.J(576581647,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",Ta.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{ca&&ca.dispose()}}getItemOrNullObject(O){const ca=new Se(27);try{wb.a.J(572643268,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");let Ta;({value:Ta}=this.mNb.Of(O));ca.rv();return Ta}finally{ca&&ca.dispose()}}_OnAccess(){}getAsyncEnumerator(O,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ej(O,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 1:return this.b6a();case 2:return this.q6a(ca);case 3:return this.p6a(ca);case 4:return this.r6a(ca);case 5:return this.kH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}b6a(){return this.getCount()}q6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getItem(O)}p6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");return this.getItemAt(O)}r6a(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getItemOrNullObject(O)}kH(){this._OnAccess();return null}}
Object(h.a)(tj,"SlideMasterCollection",null,[1025]);class Le{constructor(O){this.xD=new fc;this.F3=O.presentation}get context(){return this.xD}get slideMasters(){const O=new Se(2);try{wb.a.J(572643293,802,50,"PptApi Call - Presentation.GetSlideMasters");const ca=new tj(this.F3.r9);O.rv();return ca}finally{O&&O.dispose()}}get slides(){const O=new Se(3);try{wb.a.J(572643294,802,50,"PptApi Call - Presentation.GetSlides");const ca=new Kl(this.F3);O.rv();return ca}finally{O&&O.dispose()}}get tags(){Bf.Kq(!1);
return null}get title(){const O=new Se(4);try{return wb.a.J(572643295,802,50,"PptApi Call - Presentation.GetTitle"),O.rv(),"This is the title property"}finally{O&&O.dispose()}}getSelectedShapes(){Bf.Kq(!1);return null}getSelectedSlides(){Bf.Kq(!1);return null}getSelectedTextRange(){Bf.Kq(!1);return null}getSelectedTextRangeOrNullObject(){Bf.Kq(!1);return null}insertSlidesFromBase64(){Bf.Kq(!1)}setSelectedSlides(){Bf.Kq(!1)}_RegisterEvent(O,ca){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,
O,ca)}_UnregisterEvent(O,ca){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,O,ca)}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(O){switch(O){case 3:return this.slideMasters;case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,ca){this.invokePropertySet(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,ca){switch(O){case 5:return this.vbj();case 6:return this.xbj();case 7:return this.Cbj();case 9:return this.Dbj();case 1003:return this.Hzj(ca);case 8:return this.T4k(ca);case 1001:return this.mGh(ca);case 1002:return this.qGh(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,ca){O=this.invokeMethod(O,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}vbj(){return this.getSelectedShapes()}xbj(){return this.getSelectedSlides()}Cbj(){return this.getSelectedTextRange()}Dbj(){return this.getSelectedTextRangeOrNullObject()}Hzj(O){const ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,Te);this.insertSlidesFromBase64(ca,O);return null}T4k(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"Array<string>");this.setSelectedSlides(O);return null}mGh(O){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"int");this._RegisterEvent(ca,O);return null}qGh(O){const ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"int");this._UnregisterEvent(ca,O);return null}}Object(h.a)(Le,"Presentation",null,[]);class $l{create(O){return new Le(O)}}Object(h.a)($l,"PresentationFactory",null,[990]);class Ke{create(O,ca,Ta){return new Bf(O,ca,Ta)}}Object(h.a)(Ke,"RichApiHostFactory",null,[991]);class ee{constructor(O){this.vb=document.createElement("div");this.vb.className="AddinPaneFrame";
this.Cz=O}dispose(){}layout(O,ca){this.Cz.value.dmj(O,ca);return O}get isVisible(){return!1}get ya(){return this.vb}get order(){return 13}}Object(h.a)(ee,"AddinPaneFrame",null,[974,481,106]);class Ne{constructor(){this.c$a=this.EXc=this.K=this.Xd=this.uI=null;this.tE=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.gb&&A.AFrameworkApplication.Aa.gb.UV}get name(){return"PowerPointWebEditor.AppForOffice"}Wb(O){this.uI=O.resolve("Common.AFrameworkApplication");this.K=O;this.K.register(Hc,"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").na(()=>
new Hc).ma();this.K.register(qh,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").na(()=>new qh(this.K.resolve("PowerPointWebEditor.IAddinPaneFrame").ya,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.Be("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).ma();this.K.register(Sc,
"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").na(()=>new Sc(this.K.resolve("PowerPointWebEditor.IPPTZoomManager"),this.K.resolve("Box4.IPageView").container,this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).ma();
this.K.register(mg,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").na(()=>new mg(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.IFrameContext"),new Ed,this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.K.Be("PowerPointWebEditor.IClassFactory"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),new H,K.getInstance(),this.K.Be("PowerPointWebEditor.IAppforOfficeClassFactory"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.K.resolve("Common.App.OAuth.IOAuthManager"))).ma();const ca=new v;this.K.register(Jf,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").na(()=>
new Jf(this.uI,this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),ca,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),new tg,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("Common.IRibbonExternal"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.register(Dg,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").na(()=>
new Dg(ca)).ma();this.K.register(Bd,"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").na(()=>new Bd(this.OVi())).ma();this.K.register(Jl,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").na(()=>new Jl(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))).ma();this.K.register(Ke,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").na(()=>new Ke).ma();
this.K.register($l,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").na(()=>new $l).ma();this.K.register(974,"PowerPointWebEditor.IAddinPaneFrame").ma().na(()=>new ee(this.K.Be("PowerPointWebEditor.IAppForOfficeFocusManager")));this.K.register(975,"PowerPointWebEditor.IAppForOfficeAuthFactory").ma().na(()=>new kf)}init(){A.AFrameworkApplication.KAa||this.K.resolve("Common.IAppSettingsManager").ff(Object(E.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){this.Xd=
this.K.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Xd.TVb=!0;A.AFrameworkApplication.fa.ka("OcpsIsEnabled")?this.K.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(O=>{O.isFeatureEnabled(Ne.t5j,!0).then(ca=>{this.Xd.TVb=ca;this.Ftb();return null})}):this.Ftb()}Ftb(){this.K.resolve("PowerPointWebEditor.IAddinCommandsManager");this.K.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").SCe();
this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const O=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");O.Dol();O.Eol();O.lkj();this.Cql();this.Lwj();this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}Lwj(){const O=this.K.resolve("PowerPointWebEditor.IAddinPaneFrame");
this.tE||this.K.resolve("PowerPointWebEditor.IPaneManager").uM(O);const ca=this.K.resolve("PowerPointWebEditor.IFocusManager"),Ta=this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");ca.v7(ih.a.Fza,ih.a.gj,O,!Ta.k3d());this.uI.$q.yq()}OVi(){const O=[];var ca=[];ca.push(this.K.resolve("Box4.Graph.IGraphInstance").Bd(47));ca.push(this.K.resolve("Box4.Graph.IGraphInstance").Bd(10));ca=new kk(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),ca,this.K.resolve("Box4.Graph.IGraphIteratorFactory"));
O.push(ca);ca=new Dj(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(49),this.K.resolve("Box4.Graph.IGraphIteratorFactory"));O.push(ca);ca=new Ih(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));O.push(ca);ca=new qn(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.Graph.IGraphInstance").Bd(47));O.push(ca);ca=new Yf(this.K.resolve("Box4.Graph.IGraphInstance").Bd(8),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));O.push(ca);return O}Cql(){this.c$a=A.AFrameworkApplication.fa.Ha("DevAddinManifestFileUrl");this.EXc=A.AFrameworkApplication.fa.Ha("DevAddinManifestGuid");var O=A.AFrameworkApplication.fa.Ha("IsDevAddinTest");if(this.c$a&&this.EXc&&O)if(O="true"===O,w.a.instance.getItem("optedIntoAddinDeveloperMode")||
O&&A.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))if(w.a.instance.getItem(this.EXc)||O&&A.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))this.Xd.yn.validateAndCacheNewDevAddinManifest(this.c$a);else{O=new y.StandardDialog;O.vd=4;const ca=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.c$a)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;O.mO(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
ca,Object(E.a)(this,this.abh,"registerDevAddinManifestHandler"))}else O=Object(E.a)(this,this.abh,"registerDevAddinManifestHandler"),O=new ug(this.c$a,O),O.vd=0,O.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}abh(O){1===O&&this.c$a&&this.FKk()}FKk(){this.Xd&&(this.Xd.yn.validateAndCacheNewDevAddinManifest(this.c$a),w.a.instance.setItem(this.EXc,"true"))}static main(){u.a.instance.Ac(new Ne)}}Ne.t5j=
"mso_officeStore";Object(h.a)(Ne,"AppForOfficePackage",null,[2,3]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Type.registerNamespace("CommandUI.AddInCommands");Ne.main()},538:function(J,V,d){d.r(V);J=d(0);var h=d(17),e=d(375),m=d(66);class n{constructor(){this.startTime=0;this.callback=null}}Object(J.a)(n,"SSOCallbackInfo",null,[]);class v{constructor(){this.accessToken=
null}}Object(J.a)(v,"AccessTokenInformation",null,[1096]);var A=d(968);class w{constructor(){this.token=null;this.expiresOn=0;this.Mza=this.$U=null}}Object(J.a)(w,"CachedTokenInfo",null,[]);class y{constructor(){this.mpc=new h.a;this.tpa=this.spa=!1;this.jJa=this.$U=null;this.startTime=this.retryCount=0;this.sDf=null}get MKd(){return this.mpc}}Object(J.a)(y,"SSORequestInfo",null,[]);class u extends y{constructor(){super();this.errorCode=0}}Object(J.a)(u,"SSOFailedRequestInfo",y,[]);var E=d(25);class G{constructor(aa,
Q,ea,ia){this.g6=new h.a;this.lR=new h.a;this.dKa=null;this.bQb=new h.a;this.$bf=Promise.resolve(null);this.Guf=!1;this.yTh=Q;this.Spc=aa;this.Fvf=ea;this.MGh=ia}a$k(aa){if(this.dKa&&this.dKa.$U===aa.$U){if(Date.now()/1E3+G.wbk>this.dKa.expiresOn)return this.dKa=null,!1;aa=new A.a;aa.token=this.dKa.token;aa.expiresOn=this.dKa.expiresOn;aa.Mza=this.dKa.Mza;aa.khb=!0;aa.N0b=0;this.v1b(aa);return!0}return!1}E8k(aa){for(let Q=0;Q<this.lR.count;Q++)if(this.lR.ga(Q).$U===aa.$U&&this.lR.ga(Q).jJa===aa.jJa){let ea;
(ea=this.lR.ga(Q)).retryCount=ea.retryCount+1;aa.retryCount=this.lR.ga(Q).retryCount;if(this.lR.ga(Q).retryCount<G.CVa||!this.lR.ga(Q).spa&&aa.spa||!this.lR.ga(Q).tpa&&aa.tpa){if(!this.lR.ga(Q).spa&&aa.spa||!this.lR.ga(Q).tpa&&aa.tpa)aa.retryCount=0;this.lR.removeAt(Q);break}aa=new A.a;aa.errorCode=this.lR.ga(Q).errorCode;this.v1b(aa);return!0}return!1}L1h(aa,Q){for(let ea=0;ea<this.lR.count;ea++)if(this.lR.ga(ea).jJa===aa.jJa&&this.lR.ga(ea).$U===aa.$U)return;this.lR.add(Object.assign(new u,{spa:aa.spa,
tpa:aa.tpa,$U:aa.$U,jJa:aa.jJa,errorCode:Q,retryCount:aa.retryCount}))}get resource(){return this.yTh}NWd(aa,Q,ea,ia,ja,D){const {AppsForOfficeSingleSignOnManager:pa}=d(538);""===ea&&(ea=null);if(this.Guf)pa.oja(D,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var Z=null;for(let oa of this.g6)if(oa.spa===aa&&oa.tpa===Q&&oa.$U===ea&&oa.jJa===ja){Z=oa;break}Z||(Z=Object.assign(new y,{spa:aa,tpa:Q,$U:ea,sDf:ia,jJa:ja,retryCount:0,startTime:pa.QE()}),this.g6.add(Z));Z.retryCount=
0;Z.MKd.add(D);this.$bf=this.$bf.then(()=>{var {AppsForOfficeSingleSignOnManager:oa}=d(538);if(0<this.g6.count){var Ba=this.g6.ga(0);if(this.a$k(Ba)||this.E8k(Ba))return null;for(let za=0;za<this.bQb.count;)this.bQb.ga(za)+G.Ill<oa.QE()?this.bQb.removeAt(za):za++;if(this.bQb.count>=G.Mbk||this.g6.count>=G.tbk)return Ba=new A.a,Ba.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.v1b(Ba),null;let Ma=null;E.AFrameworkApplication.Aa&&(oa=E.AFrameworkApplication.Aa.hU)&&(Ma=oa.wi("ComponentAttach",
this.Spc+G.MVh));return Ba.jJa.EYh(this.resource,Ba.spa,Ba.tpa,Ba.$U,this.MGh,Ba.sDf).then(za=>{Ma&&Ma.stop();this.v1b(za)},()=>{Ma&&Ma.stop();const za=new A.a;za.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.v1b(za)})}return null})}}v1b(aa){const {AppsForOfficeSingleSignOnManager:Q}=d(538);try{if(this.g6.count){var ea=this.g6.ga(0);this.g6.removeAt(0);var ia=null;aa.errorCode||(ia=new v,ia.accessToken=aa.token);aa.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&
aa.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&aa.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&aa.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.L1h(ea,aa.errorCode);var ja={};null!=aa.N0b&&(ja.getTokenSilentTime=aa.N0b.toString());null!=aa.F1d&&(ja.getTokenPopupTime=aa.F1d.toString());null!=aa.fZd&&(ja.getIDTokenTime=aa.fZd.toString());null!=aa.khb&&(ja.tokenCached=aa.khb.toString());aa.TOe&&(ja.detailedError=aa.TOe);aa.Mza&&
(ja.authLibrary=aa.Mza);ea.retryCount&&(ja.retryCount=ea.retryCount);for(var D of ea.MKd)Q.oja(D,aa.errorCode,ia,ja);null!=aa.khb&&aa.khb||this.bQb.add(ea.startTime);if(!aa.errorCode)for(null!=aa.expiresOn&&(this.dKa=Object.assign(new w,{token:aa.token,expiresOn:aa.expiresOn,$U:ea.$U,Mza:aa.Mza})),this.lR.clear(),D=0;D<this.g6.count;)if(this.g6.ga(D).$U===ea.$U){for(let pa of this.g6.ga(D).MKd)Q.oja(pa,aa.errorCode,ia,ja);this.g6.removeAt(D)}else D++}}catch(pa){e.ULS.sendTraceTag(21628945,344,10,
"ReceivedAccessTokenHandler: exception message: {0}",pa.message)}}shutdown(){this.Guf=!0;this.g6.clear()}}G.Ill=6E4;G.Mbk=6;G.tbk=6;G.CVa=3;G.wbk=300;G.MVh="GetAccessToken";Object(J.a)(G,"SSOCallbackManager",null,[]);var I=d(229),H=d(259),K=d(167),C=d(80),Y=d(54),M=d(45),P=d(141),T=d(194);d.d(V,"AppsForOfficeSingleSignOnManager",function(){return L});class L{constructor(aa,Q,ea=null){this.mib=new m.a;const ia=new h.a;Q&&ia.add(Q.K9j);ea&&ia.addRange(ea);this.eR=aa;this.TWh=ia}removeCallbackForAddin(aa){this.mib.Jb(aa)&&
(this.mib.ga(aa).shutdown(),this.mib.remove(aa))}OWd(aa,Q,ea,ia,ja,D,pa,Z,oa,Ba){Ba=Object.assign(new n,{startTime:L.QE(),callback:Ba});try{const ka=!!ea&&""!==ea;var Ma=Ba.startTime;const qa=this.getOsfControl(aa);let Ja=qa.getStoreType()||"",xa=qa.getOwnerAddinStoreType()||"",Ga=qa.getSolutionId()||"";const na=qa.getVersion()||"";Ja=Ja.toLowerCase();xa=xa.toLowerCase();Ga=Ga.toLowerCase();var za=C.a.MLc(Q)||"";const sa=C.a.MLc(qa.getIframeUrl())||"",Ha=za.toLowerCase()===sa.toLowerCase();za=Ja;
"inmemory"===Ja&&(za=xa);const cb=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ga,za,qa.getAssetId(),null,null,qa.getStoreId()),Za={["callInstanceId"]:Ma.toString(),["controlSolutionId"]:cb,["controlVersion"]:na,["storeType"]:Ja,["ownerStoreType"]:xa,["allowConsentPrompt"]:ia.toString(),["forMSGraphAccess"]:ja.toString(),["allowSignInPrompt"]:D.toString(),["hasAddinAuthChallenge"]:ka.toString(),["securityOriginEqualsSourceLocation"]:Ha.toString(),["singleSignOnEnabled"]:pa.toString(),["accountTypeFilter"]:Z||
""};e.ULS.sendTraceTag(51401115,344,50,"{0}",Za);P.a.sendTelemetryEvent(Object.assign(new T.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:K.a.dD(Za)}));Ma=!0;const va=E.AFrameworkApplication.fa.Ha("HostAuthType");switch(Z){case "aad":Ma="aad"===va;break;case "msa":Ma="msa"===va;break;default:Ma=!Z||"noFilter"===Z}if(Ma){Z=null;if(pa)for(let Fa of this.TWh)if(Fa.sFj(Ga)){Z=Fa;break}Z?this.isSSOAddin(aa)?(pa=!0,"omex"===za&&(pa=!1),"spapp"===za||"spcatalog"===za?(e.ULS.sendTraceTag(594043737,
344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),L.oja(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):ja&&!pa?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),L.oja(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ja&&"exchange"===za&&(ia=!1),this.NWd(aa,Q,ea,za,ia,D,oa,Z,Ba))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),
L.oja(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):L.oja(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else L.oja(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ka){this.zVc(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",ka.message),L.oja(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(aa,Q,ea,ia){this.OWd(aa,ea[I.a.NGd]||null,
ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,Q,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,ia)}NWd(aa,Q,ea,ia,ja,D,pa,Z,oa){this.mib.Jb(aa)?
ia=this.mib.ga(aa):(ia=new G(aa,this.getWebApplicationResource(aa).split(",")[0],ia,this.getDefaultDisplayName(aa)),this.mib.add(aa,ia));const Ba=ia.resource;aa=L.maj(Ba,this.getWebApplicationId(aa));const Ma=OfficeExt.WACUtils.getHostSecure(Q);aa&&Ma?aa.toLowerCase()===Ma.toLowerCase()?ia.NWd(ja,D,ea,pa,Z,oa):(L.q9a('SSO Resource "'+Ba+'" cannot be used from "'+Q+'" origin due to domain mismatch.'),e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),
L.oja(oa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(aa||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Ma||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),L.oja(oa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}zVc(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(aa){return this.eR.getOsfControl(aa)}isSSOAddin(aa){return this.getOsfControl(aa).getManifest().isSSOAddin()}getWebApplicationId(aa){return this.getOsfControl(aa).getManifest().getWebApplicationId()}getWebApplicationResource(aa){return this.getOsfControl(aa).getManifest().getWebApplicationResource()}getDefaultDisplayName(aa){return this.getOsfControl(aa).getManifest().getDefaultDisplayName()}static tdg(){try{const aa=
{};Y.a.xDa&&H.a.u7a&&(aa.UiHostSupportsAuthTokenAddinList=L.lJc);aa.UiHostSupportsAuthToken=H.a.u7a;return aa}catch(aa){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",aa.message)}return null}static getInstance(aa,Q,ea=null){L.Ja||(L.Ja=new L(aa,ea));return L.Ja}static lki(aa){L.Ja&&L.Ja.removeCallbackForAddin(aa)}static q9a(aa){window.console.warn&&window.console.warn(aa)}static maj(aa,Q){if(!aa)return"";Q||(Q="");let ea=aa.toLowerCase();var ia=Q.toLowerCase();
RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(ia)||(L.q9a('SSO App Id "'+Q+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));ea.endsWith(ia)||(L.q9a('SSO Resource "'+aa+'" does not end with App Id "'+Q+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!ea.startsWith("https://")&&!ea.startsWith("api://"))return L.q9a('SSO Resource "'+
aa+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(Q=0;Q<aa.length;Q++){ia=aa.charAt(Q);const ja=M.a.charCodeAt(aa,Q);if(33>ja||126<ja||"&"===ia||"?"===ia||"#"===ia||"%"===ia||"\\"===ia)return L.q9a('SSO Resource "'+aa+'" contains an invalid character "'+ia+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+ia+"' in resource URI."),""}if(0<=aa.indexOf("::"))return L.q9a('SSO Resource "'+aa+'" contains an invalid string "::".'),
e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<aa.length)return L.q9a('SSO Resource "'+aa+'" is '+aa.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+aa.length+"."),"";ea.startsWith("api://")&&(ea="https://"+ea.substring(6,ea.length));return 8===ea.length?"":OfficeExt.WACUtils.getHostSecure(ea)||""}static oja(aa,Q,ea,ia){var ja=aa.startTime;let D=0;0<ja&&(D=L.QE()-ja);ja={["callInstanceId"]:ja.toString(),
["callDuration"]:D.toString(),["errorCode"]:Q.toString()};if(ia)for(let pa in ia)ja[pa]=ia[pa];e.ULS.sendTraceTag(51401116,344,50,"{0}",ja);P.a.sendTelemetryEvent(Object.assign(new T.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:K.a.dD(ja)}));aa.callback(Q,ea)}static QE(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(aa){}return Date.now()}}L.lJc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
L.Ja=null;Object(J.a)(L,"AppsForOfficeSingleSignOnManager",null,[1048])},968:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Mza=this.khb=this.fZd=this.F1d=this.N0b=this.TOe=null}}Object(J.a)(h,"AppsForOfficeOauthResult",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.appforoffice.js.map