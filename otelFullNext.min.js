var otelFull=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"k",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return v}));var r="function",i="object",a="undefined",o="prototype",s="hasOwnProperty",c="default",u=Object,l=u[o],f=u.assign,d=u.create,p=u.defineProperty,v=l[s]},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(0),i=null;function a(e){void 0===e&&(e=!0);var t=!1===e?null:i;return t||(typeof globalThis!==r.l&&(t=globalThis),t||typeof self===r.l||(t=self),t||typeof window===r.l||(t=window),t||typeof global===r.l||(t=global),i=t),t}function o(e){throw new TypeError(e)}function s(e){var t=r.c;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==r.j&&n!==r.h&&o("Object prototype may only be an Object:"+e),i[r.k]=e,new i}},,,function(e,t,n){"use strict";n.r(t);var r,i=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),a=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}(),o=new(function(){function e(){this.externalLogger=new a}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,r){this.externalLogger.sendTraceTag(e,t,n,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.externalLogger.debugAssertTag(e,t,n,r)},e.prototype.shipAssertTag=function(e,t,n,r){this.externalLogger.shipAssertTag(e,t,n,r)},e}());!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}));var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.create;Object.create;var l,f=(l=[],{fireEvent:function(e){l.forEach((function(t){return t(e)}))},addListener:function(e){e&&l.push(e)}});function d(e,t,n){f.fireEvent({level:e,category:t,message:n})}function p(e,t,n){d(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}var v={};function g(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?v[e]?(t.ariaTenantToken&&(v[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(v[e].dnmToken=t.dnmToken)):v[e]=t:d(0,0,(function(){return"Namespace: ".concat(e)}))}function h(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(v[r]){var i=v[r];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var m=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,y=/^[a-zA-Z0-9_\.]{1,95}$/;function T(e){if(!function(e){if(!e||e.length>98)return!1;return m.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!b(t.name))throw new Error("Invalid eventContract");S(t.dataFields)}S(e.dataFields)}function b(e){return y.test(e)}function S(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!b(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}function _(e,t,n){return{name:e,dataType:1,value:t,classification:n||4}}function E(e,t,n){return{name:e,dataType:2,value:t,classification:n||4}}function C(e,t,n){return{name:e,dataType:3,value:t,classification:n||4}}function w(e,t,n){return{name:e,dataType:0,value:t,classification:n||4}}function O(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?u({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var k=function(){function e(e,t,n){var r,i,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=u(u({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.addEventContentType=function(e,t){e.push(E("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=O(e),n=t.telemetryProperties;if((n.nexusTenantToken=-1,!n.ariaTenantToken)&&(!h(t.eventName,n)&&!n.ariaTenantToken))return void d(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendCustomerContent=function(e){var t=O(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=O(e),n=t.telemetryProperties;if(!n.dnmToken&&(!h(t.eventName,n)&&!n.dnmToken))return void d(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):d(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void p(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(n){3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}))}catch(e){}}else d(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift(w("OTelJS.Version","4.13.6")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var a=e.eventContract||{name:"",dataFields:[]};(r=a.dataFields).push.apply(r,this.partAFields),e.eventContract=a}this.config.disableValidation||T(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r[0],a=r[1];this.sendTelemetryEventInternal(i,a)}},e.prototype.setTenantToken=function(e,t,n){g(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){g(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return O(e)},e.prototype.getConfig=function(){return this.config},e}();function P(e,t,n,r){var i=!0;if(t)for(var a=function(t){var a=t.classification,o=t.dataType,s=t.name;if(a&&!(4===a||1===a||2===r&&32===a||3===r&&2048===a))return i=!1,"break";if(3===r&&n&&3!==o&&1!==o&&2!==o&&"OTelJS.Version"!==s&&"OTelJS.Sink"!==s)return d(0,1,(function(){return"DNM: Invalid field type "+s})),i=!1,"break";var c=void 0;c=n?"zC."===s.substr(0,3)?"zC.Data."+s.substr(3):"Data."+s:s;var u=void 0;switch(o){case 3:u=6;break;case 2:u=4;break;case 4:u=8;break;case 0:return e[c]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";case 1:default:return e[c]=t.value,"continue"}var l={value:t.value,propertyType:u};e[c]=l},o=0,s=t;o<s.length;o++){if("break"===a(s[o]))break}return i}function x(e,t){try{return e()}catch(e){return p(1,"1DS Sink",e),t}}function I(e){return e.timestamp?new Date(e.timestamp):new Date}function N(e,t){for(var n=function(n){var r=t[n];if(!r.processEvent(e))return d(2,1,(function(){return"".concat(e.eventName," suppressed by ").concat(r.name)})),{value:!1}},r=0;r<t.length;r++){var i=n(r);if("object"==typeof i)return i.value}return!0}function M(e){d(0,1,(function(){return"Invalid "+e}))}var D=/^((0|[1-9]\d*)\.){0,3}(0|[1-9]\d*)([-+][-+0-9a-zA-Z\.]+)?$/;function A(e,t){return e?e+"."+t:t}function F(e,t,n,r){n&&r.push(w("".concat(A(e,t)),n))}function L(e,t,n,r){"boolean"==typeof n&&r.push(_("".concat(A(e,t)),n))}function U(e,t,n,r){"number"==typeof n&&r.push(E("".concat(A(e,t)),n))}var R,W=function(e){var t=[];return U("Activity.Result","Code",e.code,t),F("Activity.Result","Type",e.type,t),U("Activity.Result","Tag",e.tag,t),L("Activity.Result","IsExpected",e.isExpected,t),t.push(w("zC.Activity.Result","Office.System.Result")),t},B={contractName:"Office.System.Activity",getFields:function(e){var t=[];return F("Activity","CV",e.cV,t),U("Activity","Duration",e.duration,t),U("Activity","Count",e.count,t),U("Activity","AggMode",e.aggMode,t),L("Activity","Success",e.success,t),e.result&&t.push.apply(t,W(e.result)),t.push(w("zC.Activity",this.contractName)),t}},z=function(e){var t=[];return F("User","PrimaryIdentityHash",e.primaryIdentityHash,t),F("User","PrimaryIdentitySpace",e.primaryIdentitySpace,t),F("User","TenantId",e.tenantId,t),F("User","TenantGroup",e.tenantGroup,t),L("User","IsAnonymous",e.isAnonymous,t),t},K=function(e){var t=[];return U("UserAction","Id",e.id,t),F("UserAction","Name",e.name,t),F("UserAction","CommandSurface",e.commandSurface,t),F("UserAction","ParentName",e.parentName,t),F("UserAction","TriggerMethod",e.triggerMethod,t),U("UserAction","TimeOffsetMs",e.timeOffsetMs,t),t},H=function(e){var t=[];return F("App","Name",e.name,t),F("App","Platform",e.platform,t),F("App","Version",e.version,t),t},j=function(e){var t=[];return F("Session","Id",e.id,t),F("Session","EcsETag",e.ecsETag,t),t},V=function(e){var t=[];return F("Release","AudienceGroup",e.audienceGroup,t),t},q=n(0),J=n(5),G=Object,Q=G.getPrototypeOf,X=G.getOwnPropertyNames;var $,Z=("undefined"!=typeof globalThis&&($=globalThis),$||"undefined"==typeof self||($=self),$||"undefined"==typeof window||($=window),$||"undefined"==typeof global||($=global),$||{}),Y=Z.__dynProto$Gbl||(Z.__dynProto$Gbl={o:(R={},R.setInstFuncs=!0,R.useBaseInst=!0,R),n:1e3});function ee(e,t){return e&&G.prototype.hasOwnProperty.call(e,t)}function te(e){return e&&(e===G.prototype||e===Array.prototype)}function ne(e){return te(e)||e===Function.prototype}function re(e){var t;if(e){if(Q)return Q(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);t=e._dyn__proto__||n,ee(e,"_dyn__proto__")||(delete e._dynInstProto,t=e._dyn__proto__=e._dynInstProto||e._dyn__proto__,e._dynInstProto=n)}return t}function ie(e,t){var n=[];if(X)n=X(e);else for(var r in e)"string"==typeof r&&ee(e,r)&&n.push(r);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function ae(e,t,n){return"constructor"!==t&&"function"==typeof e[t]&&(n||ee(e,t))}function oe(e){throw new TypeError("DynamicProto: "+e)}function se(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function ce(e,t,n,r){var i=null;if(e&&ee(n,"_dynClass")){var a=e._dynInstFuncs||{};if((i=(a[n._dynClass]||{})[t])||oe("Missing ["+t+"] function"),!i._dynInstChk&&!1!==a._dynInstChk){for(var o=!ee(e,t),s=re(e),c=[];o&&s&&!ne(s)&&!se(c,s);){var u=s[t];if(u){o=u===r;break}c.push(s),s=re(s)}try{o&&(e[t]=i),i._dynInstChk=1}catch(e){a._dynInstChk=!1}}}return i}function ue(e,t,n){var r=t[e];return r===n&&(r=re(t)[e]),"function"!=typeof r&&oe("["+e+"] is not a function"),r}function le(e,t,n,r,i){if(!te(e)){var a=n._dynInstFuncs=n._dynInstFuncs||{},o=a[t]=a[t]||{};!1!==a._dynInstChk&&(a._dynInstChk=!!i),ie(n,(function(t){ae(n,t,!1)&&n[t]!==r[t]&&(o[t]=n[t],delete n[t],(!ee(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){var r=ce(this,t,e,n)||ue(t,e,n);return r.apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))}))}}function fe(e,t){return ee(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function de(e,t,n,r){ee(e,"prototype")||oe("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){if(Q){for(var n=[],r=re(t);r&&!ne(r)&&!se(n,r);){if(r===e)return!0;n.push(r),r=re(r)}return!1}return!0})(i,t)||oe("["+fe(e)+"] not in hierarchy of ["+fe(t)+"]");var a=null;ee(i,"_dynClass")?a=i._dynClass:(a="_dynCls$"+fe(e,"_")+"$"+Y.n,Y.n++,i._dynClass=a);var o=de._dfOpts,s=!!o.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var c=function(e){var t={};return ie(e,(function(n){!t[n]&&ae(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,r){function i(e,t,n){var i=t[n];if(i._isDynProxy&&r){var a=e._dynInstFuncs||{};!1!==a._dynInstChk&&(i=(a[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var a={};ie(n,(function(e){a[e]=i(t,n,e)}));for(var o=re(e),s=[];o&&!ne(o)&&!se(s,o);)ie(o,(function(e){!a[e]&&ae(o,e,!Q)&&(a[e]=i(t,o,e))})),s.push(o),o=re(o);return a}(i,t,c,s));var u=!!Q&&!!o.setInstFuncs;u&&r&&(u=!!r.setInstFuncs),le(i,a,t,c,!1!==u)}de._dfOpts=Y.o;var pe=q.d,ve=q.b.freeze,ge=(q.b.seal,q.b.keys),he=String[q.k],me=he.trim,ye=he.endsWith,Te=he.startsWith,be=Date[q.k].toISOString,Se=Array.isArray,_e=q.f.toString,Ee=q.e.toString,Ce=Ee.call(q.b),we=/-([a-z])/g,Oe=/([^\w\d_$])/g,ke=/^(\d+[\w\d_$])/,Pe=Object.getPrototypeOf;function xe(e,t){return typeof e===t}function Ie(e){return void 0===e||typeof e===q.l}function Ne(e){return null===e||Ie(e)}function Me(e){return!Ne(e)}function De(e,t){return!(!e||!q.e.call(e,t))}function Ae(e){return!(!e||typeof e!==q.j)}function Fe(e){return!(!e||typeof e!==q.h)}function Le(e){var t=e;return t&&je(t)&&(t=(t=(t=t.replace(we,(function(e,t){return t.toUpperCase()}))).replace(Oe,"_")).replace(ke,(function(e,t){return"_"+t}))),t}function Ue(e,t){if(e)for(var n in e)q.e.call(e,n)&&t.call(e,n,e[n])}function Re(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=ye?e.endsWith(t):function(e,t){var n=!1,r=t?t.length:0,i=e?e.length:0;if(r&&i&&i>=r&&!(n=e===t)){for(var a=i-1,o=r-1;o>=0;o--){if(e[a]!=t[o])return!1;a--}n=!0}return n}(e,t)),n}function We(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Te?e.startsWith(t):function(e,t){var n=!1,r=t?t.length:0;if(e&&r&&e.length>=r&&!(n=e===t)){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function Be(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function ze(e){return!(!e||"[object Date]"!==_e.call(e))}var Ke=Se||function(e){return!(!e||"[object Array]"!==_e.call(e))};function He(e){return!(!e||"[object Error]"!==_e.call(e))}function je(e){return"string"==typeof e}function Ve(e){return"number"==typeof e}function qe(e){return"boolean"==typeof e}function Je(e){var t=!1;if(e&&"object"==typeof e){var n=Pe?Pe(e):function(e){if(e){if(Pe)return Pe(e);var t=e.__proto__||e[q.k]||e.constructor;if(t)return t}return null}(e);n?(n.constructor&&q.e.call(n,"constructor")&&(n=n.constructor),t=typeof n===q.h&&Ee.call(n)===Ce):t=!0}return t}function Ge(e){if(e)return be?e.toISOString():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function Qe(e,t,n){var r=e.length;try{for(var i=0;i<r&&(!(i in e)||-1!==t.call(n||e,e[i],i,e));i++);}catch(e){}}function Xe(e,t,n){if(e){if(e.indexOf)return e.indexOf(t,n);var r=e.length,i=n||0;try{for(var a=Math.max(i>=0?i:r-Math.abs(i),0);a<r;a++)if(a in e&&e[a]===t)return a}catch(e){}}return-1}function $e(e,t,n){var r;if(e){if(e.map)return e.map(t,n);var i=e.length,a=n||e;r=new Array(i);try{for(var o=0;o<i;o++)o in e&&(r[o]=t.call(a,e[o],e))}catch(e){}}return r}function Ze(e,t,n){var r;if(e){if(e.reduce)return e.reduce(t,n);var i=e.length,a=0;if(arguments.length>=3)r=arguments[2];else{for(;a<i&&!(a in e);)a++;r=e[a++]}for(;a<i;)a in e&&(r=t(r,e[a],a,e)),a++}return r}function Ye(e){return e&&(e=me&&e.trim?e.trim():e.replace?e.replace(/^\s+|(?=\s)\s+$/g,""):e),e}var et=!{toString:null}.propertyIsEnumerable("toString"),tt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function nt(e){var t=typeof e;if(t===q.h||t===q.j&&null!==e||Object(J.c)("objKeys called on non-object"),!et&&ge)return ge(e);var n=[];for(var r in e)e&&q.e.call(e,r)&&n.push(r);if(et)for(var i=tt.length,a=0;a<i;a++)e&&q.e.call(e,tt[a])&&n.push(tt[a]);return n}function rt(e,t,n,r){if(pe)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),pe(e,t,i),!0}catch(e){}return!1}function it(e){return e}function at(e){return ve&&Ue(e,(function(e,t){(Ke(t)||Ae(t))&&ve(t)})),ot(e)}var ot=ve||it;function st(){var e=Date;return e.now?e.now():(new e).getTime()}function ct(e){return He(e)?e.name:""}function ut(e,t,n,r,i){var a=n;return e&&((a=e[t])===n||i&&!i(a)||r&&!r(n)||(a=n,e[t]=a)),a}function lt(e,t,n){var r;return e?!(r=e[t])&&Ne(r)&&(r=Ie(n)?{}:n,e[t]=r):r=Ie(n)?{}:n,r}function ft(e,t){return Ne(e)?t:e}function dt(e){return!!e}function pt(e){throw new Error(e)}function vt(e,t){var n=null,r=null;return Fe(e)?n=e:r=e,function(){var e=arguments;if(n&&(r=n()),r)return r[t].apply(r,e)}}function gt(e,t,n,r,i){e&&t&&n&&(!1!==i||Ie(e[t]))&&(e[t]=vt(n,r))}function ht(e,t,n,r){return e&&t&&Ae(e)&&Ke(n)&&Qe(n,(function(n){je(n)&&gt(e,n,t,n,r)})),e}function mt(e){return e&&q.a&&(e=Object(q.b)(Object(q.a)({},e))),e}function yt(e,t,n,r,i,a){var o=arguments,s=o[0]||{},c=o.length,u=!1,l=1;for(c>0&&qe(s)&&(u=s,s=o[l]||{},l++),Ae(s)||(s={});l<c;l++){var f=o[l],d=Ke(f),p=Ae(f);for(var v in f){var g=d&&v in f||p&&q.e.call(f,v);if(g){var h=f[v],m=void 0;if(u&&h&&((m=Ke(h))||Je(h))){var y=s[v];m?Ke(y)||(y=[]):Je(y)||(y={}),h=yt(u,y,h)}void 0!==h&&(s[v]=h)}}}return s}var Tt=null,bt=null,St=!1,_t=null,Et=null;function Ct(e,t){var n=!1;if(e){try{if(!(n=t in e)){var r=e[q.k];r&&(n=t in r)}}catch(e){}if(!n)try{n=!Ie((new e)[t])}catch(e){}}return n}function wt(e){var t=Object(J.a)();return t&&t[e]?t[e]:"window"===e&&Ot()?window:null}function Ot(){return Boolean(typeof window===q.j&&window)}function kt(){return Ot()?window:wt("window")}function Pt(){return Boolean(typeof document===q.j&&document)?document:wt("document")}function xt(){return Boolean(typeof navigator===q.j&&navigator)}function It(){return xt()?navigator:wt("navigator")}function Nt(e){if(e&&St){var t=wt("__mockLocation");if(t)return t}return typeof location===q.j&&location?location:wt("location")}function Mt(){return wt("performance")}function Dt(){return Boolean(typeof JSON===q.j&&JSON||null!==wt("JSON"))}function At(){return Dt()?JSON||wt("JSON"):null}function Ft(){var e=It();return!(!e||!e.product)&&"ReactNative"===e.product}function Lt(){var e=It();if(e&&(e.userAgent!==bt||null===Tt)){var t=((bt=e.userAgent)||"").toLowerCase();Tt=Be(t,"msie")||Be(t,"trident/")}return Tt}function Ut(e){var t=Object[q.k].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":Dt()&&(n=At().stringify(e)),t+n}function Rt(){return null===Et&&(Et=xt()&&Boolean(It().sendBeacon)),Et}function Wt(e){var t=!1;try{t=!!wt("fetch");var n=wt("Request");t&&e&&n&&(t=Ct(n,"keepalive"))}catch(e){}return t}function Bt(){return null===_t&&(_t=typeof XDomainRequest!==q.l)&&zt()&&(_t=_t&&!Ct(wt("XMLHttpRequest"),"withCredentials")),_t}function zt(){var e=!1;try{e=!!wt("XMLHttpRequest")}catch(e){}return e}var Kt,Ht=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],jt=null;function Vt(e,t){return function(){var n=arguments,r=qt(t);if(r){var i=r.listener;i&&i[e]&&i[e].apply(i,n)}}}function qt(e){var t,n=jt;return n||!0===e.disableDbgExt||(n=jt||((t=wt("Microsoft"))&&(jt=t.ApplicationInsights),jt)),n?n.ChromeDbgExt:null}function Jt(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function Gt(e,t){var n=typeof console!==q.l?console:wt("console");if(n){var r="log";n[e]&&(r=e),Fe(n[r])&&n[r](t)}}var Qt=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var i="";Dt()&&(i=At().stringify(r));var a=(t?" message:"+Jt(t):"")+(r?" props:"+Jt(i):"");this.message+=a}return e.dataType="MessageData",e}();var Xt=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,r,i,a,o=0,s={};de(e,this,(function(e){function c(t,n){if(!(o>=i)){var a=!0,c="AITR_"+n.messageId;if(s[c]?a=!1:s[c]=!0,a&&(t<=r&&(e.queue.push(n),o++,u(1===t?"error":"warn",n)),o===i)){var l="Internal events throttle limit per PageView reached for this app.",f=new Qt(23,l,!1);e.queue.push(f),1===t?e.errorToConsole(l):e.warnToConsole(l)}}}function u(e,n){var r=qt(t||{});r&&r.diagLog&&r.diagLog(e,n)}!function(e){n=ft(e.loggingLevelConsole,0),r=ft(e.loggingLevelTelemetry,1),i=ft(e.maxMessageLimit,25),a=ft(e.enableDebugExceptions,!1)}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return r},e.maxInternalMessageLimit=function(){return i},e.enableDebugExceptions=function(){return a},e.throwInternal=function(t,r,i,o,l){void 0===l&&(l=!1);var f=new Qt(r,i,l,o);if(a)throw Ut(f);var d=1===t?"errorToConsole":"warnToConsole";if(Ie(f.message))u("throw"+(1===t?"Critical":"Warning"),f);else{if(l){var p=+f.messageId;!s[p]&&n>=t&&(e[d](f.message),s[p]=!0)}else n>=t&&e[d](f.message);c(t,f)}},e.warnToConsole=function(e){Gt("warn",e),u("warning",e)},e.errorToConsole=function(e){Gt("error",e),u("error",e)},e.resetInternalMessageCount=function(){o=0,s={}},e.logInternalMessage=c}))}return e.__ieDyn=1,e}();function $t(e){return e||new Xt}function Zt(e,t,n,r,i,a){void 0===a&&(a=!1),$t(e).throwInternal(t,n,r,i,a)}function Yt(e,t){$t(e).warnToConsole(t)}var en=null,tn=null,nn=null,rn=Pt(),an={},on={};function sn(e,t){var n=ln._ckMgr||on._ckMgr;return n||(n=ln._ckMgr=ln(e,t),on._ckMgr=n),n}function cn(e){return!e||e.isEnabled()}function un(e,t){return!!(t&&e&&Ke(e.ignoreCookies))&&-1!==e.ignoreCookies.indexOf(t)}function ln(e,t){var n,r=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(ut(t,"domain",e.cookieDomain,Me,Ne),ut(t,"path",e.cookiePath||"/",null,Ne),Ne(t.enabled)){var n=void 0;Ie(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),Ie(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||on),i=r.path||"/",a=r.domain,o=!1!==r.enabled,s=((n={isEnabled:function(){var e=o&&fn(t),n=on._ckMgr;return e&&n&&s!==n&&(e=cn(n)),e}}).setEnabled=function(e){o=!1!==e},n.set=function(e,t,n,o,c){var u=!1;if(cn(s)&&!function(e,t){return!!(t&&e&&Ke(e.blockedCookies)&&-1!==e.blockedCookies.indexOf(t))||un(e,t)}(r,e)){var l={},f=Ye(t||""),d=f.indexOf(";");if(-1!==d&&(f=Ye(t.substring(0,d)),l=dn(t.substring(d+1))),ut(l,"domain",o||a,dt,Ie),!Ne(n)){var p=Lt();if(Ie(l.expires)){var v=st()+1e3*n;if(v>0){var g=new Date;g.setTime(v),ut(l,"expires",pn(g,p?"toGMTString":"toUTCString")||pn(g,p?"toGMTString":"toUTCString")||"",dt)}}p||ut(l,"max-age",""+n,null,Ie)}var h=Nt();h&&"https:"===h.protocol&&(ut(l,"secure",null,null,Ie),null===tn&&(tn=!mn((It()||{}).userAgent)),tn&&ut(l,"SameSite","None",null,Ie)),ut(l,"path",c||i,null,Ie),(r.setCookie||hn)(e,vn(f,l)),u=!0}return u},n.get=function(e){var t="";return cn(s)&&!un(r,e)&&(t=(r.getCookie||gn)(e)),t},n.del=function(e,t){var n=!1;return cn(s)&&(n=s.purge(e,t)),n},n.purge=function(e,n){var i,a=!1;if(fn(t)){var o=((i={}).path=n||"/",i.expires="Thu, 01 Jan 1970 00:00:01 GMT",i);Lt()||(o["max-age"]="0"),(r.delCookie||hn)(e,vn("",o)),a=!0}return a},n);return s._ckMgr=s,s}function fn(e){if(null===en){en=!1;try{en=void 0!==(rn||{}).cookie}catch(t){Zt(e,2,68,"Cannot access document.cookie - "+ct(t),{exception:Ut(t)})}}return en}function dn(e){var t={};e&&e.length&&Qe(Ye(e).split(";"),(function(e){if(e=Ye(e||"")){var n=e.indexOf("=");-1===n?t[e]=null:t[Ye(e.substring(0,n))]=Ye(e.substring(n+1))}}));return t}function pn(e,t){return Fe(e[t])?e[t]():null}function vn(e,t){var n=e||"";return Ue(t,(function(e,t){n+="; "+e+(Ne(t)?"":"="+t)})),n}function gn(e){var t="";if(rn){var n=rn.cookie||"";nn!==n&&(an=dn(n),nn=n),t=Ye(an[e]||"")}return t}function hn(e,t){rn&&(rn.cookie=e+"="+t)}function mn(e){return!!je(e)&&(!(!Be(e,"CPU iPhone OS 12")&&!Be(e,"iPad; CPU OS 12"))||(!!(Be(e,"Macintosh; Intel Mac OS X 10_14")&&Be(e,"Version/")&&Be(e,"Safari"))||(!(!Be(e,"Macintosh; Intel Mac OS X 10_14")||!Re(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!Be(e,"Chrome/5")&&!Be(e,"Chrome/6"))||(!(!Be(e,"UnrealEngine")||Be(e,"Chrome"))||!(!Be(e,"UCBrowser/12")&&!Be(e,"UCBrowser/11")))))))}var yn=!1,Tn=123456789,bn=987654321;function Sn(e){e<0&&(e>>>=0),Tn=123456789+e&4294967295,bn=987654321-e&4294967295,yn=!0}function _n(){try{var e=2147483647&st();Sn((4294967296*Math.random()^e)+e)}catch(e){}}function En(e){return e>0?Math.floor(Cn()/4294967295*(e+1))>>>0:0}function Cn(e){var t=0,n=wt("crypto")||wt("msCrypto");return n&&n.getRandomValues&&(t=4294967295&n.getRandomValues(new Uint32Array(1))[0]),0===t&&Lt()&&(yn||_n(),t=4294967295&On()),0===t&&(t=Math.floor(4294967296*Math.random()|0)),e||(t>>>=0),t}function wn(e){e?Sn(e):_n()}function On(e){var t=((bn=36969*(65535&bn)+(bn>>16)&4294967295)<<16)+(65535&(Tn=18e3*(65535&Tn)+(Tn>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t}function kn(e){void 0===e&&(e=22);for(var t=Cn()>>>0,n=0,r="";r.length<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Cn()<<2&4294967295|3&t)>>>0,n=0);return r}var Pn=q.d,xn="."+kn(6),In=0;function Nn(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function Mn(e,t){var n=t[e.id];if(!n){n={};try{Nn(t)&&(function(e,t,n){if(Pn)try{return Pn(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}function Dn(e,t){return void 0===t&&(t=!1),Le(e+In+++(t?".2.8.9":"")+xn)}function An(e){var t={id:Dn("_aiData-"+(e||"")+".2.8.9"),accept:function(e){return Nn(e)},get:function(e,n,r,i){var a=e[t.id];return a?a[Le(n)]:(i&&((a=Mn(t,e))[Le(n)]=r),r)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var Fn=Dn("aiEvtPageHide"),Ln=Dn("aiEvtPageShow"),Un=/\.[\.]+/g,Rn=/[\.]+$/,Wn=1,Bn=An("events"),zn=/^([^.]*)(?:\.(.+)|)/;function Kn(e){return e&&e.replace?e.replace(/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,""):e}function Hn(e,t){var n;if(t){var r="";Ke(t)?(r="",Qe(t,(function(e){(e=Kn(e))&&("."!==e[0]&&(e="."+e),r+=e)}))):r=Kn(t),r&&("."!==r[0]&&(r="."+r),e=(e||"")+r)}var i=zn.exec(e||"")||[];return(n={}).type=i[1],n.ns=(i[2]||"").replace(Un,".").replace(Rn,"").split(".").sort().join("."),n}function jn(e,t,n){void 0===n&&(n=!0);var r=Bn.get(e,"events",{},n),i=r[t];return i||(i=r[t]=[]),i}function Vn(e,t,n,r){e&&t&&t.type&&(e.removeEventListener?e.removeEventListener(t.type,n,r):e.detachEvent&&e.detachEvent("on"+t.type,n))}function qn(e,t,n,r){for(var i=t.length;i--;){var a=t[i];a&&(n.ns&&n.ns!==a.evtName.ns||r&&!r(a)||(Vn(e,a.evtName,a.handler,a.capture),t.splice(i,1)))}}function Jn(e,t){return t?Hn("xx",Ke(t)?[e].concat(t):[e,t]).ns.split("."):e}function Gn(e,t,n,r,i){var a;void 0===i&&(i=!1);var o=!1;if(e)try{var s=Hn(t,r);if((o=function(e,t,n,r){var i=!1;return e&&t&&t.type&&n&&(e.addEventListener?(e.addEventListener(t.type,n,r),i=!0):e.attachEvent&&(e.attachEvent("on"+t.type,n),i=!0)),i}(e,s,n,i))&&Bn.accept(e)){var c=((a={guid:Wn++,evtName:s}).handler=n,a.capture=i,a);jn(e,s.type).push(c)}}catch(e){}return o}function Qn(e,t,n,r,i){if(void 0===i&&(i=!1),e)try{var a=Hn(t,r),o=!1;!function(e,t,n){if(t.type)qn(e,jn(e,t.type),t,n);else{var r=Bn.get(e,"events",{});Ue(r,(function(r,i){qn(e,i,t,n)})),0===nt(r).length&&Bn.kill(e,"events")}}(e,a,(function(e){return!((!a.ns||n)&&e.handler!==n)&&(o=!0,!0)})),o||Vn(e,a,n,i)}catch(e){}}function Xn(e,t,n){var r=!1,i=kt();i&&(r=Gn(i,e,t,n),r=Gn(i.body,e,t,n)||r);var a=Pt();return a&&(r=Gn(a,e,t,n)||r),r}function $n(e,t,n,r){var i=!1;return t&&e&&e.length>0&&Qe(e,(function(e){e&&(n&&-1!==Xe(n,e)||(i=Xn(e,t,r)||i))})),i}function Zn(e,t,n){e&&Ke(e)&&Qe(e,(function(e){e&&function(e,t,n){var r=kt();r&&(Qn(r,e,t,n),Qn(r.body,e,t,n));var i=Pt();i&&Qn(i,e,t,n)}(e,t,n)}))}function Yn(e,t,n){return function(e,t,n,r){var i=!1;return t&&e&&Ke(e)&&!(i=$n(e,t,n,r))&&n&&n.length>0&&(i=$n(e,t,null,r)),i}(["beforeunload","unload","pagehide"],e,t,n)}var er,tr=null;q.l;function nr(){var e=ir();return e.substring(0,8)+"-"+e.substring(8,12)+"-"+e.substring(12,16)+"-"+e.substring(16,20)+"-"+e.substring(20)}function rr(){var e=Mt();return e&&e.now?e.now():st()}function ir(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<4;r++)n+=t[15&(e=Cn())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Cn())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)}var ar={_canUseCookies:void 0,isTypeof:xe,isUndefined:Ie,isNullOrUndefined:Ne,hasOwnProperty:De,isFunction:Fe,isObject:Ae,isDate:ze,isArray:Ke,isError:He,isString:je,isNumber:Ve,isBoolean:qe,toISOString:Ge,arrForEach:Qe,arrIndexOf:Xe,arrMap:$e,arrReduce:Ze,strTrim:Ye,objCreate:J.b,objKeys:nt,objDefineAccessors:rt,addEventHandler:Xn,dateNow:st,isIE:Lt,disableCookies:function(){or().setEnabled(!1)},newGuid:nr,perfNow:rr,newId:kn,randomValue:En,random32:Cn,mwcRandomSeed:wn,mwcRandom32:On,generateW3CId:ir};function or(e,t){var n=sn(e,t),r=ar._canUseCookies;return null===tr&&(tr=[],er=r,rt(ar,"_canUseCookies",(function(){return er}),(function(e){er=e,Qe(tr,(function(t){t.setEnabled(e)}))}))),-1===Xe(tr,n)&&tr.push(n),qe(r)&&n.setEnabled(r),qe(er)&&n.setEnabled(er),n}var sr,cr=n(11);function ur(e){var t={};return Ue(e,(function(e,n){t[e]=n,t[n]=e})),at(t)}var lr,fr="Failed",dr="Track",pr="Storage",vr=(ur({CRITICAL:1,WARNING:2}),ur(((sr={})["BrowserDoesNotSupportLocal"+pr]=0,sr["BrowserCannotReadLocal"+pr]=1,sr["BrowserCannotReadSession"+pr]=2,sr["BrowserCannotWriteLocal"+pr]=3,sr["BrowserCannotWriteSession"+pr]=4,sr["BrowserFailedRemovalFromLocal"+pr]=5,sr["BrowserFailedRemovalFromSession"+pr]=6,sr.CannotSendEmptyTelemetry=7,sr.ClientPerformanceMathError=8,sr.ErrorParsingAISessionCookie=9,sr.ErrorPVCalc=10,sr.ExceptionWhileLoggingError=11,sr.FailedAddingTelemetryToBuffer=12,sr.FailedMonitorAjaxAbort=13,sr.FailedMonitorAjaxDur=14,sr.FailedMonitorAjaxOpen=15,sr.FailedMonitorAjaxRSC=16,sr.FailedMonitorAjaxSend=17,sr.FailedMonitorAjaxGetCorrelationHeader=18,sr.FailedToAddHandlerForOnBeforeUnload=19,sr.FailedToSendQueuedTelemetry=20,sr.FailedToReportDataLoss=21,sr.FlushFailed=22,sr.MessageLimitPerPVExceeded=23,sr.MissingRequiredFieldSpecification=24,sr.NavigationTimingNotSupported=25,sr.OnError=26,sr.SessionRenewalDateIsZero=27,sr.SenderNotInitialized=28,sr.StartTrackEventFailed=29,sr.StopTrackEventFailed=30,sr["Start"+dr+fr]=31,sr["Stop"+dr+fr]=32,sr.TelemetrySampledAndNotSent=33,sr[dr+"Event"+fr]=34,sr[dr+"Exception"+fr]=35,sr[dr+"Metric"+fr]=36,sr[dr+"PV"+fr]=37,sr.TrackPVFailedCalc=38,sr[dr+"Trace"+fr]=39,sr.TransmissionFailed=40,sr[fr+"ToSet"+pr+"Buffer"]=41,sr[fr+"ToRestore"+pr+"Buffer"]=42,sr.InvalidBackendResponse=43,sr.FailedToFixDepricatedValues=44,sr.InvalidDurationValue=45,sr.TelemetryEnvelopeInvalid=46,sr.CreateEnvelopeError=47,sr.CannotSerializeObject=48,sr.CannotSerializeObjectNonSerializable=49,sr.CircularReferenceDetected=50,sr.ClearAuthContextFailed=51,sr.ExceptionTruncated=52,sr.IllegalCharsInName=53,sr.ItemNotInArray=54,sr.MaxAjaxPerPVExceeded=55,sr.MessageTruncated=56,sr.NameTooLong=57,sr.SampleRateOutOfRange=58,sr.SetAuthContextFailed=59,sr.SetAuthContextFailedAccountName=60,sr.StringValueTooLong=61,sr.StartCalledMoreThanOnce=62,sr.StopCalledWithoutStart=63,sr.TelemetryInitializerFailed=64,sr.TrackArgumentsNotSpecified=65,sr.UrlTooLong=66,sr.SessionStorageBufferFull=67,sr.CannotAccessCookie=68,sr.IdTooLong=69,sr.InvalidEvent=70,sr.FailedMonitorAjaxSetRequestHeader=71,sr.SendBrowserInfoOnUserInit=72,sr.PluginException=73,sr.NotificationException=74,sr.SnippetScriptLoadFailure=99,sr.InvalidInstrumentationKey=100,sr.CannotParseAiBlobValue=101,sr.InvalidContentBlob=102,sr[dr+"PageActionEvent"+fr]=103,sr.FailedAddingCustomDefinedRequestContext=104,sr.InMemoryStorageBufferFull=105,sr.InstrumentationKeyDeprecation=106,sr))),gr=(ur({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),ur({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),ur({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}));ur({Normal:1,Critical:2}),ur({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),ot(Object(cr.a)(Object(cr.a)({},vr),ur({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520})));!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(lr||(lr={}));var hr=function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var r=[],i=!1,a=!0,o={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return i||10===t||110===t||120===t}},s={},c=nr();this.init=function(){return a=a&&function(e){function t(t){return"string"==typeof e[t]||(M(t),!1)}var n=t("App.Name")&&t("App.Version")&&t("App.Platform")&&t("Session.Id"),r=e["User.IsAnonymous"];if(!1!==r&&void 0!==r||(n=n&&t("User.PrimaryIdentityHash")&&t("User.PrimaryIdentitySpace")),!n)return n;var i=e["App.Version"];D.test(i)||(M("App.Version"),n=!1);var a=/^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$/,o=e["User.TenantId"];return!o||t("User.TenantId")&&a.test(o)||(M("User.TenantId"),n=!1),a.test(e["Session.Id"])||(M("Session.Id"),n=!1),n}(s)},this.getOneDSTelemetryEvent=function(e){return u(e,{eventType:1})},this.getOneDSCustomerContent=function(e){var t=e.telemetryProperties.customerContentVersion;if(t&&Math.floor(t)<=2&&1===e.telemetryProperties.customerContentType)return u(e,{eventType:2})};var u=function(e,t){var i=O(e);if(N(i,r)){var a=I(i).toISOString(),o={"Event.Name":i.eventName,"Event.Source":"OTelJS","Event.Time":{value:a,propertyType:gr.DateTime}};for(var u in n.eventsProcessed++,o["Event.Sequence"]={value:n.eventsProcessed,propertyType:gr.Int64},o["Event.Id"]=c+"."+n.eventsProcessed,s)o[u]=s[u];if(!P(o,i.dataFields,!0,t.eventType))return void d(0,1,(function(){return"Dropping Event: "+i.eventName}));var l="custom";i.eventContract&&(i.eventContract.name&&(o["Event.Contract"]=i.eventContract.name,l+="."+i.eventContract.name.toLowerCase().replace(/\./g,"_")),P(o,i.eventContract.dataFields,!1,t.eventType));var f=function(e,t){return 2===t?"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121":e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void d(0,1,(function(){return"Missing Aria Token"}))}(i,t.eventType);if(!f)return;return{iKey:f,name:i.eventName,data:o,time:a,baseType:l,ext:{sdk:{seq:n.eventsProcessed}}}}};this.addPreprocessor=function(e){r.push(e)},this.getOneDSPersistentDataFields=function(){return s},this.getPreprocessors=function(){return r};var l=function(e){P(s,e,!1,1)};this.addPersistentDataFields=l,this.setOptionalEventsEnabled=function(e){i=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(i=!0),l(e);var f=t.coreFields;if(f){l(H(f.app)),l(z(f.user)),l(j(f.session));var p=f.release;p&&l(V(p))}this.addPreprocessor(o)},mr=null,yr=function(){function e(t,n,r){var i,a=this,o=!1;(a.start=st(),a.name=t,a.isAsync=r,a.isChildEvt=function(){return!1},Fe(n))&&(o=rt(a,"payload",(function(){return!i&&Fe(n)&&(i=n(),n=null),i})));a.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?a[t]:(a.ctx||{})[t]:null},a.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)a[t]||(a.isChildEvt=function(){return!0}),a[t]=n;else if(t===e.ChildrenContextKey)a[t]=n;else{(a.ctx=a.ctx||{})[t]=n}},a.complete=function(){var t=0,r=a.getCtx(e.ChildrenContextKey);if(Ke(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(t+=s.time)}a.time=st()-a.start,a.exTime=a.time-t,a.complete=function(){},!o&&Fe(n)&&(a.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Tr=function(){function e(t){this.ctx={},de(e,this,(function(e){e.create=function(e,t,n){return new yr(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&Fe(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))}return e.__ieDyn=1,e}();function br(e,t,n,r,i){if(e){var a=e;if(a.getPerfMgr&&(a=a.getPerfMgr()),a){var o=void 0,s=a.getCtx("CoreUtils.doPerf");try{if(o=a.create(t(),r,i)){if(s&&o.setCtx&&(o.setCtx(yr.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(yr.ChildrenContextKey);c||(c=[],s.setCtx(yr.ChildrenContextKey,c)),c.push(o)}return a.setCtx("CoreUtils.doPerf",o),n(o)}}catch(e){o&&o.setCtx&&o.setCtx("exception",e)}finally{o&&a.fire(o),a.setCtx("CoreUtils.doPerf",s)}}}return n()}var Sr="00000000000000000000000000000000";function _r(e,t,n){return!(!e||e.length!==t||e===n)&&!!e.match(/^[\da-f]*$/)}function Er(e){return _r(e,32,Sr)}function Cr(e){return _r(e,16,"0000000000000000")}var wr=An("plugin");function Or(e){return wr.get(e,"state",{},!0)}function kr(e,t){for(var n,r=[],i=null,a=e.getNext();a;){var o=a.getPlugin();if(o){i&&Fe(i.setNextPlugin)&&Fe(o.processTelemetry)&&i.setNextPlugin(o);(Fe(o.isInitialized)?o.isInitialized():(n=Or(o)).isInitialized)||r.push(o),i=o,a=a.getNext()}}Qe(r,(function(r){var i=e.core();r.initialize(e.getCfg(),i,t,e.getNext()),n=Or(r),r.core||n.core||(n.core=i),n.isInitialized=!0,delete n.teardown}))}function Pr(e){return e.sort((function(e,t){var n=0;if(t){var r=Fe(t.processTelemetry);Fe(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1)}else n=e?1:-1;return n}))}var xr=0;function Ir(e,t,n,r){var i=null,a=[];null!==r&&(i=r?function(e,t,n){for(;e;){if(e.getPlugin()===n)return e;e=e.getNext()}return Ar([n],t.config||{},t)}(e,n,r):e);var o={_next:function(){var e=i;if(i=e?e.getNext():null,!e){var t=a;t&&t.length>0&&(Qe(t,(function(e){try{e.func.call(e.self,e.args)}catch(e){Zt(n.logger,2,73,"Unexpected Exception during onComplete - "+Ut(e))}})),a=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{}).logger||new Xt(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,r){void 0===r&&(r=!1);var i,a=s(e,null);a&&!Ne(a[n])?i=a[n]:t&&!Ne(t[n])&&(i=t[n]);return Ne(i)?r:i},hasNext:function(){return!!i},getNext:function(){return i},setNext:function(e){i=e},iterate:function(e){var t;for(;t=o._next();){var n=t.getPlugin();n&&e(n)}},onComplete:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];e&&a.push({func:e,self:Ie(t)?o.ctx:t,args:n})}}};function s(e,n,r){var i;if(void 0===n&&(n={}),void 0===r&&(r=0),t){var a=t.extensionConfig;a&&e&&(i=a[e])}if(i){if(Ae(n)&&0!==r){var o=yt(!0,n,i);t&&2===r&&Ue(n,(function(e){if(Ne(o[e])){var n=t[e];Ne(n)||(o[e]=n)}})),i=o}}else i=n;return i}return o}function Nr(e,t,n,r){var i=Ir(e,t,n,r),a=i.ctx;return a.processNext=function(e){var t=i._next();return t&&t.processTelemetry(e,a),!t},a.createNew=function(e,r){return void 0===e&&(e=null),Ke(e)&&(e=Ar(e,t,n,r)),Nr(e||a.getNext(),t,n,r)},a}function Mr(e,t,n){var r=t.config||{},i=Ir(e,r,t,n),a=i.ctx;return a.processNext=function(e){var t=i._next();return t&&t.unload(a,e),!t},a.createNew=function(e,n){return void 0===e&&(e=null),Ke(e)&&(e=Ar(e,r,t,n)),Mr(e||a.getNext(),t,n)},a}function Dr(e,t,n){var r=t.config||{},i=Ir(e,r,t,n).ctx;return i.processNext=function(e){return i.iterate((function(t){Fe(t.update)&&t.update(i,e)}))},i.createNew=function(e,n){return void 0===e&&(e=null),Ke(e)&&(e=Ar(e,r,t,n)),Dr(e||i.getNext(),t,n)},i}function Ar(e,t,n,r){var i=null,a=!r;if(Ke(e)&&e.length>0){var o=null;Qe(e,(function(e){if(a||r!==e||(a=!0),a&&e&&Fe(e.processTelemetry)){var s=function(e,t,n){var r,i=null,a=Fe(e.processTelemetry),o=Fe(e.setNextPlugin);r=e?e.identifier+"-"+e.priority+"-"+xr++:"Unknown-0-"+xr++;var s={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:function(t,n){u(n=n||c(),(function(n){if(!e||!a)return!1;var r=Or(e);if(r.teardown||r.disabled)return!1;o&&e.setNextPlugin(i);return e.processTelemetry(t,n),!0}),"processTelemetry",(function(){return{item:t}}),!t.sync)||n.processNext(t)},unload:function(t,n){u(t,(function(){var r=!1;if(e){var i=Or(e),a=e.core||i.core;!e||a&&a!==t.core()||i.teardown||(i.core=null,i.teardown=!0,i.isInitialized=!1,e.teardown&&!0===e.teardown(t,n)&&(r=!0))}return r}),"unload",(function(){}),n.isAsync)||t.processNext(n)},update:function(t,n){u(t,(function(){var r=!1;if(e){var i=Or(e),a=e.core||i.core;!e||a&&a!==t.core()||i.teardown||e.update&&!0===e.update(t,n)&&(r=!0)}return r}),"update",(function(){}),!1)||t.processNext(n)},_id:r,_setNext:function(e){i=e}};function c(){var r;return e&&Fe(e._getTelCtx)&&(r=e._getTelCtx()),r||(r=Nr(s,t,n)),r}function u(t,n,a,o,s){var c=!1,u=e?e.identifier:"TelemetryPluginChain",l=t._hasRun;return l||(l=t._hasRun={}),t.setNext(i),e&&br(t.core(),(function(){return u+":"+a}),(function(){l[r]=!0;try{var e=i?i._id:"";e&&(l[e]=!1),c=n(t)}catch(e){var o=!i||l[i._id];o&&(c=!0),i&&o||Zt(t.diagLog(),1,73,"Plugin ["+u+"] failed during "+a+" - "+Ut(e)+", run flags: "+Ut(l))}}),o,s),c}return ot(s)}(e,t,n);i||(i=s),o&&o._setNext(s),o=s}}))}return r&&!i?Ar([r],t,n):i}function Fr(e,t,n){t&&Ke(t)&&t.length>0&&(Qe(t=t.sort((function(e,t){return e.priority-t.priority})),(function(e){e.priority<500&&pt("Channel has invalid priority - "+e.identifier)})),e.push({queue:ot(t),chain:Ar(t,n.config,n)}))}function Lr(){var e=[];return{add:function(t){t&&e.push(t)},run:function(t,n){Qe(e,(function(e){try{e(t,n)}catch(e){Zt(t.diagLog(),2,73,"Unexpected error calling unload handler - "+Ut(e))}})),e=[]}}}var Ur=function(){function e(){var t,n,r,i,a,o=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var i=n||Nr(null,{},o.core);t=r&&r.getPlugin?i.createNew(null,r.getPlugin):i.createNew(null,r)}return t}function c(e,t,i){e&&ut(e,"extensionConfig",[],null,Ne),!i&&t&&(i=t.getProcessTelContext().getNext());var a=r;r&&r.getPlugin&&(a=r.getPlugin()),o.core=t,n=Nr(i,e,t,a)}function u(){t=!1,o.core=null,n=null,r=null,a=[],i=Lr()}u(),de(e,o,(function(e){e.initialize=function(e,n,r,i){c(e,n,i),t=!0},e.teardown=function(t,n){var o,s=e.core;if(s&&(!t||s===t.core())){var c,l=!1,f=t||Mr(null,s,r&&r.getPlugin?r.getPlugin():r),d=n||((o={reason:0}).isAsync=!1,o);return e._doTeardown&&!0===e._doTeardown(f,d,p)?c=!0:p(),c}function p(){if(!l){l=!0,i.run(f,n);var e=a;a=[],Qe(e,(function(e){e.rm()})),!0===c&&f.processNext(d),u()}}},e.update=function(t,n){var i=e.core;if(i&&(!t||i===t.core())){var a,o=!1,s=t||Dr(null,i,r&&r.getPlugin?r.getPlugin():r),u=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,u,l)?a=!0:l(),a}function l(){o||(o=!0,c(s.getCfg(),s.core(),s.getNext()))}},e._addHook=function(e){e&&(Ke(e)?a=a.concat(e):a.push(e))},gt(e,"_addUnloadCb",(function(){return i}),"add")})),o.diagLog=function(e){return s(e).diagLog()},o.isInitialized=function(){return t},o.setInitialized=function(e){t=e},o.setNextPlugin=function(e){r=e},o.processNext=function(e,t){t?t.processNext(e):r&&Fe(r.processTelemetry)&&r.processTelemetry(e,null)},o._getTelCtx=s}return e.__ieDyn=1,e}(),Rr=function(e){function t(){var n,r,i=e.call(this)||this;function a(){n=0,r=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,a(),de(t,i,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return r.push(t),{remove:function(){Qe(r,(function(e,n){if(e.id===t.id)return r.splice(n,1),-1}))}}},e.processTelemetry=function(t,n){for(var i=!1,a=r.length,o=0;o<a;++o){var s=r[o];if(s)try{if(!1===s.fn.apply(null,[t])){i=!0;break}}catch(e){Zt(n.diagLog(),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+ct(e),{exception:Ut(e)},!0)}}i||e.processNext(t,n)},e._doTeardown=function(){a()}})),i}return Object(cr.b)(t,e),t.__ieDyn=1,t}(Ur),Wr={loggingLevelConsole:1};function Br(e,t){return new Tr(t)}function zr(e,t){var n=!1;return Qe(t,(function(t){if(t===e)return n=!0,-1})),n}var Kr=function(){function e(){var t,n,r,i,a,o,s,c,u,l,f,d,p,v,g,h,m,y,T,b,S=0;de(e,this,(function(e){function _(){n=!1,t=yt(!0,{},Wr),e.config=t,e.logger=new Xt(t),e._extensions=[],g=new Rr,r=[],i=null,a=null,o=null,s=null,c=null,l=null,u=[],f=null,d=null,p=null,v=!1,h=null,m=Dn("AIBaseCore",!0),y=Lr(),b=null}function E(){return Nr(O(),t,e)}function C(n){var r=function(e,t,n){var r,i=[],a={};return Qe(n,(function(n){(Ne(n)||Ne(n.initialize))&&pt("Plugins must provide initialize method");var r=n.priority,o=n.identifier;n&&r&&(Ne(a[r])?a[r]=o:Yt(e,"Two extensions have same priority #"+r+" - "+a[r]+", "+o)),(!r||r<t)&&i.push(n)})),(r={all:n}).core=i,r}(e.logger,500,u);l=r.core,c=null;var i=r.all;if(p=ot(function(e,t,n){var r=[];if(e&&Qe(e,(function(e){return Fr(r,e,n)})),t){var i=[];Qe(t,(function(e){e.priority>500&&i.push(e)})),Fr(r,i,n)}return r}(d,i,e)),f){var a=Xe(i,f);-1!==a&&i.splice(a,1),-1!==(a=Xe(l,f))&&l.splice(a,1),f._setQueue(p)}else f=function(e,t){function n(){return Nr(null,t.config,t,null)}function r(e,t,n,r){var i=e?e.length+1:1;function a(){0===--i&&(r&&r(),r=null)}i>0&&Qe(e,(function(e){if(e&&e.queue.length>0){var r=e.chain,o=t.createNew(r);o.onComplete(a),n(o)}else i--})),a()}var i=!1;return{identifier:"ChannelControllerPlugin",priority:500,initialize:function(t,n,r,a){i=!0,Qe(e,(function(e){e&&e.queue.length>0&&kr(Nr(e.chain,t,n),r)}))},isInitialized:function(){return i},processTelemetry:function(t,i){r(e,i||n(),(function(e){e.processNext(t)}),(function(){i.processNext(t)}))},update:function(t,n){var i=n||{reason:0};return r(e,t,(function(e){e.processNext(i)}),(function(){t.processNext(i)})),!0},pause:function(){r(e,n(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){r(e,n(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,n){var a=n||{reason:0,isAsync:!1};return r(e,t,(function(e){e.processNext(a)}),(function(){t.processNext(a),i=!1})),!0},getChannel:function(t){var n=null;return e&&e.length>0&&Qe(e,(function(e){if(e&&e.queue.length>0&&(Qe(e.queue,(function(e){if(e.identifier===t)return n=e,-1})),n))return-1})),n},flush:function(t,i,a,o){var s=1,c=!1,u=null;function l(){s--,c&&0===s&&(u&&(clearTimeout(u),u=null),i&&i(c),i=null)}return o=o||5e3,r(e,n(),(function(e){e.iterate((function(e){if(e.flush){s++;var n=!1;e.flush(t,(function(){n=!0,l()}),a)||n||(t&&null==u?u=setTimeout((function(){u=null,l()}),o):l())}}))}),(function(){c=!0,l()})),!0},_setQueue:function(t){e=t}}}(p,e);i.push(f),l.push(f),e._extensions=Pr(i),f.initialize(t,e,i),kr(E(),i),e._extensions=ot(Pr(l||[])).slice(),n&&function(t){var n=Dr(O(),e);e._updateHook&&!0===e._updateHook(n,t)||n.processNext(t)}(n)}function w(t){var n,r=null,i=null;return Qe(e._extensions,(function(e){if(e.identifier===t&&e!==f&&e!==g)return i=e,-1})),!i&&f&&(i=f.getChannel(t)),i&&((n={plugin:i}).setEnabled=function(e){Or(i).disabled=!e},n.isEnabled=function(){var e=Or(i);return!e.teardown&&!e.disabled},n.remove=function(e,t){var n;void 0===e&&(e=!0);var r=[i],a=((n={reason:1}).isAsync=e,n);k(r,a,(function(e){e&&C({reason:32,removed:r}),t&&t(e)}))},r=n),r}function O(){if(!c){var n=(l||[]).slice();-1===Xe(n,g)&&n.push(g),c=Ar(Pr(n),t,e)}return c}function k(n,r,i){if(n&&n.length>0){var a=Mr(Ar(n,t,e),e);a.onComplete((function(){var e=!1,t=[];Qe(u,(function(r,i){zr(r,n)?e=!0:t.push(r)})),u=t;var r=[];d&&(Qe(d,(function(t,i){var a=[];Qe(t,(function(t){zr(t,n)?e=!0:a.push(t)})),r.push(a)})),d=r),i&&i(e)})),a.processNext(r)}else i(!1)}function P(){var n=e.logger?e.logger.queue:[];n&&(Qe(n,(function(n){var r,i=((r={}).name=h||"InternalMessageId: "+n.messageId,r.iKey=ft(t.instrumentationKey),r.time=Ge(new Date),r.baseType=Qt.dataType,r.baseData={message:n.message},r);e.track(i)})),n.length=0)}function x(e,t,n,r){return f?f.flush(e,t,n||6,r):(t&&t(!1),!0)}function I(t){var n=e.logger;n?Zt(n,2,73,t):pt(t)}_(),e.isInitialized=function(){return n},e.initialize=function(r,a,s,c){v&&pt("SDK is still unloading..."),e.isInitialized()&&pt("Core should not be initialized more than once"),t=r||{},e.config=t,Ne(r.instrumentationKey)&&pt("Please provide instrumentation key"),i=c,e._notificationManager=c,function(){var e=ft(t.disableDbgExt);!0===e&&T&&(i.removeNotificationListener(T),T=null);i&&!T&&!0!==e&&(T=function(e){if(!Kt){Kt={};for(var t=0;t<Ht.length;t++)Kt[Ht[t]]=Vt(Ht[t],e)}return Kt}(t),i.addNotificationListener(T))}(),function(){var e=ft(t.enablePerfMgr);!e&&o&&(o=null);e&&lt(t,"createPerfMgr",Br)}(),lt(t,"extensionConfig",{}).NotificationManager=i,s&&(e.logger=s);var l=lt(t,"extensions",[]);(u=[]).push.apply(u,Object(cr.c)(Object(cr.c)([],a,!1),l,!1)),d=lt(t,"channels",[]),C(null),p&&0!==p.length||pt("No channels available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return p&&Qe(p,(function(t){e.push(t.queue)})),ot(e)},e.track=function(n){n.iKey=n.iKey||t.instrumentationKey,n.time=n.time||Ge(new Date),n.ver=n.ver||"4.0",!v&&e.isInitialized()?E().processNext(n):r.push(n)},e.getProcessTelContext=E,e.getNotifyMgr=function(){var t;return i||(i=Object(J.b)(((t={}).addNotificationListener=function(e){},t.removeNotificationListener=function(e){},t.eventsSent=function(e){},t.eventsDiscarded=function(e,t){},t.eventsSendRequest=function(e,t){},t)),e._notificationManager=i),i},e.addNotificationListener=function(e){i&&i.addNotificationListener(e)},e.removeNotificationListener=function(e){i&&i.removeNotificationListener(e)},e.getCookieMgr=function(){return s||(s=ln(t,e.logger)),s},e.setCookieMgr=function(e){s=e},e.getPerfMgr=function(){if(!a&&!o&&ft(t.enablePerfMgr)){var n=ft(t.createPerfMgr);Fe(n)&&(o=n(e,e.getNotifyMgr()))}return a||o||mr},e.setPerfMgr=function(e){a=e},e.eventCnt=function(){return r.length},e.releaseQueue=function(){if(n&&r.length>0){var e=r;r=[],Qe(e,(function(e){E().processNext(e)}))}},e.pollInternalLogs=function(e){h=e||null;var n=ft(t.diagnosticLogInterval);return n&&n>0||(n=1e4),S&&clearInterval(S),S=setInterval((function(){P()}),n)},e.stopPollingInternalLogs=function(){S&&(clearInterval(S),S=0,P())},ht(e,(function(){return g}),["addTelemetryInitializer"]),e.unload=function(t,r,i){var a;void 0===t&&(t=!0),n||pt("SDK is not initialized"),v&&pt("SDK is still unloading...");var o=((a={reason:50}).isAsync=t,a.flushComplete=!1,a),s=Mr(O(),e);function c(t){o.flushComplete=t,v=!0,y.run(s,o),e.stopPollingInternalLogs(),s.processNext(o)}s.onComplete((function(){_(),r&&r(o)}),e),x(t,c,6,i)||c(!1)},e.getPlugin=w,e.addPlugin=function(e,t,n,r){if(!e)return r&&r(!1),void I("Plugins must provide initialize method");var i=w(e.identifier);if(i&&!t)return r&&r(!1),void I("Plugin ["+e.identifier+"] is already loaded!");var a={reason:16};function o(t){u.push(e),a.added=[e],C(a),r&&r(!0)}if(i){var s=[i.plugin];k(s,{reason:2,isAsync:!!n},(function(e){e?(a.removed=s,a.reason|=32,o()):r&&r(!1)}))}else o()},e.evtNamespace=function(){return m},e.flush=x,e.getTraceCtx=function(e){var t,n;return b||(n={},b={getName:function(){return n.name},setName:function(e){t&&t.setName(e),n.name=e},getTraceId:function(){return n.traceId},setTraceId:function(e){t&&t.setTraceId(e),Er(e)&&(n.traceId=e)},getSpanId:function(){return n.spanId},setSpanId:function(e){t&&t.setSpanId(e),Cr(e)&&(n.spanId=e)},getTraceFlags:function(){return n.traceFlags},setTraceFlags:function(e){t&&t.setTraceFlags(e),n.traceFlags=e}}),b},e.setTraceCtx=function(e){b=e||null},gt(e,"addUnloadCb",(function(){return y}),"add")}))}return e.__ieDyn=1,e}();function Hr(e,t,n,r){Qe(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return r(e)}),0);else try{r(e)}catch(e){}}))}var jr,Vr=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;de(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Xe(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Xe(e.listeners,t)},e.eventsSent=function(t){Hr(e.listeners,"eventsSent",!0,(function(e){e.eventsSent(t)}))},e.eventsDiscarded=function(t,n){Hr(e.listeners,"eventsDiscarded",!0,(function(e){e.eventsDiscarded(t,n)}))},e.eventsSendRequest=function(t,n){Hr(e.listeners,"eventsSendRequest",n,(function(e){e.eventsSendRequest(t,n)}))},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||Hr(e.listeners,"perfEvent",!1,(function(e){t.isAsync?setTimeout((function(){return e.perfEvent(t)}),0):e.perfEvent(t)})))}}))}return e.__ieDyn=1,e}(),qr=function(e){function t(){var n=e.call(this)||this;return de(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],2)}e.initialize=function(e,n,r,i){t.initialize(e,n,r||new Xt(e),i||new Vr(e))},e.track=function(r){br(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(n(r),pt("Invalid telemetry item")),function(e){Ne(e.name)&&(n(e),pt("telemetry name required"))}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)}})),n}return Object(cr.b)(t,e),t.__ieDyn=1,t}(Kr),Jr=((jr={})[0]=0,jr[2]=6,jr[1]=1,jr[3]=7,jr[4098]=6,jr[4097]=1,jr[4099]=7,jr);Boolean(Pt()),Boolean(kt());function Gr(e){return!(""===e||Ne(e))}function Qr(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function Xr(e){return!!(e&&Ve(e)&&e>=1&&e<=4)}function $r(e,t,n){if(!t&&!Gr(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||Ke(t))t={value:t};else if("object"!==r||q.e.call(t,"value")){if(Ne(t.value)||""===t.value||!je(t.value)&&!Ve(t.value)&&!qe(t.value)&&!Ke(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Ke(t.value)&&!ni(t.value))return null;if(!Ne(t.kind)){if(Ke(t.value)||!ti(t.kind))return null;t.value=t.value.toString()}return t}function Zr(e,t,n){var r=-1;if(!Ie(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(n))-1===r&&(r=0),r|=n;else{var i=Jr[ii(e)]||-1;-1!==r&&-1!==i?r|=i:6===i&&(r=i)}return r}function Yr(e,t,n,r,i){var a={},o=!1,s=0,c=arguments.length,u=Object[q.k],l=arguments;for("[object Boolean]"===u.toString.call(l[0])&&(o=l[0],s++);s<c;s++){Ue(e=l[s],(function(e,t){o&&t&&Ae(t)?Ke(t)?(a[e]=a[e]||[],Qe(t,(function(t,n){t&&Ae(t)?a[e][n]=Yr(!0,a[e][n],t):a[e][n]=t}))):a[e]=Yr(!0,a[e],t):a[e]=t}))}return a}var ei=rr;function ti(e){return 0===e||e>0&&e<=13||32===e}function ni(e){return e.length>0}function ri(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=ei()}function ii(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===q.j&&(t=4,Ke(e)?(t=4096,e.length>0&&(t|=ii(e[0]))):q.e.call(e,"value")&&(t=8192|ii(e.value)))}return t}q.l,q.j,q.l,J.b;var ai=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],de(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new Xt({loggingLevelConsole:1})),e.initialize=function(n,r,i,a){br(e,(function(){return"AppInsightsCore.initialize"}),(function(){var o=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;!s||s.getProperty&&s.setProperty||pt("Invalid property storage override passed."),n.channels&&Qe(n.channels,(function(e){e&&Qe(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;o.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},r&&Qe(r,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;o.push(t)}})),e.pluginVersionString=o.join(";"),e.pluginVersionStringArr=o;try{t.initialize(n,r,i,a),e.pollInternalLogs("InternalLog")}catch(t){var c=e.logger,u=Ut(t);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),Zt(c,1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:n,extensions:r,logger:i,notificationManager:a}}))},e.track=function(n){br(e,(function(){return"AppInsightsCore.track"}),(function(){var r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=ei(),Xr(r.latency)||(r.latency=1);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver="1DS-Web-JS-3.2.8";var a=r.baseData=r.baseData||{};a.properties=a.properties||{};var o=a.properties;o.version=o.version||e.pluginVersionString||""}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Object(cr.b)(t,e),t.__ieDyn=1,t}(qr),oi=ur({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5});function si(e){var t=(e.ext||{}).intweb;return t&&Gr(t.msfpc)?t.msfpc:null}function ci(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=si(e[n]);return t}var ui=function(){function e(t,n){var r=n?[].concat(n):[],i=ci(r);this.iKey=function(){return t},this.Msfpc=function(){return i||""},this.count=function(){return r.length},this.events=function(){return r},this.addEvent=function(e){return!!e&&(r.push(e),i||(i=si(e)),!0)},this.split=function(n,a){var o;if(n<r.length){var s=r.length-n;Ne(a)||(s=a<s?a:s),o=r.splice(n,s),i=ci(r)}return new e(t,o)}}return e.create=function(t,n){return new e(t,n)},e}(),li=function(){function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",a=!1;de(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,a||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){a||(e?(i=e,n=!0,a=!0):n=!1,t=!0)}}))}return e.__ieDyn=1,e}(),fi=function(){function e(){var t={};de(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=function(e){var t=[];return e&&Qe(e,(function(e){t.push(Ye(e))})),t}(e.split(","));if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),a=0;a<r.length;++a)t[r[a]]=st()+i}catch(e){return[]}return[]},e.isTenantKilled=function(e){var n=t,r=Ye(e);return void 0!==n[r]&&n[r]>st()||(delete n[r],!1)}}))}return e.__ieDyn=1,e}();function di(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var pi,vi=Math.min(2e6,65e3),gi=/\./,hi=function(){function e(t,n,r,i){var a=!!i,o=n,s={};de(e,this,(function(e){function n(e,t,i,c,u,l,f){Ue(e,(function(e,d){var p=null;if(d||Gr(d)){var v=i,g=e,h=u,m=t;if(a&&!c&&gi.test(e)){var y=e.split("."),T=y.length;if(T>1){h&&(h=h.slice());for(var b=0;b<T-1;b++){var S=y[b];m=m[S]=m[S]||{},v+="."+S,h&&h.push(S)}g=y[T-1]}}if(p=!(c&&function(e,t){var n=s[e];return void 0===n&&(e.length>=7&&(n=We(e,"ext.metadata")||We(e,"ext.web")),s[e]=n),n}(v))&&o&&o.handleField(v,g)?o.value(v,g,d,r):$r(g,d,r)){var _=p.value;if(m[g]=_,l&&l(h,g,p),f&&"object"==typeof _&&!Ke(_)){var E=h;E&&(E=E.slice()).push(g),n(d,_,v+"."+g,c,E,l,f)}}}}))}e.createPayload=function(e,t,n,r,i,a){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r,sendType:a,sendReason:i}},e.appendPayload=function(n,r,i){var a=n&&r&&!n.overflow;return a&&br(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),a=n.payloadBlob,o=n.numEvents,s=!1,c=[],u=[],l=n.isBeacon,f=l?65e3:3984588,d=l?vi:2e6,p=0,v=0;p<t.length;){var g=t[p];if(g){if(o>=i){n.overflow=r.split(p);break}var h=e.getEventBlob(g);if(h&&h.length<=d){var m=h.length;if(a.length+m>f){n.overflow=r.split(p);break}a&&(a+="\n"),a+=h,++v>20&&(a.substr(0,1),v=0),s=!0,o++}else h?c.push(g):u.push(g),t.splice(p,1),p--}p++}if(c&&c.length>0&&n.sizeExceed.push(ui.create(r.iKey(),c)),u&&u.length>0&&n.failedEvts.push(ui.create(r.iKey(),u)),s){n.batches.push(r),n.payloadBlob=a,n.numEvents=o;var y=r.iKey();-1===Xe(n.apiKeys,y)&&n.apiKeys.push(y)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),a},e.getEventBlob=function(e){try{return br(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+Qr(e.iKey);var r={},i=e.ext;i&&(t.ext=r,Ue(i,(function(e,t){n(t,r[e]={},"ext."+e,!0,null,null,!0)})));var a=t.data={};a.baseType=e.baseType;var o=a.baseData={};return n(e.baseData,o,"baseData",!1,["baseData"],(function(e,t,n){mi(r,e,t,n)}),!0),n(e.data,a,"data",!1,[],(function(e,t,n){mi(r,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function mi(e,t,n,r){if(r&&e){var i=Zr(r.value,r.kind,r.propertyType);if(i>-1){var a=e.metadata;a||(a=e.metadata={f:{}});var o=a.f;if(o||(o=a.f={}),t)for(var s=0;s<t.length;s++){var c=t[s];o[c]||(o[c]={f:{}});var u=o[c].f;u||(u=o[c].f={}),o=u}o=o[n]={},Ke(r.value)?o.a={t:i}:o.t=i}}}var yi=((pi={})[1]="requeue",pi[100]="requeue",pi[200]="sent",pi[8004]="drop",pi[8003]="drop",pi),Ti={},bi={};function Si(e,t,n){Ti[e]=t,!1!==n&&(bi[t]=e)}function _i(e){try{return e.responseText}catch(e){}return""}function Ei(e,t){var n=!1;if(e&&t){var r=nt(e);if(r&&r.length>0)for(var i=t.toLowerCase(),a=0;a<r.length;a++){var o=r[a];if(o&&De(t,o)&&o.toLowerCase()===i){n=!0;break}}}return n}function Ci(e,t,n,r){t&&n&&n.length>0&&(r&&Ti[t]?(e.hdrs[Ti[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}function wi(e,t){return t&&(Ve(t)?e=[t].concat(e):Ke(t)&&(e=t.concat(e))),e}Si("AuthMsaDeviceTicket","AuthMsaDeviceTicket",!1),Si("client-version","client-version"),Si("client-id","Client-Id"),Si("apikey","apikey"),Si("time-delta-to-apply-millis","time-delta-to-apply-millis"),Si("upload-time","upload-time"),Si("AuthXToken","AuthXToken");var Oi=function(){function e(t,n,r,i,a){this._responseHandlers=[];var o,s,c,u,l,f,d,p,v,g,h="?cors=true&"+"content-type".toLowerCase()+"=application/x-json-stream",m=new fi,y=!1,T=new li,b=!1,S=0,_=!0,E=[],C={},w=[],O=null,k=!1,P=!1,x=!1;de(e,this,(function(e){var I=!0;function N(e,t){for(var n=0,r=null,i=0;null==r&&i<e.length;)1===(n=e[i])?Bt()?r=M:zt()&&(r=A):2===n&&Wt(t)&&(!t||t&&!p)?r=D:b&&3===n&&Rt()&&(r=L),i++;return r?{_transport:n,_isSync:t,sendPOST:r}:null}function M(e,t,n){var r=new XDomainRequest;r.open("POST",e.urlString),e.timeout&&(r.timeout=e.timeout),r.onload=function(){var e=_i(r);F(t,200,{},e),Q(e)},r.onerror=function(){F(t,400,{})},r.ontimeout=function(){F(t,500,{})},r.onprogress=function(){},n?r.send(e.data):a.set((function(){r.send(e.data)}),0)}function D(e,t,n){var r,i=e.urlString,o=!1,s=!1,c=((r={body:e.data,method:"POST"}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);n&&(c.keepalive=!0,2===e._sendReason&&(o=!0,g&&(i+="&NoResponseBody=true"))),I&&(c.credentials="include"),e.headers&&nt(e.headers).length>0&&(c.headers=e.headers),fetch(i,c).then((function(e){var n={},r="",i=e.headers;i&&i.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),s||(s=!0,F(t,e.status,n,r),Q(r))})).catch((function(e){s||(s=!0,F(t,0,{}))})),o&&!s&&(s=!0,F(t,200,{})),!s&&e.timeout>0&&a.set((function(){s||(s=!0,F(t,500,{}))}),e.timeout)}function A(e,t,n){var r=e.urlString;function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=Ye(r))}return e}function a(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if(je(e)){Qe(Ye(e).split(/[\r\n]+/),(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=Ye(e.substring(0,n)).toLowerCase(),i=Ye(e.substring(n+1));t[r]=i}else t[Ye(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=i(t,e,"time-delta-millis"),t=i(t,e,"kill-duration"),t=i(t,e,"kill-duration-seconds")),t}function o(e,n){F(t,e.status,a(e),n)}n&&e.disableXhrSync&&(n=!1);var s=function(e,t,n,r,i,a){function o(e,t,n){try{e[t]=n}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return r&&o(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),n&&o(s,"withCredentials",n),s.open(e,t,!i),n&&o(s,"withCredentials",n),!i&&a&&o(s,"timeout",a),s}("POST",r,I,!0,n,e.timeout);Ue(e.headers,(function(e,t){s.setRequestHeader(e,t)})),s.onload=function(){var e=_i(s);o(s,e),Q(e)},s.onerror=function(){o(s)},s.ontimeout=function(){o(s)},s.send(e.data)}function F(e,t,n,r){try{e(t,n,r)}catch(e){Zt(s,2,518,Ut(e))}}function L(e,t,n){var r=200,i=e._thePayload,a=e.urlString+(g?"&NoResponseBody=true":"");try{var o=It();if(!o.sendBeacon(a,e.data))if(i){var c=[];Qe(i.batches,(function(e){if(c&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!o.sendBeacon(a,O.getEventBlob(t[n]))){c.push(e.split(n));break}}else c.push(e.split(0))})),X(c,8003,i.sendType,!0)}else r=0}catch(e){Yt(s,"Failed to send telemetry using sendBeacon API. Ex:"+Ut(e)),r=0}finally{F(t,r,{},"")}}function U(e){return 2===e||3===e}function R(e){return P&&U(e)&&(e=2),e}function W(){return!y&&S<n}function B(){var e=w;return w=[],e}function z(e,t,n){var r=!1;return e&&e.length>0&&!y&&c[t]&&O&&(r=0!==t||W()&&(n>0||T.allowRequestSending())),r}function K(e){var t={};return e&&Qe(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function H(e,n,r,i,a){if(e&&0!==e.length)if(y)X(e,1,i);else{i=R(i);try{var o=e,l=0!==i;br(u,(function(){return"HttpManager:_sendBatches"}),(function(o){o&&(e=e.slice(0));for(var s=[],u=null,f=ei(),d=c[i]||(l?c[1]:c[0]),p=d&&d._transport,g=v&&(P||U(i)||3===p||d._isSync&&2===p);z(e,i,n);){var h=e.shift();h&&h.count()>0&&(m.isTenantKilled(h.iKey())?s.push(h):(u=u||O.createPayload(n,r,l,g,a,i),O.appendPayload(u,h,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,J(u,f,ei(),a),f=ei(),u=null):(J(u,f,ei(),a),f=ei(),e=[h].concat(e),u=null)))}u&&J(u,f,ei(),a),e.length>0&&(w=e.concat(w)),X(s,8004,i)}),(function(){return{batches:K(o),retryCount:n,isTeardown:r,isSynchronous:l,sendReason:a,useSendBeacon:U(i),sendType:i}}),!l)}catch(e){Zt(s,2,48,"Unexpected Exception sending batch: "+Ut(e))}}}function j(e,t){var n={url:h,hdrs:{},useHdrs:!1};t?(n.hdrs=Yr(n.hdrs,C),n.useHdrs=nt(n.hdrs).length>0):Ue(C,(function(e,t){bi[e]?Ci(n,bi[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),Ci(n,"client-id","NO_AUTH",t),Ci(n,"client-version","1DS-Web-JS-3.2.8",t);var r="";Qe(e.apiKeys,(function(e){r.length>0&&(r+=","),r+=e})),Ci(n,"apikey",r,t),Ci(n,"upload-time",st().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return""}(e);if(Gr(i)&&(n.url+="&ext.intweb.msfpc="+i),T.shouldAddClockSkewHeaders()&&Ci(n,"time-delta-to-apply-millis",T.getClockSkewHeaderValue(),t),u.getWParam){var a=u.getWParam();a>=0&&(n.url+="&w="+a)}for(var o=0;o<E.length;o++)n.url+="&"+E[o].name+"="+E[o].value;return n}function V(e,t,n){e[t]=e[t]||{},e[t][o.identifier]=n}function J(t,n,i,a){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=!!e.sendHook,v=c[t.sendType];!U(t.sendType)&&t.isBeacon&&2===t.sendReason&&(v=c[2]||c[3]||v);var g=x;(t.isBeacon||3===v._transport)&&(g=!1);var h=j(t,g);g=g||h.useHdrs;var y=ei();br(u,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var c=0;c<t.batches.length;c++)for(var b=t.batches[c].events(),E=0;E<b.length;E++){var C=b[E];if(k){var w=C.timings=C.timings||{};V(w,"sendEventStart",y),V(w,"serializationStart",n),V(w,"serializationCompleted",i)}C.sendAttempt>0?C.sendAttempt++:C.sendAttempt=1}X(t.batches,1e3+(a||0),t.sendType,!0);var O={data:t.payloadBlob,urlString:h.url,headers:h.hdrs,_thePayload:t,_sendReason:a,timeout:f,disableXhrSync:d,disableFetchKeepAlive:p};g&&(Ei(O.headers,"cache-control")||(O.headers["cache-control"]="no-cache, no-store"),Ei(O.headers,"content-type")||(O.headers["content-type"]="application/x-json-stream"));var x=null;v&&(x=function(n){T.firstRequestSent();var i=function(n,i){!function(t,n,i,a){var s=9e3,c=null,u=!1,l=!1;try{var f=!0;if(typeof t!==q.l){if(n){T.setClockSkew(n["time-delta-millis"]);var d=n["kill-duration"]||n["kill-duration-seconds"];Qe(m.setKillSwitchTenants(n["kill-tokens"],d),(function(e){Qe(i.batches,(function(t){if(t.iKey()===e){c=c||[];var n=t.split(0);i.numEvents-=n.count(),c.push(n)}}))}))}if(200==t||204==t)return void(s=200);((v=t)>=300&&v<500&&408!=v&&429!=v||501==v||505==v||i.numEvents<=0)&&(f=!1),s=9e3+t%1e3}if(f){s=100;var p=i.retryCnt;0===i.sendType&&(p<r?(u=!0,G((function(){0===i.sendType&&S--,H(i.batches,p+1,i.isTeardown,P?2:i.sendType,5)}),P,di(p))):(l=!0,P&&(s=8001)))}}finally{u||(T.setClockSkew(),function(t,n,r,i){try{i&&o._backOffTransmission(),200===n&&(i||t.isSync||o._clearBackOff(),function(e){if(k){var t=ei();Qe(e,(function(e){var n,r;e&&e.count()>0&&(n=e.events(),r=t,k&&Qe(n,(function(e){V(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(t.batches)),X(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(S--,5!==r&&e.sendQueuedRequests(t.sendType,r))}}(i,s,a,l)),X(c,8004,i.sendType)}var v}(n,i,t,a)},c=t.isTeardown||t.isSync;try{v.sendPOST(n,i,c),e.sendListener&&e.sendListener(O,n,c,t.isBeacon)}catch(e){Yt(s,"Unexpected exception sending payload. Ex:"+Ut(e)),F(i,0,{})}}),br(u,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(x)if(0===t.sendType&&S++,l&&!t.isBeacon&&3!==v._transport){var n={data:O.data,urlString:O.urlString,headers:Yr({},O.headers),timeout:O.timeout,disableXhrSync:O.disableXhrSync,disableFetchKeepAlive:O.disableFetchKeepAlive},r=!1;br(u,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,_||e._thePayload||(e._thePayload=e._thePayload||O._thePayload,e._sendReason=e._sendReason||O._sendReason),x(e)}),t.isSync||t.isTeardown)}catch(e){r||x(O)}}))}else x(O)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:a}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&X(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&X(t.failedEvts,8002,t.sendType)}function G(e,t,n){t?e():a.set(e,n)}function Q(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){Zt(s,1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);Gr(i.webResult)&&Gr(i.webResult.msfpc)&&l.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function X(e,t,n,r){if(e&&e.length>0&&i){var a=i[function(e){var t=yi[e];Gr(t)||(t="oth",e>=9e3&&e<=9999?t="rspFail":e>=8e3&&e<=8999?t="drop":e>=1e3&&e<=1999&&(t="send"));return t}(t)];if(a){var o=0!==n;br(u,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){G((function(){try{a.call(i,e,t,o,n)}catch(e){Zt(s,1,74,"send request notification failed: "+e)}}),r||o,0)}),(function(){return{batches:K(e),reason:t,isSync:o,sendSync:r,sendType:n}}),!o)}}}e.initialize=function(e,t,n,r,i){var a;i||(i={}),h=e+h,x=!!Ie(i.avoidOptions)||!i.avoidOptions,u=t,l=t.getCookieMgr(),k=!u.config.disableEventTimings;var m=!!u.config.enableCompoundKey;s=(o=n).diagLog();var y=i.valueSanitizer,T=i.stringifyObjects;Ie(i.enableCompoundKey)||(m=!!i.enableCompoundKey),f=i.xhrTimeout,d=!!i.disableXhrSync,p=!!i.disableFetchKeepAlive,g=!1!==i.addNoResponse,b=!Ft(),O=new hi(u,y,T,m),Ne(i.useSendBeacon)||(b=!!i.useSendBeacon);var S=r,E=i.alwaysUseXhrOverride?r:null,C=i.alwaysUseXhrOverride?r:null,w=[3,2];if(!r){_=!1;var P=Nt();P&&P.protocol&&"file:"===P.protocol.toLowerCase()&&(I=!1);var M=[];Ft()?(M=[2,1],w=[2,1,3]):M=[1,2,3],(r=N(M=wi(M,i.transports),!1))||Yt(s,"No available transport to send events"),S=N(M,!0)}E||(E=N(w=wi(w,i.unloadTransports),!0)),v=!_&&(b&&Rt()||!p&&Wt(!0)),(a={})[0]=r,a[1]=S||N([1,2,3],!0),a[2]=E||S||N([1],!0),a[3]=C||N([2,3],!0)||S||N([1],!0),c=a},e._getDbgPlgTargets=function(){return[c[0],m,O,c]},e.addQueryStringParameter=function(e,t){for(var n=0;n<E.length;n++)if(E[n].name===e)return void(E[n].value=t);E.push({name:e,value:t})},e.addHeader=function(e,t){C[e]=t},e.canSendRequest=function(){return W()&&T.allowRequestSending()},e.sendQueuedRequests=function(e,t){Ie(e)&&(e=0),P&&(e=R(e),t=2),z(w,e,0)&&H(B(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!y&&0===S&&0===w.length},e.setUnloading=function(e){P=e},e.addBatch=function(e){if(e&&e.count()>0){if(m.isTenantKilled(e.iKey()))return!1;w.push(e)}return!0},e.teardown=function(){w.length>0&&H(B(),0,!0,2,2)},e.pause=function(){y=!0},e.resume=function(){y=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(Ne(t)&&(t=1),P&&(t=R(t),n=2),H([e],0,!1,t,n||0))}}))}return e.__ieDyn=1,e}();function ki(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout(e,t,n)}function Pi(e){clearTimeout(e)}function xi(e,t){return{set:e||ki,clear:t||Pi}}var Ii=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.2.8";var i,a,o,s,c,u,l,f=!1,d=[],p=null,v=!1,g=0,h=500,m=0,y=1e4,T={},b="REAL_TIME",S=null,_=null,E=0,C=0,w={},O=-1,k=!0,P=!1,x=6,I=2;return de(t,r,(function(e,t){function r(e){"beforeunload"!==(e||kt().event).type&&(P=!0,a.setUnloading(P)),W(2,2)}function N(e){P=!1,a.setUnloading(P)}function M(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,k&&(e.ext=mt(e.ext),e.baseData&&(e.baseData=mt(e.baseData)),e.data&&(e.data=mt(e.data))),e.sync)if(E||v)e.latency=3,e.sync=!1;else if(a)return k&&(e=mt(e)),void a.sendSynchronousBatch(ui.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,r=m,i=y;4===n&&(r=g,i=h);var o=!1;if(r<i)o=!K(e,t);else{var s=1,c=20;4===n&&(s=4,c=1),o=!0,function(e,t,n,r){for(;n<=t;){var i=B(e,t,!0);if(i&&i.count()>0){var a=i.split(0,r),o=a.count();if(o>0)return 4===n?g-=o:m-=o,Q("eventsDiscarded",[a],oi.QueueFull),!0}n++}return H(),!1}(e.iKey,e.latency,s,c)&&(o=!K(e,t))}o&&G("eventsDiscarded",[e],oi.QueueFull)}function D(e,t,n){var r=j(e,t,n);return a.sendQueuedRequests(t,n),r}function A(){return m>0}function F(){if(O>=0&&j(O,0,c)&&a.sendQueuedRequests(0,c),g>0&&!_&&!v){var e=T[b][2];e>=0&&(_=U((function(){_=null,D(4,0,1),F()}),e))}var t=T[b][1];!S&&!p&&t>=0&&!v&&(A()?S=U((function(){S=null,D(0===C?3:1,0,1),C++,C%=2,F()}),t):C=0)}function L(){n=null,f=!1,d=[],p=null,v=!1,g=0,h=500,m=0,y=1e4,T={},b="REAL_TIME",S=null,_=null,E=0,C=0,i=null,w={},o=void 0,s=0,O=-1,c=null,k=!0,P=!1,x=6,I=2,u=null,l=xi(),a=new Oi(500,2,1,{requeue:q,send:X,sent:$,drop:Z,rspFail:Y,oth:ee},l),V(),w[4]={batches:[],iKeyMap:{}},w[3]={batches:[],iKeyMap:{}},w[2]={batches:[],iKeyMap:{}},w[1]={batches:[],iKeyMap:{}},te()}function U(e,t){0===t&&E&&(t=1);var n=1e3;return E&&(n=di(E-1)),l.set(e,t*n)}function R(){return null!==S&&(l.clear(S),S=null,C=0,!0)}function W(e,t){R(),p&&(l.clear(p),p=null),v||D(1,e,t)}function B(e,t,n){var r=w[t];r||(r=w[t=1]);var i=r.iKeyMap[e];return!i&&n&&(i=ui.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function z(t,n){a.canSendRequest()&&!E&&(o>0&&m>o&&(n=!0),n&&null==p&&e.flush(t,null,20))}function K(e,t){k&&(e=mt(e));var n=e.latency,r=B(e.iKey,n,!0);return!!r.addEvent(e)&&(4!==n?(m++,t&&0===e.sendAttempt&&z(!e.sync,s>0&&r.count()>=s)):g++,!0)}function H(){for(var e=0,t=0,n=function(n){var r=w[n];r&&r.batches&&Qe(r.batches,(function(r){4===n?e+=r.count():t+=r.count()}))},r=1;r<=4;r++)n(r);m=t,g=e}function j(t,n,r){var i=!1,o=0===n;return!o||a.canSendRequest()?br(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var r=w[n];r&&r.batches&&r.batches.length>0&&(Qe(r.batches,(function(t){a.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?g-=t.count():m-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&G("eventsDiscarded",e,oi.KillSwitch),i&&O>=t&&(O=-1,c=0)}),(function(){return{latency:t,sendType:n,sendReason:r}}),!o):(O=O>=0?Math.min(O,t):t,c=Math.max(c,r)),i}function V(){(T={}).REAL_TIME=[2,1,0],T.NEAR_REAL_TIME=[6,3,0],T.BEST_EFFORT=[18,9,0]}function q(t,n){var r=[],i=x;P&&(i=I),Qe(t,(function(t){t&&t.count()>0&&Qe(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?(ri(t,e.identifier),M(t,!1)):r.push(t))}))})),r.length>0&&G("eventsDiscarded",r,oi.NonRetryableStatus),P&&W(2,2)}function J(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){Zt(e.diagLog(),1,74,t+" notification failed: "+n)}}function G(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&J(e,[t].concat(n))}function Q(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&Qe(t,(function(t){t&&t.count()>0&&J(e,[t.events()].concat(n))}))}function X(e,t,n){e&&e.length>0&&J("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function $(e,t){Q("eventsSent",e,t),F()}function Z(e,t){Q("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:oi.Unknown)}function Y(e){Q("eventsDiscarded",e,oi.NonRetryableStatus),F()}function ee(e,t){Q("eventsDiscarded",e,oi.Unknown),F()}function te(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,y/6)}L(),e._getDbgPlgTargets=function(){return[a]},e.initialize=function(s,c,f){br(c,(function(){return"PostChannel:initialize"}),(function(){var d=c;t.initialize(s,c,f);try{c.addUnloadCb;u=Jn(Dn(e.identifier),c.evtNamespace&&c.evtNamespace());var p=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=p.getExtCfg(e.identifier),l=xi(n.setTimeoutOverride,n.clearTimeoutOverride),k=!n.disableOptimizeObj&&!!wt("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(d),n.eventsLimitInMem>0&&(y=n.eventsLimitInMem),n.immediateEventLimit>0&&(h=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(o=n.autoFlushEventsLimit),Ve(n.maxEventRetryAttempts)&&(x=n.maxEventRetryAttempts),Ve(n.maxUnloadEventRetryAttempts)&&(I=n.maxUnloadEventRetryAttempts),te(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),Gr(s.anonCookieName)&&a.addQueryStringParameter("anoncknm",s.anonCookieName),a.sendHook=n.payloadPreprocessor,a.sendListener=n.payloadListener;var v=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=c.getNotifyMgr(),a.initialize(v,e.core,e,i,n);var g=s.disablePageUnloadEvents||[];Yn(r,g,u),function e(t,n,r){var i=Jn(Fn,r),a=$n(["pagehide"],t,n,i);return n&&-1!==Xe(n,"visibilitychange")||(a=$n(["visibilitychange"],(function(e){var n=Pt();t&&n&&"hidden"===n.visibilityState&&t(e)}),n,i)||a),!a&&n&&(a=e(t,null,r)),a}(r,g,u),function e(t,n,r){var i=Jn(Ln,r),a=$n(["pageshow"],t,n,i);return!(a=$n(["visibilitychange"],(function(e){var n=Pt();t&&n&&"visible"===n.visibilityState&&t(e)}),n,i)||a)&&n&&(a=e(t,null,r)),a}(N,s.disablePageShowEvents,u)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:s,core:c,extensions:f}}))},e.processTelemetry=function(t,r){ri(t,e.identifier);var i=(r=e._getTelCtx(r)).getExtCfg(e.identifier),a=!!n.disableTelemetry;i&&(a=a||!!i.disableTelemetry);var o=t;a||f||(n.overrideInstrumentationKey&&(o.iKey=n.overrideInstrumentationKey),i&&i.overrideInstrumentationKey&&(o.iKey=i.overrideInstrumentationKey),M(o,!0),P?W(2,2):F()),e.processNext(o,r)},e._doTeardown=function(e,t){W(2,2),f=!0,a.teardown(),Zn(["beforeunload","unload","pagehide"],null,u),function(e,t){var n=Jn(Fn,t);Zn(["pagehide"],e,n),Zn(["visibilitychange"],null,n)}(null,u),function(e,t){var n=Jn(Ln,t);Zn(["pageshow"],e,n),Zn(["visibilitychange"],null,n)}(null,u),L()},e.setEventQueueLimits=function(e,t){y=e>0?e:1e4,o=t>0?t:0,te();var n=m>e;if(!n&&s>0)for(var r=1;!n&&r<=3;r++){var i=w[r];i&&i.batches&&Qe(i.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}z(!0,n)},e.pause=function(){R(),v=!0,a.pause()},e.resume=function(){v=!1,a.resume(),F()},e.addResponseHandler=function(e){a._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){R(),V(),b="REAL_TIME",F(),Ue(e,(function(e,t){var n=t.length;if(n>=2){var r=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t.push(r),T[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!v)if(n=n||1,e)null==p?(R(),j(1,0,n),p=U((function(){p=null,function e(t,n){D(1,0,n),H(),function e(t){a.isCompletelyIdle()?t():p=U((function(){p=null,e(t)}),.25)}((function(){t&&t(),d.length>0?p=U((function(){p=null,e(d.shift(),n)}),0):(p=null,F())}))}(t,n)}),0)):d.push(t);else{var r=R();D(1,1,n),null!=t&&t(),r&&F()}},e.setMsaAuthTicket=function(e){a.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=A,e._setTransmitProfile=function(e){b!==e&&void 0!==T[e]&&(R(),b=e,F())},e._backOffTransmission=function(){E<4&&(E++,R(),F())},e._clearBackOff=function(){E&&(E=0,R(),F())},rt(e,"_setTimeoutOverride",(function(){return l.set}),(function(e){l=xi(e,l.clear)})),rt(e,"_clearTimeoutOverride",(function(){return l.clear}),(function(e){l=xi(l.set,e)}))})),r}return Object(cr.b)(t,e),t.__ieDyn=1,t}(Ur),Ni=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Mi=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return"HttpManager:_sendBatches"===e||"HttpManager:_sendBatchesNotification"===e?new Ni(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case"HttpManager:_sendBatches":this.handleSendBatches(e);break;case"HttpManager:_sendBatchesNotification":this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var r in t.batches)n+=t.batches[r].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}();function Di(e,t,n,r){var i={instrumentationKey:t,endpointUrl:n,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:u({},e.extensionConfig)};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(t,n){var r,i=n||t;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var a=new Fi;return a.initialize(i,r),a.setUploadFrequency(e.uploadFrequency),e.notificationListener&&a.addNotificationListener(e.notificationListener),e.stats&&a.setPerfMgr(new Mi(e.stats)),a}var Ai=function(e,t){t&&t.addNotificationListener({eventsSent:function(t){d(2,2,(function(){return"Successfully sent ".concat(t.length," event(s)")})),d(3,2,(function(){return"Sent event(s) details : ".concat(JSON.stringify(t,null,2))})),e.eventsSent+=t.length},eventsDiscarded:function(t,n){d(0,2,(function(){return"Discarded ".concat(t.length," event(s) because ").concat(n)})),d(3,2,(function(){return"Discarded event(s) details : ".concat(JSON.stringify(t,null,2))})),e.eventsDiscarded+=t.length}})},Fi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.initialize=function(t,n){this._postChannel=new Ii;var r=[];n&&(r=r.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=u(u({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(ai),Li=function(e){function t(t,n){var r,i=e.call(this,t,n)||this;i.sendTelemetryEvent=function(e){return x((function(){var t=i.getOneDSTelemetryEvent(e);t&&r&&r.track(t)}),void 0)},i.sendCustomerContent=function(e){},i.sendNonStandardEvent=function(e,t){var n=!1;o.forEach((function(r){r.canHandle(t)&&(r.processEvent(e),n=!0)})),n||d(0,1,(function(){return"Missing Handler for "+t+"to process"+e.eventName}))},i.flush=function(e){null==r||r.flush(e),o.forEach((function(t){t.flush(e)}))},i.shutdown=function(){try{null==r||r.shutdown(),o.forEach((function(e){e.shutdown()}))}catch(e){d(0,2,(function(){return"An error occurred on shutdown"}))}};var a=n.plugins||[],o=n.nonStandardEventHandlers||[];if(o.forEach((function(e){e.initialize(i,n)})),!n.endpointUrl)throw new Error("Missing Endpoint Url");return r=Di(n,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",n.endpointUrl,a),n.disableStatsTracking||Ai(i,r),i}return c(t,e),t}(hr);function Ui(e){return{name:"App",contract:{name:"App",dataFields:[Vi("Name",e.name),Vi("Platform",e.platform),Vi("Version",e.version)]}}}function Ri(e){return{name:"Session",contract:{name:"Session",dataFields:[Vi("Id",e.sessionId),Vi("EcsETag",e.flightsImpressionId)]}}}function Wi(e){return{name:"Release",contract:{name:"Release",dataFields:[Vi("AudienceGroup",e.audienceGroup)]}}}function Bi(e){return{name:"Browser",contract:{name:"Browser",dataFields:[Vi("Name",e.browserName),Vi("Version",e.browserVersion)]}}}function zi(e){return{name:"Culture",contract:{name:"Culture",dataFields:[Vi("UiLanguage",e.appLanguage)]}}}function Ki(e){return{name:"User",contract:{name:"User",dataFields:[Vi("PrimaryIdentityHash",e.loggableUserId),Vi("PrimaryIdentitySpace",e.loggableUserIdSpace),Vi("TenantId",e.omsTenantId),qi("IsAnonymous",e.isAnonymousUser)]}}}function Hi(e){return{name:"WAC",contract:{name:"WAC",dataFields:[Vi("Host",e.host),Vi("ServerDocId",e.serverDocId),Vi("Datacenter",e.datacenter),qi("IsSynthetic",e.isSynthetic),qi("IsBusinessUser",e.isBusinessUser),qi("IsEdu",e.isEduUser),Vi("ApplicationMode",e.applicationMode),Vi("ApplicationModeExtended",e.applicationModeExtended),Vi("BrowserLanguage",e.browserLanguage),Vi("ContentLanguage",e.contentLanguage),Vi("OsVersion",e.osVersion),Vi("Ring",e.ring),Vi("UiHost",e.uiHost),Vi("SessionOrigin",e.sessionOrigin),Vi("UiHostIntegrationType",e.uiHostIntegrationType)]}}}var ji;function Vi(e,t){return null==t?{name:e,string:""}:{name:e,string:t}}function qi(e,t){return null==t?{name:e,bool:!1}:{name:e,bool:t}}!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker"}(ji||(ji={}));var Ji=ji.msoulscat_MSOSP_OTelJS;var Gi={alwaysOnMetadata:void 0,useOneDsLogger:!0,logToUls:!1,oneDsTransportSettings:{enabled:!0,collectorEndpointEnum:"PUBLIC",collectorEndpointUrl:"",eventUploadFrequency:2e3,cacheMemorySizeLimitInNumberOfEvents:1e4,enableCustomerContent:!1,enableDNM:!1},throttlingSettings:{enabled:!0,totalEventsThrottlePerSec:100,singleEventThrottlePerSec:20,eventNamesToBeSuppressedCommaSeparated:""},statsSettings:{taskDurationLogFrequency:20,durationThreshold:100,reportTaskDetails:!1,sessionDurationCutoff:1e4},samplingSettings:{enabled:!1,sampleRate:.02}};function Qi(e,t){return null==e?t:e}function Xi(e,t){return null==e?t:e}function $i(e,t){return null==e?t:e}function Zi(e){var t=[];if(e)for(var n=0;n<e.length;n+=1)t.push.apply(t,Yi(e[n]));return t}function Yi(e,t){e.name||(e.name="DataFieldNameIsMissing");var n=function(e){if(null!=e.string)return 2;if(null!=e.bool)return 1;if(null!=e.int64&&!isNaN(e.int64))return 3;if(null!=e.double&&!isNaN(e.double))return 4;if(null!=e.contract)return 6;if(null!=e.date&&!isNaN(e.date))return 5;return 0}(e),r=t?t+"."+e.name:e.name;switch(n){case 0:return[];case 1:return[_(r,e.bool)];case 2:return[w(r,e.string)];case 3:return[E(r,Math.floor(e.int64))];case 4:return[C(r,e.double)];case 5:return[w(r,new Date(e.date).toISOString())];case 6:return function(e,t){var n=[];if(t.dataFields)for(var r=0;r<t.dataFields.length;r+=1)n.push.apply(n,Yi(t.dataFields[r],e));return n}(r,e.contract);default:throw new Error(n)}}var ea=function(){function e(){this.name="Sampler",this.sampleRate=.02}return e.prototype.enableWithIdentifier=function(e,t){return!("string"!=typeof t||t.length<4)&&(this.samplingValue=function(e){return function(e){for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}(e)%1e3/1e3}(t),this.samplingKey=e,!0)},e.prototype.enableWithSamplingValue=function(e,t){return!(isNaN(t)||t<0||t>=1)&&(this.samplingValue=t,this.samplingKey=e,!0)},e.prototype.enableWithRandomValue=function(){var e=new Uint32Array(1);return!("object"!=typeof window||!window.crypto)&&(window.crypto.getRandomValues(e),this.samplingValue=e[0]%1e3/1e3,this.samplingKey="Random",!0)},e.prototype.setSampleRate=function(e){return e>=0&&e<=1&&(this.sampleRate=e,!0)},e.prototype.getSamplingValue=function(){return this.samplingValue},e.prototype.isMeasuresEnabled=function(){return void 0===this.samplingValue||this.samplingValue<this.sampleRate},e.prototype.processEvent=function(e){var t=e.eventFlags.samplingPolicy;return void 0===this.samplingValue||void 0===t||(1===t?!!this.isMeasuresEnabled()&&(this.addSampleRateField(e,this.sampleRate,this.samplingValue),!0):2!==t&&(this.addSampleRateField(e,1,this.samplingValue),!0))},e.prototype.addSampleRateField=function(e,t,n){e.eventContract||(e.eventContract={name:"",dataFields:[]});var r=e.eventContract.dataFields;r.push(C("Event.SampleRate",t)),r.push(C("Session.SamplingValue",n)),this.samplingKey&&r.push(w("Session.SamplingKey",this.samplingKey)),r.push(_("Session.MeasuresEnabled",this.isMeasuresEnabled()))},e}();function ta(e){return"number"==typeof e}var na,ra,ia=function(){function e(e,t){this._sinkName=e,this._telemetrySink=t,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=e.eventName;if("Office.Telemetry.OTelJS.EventThrottled"===t)return!0;var n=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t]=this._singleEventInLastInterval[t]+1||1,t in this._maxNamedEventsPerSecond?n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxNamedEventsPerSecond[t],"MaxNamedEventsPerSecond",t):ta(this._maxSingleEventPerSecond)&&(n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t)),ta(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,n&&(n=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t))),n},e.prototype.applyThrottle=function(e,t,n,r){return!(e>t)||(e===t+1&&this._telemetrySink&&!this._eventThrottleReported[r]&&(this._eventThrottleReported[r]=!0,this._telemetrySink.sendTelemetryEvent({eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[w("SinkName",this._sinkName||""),w("ThrottledEvent.Name",r),E(n,t)]})),d(2,1,(function(){return"1DS Sink Event Throttle: Exceeded ".concat(t," ").concat(n,": ").concat(r)})),!1)},e}(),aa=function(){function e(e){this.stats=void 0,this.taskStats=void 0,this.config=e,this.logOtelEvent=void 0,this.resetStats()}return e.prototype.setLogOtelTelemetryEventFunc=function(e){this.logOtelEvent=e},e.prototype.resetStats=function(){this.stats={processed:0,sent:0,throttled:0,sampledNotSent:0,dropped:0,droppedDetails:{},eventsProcessingTime:0,taskExecutionTime:0,taskExecutionCount:0,bytesOverWire:0,eventSerializationTime:0,eventTransmissionTime:0,oteljsVersion:"4.13.6"},this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]}},e.prototype.logSessionStatsViaUls=function(){this.computeSessionAverages(),o.sendTraceTag(this.config.tags.sessionStats,Ji,r.Info,JSON.stringify(this.stats))},e.prototype.logSessionStatsViaOTel=function(){if(this.computeSessionAverages(),this.logOtelEvent){var e={eventName:this.config.tags.sessionStatsEventName,dataFields:[{name:"Processed",value:this.stats.processed,dataType:3},{name:"Sent",value:this.stats.sent,dataType:3},{name:"Throttled",value:this.stats.throttled,dataType:3},{name:"SampledNotSent",value:this.stats.sampledNotSent,dataType:3},{name:"Dropped",value:this.stats.dropped,dataType:3},{name:"EventsProcessingTime",value:this.stats.eventsProcessingTime,dataType:3},{name:"TaskExecutionTime",value:this.stats.taskExecutionTime,dataType:3},{name:"TaskExecutionCount",value:this.stats.taskExecutionCount,dataType:3},{name:"BytesOverWire",value:this.stats.bytesOverWire,dataType:3},{name:"AverageProcessingTimeCostPerEvent",value:this.stats.averageProcessingTimeCostPerEvent||0,dataType:3}],eventFlags:{}};this.logOtelEvent(e)}},e.prototype.computeSessionAverages=function(){this.stats.processed>0&&(this.stats.averageTimeCostPerEvent=+((this.stats.eventsProcessingTime+this.stats.taskExecutionTime)/this.stats.processed).toFixed(3),this.stats.averageProcessingTimeCostPerEvent=+(this.stats.eventsProcessingTime/this.stats.processed).toFixed(4),this.stats.averageTaskTimeCostPerEvent=+(this.stats.taskExecutionTime/this.stats.processed).toFixed(4),this.stats.averageNetworkCostPerEvent=+(this.stats.bytesOverWire/this.stats.processed).toFixed(0))},e.prototype.logAndClearTaskStats=function(){this.taskStats.taskExecutionTimes.length<=0||(o.sendTraceTag(this.config.tags.taskStats,Ji,r.Info,this.taskStats.taskExecutionTimes.join(",")),this.config.settings.reportTaskDetails&&o.sendTraceTag(this.config.tags.taskDetailsStats,Ji,r.Info,JSON.stringify(this.taskStats.taskExecutionTimesDetails)),this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]})},e.prototype.recordUploadTaskDuration=function(e,t,n,i){if(e>this.config.settings.durationThreshold&&o.sendTraceTag(this.config.tags.taskDurationThresholdExceeded,Ji,r.Info,"Task took ".concat(e," ms")),this.stats.taskExecutionTime+=e,t>0){var a=+e.toFixed(3);this.stats.taskExecutionCount+=1,this.taskStats.taskExecutionTimes.push(a),this.stats.eventSerializationTime+=n||0,this.stats.eventTransmissionTime+=i||0,this.taskStats.taskExecutionTimesDetails.push({x:Date.now(),e:t,c:a,s:n,t:i}),this.taskStats.taskExecutionTimes.length>=this.config.settings.taskDurationLogFrequency&&this.logAndClearTaskStats()}},e.prototype.checkAndLogPipelineHealth=function(){var e=Date.now()-this.config.sdkInitializationTime;this.stats.processed>0&&0===this.stats.sent&&(this.stats.dropped>0||e>this.config.settings.sessionDurationCutoff)&&o.sendTraceTag(this.config.tags.sdkHealth,Ji,r.Warning,"Telemetry pipeline might be malfunctioning: Processed=".concat(this.stats.processed,", Sent=").concat(this.stats.sent,", Dropped=").concat(this.stats.dropped,", SessionDuration=").concat(e," ms"))},e}(),oa=((na={})[3]="App.Name",na[4]="App.Platform",na[5]="App.Version",na[2]="WAC.Ring",na[1]="Release.AudienceGroup",na),sa=function(e){var t,n,r,i=this;this.eventsProcessed=0;var a=function(e){var t,n=O(e),i=[];if(r.getPreprocessors().forEach((function(e){"EventThrottler"===e.name&&i.push(e)})),N(n,i)){var a=I(n);a.setMilliseconds(0),a.setSeconds(0),a.setMinutes(0),2===n.telemetryProperties.dnmInterval&&a.setHours(0);var o={"Event.Name":n.eventName,"Event.Source":"OTelJS","Event.Time":{value:a.toISOString(),propertyType:gr.DateTime}},s=function(e,t){var n={};return t&&t.forEach((function(t){var r=oa[t];n[r]=e[r]})),n}(r.getOneDSPersistentDataFields(),null===(t=null==e?void 0:e.telemetryProperties)||void 0===t?void 0:t.dnmAllowedPartA);for(var c in s)o[c]=s[c];if(!P(o,n.dataFields,!0,3))return void d(0,1,(function(){return"Dropping Event: "+n.eventName}));var u=function(e){if(e.telemetryProperties&&e.telemetryProperties.dnmToken)return e.telemetryProperties.dnmToken;d(0,1,(function(){return"Missing DNM Token"}))}(n);if(!u)return;return{iKey:u,name:n.eventName,data:o,time:a.toISOString(),baseType:"custom",ext:{sdk:{seq:0},utc:{eventFlags:2097152}}}}};this.initialize=function(i,a){t=a.plugins?a.plugins:[],n=Di(a,"67074e509c164bcaaf85b53c0ad0cde2-13c1c869-7901-4e72-b536-9e754e3b7413-6518",e.endpointUrl,t),a.disableStatsTracking||Ai(i,n),r=i},this.shutdown=function(){null==n||n.shutdown()},this.flush=function(e){null==n||n.flush(e)},this.canHandle=function(e){return 3===e},this.processEvent=function(e){return i.eventsProcessed++,x((function(){var t=a(e);t&&n&&(null==n||n.track(t))}),void 0)}};function ca(e){var t,n,r=(t=e.statsSettings,n={settings:t,tags:{sessionStatsEventName:"Office.Online.Telemetry.OTelJS.OneDS.Session.Stats",sessionStats:593597406,taskStats:593597407,taskDetailsStats:593597408,taskDurationThresholdExceeded:593597409,sdkHealth:593597410},sdkInitializationTime:Date.now()},new aa(n)),i=new va({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.transportSettings,throttlingSettings:e.throttlingSettings,samplingSettings:e.samplingSetings,stats:r,createSinkFunc:ua,createSamplerFunc:la,createThrottlerFunc:fa,collectorPingUrl:"https://browser.events.data.microsoft.com/ping"});return r.setLogOtelTelemetryEventFunc(i.sendOtelTelemetryEvent.bind(i)),i}function ua(e,t,n){var i=function(e,t){var n,i;i=e.collectorEndpointUrl?e.collectorEndpointUrl:function(e){var t=lr[e];void 0===t&&(o.sendTraceTag(593597411,Ji,r.Error,"Unknown 1DS endpoint ".concat(e," - defaulting to Public one")),t=lr.PUBLIC);return t}(e.collectorEndpointEnum);var a={endpointUrl:i,notificationListener:new da(t),uploadFrequency:e.eventUploadFrequency,eventsLimitInMem:e.cacheMemorySizeLimitInNumberOfEvents,stats:{requestProcessingStats:function(e,n){t.recordUploadTaskDuration(e,n)},networkStats:function(e){t.stats.bytesOverWire+=e}},disableStatsTracking:!0,extensionConfig:{PostChannel:{enableCompoundKey:!0}},enableOptionalEvents:!0,nonStandardEventHandlers:[]};e.enableDNM&&(null===(n=a.nonStandardEventHandlers)||void 0===n||n.push(new sa({endpointUrl:lr.PUBLIC})));return a.enableCustomerContent=e.enableCustomerContent,a}(e,n);return new Li(t||[],i)}function la(e,t,n){var r=new ea;return"number"==typeof n&&r.setSampleRate(n),e&&r.enableWithIdentifier("PrimaryIdentityHash",e)||t&&r.enableWithIdentifier("SessionId",t)?r:void 0}function fa(e){return new ia("WACAriaSink",e)}!function(e){e[e.Unknown=0]="Unknown",e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.InvalidEvent=2]="InvalidEvent",e[e.SizeLimitExceeded=3]="SizeLimitExceeded",e[e.KillSwitch=4]="KillSwitch",e[e.QueueFull=5]="QueueFull"}(ra||(ra={}));var da=function(){function e(e){this.reporter=e}return e.prototype.eventsSent=function(e){this.reporter.stats.sent+=e.length},e.prototype.eventsDiscarded=function(e,t){var n=ra[t]||t.toString();this.reporter.stats.droppedDetails[n]=this.reporter.stats.droppedDetails[n]+e.length||e.length,this.reporter.stats.dropped+=e.length},e}();function pa(){return"undefined"==typeof performance||void 0===performance.now?0:performance.now()}var va=function(){function e(e){this._processedEvent=new i,this._throttledEvent=new i,this._logger=new k(void 0,void 0,{disableValidation:!0}),this._enabled=e.transportSettings.enabled,this._throttlingEnabled=e.throttlingSettings.enabled,this._reporter=e.stats,this._collectorPingUrl=e.collectorPingUrl,this._enableCustomerContent=e.transportSettings.enableCustomerContent;var t,n=Zi((t=e.alwaysOnMetadata)?[Ui,Ri,Wi,Bi,zi,Hi,Ki].map((function(e){return e(t)})):[]);this._sink=e.createSinkFunc(e.transportSettings,n,this._reporter),this._logger.addSink(this._sink),this._eventThrottler=e.createThrottlerFunc(this._sink),function(e,t){if(e.setSingleEventThrottle(t.singleEventThrottlePerSec),e.setTotalEventThrottle(t.totalEventsThrottlePerSec),t.eventNamesToBeSuppressedCommaSeparated){t.eventNamesToBeSuppressedCommaSeparated.split(",").forEach((function(t){e.setNamedEventThrottle(t,0)}))}}(this._eventThrottler,e.throttlingSettings),this._eventSampler=void 0,e.samplingSettings.enabled&&e.alwaysOnMetadata&&this.setupSampler(e.createSamplerFunc,e.alwaysOnMetadata,e.samplingSettings.sampleRate)}return e.prototype.setupSampler=function(e,t,n){this._eventSampler=e(t.loggableUserId,t.sessionId,n),this._eventSampler&&o.sendTraceTag(577275598,Ji,r.Info,"Sampler added. Measures enabled: "+this._eventSampler.isMeasuresEnabled())},e.prototype.pingCollectorPingUrl=function(){!function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!0),t.onreadystatechange=function(){4===t.readyState&&(200===t.status?t.responseText.toLowerCase().indexOf("ok")>-1?o.sendTraceTag(593597389,Ji,r.Info,"Collector ping 200 OK."):o.sendTraceTag(593597390,Ji,r.Warning,"Collector ping 200 OK but with invalid response."):o.sendTraceTag(593597391,Ji,r.Warning,"Collector ping returned with HTTP "+t.status.toString()))},t.send()}catch(e){o.sendTraceTag(593597392,Ji,r.Warning,"Collector ping failed with error: "+e.toString())}}(this._collectorPingUrl)},e.prototype.pingCollectorEndpoint=function(){},e.prototype.setTenantToken=function(e,t){t&&this._logger.setTenantToken(e,t,-1)},e.prototype.setDNMToken=function(e,t){t&&this._logger.setDNMToken(e,t)},e.prototype.processEvent=function(e,t){var n=!1,r=!1,i=pa(),a=O(e);this._throttlingEnabled&&!this._eventThrottler.processEvent(a)?n=!0:this._enabled&&(this._eventSampler&&!this._eventSampler.processEvent(a)?r=!0:t(a)),this._reporter.stats.eventsProcessingTime+=pa()-i,n?(this._reporter.stats.throttled+=1,this._throttledEvent.fireEvent(e)):r?this._reporter.stats.sampledNotSent+=1:(this._reporter.stats.processed+=1,this._processedEvent.fireEvent(e))},e.prototype.sendOtelCustomerContent=function(e,t){var n=this;this._enableCustomerContent&&this._logger.sendCustomerContent&&this.processEvent(e,(function(e){e.timestamp=t,n._logger.sendCustomerContent(e)}))},e.prototype.sendOtelDirectNumeric=function(e,t){var n=this;this.processEvent(e,(function(e){e.timestamp=t,n._logger.sendDirectNumericEvent&&n._logger.sendDirectNumericEvent(e)}))},e.prototype.sendOtelTelemetryEvent=function(e,t){var n=this;this.processEvent(e,(function(e){e.timestamp=t,n._logger.sendTelemetryEvent(e)}))},e.prototype.flush=function(e){this._sink instanceof Li&&this._sink.flush(e)},e.prototype.shutdown=function(){this._enabled&&(this._reporter.logSessionStatsViaOTel(),this._sink.shutdown()),this._reporter.logSessionStatsViaUls(),this._reporter.logAndClearTaskStats(),this._reporter.checkAndLogPipelineHealth()},e.prototype.getStats=function(){return this._reporter},e.prototype.onProcessedEvent=function(){return this._processedEvent},e.prototype.onThrottledEvent=function(){return this._throttledEvent},e}();var ga,ha=[{namespace:"Office.Online",ariaTenant:"79b56d2f6f2444f1a3d7f7c7f12bcc0c-f47f5fe6-ed89-42f6-8a43-cea0f5930b17-7407"},{namespace:"Office.Word.Online.Data",ariaTenant:"7e7959aac92e41d6892c69a87259ed58-de5c63ef-10f5-45e1-bef2-d23e9cac2fab-6830"},{namespace:"Office.Excel.Online.Data",ariaTenant:"011776870b754a649aedc9456ac07a97-6bd8247c-11d3-4599-b599-ec9ef6d401f6-6722"},{namespace:"Office.PowerPoint.Online.Data",ariaTenant:"35612b11d234460da5c673d7b172fd93-f8762c6b-96cb-4e60-87fa-015aac0c2ff1-7212"},{namespace:"Office.OneNote.Online.Data",ariaTenant:"86258c80efed47d9b34bf77fc663b381-af82a060-b49f-448b-baf0-956ba7709592-7634"},{namespace:"Office.Visio.Online.Data",ariaTenant:"77fd25a525d24b7f9b924307de0cc70f-5f2b6ec0-f1d2-40dd-b875-e6bd2849e1eb-7539"},{namespace:"Office.Shared.Online.Data",ariaTenant:"4ad8b2b2029e481fb82edb7aac29de59-94494dd8-b684-4f92-ab7f-6b414eb77798-7917"},{namespace:"Office.Word.Online",ariaTenant:"ff7e2f12a4be407096fc01eeb760eda3-eeeb63cf-35d9-4734-ab45-66a873412359-7045"},{namespace:"Office.Excel.Online",ariaTenant:"fad3bd1d8e4b4c06894bd7bac80e4f02-67df67b4-f1fd-4ecd-9d55-4d41540b1757-7724"},{namespace:"Office.PowerPoint.Online",ariaTenant:"b664cab4b3f24a739be75b93b026749e-65c206a3-a985-48b4-8b50-36c56c3ce309-7201"},{namespace:"Office.OneNote.Online",ariaTenant:"1705ef36a51840648341da866d62baf8-ddbcd60b-4ce4-48da-96be-ad5f28b48954-8035"},{namespace:"Office.Visio.Online",ariaTenant:"a9b6cb604fe942a89c8671aab85364f6-af0f81b1-c5ce-419a-82d5-af38c33ebea3-7250"},{namespace:"Office.Shared.Online",ariaTenant:"d034371e26194a76a187c7108b3837ca-731725e8-1dc7-4eca-a754-b09c9d2b8dd5-6502"},{namespace:"Office.Word.Online.Health",ariaTenant:"e064ef4d9cdb454d9eddb2f7f7a94c83-89a6d9df-7218-4efd-bcd4-16ea059deea2-7672"},{namespace:"Office.Excel.Online.Health",ariaTenant:"e76e8055912d482eb56ea5dad2fd5a97-5552f2bb-d1eb-4843-95d7-3019215328a0-6899"},{namespace:"Office.PowerPoint.Online.Health",ariaTenant:"706f939c0d24440ba8dfb0838ed33611-d60b1956-db23-4410-a59d-e7fa08d4217f-7388"},{namespace:"Office.OneNote.Online.Health",ariaTenant:"c6393e4ed4b94e3baf9a46aa6585dce0-c1b3b0c6-b44c-4121-8eae-311d31e67bb6-7176"},{namespace:"Office.Visio.Online.Health",ariaTenant:"c4999163c49d49c99a1649b404873d24-a62a394b-ad47-45f0-92fa-fd4085dc8bb3-7324"},{namespace:"Office.Shared.Online.Health",ariaTenant:"2800319cefba4489867c1ff30d41e7e1-ea67d761-9485-4d25-bc39-f3144e34b773-6869"},{namespace:"Office.Telemetry",ariaTenant:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405"},{namespace:"Office.System",ariaTenant:"cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521"},{namespace:"Office.TellMe",ariaTenant:"31d9dd3e4c7046a696537586281d7ed1-06d11dd6-a946-4281-8ac3-a7c2ab4776f5-7063"},{namespace:"Office.Voice",ariaTenant:"9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162"},{namespace:"Office.Insights",ariaTenant:"250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487"},{namespace:"Office.Graphics",ariaTenant:"cfcfdb91c68c4329bb8b7cb7babb3cf7-e082c2f2-ef1d-427a-ac4d-b0b700afe7a7-7655"},{namespace:"Office.AugLoop",ariaTenant:"3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770"},{namespace:"Office.FileIO",ariaTenant:"d2b065c5ae634beb9cec4813140e22da-eda42ada-ffd9-4e26-92a1-e3b440eaf8bf-7717"},{namespace:"Office.Sandbox",ariaTenant:"1cd66059dc1d41f1887e3770ea8ba967-f1d0108c-8535-4cf9-bf23-ec8227f6afa7-6999"},{namespace:"Office.UX",ariaTenant:"c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879"},{namespace:"Office.Extensibility",ariaTenant:"db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439"}],ma=[{namespace:"Office.DNM.Visio.Online",ariaTenant:"feba3d98f7c0481c8b63754573a80618-7311e9e0-365d-4a1b-b0fb-a238e0bc7528-6955"},{namespace:"Office.DNM.Sandbox",ariaTenant:"b0aae8a3009047b9bf4d3b17439319b6-e96e56cc-5657-463a-a2f2-dc8c0fb9d41b-7136"}],ya=!1,Ta="",ba="",Sa="unknown";function _a(e){if(ya)throw new Error("Telemetry is already initialized!");if(!e.ulsLogger)throw new Error("Must provide a ULS logger!");var t;!function(e){if(!e)throw new Error("The 'logger' argument is missing");o.setLogger(e)}(e.ulsLogger),e.loggingCategory&&(t=e.loggingCategory,Ji=t),e.alwaysOnMetadata&&(Sa="".concat(e.alwaysOnMetadata.name,", ")+"".concat(e.alwaysOnMetadata.applicationMode,", ")+"".concat(e.alwaysOnMetadata.applicationModeExtended)),o.sendTraceTag(595947925,Ji,r.Info,"Initializing Otel library [".concat(Sa,"] with settings ").concat(function(e){return JSON.stringify(e,(function(e,t){if("alwaysOnMetadata"!==e)return t}))}(e))),function(e){e.alwaysOnMetadata&&(null==e.alwaysOnMetadata.name||""===e.alwaysOnMetadata.name?(Ta="Office.Online.UserAction",ba="Office.Online.Data.Activity",o.sendTraceTag(595900060,Ji,r.Info,"Cannot determine the App for UserActionEvent, using generic UserAction event name.")):(Ta="Office.".concat(e.alwaysOnMetadata.name,".Online.UserAction."),ba="Office.".concat(e.alwaysOnMetadata.name,".Online.Data.Activity.")))}(e);var n=function(e){return ca({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.oneDsTransportSettings,throttlingSettings:e.throttlingSettings,statsSettings:e.statsSettings,samplingSetings:e.samplingSettings})}(function(e){return{alwaysOnMetadata:e.alwaysOnMetadata||Gi.alwaysOnMetadata,useOneDsLogger:Qi(e.otelUseOneDsSink,Gi.useOneDsLogger),logToUls:Qi(e.sendToUls,Gi.logToUls),oneDsTransportSettings:{enabled:Qi(e.sendToAria,Gi.oneDsTransportSettings.enabled),collectorEndpointEnum:$i(e.ariaEndpointTarget,Gi.oneDsTransportSettings.collectorEndpointEnum),collectorEndpointUrl:$i(e.ariaEndpointUrl,Gi.oneDsTransportSettings.collectorEndpointUrl),eventUploadFrequency:Xi(e.eventUploadFrequency,Gi.oneDsTransportSettings.eventUploadFrequency),cacheMemorySizeLimitInNumberOfEvents:Xi(e.cacheMemorySizeLimitInNumberOfEvents,Gi.oneDsTransportSettings.cacheMemorySizeLimitInNumberOfEvents),enableCustomerContent:Qi(e.enableCustomerContent,Gi.oneDsTransportSettings.enableCustomerContent),enableDNM:Qi(e.enableDNM,Gi.oneDsTransportSettings.enableDNM)},throttlingSettings:{enabled:Qi(e.wacAriaThrottlingIsEnabled,Gi.throttlingSettings.enabled),totalEventsThrottlePerSec:Xi(e.wacAriaTotalEventsThrottlePerSec,Gi.throttlingSettings.totalEventsThrottlePerSec),singleEventThrottlePerSec:Xi(e.wacAriaSingleEventThrottlePerSec,Gi.throttlingSettings.singleEventThrottlePerSec),eventNamesToBeSuppressedCommaSeparated:$i(e.otelEventNamesToBeSuppressedCommaSeparated,Gi.throttlingSettings.eventNamesToBeSuppressedCommaSeparated)},statsSettings:{taskDurationLogFrequency:Xi(e.taskDurationLogFrequency,Gi.statsSettings.taskDurationLogFrequency),durationThreshold:Xi(e.taskDurationLogThreshold,Gi.statsSettings.durationThreshold),reportTaskDetails:Qi(e.reportTaskDetails,Gi.statsSettings.reportTaskDetails),sessionDurationCutoff:Gi.statsSettings.sessionDurationCutoff},samplingSettings:{enabled:Qi(e.samplingIsEnabled,Gi.samplingSettings.enabled),sampleRate:Xi(e.sampleRate,Gi.samplingSettings.sampleRate)}}}(e));e.sendToUls&&(n.onProcessedEvent().addListener(Pa),n.onThrottledEvent().addListener(xa)),f.addListener((function(t){!function(e,t){if(2===e.category&&!t)return;o.sendTraceTag(595947933,Ji,function(e){switch(e){case 3:return r.Verbose;case 2:return r.Info;case 1:return r.Warning;case 0:return r.Error;default:throw new Error(e)}}(e.level),e.message())}(t,e.enableAdditionalDiagnosticTracing||!1)})),ha.forEach((function(e){n.setTenantToken(e.namespace,e.ariaTenant)})),ma.forEach((function(e){n.setDNMToken(e.namespace,e.ariaTenant)})),e.pingCollectorPingUrl&&n.pingCollectorPingUrl(),e.pingCollectorEndpoint&&n.pingCollectorEndpoint(),ga=n,ya=!0,o.sendTraceTag(595947926,Ji,r.Info,"Successfully initialized Otel library")}function Ea(e,t){Ia();var n=function(e){if(!e.name)throw new Error("Event is missing a name");var t=Zi(e.dataFields),n={eventName:e.name,dataFields:t,eventFlags:{}};return 1===e.samplingPolicy&&(n.eventFlags={samplingPolicy:1}),n}(e);ga.sendOtelTelemetryEvent(n,t)}function Ca(e,t){Ia();var n=function(e){if(!e.name)throw new Error("Event is missing a name");var t=Zi(e.dataFields),n={eventName:e.name,dataFields:t,eventFlags:{},telemetryProperties:{dnmInterval:e.dnmInterval,dnmAllowedPartA:[]}};return e.dnmAllowedPartA&&e.dnmAllowedPartA.forEach((function(e){if(e){var t=e;t&&n.telemetryProperties.dnmAllowedPartA.push(t)}})),n}(e);ga.sendOtelDirectNumeric(n,t)}function wa(e,t){Ia(),null!=e&&null!=e.name&&(e.name.indexOf("Office.")>=0||(e.name=ba+e.name));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0),(null==e.count||isNaN(e.count))&&(e.count=1),null==e.aggMode&&(e.aggMode=0);var t=Math.floor(1e3*e.durationMs),n=Zi(e.dataFields),r=B.getFields({cV:e.CV||void 0,duration:t,count:e.count,aggMode:e.aggMode,success:e.succeeded});return{eventName:e.name,eventContract:{name:B.contractName,dataFields:r},dataFields:n,eventFlags:{}}}(e);ga.sendOtelTelemetryEvent(n,t)}function Oa(e,t){Ia(),null==e.name&&(e.name=Ta,null!=e.actionName&&(e.name+=e.actionName));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0);var t=Math.floor(1e3*e.durationMs);null==e.dataFields&&(e.dataFields=[]);var n=Zi(e.dataFields),r=K({id:null==e.actionId?void 0:e.actionId,name:null==e.actionName?void 0:e.actionName,commandSurface:null==e.commandSurface?void 0:e.commandSurface,parentName:null==e.parentName?void 0:e.parentName,triggerMethod:null==e.triggerMethod?void 0:e.triggerMethod,timeOffsetMs:null==e.timeOffsetMs?void 0:e.timeOffsetMs});n.push.apply(n,r);var i=B.getFields({duration:t,count:1,aggMode:0,success:e.succeeded});return{eventName:e.name,eventContract:{name:B.contractName,dataFields:i},dataFields:n,eventFlags:{}}}(e);ga.sendOtelTelemetryEvent(n,t)}function ka(e){var t,n=e.otelEvent;if(!n||!n.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){var r=Zi(e.additionalDataFields);(t=n.dataFields).push.apply(t,r)}return n}function Pa(e){o.sendTraceTag(595947932,Ji,r.Info,"Processed TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function xa(e){o.sendTraceTag(593597440,Ji,r.Warning,"Throttled TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function Ia(){if(!ya)throw new Error("Telemetry is not initialized!")}function Na(e){switch(e.kind){case"event":try{Ea(e.event)}catch(t){o.sendTraceTag(595947920,Ji,r.Error,"".concat("Error while processing"," TelemetryEvent ").concat(e.event.name," : ").concat(Ma(t)))}break;case"dnm":try{Ca(e.event)}catch(t){o.sendTraceTag(512324692,Ji,r.Error,"".concat("Error while processing"," TelemetryEvent ").concat(e.event.name," : ").concat(Ma(t)))}break;case"activity":try{wa(e.event)}catch(t){o.sendTraceTag(595947921,Ji,r.Error,"".concat("Error while processing"," ActivityEvent ").concat(e.event.name," : ").concat(Ma(t)))}break;case"action":try{Oa(e.event)}catch(t){o.sendTraceTag(595928211,Ji,r.Error,"".concat("Error while processing"," UserActionEvent ").concat(e.event.name," : ").concat(Ma(t)))}break;case"otel":try{!function(e){Ia(),ga.sendOtelTelemetryEvent(ka(e))}(e.event)}catch(i){var t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(595947922,Ji,r.Error,"".concat("Error while processing"," OtelEvent ").concat(t," : ").concat(Ma(i)))}break;case"otelcc":try{!function(e){Ia(),ga.sendOtelCustomerContent(ka(e))}(e.event)}catch(i){t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(572298211,Ji,r.Error,"".concat("Error while processing"," OTel CustomerContent ").concat(t," : ").concat(Ma(i)))}break;case"oteldnm":try{!function(e){Ia(),ga.sendOtelDirectNumeric(ka(e))}(e.event)}catch(i){var n;t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(512566404,Ji,r.Error,"".concat("Error while processing"," OTel DNM ").concat(t," : ").concat(Ma(i)))}break;case"addNamespaceMapping":try{i=e.namespace,a=e.ariaTenantToken,Ia(),ga.setTenantToken(i,a)}catch(t){o.sendTraceTag(595947923,Ji,r.Error,"".concat("Error while adding"," namespace mapping for ").concat(e.namespace," : ").concat(Ma(t)))}break;case"setDNMToken":try{!function(e,t){Ia(),ga.setDNMToken(e,t)}(e.namespace,e.ariaTenantToken)}catch(t){o.sendTraceTag(512566403,Ji,r.Error,"".concat("Error while adding"," DNM namespace mapping for ").concat(e.namespace," : ").concat(Ma(t)))}break;case"shutdown":try{Ia(),o.sendTraceTag(595947931,Ji,r.Info,"Otel library shutdown triggered [".concat(Sa,"]")),ga.shutdown()}catch(e){o.sendTraceTag(595947924,Ji,r.Error,"".concat("Error while processing"," shutdown event : ").concat(Ma(e)))}break;case"flush":try{Ia(),ga.flush(!0)}catch(e){o.sendTraceTag(559810652,Ji,r.Error,"".concat("Error while processing"," flush event : ").concat(Ma(e)))}break;default:throw new Error(e)}var i,a}function Ma(e){return e instanceof Error?e.message?e.message:"":null!=e.message?e.message:JSON.stringify(e)}var Da=new(function(){function e(){}return e.prototype.initialize=function(e){if(!e)throw new Error("Must supplied valid telemetry settings!");_a(e)},e.prototype.processTelemetryEvent=function(e){Na(e)},e}());n.d(t,"TelemetryFullGlobal",(function(){return Da})),n.d(t,"initializeEventProcessor",(function(){return _a})),n.d(t,"processEvent",(function(){return Na}))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(0),i=n(5),a=((Object(i.a)()||{}).Symbol,(Object(i.a)()||{}).Reflect,r.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])r.f[r.i].call(t,a)&&(e[a]=t[a]);return e}),o=function(e,t){return(o=r.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[r.i](n)&&(e[n]=t[n])})(e,t)};function s(e,t){function n(){this.constructor=e}typeof t!==r.h&&null!==t&&Object(i.c)("Class extends value "+String(t)+" is not a constructor or null"),o(e,t),e[r.k]=null===t?Object(i.b)(t):(n[r.k]=t[r.k],new n)}function c(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}}]);
//# sourceMappingURL=otelFullNext.min.js.map