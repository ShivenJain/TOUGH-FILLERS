'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1E3:function(J,V,d){d.r(V);J=d(0);var h=d(375),e=d(13),m=d(1021),n=d(342),v=d(17);class A{constructor(y){this.messageId=y;this.n_k=(new Date).getTime();this.kbe=new v.a}}Object(J.a)(A,"MessageLatencyDetails",null,[]);d.d(V,"ClientToClientMessageTelemetry",function(){return w});class w{constructor(y,u,E){this.ioa=null;this.Lwd=this.rBd=0;this.Gc=u;this.Ldf=E;this.LQb=!1;this.Vk=y;this.Vk.Eza(Object(e.a)(this,
this.THk,"receiveMessage"))}start(){if(this.Ldf&&!this.LQb){const y=this.Gc.Ogh;this.Lwd=this.Gc.Lgh;y<=this.Lwd?(h.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.Gc.Ogh,this.Gc.Lgh),this.Ldf=!1):(this.LQb=!0,this.rBd=window.setInterval(Object(e.a)(this,this.sendMessage,"sendMessage"),y))}}sendMessage(){if(this.LQb){const y=n.a.create().toString();
this.ioa=new A(y);this.Vk.ZBe(16,y,!1,new m.a);window.setTimeout(()=>{this.LWj(y)},this.Lwd)}}LWj(y){this.ioa&&this.ioa.messageId===y&&(0<this.ioa.kbe.count?(y=this.ioa.kbe.toArray().join(","),h.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",y)):h.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.ioa=null)}stop(){this.rBd&&(window.clearInterval(this.rBd),this.LQb=!1)}THk(y,u){16===u.type?this.Vk.ZBe(17,u.nxa,!1,new m.a):17===u.type&&this.LQb&&u.nxa&&
this.ZAk(u.nxa)}ZAk(y){y&&this.ioa&&y.toString()===this.ioa.messageId&&this.ioa.kbe.add((new Date).getTime()-this.ioa.n_k)}static get instance(){return w.Ja}static F8i(y,u,E){return w.instance||(w.Ja=new w(y,u,E))}}w.Ja=null;Object(J.a)(w,"ClientToClientMessageTelemetry",null,[])},1092:function(J,V,d){d.r(V);d.d(V,"RealtimeChannelMetrics",function(){return v});J=d(0);var h=d(375),e=d(179),m=d(101),n=d(184);class v{constructor(){this.Zef=this.$ef=this.aff=this.Xef=this.Wef=this.Yef=this.fPb=this.Vxd=
0;this.prc=this.iwd=this.rOb=this.Zvd=this.$vd=this.Rvd=this.gLa=this.lOb=this.ukb=this.Qvd=this.nrc=this.Hjb=null;this.Qwd=this.OOb=this.Jtf=this.OXe=0;this.Ndf=!1;this.Nbd=this.pCe;this.sCe=this.tCe;this.Obd=this.rCe;this.mhc=this.vCe;this.gah=this.uCe;this.CCe=this.DCe;this.zCe=this.ACe;this.Ydb=this.xCe;this.ohc=this.yCe;this.bah=this.qCe;this.yBb=this.Rse;this.rcc=this.Sse}pCe(){this.Vxd++;this.Qvd=new Date;this.Hjb||(this.Hjb=new Date)}tCe(){this.fPb++;this.gLa=new Date;this.nrc||(this.nrc=
this.gLa);this.rOb=this.gLa;this.fqi()}rCe(){this.Yef++;this.Rvd=new Date}vCe(){this.Wef++;this.ukb=new Date}uCe(){this.Xef++;this.lOb=new Date}ACe(){this.$vd=new Date;this.aff++}yCe(){this.prc||(this.prc=new Date);this.$ef++}xCe(){this.Zvd=new Date;this.Zef++}DCe(){if(!this.Ndf&&this.Vxd){var A=this.vDc();h.ULS.sendTraceTag(39321871,500,15,m.a.toJSON(A));this.Ndf=!0}}qCe(A){let w,y;({y4d:A,z4d:w,Ui:y}=n.RtcUtils.Y0f(A));A&&A!==e.a.Yy&&(h.ULS.sendTraceTag(40157596,500,15,m.a.toJSON({["HttpErrorCode"]:A,
["HttpErrorStatus"]:w,["Exception"]:y})),e.a.Brg(A)&&this.OXe++,e.a.Dwg(A)&&this.Jtf++)}Rse(){this.iwd=new Date}Sse(){this.ukb=this.rOb=new Date}vDc(){return{["numberOfConnectionAttempts"]:this.Vxd,["numberOfSuccessfulConnections"]:this.fPb,["numberOfFailedConnections"]:this.Yef,["numberOfDisconnectedConnections"]:this.Wef,["numberOfExplicitDisconnectedConnections"]:this.Xef,["numberOfSentMessages"]:this.aff,["numberOfReceivedMessages"]:this.$ef,["numberOfLostMessages"]:this.Zef,["firstConnectionAttempt"]:this.Hjb?
this.Hjb:null,["firstMessageReceived"]:this.prc?this.prc:null,["firstConnectionSuccess"]:this.nrc?this.nrc:null,["lastConnectionAttempt"]:this.Qvd?this.Qvd:null,["lastConnectionSuccess"]:this.gLa?this.gLa:null,["lastConnectionFailure"]:this.Rvd?this.Rvd:null,["lastMessageSent"]:this.$vd?this.$vd:null,["lastMessageLost"]:this.Zvd?this.Zvd:null,["lastDisconnect"]:this.ukb?this.ukb:null,["lastExplicitDisconnect"]:this.lOb?this.lOb:null,["lastTimeOnline"]:this.rOb?this.rOb:null,["lastTimeOffline"]:this.iwd?
this.iwd:null,["maxDisconnectedTimeMs"]:this.OOb,["maxExplicitDisconnectedTimeMs"]:this.Qwd,["clientConnectionErrors"]:this.OXe,["serverConnectionErrors"]:this.Jtf}}fqi(){this.Hjb&&1===this.fPb&&(this.OOb=Math.max(this.OOb,this.gLa.getTime()-this.Hjb.getTime()));this.ukb&&1<this.fPb&&(this.OOb=Math.max(this.OOb,this.gLa.getTime()-this.ukb.getTime()));this.lOb&&1<this.fPb&&(this.Qwd=Math.max(this.Qwd,this.gLa.getTime()-this.lOb.getTime()))}static createInstance(A){v.Ja||(v.Ja=new v,h.ULS.sendTraceTag(39321870,
500,50,"RealtimeChannelMetrics initialized for client {0}",A));return v.Ja}}v.Ja=null;Object(J.a)(v,"RealtimeChannelMetrics",null,[622,248])},1093:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.yJb=e;this.VWf=m}}Object(J.a)(h,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1094:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.unspecified=0]="unspecified";e[e.word=1]="word";e[e.excel=2]="excel";e[e.powerPoint=
3]="powerPoint";e[e.test=4]="test";e[e.wacFrontEnd=5]="wacFrontEnd";e[e.oneNote=6]="oneNote";e[e.visio=7]="visio";e[e.officeMobile=8]="officeMobile";e[e.cosmosDBChangefeed=9]="cosmosDBChangefeed";e[e.last=10]="last"})(h||(h={}));Object(J.b)("RtcClientAppName",h)},1099:function(J,V,d){J=d(0);var h=d(375),e=d(13),m=d(227),n=d(228);class v{static cYd(Z,oa,Ba){return v.dYd(Z,oa,Ba,!0)}static dYd(Z,oa,Ba,Ma){const za=document.createElementNS(v.Shb,"svg");za.setAttribute("viewBox",String.format(v.jQd,v.Snc,
v.Rnc));za.appendChild(v.f1d(Z,oa,Ba,Ma));return za}static f1d(Z,oa,Ba,Ma){const za=v.Snc/Z,ka=oa/2*za,qa=v.Rnc/2;let Ja=0;Ma&&(Ja=(Z-3*oa-4*Ba)*za/2);Z=document.createElementNS(v.Shb,"g");Sys.UI.DomElement.addCssClass(Z,v.iQd);for(Ma=1;3>=Ma;Ma++)Z.appendChild(v.AXd(Ma,ka,Ja+(Ma*(oa+Ba)-oa/2)*za,qa));return Z}static AXd(Z,oa,Ba,Ma){const za=document.createElementNS(v.Shb,"circle");Sys.UI.DomElement.addCssClass(za,String.format("{0}-{1}",v.WLd,Z));za.setAttribute("cx",String.format("{0}",Ba));za.setAttribute("cy",
String.format("{0}",Ma));za.setAttribute("r",String.format("{0}",oa));return za}}v.Shb="http://www.w3.org/2000/svg";v.iQd="prDancingDots";v.WLd="prAnimateCircle";v.jQd="0 0 {0} {1}";v.Rnc=40;v.Snc=120;Object(J.a)(v,"ModernPresenceTooltipDancingDots",null,[]);var A=d(25),w=d(169),y=d(72),u=d(65),E=d(131),G=d(193),I=d(95),H=d(45),K=d(2);class C extends m.a{constructor(Z,oa){super(Z);this.VRb=this.kR=this.i_a=this.kM=this.fM=this.Ko=this.tn=null;this.BH=oa.get(8,!1);this.hR=oa.get(6,0);this.hEd=oa.get(15,
!1);this.Gc=oa;this.pMb=0;this.element=Z;this.element.className=C.z5a;this.ps=document.createElement("span");this.element.appendChild(this.ps);this.prd=v.cYd(oa.get(6,0),4,2);this.$I(oa);this._state=5}VU(Z){this.addHandler(n.a.Qo,Z)}S_(Z){this.removeHandler(n.a.Qo,Z)}get user(){return this.VRb}get state(){return this._state}dispose(){this.element&&(this.tn.xb(u.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.tn.xb(u.a.doubleClick,this.element,Object(e.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),
this.Ko.xb(u.a.pointerDown,this.element,Object(e.a)(this,this.Zua,"onPointerDown")),this.Ko.xb(u.a.pointerOut,this.element,Object(e.a)(this,this.Py,"onPointerOut")),this.Ko.xb(u.a.pointerOver,this.element,Object(e.a)(this,this.jC,"onPointerOver")),this.fM.xb(this.element,Object(e.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}$I(Z){this.tn=Z.get(10);this.tn.ob(u.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.tn.ob(u.a.doubleClick,this.element,Object(e.a)(this,
this.lx,"stopPropagationAndPreventDefaultBehavior"));this.Ko=Z.get(9);this.Ko.ob(u.a.pointerOver,this.element,Object(e.a)(this,this.jC,"onPointerOver"));this.Ko.ob(u.a.pointerOut,this.element,Object(e.a)(this,this.Py,"onPointerOut"));this.Ko.ob(u.a.pointerDown,this.element,Object(e.a)(this,this.Zua,"onPointerDown"));this.fM=Z.get(13);this.fM.ob(this.element,Object(e.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior"))}hide(Z=null,oa=0,Ba=0){this.hEd&&Z?this.CLe(Z,oa,Ba):(3===this.state&&this.Lhc(),
this.visible=!1,this._state=5)}CLe(Z,oa,Ba=0){this.show(Z,oa,15,4,void 0,Ba)}xkc(Z,oa,Ba,Ma=!1,za=!1,ka=!1,qa=0){this.show(Z,oa,Ba+20,Ma?2:za?1:0,ka,qa)}kLe(Z,oa,Ba,Ma=!1,za=0){this.show(Z,oa,Ba+20,3,Ma,za)}show(Z,oa,Ba,Ma=3,za=!1,ka=0){!Z||Ma===this.state&&this.G3d(oa,Ba)||(this.mFd(Ma,za,ka),this.lz(Z,Ma,ka),this._state=Ma,4===ka||0===ka&&!this.BH?this.element.style.left=oa+"px":this.element.style.right=oa+"px",this.element.style.top=Ba+"px",this.visible=!0)}lz(Z,oa,Ba){this.VRb=Z;I.a.$t(this.ps);
G.a.DNf(this.ps);this.ps.id="fly_"+Z.clientId;this.ps.style.backgroundColor=Z.color;4!==oa?(this.ps.style.height=this.hR+"px",this.ps.style.lineHeight=this.hR+"px",G.a.FX(this.ps,"border-radius",this.hR+"px")):4===Ba||0===Ba&&!this.BH?this.ps.style.left="0px":this.ps.style.right="0px";2!==oa&&(4===oa?I.a.ix(this.ps,""):1===oa?this.ps.appendChild(this.prd):(this.ps.setAttribute("dir","auto"),Ba=H.a.pZd(Z.userName,!1),(!Z.isAnonymous||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",
!1))&&Ba||0!==oa?(Z=Z.userName,0===oa&&(Z=Ba,G.a.FX(this.ps,"text-align","center")),I.a.ix(this.ps,Z)):(this.kM||(this.kM=this.qOd()),this.ps.appendChild(this.kM),G.a.FX(this.ps,"text-align","start"))))}onClick(Z){if(0===this.state)return this.raiseEvent(n.a.Qo,new n.a(1,Z)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}Py(Z){3===this.state&&this.raiseEvent(n.a.Qo,new n.a(3,Z));return!1}jC(Z){3!==Z.Vf&&this.raiseEvent(n.a.Qo,new n.a(2,Z));return!1}Zua(Z){if(3!==
Z.Vf)return!0;this.raiseEvent(n.a.Qo,new n.a(4,Z));return!1}qOd(){const Z=document.createElement("img");Z.src=w.a.cK("doughperson_white_glyph.svg");Z.setAttribute("Unselectable","on");E.a.lO(Z,E.a.We,E.a.wM);return y.createClusteredImageFromClusterWithImageClass(this.hR,this.hR,null,null,C.OVd,"",!1,"",this.element.ownerDocument,Z)}mFd(Z,oa=!1,Ba=0){if(!this.Mia(this.state)||!this.Mia(Z))switch(Sys.UI.DomElement.removeCssClass(this.element,this.i_a),this.state){case 4:3===Z?this.sM(C.A5a,C.zZb):this.Mia(Z)&&
this.sM(C.y5a,C.zZb);break;case 3:4===Z?this.sM(C.C5a,C.yZb):this.Mia(Z)&&(oa&&this.Lhc(),this.sM(C.y5a,C.yZb,oa?C.NVd:""));break;case 0:case 1:case 2:4===Z?this.sM(C.C5a,C.B5a):3===Z&&(oa&&this.yFd(),this.sM(C.A5a,C.B5a,oa?C.AZb:"",3===Ba?C.QVd:C.PVd));break;default:4===Z?this.sM(C.C5a):3===Z?this.sM(C.A5a):this.Mia(Z)&&this.sM(C.y5a)}}sM(...Z){this.i_a=Z.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.i_a)}yFd(){this.pMb=window.setTimeout(()=>{this.element&&(this.kR=this.element.cloneNode(!0),
this.element.parentNode.appendChild(this.kR),this.element.style.zIndex="2",this.kR.style.zIndex="1")},300)}Lhc(){window.clearTimeout(this.pMb);this.kR&&(Sys.UI.DomElement.removeCssClass(this.kR,C.B5a+" "+C.AZb),Sys.UI.DomElement.addCssClass(this.kR,C.MVd),K.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.kR.parentNode&&this.element.parentNode.removeChild(this.kR)}),G.a.AEb(this.element,"z-index"))}Mia(Z){return 0===Z||1===Z||2===Z}G3d(Z,oa){const Ba=G.a.ZG(this.element.style.top);
return G.a.ZG(this.element.style.left)===Z&&Ba===oa}Ceb(Z){3===Z&&G.a.gP(this.element,"left")?(Z=G.a.ZG(this.element.style.left),G.a.AEb(this.element,"left"),this.element.style.right=-1*Z+"px"):4===Z&&G.a.gP(this.element,"right")&&(Z=G.a.ZG(this.element.style.right),G.a.AEb(this.element,"right"),this.element.style.left=-1*Z+"px")}}C.z5a="prModernFlyout UIFont";C.C5a="flyoutIdle";C.A5a="flyoutExpanded";C.y5a="flyoutCollapsed";C.zZb="flyoutFromIdle";C.yZb="flyoutFromExpanded";C.B5a="flyoutFromCollapsed";
C.AZb="flyoutStacked";C.NVd="flyoutFromStacked";C.MVd="flyoutFadeOut";C.OVd="cui-img-cont-float cui-img-20by20";C.PVd="flyoutLtrDir";C.QVd="flyoutRtlDir";Object(J.a)(C,"ModernPresenceTooltipFlyoutControl",m.a,[]);class Y{constructor(Z,oa,Ba=2,Ma=4){this.offsetTop=Z;this.offsetLeft=oa;this.Mnc=Ba;this.V1b=Ma}}Object(J.a)(Y,"FlyoutsPositioningInfo",null,[]);var M=d(62);class P{constructor(Z=!1,oa=!1){this.Qi=Z;this.O_a=oa}yZd(Z,oa,Ba,Ma,za,ka,qa){const Ja=qa.y,xa=qa.height;var Ga=this.sXd(ka);const na=
Ga+oa;za=Z*Ba+(Z-1)*za;Ba=null;1===Z||this.TKd(Ga,za,Ja,xa)?Z=new Y(0,0,2):(Z=this.AVd(na,za,Ja,xa),Z.offsetTop-=Ga);this.O_a?Ba=new Y(0,0,void 0,this.Qi?4:3):(ka=this.rXd(ka,qa),Ga=Math.max(0,qa.x),qa=qa.width,oa=ka+oa,this.UKd(ka,Ma,Ga,qa)?Ba=new Y(0,0,void 0,this.Qi?3:4):this.VKd(oa,Ma,Ga)&&(Ba=new Y(0,0,void 0,this.Qi?4:3)),Ba||(Ba=this.zVd(ka,oa,Ga,qa)));return new Y(Z.offsetTop,Ba.offsetLeft,Z.Mnc,Ba.V1b)}sXd(Z){return M.a.zKc(Z)}rXd(Z,oa){return this.Qi?oa.width-M.a.L6f(Z):M.a.yKc(Z)}TKd(Z,
oa,Ba,Ma){return Z+oa<=Ba+Ma}AVd(Z,oa,Ba,Ma){let za=1,ka=Math.max(Ba,Z-oa);oa>Z-Ba&&(za=2,ka=oa<Ma?Ma-oa:Ba);return new Y(ka,0,za)}UKd(Z,oa,Ba,Ma){return Z+oa<=Ba+Ma}VKd(Z,oa,Ba){return oa<=Z-Ba}zVd(Z,oa,Ba,Ma){Ma-oa>=Z-Ba?Z=4:(oa=Z,Z=3);return new Y(0,oa,void 0,Z)}}Object(J.a)(P,"ModernPresenceTooltipPositioner",null,[]);class T{constructor(Z,oa,Ba,Ma,za,ka,qa){this.zv=Z;this._parent=oa;this.aLb=Ba;this.Npd=Ma;this.utd=za;this.l6=ka;this.BH=qa;this._element=document.createElement("div");this.element.className=
"prTouchTarget"}get element(){return this._element}update(Z,oa){if(3!==Z)if(5!==Z&&this.zv&&this.zv.length){if(4===Z){var Ba=this.utd;var Ma=(this.l6-Ba)/2;this.element.style.height=this.l6+"px";this.element.style.width=this.l6+"px";Z=G.a.ZG(this.zv[0].element.style.top);oa=G.a.ZG(this.BH?this.zv[0].element.style.right:this.zv[0].element.style.left)}else Ba=this.aLb,Ma=(this.l6-Ba)/2,this.element.style.height=this.l6+"px",this.element.style.width=this.HXd()+2*Ma+"px",Z=G.a.ZG(this.zv[this.zv.length-
1].element.style.top),oa=this.IKd(this.zv[this.zv.length-1].element,Ba,oa);G.a.FX(this.element,"border-radius",this.l6+"px");this.element.style.top=Z-Ma-Ba+"px";this.BH?this.element.style.right=oa-Ma+"px":this.element.style.left=oa-Ma+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}IKd(Z,oa,Ba){return this.BH&&!Ba?G.a.ZG(Z.style.right):this.BH||Ba?this.BH&&Ba?-G.a.ZG(Z.style.left)-
oa:-G.a.ZG(Z.style.right)-oa:G.a.ZG(Z.style.left)}HXd(){return this.zv&&this.zv.length?this.aLb+Math.min(this.zv.length-1,2)*this.Npd:0}}Object(J.a)(T,"ModernPresenceTooltipTarget",null,[]);var L=d(73),aa=d(114),Q=d(196);class ea extends m.a{constructor(Z,oa,Ba){super(Z);this.f6=this.uH=this.qNb=this.pY=!1;this.xf=[];this.iya={};this.Gc=Ba;this.Qi=Ba.get(8,!1);this.bNb=Ba.get(15,!1);this.xqd=Ba.get(12,0);this.QR=Ba.get(6,0);this.Q1a=oa;this.XRb=Ba.get(16);this.O_a=Ba.get(17,!1);this.wtd=Ba.get(19,
!1);this.rzd=Ba.get(20,!1);this.oya=0;this.kzd=new P(this.Qi,this.O_a);this.gfa=this.q_b();this.i1a=!1;this.cM=[];this.Kfa=[];this.element.id=ea.P5a();this.element.className=m.a.ypb("prControl",this.Qi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Qi;this.rfb(oa);this.rE=this.createElement("div");this.rE.className="prFlyoutContainer";this.element.appendChild(this.rE);this.zv=[];this.pR=new T(this.zs,this.element,this.QR,4,6,32,this.Qi);this.Ko=Ba.get(9);this.Ko.ob(u.a.pointerDown,
this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));this.Ko.ob(u.a.pointerOver,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));this.Ko.ob(u.a.pointerOut,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"))}get Adb(){return Q.a.clone(this.xf)}get zs(){return this.zv}get defaultZIndex(){return this.xqd}get SM(){return this.zs?this.zs.length:0}get kU(){return 0<this.SM?this.zs[0].state:5}get e8a(){return 3===this.kU&&!this.pY}VU(Z){this.addHandler(n.a.Qo,Z)}S_(Z){this.removeHandler(n.a.Qo,
Z)}dispose(){if(this.e8a)this.i1a=!0;else{if(this.zs)for(const Z of this.zs)Z.S_(Object(e.a)(this,this.sF,"onInteractivityChanged")),aa.a.ex(Z);this.zv=null;this.Ko.xb(u.a.pointerDown,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));this.Ko.xb(u.a.pointerOver,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));this.Ko.xb(u.a.pointerOut,this.pR.element,Object(e.a)(this,this.D9,"onHitTarget"));super.dispose()}}Bea(){this.TY();this.visible=!0}igb(){this.visible=!0;this.LYb();this.pY=!0}swa(){this.igb()}hide(){this.Mhc();
this.ZM();this.pR.update(this.kU,this.f6)}lz(Z){const oa=this.kU,Ba=this.pY;Z.clientId||(Z.clientId=(ea.Pfa++).toString());if(Z.clientId in this.iya){var Ma=this.gS(Z.clientId);if(0<=Ma){Ma=this.xf[Ma];if(Ma.color===Z.color&&Ma.userName===Z.userName)return;this.BL(Z.clientId)}}this.hide();Ma=new C(this.createElement("div"),this.Gc);Ma.VU(Object(e.a)(this,this.sF,"onInteractivityChanged"));this.rE.insertBefore(Ma.element,this.rE.firstChild);this.iya[Z.clientId]=Ma;Array.add(this.xf,Z);Array.add(this.zs,
Ma);this.rnc(oa,Ba);this.visible=!0}BL(Z){if(this.e8a)Array.add(this.Kfa,Z);else{var oa=this.kU,Ba=this.pY;this.hide();this.hma(Z);this.rnc(oa,Ba)}}rcb(Z){const oa=this.gS(Z);if(!(0>=oa)){var Ba=this.xf[oa];Z=this.iya[Z];Array.removeAt(this.xf,oa);Array.insert(this.xf,0,Ba);Array.removeAt(this.zs,oa);Array.insert(this.zs,0,Z);this.rE.removeChild(Z.element);this.rE.appendChild(Z.element);this.TY()}}rnc(Z,oa){0>=this.xf.length?this.hide():3===Z&&oa?this.igb():this.Bea()}Nfb(Z,oa){oa?this.fFd(Z):this.Fhc(Z)}FYb(Z){if(this.e8a&&
this.wtd)return!1;Z=ea.A6a(Z);if(this.rE!==Z&&I.a.$ra(this.rE,Z))return!0;for(const oa of this.zs)if(I.a.$ra(oa.element,Z))return!0;return!1}position(Z,oa){this.element.style.top=oa+"px";this.element.style.left=Z+"px"}TY(Z=!1){if(!Z||this.uH){this.qNb&&this.Cjc(!0);var oa=Math.min(3,this.SM)-1;Z=0;var Ba=1,Ma=0;this.f6&&(Z=this.gfa,Ba=-1,Ma=-this.QR);for(let za=this.SM-1;za>oa;za--)this.zs[za].xkc(this.xf[za],-4*oa*Ba+Ma,0,!0,!1,!0,Z);for(;0<=oa;oa--)this.zs[oa].xkc(this.xf[oa],-4*oa*Ba+Ma,0,0<oa,
Array.contains(this.cM,this.xf[oa].clientId),oa!==this.oya,Z);this.oya=0;this.pR.update(0,this.f6);this.zIndex=this.defaultZIndex;this.pY=!1;this.Mhc(0);this.i1a&&this.dispose()}}LYb(){this.qNb&&this.Cjc(!1);this.zIndex=this.defaultZIndex+1;let Z,oa,Ba;({offsetX:oa,offsetY:Z,U1b:Ba}=this.tIe());for(let Ma=0;Ma<this.SM;Ma++)this.zs[Ma].kLe(this.xf[Ma],oa,Z+(this.QR+2)*Ma,Ma!==this.oya,Ba)}ZM(){let Z=0,oa=0;this.f6&&(Z=this.gfa,oa=-6);for(let Ba=0;Ba<this.SM;Ba++)this.zs[Ba].hide(this.xf[Ba],oa,Z);
this.zIndex=this.defaultZIndex;this.visible=this.pY=!1;this.i1a&&this.dispose()}Q3a(Z=0){Z?(this.uH=!0,K.Task.delay(Z).continueWith(()=>{this.bNb?this.g4d():this.TY(!0);this.uH=!1})):this.bNb?this.hide():this.TY()}g4d(){this.uH&&this.hide()}uJd(){if(A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.gb.Q7&&L.c()){const Z=appChrome.selectors.getShyState();return Z.isActive&&0!==Z.state}return!1}sF(Z,oa){Z=this.kU;this.uJd()||2!==oa.type&&(4!==oa.type||3===Z)?4===oa.type&&3===Z?(this.uH&&(this.uH=
!1),this.Q3a()):3!==oa.type||3!==Z||this.pY||(1<this.SM?(this.uH=!0,K.Task.delay(250).continueWith(()=>{this.TY(!0);this.uH=!1})):this.Q3a()):(this.uH&&(this.uH=!1),3!==Z&&(this.LYb(),3===oa.Ti.Vf&&this.Q3a(2E3)));this.raiseEvent(n.a.Qo,oa)}D9(Z){3===Z.Vf?this.sF(this,new n.a(4,Z)):Z.eventName===u.a.pointerOver?this.sF(this,new n.a(2,Z)):Z.eventName===u.a.pointerOut&&this.sF(this,new n.a(3,Z));return!1}rfb(Z){this.element.style.width=Z+"px";this.element.style.height=this.QR+"px"}hma(Z){this.Fhc(Z);
Z=this.gS(Z);if(!(0>Z)){var oa=this.xf[Z];Array.removeAt(this.xf,Z);delete this.iya[oa.clientId];oa=this.zs[Z];this.rE.removeChild(oa.element);this.Gc.get(18,!1)&&oa.S_(Object(e.a)(this,this.sF,"onInteractivityChanged"));Array.removeAt(this.zs,Z);oa.dispose()}}Mhc(Z=5){if(this.Kfa.length){this.visible&&this.ZM();for(let oa=0;oa<this.Kfa.length;oa++)this.hma(this.Kfa[oa]);Array.clear(this.Kfa);0>=this.xf.length||5===Z?this.hide():0===Z&&this.Bea()}}gS(Z){for(let oa=0;oa<this.xf.length;oa++)if(this.xf[oa].clientId===
Z)return oa;return-1}fFd(Z){if(-1===this.gS(Z))h.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.cM,Z)){if(this.xf[0].clientId===Z)return;Array.remove(this.cM,Z)}Array.add(this.cM,Z);this.rcb(Z);1!==this.kU&&this.TY()}}Fhc(Z){-1===this.gS(Z)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.cM,Z)&&(Array.remove(this.cM,Z),this.xf[0].clientId===Z&&0<this.cM.length&&
this.rcb(this.cM[this.cM.length-1]),this.xf[0].clientId===Z&&1===this.kU&&this.TY())}Cjc(Z){Z?Sys.UI.DomElement.addCssClass(this.rE,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.rE,"prBackgroundSelection")}tIe(){let Z,oa;oa=Z=0;var Ba=this.gfa;if(this.XRb){const Ma=this.XRb(this);if(!Ma)return{offsetX:Z,offsetY:oa,U1b:Ba};const za=4===this.kU;Ba=this.kzd.yZd(this.SM,za?6:this.QR,this.QR,150,2,this.element,Ma);oa=Ba.offsetTop;this.oya=this.oZd(Ba.Mnc,Ba.offsetTop);Ba=Ba.V1b;Ba!==this.gfa&&
(this.Ceb(Ba),this.element.dir=3===Ba?"rtl":"ltr",this.gfa=Ba);Ba!==this.q_b()?(Z=this.rzd?-2:za?-6:-this.QR,this.f6=!0):this.f6=!1}return{offsetX:Z,offsetY:oa,U1b:Ba}}oZd(Z,oa){if(1===Z)return this.SM-1;Z=Math.abs(oa);return 0<Z?Z/(this.QR+2):0}Ceb(Z){for(let oa=0;oa<this.SM;oa++)this.zs[oa].Ceb(Z)}q_b(){return this.Qi?3:4}static P5a(){return String.format("{0}-{1}","presencetooltip",ea.Pfa++)}static A6a(Z){return Z.lc.rawEvent.relatedTarget}}ea.Pfa=0;Object(J.a)(ea,"ModernPresenceTooltipControl",
m.a,[494,106]);var ia=d(218),ja=d(283),D=d(264);d.d(V,"a",function(){return pa});class pa{constructor(Z){this.Gc=Z;this.Gc.WC(10,ia.a.instance);this.Gc.WC(9,D.a.instance);this.Gc.WC(6,20);this.Gc.WC(13,ja.a.instance);this.Gc.WC(17,!1)}NEc(Z,oa){this.Gc.WC(15,!1);return new ea(Z,oa,this.Gc)}spb(Z){this.Gc.WC(15,!1);return new ea(Z,20,this.Gc)}}Object(J.a)(pa,"ModernPresenceTooltipFactory",null,[493])},1102:function(J,V,d){J=d(0);var h=d(13),e=d(1158),m=d(227),n=d(228),v=d(65),A=d(95);class w extends m.a{constructor(M,
P){super(M);this.xf=null;this.BH=P.get(8,!1);this.hR=P.get(6,0);this.element=M;this.element.className=w.z5a;this.m2a=this.createElement("ul");this.element.appendChild(this.m2a);this.tn=P.get(10);this.tn.ob(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.Ko=P.get(9);this.Ko.ob(v.a.pointerOut,this.element,Object(h.a)(this,this.Py,"onPointerOut"));this.Ko.ob(v.a.pointerDown,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior"));this.fM=P.get(13);this.fM.ob(this.element,
Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior"))}VU(M){this.addHandler(n.a.Qo,M)}S_(M){this.removeHandler(n.a.Qo,M)}get s$(){return this.xf}dispose(){this.element&&(this.tn.xb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.Ko.xb(v.a.pointerDown,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),this.Ko.xb(v.a.pointerOut,this.element,Object(h.a)(this,this.Py,"onPointerOut")),this.fM.xb(this.element,Object(h.a)(this,this.lx,
"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(M,P,T){this.hide();!M||0>=M.length||(this.BH?this.element.style.right=P+"px":this.element.style.left=P+"px",this.element.style.top=T+"px",this.$Fd(M),this.visible=!0)}$Fd(M){this.xf=M;A.a.$t(this.m2a);for(let P=M.length-1;0<=P;P--)this.lz(M[P])}lz(M){const P=document.createElement("li");P.style.backgroundColor=M.color;P.style.height=this.hR+"px";P.id="fly_"+M.clientId;P.style.lineHeight=this.hR+"px";A.a.ix(P,
M.userName);P.setAttribute("dir","auto");this.m2a.appendChild(P)}onClick(){this.hide();return!1}Py(M){this.raiseEvent(n.a.Qo,new n.a(3,M));return!1}}w.z5a="prFlyout UIFont";Object(J.a)(w,"PresenceTooltipFlyoutControl",m.a,[]);var y=d(72);class u extends m.a{constructor(M,P,T){super(M);this.kM=null;this.xf=[];this.element.className="prGlyph";this.Gc=P;this.d6=this.Gc.get(9);this.Vm=this.Gc.get(10);this.fM=this.Gc.get(13);this.l4d();this.lz(T);this.r0a=!1}get ZN(){return this.xf.length}get s$(){return this.xf}VU(M){this.addHandler(n.a.Qo,
M)}S_(M){this.removeHandler(n.a.Qo,M)}dispose(){this.YRe();super.dispose()}lz(M){Array.add(this.xf,M);2===this.ZN?this.p$(!0):1===this.ZN?this.p$(!1):this.p$(this.r0a)}BL(M){this.aVd(M)&&(1<this.ZN&&this.p$(!0),1===this.ZN?this.p$(!1):1>this.ZN&&this.hide())}show(){this.p$(2<=this.ZN);this.visible=!0}hide(){this.visible=!1}kZd(M){return M?this.i_b(0,5):this.i_b(1,4)}aVd(M){for(let P=0;P<this.ZN;P++)if(this.xf[P].clientId===M)return M=this.xf[P],Array.removeAt(this.xf,P),M;return null}p$(M){this.r0a!==
M&&(this.kM&&this.element.removeChild(this.kM),this.kM=this.kZd(M),this.element.appendChild(this.kM),this.r0a=M);this.kM.childNodes[0].style.backgroundColor=this.xf[this.xf.length-1].color}i_b(M,P){const T=this.Gc.get(6,0),L=this.Gc.get(14);return y.createClusteredImageFromClusterWithImageClass(T,T,this.Gc.get(M),this.Gc.get(P),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,L?L.cloneNode(!0):null)}jC(M){3!==M.Vf&&this.raiseEvent(n.a.Qo,new n.a(2,M));return!1}onClick(M){this.raiseEvent(n.a.Qo,
new n.a(1,M));return!0}Py(M){3!==M.Vf&&this.raiseEvent(n.a.Qo,new n.a(3,M));return!1}YRe(){this.element&&(this.d6.xb(v.a.pointerDown,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),this.d6.xb(v.a.pointerOver,this.element,Object(h.a)(this,this.jC,"onPointerOver")),this.d6.xb(v.a.pointerOut,this.element,Object(h.a)(this,this.Py,"onPointerOut")),this.Vm.xb(v.a.doubleClick,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),this.Vm.xb(v.a.click,
this.element,Object(h.a)(this,this.onClick,"onClick")),this.fM.xb(this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")))}l4d(){this.element&&(this.d6.ob(v.a.pointerDown,this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")),this.d6.ob(v.a.pointerOver,this.element,Object(h.a)(this,this.jC,"onPointerOver")),this.d6.ob(v.a.pointerOut,this.element,Object(h.a)(this,this.Py,"onPointerOut")),this.Vm.ob(v.a.doubleClick,this.element,Object(h.a)(this,
this.lx,"stopPropagationAndPreventDefaultBehavior")),this.Vm.ob(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.fM.ob(this.element,Object(h.a)(this,this.lx,"stopPropagationAndPreventDefaultBehavior")))}}Object(J.a)(u,"PresenceTooltipGlyph",m.a,[]);var E=d(114);d(62);var G=d(196);class I extends m.a{constructor(M,P,T){super(M);this.xf=[];this.Ll=[];this.yH=0;this.qga=this.K5=!1;this.kKb=null;this.Jfa={};this.Gc=T;this.Qi=T.get(8,!1);this.RF=T.get(11,!1);M=T.get(12,0);this.imageDimension=
T.get(6,0);this.Q1a=P;this.element.id=I.P5a();this.element.className=m.a.ypb("prControl",this.Qi);M&&(this.zIndex=M);this.rtl=this.Qi;this.rfb(P);this.az=this.createElement("div");this.az.className=this.RF?"prContainerV":"prContainerHr";this.element.appendChild(this.az);this.BMb=Array(this.yH);for(P=0;P<this.yH;P++)this.Iv[P]=new w(this.createElement("div"),this.Gc),this.Iv[P].VU(Object(h.a)(this,this.sF,"onInteractivityChanged")),this.element.appendChild(this.Iv[P].element)}get Adb(){return G.a.clone(this.xf)}getGlyph(M){return this.Jfa[M]}get Iv(){return this.BMb}get rSb(){return this.kKb}get CIa(){return this.imageDimension+
2}get width(){return this.RF?this.CIa:this.Q1a}get height(){return this.RF?this.Q1a:this.CIa}VU(M){this.addHandler(n.a.Qo,M)}S_(M){this.removeHandler(n.a.Qo,M)}dispose(){if(this.Iv)for(const M of this.Iv)M.S_(Object(h.a)(this,this.sF,"onInteractivityChanged")),E.a.ex(M);E.a.hed(this.Ll);this.Ll=this.BMb=null;super.dispose()}Bea(){this.ZM();this.ggb();this.visible=!0;this.K5=!1}igb(){!this.Ll||1>this.Ll.length||(this.ZM(),this.visible=!0,this.ggb(),this.aHa(this.Ll[this.Ll.length-1]),this.K5=!0)}swa(){if(this.Ll&&
!(1>this.Ll.length)){this.visible=!0;this.ggb();var M=0;for(const P of this.Ll)this.aHa(P,M++);this.K5=!1;this.qga=!0}}hide(){this.visible=!1;this.ZM();for(let M=0;M<this.Ll.length;M++)this.Ll[M].hide();this.K5=!1}TUb(){if(!this.qga)return!1;let M=0;for(const P of this.Iv)P.visible&&M++;return this.qga=0<M&&(this.xf.length<=this.yH?M===this.xf.length:M===this.yH)}lz(M){if(!(0>=this.yH)){M.clientId||(M.clientId=(I.Pfa++).toString());if(M.clientId in this.Jfa){var P=this.gS(M.clientId);if(0<=P){P=this.xf[P];
if(P.color===M.color&&P.userName===M.userName)return;this.BL(M.clientId)}}P=this.TUb();var T=0;if(this.xf.length<this.yH){var L=new u(this.createElement("div"),this.Gc,M);L.VU(Object(h.a)(this,this.sF,"onInteractivityChanged"));this.Qi&&!this.RF&&0<this.xf.length?this.az.insertBefore(L.element,this.az.firstChild):(this.az.appendChild(L.element),T=this.Ll.length);Array.add(this.Ll,L)}else this.Qi&&!this.RF?L=this.Ll[0]:(T=this.Ll.length-1,L=this.Ll[T]),L.lz(M);L.show();this.Jfa[M.clientId]=L;Array.add(this.xf,
M);this.inc(L,T);P&&this.swa()}}BL(M){const P=this.TUb();P&&this.ZM();this.hma(M);this.xf.length>=this.yH&&this.Ll.length<this.yH&&this.nCe();0>=this.xf.length?this.hide():P&&this.swa()}rcb(){}hma(M){var P=this.gS(M);0>P||(M=this.xf[P],Array.removeAt(this.xf,P),P=this.Jfa[M.clientId],delete this.Jfa[M.clientId],P.BL(M.clientId),this.inc(P),0>=P.ZN&&(this.az.removeChild(P.element),Array.remove(this.Ll,P),P.dispose()))}Nfb(){}nCe(){var M=this.s_d();!M||1>=M.s$.length||(M=Array.clone(this.xf),M.forEach(P=>
{this.hma(P.clientId)}),M.forEach(P=>{this.lz(P)}))}gS(M){for(let P=0;P<this.xf.length;P++)if(this.xf[P].clientId===M)return P;return-1}s_d(){return this.Qi&&!this.RF?this.Ll[0]:this.Ll[this.Ll.length-1]}position(M,P){this.element.style.top=P+"px";this.element.style.left=M+"px"}ggb(){for(let M=0;M<this.Ll.length;M++)this.Ll[M].show()}ZM(){for(let M=0;M<this.yH;M++)this.Iv[M].hide();this.qga=!1}aHa(M,P=0){if(M)if(this.kKb=M,this.RF){const T=this.imageDimension;if(1<M.s$.length)this.Iv[P].show(M.s$,
T,this.height-this.imageDimension);else{const L=this.az.children.length;for(let aa=0;aa<this.az.children.length;aa++)M.element===this.az.children[aa]&&this.Iv[P].show(M.s$,T,this.height-(L-aa)*this.CIa+2)}}else this.Iv[P].show(M.s$,this.width,0)}sF(M,P){var T=Object(e.a)(u,M);T=T?this.aZb(T):-1;if(2===P.type||1===P.type&&-1!==T&&!this.Iv[T].visible)this.aHa(M);else if(1===P.type)this.ZM(),this.K5=!1;else if(3===P.type){if(this.FYb(P.Ti))return;this.K5||this.ZM()}this.raiseEvent(n.a.Qo,P)}FYb(M){M=
I.A6a(M);let P=!1;for(const T of this.Iv)if(A.a.$ra(T.element,M)){P=!0;break}return this.az!==M&&A.a.$ra(this.az,M)||P}inc(M,P=0){const T=this.j7d(M);T&&0>=M.ZN?this.Iv[P].hide():T?this.aHa(M):this.Iv[P].hide()}aZb(M){let P=0;for(const T of this.Ll){if(M===T)return P;P++}return-1}j7d(M){const P=this.aZb(M);return!!this.rSb&&M===this.rSb&&-1!==P&&this.Iv[P].visible}rfb(M){this.yH=M===this.imageDimension?1:Math.floor(M/this.CIa);this.RF?(this.element.style.height=M+"px",this.element.style.width=this.imageDimension+
"px"):(this.element.style.width=M+"px",this.element.style.height=this.imageDimension+"px")}static P5a(){return String.format("{0}-{1}","presencetooltip",I.Pfa++)}static A6a(M){M=M.lc.rawEvent;return M.relatedTarget||M.toElement}}I.Pfa=0;Object(J.a)(I,"PresenceTooltipControl",m.a,[494,106]);var H=d(218),K=d(283),C=d(264);d.d(V,"a",function(){return Y});class Y{constructor(M){this.Gc=M;this.Gc.WC(10,H.a.instance);this.Gc.WC(9,C.a.instance);this.Gc.WC(6,16);this.Gc.WC(13,K.a.instance)}NEc(M,P){return new I(M,
P,this.Gc)}spb(M){return new I(M,16,this.Gc)}}Object(J.a)(Y,"PresenceTooltipFactory",null,[493])},1202:function(J,V,d){d.r(V);var h=d(0),e=d(375),m=d(13),n=d(17),v=d(77),A=d(78),w=d(35),y=d(2);class u{constructor(Sa,Cb,rc,bd,pd,Oa,jb,nc,kb=!1){this.SJa=null;this.bsd=!0;this.szd=this.xR=this.Cod=null;this.Pa=new v.a;this.yQh=Sa;this.Gsf=Cb;this.Qpf=rc;this.Opf=bd;this.uWe=Oa;u.Rd=pd;this.rSh=jb;this.BLa=nc;this.iTh=kb;y.Task.WAA(Cb,rc).continueWith(Object(m.a)(this,this.$vj,"initOnTaskReady"))}y$g(){this.Pa.raiseEvent("u",
null,this)}$vj(){this.Gsf.result&&this.Qpf.result&&(this.xR=this.Gsf.result,this.szd=this.Qpf.result,this.xR.Nzc(Object(m.a)(this,this.pdc,"onPresenceUpdated")),this.Cod=new A.a(2,2,this.uWe,Object(m.a)(this,this.atl,"updateAwayClientsTask"),88),u.Rd.Gb(this.Cod))}pdc(Sa,Cb){(this.bsd||this.WHk(Cb.yJb))&&u.Rd.B4(this.Cod,0)}WHk(Sa){for(let rc in Sa){var Cb=this.Opf.Ybg({key:rc,value:Sa[rc]});if(Cb&&Cb.clientId&&(Cb=Cb.clientId.toLowerCase(),(Cb=this.SJa[Cb]||this.SJa[Cb.toUpperCase()])&&2===Cb.status))return!0}return!1}atl(Sa){var Cb=
this.xR.AXi();if(Cb){var rc=new Date,bd=!1;if(this.bsd){this.SJa=Cb;this.bsd=!1;var pd=this.SJa;for(var Oa in pd){Cb=Oa;var jb=pd[Oa];jb.Vvb<rc&&(rc=jb.Vvb);2===jb.status&&(bd=!0,this.szd.tcd(Cb))}bd&&this.y$g();u.Rd.B4(Sa,this.Rag(rc))}else{jb=new n.a;Oa=!1;var nc=this.SJa;for(pd in nc){nc=pd;if(!(nc in this.SJa)||this.yQh.clientId===nc)continue;var kb=this.SJa[nc];const Gb=Cb[nc];if(kb&&Gb){kb=kb.status;const tc=Gb.status;2===kb&&1===tc?(jb.add(nc),e.ULS.sendTraceTag(38052609,392,50,nc+" returned from away")):
1===kb&&2===tc&&(Oa=bd=!0,this.szd.tcd(nc),e.ULS.sendTraceTag(38052610,392,50,nc+" went away"));1===tc&&Gb.Vvb<rc&&(rc=Gb.Vvb)}}this.SJa=Cb;u.Rd.B4(Sa,this.Rag(rc));(0<jb.count||bd)&&this.y$g();0<jb.count&&!this.iTh?(Sa=this.PZi(jb),this.yml(Sa)):Sa=new n.a;(Oa||0<Sa.count)&&this.rSh(w.a.P3a,2)}}}yml(Sa){if(Sa.count)for(let Cb of Sa)Sa=this.BLa.sAa(String.format(CommonUIStrings.l_EditorsToastArriving,Cb),!1),Sa.image=5,Sa.Pba="CoAuth_AuthorStatus_16x16x32",this.BLa.Rh(Sa)}PZi(Sa){const Cb=this.xR.nKc(),
rc=new n.a;for(let bd in Cb){const pd={key:bd,value:Cb[bd]};if(Sa.contains(pd.key)){const Oa=this.Opf.Ybg(pd);Oa&&(rc.add(Oa.userName),Sa.remove(pd.key))}}rc.count||e.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return rc}Rag(Sa){return Math.max(Sa.getTime()+this.uWe-(new Date).getTime(),0)}}u.Rd=null;Object(h.a)(u,"AwayManager",null,[]);var E=d(566),G=d(25),I=d(285),H=d(55),K=d(329),C=d(68),Y=d(1094),M=d(1021),P=d(959),T=d(686),L=d(684),aa=d(184),Q=d(958),ea=d(27),ia=d(689),
ja=d(206),D=d(26),pa=d(760),Z=d(45),oa=d(1158),Ba=d(22),Ma=d(928),za=d(367),ka=d(36),qa=d(63);class Ja{constructor(Sa,Cb){this.shapeNode=Sa;this.vsh=Cb}}Object(h.a)(Ja,"ShapeNodeStartEditingNotificationTracking",null,[]);class xa{constructor(Sa,Cb,rc,bd,pd="",Oa=""){if(!Sa||!Cb||0>rc)throw Error.argumentNull("LockEntry");this.Tv=Sa;this.NA=Cb;this.ida=rc;this.t4j=bd;this.OPg=pd;this.IPg=Oa;this.oKg=new Date}get clientId(){return this.Tv}get zhd(){return this.NA}get shapeId(){return this.ida}get lockType(){return this.t4j}get Yuh(){return this.OPg}get Kuh(){return this.IPg}get mxg(){return!Z.a.Va(this.IPg)&&
!Z.a.Va(this.OPg)}get izg(){return this.oKg}set izg(Sa){this.oKg=Sa}}Object(h.a)(xa,"LockEntry",null,[]);class Ga{constructor(Sa,Cb,rc,bd,pd="",Oa=""){this.clientId=Sa;this.slideId=Cb;this.shapeId=rc;this.lockType=bd;this.rowId=pd;this.cellId=Oa}}Object(h.a)(Ga,"SerializableLockData",null,[]);var na=d(182),sa=d(210);class Ha{constructor(Sa,Cb,rc,bd,pd,Oa,jb,nc,kb,Gb,tc,dd,$c,Pc,Ad,Ee,Ce,Fb,$e,bg,Ye,Ae){this.mij=new E.a("",ResourceStrings.L_GhostUserName,Ma.a.GUf,new pa.a(1));this.Kyb={};this.Lyb=
{};this.Jyb={};this.XJg=ea.App.Im;this.yle=null;this.Ooe={};this.gWc={};this.jWc={};this.YJg=ea.App.Im;this.EPg=!0;this.OLg=this.dLg=0;this.A0c=(new Date(0)).getTime();this.B0c=(new Date(0)).getTime();this.a$b=(new Date(0)).getTime();this.Wme=(new Date(0)).getTime();this.CPg=!1;this.hTa=Sa;this.ED=Cb;this.Syb=rc;this.M$b=bd;this.Yb=pd;this.yb=Oa;this.ra=jb;this.e_j=nc;this.Tq=kb;this.Ea=Gb;this.sc=tc;this.j$b=dd;this.hfe=$c.fsg;this.Xr=Pc;this.UW=Ad;this.ta=Ee;this.GOg=Ce;this.od=Fb;this.od.r5h(Object(m.a)(this,
this.nok,"onShapeViewElementRequestUpdateAuthorInfo"));(this.Ix=G.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.ra.XJ(Object(m.a)(this,this.YG,"onSelectionChanged"));this.M$b.Eza(Object(m.a)(this,this.Ldc,"onUpdateNotificationReceived"));this.R9j=$e;this.Le=bg;this.Y8j=Ye;this.Ga=$c;this.TUa=Ae;this.fwj()}fwj(){D.a.J(20821920,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.hfe,this.Xr.JXj());this.Xr.uRd||(0<this.Xr.leb?
this.yb.Gb(new A.a(2,2,this.Xr.leb,Object(m.a)(this,this.removeExpiredLock,"removeExpiredLock"),90,"71")):D.a.J(20821922,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.Xr.VHb?(this.yb.Gb(new A.a(2,2,this.Xr.VHb/2,Object(m.a)(this,this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.EPg=!1):D.a.J(21565471,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.Xr.r2b?this.yb.Gb(new A.a(2,2,this.Xr.r2b,Object(m.a)(this,
this.updateLockIfImeActive,"updateLockIfImeActive"),90,"73")):D.a.J(20030493,804,50,"IME typing lock notification disabled"),0<this.Xr.ecb?this.yb.Gb(new A.a(2,2,this.Xr.ecb,Object(m.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):D.a.J(21565474,804,50,"Lock leack detection is disabled"),this.e_j.addHandler(za.a.uPf,(Sa,Cb)=>{this.Ypi(Cb)}),this.Xr.yGc||this.vlc||(this.j$b.Cza(Object(m.a)(this,this.PWg,"onBeforeParagraphNodePropertyChanged")),0<this.Xr.xhb?this.yb.Gb(new A.a(2,2,this.Xr.xhb,
Object(m.a)(this,this.updateLockForActiveShapeNodes,"updateLockForActiveShapeNodes"),90,"75")):D.a.J(20821953,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),this.vlc&&(this.Y8j.Cza(Object(m.a)(this,this.x8c,"onTableCellNodePropertyChanged")),this.j$b.Cza(Object(m.a)(this,this.PWg,"onBeforeParagraphNodePropertyChanged")),this.R9j.initialize(),0<this.Xr.xhb&&this.yb.Gb(new A.a(2,2,this.Xr.xhb,Object(m.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),
90,"76")),0<this.Xr.leb&&this.yb.Gb(new A.a(2,2,this.Xr.leb,Object(m.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get vlc(){return this.Xr.PSd&&this.Xr.mZf}removeExpiredLock(){var Sa=sa.a(this.Kyb);for(const Cb of Sa){Sa=Object(oa.a)(124,this.Kyb[Cb]);if(!Sa){delete this.Kyb[Cb];continue}const rc=Sa.shapeNode;rc&&rc.isConnected?this.UW.X8f(rc)||this.qad(Cb)||(delete this.Kyb[Cb],this.UW.s_b(rc)||Sa.ll?D.a.J(18956362,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):
this.Szh(Sa)):delete this.Kyb[Cb]}}removeExpiredTableCellLock(){var Sa=sa.a(this.Lyb);for(const Cb of Sa){Sa=Object(oa.a)(554,this.Lyb[Cb]);if(!Sa){delete this.Lyb[Cb];continue}const rc=Sa.tableCellNode;rc&&rc.isConnected?Z.a.Va(this.UW.f_b(rc))&&!this.qad(Cb)&&(delete this.Lyb[Cb],this.Tzh(Sa)):delete this.Lyb[Cb]}}detectLockLeak(){const Sa=[],Cb=new Date,rc=this.pfg();for(const bd of rc)bd.Kp&&+Cb-+bd.xVc>this.Xr.ecb&&Sa.push(bd.shapeNode.jr);0<Sa.length&&D.a.J(21565510,828,15,"Following objects are locked longer than {0} : {1}",
this.Xr.ecb,Sa.join(";"))}switchPendingSveToFidelity(){const Sa=new Date,Cb=this.pfg();for(const rc of Cb)rc.Kp||rc.shapeNode.nd&&this.vlc||!rc.Fn||rc.Ax||!(+Sa-+rc.FUj>this.Xr.VHb)||rc.yA||rc.UHb()}updateLockIfImeActive(){if(this.XJg>=this.YJg&&this.yle){const Sa=this.IRi(this.yle);this.pmd(Sa)&&this.gjc(Sa.slideId,Sa.get_shapeId(),2)}this.YJg=new Date}updateLockForActiveShapeNodes(){var Sa=sa.a(this.gWc);for(const Cb of Sa)Sa=Object(oa.a)(4,this.gWc[Cb]),this.pmd(Sa)&&this.gjc(Sa.slideId,Sa.get_shapeId(),
3);this.gWc={}}updateLockForActiveTableCellNodes(){var Sa=sa.a(this.jWc);for(const Cb of Sa)if(Sa=Object(oa.a)(125,this.jWc[Cb]),this.pmd(Sa)){const rc=this.Ea.kn(Sa);this.gjc(rc.slideId,rc.get_shapeId(),3,Sa.rowId.toString(),Sa.cellId.toString())}this.jWc={}}IRi(Sa){return(Sa=this.Tq.VH(Sa))?this.Ea.kn(Sa.$a):null}PWg(Sa,Cb){Cb&&Cb.node?(Sa=Object(oa.a)(5,Cb.node),Sa)?Sa.loading||Sa.Rfc||Cb.property.id!==ka.a.Zp.id||(Cb=this.Ea.Cba(Sa),Sa=this.sc.cCa(Sa),Cb&&(Sa?(Cb=this.FKc(Cb.slideId,Cb.get_shapeId(),
Sa.rowId.toString(),Sa.cellId.toString()),this.jWc[Cb]=Sa):(Sa=this.Hsb(Cb.slideId,Cb.get_shapeId()),this.gWc[Sa]=Cb))):D.a.J(20821964,828,10,"Invalid argument."):D.a.J(20821962,828,10,"Invalid argument.")}XXk(Sa){const Cb=new A.a(2,1,this.Xr.Ohd,Object(m.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");Cb.customData=new Ja(Sa,!1);this.yb.Gb(Cb);this.Ooe[this.Hsb(Sa.slideId,Sa.get_shapeId())]=Cb}rtcNotifyStartEditing(Sa){Sa=Object(oa.a)(Ja,Sa.customData);const Cb=Sa.shapeNode;
this.pmd(Cb)&&this.INj(Cb)&&this.gjc(Cb.slideId,Cb.get_shapeId(),1);Sa.vsh=!0}pmd(Sa){return Sa?Sa.isConnected:!1}INj(Sa){return(Sa=this.Jk(Sa))?Sa.kN:!1}Jk(Sa){return Object(oa.a)(124,Sa.Ag(this.Yb.en.Ma))}pfg(){const Sa=[];if(!this.ta.Ba)return Sa;var Cb=this.ta.Ba.om();if(!Cb)return Sa;for(const rc of Cb)(Cb=this.Jk(rc))&&!Cb.ll?Sa.push(Cb):D.a.J(21836046,828,50,"Shape {0} on active slide doesn't have valid view element",rc.jr);return Sa}dok(Sa){this.Uoh(Sa)&&(this.hTa.amIAlone||this.XXk(Sa))}YG(Sa,
Cb){for(Sa=0;Sa<Cb.OD.length;Sa++){const bd=Cb.OD[Sa];var rc=Object(oa.a)(4,bd.context.node);rc&&rc.isConnected&&(rc=Object(oa.a)(124,rc.oc(this.Le)))&&(rc=this.GOg.VE(rc.shapeNode))&&(1===bd.cba?rc.bcc():0===bd.cba&&rc.xse())}}cok(Sa){if(this.Uoh(Sa)&&!this.Xr.wGc){var Cb=this.Hsb(Sa.slideId,Sa.get_shapeId()),rc=Object(oa.a)(A.a,this.Ooe[Cb]);if(rc){const bd=Object(oa.a)(Ja,rc.customData);this.yb.Qg(rc);bd&&bd.vsh&&this.gjc(Sa.slideId,Sa.get_shapeId(),4);this.Ooe[Cb]=null}}}nok(Sa,Cb){this.d1g(Cb.jx)}d1g(Sa){Sa.uK()||
Sa.shapeNode.X7a?this.a0h(Sa):this.e1g(Sa)}x8c(Sa,Cb){if((Cb=Object(oa.a)(na.TableCellNode,Cb.node))&&(Sa=Object(oa.a)(554,Cb.Ag(this.Le)))&&Cb.isConnected){Cb=this.UW.f_b(Cb);const rc=this.YAe(Sa.tableCellNode);Z.a.Va(Cb)?rc?(this.Ybe(Sa,this.fia(rc.clientId,Ha.BSd)),this.OSe(Sa)):Z.a.Va(Cb)&&(this.YAe(Sa.tableCellNode)||this.Tzh(Sa)):(this.Ybe(Sa,this.fia(Cb,Ha.BSd)),this.OSe(Sa))}}Ybe(Sa,Cb){Sa.lock(Cb)}Tzh(Sa){Sa.unlock()}gjc(Sa,Cb,rc,bd="",pd=""){try{const Oa=new Ga(this.Syb,Sa.Znc,Cb,rc,bd,
pd);this.M$b.rea(7,Oa)}catch(Oa){D.a.J(17602625,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",this.Syb,Oa.stack)}}Ldc(Sa,Cb){this.Ga.pptCoauthSurveyFloodgateEnabled&&!this.CPg&&8===Cb.type&&this.TUa&&this.$$k(Cb)&&(D.a.J(41185738,814,50,"Log coauth activity"),this.CPg=!0,this.TUa.continueWith(()=>{this.TUa.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===Cb.type&&((Sa=Cb.nxa)?Sa.clientId===this.Syb?D.a.J(19145675,828,15,"Lock notification : lock notification from myself recieved"):
(D.a.J(17602627,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",Sa.clientId,this.Syb),Sa=new xa(Sa.clientId,Sa.slideId,Sa.shapeId,Sa.lockType,Sa.rowId,Sa.cellId),this.q0h(Sa),this.jBk(Sa)):D.a.J(19145673,828,10,"Lock notification: invalid lock data recieved"))}e1g(Sa){if(!Sa||Sa.ll)D.a.J(18994447,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!Sa);else{var Cb=Sa.shapeNode;if(!(Cb.Qf||this.hfe&&Cb.nd&&(this.Xr.Xpb||this.vlc))){var rc=this.UW.s_b(Cb);rc?this.wVc(Sa,
this.fia(rc,Ha.BSd)):(Cb=this.UW.X8f(Cb))?(this.wVc(Sa,this.fia(Cb,Ha.kJi)),this.NSe(Sa)):(Cb=this.YAe(Sa.shapeNode))?(this.wVc(Sa,this.fia(Cb.clientId,this.QZd(Cb.lockType))),this.NSe(Sa)):Sa.Kp&&this.Szh(Sa)}}}Szh(Sa){const Cb=this.GOg.VE(Sa.shapeNode);Cb&&(Cb.Kld(null),Sa.unlock(this.EPg||!Cb.D3d))}wVc(Sa,Cb){Sa.lock(Cb);Sa.uK()&&this.ra.Ph()}$$k(Sa){if(!Sa||null===Sa.nxa)return!1;Sa=this.ztk(Sa.nxa);for(const Cb of Sa)Cb&&Cb.clientId&&(Cb.clientId.toLowerCase()===this.Syb.toLowerCase()?(this.dLg++,
this.A0c=this.A0c===(new Date(0)).getTime()?(new Date).getTime():this.A0c,this.B0c=(new Date).getTime()):this.RIj(Cb.clientId)||(this.OLg++,this.a$b=this.a$b===(new Date(0)).getTime()?(new Date).getTime():this.a$b,this.Wme=(new Date).getTime()));return 5<=this.dLg&&5<=this.OLg&&(this.Wme>=this.A0c&&this.a$b<=this.B0c||this.B0c>=this.a$b&&this.B0c<=this.Wme)&&1<=this.ED.vsb()?!0:!1}ztk(Sa){let Cb=null;try{Cb=Sa}catch(rc){}if(null===Cb||!Cb.length){let rc=null;try{rc=Sa}catch(bd){D.a.J(41185744,828,
10,"UpdateHint can't convert to RTC message.")}if(null!==rc)return[rc]}return Cb}RIj(Sa){Sa=this.fia(Sa);const Cb=this.fia(this.Syb);return Sa&&Cb&&Sa.userName===Cb.userName&&Sa.email===Cb.email?!0:!1}QZd(Sa){switch(Sa){case 1:return Ha.wgl;case 2:return Ha.Guj;case 3:return Ha.hrl;case 4:return Ha.vKi}D.a.J(20821976,828,10,"Unknown lock type");return"Unknown lock type"}q0h(Sa){if(Sa&&Sa.zhd){var Cb=Sa.mxg?this.FKc(new qa.a(Sa.zhd),Sa.shapeId,Sa.Yuh,Sa.Kuh):this.Hsb(new qa.a(Sa.zhd),Sa.shapeId);if(4===
Sa.lockType)this.Jyb[Cb]=Sa;else{var rc=Object(oa.a)(xa,this.Jyb[Cb]);rc?(rc=this.PZd(rc),this.PZd(Sa)>rc&&(this.Jyb[Cb]=Sa)):this.Jyb[Cb]=Sa}}}PZd(Sa){return this.u6i(Sa.lockType)-(+new Date-+Sa.izg)}u6i(Sa){switch(Sa){case 1:return this.Xr.Nhd;case 2:return this.Xr.PPc;case 3:return this.Xr.Wkd;case 4:return this.Xr.uqb}D.a.J(20821980,828,10,"Unknown lock type");return 0}YAe(Sa){if(Object(Ba.a)(4,Sa)){Sa=Object(oa.a)(4,Sa);if(!Sa.slideId)return null;Sa=this.Hsb(Sa.slideId,Sa.get_shapeId());return this.qad(Sa)}if(Object(Ba.a)(125,
Sa)){Sa=Object(oa.a)(125,Sa);let Cb=this.Ea.Cba(Sa);if(!Cb.slideId)return null;Sa=this.FKc(Cb.slideId,Cb.get_shapeId(),Sa.rowId.toString(),Sa.cellId.toString());return this.qad(Sa)}return null}qad(Sa){if(!Sa)return null;const Cb=Object(oa.a)(xa,this.Jyb[Sa]);return Cb?0>=this.PZd(Cb)?this.Jyb[Sa]=null:Cb:null}NSe(Sa){const Cb=this.dcj(Sa);Cb&&(this.Kyb[Cb]=Sa)}OSe(Sa){const Cb=this.Eej(Sa);Cb&&(this.Lyb[Cb]=Sa)}dcj(Sa){return Sa?this.Hsb(Sa.shapeNode.slideId,Sa.shapeNode.get_shapeId()):null}Eej(Sa){if(!Sa)return null;
Sa=Sa.tableCellNode;const Cb=this.Ea.Cba(Sa);return this.FKc(Cb.slideId,Cb.get_shapeId(),Sa.rowId.toString(),Sa.cellId.toString())}Hsb(Sa,Cb){return String.format("{0}#{1}#{2}",Sa.sid,Sa.cid,Cb)}FKc(Sa,Cb,rc,bd){return String.format("{0}#{1}#{2}#{3}#{4}",Sa.sid,Sa.cid,Cb,rc,bd)}vIj(Sa){const Cb=Object(oa.a)(123,this.ta.Ba);return Cb&&qa.a.hrh(Sa.zhd,Cb.Bb.Znc)?!0:!1}jBk(Sa){if(this.vIj(Sa)){var Cb=Sa.shapeId,rc=Sa.clientId;this.ta.Ba&&(Cb=this.ta.Ba.oS(Cb))&&(Sa.mxg&&this.Xr.PSd?this.vBk(Sa,rc,Cb):
this.pBk(Sa,rc,Cb))}}pBk(Sa,Cb,rc){rc.Qf||this.hfe&&rc.nd&&(this.Xr.Xpb||this.vlc)||!(rc=this.Jk(rc))||(this.wVc(rc,this.fia(Cb,this.QZd(Sa.lockType))),this.NSe(rc))}vBk(Sa,Cb,rc){if((rc=this.Gej(rc,Sa.Yuh,Sa.Kuh))&&rc.isConnected){var bd=Object(oa.a)(554,rc.Ag(this.Le));bd&&Z.a.Va(this.UW.f_b(rc))&&(this.Ybe(bd,this.fia(Cb,this.QZd(Sa.lockType))),this.OSe(bd))}}Gej(Sa,Cb,rc){Sa=this.sc.XM(Object(oa.a)(4,Sa));if(!Sa)return null;var bd=this.sc.lia(Sa);Sa=null;for(const pd of bd){bd=this.sc.J6a(pd);
for(const Oa of bd)if(Oa.rowId.toString()===Cb&&Oa.cellId.toString()===rc){Sa=Oa;break}}return Sa}a0h(Sa){const Cb=new A.a(0,1,0,()=>{this.e1g(Sa)},90,"79");this.yb.Gb(Cb)}Ypi(Sa){this.XJg=new Date;this.yle=this.RQi(Sa.Fc)}RQi(Sa){return Sa?Sa.querySelector(".Paragraph"):null}fia(Sa,Cb=""){const rc=this.ED.fia(Sa);if(rc)return rc;D.a.J(19140752,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",Sa,Cb);return this.mij}Uoh(Sa){return!this.Xr.uRd&&!(this.Xr.Xpb&&Sa.nd)&&!Sa.Qf}}
Ha.BSd="EditingBy";Ha.kJi="EditingByInSameWorker";Ha.wgl="StartEditing";Ha.vKi="EndEditing";Ha.Guj="ImeTyping";Ha.hrl="Typing";Object(h.a)(Ha,"CoauthStateChangesHandler",null,[567]);class cb{constructor(Sa){this.Csa={};this.Tv=Sa.hC;this.init(Sa)}init(Sa){if(Sa=Sa.bZ)for(const Cb of Sa)Cb.ID!==this.Tv&&(this.Csa[Cb.ID]=new Date)}f_h(Sa){for(let Cb=0;Cb<Sa.length;Cb++)Sa[Cb]in this.Csa||Sa[Cb]===this.Tv||(this.Csa[Sa[Cb]]=new Date)}vhl(Sa){const Cb=this.Csa[Sa];Cb&&(D.a.J(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",
this.Tv,Sa,(new Date).getTime()-Cb.getTime()),delete this.Csa[Sa])}uhl(Sa){const Cb=this.Csa[Sa];Cb&&(D.a.J(37590343,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.Tv,Sa,(new Date).getTime()-Cb.getTime()),delete this.Csa[Sa])}thl(){for(const Sa of Object.keys(this.Csa))D.a.J(37590345,814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",
this.Tv,Sa,(new Date).getTime()-this.Csa[Sa].getTime());this.Csa={}}}Object(h.a)(cb,"EditorPresenceTracker",null,[566]);class Za{constructor(Sa){this.U6j=Sa;this.nL=new M.a;this.nL.Bg(this.U6j)}}Object(h.a)(Za,"PPTRtcProvider",null,[565]);var va=d(113),Fa=d(1157),Ca=d(680);class La{constructor(Sa,Cb,rc,bd,pd){this.Gca=null;this.aT=!1;this.Mee=this.cme=null;this.k_j=va.a.create();this.qYc=!1;this.hZb=0;this.hT=pd;rc.vg&&(this.findSessionResponse=Sa,bd.bDf(Object(m.a)(this,this.R_k,"sessionPropertiesChanged")));
this.vEa=new Fa.a(()=>Cb())}get findSessionResponse(){return this.Gca}set findSessionResponse(Sa){if(this.aT)D.a.J(50943949,814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.Gca=Sa)this.aT=!0,this.cme=this.Gca.nPf,this.Mee=this.Gca.nA}get Zka(){return this.aT?this.cme:this.vEa.value.Zka}set Zka(Sa){this.aT?this.cme=Sa:this.vEa.value.Zka=Sa}SIe(Sa){this.vEa.value.SIe(Sa)}get nA(){return this.aT?this.Mee:this.vEa.value.nA}set nA(Sa){this.aT?
this.Mee=Sa:this.vEa.value.nA=Sa}ALc(){let Sa;D.a.J(51140180,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",this.aT,this.qYc);return this.aT?(Sa=this.Gca.correlationId||this.k_j.toString(),D.a.J(40130654,500,50,"CorrelationId after FindSession: {0}",Sa),{returnValue:String.format("{0}&{1}={2}",this.Gca.v4,G.AFrameworkApplication.eOd,Z.a.Me(Sa)),correlationId:Sa}):this.qYc?this.vEa.value.ALc():(D.a.J(51140183,
814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}k0d(Sa,Cb,rc,bd,pd){D.a.J(51140185,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.aT);this.aT?(Sa(this.Gca.KVb),rc(new Ca.a(this.Gca.R4c,this.Gca.O4c,this.Gca.N4c,this.Gca.ZNc))):(this.vEa.value.k0d(Sa,Cb,rc,bd,pd),this.qYc=!0);this.hT&&this.hT.Rh(26,!this.qYc)}NRd(){D.a.J(51140187,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",
this.aT);this.aT?this.aT=!1:this.vEa.value.NRd()}rla(Sa,Cb){D.a.J(51140189,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.aT);this.aT||this.vEa.value.rla(Sa,Cb)}R_k(){D.a.J(40464838,814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",this.aT);this.aT=!1}}Object(h.a)(La,"PptAssignRtcMachineStrategy",null,[564]);var nb=d(1114);class Nb{constructor(){this.Sn=null}XSb(Sa,Cb){this.Sn||(this.Sn=
{});this.Sn[Cb]||(this.Sn[Cb]=0);this.Sn[Cb]+=Sa}getData(){return this.Sn}reset(){this.Sn=null}}Object(h.a)(Nb,"MultiSumDataAggregator",null,[1495]);class Rb{constructor(Sa,Cb){this.bod=nb.a.qV(Sa,Cb,new Nb,!0)}zf(Sa){this.bod.track(1,Sa)}}Object(h.a)(Rb,"MultiCounter",null,[1526]);class Ya{constructor(Sa,Cb,rc,bd){this.Ky=Sa;this.I3=Cb;this.A9j=rc;this.R1j=bd;this.Ky.Eza(Object(m.a)(this,this.$Vk,"rtcOnUpdateNotificationReceived"))}$Vk(Sa,Cb){0===Cb.type&&(this.R1j.zf("CU"),this.A9j||this.OE())}OE(){!G.AFrameworkApplication.Xg&&
this.I3.XV&&this.I3.OE(null,null,null)}}Object(h.a)(Ya,"ContentNotificationManager",null,[]);class Qb extends Ya{constructor(Sa,Cb,rc,bd){super(Sa,Cb,rc,bd)}static init(){if(ea.App.Fb){var Sa=ea.App.Fb.Ed;if(Sa&&(Sa.cCf(Qb.yWg),Sa=Sa.zi)&&(Sa=Sa.contentReplicator)){var Cb=ea.App.Eh;if(Cb&&Cb.Qv&&(Cb=H.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var rc=G.AFrameworkApplication.fa.ka("Box4ThrottleInboundRequests"),bd=new Rb(11,1);Qb.UWc=Qb.UWc||new Qb(Cb,Sa,rc,bd);Qb.UWc.OE()}}}}static yWg(Sa){Qb.UWc||
(Sa.Dch(Qb.yWg),Qb.init())}}Qb.UWc=null;Object(h.a)(Qb,"PptContentNotificationManager",Ya,[]);var bb=d(101),Bb=d(336),Eb;(function(Sa){Sa[Sa.signalRConnectFailed=0]="signalRConnectFailed";Sa[Sa.findSessionFailed=1]="findSessionFailed"})(Eb||(Eb={}));Object(h.b)("RtcConnectFailureType",Eb);var tb=d(258);class Yb{constructor(Sa,Cb,rc,bd,pd,Oa){this.J0c=this.kLg=this.qab=this.pab=0;this.$$a=this.UEa=this.gka=this.o9b=this.FYc=this.XZ=null;this.bZc=this.dZc=this.eZc=this.$Yc=this.aZc=!1;this.$Ng=Sa;this.rj=
Cb;this.EN=rc;this.EN.Czc(Object(m.a)(this,this.hCb,"onNetworkHealthStateChanged"));this.Jj=bd;this.Ioe=Oa;$addHandler(window,"visibilitychange",Object(m.a)(this,this.onVisibilityChange,"onVisibilityChange"));this.B7j=pd;this.B7j.h5h(Object(m.a)(this,this.ynk,"onRtcConnectFailed"))}hCb(Sa,Cb){Cb.FSc||(this.dZc=this.eZc=!0)}onVisibilityChange(){window.document.hidden&&(this.$Yc=this.aZc=!0)}ynk(Sa,Cb){Sa=Cb.sPi;if(Cb=Cb.errorMessage){if(0===Sa){let bd,pd;({y4d:rc,z4d:bd,Ui:pd}=aa.RtcUtils.Y0f(Cb.ErrorDetails));
Cb.HttpErrorCode=rc;Cb.HttpErrorStatus=bd;Cb.Exception=pd;delete Cb.ErrorDetails;if(!rc&&this.Ioe&&0<this.Ioe.length)try{var rc=!0;const Oa=window.location.hostname.toLowerCase();for(const jb of this.Ioe.split(";"))if(Oa.endsWith(jb)){rc=!1;break}Cb.IsCORS=rc.toString()}catch(Oa){Cb.Unexpected=Oa.message}}D.a.J(41445510,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",this.rj.amIAlone,window.document.hidden,
this.Jj.SP,Eb[Sa],bb.a.toJSON(Cb));this.bZc||(this.bZc=this.PMj(Sa,Cb))}}PMj(Sa,Cb){const rc=tb.c(Cb,"HttpErrorCode",-1);return 500<=rc&&599>=rc||1===Sa&&"FindSessionRequestFailed"!==Cb.FindSessionFailureReason?!0:!1}djg(){return this.XZ&&1===this.qab?this.aZc||this.eZc:this.gka&&1<this.qab?this.$Yc||this.dZc:!1}Wqj(){return this.gka&&0<this.J0c?this.$Yc||this.dZc:this.XZ&&0<this.pab?this.aZc||this.eZc:!1}Nbd(){this.pab++;this.o9b=new Date;this.XZ||(this.XZ=new Date,this.aZc=window.document.hidden,
this.eZc=!this.Jj.SP)}sCe(){this.cah(0)}cah(Sa){this.qab++;this.UEa=new Date;this.FYc?this.UDc>this.$Ng.Igh&&(Sa={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.qab,["numberOfConnectionAttempts"]:this.pab,["firstConnectionAttempt"]:this.XZ?this.XZ.toISOString():"",["lastConnectionSuccess"]:this.UEa?this.UEa.toISOString():"",["lastUnexpectedDisconnect"]:this.gka?this.gka.toISOString():"",["lastExplicitDisconnect"]:this.$$a?this.$$a.toISOString():"",["reconnectDurationInMs"]:this.UDc,
["hasPageHiddenOrNetworkIssue"]:this.djg()},D.a.J(36804373,500,15,bb.a.toJSON(Sa))):(this.FYc=this.UEa,Bb.a.instance.ic("FirstPresenceUpdated",(new Date).getTime().toString()),this.UDc>this.$Ng.Igh&&(Sa={["hasExceededConnectionThrehold"]:!0,["numberOfConnectionAttempts"]:this.pab,["firstConnectionAttempt"]:this.XZ?this.XZ.toISOString():"",["firstConnectionSuccess"]:this.FYc?this.FYc.toISOString():"",["lastExplicitDisconnect"]:this.$$a?this.$$a.toISOString():"",["connectDurationInMs"]:this.UDc,["connectionDurationFromStopWatchInMs"]:Sa,
["hasPageHiddenOrNetworkIssue"]:this.djg()},D.a.J(36804373,500,15,bb.a.toJSON(Sa))))}Obd(){this.kLg++;const Sa={["numberOfFailedConnections"]:this.kLg,["numberOfConnectionAttempts"]:this.pab,["firstConnectionAttempt"]:this.XZ?this.XZ.toISOString():"",["lastConnectionAttempt"]:this.o9b?this.o9b.toISOString():"",["lastExplicitDisconnect"]:this.$$a?this.$$a.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),["disconnectedDurationMs"]:this.wGi,["hasPageHiddenOrNetworkIssue"]:this.Wqj()};
this.bZc?e.ULS.sendTraceTag(41702299,500,15,bb.a.toJSON(Sa)):e.ULS.sendTraceTag(36804375,500,15,bb.a.toJSON(Sa))}mhc(){this.J0c++;this.gka=new Date;this.$Yc=window.document.hidden;this.dZc=!this.Jj.SP}CIk(){this.T9k()&&this.Obd();this.$$a=new Date;this.Smi()}Smi(){this.J0c=this.qab=this.pab=0;this.UEa=this.gka=this.o9b=this.XZ=null;this.bZc=!1}T9k(){return!!this.o9b&&!this.UEa&&!this.gka}get UDc(){if(this.UEa){if(this.XZ&&1===this.qab)return this.rj.OKc(this.XZ,this.UEa);if(this.gka&&1<this.qab)return this.rj.OKc(this.gka,
this.UEa)}return 0}get wGi(){return this.gka&&0<this.J0c?this.rj.OKc(this.gka,new Date):this.XZ&&0<this.pab?this.rj.OKc(this.XZ,new Date):0}}Object(h.a)(Yb,"PptRealtimeChannelMetrics",null,[563]);var Tc=d(75),ib=d(31),Zb=d(37);class Cc{constructor(Sa,Cb,rc,bd,pd){this.e5j=Sa.toLowerCase();this.aFa=Cb;this.zm=rc;this.Tw=bd;this.xq=pd;this.Tw.Kga(Object(m.a)(this,this.xdc,"onShapeNodeLoaded"));this.xq.gDf(Object(m.a)(this,this.zdc,"onShapeViewElementUnlocked"))}dispose(){this.Tw.ZWa(Object(m.a)(this,
this.xdc,"onShapeNodeLoaded"));this.xq.ydh(Object(m.a)(this,this.zdc,"onShapeViewElementUnlocked"))}yB(Sa){return this.Usi(Sa)||this.XPf(Sa)}XPf(Sa){if(!Sa||Sa.Qf)return!1;const Cb=Sa.sa(Zb.a.ASd,"");return+new Date-+Sa.xVc<this.aFa&&!!Cb&&Cb.toLowerCase()!==this.e5j}Usi(Sa){return!!this.s_b(Sa)}X8f(Sa){let Cb="";Sa&&this.XPf(Sa)&&(Cb=Sa.getValue(Zb.a.ASd));return Cb}s_b(Sa){return Sa?Sa.sa(Zb.a.AYf,""):""}f_b(Sa){return Sa?Sa.sa(Zb.a.uji,""):""}fwl(Sa){if(Sa&&(Sa.yB=this.yB(Sa),Sa.anchor)){const rc=
this.zm.cqa(Sa);for(;rc.moveNext();){var Cb=rc.currentNode;ib.ParagraphReader.Wd(Cb)&&(Cb=Object(oa.a)(Tc.AParagraphNode,Cb))&&(Cb.yB=Sa.yB)}}}zdc(Sa,Cb){this.fwl(Cb.jx.shapeNode)}xdc(Sa,Cb){Sa=Cb.node;Sa.$ul();Sa.yB=this.yB(Sa)}}Object(h.a)(Cc,"PptWetChangeHandler",null,[562,106]);class ob{constructor(Sa){this.B6j=Sa}i2(){return this.B6j.i2()}}Object(h.a)(ob,"PresenceCache",null,[]);var cc=d(899),sb=d(1093),mb=d(1182),Pb=d(985),dc=d(1170);class mc extends v.a{constructor(){super();this.s1c=[]}wza(Sa){Sa&&
(D.a.J(8958528,814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",Sa.clientId,Sa.presence.toString()),Array.add(this.s1c,Sa))}tcd(Sa){(Sa=this.S6a(Sa))&&this.yEb(Sa);return Sa}yEb(Sa){Sa&&(D.a.J(8958530,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",Sa.clientId,Sa.presence.toString()),Array.remove(this.s1c,Sa))}S6a(Sa){for(const Cb of this.s1c)if(Cb.clientId===Sa)return Cb;return null}i2(){return this.s1c}}Object(h.a)(mc,"PresenceDataManager",v.a,
[]);var Mb=d(38),Kc=d(716);class gc{constructor(Sa,Cb,rc,bd,pd,Oa,jb,nc,kb,Gb,tc){this.clientId=Sa;this.data=jb;this.chatThreadId=Cb;this.chatThreadDiscoveryUri=rc;this.inChat=bd;this.email=pd;this.capabilities=Oa;this.userName=nc;this.clientType=kb;this.fHasClientEverExperiencedNetworkLoss=Gb;this.isAnonymous=tc}}Object(h.a)(gc,"SerializablePresenceInfo",null,[]);class rb{constructor(Sa,Cb,rc,bd,pd,Oa,jb,nc,kb,Gb,tc){this.D$b=null;this.Tv=Sa.toLowerCase();this.NA=Cb;this.One=rc;this.HDg=bd;this.GDg=
pd;this.KHg=Oa;this.F7b=jb;this.xDg=nc;this.Xka=kb;this.YNg=Gb;this.AFg=tc}u0d(){return new gc(this.Tv,this.HDg,this.GDg,this.KHg,this.F7b,this.xDg.capabilities,this.One?this.One.u0d():null,this.Xka,this.YNg,this.AFg,G.AFrameworkApplication.Jhb||G.AFrameworkApplication.ZP)}grj(Sa){if(!(Sa&&this.Mj.equals(Sa.slideId)&&this.presence&&this.presence.NT))return!1;for(const Cb of this.presence.NT)if(Cb===Sa.get_shapeId())return!0;return!1}get presence(){return this.One}get clientId(){return this.Tv}get chatThreadId(){return this.HDg}get chatThreadDiscoveryUri(){return this.GDg}get inChat(){return this.KHg}get email(){return this.F7b}get capabilities(){return this.xDg}get Mj(){return this.NA}get userName(){return this.Xka}get clientType(){return this.YNg}get fHasClientEverExperiencedNetworkLoss(){return this.AFg}get presenceUser(){return this.D$b}set presenceUser(Sa){this.D$b&&
(Sa?!this.D$b.client||0===this.D$b.client||Sa.client&&0!==Sa.client||D.a.J(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.Tv):D.a.J(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.Tv));this.D$b=Sa}static OEc(Sa){if(!Sa||!Sa.clientId)return D.a.J(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const Cb=Kc.a.OEc(Sa.data);let rc=0;Sa.clientType&&8>=Sa.clientType&&(rc=Sa.clientType);
return new rb(Sa.clientId,Cb.Mj,Cb,Sa.chatThreadId,Sa.chatThreadDiscoveryUri,Sa.inChat,Sa.email,new pa.a(Sa.capabilities),Sa.userName,rc,Sa.fHasClientEverExperiencedNetworkLoss)}}Object(h.a)(rb,"PresenceEntry",null,[]);class Ua extends Sys.EventArgs{constructor(Sa,Cb,rc,bd,pd,Oa){super();this.NA=Sa;this.g$j=rc;this.M2c=Cb;this.qNh=bd;this.y8j=pd;this.D6j=Oa}get slideId(){return this.NA}get user(){return this.g$j}get shapes(){return this.M2c}get B7(){return this.qNh}get urh(){return this.y8j}get i6g(){return this.D6j}}
Object(h.a)(Ua,"SlidePresenceChangedEventArgs",Sys.EventArgs,[]);var pb=d(28);class Ub extends v.a{constructor(Sa,Cb,rc,bd,pd,Oa,jb,nc,kb,Gb,tc,dd,$c,Pc,Ad,Ee,Ce,Fb,$e,bg,Ye,Ae,si,Jf,tg,Dg,Vg){super();this.rQ=new mc;this.zo=null;this.gEg=[];this.hEg=null;this.gxb=!0;this.I$a=!1;this.hKg=new Date;this.cVa=null;this.LFg=this.BFg=this.fHg=!1;this.r1c=null;this.I8=Sa;Sa.userName||(Sa.userName=Jf);this.$b=Cb;this.Ky=rc;this.Tv=bd.clientId;this.f9=bd.lw;this.me=pd;this.hc=Ye;this.B$b=bg;this.hT=Ae;this.EN=
tg;this.Zja=Vg;si.execute(Ih=>{this.zo=Ih});this.rsj();this.rj=$c;this.oq=Pc;this.Nke=Ad.Svg;this.qJg=Ad.YMj;this.N8b=Ad.podsDefaultToRtcForPresenceEnabled;this.Z2j=Ad.podsNoClientRtcConnectWhenAccessTokenExpiredEnabled;this.IJg=G.AFrameworkApplication.zz;this.xke=Ad.vg&&Ad.pptNoRtcConnectWhenReadOnlyEnabled;this.ra=Oa;this.ra.XJ(Object(m.a)(this,this.YG,"onSelectionChanged"));this.Ur=jb;this.Ur.e6h(Object(m.a)(this,this.Fpk,"onValidShapeIdLoaded"));this.od=nc;this.od.GY(Object(m.a)(this,this.Ogk,
"onActiveSlideDOMReady"));this.wI=kb;this.wI.fGd(Object(m.a)(this,this.T6c,"onEditorTableUpdate"));this.Ci=Ee;this.Ci.tB(Object(m.a)(this,this.VA,"onSessionEnd"));this.Ci.uB(Object(m.a)(this,this.jo,"onSessionRehydrated"));this.Ci.OMa(Object(m.a)(this,this.ndc,"onOutboundReplication"));this.vZj=Ad.pptAwayStatusTimeGapForPresenceUpdateInMs;this.QFg=Ad.Rdl;this.ia=tc;this.ta=Gb;this.t1c=dd;this.ZXc=Ce;this.Uab=Fb;this.nxb=$e;Ad.vg&&(this.Ci.aDf(Object(m.a)(this,this.tdc,"onSessionAccessTokenExpiring")),
this.Ci.Pzc(Object(m.a)(this,this.Dla,"onSessionAccessTokenExpired")),this.Ci.DGd(Object(m.a)(this,this.i8c,"onSessionExpired")),this.$b.ff(()=>{this.I8.userName=this.$b.appSettings.UserName;this.I8.email||(this.I8.email=G.AFrameworkApplication.fa.Ha("UserPrincipalName"));this.hc.BK||(D.a.J(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.xke&&this.Ci.Mga(Object(m.a)(this,this.Vz,"onUnifiedAppStateChanged"))}),this.IJg&&this.Ci.Szc(Object(m.a)(this,this.Mda,"onWopiTokenRefreshed")));
D.a.J(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",this.IJg)}ub(){this.ia.pa(pb.a.MWa,Mb.a.application,Object(m.a)(this,this.MWa,"querySlidePresenceUsers"),96)}MWa(Sa,Cb,rc,bd,pd){pd.Mkc=this.s0b(pd.slideId);pd.h6g=this.vsb();return 32}s0b(Sa){return(Sa=this.Adg(Sa))?Sa.length:0}rsj(){this.Ky.M2a(Object(m.a)(this,this.nsi,"connectionStateChanged"));this.Ky.Nzc(Object(m.a)(this,this.presenceUpdated,"presenceUpdated"));G.AFrameworkApplication.fa.ka("PPTForceUpdateEditorTableEnabled")&&
this.Ky.Eza(Object(m.a)(this,this.jvl,"updateNotificationReceived"));L.a.getInstance().S2h(Object(m.a)(this,this.GYg,"onGotCompletePersistentStateWithMetadata"));this.QFg&&this.EN.Czc(Object(m.a)(this,this.Ulk,"onNetworkHealthChanged"));this.cVa=this.f9.wi("WebServiceCall","RtcConnection");this.hT.FLi();this.Ky.connect()}Gah(){const Sa=this.Ky.nKc();this.NBh(new sb.a(Sa,null));this.cjc()}Ulk(Sa,Cb){Cb.FSc||(this.hT.GLi(),this.BFg=!0)}GYg(Sa,Cb){this.hT.JLi(Cb.Fzk);L.a.getInstance().ZOk(Object(m.a)(this,
this.GYg,"onGotCompletePersistentStateWithMetadata"))}nsi(Sa,Cb){D.a.J(512360715,814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",Ub.QXd(Cb.oldState),Ub.QXd(Cb.newState),this.Tv);switch(Cb.newState){case 2:this.cVa.stop();Sa=this.cVa.Dq;this.hT.ELi();this.Gah();this.B$b.cah(Sa);break;case 1:2===Cb.oldState&&this.B$b.mhc();this.B$b.Nbd();break;case 0:this.gxb?this.Xmi():2===Cb.oldState&&(window.setTimeout(()=>{this.Ky.connect()},0),D.a.J(512360714,
814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.me.i0b().getTime()),this.B$b.mhc())}}getSelectedShapes(){if(!this.qJg)return null;const Sa=[],Cb=this.ra.ae();for(let rc=0;rc<Cb.length;++rc)Array.add(Sa,Cb[rc].get_shapeId());0<Sa.length&&Sa.sort();return Sa}Xmi(){var Sa=this.rQ.i2();if(Sa&&Sa.length){Sa=Array.clone(Sa);for(const Cb of Sa)this.yEb(Cb);this.raiseEvent("PresenceChanged")}}oHe(Sa,Cb){try{this.I8.email||(this.I8.email=G.AFrameworkApplication.fa.Ha("UserPrincipalName"));
const rc=new Kc.a(Sa,Cb),bd=new rb(this.I8.clientId,Sa,rc,this.I8.chatThreadId,this.I8.chatThreadDiscoveryUri,this.I8.inChat,this.I8.email,this.I8.capabilities,this.I8.userName,1,this.BFg);this.I8.email||D.a.J(512360713,814,15,"PresenceManager : SendPresence; empty email for user");this.Ky.oHe(bd.u0d()).continueWith(()=>{D.a.J(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.Tv,rc.toString(),this.me.i0b().getTime())});this.hKg=
new Date;this.hT.VVj();this.zIk(Sa,Cb);D.a.J(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.Tv,rc.toString(),this.me.i0b().getTime());this.$Ik(rc)}catch(rc){D.a.J(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",rc.toString(),this.Tv)}}presenceUpdated(Sa,Cb){Sa=!!this.zo&&this.zo.eZ;D.a.J(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",
this.Tv,Sa);if(!Sa){this.hT.XVj(Cb.yJb);Sa=null;this.f9&&(Sa=this.f9.wi("ServerNotification","Presence Updated"));try{this.NBh(Cb)}finally{Sa&&Sa.stop()}}}jvl(Sa,Cb){D.a.J(512360711,814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",Cb.type,this.Tv)}NBh(Sa){this.r0h(Sa.yJb);this.neb(Sa.VWf);D.a.J(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}cjc(){this.ta.Mj?this.oHe(this.ta.Mj,this.getSelectedShapes()):
D.a.J(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}YG(){if(this.ta.Mj){var Sa=this.getSelectedShapes();(Ub.krj(this.hEg,this.ta.Mj)||Ub.H3d(Sa,this.gEg))&&this.cjc()}else D.a.J(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}Ogk(Sa,Cb){Cb.Ba?this.ta.Mj?this.cjc():D.a.J(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):D.a.J(512360706,
814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}Fpk(Sa,Cb){this.ta.Mj?Array.contains(this.getSelectedShapes(),Cb.shapeNode.get_shapeId())&&this.cjc():D.a.J(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}jdl(Sa,Cb,rc){Cb=this.C7f(Cb);Sa=this.C7f(Sa);this.me.QZi().amc.raiseEvent(Ub.ESd,new mb.a(this.rj.hC,null,Cb,Sa,null,0,0,rc))}C7f(Sa){const Cb=new Pb.a;for(let rc=0;rc<Sa.length;rc++){const bd=Sa[rc];if(!bd)continue;if(bd.ID===
this.rj.hC)continue;if(!bd.EmailAddress){Cb.$(bd.ID,this.B7f(bd));continue}const pd=this.rQ.S6a(this.rj.hC);pd&&pd.email&&bd.EmailAddress&&pd.email.toUpperCase()===bd.EmailAddress.toUpperCase()||Cb.$(bd.EmailAddress.toUpperCase(),this.B7f(bd))}return Cb.values}B7f(Sa){const Cb=new dc.a;Cb.EmailAddress=Sa.EmailAddress;Cb.Id=Sa.ID;Cb.Name=Sa.Name;return Cb}T6c(Sa,Cb){this.jdl(Cb.Azg,Cb.yGf,Cb.SFj);if(Sa=this.rj.bZ){var rc=Cb.Azg;for(var bd=0;bd<rc.length;bd++)this.ZXc.vhl(rc[bd].ID);rc=[];Cb=Cb.yGf;
for(bd=0;bd<Cb.length;bd++){let Oa=Cb[bd];const jb=Oa.ID;if(jb!==this.rj.hC){const nc=this.rQ.S6a(jb);nc?this.nxb.JIf(nc.email,Oa.EmailAddress):Array.add(rc,jb)}}this.ZXc.f_h(rc);2<=Sa.length&&D.a.J(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.Tv,Sa.length);rc=[];Cb=[];for(var pd of Sa)Array.add(rc,pd.ID),pd.ID===this.rj.hC||this.rQ.S6a(pd.ID)||Array.add(Cb,pd.ID);D.a.J(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",
this.Tv,Sa.length,rc.join(","),Cb.join(","));for(const Oa of this.rQ.i2())({editor:pd}=this.rj.vhb(Oa.clientId)).returnValue?this.trj(pd.ColorIndex)?(this.WIk(Oa),Sa=this.Uab.fCa(new cc.a(pd.EmailAddress,void 0,pd.Name),pd.ColorIndex,pd.ID,0),Oa.presenceUser=new E.a(Oa.clientId,pd.Name,Sa,new pa.a(1),null,null,Oa.clientType),this.t1c.Dbd(new Ua(Oa.Mj,Oa.presence.NT,Oa.presenceUser,!0,this.s0b(Oa.Mj),this.vsb())),D.a.J(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",
Oa.clientId,Oa.presence.toString(),Oa.presenceUser.color,this.Tv)):D.a.J(512360672,814,50,"PresenceManager : OnEditorTableUpdate; EditorInfo has no color assigned; ClientId: {0};  Presence: {1}; MyClientId: {2};",Oa.clientId,Oa.presence.toString(),this.Tv):D.a.J(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",Oa.clientId,Oa.presence.toString(),Oa.presenceUser?Oa.presenceUser.color:"",this.Tv);this.raiseEvent("PresenceChanged")}else D.a.J(512360675,
814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.Tv)}VA(Sa,Cb){this.ZXc.thl();5!==Cb.fJ&&(D.a.J(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),this.disconnect())}tdc(){D.a.J(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.I$a||(D.a.J(512360667,814,50,"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.I$a=!0)}Dla(){D.a.J(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");
this.I$a||(D.a.J(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.I$a=!0)}i8c(){D.a.J(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");this.disconnect()}Mda(Sa,Cb){D.a.J(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{Cb.YTc?(D.a.J(512360662,814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",Ub.QXd(this.Ky.connectionState)),this.I$a=!1,this.xke&&!this.hc.BK?D.a.J(512360661,
814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.gxb||2!==this.Ky.connectionState?this.connect():(Sa={},Sa.qs=this.Zja.presentationId.string,D.a.J(512360660,814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.Ky.Ahb(Sa))):D.a.J(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(rc){D.a.J(512360658,814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",rc)}}jo(Sa,Cb){this.Z2j&&this.I$a||
this.xke&&!this.hc.BK?D.a.J(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.I$a,this.hc.BK):4!==Cb.Jva||this.gxb?this.connect():(D.a.J(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.Gah())}Vz(Sa,Cb){Cb.$8d&&!this.hc.BK&&(D.a.J(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),this.disconnect())}connect(){D.a.J(512360654,
814,50,"PresenceManager : Connect");this.gxb=!1;this.Ky.connect()}ndc(){this.i$k()&&(D.a.J(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),this.cjc())}i$k(){const Sa=this.Ky.F7i();return Sa?2===Sa.status||+new Date-+this.hKg>this.vZj?!0:!1:!1}hLj(){const Sa=this.rQ.i2();if(0<Sa.length)for(const Cb of Sa)if(Cb.presence&&Cb.presence.Mj)return!0;return!1}H9k(){return!this.fHg&&this.N8b&&2!==this.rj.Yaa}r0h(Sa){for(let rc in Sa){var Cb=Sa[rc];try{const bd=
rb.OEc(Cb);if(!bd||bd.clientId===this.Tv)continue;const pd=bd.clientId;this.H9k()&&(this.fHg=!0,this.oq.fnc(2),D.a.J(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));D.a.J(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",pd,bd.presence.toString());const Oa=bd.email;if(!this.nxb.lYd(Oa)){let jb;({editor:jb}=this.rj.vhb(pd)).returnValue&&this.nxb.JIf(Oa,jb.EmailAddress)}this.t0h(bd);this.hT.DLi()}catch(bd){D.a.J(512360651,814,
10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",bd.toString(),this.Tv)}}this.hT.WVj(Sa)}t0h(Sa){this.AKi(Sa);const Cb=this.Ky.w2(Sa.clientId);Cb&&2===Cb.status?D.a.J(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",Sa.clientId):this.s0h(Sa)}s0h(Sa){const Cb=this.rQ.S6a(Sa.clientId);if(Cb){if(!this.arj(Cb,Sa))return;D.a.J(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",
Sa.clientId,Cb.presence.toString(),Sa.presence.toString(),this.Tv);this.yEb(Cb)}this.J0h(Sa)}yEb(Sa){Sa&&(this.rQ.yEb(Sa),Sa.presenceUser&&this.t1c.Dbd(new Ua(Sa.Mj,Sa.presence.NT,Sa.presenceUser,!1,this.s0b(Sa.Mj),this.vsb())))}u_f(Sa){if(Sa)if(Sa.presenceUser)D.a.J(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",Sa.clientId);else{const Cb=this.Xbg(Sa.clientId);Cb?Sa.presenceUser=Cb:D.a.J(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",
Sa.clientId)}}J0h(Sa){Sa&&(this.rQ.wza(Sa),this.ZXc.uhl(Sa.clientId),this.u_f(Sa),Sa.presenceUser?this.t1c.Dbd(new Ua(Sa.Mj,Sa.presence.NT,Sa.presenceUser,!0,this.s0b(Sa.Mj),this.vsb())):D.a.J(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Sa.clientId))}trj(Sa){return!this.Nke||Sa?!0:!1}arj(Sa,Cb){let rc;(rc=!Sa.Mj.equals(Cb.Mj))&&D.a.J(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Sa.Mj,Cb.Mj);(Sa=this.qJg&&Ub.D7k(Sa,Cb))&&
D.a.J(512360646,814,50,"Shape Presence Changed");return rc||Sa}neb(Sa){if(Sa){for(let Cb=0;Cb<Sa.length;Cb++)Sa[Cb]=Sa[Cb].toLowerCase();for(const Cb of Sa)D.a.J(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",Cb),(Sa=this.rQ.tcd(Cb))?Sa.presenceUser?this.t1c.Dbd(new Ua(Sa.Mj,Sa.presence.NT,Sa.presenceUser,!1,this.s0b(Sa.Mj),this.vsb())):D.a.J(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):D.a.J(512360644,
814,15,"PresenceManager : RemovePresence; entry did not exist")}}Adg(Sa){const Cb=[];for(const rc of this.rQ.i2())rc.Mj.equals(Sa)&&rc.presenceUser&&Array.add(Cb,rc.presenceUser);return Cb}kdg(Sa){const Cb=[];for(const rc of this.rQ.i2())rc.presence&&rc.grj(Sa)&&rc.presenceUser&&Array.add(Cb,rc.presenceUser);return Cb}SZb(){const Sa=[];for(const Cb of this.rQ.i2())Cb.presenceUser&&Array.add(Sa,Cb.presenceUser);return Sa}vsb(){const Sa=this.SZb();return Sa?Sa.length:0}fia(Sa){if(!Sa)return null;Sa=
Sa.toLocaleLowerCase();for(const Cb of this.rQ.i2())if(Cb.presenceUser&&Cb.presenceUser.clientId===Sa)return Cb.presenceUser;return this.Xbg(Sa)}tcd(Sa){const Cb=this.rQ.S6a(Sa);this.yEb(Cb);D.a.J(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",Cb?Cb.clientId:Sa+" not found",this.Tv)}T4h(Sa){this.addHandler("PresenceChanged",Sa)}i2(){return this.rQ.i2()}connectionState(){return this.Ky.connectionState}disconnect(){try{D.a.J(512360640,814,
50,"PresenceManager : Disconnect"),this.gxb||this.B$b.CIk(),this.gxb=!0,this.Ky.disconnect()}catch(Sa){D.a.J(512360611,814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",Sa.message,Sa.stack)}}zIk(Sa,Cb){this.hEg=Sa;this.gEg=Cb}Xbg(Sa){let Cb;const rc=({editor:Cb}=this.rj.vhb(Sa)).returnValue;var bd=this.Ky.zra(Sa),pd=!!bd;if(!rc&&!pd)return D.a.J(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",Sa),null;bd=pd?
bd:null;rc||D.a.J(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",Sa);pd||D.a.J(512360608,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",Sa);pd&&rc&&D.a.J(512360607,814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",Sa,bd.clientId!==Cb.ID,bd.email!==Cb.EmailAddress);var Oa=rc?new cc.a(Cb.EmailAddress,void 0,Cb.Name):new cc.a(this.nxb.lYd(bd.email)||bd.email,void 0,bd.userName);Oa=this.Uab.fCa(Oa,rc?Cb.ColorIndex:
null,rc?Cb.ID:bd.clientId,0);pd=pd?bd.clientType:0;return new E.a(Sa,rc?Cb.Name:bd.userName,Oa,new pa.a(1),null,null,pd)}WIk(Sa){this.ta.Mj.equals(Sa.Mj)&&Sa.presence.NT&&Sa.presence.NT.length&&D.a.J(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Sa.clientId,Sa.presence.toString(),this.Tv,this.me.i0b().getTime());D.a.J(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}",
"OnEditorTableUpdate",Sa.clientId,Sa.presence.toString(),this.Tv,this.me.i0b().getTime())}$Ik(Sa){const Cb=[this.rj.userName];let rc=0;for(var bd of this.rQ.i2())bd.presence.Mj.equals(Sa.Mj)&&!Ub.H3d(bd.presence.NT,Sa.NT)&&(rc++,bd.presenceUser&&Array.add(Cb,bd.presenceUser.userName));if(0<rc){bd={};let pd=0,Oa=0;for(let jb=0;jb<Cb.length;++jb){let nc=Cb[jb];nc&&nc.length||(nc="anonymous",Oa++);nc in bd||(bd[nc]=!0,pd++)}D.a.J(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",
rc+1,Sa.NT&&0<Sa.NT.length?"shape":"slide",pd,Oa)}}AKi(Sa){try{!this.hT.dPi()||this.rQ.S6a(Sa.clientId)||this.QFg&&Sa.fHasClientEverExperiencedNetworkLoss||(this.u_f(Sa),this.BKi(Sa.presenceUser))}catch(Cb){D.a.J(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",Cb.toString())}}BKi(Sa){Sa&&Sa.clientId&&(this.LFg||this.r1c||(this.LFg=!0,this.r1c=H.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.r1c&&this.r1c.FKi(Sa.clientId,Ub.Qaj(Sa)))}static QXd(Sa){let Cb=
"";switch(Sa){case 2:Cb="Connected";break;case 1:Cb="Connecting";break;case 0:Cb="Disconnected"}return Cb}static H3d(Sa,Cb){if(!Sa&&!Cb)return!1;if(!Sa&&Cb||Sa&&!Cb||Sa.length!==Cb.length)return!0;for(let rc=0;rc<Sa.length;rc++)if(Sa[rc]!==Cb[rc])return!0;return!1}static krj(Sa,Cb){return!qa.a.Cea(Sa,Cb)}static D7k(Sa,Cb){return Sa.Mj.equals(Cb.Mj)&&Ub.H3d(Sa.presence.NT,Cb.presence.NT)}static Qaj(Sa){return Sa&&1===Sa.client?1:0}}Ub.ESd="ETU";Object(h.a)(Ub,"PresenceManager",v.a,[558,559,560,561]);
var Bc=d(1099),Gc=d(1102),qd=d(999),Td=d(72),Vd=d(47),Be=d(318);class Id{constructor(Sa,Cb,rc,bd,pd){this.It=null;this.Ix=G.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled");Cb=this.Y9i(Cb,bd,pd);this.It=this.Ix?(new Bc.a(Cb)).spb(Sa):(new Gc.a(Cb)).NEc(Sa,rc)}dispose(){this.It.dispose()}rze(){return Vd.a.Yh(document.getElementById(Be.a.mUb))}Y9i(Sa,Cb,rc){const bd=new qd.a;bd.add(0,Td.getImageClassWithCluster(G.AFrameworkApplication.$M,"MoreUsersGlyph_16x16x32"));bd.add(5,G.AFrameworkApplication.Vl);
bd.add(1,Td.getImageClassWithCluster(G.AFrameworkApplication.$M,this.Ix?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));bd.add(4,G.AFrameworkApplication.Vl);bd.add(6,rc);bd.add(8,G.AFrameworkApplication.isRtl);bd.add(12,Sa);bd.add(11,Cb);this.Ix&&(bd.add(16,Object(m.a)(this,this.rze,"presenceViewportBoundsCallback")),bd.add(17,!0));return bd}lz(Sa){this.It?(D.a.J(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",Sa.clientId),this.It.lz(Sa)):D.a.J(8958617,814,
10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",Sa.clientId)}BL(Sa){this.It?(D.a.J(8958623,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",Sa.clientId),this.It.BL(Sa.clientId)):D.a.J(8958621,814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",Sa.clientId)}clear(){if(this.It)if(D.a.J(8958627,814,50,"PresencePawn:Clear at PresencePawn "),this.gia())for(const Sa of this.gia())this.BL(Sa);else D.a.J(8958657,
814,50,"PresencePawn:Clear - Pawn has no users");else D.a.J(8958625,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}gia(){return this.It?this.It.Adb:null}QLe(){this.It&&(this.Ix&&this.It.Bea(),this.It.swa())}Z3d(){this.It&&this.It.Bea()}}Object(h.a)(Id,"PresencePawn",null,[435,106]);class gb{mBi(Sa,Cb,rc){return new Id(Sa,2,Cb,!0,rc)}}Object(h.a)(gb,"PresencePawnFactory",null,[527]);var Xb=d(30);class Ic{constructor(Sa,Cb,rc,bd,pd,Oa,jb,nc,kb,Gb,tc){this.nne=[];this.TUa=
null;this.tGg=this.sGg=this.tie=0;this.YYc=this.ZYc=null;this.a1c=[];if(!Cb)throw Error.argumentNull("graphTopologyManager");if(!rc)throw Error.argumentNull("presenceManager");if(!bd)throw Error.argumentNull("dragInputManager");if(!pd)throw Error.argumentNull("coauthStateChangesHandler");this.od=Sa;this.ta=Cb;this.ED=rc;this.Bt=bd;this.zee=pd;this.xka=Oa;this.Sb=jb;this.Le=nc;this.Mbb=kb;this.vka=Gb;this.g_=tc;this.vka.P2a(Object(m.a)(this,this.Ehd,"slidePresenceChanged"));this.od.GY(Object(m.a)(this,
this.jWa,"onSlideNavigation"));this.od.HGd(Object(m.a)(this,this.vCb,"onThumbnailRefresh"));this.od.Tmb(Object(m.a)(this,this.twe,"onThumbnailVisibleRangeChanged"));this.fIg=G.AFrameworkApplication.fa.ka("PPTCanvasPresenceFloodGateSurveyEnabled");(this.Ix=G.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.fIg&&(this.sGg=G.AFrameworkApplication.fa.Ec("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.tGg=G.AFrameworkApplication.fa.Ec("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",
3),this.tie=0,this.TUa=I.a.vu(H.a.instance.La("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.od.QSb(Object(m.a)(this,this.M7k,"shapeViewElementAdded"));this.od.eDf(Object(m.a)(this,this.N7k,"shapeViewElementLocked"));this.od.v4h(Object(m.a)(this,this.ook,"onShapeViewElementShowLockHint"));this.od.w4h(Object(m.a)(this,this.pok,"onShapeViewElementShowPresenceHint"));this.od.t4h(Object(m.a)(this,this.iok,"onShapeViewElementHidePresenceHint"))}jWa(){this.ta.Mj&&(D.a.J(512263071,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",
this.ta.Mj),this.VJk(this.ta.Mj))}VJk(Sa){if(this.ta.Mj&&this.ta.Mj.equals(Sa)&&(D.a.J(512263070,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",Sa),Sa=new Xb.GraphIterator,Sa.set(this.ta.Ba),Sa.zb(1))){do if(0<Sa.currentNode.getValue(Zb.a.shapeId)){const Cb=Object(oa.a)(4,Sa.currentNode);Cb&&this.Rah(Cb)}while(Sa.uf(1))}}Ehd(Sa,Cb){this.Bt.ZCa?(D.a.J(512263069,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.YYc||(this.YYc=
new A.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(Cb)},90,"68"),G.AFrameworkApplication.ue.Gb(this.YYc)),Cb&&this.a1c.push(Cb)):(this.sBk(Cb),this.qBk(Cb))}handlePendingPresenceChangedEvent(){this.YYc=null;this.TJk();if(this.ta.Mj&&0<this.a1c.length){const rc={},bd={};var Sa=this.ta.Mj;for(var Cb of this.a1c){if(!Sa.equals(Cb.slideId))continue;if(!Cb.shapes||!Cb.user)continue;Cb.user.clientId in bd||(rc[Cb.user.clientId]=Cb.user,bd[Cb.user.clientId]=new Pb.a(0));const pd=bd[Cb.user.clientId];
for(const Oa of Cb.shapes){const jb=Cb.B7?1:0;pd.Jb(Oa)?0<(pd.ga(Oa)^jb)&&pd.$(Oa,jb):pd.add(Oa,jb)}}for(let pd in rc){Sa=rc[pd];Cb=pd;if(!(Cb in bd))continue;const Oa=[],jb=[];bd[Cb].forEach((nc,kb)=>{0<kb?jb.push(nc):Oa.push(nc);return!0});0<Oa.length&&this.vch(Oa,Sa);0<jb.length&&this.IBf(jb,Sa)}this.a1c=[]}}sBk(Sa){Sa.B7?this.wza(Sa.slideId,Sa.user):this.neb(Sa.slideId,Sa.user)}vCb(Sa,Cb){this.Pah([Cb.hwh])}twe(Sa,Cb){this.Pah(Cb.XYa)}Pah(Sa){const Cb=[];for(const rc of Sa)Sa=this.g_?this.Sb.R0d(rc):
this.Sb.xra(rc),this.g_&&0>=Sa.i$||Sa&&Array.add(Cb,Sa);this.Oah(Cb)}wza(Sa,Cb){const rc=this.Jeg(Sa);rc?(rc.wza(Cb),this.$be(),D.a.J(512263067,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",Sa.toString())):D.a.J(21770506,814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",Sa.toString())}neb(Sa,Cb){const rc=this.Jeg(Sa);rc?rc.neb(Cb):D.a.J(512263066,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Sa.toString())}Jeg(Sa){const Cb=
this.Sb.xra(Sa);return Cb?Object(oa.a)(557,Cb.Ag(this.Mbb)):(D.a.J(512263065,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Sa.toString()),null)}TJk(){const Sa=this.ta.presentation;if(!Sa)throw Error.argumentNull("Presentation is null");this.Oah(Sa.slides||[])}Oah(Sa){for(const rc of Sa){var Cb=Object(oa.a)(123,rc);Cb?(Sa=Cb.Bb,(Cb=Object(oa.a)(557,Cb.Ag(this.Mbb)))?(D.a.J(512263062,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",
Sa.toString()),Cb.Chb(this.ED.Adg(Sa))):D.a.J(512263063,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",Sa.toString())):D.a.J(512263064,814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",rc.Bb.toString())}}$be(){this.Ix&&this.fIg&&(this.Jol()||this.TUa&&this.TUa.continueWith(()=>{this.TUa.result.logActivity("PresenceBubbleRendered","PPTCanvasPresenceFloodGateSurveyEnabled",
this.sGg)&&this.tie++}))}Jol(){return this.tie>=this.tGg}qBk(Sa){this.ta.Mj&&this.ta.Mj.equals(Sa.slideId)&&Sa.shapes&&(Sa.B7?this.IBf(Sa.shapes,Sa.user):this.vch(Sa.shapes,Sa.user))}M7k(Sa,Cb){Sa=Cb.jx;this.Iwg(Sa.shapeNode)&&(this.nne.push(Sa),this.ZYc||(this.ZYc=new A.a(2,1,0,Object(m.a)(this,this.handlePendingShapePresenceUpdate,"handlePendingShapePresenceUpdate"),90,"69"),G.AFrameworkApplication.ue.Gb(this.ZYc)))}handlePendingShapePresenceUpdate(){this.ZYc=null;for(const Sa of this.nne){if(!this.Iwg(Sa.shapeNode))return;
this.Rah(Sa.shapeNode)}Array.clear(this.nne)}Rah(Sa){const Cb=Object(oa.a)(124,Sa.oc(this.Le));if(Cb&&!Sa.get_smartArtModelId()){var rc=this.ED.kdg(Sa);if(rc)if(rc.length){Sa=this.xka.xP(Sa);Sa.wNf();for(const bd of rc)Sa.wza(bd),this.$be()}else(rc=this.xka.VE(Sa))&&rc.wNf();this.zee.d1g(Cb)}}IBf(Sa,Cb){var rc=this.ndg();let bd=!1;for(const pd of rc){if(!Array.contains(Sa,pd.get_shapeId())||pd.get_smartArtModelId())continue;rc=Object(oa.a)(124,pd.oc(this.Le));if(!rc||pd.get_smartArtModelId())continue;
const Oa=this.xka.xP(pd);Oa?(rc.isSelected&&(Oa.Qnb=!1),Oa.wza(Cb),this.$be(),rc.isSelected&&Oa.bcc()):bd=!0}bd||D.a.J(512263060,814,50,"PresencePresenter::AddShapePresence succeeded")}vch(Sa,Cb){var rc=this.ndg();for(const bd of rc)Array.contains(Sa,bd.get_shapeId())&&(rc=this.xka.xP(bd))&&rc.neb(Cb)}ndg(){let Sa=null;this.ta.Ba&&(Sa=this.ta.Ba.om());return Sa||[]}Iwg(Sa){return!!this.ta.Ba&&this.ta.Ba.Bb.equals(Sa.slideId)}N7k(Sa,Cb){this.xka.xP(Cb.jx.shapeNode).Kld(Cb.presenceUser)}ook(Sa,Cb){(Cb.jx.Kp||
Cb.jx.Pgd)&&(Sa=this.xka.VE(Cb.jx.shapeNode))&&Sa.jLe()}pok(Sa,Cb){(Sa=this.xka.VE(Cb.jx.shapeNode))&&Sa.Aal()}iok(Sa,Cb){(Sa=this.xka.VE(Cb.jx.shapeNode))&&Sa.pZ()}}Object(h.a)(Ic,"PresencePresenter",null,[]);class Wc{constructor(Sa){this.M$b=Sa}zra(Sa){return this.M$b.zra(Sa)}w2(Sa){return this.M$b.w2(Sa)}}Object(h.a)(Wc,"PresenceUserInfoGetter",null,[529,474]);class Ib{constructor(Sa=null){this.rj=Sa}Ybg(Sa){if(!Sa||!Sa.value)return null;Sa=Sa.value;let Cb=Sa.userName;if(!Cb&&this.rj){let rc;({editor:rc}=
this.rj.vhb(Sa.clientId)).returnValue&&(Cb=rc.Name)}return Object.assign(new E.a,{clientId:Sa.clientId,chatThreadId:Sa.chatThreadId,chatThreadDiscoveryUri:Sa.chatThreadDiscoveryUri,inChat:Sa.inChat,email:Sa.email,capabilities:new pa.a(Sa.capabilities),userName:Cb})}}Object(h.a)(Ib,"PresenceUtils",null,[556]);var ec;(function(Sa){Sa[Sa.coauthHandlerResponse=0]="coauthHandlerResponse";Sa[Sa.popSessionResponse=1]="popSessionResponse";Sa[Sa.defaultFallback=2]="defaultFallback"})(ec||(ec={}));Object(h.b)("RtcDiscoverType",
ec);class Jb{constructor(Sa,Cb,rc,bd,pd,Oa,jb,nc,kb,Gb,tc,dd,$c,Pc,Ad,Ee){this.uRd=Sa;this.Ohd=Cb;this.Nhd=rc;this.uqb=bd;this.r2b=pd;this.PPc=Oa;this.xhb=jb;this.Wkd=nc;this.leb=kb;this.yGc=Gb;this.wGc=tc;this.VHb=dd;this.ecb=$c;this.Xpb=Pc;this.mZf=Ad;this.PSd=Ee}JXj(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",this.uRd,this.Ohd,this.Nhd,this.uqb,this.r2b,this.PPc,this.xhb,
this.Wkd,this.leb,this.yGc,this.wGc,this.VHb,this.ecb,this.Xpb,this.mZf,this.PSd)}}Object(h.a)(Jb,"RttLockSettings",null,[]);var hb=d(331);class Rc{constructor(Sa,Cb,rc,bd){this.w9b=this.v9b=null;this.Yaf=!1;this.G8j=Sa;this.Ea=Cb;this.Vh=rc;this.UW=bd;this.pAb=new Date;this.aFa=-1}get $a(){return this.G8j}get eUc(){return this.Yaf}set eUc(Sa){this.Yaf=Sa}zOi(){return 0<this.aFa&&Date.now()>=this.aFa}ilh(Sa){this.aFa=Sa}J0b(){return""}K0b(){return""}gEb(Sa){this.v9b=Sa?this.J0b():this.K0b();this.w9b=
new Date}QLd(){}SLd(){return!1}Dhh(Sa,Cb){Sa=Sa||"";Cb=Cb||"";if(Sa.length!==Cb.length)return null;const rc=[];for(let bd=0;bd<Sa.length;bd+=1)Sa.charAt(bd)!==Cb.charAt(bd)&&rc.push(bd);return 0<rc.length?bb.a.gH("Length",Sa.length,"FirstDiffPos",rc[0],"DiffCount",rc.length):null}cQa(Sa){return Z.a.replaceAll(Sa,"\u00a0"," ").trim()}}Object(h.a)(Rc,"ATextContentRecord",null,[]);var gd=d(33),hd=d(41);class Hd extends Rc{constructor(Sa,Cb,rc,bd){super(Sa,Cb,rc,bd);this.dRg=Sa.PB}get shapeNode(){return Object(oa.a)(4,
this.$a)}F6k(){this.dRg=this.shapeNode.PB}J0b(){const Sa=new n.a;var Cb=this.shapeNode.jD();for(const rc of Cb)(Cb=this.Vh.text(rc))&&0<Cb.length&&Sa.add(Cb);return Sa.toArray().join(" ")}K0b(){return this.Ea.Fba(this.shapeNode)}QLd(){try{const Sa=this.J0b()||"",Cb=this.v9b||"";if(Sa!==Cb){const rc=this.cQa(Sa)===this.cQa(Cb),bd=this.dRg||this.shapeNode.PB;if(!rc&&!bd&&!this.shapeNode.nd){const pd=bb.a.gH("Shape",this.shapeNode.jr,"Start",hd.a.Ye(this.pAb),"LastSnapshotTime",hd.a.Ye(this.w9b),"EverEdit",
this.eUc,"Type",this.getShapeType());pd.Expiration=-1<this.aFa?(+new Date(this.aFa)-+this.pAb).toString():null;const Oa=Sa.length-Cb.length;Oa?pd.TextLengthDelta=Oa:pd.SameLengthDiffDetails=this.Dhh(Sa,Cb);D.a.J(25539747,814,15,gd.c(pd))}}}catch(Sa){D.a.J(25981901,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Sa)}}SLd(){try{const Sa=this.UW.s_b(this.shapeNode);if(Sa&&0<Sa.length)return!1;const Cb=this.K0b()||"",rc=this.v9b||"";if(Cb!==rc&&0>Cb.indexOf(rc)&&!(0<=this.cQa(Cb).indexOf(this.cQa(rc))||
this.shapeNode.nd)){const bd=bb.a.gH("Shape",this.shapeNode.jr,"Start",hd.a.Ye(this.pAb),"LastSnapshotTime",hd.a.Ye(this.w9b),"TextLengthDelta",Cb.length-rc.length,"Type",this.getShapeType());D.a.J(25981903,814,15,gd.c(bd))}}catch(Sa){D.a.J(25981905,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Sa)}return!0}getShapeType(){return this.shapeNode.nd?"Table":this.shapeNode.Qf?"SmartArt":this.shapeNode.wy?"TextBox":this.shapeNode.al?"PlaceHolder":this.shapeNode.nsa?"Shape":"Unknown"}}Object(h.a)(Hd,
"ShapeContentRecord",Rc,[]);class Xd{constructor(Sa,Cb,rc,bd,pd,Oa,jb,nc,kb,Gb,tc,dd,$c){this.Gbb=this.tAb=null;this.UN={};this.fGa={};this.ra=nc;this.wI=kb;this.Mc=Sa;this.jv=Cb;this.r1j=rc;this.Tw=bd;this.ta=pd;this.Lg=Oa;this.UW=jb;this.Ea=Gb;this.sc=tc;this.hqe=dd;this.Xr=$c;this.ra.UCf(Object(m.a)(this,this.Jmk,"onPreSelectionChanged"));this.ra.XJ(Object(m.a)(this,this.sCb,"onSetSelectionFinished"));this.wI.O5h(Object(m.a)(this,this.Yok,"onTableCellViewElementLocked"));this.Mc.U2h(Object(m.a)(this,
this.fbi,"beforeProcessInboundResponse"));this.jv.RSb(Object(m.a)(this,this.lok,"onShapeViewElementOpenTextEditView"));this.jv.Qzc(Object(m.a)(this,this.fok,"onShapeViewElementCloseTextEditView"));this.jv.eDf(Object(m.a)(this,this.kok,"onShapeViewElementLocked"));this.r1j.C4h(Object(m.a)(this,this.Uok,"onSuccessfulInbound"));this.Tw.xk(Object(m.a)(this,this.xh,"onPropertyChanged"));this.Lg.WJ(Object(m.a)(this,this.iC,"onActiveSlideChanged"))}lok(Sa,Cb){Sa=Object(oa.a)(4,Object(oa.a)(hb.a,Cb.jx).$a);
Cb=this.hqe.wPd(Sa);this.UN[Sa.id.toString()]=Cb;Cb.gEb(!0)}fok(Sa,Cb){Sa=Object(oa.a)(4,Object(oa.a)(hb.a,Cb.jx).$a).id.toString();Sa in this.UN&&this.UN[Sa].ilh(Date.now()+this.Xr.uqb)}kok(Sa,Cb){Sa=Object(oa.a)(4,Object(oa.a)(hb.a,Cb.jx).$a).id.toString();Sa in this.UN&&delete this.UN[Sa]}Jmk(){this.tAb=this.KTf}sCb(){this.Gbb=this.KTf;if(!(!this.tAb&&!this.Gbb||this.tAb&&this.Gbb&&this.Gbb.id.equals(this.tAb.id))){if(this.tAb){var Sa=this.tAb.id.toString();Sa in this.UN&&this.UN[Sa].ilh(Date.now()+
this.Xr.uqb)}this.Gbb&&(Sa=this.hqe.wPd(this.Gbb),this.UN[this.Gbb.id.toString()]=Sa,Sa.gEb(!0))}}get KTf(){var Sa=this.ra.Oa;if(!Sa||!Sa.kb||Sa.kb.nl)return null;Sa=Sa.kb;return Sa.Ua.node&&Sa.Ua.node.isConnected?this.sc.cCa(Sa.Ua.node):null}Yok(Sa,Cb){Sa=Cb.tableCellNode.id.toString();Sa in this.UN&&delete this.UN[Sa]}fbi(){this.Pbh();for(const Sa of Object.keys(this.UN))this.UN[Sa].gEb(!0)}Uok(){this.Pbh();for(const Sa of Object.keys(this.UN))this.UN[Sa].QLd();for(const Sa of Object.keys(this.fGa))this.fGa[Sa].SLd()&&
delete this.fGa[Sa]}xh(Sa,Cb){if(Cb&&Cb.node&&Cb.property.id===ka.a.Zp.id){Sa=Object(oa.a)(5,Cb.node);Cb=!Cb.node.loading;const rc=this.sc.cCa(Sa);if(rc)this.nTg(rc,Cb),this.oTg(rc,Cb);else if(Sa=this.Ea.Cba(Sa))this.nTg(Sa,Cb),this.oTg(Sa,Cb)}}iC(){this.fGa={}}Pbh(){for(const Sa of Object.keys(this.UN))this.UN[Sa].zOi()&&delete this.UN[Sa]}nTg(Sa,Cb){Sa=Sa.id.toString();if(Sa in this.UN){Sa=this.UN[Sa];const rc=Object(oa.a)(Hd,Sa);rc&&rc.F6k();Sa.gEb(!0);Cb&&(Sa.eUc=!0)}}oTg(Sa,Cb){var rc=this.Ea.kn(Sa);
rc&&this.ta.Ba&&this.ta.Ba.sid===rc.get_sid()&&this.ta.Ba.cid===rc.get_cid()&&(rc=Sa.id.toString(),Cb?rc in this.fGa&&delete this.fGa[rc]:(Cb=Object(Ba.a)(125,Sa)?this.UW.f_b(Object(oa.a)(125,Sa)):this.UW.s_b(Object(oa.a)(4,Sa)))&&0<Cb.length&&(rc in this.fGa?this.fGa[rc].gEb(!1):(Sa=this.hqe.wPd(Sa),this.fGa[rc]=Sa,Sa.gEb(!1))))}}Object(h.a)(Xd,"TextContentMonitor",null,[]);class id extends Rc{constructor(Sa,Cb,rc,bd,pd){super(Sa,Cb,bd,pd);this.sc=rc}get tableCellNode(){return Object(oa.a)(125,this.$a)}J0b(){const Sa=
new n.a;this.sc.Cfc(this.tableCellNode,Cb=>{(Cb=this.Vh.text(Cb))&&0<Cb.length&&Sa.add(Cb)});return Sa.toArray().join(" ")}K0b(){const Sa=new n.a;this.sc.Cfc(this.tableCellNode,Cb=>{Cb.Sa(ka.a.Zp)&&(Cb=Cb.getValue(ka.a.Zp))&&0<Cb.length&&Sa.add(Cb)});return Sa.toArray().join(" ")}QLd(){try{const Sa=this.J0b()||"",Cb=this.v9b||"";if(Sa!==Cb&&this.cQa(Sa)!==this.cQa(Cb)){const rc=bb.a.gH("TableCellNode",this.mnh+"/"+this.tableCellNode.jr,"Start",hd.a.Ye(this.pAb),"LastSnapshotTime",hd.a.Ye(this.w9b),
"EverEdit",this.eUc);rc.Expiration=-1<this.aFa?(+new Date(this.aFa)-+this.pAb).toString():null;const bd=Sa.length-Cb.length;bd?rc.TextLengthDelta=bd:rc.SameLengthDiffDetails=this.Dhh(Sa,Cb);D.a.J(37748808,814,15,gd.c(rc))}}catch(Sa){D.a.J(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Sa)}}SLd(){try{const Sa=this.UW.f_b(this.tableCellNode);if(Sa&&0<Sa.length)return!1;const Cb=this.K0b()||"",rc=this.v9b||"";if(Cb!==rc&&0>Cb.indexOf(rc)&&!(0<=this.cQa(Cb).indexOf(this.cQa(rc)))){const bd=
bb.a.gH("TableCellNode",this.mnh+"/"+this.tableCellNode.jr,"Start",hd.a.Ye(this.pAb),"LastSnapshotTime",hd.a.Ye(this.w9b),"TextLengthDelta",Cb.length-rc.length);D.a.J(37748812,814,15,gd.c(bd))}}catch(Sa){D.a.J(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Sa)}return!0}get mnh(){const Sa=this.Ea.kn(this.tableCellNode);return Sa?Sa.jr:"UnknownShape"}}Object(h.a)(id,"TableCellContentRecord",Rc,[]);class fd{constructor(Sa,Cb,rc,bd){this.Ea=Sa;this.sc=Cb;this.Vh=rc;this.UW=bd}wPd(Sa){return Object(Ba.a)(4,
Sa)?new Hd(Object(oa.a)(4,Sa),this.Ea,this.Vh,this.UW):Object(Ba.a)(125,Sa)?new id(Object(oa.a)(125,Sa),this.Ea,this.sc,this.Vh,this.UW):null}}Object(h.a)(fd,"TextContentRecordFactory",null,[528]);var Vf=d(616);class Qd{constructor(Sa,Cb,rc,bd,pd){this.Qb=Sa;this.xka=Cb;this.ra=rc;this.wI=bd;this.Ox=pd;this.XXc=!1}initialize(){this.ra.XJ(Object(m.a)(this,this.sCb,"onSetSelectionFinished"));this.wI.V5h(Object(m.a)(this,this.a1g,"onTypingLockStatusChanged"))}dispose(){this.ra.ndh(Object(m.a)(this,this.sCb,
"onSetSelectionFinished"));this.wI.UQk(Object(m.a)(this,this.a1g,"onTypingLockStatusChanged"))}sCb(){var Sa=this.ra.ny();let Cb=null;for(const rc of Sa)if(Sa=Object(oa.a)(na.TableCellNode,rc))if(Sa=Object(oa.a)(554,Sa.Ag(this.Qb.Ma)))if(Cb=Sa.vVc)break;this.sCh(Cb)}a1g(Sa,Cb){this.sCh(Cb.uCi)}sCh(Sa=null){this.ra.L7()?this.Cil(Sa):this.XUk()}Cil(Sa=null){if(this.Qb.editingView&&this.Qb.editingView.Bl){const Cb=this.n8f();Cb&&(this.xka.xP(Cb.shapeNode).Kld(Sa),Sa&&(Cb.Pgd=!0,this.Ox.h$g(new Vf.a(Cb)),
Cb.Pgd=!1));this.XXc||D.a.J(37573824,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.Qb.editingView.disable(!1,14);this.XXc=!0}}XUk(){if(this.Qb.editingView&&this.Qb.editingView.Bl){const Sa=this.n8f();Sa&&Sa.shapeNode.nd&&(this.xka.xP(Sa.shapeNode).Kld(null),Sa.$3d());this.XXc&&D.a.J(37573826,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");this.Qb.editingView.NYa();this.XXc=!1}}n8f(){let Sa=
null;const Cb=this.ra.ae();1===Cb.length&&(Sa=Object(oa.a)(124,Cb[0].oc(this.Qb.Ma)));return Sa}}Object(h.a)(Qd,"TypingLockHandler",null,[555,106]);var Zf=d(40),Ge=d(884);class le{constructor(){this.sZc=this.gh=this.G3=this.EYc=this.ED=this.K=this.uI=null;this.X6b=0;this.m2c=null;this.cge=!1;this.TVc=null;this.fie=!1}get name(){return"Presence"}Fri(){this.K.register(E.a,"Common.PresenceUser").as("Common.IPresenceUser").ma();this.K.register(Ib,"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").ma().na(()=>
new Ib(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.cge=!0}Wb(Sa){this.X6b=(new Date).getTime();this.K!==Sa&&(this.K=Sa,this.G3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.gh=this.G3.UBa(1,this.name),this.cge=!1,this.fie=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseEarlyPresenceRefactoring);this.uI=this.K.resolve("Common.AFrameworkApplication");Sa=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.cge||this.Fri();const Cb=
Sa.zki&&Sa.FJb?!1:Sa.vg,rc=this.Xzi(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("Common.IPresenceUser"),Cb,Sa["368"]);if(Zf.a("PresenceInit.EarlyReturnOnNullRTC")){if(!rc)return;this.K.register(525,"Common.IRealtimeChannelBasic").ma().na(()=>rc);this.K.register(526,"AppRealtimeChannel.IRealtimeChannel").ma().na(()=>rc)}else if(this.K.register(525,"Common.IRealtimeChannelBasic").ma().na(()=>rc),this.K.register(526,"AppRealtimeChannel.IRealtimeChannel").ma().na(()=>rc),!this.K.pb("AppRealtimeChannel.IRealtimeChannel"))return;
this.Cri(Sa)}Cri(Sa){this.K.register(Za,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").ma().na(()=>new Za(this.K.resolve("Common.IRealtimeChannelBasic")));this.K.register(cb,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").ma().na(()=>new cb(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(Yb,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").ma().na(()=>
new Yb(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkState"),L.a.getInstance(),Sa.rtcAllowCrossDomainAccessOrigins));this.K.register(Ub,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").ma().na(()=>
new Ub(this.K.resolve("Common.IPresenceUser"),G.AFrameworkApplication.fa,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerpointPresence.RtcParams"),this.uI.KR,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerpointPresence.IPresenceEventNotifier"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),Sa,this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerpointPresence.IEditorPresenceTracker"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),
this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.La("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").NNc(),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(ob,"PowerpointPresence.PresenceCache").ma().na(()=>new ob(this.K.resolve("PowerpointPresence.IPresenceManager")));
this.K.register(Ic,"PowerpointPresence.PresencePresenter").ma().na(()=>new Ic(this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.DragInputManager"),this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),Sa.podsNewThumbnailVisibleRangeFetchExperience));this.K.register(Cc,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").ma().na(()=>new Cc(this.K.resolve("Common.IPresenceUser").clientId,Sa.e8k,this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(10),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const Cb=new Jb(Sa.pGi,Sa.Ohd,Sa.Nhd,Sa.uqb,Sa.r2b,Sa.PPc,Sa.xhb,Sa.Wkd,Sa.leb,Sa.yGc,Sa.wGc,Sa.VHb,Sa.ecb,Sa.Xpb,Sa.podsTableRTTEnabled,Sa.podsTableCellLockEnabled);this.K.register(Qd,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").ma().na(()=>new Qd(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));this.K.register(Ha,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").ma().na(()=>new Ha(ea.App.Eh,this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.IPresenceUser").clientId,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.ContentEditableViewEventSource"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(12),Sa,Cb,this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerpointPresence.ITypingLockHandler"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma,this.K.resolve("Box4.Graph.IGraphInstance").Bd(16),I.a.vu(H.a.instance.La("Common.ISystemInitiatedFeedback"))));this.K.register(527,"PowerpointPresence.IPresencePawnFactory").ma().na(()=>new gb);
this.K.register(528,"PowerpointPresence.ITextContentRecordFactory").ma().na(()=>new fd(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler")));this.K.register(Xd,"PowerpointPresence.TextContentMonitor").ma().na(()=>new Xd(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
ia.a.instance,this.K.resolve("Box4.Graph.IGraphInstance").Bd(12),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerpointPresence.ITextContentRecordFactory"),
Cb));this.K.register(u,"Common.App.Presence.AwayManager").ma().na(()=>this.Hvi(this.K.resolve("Common.IPresenceUser"),this.K.resolve("Common.IRealtimeChannelBasic"),this.K.resolve("Common.IPresenceRemover"),this.K.resolve("Common.IPresenceConverter"),Sa.ka("PeoplesWellExtraButtonInfoIsEnabled")));this.K.register(529,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").ma().na(()=>new Wc(this.K.resolve("AppRealtimeChannel.IRealtimeChannel")));this.SHc().qfb("RTCConfigured")}B$i(Sa){let Cb;var rc=
Sa;Cb=0;if(Sa=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Raj())return rc=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Egd(),{HFe:Sa,FFe:Cb,gUd:rc};Cb=1;return(Sa=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Jgh)?(rc=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Egd,{HFe:Sa,FFe:Cb,gUd:rc}):{HFe:rc,FFe:2,gUd:!0}}Wzi(){const Sa=1E3*this.K.resolve("PowerPointWebEditor.IApplicationSettings").rtcDiscoveryTimeoutSeconds;0<Sa&&(this.m2c=new A.a(2,
1,Sa,()=>{this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").E1f=!0;this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").kdh(Object(m.a)(this,this.Sve,"onPopsRtcEndpointUrlReady"));this.K.pb("AppRealtimeChannel.IRealtimeChannel")||(this.Wb(H.a.instance),this.init())},90,"111"),this.K.resolve("Common.ITaskManager").Gb(this.m2c))}Xzi(Sa,Cb,rc,bd){D.a.J(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",rc);Cb.clientId=Sa.clientId;var pd=null;Cb=null;const Oa=
L.a.getInstance();if(rc){Cb=bd+"rtc2";({HFe:Cb,FFe:rc,gUd:bd}=this.B$i(Cb));pd=!this.K.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone;const jb=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").E1f,nc=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Evg;D.a.J(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fUseFallback:{3} fPopsRtcConfigured:{4}",ec[rc],pd,bd,jb,nc);if(2===rc&&!jb)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").P4h(Object(m.a)(this,
this.Sve,"onPopsRtcEndpointUrlReady")),this.Wzi(),null;if(!bd&&!pd)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").eGd(Object(m.a)(this,this.ZBb,"onCoauthStatusChanged")),null;pd=this.Bvi(Sa,Cb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Oa)}return K.RealtimeChannel.createInstance(Sa.clientId,Sa.userSessionId,Sa.Vdd,Sa.Maa,Sa.Mjh,3,Sa.lw,Cb,pd,Oa)}Hvi(Sa,Cb,rc,bd,pd){const Oa=new M.a;Oa.Bg(rc);rc=new M.a;rc.Bg(Cb);return new u(Sa,rc.task,Oa.task,bd,this.K.resolve("Common.ITaskManager"),
this.uI.KR.kd.gJd?6E4:this.uI.KR.kd.awayCoauthorThresholdMs,Object(m.a)(this.uI.KR.mK(),this.uI.KR.mK().processAction,"processAction"),ja.App.B2a.notificationBar,pd)}init(){const Sa=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Sa.Rh(21,le.O$b);Sa.Rh(22,this.X6b);Sa.Rh(24,(new Date).getTime());this.K.resolve("PowerPointWebEditor.PresentationContext").isValid?this.SHc().qfb("PresentationId"):this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").SCf(Object(m.a)(this,this.qdc,"onPresentationIdReady"));
this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Ytb(()=>{this.SHc().qfb("B2IFinished")})}qdc(){this.SHc().qfb("PresentationId");this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").ldh(Object(m.a)(this,this.qdc,"onPresentationIdReady"))}Sve(){this.m2c&&this.K.resolve("Common.ITaskManager").Qg(this.m2c);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").kdh(Object(m.a)(this,this.Sve,"onPopsRtcEndpointUrlReady"));this.K.pb("AppRealtimeChannel.IRealtimeChannel")||
(this.Wb(H.a.instance),this.init())}ZBb(Sa,Cb){2!==Cb.yUg||this.K.pb("AppRealtimeChannel.IRealtimeChannel")||(this.Wb(H.a.instance),this.init());this.K.pb("AppRealtimeChannel.IRealtimeChannel")&&this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").GDe(Object(m.a)(this,this.ZBb,"onCoauthStatusChanged"))}SHc(){this.sZc||(this.sZc=new Ge.a(Object(m.a)(this,this.Ftb,"initInternal"),["PresentationId","B2IFinished","RTCConfigured"]));return this.sZc}Ftb(){this.K.resolve("PowerpointPresence.IPresencePerfLogger").Rh(4,
this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").WBe);this.K.resolve("PowerpointPresence.IPresencePerfLogger").Rh(23,(new Date).getTime());this.bxj();this.Uxj();this.sZc=null}Uxj(){try{let Sa="";this.K.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");Sa=this.gh.Zt("presencemanager");this.Vxj();this.gh.gu(Sa);this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").iTc=!0;D.a.J(8958608,814,50,"PresencePackage::Init; Presence downloaded");ea.App.INd&&(Sa=this.gh.Zt("contentnotification"),
Qb.init(),this.gh.gu(Sa));Sa=this.gh.Zt("resolve");this.K.resolve("PowerpointPresence.IPresencePerfLogger").XLi();this.ED=this.K.resolve("PowerpointPresence.IPresenceManager");this.K.resolve("Common.IPresenceConverter");this.K.resolve("Common.IRealtimeChannelBasic");this.uI.KR.kd.DNi&&(D.a.J(512360600,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.uI.KR.mK().processAction(w.a.P3a,2));this.K.resolve("PowerPointWebEditor.IWetChangeHandler");this.K.resolve("Common.Interface.IRtcBasicProvider");
this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.K.resolve("PowerpointPresence.PresencePresenter");this.K.resolve("PowerpointPresence.IPresencePawnFactory");this.K.resolve("Common.App.Presence.AwayManager");this.uI.KR.kd.hermesMonitorShapeContentChangeEnabled&&this.K.resolve("PowerpointPresence.TextContentMonitor");this.gh.gu(Sa);this.K.resolve("PowerpointPresence.IPresencePerfLogger").ILi();this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").$Wj()}catch(Sa){D.a.J(512360599,
814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Sa)}}dispose(){this.ED?this.ED.disconnect():D.a.J(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.K.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}Vxj(){this.K.resolve("PowerpointPresence.PresenceManager").ub();D.a.J(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}Bvi(Sa,Cb,rc,bd){let pd=Cb;pd=pd.endsWith("/")?pd+"findsession":
pd+"/findsession";D.a.J(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",pd,Sa.Maa.dfa);Cb=()=>T.FindSessionStrategy.Mxi(Sa.userSessionId,Sa.Maa,pd,Sa.lw,G.AFrameworkApplication.buildVersion,Sa.clientId,le.IVi(G.AFrameworkApplication.buildVersion),bd,Sa.Mjh,()=>{if(G.AFrameworkApplication.Zg)return G.AFrameworkApplication.Zg;const jb=this.K.resolve("PowerPointWebEditor.PresentationContext").presentationId.string;jb||D.a.J(512360595,814,15,
"CreateAssignRtcMachineStrategy - returning a null query string");return jb},this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Paj());const Oa=!!this.EYc;return this.fie||Oa?this.TVc=new La(this.EYc,Cb,rc,bd,this.K.resolve("PowerpointPresence.IPresencePerfLogger")):Cb()}bxj(){var Sa;if(Sa=this.K.resolve("PowerPointWebEditor.IApplicationSettings").presenceEarlyFindSessionEnabled?this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").getFindSessionResponse():this.K.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").pVd)Sa=
aa.RtcUtils.deserialize(Sa,"PresencePackage","Deserialize existing FindSession response",!0),this.k9c(Sa)}k9c(Sa){if(Sa)try{this.EYc=Object.assign(new P.a,{A4b:Sa[Q.a.$ub],errorMessage:Sa[Q.a.errorMessage],KVb:Sa[Q.a.mMe],v4:Sa[Q.a.v4],nA:Sa[Q.a.nA],ZNc:Sa[Q.a.h2d],N4c:Sa[Q.a.fcb],O4c:Sa[Q.a.hJa],R4c:Sa[Q.a.hcb]}),this.fie&&this.TVc&&(this.TVc.findSessionResponse=this.EYc)}catch(Cb){D.a.J(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",Cb)}}static main(){le.O$b=(new Date).getTime();
const Sa=new le;G.AFrameworkApplication.fa&&G.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")?(Sa.Wb(H.a.instance),Sa.K.pb("AppRealtimeChannel.IRealtimeChannel")&&Sa.init()):C.a.instance.Ac(Sa)}static IVi(Sa){return String.format("{0}, {1}, {2}",le.HLf(Y.a[3]),le.HLf("browser"),Sa)}static HLf(Sa){return Sa?Sa.charAt(0).toLocaleUpperCase()+Sa.substring(1,Sa.length):Sa}}le.O$b=0;Object(h.a)(le,"PresencePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerpointPresence");
window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");le.main()},184:function(J,V,d){d.r(V);d.d(V,"RtcUtils",function(){return n});J=d(0);var h=d(375),e=d(329),m=d(33);class n{static HLd(v,A=e.RealtimeChannel.Bre){let w;try{w=m.c(v)}catch(y){throw v=String.format("Failed to JSON-serialize payload : {0}",y),h.ULS.sendTraceTag(18637072,500,10,v),Error.argument("payload",v);}if(w.length>A)throw v=String.format("Payload exceeds maximum length: {0} > {1}.",
w.length,A),h.ULS.sendTraceTag(18637074,500,10,v),Error.argument("payload",v);return w}static deserialize(v,A,w){if(!v)return null;if(Object.getType(v)!==String){var y=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",A,Object.getType(v).getName(),w);h.ULS.sendTraceTag(18637075,500,10,y);return null}y=null;try{y=m.a(v)}catch(u){v=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
A,u,w),h.ULS.sendTraceTag(18637077,500,10,v)}return y}static PBb(v){if(!v)return"";if("string"===typeof v)return v.toString();try{return m.c(v)}catch(A){return v.toString()}}static Y0f(v){let A,w,y;A=0;y=w=null;if(!v)return{y4d:A,z4d:w,Ui:y};try{const u=v.source;u&&Object.getType(u)===String&&(y=u);const E=v.context;E&&(v=E,A=v.status?v.status:0,w=v.statusText?v.statusText:null)}catch(u){}return{y4d:A,z4d:w,Ui:y}}}Object(J.a)(n,"RtcUtils",null,[])},227:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);d=d(77);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&
this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}lx(){return!0}static ypb(e,m){return e+(m?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[106,492])},228:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.type=e;this.Ti=m}}h.Qo="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,
[])},300:function(J,V,d){d.r(V);J=d(0);var h=d(375),e=d(13),m=d(101),n;(function(y){y[y.SendNotification=0]="SendNotification";y[y.SendPersistentState=1]="SendPersistentState";y[y.FindSession=2]="FindSession";y[y.Last=3]="Last"})(n||(n={}));Object(J.b)("ApiType",n);var v;(function(y){y[y.AttemptCount=0]="AttemptCount";y[y.SuccessCount=1]="SuccessCount";y[y.DropCount=2]="DropCount";y[y.FailedCount=3]="FailedCount";y[y.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";y[y.LatencyUnderThresholdCount=
5]="LatencyUnderThresholdCount";y[y.ThrottledCount=6]="ThrottledCount";y[y.Last=7]="Last"})(v||(v={}));Object(J.b)("EventCountType",v);var A=d(679);d.d(V,"FrequentLoggingMetrics",function(){return w});class w{constructor(y){this.EPf=this.a3f=null;this.jSg=this.p5f=0;this.ft=null;this.Ycf=this.Kwd=0;this.Ei=y;this.Hxj();this.Nrd=this.g2e=this.bxd=!1;this.Ewd=0}get FNi(){return this.Nrd}Egl(y){this.Ycf=y;window.setInterval(Object(e.a)(this,this.nce,"logMetricsBatchAndReset"),y);this.Kwd=(new Date).getTime()}tG(y,
u){this.q8k(y)&&!this.g2e||this.FNi||!window.navigator.onLine||this.Ei.eDa||(this.ft[y][u]++,this.bxd=!0)}Hxj(){this.ft=Array(3);for(let y=0;3>y;y++){this.ft[y]=Array(7);for(let u=0;7>u;u++)this.ft[y][u]=0}}hei(){const y={};for(let u=0;3>u;u++)for(let E=0;7>E;E++)this.LPj(u,E)&&(y[n[u]+v[E]]=this.ft[u][E]);y.FSDomain=this.a3f;y.ConnectionDomain=this.EPf;y.FSRetryInterval=this.p5f;y.MaxPayloadSize=this.jSg;y.LogNumber=this.Ewd;1===this.Ewd&&(y.FSLatencies=A.a.instance.Y2i(),y.ConLatencies=A.a.instance.s_i());
return y}LPj(y,u){return 2===y&&3!==u&&0!==u?!1:!0}q8k(y){return 2===y?!1:!0}nce(){if(this.bxd){this.Ewd++;if((new Date).getTime()-this.Kwd<5E3+this.Ycf){var y=m.a.toJSON(this.hei());h.ULS.sendTraceTag(50644352,500,15,y)}this.Kwd=(new Date).getTime();for(y=0;3>y;y++)for(let u=0;7>u;u++)this.ft[y][u]=0;this.bxd=!1}}Hak(){this.g2e=!0}static get instance(){return w.Ja}static create(y){w.instance||(w.Ja=new w(y));return w.instance}}w.Ja=null;Object(J.a)(w,"FrequentLoggingMetrics",null,[577])},329:function(J,
V,d){d.r(V);J=d(0);var h=d(375),e=d(13),m=d(1021),n=d(952),v=d(66),A=d(25);class w{constructor(Fa,Ca){this.status=Fa;this.Vvb=Ca}}Object(J.a)(w,"UserStatusInfo",null,[]);var y=d(80),u=d(679);class E{constructor(Fa,Ca){this.data=Fa;this.timeStamp=Ca}}Object(J.a)(E,"PresenceData",null,[]);class G{constructor(Fa){this.Voa=!1;this.imb=0;this.Vpd=!1;this.setTimeout=G.CQd;this.clearTimeout=G.sQd;this.hYj=Object(e.a)(this,this.uXj,"logRtcConnectingUsageStatement");this.Gr=Fa}Aik(){this.Voa||(this.imb=this.setTimeout(()=>
{this.Voa=!1;this.kBg()},8E3),this.Voa=!0,this.Vpd=!1)}jjk(){this.BM()}Tok(){this.kBg()}kBg(){this.BM();this.Vpd||(this.Vpd=!0,this.hYj())}uXj(){h.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Gr)}BM(){this.Voa&&this.clearTimeout(this.imb);this.imb=0;this.Voa=!1}static CQd(Fa,Ca){return window.setTimeout(Fa,Ca)}static sQd(Fa){window.clearTimeout(Fa)}}Object(J.a)(G,"ConnectedUsageKpiLogger",null,[718]);class I{constructor(){this.Nbd=this.pCe;this.sCe=
this.tCe;this.Obd=this.rCe;this.mhc=this.vCe;this.gah=this.uCe;this.CCe=this.DCe;this.zCe=this.ACe;this.Ydb=this.xCe;this.ohc=this.yCe;this.bah=this.qCe;this.yBb=this.Rse;this.rcc=this.Sse}pCe(){}tCe(){}rCe(){}vCe(){}uCe(){}ACe(){}yCe(){}xCe(){}DCe(){}qCe(){}Rse(){}Sse(){}}Object(J.a)(I,"NoopRealtimeChannelMetrics",null,[622,248]);class H{}H.Chb="presenceUpdated";H.updateNotification="updateNotification";H.h4g="persistentStateCleared";H.updatePersistentState="persistentStateUpdated";Object(J.a)(H,
"RtcClientMethodNames",null,[]);class K{}K.Ysj="realtimeChannelHub";K.Chb="UpdatePresence";K.rea="SendUpdateNotification";K.PXd="GetCompletePersistentStateWithMetadata";K.updatePersistentState="UpdatePersistentState";K.Ahb="UpdateClientInfo";Object(J.a)(K,"RtcHubMethodNames",null,[]);class C{constructor(Fa){this.iz=Fa}XLk(Fa){this.iz.on(H.Chb,Fa)}uMk(Fa){this.iz.on(H.updateNotification,Fa)}ULk(Fa){this.iz.on(H.updatePersistentState,Fa)}TLk(Fa){this.iz.on(H.h4g,Fa)}nsl(Fa){this.iz.off(H.Chb,Fa)}rsl(Fa){this.iz.off(H.updateNotification,
Fa)}msl(Fa){this.iz.off(H.updatePersistentState,Fa)}lsl(Fa){this.iz.off(H.h4g,Fa)}Chb(Fa){return this.iz.invoke(K.Chb,Fa)}Ahb(Fa){return this.iz.invoke(K.Ahb,Fa)}rea(Fa,Ca){return this.iz.invoke(K.rea,Fa,Ca)}PXd(Fa){return this.iz.invoke(K.PXd,Fa)}updatePersistentState(Fa,Ca){return this.iz.invoke(K.updatePersistentState,Fa,Ca)}}Object(J.a)(C,"RealtimeChannelProxy",null,[715,716,717]);class Y{constructor(){this.Bib=this.tWe=!1;this.Aib=0;this.Epd=this.JBd=this.IBd=this.dod=!1;this.$rd=0;this.Esf=
!1;this.Dsf=this.Csf=0;this.JAd=!1;this.NAd=this.LAd=this.OAd=this.KAd=0;this.MAd=!1}get gJd(){return this.Bib}get awayCoauthorThresholdMs(){return this.Aib}get J7h(){return this.dod}get y9k(){return this.IBd}get z9k(){return this.JBd}get tni(){return this.Epd}get hZb(){return this.$rd}get ZVk(){return this.Esf}get Kgh(){return this.Csf}get YVk(){return this.Dsf}get TVk(){return this.JAd}get UVk(){return this.KAd}get Ogh(){return this.OAd}get Lgh(){return this.LAd}get Ngh(){return this.NAd}get Mgh(){return this.MAd}static createInstance(Fa){const {RealtimeChannel:Ca}=
d(329);return Fa?Object.assign(new Y,{tWe:Fa.ka("AwayStatusManagerIsEnabled"),Bib:Fa.ka("AwayStatusOneMinuteTimeoutIsEnabled"),Aib:Fa.Ec("AwayCoauthorThresholdMs",9E5),dod:Fa.ka("RtcAllowCrossDomainAccessEnabled"),IBd:Fa.ka("ShouldLogOnContentNotification"),JBd:Fa.ka("ShouldLogOnHostSubscriptionNotification"),Epd:Fa.ka("RtcClientMetricsEnabled"),$rd:Fa.Ec("RtcFindSessionRequestTimeoutInMS",6E4),Esf:Fa.ka("RtcJsClientFrequentlyLogsMetrics"),Csf:Fa.Ec("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),Dsf:Fa.Ec("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),JAd:Fa.ka("RtcClientMessageTelemetryEnabled"),KAd:Fa.Ec("RtcClientMessageTelemetrySampleSize",5),OAd:Fa.Ec("RtcSendTelemetryMessageIntervalInMS",3E5),LAd:Fa.Ec("RtcLogClientMessageMetricsTimeOutInMs",2E4),NAd:Fa.Ec("RtcMaxPayloadSizeInCharactersOverride",Ca.Bre),MAd:Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new Y,{tWe:!1,Bib:!1,Aib:9E5,dod:!1,IBd:!1,JBd:!0,Epd:!1,$rd:9E4,
JAd:!1,KAd:5,OAd:3E5,LAd:2E4,NAd:Ca.Bre,MAd:!1})}}Object(J.a)(Y,"RealtimeChannelSettings",null,[714]);var M=d(684),P=d(1158),T=d(161);class L{constructor(Fa){this.ARb=null;this.Wva=0;this.d5a=!1;this.Vk=Fa;this.Vk.M2a(Object(e.a)(this,this.rla,"onConnectionStateChanged"))}rla(Fa,Ca){this.Wva=Ca.newState}jpk(){h.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.Vk.Bbd()}xwj(Fa){this.ARb.init(Fa)}}Object(J.a)(L,"ARtcMessageHandler",null,[]);var aa=d(981);
class Q{constructor(){this.Presence=null;this.TimeStamp=0}}Object(J.a)(Q,"PresenceDataEntryForClients",null,[]);var ea=d(101);class ia{constructor(Fa,Ca=""){this.jUh=Fa;this.tya=Ca}send(){return this.jUh()}get messageId(){return this.tya}}Object(J.a)(ia,"MessageHandler",null,[741]);var ja=d(711);class D extends Sys.EventArgs{constructor(Fa,Ca,La,nb){super();this.tEe=Fa;this.reconnectDelay=Ca;this.reason=La;this.cHe=nb}}Object(J.a)(D,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var pa=d(956);
class Z{constructor(){this.rCd=this.Bj=null}get Dq(){return this.Bj?this.rCd?this.rCd.getTime()-this.Bj.getTime():(new Date).getTime()-this.Bj.getTime():0}start(){this.Bj=new Date}stop(){this.rCd=new Date}}Object(J.a)(Z,"SimpleStopwatch",null,[]);var oa=d(957),Ba;(function(Fa){Fa[Fa.contentUpdate=0]="contentUpdate";Fa[Fa.editorsTableUpdate=1]="editorsTableUpdate";Fa[Fa.fileNameUpdate=2]="fileNameUpdate";Fa[Fa.wetContentUpdate=3]="wetContentUpdate";Fa[Fa.persistedContentUpdate=4]="persistedContentUpdate";
Fa[Fa.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";Fa[Fa.replicationTelemetry=6]="replicationTelemetry";Fa[Fa.lockUpdate=7]="lockUpdate";Fa[Fa.collabServiceContentUpdate=8]="collabServiceContentUpdate";Fa[Fa.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";Fa[Fa.saveTargetUpdate=10]="saveTargetUpdate";Fa[Fa.uploadToOcsUpdate=11]="uploadToOcsUpdate";Fa[Fa.labelUpdate=12]="labelUpdate";Fa[Fa.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";Fa[Fa.subscribeOrExtend=
14]="subscribeOrExtend";Fa[Fa.elapsedBootTelemetry=15]="elapsedBootTelemetry";Fa[Fa.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";Fa[Fa.clientToClientResponseMessage=17]="clientToClientResponseMessage";Fa[Fa.verifyNotificationPipeline=18]="verifyNotificationPipeline";Fa[Fa.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";Fa[Fa.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";Fa[Fa.last=21]="last"})(Ba||(Ba={}));Object(J.b)("UpdateNotificationType",Ba);var Ma=d(906),
za=d(904),ka=d(905);class qa extends L{constructor(Fa,Ca,La,nb,Nb,Rb,Ya,Qb,bb,Bb){super(Ya);this.iz=null;this.Rcf=!1;this.tya=0;this.azd=new T.a;this.aPh=qa.C_i();this.Gyd=A.AFrameworkApplication.fa.Ha("OwningFeatureCrewForRtcNotificationKpis");this.Gc=Fa;this.Sef=this.Ref=0;this.ARb=Ca;this.ARb.Rzc(Object(e.a)(this,this.jpk,"onTooManyUndeliveredMessages"));this._clientId=La;this.MSh=Nb;this.Vk.Z4h(Object(e.a)(this,this.fnk,"onRefreshProxyRequired"));this.Vk.X4h(Object(e.a)(this,this.dnk,"onRefreshAllPersistentStateRequest"));
this.Vk.k5h(Object(e.a)(this,this.rea,"sendUpdateNotification"));this.Vk.Z2h(Object(e.a)(this,this.Zkk,"onInternalPresenceUpdated"));this.Vk.$2h(Object(e.a)(this,this.$kk,"onInternalUpdateNotificationReceived"));this.Vk.Y2h(Object(e.a)(this,this.Ykk,"onInternalPersistentStateUpdated"));this.Vk.X2h(Object(e.a)(this,this.Xkk,"onInternalPersistentStateCleared"));this.Vk.j5h(Object(e.a)(this,this.nHe,"sendPersistentState"));this.Vk.b6h(Object(e.a)(this,this.Ahb,"updateClientInfo"));this.Qh=Rb;this.Gr=
nb;this.ft=Qb;this.jM=bb;this.POb=Bb;this.rib=Object(P.a)(String,A.AFrameworkApplication.Yc.Application)||""}fnk(Fa,Ca){this.iz=this.MSh(Ca.hubConnection);this.ARb.reset();this.iz.XLk(Object(e.a)(this,this.pdc,"onPresenceUpdated"));this.iz.ULk(Object(e.a)(this,this.T7c,"onPersistentStateUpdated"));this.iz.TLk(Object(e.a)(this,this.Ove,"onPersistentStateCleared"));this.iz.uMk(Object(e.a)(this,this.Ldc,"onUpdateNotificationReceived"))}rla(Fa,Ca){this.Wva=Ca.newState;2===Ca.newState&&this.UZk()}UZk(){for(let Fa of this.azd)this.rea(null,
new pa.a(Fa.key,Fa.value,!1,new m.a));this.azd=new T.a}dnk(Fa,Ca){Ca.aMd();for(Fa=0;3>Fa;++Fa)this.HZk(Fa,Ca)}HZk(Fa,Ca){try{this.iz.PXd(Fa).done(La=>{Ca.LJb(Ca.rNd,"GetCompletePresenceSuccess")&&(Ca.lsi.Tok(),h.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",this.Gr),this.Vk.HFk(),this.Bmk(Fa,La),this.Vk.KEk(La),Ca.E0f.Jb(Fa)&&this.Vk.a$g(Fa,Ca.E0f.ga(Fa),new m.a))}).fail(La=>{const {RtcUtils:nb}=d(184);Ca.LJb(Ca.rNd,"GetCompletePresenceFail")&&(h.ULS.sendTraceTag(3249541,
500,15,"Failed to retrieve complete session state : {0} for [{1}]",nb.PBb(La),this.Gr),this.Vk.Bbd())}).always(()=>{Ca.Wx&&Ca.Wx.stop()})}catch(La){h.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",Ca.rNd,La.message)}}nHe(Fa,Ca){var {RtcUtils:La}=d(184);Fa=Ca.presence;let nb;const Nb=Ca.WIa;this.jM.tG(1,0);try{nb=La.HLd(Fa,this.POb)}catch(Ya){this.jM.tG(1,
3);h.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",Ya.message);Nb.setException(Ya);return}La=new v.a;La.$(this._clientId,Object.assign(new Q,{Presence:Fa,TimeStamp:(new Date).getTime()}));this.Vk.x$g(Ca.type,La);if(2!==this.Wva)this.ft.Ydb(),this.jM.tG(1,2),Nb.Bg(null);else{var Rb=this.tya.toString();++this.tya;Fa=new ia(()=>this.WZk(Ca.type,nb,Rb),Rb);Fa=this.awh(0,Ca.type).add(Fa);Fa.B7c(Ya=>{2===Ya&&this.jM.tG(1,6);Nb.Bg(null)});
Fa.A7c(()=>{})}}WZk(Fa,Ca,La){let nb=null;const Nb=new Z,Rb=new ja.a;h.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Gr);if(2!==this.Wva)return this.ft.Ydb(),this.jM.tG(1,2),h.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.Gr),Rb.sre(),Rb;this.Qh&&20>this.Ref&&(nb=this.Qh.wi("WebServiceCall","Send Presence Message"),this.Ref++);Nb.start();Rb.Bbc(1);try{this.iz.updatePersistentState(Fa,Ca).done(()=>{this.ft.zCe();this.jM.tG(1,
1);h.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",La,this.Gr);Rb.AVa(1);Nb&&(Nb.stop(),Nb.Dq>this.Gc.Kgh?this.jM.tG(1,4):this.jM.tG(1,5))}).fail(Ya=>{const {RtcUtils:Qb}=d(184);this.d5a||(this.ft.Ydb(),this.jM.tG(1,3),h.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",La,Qb.PBb(Ya),this.Gr));Rb.AVa(2)}).always(()=>{nb&&nb.stop()})}catch(Ya){h.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",
Ya.message),this.jM.tG(1,3),Rb.AVa(2)}return Rb}Ahb(Fa,Ca){({RtcUtils:Fa}=d(184));const La=Ca.sni,nb=Ca.WIa;let Nb;try{Nb=Fa.HLd(La,this.POb)}catch(Rb){h.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",Rb.message);nb.setException(Rb);return}try{this.iz.Ahb(Nb).done(()=>{h.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(Rb=>{const {RtcUtils:Ya}=d(184);this.d5a||h.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",
Ya.PBb(Rb));nb.Bg(null)})}catch(Rb){h.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",Rb.message),nb.Bg(null)}}rea(Fa,Ca){({RtcUtils:Fa}=d(184));const La=Ca.type,nb=Ca.nxa,Nb=Ca.rEi,Rb=Ca.WIa;let Ya;this.jM.tG(0,0);try{Ya=Fa.HLd(nb,this.POb)}catch(bb){this.jM.tG(0,3);h.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",bb.message);Rb.setException(bb);return}if(2!==this.Wva)Nb?this.azd.$(La,
nb):(this.ft.Ydb(),this.jM.tG(0,2)),Rb.Bg(null);else{var Qb=this.tya.toString();++this.tya;Ca=new ia(()=>this.s_k(La,Ya,Qb),Qb);Ca=this.awh(1,La).add(Ca);Ca.B7c(bb=>{2===bb&&this.jM.tG(0,6);Rb.Bg(null)});Ca.A7c(()=>{})}}s_k(Fa,Ca,La){let nb=null;const Nb=new Z,Rb=new ja.a;h.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Gr);if(2!==this.Wva)return this.ft.Ydb(),this.jM.tG(0,2),h.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",
this.Gr),Rb.sre(),Rb;this.Qh&&3===Fa&&20>this.Sef&&(nb=this.Qh.wi("WebServiceCall","Send WetContent Update"),this.Sef++);Nb.start();Rb.Bbc(1);this.iz.rea(Fa,Ca).done(()=>{this.ft.zCe();this.jM.tG(0,1);h.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",La,this.Gr);Rb.AVa(1);Nb&&(Nb.stop(),Nb.Dq>this.Gc.Kgh?this.jM.tG(0,4):this.jM.tG(0,5))}).fail(Ya=>{const {RtcUtils:Qb}=d(184);this.d5a||(this.ft.Ydb(),this.jM.tG(0,3),h.ULS.sendTraceTag(3249507,500,
15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",La,Qb.PBb(Ya),this.Gr));Rb.AVa(2)}).always(()=>{nb&&nb.stop()});return Rb}mxa(){this.iz.nsl(Object(e.a)(this,this.pdc,"onPresenceUpdated"));this.iz.msl(Object(e.a)(this,this.T7c,"onPersistentStateUpdated"));this.iz.lsl(Object(e.a)(this,this.Ove,"onPersistentStateCleared"));this.iz.rsl(Object(e.a)(this,this.Ldc,"onUpdateNotificationReceived"))}Zkk(Fa,Ca){this.pdc(Ca.yJb,Ca.VWf)}pdc(Fa){this.ft.ohc();this.T7c(0,Fa)}Ykk(Fa,
Ca){this.T7c(Ca.type,Ca.yJb)}Bmk(Fa,Ca){const La={};for(let nb in Ca)La[nb]=Ca[nb].Presence;this.XZg(Fa,La,Ca)}T7c(Fa,Ca){this.ft.ohc();this.XZg(Fa,Ca)}XZg(Fa,Ca,La=null){var {RtcUtils:nb}=d(184);if(h.ULS.rwa(500,100))for(var Nb in Ca);delete Ca[this._clientId];if(!ea.a.isEmpty(Ca)){for(var Rb in Ca)Nb=Rb,Ca[Nb]=nb.deserialize(Ca[Rb],"Presence",Nb,!1,this.POb);nb=new v.a;Rb=(new Date).getTime();for(let Ya in Ca){Nb=Ca[Ya];let Qb=Ya,bb;La?(bb=La[Qb],bb.Presence=Nb):bb=Object.assign(new Q,{Presence:Nb,
TimeStamp:Rb});nb.$(Qb,bb)}this.Vk.x$g(Fa,nb);switch(Fa){case 0:this.Rcf||(h.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Gr),this.Rcf=!0,A.AFrameworkApplication.Pg&&A.AFrameworkApplication.Pg.Dak());this.Vk.R9g(Ca,[]);break;default:this.Vk.vFk(Fa,Ca)}}}Xkk(Fa,Ca){this.Ove(Ca.pMd)}Ove(Fa){this.ft.ohc();if(h.ULS.rwa(500,100))for(let Ca=0;Ca<Fa.length;++Ca);Fa.length&&(this.Vk.MGk(Fa),this.Vk.uFk(Fa),this.Vk.R9g({},Fa))}$kk(Fa,Ca){this.Ldc(Ca.type,Ca.nxa)}Ldc(Fa,
Ca=null){this.Gc.y9k&&0===Fa&&h.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===Fa&&this.Gyd&&0<this.Gyd.length){var La=Object.assign(new Ma.a,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.Gyd,vetoPillar:"RealTimeCoauth"});(La=aa.a.getInstance(La))&&La.logKpiUsage(this.aPh)}this.Gc.z9k&&13===Fa&&h.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",
Ca||"<none>"));this.ft.ohc();5===Fa?(Ca=(Fa=this.stk(Ca))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",Fa.reason,Fa.reconnectDelay):"Received client reconnection request from the server without params.",h.ULS.sendTraceTag(18637071,500,50,Ca),this.Vk.Bbd(Fa)):(Ca=d(184).RtcUtils.deserialize(Ca,String.format("UpdateNotification-{0}",Ba[Fa]),null,!1,this.POb),this.Vk.LGk(Fa,Ca))}stk(Fa){try{if(!Fa||""===Fa)return null;const Ca=JSON.parse(Fa);return new D(Ca[oa.a.IFe],
Ca[oa.a.SVk],Ca[oa.a.WVk],Ca[oa.a.cHe])}catch(Ca){return h.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",Ca.message),null}}awh(Fa,Ca){return this.ARb.yfj(this.zfj(Fa,Ca))}zfj(Fa,Ca){return Fa+","+Ca}static C_i(){var Fa=new Map;Fa.set("SkipAria","True");Fa=Object.assign(new za.a,{extendedProperties:Fa});return Object.assign(new ka.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:Fa,blockFutureEmissionDurationInMs:3E5})}}Object(J.a)(qa,"RtcMessageHandler",
L,[]);class Ja{oSf(Fa,Ca=""){const {MaxOutstandingThrottler:La}=d(953);return La.createInstance(Fa,Ca)}lyi(Fa,Ca=""){const {MaxRateThrottler:La}=d(955);return La.createInstance(Fa,Ca)}}Object(J.a)(Ja,"ThrottlerFactory",null,[713]);var xa=d(77),Ga=d(680);class na{constructor(Fa){this.Gc=null;this.MO=!1;this.Pa=new xa.a;this.Xwd=new v.a;this.Vwd=new v.a;this.rDd=Fa;this.Pjb=this.rDd.oSf(Ca=>Ca.send(),"GlobalMaxOustandingThrottler");this.Pjb.Rzc(()=>{this.Pa.raiseEvent("TMUDM")})}init(Fa){this.MO||(this.Gc=
Fa,this.Pjb.init(this.Gc.hJa,this.Gc.sij),this.MO=!0)}yfj(Fa){var {MaxRateThrottler:Ca}=d(955),{MaxOutstandingThrottler:La}=d(953);this.MO||this.init(new Ga.a(Ca.tUf,La.KUf,La.zUf,na.Ibk));({value:Ca}=this.Xwd.Of(Fa)).returnValue||(({value:Ca}=this.Vwd.Of(Fa)).returnValue||(Ca="MaxOutstandingThrottler-"+Fa,Ca=this.rDd.oSf(Object(e.a)(this.Pjb,this.Pjb.add,"add"),Ca),Ca.init(this.Gc.hJa,this.Gc.Hbk),Ca.Rzc(()=>{this.Pa.raiseEvent("TMUDM")}),this.Vwd.add(Fa,Ca)),La="MaxRateThrottler-"+Fa,Ca=this.rDd.lyi(Object(e.a)(Ca,
Ca.add,"add"),La),Ca.init(this.Gc.Eck),this.Xwd.add(Fa,Ca));return Ca}reset(){for(let Fa of this.Xwd)Fa.value.BCe();for(let Fa of this.Vwd)Fa.value.BCe(),Fa.value.reset();this.Pjb.BCe();this.Pjb.reset()}Rzc(Fa){this.Pa.addHandler("TMUDM",Fa)}}na.Ibk=1E3;Object(J.a)(na,"ThrottlerManager",null,[712]);var sa=d(1094);const Ha=(Fa,Ca,La,nb,Nb,Rb,Ya,Qb,bb=null,Bb=null,Eb=null,tb=null)=>{const Yb=Y.createInstance(A.AFrameworkApplication.fa),Tc=A.AFrameworkApplication.buildVersion?A.AFrameworkApplication.buildVersion:
"1.0",ib=cb(Fa,Ca,Ya,Tc),Zb=Yb.tni?d(1092).RealtimeChannelMetrics.createInstance(ib):new I;var Cc=d(300).FrequentLoggingMetrics.create(Nb);Yb.ZVk&&Cc.Egl(Yb.YVk);var ob="";ob=bb&&""!==bb?bb:"/rtc2/";Cc.a3f=y.a.TE(ob);const cc=ob+"signalr";bb=ob+"findsession";const sb=K.Ysj;ob=new Ja;Eb=Eb||M.a.getInstance();h.ULS.shipAssertTag(556867617,500,Yb.Ngh<=d(329).RealtimeChannel.kSg,"Client attempting to override max payload size beyond absolute limit");const mb=Math.min(Yb.Ngh,d(329).RealtimeChannel.kSg);
Cc.jSg=mb;Cc=new qa(Yb,new na(ob),Fa,ib,Pb=>new C(Pb.createHubProxy(sb)),Qb,Eb,Zb,Cc,mb);Bb||(Bb=d(686).FindSessionStrategy.createInstance(Ca,Nb,bb,Qb,Tc,Ya,Fa,ib,Eb,Rb,nb,tb));Bb.hZb=Yb.hZb;Ca=new G(ib);La=La?La.split(","):null;Fa=new (d(329).RealtimeChannel)(Fa,La,ib,Qb,()=>$.hubConnection(cc),Bb,Cc,Ca,Eb,Zb,Yb,Nb);Fa.init();return Fa},cb=(Fa,Ca,La)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",Fa,Za(sa.a[La]),Za("browser"),Ca),Za=Fa=>Fa?Fa.charAt(0).toLocaleUpperCase()+
Fa.substring(1,Fa.length):Fa;d.d(V,"RealtimeChannel",function(){return va});class va{constructor(Fa,Ca,La,nb,Nb,Rb,Ya,Qb,bb,Bb,Eb,tb){this.pCd=!1;this.hY=null;this.uR=new v.a;this.kLb=1;this.S0=null;this.BJ=!1;this.Svd=(new Date(0)).getTime();this.Juf=0;this._clientId=Fa;this.Wxc=Ca;this.iY=0;this.Qh=nb;this.Upd=Qb;this.VTh=Ya;this.sGh=bb;this.aJh=Nb;this.WJa=Rb;this.Gr=La;this.ft=Bb;this.Gc=Eb;this.Ei=tb;this.mVh=1>100*Math.random()}get Zka(){return this.WJa.Zka}set Zka(Fa){this.WJa.Zka=Fa}get tXa(){return this.VTh}get Vk(){return this.sGh}init(){this.Vk.Y4h(Object(e.a)(this,
this.zGc,"disconnectAndCreateNewConnection"));this.Vk.d6h(Object(e.a)(this,this.ypk,"onUpdatePersistentStateRequestReceivedInternal"));this.Vk.c6h(Object(e.a)(this,this.xpk,"onUpdatePersistentStateClearedRequestReceived"));this.Ei.izc(this.ft);A.AFrameworkApplication.Iea(()=>{const {FrequentLoggingMetrics:Fa}=d(300);this.ft.CCe();Fa.instance&&Fa.instance.nce()});this.vSf();this.oGi();this.Vk.bDf(Object(e.a)(this,this.ztl,"updateConnectionQueryString"))}oGi(){try{const La=$.signalR;if(!La)throw Error.invalidOperation("Failed to retrieve Signalr object");
const nb=La.version;if(!nb)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===nb){var Fa=La.transports;if(!Fa)throw Error.invalidOperation("Failed to retrieve transports object");var Ca=Fa.longPolling;if(!Ca)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!Ca.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Ca.supportsKeepAlive=this.qAi()}}catch(La){h.ULS.sendTraceTag(6432339,
500,15,"Failed to disable longPolling KeepAlives: {0}",La.message)}}qAi(){return()=>!1}vSf(){const Fa=++this.kLb;this.Svd=(new Date(0)).getTime();this.S0=this.aJh();this.Vk.DFk(this.S0);this.S0.stateChanged(Ca=>{this.Eik(Ca,Fa)});this.S0.connectionSlow(Object(e.a)(this,this.Kok,"onSlowConnection"));this.S0.error(Object(e.a)(this,this.vok,"onSignalRError"));this.S0.log=Object(e.a)(this,this.wok,"onSignalRLog")}LJb(Fa,Ca){return Fa!==this.kLb?(h.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",
Ca),!1):!0}connect(){2!==this.iY&&1!==this.iY&&(h.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Gr),this.Upd.Aik(),u.a.instance.Fgl(),this.rla(1,this.iY),this.ssh())}ssh(){const Fa=this.kLb;this.pCd=!1;this.ft.Nbd();this.WJa.k0d(Object(e.a)(this,this.ksi,"connectSignalrConnection"),Object(e.a)(this,this.gYg,"onFailureToConnect"),Object(e.a)(this.tXa,this.tXa.xwj,"initThrottlerManager"),Object(e.a)(this,this.LJb,"verifyConnectionToken"),Fa)}gYg(Fa=null){this.ft.Obd();
let Ca=null;!Fa||"documentsessiondeleted"!==(Ca=Fa.toLowerCase())&&"documentsessionexpired"!==Ca?this.zGc():(h.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Gr,Fa),this.disconnect())}zGc(Fa,Ca=null){h.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.hY);Fa=(Fa=2===this.iY||1===this.iY)&&!this.tXa.d5a;let La=!0,nb=0;Ca&&Object.getType(Ca)!==Object.getType(Sys.EventArgs.Empty)&&
Ca.tEe&&""!==Ca.tEe&&(Fa=!0,this.WJa.SIe(Ca.tEe),La=Ca.cHe,nb=Ca.reconnectDelay);Fa&&this.rla(1,this.iY);++this.kLb;this.tXa.mxa();this.rhl(La);this.WJa.NRd();this.vSf();Fa&&window.setTimeout(Object(e.a)(this,this.ssh,"startConnecting"),Math.min(nb,3E4))}ztl(){let Fa=null;const Ca=({correlationId:Fa}=this.WJa.ALc()).returnValue;this.S0.qs=Ca;h.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Gr,Fa)}ksi(Fa){const {FrequentLoggingMetrics:Ca}=
d(300);this.Svd=(new Date).getTime();let La=null;this.S0.qs=({correlationId:La}=this.WJa.ALc()).returnValue;this.Gc.J7h&&(this.S0.url=Fa,Ca.instance&&(Ca.instance.EPf=y.a.TE(Fa)));let nb=null;this.Qh&&(nb=this.Qh.wi("WebServiceCall","ConnectToServer"));h.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Gr);Fa={};this.Wxc&&(Fa.transport=1===this.Wxc.length?this.Wxc[0]:this.Wxc);Fa.pingInterval=null;u.a.instance.nhc(1,0);Fa.waitForPageLoad=!1;this.S0.start(Fa,null).done(Nb=>
{this.ft.sCe();u.a.instance.nhc(1,1,!0);h.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",Nb.id,La)}).fail(Nb=>{h.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.WJa.nA,La,this.Gr);this.gYg();this.ft.bah(Nb);u.a.instance.nhc(1,1,!1);this.Vk.Y9g(0,{["CorrelationId"]:La,["ErrorDetails"]:Nb,["ConnectionState"]:n.a[this.iY]})}).always(()=>{const {FrequentLoggingMetrics:Nb}=
d(300);nb&&nb.stop();Nb.instance&&(Nb.instance.Nrd=!1)})}disconnect(){const {FrequentLoggingMetrics:Fa}=d(300);0===this.iY?h.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Gr):(this.ft.gah(),Fa.instance&&(Fa.instance.Nrd=!0),h.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Gr),this.tXa.d5a=!0,this.Upd.jjk(),this.rla(0,this.iY),this.zGc(),this.tXa.d5a=!1)}rhl(Fa){const Ca=this.Thi(),La=this.S0,nb=this.hY,
Nb=()=>{if(this.pCd)h.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.pCd=!0,La.stop(!0,Fa)}catch(Rb){h.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",Rb.message)}};0<Ca?(h.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",nb,Ca),window.setTimeout(Nb,Ca)):(h.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",nb),Nb())}Thi(){let Fa=0;0===this.S0.state&&(Fa=this.Svd+va.hAl-
(new Date).getTime(),0>Fa&&(Fa=0));return Fa}get connectionState(){return this.iY}M2a(Fa){this.Vk.M2a(Fa)}oHe(Fa){return this.nHe(0,Fa)}nHe(Fa,Ca){const La=new m.a;this.Vk.a$g(Fa,Ca,La);return La.task}Nzc(Fa){this.Vk.Nzc(Fa)}zra(Fa){return this.Igj(Fa)}nKc(){return this.sXi()}sXi(){const Fa={};for(let Ca of this.uR)Ca.value.Jb(0)&&(Fa[Ca.key]=Ca.value.ga(0).data);return Fa}Igj(Fa){return this.uR.Jb(Fa)&&this.uR.ga(Fa).Jb(0)?this.uR.ga(Fa).ga(0).data:null}ypk(Fa,Ca){for(let La of Ca.hxl)this.uR.Jb(La.key)||
this.uR.$(La.key,new T.a),Fa=La.value,this.uR.ga(La.key).$(Ca.type,new E(Fa.Presence,new Date(Fa.TimeStamp))),La.key===this._clientId&&0===Ca.type&&this.Vk.dFk(Fa.Presence)}xpk(Fa,Ca){for(const La of Ca.pMd)this.uR.remove(La)}rXi(){const Fa=new T.a;if(!this.uR.Jb(this._clientId))return Fa;for(let Ca of this.uR.ga(this._clientId))Fa.$(Ca.key,Ca.value.data);return Fa}rea(Fa,Ca=null,La=!1){const nb=new m.a;this.Vk.ZBe(Fa,Ca,La,nb);return nb.task}Eza(Fa){this.Vk.Eza(Fa)}F7i(){return this.w2(this._clientId)}w2(Fa){let Ca,
La;return({value:Ca}=this.uR.Of(Fa)).returnValue&&({value:La}=Ca.Of(0)).returnValue?new w(this.Mgj(La),La.timeStamp):null}AXi(){const Fa={};for(let Ca of this.uR)Ca.value.Of(0).returnValue&&(Fa[Ca.key]=this.w2(Ca.key));return Fa}Ahb(Fa){const Ca=new m.a;this.Vk.KGk(Fa,Ca);return Ca.task}get clientId(){return this._clientId}get zdl(){return this.mVh}dispose(){const {FrequentLoggingMetrics:Fa}=d(300);this.BJ||(this.tXa.mxa(),this.Ei.rcd(this.ft),this.ft.CCe(),Fa.instance&&Fa.instance.nce(),this.BJ=
!0)}Eik(Fa,Ca){this.LJb(Ca,"StateChangedSignalR")&&this.rla(this.BQf(Fa.newState),this.BQf(Fa.oldState))}rla(Fa,Ca){var {FrequentLoggingMetrics:La}=d(300),{ClientToClientMessageTelemetry:nb}=d(1E3);if((1!==this.iY||0!==Ca||1!==Fa)&&this.iY!==Ca){const Nb=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.iY,Ca,Fa]));h.ULS.sendTraceTag(3290053,500,10,Nb)}if(this.iY!==Fa){switch(Fa){case 2:La.instance&&
La.instance.Hak();this.hY=this.S0.id;h.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.hY,this.Gr);this.YXj(this.S0);h.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");La=null;this.Qh&&(La=this.Qh.wi("WebServiceCall","Receive First Presence"));nb=this.kLb;this.Vk.CFk(Object(e.a)(this,this.LJb,"verifyConnectionToken"),nb,this.Upd,Object(e.a)(this,this.aMd,"clearExistingPersistentState"),this.rXi(),La);this.Gc.TVk&&(La=100*Math.random()<=this.Gc.UVk,
d(1E3).ClientToClientMessageTelemetry.F8i(this.Vk,this.Gc,La).start());break;case 1:2===Ca&&h.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.hY);break;case 0:if(nb.instance&&nb.instance.stop(),this.tXa.d5a)h.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.hY);else{1===Ca&&(h.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",
this.hY),this.ft.mhc());2===Ca&&h.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.hY);this.zGc();return}}this.iY=Fa;this.Vk.nEk(Fa,Ca)}}YXj(Fa){if(Fa&&Fa.transport&&Fa.transport.name){Fa=Fa.transport.name;var Ca=Fa.toLowerCase();"websockets"===Ca?h.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",Fa,this.Gr):"serversentevents"===Ca?h.ULS.sendTraceTag(4290752,
500,50,"Transport name - {0} for [{1}]",Fa,this.Gr):"foreverframe"===Ca?h.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",Fa,this.Gr):"longpolling"===Ca?h.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",Fa,this.Gr):"mocktransport"!==Ca&&h.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",Fa)}else h.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")}Kok(){if(this.Gc.Mgh){const Fa=y.a.mS(this.Zka,"mid");h.ULS.sendTraceTag(3249544,
500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.hY,Fa)}else h.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.hY)}vok(){h.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.hY)}wok(Fa){Fa=d(184).RtcUtils.PBb(Fa);if(this.Gc.Mgh&&Fa.startsWith("Keep alive timed out.")){const Ca=y.a.mS(this.Zka,"mid");h.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",Fa,Ca)}else this.zdl&&2E3>this.Juf&&
!Fa.startsWith("Invok")&&!Fa.startsWith("Trigger")&&(h.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",Fa),this.Juf++)}aMd(){let Fa;const Ca=[];({value:Fa}=this.uR.Of(this._clientId)).returnValue&&this.uR.remove(this._clientId);for(let La of this.uR.keys)Array.add(Ca,La);for(const La of Ca)this.uR.remove(La);Fa&&this.uR.$(this._clientId,Fa);this.Vk.TEk(Ca)}BQf(Fa){switch(Fa){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",Fa,"Unknown SignalR state");
}}Mgj(Fa){return Fa&&Fa.timeStamp?(new Date).getTime()-Fa.timeStamp.getTime()>(this.Gc.gJd?6E4:this.Gc.awayCoauthorThresholdMs)?2:1:1}static createInstance(Fa,Ca,La,nb,Nb,Rb,Ya,Qb=null,bb=null,Bb=null,Eb=null,tb=null,Yb=null){return Ha(Fa,Ca,La,Yb,nb,Nb,Rb,Ya,Qb,bb,Bb,tb,Eb)}}va.kSg=31E3;va.Bre=8E3;va.hAl=15E3;Object(J.a)(va,"RealtimeChannel",null,[526,525])},679:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Ovf=!1;this.yzd=null;this.OYe=0;this.Zrd=this.oTf();this.Ipc=
this.oTf();this.l_a=this.Mjb=0;this.QE=()=>new Date}get dil(){return this.Ovf}oTf(){const e=Array(6);for(let m=0;m<e.length;m++)e[m]=0;return e}Y2i(){return this.Zrd.toString()}s_i(){return this.Ipc.toString()}Fgl(){this.yzd=this.QE()}nhc(e,m,n=!1){this.dil||(n&&(this.Ovf=!0),n=this.QE(),0===e&&5<this.Mjb||1===e&&5<this.l_a||(this.OYe<e?(1===this.Mjb%2&&(this.Zrd[this.Mjb]=-1,this.Mjb++),this.OYe=e,1===m&&(this.Ipc[this.l_a]=-1,this.l_a++),this.Ipc[this.l_a]=this.sNe(n),this.l_a++):0===e?(this.Zrd[this.Mjb]=
this.sNe(n),this.Mjb++):(this.Ipc[this.l_a]=this.sNe(n),this.l_a++)))}sNe(e){const m=e.getTime()-this.yzd.getTime();this.yzd=e;return m}static get instance(){h.Ja||(h.Ja=new h);return h.Ja}static set instance(e){h.Ja=e}}h.Ja=null;Object(J.a)(h,"LatencyMetrics",null,[])},680:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,n,v){this.Eck=e;this.hJa=m;this.Hbk=n;this.sij=v}}Object(J.a)(h,"ThrottlerManagerSettings",null,[])},684:function(J,V,d){J=d(0);class h extends Sys.EventArgs{constructor(T,
L){super();this.newState=T;this.oldState=L}}Object(J.a)(h,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(T,L){super();this.sni=T;this.WIa=L}}Object(J.a)(e,"ClientInfoEventArgs",Sys.EventArgs,[]);class m extends Sys.EventArgs{constructor(T){super();this.presence=T}}Object(J.a)(m,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class n extends Sys.EventArgs{constructor(T){super();this.pMd=T}}Object(J.a)(n,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);
class v extends Sys.EventArgs{constructor(T,L){super();this.type=T;this.yJb=L}}Object(J.a)(v,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var A=d(1093);class w extends Sys.EventArgs{constructor(T,L=null){super();this.YF=T;this.AXh=L}get type(){return this.YF}get nxa(){return this.AXh}}Object(J.a)(w,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class y extends Sys.EventArgs{constructor(T){super();this.Fzk=T}}Object(J.a)(y,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);
class u extends Sys.EventArgs{constructor(T,L,aa,Q,ea,ia){super();this.LJb=T;this.rNd=L;this.lsi=aa;this.E0f=ea;this.aMd=Q;this.Wx=ia}}Object(J.a)(u,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(T){super();this.hubConnection=T}}Object(J.a)(E,"RefreshProxyEventArgs",Sys.EventArgs,[]);class G extends Sys.EventArgs{constructor(T,L){super();this.sPi=T;this.errorMessage=L}}Object(J.a)(G,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class I extends Sys.EventArgs{constructor(T,
L,aa){super();this.type=T;this.presence=L;this.WIa=aa}}Object(J.a)(I,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var H=d(956);class K extends Sys.EventArgs{constructor(){super()}}Object(J.a)(K,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class C extends Sys.EventArgs{constructor(T){super();this.pMd=T}}Object(J.a)(C,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class Y extends Sys.EventArgs{constructor(T,L){super();this.type=T;this.hxl=L}}Object(J.a)(Y,"UpdatePersistentStateRequestEventArgs",
Sys.EventArgs,[]);var M=d(77);d.d(V,"a",function(){return P});class P{constructor(){this.Pa=new M.a}nEk(T,L){this.Pa.raiseEvent("CSC",new h(T,L))}DFk(T){this.Pa.raiseEvent("RP",new E(T))}Bbd(T){this.Pa.raiseEvent("RC",T)}HFk(){this.Pa.raiseEvent("RMID")}CFk(T,L,aa,Q,ea,ia){this.Pa.raiseEvent("RPS",new u(T,L,aa,Q,ea,ia))}x$g(T,L){this.Pa.raiseEvent("UPSR",new Y(T,L))}R9g(T,L){this.Pa.raiseEvent("PU",new A.a(T,L))}dFk(T){this.Pa.raiseEvent("MPU",new m(T))}ZBe(T,L,aa,Q){this.Pa.raiseEvent("SUN",new H.a(T,
L,aa,Q))}LGk(T,L){this.Pa.raiseEvent("UNR",new w(T,L))}a$g(T,L,aa){this.Pa.raiseEvent("SP",new I(T,L,aa))}vFk(T,L){this.Pa.raiseEvent("PSU",new v(T,L))}uFk(T){this.Pa.raiseEvent("PSC",new n(T))}TEk(T){this.Pa.raiseEvent("IPSC",new n(T))}MGk(T){this.Pa.raiseEvent("UPSC",new C(T))}QFk(T,L){this.Pa.raiseEvent("SPC",new K(T,L))}Y9g(T,L){this.Pa.raiseEvent("RCF",new G(T,L))}KEk(T){this.Pa.raiseEvent("CPSWM",new y(T))}KGk(T,L){this.Pa.raiseEvent("UCI",new e(T,L))}M2a(T){this.Pa.addHandler("CSC",T)}Z4h(T){this.Pa.addHandler("RP",
T)}Y4h(T){this.Pa.addHandler("RC",T)}d5h(T){this.Pa.addHandler("RMID",T)}X4h(T){this.Pa.addHandler("RPS",T)}d6h(T){this.Pa.addHandler("UPSR",T)}Nzc(T){this.Pa.addHandler("PU",T)}Z2h(T){this.Pa.addHandler("IPU",T)}b6h(T){this.Pa.addHandler("UCI",T)}k5h(T){this.Pa.addHandler("SUN",T)}$2h(T){this.Pa.addHandler("IUNR",T)}Eza(T){this.Pa.addHandler("UNR",T)}Y2h(T){this.Pa.addHandler("IPSU",T)}X2h(T){this.Pa.addHandler("IPSC",T)}c6h(T){this.Pa.addHandler("UPSC",T)}j5h(T){this.Pa.addHandler("SP",T)}bDf(T){this.Pa.addHandler("SPC",
T)}h5h(T){this.Pa.addHandler("RCF",T)}S2h(T){this.Pa.addHandler("CPSWM",T)}ZOk(T){this.Pa.removeHandler("CPSWM",T)}static getInstance(){return P.Ja||(P.Ja=new P)}}P.Ja=null;Object(J.a)(P,"RtcEventHub",null,[569])},686:function(J,V,d){d.r(V);J=d(0);var h=d(375),e=d(13),m=d(17),n=d(952),v=d(958),A=d(25),w=d(80),y=d(62),u=d(441),E=d(489),G=d(101),I=d(45),H=d(113),K=d(959);class C{}C.clientId="ClientId";C.Lxl="UserApp";C.userSessionId="usid";C.userType="UserType";C.$xl="UserVersion";C.Kgc="qs";C.vni=
"clientProtocol";C.Oek="NoAuth";Object(J.a)(C,"RtcFindSessionInputQueryParamConstants",null,[]);class Y{constructor(D,pa,Z,oa,Ba,Ma){this.o1a=null;const {FindSessionStrategy:za}=d(686);this.QSh=D;D=String.format("{0}={1}",C.clientId,I.a.Me(oa));D=String.format("{0}&{1}={2}",D,C.userSessionId,I.a.Me(Ba));D=String.format("{0}&{1}={2}",D,C.Lxl,I.a.Me(Z.toString()));D=String.format("{0}&{1}={2}",D,C.userType,I.a.Me("1"));D=String.format("{0}&{1}={2}",D,C.$xl,I.a.Me(pa));D=String.format("{0}&{1}={2}",
D,C.vni,I.a.Me(za.uni));(pa=Y.aYi(Z,Ma))&&(D=String.format("{0}&{1}",D,pa));this.bJh=D}Qah(){this.o1a=this.QSh()}BVi(){this.o1a&&""!==this.o1a||(this.Qah(),h.ULS.sendTraceTag(575784194,500,this.o1a&&""!==this.o1a?50:15,"Query signature delegate called for refresh returned: {0} ",this.o1a));const D=String.format("{0}={1}",C.Kgc,I.a.Me(this.o1a));return String.format("{0}&{1}",D,this.bJh)}static aYi(D,pa){return 4===D?String.format("{0}={1}",C.Oek,"1"):pa?pa.Qgj():null}}Object(J.a)(Y,"FindSessionQueryStringGenerator",
null,[]);var M=d(300),P=d(679),T=d(184),L=d(680);class aa{}aa.HRi="FSType";Object(J.a)(aa,"RtcFindSessionRequestHeaders",null,[]);class Q{}Q.HHk="polling";Object(J.a)(Q,"RtcFindSessionTypes",null,[]);var ea=d(957);class ia{}ia.Wyl="RTC-TokenProofkey";ia.cQj="RTC-IsWacJsBootFsRequest";Object(J.a)(ia,"RtcRequestHeaders",null,[]);d.d(V,"FindSessionStrategy",function(){return ja});class ja{constructor(D,pa,Z,oa,Ba,Ma,za,ka,qa,Ja,xa,Ga,na=null){this.Lbf=(new Date(0)).getTime();this.ddf=0;this.Mtc=!1;this.Mtf=
null;this.LCe=36E5;this.djb=ja.Rlg;this.lMb=0;this.Eeb=null;this.Wva=0;this.fFb=this.FPf=null;this.xTh=[v.a.$ub,v.a.errorMessage,v.a.mMe,v.a.nA,v.a.v4,v.a.h2d,v.a.fcb,v.a.hJa,v.a.hcb];this.wTh=[v.a.$ub,v.a.errorMessage];this.nA=this.Zka=null;this.a2e=new Y(xa?xa:()=>A.AFrameworkApplication.Zg,Ba,Ma,za,D,pa);this.RKb=Ga;this.Qh=oa;this.Ei=pa;this.xLh=Z;this.Gr=ka;this.Vk=qa;this.xMb=na;this.b2e=!1;this.hZb=9E4;Ja&&Ja.execute(sa=>{sa.Kzc(()=>{h.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",
this.Gr);this.a2e.Qah()})});2>=100*Math.random()&&(this.LCe=3E5);M.FrequentLoggingMetrics.instance&&(M.FrequentLoggingMetrics.instance.p5f=this.LCe)}SIe(D){this.fFb=D}init(){this.Vk.d5h(Object(e.a)(this,this.tTk,"resetGetMachineIdDelay"));this.Vk.M2a(Object(e.a)(this,this.rla,"onConnectionStateChanged"))}rla(D,pa){this.Wva=pa.newState;2===pa.newState&&(this.lMb=0)}ALc(){let D;D=this.Eeb.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.Eeb.v4,ja.eOd,I.a.Me(D)),correlationId:D}}k0d(D,
pa,Z,oa,Ba){this.GZk(()=>{oa(Ba,"GetMachineIdSuccess")&&(h.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.nA,this.Gr),D(this.Mtf),Z(this.Afj()))},Ma=>{oa(Ba,"GetMachineIdFailure")&&(h.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.Gr),pa(Ma))},oa,Ba)}NRd(){this.pNf();this.$uj()}GZk(D,pa,Z,oa){h.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",
this.nA);this.nA?D():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(D,pa,Z,oa)},this.Ahi())}sendFindSessionRequestToServerInternal(D,pa,Z,oa){Z(oa,"RequestMachineId")&&(this.Lbf=(new Date).getTime(),Z=y.a.oj(),this.q9f(Ba=>{const Ma=y.a.oj();this.k9c(Ba);this.AIe();D();Ba=y.a.oj()-Ma;h.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",Ba)},Ba=>{const Ma=y.a.oj();this.pNf();M.FrequentLoggingMetrics.instance&&M.FrequentLoggingMetrics.instance.tG(2,3);pa(Ba);Ba=
y.a.oj()-Ma;h.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",Ba)},!1),Z=y.a.oj()-Z,h.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",Z))}$uj(){this.djb+=ja.G6i;this.djb=Math.min(this.djb,ja.Bbk)}Ahi(){let D=this.Lbf+this.djb-(new Date).getTime();0>D&&(D=0);return D}k9c(D){try{this.Eeb=D,this.Zka=D.nPf,this.nA=D.nA,this.FPf=D.v4,this.Mtf=D.KVb}catch(pa){h.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",pa.toString())}}pNf(){this.nA=
null;this.qNf()}AIe(){this.qNf();this.Mtc=!0;this.ddf=window.setTimeout(Object(e.a)(this,this.PJk,"refreshMachineId"),this.LCe)}qNf(){this.Mtc&&(window.clearTimeout(this.ddf),this.Mtc=!1)}PJk(){this.Mtc=!1;this.q9f(D=>{const pa=this.FPf!==D.v4,Z=this.nA!==D.nA,oa=this.nA;this.k9c(D);0!==this.Wva&&(Z?(h.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",oa||"null",D.nA),this.Vk.Bbd()):(this.Vk.QFk(pa,Z),this.AIe()))},()=>{M.FrequentLoggingMetrics.instance&&
M.FrequentLoggingMetrics.instance.tG(2,3);this.AIe()},!0)}tTk(){this.djb=ja.Rlg}Afj(){return new L.a(this.Eeb.R4c,this.Eeb.O4c,this.Eeb.N4c,this.Eeb.ZNc)}Znl(D){if(Object.getType(D)!==Object)return null;for(let pa in D);return this.Vwi(D)}Vwi(D){if(!(v.a.$ub in D))return null;const pa=D[v.a.$ub];var Z=pa?this.xTh:this.wTh;for(const oa of Z)if(!(oa in D))return null;Z=Object.assign(new K.a,{A4b:D[v.a.$ub],errorMessage:D[v.a.errorMessage],correlationId:H.a.create().toString()});pa&&(Z.KVb=D[v.a.mMe],
Z.v4=D[v.a.v4],Z.nA=D[v.a.nA],Z.ZNc=D[v.a.h2d],Z.N4c=D[v.a.fcb],Z.O4c=D[v.a.hJa],Z.R4c=D[v.a.hcb]);return Z}Z2i(D,pa){h.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.xMb.FRi.continueWith(()=>{this.xMb.FRi.result?(h.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),D(this.xMb.GRi)):(h.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),pa(this.xMb.GRi))})}efh(D,pa,Z,oa,Ba=!1){return Ma=>{P.a.instance.nhc(0,
1);D&&D.stop();this.RKb=this.fFb=null;this.gBg(Ma.data,!0,pa);var za=T.RtcUtils.deserialize(Ma.data.Zd,"FindSession",null);if(za)if(za=this.Znl(za)){if(za.A4b&&za.v4&&za.nA){h.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.Gr);this.AVj(Ma.data);Z(za);return}pa.FindSessionFailureReason="FindSessionInvalidResponse";pa.IsRtcEnabled=za.A4b;pa.IsQueryStringEmpty=!za.v4;pa.IsConnectionStringEmpty=!za.nA;h.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
this.Gr,za.A4b,!za.v4,!za.nA)}else pa.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",h.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.Gr);else pa.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",h.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",this.Gr);this.Z9g(pa,Ba);oa(null)}}Weh(D,pa,Z,oa=!1){return Ba=>{P.a.instance.nhc(0,1);D&&D.stop();this.RKb=this.fFb=null;
this.gBg(Ba.data,!1,pa);let Ma=null;var za="unknown";let ka="unknown";Ba.data&&((za=Ba.data.mj)&&ja.Hic in za&&(Ma=za[ja.Hic].toString()),za=E.a[Ba.data.status],ka=Ba.data.af.toString());pa.FindSessionFailureReason="FindSessionRequestFailed";pa.HttpErrorCode=ka;pa.HttpErrorStatus=za;pa[ja.Hic]=Ma;h.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",za,ka,this.Gr,Ma,oa);this.Z9g(pa,oa);Z(ka)}}q9f(D,pa,Z=
!1){let oa=null;h.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Gr);const Ba={};var Ma=this.a2e.BVi();Ba[u.a.mAa]=H.a.create().toString();this.fFb&&""!==this.fFb?Ma=String.format("{0}&{1}={2}",Ma,ea.a.IFe,this.fFb):this.RKb&&""!==this.RKb&&(Ma=String.format("{0}&{1}={2}",Ma,ea.a.IFe,this.RKb),Ba[ia.Wyl]="True",Ba[ia.cQj]="True");Ma=this.xLh+"?"+Ma;Z&&(Ba[aa.HRi]=Q.HHk);const za={};za.IsNetworkOfflineBeforeSendRequest=this.Ei.eDa;za.HasAvailableConnectionsBeforeSendRequest=
this.Ei.xig;za.MaxConnectionsAllowed=this.Ei.fSg;za.IsRefreshMachineId=Z;this.xMb&&!this.b2e?(this.Z2i(this.efh(null,za,D,pa,Z),this.Weh(null,za,pa,Z)),this.b2e=!0):(this.Qh&&(oa=this.Qh.wi("WebServiceCall","GetMachineIdFromTheServer")),M.FrequentLoggingMetrics.instance&&M.FrequentLoggingMetrics.instance.tG(2,0),0>this.Ei.FY(Ma,1,null,Ba,[ja.vEc,ja.Hic,ja.Ecc,ja.GFe,ja.TTg,ja.OVg,ja.NVg],1,this.efh(oa,za,D,pa,Z),this.Weh(oa,za,pa,Z),null,null,!1,null,this.hZb,"3",null,!0)&&(5<this.lMb&&200>this.lMb&&
h.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.lMb),window.setTimeout(()=>{this.lMb++;pa("-1")},1E3)))}gBg(D,pa,Z){Z||(Z={});Z.IsNetworkOfflineAfterRequestComplete=this.Ei.eDa;Z.IsRequestSucceeded=pa;D&&(Z.EnqueueTime=D.NH,Z.InvokedTime=D.zt,Z.CompletedTime=D.Iu,D.mj&&(ja.vEc in D.mj&&(Z.CorrelationId=D.mj[ja.vEc]),ja.Ecc in D.mj&&(Z[ja.Ecc]=D.mj[ja.Ecc])));h.ULS.sendTraceTag(38633565,500,pa?50:15,T.RtcUtils.PBb(Z))}Z9g(D,
pa){D||(D={});D.ConnectionState=n.a[this.Wva];pa||this.Vk.Y9g(1,D)}AVj(D){try{var pa=!1,Z=!1,oa=D.mj,Ba=w.a.TE(D.request.get_url());if(oa&&ja.GFe in oa){const Ja=oa[ja.GFe].toString().toLocaleLowerCase();Z="true"===Ja;pa="false"===Ja}oa=!1;const qa=0<=Ba.toLocaleLowerCase().indexOf("collab");Z&&!qa?oa=!0:pa&&qa&&(oa=!0);if(oa){pa={};pa.HostName=Ba;pa.Status=E.a[D.status];pa.HttpStatus=D.af.toString();var Ma=D.request.get_headers();for(let Ja in Ma){var za=Ma[Ja];(Ba=Ja)&&0<Ba.length&&(Z=0,za&&(Z=
za.toString().length),pa["r_"+Ba]=Z)}if(D.mj){const Ja=new m.a;Ja.add(ja.vEc);Ja.add(ja.Ecc);Ja.add(ja.Hic);Ja.add(ja.OVg);Ja.add(ja.NVg);Ja.add(ja.TTg);ja.S0h(pa,D.mj,Ja)}ja.N0h(D.request.get_url(),pa);var ka=G.a.toJSON(pa);h.ULS.sendTraceTag(559437006,500,15,ka)}}catch(qa){h.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",qa.toString())}}static createInstance(D,pa,Z,oa,Ba,Ma,za,ka,qa,Ja,xa,Ga=null){return ja.VEc(D,pa,Z,oa,Ba,Ma,za,ka,qa,Ja,null,xa,Ga)}static Mxi(D,pa,
Z,oa,Ba,Ma,za,ka,qa,Ja,xa=null){return ja.VEc(D,pa,Z,oa,Ba,3,Ma,za,ka,qa,Ja,xa,null)}static VEc(D,pa,Z,oa,Ba,Ma,za,ka,qa,Ja,xa,Ga,na=null){D=D||H.a.create().toString();D=new ja(D,pa,Z,oa,Ba,Ma,za,ka,qa,Ja,xa,Ga,na);D.init();return D}static S0h(D,pa,Z){for(let oa of Z)oa in pa&&(D[oa]=pa[oa])}static N0h(D,pa){if(D){var Z=D.indexOf("?");if(-1!==Z)for(D=D.substr(Z+1).split("&"),Z=0;Z<D.length;++Z){var oa=D[Z].split("=");if(2===oa.length){const Ba=oa[0];if(Ba&&0<Ba.length){let Ma=0;if(oa=oa[1])Ma=oa.length;
pa["q_"+Ba]=Ma}}}}}}ja.G6i=3E3;ja.Bbk=3E5;ja.uni="1.0";ja.Rlg=1E3;ja.vEc="X-CorrelationId";ja.eOd="corrid";ja.Hic="RtcErrorCode";ja.Ecc="X-OfficeCluster";ja.GFe="X-NewEnv";ja.TTg="X-MSEdge-Ref";ja.NVg="X-OFFICEFD";ja.OVg="X-OfficeFE";Object(J.a)(ja,"FindSessionStrategy",null,[564])},711:function(J,V,d){J=d(0);class h{constructor(){this.$We=this.Rpd=!1;this.callback=null}Qcc(m){this.callback=m;this.ixh()}ERg(m){this.Rpd||(this.Rpd=!0,this.YIh=m,this.ixh())}ixh(){this.Rpd&&this.callback&&!this.$We&&
(this.$We=!0,this.callback(this.YIh))}}Object(J.a)(h,"CompletionTask",null,[]);d.d(V,"a",function(){return e});class e{constructor(){this.Kdf=new h;this.Idf=new h}B7c(m){this.Kdf.Qcc(m)}A7c(m){this.Idf.Qcc(m)}Bbc(m){this.Kdf.ERg(m)}AVa(m){this.Idf.ERg(m)}sre(){this.Bbc(2);this.AVa(2)}}Object(J.a)(e,"MessageStatus",null,[740])},952:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.disconnected=0]="disconnected";e[e.connecting=1]="connecting";e[e.connected=2]="connected"})(h||
(h={}));Object(J.b)("ChannelConnectionState",h)},953:function(J,V,d){d.r(V);d.d(V,"MaxOutstandingThrottler",function(){return n});J=d(0);var h=d(13),e=d(77);V=d(954);var m=d(711);class n extends V.a{constructor(v,A=""){super(v,A);this.fcb=this.hJa=0;this.Pa=new e.a;this.nkb=!1;this.vuc=this.aqc=this.Jpc=this.qDd=0;this.Oxc=[];this.clearTimeout=n.sQd}add(v){this.okb||this.init(n.KUf,n.zUf);this.c2a++;const A=new m.a;this.Mub?this.$fd(v,A):this.vuc<this.fcb?this.fjc(v,A):(this.$fd(v,A),this.nkb=!1);
return A}fjc(v,A){v=this.ztf(v);const w=this.setTimeout(Object(h.a)(this,this.Glk,"onMessageWaitTimeExpired"),this.hJa);++this.vuc;Array.add(this.Oxc,w);const y=this.Jpc;v.B7c(u=>{A.Bbc(u)});v.A7c(u=>{this.Jpc===y&&(this.Flk(y,w),A.AVa(u))})}Flk(v,A){this.Jpc===v&&(--this.vuc,this.clearTimeout(A),Array.remove(this.Oxc,A),this.Mub&&this.l_k())}l_k(){this.Mub&&!this.nkb&&(this.qDd=this.setTimeout(Object(h.a)(this,this.m_k,"sendThrottledMessageFromTimer"),0),this.nkb=!0)}m_k(){this.nkb=!1;if(this.Mub){const v=
this.Kxc,A=this.hmb;this.dVb(!1);this.fjc(v,A)}}Glk(){++this.aqc;this.aqc>Math.floor(this.fcb/2)&&(this.aqc=-1E9,this.Pa.raiseEvent("TMUDM"))}Rzc(v){this.Pa.addHandler("TMUDM",v)}reset(){this.c2a=this.zRb=this.WLb=this.aqc=0;++this.Jpc;for(const v of this.Oxc)this.clearTimeout(v);this.vuc=0;this.Oxc=[];this.dVb(!0);this.nkb&&(this.clearTimeout(this.qDd),this.qDd=0,this.nkb=!1)}init(v,A){this.okb||(this.hJa=v,this.fcb=A,this.okb=!0)}static createInstance(v,A=""){return new n(v,A)}static sQd(v){window.clearTimeout(v)}}
n.KUf=15E3;n.zUf=5;Object(J.a)(n,"MaxOutstandingThrottler",V.a,[735,736])},954:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(375);class e{constructor(m,n=""){this.WLb=this.zRb=0;this.Oud=!1;this.hmb=this.Kxc=null;this.okb=!1;this.ztf=m;this.bwh=n;this.setTimeout=e.CQd;this.c2a=this.zRb=this.WLb=0}BCe(){0<this.c2a&&0<this.WLb&&h.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.bwh,this.WLb,this.c2a);0<this.c2a&&0<this.zRb&&h.ULS.sendTraceTag(36545634,
500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.bwh,this.zRb,this.c2a)}get Mub(){return this.Oud}$fd(m,n){this.zRb++;this.dVb(!0);this.Oud=!0;this.Kxc=m;this.hmb=n}dVb(m){this.Oud=!1;this.hmb&&m&&(this.WLb++,this.hmb.sre());this.hmb=this.Kxc=null}static CQd(m,n){return window.setTimeout(m,n)}}Object(J.a)(e,"ThrottlerBase",null,[])},955:function(J,V,d){d.r(V);d.d(V,"MaxRateThrottler",function(){return m});J=d(0);var h=d(13);V=d(954);var e=d(711);class m extends V.a{constructor(n,
v=""){super(n,v);this.hcb=0;this.qOb=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(n){this.okb||(this.hcb=n,this.okb=!0)}add(n){this.okb||this.init(m.tUf);this.c2a++;const v=this.currentTime(),A=new e.a;this.qOb>v&&(this.qOb=v);this.Mub?(this.dVb(!0),this.$fd(n,A)):this.qOb+this.hcb<=v?this.fjc(n,A):(this.$fd(n,A),this.setTimeout(Object(h.a)(this,this.k_k,"sendThrottledMessage"),this.qOb+this.hcb-v));return A}k_k(){if(this.Mub){const n=this.Kxc,v=this.hmb;this.dVb(!1);this.fjc(n,
v)}}fjc(n,v){this.qOb=this.currentTime();n=this.ztf(n);n.B7c(A=>{v.Bbc(A)});n.A7c(A=>{v.AVa(A)})}static createInstance(n,v=""){return new m(n,v)}}m.tUf=200;Object(J.a)(m,"MaxRateThrottler",V.a,[737,736])},956:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m,n,v){super();this.type=e;this.nxa=m;this.rEi=n;this.WIa=v}}Object(J.a)(h,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},957:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}
h.IFe="rr";h.WVk="rd";h.SVk="rbp";h.cHe="sa";Object(J.a)(h,"RtcReconnectParams",null,[])},958:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.hcb="throttling_messageDelay";h.$ub="enabled";h.hJa="throttling_timeToWaitForResponse";h.fcb="throttling_maxNumberOfOutstandingMessages";h.h2d="throttling_globalMaxNumberOfOutstandingMessages";h.errorMessage="errorMessage";h.mMe="url";h.v4="queryString";h.nA="connectionString";Object(J.a)(h,"RtcFindSessionOutputFieldNameConstants",null,[])},
959:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ZNc=this.N4c=this.O4c=this.R4c=0;this.A4b=!1;this.correlationId=this.nA=this.v4=this.KVb=this.errorMessage=null}get nPf(){return this.KVb+"?"+this.v4}}Object(J.a)(h,"FindSessionResponse",null,[])},999:function(J,V,d){J=d(0);var h;(function(m){m[m.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";m[m.peopleImageClassName=1]="peopleImageClassName";m[m.peopleImageClusterPath=4]="peopleImageClusterPath";
m[m.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";m[m.imageDimension=6]="imageDimension";m[m.rtl=8]="rtl";m[m.pointerInputManager=9]="pointerInputManager";m[m.clickInputManager=10]="clickInputManager";m[m.vertical=11]="vertical";m[m.zIndex=12]="zIndex";m[m.contextMenuInputManager=13]="contextMenuInputManager";m[m.imageDomElement=14]="imageDomElement";m[m.useIdleTooltip=15]="useIdleTooltip";m[m.viewportBoundsCallback=16]="viewportBoundsCallback";m[m.flipHorizontalDirection=17]=
"flipHorizontalDirection";m[m.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";m[m.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";m[m.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||(h={}));Object(J.b)("PresenceTooltipSettingKeys",h);d.d(V,"a",function(){return e});class e{constructor(){this.ay={}}get(m,n=null){m=h[m];return"number"===typeof n?(n=this.ay[m])?Number.parseInvariant(n.toString()):0:this.ay[m]}add(m,n){this.ay[h[m]]=n}WC(m,n){h[m]in this.ay||(this.ay[h[m]]=
n)}remove(m){delete this.ay[h[m]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.presence1.js.map