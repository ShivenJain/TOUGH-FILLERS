'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1007:function(J,V,d){J=d(0);var h=d(17),e=d(146),m=d(657),n=d(371),v=d(260),A=d(439),w=d(158),y=d(175),u=d(174),E=d(118),G=d(104);class I{constructor(ia){this.rb=ia;this.ixc=this.c1d()}nG(){return"Add-ins"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:3}qD(ia,ja){ia=new u.a(ia);ja.resultsUpdated(ia)}DQa(ia,ja,D){let pa;pa=this.rb.eH?new y.a(26):new y.a(24);pa.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;
D&&this.Zcl(ia.Ff,ja,pa)}Zcl(ia,ja,D){const pa=[];let Z;Z=this.rb.wBj?this.rb.eH&&this.rb.bNa?G.a.GPa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,ia)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,ia):this.rb.xBj?this.rb.eH&&this.rb.bNa?G.a.GPa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,ia)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,ia):this.rb.eH&&this.rb.bNa?G.a.GPa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,
ia)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,ia);this.rb.ria?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",Z)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",ia))):(pa.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",Z)),pa.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",ia)),appChrome.api.dispatch(pa));D.Fv(new w.a("LaunchAddinDialogFromTellMe",
27));ja.us(D)}c1d(){const ia=[];this.rb.YQc&&Array.add(ia,"Addin");return ia}}Object(J.a)(I,"AddinStoreResultsProvider",null,[968]);var H=d(947),K=d(325),C=d(372),Y=d(948),M=d(978),P=d(949),T=d(438),L=d(25),aa=d(33),Q=d(113);d.d(V,"a",function(){return ea});class ea{constructor(ia,ja,D){this.VQb=this.Qwc=this.Rwc=this.Pwc=!1;this.xH=null;this.gR=-1;this.k2a=this.lRb=null;this.tRb="";this.C0a=0;this.rb=ia;const pa=G.a.aja();this.zKa=ja||[];this.Ei=L.AFrameworkApplication.He;this.tuf=ia.Gwe;this.Swc=
ia.Fwe;this.NBd=pa&&this.agb();this.OBd=pa&&this.bgb();this.aVh=pa&&this.cgb();this.QBd=this.XGb();this.vuf=this.WGb();ia.RNe&&G.a.xKe(ia)&&(this.lRb=new M.a(ia),this.Pwc=ia.Nlc,this.Rwc=ia.Olc,this.Qwc=ia.lSa,this.VQb=this.Pwc&&this.zx("File")||this.Rwc&&this.zx("People")||this.Qwc&&this.zx("Notes"));this.Owc=this.s$k();this.Uwc=ia.Pdc;this.PBd=this.G$k();this.suf=this.r$k();this.Dxa=this.Xej();this.gWe=new H.a(ia);this.UMh=new Y.a(ia);this.AWh=new P.a(ia);this.RGh=new I(ia);this.nQb=D;this.hBd=
new m.a;this.Uwc&&(this.gWe=new H.a(ia))}zx(ia){return Array.contains(this.zKa,ia)?!0:!1}nG(){return"TellMeService"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:this.zx("Command")||this.zx("Recommended")?2:3}Uej(ia){let ja="";if(!ia&&this.zx("Command")&&this.rb.y9d){ja+="CommandSearch_DLIS,";var D=this.rb.yvh;0<D.length&&(ja+=D+",")}ia&&this.zx("Recommended")&&this.Swc&&(D=this.rb.zvh,0<D.length&&(ja+=D+","));!ia&&this.zx("Help")&&(ia=this.rb.xvh,0<ia.length&&(ja+=ia+","));0<ja.length&&(ja=ja.substr(0,
ja.length-1));return ja}qD(ia,ja,D,pa=e.a.tellMe,Z=null){const oa=new u.a(ia);D=G.a.cN(ia);if(this.VQb&&(!this.C0a||window.performance.now()-this.C0a>=G.a.dkd)){var Ba=this.hBd.Yej();if(Ba)this.C0a=window.performance.now(),Ba.then(qa=>{this.tRb=qa},qa=>{E.TellMeActor.instance.Jd.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+qa)});else if(E.TellMeActor.instance.Jd)E.TellMeActor.instance.Jd.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var Ma=
this.VQb&&!!this.tRb;Ba=Ma||D&&this.zx("Recommended")&&this.Swc;Ma=Ma||!D&&(this.tuf&&this.zx("Command")||this.NBd&&this.zx("Answer")||this.OBd&&this.zx("Definition")||this.vuf&&this.zx("Image")||this.Uwc&&this.zx("Help")||this.QBd&&this.zx("WolframAnswer")||this.PBd&&this.zx("Template")||this.suf&&this.zx("Addin"));if(Ba||Ma)if(this.k2a=pa,pa={"Content-Type":"application/json",Accept:"application/json"},pa["X-Office-Version"]=L.AFrameworkApplication.buildVersion,pa["X-Office-Application"]=L.AFrameworkApplication.fa.Ha("Application"),
pa["X-Office-Platform"]="WAC",pa["X-TellMe-SqmUserId"]=L.AFrameworkApplication.fa.Ha("LoggableUserId")||"",pa["X-TellMe-SessionId"]=E.TellMeActor.instance.ANc(),this.tRb&&(pa.Authorization="Bearer "+this.tRb),Ba=this.Uej(D),0<Ba.length&&(pa["X-TellMe-Flights"]=Ba),Ba=[],!D&&this.zx("Answer")&&this.NBd&&(Z?Array.contains(Z,9):1)&&Array.add(Ba,"Answer"),!D&&this.zx("Command")&&this.tuf&&!K.CommandResultsUtility.N7d(ia.Ff)&&(Z?Array.contains(Z,17):1)&&Array.add(Ba,"Command"),!D&&this.zx("Definition")&&
this.OBd&&(Z?Array.contains(Z,10):1)&&Array.add(Ba,"Definition"),!D&&this.zx("Help")&&this.Uwc&&(Z?Array.contains(Z,8):1)&&Array.add(Ba,"Help"),!D&&this.zx("WolframAnswer")&&this.QBd&&(Z?Array.contains(Z,12):1)&&Array.add(Ba,"WolframAnswer"),D&&this.zx("Recommended")&&this.Swc&&!E.TellMeActor.instance.Bnc&&(Z?Array.contains(Z,18):1)&&Array.add(Ba,"Recommended"),!D&&this.zx("Image")&&this.vuf&&(Z?Array.contains(Z,19):1)&&Array.add(Ba,"Image"),this.tRb&&this.VQb&&(Z?Array.contains(Z,14)||Array.contains(Z,
15)||Array.contains(Z,20):1)&&(this.lRb.C4(),this.Pwc&&this.zx("File")&&Array.add(Ba,"File"),this.Rwc&&this.zx("People")&&Array.add(Ba,"People"),this.Qwc&&this.zx("Notes")&&Array.add(Ba,"Notes")),!D&&this.zx("Template")&&this.PBd&&(Z?Array.contains(Z,23):1)&&Array.add(Ba,"Template"),!D&&this.zx("Addin")&&this.suf&&(Z?Array.contains(Z,24):1)&&Array.add(Ba,"Addin"),Ba.length){pa["X-TellMe-SuggestionTypes"]=Ba.join(",");pa["X-TellMe-Culture"]=L.AFrameworkApplication.uiCulture;pa["X-TellMe-ProcessSessionId"]=
L.AFrameworkApplication.userSessionId;var za=this.xH=Q.a.create().toString();pa["Client-Request-Id"]=za;var ka=window.performance.now();this.fha();this.gR=window.setTimeout(()=>{if(za===this.xH){this.xH="";this.gR=-1;ja.resultsUpdated(oa);const qa={};qa[n.a.provider]=this.nG();qa[n.a.Ndb]=ia.HWa;E.TellMeActor.instance.Jd.WG(v.a.timedOut,this.nQb,qa)}},this.nQb);this.Ei.vj(this.Dxa,2,this.Wej(ia.Ff),pa,!1,0,qa=>{this.Vcb(qa,ia,ja,za,ka,Z)},qa=>{this.Kcb(qa,ia,ja,za,ka)},null,null,!1,4E3,6E3)}else E.TellMeActor.instance.Jd.onError("IssueQuery",
"Empty Online Provider List: No online calls by provider"),ja.resultsUpdated(oa);else ja.resultsUpdated(oa)}fha(){-1!==this.gR&&(window.clearTimeout(this.gR),this.gR=-1)}Vcb(ia,ja,D,pa,Z,oa){const Ba=new u.a(ja);if(pa===this.xH){this.fha();E.TellMeActor.instance.Jd.l4(ja.Ff.length,this.zKa.join(","),ia.data.af.toString(),Math.round(window.performance.now()-Z),T.a.tellMe,!0,A.a.Hra);pa=ia.data.Zd;ia=null;try{ia=aa.b(pa)}catch(xa){E.TellMeActor.instance.Jd.onError("OnSuccessCallBack","Exception occured while deserializing response:"+
xa);return}pa=G.a.cN(ja);if("Groups"in ia&&ia.Groups){var Ma=ia.Groups;for(var za of Ma)if("GroupType"in za&&"Suggestions"in za&&za.Suggestions)if("Commands"===za.GroupType&&(oa?Array.contains(oa,17):1)||"Recommended"===za.GroupType&&(oa?Array.contains(oa,18):1)){var ka=(Ma="Recommended"===za.GroupType)?"DLIS":"NaiveBayes";"Source"in za&&za.Source&&(ka=za.Source);var qa=za.Suggestions;new h.a;var Ja=[];for(const xa of qa)this.APj(xa)&&(qa=xa.Type,("Command"===qa||Ma&&"Recommended"===qa)&&Ja.push(new C.a(xa.CommandId,
xa.Score)));K.CommandResultsUtility.AVc(Ja,!ja.Ff.trim().length,za.GroupType,ka);ka=E.TellMeActor.instance.sR;qa=[];for(const xa of Ja)Ma&&ka&&ka.yNd(xa.commandId)||qa.push(xa);Ja=K.CommandResultsUtility.TMc(ja,qa,this.rb,null,null,null,Ma?18:17,0);0<Ja.results.length&&(this.k2a!==e.a.contextMenu&&(Ja.displayName=Ma?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),Ba.us(Ja))}else if("Answer"===za.GroupType){qa=za.Suggestions;Ma=null;Ja=2147483647;ka="";for(const xa of qa)if(this.xPj(xa))if(ka=
xa.Type,qa=this.wsb(ka),"Answer"===ka&&this.NBd){Ma=this.LSf(ka,xa,ja.Ff);break}else qa&&qa<Ja&&(Ja=qa,Ma=this.LSf(ka,xa,ja.Ff));Ja=G.a.TUk(ja.Ff,ka);Ma&&(oa?Array.contains(oa,Ma.type):1)&&(ka=[],this.Owc?this.rb.ria?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ma.value,Ma.TI)),E.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ma.value,Ma.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ma.value,
Ja))):(ka.push(appChrome.actions.setControlLabel(Ma.value,Ma.TI)),ka.push(appChrome.actions.updateCompoundButtonDescription(Ma.value,Ma.description)),ka.push(appChrome.actions.setCompoundButtonCommandValueId(Ma.value,Ja)),appChrome.api.dispatch(ka)):this.rb.ria?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ma.value,Ma.TI+" - "+Ma.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ma.value,Ja))):(ka.push(appChrome.actions.setControlLabel(Ma.value,
Ma.TI+" - "+Ma.description)),ka.push(appChrome.actions.setButtonCommandValueId(Ma.value,Ja)),appChrome.api.dispatch(ka)),Ja=this.rAi(Ma.type),Ja.Fv(Ma),Ba.us(Ja))}else"Help"===za.GroupType&&za.Suggestions.length&&(oa?Array.contains(oa,8):1)?this.Uwc&&(Ma=this.gWe.DQa(ja,za.Suggestions))&&0<Ma.results.length&&Ba.us(Ma):"Template"===za.GroupType&&(oa?Array.contains(oa,23):1)?(Ma=za.Suggestions)&&0<Ma.length&&this.AWh.DQa(ja,Ba,Ma):"Addin"===za.GroupType&&(oa?Array.contains(oa,24):1)?(Ma=za.Suggestions)&&
0<Ma.length&&this.RGh.DQa(ja,Ba,Ma):"Substrate"===za.GroupType&&this.VQb&&"Type"in za&&("File"===za.Type&&this.Pwc&&(oa?Array.contains(oa,15):1)?(Ma=this.lRb.n9f(za.Suggestions,pa,this.k2a))&&0<Ma.results.length&&Ba.us(Ma):"People"===za.Type&&this.Rwc&&(oa?Array.contains(oa,14):1)?(Ma=this.lRb.Gbg(za.Suggestions,pa,this.k2a))&&0<Ma.results.length&&Ba.us(Ma):"Notes"===za.Type&&this.Qwc&&(oa?Array.contains(oa,14):1)&&(Ma=this.lRb.$ag(za.Suggestions,pa,ja))&&0<Ma.results.length&&Ba.us(Ma));else E.TellMeActor.instance.Jd.onError("OnSuccessCallBack",
"GroupType"in za?"Invalid group suggestions found for "+za.GroupType:"Invalid group found")}if(ia.Intents){za=ia.Intents;for(const xa of za)this.uae(xa)&&("Image"===xa.GroupType&&xa.ConfidenceScore>xa.ConfidenceThreshold&&(oa?Array.contains(oa,19):1)?this.UMh.DQa(ja,Ba,0,xa):"Commands"===xa.GroupType&&xa.ConfidenceScore<xa.ConfidenceThreshold&&(oa?Array.contains(oa,17):1)&&(za=new y.a(17),Ba.us(za)))}D.resultsUpdated(Ba);E.TellMeActor.instance.Jd.l4(ja.Ff.length,this.zKa.join(","),"",Math.round(window.performance.now()-
Z),"",!0,A.a.provider)}}Kcb(ia,ja,D,pa,Z){const oa=new u.a(ja);pa===this.xH&&(this.fha(),E.TellMeActor.instance.Jd.l4(ja.Ff.length,this.zKa.join(","),ia.data.af.toString(),Math.round(window.performance.now()-Z),T.a.tellMe,!1,A.a.Hra));D.resultsUpdated(oa)}wsb(ia){switch(ia){case "Entity":return this.aVh?3:0;case "Definition":return this.OBd?5:0;case "WolframAnswer":return this.QBd?2:0;default:return 0}}LSf(ia,ja,D){switch(ia){case "Answer":return new w.a(this.Owc?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===ja.Title?D:ja.Title,ja.Description,0);case "Entity":return new w.a(this.Owc?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ja.Title?D:ja.Title,ja.Description,0);case "Definition":return new w.a(this.Owc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ja.Title?D:ja.Title,ja.Description,0);case "WolframAnswer":return new w.a("WolframForSearch",3,""===ja.Title?D:ja.Title,ja.Description,0);default:return null}}rAi(ia){switch(ia){case 0:return new y.a(9,CommonUIStrings.l_TellMeAnswersTitle);
case 2:return new y.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new y.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new y.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new y.a(19,this.rb.SGb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}xPj(ia){return"Type"in ia&&!!ia.Type&&""!==ia.Type&&"Description"in ia&&!!ia.Description&&""!==ia.Description}APj(ia){return"Type"in ia&&!!ia.Type&&""!==ia.Type&&"CommandId"in ia&&
!!ia.CommandId&&""!==ia.CommandId&&"Score"in ia&&!!ia.Score}uae(ia){if("GroupType"in ia&&ia.GroupType&&"ConfidenceScore"in ia&&"ConfidenceThreshold"in ia)return!0;E.TellMeActor.instance.Jd.onError("IsValidIntentGroup","Invalid intents found");return!1}Wej(ia){const ja=G.a.Zwg(ia),D={};D.Query=ia;ja&&this.Swc&&(D.CommandClickedEvents=E.TellMeActor.instance.Opd,D.CommandActionEvents=E.TellMeActor.instance.jYe,D.TellMeCommandClickMruEvents=E.TellMeActor.instance.eef,D.ContentType=E.TellMeActor.instance.zFc);
this.PBd&&(ia={},ia.Application=this.rb.application,D.TemplateInfo=ia);return aa.c(D)}agb(){return!!this.rb&&this.rb.agb||!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.gb.agb}bgb(){return!!this.rb&&this.rb.bgb||!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.gb.bgb}cgb(){return!!this.rb&&this.rb.cgb||!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.gb.cgb}XGb(){return!!this.rb&&this.rb.XGb||!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.gb.XGb}WGb(){return!!this.rb&&
(this.rb.WGb||this.rb.eH)}s$k(){return!!this.rb&&!this.rb.kSa}G$k(){return!!this.rb&&this.rb.Y4b}r$k(){return!!this.rb&&this.rb.yBj&&this.rb.vBj}yxg(){return!!L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}zxg(){return!!L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}Xej(){if(!L.AFrameworkApplication.fa)return"";
if(this.zxg())return L.AFrameworkApplication.fa.Ha("TellMeServiceProdEndpointForSearch");if(this.yxg())return L.AFrameworkApplication.fa.Ha("TellMeServiceEdogEndpointForSearch");if(G.a.f8d())return L.AFrameworkApplication.fa.Ha("TellMeServiceIntEndpointForSearch");let ia=L.AFrameworkApplication.fa.Ha("TellMeServiceSearchEndpoint");ia&&""!==ia||(ia=L.AFrameworkApplication.wvh);return ia}static iTf(ia,ja){if(ja)return new ea(ia,["Command","Recommended"],ia.M2i);ja=G.a.aja()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):
"Help WolframAnswer File People Notes Template Addin".split(" ");return new ea(ia,ja,ia.Bdg)}}Object(J.a)(ea,"TellMeServiceProvider",null,[968])},104:function(J,V,d){J=d(0);var h=d(15);class e{constructor(){this.userId=this.email=this.displayName=null}}Object(J.a)(e,"InsertMentionParameters",null,[]);class m{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(J.a)(m,"InsightsParameters",null,[]);var n=d(943),v=d(944),A=d(945),w=d(946),y=d(25),u=d(437),E=d(436),G=d(33),
I=d(54),H=d(45),K=d(123);d.d(V,"a",function(){return C});class C{static get Wzj(){return"Insights_16x16x32"}static get jRi(){return"Find_16x16x32"}static get $2g(){return"-Parameterized"}static get pMe(){return"Parameterized"}static get Mkd(){return"bTryQuery"}static get wRe(){return"TellMeSuggestion_"}static get Dyh(){return"bTryQueryAlternate"}static get ZOe(){return"MenuTellMe"}static get Duk(){const Y={},M=[];Array.add(M,{Term:{PeopleType:"Person"}});Y.And=M;return Y}static JBi(Y){return Y+C.$2g}static getParameter(Y){let M=
"",P="";if(Y)for(let T=0;T<Y.g2f;++T)"Type"===Y.yYd(T)?M=Y.getValue(T):"Value"===Y.yYd(T)&&(P=Y.getValue(T));return new h.a(M,P)}static lPd(Y){Y=Object.assign(new m,{neighborhood:Y,mentionStart:0,mentionLength:Y.length});return G.c(Y)}static SSf(Y,M,P){Y=Object.assign(new e,{displayName:Y,email:M,userId:P});return G.c(Y)}static bOa(Y,M,P=null){Y=Object.assign(new E.a,{neighborhood:Y,mentionStart:0,mentionLength:Y?Y.length:0});M=Object.assign(new u.a,{selection:Y,userIntent:null,entryPoint:M,launchData:P});
return G.c(M)}static TUk(Y,M){return C.bOa(Y,C.UUk(M))}static UUk(Y){switch(Y){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static Atg(){return!!y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.ka("IsGoLocalEnvironment")}static L8a(){const Y=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"):null;return!!Y&&0<Y.length}static isEnterpriseUser(){const Y=
y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ha("HostAuthType"):null;return!!Y&&"aad"===Y.toLowerCase()||"external"===Y&&C.f8d()}static yKe(Y){return Y.Kkl&&!C.L8a()}static ywg(){const Y=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ha("UiHostIntegrationType"):"";return!!y.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===Y&&y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static xKe(Y){return Y.Wwa&&Y.bQi&&(Y.Olc||
Y.Nlc||Y.lSa)&&!C.ywg()&&C.isEnterpriseUser()&&!C.L8a()}static aja(){return y.AFrameworkApplication.fa?y.AFrameworkApplication.Bwa||y.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane"):y.AFrameworkApplication.Bwa}static cN(Y){return!Y||C.Zwg(Y.Ff)}static Zwg(Y){return!Y||!Y.trim().length}static UQe(Y){if(!Y)return 0;const M=Math.pow(10,5);return Math.round(Y*M)/M}static wml(){var Y=new Date;return Y?new Date(Y.getUTCFullYear(),Y.getUTCMonth(),Y.getUTCDate(),Y.getUTCHours(),Y.getUTCMinutes(),
Y.getUTCSeconds(),Y.getUTCMilliseconds()):null}static D1d(Y){return(C.wml().getTime()-(new Date(Y)).getTime())/1E3}static vxg(Y){const {InsightsMenuItemFactory:M}=d(942);switch(Y){case n.a.R3d:case v.a.E3f:case M.Kpg:case A.a.MUg:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "LaunchAddinDialogFromTellMe":return!0}return Y.startsWith(C.Mkd)||
Y.startsWith(C.wRe)||Y.startsWith(C.Dyh)||Y.startsWith("PeopleSuggestion")||Y.startsWith("FileSuggestion")||Y.startsWith("FindInDocumentSuggestion")||Y.startsWith("NotesSuggestion")||Y.startsWith("OnenoteNotesSuggestion")||Y.startsWith("SmartLookupFromTellMe")||Y.startsWith("GetHelpFromTellMe")||Y.startsWith("GetHelpWithDescriptionFromTellMe")||Y.startsWith("AddinSuggestion")||Y.startsWith("OfficeScripts")?!0:!1}static TYd(Y,M){const P=[];Array.add(P,new w.a(400,Y));Array.add(P,new w.a(200,M));Y=
{};Y.parts=P;return JSON.stringify(Y)}static GPa(Y){const M=Y.indexOf("<b0>"),P=Y.lastIndexOf("</b0>"),T=[];Array.add(T,new w.a(400,Y.substring(0,M)));Array.add(T,new w.a(600,Y.substring(M+4,P)));Array.add(T,new w.a(400,Y.substring(P+5,Y.length)));Y={};Y.parts=T;return JSON.stringify(Y)}static Peg(Y){const M=C.D1d(Y);return 60>M?CommonUIStrings.l_TimeSince_SecsAgo:3600>M?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(M/60).toString()):86400>M?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(M/3600).toString()):172800>M?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(Y)).localeFormat("MMMM dd, yyyy"))}static d_i(Y){const M=Array(Y.length);for(let P=0;P<Y.length;P++)M[P]=Y[P].commandId;return M}static f8d(){if("Dev Box"===y.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse"))return!0;let Y=y.AFrameworkApplication.fa.Ha("UserPrincipalName");Y=K.b(Y)?"":H.a.sg(Y);const M=y.AFrameworkApplication.fa.Aw("TellMeIntEnabledForFeatureCrew")?
y.AFrameworkApplication.fa.HB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(M,Y)&&"inner"===y.AFrameworkApplication.fa.Ha("Microsoft365Ring")}static q4i(Y){switch(Y.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static Kw(){return I.a.AS&&!I.a.Hj}}C.dkd=9E5;Object(J.a)(C,"TellMeUtils",null,[])},1089:function(J,V,d){d.r(V);d.d(V,"SurfaceStringTokenStringGenerator",function(){return e});J=d(0);var h=d(536);class e extends h.a{constructor(m){super(m);this.Ia=
m}apply(m,n,v,A,w,y,u){null==y&&(y=m.Weg(w,n));u=h.a.VBf(m,y,this.Ia.score,v,A,u);return{zmc:y,jUb:u}}}e.kUb=0;Object(J.a)(e,"SurfaceStringTokenStringGenerator",h.a,[])},1090:function(J,V,d){d.r(V);d.d(V,"QueryTokenStringGenerator",function(){return m});J=d(0);var h=d(536),e=d(76);class m extends h.a{constructor(n){super(n);this.Ia=n}apply(n,v,A,w,y,u,E){v=this.Ia.query.load(v,null);y=0;let G=null;this.Ia.query.JT===e.Annotations.Tea?v&&(G=this.Ia.name):((G=this.Ia.name)&&(G+="_"),G+=this.Ia.annotations.D0(this.Ia.query.JT,
v));null!=G&&(y=h.a.VBf(n,G,this.Ia.score,A,w,y));return{zmc:u,jUb:E+y}}}m.kUb=1;Object(J.a)(m,"QueryTokenStringGenerator",h.a,[])},1091:function(J,V,d){d.r(V);d.d(V,"FuzzyMatchTokenStringGenerator",function(){return e});J=d(0);var h=d(536);class e extends h.a{constructor(m){super(m);this.Ia=m}apply(m,n,v,A,w,y,u){null==y&&(y=m.Weg(w,n));m=this.Ia.U_f.tYj(y);if(this.Ia.q1g)for(var E of m)if(!E.gG&&E.nJc)return{zmc:y,jUb:u};E=0;for(const G of m)if(G.gG&&!({dKd:E}=this.ZFf(G,!0,v,A,E)).returnValue)return{zmc:y,
jUb:u};if(this.Ia.rlg)for(const G of m)if(!({dKd:E}=this.ZFf(G,!1,v,A,E)).returnValue)break;return{zmc:y,jUb:u}}ZFf(m,n,v,A,w){let y;n?(n=0,y=m.nJc?1:0):(n=m.nJc?1:0,y=m.count-n);for(let u=0;u<y;++u)if(h.a.WBf(m.sPa+n+u,this.Ia.score,v,A),++w,0<this.Ia.Dre&&w>=this.Ia.Dre)return{returnValue:!1,dKd:w};return{returnValue:!0,dKd:w}}}e.kUb=2;Object(J.a)(e,"FuzzyMatchTokenStringGenerator",h.a,[])},1100:function(J,V,d){d.r(V);J=d(0);var h=d(297),e=d(17),m=d(15),n=d(1158),v=d(175);class A{constructor(C,
Y,M,P=0){this.Agg=C;this.groupType=Y;this.v2d=P;this.tic=M}}Object(J.a)(A,"SortingGroup",null,[]);class w{constructor(C,Y,M,P){this.order=C;this.a7a=Y;this.$ij=M;this.groupType=P}}Object(J.a)(w,"SortingProp",null,[]);var y=d(118),u=d(146),E=d(104),G=d(123);class I{constructor(C,Y){this.INg={};this.HNg={};this.cNg=this.nRg=1;this.PIf(C,Y)}hfl(C,Y,M){var P=E.a.cN(M)?this.INg:this.HNg;M=new e.a;for(var T of Y)Y=Object(n.a)(w,P[h.a[T.groupType].toLowerCase()]),G.b(Y)||M.add(new m.a(Y,T));M.Sc((aa,Q)=>
aa.key.order<Q.key.order?-1:1);Array.clear(C);T=y.TellMeActor.instance.YO;for(Y=0;Y<M.count;){P=M.ga(Y).key.a7a;var L=M.ga(Y).value;const aa=new v.a(M.ga(Y).key.groupType);G.b(T)||T.Location===u.a.contextMenu||(aa.displayName=M.ga(Y).key.$ij);for(const Q of L.results)aa.Fv(Q);for(L=++Y;L<M.count&&M.ga(L).key.a7a===P;)this.MFd(aa,M.ga(L).value),L=++Y;C.push(aa)}}rwl(C,Y){this.cNg=this.nRg=1;this.PIf(C,Y)}PIf(C,Y){this.Qrh(C);for(var M=0;M<C.length;M++){let P=C[M];for(const T of P.tic)this.D_h(T,M,
P.Agg,P.groupType)}this.Qrh(Y);for(C=0;C<Y.length;C++){M=Y[C];for(const P of M.tic)this.C_h(P,C,M.Agg,M.groupType)}}Qrh(C){C.sort((Y,M)=>Object(n.a)(A,Y).v2d>Object(n.a)(A,M).v2d?-1:1)}D_h(C,Y,M,P){this.INg[h.a[C].toLowerCase()]=new w(this.nRg++,Y,M,P)}C_h(C,Y,M,P){this.HNg[h.a[C].toLowerCase()]=new w(this.cNg++,Y,M,P)}MFd(C,Y){for(let M=0;M<Y.results.length;M++)C.Fv(Y.results[M])}}Object(J.a)(I,"BaseGroupingSorter",null,[]);class H{constructor(){this.s4c=[new A(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,
4,[4,2]),new A(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new A(CommonUIStrings.l_TellMeSuggestionsProviderTitle,30,[15,14,19,3]),new A("",13,[13]),new A("",22,[22])];this.C1c=[new A(CommonUIStrings.l_TellMeCommandProviderTitle,28,[17,0,1,8,25]),new A(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,29,[2,19,23,26]),new A(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,30,[15,14,20,9,12,10,11,24]),new A("",13,[13]),new A("",22,[22])];this.TGg=new I(this.s4c,this.C1c)}Skc(C,
Y,M,P=null,T=null){let L=!1;if(P){for(const aa of E.a.cN(M)?this.s4c:this.C1c)this.TGk(aa,P);L=!0}if(T){for(const aa of E.a.cN(M)?this.s4c:this.C1c)this.swl(Y,aa,T);L=!0}L&&this.TGg.rwl(this.s4c,this.C1c);this.TGg.hfl(C,Y,M)}TGk(C,Y){const M=new e.a;for(var P of C.tic){const T=Y[h.a[P].toLowerCase()];M.add(new m.a(G.b(T)?Number.MAX_VALUE:T,P))}if(M.count){M.Sc((T,L)=>T.key<L.key?-1:1);Y=Array(M.count);for(P=0;P<M.count;P++)Y[P]=M.ga(P).value;C.tic=Y}}swl(C,Y,M){let P=0;for(const T of Y.tic)if(h.a[T].toLowerCase()in
M&&M[h.a[T].toLowerCase()])for(const L of C)if(L.groupType===T){P+=M[h.a[T].toLowerCase()];break}Y.v2d=P}}Object(J.a)(H,"SimplifiedGroupingSorter",null,[]);d.d(V,"GroupsPlacementInfo",function(){return K});class K{constructor(C){this.GNg={};this.ENg={};this.FNg={};this.JNg={};this.Koe={};this.aOg=this.Q9j=this.g8j=this.F8j=1;this.YOg=null;this.Gx=C;this.Pei();this.ywk();this.Lei();this.Tdi();C.eH&&(this.YOg=new H)}qB(C){this.GNg[h.a[C].toLowerCase()]=this.F8j++}DE(C,Y){this.ENg[h.a[C].toLowerCase()]=
Y}lpa(C){this.FNg[h.a[C].toLowerCase()]=this.g8j++}FR(C){this.JNg[h.a[C].toLowerCase()]=this.Q9j++}gy(C){this.Koe[h.a[C].toLowerCase()]=this.aOg++}Pei(){const C=!!this.Gx&&this.Gx.kSa,Y=!!this.Gx&&this.Gx.Pdc,M=!!this.Gx&&this.Gx.lSa,P=!!this.Gx&&this.Gx.kae&&!E.a.L8a(),T=!!this.Gx&&this.Gx.Y4b,L=!!this.Gx&&this.Gx.YQc,aa=!!this.Gx&&this.Gx.E9d;this.qB(4);this.qB(18);this.qB(16);this.qB(7);this.qB(17);this.qB(0);this.qB(1);aa&&this.qB(25);T&&this.qB(23);C||this.qB(2);C&&!Y||this.qB(8);this.qB(15);
M&&this.qB(20);this.qB(14);this.qB(9);this.qB(12);this.qB(10);this.qB(11);C&&this.qB(2);C&&!Y&&this.qB(8);this.qB(19);L&&this.qB(24);this.qB(21);this.qB(13);P&&this.qB(22)}ywk(){this.DE(21,1);this.DE(4,3);this.DE(18,3);this.DE(16,3);this.DE(7,3);this.DE(17,5);this.DE(0,5);this.DE(1,1);this.DE(25,2);this.DE(2,1);this.DE(8,2);this.DE(15,3);this.DE(14,2);this.DE(24,3);this.DE(9,1);this.DE(12,1);this.DE(10,1);this.DE(11,1);this.DE(19,1);this.DE(23,1);this.DE(13,1);this.DE(20,2);this.DE(22,1)}Lei(){this.lpa(4);
this.lpa(0);this.lpa(17);this.lpa(7);this.lpa(16);this.lpa(18);this.lpa(15);this.lpa(20);this.lpa(8);this.lpa(14)}Tdi(){this.FR(14);this.FR(10);this.FR(12);this.FR(9);this.FR(11);this.FR(20);this.FR(15);this.FR(8);this.FR(2);this.FR(1);this.FR(24);this.FR(7);this.FR(18);this.FR(16);this.FR(17);this.FR(0);this.FR(4)}JTk(){this.Koe={};this.aOg=1}Uaj(C,Y,M){this.JTk();const P=!!this.Gx&&this.Gx.kSa,T=!!this.Gx&&this.Gx.Pdc,L=!!this.Gx&&this.Gx.lSa,aa=!!this.Gx&&this.Gx.kae&&!E.a.L8a(),Q=!!this.Gx&&this.Gx.Y4b,
ea=!!this.Gx&&this.Gx.YQc,ia=!!this.Gx&&this.Gx.E9d;C=C&&T;this.gy(4);this.gy(18);this.gy(16);this.gy(7);this.gy(17);this.gy(0);this.gy(1);ia&&this.gy(25);Q&&this.gy(23);P&&!T||!C||this.gy(8);Y&&this.gy(15);P||this.gy(2);ea&&this.gy(24);M&&this.gy(14);P&&!T||C||this.gy(8);Y||this.gy(15);L&&this.gy(20);M||this.gy(14);this.gy(9);this.gy(12);this.gy(10);this.gy(11);P&&this.gy(2);P&&!T&&this.gy(8);this.gy(19);this.gy(21);this.gy(13);aa&&this.gy(22);return this.Koe}jG(){return this.Gx}}Object(J.a)(K,"GroupsPlacementInfo",
null,[])},1103:function(J,V,d){d.r(V);J=d(0);var h=d(693),e=d(439),m=d(297),n=d(1007),v=d(438);class A{constructor(K="",C="",Y="",M=-99999,P=-1,T=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=K?K:"";this.Description=C?C:"";this.Type=Y?Y:"";this.Score=M;this.Age=P;this.Count=T}}Object(J.a)(A,"Suggestion",null,[]);class w{constructor(K,C){this.GroupType=this.Suggestions=null;this.Suggestions=K;this.GroupType=C}}Object(J.a)(w,"SuggestionGroup",null,[]);class y{}
y.help="help";y.answer="answer";y.commands="commands";y.H_k="servicecommands";y.Avh="template";Object(J.a)(y,"SuggestionGroupType",null,[]);var u=d(118),E=d(104),G=d(25),I=d(33);d.d(V,"InteractionLogger",function(){return H});class H{constructor(K,C,Y){this.lrd=0;this.aDd=this.sOb=null;this.Bh=K;this.aCd=this.bqd=this.Htd=!1;this.sJh=C;this.Ei=G.AFrameworkApplication.He;this.rb=Y;this.kqc=this.Nyd=0}get Ula(){return this.Bh.Ula}Mfd(K){this.Bh.Mfd(K)}fBg(){if(this.sOb){var K=0;for(const C of this.sOb)this.Bh.qXj(C,
K++);this.sOb=null}}beginQuery(K,C,Y){this.Bh.gXj(K,C,Y)}UYg(K,C){this.Bh.jbi(K,C);this.Htd=!0;this.aCd=!1}TYg(){this.Htd=!1;this.bqd||(this.fBg(),this.Bh.BZf(this.lrd))}hXj(K,C){this.Bh.iXj(K,C)}vik(K,C,Y,M,P){for(const T of this.sJh)if(K.startsWith(T)){this.aCd=!0;break}this.Bh.mVj(K,C,Y,M,P)}Hik(K){this.bqd=!1;this.lrd=K;this.Htd||this.aCd||(this.fBg(),this.Bh.BZf(this.lrd,!1))}Gik(K,C){this.Bh.qVj(K,C);this.bqd=!0}FWd(K,C){if(!K.count)return"";let Y="";const M=Date.now();for(let P of K)K=(M-P.timeStamp)/
1E3,K=E.a.UQe(K),0<Y.length&&(Y+=";"),Y+=C?P.commandId:P.controlId,Y+=":",Y+=K.toString();return Y}cdc(){var K=this.FWd(h.a.instance.oLb,!1);0<K.length&&this.Bh.kVj(K);K=this.FWd(h.a.instance.Sib,!0);0<K.length&&this.Bh.KUj(K);K=this.FWd(h.a.instance.lrc,!0);0<K.length&&this.Bh.UVj(K);K=u.TellMeActor.instance.fef;0<K.length&&this.Bh.fXj(I.c(K))}BXj(K){this.Bh.ZUj(K)}l4(K,C,Y,M,P,T,L,aa=null){this.Bh.DWj(K,C,Y,M,P,T,L,aa)}rce(K,C,Y,M){this.Bh.rce(K,C,Y,M)}WG(K,C,Y=null){this.Bh.KDa(K,C,Y)}onError(K,
C,Y=null){this.Bh.Y5b(K,C,Y)}T2k(K){this.sOb=K}mej(K){const C=[];if(!K)return C;for(let Y=0;Y<K.length;Y++){const M=m.a[K[Y].groupType].toLowerCase(),P=[],T=K[Y].results;if(T){for(let L=0;L<T.length;L++)"findindocument"===M?Array.add(P,new A("","",M,T[L].score,T[L].cAc,T[L].count)):Array.add(P,new A(T[L].label,T[L].description,M,T[L].score,T[L].cAc,T[L].count));"answer"===M||"definition"===M||"wolframanswer"===M||"entity"===M?Array.add(C,new w(P,y.answer)):"classifier"===M||"appsforoffice"===M?Array.add(C,
new w(P,y.commands)):"serviceclassifier"===M?Array.add(C,new w(P,y.H_k)):"assistance"===M?Array.add(C,new w(P,y.help)):("document"===M||"people"===M||"findindocument"===M||"notes"===M||"image"===M||"template"===M)&&Array.add(C,new w(P,M))}}return C}b1d(K,C){const Y={};Y.Query=C;Y.SuggestionGroups=I.c(this.mej(K));return I.c(Y)}xeg(K){const C={"Content-Type":"application/json",Accept:"application/json"};C["X-Office-Version"]=G.AFrameworkApplication.buildVersion;C["X-Office-Application"]=G.AFrameworkApplication.fa.Ha("Application");
C["X-Office-Platform"]="WAC";C["X-TellMe-SqmUserId"]=G.AFrameworkApplication.fa.Ha("LoggableUserId")||"";C["X-TellMe-SessionId"]=this.Bh.Ula.y7;C["X-TellMe-SuggestionTypes"]="Ranker";C["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;C["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;C["X-TellMe-Flights"]=K;C["X-TellMe-PartialQueryIndex"]=this.Nyd;return C}Vcb(K,C,Y){this.l4(C.length,"RankerLogging",K.data.af.toString(),Math.round(window.performance.now()-Y),v.a.vvh,!0,e.a.Hra)}Kcb(K,
C,Y){this.l4(C.length,"RankerLogging",K.data.af.toString(),Math.round(window.performance.now()-Y),v.a.vvh,!1,e.a.Hra)}yeg(){this.aDd||(this.aDd=new n.a(this.rb,null,6E3));return this.aDd.Dxa}uce(K){const C=this.b1d(this.sOb,K),Y=this.xeg("RankerLogging"),M=window.performance.now();this.Ei.vj(this.yeg(),2,C,Y,!1,0,P=>{this.Vcb(P,K,M)},P=>{this.Kcb(P,K,M)},null,null,!1,4E3,6E3);this.Nyd++}zTk(){this.Nyd=0}WHe(K){this.kqc=K}}Object(J.a)(H,"InteractionLogger",null,[])},118:function(J,V,d){d.r(V);J=d(0);
var h=d(13),e=d(22),m=d(1158),n=d(693),v=d(262);class A{constructor(Ua,pb,Ub,Bc,Gc,qd){this.groupType=Ua;this.resultType=pb;this.ONe=Ub;this.a7a=Bc;this.IRd=Gc;this.resultIndex=qd}}Object(J.a)(A,"ClickLoggingInfo",null,[]);const w=Ua=>{const pb=[];for(;Ua;)Array.add(pb,"{ContextId:"+Ua.contextId+", IsGraphNodeContext:"+Ua.Kk+"}"),Ua=Ua.MD;pb.reverse();return"{"+pb.join(", ")+"}"};class y{constructor(){this.y7=this.sessionId=null}}Object(J.a)(y,"CorrelationRecord",null,[1014]);var u=d(260);class E{constructor(Ua,
pb){this.Id=null;this.TimeStamp=0;this.Id=Ua;this.TimeStamp=pb}}Object(J.a)(E,"MRUControl",null,[]);var G;(function(Ua){Ua[Ua.Answer=0]="Answer";Ua[Ua.Definition=1]="Definition";Ua[Ua.Entity=2]="Entity";Ua[Ua.WolframAnswer=3]="WolframAnswer";Ua[Ua.Assistance=4]="Assistance";Ua[Ua.Command=5]="Command";Ua[Ua.Document=6]="Document";Ua[Ua.TryQuery=7]="TryQuery";Ua[Ua.FindInDocument=8]="FindInDocument";Ua[Ua.HelpAction=9]="HelpAction";Ua[Ua.Insights=10]="Insights";Ua[Ua.People=11]="People";Ua[Ua.Image=
12]="Image";Ua[Ua.FirstRunResult=13]="FirstRunResult";Ua[Ua.NoCommandsFoundResult=14]="NoCommandsFoundResult";Ua[Ua.TestResult=15]="TestResult";Ua[Ua.AppsForOffice_Installed=16]="AppsForOffice_Installed";Ua[Ua.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";Ua[Ua.AppsForOffice_Query=18]="AppsForOffice_Query";Ua[Ua.Notes_Onenote=19]="Notes_Onenote";Ua[Ua.Notes_Samsung=20]="Notes_Samsung";Ua[Ua.Notes_Sticky=21]="Notes_Sticky";Ua[Ua.Learning=22]="Learning";Ua[Ua.Feedback=23]="Feedback";
Ua[Ua.Template=24]="Template";Ua[Ua.Addin=25]="Addin";Ua[Ua.OfficeScript=26]="OfficeScript";Ua[Ua.AddinStoreEntry=27]="AddinStoreEntry";Ua[Ua.Unknown=28]="Unknown"})(G||(G={}));Object(J.b)("ResultType",G);var I=d(675),H=d(104),K=d(25),C=d(417);class Y{constructor(Ua,pb){this.bQh=10;this.HU=[];this.Yfa=[];this.x8e=this.w8e=!1;this.ZOb=this.YOb="";this.Utc=pb;this.rb=Ua;this.W$e=Ua.uo}p_b(){!this.w8e&&this.W$e&&this.rb&&I.a.wug()&&(this.YOb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.rb.application,
this.HU=this.X6f(),this.w8e=!0);return this.HU}v$i(){!this.x8e&&this.W$e&&this.rb&&I.a.wug()&&(this.ZOb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.rb.application,this.Yfa=this.X6f(!0),this.x8e=!0);return this.Yfa}zOj(Ua){return Ua.startsWith("TellMeUpsell")||"OpenInClientUpsell"===Ua||"TryOfficeUpsell"===Ua}W7d(Ua){return this.WBj(Ua)||this.zOj(Ua)||H.a.vxg(Ua)?!1:!0}TZh(Ua){Ua=Ua.ControlId;this.W7d(Ua)&&(Ua=this.EDe(Ua),this.cOk(Ua),this.jak(),Array.insert(this.HU,0,new E(Ua,Date.now())),this.YOb.length&&
(Ua=JSON.stringify(this.HU),C.a.instance.setItem(this.YOb,Ua)))}VC(Ua){this.iak();Array.insert(this.Yfa,0,new E(G[Ua],Date.now()));this.ZOb.length&&(Ua=JSON.stringify(this.Yfa),C.a.instance.setItem(this.ZOb,Ua))}X6f(Ua=!1){if(!this.HU.length){var pb=Ua?C.a.instance.getItem(this.ZOb):C.a.instance.getItem(this.YOb);if(!pb||""===pb)return Ua?this.Yfa:this.HU;let Ub=null;try{Ub=JSON.parse(pb)}catch(Bc){this.wmi(Ua),Ub=null}if(!Ub||!Ub.length||10<Ub.length)return Ua?this.Yfa:this.HU;pb=0;for(const Bc of Ub)if(Ua||
this.rb.fUc(Bc.Id)&&this.W7d(Bc.Id))if(Ua?Array.insert(this.Yfa,pb++,Bc):Array.insert(this.HU,pb++,Bc),pb===this.Utc)break}return Ua?this.Yfa:this.HU}yNd(Ua){Ua=this.EDe(Ua);for(const pb of this.HU)if(pb.Id===Ua)return!0;return!1}wmi(Ua=!1){C.a.instance.setItem(Ua?this.ZOb:this.YOb,"")}hEj(Ua){Ua=this.EDe(Ua.ControlId);return this.W7d(Ua)?this.yNd(Ua):!1}cOk(Ua){if(0<this.HU.length){let pb=0;for(const Ub of this.HU){if(Ub.Id===Ua){Array.removeAt(this.HU,pb);break}pb++}}}EDe(Ua){return"Excel"===this.rb.application&&
Ua.startsWith("m_excelWebRenderer_ewaCtl_")?Ua.substr(26,Ua.length):Ua}jak(){this.HU.length===this.Utc&&Array.removeAt(this.HU,this.HU.length-1)}iak(){this.Yfa.length===this.bQh&&Array.removeAt(this.Yfa,this.Yfa.length-1)}WBj(Ua){Ua=Ua.split("|");let pb="";if(6<=Ua.length)pb=Ua[0];else if(3<=Ua.length){if("3"===Ua[0])return!0;pb=Ua[1]}return pb.startsWith("WA")}static createInstance(Ua){let pb=3;K.AFrameworkApplication.fa&&(pb=K.AFrameworkApplication.fa.Ec("TellMeMaxRecommendedResultsToReturn",3));
return new Y(Ua,pb)}}Object(J.a)(Y,"MruControlsManager",null,[1012]);class M{constructor(Ua){this.f1a=Ua}dK(Ua,pb){let Ub;return Ua.TI&&(Ub=this.f1a[Ua.value])?Ub.dK(Ua,pb):(Ub=this.J7f(Ua.value))?Ub.dK(Ub.udk,pb):null}g9i(Ua,pb){if(Ua=this.f1a[Ua])for(const Ub of pb)if(pb=H.a.getParameter(Ub),pb.key===Ua.Jsk)return pb.value;return null}Kfk(Ua){(Ua=this.J7f(Ua))&&Ua.Ifk()}J7f(Ua){const pb=Ua.indexOf(H.a.$2g);return 0<pb?this.f1a[Ua.substring(0,pb)]:null}}Object(J.a)(M,"ParameterizedCommandManager",
null,[1013]);var P=d(297);class T{constructor(Ua,pb){this.Ff=Ua;this.HWa=pb}}Object(J.a)(T,"TellMeQuery",null,[]);var L=d(676);class aa{constructor(Ua,pb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Ua;this.TimeElapsedSinceClick=pb}}Object(J.a)(aa,"CommandClickedEvent",null,[]);var Q=d(123);class ea{constructor(Ua,pb){this.hRh=Ua;this.haa=pb}resultsUpdated(Ua){this.hRh(Q.b(Ua.query)?"":Ua.query.Ff,Ua.uk,Ua.attributes,this.haa,Ua.avb)}}Object(J.a)(ea,"ResultsUpdatedCallback",null,[970]);var ia=
d(17);class ja{constructor(Ua,pb){this.menuModel=Ua;this.resultCount=pb}}Object(J.a)(ja,"GeneratedMenuModel",null,[]);class D{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(J.a)(D,"MenuModel",null,[]);class pa{constructor(Ua,pb,Ub){this.rb=Ua;this.f1a=pb;this.p2a=Ub}wWi(Ua,pb,Ub){const {TellMeActor:Bc}=d(118);let Gc=0;const qd=new D,Td=[];let Vd="";qd.sections=[];let Be=new ia.a;const Id=!!this.rb&&this.rb.kSa;var gb=!!this.rb&&
this.rb.RGb||K.AFrameworkApplication.Aa.gb.RGb;for(const Ic of Ua){Ua=0;Id||(Be=new ia.a);const Wc=new ia.a;let Ib=Ic.displayName;for(const ec of Ic.results){if(0<=ec.value.indexOf(H.a.pMe)){if(ec.TI){var Xb=this.f1a[ec.value];if(Xb&&ec.value.endsWith(H.a.pMe)){if("FindParameterized"!==ec.value&&!gb){const Jb=[];Jb.push(appChrome.actions.setControlLabel(ec.value,Xb.w5i(ec)));Jb.push(appChrome.actions.setButtonCommandValueId(ec.value,Xb.g_i(ec)));appChrome.api.dispatch(Jb)}Xb=ec.value.replace(H.a.pMe,
"");Be.remove(Xb)?Ua--:Wc.add(Xb);Be.add(ec.value);Ua++}}}else switch(ec.type){case 5:Wc.contains(ec.value)||(Be.add(ec.value),Ua++);break;case 7:Be.add(ec.TI);Ua++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:case 27:case 26:Be.add(ec.value),Ua++}13===Ic.groupType&&(Ib=H.a.aja()?0<pb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,pb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:
String.format(CommonUIStrings.l_InsightsButtonText,pb));21===Ic.groupType&&(Ib=CommonUIStrings.l_LearningUILiveText)}Gc+=Ua;""!==Ib&&0<Ua&&(Vd+=" , "+Ua.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Ib+" , ");0<Be.count&&!Id&&(Ua=appChrome.api.menuSection(Be.toArray(),Ic.displayName,null,P.a[Ic.groupType]),Td.push(Ua))}gb=null;0<Gc&&(gb=0<pb.length?1!==Gc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,Gc,pb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,
pb):1!==Gc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Gc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Id?(pb=appChrome.api.menuSection(Be.toArray(),"",null,null),Td.push(pb)):gb+=Vd);Ub&&(this.rb.ria?Bc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(gb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(gb)));qd.sections=Td;return new ja(qd,Gc,[])}static get ISd(){return pa.G0e||(pa.G0e=new ja(Object.assign(new D,
{sections:[]}),0,[]))}}pa.G0e=null;Object(J.a)(pa,"TellMeMenuDefintionGenerator",null,[]);var Z;(function(Ua){Ua[Ua.TellMeControlActivated=0]="TellMeControlActivated";Ua[Ua.TellMeQueryExecuted=1]="TellMeQueryExecuted";Ua[Ua.TellMeResultsRendered=2]="TellMeResultsRendered";Ua[Ua.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(Z||(Z={}));Object(J.b)("PerformanceMarker",Z);var oa;(function(Ua){Ua[Ua.TellMeTimeToRender=0]="TellMeTimeToRender";Ua[Ua.TellMeSessionLength=1]="TellMeSessionLength";
Ua[Ua.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(oa||(oa={}));Object(J.b)("PerformanceMeasure",oa);class Ba{mark(Ua){window.performance.mark(Z[Ua])}measure(Ua,pb,Ub){const {TellMeActor:Bc}=d(118);try{window.performance.measure(oa[Ua],Z[pb],Z[Ub])}catch(Gc){Bc.instance.Jd.onError("TellMePerformance:Measure","error measuring "+oa[Ua])}}jce(Ua,pb,Ub){const {TellMeActor:Bc}=d(118);Bc.instance.Jd.rce(pb,Ub,Ua,this.N6i(Ua))}XCc(Ua){for(const pb of Ua)window.performance.clearMarks(Z[pb])}clearMeasures(Ua){for(const pb of Ua)window.performance.clearMeasures(oa[pb])}N6i(Ua){let pb=
0;(Ua=this.qXi(Ua))&&0<Ua.length&&(pb=Ua[Ua.length-1].duration);return pb}qXi(Ua){return window.performance.getEntriesByName(oa[Ua],"measure")}}Object(J.a)(Ba,"TellMePerformance",null,[]);var Ma=d(439),za=d(438),ka=d(33);class qa{constructor(Ua){this.yWh=Ua}mwe(Ua,pb,Ub){const {TellMeActor:Bc}=d(118);Bc.instance.Jd.l4(pb,za.a.UDb,Ua.data.af.toString(),Math.round(window.performance.now()-Ub),za.a.UDb,!0,Ma.a.Hra);Ua=ka.b(Ua.data.Zd);pb=-1;Ua.Index&&(pb=Ua.Index);Bc.instance.Jd.hXj(pb,this.yWh)}Wcc(Ua,
pb,Ub){const {TellMeActor:Bc}=d(118);Bc.instance.Jd.l4(pb,za.a.UDb,Ua.data.af.toString(),Math.round(window.performance.now()-Ub),za.a.UDb,!1,Ma.a.Hra)}y$i(Ua){if(Ua&&""!==Ua.trim()){const Ub=window.performance.now(),Bc=K.AFrameworkApplication.tvh;var pb={};pb.Text=Ua;pb.IsFileHash="false";pb=ka.c(pb);K.AFrameworkApplication.He.vj(Bc,2,pb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,Gc=>{this.mwe(Gc,Ua.length,Ub)},Gc=>{this.Wcc(Gc,Ua.length,Ub)},null,null,!1,4E3,6E3)}}}Object(J.a)(qa,
"TellMeQueryIndexCallback",null,[]);var Ja=d(146);class xa{constructor(Ua,pb,Ub){this.xml=Ua;this.resultCount=pb;this.WGi=Ub}}Object(J.a)(xa,"GeneratedMenuXml",null,[]);var Ga=d(943),na=d(45);class sa{constructor(Ua,pb){this.Vpc=Ua||{};this.zya=pb}get Feb(){return 5}dK(Ua,pb=null){return this.zya.dK(Ua,pb)||this.sdi(Ua.value)}sdi(Ua){return sa.rdi(Ua,this.Vpc[Ua]||null)}static rdi(Ua,pb=null){Ua=String.format('<ClonedControl Id="{0}" ',Ua);for(let Gc in pb){var Ub=Gc,Bc=pb[Gc];Bc=Bc?na.a.ie(Bc.toString()):
"";Ua+=String.format('{0}="{1}" ',Ub,Bc)}return Ua+"/>"}}Object(J.a)(sa,"CommandMenuItemFactory",null,[967]);var Ha=d(132);class cb{constructor(){this.uLh=CommonUIStrings.l_FindInDocumentText}get Feb(){return 8}dK(Ua){var pb=Ua.TI;Ua=na.a.ie(Ua.value);const Ub=na.a.ie(pb);pb=na.a.ie(String.format(this.uLh,pb));return this.QVi(Ua,Ub,pb)}QVi(Ua,pb,Ub){return Ha.a(Ua,"1540292897",Ub,H.a.jRi,null,pb,Ub,null,null)}}Object(J.a)(cb,"FindInDocumentMenuItemFactory",null,[967]);var Za=d(944),va=d(942),Fa=d(945);
class Ca{get Feb(){return 7}dK(Ua){const pb=Object(m.a)(L.a,Ua);return this.CWi(na.a.ie(Ua.value),pb.id)}CWi(Ua,pb){return Ha.a(pb,"1404166600",Ua,null,null,Ua,Ua,null,null)}}Object(J.a)(Ca,"TryQueryMenuItemFactory",null,[967]);class La{constructor(Ua){this.Rna=[];this.rb=Ua}K2i(Ua){for(const pb of this.Rna)if(pb.Feb===Ua)return pb;return null}XWa(Ua){this.Rna.push(Ua)}CKk(Ua){this.XWa(new sa(this.rb.Dti,Ua));this.XWa(new Fa.a(this.rb.Wek));this.XWa(new Ga.a(this.rb.wYk,this.rb.vYk,this.rb.Vkl,this.rb.Nrj,
this.rb.r9k));this.XWa(new va.InsightsMenuItemFactory);this.XWa(new cb);this.XWa(new Za.a);this.XWa(new Ca)}}Object(J.a)(La,"MenuItemFactoryRegistry",null,[]);var nb=d(158);class Nb{constructor(Ua,pb){this.rb=Ua;this.Edf=new La(this.rb);this.Edf.CKk(pb)}xWi(Ua,pb){let Ub=0;const Bc=[],Gc=[];for(const Td of Ua){Ua=H.a.ZOe;var qd=[];for(const Vd of Td.results){const Be=this.Edf.K2i(Vd.type).dK(Vd,pb);Ua=H.a.ZOe;qd.push(Be);if(13===Vd.type||14===Vd.type)Ua="Menu32";17===Vd.type&&(Ua="MenuTellMeExtended");
Vd.groupType=Td.groupType;Gc.push(Object(m.a)(nb.a,Vd))}Ub=Ub?Ub:qd.length;qd=Ha.c("TellMeDropdownControls",qd);Ua=Ha.e("TellMeDropdownMenuSection",qd,Ua,Td.displayName);Bc.push(Ua)}pb=Ha.f(Bc,"LookupDropdownMenu");return new xa(pb,Ub,Gc)}static get wHc(){return Nb.H0e||(Nb.H0e=new xa(Ha.f([],"LookupDropdownMenu"),0,[]))}}Nb.H0e=null;Object(J.a)(Nb,"TellMeXmlGenerator",null,[]);class Rb{}Rb.Rdk="MRU";Rb.test="Test";Object(J.a)(Rb,"ActionType",null,[]);var Ya=d(371),Qb;(function(Ua){Ua[Ua.Service=
0]="Service";Ua[Ua.Local=1]="Local";Ua[Ua.MRU=2]="MRU";Ua[Ua.TestResult=3]="TestResult";Ua[Ua.Unknown=4]="Unknown"})(Qb||(Qb={}));Object(J.b)("SubResultType",Qb);var bb=d(101);class Bb{constructor(Ua,pb,Ub,Bc,Gc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=Ua;this.IsEnabled=pb;this.ResultType=G[Ub];this.SubResultType=Qb[Bc];this.OptionalData=Gc?bb.a.toJSON(Gc):null}}Object(J.a)(Bb,"ResultInfo",null,[]);var Eb=d(167),tb=d(141),
Yb=d(178);class Tc{constructor(Ua,pb=null){this.Q5e="TellMeWAC.";this.MRh=Ua;this.aXh=pb}Bma(Ua,pb,Ub){pb=Eb.a.dD(pb);Ua=Eb.a.BPd(Ua,this.MRh,this.aXh,Ub,pb);tb.a.Bma(Ua,this.Q5e)}THa(Ua,pb,Ub=0){pb=Eb.a.dD(pb);tb.a.THa(Object.assign(new Yb.a,{name:Ua,dataFields:pb,durationMs:Ub}),this.Q5e)}}Object(J.a)(Tc,"TellMeOtelLogger",null,[985]);var ib=d(113);class Zb{constructor(Ua,pb,Ub,Bc,Gc,qd,Td){this.IU=this.vY=this.pYe=null;this.yna=Ua;this.eqd=pb;this.zoa=Ub;this.$Ka=Bc;this.lya=Gc;this.IOh=qd;this.IU=
Td?Td:new Tc(this.$Ka?v.CuiHelper.oMe:v.CuiHelper.hPe)}get uo(){return this.$Ka}get Ula(){return this.zoa}Mfd(Ua){this.pYe=Ua;switch(Ua){case Ja.a.contextMenu:this.vY=Ja.a.contextMenu;break;default:this.vY=Ja.a.tellMe}}jbi(Ua,pb){this.zoa.y7||(this.zoa.y7=ib.a.create().toString(),this.BAg(Ua,!0,pb))}BZf(Ua,pb=!0){this.zoa.y7&&this.HVj(Ua,pb);this.$Ka&&appChrome.api.updateTellMeCorrelationId("");this.zoa.y7=null}BAg(Ua,pb,Ub){const {TellMeActor:Bc}=d(118),Gc=this.iV(u.a.Vtb);Gc[Ya.a.culture]=this.eqd;
Gc[Ya.a.appName]=this.yna;Gc[Ya.a.context]=Ua;Gc[Ya.a.uTc]=this.lya;Gc[Ya.a.vOj]=this.IOh;Gc[Ya.a.dNj]=Ub;Gc[Ya.a.zHj]=pb;Gc[Ya.a.contentType]=Bc.instance.zFc;this.IU.Bma(u.a.Vtb,Gc,this.pYe);this.$Ka&&appChrome.api.updateTellMeCorrelationId(this.zoa.y7)}HVj(Ua,pb){const Ub=this.iV(u.a.Qpg);Ub[Ya.a.TIi]=Ua;Ub[Ya.a.yHj]=pb;this.IU.THa(u.a.Qpg,Ub)}gXj(Ua,pb,Ub){let Bc=0;!Ub&&0<Ua.length&&(Bc=Ua.trim().split(" ").length);const Gc=this.iV(u.a.query);Gc[Ya.a.query]="!";Gc[Ya.a.Ndb]=pb;Gc[Ya.a.i8g]=Ua.length;
Gc[Ya.a.oyg]=Ub;Gc[Ya.a.pBl]=Bc;this.IU.Bma(u.a.query,Gc,this.vY)}DWj(Ua,pb,Ub,Bc,Gc,qd,Td,Vd=null){const Be=this.iV(u.a.latency);Be[Ya.a.culture]=this.eqd;Be[Ya.a.i8g]=Ua;Be[Ya.a.nzh]=pb;Be[Ya.a.statusCode]=Ub;Be[Ya.a.G_k]=Gc;Be[Ya.a.isSuccess]=qd;Be[Ya.a.ARj]=Td;Vd&&(Be[Ya.a.Qml]=Vd);this.IU.THa(u.a.latency,Be,Bc)}rce(Ua,pb,Ub,Bc){const Gc=this.iV(u.a.performance);Gc[Ya.a.culture]=this.eqd;Gc[Ya.a.mbi]=Z[Ua];Gc[Ya.a.yKi]=Z[pb];Gc[Ya.a.Nuk]=oa[Ub];this.IU.THa(u.a.performance,Gc,Bc)}qXj(Ua,pb){var {TellMeActor:Ub}=
d(118);const {CommandResultsUtility:Bc}=d(325);if(Ua.results.length){var Gc=this.iV(u.a.deh);Gc[Ya.a.a7a]=pb.toString();Gc[Ya.a.groupType]=P.a[Ua.groupType];16===Ua.groupType&&(Gc[Ya.a.HMj]=Ub.instance.Bnc);pb=[];Ub=[];var qd=[];for(const Td of Ua.results)Gc[Ya.a.resultType]||(Gc[Ya.a.resultType]=G[Td.type]),Ua={},25===Td.type&&(Ua.AssetId=Td.TGd),Ub.push(Bc.l3b(Td.value)),pb.push(Td.value),qd.push(new Bb(Td.value,Bc.l3b(Td.value),Td.type,Td.subType,Ua));0<pb.length&&(Gc[Ya.a.WUk]="{"+pb.join(", ")+
"}",Gc[Ya.a.cKi]="{"+Ub.join(", ")+"}",Gc[Ya.a.RUk]=ka.c(qd));this.IU.Bma(u.a.deh,Gc,this.vY)}}RWi(Ua,pb){if(4===Ua)return Rb.Rdk;switch(pb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return G[pb]}mVj(Ua,pb,Ub,Bc,Gc){const qd=this.iV(u.a.click);qd[Ya.a.nzh]=Ua;qd[Ya.a.Lsk]=pb;qd[Ya.a.commandId]=Ub;qd[Ya.a.N3a]=Bc;qd[Ya.a.actionType]=this.RWi(Gc.groupType,Gc.resultType);qd[Ya.a.resultType]=G[Gc.resultType];
qd[Ya.a.ONe]=Qb[Gc.ONe];qd[Ya.a.groupType]=P.a[Gc.groupType];qd[Ya.a.a7a]=Gc.a7a.toString();qd[Ya.a.IRd]=Gc.IRd.toString();qd[Ya.a.resultIndex]=Gc.resultIndex.toString();this.IU.Bma(u.a.click,qd,this.vY)}qVj(Ua,pb){this.zoa.y7||(this.zoa.y7=ib.a.create().toString(),this.BAg("",!1,pb));pb=this.iV(u.a.nQf);pb[Ya.a.Ndb]=Ua;this.IU.THa(u.a.nQf,pb)}KAg(Ua,pb,Ub){if(Ua){if(Ub)for(let Bc in Ub)Ua[Bc]=Ub[Bc];this.IU.THa(u.a.events,Ua,pb)}}KDa(Ua,pb,Ub=null){const Bc=this.iV(u.a.events);Bc[Ya.a.event]=Ua;
this.KAg(Bc,Math.round(pb),Ub)}Y5b(Ua,pb,Ub=null){const Bc=this.iV(u.a.events);Bc[Ya.a.event]=u.a.error;Bc[Ya.a.module]=Ua;Bc[Ya.a.errorMessage]=pb;Bc[Ya.a.message]=pb;this.KAg(Bc,Math.round(window.performance.now()),Ub)}kVj(Ua){const pb=this.iV(u.a.DOf);pb[Ya.a.value]=Ua;pb[Ya.a.Hbd]=this.$Ka;this.IU.Bma(u.a.DOf,pb,this.vY)}KUj(Ua){const pb=this.iV(u.a.Mzf);pb[Ya.a.value]=Ua;pb[Ya.a.Hbd]=this.$Ka;this.IU.Bma(u.a.Mzf,pb,this.vY)}UVj(Ua){const pb=this.iV(u.a.t2f);pb[Ya.a.value]=Ua;pb[Ya.a.Hbd]=this.$Ka;
this.IU.Bma(u.a.t2f,pb,this.vY)}fXj(Ua){const pb=this.iV(u.a.K7g);pb[Ya.a.value]=Ua;pb[Ya.a.Hbd]=this.$Ka;this.IU.Bma(u.a.K7g,pb,this.vY)}ZUj(Ua){const pb=this.iV(u.a.Ljh);pb[Ya.a.value]=Ua;this.IU.Bma(u.a.Ljh,pb,this.vY)}iXj(Ua,pb){const Ub=this.iV(u.a.$7g);Ub[Ya.a.UDb]=Ua;pb&&(Ub[Ya.a.y7]=pb);this.IU.THa(u.a.$7g,Ub)}iV(Ua){return{["SessionID"]:this.zoa.sessionId,["CorrelationID"]:this.zoa.y7,["Time"]:(new Date).getTime(),["Event"]:Ua,["Scenario"]:this.vY}}}Object(J.a)(Zb,"UsageLogger",null,[969]);
var Cc=d(93);class ob{}ob.Callback="action";Object(J.a)(ob,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var cc=d(524),sb=d(78),mb=d(131),Pb=d(479),dc=d(230),mc=d(54),Mb=d(267),Kc=d(69),gc=d(35);d.d(V,"TellMeActor",function(){return rb});class rb{constructor(){this.zya=this.sR=this.Hd=this.jb=this.t5=this.JF=this.Rd=this.Ca=this.Jd=this.NC=this.Zwd=this.vzf=this.iaa=this.rb=null;this.skb=!1;this.Opd=[];this.jYe=[];this.eef=[];this.fef=[];this.P$e=!1;this.Tib=this.p2a=null;this.QNb=this.lya=
!1;this.fuc=!0;this.YO=this.fsc=this.K3e=this.jxd=this.Wdf=null;this.I0=[];this.oKa=this.mjb=this.xfa=null;this.bkb=!1;this.dxd=0;this.Kib=null;this.haa=-1;this.Fdf=0;this.XNb=!1;this.zKa=null;this.kyf=!1;this.zR=null}get zFc(){return this.t5?this.t5.contentType:rb.unknown}get actions(){return this.I0}set actions(Ua){this.I0=Ua}ANc(){return this.Jd?this.Jd.Ula.y7:null}jG(){return this.rb}get hdk(){return this.fuc}get iAl(){return this.Wdf}performance(){return this.NC}get Bnc(){return this.kyf}set Bnc(Ua){this.kyf=
Ua}HF(Ua){const pb=window.performance.now();this.p2a&&!Q.b(Ua)&&(this.p2a(Ua),this.Jd.WG(u.a.HF,window.performance.now()-pb))}initialize(Ua,pb=null,Ub=null,Bc=null,Gc=null,qd=null,Td=null,Vd=null,Be=null,Id=null,gb=null){const {InteractionLogger:Xb}=d(1103),{GroupsPlacementInfo:Ic}=d(1100),{AggregatorResultsProvider:Wc}=d(969);this.rb=Ua;this.lya=!!K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.svb;this.Jd=Bc;if(!Bc){Bc=new y;Bc.sessionId=K.AFrameworkApplication.userSessionId;const Ib=
Mb.a.le(K.AFrameworkApplication.lcid)||Mb.a.W2b;this.Jd=new Xb(new Zb(this.rb.application,Ib.name,Bc,this.rb.uo,this.lya,Ua.Wwa,null),this.rb.Eti,this.rb)}this.zya=new M(this.rb.parameterData);this.vzf=Ub||new Nb(this.rb,this.zya);this.p2a=Td;this.Zwd=this.Zwd||new pa(this.rb,this.rb.parameterData,Td);this.Hd=Cc.FocusManager.instance();this.sR=Y.createInstance(this.rb);this.K3e=new Ic(Ua);this.Ca=Gc||K.AFrameworkApplication.Ta;this.Rd=qd||K.AFrameworkApplication.ue;this.JF=Be;this.iaa=pb;this.zR=
gb;this.NC=new Ba;Be?Be.execute(Ib=>{Ib.isFeatureEnabled(rb.Jkl,!0).then(ec=>{const {AggregatorResultsProvider:Jb}=d(969);this.XNb=ec;this.iaa=this.iaa||Jb.createInstance(this.sR,this.rb,this.zya,this.XNb);return null})}):(this.XNb=!0,this.iaa=this.iaa||Wc.createInstance(this.sR,this.rb,this.zya,this.XNb));this.jb=Vd;this.xfa=Nb.wHc;this.Wdf=new Promise(Ib=>{this.jxd=Ib});Id&&Id.execute(Ib=>{this.t5=Ib});this.rb.uo&&H.a.ywg()&&(Ua=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.rb.application),
appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(Ua,Ua)))}ub(){this.E1h()}E1h(){this.Ca.pa(gc.a.tellMe,Kc.a.frame,Object(h.a)(this,this.tellMe,"tellMe"),96);this.Ca.pa(gc.a.YOe,Kc.a.frame,Object(h.a)(this,this.fKf,"cacheAsyncMenuRefreshFunction"),96);this.Ca.pa(gc.a.bPe,Kc.a.frame,Object(h.a)(this,this.WAg,"logItemExecuted"),96);this.Ca.pa(gc.a.ePe,Kc.a.frame,Object(h.a)(this,this.GAg,"logControlDeactivation"),96);this.Ca.pa(gc.a.dPe,Kc.a.frame,Object(h.a)(this,this.SAg,"logInputFocus"),
96);this.Ca.pa(gc.a.aPe,Kc.a.frame,Object(h.a)(this,this.Vtb,"interactionBegin"),96);this.Ca.pa(gc.a.gPe,Kc.a.frame,Object(h.a)(this,this.Vtb,"interactionBegin"),96);this.Ca.pa(gc.a.cPe,Kc.a.frame,Object(h.a)(this,this.RAg,"logInputBlur"),96);this.Ca.pa(gc.a.fPe,Kc.a.frame,Object(h.a)(this,this.FAg,"logControlActivated"),96);this.Ca.pa(gc.a.njd,Kc.a.frame,Object(h.a)(this,this.n4f,"focusSearchBox"),96);this.Ca.pa(gc.a.XOe,Kc.a.frame,Object(h.a)(this,this.HPf,"constructLiveNotificationForMenu"),96);
this.Ca.pa(gc.a.iPe,Kc.a.frame,Object(h.a)(this,this.C6d,"insertTryQuery"),96);this.Ca.pa(gc.a.vbe,Kc.a.frame,Object(h.a)(this,this.C6d,"insertTryQuery"),96);this.Ca.pa(gc.a.OUd,Kc.a.frame,Object(h.a)(this,this.iva,"openOrInsertUrl"),96);this.Ca.pa(gc.a.PUd,Kc.a.frame,Object(h.a)(this,this.iva,"openOrInsertUrl"),96);this.Ca.pa(gc.a.QUd,Kc.a.frame,Object(h.a)(this,this.iva,"openOrInsertUrl"),96);this.Ca.pa(gc.a.RUd,Kc.a.frame,Object(h.a)(this,this.iva,"openOrInsertUrl"),96);this.Ca.pa(gc.a.SUd,Kc.a.frame,
Object(h.a)(this,this.iva,"openOrInsertUrl"),96);this.Ca.pa(gc.a.Cwe,Kc.a.frame,Object(h.a)(this,this.iva,"openOrInsertUrl"),96);this.Ca.pa(gc.a.Dwe,Kc.a.frame,Object(h.a)(this,this.iva,"openOrInsertUrl"),96);this.Ca.pa(gc.a.Ewe,Kc.a.frame,Object(h.a)(this,this.iva,"openOrInsertUrl"),96);this.Ca.pa(gc.a.Lxe,Kc.a.frame,Object(h.a)(this,this.H2b,"insertMention"),96);this.Ca.pa(gc.a.Mxe,Kc.a.frame,Object(h.a)(this,this.H2b,"insertMention"),96);this.Ca.pa(gc.a.Nxe,Kc.a.frame,Object(h.a)(this,this.H2b,
"insertMention"),96);this.Ca.pa(gc.a.$Oe,Kc.a.frame,Object(h.a)(this,this.v1g,"openFeedback"),96);this.Ca.pa(gc.a.jPe,Kc.a.frame,Object(h.a)(this,this.iva,"openOrInsertUrl"),96);this.Ca.pa(gc.a.PGd,Kc.a.frame,Object(h.a)(this,this.Yvb,"launchAddin"),96);this.Ca.pa(gc.a.QGd,Kc.a.frame,Object(h.a)(this,this.Yvb,"launchAddin"),96);this.Ca.pa(gc.a.RGd,Kc.a.frame,Object(h.a)(this,this.Yvb,"launchAddin"),96);this.Ca.pa(gc.a.kgb,Kc.a.frame,Object(h.a)(this,this.kgb,"showTellMeCoachmark"),96);this.Ca.pa(gc.a.nbe,
Kc.a.frame,Object(h.a)(this,this.mzg,"launchAddinStore"),96)}aKk(Ua){this.fuc=!1;const pb=window.performance.now();Ua.HDa.isCompleted?(this.fuc=!0,this.jxd(!0)):Ua.HR(()=>{this.fuc=!0;this.jxd(!0);this.Jd.WG(u.a.tEi,window.performance.now()-pb)});this.HKk(Ua)}HKk(Ua){dc.a.Zbd(Object(h.a)(this,this.JGi,"dispatcher"));dc.a.sYb([new Pb.a(gc.a.tellMe,Kc.a.frame,96),new Pb.a(gc.a.YOe,Kc.a.frame,96),new Pb.a(gc.a.bPe,Kc.a.frame,96),new Pb.a(gc.a.ePe,Kc.a.frame,96),new Pb.a(gc.a.dPe,Kc.a.frame,96),new Pb.a(gc.a.aPe,
Kc.a.frame,96),new Pb.a(gc.a.gPe,Kc.a.frame,96),new Pb.a(gc.a.cPe,Kc.a.frame,96),new Pb.a(gc.a.fPe,Kc.a.frame,96),new Pb.a(gc.a.njd,Kc.a.frame,96),new Pb.a(gc.a.XOe,Kc.a.frame,96),new Pb.a(gc.a.iPe,Kc.a.frame,96),new Pb.a(gc.a.vbe,Kc.a.frame,96),new Pb.a(gc.a.OUd,Kc.a.frame,96),new Pb.a(gc.a.PUd,Kc.a.frame,96),new Pb.a(gc.a.QUd,Kc.a.frame,96),new Pb.a(gc.a.RUd,Kc.a.frame,96),new Pb.a(gc.a.SUd,Kc.a.frame,96),new Pb.a(gc.a.Cwe,Kc.a.frame,96),new Pb.a(gc.a.Dwe,Kc.a.frame,96),new Pb.a(gc.a.Ewe,Kc.a.frame,
96),new Pb.a(gc.a.Lxe,Kc.a.frame,96),new Pb.a(gc.a.Mxe,Kc.a.frame,96),new Pb.a(gc.a.Nxe,Kc.a.frame,96),new Pb.a(gc.a.$Oe,Kc.a.frame,96),new Pb.a(gc.a.jPe,Kc.a.frame,96),new Pb.a(gc.a.PGd,Kc.a.frame,96),new Pb.a(gc.a.QGd,Kc.a.frame,96),new Pb.a(gc.a.RGd,Kc.a.frame,96),new Pb.a(gc.a.kgb,Kc.a.frame,96),new Pb.a(gc.a.nbe,Kc.a.frame,96)],Ua)}JGi(Ua,pb,Ub,Bc,Gc){if(pb.contextId===Kc.a.frame)switch(Ua){case gc.a.tellMe:return this.tellMe(Ua,pb,Ub,Bc,Gc);case gc.a.YOe:return this.fKf(Ua,pb,Ub,Bc,Gc);case gc.a.bPe:return this.WAg(Ua,
pb,Ub,Bc,Gc);case gc.a.ePe:return this.GAg(Ua,pb,Ub,Bc,Gc);case gc.a.dPe:return this.SAg(Ua,pb,Ub,Bc,Gc);case gc.a.aPe:return this.Vtb(Ua,pb,Ub,Bc,Gc);case gc.a.gPe:return this.restoreFocus(Ua,pb,Ub,Bc,Gc);case gc.a.cPe:return this.RAg(Ua,pb,Ub,Bc,Gc);case gc.a.fPe:return this.FAg(Ua,pb,Ub,Bc,Gc);case gc.a.njd:return this.n4f(Ua,pb,Ub,Bc,Gc);case gc.a.XOe:return this.HPf(Ua,pb,Ub,Bc,Gc);case gc.a.iPe:case gc.a.vbe:return this.C6d(Ua,pb,Ub,Bc,Gc);case gc.a.OUd:case gc.a.PUd:case gc.a.QUd:case gc.a.RUd:case gc.a.SUd:case gc.a.Cwe:case gc.a.Dwe:case gc.a.Ewe:case gc.a.jPe:return this.iva(Ua,
pb,Ub,Bc,Gc);case gc.a.Lxe:case gc.a.Mxe:case gc.a.Nxe:return this.H2b(Ua,pb,Ub,Bc,Gc);case gc.a.$Oe:return this.v1g(Ua,pb,Ub,Bc,Gc);case gc.a.PGd:case gc.a.QGd:case gc.a.RGd:return this.Yvb(Ua,pb,Ub,Bc,Gc);case gc.a.kgb:return this.kgb(Ua,pb,Ub,Bc,Gc);case gc.a.nbe:return this.mzg(Ua,pb,Ub,Bc,Gc)}return 2}n4f(Ua,pb,Ub){if(1===Ub)return 32;this.pmh();Ua=!1;(this.rb.Wwa||this.lya)&&(pb=document.getElementById("SearchButton"))&&pb.click();if(!this.rb.Wwa&&this.lya)for(pb=document.getElementsByClassName("ms-suiteux-search-box"),
Ub=0;Ub<pb.length;Ub++){const Bc=pb[Ub].querySelector("input[type=search]");Bc&&(Ua=Cc.FocusManager.Dr(Bc))}else Ua=Cc.FocusManager.Dr($get(this.rb.uo?v.CuiHelper.oMe:v.CuiHelper.hPe));this.QNb=!0;return Ua?32:8}C6d(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;if(Q.b(Gc))return this.Jd.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.pmh();Ua=Gc.CommandValueId;pb=this.rb.uo?v.CuiHelper.oMe:v.CuiHelper.hPe;this.rb.uo&&!Q.b(Gc[cc.a.xea])&&(Gc[cc.a.xea]=!1);if(Ua){if(this.rb.uo)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Ua)),
this.zKa=[19],32;if(Gc=$get(pb))Gc.value=Ua}return Cc.FocusManager.Dr($get(pb))?32:8}pmh(){this.Hd.oX(this.rb.Wwa||this.lya?this.rb.YOc:this.rb.MHa,!1)}MWi(Ua,pb){switch(Ua){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,pb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,pb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,pb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
pb)}return pb}HPf(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;if(Q.b(Gc))return this.Jd.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Ua=this.xfa?this.xfa.resultCount:0;Gc.Value=1!==Ua?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Ua):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.xfa)for(const qd of this.xfa.WGi)Gc=Object(e.a)(L.a,qd)?qd.id:na.a.replaceAll(qd.value,'"',""),(Gc=$get(Gc+"-"+H.a.ZOe))&&mb.a.lO(Gc,mb.a.vs,
na.a.ie(this.MWi(qd.groupType,Gc.innerText)));return 32}fKf(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;if(Q.b(Gc))return this.Jd.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.Kib=new sb.a(2,1,0,()=>{Gc[ob.Callback]()},97);this.xfa&&this.Rd.Gb(this.Kib);return 32}WAg(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;if(Q.b(Gc))return this.Jd.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;Gc.CloseAllMenus&&(Ua=void 0===Gc.ParentControlId||null===Gc.ParentControlId?
"<NA>":Gc.ParentControlId,pb=this.Tib?this.Tib[Gc.ControlId]:null,!pb&&this.Tib&&"<NA>"!==Ua&&(pb=this.Tib[Ua]),pb||(pb=this.skb&&this.sR.hEj(Gc),pb=this.nFi(pb,Gc.ControlId),pb=new A(pb,28,4,-1,-1,-1),this.Jd.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Gc.ControlId+" determined group:"+P.a[pb.groupType])),this.Jd.vik(Gc.ControlId,Ua,Gc.CommandId,Gc.CloseAllMenus,pb),this.zya.Kfk(Gc.ControlId),Gc.Location!==Ja.a.contextMenu&&(this.sR.TZh(Gc),this.sR.VC(pb.resultType),this.rb.Ngd&&
this.iaa.c0h(Gc.CommandId)));return 32}GAg(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;I.a.wOj()&&(new qa(this.ANc())).y$i(this.mjb);Ua=this.mjb;pb=this.haa;Ub=this.Jd.kqc;if(Q.b(Gc))return this.Jd.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Gc=Gc.UILocation;Ua&&0<Ua.length&&this.XNb&&H.a.yKe(this.rb)&&this.rb.TTc&&19!==Gc&&pb>Ub&&!this.rb.eH&&(this.Jd.uce(Ua),this.Jd.WHe(pb));this.Jd.zTk();this.rb.emd&&19!==Gc&&(this.NC.mark(3),this.NC.measure(1,0,3),this.NC.measure(2,2,3),this.NC.jce(0,
1,2),this.NC.jce(2,2,3),this.NC.jce(1,0,3),this.NC.XCc([0,1,2,3]),this.NC.clearMeasures([0,2,1]));this.Jd.Hik(window.performance.now()-this.dxd);this.rb.uo&&(this.oKa=null,this.Jd.TYg());this.QNb=this.bkb=!1;this.mjb="";return 32}SAg(Ua,pb,Ub){if(1===Ub)return 32;this.Jd.UYg(w(pb),this.QNb);return 32}RAg(Ua,pb,Ub){if(1===Ub)return 32;this.Jd.TYg();this.bkb=!1;return 32}FAg(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;this.YO=null;Gc&&(this.YO=Gc);this.rb.emd&&(Q.b(this.YO)||this.YO.Location!==Ja.a.contextMenu)&&
this.NC.mark(0);this.Jd.Mfd(Q.b(this.YO)||Q.b(this.YO.Location)?Ja.a.unknown:this.YO.Location);this.Jd.Gik(this.Fdf,this.QNb);this.bkb||this.cdc();return 32}JRf(Ua,pb){const Ub=[],Bc=Date.now();for(let Gc of Ua)Ua=(Bc-Gc.timeStamp)/1E3,Ua=H.a.UQe(Ua),Array.add(Ub,new aa(pb?Gc.commandId:Gc.controlId,Ua));return Ub}iSf(Ua=!1){var pb=Ua?this.sR.v$i():this.sR.p_b();Ua=[];const Ub=Date.now();for(const Bc of pb)pb=(Ub-Bc.TimeStamp)/1E3,pb=H.a.UQe(pb),Array.add(Ua,new aa(Bc.Id,pb));return Ua}cdc(){if(!this.bkb){this.skb=
this.bkb=!0;""!==this.rb.xih&&K.AFrameworkApplication.Qj(this.rb.xih);if(!this.P$e){this.P$e=!0;const Ua={};Ua.IsMLREnabled=this.rb.OIj;Ua.IsReactRibbonEnabled=this.rb.uo;Ua.IsSharedHeaderEnabled=!!K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.iN;Ua.IsSearchUxEnabled=this.lya;Ua.IsTellMeInHeaderEnabled=this.rb.Wwa;Ua.IsGoLocalEnv=H.a.Atg();Ua.IsSovereignEnvironment=H.a.L8a();Ua.IsTellMeServiceResultsEnabled=H.a.yKe(this.rb);Ua.IsSubstrateProviderEnabled=H.a.xKe(this.rb);Ua.ShouldFetchTokens=
!!K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.gb.QGb;Ua.IsSerpletEnabled=H.a.aja();Ua.FirstOnClickTimeInMS=Math.round(window.performance.now());Ua.IsHeaderHidden=K.AFrameworkApplication.hideHeader||K.AFrameworkApplication.LP;Ua.IsSearchInHeaderHidden=K.AFrameworkApplication.kPc;void 0!==window.performance.timing&&null!==window.performance.timing&&(Ua.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Ua.IsFindWithMatchesEnabled=this.rb.K2f;Ua.HelpShowsTopSearchResult=
this.rb.ikc;Ua.HelpShowsNumberOfMatches=this.rb.hkc;K.AFrameworkApplication.fa&&(Ua.UiHost=K.AFrameworkApplication.fa.Ha("UiHostIntegrationType"));this.Jd.BXj(JSON.stringify(Ua))}this.Opd=this.JRf(n.a.instance.oLb,!1);this.jYe=this.JRf(n.a.instance.Sib,!0);this.eef=this.iSf();this.fef=this.iSf(!0);this.Jd.cdc()}}Vtb(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;if(Q.b(Gc))return this.Jd.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(mc.a.PV)return 32;this.dxd=window.performance.now();
this.cdc();Ua=new ea(Object(h.a)(this,this.Jda,"onRequestCompleted"),0);this.haa++;this.Jd.beginQuery("",this.haa,this.skb);this.xfa=Nb.wHc;this.oKa=pa.ISd;if(this.iaa)rb.instance.actions=[],this.iaa.qD(new T("",this.haa),Ua,this.rb.uo);else this.Jd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Kib&&this.Rd.Gb(this.Kib);return 32}restoreFocus(Ua,pb,Ub){if(1===Ub)return 32;this.Hd.s4(this.rb.Wwa||this.lya?this.rb.YOc:this.rb.MHa,!1);return 32}tellMe(Ua,pb,Ub,
Bc,Gc){if(1===Ub)return 32;if(Q.b(Gc))return this.Jd.onError("TellMeActor:TellMe","actiondata comes null"),16;this.YO=Gc;this.Jd.Mfd(Q.b(this.YO.Location)?Ja.a.unknown:this.YO.Location);Ua=this.YO.Value;this.rb.uo||Ua&&""!==Ua.trim()?(!this.oKa&&this.rb.uo&&(this.Jd.UYg(w(pb),this.QNb),this.cdc()),this.sNi(Ua,this.YO.Location),this.YO.PopulationXML=this.xfa.xml):this.skb?this.YO.PopulationXML=this.xfa.xml:(this.YO.PopulationXML=Nb.wHc.xml,this.oKa=pa.ISd,this.mjb="");return 32}sNi(Ua,pb){this.dxd=
window.performance.now();this.rb.emd&&pb!==Ja.a.contextMenu&&this.NC.mark(1);this.rb.uo&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Ua));Ua&&0<Ua.trim().length&&(this.skb=!1);this.rb.kMi();pb=Q.b(pb)?Ja.a.tellMe:pb;if(Ua!==this.mjb||this.rb.uo){this.haa++;this.Jd.beginQuery(Ua,this.haa,this.skb);const Ub=new T(Ua,this.haa),Bc=new ea(Object(h.a)(this,this.Jda,"onRequestCompleted"),this.haa);this.xfa=Nb.wHc;this.oKa=pa.ISd;if(this.iaa)rb.instance.actions=[],this.iaa.qD(Ub,Bc,this.rb.uo,
pb,this.zKa),this.zKa=null;else this.Jd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Fdf=this.haa;this.mjb=Ua}}Lul(Ua){if(this.rb.uo){var pb=appChrome.selectors.getActiveControlStates();if(pb=Object(m.a)(Object,pb[Ua.value])){Ua.label=pb.label;let Ub=null;"description"in pb&&(Ub=pb.description);Ub&&Object.getType(Ub)===String?Ua.description=Ub:"secondaryText"in pb?Ua.description=pb.secondaryText:"fullDescriptionLabel"in pb&&(Ua.description=pb.fullDescriptionLabel)}}}Yvk(Ua){this.Tib=
{};let pb=0,Ub=0;for(const Bc of Ua){Ua=0;for(const Gc of Bc.results)this.Tib[Gc.value]=new A(Gc.groupType,Gc.type,Gc.subType,pb,Ua,Ub),Ua++,Ub++,Gc.label||5!==Gc.type||this.Lul(Gc);0<Ua&&pb++}}BCb(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;if(Q.b(Gc))return this.Jd.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(Ua=Gc.CommandValueId)&&window.open(Ua,"_blank");return 32}H2b(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;if(Q.b(Gc))return this.Jd.onError("TellMeActor:InsertMention","actiondata comes null"),
16;Ua=Gc.UILocation;let qd;Gc=Gc.CommandValueId;try{qd=ka.a(Gc)}catch(Td){return this.Jd.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Q.b(qd)?(this.Jd.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Q.b(this.fsc)?(this.Jd.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Ua?(this.Jd.onError("TellMeActor:InsertMention","location "+Ua+" is unexpected"),16):this.fsc.H2b(qd.displayName,qd.email,qd.userId)?
32:(this.Jd.onError("TellMeActor:InsertMention","mention is not inserted"),16)}iva(Ua,pb,Ub,Bc,Gc){return 1===Ub?32:Q.b(Gc)?(this.Jd.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Gc.UILocation?this.Qzj(Ub,Gc):this.BCb(Ua,pb,Ub,Bc,Gc)}v1g(Ua,pb,Ub,Bc,Gc){if(1===Ub)return 32;if(Q.b(Gc))return this.Jd.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.zR&&window.setTimeout(()=>{this.zR.execute(qd=>{qd.hHb("TellMeSurvey",null)})},rb.FPi);return 32}Qzj(Ua,pb){if(1===
Ua)return 32;if(Q.b(pb))return this.Jd.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Q.b(this.fsc))return this.Jd.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Ua=pb.CommandValueId;return Q.b(Ua)?(this.Jd.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.fsc.insertHtmlText(Ua)?32:(this.Jd.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Jda(Ua,pb,Ub,Bc,Gc){Ub=window.performance.now();this.Yvk(pb);this.Jd.T2k(pb);this.rb.uo?(this.oKa=
this.Zwd.wWi(pb,Ua,Gc),this.rb.ria?(this.I0.push(appChrome.actions.updateTellMeSearchResults(this.oKa.menuModel,Ua,Gc)),appChrome.api.dispatch(this.I0)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.oKa.menuModel,Ua,Gc)),this.rb.emd&&this.bkb&&(Q.b(this.YO)||this.YO.Location!==Ja.a.contextMenu)&&(this.NC.mark(2),this.NC.measure(0,1,2))):this.xfa=this.vzf.xWi(pb,this.Jd.Ula);this.Kib&&this.Rd.Gb(this.Kib);Gc={};Gc.GroupsCount=pb.length;Gc.QueryID=Bc;Gc.QueryLength=Ua.length;
this.Jd.WG(u.a.Kzi,window.performance.now()-Ub,Gc)}nFi(Ua,pb){return pb.startsWith(this.rb.uo?H.a.wRe:H.a.Mkd)?5:Ua?4:"bSearchHelp"===pb||pb.startsWith("GetHelpFromTellMe")?8:"bInsights"===pb||pb.startsWith("SmartLookupFromTellMe")?13:pb===this.rb.J2f?2:0}VC(Ua,pb){this.iaa&&this.iaa.VC(Ua,pb)}mzg(Ua,pb,Ub,Bc,Gc){return this.Ca.Ka(gc.a.nzg,2,Gc)}Yvb(Ua,pb,Ub,Bc,Gc){({AddinResultsProvider:Ua}=d(690));Gc=Gc.CommandValueId;if(Q.a(Gc))return this.Jd.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),
16;if(!Ua.S2a[Gc])return this.Jd.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Gc+" doesn't not exist in entitlements"),16;Ua=d(690).AddinResultsProvider.S2a[Gc];pb={};pb.solutionId=Ua.id;pb.version=Ua.appVersion;pb.storeType=Ua.storeType;pb.storeId=Ua.storeId;pb.assetId=Ua.assetId;pb.assetStoreId=Ua.assetStoreId;pb.displayName=Ua.displayName;pb.targetType=Ua.targetType;pb.height=Ua.height;pb.width=Ua.width;Ua=this.Ca.Ka(gc.a.Lmg,2,pb);if(32!==Ua)this.Jd.onError("TellMeActor:LaunchAddin",
"CommonCommands.InsertOfficeAddin failed. Response: "+Ua+". AssetId: "+Gc);return Ua}kgb(){if(!Q.b(this.zR))for(let Ua of n.a.instance.Sib){if("ShowContextMenuWithFloatie"===Ua.commandId)return this.zR.execute(pb=>{pb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(Ua.commandId&&-1===Ua.commandId.indexOf("Tab"))break}return 8}static get instance(){return rb.Ja||(rb.Ja=new rb)}}rb.Ja=null;rb.Jkl="mso_tellMeService";rb.unknown="Unknown";rb.FPi=500;Object(J.a)(rb,"TellMeActor",null,[])},
1200:function(J,V,d){d.r(V);var h=d(0),e=d(25),m=d(68),n=d(375),v=d(910),A=d(93),w=d(55),y=d(1157),u=d(13),E=d(1192),G=d(89),I=d(65),H=d(168),K=d(933),C=d(82);class Y{static get jg(){return C.a.EB(Y.Zn,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Y.Zn="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(h.a)(Y,"InsertSymbolsDialogHtml",null,[]);var M=d(32),P=d(210);class T extends E.a{constructor(Na,qb,wb){super();this.Kbf=this.Ooa=this.sMa=null;this.Ptd=0;this.Ca=Na;this.Hd=qb;this.cza=wb;this.Re(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Re(0,CommonUIStrings.l_DialogClose);this.EU=!1;this.jg=Y.jg;this.kg="InsertSymbolsDialog"}dispose(){0<T.HDd&&n.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.Ptd,T.HDd);T.o_e++;
n.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",T.o_e);this.Ca=this.cza=null;super.dispose()}O4(){this.pj(Box4Intl.Box4Strings.L_SymbolSingle,Object(u.a)(this,this.Nzj,"insertSymbolsDialogHandler"),null);this.Ptd=0;T.t_e++;n.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",T.t_e);const Na=this.g1d("symbol_d_"+T.pOb);Na&&Na.focus()}hide(){var Na=document.getElementById("symbolsContainer");if(Na&&(Na=Na.getElementsByTagName("a")))for(let qb=0;qb<
Na.length;qb++)G.a.removeHandler(Na[qb],I.a.focus,Object(u.a)(this,this.muh,"symbolFocusHandler"));super.hide()}Nzj(Na){1===Na?(this.sve("symbol_d_"+T.pOb),this.Hd.oX(this.lK,!0),this.Hd.Zk().qj.fE(this.DC),this.DC.focus()):this.hide()}get Wvb(){return T.ecf}set Wvb(Na){T.ecf=Na}get Svb(){return T.Sbf}set Svb(Na){T.Sbf=Na}Wua(){super.Wua();var Na=document.getElementById("symbolsContainer");if(Na&&(K.a.xfd(Na,this.cza.Rdi(),"InsertSymbolsDialog"),Na=Na.getElementsByTagName("a")))for(let qb=0;qb<Na.length;qb++)G.a.addHandler(Na[qb],
I.a.focus,Object(u.a)(this,this.muh,"symbolFocusHandler"))}A6(){const Na=document.getElementById("symbolsContainer");Na&&(this.sMa||(this.sMa=Object(u.a)(this,this.Mil,"symbolClickHandler"),this.Vm.ob(I.a.click,Na,this.sMa),this.Vm.ob(I.a.doubleClick,Na,this.sMa)),this.Ooa||(this.Ooa=Object(u.a)(this,this.Oil,"symbolKeyHandler"),this.Ig.ob(I.a.eg,Na,this.Ooa),this.Ig.ob(I.a.Cx,Na,this.Ooa),this.Ig.ob(I.a.ol,Na,this.Ooa)));super.A6()}pqa(){const Na=document.getElementById("symbolsContainer");Na&&(this.sMa&&
(this.Vm.xb(I.a.click,Na,this.sMa),this.Vm.xb(I.a.doubleClick,Na,this.sMa),this.sMa=null),this.Ooa&&(this.Ig.xb(I.a.eg,Na,this.Ooa),this.Ig.xb(I.a.Cx,Na,this.Ooa),this.Ig.xb(I.a.ol,Na,this.Ooa),this.Ooa=null));super.pqa()}Qnk(Na){this.qmh("symbol_d_"+T.pOb,!1);T.pOb=parseInt(Na.substr(Na.lastIndexOf("_")+1));this.qmh(Na,!0);if(Na=document.getElementById("SymbolNameValueLabel")){const qb=this.uNc(T.pOb);Na.innerText=qb.altText}}uNc(Na){const qb=this.cza.ulc.Jid.value,wb=P.a(qb);return qb[wb[Na]]}muh(Na){if(Na.target!==
this.Kbf){const qb=this.Hd.Zk();qb&&qb.qj&&(qb.qj.fE(Na.target),this.Kbf=Na.target)}this.Qnk(Na.target.id)}Mil(Na){const qb=Na.Fc;if("a"!==qb.tagName.toLowerCase())return!1;Na.eventName===I.a.doubleClick&&this.sve(qb.id);this.Hd.oX(this.lK,!0);this.Hd.Zk().qj.fE(qb);qb.focus();return!0}Oil(Na){var qb=Na.Fc;if("a"!==qb.tagName.toLowerCase())return!1;const wb=parseInt(qb.id.substr(qb.id.lastIndexOf("_")+1));if(Na.lc.ctrlKey||Na.lc.altKey||Na.lc.keyCode>=H.a.$Jb&&Na.lc.keyCode<=H.a.MJa)return!1;if(Na.eventName===
I.a.eg){Na=Na.lc.keyCode;let jc=-1;Na===Sys.UI.Key.enter?(this.sve(qb.id),this.Hd.oX(this.lK,!0),this.Hd.Zk().qj.fE(qb),qb.focus()):Na===Sys.UI.Key.up?jc=wb-15:Na===Sys.UI.Key.down?jc=wb+15:Na===Sys.UI.Key.left?jc=e.AFrameworkApplication.isRtl?wb+1:wb-1:Na===Sys.UI.Key.right&&(jc=e.AFrameworkApplication.isRtl?wb-1:wb+1);0<=jc&&(qb=this.g1d("symbol_d_"+jc))&&qb.focus()}return!0}sve(Na){this.Ptd++;T.HDd++;Na=parseInt(Na.substr(Na.lastIndexOf("_")+1));const qb=this.uNc(Na),wb={};wb.SourceControlId="symbol_"+
Na+"_"+qb.Iid;this.Ca.Ka(M.a.oRa,2,wb);n.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Na)}g1d(Na){const qb=document.getElementById("symbolsContainer");return qb?qb.querySelector("#"+Na):null}qmh(Na,qb){(Na=this.g1d(Na))&&(qb?Na.setAttribute("selected","true"):Na.removeAttribute("selected"))}}T.pOb=0;T.ecf=null;T.Sbf=null;T.t_e=0;T.o_e=0;T.HDd=0;Object(h.a)(T,"InsertSymbolsDialog",E.a,[]);var L=d(42),aa=d(50),Q=d(38),ea=d(180),ia=d(112);class ja{constructor(Na,qb,
wb,jc,Qc,Cd,Ld,ie){this.Ca=Na;this.FJ=qb;this.UVh=new y.a(Object(u.a)(this,this.wej,"getSymbolsDropDownMenuProps"));this.VVh=new y.a(Object(u.a)(this,this.h1d,"getSymbolsDropDownXml"));this.MCd=jc.ulc.Jid;this.jk=wb;this.cza=jc;this.LC=Qc;this.AO=Cd;this.Pc=Ld;this.nm=ie}wej(){return this.cza.Cei()}h1d(){return this.cza.build()}ub(){this.Ca.pa(M.a.nad,Q.a.application,Object(u.a)(this,this.nad,"queryInsertSymbols"),96);this.Ca.xa(M.a.jDb,Q.a.view,Object(u.a)(this,this.jDb,"populateSymbolsDropDown"));
this.Ca.xa(M.a.nOe,Q.a.view,Object(u.a)(this,this.nuh,"symbolsDropDownOpenHandler"));this.Ca.xa(M.a.vBe,Q.a.view,Object(u.a)(this,this.P8g,"querySymbolPositionHandler"));this.Ca.xa(M.a.oRa,Q.a.view,Object(u.a)(this,this.ICa,"insertSymbolViewHandler"));this.Ca.xa(M.a.jDb,Q.a.Lf,Object(u.a)(this,this.jDb,"populateSymbolsDropDown"));this.Ca.xa(M.a.nOe,Q.a.Lf,Object(u.a)(this,this.nuh,"symbolsDropDownOpenHandler"));this.Ca.xa(M.a.vBe,Q.a.Lf,Object(u.a)(this,this.P8g,"querySymbolPositionHandler"));this.Ca.xa(M.a.oRa,
Q.a.Lf,Object(u.a)(this,this.Mzj,"insertSymbolHandler"));this.Ca.$d(M.a.jDb,1124);this.Ca.$d(M.a.nOe,1036);this.Ca.$d(M.a.vBe,1124);this.Ca.$d(M.a.oRa,1036);e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&(this.Ca.xa(M.a.g6d,Q.a.view,Object(u.a)(this,this.lqh,"showInsertMoreSymbolsDialogHandler")),this.Ca.xa(M.a.g6d,Q.a.Lf,Object(u.a)(this,this.lqh,"showInsertMoreSymbolsDialogHandler")),this.Ca.$d(M.a.g6d,1124))}P8g(Na,qb,wb,jc,Qc){if(1===wb)return 32;Na=this.cza.j3g(Qc);
Na=String.format(this.cza.Nil,Na.character);Qc[v.a.InnerHTML]=Na;Qc[v.a.On]=!1;return 32}ICa(Na,qb,wb,jc,Qc){if(({Df:Na,selected:wb,ICa:ie}=this.oUf(qb,wb)).returnValue)return ie;var Cd=L.SelectionEditor.Kg(wb);let Ld=!0;wb=8;var ie=this.jk.je(15);ie.fd(Na.rg);Cd||(wb=this.Ca.ii(qb,M.a.FAa,2,!0,jc,null),qb=32===wb,n.ULS.shipAssertTag(6407387,348,qb,"DeleteForReplace did not succeed. Response is {0}",wb),Ld=qb);Ld&&(qb=Na.Eb.Dj,Cd=L.SelectionEditor.Kg(qb),n.ULS.shipAssertTag(6407388,348,Cd,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
qb.contextId),wb=8,Cd&&(wb=this.Ca.ii(qb,M.a.oRa,2,!1,jc,Qc),n.ULS.shipAssertTag(6407389,348,32===wb,"Insertion at IP context did not succeed. Response is {0}",wb),32===wb&&A.FocusManager.instance().Bf(Na.RH)));ie.dispose();return wb}oUf(Na,qb){let wb,jc;wb=null;Na.view.Hh&&(wb=Na.view);jc=null;return wb&&wb.Eb?(jc=wb.Eb.Dj)?this.AO.ga(14)&&this.LC.Z3a(jc)?{returnValue:!0,Df:wb,selected:jc,ICa:8}:wb.Eb.Oa.xG||this.nm&&this.nm.instance&&this.nm.instance.LV(jc)||L.SelectionEditor.fRc(Na.MD)?{returnValue:!0,
Df:wb,selected:jc,ICa:2}:1===qb?{returnValue:!0,Df:wb,selected:jc,ICa:32}:{returnValue:!1,Df:wb,selected:jc,ICa:32}:{returnValue:!0,Df:wb,selected:jc,ICa:2}:(ia.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Na.toString()),{returnValue:!0,Df:wb,selected:jc,ICa:8})}Mzj(Na,qb,wb,jc,Qc){if(1===wb)return 32;if(L.SelectionEditor.fRc(qb))return 2;Na=this.cza.j3g(Qc);jc.pP=Na.index;jc=this.FJ.Kc(qb.node);wb=jc.mc(11);
n.ULS.shipAssertTag(6379466,324,wb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",ea.a[qb.node.type]);wb=this.jk.je(15);wb.Tx(jc);ja.characterPropertiesEditor.replaceTextRange(qb,Na.character,!0,!1);qb=aa.SelectionFactory.Jg(jc.currentNode,qb.Qa+1);this.Pc.setSelection(qb);wb.dispose();return 32}jDb(Na,qb,wb,jc,Qc){if(1===wb)return 32;e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.gb.Mp?Qc.MenuItems=this.UVh.value:Qc.PopulationXML=this.VVh.value;return 32}nuh(Na,
qb,wb){({ICa:Na}=this.oUf(qb,wb));return Na}lqh(Na,qb,wb){2===wb&&(new T(this.Ca,A.FocusManager.instance(),w.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).O4();return 32}nad(){return 32}static get characterPropertiesEditor(){return ja.Vg||(ja.Vg=w.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Na){ja.Vg=Na}}ja.Vg=null;Object(h.a)(ja,"SymbolsActor",null,[770]);class D{constructor(Na,qb){this.Iid=Na;this.altText=qb}}Object(h.a)(D,"Symbol",null,[]);
class pa{constructor(){this.LCd=null;this.MCd=new y.a(pa.tPd)}get Jid(){return this.MCd}n5i(Na){this.LCd||(this.LCd=P.a(this.MCd.value));return Array.indexOf(this.LCd,Na)}static tPd(){const Na={};Na["\u2022"]=new D("\u2022",Box4Intl.Box4Strings.L_Bullet);Na["\u20ac"]=new D("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Na["\u00a3"]=new D("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Na["\u00a5"]=new D("\u00a5",Box4Intl.Box4Strings.L_YenSign);Na["\u00a9"]=new D("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);
Na["\u00ae"]=new D("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Na["\u2122"]=new D("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Na["\u00b1"]=new D("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Na["\u2260"]=new D("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Na["\u2264"]=new D("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Na["\u2265"]=new D("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Na["\u00f7"]=new D("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Na["\u00d7"]=new D("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);
Na["\u221e"]=new D("\u221e",Box4Intl.Box4Strings.L_Infinity);Na["\u00b5"]=new D("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Na["\u03b1"]=new D("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Na["\u03b2"]=new D("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Na["\u03c0"]=new D("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Na["\u03a9"]=new D("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Na["\u03a3"]=new D("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Na["\u00b0"]=new D("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);
Na["\u0394"]=new D("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Na["\u263a"]=new D("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Na["\u2665"]=new D("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Na["\u20b9"]=new D("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Na["\u00bf"]=new D("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Na["\u00a1"]=new D("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Na["\u2014"]=new D("\u2014",Box4Intl.Box4Strings.L_EmDash);Na["\u2026"]=new D("\u2026",
Box4Intl.Box4Strings.L_HorizontalEllipsis);Na["\u00c0"]=new D("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Na["\u00c1"]=new D("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Na["\u00c2"]=new D("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Na["\u00c3"]=new D("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Na["\u00c4"]=new D("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Na["\u00c5"]=new D("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);
Na["\u00c6"]=new D("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Na["\u00c7"]=new D("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Na["\u00c8"]=new D("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Na["\u00c9"]=new D("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Na["\u00ca"]=new D("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Na["\u00cb"]=new D("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Na["\u00cc"]=
new D("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Na["\u00cd"]=new D("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Na["\u00ce"]=new D("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Na["\u00cf"]=new D("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Na["\u00d1"]=new D("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Na["\u00d2"]=new D("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Na["\u00d3"]=new D("\u00d3",
Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Na["\u00d4"]=new D("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Na["\u00d5"]=new D("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Na["\u00d6"]=new D("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Na["\u00d9"]=new D("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Na["\u00da"]=new D("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Na["\u00db"]=new D("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);
Na["\u00dc"]=new D("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Na["\u00df"]=new D("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Na["\u00e0"]=new D("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Na["\u00e1"]=new D("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Na["\u00e2"]=new D("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Na["\u00e3"]=new D("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Na["\u00e4"]=new D("\u00e4",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Na["\u00e5"]=new D("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Na["\u00e6"]=new D("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Na["\u00e7"]=new D("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Na["\u00e8"]=new D("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Na["\u00e9"]=new D("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Na["\u00ea"]=new D("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);
Na["\u00eb"]=new D("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Na["\u00ec"]=new D("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Na["\u00ed"]=new D("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Na["\u00ee"]=new D("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Na["\u00ef"]=new D("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Na["\u00f1"]=new D("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Na["\u00f2"]=new D("\u00f2",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Na["\u00f3"]=new D("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Na["\u00f4"]=new D("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Na["\u00f5"]=new D("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Na["\u00f6"]=new D("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Na["\u00f9"]=new D("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Na["\u00fa"]=new D("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);
Na["\u00fb"]=new D("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Na["\u00fc"]=new D("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Na["\u00ff"]=new D("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Na["\u011e"]=new D("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Na["\u011f"]=new D("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Na["\u0130"]=new D("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Na["\u0131"]=
new D("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Na["\u0152"]=new D("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Na["\u0153"]=new D("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Na["\u015e"]=new D("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Na["\u015f"]=new D("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Na["\u0178"]=new D("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Na}}Object(h.a)(pa,"SymbolsLoader",
null,[766]);var Z=d(45),oa=d(346),Ba=d(288),Ma=d(220),za=d(772),ka=d(1188),qa=d(132),Ja=d(72);class xa{constructor(Na){this.WVh=Na}get ulc(){return this.WVh}get Nil(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}j3g(Na){Na=Na.SourceControlId.split("_");const qb={};2===Na.length?(qb.character=Na[1],qb.index=this.ulc.n5i(qb.character)):(qb.character=Na[2],qb.index=parseInt(Na[1]));return qb}Cei(){return this.heg()}build(){return this.h1d()}Rdi(){const Na=
new Sys.StringBuilder;Na.append('<table class="moreSymbolsTable">');const qb=this.ulc.Jid.value,wb=P.a(qb);let jc=0;for(;jc<wb.length;){jc%15||Na.append('<tr role="presentation">');const Qc=qb[wb[jc]];Na.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',"symbol_d_"+jc,Z.a.dRa(Qc.Iid),Z.a.dRa(Qc.altText)));jc++;jc%
15&&jc!==wb.length||Na.append("</tr>")}Na.append("</table>");return Na.toString()}h1d(){const Na=this.heg();return qa.l(Na)}heg(){const Na=Object.assign(new oa.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(Na.MenuSectionList,this.x1h());e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&Array.add(Na.MenuSectionList,this.h0h());return Na}h0h(){const Na=Object.assign(new Ba.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",
ControlList:[]}),qb=Object.assign(new Ma.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:Z.a.ie(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Z.a.ie(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:e.AFrameworkApplication.Vl,Image16by16Class:Ja.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(Na.ControlList,qb);return Na}x1h(){const Na=Object.assign(new Ba.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),qb=Object.assign(new za.a,
{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),wb=this.ulc.Jid.value,jc=P.a(wb),Qc=Math.min(25,jc.length);for(let Ld=0;Ld<Qc;Ld++){var Cd=wb[jc[Ld]];Cd=Object.assign(new ka.a,{Id:String.format("{0}{1}_{2}","symbol_",Ld,Cd.Iid),Character:Cd.Iid,Command:"3966968829",QueryCommand:"816646517",Alt:Z.a.ie(Cd.altText)});qb.GalleryItems.push(Cd)}Array.add(Na.ControlList,qb);return Na}}Object(h.a)(xa,
"SymbolsUiBuilder",null,[765]);var Ga=d(61),na=d(120),sa=d(34),Ha=d(503),cb=d(290);class Za{constructor(){this.Da=null}get name(){return"Box4.Symbols"}init(){e.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled")&&this.Da.resolve("Box4.Symbols.ISymbolsActor").ub()}dispose(){}Wb(Na){this.Da=Na;this.Da.register(pa,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ma();this.Da.register(xa,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").ma().na(()=>new xa(this.Da.resolve("Box4.Symbols.ISymbolsLoader")));
this.Da.register(ja,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").ma().na(()=>new ja(e.AFrameworkApplication.Ta,new Ha.a,new cb.a,this.Da.resolve("Box4.Symbols.ISymbolsUIBuilder"),na.a.instance,sa.a.instance,Ga.a.instance,this.Da.La("Box4.IExternalSelectionManager")))}static main(){m.a.instance.Ac(new Za)}}Object(h.a)(Za,"Box4SymbolsPackage",null,[2,3]);var va=d(1021),Fa=d(33),Ca=d(80),La=d(435);class nb{constructor(Na,qb){this.EBd=this.DBd=null;this.Glb=new va.a;this.Ei=Na;this.taa=
qb.appSettings[nb.qAl]||""}get g8k(){return this.Glb.task}get Maa(){return this.Ei.value}WSk(){const Na={};Na[nb.bqj]=e.AFrameworkApplication.Zg;Na["Content-Type"]="application/json; charset=utf-8";n.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const qb=Ca.a.ej(this.taa+nb.h8k,nb.vgk,e.AFrameworkApplication.Aa.gb.Am.toString());this.Maa.vj(qb,1,"",Na,!0,2,Object(u.a)(this,this.mwe,"onSuccessCallback"),Object(u.a)(this,this.Wcc,"onFailureCallback"),
null,void 0,void 0,void 0,void 0,"20")}RWj(Na){try{const qb={};qb.FlightName=Na.FlightName;qb.SessionID=Na.SessionID;n.ULS.sendTraceTag(594883776,215,50,Fa.c(qb))}catch(qb){n.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}mwe(Na){if((Na=Na.data.Zd)&&Na.length)try{const qb=Fa.a(Na);this.DBd=qb.NavBarDataJson;n.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.DBd?({Hv:this.EBd}=Fa.d(qb.NavBarDataJson)).returnValue?(this.RWj(this.EBd),
this.Glb.Bg(this.EBd)):(n.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:La.a.Lmc(this.DBd)}),this.Glb.Z_()):(n.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Glb.Z_())}catch(qb){n.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Glb.Z_()}else n.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}Wcc(){this.Glb.Z_();n.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return nb.Ja||
(nb.Ja=nb.T5a())}static T5a(){return new nb(new y.a(()=>e.AFrameworkApplication.He),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.gb.Am)}}nb.bqj="X-qs";nb.vgk="at";nb.h8k="O365ShellServiceProxy.ashx";nb.Ja=null;nb.qAl="ShellWebServiceBase";Object(h.a)(nb,"O365ShellActor",null,[778]);class Nb{constructor(){this.Da=null}get name(){return"Common.App.O365Shell"}Wb(Na){this.Da=Na;this.Da.register(nb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ma().na(()=>new nb(new y.a(()=>
e.AFrameworkApplication.He),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.gb.Am))}init(){e.AFrameworkApplication.fa.ff(Object(u.a)(this,this.Bm,"onFullAppSettingsReady"))}Bm(){e.AFrameworkApplication.bmd&&e.AFrameworkApplication.Aa.gb.iN&&this.Da.resolve("Common.App.O365Shell.O365ShellActor").WSk()}dispose(){}static main(){m.a.instance.Ac(new Nb)}}Object(h.a)(Nb,"PackageManager",null,[2,3]);var Rb=d(77),Ya=d(280);class Qb{constructor(Na){this.Pa=new Rb.a;this.lH=Na}Kzc(Na){this.Pa.addHandler(Qb.$wa,
Na)}SDe(Na){this.Pa.removeHandler(Qb.$wa,Na)}hLe(){this.Pa.raiseEvent(Qb.KFb)}gLe(){this.Pa.raiseEvent(Qb.LFb)}}Qb.KFb="SE";Qb.LFb="SEP";Qb.$wa="SER";Qb.jQe="TRP";Object(h.a)(Qb,"NullSessionExpirationManager",null,[756,757]);var bb=d(163);class Bb{constructor(){this.OQb=this.lMa=!1;const Na=e.AFrameworkApplication.Ml;0>=Na||(this.Ml=Na,n.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Ml,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.Faa}),
Ya.a.instance.EGd(Object(u.a)(this,this.rCb,"onSessionExpiredDetected")),Ya.a.instance.CGd(Object(u.a)(this,this.udc,"onSessionExpiringDetected")))}rCb(){Ya.a.instance.vdh(Object(u.a)(this,this.rCb,"onSessionExpiredDetected"));n.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.b3d()}udc(){Ya.a.instance.tQk(Object(u.a)(this,this.udc,"onSessionExpiringDetected"));this.OQb||this.lMa||(n.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.OQb=!0,
this.ULe())}b3d(){this.lMa||(e.AFrameworkApplication.Xo(bb.a.sessionAccessTokenExpired),this.lMa=!0,this.qhd())}}Object(h.a)(Bb,"ASessionExpirationManager",null,[]);var Eb=d(284),tb=d(35);class Yb{constructor(Na,qb,wb,jc){this.APe="";this.woc=Na;this.Rtf=wb;this.Otf=jc;this.l7e=qb;Na=(new Date(this.woc)).format(e.AFrameworkApplication.Wnh);this.APe=this.l7e?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,Na)}IFb(Na){1===Na?this.Rtf&&this.Rtf(this.l7e):
0===Na&&e.AFrameworkApplication.Ta.Ka(tb.a.close,2,Eb.g)}dispose(){this.Otf&&this.Otf()}}Yb.id="SessionExpirationDialog";Object(h.a)(Yb,"SessionExpirationDialogSharedProperties",null,[]);class Tc{}Tc.jg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(h.a)(Tc,"SessionExpirationDialogHtml",null,[]);class ib extends C.a{constructor(Na,qb,wb,jc){super(qb);const Qc={};this.Xya=new Yb(Na,qb,wb,
jc);this.kg=Yb.id;e.AFrameworkApplication.YKf?(this.vd=1,this.Re(0,CommonUIStrings.l_DialogClose)):(this.vd=0,this.hr=!1);qb||1===e.AFrameworkApplication.Aa.mode?this.Re(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Re(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.jg=Tc.jg;Qc.WACSessionExpirationText=this.Xya.APe;this.pj(CommonUIStrings.l_DefaultDialogTitle,Object(u.a)(this,this.IFb,"sessionExpirationDialogHandler"),Qc);this.J4(this.hi("WACSessionExpirationText"))}IFb(Na){this.Xya.IFb(Na)}DRc(){return this.VP}Q1b(){this.hide()}dispose(){super.dispose();
this.Xya&&this.Xya.dispose()}}Object(h.a)(ib,"LegacySessionExpirationDialog",C.a,[850]);var Zb=d(103);class Cc extends Zb.StandardDialog{constructor(Na,qb,wb,jc){super(qb);this.Xya=new Yb(Na,qb,wb,jc);this.kg=Yb.id;e.AFrameworkApplication.YKf?(this.vd=1,this.Re(0,CommonUIStrings.l_DialogClose)):(this.vd=0,this.hr=!1);qb||1===e.AFrameworkApplication.Aa.mode?this.Re(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Re(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Yw(CommonUIStrings.l_DefaultDialogTitle,
this.Xya.APe,0,Object(u.a)(this,this.IFb,"sessionExpirationDialogHandler"))}IFb(Na){this.Xya.IFb(Na)}DRc(){return this.VP}Q1b(){this.hide()}dispose(){super.dispose();this.Xya&&this.Xya.dispose()}}Object(h.a)(Cc,"SessionExpirationDialog",Zb.StandardDialog,[850]);const ob=(Na,qb,wb,jc)=>e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.gb.QB&&e.AFrameworkApplication.fa.ka("ReactStandardSessionExpirationDialogIsEnabled")?new Cc(Na,qb,wb,jc):new ib(Na,qb,wb,jc);var cc=d(243);class sb extends Bb{constructor(Na){super();
this.Ilb=this.Jlb=!0;this.WO=null;this.Pa=new Rb.a;this.lH=Na}Kzc(Na){this.Pa.addHandler(sb.$wa,Na)}SDe(Na){this.Pa.removeHandler(sb.$wa,Na)}hLe(Na){this.Jlb=Na}gLe(Na){this.Ilb=Na}ULe(){if(!this.WO&&!cc.a.Cw){if(this.Ilb){const Na=Object(u.a)(this,this.$pb,"disposeCallback");this.WO=ob(this.Ml,!1,Object(u.a)(this,this.JFb,"sessionExpirationHandler"),Na)}this.Pa.raiseEvent(sb.LFb)}}qhd(){this.WO&&(this.WO.DRc()&&this.WO.Q1b(),this.WO=null);if(this.Jlb){const Na=Object(u.a)(this,this.$pb,"disposeCallback");
this.WO=ob(this.Ml,!0,Object(u.a)(this,this.JFb,"sessionExpirationHandler"),Na)}this.Pa.raiseEvent(sb.KFb)}$pb(){this.WO=null}JFb(){this.lH.refreshDocument(null)}}sb.KFb="SE";sb.LFb="SEP";sb.$wa="SER";sb.jQe="TRP";Object(h.a)(sb,"SessionExpirationManager",Bb,[756,757]);var mb=d(17);class Pb{}Pb.sYh="Aborting";Pb.Ryc="ActivityDuration";Pb.error="Error";Pb.BTd="Errors";Pb.failed="Failed";Pb.iJc="FirstActivity";Pb.initialized="Initialized";Pb.gRj="KickedOut";Pb.oRj="LastActivity";Pb.cgh="RetryOverride";
Pb.$cd="RequestGroups";Pb.iXa="Requests";Pb.ldd="Responses";Pb.Wed="SessionDuration";Pb.status="Status";Pb.success="Success";Pb.cil="Successful";Pb.tokens="Tokens";Pb.tye="PollingDuration";Object(h.a)(Pb,"SessionExpirationStrings",null,[]);var dc=d(78);class mc{constructor(Na){this.$x={};this.u5={};this.SLa={};this.UAg=15;this.gaf=!1;this.pUh=new Date;this.ptc=new Date;this.Rd=Na;this.m6=new dc.a(2,2,6E4*this.UAg,Object(u.a)(this,this.uEh,"writeMeasures"),135,"SL",!1);this.Rd.Gb(this.m6);this.Fxj()}uEh(){n.ULS.sendTraceTag(41964821,
217,50,n.ULS.Mae({["Aggregate"]:this.u5,["Current"]:this.$x}))}Fxj(){this.u5[Pb.$cd]=0;this.u5[Pb.iXa]=0;this.u5[Pb.ldd]=0;this.u5[Pb.status]=Pb.initialized;this.u5[Pb.iJc]=new Date;this.u5[Pb.Wed]=0;this.u5[Pb.Ryc]=0;this.u5[Pb.Wed]=0;this.$x[Pb.Wed]=0;this.u5[Pb.Ryc]=0;this.$x[Pb.Ryc]=0}get Mvk(){this.SLa[Pb.tye]=+new Date-+this.SLa[Pb.iJc];return this.SLa}c5d(Na,qb){var wb=Na[qb];wb=wb?wb:0;wb++;Na[qb]=wb;this.sIe(Na)}sIe(Na){const qb=new Date;Na[Pb.Ryc]=+qb-+this.ptc;this.ptc=qb;Na[Pb.Wed]=+this.ptc-
+this.pUh;Na[Pb.oRj]=this.ptc}CX(Na,qb){this.$x[Na]=qb;this.sIe(this.$x)}VHe(Na,qb){this.$x[Na]=qb;this.sIe(this.$x)}Dtb(Na){this.c5d(this.$x,Na);this.c5d(this.u5,Na);this.c5d(this.SLa,Na)}flush(){this.gaf||(this.u5[Pb.status]=this.$x[Pb.status],this.uEh(this.m6),this.Rd.B4(this.m6,6E4*this.UAg))}vTk(){const Na=this.$x[Pb.status];Na&&(this.u5[Pb.status]=Na);this.$x={}}DTk(){this.SLa={};this.SLa[Pb.tye]=0;this.SLa[Pb.iJc]=new Date}stop(){n.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.gaf=!0;this.Rd.Qg(this.m6)}}Object(h.a)(mc,"SessionLogger",null,[752]);class Mb{constructor(Na,qb){this.Qxc=Na;this.Cfa=qb}get tokens(){return this.Qxc}get errors(){return this.Cfa}}Object(h.a)(Mb,"TokenRefreshArgs",null,[777]);var Kc=d(94),gc=d(192),rb=d(136);class Ua extends Sys.EventArgs{constructor(Na,qb,wb,jc,Qc,Cd,Ld){super();this.SLa=Na;this.$cd=jc;this.failed=Qc;this.iXa=Cd;this.ldd=Ld}}Object(h.a)(Ua,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var pb=d(87);class Ub{constructor(Na,
qb=null,wb=null){this.OQb=this.lMa=!1;this.Ilb=this.Jlb=!0;this.Pa=new Rb.a;this.QQb=this.hOb=this.Qvc=!1;this.jzd=null;this.Rif=10;this.Usc=!1;this.BDd=Na;this.xvd=e.AFrameworkApplication.kQj;this.Rd=rb.a.instance;n.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:e.AFrameworkApplication.Ml,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.Faa});this.Bh=qb||new mc(rb.a.instance);this.sga=wb;Ya.a.instance.EGd(Object(u.a)(this,
this.oYh,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));Ya.a.instance.CGd(Object(u.a)(this,this.OEd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));gc.SessionStatusManager.instance.uGd(Object(u.a)(this,this.OEd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));gc.SessionStatusManager.instance.S4h(Object(u.a)(this,this.Zyk,"preemptiveTokenRefresh"));this.Rbf=new Date;e.AFrameworkApplication.jQj&&(Ya.a.instance.gLd=Object(u.a)(this,this.CJk,"refreshAccessTokenWhenSessionExpired"));
Na=!1;e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.Rif=e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),Na=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldResetLastAttemptWhenNetworkResumed",!1));
Na?gc.SessionStatusManager.instance.uGd(Object(u.a)(this,this.pYh,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):gc.SessionStatusManager.instance.uGd(Object(u.a)(this,this.OEd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}Kzc(Na){this.Pa.addHandler(Ub.$wa,Na)}SDe(Na){this.Pa.removeHandler(Ub.$wa,Na)}CJk(){this.u1b(!1);return!Ya.a.instance.tDa(e.AFrameworkApplication.Ml)}oYh(Na,qb){Ya.a.instance.GTc?this.rCb(Na,qb):this.xvd?(this.hOb=!1,this.u1b(!1)):(this.lMa||
n.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.rCb(Na,qb))}pYh(Na,qb){Ya.a.instance.ETc?this.udc(Na,qb):(ia.c(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.hOb=!1,this.u1b(!0))}OEd(Na,qb){Ya.a.instance.ETc?this.udc(Na,qb):this.u1b(!0)}u1b(Na){if(!this.Qvc&&!this.hOb)if(this.sga&&this.sga.u8a)this.QQb=!0,this.Bh.CX(Pb.status,Pb.gRj),this.Bh.flush(),this.Bh.stop();else if(n.ULS.sendTraceTag(40420955,
217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",Na,this.QQb),this.QQb)this.qhd();else{this.Bh.flush();this.Bh.vTk();this.Bh.Dtb(Pb.$cd);this.Qvc=!0;this.Usc||(this.Bh.DTk(),this.Usc=!0,this.nvi());const qb=this.BDd.WJk(Na);qb.continueWith(()=>{if(this.BDd.zBk(qb))this.Bh.Dtb(Pb.cil),this.Bh.CX(Pb.status,Pb.success),this.Ilb=!1,this.xvd&&(this.Jlb=!1),this.hOb=!1,this.Rbf=new Date,this.ohl(),this.Pa.raiseEvent(Ub.$wa,new Mb(qb.result.tokens,null));else{const wb=qb.result.errors;this.Bh.Dtb(Pb.failed);
this.Bh.CX(Pb.status,Pb.failed);Na||(this.QQb=this.BDd.l4b(wb));this.QQb&&(this.Bh.CX(Pb.sYh,JSON.stringify(wb)),n.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.hOb=!0;this.Pa.raiseEvent(Ub.$wa,new Mb(null,wb))}this.Bh.flush();this.Qvc=!1})}}rCb(){this.xvd||Ya.a.instance.vdh(Object(u.a)(this,this.rCb,"onSessionExpiredDetected"));n.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.b3d(Ya.a.instance.GTc)}udc(){this.OQb||this.lMa||(n.ULS.sendTraceTag(39408095,217,50,
"SessionExpiringDetected - Showing expiring dialog."),this.OQb=!0,this.ULe(Ya.a.instance.ETc))}b3d(Na){if(!this.lMa){var qb=Na?bb.a.L_k:bb.a.sessionAccessTokenExpired;const wb=Object.assign(new pb.a,{extendedProperties:new Map});wb.extendedProperties.set("ErrorCode",String.format("{0}",qb));e.AFrameworkApplication.Xo(qb,void 0,["SessionExpired"],wb);Na||(Na=new Date,qb=new Date(e.AFrameworkApplication.Faa),n.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",
qb,Na,+Na-+qb),864E5>+Na-+qb&&Kc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,wb),2592E5>+Na-+qb&&Kc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,wb));this.lMa=!0;this.qhd()}}ohl(){this.Usc&&(this.Rd.Qg(this.jzd),this.Usc=!1)}nvi(){this.jzd=new dc.a(2,2,1E3*this.Rif,Object(u.a)(this,this.Sml,"tokenRefreshPolling"),135);this.Rd.Gb(this.jzd)}Sml(){const Na=this.Bh.Mvk;n.ULS.sendTraceTag(555255521,
217,50,"{0}",Fa.c(Na));this.Pa.raiseEvent(Ub.jQe,new Ua(Na,Na[Pb.tye],Na[Pb.iJc],Na[Pb.$cd],Na[Pb.failed],Na[Pb.iXa],Na[Pb.ldd]))}Zyk(){3E5<+new Date-+this.Rbf?(n.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.u1b(!1)):n.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}Ub.KFb="SE";Ub.LFb="SEP";Ub.$wa="SER";Ub.jQe="TRP";Object(h.a)(Ub,"ASessionExpirationManagerWithRefresh",null,[]);class Bc extends Ub{constructor(Na,
qb,wb=null,jc=null){super(qb,wb,jc);this.WO=null;this.lH=Na}hLe(Na){this.Jlb=Na}gLe(Na){this.Ilb=Na}ULe(Na){if(!this.WO&&!cc.a.Cw){if(Na){var qb=Object(u.a)(this,this.$pb,"disposeCallback");this.WO=ob(e.AFrameworkApplication.mFb,!1,Object(u.a)(this,this.JFb,"sessionExpirationHandler"),qb)}else if(this.Ilb){if(this.Qvc)return;qb=Object(u.a)(this,this.$pb,"disposeCallback");this.WO=ob(e.AFrameworkApplication.Ml,!1,Object(u.a)(this,this.JFb,"sessionExpirationHandler"),qb)}n.ULS.sendTraceTag(39408096,
217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",Ub.LFb,Na);this.Pa.raiseEvent(Ub.LFb)}}qhd(){this.WO&&(this.WO.DRc()&&this.WO.Q1b(),this.WO=null);if(this.Jlb){this.Bh.stop();if(this.sga&&this.sga.u8a)return;const Na=Object(u.a)(this,this.$pb,"disposeCallback");this.WO=ob(e.AFrameworkApplication.Ml,!0,Object(u.a)(this,this.JFb,"sessionExpirationHandler"),Na)}n.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",Ub.KFb);this.Pa.raiseEvent(Ub.KFb)}$pb(){this.WO=null}JFb(){this.lH.refreshDocument(null)}}
Object(h.a)(Bc,"SessionExpirationManagerWithRefresh",Ub,[756,757]);class Gc{constructor(Na,qb,wb=null,jc=null){this.byf=!1;this.Ja=null;this.Drc=Na;this.qLa=qb;this.Bh=wb||new mc(rb.a.instance);this.sga=jc}create(){this.byf=e.AFrameworkApplication.zz;if(!this.byf)return new sb(this.Drc);e.AFrameworkApplication.Qj("WOPITokenRefreshIsEnabled");n.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.Ja)switch(e.AFrameworkApplication.DAl){case 1:n.ULS.sendTraceTag(39408090,
217,50,"Creating new NullSessionExpirationManager");this.Ja=new Qb(this.Drc);break;case 2:n.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.Ja=new Bc(this.Drc,this.qLa,this.Bh,this.sga);break;default:n.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this.Ja=new sb(this.Drc)}n.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.Ja).getName());return this.Ja}}Object(h.a)(Gc,
"SessionExpirationManagerFactory",null,[755]);var qd=d(1158),Td=d(22);class Vd{}Object(h.a)(Vd,"Error",null,[]);class Be{}Object(h.a)(Be,"NamedResult",null,[]);class Id extends Be{}Object(h.a)(Id,"ErrorInfo",Be,[]);var gb=d(113),Xb=d(170),Ic=d(124),Wc=d(692);class Ib{constructor(Na,qb,wb,jc=null,Qc=!1,Cd=null,Ld=!1,ie=!1){this.Oya=0;this.Roa=this.Hm=null;this.Qxc=new mb.a;this.Cfa=new mb.a;this.Cv=null;this.ZNb=!1;this.DRb=this.ERb=null;this.Rd=Na;this.$if=qb;this.$if.execute(Qe=>{Qe.ZA(Ic.a.t4d,
Object(u.a)(this,this.Gkk,"onHostResponseReceived"))});this.wR=wb;this.hxf=new Wc.a("WebServiceCall","TokenRefresh");this.Bh=jc||new mc(Na);this.kUh=Qc;this.Koa=Cd?Cd:gc.SessionStatusManager.instance;this.Q0e=Ld;this.Tqc=ie}Gkk(Na){if(Na.MessageId!==Ic.a.t4d)ia.c(39408099,306,15,"Unexpected message.");else{var qb=new mb.a,wb=new mb.a;this.Bh.Dtb(Pb.ldd);var jc=Na.Values[Xb.a.Ojh];if(!jc||0>=jc.length)ia.c(40122317,306,15,"Found no tokens in the dictionary"),jc=Na.Values;ia.c(40122318,306,100,"The Tokens array contains {0} tokens",
jc.length);this.Bh.CX("Correlation",Na.CorrelationId);var Qc="";for(let ie=0;ie<jc.length;ie++){this.Bh.VHe(Pb.tokens,jc.length);var Cd=jc[ie],Ld=Cd;if(!Ld||!Ld.Name)continue;this.Bh.Dtb(Ld.Name);const Qe=Cd;if(Qe&&Qe.Value)ia.c(39408128,306,100,"Received token with name: {0}",Qe.Name),qb.add(Qe),this.Qxc.add(Qe),this.Tqc||this.Bh.CX(Pb.status,Pb.success),this.Q0e&&this.Koa&&this.Koa.QTk();else if(Cd=this.kbj(Cd),ia.c(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
Ld.Name,JSON.stringify(Cd),this.Roa),wb.add(Cd),this.Tqc||(this.Cfa.add(Cd),Qc=JSON.stringify(Cd),this.Bh.CX(Pb.error,JSON.stringify(Cd)),this.Bh.CX(Pb.status,Pb.failed)),this.Q0e)for(const df of Cd.Errors)Ld=this.z2i(df),this.Koa&&this.Koa.S1h(Ld)}this.Tqc?(0<wb.count?this.DRb?this.DRb(new Mb(qb,wb)):ia.c(512267295,306,15,"Received errors but the promise has completed"):this.ERb?this.ERb(new Mb(qb,wb)):ia.c(512267294,306,15,"Received valid tokens but the promise has completed"),ia.c(512344162,306,
50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",qb.count,wb.count,Na.CorrelationId,this.Roa)):(0<wb.count&&""!==Qc?(jc=Object.assign(new pb.a,{extendedProperties:new Map}),jc.extendedProperties.set("Errors",Qc),jc.extendedProperties.set("RetryCount",this.Oya.toString()),jc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),jc.extendedProperties.set("IsTokenExpiring",this.ZNb.toString()),Kc.Health.instance.recordKpiFailure("WACTokenRefresh",
"TokenRefreshFailed",!1,!1,jc)):Kc.Health.instance.recordKpiSuccess("WACTokenRefresh",null),ia.c(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",qb.count,wb.count,Na.CorrelationId,this.Roa),0<wb.count&&!this.l4b(wb)?(Na=this.wR.Dcg(wb),Na!==this.wR.bFb&&(this.Bh.VHe(Pb.cgh,Na),this.Rd.B4(this.Hm,Na))):(this.Bh.flush(),this.Hm&&(ia.c(39408131,306,100,"Deleting task {0} from task manager",this.Hm.name),this.Rd.Qg(this.Hm)),this.Cv&&!this.Cv.task.isCompleted?
this.Cv.Bg(new Mb(qb,wb)):ia.c(512267293,306,15,"Received results but the task has completed")))}}kbj(Na){if(!Na)return null;const qb=Object.assign(new Id,{Name:Na.Name,Errors:[]});for(const wb of Na.Errors)Na=new Vd,Na.Id=wb.Id,Na.Details=Z.a.q0d(wb.Details,500),qb.Errors.push(Na);return qb}requestTokensOnce(){this.gfh()}gfh(){e.AFrameworkApplication.o9a("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.Oya>=this.wR.nSg?(ia.c(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
this.Roa),this.Mwi(this.Cv)):(Kc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.ijh())}ijh(){const Na={};Na[Xb.a.Ojh]=this.wR.tokens;const qb=gb.a.create().toString();ia.c(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.wR.tokens),this.Oya+1,qb,this.Roa);this.$if.execute(wb=>{wb.sendMessage(Ic.a.vHd,Na,qb)});this.Oya++;this.Bh.Dtb(Pb.iXa)}Mwi(Na){const qb=new mb.a;for(let wb=0;wb<this.wR.tokens.length;wb++){const jc=Object.assign(new Id,
{Name:this.wR.tokens[wb],Errors:[Object.assign(new Vd,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});qb.add(jc);this.Cfa.add(jc)}this.Rd.Qg(this.Hm);this.Bh.CX(Pb.BTd,JSON.stringify(this.Cfa));this.Bh.CX(Pb.status,Pb.failed);Na&&!Na.task.isCompleted&&Na.Bg(new Mb(new mb.a,this.Cfa))}WJk(Na){e.AFrameworkApplication.o9a("258ec738;j5j99381");e.AFrameworkApplication.o9a("85gid169;g470d326");this.hxf.start();this.ZNb=Na;
this.Roa=gb.a.create().toString();ia.c(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Roa,this.ZNb);this.Oya=0;this.Cfa.clear();this.Qxc.clear();this.Cv=new va.a;this.Tqc?this.hfh(this.wR.nSg).then(qb=>{this.Cv&&!this.Cv.task.isCompleted&&this.Cv.Bg(qb);this.DRb=this.ERb=null;this.Bh.CX(Pb.BTd,JSON.stringify(this.Cfa));this.Bh.CX(Pb.status,Pb.success);this.Bh.flush()}).catch(qb=>{this.Cv&&!this.Cv.task.isCompleted&&this.Cv.Bg(Object(qd.a)(777,qb));this.DRb=this.ERb=
null;this.Bh.CX(Pb.BTd,JSON.stringify(this.Cfa));this.Bh.CX(Pb.status,Pb.failed);this.Bh.flush()}):(this.Hm=new dc.a(this.wR.priority,2,this.wR.bFb,Object(u.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Ic.a.vHd,!0),this.kUh&&this.gfh(),this.Rd.Gb(this.Hm));return this.Cv.task}hfh(Na){const qb=this,wb=new Promise((ie,Qe)=>{qb.ERb=ie;qb.DRb=Qe;Kc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);qb.ijh()}),jc=this,Qc=new Promise((ie,Qe)=>{window.setTimeout(()=>{Qe(jc.MRf("TIMEOUT",
"We did not receive a new token from the host after the maximum allowed time"))},jc.wR.bFb)});let Cd=Na;const Ld=this;return new Promise((ie,Qe)=>{Cd--;Promise.race([wb,Qc]).then(df=>{Kc.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ie(df)}).catch(df=>{var tf=Ld.wR.bFb;if(Object(Td.a)(777,df)&&(df=Object(qd.a)(777,df),0<df.errors.count)){Ld.KVj(df.errors);Ld.BAf(df.errors);if(Ld.l4b(df.errors)){Qe(df);return}const jh=Ld.wR.Dcg(df.errors);jh!==Ld.wR.bFb?(Ld.Bh.VHe(Pb.cgh,jh),tf=jh):Ld.IOj(df.errors)&&
(tf=0)}Cd?window.setTimeout(()=>{Ld.hfh(Cd).then(ie).catch(Qe)},tf):(tf=Ld.MRf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Ld.BAf(tf.errors),Qe(tf),ia.c(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Ld.Roa))})})}BAf(Na){for(let qb of Na)this.Cfa.add(qb)}IOj(Na){if(!Na.count)return!1;Na=Na.ga(Na.count-1);return Na.Errors.length?"TIMEOUT"==Na.Errors[0].Id:!1}MRf(Na,qb){const wb=new mb.a;for(let jc=0;jc<
this.wR.tokens.length;jc++){const Qc=this.Nwi(this.wR.tokens[jc],Na,qb);wb.add(Qc)}return new Mb(new mb.a,wb)}Nwi(Na,qb,wb){return Object.assign(new Id,{Name:Na,Errors:[Object.assign(new Vd,{Id:qb,Details:wb})]})}KVj(Na){if(Na.count){Na=Na.ga(Na.count-1);Na=JSON.stringify(Na);var qb=Object.assign(new pb.a,{extendedProperties:new Map});qb.extendedProperties.set("Errors",Na);qb.extendedProperties.set("RetryCount",this.Oya.toString());qb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());
qb.extendedProperties.set("IsTokenExpiring",this.ZNb.toString());Kc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,qb);this.Bh.CX(Pb.error,Na);this.Bh.CX(Pb.status,Pb.failed)}}zBk(Na){this.hxf.stop();const qb=this.wqj(Na.result.errors);n.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!qb,this.Roa,this.ZNb,
this.Oya,this.Cfa.count,0<Na.result.errors.count?Na.result.errors.ga(0).Name:"",0<Na.result.errors.count&&0<Na.result.errors.ga(0).Errors.length?Na.result.errors.ga(0).Errors[0].Id:"",0<Na.result.errors.count&&0<Na.result.errors.ga(0).Errors.length?Na.result.errors.ga(0).Errors[0].Details:"");return qb?!1:this.yBk(Na.result.tokens)}l4b(Na){return this.wR.l4b(Na)}yBk(Na){for(let qb=0;qb<Na.count;qb++){const wb=Na.ga(qb);if(wb.Name===Xb.a.accessToken){const jc=(new Date).getTime();wb.Expiry>e.AFrameworkApplication.Ml?
(n.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:wb.Expiry,["NowGetTime"]:jc,["BootTime"]:e.AFrameworkApplication.Faa},"PreviousAccessTokenTtl",e.AFrameworkApplication.Ml),e.AFrameworkApplication.accessToken=wb.Value,e.AFrameworkApplication.Ml=Math.floor(wb.Expiry),e.AFrameworkApplication.nUe=jc,e.AFrameworkApplication.o6=Math.floor(wb.Expiry)):n.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:wb.Expiry,
["NowGetTime"]:jc,["BootTime"]:e.AFrameworkApplication.Faa},"PreviousAccessTokenTtl",e.AFrameworkApplication.Ml)}}return!0}wqj(Na){let qb=!1;for(let wb=0;wb<Na.count;wb++){qb=!0;const jc=Na.ga(wb);n.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",jc.Name,JSON.stringify(jc.Errors),this.Roa)}return qb}z2i(Na){let qb=bb.a.sessionAccessTokenExpired;Na=parseInt(Na.Id);if(isNaN(Na))qb=bb.a.HAl;else{switch(Na){case 401:qb=bb.a.KAl;break;case 403:qb=bb.a.FAl;break;
case 500:qb=bb.a.GAl;break;case 503:qb=bb.a.JAl}qb===bb.a.sessionAccessTokenExpired&&(qb=500<Na?bb.a.IAl:bb.a.EAl)}return qb}}Object(h.a)(Ib,"TokenRefreshManager",null,[754]);class ec{constructor(){this.bFb=e.AFrameworkApplication.NAl;this.nSg=e.AFrameworkApplication.LAl;this.tokens=e.AFrameworkApplication.hij();this.priority=e.AFrameworkApplication.OAl;this.$rf=this.A4k();this.BEd=e.AFrameworkApplication.gij()}l4b(Na){Na=JSON.stringify(Na);if(this.BEd&&0<this.BEd.length)for(const qb of this.BEd)if(0<
qb.length&&0<=Na.indexOf(qb))return!0;return!1}Dcg(Na){try{if(Na)for(let qb of Na)if(qb.Errors)for(const wb of qb.Errors)if(wb.Id in this.$rf)return Number.parseInvariant(this.$rf[wb.Id].toString())}catch(qb){n.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",qb.toString())}return this.bFb}A4k(){const Na={};try{if(!e.AFrameworkApplication.YNc()||0>=e.AFrameworkApplication.YNc().length||""===e.AFrameworkApplication.YNc()[0])return Na;for(const qb of e.AFrameworkApplication.YNc())0<
qb.length&&(Na[qb]=e.AFrameworkApplication.MAl)}catch(qb){n.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",qb.toString())}return Na}}Object(h.a)(ec,"TokenRefreshPolicy",null,[753]);class Jb{constructor(){this.Da=null}get name(){return"Common.App.SessionExpiration"}init(){e.AFrameworkApplication.fa.ff(()=>{this.xCa()})}xCa(){this.Da.resolve("Common.ISessionExpirationManagerFactory");this.Da.resolve("Common.ISessionExpirationManager");this.Da.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}Wb(Na){this.Da=
Na;Na.register(752,"Common.App.SessionExpiration.ISessionLogger").ma().na(()=>new mc(rb.a.instance));Na.register(753,"Common.App.SessionExpiration.ITokenRefreshPolicy").ma().na(()=>new ec);Na.register(754,"Common.App.SessionExpiration.ITokenRefreshManager").ma().na(()=>new Ib(rb.a.instance,e.AFrameworkApplication.zV(),Na.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),Na.resolve("Common.App.SessionExpiration.ISessionLogger"),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSendTokenRequestWithoutTasks"),
Na.pb("Common.ISessionStatus"),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SyncMessageWithTimeout",!1)));Na.register(755,"Common.ISessionExpirationManagerFactory").ma().na(()=>new Gc(e.AFrameworkApplication.Aa,Na.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),Na.resolve("Common.App.SessionExpiration.ISessionLogger"),Na.pb("Common.ISessionStatus")));
Na.register(756,"Common.ISessionExpirationManagerWithDialog").ma().na(()=>Na.resolve("Common.ISessionExpirationManagerFactory").create());Na.register(757,"Common.ISessionExpirationManager").ma().na(()=>Na.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){m.a.instance.Ac(new Jb)}}Object(h.a)(Jb,"SessionExpirationPackage",null,[2,3]);var hb=d(54),Rc=d(429),gd=d(37),hd=d(152),Hd=d(119),Xd=d(131),id=d(60),fd=d(26),Vf=d(40),Qd=d(28);class Zf extends cc.a{constructor(Na,qb){super();this.qda=
null;this.tZj=!1;this.o_j="";this.uLg=this.vLg=this.$Cg=this.aDg=null;this.vd=3;this.Re(1,ResourceStrings.L_SetSlideOrientationMaximize);this.Re(2,ResourceStrings.L_SetSlideOrientationEnsure);this.ia=Na;this.jMg=qb.Yj(id.a.Buk)}dispose(){this.qda=null;super.dispose()}showDialog(Na){this.pj(Na);this.aDg=document.getElementById("btnMaximize");this.vLg=Object(u.a)(this,this.Mnk,"onScaleUpButton");G.a.addHandler(this.aDg,"click",this.vLg);this.$Cg=document.getElementById("btnEnsure");this.uLg=Object(u.a)(this,
this.Lnk,"onScaleDownButton");G.a.addHandler(this.$Cg,"click",this.uLg)}pj(Na){this.hoa=Object(u.a)(this,this.m5k,"setSlideOrientationRatio");this.gwa(Na);this.Zy.style.width="420px";this.show()}hide(){this.pc&&(e.AFrameworkApplication.Aa.mw.qo(Hd.AFrame.u9),super.hide())}Mnk(Na){this.ia.processAction(Qd.a.Gjc,2);Na.preventDefault();this.EU&&this.hide()}Lnk(Na){this.ia.processAction(Qd.a.Fjc,2);Na.preventDefault();this.EU&&this.hide()}m5k(Na){1===Na?this.ia.processAction(Qd.a.Gjc,2):2===Na?this.ia.processAction(Qd.a.Fjc,
2):fd.a.J(25277209,822,50,"Cancle the slide orientation change.");this.EU&&this.hide()}gwa(){this.$w();this.DF()}$w(){super.$w();Sys.UI.DomElement.addCssClass(this.pc,this.o_j);var Na=$get("WACDialogTitleText");Na.innerText=ResourceStrings.l_SetSlideScaleTitle;Na.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);Na=document.createElement("div");Na.id=this.hi("WACDialogHtmlPanel");Na.className="WACDialogHtmlPanel";this.Zy.appendChild(Na);this.qda=document.createElement("div");this.qda.id=
this.hi("WACDialogText");Na.appendChild(this.qda);Na=document.createElement("div");Na.id=this.hi("Scalediv");Na.className="WACDialogRow";this.qda.appendChild(Na);var qb=document.createElement("label");qb.id=this.hi("Scalelabel");qb.innerText=ResourceStrings.L_SetSlideOrientationInformation;Na.appendChild(qb);Na=document.createElement("div");Na.id=this.hi("ScaleMode");Na.setAttribute("style","margin-left: 20px;");Na.className="WACDialogRow";this.qda.appendChild(Na);qb=Zf.TRf(id.a.T3g+"_MaximizeFit_170x130x32",
this.jMg,ResourceStrings.L_SetSlideOrientationMaximize);qb.id=this.hi("btnMaximize");var wb=document.createElement("td");wb.className=String.format("clip{0}x{1}","170","130");wb.setAttribute("style","border: #ccc 1px solid");wb.appendChild(qb);qb=Zf.TRf(id.a.T3g+"_Ensurefit_170x130x32",this.jMg,ResourceStrings.L_SetSlideOrientationEnsure);qb.id=this.hi("btnEnsure");var jc=document.createElement("td");jc.className=String.format("clip{0}x{1}","170","130");jc.setAttribute("style","border: #ccc 1px solid");
jc.appendChild(qb);var Qc=document.createElement("td");Qc.setAttribute("style","width: 30px;");qb=document.createElement("tr");qb.appendChild(wb);qb.appendChild(Qc);qb.appendChild(jc);wb=document.createElement("td");wb.setAttribute("align","center");jc=document.createElement("label");jc.id=this.hi("Maxlabel");jc.className="UIFontBold";jc.innerText=ResourceStrings.L_SetSlideOrientationMaximize;wb.appendChild(jc);jc=document.createElement("td");jc.setAttribute("align","center");Qc=document.createElement("label");
Qc.id=this.hi("Ensurelabel");Qc.className="UIFontBold";Qc.innerText=ResourceStrings.L_SetSlideOrientationEnsure;jc.appendChild(Qc);const Cd=document.createElement("td");Cd.setAttribute("style","width: 30px;");Qc=document.createElement("tr");Qc.appendChild(wb);Qc.appendChild(Cd);Qc.appendChild(jc);wb=document.createElement("table");wb.appendChild(qb);wb.appendChild(Qc);Na.appendChild(wb)}DF(){this.yhd(cc.a.Wec+(cc.a.Hla-Zf.Pfi)/2-12,cc.a.Vec+(cc.a.Nda-Zf.Ufi)/2-12)}yhd(Na,qb){this.pc.style.top=(0>
Na?0:Na)+"px";Vf.a("DeprecateIE.SetSlideOrientation")?this.pc.style.left=(0>qb?0:qb)+"px":hb.a.r8a&&e.AFrameworkApplication.isRtl?this.pc.style.right=(0>qb?0:qb)+"px":this.pc.style.left=(0>qb?0:qb)+"px";this.tZj||(this.pc.style.width=String.format("{0}em",this.width));this.pc.style.display="Block"}static TRf(Na,qb,wb){const jc=document.createElement("img");jc.className=Na;jc.setAttribute("Unselectable","on");jc.setAttribute(Xd.a.We,Xd.a.wM);jc.src=qb;wb&&(jc.alt=wb,jc.title=wb);return jc}}Zf.Ufi=
350;Zf.Pfi=200;Object(h.a)(Zf,"SetSlideOrientationDialog",cc.a,[]);var Ge=d(52),le=d(107),Sa=d(240),Cb=d(73);class rc extends C.a{constructor(Na,qb){super(!1,!1,!0);this.pQf=this.T1=null;if(!Na)throw Error.argumentNull("actionManager");if(!qb)throw Error.argumentNull("presentationReader");this.ia=Na;this.yc=qb}yCa(){this.T1=Object(u.a)(this,this.n5k,"setSlideSizeAndLayoutDialogResultHandler");this.pQf=this.KVi(this.getCurrentSlideDimensions());this.pj(ResourceStrings.L_SetSlideSize,this.T1,this.pQf)}n5k(Na,
qb){1===Na&&this.ia.Ka(Qd.a.imh,2,qb);this.dispose()}getCurrentSlideDimensions(){const Na=this.yc.Jv(),qb={};qb.height=Na.height;qb.width=Na.width;qb.slideType=this.yc.edj();return qb}KVi(Na){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:Na,["numberFormatInfo"]:Cb.e().numberFormatInfo}}}Object(h.a)(rc,"SlideSizeAndLayoutDialog",C.a,[]);class bd{constructor(Na,qb,wb,jc,Qc,Cd,Ld,ie,Qe){this.PFa=this.Mka=this.nT=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");
this.irh=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.vrh=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.ia=Na;this.Fa=qb;this.Af=wb;this.Db=jc;this.Yb=Qc;this.ta=Cd;this.ra=ie;this.yc=Ld;this.fe=Qe}ub(){this.ia.pa(Qd.a.sBe,Ge.a.application,Object(u.a)(this,this.qBe,"querySlideSize"),96);this.ia.pa(Qd.a.rBe,Ge.a.application,Object(u.a)(this,this.qBe,"querySlideSize"),96);this.ia.pa(Qd.a.H8g,Ge.a.application,
Object(u.a)(this,this.qBe,"querySlideSize"),96);this.ia.xa(Qd.a.p5k,Ge.a.application,Rc.a.rG);this.ia.pa(Qd.a.gDk,Ge.a.application,Rc.a.O_,96);this.ia.pa(Qd.a.Vfd,Ge.a.application,Object(u.a)(this,this.Soj,"handleSetSlideSize"),4);this.ia.pa(Qd.a.bJe,Ge.a.application,Object(u.a)(this,this.Uoj,"handleSetSlideSize4x3"),4);this.ia.pa(Qd.a.aJe,Ge.a.application,Object(u.a)(this,this.Toj,"handleSetSlideSize16x9"),4);this.ia.pa(Qd.a.I1g,Ge.a.application,Object(u.a)(this,this.SRj,"launchSlideSizeAndLayoutDialogHandler"),
4);this.ia.pa(Qd.a.Aqk,Ge.a.application,Object(u.a)(this,this.wzg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.pa(Qd.a.Bqk,Ge.a.application,Object(u.a)(this,this.wzg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.pa(Qd.a.Gjc,Ge.a.application,Object(u.a)(this,this.hmh,"setSlideOrientationHandler"),4);this.ia.pa(Qd.a.Fjc,Ge.a.application,Object(u.a)(this,this.hmh,"setSlideOrientationHandler"),4);this.ia.pa(Qd.a.imh,Ge.a.application,Object(u.a)(this,this.o5k,"setSlideSizeAndLayoutHandler"),
4);this.ia.xa(Qd.a.q5k,Ge.a.application,Rc.a.rG);this.ia.xa(Qd.a.setSlideHeight,Ge.a.application,Rc.a.rG);this.ia.pa(Qd.a.iDk,Ge.a.application,Rc.a.O_,96);this.ia.pa(Qd.a.hDk,Ge.a.application,Rc.a.O_,96);this.ia.xa(Qd.a.Ifl,Ge.a.application,Rc.a.rG);this.ia.xa(Qd.a.Hfl,Ge.a.application,Rc.a.rG)}we(){}qBe(Na,qb,wb,jc,Qc){fd.a.J(34936782,822,50,"Click slide size drop down.");if(qb.contextId!==Ge.a.application)return 2;if(qb=Object(qd.a)(le.a,Qc))Na=bd.tEj(this.yc.Jv(),Na),qb.Kf(Na);return 32}SRj(Na,
qb,wb){qb=this.ta.Ba;return!qb||this.Af.Zc(qb)||!Vf.a("DeprecateIE.CustomizeSlideSizeActor")&&hb.a.Kw?8:1===wb?32:hd.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",Na,()=>{(new rc(this.ia,this.yc)).yCa();fd.a.J(557158615,822,50,"Open set slide size and layout dialog.");return 32})}wzg(Na,qb,wb,jc,Qc){Na=this.ta.Ba;if(!Na||this.Af.Zc(Na))return 16;if(1===wb)return 32;if("slideType"in Qc&&"slideWidth"in Qc&&"slideHeight"in Qc)if(this.PFa=6,"o_custom"===Qc.slideType.toString().toLowerCase())this.nT=
6*Math.round(Qc.slideWidth),this.Mka=6*Math.round(Qc.slideHeight);else{wb=0;for(const Cd of this.slideSizeType){if(Qc.slideType.toString().toLowerCase()===Cd.toLowerCase()){this.PFa=wb;break}wb++}"landscape"===Qc.orientation.toString()?(this.Mka=this.irh[wb],this.nT=this.vrh[wb]):(this.nT=this.irh[wb],this.Mka=this.vrh[wb])}(new Zf(this.ia,this.fe)).showDialog(ResourceStrings.l_SetSlideScaleTitle);fd.a.J(34936786,822,50,"Open set slide scale type dialog.");return 32}Soj(Na,qb,wb){Na=this.ta.Ba;return!Na||
this.Af.Zc(Na)?8:this.ia.processAction(Qd.a.cqb,wb)}Uoj(Na,qb,wb){fd.a.J(34936788,822,50,"click set slide size 4:3.");qb=this.ta.Ba;if(!qb||this.Af.Zc(qb))return 16;if(1===wb||960===this.yc.Jv().width)return 32;this.nT=5760;this.Mka=4320;this.PFa=0;return this.pGb(this.nT,this.Mka,Na,this.PFa,"EnsureFit")}Toj(Na,qb,wb){fd.a.J(34936792,822,50,"click set slide size 16:9.");qb=this.ta.Ba;if(!qb||this.Af.Zc(qb))return 16;if(1===wb)return 32;wb=this.yc.Jv();if(1280===wb.width)return 32;this.nT=7680;this.Mka=
4320;this.PFa=16;return 960===wb.width&&720===wb.height?this.pGb(this.nT,this.Mka,Na,this.PFa,""):this.pGb(this.nT,this.Mka,Na,this.PFa,"EnsureFit")}o5k(Na,qb,wb,jc,Qc){qb=this.ta.Ba;return!qb||this.Af.Zc(qb)?8:1===wb?32:this.pGb(Qc.width,Qc.height,Na,Qc.slideType,Qc.slideScaleType)}hmh(Na,qb,wb){qb=this.ta.Ba;return!qb||this.Af.Zc(qb)?16:1===wb?32:this.Mka&&this.nT?Na===Qd.a.Gjc?this.pGb(this.nT,this.Mka,Na,this.PFa,"Maximize"):Na===Qd.a.Fjc?this.pGb(this.nT,this.Mka,Na,this.PFa,"EnsureFit"):32:
(fd.a.J(34936796,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}pGb(Na,qb,wb,jc,Qc){const Cd=this.ta.Ba;let Ld=!1;if(Cd){var ie=Cd.om();if(ie&&0<ie.length)for(const Qe of ie)if(Qe.RCa){Ld=!0;break}}ie=this.Db.rd(15,void 0,()=>{this.Fa.Ad();this.ra.Ph()});try{ie.fd(Cd),ie.$c=wb,ie.my[Sa.a.$sb]=Ld,Cd.setValue(gd.a.slideWidth,Na),Cd.setValue(gd.a.slideHeight,qb),Cd.setValue(gd.a.slideScaleType,Qc),Cd.setValue(gd.a.slideSizeType,jc)}finally{ie&&ie.dispose()}fd.a.J(34936798,
822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",Na,qb,Qc);this.Af.TTb(this.Yb.yf,Cd,wb);return 32}static tEj(Na,qb){Na=Na.width/Na.height;switch(qb){case Qd.a.sBe:return.01>Math.abs(Na-1.33);case Qd.a.rBe:return.01>Math.abs(Na-1.77);default:return!1}}}Object(h.a)(bd,"CustomizeSlideSizeActor",null,[244]);class pd{}pd.zfh=0;pd.BTk=22711;Object(h.a)(pd,"ImageConstants",null,[]);var Oa=d(237),jb=d(324),nc=d(433),kb=d(41),Gb=d(106),tc=d(238),dd=d(105);class $c extends dd.a{constructor(){super();
this.ImageToken=null;this.ErrorCode=0}Ik(){return 78}}Object(h.a)($c,"NotifyImageUploadFailureRequest",dd.a,[]);class Pc{constructor(Na,qb,wb,jc,Qc,Cd,Ld,ie,Qe,df,tf,jh,Dh,ch,Hg,wh,Yh,Ni,vi,Eh,xh){this.NFa=this.fTa=this.EI=null;this.KAb=!1;this.ia=Na;this.nb=wb;this.Xb=qb;this.ta=Qc;this.Db=Cd;this.Fa=jc;this.Lz=Ld;this.nF=ie;this.xm=Qe;this.Qle=df;this.Mx=tf;this.Kd=jh;this.Qb=Dh;this.Dne=ch;this.$8b=Hg;this.QTa=wh;this.ni=Yh;this.gl=Ni;this.Ga=vi;this.ql=Eh;this.Qc=xh;this.$S=vi.wDb;this.k2j=vi.Wji;
this.Q2j=vi.Jzj}ub(){this.ia.pa(Qd.a.insertPicture,Q.a.application,Object(u.a)(this,this.mhg,"handleInsertPicture"),4);this.ia.pa(Qd.a.ZIc,Q.a.view,Object(u.a)(this,this.Mpj,"handleUploadPictureAll"),4);this.ia.pa(Qd.a.Tji,Q.a.application,Object(u.a)(this,this.Zjj,"handleChangePicture"),4);this.ia.pa(Qd.a.WEe,Q.a.application,Object(u.a)(this,this.qoj,"handleResetPicture"),4);this.ia.pa(Qd.a.ATk,Q.a.application,Object(u.a)(this,this.roj,"handleResetPictureAndSize"),4);this.ia.pa(Qd.a.CTk,Q.a.application,
Object(u.a)(this,this.soj,"handleResetPictureSplitButton"),4);this.ia.pa(Qd.a.BNa,Q.a.application,Object(u.a)(this,this.$jj,"handleChangePictureStyle"),4);this.ia.pa(Qd.a.hSd,Q.a.application,Object(u.a)(this,this.mhg,"handleInsertPicture"),4);this.ia.pa(Qd.a.UXf,Q.a.application,Object(u.a)(this,this.Okj,"handleDragAndInsertImage"),4)}we(){}mhg(Na,qb,wb){this.Ga.usg&&!Vf.a("DummyChangeGateForTest")&&fd.a.J(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");this.k2j&&fd.a.J(512500499,
822,50,"HandleInsertPicture::m_isChangePictureMenuOrderingEnabled is Enabled");this.Q2j&&fd.a.J(512500498,822,50,"HandleInsertPicture::m_isInsertStockImageInMLRFlightEnabled is Enabled");qb=this.ta.Ba;qb=this.Ga.cTc&&!!qb&&!this.Xb.Zc(qb);qb=(this.$8b=this.Dne.WCj()&&this.$8b)?qb&&!!this.Lz&&this.Lz.Xld:this.nF.$sg&&qb;if(!qb)return 16;if(1===wb)return 32;this.KAb=!0;this.NFa=this.ta.Ba;this.Gkc(Na!==Qd.a.hSd,!0);return 32}Mpj(Na,qb,wb,jc,Qc){var Cd=this.ta?this.ta.Ba:null;if(!Cd||!Cd.isConnected)return 16;
if(!this.gl.lI(Cd,1))return this.gl.kJ(Cd),16;fd.a.J(512500497,822,50,"Start picture upload");qb=Pc.bOj(Qc);(jc=kb.a.Cb)&&jc.Wa(Gb.a.Tzj,qb?"1":"0");this.Qc.NGk();let Ld=!1;if(this.KAb&&this.$8b&&!this.Lz.Yfb&&this.qIj(qb)){if(Cd=Cd.j2(this.nb.ae())){if(15!==Cd.zj){const ie=Cd.KT;ie.BottomLeft.X!==ie.TopLeft.X&&(Ld=!0)}jc&&jc.Wa(Gb.a.LVk,Ld?"1":"0")}Cd&&(15===Cd.zj||Ld)?(jc&&jc.Wa(Gb.a.U1f,Ld?"PlaceHolder Rotated":"Picture Type PlaceHolder"),Na=this.pig(Na,wb,Qc)):Na=this.Npj(Na,wb,Qc)}else this.Lz.Yfb=
!1,Na=this.pig(Na,wb,Qc);qb&&32===Na&&fd.a.J(512500496,822,50,"Upload a svg file successfully.");return Na}qIj(Na){return Na?this.Ga.powerPointInsertSVGFileLocalRenderingEnabled:!0}Okj(Na,qb,wb,jc,Qc){if(!this.Lz.ivk)return fd.a.J(512500495,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Qc)return 16;Na=[];qb=0;wb=!1;for(const Cd of Qc)if(qb++,"string"===typeof Cd.type)if(Qc=Z.a.sg(Cd.type),fd.a.J(512500494,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",
qb,Cd.size,Qc),0<=Qc.indexOf("image")&&0===this.Lz.omd(Cd.name))if(Na.length<this.Ga.powerPointDragInsertMultipleImageQuantityLimit)Array.add(Na,Cd);else{this.ql.MM(19);break}else wb||(this.ql.MM(18),wb=!0);if(1>Na.length)return fd.a.J(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.Lz.zIi(Na);return 32}pig(Na,qb,wb){if(!(this.ta&&this.ta.Ba&&this.Lz))return 16;if(1===qb)return 32;this.nF.vva=new Date;this.KAb&&this.nb.hj();this.Fa.Ad();this.Xb.blockContent(this.ta.presentation,
Na);const jc=kb.a.Cb;this.Lz.Uhd(wb,Qc=>{kb.a.jK(jc,()=>{fd.a.J(512500492,822,50,"Picture upload successful");this.V2d(wb,Qc,Na);this.J4f()})},Qc=>{fd.a.J(512500491,822,10,"Upload picture failed");this.e7a(Qc.error);this.J4f()});return 32}Npj(Na,qb,wb){if(!(this.ta&&this.ta.Ba&&this.Lz))return 16;if(1===qb)return 32;const jc=String.format("{0}{1}","client",gb.a.create().toString());fd.a.J(512500490,822,50,"Client generated imageToken:{0}, imageSize:{1}",jc,wb.OP);this.nF.ubi(jc);const Qc=kb.a.Cb;
Qc&&(qb="InsertPicture",this.KAb||(qb="ChangePicture"),Qc.actionName=qb,Qc.Ij=!0);const Cd=new Date;kb.a.hk("PictureUploadStart",kb.a.Ye(Cd));kb.a.hk("ImageSize",wb.OP.toString());kb.a.hk("ImageToken",jc);const Ld=this.ta.Ba.sid;this.ia.Ka(Qd.a.n6d,2,Ld);this.Lz.Uhd(wb,ie=>{kb.a.jK(Qc,()=>{fd.a.J(512500489,822,50,"Upload picture completed");kb.a.hk("PictureUploadDurationMS",(+new Date-+Cd).toString());this.hvk(jc,ie);this.ia.Ka(Qd.a.yQc,2,Ld)})},ie=>{this.nF.MZf(jc);var Qe=Object.assign(new $c,{ImageToken:jc,
ErrorCode:ie.error.Code});Qc&&Qc.Wa("UploadPictureErrorCode",Oa.a[Qe.ErrorCode]);Qe=new tc.a(Qe,null,()=>Pc.$lk());this.ni.Gb(Qe);fd.a.J(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",jc,Oa.a[ie.error.Code],ie.error.Message);this.ia.Ka(Qd.a.yQc,2,Ld)},jc);this.insertPicture(jc,Na,wb);return 32}Zjj(Na,qb,wb){Na=this.$S?this.g6a():this.Zrb();if(!(this.$S?this.wvg(Na):this.xvg(Na)&&this.Ga.cTc&&this.nF.$sg&&!this.Xb.Zc(Na)))return 16;if(1===wb)return 32;this.KAb=
!1;this.Gkc(!0,!1);return 32}qoj(Na,qb,wb){return this.BNa(qb,wb,pd.zfh,Na)}roj(Na,qb,wb){return this.BNa(qb,wb,pd.BTk,Na)}soj(Na,qb,wb,jc,Qc){return this.BNa(qb,1,Qc,Na)}$jj(Na,qb,wb,jc,Qc){return this.BNa(qb,wb,Qc,Na)}BNa(Na,qb,wb,jc){const Qc=this.nb.ae();if(!(Qc&&0<Qc.length))return 8;Na=[];for(const Ld of Qc){if(this.kJj(Ld)||this.Xb.Zc(Ld))return 8;(this.$S?this.wvg(Ld):this.xvg(Ld))&&Na.push(Ld)}if(0>=Na.length)return 8;if(1===qb)return 32;fd.a.J(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",
wb);qb=kb.a.Cb?kb.a.Cb.actionName:null;for(var Cd of Na)this.YOa(Cd);Cd=this.Db.rd(15,void 0,()=>{this.nb.hj();this.Fa.Ad()});try{Cd.jc(Na[0]);Cd.$c=jc;for(const Ld of Na)Ld.qdb=wb}finally{Cd&&Cd.dispose()}if(jc=kb.a.Cb)qb&&(jc.actionName=qb),jc.Wa("PictureStyleId",wb.toString()),kb.a.dea(jc);return 32}V2d(Na,qb,wb){this.nF.uva=new Date;const jc=qb.result;if(Na){if(this.KAb?(qb="InsertPicture",this.yzj(jc,Na,wb)):(qb="ChangePicture",Vf.a("ChangePictureOnMultiSelectFixEnabled")?this.yLd(jc,Na,wb):
this.Uji(jc,Na,wb)),Na=kb.a.Cb)Na.actionName=qb,Na.Wa("PictureUploadStart",kb.a.Ye(this.nF.vva)),Na.Wa("PictureUploadDurationMS",(+this.nF.uva-+this.nF.vva).toString())}else Na=Object.assign(new jb.a,{Code:94}),this.e7a(Na)}hvk(Na,qb){this.nF.MZf(Na);qb.result||fd.a.J(512500486,822,50,"Upload picture completed with null response")}yzj(Na,qb,wb){const jc=this.ta.Ba;if(jc&&jc.isConnected){this.fTa=jc.j2(this.nb.ae());var Qc=this.Db.rd(15,void 0,void 0,()=>{this.nb.selectShape(this.EI,!0);this.Fa.Ad()});
try{Qc.jc(jc),Qc.$c=wb,Qc.my[Sa.a.WAa]=Sa.a.c5f,this.EI=this.xm.Lwi(jc.Bb),this.fTa&&(this.EI.Iaa=this.fTa.id),this.EI.eGb(Na.ItemId,this.Ga.GRa?null:qb.fileName,qb.fileName),jc.rB(this.EI)}finally{Qc&&Qc.dispose()}this.Xb.Ipa(this.ta.Ba,this.EI,this.Qb.Ma,"InsertPictureAfterUpload");this.Mx.pI=this.EI}}yLd(Na,qb,wb){var jc=this.nb.ae();if(jc){var Qc=[];for(const Cd of jc)Cd.Mf||Qc.push(Cd);for(const Cd of Qc)this.YOa(Cd);jc=this.Db.rd(15);try{jc.$c=wb;jc.jc(Qc[0]);for(const Cd of Qc)Cd.Iaa=Cd.id,
this.Ga.GRa?(Cd.eGb(Na.ItemId,null,qb.fileName),Cd.set_alt("")):Cd.eGb(Na.ItemId,qb.fileName,qb.fileName)}finally{jc&&jc.dispose()}for(const Cd of Qc)this.Xb.Ipa(this.ta.Ba,Cd,this.Qb.Ma,"ChangePictureAfterUpload")}}Uji(Na,qb,wb){const jc=this.$S?this.g6a():this.Zrb();if(jc){this.YOa(jc);var Qc=this.Db.rd(15);try{Qc.$c=wb,Qc.jc(jc),jc.Iaa=jc.id,this.Ga.GRa?(jc.eGb(Na.ItemId,null,qb.fileName),jc.set_alt("")):jc.eGb(Na.ItemId,qb.fileName,qb.fileName)}finally{Qc&&Qc.dispose()}this.Xb.Ipa(this.ta.Ba,
jc,this.Qb.Ma,"changePictureAfterUploadSingleImage")}}e7a(Na){this.nF.uva=new Date;fd.a.J(512500484,822,50,"Upload picture failed");this.Kd.qG(Na.Code,qb=>{qb.xB=1;qb.ePa=Na.ExtraErrorParam;return!1})}J4f(){this.Xb.vO(this.ta.presentation)}Gkc(Na,qb){this.Qle?nc.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.Lz&&(this.Lz.uVc=this.$8b,this.Lz.AJb=0,Na&&this.Lz.z7g(qb))}Zrb(){const Na=this.nb.ae();for(const qb of Na)if(qb&&qb.qk)return qb;return null}g6a(){const Na=
this.nb.ae();return Na&&Na.length?this.pId(Na)?Na[0]:this.Zrb():null}pId(Na){if(!Na||!Na.length)return!1;let qb=Na[0].qk,wb=1===Na[0].mediaType;for(const jc of Na)qb=qb&&jc.qk,wb=wb&&1===jc.mediaType;return qb||wb}Jk(Na){return Na?Object(qd.a)(124,Na.oc(this.Qb.Ma)):null}YOa(Na){Na&&Na.yx&&(Na=this.Jk(Na))&&Na.$_(!1)}xvg(Na){return this.ta&&this.ta.Ba&&Na&&Na.qk?!0:!1}wvg(Na){return this.ta&&this.ta.Ba&&Na&&(Na.qk||1===Na.mediaType)?!0:!1}kJj(Na){return this.ta&&this.ta.Ba&&Na&&Na.Lp?!0:!1}insertPicture(Na,
qb,wb){var jc=this.ta.Ba;const Qc=Object(qd.a)(253,jc.oc(this.Qb.Ma)),Cd=this.NFa.Bb;if(jc&&jc.isConnected&&Qc&&this.NFa&&this.NFa.isConnected){jc=this.NFa.Qu();this.fTa=this.NFa.j2(this.nb.ae());var Ld,ie;({FUd:ie,vC:Ld}=this.QTa.pNd(this.fTa,wb.imageWidth,wb.imageHeight));var Qe=this.Db.rd(15,void 0,()=>{this.nb.ly();this.nb.Ph();this.Fa.Ad()},()=>{this.Mx.pI=this.EI;this.nb.selectShape(this.EI,!0)});try{Qe.jc(this.NFa);Qe.$c=qb;this.EI=this.xm.fqa(!0,Cd.cid,Cd.sid,0,Ld.x,Ld.y,ie.width,ie.height,
jc+1,!1);const df=this.QTa.EJd(this.Qb.Cd,ie,Ld,Qc.BV);this.EI.KT=df;this.fTa&&(this.EI.Iaa=this.fTa.id,this.NFa.HT([this.fTa]));this.EI.eGb(Na,this.Ga.GRa?null:wb.fileName,wb.fileName);this.EI.isResizable=!0;this.EI.X3b=!0;this.EI.EK=!0;this.EI.qGa=!0;this.EI.qk=!0;this.EI.Oqb=!!wb.QBb;this.EI.qca=wb.QBb||wb.IPc;this.NFa.rB(this.EI)}finally{Qe&&Qe.dispose()}kb.a.FRe()}}static bOj(Na){return!!Na&&!!Na.fileName&&Na.fileName.toLowerCase().indexOf(".svg")===Na.fileName.length-4}static $lk(){fd.a.J(512500483,
822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(h.a)(Pc,"PictureActor",null,[244]);var Ad=d(110),Ee=d(206),Ce=d(703),Fb=d(886),$e=d(84);class bg extends Sys.EventArgs{constructor(Na,qb){super();this.HKj=Na;this.YTc=qb}}Object(h.a)(bg,"TokenRefreshEventArgs",Sys.EventArgs,[]);class Ye{constructor(Na,qb,wb,jc,Qc,Cd,Ld){this.FAb=0;this.Mc=Na;this.Voe=qb;this.Jt=wb;this.ia=jc;this.zo=Qc;this.yb=Cd;this.Ga=Ld;this.Voe&&this.Voe.Kzc(Object(u.a)(this,this.Z0g,"onTokenRefreshed"))}FLd(Na){!this.Ga.podTokenRefreshImprovementEnabled&&
this.yb.Dra&&this.yb.nXa();const qb=Ya.a.instance.tDa(e.AFrameworkApplication.Ml),wb=Ya.a.instance.DTc(e.AFrameworkApplication.Ml,e.AFrameworkApplication.Aga);fd.a.J(41562886,801,qb||wb?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",qb,wb,Na,this.Ga.podTokenRefreshImprovementEnabled,this.FAb);Ya.a.instance.B3a();this.Ga.podTokenRefreshImprovementEnabled&&this.yb.Dra&&this.yb.nXa()}Z0g(Na,qb){fd.a.J(41562888,
809,50,"PPTTokenRefreshManager::OnTokenRefreshed");try{const wb=Object(qd.a)(Mb,qb)||new Mb(null,null),jc=wb.tokens,Qc=wb.errors;Na="";if(void 0===Qc||null===Qc||0>=Qc.count)for(qb=0;qb<jc.count;qb++)if(jc.ga(qb).Name===Xb.a.P_k){const Ld=jc.ga(qb)?jc.ga(qb):null;Na=Ld&&Ld.Value&&0<Ld.Value.length?Ld.Value:"";break}const Cd=Ya.a.instance.tDa(e.AFrameworkApplication.Ml);fd.a.J(540366599,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",
Cd,this.Ga.cze,this.FAb,this.Ga.O5g);if(0<Na.length&&Cd&&this.Ga.cze&&this.FAb<this.Ga.O5g)fd.a.J(51205124,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",(new Date).getTime(),new Date,e.AFrameworkApplication.Ml,new Date(e.AFrameworkApplication.Ml),this.Ga.cze,this.FAb),this.FAb++,this.FLd(2);else if(0<Na.length&&!Cd){fd.a.J(41562890,809,Cd?
15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,e.AFrameworkApplication.Ml,new Date(e.AFrameworkApplication.Ml));Ee.App.EYd=e.AFrameworkApplication.Wpb=Z.a.Me(Na);const Ld=this.Jt.Hfc.presentationId.vNe+"&access_token="+encodeURIComponent(e.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(e.AFrameworkApplication.Ml.toString());this.Jt.Hfc=
new Fb.a(new Ce.a(Ld));this.Mc.B$g(new bg(this.zo?this.zo.eZ:!1,!0))}else{if(Vf.a("CleanPIIFromC49mm")&&Qc)for(let Ld of Qc)if(Ld.Errors)for(const ie of Ld.Errors)"403"===ie.Id&&ie.Details&&ie.Details.startsWith("<")&&(ie.Details=null);fd.a.J(41562892,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",Qc?Ad.c(Qc):"There is no error in Refreshed Token, but GetFileUrl is empty",this.FAb);Qc&&0<=Ad.c(Qc).indexOf("The caller is not authenticated")?
(e.AFrameworkApplication.Xo($e.a.Mh(383)),Kc.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null)):(e.AFrameworkApplication.Xo($e.a.Mh(380)),Kc.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null));e.AFrameworkApplication.wu&&e.AFrameworkApplication.wu.Z6();this.Mc.B$g(new bg(this.zo?this.zo.eZ:!1,!1));this.ia.Ka(Qd.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(wb){fd.a.J(41562894,
809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",Ad.c(wb))}}dispose(){this.Voe.SDe(Object(u.a)(this,this.Z0g,"onTokenRefreshed"))}}Object(h.a)(Ye,"PPTTokenRefreshManager",null,[731]);var Ae=d(85),si=d(637);class Jf{constructor(Na,qb,wb,jc,Qc,Cd){this.YW=this.kAl=this.uEe=null;this.RYb=this.TUd=!1;this.M3c=0;this.gib=kb.a.hm("SeamlessFailover");1!==qb&&2!==qb||kb.a.W8a();this.Bj=new Date;kb.a.Xvb=this.startTime;this.uRh=wb;this.$Na=
0;this.hTh=qb;this.gLh=jc;this.nvc=Qc;this.qol=Cd;this.fPi=!1;this.resultCode=0;this.C1e=!0;if(Na=e.AFrameworkApplication.Yc)this.Uc.Wa("Host",Object(qd.a)(String,Na.Host)),this.Uc.Wa("Ring",Object(qd.a)(String,Na.Ring))}Amh(Na,qb){this.M3c=window.setTimeout(Na,qb)}qhl(){this.C1e=!1}dispose(){kb.a.z5b=new Date;0<=this.M3c&&(window.clearTimeout(this.M3c),this.M3c=-1)}get cPi(){return this.C1e}get Uc(){return this.gib}get startTime(){return this.Bj}get Qqk(){return this.uRh}get Jva(){return this.hTh}get tOi(){return this.gLh}get podsCleaningRequestPattern(){return this.nvc}}
Object(h.a)(Jf,"SeamlessFailoverState",null,[106]);const tg=Na=>{Na=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",e.AFrameworkApplication.fa.Ha("361"),Na);e.AFrameworkApplication.He.FY(Na,1,null,null,null,0,()=>{fd.a.J(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{fd.a.J(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var Dg;(function(Na){Na[Na.unknown=0]="unknown";Na[Na.mouse=
1]="mouse";Na[Na.keyboard=2]="keyboard";Na[Na.podsPopsUnavailable=4]="podsPopsUnavailable"})(Dg||(Dg={}));Object(h.b)("RehydrationTrigger",Dg);var Vg=d(647),Ih=d(941);class hf{constructor(Na,qb,wb,jc,Qc,Cd,Ld,ie,Qe,df,tf,jh,Dh,ch,Hg,wh,Yh,Ni,vi,Eh,xh,fj,Wi){this.Ae=this.Hee=null;this.dre=this.p4c=-1;this.mOg=0;this.Pab=Na;this.la=qb;this.Yb=wb;this.ia=jc;this.yb=Qc;this.AD=Cd;this.Ce=Ld;this.Ue=Qe;this.Gy=df;this.Kd=tf;this.vm=jh;this.Ci=Dh;this.hc=ch;this.KN=Hg;this.Uv=Ni;this.Woe=new Date;this.$u=
wh;this.GG=Yh;this.ta=vi;this.$b=Eh;this.S9b=xh;Wi.execute(yh=>{this.Hee=yh});this.zYc=[];this.H7j=this.$b.Ec("SeamlessFailoverMaxRetryAttempts",0);this.G7j=this.$b.ka("SeamlessFailoverIncludePopsInfoInFinalLog");this.I7j=this.$b.ka("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");fd.a.J(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get eZ(){return!!this.Ae&&this.Ae.cPi}get Q1f(){return this.mOg}PEd(Na){if(this.eZ){e.AFrameworkApplication.zz&&(this.Ci.Thc(Object(u.a)(this,
this.Mda,"onWopiTokenRefreshed")),this.XUb());var qb=0;if(this.la.Fub)this.Ae.Uc.dB("Result","abortedOnIrmProtectedFile"),qb=365;else if(this.Ae.Uc.dB("Result",Na),"abortedOnExitApp"!==Na||this.I7j)qb=4===this.Ae.Jva?356:357;this.Zeb(!1,qb,!this.Ae.RYb&&"abortedOnRefreshDoc"!==Na)}}IQe(Na,qb,wb){if(this.eZ)fd.a.J(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{e.AFrameworkApplication.wu||(e.AFrameworkApplication.wu=fd.a.qWb());this.Kd.disabled=!1;this.Kd.wia=!1;this.Ae=
new Jf(Na,qb,this.Ce.podSessionId,this.la.podsCleanPendingTasksAndRequestsWhenFailover,this.la.podsCleaningRequestPattern,wb);this.la.wopiTokenRefreshLongerTimeoutIsEnable||this.Ae.Amh(Object(u.a)(this,this.eYg,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs);this.Ae.Uc.Wa("PopsAvailable",this.Ue.Xz.toString());this.Ae.Uc.Wa("OrderlyShutdown",Na.toString());this.Ae.Uc.Wa("Trigger",Dg[qb]);this.Ae.Uc.Wa("TriggerErrorCode",Oa.a[wb]);this.Ae.Uc.Wa("OldPodsId",this.Ae.Qqk);this.Ae.Uc.Wa("OldPopsId",
this.Ce.tk);fd.a.J(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Ae.Uc.actionId,this.Ae.Uc.tIb());if(1===qb||2===qb)e.AFrameworkApplication.Xg=!1,this.ta.presentation&&this.ta.presentation.ZEe();this.Ci.Szc(Object(u.a)(this,this.Mda,"onWopiTokenRefreshed"));e.AFrameworkApplication.zz&&Ya.a.instance.B3a()?(fd.a.J(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),
new Date,e.AFrameworkApplication.Ml,new Date(e.AFrameworkApplication.Ml)),this.XUb(),this.p4c=window.setTimeout(Object(u.a)(this,this.Ppk,"onWopiTokenRefreshTimeout"),this.la.wopiTokenRefreshTimeoutDuringRehydrationInMs),this.la.w4g&&this.S9b.H4f(!1)):(this.Ci.Thc(Object(u.a)(this,this.Mda,"onWopiTokenRefreshed")),this.nxh(qb))}}iPi(Na){if(Array.contains(this.la.podTriggerFailoverOnServerErrorsCandidates,$e.a.Mh(Na).toString())){if(!this.zYc.length)return!0;const qb=new Date;let wb=0;for(let jc=this.zYc.length-
1;0<=jc;jc--){const Qc=this.zYc[jc];if(+qb-+Qc.startTime>this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)break;Qc.qol===Na&&wb++}if(wb<this.la.podTriggerFailoverOnServerErrorsMaxTry)return!0;fd.a.J(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",Na,wb,this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)}return!1}nxh(Na){e.AFrameworkApplication.zz&&(this.Ci.Thc(Object(u.a)(this,
this.Mda,"onWopiTokenRefreshed")),this.XUb());if(++this.mOg>this.H7j)this.C2d("SeamlessFailoverMaxRetryCountReached",392);else if(this.la.wopiTokenRefreshLongerTimeoutIsEnable&&this.Ae.Amh(Object(u.a)(this,this.eYg,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs),+new Date-+this.Woe>=36E5*this.la.powerPointPodRecoveryStorageAgeThreshold)this.C2d("RecoveryStreamExpired",358);else{if(this.Ae.TUd&&(this.Ae.Uc.dB("Trigger",Dg[Na]+"_GetFileUrlExpired"),this.zCj())){this.C2d("GetFileUrlExpired_NoAzureBackup",
364);return}this.Ae.tOi&&this.Zli();this.Ci.Cbd(new Vg.a(4===Na?5:2));this.Ci.RFk();this.la.podsClosePopSessionBeforeSeamlessFailoverEnabled&&4===Na&&(fd.a.J(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Ce.tk),this.KN.nob(()=>{},()=>{}));this.vm.isPaused||this.vm.pause();this.Ae.Uc.Km("CreatePodsWithRetryST",new Date);this.Ae.Uc.Km("SessionStartTime",this.Woe);this.wbh()}}C2d(Na,qb){this.yb.Dra&&this.yb.nXa();this.Ae.Uc.dB("Result",Na);this.Zeb(!1,qb)}Ppk(){this.Ci.Thc(Object(u.a)(this,
this.Mda,"onWopiTokenRefreshed"));this.XUb();fd.a.J(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Ae.Uc.Wa("WopiTokenRefreshed","TO");e.AFrameworkApplication.Xo($e.a.Mh(382));Kc.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);e.AFrameworkApplication.wu&&e.AFrameworkApplication.wu.Z6();this.Ae.RYb=!0;this.ia.Ka(Qd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}Mda(Na,qb){Na=
qb.YTc;this.Ci.Thc(Object(u.a)(this,this.Mda,"onWopiTokenRefreshed"));this.XUb();this.la.w4g&&this.S9b.H4f(!0);qb=0<e.AFrameworkApplication.Ml&&(new Date).getTime()>=e.AFrameworkApplication.Ml-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs;fd.a.J(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",Na,(new Date).getTime(),new Date,e.AFrameworkApplication.Ml,new Date(e.AFrameworkApplication.Ml));
this.Ae.Uc.Wa("WopiTokenRefreshed","True");this.Ae.Uc.Wa("WopiTokenRefreshedSuccessfully",Na.toString());this.Ae.TUd=qb;Na?this.nxh(this.Ae.Jva):this.Ae.RYb=!0}XUb(){-1!==this.dre&&(window.clearTimeout(this.dre),this.dre=-1);-1!==this.p4c&&(window.clearTimeout(this.p4c),this.p4c=-1)}zCj(){const Na=Z.a.sg(this.$b.Ha("152")||""),qb=!e.AFrameworkApplication.Pg.IsRealEdit&&1!==this.Ae.Jva&&2!==this.Ae.Jva;return".pptx"!==Na&&".ppsx"!==Na||qb}Zli(){try{let Na=0,qb=0;const wb={},jc={};this.Uv.rYh(Qc=>{if(-1<
Qc.request.get_url().search(new RegExp(this.Ae.podsCleaningRequestPattern,"i")))return this.Vwh(wb,this.ycg(Qc.request.get_url())),Na++,!0;this.Vwh(jc,this.ycg(Qc.request.get_url()));qb++;return!1});fd.a.J(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",Na,wb,qb,jc)}catch(Na){fd.a.J(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",Na)}}ycg(Na){let qb=Na;const wb=Na.indexOf("?");0<
wb&&(qb=Na.substr(0,wb));Na=qb.lastIndexOf("/");0<Na&&(qb=qb.substr(Na+1));return qb}Vwh(Na,qb){Na[qb]=qb in Na?Na[qb]+1:1}eYg(){this.eZ&&(this.Ae.Uc.dB("Result","Timeout"),this.Ae.Uc.Wa("TimeoutDuration",(+new Date-+this.Ae.startTime).toString()),this.Zeb(!1,4===this.Ae.Jva?354:355))}Zeb(Na,qb=0,wb=!0){if(this.eZ){this.Gy.reb(Object(u.a)(this,this.Hda,"onPodSessionRefreshed"));this.Yb.zi.contentReplicator.Phc(Object(u.a)(this,this.pWg,"onAfterReplication"));var jc=+new Date-+this.Woe>=6E4*this.la.pptEditorFileGetUrlExpireTimeInMinutes;
e.AFrameworkApplication.zz&&(jc=0<e.AFrameworkApplication.Ml&&(new Date).getTime()>=e.AFrameworkApplication.Ml-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs)&&fd.a.J(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,e.AFrameworkApplication.Ml,new Date(e.AFrameworkApplication.Ml));Na&&jc&&this.Ae.Uc.Wa("SkipPopsReason","FileUrlExpired");this.hc.oBg();var Qc=this.Ae.Jva;this.Ae.Uc.Wa("IsInEditingMode",
this.hc.ln.toString());this.Ae.Uc.Wa("IsPreviousModeEditing",this.hc.q4b.toString());this.Ae.Uc.Wa("IsLastKnownModeEditing",this.hc.j9d.toString());this.Ae.Uc.Wa("PopSessionEverInitialized",this.Ue.Nec.toString());this.Ae.Uc.Wa("ResultErrorCode",Oa.a[qb]);this.Ae.Uc.Wa("RefreshPage",wb.toString());this.Ae.Uc.Wa("FRehydrationInitiatedPageRefresh",this.Ae.RYb.toString());this.Ae.fPi=Na;this.Ae.resultCode=qb;this.Ae.qhl();this.zYc.push(this.Ae);this.G7j||this.vJc();Na?(this.Ci.b$g(new Ih.a(Qc)),this.vxh(jc,
Qc)):(this.vJc(),0!==qb&&(Na=$e.a.Mh(qb),e.AFrameworkApplication.Xo(Na),Kc.Health.instance.recordQosError($e.a.Qaa(Na),["UnexpectedAppRefresh"],399===qb,!1,!0,wb,null)),wb?(e.AFrameworkApplication.wu&&e.AFrameworkApplication.wu.Z6(),this.ia.Ka(Qd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.Ci.b$g(new Ih.a(Qc)),this.vxh(jc,Qc)))}}TYb(){return this.Ae&&this.Ae.Uc?!0:!1}vJc(){this.TYb()&&(fd.a.J(512497874,801,15,"Action Telemetry: {0}",this.Ae.Uc.tIb()),this.Ae.Uc.finish(!0),
this.Ae.dispose(),this.Ae=null)}vxh(Na,qb){!this.hc.BK||Na||2!==qb&&1!==qb&&4!==qb?(this.TYb()&&this.Ae.Uc.Wa("PopsRehydrationAttempted","false"),fd.a.J(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",Na,qb),this.DSf(null)):(this.TYb()&&this.Ae.Uc.Wa("PopsRehydrationAttempted","true"),this.KN.eea(4===qb?6:7,Object(u.a)(this,this.nzi,"createPopSessionSucceededCallback"),Object(u.a)(this,this.DSf,"createPopSessionFailedCallback")))}nzi(){this.TYb()&&
(this.L3f(),this.Ae.Uc.Wa("POPSessionCreated","true"),this.vJc())}DSf(){if(!this.TYb())return!1;this.L3f();this.Ae.Uc.Wa("POPSessionCreated","false");this.vJc();return!1}L3f(){this.Ae.Uc.dB("IsInEditingMode",this.hc.ln.toString());this.Ae.Uc.dB("IsPreviousModeEditing",this.hc.q4b.toString());this.Ae.Uc.dB("PopSessionEverInitialized",this.Ue.Nec.toString())}sol(Na){fd.a.J(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",
this.$b.ka("UserHasValidLicenseForEnterpriseFonts"),this.$b.ka("PPTOEnterpriseFontsEnabled"));this.$b.ka("UserHasValidLicenseForEnterpriseFonts")&&this.$b.ka("PPTOEnterpriseFontsEnabled")&&tg(Na)}wbh(){this.Ae.YW=si.a();this.yb.Dra||this.yb.stop();let Na=this.la.restoreRCInCreatePodSessionRequest&&this.ta.Mj?this.ta.Mj.toString():"";Na=Z.a.replaceAll(Na,"#","%23");this.Pab.createPodSession(this.Ae.YW,"SeamlessFailover_"+this.Ae.Jva,this.Ae.$Na,+new Date-+this.Ae.startTime,Object(u.a)(this,this.mzi,
"createPodSessionSucceededCallback"),Object(u.a)(this,this.lzi,"createPodSessionFailedCallback"),this.AD,this.Ce.podSessionId,Na);this.Pab.Avl(this.Ae.YW,Object(u.a)(this,this.sol,"triggerFontsInstallationCallback"));this.yb.nXa()}mzi(Na){if(this.eZ){kb.a.Jjd=[];this.Ae.Uc.Wa("NewPodsId",this.Ae.YW);this.Ce.podSessionId=this.Ae.YW;this.Ae.Uc.Wa("CreatePodsWithRetryResult","true");this.Ae.Uc.Wa("CreatePodsRetryCount",this.Ae.$Na.toString());this.Ae.Uc.Wa("CreatePodsDuration",(+new Date-+this.Ae.startTime).toString());
this.vm.isPaused&&this.vm.yhb();try{this.vm.qLf()}catch(qb){fd.a.J(512497871,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",qb)}if(this.la.restoreRCInCreatePodSessionRequest&&Na&&Ae.a.rec in Na&&!Z.a.Va(Na[Ae.a.rec])){const qb=Boolean.parse(Na[Ae.a.rec]);this.Ae.Uc.Wa("RCRestoredWhenCreatePodSession",Na[Ae.a.rec]);qb?(this.Ae.Uc.dB("Result","Success"),this.Zeb(!0)):(this.Hee&&this.Hee.pmi(),this.Ae.Uc.Wa("DocRefreshTriggered","true"),Na={failedMachineId:null,isPlanedShutdown:!1,
fromSeamlessFailoverManager:!0},Na.podSessionId=this.Ce.podSessionId,this.Ae.RYb=!0,this.ia.Ka(Qd.a.jEb,2,Na))}else this.qxh()}}qxh(){this.Yb.zi.contentReplicator.Dzc(Object(u.a)(this,this.pWg,"onAfterReplication"));this.wol()}wol(){const Na=()=>{this.Ae.uEe=new Date;this.Ae.Uc.Km("InboundStartTime",this.Ae.uEe);this.Yb.zi.contentReplicator.OE(null,null,null)};fd.a.J(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.ta.Ba?
this.ta.Ba.sid:0,this.Ae.YW);4===this.Ae.Jva&&this.la.podsSeamlessFailoverForceInboundSlideEnabled&&this.ta.Ba?(this.GG.JPc&&this.GG.JPc.nqg(this.ta.Ba.Bb),this.Ae.Uc.Km("ForceInboundSlideStartTime",new Date),this.$u.fWd(this.ta.Ba,(qb,wb)=>{fd.a.J(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",qb,wb);this.eZ&&(this.Ae.Uc.Km("ForceInboundSlideEndTime",new Date),Na())},!0,!1)):Na()}lzi(Na){if(!this.eZ)return!0;const qb=+new Date-
+this.Ae.startTime;if(399===Na)return fd.a.J(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Ce.podSessionId,qb),this.Kd.qG(Na,null),this.Zeb(!1,Na,!1),!0;if(this.Ae.TUd&&230===Na)return fd.a.J(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Ce.podSessionId,qb),this.KZf("CreatePodSessionFailed_GetFileUrlFailed",
Na),!0;if(this.Ae.$Na<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryCount&&qb<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryDurationInMs){let wb;(wb=this.Ae).$Na=wb.$Na+1;fd.a.J(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Ce.podSessionId,this.Ae.$Na,qb,Na);this.wbh();return!0}fd.a.J(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Ce.podSessionId,this.Ae.$Na,qb,Na);this.KZf("CreatePodSessionFailed",Na);return!0}KZf(Na,qb){this.Ae.Uc.Wa("CreatePodsWithRetryResult","false");this.Ae.Uc.Wa("CreatePodsRetryCount",this.Ae.$Na.toString());this.Ae.Uc.Km("CreatePodsWithRetryET",new Date);this.Ae.Uc.dB("Result",Na);this.Ae.Uc.Wa("CreatePodsDuration",(+new Date-+this.Ae.startTime).toString());this.Zeb(!1,qb)}pWg(Na,qb){this.eZ&&(qb.Xug?fd.a.J(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",
qb.N8c):(this.Ae.Uc.dB("InboundDuration",(+new Date-+this.Ae.uEe).toString()),this.Ae.Uc.dB("Result","Success"),this.Zeb(!0)))}Hda(Na,qb){this.eZ&&(this.Ae.Uc.Wa("WaitPodsRefreshedDuration",(+new Date-+this.Ae.kAl).toString()),this.Ae.Uc.Wa("NewPodsId",qb.YW),this.Gy.reb(Object(u.a)(this,this.Hda,"onPodSessionRefreshed")),this.vm.isPaused&&this.vm.yhb(),this.qxh())}}Object(h.a)(hf,"PodSeamlessFailoverManager",null,[730]);class ld{constructor(Na,qb,wb){this.Rsa=Na;this.Xa=wb}EY(){}CSb(){}D2a(Na){Na&&
(Array.add(Na,Ae.a.rxe),Array.add(Na,Ae.a.H9),Array.add(Na,Ae.a.VCb),Array.add(Na,Ae.a.xsk),Array.add(Na,Ae.a.rec))}Iba(Na,qb){qb?((qb=Na[Ae.a.VCb])&&qb.toLowerCase()!==(this.Xa.I9?this.Xa.I9.toLowerCase():"")&&(fd.a.J(512497857,821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",qb),this.Xa.I9=qb),this.Rsa?(Na=Na[Ae.a.rxe])?(this.Rsa.ccpInfo=Na,fd.a.J(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",Na.length)):fd.a.J(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):
fd.a.J(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):fd.a.J(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}Object(h.a)(ld,"RehydrationHeaderHandler",null,[751]);class ph{constructor(Na,qb,wb,jc,Qc,Cd,Ld,ie,Qe){this.HN=null;this.wYc=!1;this.vf=Na;this.Mc=qb;this.l9b=wb;this.gd=jc;this.ve=Qc;this.zOg=ie;this.Ga=Cd;this.zo=Ld;this.O3c=Qe}init(){this.Mc&&(this.Mc.DGd(Object(u.a)(this,this.sessionExpired,"sessionExpired")),
this.Mc.O2a(Object(u.a)(this,this.gnk,"onRehydrateSession")))}sessionExpired(){this.fqh(!0);n.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");Kc.Health.instance.stopAllHealthTimers()}xbh(Na){this.fqh(!1);const qb=e.AFrameworkApplication.zz||!Vf.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");n.ULS.sendTraceTag(544789148,821,100,"Should refresh token: {0}",qb);qb&&this.O3c&&this.O3c.FLd(0);this.Ga.podsSeamlessFailoverEnabled&&this.zo.IQe(!1,Na,223)}gnk(){n.ULS.sendTraceTag(594616333,
821,50,"Resuming health heartbeat");Kc.Health.instance.resumeAllHealthTimers()}fqh(Na){this.wYc!==Na&&this.vf&&(Na?(this.HN||(this.HN=this.ve.Ee(),this.HN.id="sessiontimeoutoverlay",this.HN.className="SessionTimeoutOverlay",this.HN.tabIndex=-1,this.Z$h(this.HN),this.vf.appendChild(this.HN)),this.wYc=!0,this.zOg(this.HN)):(this.OVf(this.HN),this.HN&&this.HN.parentNode&&this.HN.parentNode.removeChild(this.HN),this.HN=null,this.wYc=!1))}Z$h(Na){Na&&(this.gd.ob(I.a.click,Na,Object(u.a)(this,this.b7a,
"handleClickEvent")),this.gd.ob(I.a.doubleClick,Na,Object(u.a)(this,this.b7a,"handleClickEvent")),this.l9b.ob(I.a.eg,Na,Object(u.a)(this,this.ohg,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(u.a)(this,this.onVisibilityChange,"onVisibilityChange")))}OVf(Na){Na&&(this.gd.xb(I.a.click,Na,Object(u.a)(this,this.b7a,"handleClickEvent")),this.gd.xb(I.a.doubleClick,Na,Object(u.a)(this,this.b7a,"handleClickEvent")),this.l9b.xb(I.a.eg,Na,Object(u.a)(this,this.ohg,"handleKeyEvent")),$removeHandler(window,
"visibilitychange",Object(u.a)(this,this.onVisibilityChange,"onVisibilityChange")))}b7a(){this.xbh(1);return!0}ohg(Na){if(Na.lc.ctrlKey||Na.lc.altKey||Na.lc.shiftKey||Na.lc.keyCode>=H.a.$Jb&&Na.lc.keyCode<=H.a.MJa)return!1;this.xbh(2);return!0}onVisibilityChange(){e.AFrameworkApplication.zz&&!window.document.hidden&&this.O3c&&this.O3c.FLd(1)}dispose(){this.Mc.udh(Object(u.a)(this,this.sessionExpired,"sessionExpired"));this.HN&&(this.OVf(this.HN),this.HN.parentNode&&this.HN.parentNode.removeChild(this.HN));
this.l9b=this.gd=null;this.wYc=!1;this.zOg=null}}Object(h.a)(ph,"SessionRehydrationController",null,[]);class Kf{constructor(){this.Da=null}Wb(Na){this.Da=Na||w.a.instance}dispose(){}}Object(h.a)(Kf,"TellMePackage",null,[2,3]);var Ud=d(118),He=d(27),Bh=d(15),eg=d(104),jd=d(913);class Jh{constructor(Na=null,qb=null,wb=null,jc,Qc=null){this.Vnd=null;this.BVe=!1;this.Y1e=this.uib=null;this.fVh=this.iuf=this.lHh=this.Z1e=!1;this.Vpc=null;this.uHh=null==qb?e.AFrameworkApplication.Anb:qb;this.jNh=null==
wb?e.AFrameworkApplication.JCa:wb;this.AVh=null==Qc?e.AFrameworkApplication.Bwa:Qc;this.yMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeHelpOnHelpIsEnabled");this.DWh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled");this.c7k(!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIgnoreQueryForHelp"));this.uWh=!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.gb.X4b;this.vWh=!eg.a.Kw()&&!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("TellMePeopleSuggestionIsEnabled");this.tWh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeFileSuggestionIsEnabled");this.mLh=!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.gb.QGb;this.wWh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.RUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("HelpShowsTopSearchResult");this.nRh=this.ikc||this.hkc;this.lRh=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("OnlineCommandSuggestionsIsEnabled");this.mRh=this.y9d;this.COh=!!e.AFrameworkApplication.fa&&this.Wwa&&e.AFrameworkApplication.fa.ka("StyledHeaderInLabelIsEnabled");this.VLh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.cMh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",
1400):1400;this.SLh=e.AFrameworkApplication.fa?parseFloat(e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.zOh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.QVh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl",
"https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.fMh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.SUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.oVh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.bVh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("ShowFindInDocumentInZeroTermSearchBox")||this.eH;this.KOh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeTemplateProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.hOh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",
!1);this.wOh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIsRuleBasedSortingEnabled")&&"en-US"===e.AFrameworkApplication.uiCulture;this.HOh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeFeedbackProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.VOh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeZeroTermContextualCommandSuggestionsEnabled");this.nHh=
this.Wwa&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.tMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.tVh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==e.AFrameworkApplication.fa.Ha("Application"));
this.UHh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.GXh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||e.AFrameworkApplication.fa.ka("TellMePerformanceMarkerEnabled"));this.rNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",
!1);this.vNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.xOh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.bUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.OGh=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.bMh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.JOh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeNotesSuggestionIsEnabled")||this.xxg;this.tNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",
!1);this.uNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.sNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.xWh=this.xOj&&(this.Fwe||this.Gwe||this.Pdc||this.Wwa&&eg.a.aja()&&!!e.AFrameworkApplication.fa&&(this.WGb||this.agb||this.bgb||this.cgb||this.XGb||e.AFrameworkApplication.fa.ka("ShowAnswerSearchResults")||
e.AFrameworkApplication.fa.ka("ShowDefinitionSearchResults")||e.AFrameworkApplication.fa.ka("ShowEntitySearchResults")||e.AFrameworkApplication.fa.ka("ShowWolframSearchResults")));this.PGh=!!e.AFrameworkApplication.fa&&!e.AFrameworkApplication.fa.ka("AppsForOfficeThirdPartyIsDisabled")&&e.AFrameworkApplication.fa.ka("AppsForOfficeAllowExternalMarketplace")&&e.AFrameworkApplication.ypa;this.QGh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("AppsForOfficePrivateCatalogIsEnabled");this.Ywj(Na||
{});this.fBd="2918242107";this.eBd="1454393937";this.f1a={};this.yMa=[];this.Eti=[eg.a.Mkd]}get application(){return this.uib}get Anb(){return this.uHh}get wYk(){return this.fBd}get vYk(){return this.eBd}get J2f(){return this.Y1e}get kRi(){return this.Z1e}get JCa(){return this.jNh}get Bwa(){return this.AVh}get Y2a(){return this.lHh}get Nrj(){return this.yMh}get Vkl(){return this.DWh}get xOj(){return!0}get Kkl(){return this.xWh}get r9k(){return this.iuf}c7k(Na){this.iuf=Na}get Wwa(){return this.uWh}get Olc(){return this.vWh}get Nlc(){return this.tWh}get bQi(){return this.mLh}get Ikl(){return this.wWh}get RQe(){return!1}get Pdc(){return this.nRh}get Fwe(){return this.lRh}get Gwe(){return this.mRh}get kSa(){return!1}get TTc(){return!1}get Z$d(){return this.COh}get YKe(){return this.fVh}get WGb(){return!1}get A$k(){return!1}get pSj(){return""}get z$i(){return 4}get A$i(){return 5}get Rbj(){return""}get M2i(){return this.VLh}get Bdg(){return this.cMh}get Tbj(){return 1E3}get Sbj(){return 1E-6}get ail(){return this.QVh}get RNe(){return!1}get $hl(){return!1}get hMj(){return this.wOh}get CTc(){return!1}get F$d(){return!1}get JIj(){return!1}get IIj(){return!1}get xxg(){return!1}get Axg(){return!1}get K2f(){return!1}get RGb(){return!1}get agb(){return!1}get bgb(){return!1}get cgb(){return!1}get XGb(){return!1}get ikc(){return this.RUh}get SGb(){return this.SUh}get hkc(){return!1}get TXd(){return null}get A$d(){return!1}get Ngd(){return this.bVh}get dbg(){return 0}get vZi(){return this.SLh}get ceg(){return this.fMh}get DNj(){return this.zOh}get Lag(){return-3.9}get eH(){return this.oVh}get Y4b(){return this.KOh}get E9d(){return this.hOh}get kae(){return this.HOh}get bNa(){return this.nHh}get vQj(){return this.VOh}get ria(){return this.tMh}get arh(){return this.tVh}get Aci(){return this.UHh}get emd(){return this.GXh}get YQc(){return this.rNh}get yBj(){return this.vNh}get zMj(){return this.xOh}get uih(){return this.bUh}get p6h(){return this.OGh}get fr(){return this.bMh}get lSa(){return this.JOh}get wBj(){return this.tNh}get xBj(){return this.uNh}get vBj(){return this.sNh}get pDf(){return this.PGh}get qDf(){return this.QGh}get Mp(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.gb.uo}get uo(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.gb.uo}get OIj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.gb.Mma}get Wek(){return Ja.getImageClass("OfficeAssistant_32x32x32")}X2i(){return Promise.reject("GetFindMatchCount method is not overridden")}fUc(Na){return Array.contains(appChrome.selectors.getVisibleControlIds(),Na)}V7d(){return!1}get u9d(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeModelRankerEnabled")}get xvh(){return e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.Ha("TellMeServiceHelpClassifierModelName"):""}get y9d(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeMultiLingualCommandModelEnabled")}get YOc(){return"NoOpHeaderUi"}get Dti(){return this.Vpc}get parameterData(){return this.f1a}get zql(){return this.yMa}kMi(){if(this.Vnd&&!this.BVe&&(this.BVe=!0,this.egd(this.Vnd),this.uo)){var Na=w.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Na=(new jd.a(Na)).PWd(this.Vnd.l$);appChrome.api.dispatch(Na)}}get xih(){return""}egd(){}sFi(Na){const qb=
[];for(let wb=0;wb<Na.length;++wb)Na[wb].ial?qb.push(new Bh.a(Na[wb].alternate,eg.a.Dyh+wb.toString())):qb.push(new Bh.a(Na[wb].standard,eg.a.Mkd+wb.toString()));return qb}Ywj(Na){const qb={};for(let wb in Na){const jc=wb,Qc=Na[wb];for(let Cd in Qc){const Ld=Cd,ie=Qc[Cd];(qb[Ld]||(qb[Ld]={}))[jc]=ie}}this.Vpc=qb}get zvh(){return""}get yvh(){return""}get qqh(){return!1}}Object(h.a)(Jh,"TellMeApplicationData",null,[943]);class kf{constructor(Na,qb=null,wb=!1){this.standard=Na;this.alternate=qb;this.ial=
wb}}Object(h.a)(kf,"TryQuerySet",null,[]);class Ji{constructor(){this.aef=this.bef=null}get udk(){return this.aef}dK(Na){this.bef=Na;return this.myi(Na)}Ifk(){this.aef=this.bef}w5i(Na){return 8===Na.type?String.format(CommonUIStrings.l_FindInDocumentText,Na.TI):Na.TI}g_i(Na){return Na.TI}}Object(h.a)(Ji,"ParameterizedCommand",null,[]);class hh extends Ji{constructor(Na){super();this.jNj=Na}get commandId(){return this.jNj?"FindParameterized":"EditingFind"}get Jsk(){return"Find"}myi(Na){if(!Na)return null;
const qb=Z.a.ie(String.format(ResourceStrings.l_ParamFindInDocTitle,Na.TI));return qa.a(eg.a.JBi(Na.value),"1540292897",qb,"Find_16x16x32",null,Z.a.ie(Na.TI),qb,null,null)}}Object(h.a)(hh,"FindParameterizedCommand",Ji,[]);var Wb=d(122);class Uc extends Jh{constructor(){super(window.TellMeControlMetadataOverrides);this.uib="PowerPoint";if(e.AFrameworkApplication.fa.ka("TellMeTryQueriesIsEnabled")){var Na=[new kf(ResourceStrings.l_TellMeTryQuery01,"",!1),new kf(ResourceStrings.l_TellMeTryQuery02,"",
!1),new kf(ResourceStrings.l_TellMeTryQuery03,"",!1),new kf(ResourceStrings.l_TellMeTryQuery04,"",!1),new kf(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.yMa=this.sFi(Na)}e.AFrameworkApplication.fa.ka("TellMeFindInDocumentIsEnabled")&&(Na=new hh(Uc.iNj()),this.parameterData[Na.commandId]=Na,this.Z1e=!0,this.Y1e=Na.commandId)}get MHa(){return Wb.a.sJf}egd(Na){if(Na){Na=Na.l$;var qb=e.AFrameworkApplication.fa;Na["PptTellMe.Animation"]=!qb.ka("TellMeAnimationsTransitionsIsEnabled")||qb.ka("241");
Na["PptTellMe.Transition"]=!qb.ka("TellMeAnimationsTransitionsIsEnabled");Na["PptTellMe.SelectAll"]=!qb.ka("TellMeSelectAllResultIsEnabled");Na["PptTellMe.AnimationNew"]=!qb.ka("241")||!qb.ka("TellMeAnimationsTransitionsIsEnabled");Na["PptTellMe.Designer"]=!qb.ka("248");qb=qb.ka("TellMeDesktopUpSellIsEnabled");var wb=e.AFrameworkApplication.yOj;Na["PptTellMe.WordArtUpSellButton"]=!qb||wb;Na["PptTellMe.SpellCheckDictUpSellButton"]=!qb||wb;Na["PptTellMe.InsertAudioUpSellButton"]=!qb||wb;Na["PptTellMe.InsertChartUpSellButton"]=
!qb||wb;Na["PptTellMe.WordArtUpSellButtonEnterprise"]=!qb||!wb;Na["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=!qb||!wb;Na["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!qb||!wb;Na["PptTellMe.InsertChartUpSellButtonEnterprise"]=!qb||!wb}}get xxg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",!1)}get Axg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get dbg(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",2)}get zvh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermModelName","")}get yvh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get RNe(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",
!1)}get xvh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get WGb(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",!1)}get y9d(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get qqh(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",
!1)}get TTc(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",!1)}get TXd(){const Na={};e.AFrameworkApplication.fa.ka("PPTOModernFontPickerIsEnabled")?Na.FontName="FontPicker":Na.FontPicker="FontName";e.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")?(Na.NewSlide="NewSlideSplit",Na.ChangeLayout="ChangeLayoutFlyout"):(Na.NewSlideSplit="NewSlide",Na.ChangeLayoutFlyout="ChangeLayout");return Na}get Lag(){var Na=e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold",
"-3.9");Na=parseFloat(Na);return isNaN(Na)?-3.9:Na}get CTc(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",!1)}get pDf(){return e.AFrameworkApplication.fa.ka("51")}get qDf(){return e.AFrameworkApplication.fa.ka("305")}static iNj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.gb.Mp}}Object(h.a)(Uc,"PowerPointTellMeApplicationData",Jh,[]);class Sc extends Kf{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(e.AFrameworkApplication.svh){var Na=
He.App.Fb.gb.K0d(tb.a.tellMe);Na.IRc?Sc.H4g():Na.HR(Object(u.a)(this,this.iYk,"scriptResource_LoadFinished"));var qb=new Uc;Ud.TellMeActor.instance.initialize(qb,null,null,null,null,null,Object(u.a)(He.App.Fb,He.App.Fb.K4f,"forceUpdateRibbonControls"),e.AFrameworkApplication.fa,this.Da.La("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Da.La("Common.IActionContextProvider"),this.Da.La("Common.ISystemInitiatedFeedback"));Ud.TellMeActor.instance.aKk(Na)}}iYk(){Sc.H4g()}static H4g(){He.App.Fb.updateCommandUI()}}
Object(h.a)(Sc,"PowerPointTellMePackage",Kf,[]);var Od=d(207);class ug{constructor(){this.gh=this.G3=this.K=null}get name(){return"PowerPointWebEditor.Chronos1"}Wb(Na){this.K=Na;this.G3=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.gh=this.G3.UBa(4,this.name);this.K.register(ld,"PowerPointWebEditor.RehydrationHeaderHandler").ma().na(()=>new ld(this.K.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));
this.K.register(ph,"PowerPointWebEditor.SessionRehydrationController").ma().na(()=>new ph(this.K.resolve("Box4.IAppFrame").kG(),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IKeyInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),qb=>{A.FocusManager.Dr(qb)},e.AFrameworkApplication.zz?
this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):null));this.K.register(730,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").ma().na(()=>new hf(this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IActionManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),
this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.IPopSessionState"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),
this.K.resolve("PowerPointWebEditor.Image.IImageManager"),e.AFrameworkApplication.He,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.La("PowerPointWebEditor.ICommentSessionManager")));e.AFrameworkApplication.zz&&this.K.register(731,"PowerPointWebEditor.IPPTTokenRefreshManager").ma().na(()=>new Ye(this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
this.K.resolve("Common.ISessionExpirationManagerWithDialog"),this.K.resolve("PowerPointWebEditor.PresentationContext"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let Na=this.gh.Zt("resolvechronos1");const qb=this.K.resolve("Common.AFrameworkApplication"),wb=this.K.resolve("PowerPointWebEditor.IApplicationContext").kd;var jc=
this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const Qc=this.K.resolve("Common.IActionManagerExtended"),Cd=this.K.resolve("PowerPointWebEditor.IFocusManager"),Ld=this.K.resolve("Common.Transaction.ITransactionFactory"),ie=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Qe=this.K.resolve("PowerPointWebEditor.IShapeEditor"),df=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),tf=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),
jh=this.K.resolve("PowerPointWebEditor.PictureContext"),Dh=this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),ch=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Hg=this.K.resolve("PowerPointWebEditor.IPictureUploader");this.gh.gu(Na);Na=this.gh.Zt("regactorschronos1");jc=[new Pc(Qc,df,ie,Cd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ld,Hg,jh,Qe,e.AFrameworkApplication.ZP,ch,this.K.resolve("PowerPointWebEditor.IErrorHandler"),jc,this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),
wb.TGj,this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),Dh,tf,wb,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))];for(var wh of jc)wh.ub(),wh.we();this.Jwj();this.gh.gu(Na);Na=this.gh.Zt("tellme");wh=new Sc;wh.Wb(this.K);wh.load(qb);this.gh.gu(Na);wb.pptEditorTimeoutDialogRemovalIsEnabled&&wb.vg&&(Na=this.gh.Zt("initrehydrationcontroller"),this.K.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.gh.gu(Na));
wb.podsSeamlessFailoverEnabled&&this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");e.AFrameworkApplication.zz&&(Na=this.gh.Zt("posttokenrefresh"),this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.gh.gu(Na));this.pTj()}Jwj(){const Na=this.K.resolve("Common.IActionManagerExtended"),qb=this.K.resolve("PowerPointWebEditor.IFocusManager"),wb=this.K.resolve("Common.AFrameworkApplication").$q.Ed,jc=this.K.resolve("Common.Transaction.ITransactionFactory"),Qc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
Cd=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Ld=this.K.resolve("PowerPoint.IPathManager"),ie=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Qe=this.K.resolve("Common.IDynamicScriptLoaderProvider").yv;Qe.loadScript("powerpoint-editor-intl").then(()=>{fd.a.J(512497373,801,50,"Editor script is loaded successfully");Qe.loadScript("powerpoint-ribbon-intl").then(()=>{fd.a.J(512497372,801,50,"Ribbon script is loaded successfully");const df=[];df.push(new bd(Na,
qb,Cd,jc,wb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ie,Qc,Ld));for(const tf of df)tf.ub(),tf.we()}).catch(()=>{fd.a.J(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{fd.a.J(512497370,801,10,"Failed to load Editor script")})}pTj(){fd.a.J(512497369,809,50,"Start to download chronos2 js file");this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Iha("pptedit.chronos2",()=>{const Na=this.K.resolve("PowerPointWebEditor.ISessionState");Na&&Na.w4("Chronos2DownloadFinished")},
()=>d.e(8).then(d.bind(null,1194)))}dispose(){const Na=this.K.resolve("PowerPointWebEditor.IApplicationSettings");Na.pptEditorTimeoutDialogRemovalIsEnabled&&Na.vg&&this.K.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();e.AFrameworkApplication.zz&&Na.vg&&this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){e.AFrameworkApplication.Xg&&hb.a.$f?fd.a.J(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):m.a.instance.Ac(Od.a(new ug,
4))}}Object(h.a)(ug,"Chronos1Package",null,[2,3]);var te=d(634),mf=d(138),Yf=d(571),Jd=d(59),ce=d(46);class fe{constructor(Na,qb,wb,jc,Qc,Cd){this.type="FormatPictureTaskPaneProps";this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.disabled=!1;this.onChange=null;this.emptyValueFields=0;const Ld=Object(qd.a)(Object,Cb.e().numberFormatInfo);if(!Ld)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=Ld;this.width=Na;this.height=qb;this.top=jc;this.left=wb;this.disabled=
Qc;this.emptyValueFields=Cd}}Object(h.a)(fe,"FormatPictureTaskPaneProps",null,[]);class Gg{constructor(Na,qb,wb,jc,Qc,Cd,Ld,ie,Qe,df,tf,jh){this.f$a=!0;this.uQg=this.wKg=this.b_=this.z_=0;this.MUa=this.Ib=this.iFg=!1;jh.loadScript("powerpoint-editor-intl").then(()=>{this.MUa=!0}).catch(Dh=>{fd.a.J(512350083,801,10,"Failed to load powerpoint-editor-intl "+Dh.toString())});this.nb=Na;this.Nb=qb;this.ia=wb;this.Fa=jc;this.Lg=Qc;this.ta=Cd;this.Qb=Ld;this.Rj=ie;this.g8=Qe;this.Xb=df;this.Qc=tf;this.Lg.Aza(Object(u.a)(this,
this.C6c,"onChangeRenderFormatPicturePane"));this.Nb.vM(Object(u.a)(this,this.$v,"onAppFrameModeSwitched"));this.Qc.QMa(Object(u.a)(this,this.C6c,"onChangeRenderFormatPicturePane"))}dispose(){this.Lg.YWa(Object(u.a)(this,this.C6c,"onChangeRenderFormatPicturePane"));this.Nb.rX(Object(u.a)(this,this.$v,"onAppFrameModeSwitched"));this.Qc.qeb(Object(u.a)(this,this.C6c,"onChangeRenderFormatPicturePane"))}we(){}ub(){this.ia.pa(Qd.a.dbd,Ge.a.application,Object(u.a)(this,this.dbd,"queryShowHideReactPictureCropPane"),
96);this.ia.pa(Qd.a.yLe,Ge.a.application,Object(u.a)(this,this.yLe,"showHideReactPictureCropPane"),4);this.ia.pa(Qd.a.sJb,Ge.a.application,Object(u.a)(this,this.sJb,"updatePictureCropPane"),4)}dbd(Na,qb,wb,jc,Qc){(Na=Object(qd.a)(le.a,Qc))&&Na.Kf(this.Ib);return 32}yLe(Na,qb,wb){if(!this.MUa)return 8;if(1===wb)return 32;qb=this.ta.presentation;return this.ta.Ba&&qb&&!this.Xb.Zc(qb)?hd.b("ShowHideReactPictureCropPane:",this.Ib.toString(),Na,()=>{if(this.Ib=!this.Ib){if(this.Kl(),Vf.a("CropControlEnableOnDisplayingFormatPicturePane")){const jc=
this.nb.jq();(null===jc||void 0===jc?0:jc.yx)||this.ia.processAction(Qd.a.sTf,2)}}else this.Ds();return 32}):16}sJb(Na,qb,wb){if(!this.Ib)return 8;2===wb&&this.Kl(!0);return 32}Kl(Na=!1){var qb=this.$Mc();qb=this.IB(qb);const wb=Object.assign(new te.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:qb,onOpen:()=>{},onClose:()=>{this.Ib=!1},isModernPane:!0});mf.UISurfaces.Cs().then(jc=>{Na?jc.updateTaskPane(ce.a.vWa,wb):jc.showTaskPane(ce.a.vWa,wb);return null}).catch(jc=>
{fd.a.J(512350082,822,10,"Failed to show picture crop pane. Exception: "+jc.toString())})}Ds(){mf.UISurfaces.Cs().then(Na=>{Na.hideTaskPane(ce.a.vWa,2);return null}).catch(Na=>{fd.a.J(512350081,822,10,"Failed to hide picture crop pane. Exception: "+Na.toString())})}IB(Na){if(Na){const qb=Na.WXd(),wb=this.Qb.Cd;this.b_=Yf.a.mv(wb.Ef(this.Rj.KQ(Jd.a.Rl(qb.ga(0),qb.ga(3)),Na.zoom),1));this.z_=Yf.a.mv(wb.Ef(this.Rj.KQ(Jd.a.Rl(qb.ga(0),qb.ga(1)),Na.zoom),0));this.wKg=Yf.a.mv(wb.Ef(this.Rj.KQ(qb.ga(0).x,
Na.zoom),0));this.uQg=Yf.a.mv(wb.Ef(this.Rj.KQ(qb.ga(0).y,Na.zoom),1));this.f$a=!1;this.iFg=!0}else this.f$a=!0;Na=new fe(this.z_,this.b_,this.wKg,this.uQg,this.f$a,this.iFg?0:15);Na.onChange=Object(u.a)(this,this.ava,"onPropertyChange");return Na}$Mc(){const Na=this.nb.jq();return Na&&Na.yx&&Na.isConnected?this.g8.VE(Na):null}ava(Na,qb){const wb={};wb.Number=Na;switch(qb){case 0:this.ia.Ka(Qd.a.ZSe,2,wb);break;case 1:this.ia.Ka(Qd.a.WSe,2,wb);break;case 2:this.ia.Ka(Qd.a.XSe,2,wb);break;case 3:this.ia.Ka(Qd.a.YSe,
2,wb)}this.Kl(!0)}C6c(){this.Ib&&this.Kl(!0)}$v(Na){1===Na.mode&&this.Ib&&(this.Ib=!1,this.Ds(),this.Fa.Gj(ce.a.vWa,this.Ib))}}Object(h.a)(Gg,"FormatPicturePaneActor",null,[]);var Me=d(837);class se{constructor(Na,qb,wb,jc,Qc,Cd,Ld,ie,Qe,df,tf,jh,Dh,ch,Hg,wh,Yh,Ni){this.Yxb=!1;if(!Hg)throw Error.argumentNull("shapeReader");if(wh&&!Yh)throw Error.argumentNull("shapeSVGDependencyLoader");if(!Ni)throw Error.argumentNull("businessBarController");this.ia=Na;this.ra=qb;this.Db=wb;this.ni=jc;this.Xb=Qc;
this.Hke=Cd;this.nIg=Ld;this.vo=ie;this.Qb=Qe;this.ta=df;this.Rj=tf;this.g8=jh;this.VK=Dh;this.e_=ch;this.Ea=Hg;this.ska=wh;this.dAb=Yh;this.ql=Ni}ub(){this.ia.pa(Qd.a.sTf,Q.a.application,Object(u.a)(this,this.o1b,"handlePictureCropEvent"),4);this.nIg?(this.ia.pa(Qd.a.pTf,Q.a.application,Object(u.a)(this,this.Ngg,"handleCropSplitButton"),4),this.ia.pa(Qd.a.qTf,Q.a.application,Object(u.a)(this,this.Ngg,"handleCropSplitButton"),4)):(this.ia.pa(Qd.a.pTf,Q.a.application,Object(u.a)(this,this.o1b,"handlePictureCropEvent"),
4),this.ia.pa(Qd.a.qTf,Q.a.application,Object(u.a)(this,this.o1b,"handlePictureCropEvent"),4));this.ia.pa(Qd.a.t8g,Q.a.application,Object(u.a)(this,this.KCk,"queryIsActive"),101);this.ia.pa(Qd.a.hjc,Q.a.application,Object(u.a)(this,this.Poj,"handleSendCropInfo"),4);this.ia.pa(Qd.a.dvk,Q.a.application,Object(u.a)(this,this.W2d,"handlePictureCropToShapeEvent"),4);this.ia.pa(Qd.a.cvk,Q.a.application,Object(u.a)(this,this.W2d,"handlePictureCropToShapeEvent"),4);this.ia.pa(Qd.a.egc,Q.a.application,Object(u.a)(this,
this.Aad,"queryPictureCropBounding"),100);this.ia.pa(Qd.a.ggc,Q.a.application,Object(u.a)(this,this.Aad,"queryPictureCropBounding"),100);this.ia.pa(Qd.a.fgc,Q.a.application,Object(u.a)(this,this.Aad,"queryPictureCropBounding"),100);this.ia.pa(Qd.a.Bad,Q.a.application,Object(u.a)(this,this.Aad,"queryPictureCropBounding"),100);this.ia.pa(Qd.a.WSe,Q.a.application,Object(u.a)(this,this.Gld,"updatePictureCropBounding"),4);this.ia.pa(Qd.a.ZSe,Q.a.application,Object(u.a)(this,this.Gld,"updatePictureCropBounding"),
4);this.ia.pa(Qd.a.XSe,Q.a.application,Object(u.a)(this,this.Gld,"updatePictureCropBounding"),4);this.ia.pa(Qd.a.YSe,Q.a.application,Object(u.a)(this,this.Gld,"updatePictureCropBounding"),4)}Ngg(Na,qb,wb,jc,Qc){return 1===wb?32===this.W2d(Na,qb,wb,jc,Qc)||32===this.o1b(Na,qb,wb,jc,Qc)?32:8:this.o1b(Na,qb,wb,jc,Qc)}Poj(Na,qb,wb,jc,Qc){if(!Qc)return fd.a.J(512500482,824,50,"Send Crop Info called with no cropping info"),8;qb=Qc.pictCropperInfo;Qc=Qc.shapeNode;if(!Qc||!Qc.pictureCropInfo)return fd.a.J(512500481,
824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===wb)return 32;if(wb=kb.a.Cb)wb.actionName="EndCropPicture",wb.Ij=!1,wb.Ar=!0;wb=this.Db.rd(15);try{wb.jc(Qc),wb.$c=Na,Qc.Dec=qb}finally{wb&&wb.dispose()}return 32}W2d(Na,qb,wb,jc,Qc){if(!this.nIg||this.Xb.Zc(this.ra.Ip()))return 8;qb=this.ra.mg();if(!qb||!qb.length)return 8;const Cd=[];for(var Ld of qb)Ld&&Cd.push(Ld);if(!Cd.length)return 8;for(const df of Cd)if(df.isLocal||this.VK.KV(df)||!this.wKj(df))return 8;if(1===wb)return 32;
fd.a.J(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const ie=Qc?Qc.SourceControlId:"";Ld=0;wb=ie.split("_");if(3===wb.length)Ld=Number.parseInvariant(wb[2]);else return fd.a.J(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",ie),16;wb=window.performance.now();Qc=new Me.a;Qc.TargetShapeTypeAsInt=Ld;Ld=this.Db.rd(15,void 0,()=>{for(const df of Cd)if(df.yx){const tf=this.Jk(df);tf&&tf.$_(!1)}fd.a.J(512500450,
824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",ie)});try{Ld.jc(Cd[0]);Ld.$c=Na;for(var Qe of Cd)Qe.Eec=Qc}finally{Ld&&Ld.dispose()}Na=window.performance.now();if(Qe=kb.a.Cb)Qe.actionName="PictureCropToShape",Qe.Wa("PictureCropShapeType",Qc.TargetShapeTypeAsInt.toString()),Qe.Wa("PictureCropToShapeDuration",(Na-wb).toString()),kb.a.dea(Qe);fd.a.J(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",
Qc.TargetShapeTypeAsInt);return 32}o1b(Na,qb,wb){if(!this.Hke||this.Xb.Zc(this.ra.Ip()))return 16;if(this.ska&&!this.dAb.eug)return fd.a.J(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),8;qb=this.ra.ae();const jc=this.ra.LYd(qb);if(1!==qb.length)return Vf.a("CropCannotBePerformedOnCurrentSelection")&&1!==wb&&this.cXf(),8;if(!jc)return 8;if(this.Ea.py(jc).length)return Vf.a("CropCannotBePerformedOnCurrentSelection")&&1!==wb&&this.cXf(),8;
if(!this.X9d(jc))return 8;if(1===wb)return 32;if(jc.isLocal||this.VK.KV(jc))return 16;if(jc.yx){Na=this.Jk(jc);if(!Na)return 8;Na.$_(!1);jc.pictureCropInfo=null;He.App.Fb.updateCommandUI();this.ia.processAction(Qd.a.sJb,2);return 32}this.ra.hj();const Qc=this.ta.Ba;this.Xb.blockContent(Qc,Na);const Cd=kb.a.Cb;Cd&&(Cd.actionName="BeginCropPicture",Cd.Ij=!1,Cd.Ar=!0);this.ni.Jbg(jc.get_sid(),jc.get_cid(),jc.get_shapeId(),Ld=>{kb.a.LE(Cd,()=>{this.kkk(jc,Qc,Ld)})},()=>this.jkk(jc,Qc),!0);return 32}KCk(Na,
qb,wb,jc,Qc){if(!Object(Td.a)(le.a,Qc))return 8;Na=this.ra.jq();Qc.Kf(Na?Na.yx:!1);return 32}$Mc(){const Na=this.ra.jq();return Na&&Na.yx&&Na.isConnected?this.g8.VE(Na):null}Jk(Na){return Na?Object(qd.a)(124,Na.oc(this.Qb.Ma)):null}cXf(){this.ql.MM(26)}Aad(Na,qb,wb,jc,Qc){if(!this.Hke||!Qc)return 16;qb=this.$Mc();if(!qb)return 16;wb=qb.WXd();jc=this.Qb.Cd;Na=Na===Qd.a.egc?jc.Ef(this.Rj.KQ(Jd.a.Rl(wb.ga(0),wb.ga(3)),qb.zoom),1):Na===Qd.a.ggc?jc.Ef(this.Rj.KQ(Jd.a.Rl(wb.ga(0),wb.ga(1)),qb.zoom),0):
Na===Qd.a.fgc?jc.Ef(this.Rj.KQ(wb.ga(0).x,qb.zoom),0):jc.Ef(this.Rj.KQ(wb.ga(0).y,qb.zoom),1);Qc=Qc.queryResult;null!==Qc&&(Qc.Fea=parseFloat(Yf.a.mv(Na).toFixed(2)).toString());return 32}Gld(Na,qb,wb,jc,Qc){if(!this.Hke||this.ska&&!this.dAb.eug)return 16;qb=this.$Mc();if(1===wb)return qb?32:16;if(!qb||!Qc)return 16;if(2===wb){wb=!1;jc=qb.WXd().copy();Qc=Yf.a.DV(Qc.Number);const Cd=Jd.a.Rl(jc.ga(0),jc.ga(1)),Ld=Jd.a.Rl(jc.ga(0),jc.ga(3)),ie=this.Qb.Cd;Na===Qd.a.WSe?(Qc=this.Rj.ML(ie.Ge(Qc,1),qb.zoom),
Na=Qc-Ld,jc.ga(2).qL(0,Na),jc.ga(3).qL(0,Na)):Na===Qd.a.ZSe?(Qc=this.Rj.ML(ie.Ge(Qc,0),qb.zoom),Na=Qc-Cd,jc.ga(1).qL(Na,0),jc.ga(2).qL(Na,0)):Na===Qd.a.XSe?(wb=!0,Qc=this.Rj.ML(ie.Ge(Qc,0),qb.zoom),Na=Qc-jc.ga(0).x,jc.move(Na,0)):Na===Qd.a.YSe&&(wb=!0,Qc=this.Rj.ML(ie.Ge(Qc,1),qb.zoom),Na=Qc-jc.ga(0).y,jc.move(0,Na));qb.Gtl(jc,wb)}return 32}wKj(Na){let qb=[];Na.Mf?qb=this.Ea.py(Na):Na.mh&&(qb=this.Ea.py(Na.Pr()));if(qb.length){for(const wb of qb)if(!this.X9d(wb))return!1;return!0}return this.X9d(Na)}X9d(Na){const qb=
this.vo.$Ne&&!Na.isGif&&(Na.qk||1===Na.mediaType)&&!Na.get_isSVGBlipFilled();return this.e_?qb&&!Na.GBb:qb}jkk(Na,qb){this.Xb.vO(qb);if(!this.isActive||!Na.isConnected)return!0;this.isActive=!1;Na.pictureCropInfo=null;fd.a.J(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");return!1}kkk(Na,qb,wb){this.Xb.vO(qb);if(Na.isConnected)if(qb=kb.a.Cb,kb.a.LE(qb,()=>{this.ia.processAction(Qd.a.T3a,2)}),this.VK.KV(Na))fd.a.J(512500445,822,50,"Crop is cancelled due to shape manipulation");
else{var jc=Na.Ag(this.Qb.Ma);if(jc){var Qc=new Date;Na.pictureCropInfo=JSON.parse(wb.PictureCropInfoStr);this.g8.xP(Na).tgl();Na=new Date;qb&&(qb.Km("ParseCropInfoStart",Qc),qb.Km("ParseCropInfoEnd",Na),kb.a.dea(qb));jc.eE();this.ia.processAction(Qd.a.sJb,2)}}}get isActive(){return this.Yxb}set isActive(Na){this.Yxb=Na}}Object(h.a)(se,"PictureCropActor",null,[]);var Pf=d(1166),yg=d(189),qe=d(183),yd=d(211),zf=d(130),xd=d(164),fg=d(321),Ki=d(836),jg=d(612),Ch=d(47),ih=d(67),qh=d(707),Md=d(111),Ed=
d(204),Bd=d(173),Xh=d(868),$f=d(319),Vi=d(203),ci=d(190),Bi=d(205),bh=d(303);class Wg{constructor(Na,qb,wb,jc,Qc,Cd,Ld,ie,Qe,df,tf,jh,Dh,ch){this.Ib=!0;this.Fl=!1;this.nn=[];this.m3=this.DA=this.lW=this.UG=this.BI=this.Ab=null;this.aC=Array(8);this.jta=this.Sm=this.av=null;this.oT=this.yd=1;this.tpe=new Jd.a(0,0);this.pn=new yg.a;this.t_=new qe.a;this.Jac=new Jd.a(0,0);this.Bbb=0;this.Mt=new qe.a;this.xta=new Jd.a(0,0);this.lka=new Jd.a(0,0);this.cbc=this.XTa=!1;this.p9b=new Jd.a(0,0);this.j9=this.H8=
null;this.PEg=new Rb.a;this.ev=null;if(!jc)throw Error.argumentNull("clickInputManager");if(!Na)throw Error.argumentNull("shapeNode");if(tf&&!jh)throw Error.argumentNull("transformFactory");if(tf&&!Dh)throw Error.argumentNull("presReader");this.ua=Na;this.Ea=qb;this.rc=wb;this.gd=jc;this.ia=Qc;this.dC=Cd;this.gf=Ld;this.Nja=ie;this.L7j=Qe;this.Mab=df;this.ska=tf;this.gk=jh;this.L0j=ch}$m(Na){this.Ab=new ci.a;this.Ab.Qk(1);this.Ab.Qd(!1);this.Ab.Cma(ih.a.Nhl);Na.appendChild(this.Ab.viewport);this.BI=
new qh.a(!1,this.ska);this.Ab.appendChild(this.BI);this.UG=new qh.a(!1,this.ska);this.Ab.appendChild(this.UG);this.UG.Qk(1);this.lW=new Bd.a;this.lW.qv(id.a.f0);this.lW.zr(id.a.$D);this.lW.BF(Md.a.none);this.lW.Qk(1);this.Ab.appendChild(this.lW);this.m3=new Bd.a;this.m3.Qk(1);this.m3.Pk(ih.a.Hwa);this.m3.Cma("ShapeMoveHandle");this.m3.BF(Md.a.none);this.Ab.appendChild(this.m3);this.DA=new Ed.a;this.zWb(this.DA);this.Ab.appendChild(this.DA);this.Ab.viewport.ya.setAttribute("class",ih.a.Hec);this.Ab.Qd(!1);
this.gd.ob(I.a.click,this.m3.ya,Object(u.a)(this,this.S5c,"noOpHandler"));this.gd.ob(I.a.click,this.lW.ya,Object(u.a)(this,this.S5c,"noOpHandler"))}zWb(Na){for(let jc=0;8>jc;++jc){var qb="cropHandle"+jc;const Qc=new Ed.a;Qc.ya.id=qb;if(hb.a.LIa){var wb=new $f.a;wb.ya.id=qb;wb.setVisibility(!1);wb.setPosition(-10,-10);wb.yh(20,20);Qc.appendChild(wb)}wb=new xd.a(jc);qb=wb.n3b()?this.kwi(wb,qb):this.oAi(wb,qb);Qc.appendChild(qb);Qc.Qk(1);this.aC[jc]=Qc;Na.appendChild(Qc)}}E4d(Na){for(let qb=0;8>qb;++qb)if(this.aC[qb].ya.id===
Na.id)return new xd.a(qb);return null}TLj(Na){return Na.id.startsWith("cropHandle")}dispose(){this.Nja();this.Fl=!0;this.Ib=!1;this.Ab&&this.Ab.iq();this.Ab=null;this.m3&&this.gd.xb(I.a.click,this.m3.ya,Object(u.a)(this,this.S5c,"noOpHandler"));this.m3=null;this.lW&&this.gd.xb(I.a.click,this.lW.ya,Object(u.a)(this,this.S5c,"noOpHandler"));this.DA=this.lW=null;this.aC&&Array.clear(this.aC);this.H8=this.j9=this.aC=null;this.p9b=new Jd.a(0,0)}Bgd(Na,qb,wb,jc){const Qc=this.H0d(),Cd=Na-Qc.x+this.lka.x+
wb,Ld=qb-Qc.y+this.lka.y+jc;return isNaN(Cd)||isNaN(Ld)?(fd.a.J(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",Na,Qc.x,this.lka.x,wb,qb,Qc.y,this.lka.y,jc,this.yd),new Jd.a(0,0)):new Jd.a(Cd,Ld)}setPosition(Na,qb){this.XTa&&this.ua.pictureCropInfo&&(this.xta=Na=new Jd.a(Na/this.yd,qb/this.yd),this.Mab?(this.H8&&this.BI&&(qb=this.Bgd(this.H8.Position.X,
this.H8.Position.Y,Na.x,Na.y),this.BI.setPosition(qb.x,qb.y)),this.j9&&this.UG&&this.UG.image&&(Na=this.Bgd(this.j9.Position.X,this.j9.Position.Y,Na.x,Na.y),this.UG.image.setPosition(Na.x,Na.y))):((qb=this.ua.pictureCropInfo.MaskViewElem)&&this.BI&&(qb=this.Bgd(qb.Position.X,qb.Position.Y,Na.x,Na.y),this.BI.setPosition(qb.x,qb.y)),(qb=this.ua.pictureCropInfo.TextureViewElem)&&this.UG&&this.UG.image&&(Na=this.Bgd(qb.Position.X,qb.Position.Y,Na.x,Na.y),this.UG.image.setPosition(Na.x,Na.y))),this.Ab.jm())}cfl(Na,
qb){const wb=new Jd.a(this.Ea.tA(this.ua,this.dC).x/this.yd,this.Ea.tA(this.ua,this.dC).y/this.yd),jc=new Jd.a(this.lka.x+this.xta.x,this.lka.y+this.xta.y);if(this.Mab)this.H8&&this.BI&&this.BI.setPosition(this.H8.Position.X-wb.x+jc.x+Na/this.yd,this.H8.Position.Y-wb.y+jc.y+qb/this.yd),this.j9&&this.UG&&this.UG.image.setPosition(this.j9.Position.X-wb.x+jc.x+Na/this.yd,this.j9.Position.Y-wb.y+jc.y+qb/this.yd);else{var Qc=this.ua.pictureCropInfo.MaskViewElem;Qc&&this.BI.setPosition(Qc.Position.X-wb.x+
jc.x+Na/this.yd,Qc.Position.Y-wb.y+jc.y+qb/this.yd);(Qc=this.ua.pictureCropInfo.TextureViewElem)&&this.UG.image.setPosition(Qc.Position.X-wb.x+jc.x+Na/this.yd,Qc.Position.Y-wb.y+jc.y+qb/this.yd)}this.Ab.jm()}dfl(Na,qb){qb.Ej(1/this.oT);this.Omh(Na,yg.a.add(this.UVa,qb))}resize(Na,qb){qb.Ej(1/this.oT);this.Omh(Na,qb)}Omh(Na,qb){Na=this.WJd(Na,qb);this.Uq(Na);this.setOffsets(qb)}H0d(){const Na=this.Ea.tA(this.ua,this.dC);return new Jd.a(Na.x/this.yd,Na.y/this.yd)}kCh(){this.ua.yx&&(this.oT=this.rc.Sg(this.ua).Yp/
this.tpe.x)}tgl(){const Na=this.rc.Sg(this.ua);this.tpe.update(Na.Yp,Na.Ek)}Ej(Na){this.yd=Na;this.Ab.Ej(this.yd);Na=new qe.a;Na.yaa(1/this.yd,1/this.yd);this.DA.YD(Na,Vi.a.Gaa);this.L0j?this.mX(!1):this.mX(!0)}get zoom(){return this.yd/this.oT}WXd(){this.kCh();this.av||(this.av=this.ua.Fq);var Na=Jd.a.Rl(this.av.ga(0),this.av.ga(1));const qb=Jd.a.Rl(this.av.ga(0),this.av.ga(3)),wb=this.av.Uf(),jc=new zf.a(new Jd.a(0,0),new Jd.a(Na,0),new Jd.a(Na,qb),new Jd.a(0,qb));jc.move(wb.x-Na/2,wb.y-qb/2);Na=
this.H0d();jc.move(Na.x,Na.y);jc.scale(this.oT,this.oT);return jc}Gtl(Na,qb){Na=Na.copy();Na.scale(1/this.oT,1/this.oT);var wb=this.H0d();Na.move(-1*wb.x,-1*wb.y);wb=Na.Uf();const jc=new qe.a;qb?jc.s6(this.ua.get_shapeRotation(),wb):jc.s6(this.ua.get_shapeRotation(),this.av.ga(0));jc.il(Na);qb||Na.move(this.av.ga(0).x-Na.ga(0).x,this.av.ga(0).y-Na.ga(0).y);this.av=Na;this.lW.Qt(this.av.points);qb=this.UG.clipPath;Vf.a("SVGCreationOnChangesFromFormatPane")&&this.ska&&qb?(qb.iVb=this.eFc(Na),this.xzc(Na.ga(0))):
qb&&qb.J3a&&qb.J3a.$Se(this.av.points);this.cbc=!0;this.mX(!0);this.Ab.jm()}setZIndex(Na){this.Ab.uC(Na+2*fg.a.z$)}setOffsets(Na){this.av||(this.av=this.ua.Fq);this.R6h(Na);this.pn=Na;var qb=this.DA.Nwb;Na=new Jd.a(qb[0].x/this.yd,qb[0].y/this.yd);var wb=new Jd.a(qb[2].x/this.yd,qb[2].y/this.yd);const jc=new Jd.a(qb[4].x/this.yd,qb[4].y/this.yd);qb=new Jd.a(qb[6].x/this.yd,qb[6].y/this.yd);Na=new zf.a(Na,wb,jc,qb);this.lW.Qt(this.av.points);wb=this.UG.clipPath;this.ska&&wb?(this.xzc(Jd.a.bU(Na.points[this.Bbb],
this.Jac)),wb.iVb=this.eFc(Na)):wb&&wb.J3a&&wb.J3a.$Se(Na.points);this.Ab.jm()}R6h(Na){var qb=this.av,wb=Jd.a.Rl(qb.ga(0),qb.ga(1));qb=Jd.a.Rl(qb.ga(0),qb.ga(3));Na.bottom-Na.top<-1*qb&&(qb+=Na.bottom-Na.top,Na.top+=qb,Na.bottom-=qb);Na.right-Na.left<-1*wb&&(wb+=Na.right-Na.left,Na.left+=wb,Na.right-=wb)}Uq(Na){this.t_=Na;this.lW.YD(Na,Vi.a.Gaa);this.mX(!0)}pv(Na){this.Mt=Na;this.Ab.YD(Na,Vi.a.hob);this.Ab.jm()}nz(){Array.clear(this.nn)}XE(Na){return this.TLj(Na)?this.E4d(Na):null}QD(Na){const qb=
[];var wb=this.ua.pictureCropInfo;if(this.ua.yx){const jc=this.rc.Sg(this.ua);if(wb.MaskViewElem){let Qc=bh.a.cFc(6,jc.Yp,jc.Ek);Array.add(qb,Qc)}wb.TextureViewElem&&(wb=bh.a.cFc(7,jc.Yp,jc.Ek),Array.add(qb,wb));Array.add(this.nn,Na)}else this.Ib=!1,this.Ab.Qd(!1);return qb}XD(){}bxl(){this.p9b.x!==this.BI.x&&this.p9b.y!==this.BI.y&&(fd.a.J(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),this.H8.Position.X=this.BI.x+
this.Ea.tA(this.ua,this.dC).x/this.yd,this.H8.Position.Y=this.BI.y+this.Ea.tA(this.ua,this.dC).y/this.yd,this.j9.Position.X=this.UG.image.x+this.Ea.tA(this.ua,this.dC).x/this.yd,this.j9.Position.Y=this.UG.image.y+this.Ea.tA(this.ua,this.dC).y/this.yd,this.lka.update(0,0))}dUb(Na,qb){const wb=this.gk.jFc();this.ua.get_isVerticallyFlipped()&&(wb.yaa(1,-1),wb.sB(0,2*qb._y));this.ua.get_isHorizontallyFlipped()&&(wb.yaa(-1,1),wb.sB(2*qb._x,0));wb.s6(Na,qb);return wb}Qdg(){return this.ua.get_isVerticallyFlipped()&&
this.ua.get_isHorizontallyFlipped()?2:this.ua.get_isVerticallyFlipped()?3:this.ua.get_isHorizontallyFlipped()?1:0}xzc(Na){const qb=new qe.a;qb.sB(Na._x,Na._y);this.UG.clipPath.YD(qb,Vi.a.Gaa)}eFc(Na){fd.a.J(512497025,809,15,"PictureCropShapeView:: createSVG operation started");var qb=this.ua.get_shapeRotation();this.gk.Waa(-qb,Na.Uf()).il(Na);this.ev||(this.ev=svgShape.FactoryGlobal.createShape());this.ev.setSVGRoot(this.Ab.ya,!1);this.ua.LR?this.ev.setShapeType(this.ua.LR):(this.ev.setShapeType(4),
fd.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.ev.setOffsets(this.ua.get_xPersisted()+Pf.a.lX(Na.ga(0).x/this.oT,0),this.ua.get_yPersisted()+Pf.a.lX(Na.ga(0).y/this.oT,1));this.ev.setExtents(Pf.a.lX(Na.ga(1).x-Na.ga(0).x,0),Pf.a.lX(Na.ga(2).y-Na.ga(1).y,1));var wb=svgShape.FactoryGlobal.getConvertor().getPath(this.ev,!1,this.oT,this.oT);if(!wb||!wb.length)throw fd.a.J(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");
Na=Array(wb.length);qb=0;for(const jc of wb)wb=new Bd.a,wb.a0(jc),wb.ya.setAttribute(Md.a.HIb,this.Mt.ihb()),Na[qb++]=wb;fd.a.J(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");return Na}draw(Na,qb){if(Array.contains(this.nn,Na)){Array.remove(this.nn,Na);if(this.ua.pictureCropInfo&&!this.XTa){if(this.ua.pictureCropInfo.MaskViewElem){Na=this.ua.pictureCropInfo.MaskViewElem;var wb=Na.Clip,jc=this.rc.Sg(this.ua);jc=bh.a.cFc(6,jc.Yp,jc.Ek);if(jc=qb[jc.toString()])this.BI.w2k(jc.Base64Data,
Na.Id.toString(),wb.Bounds.Left,wb.Bounds.Top,wb.TotalWidth,wb.TotalHeight,wb.Bounds.Right-wb.Bounds.Left,wb.Bounds.Bottom-wb.Bounds.Top),this.BI.Qd(!0),this.BI.setPosition(Na.Position.X-this.Ea.tA(this.ua,this.dC).x/this.yd,Na.Position.Y-this.Ea.tA(this.ua,this.dC).y/this.yd);this.H8=Na;this.p9b=new Jd.a(this.BI.x,this.BI.y)}this.ua.pictureCropInfo.TextureViewElem?(Na=this.rc.Sg(this.ua),jc=bh.a.cFc(7,Na.Yp,Na.Ek),Na=this.ua.pictureCropInfo.TextureViewElem,wb=Na.Clip,(qb=qb[jc.toString()])?this.ska?
(this.Bbb=this.Qdg(),this.Jac=this.Sm.points[this.Bbb].copy(),this.xzc(Jd.a.bU(this.ua.Fq.points[this.Bbb],this.Jac)),this.Mt=this.dUb(this.ua.get_shapeRotation(),this.ua.Fq.Uf()),this.UG.x2k(qb.Base64Data,Na.Id.toString(),Na.Position.X-this.Ea.tA(this.ua,this.dC).x/this.yd,Na.Position.Y-this.Ea.tA(this.ua,this.dC).y/this.yd,wb.TotalWidth,wb.TotalHeight,this.Sm.copy().points,this.eFc(this.Sm.copy()))):this.UG.v2k(qb.Base64Data,Na.Id.toString(),Na.Position.X-this.Ea.tA(this.ua,this.dC).x/this.yd,Na.Position.Y-
this.Ea.tA(this.ua,this.dC).y/this.yd,wb.TotalWidth,wb.TotalHeight,this.ua.Fq.points):fd.a.J(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.j9=Na):fd.a.J(512496992,822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");this.av&&Jd.a.Rl(this.av.ga(0),this.av.ga(2))||(this.av=this.ua.Fq);this.jta=this.ua.oWa;this.m3.Qt(this.jta.points);this.lW.Qt(this.av.points);this.XTa=!0;this.mX(!0);this.visible=this.Ib}else this.Mab&&
this.H8&&this.j9&&(this.bxl(),this.BI.setPosition(this.H8.Position.X-this.Ea.tA(this.ua,this.dC).x/this.yd,this.H8.Position.Y-this.Ea.tA(this.ua,this.dC).y/this.yd),this.UG.image.setPosition(this.j9.Position.X-this.Ea.tA(this.ua,this.dC).x/this.yd,this.j9.Position.Y-this.Ea.tA(this.ua,this.dC).y/this.yd),this.ska?(this.Bbb=this.Qdg(),this.Jac=this.Sm.points[this.Bbb].copy(),this.xzc(Jd.a.bU(this.ua.Fq.points[this.Bbb],this.Jac)),this.Mt=this.dUb(this.ua.get_shapeRotation(),this.ua.Fq.Uf()),this.UG.clipPath.iVb=
this.eFc(this.ua.Fq)):this.UG.clipPath.J3a=new Xh.a(this.ua.Fq.points,0),this.p9b=new Jd.a(this.BI.x,this.BI.y),this.av=this.ua.Fq,this.jta=this.ua.oWa,this.m3.Qt(this.jta.points),this.lW.Qt(this.av.points),this.mX(!0),fd.a.J(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));this.Ab.jm();this.Ab.Qd(this.Ib)}}ntl(){if(this.av){var Na=this.DA.Nwb;const qb=new Jd.a(Na[0].x/this.yd,Na[0].y/this.yd),wb=new Jd.a(Na[2].x/this.yd,Na[2].y/this.yd),jc=new Jd.a(Na[4].x/this.yd,Na[4].y/this.yd);
Na=new Jd.a(Na[6].x/this.yd,Na[6].y/this.yd);this.av=new zf.a(qb,wb,jc,Na)}else this.av=this.ua.Fq;this.Sm=this.av.copy();this.jta||(this.jta=this.ua.oWa);this.jta.move(this.xta.x,this.xta.y);this.m3.Qt(this.jta.points);this.lka.qL(this.xta.x,this.xta.y);this.xta.update(0,0);this.gf.RD(new Bi.a(1))}FZi(){var Na=this.DA.Nwb;const qb=new Jd.a(Na[0].x,Na[0].y),wb=new Jd.a(Na[2].x,Na[2].y),jc=new Jd.a(Na[4].x,Na[4].y);Na=new Jd.a(Na[6].x,Na[6].y);return new zf.a(qb,wb,jc,Na)}y0i(){var Na=this.ua.oWa.copy().points,
qb=new Jd.a(Na[0].x*this.yd,Na[0].y*this.yd);const wb=new Jd.a(Na[1].x*this.yd,Na[1].y*this.yd),jc=new Jd.a(Na[2].x*this.yd,Na[2].y*this.yd);Na=new Jd.a(Na[3].x*this.yd,Na[3].y*this.yd);qb=new zf.a(qb,wb,jc,Na);qb.scale(1/this.oT,1/this.oT);qb.move((this.lka.x+this.xta.x)*this.yd,(this.lka.y+this.xta.y)*this.yd);return qb}AF(Na){this.XTa&&(this.DA.Qd(!Na),Na?(this.kCh(),this.cbc=!0):(this.ntl(),this.ia.processAction(Qd.a.sJb,2),this.Mab&&(Na={["pictCropperInfo"]:this.uIf(),["shapeNode"]:this.ua},
this.ia.Ka(Qd.a.hjc,2,Na))))}kq(){return this.Ab.kq()}mX(Na){if(this.XTa){var qb=this.av.copy();Na&&this.t_.il(qb);Na=new qe.a;Na.Imb(this.ua.get_shapeRotation());var wb=2*Math.ceil((this.ua.get_shapeRotation()-45)/90)%8;for(let jc=0;8>jc;++jc){const Qc=this.aC[jc];Qc.Pk(Ch.a.nP(yd.a.box4Image(Wg.Mic[wb]),ih.a.aA));this.bIa(Qc,qb.Zj(new xd.a(jc)));Qc.YD(Na,Vi.a.hob);wb=(wb+1)%8}}}bIa(Na,qb){Na.x===qb.x*this.yd&&Na.y===qb.y*this.yd||Na.setPosition(qb.x*this.yd,qb.y*this.yd)}get visible(){return this.Ib}set visible(Na){this.Ib=
Na;!Na&&this.XTa&&(this.uNi(),this.XTa=!1);this.Ab.Qd(this.Ib)}uNi(){if(this.XTa){if(this.cbc){const Na={["pictCropperInfo"]:this.uIf(),["shapeNode"]:this.ua};this.ia.Ka(Qd.a.hjc,2,Na)}this.E1()}}uIf(){let Na,qb,wb,jc;const Qc=this.rhi();({left:Na,top:qb,right:wb,bottom:jc}=this.gqi());return Object.assign(new Ki.a,{Left:Na,Top:qb,Right:wb,Bottom:jc,X:Qc.x,Y:Qc.y})}gqi(){let Na,qb,wb,jc;({left:Na,top:qb,right:wb,bottom:jc}=this.jFi());({left:Na,top:qb,right:wb,bottom:jc}=this.Uti(Na,qb,wb,jc));({left:Na,
top:qb,right:wb,bottom:jc}=Wg.Jyl(Na,qb,wb,jc));return{left:Na,top:qb,right:wb,bottom:jc}}jFi(){let Na,qb,wb;var jc=this.jta.points;const Qc=this.av.points;Na=jg.a(jc[3],jc[0],Qc[3],Qc[0]);qb=jg.a(jc[0],jc[1],Qc[0],Qc[1]);wb=jg.a(jc[1],jc[2],Qc[1],Qc[2]);jc=jg.a(jc[2],jc[3],Qc[2],Qc[3]);return{left:Na,top:qb,right:wb,bottom:jc}}Uti(Na,qb,wb,jc){var Qc=this.jta.points;const Cd=Jd.a.Rl(Qc[0],Qc[1]);Qc=Jd.a.Rl(Qc[1],Qc[2]);Na=Math.floor(Na/Cd*1E6)/1E6;qb=Math.floor(qb/Qc*1E6)/1E6;wb=Math.floor(wb/Cd*
1E6)/1E6;jc=Math.floor(jc/Qc*1E6)/1E6;return{left:Na,top:qb,right:wb,bottom:jc}}rhi(){var Na=this.av.copy(),qb=new qe.a,wb=Na.Uf();qb.s6(-1*this.ua.get_shapeRotation(),wb);qb.il(Na);wb=this.Ea.tA(this.ua,this.dC);this.L7j?(qb=this.dC.Ef(Na.Zb*this.yd+wb.x,0),Na=this.dC.Ef(Na.fc*this.yd+wb.y,1),Na=new Jd.a(qb,Na)):Na=new Jd.a(Na.Zb+wb.x/this.yd,Na.fc+wb.y/this.yd);return Jd.a.scale(Na,this.oT,this.oT)}S5c(){return!0}E1(){this.lW.YD(new qe.a,Vi.a.Gaa);this.m3.setPosition(0,0);this.pn=new yg.a;this.Sm=
this.av=this.t_=this.ua.pictureCropInfo=null;this.lka.update(0,0);this.cbc=!1;this.tpe.update(0,0);this.oT=1}WJd(Na,qb){const wb=new qe.a;this.Sm||(this.Sm=Na);Na=this.Sm.Uf();const jc=Jd.a.Rl(this.Sm.ga(0),this.Sm.ga(1)),Qc=Jd.a.Rl(this.Sm.ga(0),this.Sm.ga(3)),Cd=jc?1+(qb.right-qb.left)/jc:1,Ld=Qc?1+(qb.bottom-qb.top)/Qc:1,ie=Na.copy();ie.qL(-1*jc/2,-1*Qc/2);wb.s6(-1*this.ua.get_shapeRotation(),Na);wb.sB(-1*ie.x,-1*ie.y);wb.yaa(Cd,Ld);wb.sB(qb.left+ie.x,qb.top+ie.y);wb.s6(this.ua.get_shapeRotation(),
Na);return wb}kwi(Na,qb){var wb=[new Jd.a(0,0),new Jd.a(20,0),new Jd.a(20,5),new Jd.a(5,5),new Jd.a(5,20),new Jd.a(0,20)];wb=new Xh.a(wb,0);wb.ya.id=qb;wb.BF("black");wb.qv("white");wb.zr(1);Na.equals(xd.a.ND)?wb.iIa(90):Na.equals(xd.a.qu)?wb.iIa(0):Na.equals(xd.a.cE)?wb.iIa(180):Na.equals(xd.a.fH)&&wb.iIa(-90);return wb}oAi(Na,qb){const wb=new $f.a;wb.ya.id=qb;wb.BF("black");wb.qv("white");wb.zr(1);wb.yh(20,5);Na.equals(xd.a.north)?wb.setPosition(-10,0):Na.equals(xd.a.south)?wb.setPosition(-10,-5):
Na.equals(xd.a.east)?(wb.setPosition(-5,-10),wb.yh(5,20)):Na.equals(xd.a.west)&&(wb.setPosition(0,-10),wb.yh(5,20));return wb}get UVa(){return this.pn}get oe(){return this.Ab.viewport}c0d(Na){return!this.ua.yx&&8>Na.index?this.aC[Na.index].ya:null}IP(){return!1}Ux(Na){Na&&(this.cbc=!1)}setSelection(){}static Jyl(Na,qb,wb,jc){.999999<Na+wb&&(fd.a.J(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",Na,wb),wb=(999999-1E6*Na)/1E6);.999999<qb+jc&&(fd.a.J(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",
qb,jc),jc=(999999-1E6*qb)/1E6);return{left:Na,top:qb,right:wb,bottom:jc}}}Wg.Mic=[ih.a.uth,ih.a.sth,ih.a.tth,ih.a.rth,ih.a.wth,ih.a.vth,ih.a.xth,ih.a.yth];Object(h.a)(Wg,"PictureCropShapeView",null,[764,387,388,106]);var jf=d(646);class kg{constructor(Na,qb,wb){this.Ea=Na;this.dC=qb;this.g8=wb}setPosition(Na,qb,wb){this.g8.VE(Na.shapeNode).cfl(qb,wb)}setOffsets(Na,qb){this.g8.VE(Na.shapeNode).dfl(Na.hSe.copy(),qb)}UH(Na,qb){const wb=new qe.a,jc=this.g8.VE(Na.shapeNode);qb=qb?jc.FZi().copy():jc.y0i().copy();
Na=this.Ea.tA(Na.shapeNode,this.dC);wb.sB(Na.x,Na.y);wb.il(qb);return new jf.a(qb)}CF(Na){return Na.shapeNode.yx}}Object(h.a)(kg,"ShapeCropMoveResizeHandler",null,[763]);class vh{constructor(Na,qb,wb){this.g8=Na;this.Mab=qb;this.U5j=wb}$_(Na,qb,wb){if((Na=this.g8.VE(Na))&&Na.visible!==wb){for(const jc of qb)this.U5j&&(qb=Object(qd.a)(748,jc))&&qb.setSelected(!wb),jc!==Na&&(jc.visible=!wb);Na.visible=wb}}Ugd(){return!1}lld(Na,qb,wb){this.g8.VE(Na).resize(wb,qb)}Vgd(){return!1}mld(Na,qb,wb,jc){jc&&
this.g8.VE(Na).setPosition(qb,wb)}lUc(){return!this.Mab}Z5a(Na,qb){return this.Mab?qb:[this.g8.VE(Na)]}CF(Na){return Na.yx}}Object(h.a)(vh,"ShapeViewCropUpdateStrategyHandler",null,[749,750]);var nd=d(276);class Oe{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PictureCrop"}Wb(Na){this.K=Na;this.K.register(336,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").ma().na(()=>new nd.a((qb,wb)=>{let jc=null;const Qc=Object(qd.a)(124,
qb.oc(this.K.resolve("Box4.IPageView").Ma));Qc&&!Qc.ll&&(jc=new Wg(qb,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IPageView").Cd,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),wb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingSetPictureCropInfoCommandUsingMU,this.K.resolve("PowerPointWebEditor.IApplicationSettings").iye,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").J9c,this.K.resolve("PowerPointWebEditor.ITransformFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").EVd),jc.$m(Qc.ya),jc.setZIndex(3),jc.visible=!1,Qc.QX(jc.oe.ya,!0),Qc.zza(jc,3));return jc}));this.K.register(se,"PowerPointWebEditor.PictureCropActor").ma().na(()=>new se(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").xKj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").hye,this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").qia,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").J9c,this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.K.resolve("PowerPointWebEditor.IBusinessBarController")));this.K.register(Gg,
"PowerPointWebEditor.FormatPicturePaneActor").ma().na(()=>new Gg(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IDynamicScriptLoaderProvider").yv))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new vh(this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").iye,this.K.resolve("PowerPointWebEditor.IApplicationSettings").K9c));this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new kg(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView").Cd,this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.K.resolve("PowerPointWebEditor.PictureCropActor").ub();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").ub();
this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").we()}dispose(){}static main(){m.a.instance.Ac(Od.a(new Oe,0))}}Object(h.a)(Oe,"PPTWebEditorPictureCropPackage",null,[2,3]);var ti=d(36),Kh=d(239);class Rd{constructor(Na,qb,wb,jc,Qc){this.Bz=[ti.a.Ni,ti.a.font,gd.a.autonumberBulletType];this.Mb=Na;this.zm=qb;this.Vh=wb;this.A$b=jc;this.DN=Qc}format(Na){if(Na&&Na.Fvb){Na=this.Mb.Kc(Na);for(var qb=this.zm.J6(Na,Na.currentNode);qb.moveNext();){var wb=qb.currentNode;if(wb&&this.Vh.Wd(wb)){const jc=
this.DN.vP(Na,this.Vh.fdb(wb));(wb=this.A$b.gMc(wb))&&Kh.d(jc,wb,this.Bz)}}}}}Object(h.a)(Rd,"BeautifyListFormatter",null,[729]);class Bj{constructor(Na,qb,wb,jc,Qc){this.ia=Na;this.ta=wb;this.Db=qb;this.Ea=jc;this.zZj=Qc}initialize(){this.ub()}ub(){this.ia.pa(Qd.a.hId,Q.a.application,Object(u.a)(this,this.hId,"applyTextFormatterSuggestion"),4)}hId(Na,qb,wb){if(1===wb)return 32;Na=this.ta.Ba;if(!Na)return 16;qb=Na.om();if(!qb||!qb.length)return 16;qb=this.Ea.mZ(qb);if(!qb.length)return 16;wb=this.Db.rd(15);
wb.jc(Na);for(const jc of qb)this.zZj.format(jc);wb.dispose();return 32}}Object(h.a)(Bj,"TextFormatterActor",null,[]);class ui{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatter"}Wb(Na){this.K=Na;Na.register(729,"PowerPointWebEditor.IBeautifyListFormatter").ma().na(()=>new Rd(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
this.K.resolve("PowerPointWebEditor.IPptListEditor")));Na.register(Bj,"PowerPointWebEditor.TextFormatter.TextFormatterActor").ma().na(()=>new Bj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const Na=this.K.resolve("Common.IAppSettingsManager");Na.ff(()=>
{Na.ka("818")&&this.K.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){m.a.instance.Ac(Od.a(new ui,0))}}Object(h.a)(ui,"PPTWebEditorTextFormatterPackage",null,[2,3]);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Za.main();Type.registerNamespace("Common.App.O365Shell");
Nb.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Jb.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");ug.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",
attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",
attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",ElementDimensions:"Size64by48",Width:"5"},
children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},
{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"GrowAndTurn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},
{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",
attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",
Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},
{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},
{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",
ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",
QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",attrs:{Id:"TransitionPush",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",
Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",Command:"0x148D0534",Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",
Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",
Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",
Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",
DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",
DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};Oe.main();ui.main();Type.registerNamespace("NLRT")},135:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(215);class e{constructor(m,n){this.aLa=!1;const {Annotations:v}=d(76);if(!m)throw Error.argumentNull("annotations");
if(!m.yae(n))throw Error.argument("memberTypeID","Invalid type ID");if(v.eB(n))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.lr=m;this.iQh=n;this.kB=[]}get hnb(){return this.lr}get isReadOnly(){return this.aLa}get vT(){return this.iQh}get items(){return this.kB}D0(){const {Annotations:m}=d(76);let n="[";for(let v=0,A=this.items.length;v<A;++v){0<v&&(n+=", ");const w=this.lr.D0(this.vT,this.items[v]);this.vT===m.WX?(n+='"',n+=h.a.DTd(w),n+='"'):n+=w}return n+"]"}isEqual(m){const {Annotations:n}=
d(76);if(this===m)return!0;if(!m||m.hnb!==this.lr||m.vT!==this.vT||m.items.length!==this.items.length)return!1;for(let v=0;v<this.items.length;++v)if(!n.DZa(this.vT,this.items[v],m.items[v]))return!1;return!0}clone(){const m=new e(this.lr,this.vT);Array.addRange(m.items,this.items);return m}aK(){return this.isReadOnly?this.clone():this}Xbe(){const {Annotations:m}=d(76);if(!this.isReadOnly){this.aLa=!0;for(const n of this.items)m.l9a(n)}}toString(){return this.D0()}}Object(J.a)(e,"ListValue",null,
[1103,1102])},146:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.tellMe="TellMe";h.contextMenu="ContextMenu";h.unknown="Unknown";Object(J.a)(h,"TellMeScenario",null,[])},158:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,n=null,v=null,A=4,w=-99999,y=0){this.TGd="";this.cAc=-1;this.value=e;this.type=m;this.subType=A;this.label=this.TI=n;this.groupType=27;this.description=v;this.score=w;this.count=y}}Object(J.a)(h,"ResultBinding",null,[])},174:function(J,
V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.attributes=null;this.query=e;this.uk=[]}us(e){this.uk.push(e)}nch(e){const m=[];for(const n of this.uk)n.groupType!==e&&m.push(n);this.uk.length!==m.length&&(this.uk=m)}get avb(){return!1}}Object(J.a)(h,"SimpleResultsUpdatedEventArgs",null,[944])},175:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e=27,m=""){this.GTh=[];this.groupType=e;this.displayName=m}get results(){return this.GTh}Fv(e){e.groupType=
this.groupType;Array.add(this.results,e)}xDe(e=1){if(this.results.length>=e)for(let m=0;m<e;m++)Array.removeAt(this.results,this.results.length-1)}}Object(J.a)(h,"SimpleResultGroup",null,[945])},215:function(J,V,d){J=d(0);class h{constructor(m,n){this.dNa=m;this.value=n}}Object(J.a)(h,"AttrValuePair",null,[]);d.d(V,"a",function(){return e});class e{constructor(m){this.aLa=!1;if(!m)throw Error.argumentNull("annotations");this.lr=m;this.qN=[]}get hnb(){return this.lr}get isReadOnly(){return this.aLa}get l3d(){return 0<
this.qN.length}Dm(m){if(!this.lr.Jvb(m))throw Error.argument("attributeID","Invalid attribute ID");for(const n of this.qN)if(m===n.dNa)return m=n.value,{returnValue:!0,value:m};return{returnValue:!1,value:null}}Pt(m,n){var {Annotations:v}=d(76);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.lr.Jvb(m))throw Error.argument("attributeID","Invalid attribute ID");if(!this.lr.Hub(this.lr.getAttributeType(m),n))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");v.l9a(n);for(v=0;v<this.qN.length;++v){const A=this.qN[v];if(m===A.dNa){A.value=n;return}}Array.add(this.qN,new h(m,n))}mcd(m){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.lr.Jvb(m))throw Error.argument("attributeID","Invalid attribute ID");for(let n=0;n<this.qN.length;++n)if(m===this.qN[n].dNa){Array.removeAt(this.qN,n);break}}EJc(m){if(!m)throw Error.argumentNull("action");
for(const n of this.qN)m(n.dNa,n.value)}clone(){const m=new e(this.lr);m.lAa(this);return m}lAa(m){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!m)throw Error.argumentNull("other");if(m.hnb!==this.lr)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.qN);m.EJc((n,v)=>{this.Pt(n,v)})}D0(){const {Annotations:m}=d(76);let n="[",v=!0;for(const A of this.qN){v?v=!1:n+=", ";n+=this.lr.v6f(A.dNa);n+="=";const w=this.lr.getAttributeType(A.dNa),
y=this.lr.D0(w,A.value);w===m.WX?(n+='"',n+=e.DTd(y),n+='"'):n+=y}return n+"]"}isEqual(m){const {Annotations:n}=d(76);if(!m)throw Error.argumentNull("other");if(this===m)return!0;if(!m||this.lr!==m.hnb||this.l3d!==m.l3d)return!1;let v=0,A=null,w=!1;m.EJc((y,u)=>{++v;if(!w){var E=-1;for(let G=0,I=this.qN.length;G<I;++G)if(this.qN[G].dNa===y){E=G;break}0>E?w=!0:(A||(A=Array(this.qN.length)),A[E]=u)}});if(this.qN.length!==v||w)return!1;for(let y=0,u=this.qN.length;y<u;++y)if(!n.DZa(this.lr.getAttributeType(this.qN[y].dNa),
this.qN[y].value,A[y]))return!1;return!0}aK(){return this.isReadOnly?this.clone():this}Xbe(){const {Annotations:m}=d(76);if(!this.isReadOnly){this.aLa=!0;for(const n of this.qN)m.l9a(n.value)}}toString(){return this.D0()}static DTd(m){return m.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(J.a)(e,"FeatureBundle",null,[1101,1102])},260:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.click="Click";h.Vtb="InteractionBegin";h.Qpg="InteractionEnd";
h.nQf="ControlActivated";h.query="Query";h.$7g="QueryIndexRecorded";h.DOf="Clicks";h.Mzf="ActionEvents";h.t2f="FilteredActionEvents";h.Ljh="SessionContext";h.latency="Latency";h.performance="Performance";h.deh="RenderedResults";h.events="Events";h.Kzi="CreateResultsMenu";h.HF="UpdateRibbonControls";h.VUk="ResultsAggregation";h.qD="IssueQuery";h.bpi="CommandSuggestions";h.error="Error";h.Obe="LoadModelData";h.tEi="DepsResolveTime";h.idk="ModelDataWaitTime";h.timedOut="TimedOut";h.o6h="AddinQueryCommandReady";
h.eXi="GetAddinEntitlements";h.K7g="ProviderMRUEvents";h.UJi="EnableAddinSearchCommands";Object(J.a)(h,"EventNames",null,[])},277:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.coe=null;this.Fy=this.Mpe=0}WJc(e,m,n){if(!e)throw Error.argumentNull("referenceList");if(0>m||m>e.length)throw Error.argumentOutOfRange("startIndex");if(0>n||n>e.length)throw Error.argumentOutOfRange("length");if(m+n>e.length)throw Error.argument("Invalid start-length range");this.coe=e;
this.Mpe=m;this.Fy=n}zPa(e,m,n){this.WJc(e.coe,e.Mpe+m,n)}ga(e){if(0>e||e>=this.Fy)throw Error.argumentOutOfRange("index");return this.coe[this.Mpe+e]}get count(){return this.Fy}static hPd(e){const m=new h;m.WJc(e,0,e.length);return m}}Object(J.a)(h,"ReadOnlyList",null,[1122])},297:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=
20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.Addin=24]="Addin";e[e.OfficeScript=25]="OfficeScript";e[e.AddinStoreEntry=26]="AddinStoreEntry";e[e.None=27]="None";e[e.MergedActions=28]="MergedActions";e[e.MergedScopedSearches=29]="MergedScopedSearches";e[e.MergedSuggestedSearches=30]="MergedSuggestedSearches"})(h||(h={}));Object(J.b)("ResultGroupType",h)},325:function(J,V,d){d.r(V);d.d(V,"CommandResultsUtility",function(){return u});J=d(0);var h=
d(371),e=d(260),m=d(372),n=d(158),v=d(175),A=d(118),w=d(104),y=d(25);class u{static iJb(E,G){if(G&&G.uo){const I={};for(const H of E)G.fUc(H)&&(I[H]=appChrome.selectors.getModelType(H));A.TellMeActor.instance.HF(I)}}static Xkl(E){return E.startsWith("btnTellMeOfficeAddIn")}static l3b(E){const G=A.TellMeActor.instance.jG();return!!G&&G.uo&&!appChrome.selectors.isControlDisabled(E)}static AVc(E,G,I,H){if(A.TellMeActor.instance.Jd&&E){const K=[];for(const C of E)K.push(String.format('{{"Id":"{0}","Score":{1}}}',
C.commandId,C.score));E={};E[h.a.suggestions]="[{"+K.join(",")+"}]";E[h.a.oyg]=G;E[h.a.groupType]=I;E[h.a.provider]=H;A.TellMeActor.instance.Jd.WG(e.a.bpi,window.performance.now(),E)}}static W_i(E,G){const I=[],H=[];for(const K of G){G=K.commandId;let C=K;K.commandId in E&&(G=E[K.commandId],C=new m.a(G,K.score));Array.contains(H,G)||(I.push(C),H.push(G))}return I}static TMc(E,G,I,H,K,C,Y,M){I.TXd&&(G=u.W_i(I.TXd,G));var P=w.a.d_i(G);u.iJb(P,I);var T=[],L=[];P=[];const aa=new v.a(Y);Y=16===Y||18===
Y||7===Y||4===Y?y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ec("TellMeMaxRecommendedResultsToReturn",3):3:0===Y||17===Y?5:0;for(const Q of G)if(!u.fEj(Q.commandId)){G=u.Xkl(Q.commandId);if(I.fUc(Q.commandId)&&!G){if(w.a.vxg(Q.commandId))continue;G=null;K&&C&&(G=K.g9i(Q.commandId,C));u.l3b(Q.commandId)?Array.add(T,new n.a(Q.commandId,5,G,null,M,Q.score)):Array.add(L,new n.a(Q.commandId,5,G,null,M,Q.score))}else I.Y2a&&G&&H&&Array.add(P,Q.commandId.substr(21));if(T.length+P.length>=Y)break}I=
0;for(K=0;K<T.length&&I<Y;K++,I++)aa.Fv(T[K]);for(T=0;T<L.length&&I<Y;T++,I++)aa.Fv(L[T]);for(L=0;L<P.length&&I<Y;L++,I++)H.mEl(E,P[L],aa);return aa}static fEj(E){u.MHf||(y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.Aw("TellMeControlPredictionBlockList")&&y.AFrameworkApplication.fa.HB("TellMeControlPredictionBlockList").forEach(G=>{Array.add(u.LHf,G.toLowerCase())}),u.MHf=!0);return Array.contains(u.LHf,E.toLowerCase())}static N7d(E){return 2<E.length&&";"===E.charAt(0)&&";"===E.charAt(E.length-
1)&&!!y.AFrameworkApplication.fa&&(y.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled")||y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static L7f(E){const G=new v.a(0);var I=E.split(";");E=A.TellMeActor.instance.jG();for(const H of I)if(0<H.length){I=H.split(":");const K=2===I.length?I[0]:H;if(!E.fUc(K))break;if(1===I.length)I=new n.a(K,5,null,null,1),G.Fv(I);else if(2===I.length)I=new n.a(K,5,I[1],null,1),G.Fv(I);else break}return G}static H_h(E,
G,I){if(!(G&&G.results&&E&&E.results&&E.results.length))return{returnValue:!1,BFd:E,VFd:G};const H=[];for(var K of G.results)Array.add(H,K.value);K=0;const C=0<G.results.length?G.results[0].score:0;for(const Y of E.results)if(Y.score>I&&!Array.contains(H,Y.value)&&u.l3b(Y.value)&&(0<C&&(Y.score=C),Array.insert(G.results,K,Y),K++),2===K)break;return 0<K?(I=G.results.length-5,0<I&&G.xDe(I),{returnValue:!0,BFd:E,VFd:G}):{returnValue:!1,BFd:E,VFd:G}}}u.MHf=!1;u.LHf=[];Object(J.a)(u,"CommandResultsUtility",
null,[])},371:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.appName="AppName";h.N3a="CloseAllMenus";h.commandId="CommandId";h.context="Context";h.culture="Culture";h.message="Message";h.errorMessage="ErrorMessage";h.event="Event";h.y7="CorrelationID";h.Lsk="ParentUiElement";h.query="Input";h.Ndb="QueryID";h.i8g="QueryLength";h.UDb="QueryIndex";h.WUk="ResultsList";h.suggestions="Suggestions";h.scenario="Scenario";h.sessionId="SessionID";h.source="Source";h.timeStamp="Time";h.nzh=
"UiElement";h.Hbd="ReactUx";h.value="Val";h.statusCode="StatusCode";h.G_k="Service";h.isSuccess="IsSuccess";h.Qml="TokenAcquired";h.ARj="LatencyType";h.groupName="GroupName";h.a7a="GroupIndex";h.groupType="GroupType";h.RUk="ResultInfoList";h.resultType="ResultType";h.ONe="SubResultType";h.yHj="IsInputBlur";h.zHj="IsInputFocus";h.dNj="IsShortCutUsed";h.actionType="ActionType";h.count="Count";h.TIi="DwellTime";h.oyg="IsZeroTerm";h.pBl="WordsCount";h.uTc="IsSearchUxEnabled";h.vOj="IsTellMeInHeaderEnabled";
h.module="Module";h.resultIndex="ResultIndex";h.IRd="DisplayIndex";h.cKi="EnableList";h.provider="Provider";h.contentType="ContentType";h.HMj="IsSelectionBased";h.mbi="BeginPerformanceMarker";h.yKi="EndPerformanceMarker";h.Nuk="PerformanceMeasure";Object(J.a)(h,"Columns",null,[])},372:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.commandId=e;this.score=m}}Object(J.a)(h,"CommandSuggestion",null,[])},435:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{static Lmc(e){if(!e)return"{NULL}";
const m=e.length;return 600>=m?e:e.substring(0,400)+"[...]"+e.substring(m-195,m)}}Object(J.a)(h,"LogUtils",null,[])},436:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"SmartLookupSelection",null,[])},437:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(25);class e{constructor(){this.currentDocumentPath=h.AFrameworkApplication.fa.Ha("EditDocInClientUrl")}}Object(J.a)(e,"SmartLookupApplicationInterface",null,[])},438:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{}h.tellMe="TellMe";h.loki="Loki";h.substrate="Substrate";h.UDb="QueryIndex";h.uvh="TellMeRanker";h.vvh="TellMeRankerLogging";Object(J.a)(h,"Services",null,[])},439:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Hra="HttpRequest";h.provider="Provider";Object(J.a)(h,"LatencyTypes",null,[])},440:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.data=this.landingTab=null}}Object(J.a)(h,"LaunchData",null,[])},536:function(J,V,d){J=d(0);
class h{constructor(){this.ymc=this.B2b=null;this.Dre=this.score=this.Fbc=0}txe(I,H,K){this.score=I.ga(H);++H;this.B2b=I.ga(H)?K.k7(I.ga(H)):null;++H;this.ymc=I.ga(H)?K.k7(I.ga(H)):null;++H;this.Fbc=I.ga(H);++H;this.Dre=I.ga(H);++H;return H}}Object(J.a)(h,"TokenStringGeneratorInit",null,[]);class e{constructor(I,H,K,C,Y){this.sPa=I;this.count=H;this.nJc=K;this.gG=C;this.depth=Y}}Object(J.a)(e,"ErrorTolerantTrieMatch",null,[]);var m=d(687),n=d(951);class v{constructor(I=null,H=0,K=0,C=0){this.ZWh=
I||new n.a;this.qba=H;this.gG=K;this.depth=C}get lU(){return this.ZWh}getKey(){return this.lU.Es.toString()+":"+this.qba.toString()}}Object(J.a)(v,"TrieBookmark",null,[]);class A{constructor(I,H){this.yua=I;this.hme=H}tYj(I){if(null==I)throw Error.argumentNull("prefix");let H={};var K=H[""]=new v;this.CPc(K,H);for(K=0;K<I.length;++K){const C=I.charCodeAt(K),Y={};for(let M in H)this.h7h(C,H[M],Y);H=Y}return this.Xnl(H)}CPc(I,H){if(!(I.gG>=this.hme)&&(I=new v(m.a.uMd(I.lU),I.qba,I.gG+1,I.depth),I.lU.Xy&
m.a.JJa&&(I.qba+=1),this.yua.phb(I.lU))){I.depth+=1;let K=!0;for(;K;)A.Fld(I,H),this.CPc(I,H),I.qba+=this.yua.Nrb(I.lU,!0)+(I.lU.Xy&m.a.JJa?1:0),K=this.yua.Gmc(I.lU)}}h7h(I,H,K){H.gG+1<=this.hme&&(H.gG+=1,A.Fld(H,K),--H.gG);H.lU.Xy&m.a.JJa&&(H.qba+=1);if(this.yua.phb(H.lU)){H.depth+=1;let C=!0;for(;C;)H.lU.Qhb===I?(A.Fld(H,K),this.CPc(H,K)):H.gG+1<=this.hme&&(H.gG+=1,A.Fld(H,K),this.CPc(H,K),--H.gG),H.qba+=this.yua.Nrb(H.lU,!0)+(H.lU.Xy&m.a.JJa?1:0),C=this.yua.Gmc(H.lU)}}Xnl(I){const H=[];for(var K in I){const C=
I[K];if(!C.lU.Es)continue;const Y=!!(C.lU.Xy&m.a.JJa),M=this.yua.Nrb(C.lU,!1)+(Y?1:0);Array.add(H,new e(C.qba,M,Y,C.gG,C.depth))}H.sort((C,Y)=>{let M=C.sPa-Y.sPa;return M||(M=-(C.count-Y.count))?M:M=C.depth-Y.depth});if(2>H.length)return H;I=[];for(K=0;K<H.length;)K+=A.exh(K,H,I);return I}static Fld(I,H){const K=I.getKey();K in H?(H=H[K],H.gG=Math.min(H.gG,I.gG)):H[K]=new v(m.a.uMd(I.lU),I.qba,I.gG,I.depth)}static exh(I,H,K){const C=H[I];let Y=C.sPa;const M=Y+C.count;let P=1,T=C.nJc;for(;I+P<H.length&&
H[I+P].sPa<M;){const L=H[I+P];L.sPa>Y&&(Array.add(K,new e(Y,L.sPa-Y,T,C.gG,C.depth)),T=!1);P+=A.exh(I+P,H,K);Y=L.sPa+L.count}Y<M&&Array.add(K,new e(Y,M-Y,T,C.gG,C.depth));return P}}Object(J.a)(A,"ErrorTolerantTrieLookupEngine",null,[1179]);class w extends h{constructor(I,H,K){super();this.rlg=this.q1g=!1;this.U_f=null;if(I){var C=0;try{C=this.txe(I,C,H);this.q1g=1===I.ga(C);++C;this.rlg=1===I.ga(C);++C;const Y=I.ga(C);this.U_f=this.$sk(K,Y)}catch(Y){throw Error.argument("initData");}}}$sk(I,H){return new A(I,
H)}}Object(J.a)(w,"FuzzyMatchTokenStringGeneratorInit",h,[]);class y extends h{constructor(I,H){super();this.query=this.name=null;if(I){this.annotations=H.annotations;var K=0;try{K=this.txe(I,K,H),this.name=H.LB(I.ga(K)),++K,this.query=H.gD(I.ga(K))}catch(C){throw Error.argument("initData");}}}}Object(J.a)(y,"QueryTokenStringGeneratorInit",h,[]);class u extends h{constructor(I,H){super();if(I)try{this.txe(I,0,H)}catch(K){throw Error.argument("initData");}}}Object(J.a)(u,"SurfaceStringTokenStringGeneratorInit",
h,[]);var E=d(277);d.d(V,"a",function(){return G});class G{constructor(I){this.Hde=I}get B2b(){return this.Hde.B2b}get ymc(){return this.Hde.ymc}get Fbc(){return this.Hde.Fbc}static create(I,H,K){const {SurfaceStringTokenStringGenerator:C}=d(1089),{QueryTokenStringGenerator:Y}=d(1090),{FuzzyMatchTokenStringGenerator:M}=d(1091);let P=0;try{if(I.ga(P)!==G.o3a)throw Error.argument("initData","Input does not represent a token string generator");++P;const T=I.ga(P);++P;const L=new E.a;L.zPa(I,P,I.count-
P);switch(T){case C.kUb:return new C(new u(L,H));case Y.kUb:return new Y(new y(L,H));case M.kUb:return new M(new w(L,H,K));default:throw Error.argument("initData");}}catch(T){throw Error.argument("initData");}}static VBf(I,H,K,C,Y,M){I=I.Xml.getId(H,null);if(0>I)return++M,M;G.WBf(I,K,C,Y);return M}static WBf(I,H,K,C){Array.add(C.uNe,I);Array.add(C.hth,H);++C.AIb[K]}}G.o3a=1099767983;Object(J.a)(G,"TokenStringGenerator",null,[1162])},675:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=
d(104);d=d(25);class e{static wOj(){return!h.a.Atg()&&!h.a.L8a()&&e.isFeatureEnabled(0)}static Uwg(){return e.isFeatureEnabled(1)}static wug(){return e.isFeatureEnabled(2)}static isFeatureEnabled(m){return!!(e.kLh&1<<m)}}e.kLh=d.AFrameworkApplication.fa?d.AFrameworkApplication.fa.Ec("TellMeFeatureConfigValue",0):0;Object(J.a)(e,"TellMeFeatureAvailability",null,[])},676:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(158);class h extends d.a{constructor(e,m,n,v,A=null){super(e,m,A,null,
n);this.id=v}}Object(J.a)(h,"TryQueryResultBinding",d.a,[])},677:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.Ia=e}get tGa(){return this.Ia.tGa}get sil(){return 4!==this.Ia.style}get vil(){return!0}get trie(){return this.Ia.trie}getId(e,m){if(!this.sil)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ia.style){case 0:return this.r4i(e,m);default:throw Error.notImplemented();}}LB(e){if(!this.vil)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>e||e>=this.tGa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ia.style){case 0:return this.Ndj(e);case 4:return this.Mdj(e);default:throw Error.notImplemented();}}r4i(e,m){e=this.Ia.trie.DBg(e,0,e.length,m);if(!e.succeeded)return-1;if(0>e.KIb||e.KIb>=this.Ia.tGa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ia.Hmc?this.Ia.ihc.Ot(this.Ia.Hmc+4*e.KIb,4):e.KIb}Ndj(e){if(this.Ia.Hmc){let m=0;for(;m<this.Ia.tGa&&this.Ia.ihc.Ot(this.Ia.Hmc+
4*m,4)!==e;++m);if(m>=this.Ia.tGa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ia.trie.Vdg(m)}return this.Ia.trie.Vdg(e)}Mdj(e){const m=this.Ia.ihc.Ot(this.Ia.fth+4*e,4);e=this.Ia.ihc.Ot(this.Ia.gth+4*e,4);if(0>e||0>m)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const n=Array(m);for(let v=0;v<m;++v)n[v]=({ftj:e}=this.GHk(e)).returnValue;return String.fromCharCode.apply(null,n)}GHk(e){let m=0;for(let n=0;3>n;++n){const v=
this.Ia.ihc.ga(this.Ia.dMf+e)^182;++e;m|=(v&127)<<7*n;if(!(v&128))break}return{returnValue:m,ftj:e}}}Object(J.a)(h,"StringTable",null,[1121])},678:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(687);class e{constructor(m){this.trie=null;this.dMf=this.fth=this.gth=this.Hmc=0;if(m){this.ihc=m;var n=0;if(m.Ot(n,4)!==e.o3a)throw Error.argument("bytes","Input does not represent a string table");n+=4;this.tGa=m.Ot(n,4);n+=4;this.style=m.Ot(n,4);n+=4;switch(this.style){case 0:const v=1===
m.Ot(n,4);n+=4;v||(this.Hmc=n,n+=4*this.tGa);m.Ot(n,4);this.trie=this.Btk(m,n+4);break;case 4:this.gth=n;this.fth=n+=4*this.tGa;n+=4*this.tGa;m.Ot(n,4);this.dMf=n+4;break;default:throw Error.argument("bytes");}}}Btk(m,n){return new h.a(m,n)}}e.o3a=1025118440;Object(J.a)(e,"StringTableInit",null,[])},687:function(J,V,d){J=d(0);class h{constructor(w){this.FUg=w;this.succeeded=!1;this.KIb=w?w.KIb:0;this.tOj=!1;this.length=this.ikl=0}}Object(J.a)(h,"TrieResult",null,[]);class e{constructor(w,y,u){this.ho=
new h(null);this.A4j=w;this.w8b=y;this.XEg=y+u-1}get result(){return this.ho}Pag(){let w;return this.w8b<=this.XEg?(w=this.A4j.charAt(this.w8b),++this.w8b,{returnValue:!0,ch:w}):{returnValue:!1,ch:"\x00"}}fDe(w,y,u){w&&(this.ho.tOj=!0,this.ho.ikl=y);this.ho.length=this.w8b;this.ho.succeeded=!0;this.ho.KIb=u;this.w8b!==this.XEg+1&&(this.ho=new h(this.ho))}}Object(J.a)(e,"LookUpStringVisitor",null,[1142]);var m=d(951);class n{constructor(){this.OLf=this.mJf=this.oJf=this.lJf=this.nJf=this.cKd=this.bKd=
this.eKd=this.aKd=0}}Object(J.a)(n,"TRIESTATS",null,[]);class v{constructor(){this.symbol=this.Acc=0}}Object(J.a)(v,"TrieSymbol",null,[]);d.d(V,"a",function(){return A});class A{constructor(w,y){this.pT=null;this.mZc=this.wHg=this.uHg=this.yHg=this.qHg=this.xHg=this.vHg=this.zHg=this.rHg=0;this.RB=w;if(w.Ot(y,4)!==A.o3a)throw Error.argument("Input does not represent a trie");y+=4;this.vFg=1===w.Ot(y,4);y+=4;this.n0j=1===w.Ot(y,4);y+=4;this.X_j=w.Ot(y,4);y+=4;if(w.Ot(y,4)){w=y+4;this.pT=this.IHk(w);
this.rHg=y=w+A.Lfi;this.zHg=y+=A.DBc*(this.pT.aKd+(this.pT.aKd%2?1:0));this.vHg=y+=A.DBc*(this.pT.eKd+(this.pT.eKd%2?1:0));this.xHg=y+=A.DBc*(this.pT.bKd+(this.pT.bKd%2?1:0));this.qHg=y+=A.DBc*(this.pT.cKd+(this.pT.cKd%2?1:0));this.yHg=y+=A.iKd*this.pT.lJf;this.uHg=y+=A.jKd*this.pT.oJf;this.wHg=y+=A.jKd*this.pT.mJf;y+=A.jKd*this.pT.nJf;if(y!==w+this.pT.OLf)throw Error.argument("Corrupted trie binary");this.mZc=y}else this.pT=null}DBg(w,y,u,E){w=new e(w,y,u);this.KDh(w,E);return w.result}Vdg(w){if(this.vFg)if(w)--w;
else return"";if(!this.pT)throw Error.argument("Invalid trieID");const y=new m.a;y.Xy=0;this.phb(y);const u=[];for(;;){if(y.Xy&A.JJa)if(w)--w;else return Array.add(u,y.Qhb),String.fromCharCode.apply(null,u);const E=!!(y.Xy&A.$md),G=this.Nrb(y,!0);if(E||w<G){if(Array.add(u,y.Qhb),!this.phb(y))throw Error.argument("Invalid trieID");}else if(w-=G,!this.Gmc(y))throw Error.argument("Invalid trieID");}}KDh(w,y){let u=0;this.vFg&&(w.fDe(this.n0j,this.X_j,0),++u);if(this.pT){var E=new m.a;E.Xy=0;if(this.phb(E))for(;;){var G=
void 0;if(!({ch:G}=w.Pag()).returnValue)break;y&&(G=y(G));G=G.toString().charCodeAt(0);let I=!1;for(;!I;){const H=!!(E.Xy&A.JJa);if(E.Qhb===G){if(I=!0,H&&w.fDe(!!(E.Xy&A.NUe),E.fjd,u),!this.phb(E))return}else if(u+=this.Nrb(E,!0),!this.Gmc(E))return;H&&++u}}}}phb(w){if(!w.Xy)return this.BQe(w),!0;if(!(w.Xy&A.Zmd))return!1;w.Jra=0;w.Es=w.eRa;this.BQe(w);return!0}Gmc(w){if(w.Xy&A.$md)return!1;this.BQe(w);return!0}Nrb(w,y){return w.Xy&A.MUe?w.ABc:w.Xy&A.Zmd?!y&&w.Xy&A.$md?this.b0i(w):1:0}b0i(w){w=A.uMd(w);
if(!this.phb(w))return 0;let y=0;do w.Xy&A.JJa&&++y,y+=this.Nrb(w,!1);while(this.Gmc(w));return y}BQe(w){w.Xy||(w.Jra=0,w.Es=this.mZc);var y=this.NFc(this.rHg,w.Es),u=y.symbol;w.Es+=y.Acc;y=this.RB.Ot(this.qHg+A.iKd*u,A.iKd);w.Qhb=y&65535;w.Xy=y>>16;w.Xy&A.MUe&&(w.ABc=this.UCi(w));w.Xy&A.NUe&&(y=this.NFc(this.zHg,w.Es),u=y.symbol,w.Es+=y.Acc,w.fjd=this.RB.Ot(this.yHg+4*u,4));w.Xy&A.RFh?(w.eRa=this.mZc+((this.RB.ga(w.Es)<<8|this.RB.ga(w.Es+1))<<8|this.RB.ga(w.Es+2)),w.Es+=3):w.Xy&A.SFh?(w.eRa=w.Es,
w.Jra=w.eRa):w.Xy&A.TFh?(y=this.NFc(this.vHg,w.Es),u=y.symbol,w.Es+=y.Acc,w.eRa=this.mZc+this.RB.Ot(this.uHg+4*u,4)):w.Xy&A.Zmd&&(y=this.NFc(this.xHg,w.Es),u=y.symbol,w.Es+=y.Acc,w.Jra||(w.Jra=w.Es),w.Jra+=this.RB.Ot(this.wHg+4*u,4),w.eRa=w.Jra)}NFc(w,y){const u=new v;let E=0;for(;;){E+=this.RB.ga(y);++y;++u.Acc;const G=this.RB.Ot(w,2);if(E<G)break;u.symbol+=G;E-=G;w+=2;E<<=8}u.symbol+=E;return u}UCi(w){let y=this.RB.ga(w.Es);192<=y?(y=(y&63)<<15|(this.RB.ga(w.Es+1)&127)<<8,y|=this.RB.ga(w.Es+2),
w.Es+=3):128<=y?(y=(y&127)<<8|this.RB.ga(w.Es+1),w.Es+=2):w.Es+=1;return y}IHk(w){const y=new n;y.aKd=this.RB.Ot(w+12,2);y.eKd=this.RB.Ot(w+14,2);y.bKd=this.RB.Ot(w+16,2);y.cKd=this.RB.Ot(w+18,2);y.nJf=this.RB.Ot(w+24,4);y.lJf=this.RB.Ot(w+28,4);y.oJf=this.RB.Ot(w+32,4);y.mJf=this.RB.Ot(w+36,4);y.OLf=this.RB.Ot(w+40,4);return y}static uMd(w){const y=new m.a;y.Qhb=w.Qhb;y.Xy=w.Xy;y.ABc=w.ABc;y.Es=w.Es;y.eRa=w.eRa;y.Jra=w.Jra;y.fjd=w.fjd;return y}}A.o3a=1654263084;A.Lfi=48;A.DBc=2;A.jKd=4;A.iKd=4;A.JJa=
1;A.$md=2;A.MUe=4;A.NUe=8;A.Zmd=16;A.SFh=64;A.TFh=128;A.RFh=256;Object(J.a)(A,"Trie",null,[1138])},690:function(J,V,d){d.r(V);J=d(0);d(146);var h=d(260);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(J.a)(e,"AppsForOfficeStoreType",null,[]);var m=d(118),n=d(25),v=d(78),A=d(35);class w{constructor(){this.oCd=0}IAe(K,C){this.oCd=window.performance.now();this.EZa(()=>{const Y=window.performance.now(),M={},P=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);C.pDf&&(M.callback=T=>{K(T,e.marketPlace,Y)},P&&(M.storeType=e.marketPlace),n.AFrameworkApplication.Ta.Ka(A.a.GWa,2,M));C.qDf&&(M.callback=T=>{K(T,e.privateCatalog,Y)},P?M.storeType=e.privateCatalog:n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?M.storeType=10:M.storeType=e.privateCatalog,n.AFrameworkApplication.Ta.Ka(A.a.GWa,2,M))},0,()=>{if(m.TellMeActor.instance.Jd)m.TellMeActor.instance.Jd.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.oCd)+" ms")})}EZa(K,C=0,Y=null){2!==n.AFrameworkApplication.Ta.processAction(A.a.GWa,1)?(m.TellMeActor.instance.Jd&&m.TellMeActor.instance.Jd.WG(h.a.o6h,window.performance.now()-this.oCd),K()):C<w.Pbk?n.AFrameworkApplication.ue.Gb(new v.a(2,1,w.jAl,()=>{this.EZa(K,C+1,Y)})):Y&&Y()}static get instance(){w.Ja||(w.Ja=new w);return w.Ja}}w.Ja=null;w.Pbk=20;w.jAl=500;Object(J.a)(w,"AddinEntitlementsQuery",null,[]);class y{constructor(){this.description=
this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Tae=this.storeType=this.storeId=this.cCk=this.iconUrl=null}}Object(J.a)(y,"AddinInfo",null,[]);var u=d(158),E=d(175),G=d(174),I=d(104);d.d(V,"AddinResultsProvider",function(){return H});class H{constructor(K){this.rb=K;this.gkk=(C,Y,M)=>{if(C){const P=C.errorCode;if(m.TellMeActor.instance.Jd){const T={};T.StoreType=Y;T.ErrorCode=P;T.AddinCount=C.value?C.value.length:0;
m.TellMeActor.instance.Jd.WG(h.a.eXi,window.performance.now()-M,T)}if(0===P&&C.value){H.S2a=H.S2a||{};C=C.value;for(const T of C)C=new y,C.displayName=T[0],C.id=T[1],C.description=T[2],C.targetType=T[3],C.appVersion=4<T.length?T[4]:"",C.assetId=5<T.length?T[5]:"",C.assetStoreId=6<T.length?T[6]:"",C.width=7<T.length?T[7]:0,C.height=8<T.length?T[8]:0,C.iconUrl=9<T.length?T[9]:"",C.cCk=10<T.length?T[10]:"",C.storeId=11<T.length?T[11]:"",C.storeType=12<T.length?T[12]:"",this.rb.uih&&(C.Tae=this.p5i(C)),
H.S2a[C.id]=C,0<C.iconUrl.length&&appChrome.addInApi.registerAddinIcon("AddinIcon_"+C.id,C.iconUrl)}}};w.instance.IAe(this.gkk,this.rb)}nG(){return"Add-ins"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:2}qD(K,C,Y,M,P=null){Y=new G.a(K);P&&!Array.contains(P,24)||I.a.cN(K)||(P=new E.a(24),P.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.Y4i(K.Ff,P),Y.us(P));C.resultsUpdated(Y)}Y4i(K,C){if((K=this.tYk(K))&&0<K.length){let Y=0;K.forEach(M=>{if(!(3<++Y)){var P="AddinSuggestion"+Y,T={};T["default"]=
0<M.iconUrl.length?"AddinIcon_"+M.id:"AppForOfficeLogo_20";var L=[];L.push(appChrome.actions.setControlLabel(P,M.displayName));L.push(appChrome.actions.setControlIconSet(P,T));L.push(appChrome.actions.setCompoundButtonCommandValueId(P,M.id));L.push(appChrome.actions.updateCompoundButtonDescription(P,M.description));n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(T=window.performance.now(),L.push(appChrome.actions.updateControlEnabledDisabledState(P,
!1)),m.TellMeActor.instance.Jd&&m.TellMeActor.instance.Jd.WG(h.a.UJi,window.performance.now()-T));appChrome.api.dispatch(L);P=new u.a(P,25,void 0,void 0,1);P.TGd=Telemetry.PrivacyRules.GetPrivacyCompliantId(M.id,M.storeType,M.assetId,null,null,M.storeId);C.Fv(P)}})}}tYk(K){if(!H.S2a)return null;const C=[],Y=H.S2a;for(let P in Y){var M=Y[P];M&&(this.rb.uih?H.hbk(K,M)&&Array.add(C,M):0<=M.displayName.toLowerCase().indexOf(K.toLowerCase())?Array.add(C,M):this.rb.zMj&&0<=M.description.toLowerCase().indexOf(K.toLowerCase())&&
Array.add(C,M))}return C}p5i(K){const C=H.ksh(K.displayName);this.rb.p6h&&Array.addRange(C,H.ksh(K.description));return C}static hbk(K,C){if(!C.Tae)return!1;for(const Y of K.split(" ")){K=!1;for(const M of C.Tae)if(M.toLowerCase().startsWith(Y.toLowerCase())){K=!0;break}if(!K)return!1}return!0}static ksh(K){const C=[];for(const Y of K.split(" ")){K=0;for(let M=0;M<Y.length;M++){const P=Y.charAt(M);P.toString().toUpperCase()===P.toString()&&M>K&&(Array.add(C,Y.substring(K,M)),K=M)}Array.add(C,Y.substring(K,
Y.length));K&&Array.add(C,Y.substring(0,Y.length))}return C}}H.S2a=null;Object(J.a)(H,"AddinResultsProvider",null,[968])},76:function(J,V,d){d.r(V);J=d(0);var h=d(22),e=d(215),m=d(135),n=d(677),v=d(678);class A{constructor(y,u){this.aLa=!1;this.f3=null;if(!y)throw Error.argumentNull("annotations");if(!y.Kvb(u))throw Error.argument("structTypeID","Invalid struct type ID");this.lr=y;this.Kwb=this.lr.abg(u);this.OVh=u}get hnb(){return this.lr}get isReadOnly(){return this.aLa}get Gwa(){return this.OVh}UPa(y){if(0>
y||y>=this.Kwb)throw Error.argument("iField","Invalid field index");return this.f3&&null!=this.f3[y]?this.f3[y]:this.lr.Wdg(this.Gwa,y)}cIe(y,u){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>y||y>=this.Kwb)throw Error.argument("iField","Invalid field index");if(!this.lr.Hub(this.lr.I6a(this.Gwa,y),u))throw Error.argument("value","Value is not of the correct type for the specified field");(this.f3||(this.f3=Array(this.Kwb)))[y]=u}D0(){const {Annotations:y}=
d(76);let u="[";if(this.f3){let E=!0;for(let G=0;G<this.Kwb;++G){if(null==this.f3[G])continue;const I=this.lr.I6a(this.Gwa,G);if(y.DZa(I,this.f3[G],this.lr.Wdg(this.Gwa,G)))continue;E?E=!1:u+=", ";u+=this.lr.Xdg(this.Gwa,G);u+="=";const H=this.lr.D0(I,this.f3[G]);I===y.WX?(u+='"',u+=e.a.DTd(H),u+='"'):u+=H}}return u+"]"}isEqual(y){const {Annotations:u}=d(76);if(this===y)return!0;if(!y||this.lr!==y.hnb||this.Gwa!==y.Gwa)return!1;for(let E=0;E<this.Kwb;++E)if(!u.DZa(this.lr.I6a(this.Gwa,E),this.UPa(E),
y.UPa(E)))return!1;return!0}clone(){const y=new A(this.lr,this.Gwa);this.f3&&(y.f3=Array.clone(this.f3));return y}aK(){return this.isReadOnly?this.clone():this}Xbe(){const {Annotations:y}=d(76);if(!this.isReadOnly&&(this.aLa=!0,this.f3))for(let u=0;u<this.Kwb;++u){const E=this.f3[u];null!=E&&y.l9a(E)}}toString(){return this.D0()}}Object(J.a)(A,"StructValue",null,[1104,1102]);d.d(V,"Annotations",function(){return w});class w{constructor(y,u){if(!y)throw Error.argumentNull("initData");if(!u)throw Error.argumentNull("objectFetcher");
this.N_j=u.iIi;let E=0;var G=u.IPa(y.ga(E));++E;this.Qpe=new n.a(new v.a(G));this.TKh=y.ga(E);++E;this.aFg=Array(this.ZHc);this.I7b=Array(this.ZHc);this.vTa=Array(this.ZHc);for(G=0;G<this.ZHc;++G){this.aFg[G]=u.LB(y.ga(E));++E;this.I7b[G]=y.ga(E);++E;var I=y.ga(E);++E;this.vTa[G]=Array(I);for(var H=0;H<I;++H)this.vTa[G][H]=u.LB(y.ga(E)),++E}this.NVh=y.ga(E);++E;this.yPg=Array(this.flc);this.l3c=Array(this.flc);this.m3c=Array(this.flc);this.k3c=Array(this.flc);for(G=0;G<this.flc;++G)for(this.yPg[G]=
u.LB(y.ga(E)),++E,I=y.ga(E),++E,this.l3c[G]=Array(I),this.m3c[G]=Array(I),this.k3c[G]=Array(I),H=0;H<I;++H)this.l3c[G][H]=u.LB(y.ga(E)),++E,this.m3c[G][H]=y.ga(E),++E,this.k3c[G][H]=({C2:E}=this.mqa(this.m3c[G][H],y,E,null,null,null)).returnValue,w.l9a(this.k3c[G][H]);this.xHh=y.ga(E);++E;this.xde=Array(this.Enb);this.yde=Array(this.Enb);this.wde=Array(this.Enb);for(G=0;G<this.Enb;++G)this.xde[G]=u.LB(y.ga(E)),++E,this.yde[G]=y.ga(E),++E,this.wde[G]=({C2:E}=this.mqa(this.yde[G],y,E,null,null,null)).returnValue,
w.l9a(this.wde[G])}VZb(y){for(let u=0;u<this.Enb;++u)if(this.xde[u]===y)return u;return-1}v6f(y){if(!this.Jvb(y))throw Error.argument("attrID","Invalid attribute ID");return this.xde[y]}getAttributeType(y){if(!this.Jvb(y))throw Error.argument("attrID","Invalid attribute ID");return this.yde[y]}I6a(y,u){if(!this.Kvb(y))throw Error.argument("structTypeID","Invalid struct type ID");y=this.m3c[w.glc(y)];if(0>u||u>=y.length)throw Error.argument("iField","Invalid field index");return y[u]}D0(y,u){if(!this.yae(y))throw Error.argument("typeID",
"Invalid type ID");if(!this.Hub(y,u))throw Error.argument("value","Value is not of the correct type");switch(y){case w.WX:return u;case w.Tea:return u?"True":"False";case w.cna:case w.n$:return u.toString();case w.UL:return u.D0();default:if(!w.eB(y)&&w.Vmc(y)){y=w.xTd(y);const I=this.vTa[y].length;switch(this.I7b[y]){case 0:return this.vTa[y][u];case 1:if(u){var E="";for(var G=1;G<I;++G)u&1<<G-1&&(0<E.length&&(E+=" & "),E+=this.vTa[y][G]);return E}return this.vTa[y][0];case 2:E="";for(G=0;G<I;++G)u&
1<<G&&(0<E.length&&(E+=" & "),E+=this.vTa[y][G]);return E;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.I7b[y]);}}else return u.D0()}}yae(y){switch(y){case w.WX:case w.Tea:case w.cna:case w.n$:case w.UL:return!0;default:return w.eB(y)?this.yae(w.PBa(y)):w.Vmc(y)?this.CPj(y):this.Kvb(y)}}CPj(y){y=w.xTd(y);return 0<=y&&y<this.aFg.length}Kvb(y){y=w.glc(y);return 0<=y&&y<this.yPg.length}Jvb(y){return 0<=y&&y<this.Enb}Hub(y,u){if(null==u)return!1;switch(y){case w.WX:return"string"===
typeof u;case w.Tea:return"boolean"===typeof u;case w.cna:return"number"===typeof u;case w.n$:return"number"===typeof u;case w.UL:return Object(h.a)(1101,u);default:if(w.eB(y))return Object(h.a)(1103,u)&&u.vT===w.PBa(y);if(w.Vmc(y)){if("number"!==typeof u)return!1;y=w.xTd(y);const E=this.vTa[y].length;switch(this.I7b[y]){case 0:return 0<=u&&u<E;case 1:return!(u&-1<<E-1);case 2:return!!u&&!(u&-1<<E);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.I7b[y]);}}else return Object(h.a)(1104,
u)&&u.Gwa===y}}get Enb(){return this.xHh}get ZHc(){return this.TKh}get flc(){return this.NVh}ZXi(y){if(!this.Jvb(y))throw Error.argument("attrID","Invalid attribute ID");return this.wde[y]}abg(y){if(!this.Kvb(y))throw Error.argument("structTypeID","Invalid struct type ID");return this.l3c[w.glc(y)].length}Xdg(y,u){if(!this.Kvb(y))throw Error.argument("structTypeID","Invalid struct type ID");return this.l3c[w.glc(y)][u]}Wdg(y,u){if(!this.Kvb(y))throw Error.argument("structTypeID","Invalid struct type ID");
y=this.k3c[w.glc(y)];if(0>u||u>=y.length)throw Error.argument("iField","Invalid field index");return y[u]}mqa(y,u,E,G,I,H){if(!u)throw Error.argumentNull("initData");if(w.eB(y)){var K=u.ga(E);++E;y=w.PBa(y);var C=new m.a(this,y);for(var Y=0;Y<K;++Y)Array.add(C.items,({C2:E}=this.mqa(y,u,E,G,I,H)).returnValue);return{returnValue:C,C2:E}}switch(y){case w.WX:return{returnValue:(G||this.Qpe).LB(u.ga(E++)),C2:E};case w.Tea:return{returnValue:1===u.ga(E++),C2:E};case w.cna:return{returnValue:u.ga(E++),
C2:E};case w.n$:return{returnValue:(I||this.N_j)[u.ga(E++)],C2:E};case w.UL:y=u.ga(E++);K=new e.a(this);for(C=0;C<y;++C)Y=u.ga(E),++E,H&&(Y=H[Y]),K.Pt(Y,({C2:E}=this.mqa(this.getAttributeType(Y),u,E,G,I,H)).returnValue);return{returnValue:K,C2:E};default:if(w.Vmc(y))return{returnValue:u.ga(E++),C2:E};if(w.jzh(y)){K=u.ga(E++);C=new A(this,y);for(Y=0;Y<K;++Y){const M=u.ga(E);++E;C.cIe(M,({C2:E}=this.mqa(this.I6a(y,M),u,E,G,I,H)).returnValue)}return{returnValue:C,C2:E}}throw Error.argument("typeID",
"Invalid type ID");}}static Vmc(y){return 16<=(y&16383)&&16384!==(y&16384)&&32768!==(y&32768)}static jzh(y){return 16<=(y&16383)&&16384===(y&16384)&&32768!==(y&32768)}static eB(y){return 32768===(y&32768)}static n6i(y){if(w.eB(y))throw Error.argument("nonListTypeID","Non-list type ID required");return y|32768}static PBa(y){if(!w.eB(y))throw Error.argument("listTypeID","List type ID required");return y&-32769}static DZa(y,u,E){switch(y){case w.WX:case w.Tea:case w.cna:case w.n$:return u===E;case w.UL:return u.isEqual(E);
default:return w.eB(y)?u.isEqual(E):w.Vmc(y)?u===E:u.isEqual(E)}}static l9a(y){Object(h.a)(1102,y)&&y.Xbe()}static aK(y){return Object(h.a)(1102,y)?y.aK():y}static xTd(y){return y-16}static glc(y){return(y&-16385)-16}}w.WX=1;w.Tea=2;w.cna=3;w.n$=5;w.UL=9;Object(J.a)(w,"Annotations",null,[1105])},941:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.Jva=e}}Object(J.a)(h,"SessionRehydratedEventArgs",Sys.EventArgs,[])},942:function(J,V,d){d.r(V);
d.d(V,"InsightsMenuItemFactory",function(){return n});J=d(0);var h=d(104),e=d(132),m=d(45);class n{constructor(v=null){this.iNh=v||CommonUIStrings.l_InsightsButtonText}get Feb(){return 10}dK(v){var A=v.TI;v=h.a.aja()?h.a.bOa(A,1):h.a.lPd(A);A=String.format(this.iNh,A);return this.fWi(v,A)}fWi(v,A){return e.a(n.Kpg,h.a.aja()?"1914896509":"3317204163",m.a.ie(A),h.a.Wzj,null,m.a.ie(v),m.a.ie(A),null,null)}}n.Kpg="bInsights";Object(J.a)(n,"InsightsMenuItemFactory",null,[967])},943:function(J,V,d){d.d(V,
"a",function(){return m});J=d(0);var h=d(132),e=d(45);class m{constructor(n,v,A,w,y){this.fBd=n;this.eBd=v;this.CWh=A;this.xMh=w;this.U4e=y}get Feb(){return 4}dK(n,v=null){v=v.sessionId+"|"+v.y7+"|"+n.TI;if(this.U4e||this.xMh){let A=this.U4e||e.a.cB(CommonUIStrings.l_HelpTooltip)===e.a.cB(n.TI.trim());if(this.CWh&&2<n.TI.length){const w=n.TI;";"===w.charAt(0)&&";"===w.charAt(w.length-1)&&w.substring(1,w.length-1)===m.R3d&&(A=!0)}n=A?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
n.TI);return this.N5f(v,e.a.ie(n),A)}return this.N5f(v,e.a.ie(String.format(CommonUIStrings.l_TextWithQuotation,n.TI)),!1)}N5f(n,v,A){return h.a(m.R3d,A?this.eBd:this.fBd,v,"OfficeAssistant_16x16x32","A0",e.a.ie(n),v,null,null)}}m.R3d="bSearchHelp";Object(J.a)(m,"AssistanceMenuItemFactory",null,[967])},944:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(25),e=d(132),m=d(72),n=d(45);class v{get Feb(){return 13}dK(){return v.Kdi()}static Kdi(){return e.b(v.E3f,"798637440",n.a.ie(CommonUIStrings.l_LookupFirstRunExperienceTitle),
h.AFrameworkApplication.Vl,m.getImageClass("Info_32x32x32"),null,null,n.a.ie(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,n.a.ie(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}v.E3f="bTellMeFirstRun";Object(J.a)(v,"FirstRunMenuItemFactory",null,[967])},945:function(J,V,d){d.d(V,"a",function(){return n});J=d(0);var h=d(25),e=d(132),m=d(45);class n{constructor(v=null,A=null){this.Hef=v;this.MQh=A||CommonUIStrings.l_LookupNoResultsDescription}get Feb(){return 14}dK(v){v=
String.format(this.MQh,v.TI);return this.pei(v)}pei(v){return e.b(n.MUg,"798637440",m.a.ie(CommonUIStrings.l_LookupNoResultsTitle),this.Hef?h.AFrameworkApplication.Vl:null,this.Hef,null,null,m.a.ie(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,m.a.ie(v),null,null)}}n.MUg="lookupNoResults";Object(J.a)(n,"NoCommandsFoundMenuItemFactory",null,[967])},946:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=
m}}Object(J.a)(h,"LabelFormatted",null,[])},947:function(J,V,d){d.d(V,"a",function(){return A});J=d(0);d(146);var h=d(158),e=d(175),m=d(174),n=d(104),v=d(45);class A{constructor(w){this.rb=w}nG(){return"Assistance"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:this.rb.Pdc?3:2}qD(w,y,u=!1,E,G=null){E=new m.a(w);if((!G||Array.contains(G,8))&&!n.a.cN(w)){G=new e.a(8);if(u){u=v.a.cB(CommonUIStrings.l_HelpTooltip)===v.a.cB(w.Ff.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
w.Ff);const I=[];this.rb.kSa&&(this.rb.YKe||I.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),u=this.Vag(w.Ff));const H="||"+w.Ff;I.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",u));I.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",H));appChrome.api.dispatch(I);w=new h.a("GetHelpFromTellMe",4,w.Ff,null,1)}else w=new h.a("bSearchHelp",4,w.Ff,null,1);G.Fv(w);G.displayName=CommonUIStrings.l_HelpButtonTitle;E.us(G)}y.resultsUpdated(E)}DQa(w,
y=null){const u=new e.a(8),E=v.a.cB(CommonUIStrings.l_HelpTooltip)===v.a.cB(w.Ff.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,w.Ff);for(let I=0;I<y.length&&2>I;I++){var G=void 0;G=[];let H="GetHelpWithDescriptionFromTellMe"+(I+1).toString(),K=4;if(this.rb.hkc)G.push(appChrome.actions.setControlLabel(H,E)),G.push(appChrome.actions.setCompoundButtonCommandValueId(H,w.Ff)),G.push(appChrome.actions.updateCompoundButtonDescription(H,this.Xfj(y.length)));
else if(this.rb.ikc){let C=this.Zeg(y[I]);H="GetHelpFromTellMe"+(I+1).toString();this.rb.kSa&&(C=this.Vag(C));K=9;G.push(appChrome.actions.setControlLabel(H,C));G.push(appChrome.actions.setButtonCommandValueId(H,this.Vfj(y[I])))}appChrome.api.dispatch(G);G=new h.a(H,K,null,null,0);G.label=this.Zeg(y[I]);G.description=this.Ufj(y[I]);u.Fv(G);if(this.rb.ikc)break}u.displayName=CommonUIStrings.l_HelpButtonTitle;return u}Xfj(w){return 1===w?String.format(CommonUIStrings.l_SearchResultText,w):String.format(CommonUIStrings.l_SearchResultsText,
w)}Vag(w){return this.rb.Z$d?n.a.TYd(w,CommonUIStrings.l_HelpScopedButtonText):w+CommonUIStrings.l_HelpScopedButtonText}Zeg(w){return w.name?w.name:""}Ufj(w){return w.description?w.description:""}Vfj(w){return w.id?"AssetID="+w.id:""}}Object(J.a)(A,"AssistanceResultsProvider",null,[968])},948:function(J,V,d){d.d(V,"a",function(){return w});J=d(0);d(146);var h=d(158),e=d(175),m=d(174),n=d(118),v=d(104),A=d(440);class w{constructor(y){this.rb=y}nG(){return"Image"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?
1:3===this.rb.fr?3:2}qD(y,u,E,G,I=null){E=new m.a(y);(!I||Array.contains(I,19))&&v.a.cN(y)&&this.rb.eH&&this.DQa(y,E,1);u.resultsUpdated(E)}DQa(y,u,E,G=null){var I=[];let H;n.TellMeActor.instance.jG()&&n.TellMeActor.instance.jG().kSa?(H=this.rb.Z$d?v.a.TYd(y.Ff,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):y.Ff+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.rb.YKe||I.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):H=this.rb.eH?
v.a.cN(y)?this.rb.bNa?v.a.GPa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.rb.bNa?v.a.GPa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,y.Ff)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,y.Ff):this.rb.SGb?CommonUIStrings.l_TellMeImageSuggestionButtonText:y.Ff+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.rb.ria?(n.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
H)),I=v.a.bOa(y.Ff,9,Object.assign(new A.a,{landingTab:"Image"})),n.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",I))):(I.push(appChrome.actions.setControlLabel("ImageForSearch",H)),y=v.a.bOa(y.Ff,9,Object.assign(new A.a,{landingTab:"Image"})),I.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",y)),appChrome.api.dispatch(I));E=new h.a("ImageForSearch",12,null,null,E);G&&(E.score=G.ConfidenceScore);G=new e.a(19,this.rb.SGb?CommonUIStrings.l_TellMeImageTitleV2:
CommonUIStrings.l_TellMeImageTitle);G.Fv(E);u.us(G)}}Object(J.a)(w,"ImageResultsProvider",null,[968])},949:function(J,V,d){d.d(V,"a",function(){return A});J=d(0);d(146);var h=d(158),e=d(175),m=d(174),n=d(104),v=d(25);class A{constructor(w){this.rb=w}nG(){return"Template"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:3}qD(w,y){w=new m.a(w);y.resultsUpdated(w)}DQa(w,y,u){var E=[];let G;G=this.rb.eH?this.rb.bNa?n.a.GPa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,w.Ff)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,
w.Ff):String.format(CommonUIStrings.l_TellMeTemplateButtonText,w.Ff);E.push(appChrome.actions.setControlLabel("TemplateForSearch",G));E.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(v.AFrameworkApplication.fa.Ha("TellMeTemplateProviderURL"),v.AFrameworkApplication.uiCulture,w.Ff)));appChrome.api.dispatch(E);w=new e.a(23);w.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;E=new h.a("TemplateForSearch",24,null,null,0);E.label=u[0].Title?u[0].Title:"";E.description=
u[0].Description?u[0].Description:"";w.Fv(E);y.us(w)}}Object(J.a)(A,"TemplateResultsProvider",null,[968])},950:function(J,V,d){d.d(V,"a",function(){return u});J=d(0);d(146);var h=d(325),e=d(158),m=d(175),n=d(174),v=d(676),A=d(118),w=d(104),y=d(45);class u{constructor(E,G,I,H){this.sR=E;this.yMa=G;this.Exf=H;this.zLh=I;this.rb=A.TellMeActor.instance.jG()}nG(){return"EmptyQuery"}yP(){return 1===this.rb.fr?1:0}qD(E,G,I=!1,H,K=null){H=new n.a(E);if((!K||Array.contains(K,5)||Array.contains(K,6)||Array.contains(K,
4))&&w.a.cN(E)){this.sR.p_b().length||!this.zLh||this.Exf||(E=new m.a(6),K=new e.a(null,13,void 0,void 0,1),E.Fv(K),H.us(E));E=new m.a(4);if(0<this.sR.p_b().length){E.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;K=this.sR.p_b();var C=[];for(var Y of K)C.push(Y.Id);h.CommandResultsUtility.iJb(C,this.rb);for(var M of K)h.CommandResultsUtility.l3b(M.Id)&&E.Fv(new e.a(M.Id,5,null,null,2));H.us(E)}if(this.Exf&&0<this.yMa.length&&this.sR.p_b().length<u.mSg){Y=new m.a(5);Y.displayName=CommonUIStrings.l_TellMeTryQueryTitle;
M=u.mSg-E.results.length;E=[];for(K=0;K<this.yMa.length&&K<M;++K){if(I){C=w.a.wRe+(K+1);const P=this.yMa[K].key,T=y.a.replaceAll(P,'"',"");E.push(appChrome.actions.setControlLabel(C,P));E.push(appChrome.actions.setButtonCommandValueId(C,T));C=new v.a(P,7,0,T,C)}else C=new v.a(this.yMa[K].key,7,0,this.yMa[K].value);Y.Fv(C)}0<E.length&&appChrome.api.dispatch(E);H.us(Y)}}G.resultsUpdated(H)}}u.mSg=5;Object(J.a)(u,"EmptyQueryResultsProvider",null,[968])},951:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{constructor(){this.fjd=this.Jra=this.eRa=this.Es=this.ABc=this.Xy=this.Qhb=0}}Object(J.a)(h,"TRIESCAN",null,[])},969:function(J,V,d){d.r(V);var h=d(0),e=d(146),m=d(371),n=d(260),v=d(690);class A{constructor(ua,Pa){this.bod=ua;this.Lh=Pa}resultsUpdated(ua){this.bod.y4k(this.Lh,ua)}}Object(h.a)(A,"AggregatorResultsProviderCallback",null,[970]);var w=d(175),y=d(174);class u{constructor(ua){this.C$=null;this.rb=ua;this.rb.Y2a&&(this.C$=null)}nG(){return"AppsForOffice"}yP(){return 0===this.rb.fr?
0:1===this.rb.fr?1:2}qD(ua,Pa,eb,Kb,bc=null){eb=new y.a(ua);if(!bc||Array.contains(bc,1))bc=new w.a(1),this.C$.cCl(bc,ua.Ff),eb.us(bc);Pa.resultsUpdated(eb)}}Object(h.a)(u,"AppsForOfficeRecommendationResultsProvider",null,[968]);var E=d(947),G=d(76),I=d(215),H=d(22);class K{constructor(ua,Pa){this.Ia=ua;this.j0j=Pa}isMatch(ua,Pa){if(!Object(H.a)(1101,ua))throw Error.argument("objToTest","Expected feature bundle");let eb;return({value:eb}=ua.Dm(this.Ia.Caa)).returnValue?this.Ia.STe.isMatch(eb,Pa):
this.j0j}}Object(h.a)(K,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1125]);class C{constructor(ua,Pa){this.Ia=ua;this.ghe=Pa}isMatch(ua){if(!Object(H.a)(1101,ua))throw Error.argument("objToTest","Expected feature bundle");return!!(this.ghe^ua.Dm(this.Ia.Caa).returnValue)}}Object(h.a)(C,"AnnotatedWithAnnotationFilter",null,[1125]);class Y{constructor(ua){this.Ia=ua}isMatch(ua,Pa){if(!Object(H.a)(1104,ua))throw Error.argument("objToTest","Expected struct value");return this.Ia.STe.isMatch(ua.UPa(this.Ia.Nqa),
Pa)}}Object(h.a)(Y,"FieldValueMatchesStructFilter",null,[1125]);class M{constructor(ua,Pa){ua&&(this.Nqa=ua.ga(0),this.STe=Pa.k7(ua.ga(1)))}}Object(h.a)(M,"FieldValueMatchesStructFilterInit",null,[]);class P{constructor(ua){this.ghe=ua}isMatch(ua){if(!Object(H.a)(1101,ua))throw Error.argument("objToTest","Expected feature bundle");return!!(this.ghe^ua.l3d)}}Object(h.a)(P,"HasAnnotationsAnnotationFilter",null,[1125]);class T{constructor(ua,Pa){this.Ia=ua;this.xp=Pa}isMatch(ua,Pa){if(!Object(H.a)(1103,
ua))throw Error.argument("objToTest","Expected list value");switch(this.xp){case 0:for(const eb of ua.items)if(this.Ia.filter.isMatch(eb,Pa))return!0;return!1;case 1:for(const eb of ua.items)if(!this.Ia.filter.isMatch(eb,Pa))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(T,"ItemTestListFilter",null,[1125]);class L{constructor(ua){this.Ia=ua}isMatch(ua,Pa){if(!Object(H.a)(1103,ua))throw Error.argument("objToTest","Expected list value");return this.Ia.filter.isMatch(ua.items.length,
Pa)}}Object(h.a)(L,"LengthMatchesListFilter",null,[1125]);class aa{constructor(ua,Pa){this.Ia=ua;this.xp=Pa}isMatch(ua,Pa,eb=null){let Kb=0===this.xp;for(const bc of this.Ia.GMf)if((Kb=bc.isMatch(ua,Pa,eb))?1===this.xp:0===this.xp)return Kb;2===this.xp&&(Kb=!Kb);return Kb}}Object(h.a)(aa,"NonterminalFilter",null,[1125]);class Q{constructor(ua,Pa){if(ua){var eb=ua.ga(0);this.GMf=Array(eb);for(let Kb=0;Kb<eb;++Kb)this.GMf[Kb]=Pa.k7(ua.ga(1+Kb))}}}Object(h.a)(Q,"NonterminalFilterInit",null,[]);class ea{constructor(ua,
Pa){this.Ia=ua;this.xp=Pa}isMatch(ua,Pa){if("number"!==typeof ua)throw Error.argument("objToTest","Expected number value");let eb=this.Ia.number;if(this.Ia.query){Pa=this.Ia.query.To(null,Pa);if("number"!==typeof Pa)throw Error.invalidOperation("Query did not return number");eb+=Pa}switch(this.xp){case 0:return ua===eb;case 1:return ua<eb;case 2:return ua<=eb;case 3:return ua>eb;case 4:return ua>=eb;default:throw Error.notImplemented();}}}Object(h.a)(ea,"NumberFilter",null,[1125]);class ia{constructor(ua,
Pa){ua&&(this.number=ua.ga(0),this.query=ua.ga(1)?Pa.gD(ua.ga(1)):null)}}Object(h.a)(ia,"NumberFilterInit",null,[]);class ja{constructor(ua,Pa,eb){this.zLc=this.N2i;this.gFa=ua;this.dGg=Pa;this.bGg=eb}qLd(ua){this.dGg=ua}N2i(ua){if(!ua)throw Error.argument("name","Invalid named feature bundle reference");const Pa=ua.substr(1);return 1===ua.charCodeAt(0)&&Pa===this.gFa?this.dGg:this.bGg?this.bGg.zLc(ua):null}}Object(h.a)(ja,"SimpleNamedFeatureBundleResolver",null,[1169]);class D{constructor(ua){this.Ia=
ua}isMatch(ua,Pa){if(!Object(H.a)(1101,ua))throw Error.argument("objToTest","Expected feature bundle");ua=this.Ia.query.To(null,new ja(this.Ia.rmd,ua,Pa));if("boolean"!==typeof ua)throw Error.invalidOperation("Query did not return bool");return ua}}Object(h.a)(D,"PredicateAnnotationFilter",null,[1125]);class pa{constructor(ua,Pa){ua&&(this.rmd=Pa.LB(ua.ga(0)),this.query=Pa.gD(ua.ga(1)))}}Object(h.a)(pa,"PredicateAnnotationFilterInit",null,[]);class Z{constructor(ua){this.Ia=ua}isMatch(ua,Pa){if("boolean"!==
typeof ua)throw Error.argument("objToTest","Expected bool value");Pa=this.Ia.query.To(null,Pa);if("boolean"!==typeof Pa)throw Error.invalidOperation("Query did not return bool");return ua===Pa}}Object(h.a)(Z,"QueryBooleanFilter",null,[1125]);class oa{constructor(ua,Pa){this.Ia=ua;this.xp=Pa}isMatch(ua,Pa){if("number"!==typeof ua)throw Error.argument("objToTest","Expected integer");Pa=this.Ia.query.To(null,Pa);if("number"!==typeof Pa)throw Error.invalidOperation("Query did not return an enum value");
switch(this.xp){case 0:return ua===Pa;case 1:return 0!==(ua&Pa);case 2:return ua===(ua&Pa);case 3:return Pa===(ua&Pa);default:throw Error.notImplemented();}}}Object(h.a)(oa,"QueryEnumFilter",null,[1125]);class Ba{constructor(ua,Pa){ua&&(this.ESc=1===ua.ga(0),this.query=Pa.gD(ua.ga(1)))}}Object(h.a)(Ba,"QueryEnumFilterInit",null,[]);class Ma{constructor(ua,Pa){this.Ia=ua;this.xp=Pa}isMatch(ua,Pa){if(!Object(H.a)(1103,ua))throw Error.argument("objToTest","Expected list value");Pa=this.Ia.query.To(null,
Pa);if(!Object(H.a)(1103,Pa))throw Error.invalidOperation("Query did not return list value");if(ua.vT!==Pa.vT)return!1;switch(this.xp){case 0:return G.Annotations.DZa(G.Annotations.n6i(ua.vT),ua,Pa);case 1:for(const eb of ua.items)for(const Kb of Pa.items)if(G.Annotations.DZa(ua.vT,eb,Kb))return!0;return!1;case 2:for(const eb of ua.items)for(const Kb of Pa.items)if(!G.Annotations.DZa(ua.vT,eb,Kb))return!1;return!0;case 3:for(const eb of Pa.items)for(const Kb of ua.items)if(!G.Annotations.DZa(ua.vT,
eb,Kb))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(Ma,"QueryListFilter",null,[1125]);class za{constructor(ua,Pa){this.Ia=ua;this.xp=Pa}isMatch(ua,Pa){if("string"!==typeof ua)throw Error.argument("objToTest","Expected string");Pa=this.Ia.query.To(null,Pa);if("string"!==typeof Pa)throw Error.invalidOperation("Query did not return string");this.Ia.E7d&&(ua=ua.toUpperCase(),Pa=Pa.toUpperCase());switch(this.xp){case 0:return ua===Pa;case 1:return 0<=ua.indexOf(Pa);case 2:return ua.startsWith(Pa);
case 3:return ua.endsWith(Pa);case 4:return 0<=Pa.indexOf(ua);case 5:return Pa.startsWith(ua);case 6:return Pa.endsWith(ua);default:throw Error.notImplemented();}}}Object(h.a)(za,"QueryStringFilter",null,[1125]);class ka{constructor(ua,Pa){ua&&(this.query=Pa.gD(ua.ga(0)),this.E7d=1===ua.ga(1))}}Object(h.a)(ka,"QueryStringFilterInit",null,[]);class qa{constructor(ua){this.Ia=ua}isMatch(ua,Pa){if(!Object(H.a)(1104,ua))throw Error.argument("objToTest","Expected struct value");Pa=this.Ia.query.To(null,
Pa);if(!Object(H.a)(1104,Pa))throw Error.invalidOperation("Query did not return struct value");return ua.isEqual(ua)}}Object(h.a)(qa,"QueryStructFilter",null,[1125]);class Ja{constructor(ua){this.Ia=ua}isMatch(ua,Pa){ua=this.Ia.query.To(null,Pa);if("boolean"!==typeof ua)throw Error.invalidOperation("Query did not return bool");return ua}}Object(h.a)(Ja,"QueryWhereConstraintFilter",null,[1125]);class xa{constructor(ua){this.Ia=ua}isMatch(ua){if("string"!==typeof ua)throw Error.argument("objToTest",
"Expected string");return this.Ia.regex.test(ua)}}Object(h.a)(xa,"RegexStringFilter",null,[1125]);class Ga{constructor(ua,Pa){ua&&(this.regex=Pa.pcg(ua.ga(0)))}}Object(h.a)(Ga,"RegexStringFilterInit",null,[]);class na{constructor(ua,Pa){ua&&(this.filter=Pa.k7(ua.ga(0)))}}Object(h.a)(na,"SingleFilterFilterInit",null,[]);class sa{constructor(ua,Pa){ua&&(this.query=Pa.gD(ua.ga(0)))}}Object(h.a)(sa,"SingleQueryFilterInit",null,[]);class Ha{constructor(ua){this.Ia=ua}isMatch(ua){if("boolean"!==typeof ua)throw Error.argument("objToTest",
"Expected bool value");return ua===this.Ia.value}}Object(h.a)(Ha,"StoredValueBooleanFilter",null,[1125]);class cb{constructor(ua){ua&&(this.value=1===ua.ga(0))}}Object(h.a)(cb,"StoredValueBooleanFilterInit",null,[]);class Za{constructor(ua,Pa){this.Ia=ua;this.xp=Pa}isMatch(ua){if("number"!==typeof ua)throw Error.argument("objToTest","Expected integer");switch(this.xp){case 0:return this.Ia.ESc?this.Ia.value?!!(ua&this.Ia.value):!ua:ua===this.Ia.value;case 1:return this.Ia.ESc?(ua&this.Ia.value)===
this.Ia.value:32>ua&&(1<<ua&this.Ia.value)===this.Ia.value;case 2:return this.Ia.ESc?!!(ua&this.Ia.value):32>ua&&!!(1<<ua&this.Ia.value);default:throw Error.notImplemented();}}}Object(h.a)(Za,"StoredValueEnumFilter",null,[1125]);class va{constructor(ua){ua&&(this.ESc=1===ua.ga(0),this.value=ua.ga(1))}}Object(h.a)(va,"StoredValueEnumFilterInit",null,[]);class Fa{constructor(){this.Ksk=null;this.fKd=this.x7a=0}}Object(h.a)(Fa,"WHEREConstraintData",null,[]);class Ca{constructor(ua){this.Ia=ua}isMatch(ua,
Pa){if(!Object(H.a)(Fa,ua))throw Error.argument("objToTest","Expected WHERE constraint data");let eb=-1,Kb=-1;const bc=ua.Ksk;switch(this.Ia.jLd){case 4:eb=bc.pZb;Kb=bc.PMe;break;case 5:eb=ua.x7a;Kb=bc.pZb-ua.x7a;break;case 6:eb=bc.pZb+bc.PMe;Kb=ua.x7a+ua.fKd-eb;break;case 1:case 2:case 3:let oc=!1;for(let W=bc.nCl;W;W=W.next)if(this.Ia.Sxl===W.name){oc=!0;1===this.Ia.jLd?(eb=W.pZb,Kb=W.PMe):2===this.Ia.jLd?(eb=ua.x7a,Kb=W.pZb-ua.x7a):(eb=W.pZb+W.PMe,Kb=ua.x7a+ua.fKd-eb);break}if(!oc)return!1;break;
case 7:eb=ua.x7a;Kb=ua.fKd;break;default:throw Error.notImplemented();}return null!==this.Ia.$fl.LCl(bc.dEl,eb,Kb,eb,!0,2,Pa)}}Object(h.a)(Ca,"SubSreWhereConstraintFilter",null,[1125]);class La{constructor(ua,Pa){if(ua){var eb=Pa.LB(ua.ga(0));this.jLd=eb.charCodeAt(0);this.Sxl=eb.substr(1);this.$fl=Pa.Waj(ua.ga(1))}}}Object(h.a)(La,"SubSreWhereConstraintFilterInit",null,[]);class nb{constructor(ua){this.Ia=ua}isMatch(ua,Pa,eb=null){if(!Object(H.a)(1101,ua))throw Error.argument("objToTest","Expected feature bundle");
if(null==eb)throw Error.argumentNull("parentTextForSpan");if(this.Ia.nEf&&!this.Ia.nEf.isMatch(ua,Pa))return!1;if(this.Ia.mPe){let Kb;if(({value:Kb}=ua.Dm(this.Ia.tfl)).returnValue){if(!this.Ia.mPe.isMatch(Kb,Pa))return!1}else{let bc,oc;if(!({value:bc}=ua.Dm(this.Ia.Xrh)).returnValue||!({value:oc}=ua.Dm(this.Ia.Wrh)).returnValue||0>bc||0>oc||bc+oc>eb.length||!this.Ia.mPe.isMatch(eb.substr(bc,oc),Pa))return!1}}if(this.Ia.zsh){let Kb;if(!({value:Kb}=ua.Dm(this.Ia.Xrh)).returnValue||!this.Ia.zsh.isMatch(Kb,
Pa))return!1}if(this.Ia.Dzg){let Kb;if(!({value:Kb}=ua.Dm(this.Ia.Wrh)).returnValue||!this.Ia.Dzg.isMatch(Kb,Pa))return!1}return!0}}Object(h.a)(nb,"TextSpanFilter",null,[1125]);class Nb{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.Xrh=ua.ga(0),this.Wrh=ua.ga(1),this.tfl=ua.ga(2),this.mPe=ua.ga(3)?Pa.k7(ua.ga(3)):null,this.nEf=ua.ga(4)?Pa.k7(ua.ga(4)):null,this.zsh=ua.ga(5)?Pa.k7(ua.ga(5)):null,this.Dzg=ua.ga(6)?Pa.k7(ua.ga(6)):null)}}Object(h.a)(Nb,"TextSpanFilterInit",null,[]);class Rb{constructor(ua,
Pa){ua&&(this.annotations=Pa.annotations,this.Caa=ua.ga(0),this.STe=ua.ga(1)?Pa.k7(ua.ga(1)):null)}}Object(h.a)(Rb,"ValueFilterAnnotationFilterInit",null,[]);var Ya=d(277);class Qb{k7(ua,Pa){const eb=ua.ga(0),Kb=new Ya.a;Kb.zPa(ua,1,ua.count-1);switch(eb){case 1:return new aa(new Q(Kb,Pa),0);case 2:return new aa(new Q(Kb,Pa),1);case 3:return new aa(new Q(Kb,Pa),2);case 101:return new xa(new Ga(Kb,Pa));case 103:return new za(new ka(Kb,Pa),0);case 104:return new za(new ka(Kb,Pa),1);case 105:return new za(new ka(Kb,
Pa),2);case 106:return new za(new ka(Kb,Pa),3);case 107:return new za(new ka(Kb,Pa),4);case 108:return new za(new ka(Kb,Pa),5);case 109:return new za(new ka(Kb,Pa),6);case 201:return new Ha(new cb(Kb));case 202:return new Z(new sa(Kb,Pa));case 301:return new ea(new ia(Kb,Pa),0);case 302:return new ea(new ia(Kb,Pa),1);case 303:return new ea(new ia(Kb,Pa),2);case 304:return new ea(new ia(Kb,Pa),3);case 305:return new ea(new ia(Kb,Pa),4);case 401:return new Za(new va(Kb),0);case 402:return new Za(new va(Kb),
1);case 403:return new Za(new va(Kb),2);case 404:return new oa(new Ba(Kb,Pa),0);case 405:return new oa(new Ba(Kb,Pa),1);case 406:return new oa(new Ba(Kb,Pa),2);case 407:return new oa(new Ba(Kb,Pa),3);case 501:return new Y(new M(Kb,Pa));case 502:return new qa(new sa(Kb,Pa));case 601:return new T(new na(Kb,Pa),0);case 602:return new T(new na(Kb,Pa),1);case 603:return new L(new na(Kb,Pa));case 604:return new Ma(new sa(Kb,Pa),0);case 605:return new Ma(new sa(Kb,Pa),1);case 606:return new Ma(new sa(Kb,
Pa),2);case 607:return new Ma(new sa(Kb,Pa),3);case 701:return new P(!1);case 702:return new P(!0);case 703:return new C(new Rb(Kb,Pa),!1);case 704:return new C(new Rb(Kb,Pa),!0);case 705:return new K(new Rb(Kb,Pa),!1);case 706:return new K(new Rb(Kb,Pa),!0);case 707:return new D(new pa(Kb,Pa));case 901:return new nb(new Nb(Kb,Pa));case 1002:return new Ja(new sa(Kb,Pa));case 1001:return new Ca(new La(Kb,Pa));default:throw Error.argument("initData");}}}Object(h.a)(Qb,"FilterFactory",null,[1099]);var bb=
d(135);class Bb{constructor(ua){this.Ia=ua}get xx(){return this.Ia.xx}get JT(){return this.Ia.JT}get yid(){return this.Ia.yid}get rRc(){return this.Ia.rRc}load(ua,Pa){return this.To(ua,ua?new ja("root",ua,Pa):Pa)}store(ua,Pa,eb){this.zHb(ua,Pa,ua?new ja("root",ua,eb):eb,null)}To(ua,Pa){if(!this.rRc&&!this.Ia.annotations.Hub(this.xx,ua))throw Error.argument("input","Input value not of expected type");let eb=this.Ia.I3f;for(;eb;)ua=eb.load(ua,Pa),eb=eb.next;return ua}zHb(ua,Pa,eb,Kb){if(!this.yid)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.rRc&&!this.Ia.annotations.Hub(this.xx,ua))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ia.annotations.Hub(this.JT,Pa))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ia.I3f.store(ua,Pa,eb,Kb)}static sOf(ua,Pa,eb,Kb){if(eb===Kb)return Pa;if(G.Annotations.eB(eb)&&G.Annotations.eB(Kb)){eb=G.Annotations.PBa(eb);Kb=G.Annotations.PBa(Kb);const bc=new bb.a(ua,Kb);for(const oc of Pa.items)Array.add(bc.items,Bb.sOf(ua,oc,eb,Kb));return bc}if(eb===
G.Annotations.cna){if(Kb===G.Annotations.n$)return Pa;if(Kb===G.Annotations.WX)return Pa.toString()}else if(eb===G.Annotations.n$){if(Kb===G.Annotations.cna)return Math.floor(Pa);if(Kb===G.Annotations.WX)return Pa.toString()}else if(eb===G.Annotations.WX){if(Kb===G.Annotations.cna)return parseInt(Pa);if(Kb===G.Annotations.n$)return parseFloat(Pa)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(h.a)(Bb,"AnnotationQuery",null,[1141]);class Eb{constructor(){this.JT=this.xx=
0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}TBa(ua){if(this.next)return{returnValue:this.next,Tma:ua};if(ua){const Pa=ua.lQf;ua=ua.u6g;return{returnValue:Pa,Tma:ua}}return{returnValue:null,Tma:ua}}}Object(h.a)(Eb,"AnnotationQueryStep",null,[1178]);class tb extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){Pa=this.Ia.query.To(ua,Pa);if(G.Annotations.eB(this.xx)){var eb=G.Annotations.PBa(this.xx);let bc=new bb.a(this.Ia.annotations,eb);if(G.Annotations.eB(this.Ia.query.JT)){if(ua.items.length!==
Pa.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let oc=0,W=ua.items.length;oc<W;++oc)Array.add(bc.items,this.YBc(ua.items[oc],Pa.items[oc],eb===G.Annotations.n$))}else for(var Kb of ua.items)Array.add(bc.items,this.YBc(Kb,Pa,eb===G.Annotations.n$));return bc}if(G.Annotations.eB(this.Ia.query.JT)){Kb=new bb.a(this.Ia.annotations,this.xx);for(eb of Pa.items)Array.add(Kb.items,this.YBc(ua,eb,this.xx===G.Annotations.n$));return Kb}return this.YBc(ua,
Pa,this.xx===G.Annotations.n$)}YBc(ua,Pa,eb){ua=this.kob(ua,Pa);return eb?ua:Math.floor(ua)}}Object(h.a)(tb,"NumericAnnotationQueryStep",Eb,[]);class Yb extends tb{constructor(ua){super(ua)}kob(ua,Pa){return ua+Pa}}Object(h.a)(Yb,"AddAnnotationQueryStep",tb,[]);class Tc extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){if(this.xx===G.Annotations.Tea&&this.Ia.query.JT===G.Annotations.Tea){let bc;if(({result:bc}=this.kLf(ua)).returnValue)return bc}if(G.Annotations.eB(this.xx)){var eb=new bb.a(this.Ia.annotations,
G.Annotations.Tea);Pa=this.Ia.query.To(ua,Pa);if(G.Annotations.eB(this.Ia.query.JT)){if(ua.items.length!==Pa.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let bc=0,oc=ua.items.length;bc<oc;++bc)Array.add(eb.items,this.IVb(Pa.items[bc],ua.items[bc]))}else for(var Kb of ua.items)Array.add(eb.items,this.IVb(Pa,Kb));return eb}Kb=this.Ia.query.To(ua,Pa);if(G.Annotations.eB(this.Ia.query.JT)){Pa=new bb.a(this.Ia.annotations,G.Annotations.Tea);for(eb of Kb.items)Array.add(Pa.items,
this.IVb(eb,ua));return Pa}return this.IVb(Kb,ua)}}Object(h.a)(Tc,"BinaryBooleanAnnotationQueryStep",Eb,[]);class ib extends Tc{constructor(ua){super(ua)}kLf(ua){return{returnValue:!ua,result:!1}}IVb(ua,Pa){return ua&&Pa}}Object(h.a)(ib,"AndAnnotationQueryStep",Tc,[]);class Zb{constructor(ua){ua&&(this.annotations=ua)}}Object(h.a)(Zb,"AnnotationsOnlyQueryStepInit",null,[]);class Cc extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){Pa=this.Ia.query.To(ua,Pa);ua=ua.clone();G.Annotations.eB(this.Ia.query.JT)?
Array.addRange(ua.items,Pa.items):Array.add(ua.items,Pa);return ua}}Object(h.a)(Cc,"AppendAnnotationQueryStep",Eb,[]);class ob extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){if(this.xx===G.Annotations.UL)return this.JYb(ua,Pa);const eb=new bb.a(this.Ia.annotations,G.Annotations.UL);for(const Kb of ua.items)Array.add(eb.items,this.JYb(Kb,Pa));return eb}JYb(ua,Pa){const eb=new I.a(this.Ia.annotations);eb.lAa(ua);ua=new I.a(this.Ia.annotations);this.Ia.script.X6(null,new ja("Input",eb,new ja("Output",
ua,Pa)));return ua}}Object(h.a)(ob,"ApplyAnnotationQueryStep",Eb,[]);class cc extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){if(this.xx===G.Annotations.UL)return Pa=this.JYb(ua,Pa),Pa.Dm(this.Ia.mEf).returnValue||new bb.a(this.Ia.annotations,G.Annotations.UL),Pa;const eb=new bb.a(this.Ia.annotations,G.Annotations.UL);for(const Kb of ua.items)if(ua=this.JYb(Kb,Pa),({value:ua}=ua.Dm(this.Ia.mEf)).returnValue)for(const bc of ua.items)Array.add(eb.items,bc);return eb}JYb(ua,Pa){const eb=new I.a(this.Ia.annotations);
eb.lAa(ua);ua=new I.a(this.Ia.annotations);this.Ia.script.X6(null,new ja("Input",eb,new ja("Output",ua,Pa)));return ua}}Object(h.a)(cc,"ApplyExpandAnnotationQueryStep",Eb,[]);class sb{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.script=Pa.U5a(ua.ga(0)),this.mEf=ua.ga(1))}}Object(h.a)(sb,"ApplyExpandQueryStepInit",null,[]);class mb{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.script=Pa.U5a(ua.ga(0)))}}Object(h.a)(mb,"ApplyQueryStepInit",null,[]);class Pb extends Eb{constructor(ua){super();
this.Ia=ua}load(ua){if(this.xx===G.Annotations.UL)return this.sVc(ua);const Pa=new bb.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.Caa));for(const eb of ua.items)Array.add(Pa.items,this.sVc(eb));return Pa}store(ua,Pa,eb,Kb){if(this.xx===G.Annotations.UL){var bc=Pa,oc=({Tma:Kb}=this.TBa(Kb)).returnValue;oc&&(bc=oc.store(G.Annotations.aK(this.sVc(ua)),Pa,eb,Kb));ua.Pt(this.Ia.Caa,bc)}else{var W=Pa;if(bc=({Tma:Kb}=this.TBa(Kb)).returnValue){W=new bb.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.Caa));
for(oc of ua.items)Array.add(W.items,this.sVc(oc));W=bc.store(W,Pa,eb,Kb)}Pa=W;if(Pa.items.length!==ua.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let ta=0,da=ua.items.length;ta<da;++ta)eb=ua.items[ta],eb.isReadOnly&&(eb=eb.clone(),ua.items[ta]=eb),eb.Pt(this.Ia.Caa,Pa.items[ta])}return ua}sVc(ua){({value:ua}=ua.Dm(this.Ia.Caa)).returnValue||(ua=this.Ia.annotations.ZXi(this.Ia.Caa));return ua}}Object(h.a)(Pb,"AttrAnnotationQueryStep",Eb,[]);
class dc{constructor(ua,Pa){ua&&(this.annotations=Pa,this.Caa=ua.ga(0))}}Object(h.a)(dc,"AttrQueryStepInit",null,[]);class mc extends Eb{constructor(ua){super();this.Ia=ua}load(ua){const Pa=new I.a(this.Ia.annotations);Pa.lAa(ua);return this.Ia.module.execute(Pa)}}Object(h.a)(mc,"CallModuleAnnotationQueryStep",Eb,[]);class Mb{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.module=Pa.d_d(ua.ga(0)))}}Object(h.a)(Mb,"CallModuleQueryStepInit",null,[]);class Kc extends Eb{constructor(ua){super();
this.Ia=ua}load(ua,Pa){if(G.Annotations.eB(this.xx)){var eb=this.Ia.query.To(ua,Pa);Pa=new bb.a(this.Ia.annotations,G.Annotations.WX);let oc="string"===typeof eb;for(var Kb of ua.items)if(oc)Array.add(Pa.items,Kb+eb);else for(var bc of eb.items)Array.add(Pa.items,Kb+bc);return Pa}Kb=this.Ia.query.To(ua,Pa);if("string"===typeof Kb)return ua+Kb;bc=new bb.a(this.Ia.annotations,G.Annotations.WX);for(eb of Kb.items)Array.add(bc.items,ua+eb);return bc}}Object(h.a)(Kc,"ConcatAnnotationQueryStep",Eb,[]);
class gc extends Eb{constructor(ua){super();this.Ia=ua}load(ua){return Bb.sOf(this.Ia.annotations,ua,this.xx,this.JT)}}Object(h.a)(gc,"ConvertAnnotationQueryStep",Eb,[]);class rb extends Eb{constructor(){super()}load(ua){return ua.items.length}}Object(h.a)(rb,"CountAnnotationQueryStep",Eb,[]);class Ua extends tb{constructor(ua){super(ua)}kob(ua,Pa){return ua/Pa}}Object(h.a)(Ua,"DivideAnnotationQueryStep",tb,[]);class pb extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){Pa=new ja(this.Ia.rmd,
null,Pa);for(const eb of ua.items)if(Pa.qLd(eb),this.Ia.query.To(eb,Pa))return!0;return!1}}Object(h.a)(pb,"ExistsAnnotationQueryStep",Eb,[]);class Ub extends tb{constructor(ua){super(ua)}kob(ua,Pa){return Math.pow(ua,Pa)}}Object(h.a)(Ub,"ExpAnnotationQueryStep",tb,[]);class Bc{constructor(ua,Pa){ua&&(this.Lqa=Pa.LB(ua.ga(0)))}}Object(h.a)(Bc,"FeatureBundleNameQueryStepInit",null,[]);class Gc extends Eb{constructor(ua){super();this.Ia=ua}load(ua){if(G.Annotations.eB(this.xx)){const Pa=new bb.a(this.Ia.annotations,
this.Ia.annotations.I6a(G.Annotations.PBa(this.xx),this.Ia.Nqa));for(const eb of ua.items)Array.add(Pa.items,eb.UPa(this.Ia.Nqa));return Pa}return ua.UPa(this.Ia.Nqa)}store(ua,Pa,eb,Kb){if(G.Annotations.eB(this.xx)){var bc=Pa,oc=({Tma:Kb}=this.TBa(Kb)).returnValue;if(oc){bc=new bb.a(this.Ia.annotations,this.Ia.annotations.I6a(G.Annotations.PBa(this.xx),this.Ia.Nqa));for(var W of ua.items)Array.add(bc.items,W.UPa(this.Ia.Nqa));bc=oc.store(bc,Pa,eb,Kb)}Pa=bc;if(Pa.items.length!==ua.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let ta=0,da=ua.items.length;ta<da;++ta)eb=ua.items[ta],eb.isReadOnly&&(eb=eb.clone(),ua.items[ta]=eb),eb.cIe(this.Ia.Nqa,Pa.items[ta])}else oc=Pa,(W=({Tma:Kb}=this.TBa(Kb)).returnValue)&&(oc=W.store(G.Annotations.aK(ua.UPa(this.Ia.Nqa)),Pa,eb,Kb)),ua.cIe(this.Ia.Nqa,oc);return ua}}Object(h.a)(Gc,"FieldAnnotationQueryStep",Eb,[]);class qd{constructor(ua,Pa){ua&&(this.annotations=Pa,this.Nqa=ua.ga(0))}}Object(h.a)(qd,"FieldQueryStepInit",null,[]);class Td extends Eb{constructor(ua){super();this.Ia=
ua}load(ua,Pa){for(const eb of ua.items)if(this.Ia.filter.isMatch(eb,Pa))return eb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(ua,Pa,eb,Kb){let bc=Pa,oc=-1;for(let ta=0,da=ua.items.length;ta<da;ta++)if(this.Ia.filter.isMatch(ua.items[ta],eb)){oc=ta;break}if(0>oc)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const W=({Tma:Kb}=this.TBa(Kb)).returnValue;W&&(bc=W.store(G.Annotations.aK(ua.items[oc]),Pa,eb,Kb));ua.items[oc]=
bc;return ua}}Object(h.a)(Td,"FirstItemMatchingAnnotationQueryStep",Eb,[]);class Vd extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){Pa=new ja(this.Ia.rmd,null,Pa);for(const eb of ua.items)if(Pa.qLd(eb),!this.Ia.query.To(eb,Pa))return!1;return!0}}Object(h.a)(Vd,"ForAllAnnotationQueryStep",Eb,[]);class Be extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){ua=Pa?Pa.zLc(this.Ia.Lqa):null;if(!ua)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Lqa+'"');return ua}store(ua,
Pa,eb,Kb){ua=eb?eb.zLc(this.Ia.Lqa):null;if(!ua)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Lqa+'"');let bc=Pa;const oc=({Tma:Kb}=this.TBa(Kb)).returnValue;oc&&(bc=oc.store(ua,Pa,eb,Kb));ua!==bc&&ua.lAa(bc);return ua}}Object(h.a)(Be,"GetAnnotationQueryStep",Eb,[]);class Id{constructor(ua,Pa){this.nJh=ua;this.pSh=Pa}get lQf(){return this.nJh}get u6g(){return this.pSh}}Object(h.a)(Id,"AnnotationQueryStoreContinuation",null,[1188]);class gb extends Eb{constructor(ua){super();
this.Ia=ua}load(ua,Pa){return this.Ia.qjd.To(ua,Pa)?this.Ia.Gxh.To(ua,Pa):this.Ia.GIc?this.Ia.GIc.To(ua,Pa):ua}store(ua,Pa,eb,Kb){var bc=this.Ia.qjd.To(ua,eb);this.next&&(Kb=new Id(this.next,Kb));if(bc)return this.Ia.Gxh.zHb(ua,Pa,eb,Kb);if(this.Ia.GIc)return this.Ia.GIc.zHb(ua,Pa,eb,Kb);bc=Pa;let oc=null;Kb&&(oc=Kb.lQf,Kb=Kb.u6g);oc&&(bc=oc.store(G.Annotations.aK(ua),Pa,eb,Kb));return bc}}Object(h.a)(gb,"IfAnnotationQueryStep",Eb,[]);class Xb{constructor(ua,Pa){ua&&(this.qjd=Pa.gD(ua.ga(0)),this.Gxh=
Pa.gD(ua.ga(1)),this.GIc=ua.ga(2)?Pa.gD(ua.ga(2)):null)}}Object(h.a)(Xb,"IfQueryStepInit",null,[]);class Ic{constructor(ua,Pa){ua&&(this.jvj=Pa.gD(ua.ga(0)),this.qyg=Pa.gD(ua.ga(1)))}}Object(h.a)(Ic,"IndexAndItemQueryStepInit",null,[]);class Wc extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){const eb=this.Ia.jvj.To(ua,Pa);Pa=this.Ia.qyg.To(ua,Pa);ua=ua.clone();if(0>eb||eb>ua.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(G.Annotations.eB(this.Ia.qyg.JT))for(let Kb=
0;Kb<Pa.items.length;++Kb)Array.insert(ua.items,eb+Kb,Pa.items[Kb]);else Array.insert(ua.items,eb,Pa);return ua}}Object(h.a)(Wc,"InsertAtAnnotationQueryStep",Eb,[]);class Ib extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){return!(!Pa||!Pa.zLc(this.Ia.Lqa))}}Object(h.a)(Ib,"IsDefinedAnnotationQueryStep",Eb,[]);class ec extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){Pa=this.esb(ua,Pa);return ua.items[Pa]}store(ua,Pa,eb,Kb){const bc=this.esb(ua,eb);let oc=Pa;const W=({Tma:Kb}=this.TBa(Kb)).returnValue;
W&&(oc=W.store(G.Annotations.aK(ua.items[bc]),Pa,eb,Kb));ua.items[bc]=oc;return ua}esb(ua,Pa){Pa=this.Ia.query.To(ua,Pa);if(0>Pa||Pa>=ua.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Pa}}Object(h.a)(ec,"ItemAnnotationQueryStep",Eb,[]);class Jb extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){const eb=new bb.a(this.Ia.annotations,G.Annotations.PBa(this.xx));for(const Kb of ua.items)this.Ia.filter.isMatch(Kb,Pa)&&Array.add(eb.items,Kb);return eb}}
Object(h.a)(Jb,"ItemsMatchingAnnotationQueryStep",Eb,[]);class hb extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){Pa=this.esb(ua,Pa);return ua.items[ua.items.length-Pa-1]}store(ua,Pa,eb,Kb){const bc=this.esb(ua,eb);let oc=Pa;const W=({Tma:Kb}=this.TBa(Kb)).returnValue;W&&(oc=W.store(G.Annotations.aK(ua.items[ua.items.length-bc-1]),Pa,eb,Kb));ua.items[ua.items.length-bc-1]=oc;return ua}esb(ua,Pa){Pa=this.Ia.query?this.Ia.query.To(ua,Pa):0;if(0>Pa||Pa>=ua.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Pa}}Object(h.a)(hb,"LastItemAnnotationQueryStep",Eb,[]);class Rc extends Eb{constructor(ua){super();this.Ia=ua}load(ua){if(G.Annotations.eB(this.xx)){const Pa=new bb.a(this.Ia.annotations,G.Annotations.cna);for(const eb of ua.items)Array.add(Pa.items,eb.length);return Pa}return ua.length}}Object(h.a)(Rc,"LengthAnnotationQueryStep",Eb,[]);class gd extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){if(G.Annotations.eB(this.xx)){const eb=new bb.a(this.Ia.annotations,G.Annotations.Tea);
for(const Kb of ua.items)Array.add(eb.items,this.Ia.filter.isMatch(Kb,Pa));return eb}return this.Ia.filter.isMatch(ua,Pa)}}Object(h.a)(gd,"MatchesAnnotationQueryStep",Eb,[]);class hd extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){return this.Ia.filter.isMatch(ua,Pa)}}Object(h.a)(hd,"MatchesAsListAnnotationQueryStep",Eb,[]);class Hd extends tb{constructor(ua){super(ua)}kob(ua,Pa){return ua%Pa}}Object(h.a)(Hd,"ModuloAnnotationQueryStep",tb,[]);class Xd extends tb{constructor(ua){super(ua)}kob(ua,
Pa){return ua*Pa}}Object(h.a)(Xd,"MultiplyAnnotationQueryStep",tb,[]);class id extends Eb{constructor(ua){super();this.Ia=ua}load(ua){if(G.Annotations.eB(this.xx)){const Pa=new bb.a(this.Ia.annotations,G.Annotations.Tea);for(const eb of ua.items)Array.add(Pa.items,!eb);return Pa}return!ua}}Object(h.a)(id,"NotAnnotationQueryStep",Eb,[]);class fd extends Tc{constructor(ua){super(ua)}kLf(ua){return{returnValue:ua,result:!0}}IVb(ua,Pa){return ua||Pa}}Object(h.a)(fd,"OrAnnotationQueryStep",Tc,[]);class Vf extends Eb{constructor(ua){super();
this.Ia=ua}load(ua,Pa){const eb=this.Ia.gNe.To(ua,Pa);ua=this.Ia.gWb.To(ua,Pa);Pa=new bb.a(this.Ia.annotations,G.Annotations.cna);for(let Kb=0;Kb<ua;++Kb)Array.add(Pa.items,eb+Kb);return Pa}}Object(h.a)(Vf,"RangeAnnotationQueryStep",Eb,[]);class Qd{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.filter=Pa.k7(ua.ga(0)))}}Object(h.a)(Qd,"SingleFilterQueryStepInit",null,[]);class Zf{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.query=ua.ga(0)?Pa.gD(ua.ga(0)):null)}}Object(h.a)(Zf,
"SingleOptionalQueryQueryStepInit",null,[]);class Ge{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.query=Pa.gD(ua.ga(0)))}}Object(h.a)(Ge,"SingleQueryQueryStepInit",null,[]);class le{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.gNe=Pa.gD(ua.ga(0)),this.gWb=ua.ga(1)?Pa.gD(ua.ga(1)):null)}}Object(h.a)(le,"StartAndCountOrLengthQueryStepInit",null,[]);class Sa extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){let eb;({GIa:Pa,length:eb}=this.qNc(ua,Pa));const Kb=
new bb.a(this.Ia.annotations,ua.vT);for(let bc=0;bc<eb;++bc)Array.add(Kb.items,ua.items[Pa+bc]);return Kb}store(ua,Pa,eb,Kb){let bc,oc;({GIa:bc,length:oc}=this.qNc(ua,eb));var W=Pa;const ta=({Tma:Kb}=this.TBa(Kb)).returnValue;if(ta){W=new bb.a(this.Ia.annotations,ua.vT);for(let da=0;da<oc;++da)Array.add(W.items,ua.items[bc+da]);W=ta.store(W,Pa,eb,Kb)}Pa=W;for(eb=0;eb<oc;++eb)Array.removeAt(ua.items,bc);for(let da=0,Ea=Pa.items.length;da<Ea;++da)Array.insert(ua.items,bc+da,Pa.items[da]);return ua}qNc(ua,
Pa){let eb;eb=this.Ia.gNe.To(ua,Pa);if(0>eb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Pa=this.Ia.gWb?this.Ia.gWb.To(ua,Pa):ua.items.length-eb;if(0>Pa||eb+Pa>ua.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{GIa:eb,length:Pa}}}Object(h.a)(Sa,"SublistAnnotationQueryStep",Eb,[]);class Cb extends Eb{constructor(ua){super();this.Ia=ua}load(ua,Pa){if(G.Annotations.eB(this.xx)){const eb=new bb.a(this.Ia.annotations,
G.Annotations.WX);for(let Kb=0,bc=ua.items.length;Kb<bc;++Kb)Array.add(eb.items,this.getSubstring(ua.items[Kb],Pa));return eb}return this.getSubstring(ua,Pa)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(ua,Pa){let eb;({GIa:Pa,length:eb}=this.qNc(ua,Pa));return ua.substr(Pa,eb)}qNc(ua,Pa){let eb;eb=this.Ia.gNe.To(ua,Pa);if(0>eb)throw Error.invalidOperation("Invalid start index in Substring() query step");Pa=this.Ia.gWb?this.Ia.gWb.To(ua,Pa):
ua.length-eb;if(0>Pa||eb+Pa>ua.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{GIa:eb,length:Pa}}}Object(h.a)(Cb,"SubstringAnnotationQueryStep",Eb,[]);class rc extends tb{constructor(ua){super(ua)}kob(ua,Pa){return ua-Pa}}Object(h.a)(rc,"SubtractAnnotationQueryStep",tb,[]);class bd extends Eb{constructor(ua){super();this.Ia=ua}load(ua){const Pa=new bb.a(this.Ia.annotations,G.Annotations.WX);for(let eb=0;eb<ua.length;++eb)Array.add(Pa.items,
ua.charAt(eb).toString());return Pa}}Object(h.a)(bd,"ToCharListAnnotationQueryStep",Eb,[]);class pd extends Eb{constructor(ua){super();this.Ia=ua}load(ua){const Pa=new bb.a(this.Ia.annotations,this.xx);Array.add(Pa.items,ua);return Pa}}Object(h.a)(pd,"ToListAnnotationQueryStep",Eb,[]);class Oa extends Eb{constructor(ua){super();this.Ia=ua}load(){return this.Ia.value}}Object(h.a)(Oa,"ValueAnnotationQueryStep",Eb,[]);class jb{constructor(ua,Pa){if(ua){var eb=ua.ga(0),Kb=1;this.value=({C2:Kb}=Pa.mqa(eb,
ua,Kb,null,null,null)).returnValue;G.Annotations.l9a(this.value)}}}Object(h.a)(jb,"ValueQueryStepInit",null,[]);class nc{constructor(ua,Pa){ua&&(this.rmd=Pa.LB(ua.ga(0)),this.query=Pa.gD(ua.ga(1)))}}Object(h.a)(nc,"VarNameAndQueryQueryStepInit",null,[]);class kb{constructor(ua,Pa){this.i2e=null;if(ua){this.annotations=Pa.annotations;var eb=0;this.xx=ua.ga(eb);++eb;this.JT=ua.ga(eb);++eb;this.yid=1===ua.ga(eb);++eb;this.rRc=1===ua.ga(eb);++eb;var Kb=ua.ga(eb);++eb;if(Kb){var bc=eb,oc=eb+Kb,W=eb+2*
Kb;eb+=3*Kb;var ta=ua.count-eb,da=null;for(let $a=0;$a<Kb;++$a){var Ea=eb+ua.ga(W+$a);const fb=($a===Kb-1?ta:ua.ga(W+$a+1))-ua.ga(W+$a),qc=new Ya.a;qc.zPa(ua,Ea,fb);Ea=kb.P7i(ua.ga(oc+$a),qc,Pa);Ea.xx=ua.ga(bc+$a);Ea.JT=$a===Kb-1?this.JT:ua.ga(bc+$a+1);da?da.next=Ea:this.i2e=Ea;da=Ea}}}}get I3f(){return this.i2e}static P7i(ua,Pa,eb){switch(ua){case 1:return new Be(new Bc(Pa,eb));case 2:return new Ib(new Bc(Pa,eb));case 3:return new Pb(new dc(Pa,eb.annotations));case 4:return new Gc(new qd(Pa,eb.annotations));
case 5:return new gb(new Xb(Pa,eb));case 6:return new gd(new Qd(Pa,eb));case 43:return new hd(new Qd(Pa,eb));case 45:return new ob(new mb(Pa,eb));case 49:return new cc(new sb(Pa,eb));case 46:return new Oa(new jb(Pa,eb.annotations));case 51:return new mc(new Mb(Pa,eb));case 52:return new Vf(new le(Pa,eb));case 53:return new gc(new Zb(eb.annotations));case 13:return new ec(new Ge(Pa,eb));case 14:return new hb(new Zf(Pa,eb));case 15:return new rb;case 18:return new Td(new Qd(Pa,eb));case 16:return new Vd(new nc(Pa,
eb));case 17:return new pb(new nc(Pa,eb));case 22:return new Wc(new Ic(Pa,eb));case 24:return new Cc(new Ge(Pa,eb));case 26:return new Sa(new le(Pa,eb));case 27:return new Jb(new Qd(Pa,eb));case 30:return new pd(new Zb(eb.annotations));case 31:return new Cb(new le(Pa,eb));case 32:return new Kc(new Ge(Pa,eb));case 47:return new Rc(new Zb(eb.annotations));case 48:return new bd(new Zb(eb.annotations));case 34:return new Yb(new Ge(Pa,eb));case 35:return new rc(new Ge(Pa,eb));case 36:return new Xd(new Ge(Pa,
eb));case 37:return new Ua(new Ge(Pa,eb));case 38:return new Hd(new Ge(Pa,eb));case 39:return new Ub(new Ge(Pa,eb));case 40:return new ib(new Ge(Pa,eb));case 41:return new fd(new Ge(Pa,eb));case 42:return new id(new Zb(eb.annotations));default:throw Error.argument("currStepInitData");}}}Object(h.a)(kb,"AnnotationQueryInit",null,[]);class Gb{constructor(ua){this.Ia=ua}execute(ua,Pa){this.X6(ua,ua?new ja("root",ua,Pa):Pa)}X6(ua,Pa){for(const eb of this.Ia.commands)Pa=eb.execute(ua,Pa)}}Object(h.a)(Gb,
"AnnotationScript",null,[1140]);class tc{constructor(ua){this.Ia=ua}execute(ua,Pa){const eb=this.Ia.Syj.To(ua,Pa),Kb=this.Ia.rrk.To(ua,Pa);this.Ia.script.X6(ua,new ja("Input",eb,new ja("Output",Kb,Pa)));return Pa}}Object(h.a)(tc,"ApplyAnnotationScriptCommand",null,[1171]);class dd{constructor(ua,Pa){ua&&(this.Syj=Pa.gD(ua.ga(0)),this.rrk=Pa.gD(ua.ga(1)),this.script=Pa.U5a(ua.ga(2)))}}Object(h.a)(dd,"ApplyScriptCommandInit",null,[]);class $c{constructor(ua){this.Ia=ua}execute(ua,Pa){const eb=this.Ia.SFe.To(ua,
Pa);this.Ia.NVc.zHb(ua,eb,Pa,null);return Pa}}Object(h.a)($c,"AssignAnnotationScriptCommand",null,[1171]);class Pc{constructor(ua){this.Ia=ua}execute(ua,Pa){const eb=this.Ia.NVc.To(ua,Pa);ua=this.Ia.SFe.To(ua,Pa);eb!==ua&&eb.lAa(ua);return Pa}}Object(h.a)(Pc,"CopyAnnotationScriptCommand",null,[1171]);class Ad{constructor(ua){this.Ia=ua}execute(ua,Pa){let eb=this.Ia.Jbe.To(ua,Pa);if(this.Ia.Jbe.yid){eb=G.Annotations.aK(eb);var Kb=new ja(this.Ia.Lqa,null,Pa);for(let oc=0,W=eb.items.length;oc<W;++oc){var bc=
this.k0f(ua,eb.items[oc],Kb);if(0>this.Ia.ndd)eb.items[oc]=bc;else if(({value:bc}=bc.Dm(this.Ia.ndd)).returnValue)eb.items[oc]=bc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ia.Jbe.zHb(ua,eb,Pa,null)}else{Kb=new ja(this.Ia.Lqa,null,Pa);for(let oc=0,W=eb.items.length;oc<W;++oc)this.k0f(ua,eb.items[oc],Kb)}return Pa}k0f(ua,Pa,eb){let Kb;0>this.Ia.ndd?Kb=G.Annotations.aK(Pa):(Kb=new I.a(this.Ia.annotations),Kb.Pt(this.Ia.ndd,Pa));eb.qLd(Kb);
this.Ia.aci.X6(ua,eb);return Kb}}Object(h.a)(Ad,"EnumerateAnnotationScriptCommand",null,[1171]);class Ee{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.Lqa=Pa.LB(ua.ga(0)),this.Jbe=Pa.gD(ua.ga(1)),this.aci=Pa.U5a(ua.ga(2)),this.ndd=ua.ga(3))}}Object(h.a)(Ee,"EnumerateScriptCommandInit",null,[]);class Ce{constructor(ua){this.Ia=ua}execute(ua,Pa){this.Ia.qjd.To(ua,Pa)?this.Ia.Yol.X6(ua,Pa):this.Ia.V1f&&this.Ia.V1f.X6(ua,Pa);return Pa}}Object(h.a)(Ce,"IfAnnotationScriptCommand",null,[1171]);
class Fb{constructor(ua,Pa){ua&&(this.qjd=Pa.gD(ua.ga(0)),this.Yol=Pa.U5a(ua.ga(1)),this.V1f=ua.ga(2)?Pa.U5a(ua.ga(2)):null)}}Object(h.a)(Fb,"IfScriptCommandInit",null,[]);class $e{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.NVc=Pa.gD(ua.ga(0)),this.SFe=Pa.gD(ua.ga(1)))}}Object(h.a)($e,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class bg{constructor(ua){this.Ia=ua}execute(ua,Pa){const eb=this.Ia.SFe.To(this.Ia.NVc.To(ua,Pa),Pa);this.Ia.NVc.zHb(ua,eb,Pa,null);return Pa}}Object(h.a)(bg,
"ModifyAnnotationScriptCommand",null,[1171]);class Ye{constructor(ua){this.Ia=ua}execute(ua,Pa){const eb=new I.a(this.Ia.annotations);this.Ia.query&&eb.lAa(this.Ia.query.To(ua,Pa));return Pa=new ja(this.Ia.Lqa,eb,Pa)}}Object(h.a)(Ye,"NewAnnotationScriptCommand",null,[1171]);class Ae{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.Lqa=Pa.LB(ua.ga(0)),this.query=ua.ga(1)?Pa.gD(ua.ga(1)):null)}}Object(h.a)(Ae,"NewScriptCommandInit",null,[]);class si{constructor(ua){this.Ia=ua}execute(ua,
Pa){ua=this.Ia.query.To(ua,Pa);if(this.Ia.query.JT===G.Annotations.UL)ua.mcd(this.Ia.Caa);else for(const eb of ua.items)eb.mcd(this.Ia.Caa);return Pa}}Object(h.a)(si,"RemoveAnnotationScriptCommand",null,[1171]);class Jf{constructor(ua,Pa){ua&&(this.annotations=Pa.annotations,this.query=Pa.gD(ua.ga(0)),this.Caa=ua.ga(1))}}Object(h.a)(Jf,"RemoveScriptCommandInit",null,[]);class tg{constructor(ua,Pa){if(ua){var eb=0,Kb=ua.ga(eb);++eb;if(Kb){var bc=eb,oc=eb+Kb;eb+=2*Kb;var W=ua.count-eb;this.commands=
Array(Kb);for(let ta=0;ta<Kb;++ta){const da=eb+ua.ga(oc+ta),Ea=(ta===Kb-1?W:ua.ga(oc+ta+1))-ua.ga(oc+ta),$a=new Ya.a;$a.zPa(ua,da,Ea);this.commands[ta]=tg.L7i(ua.ga(bc+ta),$a,Pa)}}}}static L7i(ua,Pa,eb){switch(ua){case 1:return new $c(new $e(Pa,eb));case 2:return new bg(new $e(Pa,eb));case 3:return new si(new Jf(Pa,eb));case 6:return new Ye(new Ae(Pa,eb));case 7:return new Ad(new Ee(Pa,eb));case 8:return new Ce(new Fb(Pa,eb));case 9:return new Pc(new $e(Pa,eb));case 10:return new tc(new dd(Pa,eb));
default:throw Error.argument("initData");}}}Object(h.a)(tg,"AnnotationScriptInit",null,[]);var Dg=d(687);class Vg{constructor(ua){this.mH=ua;this.gM=0}qX(){const ua=this.mH.Ot(this.gM,4);this.gM+=4;return ua}get BTb(){return this.mH}get offset(){return this.gM}set offset(ua){this.gM=ua}}Object(h.a)(Vg,"ByteArrayReader",null,[]);class Ih{constructor(){this.RB=null;this.sHg=this.Fy=0}ga(ua){if(0>ua||ua>=this.Fy)throw Error.argumentOutOfRange("index");return this.RB.Ot(this.sHg+4*ua,4)}get count(){return this.Fy}static exi(ua,
Pa,eb){const Kb=new Ih;Kb.RB=ua;Kb.sHg=Pa;Kb.Fy=eb;return Kb}}Object(h.a)(Ih,"ReadOnlyListOverByteArray",null,[1122]);class hf{constructor(ua,Pa){this.UFg=this.CFg=!1;this.lr=this.yua=this.ide=this.eGg=null;try{this.lr=Pa.annotations;const eb=Pa.IPa(ua.ga(0)),Kb=new Vg(eb);if(-914743053!==Kb.qX())throw Error.argument("Input does not represent a flat lexicon");this.CFg=1===Kb.qX();this.UFg=1===Kb.qX();const bc=Kb.qX();Kb.offset+=bc;const oc=Kb.qX();this.ide=hf.Psk(Kb,oc,this.lr);const W=Kb.qX();this.eGg=
hf.atk(Kb,W);const ta=Kb.qX();this.yua=new Dg.a(Kb.BTb,Kb.offset);Kb.offset+=ta}catch(eb){throw Error.argument("initData");}}get trie(){return this.yua}ZYi(ua){return"i"===ua&&this.UFg?"\u0130":ua.toUpperCase()}E7d(){return this.CFg}DXi(ua){let Pa;Pa=new bb.a(this.lr,G.Annotations.UL);if(1!==ua)if(0===ua)ua=new I.a(this.lr),Array.add(Pa.items,ua);else if(ua&1073741824){ua=this.eGg[ua&-1073741825];for(let Kb=0;Kb<ua.length;++Kb){var eb=ua[Kb];eb=0===eb?new I.a(this.lr):this.ide[eb-2];Array.add(Pa.items,
eb)}}else Array.add(Pa.items,this.ide[ua-2]);return{returnValue:!0,BSj:Pa}}static Psk(ua,Pa,eb){if(Pa%4)throw Error.argument("reader");const Kb=Ih.exi(ua.BTb,ua.offset,Pa/4);ua.offset+=Pa;ua=[];for(Pa=0;Pa<Kb.count;){const bc=({C2:Pa}=eb.mqa(G.Annotations.UL,Kb,Pa,null,null,null)).returnValue;Array.add(ua,bc)}return ua}static atk(ua,Pa){Pa=ua.offset+Pa;const eb=[];for(;ua.offset<Pa;){const Kb=ua.qX(),bc=Array(Kb);for(let oc=0;oc<Kb;++oc){const W=ua.qX();bc[oc]=W}Array.add(eb,bc)}return eb}}Object(h.a)(hf,
"RawFlatLexicon",null,[1137]);var ld=d(677),ph=d(678);class Kf{constructor(ua){if(null==ua)throw Error.argumentNull("base64String");const Pa=ua.length;if(Pa%4)throw Error.argument("base64String's length must be a multiple of 4");this.Fy=.75*Pa;this.Ysa=Array(Math.ceil(this.Fy/4));ua.endsWith("==")?this.Fy-=2:ua.endsWith("=")&&--this.Fy;let eb=0;for(let Kb=0;Kb<Pa;Kb+=4){const bc=Kf.ded[ua.charCodeAt(Kb)-43]<<18|Kf.ded[ua.charCodeAt(Kb+1)-43]<<12|Kf.ded[ua.charCodeAt(Kb+2)-43]<<6|Kf.ded[ua.charCodeAt(Kb+
3)-43];let oc=bc>>16&255;this.Ysa[Math.floor(eb/4)]|=oc<<eb%4*8;++eb;oc=bc>>8&255;this.Ysa[Math.floor(eb/4)]|=oc<<eb%4*8;++eb;oc=bc&255;this.Ysa[Math.floor(eb/4)]|=oc<<eb%4*8;++eb}}get length(){return this.Fy}ga(ua){if(0>ua||ua>=this.Fy)throw Error.argumentOutOfRange("i");return this.S6f(ua)}Ot(ua,Pa){if(0>ua||0>Pa||ua+Pa>this.Fy)throw Error.argument("Bad range");let eb=0;for(let Kb=0;Kb<Pa;++Kb)eb|=this.S6f(ua+Kb)<<8*Kb;return eb}KHk(ua,Pa){let eb=0,Kb=0,bc=Math.floor(ua/8);for(ua%=8;Kb<Pa;){const oc=
8-ua>Pa-Kb?Pa-Kb:8-ua,W=this.ga(bc);eb|=(W>>ua&~(255<<oc))<<Kb;Kb+=oc;++bc;ua=0}return eb}S6f(ua){return this.Ysa[Math.floor(ua/4)]>>ua%4*8&255}}Kf.ded=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(h.a)(Kf,"ByteArray",null,[]);class Ud{constructor(ua,Pa,eb){this.Lx=ua;this.H0j=Pa;this.b5j=eb;this.UHg=Array(ua.b?ua.b.length:
0);this.Qpe=new ld.a(new ph.a(this.IPa(this.Lx.s)));this.vW=Array(ua.t.length);this.cHh=new G.Annotations(this.FPa(0),this)}get annotations(){return this.cHh}get iIi(){return this.Lx.d}r7i(){if(!(""in this.Lx.m))throw Error.argument("name","Unrecognized module");return this.d_d(this.Lx.m[""])}IPa(ua){if(0>ua||!this.Lx.b||ua>=this.Lx.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.UHg[ua]||(this.UHg[ua]=new Kf(this.Lx.b[ua]))}LB(ua){if(1>ua||ua>=this.Lx.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.Lx.t[ua])throw Error.argument("blobID","Requested blob is not a string");if(null==this.vW[ua]){const Pa=this.FPa(ua).ga(0);this.vW[ua]=this.Qpe.LB(Pa)}return this.vW[ua]}pcg(ua){if(1>ua||ua>=this.Lx.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.Lx.t[ua])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.vW[ua]){var Pa=this.FPa(ua);const eb=this.LB(Pa.ga(0));Pa=1===Pa.ga(1);this.vW[ua]=new RegExp(eb,Pa?"i":"")}return this.vW[ua]}Waj(ua){if(1>ua||ua>=
this.Lx.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.Lx.t[ua])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}d_d(ua){if(1>ua||ua>=this.Lx.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.Lx.t[ua])throw Error.argument("blobID","Requested blob is not an NL module");return this.vW[ua]||(this.vW[ua]=this.b5j.G7i(this.FPa(ua),this))}gD(ua){if(1>ua||ua>=this.Lx.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.Lx.t[ua])throw Error.argument("blobID",
"Requested blob is not an annotation query");return this.vW[ua]||(this.vW[ua]=new Bb(new kb(this.FPa(ua),this)))}U5a(ua){if(1>ua||ua>=this.Lx.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.Lx.t[ua])throw Error.argument("blobID","Requested blob is not an annotation script");return this.vW[ua]||(this.vW[ua]=new Gb(new tg(this.FPa(ua),this)))}k7(ua){if(1>ua||ua>=this.Lx.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.Lx.t[ua])throw Error.argument("blobID","Requested blob is not a filter");
return this.vW[ua]||(this.vW[ua]=this.H0j.k7(this.FPa(ua),this))}F$i(ua){if(1>ua||ua>=this.Lx.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.Lx.t[ua])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.vW[ua]||(this.vW[ua]=new hf(this.FPa(ua),this))}FPa(ua){const Pa=this.Lx.n[ua];ua=(ua<this.Lx.t.length-1?this.Lx.n[ua+1]:this.Lx.n.length)-Pa;if(0>Pa||0>ua||Pa+ua>this.Lx.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+
Pa+","+ua+")");const eb=new Ya.a;eb.WJc(this.Lx.n,Pa,ua);return eb}}Object(h.a)(Ud,"ObjectFetcher",null,[1098]);class He{constructor(ua,Pa,eb){if(!ua)throw Error.argumentNull("prediction");if(!Pa)throw Error.argumentNull("fieldNames");if(!eb)throw Error.argumentNull("values");if(Pa.length!==eb.length)throw Error.argument("values","fieldNames and values do not have same length");this.fSh=ua;this.r$a=Pa;this.Ubb=eb}get prediction(){return this.fSh}get g2f(){return this.r$a.length}yYd(ua){return 0<=
ua&&ua<this.r$a.length?this.r$a[ua]:null}getValue(ua){return 0<=ua&&ua<this.Ubb.length?this.Ubb[ua]:null}}Object(h.a)(He,"PredictionData",null,[]);class Bh{constructor(ua,Pa){if(!ua)throw Error.argumentNull("predictions");if(!Pa)throw Error.argumentNull("tokenAttributes");this.u6j=ua;this.J9j=Pa}P_d(){return this.u6j}g6f(){return this.J9j}}Object(h.a)(Bh,"PredictionDataWithTokenAttributes",null,[]);class eg{constructor(ua,Pa){this.prediction=null;this.score=0;this.prediction=ua;this.score=Pa}}Object(h.a)(eg,
"PredictionWithScore",null,[]);class jd{constructor(ua,Pa){if(!ua)throw Error.argumentNull("predictions");if(!Pa)throw Error.argumentNull("attributes");this.gSh=ua;this.zHh=Pa}P_d(){return this.gSh}g6f(){return this.zHh}}Object(h.a)(jd,"PredictionsWithTokenAttributes",null,[]);class Jh{constructor(ua,Pa,eb){if(!ua)throw Error.argumentNull("attributeName");if(!Pa)throw Error.argumentNull("fieldNames");if(!eb)throw Error.argumentNull("values");if(Pa.length!==eb.length)throw Error.argument("values",
"fieldNames and values do not have same length");this.yHh=ua;this.r$a=Pa;this.Ubb=eb}get attributeName(){return this.yHh}get g2f(){return this.r$a.length}yYd(ua){return 0<=ua&&ua<this.r$a.length?this.r$a[ua]:null}getValue(ua){return 0<=ua&&ua<this.Ubb.length?this.Ubb[ua]:null}}Object(h.a)(Jh,"TokenAttributes",null,[]);var kf=d(13),Ji=d(21);class hh{constructor(ua,Pa,eb,Kb,bc){this.hoc=0;this.zUe=null;this.ioc=this.XJb=0;this.Wmd=this.Vhb=this.y$=this.YJb=null;this.AUe=0;this.V0a=this.$x=null;this._state=
-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.pJ=ua;this.LEh=this.QEh=Pa;this.KEh=this.NEh=eb;this.coc=this.MEh=Kb;this.eoc=this.OEh=bc}Tmd(){this.ioc=0;return this.WJb}WJb(){if(!(this.ioc<this.coc))return this.goc;this.YJb=this.LEh.items[this.ioc+this.KEh];this.y$=new I.a(this.pJ.Ia.annotations);1!==this.coc&&this.pJ.Ia.j3b||this.y$.lAa(this.YJb);if(0<=this.pJ.Ia.C5c){({value:this.Vhb}=this.y$.Dm(this.pJ.Ia.C5c)).returnValue?this.Vhb=
this.Vhb.aK():this.Vhb=new bb.a(this.pJ.Ia.annotations,G.Annotations.UL);this.Wmd=this.eoc.items;this.AUe=this.Wmd.length;for(this.hoc=0;this.hoc<this.AUe;++this.hoc)this.zUe=this.Wmd[this.hoc],Array.add(this.Vhb.items,this.zUe);this.y$.Pt(this.pJ.Ia.C5c,this.Vhb)}else 0<=this.pJ.Ia.qMe?this.y$.Pt(this.pJ.Ia.qMe,this.eoc.items[0]):0<=this.pJ.Ia.CJd?this.y$.Pt(this.pJ.Ia.CJd,!0):this.pJ.Ia.fvg?this.eoc.items[0].EJc((ua,Pa)=>this.y$.Pt(ua,Pa)):(this.y$.lAa(this.eoc.items[0]),1!==this.coc&&this.pJ.Ia.j3b||
(({value:this.XJb}=this.YJb.Dm(this.pJ.Ia.MR)).returnValue&&this.y$.Pt(this.pJ.Ia.MR,this.XJb),({value:this.XJb}=this.YJb.Dm(this.pJ.Ia.ZU)).returnValue&&this.y$.Pt(this.pJ.Ia.ZU,this.XJb),this.YJb.Dm(this.pJ.Ia.eNa).returnValue&&this.y$.Pt(this.pJ.Ia.eNa,this.XJb)));this.$x=this.y$;this._state=2;return this.Vmd}goc(){this._state=3}Umd(){this.ioc++;return this.WJb}Vmd(){return 1<this.coc&&this.pJ.Ia.j3b?this.goc:this.Umd}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new hh(this.pJ,
this.QEh,this.NEh,this.MEh,this.OEh)).getEnumerator()}[Symbol.iterator](){return Object(Ji.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.V0a=this.Tmd());for(;1===this._state;)this.V0a=this.V0a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.$x}}Object(h.a)(hh,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[106,143,145]);class Wb{constructor(ua,Pa,eb){this.x8b=this.tHg=0;this.Wwb=null;this.$pe=this.Vde=this.Jwb=this.mXc=this.Yee=0;this.jYc=!1;this.ume=ua;this.qqe=Pa;this.P5j=eb}Pag(){null===this.Wwb&&({Nvh:this.Wwb,ykg:this.Yee,length:this.mXc,AOi:ua}=this.ume.Xeg(this.qqe.items[this.x8b],this.P5j),this.jYc=ua||this.jYc);if(this.Jwb<this.mXc){var ua=this.Wwb.charAt(this.Yee+this.Jwb);++this.Jwb;return{returnValue:!0,ch:ua}}if(this.x8b===this.qqe.items.length-1)return{returnValue:!1,ch:"\x00"};
++this.x8b;this.Jwb=0;this.Wwb=null;return{returnValue:!0,ch:" "}}fDe(ua,Pa){this.Jwb===this.mXc&&this.Wwb&&(this.$pe=Pa,this.Vde=this.x8b-this.tHg+1)}NTk(ua){if(0>ua||ua>=this.qqe.items.length)throw Error.argumentOutOfRange("iToken");this.x8b=this.tHg=ua;this.Wwb=null;this.Vde=this.Jwb=this.mXc=this.Yee=0;this.$pe=-1;this.jYc=!1}D6i(){return{qfi:this.Vde,YQj:this.$pe,nOi:this.jYc}}}Object(h.a)(Wb,"TriePrefixVisitor",null,[1142]);class Uc{constructor(ua){this.Ia=ua}execute(ua){if(!({value:eb}=ua.Dm(this.Ia.Epa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Pa;({value:Pa}=ua.Dm(this.Ia.Lza)).returnValue||(Pa=null);var eb=this.kXi(eb,Pa);ua=G.Annotations.aK(ua);ua.Pt(this.Ia.Epa,eb);return ua}kXi(ua,Pa){let eb=null;const Kb=this.Ia.flatLexicon.trie,bc=new Wb(this,ua,Pa);let oc=null;this.Ia.flatLexicon.E7d()&&(oc=Object(kf.a)(this.Ia.flatLexicon,this.Ia.flatLexicon.ZYi,"getCaseInsensitiveForm"));let W=0,ta;var da;let Ea;for(;W<ua.items.length;){const $a=ua.items[W];bc.NTk(W);Kb.KDh(bc,oc);({qfi:ta,YQj:da,nOi:Ea}=bc.D6i());if(0<ta){({BSj:da}=this.Ia.flatLexicon.DXi(da));
for(let fb of this.Cyi(ua,W,ta,da)){1<ta&&this.Ia.j3b&&this.hzi(ua,Pa,W,$a,ta,Ea,fb);if(!eb)for(eb=new bb.a(this.Ia.annotations,G.Annotations.UL),da=0;da<W;++da)Array.add(eb.items,ua.items[da]);Array.add(eb.items,fb)}W+=ta}else eb&&Array.add(eb.items,$a),++W}return eb||ua}hzi(ua,Pa,eb,Kb,bc,oc,W){if(oc)oc=!0;else if(this.Ia.Mug){oc=!1;var ta=-1;for(var da=0;da<bc;da++){var Ea=ua.items[eb+da];let Hc;var $a=void 0;if(!({value:Hc}=Ea.Dm(this.Ia.MR)).returnValue||!({value:$a}=Ea.Dm(this.Ia.ZU)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<da){if(Hc>ta+1){oc=!0;break}if(0>ta||null===Pa||ta>=Pa.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Pa.charAt(ta)){oc=!0;break}}ta=Hc+$a}}else oc=!1;if(oc){$a=new Sys.StringBuilder;for(oc=0;oc<bc;++oc)({Nvh:ta,ykg:da,length:Ea}=this.Xeg(ua.items[eb+oc],Pa)),0<oc&&$a.append(" "),$a.append(ta.substr(da,Ea));W.Pt(this.Ia.eNa,$a.toString())}ua=ua.items[eb+bc-1];let fb,qc;({value:Kb}=Kb.Dm(this.Ia.MR)).returnValue&&
({value:fb}=ua.Dm(this.Ia.MR)).returnValue&&({value:qc}=ua.Dm(this.Ia.ZU)).returnValue?(W.Pt(this.Ia.MR,Kb),W.Pt(this.Ia.ZU,fb+qc-Kb)):(W.mcd(this.Ia.MR),W.mcd(this.Ia.ZU))}Cyi(ua,Pa,eb,Kb){return new hh(this,ua,Pa,eb,Kb)}Xeg(ua,Pa){let eb,Kb;if(({value:eb}=ua.Dm(this.Ia.eNa)).returnValue)Kb=!0,Pa=0,ua=eb.length;else{Kb=!1;if(null===Pa)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");eb=Pa;if(!({value:Pa}=ua.Dm(this.Ia.MR)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:ua}=ua.Dm(this.Ia.ZU)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Pa||0>ua||Pa+ua>eb.length)throw Error.argument("Token start/length values out of range","token");}return{Nvh:eb,ykg:Pa,length:ua,AOi:Kb}}}Object(h.a)(Uc,"FlatLexiconNLModule",null,[1123]);class Sc{constructor(ua,Pa){this.CJd=this.C5c=this.qMe=this.eNa=this.ZU=this.MR=this.Lza=this.Epa=0;this.fvg=this.Mug=this.j3b=!1;this.flatLexicon=null;this.annotations=Pa.annotations;
let eb=0;try{this.Epa=ua.ga(eb),++eb,this.Lza=ua.ga(eb),++eb,this.MR=ua.ga(eb),++eb,this.ZU=ua.ga(eb),++eb,this.eNa=ua.ga(eb),++eb,this.qMe=ua.ga(eb),++eb,this.C5c=ua.ga(eb),++eb,this.CJd=ua.ga(eb),++eb,this.j3b=1===ua.ga(eb),++eb,this.Mug=1===ua.ga(eb),++eb,this.fvg=1===ua.ga(eb),++eb,this.flatLexicon=Pa.F$i(ua.ga(eb))}catch(Kb){throw Error.argument("initData");}}}Object(h.a)(Sc,"FlatLexiconNLModuleInit",null,[]);class Od{constructor(){this.i2b=0;this.XUd=null;this.Tic=0}}Object(h.a)(Od,"FeatureGenStackRec",
null,[]);class ug{constructor(ua){this.gQe=Array(ua);this.AIb=Array(ua);this.uNe=[];this.hth=[]}}Object(h.a)(ug,"TokenStringLattice",null,[]);const te=(ua,Pa,eb)=>{for(let Kb=0;Kb<ua.length;Kb++)eb=Pa(eb,ua[Kb]);return eb},mf=(ua,Pa)=>{const eb=Array(ua.length);for(let Kb=0;Kb<ua.length;Kb++)eb[Kb]=Pa(ua[Kb]);return eb},Yf=(ua,Pa)=>{Pa=Array(Math.min(Pa,ua.length));for(let eb=0;eb<Pa.length;eb++)Pa[eb]=ua[eb];return Pa},Jd=(ua,Pa)=>{const eb=[];for(const Kb of ua)Pa(Kb)&&Array.add(eb,Kb);return eb};
class ce{constructor(ua,Pa){this.key=ua;this.value=Pa}}Object(h.a)(ce,"KeyValuePair",null,[]);const fe=(ua,Pa)=>({returnValue:Pa in ua,value:ua[Pa]}),Gg=ua=>{const Pa=[];for(let eb in ua){const Kb=new ce(eb,ua[eb]);Array.add(Pa,Kb)}return Pa};class Me{constructor(ua){this.Weg=this.Ofj;this.Ia=ua;this.k0c=this.jme=this.kme=0;for(const Pa of this.Ia.IIc)this.kme=Math.max(this.kme,Pa.fze),this.jme=Math.max(this.jme,Pa.Gye),this.k0c=Math.max(this.k0c,Pa.nHb.length)}get MQi(){return this.Ia.ekd.trie}execute(ua){if(!ua)throw Error.argumentNull("input");
let Pa,eb;({tokens:Pa,BRj:eb}=this.Pfj(ua));let Kb=null,bc=null,oc={};if(this.Ia.B3b){Pa=G.Annotations.aK(Pa);for(var W=0;W<Pa.items.length;++W)Pa.items[W]=G.Annotations.aK(Pa.items[W])}else({$1f:bc,returnValue:Kb}=this.obg(ua,oc));W=Array(this.k0c);const ta=Array(this.k0c);for(var da=0;da<ta.length;++da)ta[da]=new Od;for(da=-this.kme;da<Pa.items.length+this.jme;++da){let Ea=null;this.Ia.B3b&&(Ea=Pa.items[da],oc={},{$1f:bc,returnValue:Kb}=this.obg(Ea,oc));for(const $a of this.Ia.IIc){if(0>da&&-da>
$a.fze||da>=Pa.items.length&&da-Pa.items.length+1>$a.Gye)continue;let fb=!0;for(let qc=0;qc<$a.nHb.length;++qc){const Hc=da+$a.nHb[qc];W[qc]=Hc;if(0>Hc?0>this.Ia.gze:Hc>=Pa.items.length?0>this.Ia.Hye:!eb.AIb[Hc]){fb=!1;break}}fb&&({iCi:Kb,jCi:bc}=this.aAj($a,eb,Kb,bc,oc,ta,W))}this.Ia.B3b&&(Ea.Pt(this.Ia.WCa?this.Ia.Dnb:this.Ia.Bnb,Kb),this.Ia.WCa&&Ea.Pt(this.Ia.Cnb,bc))}ua=G.Annotations.aK(ua);this.Ia.B3b?ua.Pt(this.Ia.Epa,Pa):(ua.Pt(this.Ia.WCa?this.Ia.Dnb:this.Ia.Bnb,Kb),this.Ia.WCa&&ua.Pt(this.Ia.Cnb,
bc));return ua}Pfj(ua){let Pa,eb;if(!ua||!({value:Pa}=ua.Dm(this.Ia.Epa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Kb;({value:Kb}=ua.Dm(this.Ia.Lza)).returnValue||(Kb="");eb=new ug(Pa.items.length);const bc=Jd(this.Ia.kQe,oc=>!oc.B2b||oc.B2b.isMatch(ua,null));for(let oc=0;oc<Pa.items.length;++oc){const W=Pa.items[oc];let ta=null;eb.gQe[oc]=eb.uNe.length;let da=eb.AIb[oc]=0;for(const Ea of bc)0<Ea.Fbc&&eb.AIb[oc]+da>=Ea.Fbc||Ea.ymc&&!Ea.ymc.isMatch(W,
null)||({zmc:ta,jUb:da}=Ea.apply(this,W,oc,eb,Kb,ta,da))}return{tokens:Pa,BRj:eb}}aAj(ua,Pa,eb,Kb,bc,oc,W){let ta=0;oc[0].i2b=-1;for(oc[0].XUd=ua.wgh;;){var da=W[ta],Ea=0>da||da>=Pa.AIb.length?1:Pa.AIb[da];let qc=!1;for(;oc[ta].i2b<Ea-1;){++oc[ta].i2b;var $a=void 0,fb=void 0;0>da?($a=this.Ia.gze,fb=1):da>=Pa.gQe.length?($a=this.Ia.Hye,fb=1):(fb=Pa.gQe[da]+oc[ta].i2b,$a=Pa.uNe[fb],fb=Pa.hth[fb]);oc[ta].Tic=fb*(ta?oc[ta-1].Tic:ua.score);if(({value:$a}=fe(oc[ta].XUd,$a.toString())).returnValue){ta===
ua.nHb.length-1?(da=$a,oc[ta].Tic&&(({value:Ea}=fe(bc,da.toString())).returnValue||(Ea=-1),0>Ea&&(eb=G.Annotations.aK(eb),Array.add(eb.items,da)),this.Ia.WCa&&(Kb=G.Annotations.aK(Kb),0>Ea?Array.add(Kb.items,oc[ta].Tic):Kb.items[Ea]+=oc[ta].Tic),0>Ea&&(this.Ia.Uxg||this.Ia.WCa)&&(bc[da.toString()]=eb.items.length-1))):(++ta,oc[ta].i2b=-1,oc[ta].XUd=$a);qc=!0;break}}if(!qc&&(--ta,0>ta))break}return{iCi:eb,jCi:Kb}}obg(ua,Pa){let eb;if(({value:eb}=ua.Dm(this.Ia.WCa?this.Ia.Dnb:this.Ia.Bnb)).returnValue)for(let Kb=
0;Kb<eb.items.length;++Kb)Pa[eb.items[Kb].toString()]=Kb;else eb=new bb.a(this.Ia.annotations,G.Annotations.cna);if(this.Ia.WCa){if(({value:Pa}=ua.Dm(this.Ia.Cnb)).returnValue||(Pa=new bb.a(this.Ia.annotations,G.Annotations.n$)),Pa.items.length!==eb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ia.annotations.D0(G.Annotations.UL,ua));}else Pa=null;return{returnValue:eb,$1f:Pa}}get Xml(){return this.Ia.ekd}Ofj(ua,
Pa){var eb;if(({value:eb}=Pa.Dm(this.Ia.eNa)).returnValue)ua=eb;else{if(!({value:eb}=Pa.Dm(this.Ia.MR)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Pa}=Pa.Dm(this.Ia.ZU)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>eb||0>Pa||eb+Pa>ua.length)throw Error.argument("Token indices are out of range");ua=ua.substr(eb,Pa)}return ua}}Object(h.a)(Me,"NGramNLModule",null,[1123,1124]);class se{constructor(ua){this.nHb=null;this.score=this.Gye=this.fze=
0;this.wgh=null;if(ua){var Pa=0;try{if(ua.ga(Pa)!==se.o3a)throw Error.argument("initData","Input does not represent a feature template");++Pa;const eb=ua.ga(Pa);++Pa;this.nHb=Array(eb);for(let Kb=0;Kb<eb;++Kb)this.nHb[Kb]=ua.ga(Pa),++Pa;this.fze=ua.ga(Pa);++Pa;this.Gye=ua.ga(Pa);++Pa;this.score=ua.ga(Pa);++Pa;this.wgh=({vkg:Pa}=se.N$g(ua,Pa)).returnValue}catch(eb){throw Error.argument("initData");}}}static N$g(ua,Pa){const eb=ua.ga(Pa);++Pa;const Kb={};for(let bc=0;bc<eb;++bc){const oc=ua.ga(Pa);
++Pa;ua.ga(Pa)?Kb[oc.toString()]=({vkg:Pa}=se.N$g(ua,Pa)).returnValue:(++Pa,Kb[oc.toString()]=ua.ga(Pa),++Pa)}return{returnValue:Kb,vkg:Pa}}}se.o3a=240803228;Object(h.a)(se,"FeatureTemplate",null,[1161]);var Pf=d(536);class yg{constructor(ua,Pa){this.WCa=this.Uxg=this.B3b=!1;this.eNa=this.ZU=this.MR=this.Epa=this.Lza=this.Cnb=this.Dnb=this.Bnb=0;this.ekd=null;this.Hye=this.gze=0;this.IIc=this.kQe=null;if(ua){this.annotations=Pa.annotations;var eb=0;try{this.B3b=1===ua.ga(eb);++eb;this.Uxg=1===ua.ga(eb);
++eb;this.WCa=1===ua.ga(eb);++eb;this.Bnb=ua.ga(eb);++eb;this.Dnb=ua.ga(eb);++eb;this.Cnb=ua.ga(eb);++eb;this.Lza=ua.ga(eb);++eb;this.Epa=ua.ga(eb);++eb;this.MR=ua.ga(eb);++eb;this.ZU=ua.ga(eb);++eb;this.eNa=ua.ga(eb);++eb;this.ekd=this.wtk(Pa.IPa(ua.ga(eb)));++eb;this.gze=ua.ga(eb);++eb;this.Hye=ua.ga(eb);++eb;const Kb=ua.ga(eb);++eb;this.kQe=Array(Kb);for(let oc=0;oc<Kb;++oc){const W=ua.ga(eb);++eb;const ta=this.ekd.trie,da=new Ya.a;da.zPa(ua,eb,W);this.kQe[oc]=this.Atk(da,Pa,ta);eb+=W}const bc=
ua.ga(eb);++eb;this.IIc=Array(bc);for(Pa=0;Pa<bc;++Pa){const oc=ua.ga(eb);++eb;const W=new Ya.a;W.zPa(ua,eb,oc);this.IIc[Pa]=this.btk(W);eb+=oc}}catch(Kb){throw Error.argument("initData");}}}wtk(ua){return new ld.a(new ph.a(ua))}Atk(ua,Pa,eb){return Pf.a.create(ua,Pa,eb)}btk(ua){return new se(ua)}}Object(h.a)(yg,"NGramNLModuleInit",null,[]);class qe{constructor(ua){this.Ia=ua}execute(ua){if(!ua)throw Error.argumentNull("input");ua=ua.clone();this.Ia.script.execute(ua,null);return ua}}Object(h.a)(qe,
"ScriptNLModule",null,[1123]);class yd{constructor(ua,Pa){ua&&(this.script=Pa.U5a(ua.ga(0)))}}Object(h.a)(yd,"ScriptNLModuleInit",null,[]);const zf=ua=>{ua=mf(ua,Pa=>Pa*Pa);return Math.sqrt(te(ua,(Pa,eb)=>Pa+eb,0))},xd=ua=>te(ua,(Pa,eb)=>Pa>eb?Pa:eb,ua[0]);class fg{constructor(ua){this.Ia=ua}execute(ua){if(!ua)throw Error.argumentNull("input");var Pa=[],eb=[];this.Ioi(ua,Pa,eb);this.u6h(Pa,eb);const Kb={};for(let oc=0;oc<Pa.length;++oc){var bc=Pa[oc];const W=this.Ia.Vpg.ga(bc);bc=this.Ia.Wpg.ga(bc);
for(let ta=0;ta<bc;++ta){const da=this.Ia.Uli.ga(this.Ia.PMf.ga(W+ta)),Ea=this.Ia.QMf.ga(W+ta);let $a;({value:$a}=fe(Kb,da)).returnValue||($a=0);Kb[da]=$a+eb[oc]*Ea}}eb=Gg(Kb);eb.sort((oc,W)=>{var ta=oc.value,da=W.value;(ta=-(ta>da?1:ta<da?-1:0))||(ta=oc.key.localeCompare(W.key));return ta});Pa=new bb.a(this.Ia.annotations,G.Annotations.UL);for(const oc of Yf(eb,this.Ia.rbk))eb=new I.a(this.Ia.annotations),eb.Pt(this.Ia.dai,oc.key),eb.Pt(this.Ia.fai,oc.value),Array.add(Pa.items,eb);ua.Pt(this.Ia.eai,
Pa);return ua}Ioi(ua,Pa,eb){if(({value:ua}=ua.Dm(this.Ia.cai)).returnValue){let Kb;if(({value:Kb}=ua.Dm(this.Ia.Dnb)).returnValue){let bc;if(!({value:bc}=ua.Dm(this.Ia.Cnb)).returnValue||Kb.items.length!==bc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.wDc(Kb,bc,Pa,eb)}if(({value:Kb}=ua.Dm(this.Ia.hai)).returnValue){let bc;if(!({value:bc}=ua.Dm(this.Ia.iai)).returnValue||Kb.items.length!==bc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.wDc(Kb,bc,Pa,eb)}({value:Kb}=ua.Dm(this.Ia.Bnb)).returnValue&&this.wDc(Kb,null,Pa,eb);({value:Kb}=ua.Dm(this.Ia.gai)).returnValue&&this.wDc(Kb,null,Pa,eb)}}wDc(ua,Pa,eb,Kb){for(let oc=0;oc<ua.items.length;++oc){var bc=void 0;ua.vT===G.Annotations.WX?({value:bc}=fe(this.Ia.mYf,ua.items[oc])).returnValue||(bc=-1):(bc=ua.items[oc],bc=bc>=this.Ia.Vre&&bc<=this.Ia.Lbk?this.Ia.fte?this.Ia.fte.ga(bc-this.Ia.Vre)-1:bc-this.Ia.Vre:-1);if(0<=bc){let W;W=Pa?Pa.items[oc]:1;0<W&&(Array.add(eb,bc),Array.add(Kb,
W))}}}u6h(ua,Pa){if(ua.length){switch(this.Ia.BCk){case 0:break;case 1:for(var eb=0;eb<Pa.length;++eb)Pa[eb]=1+Math.log(Pa[eb]);break;case 2:eb=xd(Pa);for(let Kb=0;Kb<Pa.length;++Kb)Pa[Kb]=.5+Pa[Kb]/eb*.5;break;case 3:for(eb=0;eb<Pa.length;++eb)Pa[eb]=1;break;default:throw Error.notImplemented();}if(this.Ia.KQc)for(eb=0;eb<Pa.length;++eb)Pa[eb]*=this.Ia.KQc.ga(ua[eb]);ua=zf(Pa);for(eb=0;eb<Pa.length;++eb)Pa[eb]/=ua}}}Object(h.a)(fg,"TfIdfRankerNLModule",null,[1123]);class Ki{constructor(ua,Pa=0){if(!ua)throw Error.argumentNull("byteArray");
this.CI=Pa;if(604662927!==ua.Ot(this.CI+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Gk=ua.Ot(this.CI+4,4);this.UCg=ua.Ot(this.CI+8,4);this.GZj=ua}ga(ua){if(0>ua||ua>=this.count)throw Error.argumentOutOfRange("index");return this.GZj.KHk(8*this.CI+96+ua*this.UCg,this.UCg)}get count(){return this.Gk}}Object(h.a)(Ki,"CompactIntArray",null,[1122]);const jg=(ua,Pa)=>{Pa=Array(Pa);for(let oc=0;oc<Pa.length;oc++){var eb=oc,Kb=ua.qX(),bc=1===(Kb>>31&1)?-1:1;
const W=Kb&8388607;Kb=Kb>>23&255;256===Kb+1?bc=W?Number.NaN:1===bc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Kb?(Kb-=127,bc=bc*Ch(W,1)*Math.pow(2,Kb)):bc=bc*Ch(W,0)*Math.pow(2,-126);Pa[eb]=bc}return Pa},Ch=(ua,Pa)=>{let eb=0;for(let Kb=0;23>Kb;Kb++)eb+=(ua>>22-Kb&1)/Math.pow(2,Kb+1);return Pa+eb};class ih{constructor(ua,Pa){this.fte=null;this.uVg=0;this.Wpg=this.Vpg=this.KQc=null;this.tVg=0;this.QMf=this.PMf=null;this.annotations=Pa.annotations;let eb=0;this.gai=ua.ga(eb);++eb;this.Bnb=ua.ga(eb);
++eb;this.hai=ua.ga(eb);++eb;this.iai=ua.ga(eb);++eb;this.Dnb=ua.ga(eb);++eb;this.Cnb=ua.ga(eb);++eb;this.cai=ua.ga(eb);++eb;this.eai=ua.ga(eb);++eb;this.dai=ua.ga(eb);++eb;this.fai=ua.ga(eb);++eb;var Kb=ua.ga(eb);++eb;var bc=Array(Kb);for(var oc=0;oc<Kb;++oc)bc[oc]=Pa.LB(ua.ga(eb)),++eb;this.Uli=Ya.a.hPd(bc);this.rbk=ua.ga(eb);++eb;this.BCk=ua.ga(eb);++eb;Kb=ua.ga(eb);++eb;this.mYf={};for(bc=0;bc<Kb;++bc){oc=Pa.LB(ua.ga(eb));++eb;const W=ua.ga(eb);++eb;this.mYf[oc]=W}this.Vre=ua.ga(eb);++eb;this.Lbk=
ua.ga(eb);++eb;Kb=ua.ga(eb);++eb;0<Kb&&(Kb=Pa.IPa(ua.ga(eb)),++eb,this.fte=this.i9c(new Vg(Kb)));++eb;ua=Pa.IPa(ua.ga(eb));this.mtk(ua)}i9c(ua){return new Ki(ua.BTb,ua.offset)}mtk(ua){try{const Pa=new Vg(ua);this.uVg=Pa.qX();1===Pa.qX()?this.KQc=Ya.a.hPd(jg(Pa,this.uVg)):this.KQc=null;const eb=Pa.qX();this.Vpg=this.i9c(Pa);Pa.offset+=eb;const Kb=Pa.qX();this.Wpg=this.i9c(Pa);Pa.offset+=Kb;this.tVg=Pa.qX();const bc=Pa.qX();this.PMf=this.i9c(Pa);Pa.offset+=bc;this.QMf=Ya.a.hPd(jg(Pa,this.tVg))}catch(Pa){throw Error.argument("byteReader");
}}}Object(h.a)(ih,"TfIdfRankerNLModuleInit",null,[]);class qh{constructor(ua,Pa,eb,Kb){this.sxe=ua;this.u3f=eb;this.tokens=Kb;this.N6=Pa;this.GFb=-1;this.Sed=0}}Object(h.a)(qh,"TokenizerData",null,[]);class Md{constructor(ua){this.Ia=ua}execute(ua){if(!ua)throw Error.argumentNull("input");if(!({value:Kb}=ua.Dm(this.Ia.Lza)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Pa;({value:Pa}=ua.Dm(this.Ia.MR)).returnValue||(Pa=0);let eb;({value:eb}=
ua.Dm(this.Ia.ZU)).returnValue||(eb=Kb.length-Pa);if(0>Pa||Pa>Kb.length)throw Error.argument("input","Start index out of range");if(0>eb||eb>Kb.length)throw Error.argument("input","Length out of range");if(Pa+eb>Kb.length)throw Error.argument("input","Bad start-length range");var Kb=new qh(Kb,Pa,Pa+eb,new bb.a(this.Ia.annotations,G.Annotations.UL));this.Yml(Kb);ua=ua.isReadOnly?ua.clone():ua;ua.Pt(this.Ia.Epa,Kb.tokens);return ua}Yml(ua){for(;ua.N6<ua.u3f;){if(this.Ia.u2d){var Pa=this.Ia.u2d.DBg(ua.sxe,
ua.N6,ua.u3f-ua.N6,null);!Pa.succeeded&&Pa.FUg&&(Pa=Pa.FUg);if(Pa.succeeded){this.zZg(ua,Pa.length,this.Ia.ygg);ua.N6+=Pa.length;continue}}Pa=ua.sxe.substr(ua.N6);let eb=-1,Kb=-1,bc=-1;for(let oc=0;oc<this.Ia.Wdd.length;++oc){const W=this.Ia.Wdd[oc].exec(Pa);W&&0<W[1].length&&(0>eb||W[0].length>Kb)&&(eb=oc,Kb=W[0].length,bc=W[1].length)}0<=eb?(this.zZg(ua,bc,this.Ia.JFe[eb]),ua.N6+=bc):ua.N6+=1}}zZg(ua,Pa,eb){if(this.Ia.Cwg)eb!==Md.Vgi&&(0>ua.GFb&&(ua.GFb=ua.N6),ua.Sed=ua.N6+Pa-ua.GFb,eb===Md.Ugi&&
(0<=ua.GFb&&0<ua.Sed&&(Pa=new I.a(this.Ia.annotations),Pa.Pt(this.Ia.MR,ua.GFb),Pa.Pt(this.Ia.ZU,ua.Sed),Pa.Pt(this.Ia.MId,Md.Wgi),Pa.Pt(this.Ia.Lza,ua.sxe),Array.add(ua.tokens.items,Pa)),ua.GFb=-1,ua.Sed=0));else{let Kb=new I.a(this.Ia.annotations);Kb.Pt(this.Ia.MR,ua.N6);Kb.Pt(this.Ia.ZU,Pa);Kb.Pt(this.Ia.MId,eb);Array.add(ua.tokens.items,Kb)}}}Md.Vgi="GAP";Md.Ugi="EOS_CHUNK";Md.Wgi="SENTENCE";Object(h.a)(Md,"TokenizerNLModule",null,[1123]);class Ed{constructor(ua,Pa){this.ZU=this.MR=this.MId=this.Epa=
this.Lza=0;this.Cwg=!1;this.JFe=this.Wdd=this.ygg=this.u2d=null;if(ua){this.annotations=Pa.annotations;var eb=0;try{this.Lza=ua.ga(eb);++eb;this.Epa=ua.ga(eb);++eb;this.MId=ua.ga(eb);++eb;this.MR=ua.ga(eb);++eb;this.ZU=ua.ga(eb);++eb;this.Cwg=1===ua.ga(eb);++eb;var Kb=ua.ga(eb);++eb;0<Kb&&(this.u2d=Pa.d_d(Kb).MQi);this.ygg=ua.ga(eb)?Pa.LB(ua.ga(eb)):"";++eb;const bc=ua.ga(eb);++eb;this.Wdd=Array(bc);this.JFe=Array(bc);for(Kb=0;Kb<bc;++Kb)this.Wdd[Kb]=new RegExp(Pa.LB(ua.ga(eb))),++eb,this.JFe[Kb]=
Pa.LB(ua.ga(eb)),++eb}catch(bc){throw Error.argument("initData");}}}}Object(h.a)(Ed,"TokenizerNLModuleInit",null,[]);class Bd{constructor(ua){this.Ia=ua}execute(ua){if(!ua)throw Error.argumentNull("input");let Pa;if(!({value:Pa}=ua.Dm(this.Ia.RGf)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const eb of this.Ia.ZMe)Pa=eb.apply(Pa);ua=G.Annotations.aK(ua);ua.Pt(this.Ia.SGf,Pa);return ua}static kId(ua,Pa){const eb=new Sys.StringBuilder;for(let Kb=
0;Kb<ua.length;++Kb)eb.append(Pa(ua.substr(Kb,1)));return eb.toString()}}Object(h.a)(Bd,"TransliteratorNLModule",null,[1123]);class Xh{constructor(ua){ua&&(this.style=ua.ga(0))}apply(ua){return Bd.kId(ua,Pa=>Xh.Kji(Pa,this.style))}static Kji(ua,Pa){switch(Pa){case 0:return ua.toLowerCase();case 1:return"I"===ua?"\u0131":ua.toLowerCase();case 2:return ua.toUpperCase();case 3:return"i"===ua?"\u0130":ua.toUpperCase();default:throw Error.invalidOperation();}}}Xh.q3a=0;Object(h.a)(Xh,"ChangeCaseTransliterationStage",
null,[1139]);class $f{apply(ua){return Bd.kId(ua,$f.Nnl)}static Nnl(ua){const Pa=ua.charCodeAt(0);return 65281<=Pa&&65374>=Pa?String.fromCharCode(Pa-65248):ua}}$f.q3a=4;Object(h.a)($f,"LatinFullWidthToHalfWidthTransliterationStage",null,[1139]);class Vi{constructor(ua,Pa){ua&&(this.regex=Pa.pcg(ua.ga(0)),this.$Rk=Pa.LB(ua.ga(1)))}apply(ua){return ua.replace(this.regex,this.$Rk)}}Vi.q3a=1;Object(h.a)(Vi,"RegexReplaceTransliterationStage",null,[1139]);class ci{constructor(ua,Pa){if(ua){var eb=ua.ga(0),
Kb=Pa.LB(ua.ga(1)),bc=new Ki(Pa.IPa(ua.ga(2)));ua=0>ua.ga(3)?null:new Ki(Pa.IPa(ua.ga(3)));this.PNe={};for(Pa=0;Pa<eb;++Pa)this.PNe[Kb.charAt(Pa).toString()]=Kb.substr(bc.ga(Pa),ua?ua.ga(Pa):1)}}apply(ua){return Bd.kId(ua,Pa=>Pa in this.PNe?this.PNe[Pa]:Pa)}}ci.q3a=2;Object(h.a)(ci,"SingleCharSubstitutionsTransliterationStage",null,[1139]);class Bi{constructor(ua,Pa){this.SGf=this.RGf=0;this.ZMe=null;if(ua){this.annotations=Pa.annotations;var eb=0;try{this.RGf=ua.ga(eb);++eb;this.SGf=ua.ga(eb);++eb;
const Kb=ua.ga(eb);++eb;this.ZMe=Array(Kb);for(let bc=0;bc<Kb;++bc){const oc=ua.ga(eb);++eb;const W=ua.ga(eb);++eb;const ta=new Ya.a;ta.zPa(ua,eb,W);eb+=W;this.ZMe[bc]=this.vtk(oc,ta,Pa)}}catch(Kb){throw Error.argument("initData");}}}vtk(ua,Pa,eb){switch(ua){case Xh.q3a:return new Xh(Pa);case Vi.q3a:return new Vi(Pa,eb);case ci.q3a:return new ci(Pa,eb);case $f.q3a:return new $f;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(h.a)(Bi,"TransliteratorNLModuleInit",
null,[]);class bh{G7i(ua,Pa){const eb=ua.ga(0),Kb=new Ya.a;Kb.zPa(ua,1,ua.count-1);switch(eb){case 0:return new qe(new yd(Kb,Pa));case 2:return new Md(new Ed(Kb,Pa));case 3:return new Me(new yg(Kb,Pa));case 5:return new Uc(new Sc(Kb,Pa));case 9:return new Bd(new Bi(Kb,Pa));case 10:return new fg(new ih(Kb,Pa));default:throw Error.notImplemented();}}}Object(h.a)(bh,"NLModuleFactory",null,[1100]);class Wg{constructor(ua){this.Qgi=";";if(!ua)throw Error.argumentNull("resource");this.B3=new Ud(ua,new Qb,
new bh);this.ume=this.B3.r7i();this.KCg=this.B3.annotations.VZb("Text.Text");this.ICg=this.B3.annotations.VZb("Classification.Predictions");this.zde=this.B3.annotations.VZb("Classification.PredictionString");this.JCg=this.B3.annotations.VZb("Classification.Probability");this.oZj=this.B3.annotations.VZb("NLMod.Tokens");if(0>this.KCg||0>this.ICg||0>this.zde||0>this.JCg)throw Error.argument("resourceObj","Resource does not represent a ranker");}rYi(){const ua=[];this.MTd(void 0,this.I6f(ua),null);return ua}tYi(ua,
Pa){const eb=[],Kb=[];this.MTd(ua,this.I6f(eb),(bc,oc)=>{const W=this.B3.annotations.v6f(bc),ta=[],da=[];Pa&&Pa.length&&-1===Array.indexOf(Pa,W)||(bc=this.B3.annotations.getAttributeType(bc),this.V4g(bc,oc,ta,da),oc=new Jh(W,ta,da),Array.add(Kb,oc))});return new jd(eb,Kb)}sYi(ua){const Pa=[];this.MTd(ua,eb=>{let Kb;if(({value:Kb}=eb.Dm(this.zde)).returnValue){let bc;({value:bc}=eb.Dm(this.JCg)).returnValue&&Array.add(Pa,new eg(Kb,bc))}},null);return Pa}MTd(ua,Pa,eb){var Kb=new I.a(this.B3.annotations);
Kb.Pt(this.KCg,ua);ua=this.ume.execute(Kb);if(({value:Kb}=ua.Dm(this.ICg)).returnValue)for(const bc of Kb.items)Pa(bc);if(eb&&({value:Pa}=ua.Dm(this.oZj)).returnValue)for(const bc of Pa.items)bc.EJc(eb)}V4g(ua,Pa,eb,Kb){if(G.Annotations.eB(ua))for(var bc of Pa.items)this.V4g(Pa.vT,bc,eb,Kb);else if(G.Annotations.jzh(ua)){bc=this.B3.annotations.abg(ua);for(let oc=0;oc<bc;oc++)Array.add(eb,this.B3.annotations.Xdg(ua,oc)),Array.add(Kb,this.B3.annotations.D0(this.B3.annotations.I6a(ua,oc),Pa.UPa(oc)))}else Array.add(eb,
"VALUE"),Array.add(Kb,this.B3.annotations.D0(ua,Pa))}I6f(ua){return Pa=>{let eb;({value:eb}=Pa.Dm(this.zde)).returnValue&&Array.add(ua,this.V9i(eb))}}V9i(ua){const Pa=ua.indexOf(this.Qgi);return 0>Pa?ua:ua.substring(0,Pa)}}Object(h.a)(Wg,"Ranker",null,[]);var jf=d(325),kg=d(372),vh=d(158),nd=d(118),Oe=d(104),ti=d(25);class Kh{constructor(ua,Pa){this.Ybf="";this.Pzd=null;this.Qzd=!1;this.C$=null;this.BHh=["TellMe.TellMeParamCollection"];this.rb=ua;this.zya=Pa;this.rb.Y2a&&(this.C$=null)}get Fad(){if(!this.Pzd&&
!this.Qzd){let ua=null;try{ua=window.TellMeModel}catch(Pa){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("QueryRanker","TellMeModel not found. Exception: "+Pa)}if(ua){try{this.Pzd=new Wg(ua)}catch(Pa){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Pa)}this.Qzd=!0}else if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("QueryRanker","Classifier model not found")}return this.Pzd}nG(){return"Command"}yP(){return 0===
this.rb.fr?0:1===this.rb.fr?1:2}qD(ua,Pa,eb=!1,Kb=e.a.tellMe,bc=null){const oc=new y.a(ua);if((!bc||Array.contains(bc,0))&&!Oe.a.cN(ua)){if(!this.Fad&&this.Qzd){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.rb.Y2a&&this.C$&&this.C$.initialize();if(jf.CommandResultsUtility.N7d(ua.Ff)&&(bc=jf.CommandResultsUtility.L7f(ua.Ff),0<bc.results.length)){bc.displayName=
"Classifier Debug";oc.us(bc);Pa.resultsUpdated(oc);return}bc=ua?this.Ybf=ua.Ff:this.Ybf;if(ti.AFrameworkApplication.fa.ka("TellMeParameterizedQueriesEnabled")){bc=this.X9i(bc);var W=this.SKc(bc.P_d());bc=bc.g6f()}else bc=this.W9i(bc),W=this.f_i(bc),bc=[];jf.CommandResultsUtility.AVc(W,!1,"Classifier","TFIDF");W=jf.CommandResultsUtility.TMc(ua,W,this.rb,this.C$,this.zya,bc,0,1);0<W.results.length&&Kb!==e.a.contextMenu&&(W.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);eb||W.results.length||
this.rb.JCa||this.rb.Bwa||(ua=new vh.a("lookupNoResults",14,ua.Ff,null,1),W.Fv(ua));0<W.results.length&&oc.us(W);oc.attributes=bc}Pa.resultsUpdated(oc)}P_d(){let ua=[];try{ua=this.Fad.rYi()}catch(Pa){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("GetPredictions","Exception: "+Pa)}return ua}W9i(ua){let Pa=[];try{Pa=this.Fad.sYi(ua)}catch(eb){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("GetPredictionsWithScore","Exception: "+eb)}return Pa}X9i(ua){try{return this.Fad.tYi(ua,
this.BHh)}catch(Pa){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("GetPredictionsWithTokenAttributes","Exception: "+Pa)}return new jd([],[])}SKc(ua){const Pa=[];if(ua)for(const eb of ua)Pa.push(new kg.a(eb,-99999));return Pa}f_i(ua){const Pa=[];if(ua)for(const eb of ua)Pa.push(new kg.a(eb.prediction,eb.score));return Pa}}Object(h.a)(Kh,"CommandResultsProvider",null,[968]);var Rd=d(950);class Bj{constructor(ua){this.rb=ua}nG(){return"Feedback"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?
1:2}qD(ua,Pa,eb,Kb,bc=null){ua=new y.a(ua);if(!bc||Array.contains(bc,21))bc=[],bc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(bc),bc=new w.a(22),bc.displayName="",bc.Fv(new vh.a("TellMeFeedback",23,null,null,1)),ua.us(bc);Pa.resultsUpdated(ua)}}Object(h.a)(Bj,"FeedbackResultsProvider",null,[968]);class ui{constructor(ua,Pa,eb,Kb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=ua;this.CommandId=
Pa;this.CommandValueId=eb;this.InputText=Kb}}Object(h.a)(ui,"FindInDocumentProp",null,[]);var Na=d(440),qb=d(45);class wb{constructor(ua){this.Swd=2;this.S0a=[];this.yLa=[];this.rb=ua;wb.Pha=ua.J2f;wb.O2f="FindInDocumentSuggestion";wb.g4g="FindInDocumentSuggestion3";this.cPh=Object.assign(new Na.a,{landingTab:"Indoc",data:null});this.yUh=this.rb.RGb||!!ti.AFrameworkApplication.Aa&&ti.AFrameworkApplication.Aa.gb.RGb}nG(){return"FindInDocument"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:3===this.rb.fr?
this.rb.arh?2:3:2}qD(ua,Pa,eb=!1,Kb,bc=null){const oc=new y.a(ua);if(bc&&!Array.contains(bc,2))Pa.resultsUpdated(oc);else if(Array.clear(this.S0a),Oe.a.cN(ua)){if(eb&&this.Yoh()){eb=new w.a(2);eb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;bc=1;Kb="";if(0<this.yLa.length&&!this.rb.SGb)for(var W of this.yLa)if(""!==W.Label.toLowerCase()){if(bc>=this.Swd)break;this.SBh(eb,W.Label,W.CommandValueId,wb.O2f+bc,W.InputText);bc++}W="";this.rb.eH?(oc.us(eb),eb=new w.a(3),W=this.rb.bNa?Oe.a.GPa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):W=CommonUIStrings.l_TellMeOpenFindPaneText;Kb=this.K7f("");this.SBh(eb,W,Kb,wb.g4g,"");oc.us(eb)}Pa.resultsUpdated(oc)}else W="",eb&&(eb=this.K7f(ua.Ff),Kb=[],this.rb.kSa?(this.rb.YKe&&Kb.push(appChrome.actions.setControlIconSet(wb.Pha,{"default":"FindInDocument_20"})),W=this.rb.Z$d?Oe.a.TYd(ua.Ff,CommonUIStrings.l_FindInDocumentScopedButtonText):ua.Ff+CommonUIStrings.l_FindInDocumentScopedButtonText):this.rb.eH?(W=this.rb.bNa?Oe.a.GPa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
ua.Ff)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,ua.Ff),Kb.push(appChrome.actions.setControlIconSet(wb.Pha,{"default":"FindInDocument_20"}))):W=this.rb.SGb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,ua.Ff),this.rb.ria?(nd.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(wb.Pha,W)),nd.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(wb.Pha,eb))):(Kb.push(appChrome.actions.setControlLabel(wb.Pha,
W)),Kb.push(appChrome.actions.setButtonCommandValueId(wb.Pha,eb)),appChrome.api.dispatch(Kb)),this.jlh(W,wb.Pha,eb,ua.Ff)),this.rb.arh?(W=new vh.a(wb.Pha,8,ua.Ff),eb=new w.a(2),eb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,eb.Fv(W),oc.us(eb),Pa.resultsUpdated(oc)):this.rb.X2i().then(ta=>{const da=new vh.a(wb.Pha,8,ua.Ff,null,1);da.count=ta;ta=new w.a(2);ta.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ta.Fv(da);oc.us(ta);Pa.resultsUpdated(oc)},ta=>{nd.TellMeActor.instance.Jd.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+ta);ta=new vh.a(wb.Pha,8,ua.Ff,null,1);const da=new w.a(2);da.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;da.Fv(ta);oc.us(da);Pa.resultsUpdated(oc)})}Yoh(){return!!this.rb&&this.rb.Ngd}SBh(ua,Pa,eb,Kb,bc=null){const oc=[];Pa&&oc.push(appChrome.actions.setControlLabel(Kb,Pa));this.rb.eH&&oc.push(appChrome.actions.setControlIconSet(Kb,{"default":"FindInDocument_20"}));oc.push(appChrome.actions.setButtonCommandValueId(Kb,eb));appChrome.api.dispatch(oc);
this.jlh(Pa,Kb,eb,"");ua.Fv(new vh.a(Kb,8,bc,null,1,-99999))}K7f(ua){return this.yUh?Oe.a.bOa(ua,15,this.cPh):qb.a.ie(ua)}jlh(ua,Pa,eb,Kb){this.Yoh()&&this.S0a.length<this.Swd&&(ua=new ui(ua,Pa,eb,Kb),Array.add(this.S0a,ua))}f3k(ua){for(let Pa=0;Pa<this.S0a.length;Pa++)if(this.S0a[Pa].CommandId===ua){const eb=this.S0a[Pa].Label;let Kb=!1;if(0<this.yLa.length){let bc=0;for(const oc of this.yLa){if(oc.Label===eb){Array.removeAt(this.yLa,bc);Kb=!0;break}bc++}}!Kb&&this.yLa.length>=this.Swd-1&&Array.removeAt(this.yLa,
1);Array.insert(this.yLa,0,this.S0a[Pa])}}}wb.Pha=null;wb.O2f=null;wb.g4g=null;Object(h.a)(wb,"FindInDocumentResultsProvider",null,[968]);var jc=d(948);class Qc{constructor(ua){this.rb=ua}nG(){return"Insights"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:2}qD(ua,Pa,eb=!1,Kb,bc=null){Kb=new y.a(ua);if(!bc||Array.contains(bc,13))if(this.z$k()||!Oe.a.cN(ua)){bc=new w.a(13);var oc=""===ua.Ff.trim(),W=oc?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",ta=new vh.a(W,10,ua.Ff,null,1);eb&&(eb=null,
Oe.a.aja()?oc?oc=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(oc=this.rb.SGb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ua.Ff),eb=Oe.a.bOa(ua.Ff,1)):(oc=String.format(CommonUIStrings.l_InsightsButtonText,ua.Ff),eb=Oe.a.lPd(ua.Ff)),this.rb.ria?(nd.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(W,oc)),eb&&nd.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
eb))):(ua=[],ua.push(appChrome.actions.setControlLabel(W,oc)),eb&&ua.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",eb)),appChrome.api.dispatch(ua)),ta.label=oc);bc.Fv(ta);Kb.us(bc)}Pa.resultsUpdated(Kb)}z$k(){return Oe.a.aja()&&this.rb.Ikl}}Object(h.a)(Qc,"InsightsResultsProvider",null,[968]);var Cd=d(946);class Ld{constructor(ua){this.rb=ua}nG(){return"Learning"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:2}qD(ua,Pa,eb,Kb,bc=null){eb=new y.a(ua);bc&&!Array.contains(bc,
21)||!Oe.a.cN(ua)||(bc=[],Kb=this.rb.pSj,bc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Kb)),Kb=Ld.y3i(Kb),bc.push(appChrome.actions.setControlLabel("LearningForSearch",Kb)),appChrome.api.dispatch(bc),ua=new vh.a("LearningForSearch",22,ua.Ff,null,1),bc=new w.a(21),bc.Fv(ua),eb.us(bc));Pa.resultsUpdated(eb)}static y3i(ua){const Pa=[];Array.add(Pa,new Cd.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Pa,new Cd.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Pa,new Cd.a(600,ua));Array.add(Pa,new Cd.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));ua={};ua.parts=Pa;return JSON.stringify(ua)}}Object(h.a)(Ld,"LearningProvider",null,[968]);var ie=d(1022);class Qe{constructor(ua,Pa){this.tkb=this.rmb=this.TLa=this.euc=null;this.Av=!1;this.Jkb=ua;this.KJh=Pa;ua&&this.a1f(ua)}Gkd(){this.Jkb.Gkd()&&this.a1f(this.Jkb)}rej(ua){let Pa=[];var eb=[];ua=Qe.gfk(ua);var Kb="";Array.clear(eb);for(let bc=0;bc<ua.length;bc++){const oc=ua.charAt(bc);-1!==
" ".indexOf(oc)?(Kb.length&&Array.add(eb,Kb),Kb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(oc)?(Kb.length&&Array.add(eb,Kb),Kb=oc,Array.add(eb,Kb),Kb=""):Kb+=oc}Kb.length&&Array.add(eb,Kb);for(ua=0;ua<eb.length;ua++)Kb=this.e_i(eb[ua]),Kb=this.aui(Kb),Pa=Qe.ick(Pa,Kb);return Pa=this.K0h(Pa)}v9d(){this.Av||this.Gkd();return this.Av}MFc(ua){return this.euc[ua.toString()]}K0h(ua){for(let Pa=0;Pa<ua.length;Pa++){const eb=this.TLa[Pa];if(ua[Pa].commandId!==this.MFc(eb[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Kb;(Kb=ua[Pa]).score=Kb.score+eb[1]}return ua}aui(ua){const Pa=[];for(var eb=0;eb<this.TLa.length;eb++)Pa.push(new kg.a(this.MFc(this.TLa[eb][0]),-5));eb=new ie.a;for(var Kb=0;Kb<ua.length;Kb++)eb.add(this.MFc(ua[Kb][0]));for(Kb=0;Kb<Pa.length;Kb++){const oc=Pa[Kb];for(let W=0;W<ua.length;W++){var bc=ua[W];const ta=this.MFc(bc[0]);bc=bc[1];if(ta===oc.commandId){oc.score=bc;eb.remove(ta);break}}if(!eb.count)break}return Pa}e_i(ua){const Pa=1>ua.length;for(let W=0;2>=W;W++){const ta=this.tkb;for(let da in ta){var eb=
ta[da],Kb=ua,bc=da;const Ea=bc.length+1,$a=Array((Kb.length+1)*Ea);for(var oc=0;oc<=Kb.length;oc++)$a[oc*Ea]=oc;for(oc=0;oc<=bc.length;oc++)$a[oc]=oc;for(oc=0;oc<bc.length;oc++)for(let fb=0;fb<Kb.length;fb++)$a[(fb+1)*Ea+(oc+1)]=Kb.charAt(fb)===bc.charAt(oc)?$a[fb*Ea+oc]:Math.min(Math.min($a[fb*Ea+(oc+1)]+1,$a[(fb+1)*Ea+oc]+1),$a[fb*Ea+oc]+1);Kb=$a[Kb.length*Ea+bc.length];if((!Kb||!Pa)&&Kb<=W)return eb}}return this.rmb}a1f(ua){this.euc=ua.c_d();this.TLa=ua.h$i();this.rmb=ua.rgj();this.tkb=ua.s5i();
if(this.Av=!!this.euc&&!!this.TLa&&!!this.tkb&&!!this.rmb)this.Av=0<this.TLa.length&&Qe.r7d(this.TLa);this.Av&&(this.Av=0<this.rmb.length&&Qe.r7d(this.rmb));this.Av&&(this.tkb=Qe.Tgj(this.tkb));this.Av||(this.tkb=this.rmb=this.TLa=this.euc=null)}Wfj(ua){ua=this.rej(ua);return this.zQi(ua,this.KJh)}zQi(ua,Pa){let eb=[];for(let Kb=0;Kb<ua.length;Kb++)ua[Kb].score>=Pa&&eb.push(ua[Kb]);eb.sort((Kb,bc)=>Kb.score<bc.score?1:Kb.score>bc.score?-1:0);0<eb.length-10&&(eb=eb.slice(0,10));return eb}static ick(ua,
Pa){if(!ua.length)return Pa;if(ua.length!==Pa.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let eb=0;eb<ua.length;eb++){if(ua[eb].commandId!==Pa[eb].commandId)throw Error.create("Incorrect CommandId");let Kb;(Kb=ua[eb]).score=Kb.score+Pa[eb].score}return ua}static gfk(ua){return qb.a.sg(ua)}static r7d(ua){for(let Pa=0;Pa<ua.length;Pa++)if(2!==ua[Pa].length)return!1;return!0}static Tgj(ua){const Pa={};for(let bc in ua){var eb=bc,Kb=ua[bc];
const oc=Kb;oc.length&&Qe.r7d(oc)&&(Pa[eb]=Kb)}return Pa}}Object(h.a)(Qe,"NaiveBayesClassifierModel",null,[]);class df{constructor(ua,Pa){this.C$=null;this.rb=ua;this.XOb=new Qe(Pa,ua.Lag);this.rb.Y2a&&(this.C$=null)}nG(){return"NBCommand"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:2}qD(ua,Pa,eb=!1,Kb=e.a.tellMe,bc=null){const oc=new y.a(ua);if((!bc||Array.contains(bc,0))&&!Oe.a.cN(ua)){if(jf.CommandResultsUtility.N7d(ua.Ff)&&(bc=jf.CommandResultsUtility.L7f(ua.Ff),0<bc.results.length)){bc.displayName=
"Classifier Debug";oc.us(bc);Pa.resultsUpdated(oc);return}if(!this.XOb.v9d()){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.rb.Y2a&&this.C$&&this.C$.initialize();bc=this.XOb.Wfj(ua.Ff);jf.CommandResultsUtility.AVc(bc,!1,"Classifier","NaiveBayesian");bc=jf.CommandResultsUtility.TMc(ua,bc,this.rb,this.C$,null,null,0,1);0<bc.results.length&&
Kb!==e.a.contextMenu&&(bc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);eb||bc.results.length||this.rb.JCa||this.rb.Bwa||(ua=new vh.a("lookupNoResults",14,ua.Ff,null,1),bc.Fv(ua));0<bc.results.length&&oc.us(bc)}Pa.resultsUpdated(oc)}}Object(h.a)(df,"NaiveBayesCommandProvider",null,[968]);class tf{constructor(){this.Q0a=null;this.Av=!1;this.Gkd()}Gkd(){this.Av||(this.Q0a=window.NBCRM)&&4===this.Q0a.length&&(this.Av=!0);return this.Av}h$i(){return this.Av?this.Q0a[1]:null}rgj(){return this.Av?
this.Q0a[2]:null}s5i(){return this.Av?this.Q0a[3][0]:null}c_d(){return this.Av?this.Q0a[0][0]:null}}Object(h.a)(tf,"NaiveBayesModelAdapter",null,[987]);var jh=d(246);class Dh{constructor(ua){this.rb=ua}nG(){return"OfficeScript"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:2}qD(ua,Pa){const eb=new y.a(ua);if(!Oe.a.cN(ua)){ua=jh.d(ua.Ff);var Kb=new w.a(25);Kb.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Kb=this.wBf(ua,Dh.Mrl,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,
Kb);Kb=this.wBf(ua,Dh.JUi,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Kb);eb.us(Kb)}Pa.resultsUpdated(eb)}wBf(ua,Pa,eb,Kb,bc,oc){const W=[];for(const ta of Pa)if(jh.a(ua,ta)){this.rb.ria?(nd.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(eb,bc)),nd.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(eb,Kb))):(W.push(appChrome.actions.setControlLabel(eb,bc)),W.push(appChrome.actions.setButtonCommandValueId(eb,
Kb)),appChrome.api.dispatch(W));oc.Fv(new vh.a(eb,26,null,null,1));break}return oc}}Dh.Mrl="unhide row rows col cols column columns".split(" ");Dh.JUi=["freeze","selection","pane","panes"];Object(h.a)(Dh,"OfficeScriptsSamplesProvider",null,[968]);var ch=d(17),Hg=d(15),wh=d(439),Yh=d(297),Ni=d(438),vi=d(33),Eh=d(113),xh=d(123);class fj{constructor(ua){this.xH=null;this.gR=-1;this.Ere=14;this.Fre=12;this.attributes=this.YDd=this.query=null;this.avb=!1;this.tlb=[];this.Ei=ti.AFrameworkApplication.He;
ti.AFrameworkApplication.fa&&(this.Ere=ti.AFrameworkApplication.fa.Ec("TellMeMaxTermedResults",this.Ere),this.Fre=ti.AFrameworkApplication.fa.Ec("TellMeMaxZeroTermResults",this.Fre));this.YK=ua}get uk(){return this.tlb}get fld(){return this.YDd}us(ua){let Pa=!1;for(let eb=0;eb<this.uk.length;eb++)if(27!==this.uk[eb].groupType&&this.uk[eb].groupType===ua.groupType){this.MFd(this.uk[eb],ua);Pa=!0;break}Pa||this.uk.push(ua)}MFd(ua,Pa){for(let eb=0;eb<Pa.results.length;eb++)ua.Fv(Pa.results[eb])}nch(ua){const Pa=
[];for(const eb of this.uk)eb.groupType!==ua&&Pa.push(eb);this.uk.length!==Pa.length&&(this.tlb=Pa)}YNk(ua){let Pa=null,eb=null,Kb=null;for(let bc=0;bc<ua.length;bc++){const oc=ua[bc];if(oc&&oc.uk&&oc.uk.length)for(const W of oc.uk)if(17===W.groupType||18===W.groupType)Pa=W;else if(0===W.groupType||16===W.groupType)eb=W,Kb=oc}Pa&&eb&&0<eb.results.length&&(17===Pa.groupType&&({BFd:eb,VFd:Pa}=jf.CommandResultsUtility.H_h(eb,Pa,this.YK.jG()?this.YK.jG().vZi:-.6)),Kb.nch(eb.groupType))}efl(){new ch.a;
this.Skc(this.YK.GNg)}R4b(ua,Pa){return this.query.Ff.length>this.YK.jG().z$i&&this.fLj(ua,Pa)||this.query.Ff.length>this.YK.jG().A$i&&this.MNj(ua,Pa)?!0:!1}MNj(ua,Pa){return ua&&ua.length&&Pa&&Pa.length?-1===Pa.toLowerCase().indexOf(ua.toLowerCase())?!1:!0:!1}fLj(ua,Pa){return ua&&ua.length&&Pa&&Pa.length?Pa.toLowerCase().startsWith(ua.toLowerCase()):!1}LQi(ua){const Pa=[];for(const eb of this.YK.jG().eH?this.fld:this.uk)ua.contains(eb.groupType)||Pa.push(eb);this.YK.jG().eH?this.YDd=Pa:this.tlb=
Pa}Svl(ua,Pa){const eb=[];for(const Kb of this.uk){const bc=Kb;if(13!==bc.groupType){const oc=ua[Yh.a[bc.groupType].toLowerCase()];let W="False";oc<Pa&&(W="True");bc.displayName=bc.displayName+" ("+W+": "+oc+")"}eb.push(bc)}this.tlb=eb}Skc(ua,Pa=!1,eb=null){if(this.YK.jG().eH){if(!Pa)for(this.YDd=Array(this.uk.length),Pa=0;Pa<this.uk.length;Pa++)this.fld[Pa]=this.uk[Pa];this.YK.YOg.Skc(this.uk,this.fld,this.query,ua,eb)}else{for(eb=new ch.a;this.uk.length;){Pa=this.uk.pop();const Kb=Yh.a[Pa.groupType].toLowerCase(),
bc=ua[Kb];if(xh.b(bc))throw Error.create("GroupId "+Kb+" missed from group SortingOrder");eb.add(new Hg.a(bc,Pa))}eb.Sc((Kb,bc)=>Kb.key<bc.key?-1:1);for(ua=0;ua<eb.count;ua++)Pa=eb.ga(ua).value,this.uk.push(Pa)}}ffl(){var ua=!1;let Pa=!1,eb=!1;for(let bc=0;bc<this.uk.length;bc++){var Kb=this.uk[bc];const oc=Kb.groupType;if(8===oc||15===oc||14===oc){Kb=Kb.results;for(let W=0;W<Kb.length;W++){if(8===oc&&this.R4b(this.query.Ff,Kb[W].label)){ua=!0;break}if(15===oc&&this.R4b(this.query.Ff,Kb[W].label)){Pa=
!0;break}if(14===oc){if(this.R4b(this.query.Ff,Kb[W].label)||this.R4b(this.query.Ff,Kb[W].description)){eb=!0;break}const ta=Kb[W].label.split(" ");for(const da of ta)if(this.R4b(this.query.Ff,da)){eb=!0;break}}}}}ua=this.YK.Uaj(ua,Pa,eb);this.Skc(ua)}Vcb(ua,Pa,eb,Kb,bc,oc){if(bc===this.xH){var W=ua.data.Zd;bc=null;try{bc=vi.b(W)}catch(Ac){nd.TellMeActor.instance.Jd.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Ac);return}if("RankerResults"in bc&&bc.RankerResults){this.fha();
var ta=bc.RankerResults,da=new ch.a,Ea=new ch.a;W=0;for(var $a of ta){ta=$a.ProviderId;var fb=$a.Score;W+=fb;da.add(new Hg.a(ta,fb))}da.Sc((Lc,yc)=>Lc.value>yc.value?-1:1);fb=oc?oc.Sbj:1E-6;$a={};ta={};let Ac=0;for(var qc=0;qc<da.count;qc++){let Lc=parseInt(da.ga(qc).key),yc=da.ga(qc).value/W;1===Lc&&(ta.answer=Ac++,ta.entity=Ac++,ta.definition=Ac++,ta.wolframanswer=Ac++,yc<fb&&(Ea.add(9),Ea.add(11),Ea.add(10),Ea.add(12)),$a.answer=yc,$a.entity=yc,$a.definition=yc,$a.wolframanswer=yc);2===Lc&&(ta.assistance=
Ac++,yc<fb&&Ea.add(8),$a.assistance=yc);3===Lc&&(ta.classifier=Ac++,ta.serviceclassifier=Ac++,yc<fb&&(Ea.add(0),Ea.add(17)),$a.classifier=yc,$a.serviceclassifier=yc);4===Lc&&(ta.people=Ac++,yc<fb&&Ea.add(14),$a.people=yc);5===Lc&&(ta.document=Ac++,yc<fb&&Ea.add(15),$a.document=yc);6===Lc&&(ta.findindocument=Ac++,yc<fb&&Ea.add(2),$a.findindocument=yc);7===Lc&&(ta.notes=Ac++,yc<fb&&Ea.add(20),$a.notes=yc);8===Lc&&(ta.image=Ac++,yc<fb&&Ea.add(19),$a.image=yc)}da=new ch.a;da.add("classifier");da.add("serviceclassifier");
da.add("appsforoffice");da.add("addin");da.add("findindocument");da.add("assistance");da.add("document");da.add("people");da.add("answer");da.add("wolframanswer");da.add("definition");da.add("entity");da.add("image");da.add("template");da.add("officescript");for(qc=0;qc<da.count;qc++)da.ga(qc)in ta||(ta[da.ga(qc)]=Ac++);ta.learning=Ac++;ta.insights=Ac++;ta.feedback=Ac++;oc&&oc.IIj&&this.Svl($a,fb);oc&&oc.JIj&&this.LQi(Ea);Ea={};for(var Hc in $a)Ea[Hc]=$a[Hc]*W;this.Skc(ta,!0,Ea)}if(oc.CTc&&"Intents"in
bc&&bc.Intents){Hc=bc.Intents;for(var kd of Hc)if(this.uae(kd)&&"Serplet"===kd.GroupType&&kd.ConfidenceScore>kd.ConfidenceThreshold){Hc=!1;bc=0;if(oc.F$d){W=new vh.a("",28);for(Ea=0;Ea<this.uk.length;Ea++)if((da=this.uk[Ea].results)&&0<da.length){bc=Ea;W=da[0];break}2===W.groupType&&(Hc=!0)}W=new w.a(13);Hc&&oc.F$d&&(W=new w.a(13,CommonUIStrings.l_TellMeWebTitle));Ea=new vh.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Ff,null,0);da=[];$a=null;$a=Oe.a.aja()?Oe.a.bOa(this.query.Ff,1):Oe.a.lPd(this.query.Ff);
da.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",$a));$a=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Ff);da.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",$a));appChrome.api.dispatch(da);W.Fv(Ea);Ea=[];if(Hc&&oc.F$d)for(Ea.push(this.uk[bc]),Ea.push(W),Hc=bc+1;Hc<this.uk.length;Hc++)(bc=this.uk[Hc].results)&&0<bc.length&&Ea.push(this.uk[Hc]);else for(Ea.push(W),Hc=0;Hc<this.uk.length;Hc++)(bc=this.uk[Hc].results)&&
0<bc.length&&Ea.push(this.uk[Hc]);this.tlb=Ea}}if(oc.Y4b&&!oc.eH){kd=Hc=-1;for(bc=0;bc<this.uk.length;bc++)switch(this.uk[bc].groupType){case 23:Hc=bc;break;case 0:case 17:case 2:-1===kd&&(kd=bc)}if(-1!==Hc){kd=-1===kd?0:Hc>kd?kd+1:kd;Hc=this.uk[Hc];bc=Array(this.uk.length);W=0;for(Ea=0;Ea<bc.length;Ea++)Ea===kd?bc[Ea]=Hc:(23===this.uk[W].groupType&&W++,bc[Ea]=this.uk[W],W++);this.tlb=bc}}Kb.resultsUpdated(this);Kb=nd.TellMeActor.instance.Jd;Kb.l4(Pa.length,"RankerInference",ua.data.af.toString(),
Math.round(window.performance.now()-eb),Ni.a.uvh,!0,wh.a.Hra);this.avb&&Kb&&(ua=this.query.HWa,Pa=Kb.kqc,oc.TTc&&ua>Pa&&!oc.eH&&(Kb.uce(this.query.Ff),Kb.WHe(ua)))}}uae(ua){if("GroupType"in ua&&ua.GroupType&&"ConfidenceScore"in ua&&"ConfidenceThreshold"in ua)return!0;nd.TellMeActor.instance.Jd.onError("IsValidIntentGroup","Invalid intents found");return!1}Kcb(ua,Pa,eb,Kb,bc){Kb===this.xH&&(this.fha(),nd.TellMeActor.instance.Jd.l4(Pa.length,"RankerInference",ua.data.af.toString(),Math.round(window.performance.now()-
eb),Ni.a.uvh,!1,wh.a.Hra));bc.resultsUpdated(this)}fha(){-1!==this.gR&&(window.clearTimeout(this.gR),this.gR=-1)}gfl(ua){let Pa;Pa=this.YK.jG().eH?nd.TellMeActor.instance.Jd.b1d(this.fld,this.query.Ff):nd.TellMeActor.instance.Jd.b1d(this.uk,this.query.Ff);var eb=this.YK.jG().Rbj;""!==eb&&(eb="_"+eb);let Kb="";this.YK.jG().u9d&&(Kb="RankerInference"+eb+",");this.YK.jG().CTc&&(Kb+="SerpletClassifier");","===Kb.charAt(Kb.length-1)&&(Kb=Kb.substring(0,Kb.length-1));eb=nd.TellMeActor.instance.Jd.xeg(Kb);
const bc=this.xH=Eh.a.create().toString();eb["Client-Request-Id"]=bc;const oc=window.performance.now(),W=this.YK.jG()?this.YK.jG().Tbj:600;this.fha();this.gR=window.setTimeout(()=>{if(bc===this.xH){this.xH="";this.gR=-1;ua.resultsUpdated(this);const ta={};ta[m.a.provider]="Ranker";ta[m.a.Ndb]=this.query.HWa;nd.TellMeActor.instance.Jd.WG(n.a.timedOut,W,ta)}},W);this.Ei.vj(nd.TellMeActor.instance.Jd.yeg(),2,Pa,eb,!1,0,ta=>{this.Vcb(ta,this.query.Ff,oc,ua,bc,this.YK.jG())},ta=>{this.Kcb(ta,this.query.Ff,
oc,bc,ua)},null,null,!1,4E3,6E3)}Ool(){var ua=0,Pa=new ch.a,eb=this.YK.ENg,Kb=this.YK.FNg;for(var bc=0;bc<this.uk.length;bc++){var oc=this.uk[bc],W=Yh.a[oc.groupType].toLowerCase(),ta=eb[W];ua+=oc.results.length;oc.results.length>ta&&(W=Kb[W],xh.b(W)||Pa.add(new Hg.a(W,oc)))}Kb=!this.query||""===this.query.Ff.trim();bc=ua-(Kb?this.Fre:this.Ere);if(!(0>=bc)){Kb=window.performance.now();ua=ua.toString()+" total,"+bc.toString()+" to remove.";if(0<Pa.count)for(Pa.Sc((da,Ea)=>da.key>Ea.key?-1:1),oc=0;oc<
Pa.count&&0<bc;oc++){W=Pa.ga(oc).value;ta=Yh.a[W.groupType].toLowerCase();let da=W.results.length-eb[ta];da>bc&&(da=bc);0<da&&(W.xDe(da),ua+=ta+": "+da.toString()+" results removed.",bc-=da)}if(0<bc){ua+=bc.toString()+" results left after trimming.";Pa=new ch.a;eb=this.YK.JNg;for(oc=0;oc<this.uk.length;oc++)W=this.uk[oc],ta=eb[Yh.a[W.groupType].toLowerCase()],xh.b(ta)||Pa.add(new Hg.a(ta,W));Pa.Sc((da,Ea)=>da.key<Ea.key?-1:1);for(eb=0;0<bc;)oc=Pa.ga(eb++).value,bc>=oc.results.length?(Array.remove(this.uk,
oc),ua+=Yh.a[oc.groupType]+": "+oc.results.length.toString()+" results force removed.",bc-=oc.results.length):(oc.xDe(bc),ua+=Yh.a[oc.groupType]+": "+bc.toString()+" results force removed.",bc=0)}nd.TellMeActor.instance.Jd&&(Pa={},Pa[m.a.message]=ua,nd.TellMeActor.instance.Jd.WG("ShowOptimal",window.performance.now()-Kb,Pa))}}}Object(h.a)(fj,"CombineResultsUpdatedEventArgs",null,[944]);var Wi=d(675);class yh{constructor(ua,Pa,eb,Kb=!1,bc=""){this.Yyd=this.tAd=!1;this.FC=ua;this.w1a=[];this.tqf=Pa.length;
this.rb=nd.TellMeActor.instance.jG();this.ftc=Kb;this.k2a=bc;this.$lb={};for(ua=0;ua<Pa.length;++ua)this.$lb[ua.toString()]=eb?0:Pa[ua].yP()}y4k(ua,Pa){Pa&&Pa.query&&Pa.query.HWa<nd.TellMeActor.instance.haa||(this.w1a[ua]=Pa,this.Yyd?this.tAd=!0:(!this.rb||3!==this.rb.fr||3!==this.$lb[ua.toString()]||this.wWf())&&this.QQc())}tuk(){this.Yyd=!0}Wrl(){this.Yyd=!1;this.tAd&&(this.tAd=!1,this.QQc())}wWf(){if(this.w1a.length<this.tqf)return!1;for(let ua=0;ua<this.tqf;++ua)if(!this.w1a[ua])return!1;return!0}QQc(){var ua=
this.wWf();const Pa=window.performance.now(),eb=new fj(nd.TellMeActor.instance.K3e);eb.YNk(this.w1a);for(var Kb=0;Kb<this.w1a.length;++Kb){var bc=this.w1a[Kb];if(bc&&bc.uk&&bc.uk.length&&(eb.query=bc.query,bc.attributes&&0<bc.attributes.length&&(eb.attributes=bc.attributes),bc&&bc.uk&&(ua||this.uli(Kb,this.w1a))))for(const oc of bc.uk)eb.us(oc)}eb.uk&&eb.uk.length&&(eb.avb=ua,this.rb&&this.rb.RQe&&eb.Ool(),Wi.a.Uwg()&&(this.rb&&this.rb.hMj&&eb.query.Ff&&0<eb.query.Ff.length?eb.ffl():eb.efl()),Wi.a.Uwg()&&
this.rb&&(this.rb.u9d||this.rb.CTc)&&this.ftc&&eb.query.Ff&&0<eb.query.Ff.length&&eb.avb&&this.k2a!==e.a.contextMenu?(3===this.rb.fr&&ua||this.FC.resultsUpdated(eb),eb.gfl(this.FC)):this.FC.resultsUpdated(eb),ua=nd.TellMeActor.instance.Jd,eb.avb&&ua&&(Kb=eb.query.HWa,bc=ua.kqc,eb.query.Ff&&0<eb.query.Ff.length&&this.ftc&&this.rb.TTc&&this.k2a!==e.a.contextMenu&&Kb>bc&&!this.rb.u9d&&!this.rb.eH&&(ua.uce(eb.query.Ff),ua.WHe(Kb)),ua.WG(n.a.VUk,window.performance.now()-Pa)))}uli(ua,Pa){if(!(this.$lb&&
ua.toString()in this.$lb)||Pa.length<=ua||!Pa[ua])return!1;if(!Pa[ua].uk.length)return!0;const eb=this.$lb[ua.toString()];if(0===eb)return!0;const Kb=this.$lb;for(let oc in Kb){var bc=Kb[oc];const W=Number.parseInvariant(oc);if(W!==ua&&bc===eb&&!(Pa.length>W&&Pa[W]))return!1}return!0}}Object(h.a)(yh,"ResultsAggregator",null,[]);var Rj=d(978);class Ci{constructor(){this.pIb=this.qIb=this.oIb=this.logCount=this.logRank=this.invertedRank=0}m_h(ua,Pa){switch(ua){case 1:this.invertedRank=Pa;break;case 3:this.logRank=
Pa;break;case 2:this.logCount=Pa;break;case 5:this.oIb=Pa;break;case 4:this.qIb=Pa;break;case 6:this.pIb=Pa}}}Object(h.a)(Ci,"CommandFeatures",null,[]);class bk{constructor(ua){this.K1e=0;this.sQh=ua;this.PIh={}}get modelId(){return this.sQh}get featureIntercept(){return this.K1e}get qVb(){return this.PIh}rZh(ua,Pa,eb){0===Pa?this.K1e=eb:(this.qVb[ua]||(this.qVb[ua]=new Ci),this.qVb[ua].m_h(Pa,eb))}}Object(h.a)(bk,"CoefficientsModel",null,[]);const zg=(ua,Pa)=>Math.pow(10,-Pa/(60*Math.LN10/Math.LN2*
ua));class xf{constructor(ua,Pa){this.Gk=1;this.grc=new Ci;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=ua?1/ua:0;this.features.logRank=2/Math.pow(2,ua);this.features.oIb=zg(10,Pa);this.features.qIb=zg(2,Pa);this.features.pIb=zg(1,Pa)}get count(){return this.Gk}get features(){return this.grc}avj(){this.Gk=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}Lvl(ua){const Pa=2/Math.pow(2,ua);this.features.invertedRank=Math.max(this.features.invertedRank,
ua?1/ua:0);this.features.logRank=Math.max(this.features.logRank,Pa)}Swl(ua){const Pa=zg(10,ua),eb=zg(2,ua);ua=zg(1,ua);this.features.oIb=Math.max(this.features.oIb,Pa);this.features.qIb=Math.max(this.features.qIb,eb);this.features.pIb=Math.max(this.features.pIb,ua)}}Object(h.a)(xf,"CommandModel",null,[]);class Qh{constructor(ua){this.$Kb=null;if(!ua&&nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("PredictionEngine","IModelAdapter can't be null");this.Jkb=ua;this.duc=this.Obe()}Obe(){const ua=
this.Jkb.m7i(),Pa=this.Jkb.c_d();if(void 0===ua||null===ua||void 0===Pa||null===Pa)return!1;try{window.performance.now();this.$Kb={};for(let eb=0;eb<ua.length;eb++){const Kb=ua[eb],bc=Pa[Kb[0].toString()].trim(),oc=Kb[1],W=0!==oc?Pa[Kb[2].toString()].trim():"",ta=Kb[3];bc in this.$Kb||(this.$Kb[bc]=new bk(bc));this.$Kb[bc].rZh(W,oc,ta)}}catch(eb){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("LoadModelData","Error Loading Suggestions Model: "+eb);return!1}return!0}eWi(){const ua=
this.Jkb.R4i(),Pa={};if(!ua)return Pa;let eb=1;for(let Kb=0;Kb<ua.length;Kb++){const bc=ua[Kb];bc.Id in Pa?(Pa[bc.Id].avj(),Pa[bc.Id].Lvl(eb),Pa[bc.Id].Swl(bc.TimeElapsedSinceClick)):Pa[bc.Id]=new xf(eb,bc.TimeElapsedSinceClick);eb++}return Pa}v9d(){this.duc||(this.duc=this.Obe());return this.duc}T9i(){let ua=[];if(!this.duc){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("GetPredictedCommands","IModelAdapter returned no data");return ua}const Pa=this.eWi(),eb=this.$Kb;for(let bc in eb){const oc=
eb[bc],W=oc.modelId;let ta=0;for(let da in Pa){var Kb=da;const Ea=Pa[da].features;(Kb=Kb in oc.qVb?oc.qVb[Kb]:null)&&(ta+=Ea.invertedRank*Kb.invertedRank+Ea.logRank*Kb.logRank+Ea.logCount*Kb.logCount+Ea.oIb*Kb.oIb+Ea.qIb*Kb.qIb+Ea.pIb*Kb.pIb)}ta+=oc.featureIntercept;ua.push(new kg.a(W,ta))}ua.sort((bc,oc)=>bc.score<oc.score?1:bc.score>oc.score?-1:0);0<ua.length-10&&(ua=ua.slice(0,10));return ua}}Object(h.a)(Qh,"PredictionEngine",null,[]);class Lh{constructor(){this.wtf={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}SKc(ua,Pa){return Pa&&"word"===Pa.application.toLowerCase()&&
ua in this.wtf?this.wtf[ua]:[]}}Object(h.a)(Lh,"SuggestionResultsUtility",null,[]);class oj{constructor(ua,Pa,eb){this.rb=Pa;this.XOb=new Qh(ua);this.sR=eb;this.Pvf=new Lh}nG(){return"Suggestion"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:2}qD(ua,Pa,eb,Kb=e.a.tellMe,bc=null){eb=new y.a(ua);nd.TellMeActor.instance.Bnc=!1;if((!bc||Array.contains(bc,16))&&Oe.a.cN(ua)){if(!this.XOb.v9d()){if(nd.TellMeActor.instance.Jd)nd.TellMeActor.instance.Jd.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.A$d()&&0<this.Pvf.SKc(nd.TellMeActor.instance.zFc,this.rb).length){const W=this.Pvf.SKc(nd.TellMeActor.instance.zFc,this.rb);bc=[];for(var oc of W)this.rb.Ngd&&"Find"===oc||bc.push(new kg.a(oc,0));nd.TellMeActor.instance.Bnc=!0}else bc=this.XOb.T9i();jf.CommandResultsUtility.AVc(bc,!0,"Recommended","LRE");oc=[];for(const W of bc)this.sR&&this.sR.yNd(W.commandId)||oc.push(W);ua=jf.CommandResultsUtility.TMc(ua,
oc,this.rb,null,null,null,16,1);0<ua.results.length&&Kb!==e.a.contextMenu&&(ua.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<ua.results.length&&eb.us(ua)}Pa.resultsUpdated(eb)}A$d(){return!!this.rb&&(this.rb.A$d||this.rb.vQj)}}Object(h.a)(oj,"SuggestionResultsProvider",null,[968]);class gj{R4i(){return nd.TellMeActor.instance.Opd}m7i(){return window.TellMeSuggestionModel}c_d(){return window.CoefficientModelIdMap}}Object(h.a)(gj,"SuggestionsModelAdapter",null,[986]);var Di=d(1007),dh=d(949);
d.d(V,"AggregatorResultsProvider",function(){return Ig});class Ig{constructor(ua=!1){this.glb={};this.glb[e.a.tellMe]=[];this.glb[e.a.contextMenu]=[];this.ftc=ua}pyg(ua,Pa,eb,Kb,bc=null){let oc;var W=!1;switch(Kb){case e.a.contextMenu:oc=this.glb[e.a.contextMenu];W=!0;break;default:oc=this.glb[e.a.tellMe]}Pa=new yh(Pa,oc,W,this.ftc,Kb);Pa.tuk();for(let ta=0;ta<oc.length;++ta){const da=window.performance.now(),Ea=new A(Pa,ta);(W=nd.TellMeActor.instance.jG())&&W.Aci?window.setTimeout(()=>{oc[ta].qD(ua,
Ea,eb,Kb,bc);if(nd.TellMeActor.instance.Jd){const $a={};$a[m.a.provider]=oc[ta].nG();$a[m.a.Ndb]=ua.HWa;nd.TellMeActor.instance.Jd.WG(n.a.qD,window.performance.now()-da,$a)}},0):(oc[ta].qD(ua,Ea,eb,Kb,bc),nd.TellMeActor.instance.Jd&&(W={},W[m.a.provider]=oc[ta].nG(),W[m.a.Ndb]=ua.HWa,nd.TellMeActor.instance.Jd.WG(n.a.qD,window.performance.now()-da,W)))}Pa.Wrl()}nG(){return"Aggregator"}yP(){return 0}qD(ua,Pa,eb=!1,Kb=e.a.tellMe,bc=null){if(nd.TellMeActor.instance.hdk)this.pyg(ua,Pa,eb,Kb,bc);else{const oc=
window.performance.now();nd.TellMeActor.instance.iAl.then(()=>{nd.TellMeActor.instance.Jd&&nd.TellMeActor.instance.Jd.WG(n.a.idk,window.performance.now()-oc);this.pyg(ua,Pa,eb,Kb,bc);return!0})}}VC(ua,Pa){this.glb[Pa].push(ua)}c0h(ua){switch(ua){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Pa=this.glb[e.a.tellMe];for(const eb of Pa)if("FindInDocument"===eb.nG()){eb.f3k(ua);break}}}static createInstance(ua,Pa,eb,Kb){const bc=Kb&&Oe.a.yKe(Pa);var oc=
bc&&Pa.Fwe;const W=Pa.kae&&!Oe.a.L8a(),ta=Pa.E9d,da=new Ig(bc);if(Pa.A$k){var Ea=new Ld(Pa);da.VC(Ea,e.a.tellMe)}Ea=Pa.uo?ti.AFrameworkApplication.fa.ka("TellMeIsSuggestionsForSimplifiedUxEnabled"):ti.AFrameworkApplication.fa.ka("TellMeSuggestionsIsEnabled");const $a=!Ea&&ti.AFrameworkApplication.fa.ka("TellMeFirstRunExperienceIsEnabled");da.VC(new Rd.a(ua,Pa.zql,$a,!1),e.a.tellMe);Ea&&da.VC(new oj(new gj,Pa,ua),e.a.tellMe);ua=ti.AFrameworkApplication.Aa.gb.wxg?new df(Pa,new tf):new Kh(Pa,eb);da.VC(ua,
e.a.contextMenu);(bc&&Pa.Gwe||oc)&&da.VC(Di.a.iTf(Pa,!0),e.a.tellMe);da.VC(ua,e.a.tellMe);!Pa.kRi||"Word"===Pa.application&&Pa.K2f||da.VC(new wb(Pa),e.a.tellMe);Pa.Y2a&&(oc=new u(Pa),da.VC(oc,e.a.tellMe),da.VC(oc,e.a.contextMenu));!Pa.Anb||Pa.ikc||Pa.hkc||da.VC(new E.a(Pa),e.a.tellMe);Kb&&(Pa.JCa||Oe.a.aja())&&(oc=new Qc(Pa),da.VC(oc,e.a.tellMe),da.VC(oc,e.a.contextMenu));bc&&da.VC(Di.a.iTf(Pa,!1),e.a.tellMe);Kb&&!Pa.RNe&&Oe.a.xKe(Pa)&&(da.VC(new Rj.a(Pa),e.a.tellMe),Pa.$hl&&da.VC(new Rj.a(Pa),e.a.contextMenu));
W&&da.VC(new Bj(Pa),e.a.tellMe);(Pa.WGb||Pa.eH)&&da.VC(new jc.a(Pa),e.a.tellMe);Pa.Y4b&&da.VC(new dh.a(Pa),e.a.tellMe);Kb&&Pa.YQc&&da.VC(new v.AddinResultsProvider(Pa),e.a.tellMe);ta&&"Excel"===Pa.application&&da.VC(new Dh(Pa),e.a.tellMe);return da}}Object(h.a)(Ig,"AggregatorResultsProvider",null,[968])},978:function(J,V,d){J=d(0);var h=d(146),e=d(657),m=d(371),n=d(260),v=d(439);class A{constructor(ja,D){this.DimensionValue=this.DimensionName=null;this.DimensionName=ja;this.DimensionValue=D}}Object(J.a)(A,
"Dimension",null,[]);class w{constructor(ja,D,pa,Z,oa){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=ja;this.Query=D;this.From=pa;this.Size=Z;oa&&(this.Filter=oa)}}Object(J.a)(w,"EntityRequest",null,[]);class y{constructor(ja){this.QueryString=null;this.QueryString=ja}}Object(J.a)(y,"Query",null,[]);var u=d(158);class E{constructor(ja,D){this.Dimensions=this.Name=null;this.Name=ja;this.Dimensions=D}}Object(J.a)(E,"Scenario",null,[]);var G=d(175),I=d(174);class H{constructor(ja,
D,pa,Z){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=ja;this.TimeZone=D;this.Cvid=pa;this.Scenario=Z}}Object(J.a)(H,"SubstrateBody",null,[]);var K=d(438),C=d(118),Y=d(104),M=d(25),P=d(912),T=d(911),L=d(440),aa=d(33),Q=d(45),ea=d(113);d.d(V,"a",function(){return ia});class ia{constructor(ja){this.kPb=this.eMa=this.puc=this.wMb=this.KPb=0;this.Kef=this.Igf=this.xH=null;this.C0a=0;this.gR=-1;this.mRb="";this.Ei=M.AFrameworkApplication.He;this.rb=ja;this.ixc=this.c1d();
this.hBd=new e.a;this.udf=this.rb.RQe?3:2;this.zwf=this.rb.RQe&&this.rb.qqh?5:3;this.wzf=this.rb.Ngd?2:3;this.xzf=1;this.Stc=this.rb.dbg;this.hvf=this.rb.DNj;this.nQb=ja.Bdg;M.AFrameworkApplication.fa&&(this.Igf=M.AFrameworkApplication.fa.Ha("AppCatalogUrl")+M.AFrameworkApplication.fa.Ha("SearchPersonaPhotoBaseUrl"))}nG(){return"Substrate"}yP(){return 0===this.rb.fr?0:1===this.rb.fr?1:3}qD(ja,D,pa,Z=h.a.tellMe,oa=null){const Ba=new I.a(ja);if(!oa||Array.contains(oa,14)||Array.contains(oa,15)||Array.contains(oa,
20))if(!this.C0a||window.performance.now()-this.C0a>=Y.a.dkd)if(pa=this.hBd.beg())this.C0a=window.performance.now(),pa.then(Ma=>{Ma&&""!==Ma?(this.mRb=Ma,""!==this.xH&&this.aeg(ja,Z,this.mRb,D,oa)):(C.TellMeActor.instance.Jd.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),D.resultsUpdated(Ba))},Ma=>{C.TellMeActor.instance.Jd.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ma);D.resultsUpdated(Ba)});else{if(C.TellMeActor.instance.Jd)C.TellMeActor.instance.Jd.onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");D.resultsUpdated(Ba)}else this.mRb&&""!==this.mRb?this.aeg(ja,Z,this.mRb,D,oa):(D.resultsUpdated(Ba),C.TellMeActor.instance.Jd.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else D.resultsUpdated(Ba)}C4(){this.eMa=this.kPb=this.puc=this.wMb=this.KPb=0}aeg(ja,D,pa,Z,oa){this.C4();const Ba=new I.a(ja),Ma=this.xH=ea.a.create().toString();this.fha();this.gR=window.setTimeout(()=>{if(Ma===this.xH){this.xH="";this.gR=-1;Z.resultsUpdated(Ba);const qa=
{};qa[m.a.provider]=this.nG();qa[m.a.Ndb]=ja.HWa;C.TellMeActor.instance.Jd.WG(n.a.timedOut,this.nQb,qa)}},this.nQb);const za={"Content-Type":"application/json",Accept:"application/json"};za.Authorization="Bearer "+pa;za["X-Office-Version"]=M.AFrameworkApplication.buildVersion;za["X-Office-Application"]=M.AFrameworkApplication.fa.Ha("Application");za["X-Office-Platform"]="WAC";za["X-TellMe-SessionId"]=C.TellMeActor.instance.ANc();za["X-TellMe-Culture"]=M.AFrameworkApplication.uiCulture;za["X-TellMe-ProcessSessionId"]=
M.AFrameworkApplication.userSessionId;za["Client-Request-Id"]=Ma;const ka=window.performance.now();this.Ei.vj(this.eej(),2,this.fej(ja.Ff,this.rb.application,C.TellMeActor.instance.ANc(),Y.a.cN(ja)),za,!1,0,qa=>{this.Vcb(qa,ja,Z,Ma,ka,D,oa)},qa=>{this.Kcb(qa,ja,Z,Ma,ka)},null,null,!1,4E3,6E3)}fha(){-1!==this.gR&&(window.clearTimeout(this.gR),this.gR=-1)}Vcb(ja,D,pa,Z,oa,Ba,Ma){C.TellMeActor.instance.Jd.l4(D.Ff.length,this.ixc.join(","),ja.data.af.toString(),Math.round(window.performance.now()-oa),
K.a.substrate,!0,v.a.Hra);const za=Y.a.cN(D),ka=new I.a(D);if(Z===this.xH){this.fha();ja=aa.b(ja.data.Zd);if(ja.Groups){ja=ja.Groups;for(const qa of ja)"People"===qa.Type&&this.rb.Olc&&(Ma?Array.contains(Ma,14):1)?(ja=this.Gbg(qa.Suggestions,za,Ba),0<ja.results.length&&ka.us(ja)):"File"===qa.Type&&this.rb.Nlc&&(Ma?Array.contains(Ma,15):1)?(ja=this.n9f(qa.Suggestions,za,Ba),0<ja.results.length&&ka.us(ja)):"Notes"===qa.Type&&this.rb.lSa&&Ba!==h.a.contextMenu&&(Ma?Array.contains(Ma,20):1)&&(ja=this.$ag(qa.Suggestions,
za,D),0<ja.results.length&&ka.us(ja))}pa.resultsUpdated(ka);C.TellMeActor.instance.Jd.l4(D.Ff.length,this.ixc.join(","),"",Math.round(window.performance.now()-oa),"",!0,v.a.provider)}else pa.resultsUpdated(ka)}$ag(ja,D,pa){const Z=new G.a(20);Z.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const oa of ja)this.MPj(oa)&&(ja=oa.NotesType,ja=Q.a.sg(ja),ja=this.m8i(ja,oa.LastModifiedTime,oa.BodyPreview,oa.Subject,D,pa,oa))&&(ja.groupType=20,Z.Fv(ja));return Z}Gbg(ja,D,pa){const Z=new G.a(14);
Z.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const Ba of ja)if(this.NPj(Ba)){var oa=Ba.Id.split("@")[0];ja=Ba.EmailAddresses[0];let Ma=Ba.Type;if(void 0===Ma||null===Ma)Ma="User";if(oa=this.x9i(Ma,Ba.DisplayName,Ba.JobTitle,ja,oa,pa,D))oa.description=ja,ja=Ba.JobTitle,"Department"in Ba&&"CompanyName"in Ba&&(ja+="@"+Ba.Department+"@"+Ba.CompanyName),oa.TGd=ja,Z.Fv(oa)}return Z}n9f(ja,D,pa){const Z=new G.a(15);Z.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ma of ja)if(this.DPj(Ma)){var oa=
Ma.FileName;ja=Ma.FileExtension;const za=oa.length>ja.length?oa.substr(0,oa.length-ja.length-1):Ma.Title;var Ba=void 0;ja=0;"DateCreated"in Ma?(ja=Y.a.D1d(Ma.DateCreated),Ba=Y.a.Peg(Ma.DateCreated),Ba=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ma.Author,Ba)):Ba=Ma.Author;const ka=Ma.AccessUrl+"?web=1",qa=Q.a.a2b(ka);oa=String.format('<a href="{0}">{1}</a>',qa,Q.a.dRa(oa));if(pa!==h.a.contextMenu||Q.a.J7(ka))if(oa=this.R2i(za,pa===h.a.contextMenu?oa:ka,Ba,Ma.FileExtension,Ma.Text,D))oa.description=
Ma.Author,oa.cAc=ja,Z.Fv(oa)}return Z}Kcb(ja,D,pa,Z,oa){Z===this.xH&&(this.fha(),C.TellMeActor.instance.Jd.l4(D.Ff.length,this.ixc.join(","),ja.data.af.toString(),Math.round(window.performance.now()-oa),K.a.substrate,!1,v.a.Hra));ja=new I.a(D);pa.resultsUpdated(ja)}x9i(ja,D,pa,Z,oa,Ba,Ma){Ma=Ma?this.xzf:this.udf;if(!window.LPC&&!Y.a.f8d()||this.KPb===Ma)return null;this.KPb+=1;Ma="PeopleSuggestion"+this.KPb.toString();var za=this.Igf+"?size=1&accountName="+Z;ja=Object.assign(new P.a,{PersonaType:ja,
Smtp:Z,ProfilePictureUrl:za,AadObjectId:oa});const ka=Object.assign(new T.a,{identifiers:ja,displayName:D});ja=Ba===h.a.contextMenu;this.rb.ria?(C.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ma,ka,D,pa)),Ba===h.a.contextMenu&&(pa=Y.a.SSf(D,Z,oa),C.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ma,pa))),C.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ma,ja))):(za=[],za.push(appChrome.actions.setPersonaButtonCoauthor(Ma,
ka,D,pa)),Ba===h.a.contextMenu&&(pa=Y.a.SSf(D,Z,oa),za.push(appChrome.actions.setButtonCommandValueId(Ma,pa))),za.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ma,ja)),appChrome.api.dispatch(za));return new u.a(Ma,11,D,Z,0)}m8i(ja,D,pa,Z,oa,Ba,Ma){if(oa&&!this.rb.Axg||this.puc===this.Stc||this.kPb===this.Stc||this.eMa===this.Stc)return null;var za=null;this.puc+=1;oa="";const ka=[],qa={};Ma.type="Notes";this.Kef=Object.assign(new L.a,{landingTab:"Notes",data:Ma});Ba=Y.a.bOa(Ba.Ff,
33,this.Kef);if("onenotepagepreviews"===ja){if(!("ClickthroughUrl"in Ma&&Ma.ClickthroughUrl)||""===Ma.ClickthroughUrl)return null;this.kPb+=1;oa="OnenoteNotesSuggestion"+this.kPb.toString();qa["default"]="SaveAsonetoc2_20";za=Ma.ClickthroughUrl;ka.push(appChrome.actions.setControlIconSet(oa,qa));ka.push(appChrome.actions.setCompoundButtonCommandValueId(oa,za));za=new u.a(oa,19,null,null,0)}else if("stickynote"===ja){if(!this.hvf)return null;this.eMa+=1;oa="NotesSuggestion"+this.eMa.toString();qa["default"]=
"ShowAllNotes_20";ka.push(appChrome.actions.setControlIconSet(oa,qa));ka.push(appChrome.actions.setCompoundButtonCommandValueId(oa,Ba));za=new u.a(oa,21,null,null,0)}else if("samsung"===ja){if(!this.hvf)return null;this.eMa+=1;oa="NotesSuggestion"+this.eMa.toString();qa["default"]="CategoryCollapsed_20";ka.push(appChrome.actions.setControlIconSet(oa,qa));ka.push(appChrome.actions.setCompoundButtonCommandValueId(oa,Ba));za=new u.a(oa,20,null,null,0)}""!==oa&&(ja=Y.a.Peg(D),ja=String.format(CommonUIStrings.l_LastModifiedString,
ja),za.label=Z,za.cAc=Y.a.D1d(D),ka.push(appChrome.actions.setControlLabel(oa,Z)),ka.push(appChrome.actions.updateCompoundButtonDescription(oa,ja)),ka.push(appChrome.actions.setControlCustomTooltip(oa,pa)),appChrome.api.dispatch(ka));return za}R2i(ja,D,pa,Z,oa,Ba){if(this.wMb===(Ba?this.wzf:this.zwf))return null;this.wMb+=1;Ba="FileSuggestion"+this.wMb.toString();const Ma=[],za={};za["default"]=Y.a.q4i(Z);this.rb.ria?(C.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ba,ja)),C.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(Ba,
za)),C.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ba,pa)),C.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ba,D)),C.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(Ba,oa))):(Ma.push(appChrome.actions.setControlLabel(Ba,ja)),Ma.push(appChrome.actions.setControlIconSet(Ba,za)),Ma.push(appChrome.actions.updateCompoundButtonDescription(Ba,pa)),Ma.push(appChrome.actions.setCompoundButtonCommandValueId(Ba,
D)),Ma.push(appChrome.actions.setControlCustomTooltip(Ba,oa)),appChrome.api.dispatch(Ma));return new u.a(Ba,6,ja,pa,0)}c1d(){const ja=[];this.rb.Olc&&Array.add(ja,"People");this.rb.Nlc&&Array.add(ja,"File");this.rb.lSa&&Array.add(ja,"Notes");return ja}fej(ja,D,pa,Z){var oa=new y(ja);ja=new w("File",oa,0,Z?this.wzf:this.zwf,null);Z=new w("People",oa,0,Z?this.xzf:this.udf,Y.a.Duk);oa=new w("Notes",oa,0,this.Stc,null);D=new A("app",D.toLowerCase());var Ba=[];Array.add(Ba,D);D=new E("tellmesearch",Ba);
Ba=[];this.rb.Nlc&&Array.add(Ba,ja);this.rb.Olc&&Array.add(Ba,Z);this.rb.lSa&&Array.add(Ba,oa);pa=new H(Ba,"UTC",pa,D);return aa.c(pa)}eej(){let ja=this.rb.ail;this.rb.lSa&&(ja+="?&setflight=NotesFrom3S");""!==this.rb.ceg&&(ja=ja+"&"+this.rb.ceg);return ja}NPj(ja){return"DisplayName"in ja&&"Id"in ja&&"EmailAddresses"in ja&&!!ja.Id&&!!ja.EmailAddresses}DPj(ja){return"FileExtension"in ja&&!!ja.FileExtension&&"FileName"in ja&&!!ja.FileName&&""!==ja.FileName&&"AccessUrl"in ja&&!!ja.AccessUrl&&""!==ja.AccessUrl}MPj(ja){return"Id"in
ja&&!!ja.Id&&"NotesType"in ja&&!!ja.NotesType&&"Subject"in ja&&!!ja.Subject&&""!==ja.Subject}}Object(J.a)(ia,"SubstrateResultsProvider",null,[968])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.chronos1.js.map