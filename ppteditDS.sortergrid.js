'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1097:function(J,V,d){d.r(V);J=d(0);var h=d(375),e=d(336),m=d(25),n=d(68),v=d(89),A=d(65),w=d(93),y=d(168),u=d(54),E=d(13),G=d(38),I=d(117),H=d(63),K=d(314),C=d(26);class Y{constructor(){this.slideHeight=this.slideWidth=this.debounceWaitTimeInMs=this.throttleTimeoutInMs=0;this.enableSelectionBetweenSlides=this.enableTriggerSelectionFromActiveSlideChange=this.enableTriggerSelectionFromRightClick=this.enableTriggerSelectionFromDoubleClick=
this.allowSectionEdit=this.allowSectionsInKeyboardFocusOrdering=this.allowMoveSlide=this.allowMultipleSelect=this.isRTL=!1;this.dragDropScrollTimeoutInMs=this.dragDropScrollThresholdInPx=this.sectionTitleMaxLength=0;this.enableRevisionTrackingInfo=!1;this.revisionTrackingFlyoutContent=null;this.shouldDisplayModernCatchupUx=this.shouldRenderAnimationOrTransitionInfo=this.commentsEnabled=this.isDisplayPresenceIcon=!1}}Object(J.a)(Y,"SlideGridSettings",null,[]);var M=d(71),P=d(140),T=d(28);class L{constructor(Ya,
Qb,bb,Bb,Eb,tb){this.gYc=this.VYc=this.WYc=this.HTa=this.tW=this.k3=this.np=null;this.Fl=this.PEa=!1;this.Mg=null;this.b3=-1;this.gyb=this.tyb=!1;this.u9b=this.K_c=0;this.G2c=this.JXc=this.TWc=-1;this.YEa=this.u3=0;this.GEa=!0;this.hEa=0;this.Ywb=null;this.vf=Ya;this.w_=Qb;this.ia=bb;this.eb=Bb;this.Do=Eb;this.$Ta=!1;this.zD=null;this.Et=tb;this.QZj=m.AFrameworkApplication.fa.Ec("PPTCloseGridViewTimeoutMs",500);this.DEg=m.AFrameworkApplication.fa.Ec("PPTGridViewDisplayNoneTimeoutMs",800);this.t1j=
m.AFrameworkApplication.fa.Ec("PPTGridViewTransitionTimeoutMs",500);this.t$a=[];this.kPg=m.AFrameworkApplication.fa.appSettings["1091"]}ub(){this.ia.xa(T.a.$Gb,G.a.application,Object(E.a)(this,this.$Gb,"showGridView"));this.ia.xa(T.a.Xjd,G.a.application,Object(E.a)(this,this.Xjd,"toggleGridView"));this.eb.Jga(Object(E.a)(this,this.Lda,"onSlideshowExitHandler"))}$Gb(Ya,Qb,bb){return 2===bb?this.oLe():32}oLe(){try{const Ya=(new Date).getTime();C.a.J(512308959,822,15,"ShowGridView: Open grid view.");
this.QIb(this.TWc);this.TWc=-1;this.QIb(this.JXc);this.JXc=-1;this.QIb(this.G2c);this.G2c=-1;this.$Ta=!0;this.PEa=this.tyb=this.gyb=!1;const Qb=this.Do.AP();if(!Qb)return C.a.J(512308958,822,10,"ShowGridView: slideOrder is null."),this.ORd(),8;C.a.J(512308957,822,15,"ShowGridView: slideOrder length: {0}.",Qb.length);this.Do.nbh();this.eb.PSb(Object(E.a)(this,this.Gda,"onGetCurrentPositionHandler"));this.GEa=!0;const bb=this.Do.Neg();!this.Ywb||bb.width===this.Ywb.width&&bb.height===this.Ywb.height||
(C.a.J(512308956,822,50,"ShowGridView: thumbnailSize updated, new width: {0}, new height: {1}, old width: {2}, old height: {3}",bb.width,bb.height,this.Ywb.width,this.Ywb.height),this.ORd());if(this.np&&this.np.ya){this.np.keb("pptonline-slideshow-grid-view-transition-class");this.np.ya.style.display=M.a.Rk;this.np.ya.style.opacity="1";this.u3=Date.now();this.Mg.events.onSlideSelectionChanged.subscribe(Object(E.a)(this,this.lHb,"slideSelectionChangeHandler"));this.Mg.events.onVisibleSlideRangeChanged.subscribe(Object(E.a)(this,
this.QJb,"visibleSlideRangeChangedHandler"));let Eb=this.w_.znb(Qb,this.Do.tQa());this.eFd(Eb);this.Mg.slideDataList=Eb;this.Mg.sectionDataList=this.w_.ynb(Eb)}else{this.sxi();v.a.addHandler(this.np.ya,A.a.eg,Object(E.a)(this,this.Az,"keyDownHandler"));this.Et.iZ&&!this.zD&&(this.zD=Object(E.a)(this,this.nVi,"fullScreenChangeHandler"),$addHandler(this.vf,this.Et.iZ,this.zD));let Eb=this.w_.znb(Qb,this.Do.tQa());const tb=this.w_.ynb(Eb);this.Ywb=bb;const Yb=this.d7h(bb);if(!this.Mg){const Tc=new Y;
Tc.throttleTimeoutInMs=1E3;Tc.debounceWaitTimeInMs=200;Tc.allowMultipleSelect=!1;Tc.allowSectionsInKeyboardFocusOrdering=!0;Tc.slideWidth=Yb.width;Tc.slideHeight=Yb.height;Tc.enableSelectionBetweenSlides=!1;Tc.isRTL=m.AFrameworkApplication.isRtl;this.Mg=SlideGrid.SlideGridFactory.CreateSlideGrid(Tc,this.WYc)}this.u3=Date.now();this.Mg.events.onSlideSelectionChanged.subscribe(Object(E.a)(this,this.lHb,"slideSelectionChangeHandler"));this.Mg.events.onVisibleSlideRangeChanged.subscribe(Object(E.a)(this,
this.QJb,"visibleSlideRangeChangedHandler"));this.Mg.show([0],0,Eb,tb);"Modern"==this.eb.u2()&&v.a.addHandler(this.np.ya,A.a.focus,Object(E.a)(this,this.Ckk,"onGridViewContainerDivFocus"))}this.eb.getCurrentPositionWithTimeLines();if(this.kPg)this.ia.Ka(T.a.Ljg,2,null);else if("Modern"==this.eb.u2()){const Eb=document.getElementById("slideshow-toolbar");Eb&&(Eb.style.display=M.a.Sf)}const Bb=document.getElementById("LiveURLBarLayerHost");Bb&&(Bb.style.display=M.a.Sf);this.np.keb("pptonline-slideshow-grid-view-transition-class");
this.np.ya.style.display=M.a.Rk;this.np.ya.style.opacity="1";this.A3a(null);w.FocusManager.Dr(this.np.ya);this.eb.pausePresentation();this.Tmc(!1);this.Do.uCf(Object(E.a)(this,this.aCb,"onDataStoreUpdated"));this.eb.peb(Object(E.a)(this,this.vMe,"slideChangedHandler"));C.a.J(512308955,822,50,"GridViewActor: time taken for ShowGridViewImpl: {0}.",(new Date).getTime()-Ya);return 32}catch(Ya){return C.a.J(512308954,822,10,"GridViewActor: Exception in ShowGridView: {0}.",Ya),this.Ebl(),8}}Xjd(Ya,Qb,bb){try{if(2===
bb)if(C.a.J(512308953,822,15,"ToggleGridView called."),this.$Ta)this.Tmc(!0),this.bAa(!1);else return this.oLe();return 32}catch(Bb){return C.a.J(512308952,822,10,"GridViewActor: Exception in ToggleGridView: {0}.",Bb),8}}d7h(Ya){const Qb=new I.a(0,0);Ya.height&&Ya.width?(Ya=Ya.width/Ya.height,1<=Ya?(Qb.width=247,Qb.height=247/Ya):(Qb.height=247,Qb.width=247*Ya)):(Qb.width=247,Qb.height=247/1.76);return Qb}Gda(Ya,Qb){try{this.eb.oeb(Object(E.a)(this,this.Gda,"onGetCurrentPositionHandler")),this.b3=
Qb.slideIndex,this.eb.dgg(this.b3,Qb.pmc)}catch(bb){C.a.J(512308951,822,10,"Exception in GoToSlideWithTimeLines: {0}.",bb)}try{"Modern"==this.eb.u2()&&this.np&&(this.np.ya.style.display=M.a.Rk);this.np&&w.FocusManager.Dr(this.np.ya);this.hEa=0;const bb=this.Do.AP();if(bb){const Bb=this.w_.znb(bb,this.Do.tQa());this.eFd(Bb);const Eb=this.w_.ynb(Bb);this.Mg.show([this.b3],this.b3,Bb,Eb)}}catch(bb){C.a.J(512308950,822,10,"Exception in OnGetCurrentPositionHandler: {0}.",bb)}}vMe(Ya,Qb){try{if(this.tyb&&
Qb){const bb=Qb.slideIndex;this.b3!==bb||0>this.b3?C.a.J(512308949,822,15,"GridViewActor-SlideChangedHandler: currentSelectedSlideIndex not equal to slideIndex in args. currentSelectedSlideIndex: {0}, slideIndex: {1}.",this.b3,bb):(this.eb.peb(Object(E.a)(this,this.vMe,"slideChangedHandler")),this.eb.xQa(bb),this.u9b=Date.now(),this.mBg(),this.bAa(!0),this.tyb=!1)}}catch(bb){C.a.J(512308948,822,10,"Exception in SlideChangedHandler: {0}.",bb)}}Ckk(){this.Mg&&this.Mg.restoreFocusToGrid()}Az(Ya){try{if(Ya.keyCode===
y.a.aKb)this.Uob(null);else if(Ya.keyCode===y.a.aq){const Qb=this.t$a?this.t$a[this.hEa]:null;!Qb||Qb.className!==this.VYc.className&&Qb.className!==this.gYc.className||this.Uob(null)}else if(Ya.keyCode===y.a.Lhb&&!this.Et.I7)this.$Ta&&("Legacy"==this.eb.u2()?this.eb.bKc():this.eb.exit(),this.bAa(!1));else if(Ya.keyCode===y.a.Bq)Ya.preventDefault(),Ya.stopPropagation();else if(Ya.keyCode===y.a.iE)this.Mg.activeFocusSlideIndex=0;else if(Ya.keyCode===y.a.tw){const Qb=this.Do.AP();Qb&&0<Qb.length&&(this.Mg.activeFocusSlideIndex=
Qb.length-1)}Ya.ctrlKey&&Ya.keyCode===y.a.H0&&((this.hEa=Ya.shiftKey?Math.abs((this.hEa-1)%this.t$a.length):(this.hEa+1)%this.t$a.length)?0<this.hEa?w.FocusManager.Dr(this.t$a[this.hEa]):C.a.J(512308947,822,15,"GridViewActor: wrong focus index value: {0}.",this.hEa):this.Mg.restoreFocusToGrid())}catch(Qb){C.a.J(512308946,822,10,"GridViewActor: Exception in KeyDownHandler : {0}.",Qb)}}aCb(Ya,Qb){try{const Bb=this.Do.AP();if(Bb){var bb=this.w_.znb(Bb,this.Do.tQa());this.eFd(bb);this.Mg.slideDataList=
bb;this.Mg.sectionDataList=this.w_.ynb(bb);if(Qb.SlideIndex){const Eb=Qb.SlideIndex;-1!==Eb&&(0<=Eb&&Eb<Bb.length?this.A3a(Bb[Eb]):C.a.J(512308944,822,10,"OnDataStoreUpdated: slideIndex is invalid: {0}.",Eb))}else C.a.J(512308943,822,10,"OnDataStoreUpdated: SlideIndex is null from eventData.")}else C.a.J(512308945,822,10,"OnDataStoreUpdated: slideOrder is null.")}catch(Bb){C.a.J(512308942,822,10,"Exception in OnDataStoreUpdated: {0}.",Bb)}}A3a(Ya){try{const Qb=this.Mg.visibleSlideRange;let bb=!1;
if(Ya)for(const Bb of Qb){if(Bb.slideSid===Ya.sid){bb=!0;break}}else bb=!0;if(bb){Ya=!0;for(const Bb of Qb)for(const Eb of this.Mg.slideDataList)if(Eb.slideID.slideSid===Bb.slideSid&&Eb.slideID.slideCid===Bb.slideCid&&!Eb.thumbnailImage){Ya=!1;break}Ya&&0<this.u3&&(this.YEa=Date.now(),C.a.J(512308941,822,15,"VisibleSlideRangePLT - firstVisibleRangePLTCalc: {0}, visibleSlideLength: {1}, startTime: {2}, endTime: {3}, elapse: {4}.",this.GEa,Qb.length,this.u3,this.YEa,this.YEa-this.u3),this.GEa&&(this.GEa=
!1),this.YEa=this.u3=0)}}catch(Qb){C.a.J(512308940,822,10,"Exception in CheckAndLogVisibleSlideRangePLT: {0}.",Qb)}}lHb(Ya,Qb){try{this.K_c=Date.now();const Eb=Qb.slideIndex;C.a.J(512308939,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex: {0}.",Eb);if(0>this.b3)C.a.J(512308938,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong currentSelectedSlideIndex: {0}.",this.b3);else{var bb=this.Do.AP();if(!bb||0>=bb.length)C.a.J(512308937,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong slideOrder.");
else{var Bb=this.b3===bb.length-1;this.b3!==Eb||Bb?(this.eb.PMa(Object(E.a)(this,this.vMe,"slideChangedHandler")),this.b3=Eb,this.tyb=!0,this.Tmc(!0),0<=Eb&&this.eb.xQa(Eb),this.QIb(this.TWc),this.TWc=window.setTimeout(()=>{try{this.$Ta&&this.tyb&&this.bAa(!0)}catch(tb){C.a.J(512308935,822,10,"GridViewActor: Exception in closeGridViewTimeoutHandler: {0}.",tb)}},this.QZj)):(C.a.J(512308936,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex is the same to currentSelectedSlideIndex: {0}",
this.b3),this.tyb||(this.Tmc(!0),this.u9b=Date.now(),this.mBg(),this.bAa(!0)))}}}catch(Eb){C.a.J(512308934,822,10,"GridViewActor: Exception in SlideSelectionChangeHandler: {0}.",Eb)}}Tmc(Ya){this.eb?(this.eb.wmc(Ya),Ya&&!this.PEa&&(u.a.xj||document.activeElement.blur(),this.eb.restoreFocus())):C.a.J(512308933,822,10,"GridViewActor: m_frame is null in TryToggleSlideShowFrame.")}QJb(){try{this.u3=Date.now();this.A3a(null);const Ya=this.Mg.visibleSlideRange,Qb=[];for(const bb of Ya)Qb.push(new H.a(Object.assign(new K.a,
{Cid:bb.slideCid,Sid:bb.slideSid})));this.Do.ffh(Qb)}catch(Ya){C.a.J(512308932,822,10,"GridViewActor: Exception in VisibleSlideRangeChangedHandler: {0}.",Ya)}}eFd(Ya){if(Ya)for(const Qb of Ya)Qb.slideAriaLabel=Qb.slideTitle,Qb.isHiddenSlide&&(Qb.slideAriaLabel+=", "+ResourceStrings.l_SlideIsHidden),Qb.slideAriaLabel+=" "+ResourceStrings.l_GridView_GridThumbnailTitle}sxi(){this.np=new P.a;this.t$a.push(this.np.ya);this.WYc=document.createElement("div");this.np.ya.appendChild(this.WYc);this.np.ya.setAttribute("tabindex",
"0");this.np.ya.setAttribute("aria-label",ResourceStrings.L_GridView_GridContainerTitle);this.VYc||(this.VYc=this.SRf());this.np.ya.appendChild(this.VYc);this.np.ya.id="pptonline-slideshow-grid-view-id";this.np.ya.className="pptonline-slideshow-grid-view-class";this.WYc.className="pptonline-slideshow-grid-view-inner-container-class";this.vf.appendChild(this.np.ya);this.np.ya.style.width="100%";this.np.ya.style.height="100%";this.np.keb("pptonline-slideshow-grid-view-transition-class");this.np.ya.style.display=
M.a.Rk;this.np.ya.style.opacity="1"}SRf(){const Ya=document.createElement("div");this.t$a.push(Ya);var Qb=m.AFrameworkApplication.isRtl;Ya.setAttribute("role","button");Ya.className=Qb?"pptonline-slideshow-grid-view-close-button-class rtl-ui":"pptonline-slideshow-grid-view-close-button-class";Ya.setAttribute("tabindex","0");Qb=document.createElement("i");Qb.className="ms-Icon ms-Icon--Back";Ya.appendChild(Qb);Ya.title=ResourceStrings.L_GridView_CloseButtonNewText;Ya.setAttribute("aria-label",ResourceStrings.L_GridView_CloseButtonNewText);
v.a.addHandler(Ya,A.a.click,Object(E.a)(this,this.Uob,"closeButtonClickHandler"));return Ya}bAa(Ya){try{if(C.a.J(512308931,822,50,"GridViewActor: CloseGridView called."),this.gyb)C.a.J(512308930,822,15,"GridViewActor: GridView is in closing status.");else if(this.np){this.gyb=!0;this.Do.URe();this.Do.Rch(Object(E.a)(this,this.aCb,"onDataStoreUpdated"));this.np.ot("pptonline-slideshow-grid-view-transition-class");this.k3&&(this.k3.ya.style.display=M.a.Sf);Ya?(this.QIb(this.G2c),this.QIb(this.JXc),
this.G2c=window.setTimeout(()=>{try{this.np.ya.style.opacity="0",this.$Ta=!1}catch(bb){C.a.J(512308929,822,10,"Exception in setZeroOpacityHandler: {0}.",bb)}},this.DEg-this.t1j),this.JXc=window.setTimeout(()=>{try{this.gyb=!1,this.np.ya.style.display=M.a.Sf}catch(bb){C.a.J(512308928,822,10,"Exception in displayNoneTimeoutHandler: {0}.",bb)}},this.DEg)):(this.np.ya.style.opacity="0",this.gyb=this.$Ta=!1,this.np.ya.style.display=M.a.Sf);this.Mg&&(this.Mg.events.onSlideSelectionChanged.unsubscribe(Object(E.a)(this,
this.lHb,"slideSelectionChangeHandler")),this.Mg.events.onVisibleSlideRangeChanged.unsubscribe(Object(E.a)(this,this.QJb,"visibleSlideRangeChangedHandler")));this.kPg&&this.ia.Ka(T.a.Tph,2,null);var Qb=document.getElementById("LiveURLBarLayerHost");Qb&&(Qb.style.display=M.a.Rk)}}catch(bb){C.a.J(512308899,822,10,"GridViewActor: Exception in CloseGridView: {0}.",bb),this.gyb=!1}}Ebl(){try{if(!this.k3){this.k3=new P.a;this.tW=new P.a;this.gYc||(this.gYc=this.SRf());this.k3.ya.appendChild(this.gYc);this.k3.ya.appendChild(this.tW.ya);
this.tW.ot("pptonline-slideshow-grid-view-error-ui-inner");const Ya=document.createElement("div"),Qb=document.createElement("span");Qb.innerText=ResourceStrings.L_GridView_TryAgainError;Ya.setAttribute("tabindex","0");Ya.className="pptonline-slideshow-grid-view-error-ui-message";Ya.appendChild(Qb);this.tW.ya.appendChild(Ya);const bb=document.createElement("div"),Bb=document.createElement("span");Bb.innerText=ResourceStrings.L_GridView_TryAgainButton;bb.setAttribute("tabindex","0");bb.className="pptonline-slideshow-grid-view-try-again-button";
bb.appendChild(Bb);this.tW.ya.appendChild(bb);v.a.addHandler(bb,A.a.click,Object(E.a)(this,this.XQe,"tryAgainButtonClickHandler"));if(this.vf)this.vf.appendChild(this.k3.ya);else{this.k3=null;return}this.k3.ya.setAttribute("tabindex","0");this.k3.ot("pptonline-slideshow-grid-view-error-ui-class");this.k3.ot("pptonline-slideshow-grid-view-class")}this.tW.ya.style.display=M.a.Rk;this.k3.ya.style.display="flex";v.a.addHandler(this.np.ya,A.a.eg,Object(E.a)(this,this.Az,"keyDownHandler"));w.FocusManager.Dr(this.np.ya)}catch(Ya){C.a.J(512308898,
822,10,"Exception in ShowGridViewErrorUI: {0}.",Ya)}}JLe(){if(!this.HTa){this.HTa=new P.a;this.HTa.ot("grid-view-spinner-class");const Ya=document.createElement("div");Ya.className="grid-view-spinner-inner-class";this.HTa.ya.appendChild(Ya);if(this.vf)this.vf.appendChild(this.HTa.ya);else{this.HTa=null;return}}this.HTa.ya.style.display="flex"}XQe(){try{this.JLe(),this.tW.ya.style.display=M.a.Sf,window.setTimeout(()=>{this.k3&&(this.k3.ya.style.display=M.a.Sf);this.HTa.ya.style.display=M.a.Sf;this.oLe()},
1E3)}catch(Ya){C.a.J(512308897,822,10,"Exception in TryAgainButtonClickHandler: {0}.",Ya)}}QIb(Ya){0<=Ya&&window.clearTimeout(Ya)}Lda(){try{this.PEa=!0,this.eb.fea(Object(E.a)(this,this.Lda,"onSlideshowExitHandler")),this.$Ta&&("Legacy"==this.eb.u2()&&this.eb.bKc(),this.bAa(!1))}catch(Ya){C.a.J(512308896,822,10,"GridViewActor: Exception in OnSlideshowExitHandler: {0}.",Ya)}}nVi(){try{this.$Ta&&("Legacy"==this.eb.u2()&&this.eb.bKc(),this.bAa(!1))}catch(Ya){C.a.J(512308895,822,10,"GridViewActor: Exception in FullScreenChangeHandler: {0}.",
Ya)}}Uob(){try{this.Tmc(!0),this.bAa(!1)}catch(Ya){C.a.J(512308894,822,10,"GridViewActor: Exception in CloseButtonClickHandler: {0}.",Ya)}}mBg(){C.a.J(512308893,822,15,"GridViewActor: selectedSlideIndex: {0}, selectedTime: {1}, showTime: {2}, elapse: {3}",this.b3,this.K_c,this.u9b,this.u9b-this.K_c);this.u9b=this.K_c=0}dispose(){try{this.Fl||(this.Fl=!0,this.bAa(!1),this.eb.fea(Object(E.a)(this,this.Lda,"onSlideshowExitHandler")),this.Et.iZ&&this.zD&&$removeHandler(this.vf,this.Et.iZ,this.zD),this.ORd())}catch(Ya){C.a.J(512308892,
822,10,"GridViewActor: Exception in Dispose: {0}.",Ya)}}ORd(){C.a.J(512308891,822,50,"GridViewActor: DisposeSlideGridComponentIfExist.");this.np&&(v.a.removeHandler(this.np.ya,A.a.eg,Object(E.a)(this,this.Az,"keyDownHandler")),this.vf.removeChild(this.np.ya),this.np=null);this.Mg&&(this.Mg=null)}}Object(J.a)(L,"GridViewActor",null,[498,106]);var aa=d(45);class Q{constructor(){this.presenceUser=this.slideID=null}}Object(J.a)(Q,"PresenceInfo",null,[]);class ea{constructor(){this.color=this.initials=
this.userName=null}}Object(J.a)(ea,"PresenceUser",null,[]);class ia{constructor(){this.sectionTitle=null;this.sectionIndex=0;this.slideIdList=null}}Object(J.a)(ia,"SectionData",null,[]);class ja{constructor(){this.slideID=null;this.sectionIndex=this.slideOrderIndex=0;this.thumbnailImage=null;this.isHiddenSlide=!1;this.slideAriaLabel=this.slideTitle=null;this.hasUnreadChanges=!1;this.numComments=0;this.hasTransitionOrAnimation=!1}}Object(J.a)(ja,"SlideData",null,[]);class D{constructor(){this.slideSid=
this.slideCid=0}}Object(J.a)(D,"SlideID",null,[]);class pa{constructor(Ya){this.Do=Ya}AGf(Ya){const Qb=[];for(const bb of Ya)bb.presenceUser&&(Ya=Object.assign(new Q,{slideID:Object.assign(new D,{slideSid:bb.Mj.sid,slideCid:bb.Mj.cid}),presenceUser:Object.assign(new ea,{userName:bb.userName,initials:aa.a.pZd(bb.userName,m.AFrameworkApplication.isRtl),color:bb.presenceUser.color})}),Qb.push(Ya));return Qb}znb(Ya,Qb){const bb=[];for(let Eb=0;Eb<Ya.length;Eb++){var Bb=Qb?Qb[Ya[Eb].sid.toString()]:null;
const tb=Bb?Bb.Ijd+", "+String.format(ResourceStrings.L_GridView_SlideSelectionNarratorTitle,Eb+1,Ya.length):String.format(ResourceStrings.L_GridView_SlideSelectionNarratorTitle,Eb+1,Ya.length),Yb=this.Jei(tb,Bb);Bb=Object.assign(new ja,{slideID:Object.assign(new D,{slideCid:Ya[Eb].cid,slideSid:Ya[Eb].sid}),slideOrderIndex:Eb,sectionIndex:this.Do.t2(Ya[Eb]),thumbnailImage:Bb?Bb.thumbnailImage:"",isHiddenSlide:Bb?Bb.isHiddenSlide:!1,slideTitle:tb,hasUnreadChanges:Bb?Bb.hasUnreadChanges:!1,numComments:Bb?
Bb.numComments:0,hasTransitionOrAnimation:Bb?Bb.hasTransitionOrAnimation:!1,slideAriaLabel:Yb});bb.push(Bb)}return bb}ynb(Ya){const Qb=this.Do.oQa();return Qb&&0<Qb.length?this.aAi(Qb):this.uwi(Ya)}Jei(Ya,Qb){const bb=new Sys.StringBuilder;Ya&&""!==Ya&&bb.append(Ya);Qb&&Qb.hasUnreadChanges&&bb.append(", "+ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);Qb&&0<Qb.numComments&&(1===Qb.numComments?bb.append(", "+String.format(ResourceStrings.l_SlideHasSingleCommentWithCount,Qb.numComments)):
bb.append(", "+String.format(ResourceStrings.l_SlideHasMultipleCommentsWithCounts,Qb.numComments)));Qb&&Qb.hasTransitionOrAnimation&&bb.append(", "+ResourceStrings.l_SlideHasAnimationOrTransition);return bb.toString()}aAi(Ya){const Qb=[];for(let Bb=0;Bb<Ya.length;Bb++){var bb=[];for(const Eb of Ya[Bb].SlideIds)bb.push(Object.assign(new D,{slideCid:Eb.Cid,slideSid:Eb.Sid}));bb=Object.assign(new ia,{sectionIndex:Bb,slideIdList:bb,sectionTitle:Ya[Bb].Title});Qb.push(bb)}C.a.J(537012227,822,50,String.format("SlideGridHelper::CreateSectionListItems, sections count:{0}",
Qb.length));return Qb}uwi(Ya){const Qb=[],bb=Object.assign(new ia,{sectionTitle:"",sectionIndex:0,slideIdList:[]});for(const Bb of Ya)bb.slideIdList.push(Bb.slideID);Qb.push(bb);C.a.J(537012228,822,50,"SlideGridHelper: Created default section");return Qb}}Object(J.a)(pa,"SlideGridHelper",null,[468]);var Z=d(283),oa=d(62),Ba=d(1035),Ma=d(177),za=d(1158),ka=d(201);class qa{constructor(Ya,Qb,bb,Bb,Eb=null){this.i9d=Ya;this.vda=Qb;this.acc=bb;this.sectionIndex=Bb;this.Ba=Eb}}Object(J.a)(qa,"SlideMoveByIdData",
null,[]);class Ja{constructor(Ya,Qb){this.sectionIndex=Ya;this.kxl=Qb}}Object(J.a)(Ja,"UpdateSectionData",null,[]);var xa=d(369),Ga=d(40),na=d(205),sa=d(46),Ha=d(318),cb=d(320),Za=d(332);class va{constructor(Ya,Qb,bb,Bb,Eb,tb,Yb,Tc,ib,Zb,Cc,ob,cc,sb,mb,Pb,dc,mc,Mb,Kc,gc){this.Pka=this.tW=this.mL=this.d9=this.fW=this.uq=null;this.X9a=0;this.eHg=this.$Jg=this.Fl=!1;this.Mg=null;this.Kqe=!1;this.YEa=this.u3=0;this.GEa=!0;this.vf=Ya;this.w_=Qb;this.ia=bb;this.Do=Bb;this.ra=Eb;this.Yb=tb;this.yc=Yb;this.Qb=
Tc;this.Qc=ib;this.ta=Zb;this.Lg=Cc;this.fh=ob;this.Fa=cc;this.yD=sb;this.OG=mb;this.fe=Pb;this.xbb=[];this.hc=dc;this.Mc=mc;this.ED=Kc;this.TMg=Mb;this.TMg.P2a(Object(E.a)(this,this.G_,"onSlidePresenceChanged"));if(this.Sta=gc)this.shd(!0,!0),this.isj()}ub(){this.ia.pa(T.a.aEe,G.a.application,Object(E.a)(this,this.loj,"handleRenameSection"),4);this.ia.pa(T.a.NQe,G.a.application,Object(E.a)(this,this.Dpj,"handleTriggerRenameSection"),4);this.ia.pa(T.a.Bed,G.a.application,Object(E.a)(this,this.Ioj,
"handleSelectSectionAndSlides"),4)}pYa(Ya,Qb,bb){return 2===bb?((Ya=e.a.instance)&&!this.eHg&&Ya.ic("SlideGridFirstOpenSorterView",Date.now()),this.eHg=!0,this.Qc.RD(new na.a(2)),Ya=this.shd(!1),m.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")&&m.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesIsEnabled")||this.ia.processAction(T.a.nVb,2),Ya):32}shd(Ya,Qb=!1){try{if(1===this.Qb.Nu&&!Ya)return C.a.J(512254407,822,50,"ShowSorterView: already in sorter view."),32;this.Sta?Qb||(this.Qb.Nu=
1):this.Qb.Nu=1;C.a.J(512254406,822,15,"ShowSorterView: Open sorter view.");this.uq||(this.JAi(),v.a.addHandler(this.uq.ya,A.a.eg,Object(E.a)(this,this.Az,"keyDownHandler")),this.l7k(),Z.a.instance.ob(this.uq.ya,Object(E.a)(this,this.zB,"contextMenuHandler")));this.Mg?this.$Jg!==this.hc.ln&&this.yah():this.XSf();var bb=Object(za.a)(123,this.ta.Ba);if(!bb)return C.a.J(512254405,822,50,"ShowSorterView: active slideNode is null."),this.yph(),32;const Bb=this.ra.mf();Bb&&Bb.length||C.a.J(512254404,822,
50,"ShowSorterView: no selected slide nodes");this.Fa.Gj(sa.a.Dea,!0);this.Do.nbh();this.Lg.WJ(Object(E.a)(this,this.iC,"onActiveSlideChanged"));this.GEa=!0;const Eb=this.Do.AP();C.a.J(512254403,822,15,"ShowSorterView: slideOrder length: {0}.",Eb?Eb.length:-1);this.uq.ya.style.display=M.a.Rk;this.d9.style.display=M.a.Rk;this.Sta&&(this.uq.ya.style.width=this.Qsb());const tb=bb.slideIndex,Yb=ka.b(Bb,ib=>ib.slideIndex);Ya={};Ya.SlideNode=bb;try{this.ia.Ka(T.a.CRg,2,Ya)}catch(ib){C.a.J(512254402,804,
15,String.format("ShowSorterView: Exception thrown while dismissing revision tracking changes for active slide. Exception Message - {0}",ib.message))}this.Cqh(Yb,tb,Eb);bb=[];this.ED.instance?bb=this.ED.instance.i2():C.a.J(512254401,804,50,"ShowSorterViewImp: PresenceManager is null");this.Mg.presenceInfoList=this.w_.AGf(bb);const Tc=this.ta.presentation;this.Mg.shouldDisplaySections=!(!Tc||!Tc.zp||!Tc.zp.length);this.fW&&(this.fW.ya.style.display=M.a.Sf);this.A3a(null);this.Do.uCf(Object(E.a)(this,
this.aCb,"onDataStoreUpdated"));this.Mc.Mga(Object(E.a)(this,this.Vz,"onUnifiedAppStateChanged"));return 32}catch(Bb){return C.a.J(512254400,822,10,"SorterViewActor: Exception in ShowSorterView: {0}.",Bb),this.Wcl(),8}}XSf(){var Ya=this.Do.Neg();Ya=this.e7h(Ya);if(!this.Mg){const Qb=new Y;Qb.throttleTimeoutInMs=1E3;Qb.debounceWaitTimeInMs=200;Qb.slideWidth=Ya.width;Qb.slideHeight=Ya.height;Qb.isRTL=m.AFrameworkApplication.isRtl;Qb.allowMultipleSelect=!0;Qb.allowMoveSlide=this.hc.ln;Qb.allowSectionsInKeyboardFocusOrdering=
!0;Qb.allowSectionEdit=this.hc.ln;Qb.enableSelectionBetweenSlides=!0;Qb.enableTriggerSelectionFromDoubleClick=!0;Qb.enableTriggerSelectionFromRightClick=!0;Qb.enableTriggerSelectionFromActiveSlideChange=!0;Qb.sectionTitleMaxLength=m.AFrameworkApplication.fa.Ec("PptSorterViewSectionTitleMaxLength",100);Qb.dragDropScrollThresholdInPx=150;Qb.dragDropScrollTimeoutInMs=100;Qb.enableRevisionTrackingInfo=!0;Qb.revisionTrackingFlyoutContent=ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes;Qb.isDisplayPresenceIcon=
!0;Qb.shouldRenderAnimationOrTransitionInfo=!0;Qb.commentsEnabled=!0;Qb.shouldDisplayModernCatchupUx=m.AFrameworkApplication.fa.ka("1166");this.Mg=SlideGrid.SlideGridFactory.CreateSlideGrid(Qb,this.d9);this.$Jg=this.hc.ln}}Cqh(Ya,Qb,bb){this.u3=Date.now();this.Mg.selectedSlideIndexes=Ya;this.Mg.activeFocusSlideIndex=Qb;this.Mg.events.onSlideSelectionChanged.subscribe(Object(E.a)(this,this.lHb,"slideSelectionChangeHandler"));this.Mg.events.onVisibleSlideRangeChanged.subscribe(Object(E.a)(this,this.QJb,
"visibleSlideRangeChangedHandler"));this.Mg.events.onMoveSlide.subscribe(Object(E.a)(this,this.DTg,"moveSlideHandler"));this.Mg.events.onSectionTitleUpdate.subscribe(Object(E.a)(this,this.Dih,"sectionTitleUpdateHandler"));this.Mg.events.onSectionSelectionChanged.subscribe(Object(E.a)(this,this.Cih,"sectionSelectionChangedHandler"));this.Mg.events.onActiveSectionFocusChanged.subscribe(Object(E.a)(this,this.zih,"sectionFocusChangedHandler"));this.Mg.events.onInsertBetweenSlidesPositionChanged.subscribe(Object(E.a)(this,
this.Yyj,"insertBetweenSlidesPositionChangedHandler"));bb=this.w_.znb(bb,this.Do.tQa());const Bb=this.w_.ynb(bb);this.Mg.show(Ya,Qb,bb,Bb)}Wcl(){try{this.mL||this.KAi(),this.uq&&(this.uq.ya.style.display=M.a.Rk),this.d9&&(this.d9.style.display=M.a.Sf),this.X9a=0,this.mL.ya.style.display="flex",this.tW.ya.style.display=M.a.Rk,w.FocusManager.Dr(this.mL.ya),this.Fa.Gj(sa.a.Dea,!0)}catch(Ya){C.a.J(512254371,822,10,"Exception in ShowSorterViewErrorUI: {0}.",Ya)}}KAi(){this.mL=new P.a;this.tW=new P.a;this.mL.ya.appendChild(this.tW.ya);
this.mL.ya.setAttribute("tabindex","0");this.mL.ya.setAttribute("aria-label",ResourceStrings.L_SlideSorter);this.tW.ot("pptonline-sorter-view-error-ui-inner-class");var Ya=document.createElement("div");Ya.className="pptonline-sorter-view-error-ui-image-container-class";var Qb=document.createElement("img");Qb.src=this.fe.Yj("SlideSorterViewErrorIllustration.svg");Ya.appendChild(Qb);this.tW.ya.appendChild(Ya);Ya=document.createElement("div");Qb=document.createElement("span");Qb.innerText=ResourceStrings.l_SlideSorterViewErrorPageTitle;
Ya.setAttribute("tabindex","0");Ya.className="pptonline-sorter-view-error-ui-title-class";Ya.setAttribute("aria-label",ResourceStrings.l_SlideSorterViewErrorPageTitle);Ya.appendChild(Qb);this.tW.ya.appendChild(Ya);Qb=document.createElement("div");var bb=document.createElement("span");bb.innerText=ResourceStrings.l_SlideSorterViewErrorPageText;Qb.setAttribute("tabindex","0");Qb.setAttribute("aria-label",ResourceStrings.l_SlideSorterViewErrorPageText);Qb.className="pptonline-sorter-view-error-ui-message-class";
Qb.appendChild(bb);this.tW.ya.appendChild(Qb);bb=document.createElement("div");const Bb=document.createElement("button");Bb.className="pptonline-sorter-view-try-again-button-class";const Eb=document.createElement("span");Eb.innerText=ResourceStrings.l_SlideSorterViewTryAgainText;bb.className="pptonline-sorter-view-try-again-button-container-class";Bb.setAttribute("aria-label",ResourceStrings.l_SlideSorterViewTryAgainText);Bb.appendChild(Eb);bb.appendChild(Bb);this.tW.ya.appendChild(bb);v.a.addHandler(Bb,
A.a.click,Object(E.a)(this,this.XQe,"tryAgainButtonClickHandler"));this.uq?(this.uq.ya.appendChild(this.mL.ya),this.mL.ya.setAttribute("tabindex","0"),this.mL.ot("pptonline-sorter-view-error-ui-class"),this.mL.ot("pptonline-sorter-view-class"),this.xbb.push(this.mL.ya),this.xbb.push(Ya),this.xbb.push(Qb),this.xbb.push(Bb)):(C.a.J(512254370,822,10,"SoterViweActor::ShowSorterViewErrorUI - no parent container."),this.mL=null)}JLe(){if(!this.Pka){this.Pka=new P.a;this.Pka.ot("pptonline-sorter-view-spinner-class");
const Ya=document.createElement("div");Ya.className="pptonline-sorter-view-spinner-inner-class";this.Pka.ya.appendChild(Ya);if(this.uq)this.uq.ya.appendChild(this.Pka.ya);else{this.Pka=null;C.a.J(512254369,822,10,"SoterViweActor::ShowLoadingSpinner - no parent container.");return}}this.Pka.ya.style.display="flex"}XQe(Ya){try{Ya.preventDefault(),this.mL.ya.style.display=M.a.Sf,this.JLe(),window.setTimeout(()=>{this.Pka&&(this.Pka.ya.style.display=M.a.Sf);this.shd(!0)},1E3)}catch(Qb){C.a.J(512254368,
822,10,"Exception in TryAgainButtonClickHandler: {0}.",Qb)}}l7k(){this.yD.v7(sa.a.Dea,sa.a.gj,this.uq.ya,()=>{this.Mg&&this.Mg.restoreFocusToGrid()},()=>{this.uq&&this.uq.keb("pptonline-sorter-view-f6focus-class")});this.fh.gGb(sa.a.Dea,()=>{this.uq&&this.uq.ot("pptonline-sorter-view-f6focus-class")})}Vz(Ya,Qb){if(Qb.a8a){C.a.J(512254367,822,50,"SorterViewActor: Re-loading slide grid on editing mode changed");this.yah();Ya=this.Do.AP();Qb=this.ta.Ba.slideIndex;const bb=ka.b(this.ra.mf(),Bb=>Bb.slideIndex);
1===this.Qb.Nu&&(this.Cqh(bb,Qb,Ya),Ya=this.ta.presentation,this.Mg.shouldDisplaySections=!(!Ya||!Ya.zp||!Ya.zp.length))}}yah(){this.Mg=null;this.d9&&this.d9.firstChild&&this.d9.removeChild(this.d9.firstChild);this.XSf()}e7h(Ya){const Qb=new I.a(0,0);Ya.height&&Ya.width?(Ya=Ya.width/Ya.height,1<=Ya?(Qb.width=247,Qb.height=247/Ya):(Qb.height=247,Qb.width=247*Ya)):(Qb.width=247,Qb.height=247/1.76);return Qb}iC(Ya,Qb){try{if(Qb.ila){Qb.ila.dN&&this.aCb(null,{SlideIndex:-1});var bb=this.Do.oQa(),Bb=this.ta.oA;
if(-1===Bb||bb[Bb].SlideIds.length)if(this.Kqe)this.Kqe=!1;else{this.Mg.activeFocusSlideIndex=Qb.ila.De;const Eb=this.ra.mf();if(Eb){const tb=ka.b(Eb,Yb=>Yb.slideIndex);this.Mg.selectedSlideIndexes=tb}else C.a.J(512254365,822,15,"SorterViewActor::OnActiveSlideChanged - selectedSlideNodes is null.");this.Mg.insertBetweenSlideIndex=-1}else this.Mg.insertBetweenSlideIndex=-1}else C.a.J(512254366,822,50,"SorterViewActor::OnActiveSlideChanged - active slide was null. CorrelationId")}catch(Eb){C.a.J(512254364,
822,10,"SorterViewActor::OnActiveSlideChanged Exception: {0}.",Eb)}}G_(Ya,Qb){C.a.J(512254363,822,50,"OnSlidePresenceChanged: Add/Remove Presence User for slideID {0}",Qb.slideId);Ya=[];this.ED.instance?Ya=this.ED.instance.i2():C.a.J(512254362,804,50,"OnSlidePresenceChanged: PresenceManager is null");this.Mg&&(this.Mg.presenceInfoList=this.w_.AGf(Ya))}aCb(Ya,Qb){try{const Eb=this.Do.AP();if(Eb)if(Eb.length){var bb=this.ta.presentation,Bb=this.w_.znb(Eb,this.Do.tQa());this.Mg.slideDataList=Bb;this.Mg.sectionDataList=
this.w_.ynb(Bb);this.Mg.shouldDisplaySections=!(!bb||!bb.zp||!bb.zp.length);Ya=!1;try{Ya="Number"===Object.getType(Qb.SlideIndex).getName()}catch(tb){C.a.J(512254359,822,10,"OnDataStoreUpdated: SlideIndex is null from eventData.",tb)}if(Ya){const tb=Qb.SlideIndex;-1!==tb&&(0<=tb&&tb<Eb.length?this.A3a(Eb[tb]):C.a.J(512254358,822,10,"OnDataStoreUpdated: slideIndex is out of range: {0}.",tb))}}else C.a.J(512254360,822,50,"OnDataStoreUpdated: ShowAddFirstSlidePane since slideOrder length is 0."),this.yph();
else C.a.J(512254361,822,10,"OnDataStoreUpdated: slideOrder is null.")}catch(Eb){C.a.J(512254357,822,10,"Exception in OnDataStoreUpdated: {0}.",Eb)}}zB(Ya){let Qb=8;try{if(this.fW&&this.fW.ya.style.display!==M.a.Sf||this.mL&&this.mL.ya.style.display!==M.a.Sf)return!0;if(Ya.clientPoint&&"NaN"!==Ya.clientPoint.x.toString()&&"NaN"!==Ya.clientPoint.y.toString()){const bb=oa.a.PPa(Ya.clientPoint),Bb=RegExp("edit-title"),Eb=RegExp("title-input"),tb=RegExp("content-image-view");if(!bb.className.length&&
void 0!==bb.parentNode&&null!==bb.parentNode&&0<bb.parentNode.className.search(tb))Qb=this.ia.Ka(T.a.PNd,2,Ya);else if(0<bb.className.search(Bb)||0<bb.className.search(Eb)){let Yb=this.PSf(Ya);Qb=this.ia.Ka(T.a.MNd,2,Yb)}else Qb=this.ia.Ka(T.a.hQf,2,Ya)}else if(Ya.clientPoint.x=oa.a.yKc(this.uq.ya),Ya.clientPoint.y=oa.a.zKc(this.uq.ya),0<=this.ta.oA){let bb=this.PSf(Ya);Qb=this.ia.Ka(T.a.MNd,2,bb)}else this.ra.mf()&&0<this.ra.mf().length&&(Qb=this.ia.Ka(T.a.PNd,2,Ya))}catch(bb){C.a.J(512254356,822,
10,"Exception in ContextMenuHandler: {0}.",bb),Qb=8}return 32===Qb}yph(){try{if(this.uq){this.uq.ya.style.display=M.a.Rk;this.d9.style.display=M.a.Sf;if(!this.fW){const Ya=m.AFrameworkApplication.isRtl;this.fW=new P.a;this.fW.ya.className=Ya?"pptonline-sorter-view-add-first-slide-container-class rtl-ui":"pptonline-sorter-view-add-first-slide-container-class";this.fW.ya.title=ResourceStrings.l_ClickToAddSlide;this.fW.ya.setAttribute("aria-label",ResourceStrings.l_ClickToAddSlide);this.fW.ya.setAttribute("tabindex",
"0");const Qb=document.createElement("span");Qb.innerText=ResourceStrings.l_ClickToAddSlide;this.fW.ya.appendChild(Qb);this.uq.ya.appendChild(this.fW.ya);v.a.addHandler(this.fW.ya,A.a.click,Object(E.a)(this,this.n_h,"addFirstSlidePaneClickHandler"))}this.fW.ya.style.display=M.a.Rk;this.fW.ya.focus()}else C.a.J(512254355,822,10,"ShowAddFirstSlidePane: no sorter view container.")}catch(Ya){C.a.J(512254354,822,10,"Exception in ShowAddFirstSlidePane: {0}.",Ya)}}n_h(){try{this.IAf()}catch(Ya){C.a.J(512254353,
822,10,"Exception in AddFirstSlidePaneClickHandler: {0}.",Ya)}}IAf(){this.ia.processAction(T.a.HAf,2);this.fW.ya.style.display=M.a.Sf;this.d9.style.display=M.a.Rk;this.cAh();this.shd(!0)}PSf(Ya){const Qb={};Qb.contextMenuArgs=Ya;Qb.isEmptySection=0<=this.ta.oA?!this.yc.wrb(this.ta.oA).length:!1;return Qb}A3a(Ya){try{const Qb=this.Mg.visibleSlideRange;let bb=!1;if(Ya)for(const Bb of Qb){if(Bb.slideSid===Ya.sid){bb=!0;break}}else bb=!0;if(bb){Ya=!0;for(const Bb of Qb)for(const Eb of this.Mg.slideDataList)if(Eb.slideID.slideSid===
Bb.slideSid&&Eb.slideID.slideCid===Bb.slideCid&&!Eb.thumbnailImage){Ya=!1;break}Ya&&0<this.u3&&(this.YEa=Date.now(),C.a.J(512254352,822,15,"VisibleSlideRangePLT - firstVisibleRangePLTCalc: {0}, visibleSlideLength: {1}, startTime: {2}, endTime: {3}, elapse: {4}.",this.GEa,Qb.length,this.u3,this.YEa,this.YEa-this.u3),this.GEa&&(this.GEa=!1),this.YEa=this.u3=0)}}catch(Qb){C.a.J(512254351,822,10,"Exception in CheckAndLogVisibleSlideRangePLT: {0}.",Qb)}}Cih(Ya,Qb){try{const bb=Qb.sectionIndex,Bb=Qb.clickedAway;
C.a.J(512254350,822,15,"SorterViewActor: SectionSelectionChangedHandler - targetSectionIndex: {0}.",bb);if(Bb||this.ta.oA!==bb)if(this.ta.oA=Bb?-1:bb,!Bb){const Eb=this.Do.oQa();if(Eb&&Eb[bb]){const tb=this.yc.CLc(bb,Eb),Yb=this.yc.wrb(bb);this.Mg.selectedSlideIndexes=Yb;this.Mg.activeFocusSlideIndex=Eb[bb].SlideIds.length?tb:-1;this.kJb(Yb,!0);this.eJb(tb)}}}catch(bb){C.a.J(512254349,822,10,"SorterViewActor: Exception in SectionSelectionChangedHandler: {0}.",bb)}}zih(Ya,Qb){try{const bb=Qb.currentActiveFocusSectionIndex;
this.ta.oA=bb;let Bb=Qb.newActiveSlideIndex;Bb=0<Bb?Bb:0;const Eb=this.yc.wrb(bb);this.kJb(Eb,!0);this.eJb(Bb)}catch(bb){C.a.J(512254348,822,10,"SorterViewActor: Exception in SectionFocusChangedHandler: {0}.",bb)}}Yyj(Ya,Qb){try{let bb=Qb.insertIndex;C.a.J(512254347,822,50,"SorterViewActor: InsertBetweenSlidesPositionChangedHandler - targetSlideIndex: {0}.",bb);this.Kqe=0>bb?!1:!0;Ga.a("SlideSorterInsertionAfterFirstSlide")?(--bb,this.Yb.bDb=bb):(bb=bb?bb-1:bb,this.Yb.bDb=0<=bb?bb:-1);this.kJb([bb],
!0);this.eJb(bb)}catch(bb){C.a.J(512254346,822,10,"SorterViewActor: Exception in InsertBetweenSlidesPositionChangedHandler: {0}.",bb)}}lHb(Ya,Qb){try{const Eb=Qb.slideSelectionTrigger,tb=Qb.slideIndex,Yb=Qb.isSelectingMultiple,Tc=Qb.isSelectingRange;this.ta.oA=-1;C.a.J(512254345,822,15,"SorterViewActor: SlideSelectionChangeHandler - targetSlideIndex: {0}.",tb);const ib=this.Do.AP();if(!ib||0>=ib.length)C.a.J(512254344,822,10,"SorterViewActor-SlideSelectionChangeHandler: wrong slideOrder.");else{Ya=
!1;if(0<=tb){var bb=this.yc.XH(tb);Ya=this.ra.KTc(bb)}if(5===Eb&&Ya)C.a.J(512254343,822,50,"SorterViewActor: SlideSelectionChangeHandler - mouse down on selected set of slides");else{bb=[];if(Tc)if(this.ta.Ba&&0<=tb){var Bb=this.ta.Ba.slideIndex;Ya=Bb<=tb?Bb:tb;for(Bb=Bb<=tb?tb:Bb;Ya<=Bb;Ya+=1)bb.push(Ya)}else{C.a.J(512254342,822,10,"SorterViewActor-SlideSelectionChangeHandler: active slide in workspace is null.");return}else bb=[tb];0<=tb&&(this.kJb(bb,!Yb||Tc),Tc||this.eJb(tb));1!==Eb&&3!==Eb||
this.ia.processAction(T.a.fgb,2)}}}catch(Eb){C.a.J(512254341,822,10,"SorterViewActor: Exception in SlideSelectionChangeHandler: {0}.",Eb)}}eJb(Ya){C.a.J(512254340,822,50,"SorterViewActor: UpdateActiveSlideForWorkspace called with targetSlideIndex: {0}",Ya);0<=Ya&&(Ya=this.yc.XH(Ya),this.Yb.Ba=Ya)}kJb(Ya,Qb){C.a.J.apply(null,[537012180,822,50,"SorterViewActor: UpdateCurrentSelectedSlidesForWorkspace called with targetSlideIndexes: {0}"].concat(Ya));if(Qb){var bb=[];for(Qb=0;Qb<Ya.length;Qb+=1){if(0>
Ya[Qb])return;bb.push(this.yc.XH(Ya[Qb]))}var Bb;(Bb=this.ra).DX.apply(Bb,bb)}else for(Bb=0;Bb<Ya.length;Bb+=1)if(Qb=Ya[Bb],0<=Qb){Qb=this.yc.XH(Qb);const Eb=this.ra.mf();Eb?this.ra.KTc(Qb)||(Eb.push(Qb),(bb=this.ra).DX.apply(bb,Eb)):C.a.J(512254339,822,15,"SorterViewActor::UpdateCurrentSelectedSlidesForWorkspace - selectedSlideNodes is null.")}}QJb(){try{this.u3=Date.now();this.A3a(null);const Ya=this.Mg.visibleSlideRange,Qb=[];for(const bb of Ya)Qb.push(new H.a(Object.assign(new K.a,{Cid:bb.slideCid,
Sid:bb.slideSid})));this.Do.ffh(Qb)}catch(Ya){C.a.J(512254338,822,10,"SorterViewActor: Exception in VisibleSlideRangeChangedHandler: {0}.",Ya)}}DTg(Ya,Qb){try{const Eb=Qb.dragStartIndexes;var bb=Qb.dropTargetIndex;const tb=this.Do.AP();var Bb=Qb.sectionIndex;Bb=null!=Bb?Bb:-1;if(!tb||bb>tb.length)C.a.J(512254337,822,10,"SorterViewActor-MoveSlideHandler: slide order is null or dropIndex {0} is larger than slideOrder length {1}.",bb,tb?tb.length:-1);else if(Eb)if(Ya=bb,Qb.shouldInsertSlideAfter||(Ya--,
0>Bb&&(Bb=this.Do.t2(tb[bb])),C.a.J(512254307,822,50,"SorterViewActor: adjustedDropSlideIndex:{0}, sectionIndex:{1}.",Ya,Bb)),1!==Eb.length||bb!==Eb[0]-1||0<=Bb){Qb=[];for(bb=0;bb<Eb.length;bb+=1)Qb.push(tb[Eb[bb]]);const Yb=new qa(!1,Qb,0<=Ya?tb[Ya]:null,Bb);this.ia.Ka(T.a.CTg,2,Yb)}else C.a.J(512254306,822,50,"SorterViewActor-MoveSlideHandler: no index change: {0}, so no move.",bb);else C.a.J(512254336,822,10,"SorterViewActor: dragStartIndexes is null.")}catch(Eb){C.a.J(512254305,822,10,"SorterViewActor: Exception in MoveSlideHandler: {0}.",
Eb)}}Dih(Ya,Qb){try{const bb=Qb.sectionIndex,Bb=Qb.sectionTitleAfter,Eb=this.Do.oQa();if(0<=bb&&Eb&&Eb[bb]&&Eb[bb].Title!==Bb){const tb=new Ja(bb,Bb);this.ia.Ka(T.a.gTe,2,tb)}}catch(bb){C.a.J(512254304,822,10,"SorterViewActor: Exception in SectionTitleUpdateHandler: {0}.",bb)}}Az(Ya){try{let Qb=!1;if(Ya.keyCode===y.a.wO||Ya.keyCode===y.a.YQ||Ya.keyCode===y.a.A0||Ya.keyCode===y.a.C0)Ya.stopPropagation();else if(Ya.keyCode===y.a.kna||Ya.keyCode===y.a.jH)Qb=!0,this.ia.processAction(T.a.JM,2);else if(Ya.keyCode===
y.a.iE)Qb=!0,this.Mg.selectedSlideIndexes=[0],this.Mg.activeFocusSlideIndex=0,this.kJb([0],!0),this.eJb(0);else if(Ya.keyCode===y.a.tw){Qb=!0;const bb=this.Do.AP();bb&&0<bb.length&&(this.Mg.selectedSlideIndexes=[bb.length-1],this.Mg.activeFocusSlideIndex=bb.length-1,this.kJb([bb.length-1],!0),this.eJb(0))}else if(Ga.a("EnableCutInSorterView")&&this.Nia(Ya)&&Ya.keyCode===y.a.roc)Qb=!0,this.ia.processAction(T.a.hQd,2),this.Fa.Gj(sa.a.Dea,!0);else if(this.Nia(Ya)&&Ya.keyCode===y.a.KJa)Qb=!0,this.ia.processAction(T.a.Jye,
2),this.Fa.Gj(sa.a.Dea,!0);else if(this.Nia(Ya)&&Ya.keyCode===y.a.dib)Qb=!0,this.OG.paste(new xa.a(!0),null,!1),this.Fa.Gj(sa.a.Dea,!0);else if(Ya.ctrlKey&&Ya.keyCode===y.a.LJa)Qb=!0,this.ia.processAction(T.a.bS,2),this.Fa.Gj(sa.a.Dea,!0);else if(Ya.ctrlKey&&Ya.keyCode===y.a.ffa){Qb=!0;const bb=this.ta.presentation;if(!bb)throw Error.argumentNull("Presentation is null");0<(bb.slides||[]).length?(this.ia.processAction(T.a.kla,2),this.Fa.Gj(sa.a.Dea,!0)):this.IAf()}else if(Ya.shiftKey&&Ya.keyCode===
y.a.tna||Ya.keyCode===y.a.BJa){Qb=!0;const bb=Ba.a.create(A.a.contextMenu,Ya,1);this.zB(bb)}else Ya.keyCode===y.a.Bq&&this.mL&&this.mL.ya.style.display!==M.a.Sf&&this.blj(Ya);Qb&&C.a.J(512254303,822,50,"SoterViewActor: processing shortcut key: {0}.",Ya.keyCode)}catch(Qb){C.a.J(512254302,822,10,"SorterViewActor: Exception in KeyDownHandler: {0}.",Qb)}}Nia(Ya){if(Ga.a("IsCommandKeyFixSorterView"))return u.a.ek?Ma.KeyInputManager.v_b(Ya,"metaKey"):Ya.ctrlKey;const Qb=u.a.ek&&Ma.KeyInputManager.v_b(Ya,
"metaKey");return Ya.keyCode===y.a.$ea&&!u.a.ek||Qb}blj(Ya){this.X9a=Ya.shiftKey?0<=this.X9a-1?this.X9a-1:this.xbb.length-1:(this.X9a+1)%this.xbb.length;0<=this.X9a&&w.FocusManager.Dr(this.xbb[this.X9a]);Ya.preventDefault();Ya.stopPropagation()}loj(Ya,Qb,bb){try{if(1===bb){const Bb=this.ta.presentation;return Bb&&Bb.zp&&Bb.zp.length?32:8}2===bb&&(C.a.J(512254301,822,50,"HandleRenameSection called."),this.Mg.editableSectionTitleIndex=this.ta.oA);return 32}catch(Bb){return C.a.J(512254300,822,10,"SorterViewActor: Exception in HandleRenameSection: {0}.",
Bb),8}}Dpj(Ya,Qb,bb){try{if(1===bb){const Bb=this.ta.presentation;return Bb&&Bb.zp&&Bb.zp.length?32:8}2===bb&&this.Mg&&(this.Mg.activeFocusSlideIndex=this.ta.Ba.De,this.Mg.selectedSlideIndexes=[this.ta.Ba.De],this.Mg.selectedSectionIndex=this.ta.oA,this.Mg.editableSectionTitleIndex=this.ta.oA);return 32}catch(Bb){return C.a.J(512254299,822,10,"SorterViewActor: Exception in HandleTriggerRenameSection: {0}.",Bb),8}}Ioj(Ya,Qb,bb,Bb,Eb){try{if(2===bb&&Eb){C.a.J(512254298,822,50,"HandleSelectSectionAndSlides called.");
Ya=null;const tb=this.Do.oQa();0<=Eb.sectionIndex&&(this.Mg.selectedSectionIndex=Eb.sectionIndex,Ya=this.yc.wrb(Eb.sectionIndex));0<=Eb.slideIndex&&!!Ya&0<Ya.length&&(this.Mg.activeFocusSlideIndex=this.yc.CLc(Eb.sectionIndex,tb),this.Mg.selectedSlideIndexes=Ya&&0<Ya.length?Ya:[Eb.slideIndex])}return 32}catch(tb){return C.a.J(512254297,822,10,"SorterViewActor: Exception in HandleSelectSectionAndSlides: {0}.",tb),8}}JAi(){this.uq=new P.a;this.d9=document.createElement("div");this.uq.ya.appendChild(this.d9);
this.uq.ya.setAttribute("tabindex","0");this.uq.ya.setAttribute("role","tabpanel");this.uq.ya.setAttribute("aria-label",ResourceStrings.L_SlideSorter);this.uq.ya.id="pptonline-sorter-view-id";this.uq.ya.className="pptonline-sorter-view-class";this.d9.className="pptonline-sorter-view-inner-container-class";this.vf.appendChild(this.uq.ya);this.uq.ya.style.width=this.Sta?this.Qsb():"100%";this.uq.ya.style.display=M.a.Rk}nDc(Ya,Qb,bb){2===bb&&this.eOf();return 32}Qsb(){let Ya="100%";this.Sta&&0===this.Qb.Nu&&
(Ya=cb.a.mGf+1+Za.a.QHa+"px");return Ya}eOf(){try{C.a.J(512254296,822,50,"SorterViewActor: CloseSorterView called."),this.Sta&&this.uq?this.uq.ya.style.width=this.Qsb():(this.Fa.Gj(sa.a.Dea,!1),this.uq&&(this.uq.ya.style.display=M.a.Sf),this.mL&&(this.mL.ya.style.display=M.a.Sf),this.Pka&&(this.Pka.ya.style.display=M.a.Sf),this.cAh())}catch(Ya){C.a.J(512254295,822,10,"SorterViewActor: Exception in CloseSorterView: {0}.",Ya)}}cAh(){this.Do&&(this.Do.URe(),this.Do.Rch(Object(E.a)(this,this.aCb,"onDataStoreUpdated")));
this.Lg&&this.Lg.z4(Object(E.a)(this,this.iC,"onActiveSlideChanged"));this.Mc&&this.Mc.GEb(Object(E.a)(this,this.Vz,"onUnifiedAppStateChanged"));this.Mg&&(this.Mg.events.onSlideSelectionChanged.unsubscribe(Object(E.a)(this,this.lHb,"slideSelectionChangeHandler")),this.Mg.events.onVisibleSlideRangeChanged.unsubscribe(Object(E.a)(this,this.QJb,"visibleSlideRangeChangedHandler")),this.Mg.events.onMoveSlide.unsubscribe(Object(E.a)(this,this.DTg,"moveSlideHandler")),this.Mg.events.onSectionTitleUpdate.unsubscribe(Object(E.a)(this,
this.Dih,"sectionTitleUpdateHandler")),this.Mg.events.onSectionSelectionChanged.unsubscribe(Object(E.a)(this,this.Cih,"sectionSelectionChangedHandler")),this.Mg.events.onActiveSectionFocusChanged.unsubscribe(Object(E.a)(this,this.zih,"sectionFocusChangedHandler")))}isj(){const Ya=document.getElementById(Ha.a.mUb);Ya&&(Ya.style.display=M.a.Sf)}dispose(){try{this.Fl||(this.Fl=!0,this.TMg.YDe(Object(E.a)(this,this.G_,"onSlidePresenceChanged")),this.eOf(),this.uq&&(Z.a.instance.xb(this.uq.ya,Object(E.a)(this,
this.zB,"contextMenuHandler")),this.vf.removeChild(this.uq.ya),this.uq=null))}catch(Ya){C.a.J(512254294,822,10,"SorterViewActor: Exception in Dispose: {0}.",Ya)}}}Object(J.a)(va,"SorterViewActorLazy",null,[106,469]);var Fa=d(77),Ca=d(37),La=d(421);class nb{constructor(Ya,Qb){this.Ijd=null;this.hasUnreadChanges=this.isHiddenSlide=!1;this.numComments=0;this.hasTransitionOrAnimation=!1;this.slideID=Ya;this.thumbnailImage=Qb}}Object(J.a)(nb,"ThumbnailDataStoreItem",null,[]);class Nb{constructor(Ya,Qb,
bb,Bb,Eb,tb){this.va=new Fa.a;this.kua=null;this.Fl=!1;this.Ie=Ya;this.H3c={};this.Ox=Qb;this.C$b=bb;this.nOg=Bb;this.Bk=Eb;this.Gka=tb}tQa(){this.Tah();return this.H3c}nbh(){this.Ox.Dza(Object(E.a)(this,this.F9,"onThumbnailDrawCompleted"));this.C$b.$F(Object(E.a)(this,this.UA,"onChildTopologyChanged"));this.nOg.xk(Object(E.a)(this,this.E_g,"onSectionPropertyChanged"));this.Bk.z4h(Object(E.a)(this,this.o0g,"onSlidesRemoved"));this.Bk.r4h(Object(E.a)(this,this.F_g,"onSectionRemoved"));this.Bk.q4h(Object(E.a)(this,
this.D_g,"onSectionOrderChanged"));this.Gka.instance?this.Gka.instance.jDf(Object(E.a)(this,this.Edc,"onSlideUnreadStateChanged")):C.a.J(512274976,804,10,"ThumbnailDataStoreManager: m_revisionTrackingEventHandlers is null")}URe(){this.Ox.seb(Object(E.a)(this,this.F9,"onThumbnailDrawCompleted"));this.C$b.iO(Object(E.a)(this,this.UA,"onChildTopologyChanged"));this.nOg.Tm(Object(E.a)(this,this.E_g,"onSectionPropertyChanged"));this.Bk.aQk(Object(E.a)(this,this.o0g,"onSlidesRemoved"));this.Bk.WPk(Object(E.a)(this,
this.F_g,"onSectionRemoved"));this.Bk.VPk(Object(E.a)(this,this.D_g,"onSectionOrderChanged"));this.Gka.instance?this.Gka.instance.Ddh(Object(E.a)(this,this.Edc,"onSlideUnreadStateChanged")):C.a.J(512274975,804,10,"ThumbnailDataStoreManager: m_revisionTrackingEventHandlers is null")}AP(){try{return this.kua=this.Ie.QQ}catch(Ya){return C.a.J(512274974,822,10,"ThumbnailDataStoreManager: Exception in GetSlideOrder: {0}",Ya),null}}t2(Ya){return this.Ie.t2(Ya)}oQa(){return this.Ie.oQa()}ffh(Ya){try{const Qb=
{TriggerSource:"SlideGrid"};Qb.TriggerSourceStartTime=Date.now();this.kua=this.Ie.QQ;let bb=this.kua.length,Bb=0;for(let tb=0;tb<this.kua.length;tb++)for(let Yb=0;Yb<Ya.length;Yb++)this.kua[tb].sid===Ya[Yb].sid&&this.kua[tb].cid===Ya[Yb].cid&&(tb<=bb&&(bb=tb),tb>=Bb&&(Bb=tb));const Eb=new La.a(bb,Bb>bb?Bb-bb+1:1);this.Ie.xJe(Eb,!0,Qb)}catch(Qb){C.a.J(512274973,822,10,"ThumbnailDataStoreManager: Exception in RequestThumbnails: {0}",Qb)}}uCf(Ya){this.va.addHandler("ThumbnailDataStoreUpdated",Ya)}Rch(Ya){this.va.removeHandler("ThumbnailDataStoreUpdated",
Ya)}Neg(){try{return this.Ie.v2(0).OP}catch(Ya){return C.a.J(512274972,822,10,"ThumbnailDataStoreManager: Exception in GetThumbnailSize: {0}",Ya),new I.a(176,100)}}dispose(){try{this.Fl||(this.Fl=!0,this.URe())}catch(Ya){C.a.J(512274971,822,10,"ThumbnailDataStoreManager: Exception in Dispose: {0}.",Ya)}}F9(Ya,Qb){Qb&&Qb.succeeded&&this.NWa(Qb.slideIndex)}UA(Ya,Qb){try{2===Qb.PY&&(Qb.node.isDirty||this.NWa(-1))}catch(bb){C.a.J(512274970,822,10,"ThumbnailDataStoreManager: Exception in OnChildTopologyChanged: {0}.",
bb)}}E_g(Ya,Qb){Qb.property===Ca.a.CGe?(Ya=Qb.node)&&Ya.$z&&0<Ya.$z.length&&this.NWa(-1):Qb.property===Ca.a.sectionTitle&&this.NWa(-1)}F_g(Ya,Qb){C.a.J(512274969,822,50,"ThumbnailDataStoreManager: OnSectionRemoved handler called.");Qb&&this.NWa(-1)}o0g(Ya,Qb){C.a.J(512274968,822,50,"ThumbnailDataStoreManager: OnSlidesRemoved handler called.");Qb&&this.NWa(-1)}D_g(){this.NWa(-1)}Edc(Ya,Qb){C.a.J(512274967,804,50,"ThumbnailDataStoreManager: OnSlideUnreadStateChanged handler called.");Qb&&this.NWa(-1)}NWa(Ya){this.Tah();
const Qb={};Qb.SlideIndex=Ya;this.va.raiseEvent("ThumbnailDataStoreUpdated",Qb)}Tah(){this.kua=this.Ie.QQ;for(let Ya=0;Ya<this.kua.length;Ya++){const Qb=this.kua[Ya];this.H3c[Qb.sid.toString()]||(this.H3c[Qb.sid.toString()]=new nb(Qb,""));const bb=this.H3c[Qb.sid.toString()],Bb=this.Ie.v2(Ya);Bb&&(Bb.image&&Bb.image.src&&Bb.image.src.length&&(Bb.O2?(C.a.J(512274966,822,50,"ThumbnailDataStoreManager: slide {0} is not ready for render, Sid={1}, Cid={2}.",Ya,Qb.sid,Qb.cid),bb.thumbnailImage=""):(bb.thumbnailImage=
Bb.image.src,bb.Qll=Bb.image.width)),Bb.Nd?bb.hasUnreadChanges=Bb.Nd.isUnread:C.a.J(512274965,804,10,"ThumbnailDataStoreManager: SlideNode not found for thumbnail view element"),bb.hasTransitionOrAnimation=Bb.A2,bb.isHiddenSlide=Bb.En,bb.Ijd=Bb.Ijd,bb.numComments=Bb.xVb)}}}Object(J.a)(Nb,"ThumbnailDataStoreManager",null,[467]);class Rb{constructor(){this.K=null;this.yJg=!1}get name(){return"PowerPointWebEditor.SorterGrid"}Wb(Ya){this.K=Ya}init(){e.a.instance&&e.a.instance.ic("SlideGridPackageLoaded",
Date.now());this.Jxj()}Jxj(){try{this.yJg=m.AFrameworkApplication.fa.ka("PPTSorterViewEnabled");h.ULS.sendTraceTag(512254412,202,50,"SorterGrid:Init - Grid component package");const Ya=e.a.instance;Ya&&Ya.ic("SorterGridFullAppSettingsReady",Date.now());this.lWb()}catch(Ya){h.ULS.sendTraceTag(512254411,811,10,"PPTWebEditorSorterGridPackage: exception in OnFullAppSettingsReady: {0}",Ya)}}lWb(){const Ya=(new Date).getTime(),Qb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").kG();var bb=document.createElement("link");
bb.setAttribute("rel","stylesheet");bb.setAttribute("type","text/css");bb.setAttribute("href",this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptGridViewComponentCssUrl);Qb.appendChild(bb);bb=m.AFrameworkApplication.fa.Ha("PPTFabricIconBackArrowCssUrl");const Bb=document.createElement("link");Bb.setAttribute("rel","stylesheet");Bb.setAttribute("type","text/css");Bb.setAttribute("href",bb);Qb.appendChild(Bb);this.K.register(467,"PowerPointWebEditor.IThumbnailDataStoreManager").na(()=>new Nb(this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("Box4.Graph.IGraphInstance").Bd(7),this.K.resolve("Box4.Graph.IGraphInstance").Bd(68),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.La("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"))).ma();this.K.register(468,"PowerPointWebEditor.ISlideGridHelper").na(()=>new pa(this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"))).ma();this.K.register(L,
"PowerPointWebEditor.GridViewActor").na(()=>new L(Qb,this.K.resolve("PowerPointWebEditor.ISlideGridHelper"),m.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))).ma();this.K.resolve("PowerPointWebEditor.GridViewActor").ub();if(this.yJg){let Eb=document.getElementById("WACDocumentPanel");m.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")&&m.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesIsEnabled")&&
(bb=this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))&&(Eb=bb.ya);this.K.register(469,"PowerPointWebEditor.ISorterViewActorLazy").na(()=>new va(Eb,this.K.resolve("PowerPointWebEditor.ISlideGridHelper"),m.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IPasteManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.La("PowerpointPresence.IPresenceManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").bXa)).ma();this.K.resolve("PowerPointWebEditor.ISorterViewActorLazy").ub();(bb=this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))?(bb.RD(new na.a(2)),bb.RD(new na.a(1)),bb.aFk()):h.ULS.sendTraceTag(512254410,811,15,"PPTWebEditorSorterGridPackage: no viewEventSource object.")}h.ULS.sendTraceTag(512254409,
811,50,"PPTWebEditorSorterGridPackage: Time Taken to create and Register SorterGrid Objects: {0}",(new Date).getTime()-Ya)}dispose(){try{const Ya=this.K.pb("PowerPointWebEditor.IThumbnailDataStoreManager"),Qb=this.K.pb("PowerPointWebEditor.GridViewActor");Ya&&Ya.dispose();Qb&&Qb.dispose()}catch(Ya){h.ULS.sendTraceTag(512254408,811,10,"PPTWebEditorSorterGridPackage: exception in Dispose: {0}",Ya)}}static main(){n.a.instance.Ac(new Rb)}}Object(J.a)(Rb,"PPTWebEditorSorterGridPackage",null,[2,3]);Type.registerNamespace("PPTGridComponent");
Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.SorterGrid");Rb.main()},369:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.Cm=null;this.QM=!1;this.T9d=!0;this.rt=this.tS=null;this.SYb=!1;this.KPc=null;this.Hwe=!0;this.Sy=this.VI=this.Rb=null;this.kPa=!1;this.eUd=e}}Object(J.a)(h,"PasteParams",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17281904/wdjs/ppteditDS.sortergrid.js.map